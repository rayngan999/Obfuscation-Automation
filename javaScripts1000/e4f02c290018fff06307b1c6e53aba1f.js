function ez_attachEvent(element,evt,func){if(element.addEventListener){element.addEventListener(evt,func,false);}else{element.attachEvent("on"+evt,func);}}
function ez_attachEventWithCapture(element,evt,func,useCapture){if(element.addEventListener){element.addEventListener(evt,func,useCapture);}else{element.attachEvent("on"+evt,func);}}
function ez_detachEvent(element,evt,func){if(element.removeEventListener){element.removeEventListener(evt,func);}else{element.detachEvent("on"+evt,func);}}
function ez_getQueryString(field,url){var href=url?url:window.location.href;var reg=new RegExp('[?&]'+field+'=([^&#]*)','i');var string=reg.exec(href);return string?string[1]:null;}
(function(root,factory){if(typeof define==='function'&&define.amd){define('ezRiveted',[],factory);}else if(typeof module==='object'&&module.exports){module.exports=factory();}else{root.riveted=factory();}}(this,function(){var riveted=(function(){var started=false,stopped=false,turnedOff=false,clockTime=0,startTime=new Date(),clockTimer=null,idleTimer=null,sendEvent,sendUserTiming,reportInterval,scrollDepth=0,idleTimeout,scrollTimer=0;function init(options){options=options||{};reportInterval=parseInt(options.reportInterval,10)||5;idleTimeout=parseInt(options.idleTimeout,10)||30;if(typeof options.eventHandler=='function'){sendEvent=options.eventHandler;}
if(typeof options.userTimingHandler=='function'){sendUserTiming=options.userTimingHandler;}
addListener(document,'keydown',trigger);addListener(document,'click',trigger);addListener(document,'touchstart',trigger);addListener(window,'mousemove',throttle(trigger,500));addListener(window,'scroll',triggerScroll);addListener(document,'visibilitychange',visibilityChange);addListener(document,'webkitvisibilitychange',visibilityChange);}
function triggerScroll(){if(scrollTimer>0){clearTimeout(scrollTimer);}
setIdle();scrollTimer=setTimeout(function(){stopScroll();},50);}
function stopScroll(){clearTimeout(scrollTimer);trigger();setScrollDepth();}
function setScrollDepth(){var h=document.documentElement,b=document.body,st='scrollTop',sh='scrollHeight';var percent=0;if(b.clientHeight<h.clientHeight){percent=100*((h[st]||b[st])+b.clientHeight)/(h[sh]||b[sh]);}else{percent=100*((h[st]||b[st])+h.clientHeight)/(h[sh]||b[sh]);}
if(percent>scrollDepth){scrollDepth=percent;}}
function throttle(func,wait){var context,args,result;var timeout=null;var previous=0;var later=function(){previous=new Date;timeout=null;result=func.apply(context,args);};return function(){var now=new Date;if(!previous)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args);}else if(!timeout){timeout=setTimeout(later,remaining);}
return result;};}
function addListener(element,eventName,handler){if(element.addEventListener){element.addEventListener(eventName,handler,false);}
else if(element.attachEvent){element.attachEvent('on'+eventName,handler);}
else{element['on'+eventName]=handler;}}
sendUserTiming=function(timingValue){};sendEvent=function(time){};function setIdle(){clearTimeout(idleTimer);stopClock();}
function visibilityChange(){if(document.hidden||document.webkitHidden){setIdle();}}
function clock(){clockTime+=0.1;clockTime=Math.round(clockTime*100)/100;if(clockTime>0&&(clockTime%reportInterval===0)){sendEvent(clockTime);}}
function stopClock(){stopped=true;clearInterval(clockTimer);}
function turnOff(){setIdle();turnedOff=true;}
function turnOn(){turnedOff=false;}
function restartClock(){stopped=false;clearInterval(clockTimer);clockTimer=setInterval(clock,100);}
function getEngagedTime(){return Math.round(clockTime);}
function getScrollDepth(){return Math.round(scrollDepth);}
function startRiveted(){var currentTime=new Date();var diff=currentTime-startTime;started=true;sendUserTiming(diff);clockTimer=setInterval(clock,1000);}
function resetRiveted(){startTime=new Date();clockTime=0;started=false;stopped=false;clearInterval(clockTimer);clearTimeout(idleTimer);}
function trigger(){if(turnedOff){return;}
if(!started){startRiveted();}
if(stopped){restartClock();}
clearTimeout(idleTimer);idleTimer=setTimeout(setIdle,idleTimeout*1000+100);}
return{init:init,trigger:trigger,setIdle:setIdle,on:turnOn,off:turnOff,reset:resetRiveted,getTime:getEngagedTime,getScrollDepth:getScrollDepth};})();return riveted;}));var ezux=(function(){if(typeof _ezaq==="undefined"||!_ezaq.hasOwnProperty("page_view_id")){return;}
var storedPerf=false;var autoTimer=0,autoUploadMs=15000,debug=ez_getQueryString('ezux_debug')=="1",counts={copyPaste:0,shares:0},last={copyPasteCount:0,engagedTime:0,isEngagedPage:0,scrollDepth:0,unloadTime:0,shareCount:0},current={et:0,tos:0,},maxEngagedSeconds=1800,pvID=_ezaq["page_view_id"],secondsUntilEngaged=10,startTime=new Date(),timer,totals={engagedAdded:0,tosAdded:0},unloadedTimeDelayMs=3000,visbilityChangeFunc=null;var evts={copyPaste:function(){counts.copyPaste++;},mouseOut:function(e){e=e?e:window.event;if(typeof e==='undefined'||typeof e.target==='undefined'||typeof e.target.tagName==='undefined')return;if(e.target.tagName.toLowerCase()==="input")return;var vpWidth=Math.max(document.documentElement.clientWidth,window.innerWidth||0);if(e.clientX>=(vpWidth-50))return;if(e.clientY>=50)return;var from=e.relatedTarget||e.toElement;if(!from)evts.unload(e);},load:function(e){storePerformance();addPaintTimings();addConnectionInfo();},unload:function(e){var currentTime=(new Date).getTime();if(last.unloadTime===0||currentTime>(last.unloadTime+unloadedTimeDelayMs)){storeTimes();storePerformance();pixels.unloadAll(e);last.unloadTime=currentTime;}},pageshow:function(e){var cnAwesome=getCookieName('ezoawesome'),cvAwesome=getCookie(cnAwesome);if(cvAwesome.length>0){log("Bounce ("+cnAwesome+") detected with val "+cvAwesome);storeAdBounce(cvAwesome);expireCookie(cnAwesome);}},pageshare:function(e){counts.shares++;pixels.addPageShares();},addUnloadTime:function(e){pixels.addUnloadTime();}};var pixels={addCopyPaste:function(){if(counts.copyPaste>0&&counts.copyPaste!=last.copyPasteCount){__ez.bit.Add(pvID,[(new __ezDotData('copy_paste_count',counts.copyPaste))]);last.copyPasteCount=counts.copyPaste;}},addDeviceSizes:function(){log("Storing device sizes");__ez.bit.Add(pvID,[(new __ezDotData('device_width',screen.width)),(new __ezDotData('device_height',screen.height))]);},addEngagedTimes:function(t){if(t!=last.engagedTime){__ez.bit.Add(pvID,[(new __ezDotData('engaged_time',t))]);last.engagedTime=t;}},addIsEngagedPage:function(t){if(last.isEngagedPage==0&&isEngagedPage(t)){__ez.bit.Add(pvID,[(new __ezDotData('is_engaged_page',1))]);last.isEngagedPage=1;}},addIsFirstEngagedPage:function(t){var ckName=getCookieName("ezux_ifep");if(getCookie(ckName).length==0&&isEngagedPage(t)){log("Adding first engaged cookie");__ez.ck.setByCat(ckName+"=true",3);__ez.bit.Add(pvID,[(new __ezDotData('is_first_engaged_page',1))]);}},addLanguage:function(){log("Storing language tag");var languageTag=window.navigator.userLanguage||window.navigator.language;var tagArray=languageTag.split('-');if(typeof languageTag!=='undefined'&&languageTag!==''){if(languageTag.length>36){languageTag=languageTag.substring(0,36);}
__ez.bit.Add(pvID,[(new __ezDotData('language_tag',languageTag))]);}
if(tagArray.length>=2){var primaryLanguageSubtag=tagArray[0];if(primaryLanguageSubtag>8){primaryLanguageSubtag=primaryLanguageSubtag.substring(0,8);}
__ez.bit.Add(pvID,[(new __ezDotData('language_primary_subtag',primaryLanguageSubtag))]);}},addLocalTime:function(){log("Storing local time");var now=new Date();var tzOffset=now.getTimezoneOffset();if(tzOffset<-840||tzOffset>720){return}
var lDate=new Date(now-(tzOffset*60000));if((Math.abs(lDate-now)/3600000)>14){return}
if(!Date.prototype.toISOString){(function(){function pad(number){if(number<10){return '0'+number;}
return number;}
Date.prototype.toISOString=function(){return this.getUTCFullYear()+
'-'+pad(this.getUTCMonth()+1)+
'-'+pad(this.getUTCDate())+
'T'+pad(this.getUTCHours())+
':'+pad(this.getUTCMinutes())+
':'+pad(this.getUTCSeconds())+
'.'+(this.getUTCMilliseconds()/1000).toFixed(3).slice(2,5)+
'Z';};}());}
var localDate=lDate.toISOString().slice(0,19).replace('T',' ').split(' ')[0];if(localDate.length<1||localDate[0]=='0'){return}
var localHour=now.getHours();var localDay=now.getDay();__ez.bit.Add(pvID,[(new __ezDotData('t_local_date',localDate)),(new __ezDotData('t_local_hour',localHour)),(new __ezDotData('t_local_day_of_week',localDay)),(new __ezDotData('t_local_timezone',tzOffset))]);},addScrollDepth:function(){var sd=timer.getScrollDepth();if(sd!=last.scrollDepth){__ez.bit.Add(pvID,[(new __ezDotData('scroll_percent_vertical',sd))]);last.scrollDepth=sd;}},addPageShares:function(){if(counts.shares>0&&counts.shares!=last.shareCount){log("[Page Share] Store page shares: "+counts.shares);__ez.bit.Add(pvID,[(new __ezDotData('share',counts.shares))]);last.shareCount=counts.shares;}},addUnloadTime:function(){__ez.bit.Add(pvID,[(new __ezDotData('t_unload',(new Date()).getTime()))]);__ez.bit.Fire();},unloadAll:function(e){var t=timer.getTime();pixels.addEngagedTimes(t);pixels.addCopyPaste();pixels.addScrollDepth();pixels.addIsEngagedPage(t);pixels.addIsFirstEngagedPage(t);pixels.addPageShares();log('Unload ('+e.type+')');firePixels();}};function init(){initVars();pixels.addDeviceSizes();pixels.addLocalTime();pixels.addLanguage();attachListeners();startRiveted();startAutomaticUnloadTimer();}
function initVars(){autoTimer=0,autoUploadMs=15000,debug=ez_getQueryString('ezux_debug')=="1",counts={copyPaste:0,shares:0},last={copyPasteCount:0,engagedTime:0,isEngagedPage:0,scrollDepth:0,unloadTime:0,shareCount:0},current={et:getCookie(getCookieName("ezux_et")),tos:getCookie(getCookieName("ezux_tos")),},maxEngagedSeconds=1800,pvID=_ezaq["page_view_id"],secondsUntilEngaged=10,startTime=new Date(),timer,totals={engagedAdded:0,tosAdded:0},unloadedTimeDelayMs=3000,visbilityChangeFunc=null;}
function destroy(){stopAutomaticUnloadTimer();removeListeners();stopRiveted();}
function addListener(element,eventName,handler){if(element.addEventListener){element.addEventListener(eventName,handler,false);}else if(element.attachEvent){element.attachEvent('on'+eventName,handler);}else{element['on'+eventName]=handler;}}
function removeListener(element,eventName,handler){if(element.removeEventListener){element.removeEventListener(eventName,handler,false);}else if(element.detachEvent){element.detachEvent('on'+eventName,handler);}else{delete element['on'+eventName];}}
function attachListeners(){addListener(document,'blur',evts.unload);addListener(document,'ezPageUnload',evts.unload);addListener(document,'copy',evts.copyPaste);addListener(document,'cut',evts.copyPaste);addListener(document,'mouseout',evts.mouseOut);addListener(document,'paste',evts.copyPaste);addListener(window,'beforeunload',evts.unload);addListener(window,'beforeunload',evts.addUnloadTime);addListener(window,'blur',evts.unload);addListener(window,'pagehide',evts.unload);addListener(window,'unload',evts.unload);if(document.readyState==='complete'){evts.load();}else{addListener(window,'load',evts.load);}
addListener(window,'pageshow',evts.pageshow);attachPageShareListeners();if(document.addEventListener){var visibilityChangeEventInfo=getVisibilityChangeEventInfo();visbilityChangeFunc=function(e){if(document[visibilityChangeEventInfo.hiddenPropName]){evts.unload(e);}else{evts.pageshow(e);}};document.addEventListener(visibilityChangeEventInfo.visibilityChangeEventName,visbilityChangeFunc,false);}else{document.attachEvent("onvisibilitychange",evts.unload);}}
function getVisibilityChangeEventInfo(){var hiddenPropName,visibilityChangeEventName;if(typeof document.hidden!=="undefined"){hiddenPropName="hidden";visibilityChangeEventName="visibilitychange";}else if(typeof document.msHidden!=="undefined"){hiddenPropName="msHidden";visibilityChangeEventName="msvisibilitychange";}else if(typeof document.webkitHidden!=="undefined"){hiddenPropName="webkitHidden";visibilityChangeEventName="webkitvisibilitychange";}
return{hiddenPropName:hiddenPropName,visibilityChangeEventName:visibilityChangeEventName};}
function removeListeners(){removeListener(document,'blur',evts.unload);removeListener(document,'copy',evts.copyPaste);removeListener(document,'cut',evts.copyPaste);removeListener(document,'mouseout',evts.mouseOut);removeListener(document,'paste',evts.copyPaste);removeListener(window,'beforeunload',evts.unload);removeListener(window,'beforeunload',evts.addUnloadTime);removeListener(window,'blur',evts.unload);removeListener(window,'pagehide',evts.unload);removeListener(window,'unload',evts.unload);removeListener(window,'load',evts.load);removeListener(window,'pageshow',evts.pageshow);removePageShareListeners();if(document.removeEventListener){var visibilityChangeEventInfo=getVisibilityChangeEventInfo();document.removeEventListener(visibilityChangeEventInfo.visibilityChangeEventName,visbilityChangeFunc,false);}else{document.detachEvent("onvisibilitychange",evts.unload);}}
function attachPageShareListeners(){var socialLinks=getSocialLinks();if(debug){var links=socialLinks.map(function(elm){return elm.href;});if(typeof links!=="undefined"){log("[Page Share] "+links.join(', '));}}
for(var i=0;i<socialLinks.length;i++){addListener(socialLinks[i],'click',evts.pageshare);}}
function removePageShareListeners(){var socialLinks=getSocialLinks();for(var i=0;i<socialLinks.length;i++){removeListener(socialLinks[i],'click',evts.pageshare);}}
function getSocialLinks(){var socialLinks=[];socialLinks.push.apply(socialLinks,document.querySelectorAll('a[href*="facebook.com/sharer/sharer.php"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('a[href*="facebook.com/sharer.php"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('a[href*="facebook.com/share.php"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('div[class*="fb-share-button"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('a[href*="twitter.com/share"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('a[href*="twitter.com/intent/tweet"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('iframe[class*="twitter-share-button"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('a[href*="plus.google.com/share"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('iframe[src*="apis.google.com/u/0/se/0/_/+1/sharebutton"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('a[href*="linkedin.com/cws/share"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('a[href*="linkedin.com/shareArticle"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('a[href*="pinterest.com/pin/create/button"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('a[href*="pinterest.com/pin/create/bookmarklet"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('a[href*="tumblr.com/share/link"]'));socialLinks.push.apply(socialLinks,document.querySelectorAll('a[href*="reddit.com/submit"]'));return socialLinks;}
function expireCookie(cname){log("Deleting "+cname);document.cookie=cname+'=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/';}
function getCookie(cname){var name=cname+"=";var decodedCookie=decodeURIComponent(document.cookie);var ca=decodedCookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1);}
if(c.indexOf(name)==0){return c.substring(name.length,c.length);}}
return "";}
function getCookieName(cname){return cname+"_"+did;}
function getSecondsOnPage(){return(new Date()-startTime)/1000;}
function firePixels(){__ez.bit.Fire();__ez.pel.Fire();}
function isEngagedPage(t){return t>=secondsUntilEngaged;}
function log(msg){if(debug)console.info("[UX] "+msg);}
function startRiveted(){if(typeof define==='function'&&define.amd){require(['ezRiveted'],function(riveted){initializeTimer(riveted);})}else{initializeTimer(riveted);}}
function stopRiveted(){if(typeof riveted!=="undefined"){timer=riveted;timer.reset();}}
function initializeTimer(riveted){timer=riveted;timer.init({reportInterval:5,idleTimeout:30,eventHandler:function(dataSeconds){log("Event: "+parseInt(dataSeconds)+" --- Engaged Time: "+parseInt(timer.getTime()));if(timer.getTime()>=maxEngagedSeconds){log('Turning off timer');evts.unload({type:'max'});timer.off();}}});}
function startAutomaticUnloadTimer(){autoTimer=setInterval(function(){evts.unload({type:'auto'});if(getSecondsOnPage()>maxEngagedSeconds){log('Turning off auto');clearInterval(autoTimer);}},autoUploadMs);}
function stopAutomaticUnloadTimer(){evts.unload({type:'auto'});clearInterval(autoTimer);}
function storePerformance(){log("[Performance] Store performance");if((storedPerf!=true&&window.performance)){var performanceNavigationTimingEntry=performance.getEntriesByType("navigation")[0];if(performanceNavigationTimingEntry&&performanceNavigationTimingEntry.connectEnd>0){var nav_start=performance.timeOrigin;var connect=performanceNavigationTimingEntry.connectEnd;var resp_start=performanceNavigationTimingEntry.responseStart;var resp_end=performanceNavigationTimingEntry.responseEnd;var interactive=performanceNavigationTimingEntry.domInteractive;var contloaded=performanceNavigationTimingEntry.domContentLoadedEventEnd;var complete=performanceNavigationTimingEntry.domComplete;if(nav_start>0&&complete>0){var navtye_string=performanceNavigationTimingEntry.type
var navtype=0;var redirect_count=performanceNavigationTimingEntry.redirectCount;switch(navtye_string){case "navigate":navtype=0;break
case "reload":navtype=1;break;case "back_forward":navtype=2;break
case "prerender":navtype=255;break
default:navtype=255;break}
__ez.bit.Add(pvID,[(new __ezDotData('navigation_type',navtype)),(new __ezDotData('redirect_count',redirect_count))]);perf_vals={};var perf_nav_to_connect=Math.round(connect);var perf_connect_to_resp_start=Math.round(resp_start);var perf_resp_time=Math.round(resp_end-resp_start);var perf_interactive=Math.round(interactive-resp_end);var perf_contentloaded=Math.round(contloaded-resp_end);var perf_complete=Math.round(complete-resp_end);__ez.bit.Add(pvID,[(new __ezDotData('perf_is_tracked',1)),(new __ezDotData('perf_nav_to_connect',perf_nav_to_connect)),(new __ezDotData('perf_connect_to_resp_start',perf_connect_to_resp_start)),(new __ezDotData('perf_resp_time',perf_resp_time)),(new __ezDotData('perf_interactive',perf_interactive)),(new __ezDotData('perf_contentloaded',perf_contentloaded)),(new __ezDotData('perf_complete',perf_complete))]);log("[Performance] perf_nav_to_connect: "+perf_nav_to_connect);log("[Performance] perf_connect_to_resp_start: "+perf_connect_to_resp_start);log("[Performance] perf_resp_time: "+perf_resp_time);log("[Performance] perf_interactive: "+perf_interactive);log("[Performance] perf_contentloaded: "+perf_contentloaded);log("[Performance] perf_complete: "+perf_complete);storedPerf=true;}}}}
function storeTimes(){var ckEt=getCookieName("ezux_et"),ckTos=getCookieName("ezux_tos"),et=timer.getTime()-totals.engagedAdded,tos=getSecondsOnPage()-totals.tosAdded;if(et==last.engagedTime){et=0;}
current.et=parseInt(et)+parseInt(current.et==""?0:current.et);current.tos=parseInt(tos)+parseInt(current.tos==""?0:current.tos);log("[Times] Total Engaged: "+current.et+" (+"+et+")");log("[Times] Total TOS: "+current.tos+" (+"+tos+")");__ez.ck.setByCat(ckEt+"="+current.et,3);__ez.ck.setByCat(ckTos+"="+current.tos,3);totals.engagedAdded+=et;totals.tosAdded+=tos;}
function storeAdBounce(cv){var vals=cv.split(' ');if(vals.length!==2){log("Invalid ezoawesome cookie value");}
var impId=vals[0],clickTime=vals[1];if(isNaN(clickTime)){return;}
var bounceTime=Math.floor((Date.now()-clickTime)/1000);__ez.pel.AddById(impId,[(new __ezDotData('click_bounce_time',bounceTime))]);log("[Bounce] impId: "+impId);log("[Bounce] bounceTime: "+bounceTime);}
function addPaintTimings(){if(typeof performance!=='undefined'&&performance!==null){var paintTimings=performance.getEntriesByType('paint');var fp=paintTimings.find(function(timing){return timing.name==='first-paint'});var fcp=paintTimings.find(function(timing){return timing.name==='first-contentful-paint'});if(typeof fp!=="undefined"&&fp!==null){var fpTime=Math.round(fp.startTime);__ez.bit.Add(pvID,[(new __ezDotData('first_paint',fpTime))]);log("first_paint: "+fpTime);}
if(typeof fcp!=="undefined"&&fcp!==null){var fcpTime=Math.round(fcp.startTime);__ez.bit.Add(pvID,[(new __ezDotData('first_contentful_paint',fcpTime))]);log("first_contentful_paint: "+fcpTime);}}}
function addConnectionInfo(){var connection=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(typeof connection!=="undefined"&&connection!==null){var type=connection.effectiveType;var downlink=connection.downlink;var rtt=connection.rtt;if(typeof type!=="undefined"&&type!==null){__ez.bit.Add(pvID,[(new __ezDotData('connection_effective_type',type))]);log("connection_effective_type: "+type);}
if(typeof downlink!=="undefined"&&downlink!==null){__ez.bit.Add(pvID,[(new __ezDotData('connection_downlink',downlink))]);log("connection_downlink: "+downlink);}
if(typeof rtt!=="undefined"&&rtt!==null){__ez.bit.Add(pvID,[(new __ezDotData('connection_rtt',rtt))]);log("connection_rtt: "+rtt);}}}
init();return{init:init,destroy:destroy};})();