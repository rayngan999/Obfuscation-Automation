function Messenger(a){this.win=a;this.init()}Messenger.prototype.init=function(){var a=this,b=function(c){c.source===a.win&&(a.onmessage||function(){}).call(a,c.data)};window.addEventListener?window.addEventListener("message",b,!1):window.attachEvent&&window.attachEvent("onmessage",b)};Messenger.prototype.send=function(a){this.win.postMessage(a,"*")};Messenger.initInParent=function(a){return new this(a.contentWindow)};Messenger.initInIframe=function(){return new this(window.parent)};
!window.postMessage&&window.attachEvent&&(Messenger.prototype.init=function(){var a=!1;try{a=!!this.win.location.href}catch(b){}a?(this.send=this.sendForSameOrigin,this.initForSameOrigin()):(this.queue=[],window.parent===this.win?this.initForParent():this.initForFrame())},Messenger.prototype.initForSameOrigin=function(){var a=this;document.attachEvent("ondataavailable",function(b){b.eventType&&"message"===b.eventType&&b.eventSource===a.win&&(a.onmessage||function(){}).call(a,b.eventData)})},Messenger.prototype.sendForSameOrigin=
function(a){var b=this;setTimeout(function(){var c=b.win.document.createEventObject();c.eventType="message";c.eventSource=window;c.eventData=a;b.win.document.fireEvent("ondataavailable",c)})},Messenger.prototype.initForParent=function(){var a=document.createDocumentFragment(),b=document.createElement("iframe");b.style.cssText="width: 1px; height: 1px; position: absolute; left: -999px; top: -999px;";a.appendChild(b);var c=document.createElement("iframe");c.style.cssText="width: 1px; height: 1px; position: absolute; left: -999px; top: -999px;";
a.appendChild(c);document.body.insertBefore(a,document.body.firstChild);this.senderWin=b.contentWindow;this.receiverWin=c.contentWindow;this.startReceive()},Messenger.prototype.initForFrame=function(){this.receiverWin=this.senderWin=null;var a=this;this.timerId=setInterval(function(){a.waitForFrame()},50)},Messenger.prototype.waitForFrame=function(){try{var a=this.win[1];var b=this.win[0]}catch(c){}a&&b&&(clearInterval(this.timerId),this.senderWin=a,this.receiverWin=b,this.queue.length&&this.flush(),
this.startReceive())},Messenger.prototype.startReceive=function(){var a=this;this.timerId=setInterval(function(){a.tryReceive()},50)},Messenger.prototype.tryReceive=function(){try{this.receiverWin.name;return}catch(b){}this.receiverWin.location.replace("about:blank");var a=this;setTimeout(function(){a.receive()},0)},Messenger.prototype.receive=function(){var a=null;try{a=this.receiverWin.name}catch(e){}if(a){this.receiverWin.name="";for(var b=this,c=a.substring(1).split("|"),d=0;d<c.length;d++)(function(){var e=
decodeURIComponent(c[d]);setTimeout(function(){(b.onmessage||function(){}).call(b,e)},0)})()}},Messenger.prototype.send=function(a){this.queue.push(a);this.senderWin&&this.flush()},Messenger.prototype.flush=function(){for(var a=[],b=0;b<this.queue.length;b++)a[b]=encodeURIComponent(this.queue[b]);a="|"+a.join("|");try{this.senderWin.name+=a,this.queue.length=0}catch(d){this.senderWin.location.replace("about:blank");var c=this;setTimeout(function(){c.flush()},0)}});
var TAM_SITE_PROTOCOL=document.location.protocol,TAM_SITE_URL="https://agent.tamedia.com.tw/rmadp",TAM_IDG_URL="https://adc.tamedia.com.tw/idg/pixel",TAM_TP_STATIC_JS="https://adc.tamedia.com.tw/rmadp/tp/",TAM_IDG_SID="o5xElKlfuno1",TAM_JS_VERSION="w30",TAM_SDK_VERSION="7.0.7",TAM_CONTENT_HOST,TAM_cookieExpire=336,TAM_cookieExpireRange=336,IDGraph_version="1.0.1",IDGCOOKIE_NAME="TAMIDG",IDGcookieExpire=336,IDGcookieExpireRange=336,TAM_CRITEO_URL="https://static.criteo.net/js/ld/publishertag.js",TAM_CRITEO_TPID=
11;TAM_CONTENT_HOST="http://124.29.140.178/rmadp"===TAM_SITE_URL||"http://124.29.140.209/rmadp"===TAM_SITE_URL?TAM_SITE_URL:"http://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL||"https://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL?"https://adcs1.tamedia.com.tw/rmadp":"https://adc.tamedia.com.tw/rmadp";"https:"===TAM_SITE_PROTOCOL&&(TAM_SITE_URL=tamReplacePortocol(TAM_SITE_URL),TAM_CONTENT_HOST=tamReplacePortocol(TAM_CONTENT_HOST));
var MADP_COOKIE_NAME="madpckyuud",MADP_AD_INSTANCE=[],TAM_AD_FORMAT_640x100={O:{width:640,height:100},L:{width:1280,height:200}},TAM_BANNER_AD_FORMAT_1200x627={O:{width:1200,height:627}},REQUEST_AD_SCRIPT_TAG="request_ad_script",TAM_madpStyle=document.getElementById("madpStyle");
if(!TAM_madpStyle){var stmt="\nbody {margin:0px;padding:0px;}\n.hd {display:none;}\n.clr {display:none;clear:both;}\n",style=document.createElement("style");style.setAttribute("id","madpStyle");style.setAttribute("type","text/css");style.styleSheet?style.styleSheet.cssText=stmt:style.appendChild(document.createTextNode(stmt));document.getElementsByTagName("head")[0].appendChild(style)}window.onpageshow=function(){for(var a=0;a<MADP_AD_INSTANCE.length;a++);};
function adLoad(a,b,c,d,e,g){adLoad2(a,b,c,d,0,e,g,1)}function adLoadTest(a,b,c,d,e,g){adLoad2(a,b,c,d,1,e,g,1)}function adLoad2Test(a,b,c,d,e,g){adLoad2(a,b,c,d,1,e,g,1)}function adLoad2(a,b,c,d,e,g,k,h){if(a){b||(b="");c||(c="");d||(d=!0);e||(e=0);"function"!==typeof g&&(g=null);k||(k=1);h||0==h||(h=1);var l={};l.slotSubId=a;l.venderId=b;l.containerId=c;l.openNewWindow=d;l.testFlag=e;l.callbackFunc=g;l.floatPosition=k;l.customCloseButton=h;thirdPartyCookieCheck(l)}}
var CLOSE_BUTTON_WIDTH=60,CLOSE_BUTTON_HEIGHT=60,CLOSE_BUTTON_INTERVAL=0,FLOAT_CLOSE_BUTTON_WIDTH=30,FLOAT_CLOSE_BUTTON_HEIGHT=30,FLOAT_CLOSE_BUTTON_INTERVAL=0,NARROW_BUTTON_WIDTH=40,NARROW_BUTTON_HEIGHT=40,NARROW_BUTTON_INTERVAL=40,NARROW_RECOVER_WINDOW_WIDTH=.8;NARROW_WINDOW_WIDTH=.25;NARROW_WINDOW_HEIGHT=.2;var NARROW_LANDSCAPE_WINDOW_WIDTH=.15;NARROW_LANDSCAPE_WINDOW_HEIGHT=.3;var NARROW_STATUS=!0,EngNumRegTest=/^[\d|a-zA-Z]+$/;function madpRequestAd(a){MADP_AD_INSTANCE.push(a);a.open()}
function tamediaRequestAd(a){var b=new MadpAd(a.slotSubId,a.venderId,a.containerId,a.openNewWindow,a.testFlag,a.callbackFunc,a.floatPosition,a.adload2guid,a.adKind,a.customCloseButton);a.sid&&"undefined"!=a.sid&&(b.subscriberId=a.sid);b.LTP=isLastTP(a.tpQueue)?1:0;b.errorCallback=function(c){handleTPRequest(a)};madpRequestAd(b)}
function criteoADcreate(a,b){tamLoadJS(TAM_CRITEO_URL,function(){criteoRequestAd(a,b,function(){b.LTP=isLastTP(b.tpQueue)?1:0;b.TPisFilled=0;b.YNcriteoAD=!1;b.CPM="";adtpi(a,b,TAM_CRITEO_TPID,tpiCallback)})},function(){b.LTP=isLastTP(b.tpQueue)?1:0;b.TPisFilled=0;b.YNcriteoAD=!1;b.CPM="";adtpi(a,b,TAM_CRITEO_TPID,tpiCallback)})}
function criteoRequestAd(a,b,c){var d=d||{};d[a.tpAdunit]={placements:[{slotid:b.containerId,zoneid:a.tpAdunit}]};window.Criteo=window.Criteo||{};window.Criteo.events=window.Criteo.events||[];var e=e||{},g=function(k,h,l){if(void 0===l&&(l=0),null!==e[k])if(void 0===e[k]&&null!==e[k])100>l&&setTimeout(function(){g(k,h,l+1)},200);else{if(document.getElementById(k)){b.CBWidth=e[k].width;b.CBHeight=e[k].height;var m=document.getElementById(b.containerId);m&&(m.innerHTML="");b.LTP=1;b.TPisFilled=1;b.YNcriteoAD=
!0;adtpi(a,b,TAM_CRITEO_TPID,tpiCallback)}}else"function"==typeof h&&h()};Criteo.events.push(function(){Criteo.RequestBids(d[a.tpAdunit],function(){var k=a.tpAdunit,h;for(h in d[k].placements){var l=d[k].placements[h],m=Criteo.GetBidsForAdUnit(l.slotid);e[l.slotid]=0<m.length?m[0]:null;for(var p in m)b.DisplayUrl=m[p].displayUrl,b.CPM=m[p].cpm}},2E3)});g(b.containerId,c)}
function CriteoAdDisplay(a,b,c){a=a.tpc+"?p3="+b.slotSubId+"&p4="+encodeURIComponent(navigator.userAgent)+"&p12="+b.testFlag+"&p13="+TAM_JS_VERSION+"&p15="+navigator.language+"&p21="+b.sid+"&p22="+TAM_SDK_VERSION+"&p24="+b.adload2guid+"&p28=MobileWeb%20"+TAM_SDK_VERSION+"&p44="+c+"&redirect=";b.DisplayUrl+="&ct0="+encodeURIComponent(a);if(c=document.getElementById(b.containerId))a=document.createElement("iframe"),a.setAttribute("id",b.containerId+"_iframe"),a.setAttribute("frameborder","0"),a.setAttribute("allowtransparency",
"true"),a.setAttribute("hspace","0"),a.setAttribute("marginwidth","0"),a.setAttribute("marginheight","0"),a.setAttribute("scrolling","no"),a.setAttribute("vspace","0"),a.setAttribute("width",b.CBWidth),a.setAttribute("height",b.CBHeight),c.appendChild(a),c='<script src="'+b.DisplayUrl+'">\x3c/script>',a=a.contentWindow.document,a.open(),a.write(c),a.close(),sendIDG("SEND",TAM_IDG_SID),b.callbackFunc("00")}
function adtpi(a,b,c,d){var e=tamCheckGetOrSetLocalStorageAndCookie(MADP_COOKIE_NAME),g=getWebCurrentUrl(),k=getWebCurrentUrlDomainName(g);c=a.tpi+"?p3="+b.slotSubId+"&p4="+encodeURIComponent(navigator.userAgent)+"&p12="+b.testFlag+"&p13="+TAM_JS_VERSION+"&p15="+navigator.language+"&p17="+tamCheckURLlength(k)+"&p21="+e+"&p22="+TAM_SDK_VERSION+"&p24="+b.adload2guid+"&p28=MobileWeb%20"+TAM_SDK_VERSION+"&p42="+tamCheckURLlength(g)+"&p44="+c+"&p45="+b.CPM+"&ltp="+b.LTP+"&isFilled="+b.TPisFilled;e=(new Date).getTime();
b.tpin=e;var h=document.createElement("script");h.setAttribute("type","text/javascript");h.setAttribute("id","adtpi_"+e);h.setAttribute("charset","UTF-8");h.readyState?h.onreadystatechange=function(){if("loaded"===h.readyState||"complete"===h.readyState){h.onreadystatechange=null;var l=eval("_TAMTP_TPI");d(l,a,b)}}:h.onload=function(){var l=eval("_TAMTP_TPI");d(l,a,b)};h.setAttribute("src",c);document.getElementsByTagName("head")[0].appendChild(h)}
var tpiCallback=function(a,b,c){var d=document.getElementById("adtpi_"+c.tpin);d&&document.getElementsByTagName("head")[0].removeChild(d);if(a)if("00"==a.responseCode&&a.sid){if(c.sid=a.sid,tamCheckCookie(MADP_COOKIE_NAME,c.sid)||tamCreateCookie(MADP_COOKIE_NAME,c.sid,TAM_cookieExpire,TAM_cookieExpireRange),!tamCheckLocalStorage(MADP_COOKIE_NAME,c.sid))try{localStorage.setItem(MADP_COOKIE_NAME,c.sid)}catch(e){}}else c.sid="";else c.sid="";c.YNcriteoAD?CriteoAdDisplay(b,c,TAM_CRITEO_TPID):handleTPRequest(c)},
MadpAd=function(a,b,c,d,e,g,k,h,l,m){this.version=TAM_JS_VERSION;this.sdkVersion=TAM_SDK_VERSION;this.slotSubId=a;this.publisher=b;this.containerId=c;this.openNewWindow=d;this.testFlag=e;this.subscriberId="";this.containerHeight=this.containerWidth=0;this.appType=this.height=this.width="0";this.openType="1";this.adData=null;this.scheduleInterval=6E4;this.scheduleTimes=10;this.timerId=this.oldScheduleTimes=0;this.messenger=this.adContainer=null;this.state;this.cookieExpireRange=this.cookieExpire=336;
this.sw;this.sh;this.adFormat="";this.expandableAd=null;this.callbackFunc=g;this.floatPosition=k;this.isInReadVisible=!1;this.adload2guid=h;this.customCloseButton=m;this.adKind=l;this.LTP;this.errorCallback;this.initial=function(){MadpAd.COUNT++;this.subscriberId=tamCheckGetOrSetLocalStorageAndCookie(MADP_COOKIE_NAME)};this.initial()};MadpAd.COUNT=0;MadpAd.BANNER_MAX_WIDTH=720;MadpAd.BANNER_DEFAULT_WIDTH=640;MadpAd.RESIZEABLE_BANNER_MAX_WIDTH=2*MadpAd.BANNER_DEFAULT_WIDTH;
MadpAd.RESIZEABLE_BANNER1200x627_MAX_WIDTH=1200;MadpAd.IN_READ_1200_627_MAX_WIDTH=1200;MadpAd.AD_FORMAT_1200x627={width:1200,height:627};MadpAd.AD_FORMAT_ANCHOR_IMAGE={width:640,height:280};MadpAd.AD_FORMAT_ANCHOR_VIDEO={width:560,height:315};MadpAd.ANCHOR_HEIGHT_WIDTH_IMAGE_RATIO=.4375;MadpAd.ANCHOR_HEIGHT_WIDTH_VIDEO_RATIO=.5625;
MadpAd.prototype.getResizeableBannerWidth=function(){var a=this.getPageWidth();"1"===this.adData.ad.type||"4"===this.adData.ad.type||"8"===this.adData.ad.type?a>MadpAd.RESIZEABLE_BANNER_MAX_WIDTH&&(a=MadpAd.RESIZEABLE_BANNER_MAX_WIDTH):a>MadpAd.BANNER_MAX_WIDTH&&(a=TAM_AD_FORMAT_640x100.O.width);return a};
MadpAd.prototype.getResizeableBannerHeight=function(){var a=this.getResizeableBannerWidth();return"1"===this.adData.ad.type||"4"===this.adData.ad.type||"8"===this.adData.ad.type?a<=1.5*TAM_AD_FORMAT_640x100.O.width?Math.round(a/TAM_AD_FORMAT_640x100.O.width*TAM_AD_FORMAT_640x100.O.height):Math.round(a/TAM_AD_FORMAT_640x100.L.width*TAM_AD_FORMAT_640x100.L.height):Math.round(a/TAM_AD_FORMAT_640x100.O.width*TAM_AD_FORMAT_640x100.O.height)};
MadpAd.prototype.getResizeableBannerWidth1200x627=function(){var a=document.getElementById(this.containerId).clientWidth||this.getPageWidth();("1"===this.adData.ad.type||"4"===this.adData.ad.type||"8"===this.adData.ad.type)&&a>MadpAd.RESIZEABLE_BANNER1200x627_MAX_WIDTH&&(a=MadpAd.RESIZEABLE_BANNER1200x627_MAX_WIDTH);return a};
MadpAd.prototype.getResizeableBannerHeight1200x627=function(){var a=this.getResizeableBannerWidth1200x627();if("1"===this.adData.ad.type||"4"===this.adData.ad.type||"8"===this.adData.ad.type)var b=Math.round(a/TAM_BANNER_AD_FORMAT_1200x627.O.width*TAM_BANNER_AD_FORMAT_1200x627.O.height);return b};MadpAd.prototype.getPageWidth=function(){var a=window,b=document,c=b.documentElement;b=b.getElementsByTagName("body")[0];return a.innerWidth||c.clientWidth||b.clientWidth};
MadpAd.prototype.getPageHeight=function(){var a=window,b=document,c=b.documentElement;b=b.getElementsByTagName("body")[0];return a.innerHeight||c.clientHeight||b.clientHeight};MadpAd.prototype.open=function(){requestAd(this)};
MadpAd.prototype.display=function(){this.adContainer||(this.prepareAllSize(),this.adContainer="256"===this.adData.ad.type&&"4"==this.adData.ad.subType?new InterscrollerContainer(this):new AdContainer(this),"128"===this.adData.ad.type?this.containerWidth<this.containerHeight?this.adContainer.adjust(this.containerWidth*NARROW_WINDOW_WIDTH,this.containerHeight*NARROW_WINDOW_HEIGHT):this.adContainer.adjust(this.containerWidth*NARROW_LANDSCAPE_WINDOW_WIDTH,this.containerHeight*NARROW_LANDSCAPE_WINDOW_HEIGHT):
this.adContainer.adjust(this.containerWidth,this.containerHeight),this.adContainer.loadAd(),this.initialMessenger())};MadpAd.prototype.reload=function(){this.adContainer&&this.adContainer.loadAd()};
MadpAd.prototype.prepareAllSize=function(){"256"==this.adData.ad.type&&"1"==this.adData.ad.subType?(this.width=this.getResizeable1200x627Width(),this.height=this.getResizeable1200x627Height()):"256"==this.adData.ad.type&&"8"==this.adData.ad.subType?(this.width=this.getResizeableAnchorWidth(),this.height=this.getResizeableAnchorHeight()):"16"===this.adData.ad.type||"128"===this.adData.ad.type||"256"===this.adData.ad.type&&"4"===this.adData.ad.subType?(this.width=this.getPageWidth(),this.height=this.getPageHeight(),
this.adFormat=""):(this.width=this.sw,this.height=this.sh);this._is640x100()?(this.containerWidth=this.getResizeableBannerWidth(),this.containerHeight=this.getResizeableBannerHeight()):this._is1200x627()?(this.containerWidth=this.getResizeableBannerWidth1200x627(),this.containerHeight=this.getResizeableBannerHeight1200x627()):(this.containerWidth=this.width,this.containerHeight=this.height)};
MadpAd.prototype.initialMessenger=function(){this.messenger=Messenger.initInParent(this.adContainer.framePanel.frame);var a=this,b,c,d=!1,e=!1,g=!1,k=!1,h,l,m,p,t,n=!1,u=[0,0],v=function(f){a.adContainer.framePanel.frame.style.height=f+"px"},z=function(){var f=getMobileOperatingSystem();"Windows Phone"!==f&&("Android"===f?n||(n=!0,t=getCssAttribute("HTML","overflow"),document.getElementsByTagName("HTML")[0].style.overflow="hidden"):window.scrollTo(u[0],u[1]))},A=function(){var f=a.getPageHeight();
a.getPageWidth()<f&&!e&&(e=!0,f=Math.floor(.3*document.body.scrollHeight),getWebScrollTop()+window.screen.height>=f?a.sendMessage("{halfOfPageContent:true}"):e=!1)},x=function(){if(window.visualViewport){var f="height offsetLeft offsetTop pageLeft pageTop scale width".split(" ").reduce(function(q,r){q[r]=window.visualViewport[r];return q},{});a.sendMessage(JSON.stringify({viewportData:f}))}},y=getWebScrollTop(),B=function(f){f.preventDefault();if(!k){k=!0;f=getWebScrollTop();if(2<Math.abs(f-y)){var q=
document.body.scrollHeight;var r=getWebScrollTop();q=Math.ceil((r+window.screen.height)/q*100);f<y?a.sendMessage(JSON.stringify({webScrollAndDirection:"scrollUp",webScrollPercent:q})):f>y&&a.sendMessage(JSON.stringify({webScrollAndDirection:"scrollDown",webScrollPercent:q}))}y=f;k=!1}},C=function(f){g||(h=f.touches[0].pageX,l=f.touches[0].pageY,m=getWebScrollLeft(),p=getWebScrollTop())},D=function(f){if(!g){g=!0;m-=getWebScrollLeft();p-=getWebScrollTop();switch(getDirection(h,l,f.changedTouches[0].pageX+
m,f.changedTouches[0].pageY+p)){case 1:a.sendMessage(JSON.stringify({webScrollAndDirection:"scrollDown"}));break;case 2:a.sendMessage(JSON.stringify({webScrollAndDirection:"scrollUp"}));break;case 3:a.sendMessage(JSON.stringify({webScrollAndDirection:"scrollLeft"}));break;case 4:a.sendMessage(JSON.stringify({webScrollAndDirection:"scrollRight"}))}g=!1}};this.messenger.onmessage=function(f){if("expandable_banner_click"===f)a.oldScheduleTimes=a.scheduleTimes,a.scheduleTimes=0,a.expandableAd=new ExpandableAd(a);
else if("close_ad"===f)document.getElementsByTagName("body")[0].removeChild(a.adContainer.panel),DFPcontainerClose(),document.removeEventListener("scroll",z),n&&(n=!1,document.getElementsByTagName("HTML")[0].style.overflow=t),g=!0;else if("disable_close_button"===f)try{a.adContainer.panel.removeChild(a.adContainer.closeBtnPanel.panel)}catch(w){}else if("disable_narrow_button"===f)try{a.adContainer.panel.removeChild(a.adContainer.narrowBtnPanel.panel)}catch(w){}else if("window_zoom_out"===f)NARROW_STATUS=
!1,a.containerWidth<a.containerHeight?a.adContainer.adjust(a.containerWidth,a.containerHeight*NARROW_RECOVER_WINDOW_WIDTH):a.adContainer.adjust(a.containerWidth,a.containerHeight);else if("window_zoom_in"===f)NARROW_STATUS=!0,a.containerWidth<a.containerHeight?a.adContainer.adjust(a.containerWidth*NARROW_WINDOW_WIDTH,a.containerHeight*NARROW_WINDOW_HEIGHT):a.adContainer.adjust(a.containerWidth*NARROW_LANDSCAPE_WINDOW_WIDTH,a.containerHeight*NARROW_LANDSCAPE_WINDOW_HEIGHT);else if("anchor_iframe_expandable_close"===
f)a.anchorExpandable=!1,v(a.containerHeight),document.removeEventListener("scroll",z),n&&(n=!1,document.getElementsByTagName("HTML")[0].style.overflow=t);else if("anchor_iframe_expandable_open"===f)a.anchorExpandable=!0,f=a.getPageHeight(),v(f),document.removeEventListener("scroll",A),u[0]=getWebScrollLeft(),u[1]=getWebScrollTop(),document.addEventListener("scroll",z);else if("anchor_iframe_expandable_close_only"===f)a.anchorExpandable=!1,v(a.containerHeight);else if("anchor_iframe_expandable_open_only"===
f)a.anchorExpandable=!0,f=a.getPageHeight(),v(f);else if("panel_show"===f)a.adContainer.panel.style.visibility="visible";else if("panel_hide"===f)a.adContainer.panel.style.visibility="hidden";else if("panel_display_show"===f)a.adContainer.panel.style.display="block";else if("panel_display_hide"===f)a.adContainer.panel.style.display="none";else if("panel_enable_touch"===f)a.adContainer.panel.style.pointerEvents="auto";else if("panel_disable_touch"===f)a.adContainer.panel.style.pointerEvents="none";
else if("viewport_detect"===f)window.visualViewport&&(window.visualViewport.addEventListener("resize",x),window.visualViewport.addEventListener("scroll",x),x());else if("viewport_detect_stop"===f)window.visualViewport&&(window.visualViewport.removeEventListener("resize",x),window.visualViewport.removeEventListener("scroll",x));else if("fingerMove_detect"===f){a.anchorExpandable=!1;f=a.getPageHeight();var q=a.getPageWidth();q<f?a.sendMessage("{mobileDirectionIsProtrait:true}"):a.sendMessage("{mobileDirectionIsProtrait:false}");
document.addEventListener("scroll",A,!1);window.addEventListener("touchstart",{});window.addEventListener("touchend",{})}else if("fingerMove_detect_stop"===f)document.removeEventListener("scroll",A);else if("webMove_detect"===f)f=a.getPageHeight(),q=a.getPageWidth(),q<f?a.sendMessage("{mobileDirectionIsProtrait:true}"):a.sendMessage("{mobileDirectionIsProtrait:false}"),document.addEventListener("touchstart",C,!1),document.addEventListener("touchend",D,!1);else if("webContentScroll_detect"===f)document.addEventListener("scroll",
B,!1);else if("in_read_ad_visible"===f.substring(0,18))try{a.isInReadVisible=eval("("+f.split("/")[1]+")"),d=!0,setTimeout(function(){d=!1},500)}catch(w){console.log("exception: "+w)}else if("in_read_ad_range"===f.substring(0,16))try{"256"===a.adData.ad.type&&"4"===a.adData.ad.subType&&window.innerWidth<=window.innerHeight&&(a.adContainer.panel.style.display="block");b=eval("("+f.split("/")[1]+")");var r=window.extern||"undefined"!==typeof $sf?$sf.ext:null;if("undefined"!==typeof r&&r)try{r.register(parseInt(a.width),
parseInt(a.height),function(w,E){"geom-update"==w&&checkAreaInPageWithSafeFrame.bind(a,r,b)()}),checkAreaInPageWithSafeFrame.bind(a,r,b)()}catch(w){console.log("Exception or no safeframes available!")}else _tam_isInIframe()?console.log("exception: TAMedia inread ad cannot put inside iframe !"):("undefined"!==typeof c&&document.removeEventListener("scroll",c),checkAreaInPage.bind(a,b)(),c=function(){d||checkAreaInPage.bind(a,b)()},document.addEventListener("scroll",c))}catch(w){console.log("exception: "+
w)}}};MadpAd.prototype.sendMessage=function(a){this.messenger&&this.messenger.send(a)};MadpAd.prototype.isResizeableAD=function(){return this.adData.ad.type&&"16"===this.adData.ad.type?!0:this.adData.ad.type&&"128"===this.adData.ad.type?!0:!this.adData.ad.type||"256"!==this.adData.ad.type||"1"!==this.adData.ad.subType&&"4"!==this.adData.ad.subType&&"8"!==this.adData.ad.subType?this._is1200x627()?!0:this._is640x100():!0};MadpAd.prototype._is640x100=function(){return"640"===this.width&&"100"===this.height};
MadpAd.prototype._is1200x627=function(){return"1200"===this.width&&"627"===this.height};MadpAd.prototype.getResizeable1200x627Width=function(){var a=document.getElementById(this.containerId).clientWidth||this.getPageWidth();a>MadpAd.IN_READ_1200_627_MAX_WIDTH&&(a=MadpAd.AD_FORMAT_1200x627.width);return a};MadpAd.prototype.getResizeable1200x627Height=function(){var a=this.getResizeable1200x627Width();return Math.round(a/MadpAd.AD_FORMAT_1200x627.width*MadpAd.AD_FORMAT_1200x627.height)};
MadpAd.prototype.getResizeableAnchorWidth=function(){return this.getResizeableAnchorHeight()/(this.sw==MadpAd.AD_FORMAT_ANCHOR_VIDEO.width&&this.sh==MadpAd.AD_FORMAT_ANCHOR_VIDEO.height?MadpAd.ANCHOR_HEIGHT_WIDTH_VIDEO_RATIO:MadpAd.ANCHOR_HEIGHT_WIDTH_IMAGE_RATIO)};
MadpAd.prototype.getResizeableAnchorHeight=function(){var a=screen.height;window.innerHeight<window.innerWidth&&screen.height>screen.width&&(a=screen.width);var b=window.innerWidth*(this.sw==MadpAd.AD_FORMAT_ANCHOR_VIDEO.width&&this.sh==MadpAd.AD_FORMAT_ANCHOR_VIDEO.height?MadpAd.ANCHOR_HEIGHT_WIDTH_VIDEO_RATIO:MadpAd.ANCHOR_HEIGHT_WIDTH_IMAGE_RATIO);a*=.3;b>a&&(b=a);return b};
var ExpandableAd=function(a){this.adObject=a;this.container;this.frame;this.button;this.buttonUrl=TAM_CONTENT_HOST+"/img/close.png";this.messenger;this.init=function(){if(top.location!==self.location){var b=top.document.body.clientWidth;var c=window.screen.height}else b=window.innerWidth,c=window.innerHeight;this.container=document.createElement("div");this.container.setAttribute("id","expandableDiv");this.container.style.margin="0px";this.container.style.padding="0px";this.container.style.position=
"absolute";this.container.style.left="0px";this.container.style.top="0px";this.container.style.width=b+"px";this.container.style.height=c+"px";this.container.style.zIndex="90000";this.frame=top.location!==self.location?top.document.createElement("iframe"):document.createElement("iframe");this.frame.setAttribute("id","expandableIframe");this.frame.setAttribute("frameBorder","0");this.frame.setAttribute("frameSpacing","0");this.frame.setAttribute("scrolling","no");this.frame.setAttribute("marginHeight",
"0");this.frame.setAttribute("marginWidth","0");this.frame.setAttribute("allowTransparency","true");this.frame.style.position="absolute";this.frame.style.left="0px";this.frame.style.top="0px";this.frame.style.width=b+"px";this.frame.style.height=c+"px";this.container.appendChild(this.frame);this.button=top.location!==self.location?top.document.createElement("div"):document.createElement("div");this.button.setAttribute("id","closeButton");this.button.style.cursor="pointer";this.button.style.margin=
"0px";this.button.style.padding="0px";this.button.style.position="absolute";this.button.style.left=b-CLOSE_BUTTON_WIDTH-CLOSE_BUTTON_INTERVAL+"px";this.button.style.top=CLOSE_BUTTON_INTERVAL+"px";this.button.style.width=CLOSE_BUTTON_WIDTH+"px";this.button.style.height=CLOSE_BUTTON_HEIGHT+"px";this.button.style.backgroundImage="url("+this.buttonUrl+")";this.button.style.zIndex="9999";this.container.appendChild(this.button);top.location!==self.location?top.document.getElementsByTagName("body")[0].appendChild(this.container):
document.getElementsByTagName("body")[0].appendChild(this.container);if("http://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL||"https://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL)this.adObject.adData.ad.b2=this.adObject.adData.ad.b2.replace("http://124.29.140.175/","https://adcs1.tamedia.com.tw/");"https:"===TAM_SITE_PROTOCOL&&(this.adObject.adData.ad.b2=tamReplacePortocol(this.adObject.adData.ad.b2));this.frame.setAttribute("src",this.adObject.adData.ad.b2);this.initialMessenger();var d=this.adObject,
e=this.messenger;this.frame.addEventListener("load",function(){var h="{adWidth:"+d.containerWidth+", adHeight:"+d.containerHeight+', clickFunction:"'+d.adData.curl+'", targetUrl:"'+d.adData.ad.turl+'", siteUrl:"'+TAM_SITE_URL+'", contentHost:"'+TAM_CONTENT_HOST+'", subscriberId:"'+d.subscriberId+'", adSlotSubId:"'+d.slotSubId+'", adPlanId:"'+d.adData.pid+'", jsVersion:"'+d.version+'", sdkVersion:"'+d.sdkVersion+'", uuid:"'+d.uuid+'", testFlag:'+d.testFlag+", openNewWindow:"+d.openNewWindow+", expandableFlag: true}";
e?e.send(h):console.log("messenger is null. [@ExpandableAd]")},!1);var g=this.container;this.button.addEventListener("click",function(){document.getElementsByTagName("body")[0].removeChild(g);d.scheduleTimes=d.oldScheduleTimes},!1);var k=this.button;this.messenger.onmessage=function(h){"close_ad"===h?document.getElementsByTagName("body")[0].removeChild(g):"disable_close_button"===h&&g.removeChild(k)}};this.init()};
ExpandableAd.prototype.initialMessenger=function(){var a=document.getElementById("expandableIframe");this.messenger=Messenger.initInParent(a)};ExpandableAd.prototype.adjustSize=function(){var a=window.innerWidth,b=window.innerHeight;this.container.style.width=a+"px";this.container.style.height=b+"px";this.frame.style.width=a+"px";this.frame.style.height=b+"px";this.button.style.left=a-CLOSE_BUTTON_WIDTH-CLOSE_BUTTON_INTERVAL+"px"};
var InterscrollerContainer=function(a){this.owner=a;this.panel;this.framePanel;this.textPanelUp;this.textPanelDown;this.inner;this.isShow=!1;this.init=function(){var b=this.owner,c=this.owner.getPageWidth();this.panel=document.getElementById(this.owner.containerId);this.panel.setAttribute("style","position:relative;width: 100%;height:"+c+"px;display:none;");this.framePanel=new FramePanel(this);this.framePanel.frame.setAttribute("src",this.owner.adData.ad.b);this.framePanel.frame.addEventListener("load",
function(){loadAdFinish(b)},!1);this.textPanelUp=document.createElement("div");this.textPanelUp.innerHTML="Advertising";this.textPanelUp.setAttribute("style","width: 100%;color: #ffffff;background-color: #000000;text-align: center;line-height: 1.5rem;font-Family: verdana, Lucida Console, Arial;top: 0;left: 0;z-Index: 9;position: absolute;");this.inner=document.createElement("div");this.inner.setAttribute("id","banner-core");this.inner.setAttribute("style","width: 100%;top: 0;left: 0;bottom: 0;clip: rect(0px, auto, auto, 0px);clip-path: inset(0px);overflow: hidden;position: absolute;");
this.inner.appendChild(this.framePanel.frame);this.textPanelDown=document.createElement("div");this.textPanelDown.innerHTML="Advertising";this.textPanelDown.setAttribute("style","width: 100%;color: #ffffff;background-color: #000000;text-align: center;line-height: 1.5rem;font-Family: verdana, Lucida Console, Arial;bottom: 0;left: 0;z-Index: 9;position: absolute;");this.panel.appendChild(this.textPanelUp);this.panel.appendChild(this.inner);this.panel.appendChild(this.textPanelDown)};this.init()};
InterscrollerContainer.prototype.adjust=function(a,b){this.panel.style.height=a+"px";this.framePanel.adjust(0,0,a,b);this.closeBtnPanel&&this.closeBtnPanel.adjust(a);this.narrowBtnPanel&&this.narrowBtnPanel.adjust(a)};
InterscrollerContainer.prototype.loadAd=function(){if("http://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL||"https://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL)this.owner.adData.ad.b=this.owner.adData.ad.b.replace("http://124.29.140.175/","https://adcs1.tamedia.com.tw/");"https:"===TAM_SITE_PROTOCOL&&(this.owner.adData.ad.b=tamReplacePortocol(this.owner.adData.ad.b));this.framePanel.frame.setAttribute("src",this.owner.adData.ad.b)};
var AdContainer=function(a){this.owner=a;this.panel;this.framePanel;this.closeBtnPanel;this.narrowBtnPanel;this.init=function(){var b=document.getElementById(this.owner.containerId);"16"===this.owner.adData.ad.type?(this.panel=document.createElement("div"),this.panel.style.margin="0px",this.panel.style.padding="0px","16"===this.owner.adData.ad.type&&(this.panel.style.position="fixed"),this.panel.style.left="0px",this.panel.style.top="0px",this.panel.style.width=this.owner.containerWidth+"px",this.panel.style.height=
this.owner.containerHeight+"px",this.panel.style.zIndex="100000000",document.getElementsByTagName("body")[0].appendChild(this.panel)):"128"===this.owner.adData.ad.type?(this.panel=document.createElement("div"),this.panel.style.margin="0px",this.panel.style.padding="0px",this.panel.style.position="fixed",this.panel.style.top="50%",this.panel.style.webkitTransform="translateY(-50%)",this.panel.style.MozTransform="translateY(-50%)",this.panel.style.msTransform="translateY(-50%)",this.panel.style.OTransform=
"translateY(-50%)",this.panel.style.transform="translateY(-50%)",1==this.owner.floatPosition?this.panel.style.left="0px":this.panel.style.right="0px",this.panel.style.zIndex="9999",document.getElementsByTagName("body")[0].appendChild(this.panel)):"256"===this.owner.adData.ad.type&&"8"===this.owner.adData.ad.subType?(this.panel=document.createElement("div"),this.panel.style.width="100%",this.panel.style.textAlign="center",this.panel.style.position="fixed",this.panel.style.bottom="0px",this.panel.style.zIndex=
"99999",document.getElementsByTagName("body")[0].appendChild(this.panel)):this.panel=b;this.framePanel=new FramePanel(this);"16"===this.owner.adData.ad.type&&"0"==this.owner.customCloseButton&&(this.closeBtnPanel=new CloseBtnPanel(this));"128"===this.owner.adData.ad.type&&(this.closeBtnPanel=new CloseBtnPanel(this),this.narrowBtnPanel=new NarrowBtnPanel(this));var c=this.owner;this.framePanel.frame.addEventListener("load",function(){loadAdFinish(c)},!1)};this.init()};
AdContainer.prototype.adjust=function(a,b){this.owner.adData.ad.type&&"256"!==this.owner.adData.ad.type&&("1"!==this.owner.adData.ad.type&&"4"!==this.owner.adData.ad.type||"1200"!==this.owner.adData.ad.sw||"627"!==this.owner.adData.ad.sh)&&(this.panel.style.width=a+"px",this.panel.style.height=b+"px");this.framePanel.adjust(0,0,a,b);this.closeBtnPanel&&this.closeBtnPanel.adjust(a);this.narrowBtnPanel&&this.narrowBtnPanel.adjust(a)};
AdContainer.prototype.loadAd=function(){if("http://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL||"https://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL)this.owner.adData.ad.b=this.owner.adData.ad.b.replace("http://124.29.140.175/","https://adcs1.tamedia.com.tw/");"https:"===TAM_SITE_PROTOCOL&&(this.owner.adData.ad.b=tamReplacePortocol(this.owner.adData.ad.b));"1"!==this.owner.adData.ad.dcm||"1"!==this.owner.adData.ad.type&&"2"!==this.owner.adData.ad.type&&"4"!==this.owner.adData.ad.type&&"16"!==
this.owner.adData.ad.type||(this.owner.adData.ad.b=this.owner.adData.ad.b+"&turl="+encodeURIComponent(this.owner.adData.ad.turl));this.framePanel.frame.setAttribute("src",this.owner.adData.ad.b)};
var FramePanel=function(a){this.parent=a;this.frame;this.init=function(){this.frame=document.createElement("iframe");this.frame.setAttribute("frameBorder","0");this.frame.setAttribute("frameSpacing","0");this.frame.setAttribute("scrolling","no");this.frame.setAttribute("marginHeight","0");this.frame.setAttribute("marginWidth","0");this.frame.setAttribute("allowTransparency","true");this.frame.style.left="0px";this.frame.style.top="0px";"16"===this.parent.owner.adData.ad.type?this.frame.style.position=
"absolute":"256"===this.parent.owner.adData.ad.type&&"4"===this.parent.owner.adData.ad.subType?(this.frame.style.webkitTransform="translateZ(0)",this.frame.style.MozTransform="translateZ(0)",this.frame.style.msTransform="translateZ(0)",this.frame.style.OTransform="translateZ(0)",this.frame.style.transform="translateZ(0)",this.frame.style.backfaceVisibility="hidden",this.frame.style.position="fixed"):"256"===this.parent.owner.adData.ad.type&&"8"===this.parent.owner.adData.ad.subType&&(this.frame.style.display=
"block",this.frame.style.margin="auto");this.parent.panel.appendChild(this.frame)};this.init()};FramePanel.prototype.adjust=function(a,b,c,d){this.frame.style.left=a+"px";this.frame.style.top=b+"px";this.frame.style.width=c+"px";this.frame.style.height=d+"px"};
var CloseBtnPanel=function(a){this.parent=a;this.panel;this.interval=CLOSE_BUTTON_INTERVAL;this.width=CLOSE_BUTTON_WIDTH;this.height=CLOSE_BUTTON_HEIGHT;this.buttonUrl=TAM_CONTENT_HOST+"/img/close.png";"128"===a.owner.adData.ad.type&&(this.interval=FLOAT_CLOSE_BUTTON_INTERVAL,this.width=FLOAT_CLOSE_BUTTON_WIDTH,this.height=FLOAT_CLOSE_BUTTON_HEIGHT,this.buttonUrl=TAM_CONTENT_HOST+"/img/float_close_small.png");this.init=function(){this.panel=document.createElement("div");this.panel.style.cursor="pointer";
this.panel.style.margin="0px";this.panel.style.padding="0px";this.panel.style.position="absolute";this.panel.style.left="0px";this.panel.style.top=this.interval+"px";this.panel.style.width=this.width+"px";this.panel.style.height=this.height+"px";this.panel.style.backgroundImage="url("+this.buttonUrl+")";this.panel.style.zIndex=9999;this.panel.style.backgroundRepeat="no-repeat";var b=this.parent.owner.containerId;this.panel.addEventListener("click",function(){closeBtnPanelClick(b)},!1);"128"!=a.owner.adData.ad.type&&
this.parent.panel.appendChild(this.panel)};this.init()};
CloseBtnPanel.prototype.adjust=function(a){"128"===this.parent.owner.adData.ad.type?(NARROW_STATUS?(this.panel.style.width=this.width+"px",this.panel.style.height=this.height+"px",this.panel.style.left=a-this.width-this.interval+"px",this.buttonUrl=TAM_CONTENT_HOST+"/img/float_close_small.png"):(this.panel.style.width=this.width+10+"px",this.panel.style.height=this.height+10+"px",this.panel.style.left=a-(this.width+10)-(this.interval+10)+"px",this.buttonUrl=TAM_CONTENT_HOST+"/img/float_close_big.png"),
this.panel.style.backgroundImage="url("+this.buttonUrl+")"):this.panel.style.left=a-this.width-CLOSE_BUTTON_INTERVAL+"px"};
var closeBtnPanelClick=function(a){for(var b in ResizeList){var c=ResizeList[b];if(c.containerId===a){document.getElementsByTagName("body")[0].removeChild(c.adContainer.panel);ResizeList.splice(b,1);break}}},NarrowBtnPanel=function(a){this.parent=a;this.panel;this.floatCloseInterval=FLOAT_CLOSE_BUTTON_INTERVAL;this.floatCloseWidth=FLOAT_CLOSE_BUTTON_WIDTH+10;this.interval=FLOAT_CLOSE_BUTTON_INTERVAL;this.width=NARROW_BUTTON_WIDTH;this.height=NARROW_BUTTON_HEIGHT;this.buttonUrl=TAM_CONTENT_HOST+"/img/float_narrow.png";
this.init=function(){this.panel=document.createElement("div");this.panel.style.cursor="pointer";this.panel.style.margin="0px";this.panel.style.padding="0px";this.panel.style.position="absolute";this.panel.style.left="0px";this.panel.style.top=this.interval+"px";this.panel.style.width=this.width+"px";this.panel.style.height=this.height+"px";this.panel.style.backgroundImage="url("+this.buttonUrl+")";this.panel.style.zIndex=9999;var b=this.parent;this.panel.addEventListener("click",function(){narrowBtnPanelClick(b)},
!1);this.parent.panel.appendChild(this.panel)};this.init()};NarrowBtnPanel.prototype.adjust=function(a){this.panel.style.display=1==NARROW_STATUS?"none":"block";this.panel.style.left=a-this.width-this.interval-this.floatCloseInterval-this.floatCloseWidth+"px"};
var narrowBtnPanelClick=function(a){NARROW_STATUS=!0;a.owner.containerWidth<a.owner.containerHeight?a.adjust(a.owner.containerWidth*NARROW_WINDOW_WIDTH,a.owner.containerHeight*NARROW_WINDOW_HEIGHT):a.adjust(a.owner.containerWidth*NARROW_LANDSCAPE_WINDOW_WIDTH,a.owner.containerHeight*NARROW_LANDSCAPE_WINDOW_HEIGHT);a.owner.sendMessage("{adType:"+a.owner.adData.ad.type+", adNarrow : "+NARROW_STATUS+"}")},requestAd=function(a){a.uuid=a.adload2guid;var b=tamCheckGetOrSetLocalStorageAndCookie(MADP_COOKIE_NAME);
b?a.subscriberId=b:a.subscriberId||(a.subscriberId="");b=getWebCurrentUrl();var c=getWebCurrentUrlDomainName(b);b=TAM_SITE_URL+"/g/adr?p3="+a.slotSubId+"&p4="+encodeURIComponent(navigator.userAgent)+"&p12="+a.testFlag+"&p13="+a.version+"&p15="+navigator.language+"&p17="+tamCheckURLlength(c)+"&p21="+a.subscriberId+"&p22="+a.sdkVersion+"&p24="+a.uuid+"&p28=MobileWeb%20"+a.sdkVersion+"&p40=0&p42="+tamCheckURLlength(b)+"&ltp="+a.LTP;var d=document.createElement("script");d.setAttribute("type","text/javascript");
d.setAttribute("id",REQUEST_AD_SCRIPT_TAG+"_"+a.containerId);d.setAttribute("charset","UTF-8");d.readyState?d.onreadystatechange=function(){if("loaded"===d.readyState||"complete"===d.readyState)d.onreadystatechange=null,requestAdCallback(a)}:d.onload=function(){requestAdCallback(a)};d.setAttribute("src",b);document.getElementsByTagName("head")[0].appendChild(d)},requestAdCallback=function(a){removeScriptTag(a);if(!receiveAdData(a))"21"==a.adData.responseCode?a.callbackFunc("21"):"function"==typeof a.errorCallback&&
a.errorCallback(a.adData.responseCode);else if(a.adData.slot.flag&&"1"===a.adData.slot.flag){a.scheduleInterval=a.adData.slot.sec?1E3*a.adData.slot.sec:6E4;a.scheduleTimes=a.adData.slot.times?a.adData.slot.times:10;var b=document.getElementById(a.containerId);b&&(b.innerHTML="");a.display();"16"!==a.adData.ad.type&&"128"!==a.adData.ad.type&&"256"!==a.adData.ad.type&&0==a.adKind&&regWindowInterval(a);a.isResizeableAD()&&(bookResizeList(a),regWindowResize());null!=a.callbackFunc&&a.callbackFunc("00")}},
removeScriptTag=function(a){(a=document.getElementById(REQUEST_AD_SCRIPT_TAG+"_"+a.containerId))&&document.getElementsByTagName("head")[0].removeChild(a)};function getAdInfoDown(a){var b=a.split("_")[1];if(EngNumRegTest.test(b)&&50>b.length)return(new Function("return "+a))();console.log("[TAMedia] \u7248\u4f4dID\u6709\u8aa4\uff0c\u8acb\u6aa2\u67e5\u7248\u4f4dID.");return!1}
function receiveAdData(a){try{if(a.adData=getAdInfoDown("_"+a.slotSubId+"_adData"),"undefined"!==typeof a.adData&&"undefined"!==typeof a.adData.responseCode&&"00"===a.adData.responseCode&&a.adData){if("http://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL||"https://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL)a.adData.curl=a.adData.curl.replace("http://124.29.140.209/","https://portals1.tamedia.com.tw/");"https:"===TAM_SITE_PROTOCOL&&(a.adData.curl=tamReplacePortocol(a.adData.curl),a.adData.ad.videoReportUrl=
tamReplacePortocol(a.adData.ad.videoReportUrl));"16"!==a.adData.ad.type&&"128"!==a.adData.ad.type?(a.adData.ad.sw&&(a.sw=a.adData.ad.sw),a.adData.ad.sh&&(a.sh=a.adData.ad.sh)):(a.sw=0,a.sh=0,a.adFormat="");if(a.adData.sid){a.subscriberId=a.adData.sid;tamCheckCookie(MADP_COOKIE_NAME,a.adData.sid)||tamCreateCookie(MADP_COOKIE_NAME,a.adData.sid,a.cookieExpire,a.cookieExpireRange);if(!tamCheckLocalStorage(MADP_COOKIE_NAME,a.adData.sid))try{localStorage.setItem(MADP_COOKIE_NAME,a.adData.sid)}catch(b){}sendIDG("SEND",
TAM_IDG_SID)}else a.subscriberId=""}else return!1}catch(b){return!1}return!0}var ResizeList=[],bookResizeList=function(a){ResizeList.push(a)},regWindowResize=function(){window.onresize||(window.onresize=function(){handleResize()})};
function handleResize(){for(var a in ResizeList){var b=ResizeList[a];if(b instanceof MadpAd&&b.isResizeableAD()){if(!b.adContainer)break;if("256"===b.adData.ad.type&&"4"===b.adData.ad.subType)if("block"===b.adContainer.panel.style.display&&window.innerWidth<=window.innerHeight)continue;else if(window.innerWidth>window.innerHeight){b.adContainer.panel.style.display="none";continue}else b.adContainer.panel.style.display="block";b.expandableAd&&b.expandableAd.adjustSize();b.prepareAllSize();if("128"===
b.adData.ad.type)b.containerWidth<b.containerHeight?b.adContainer.adjust(b.containerWidth*NARROW_WINDOW_WIDTH,b.containerHeight*NARROW_WINDOW_HEIGHT):b.adContainer.adjust(b.containerWidth*NARROW_LANDSCAPE_WINDOW_WIDTH,b.containerHeight*NARROW_LANDSCAPE_WINDOW_HEIGHT);else if("256"===b.adData.ad.type&&"8"===b.adData.ad.subType)try{var c=b.getPageHeight(),d=b.getPageWidth();b.anchorExpandable?d>c?(b.adContainer.adjust(b.containerWidth,b.containerHeight),b.sendMessage("{anchorIsProtrait:false}")):(b.adContainer.adjust(d,
c),b.sendMessage("{anchorIsProtrait:true}")):(d>c?b.sendMessage("{anchorIsProtrait:false}"):b.sendMessage("{anchorIsProtrait:true}"),b.adContainer.adjust(b.containerWidth,b.containerHeight))}catch(e){b.adContainer.adjust(b.containerWidth,b.containerHeight)}else b.adContainer.adjust(b.containerWidth,b.containerHeight);b.sendMessage("{adWidth:"+b.containerWidth+", adHeight:"+b.containerHeight+', clickFunction:"'+b.adData.curl+'", targetUrl:"'+b.adData.ad.turl+'", siteUrl:"'+TAM_SITE_URL+'", contentHost:"'+
TAM_CONTENT_HOST+'", subscriberId:"'+b.subscriberId+'", adSlotSubId:"'+b.slotSubId+'", adPlanId:"'+b.adData.pid+'", jsVersion:"'+b.version+'", sdkVersion:"'+b.sdkVersion+'", uuid:"'+b.uuid+'", testFlag:'+b.testFlag+", openNewWindow:"+b.openNewWindow+", expandableFlag: false, adType:"+b.adData.ad.type+", floatPosition : "+b.floatPosition+', floatType : "'+b.adData.ad.floatType+'"}')}}}
var tpAdRefreshInterval=function(a){try{a.reloadSec=1E3*parseInt(a.reloadSec);a.reloadTimes=parseInt(a.reloadTimes);var b=window.setInterval(function(){0<--a.reloadTimes?thirdPartyCookieCheck(a):window.clearInterval(b)},a.reloadSec)}catch(c){}},regWindowInterval=function(a){a.timerId=window.setInterval(function(){scheduleRequestAd(a)},a.scheduleInterval)},scheduleRequestAd=function(a){if(0<--a.scheduleTimes){a.uuid=guid();var b=getWebCurrentUrl(),c=getWebCurrentUrlDomainName(b);b=TAM_SITE_URL+"/g/adr?p3="+
a.slotSubId+"&p4="+encodeURIComponent(navigator.userAgent)+"&p12="+a.testFlag+"&p13="+a.version+"&p15="+navigator.language+"&p17="+tamCheckURLlength(c)+"&p21="+a.subscriberId+"&p22="+a.sdkVersion+"&p24="+a.uuid+"&p28=MobileWeb%20"+a.sdkVersion+"&p40=0&p42="+tamCheckURLlength(b)+"&ltp="+a.LTP;var d=document.createElement("script");d.setAttribute("type","text/javascript");d.setAttribute("id",REQUEST_AD_SCRIPT_TAG+"_"+a.containerId);d.setAttribute("charset","UTF-8");d.readyState?d.onreadystatechange=
function(){if("loaded"===d.readyState||"complete"===d.readyState)d.onreadystatechange=null,scheduleRequestAdCallback(a)}:d.onload=function(){scheduleRequestAdCallback(a)};d.setAttribute("src",b);document.getElementsByTagName("head")[0].appendChild(d)}else window.clearInterval(a.timerId)},scheduleRequestAdCallback=function(a){removeScriptTag(a);receiveAdData(a)?a.adData.slot.flag&&"1"===a.adData.slot.flag&&(a.reload(),null!=a.callbackFunc&&a.callbackFunc("00")):null!=a.callbackFunc&&a.callbackFunc("20")},
addFrameOnloadListener=function(a,b){b.attachEvent?b.attachEvent("onload",function(){loadAdFinish(a)}):b.onload=function(){loadAdFinish(a)}},loadAdFinish=function(a){var b={adWidth:a.containerWidth,adHeight:a.containerHeight,clickFunction:a.adData.curl,targetUrl:a.adData.ad.turl,siteUrl:TAM_SITE_URL,contentHost:TAM_CONTENT_HOST,subscriberId:a.subscriberId,adSlotSubId:a.slotSubId,adPlanId:a.adData.pid+"",jsVersion:a.version,sdkVersion:a.sdkVersion,uuid:a.uuid,testFlag:a.testFlag,openNewWindow:a.openNewWindow,
expandableFlag:!1,adType:a.adData.ad.type,floatPosition:a.floatPosition,floatType:a.adData.ad.floatType,trackingUrl:a.adData.trackingUrl,adSubType:a.adData.ad.subType,videoReportUrl:a.adData.ad.videoReportUrl,validSec:a.adData.ad.validSec,videoDuration:a.adData.ad.duration};"undefined"!==typeof a.adData.inr&&a.adData.inr&&(Object.assign(b,a.adData.inr),"undefined"!==typeof a.adData.inr.vast&&a.adData.inr.vast&&(a.adData.inr.vast.adParameters.duration=a.adData.inr.vast.duration));a.sendMessage(JSON.stringify(b))};
function StringBuilder(){this.strings=[]}StringBuilder.prototype.append=function(a){this.strings.push(a)};StringBuilder.prototype.toString=function(){return this.strings.join("")};function tamGetCookie(a){var b=document.cookie,c=b.indexOf(a+"="),d="";-1<c&&(a=c+a.length+1,c=b.indexOf(";",a),-1===c&&(c=b.length),d=b.substring(a,c),d=decodeURIComponent(d));return d}function tamCheckCookie(a,b){return b?tamGetCookie(a)!=b?!1:!0:!1}
function tamCreateCookie(a,b,c,d){a=encodeURIComponent(a)+"="+encodeURIComponent(b);a+=";path="+location.pathname.substring(0,location.pathname.lastIndexOf("/"));b=0;d&&(b=Math.random()*(d-1)+1);if(c){d=new Date;d.setTime(d.getTime()+36E5*(parseInt(c)+parseInt(b)));var e=d.toGMTString()}e&&(a+=";expires="+e);document.cookie=a}function TPsetCookie(a,b,c){var d=new Date;d.setTime(d.getTime()+864E5*c);c="expires="+d.toGMTString();document.cookie=a+"="+b+";"+c+";path=/"}
function IDGcreateCookie(a,b,c){var d=new Date,e=d.getTime();a=encodeURIComponent(a)+"="+e;a+=";path="+location.pathname.substring(0,location.pathname.lastIndexOf("/"));e=0;c&&(e=Math.random()*(c-1)+1);if(b){d.setTime(d.getTime()+36E5*(parseInt(b)+parseInt(e)));var g=d.toGMTString()}g&&(a+=";expires="+g);document.cookie=a}function tamCookieDelete(a){document.cookie=a+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}
function tamCheckLocalStorage(a,b){return b?window.localStorage?localStorage.getItem(a)!=b?!1:!0:!1:!1}function tamCheckGetOrSetLocalStorageAndCookie(a){var b=tamGetCookie(MADP_COOKIE_NAME);if(b)try{window.localStorage&&(localStorage.getItem(a)?tamCheckLocalStorage(MADP_COOKIE_NAME,b)||localStorage.setItem(a,b):localStorage.setItem(a,b))}catch(c){}else try{window.localStorage?localStorage.getItem(a)?(b=localStorage.getItem(a),tamCreateCookie(a,b,336,336)):b="":b=""}catch(c){b=""}return b}
function guid(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return guidToBytes(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a())}function guidToBytes(a){var b=[];a.split("-").map(function(c,d){(3>d?c.match(/.{1,2}/g).reverse():c.match(/.{1,2}/g)).map(function(e){b.push(parseInt(e,16))})});return _arrayBufferToBase64(b)}
function _arrayBufferToBase64(a){var b="";a=new Uint8Array(a);for(var c=a.byteLength,d=0;d<c;d++)b+=String.fromCharCode(a[d]);return window.btoa(b).split("=")[0].replace(/\+/ig,"-").replace(/\//ig,"_")}var TAM_NATIVE_AD_SLOT_SUBID,TAM_serialNumber=0,callBackFuncArrayNum=0,TAM_serialNumberArray=[],TAM_serialNumberArrayNum=0;
function getNativeAdParas(a,b){a&&""!=a||(TAM_NATIVE_AD_SLOT_SUBID=a);"function"===typeof b&&(TAM_serialNumberArray[callBackFuncArrayNum]=TAM_serialNumber);var c=tamCheckGetOrSetLocalStorageAndCookie(MADP_COOKIE_NAME),d=guid(),e=getWebCurrentUrl(),g=getWebCurrentUrlDomainName(e);c=TAM_SITE_URL+"/g/adr?p3="+a+"&p4="+encodeURIComponent(navigator.userAgent)+"&p12=0&p13="+TAM_JS_VERSION+"&p15="+navigator.language+"&p17="+tamCheckURLlength(g)+"&p21="+c+"&p22="+TAM_SDK_VERSION+"&p24="+d+"&p28=MobileWeb%20"+
TAM_SDK_VERSION+"&p40=0&p42="+tamCheckURLlength(e);var k=document.createElement("script");k.setAttribute("type","text/javascript");k.setAttribute("id",REQUEST_AD_SCRIPT_TAG+"_"+TAM_serialNumberArray[callBackFuncArrayNum]);k.setAttribute("charset","UTF-8");k.readyState?k.onreadystatechange=function(){if("loaded"===k.readyState||"complete"===k.readyState){k.onreadystatechange=null;var h=eval("_"+a+"_adData");NADCallback(h,a,TAM_serialNumberArray[TAM_serialNumberArrayNum],b)}}:k.onload=function(){var h=
eval("_"+a+"_adData");NADCallback(h,a,TAM_serialNumberArray[TAM_serialNumberArrayNum],b)};k.setAttribute("src",c);document.getElementsByTagName("head")[0].appendChild(k);callBackFuncArrayNum++;TAM_serialNumber++}
var adData,NADCallback=function(a,b,c,d){TAM_serialNumberArrayNum++;if(a.sid&&(tamCheckCookie(MADP_COOKIE_NAME,a.sid)||tamCreateCookie(MADP_COOKIE_NAME,a.sid,TAM_cookieExpire,TAM_cookieExpireRange),!tamCheckLocalStorage(MADP_COOKIE_NAME,a.sid)))try{localStorage.setItem(MADP_COOKIE_NAME,a.sid)}catch(e){}if(a.curl){if("http://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL||"https://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL)a.curl=a.curl.replace("http://124.29.140.209/","https://portals1.tamedia.com.tw/");
"https:"===TAM_SITE_PROTOCOL&&(a.curl=tamReplacePortocol(a.curl))}(b=document.getElementById(REQUEST_AD_SCRIPT_TAG+"_"+c))&&document.getElementsByTagName("head")[0].removeChild(b);try{if(a)if(a.nad)sendIDG("SEND",TAM_IDG_SID),d&&"function"==typeof d?("https:"===TAM_SITE_PROTOCOL&&(a.nad=replaceNADUrl(a.nad)),d(a.nad)):d("10");else return d("20"),!1;else return d("30"),!1}catch(e){return d("30"),!1}};
function replaceNADUrl(a){if("http://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL||"https://portals1.tamedia.com.tw/rmadp"===TAM_SITE_URL)null!=a.ICONSQUARE&&(a.ICONSQUARE=a.ICONSQUARE.replace("http://124.29.140.175/","https://adcs1.tamedia.com.tw/")),null!=a.ICONRECTANGLE&&(a.ICONRECTANGLE=a.ICONRECTANGLE.replace("http://124.29.140.175/","https://adcs1.tamedia.com.tw/")),null!=a.VIDEO&&(a.VIDEO=a.VIDEO.replace("http://124.29.140.175/","https://adcs1.tamedia.com.tw/")),null!=a.IMAGE720X1280&&(a.IMAGE720X1280=
a.IMAGE720X1280.replace("http://124.29.140.175/","https://adcs1.tamedia.com.tw/")),null!=a.IMAGE1280X720&&(a.IMAGE1280X720=a.IMAGE1280X720.replace("http://124.29.140.175/","https://adcs1.tamedia.com.tw/")),null!=a.IMAGE960X640&&(a.IMAGE960X640=a.IMAGE960X640.replace("http://124.29.140.175/","https://adcs1.tamedia.com.tw/")),null!=a.IMAGE640X960&&(a.IMAGE640X960=a.IMAGE640X960.replace("http://124.29.140.175/","https://adcs1.tamedia.com.tw/")),null!=a.IMAGE1200X627&&(a.IMAGE1200X627=a.IMAGE1200X627.replace("http://124.29.140.175/",
"https://adcs1.tamedia.com.tw/")),null!=a.nurl&&(a.nurl=a.nurl.replace("http://124.29.140.209/","https://portals1.tamedia.com.tw/"));"https:"===TAM_SITE_PROTOCOL&&(null!=a.ICONSQUARE&&(a.ICONSQUARE=tamReplacePortocol(a.ICONSQUARE)),null!=a.ICONRECTANGLE&&(a.ICONRECTANGLE=tamReplacePortocol(a.ICONRECTANGLE)),null!=a.VIDEO&&(a.VIDEO=tamReplacePortocol(a.VIDEO)),null!=a.IMAGE720X1280&&(a.IMAGE720X1280=tamReplacePortocol(a.IMAGE720X1280)),null!=a.IMAGE1280X720&&(a.IMAGE1280X720=tamReplacePortocol(a.IMAGE1280X720)),
null!=a.IMAGE960X640&&(a.IMAGE960X640=tamReplacePortocol(a.IMAGE960X640)),null!=a.IMAGE640X960&&(a.IMAGE640X960=tamReplacePortocol(a.IMAGE640X960)),null!=a.IMAGE1200X627&&(a.IMAGE1200X627=tamReplacePortocol(a.IMAGE1200X627)),null!=a.nurl&&(a.nurl=tamReplacePortocol(a.nurl)));return a}function tamReplacePortocol(a){return a=a.replace("http:","https:")}
function getWebCurrentUrl(){var a="";try{adManagerCurl&&"function"===typeof adManagerCurl?a=adManagerCurl():(a=window.location.href,tamCheckUrlSafeframeOrNot(a)&&(a=document.referrer))}catch(b){a=window.location.href,tamCheckUrlSafeframeOrNot(a)&&(a=document.referrer)}return a}function getWebCurrentUrlDomainName(a){var b="";try{var c=a.match(/^https?:\/\/([^\/?#]+)(?:[\/?#]|$)/i);b=c&&c[1]}catch(d){b=""}return b}
function GetIEVersion(){var a=window.navigator.userAgent,b=a.indexOf("MSIE");return 0<b?parseInt(a.substring(b+5,a.indexOf(".",b))):navigator.userAgent.match(/Trident\/7\./)?11:0}function tamCheckUrlSafeframeOrNot(a){return-1!==a.indexOf("safeframe")?!0:!1}
function tamCheckURLlength(a){if(200>=a.length)var b=0<GetIEVersion()?encodeURIComponent(encodeURIComponent(a)):encodeURIComponent(a);else if(a.startsWith("http")){a.indexOf("//");var c=a.substr(0,6);b=getWebCurrentUrlDomainName(a);b=null!==b?0<GetIEVersion()?encodeURIComponent(encodeURIComponent(c+"//"+b)):encodeURIComponent(c+"//"+b):0<GetIEVersion()?encodeURIComponent(encodeURIComponent(a.substr(0,199))):encodeURIComponent(a.substr(0,199))}else b=0<GetIEVersion()?encodeURIComponent(encodeURIComponent(a.substr(0,
199))):encodeURIComponent(a.substr(0,199));return b}
function sendIDG(a,b){if(2==Math.floor(2*Math.random()+1)){var c=tamGetCookie(IDGCOOKIE_NAME);if(c){var d=(new Date).getTime(),e=parseInt(d);c=parseInt(c);if(e<=c+216E5)return;d=encodeURIComponent(IDGCOOKIE_NAME)+"="+d;d+=";path="+location.pathname.substring(0,location.pathname.lastIndexOf("/"));e=Math.random()*(IDGcookieExpireRange-1)+1;c=new Date;c.setTime(c.getTime()+36E5*(336+parseInt(e)));e=c.toGMTString();document.cookie=d+(";expires="+e)}else IDGcreateCookie(IDGCOOKIE_NAME,IDGcookieExpire,
IDGcookieExpireRange);try{if(b){var g=TAM_IDG_URL+"?p1="+b+"&p8="+IDGraph_version+"&t="+Math.random()+"_"+(new Date).getTime(),k=new Image;k.src=g;k.style.display="none"}}catch(h){console.log(arguments,this)}}}Object.assign=function(a,b){if(null==a)throw new TypeError("Cannot convert undefined or null to object");for(var c=Object(a),d=1;d<arguments.length;d++){var e=arguments[d];if(null!=e)for(var g in e)Object.prototype.hasOwnProperty.call(e,g)&&(c[g]=e[g])}return c};
function checkAreaInPageWithSafeFrame(a,b){var c=a.inViewPercentage(),d="256"===this.adData.ad.type&&"4"===this.adData.ad.subType,e="256"===this.adData.ad.type&&"8"===this.adData.ad.subType;if(window.innerWidth>window.innerHeight&&d)this.sendMessage("{isAdVisible:false}"),this.isInReadVisible=!1;else if(e)this.sendMessage("{isAdVisible:true}"),this.isInReadVisible=!0;else if(0<c){c=b.right-b.left;d=b.bottom-b.top;e=b.left;var g=b.top,k=a.geom().self.w-b.right,h=a.geom().self.h-b.bottom,l=a.geom().exp.l,
m=a.geom().exp.t,p=a.geom().exp.r,t=a.geom().exp.b,n=a.geom().win.w,u=a.geom().win.h,v=parseFloat(this.adData.inr.impPercent)/100;m+g+d*v<=u&&t+h+d*v<=u&&l+e+c*v<=n&&p+k+c*v<=n?(this.sendMessage("{isAdVisible:true}"),this.isInReadVisible=!0):(this.sendMessage("{isAdVisible:false}"),this.isInReadVisible=!1);this.prevPageHeight=u}else this.sendMessage("{isAdVisible:false}"),this.isInReadVisible=!1}
function checkAreaInPage(a){var b="256"===this.adData.ad.type&&"4"===this.adData.ad.subType,c="256"===this.adData.ad.type&&"8"===this.adData.ad.subType;if(window.innerWidth>window.innerHeight&&b)this.sendMessage("{isAdVisible:false}"),this.isInReadVisible=!1;else if(c)this.sendMessage("{isAdVisible:true}"),this.isInReadVisible=!0;else{var d=this.adContainer.framePanel;c=getElementOffset(this.adContainer.panel);var e=b?getElementOffset(d.frame):c;d={};d.top=a.top+e.top;d.bottom=a.bottom+e.top;d.left=
a.left+e.left;d.right=a.right+e.left;"undefined"!==typeof this.adData.inr.impPercent&&(a=parseFloat(this.adData.inr.impPercent)/100,(b=b?isAreaInParent(d,c,a):isAreaInPage(d,a))?(this.sendMessage("{isAdVisible:true}"),this.isInReadVisible=!0):b||(this.sendMessage("{isAdVisible:false}"),this.isInReadVisible=!1))}}
function isAreaInPage(a,b){var c=window.pageYOffset||document.documentElement.scrollTop,d=window.pageXOffset||document.documentElement.scrollLeft,e=d+window.innerWidth,g=a.bottom-a.top;return c+window.innerHeight-a.top>g*b&&a.bottom-c>g*b&&e>=a.left&&a.right>=d?!0:!1}function isAreaInParent(a,b,c){var d=a.bottom-a.top;return b.bottom-a.top>d*c&&a.bottom-b.top>d*c&&b.right>=a.left&&a.right>=b.left?!0:!1}function _tam_isInIframe(){try{return window.self!==window.top}catch(a){return!0}}
function getElementOffset(a){a=a.getBoundingClientRect();var b=window.pageXOffset||document.documentElement.scrollLeft,c=window.pageYOffset||document.documentElement.scrollTop;return{left:a.left+b,top:a.top+c,right:a.left+b+a.width,bottom:a.top+c+a.height}}function tamLoadJS(a,b,c){var d=document.createElement("script");d.type="text/javascript";d.async=!0;d.src=a;d.onload=b;d.onerror=c;document.body.appendChild(d)}
function thirdPartyCookieCheck(a){var b=guid();a.adload2guid=b;if(1==a.testFlag)a.adKind=0,tamediaRequestAd(a);else if(b=tamGetCookie("TP"+a.slotSubId)){var c=b.split("_");b=parseInt(1E3*c[0]);c=parseInt(c[1]);if(parseInt((new Date).getTime())<=c+b){var d=window.atob(tamGetCookie("tptpi"+a.slotSubId)),e=window.atob(tamGetCookie("tptpc"+a.slotSubId)),g=window.atob(tamGetCookie("tppriority"+a.slotSubId)),k=window.atob(tamGetCookie("TPADU"+a.slotSubId)),h=tamGetCookie("tpreload"+a.slotSubId).split("_");
(b=window.atob(tamGetCookie("tpdelayshowup"+a.slotSubId)))&&"undefined"!==typeof b?setTimeout(function(){try{var l=JSON.parse(k),m=JSON.parse(g);a.tpPriority=m;a.adKind=1;h&&"undefined"!=typeof h&&1<h.length&&"undefined"==typeof a.reloadSec&&"undefined"==typeof a.reloadTimes&&(a.reloadSec=h[0],a.reloadTimes=h[1],tpAdRefreshInterval(a));for(var p=[],t=0;t<m.length;t++){var n={};n.tpName=m[t];n.tpAdunit="TAMedia"==n.tpName?a.slotSubId:l[n.tpName];n.tpi=d;n.tpc=e;p.push(n)}a.tpQueue=p;handleTPRequest(a)}catch(u){tamCookieDelete("TP"+
a.slotSubId),tamCookieDelete("TPADU"+a.slotSubId),tamCookieDelete("tppriority"+a.slotSubId),tamCookieDelete("tptpi"+a.slotSubId),tamCookieDelete("tptpc"+a.slotSubId),tamCookieDelete("tpreload"+a.slotSubId),tamCookieDelete("tpdelayshowup"+a.slotSubId),slotMapping(a)}},b):(tamCookieDelete("TP"+a.slotSubId),tamCookieDelete("TPADU"+a.slotSubId),tamCookieDelete("tppriority"+a.slotSubId),tamCookieDelete("tptpi"+a.slotSubId),tamCookieDelete("tptpc"+a.slotSubId),tamCookieDelete("tpreload"+a.slotSubId),tamCookieDelete("tpdelayshowup"+
a.slotSubId),slotMapping(a))}else tamCookieDelete("TP"+a.slotSubId),tamCookieDelete("TPADU"+a.slotSubId),tamCookieDelete("tppriority"+a.slotSubId),tamCookieDelete("tptpi"+a.slotSubId),tamCookieDelete("tptpc"+a.slotSubId),tamCookieDelete("tpreload"+a.slotSubId),tamCookieDelete("tpdelayshowup"+a.slotSubId),slotMapping(a)}else slotMapping(a)}
function slotMapping(a){var b=(new Date).getTime();a.serialNum=b;b=TAM_TP_STATIC_JS+a.slotSubId+"Mapping.js";var c=document.createElement("script");c.setAttribute("type","text/javascript");c.setAttribute("id","TAMslotMapping_"+a.slotSubId+"_"+a.serialNum);c.setAttribute("charset","UTF-8");var d;c.readyState?c.onreadystatechange=function(){if("loaded"===c.readyState||"complete"===c.readyState)c.onreadystatechange=null,d=eval("_TAMTP_INFO"),slotMappingCallback(d,a)}:(c.onload=function(){d=eval("_TAMTP_INFO");
slotMappingCallback(d,a)},c.onerror=function(){var e=document.getElementById("TAMslotMapping_"+a.slotSubId+"_"+a.serialNum);e&&document.getElementsByTagName("head")[0].removeChild(e);e=(new Date).getTime();TPsetCookie("TP"+a.slotSubId,"3600_"+e,30);a.adKind=0;tamediaRequestAd(a)});c.setAttribute("src",b+"?"+a.serialNum);document.getElementsByTagName("head")[0].appendChild(c)}
var slotMappingCallback=function(a,b){var c=document.getElementById("TAMslotMapping_"+b.slotSubId+"_"+b.serialNum);c&&document.getElementsByTagName("head")[0].removeChild(c);try{var d=1E3*a.ad.delayShowUp;d&&"undefined"!=d?(setTimeout(function(){readyToRunAd(a,b)},d),TPsetCookie("tpdelayshowup"+b.slotSubId,window.btoa(d),30)):(TPsetCookie("tpdelayshowup"+b.slotSubId,window.btoa(0),30),readyToRunAd(a,b))}catch(e){TPsetCookie("tpdelayshowup"+b.slotSubId,window.btoa(0),30),readyToRunAd(a,b)}},readyToRunAd=
function(a,b){try{var c=a.priority;b.tpPriority=c;b.adKind=1;a.slot&&"undefined"!=typeof a.slot&&"undefined"==typeof b.reloadSec&&"undefined"==typeof b.reloadTimes&&(b.reloadSec=a.slot.sec,b.reloadTimes=a.slot.times,TPsetCookie("tpreload"+b.slotSubId,a.slot.sec+"_"+a.slot.times,30),tpAdRefreshInterval(b));TPsetCookie("tppriority"+b.slotSubId,window.btoa(JSON.stringify(c)),30);TPsetCookie("tptpi"+b.slotSubId,window.btoa(a.api.tpi),30);TPsetCookie("tptpc"+b.slotSubId,window.btoa(a.api.tpc),30);for(var d=
[],e=0;e<c.length;e++){var g={};g.tpName=c[e];g.tpAdunit="TAMedia"==g.tpName?b.slotSubId:a.adunit[g.tpName];g.tpi=a.api.tpi;g.tpc=a.api.tpc;d.push(g)}b.tpQueue=d;if("undefined"!=typeof a.adunit&&a.adunit){var k=window.btoa(JSON.stringify(a.adunit));TPsetCookie("TPADU"+b.slotSubId,k,30)}var h=(new Date).getTime();TPsetCookie("TP"+b.slotSubId,a.refresh+"_"+h,30);handleTPRequest(b)}catch(l){b.adKind=0,tamediaRequestAd(b)}};
function handleTPRequest(a){var b=a.tpQueue;"object"==typeof b&&0<b.length?(b=b.shift(),"Criteo"==b.tpName?criteoADcreate(b,a):"TAMedia"==b.tpName?tamediaRequestAd(a):handleTPRequest(a)):null!=a.callbackFunc&&a.callbackFunc("20")}function isLastTP(a){return"object"==typeof a&&0<a.length?!1:!0}function DFPcontainerClose(){try{"google_ads_iframe_"===window.frameElement.id.substring(0,18)&&window.frameElement.remove()}catch(a){}}function getAngle(a,b){return 180*Math.atan2(b,a)/Math.PI}
function getDirection(a,b,c,d){a=c-a;d-=b;b=0;if(10>Math.abs(a)&&10>Math.abs(d))return b;d=getAngle(a,d);-135<=d&&-45>=d?b=1:45<d&&135>d?b=2:135<=d&&180>=d||-180<=d&&-135>d?b=3:-45<=d&&45>=d&&(b=4);return b}function getWebScrollLeft(){var a=0;document.documentElement&&document.documentElement.scrollLeft?a=document.documentElement.scrollLeft:document.body&&(a=document.body.scrollLeft);return a}
function getWebScrollTop(){var a=0;document.documentElement&&document.documentElement.scrollTop?a=document.documentElement.scrollTop:document.body&&(a=document.body.scrollTop);return a}function getCssAttribute(a,b){var c=document.getElementsByTagName(a)[0];return window.getComputedStyle(c,null).getPropertyValue(b)}
function getMobileOperatingSystem(){var a=navigator.userAgent||navigator.vendor||window.opera;return/windows phone/i.test(a)?"Windows Phone":/android/i.test(a)?"Android":/iPad|iPhone|iPod/.test(a)&&!window.MSStream?"iOS":"unknown"};