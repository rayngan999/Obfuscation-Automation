var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj};window.usagetrack.addFilter(function(sEvent,jEl,aParents){if(jEl.data('ctc-track')){var aData=jEl.data('ctc-track'),action=aData[0],label=aData[1];if(document.location.pathname.startsWith('/real-estate-blog/')){action='Blog '+action}window.ga('send','event','direct',action,label);return true}});window.visitedManager=function(){var VISITED_PROPERTIES_KEY='c21.visitedproperties',oVisitedProperties=null;function loadVisitedProperties(){var sVisited;if(oVisitedProperties===null){sVisited=localStorage.getItem(VISITED_PROPERTIES_KEY);if(sVisited){oVisitedProperties=JSON.parse(sVisited)}else{oVisitedProperties={};saveVisitedProperties()}}return oVisitedProperties}function saveVisitedProperties(){localStorage.setItem(VISITED_PROPERTIES_KEY,JSON.stringify(oVisitedProperties))}function addVisitedProperty(sKey){loadVisitedProperties();if(!oVisitedProperties[sKey]){oVisitedProperties[sKey]=1;saveVisitedProperties();markVisitedProperty(sKey);$(document).trigger('property-visited',{key:sKey})}}function markVisitedProperty(sKey){$('.property-card[data-id='+sKey+']').addClass('visited')}function markVisitedProperties(){loadVisitedProperties();for(var sKey in oVisitedProperties){markVisitedProperty(sKey)}}return{addVisitedProperty:addVisitedProperty,markVisitedProperties:markVisitedProperties,getVisitedProperties:loadVisitedProperties}}();window.locationManager=function(){var LOCATION_DATA_VERSION=1,LOCATION_DATA_TIMEOUT=1000*60*60*24,oLocationData={};window.LocalBackup=[];function initialize(){if((typeof localStorage==='undefined'?'undefined':_typeof(localStorage))==='object'){try{localStorage.setItem('localStorage',1);localStorage.removeItem('localStorage')}catch(e){Storage.prototype._setItem=Storage.prototype.setItem;Storage.prototype.setItem=function(key,value){var localStorage={};localStorage[key]=value;LocalBackup.push(localStorage)};Storage.prototype._getItem=Storage.prototype.getItem;Storage.prototype.getItem=function(key){return window.LocalBackup[key]}}}var sLocation=localStorage.getItem('c21-geo-location'),bIsHome=$('body').hasClass('home');if(sLocation===null||sLocation===undefined){lookupLocation(bIsHome)}else{oLocationData=JSON.parse(sLocation);if(bIsHome||oLocationData.version!==LOCATION_DATA_VERSION||new Date().getTime()-LOCATION_DATA_TIMEOUT>oLocationData.lastUpdate){lookupLocation(bIsHome,oLocationData.lid)}}if(oLocationData.lid){$(document).trigger('locationset',oLocationData)}}function locationChange(e,oNewLoc){var sLocation=localStorage.getItem('c21-geo-location'),bIsHome=$('body').hasClass('home')||oNewLoc&&oNewLoc.doListings;if(!oLocationData.lid){if(sLocation===null||sLocation===undefined){lookupLocation(bIsHome,oNewLoc.lid)}else{oLocationData=JSON.parse(sLocation);if(oLocationData.lid!=oNewLoc.lid){lookupLocation(bIsHome,oNewLoc.lid)}}}else if(oLocationData.lid!=oNewLoc.lid||bIsHome){lookupLocation(bIsHome,oNewLoc.lid)}}$(document).on('locationchange',locationChange);function lookupLocation(isHome,lid){var oParams={};if(lid){oParams.lid=lid}if(isHome){oParams.properties=1}$.get('/geolookup',oParams,function(data){if(data.location&&data.location.result){$.extend(oLocationData,data.location.result);oLocationData.version=LOCATION_DATA_VERSION;oLocationData.lastUpdate=new Date().getTime();setLocation(oLocationData);$(document).trigger('locationset',oLocationData)}else{$('#homepage-location-actions').hide();$('#fha-link-container').addClass('no-location-fha-link-container')}if(data.propertyHtml){$(document).trigger('locationproperties',data.propertyHtml)}})}function setLocation(location){localStorage.setItem('c21-geo-location',JSON.stringify(location))}function setNewLid(lid){oLocationData.lid=lid;oLocationData.lastUpdate=0}return $.extend({initialize:initialize,setLocation:setLocation,setNewLid:setNewLid},oLocationData)}();function setupC21Dropdown(){$('.c21-dropdown').on('click',function(e){$(this).css('outline','none')});$('body.res .c21-dropdown').on('click keydown',function(e){if(e.keyCode===13||e.type==='click'){var jThis=$(this),bOpen=jThis.hasClass('c21-dropdown-open');if(e.target.tagName.toLowerCase()==='a'){return}if(!bOpen){usagetrack.onClick(e);$('body.res .c21-dropdown-open').not(jThis).removeClass('c21-dropdown-open').trigger('dropdown-close');$('body.res .fadeInDown').removeClass('fadeInDown');jThis.addClass('c21-dropdown-open').find('> div').addClass('fadeInDown');e.preventDefault();return false}}});$('.c21-dropdown-ignore').on('click keydown',function(e){if(e.keyCode===13||e.type==='click'){e.preventDefault();return false}});$('header.site-header .ftsClear').on('click keydown',function(e){if(e.keyCode===13||e.type==='click'){searchToggle('collapse')}});$(document).add('#dropdown').on('click keydown',function(e){if(e.keyCode===13||e.type==='click'){if($('.homepage-input-wrapper .c21-dropdown-open').length>0){}else{$('body.res .c21-dropdown-open').not($(this)).removeClass('c21-dropdown-open').trigger('dropdown-close');$('body.res .fadeInDown').removeClass('fadeInDown')}}})}function handleFindAHomeMegaNav(){$('#dynamic-location-links .bug').click(function(){$('#dynamic-location-links a.homesForSale').click();document.location.href=$('#dynamic-location-links a.homesForSale').attr('href')})}function handleHomepageImgSwapPanel(){var $panel=$('.js-panel-imageswap');$panel.on('click','.selector-btn',function(){$panel.find('img[data-imagelabel]').removeClass('selected');var newImage=$(this).data('showimage');$panel.find('img[data-imagelabel="'+newImage+'"]').addClass('selected');$panel.find('#selectorPanel .selector-group').removeClass('active');$(this).parent().addClass('active')})}function searchToggle(forceMode){var $dropdown=$('#dropdown');var shouldClose=$dropdown.hasClass('active')||forceMode==='collapse';if(shouldClose){$dropdown.removeClass('active');$('nav.header-main-nav').removeClass('search-open')}else{$dropdown.addClass('active');$('nav.header-main-nav').addClass('search-open');setTimeout(function(){$('#searchText').focus()},50)}}$(document).ready(function(){setupC21Dropdown();$('#account-my-favorites').on('click',function(e){location.href='/myc21Overview.c21'});$('#account-sign-out').on('click',function(e){myc21.logout()});$('#account-create-account').on('click',function(e){myc21.createAccountForm.open()});$('#account-sign-in').on('click',function(e){myc21.loginForm.open()});$('body.res .header-chat').on('click',function(){Botcopy.openWindow()});$('.js-language-toggle').on('click',function(e){$('#language-options-modal').toggleClass('open');$('body').toggleClass('language-options-open')});$('#language-options-modal').on('click',function(e){$(this).removeClass('open');$('body').removeClass('language-options-open')});$(document).on('locationset',function(e,location){if($('body').attr('id')=='pdp'||$('body').attr('id')=='srp'){if(location.agents){$('.nav-agent-link').attr('href',location.agentsurl)}handleFindAHomeMegaNav();return}var jErrorLink,jMenuLink,jHomeLink,bIsHome=$('body').hasClass('home'),jMenuActions=$('#dynamic-location-links').html(''),jPropActions=$('#properties-location-actions').html(''),jProp404Actions=$('#prop404-location-actions').html(''),jHomeActions=$('#homepage-location-actions').html(''),jErrorPageActions=$('#errorpage-location-actions').html('');$('#dynamic-location-header').text('Near '+location.displayname);jPropActions.append($('<div class=\'properties-location-header\'>').html(location.displayname));jProp404Actions.append($('<div class=\'cityLocation\'>').html(location.displayname+' Homes'));if(location.homesforsale){jErrorLink=$('<a data-usagetrack-click=\'Homes for Sale\'>').html('Homes <strong>('+location.homesforsale+')</strong>').attr('href',location.homesforsaleurl);jMenuLink=$('<a data-usagetrack=\'{"dataAppend": ["Homes for Sale"]}\' class="homesForSale" >').html('Homes for Sale <strong>('+location.homesforsale+')</strong>').attr('href',location.homesforsaleurl);jHomeLink=$('<a data-usagetrack=\'{"data": ["Homepage", "Search", "Homes for Sale"]}\'>').html('Homes <strong>'+location.homesforsale+'</strong>').attr('href',location.homesforsaleurl);jProp404Actions.append($('<div class=\'numForSale\' data-usagetrack=\'{"dataAppend": ["Property Not Available", "Properties for Sale"]}\'>').html('Properties for Sale <a href=\''+location.homesforsaleurl+'\'>('+location.homesforsale+')</a>'));jPropActions.append(jHomeLink);jHomeActions.append(jHomeLink.clone());jErrorPageActions.append(jErrorLink);jMenuActions.append($('<li>').append(jMenuLink.clone().html('Homes for Sale <span class=\'loc-display-name\'>&nbsp;in '+location.shortdisplayname+'</span>')).append('<span class=\'bug\'>'+location.homesforsale+'</span>'))}if(location.openhouses){jMenuActions.append($('<li>').append($('<a data-usagetrack=\'{"dataAppend": ["Open Houses"]}\'>Open Houses<span class="loc-display-name">&nbsp;in '+location.shortdisplayname+'</span></a>').attr('href',location.openhousesurl)))}if(location.recentlyreduced){jMenuActions.append($('<li>').append($('<a data-usagetrack=\'{"dataAppend": ["Recently Reduced"]}\'>Recently Reduced<span class="loc-display-name">&nbsp;in '+location.shortdisplayname+'</span></a>').attr('href',location.recentlyreducedurl)))}if(location.foreclosures){jMenuActions.append($('<li>').append($('<a data-usagetrack=\'{"dataAppend": ["Foreclosures"]}\'>Foreclosures<span class="loc-display-name">&nbsp;in '+location.shortdisplayname+'</span></a>').attr('href',location.foreclosuresurl)))}if(location.rentals){jMenuActions.append($('<li>').append($('<a data-usagetrack=\'{"dataAppend": ["Rentals"]}\'>Rentals<span class="loc-display-name">&nbsp;in '+location.shortdisplayname+'</span></a>').attr('href',location.rentalsurl)))}if(location.agents){jErrorLink=$('<a data-usagetrack-click=\'Agents\'>').html('Agents <strong>('+location.agents+')</strong>').attr('href',location.agentsurl);jMenuLink=$('<a data-usagetrack=\'{"dataAppend": ["C21 Agents"]}\'>').html('Agents <strong>('+location.agents+')</strong>').attr('href',location.agentsurl);jHomeLink=$('<a data-usagetrack=\'{"data": ["Homepage", "Search", "C21 Agents"]}\'>').html('Agents <strong>'+location.agents+'</strong>').attr('href',location.agentsurl);jPropActions.append(jHomeLink);jHomeActions.append(jHomeLink.clone());jErrorPageActions.append(jErrorLink);jMenuActions.append($('<li>').append(jMenuLink.clone().html('C21 Agents<span class=\'loc-display-name\'>&nbsp;in '+location.shortdisplayname+'</span>')));$('.nav-agent-link,.carouselitem.findAnAgent').attr('href',location.agentsurl)}if(location.offices){jErrorLink=$('<a data-usagetrack-click=\'Offices\'>').html('Offices <strong>('+location.offices+')</strong>').attr('href',location.officesurl);jMenuLink=$('<a data-usagetrack=\'{"dataAppend": ["C21 Offices"]}\'>').html('Offices <strong>('+location.offices+')</strong>').attr('href',location.officesurl);jHomeLink=$('<a data-usagetrack=\'{"data": ["Homepage", "Search", "C21 Offices"]}\'>').html('Offices <strong>'+location.offices+'</strong>').attr('href',location.officesurl);jPropActions.append(jHomeLink);jHomeActions.append(jHomeLink.clone());jErrorPageActions.append(jErrorLink);jMenuActions.append($('<li>').append(jMenuLink.clone().html('C21 Offices<span class=\'loc-display-name\'>&nbsp;in '+location.shortdisplayname+'</span>')))}if(location.communityurl){jErrorLink=$('<a data-usagetrack-click=\'Community Details\'>').html('Community Details').attr('href',location.communityurl);jHomeLink=$('<a data-usagetrack=\'{"data": ["Homepage", "Search", "Community Details"]}\'>').html('Community Details').attr('href',location.communityurl);jPropActions.append(jHomeLink);jHomeActions.append(jHomeLink.clone());jErrorPageActions.append(jErrorLink)}jHomeActions.find('a:not(:last-child)').after(' ');jPropActions.find('div, a:not(:last-child)').after(' ');jErrorPageActions.find('a:not(:last-child)').after(' ')});$(document).on('locationproperties',function(e,html){$('#properties-panel-list').html(html.replace(/sq\. ft/g,'sf'));var jCards=$('#properties-panel-list .property-card');var CARD_MARGIN=parseInt(jCards.eq(0).css('margin-right'));var jFirst=jCards.eq(0);var iCardMinWidth=jFirst.width();var iCardsPlusMargin=iCardMinWidth+CARD_MARGIN;var iCurrentlyDisplayed=jCards.length;var iNumCards=jCards.length;var iHeightToWidth=jFirst.height()/iCardMinWidth;if(jCards.length){$('.homepage-panel.panel-listings').show()}window.visitedManager.markVisitedProperties();jCards.each(function(){jCards.click(function(){var jCard=$(this);var strLink=jCard.data('link');window.location.href=strLink})});function renderRows(){var iSpaceAvailable=$('.homepage-panel.panel-listings').width();var iCardsThatCanFitInARow=Math.max(1,Math.floor((iSpaceAvailable+CARD_MARGIN)/iCardsPlusMargin));var iCardsTotalVisible=iCardsThatCanFitInARow*2;if(iCardsTotalVisible>2){var iSpacePerCard=Math.floor((iSpaceAvailable+CARD_MARGIN)/iCardsThatCanFitInARow)-CARD_MARGIN;var iCardHeight=Math.round(iHeightToWidth*iSpacePerCard);jCards.slice(0,iCardsTotalVisible).each(function(i,el){el.style.width=iSpacePerCard.toString()+'px';el.style.height=iCardHeight.toString()+'px'})}else{jCards.slice(0,iCardsTotalVisible).each(function(i,el){el.style.width='';el.style.height=''})}if(iCardsTotalVisible===iCurrentlyDisplayed)return;if(iCurrentlyDisplayed){var jOldLastRow1=jCards.eq(iCurrentlyDisplayed/2-1);jOldLastRow1.removeClass('last-card');var jOldLastRow2=jCards.eq(iCurrentlyDisplayed-1);jOldLastRow2.removeClass('last-card')}var jNewLastRow1=jCards.eq(iCardsThatCanFitInARow-1);jNewLastRow1.addClass('last-card');var jNewLastRow2=jCards.eq(iCardsTotalVisible-1);jNewLastRow2.addClass('last-card');if(iCurrentlyDisplayed<iCardsTotalVisible){jCards.slice(iCurrentlyDisplayed,iCardsTotalVisible).each(function(i,el){el.style.display='inline-block'})}if(iCurrentlyDisplayed>iCardsTotalVisible){jCards.slice(iCardsTotalVisible,iCurrentlyDisplayed).each(function(i,el){el.style.display='none'})}var jParent=jNewLastRow1.parent();if(iCardsTotalVisible==2){jParent.addClass('cards-mobile')}else{jParent.removeClass('cards-mobile')}iCurrentlyDisplayed=iCardsTotalVisible}$(window).on('resize',renderRows);renderRows();handleFindAHomeMegaNav();if($(document.body).hasClass('home')){$('.footer-section:lt(2) a').on('click',function(){ga('send','event','Homepage','Perform Search','Footer Links')});$('#dynamic-location-links a').on('click',function(){ga('send','event','Homepage','Perform Search','Find a Home Links')});$('.nav-agent-link').on('click',function(){ga('send','event','Homepage','Perform Search','Mega-nav Find an Agent Buttons')});$('#homepage-location-actions a:lt(3)').on('click',function(){ga('send','event','Homepage','Perform Search','Links under FTS')});$('#properties-location-actions a:lt(3)').on('click',function(){ga('send','event','Homepage','Perform Search','Links above Properties')});handleHomepageImgSwapPanel()}});window.locationManager.initialize()});
//# sourceMappingURL=newPortal.js.map
