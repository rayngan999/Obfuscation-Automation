(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk/components/common/GlobalPlayer/component/PlayerWrapper"],{1198:function(e,a,l){"use strict";l.r(a);var o=l(778).a,t=l(5),n=Object(t.a)(o,(function(){var e=this,a=e.$createElement,l=e._self._c||a;return l("div",{staticClass:"global-player-main-wrapper",class:{"not-ready":!e.globalPlayerReady,open:e.globalPlayerBoxOpen}},[l("global-player-mini-box",{attrs:{"player-ready":e.playerReady,version:e.version}}),e._v(" "),e.globalPlayerReady?[l("global-player-main-box",{attrs:{version:e.version}})]:e._e()],2)}),[],!1,null,"ce2f376c",null);a.default=n.exports},778:function(e,a,l){"use strict";(function(e){var o=l(2),t=l(0),n=l(35),r=l(680);function s(e,a){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);a&&(o=o.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),l.push.apply(l,o)}return l}function c(e){for(var a=1;a<arguments.length;a++){var l=null!=arguments[a]?arguments[a]:{};a%2?s(l,!0).forEach((function(a){i(e,a,l[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):s(l).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(l,a))}))}return e}function i(e,a,l){return a in e?Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e}var u=t.f.get("IS_APP");a.a={components:{GlobalPlayerMiniBox:function(){return l.e("chunk/components/common/GlobalPlayer/component/PlayerMiniBox").then(l.bind(null,1066))},GlobalPlayerMainBox:function(){return l.e("chunk/components/common/GlobalPlayer/component/PlayerMainBox").then(l.bind(null,1111))}},filters:{},props:{},data:function(){return{version:"3.0",playerReady:!1,resetPlayerQueueInfoTimer:null,isFocus:!1,PageSetting_page_scroll_timer:null,IS_APP:u}},computed:c({},Object(o.mapGetters)({PageSetting_page_focus:"PageSetting_page_focus",PageSetting_page_scroll:"PageSetting_page_scroll",LocalStorage_DEFAULT:"".concat(r.a,"/LocalStorage_DEFAULT"),globalPlayerId:"".concat(r.a,"/globalPlayerId"),globalPlayerReady:"".concat(r.a,"/globalPlayerReady"),globalPlayerBoxOpen:"".concat(r.a,"/globalPlayerBoxOpen"),reloadGlobalPlayerQueueTrigger:"reloadGlobalPlayerQueueTrigger",globalPlayerInfoStatus:"".concat(r.a,"/globalPlayerInfoStatus"),globalPlayerQueue_id:"".concat(r.a,"/globalPlayerQueue_id"),globalPlayerQueue_player_index:"".concat(r.a,"/globalPlayerQueue_player_index"),globalPlayerQueueIndexToArrayIndexMapping:"".concat(r.a,"/globalPlayerQueueIndexToArrayIndexMapping")})),watch:{PageSetting_page_focus:function(){this.checkIsFocus()},PageSetting_page_scroll:function(e,a){var l=this;l.PageSetting_page_focus||l.playerReady||e===a||(clearTimeout(l.PageSetting_page_scroll_timer),l.PageSetting_page_scroll_timer=setTimeout((function(){l.PageSetting_page_focus||!1===l.playerReady&&l.loadPlayerQueueStatus()}),500))},globalPlayerBoxOpen:function(){this.globalPlayerBoxOpen?e("body").addClass("pp-global-player-open"):e("body").removeClass("pp-global-player-open"),this.globalPlayerBoxOpen!==t.h.get(this.LocalStorage_DEFAULT.globalPlayerOpen,!1)?(t.p.pageAction("GlobalPlayer_PlayerOpen_change",{version:this.version,open:this.globalPlayerBoxOpen,human:!0}),t.h.set(this.LocalStorage_DEFAULT.globalPlayerOpen,this.globalPlayerBoxOpen)):t.p.pageAction("GlobalPlayer_PlayerOpen_change",{version:this.version,open:this.globalPlayerBoxOpen,human:!1})},globalPlayerInfoStatus:function(){this.globalPlayerInfoStatus!==t.h.get(this.LocalStorage_DEFAULT.globalPlayerInfoStatus)&&t.h.set(this.LocalStorage_DEFAULT.globalPlayerInfoStatus,this.globalPlayerInfoStatus)},reloadGlobalPlayerQueueTrigger:function(e,a){var l=this;if(e!==a){var o=window.tmpPlayerQueue;if(o&&Array.isArray(o.tracks)){var t=o;l.changeGlobalPlayerStatus("control"),l.resetPlayerQueueInfo(t),delete window.tmpPlayerQueue,setTimeout((function(){l.setGlobalPlayerInfoPlayStatus({status:"play",force:!0}),l.changeGlobalPlayerBoxOpen(!0)}),100)}else l.loadPlayerQueueStatus()}},isFocus:function(e){!0===e&&!1===this.playerReady&&this.loadPlayerQueueStatus()}},created:function(){},mounted:function(){this.listenAct(),this.setPPWebSocket(),this.setPPGlobalPlayerIdAct(),this.checkIsFocus(),this.checkCanPlay()},updated:function(){},destroyed:function(){},methods:c({listenAct:function(){var e=this;t.h.listen(e.LocalStorage_DEFAULT.globalPlayerOpen,(function(a){e.changeGlobalPlayerBoxOpen(a)}));var a=t.h.get(e.LocalStorage_DEFAULT.globalPlayerOpen,!1);e.changeGlobalPlayerBoxOpen(a),t.h.listen(e.LocalStorage_DEFAULT.globalPlayerInfoStatus,(function(a){e.setGlobalPlayerInfoPlayStatus({status:a,force:!1})}));var l=t.h.get(e.LocalStorage_DEFAULT.globalPlayerInfoStatus,!1);e.setGlobalPlayerInfoPlayStatus({status:l,force:!1}),t.h.listen(this.LocalStorage_DEFAULT.globalPlayerQueueInfo,(function(a){void 0!==a.queue_id||a.queue_id!==e.globalPlayerQueue_id||void 0===e.globalPlayerQueueIndexToArrayIndexMapping[a.player_index]?e.loadPlayerQueueStatus():void 0!==a.player_index&&a.player_index!==e.globalPlayerQueue_player_index&&e.setGlobalPlayerQueuePlayerIndex(a.player_index)})),t.h.listen(this.LocalStorage_DEFAULT.globalPlayerInfoPlaySpeed,(function(a){e.setGlobalPlayerInfoPlaySpeed(a)}));var o=t.h.get(this.LocalStorage_DEFAULT.globalPlayerInfoPlaySpeed);o&&o!==this.globalPlayerInfoPlaySpeed&&(e.setGlobalPlayerInfoPlaySpeed(o),t.p.pageAction("GlobalPlayer_playSpeed_init",{version:this.version,speed:o})),t.h.listen(e.LocalStorage_DEFAULT.globalPlayerProcessReciprocal,(function(a){e.changeGlobalPlayerInfoProcessReciprocal(a)}));var n=t.h.get(e.LocalStorage_DEFAULT.globalPlayerProcessReciprocal,!1);e.changeGlobalPlayerInfoProcessReciprocal(n)},checkIsFocus:function(){this.PageSetting_page_focus!==this.isFocus&&(this.isFocus=this.PageSetting_page_focus)},checkCanPlay:function(){var e=this,a=new Audio;a.src="data:audio/mpeg;base64,//OEZAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAADAAAB+AB2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnbs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Oz///////////////////////////////////////////8AAAA5TEFNRTMuOThyAm4AAAAALLAAABRGJAR4TgAARgAAAfhOdwaxAAAAAAAAAAAAAAAAAAAA//NkZAAOaAFWAAQjboAAA0gAAAAADw8PDwwAAAAADw8PD0gAAADvDx////////////////7v/ADDw8PDwAAAAADDw8PDwAAAAADDw8PDwAAAAADDw8PDwAAAAADDw8PDwAAAAADDw8PDwAAAAADDw8PDwAAAAADDw8PDwAAAAADDw8PDwAAAABWEFBQUEgoK//NkZAcOiAFWAARjSoAAA0gAAAAACgoUFBQUEgoKCgoUFBQUEgoKCgoUFBQUEgoKCgoUFBQUEgoKCgoUFBQUEgoKCgoUFBQUEgoKCgoUFBQUEgoKCgoUFBQUEgoKCgoUFBQUVBQUFZ8KG////////////////P/8QYKCgoKBQUFBQZVMQU1FMy45OC40VVVV//MUZA0AAAGkAAAAAAAAA0gAAAAAVVVV",a.volume=0,a.play().then((function(){!1===e.playerReady&&e.loadPlayerQueueStatus(),e.$store.dispatch("PressPlayPageSettingSet",{page_focus:!0})}),(function(){}))},setPPWebSocket:function(){var e=this;t.j.isMobileApp()||n.a.on("GlobalPlayerQueueUpdate",(function(a){e.resetPlayerQueueInfo(a)}))},setPPGlobalPlayerIdAct:function(){var e=this,a=t.s.getRandomString(20);e.setGlobalPlayerId(a),t.h.listen(e.LocalStorage_DEFAULT.globalPlayerId,(function(a){e.setLSGlobalPlayerId(a)}))},loadPlayerQueueStatus:function(){var e=this,a=this;if(a.IS_APP)return!1;var l=!a.playerReady;return a.playerReady=!0,a.$store.dispatch("".concat(r.a,"/getGlobalPlayerStatus")).then((function(o){if("success"===o.status){t.p.pageAction("GlobalPlayer_queue_load",{version:e.version,initial:l});var n=o.data.queue;a.setGlobalPlayerInfoPlayStatus({force:!1}),a.resetPlayerQueueInfo(n)}}),(function(){})),!0},resetPlayerQueueInfo:function(e){var a=this,l=this;clearTimeout(l.resetPlayerQueueInfoTimer),l.resetPlayerQueueInfoTimer=setTimeout((function(){t.p.pageAction("GlobalPlayer_queue_set",{version:a.version,queue_info:{id:e.id,play_index:e.play_index,track_count:e.tracks.length}}),l.setGlobalPlayerQueueInfo(e)}),100)}},Object(o.mapMutations)({changeGlobalPlayerBoxOpen:"".concat(r.a,"/changeGlobalPlayerBoxOpen"),changeGlobalPlayerStatus:"".concat(r.a,"/changeGlobalPlayerStatus"),setGlobalPlayerQueueInfo:"".concat(r.a,"/setGlobalPlayerQueueInfo"),setGlobalPlayerQueuePlayerIndex:"".concat(r.a,"/setGlobalPlayerQueuePlayerIndex"),setGlobalPlayerInfoPlayStatus:"".concat(r.a,"/setGlobalPlayerInfoPlayStatus"),setGlobalPlayerInfoPlaySpeed:"".concat(r.a,"/setGlobalPlayerInfoPlaySpeed"),changeGlobalPlayerInfoProcessReciprocal:"".concat(r.a,"/changeGlobalPlayerInfoProcessReciprocal"),setGlobalPlayerId:"".concat(r.a,"/setGlobalPlayerId"),setLSGlobalPlayerId:"".concat(r.a,"/setLSGlobalPlayerId")}))}}).call(this,l(1))}}]);