!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("@appfabric/reliable-transmission")):"function"==typeof define&&define.amd?define(["@appfabric/reliable-transmission"],e):"object"==typeof exports?exports.intuitPerformanceBundle=e(require("@appfabric/reliable-transmission")):t.intuitPerformanceBundle=e(t["@appfabric/reliable-transmission"])}(window,function(t){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=4)}([function(e,r){e.exports=t},function(t,e,r){var n=r(2),i=r(3);t.exports=function(t,e,r){var o=e&&r||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var a=(t=t||{}).random||(t.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,e)for(var s=0;s<16;++s)e[o+s]=a[s];return e||i(a)}},function(t,e){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);t.exports=function(){return r(n),n}}else{var i=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),i[e]=t>>>((3&e)<<3)&255;return i}}},function(t,e){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);t.exports=function(t,e){var n=e||0,i=r;return[i[t[n++]],i[t[n++]],i[t[n++]],i[t[n++]],"-",i[t[n++]],i[t[n++]],"-",i[t[n++]],i[t[n++]],"-",i[t[n++]],i[t[n++]],"-",i[t[n++]],i[t[n++]],i[t[n++]],i[t[n++]],i[t[n++]],i[t[n++]]].join("")}},function(t,e,r){"use strict";r.r(e),r.d(e,"IntuitPerformance",function(){return A}),r.d(e,"Config",function(){return f});var n=r(1),i=r.n(n),o=Object.freeze({ACTION:"act",LIFECYCLE:"lfc",NETWORK:"ntw",TT_MEASURE_NAME:"tt",XHR_MEASURE_NAME:"xtt"});class a{static getPluginRumData(t,e){var r=null;return t&&(r={pid:t},e&&(r.pv=e)),r}static generateTidForAction(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t&&e?(a.cleanupTidForAction(t,e),e._rumActionTidData=e._rumActionTidData||[],e._rumActionTidData.push(Object.assign({aid:t,tid:i()()},r)),!0):(console.warn("Cannot generate TID for action, action or sandbox missing"),!1)}static cleanupTidForAction(t,e){if(t&&e&&e._rumActionTidData){var r=!1;return e._rumActionTidData=e._rumActionTidData.filter(e=>e.aid!==t||(r=!0,!1)),0===e._rumActionTidData.length&&delete e._rumActionTidData,r}return console.warn("Cannot cleanup TID for action, action or sandbox._rumActionTidData missing"),!1}static getTidRumData(t){var e,r,n=t&&t._rumActionTidData,i="",o="",a="",s="";return n?(n.forEach((t,e)=>{e===n.length-1?({aid:i,tid:o,metaData:r}=t):(a+="".concat(t.aid,","),s+="".concat(t.tid,","))}),e={aid:i,tid:o,metaData:r},a.length>0&&(e.eaid=a.substring(0,a.length-1)),s.length>0&&(e.etid=s.substring(0,s.length-1)),e):e}static getTid(t){var e=a.getTidRumData(t);return e?e.tid:void 0}static getTidRumDataForAction(t,e){var r,n=e&&e._rumActionTidData;return t&&n?(n.forEach(e=>{e.aid===t&&(r=e)}),r):r}}function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}a.eventTypes=o;class u{static get DEFAULT_INTERVAL_MS(){return 3e4}static get DEFAULT_MAX_RETRIES(){return 2}static get DEFAULT_MAX_ITEM_QUEUE_SIZE(){return 2e3}static get DEFAULT_MAX_REQUEST_TIMEOUT_MS(){return 3e3}static get DEFAULT_MAX_BYTES_QUOTA(){return 1048576}constructor(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"e2e",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"preprdakyres4d0xjqKabnvLMDUxxj519GYYpgx4",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Intuit.app.utilities.uxfabricdefaultsdk",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"v1",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"IntuitPerformanceSDK",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"PERFORMANCE";this.env=t,this.apiKey=e,this.appId=r,this.eventType=o,this.component=i,this.oilVersion="v2"===n.toLowerCase()?"v2":"v1",this.endpoint={protocol:"https",host:"prod"===t||"prd"===t?"logging.api.intuit.com":"logging-e2e.api.intuit.com",pathname:"/".concat(this.oilVersion,"/log/message")},this.storeIdentifier="RUM",this.enabled=!0,this.transmit={method:"post",headers:{Authorization:"Intuit_APIKey intuit_apikey=".concat(e,", intuit_apkey_version=1.0")},queryParams:{},interval:u.DEFAULT_INTERVAL_MS,maxRetries:u.DEFAULT_MAX_RETRIES,maxItemQueueSize:u.DEFAULT_MAX_ITEM_QUEUE_SIZE,requestTimeout:u.DEFAULT_MAX_REQUEST_TIMEOUT_MS,maxBytesQuota:u.DEFAULT_MAX_BYTES_QUOTA,purgeStrategy:"Purge",retryStrategy:"DefaultRetryStrategy"},"v1"===this.oilVersion&&(this.transmit.headers=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach(function(e){c(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},this.transmit.headers,{},{"-X-APPID":r}))}ignoreAction(t,e){return!1}formatAction(t){return t}}var f=u,l=r(0),p=r.n(l);var g=class extends l.BaseHTTPTransformer{constructor(t){super(),this._oilVersion=t}transform(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=i()(),o="v2"===this._oilVersion?{intuit_tid:n}:{intuit_tid:n,"-X-INTUIT_TID":n};return super.transform(Object.assign(o,t),e,r)}formatPostBody(t){return"v2"===this._oilVersion?super.formatPostBody(t.filter(t=>t.object).map(t=>t.object)):super.formatPostBody(t.filter(t=>t.object).map(t=>(t.object.serializer="json",t.object)))}};function m(t,e){var r=443==e&&("https"===t||"https:"===t)||80==e&&("http"===t||"http:"===t)||null===e||""===e?"":"".concat(e),n=parseInt(r,10);return(Number.isNaN(n)||e<=0||e>=65535||Math.floor(n)!=e)&&(r=""),r}class h{static getRTSettings(t){var e={},{reliableTransmission:r}=t;return r&&(e=r),e}static parseURL(t){var e=null;if("undefined"!=typeof window&&window.URL&&"function"==typeof window.URL)e=new window.URL(t);else{var r=t.split("#"),n=r[0].split("?"),i=n.length>1?n[1]:"";if(!((r=(r=n[0]).split("/")).length>=3))throw new Error("URLUtil.parseURL Error: url ".concat(t," appears malformed"));var o=r[2],a=o.split(":"),s=a[0],c=r[0],u=m(c,a.length>1?a[1]:"");""===u&&(o=s);var f=r.slice(3).join("/");e={host:o,hostname:s,protocol:c,port:u,search:i?"?".concat(i):"",pathname:"/".concat(f)}}var l={host:e.hostname,protocol:e.protocol.replace(/[^a-zA-Z]/g,""),pathname:e.pathname};return""!==e.port&&(l.port=e.port),l}static formatURL(t){var e;if(t&&t.protocol&&t.hostname&&t.pathname){var r=m(t.protocol,t.port),{pathname:n}=t,i="";r&&(i=":".concat(r)),n&&"string"==typeof n&&n.length>0&&"/"!==n[0]&&(n="/".concat(n)),e="".concat(t.protocol,"://").concat(t.hostname).concat(i).concat(n)}return e}static getEndpointUrl(t){return h.formatURL({protocol:t.protocol||"http",hostname:t.host||"",port:t.port,pathname:t.pathname||""})}}var d=h;function b(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function v(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var _=function(t,e){var r=e&&e.component,n=e&&e.appId,i=e&&e.env,o=(new Date).getTime(),a=e&&e.eventType;return Object.assign(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?b(Object(r),!0).forEach(function(e){v(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},t),{component:r,appId:n,env:i,timestamp:o,eventType:a})};function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function O(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var T=function(t,e){var r=e&&e.component,n=e&&e.env,i=(new Date).getTime(),o=e&&e.eventType,a=[];t&&t.oilProps&&t.oilProps.destination&&(a=JSON.parse(JSON.stringify(t.oilProps.destination)),delete t.oilProps);var s={timestamp:(new Date).getTime(),destination:a};return Object.assign(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(Object(r),!0).forEach(function(e){O(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},t),{component:r,env:n,timestamp:i,eventType:o},{oilProps:s})};class w{static getStoreIdDefault(){return"default"}constructor(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new f,e=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.getStoreIdDefault();this._configuration=t,this._RTConfig=new p.a.RTConfiguration,this._endpointURL=d.getEndpointUrl(t.endpoint)||"https://logging-e2e.api.intuit.com/v1/log/message",this._initReliableTransmission(r),this._txCallback=e}_initReliableTransmission(t){null!==this._configuration&&(void 0!==this._configuration.overrideLimitEnforcement&&(this._RTConfig.OVERRIDE_LIMIT_ENFORCED=this._configuration.overrideLimitEnforcement),this._configuration.maxItems&&this._RTConfig.setMaxItemQueueSize(this._configuration.maxItems),this._configuration.interval&&this._RTConfig.setInterval(this._configuration.interval),this._configuration.maxRetries&&this._RTConfig.setMaxRetries(this._configuration.maxRetries),this._configuration.maxBytesQuota&&this._RTConfig.setMaxBytesQuota(this._configuration.maxBytesQuota),this._configuration.requestTimeout&&this._RTConfig.setRequestTimeout(this._configuration.requestTimeout),this._configuration.retryStrategy&&this._RTConfig.setRetryStrategy(this._configuration.retryStrategy),this._configuration.purgeStrategy&&this._RTConfig.setPurgeStrategy(this._configuration.purgeStrategy)),this._RTConfig.setHeaders(Object.assign({},this._RTConfig.getHeaders(),this._configuration&&this._configuration.transmit&&this._configuration.transmit.headers?this._configuration.transmit.headers:{})||{}),this._RTConfig.setMethod("post"),this._RTConfig.setUrl(this._endpointURL),this._RTConfig.setItemStoreIdentifier("RUM_".concat(t)),this._itemQueue=new p.a.ItemQueue(this._RTConfig),this._itemQueue.setTransformer(new g(this._configuration.oilVersion)),this._itemQueue.setCallback(this)}transmit(t){if(!t)throw new Error("rumData is missing");var e="v1"===this._configuration.oilVersion?new _(t,this._configuration):new T(t,this._configuration);this._itemQueue.insertObject(e),(t.annotation&&t.annotation.flushLogsImmediately||t.flushLogsImmediately)&&this.flush()}flush(){this._itemQueue.drain(!0)}onError(t){this._txCallback&&"function"==typeof this._txCallback.onError&&this._txCallback.onError(t)}onSuccess(t,e){this._itemQueue._itemStore.deleteNetworkRequest(e),this._txCallback&&"function"==typeof this._txCallback.onSuccess&&this._txCallback.onSuccess(t,e)}}var j=w;function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function E(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach(function(e){R(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function R(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D(t,e){if(null==t)return{};var r,n,i=function(t,e){if(null==t)return{};var r,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(i[r]=t[r]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}class S{shouldEnable(){return!0}}class C{static getCurrentTime(){return Date.now()}constructor(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.page=void 0,this.pageIdentifier=void 0,this._enabled=!0,this.markers={},this.RUMConf=t||new f,this.userTimingTx=new j(this.RUMConf),this.delegate=e||new S}isEnabled(){return!this.RUMConf||this._enabled&&this.RUMConf.enabled&&this.delegate.shouldEnable()}setEnabled(t){this._enabled=!!t}actionInitiated(t,e){t&&this.mark("".concat(t,"st"),e)}actionCompleted(t,e,r,n,i,o){if(t){this.mark("".concat(t,"et"),i);var s=this.measure(a.eventTypes.TT_MEASURE_NAME,"".concat(t,"st"),"".concat(t,"et")),c=Object.assign({},s,{st:this.markers["".concat(t,"st")],et:this.markers["".concat(t,"et")]});this.saveMeasure(t,c,e,r,n,o)}}pageInitiated(t,e){t&&(this.pageIdentifier&&console.warn("No end time provided for ".concat(this.pageIdentifier)),this.page=t,this.pageIdentifier=t,this.markers={},this.actionInitiated(t,e))}pageCompleted(t,e,r,n,i){this.pageIdentifier?(this.actionCompleted(this.pageIdentifier,t,e,r,n,i),this.pageIdentifier=null):console.warn("No start time provided")}measureFromPageTiming(t,e,r,n,i,o,a){if(t&&window.performance&&window.performance.timing&&window.performance.timing.navigationStart){var s=C.getWindowPerf(),c=s[e?"timing_".concat(e):"timing_navigationStart"],u=Object.assign({},r,s);this.actionInitiated(t,c),this.actionCompleted(t,u,n,i,o,a)}}hardNavCompleted(t,e,r,n,i,o,a){if(t&&window.performance&&window.performance.timing&&window.performance.timing.navigationStart){var s=Object.assign({},e,i&&i.customWinPerfObj?C.getWindowPerf(i.customWinPerfObj):C.getWindowPerf()),c=s.timing_timingStartProperty?s.timing_timingStartProperty:s.timing_navigationStart;s=Object.assign(s,{startTime:c}),this.actionInitiated(t,c),this.actionCompleted(t,s,r,n,o,a)}}static getWindowPerf(t){var e=t||window.performance;return e=Object.assign({},C.flattenedProperties("timing",e.timing),C.flattenedProperties("navigation",e.navigation),C.flattenedProperties("memory",e.memory))}static flattenedProperties(t,e){var r={};if(!t||!e)return r;for(var n in e)"function"!=typeof e[n]&&(r["".concat(t,"_").concat(n)]=e[n]);return r}mark(t,e){t&&(this.markers[t]=e||C.getCurrentTime())}measure(t,e,r){var n=null,i=C.getCurrentTime();if(!t)return n;var o=this.markers[e],a=this.markers[r]||i;return o&&((n={})[t]=a-o),n}saveMeasure(t,e,r,n,i,o){var a;t&&e&&("function"==typeof this.RUMConf.ignoreAction&&this.RUMConf.ignoreAction(t,r)||(a={name:"function"==typeof this.RUMConf.formatAction?this.RUMConf.formatAction(t):t,measures:e},this.insertMeasure(this.formatMeasure(a,r,n,i,this.RUMConf.oilVersion,o))))}saveProfile(t,e,r,n,i){if(t){var o=(t=>{var{_metaData:e}=t;return E({},D(t,["_metaData"]))})(t.data());this.insertMeasure(this.formatMeasure(o,t.data()._metaData,e,r,this.RUMConf.oilVersion,n,i))}}formatMeasure(t,e,r,n,i,o,a){switch(i){case"v2":return Object.assign({},t,{appProps:E({},r)},{context:E({},n)},{metadata:E({},e)},{oilProps:E({},o)},E({},a));case"v1":default:return{annotation:Object.assign({},t,{appProps:E({},r)},{context:E({},n)},{metadata:E({},e)},E({},a))}}}insertMeasure(t){try{this.isEnabled()?this.userTimingTx.transmit(t):console.debug("RUM disabled, ignoring insertMeasure")}catch(t){console.error(t.message)}}clean(){this.markers={}}error(t){console.error(t,"Error sending RUM data"),this.sendEventFailureCount+=1,this.sendEventFailureCount>this.RUMConf.transmit.maxRetries&&(this._enabled=!1)}done(){this.userTimingTx.flush(),this.clean()}onError(t){this.error(t)}onSuccess(t,e){}}var M=C;var A=class{constructor(t){this.rumUtil=new a,this.userTiming=new M(t)}}}])});