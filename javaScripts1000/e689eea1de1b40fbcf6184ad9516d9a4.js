"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function PbsView(){var t,c=this;this.stageHeight=Math.max(window.top.document.documentElement.clientHeight,window.top.innerHeight||0),this.refreshTime=30,this.limitRefresh=3,this.activeAds=[],this.focused=!0,this.log=console.log.bind(console,"%c[PUBLICIDAD - refresh]","color:green"),this.adAllowed=["gac_r3e","gac_r2e","gac_r2","gac_r1e","gac_r1","gac_m1s","gac_m1e","gac_m1","cpm_sps2","cpm_sps","cpm_r_sps6","cpm_r_sps5","cpm_r_sps4","cpm_r_sps3","cpm_r_sps2","cpm_r_sps1","cpm_r_sps","cpm_r_mid4","cpm_r_mid3","cpm_r_mid2","cpm_r_mid1","cpm_r_izdad","cpm_r_izdac","cpm_r_izdab","cpm_r_izda","cpm_r_dchal","cpm_r_dchak","cpm_r_dchaj","cpm_r_dchai","cpm_r_dchah","cpm_r_dchag","cpm_r_dchaf","cpm_r_dchae","cpm_r_dchad","cpm_r_dchac","cpm_r_dchab","cpm_r_dcha","cpm_r_cab","cpm_natad","cpm_natac","cpm_natab","cpm_nata","cpm_mf","cpm_me","cpm_md","cpm_mc","cpm_mb","cpm_m","cpm_c990x45b","cpm_c990x45","cpm_b300x100","cpm_b234c","cpm_b234b"],this.advertiserAllowed=[0,4608278554,4588425041,4587500823,4876939414,4813030474,5030381035,4757230456],this.mobilDetect=function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(this.refreshTime=30)},this.init=function(){var t=c.getGptSlots(),e=c;void 0===c.ads&&(c.ads={running:!1,list:{}});for(var i=0;i<t.length;i++){var s=c.getGptSlotsId(t[i]),n=c.getGptSlotsTargeting(t[i],"p"),o=c.getGptSlotsTargeting(t[i],"hb_deal"),r=c.getGptSlotsTargeting(t[i],"hb_deal_richaudience"),a=c.getGptInformation(t[i]),d=s.replace(/-/g,"__");-1!==c.adAllowed.indexOf(n)&&null!=a&&(0!=c.advertiserAllowed.length&&-1===c.advertiserAllowed.indexOf(a.advertiserId)||"ramkt"==o||"ramkt"==r||(c.ads.list[d]={second:0,id:s,_id:d,slot:t[i],refresh:0,advertiserId:a},c.ads.list[d].pos=n))}0<Object.keys(c.ads.list).length&&c.initScroll(),c.mobilDetect(),window.top.googletag.pubads().addEventListener("slotRenderEnded",function(t){e.slotControl(t)})},this.getGptSlots=function(t){return"object"===_typeof(t)?window.top.googletag.pubads().getSlots(t):window.top.googletag.pubads().getSlots()},this.slotControl=function(t){var e=c.getGptSlotsId(t.slot),i=c.getGptSlotsTargeting(t.slot,"p"),s=c.getGptSlotsTargeting(t.slot,"hb_deal"),n=c.getGptSlotsTargeting(t.slot,"hb_deal_richaudience"),o=c.getGptInformation(t.slot),r=e.replace(/-/g,"__");-1!==c.adAllowed.indexOf(i)&&null!=o&&(!1===c.ads.list.hasOwnProperty(r)?0!=c.advertiserAllowed.length&&-1===c.advertiserAllowed.indexOf(o.advertiserId)||"ramkt"==s||"ramkt"==n?c.ads.list.hasOwnProperty(r)&&delete c.ads.list[r]:(c.ads.list[r]={second:0,id:e,_id:r,slot:t.slot,refresh:0,advertiserId:o},c.ads.list[r].pos=i):0!=c.advertiserAllowed.length&&-1===c.advertiserAllowed.indexOf(o.advertiserId)||"ramkt"==s||"ramkt"==n||(c.ads.list[r].second=0,c.ads.list[r].advertiserId=o)),0<Object.keys(c.ads.list).length&&"function"==typeof c.initScroll&&c.initScroll()},this.setGptTargeting=function(t,e,i){t.setTargeting(e,i)},this.getGptInformation=function(t){return t.getResponseInformation()},this.clearGptTargeting=function(t,e){t.clearTargeting(e)},this.clearAllGptTargeting=function(t){t.clearTargeting()},this.getGptSlotsId=function(t){return t.getSlotElementId()},this.getGptSlotsTargeting=function(t,e){return t.getTargeting(e).toString()},this.initScroll=function(){var t=c,e=window.top;e.addEventListener("scroll",t.debounce(function(){t.updateElementViewabilityMessage(t)},100)),e.addEventListener("focus",function(){t.onFocus(t,"on")}),e.addEventListener("blur",function(){t.onFocus(t,"off")}),delete c.initScroll},this.debounce=function(n,o,r){var a;return function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var s=r&&!a;clearTimeout(a),a=setTimeout(function(){a=null,r||n.apply.apply(n,[c].concat(e))},o),s&&n.apply.apply(n,[c].concat(e))}},this.elementIsInView=function(t){if(window.top.document.getElementById(t)){var e=window.top.document.getElementById(t).getBoundingClientRect(),t=e.top+e.height/2,e=e.top+e.height-e.height/2;return 0<=t&&e<c.stageHeight}return!1},this.onFocus=function(t,e){"off"===e?(c.focused=!1,c.clearTimer(),t.ads.running=!1):"on"===e&&(c.focused=!0,c.updateElementViewabilityMessage(c))},this.removeArray=function(t,e){e=t.indexOf(e);-1!==e&&t.splice(e,1)},this.updateElementViewabilityMessage=function(t){if(void 0!==t.ads.list){for(var e in t.ads.list)t.elementIsInView(t.ads.list[e].id)&&-1===t.activeAds.indexOf(t.ads.list[e]._id)?t.activeAds.push(t.ads.list[e]._id):t.elementIsInView(t.ads.list[e].id)||-1===t.activeAds.indexOf(t.ads.list[e]._id)||t.removeArray(t.activeAds,t.ads.list[e]._id);0<t.activeAds.length&&!t.ads.running&&t.focused?(t.ads.running=!0,t.setTimer()):0===t.activeAds.length&&t.ads.running&&!t.focused&&(t.ads.running=!1,t.clearTimer())}},this.setTimer=function(){var e=c;t=setInterval(function(){for(var t=0;t<e.activeAds.length;t++)void 0!==e.ads.list[e.activeAds[t]]&&(e.requestRefresh(e.ads.list[e.activeAds[t]]),e.ads.list[e.activeAds[t]].second++)},500)},this.clearTimer=function(){clearInterval(t)},this.getSizes=function(t){var s=[];return t.getSizes().forEach(function(t){var e,i=[];for(e in t)t.hasOwnProperty(e)&&i.push(t[e]);s.push(i)}),s},this.a9=function(t){window.top.apstag.fetchBids({slots:[{slotID:t.id,slotName:t.slot.getAdUnitPath(),sizes:c.getSizes(t.slot)}]},function(){window.top.googletag.cmd.push(function(){window.top.apstag.setDisplayBids()})})},this.requestRefresh=function(t){var e=c.refreshTime;t.second>=e&&(t.second=0,t.refresh<this.limitRefresh&&(t.refresh++,c.clearAllGptTargeting(t.slot),c.setGptTargeting(t.slot,"nR",t.refresh.toString()),c.setGptTargeting(t.slot,"p",t.pos),(e=document.getElementById(t.slot.getSlotElementId()))&&(e.style.height="auto"),c.a9(t),this.log("nR: "+t.refresh+", p:"+t.pos),window.top.pbjs&&"function"==typeof window.top.pbjs.refreshAds?pbjs.refreshAds([t.slot.getSlotElementId()]):googletag.pubads().refresh([t.slot])))}}setTimeout(function(){var t=new PbsView;t.init(),window.top.PBS=t},1e3);