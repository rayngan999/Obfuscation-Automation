$(document).ready(function(){try{CreateOrderHistoryDataTable();CreateInvoiceDataTable();CreateOpenLinesDataTable();CreateOrderSearchDataTable();CreateSavedCartsDataTable();CreateProjectsDataTable();CreateQuotesDataTable();CreateBomDataTable();$(".DTTT_button_xls").removeClass("DTTT_button ui-button ui-state-default DTTT_button_xls").addClass("excel");$(".DTTT_button_print").removeClass("DTTT_button ui-button ui-state-default DTTT_button_print").addClass("print");$(".dataTables_paginate").find(".previous, .next").hide()
}catch(a){$(".dataTables_processing").css("visibility","hidden")}});var adminIcon=function(b,a,c){if(a==="display"&&(typeof Resources!=="undefined")){return b.replace("{0}",' <i class="fa fa-shield-check" aria-hidden="true" title="'+Resources.MyMouser.ShieldIcon+'"></i>&nbsp;')}return b};function ajax_download(c,e,b){var f;var d;var a;if((f=$("#download_iframe")).length===0){f=$("<iframe id='download_iframe' style='display: none' src='about:blank'></iframe>").appendTo("body")}$("#download_iframe").on("load",function(){$("#download_iframe").remove()
});d=f[0].contentWindow||f[0].contentDocument;if(d.document){d=d.document}a="<html><head></head><body>"+c+"</body></html>";d.open();d.write(a);$("#ExportToExcelData",d).val(encodeURIComponent(e));$("#ExportToExcelName",d).val(encodeURIComponent(b));$(d).find("form").trigger("submit")}function AddLinks(){$("div.floatleft.padding10leftright").hide();var b="";var j="";var d="";var c="";var f=$("select[id$=ddlOhNavigation] option").length;if(f>3){b=$("select[id$=ddlOhNavigation] option:nth(0)").html();j=$("select[id$=ddlOhNavigation] option:nth(1)").html();
d=$("select[id$=ddlOhNavigation] option:nth(2)").html();c=$("select[id$=ddlOhNavigation] option:nth(3)").html()}else{j=$("select[id$=ddlOhNavigation] option:nth(0)").html();d=$("select[id$=ddlOhNavigation] option:nth(1)").html();c=$("select[id$=ddlOhNavigation] option:nth(2)").html()}var e=(f<=3?"":"<a href='https://cn.mouser.lan/OrderHistory/OrdersView.aspx'><b>"+b+"</b></a>&nbsp;&nbsp;|&nbsp;");if($("table#tblOrders").length==0){d="<a href='/OrderHistory/OrdersView.aspx'><b>"+d+"</b></a>"}if($("table#tblOpenOrders").length==0){j="<a href='/OrderHistory/OpenLinesView.aspx'><b>"+j+"</b></a>"
}if($("table#tblOrderSearch").length==0){c="<a href='/OrderHistory/SearchView.aspx'><b>"+c+"</b></a>"}var g=j;var h=d;var i=c;var a='<div class="padding10left"><br><br><b>'+$("div.floatleft.padding10leftright").contents("b").html()+"</b>&nbsp;"+e+g+"&nbsp;&nbsp;|&nbsp;"+h+"&nbsp;&nbsp;|&nbsp;"+i+"</div>";$("div#divOrderHistoryToolTip").after(a);return true}function noOrdersOrTimeout(a){if(($("#divNoOrders").children().first().hasClass("alert"))&&a===true){$.get("/OrderHistory/OrderSearch",function(d){if(d==="NotLoggedIn"){window.location.reload()
}else{var c=true;var b=$.parseHTML(d,c);$("#divNoOrders").append(b);RebindJQueryValidation()}HideOrderHistoryTable()})}else{HideOrderHistoryTable()}}function showManagePermissions(a){if(($("#divOrgManagePermission .alert").length>0)&&a===true){$.get("/OrderHistory/OrderSearch",function(d){if(d==="NotLoggedIn"){window.location.reload()}else{var c=true;var b=$.parseHTML(d,c);$("#divOrgManagePermission").append(b);RebindJQueryValidation()}HideOrderHistoryTable(true)})}else{HideOrderHistoryTable(true)}}function HideOrderHistoryTable(a){if(a===undefined){a=false
}$("#divOrderHistoryGrid").addClass("hidden");$("#divOHFilterLegendWrapper").addClass("hidden");if(a){$("#divOrgManagePermission").removeClass("hidden")}else{$("#divNoOrders").removeClass("hidden")}}function showInvoicesManagePermissions(){$("#divOrgManagePermission").removeClass("hidden");$("#divOrderHistoryGrid").addClass("hidden");$("#divOHFilterLegendWrapper").addClass("hidden")}function showQuotesManagePermissions(){$("#divOrgManagePermission").removeClass("hidden");$("#divSearchGrid").addClass("hidden");
$("#divOHFilterLegendWrapper").addClass("hidden")}function CreateOrderHistoryDataTable(){if($("table#tblOrders").length==0){return}var e=true;var a=false;var d=displayRequestReturnsColumn;var f=noOrdersOrTimeout;var b=showManagePermissions;var c=$("table#tblOrders").dataTable({bProcessing:true,bAutoWidth:false,sPaginationType:"ellipses",sServerMethod:"POST",bServerSide:true,bJQueryUI:true,bDeferRender:true,iDisplayLength:25,sAjaxSource:"/api/OrderHistory/Orders?cultureCode="+encodeURIComponent(cultureCode)+"&currencyCulture="+encodeURIComponent(currencyCulture),sDom:'<"H"frli>t<"F"Tp>',aaSorting:[[1,"desc"]],oTableTools:{aButtons:[{sExtends:"text",sCharSet:"utf16le",bBomInc:true,sButtonClass:"btn btn-secondary",sButtonClassOverride:true,sButtonText:dataTableResources.ExportPageToExcel,sFieldBoundary:'"',sFieldSeperator:",",mColumns:"visible",fnClick:function(g,h,j){var i=this.fnGetTableData(h);
$.ajax({dataType:"text",type:"GET",cache:false,timeout:15000,url:"/OrderHistory/ExportToExcel",success:function(k){if(k){ajax_download(k,i,dataTableResources.AllOrders.replace(" ",""))}}})},fnCellRender:function(h,g){return ExtractData(h,g,", ")}},{sExtends:"print_new",bShowAll:false,sButtonText:dataTableResources.PrintPage,sInfo:dataTableResources.PrintView}]},aoColumns:[{mData:"DateCreated",bVisible:false,bSearchable:false},{mData:"SalesOrderDateDisplay",iDataSort:0,bSearchable:false,sWidth:"10%"},{mData:"SalesOrderNumber",bVisible:false},{mData:"WebOrderNumber",bVisible:false},{mData:"SalesOrderNumberDisplay",iDataSort:1,bSearchable:false},{mData:"WebOrderNumberDisplay",iDataSort:2,bSearchable:false},{mData:"PoNumber",iDataSort:3,sWidth:"12%"},{mData:"BuyerName",iDataSort:4,bSearchable:false,sWidth:"12%",mRender:adminIcon},{mData:"OpenLines",bVisible:false,bSearchable:false},{mData:"OpenTotal",bVisible:false,bSearchable:false},{mData:"CurrencyCode",bVisible:false,bSearchable:false},{mData:"OrderStatus",bVisible:false,bSearchable:false},{mData:"UpgradeShipSource",bVisible:false,bSearchable:false},{mData:"WaivedShipFlag",bVisible:false,bSearchable:false},{mData:"StatusToolTip",bVisible:false,bSearchable:false},{mData:"OrderStatusDisplay",iDataSort:8,bSearchable:false},{mData:"ShipmentNumber",bVisible:false,bSearchable:false},{mData:"ShipToCountry",bVisible:false,bSearchable:false},{mData:"PaymentGuid",bVisible:false,bSearchable:false},{mData:"PaymentMethodId",bVisible:false,bSearchable:false},{mData:"ActionItem",bVisible:false,bSearchable:false},{mData:"InvoiceNumberDisplay",bSortable:false,bSearchable:false},{mData:"InvoiceTotalDisplay",bSortable:false,bSearchable:false},{mData:"InvoiceDateDisplay",bSortable:false,bSearchable:false},{mData:"TrackingNumbersDisplay",bSortable:false,bSearchable:false},{mData:"Requests",bVisible:d,bSortable:false,bSearchable:false}],fnHeaderCallback:function(j,k,i,h,g){$("#divStatusToolTip").remove();
if(k.length>0&&k[0].StatusToolTip&&k[0].StatusToolTip.length>0){$('<div id="divStatusToolTip" class="hidden">'+k[0].StatusToolTip+" </div>").appendTo("body")}},fnDrawCallback:function(i){if($("img.status-bar").length>0||$("img.red-dot").length>0){var h=$("img.status-bar:first").length+$("img.red-dot:first").length;var j="ShowStatusToolTip('"+h+"');";var g="HideStatusToolTip();";if($("img.status-help-icon").length==0){$('<img src="/Images/icon_tooltip.png" width="14" height="14" class="status-help-icon" onmouseover="'+j+'" onmouseout="'+g+'" />').appendTo(".dataTable th:nth(5) .DataTables_sort_wrapper")
}}else{$("img.status-help-icon").remove()}if(d){if($("img.actionsStatus-help-icon").length==0){$('<img id="actionsStatus" src="/Images/icon_tooltip.png" width="14" height="14" class="actionsStatus-help-icon" onmouseover=ShowActionsStatusToolTip() onmouseout=HideActionsStatusToolTip() />').appendTo(".dataTable th:nth(10) .DataTables_sort_wrapper")}}},oLanguage:{sProcessing:'<img style="border-width:0px;" src="../images/processing_indicator.gif">',sEmptyTable:'<span class="error">'+dataTableResources.lblOrderHistoryNoRecord3+"</span>",sZeroRecords:'<span class="error">'+dataTableResources.lblNoResultsFilter+"</span>",oPaginate:{sFirst:"<span></span>",sLast:"<span></span>"},sLengthMenu:pageText,sSearch:dataTableResources.btnSearch,sInfo:pagingText,sInfoFiltered:dataTableResources.FilteredFrom.replace("{0}","_MAX_")},fnServerData:function(g,h,j,i){if(ShouldDisplayManagePermissionsModal()){DisplayManagePermissionsModal()
}else{h.push({name:"dateFilter",value:$("select[id$=ddlOrderDate] option:selected").val()},{name:"buyerFilter",value:$("select[id$=ddlBuyer] option:selected").text()},{name:"buyerValue",value:$("select[id$=ddlBuyer] option:selected").val()},{name:"statusValue",value:$("select[id$=ddlOrderStatus] option:selected").val()});$.ajax({dataType:"json",type:"GET",cache:false,timeout:50000,url:"/api/OrderHistory/AnyOrderswithOrganization",error:function(k){$(".dataTables_processing").css("visibility","hidden");f(e)},success:function(k){if(k.ShowManagePermissions&&!k.ShowData){b(e)
}else{if(!k.ShowData){f(e)}else{i.jqXHR=$.ajax({dataType:"json",type:"POST",cache:false,timeout:50000,url:g,data:h,success:function(l){if(!a){a=AddLinks()}j(l)},error:function(l){$(".dataTables_processing").css("visibility","hidden");f(e)}})}}}})}}}).fnSetFilteringDelay(1000);$("select[id$=ddlOrderDate]").on("change",function(){c.fnDraw()});$("select[id$=ddlBuyer]").on("change",function(){c.fnDraw()});$("select[id$=ddlOrderStatus]").on("change",function(){c.fnDraw()});$("div[id$=divOrderStatusFilter]").show();
AddHintText(dataTableResources.OrderPoNumber,"tblOrders")}function CreateOpenLinesDataTable(){if($("table#tblOpenOrders").length==0){return}var a=false;var c=false;var d=noOrdersOrTimeout;var b=$("table#tblOpenOrders").dataTable({bProcessing:true,bAutoWidth:false,sPaginationType:"ellipses",sServerMethod:"POST",bServerSide:true,bJQueryUI:true,bDeferRender:true,iDisplayLength:25,sAjaxSource:"/api/OrderHistory/OpenOrders?cultureCode="+encodeURIComponent(cultureCode)+"&currencyCulture="+encodeURIComponent(currencyCulture),sDom:'<"H"frli>t<"F"Tp>',aaSorting:[[1,"desc"]],oTableTools:{aButtons:[{sExtends:"text",sCharSet:"utf16le",bBomInc:true,sButtonClass:"btn btn-secondary",sButtonClassOverride:true,sButtonText:dataTableResources.ExportPageToExcel,sFieldBoundary:'"',sFieldSeperator:",",mColumns:"visible",fnClick:function(e,f,h){var g=this.fnGetTableData(f);
$.ajax({dataType:"text",type:"GET",cache:false,timeout:15000,url:"/OrderHistory/ExportToExcel",success:function(i){if(i){ajax_download(i,g,dataTableResources.OpenOrders.replace(" ",""))}}})}},{sExtends:"print_new",bShowAll:false,sButtonText:dataTableResources.PrintPage,sInfo:dataTableResources.PrintView}]},aoColumns:[{mData:"DateCreated",bVisible:false,bSearchable:false},{mData:"SalesOrderDateDisplay",iDataSort:0,bSearchable:false,sWidth:"10%"},{mData:"SalesOrderNumber",bVisible:false,sWidth:"5%"},{mData:"WebOrderNumber",bVisible:false,sWidth:"5%"},{mData:"SalesOrderNumberDisplay",iDataSort:1,bSearchable:false},{mData:"WebOrderNumberDisplay",iDataSort:2,bSearchable:false},{mData:"PoNumber",iDataSort:3},{mData:"BuyerName",iDataSort:4,bSearchable:false,sWidth:"10%",mRender:adminIcon},{mData:"OpenLines",iDataSort:5,bSearchable:false,sWidth:"5%"},{mData:"OpenTotalDisplay",iDataSort:6,bSearchable:false,sWidth:"5%"},{mData:"CurrencyCode",iDataSort:7,bSearchable:false,sWidth:"5%"},{mData:"OrderStatus",bVisible:false,bSearchable:false,sWidth:"10%"},{mData:"UpgradeShipSource",bVisible:false,bSearchable:false},{mData:"WaivedShipFlag",bVisible:false,bSearchable:false},{mData:"StatusToolTip",bVisible:false,bSearchable:false},{mData:"OrderStatusDisplay",iDataSort:8,bSearchable:false,sWidth:"15%"},{mData:"ShipmentNumber",bVisible:false,bSearchable:false},{mData:"ShipToCountry",bVisible:false,bSearchable:false},{mData:"PaymentGuid",bVisible:false,bSearchable:false},{mData:"PaymentMethodId",bVisible:false,bSearchable:false},{mData:"ActionItem",bSearchable:false,bSortable:false,sWidth:"15%"},{mData:"OpenTotal",bSearchable:false,bVisible:false}],fnHeaderCallback:function(h,i,g,f,e){$("#divStatusToolTip").remove();
if(i.length>0&&i[0].StatusToolTip&&i[0].StatusToolTip.length>0){$('<div id="divStatusToolTip" class="hidden">'+i[0].StatusToolTip+" </div>").appendTo("body")}},fnDrawCallback:function(g){if($("img.status-bar").length>0||$("img.red-dot").length>0){var f=$("img.status-bar:first").length+$("img.red-dot:first").length;var h="ShowStatusToolTip('"+f+"');";var e="HideStatusToolTip();";if($("img.status-help-icon").length==0){$('<img src="/Images/icon_tooltip.png" width="14" height="14" class="status-help-icon" onmouseover="'+h+'" onmouseout="'+e+'" />').appendTo(".dataTable th:nth(8) .DataTables_sort_wrapper")
}}else{$("img.status-help-icon").remove()}},oLanguage:{sProcessing:'<img style="border-width:0px;" src="../images/processing_indicator.gif">',sZeroRecords:'<span class="error">'+dataTableResources.lblNoResultsFilter+"</span>",sEmptyTable:'<span class="error">'+dataTableResources.lblOrderHistoryNoOpenOrders+"</span>",oPaginate:{sFirst:"<span></span>",sLast:"<span></span>"},sLengthMenu:pageText,sSearch:dataTableResources.btnSearch,sInfo:pagingText,sInfoFiltered:dataTableResources.FilteredFrom.replace("{0}","_MAX_")},fnServerData:function(e,f,h,g){if(ShouldDisplayManagePermissionsModal()){DisplayManagePermissionsModal()
}else{f.push({name:"dateFilter",value:$("select[id$=ddlOrderDate] option:selected").val()},{name:"buyerFilter",value:$("select[id$=ddlBuyer] option:selected").text()},{name:"buyerValue",value:$("select[id$=ddlBuyer] option:selected").val()},{name:"statusValue",value:$("select[id$=ddlOrderStatus] option:selected").val()});$.ajax({dataType:"json",type:"GET",cache:false,timeout:30000,url:"/api/OrderHistory/AnyOpenOrders",error:function(i){$(".dataTables_processing").css("visibility","hidden");d(c)},success:function(i){if(!i){d(c)
}else{g.jqXHR=$.ajax({dataType:"json",type:"POST",cache:false,timeout:30000,url:e,data:f,success:function(j){if(!a){a=AddLinks()}h(j)},error:function(j){$(".dataTables_processing").css("visibility","hidden");d(c)}})}}})}}}).fnSetFilteringDelay(1000);$("select[id$=ddlOrderDate]").on("change",function(){b.fnDraw()});$("select[id$=ddlBuyer]").on("change",function(){b.fnDraw()});$("select[id$=ddlOrderStatus]").on("change",function(){b.fnDraw()});$("div[id$=divOrderStatusFilter]").show();AddHintText(dataTableResources.OrderPoNumber,"tblOpenOrders")
}function CreateInvoiceDataTable(){if($("table#tblInvoices").length==0){return}var b=showInvoicesManagePermissions;var a=$("table#tblInvoices").dataTable({bProcessing:true,bAutoWidth:false,sPaginationType:"ellipses",sServerMethod:"POST",bServerSide:true,bJQueryUI:true,bDeferRender:true,iDisplayLength:25,sAjaxSource:"/api/OrderHistory/Invoices?currencyCulture="+encodeURIComponent(currencyCulture)+"&cultureCode="+encodeURIComponent(cultureCode),sDom:'<"H"frli>t<"F"Tp>',aaSorting:[[1,"desc"]],oTableTools:{aButtons:[{sExtends:"text",sCharSet:"utf16le",bBomInc:true,sButtonClass:"btn btn-secondary",sButtonClassOverride:true,sButtonText:dataTableResources.ExportPageToExcel,sFieldBoundary:'"',sFieldSeperator:",",mColumns:"visible",fnClick:function(c,d,f){var e=this.fnGetTableData(d);
$.ajax({dataType:"text",type:"GET",cache:false,timeout:15000,url:"/OrderHistory/ExportToExcel",success:function(g){if(g){ajax_download(g,e,dataTableResources.lblInvoices.replace(" ",""))}}})}},{sExtends:"print_new",bShowAll:false,sButtonText:dataTableResources.PrintPage,sInfo:dataTableResources.PrintView}]},aoColumns:[{mData:"InvoiceDate",bVisible:false,bSearchable:false},{mData:"InvoiceDateDisplay",iDataSort:0,bSearchable:false,sWidth:"10%"},{mData:"InvoiceNumber",bVisible:false},{mData:"InvoiceNumberDisplay",iDataSort:1,bSearchable:false},{mData:"InvoiceTotal",bVisible:false,bSearchable:false},{mData:"InvoiceTotalDisplay",iDataSort:2,bSearchable:false},{mData:"OrderDate",bVisible:false,bSearchable:false},{mData:"SalesOrderDateDisplay",iDataSort:3,bSearchable:false,sWidth:"10%"},{mData:"SalesOrderNumber",bVisible:false},{mData:"WebOrderNumber",bVisible:false},{mData:"SalesOrderNumberDisplay",iDataSort:4,bSearchable:false},{mData:"WebOrderNumberDisplay",iDataSort:5,bSearchable:false},{mData:"CurrencyCode",iDataSort:6},{mData:"PoNumber",iDataSort:7,sWidth:"10%"},{mData:"BuyerName",iDataSort:8,bSearchable:false,sWidth:"15%",mRender:adminIcon},{mData:"ShipToCountry",bVisible:false,bSearchable:false},{mData:"SoftwareParts",bVisible:false,bSearchable:false},{mData:"EmailAddress",bVisible:false,bSearchable:false},{mData:"ShippingMethodUvid",bVisible:false,bSearchable:false}],oLanguage:{sProcessing:'<img style="border-width:0px;" src="../images/processing_indicator.gif">',sEmptyTable:'<span class="error">'+dataTableResources.lblOrderHistoryNoRecord3+"</span>",sZeroRecords:'<span class="error">'+dataTableResources.lblNoResultsFilter+"</span>",oPaginate:{sFirst:"<span></span>",sLast:"<span></span>"},sLengthMenu:pageText,sSearch:dataTableResources.btnSearch,sInfo:pagingText,sInfoFiltered:dataTableResources.FilteredFrom.replace("{0}","_MAX_")},fnServerData:function(c,d,f,e){if(ShouldDisplayManagePermissionsModal()){DisplayManagePermissionsModal()
}else{d.push({name:"dateFilter",value:$("select[id$=ddlOrderDate] option:selected").val()},{name:"buyerFilter",value:$("select[id$=ddlBuyer] option:selected").text()},{name:"buyerValue",value:$("select[id$=ddlBuyer] option:selected").val()});$.ajax({dataType:"json",type:"GET",cache:false,timeout:100000,url:"/api/OrderHistory/AnyInvoiceswithOrganization",error:function(g){$(".dataTables_processing").css("visibility","hidden")},success:function(g){if(g.ShowManagePermissions){b()}else{e.jqXHR=$.ajax({dataType:"json",type:"POST",cache:false,timeout:100000,url:c,data:d,success:f,error:function(h,i){$(".dataTables_processing").css("visibility","hidden")
}})}}})}}}).fnSetFilteringDelay(1000);$("select[id$=ddlOrderDate]").on("change",function(){a.fnDraw()});$("select[id$=ddlBuyer]").on("change",function(){a.fnDraw()});AddHintText(dataTableResources.InvoiceOrderPoNumber,"tblInvoices")}function CreateOrderSearchDataTable(){if($("table#tblOrderSearch").length==0){return}var c=false;var a=false;var d=noOrdersOrTimeout;var b=$("table#tblOrderSearch").dataTable({bProcessing:true,bAutoWidth:false,sPaginationType:"ellipses",sServerMethod:"POST",bServerSide:true,bJQueryUI:true,bDeferRender:true,iDisplayLength:25,sAjaxSource:"/api/OrderHistory/Search?currencyCulture="+encodeURIComponent(currencyCulture)+"&cultureCode="+encodeURIComponent(cultureCode),sDom:'<"H"frli>t<"F"Tp>',fnHeaderCallback:function(h,i,g,f,e){if(i.length>0&&$("a#lnkSelectAll").length==0){$('<a id="lnkSelectAll" title="'+dataTableResources.SelectAllToolTip+'" + href="javascript:void(0);">'+dataTableResources.btnSelectAll+"</a>").appendTo(".dataTable th:nth(0) .DataTables_sort_wrapper")
}$("a#lnkSelectAll").on("click",function(){SelectAllCheckboxes("tblOrderSearch")})},oTableTools:{aButtons:[{sExtends:"text",sCharSet:"utf16le",bBomInc:true,sButtonClass:"btn btn-secondary",sButtonClassOverride:true,sButtonText:dataTableResources.ExportPageToExcel,sFieldBoundary:'"',sFieldSeperator:",",mColumns:"visible",fnClick:function(e,f,h){var g=this.fnGetTableData(f);$.ajax({dataType:"text",type:"GET",cache:false,timeout:15000,url:"/OrderHistory/ExportToExcel",success:function(i){if(i){ajax_download(i,g,dataTableResources.btnSearch.replace(" ",""))
}}})}},{sExtends:"print_new",bShowAll:false,sButtonText:dataTableResources.PrintPage,sInfo:dataTableResources.PrintView}]},aoColumns:[{mDataProp:null,sDefaultContent:"",bSortable:false,bSearchable:false,sWidth:"5%",sClass:"center"},{mData:"MouserPartNumber",bVisible:false},{mData:"MouserPartNumberDisplay",iDataSort:6,bSearchable:false},{mData:"CustomerPartNumber",iDataSort:7},{mData:"MFRPartNumber",iDataSort:8},{mData:"Manufacturer",iDataSort:9,sWidth:"10%"},{mData:"PartDescription",iDataSort:10,sWidth:"10%"},{mData:"Quantity",iDataSort:11},{mData:"UnitPrice",bVisible:false,bSearchable:false},{mData:"UnitPriceDisplay",iDataSort:12,bSearchable:false},{mData:"PONumber",iDataSort:13},{mData:"BuyerName",iDataSort:14,bSearchable:false,mRender:adminIcon},{mData:"UVSalesOrder_ID",bVisible:false},{mData:"SalesOrderNumberDisplay",iDataSort:15,bSearchable:false},{mData:"OrderDate",bVisible:false},{mData:"SalesOrderDateDisplay",iDataSort:16},{mData:"UVInvoice_ID",bVisible:false},{mData:"InvoiceNumberDisplay",iDataSort:17,bSearchable:false},{mData:"InvoiceDate",bVisible:false,bSearchable:false},{mData:"InvoiceDateDisplay",iDataSort:18,bSearchable:false},{mData:"ExtPrice",bVisible:false},{mData:"CurrencyCode",bVisible:false},{mData:"ShipToCountry",bVisible:false,bSearchable:false}],aoColumnDefs:[{fnRender:function(e){return'<input type="checkbox" data-partnumber="'+e.aData.MouserPartNumber+'" data-quantity="'+e.aData.Quantity+'">'
},aTargets:[0]}],oLanguage:{sProcessing:'<img style="border-width:0px;" src="../images/processing_indicator.gif">',sEmptyTable:'<span class="error">'+dataTableResources.lblNoResultsFilter+"</span>",sZeroRecords:'<span class="error">'+dataTableResources.lblNoResultsFilter+"</span>",oPaginate:{sFirst:"<span></span>",sLast:"<span></span>"},sLengthMenu:pageText,sSearch:dataTableResources.btnSearch,sInfo:pagingText,sInfoFiltered:dataTableResources.FilteredFrom.replace("{0}","_MAX_")},fnServerData:function(e,f,h,g){if(ShouldDisplayManagePermissionsModal()){DisplayManagePermissionsModal()
}else{f.push({name:"dateFilter",value:$("select[id$=ddlOrderDate] option:selected").val()},{name:"buyerFilter",value:$("select[id$=ddlBuyer] option:selected").text()},{name:"buyerValue",value:$("select[id$=ddlBuyer] option:selected").val()},{name:"searchTerm",value:$("input[id$=txtSearch]").val()});$.ajax({dataType:"json",type:"GET",cache:false,timeout:30000,url:"/api/OrderHistory/AnyOrders",error:function(i){$(".dataTables_processing").css("visibility","hidden");d(c)},success:function(i){if(!i){d(c)}else{g.jqXHR=$.ajax({dataType:"json",type:"POST",cache:false,timeout:30000,url:e,data:f,success:function(j){if(!a){a=AddLinks()
}h(j)},error:function(j,k){$(".dataTables_processing").css("visibility","hidden");d(c)}})}}})}}}).fnSetFilteringDelay(1000);$("select[id$=ddlOrderDate]").on("change",function(){b.fnDraw()});$("select[id$=ddlBuyer]").on("change",function(){b.fnDraw()});$("div[id$=divOrderStatusFilter]").show();AddHintText(dataTableResources.SearchHintText,"tblOrderSearch")}function CreateSavedCartsDataTable(){if($("table#tblSavedCarts").length==0){return}var b=$("table#tblSavedCarts").dataTable({bProcessing:true,bAutoWidth:false,sPaginationType:"ellipses",sServerMethod:"POST",bServerSide:true,bJQueryUI:true,bDeferRender:true,iDisplayLength:25,sAjaxSource:"/api/OrderHistory/SavedCarts?cultureCode="+encodeURIComponent(cultureCode)+"&currencyCulture="+encodeURIComponent(currencyCulture),sDom:'<"H"frli>t<"F"Tp>',aaSorting:[[16,"desc"]],fnHeaderCallback:function(f,g,e,d,c){if(g.length>0&&$("a#lnkSelectAll").length==0){$('<a id="lnkSelectAll" title="'+dataTableResources.SelectAllToolTip+'" + href="javascript:void(0);">'+dataTableResources.btnSelectAll+'</a><img width="14" height="14" class="status-help-icon" src="/Images/icon_tooltip.png" onclick="DisplayInfoModal(\''+dataTableResources.SelectAllHelp+"','"+dataTableResources.SelectCartHelp+"');\">").appendTo(".dataTable th:nth(5) .DataTables_sort_wrapper")
}$("a#lnkSelectAll").on("click",function(){SelectAllCheckboxes("tblSavedCarts")})},fnDrawCallback:function(c){$("div.floatright,hidden").removeClass("hidden");if(c.aoData.length==0){$("div.divOrderHistoryContainer a.cartActive,a.cartMerge,a.cartDelete").addClass("hide")}else{if(c.aoData.length==1){$("div.divOrderHistoryContainer a.cartMerge").addClass("hide");if(c.aoData[0]._aData.ActiveCart){$("div.divOrderHistoryContainer a.cartActive").addClass("hide")}else{$("div.divOrderHistoryContainer a.cartActive").removeClass("hide")
}$("div.divOrderHistoryContainer a.cartDelete").removeClass("hide")}else{$("div.divOrderHistoryContainer a.cartActive,a.cartMerge,a.cartDelete").removeClass("hide")}}},oTableTools:{aButtons:[{sExtends:"text",sCharSet:"utf16le",bBomInc:true,sButtonClass:"btn btn-secondary",sButtonClassOverride:true,sButtonText:dataTableResources.ExportPageToExcel,sFieldBoundary:'"',sFieldSeperator:",",mColumns:"visible",fnClick:function(c,d,f){var e=this.fnGetTableData(d);$.ajax({dataType:"text",type:"GET",cache:false,timeout:15000,url:"/OrderHistory/ExportToExcel",success:function(g){if(g){ajax_download(g,e,"SharedCart")
}}})}},{sExtends:"print_new",bShowAll:false,sButtonText:dataTableResources.PrintPage,sInfo:dataTableResources.PrintView}]},aoColumns:[{mData:"EditLink",iDataSort:0},{mData:"AccessId",bVisible:false,bSearchable:false,bSortable:false},{mData:"AccessIdDisplay",bVisible:false,bSearchable:false,bSortable:false},{mData:"DateCreated",bVisible:false,bSearchable:false},{mData:"DateCreatedDisplay",iDataSort:3,bSearchable:false},{mData:"LastUpdated",bVisible:false,bSearchable:false},{mData:"LastUpdatedDisplay",iDataSort:16,bSearchable:false},{mData:"OrderStatus",iDataSort:5,bSearchable:false},{mData:"DeleteLink",bVisible:false,bSearchable:false,bSortable:false},{mData:"ProjectGuid",bVisible:false,bSearchable:false,bSortable:false},{mData:"EditLink",bVisible:false,bSearchable:false,bSortable:false},{mData:"SharedLink",bVisible:false,bSearchable:false,bSortable:false},{mData:"ProjectLineCount",bVisible:false,bSearchable:false,bSortable:false},{mData:"DisableDropdown",bVisible:false,bSearchable:false,bSortable:false},{mData:"Archived",bVisible:false,bSearchable:false,bSortable:false},{mData:"IsSavedOrSharedCart",bVisible:false,bSearchable:false,bSortable:false},{mData:"CartGuid",bVisible:false,bSearchable:false,bSortable:false},{mData:"ProjectLineCount",iDataSort:10,bSearchable:false,},{mData:"ActiveCart",bVisible:false,bSearchable:false,bSortable:false},{mData:"HasScheduleReleases",bVisible:false,bSearchable:false,bSortable:false},{mDataProp:null,sDefaultContent:"",bSortable:false,bSearchable:false,sWidth:"12%",sClass:"center"}],oLanguage:{sProcessing:'<img style="border-width:0px;" src="../images/processing_indicator.gif">',sEmptyTable:'<span class="error">'+dataTableResources.lblNoSavedCarts+"</span>",sZeroRecords:'<span class="error">'+dataTableResources.lblNoResultsFilter+"</span>",oPaginate:{sFirst:"<span></span>",sLast:"<span></span>"},sLengthMenu:pageText,sSearch:dataTableResources.btnSearch,sInfo:pagingText,sInfoFiltered:dataTableResources.FilteredFrom.replace("{0}","_MAX_")},aoColumnDefs:[{fnRender:function(c){return'<input type="checkbox" data-projectGuid="'+c.aData.AccessId+'" data-cartGuid="'+c.aData.CartGuid+'" data-activeCart="'+c.aData.ActiveCart+'">'
},aTargets:[20]}],fnServerData:function(c,d,f,e){d.push({name:"dateFilter",value:$("select[id$=ddlOrderDate] option:selected").val()});e.jqXHR=$.ajax({dataType:"json",type:"POST",cache:false,timeout:30000,url:c,data:d,success:f,error:function(g,h){$(".dataTables_processing").css("visibility","hidden")}})}}).fnSetFilteringDelay(1000);$("select[id$=ddlOrderDate]").on("change",function(){b.fnDraw()});AddHintText(dataTableResources.lblCartNameHeader,"tblSavedCarts");var a=GetSavedCartHelpModalValue();if(!a||a==="0"){DisplayCartHelpModal(true);
HideSavedCartsHelpModal()}}function GetSavedCartHelpModalValue(){var a=getPreferencesCookie();return a.SCH}function CreateSavedCart(b,a){$.ajax({url:"/api/OrderHistory/CreateSavedCart?cartGuid="+encodeURIComponent(b)+"&cartName="+encodeURIComponent(a),cache:false,type:"POST",timeout:15000,contentType:"application/json",success:function(c){window.location.href=c},error:function(){alert($("span[id$=litError]").html().trim())}})}function MakeCartActive(){if($("div.divOrderHistoryContainer a.cartActive").hasClass("disabled")){return
}var b=$(":checkbox:checked");if(!AreAnyChecked()){AddOrderHistoryGa("Error Message Pop-up","Make Active Error (None Selected)");DisplayInfoModal(dataTableResources.SelectCartToMakeActive,dataTableResources.MakeCartActive);return}if($(":checkbox:checked").length>1){AddOrderHistoryGa("Error Message Pop-up","Make Active Error (Multiple Selected)");DisplayInfoModal(dataTableResources.OneCartActive,dataTableResources.MakeCartActive);return}if(b.data("activecart")){AddOrderHistoryGa("Error Message Pop-up","Make Active Error (Active Cart Active)");
b.prop("checked",false);var a=$('<div id="saveChangesModal" class="confirmLicenseDialog"><p>'+dataTableResources.SelectedCartIsActive+"</p></div>");a.dialog({title:dataTableResources.MakeCartActive,resizable:false,modal:true,width:440,height:200,maxHeight:550,close:function(){$(this).dialog("destroy")},buttons:[{id:"submitHdr",text:dataTableResources.lblViewCart,"class":"ui-button",click:function(){$(this).dialog("destroy");window.location.href="/Cart"}}]});return}DisplayConfirmModal(dataTableResources.ConfirmActiveCart,dataTableResources.MakeCartActive,dataTableResources.MakeActive,ActivateCart,MakeCartActiveCancelGa)
}function MakeCartActiveCancelGa(){AddOrderHistoryGa("Make Cart Active Button","Cancel Make Active")}function DisplayCartHelpModal(a){var b=$('<div class="sc-help-modal"><p>'+dataTableResources.SavedCartsHelpContent+"</p></div>");b.dialog({title:dataTableResources.SavedSharedCartHelp,resizable:false,modal:true,width:600,height:455,maxHeight:550,beforeClose:function(){var c=($("div.helpSection-helpBox").scrollTop()>600?1:0);if(a){AddOrderHistoryGa("Active Cart Help","Welcome Help",c)}else{AddOrderHistoryGa("Active Cart Help","Button Help",c)
}},close:function(){$(this).dialog("destroy")}})}function HideSavedCartsHelpModal(){if(GetSavedCartHelpModalValue()==="1"){return}$.ajax({type:"POST",async:false,url:"/api/Preferences/HideSavedCartsHelpModal?sch=1",timeout:3000})}function DisplayConfirmModal(b,f,e,a,c){var g=$('<div id="saveChangesModal" class="confirmLicenseDialog"><p>'+b+"</p></div>");g.dialog({title:f,resizable:false,modal:true,width:440,height:200,maxHeight:550,close:function(){$(this).dialog("destroy");c()},buttons:[{id:"btnCancel",text:dataTableResources.btnCancel,click:function(){$(this).dialog("destroy");
c()}},{id:"btnConfirm",text:e,"class":"ui-button",click:function(){$(this).dialog("destroy");a()}}]})}function ActivateCart(){var a="";var b=$(":checkbox:checked");if(b.data("projectguid").toString().length>0&&b.data("projectguid")!="-"){a=b.data("projectguid")}else{if(b.data("cartguid").toString().length>0){a=b.data("cartguid")}}$.ajax({url:"/api/OrderHistory/MakeCartActive?guid="+encodeURIComponent(a),cache:false,type:"POST",timeout:30000,contentType:"application/json",success:function(){var d=$("table#tblSavedCarts").dataTable().fnGetData(b.parents("tr")[0]).DateCreated;
var c=d.split("T");AddOrderHistoryGa("Make Cart Active Button","Make Active",Daydiff(parseDate(c[0]),GetCurrentDate()));window.location.href="/Cart"},error:function(){alert($("span[id$=litError]").html().trim())}})}function AddOrderHistoryGa(b,a,c){GaEvent("Order History Page",b,a,c)}function parseDate(b){var a=b.split("-");return new Date(a[0],a[1]-1,a[2])}function Daydiff(b,a){return(a-b)/(1000*60*60*24)}function GetCurrentDate(){var e=new Date();var f=e.getFullYear();var a=e.getDate();var b=(f)+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+a).slice(-2);
var c=new String(b).split("-");return new Date(c[0],c[1]-1,c[2])}function DeleteCartsConfirm(){if($("div.divOrderHistoryContainer a.cartDelete").hasClass("disabled")){return}if(!AreAnyChecked()){AddOrderHistoryGa("Error Message Pop-up","Delete Error (None Selected)");DisplayInfoModal(dataTableResources.SelectCartToDelete,dataTableResources.btnDeleteCart);return}var c="";var a=dataTableResources.btnDeleteCart;var d=$(":checkbox:checked");var b="";d.each(function(){if($(this).data("activecart")){b=true}});if(b){c=dataTableResources.WarningCartLost
}else{if(d.length>1){c=dataTableResources.ConfirmDeleteCarts;a=dataTableResources.DeleteCarts}else{c=dataTableResources.ConfirmDeleteCart}}DisplayConfirmModal(c,dataTableResources.btnDeleteCart,a,DeleteCarts,DeleteCartsCancelGa)}function DeleteCartsCancelGa(){AddOrderHistoryGa("Delete Cart Button","Cancel")}function GetCartAndProjectList(){var d=$(":checkbox:checked");var a=[];var c=[];var b={};b.HasActiveCart=false;d.each(function(){if($(this).data("activecart")){b.HasActiveCart=true}if($(this).data("projectguid").toString().length>0&&$(this).data("projectguid")!="-"){c.push($(this).data("projectguid"))
}else{if($(this).data("cartguid").toString().length>0){a.push($(this).data("cartguid"))}}});b.ProjectList=c;b.CartList=a;return b}function DeleteCarts(){var a=GetCartAndProjectList();$.ajax({url:"/api/OrderHistory/DeleteCarts",cache:false,type:"POST",timeout:30000,contentType:"application/json",data:JSON.stringify(a),success:function(){var b=((a.ProjectList.length+a.CartList.length)>1?"Multiple Delete":"Single Delete");AddOrderHistoryGa("Delete Cart Button",b);$("table#tblSavedCarts").dataTable().fnReloadAjax();
if(a.HasActiveCart){MiniCart.SetStringNMsgForMiniCart(0,0);MiniCart.CreateMiniCart(true);MiniCart.TotalDisplayRecords=0}},error:function(){alert($("span[id$=litError]").html().trim())}})}function MergeCartsConfirm(){if($("div.divOrderHistoryContainer a.cartMerge").hasClass("hide")){return}if(!AreAnyChecked()||$(":checkbox:checked").length<2){AddOrderHistoryGa("Error Message Pop-up","Merge Carts Error (None/One Selected)");DisplayInfoModal(dataTableResources.TwoMergeCarts,dataTableResources.MergeCarts);return
}DisplayConfirmModal(dataTableResources.ConfirmMergeCarts,dataTableResources.MergeCarts,dataTableResources.MergeCarts,MergeCarts,MergeCartsCancelGa)}function MergeCartsCancelGa(){AddOrderHistoryGa("Merge Carts Button","Cancel Merge Carts")}function MergeCarts(){var b=setTimeout(function(){$("a#lnkloader").trigger("click")},1500);var a=GetCartAndProjectList();$.ajax({url:"/api/OrderHistory/MergeCarts?cultureCode="+encodeURIComponent(cultureCode)+"&currencyCulture="+encodeURIComponent(currencyCulture),cache:false,type:"POST",timeout:120000,contentType:"application/json",data:JSON.stringify(a),success:function(){AddOrderHistoryGa("Merge Carts Button","Merge Carts",(a.ProjectList.length+a.CartList.length));
window.clearTimeout(b);$.colorbox.close();$("table#tblSavedCarts").dataTable().fnReloadAjax()},error:function(){$.colorbox.close();alert($("span[id$=litError]").html().trim())}})}function CreateProjectsDataTable(){if($("table#tblProjects").length==0){return}var a=$("table#tblProjects").dataTable({bProcessing:true,bAutoWidth:false,sPaginationType:"ellipses",sServerMethod:"POST",bServerSide:true,bJQueryUI:true,bDeferRender:true,iDisplayLength:25,sAjaxSource:"/api/OrderHistory/Projects?cultureCode="+encodeURIComponent(cultureCode)+"&currencyCulture="+encodeURIComponent(currencyCulture),sDom:'<"H"frli>t<"F"Tp>',aaSorting:[[3,"desc"]],oTableTools:{aButtons:[{sExtends:"text",sCharSet:"utf16le",bBomInc:true,sButtonClass:"btn btn-secondary",sButtonClassOverride:true,sButtonText:dataTableResources.ExportPageToExcel,sFieldBoundary:'"',sFieldSeperator:",",mColumns:"visible",fnClick:function(b,c,e){var d=this.fnGetTableData(c);
$.ajax({dataType:"text",type:"GET",cache:false,timeout:15000,url:"/OrderHistory/ExportToExcel",success:function(f){if(f){ajax_download(f,d,dataTableResources.lbProject.replace(" ",""))}}})}},{sExtends:"print_new",bShowAll:false,sButtonText:dataTableResources.PrintPage,sInfo:dataTableResources.PrintView}]},aoColumns:[{mData:"EditLink",iDataSort:0},{mData:"ProjectLineCount",iDataSort:10,bSearchable:false,},{mData:"DateCreated",bVisible:false,bSearchable:false},{mData:"DateCreatedDisplay",iDataSort:3,bSearchable:false},{mData:"AccessId",bSortable:false},{mData:"ArchiveLink",bSearchable:false,bSortable:false},{mData:"SharedLink",bSearchable:false,bSortable:false,sWidth:"5%"},{mData:"DeleteLink",bSearchable:false,bSortable:false,sWidth:"5%"},{mData:"OrderStatus",bVisible:false,bSearchable:false,bSortable:false},{mData:"ProjectGuid",bVisible:false,bSearchable:false,bSortable:false},{mData:"DisableDropdown",bVisible:false,bSearchable:false,bSortable:false},{mData:"Archived",bVisible:false,bSearchable:false,bSortable:false},{mData:"IsSavedOrSharedCart",bVisible:false,bSearchable:false,bSortable:false},{mData:"CartGuid",bVisible:false,bSearchable:false,bSortable:false},{mData:"ActiveCart",bVisible:false,bSearchable:false,bSortable:false},{mData:"LastUpdated",bVisible:false,bSearchable:false,bSortable:false},{mData:"HasScheduleReleases",bVisible:false,bSearchable:false,bSortable:false}],oLanguage:{sProcessing:'<img style="border-width:0px;" src="../images/processing_indicator.gif">',sEmptyTable:'<span class="error">'+dataTableResources.lblProjects+"</span>",sZeroRecords:'<span class="error">'+dataTableResources.lblNoResultsFilter+"</span>",oPaginate:{sFirst:"<span></span>",sLast:"<span></span>"},sLengthMenu:pageText,sSearch:dataTableResources.btnSearch,sInfo:pagingText,sInfoFiltered:dataTableResources.FilteredFrom.replace("{0}","_MAX_")},fnDrawCallback:function(b){if(b.aoData.length==0||b.aoData[0]._aData.DisableDropdown){$("select[id$=ddlProjectArchive]").val("-1");
$("select[id$=ddlProjectArchive]").prop("disabled",true)}else{$("select[id$=ddlProjectArchive]").prop("disabled",false)}$("a.pm-delete").on("click",function(){var e=$(this);var c=e.data("guid");var f=$('<div id="saveChangesModal" class="confirmLicenseDialog"><p>'+dataTableResources.ConfirmDelete.format(dataTableResources.lblProject)+"</p></div>");f.dialog({title:dataTableResources.btnDeleteProject,resizable:false,modal:true,width:440,height:200,maxHeight:550,close:function(){$(this).dialog("destroy")},buttons:[{id:"btnCancel",text:dataTableResources.btnCancel,click:function(){$(this).dialog("destroy")
}},{id:"btnConfirm",text:dataTableResources.btnDeleteProject,"class":"ui-button",click:function(){DeleteProject($(this),a,e,c)}}]})});$("a.pm-share").on("click",function(){$.ajax({url:"/api/OrderHistory/ShareProject?projectGuid="+$(this).data("guid"),cache:false,timeout:20000,type:"POST",success:function(c){window.location.href=c},error:function(){}})});$("a.m-btn-primary,a.m-btn-secondary","#tblProjects").on("click",function(){ShowArchiveProjectModal(a,$(this).data("guid"),($(this).data("archive")=="True"),"Homepage",dataTableResources.ArchiveThisProject,dataTableResources.ActivateThisProject,dataTableResources.ArchiveProject,dataTableResources.btnCancel,dataTableResources.ArchiveProject,dataTableResources.ActivateProject,dataTableResources.lblCommErrorTitle)
})},fnServerData:function(b,c,e,d){c.push({name:"dateFilter",value:$("select[id$=ddlOrderDate] option:selected").val()},{name:"projectFilter",value:$("select[id$=ddlProjectArchive] option:selected").val()});d.jqXHR=$.ajax({dataType:"json",type:"POST",cache:false,timeout:30000,url:b,data:c,success:e,error:function(f,g){$(".dataTables_processing").css("visibility","hidden")}})}}).fnSetFilteringDelay(1000);$("select[id$=ddlOrderDate]").on("change",function(){a.fnDraw()});$("select[id$=ddlProjectArchive]").on("change",function(){a.fnDraw()
});$("div[id$=divProjectArchiveFilter]").show();AddHintText(dataTableResources.ProjectNameAccessID,"tblProjects");$("input[id$=btnNewProject]").on("click",function(){return true})}function CreateQuotesDataTable(){if($("table#tblQuotes").length==0){return}var b=showQuotesManagePermissions;var a=$("table#tblQuotes").dataTable({bProcessing:true,bAutoWidth:false,sPaginationType:"ellipses",sServerMethod:"POST",bServerSide:true,bJQueryUI:true,bDeferRender:true,iDisplayLength:25,sAjaxSource:"/api/OrderHistory/Quotes?cultureCode="+encodeURIComponent(cultureCode)+"&currencyCulture="+encodeURIComponent(currencyCulture),sDom:'<"H"frli>t<"F"Tp>',fnHeaderCallback:function(c,d){if(d.length>0&&$("a#lnkSelectAll").length==0){$('<a id="lnkSelectAll" title="'+dataTableResources.SelectAllToolTip+'" + href="javascript:void(0);">'+dataTableResources.btnSelectAll+"</a>").appendTo(".dataTable th:nth(0) .DataTables_sort_wrapper")
}$("a#lnkSelectAll").on("click",function(){SelectAllCheckboxes("tblQuotes")})},fnDrawCallback:function(){if(a.fnSettings().fnRecordsTotal()<=0&&window.location.href.indexOf("qs")=="-1"){$("span[id$=lblQuotesDetails]").hide();if($("select[id$=ddlOrderDate] option:selected").index()>0||$("select[id$=ddlBuyer] option:selected").index()>0){$("div[id$=divQuoteSearch]").hide();$("#divSearchGrid").show()}else{$("div[id$=divQuoteSearch]").show();$("#divSearchGrid").hide()}}else{$("#divSearchGrid").show();$("span[id$=lblQuotesDetails]").show();
$("div[id$=divQuoteSearch]").hide()}},aaSorting:[[2,"desc"]],oTableTools:{aButtons:[{sExtends:"text",sCharSet:"utf16le",bBomInc:true,sButtonClass:"btn btn-secondary",sButtonClassOverride:true,sButtonText:dataTableResources.ExportPageToExcel,sFieldBoundary:'"',sFieldSeperator:",",mColumns:"visible",fnClick:function(c,d,f){var e=this.fnGetTableData(d);$.ajax({dataType:"text",type:"GET",cache:false,timeout:15000,url:"/OrderHistory/ExportToExcel",success:function(g){if(g){ajax_download(g,e,dataTableResources.Quotes.replace(" ",""))
}}})}},{sExtends:"print_new",bShowAll:false,sButtonText:dataTableResources.PrintPage,sInfo:dataTableResources.PrintView}]},aoColumns:[{mDataProp:null,sDefaultContent:"",bSortable:false,bSearchable:false,sClass:"center"},{mData:"DateCreated",bVisible:false,bSearchable:false},{mData:"DateCreatedDisplay",iDataSort:0,bSearchable:false},{mData:"QuoteNumber",bVisible:false},{mData:"QuoteNumberDisplay",bSearchable:false,iDataSort:2},{mData:"ReferenceNumber",iDataSort:4},{mData:"BuyerName",bSearchable:false,iDataSort:5,mRender:adminIcon},{mData:"ProductCount",bSearchable:false,iDataSort:6},{mData:"SalesRep",bSearchable:false,bSortable:false},{mData:"Status",bSearchable:false,iDataSort:8}],aoColumnDefs:[{fnRender:function(c){if(c.aData.ValidCurrency){return'<input type="checkbox" class="chk-quote" data-guid="'+c.aData.Guid+'" data-quotenumber="'+c.aData.QuoteNumber+'">'
}return""},aTargets:[0]}],oLanguage:{sProcessing:'<img style="border-width:0px;" src="../images/processing_indicator.gif">',sZeroRecords:'<span class="error">'+dataTableResources.lblNoResultsFilter+"</span>",oPaginate:{sFirst:"<span></span>",sLast:"<span></span>"},sLengthMenu:pageText,sSearch:dataTableResources.btnSearch,sInfo:pagingText,sInfoFiltered:dataTableResources.FilteredFrom.replace("{0}","_MAX_")},fnServerData:function(c,d,f,e){if(ShouldDisplayManagePermissionsModal()){DisplayManagePermissionsModal()
}else{d.push({name:"dateFilter",value:$("select[id$=ddlOrderDate] option:selected").val()},{name:"buyerFilter",value:$("select[id$=ddlBuyer] option:selected").text()},{name:"buyerValue",value:$("select[id$=ddlBuyer] option:selected").val()});$.ajax({dataType:"json",type:"GET",cache:false,timeout:100000,url:"/api/OrderHistory/AnyQuoteswithOrganization",error:function(g){$(".dataTables_processing").css("visibility","hidden");if(g.responseText&&g.responseText.indexOf("Invalid querystring count")>-1){window.location.href="/MyAccount/MouserLogin"
}},success:function(g){if(g.ShowManagePermissions){b()}else{e.jqXHR=$.ajax({dataType:"json",type:"POST",cache:false,timeout:100000,url:c,data:d,success:f,error:function(h,i){$(".dataTables_processing").css("visibility","hidden");if(h.responseText&&h.responseText.indexOf("Invalid querystring count")>-1){window.location.href="/MyAccount/MouserLogin"}}})}}})}}}).fnSetFilteringDelay(1000);$("select[id$=ddlOrderDate]").on("change",function(){a.fnDraw()});$("select[id$=ddlBuyer]").on("change",function(){a.fnDraw()
});AddHintText(dataTableResources.QuoteSearchText,"tblQuotes")}function ExtractData(o,h,l){if(Number(o)==o){return o}var a=o.indexOf("href");var r=o.indexOf("return false");var q=o.indexOf("divStatus");var m=o.indexOf("javascript");var p=o.indexOf("<br />");var c=o.indexOf("span");var g=o.indexOf("fa-shield-check");if(a>0||h==21||h==24){if(h==21||h==24){var k=o.split("<br />");RemoveEmptyArrayItems(k);var f="";for(var e=0;e<k.length;e++){if(a>0){f+=k[e].substring(k[e].indexOf(">")+1,k[e].indexOf("</a>"))}else{f+=k[e]
}if(k[e].length>0&&f!="-"&&(k.length-1)>e){f+=l}}o=f}else{o=o.substring(o.indexOf(">")+1,o.indexOf("</a>"))}}else{if(r>0){o=o.substring(r+15,o.length).replace("</a>","");var b=o.indexOf("&nbsp;");if(b>0){o=o.replace(o.substring(b,o.length),"")}}else{if(q>0){o=o.substring(q+11,o.length).replace("</div>","");var n=o.indexOf("<img");if(n>0){o=o.replace(o.substring(n,o.length),"")}}else{if(m>0){o=""}else{if(p>0){k=o.split("<br />");RemoveEmptyArrayItems(k);f="";for(var d=0;d<k.length;d++){f+=k[d];if(k[d].length>0&&(k.length-1)>d){f+=l
}}o=f}else{if(c>0){o=o.substring(c+19,o.length).replace("</span>","")}}}}}}if(g>0){o=o.replace(/<i[^>]*><\/i>/ig,"")}return o=o.replace(/<br\s*\/?>/gi,"")}function RemoveEmptyArrayItems(b){var a=b.indexOf("");if(a>-1){b.splice(a,1)}}function ReorderSelectedItems(a){if(!AreAnyChecked()){alert(a)}else{$(".dataTables_processing").css("visibility","visible");var b={};$("table#tblOrderSearch input:checked").each(function(){var d=$(this).data("quantity");var c=$(this).data("partnumber");if(b[c]){b[c]=b[c]+d}else{b[c]=d
}});$.ajax({url:"/api/OrderHistory/ReorderSelectedItems",cache:false,type:"POST",timeout:30000,contentType:"application/json",data:JSON.stringify(b),success:function(){window.location.href="/Cart"},error:function(){alert($("span[id$=litError]").html().trim());$(".dataTables_processing").css("visibility","hidden")}})}}function AddHintText(a,b){$("div#"+b+"_filter").parent().find("input").attr("class","hint");$("div#"+b+"_filter").parent().find("input").attr("placeholder",a)}function EmailSelectedQuotes(){if($(".chk-quote:checked").length==0){alert(dataTableResources.litSelectQuotes);
return}var a=[];$(".chk-quote:checked").each(function(){a.push($(this).data("quotenumber")+":"+$(this).data("guid"))});$.ajax({url:"/api/OrderHistory/GetEncryptedQuoteIds",cache:false,type:"POST",timeout:15000,contentType:"application/json",data:JSON.stringify(a),success:function(b){$("a#lnkEmailQuote").attr("href","/OrderHistory/EmailQuotes.aspx?qs="+b+"&TB_iframe=true&height=250&width=450&modal=true");$("a#lnkEmailQuote").trigger("click")},error:function(){alert($("span[id$=litError]").html().trim())}})}function BuySelectedQuotes(){if($(".chk-quote:checked").length==0){alert(dataTableResources.litSelectQuotesBuy);
return}$("a#lnkloader").trigger("click");var a=[];$(".chk-quote:checked").each(function(){a.push($(this).data("guid"))});$.ajax({url:"/api/OrderHistory/BuySelectedQuotes",cache:false,type:"POST",timeout:30000,contentType:"application/json",data:JSON.stringify(a),success:function(){window.location.href="/Cart"},error:function(){tb_remove();alert($("span[id$=litError]").html().trim())}})}function CreateBomDataTable(){if($("table#tblBoms").length==0){return}$("a#lnkCreateNewBom").on("click",function(){$.ajax({url:"/OrderHistory/CreateNewBom",cache:false,type:"GET",success:function(c){var b=$("div.error-container");
if(c.ErrorMessage.length>0){if(b.hasClass("hidden")){$("p#pErrorMessage").replaceWith(c.ErrorMessage);b.toggleClass("hidden");if($.scrollTo){$.scrollTo(b,1000,{easing:"easeInCubic",axis:"y"})}}}else{window.location=c.ReturnUrl}},error:function(){}})});var a=$("table#tblBoms").dataTable({bProcessing:true,bAutoWidth:false,sPaginationType:"ellipses",sServerMethod:"POST",bServerSide:true,bJQueryUI:true,bDeferRender:true,iDisplayLength:25,sAjaxSource:"/api/OrderHistory/Boms?cultureCode="+encodeURIComponent(cultureCode)+"&currencyCulture="+encodeURIComponent(currencyCulture),sDom:'<"H"frli>t<"F"Tp>',aaSorting:[[2,"desc"]],oTableTools:{aButtons:[{sExtends:"text",sCharSet:"utf16le",bBomInc:true,sButtonClass:"btn btn-secondary",sButtonClassOverride:true,sButtonText:dataTableResources.ExportPageToExcel,sFieldBoundary:'"',sFieldSeperator:",",mColumns:"visible",fnClick:function(b,c,e){var d=this.fnGetTableData(c);
$.ajax({dataType:"text",type:"GET",cache:false,timeout:15000,url:"/OrderHistory/ExportToExcel",success:function(f){if(f){ajax_download(f,d,"BOMs")}}})}},{sExtends:"print_new",bShowAll:false,sButtonText:dataTableResources.PrintPage,sInfo:dataTableResources.PrintView}]},aoColumns:[{mData:"BomNameDisplay",iDataSort:8,bSearchable:false,sWidth:"20%",sClass:"bomname-col"},{mData:"Status",bSortable:false,sWidth:"10%",bSearchable:false},{mData:"DateCreatedDisplay",iDataSort:11,bSearchable:false,sWidth:"10%"},{mData:"DateExpiresDisplay",iDataSort:25,bSearchable:false,sWidth:"10%"},{mData:"LinesQuoted",iDataSort:27,bSearchable:false,sWidth:"8%"},{mData:"BuyLink",bSortable:false,bSearchable:false,sWidth:"15%"},{mData:"ExportLink",bSortable:false,bSearchable:false,sWidth:"8%"},{mData:"DeleteLink",bSortable:false,bSearchable:false,sWidth:"8%"}],oLanguage:{sProcessing:'<img style="border-width:0px;" src="../images/processing_indicator.gif">',sEmptyTable:'<span class="error">'+dataTableResources.NoBomsForAccount+"</span>",sZeroRecords:'<span class="error">'+dataTableResources.lblNoResultsFilter+"</span>",oPaginate:{sFirst:"<span></span>",sLast:"<span></span>"},sLengthMenu:pageText,sSearch:dataTableResources.btnSearch,sInfo:pagingText,sInfoFiltered:dataTableResources.FilteredFrom.replace("{0}","_MAX_")},fnDrawCallback:function(){$("a.delete-bom").on("click",function(){ConfirmDeleteBom(a,$(this).data("bomid"))
});$("a.cancel-bom").on("click",function(){ConfirmCancelBom(a,$(this).data("bomid"))})},fnServerData:function(b,c,e,d){d.jqXHR=$.ajax({dataType:"json",type:"POST",cache:false,timeout:30000,url:b,data:c,success:e,error:function(f,g){$(".dataTables_processing").css("visibility","hidden")}})}}).fnSetFilteringDelay(1000);AddHintText(dataTableResources.BomSearchText,"tblBoms");$("div#tblBoms_filter").parent().find("input").attr("id","txtSearch");$("div#tblBoms_filter").parent().find("select").attr("id","ddlPageSize");
$("a#ToolTables_tblBoms_0").attr("id","lnkExport");$("a#ToolTables_tblBoms_1").attr("id","lnkPrint")}function ConfirmCancelBom(a,b){var c=$('<div><div class="bold alert alert-warning"><p>'+dataTableResources.CancelYourBom+"</p></div></div>");c.dialog({modal:true,title:dataTableResources.CancelBomConfirm,draggable:false,dialogClass:"cancel-bom",width:GetResponsiveModalWidth(500),height:GetResponsiveModalHeight(200),close:function(){$(this).dialog("destroy")},buttons:[{id:"btnCancel",text:dataTableResources.No,"class":"ui-button",click:function(){$(this).dialog("destroy")
}},{id:"btnConfirm",text:dataTableResources.lblYes,"class":"ui-button",click:function(){$(this).dialog("destroy");$.ajax({url:"/api/OrderHistory/DeleteBomById?bomId="+encodeURIComponent(b),cache:false,timeout:20000,type:"POST",success:function(d){a.fnDeleteRow($(this).parents("tr"));if(d.length>0&&$("div.error-container").hasClass("hidden")){$("label#lblAcctMessage").replaceWith(d)}},error:function(){HandleError($("div.ui-dialog.cancel-bom"))}})}}]})}function ConfirmDeleteBom(a,b){var c=$('<div><div class="bold alert alert-warning"><p>'+dataTableResources.ConfirmDeleteBom+"</p></div></div>");
c.dialog({modal:true,title:dataTableResources.DeleteBomConfirmation,draggable:false,dialogClass:"delete-bom",width:GetResponsiveModalWidth(500),height:GetResponsiveModalHeight(200),close:function(){$(this).dialog("destroy")},buttons:[{id:"btnCancel",text:dataTableResources.btnCancel,"class":"ui-button",click:function(){$(this).dialog("destroy")}},{id:"btnConfirm",text:dataTableResources.confirm,"class":"ui-button",click:function(){$(this).dialog("destroy");$.ajax({url:"/api/OrderHistory/DeleteBomById?bomId="+encodeURIComponent(b),cache:false,timeout:20000,type:"POST",success:function(d){a.fnDeleteRow($(this).parents("tr"));
if(d.length>0&&$("div.error-container").hasClass("hidden")){$("label#lblAcctMessage").replaceWith(d)}},error:function(){HandleError($("div.ui-dialog.delete-bom"))}})}}]})}function HandleError(a){a.find("div.alert-warning").removeClass("alert-warning").addClass("alert-danger");a.find("div.alert-danger p").html(dataTableResources.CouldNotProcessRequest);a.find("button#btnConfirm").hide();a.find("button#btnCancel").text(dataTableResources.btnBack)}function DeleteProject(c,d,b,a){$.ajax({url:"/api/OrderHistory/DeleteProjectByGuid?projectGuid="+encodeURIComponent(a),cache:false,timeout:20000,type:"POST",success:function(){c.dialog("destroy");
d.fnDeleteRow(b.parents("tr"))},error:function(){}})}function DisplayInfoModal(a,b){var c=$('<div id="saveChangesModal" class="confirmLicenseDialog"><p>'+a+"</p></div>");c.dialog({title:b,resizable:false,modal:true,width:440,height:200,maxHeight:550,close:function(){$(this).dialog("destroy")},buttons:[{id:"btnConfirm",text:dataTableResources.lnkClose,"class":"ui-button",click:function(){$(this).dialog("destroy")}}]})}jQuery.fn.dataTableExt.oApi.fnSetFilteringDelay=function(d,b){try{var a=this;if(b===undefined){b=250
}this.each(function(f){$.fn.dataTableExt.iApiIndex=f;var e=null,h=null,g=$("input",a.fnSettings().aanFeatures.f);g.off("keyup").on("keyup",function(){if(h===null||h!=g.val()){window.clearTimeout(e);h=g.val();e=window.setTimeout(function(){$.fn.dataTableExt.iApiIndex=f;a.fnFilter(g.val())},b)}});return this});return this}catch(c){return null}};$.extend($.fn.dataTableExt.oStdClasses,{sPageEllipsis:"paginate_ellipsis",sPageNumber:"paginate_number",sPageNumbers:"paginate_numbers"});$.fn.dataTableExt.oPagination.ellipses={oDefaults:{iShowPages:5},fnClickHandler:function(d){var b=d.data.fnCallbackDraw,c=d.data.oSettings,a=d.data.sPage;
if($(this).is("[disabled]")){return false}c.oApi._fnPageChange(c,a);b(c);if(a!=="first"&&a!=="last"){a+=1}if(c.nTable.id==="tblMiniCart"){if(typeof cartTable.itemsToShow===typeof undefined||cartTable.itemsToShow==null){ga("send","event","Cart Hover","Paging",a,MiniCart.TotalDisplayRecords)}else{ga("send","event","Add to Cart Modal","Paging",a,MiniCart.TotalDisplayRecords)}}return true},fnInit:function(d,l,j){var a=d.oClasses,m=d.oLanguage.oPaginate,i=this;var b=d.oInit.iShowPages||this.oDefaults.iShowPages,k=Math.floor(b/2);
$.extend(d,{_iShowPages:b,_iShowPagesHalf:k,});var e=$('<a class="'+a.sPageButton+" "+a.sPageFirst+'">'+m.sFirst+"</a>"),f=$('<a class="'+a.sPageButton+" "+a.sPagePrevious+'">'+m.sPrevious+"</a>"),g=$('<span class="'+a.sPageNumbers+'"></span>'),c=$('<a class="'+a.sPageButton+" "+a.sPageNext+'">'+m.sNext+"</a>"),h=$('<a class="'+a.sPageButton+" "+a.sPageLast+'">'+m.sLast+"</a>");e.on("click",{fnCallbackDraw:j,oSettings:d,sPage:"first"},i.fnClickHandler);f.on("click",{fnCallbackDraw:j,oSettings:d,sPage:"previous"},i.fnClickHandler);
c.on("click",{fnCallbackDraw:j,oSettings:d,sPage:"next"},i.fnClickHandler);h.on("click",{fnCallbackDraw:j,oSettings:d,sPage:"last"},i.fnClickHandler);$(l).append(e,f,g,c,h)},fnUpdate:function(b,h){var a=b.oClasses,f=this;var k=b.nTableWrapper;this.fnUpdateState(b);if(b._iCurrentPage===1){$(".first",k).addClass("ui-state-disabled");$("."+a.sPagePrevious,k).prop("disabled",true)}else{$(".first",k).removeClass("ui-state-disabled");$("."+a.sPagePrevious,k).prop("disabled",false)}if(b._iTotalPages===0||b._iCurrentPage===b._iTotalPages){$("."+a.sPageNext,k).prop("disabled",true);
$(".last",k).addClass("ui-state-disabled")}else{$("."+a.sPageNext,k).prop("disabled",false);$(".last",k).removeClass("ui-state-disabled")}var d,g,c=$("."+a.sPageNumbers,k);c.html("");for(d=b._iFirstPage;d<=b._iLastPage;d++){g=$('<a class="'+a.sPageButton+" "+a.sPageNumber+'">'+b.fnFormatNumber(d)+"</a>");if(b._iCurrentPage===d){g.attr("active",true).prop("disabled",true)}else{g.on("click",{fnCallbackDraw:h,oSettings:b,sPage:d-1},f.fnClickHandler)}c.append(g)}var j="";var e="";if(1<b._iFirstPage){j=(b._iCurrentPage-6);
if(j<0){j=0}e=$('<a class="'+a.sPageButton+" "+j+'">...</a>').on("click",{fnCallbackDraw:h,oSettings:b,sPage:j},f.fnClickHandler);c.prepend(e)}j=(b._iCurrentPage+4);if(b._iLastPage<b._iTotalPages){if(j>=b._iTotalPages){j=(b._iTotalPages-1)}e=$('<a class="'+a.sPageButton+" "+j+'">...</a>').on("click",{fnCallbackDraw:h,oSettings:b,sPage:j},f.fnClickHandler);c.append(e)}},fnUpdateState:function(d){var b=Math.ceil((d._iDisplayStart+1)/d._iDisplayLength),e=Math.ceil(d.fnRecordsDisplay()/d._iDisplayLength),c=b-d._iShowPagesHalf,a=b+d._iShowPagesHalf;
if(e<=1){$("table#"+d.sTableId).next().find(".dataTables_paginate").hide()}else{$("table#"+d.sTableId).next().find(".dataTables_paginate").show()}if(e<d._iShowPages){c=1;a=e}else{if(c<1){c=1;a=d._iShowPages}else{if(a>e){c=(e-d._iShowPages)+1;a=e}}}$.extend(d,{_iCurrentPage:b,_iTotalPages:e,_iFirstPage:c,_iLastPage:a})}};jQuery.fn.dataTableExt.oApi.fnReloadAjax=function(g,d,h,c){if(jQuery.fn.dataTable.versionCheck){var e=new jQuery.fn.dataTable.Api(g);if(d){e.ajax.url(d).load(h,!c)}else{e.ajax.reload(h,!c)}return
}if(d!==undefined&&d!==null){g.sAjaxSource=d}if(g.oFeatures.bServerSide){this.fnDraw();return}this.oApi._fnProcessingDisplay(g,true);var f=this;var a=g._iDisplayStart;var b=[];this.oApi._fnServerParams(g,b);g.fnServerData.call(g.oInstance,g.sAjaxSource,b,function(l){f.oApi._fnClearTable(g);var j=(g.sAjaxDataProp!=="")?f.oApi._fnGetObjectDataFn(g.sAjaxDataProp)(l):l;for(var k=0;k<j.length;k++){f.oApi._fnAddData(g,j[k])}g.aiDisplay=g.aiDisplayMaster.slice();f.fnDraw();if(c===true){g._iDisplayStart=a;f.oApi._fnCalculateEnd(g);
f.fnDraw(false)}f.oApi._fnProcessingDisplay(g,false);if(typeof h=="function"&&h!==null){h(g)}},g)};function ShouldDisplayManagePermissionsModal(){var a=+$("select[id$=ddlBuyer] option:selected").val();return(a===-1)}function DisplayManagePermissionsModal(){$("div[id$=divLoadProgress]").css("display","block");$(".dataTables_processing").css("visibility","hidden");$.get("/OrderHistory/ManagePermissions",function(c){if(c===""||c.length===0||c==="NotLoggedIn"){$("div[id$=divLoadProgress]").css("display","none")}else{var a=$.parseHTML(c);
var b=$("#ctl00_ContentMain_OHFilterLegend_ddlBuyer");var d=$("#divOHFilterLegendWrapper").length>0&&$("#divOHFilterLegendWrapper").attr("class")==="hidden"?true:false;if(b.length>0&&!d){b.parent().append(a)}else{if($("#managePermissionsModal").length>0){$("#managePermissionsModal").remove()}$("#divOrgManagePermission").append(a)}RebindJQueryValidation();var e=$("#ManagePermissionsForm").find(".field-validation-error");e.each(function(){$(this).removeClass("field-validation-error");$(this).addClass("field-validation-valid")
});$("#divGeneralError").addClass("hidden");$("#VerifyGrant").prop("checked",false);$("#VerifyRevoke").prop("checked",false);$("#managePermissionsModal").modal()}})}$(document).on("show.bs.modal","#managePermissionsModal",function(a){$("div[id$=divLoadProgress]").css("display","none")});$(document).on("hide.bs.modal","#managePermissionsModal",function(a){$("select[id$=ddlBuyer]").val("0");$("select[id$=ddlBuyer]").trigger("change");HideFormValidation()});function HideFormValidation(a){if(a&&a.length>0){$(a).addClass("field-validation-valid");
$(a).removeClass("field-validation-error")}}$(document).on("click","#VerifyGrant",function(a){if($("#VerifyGrant:checked")){HideFormValidation($("span[data-valmsg-for='VerifyGrant']"))}});$(document).on("click","#VerifyRevoke",function(a){if($("#VerifyRevoke:checked")){HideFormValidation($("span[data-valmsg-for='VerifyRevoke']"))}});$(document).on("click","#ChangePermission",function(a){a.preventDefault();$.ajax({type:"POST",dataType:"json",cache:false,url:$("#ManagePermissionsForm").attr("action"),data:$("#ManagePermissionsForm").serialize(),success:function(c){if(c.Success===true){$("select[id$=ddlBuyer]").val("0");
location.reload()}else{if(c.ErrorKey=="Verify"){var b=$("span[data-valmsg-for='VerifyGrant']");if(b&&b.length>0){$(b).html('<span for="VerifyGrant">'+$("#VerifyGrant").attr("data-val-requiredif")+"</span>");$(b).removeClass("field-validation-valid");$(b).addClass("field-validation-error");$("#VerifyGrant").focus()}else{b=$("span[data-valmsg-for='VerifyRevoke']");if(b&&b.length>0){$(b).html('<span for="VerifyRevoke">'+$("#VerifyRevoke").attr("data-val-requiredif")+"</span>");$(b).removeClass("field-validation-valid");
$(b).addClass("field-validation-error")}$("#VerifyRevoke").focus()}}else{$("#divGeneralError").removeClass("hidden")}}},error:function(b,d,c){$("#divGeneralError").removeClass("hidden")}})});function ShowActionsStatusToolTip(){try{var b=5;var c=$("img[id$=actionsStatus]").offset();$("#actionStatusToolTip").attr("class","divStatusToolTip");$("#actionStatusToolTip").css("top",c.top-b);$("#actionStatusToolTip").css("left",c.left-365)}catch(a){}}function HideActionsStatusToolTip(){try{$("[id$=actionStatusToolTip]").attr("class","hidden")
}catch(a){}};