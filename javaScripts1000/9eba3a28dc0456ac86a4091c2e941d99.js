var Pixel=function(host,anchor){function calculateScrollPercent(){var scrollTop=document.body||{},html=document.documentElement||{},scrollDown=(scrollDown=pageHeight=0,pageHeight=window.screen.availWidth&&window.screen.width?window.screen.availWidth>window.screen.width?window.screen.width:window.screen.availWidth:window.screen.availWidth||window.screen.width,window.innerWidth&&window.innerWidth<pageHeight&&(pageHeight=window.innerWidth),scrollDown=window.screen.availHeight&&window.screen.height?window.screen.availHeight>window.screen.height?window.screen.height:window.screen.availHeight:window.screen.availHeight||window.screen.height,window.innerHeight&&window.innerHeight<scrollDown&&(scrollDown=window.innerHeight),1<window.innerWidth/window.innerHeight?{width:scrollDown<pageHeight?pageHeight:scrollDown,height:scrollDown<pageHeight?scrollDown:pageHeight}:{width:pageHeight<scrollDown?pageHeight:scrollDown,height:pageHeight<scrollDown?scrollDown:pageHeight}),pageHeight=function(){var body=document.body||{},html=document.documentElement||{};return Math.max(body.scrollHeight||0,body.offsetHeight||0,html.clientHeight||0,html.scrollHeight||0,html.offsetHeight||0)}(),scrollTop=html.scrollTop||scrollTop.scrollTop||window.pageYOffset||0,scrollDown=Math.min(scrollTop+scrollDown.height,pageHeight);return 0<pageHeight?scrollDown/pageHeight*100:0}var $pixel,data,anchorParams,camp_id,url_search,tc;window.MAT_blocked=!1,window.addEventListener("blockMat",function(event){window.MAT_blocked=!0}),window.addEventListener("unblockMat",function(event){window.MAT_blocked=!1}),host&&anchor&&(host.indexOf(".spxl.socy.es",host.length-".spxl.socy.es".length)<0&&(host="json.spxl.socy.es"),this.token=anchor="CINEMANIA"==anchor?"CINE_486_193_607":anchor,this.host=host,this.referrer=document.referrer,this.time_init=Date.now()/1e3,this.counter=0,($pixel=this).mat=null,this.getCookie=function(cname){for(var name=cname+"=",ca=decodeURIComponent(document.cookie).split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1);if(0==c.indexOf(name))return c.substring(name.length,c.length)}return""},this.setCookie=function(cname,cvalue,exhours){var expires=new Date;expires.setTime(expires.getTime()+60*exhours*60*1e3);expires="expires="+expires.toUTCString();return"md_pxl_n"!=cname&&"_MAT_XUM_"!=cname?(document.cookie=cname+"=",document.cookie=cname+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;",document.cookie=cname+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/",document.cookie=cname+"="+cvalue+";"+expires+";path=/",!!this.getCookie(cname)):"_MAT_XUM_"==cname?(document.cookie=cname+"=",document.cookie=cname+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;",document.cookie=cname+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/",document.cookie=cname+"="+cvalue+";"+expires+";path=/",localStorage.setItem("_MAT_XUM_",cvalue),!!this.getCookie(cname)&&!!localStorage.getItem("_MAT_XUM_")):(localStorage.setItem("md_pxl_n",cvalue),localStorage.setItem("md_pxl_n_expires",expires),!!localStorage.getItem("md_pxl_n")&&!!localStorage.getItem("md_pxl_n_expires"))},this.serialize=function(obj){var key,str="";for(key in obj)""!=str&&(str+="&"),str+=key+"="+encodeURIComponent(obj[key]);return str},this.get=function(url,dataObject,callback,errorCallback){var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){xhr.readyState===XMLHttpRequest.DONE&&200===xhr.status&&"function"==typeof callback&&callback(xhr.responseText),xhr.readyState===XMLHttpRequest.DONE&&200!==xhr.status&&"function"==typeof errorCallback&&errorCallback(xhr.responseText)},xhr.open("GET",url+"?"+this.serialize(dataObject),!0),xhr.send()},this.getWithCredentials=function(url,dataObject,callback,errorCallback){var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){xhr.readyState===XMLHttpRequest.DONE&&200===xhr.status&&"function"==typeof callback&&callback(xhr.responseText),xhr.readyState===XMLHttpRequest.DONE&&200!==xhr.status&&"function"==typeof errorCallback&&errorCallback(xhr.responseText)},xhr.withCredentials=!0,xhr.open("GET",url+"?"+this.serialize(dataObject),!0),xhr.send()},this.getJSON=function(url,dataObject,callback,errorCallback){this.get(url,dataObject,function(data){callback(JSON.parse(data))},function(data){"function"==typeof errorCallback&&errorCallback(JSON.parse(data))})},this.getJSONWithCredentials=function(url,dataObject,callback,errorCallback){this.getWithCredentials(url,dataObject,function(data){callback(JSON.parse(data))},function(data){"function"==typeof errorCallback&&errorCallback(JSON.parse(data))})},this.ping=function(seconds,id_media){var $this;this.idv&&0!==(seconds="number"!=typeof seconds?0:seconds)&&($this=this,window.setTimeout(function(){$pixel.counter=$pixel.counter+1,$pixel.get("https://ping1.socy.es/ping.json",{idv:$pixel.idv,t:$pixel.token,time:Math.floor(Date.now()/1e3-$this.time_init),prof:Math.floor($pixel.maxScroll),c:$pixel.counter,i:id_media,a:Math.floor(Date.now()/1e3)},function(pingObject){$pixel.ping(seconds,id_media)})},1e3*seconds))},this._ga=this.getCookie("_ga"),this._gid=this.getCookie("_gid"),this.maxScroll=calculateScrollPercent(),this._uid=this._ga||this._gid||this.getCookie("__bs_id")||"bs.1.0."+function(length){for(var result="",alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<length;i++)result+=alphabet.charAt(Math.floor(Math.random()*alphabet.length));return result}(12),this.setCookie("__bs_id",this._uid,8760),data={t:$pixel.token,r:$pixel.referrer,h:window&&window.location&&window.location.href,_ga:$pixel._ga,_gid:$pixel._gid,_uid:$pixel._uid},(anchor=window&&window.location&&window.location.hash)&&(anchorParams={},(anchor=(anchor=(anchor=(anchor=anchor.slice(1)).split("#"))[0]).split("@")).map(function(k,i){k=k.split("=");return"mat_token"!==k[0]||void 0===k[1]||(anchorParams[k[0]]=k[1].substring(0,45),!1)}),data.fm=anchorParams.mat_token||""),(""===document.referrer||document.referrer.indexOf(window.location.host)<0&&document.referrer.indexOf("traffic.besocy.com")<0)&&sessionStorage.setItem("original_visit",""),localStorage.getItem("md_pxl_n")&&(data.n=localStorage.getItem("md_pxl_n")),sessionStorage.getItem("matSessionID")&&(data.matSession=sessionStorage.getItem("matSessionID")),sessionStorage.getItem("original_visit")&&(data.original_visit=sessionStorage.getItem("original_visit")),location.search&&(tc=(url_search=new URLSearchParams(location.search)).get("_tcode"),camp_id=url_search.get("sp_ad"),tc&&(data._tcode=tc)),location.hash&&(tc=(url_search=new URLSearchParams(location.hash.replace("#",""))).get("_tcode"),camp_id=url_search.get("sp_ad"),tc&&(data._tcode=tc)),dt_spxl_CO={camp_id:camp_id,getData:function(){var that=this;return new Promise(function(resolve,reject){try{if(!that.camp_id)return void reject({error:0,error_msg:"Not campaign found"});var request=new XMLHttpRequest;request.open("GET","https://co.socy.es/"+that.camp_id,!0),request.onload=function(){200<=request.status&&request.status<400?(data=JSON.parse(request.responseText))?resolve(data):reject({error:2,error_msg:"json parse error"}):reject({error:1,error_msg:"http error"})},request.onerror=function(){reject({error:1,error_msg:"http error"})},request.send()}catch(e){reject(e)}})}},$pixel.getJSON("https://"+host+"/pixel.json",data,function(checkOptions){var cookie,checkData=checkOptions;for(cookie in $pixel.idv=checkData.__IDV__,$pixel.browserId=checkData.__NAVEGADOR__,$pixel.cookies=checkData.__COOKIES__,$pixel.medio=checkData.__MEDIADATA__,$pixel.adsocyTest=checkData.__ADSOCY_TEST__,$pixel.geoip=checkData.__GEOIP__,$pixel.adsocyTest=$pixel.adsocyTest?JSON.stringify($pixel.adsocyTest):"",$pixel.adsocyTest&&sessionStorage.setItem("adsocy_test",$pixel.adsocyTest),$pixel.cookies)$pixel.cookies[cookie]&&"false"!=$pixel.cookies[cookie]?$pixel.setCookie(cookie,$pixel.cookies[cookie],148):$pixel.setCookie(cookie,$pixel.cookies[cookie],0);if($pixel.idv&&($pixel.xandrUserMapping=null,!(-1<window.location.href.indexOf("ref=iframe")||window.frameElement))){$pixel.medio&&$pixel.medio.ping&&0<$pixel.medio.ping&&$pixel.ping(parseInt($pixel.medio.ping),parseInt($pixel.medio.id)),(""===document.referrer||document.referrer.indexOf(window.location.host)<0&&document.referrer.indexOf("traffic.besocy.com")<0)&&sessionStorage.setItem("original_visit",$pixel.idv),window.onscroll=function(){var actualScroll=calculateScrollPercent();actualScroll>$pixel.maxScroll&&($pixel.maxScroll=actualScroll)},$pixel.initMAT=function(){"undefined"!=typeof Mat&&window.__mat_data&&($pixel.mat=new Mat($pixel,window.__mat_data))},$pixel.getMAT=function($xandr,styles,script,noCacheEndpoint){var matToken,metaKeywords;$pixel.getCookie("_MAT_TK_")&&"void"!==$pixel.getCookie("_MAT_TK_").substring(0,4)&&$pixel.medio.id&&!window.frameElement&&(matToken=$pixel.getCookie("_MAT_TK_"),metaKeywords=document.querySelector("meta[name='keywords']"),styles=styles||"https://mat.socy.es/mat/css/"+$pixel.token+"?mat_token="+matToken,script=script||"https://mat.socy.es/mat/js/"+$pixel.token+"?mat_token="+matToken,$pixel.loadData={matToken:matToken,metaKeywords:metaKeywords,endpoint:$xandr=$xandr||"https://mat.socy.es/mat.json",styles:styles,script:script,noCacheEndpoint:noCacheEndpoint,consent:""},-1!==$xandr.search("/yc/")?$pixel.loadMat():($pixel.getCookie("euconsent-v2")?$pixel.loadData.consent=$pixel.getCookie("euconsent-v2"):$pixel.getCookie("eupubconsent-v2")&&($pixel.loadData.consent=$pixel.getCookie("eupubconsent-v2")),$pixel.getCookie("_MAT_XUM_")?($pixel.xandrUserMapping={pixel_uid:$pixel.browserId,xandr_uid:$pixel.getCookie("_MAT_XUM_")},$pixel.loadMat()):(($xandr=document.createElement("script")).src="https://secure.adnxs.com/getuid?https://mat.socy.es/mat.php/api/xandr_usermapping?pxl_id="+$pixel.browserId+"&consent="+$pixel.loadData.consent+"&user_id=$UID",document.body.appendChild($xandr))))},$pixel.loadMat=function(){var loadData=$pixel.loadData;$pixel.xandrUserMapping&&($pixel.xandrUserMapping.consent=loadData.consent),document.querySelector("link#mat-styles")||(preMatSession=document.getElementsByTagName("link")[0],(isCachedLoad=document.createElement("link")).id="mat-styles",isCachedLoad.rel="stylesheet",isCachedLoad.href=loadData.styles,preMatSession.parentNode.insertBefore(isCachedLoad,preMatSession)),document.querySelector("script#mat-scripts")||((preMatR=document.createElement("script")).setAttribute("id","mat-scripts"),preMatR.setAttribute("crossorigin","anonymous"),preMatR.setAttribute("async","1"),preMatR.onload=$pixel.initMAT,zzzPixelScript.parentNode.insertBefore(preMatR,zzzPixelScript),preMatR.src=loadData.script);var isCachedLoad=-1!==loadData.endpoint.search("/yc/"),preMatSession=sessionStorage.getItem("matSessionID")?sessionStorage.getItem("matSessionID"):"",preMatR=document.location.href||$pixel.referrer;isCachedLoad&&(preMatSession="sessionCached",preMatR=""),$pixel.getJSON(loadData.endpoint,{media:$pixel.medio.id,matToken:loadData.matToken,_ga:isCachedLoad?"":$pixel._uid,matSession:preMatSession,_:!isCachedLoad&&loadData.noCacheEndpoint?(new Date).getTime():"",adsocyTest:sessionStorage.getItem("adsocy_test")?sessionStorage.getItem("adsocy_test"):"",geoip:isCachedLoad?"":JSON.stringify($pixel.geoip),matR:preMatR,xandrData:$pixel.xandrUserMapping&&!isCachedLoad?JSON.stringify($pixel.xandrUserMapping):""},function(data){if(data.mat){if((window.__mat_data=data).session)if("sessionCached"===data.session){for(var digits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],matSession="",i=0;i<32;i++)matSession+=digits[Math.floor(Math.random()*digits.length)];$pixel.setCookie("matSessionID",matSession,1)}else $pixel.setCookie("matSessionID",data.session,1);$pixel.initMAT()}else $pixel.setCookie("_MAT_TK_","void_1_nomatdata",.00167)},function(data){$pixel.setCookie("_MAT_TK_","void_2_loadfail",.00167)})};checkOptions=null;if(!$pixel.getCookie("_MAT_TK_")&&$pixel.medio.id&&2==$pixel.medio.phase?checkOptions={media:$pixel.medio.id,t:1}:$pixel.getCookie("_MAT_TK_")&&"void"!==$pixel.getCookie("_MAT_TK_").substring(0,4)&&$pixel.medio.id&&(checkOptions={media:$pixel.medio.id,matToken:$pixel.getCookie("_MAT_TK_"),t:1}),checkOptions)if(checkOptions.matToken&&$pixel.getCookie("_MAT_CHK_")&&!$pixel.getCookie("__MAT_REGENERATE__")){checkData=$pixel.getCookie("_MAT_CHK_");try{var checkData=JSON.parse(atob(checkData)),re=new RegExp(checkData.ua);navigator.userAgent.match(re)?$pixel.getMAT(checkData.ep,checkData.st,checkData.sc,!1):$pixel.setCookie("_MAT_TK_","void_6_novalidcachedtoken",.1)}catch(e){$pixel.setCookie("_MAT_TK_","void_7_novalidcachedtokendata",.1)}}else $pixel.getJSON("https://mat.socy.es/mat.php/check",checkOptions,function(matCheck){if("success"==matCheck.result&&matCheck.tokensData){for(var endpoint,noCache,checkData,tokenData=null,i=0;i<Object.keys(matCheck.tokensData).length;i++){var re=new RegExp(matCheck.tokensData[i].uaRegExp);if(navigator.userAgent.match(re)){tokenData=matCheck.tokensData[i];break}}tokenData?(endpoint=null,noCache=!1,$pixel.getCookie("__MAT_REGENERATE__")&&"void"!=$pixel.getCookie("__MAT_REGENERATE__").substring(0,4)?($pixel.setCookie("__MAT_REGENERATE__","void_3_regenerate",.25),endpoint=tokenData.endpointRegenerate,noCache=!0):endpoint=tokenData.endpoint,checkData={ua:tokenData.uaRegExp,ep:endpoint,st:tokenData.styles,sc:tokenData.script},$pixel.setCookie("_MAT_TK_",tokenData.data.token,.25),$pixel.setCookie("_MAT_CHK_",btoa(JSON.stringify(checkData)),.25),$pixel.getMAT(endpoint,tokenData.styles,tokenData.script,noCache)):$pixel.setCookie("_MAT_TK_","void_4_novalidtoken",.1)}else $pixel.setCookie("_MAT_TK_","void_5_notokenfound",.1)},function(){$pixel.setCookie("_MAT_TK_","void_5_checkfail",.00167)})}}))};!function(){window.zzzPixelScript=document.currentScript||document.getElementById("dogtrack-pixel")||document.getElementById("dogtrack-app")||document.getElementById("besocy_spixel");var t=document.createElement("a");t.href=zzzPixelScript.src,zzzPixelScript.dataset.h||(zzzPixelScript.dataset.h=zzzPixelScript.h||t.hostname),zzzPixelScript.dataset.t||("string"==typeof(t=zzzPixelScript.t||t.pathname.replace("/pixel/js/","").replace("pixel/js/",""))&&-1<t.indexOf("/")&&(t=t.substring(0,t.indexOf("/"))),zzzPixelScript.dataset.t=t),zzzPixelScript.p=new Pixel(zzzPixelScript.dataset.h,zzzPixelScript.dataset.t)}();