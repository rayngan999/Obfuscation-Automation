var Hashtable=(function(x){var h="function",n="string",o="undefined";if(typeof encodeURIComponent==o||Array.prototype.splice===x||Object.prototype.hasOwnProperty===x){return null}function a(y){return(typeof y==n)?y:""+y}function g(z){var y;if(typeof z==n){return z}else{if(typeof z.hashCode==h){y=z.hashCode();return(typeof y==n)?y:g(y)}else{return a(z)}}}function f(A,z){for(var y in z){if(z.hasOwnProperty(y)){A[y]=z[y]}}}function v(y,z){return y.equals(z)}function c(y,z){return(typeof z.equals==h)?z.equals(y):(y===z)}function e(y){return function(z){if(z===null){throw new Error("null is not a valid "+y)}else{if(z===x){throw new Error(y+" must not be undefined")}}}}var j=e("key"),d=e("value");function m(B,z,A,y){this[0]=B;this.entries=[];this.addEntry(z,A);if(y!==null){this.getEqualityFunction=function(){return y}}}var b=0,q=1,k=2;function u(y){return function(A){var z=this.entries.length,C,B=this.getEqualityFunction(A);while(z--){C=this.entries[z];if(B(A,C[0])){switch(y){case b:return true;case q:return C;case k:return[z,C[1]]}}}return false}}function w(y){return function(C){var D=C.length;for(var B=0,A=this.entries,z=A.length;B<z;++B){C[D+B]=A[B][y]}}}m.prototype={getEqualityFunction:function(y){return(typeof y.equals==h)?v:c},getEntryForKey:u(q),getEntryAndIndexForKey:u(k),removeEntryForKey:function(z){var y=this.getEntryAndIndexForKey(z);if(y){this.entries.splice(y[0],1);return y[1]}return null},addEntry:function(y,z){this.entries.push([y,z])},keys:w(0),values:w(1),getEntries:function(B){var C=B.length;for(var A=0,z=this.entries,y=z.length;A<y;++A){B[C+A]=z[A].slice(0)}},containsKey:u(b),containsValue:function(A){var y=this.entries,z=y.length;while(z--){if(A===y[z][1]){return true}}return false}};function s(z,A){var y=z.length,B;while(y--){B=z[y];if(A===B[0]){return y}}return null}function l(y,z){var A=y[z];return(A&&(A instanceof m))?A:null}function r(){var D=[];var C={};var B={replaceDuplicateKey:true,hashCode:g,equals:null};var A=arguments[0],z=arguments[1];if(z!==x){B.hashCode=A;B.equals=z}else{if(A!==x){f(B,A)}}var y=B.hashCode,E=B.equals;this.properties=B;this.put=function(I,J){j(I);d(J);var K=y(I),L,H,G=null;L=l(C,K);if(L){H=L.getEntryForKey(I);if(H){if(B.replaceDuplicateKey){H[0]=I}G=H[1];H[1]=J}else{L.addEntry(I,J)}}else{L=new m(K,I,J,E);D.push(L);C[K]=L}return G};this.get=function(H){j(H);var I=y(H);var J=l(C,I);if(J){var G=J.getEntryForKey(H);if(G){return G[1]}}return null};this.containsKey=function(H){j(H);var G=y(H);var I=l(C,G);return I?I.containsKey(H):false};this.containsValue=function(H){d(H);var G=D.length;while(G--){if(D[G].containsValue(H)){return true}}return false};this.clear=function(){D.length=0;C={}};this.isEmpty=function(){return !D.length};var F=function(G){return function(){var H=[],I=D.length;while(I--){D[I][G](H)}return H}};this.keys=F("keys");this.values=F("values");this.entries=F("getEntries");this.remove=function(I){j(I);var J=y(I),G,H=null;var K=l(C,J);if(K){H=K.removeEntryForKey(I);if(H!==null){if(K.entries.length==0){G=s(D,J);D.splice(G,1);delete C[J]}}}return H};this.size=function(){var H=0,G=D.length;while(G--){H+=D[G].entries.length}return H}}r.prototype={each:function(B){var y=this.entries(),z=y.length,A;while(z--){A=y[z];B(A[0],A[1])}},equals:function(y){var B,z,C,A=this.size();if(A==y.size()){B=this.keys();while(A--){z=B[A];C=y.get(z);if(C===null||C!==this.get(z)){return false}}return true}return false},putAll:function(G,B){var A=G.entries();var D,E,C,y,z=A.length;var F=(typeof B==h);while(z--){D=A[z];E=D[0];C=D[1];if(F&&(y=this.get(E))){C=B(E,y,C)}this.put(E,C)}},clone:function(){var y=new r(this.properties);y.putAll(this);return y}};r.prototype.toQueryString=function(){var y=this.entries(),z=y.length,A;var B=[];while(z--){A=y[z];B[z]=encodeURIComponent(a(A[0]))+"="+encodeURIComponent(a(A[1]))}return B.join("&")};return r})();function startsWith(b,a){return(b.indexOf(a)===0)}function DomDataCollection(g){var d=this;d.config={recursion_level:1,collection_mode:"partial",functionsToExclude:[],function_list_size:1024,json_script:g?g:"json2.js"};d.emptyDomData=function(){d.dom_data={functions:{names:[],excluded:{size:0,count:0},truncated:false},inputs:[],iFrames:[],scripts:[],collection_status:DomDataCollection.NotStarted}};d.startInspection=function(){var h=false;var k=true;BrowserDetect.init();if(!(BrowserDetect.browser==="Explorer")){try{d.inspectJSFunctions();k=false}catch(j){h=h||true}}else{d.dom_data.functions=[];if(d.dom_data.functions===undefined||d.dom_data.functions.names===undefined){d.dom_data.functions={names:[],excluded:{size:0,count:0},truncated:false}}}try{d.inspectFrames();k=false}catch(j){h=h||true}try{d.inspectScripts();k=false}catch(j){h=h||true}try{d.inspectInputFields();k=false}catch(j){h=h||true}if(h){if(k){d.dom_data.collection_status=DomDataCollection.Fail}else{d.dom_data.collection_status=DomDataCollection.Partial}}else{d.dom_data.collection_status=DomDataCollection.Success}if(!(BrowserDetect.browser==="Explorer")){d.handleSizeLimit()}};d.domDataAsJSON=function(){return stripIllegalChars(JSON.stringify(d.dom_data))};d.recursiveGetAllFunctionNamesUnderElement=function(k,o,l){var j;var q;var m;var v=d.config;var h=v.recursion_level;var u=v.collection_mode;if(d.dom_data.functions===undefined||d.dom_data.functions.names===undefined){d.dom_data.functions={names:[],excluded:{size:0,count:0},truncated:false}}var n=d.dom_data.functions;var r=n.excluded;for(var z in o){try{var y=o[z];j=""+y;if(k.length>0){prefix=k+"."}else{prefix=""}q=prefix+z;if(c(y)){if(d.functionShouldBeCollected(y,z)){var w=n.names;m=w.length;w[m]=q}else{if(u=="partial"){r.size+=j.length;r.count++}}}if(l+1<h){d.recursiveGetAllFunctionNamesUnderElement(q,y,l+1)}else{n.names.sort()}}catch(s){if(!window.console){window.console={};window.console.info=f;window.console.log=f;window.console.warn=f;window.console.error=f}if(console&&console.log){console.log("error counting functions: "+s.toString())}}}};function f(){}function c(h){return typeof h=="function"}function e(h){return h.length}var b=new Hashtable();d.initFunctionsToExclude=function(){if(b){b.clear()}var j=d.config.functionsToExclude;var h=j.length;while(h--){b.put(j[h],"")}};d.functionShouldBeCollected=function a(j,h){if(d.config.collection_mode=="full"){return true}else{if(b.size()===0){d.initFunctionsToExclude()}if(b.containsKey(h)){return false}else{return true}}};d.inspectJSFunctions=function(){d.dom_data.functions=[];d.recursiveGetAllFunctionNamesUnderElement("",window,0)};d.handleSizeLimit=function(){var r=d.dom_data;var h=d.config;var u=h.function_list_size;var k=r.functions;k.names.sort();var o=JSON.stringify(r);if(u<0){u=0}var q=0;if(h.colllection_mode!="full"&&o.length>u){var m=k.names;var l=m.toString();var n=o.length-JSON.stringify(m).length+"[]".length;var j=false;var s=m.length;while(!j){if(q++==1000){j=true}lastComma=l.lastIndexOf(",");if(lastComma>=0&&s>0){quotation_marks=s*2;if(n+lastComma+quotation_marks>u){l=l.substring(0,lastComma-1);s--}else{j=true}}else{j=true}}if(s>1){k.truncated=true;k.names=k.names.slice(0,s-1);r.functions.truncated=true}else{d.emptyDomData();r=d.dom_data;r.collection_status=DomDataCollection.Partial;r.functions.truncated=true}}};d.inspectFrames=function(){d.countElements("iframe")};d.countElements=function(k){var l;var m=document.getElementsByTagName(k);if(d.dom_data.iFrames===undefined){d.dom_data.iFrames=[]}var h=d.dom_data.iFrames;var j=h.length;for(i=0;i<m.length;i++){h[j+i]=""+m[i].src}h.sort()};d.inspectScripts=function(){var h=document.getElementsByTagName("script");d.dom_data.scripts=[];for(var j=0;j<h.length;j++){d.dom_data.scripts[j]=h[j].text.length}};d.collectFields=function(h){var l=document.getElementsByTagName(h);if(d.dom_data.inputs===undefined){d.dom_data.inputs=[]}var n=d.dom_data.inputs;var k=n.length;var j=l.length;while(j--){var q=l[j];var o=q.name;var m=q.id;if(o&&o.length>0){element_name=o}else{if(m&&m.length>0){element_name=m}else{element_name="NO_NAME"}}n[k+j]=element_name}n.sort()};d.inspectInputFields=function(){d.collectFields("input");d.collectFields("textarea");d.collectFields("select");d.collectFields("button")};loadJSON=function(){if(!window.JSON){var j=document.getElementsByTagName("head")[0];var h=document.createElement("script");h.type="text/javascript";h.src=d.config.json_script;j.appendChild(h)}};d.emptyDomData();loadJSON()}DomDataCollection.Success=0;DomDataCollection.Fail=1;DomDataCollection.Partial=2;DomDataCollection.NotStarted=3;function IE_FingerPrint(){this.deviceprint_browser=function(){var c=navigator.userAgent.toLowerCase();t=c+SEP+navigator.appVersion+SEP+navigator.platform;t+=SEP+navigator.appMinorVersion+SEP+navigator.cpuClass+SEP+navigator.browserLanguage;t+=SEP+ScriptEngineBuildVersion();return t};this.deviceprint_software=function(){var d="";var f=true;try{document.body.addBehavior("#default#clientCaps");var g;var c=a.length;for(i=0;i<c;i++){g=activeXDetect(a[i]);var h=b[i];if(g){if(f===true){d+=h+PAIR+g;f=false}else{d+=SEP+h+PAIR+g}}else{d+="";f=false}}}catch(e){}return d};var b=["abk","wnt","aol","arb","chs","cht","dht","dhj","dan","dsh","heb","ie5","icw","ibe","iec","ieh","iee","jap","krn","lan","swf","shw","msn","wmp","obp","oex","net","pan","thi","tks","uni","vtc","vnm","mvm","vbs","wfd"];var a=["7790769C-0471-11D2-AF11-00C04FA35D02","89820200-ECBD-11CF-8B85-00AA005B4340","47F67D00-9E55-11D1-BAEF-00C04FC2D130","76C19B38-F0C8-11CF-87CC-0020AFEECF20","76C19B34-F0C8-11CF-87CC-0020AFEECF20","76C19B33-F0C8-11CF-87CC-0020AFEECF20","9381D8F2-0288-11D0-9501-00AA00B911A5","4F216970-C90C-11D1-B5C7-0000F8051515","283807B5-2C60-11D0-A31D-00AA00B92C03","44BBA848-CC51-11CF-AAFA-00AA00B6015C","76C19B36-F0C8-11CF-87CC-0020AFEECF20","89820200-ECBD-11CF-8B85-00AA005B4383","5A8D6EE0-3E18-11D0-821E-444553540000","630B1DA0-B465-11D1-9948-00C04F98BBC9","08B0E5C0-4FCB-11CF-AAA5-00401C608555","45EA75A0-A269-11D1-B5BF-0000F8051515","DE5AED00-A4BF-11D1-9948-00C04F98BBC9","76C19B30-F0C8-11CF-87CC-0020AFEECF20","76C19B31-F0C8-11CF-87CC-0020AFEECF20","76C19B50-F0C8-11CF-87CC-0020AFEECF20","D27CDB6E-AE6D-11CF-96B8-444553540000","2A202491-F00D-11CF-87CC-0020AFEECF20","5945C046-LE7D-LLDL-BC44-00C04FD912BE","22D6F312-B0F6-11D0-94AB-0080C74C7E95","3AF36230-A269-11D1-B5BF-0000F8051515","44BBA840-CC51-11CF-AAFA-00AA00B6015C","44BBA842-CC51-11CF-AAFA-00AA00B6015B","76C19B32-F0C8-11CF-87CC-0020AFEECF20","76C19B35-F0C8-11CF-87CC-0020AFEECF20","CC2A9BA0-3BDD-11D0-821E-444553540000","3BF42070-B3B1-11D1-B5C5-0000F8051515","10072CEC-8CC1-11D1-986E-00A0C955B42F","76C19B37-F0C8-11CF-87CC-0020AFEECF20","08B0E5C0-4FCB-11CF-AAA5-00401C608500","4F645220-306D-11D2-995D-00C04F98BBC9","73FA19D0-2D75-11D2-995D-00C04F98BBC9"]}IE_FingerPrint.prototype=new FingerPrint();function Mozilla_FingerPrint(){}Mozilla_FingerPrint.prototype=new FingerPrint();function Opera_FingerPrint(){}Opera_FingerPrint.prototype=new FingerPrint();function Timer(){this.startTime=new Date().getTime()}Timer.prototype.start=function(){this.startTime=new Date().getTime()};Timer.prototype.duration=function(){return(new Date().getTime())-this.startTime};function randrange(h,c){var e=c-h;if(e<=0){throw new Exception("max must be larger than min")}var a=Math.ceil(Math.log2(e)/8);var g=Math.pow(256,a);var d=new Uint8Array(a);while(true){window.crypto.getRandomValues(d);var b=0;for(var f=0;f<a;f++){b=(b<<8)+d[f]}if(b+e-(b%e)<g){return h+(b%e)}}}function detectIE(){var a=window.navigator.userAgent;var e=a.indexOf("MSIE ");if(e>0){return parseInt(a.substring(e+5,a.indexOf(".",e)),10)}var d=a.indexOf("Trident/");if(d>0){var c=a.indexOf("rv:");return parseInt(a.substring(c+3,a.indexOf(".",c)),10)}var b=a.indexOf("Edge/");if(b>0){return parseInt(a.substring(b+5,a.indexOf(".",b)),10)}return false}function genRandomNumber(b,f){var c=f-b;if(c<=0){throw new Exception("max must be larger than min")}var a=new Date();var d=a.getTime();f=f-b;var e=(d%f)+b;return e}function getRandomPort(){var a=detectIE();if(a==false){var b=randrange(4000,60000);return b}else{var b=genRandomNumber(4000,60000);return b}}var ProxyCollector={};ProxyCollector.internalIP="127.0.0.1";ProxyCollector.externalIP;ProxyCollector.internalPingTime;ProxyCollector.externalPingTime;ProxyCollector.setInternalPingTime=function(a){ProxyCollector.internalPingTime=a};ProxyCollector.setExternalPingTime=function(a){ProxyCollector.externalPingTime=a};ProxyCollector.PROXY_DETECTION_TIMEOUT=5000;ProxyCollector.TIMEOUT_CHECK_FREQUENCY=1000;ProxyCollector.isTimedOut=function(c,b,a){_timer=new Timer();if((b-_timer.duration()<=0)&&(((typeof ProxyCollector.internalPingTime==="undefined")&&((new RegExp("internalPingTime")).test(c)))||((typeof ProxyCollector.externalPingTime==="undefined")&&((new RegExp("externalPingTime")).test(c))))){c.call(this,-1);a.abort()}else{if(((typeof ProxyCollector.internalPingTime==="undefined")&&((new RegExp("internalPingTime")).test(c)))||((typeof ProxyCollector.externalPingTime==="undefined")&&((new RegExp("externalPingTime")).test(c)))){setTimeout(function(){ProxyCollector.isTimedOut(c,b-(_timer.duration()+ProxyCollector.TIMEOUT_CHECK_FREQUENCY),a)},ProxyCollector.TIMEOUT_CHECK_FREQUENCY)}}};ProxyCollector.doAjax=function(b,h){var a=document.location.protocol;if(a=="http:"||a=="https:"){var c=a+"//"+b+":"+getRandomPort()+"/NonExistentImage"+getRandomPort()+".gif"}else{h.call(this,-1);g.abort()}var g;var e;if(window.XDomainRequest){g=new window.XDomainRequest();e=new Timer();try{g.timeout=ProxyCollector.PROXY_DETECTION_TIMEOUT;g.ontimeout=function(){h.call(this,-1);g.abort()};g.onprogress=function(){h.call(this,e.duration());g.abort()};g.onerror=function(){h.call(this,e.duration());g.abort()};g.open("GET",c,true);g.send()}catch(d){ProxyCollector.doAjaxViaImage(h,c)}}else{g=new XMLHttpRequest();var f="ontimeout" in g;e=new Timer();try{g.onreadystatechange=function(){if(g.readyState==4){if(((typeof ProxyCollector.internalPingTime==="undefined")&&((new RegExp("internalPingTime")).test(h)))||((typeof ProxyCollector.externalPingTime==="undefined")&&((new RegExp("externalPingTime")).test(h)))){h.call(this,e.duration())}}};g.timeout=ProxyCollector.PROXY_DETECTION_TIMEOUT;g.ontimeout=function(){h.call(this,-1);g.abort()};g.open("GET",c,true);g.send();if(!f){ProxyCollector.isTimedOut(h,ProxyCollector.PROXY_DETECTION_TIMEOUT-e.duration(),g)}}catch(d){ProxyCollector.doAjaxViaImage(h,c)}}};ProxyCollector.doAjaxViaImage=function(b,d){var c=new Image();var a=new Timer();c.onerror=function(){b.call(this,a.duration())};c.src=d};ProxyCollector.collect=function(){ProxyCollector.doAjax(ProxyCollector.externalIP,ProxyCollector.setExternalPingTime);if(typeof XDomainRequest=="object"){if(!ProxyCollector.externalPingTime){forceIE89Synchronicity()}}else{ProxyCollector.doAjax(ProxyCollector.internalIP,ProxyCollector.setInternalPingTime)}};forceIE89Synchronicity=function(){if(!ProxyCollector.externalPingTime){setTimeout(forceIE89Synchronicity,100)}else{ProxyCollector.doAjax(ProxyCollector.internalIP,ProxyCollector.setInternalPingTime)}};ProxyCollector.isValidIPAddress=function(a){var d=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;if(d.test(a)){var b=a.split(".");if(parseInt(parseFloat(b[0]))==0){return false}for(var c=0;c<b.length;c++){if(parseInt(parseFloat(b[c]))>255){return false}}return true}else{return false}};ProxyCollector.initProxyCollection=function(){if(ProxyCollector.isValidIPAddress(ProxyCollector.externalIP)&&ProxyCollector.isValidIPAddress(ProxyCollector.internalIP)){ProxyCollector.collect()}};function BlackberryLocationCollector(){var a=this;var f=null;this.getGeolocationWatchId=function(){return f};var h=null;this.getGeolocationLastPosition=function(){return h};var e=4;this.getGeolocationStatusCode=function(){return e};var b="";this.getGeolocationErrorMessage=function(){return b};var c={aidMode:2,timeout:180,relevancy:120,expiration:48,alertDebug:false};var g=-1;var d=0;this.getInvokeCount=function(){return d};this.handleBlackBerryLocationTimeout=function(){if(g!=-1){a.stopWatch();e=3;if(d===0&&c.aidMode!==0){d++;a.startLocationWatch()}}};this.handlePosition=function(){clearTimeout(g);g=-1;var m=false;if(blackberry.location.latitude===0&&blackberry.location.longitude===0){if(c.alertDebug){alert("Got empty position")}if(h===null){e=2}}else{var k=null;if(blackberry.location.timestamp){k=getTimestampInMillis(blackberry.location.timestamp)}else{k=new Date().getTime()}var j=new Date().getTime();if((j-k)<=(c.expiration*60*60*1000)){if(h===null||k>h.timestamp){var l=h===null?0:h.timestamp;if(c.alertDebug){alert("Saved new position. New timestamp: "+k+" Old: "+l)}h={timestamp:k,coords:{latitude:blackberry.location.latitude,longitude:blackberry.location.longitude}};e=0}else{if(c.alertDebug){alert("New position is not saved. New timestamp: "+k+" Old: "+h.timestamp)}}}else{if(c.alertDebug){alert("New position is not saved. It is expired: "+((j-k)*1000*60*60)+" hours old")}}}if(h!==null){var j=new Date().getTime();m=(j-h.timestamp)<(c.relevancy*1000)}a.stopWatch();if(c.alertDebug){alert("Relevant position? "+m)}if((d===0&&c.aidMode!==0)||!m){d++;a.startLocationWatch()}};this.init=function(k,j,l,m){if(k>=0&&k<=2){c.aidMode=k}if(j!==null&&j>=90&&j<=300){c.timeout=j}if(l!==null&&l>=60&&l<=240){c.relevancy=l}if(m!==null&&m>=24&&m<=60){c.expiration=m}};this.startLocationWatch=function(){if(d===0){blackberry.location.setAidMode(0)}else{blackberry.location.setAidMode(c.aidMode)}var j=c.timeout*1000;g=setTimeout("geoLocator.handleBlackBerryLocationTimeout()",j);blackberry.location.onLocationUpdate(a.handlePosition);blackberry.location.refreshLocation();f=1;return true};this.stopWatch=function(){try{blackberry.location.removeLocationUpdate(a.handlePosition)}catch(j){}f=-2};this.generateGeolocationJSONStruct=function(){var j=null;if(h!==null){var k=convertTimestampToGMT(h.timestamp);j={GeoLocationInfo:[{Status:e,Longitude:h.coords.longitude,Latitude:h.coords.latitude,Timestamp:k}]}}else{j={GeoLocationInfo:[{Status:e}]}}return JSON.stringify(j)}}function detectFields(){var k="form";var d="input";var f=document.getElementsByTagName("form");var g=f.length;var e;var h;var b=[];b.push("url="+window.location.href);for(var a=0;a<g;a++){b.push(k+"="+f[a].name);e=f[a].getElementsByTagName("input");h=e.length;for(var l=0;l<h;l++){if(e[l].type!="hidden"){b.push(d+"="+e[l].name)}}}var c=b.join("|");return c}var SEP="|";var PAIR="=";var DEV="~";function FingerPrint(){var a="3.7.1_1";var b=new Hashtable();b.put("npnul32","def");b.put("npqtplugin6","qt6");b.put("npqtplugin5","qt5");b.put("npqtplugin4","qt4");b.put("npqtplugin3","qt3");b.put("npqtplugin2","qt2");b.put("npqtplugin","qt1");b.put("nppdf32","pdf");b.put("NPSWF32","swf");b.put("NPJava11","j11");b.put("NPJava12","j12");b.put("NPJava13","j13");b.put("NPJava32","j32");b.put("NPJava14","j14");b.put("npoji600","j61");b.put("NPJava131_16","j16");b.put("NPOFFICE","mso");b.put("npdsplay","wpm");b.put("npwmsdrm","drm");b.put("npdrmv2","drn");b.put("nprjplug","rjl");b.put("nppl3260","rpl");b.put("nprpjplug","rpv");b.put("npchime","chm");b.put("npCortona","cor");b.put("np32dsw","dsw");b.put("np32asw","asw");b.put("internal-pdf-viewer","pdf");b.put("mhjfbmdgcfjbbpaeojofohoefgiehjai","pdf");b.put("internal-nacl-plugin","nacl");b.put("widevinecdmadapter","dll");b.put("Flash","flash");b.put("npctrl","dll");this.deviceprint_version=function(){return a};this.deviceprint_browser=function(){var d=navigator.userAgent.toLowerCase();var c=d+SEP+navigator.appVersion+SEP+navigator.platform;return c};this.deviceprint_software=function(){var j="";var d=true;var h="";var f="";var l=navigator.plugins;var e=navigator.mimeTypes;if(l.length>0){var c="";var k="Plugins";var g=l.length;for(i=0;i<g;i++){plugin=l[i];c=stripFullPath(plugin.filename,k,".");if(d===true){f=b.containsKey(c);if(f){h+=b.get(c);d=false}else{h="";d=false}}else{f=b.containsKey(c);if(f){h+=SEP+b.get(c)}else{h+=""}}}j=stripIllegalChars(h)}else{if(e.length>0){f="";for(i=0;i<e.length;i++){mimeType=e[i];if(d===true){f=b.containsKey(mimeType);if(f){j+=b.get(mimeType)+PAIR+mimeType;d=false}else{j+="unknown"+PAIR+mimeType;d=false}}else{f=b.containsKey(mimeType);if(f){j+=SEP+b.get(mimeType)+PAIR+mimeType}else{h+=""}}}}}return j};this.deviceprint_display=function(){var c="";if(self.screen){c+=screen.colorDepth+SEP+screen.width+SEP+screen.height+SEP+screen.availHeight}return c};this.deviceprint_all_software=function(){var d="";var g=true;var h=navigator.plugins;var c=h.length;if(c>0){var j="";var f="";var k="";for(i=0;i<c;i++){var e=h[i];f=e.filename;f=stripFullPath(f,"Plugins",".");if(g===true){j+=f;g=false}else{j+=SEP+f}}d=stripIllegalChars(j)}return d};this.deviceprint_timezone=function(){var d=(new Date().getTimezoneOffset()/60)*(-1);var c=new Date();if(c.deviceprint_dst()){d--}else{}return d};Date.prototype.deviceprint_stdTimezoneOffset=function(){var c=new Date(this.getFullYear(),0,1);var d=new Date(this.getFullYear(),6,1);return Math.max(c.getTimezoneOffset(),d.getTimezoneOffset())};Date.prototype.deviceprint_dst=function(){return this.getTimezoneOffset()<this.deviceprint_stdTimezoneOffset()};this.deviceprint_language=function(){var f;var d=navigator.language;var e=navigator.browserLanguage;var c=navigator.systemLanguage;var g=navigator.userLanguage;if(typeof(d)!=="undefined"){f="lang"+PAIR+d+SEP}else{if(typeof(e)!=="undefined"){f="lang"+PAIR+e+SEP}else{f="lang"+PAIR+""+SEP}}if((typeof(c)!=="undefined")){f+="syslang"+PAIR+c+SEP}else{f+="syslang"+PAIR+""+SEP}if((typeof(g)!=="undefined")){f+="userlang"+PAIR+g}else{f+="userlang"+PAIR+""}return f};this.deviceprint_java=function(){var c=(navigator.javaEnabled())?1:0;return c};this.deviceprint_cookie=function(){var c=(navigator.cookieEnabled)?1:0;if(typeof navigator.cookieEnabled==="undefined"&&!c){document.cookie="testcookie";c=(document.cookie.indexOf("testcookie")!==-1)?1:0}return c};this.deviceprint_appName=function(){var c=navigator.appName;return(typeof(c)!="undefined")?c:""};this.deviceprint_appCodeName=function(){var c=navigator.appCodeName;return(typeof(c)!="undefined")?c:""};this.deviceprint_online=function(){var c=navigator.onLine;return(typeof(c)!="undefined")?c:""};this.deviceprint_opsProfile=function(){var c=navigator.opsProfile;return((typeof(c)!="undefined")&&(c!==null))?c:""};this.deviceprint_userProfile=function(){var c=navigator.userProfile;return((typeof(c)!="undefined")&&(c!==null))?c:""};this.deviceprint_screen_availWidth=function(){var c=screen.availWidth;return(typeof(c)!="undefined")?c:""};this.deviceprint_screen_pixelDepth=function(){var c=screen.pixelDepth;return(typeof(c)!="undefined")?c:""};this.deviceprint_screen_bufferDepth=function(){var c=screen.bufferDepth;return(typeof(c)!="undefined")?c:""};this.deviceprint_screen_deviceXDPI=function(){var c=screen.deviceXDPI;return(typeof(c)!="undefined")?c:""};this.deviceprint_screen_deviceYDPI=function(){var c=screen.deviceYDPI;return(typeof(c)!="undefined")?c:""};this.deviceprint_screen_logicalXDPI=function(){var c=screen.logicalXDPI;return(typeof(c)!="undefined")?c:""};this.deviceprint_screen_logicalYDPI=function(){var c=screen.logicalYDPI;return(typeof(c)!="undefined")?c:""};this.deviceprint_screen_fontSmoothingEnabled=function(){var c=screen.fontSmoothingEnabled;return(typeof(c)!="undefined")?c:""};this.deviceprint_screen_updateInterval=function(){var c=screen.updateInterval;return(typeof(c)!="undefined")?c:""};this.deviceprint_ping_in=function(){if(ProxyCollector&&ProxyCollector.internalPingTime){return ProxyCollector.internalPingTime}else{return""}};this.deviceprint_ping_ex=function(){if(ProxyCollector&&ProxyCollector.externalPingTime){return ProxyCollector.externalPingTime}else{return""}}}function urlEncode(b){var a=encodeURIComponent(b).replace(/\~/g,"%7E").replace(/\!/g,"%21").replace(/\*/g,"%2A").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\'/g,"%27").replace(/\-/g,"%2D").replace(/\_/g,"%5F").replace(/\./g,"%2E");return a}function encode_deviceprint(){var a=add_deviceprint();return urlEncode(a)}function decode_deviceprint(){var a=encode_deviceprint;return decodeURIComponent(urlEncode(a))}function post_deviceprint(){document.forms[0].pm_fp.value=encode_deviceprint();return true}function post_fingerprints(a){a.deviceprint.value=encode_deviceprint()}function add_deviceprint(){BrowserDetect.init();var c;switch(BrowserDetect.browser){case"Explorer":var b=detectIE();c=new IE_FingerPrint();if(b>10){c=new FingerPrint()}else{c=new IE_FingerPrint()}break;case"Firefox":c=new Mozilla_FingerPrint();break;case"Opera":c=new Opera_FingerPrint();break;case"Edge":var b=detectIE();if(b>10){c=new FingerPrint()}else{c=new IE_FingerPrint()}break;default:c=new FingerPrint()}var a="version="+c.deviceprint_version()+"&pm_fpua="+c.deviceprint_browser()+"&pm_fpsc="+c.deviceprint_display()+"&pm_fpsw="+c.deviceprint_software()+"&pm_fptz="+c.deviceprint_timezone()+"&pm_fpln="+c.deviceprint_language()+"&pm_fpjv="+c.deviceprint_java()+"&pm_fpco="+c.deviceprint_cookie();a=a+"&pm_fpasw="+c.deviceprint_all_software();a=a+"&pm_fpan="+c.deviceprint_appName()+"&pm_fpacn="+c.deviceprint_appCodeName()+"&pm_fpol="+c.deviceprint_online()+"&pm_fposp="+c.deviceprint_opsProfile()+"&pm_fpup="+c.deviceprint_userProfile()+"&pm_fpsaw="+c.deviceprint_screen_availWidth()+"&pm_fpspd="+c.deviceprint_screen_pixelDepth()+"&pm_fpsbd="+c.deviceprint_screen_bufferDepth()+"&pm_fpsdx="+c.deviceprint_screen_deviceXDPI()+"&pm_fpsdy="+c.deviceprint_screen_deviceYDPI()+"&pm_fpslx="+c.deviceprint_screen_logicalXDPI()+"&pm_fpsly="+c.deviceprint_screen_logicalYDPI()+"&pm_fpsfse="+c.deviceprint_screen_fontSmoothingEnabled()+"&pm_fpsui="+c.deviceprint_screen_updateInterval();a=a+"&pm_os="+BrowserDetect.OS+"&pm_brmjv="+parseInt(BrowserDetect.version,10)+"&pm_br="+BrowserDetect.browser;a=a+"&pm_inpt="+c.deviceprint_ping_in()+"&pm_expt="+c.deviceprint_ping_ex();return a}function form_add_data(c,b,a){if(c&&c.length>0){c+="&"}else{c=""}c+=b+"="+escape(a.toString());return c}function form_add_deviceprint(c,b,a){c=form_add_data(c,b+"d",a);return c}function detectIE(){var a=window.navigator.userAgent;var e=a.indexOf("MSIE ");if(e>0){return parseInt(a.substring(e+5,a.indexOf(".",e)),10)}var d=a.indexOf("Trident/");if(d>0){var c=a.indexOf("rv:");return parseInt(a.substring(c+3,a.indexOf(".",c)),10)}var b=a.indexOf("Edge/");if(b>0){return parseInt(a.substring(b+5,a.indexOf(".",b)),10)}return false}var HTML5="HTML5";var BLACKBERRY="blackberry";var UNDEFINED="undefined";var GEO_LOCATION_DEFAULT_STRUCT='{"GeoLocationInfo":[{"Status":4}]}';var geoLocator=null;var geoLocatorStatus=false;function detectDeviceCollectionAPIMode(){if(typeof(navigator.geolocation)!=UNDEFINED){return HTML5}else{if(typeof(window.blackberry)!=UNDEFINED&&blackberry.location.GPSSupported){return BLACKBERRY}else{return UNDEFINED}}}function init(d,c,e,f,b){var a=detectDeviceCollectionAPIMode();if(a==HTML5){geoLocator=new HTML5LocationCollector();geoLocator.init(d,c,e,f);return true}else{if(a==BLACKBERRY){geoLocator=new BlackberryLocationCollector();geoLocator.init(b,c,e,f);return true}}return false}function startCollection(c,b,d,e,a){geoLocatorStatus=init(c,b,d,e,a);if(geoLocatorStatus){return geoLocator.startLocationWatch()}else{return false}}function stopCollection(){if(geoLocatorStatus){geoLocator.stopWatch()}}function getGeolocationStruct(){if(geoLocatorStatus){return geoLocator.generateGeolocationJSONStruct()}else{return GEO_LOCATION_DEFAULT_STRUCT}}function HTML5LocationCollector(){var c=this;var a=-1;this.getGeolocationWatchId=function(){return a};var b=null;this.getGeolocationLastPosition=function(){return b};var f=4;this.getGeolocationStatusCode=function(){return f};var d="";this.getGeolocationErrorMessage=function(){return d};var e={accuracy:100,timeout:180,relevancy:120,expiration:48};this.getGeolocationConfig=function(){return e};this.startLocationWatch=function(){var g={enableHighAccuracy:true,timeout:(e.timeout*1000),maximumAge:e.expiration};if(navigator.geolocation){a=navigator.geolocation.watchPosition(this.handlePosition,this.handleError,g);return true}else{f=4}return false};this.init=function(h,g,j,k){if(h!==null&&h>=0&&h<=200){e.accuracy=h}if(g!==null&&g>=90&&g<=300){e.timeout=g}if(j!==null&&j>=60&&j<=240){e.relevancy=j}if(k!==null&&k>=24&&k<=60){e.expiration=k}};this.handlePosition=function(j){var k=new Date().getTime();var g=getTimestampInMillis(j.timestamp);if((k-g)<=(e.expiration*60*60*1000)){if(b===null||j.timestamp>b.timestamp||j.coords.accuracy<b.coords.accuracy){b=j;f=0}}if(b!==null){var h=k-b.timestamp;if(h<=(e.relevancy*1000)&&b.coords.accuracy<=e.accuracy){c.stopWatch()}}};this.generateGeolocationJSONStruct=function(){var g=null;if(b!==null){var h=convertTimestampToGMT(b.timestamp);g={GeoLocationInfo:[{Status:f,Longitude:b.coords.longitude,Latitude:b.coords.latitude,Altitude:Math.round(b.coords.altitude),HorizontalAccuracy:Math.round(b.coords.accuracy),AltitudeAccuracy:Math.round(b.coords.altitudeAccuracy),Heading:Math.round(b.coords.heading),Speed:Math.round(b.coords.speed),Timestamp:h}]}}else{g={GeoLocationInfo:[{Status:f}]}}return JSON.stringify(g)};this.handleError=function(g){switch(g.code){case g.TIMEOUT:c.stopWatch();f=3;break;case g.POSITION_UNAVAILABLE:f=2;d=g.message;break;case g.PERMISSION_DENIED:f=1;break;case g.UNKNOWN_ERROR:f=2;d=g.message;break}};this.stopWatch=function(){navigator.geolocation.clearWatch(a);a=-2}}var TimestampCollector=(function(){var f;var l;var a;var m;var j=1;var k="";window.onfocus=function(){l=true};window.onblur=function(){l=false};var e=function(){while(true){if(new Date().getUTCMilliseconds()==0){return}}};var b=function(){var q=f;e();var n=new Date();if(n.getSeconds()%q==0){var o=g(n,l,a());d(o);return}};var h=function(o,n,q){k=encode_deviceprint();f=q;l;a=o;m=n;if(f!=1&&f!=2&&f!=5&&f!=10){f=5}setInterval(b,995)};var d=function(n){if(n&&n.userLoginName){if(window.XMLHttpRequest&&window.JSON){var o=new XMLHttpRequest();o.open("POST",m);if(j!=0){j=2}o.setRequestHeader("Content-Type","application/json");o.send(JSON.stringify(n));o.onloadend=function(){if(o.status==204){j=0}else{if(j!=0){j=3}}if(typeof debugCollection!="undefined"&&debugCollection){console.log(JSON.stringify(n));console.log("browserEvent returned with status code:"+j)}}}}else{if(typeof debugCollection!="undefined"&&debugCollection){console.log("User did not provide any user login name, reporting aborted.")}}};var g=function(o,r,n){var q={};q.deviceId=k;q.jsTime=o;q.userLoginName=n;q.url=window.location.href;q.activeWindow=r;return q};var c=function(){return j};return{startEventReporting:h,actualRestSending:d,getStatus:c}})();var UIEventCollector=(function(){var r=null;var n=null;var b=null;var o=null;var x=["output_size_limit"];m();j();function m(C){o={output_size_limit:1024,collection_mode:"partial"};if(C){for(p in C){if(!(p._config===undefined)){var D=false;for(var E=x.length-1;E>=0;E--){if(x[E]==p){found=true;continue}}if(!D){o[p]=C[p]}}}}b=false;n=c();r={elements:new UIElementList(),events:[],collection_status:0,toString:function(){return"RecordedData: {elements: "+this.elements+", events: "+this.events+"}"}};j()}function s(){var E=e();for(var D=0,C=E.length;D<C;D++){g(E[D])}}function e(){var D=[];var E=document.getElementsByTagName("input");for(var C=0,G=E.length;C<G;C++){var F=E[C];if(w(F)){D.push(F)}}return D}function w(C){if(C.tagName&&C.tagName.toLowerCase()=="input"){var D=C.getAttribute("type");if(D=="text"||D=="checkbox"||D=="checkbox"){return true}}return false}function c(){var D=(document.createEvent)?document.createEvent("Event"):document.createEventObject();var C=D.timeStamp||new Date();C=new Date(C);if(C.getYear()>2100){C=new Date(C/1000)}C=C.getTime();return C}function g(D){var C=null;var G=r.elements;var F=G.size();var E=a(D);if(!r.elements.containsKey(E)){C=new InteractionElement();C.id(E);C.type(z(D));C.length(D.value?D.value.length:0);G.put(C)}else{C=G.get(E)}return C}function l(G){var E=G||window.event;var D=d(E);if(w(D)){var C=g(D);C.incrementEventCount();var H=new RSAUIEvent();H.index(C.index());H.type(B(E));var F=u(E);H.offset(F-n);r.events.push(H)}return true}function y(D){var C=D||window.event;if(v(C)){var E={target:d(C),type:"paste"};return l(E)}else{return l(C)}}function v(C){if(C.type=="keydown"){var D=C.which||C.charCode||C.keyCode;var E=(typeof KeyboardEvent!="undefined"&&D==KeyboardEvent.DOM_VK_V)||D==118||D==86;if(E&&(C.ctrlKey||C.metaKey)){return true}}return false}function d(C){return C.target?C.target:C.srcElement}function u(C){var D;if(C.timeStamp&&C.timeStamp!==0){D=C.timeStamp;if(new Date(D).getYear()>2100){D=D/1000}}else{D=new Date().getTime()}return D}function q(C){}function k(){s();var C=r.elements;for(var F=C.size();F>=1;F--){var H=C.getByIndex(F);var G=H.id();var D=document.getElementById(G);if(!D){var E=document.getElementsByName(G);if(E.length>0){D=E[0]}}if(D&&D.value){H.length(D.value.length)}}}function h(G){var E=G||window.event;var D=G.target;if(D.nodeType==1){var H=D.getElementsByTagName("form");for(var F=H.length-1;F>=0;F--){var C=H[F];C.onsubmit=recordFormSubmitEvent}}}function j(){var D=l;var C=document;if(C.addEventListener){C.addEventListener("keydown",y,false);C.addEventListener("paste",D,false);C.addEventListener("focus",D,true);C.addEventListener("blur",D,true)}else{if(C.attachEvent){C.onkeydown=y;C.onfocusin=D;C.onfocusout=D}}}function f(){return private_config}function B(C){if(C.type=="keydown"){return RSAUIEvent.KeyDown}else{if(C.type=="submit"){return RSAUIEvent.Submit}else{if(C.type=="paste"){return RSAUIEvent.Paste}else{if(C.type=="focus"||C.type=="focusin"){return RSAUIEvent.Focus}else{if(C.type=="blur"||C.type=="focusout"){return RSAUIEvent.Blur}else{return RSAUIEvent.Unknown}}}}}}function A(C){if(C==RSAUIEvent.KeyDown){return"keydown"}else{if(C==RSAUIEvent.Submit){return"submit"}else{if(C==RSAUIEvent.Focus){return"focus"}else{if(C==RSAUIEvent.Blur){return"blur"}else{if(C==RSAUIEvent.Paste){return"paste"}else{return"unknown"}}}}}}function z(C){return C.nodeName+(C.type?(":"+C.type):"")}function a(C){return C.id?C.id:(C.name?C.name:C.nodeName)}return{addElement:function(C){return g(C)},getEventType:function(C){return B(C)},getEventCode:function(C){return A(C)},getRecordedData:function(){return r},getElementType:function(C){return z(C)},getElementId:function(C){return a(C)},initEventCollection:function(C){m(C)},getConfig:function(){return o},serialize:function(){k();var ac=this.getRecordedData();var Q=ac.elements;var L=TimestampCollector.getStatus();var K=[];for(var Z=0;Z<Q.length;Z++){K[Z]=false}var M=ac.events;var N=ac.collection_status;var aa=this.getConfig().collection_mode=="partial";var X=this.getConfig().output_size_limit;var G=M.length;var O="@";var Y=";";var W=",";var V=2*O.length;var ab=(""+n)+W+(""+N)+W+(""+L);var J=1;V+=J;V+=W.length;V+=ab.length;var H="";q("serializing elements ");for(var P=Q.size();P>0;P--){var ae=Q.getByIndex(P);var T=ae.serialize()+Y;q("elementsStr.length: "+H.length);if(aa&&((V+H.length+T.length)>X)){b=true;break}var I=ae.type().match("INPUT:checkbox");if(I==null){if(ae.length()>0&&ae.eventCount()==0){q("collecting element without input: "+ae);H=T+H}}}V+=H.length;var D="";q("serializing events ");while(G--){var S=M[G];var R=S.index();var F=S.serialize()+Y;var T=Q.getByIndex(R).serialize()+Y;var C=F.length;if(!K[R]){C+=T.length}q("eventsStr.length: "+D.length);if(aa&&((V+D.length+C)>X)){b=true;break}q("collecting event: "+S);if(!K[R]){H=T+H;V+=T.length;q("also adding element event: "+T)}K[R]=true;D=F+D}if(H.length>0){H=H.substring(0,H.length-1)}if(D.length>0){D=D.substring(0,D.length-1)}var U=b?1:0;var E=H+O+D+O+U+W+ab;return E}}})();function RSAUIEvent(){var a=(this===window)?{}:this;a.index=function(b){if(arguments.length===0){return a._index}else{a._index=arguments[0]}};a.offset=function(b){if(arguments.length===0){return a._offset}else{a._offset=arguments[0]}};a.type=function(b){if(arguments.length===0){return a._type}else{a._type=arguments[0]}};a.serialize=function(){var b=",";var c="0";return a.index()+b+a.type()+b+c};a.toString=function(){return"UIEvent: [index: "+a.index()+", type: "+a.type()+", offset: "+a.offset()+"]"}}RSAUIEvent.Unknown=0;RSAUIEvent.KeyDown=1;RSAUIEvent.Submit=2;RSAUIEvent.Focus=3;RSAUIEvent.Blur=4;RSAUIEvent.Paste=5;function InteractionElement(){var a=(this===window)?{}:this;a._eventCount=0;a.id=function(b){if(arguments.length===0){return a._id}else{a._id=arguments[0]}};a.index=function(b){if(arguments.length===0){return a._index}else{a._index=arguments[0]}};a.length=function(b){if(arguments.length===0){return a._length}else{a._length=arguments[0]}};a.type=function(b){if(arguments.length===0){return a._type}else{a._type=arguments[0]}};a.incrementEventCount=function(){a._eventCount++};a.eventCount=function(){return a._eventCount};a.serialize=function(){var b=",";var c=a.index();return a.index()+b+c+b+a.type()+b+a.length()};a.toString=function(){return"InteractionElement: [id: "+a.id()+", index: "+a.index()+", length: "+a.length()+", type: "+a.type()+"]"}}function UIElementList(){var b=(this===window)?{}:this;var c=new Hashtable();var a=new Hashtable();b.get=function(d){return c.get(d)};b.getByIndex=function(d){return a.get(d)};b.containsKey=function(d){return c.containsKey(d)};b.indexByKey=function(d){return get(d).index()};b.size=function(){return c.size()};b.put=function(e){var d=e.id();if(!c.containsKey(d)){c.put(d,e);var f=c.size();e.index(f);a.put(f,e)}};b.toString=function(){return"[size: "+c.size()+", names: ["+c+"], indexes: ["+a+"]]"}}function activeXDetect(b){var a=null;try{a=document.body.getComponentVersion("{"+b+"}","ComponentID")}catch(c){}return(a!==null)?a:false}function stripIllegalChars(a){t="";a=a.toLowerCase();var b=a.length;for(var c=0;c<b;c++){var d=a.charAt(c);if(d!="\n"&&d!="/"&&d!="\\"){t+=d}else{if(d=="\n"){t+="n"}}}return t}function stripFullPath(c,h,a){var f=h;var g=a;var b=c;var d=b.lastIndexOf(f);if(d>=0){filenameLen=b.length;b=b.substring(d+f.length,filenameLen)}var e=b.indexOf(g);if(e>=0){b=b.slice(0,e)}return b}var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"an unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS,this.browser)||"an unknown OS"},searchString:function(a,c){var j=a.length;var g=c;for(var b=0;b<j;b++){var f=a[b];var d=f.string;var h=f.prop;var e=f.identity;this.versionSearchString=f.versionSearch||e;if(g&&g.toLowerCase()=="edge"&&(d.toLowerCase().indexOf("windows phone")!==-1||d.toLowerCase().indexOf("lumia"))!==-1){return"Windows"}if(d){if(d.toLowerCase().indexOf(f.subString.toLowerCase())!==-1){return e}}else{if(h){return e}}}},searchVersion:function(c){var b=c.toLowerCase().indexOf(this.versionSearchString.toLowerCase());if(b===-1){return}var a=c.substring(b+this.versionSearchString.length);if(a.indexOf(" ")===0||a.indexOf("/")===0||a.indexOf(":")===0){a=a.substring(1)}return parseFloat(a)},dataBrowser:[{string:navigator.userAgent,subString:"edge",identity:"Edge"},{string:navigator.userAgent.toLowerCase(),subString:"opera",identity:"Opera",versionSearch:"version"},{string:navigator.userAgent,subString:"OPR",versionSearch:"OPR/",identity:"Opera"},{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"CriOS",versionSearch:"CriOS/",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{string:navigator.userAgent,subString:"mobile safari",identity:"Mobile Safari",versionSearch:"mobile safari"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent.toLocaleLowerCase(),subString:"blackberry",identity:"BlackBerry",versionSearch:"0/"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Trident",identity:"Explorer",versionSearch:"rv"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.userAgent,subString:"BlackBerry",identity:"BlackBerry"},{string:navigator.userAgent.toLowerCase(),subString:"android",identity:"Android"},{string:navigator.userAgent,subString:"Symbian",identity:"Symbian"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"},{string:navigator.userAgent,subString:"Windows CE",identity:"Windows CE"},{string:navigator.platform,subString:"Win",identity:"Windows"}]};function convertTimestampToGMT(b){var a=b;if(!(b instanceof Date)){a=new Date(b)}offsetFromGmt=a.getTimezoneOffset()*60000;return a.getTime()+offsetFromGmt}function getTimestampInMillis(b){var a=b;if(b instanceof Date){a=b.getTime()}return a}function debug(a){}(function(E){E.fn.alphanum=function(Q){var P=J(Q);var R=this;B(R,F,P);return this};E.fn.alpha=function(R){var Q=J("alpha");var P=J(R,Q);var S=this;B(S,F,P);return this};E.fn.numeric=function(Q){var P=j(Q);var R=this;B(R,I,P);R.blur(function(){x(this,P)});return this};var n={allow:"",disallow:"",allowSpace:true,allowNewline:true,allowNumeric:true,allowUpper:true,allowLower:true,allowCaseless:true,allowLatin:true,allowOtherCharSets:true,forceUpper:false,forceLower:false,maxLength:NaN};var C={allowPlus:false,allowMinus:true,allowThouSep:true,allowDecSep:true,allowLeadingSpaces:false,maxDigits:NaN,maxDecimalPlaces:NaN,maxPreDecimalPlaces:NaN,max:NaN,min:NaN};var O={alpha:{allowNumeric:false},upper:{allowNumeric:false,allowUpper:true,allowLower:false,allowCaseless:true},lower:{allowNumeric:false,allowUpper:false,allowLower:true,allowCaseless:true}};var c={integer:{allowPlus:false,allowMinus:true,allowThouSep:false,allowDecSep:false},positiveInteger:{allowPlus:false,allowMinus:false,allowThouSep:false,allowDecSep:false}};var a=G()+d();var m=",";var z=".";var A=b();var y=N();function G(){var P="!@#$%^&*()+=[]\\';,/{}|\":<>?~`.-_";P+=" ";return P}function d(){var P="\xAC\u20AC\xA3\xA6";return P}function B(R,P,Q){R.each(function(){var S=E(this);S.off(".alphanum").on("keyup.alphanum change.alphanum paste.alphanum",function(U){var T="";if(U.originalEvent&&U.originalEvent.clipboardData&&U.originalEvent.clipboardData.getData){T=U.originalEvent.clipboardData.getData("text/plain")}setTimeout(function(){K(S,P,Q,T)},0)}).on("keypress.alphanum",function(X){var ab=!X.charCode?X.which:X.charCode;if(H(ab)||X.ctrlKey||X.metaKey){return}var Z=String.fromCharCode(ab);var Y=S.selection();var T=Y.start;var W=Y.end;var aa=S.val();var V=aa.substring(0,T)+Z+aa.substring(W);var U=P(V,Q);if(U!=V){X.preventDefault()}})})}function x(P,R){var Q=parseFloat(E(P).val());var S=E(P);if(isNaN(Q)){S.val("");return}if(s(R.min)&&Q<R.min){S.val("")}if(s(R.max)&&Q>R.max){S.val("")}}function s(P){return !isNaN(P)}function H(P){if(P>=32){return false}if(P==10){return false}if(P==13){return false}return true}function K(U,P,T,Q){var V=U.val();if(V==""&&Q.length>0){V=Q}var S=P(V,T);if(V==S){return}var R=U.alphanum_caret();U.val(S);if(V.length==(S.length+1)){U.alphanum_caret(R-1)}else{U.alphanum_caret(R)}}function J(R,Q){if(typeof Q=="undefined"){Q=n}var S,P={};if(typeof R==="string"){S=O[R]}else{if(typeof R=="undefined"){S={}}else{S=R}}E.extend(P,Q,S);if(typeof P.blacklist=="undefined"){P.blacklistSet=f(P.allow,P.disallow)}return P}function j(Q){var R,P={};if(typeof Q==="string"){R=c[Q]}else{if(typeof Q=="undefined"){R={}}else{R=Q}}E.extend(P,C,R);return P}function v(R,P,Q){if(Q.maxLength&&R.length>=Q.maxLength){return false}if(Q.allow.indexOf(P)>=0){return true}if(Q.allowSpace&&(P==" ")){return true}if(!Q.allowNewline&&(P=="\n"||P=="\r")){return false}if(Q.blacklistSet.contains(P)){return false}if(!Q.allowNumeric&&A[P]){return false}if(!Q.allowUpper&&e(P)){return false}if(!Q.allowLower&&u(P)){return false}if(!Q.allowCaseless&&M(P)){return false}if(!Q.allowLatin&&y.contains(P)){return false}if(!Q.allowOtherCharSets){if(A[P]||y.contains(P)){return true}else{return false}}return true}function k(R,P,Q){if(A[P]){if(l(R,Q)){return false}if(r(R,Q)){return false}if(D(R,Q)){return false}if(q(R+P,Q)){return false}if(L(R+P,Q)){return false}return true}if(Q.allowPlus&&P=="+"&&R==""){return true}if(Q.allowMinus&&P=="-"&&R==""){return true}if(P==m&&Q.allowThouSep&&h(R)){return true}if(P==z){if(R.indexOf(z)>=0){return false}if(Q.allowDecSep&&Q.maxDecimalPlaces===0){return false}if(Q.allowDecSep){return true}}return false}function w(P){P=P+"";return P.replace(/[^0-9]/g,"").length}function l(Q,R){var P=R.maxDigits;if(P===""||isNaN(P)){return false}var S=w(Q);if(S>=P){return true}return false}function D(S,U){var T=U.maxDecimalPlaces;if(T===""||isNaN(T)){return false}var Q=S.indexOf(z);if(Q==-1){return false}var P=S.substring(Q);var R=w(P);if(R>=T){return true}return false}function r(S,T){var R=T.maxPreDecimalPlaces;if(R===""||isNaN(R)){return false}var P=S.indexOf(z);if(P>=0){return false}var Q=w(S);if(Q>=R){return true}return false}function q(P,Q){if(!Q.max||Q.max<0){return false}var R=parseFloat(P);if(R>Q.max){return true}return false}function L(P,Q){if(!Q.min||Q.min>0){return false}var R=parseFloat(P);if(R<Q.min){return true}return false}function F(W,U){if(typeof W!="string"){return W}var R=W.split("");var Q=[];var S=0;var P;for(S=0;S<R.length;S++){P=R[S];var V=Q.join("");if(v(V,P,U)){Q.push(P)}}var T=Q.join("");if(U.forceLower){T=T.toLowerCase()}else{if(U.forceUpper){T=T.toUpperCase()}}return T}function I(V,T){if(typeof V!="string"){return V}var R=V.split("");var Q=[];var S=0;var P;for(S=0;S<R.length;S++){P=R[S];var U=Q.join("");if(k(U,P,T)){Q.push(P)}}return Q.join("")}function e(P){var R=P.toUpperCase();var Q=P.toLowerCase();if((P==R)&&(R!=Q)){return true}else{return false}}function u(P){var R=P.toUpperCase();var Q=P.toLowerCase();if((P==Q)&&(R!=Q)){return true}else{return false}}function M(P){if(P.toUpperCase()==P.toLowerCase()){return true}else{return false}}function f(Q,T){var R=new g(a+T);var P=new g(Q);var S=R.subtract(P);return S}function b(){var S="0123456789".split("");var Q={};var P=0;var R;for(P=0;P<S.length;P++){R=S[P];Q[R]=true}return Q}function N(){var P="abcdefghijklmnopqrstuvwxyz";var Q=P.toUpperCase();var R=new g(P+Q);return R}function h(R){if(R.length==0){return false}var T=R.indexOf(z);if(T>=0){return false}var U=R.indexOf(m);if(U<0){return true}var Q=R.lastIndexOf(m);var P=R.length-Q-1;if(P<3){return false}var S=w(R.substring(U));if((S%3)>0){return false}return true}function g(P){if(typeof P=="string"){this.map=o(P)}else{this.map={}}}g.prototype.add=function(R){var Q=this.clone();for(var P in R.map){Q.map[P]=true}return Q};g.prototype.subtract=function(R){var Q=this.clone();for(var P in R.map){delete Q.map[P]}return Q};g.prototype.contains=function(P){if(this.map[P]){return true}else{return false}};g.prototype.clone=function(){var Q=new g();for(var P in this.map){Q.map[P]=true}return Q};function o(Q){var S={};var T=Q.split("");var R=0;var P;for(R=0;R<T.length;R++){P=T[R];S[P]=true}return S}E.fn.alphanum.backdoorAlphaNum=function(R,Q){var P=J(Q);return F(R,P)};E.fn.alphanum.backdoorNumeric=function(R,Q){var P=j(Q);return I(R,P)};E.fn.alphanum.setNumericSeparators=function(P){if(P.thousandsSeparator.length!=1){return}if(P.decimalSeparator.length!=1){return}m=P.thousandsSeparator;z=P.decimalSeparator}})(jQuery);(function(c){function b(f,e){if(f.createTextRange){var d=f.createTextRange();d.move("character",e);d.select()}else{if(f.selectionStart!=null){f.focus();f.setSelectionRange(e,e)}}}function a(f){if("selection" in document){var d=f.createTextRange();try{d.setEndPoint("EndToStart",document.selection.createRange())}catch(g){return 0}return d.text.length}else{if(f.selectionStart!=null){return f.selectionStart}}}c.fn.alphanum_caret=function(d,e){if(typeof(d)==="undefined"){return a(this.get(0))}return this.queue(function(g){if(isNaN(d)){var f=c(this).val().indexOf(d);if(e===true){f+=d.length}else{if(typeof(e)!=="undefined"){f+=e}}b(this,f)}else{b(this,d)}g()})}}(jQuery));(function(g){var k=function(a){return a.replace(/([a-z])([a-z]+)/gi,function(o,m,q){return m+q.toLowerCase()}).replace(/_/g,"")},d=function(a){return a.replace(/^([a-z]+)_TO_([a-z]+)/i,function(o,m,q){return q+"_TO_"+m})},b=function(a){return a?a.ownerDocument.defaultView||a.ownerDocument.parentWindow:window},f=function(e,o){var m=g.Range.current(e).clone(),a=g.Range(e).select(e);if(!m.overlaps(a)){return null}if(m.compare("START_TO_START",a)<1){startPos=0;m.move("START_TO_START",a)}else{fromElementToCurrent=a.clone();fromElementToCurrent.move("END_TO_START",m);startPos=fromElementToCurrent.toString().length}if(m.compare("END_TO_END",a)>=0){endPos=a.toString().length}else{endPos=startPos+m.toString().length}return{start:startPos,end:endPos}},l=function(z){var m=b(z);if(z.selectionStart!==undefined){if(document.activeElement&&document.activeElement!=z&&z.selectionStart==z.selectionEnd&&z.selectionStart==0){return{start:z.value.length,end:z.value.length}}return{start:z.selectionStart,end:z.selectionEnd}}else{if(m.getSelection){return f(z,m)}else{try{if(z.nodeName.toLowerCase()=="input"){var A=b(z).document.selection.createRange(),e=z.createTextRange();e.setEndPoint("EndToStart",A);var y=e.text.length;return{start:y,end:y+A.text.length}}else{var x=f(z,m);if(!x){return x}var v=g.Range.current().clone(),q=v.clone().collapse().range,w=v.clone().collapse(false).range;q.moveStart("character",-1);w.moveStart("character",-1);if(x.startPos!=0&&q.text==""){x.startPos+=2}if(x.endPos!=0&&w.text==""){x.endPos+=2}return x}}catch(r){return{start:z.value.length,end:z.value.length}}}}},c=function(w,y,m){var r=b(w);if(w.setSelectionRange){if(m===undefined){w.focus();w.setSelectionRange(y,y)}else{w.select();w.selectionStart=y;w.selectionEnd=m}}else{if(w.createTextRange){var z=w.createTextRange();z.moveStart("character",y);m=m||y;z.moveEnd("character",m-w.value.length);z.select()}else{if(r.getSelection){var a=r.document,x=r.getSelection(),v=a.createRange(),q=[y,m!==undefined?m:y];h([w],q);v.setStart(q[0].el,q[0].count);v.setEnd(q[1].el,q[1].count);x.removeAllRanges();x.addRange(v)}else{if(r.document.body.createTextRange){var v=document.body.createTextRange();v.moveToElementText(w);v.collapse();v.moveStart("character",y);v.moveEnd("character",m!==undefined?m:y);v.select()}}}}},j=function(o,a,q,m){if(typeof q[0]==="number"&&q[0]<a){q[0]={el:m,count:q[0]-o}}if(typeof q[1]==="number"&&q[1]<=a){q[1]={el:m,count:q[1]-o}}},h=function(u,m,v){var q,a;v=v||0;for(var o=0;u[o];o++){q=u[o];if(q.nodeType===3||q.nodeType===4){a=v;v+=q.nodeValue.length;j(a,v,m,q)}else{if(q.nodeType!==8){v=h(q.childNodes,m,v)}}}return v};jQuery.fn.selection=function(m,a){if(m!==undefined){return this.each(function(){c(this,m,a)})}else{return l(this[0])}};g.fn.selection.getCharElement=h})(jQuery);function BMNLgnCore(a){this.params=a;this.swfTimeoutV=null;this.rsaTimeoutV=null;this.lgnRSALoaded=false;this.widgetDiv=".widget_login";this.isAcceptedCToken=false;this.isAuthVal=false;this.lockClickedButton=false;this.enrollDataIn=null;this.enrollDataOut=null;this.enrollmentController=null;this.ENROLPHRASE_PATTERN=/^[A-Za-z0-9 ]{3,20}$/;this.ENROLRESPQUESTION_PATTERN=/^[A-Za-z0-9]{6,30}$/;this.enrollLoaded=false;this.enrollIsError=false;this.auEmpresa=null;this.stage=0;this.isOnRequest=false;this.init()}BMNLgnCore.prototype={constructor:BMNLgnCore,sendIU:function(a){identificarUsuario(null)},pd:function(a){a.preventDefault?a.preventDefault():(a.returnValue=false)},init:function(){var a=this;$("#wpp_login, #formBanorteId").unbind("keydown");$("#wpp_login, #formBanorteId").unbind("keyup");$("#wpp_login, #formBanorteId").unbind("keypress");$("#btn_lgn_entrar").click(function(c){try{if(document.getElementById("flagBehavioWeb").value=="on"){console.log("BehavioWeb sending User");bw.saveData()}else{console.log("Flag BehavioWeb login off...")}}catch(b){console.log("Error sending BehavioWeb login info...")}a.pd(c);$("#flagRecuperaCve").val("");flagRecuperaCvejs="";a.sendIU(a)});$(document).ready(function(){var b=modoPortaljs;if(b=="modoSeparado"){$("#iFrameBlock").css("display","none");$("#wpp_login").css("z-index","1000");$("#flagRecuperaCve").val("");flagRecuperaCvejs="";a.sendIU(a)}else{if(flagRecuperaCvejs=="1"){$("#flagRecuperaCve").val("");flagRecuperaCvejs="";$("#iFrameBlock").css("display","none");$("#iFrameBlock").html("");setTimeout(function(){popupiframe("#iFrameBlock",URL_RECUPERAR_CNTRSN,ALTO_WIN_RECUPERAR_PASSWORD,ANCHO_WIN_RECUPERAR_PASSWORD)},800)}}});$("#userid").focus().keypress(function(b){if(b.keyCode==13){a.pd(b);a.sendIU(a);b.stopPropagation();return false}});$("#btnRegresarBloqueo").click(function(){event.preventDefault();window.location=actionBackPortalPublico});a.swfLoad();if(window.navigator.userAgent.indexOf("MSIE 9.0")!=-1){$("#wpp_enrolamientoWizard").addClass("ie")}},addToolTip:function(e,b){var f=this;$("#idTooltipPassword").html("");$("#idTooltip").html("");var a=e.split("|");if(a.length==2){var d={title:a[0],body:a[1]};var c="<div class='boxed'><div class='arrow'></div><div class='content'><p>"+d.body+"</p></div></div>";$(b).html(c);if(modoPortaljs=="modoSeparado"&&e.indexOf("15 minutos")!=-1){$("#userid").prop("disabled",true);$("#btn_lgn_entrar").prop("disabled","disabled");setTimeout(function(){$("#formBanorteId").attr("action",actionBackPortalPublico);setUrlShort(actionBackPortalPublico);$("#formBanorteId").submit()},10000)}}else{if(a.length==1){var c="<div class='boxed'><div class='arrow'></div><div class='content'><p>"+e+"</p></div></div>";$(b).html(c)}else{if(a.length==4){var d={title:a[1],body:a[2],name:a[0],help:a[3]};f.addVentana(d);$("#idTooltipPassword").html("");$("#idTooltip").html("");$("#idTooltipPassword").hide();$("#idTooltip").hide();f.showLightbox(true);setTimeout(function(){$("#BEM_layerAux").css("display","none")},1000)}}}if(!f.isHomeViewMode()){$(".login_trigger").click()}},showTokenTooltip:function(a){var b=this;if(a.indexOf("error")==0){b.addToolTip(a,"#idTooltipTokenCelular");$("#idTooltipTokenCelular").css("top","270px")}else{$("#mensajeTokenCelular").html(a)}},showLightbox:function(b,a){if(b){$("#wpp_login").css("z-index","999");if(typeof(a)!="undefined"){lightbox("open")}else{lightbox("open",a)}}else{$("#wpp_login").css("z-index","100");lightbox("close")}},addVentana:function(a){var b="<h1>"+a.title+"</h1><p>"+a.body+"</p>";if(modoPortaljs=="modoSeparado"){b+='<button id="btnRegresarInicio" type = button onclick="regresaInicio();">Regresar</button>'}else{b+='<button onclick="window.location = actionInicio;">Regresar</button>'}b=b+'<ul class="submenu"><div class="tooltip_area"><li class="ayuda" id="ayuda'+a.name+'"><a href="#"><img class="icono">Ayuda</a><p class="p_ayuda">&nbsp;</p></li><div class="tooltip left" id="idTooltip'+a.name+'" style="display:block"><div class="boxed"><div class="arrow"></div><div class="content"><p>'+a.help+"</p></div></div></div></div></ul>";$(".content_box").hide();$("#login_genericwindow").html(b);$("#login_genericwindow").show().css("opacity",1);$("#idTooltip"+a.name+"").hide();$("#ayuda"+a.name+"").hover(function(){$("#idTooltip"+a.name+"").show()},function(){$("#idTooltip"+a.name+"").hide()})},showLoadingMask:function(b){var c=this;var a=c.widgetDiv;if(b){$(a+" .loading").css("display","block");$(a+" .loading").css("opacity","1");$(a+" .loading").css("background-color","rgba(255,255,255,0.66)");$(a+" .loading .gif").css("display","block");$(a+" .loading .gif").css("opacity","1")}else{$(a+" .loading").css("display","none");$(a+" .loading").css("opacity","0");$(a+" .loading .gif").css("display","none");$(a+" .loading .gif").css("opacity","0")}},validateResponsiveLogin:function(){return($(".widget_login").css("display")=="none")},swfRefreshData:function(a){var c=this;var b=$("#rsaDeviceFso").val();if(a>96){console.log("Couldn't read the SWF. Possible reasons: <li>Macromadia flash is not installed.</li><li>Flash version is not supported (minimum requiered is 6.0.0).</li><li>Flash movie flashMovie was not found.</li>")}else{if(b==""||b==undefined||b==null){c.swfTimeoutV=setTimeout(function(){c.swfRefreshData((++a))},2000)}else{if(c.swfTimeoutV!=null){clearTimeout(c.swfTimeoutV)}}}},rsaRefresData:function(c,a){var b=encode_deviceprint();if(a>48){console.log("Error rsaDevicePrint "+a)}else{if(b==""||b==undefined||b==null){c.rsaTimeoutV=setTimeout(function(){c.rsaRefresData((++a))},800)}else{$("#rsaDevicePrint").val(b);if(c.rsaTimeoutV!=null){clearTimeout(c.rsaTimeoutV)}}}},swfLoad:function(){var c=this;if(c.validateResponsiveLogin()){return}var b="field_name=rsaDeviceFso&ip_address="+c.params.hAddr;var a=c.params.ctxPath+"/js/rsa_fso";c.rsaRefresData(c,0);c.swfRefreshData(0);c.lgnRSALoaded=true},getLgnScript:function(c,f,b){var e=document.createElement("script");var d=document.getElementsByTagName("head")[0];var a=false;e.src=c;e.onload=e.onreadystatechange=function(){if(!a&&(!e.readyState||(e.readyState=="loaded"||e.readyState=="complete"))){a=true;f();e.onload=e.onreadystatechange=null}};e.onerror=function(){b()};d.appendChild(e)},printErrorMsgOld:function(){var b=this;var a="#idTooltipPassword";$("#idTooltip").html("");$("#idTooltipPassword").html("");if($errorLogin!=""&&$errorLogin!="null"){if($redirect=="true"){login_goto("login_password","homepage");a="#idTooltipPassword"}else{a="#idTooltip"}b.addToolTip($errorLogin,a)}else{$("#idTooltipPassword").html("")}},isHomeViewMode:function(){return($(".widget_login").length>0)},initByViewMode:function(){var b=this;var a=b.isHomeViewMode();if(mostrarLinks=="1"){$("#activarTokenId").show();$("#sincronizarTokenId").show()}else{if(mostrarLinks=="0"){$("#activarTokenId").hide();$("#sincronizarTokenId").hide()}else{$("#activarTokenId").show();$("#sincronizarTokenId").show();if(a){$("#mostrarSeccionOtrasCuentas").show()}}}if(a){if(mostrarSeccionOtrasCuentas=="1"){$("#others_box").show()}else{if(mostrarSeccionOtrasCuentas=="0"){$("#others_box").hide();$(".login_box").css("height","261px")}else{$("#others_box").show()}}setTimeout(function(){$("#userid").focus()},1000);$("#idTooltipPassword").html("")}$("#idTooltipBloqueo").hide();$("#idTooltipFormAyuda").hide();$("#ayudaBloqueo").hover(function(){$("#idTooltipBloqueo").show()},function(){$("#idTooltipBloqueo").hide()});$("#ayudaFormulario").hover(function(){$("#idTooltipFormAyuda").show()},function(){$("#idTooltipFormAyuda").hide()});if($banderaBloqueo=="true"){if(a){login_goto("login_userblocked","homepage")}else{login_goto("login_userblocked");headerOpenWidget(".login_trigger")}}if(a){if($validacionSAT!=null&&$validacionSAT!="null"&&$validacionSAT.length>4){$("#mensajeSAT").html($validacionSAT);$("#userid").prop("disabled",true);$("#idBtnEntrar").prop("disabled",true)}}else{$("#btnRegresarInicio").on("click",function(c){b.pd(c);window.location=actionInicio})}b.printErrorMsgOld();$("#btnCancelarActivaToken").on("click",function(c){b.pd(c)});$("#btnAceptarActivaToken").on("click",function(c){b.pd(c)});$("#activarTokenId").on("click",function(d){var c=$("#portalOrigen").val();if(c=="PP_BEM"){window.location.replace("?uri=nm:oid:activa-token-empresas")}else{popupiframe("#iFrameBlock",URL_ACTIVAR_TOKEN,ALTO_WIN_ACTIVAR_TOKEN,ANCHO_WIN_ACTIVAR_TOKEN)}});$("#sincronizarTokenId").on("click",function(c){popupiframe("#iFrameBlock",URL_SINCRONIZAR_TOKEN,ALTO_WIN_SINCRONIZAR_TOKEN,ANCHO_WIN_SINCRONIZAR_TOKEN)});$("#recuperarUsuarioId").click(function(c){if(getDomain()=="www.banorte"){gaTagCreate("send","event","Banorte - Login","redirigir","Recuperar Usuario")}if(window.location.href.indexOf("/wps/portal/ixe")>0){location.href="/wps/portal/ixe/Home/recuperar-usuario"}else{location.href="/wps/portal/banorte/Home/recuperar-usuario"}})},eliminarSesion:function(a){bmnLgnInstance.showLoadingMask(true);$.ajax({type:"POST",url:urlServicioLogin,dataType:"json",async:true,data:"servicio=eliminarSesion",success:function(b){bmnLgnInstance.showLoadingMask(false);if(a){if(b.vista=="home"){login_goto("login_login","homepage")}else{if(b.vista=="internas"){login_goto("login_login")}}}bmnLgnInstance.clearPreSessionVars()}})},initFormPassword:function(){var b=this;console.log("tipoAuth:"+tipoAutenticacion);$("#labelToken").hide();$("#tokenLogin").hide();$("#tokenReposicionLogin").hide();b.hideConcurrentSessionPanel();if(tipoAutenticacion==5||tipoAutenticacion==19){b.initWindowReposicion()}if(tipoAutenticacion==0){$("#divMensajeTokenCelular").hide()}else{if(tipoAutenticacion==18){$("#labelToken").show();$("#tokenLogin").show();$("#divMensajeTokenCelular").hide();$(".login_box").css("height","auto")}else{if(tipoAutenticacion==19){$("#divMensajeTokenCelular").show();$("#labelToken").show();$("#tokenLogin").show();$("#tokenReposicionLogin").show();$("#tokenLogin").css("margin-bottom","0px !important");$(".login_box").css("height","auto")}else{if(tipoAutenticacion==5){$("#tokenReposicionLogin").show()}else{$("#labelToken").hide();$("#tokenLogin").hide();$("#divMensajeTokenCelular").hide()}}}}$("#userid").val(userid);setTimeout(function(){$("#passwordLogin").show().focus()},200);try{loadBiocatch()}catch(a){console.log("Fallo Biocatch :"+a.message)}if($errorLogin!="null"&&$redirect=="true"){$("#idTooltipPassword").html("<div class='boxed' ><div class='arrow'></div><div class='content'><p>"+$errorLogin+"</p></div></div>");bmnLgnInstance.addToolTip($errorLogin,"#idTooltipPassword")}$("#passwordLogin, #tokenLogin").focus().keypress(function(c){if(c.keyCode==13){$("#btnAceptarloginPasswordAsync").click();c.stopPropagation();return false}});$("#idTextoAyuda").html(mensajeAyudaCntrsn);$("#idTooltipPasswordAyuda").hide();$("#ayudaPassword").hover(function(){$("#idTooltipPasswordAyuda").show()},function(){$("#idTooltipPasswordAyuda").hide()});$("#btnCancelarloginPassword").on("keypress",function(c){if(c.keyCode==13){$("#btnCancelarloginPassword").click()}});$("#btnCancelarloginPassword").on("click",function(c){b.pd(c);$("#idBtnEntrar").prop("disabled",false);$("#idTooltipPassword").html("");$("#userid").val("");$("#passwordLogin").val("");b.stage=0;b.cierraSesionCanal(b);b.eliminarSesion(true);$("#flagRecuperaCve").val("2");flagRecuperaCvejs="2";if(modoPortaljs=="modoSeparado"){console.log("modoSeparado ::: Redireccionando a portal publico");$("#formBanorteId").attr("action",actionBackPortalPublico);console.log("modoSeparado ::: action: "+$("#formBanorteId").attr("action"))}setUrlShort("");$("#formBanorteId").submit()});$("#olvideContraseniaId").on("click",function(c){b.pd(c);$("#idBtnEntrar").prop("disabled",false);$("#idTooltipPassword").html("");$("#userid").val("");$("#passwordLogin").val("");b.stage=0;b.cierraSesionCanal(b);b.eliminarSesion(true);if(modoPortaljs=="modoSeparado"){$("#flagRecuperaCve").val("1");flagRecuperaCvejs="1";$("#formBanorteId").attr("action",actionBackPortalPublico);$("#formBanorteId").submit()}else{setTimeout(function(){popupiframe("#iFrameBlock",URL_RECUPERAR_CNTRSN,ALTO_WIN_RECUPERAR_PASSWORD,ANCHO_WIN_RECUPERAR_PASSWORD)},800)}});b.initLinkReposicionToken(b);b.mostrarLinks("#olvideContraseniaId")},sendPx:function(a){$("#btnAceptarloginPasswordAsync").click()},mostrarLinks:function(a){if(mostrarLinks=="1"){$(a).show()}else{if(mostrarLinks=="0"){$(a).hide()}else{$(a).show()}}},onClickOlvideContrasenia:function(a){bmnLgnInstance.pd(a);$("#btnCancelarloginPassword").click();setTimeout(function(){popupiframe("#iFrameBlock",URL_RECUPERAR_CNTRSN,ALTO_WIN_RECUPERAR_PASSWORD,ANCHO_WIN_RECUPERAR_PASSWORD)},800)},clearPreSessionVars:function(){$errorLogin="";$identificarUsuarioResponse=""},doAjaxS:function(d,f,c,a,b){var g=this;try{if(f.servicio&&f.servicio=="autenticaSimple"){f.JBiocatch=document.getElementById("JBiocatch").value;console.log("JAR: Valor de params.JBiocatch"+f.JBiocatch)}}catch(e){console.log("JAR: Algo sali mal al agregar JBiocatch")}$.support.cors=true;$.ajax({url:d,async:true,type:"POST",dataType:c,data:f,crossDomain:true,beforeSend:function(){g.showLoadingMask(true)},success:function(h){g.showLoadingMask(false);a(h)},error:function(j,k,h){g.showLoadingMask(false);b(j,k,h)}})},initWindowReposicion:function(){var a=this;if(a.isAuthVal){return}$("#btnCancelarRCTokenPassword").click(function(b){$("#wpp_loginSincronizar").hide();$("#idTooltipPasswordRCToken").hide();$("#wpp_login").show()});$("#btnAceptarRCTokenPassword").click(function(b){if(!a.lockClickedButton){lockClickedButton=true;a.sendCTokenCredentials()}});a.mostrarLinks("#olvideContraseniaIdRCToken");$("#olvideContraseniaIdRCToken").click(function(b){a.pd(b);$("#wpp_login").show();$("#wpp_loginSincronizar").hide();$("#olvideContraseniaId").click()});$("#txt_lgnRCTkInputTelefono").blur(function(b){a.validateFrmReposicionToken()});$("#checkboxToken").click(function(b){a.isAcceptedCToken=$(this).is(":checked");a.isAcceptedCToken!=a.isAcceptedCToken;a.validateFrmReposicionToken()});$("#btn_changeCToken").click(function(b){$(this).attr("disabled","disabled");a.sendCTokenReplacement()});$("#btn_cancelCToken").click(function(b){$("#wpp_solicitaReponerToken").hide();$("#wpp_loginSincronizar").hide();$("#wpp_login").show();if($("#checkboxToken").is(":checked")){$("#checkboxToken").click()}$("#txt_lgnRCTkInputTelefono").val("");$("#btn_changeCToken").attr("disabled","");$("#txt_lgnRCTkInputTelefono_tip").hide();a.showWppErrorRCToken(a,false)});$("#btn_okCToken").click(function(b){$("#wpp_confirmaReponerToken").hide();$("#btn_cancelCToken").click()});a.isAuthVal=true},initLinkReposicionToken:function(a){$("#reponerTokenId").click(function(b){a.pd(b);$("#passwordLoginRCToken").val("");$("#nombreEnmascaradoRCToken").html($("#nombreEnmascarado").html());$("#imgLoginRCToken").attr("src",$("#imgLogin").attr("src"));$("#mensajePersonalRCToken").html($("#mensajePersonal").html());$("#wpp_loginSincronizar").show();$("#wpp_login").hide()})},isNumberKey:function(c,b){var a=(b.which)?b.which:b.keyCode;if(a===8){return true}if(a===46){return false}if(c.length>9&&a===13){return true}if(c.length>9){return false}if(a>31&&(a<48||a>57)){return false}return true},sendCTokenCredentials:function(){var b=this;var a={rctpass:$("#passwordLoginRCToken").val(),rctkn:"",modoRedirect:"C",flujoOrigen:"rct"};if(a.rctpass!=undefined&&a.rctpass!=""){$("#idTooltipPasswordRCToken").hide();b.doAjaxS(urlServicioLogin,{servicio:"autenticaSimple",dataObj:JSON.stringify(a),tipoAutenticacion:0},"text",function(c){try{c=JSON.parse(c);if(c!=null&&c!=undefined){if(c.code==0){$("#passwordLoginRCToken").val("");$("#wpp_loginSincronizar").hide();$("#wpp_solicitaReponerToken").show()}else{b.addToolTip(c.message,"#idTooltipPasswordRCToken");$("#idTooltipPasswordRCToken").show()}}else{}}catch(d){$("#passwordLoginRCToken").val("");$("#wpp_loginSincronizar").hide();$("#wpp_solicitaReponerToken").show()}lockClickedButton=false},function(d,e,c){lockClickedButton=false})}else{$("#idTooltipPasswordRCToken .content").html("<p>Escribir su contrasea<p>");$("#idTooltipPasswordRCToken").show()}},sendCTokenReplacement:function(){var b=this;var a={numTel:$("#txt_lgnRCTkInputTelefono").val(),acepto:b.isAcceptedCToken};b.doAjaxS(urlServicioLogin,{servicio:"reposicionTokenCelular",dataObj:JSON.stringify(a)},"json",function(c){if(c.code==0){b.showWppSuccessRCToken(b)}else{b.showWppErrorRCToken(b,true)}lockClickedButton=false},function(d,e,c){lockClickedButton=false})},showWppErrorRCToken:function(b,a){if(a){$("#wpp_solicitaReponerToken .error-message").show()}else{$("#wpp_solicitaReponerToken .error-message").hide()}},showWppSuccessRCToken:function(a){$("#wpp_solicitaReponerToken").hide();$("#wpp_confirmaReponerToken").show()},validateFrmReposicionToken:function(){var c=this;var a=true;var b=$("#txt_lgnRCTkInputTelefono").val();if(b.length<10&&b.length>0){$("#txt_lgnRCTkInputTelefono_tip").html("El nmero de celular debe corresponder a 10 dgitos.");$("#txt_lgnRCTkInputTelefono_tip").show();a=false}else{if(b.length==0){$("#txt_lgnRCTkInputTelefono_tip").html("Tu nmero de celular es requerido.");$("#txt_lgnRCTkInputTelefono_tip").show();a=false}}if(!c.isAcceptedCToken){a=false}if(a){$("#txt_lgnRCTkInputTelefono_tip").hide();$("#btn_changeCToken").removeAttr("disabled")}else{$("#btn_changeCToken").attr("disabled","disabled")}return a},showWppErrorEnrolamiento:function(b,a){if(a){$("#wpp_enrolamientoWizard .error-message").show()}else{$("#wpp_enrolamientoWizard .error-message").hide()}},showEnrolmentWz:function(){var a=this;a.getEnrolamientoQueryData()},setThemeColors:function(d){var c=d.auEmpresa;var b=c==1?"ebanorte":"ebanorte";$("#wpp_enrolamientoWizard").addClass(b);var a="";if(c==1){a=" Si despus de que ingresaste tu nombre de usuario NO observas o NO identificas la imagen y la frase que elegiste, NO ingreses tu contrasea y comuncate al Centro de Contacto al telfono: (81) 8156-4444."}else{a="Si despus de que ingresaste tu nombre de usuario NO observas o NO identificas la imagen y la frase que elegiste, NO ingreses tu contrasea y comuncate al Centro de Contacto a los telfonos: Ciudad de Mxico: (55) 5140-5600, Monterrey: (81) 8156-9600, Guadalajara: (33) 3669-9000. Resto del pas: 01-800-BANORTE (01800-226-6783)."}$("#login_preferente_mensaje").html(a)},getEnrolamientoQueryData:function(){var a=this;a.doAjaxS(urlServicioLogin,{servicio:"enrolamientoAAQueries",dataObj:"{}"},"json",function(b){if(b.code==0){a.loadEnrollEvents(a);a.loadEnrollQueryData(a,b);$(".steps-container .step p.error-message").hide();a.showLightbox(true);$("#wpp_login").hide();a.setThemeColors(a);$("#wpp_enrolamientoWizard").show();$("#wpp_enrolamientoWizard .thumbnail:first-child").mouseover();$("#wpp_enrolamientoWizard .thumbnail:first-child").click()}else{$("#btnCancelarloginPassword").click()}},function(c,d,b){})},setEnrolamientoQueryData:function(b,a){b.enrollmentController.deactivateButton();b.doAjaxS(urlServicioLogin,{servicio:"enrolamientoAAUpdates",dataObj:JSON.stringify(b.enrollDataOut)},"json",function(c){console.log(c);if(c.code==0){$("#wpp_enrolamientoWizard .modal-footer").addClass("hide");b.enrollmentController.animateSuccessButton();b.enrollIsError=false;a()}else{b.showWppErrorEnrolamiento(b,true);$("#wpp_enrolamientoWizard .error-message").html(c.message);b.enrollIsError=true}},function(d,e,c){})},loadEnrollQueryData:function(f,a){f.enrollDataIn={svcData:$.parseJSON(a.data),pageSize:10,pageNum:0,pagePos:0};f.enrollDataOut={imgSelId:0,imgPhrase:"",retoQuestionId:-1,retoQuestionPhrase:""};var e=f.enrollDataIn;var b=e.svcData;if(b.images){e.pageNum=Math.floor(b.images.length/e.pageSize)+(b.images.length%e.pageSize!=0?0:-1);f.loadEnrollImagesPage(f)}if(b.questions){f.loadEnrollQuestions(f)}if(!f.enrollLoaded){$("#wpp_enrolamientoWizard input").on("keypress",function(d){var c=d.keyCode?d.keyCode:d.which;if(c==9){return false}if($(this).hasClass("uppercase-message")){if(c>=65&&c<=90){f.enrollmentController.validations.activateUpperCaseMessage()}else{f.enrollmentController.validations.deactivateUpperCaseMessage()}}}).on("blur",function(){if($(this).attr("id")=="enrollPhraseInput"){f.enrollDataOut.imgPhrase=$(this).val()}if(!$(this).hasClass("combo-box-input")){f.enrollmentController.validations.validateStep()}if($(this).hasClass("uppercase-message")){f.enrollmentController.validations.deactivateUpperCaseMessage()}}).on("keyup",function(){if($(this).attr("id")=="enrollPhraseInput"){f.enrollDataOut.imgPhrase=$(this).val()}if(!$(this).hasClass("combo-box-input")){f.enrollmentController.validations.validateStep()}});$("#wpp_enrolamientoWizard .combo-box .combo-box-input, #wpp_enrolamientoWizard .combo-box .combo-box-icon").on("click",function(){f.enrollmentController.comboBox.toggle()});$("#wpp_enrolamientoWizard .combo-box .combo-box-options li").on("click",function(){f.enrollmentController.comboBox.selectOption($(this))});$("#wpp_enrolamientoWizard .alphanumeric").on("focus",function(){var c=true;if($(this).hasClass("no-space")){c=false}$(this).alphanum({allowSpace:c,allowOtherCharSets:false})});f.enrollLoaded=true}},getIniFinImage:function(f){var e=f.enrollDataIn;var a=e.svcData.images.length;var b=e.pagePos*e.pageSize;var d=b+e.pageSize;d=d>a?a:d;return{ini:b,fin:d}},loadEnrollImagesPage:function(e){var d=e.getIniFinImage(e);$("#lgn_image_selector .col-1").empty();$("#lgn_image_selector .col-2").empty();e.enrollDataOut.imgSelId=0;var c=true;for(var a=d.ini;a<d.fin;++a){var b=e.enrollDataIn.svcData.images[a];var h=$("#lgn_image_selector .col-1");var g=$("#lgn_image_selector .col-2");var f='<img data-image="'+b.imageId+'" src="'+b.path+'" '+(c?'class="active"':"")+">";var j='<img class="thumbnail'+(c?" active":"")+'" data-image="'+b.imageId+'" src="'+b.path+'">';c=false;h.append(f);g.append(j)}$("#wpp_enrolamientoWizard .thumbnail").on("mouseenter",function(){var k=$(this).data("image");e.enrollmentController.imageSelect.mouseIn(k)}).on("mouseleave",function(){var k=$(this).data("image");e.enrollmentController.imageSelect.mouseOut(k)}).on("click",function(){var k=$(this).data("image");e.enrollmentController.imageSelect.select(k,$(this));e.enrollDataOut.imgSelId=0;e.enrollmentController.validations.validateStep()});$("#wpp_enrolamientoWizard .thumbnail:first-child").mouseover();$("#wpp_enrolamientoWizard .thumbnail:first-child").click()},loadEnrollQuestions:function(g){var f=g.enrollDataIn;var e=f.svcData;for(var a in e.questions){var b=e.questions[a];$(".modal.enroll .modal-body .steps-container .step .combo-box ul").append('<li data-question="'+b.questionId+'">'+b.questionText+"</li>")}},loadEnrollEvents:function(c){if(!c.enrollLoaded){var b={currentStep:1,clickInProgress:false,positions:[],classes:[],imageSelect:{activeImage:"XYZ",hoveredImage:null,mouseIn:function(d){if(d!==this.activeImage&&d!==""){this.hoveredImage=$("#wpp_enrolamientoWizard .image-selector .col-1 img[data-image="+d+"]");this.hoveredImage.addClass("hover")}},mouseOut:function(d){if(d!==this.activeImage){this.hoveredImage.removeClass("hover")}},loadMoreImages:function(){c.getOnlyUserImage(c)},select:function(f,d){var e=this.hoveredImage;if(f!==this.activeImage&&this.activeImage!==""){e.addClass("active").removeClass("hover");e.css({"z-index":2});$("#wpp_enrolamientoWizard .image-selector .col-1 img[data-image="+this.activeImage+"]").removeClass("active");this.activeImage=f;$("#enrollImageInput").val(e.attr("src"));$("#wpp_enrolamientoWizard .thumbnail.active").removeClass("active");setTimeout(function(){e.removeAttr("style");d.addClass("active")},200)}}},animateSuccessButton:function(){$("#wpp_enrolamientoWizard .icon-success").addClass("animate");$("#wpp_enrolamientoWizard .icon-border").addClass("animate")},activateButton:function(){$("#wpp_enrolamientoWizard .next-btn").prop("disabled",false)},deactivateButton:function(){$("#wpp_enrolamientoWizard .next-btn").prop("disabled",true)},doNext:function(d){d.currentStep++;d.deactivateButton();$("#wpp_enrolamientoWizard .steps-container").css({left:d.positions[d.currentStep]});setTimeout(function(){$("#wpp_enrolamientoWizard .progress-bar-container").attr("class",d.classes[d.currentStep])},500)},nextStep:function(){this.positions=[0,-796,-796];this.classes=["progress-bar-container","progress-bar-container question","progress-bar-container result"];if(this.currentStep===0){this.doNext(this)}else{if(this.currentStep===1){c.setEnrolamientoQueryData(c,function(){c.enrollmentController.doNext(c.enrollmentController);if(bmnLgnPortal=="PP_SAT"){$("#btnIngresarAhora").show();$("#wpp_enrolamientoWizard .steps-container .step .result-options").hide()}else{$("#btnIngresarAhora").hide();$("#wpp_enrolamientoWizard .steps-container .step .result-options").show()}})}}},comboBox:{isActive:false,options:$("#wpp_enrolamientoWizard .combo-box-options"),input:$("#wpp_enrolamientoWizard .combo-box-input"),show:function(){var d=this.options;d.css("display","block");setTimeout(function(){d.addClass("active")},50);this.isActive=true},hide:function(){var d=this.options;d.removeClass("active");setTimeout(function(){d.removeAttr("style")},300);this.isActive=false},toggle:function(){if(this.isActive){this.hide()}else{this.show()}},selectOption:function(d){this.input.val(d.context.innerHTML);$("#wpp_enrolamientoWizard .combo-box-options li.active").removeClass("active");d.context.className="active";this.toggle();c.enrollDataOut.retoQuestionId=d.data("question");b.validations.validateStep()}},tooltip:{show:function(d){$(d).addClass("active")},hide:function(d){$(d).removeClass("active")}},validations:{activateUpperCaseMessage:function(){var d=$("#enrollmentAnswerUpperMessage");if(!d.hasClass("active")){d.addClass("active")}},deactivateUpperCaseMessage:function(){var d=$("#enrollmentAnswerUpperMessage");if(d.hasClass("active")){d.removeClass("active")}},validatePhrase:function(){var d=true;d&=c.ENROLPHRASE_PATTERN.test(c.enrollDataOut.imgPhrase);d&=c.enrollDataOut.imgSelId!==-1;if(d){b.activateButton()}else{b.deactivateButton()}},validateQuestion:function(){return($("#enrollQuestionInput").val()!=="")},validateAnswer:function(){var e=true;var d=$("#enrollAnswerInput").val();if(d.length<6){b.tooltip.show("#answerTooltip");e&=false}else{b.tooltip.hide("#answerTooltip");e&=true}e&=c.ENROLRESPQUESTION_PATTERN.test(d);c.enrollDataOut.retoQuestionPhrase="";return e},validateConfirmation:function(){var d=true;if($("#enrollConfirmationInput").val()!==$("#enrollAnswerInput").val()){b.tooltip.show("#confirmationTooltip");d&=false}else{b.tooltip.hide("#confirmationTooltip");c.enrollDataOut.retoQuestionPhrase=$("#enrollConfirmationInput").val();d&=true}return d},validateStep:function(){var d=b.currentStep;if(d===0){this.validatePhrase()}else{if(this.validateAnswer()&&this.validateConfirmation()&&this.validateQuestion()){b.activateButton()}else{b.deactivateButton()}}}},reset:function(){$(".progress-bar-container").attr("class","progress-bar-container");$("#wpp_enrolamientoWizard .modal-footer").removeClass("hide");$("#wpp_enrolamientoWizard .steps-container").css({left:0});this.deactivateButton();this.tooltip.hide("#answerTooltip");this.tooltip.hide("#confirmationTooltip");$("#enrollAnswerInput").val("");$("#enrollConfirmationInput").val("");$("#enrollPhraseInput").val("");$("#enrollQuestionInput").val("")},closeModal:function(){$("#wpp_enrolamientoWizard").fadeOut(800,function(){b.reset()})}};c.enrollmentController=b;$("#wpp_enrolamientoWizard .load-btn").on("click",function(){b.imageSelect.loadMoreImages()});$("#wpp_enrolamientoWizard .next-btn").on("click",function(){b.nextStep()});$("#wpp_enrolamientoWizard .hover-tooltip").on("mouseenter",function(){b.tooltip.show("#phraseTooltip")}).on("mouseleave",function(){b.tooltip.hide("#phraseTooltip")});$("#wpp_enrolamientoWizard .cancel-btn").on("click",function(){b.closeModal();$("#wpp_login").show();$("#btnCancelarloginPassword").click()});$("#btnIngresarAhora").click(function(d){$("#formBanorteId").submit()});$("#btnIngresarAhora2").click(function(d){$("#formBanorteId").submit()});$("#btnActivarAlertasEIngresar").click(function(d){c.activarAlertas(c)})}else{var a=c.enrollmentController;a.currentStep=1;a.clickInProgress=false;a.positions=[];a.classes=[]}},getOnlyUserImage:function(a){a.doAjaxS(urlServicioLogin,{servicio:"enrolamientoAAQueryImg",dataObj:"{}"},"text",function(c){try{var d=JSON.parse(c);var b=JSON.parse(d.data);console.log(b.images);a.enrollDataIn.svcData.images=b.images;a.loadEnrollImagesPage(a)}catch(f){}},function(c,d,b){})},activarAlertas:function(a){a.doAjaxS(urlServicioLogin,{servicio:"activarAlertas",dataObj:JSON.stringify({setAlertasFlow:"true"})},"text",function(b){try{var c=JSON.parse(b)}catch(d){}$("#formBanorteId").submit()},function(c,d,b){$("#formBanorteId").submit()})},cierraSesionCanal:function(a){a.doAjaxS(urlServicioLogin,{servicio:"cierreLgnSesionCanal",dataObj:"{}"},"text",function(b){try{var c=JSON.parse(b)}catch(d){}lockClickedButton=false},function(c,d,b){})},validatePnT:function(h,f,g){var b=false;if($("#passwordLogin").val()!=""){$("#idTooltipPassword").html("");b=true;if($("#tokenLogin").is(":visible")){b=false;var c=$("#tokenLogin").val();if((c!=null&&c!=undefined)&&c.length>4){b=true;$("#idTooltipPassword").html("").removeClass("password-tooltip").removeClass("token-tooltip").removeClass("token-celular-tooltip")}else{h.pd(f);$("#idTooltipPassword").removeClass("password-tooltip");if(tipoAutenticacion==18){$("#idTooltipPassword").addClass("token-tooltip")}else{if(tipoAutenticacion==19){$("#idTooltipPassword").addClass("token-celular-tooltip")}}$("#idTooltipPassword").html("<div class='boxed' ><div class='arrow'></div><div class='content'><p>Escribir token</p></div></div>");$("#tokenLogin").focus();$("#idTooltipPassword").show()}}if(b){g(h)}}else{var d="",a=$("#questionId").val();if((a!=null&&a!=undefined)&&a.length>0){d="respuesta"}else{d="contrase&ntilde;a"}h.pd(f);$("#idTooltipPassword").addClass("password-tooltip").html("<div class='boxed' ><div class='arrow'></div><div class='content'><p>Escribir su "+d+"</p></div></div>");$("#passwordLogin").focus();$("#idTooltipPassword").show()}},processAuthWT:function(c,b,a){console.log("processAuthWT: executing function ...");c.validatePnT(c,b,function(d){d.doAjaxS(urlServicioLogin,{servicio:"autenticaSimple",dataObj:JSON.stringify({rctpass:$("#passwordLogin").val(),rctkn:$("#tokenLogin").val(),modoRedirect:"C",flujoOrigen:"std"}),tipoAutenticacion:$("#tipoAutenticacion").val()},"text",function(j){try{j=JSON.parse(j);if(j!=null&&j!=undefined){console.log("processAuthWT: response exists!");d.auEmpresa=j.status;if(j.code==0){try{if(document.getElementById("flagBehavioWeb").value=="on"){console.log("Sending BehavioWeb Info...");bw.sendData()}else{console.log("Flag BehavioWeb off...")}}catch(h){console.log("Error sending BehavioWeb info...")}$("#formBanorteId").submit()}else{console.log("processAuthWT: cancel process!");console.log('processAuthWT: error message is "'+j.message+'"');if(j.message=="ENROLL"){d.showEnrolmentWz()}else{if(j.message=="CHALLENGE"){console.log("processAuthWT: show challenge form!!!");d.showChallengeForm()}else{if(j.message&&j.message.indexOf&&j.message.indexOf("SESIONSIMULTANEA==")>=0){console.log("JDLJ: Existing session from another channel!!!");var f=j.message.replace("SESIONSIMULTANEA==","");var g=JSON.parse(f);d.showConcurrentSessionPanel(g.canal,g.fecha,g.hora)}else{d.addToolTip(j.message,"#idTooltipPassword");$("#idTooltipPassword").show()}}}}}else{console.log("Error al procesar respuesta.")}}catch(k){console.log("error json")}lockClickedButton=false},function(f,g,e){console.log("Error auth simple para token celular")})})},processAuthKBA:function(c,b,a){console.log("processAuthKBA: executing function ...");c.validatePnT(c,b,function(h){var g=rtrim($("#questionId").val()+""," ");var e=rtrim($("#transactionId").val()+""," ");var f=rtrim($("#passwordLogin").val()+""," ");var d='{questionId: "'+g+'", transactionId: "'+e+'", challengeResponse: "'+f+'"}';console.log('$rctpass value is: "'+d+'"');h.doAjaxS(urlServicioLogin,{servicio:"autenticaSimple",dataObj:JSON.stringify({rctpass:d,rctkn:$("#tokenLogin").val(),modoRedirect:"C",flujoOrigen:"std"}),tipoAutenticacion:$("#tipoAutenticacion").val()},"text",function(k){try{k=JSON.parse(k);if(k!=null&&k!=undefined){console.log("processAuthWT: response exists!");h.auEmpresa=k.status;if(k.code==0){try{if(document.getElementById("flagBehavioWeb").value=="on"){console.log("Sending BehavioWeb Info...");bw.sendData()}else{console.log("Flag BehavioWeb off...")}}catch(j){console.log("Error sending BehavioWeb info...")}$("#formBanorteId").submit()}else{console.log("processAuthKBA: cancel process!");console.log('processAuthKBA: error message is "'+k.message+'"');h.addToolTip(k.message,"#idTooltipPassword");$("#idTooltipPassword").show()}}else{console.log("Error al procesar respuesta.")}}catch(l){console.log("error json")}lockClickedButton=false},function(k,l,j){console.log("Error auth simple para token celular")})})},getPVars:function(){var b=this;var a=bmnLgnFParams;if(a.pv1==""&&(a.pv1==a.pv2&&a.pv1==a.pv3)){}else{b.loadLoginDiferenciadoBxi(b,a)}},loadLoginDiferenciadoBxi:function(b,a){$(".widget_login .layout .login_box .content_box").hide();$(".widget_login_inside .layout .login_box .content_box").hide();$(".widget_login .layout .login_box .others_box").hide();$(".widget_login_inside .layout .login_box .others_box").hide();if(a.pv1!=""&&a.pv1!="null"){lightbox("open");$(".lightbox").css("z-index",90);loadExternalLogin(a.pv4,a.pv1);setTimeout(function(){$(".closePopup:first-child").click()},2222)}else{}},showConcurrentSessionPanel:function(c,b,a){var d=this;if(c){$("#inhibirSesionLabelCanal").text(c)}else{$("#inhibirSesionLabelCanal").text("Canal Banorte")}if(b){$("#inhibirSesionLabelFecha").text(b)}else{$("#inhibirSesionLabelFecha").text("dd-MM-aaaa")}if(a){$("#inhibirSesionLabelHora").text(a)}else{$("#inhibirSesionLabelHora").text("hh:mm:ss xm")}$("#pnlInhibirSesion").show();$("#btnCancelaInhibirSesion").on("click",function(f){console.log("JDLJ cancelar inhibir sesin");$("#btnCancelarloginPassword").click();d.hideConcurrentSessionPanel()});$("#btnInhibirSesion").on("click",function(f){console.log("JDLJ inhibir sesin simultanea");d.cierraSesionSimultanea(d,function(){d.hideConcurrentSessionPanel()})});$("#wpp_login").css("z-index","800");$("#beginChat").css("z-index","899")},hideConcurrentSessionPanel:function(){$("#pnlInhibirSesion").hide();$("#btnCancelaInhibirSesion").off();$("#btnCancelaInhibirSesion").off();$("#inhibirSesionLabelCanal").text("Canal Banorte");$("#inhibirSesionLabelFecha").text("dd-MM-aaaa");$("#inhibirSesionLabelHora").text("hh:mm:ss xm")},cierraSesionSimultanea:function(b,a){b.doAjaxS(urlServicioLogin,{servicio:"inhibirSesionSimultanea",dataObj:"{}"},"text",function(c){console.log(d);try{console.log("JDLJ inhibirSesionSimultanea");var d=JSON.parse(c);console.log(d);a();$("#btnAceptarloginPasswordAsync").click()}catch(f){console.log("JDLJ Error JSON inhibirSesionSimultanea")}},function(d,e,c){console.log("JDLJ Error inhibirSesionSimultanea")})},showChallengeForm:function(){var a=this;a.getChallengeQuestion()},getChallengeQuestion:function(){console.log("getChallengeQuestion: executing function ...");var c=this;var a=$("#userid").val();a=(a+"").replace(/["()\=; <>]/gi,"");var b=rtrim(a+""," ");c.doAjaxS(urlServicioLogin,{servicio:"remediacionRiesgo",usuario:b},"json",function(d){console.log("getChallengeQuestion: AJAX response: "+d);if(d.questionId!=undefined&&d.questionId!=""){console.log("getChallengeQuestion: SUCCESS - to load challenge question form");$(".content_box").hide();login_goto("login_challenge","homepage",true,d)}else{console.log("getChallengeQuestion: ERROR - no data retrieved");$("#btnCancelarloginPassword").click()}},function(e,f,d){console.log("getChallengeQuestion: thrownError - "+d)})}};var bmnLgnInstance=null;var loginDIV=".widget_login";var login2DIV=".widget_login_inside";var initialHeight=false;function tabFocusRestrictor(a,b){$(a).blur(function(){$(b).focus()})}function login_goto(a,f,d,c){var g="999";console.log("login_goto: $where: "+a);var b=login2DIV;if($(".widget_login").length>0){b=loginDIV}bmnLgnInstance.widgetDiv=b;$(b+" .content_box").css("opacity","0");if(f!=null&&f=="homepage"){$(b+" .content_box").hide();$(b+" .others_box").hide()}$(b+" .loading,"+b+" .gif").show().css("opacity","1");$(b+" .loading,"+b+" .gif").css("opacity","0");if(a=="login_tokenstep1"||a=="login_password"||a=="login_tokenstep2"||a=="login_userblocked"||a=="login_challenge"){if(a=="login_tokenstep2"){$(b+" .login_box").css("z-index",g).css({width:844,height:425});$(b+" ."+a).show().css("opacity","1")}else{if(a=="login_password"){$(b+" .login_box").css("z-index",g).css("height","400");bmnLgnInstance.showLoadingMask(true);$.ajax(contexto+"/jsp/modes/view/loginFormPassword.jsp",{type:"POST",success:function(k,l,j){$("#idFormaVentanaPassword").html(k);$(b+" ."+a).show();$(b+" ."+a).css("opacity","1");bmnLgnInstance.showLoadingMask(false);if(typeof c!="undefined"){console.log(c);$("#btnAceptarloginPasswordAsync").show();$("#btnAceptarloginPassword").hide();$("#btnAceptarloginPasswordAsync").click(function(m){bmnLgnInstance.processAuthWT(bmnLgnInstance,m,c)})}},dataType:"html"});if(d){$("#idTooltipPassword").html("");$("#idTooltipPassword").hide("")}}else{if(a=="login_challenge"){console.log("login_challenge: load form");$(b+" .login_box").css("z-index",g).css("height","400");bmnLgnInstance.showLoadingMask(true);$.ajax(contexto+"/jsp/modes/view/loginFormChallenge.jsp",{type:"POST",success:function(k,l,j){$("#idFormaVentanaPassword").html(k);$("#idFormaVentanaPassword").show();$("#idFormaVentanaPassword").css("opacity","1");bmnLgnInstance.showLoadingMask(false);if(typeof c!="undefined"){console.log('login_challenge: lngData value is "'+c.questionText+'"');$("#btnAceptarloginPasswordAsync").show();$("#btnAceptarloginPassword").hide();$("#pwdFormContainer div.avatar div.tooltip_area > label").text(c.questionText);$("#questionId").val(c.questionId);$("#transactionId").val(c.transactionId);$("#btnAceptarloginPasswordAsync").click(function(m){bmnLgnInstance.processAuthKBA(bmnLgnInstance,m,c)})}},dataType:"html"});if(d){$("#idTooltipPassword").html("");$("#idTooltipPassword").hide("")}}else{$(b+" .login_box").css("z-index",g).css("height","400");$(b+" ."+a).show().css("opacity","1")}}}if(f!=null&&f=="homepage"){lightbox("open")}if(a=="login_tokenstep1"){var e="."+a+" #codigoaprobacion";setTimeout(function(){$(e).focus()},100);tabFocusRestrictor(".submenu a",e)}if(a=="login_tokenstep2"){var e="."+a+" #enter_password";setTimeout(function(){$(e).focus()},100);tabFocusRestrictor("."+a+" button.cancelar + button",e)}if(a=="login_password"){var e="."+a+" input[type=password]";setTimeout(function(){$(e).focus()},100);tabFocusRestrictor(".submenu a",e)}if(a=="login_userblocked"){var e="."+a+" button";setTimeout(function(){$(e).focus()},100);tabFocusRestrictor(".submenu a",e)}if(a=="login_challenge"){var e="."+a+" input[type=password]";setTimeout(function(){$(e).focus()},100);tabFocusRestrictor(".submenu a",e)}}else{function h(){$(b+" .login_box").css("z-index","100").css({height:initialHeight,width:280});$(b+" ."+a).show().css({opacity:1});if(mostrarSeccionOtrasCuentas=="1"){$(b+" .others_box").show()}else{if(mostrarSeccionOtrasCuentas=="0"){$(b+" .others_box").hide()}else{$(b+" .others_box").show()}}bmnLgnInstance.showLoadingMask(false)}if(f!=null&&f=="homepage"){lightbox("close",h())}else{h()}}}function select_an_image(){var b=".select_an_image";var f=$(b+" .element:first-child").width();var e=$(b+" .element").length;var g=b+" .enless";var c=0;var a=b+" .controls";$(g).width(f*e);function d(h){if(h=="right"&&c<e){c=c+1;$(a+" .rowL").removeClass("disable")}if(h=="left"){c=c-1;$(a+" .rowR").removeClass("disable")}if(c==(e-1)){$(a+" .rowR").addClass("disable")}if(c==0){$(a+" .rowL").addClass("disable")}$(g).animate({left:(c*f)*-1})}$(a+" div").click(function(){var h=$(this).attr("data-action");if($(this).hasClass("disable")==false){d(h)}});$(g+" .element .avatar").click(function(){var h=$(this).attr("id");$("#input_avatar, #security_phrase").val(h)})}function otherbox(){var b=".widget_login .others_box";var a=b+" h1";var c=$(b).height();$(a).click(function(){if($(b).hasClass("empresas")==true){var d=$(b+" iframe").attr("src")}if($(b).hasClass("open")==true){$(b).animate({height:48},60,"easeOutCubic",function(){$(this).find(".content").hide();if($(b).hasClass("empresas")==true){$(b+" iframe").prop("src",d)}}).removeClass("open");$(b+" h1").animate({marginTop:0},60,"easeOutCubic")}else{$(".tooltip").hide();$(b+" .content").show();$(b).css("top","auto").css("bottom","0").show().animate({height:"100%"},80,"easeOutCubic").addClass("open");$(b+" h1").animate({marginTop:50},80,"easeOutCubic")}})}function enterKeyFunctions(){var a="button[type=submit]";$(".login_userblocked").keyup(function(b){console.log("keyup .login_userblocked");if(b.keyCode==27){if(typeof($parent)!=="undefined"&&$parent=="homepage"){login_goto("login_login","homepage")}else{login_goto("login_login")}}});$(loginDIV+" .login_userblocked button").click(function(){if(typeof($parent)!=="undefined"&&$parent=="homepage"){login_goto("login_login","homepage")}else{login_goto("login_login")}});$(".login_tokenstep1").keyup(function(b){if(b.keyCode==13){login_goto("login_tokenstep2","homepage")}else{if(b.keyCode==27){login_goto("login_login","homepage")}}});$(loginDIV+" .login_tokenstep1 "+a).click(function(){if($(this).hasClass("cancelar")==true){login_goto("login_login","homepage")}else{login_goto("login_tokenstep2","homepage")}});$(".login_tokenstep2").keyup(function(b){if(b.keyCode==13){login_goto("login_tokenstep1","homepage")}else{if(b.keyCode==27){}}});$(loginDIV+" .login_tokenstep2 "+a).click(function(){if($(this).hasClass("cancelar")==true){login_goto("login_login","homepage")}else{}})}function regresaInicio(){if(modoPortaljs=="modoSeparado"){window.location=actionBackPortalPublico}else{window.location=actionInicio}return false}function rtrim(b,a){for(i=b.length-1;i>=0;i--){if(a!=b.charAt(i)){b=b.substring(0,i+1);break}}return b}function validarEspacios(b,a){for(i=0;i<b.length;i++){if(a==b.charAt(i)){return"true";break}else{return"false";break}}return"false"}function validateU(a){if($("#userid").val().length>=5){$("#idTooltip").html("");a()}else{if($("#userid").val().length==0){$("#idTooltip").html("<div class='boxed' ><div class='arrow'></div><div class='content'><p>Escribir su usuario</p></div></div>")}else{if($("#userid").val().length<5){$("#idTooltip").html("<div class='boxed' ><div class='arrow'></div><div class='content'><p>Formato de usuario inv&aacute;lido</p></div></div>")}}}}function identificarUsuario(a){validateU(function(){bmnLgnInstance.showLoadingMask(true);var b=$("#userid").val();b=(b+"").replace(/["()\=; <>]/gi,"");var d=rtrim(b+""," ");var f=rtrim($("#portalOrigen").val()+""," ");var e=rtrim($("#rsaDeviceFso").val()+""," ");var c=rtrim($("#rsaDevicePrint").val()+""," ");if(validarEspacios(d," ")=="false"){$("#idBtnEntrar").prop("disabled",true);if(modoPortaljs=="publico"){console.log("redireccion a portal privado. ");console.log("action entrar:"+$("#formBanorteId").attr("action"));$("#formBanorteId").submit()}else{$.ajax({type:"POST",url:urlServicioLogin,dataType:"json",async:false,data:{servicio:"identificarUsuario",usuario:d,origen:f,rsaDeviceFso:e,rsaDevicePrint:c},success:function(g){$("#idBtnEntrar").prop("disabled",false);procesaIdentificarUsuario(g);bmnLgnInstance.showLoadingMask(false);bmnLgnInstance.isOnRequest=false},error:function(g,j,h){$("#idBtnEntrar").prop("disabled",false);bmnLgnInstance.showLoadingMask(false);bmnLgnInstance.isOnRequest=false}})}}else{console.log("hard datos incorrectos");bmnLgnInstance.showLoadingMask(false)}})}function procesaIdentificarUsuario(a){if(a.success=="true"){if(a.tipoOperacion=="datosUsuario"){if(a.datosUsuario.bloqueoNoUso=="1"){$("#customUserId").val("");$.ajax(contexto+"/jsp/modes/view/usuarioBloqueadoView.jsp",{async:false,cache:false,type:"POST",success:function(d,e,c){$("#mensajeBox").show();$("#mensajeBox").html(d);$("#bancaPersonal").hide()},dataType:"html"})}}else{if(a.tipoOperacion=="identificarUsuario"){$(".content_box").hide();login_goto("login_password","homepage",true,a)}}}else{if(a.success=="false"){if(a.tipoOperacion=="identificarUsuario"){var b=(a.identificarUsuario!=undefined)?a.identificarUsuario.mensajeAUsuario:a.mensaje;bmnLgnInstance.addToolTip(b,"#idTooltip")}}}return false}function loadExternalLogin(d,a){console.log("----------------> load external login (homepage)");console.log(d);console.log(a);$(bmnLgnVista=="home"?"div.headline":"div.logo_login").css("display","none");$("div.login_box").css("height","485px");var c=window.location.pathname.split("!ut");var b=(getHost()+c[0]);console.log(b);var e=$("<iframe>",{name:"frameExternalApp",id:"frameExternalApp",width:"280",height:"455",border:"0",style:"border:0"});$("#iframeExternalAppContainer").empty().append(e);$("#frameExternalApp").attr("width","280");$("#frameExternalApp").attr("height","510");var f=$("<form/>",{action:d,method:"post",target:"frameExternalApp",id:"formExternalApp"});f.append($("<input/>",{type:"hidden",value:a,name:"userField",id:"userField"}));f.append($("<input/>",{type:"hidden",value:b,name:"urlPortal",id:"urlPortal"}));if("PP_SAT"==bmnLgnPortal){f.append($("<input/>",{type:"hidden",value:"<%=LC%>",name:"LC",id:"LC"}));f.append($("<input/>",{type:"hidden",value:"<%=RFC%>",name:"RFC",id:"RFC"}));f.append($("<input/>",{type:"hidden",value:"<%=IM%>",name:"IM",id:"IM"}));f.append($("<input/>",{type:"hidden",value:"<%=ID%>",name:"ID",id:"ID"}));f.append($("<input/>",{type:"hidden",value:"<%=TP%>",name:"TP",id:"TP"}));f.append($("<input/>",{type:"hidden",value:"<%=SH%>",name:"SH",id:"SH"}))}f.append($("<input/>",{type:"submit",value:"Enviar",id:"submitExternalLogin"}));$("#submitExternalLogin").css("display","none");$("#formExternalAppContainer").empty();console.log(f);$("#formExternalAppContainer").append(f);$("#formExternalApp").submit();$("#iframeExternalAppContainer").css("display","inline");if(!bmnLgnInstance.isHomeViewMode()){$("#iframeExternalAppContainer").css("padding-left","18px");$("#iframeExternalAppContainer").css("position","absolute");$("#iframeExternalAppContainer").css("top","-60px")}}function unloadExternalLogin(){$(bmnLgnVista=="home"?"div.headline":"div.logo_login").css("display","none");$("div.login_box").css("height",bmnLgnVista=="home"?"362px":"0px");$("#iframeExternalAppContainer").empty();$("#iframeExternalAppContainer").removeAttr("style");$("#iframeExternalAppContainer").css("display","none");$("#formExternalAppContainer").empty();$("#formExternalAppContainer").removeAttr("style");$("#formExternalAppContainer").css("display","none");$("#idBtnEntrar").prop("disabled",false);$("#idTooltipPassword").html("");$errorLogin="";$("#userid").val("");$("#passwordLogin").val("");login_goto("login_login","homepage")}function getHost(){var b=window.location.hostname;var a=window.location.port;var c=window.location.protocol;if(a==null||a==""){return(c+"//"+b)}else{return(c+"//"+b+":"+a)}}$(function(){bmnLgnInstance=new BMNLgnCore({hAddr:bmnLgnRsaO1,ctxPath:contexto});initialHeight=$(loginDIV+" .login_box").height();$(loginDIV+" .login_login, "+login2DIV+" .login_login").show().css("opacity","1");select_an_image();otherbox();enterKeyFunctions();bmnLgnInstance.initByViewMode();bmnLgnInstance.getPVars();setTimeout(function(){$(".widget_login_inside:gt(0)").remove()},777)});function setUrlShort(c){var b="";if(c==""){b=$("#formBanorteId").attr("action")}else{b=b}var a=b.indexOf("Home")+4;b=b.substring(0,a);console.log("urlRetorno: "+b);$("#formBanorteId").attr("action",b)};