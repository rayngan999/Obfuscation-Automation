window._g=window._g||{};_g.shared={};void 0===window.console&&(window.console={log:function(b){}});_g.shared.HTTP=new function(){var b=function(){return{headers:{},body:{}}},c=function(a){if(!a)return null;var d=b();d.body=a.responseText;d.headers[_g.HTTP.HEADER_STATUS]=a.status;d.responseText=a.responseText;d.status=a.status;return d};return{EXTENSION_HTML:".html",EXTENSION_JSON:".json",EXTENSION_RES:".res",HEADER_STATUS:"Status",HEADER_MESSAGE:"Message",HEADER_LOCATION:"Location",HEADER_PATH:"Path",PARAM_NO_CACHE:"cq_ck",get:function(a,d,b,g){a=_g.HTTP.getXhrHookedURL(_g.HTTP.externalize(a,!0));if(void 0!=d)return _g.$.ajax({type:"GET",url:a,externalize:!1,encodePath:!1,hook:!1,complete:function(a,e){a=c(a);g||_g.HTTP.handleForbidden(a);d.call(b||this,this,"success"==e,a)}});try{var e=_g.$.ajax({type:"GET",url:a,async:!1,externalize:!1,encodePath:!1,hook:!1}),f=c(e);g||_g.HTTP.handleForbidden(f);return f}catch(k){return null}},post:function(a,d,b,c,h,f){a=_g.HTTP.externalize(a,!0);if(h=_g.HTTP.getXhrHook(a,"POST",b))a=h.url,b=h.params;if(void 0!=d)return _g.$.ajax({type:"POST",url:a,data:b,externalize:!1,encodePath:!1,hook:!1,complete:function(a,b){var e=_g.HTTP.buildPostResponseFromHTML(a.responseText);f||_g.HTTP.handleForbidden(a);d.call(c||this,this,"success"==b,e)}});try{var e=_g.$.ajax({type:"POST",url:a,data:b,async:!1,externalize:!1,encodePath:!1,hook:!1}),g=_g.HTTP.buildPostResponseFromHTML(e.responseText);f||_g.HTTP.handleForbidden(e);return g}catch(q){return null}},getParameter:function(a,d){a=_g.HTTP.getParameters(a,d);return null!=a?a[0]:null},getParameters:function(a,d){var b=[];if(!d)return null;d=encodeURIComponent(d);if(-1==a.indexOf("?"))return null;-1!=a.indexOf("#")&&(a=a.substring(0,a.indexOf("#")));a=a.substring(a.indexOf("?")+1);if(-1==a.indexOf(d))return null;a=a.split("\x26");for(var c=0;c<a.length;c++){var h=a[c].split("\x3d");h[0]==d&&b.push(1<h.length?decodeURIComponent(h[1]):"")}return 0<b.length?b:null},addParameter:function(a,d,b){if(b&&b instanceof Array){for(var c=0;c<b.length;c++)a=_g.HTTP.addParameter(a,d,b[c]);return a}c=-1==a.indexOf("?")?"?":"\x26";var e=a.indexOf("#");if(0>e)return a+c+encodeURIComponent(d)+"\x3d"+encodeURIComponent(b);var f=a.substring(e);a=a.substring(0,e);return a+c+encodeURIComponent(d)+"\x3d"+encodeURIComponent(b)+f},setParameter:function(a,d,b){a=_g.HTTP.removeParameter(a,d);return _g.HTTP.addParameter(a,d,b)},removeParameter:function(a,d){var b="?"+encodeURIComponent(d)+"\x3d";d="\x26"+encodeURIComponent(d)+"\x3d";if(-1==a.indexOf(b))if(-1!=a.indexOf(d))b=d;else return a;d=a.indexOf(b);b=a.substring(0,d);d=a.indexOf("\x26",d+1);var c="";-1!=d&&(c=a.substring(d),0==c.indexOf("\x26")&&(c=c.replace("\x26","?")));return b+c},removeParameters:Granite.HTTP.removeParameters,addSelector:function(a,d,b){b||(b=0);var c="",e=a.indexOf("?");-1==e&&(e=a.indexOf("#"));-1!=e&&(c=a.substring(e),a=a.substring(0,e));var f=a.lastIndexOf("/");e=a.substring(f);if(-1==e.indexOf("."+d+".")){a=a.substring(0,f);e=e.split(".");var k=f="";if(b>e.length-2||-1==b)b=e.length-2;for(var p=0;p<e.length;p++)f+=k+e[p],k=".",b==p&&(f+=k+d);return a+f+c}return a},setSelector:function(a,b,c){var d="",e=a.indexOf("?");-1==e&&(e=a.indexOf("#"));-1!=e&&(d=a.substring(e),a=a.substring(0,e));e=_g.HTTP.getSelectors(a);var f=a.substring(a.lastIndexOf("."));a=a.substring(0,a.lastIndexOf("."));a=0<e.length?a.replace("."+e.join("."),""):a;if(0<e.length)for(var k=0;k<e.length;k++)a=c==k?a+("."+b):a+("."+e[k]);else a+="."+b;return a+f+d},addSelectors:function(a,b){var d=a;if(a&&b&&b.length)for(a=0;a<b.length;a++)d=_g.HTTP.addSelector(d,b[a],a);return d},getAnchor:function(a){return-1!=a.indexOf("#")?a.substring(a.indexOf("#")+1):""},setAnchor:function(a,b){return _g.HTTP.removeAnchor(a)+"#"+b},removeAnchor:Granite.HTTP.removeAnchor,noCaching:function(a){return _g.HTTP.setParameter(a,_g.HTTP.PARAM_NO_CACHE,(new Date).valueOf())},buildPostResponseFromNode:function(a,d){if(!a)return null;void 0==d&&(d=b());for(var c=0;c<a.childNodes.length;c++){var g=a.childNodes[c];g.tagName&&(g.id&&(d.headers[g.id]=g.href?g.href:g.innerHTML),d=_g.HTTP.buildPostResponseFromNode(g,d))}return d},buildPostResponseFromHTML:function(a){var d=b();try{void 0!=a.responseText?a=a.responseText:"string"!=typeof a&&(a=a.toString());var c=document.createElement("div");c.innerHTML=a;d=_g.HTTP.buildPostResponseFromNode(c,d)}catch(g){}return d},getCookie:function(a){var b=encodeURIComponent(a)+"\x3d";a=document.cookie;if(0<a.length){var c=a.indexOf(b);if(-1!=c)return c+=b.length,b=a.indexOf(";",c),-1==b&&(b=a.length),decodeURIComponent(a.substring(c,b))}return null},setCookie:function(a,b,c,g,h,f){"number"!=typeof g&&(g=7);if(0<g){var d=new Date;d.setTime(d.getTime()+864E5*g)}else d=new Date(0);document.cookie=encodeURIComponent(a)+"\x3d"+encodeURIComponent(b)+"; "+(0!=g?"expires\x3d"+d.toGMTString()+"; ":"")+(h?"domain\x3d"+h+"; ":"")+(c?"path\x3d"+c:"")+(f?"; secure":"");return b},clearCookie:function(a,b,c,g){_g.HTTP.setCookie(a,"null",b||"",-1,c||"",g||"")},getSchemeAndAuthority:Granite.HTTP.getSchemeAndAuthority,getContextPath:Granite.HTTP.getContextPath,externalize:function(a,b){if("undefined"!=typeof G_IS_HOOKED&&G_IS_HOOKED(a))return a;b&&(a=_g.HTTP.encodePathOfURI(a));return a=Granite.HTTP.externalize(a)},internalize:Granite.HTTP.internalize,getPath:Granite.HTTP.getPath,getSuffix:function(){return window.CQURLInfo&&CQURLInfo.suffix?CQURLInfo.suffix:null},getSelectors:function(a){if(!a&&window.CQURLInfo&&CQURLInfo.selectors)return CQURLInfo.selectors;var b=[];a=a||window.location.href;a=_g.HTTP.removeParameters(a);a=_g.HTTP.removeAnchor(a);if(a=a.substring(a.lastIndexOf("/")))if(a=a.split("."),2<a.length)for(var c=0;c<a.length;c++)0<c&&c<a.length-1&&b.push(a[c]);return b},getExtension:function(a){if(!a&&window.CQURLInfo&&CQURLInfo.extension)return CQURLInfo.extension;a=a||window.location.href;a=_g.HTTP.removeParameters(a);a=_g.HTTP.removeAnchor(a);var b=a.lastIndexOf(".");if(0>b)return"";a=a.substring(b+1);b=a.indexOf("/");return 0>b?a:a.substring(0,b)},encodePathOfURI:Granite.HTTP.encodePathOfURI,encodePath:Granite.HTTP.encodePath,eval:Granite.HTTP.eval,isOkStatus:function(a){try{return 0==(new String(a)).indexOf("2")}catch(d){return!1}},isOk:function(a){try{return _g.HTTP.isOkStatus(a.headers[_g.HTTP.HEADER_STATUS])}catch(d){return!1}},handleForbidden:function(a,b){try{return 403==a[_g.HTTP.HEADER_STATUS.toLowerCase()]?(Granite.HTTP.handleLoginRedirect(),!0):!1}catch(e){return!1}},getXhrHook:Granite.HTTP.getXhrHook,getXhrHookedURL:function(a,b,c){return(b=_g.HTTP.getXhrHook(a,b,c))?b.url:a},reloadHook:function(a){"undefined"!=typeof G_RELOAD_HOOK&&_g.$.isFunction(G_RELOAD_HOOK)&&(""!=CQURLInfo.selectorString&&(a=_g.HTTP.addSelector(a,CQURLInfo.selectorString)),a=G_RELOAD_HOOK(a)||a);return a}}};_g.HTTP=_g.shared.HTTP;_g.shared.Util=new function(){return{reload:function(b,c,a){b||(b=window);c||(c=_g.HTTP.noCaching(b.location.href));c=_g.HTTP.reloadHook(c);a?b.location.replace(c):b.location.href=c},load:function(b,c){_g.Util.reload(window,b,c)},open:function(b,c,a,d){c||(c=window);if(b)return b=_g.HTTP.reloadHook(b),a||(a=""),d||(d=""),c.open(b,a,d)},htmlEncode:function(b){return b?String(b).replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;"):b},htmlDecode:function(b){return b?String(b).replace(/&gt;/g,"\x3e").replace(/&lt;/g,"\x3c").replace(/&quot;/g,'"').replace(/&amp;/g,"\x26"):b},ellipsis:function(b,c,a){if(b&&b.length>c){if(a){a=b.substr(0,c-2);var d=Math.max(a.lastIndexOf(" "),a.lastIndexOf("."),a.lastIndexOf("!"),a.lastIndexOf("?"),a.lastIndexOf(";"));return-1==d||d<c-15?b.substr(0,c-3)+"...":a.substr(0,d)+"..."}return b.substr(0,c-3)+"..."}return b},patchText:Granite.Util.patchText,eval:function(b){return _g.HTTP.eval(b)},getTopWindow:Granite.Util.getTopWindow,setIFrameMode:Granite.Util.setIFrameMode}};_g.Util=_g.shared.Util;_g.shared.Sling=function(){return{SELECTOR_INFINITY:Granite.Sling.SELECTOR_INFINITY,CHARSET:Granite.Sling.CHARSET,STATUS:Granite.Sling.STATUS,STATUS_BROWSER:Granite.Sling.STATUS_BROWSER,OPERATION:Granite.Sling.OPERATION,OPERATION_DELETE:Granite.Sling.OPERATION_DELETE,OPERATION_MOVE:Granite.Sling.OPERATION_MOVE,DELETE_SUFFIX:Granite.Sling.DELETE_SUFFIX,TYPEHINT_SUFFIX:Granite.Sling.TYPEHINT_SUFFIX,COPY_SUFFIX:Granite.Sling.COPY_SUFFIX,MOVE_SUFFIX:Granite.Sling.MOVE_SUFFIX,ORDER:Granite.Sling.ORDER,REPLACE:Granite.Sling.REPLACE,DESTINATION:Granite.Sling.DESTINATION,SAVE_PARAM_PREFIX:Granite.Sling.SAVE_PARAM_PREFIX,IGNORE_PARAM:Granite.Sling.IGNORE_PARAM,REQUEST_LOGIN_PARAM:Granite.Sling.REQUEST_LOGIN_PARAM,LOGIN_URL:Granite.Sling.LOGIN_URL,LOGOUT_URL:Granite.Sling.LOGOUT_URL,processBinaryData:function(b){if(b&&void 0!=b[":jcr:data"]){var c={};c.size=b[":jcr:data"];c.type=b["jcr:mimeType"];c.date=b["jcr:lastModified"];b=c}return b},getContentPath:function(b,c,a){c.lastIndexOf(".")>c.lastIndexOf("/")&&(c=c.substr(0,c.indexOf(".",c.lastIndexOf("/"))));if(b)if(0==b.indexOf("/"))c=b;else{if(a)for(;0==b.indexOf("../");)b=b.substring(3),c=c.substring(0,c.lastIndexOf("/"));b=b.replace("./","");c=c+"/"+b}return c}}}();_g.Sling=_g.shared.Sling;_g.shared.XSS=new function(){return{getXSSPropertyName:function(b){return b?_g.XSS.KEY_REGEXP.test(b)?b:b+_g.XSS.KEY_SUFFIX:""},getXSSRecordPropertyValue:function(b,c,a){var d="";b&&c&&(d=(d=b.get(this.getXSSPropertyName(c)))?d:this.getXSSValue(b.get(c)),a&&!isNaN(a)&&(d=_g.Util.ellipsis(d,a,!0)));return d},getXSSTablePropertyValue:function(b,c,a){var d="";b&&c&&(d=(d=b[this.getXSSPropertyName(c)])?d:this.getXSSValue(b[c]),a&&!isNaN(a)&&(d=_g.Util.ellipsis(d,a,!0)));return d},getXSSValue:function(b){return b?_g.Util.htmlEncode(b):""},updatePropertyName:function(b,c){b&&c&&b[c]&&b.xssProtect&&!b.xssKeepPropName&&(b[c]=this.getXSSPropertyName(b[c]))},xssPropertyRenderer:function(b,c,a,d){return d&&d.dataIndex&&a&&a.data&&a.data[this.getXSSPropertyName(d.dataIndex)]?(b=a.data[this.getXSSPropertyName(d.dataIndex)],d.ellipsisLimit&&!isNaN(d.ellipsisLimit)&&(b=_g.Util.ellipsis(b,d.ellipsisLimit,!0)),b):b?b:""}}};_g.XSS=_g.shared.XSS;_g.XSS.KEY_SUFFIX="_xss";_g.XSS.KEY_REGEXP=new RegExp(_g.XSS.KEY_SUFFIX+"$");_g.shared.I18n=Granite.I18n;_g.I18n=_g.shared.I18n;_g.shared.I18n.getMessage=Granite.I18n.get;_g.shared.I18n.getVarMessage=Granite.I18n.getVar;_g.shared.String=new function(){return{startsWith:function(b,c){return null==b||null==c?null==b&&null==c:c.length>b.length?!1:0==b.toString().indexOf(c.toString())},endsWith:function(b,c){if(null==b||null==c)return null==b&&null==c;if(c.length>b.length)return!1;b=b.toString();c=c.toString();return b.lastIndexOf(c)==b.length-c.length},contains:function(b,c){if(null==b||null==c)return!1;b=b.toString();c=c.toString();return 0<=b.indexOf(c)}}};_g.String=_g.shared.String;_g.shared.ClientSidePersistence=function(b){var c={PERSISTENCE_NAME:_g.shared.ClientSidePersistence.decoratePersistenceName("ClientSidePersistence"),config:{},cache:null,getMode:function(){return this.config.mode},getWindow:function(){return this.config.window||_g.shared.Util.getTopWindow()},debug:function(){if(console){for(var a=this.getMap(),b="[ClientSidePersistence -\x3e mode\x3d"+this.getMode().name+", container\x3d"+(this.config.container||"")+"]\n",c=0,h=new RegExp("^"+this.config.container+"/"),f=0,k=Object.keys(a).sort();f<k.length;f++){var p=k[f];if(!this.config.container||"string"!=typeof p||p.match(h)){var q=a[p];b+="-["+ ++c+"]-\x3e '"+p.replace(h,"")+"' \x3d '"+decodeURIComponent(q)+"'\n"}}c||(b+="(container is empty)");console.log(b)}},keyName:function(a){return(this.config.container?this.config.container+"/":"")+a},getKeys:function(){var a=this.getMap(),b=[];if(a)for(var c in a)this.config.container?0==c.indexOf(this.config.container+"/")&&(a=c.substring(this.config.container.length+1),b.push(a)):b.push(c);return b},get:function(a){return(a=this.getMap()[this.keyName(a)])?decodeURIComponent(a):a},set:function(a,b){a="string"===typeof a?a.replace(/:=/g,""):"";var c={key:a};a=this.keyName(a);if(a.length){var d=[],e=this.getMap();c.action=e[a]?"update":"set";b?e[a]=encodeURIComponent(b):(c.action="remove",delete e[a]);for(var k in e)d.push(k+":\x3d"+e[k]);this.cache=e;this.write(d.join("|"));_g.$.extend(c,{value:b,mode:this.getMode().name,container:this.config.container});_g.$(_g.shared.ClientSidePersistence).trigger(_g.shared.ClientSidePersistence.EVENT_NAME,c)}},getMap:function(){if(!this.cache||!this.config.useCache){for(var a=this.read().split("|"),b={},c=0;c<a.length;c++){var h=a[c].split(":\x3d"),f=h[0];f&&f.length&&(b[f]=h[1]||"")}this.cache=b}return this.cache},remove:function(a){this.set(a)},clearMap:function(){this.write()},read:function(){return this.config.mode.read(this)||""},write:function(a){this.config.mode.write(this,a||"")}};_g.$.extend(c.config,_g.shared.ClientSidePersistence.getDefaultConfig(),b);!1===c.config.useContainer&&(c.config.container=null);var a="test-"+Math.random();if(c.config.mode===_g.shared.ClientSidePersistence.MODE_SESSION){b=!1;try{window.sessionStorage.setItem(a,a),window.sessionStorage.removeItem(a)}catch(d){b=!0}b&&(c.config.mode=_g.shared.ClientSidePersistence.MODE_LOCAL)}if(c.config.mode===_g.shared.ClientSidePersistence.MODE_LOCAL){b=!1;try{window.localStorage.setItem(a,a),window.localStorage.removeItem(a)}catch(d){b=!0}b&&(c.config.mode=_g.shared.ClientSidePersistence.MODE_WINDOW)}return c};_g.shared.ClientSidePersistence.EVENT_NAME="ClientSidePersistence";_g.shared.ClientSidePersistence.MODE_SESSION={name:"session",read:function(b){return b.getWindow().sessionStorage.getItem(b.PERSISTENCE_NAME)},write:function(b,c){if(!Granite.OptOutUtil.isOptedOut())try{b.getWindow().sessionStorage.setItem(b.PERSISTENCE_NAME,c)}catch(a){}}};_g.shared.ClientSidePersistence.MODE_LOCAL={name:"local",read:function(b){return b.getWindow().localStorage.getItem(b.PERSISTENCE_NAME)},write:function(b,c){if(!Granite.OptOutUtil.isOptedOut())try{b.getWindow().localStorage.setItem(b.PERSISTENCE_NAME,c)}catch(a){}}};_g.shared.ClientSidePersistence.decoratePersistenceName=function(b){return b};_g.shared.ClientSidePersistence.MODE_WINDOW={name:"window",read:function(b){return b.getWindow().name},write:function(b,c){Granite.OptOutUtil.isOptedOut()||(b.getWindow().name=c)}};_g.shared.ClientSidePersistence.MODE_COOKIE={COOKIE_NAME:_g.shared.ClientSidePersistence.decoratePersistenceName("SessionPersistence"),name:"cookie",read:function(b){return _g.shared.ClientSidePersistence.CookieHelper.read(this.COOKIE_NAME)},write:function(b,c){if(!Granite.OptOutUtil.isOptedOut()||Granite.OptOutUtil.maySetCookie(this.COOKIE_NAME))c?_g.shared.ClientSidePersistence.CookieHelper.set(this.COOKIE_NAME,c,365):_g.shared.ClientSidePersistence.CookieHelper.erase(this.COOKIE_NAME)}};_g.shared.ClientSidePersistence.getDefaultConfig=function(){return{window:_g.shared.Util.getTopWindow(),useCache:!1,container:null,mode:_g.shared.ClientSidePersistence.MODE_LOCAL}};_g.shared.ClientSidePersistence.CookieHelper={set:function(b,c,a){var d="";a&&(d=new Date,d.setTime(d.getTime()+864E5*a),d="; expires\x3d"+d.toGMTString());c&&(c=encodeURIComponent(c));document.cookie=b+"\x3d"+c+d+"; path\x3d/"},read:function(b){b+="\x3d";for(var c=document.cookie.split(";"),a=0;a<c.length;a++){for(var d=c[a];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(b))return(b=d.substring(b.length,d.length))?decodeURIComponent(b):null}return null},erase:function(b){_g.shared.ClientSidePersistence.CookieHelper.set(b,"",-1)}};_g.shared.ClientSidePersistence.clearAllMaps=function(){_g.$.each([_g.shared.ClientSidePersistence.MODE_COOKIE,_g.shared.ClientSidePersistence.MODE_LOCAL,_g.shared.ClientSidePersistence.MODE_SESSION,_g.shared.ClientSidePersistence.MODE_WINDOW],function(b,c){(new _g.shared.ClientSidePersistence({mode:c})).clearMap()})};_g.I18n.init();window.CQ=window.CQ||{};CQ.shared=_g.shared;CQ.Sling=CQ.shared.Sling;CQ.I18n=CQ.shared.I18n;G_XHR_HOOK="undefined"!=typeof CQ_XHR_HOOK?CQ_XHR_HOOK:void 0;G_RELOAD_HOOK="undefined"!=typeof CQ_RELOAD_HOOK?CQ_RELOAD_HOOK:void 0;G_IS_HOOKED="undefined"!=typeof CQ_IS_HOOKED?CQ_IS_HOOKED:void 0;G_CONTENT_PATH="undefined"!=typeof CQ_CONTENT_PATH?CQ_CONTENT_PATH:void 0;CQ.shared.Form=function(){var b=function(){var a=parent.frames.ContentFrame,b={};a=(void 0!==a?a.contentDocument:document).getElementsByTagName("label");for(var c=0;c<a.length;c++){var d=a[c].htmlFor;d&&(b[d]=a[c])}return b},c=function(a){var b="",c=function(a){3==a.nodeType&&(b+=a.nodeValue);if("select"!=a.nodeName.toLowerCase()&&"input"!=a.nodeName.toLowerCase()&&"textarea"!=a.nodeName.toLowerCase()&&"button"!=a.nodeName.toLowerCase())for(var d=0;a.childNodes&&d<a.childNodes.length;d++)c(a.childNodes[d])};c(a);return b},a=function(a){var b,c=a.nodeName.toLowerCase(),e=d(a,"type")?a.getAttribute("type"):void 0;"input"==c?"radio"==e||"checkbox"==e?d(a,"checked")&&(b=a.getAttribute("value")):b="text"==a.type?a.defaultValue:a.value:"textarea"==c?b=a.value:"option"==c&&d(a,"selected")&&(b=a.getAttribute("value"));return b},d=function(a,b){return null==a?!1:void 0!=$CQ(a).attr(b)};return{searchArray:function(a,b,c){for(var d=0;d<a.length;d++)if(a[d][b]&&a[d][b]==c)return a[d];return null},getLabelForField:function(a,d){d||(d=b());var e=a.getAttribute("id");if(e&&d[e])return c(d[e]);for(d=a.parentNode;d;){if("label"==d.nodeName.toLowerCase())return c(d);d=d.parentNode}return a.getAttribute("name")},getFields:function(){var e=parent.frames.ContentFrame;e=void 0!==e?e.contentDocument:document;var g=b(),h=[],f=function(e,p,q){"div"==e.nodeName.toLowerCase()&&0<$CQ(e).children(".form_row").length&&(p=!0,q=$CQ(e).attr("class").replace(/\s/g,"."));if(e.getAttribute&&e.getAttribute("name")){var l=p,k=q,m=e.getAttribute("name"),r=e.nodeName.toLowerCase();if("input"==r||"textarea"==r){var t=d(e,"type")?e.getAttribute("type").toLowerCase():"text";if("button"!=t&&"submit"!=t&&"reset"!=t){var n=CQ.shared.Form.searchArray(h,"value",m);n||(h.push({text:CQ.shared.Form.getLabelForField(e,g),value:m,name:m,enumeration:void 0,local:l,selector:k,type:r,defaultValue:a(e),node:e}),n=h[h.length-1]);if("radio"==t||n.local&&"checkbox"==t)n.enumeration||((l=e.getAttribute("id"))?(l=l.replace(/-\d+$/,""),(k=g)||(k=b()),l=k[l]?c(k[l]):null,n.text=l?l:m):n.text=m,n.enumeration=[]),n.enumeration.push({text:CQ.shared.Form.getLabelForField(e,g),value:e.getAttribute("value"),defaultValue:a(e),node:e})}}else if("select"==r)for(h.push({text:CQ.shared.Form.getLabelForField(e,g),value:m,name:m,enumeration:[],local:l,type:r,selector:k,defaultValue:void 0,node:e}),n=h[h.length-1],m=e.getElementsByTagName("option"),l=0;l<m.length;l++)n.enumeration.push({text:m[l].innerHTML,value:m[l].getAttribute("value"),defaultValue:a(m[l]),node:m[l]})}for(n=0;e.childNodes&&n<e.childNodes.length;n++)m=e.childNodes[n],1==m.nodeType&&f(m,p,q)};f(e,!1,void 0);return h}}}();CQ.shared.User=function(b){return{data:null,language:null,userPropsPath:null,getUserPropsUrl:function(){this.userPropsPath||(this.userPropsPath=CQ.shared.User.PROXY_URI);return this.userPropsPath},load:function(){var b=this.getUserPropsUrl();b=CQ.shared.HTTP.noCaching(b);b=CQ.shared.HTTP.get(b);CQ.shared.HTTP.isOk(b)&&(this.data=CQ.shared.Util.eval(b))},init:function(b,a){if(!this.initialized||a)b?this.data=b:this.load(),this.initialized=!0;return this.data},lazyInit:function(){this.lazyLoad=function(){this.load();this.initialized=!0}},isInitialized:function(){return this.initialized},getLanguage:function(){!this.isInitialized()&&this.lazyLoad&&this.lazyLoad.call(this);return this.language=this.data&&this.data.preferences&&this.data.preferences.language?this.data.preferences.language:"en"}}}();CQ.shared.User.PROXY_URI=CQ.shared.HTTP.externalize("/libs/cq/security/userinfo"+CQ.shared.HTTP.EXTENSION_JSON);CQ.shared.User.lazyInit();CQ.shared.I18n.init({locale:function(){return document.documentElement.lang||CQ.shared.User.getLanguage()},urlPrefix:"/libs/cq/i18n/dict."});