define("components/nonBookableProductWidget",["FR","jquery","underscore","components/bookingWidgetHelper"],function(n,o,e,t){var r={},a="input-validation-error",d=null,_=function(n){var o={startDate:i(n).date()},t=u(n);e.isUndefined(t)||(o.endDate=t.date());var r=l(n);e.isUndefined(r)||(o.totalAdults=r);var a=c(n);return e.isUndefined(a)||(o.totalChildren=a),o},i=function(n){return n.find(".non_bookable_product__date_picker__pick_up .datePicker .date").data("DateTimePicker")},u=function(n){if(n.find(".non_bookable_product__date_picker__return").length)return n.find(".non_bookable_product__date_picker__return .datePicker .date").data("DateTimePicker")},l=function(n){if(n.find(".non_bookable_product__number_adults").length)return n.find(".non_bookable_product__number_adults").find("input").val()},c=function(n){if(n.find(".non_bookable_product__number_children").length)return n.find(".non_bookable_product__number_children").find("input").val()},p=function(n){var o=n.parents(".non_bookable_product"),e=o.find(".non_bookable_product__error--invalidPickUpDate"),t=o.find(".non_bookable_product__date_picker__pick_up input");e.html(r.pickUpDateError.data("error-invalid")).addClass("field-validation-error").show(),t.addClass(a)},b=function(n){var o=n.parents(".non_bookable_product"),e=o.find(".non_bookable_product__error--invalidReturnDate"),t=o.find(".non_bookable_product__date_picker__return input");e.html(r.returnDateError.data("error-invalid")).addClass("field-validation-error").show(),t.addClass(a)},k=function(n){var o=n.parents(".non_bookable_product"),e=o.find(".non_bookable_product__error--invalidPickUpDate"),t=o.find(".non_bookable_product__date_picker__pick_up input"),r=o.find(".non_bookable_product__error--invalidReturnDate"),d=o.find(".non_bookable_product__date_picker__return input");e.removeClass("field-validation-error").hide(),t.removeClass(a),r.removeClass("field-validation-error").hide(),d.removeClass(a)},s=function(n,o){var t=n.data("date-format"),r=n.attr("data-url").replace("{START_DATE}",encodeURIComponent(o.startDate.format(t)));return e.isEmpty(o.endDate)||(r=r.replace("{END_DATE}",encodeURIComponent(o.endDate.format(t)))),e.isEmpty(o.totalAdults)||(r=r.replace("{ADULTS_NUMBER}",encodeURIComponent(o.totalAdults))),e.isEmpty(o.totalChildren)||(r=r.replace("{CHILDREN_NUMBER}",encodeURIComponent(o.totalChildren))),r},f=function(n){return n.parents(".non_bookable_product")},m=function(){r.datePickers.on("dp.change dp.error",function(n){var e=o(n.currentTarget),t=f(e),r=o(this);k(r),function(n){var o=i(n),e=u(n),t=o.date();null!=t&&(t=t.add(1,"days"),e.minDate(t),o.date()>=e.date()&&e.date(t))}(t)}),r.submitButton.on("click",function(r){r.preventDefault(),d=o(r.currentTarget);var i=f(d),u=_(i),l=o(this);if(k(l),function(n,o,t){!e.isEmpty(n)&&n.isValid()||p(t),!e.isEmpty(o)&&o.isValid()||b(t)}(u.startDate,u.endDate,l),function(n,o){var t=o.parents(".non_bookable_product"),r=t.find(".non_bookable_product__date_picker__pick_up input"),d=t.find(".non_bookable_product__date_picker__return input");return!r.hasClass(a)&&(e.isUndefined(n.endDate)||!d.hasClass(a))}(u,l)){var c=function(n){return n.next(".non_bookable_product_modal_template")}(i);0!=c.length?n.$el.window.trigger("non-bookable-product-modal-open",[c]):window.open(s(d,u),d.data("target")||"_self")}else{var m=o(this).parents(".non_bookable_product");t.errorMsgShown(m)}t.setStartDateInSession(u.startDate)}),n.$el.window.on("non-bookable-product-modal-submit",function(){var n=f(d),o=_(n);window.open(s(d,o),d.data("target")||"_blank")})},v=function(){r.nonBookableProduct=o(".non_bookable_product"),r.datePickers=r.nonBookableProduct.find(".non_bookable_product__date_picker"),r.pickUpDate=r.nonBookableProduct.find(".non_bookable_product__date_picker__pick_up"),r.pickUpDateInput=r.nonBookableProduct.find(".non_bookable_product__date_picker__pick_up input"),r.pickUpDateError=r.nonBookableProduct.find(".non_bookable_product__error--invalidPickUpDate"),r.returnDate=r.nonBookableProduct.find(".non_bookable_product__date_picker__return"),r.returnDateInput=r.nonBookableProduct.find(".non_bookable_product__date_picker__return input"),r.returnDateError=r.nonBookableProduct.find(".non_bookable_product__error--invalidReturnDate"),r.submitButton=r.nonBookableProduct.find(".non_bookable_product__submit_button"),e.delay(m,250)};o(function(){return n.onDatePickersReady(v)})});
//# sourceMappingURL=nonBookableProductWidget.js.map
