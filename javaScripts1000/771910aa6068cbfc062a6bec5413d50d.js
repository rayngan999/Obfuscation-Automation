(function(){'use strict';window.addEventListener('popstate',function(event){if(event.state&&event.state.raven){window.location.reload();}},false);})();jQ(function(){if(typeof basicHTML=='undefined'){var bodyElement=jQ('body');if(webshop.common.Util.isScreenBigEnoughToFix()){bodyElement.removeClass('notFixed');}else{jQ('a.bookmark').removeClass('bookmark');}
jQ('input, textarea').placeholder();jQ('.tipped').popout();jQ('#rating').popout({iconMarkup:'<img src="/webshop/static/images/icons/ratingsSnapshot.gif" alt="Ratings snapshot" title="Ratings snapshot" class="snapshot" />'});if(jQ('.ratingsSummary .ratingOutOf').length>0){var span=jQ('<span></span>');jQ('.ratingsSummary .ratingOutOf').prepend(span);jQ('.ratingsSummary .ratingOutOf span').filter(':first').popout({iconMarkup:'<img src="/webshop/static/images/icons/ratingsSnapshot.gif" alt="Ratings snapshot" title="Ratings snapshot" class="snapshot" />'});}
if(jQ("ul.bopTabs").length!=0){registerTabs();}
var nextAvailableSlot=jQ("#nextAvailableSlotDate");if(nextAvailableSlot.length!==0){jQ.ajax({url:'/webshop/getNextAvailableSlot.do',data:{ajax:true},success:function(json){if(json&&json.nextAvailableDeliveryDateTime){nextAvailableSlot.html("<strong>"+json.nextAvailableDeliveryDateTime+"</strong>");nextAvailableSlot.parent().css('visibility','');}}});}}});function registerTabs(){jQ('ul.bopTabs').on('click','a',function(){var $this=jQ(this),$parent=$this.parent();if($parent.hasClass('currentTab')){return false;}
jQ('body').trigger('disposePopout');$parent.siblings('.currentTab').removeClass('currentTab');$parent.addClass('currentTab');$parent.parent().siblings('.tabContent').hide();jQ("#"+$this.attr('id')+"Content").show();return false;});}
function redirectUser(url){var url=webshop.ajax.Util.cleanTextValue(url);url=(url.indexOf('http://')===0||url.indexOf('https://')===0)?url:application.url+url;window.top.location.href=url;}
if(!jQ.support.htmlSerialize&&!jQ.support.opacity){jQ('.clubPaymentHistory tr').each(function(){jQ('td:last',this).css('background','none');});}
if(!window.location.origin){window.location.origin=window.location.protocol+"//"+window.location.hostname
+(window.location.port?':'+window.location.port:'');}
var webshop=webshop||{};webshop.carousel=webshop.carousel||{};webshop.carousel={start:function(options){var config={containerSelector:'#carousel-container',carouselSelector:'.js-carousel',carouselViewSelector:'.js-viewport'};_.assign(config,options);this.config=config;this.jqObjs={};this.resize();jQ(window).on('resize',function(){webshop.carousel.addControls();});},refreshCache:function(){this.jqObjs.carouselWrap=jQ(this.config.containerSelector);this.jqObjs.carousel=jQ(this.jqObjs.carouselWrap.find(this.config.carouselSelector));this.jqObjs.carouselView=jQ(this.jqObjs.carouselWrap.find(this.config.carouselViewSelector));},resize:function(){this.refreshCache();var itemNo=this.jqObjs.carousel.children().length;if(itemNo>0){this.itemWidth=this.jqObjs.carousel.children('li:first-child').outerWidth(true);this.carouselWidth=Math.round(itemNo*this.itemWidth);this.jqObjs.carouselWrap.removeClass('hideJS');this.jqObjs.carousel.css('width',this.carouselWidth+'px');this.viewWidth=this.getViewWidth();if(this.carouselWidth>this.viewWidth){this.addControls();}}else{this.jqObjs.carouselWrap.addClass('hideJS');}},addControls:function(){var nextButton=this.jqObjs.carouselWrap.find('.next'),prevButton=this.jqObjs.carouselWrap.find('.previous'),margin=parseInt(this.jqObjs.carousel.css('margin-left'),10);this.minMargin=this.getRegWidth(-(this.carouselWidth-this.getRegWidth(this.viewWidth)),true);this.viewWidth=this.getViewWidth();if(margin>=this.minMargin&&nextButton.hasClass('disabled')){nextButton.on('click',this.next.bind(this));nextButton.removeClass('disabled');}else if(margin<=this.minMargin){this.removeControl(nextButton);};if(margin<0&&prevButton.hasClass('disabled')){prevButton.on('click',this.previous.bind(this));prevButton.removeClass('disabled');}else if(margin>=0){this.removeControl(prevButton);};},next:function(){var margin=parseInt(this.jqObjs.carousel.css('margin-left'),10)-this.itemWidth;if(margin<this.minMargin){margin=this.minMargin;}else{margin=this.getRegWidth(margin);};this.setMargin(margin);},previous:function(){var margin=parseInt(this.jqObjs.carousel.css('margin-left'),10)+this.itemWidth;if(margin>0){margin=0;}else{margin=this.getRegWidth(margin,true);};this.setMargin(margin);},getViewWidth:function(){return this.jqObjs.carouselView.outerWidth(false);},getRegWidth:function(width,isCeiling){var isCeiling=isCeiling;if(isCeiling){var regWidth=Math.ceil(Math.abs(width)/this.itemWidth)*this.itemWidth;}else{var regWidth=Math.floor(Math.abs(width)/this.itemWidth)*this.itemWidth;}
if(width<0){return-regWidth;}else{return regWidth;};},setMargin:function(margin){this.jqObjs.carousel.animate({'margin-left':margin+'px'},200,function(){webshop.carousel.addControls();});},removeControl:function(control){control.off('click');control.addClass('disabled');}};jQ(function(){if(typeof basicHTML=='undefined'){jQ('body').on('click','.js-noDuplicateRequest',function(event){var $this=jQ(this);if($this.data('clicked')){event.preventDefault();event.stopPropagation();}else{$this.data('clicked',true);}});}});webshop.common=webshop.common||{};webshop.common.Abbreviate={_abbreviateWithTail:function(str,maxLength){if(str==null||maxLength<0){return str;}
if(str.length<=maxLength){return str;}
var head=str.substring(0,maxLength/2);var tail=str.substring(str.length-maxLength/2);return head+'...'+tail;},_abbreviate:function(str,maxLength){if(str==null||maxLength<0){return str;}
if(str.length<=maxLength){return str;}
var head=str.substring(0,maxLength);return head+'...';},abbreviateTextInContainer:function(str,strContainer,testContainer,maxHeight,useTail){strContainer.text(str);if(testContainer.offsetHeight<=maxHeight){return false;}
var left=0;var right=str.length;while(right>0&&(testContainer.offsetHeight>maxHeight||(right-left>1))){var next=Math.floor((left+right)/2);var text=useTail?webshop.common.Abbreviate._abbreviateWithTail(str,next):webshop.common.Abbreviate._abbreviate(str,next);strContainer.text(text);if(testContainer.offsetHeight>maxHeight){right=next-1;}else{left=next;}}
return true;}};(function(factory){if(typeof define==='function'&&define.amd){define(factory);}else if(typeof exports==='object'){module.exports=factory();}else{var _OldCookies=window.Cookies;var api=window.Cookies=factory();api.noConflict=function(){window.Cookies=_OldCookies;return api;};}}(function(){function extend(){var i=0;var result={};for(;i<arguments.length;i++){var attributes=arguments[i];for(var key in attributes){result[key]=attributes[key];}}
return result;}
function init(converter){function api(key,value,attributes){var result;if(arguments.length>1){attributes=extend({path:'/'},api.defaults,attributes);if(typeof attributes.expires==='number'){var expires=new Date();expires.setMilliseconds(expires.getMilliseconds()+attributes.expires*864e+5);attributes.expires=expires;}
try{result=JSON.stringify(value);if(/^[\{\[]/.test(result)){value=result;}}catch(e){}
value=encodeURIComponent(String(value));value=value.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent);key=encodeURIComponent(String(key));key=key.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent);key=key.replace(/[\(\)]/g,escape);return(document.cookie=[key,'=',value,attributes.expires&&'; expires='+attributes.expires.toUTCString(),attributes.path&&'; path='+attributes.path,attributes.domain&&'; domain='+attributes.domain,attributes.secure?'; secure':''].join(''));}
if(!key){result={};}
var cookies=document.cookie?document.cookie.split('; '):[];var rdecode=/(%[0-9A-Z]{2})+/g;var i=0;for(;i<cookies.length;i++){var parts=cookies[i].split('=');var name=parts[0].replace(rdecode,decodeURIComponent);var cookie=parts.slice(1).join('=');if(cookie.charAt(0)==='"'){cookie=cookie.slice(1,-1);}
try{cookie=converter&&converter(cookie,name)||cookie.replace(rdecode,decodeURIComponent);if(this.json){try{cookie=JSON.parse(cookie);}catch(e){}}
if(key===name){result=cookie;break;}
if(!key){result[name]=cookie;}}catch(e){}}
return result;}
api.get=api.set=api;api.getJSON=function(){return api.apply({json:true},[].slice.call(arguments));};api.defaults={};api.remove=function(key,attributes){api(key,'',extend(attributes,{expires:-1}));};api.withConverter=init;return api;}
return init();}));webshop.common=webshop.common||{};webshop.common.Recommendations={init:function(){this.requestRecommendations();this.registerHideRecommendations();},requestRecommendations:function(){var recsSidebar=jQ('#recsSidebar');if(recsSidebar.length>0){jQ.ajax({url:document.URL,data:{ajax:true,recommendations:"true",pageViewId:webshop.common.jsTopBodyVariables.pageViewId,recsPT:jQ('#recsPT').val()},success:function(itemsContainer){if(itemsContainer.match('productList')){recsSidebar.append(itemsContainer).fadeIn("slow",function(){recsSidebar.removeClass("isHidden");});jQ(document.body).trigger('webshop:gtm:newProductsLoaded')}}});}},registerHideRecommendations:function(){var sidebarSuggestions=jQ('#sideBarCustomerSuggestions');sidebarSuggestions.on('click','a.hideRecommendation',function(){var itemToRemove=jQ(this).parents(".product");var cross=itemToRemove.find('.hideRecommendation');var href=cross.attr('href');cross.remove();jQ.ajax({url:href,data:{ajax:true},success:function(itemToAdd){webshop.common.Recommendations.addSidebarSuggestion(itemToAdd,sidebarSuggestions);webshop.common.Recommendations.removeSidebarSuggestion(itemToRemove,sidebarSuggestions);}});return false;});},addSidebarSuggestion:function(itemToAdd,sidebarSuggestions){if(itemToAdd.match('productDetails')){sidebarSuggestions.append(itemToAdd);sidebarSuggestions.children().last().fadeIn('slow');}},removeSidebarSuggestion:function(itemToRemove,sidebarSuggestions){if(sidebarSuggestions.children().length<=2){this.removeSuggestionsContainer(sidebarSuggestions);}else{itemToRemove.fadeOut('slow',function(){itemToRemove.remove();webshop.common.Recommendations.removeLastItemCSSClass(sidebarSuggestions);});}},removeLastItemCSSClass:function(sidebarSuggestions){var lastItem=sidebarSuggestions.children().last();sidebarSuggestions.children().not(lastItem).removeClass('last');lastItem.addClass('last');},removeSuggestionsContainer:function(sidebarSuggestions){sidebarSuggestions.fadeOut('slow',function(){sidebarSuggestions.remove();});}};webshop=window.webshop||{};webshop.common=webshop.common||{};webshop.common.Util={checkTypes:function(args,expectedTypes){for(var i=0;i<args.length;i++){this.checkType(args[i],expectedTypes[i]);}
return true;},checkType:function(argument,expectedType){if(expectedType===Event&&argument){Event.stop(argument);}
return true;},getSmallLoadingIcon:function(id){this.checkType(id,String);var image=new Element('img',{'src':application.url+'/static/images/icons/loading/order.gif','id':id,'style':'vertical-align: middle; display: inline'});return image;},getInlineLoadingText:function(text,options){this.checkType(text,String);options=Object.extend({id:'loadingSpan'},options||{});var loadingIcon=this.getSmallLoadingIcon('loadingIcon');var span=new Element('span',{id:options.id}).insert("<strong style=\"padding-top:2px\">"+text+"</strong>&nbsp;&nbsp;").insert(loadingIcon);return span;},updateText:function(element,text,options){this.checkTypes(arguments,[Element,String]);options=Object.extend({queue:'end'},options||{});if(element){if(element.empty()||element.getOpacity()!==1){element.setStyle('display: block;').setOpacity(0);element.update(text);element.fade({from:0,to:1,duration:0.5,queue:options.queue});}else{element.fade({from:1,to:0,duration:0.5,queue:options.queue,afterFinish:function(element){element.update(text);element.setStyle('display: block;').setOpacity(0);element.fade({from:0,to:1,duration:0.5,queue:options.queue});}.curry(element)});}}},preloadImage:function(src){var img=new Image();img.src=src;return img;},setHash:function(value){var url=window.top.location.href;if(url.indexOf('#')!==-1){url=url.substring(0,url.indexOf('#'));}
window.top.location.href=url+"#"+value;},parseDate:function(dateString){if(!dateString){return null;}
var parts=dateString.split("-");var date=new Date(0);var year=parts[0];var month=parseInt(parts[1]);if(month<10){month=parseInt(parts[1].replace('0',''))-1;}else{month=month-1;}
var day=parseInt(parts[2]);date.setUTCFullYear(year,month,day);return date.stripTime();},toISOString:function(levels){var month=this.getMonth()+1<10?"0"+(this.getMonth()+1):(this.getMonth()+1);var date=this.getDate()<10?"0"+this.getDate():this.getDate();switch(levels){case 1:return this.getFullYear();case 2:return this.getFullYear()+"-"+month;case 3:return this.getFullYear()+"-"+month+"-"+date;default:return this.getFullYear()+"-"+month+"-"+date;}},stripTime:function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this;},cloneDate:function(){return new Date(this.getTime());},getMonthName:function(){switch(this.getMonth()){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December";default:return"";};},displayHelper:function(helper,text,elementName){if(helper&&text&&elementName){helper.update(text);helper.show().clonePosition(elementName,{setWidth:false,setHeight:false,setLeft:false,offsetTop:-10});}},encodeDescription:function(desc){return desc.replace(/\W+/g,'-').replace(/(^-+|-+$)/g,'');},startsWith:function(string,prefix){return string.substr(0,prefix.length)===prefix;},isPushStateSupported:function(){return!!(window.history&&window.history.pushState);},isScreenBigEnoughToFix:function(){return jQ(window).height()>600&&jQ(window).width()>920;},isIPad:function(){return navigator.userAgent.indexOf("iPad")!=-1;},isIOS:function(){return!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i)||!!navigator.userAgent.match(/iPod/i);},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);},_hoverSelectorSupported:null,isHoverSelectorSupported:function(){if(this._hoverSelectorSupported===null){this._hoverSelectorSupported=false;if(document.querySelector){try{document.querySelector('body:hover');this._hoverSelectorSupported=true;}catch(_e){}}}
return this._hoverSelectorSupported;},_pointerEventsSupported:null,isPointerEventsSupported:function(){if(this._pointerEventsSupported===null){var element=document.createElement('x');element.style.cssText='pointer-events:auto';return element.style.pointerEvents==='auto';}
return this._pointerEventsSupported;},displayAddedMessage:function(message,duration){var $span=jQ('#addedMessage span'),addedMessage=$span.parent(),wrapper=addedMessage.parent(),messageHeight,clonedAddedMessage;if(message){$span.html(message);}
messageHeight=addedMessage.outerHeight(true);addedMessage.css('top',-messageHeight).hide();clonedAddedMessage=addedMessage.clone(false);addedMessage.remove();wrapper.prepend(clonedAddedMessage);clonedAddedMessage.show().delay(100).animate({top:10},500).delay(duration?duration:3500).animate({top:-messageHeight},500).delay(500).hide(1);},mySupermarketControl:function(evt){var screenDimensions={left:(window.screenLeft)?window.screenLeft:window.screenX,top:(window.screenTop)?window.screenTop:window.screenY},mySupermarketWindow={};evt.preventDefault();mySupermarketWindow=window.open(this.href,'popup','height=462,width=662,scrollbars=no,resizeable=no,toolbar=no,directories=no,menubar=no,status=no'+',top='+(screenDimensions.top+((window.innerHeight/2)-231))+',left='+(screenDimensions.left+((window.innerWidth/2)-331)));}};(function(Backbone){'use strict';Backbone.Webshop.mixins.isCheckout=function(){return Boolean(webshop.common.jsVariables.get('isCheckout'));};})(Backbone);var AjaxController=function(delay){this.xhr=null;this.timeout=null;this.delay=!isNaN(delay)?delay:500;};AjaxController.prototype.send=function(options){var that=this;if(this.timeout){clearTimeout(this.timeout);}
this.timeout=setTimeout(function(){that.xhr=jQuery.ajax(options);},this.delay);};AjaxController.prototype.getXhr=function(){return this.xhr;};webshop.ajax=webshop.ajax||{};webshop.ajax.Util={init:function(){var _ajax=jQuery.ajax;jQuery.extend({ajax:function(settings){if(settings.dataType!='jsonp'){settings.url=webshop.ajax.Util.getUrlWithPageProtocol(settings.url);}
return _ajax.call(this,settings);}});jQ(document).ajaxSend(function(e,xhr,settings){application.activeRequestFlag=true;});jQ(document).ajaxStop(function(e,xhr,settings){application.activeRequestFlag=false;});jQ(document).ajaxComplete(function(e,xhr,ajaxOptions){if(typeof(xhr)!=='undefined'&&webshop.ajax.Util.isJsonResponse(xhr.getAllResponseHeaders())){try{var response=JSON.parse(xhr.responseText);}catch(e){}
webshop.ajax.Util.redirectIfNecessary(response,ajaxOptions);}});jQ.ajaxSetup({data:{pageViewId:webshop.common.jsTopBodyVariables.pageViewId,fromNonResponsivePage:true},cache:false});},isJsonResponse:function(allHeaders){return allHeaders.indexOf('json')!=-1;},getTextValue:function(xml,tagName){var tags=xml.getElementsByTagName(tagName);if(tags&&tags.length>0&&tags[0]&&tags[0].firstChild){return tags[0].firstChild.data;}
return null;},getTags:function(xml,tagName){var tags=xml.getElementsByTagName(tagName);if(tags&&tags.length>0){return tags;}
return null;},getCleanTextValue:function(xml,tagName){var textValue=this.getTextValue(xml,tagName);if(textValue){return unescape(decodeURI(textValue)).replace(/\+/g," ");}else{return null;}},cleanTextValue:function(textValue){if(textValue){return unescape(decodeURI(textValue)).replace(/\+/g," ");}else{return null;}},redirectIfNecessary:function(response,ajaxOptions){var redirectionUrl=_.get(response,'redirectionWarning');var shouldRedirect=!_.isUndefined(redirectionUrl)&&!response.silent&&!ajaxOptions.skipRedirectionHandler;if(shouldRedirect){redirectUser(redirectionUrl);}},getUrlWithPageProtocol:function(url){url=url.replace(/^http[s]?:/,window.location.protocol);if(window.location.port=='8080'||window.location.port=='8443'){url=url.replace(/:8[0-9][0-9][0-9]\//,':'+window.location.port+"/");}
return url;},postRedirect:function(url,params){var form=jQ('<form></form>');form.attr('method','POST');form.attr('action',url);for(var i in params){var input=jQ('<input />');input.attr('type','hidden');input.attr('name',i);input.attr('value',params[i]);input.appendTo(form);}
jQ('body').append(form);form.submit();},getFormDataAsJSON:function(form){return _.object(_.map(form.serializeArray(),_.values));},addNewParameters:function(url,parameterNames,parameterValues){if(parameterNames&&parameterValues){var namesSize=parameterNames.length,valuesSize=parameterValues.length;if(namesSize>0&&namesSize===valuesSize){var newUrl=url+(url.indexOf('?')>-1?'&':'?');for(i=0;i<namesSize;i++){var param=parameterNames[i]+'='+encodeURI(parameterValues[i]);newUrl=(i===0)?newUrl+param:newUrl+'&'+param;}
return newUrl;}}
return url;}};(function(webshop,$){webshop.common=webshop.common||{};webshop.common.Navigation={ui:{eventsOverlay:jQ('.eventsOverlay'),events:jQ('#event.with-dropdown,.primaryBar-item-event')},isVisible:false,defaultClassesOnOpen:'buttonOn dropdownVisible',init:function(){this.addEventsClass();this.dropDownMenuEvents();},dropDownMenuEvents:function(){this.ui.events.on({'mouseenter':onMouseEnterOrClick,'mouseleave':onMouseLeave,'click':onMouseEnterOrClick,'touchstart':onMouseEnterOrClick});if(Backbone.Webshop.mixins.isBetaFeatureEnabled('JS_ONLOAD_DROPDOWN_FIX')&&webshop.common.Util.isHoverSelectorSupported()&&!webshop.common.Navigation.isVisible&&this.ui.events.find('a:hover').length){this.ui.events.trigger('mouseenter');}
function onMouseEnterOrClick(){jQ('.nav-common').find('.open').removeClass('open');jQ(this).addClass('open '+webshop.common.Navigation.defaultClassesOnOpen);webshop.common.Navigation.isVisible=true;}
function onMouseLeave(){jQ(this).removeClass('open '+webshop.common.Navigation.defaultClassesOnOpen);webshop.common.Navigation.isVisible=false;}},addEventsClass:function(){var eventsCount=this.getEventsCount(this.ui.eventsOverlay);if(eventsCount){this.ui.eventsOverlay.addClass(eventsCount)}},getEventsCount:function($eventsOverlay){switch($eventsOverlay.find('.eventWrap').length){case 1:return'oneEvent';case 2:return'twoEvents';case 3:return'threeEvents';case 4:return'fourEvents';case 5:return'fiveEvents';case 6:return'sixEvents';}
return'';}};}(webshop,jQ));(function(webshop){webshop.animations=webshop.animations||{};webshop.animations.tileDropdown={config:{parentSelector:'.primaryBar-container',dropdownSelector:'.tilesDropdown',tileSelector:'.eventWrap',limitAttr:'tile-limit',resizeThrottle:30,},ui:{tiles:null,parent:null,resizeTimer:null,},init:function(){var self=this;var tiles=jQ(this.config.dropdownSelector);if(tiles.length){this.ui.tiles=tiles;this.ui.parent=tiles.parents(this.config.parentSelector);this.resizeHandler();jQ(window).on('resize',function(){clearTimeout(self.ui.resizeTimer);self.ui.resizeTimer=setTimeout(self.resizeHandler.bind(self),self.config.resizeThrottle);});}},resizeHandler:function(){var self=this;jQ.each(self.ui.tiles,function(index,dropdown){self.resizeDropdown(jQ(dropdown));});},resizeDropdown:function(dropdown){var limit=dropdown.data(this.config.limitAttr);var items=dropdown.find(this.config.tileSelector);var width=Math.round(this.ui.parent.width()/limit*items.length);dropdown.width(width);}};}(webshop,jQ));webshop.animation=webshop.animation||{};webshop.animation.popup={analytics:{},init:function(){this.genericPopup();this._escapeClose();},genericPopup:function(){var popup=webshop.animation.popup;var popupLinks=jQ('.popLaunch');for(var i=0;i<=(popupLinks.length-1);i++){var popupLink=jQ(popupLinks[i]);var popupTarget=jQ('.'+popupLink.attr('rel'));popupLink.on('click',function(e){e.preventDefault();popup._popupControl(popupLink,popupTarget);});popupTarget.find('.close').on('click',function(){popup._popupControl(popupLink,popupTarget);});}},_popupControl:function(popLink,popTarget){var popup=webshop.animation.popup;var visible=popTarget.css('display');if(visible==='none'){popTarget.show();popLink.addClass('popLinkDisabled');}
else{popTarget.hide();popLink.removeClass('popLinkDisabled');}},_escapeClose:function(){jQ(document).on('keyup',function(e){if(e.keyCode===27){webshop.animation.popup._popupControl(jQ('.popLinkDisabled'),jQ('.popBox:visible'));}});}};(function(webshop,$){"use strict";webshop.animations=webshop.animations||{};webshop.animations.myShopItemNavigation=(function(){var $myBrowseShop;var $myBrowseShopTrigger;var submenuVisible=false;var submenuHideTimeout=null;var pub={init:function(){$myBrowseShop=$('.browseMyShop');if(!$myBrowseShop.length){return;}
$myBrowseShopTrigger=$myBrowseShop.children('a');$myBrowseShop.on('focusin mouseenter',showSubmenu);$myBrowseShop.on('focusout mouseleave',hideSubmenu);$myBrowseShopTrigger.on('click',onMyShopClick);$myBrowseShopTrigger.on('touchstart',onMyShopTouch);if(Backbone.Webshop.mixins.isBetaFeatureEnabled('JS_ONLOAD_DROPDOWN_FIX')&&webshop.common.Util.isHoverSelectorSupported()&&!submenuVisible&&$myBrowseShop.find('> a:hover').length){$myBrowseShop.triggerHandler('mouseenter');}}};function showSubmenu(e){if(!submenuVisible){$myBrowseShop.addClass('browseOpen');submenuHideTimeout&&clearTimeout(submenuHideTimeout);submenuHideTimeout=null;submenuVisible=true;}}
function hideSubmenu(){if(submenuVisible){submenuVisible=false;submenuHideTimeout=setTimeout(hideSubmenuTimeout,1);}}
function hideSubmenuTimeout(){$myBrowseShop.removeClass('browseOpen');}
function onMyShopClick(e){e.preventDefault();}
function onMyShopTouch(e){e.preventDefault();if(submenuVisible){hideSubmenu({});}else{$myBrowseShopTrigger.focus();}}
return pub;}());}(webshop,jQ));webshop.animations=webshop.animations||{};webshop.animations.superNav={init:function(){this._buildConfig();this._registerEventHandlers();this._calculateHeight();if(this.config.container.hasClass('mobile'))this._mobileEvents();},_buildConfig:function(){var container=jQ('.browseShop'),sidebarContainer=jQ('#navigationSidebar'),sideBarRefLink=jQ('#navigationTags').attr('referenceLink');this.config={container:container,sidebarContainer:sidebarContainer,superNavContainer:container.find('.superNav'),sidebarSuperNavContainer:sidebarContainer.find('.superNav'),ajaxLocation:'/webshop/browseShop.do?ajax=ajax',sidebarParams:sideBarRefLink,brandAjaxLocation:'/webshop/brandItems.do?ajax=ajax',navElements:{},brandElements:{},siderbarElements:{},baseNavLoaded:false,dropdownTimer:0,dropdownSpeed:180,changeTimer:0,changeSpeed:180,sidebarNavHeight:0,browseNavLoaded:false,baseBrandWrapperClass:'',alternativeHeaderBetaFeatureEnabled:Backbone.Webshop.mixins.isBetaFeatureEnabled('ALTERNATIVE_HEADER')};this.config.superNavContainer.append('<div class="superNav-innerWrapper"></div>');this.config.sidebarSuperNavContainer.find('.superNav').append('<div class="superNav-innerWrapper"></div>');this.config.superNavContainerInner=this.config.superNavContainer.find('.superNav-innerWrapper');this.config.sidebarSuperNavContainerInner=this.config.sidebarSuperNavContainer.find('.superNav-innerWrapper');this.config.superNavContainerInner.append('<div class="baseLevel-wrapper"></div>');this.config.baseLevelWrapper=this.config.superNavContainerInner.find('.baseLevel-wrapper');},_registerEventHandlers:function(){var superNav=this.config;var eventType='mouseenter';var $eventTrigger=superNav.container;if(webshop.common.Util.isIPad()){eventType='touchstart';$eventTrigger=$eventTrigger.find('.shopLink');}
$eventTrigger.on(eventType,function(){if(!superNav.browseNavLoaded){superNav.container.addClass('browseOpen');superNav.superNavContainer.fadeIn(140);superNav.superNavContainer.addClass('loading');superNav.isOpen=true;if(!superNav.isLoading){webshop.animations.superNav._ajaxNavLoad(superNav.ajaxLocation+"&browse=true",true);}}else{clearTimeout(superNav.dropdownTimer);webshop.animations.superNav._showBaseNav();}});superNav.container.on('mouseleave',function(){clearTimeout(superNav.dropdownTimer);superNav.isOpen=false;superNav.container.removeClass('browseOpen');superNav.superNavContainer.hide();superNav.superNavContainer.find('.baseLevel .trail').removeClass('trail');superNav.container.find('.clicked').removeClass('clicked');superNav.superNavContainer.find('.levelOne, .levelTwo').remove();superNav.superNavContainer.find('#brandWrapper li').remove();superNav.superNavContainer.find('#brandWrapper').attr('class',superNav.baseBrandWrapperClass).addClass('hidden');});superNav.superNavContainer.on('mouseenter','li > a',function(){webshop.animations.superNav._mouseEnterEvent(jQ(this),true);});superNav.superNavContainer.on('mouseleave','li > a',function(){clearTimeout(superNav.changeTimer);});superNav.superNavContainer.on('mouseenter','.levelOne li.highlight',function(){superNav.superNavContainer.find('.levelTwo').remove();superNav.superNavContainer.find('.levelOne .trail').removeClass('trail');if(!superNav.superNavContainer.find('#brandWrapper').hasClass('posTwo')){superNav.superNavContainer.find('#brandWrapper').removeClass('posThree').addClass('posTwo');}});if(superNav.sidebarContainer.length>0&&superNav.sidebarSuperNavContainer.attr('data-maxnum')&&jQ('#navigationTags').attr('haschildren')!="false"){if(!superNav.siderbarElements.length){webshop.animations.superNav._ajaxNavLoad(superNav.ajaxLocation+"&"+superNav.sidebarParams,false,function(isComplete){if(isComplete){superNav.sidebarReady=true;}});}
superNav.sidebarSuperNavContainer.on('mouseleave',function(){superNav.sidebarSuperNavContainer.removeClass('sidebarActive');superNav.sidebarSuperNavContainer.find('.baseLevel .trail').removeClass('trail');superNav.sidebarContainer.find('.clicked').removeClass('clicked');superNav.sidebarSuperNavContainer.find('.levelOne, .levelTwo').remove();superNav.sidebarSuperNavContainer.find('#sidebarBrandWrapper li').remove();superNav.sidebarSuperNavContainer.find('#sidebarBrandWrapper').attr('class',superNav.baseBrandWrapperClass+' '+'hidden');});superNav.sidebarSuperNavContainer.on('mouseenter','li > a',function(){if(superNav.sidebarReady){webshop.animations.superNav._mouseEnterEvent(jQ(this),false);}});superNav.sidebarSuperNavContainer.on('mouseleave','li > a',function(){clearTimeout(superNav.changeTimer);});superNav.sidebarSuperNavContainer.on('mouseenter','.levelOne li.highlight',function(){superNav.sidebarSuperNavContainer.find('.levelTwo').remove();superNav.sidebarSuperNavContainer.find('.levelOne .trail').removeClass('trail');if(!superNav.sidebarSuperNavContainer.find('#sidebarBrandWrapper').hasClass('posTwo')){superNav.sidebarSuperNavContainer.find('#sidebarBrandWrapper').removeClass('posThree').addClass('posTwo');}});}
else{superNav.sidebarReady=true;}
if(Backbone.Webshop.mixins.isBetaFeatureEnabled('JS_ONLOAD_DROPDOWN_FIX')&&!webshop.common.Util.isIPad()&&webshop.common.Util.isHoverSelectorSupported()&&!superNav.container.hasClass('browseOpen')&&superNav.container.find('.shopLink:hover').length){$eventTrigger.triggerHandler('mouseenter');}},_dummyBrandElements:function(){return jQ('<div ></div>');},_ajaxNavLoad:function(fileLocation,isMainNav,returnIsComplete){var dummyBrandElements=this._dummyBrandElements();var superNav=this.config;superNav.isLoading=true;jQ.ajax({url:fileLocation,dataType:'text',cache:false}).done(function(html){var trimmedHtml=String.prototype.trim.call(html==null?"":html);if(isMainNav){superNav.browseNavLoaded=true;superNav.navElements=jQ(trimmedHtml).find('> div');webshop.animations.superNav._loadBaseNav();superNav.superNavContainer.removeClass('loading');}else{superNav.siderbarElements=jQ(trimmedHtml).find('> div');superNav.superNavContainer.removeClass('loading');returnIsComplete(true);}}).always(function(){superNav.isLoading=false;});if(!superNav.brandElements.length){superNav.brandElements=dummyBrandElements;jQ.ajax({url:superNav.brandAjaxLocation,dataType:'text',cache:false}).done(function(html){superNav.brandElements=jQ(html);superNav.baseBrandWrapperClass=superNav.brandElements.attr('class')||''}).fail(function(){superNav.brandElements=dummyBrandElements;});}},_loadBaseNav:function(){var superNav=this.config;superNav.baseLevelWrapper.append(superNav.navElements.siblings('.baseLevel').clone());superNav.baseNavLoaded=true;if(superNav.isOpen)webshop.animations.superNav._showBaseNav();},_showBaseNav:function(){var superNav=webshop.animations.superNav.config;var $promotionLink=superNav.navElements.find('.promotion:eq(0) > a');if($promotionLink.length){this._mouseEnterEvent($promotionLink,true,true);}
superNav.dropdownTimer=setTimeout(function(){superNav.container.addClass('browseOpen');superNav.superNavContainer.fadeIn(140);},superNav.dropdownSpeed);},_mouseEnterEvent:function(currentElement,isMainNav,skipDelay){var superNavObject=webshop.animations.superNav,superNav=superNavObject.config,relatedId=currentElement.parent().data('option'),brandId=currentElement.parent().data('brands'),parentLevel=currentElement.parents('.nav'),currentContainer={};clearTimeout(superNav.changeTimer);var wrapperId;if(isMainNav){currentContainer=superNav.superNavContainerInner;wrapperId='brandWrapper';}
else{currentContainer=superNav.sidebarSuperNavContainerInner;wrapperId='sidebarBrandWrapper';}
if(currentElement.parent().parent().data('brands')){brandId+='|'+currentElement.parent().parent().data('brands');}
if(parentLevel.hasClass('baseLevel')){currentContainer.find('.trail').removeClass('trail');}
else if(parentLevel.hasClass('levelOne')){webshop.animations.superNav._setTrail('one',currentContainer);currentContainer.find('.levelOne .trail, .levelTwo .trail').removeClass('trail');}
else if(parentLevel.hasClass('levelTwo')){webshop.animations.superNav._setTrail('two',currentContainer);currentContainer.find('.levelTwo .trail').removeClass('trail');}
superNav.changeTimer=setTimeout(function(){if(currentContainer===superNav.sidebarSuperNavContainer&&!currentContainer.hasClass('sidebarActive')){currentContainer.addClass('sidebarActive');}
if(wrapperId!='brandWrapper'&&(currentElement.parent().parent().hasClass('navCTALinks')||(currentElement.hasClass('navPink')&&currentElement.parents('#navigationSidebar').length>0)||(currentElement.hasClass('navNew')&&currentElement.parents('#navigationSidebar').length>0))){currentContainer.removeClass('sidebarActive');currentContainer.find('.levelOne, .levelTwo').remove();superNavObject._clearBrands('base',currentContainer,wrapperId);}
if(parentLevel.hasClass('baseLevel')){if(!currentElement.parent().parent().hasClass('navCTALinks')){currentContainer.find('.levelOne, .levelTwo').remove();}
if(brandId){superNavObject._brandToggle(brandId,'base',currentContainer,wrapperId);}
else{if(!currentElement.parent().parent().hasClass('navCTALinks')){superNavObject._clearBrands('base',currentContainer,wrapperId);}}
if(relatedId){currentContainer.find('#'+wrapperId).attr('class',superNav.baseBrandWrapperClass+' '+'posTwo');}
else if(!currentElement.parent().parent().hasClass('navCTALinks')){currentContainer.find('#'+wrapperId).attr('class',superNav.baseBrandWrapperClass+' '+'posOne');}
if(!brandId&&!relatedId){currentContainer.removeClass('sidebarActive');}}
else if(parentLevel.hasClass('levelOne')){currentContainer.find('.levelTwo').remove();if(brandId){superNavObject._brandToggle(brandId,'one',currentContainer,wrapperId);}
else{superNavObject._clearBrands('one',currentContainer,wrapperId);}
if(relatedId){currentContainer.find('#'+wrapperId).attr('class',superNav.baseBrandWrapperClass+' '+'posThree');}
else{currentContainer.find('#'+wrapperId).attr('class',superNav.baseBrandWrapperClass+' '+'posTwo');}}
else if(parentLevel.hasClass('levelTwo')){if(brandId){superNavObject._brandToggle(brandId,'two',currentContainer,wrapperId);}
else{superNavObject._clearBrands('two',currentContainer,wrapperId);}}
if(brandId||relatedId){currentElement.parent().addClass('trail');}
if(relatedId){if(isMainNav){currentContainer.append(superNav.navElements.filter('[data-option="'+relatedId+'"]').clone());}
else{currentContainer.append(superNav.siderbarElements.filter('[data-option="'+relatedId+'"]').clone());}}
if(currentContainer.find('#'+wrapperId+' li').length>0){currentContainer.find('#'+wrapperId).removeClass('hidden');}
else{currentContainer.find('#'+wrapperId).addClass('hidden');}},skipDelay?0:superNav.changeSpeed);},_brandToggle:function(brandId,parentLevel,currentContainer,wrapperId){var superNavObject=this,superNav=superNavObject.config,brandIds=brandId.split('|');if(!currentContainer.find('#'+wrapperId).length){var h3=jQ('<h3>');var text=h3.html(getMessage('navigation.superNav.selectedShops')).text();currentContainer.prepend(jQ('<div>').attr('id',wrapperId).append(h3.html(text)).append(jQ('<ul>')));}
switch(parentLevel){case'base':superNav.brandElements.find('.baseBrand').removeClass('baseBrand');superNav.brandElements.find('.levelOneBrand').removeClass('levelOneBrand');superNav.brandElements.find('.levelTwoBrand').removeClass('levelTwoBrand');superNavObject._clearBrands(parentLevel,currentContainer,wrapperId);for(var a=0;a<=(brandIds.length-1);a++){var brandListItems=superNav.brandElements.find('.'+brandIds[a]);for(var b=0;b<=(brandListItems.length-1);b++){var currentBrand=jQ(brandListItems[b]);currentBrand.addClass('baseBrand');if(currentBrand.find('img').length===0){currentBrand.find('a').prepend(jQ('<img />').attr('src',currentBrand.data('imageurl')));currentBrand.removeAttr('data-imageurl');}
currentContainer.find('#'+wrapperId+' ul').append(currentBrand.clone());}}
break;case'one':superNav.brandElements.find('.levelOneBrand').removeClass('levelOneBrand');superNav.brandElements.find('.levelTwoBrand').removeClass('levelTwoBrand');superNavObject._clearBrands(parentLevel,currentContainer,wrapperId);for(var a=0;a<=(brandIds.length-1);a++){var brandListItems=superNav.brandElements.find('.'+brandIds[a]);for(var b=0;b<=(brandListItems.length-1);b++){var currentBrand=jQ(brandListItems[b]);currentBrand.addClass('levelOneBrand');if(currentBrand.find('img').length===0){currentBrand.find('a').prepend(jQ('<img />').attr('src',currentBrand.data('imageurl')));currentBrand.removeAttr('data-imageurl');}
currentContainer.find('#'+wrapperId+' ul').append(currentBrand.clone());}}
break;case'two':superNav.brandElements.find('.levelTwoBrand').removeClass('levelTwoBrand');superNavObject._clearBrands(parentLevel,currentContainer,wrapperId);for(var a=0;a<=(brandIds.length-1);a++){var brandListItems=superNav.brandElements.find('.'+brandIds[a]);for(var b=0;b<=(brandListItems.length-1);b++){var currentBrand=jQ(brandListItems[b]);currentBrand.addClass('levelTwoBrand');if(currentBrand.find('img').length===0){currentBrand.find('a').prepend(jQ('<img />').attr('src',currentBrand.data('imageurl')));currentBrand.removeAttr('data-imageurl');}
currentContainer.find('#'+wrapperId+' ul').append(currentBrand.clone());}}
break;}},_clearBrands:function(currentLevel,currentContainer,wrapperId){switch(currentLevel){case'base':currentContainer.find('#'+wrapperId+' .baseBrand, #'+wrapperId+' .levelOneBrand, #'+wrapperId+' .levelTwoBrand').remove();break;case'one':currentContainer.find('#'+wrapperId+' .levelOneBrand, #'+wrapperId+' .levelTwoBrand').remove();break;case'two':currentContainer.find('#'+wrapperId+' .levelTwoBrand').remove();break;}},_setTrail:function(currentLevel,currentContainer){var currentDataId=0;switch(currentLevel){case'one':currentDataId=currentContainer.find('.levelOne').data('option');currentContainer.find('.baseLevel li').filter('[data-option="'+currentDataId+'"]').addClass('trail');break;case'two':currentDataId=currentContainer.find('.levelTwo').data('option');currentContainer.find('.levelOne li').filter('[data-option="'+currentDataId+'"]').addClass('trail');break;}},_calculateHeight:function(){var superNav=this.config,numberOfElements=superNav.sidebarSuperNavContainer.data('maxnum'),sidebarSuperNavHeight=superNav.sidebarSuperNavContainer.innerHeight()-15;superNav.sidebarNavHeight=sidebarSuperNavHeight;if(numberOfElements){if(((numberOfElements*22)+40)>sidebarSuperNavHeight){superNav.sidebarNavHeight=((numberOfElements*22)+40);}}},_mobileEvents:function(){var obj=this,superNav=obj.config;superNav.container.find('.shopLink').on('click',function(e){obj._clickCheck(jQ(this),function(prevent){if(prevent){e.preventDefault();}});});superNav.superNavContainer.on('click','li:not(.viewLink) > a',function(e){obj._clickCheck(jQ(this),function(prevent){if(prevent){e.preventDefault();}});});if(superNav.sidebarContainer){superNav.sidebarSuperNavContainer.on('click','li:not(.viewLink) > a',function(e){obj._clickCheck(jQ(this),function(prevent){if(prevent){e.preventDefault();}});});}},_clickCheck:function(elem,preventClick){var $parent=elem.parent();var config=webshop.animations.superNav.config;if(!elem.hasClass('clicked')&&!$parent.hasClass('noChildren')&&(!config.alternativeHeaderBetaFeatureEnabled||!$parent.hasClass('baseBrand'))){config.superNavContainer.find('.clicked').removeClass('clicked');elem.addClass('clicked');preventClick(true);}
else{preventClick(false);}}};webshop.search=webshop.search||{};var searchWrapper=jQ('#searchWrapper'),multiSearchWrapper=jQ('.searchTerms'),searchInput=jQ('#findText'),entryForm=multiSearchWrapper.find('#multiSearchForm'),resultsBox=multiSearchWrapper.find('#searchNavResults'),cancelButton=multiSearchWrapper.find('.cancelButton');webshop.search.SearchBox={init:function(){this.virtualPageViewsSender=new ocBackbone.gtm.GTMVirtualPageviewEventSender();this.url=window.location.href;this.setMultisearchJs();this.setButtons();this.addFormSubmitAnalytics();this.addGAVirtualPageUrl();this.preventEmptyValueSubmit();if(this.url.match(/([Rr]ecipe)/g)!==null){searchInput.attr('placeholder','Find a recipe');}},setMultisearchJs:function(){multiSearchWrapper.find("input[name=multiSearchButton]").val("js");multiSearchWrapper.find("#backToCombined").show();},setButtons:function(){var entryTextarea=entryForm.find('textarea');multiSearchWrapper.on('click','#editSearchList',function(e){webshop.search.SearchBox.addPageEventAnalytics('MULTI_SEARCH_EDIT_LIST_CLICKED');var currentItems=resultsBox.find('#resultsWrapper a'),parsedItems="";e.preventDefault();for(var i=0;i<=(currentItems.length-1);i++){parsedItems+=jQ(currentItems[i]).text()+'\n';}
entryTextarea.removeClass("hasPlaceholder");entryTextarea.val(parsedItems);resultsBox.hide();entryForm.show();});multiSearchWrapper.on('click','#clearSearchList',function(e){webshop.search.SearchBox.addPageEventAnalytics('MULTI_SEARCH_CLEAR_LIST_CLICKED');e.preventDefault();entryTextarea.val('');resultsBox.hide();entryForm.show();});},preventEmptyValueSubmit:function(){searchWrapper.on('submit','.suggestionsForm',function(e){if(!searchWrapper.find('.navSearchTxt').val()){e.preventDefault();}});},addFormSubmitAnalytics:function(){multiSearchWrapper.on('submit','#multiSearchForm',function(e){webshop.search.SearchBox.addPageEventAnalytics('MULTI_SEARCH_FORM_SUBMIT');});},addPageEventAnalytics:function(pageEventType){jQ.get('/webshop/createPageEvent.do',{ajax:true,pageEventType:pageEventType,pageViewId:webshop.analytics.pageViewId});},addGAVirtualPageUrl:function(){if(webshop.search.SearchBox.url.indexOf("MultiSearch")>-1){var virtualPagePath="/multi-search?entry=",currentItems=resultsBox.find('#resultsWrapper a'),itemsArray=new Array();for(var i=0;i<=(currentItems.length-1);i++){itemsArray.push(jQ(currentItems[i]).text());}
virtualPagePath=virtualPagePath+itemsArray.join("+");webshop.search.SearchBox.virtualPageViewsSender.send(virtualPagePath);}}};webshop.search=webshop.search||{};webshop.search.autoCompleteFill={el:jQ('.suggestionsForm'),init:function(){jQ.extend(this,{responseContainer:this.el.find('.searchSuggestions'),searchBox:this.el.find('#findText'),resultsList:this.el.find('#suggestions'),closeBtn:this.el.find('.closeResults'),placeholder:jQ('.placeholder'),chosenSuggestionPosition:jQ('#chosenSuggestionPosition'),isAutocompleteDisabled:this.el.find('#isAutocompleteDisabled'),closeSuggestionsOnClickSelectors:'body',prominentSearchForm:jQ('#searchWrapper.prominentSearchWrapper'),});this.bindEventHandlers();},bindEventHandlers:function(){var self=this;if(webshop.userData.betaFeatures['NEXT_SEARCH_SUGGESTIONS']){this.searchBox.on('focus',this.nextSearchTerms)}
if(this.isAutocompleteDisabled.val()!=='true'){this.searchBox.on('keyup',this.autocomplete);}
if(webshop.userData.betaFeatures['ACQUISITION_24186_MORE_PROMINENT_SEARCH']){this.searchBox.on('focus',this.setFormActive);this.searchBox.on('blur',this.setFormInactive);}
jQ('#searchWrapper').on('keydown',this.formAutoSubmit);this.searchBox.on('click',function(e){e.stopPropagation();});this.resultsList.on('click','li',function(){if(self.searchBox.val()==""){jQ.get('/webshop/createPageEvent.do',{ajax:true,pageEventType:'RELATED_SEARCH_SUGGESTION_SELECTED',pageViewId:webshop.analytics.pageViewId,SEARCH_TERM:jQ(this).text(),CHOSEN_SUGGESTION_POSITION:jQ(this).val()});}
self.searchBox.val(jQ(this).text());self.chosenSuggestionPosition.val(jQ(this).val());self.el.submit();});this.resultsList.on('mouseenter','li',function(){self.resultsList.find('.selected').removeAttr('class');jQ(this).addClass('selected');});this.resultsList.on('mouseleave','li',function(){jQ(this).removeAttr('class');self.chosenSuggestionPosition.val('');});this.el.on('click','.closeResults',function(){self.responseContainer.hide();});},nextSearchTerms:function(){var self=webshop.search.autoCompleteFill,typedValue=self.searchBox.val();if(typedValue.length==0){webshop.search.render.parseJSON('',[self.placeholder,self.resultsList],self.animatePanel);}},autocomplete:function(evt){var self=webshop.search.autoCompleteFill,typedValue=self.searchBox.val();if(typedValue.length>1&&evt.keyCode!=27){if(evt.keyCode!=13&&evt.keyCode!=38&&evt.keyCode!=40&&evt.keyCode!=37&&evt.keyCode!=39){webshop.search.render.parseJSON(typedValue.toLowerCase(),[self.placeholder,self.resultsList],self.animatePanel);self.chosenSuggestionPosition.val('');self.stateSet=false;}}
else{self.responseContainer.hide();self.resultsList.html('');}},animatePanel:function(jsonResponse){var self=webshop.search.autoCompleteFill,sku=self.el.find('.placeholder .product'),brand=self.el.find('.placeholder .brand'),results=self.el.find('.results'),brandTitle=self.el.find('.brandTitle'),productTitle=self.el.find('.skuTitle');if((brand.length==1||sku.length==1)&&!self.stateSet){results.addClass('singlePremium').removeClass('doublePremium');self.closeBtn.hide();}else if(brand.length>1||sku.length>1){results.addClass('doublePremium').removeClass('singlePremium');self.closeBtn.show();self.stateSet=true;}
if(!brand.length&&!sku.length){self.closeBtn.hide();}
(brand.length>0)?brandTitle.css('display','block'):brandTitle.css('display','none');(sku.length>0)?productTitle.css('display','block'):productTitle.css('display','none');(jsonResponse.d.length===0)?self.hidePanel():self.showResponseContainer();},formAutoSubmit:function(evt){var self=webshop.search.autoCompleteFill,currentElement=self.resultsList.find('.selected');if(self.resultsList.find('li').length>0){self.showResponseContainer();self.resultsList.find('li').removeAttr('class');}
if(evt.keyCode===38){currentElement=(currentElement.length>0&&currentElement.index()!=0)?currentElement.prev():self.resultsList.find('li:last');currentElement.addClass('selected');self.searchBox.val(currentElement.text());self.chosenSuggestionPosition.val(currentElement.val());}else if(evt.keyCode===40){currentElement=(currentElement.length>0&&(currentElement.index()+1)!=self.resultsList.find('li').length)?currentElement.next():self.resultsList.find('li:first');currentElement.addClass('selected');self.searchBox.val(currentElement.text());self.chosenSuggestionPosition.val(currentElement.val());}},showResponseContainer:function(){if(this.resultsList.is(':hidden')){this.responseContainer.show();jQ(this.closeSuggestionsOnClickSelectors).one('click.autoSearch',this.hidePanelEvent);}},hidePanel:function(){var self=webshop.search.autoCompleteFill;if(self.resultsList.is(':visible')){self.responseContainer.hide();self.resultsList.html('');self.placeholder.html('');jQ(this.closeSuggestionsOnClickSelectors).off('click.autoSearch',self.hidePanelEvent);}},hidePanelEvent:function(){webshop.search.autoCompleteFill.hidePanel();},setFormActive:function(){webshop.search.autoCompleteFill.prominentSearchForm.addClass('active');},setFormInactive:function(){webshop.search.autoCompleteFill.prominentSearchForm.removeClass('active');}};webshop.search=webshop.search||{};webshop.search.render={config:{url:'/webshop/getSearchSuggestions.do?entry=',responseContainer:jQ('.searchSuggestions'),suggestion:jQ('#suggestions'),isAutocompleteDisabled:jQ('#isAutocompleteDisabled')},cache:{},parseJSON:function(query,elementArray,callback){var render=webshop.search.render;if(render.config.isAutocompleteDisabled.val()!=='true'){jQ.getJSON(this.config.url+encodeURIComponent(query)+'&ajax=true',function(data){render.cache.jsonResponse=data;handleObj(data,query,callback);});}
function handleObj(data,q,callback){var len=data.d.length,re=new RegExp(q,'g'),smart=jQ('#smartTrolley');render.cache.jsonResponse=data;if(elementArray){reload(elementArray);}
for(var i=0;i<len;i++){if(data.d[i].id.toLowerCase().search(re)!=-1){data.d[i].id=data.d[i].id.toLowerCase().replace(re,'<strong>'+q+'</strong>');}
render.config.suggestion.append('<li value="'+i+'">'+data.d[i].id+'</li>');}
if(!smart.length){render.splitObj(data,callback);}
len?render.config.responseContainer.show():render.config.responseContainer.hide();}
function reload(elementArray){var len=elementArray.length;for(var i=0;i<len;i++){elementArray[i].html('');}}},splitObj:function(json,callback){for(var str in json.d[0]){var obj=json.d[0][str];if(typeof obj==='object'){this.render(obj,str,callback);}else{jQ('.results').removeClass('doublePremium').removeClass('singlePremium');}}
if(!json.d[0]){callback.call(this,this.cache.jsonResponse);}},render:function(obj,str,callback){var template;var key;var re;var templateRe=new RegExp('{{[a-zA-Z\-\_]*}}','g');for(var i=0;i<obj.length;i++){try{var placeholder=jQ('#placeholder-'+str);if(obj[i].nit>0){template=document.getElementById('alt-template-'+str).innerHTML;}else{template=document.getElementById('template-'+str).innerHTML;}
for(key in obj[i]){re=new RegExp('{{'+key+'}}','g');template=template.replace(re,obj[i][key]);}
template=template.replace(templateRe,'');placeholder.append(template);callback.call(this,this.cache.jsonResponse);}catch(err){console.log(err);}}
if(obj.length===0){callback.call(this,this.cache.jsonResponse);}}};webshop.gtm=webshop.gtm||{};webshop.gtm.mixins=webshop.gtm.mixins||{};webshop.gtm.mixins.trolleyButtons=webshop.gtm.mixins.trolleyButtons||{};webshop.gtm.mixins.trolleyButtons.trackingFunctions=webshop.gtm.mixins.trolleyButtons.trackingFunctions||{};webshop.gtm.mixins.trolleyButtons.trackingFunctions.backOfPackPopupProduct=(function(){return{isClicked:function(inputButton){return(jQ(inputButton).parents('#bopPopup .productPrice').length==1);},addToTrolley:function(inputButton,eventSender){var productData=getProductData();productData.quantity=getProductQuantity(inputButton);productData.id=productData.sku;if(!_.isEmpty(productData)){var pageType=getPageType();eventSender.addToTrolley(productData,pageType,pageType,pageType);}},removeFromTrolley:function(inputButton,eventSender){var productData=getProductData();productData.quantity=getProductQuantity(inputButton);productData.id=productData.sku;if(!_.isEmpty(productData)){var pageType=getPageType();eventSender.removeFromTrolley(productData,pageType,pageType,pageType);}}};function getProductQuantity(inputButton){var quantity=jQ(inputButton).parents('form').find('input.quantity').val();return/^\d+$/.test(quantity)&&Number(quantity)||1;}
function getProductData(){var productData=jQ('#quickViewProductDetailsDTO');if(_.isEmpty(productData)){return null;}else{return JSON.parse(productData.html());}}
function getPageType(){var pageType=window.webshop.common.jsVariables.get('pageType');if(_.isEmpty(pageType)){return'Other';}else{return pageType;}}})();webshop.gtm=webshop.gtm||{};webshop.gtm.mixins=webshop.gtm.mixins||{};webshop.gtm.mixins.trolleyButtons=webshop.gtm.mixins.trolleyButtons||{};webshop.gtm.mixins.trolleyButtons.trackingFunctions=webshop.gtm.mixins.trolleyButtons.trackingFunctions||{};webshop.gtm.mixins.trolleyButtons.trackingFunctions.backOfPackProduct=(function(){return{isClicked:function(inputButton){return((jQ(inputButton).parents('#bopRight > .productPrice').length==1)||(jQ(inputButton).parents('#bopRight > .derivative').length==1));},addToTrolley:function(inputButton,eventSender){var productData=webshop.common.jsVariables.get("productDetailsDTO");productData.quantity=getProductQuantity(inputButton);productData.id=productData.sku;if(!_.isEmpty(productData)){var pageType=getPageType();eventSender.addToTrolley(productData,pageType,pageType,pageType);}},removeFromTrolley:function(inputButton,eventSender){var productData=webshop.common.jsVariables.get("productDetailsDTO");productData.quantity=getProductQuantity(inputButton);productData.id=productData.sku;if(!_.isEmpty(productData)){var pageType=getPageType();eventSender.removeFromTrolley(productData,pageType,pageType,pageType);}}};function getProductQuantity(inputButton){var quantity=jQ(inputButton).parents('form').find('input.quantity').val();return/^\d+$/.test(quantity)&&Number(quantity)||1;}
function getPageType(){var pageType=window.webshop.common.jsVariables.get('pageType');if(_.isEmpty(pageType)){return'Other';}else{return pageType;}}})();webshop.gtm=webshop.gtm||{};webshop.gtm.mixins=webshop.gtm.mixins||{};webshop.gtm.mixins.trolleyButtons=webshop.gtm.mixins.trolleyButtons||{};webshop.gtm.mixins.trolleyButtons.trackingFunctions=webshop.gtm.mixins.trolleyButtons.trackingFunctions||{};webshop.gtm.mixins.trolleyButtons.trackingFunctions.catalogueProductList=(function(){return{isClicked:function(inputButton){return(jQ(inputButton).parents('#myShop #boxes').length==1)||(jQ(inputButton).parents('#shop #boxes').length==1)||(jQ(inputButton).parents('#shop #prodList').length==1)||(jQ(inputButton).parents('#shop .multiSearch').length==1)||(jQ(inputButton).parents('#shopFavourites #prodList').length==1)||(jQ(inputButton).parents('#shopOffers #prodList').length==1)||(jQ(inputButton).parents('#wineCellar #prodList').length==1)||(jQ(inputButton).parents('.sponsored .product').length==1)||(jQ(inputButton).parents('#sideBarCustomerSuggestions .product').length==1);},addToTrolley:function(inputButton,eventSender){var productData=getProductDataWithQuantity(inputButton);if(!_.isEmpty(productData)){eventSender.addToTrolley(productData.product,productData.section,getPageType(),productData.section);}},removeFromTrolley:function(inputButton,eventSender){var productData=getProductDataWithDefaultQuantity(inputButton);if(!_.isEmpty(productData)){eventSender.removeFromTrolley(productData.product,productData.section,getPageType(),productData.section);}}};function getProductDataWithQuantity(inputButton){var productData=getProductDataWithDefaultQuantity(inputButton);if(_.isEmpty(productData)){return{};}else{productData.product.quantity=getProductQuantity(inputButton);return productData;}
function getProductQuantity(inputButton){var quantity=jQ(inputButton).parents('form').find('input.quantity').val();return/^\d+$/.test(quantity)&&Number(quantity)||1;}}
function getProductDataWithDefaultQuantity(inputButton){var productData=findProductBySku(getProductSku(inputButton));if(_.isEmpty(productData)){return{};}else{return{section:productData.section,product:{id:productData.sku,name:productData.name,brand:productData.brand,category:productData.category,quantity:1,price:productData.price}};}
function getProductSku(inputButton){var formId=jQ(inputButton).parents('form').attr('id');return!_.isUndefined(formId)&&formId.replace(/^\w+-(\d+)(-\w+)?/,'$1')||'0';}
function findProductBySku(sku){var fopMetaData=jQ('#fopMetaData-'+sku);if(_.isEmpty(fopMetaData)){return{};}else{var product=JSON.parse(fopMetaData.html());var productCollectionName=fopMetaData.attr('data-collection-name');if(productCollectionName.length){product.section=productCollectionName;}else{product.section=getPageType();}
return product;}}}
function getPageType(){var pageType=window.webshop.common.jsVariables.get('pageType');if(_.isEmpty(pageType)){return'Other';}else{return pageType;}}})();webshop.gtm=webshop.gtm||{};webshop.gtm.mixins=webshop.gtm.mixins||{};webshop.gtm.mixins.trolleyButtons=webshop.gtm.mixins.trolleyButtons||{};webshop.gtm.mixins.trolleyButtons.trackingFunctions=webshop.gtm.mixins.trolleyButtons.trackingFunctions||{};webshop.gtm.mixins.trolleyButtons.trackingFunctions.checkoutProductList=(function(){return{isClicked:function(inputButton){return(jQ(inputButton).parents('div.checkoutFop > #boxes').length==1)||(jQ(inputButton).parents('#cowGiftBoxes').length==1)||(jQ(inputButton).parents('#switchedSidebar > .switchedBox').length==1);},addToTrolley:function(inputButton,eventSender){var productData=getProductDataOnCheckoutWalkWithQuantity(inputButton);if(!_.isEmpty(productData)){eventSender.addToTrolley(productData.product,productData.section,'Checkout walk',productData.section);}},removeFromTrolley:function(inputButton,eventSender){var productData=getProductDataOnCheckoutWalkWithDefaultQuantity(inputButton);if(!_.isEmpty(productData)){eventSender.removeFromTrolley(productData.product,productData.section,'Checkout walk',productData.section);}}};function getProductDataOnCheckoutWalkWithQuantity(inputButton){var productData=getProductDataOnCheckoutWalkWithDefaultQuantity(inputButton);if(_.isEmpty(productData)){return{};}else{productData.product.quantity=getProductQuantity(inputButton);return productData;}
function getProductQuantity(inputButton){var quantity=jQ(inputButton).parents('form').find('input.quantity').val();return/^\d+$/.test(quantity)&&Number(quantity)||1;}}
function getProductDataOnCheckoutWalkWithDefaultQuantity(inputButton){var productData=findProductBySku(getProductSku(inputButton));if(_.isEmpty(productData)){return{};}else{return{section:productData.sectionName,product:{id:productData.sku,name:productData.name,brand:productData.brand,category:productData.category,quantity:1,price:productData.price}};}
function getProductSku(inputButton){var formId=jQ(inputButton).parents('form').attr('id');return!_.isUndefined(formId)&&formId.replace(/^\w+-(\d+)(-\w+)?/,'$1')||'0';}
function findProductBySku(sku){var productLists=webshop.common.jsVariables.get('checkoutProducts');productLists=productLists&&productLists.productsInSections||{};var productFound;var productSection;_.forIn(productLists,function(productList,sectionName){productSection=sectionName;productFound=_.find(productList,{sku:sku});return!productFound;});if(!_.isUndefined(productFound)){return _.extend(productFound,{sectionName:productSection});}else{return{};}}}})();webshop.gtm=webshop.gtm||{};webshop.gtm.mixins=webshop.gtm.mixins||{};webshop.gtm.mixins.trolleyButtons=webshop.gtm.mixins.trolleyButtons||{};webshop.gtm.mixins.trolleyButtons.trackingFunctions=webshop.gtm.mixins.trolleyButtons.trackingFunctions||{};webshop.gtm.mixins.trolleyButtons.trackingFunctions.discountClubWidget=(function(){return{isClicked:function(inputButton){return jQ(inputButton).parents('#discountClubWidget').length==1;},addToTrolley:function(inputButton,eventSender){var productData=getProductData(getWidgetModel(),inputButton);if(!_.isEmpty(productData)){eventSender.addToTrolley(productData,'Discount Club Widget',webshop.gtm.discountclub.utils.pageType(),'Discount Club Widget');}},removeFromTrolley:function(inputButton,eventSender){var productData=getProductData(getWidgetModel(),inputButton);if(!_.isEmpty(productData)){eventSender.removeFromTrolley(productData,'Discount Club Widget',webshop.gtm.discountclub.utils.pageType(),'Discount Club Widget');}}};function getProductData(productDataList,inputButton){var productData=_.find(productDataList,{sku:getProductSku(inputButton)});if(_.isUndefined(productData)){return{};}else{return{id:productData.sku,name:productData.name,brand:productData.brand,category:productData.category,quantity:1,price:productData.price}}}
function getProductSku(inputButton){return jQ(inputButton).parents('form').find('input[name="sku"]').val();}
function getWidgetModel(){return webshop.gtm.cache.products||[];}})();webshop.gtm=webshop.gtm||{};webshop.gtm.mixins=webshop.gtm.mixins||{};webshop.gtm.mixins.trolleyButtons=webshop.gtm.mixins.trolleyButtons||{};webshop.gtm.mixins.trolleyButtons.trackingFunctions=webshop.gtm.mixins.trolleyButtons.trackingFunctions||{};webshop.gtm.mixins.trolleyButtons.trackingFunctions.unavailableItems=(function(){return{isClicked:function(inputButton){return jQ(inputButton).parents('.alternativesList').length==1;},addToTrolley:function(inputButton,eventSender){var productData=getProductData(inputButton);if(!_.isEmpty(productData)){eventSender.addToTrolley(productData,'Unavailable items','Unavailable items','Unavailable items');}},removeFromTrolley:function(inputButton,eventSender){var productData=getProductData(inputButton);if(!_.isEmpty(productData)){eventSender.removeFromTrolley(productData,'Unavailable items','Unavailable items','Unavailable items');}}};function getProductData(inputButton){var productData=webshop.common.jsVariables.get('product-alternative-'+getProductSku(inputButton))||{};if(_.isEmpty(productData)){return{};}else{return{id:productData.sku,name:productData.name,brand:productData.brand,category:productData.category,quantity:getProductQuantity(inputButton),price:productData.price}}}
function getProductSku(inputButton){var liId=jQ(inputButton).parents('.productDetails').attr('id');return!_.isUndefined(liId)&&liId.replace(/^\w+-(\d+)$/,'$1')||'0';}
function getProductQuantity(inputButton){return Math.abs(Number(jQ(inputButton).parents('form').find('input[name="quantity"]').val()||1));}})();(function(Backbone,_,ocBackbone,webshop){'use strict';Backbone.Webshop.catalogue.GTMProductClickTracker=Backbone.Marionette.Object.extend({initialize:function(){webshop.gtm.registerEventSource(this);Backbone.$(document.body).on('click','li.fop',this.sendFopProductClickEvent.bind(this));Backbone.$(document.body).on('click','.sponsored .product',this.sendFopProductClickEvent.bind(this));Backbone.$(document.body).on('click','#cowGiftBoxes .productDetails',this.sendFopProductClickEvent.bind(this));Backbone.$(document.body).on('click','#sideBarCustomerSuggestions .product',this.sendFopProductClickEvent.bind(this));Backbone.$(document.body).on('click','#smartTrolley li:not(.ribbon)',this.sendSmartTrolleyProductClickEvent.bind(this));Backbone.$(document.body).on('click','ol.miniTrolley > li',this.sendMiniTrolleyProductClickEvent.bind(this));Backbone.$(document.body).on('click','#discountClubWidget .product',this.sendDiscountClubWidgetProductClickEvent.bind(this));Backbone.$(document.body).on('click','.alternativesList .productDetails',this.sendAlternativeItemProductClickEvent.bind(this));Backbone.$(document.body).on('click','.switchAndSave li.switchOption',this.sendSwitchAndSaveProductClickEvent.bind(this));Backbone.$(document.body).on('click','#switchedSidebar div.switchRemoved',this.sendSwitchAndSaveProductClickEvent.bind(this));Backbone.$(document.body).on('click','#switchedSidebar div.switched',this.sendSwitchAndSaveProductClickEvent.bind(this));},sendFopProductClickEvent:function(event){var sku=getProductSku(event.currentTarget);var productData=Backbone.Webshop.mixins.isCheckout()?findCheckoutProductBySku(sku):findProductBySku(sku);if(!_.isEmpty(productData)){this.trigger('gtm:productClick',{product:{sku:productData.sku,name:productData.name,brand:productData.brand,category:productData.category,price:productData.price,},pageType:getPageType(),sectionTitle:productData.section,position:getPosition(event.currentTarget),});}
function getProductSku(el){var elId=Backbone.$(el).attr('id');return!_.isUndefined(elId)&&elId.replace(/^\w+-(\d+)(-\w+)?/,'$1')||'0';}
function getPosition(el){var $el=Backbone.$(el);if($el.parents('.sponsored').length==1){return $el.parents('.sponsored').find('.product').index($el);}else if($el.parents('#sideBarCustomerSuggestions').length==1){return $el.parents('#sideBarCustomerSuggestions').find('.product').index($el);}else if($el.parents('#cowGiftBoxes').length==1){return $el.parents('#cowGiftBoxes').find('.productDetails').index($el);}else{return $el.parent().find('li.fop').index($el);}}
function findProductBySku(sku){var fopMetaData=Backbone.$('#fopMetaData-'+sku);if(_.isEmpty(fopMetaData)){return{};}else{var product=JSON.parse(fopMetaData.html());var productCollectionName=fopMetaData.attr('data-collection-name');if(productCollectionName.length){product.section=productCollectionName;}else{product.section=getPageType();}
return product;}}
function findCheckoutProductBySku(sku){var productLists=webshop.common.jsVariables.get('checkoutProducts');productLists=productLists&&productLists.productsInSections||{};var productFound;var productSection;_.forIn(productLists,function(productList,sectionName){productSection=sectionName;productFound=_.find(productList,{sku:sku});return!productFound;});if(!_.isUndefined(productFound)){return _.extend(productFound,{section:productSection});}else{return{};}}},sendSmartTrolleyProductClickEvent:function(event){var sku=getProductSku(event.currentTarget);var productData=findProductBySku(sku);if(!_.isEmpty(productData)){this.trigger('gtm:productClick',{product:{sku:productData.sku,name:productData.name,brand:productData.brand,category:productData.category,price:productData.price,},pageType:Backbone.Webshop.mixins.isCheckout()?'Checkout walk':'Smart Trolley',sectionTitle:'Smart Trolley',position:getPosition(event.currentTarget),});}
function getProductSku(li){var liId=Backbone.$(li).attr('id');return!_.isUndefined(liId)&&liId.replace(/^\w+_(\d+)/,'$1')||'0';}
function findProductBySku(sku){var products=webshop.common.jsVariables.get('products');return _.find(products,{sku:sku});}
function getPosition(li){var $li=Backbone.$(li);return $li.parent().find('li:not(.ribbon)').index($li);}},sendMiniTrolleyProductClickEvent:function(event){var sku=getProductSku(event.currentTarget);var productData=findProductBySku(sku);if(!_.isEmpty(productData)){this.trigger('gtm:productClick',{product:{sku:productData.sku,name:productData.name,brand:productData.brand,category:productData.category,price:productData.price,},pageType:getPageType(),sectionTitle:'Mini Trolley',position:getPosition(event.currentTarget),});}
function getProductSku(li){var liId=Backbone.$(li).attr('id');return!_.isUndefined(liId)&&liId.replace(/^basketItem(\d+)/,'$1')||'0';}
function findProductBySku(sku){var products=webshop.basket.HeaderBasket.getMiniTrolleyModel();return _.find(products,{sku:sku});}
function getPosition(li){var $li=Backbone.$(li);return $li.parent().find('li').index($li);}},sendDiscountClubWidgetProductClickEvent:function(event){var sku=getProductSku(event.currentTarget);var productData=findProductBySku(sku);if(!_.isEmpty(productData)){this.trigger('gtm:productClick',{product:{sku:productData.sku,name:productData.name,brand:productData.brand,category:productData.category,price:productData.price,},pageType:getPageType(),sectionTitle:'Discount Club Widget',position:getPosition(event.currentTarget),});}
function getProductSku(li){var liId=Backbone.$(li).attr('id');return!_.isUndefined(liId)&&liId.replace(/^\w+-(\d+)(-\w+)?/,'$1')||'0';}
function findProductBySku(sku){var products=webshop.gtm.cache.products;return _.find(products,{sku:sku});}
function getPosition(li){var $li=Backbone.$(li);return $li.parent().find('.product').index($li);}},sendAlternativeItemProductClickEvent:function(event){var sku=getProductSku(event.currentTarget);var productData=webshop.common.jsVariables.get('product-alternative-'+sku);if(!_.isEmpty(productData)){this.trigger('gtm:productClick',{product:{sku:productData.sku,name:productData.name,brand:productData.brand,category:productData.category,price:productData.price,},pageType:'Unavailable items',sectionTitle:'Unavailable items',position:getPosition(event.currentTarget),});}
function getProductSku(li){var liId=Backbone.$(li).attr('id');return!_.isUndefined(liId)&&liId.replace(/^\w+-(\d+)(-\w+)?/,'$1')||'0';}
function getPosition(li){var $li=Backbone.$(li);return $li.parent().find('.productDetails').index($li);}},sendSwitchAndSaveProductClickEvent:function(event){var sku,position;if(Backbone.$(event.currentTarget).hasClass('switchRemoved')||Backbone.$(event.currentTarget).hasClass('switched')){var divId=Backbone.$(event.currentTarget).attr('id');sku=!_.isUndefined(divId)&&divId.replace(/^(switchRemoved|switched)-(\d+)/,'$2')||'0'
position=Backbone.$(event.currentTarget).parents('#switchedSidebar').find('div.switchRemoved, div.switched').index(Backbone.$(event.currentTarget));}else{var aId=Backbone.$(event.currentTarget).find('a.addBtn').attr('id');if(Backbone.$(event.target).hasClass('ymlOptions')||Backbone.$(event.target).parents('.ymlOptions').length>0){sku=!_.isUndefined(aId)&&aId.replace(/^a-sas-(\d+)-(\d+)/,'$2')||'0'}else{sku=!_.isUndefined(aId)&&aId.replace(/^a-sas-(\d+)-(\d+)/,'$1')||'0'}}
var productData=findCheckoutProductBySku(sku);if(!_.isEmpty(productData)){this.trigger('gtm:productClick',{product:{sku:productData.sku,name:productData.name,brand:productData.brand,category:productData.category,price:productData.price,},pageType:getPageType(),sectionTitle:productData.section,position:!_.isUndefined(position)?position:productData.position,});}
function findCheckoutProductBySku(sku){var productLists=webshop.common.jsVariables.get('checkoutProducts');productLists=productLists&&productLists.productsInSections||{};var productFound;var productSection;_.forIn(productLists,function(productList,sectionName){productSection=sectionName;productFound=_.find(productList,{sku:sku});if(productFound){productFound.position=_.indexOf(productList,productFound);}
return!productFound;});if(!_.isUndefined(productFound)){return _.extend(productFound,{section:productSection});}else{return{};}}},});function getPageType(){if(Backbone.Webshop.mixins.isCheckout()){return'Checkout walk';}
var pageType=webshop.common.jsVariables.get('pageType');if(_.isEmpty(pageType)){return'Other';}else{return pageType;}}
Backbone.$(function(){ocBackbone.gtm=ocBackbone.gtm||{};ocBackbone.gtm.gtmProductClickTracker=ocBackbone.gtm.gtmProductClickTracker||new Backbone.Webshop.catalogue.GTMProductClickTracker();});})(Backbone,_,ocBackbone,webshop);(function(Backbone,webshop){'use strict';Backbone.Webshop.catalogue.GTMReviewEventSender=Backbone.Marionette.Object.extend({initialize:function(){webshop.gtm.registerEventSource(this);},sendReviewGAEvent:function(type){var reviewData={category:'AddReview',action:'Webshop',label:type};this.trigger('gtm:uaEvent',reviewData);}});})(Backbone,webshop);webshop.gtm=webshop.gtm||{};webshop.gtm.mixins=webshop.gtm.mixins||{};webshop.gtm.mixins.trolleyButtons=(function(){var trolleyButton={gtmSendProductAddedToTrolleyEvent:function(inputButton,eventSender){getTrackingFunction(inputButton)['addToTrolley'].call(this,inputButton,eventSender);},gtmSendProductRemovedFromTrolleyEvent:function(inputButton,eventSender){getTrackingFunction(inputButton)['removeFromTrolley'].call(this,inputButton,eventSender);}};if(_.isUndefined(webshop.gtm.mixins.trolleyButtons)){return trolleyButton;}else{return _.extend(webshop.gtm.mixins.trolleyButtons,trolleyButton);}
function getTrackingFunction(inputButton){var functionKeys=trackingFunctionsKeys();var key=_.find(functionKeys,function(functionKey){return _.isPlainObject(webshop.gtm.mixins.trolleyButtons.trackingFunctions[functionKey])&&_.isFunction(webshop.gtm.mixins.trolleyButtons.trackingFunctions[functionKey].isClicked)&&webshop.gtm.mixins.trolleyButtons.trackingFunctions[functionKey].isClicked(inputButton);});return webshop.gtm.mixins.trolleyButtons.trackingFunctions[key];}
function trackingFunctionsKeys(){webshop.gtm.mixins.trolleyButtons.trackingFunctions.unknown=webshop.gtm.mixins.trolleyButtons.trackingFunctions.unknown||{isClicked:function(inputButton){return true;},addToTrolley:function(inputButton,eventSender){},removeFromTrolley:function(inputButton,eventSender){}};var keys=_.reject(_.keys(webshop.gtm.mixins.trolleyButtons.trackingFunctions),function(elem){return elem==='unknown'});keys.push('unknown');return keys;}})();Backbone.Webshop.productView.ProductDetailsGAEventSender=(function(Backbone,webshop){'use strict';return Backbone.Marionette.Object.extend({initialize:function(){webshop.gtm.registerEventSource(this);},sendProductDetailsGAEvent:function(productDetailsDTO,pageType,productListName){this.trigger("gtm:productDetails",productDetailsDTO,pageType,productListName);}});})(Backbone,webshop);webshop.catalogue=webshop.catalogue||{};webshop.catalogue.BackOfPackPopup={analytics:{},socialAdded:false,init:function(){this.bindShowPopup();this.observeEvents();},bindShowPopup:function(){jQ('body').on('click','.openQuickView, .sis_quickView',function(e){e.preventDefault();if(!webshop.catalogue.BackOfPackPopup.socialAdded){webshop.catalogue.socialLinks._registerSocialMedia();webshop.catalogue.BackOfPackPopup.socialAdded=true;}
var urlToRetrievePopupData=jQ(this).find('.quickViewBtn').data('href');if((urlToRetrievePopupData==null)||(urlToRetrievePopupData.length==0)){var quickViewData=jQ(this).find('.sis_quickViewData');if(quickViewData.length){urlToRetrievePopupData=quickViewData.data('href');if(jQ('#sis_analyticsPageType').length){urlToRetrievePopupData+='&analyticsPageType='+jQ('#sis_analyticsPageType').val();}}}
webshop.catalogue.BackOfPackPopup.openBackOfPackPopUpWithDataRetrievedFromUrl(urlToRetrievePopupData);});},openBackOfPackPopUpWithDataRetrievedFromUrl:function(urlToRetrieveData){var self=this;var popup=webshop.popup.create({onClose:function(event){var pageComponentIds=jQ('#bopPopup input[name=pageComponentIdForBQU]').map(function(){return this.value;}).get().join('|');jQ.get('/webshop/createPageEvent.do',{ajax:true,pageEventType:'CLOSE_BOP_POPUP',pageViewId:webshop.common.jsTopBodyVariables.pageViewId,SKU:bop.analytics.sku});jQ("#popOutWrap").children().remove();}});popup.container.addClass('spinner');var bop=webshop.catalogue.BackOfPackPopup;jQ.get(urlToRetrieveData,{ajax:true,pageViewId:webshop.common.jsTopBodyVariables.pageViewId},function(data){self.putDataInPopup(data,popup,bop);webshop.catalogue.socialLinks.gpload();webshop.catalogue.socialLinks.fbload();if(webshop.common.jsVariables.get('gaTrackPromos')){webshop.gtm.PromotionImpressionsTracker.sendPromotionImpressionsData(popup.container,'Quick view');}});},putDataInPopup:function(data,popup,bop){popup.container.children(':not(.close)').remove();popup.container.removeClass('spinner').append(data);this.sendProductDetailsToGA();webshop.catalogue.Gallery.bind();popup.container.find('.productDetails').jScrollPane({showArrows:true,animateScroll:true,animateDuration:200});jQ(document.body).trigger('webshop:sc:bind');webshop.catalogue.ColourSwatch.register(jQ('.colourSwatch'),jQ('#galleryImages li'),popup.container.find('.productPriceInfo'));var isMultiDimensionSel=(jQ('input[name="isMultiDimension"]').val()==='true');if(!isMultiDimensionSel){jQ('.colourSwatch a').on('click',function(e){e.preventDefault();jQ.get(jQ(this).attr('href'),{ajax:true},function(data){webshop.catalogue.BackOfPackPopup.putDataInPopup(data,popup,bop);webshop.catalogue.socialLinks.gpload();webshop.catalogue.socialLinks.fbload();});});jQ('.pg_select').on('change',function(e){var selectedIndex=jQ(this).prop("selectedIndex");e.preventDefault();jQ.get(jQ(jQ('.pg_select option')[selectedIndex]).attr('data-href'),{ajax:true},function(data){webshop.catalogue.BackOfPackPopup.putDataInPopup(data,popup,bop);if(selectedIndex!=-1){jQ(".pg_select option[value="+ -1+"]").attr("disabled","disabled");}
return;});});}else{webshop.catalogue.PGMultiDimensionSelection.init();}},sendProductDetailsToGA:function(){var productDetailsDTOSelector=jQ("#quickViewProductDetailsDTO");new Backbone.Webshop.productView.ProductDetailsGAEventSender().sendProductDetailsGAEvent(JSON.parse(productDetailsDTOSelector.html()),"Quick view","Quick view");},observeEvents:function(){jQ(document).on('webshop:bopPopup:contentChanged',function(){var jspApi=jQ('#bopPopup .productPriceInfo').data('jsp');if(jspApi){jspApi.reinitialise();}});}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.AddButton={init:function(){_.extend(this,webshop.gtm.mixins.trolleyButtons);this.observeForms();this.observeBasketEvents();},observeBasketEvents:function(){document.observe('webshop:basket:update',function(evt){var jsonData=evt.memo.data;if(jsonData){if(jsonData.lastItemUpdated){var forms=jQ('ul.textView form.addButton-'+jsonData.lastItemUpdated.sku);if(forms.length){for(var i=0,len=forms.length;i<len;i++){this.updateForm(forms[i],jsonData.lastItemUpdated);}}
this.updateCoupon(jsonData.lastItemUpdated);}
if(jsonData.response){webshop.common.Util.displayAddedMessage(jsonData.response,jsonData.responseDuration);}}}.bind(this));},observeForms:function(){var eventSender=new ocBackbone.gtm.TrolleyEventSender();jQ(document.body).on('click','.addButton input.productAdd, .addButton input.Add, '+'.addProductForm input.productAdd, '+'.addButton input.ymlAdd, .addButton input.altAdd, '+'.Fav input.ymlAdd',(function(clazz){return function(e){if(webshop.common.jsVariables.get('gaTrackBasketUpdateOnSuccess')){var domElement=this;webshop.catalogue.Util.sendUpdateBasketRequest.call(domElement,e,clazz,function(){if(jQ(domElement).parents('.giftContainer.added').length==1){clazz.gtmSendProductRemovedFromTrolleyEvent(domElement,eventSender);}else{clazz.gtmSendProductAddedToTrolleyEvent(domElement,eventSender);}});}else{if(webshop.catalogue.Util.sendUpdateBasketRequest.call(this,e,clazz)){if(jQ(this).parents('.giftContainer.added').length==1){clazz.gtmSendProductRemovedFromTrolleyEvent(this,eventSender);}else{clazz.gtmSendProductAddedToTrolleyEvent(this,eventSender);}}}};})(this));observeQuantityInputs();function observeQuantityInputs(){jQ(document.body).on('keydown','.productQuantity input.quantity',function(e){var charCode=e.keyCode;if((charCode>57&&charCode<96)||charCode>105){return false;}}).on('input','.productQuantity input.quantity',function(e){var field=jQ(this),maxLength=Number(field.attr("maxLength")||2),val=this.value;if(val.length>maxLength){field.val(val.slice(0,maxLength));}});}},updateForm:function(form,jsonData){if(jsonData.itemQuantity==='0'){jQ(form).show();}else{jQ(form).hide();}},updateCoupon:function(jsonData){if(jsonData.itemQuantity==='0'){jQ('.coupon-info').removeClass('selected');}else{jQ('.coupon-info').addClass('selected');}}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.AddButtonWithIndicator={init:function(){_.extend(this,webshop.gtm.mixins.trolleyButtons);this.observeForms();this.observeBasketEvents();},observeForms:function(){var eventSender=new ocBackbone.gtm.TrolleyEventSender();jQ(document.body).on('click','input.productAdd, '+'input.altAdd, input.ymlAdd',(function(clazz){return function(e){if(webshop.common.jsVariables.get('gaTrackBasketUpdateOnSuccess')){var domElement=this;webshop.catalogue.Util.sendUpdateBasketRequest.call(domElement,e,clazz,function(){clazz.gtmSendProductAddedToTrolleyEvent(domElement,eventSender);});}else{if(webshop.catalogue.Util.sendUpdateBasketRequest.call(this,e,clazz)){clazz.gtmSendProductAddedToTrolleyEvent(this,eventSender);}}};})(this));jQ(document.body).on('click','input.productMinusTrolley',(function(clazz){return function(e){if(webshop.common.jsVariables.get('gaTrackBasketUpdateOnSuccess')){var domElement=this;webshop.catalogue.Util.sendUpdateBasketRequest.call(domElement,e,clazz,function(){clazz.gtmSendProductRemovedFromTrolleyEvent(domElement,eventSender);});}else{if(webshop.catalogue.Util.sendUpdateBasketRequest.call(this,e,clazz)){clazz.gtmSendProductRemovedFromTrolleyEvent(this,eventSender);}}};})(this));jQ(document.body).on('click','input.productMinusMIS, input.productPlusMIS',function(){var quantityField=jQ(this).parent().find('input.quantity');var q=quantityField.val();if(this.value=='Minus'){q--;}else{q++;}
if(quantityField.hasClass('editing')){quantityField.val(q<0?0:q);}else{quantityField.val(q||1);}
return false;});},observeBasketEvents:function(){document.observe('webshop:basket:update',function(evt){var jsonData=evt.memo.data;if(jsonData){if(jsonData.lastItemUpdated){var forms=jQ('form.addButtonWithIndicator-'+jsonData.lastItemUpdated.sku);if(forms.length){for(var i=0,len=forms.length;i<len;i++){this.updateForm(forms[i],jsonData.lastItemUpdated);}}}}}.bind(this));},updateForm:function(form,jsonData){webshop.catalogue.Util.removeLatestInTrolleyClassFromOtherIndicators(jsonData.sku,jsonData.itemQuantity);var indicatorIsAlreadyPresent=jQ(form).find('span.indicator').length>0;var formActionUrl=form.getAttribute('action');var updateBasketUrl=formActionUrl.replace('addToBasket.do','updateBasket.do').replace('addToBasketFromCheckout.do','updateBasket.do').replace('addToBasketFromCheckoutRecommendations.do','updateBasket.do')
var addToBasketUrl=formActionUrl.replace('updateBasket.do','addToBasket.do');if(jsonData.itemQuantity==='0'){jQ(form).find('label.productCount').remove();jQ(form).find('input.productMinusTrolley').remove();jQ(form).find('span.addBtn').remove();jQ(form).find('span.indicator').remove();this.renderNotInTrolley(form,jsonData);this._styleNotInTrolley(form);form.setAttribute('action',addToBasketUrl);}else if(indicatorIsAlreadyPresent){var span=jQ(form).find('label.productCount').first();var showDescription=jQ(form).find('.showDescription')[0].getAttribute("value")!=="false";span.text(this._getItemDescription(jsonData,showDescription));form.setAttribute('action',updateBasketUrl);}else{jQ(form).find('label.productQuantity').remove();jQ(form).find('span.addBtn').remove();jQ(form).find('input.productMinusMIS').remove();jQ(form).find('input.productPlusMIS').remove();jQ(form).find('span.productMinus').remove();this.render(form,jsonData);form.setAttribute('action',updateBasketUrl);}
if(jsonData.itemQuantity!=='0'){this.styleInTrolley(form,jsonData.sku,true);}},render:function(form,jsonData){var currentForm=jQ(form),incrementWrapper=jQ('<span />').addClass('addBtn btn-prominence').text(getMessage('catalogue.addButton.addBtnText')),increment=jQ('<input />').addClass('productAdd').attr({'type':'submit','name':'quantity','title':getMessage('catalogue.addButton.addOneToTrolleyInputTitle',jsonData.description)}).val('1'),showDescription=currentForm.find('.showDescription')[0].getAttribute("value")!=="false",productCount=jQ('<label />').addClass('productCount').text(this._getItemDescription(jsonData,showDescription));var decrement="";var shouldShowDecrement=!form.action.match("addToBasketMissedPromo");if(shouldShowDecrement){decrement=jQ('<input />').addClass('productMinusTrolley').attr({'type':'submit','name':'quantity','title':getMessage('catalogue.addButton.removeOneFromTrolleyInputTitle',jsonData.description)}).val('-1');}
webshop.catalogue.Util.removeLatestInTrolleyClassFromOtherIndicators(jsonData.sku,jsonData.itemQuantity);if(currentForm.hasClass('adjustableQuantity')){currentForm.removeClass('suggestedOrderForm');}
currentForm.prepend('<span class="indicator" />');currentForm.find('span.indicator').append(productCount).append(decrement).after(incrementWrapper);incrementWrapper.append(increment);},renderNotInTrolley:function(form,jsonData){webshop.catalogue.Util.removeLatestInTrolleyClassFromOtherIndicators(jsonData.sku,jsonData.itemQuantity);var quantityInput=new Element('input',{'type':'text','name':'quantity','size':2,'maxlength':2,'value':jQ(form).find('[name=originalQuantity]').val()||1,'class':'quantity'});var productAddWrapper=new Element('span',{'class':'addBtn btn-prominence'});var productAdd=new Element('input',{'class':'productAdd','type':'submit','name':'addproduct','title':getMessage('catalogue.addButton.addToTrolleyInputTitle',jsonData.description)});var label="";if(jQ(form).hasClass('adjustableQuantity')){jQ(form).addClass('addProductForm suggestedOrderForm');var minus=new Element('input',{'class':'productMinusMIS','type':'submit','value':'Minus','title':getMessage('catalogue.addButton.removeOneFromTrolleyInputTitle',jsonData.description)});var plus=new Element('input',{'class':'productPlusMIS','type':'submit','value':'Plus','title':getMessage('catalogue.addButton.addOneToTrolleyInputTitle',jsonData.description)});label=new Element('label',{'class':'productQuantity'});jQ(form).append([minus,label,plus,productAddWrapper]);}else if(jQ(form).hasClass('singleButton')){jQ(form).append([productAddWrapper]);}else{var decrement=new Element('span',{'class':'productMinus'});label=new Element('label',{'class':'productQuantity'}).insert("<abbr title=\""+getMessage('catalogue.addButton.quantityAbbrTitle')+"\">"+getMessage('catalogue.addButton.quantityAbbrValue')+"</abbr> ");jQ(form).append([label,decrement,productAddWrapper]);}
if(jQ(label).hasClass('productQuantity')){label.insert(quantityInput);}else if(jQ(label).hasClass('typicalPrice')){label.innerHTML=jsonData.itemCataloguePrice;}
jQ(productAddWrapper).text(getMessage('catalogue.addButton.addBtnText')).append(productAdd);},styleInTrolley:function(form,sku,latest){if(latest){jQ(form).parent().parent('div.alternative').addClass('inTrolleyBorder');jQ(form).parent().parent().parent('li').addClass('shelfLastInTrolley');jQ(form).parent('div.fopBox').addClass('shelfLastInTrolley');}
jQ(form).parent().parent().parent('li').addClass('shelfInTrolley');jQ(form).parent('div.fopBox').addClass('shelfInTrolley');jQ(form).attr('id','inTrolley-'+sku);},_styleNotInTrolley:function(form){jQ(form).parent().parent().parent('li').removeClass('shelfInTrolley');jQ(form).parent('div.fopBox').removeClass('shelfInTrolley');},_getItemDescription:function(jsonData,showDescription){var description=" "+jsonData.itemQuantity;description+=showDescription?" x "+unescape(jsonData.shortDescription):"";description+=(showDescription&&jsonData.catchweight)?", "+jsonData.catchweight:"";return description+" "+getMessage('catalogue.addButton.descSufixInTrolley');}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.AddToLinks={init:function(){if(!jQ('#psRecommendationContent').length){this.observeLinks();}
this.showMessageIfSet();},showMessageIfSet:function(){if(jQ('#addedMessage').css('display')==='block'){var displayDuration=jQ('#addedMessageDisplayDuration').attr('value');if(displayDuration){webshop.common.Util.displayAddedMessage(null,displayDuration);}else{webshop.common.Util.displayAddedMessage();}}},observeLinks:function(){var a=webshop.catalogue.AddToLinks;jQ('ul.productList, #boxes, #listWrapper').on('click','p.addToLinks a.addToAList',a._registerAddToListLink);jQ('ul.productList, #boxes, #listWrapper').on('click','p.addToLinks a.addToFaves',a._registerAddToFavouritesLink);jQ('ul.productList, #boxes, #listWrapper').on('click','p.addToLinks a.removeFromFaves',a._registerRemoveFromFavouritesLink);},trackFavouritesUpdate:function(eventType,sku){jQ.get('/webshop/createPageEvent.do',{ajax:true,pageEventType:eventType,SKU:sku});if(webshop.catalogue.AddToLinks.isFromFavourites()&&!webshop.catalogue.AddToLinks.isPagination()){if(eventType=='REMOVE_FROM_FAVOURITES'){var productLi=jQ('#productDetails-'+sku);var isShelfView=productLi.parent().hasClass('shelfView');var pageComponentId;if(isShelfView){pageComponentId=productLi.find('input.analyticsPageComponent').attr('id');}else{pageComponentId=productLi.prev('input.analyticsPageComponent').attr('id');}}}},_registerAddToFavouritesLink:function(event){var addToFavouritesLink=this;var sku=webshop.catalogue.AddToLinks.getSku(addToFavouritesLink);var url='/webshop/addToFavourites.do?sku='+sku+'&ajax=ajax';webshop.catalogue.AddToLinks.trackFavouritesUpdate('ADD_TO_FAVOURITES',sku);var isSeeAll=webshop.catalogue.AddToLinks.isSeeAll();if(jQ('select#sortBy').length){var isFavouritesFirst=jQ('select#sortBy').val()==='default';if(isFavouritesFirst&&!isSeeAll){jQ.ajax({'url':url}).done(function(data){var message=data.response;if(message!=null){webshop.common.Util.displayAddedMessage(message);webshop.catalogue.AddToLinks.switchFromAddToRemove(jQ(addToFavouritesLink),sku);webshop.catalogue.AddToLinks.updatePaginator();}});event.preventDefault();return;}}
jQ.ajax({'url':url}).done(function(data){var message=data.response;if(message!=null){webshop.common.Util.displayAddedMessage(message);if(webshop.catalogue.AddToLinks.isClustered()&&webshop.catalogue.AddToLinks.isPagination()){jQ('ul.productList').trigger('reloadItems',function(){webshop.catalogue.AddToLinks.updateProductsCount();webshop.catalogue.AddToLinks.displayProductsCount();jQ('ul.productList').trigger('webshop:clusters:update');});}else{webshop.catalogue.AddToLinks.switchFromAddToRemove(jQ(addToFavouritesLink),sku);}}});event.preventDefault();},_registerRemoveFromFavouritesLink:function(event){var removeFromFavouritesLink=this;var sku=webshop.catalogue.AddToLinks.getSku(removeFromFavouritesLink);var url='/webshop/deleteFavouritesItem.do?sku='+sku+'&ajax=ajax';webshop.catalogue.AddToLinks.trackFavouritesUpdate('REMOVE_FROM_FAVOURITES',sku);var isSeeAll=webshop.catalogue.AddToLinks.isSeeAll();var isFavouritesFirst=false;if(jQ('select#sortBy').length){isFavouritesFirst=jQ('select#sortBy').val()==='default';}
if(jQ('#shopFavourites').length||jQ('body.promoOnFavs').length||jQ('#isFavouritesPage').length){jQ.ajax({'url':url}).done(function(data){var message=data.response;if(message!=null){webshop.common.Util.displayAddedMessage(message);webshop.catalogue.AddToLinks.reduceProductsCount();var product=jQ('#productDetails-'+sku);if(isSeeAll){webshop.catalogue.AddToLinks.removeFavouriteProduct(product,function(){jQ('ul.productList').trigger('favouriteDeleted');});webshop.catalogue.AddToLinks.displayProductsCount();}
else{webshop.catalogue.AddToLinks.updatePaginatorAfterRemovedFavourite(product);}}});event.preventDefault();return;}
else if(isFavouritesFirst){if(isSeeAll){jQ.ajax({'url':url}).done(function(data){var message=data.response;if(message!=null){webshop.common.Util.displayAddedMessage(message);if(webshop.catalogue.AddToLinks.isClustered()&&webshop.catalogue.AddToLinks.isPagination()){jQ('ul.productList').trigger('reloadItems',function(){webshop.catalogue.AddToLinks.updateProductsCount();webshop.catalogue.AddToLinks.displayProductsCount();jQ('ul.productList').trigger('webshop:clusters:update');});}else{webshop.catalogue.AddToLinks.fetchLastProductIfNeeded(sku,jQ(removeFromFavouritesLink));}}});}
else{jQ.ajax({'url':url}).done(function(data){var message=data.response;if(message!=null){webshop.common.Util.displayAddedMessage(message);webshop.catalogue.AddToLinks.switchFromRemoveToAdd(jQ(removeFromFavouritesLink),sku);webshop.catalogue.AddToLinks.updatePaginator();}});}
event.preventDefault();return;}
jQ.ajax({'url':url}).done(function(data){var message=data.response;if(message!=null){webshop.common.Util.displayAddedMessage(message);webshop.catalogue.AddToLinks.switchFromRemoveToAdd(jQ(removeFromFavouritesLink),sku);}});event.preventDefault();},_registerAddToListLink:function(event){var skus=[];var fop=jQ(this).parents("li");var quantity=fop.find('label.productCount').html();quantity=quantity?quantity.match('[0-9]+')[0]:fop.find('input.quantity[name=quantity]').val();var img=fop.find('.productImageContainer img')[0];var productTitle=fop.find('.productTitle').text();skus.push({sku:webshop.catalogue.AddToLinks.getSku(this),alt:productTitle||'poduct',src:img?img.src:'/webshop/static/images/noImage140.jpg',quantity:quantity});webshop.dialogs.AddToList.showPopup(skus,{successMessage:true,source:"Front of pack"});event.preventDefault();},getSku:function(elem){var skuAttr=jQ(elem).parents("li").attr("id");var sku=skuAttr.substring("productDetails-".length);var productPrice=jQ(elem).parent().parent("div.productPrice");if(productPrice.length){var scSku=productPrice.find(".addButtonSku");if(scSku.length){sku=scSku.val();}}
return sku;},fetchLastProductIfNeeded:function(sku,removeFromFavsLink){var currentlyDisplayed=jQ('ul.productList li.productDetails').length;var url=jQ('div.switchView form').first().attr('action').replace(/&view=[a-zA-Z]+/,'')+'&getIndexOf='+sku+'&currentlyDisplayed='+currentlyDisplayed+'&ajax=ajax';jQ.ajax({'url':url}).done(function(data){var fetchLastProduct=!data.response;if(fetchLastProduct){var product=jQ(removeFromFavsLink).parents('li.productDetails');webshop.catalogue.AddToLinks.removeFavouriteProduct(product,function(){jQ('ul.productList').trigger('favouriteDeleted');});}else{webshop.catalogue.AddToLinks.switchFromRemoveToAdd(removeFromFavsLink,sku);}});},reduceProductsCount:function(){var total=jQ('#itemsTotal');var totalNumber=total.length===0?0:parseInt(total.attr('value'),10);totalNumber=totalNumber>0?totalNumber-1:0;total.attr('value',totalNumber);},updateProductsCount:function(){jQ("#itemsTotal").attr('value',webshop.page.itemsTotal);jQ("#itemsFiltered").attr('value',webshop.page.itemsFiltered);},displayProductsCount:function(){var totalNumber=parseInt(jQ('#itemsTotal').attr('value'),10);var filtered=jQ('#itemsFiltered').length===0?0:parseInt(jQ('#itemsFiltered').attr('value'),10);var html='<em>'+totalNumber+' '+(totalNumber!==1?getMessage('catalogue.addToLinks.itemCounterOneProduct'):getMessage('catalogue.addToLinks.itemCounterManyProducts'))+'</em>';if(filtered){html+=filtered!==0?' ('+filtered+' '+getMessage('catalogue.addToLinks.itemCounterFiltered')+')':'';}
jQ('h2#productCount span').html(html);},removeFavouriteProduct:function(product,callback){product.fadeOut('fast',function(){jQ(this).remove();if(callback){callback.call();}});},updatePaginatorAfterRemovedFavourite:function(product){if(webshop.catalogue.AddToLinks.isPagination()){var isLastProductOnPage=jQ('ul.productList li.productDetails').length<=1;jQ(window).trigger('hashchange',{fromFavourites:true,'isLastProductOnPage':isLastProductOnPage});}
else{webshop.catalogue.AddToLinks.removeFavouriteProduct(product);webshop.catalogue.AddToLinks.displayProductsCount();}},updatePaginator:function(){if(webshop.catalogue.AddToLinks.isPagination()){jQ(window).trigger('hashchange',{fromFavourites:true,isLastProductOnPage:false});}},switchFromRemoveToAdd:function(removeFromFavouritesLink,sku){var productContainer=removeFromFavouritesLink.closest('li');productContainer.removeClass('boughtBeforeHighlight');productContainer.find('div.productDescription, div.shelfTop').removeClass('inFavourites');removeFromFavouritesLink.removeClass('removeFromFaves').addClass('addToFaves secondary');removeFromFavouritesLink.attr('title',getMessage('catalogue.addToLinks.addToFavTitle'));removeFromFavouritesLink.attr('href','/webshop/addToFavourites.do?sku='+sku);removeFromFavouritesLink.text(getMessage('catalogue.addToLinks.addToFavValue'));removeFromFavouritesLink.prepend('<em class="icon"></em>');},switchFromAddToRemove:function(addToFavouritesLink,sku){var productContainer=addToFavouritesLink.closest('li');if(productContainer.parents('ul').hasClass('shelfView')){productContainer.addClass('boughtBeforeHighlight');}
productContainer.find('div.productDescription, div.shelfTop').addClass('inFavourites');addToFavouritesLink.removeClass('addToFaves').addClass('removeFromFaves secondary');addToFavouritesLink.attr('title',getMessage('catalogue.addToLinks.removeFromFavTitle'));addToFavouritesLink.attr('href','/webshop/deleteFavouritesItem.do?sku='+sku);addToFavouritesLink.text(getMessage('catalogue.addToLinks.removeFromFavText'));addToFavouritesLink.prepend('<em class="icon"></em>');},isSeeAll:function(){return!(jQ('#itemsPerPage').length===0?0:parseInt(jQ('#itemsPerPage').val(),10));},isClustered:function(){return jQ('h2.clusterHeader').length>0;},reloadThePage:function(url){var index=/index=[0-9]+/.exec(window.location);if(index!==null){url+='&'+index[0];}
window.location=url;},isFromFavourites:function(){return window.top.location.pathname.match('displayPrevPurchases.do');},isPagination:function(){return jQ('ul.pages').length;}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.AlternativesAddButtonWithIndicator={init:function(){this.observeForms();this.observeBasketEvents();},observeForms:function(){jQ(document.body).on('click','.alternativesAddButtonWithIndicator input.increment, .alternativesAddButtonWithIndicator input.decrement, '+'.alternativesAddButtonWithIndicator input.altAdd, .alternativesAddButtonWithIndicator input.ymlAdd',(function(clazz){return function(e){webshop.catalogue.Util.sendUpdateBasketRequest.call(this,e,clazz);};})(this));},observeBasketEvents:function(){document.observe('webshop:basket:update',function(evt){var jsonData=evt.memo.data;if(jsonData&&jsonData.lastItemUpdated){var forms=jQ('form.alternativesAddButtonWithIndicator-'+jsonData.lastItemUpdated.sku);for(var i=0,len=forms.length;i<len;i++){this.updateForm(jQ(forms[i]),jsonData.lastItemUpdated);}}}.bind(this));},updateForm:function(form,jsonData){webshop.catalogue.Util.removeLatestInTrolleyClassFromOtherIndicators(jsonData.sku,jsonData.itemQuantity);var indicatorIsAlreadyPresent=form.find('input.decrement').length>0;if(jsonData.itemQuantity==0){form.find('span.controlButtons').remove();var indicator=this.renderNotInTrolley(form,jsonData);form.prepend(indicator).css('display','block');this._styleNotInTrolley(form);var newUrl=form.attr('action').replace('updateBasket.do','addToBasket.do');form.attr('action',newUrl);}else if(indicatorIsAlreadyPresent){var span=form.find('span.productCount').first();var showDescription=form.find('.showDescription')[0].getAttribute("value")!=="false";span.html(this._getItemDescription(jsonData,showDescription));var newUrl=form.attr('action').replace('addToBasket.do','updateBasket.do');form.attr('action',newUrl);}else{form.find('span.controlButtons').remove();var indicator=this.renderInTrolley(form,jsonData);form.prepend(indicator).css('display','block');var newUrl=form.attr('action').replace('addToBasket.do','updateBasket.do');form.attr('action',newUrl);}
if(jsonData.itemQuantity!=0){this.styleInTrolley(form,true);}},renderNotInTrolley:function(form,jsonData){webshop.catalogue.Util.removeLatestInTrolleyClassFromOtherIndicators(jsonData.sku,jsonData.itemQuantity);var span=jQ('<span></span>').addClass('controlButtons'),label=jQ('<label></label>').addClass('productPrice').html(this._getItemPrice(jsonData)+this._getDiscountClubIcon(jsonData)),decrement=jQ('<span></span>').addClass('productMinus'),increment=jQ('<input/>').addClass('ymlAdd').attr({'type':'submit','name':'quantity','title':getMessage('catalogue.alternativesAddButton.addToTrolleyInputTitle',jsonData.description)}).val('1'),qty=jQ('<input/>').attr({'type':'hidden','name':'quantity'}).val('1');return span.append(label).append(decrement).append(increment).append(qty);},renderInTrolley:function(form,jsonData){webshop.catalogue.Util.removeLatestInTrolleyClassFromOtherIndicators(jsonData.sku,jsonData.itemQuantity);var span=jQ('<span></span>').addClass('controlButtons'),showDescription=form.find('.showDescription').val()!=="false",productCount=jQ('<span></span>').addClass('productCount').html(this._getItemDescription(jsonData,showDescription)),price=jQ('<label></label>').addClass('productPrice').html(this._getItemPrice(jsonData)+this._getDiscountClubIcon(jsonData)),decrement=jQ('<input/>').addClass('decrement').attr({'type':'submit','name':'quantity','title':getMessage('catalogue.alternativesAddButton.removeOneFromTrolleyInputTitle',jsonData.description)}).val('-1'),increment=jQ('<input/>').addClass('increment').attr({'type':'submit','name':'quantity','title':getMessage('catalogue.alternativesAddButton.addOneToTrolleyInputTitle',jsonData.description)}).val('1');return span.append(productCount).append(price).append(decrement).append(increment);},styleInTrolley:function(form,latest){if(latest){form.parent('div.alternative').addClass('inTrolleyBorder');form.parent().parent('li').addClass('shelfLastInTrolley');form.parent('div.fopBox').addClass('shelfLastInTrolley');}
form.addClass('inTrolley');form.parent('div.fopBox').addClass('shelfInTrolley');},_styleNotInTrolley:function(form){form.removeClass('inTrolley');},_getItemPrice:function(jsonData){var price=""+jsonData.itemCataloguePrice;return price;},_getDiscountClubIcon:function(jsonData){var iconHTML='<img class="sp" src="/webshop/static/images/icons/discountClub.png" alt="'+getMessage('catalogue.alternativesAddButton.discountClubIconAlt')+'" title="'+getMessage('catalogue.alternativesAddButton.discountClubIconTitle')+'">';if(jsonData.discountClubIcon){return iconHTML;}
return'';},_getItemDescription:function(jsonData,showDescription){var description=" "+jsonData.itemQuantity;description+=showDescription?" x "+unescape(jsonData.shortDescription):"";description+=(showDescription&&jsonData.catchweight)?", "+jsonData.catchweight:"";return description+" "+getMessage('catalogue.alternativesAddButton.descSuffixInTrolley');}};webshop.catalogue=webshop.catalogue||{};jQuery(document).ready(function(){webshop.catalogue.BackOfPack.scrollToReviews();if(document.getElementById('bopRight')){webshop.catalogue.socialLinks._registerSocialMedia();}});webshop.catalogue.BackOfPack={init:function(){this.registerPageListeners();webshop.popup.bind();this.favouritesEventTracker=Backbone.Webshop.FavouritesEventTracker&&Backbone.Webshop.FavouritesEventTracker.getInstance();this.shoppingListsEventTracker=Backbone.Webshop.ShoppingListEventTracker&&Backbone.Webshop.ShoppingListEventTracker.getInstance();},popup:null,registerPageListeners:function(){this._registerFavouritesAddRemove();this._registerCorrectionBox();this._registerImageGallery();this._registerReadAllReviews();if(webshop.common.jsVariables.get('addReviewTracking')){this._addReviewTrackingParameter();}
this._registerReviewPopup();this._registerHelpfulReviewListener();this._registerProductGroupListeners();var sku=document.getElementById('sku');if(sku){this._registerAddToList(jQ(sku).val());}},scrollToReviews:function(){var localLink=window.location.hash;var reg=/(#review)(\d+)/;if(localLink=="#reviewsSectionHeader"||localLink=="#reviewsTopSection"||reg.exec(localLink)!=null){var reviewsHeader=jQ(localLink);var top=reviewsHeader.offset().top;var headerHeight=jQ('#fix').css('position')==="fixed"?jQ('#fix').outerHeight():0;jQ('html,body').animate({scrollTop:top-headerHeight},200);}},_registerCorrectionBox:function(){var actionUrl=jQ("#correctionForm").attr('action');if(actionUrl){var updatedActionUrl=actionUrl.replace("#correctionExpander","");jQ("#correctionForm").attr('action',updatedActionUrl);}
jQ("#correctionForm").on('submit',function(){jQ.ajax({url:jQ(this).attr('action'),data:{correctionType:jQ("#correctionType").val(),comments:jQ("#comments").val(),sku:jQ("#sku").val(),ajax:true},success:webshop.catalogue.BackOfPack.updateCorrectionBox});return false;});},_registerAddToList:function(sku){if(jQ('#addToListLink').length){jQ('#addToListLink').off('click');jQ('#addToListLink').on('click',function(event){event.preventDefault();var img=jQ(this).prev('img')[0];webshop.dialogs.AddToList.showPopup([{sku:sku?sku:this.href.match(/sku=([0-9]+)/)[1],url:document.URL,alt:img.alt,src:img.src,quantity:jQ('input.quantity').val()}],{successMessage:true,source:'Back of pack'});webshop.catalogue.BackOfPack.shoppingListsEventTracker.triggerShoppingListPopupOpened();});}},_registerFavouritesAddRemove:function(){jQ('#addToFavouritesLink').on('click',{eventType:'ADD_TO_FAVOURITES'},this.favouritesListener);jQ('#removeFromFavouritesLink').on('click',{eventType:'REMOVE_FROM_FAVOURITES'},this.favouritesListener);},_registerReadAllReviews:function(){var link=jQ('a[name="readAllReviews"]');link.on('click',function(e){var top=jQ('#reviewsSectionHeader').offset().top;var headerHeight=jQ('#fix').css('position')==="fixed"?jQ('#fix').outerHeight():0;jQ('html,body').animate({scrollTop:top-headerHeight},200);e.preventDefault();});},_addReviewTrackingParameter:function(){var link=jQ('a.writeReview, a.js-writeReview');var _href=link.attr("href");var source='BOP';if(!_.isEmpty(document.URL.match(/reviews=true/))){source='FOP';}
if(_href){if(_href.indexOf('?')>-1){link.attr("href",_href+'&source='+source);}else{link.attr("href",_href+'?source='+source);}}},_registerReviewPopup:function(){var previewOnclose,loadPreviewPopup,loadWritePopup,link,cancelLink;loadPreviewPopup=function(form){webshop.catalogue.BackOfPack.popup.container.find('div').css({display:'none'});webshop.catalogue.BackOfPack.popup.container.id="previewReviewPopup";webshop.catalogue.BackOfPack.popup.container.addClass('spinner ratingsPreviewPopup').removeClass("dialogRatings").position('center');jQ.get(form.attr('action')+'?ajax=true',webshop.ajax.Util.getFormDataAsJSON(form),function(data){if(jQ(data).find('.error, .error-backend').length>0){webshop.catalogue.BackOfPack.popup.container.id="reviewPopup";webshop.catalogue.BackOfPack.popup.container.removeClass("ratingsPreviewPopup").addClass("dialogRatings").position('center');loadWritePopupSuccessMethod(data);webshop.catalogue.BackOfPack.popup.container.position('center');}else{webshop.catalogue.BackOfPack.popup.container.find('div').remove();webshop.catalogue.BackOfPack.popup.container.removeClass('spinner').append(data).position('center');link=jQ('#backToEditReview');link.on('click',function(e){e.preventDefault();loadWritePopup(link.attr('href'));});cancelLink=jQ('#cancelPreviewReviewPopup');cancelLink.on('click',function(e){webshop.catalogue.BackOfPack.popup.hide(e);});var reviewForm=jQ('#reviewForm');reviewForm.on('submit',function(e){link=reviewForm.attr('action');e.preventDefault();jQ.ajax({url:link+'?ajax=true',type:'POST',data:reviewForm.serialize(),success:function(){sendAddReviewTrackingData();location.reload();},error:replaceSubmitButtonsWithErrorMessage});});}});};function sendAddReviewTrackingData(){var source=(!_.isEmpty(document.URL.match(/reviews=true/)))?'FOP':'BOP';new Backbone.Webshop.catalogue.GTMReviewEventSender().sendReviewGAEvent(source);};function replaceSubmitButtonsWithErrorMessage(){errorMessage='<span class="warning">'+getMessage('review.recipePage.serverError')+'</span>';exclamationMark='<span class="exclamation_mark"></span>';errorContent='<div class="reviewServiceError">'+exclamationMark+errorMessage+'</div>';jQ('.ratingsActions').replaceWith(errorContent);};loadWritePopup=function(link){if(!webshop.catalogue.BackOfPack.popup){webshop.catalogue.BackOfPack.popup=webshop.popup.create({wrapperId:"reviewPopup",onClose:function(){webshop.catalogue.BackOfPack.popup=null}});webshop.catalogue.BackOfPack.popup.container.addClass('spinner dialogRatings').position('center');}else{webshop.catalogue.BackOfPack.popup.container.id="reviewPopup";webshop.catalogue.BackOfPack.popup.container.addClass('spinner dialogRatings').removeClass("ratingsPreviewPopup").position('center');}
jQ.ajax({url:link+'&ajax=true',type:'POST',success:loadWritePopupSuccessMethod});};loadWritePopupSuccessMethod=function(data){var cancelLink,form,container,closeLink;webshop.catalogue.BackOfPack.popup.container.find('div').remove();webshop.catalogue.BackOfPack.popup.container.removeClass('spinner');jQ('#reviewForm').remove();if(jQ(data).find('#reviewForm').length>0){webshop.catalogue.BackOfPack.popup.container.append(data).position('center');bindValidationToForm();bindRatingStars();cancelLink=jQ('#cancelWriteReviewPopup');cancelLink.on('click',function(event){webshop.catalogue.BackOfPack.popup.hide(event);});form=jQ('#reviewForm');form.validate({ignore:[]});form.on('submit',function(e){e.preventDefault();if(form.valid()){loadPreviewPopup(form);}});container=jQ('#reviewGuidelinesContainer');closeLink=jQ('<span class="closeBtn">Back to review</span>');closeLink.on('click',function(){container.fadeOut(200);return false;});jQ('div.dialogRatings p.reviewGuidelines a').on('click',function(){container.append(closeLink);container.fadeIn(200);return false;});}};jQ('.js-writeReview').each(function(){var link=jQ(this);link.on('click',function(e){e.preventDefault();loadWritePopup(link.attr('href'));});});jQ('.reviewThisButton').on('click',function(e){e.preventDefault();loadWritePopup(jQ('.reviewThisButton').parent()[0].action);});},_registerImageGallery:function(){if(jQ('#vertical_carousel').length){this.carousel=new UI.Carousel("vertical_carousel",{direction:"vertical",scrollInc:"1"});}
var galleryThumbs=jQ('#productGallery a.thumb');galleryThumbs.on('click',function(){jQ('#bigImg').attr('src',jQ(this).find('img').attr('src'));jQ('#enlargeImg, .enlargeImage a').attr('href',jQ(this).attr('href'));return false;});if(galleryThumbs.length&&galleryThumbs.length<4){jQ('#scrollUp').addClass('previous_button_disabled');jQ('#scrollDown').addClass('next_button_disabled');}},displayCorrection:function(jsonData){if(jsonData&&jsonData.correctionError){jQ(".correctionSubmitted").hide();jQ("#correctionError").hide().text(jsonData.correctionError).show();}else if(jsonData&&jsonData.correctionMsg){jQ("#correctionError").hide();jQ(".correctionSubmitted p").text(jsonData.correctionMsg);jQ(".correctionSubmitted").show();}},updateCorrectionBox:function(jsonData){if(jsonData&&jsonData.correctionError){jQ(".correctionSubmitted").hide();jQ("#correctionError").hide().text(jsonData.correctionError).show();}else if(jsonData&&jsonData.correctionMsg){jQ(".correctionSubmitted p").text(jsonData.correctionMsg);jQ(".correctionSubmitted").show();webshop.catalogue.BackOfPack.hideAndResetCorrectionBox();}},hideAndResetCorrectionBox:function(){jQ("#correctionError").hide();jQ(".bopCategoryDetails").hide();jQ("#correctionExpander").removeClass("expanded");jQ("#comments").val("");jQ("#correctionType option:first").attr('selected','selected');},favouritesListener:function(evt){var url=this.href;var sku=jQ('.addButtonSku').val();if(jQ('#bopRight').find('.productAdd').is(':disabled')){sku=jQ('#sku').val();}
jQ.ajax({url:url,data:{ajax:true},success:function(data){if(data.response!=null){webshop.catalogue.BackOfPack.updateFavouriteChoices(data.response.indexOf("added")!=-1,sku);webshop.common.Util.displayAddedMessage(data.response);}},error:function(){window.location=url;}});if(evt.data.eventType==='REMOVE_FROM_FAVOURITES'){webshop.catalogue.BackOfPack.favouritesEventTracker.triggerRemovedFromFavouritesBop(sku);}
if(evt.data.eventType==='ADD_TO_FAVOURITES'){webshop.catalogue.BackOfPack.favouritesEventTracker.triggerAddedtoFavouritesBop(sku);}
return false;},updateFavouriteChoices:function(added,sku){jQ('#addToFavouritesLink').toggle();jQ('#removeFromFavouritesLink').toggle();var ul=document.getElementById("favouriteChoicesList");if(ul!=null){var count=added?0:1;var visibleFavs=jQ("div.favouriteChoices > ul > li").filter(":visible");if(visibleFavs.length==count){jQ("div.favouriteChoices").toggle();}
var fav=document.getElementById("sc-"+sku);if(added){if(fav!=ul.children[0]){ul.insertBefore(fav,ul.children[0]);}
if(visibleFavs.length==3){visibleFavs.eq(2).toggleClass("hidden");}}else{var favs=jQ("ul#favouriteChoicesList > li").filter(".fav");if(favs.length>3){favs.not(visibleFavs).eq(0).toggleClass("hidden");}}}
jQ('#sc-'+sku).toggleClass("hidden").toggleClass("fav");},helpfulReviewAction:function(a){var p=a.parent();var url=a.attr("href");var words=url.split("#");var newUrl=words[0]+'&ajax=true#'+words[1];a.on('click',function(e){e.preventDefault();jQ.ajax({url:newUrl,success:function(data){var message=data.result.message;if(data.result.allVotes!=0){p.parent().parent().find("p[class='helpfulReviews']").replaceWith('<p class="helpfulReviews" name="helpfulVotes">'
+'<strong>'+data.result.helpfulVotes+'</strong> '
+getMessage('catalogue.backOfPack.helpfulReviewsSuffix',data.result.allVotes)+'</p>');}
p.find("strong").replaceWith('<strong>'+message+'</strong>');p.find("a[name='voteYes']").remove();p.find("a[name='voteNo']").remove();}});return false;});},_registerHelpfulReviewListener:function(){jQ("a[name='voteYes']").each(function(){webshop.catalogue.BackOfPack.helpfulReviewAction(jQ(this));});jQ("a[name='voteNo']").each(function(){webshop.catalogue.BackOfPack.helpfulReviewAction(jQ(this));});},_registerProductGroupListeners:function(){var isMultiDimension=jQ('input[name = "isMultiDimension"]').val();var selection=jQ('input[name = "selectedColour"]');if(selection.length==1){var selectedColour=selection.val();var selectedColourElement=jQ('.colourSwatch').find('a[data-descr = "'+selectedColour+'"]');var clazz=selectedColourElement.attr('class');if(clazz.length&&clazz.indexof("bordered")!=-1){selectedColourElement.addClass("selected bordered");}else{selectedColourElement.addClass("selected");}}
if(isMultiDimension!=null&&typeof(isMultiDimension)!='undefined'){var selectedColour=jQ('.colourSwatch .selected');if(!selectedColour.length){jQ('.sizeDropdown').attr('disabled','disabled');}}
webshop.catalogue.ColourSwatch.register(jQ('.colourSwatch'),jQ('#galleryImages li'),jQ('.productPrice'));}}
webshop.catalogue=webshop.catalogue||{};webshop.catalogue.CataloguePage={windowWidth:0,init:function(){var _this=this;this.registerPageListeners();var prepareComponent=function(){jQ('.productImageContainer').children('a').uncommentChildren().find('.productImageShow').on('load',function(){jQ(this).parents('.productImageContainer').find('.placeholder').remove();jQ(this).show();});};if(document.readyState==='complete'){prepareComponent();}else{jQ(window).on('load',prepareComponent);}
if(jQ('.enhancedCategories')){_this.alignCategories();jQ(window).on('resize',function(){if(typeof sizewait!='undefined'){clearTimeout(sizewait);}
sizewait=setTimeout(function(){_this.alignCategories();},200);});}
this.scrollFix();if(webshop.common.jsVariables.get('oosStatisticsPerCluster')){new Backbone.Webshop.oos.GTMOosEventSender().sendOosGAEvents();}},alignCategories:function(){var container=jQ('#content'),categoryContainer=container.find('.enhancedCategories-container'),itemWidth=categoryContainer.find('li').outerWidth()+parseInt(categoryContainer.find('li').css('margin-right'),10),remainder=container.outerWidth()%itemWidth;if(parseInt(jQ(categoryContainer).height(),10)>300){categoryContainer.css({'width':container.outerWidth()-remainder});categoryContainer.find('ul').css({'text-align':'left'});}else{categoryContainer.css({'width':'auto'});categoryContainer.find('ul').css({'text-align':'center'});}},toggleCategories:function(context){var toggler=jQ(context);toggler.toggleClass('open');jQ('.extendedCluster').toggleClass('isHidden');if(toggler.hasClass('open')){toggler.text(getMessage('catalogue.page.seeLess'));}else{toggler.text(getMessage('catalogue.page.seeMore'));}},registerPageListeners:function(){this._registerPaginators();this._registerSortFilterListener();this._registerMoreFilters();this._registerComboDealLinks();jQ(document.body).on('webshop:comboDealLinks:register',this._registerComboDealLinks);jQ('.paginationMessage input').on('change',function(){var form=jQ(this.form);jQ.post(form.attr('action'),form.serialize()+'&ajax=ajax',function(){window.location.reload();});});jQ('.showOOS').on('click',function(event){event.preventDefault();jQ.post(jQ(this).attr('href'),function(){window.location.reload();});});jQ('.switchView').on('click','button',function(e){var currentButton=jQ(this);if(!currentButton.parent().hasClass('shelfView')&&!jQ('#prodList').hasClass('shelfView')){e.preventDefault();webshop.catalogue.CataloguePage._registerViewChangeListener(currentButton);}
else if(currentButton.hasClass('active')){e.preventDefault();}});var deleteList=jQ("a#deleteList");if(webshop.catalogue.ShoppingListConfirmCancelDelete){webshop.catalogue.ShoppingListConfirmCancelDelete.registerPopup(deleteList);}
jQ('input.doNotShowHelpAgain').on('click',function(event){url=jQ('#favIntroForm').attr('action');if(jQ('#favIntroChk').is(':checked')){jQ.get(url+"?hide=true");}else{jQ.get(url+"?hide=false");}});var editForm=jQ('#listEditForm');if(editForm&&editForm[0]){editForm[0].reset();}else if(jQ('#sortBy').length){jQ('#sortBy')[0].parentNode.parentNode.reset();}
var legend=jQ('.legend'),node=legend.find('h6'),legendMap=legend.find('.legendMap');jQ('#content').on('click','.legend',function(){if(legend.hasClass('legendExpand')){legend.removeClass('legendExpand');node.text('Key to icons');legendMap.hide();}else{legend.addClass('legendExpand');node.text('Hide');legendMap.show();}});jQ('.catalogueFilters .filterHeader').on('click',function(){jQ(this).parent().toggleClass('closed');});jQ('.catFilter .filterOptionsMore').on('click',function(){jQ(this).hide();jQ(this).parent().find('li.hidden').removeClass('hidden');return false;});jQ('.clusterNav').on('click','.js-expand',function(e){e.preventDefault();webshop.catalogue.CataloguePage.toggleCategories(this);});this.updateClusterHeaders();this._registerClusterTips();jQ('ul.productList').on("webshop:clusters:update",this.updateClusterHeadersHandler);jQ(window).on("resize",this.updateClusterHeadersHandler);if(jQ('#scroller').length>0){jQ('#sis_wrapper').show();jQ('#scroller').simplyScroll();}},_registerViewChangeListener:function(currentOption){var switchView=jQ('.switchView'),switchViewButtons=switchView.find('button'),container=currentOption.parent(),viewClass=container.prop('class'),scrollTo=jQ('div.filters div.sorting'),form=currentOption.closest('form'),url;switchViewButtons.removeClass('active');switchView.find("."+viewClass+" button").addClass('active');if(scrollTo.length){var top=scrollTo.offset().top,headerHeight=jQ('#fix').css('position')==="fixed"?jQ('#fix').outerHeight():0;jQ('html,body').animate({scrollTop:top-headerHeight},200);}else{jQ('html,body').animate({scrollTop:0},200);}
jQ('.showLoading').addClass('loading');jQ('.showLoading').empty();if(!currentOption.hasClass('editing')){url=form.attr('action');if(jQ('#listWrapper').length){var selectedTab="&tab="+jQ('ul.bopTabs li.currentTab').find('a').attr('id'),selectedSorting="&sortBy="+jQ('#stOrganizeBy').val();url=url.replace("&tab=","&originalTab=");url+=selectedTab+selectedSorting;}
url+="&ajax=true";jQ.ajax({'url':url,'success':(function(viewClass){return function(data){webshop.catalogue.CataloguePage.switchView(data,viewClass);};}(viewClass))});}},_registerSortFilterListener:function(){var refresh=function(){this.form.submit();};jQ('.sortBy select').on('change',refresh);jQ('.sortBy input').on('change',refresh);},_registerPaginators:function(){if(jQ('#itemsPerPage').val()==='See all'){jQ('ul.productList').infiniteScroll(jQ('ul.pages'),{success:function(){jQ(document.body).trigger('webshop:sc:bind');var $productList=jQ('ul.productList');$productList.find('p.tipped').popout();$productList.trigger('webshop:moreInfo:register');jQ(document.body).trigger('webshop:spSlider:register');webshop.catalogue.CataloguePage.updateClusterHeaders();jQ(document.body).trigger('webshop:comboDealLinks:register');jQ(document.body).trigger('webshop:gtm:newProductsLoaded');}});}else{jQ('form.sortBy select[name="itemsPerPage"]').append('<option>'+getMessage('catalogue.page.seeAllOption')+'</option>');}},_registerMoreFilters:function(){jQ('.moreFilters').on('click',function(){var $moreLink=jQ(this);var $parent=jQ(this.parentNode);$parent.prevAll('li.hideable').toggleClass('isHidden');$parent.prev().addClass('last');$moreLink.toggleClass('opened');if($moreLink.hasClass('opened')){$moreLink.text(getMessage('catalogue.page.seeLess'));}else{$moreLink.text(getMessage('catalogue.page.seeMore'));}
return false;});},_registerComboDealLinks:function(){var urls=jQ('a.comboDealURL');if(urls.length){for(var i=0,len=urls.length;i<len;i++){var url=urls[i],updatedUrl=webshop.ajax.Util.addNewParameters(url.getAttribute('href'),["jsType"],["js"]);urls[i].setAttribute('href',updatedUrl);}}},switchView:function(data,viewClass){var $prodList=jQ('ul.productList');var $listWrapper=jQ('#listWrapper');$prodList.removeClass('listView shelfView textView').addClass(viewClass);if($prodList.hasClass("shelfViewSmlImg")||$prodList.hasClass("listViewSmlImg")||$prodList.hasClass("textViewSmlImg")){$prodList.removeClass("shelfViewSmlImg").removeClass("listViewSmlImg").removeClass("textViewSmlImg").addClass(viewClass+"SmlImg");}
if($prodList.hasClass("shelfViewShort")||$prodList.hasClass("textViewShort")){$prodList.removeClass("shelfViewShort").removeClass("textViewShort").addClass(viewClass+"Short");}
if($prodList.hasClass("shelfViewShortSmlImg")||$prodList.hasClass("textViewShortSmlImg")){$prodList.removeClass("shelfViewShortSmlImg").removeClass("textViewShortSmlImg").addClass(viewClass+"ShortSmlImg");}
if($prodList.hasClass('textView')){jQ('div.descriptionType button').addClass('disabled').attr('disabled','disabled');jQ('div.pictureSize button').addClass('disabled').attr('disabled','disabled');}else{jQ('div.descriptionType button').removeClass('disabled').removeAttr('disabled');jQ('div.pictureSize button').removeClass('disabled').removeAttr('disabled');}
if($listWrapper.length){$listWrapper.children().not('.bopTabs').remove();$listWrapper.append(data);}else{$prodList.html(data);}
jQ(document.body).trigger('webshop:sc:bind');$prodList.find('.tipped').popout();$prodList.trigger('webshop:moreInfo:register');jQ(document.body).trigger('webshop:spSlider:register');this.updateClusterHeaders();jQ(document.body).trigger('webshop:comboDealLinks:register');jQ('body').trigger('disposePopout');},updateViewOptionUrl:function(index){if(index||index===0){jQ('.switchView form').each(function(){var url=jQ(this).attr('action');if(!url.match(/index=[0-9]+/)){jQ(this).attr('action',url+'&index='+index);}else{jQ(this).attr('action',url.replace(/index=[0-9]+/,'index='
+index));}});jQ(document.body).trigger('webshop:sc:bind');jQ('ul.productList').find('.tipped').popout();}},getUrlParams:function(){if(webshop.catalogue.ShoppingList){return webshop.catalogue.ShoppingList.EditMode.getEditFormParams();}
return'';},fixIe7zindex:function(){jQ(function(){var zIndexNumber=1000;jQ('.yourClubsFops li').each(function(){jQ(this).css('zIndex',zIndexNumber);zIndexNumber-=10;});});},scrollFix:function(){var windowElement=jQ(window);var onLoadScrollFix=function(){if(!jQ('body').hasClass('notFixed')){var currentURL=window.location.href,splitCurrentURL=currentURL.split('&');for(var i=0;i<=(splitCurrentURL.length-1);i++){if(splitCurrentURL[i].indexOf('lastSku')>-1){var selectedProduct=splitCurrentURL[i].replace('lastSku','productDetails').replace('=','-'),selectedProductOffset=jQ('#'+selectedProduct).offset();if(selectedProductOffset){windowElement.scrollTop((parseInt(Math.ceil(selectedProductOffset.top))-171));}}}}};if(document.readyState==='complete'){onLoadScrollFix();}else{windowElement.on('load',onLoadScrollFix);}},_registerClusterTips:function(){var clusterHeaders=jQ('.clusterHeader[enableTooltip="true"]');if(clusterHeaders.length>0){clusterHeaders.toolTip({'className':'clusterTip','tipText':function(args){var original=this.find('a');if(original==null||original.length==0){original=this.find('span');}
var tip=original.clone(true);tip.text(tip.attr('title'));return tip;}});}},_getTopOffset:function(element){var res=0;var root=document.getElementById('prodList');while(element!=root&&element!=null){res+=element.offsetTop;element=element.offsetParent;}
return res;},_getLeftOffset:function(element){var res=0;var root=document.getElementById('prodList');while(element!=root&&element!=null){res+=element.offsetLeft;element=element.offsetParent;}
return res;},_getLineItemCount:function(){var lis=jQ('.clusterShelf');var curentTopOffset=this._getTopOffset(lis[0]);var i=0;while(i<lis.length&&this._getTopOffset(lis[i])==curentTopOffset){i++;}
return i;},_updateClusterHeadersWidth:function(){var headers=jQ('.clusterShelfHeader');if(headers==null||headers.length==0){return;}
for(var i=0;i<headers.length;i++){var current=headers[i];var next=null;if(i+1<headers.length){next=headers[i+1];}
var offsetCorrection=40;if(next!=null&&this._getTopOffset(current)==this._getTopOffset(next)){var currentLeftOffset=this._getLeftOffset(current);var nextLeftOffset=this._getLeftOffset(next);current.style.maxWidth=(nextLeftOffset-currentLeftOffset)-offsetCorrection+'px';}else{var li=jQ(current).parent();var nextLi=li.next();while(nextLi!=null&&nextLi.length>0&&!(nextLi.hasClass('clusterShelf')||nextLi.hasClass('clusterTopFavouritesShelf'))){nextLi=nextLi.next();}
while(nextLi!=null&&nextLi.length>0&&this._getTopOffset(li[0])==this._getTopOffset(nextLi[0])){li=nextLi;nextLi=li.next();while(nextLi!=null&&nextLi.length>0&&!(nextLi.hasClass('clusterShelf')||nextLi.hasClass('clusterTopFavouritesShelf'))){nextLi=nextLi.next();}}
var lastElementRightOffset=this._getLeftOffset(li[0])+li[0].offsetWidth;var currentElementLeftOffset=this._getLeftOffset(current.offsetParent);current.style.maxWidth=(lastElementRightOffset-currentElementLeftOffset)-offsetCorrection+'px';}}},updateClusterHeaders:function(){if(jQ('.clusterHighlight').length==0){return;}
webshop.catalogue.CataloguePage._updateClusterHeadersWidth();var headers=jQ('.clusterHeader');headers.each(function(){var header=jQ(this);var textContainer=header.find('a');var linkFound=textContainer!=null&&textContainer.length>0;if(!linkFound){textContainer=header.find('span');}
var title=textContainer.attr('title');textContainer.text(title);var enableTooltip=webshop.common.Abbreviate.abbreviateTextInContainer(title,textContainer,this,20,true);header.attr('enableTooltip',enableTooltip);});},updateClusterHeadersHandler:function(){jQ(window).off("resize",webshop.catalogue.CataloguePage.updateClusterHeadersHandler);window.setTimeout(function(){webshop.catalogue.CataloguePage.updateClusterHeaders();jQ(window).on("resize",webshop.catalogue.CataloguePage.updateClusterHeadersHandler);},100);}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.ColourSwatch={init:function(){},register:function(colourSwatch,galleryImage,priceCntr){var theImage=galleryImage.filter(':visible').find('img'),originalImgSrc=theImage.attr('src');originalPrice=priceCntr.find('.show'),swatchLinks=colourSwatch.find('a'),isPad=webshop.common.Util.isIPad(),identifier='';if(originalImgSrc){identifier=originalImgSrc.split('?').length>1?originalImgSrc.split('?')[1]:'identifier='+new Date().setHours(0,0,0,0);}
isMD=jQ('input[name = "isMultiDimension"]').val();if(isPad){return;}
this.registerSwatchTitles(swatchLinks);jQ(document.body).on('gallery.change',function(e){theImage=galleryImage.filter('.active').find('img');originalImgSrc=theImage.attr('src');});jQ(document.body).trigger('gallery.change');if(!isPad){swatchLinks.on('mouseenter',function(e){var sku=jQ(this).data('sku');var imgSrc=jQ(this).data('img-src');theImage.attr('src',imgSrc);if(isMD!=='true'){priceCntr.find('.sgPrice').hide();priceCntr.find('.derivPrice').hide();priceCntr.find('.price-'+sku).show();}});colourSwatch.on('mouseleave',function(e){theImage.attr('src',originalImgSrc);if(isMD!=='true'){priceCntr.find('.sgPrice').hide();priceCntr.find('.derivPrice').hide();originalPrice.show();}});}},registerSwatchTitles:function(links){links.each(function(){var link=jQ(this);if(link.find('.swatchTitle').length===0){link.append('<span class="swatchTitle">'+link.attr('title')+'</span>');}
link.removeAttr('title');});links.toolTip({className:'swatchTitle',fadeSpeed:0,delay:0,leftOffset:17,topOffset:-17,toolTipId:'swatchTitle',tipText:function(){var context=jQ(this);return context.find('.swatchTitle').text();}});}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.ComboDeal={init:function(){this.observeBasketEvents();},observeBasketEvents:function(){document.observe('webshop:basket:update',function(evt){var jsonData=evt.memo.data;if(jsonData){var comboDealJsonData=jsonData.comboDealObject;if(comboDealJsonData){var comboDealPanels=jQ('div.combo_'+comboDealJsonData.comboPromoID);if(comboDealPanels.length){var dealCompletionInfos=jQ('div.dealHelper p');if(dealCompletionInfos.length){dealCompletionInfos.html(comboDealJsonData.dealCompletionInfo);}
var groupQuantities=jQ('span.group_'+comboDealJsonData.groupID);if(groupQuantities.length){groupQuantities.html(comboDealJsonData.groupQuantity);}
var dealSavings=jQ('p.dealSavings');if(dealSavings.length){dealSavings.html(comboDealJsonData.dealSavings);}
var numberOfTriggers=jQ('strong.numberOfTriggers');if(numberOfTriggers.length){numberOfTriggers.html(comboDealJsonData.numberOfTriggers);}}}}}.bind(this));}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.Gallery=(function($,undefined){return{init:function(){var playvideo=$('li.video.play a');this.bind();if(playvideo.length>0){$('#bopPopup.playVideo, #dialogOverlay').remove();playvideo.trigger('click');}},bind:function(){var gallery=$('#galleryImages'),images=gallery.find('li'),imageThumbs=$('#gallery ul.galleryThumbs > li.image a'),videoThumbs=$('#gallery ul.galleryThumbs > li.video a'),bigImage=$('#zoomedImage img'),viewport=$('#zoomedImage'),zoomable=images.filter('.zoomable'),showInPopup=$('#gallery').hasClass('showInPopup'),enableZoom=$('#gallery').hasClass('enableZoom'),isPad=webshop.common.Util.isIPad(),zoomer;imageThumbs.on('click',function(e){var target=$(this),newUrl=target.attr('href'),chosenImage=imageThumbs.index(target);e.preventDefault();if(images.index(images.filter(':visible'))===chosenImage){return;}
imageThumbs.removeClass('active');target.addClass('active');images.fadeOut(350);images.removeClass('active').eq(chosenImage).fadeIn(350).addClass('active');bigImage.attr('src',newUrl);$(document.body).trigger('gallery.change');});if(showInPopup){videoThumbs.on('click',function(e){var index=videoThumbs.index(this);e.preventDefault();webshop.catalogue.Gallery.PopupGallery.showVideo(index);});$('#galleryImages li.zoomable').on('click',function(e){var index=images.index(this);e.preventDefault();webshop.catalogue.Gallery.PopupGallery.showImage(index);});}
if(enableZoom&&!isPad){zoomer=this._zoomer(images.find('img').first(),bigImage,viewport.find('.zoomInner'));zoomable.append('<span class="magnifier" />');zoomable.append(zoomer);zoomable.on('mousemove',function(e){var zoomer=$(this).find('.zoomer').addClass('viewer'),magnifier=$(this).find('.magnifier'),pos={x:e.pageX-$(this).offset().left,y:e.pageY-$(this).offset().top},min={x:zoomer.outerWidth()/2,y:zoomer.outerHeight()/2},max={x:gallery.innerWidth()-min.x,y:gallery.innerHeight()-min.y},scale={h:bigImage.outerWidth()/gallery.innerWidth(),v:bigImage.outerHeight()/gallery.innerHeight()};pos=webshop.catalogue.Gallery._bounded(pos,min,max);magnifier.hide();zoomer.css({top:pos.y,left:pos.x}).fadeIn(100);viewport.fadeIn(100);bigImage.css({top:-(pos.y-zoomer.innerHeight()/2)*scale.v,left:-(pos.x-zoomer.innerWidth()/2)*scale.h});}).on('mouseleave',function(e){var zoomer=$(this).find('.zoomer'),magnifier=$(this).find('.magnifier');if(e.relatedTarget==zoomer[0]){return false;}
viewport.fadeOut(100);zoomer.fadeOut(100,function(){zoomer.removeClass('viewer');magnifier.show();});});}},_zoomer:function(image,bigImage,viewport){var scale={h:bigImage.innerWidth()/viewport.innerWidth(),v:bigImage.innerHeight()/viewport.innerHeight()},dimensions={width:Math.floor(image.innerWidth()/scale.h),height:Math.floor(image.innerHeight()/scale.v)};return $('<span class="zoomer"/>').css({width:dimensions.width,height:dimensions.height,marginLeft:-Math.ceil(dimensions.width/2),marginTop:-Math.ceil(dimensions.height/2)});},_bounded:function(point,min,max){return{x:this._between(point.x,min.x,max.x),y:this._between(point.y,min.y,max.y)};},_between:function(val,min,max){return Math.min(Math.max(val,min),max);},PopupGallery:{showImage:function(index){this._createPopupGallery();this.thumbnails.find('.image a').eq(index).trigger('click');},showVideo:function(index){this._createPopupGallery();this.thumbnails.find('.video a').eq(index).trigger('click');},_createPopupGallery:function(){var popup=webshop.popup.create({onClose:function(e){$(document).off('keydown.gallery');}});this.container=popup.container;this.videos=$('#galleryVideos').clone().uncommentChildren().find('iframe');this.thumbnails=$('#gallery .galleryThumbs').clone();this.prev=$('<a class="prev">previous</a>');this.next=$('<a class="next">next</a>');this.title=$('<span class="title"><strong class="mediaType"></strong></span>').append($('#content h1.productTitle').contents().clone());this.thumbnails.find('img').attr('width',90).attr('height',90);this.thumbnails.find('a').removeClass('active');if(this.thumbnails.children().length<2){this.thumbnails.hide();}else{this.container.append(this.prev);this.container.append(this.next);}
this.container.addClass('bopGallery');this.container.append(this.title);this.container.append(this.thumbnails);this._bindThumbnails();this._bindNextPrev();},_bindThumbnails:function(){var gallery=this,links=this.thumbnails.find('a');links.on('click',function(e){var isImage=$(this).parents('li').is('.image'),media,index;e.preventDefault();if($(this).is('.active')){return;}
if(isImage){media=$('<img width="640" height="640"/>').attr('src',$(this).attr('href'));}else{index=links.filter('.video a').index(this);media=$(gallery.videos[index]).clone();jQ.get('/webshop/createPageEvent.do',{ajax:true,pageEventType:'SHOW_VIDEO',pageViewId:webshop.common.jsTopBodyVariables.pageViewId,VIDEO_ID:$(this).data('videoid')});}
gallery.title.find('.mediaType').text(isImage?getMessage('catalogue.gallery.photoTitle')+':':getMessage('catalogue.gallery.videoTitle')+':');gallery.container.children('iframe, img').remove();$(media).hide().insertAfter(gallery.title).fadeIn();if(isImage&&gallery.container.outerHeight()>jQ(window).height()){var newHeight=jQ(window).height()-(gallery.thumbnails.outerHeight()+gallery.title.outerHeight()+80);media.attr('height',newHeight).attr('width',newHeight);}
links.removeClass('active');$(this).addClass('active');$(gallery.next).add(gallery.prev).removeClass('disabled');if($(this).is(links.first())){gallery.prev.addClass('disabled');}
if($(this).is(links.last())){gallery.next.addClass('disabled');}
gallery.container.position('center');});},_bindNextPrev:function(){var gallery=this;$(this.next).add(this.prev).on('click',function(e){var links=gallery.thumbnails.find('a'),active=links.filter('.active'),index=links.index(active);if($(this).is('.disabled')){return;}
if($(this).is('.next')){index++;}else{index--;}
links.eq(index).trigger('click');});$(document).on('keydown.gallery',function(e){if(e.keyCode===37){e.preventDefault();gallery.prev.trigger('click');}
if(e.keyCode===39){e.preventDefault();gallery.next.trigger('click');}});}}};})(jQuery);webshop.catalogue=webshop.catalogue||{};webshop.catalogue.InTrolleyIndicator={init:function(){_.extend(this,webshop.gtm.mixins.trolleyButtons);this.observeForms();this.observeBasketEvents();},observeForms:function(){var eventSender=new ocBackbone.gtm.TrolleyEventSender();jQ(document.body).on('click','.inTrolleyIndicator input.decrement',(function(clazz){return function(e){if(webshop.common.jsVariables.get('gaTrackBasketUpdateOnSuccess')){var domElement=this;webshop.catalogue.Util.sendUpdateBasketRequest.call(domElement,e,clazz,function(){clazz.gtmSendProductRemovedFromTrolleyEvent(domElement,eventSender);});}else{if(webshop.catalogue.Util.sendUpdateBasketRequest.call(this,e,clazz)){clazz.gtmSendProductRemovedFromTrolleyEvent(this,eventSender);}}};})(this));jQ(document.body).on('click','.inTrolleyIndicator input.increment',(function(clazz){return function(e){if(webshop.common.jsVariables.get('gaTrackBasketUpdateOnSuccess')){var domElement=this;webshop.catalogue.Util.sendUpdateBasketRequest.call(domElement,e,clazz,function(){clazz.gtmSendProductAddedToTrolleyEvent(domElement,eventSender);});}else{if(webshop.catalogue.Util.sendUpdateBasketRequest.call(this,e,clazz)){clazz.gtmSendProductAddedToTrolleyEvent(this,eventSender);}}};})(this));},observeBasketEvents:function(){document.observe('webshop:basket:update',function(evt){var jsonData=evt.memo.data;if(jsonData&&jsonData.lastItemUpdated){var forms=jQ('form.inTrolleyIndicator-'+jsonData.lastItemUpdated.sku);if(forms&&forms.length>0){for(var i=0,len=forms.length;i<len;i++){this.update(jQ(forms[i]),jsonData.lastItemUpdated);}}}}.bind(this));},update:function(form,jsonData){webshop.catalogue.Util.removeLatestInTrolleyClassFromOtherIndicators(jsonData.sku,jsonData.itemQuantity);var indicatorIsAlreadyPresent=form.find('input.decrement').length>0;if(jsonData.itemQuantity==='0'){form.find('input.decrement, span.productCount, input.increment').remove();this._styleNotInTrolley(form);form.hide();}else if(indicatorIsAlreadyPresent){var buttonSpan=form.find('span.productCount').first();var showDescription=form.find('.showDescription')[0].getAttribute("value")!=="false";buttonSpan.html(this._getItemDescription(jsonData,showDescription,form));}else{var indicator=this.render(form,jsonData),controlWrap=jQ('<span class="controls"></span>').append(indicator[1]).append(indicator[2]);form.append(indicator[0],controlWrap).css('display','block');}
if(jsonData.itemQuantity!=='0'){if(jsonData.scSellingGrp){this.styleInTrolley(form,jsonData.sku,true,jsonData.scSellingGrp);}else{this.styleInTrolley(form,jsonData.sku,true);}}},render:function(form,jsonData){webshop.catalogue.Util.removeLatestInTrolleyClassFromOtherIndicators(jsonData.sku,jsonData.itemQuantity);var decrement=new Element('input',{'class':'decrement','type':'submit','value':-1,'name':'quantity','title':getMessage('catalogue.inTrolleyIndicator.removeFromTrolleyInputTitle',jsonData.description)});var increment=new Element('input',{'class':'increment','type':'submit','value':1,'name':'quantity','title':getMessage('catalogue.inTrolleyIndicator.addToTrolleyInputTitle',jsonData.description)});var showDescription=form.find('.showDescription')[0].getAttribute("value")!=="false";var productCount=new Element('span',{'class':'productCount'}).update(this._getItemDescription(jsonData,showDescription,form));return[productCount,decrement,increment];},styleInTrolley:function(form,sku,latest,sellingGroupSku){if(latest){if(sellingGroupSku){jQ('#productDetails-'+sellingGroupSku).children('div.listProductWrap').addClass('inTrolleyBorder');}else{jQ(form).parent().parent('div.alternative').addClass('inTrolleyAltBorder');jQ(form).parent().parent('div.listProductWrap').addClass('inTrolleyBorder');}}
form.addClass('inTrolley');jQ(form).attr('id','inTrolley-'+sku);},_styleNotInTrolley:function(form){form.removeClass('inTrolley');},_getItemDescription:function(jsonData,showDescription,form){var description=jsonData.itemQuantity;description+=showDescription?" x "+jQ(form).find('input[name=desc]').val():"";return description+" "+getMessage('catalogue.inTrolleyIndicator.descSuffixInTrolley');}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.MoreInfo={init:function(){this._registerCustomEventListener();this._registerShowMoreInfoHover();this._registerHideMoreInfo();},_registerCustomEventListener:function(){jQ(document.body).on('webshop:moreInfo:register',this._registerShowMoreInfoHover);},_registerShowMoreInfoHover:function(event,container){var mi=webshop.catalogue.MoreInfo;var moreInfos=container?container.find('div.moreInfo'):jQ('div.moreInfo');moreInfos.off().hover(function(){jQ.data(this,'hover',true);},function(){jQ.data(this,'hover',false);});var $infoIcons=container?container.find('img.infoIcon'):jQ('img.infoIcon');$infoIcons.css({left:'5px'});$infoIcons.off().hoverIntent({interval:150,timeout:300,over:mi._showMoreInfo,out:mi._hideMoreInfo});},_registerHideMoreInfo:function(){jQ(document.body).on('mouseleave','.moreInfo',function(){jQ(this).hide();});},_showMoreInfo:function(){jQ('div.moreInfo').hide();fopBox=jQ(this).parents('li.productDetails');jQ('.moreInfo',fopBox).show();},_hideMoreInfo:function(){var moreInfo=jQ(this).closest('li').find('div.moreInfo');if(!moreInfo.data('hover')){moreInfo.hide();}}};webshop.search=webshop.search||{};webshop.catalogue.MultiCarousel={init:function(){var multiCarousel=jQ('.multiSearchCarousel');this.multiSearchCarousels(multiCarousel);this.addMultiSearchScrolledAnalytics(multiCarousel);},multiSearchCarousels:function(object){object.flexiCarousel({autoFit:true,customPrevButton:'.leftArrow',customNextButton:'.rightArrow',vertical:false,effect:'slide',wrapperClass:'.multiSearch',multiSearch:true,disabledClassPrev:'disabledArrowPrev',disabledClassNext:'disabledArrowNext'});},addMultiSearchScrolledAnalytics:function(object){object.on('scroll','.leftArrow, .rightArrow',function(e){var current=jQ(this),clusterName=jQ(current.parent().prev('.fopGroupHeader.multiSearchHeader').children('h2')[0]).text(),direction="";if(current.hasClass('rightArrow')){direction="right";}else if(current.hasClass('leftArrow')){direction="left";}
jQ.get('/webshop/createPageEvent.do',{ajax:true,pageEventType:'MULTI_SEARCH_CAROUSEL_SCROLLED',pageViewId:webshop.analytics.pageViewId,CLUSTER_NAME:clusterName,direction:direction});});}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.PGMultiDimensionSelection={currSizeSelIndex:-1,parentTitle:"",bopPageSku:"",isMultiDimensional:"true",init:function(){isMultiDimensional=jQ('input[name = "isMultiDimension"]').val();this.observeDimensionSelection();var selectionSku=jQ('input[name="selection_sku"]');if(selectionSku.length>0){bopPageSku=selectionSku.val();}else{bopPageSku=jQ('input[name="parent_sku"]').val();}
parentTitle=jQ('input[name="parent_title"]').val();},observeDimensionSelection:function(){if(isMultiDimensional=="true"){this.observeColourSelection();this.observeSizeSelection();}},observeColourSelection:function(){jQ('.colourSwatch').on('click','a',function(event){event.preventDefault();var colourKeyIndex=jQ(this).attr('keyIndex');var colourOnOfferMessage=jQ('input[name = "colour_'+colourKeyIndex+'"]').val();var popUp=jQ('#bopPopup');if(popUp.length){var isOnOffer=jQ('#bopPopup p.onOffer');if(colourOnOfferMessage.trim().length>0){if(isOnOffer.length){isOnOffer.html(colourOnOfferMessage).show();}}else if(isOnOffer.length){isOnOffer.hide();}}else{var isOnOffer=jQ('div.productDescription p.onOffer');if(colourOnOfferMessage.trim().length>0){if(isOnOffer.length){isOnOffer.html(colourOnOfferMessage).show();}}else if(isOnOffer.length){isOnOffer.hide();}}
var parentSku=jQ('input[name="parent_sku"]').val();webshop.catalogue.PGMultiDimensionSelection.disableAddButtonAndLinks();jQ('.derivPrice').hide();jQ('.sgPrice').show();webshop.catalogue.PGMultiDimensionSelection.resetTitleToParent();var selectedColourLink=jQ(this);var colourKey=parseInt(selectedColourLink.attr('keyIndex'));jQ('.selected').removeClass('selected');selectedColourLink.addClass('selected');jQ('.selectedColour').text(selectedColourLink.attr('data-descr'));var sizeDropDown=jQ('.sizeDropdown');jQ('input[name="product_colour"]').val(colourKey);var firstAvailSizeKey=-1;var firstAvailSizeIndexInSelect=0;var count=0;if(colourSizeMatrix!=null){var sizeArray=colourSizeMatrix[colourKey];if(sizeDropDown.length>0){var optionsHTML="<option value='-1'>"+getMessage('catalogue.multiDimensionSelection.pleaseSelectOption')+"</option>";for(var i=0;i<sizeArray.length;i++){var matrixValue=sizeArray[i];if(matrixValue!==null&&typeof(matrixValue)!=='undefined'){var formattedValue=matrixValue.split('-')[0];if(matrixValue.indexOf("oos")!=-1){optionsHTML=optionsHTML+"<option value='"+i+"' style='color:#CCC' disabled='disabled'>"+formattedValue+" "+getMessage('catalogue.multiDimensionSelection.outOfStockOption')+"</option>";count++;}else{optionsHTML=optionsHTML+"<option value='"+i+"'>"+formattedValue+"</option>";if(firstAvailSizeKey==-1){firstAvailSizeKey=i;firstAvailSizeIndexInSelect=count+1;}}}}
sizeDropDown.html(optionsHTML).removeAttr("disabled").css("color","#000");jQ('.optionsMsg').html(getMessage('catalogue.multiDimensionSelection.selectSizeOptionMsg'));}
jQ.ajax({url:'/webshop/getGalleryAjax.do',data:'parent_sku='+parentSku+'&product_colour='+colourKey+'&size='+firstAvailSizeKey+'&ajax=ajax',success:function(data){webshop.catalogue.PGMultiDimensionSelection.updateGallery(data);}});}
var selectedSize=sizeDropDown.find('option:selected');if(selectedSize.val()!=='-1'){currSizeSelIndex=sizeDropDown.find('option').index(selectedSize);}else{currSizeSelIndex=firstAvailSizeIndexInSelect;}});},observeSizeSelection:function(){var sizeSelect=jQ('.sizeDropdown');sizeSelect.on('change',function(){var selectedOption=sizeSelect.find('option:selected');if(selectedOption.val()==-1){jQ('.optionsMsg').html(getMessage('catalogue.multiDimensionSelection.selectSizeOptionMsg'));webshop.catalogue.PGMultiDimensionSelection.disableAddButtonAndLinks();webshop.catalogue.PGMultiDimensionSelection.resetTitleToParent();}else{jQ('.optionsMsg').html("");var form=sizeSelect.parents('form'),actionUrl=form.attr('action'),params=form.serialize();jQ.ajax({type:'POST',url:actionUrl,data:params+'&ajax=ajax',success:function(data){webshop.catalogue.PGMultiDimensionSelection.updatePGDetails(data);}});var colourKey=jQ('input[name="product_colour"]').val();var parentSku=jQ('input[name="parent_sku"]').val();var sizeSelIndex=sizeSelect.find('option').index(selectedOption);if(sizeSelIndex!=currSizeSelIndex){jQ.ajax({url:'/webshop/getGalleryAjax.do',data:'parent_sku='+parentSku+'&product_colour='+colourKey+'&size='+selectedOption.val()+'&ajax=ajax',success:function(data){webshop.catalogue.PGMultiDimensionSelection.updateGallery(data);}});currSizeSelIndex=sizeSelIndex;}}});},updateGallery:function(data){var bopLeft=jQ('#bopLeft');var qvGallery=jQ('#gallery');var galleryContainer=null;if(bopLeft.length>0){galleryContainer=bopLeft;}else if(qvGallery.length>0){galleryContainer=qvGallery;}
galleryContainer.stop(true,true).fadeOut(function(){galleryContainer.html(data);galleryContainer.fadeIn(function(){webshop.catalogue.Gallery.init();var popup=jQ('#bopPopup');if(!popup.length){webshop.catalogue.ColourSwatch.register(jQ('.colourSwatch'),jQ('#galleryImages li'),jQ('.productPrice'));}else
{webshop.catalogue.ColourSwatch.register(jQ('.colourSwatch'),jQ('#galleryImages li'),jQ('.productPriceInfo'));}});});},updatePGDetails:function(data){var bopData=jQ(data);var title=bopData.find('.titleContainer').find('.productTitle').html();var parentSku=bopData.find('.parentSku').text().trim();var isAvailable=bopData.find('.isAvailable').text().trim()==='true';var sku=bopData.find('.sku').text().trim();var desc=bopData.find('.shortDescription').text().trim();var hasSubstitutions=bopData.find('.hasSubstitutions').text().trim()==='true';var isFavourite=bopData.find('.isFavourite').text().trim()==='true';var productDescription=bopData.find('.descriptionContainer').html();var otherInformation=bopData.find('.otherInformationContainer').html();var ymlWrapper=bopData.find('.ymlContainer').html();var nutrition=bopData.find('.nutritionDataContainer').children();var offerMessage=bopData.find('.offerMsg').html();var addButtonForm=jQ('form.addButton.productDetails-'+bopPageSku);jQ('#h2-'+bopPageSku).html(title);if(isAvailable&&addButtonForm.length){addButtonForm.find('input[name="sku"]').val(sku);addButtonForm.find('input[name="desc"]').val(desc);webshop.catalogue.PGMultiDimensionSelection.enableAddButton();var oos=jQ('.oos');if(oos.length){oos.remove();}
jQ('#addToListSpan').show();webshop.catalogue.BackOfPack._registerAddToList(sku);jQ('#addToFavSpan').show();var addFavLink=jQ('#addToFavouritesLink');var removeFavLink=jQ('#removeFromFavouritesLink');if(isFavourite){addFavLink.hide();removeFavLink.show();}else{addFavLink.show();removeFavLink.hide();}
addFavLink.attr('href','/webshop/addToFavourites.do?sku='+sku);removeFavLink.attr('href','/webshop/deleteFavouritesItem.do?sku='+sku);if(hasSubstitutions){var subsLink=jQ('.subsLink');if(subsLink.length>0){subsLink.attr('href','/webshop/getAlternatives.do?sku='+sku);subsLink.show();}else{subsLink="<a href='/webshop/getAlternatives.do?sku="+sku+"' class='subsLink'>"+getMessage('catalogue.multiDimensionSelection.showSimilarLink')+"</a>";jQ('.addToOptions').prepend(subsLink);jQ('#addToListSpan').prepend('<span class="optionSeparator"> | </span>');}}else{jQ('.subsLink').hide();}
if(jQ('h2.description.section-header').length>0){jQ('#bopBottom').children('h2.description').stop(true,true).fadeOut(function(){jQ('#bopBottom').children('div.description').remove();jQ(this).remove();});}
jQ('#bopBottom').prepend(productDescription);var popup=jQ('#bopPopup');if(!popup.length){var isOnOffer=jQ('p.onOffer');isOnOffer.html(offerMessage).show();jQ('.sgPrice').hide();jQ('.derivPrice').hide();jQ('.derivPrice.price-'+sku).show();var bopSideBar=jQ('#sidebar');var recommendationpg=jQ('.bopRecommendation');var sidebarNavigation=jQ('#sidebarNav');if(recommendationpg.length){if(ymlWrapper.length){var parentRecommendation=recommendationpg.parent();recommendationpg.remove();parentRecommendation.prepend(ymlWrapper);}else{recommendationpg.remove();}}else{if(ymlWrapper.length){if(sidebarNavigation.length){sidebarNavigation.append(ymlWrapper);}else{bopSideBar.append('<div id="sidebarNav" class="shop" />');sidebarNavigation=jQ('#sidebarNav');sidebarNavigation.append(ymlWrapper);}}}
var nutritionTab=jQ('.nutritionSection');var elementBeforeNutritionSection=null;var parentOfNutritionSection=null;if(nutritionTab.length){elementBeforeNutritionSection=nutritionTab.prev();parentOfNutritionSection=nutritionTab.parent();}
if(nutritionTab.length&&nutrition.length){nutritionTab.remove();if(elementBeforeNutritionSection.length){nutrition.insertAfter(elementBeforeNutritionSection);}else{parentOfNutritionSection.prepend(nutrition);parentOfNutritionSection.prepend('<h3 class="section-header">'+getMessage('catalogue.multiDimensionSelection.nutritionHeader')+'</h3>');}}else if(!nutritionTab.length&&nutrition.length){var productInformationTab=jQ('#bopBottom').find('.productInfoSection');if(productInformationTab.length){nutrition.insertAfter(productInformationTab);jQ('<h3 class="section-header">'+getMessage('catalogue.multiDimensionSelection.nutritionHeader')+'</h3>').insertAfter(productInformationTab);}else{jQ('#bopBottom').prepend(nutrition);jQ('#bopBottom').prepend('<h3 class="section-header">'+getMessage('catalogue.multiDimensionSelection.nutritionHeader')+'</h3>');}}else if(nutritionTab.length&&!nutrition.length){nutritionTab.remove();elementBeforeNutritionSection.remove();}
var productInformationTab=jQ('.productInfoSection');productInformationTab.html(otherInformation);}else{var isOnOffer=jQ('#bopPopup p.onOffer');isOnOffer.html(offerMessage).show();jQ('#bopPopup .sgPrice').hide();jQ('#bopPopup .derivPrice').hide();jQ('#bopPopup .derivPrice.price-'+sku).show();var href=jQ('.fullDetails').attr('href');var params='';if(href.indexOf('?')!=-1){params=href.split('?')[1];while(params.indexOf('sku')!=-1){var startIndex=params.indexOf('sku');var endIndex=params.indexOf('&',startIndex);if(endIndex==-1){endIndex=params.length-1;}else{endIndex=endIndex+1;}
params=params.substring(0,startIndex)+params.substring(endIndex,params.length-1);}
jQ('.fullDetails').attr('href',"/webshop/getProductDetails.do?sku="+sku+"&"+params);}else{jQ('.fullDetails').attr('href',"/webshop/getProductDetails.do?sku="+sku);}}}},disableAddButtonAndLinks:function(){var addButtonForm=jQ('form.addButton.productDetails-'+bopPageSku);addButtonForm.find(".productAdd").attr("disabled","disabled");addButtonForm.parent().addClass('none');jQ('#addToListSpan').hide();jQ('#addToFavSpan').hide();jQ('.subsLink').hide();},enableAddButton:function(){var addButtonForm=jQ('form.addButton.productDetails-'+bopPageSku);addButtonForm.find(".productAdd").removeAttr("disabled");addButtonForm.parent().removeClass('none');},resetTitleToParent:function(){jQ('#h2-'+bopPageSku).html("<strong>"+parentTitle+"</strong>");}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.PromotedItemsAddButtonWithIndicator={init:function(){_.extend(this,webshop.gtm.mixins.trolleyButtons);this.observeForms();this.observeBasketEvents();},observeForms:function(){var eventSender=new ocBackbone.gtm.TrolleyEventSender();jQ(document.body).on('click','.promotedItemsAddButtonWithIndicator input.increment',(function(clazz){return function(e){if(webshop.common.jsVariables.get('gaTrackBasketUpdateOnSuccess')){var domElement=this;webshop.catalogue.Util.sendUpdateBasketRequest.call(domElement,e,clazz,function(){clazz.gtmSendProductAddedToTrolleyEvent(domElement,eventSender);});}else{if(webshop.catalogue.Util.sendUpdateBasketRequest.call(this,e,clazz)){clazz.gtmSendProductAddedToTrolleyEvent(this,eventSender);}}};})(this));jQ(document.body).on('click','.promotedItemsAddButtonWithIndicator input.decrement',(function(clazz){return function(e){if(webshop.common.jsVariables.get('gaTrackBasketUpdateOnSuccess')){var domElement=this;webshop.catalogue.Util.sendUpdateBasketRequest.call(domElement,e,clazz,function(){clazz.gtmSendProductRemovedFromTrolleyEvent(domElement,eventSender);});}else{if(webshop.catalogue.Util.sendUpdateBasketRequest.call(this,e,clazz)){clazz.gtmSendProductRemovedFromTrolleyEvent(this,eventSender);}}};})(this));},observeBasketEvents:function(){document.observe('webshop:basket:update',function(evt){var jsonData=evt.memo.data;if(jsonData&&jsonData.lastItemUpdated){var forms=jQ('form.promotedItemsAddButtonWithIndicator-'+jsonData.lastItemUpdated.sku);if(forms){for(var i=0,len=forms.length;i<len;i++){this.updateForm(jQ(forms[i]),jsonData.lastItemUpdated);}}}}.bind(this));},updateForm:function(form,jsonData){webshop.catalogue.Util.removeLatestInTrolleyClassFromOtherIndicators(jsonData.sku,jsonData.itemQuantity);var indicatorIsAlreadyPresent=form.find('input.decrement').length>0;if(jsonData.itemQuantity==0){form.find('div.controlButtons').remove();var indicator=this.renderNotInTrolley(form,jsonData);form.append(indicator).show();this._styleNotInTrolley(form);var newUrl=form.attr('action').replace('updateBasket.do','addToBasket.do');form.attr('action',newUrl);}else if(indicatorIsAlreadyPresent){form.find('span.productCount').remove();var showDescription=form.find('.showDescription')[0].getAttribute("value")!=="false";var desc=this._getItemDescription(jsonData,showDescription);var productCount=new Element('span',{'class':'productCount'}).update(desc);jQ(form.find('div.controlButtons')).prepend(productCount);}else{form.find('div.controlButtons').remove();var indicator=this.renderInTrolley(form,jsonData);form.append(indicator).show();var newUrl=form.attr('action').replace('addToBasket.do','updateBasket.do');form.attr('action',newUrl);}
if(jsonData.itemQuantity!=0){this.styleInTrolley(form,true);}},renderNotInTrolley:function(form,jsonData){webshop.catalogue.Util.removeLatestInTrolleyClassFromOtherIndicators(jsonData.sku,jsonData.itemQuantity);var div=jQ('<div></div>').addClass('controlButtons'),incrementWrapper=jQ('<span />').addClass('addBtn').addClass('btn-prominence').text(getMessage('catalogue.promotedItemsAddButtonWithIndicator.addBtnText')),increment=jQ('<input/>').addClass('productAdd').attr({'type':'submit','name':'quantity','title':getMessage('catalogue.promotedItemsAddButtonWithIndicator.addToTrolleyInputTitle',jsonData.description)}).val('1'),qty=jQ('<input/>').attr({'type':'hidden','name':'quantity'}).val('1');incrementWrapper.append(increment);return div.append(qty).append(incrementWrapper);},renderInTrolley:function(form,jsonData){webshop.catalogue.Util.removeLatestInTrolleyClassFromOtherIndicators(jsonData.sku,jsonData.itemQuantity);var div=jQ('<div></div>').addClass('controlButtons'),showDescription=form.find('.showDescription').val()!=="false",productCount=jQ('<span></span>').addClass('productCount').html(this._getItemDescription(jsonData,showDescription)),decrement=jQ('<input/>').addClass('decrement').attr({'type':'submit','name':'quantity','title':getMessage('catalogue.promotedItemsAddButtonWithIndicator.removeFromTrolleyInputTitle',jsonData.description)}).val('-1'),increment=jQ('<input/>').addClass('increment').attr({'type':'submit','name':'quantity','title':getMessage('catalogue.promotedItemsAddButtonWithIndicator.addOneToTrolleyInputTitle',jsonData.description)}).val('1');return div.append(productCount).append(decrement).append(increment);},styleInTrolley:function(form,latest){if(latest){jQ(form).parent('div.alternative').addClass('inTrolleyBorder');jQ(form).parent().parent('li').addClass('shelfLastInTrolley');jQ(form).parent('div.fopBox').addClass('shelfLastInTrolley');}
jQ(form).removeClass('addProductForm');jQ(form).addClass('inTrolley');jQ(form).parent('div.fopBox').addClass('shelfInTrolley');},_styleNotInTrolley:function(form){jQ(form).removeClass('inTrolley');jQ(form).addClass('addProductForm');},_getItemPrice:function(jsonData){var price=""+jsonData.itemCataloguePrice;return price;},_getItemDescription:function(jsonData,showDescription){var description=" "+jsonData.itemQuantity;description+=showDescription?" x "+unescape(jsonData.shortDescription):"";description+=(showDescription&&jsonData.catchweight)?", "+jsonData.catchweight:"";return description+" "+getMessage('catalogue.promotedItemsAddButtonWithIndicator.descSuffixInTrolley');}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.SavingPassSlider={init:function(){this._registerCustomEventListener();this._registerSavingPassSlider();},_registerCustomEventListener:function(){jQ(document.body).on('webshop:spSlider:register',this._registerSavingPassFOPSlider);},_registerSavingPassSlider:function(){var slider=webshop.catalogue.SavingPassSlider;slider.savingsPassShelfSlide();slider.savingsPassListSlide();slider.savingsPassBopSlide();},_registerSavingPassFOPSlider:function(){var $prodList=jQ('#prodList');if($prodList){$prodList.undelegate('.savingsPassHandle','click');if($prodList.hasClass('shelfView')){webshop.catalogue.SavingPassSlider.savingsPassShelfSlide();}else{webshop.catalogue.SavingPassSlider.savingsPassListSlide();}}},savingsPassShelfSlide:function(){jQ('.shelfView').on('click','.savingsPassHandle',function(){if(jQ(this).hasClass('clicked')){jQ('.savingsPassInfo *',this).fadeOut(100);jQ(this).animate({height:'17px'},200,'linear',function(){jQ(this).removeClass('clicked');jQ('.savingsPassInfo',this).hide();});}else{jQ('.savingsPassInfo *',this).show();jQ(this).addClass('clicked').animate({height:'88px'},200,'linear',function(){jQ('.savingsPassInfo',this).show();});return false;}});jQ('.shelfView').on('click','.savingsPassHandle a.spMessage',function(e){e.preventDefault();});},savingsPassListSlide:function(){jQ('.listView, .textView').on('click','.savingsPassHandle',function(){if(jQ(this).hasClass('clicked')){jQ('.savingsPassInfo *',this).hide();jQ(this).animate({width:'127px'},200,'linear',function(){jQ(this).removeClass('clicked');jQ('.savingsPassInfo',this).hide();});}else{jQ('.savingsPassInfo *',this).show();jQ(this).addClass('clicked').animate({width:'370px'},200,'linear',function(){jQ('.savingsPassInfo',this).show();});return false;}});jQ('.listView, .textView').on('click','.savingsPassHandle a.spMessage',function(e){e.preventDefault();});},savingsPassBopSlide:function(){jQ('#bopRight, #bopPeriodical').on('click','.savingsPassHandle',function(){if(jQ(this).hasClass('clicked')){jQ('.savingsPassInfo *',this).hide();jQ(this).animate({width:'127px'},200,'linear',function(){jQ(this).removeClass('clicked');jQ('.savingsPassInfo',this).hide();});}else{jQ('.savingsPassInfo *',this).show();jQ(this).addClass('clicked').animate({width:'288px'},200,'linear',function(){jQ('.savingsPassInfo',this).show();});return false;}});jQ('#bopRight, #bopPeriodical').on('click','.savingsPassHandle a.spMessage',function(e){e.preventDefault();});}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.ServiceCounter={init:function(){this._registerSCEvents();this._registerPGSelectListener();this.observeBasketUpdate();this.observeForms();this.observeSCEvents();},_registerSCEvents:function(){jQ(document.body).on('change','form.serviceCounter select',function(){var selects=jQ('select[name='+jQ(this).attr('name')+']');selects.attr('value',jQ(this).attr('value'));if(selects.val()!==''){selects.parent('label').addClass('done');}else{selects.parents('.productDetails').find('p.addToLinks a').remove();selects.parent('label').removeClass('done');}
webshop.catalogue.Util.sendSCUpdatePriceRequest(jQ(this));});},observeForms:function(){jQ(document.body).on('webshop:sc:bind',this._registerSCEvents);},observeBasketUpdate:function(){document.observe('webshop:basket:update',function(evt){var jsonData=evt.memo.data;if(!jsonData.hasOwnProperty('lastItemUpdated')){return;}
if(!jsonData.lastItemUpdated.hasOwnProperty('scSellingGrp')){return;}
var derivativesInBasket=jsonData.lastItemUpdated.scTotalDerivativesInBasket,sellingGroup=jsonData.lastItemUpdated.scSellingGrp,container=jQ('.scSellingGroup-'+sellingGroup),isInYML=container.hasClass('youMightLike');if(container.length){var form=container.find('form'),isShelfView=container.parents('ul').hasClass('shelfView'),isListView=container.parents('ul').hasClass('listView'),li=isShelfView?container.parents('li'):jQ([]);if(form.length){if(derivativesInBasket>0){isInYML?'':li.addClass('shelfInTrolley');form.find('.productCount span').text(derivativesInBasket);}else{isInYML?'':li.removeClass('shelfInTrolley');var chooseButton=container.find(".selectOptionsButton");if(chooseButton.length){var primaryDimension=jQ('.primaryDimensionValue');var chooseText="options";if(primaryDimension.length){var primaryDimensionValue=primaryDimension.val();if(primaryDimensionValue==='PRODUCT_COLOUR'){chooseText='colour';}else if(primaryDimensionValue==='SIZE'){chooseText='size';}else if(primaryDimensionValue==='FRAGRANCE'){chooseText='fragrance';}else if(primaryDimensionValue==='FLAVOUR'){chooseText='flavour';}else if(primaryDimensionValue==='SHADE'){chooseText='shade';}}
var chooseOptionsButton=jQ('<a href="'+chooseButton.attr('href')+'" class="selectOptionsButton btn-prominence colourOptions button"><span><em class="icon"></em>'+getMessage('catalogue.serviceCounter.choosePrefix')+' '+chooseText+'</span></a>');container.append(chooseOptionsButton);form.remove();}else{if(!isListView){form.remove();}}}}else if(derivativesInBasket>0){isInYML?'':li.addClass('shelfInTrolley');var chooseOptionsButton=container.find(".selectOptionsButton");if(chooseOptionsButton.length){var indicatorForm=jQ('<form class="addProductForm sgProductForm" method="post" id="inTrolley-'+sellingGroup+'"><span class="indicator"><label class="productCount"><span>'+derivativesInBasket+'</span> '+getMessage('catalogue.serviceCounter.descSuffixInTrolley')+'</label></span></form>');var chooseButton=jQ('<a href="'+chooseOptionsButton.attr('href')+'" class="selectOptionsButton btn-prominence button"><span>'+getMessage('catalogue.serviceCounter.chooseButton')+'</span></a>');if(isShelfView){indicatorForm.append(chooseButton);container.append(indicatorForm);}else{container.append(chooseButton);}
chooseOptionsButton.remove();}else{var indicator=jQ('<form class="addProductForm center" method="post" id="inTrolley-'+sellingGroup+'"><label class="productCount"><span>'+derivativesInBasket+'</span> '+getMessage('catalogue.serviceCounter.descSuffixInTrolley')+'</label></form>');container.append(indicator);}}}
jQ(document).trigger('webshop:bopPopup:contentChanged');});},observeSCEvents:function(){document.observe('webshop:sc:updatePrice',function(evt){var jsonData=evt.memo.data;var haveDerivative=jsonData.hasOwnProperty('sku');if(haveDerivative){this.showDerivative(jsonData);}else{this.hideDerivative(jsonData);}
jQ(document).trigger('webshop:bopPopup:contentChanged');}.bind(this));},showDerivative:function(jsonData){var messageSpan=jQ('.scPriceMessage-'+jsonData.scSellingGrp);var addButtonForm=jQ('form.addButton.productDetails-'+jsonData.scSellingGrp);if(jsonData.scAvailable&&addButtonForm.length){addButtonForm.find('input[name="sku"]').val(jsonData.sku);addButtonForm.find('input[name="desc"]').val(jsonData.desc);var priceSpan=addButtonForm.siblings('p.typicalPrice');if(jsonData.price.endsWith("p")){priceSpan.text(jsonData.price);}else{priceSpan.html("&pound;"+jsonData.price);}
jQ('.scPriceDiv-'+jsonData.scSellingGrp).removeClass('none');addButtonForm.find(".productAdd").removeAttr("disabled");messageSpan.text(jsonData.catchweight?getMessage('catalogue.serviceCounter.typicalPriceSpanText'):"");var addToLinks=jQ('#productDetails-'+jsonData.scSellingGrp+' p.addToLinks');if(jsonData.isFavourite){addToLinks.html('<a class="removeFromFaves secondary" href="/webshop/deleteFavouritesItem.do?sku='+jsonData.sku+'"><em class="icon"></em>'+getMessage('catalogue.serviceCounter.removeFromFavLink')+'</a>');}else{addToLinks.html('<a class="addToFaves secondary" href="/webshop/addToFavourites.do?sku='+jsonData.sku+'"><em class="icon"></em>'+getMessage('catalogue.serviceCounter.addToFavLink')+'</a>');}
addToLinks.append('<a class="addToAList secondary"><em class="icon"></em>'+getMessage('catalogue.serviceCounter.addShoppingListLink')+'</a>');addToLinks.show();jQ('#addToListSpan').show();webshop.catalogue.BackOfPack._registerAddToList(jsonData.sku);jQ('#addToFavSpan').show();var addFavLink=jQ('#addToFavouritesLink');var removeFavLink=jQ('#removeFromFavouritesLink');if(jsonData.isFavourite){addFavLink.hide();removeFavLink.show();}else{addFavLink.show();removeFavLink.hide();}
addFavLink.attr('href','/webshop/addToFavourites.do?sku='+jsonData.sku);removeFavLink.attr('href','/webshop/deleteFavouritesItem.do?sku='+jsonData.sku);}else{messageSpan.text(getMessage('catalogue.serviceCounter.combinationUnavailableMsg'));}},hideDerivative:function(jsonData){jQ('.scPriceDiv-'+jsonData.scSellingGrp).addClass('none');var addButtonForm=jQ('form.addButton.productDetails-'+jsonData.scSellingGrp);addButtonForm.find('.productAdd').attr('disabled','disabled');addButtonForm.find('input[name="sku"]').val('');addButtonForm.find('input[name="desc"]').val('');addButtonForm.siblings('p.typicalPrice').text('');jQ('.productDetails-'+jsonData.scSellingGrp+' p.addToLinks').hide().html('');jQ('#addToListSpan, #addToFavSpan').hide();var messageSpan=jQ('.scPriceMessage-'+jsonData.scSellingGrp);if(jsonData.scMissingSku){messageSpan.text(getMessage('catalogue.serviceCounter.combinationUnavailableMsg'));}else{messageSpan.text(getMessage('catalogue.serviceCounter.selectOptionToUpdatePriceMsg'));}},_registerPGSelectListener:function(){jQ(document.body).on('change','.pg_select',function(){jQ(this).parentsUntil('form').parent().submit();});}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.Util={sendUpdateBasketRequest:function(e,clazz,onSuccessCallback){var util=webshop.catalogue.Util,button=jQ(this);var url='';var params={};var sku='';if(button.parents('form').length>0){var form=button.parents('form'),params=util._getParams(form,button);var qty=parseInt(params.quantity)||0;if(qty===0&&!_.isUndefined(params.quantity)){e.preventDefault();return false;}
if(button.attr('disabled')){e.preventDefault();return false;}
if(!_.has(params,'sku')){e.preventDefault();return false;}
if(button.disable){button.disable();}
if(button.hasClass('productAdd')){button.addClass('productAddDown');}
url=form.attr('action');sku=jQ(form).find('input[name="sku"]')[0].value;}else{url=button.attr('href');try{sku=url.split('sku=')[1].split('&')[0];}catch(error){webshop.common.ServerLogger.error("Failed to get SKU from url param, details: "+error);}}
if(button.data('sendUpdateBasketRequest')!==undefined&&button.data('sendUpdateBasketRequest')!==clazz){e.preventDefault();return false;}
if(button.data('sendUpdateBasketRequest')===undefined){button.data('sendUpdateBasketRequest',clazz);}
jQ.ajax({url:url,type:"POST",data:_.merge({'ajax':true},params),success:_.partial(util._handleBasketUpdate,_,'webshop:basket:update',button,onSuccessCallback)});webshop.info=webshop.info||{};webshop.info.PID=sku;if(typeof dataLayer!='undefined'){dataLayer.push({'event':'ProductAddToBasketRule','PID':webshop.info.PID});}
e.preventDefault();return true;},sendSCUpdatePriceRequest:function(selectChanged){if(selectChanged&&!application.activeRequestFlag){var form=selectChanged.parents('form'),url=form.attr('action'),formParams=webshop.catalogue.Util.formParametersAsJson(form.serializeArray());jQ.ajax({url:url,type:"POST",data:_.merge({'ajax':true},formParams),success:_.partial(webshop.catalogue.Util._fireEvent,_,'webshop:sc:updatePrice',selectChanged)});}
return false;},_getParams:function(form,buttonClicked){if(form){var formIsInTrolleyIndicator=form.hasClass('inTrolley'),formIsShelfInTrolleyIndicator=jQ(form).parent().parent().parent('li').hasClass('shelfInTrolley'),formIsLoggedInFopInTrolleyIndicator=jQ(form).parent('div.fopBox').hasClass('shelfInTrolley');var formParameters=webshop.catalogue.Util.formParametersAsJson(form.serializeArray());if(formIsInTrolleyIndicator||formIsShelfInTrolleyIndicator||formIsLoggedInFopInTrolleyIndicator){formParameters['quantity']=buttonClicked.attr('value');}
if(jQ(form).hasClass('addButtonCowGift')&&jQ(form).parent().hasClass('added')){formParameters['quantity']=-1;}
return _.merge(formParameters,webshop.catalogue.Util._getXyPositionParams(buttonClicked));}
return{};},_getXyPositionParams:function(buttonClicked){if(buttonClicked){var offset=buttonClicked.offset();return{'quantityUpdateAddedFromX':Math.round(offset.left),'quantityUpdateAddedFromY':Math.round(offset.top)};}},_fireEvent:function(data,eventName,element){if(data&&eventName){if(element.enable){element.enable();}
element.removeClass('productAddDown');document.fire(eventName,{'data':data,'element':element});}},_handleBasketUpdate:function(data,eventName,element,onSuccessCallback){var util=webshop.catalogue.Util;if(!data.errors&&onSuccessCallback&&_.isFunction(onSuccessCallback)){onSuccessCallback();}
util._handleErrorsAndfireEvent(data,eventName,element);},_handleErrorsAndfireEvent:function(data,eventName,element){var warnings=jQ("p.qtyWarning");warnings.hide().empty();var lastBoughts=jQ("p.lastBought");lastBoughts.show();if(_.isArray(data.errors)&&data.errors[0]&&data.sku){var warning=jQ(".productWarning-"+data.sku);warning.text(data.errors[0]);warning.show();var lastBought=jQ("#lastBought-"+data.sku);lastBought.hide();}
if(data.maxPromoAlert){var maxPromoAlertPopup=webshop.popup.create({wrapperId:"maxPromoAlertModal"});var $acceptButton=jQ('<button/>',{text:getMessage('catalogue.maxPromoAlert.okButton'),click:function(e){maxPromoAlertPopup.closePopup(e);}});maxPromoAlertPopup.container.append('<h2>'+getMessage('catalogue.maxPromoAlert.body',data.maxPromoAlert)+'</h2>',$acceptButton);}
webshop.catalogue.Util._fireEvent(data,eventName,element);},removeLatestInTrolleyClassFromOtherIndicators:function(sku,quantity){var indicators=jQ('ul.productList, #boxes, div.multiSearch').find('li.shelfLastInTrolley, div.inTrolleyBorder');if(quantity!=='0'){indicators=indicators.filter(function(){var match=jQ(this);return match.attr('id')!=='productDetails-'+sku&&match.children('form.addButton-'+sku).length===0&&match.children('form.alternativesAddButtonWithIndicator-'+sku).length===0;});}
indicators.removeClass('shelfLastInTrolley');indicators.removeClass('inTrolleyBorder');},formParametersAsJson:function(formParameters){return _.reduce(formParameters,function(acc,value){acc[value.name]=value.value;return acc;},{});}};webshop.catalogue=webshop.catalogue||{};webshop.catalogue.Amplience={eventTypes:{MODULE_VIEWED:"MV",SLIDE_DISPLAYED:"SD",INTERACTION:"I",LINK_SELECTED:"LS",PANEL_OPENED:"PO",CUSTOM_ACTION:"CA"},init:function(){if(typeof amplience!=="undefined"){for(var i=0;i<amplience.content.length;i++){var area=amplience.content[i];var vars={};if(area.extraParams){for(param in area.extraParams){vars[param]=area.extraParams[param];}}
vars["id"]=area.guid;vars["resolveJSPath"]="true";var protocolAdaptedBasePath=this.applyCurrentPageProtocolToUrl(area.basePath);interact.embedApp({target:area.id,width:area.width,height:area.height,vars:vars,params:{bgcolor:"#"+area.bgColour,base:protocolAdaptedBasePath,wmode:"opaque",allowScriptAccess:"always"},src:[{type:"html5",src:protocolAdaptedBasePath+"tcplayer.js",xd:[protocolAdaptedBasePath+"xd.html"]},{type:"swf",src:protocolAdaptedBasePath+"tcplayer.swf",version:"9.0.0"}]});}}},Operation:{OPEN_QUICK_VIEW:"OPEN_QUICK_VIEW"},thirdPartyFnCalled:function(dataOrSku,moduleId){var data=this.preprocessThirdPartyFnData(dataOrSku);data["moduleId"]=moduleId;this.processThirdPartyFnCall(data);},preprocessThirdPartyFnData:function(data){if(this.isInteger(data)){return this.getThirdPartyFnDataForSku(data);}
else{return data;}},isInteger:function(possibleIntegerStr){var possibleInteger=parseInt(possibleIntegerStr,10);return(!isNaN(possibleInteger))&&(possibleInteger.toString()==possibleIntegerStr);},getThirdPartyFnDataForSku:function(sku){var data={"op":this.Operation.OPEN_QUICK_VIEW,"params":{"sku":sku}};return data;},processThirdPartyFnCall:function(data){var op=data["op"];if(this.Operation.OPEN_QUICK_VIEW==op){var sku=data["params"]["sku"];this.quickViewButtonClicked(sku);}},analyticsEvent:{AMPLIENCE_MODULE_DISPLAYED:"AMPLIENCE_MODULE_DISPLAYED",AMPLIENCE_LINK_CLICKED:"AMPLIENCE_LINK_CLICKED",OPEN_BOP_POPUP:"AMPLIENCE_OPEN_BOP_POPUP"},eventFired:function(amplienceEvent){var requestParams={ajax:true,pageViewId:amplience.pageParams.pageViewId,analyticsPageType:amplience.pageParams.analyticsPageType};if(this.eventTypes.MODULE_VIEWED==amplienceEvent.eventName){}else if(this.eventTypes.SLIDE_DISPLAYED==amplienceEvent.eventName){}else if(this.eventTypes.LINK_SELECTED==amplienceEvent.eventName){requestParams.pageEventType=this.analyticsEvent.AMPLIENCE_LINK_CLICKED;jQ.extend(requestParams,amplienceEvent);jQ.ajax({url:'/webshop/createPageEvent.do',data:requestParams,async:false});}else if(this.eventTypes.CUSTOM_ACTION==amplienceEvent.eventName){var data=this.preprocessThirdPartyFnData(amplienceEvent.value);if(data.op==this.Operation.OPEN_QUICK_VIEW){}else{}}else{}},quickViewButtonClicked:function(sku){var from=amplience.pageParams["quickView_from"];var analyticsPageType=amplience.pageParams["analyticsPageType"];var tags=amplience.pageParams["tags"];var popup="true";var analyticsSection="AMPLIENCE_BACK_OF_PACK_POPUP";var url="/webshop/getBackOfPackPopup.do?sku="+sku+"&popup="+popup+"&from="+from+"&analyticsPageType="+analyticsPageType
+"&tags="+tags+"&quantityUpdateAddedFromSection="+analyticsSection+"&eventType=AMPLIENCE_OPEN_BOP_POPUP";if(!webshop.catalogue.BackOfPackPopup.socialAdded){webshop.catalogue.socialLinks._registerSocialMedia();webshop.catalogue.BackOfPackPopup.socialAdded=true;}
webshop.catalogue.BackOfPackPopup.openBackOfPackPopUpWithDataRetrievedFromUrl(url);},applyCurrentPageProtocolToUrl:function(url){var protocolAndColon=window.location.protocol;if((!protocolAndColon)||(protocolAndColon==null)||(protocolAndColon.length==0)){return url;}
else{var index=url.indexOf("://");if(index<0){return url;}
else{return protocolAndColon+url.substring(index+1);}}}};function tencmsInvokeAction(data,moduleId){webshop.catalogue.Amplience.thirdPartyFnCalled(data,moduleId);}
function invokeTenCMSEvent(event){webshop.catalogue.Amplience.eventFired(event);}
webshop.catalogue=webshop.catalogue||{};webshop.catalogue.socialLinks={init:function(){},_registerSocialMedia:function(){this.gpload();new PinItButtonView();},fbload:function(){FB.XFBML.parse(document.getElementById(".fb-like"));},gpload:function(){window.___gcfg={lang:'en-GB'};var po=document.createElement('script');po.type='text/javascript';po.async=true;po.src='https://apis.google.com/js/plusone.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(po,s);}};(function(window,Backbone){'use strict';window.PinItButtonView=Backbone.View.extend({el:'#pinit',initialize:function(){webshop.gtm.registerEventSource(this);},events:{"click #PinItButton":"pinIt"},pinIt:function(e){var productUrl=this.$('input[name="productUrl"]').attr('value');var pinterestUrl=this.$('#PinItButton').attr('href');this.trigger("gtm:PinnedIt",productUrl);window.open(pinterestUrl,'pin','scrollbars=yes, height=265, width=570');e.preventDefault();}});})(window,Backbone);webshop.user=webshop.user||{};webshop.user.Login={init:function(){this.toggleLabels(true);this.initPayPalLogin();this.loginButton=new this.LoginButton();window.addEventListener('message',this.resizeIframeHandler.bind(this),false);},resizeIframeHandler:function(event){if(!this.isValidTargetOrigin(event.origin)||(isNaN(event.data.height))){return;}
jQ('.sso-iframe-login').css('height',event.data.height+'px');jQ('#socialFallbackPopup').toggleClass('with-captcha',event.data.captcha==='captchaWithImages');},isValidTargetOrigin:function(origin){var ssoTargetOrigin=webshop.common.jsVariables.get('ssoTargetOrigin');var windowOrigin=window.location.origin;if(!windowOrigin){windowOrigin=window.location.protocol+"//"+window.location.hostname+(window.location.port?':'+window.location.port:'');}
return origin===ssoTargetOrigin||origin===windowOrigin;},loadCaptchaOverlay:function(url,login){var self=this,popup=webshop.popup.create({onClose:function(event){},wrapperId:'generic'});popup.container.addClass('spinner').position('center');jQ.ajax({url:url,data:{ajax:true},success:function(data){self.putDataInPopup(data,popup);webshop.popup.CaptchaPopup.display(popup,"recaptcha_widget_div",login);},error:function(jqXHR,textStatus,errorThrown){window.location=url;}});},putDataInPopup:function(data,popup){popup.container.children(':not(.close)').remove();popup.container.removeClass('spinner').append(data).position('center');},toggleLabels:function(runOnLoad){var inputSelectors=['.inviteFriendsContent .textbox','.dynamicLabel'];var loginInputs=jQ(inputSelectors.join(', '));var labelSelectors=['.inviteFriendsContent label','.isPlaceholder'];var obj=this;obj.inputLabels=jQ(labelSelectors.join(', '));obj.loginInputs=loginInputs;if(runOnLoad){setTimeout(function(){for(var i=0;i<=(loginInputs.length-1);i++){var currInput=jQ(loginInputs[i]);if(currInput.val()===''){jQ(obj.inputLabels[i]).addClass('showLabel');}else{jQ(obj.inputLabels[i]).addClass('hideLabel');}}
loginInputs=undefined;},250);}
else{for(var i=0;i<=(loginInputs.length-1);i++){var currInput=jQ(loginInputs[i]);if(currInput.val()===''){jQ(obj.inputLabels[i]).addClass('showLabel');}}}
loginInputs.on('focus',function(){obj.toggleLabelState(jQ(this),false);});loginInputs.on('blur',function(){obj.toggleLabelState(jQ(this),true);});loginInputs.on('keydown',function(){obj.toggleLabelState(jQ(this),false);});if(!runOnLoad)loginInputs=undefined;},toggleLabelState:function(elem,show){var currLabel=this.inputLabels.filter('[for="'+elem.attr('id')+'"]');(show&&elem.val()==='')?currLabel.removeClass('hideLabel').addClass('showLabel'):currLabel.removeClass('showLabel').addClass('hideLabel');},ajaxToggleRemove:function(){if(this.loginInputs){this.loginInputs.off('focus');this.loginInputs.off('blur');this.loginInputs.off('keydown');this.loginInputs=undefined;}
this.loginInputs=undefined;this.inputLabels=undefined;},initPayPalLogin:function(){jQ(document.body).on('submit','form.paypalLogin',this.handlePayPalLogin);},handlePayPalLogin:function(evt){evt.preventDefault();var form=evt.target;var address="";var windowName="_PPIdentityWindow_";var windowProps="location=1,status=0,scrollbars=0,width=400,height=550";window.open(address,windowName,windowProps);form.target=windowName;form.submit();},LoginButton:Backbone.View.extend({el:'#js-popupLoginButton',events:{'click':'clicked'},initialize:function(){webshop.gtm.registerEventSource(this);},clicked:function(){var URI=window.location.pathname;this.trigger('gtm:uaEvent',{category:'Login',action:URI});}})};'use strict';webshop.user.QuickRegBox=webshop.user.QuickRegBox||{};function LabelPlaceholder(inputId){this.inputId=inputId;this.initPlaceholder();}
LabelPlaceholder.prototype.initPlaceholder=function(){var inputElement=jQ('#'+this.inputId);var labelElement=jQ('[for="'+this.inputId+'"]');var togglePlaceholder=function(elem,currLabel,show){(show&&elem.val()==='')?currLabel.removeClass('hideLabel').addClass('showLabel'):currLabel.removeClass('showLabel').addClass('hideLabel');};togglePlaceholder(inputElement,labelElement,true);inputElement.on('change',function(){togglePlaceholder(inputElement,labelElement,false);});inputElement.on('focus',function(){togglePlaceholder(inputElement,labelElement,false);});inputElement.on('blur',function(){togglePlaceholder(inputElement,labelElement,true);});inputElement.on('keydown',function(){togglePlaceholder(inputElement,labelElement,false);});};webshop.user.QuickRegBox={init:function(){new LabelPlaceholder('idNavSearchTxt');}};webshop.user=webshop.user||{};webshop.user.User={init:function(){jQ('.formRow input, .formRowNoError input').on('focus',function(){webshop.user.User.addHelper(this);});jQ('.formRow input, .formRowNoError input').on('blur',function(){webshop.user.User.removeHelper(this);});},removeHelper:function(input){jQ(input).parent().removeClass('helper');},addHelper:function(input){var parent=jQ(input).parent();if(!parent.hasClass('error_warning')&&!parent.find('.formFieldError').is(':visible')){parent.addClass('helper');}}};webshop.animations=webshop.animations||{};webshop.animations.ScrollMode={init:function(){var $wrapper=jQ('#fix');var $wnd=jQ(window);var scrollModeSiteTabsClassAdded=false;var scrollModeClassAdded=false;var headerBarHeight=jQ('#headerBar').height();if(webshop.common.Util.isIPad()){$wrapper.addClass('scrollMode-ipad');}
$wnd.on('scroll',function(){var scrollTop=$wnd.scrollTop();if(scrollTop>headerBarHeight){if(!scrollModeSiteTabsClassAdded){$wrapper.addClass('scrollMode-siteTabs');scrollModeSiteTabsClassAdded=true;$wnd.trigger('scrollMode.stickyHeader',{'active':true});}}else if(scrollModeSiteTabsClassAdded){$wrapper.removeClass('scrollMode-siteTabs');scrollModeSiteTabsClassAdded=false;$wnd.trigger('scrollMode.stickyHeader',{'active':false});}
if(scrollTop>1){if(!scrollModeClassAdded){$wrapper.addClass('scrollMode');scrollModeClassAdded=true;}}else if(scrollModeClassAdded){$wrapper.removeClass('scrollMode');scrollModeClassAdded=false;}});$wnd.trigger('scroll');}};webshop.animations=webshop.animations||{};webshop.animations.bannerslider={init:function(){if(jQ('.landing-banners')&&jQ('.landing-banners ul li').length>1){this.slider();}},slider:function(){var banners=jQ('.landing-banners a'),controls=jQ('.landing-banners ul'),button=jQ('.landing-banners li'),curr=0,timer;slideTimer();function slideTimer(){timer=clearTimeout(timer);jQ(banners).stop(true,true);jQ('.landing-banners .current').removeClass('current');if(curr<banners.length){jQ(button[curr]).addClass('current');swapBanner(curr);curr++;}else{jQ(button[0]).addClass('current');swapBanner(0);curr=1;}
jQ(button).on('click',function(){timer=clearTimeout(timer);if(!jQ(this).hasClass('current')){jQ('.current').removeClass('current');jQ(this).addClass('current');curr=jQ(this).index()+1;swapBanner(jQ(this).index());}
timer=setTimeout(slideTimer,4000);});timer=setTimeout(arguments.callee,4000);};function swapBanner(pos){jQ('.current-banner').fadeOut(500).removeClass('current-banner').css('display','none');jQ(banners[pos]).fadeIn(500,function(){jQ(this).addClass('current-banner');});};}}
webshop.animations=webshop.animations||{};webshop.animations.searchMode={init:function(){if(jQ('#searchWrapper.js-searchWidthAdjust').length!=0){this.searchMode();}else{var search=jQ('#searchWrapper'),field=jQ('.loggedInWrap #header #findText'),multiSearch=jQ('#multiSearch'),msFull=search.find('.multiSearchFull'),searchList=search.find('.searchList');field.on('focus',function(){searchList.hide();multiSearch.removeClass('popLinkDisabled');msFull.animate({width:0},200,function(){msFull.hide();});});jQ('body').on('click',function(event){var el=event.target.id;if(el!=='findText'){jQ('.searchSuggestions').hide();}});}
this.addMultiSearchClickedAnalytics();},searchMode:function(){var search=jQ('#searchWrapper'),field=jQ('.loggedInWrap #header #findText'),multiSearch=jQ('#multiSearch'),msFull=search.find('.multiSearchFull'),searchList=search.find('.searchList');field.on('focus',function(){searchList.hide();multiSearch.removeClass('popLinkDisabled');field.animate({width:171},200);msFull.animate({width:0},200,function(){msFull.addClass('hidden');});search.addClass('searchMode');});jQ('body').on('click',function(event){var el=event.target.id;if(el!=='findText'){field.animate({width:108},200);msFull.animate({width:63},200);msFull.removeClass('hidden');search.removeClass('searchMode');jQ('.searchSuggestions').hide();}});},disableSMSSubmit:function(){window.setTimeout(function(){if(jQ('.smsReminders .error_warning').length>0){jQ('.smsReminders button').attr('disabled',true);}else{jQ('.smsReminders button').attr('disabled',false);}},1000);},addMultiSearchClickedAnalytics:function(){jQ('.multiSearchIcon').on('click',function(e){jQ.get('/webshop/createPageEvent.do',{ajax:true,pageEventType:'MULTI_SEARCH_CLICKED',pageViewId:webshop.analytics.pageViewId});});}};webshop.messagebox={maxItems:6,currentId:1,idPrefix:'messageBoxCmp',getId:function(){return this.idPrefix+this.currentId++;},getOverlay:function(createIfMissing){var overlay=jQ('#dialogOverlay');if(createIfMissing&&!overlay.length){overlay=jQ('<div id="dialogOverlay"></div>');jQ('#wrapper').before(overlay);jQ("#dialogOverlay").fadeTo(0.2,0.85);}
return overlay;},showOverlay:function(){this.getOverlay(true).show();},hideOverlay:function(){this.getOverlay().hide();},removeDialog:function(){jQ('#messagebox').remove();this.hideOverlay();},showError:function(message){var dialogInner=jQ('#messagebox div.dialogBody :first');dialogInner.find('#messageboxError').remove();dialogInner.append('<p id="messageboxError" class="error_highlight"><span class="exclamation_mark"></span>'+message+'</p>');},insertInner:function(content){var dialogInner=jQ('#messagebox div.dialogBody :first');dialogInner.append(content);},insertBody:function(content){var dialogInner=jQ('#messagebox div.dialogBody');dialogInner.append(content);},getButtonListener:function(id,inputConfig,config){return function(){var input=jQ('#'+id)[0];var params={};if(config.productList){params.quantitylist='';params.skulist='';for(var i=0;i<config.productList.length;i++){if(i>0){params.skulist+='|';params.quantitylist+='|';}
params.skulist+=config.productList[i].sku;params.quantitylist+=config.productList[i].quantity||1;}}
params[input.name]=input.value;if(config.handler){if(config.handler(inputConfig,config)){webshop.messagebox.removeDialog();}}else if(inputConfig.url){if(inputConfig.ajax){params.ajax=true;jQuery.ajax({url:inputConfig.url,data:params,success:function(data,status,xhr){if(data.error){webshop.messagebox.showError(data.message);}else if(data.success){webshop.messagebox.removeDialog();if(inputConfig.messageId){jQ('#'+inputConfig.messageId).html(data.message).show();}
if(config.messageElement){webshop.common.Util.displayAddedMessage(data.message);}
if(inputConfig.success){inputConfig.success(data);}}},error:function(xhr,status,ex){webshop.messagebox.showError("An error has occurred: "+status);}});}else{window.top.location.href=inputConfig.url+(inputConfig.url.indexOf('?')!=-1?'&':'?')+jQuery.param(params);}}else{webshop.messagebox.removeDialog();}
return false;};},loadListContents:function(id,url){jQuery.ajax({url:url,type:'GET',dataType:'html',data:{ajax:true},complete:function(res,status){if(status==="success"||status==="notmodified"){var str=jQuery.trim(res.responseText);if(str.length>0){jQ('#'+id).html(str);}else{var p=jQ('#'+id).parent().parent();p.next('.dialogOr').remove();p.remove();}}}});},getInputField:function(id,config){if(config.listUrl){var result=jQ('<select id="'+id+'" class="'+(config.inputclass||'inputclass')+'" name="'+(config.name||'input')+'"><option value="0">Loading shopping lists...</option></select>');this.loadListContents(id,config.listUrl);return result;}else{return jQ('<input id="'+id+'" type="text" maxlength="100" class="'+(config.inputclass||'inputclass')+'" name="'+(config.name||'input')+'" placeholder="'+config.value+'" />');}},skuListener:function(){return false;},getDialogHeader:function(config){var result=jQ('<div class="'+config.innerClass+'"></div>');var inner=result;inner.append('<h1>'+config.header+'</h1>');if(config.topText){inner.append('<p class="popupAdditionalInfo">'+config.topText+'</p>');}
return result;},getButtonText:function(config){return'<p class="popup'+(config.twoLine||(config.header&&config.text)?'Two':'One')+'Line">'+
(config.header?'<strong>'+config.header+'</strong>':'')+(config.text||'')+'</p>';},createDialog:function(config){config=config||{};this.removeDialog();var dialog=jQ('<div id="messagebox" class="dialog" style="display: hidden">'+'<div class="dialogBody"></div>'+'<div class="dialogFoot">'+'<a href="'+window.top.location+'">close</a>'+'</div>'+'</div>');dialog.find('div.dialogBody').append(this.getDialogHeader(config));if(config.dialogClass){dialog.addClass(config.dialogClass);}
if(config.bodyClass){dialog.find('div.dialogBody').addClass(config.bodyClass);}
var dialogInner=dialog.find('div.dialogBody :first');if(config.dialogOrs){for(var i=0;i<config.dialogOrs.length;i++){if(i>0){dialogInner.append('<p class="dialogOr">Or</p>');}
var or=config.dialogOrs[i];var id=or.id||this.getId();dialogInner.append('<div><form id="'+id+'Form"><label for="'+id+'">'+or.label+'</label><br />'+'<button type="submit" id="'+id+'Button">'+or.button+'</button>'+'</form></div>');dialogInner.find('#'+id+'Button').before(this.getInputField(id,or));dialogInner.find('#'+id+'Form').on('submit',this.getButtonListener(id,or,config));}}
if(config.label){for(var i=0;i<config.label.length;i++){var label=config.label[i];dialogInner.append('<p class="messageBoxLabel">'+label.text+'</p>');}}
if(config.buttons){for(var i=0;i<config.buttons.length;i++){var b=config.buttons[i];var id=b.id||this.getId();var button=jQ('<div><form id="'+id+'Form"><input type="hidden" id="'+id+'" name="'+(b.name||'input')+'" value="'+(b.value||b.button)+'" />'+'<button type="submit" id="'+id+'Button">'+b.button+'</button>'+'</form>'+this.getButtonText(b)+'</div>');button.find('#'+id+'Form').on('submit',this.getButtonListener(id,b,config));dialogInner.append(button);if(b.wide){button.addClass('wideButton');button.find('#'+id+'Button').addClass('wideButton');}}}
if(config.horizontalButtons){var row=jQ('<div></div>');for(var i=0;i<config.horizontalButtons.length;i++){var b=config.horizontalButtons[i];var id=b.id||this.getId();var button=jQ('<form id="'+id+'Form"'+(i<config.horizontalButtons.length-1?' class="formitRight"':'')+'>'+'<input type="hidden" id="'+id+'" name="'+(b.name||'input')+'" value="'+(b.value||b.button)+'" />'+'<button type="submit" id="'+id+'Button">'+b.button+'</button>'+'</form>');button.on('submit',this.getButtonListener(id,b,config));row.append(button);if(b.wide){button.find('#'+id+'Button').addClass('widBigit');}}
dialogInner.append(row);}
if(config.inputs){for(var i=0;i<config.inputs.length;i++){var b=config.inputs[i];var id=b.id||this.getId();dialogInner.append('<div><form id="'+id+'Form">'+'<button type="submit" id="'+id+'Button">'+b.button+'</button>'+'</form></div>');dialogInner.find('#'+id+'Button').before(this.getInputField(id,b));dialogInner.find('#'+id+'Form').on('submit',this.getButtonListener(id,b,config));}}
if(config.bottomText){inner.append('<h6>'+config.bottomText+'</h6>');}
dialog.find('.dialogFoot a').on('click',function(){webshop.messagebox.removeDialog();if(config.onClose){config.onClose();}
return false;});this.showOverlay();jQ('#dialogOverlay').after(dialog);this.resetPosition();jQ('input[type=text]').placeholder();return false;},resetPosition:function(){jQ('#messagebox').position('center').fadeIn(150);},showInputField:function(header,inputs,innerClass){return this.createDialog({dialogClass:'home',innerClass:innerClass,header:header,inputs:inputs});},showButtonList:function(header,buttons,innerClass){return this.createDialog({dialogClass:'home',innerClass:innerClass,header:header,buttons:buttons});},showConfirmButton:function(header,innerClass,cancel,button){return this.createDialog({dialogClass:'home',innerClass:innerClass,header:header,horizontalButtons:[{button:cancel,wide:button.wide},button]});},showAddHoliday:function(id,title,label,options){return this.createDialog({dialogClass:'dialog home',bodyClass:'ORHolidays',innerClass:'ORHolidaysHead',header:title,label:label});},showConfirmCancelChanges:function(urlParams){return this.showConfirmButton('If you cancel now, all the changes made to your order will be lost. Are you sure you want to cancel?','cancelTrolleyChangesPopup popitLeft','No, take me back',{button:'Yes, cancel the changes',wide:true,url:'/webshop/cancelChanges.do'+(urlParams?'?'+urlParams:'')});}};webshop.dialogs=webshop.dialogs||{};webshop.dialogs.OrderConfirmCancelChanges={registerPopup:function(links,urlParams){links.on('click',function(event){event.preventDefault();var popup=webshop.popup.create({wrapperId:'modal-confirmcancel'});var content="<h2>If you cancel now, all the changes made to your order will be lost. Are you sure you want to cancel?</h2>"+"<div class='modal-horizontal-buttons'>"+"<a href='/webshop/getPreviousPage.do' class='widBigit button secondary'>No, take me back</a>"+"<button id='cancel-changes-popup-btn' class='widBigit'>Yes, cancel the changes</button>"+"</div>";popup.container.addClass("modal-wider").append(content).position('center');popup.container.find('.secondary').on('click',function(event){popup.hide(event);});jQ("#cancel-changes-popup-btn").on('click',function(event){window.top.location.href='/webshop/cancelChanges.do'+(urlParams?'?'+urlParams:'');});});}};webshop.popup=_.extend((function($,undefined){var defaultConfig={scope:undefined,onClose:undefined,wrapperId:'bopPopup'};function Popup(config){this.config=$.extend({},defaultConfig,config);this.show=function(){$('body').append(this.overlay,this.container);this.container.position('center').show();};this.bindEvents=function(){var self=this;var hide=function(event){self.hide.call(self,event);};this.close.on('click',null,{method:'Close button click'},hide);this.overlay.on('click',null,{method:'Overlay click'},hide);$(document).on('keyup.'+this.config.wrapperId,null,{method:'ESC keypress'},hide);this.container.mousewheel(function(event){event.preventDefault();});};this.hide=function(event,suppressCallback,manualCallback){event.preventDefault();suppressCallback=suppressCallback||false;if(manualCallback){this.config.onClose=manualCallback;}
if(event.keyCode&&event.keyCode!==27){return;}
this.closePopup(event,suppressCallback);};this.closePopup=function(event,suppressCallback){var self=this;$(document).off('keyup.'+this.config.wrapperId);this.container.remove();this.overlay.fadeOut(200,function(){self.overlay.remove();});if(typeof this.config.onClose==='function'&&!suppressCallback){if(this.config.scope){this.config.onClose.call(this.config.scope,event);}else{this.config.onClose(event);}}};};return{create:function(config){var popup=new Popup(config);popup.container=$('<div id="'+popup.config.wrapperId+'" class="modal"></div>');popup.overlay=$('<div id="dialogOverlay"></div>');popup.close=$('<a class="close" href="#">close</a>');popup.container.append(popup.close);popup.container.on('DOMNodeInserted DOMNodeRemoved',function(){jQ(this).position('center');});popup.container.one('DOMSubtreeModified',function(){jQ(this).position('center');});popup.show();popup.bindEvents();return popup;},bind:function(config){var popup=new Popup(config);popup.container=$('#'+popup.config.wrapperId);popup.overlay=$('#dialogOverlay');popup.close=$('#'+popup.config.wrapperId+' .close');popup.container.on('DOMNodeInserted DOMNodeRemoved',function(){jQ(this).position('center');});popup.container.one('DOMSubtreeModified',function(){jQ(this).position('center');});popup.container.position('center');popup.bindEvents();return popup;}};})(jQuery),webshop.popup);webshop.dialogs=webshop.dialogs||{};webshop.dialogs.ShowConfirmButton={registerPopup:function(links,type,context){links.on('click',function(event){event.preventDefault();var popup=webshop.popup.create({wrapperId:'modal-confirmcancel'});switch(type){case"empty-trolley":var content="<h2>Are you sure you want to empty this trolley?</h2>"+"<div class='modal-horizontal-buttons'>"+"<a href='/webshop/getPreviousPage.do' class='widBigit button secondary'>No, take me back</a>"+"<button id='empty-trolley-popup-btn' class='widBigit'>Yes, empty this trolley</button>"+"</div>";popup.container.addClass("modal-wider").append(content).position('center');jQ("#empty-trolley-popup-btn").on('click',function(){try{var products=[];if(context.viewType()=='picture-view'){products=_(jQ('#smartTrolley').find('ul li').filter(containSku)).groupBy(extractId).reduce(function(result,value,key){var product=_.find(webshop.basket.SmartBasket.getSmartTrolleyModel(),{sku:key});result.push({id:key,quantity:value.length,name:product.name,price:product.price});return result;},[]);}else{products=_(jQ('#smartTrolley').find('ul li').filter(containSku)).map(function(elem){var product=_.find(webshop.basket.SmartBasket.getSmartTrolleyModel(),{sku:elem.id.replace(/^[^_]+_/,'')});return{id:product.sku,name:product.name,price:product.price,quantity:Number(jQ(elem).find('span.quantity').html()||1)};}).value();}
context.eventSender.clearTrolley(products,'Smart Trolley',context.pageType);}catch(e){console.error('Sending event to gtm failed');}
jQ('a.emptyBasket').parent().submit();function containSku(){return this.id.match(/[^_]+_\d+/);}
function extractId(liElem){return liElem.id.replace(/^[^_]+_/,'');}});break;}
popup.container.find('.secondary').on('click',function(event){popup.hide(event);});});},showPopup:function(config,type){var localConfig={wrapperId:'modal-confirmcancel'};if(typeof config==="object"){jQ.extend(localConfig,config);}
var popup=webshop.popup.create(localConfig);switch(type){case"delete-address":var content="<h2>Do you really want to delete this address?</h2>"+"<div class='modal-horizontal-buttons'>"+"<a href='/webshop/getPreviousPage.do' class='widBigit button secondary'>No, take me back</a>"+"<button id='delete-address-popup-btn' class='widBigit'>Yes, delete this address</button>"+"</div>";popup.container.addClass("modal-wider").append(content).position('center');popup.container.find('#delete-address-popup-btn').on('click',function(event){popup.hide(event);});break;}
popup.container.find('.secondary').on('click',function(event){popup.hide(event);});}};jQuery.fn.ratings=function(stars,initialRating){var elements=this;var rateText=[getMessage("review.productPage.star1"),getMessage("review.productPage.star2"),getMessage("review.productPage.star3"),getMessage("review.productPage.star4"),getMessage("review.productPage.star5")];if(!initialRating)
initialRating=0;var showRateTextForStar=function(ratingStar){var textIndex=ratingStar-1;var $rateTextShow=jQ('#ratetextShow');$rateTextShow.removeClass();$rateTextShow.html(rateText[textIndex]);$rateTextShow.addClass('starPos'+textIndex);var $ratingBoxGen=jQ('#ratingsBoxGen');$ratingBoxGen.removeClass();$ratingBoxGen.css("visibility","visible");$ratingBoxGen.addClass('starPointer'+textIndex);var $dropPointerUnder=jQ('#dropPointerUnder');$dropPointerUnder.removeClass();$dropPointerUnder.addClass('starPointer'+textIndex);};return this.each(function(){var $this=jQuery(this);$this.attr('data-rating',initialRating);$this.css('overflow','auto').html('');for(var starRate=1;starRate<stars+1;starRate++){$this.append(jQ('<div data-rating="'+starRate+'" class="jquery-ratings-star"></div>'));}
$this.highlightStars=function(numToHighlight){$this.children().each(function(index,val){if(index<numToHighlight){jQ(val).addClass('jquery-ratings-full');}else{jQ(val).removeClass('jquery-ratings-full');}});};$this.on('mouseenter','div',function(){var rating=jQ(this).attr('data-rating');showRateTextForStar(rating);$this.highlightStars(rating);});$this.on('click','div',function(){var rating=jQ(this).attr('data-rating');$this.attr('data-rating',rating);showRateTextForStar(rating);elements.triggerHandler('ratingchanged',{rating:rating});});$this.on('touchend','div',function(){$star=jQ(this);$star.trigger('click');$star.trigger('mouseenter');});$this.on('mouseleave',function(){$this.highlightStars($this.attr('data-rating'));jQ('#ratingsBoxGen').removeClass().css("visibility","hidden");});$this.highlightStars($this.attr('data-rating'));});};function bindRatingStars(){jQ('#jsRatingDiv').ratings(5,jQ('#overallRating').val()).on('ratingchanged',function(event,data){jQ('#overallRating').val(data.rating);jQ('.dialogRatings .overallReviewRating span.error').remove();});}webshop.analytics=webshop.analytics||{};webshop.analytics.resolution={init:function(){Backbone.Webshop.analytics.mixin.reportResolution();Backbone.Webshop.analytics.mixin.attachResizeHandler();}};(function(webshop){webshop.analytics=webshop.analytics||{};webshop.analytics.header={ui:{topTabItem:'#siteTabs a.hd-topTabs__link',browseMenu:{dropdown:'.browseShop',item:'li > a',},tileDropdown:{container:'.tilesDropdown',navItem:'a.section-link',banner:'a.imgLink',button:'a.button'},seasonalDropdown:{container:'.eventsOverlay',banner:'a.imgLink',button:'a.button'},checkoutBtn:'#basketCheckoutLinkEnabled > a',},init:function(){this._registerEventHandlers();},_trackClickEvent:function(event,url,description,fields){var shouldNavigate=false;var timeoutId=null;if(!event.isDefaultPrevented()){event.preventDefault();shouldNavigate=true;timeoutId=window.setTimeout(function(){window.location=url;},1000);}
Backbone.Webshop.analytics.WebshopAnalytics.reportPageEvent(description,fields).always(function(){if(shouldNavigate){window.clearTimeout(timeoutId);window.location=url;}});},_registerEventHandlers:function(){this._reportBrowseAnalytics();this._reportTopTabsAnalytics();this._reportEventsDropdownAnalytics();this._reportTileDropdownAnalytics();this._reportCheckoutClick();},_reportTopTabsAnalytics:function(){var self=this;jQ(this.ui.topTabItem).on('click',function(event){var currentElement=event.currentTarget;var fields={LINK:jQ(currentElement).attr('href'),TAG:jQ(currentElement).parent().data('name')};if(_.isEmpty(fields.LINK)){return;}
self._trackClickEvent(event,fields.LINK,'Top tab clicked',fields);});},_reportBrowseAnalytics:function(){var self=this;jQ(this.ui.browseMenu.dropdown).on('click',this.ui.browseMenu.item,function(event){var currentElement=event.currentTarget;var url=jQ(currentElement).attr('href');var parentNav=jQ(currentElement).parents('.nav');var level=['baseLevel','levelOne','levelTwo'].findIndex(function(cls){return parentNav.hasClass(cls);});if(_.isEmpty(url)){return;}
self._trackClickEvent(event,url,'Browse shop dropdown clicked',{LEVEL:level,TAG:jQ(currentElement).parent().data('option')||jQ(currentElement).text()});});},_reportTileDropdownAnalytics:function(){var self=this;var clickHandler=function(description){return function(event){var target=jQ(event.currentTarget);var url=target.attr('href');var img=target.find('img');var container=jQ(target).parents(self.ui.tileDropdown.container);self._trackClickEvent(event,url,description,{DROPDOWN_LABEL:container.data('title'),TEXT:img.length>0?img.attr('alt'):target.text(),LINK:url,});};};jQ(this.ui.tileDropdown.container).on('click',this.ui.tileDropdown.navItem,clickHandler('Tiles dropdown navigation item clicked'));jQ(this.ui.tileDropdown.container).on('click',this.ui.tileDropdown.banner,clickHandler('Tiles dropdown banner clicked'));jQ(this.ui.tileDropdown.container).on('click',this.ui.tileDropdown.button,clickHandler('Tiles dropdown bottom button clicked'));},_reportEventsDropdownAnalytics:function(){var self=this;var container=jQ(this.ui.seasonalDropdown.container);var clickHandler=function(event){var url=jQ(event.currentTarget).attr('href');self._trackClickEvent(event,url,'Seasonal banner clicked',{LINK:url});};container.get().forEach(function(element){if(!element.classList.contains('tilesDropdown')){jQ(element).on('click',self.ui.seasonalDropdown.button,clickHandler);jQ(element).on('click',self.ui.seasonalDropdown.banner,clickHandler);}});},_reportCheckoutClick:function(){var self=this;jQ(this.ui.checkoutBtn).on('click',function(event){var currentElement=event.currentTarget;var url=jQ(currentElement).attr('href');var fields={BUTTON_LOC:'DESKTOP_HEADER',};if(_.isEmpty(url)){return;}
self._trackClickEvent(event,url,'Checkout button clicked',fields);});}};}(webshop,jQ));(function(Backbone,_){'use strict';Backbone.Webshop.analytics.resource.PageViewEmbeddedResource=Backbone.Marionette.Object.extend({url:function(){var resourceUrl=_.result(this,'resourceUrl')||noResourceUrlDefined();return'/webshop/wa'+resourceUrl;},initialize:function(){this.pageViewHolder=Backbone.Webshop.analytics.resource.PageViewHolder.getInstance();},saveIfTrackingEnabled:function(dataOrDataSupplier){if(!isTrackingEnabled.call(this)){return;}
var data=_.isFunction(dataOrDataSupplier)?dataOrDataSupplier():dataOrDataSupplier;return Backbone.$.ajax({ajax:true,type:'POST',contentType:'application/json',url:this.url(),data:JSON.stringify(_.assign(data,{pageViewId:this.pageViewHolder.getPageViewId()}))});}});function isTrackingEnabled(){return!_.isUndefined(this.pageViewHolder.getPageViewId());}
function noResourceUrlDefined(){throw new Error('A "resourceUrl" property must be specified.');}})(Backbone,_);(function(Backbone){'use strict';var instance;var PageComponentsResource=Backbone.Webshop.analytics.resource.PageViewEmbeddedResource.extend({resourceUrl:'/pc/'});Backbone.Webshop.analytics.resource.PageComponentsResource={getInstance:function(){if(instance===undefined){instance=new PageComponentsResource();}
return instance;}};})(Backbone);(function(Backbone){'use strict';var instance;var PageEventsResource=Backbone.Webshop.analytics.resource.PageViewEmbeddedResource.extend({resourceUrl:'/pe/'});Backbone.Webshop.analytics.resource.PageEventsResource={getInstance:function(){if(instance===undefined){instance=new PageEventsResource();}
return instance;}};})(Backbone);(function(Backbone){'use strict';var instance;var PageStatisticsResource=Backbone.Webshop.analytics.resource.PageViewEmbeddedResource.extend({resourceUrl:'/ps/'});Backbone.Webshop.analytics.resource.PageStatisticsResource={getInstance:function(){if(instance===undefined){instance=new PageStatisticsResource();}
return instance;}};})(Backbone);(function(Backbone){'use strict';var PageViewHolder=Backbone.Marionette.Object.extend({initialize:function(){this.pageViewId=webshop.common.jsTopBodyVariables.pageViewId;},setPageViewId:function(pageViewId){this.pageViewId=pageViewId;},getPageViewId:function(){return this.pageViewId;}});Backbone.Webshop.analytics.resource.PageViewHolder={getInstance:_.once(function(){return new PageViewHolder();})};})(Backbone);(function(Backbone){'use strict';var PageViewResource=Backbone.Marionette.Object.extend({requestNewPageView:function(pageType,previousPath){if(!Backbone.Webshop.mixins.isBetaFeatureEnabled("ANALYTICS")){return Backbone.$.Deferred().reject();}
return Backbone.$.ajax({ajax:true,type:'POST',contentType:'application/json',url:"/webshop/wa/pv/",data:JSON.stringify({pageType:pageType,previousPath:_.isEmpty(previousPath)?undefined:previousPath})});}});Backbone.Webshop.analytics.resource.PageViewResource={getInstance:_.once(function(){return new PageViewResource();})};})(Backbone);(function(Backbone,_){'use strict';Backbone.Webshop.analytics.WebshopAnalytics={generateNewPageView:function(pageType,previousPath){var pageViewHolder=Backbone.Webshop.analytics.resource.PageViewHolder.getInstance();return Backbone.Webshop.analytics.resource.PageViewResource.getInstance().requestNewPageView(pageType,previousPath).done(function(generatedPageView){pageViewHolder.setPageViewId(generatedPageView.id);Backbone.Webshop.analytics.mixin.reportResolution();}).fail(function(){pageViewHolder.setPageViewId(undefined);});},reportPageComponents:function(pageComponentsDataOrSupplier){return Backbone.Webshop.analytics.resource.PageComponentsResource.getInstance().saveIfTrackingEnabled(pageComponentsDataOrSupplier);},reportPageStatistics:function(pageStatistics){var pageStatisticsDto={fields:pageStatistics};return Backbone.Webshop.analytics.resource.PageStatisticsResource.getInstance().saveIfTrackingEnabled(pageStatisticsDto);},reportPageEvent:function(description,fields){var pageEventDto={description:description,fields:fields};return Backbone.Webshop.analytics.resource.PageEventsResource.getInstance().saveIfTrackingEnabled({pageEvents:[pageEventDto]});},reportPageEventOfType:function(eventType,fields){var pageEventDto={type:eventType,fields:fields};return Backbone.Webshop.analytics.resource.PageEventsResource.getInstance().saveIfTrackingEnabled({pageEvents:[pageEventDto]});},reportFormValidationErrors:function(errors,type){if(Object.keys(errors).length==0){return;}
return Backbone.Webshop.analytics.resource.PageEventsResource.getInstance().saveIfTrackingEnabled({type:type,description:"",fields:errors});},reportLinkClick:function(event,pageEventParams){var peParams=pageEventParams||event.data||{};var peFields=peParams.fields||[];var url=event.currentTarget.getAttribute('href');if(_.isEmpty(url)){return;}
var shouldNavigate=false;var timeoutId=null;if(!event.isDefaultPrevented()){event.preventDefault();shouldNavigate=true;timeoutId=window.setTimeout(function(){window.location=url;},1000);}
var fields={URL:url};if(peParams.length){for(var i=0,len=peFields.length;i<len;i++){fields[peFields[i].name]=peFields[i].value;}}
Backbone.Webshop.analytics.WebshopAnalytics.reportPageEvent(peParams.description||'Link clicked',fields).always(function(){if(shouldNavigate){window.clearTimeout(timeoutId);window.location=url;}});},};Backbone.$(function(){Backbone.$(document).off('click','a.click-tracking',Backbone.Webshop.analytics.WebshopAnalytics.reportLinkClick);Backbone.$(document).on('click','a.click-tracking',Backbone.Webshop.analytics.WebshopAnalytics.reportLinkClick);});})(Backbone,_);(function(Backbone){"use strict";Backbone.Webshop.analytics.mixin.attachResizeHandler=function(){var windowWidth=window.innerWidth;Backbone.$(window).on('resize',_.debounce(function(){if(window.innerWidth==windowWidth){return;}
windowWidth=window.innerWidth;var windowSize={VIEWPORT_HEIGHT:window.innerHeight,VIEWPORT_WIDTH:window.innerWidth};Backbone.Webshop.analytics.WebshopAnalytics.reportPageEvent("Window resize",windowSize);},1000));};})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.analytics.mixin.getPageViewId=function(){return webshop.common.jsTopBodyVariables.pageViewId||webshop.common.jsVariables.get('pageViewId')||'';}})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.analytics.mixin.reportResolution=function(){var devicePixelRatio=window.devicePixelRatio||1;var pageStatistics={DEVICE_PIXEL_RATIO:devicePixelRatio,SCREEN_HEIGHT:screen.height,SCREEN_WIDTH:screen.width,VIEWPORT_HEIGHT:window.innerHeight,VIEWPORT_WIDTH:window.innerWidth};Backbone.Webshop.analytics.WebshopAnalytics.reportPageStatistics(pageStatistics);};})(Backbone);webshop.popup=webshop.popup||{};webshop.popup.LinkAccountPopup={dialog:null,fbuid:null,accessToken:null,signedRequest:null,email:null,token:null,init:function(dialog,email,fbuid,accessToken,signedRequest){webshop.popup.LinkAccountPopup.dialog=dialog;webshop.popup.LinkAccountPopup.fbuid=fbuid;webshop.popup.LinkAccountPopup.accessToken=accessToken;webshop.popup.LinkAccountPopup.signedRequest=signedRequest;webshop.popup.LinkAccountPopup.email=email;webshop.popup.LinkAccountPopup.token=jQ("#linkAccountToken").val();this._registerListeners();jQ("#fbuid").attr('value',fbuid);jQ("#signedRequest").attr('value',signedRequest);},_registerListeners:function(){jQ('#linkAccountForm').on('submit',function(){webshop.popup.LinkAccountPopup._hideAllErrors();var linkPassword=jQ('#password').val();if(linkPassword==null||linkPassword.length==0){webshop.popup.LinkAccountPopup._showError(getMessage("login.linkAccount.missingPassword"));}else if(linkPassword.length<5){webshop.popup.LinkAccountPopup._showError(getMessage("login.linkAccount.passwordToShort"));}else{return true;}
return false;});jQ('#changeFacebookAccount').on('click',function(){FB.logout(function(response){if(document.URL.indexOf("facebookRegistration")!==-1){window.location='https://'+document.domain+application.url+'/quickReg.do';}else{window.location='https://'+document.domain+application.url+'/login.go';}});return false;});},_showError:function(text){jQ('#passwordWarning').show();jQ('#passwordWarningText').text(text);},_hideAllErrors:function(){jQ('#passwordWarning').hide();},_handleLinkAccountResponse:function(data){if(data&&data.captcha_needed){webshop.user.Login.loadCaptchaOverlay('/webshop/getCaptcha.go',jQ("#linkUsername").val());}else if(data&&data.error){webshop.popup.LinkAccountPopup._showError(data.message);}else if(data){webshop.popup.LinkAccountPopup._postRedirect(data);}},_postRedirect:function(data){webshop.ajax.Util.postRedirect(data.loginUrl,{'fbuid':webshop.popup.LinkAccountPopup.fbuid,'accessToken':webshop.popup.LinkAccountPopup.accessToken,'signedRequest':webshop.popup.LinkAccountPopup.signedRequest,'token':webshop.popup.LinkAccountPopup.token});}};webshop.popup=webshop.popup||{};webshop.popup.RemovedNonSeasonalPromotionsPopup={removedPromotionPopup:function(){if(webshop.common.jsVariables.get('removedPromotionsFromBasket')){var popup=webshop.popup.create({wrapperId:'modal-remove-promos'}),content='<h2>'+getMessage('delivery.seasonal.removedPromotion')+'</h2>'+'<button class="button-close">OK</button>';popup.container.addClass("modal-wider").append(content).position({of:jQ(window),my:'bottom'});jQ(".button-close").on('click',function(event){popup.hide(event);});}}};webshop.popup=webshop.popup||{};webshop.popup.notDeliverPopup={template:null,init:function(){if(this.showPopupOnCustomerLogin()){this.create();}
if(this.showPopupOnButtonClick()){this.startHandlingButtonClicks();}},create:function(){var that=this;webshop.popup.create({wrapperId:'notDeliverPopupWrapper'});var $notDeliverPopup=jQ('#notDeliverPopup').clone().removeAttr('id style');jQuery('#notDeliverPopupWrapper').addClass('notDeliverPopup').append($notDeliverPopup);this.popup=webshop.popup.bind({wrapperId:'notDeliverPopupWrapper'});jQ('#notDeliverPopupWrapper a.browse').on('click',function(){that.popup.close.trigger('click');});},showPopupOnCustomerLogin:function(){return jQ('#showOutOfZonePopupOnLogin').length&&jQ('#notDeliverPopup').length;},showPopupOnButtonClick:function(){return jQ('#notDeliverPopup').length;},startHandlingButtonClicks:function(){var that=this;jQ(document.body).on('click','.bookDelivery.button, #basketCheckoutLinkEnabled .button, .welcomeIcons.icVan',function(event){if(!that.validAddressAdded){event.preventDefault();that.create();}});}};var RecaptchaTemplates={};RecaptchaTemplates.VertHtml='<table id="recaptcha_table" class="recaptchatable" > <tr> <td colspan="6" class=\'recaptcha_r1_c1\'></td> </tr> <tr> <td class=\'recaptcha_r2_c1\'></td> <td colspan="4" class=\'recaptcha_image_cell\'><div id="recaptcha_image"></div></td> <td class=\'recaptcha_r2_c2\'></td> </tr> <tr> <td rowspan="6" class=\'recaptcha_r3_c1\'></td> <td colspan="4" class=\'recaptcha_r3_c2\'></td> <td rowspan="6" class=\'recaptcha_r3_c3\'></td> </tr> <tr> <td rowspan="3" class=\'recaptcha_r4_c1\' height="49"> <div class="recaptcha_input_area"> <label for="recaptcha_response_field" class="recaptcha_input_area_text"><span id="recaptcha_instructions_image" class="recaptcha_only_if_image recaptcha_only_if_no_incorrect_sol"></span><span id="recaptcha_instructions_audio" class="recaptcha_only_if_no_incorrect_sol recaptcha_only_if_audio"></span><span id="recaptcha_instructions_error" class="recaptcha_only_if_incorrect_sol"></span></label><br/> <input name="recaptcha_response_field" id="recaptcha_response_field" type="text" autocorrect="off" autocapitalize="off" /> </div> </td> <td rowspan="4" class=\'recaptcha_r4_c2\'></td> <td><a id=\'recaptcha_reload_btn\'><img id=\'recaptcha_reload\' width="25" height="17" /></a></td> <td rowspan="4" class=\'recaptcha_r4_c4\'></td> </tr> <tr> <td><a id=\'recaptcha_switch_audio_btn\' class="recaptcha_only_if_image"><img id=\'recaptcha_switch_audio\' width="25" height="16" alt="" /></a><a id=\'recaptcha_switch_img_btn\' class="recaptcha_only_if_audio"><img id=\'recaptcha_switch_img\' width="25" height="16" alt=""/></a></td> </tr> <tr> <td><a id=\'recaptcha_whatsthis_btn\'><img id=\'recaptcha_whatsthis\' width="25" height="16" /></a></td> </tr> <tr> <td class=\'recaptcha_r7_c1\'></td> <td class=\'recaptcha_r8_c1\'></td> </tr> </table> ';RecaptchaTemplates.CleanCss=".recaptchatable td img{display:block}.recaptchatable .recaptcha_image_cell center img{height:57px}.recaptchatable .recaptcha_image_cell center{height:57px}.recaptchatable .recaptcha_image_cell{background-color:white;height:57px;padding:7px!important}.recaptchatable,#recaptcha_area tr,#recaptcha_area td,#recaptcha_area th{margin:0!important;border:0!important;border-collapse:collapse!important;vertical-align:middle!important}.recaptchatable *{margin:0;padding:0;border:0;color:black;position:static;top:auto;left:auto;right:auto;bottom:auto;text-align:left!important}.recaptchatable #recaptcha_image{margin:auto;border:1px solid #dfdfdf!important}.recaptchatable a img{border:0}.recaptchatable a,.recaptchatable a:hover{outline:none;border:0!important;padding:0!important;text-decoration:none;color:blue;background:none!important;font-weight:normal}.recaptcha_input_area{position:relative!important;background:none!important}.recaptchatable label.recaptcha_input_area_text{border:1px solid #dfdfdf!important;margin:0!important;padding:0!important;position:static!important;top:auto!important;left:auto!important;right:auto!important;bottom:auto!important}.recaptcha_theme_red label.recaptcha_input_area_text,.recaptcha_theme_white label.recaptcha_input_area_text{color:black!important}.recaptcha_theme_blackglass label.recaptcha_input_area_text{color:white!important}.recaptchatable #recaptcha_response_field{font-size:11pt}.recaptcha_theme_blackglass #recaptcha_response_field,.recaptcha_theme_white #recaptcha_response_field{border:1px solid gray}.recaptcha_theme_red #recaptcha_response_field{border:1px solid #cca940}.recaptcha_audio_cant_hear_link{font-size:7pt;color:black}.recaptchatable{line-height:1em;border:1px solid #dfdfdf!important}.recaptcha_error_text{color:red}";RecaptchaTemplates.CleanHtml='<table id="recaptcha_table" class="recaptchatable"> <tr height="73"> <td class=\'recaptcha_image_cell\' width="302"><center><div id="recaptcha_image"></div></center></td> <td style="padding: 10px 7px 7px 7px;"> <a id=\'recaptcha_reload_btn\'><img id=\'recaptcha_reload\' width="25" height="18" alt="" /></a> <a id=\'recaptcha_switch_audio_btn\' class="recaptcha_only_if_image"><img id=\'recaptcha_switch_audio\' width="25" height="15" alt="" /></a><a id=\'recaptcha_switch_img_btn\' class="recaptcha_only_if_audio"><img id=\'recaptcha_switch_img\' width="25" height="15" alt=""/></a> <a id=\'recaptcha_whatsthis_btn\'><img id=\'recaptcha_whatsthis\' width="25" height="16" /></a> </td> <td style="padding: 18px 7px 18px 7px;"> <img id=\'recaptcha_logo\' alt="" width="71" height="36" /> </td> </tr> <tr> <td style="padding-left: 7px;"> <div class="recaptcha_input_area" style="padding-top: 2px; padding-bottom: 7px;"> <input style="border: 1px solid #3c3c3c; width: 302px;" name="recaptcha_response_field" id="recaptcha_response_field" type="text" /> </div> </td> <td></td> <td style="padding: 4px 7px 12px 7px;"> <img id="recaptcha_tagline" width="71" height="17" /> </td> </tr> </table> ';RecaptchaTemplates.ContextHtml='<table id="recaptcha_table" class="recaptchatable"> <tr> <td colspan="6" class=\'recaptcha_r1_c1\'></td> </tr> <tr> <td class=\'recaptcha_r2_c1\'></td> <td colspan="4" class=\'recaptcha_image_cell\'><div id="recaptcha_image"></div></td> <td class=\'recaptcha_r2_c2\'></td> </tr> <tr> <td rowspan="6" class=\'recaptcha_r3_c1\'></td> <td colspan="4" class=\'recaptcha_r3_c2\'></td> <td rowspan="6" class=\'recaptcha_r3_c3\'></td> </tr> <tr> <td rowspan="3" class=\'recaptcha_r4_c1\' height="49"> <div class="recaptcha_input_area"> <label for="recaptcha_response_field" class="recaptcha_input_area_text"><span id="recaptcha_instructions_context" class="recaptcha_only_if_image recaptcha_only_if_no_incorrect_sol"></span><span id="recaptcha_instructions_audio" class="recaptcha_only_if_no_incorrect_sol recaptcha_only_if_audio"></span><span id="recaptcha_instructions_error" class="recaptcha_only_if_incorrect_sol"></span></label><br/> <input name="recaptcha_response_field" id="recaptcha_response_field" type="text" /> </div> </td> <td rowspan="4" class=\'recaptcha_r4_c2\'></td> <td><a id=\'recaptcha_reload_btn\'><img id=\'recaptcha_reload\' width="25" height="17" /></a></td> <td rowspan="4" class=\'recaptcha_r4_c4\'></td> </tr> <tr> <td><a id=\'recaptcha_switch_audio_btn\' class="recaptcha_only_if_image"><img id=\'recaptcha_switch_audio\' width="25" height="16" alt="" /></a><a id=\'recaptcha_switch_img_btn\' class="recaptcha_only_if_audio"><img id=\'recaptcha_switch_img\' width="25" height="16" alt=""/></a></td> </tr> <tr> <td><a id=\'recaptcha_whatsthis_btn\'><img id=\'recaptcha_whatsthis\' width="25" height="16" /></a></td> </tr> <tr> <td class=\'recaptcha_r7_c1\'></td> <td class=\'recaptcha_r8_c1\'></td> </tr> </table> ';RecaptchaTemplates.VertCss=".recaptchatable td img{display:block}.recaptchatable .recaptcha_r1_c1{background:url('IMGROOT/sprite.png') 0 -63px no-repeat;width:318px;height:9px}.recaptchatable .recaptcha_r2_c1{background:url('IMGROOT/sprite.png') -18px 0 no-repeat;width:9px;height:57px}.recaptchatable .recaptcha_r2_c2{background:url('IMGROOT/sprite.png') -27px 0 no-repeat;width:9px;height:57px}.recaptchatable .recaptcha_r3_c1{background:url('IMGROOT/sprite.png') 0 0 no-repeat;width:9px;height:63px}.recaptchatable .recaptcha_r3_c2{background:url('IMGROOT/sprite.png') -18px -57px no-repeat;width:300px;height:6px}.recaptchatable .recaptcha_r3_c3{background:url('IMGROOT/sprite.png') -9px 0 no-repeat;width:9px;height:63px}.recaptchatable .recaptcha_r4_c1{background:url('IMGROOT/sprite.png') -43px 0 no-repeat;width:171px;height:49px}.recaptchatable .recaptcha_r4_c2{background:url('IMGROOT/sprite.png') -36px 0 no-repeat;width:7px;height:57px}.recaptchatable .recaptcha_r4_c4{background:url('IMGROOT/sprite.png') -214px 0 no-repeat;width:97px;height:57px}.recaptchatable .recaptcha_r7_c1{background:url('IMGROOT/sprite.png') -43px -49px no-repeat;width:171px;height:8px}.recaptchatable .recaptcha_r8_c1{background:url('IMGROOT/sprite.png') -43px -49px no-repeat;width:25px;height:8px}.recaptchatable .recaptcha_image_cell center img{height:57px}.recaptchatable .recaptcha_image_cell center{height:57px}.recaptchatable .recaptcha_image_cell{background-color:white;height:57px}#recaptcha_area,#recaptcha_table{width:318px!important}.recaptchatable,#recaptcha_area tr,#recaptcha_area td,#recaptcha_area th{margin:0!important;border:0!important;padding:0!important;border-collapse:collapse!important;vertical-align:middle!important}.recaptchatable *{margin:0;padding:0;border:0;font-family:helvetica,sans-serif;font-size:8pt;color:black;position:static;top:auto;left:auto;right:auto;bottom:auto;text-align:left!important}.recaptchatable #recaptcha_image{margin:auto}.recaptchatable img{border:0!important;margin:0!important;padding:0!important}.recaptchatable a,.recaptchatable a:hover{outline:none;border:0!important;padding:0!important;text-decoration:none;color:blue;background:none!important;font-weight:normal}.recaptcha_input_area{position:relative!important;width:146px!important;height:45px!important;margin-left:20px!important;margin-right:5px!important;margin-top:4px!important;background:none!important}.recaptchatable label.recaptcha_input_area_text{margin:0!important;padding:0!important;position:static!important;top:auto!important;left:auto!important;right:auto!important;bottom:auto!important;background:none!important;height:auto!important;width:auto!important}.recaptcha_theme_red label.recaptcha_input_area_text,.recaptcha_theme_white label.recaptcha_input_area_text{color:black!important}.recaptcha_theme_blackglass label.recaptcha_input_area_text{color:white!important}.recaptchatable #recaptcha_response_field{width:145px!important;position:absolute!important;bottom:7px!important;padding:0!important;margin:0!important;font-size:10pt}.recaptcha_theme_blackglass #recaptcha_response_field,.recaptcha_theme_white #recaptcha_response_field{border:1px solid gray}.recaptcha_theme_red #recaptcha_response_field{border:1px solid #cca940}.recaptcha_audio_cant_hear_link{font-size:7pt;color:black}.recaptchatable{line-height:1em}#recaptcha_instructions_error{color:red!important}";var RecaptchaStr_en={visual_challenge:"Get a visual challenge",audio_challenge:"Get an audio challenge",refresh_btn:"Get a new challenge",instructions_visual:"Type the two words:",instructions_context:"Type the words in the boxes:",instructions_audio:"Type what you hear:",help_btn:"Help",play_again:"Play sound again",cant_hear_this:"Download sound as MP3",incorrect_try_again:"Incorrect. Try again.",image_alt_text:"reCAPTCHA challenge image"},RecaptchaStr_af={visual_challenge:"Kry 'n visuele verifi\u00ebring",audio_challenge:"Kry 'n klankverifi\u00ebring",refresh_btn:"Kry 'n nuwe verifi\u00ebring",instructions_visual:"Tik die twee woorde:",instructions_context:"Tik die woorde in die kassies:",instructions_audio:"Tik wat jy hoor:",help_btn:"Hulp",play_again:"Speel geluid weer",cant_hear_this:"Laai die klank af as MP3",incorrect_try_again:"Verkeerd. Probeer weer.",image_alt_text:"reCAPTCHA-verifieerprent"},RecaptchaStr_am={visual_challenge:"\u12e8\u12a5\u12ed\u1273 \u1270\u130b\u1323\u121a \u12a0\u130d\u129d",audio_challenge:"\u120c\u120b \u12a0\u12f2\u1235 \u12e8\u12f5\u121d\u133d \u1325\u12eb\u1244 \u12ed\u1245\u1228\u1265",refresh_btn:"\u120c\u120b \u12a0\u12f2\u1235 \u1325\u12eb\u1244 \u12ed\u1245\u1228\u1265",instructions_visual:"\u12a5\u1295\u12da\u1205\u1295 \u1201\u1208\u1275 \u1243\u120b\u1275 \u1270\u12ed\u1265 \u1366",instructions_context:"\u1260\u1233\u1325\u1296\u1279 \u12cd\u1235\u1325 \u1243\u120b\u1276\u1279\u1295 \u1270\u12ed\u1265\u1366",instructions_audio:"\u12e8\u121d\u1275\u1230\u121b\u12cd\u1295 \u1270\u12ed\u1265\u1361-",help_btn:"\u12a5\u1308\u12db",play_again:"\u12f5\u121d\u1339\u1295 \u12a5\u1295\u12f0\u1308\u1293 \u12a0\u132b\u12cd\u1275",cant_hear_this:"\u12f5\u121d\u1339\u1295 \u1260MP3 \u1245\u122d\u133d \u12a0\u12cd\u122d\u12f5",incorrect_try_again:"\u1275\u12ad\u12ad\u120d \u12a0\u12ed\u12f0\u1208\u121d\u1362 \u12a5\u1295\u12f0\u1308\u1293 \u121e\u12ad\u122d\u1362",image_alt_text:"reCAPTCHA \u121d\u1235\u120d \u130d\u1320\u121d"},RecaptchaStr_ar={visual_challenge:"\u0627\u0644\u062d\u0635\u0648\u0644 \u0639\u0644\u0649 \u062a\u062d\u062f\u064d \u0645\u0631\u0626\u064a",audio_challenge:"\u0627\u0644\u062d\u0635\u0648\u0644 \u0639\u0644\u0649 \u062a\u062d\u062f\u064d \u0635\u0648\u062a\u064a",refresh_btn:"\u0627\u0644\u062d\u0635\u0648\u0644 \u0639\u0644\u0649 \u062a\u062d\u062f\u064d \u062c\u062f\u064a\u062f",instructions_visual:"\u0627\u0643\u062a\u0628 \u0627\u0644\u0643\u0644\u0645\u062a\u064a\u0646:",instructions_context:"\u0627\u0643\u062a\u0628 \u0627\u0644\u0643\u0644\u0645\u0627\u062a \u0641\u064a \u0627\u0644\u0645\u0631\u0628\u0639\u0627\u062a:",instructions_audio:"\u0627\u0643\u062a\u0628 \u0645\u0627 \u062a\u0633\u0645\u0639\u0647:",help_btn:"\u0645\u0633\u0627\u0639\u062f\u0629",play_again:"\u062a\u0634\u063a\u064a\u0644 \u0627\u0644\u0635\u0648\u062a \u0645\u0631\u0629 \u0623\u062e\u0631\u0649",cant_hear_this:"\u062a\u0646\u0632\u064a\u0644 \u0627\u0644\u0635\u0648\u062a \u0628\u062a\u0646\u0633\u064a\u0642 MP3",incorrect_try_again:"\u063a\u064a\u0631 \u0635\u062d\u064a\u062d. \u0623\u0639\u062f \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629.",image_alt_text:"\u0635\u0648\u0631\u0629 \u0627\u0644\u062a\u062d\u062f\u064a \u0645\u0646 reCAPTCHA"},RecaptchaStr_bg={visual_challenge:"\u041f\u043e\u043b\u0443\u0447\u0430\u0432\u0430\u043d\u0435 \u043d\u0430 \u0432\u0438\u0437\u0443\u0430\u043b\u043d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430",audio_challenge:"\u0417\u0430\u0440\u0435\u0436\u0434\u0430\u043d\u0435 \u043d\u0430 \u0430\u0443\u0434\u0438\u043e\u0442\u0435\u0441\u0442",refresh_btn:"\u0417\u0430\u0440\u0435\u0436\u0434\u0430\u043d\u0435 \u043d\u0430 \u043d\u043e\u0432 \u0442\u0435\u0441\u0442",instructions_visual:"\u0412\u044a\u0432\u0435\u0434\u0435\u0442\u0435 \u0434\u0432\u0435\u0442\u0435 \u0434\u0443\u043c\u0438:",instructions_context:"\u0412\u044a\u0432\u0435\u0434\u0435\u0442\u0435 \u0434\u0443\u043c\u0438\u0442\u0435:",instructions_audio:"\u0412\u044a\u0432\u0435\u0434\u0435\u0442\u0435 \u0447\u0443\u0442\u043e\u0442\u043e:",help_btn:"\u041f\u043e\u043c\u043e\u0449",play_again:"\u041f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u043f\u0443\u0441\u043a\u0430\u043d\u0435 \u043d\u0430 \u0437\u0432\u0443\u043a\u0430",cant_hear_this:"\u0418\u0437\u0442\u0435\u0433\u043b\u044f\u043d\u0435 \u043d\u0430 \u0437\u0432\u0443\u043a\u0430 \u0432\u044a\u0432 \u0444\u043e\u0440\u043c\u0430\u0442 MP3",incorrect_try_again:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u043d\u043e. \u041e\u043f\u0438\u0442\u0430\u0439\u0442\u0435 \u043e\u0442\u043d\u043e\u0432\u043e.",image_alt_text:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430\u0442\u0430 \u0441 reCAPTCHA"},RecaptchaStr_bn={visual_challenge:"\u098f\u0995\u099f\u09bf \u09a6\u09c3\u09b6\u09cd\u09af\u09ae\u09be\u09a8 \u09aa\u09cd\u09b0\u09a4\u09bf\u09a6\u09cd\u09ac\u09a8\u09cd\u09a6\u09cd\u09ac\u09bf\u09a4\u09be \u09aa\u09be\u09a8",audio_challenge:"\u098f\u0995\u099f\u09bf \u0985\u09a1\u09bf\u0993 \u09aa\u09cd\u09b0\u09a4\u09bf\u09a6\u09cd\u09ac\u09a8\u09cd\u09a6\u09cd\u09ac\u09bf\u09a4\u09be  \u09aa\u09be\u09a8",refresh_btn:"\u098f\u0995\u099f\u09bf \u09a8\u09a4\u09c1\u09a8 \u09aa\u09cd\u09b0\u09a4\u09bf\u09a6\u09cd\u09ac\u09a8\u09cd\u09a6\u09cd\u09ac\u09bf\u09a4\u09be  \u09aa\u09be\u09a8",instructions_visual:"\u09b6\u09ac\u09cd\u09a6 \u09a6\u09c1\u099f\u09bf \u09b2\u09bf\u0996\u09c1\u09a8:",instructions_context:"\u09ac\u09be\u0995\u09cd\u09b8\u09c7 \u09b6\u09ac\u09cd\u09a6\u0997\u09c1\u09b2\u09bf \u099f\u09be\u0987\u09aa \u0995\u09b0\u09c1\u09a8:",instructions_audio:"\u0986\u09aa\u09a8\u09bf \u09af\u09be \u09b6\u09c1\u09a8\u099b\u09c7\u09a8 \u09a4\u09be \u09b2\u09bf\u0996\u09c1\u09a8:",help_btn:"\u09b8\u09b9\u09be\u09df\u09a4\u09be",play_again:"\u0986\u09ac\u09be\u09b0 \u09b8\u09be\u0989\u09a8\u09cd\u09a1 \u09aa\u09cd\u09b2\u09c7 \u0995\u09b0\u09c1\u09a8",cant_hear_this:"MP3 \u09b0\u09c2\u09aa\u09c7 \u09b6\u09ac\u09cd\u09a6 \u09a1\u09be\u0989\u09a8\u09b2\u09cb\u09a1 \u0995\u09b0\u09c1\u09a8",incorrect_try_again:"\u09ac\u09c7\u09a0\u09bf\u0995\u09f7 \u0986\u09ac\u09be\u09b0 \u099a\u09c7\u09b7\u09cd\u099f\u09be \u0995\u09b0\u09c1\u09a8\u09f7",image_alt_text:"reCAPTCHA \u099a\u09cd\u09af\u09be\u09b2\u09c7\u099e\u09cd\u099c \u099a\u09bf\u09a4\u09cd\u09b0"},RecaptchaStr_ca={visual_challenge:"Obt\u00e9n un repte visual",audio_challenge:"Obteniu una prova d'\u00e0udio",refresh_btn:"Obteniu una prova nova",instructions_visual:"Escriviu les dues paraules:",instructions_context:"Escriviu les paraules dels quadres:",instructions_audio:"Escriviu el que escolteu:",help_btn:"Ajuda",play_again:"Torna a reproduir el so",cant_hear_this:"Baixa el so com a MP3",incorrect_try_again:"No \u00e9s correcte. Torna-ho a provar.",image_alt_text:"Imatge del repte de reCAPTCHA"},RecaptchaStr_cs={visual_challenge:"Zobrazit vizu\u00e1ln\u00ed podobu v\u00fdrazu",audio_challenge:"P\u0159ehr\u00e1t zvukovou podobu v\u00fdrazu",refresh_btn:"Zobrazit nov\u00fd v\u00fdraz",instructions_visual:"Zadejte dv\u011b slova:",instructions_context:"Zadejte slova uveden\u00e1 v pol\u00edch:",instructions_audio:"Napi\u0161te, co jste sly\u0161eli:",help_btn:"N\u00e1pov\u011bda",play_again:"Znovu p\u0159ehr\u00e1t zvuk",cant_hear_this:"St\u00e1hnout zvuk ve form\u00e1tu MP3",incorrect_try_again:"\u0160patn\u011b. Zkuste to znovu.",image_alt_text:"Obr\u00e1zek reCAPTCHA"},RecaptchaStr_da={visual_challenge:"Hent en visuel udfordring",audio_challenge:"Hent en lydudfordring",refresh_btn:"Hent en ny udfordring",instructions_visual:"Indtast de to ord:",instructions_context:"Indtast ordene i felterne:",instructions_audio:"Indtast det, du h\u00f8rer:",help_btn:"Hj\u00e6lp",play_again:"Afspil lyden igen",cant_hear_this:"Download lyd som MP3",incorrect_try_again:"Forkert. Pr\u00f8v igen.",image_alt_text:"reCAPTCHA-udfordringsbillede"},RecaptchaStr_de={visual_challenge:"Captcha abrufen",audio_challenge:"Audio-Captcha abrufen",refresh_btn:"Neues Captcha abrufen",instructions_visual:"Geben Sie die 2 W\u00f6rter ein:",instructions_context:"Worte aus den Feldern eingeben:",instructions_audio:"Geben Sie das Geh\u00f6rte ein:",help_btn:"Hilfe",play_again:"Wort erneut abspielen",cant_hear_this:"Wort als MP3 herunterladen",incorrect_try_again:"Falsch. Bitte versuchen Sie es erneut.",image_alt_text:"reCAPTCHA-Bild"},RecaptchaStr_el={visual_challenge:"\u039f\u03c0\u03c4\u03b9\u03ba\u03ae \u03c0\u03c1\u03cc\u03ba\u03bb\u03b7\u03c3\u03b7",audio_challenge:"\u0397\u03c7\u03b7\u03c4\u03b9\u03ba\u03ae \u03c0\u03c1\u03cc\u03ba\u03bb\u03b7\u03c3\u03b7",refresh_btn:"\u039d\u03ad\u03b1 \u03c0\u03c1\u03cc\u03ba\u03bb\u03b7\u03c3\u03b7",instructions_visual:"\u03a0\u03bb\u03b7\u03ba\u03c4\u03c1\u03bf\u03bb\u03bf\u03b3\u03ae\u03c3\u03c4\u03b5 \u03c4\u03b9\u03c2 \u03bb\u03ad\u03be\u03b5\u03b9\u03c2:",instructions_context:"\u03a0\u03bb\u03b7\u03ba\u03c4\u03c1\u03bf\u03bb\u03bf\u03b3\u03ae\u03c3\u03c4\u03b5 \u03c4\u03b9\u03c2 \u03bb\u03ad\u03be\u03b5\u03b9\u03c2:",instructions_audio:"\u03a0\u03bb\u03b7\u03ba\u03c4\u03c1\u03bf\u03bb\u03bf\u03b3\u03ae\u03c3\u03c4\u03b5 \u03cc\u03c4\u03b9 \u03b1\u03ba\u03bf\u03cd\u03c4\u03b5:",help_btn:"\u0392\u03bf\u03ae\u03b8\u03b5\u03b9\u03b1",play_again:"\u0391\u03bd\u03b1\u03c0\u03b1\u03c1\u03b1\u03b3\u03c9\u03b3\u03ae \u03ae\u03c7\u03bf\u03c5 \u03be\u03b1\u03bd\u03ac",cant_hear_this:"\u039b\u03ae\u03c8\u03b7 \u03ae\u03c7\u03bf\u03c5 \u03c9\u03c2 \u039c\u03a13",incorrect_try_again:"\u039b\u03ac\u03b8\u03bf\u03c2. \u0394\u03bf\u03ba\u03b9\u03bc\u03ac\u03c3\u03c4\u03b5 \u03be\u03b1\u03bd\u03ac.",image_alt_text:"\u0395\u03b9\u03ba\u03cc\u03bd\u03b1 \u03c0\u03c1\u03cc\u03ba\u03bb\u03b7\u03c3\u03b7\u03c2 reCAPTCHA"},RecaptchaStr_es={visual_challenge:"Obtener una pista visual",audio_challenge:"Obtener una pista sonora",refresh_btn:"Obtener una pista nueva",instructions_visual:"Escribe las dos palabras:",instructions_context:"Escribe las palabras de los cuadros:",instructions_audio:"Escribe lo que oigas:",help_btn:"Ayuda",play_again:"Volver a reproducir el sonido",cant_hear_this:"Descargar el sonido en MP3",incorrect_try_again:"Incorrecto. Vu\u00e9lvelo a intentar.",image_alt_text:"Pista de imagen reCAPTCHA"},RecaptchaStr_es_419={visual_challenge:"Enfrentar un desaf\u00edo visual",audio_challenge:"Enfrentar un desaf\u00edo de audio",refresh_btn:"Enfrentar un nuevo desaf\u00edo",instructions_visual:"Tipea las dos palabras.",instructions_context:"Tipea las palabras en los cuadros",instructions_audio:"Tipea lo que escuchas:",help_btn:"Ayuda",play_again:"Reproducir sonido de nuevo",cant_hear_this:"Descargar sonido en formato MP3",incorrect_try_again:"Incorrecto. Vuelve a intentarlo.",image_alt_text:"Imagen del desaf\u00edo de la reCAPTCHA"},RecaptchaStr_et={visual_challenge:"Kuva kuvap\u00f5hine robotil\u00f5ks",audio_challenge:"Kuva helip\u00f5hine robotil\u00f5ks",refresh_btn:"Kuva uus robotil\u00f5ks",instructions_visual:"Tippige kaks s\u00f5na.",instructions_context:"Tippige kastides olevad s\u00f5nad.",instructions_audio:"Tippige, mida kuulete.",help_btn:"Abi",play_again:"Esita heli uuesti",cant_hear_this:"Laadi heli alla MP3-vormingus",incorrect_try_again:"Vale. Proovige uuesti.",image_alt_text:"reCAPTCHA robotil\u00f5ksu kujutis"},RecaptchaStr_eu={visual_challenge:"Eskuratu ikusizko erronka",audio_challenge:"Eskuratu audio-erronka",refresh_btn:"Eskuratu erronka berria",instructions_visual:"Idatzi bi hitzak:",instructions_context:"Idatzi koadroetako hitzak:",instructions_audio:"Idatzi entzuten duzuna:",help_btn:"Laguntza",play_again:"Erreproduzitu soinua berriro",cant_hear_this:"Deskargatu soinua MP3 gisa",incorrect_try_again:"Ez da zuzena. Saiatu berriro.",image_alt_text:"reCAPTCHA erronkaren irudia"},RecaptchaStr_fa={visual_challenge:"\u062f\u0631\u06cc\u0627\u0641\u062a \u06cc\u06a9 \u0645\u0639\u0645\u0627\u06cc \u062f\u06cc\u062f\u0627\u0631\u06cc",audio_challenge:"\u062f\u0631\u06cc\u0627\u0641\u062a \u06cc\u06a9 \u0645\u0639\u0645\u0627\u06cc \u0635\u0648\u062a\u06cc",refresh_btn:"\u062f\u0631\u06cc\u0627\u0641\u062a \u06cc\u06a9 \u0645\u0639\u0645\u0627\u06cc \u062c\u062f\u06cc\u062f",instructions_visual:"\u0627\u06cc\u0646 \u062f\u0648 \u06a9\u0644\u0645\u0647 \u0631\u0627 \u062a\u0627\u06cc\u067e \u06a9\u0646\u06cc\u062f:",instructions_context:"\u0648\u0627\u0698\u0647 \u0647\u0627\u06cc \u0645\u0648\u062c\u0648\u062f \u062f\u0631 \u06a9\u0627\u062f\u0631\u0647\u0627 \u0631\u0627 \u062a\u0627\u06cc\u067e \u06a9\u0646\u06cc\u062f:",instructions_audio:"\u0622\u0646\u0686\u0647 \u0631\u0627 \u06a9\u0647 \u0645\u06cc \u0634\u0646\u0648\u06cc\u062f \u062a\u0627\u06cc\u067e \u06a9\u0646\u06cc\u062f:",help_btn:"\u0631\u0627\u0647\u0646\u0645\u0627\u06cc\u06cc",play_again:"\u067e\u062e\u0634 \u0645\u062c\u062f\u062f \u0635\u062f\u0627",cant_hear_this:"\u062f\u0627\u0646\u0644\u0648\u062f \u0635\u062f\u0627 \u0628\u0647 \u0635\u0648\u0631\u062a MP3",incorrect_try_again:"\u0646\u0627\u062f\u0631\u0633\u062a. \u062f\u0648\u0628\u0627\u0631\u0647 \u0627\u0645\u062a\u062d\u0627\u0646 \u06a9\u0646\u06cc\u062f.",image_alt_text:""},RecaptchaStr_fi={visual_challenge:"Kuvavahvistus",audio_challenge:"\u00c4\u00e4nivahvistus",refresh_btn:"Uusi kuva",instructions_visual:"Kirjoita n\u00e4kem\u00e4si kaksi sanaa:",instructions_context:"Kirjoita n\u00e4kem\u00e4si sanat:",instructions_audio:"Kirjoita kuulemasi:",help_btn:"Ohje",play_again:"Toista \u00e4\u00e4ni uudelleen",cant_hear_this:"Lataa \u00e4\u00e4ni MP3-tiedostona",incorrect_try_again:"V\u00e4\u00e4rin. Yrit\u00e4 uudelleen.",image_alt_text:"reCAPTCHA-kuva"},RecaptchaStr_fil={visual_challenge:"Kumuha ng pagsubok na visual",audio_challenge:"Kumuha ng pagsubok na audio",refresh_btn:"Kumuha ng bagong pagsubok",instructions_visual:"I-type ang dalawang mga salita:",instructions_context:"I-type ang mga salita sa mga kahon:",instructions_audio:"I-type ang iyong narinig",help_btn:"Tulong",play_again:"I-play muli ang tunog",cant_hear_this:"I-download ang tunog bilang MP3",incorrect_try_again:"Hindi wasto. Muling subukan.",image_alt_text:"larawang panghamon ng reCAPTCHA"},RecaptchaStr_fr={visual_challenge:"Test visuel",audio_challenge:"Test audio",refresh_btn:"Nouveau test",instructions_visual:"Saisissez les deux mots :",instructions_context:"Saisissez les mots ci-dessus :",instructions_audio:"Qu'entendez-vous ?",help_btn:"Aide",play_again:"R\u00e9\u00e9couter",cant_hear_this:"T\u00e9l\u00e9charger l'audio au format MP3",incorrect_try_again:"Incorrect. Veuillez r\u00e9essayer.",image_alt_text:"Image reCAPTCHA"},RecaptchaStr_fr_ca={visual_challenge:"Obtenir un test visuel",audio_challenge:"Obtenir un test audio",refresh_btn:"Obtenir un nouveau test",instructions_visual:"Saisissez les deux mots :",instructions_context:"Tapez les mots dans les bo\u00eetes de texte\u00a0:",instructions_audio:"Qu'entendez-vous?",help_btn:"Aide",play_again:"Jouer le son de nouveau",cant_hear_this:"T\u00e9l\u00e9charger le son en format MP3",incorrect_try_again:"Erreur, essayez \u00e0 nouveau",image_alt_text:"Image reCAPTCHA"},RecaptchaStr_gl={visual_challenge:"Obter unha proba visual",audio_challenge:"Obter unha proba de audio",refresh_btn:"Obter unha proba nova",instructions_visual:"Escribe as d\u00faas palabras:",instructions_context:"Escribe as palabras nas caixas:",instructions_audio:"Escribe o que escoitas:",help_btn:"Axuda",play_again:"Reproducir o son de novo",cant_hear_this:"Descargar son como MP3",incorrect_try_again:"Incorrecto. T\u00e9ntao de novo.",image_alt_text:"Imaxe de proba de reCAPTCHA"},RecaptchaStr_gu={visual_challenge:"\u0a8f\u0a95 \u0aa6\u0ac3\u0ab6\u0acd\u0aaf\u0abe\u0aa4\u0acd\u0aae\u0a95 \u0aaa\u0aa1\u0a95\u0abe\u0ab0 \u0aae\u0ac7\u0ab3\u0ab5\u0acb",audio_challenge:"\u0a8f\u0a95 \u0a91\u0aa1\u0abf\u0a93 \u0aaa\u0aa1\u0a95\u0abe\u0ab0 \u0aae\u0ac7\u0ab3\u0ab5\u0acb",refresh_btn:"\u0a8f\u0a95 \u0aa8\u0ab5\u0acb \u0aaa\u0aa1\u0a95\u0abe\u0ab0 \u0aae\u0ac7\u0ab3\u0ab5\u0acb",instructions_visual:"\u0aac\u0ac7 \u0ab6\u0aac\u0acd\u0aa6 \u0ab2\u0a96\u0acb:",instructions_context:"\u0aac\u0ac9\u0a95\u0acd\u0ab8\u0aae\u0abe\u0a82 \u0ab6\u0aac\u0acd\u0aa6\u0acb \u0ab2\u0a96\u0acb:",instructions_audio:"\u0aa4\u0aae\u0ac7 \u0a9c\u0ac7 \u0ab8\u0abe\u0a82\u0aad\u0ab3\u0acb \u0a9b\u0acb \u0aa4\u0ac7 \u0ab2\u0a96\u0acb:",help_btn:"\u0ab8\u0ab9\u0abe\u0aaf",play_again:"\u0aa7\u0acd\u0ab5\u0aa8\u0abf \u0aab\u0ab0\u0ac0\u0aa5\u0ac0 \u0a9a\u0ab2\u0abe\u0ab5\u0acb",cant_hear_this:"MP3 \u0aa4\u0ab0\u0ac0\u0a95\u0ac7 \u0aa7\u0acd\u0ab5\u0aa8\u0abf\u0aa8\u0ac7 \u0aa1\u0abe\u0a89\u0aa8\u0ab2\u0acb\u0aa1 \u0a95\u0ab0\u0acb",incorrect_try_again:"\u0a96\u0acb\u0a9f\u0ac1\u0a82. \u0aab\u0ab0\u0ac0 \u0aaa\u0acd\u0ab0\u0aaf\u0abe\u0ab8 \u0a95\u0ab0\u0acb.",image_alt_text:"reCAPTCHA \u0aaa\u0aa1\u0a95\u0abe\u0ab0 \u0a9b\u0aac\u0ac0"},RecaptchaStr_hi={visual_challenge:"\u0915\u094b\u0908 \u0935\u093f\u091c\u0941\u0905\u0932 \u091a\u0941\u0928\u094c\u0924\u0940 \u0932\u0947\u0902",audio_challenge:"\u0915\u094b\u0908 \u0911\u0921\u093f\u092f\u094b \u091a\u0941\u0928\u094c\u0924\u0940 \u0932\u0947\u0902",refresh_btn:"\u0915\u094b\u0908 \u0928\u0908 \u091a\u0941\u0928\u094c\u0924\u0940 \u0932\u0947\u0902",instructions_visual:"\u0926\u094b \u0936\u092c\u094d\u200d\u0926 \u0932\u093f\u0916\u0947\u0902:",instructions_context:"\u0936\u092c\u094d\u200d\u0926\u094b\u0902 \u0915\u094b \u092c\u0949\u0915\u094d\u200d\u0938 \u092e\u0947\u0902 \u0932\u093f\u0916\u0947\u0902:",instructions_audio:"\u091c\u094b \u0906\u092a \u0938\u0941\u0928 \u0930\u0939\u0947 \u0939\u0948\u0902 \u0909\u0938\u0947 \u0932\u093f\u0916\u0947\u0902:",help_btn:"\u0938\u0939\u093e\u092f\u0924\u093e",play_again:"\u0927\u094d\u200d\u0935\u0928\u093f \u092a\u0941\u0928: \u091a\u0932\u093e\u090f\u0902",cant_hear_this:"\u0927\u094d\u200d\u0935\u0928\u093f \u0915\u094b MP3 \u0915\u0947 \u0930\u0942\u092a \u092e\u0947\u0902 \u0921\u093e\u0909\u0928\u0932\u094b\u0921 \u0915\u0930\u0947\u0902",incorrect_try_again:"\u0917\u0932\u0924. \u092a\u0941\u0928: \u092a\u094d\u0930\u092f\u093e\u0938 \u0915\u0930\u0947\u0902.",image_alt_text:"reCAPTCHA \u091a\u0941\u0928\u094c\u0924\u0940 \u091b\u0935\u093f"},RecaptchaStr_hr={visual_challenge:"Dohvati vizualni upit",audio_challenge:"Dohvati zvu\u010dni upit",refresh_btn:"Dohvati novi upit",instructions_visual:"Upi\u0161ite obje rije\u010di:",instructions_context:"Upi\u0161ite rije\u010di u okvire:",instructions_audio:"Upi\u0161ite \u0161to \u010dujete:",help_btn:"Pomo\u0107",play_again:"Ponovi zvuk",cant_hear_this:"Preuzmi zvuk u MP3 formatu",incorrect_try_again:"Nije to\u010dno. Poku\u0161ajte ponovno.",image_alt_text:"Slikovni izazov reCAPTCHA"},RecaptchaStr_hu={visual_challenge:"Vizu\u00e1lis kih\u00edv\u00e1s k\u00e9r\u00e9se",audio_challenge:"Hangkih\u00edv\u00e1s k\u00e9r\u00e9se",refresh_btn:"\u00daj kih\u00edv\u00e1s k\u00e9r\u00e9se",instructions_visual:"Adja meg a k\u00e9t sz\u00f3t:",instructions_context:"\u00cdrja be a szavakat a mez\u0151kbe:",instructions_audio:"\u00cdrja le, amit hall:",help_btn:"S\u00fag\u00f3",play_again:"Hang ism\u00e9telt lej\u00e1tsz\u00e1sa",cant_hear_this:"Hang let\u00f6lt\u00e9se MP3 form\u00e1tumban",incorrect_try_again:"Hib\u00e1s. Pr\u00f3b\u00e1lkozzon \u00fajra.",image_alt_text:"reCAPTCHA ellen\u0151rz\u0151 k\u00e9p"},RecaptchaStr_hy={visual_challenge:"\u054d\u057f\u0561\u0576\u0561\u056c \u057f\u0565\u057d\u0578\u0572\u0561\u056f\u0561\u0576 \u056d\u0576\u0564\u056b\u0580",audio_challenge:"\u054d\u057f\u0561\u0576\u0561\u056c \u0571\u0561\u0575\u0576\u0561\u0575\u056b\u0576 \u056d\u0576\u0564\u056b\u0580",refresh_btn:"\u054d\u057f\u0561\u0576\u0561\u056c \u0576\u0578\u0580 \u056d\u0576\u0564\u056b\u0580",instructions_visual:"\u0544\u0578\u0582\u057f\u0584\u0561\u0563\u0580\u0565\u0584 \u0561\u0575\u057d \u0565\u0580\u056f\u0578\u0582 \u0562\u0561\u057c\u0565\u0580\u0568\u055d",instructions_context:"\u0544\u0578\u0582\u057f\u0584\u0561\u0563\u0580\u0565\u0584 \u0562\u0561\u057c\u0565\u0580\u0568 \u057f\u0578\u0582\u0583\u0565\u0580\u0578\u0582\u0574\u055d",instructions_audio:"\u0544\u0578\u0582\u057f\u0584\u0561\u0563\u0580\u0565\u0584 \u0561\u0575\u0576, \u056b\u0576\u0579 \u056c\u057d\u0578\u0582\u0574 \u0565\u0584\u055d",help_btn:"\u0555\u0563\u0576\u0578\u0582\u0569\u0575\u0578\u0582\u0576",play_again:"\u0546\u057e\u0561\u0563\u0561\u0580\u056f\u0565\u056c \u0571\u0561\u0575\u0576\u0568 \u056f\u0580\u056f\u056b\u0576",cant_hear_this:"\u0532\u0565\u057c\u0576\u0565\u056c \u0571\u0561\u0575\u0576\u0568 \u0578\u0580\u057a\u0565\u057d MP3",incorrect_try_again:"\u054d\u056d\u0561\u056c \u0567: \u0553\u0578\u0580\u0571\u0565\u0584 \u056f\u0580\u056f\u056b\u0576:",image_alt_text:""},RecaptchaStr_id={visual_challenge:"Dapatkan kata pengujian berbentuk visual",audio_challenge:"Dapatkan kata pengujian berbentuk audio",refresh_btn:"Dapatkan kata pengujian baru",instructions_visual:"Ketik dua kata ini:",instructions_context:"Ketik kata di dalam kotak:",instructions_audio:"Ketik yang Anda dengar:",help_btn:"Bantuan",play_again:"Putar suara sekali lagi",cant_hear_this:"Unduh suara sebagai MP3",incorrect_try_again:"Salah. Coba lagi.",image_alt_text:"Gambar tantangan reCAPTCHA"},RecaptchaStr_is={visual_challenge:"F\u00e1 a\u00f0gangspr\u00f3f sem mynd",audio_challenge:"F\u00e1 hlj\u00f3\u00f0pr\u00f3f",refresh_btn:"F\u00e1 n\u00fdtt a\u00f0gangspr\u00f3f",instructions_visual:"Sl\u00e1\u00f0u inn \u00feessi tv\u00f6 or\u00f0:",instructions_context:"Sl\u00e1\u00f0u or\u00f0in inn \u00ed reitina:",instructions_audio:"Sl\u00e1\u00f0u inn \u00fea\u00f0 sem \u00fe\u00fa heyrir:",help_btn:"Hj\u00e1lp",play_again:"Spila hlj\u00f3\u00f0 aftur",cant_hear_this:"S\u00e6kja hlj\u00f3\u00f0 sem MP3",incorrect_try_again:"Rangt. Reyndu aftur.",image_alt_text:"mynd reCAPTCHA a\u00f0gangspr\u00f3fs"},RecaptchaStr_it={visual_challenge:"Verifica visiva",audio_challenge:"Verifica audio",refresh_btn:"Nuova verifica",instructions_visual:"Digita le due parole:",instructions_context:"Digita le parole nelle caselle:",instructions_audio:"Digita ci\u00f2 che senti:",help_btn:"Guida",play_again:"Riproduci di nuovo audio",cant_hear_this:"Scarica audio in MP3",incorrect_try_again:"Sbagliato. Riprova.",image_alt_text:"Immagine di verifica reCAPTCHA"},RecaptchaStr_iw={visual_challenge:"\u05e7\u05d1\u05dc \u05d0\u05ea\u05d2\u05e8 \u05d7\u05d6\u05d5\u05ea\u05d9",audio_challenge:"\u05e7\u05d1\u05dc \u05d0\u05ea\u05d2\u05e8 \u05e9\u05de\u05e2",refresh_btn:"\u05e7\u05d1\u05dc \u05d0\u05ea\u05d2\u05e8 \u05d7\u05d3\u05e9",instructions_visual:"\u05d4\u05e7\u05dc\u05d3 \u05d0\u05ea \u05e9\u05ea\u05d9 \u05d4\u05de\u05d9\u05dc\u05d9\u05dd:",instructions_context:"\u05d4\u05e7\u05dc\u05d3 \u05d0\u05ea \u05d4\u05de\u05d9\u05dc\u05d9\u05dd \u05d1\u05ea\u05d9\u05d1\u05d5\u05ea:",instructions_audio:"\u05d4\u05e7\u05dc\u05d3 \u05d0\u05ea \u05de\u05d4 \u05e9\u05d0\u05ea\u05d4 \u05e9\u05d5\u05de\u05e2:",help_btn:"\u05e2\u05d6\u05e8\u05d4",play_again:"\u05d4\u05e4\u05e2\u05dc \u05e9\u05d5\u05d1 \u05d0\u05ea \u05d4\u05e9\u05de\u05e2",cant_hear_this:"\u05d4\u05d5\u05e8\u05d3 \u05e9\u05de\u05e2 \u05db-3MP",incorrect_try_again:"\u05e9\u05d2\u05d5\u05d9. \u05e0\u05e1\u05d4 \u05e9\u05d5\u05d1.",image_alt_text:"\u05ea\u05de\u05d5\u05e0\u05ea \u05d0\u05ea\u05d2\u05e8 \u05e9\u05dc reCAPTCHA"},RecaptchaStr_ja={visual_challenge:"\u753b\u50cf\u3067\u78ba\u8a8d\u3057\u307e\u3059",audio_challenge:"\u97f3\u58f0\u3067\u78ba\u8a8d\u3057\u307e\u3059",refresh_btn:"\u5225\u306e\u5358\u8a9e\u3067\u3084\u308a\u76f4\u3057\u307e\u3059",instructions_visual:"2 \u3064\u306e\u5358\u8a9e\u3092\u5165\u529b\u3057\u307e\u3059:",instructions_context:"\u30dc\u30c3\u30af\u30b9\u5185\u306e\u5358\u8a9e\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044:",instructions_audio:"\u805e\u3053\u3048\u305f\u5358\u8a9e\u3092\u5165\u529b\u3057\u307e\u3059:",help_btn:"\u30d8\u30eb\u30d7",play_again:"\u3082\u3046\u4e00\u5ea6\u805e\u304f",cant_hear_this:"MP3 \u3067\u97f3\u58f0\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9",incorrect_try_again:"\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002\u3082\u3046\u4e00\u5ea6\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002",image_alt_text:"reCAPTCHA \u78ba\u8a8d\u7528\u753b\u50cf"},RecaptchaStr_kn={visual_challenge:"\u0ca6\u0cc3\u0cb6\u0ccd\u0caf \u0cb8\u0cb5\u0cbe\u0cb2\u0cca\u0c82\u0ca6\u0ca8\u0ccd\u0ca8\u0cc1 \u0cb8\u0ccd\u0cb5\u0cc0\u0c95\u0cb0\u0cbf\u0cb8\u0cbf",audio_challenge:"\u0c86\u0ca1\u0cbf\u0caf\u0ccb \u0cb8\u0cb5\u0cbe\u0cb2\u0cca\u0c82\u0ca6\u0ca8\u0ccd\u0ca8\u0cc1 \u0cb8\u0ccd\u0cb5\u0cc0\u0c95\u0cb0\u0cbf\u0cb8\u0cbf",refresh_btn:"\u0cb9\u0cca\u0cb8 \u0cb8\u0cb5\u0cbe\u0cb2\u0cca\u0c82\u0ca6\u0ca8\u0ccd\u0ca8\u0cc1 \u0caa\u0ca1\u0cc6\u0caf\u0cbf\u0cb0\u0cbf",instructions_visual:"\u0c8e\u0cb0\u0ca1\u0cc1 \u0caa\u0ca6\u0c97\u0cb3\u0ca8\u0ccd\u0ca8\u0cc1 \u0c9f\u0cc8\u0caa\u0ccd \u0cae\u0cbe\u0ca1\u0cbf:",instructions_context:"\u0cac\u0cbe\u0c95\u0ccd\u0cb8\u0ccd\u200c\u0ca8\u0cb2\u0ccd\u0cb2\u0cbf \u0caa\u0ca6\u0c97\u0cb3\u0ca8\u0ccd\u0ca8\u0cc1 \u0c9f\u0cc8\u0caa\u0ccd\u200c \u0cae\u0cbe\u0ca1\u0cbf:",instructions_audio:"\u0ca8\u0cbf\u0cae\u0c97\u0cc6 \u0c95\u0cc7\u0cb3\u0cbf\u0cb8\u0cc1\u0cb5\u0cc1\u0ca6\u0ca8\u0ccd\u0ca8\u0cc1 \u0c9f\u0cc8\u0caa\u0ccd\u200c \u0cae\u0cbe\u0ca1\u0cbf:",help_btn:"\u0cb8\u0cb9\u0cbe\u0caf",play_again:"\u0ca7\u0ccd\u0cb5\u0ca8\u0cbf\u0caf\u0ca8\u0ccd\u0ca8\u0cc1 \u0cae\u0ca4\u0ccd\u0ca4\u0cc6 \u0caa\u0ccd\u0cb2\u0cc7 \u0cae\u0cbe\u0ca1\u0cbf",cant_hear_this:"\u0ca7\u0ccd\u0cb5\u0ca8\u0cbf\u0caf\u0ca8\u0ccd\u0ca8\u0cc1 MP3 \u0cb0\u0cc2\u0caa\u0ca6\u0cb2\u0ccd\u0cb2\u0cbf \u0ca1\u0ccc\u0ca8\u0ccd\u200c\u0cb2\u0ccb\u0ca1\u0ccd \u0cae\u0cbe\u0ca1\u0cbf",incorrect_try_again:"\u0ca4\u0caa\u0ccd\u0caa\u0cbe\u0c97\u0cbf\u0ca6\u0cc6. \u0cae\u0ca4\u0ccd\u0ca4\u0cca\u0cae\u0ccd\u0cae\u0cc6 \u0caa\u0ccd\u0cb0\u0caf\u0ca4\u0ccd\u0ca8\u0cbf\u0cb8\u0cbf.",image_alt_text:"reCAPTCHA \u0cb8\u0cb5\u0cbe\u0cb2\u0cc1 \u0c9a\u0cbf\u0ca4\u0ccd\u0cb0"},RecaptchaStr_ko={visual_challenge:"\uadf8\ub9bc\uc73c\ub85c \ubcf4\uc548\ubb38\uc790 \ubc1b\uae30",audio_challenge:"\uc74c\uc131\uc73c\ub85c \ubcf4\uc548\ubb38\uc790 \ubc1b\uae30",refresh_btn:"\ubcf4\uc548\ubb38\uc790 \uc0c8\ub85c \ubc1b\uae30",instructions_visual:"\ub450 \ub2e8\uc5b4 \uc785\ub825:",instructions_context:"\uc785\ub825\ub780\uc5d0 \ub2e8\uc5b4 \uc785\ub825:",instructions_audio:"\uc74c\uc131 \ubcf4\uc548\ubb38\uc790 \uc785\ub825:",help_btn:"\ub3c4\uc6c0\ub9d0",play_again:"\uc74c\uc131 \ub2e4\uc2dc \ub4e3\uae30",cant_hear_this:"\uc74c\uc131\uc744 MP3\ub85c \ub2e4\uc6b4\ub85c\ub4dc",incorrect_try_again:"\ud2c0\ub838\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574 \uc8fc\uc138\uc694.",image_alt_text:"reCAPTCHA \uc694\uccad \uc774\ubbf8\uc9c0"},RecaptchaStr_lt={visual_challenge:"Gauti vaizdin\u012f atpa\u017einimo test\u0105",audio_challenge:"Gauti garso atpa\u017einimo test\u0105",refresh_btn:"Gauti nauj\u0105 atpa\u017einimo test\u0105",instructions_visual:"\u012eveskite du \u017eod\u017eius:",instructions_context:"\u012eveskite \u017eod\u017eius laukeliuose:",instructions_audio:"\u012eveskite tai, k\u0105 girdite:",help_btn:"Pagalba",play_again:"Dar kart\u0105 paleisti gars\u0105",cant_hear_this:"Atsisi\u0173sti gars\u0105 kaip MP3",incorrect_try_again:"Neteisingai. Bandykite dar kart\u0105.",image_alt_text:"Testo \u201ereCAPTCHA\u201c vaizdas"},RecaptchaStr_lv={visual_challenge:"Sa\u0146emt vizu\u0101lu izaicin\u0101jumu",audio_challenge:"Sa\u0146emt audio izaicin\u0101jumu",refresh_btn:"Sa\u0146emt jaunu izaicin\u0101jumu",instructions_visual:"Ierakstiet divus v\u0101rdus:",instructions_context:"Ierakstiet v\u0101rdus lodzi\u0146os:",instructions_audio:"Ierakstiet dzirdamo:",help_btn:"Pal\u012bdz\u012bba",play_again:"V\u0113lreiz atska\u0146ot ska\u0146u",cant_hear_this:"Lejupiel\u0101d\u0113t ska\u0146u MP3\u00a0form\u0101t\u0101",incorrect_try_again:"Nepareizi. M\u0113\u0123iniet v\u0113lreiz.",image_alt_text:"reCAPTCHA izaicin\u0101juma att\u0113ls"},RecaptchaStr_ml={visual_challenge:"\u0d12\u0d30\u0d41 \u0d26\u0d43\u0d36\u0d4d\u0d2f \u0d1a\u0d32\u0d1e\u0d4d\u0d1a\u0d4d \u0d28\u0d47\u0d1f\u0d41\u0d15",audio_challenge:"\u0d12\u0d30\u0d41 \u0d13\u0d21\u0d3f\u0d2f\u0d4b \u0d1a\u0d32\u0d1e\u0d4d\u0d1a\u0d4d \u0d28\u0d47\u0d1f\u0d41\u0d15",refresh_btn:"\u0d12\u0d30\u0d41 \u0d2a\u0d41\u0d24\u0d3f\u0d2f \u0d1a\u0d32\u0d1e\u0d4d\u0d1a\u0d4d \u0d28\u0d47\u0d1f\u0d41\u0d15",instructions_visual:"\u0d30\u0d23\u0d4d\u0d1f\u0d4d \u0d2a\u0d26\u0d19\u0d4d\u0d19\u0d7e \u0d1f\u0d48\u0d2a\u0d4d\u0d2a\u0d4d \u0d1a\u0d46\u0d2f\u0d4d\u0d2f\u0d41\u0d15:",instructions_context:"\u0d2c\u0d4b\u0d15\u0d4d\u200c\u0d38\u0d41\u0d15\u0d33\u0d3f\u0d32\u0d46 \u0d2a\u0d26\u0d19\u0d4d\u0d19\u0d7e \u0d1f\u0d48\u0d2a\u0d4d\u0d2a\u0d41\u0d1a\u0d46\u0d2f\u0d4d\u0d2f\u0d41\u0d15:",instructions_audio:"\u0d15\u0d47\u0d7e\u0d15\u0d4d\u0d15\u0d41\u0d28\u0d4d\u0d28\u0d24\u0d4d \u0d1f\u0d48\u0d2a\u0d4d\u0d2a\u0d4d \u0d1a\u0d46\u0d2f\u0d4d\u0d2f\u0d42:",help_btn:"\u0d38\u0d39\u0d3e\u0d2f\u0d02",play_again:"\u0d36\u0d2c\u0d4d\u200c\u0d26\u0d02 \u0d35\u0d40\u0d23\u0d4d\u0d1f\u0d41\u0d02 \u0d2a\u0d4d\u0d32\u0d47 \u0d1a\u0d46\u0d2f\u0d4d\u0d2f\u0d41\u0d15",cant_hear_this:"\u0d36\u0d2c\u0d4d\u200c\u0d26\u0d02 MP3 \u0d06\u0d2f\u0d3f \u0d21\u0d57\u0d7a\u0d32\u0d4b\u0d21\u0d4d \u0d1a\u0d46\u0d2f\u0d4d\u0d2f\u0d41\u0d15",incorrect_try_again:"\u0d24\u0d46\u0d31\u0d4d\u0d31\u0d3e\u0d23\u0d4d. \u0d35\u0d40\u0d23\u0d4d\u0d1f\u0d41\u0d02 \u0d36\u0d4d\u0d30\u0d2e\u0d3f\u0d15\u0d4d\u0d15\u0d41\u0d15.",image_alt_text:"reCAPTCHA \u0d1a\u0d32\u0d1e\u0d4d\u0d1a\u0d4d \u0d07\u0d2e\u0d47\u0d1c\u0d4d"},RecaptchaStr_mr={visual_challenge:"\u0926\u0943\u0936\u094d\u200d\u092f\u092e\u093e\u0928 \u0906\u0935\u094d\u0939\u093e\u0928 \u092a\u094d\u0930\u093e\u092a\u094d\u0924 \u0915\u0930\u093e",audio_challenge:"\u0911\u0921\u0940\u0913 \u0906\u0935\u094d\u0939\u093e\u0928 \u092a\u094d\u0930\u093e\u092a\u094d\u0924 \u0915\u0930\u093e",refresh_btn:"\u090f\u0915 \u0928\u0935\u0940\u0928 \u0906\u0935\u094d\u0939\u093e\u0928 \u092a\u094d\u0930\u093e\u092a\u094d\u0924 \u0915\u0930\u093e",instructions_visual:"\u0926\u094b\u0928 \u0936\u092c\u094d\u0926 \u091f\u093e\u0907\u092a \u0915\u0930\u093e:",instructions_context:"\u092c\u0949\u0915\u094d\u200d\u0938\u0947\u0938\u092e\u0927\u0940\u0932 \u0936\u092c\u094d\u200d\u0926 \u091f\u093e\u0907\u092a \u0915\u0930\u093e:",instructions_audio:"\u0906\u092a\u0932\u094d\u092f\u093e\u0932\u093e \u091c\u0947 \u0910\u0915\u0942 \u092f\u0947\u0908\u0932 \u0924\u0947 \u091f\u093e\u0907\u092a \u0915\u0930\u093e:",help_btn:"\u092e\u0926\u0924",play_again:"\u0927\u094d\u200d\u0935\u0928\u0940 \u092a\u0941\u0928\u094d\u0939\u093e \u092a\u094d\u200d\u0932\u0947 \u0915\u0930\u093e",cant_hear_this:"MP3 \u0930\u0941\u092a\u093e\u0924 \u0927\u094d\u200d\u0935\u0928\u0940 \u0921\u093e\u0909\u0928\u0932\u094b\u0921 \u0915\u0930\u093e",incorrect_try_again:"\u0905\u092f\u094b\u0917\u094d\u200d\u092f. \u092a\u0941\u0928\u094d\u200d\u0939\u093e \u092a\u094d\u0930\u092f\u0924\u094d\u200d\u0928 \u0915\u0930\u093e.",image_alt_text:"reCAPTCHA \u0906\u0935\u094d\u200d\u0939\u093e\u0928 \u092a\u094d\u0930\u0924\u093f\u092e\u093e"},RecaptchaStr_ms={visual_challenge:"Dapatkan cabaran visual",audio_challenge:"Dapatkan cabaran audio",refresh_btn:"Dapatkan cabaran baru",instructions_visual:"Taip kedua-dua perkataan:",instructions_context:"Taip perkataan dalam kotak:",instructions_audio:"Taip apa yang didengari:",help_btn:"Bantuan",play_again:"Mainkan bunyi sekali lagi",cant_hear_this:"Muat turun bunyi sebagai MP3",incorrect_try_again:"Tidak betul. Cuba lagi.",image_alt_text:"Imej cabaran reCAPTCHA"},RecaptchaStr_nl={visual_challenge:"Een visuele uitdaging proberen",audio_challenge:"Een audio-uitdaging proberen",refresh_btn:"Een nieuwe uitdaging proberen",instructions_visual:"Typ de twee woorden:",instructions_context:"Typ de woorden in de vakken:",instructions_audio:"Typ wat u hoort:",help_btn:"Help",play_again:"Geluid opnieuw afspelen",cant_hear_this:"Geluid downloaden als MP3",incorrect_try_again:"Onjuist. Probeer het opnieuw.",image_alt_text:"reCAPTCHA-uitdagingsafbeelding"},RecaptchaStr_no={visual_challenge:"F\u00e5 en bildeutfordring",audio_challenge:"F\u00e5 en lydutfordring",refresh_btn:"F\u00e5 en ny utfordring",instructions_visual:"Skriv inn de to ordene:",instructions_context:"Skriv inn ordene i feltene:",instructions_audio:"Skriv inn det du h\u00f8rer:",help_btn:"Hjelp",play_again:"Spill av lyd p\u00e5 nytt",cant_hear_this:"Last ned lyd som MP3",incorrect_try_again:"Feil. Pr\u00f8v p\u00e5 nytt.",image_alt_text:"reCAPTCHA-utfordringsbilde"},RecaptchaStr_pl={visual_challenge:"Poka\u017c podpowied\u017a wizualn\u0105",audio_challenge:"Odtw\u00f3rz podpowied\u017a d\u017awi\u0119kow\u0105",refresh_btn:"Nowa podpowied\u017a",instructions_visual:"Wpisz oba wyrazy:",instructions_context:"Wpisz s\u0142owa wy\u015bwietlane w polach:",instructions_audio:"Wpisz us\u0142yszane s\u0142owa:",help_btn:"Pomoc",play_again:"Odtw\u00f3rz d\u017awi\u0119k ponownie",cant_hear_this:"Pobierz d\u017awi\u0119k jako plik MP3",incorrect_try_again:"Nieprawid\u0142owo. Spr\u00f3buj ponownie.",image_alt_text:"Zadanie obrazkowe reCAPTCHA"},RecaptchaStr_pt={visual_challenge:"Obter um desafio visual",audio_challenge:"Obter um desafio de \u00e1udio",refresh_btn:"Obter um novo desafio",instructions_visual:"Digite as duas palavras:",instructions_context:"Digite as palavras das caixas:",instructions_audio:"Digite o que voc\u00ea ouve:",help_btn:"Ajuda",play_again:"Reproduzir som novamente",cant_hear_this:"Fazer download do som no formato MP3",incorrect_try_again:"Incorreto. Tente novamente.",image_alt_text:"Imagem de desafio reCAPTCHA"},RecaptchaStr_pt_pt={visual_challenge:"Obter um desafio visual",audio_challenge:"Obter um desafio de \u00e1udio",refresh_btn:"Obter um novo desafio",instructions_visual:"Escreva as duas palavras:",instructions_context:"Escreva as palavras nas caixas:",instructions_audio:"Escreva o que ouvir:",help_btn:"Ajuda",play_again:"Reproduzir som novamente",cant_hear_this:"Transferir som como MP3",incorrect_try_again:"Incorreto. Tente novamente.",image_alt_text:"Imagem de desafio reCAPTCHA"},RecaptchaStr_ro={visual_challenge:"Ob\u0163ine\u0163i un cod captcha vizual",audio_challenge:"Ob\u0163ine\u0163i un cod captcha audio",refresh_btn:"Ob\u0163ine\u0163i un nou cod captcha",instructions_visual:"Introduce\u0163i cele dou\u0103 cuvinte:",instructions_context:"Introduce\u0163i cuvintele \u00een casete:",instructions_audio:"Introduce\u0163i ceea ce auzi\u0163i:",help_btn:"Ajutor",play_again:"Reda\u0163i sunetul din nou",cant_hear_this:"Desc\u0103rca\u0163i fi\u015fierul audio ca MP3",incorrect_try_again:"Incorect. \u00cencerca\u0163i din nou.",image_alt_text:"Imagine de verificare reCAPTCHA"},RecaptchaStr_ru={visual_challenge:"\u0412\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u0430\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430",audio_challenge:"\u0417\u0432\u0443\u043a\u043e\u0432\u0430\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430",refresh_btn:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c",instructions_visual:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u043e, \u0447\u0442\u043e \u0432\u0438\u0434\u0438\u0442\u0435:",instructions_context:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043b\u043e\u0432\u0430:",instructions_audio:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u043e, \u0447\u0442\u043e \u0441\u043b\u044b\u0448\u0438\u0442\u0435:",help_btn:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430",play_again:"\u041f\u0440\u043e\u0441\u043b\u0443\u0448\u0430\u0442\u044c \u0435\u0449\u0435 \u0440\u0430\u0437",cant_hear_this:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c MP3-\u0444\u0430\u0439\u043b",incorrect_try_again:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e. \u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u043e\u043f\u044b\u0442\u043a\u0443.",image_alt_text:"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e \u0441\u043b\u043e\u0432\u0443 reCAPTCHA"},RecaptchaStr_sk={visual_challenge:"Zobrazi\u0165 vizu\u00e1lnu podobu",audio_challenge:"Prehra\u0165 zvukov\u00fa podobu",refresh_btn:"Zobrazi\u0165 nov\u00fd v\u00fdraz",instructions_visual:"Zadajte tieto dve slov\u00e1:",instructions_context:"Zadajte slov\u00e1 v poliach:",instructions_audio:"Zadajte, \u010do po\u010dujete:",help_btn:"Pomocn\u00edk",play_again:"Znova prehra\u0165 zvuk",cant_hear_this:"Prevzia\u0165 zvuk v podobe s\u00faboru MP3",incorrect_try_again:"Nespr\u00e1vne. Sk\u00faste to znova.",image_alt_text:"Obr\u00e1zok zadania reCAPTCHA"},RecaptchaStr_sl={visual_challenge:"Vizualni preskus",audio_challenge:"Zvo\u010dni preskus",refresh_btn:"Nov preskus",instructions_visual:"Vnesite besedi:",instructions_context:"Vnesite besede v okvir\u010dkih:",instructions_audio:"Natipkajte, kaj sli\u0161ite:",help_btn:"Pomo\u010d",play_again:"Znova predvajaj zvok",cant_hear_this:"Prenesi zvok kot MP3",incorrect_try_again:"Napa\u010dno. Poskusite znova.",image_alt_text:"Slika izziva reCAPTCHA"},RecaptchaStr_sr={visual_challenge:"\u041f\u0440\u0438\u043c\u0438\u0442\u0435 \u0432\u0438\u0437\u0443\u0435\u043b\u043d\u0438 \u0443\u043f\u0438\u0442",audio_challenge:"\u041f\u0440\u0438\u043c\u0438\u0442\u0435 \u0430\u0443\u0434\u0438\u043e \u0443\u043f\u0438\u0442",refresh_btn:"\u041f\u0440\u0438\u043c\u0438\u0442\u0435 \u043d\u043e\u0432\u0438 \u0443\u043f\u0438\u0442",instructions_visual:"\u041e\u0442\u043a\u0443\u0446\u0430\u0458\u0442\u0435 \u0434\u0432\u0435 \u0440\u0435\u0447\u0438:",instructions_context:"\u0423\u043a\u0443\u0446\u0430\u0458\u0442\u0435 \u0440\u0435\u0447\u0438 \u0443 \u043f\u043e\u0459\u0430:",instructions_audio:"\u041e\u0442\u043a\u0443\u0446\u0430\u0458\u0442\u0435 \u043e\u043d\u043e \u0448\u0442\u043e \u0447\u0443\u0458\u0435\u0442\u0435:",help_btn:"\u041f\u043e\u043c\u043e\u045b",play_again:"\u041f\u043e\u043d\u043e\u0432\u043e \u043f\u0443\u0441\u0442\u0438 \u0437\u0432\u0443\u043a",cant_hear_this:"\u041f\u0440\u0435\u0443\u0437\u043c\u0438 \u0437\u0432\u0443\u043a \u043a\u0430\u043e MP3 \u0441\u043d\u0438\u043c\u0430\u043a",incorrect_try_again:"\u041d\u0435\u0442\u0430\u0447\u043d\u043e. \u041f\u043e\u043a\u0443\u0448\u0430\u0458\u0442\u0435 \u043f\u043e\u043d\u043e\u0432\u043e.",image_alt_text:"\u0421\u043b\u0438\u043a\u0430 reCAPTCHA \u043f\u0440\u043e\u0432\u0435\u0440\u0435"},RecaptchaStr_sv={visual_challenge:"H\u00e4mta captcha i bildformat",audio_challenge:"H\u00e4mta captcha i ljudformat",refresh_btn:"H\u00e4mta ny captcha",instructions_visual:"Skriv b\u00e5da orden:",instructions_context:"Skriv orden i rutorna:",instructions_audio:"Skriv det du h\u00f6r:",help_btn:"Hj\u00e4lp",play_again:"Spela upp ljudet igen",cant_hear_this:"H\u00e4mta ljud som MP3",incorrect_try_again:"Fel. F\u00f6rs\u00f6k igen.",image_alt_text:"reCAPTCHA-bild"},RecaptchaStr_sw={visual_challenge:"Pata changamoto ya kuona",audio_challenge:"Pata changamoto ya sauti",refresh_btn:"Pata changamoto mpya",instructions_visual:"Charaza maneno mawili:",instructions_context:"Charaza maneno katika masanduku:",instructions_audio:"Charaza unachosikia:",help_btn:"Msaada",play_again:"Cheza sauti tena",cant_hear_this:"Pakua sauti kama MP3",incorrect_try_again:"Sio sahihi. Jaribu tena.",image_alt_text:"picha ya changamoto ya reCAPTCHA"},RecaptchaStr_ta={visual_challenge:"\u0baa\u0bbe\u0bb0\u0bcd\u0bb5\u0bc8 \u0b9a\u0bc7\u0bb2\u0b9e\u0bcd\u0b9a\u0bc8\u0baa\u0bcd \u0baa\u0bc6\u0bb1\u0bc1\u0b95",audio_challenge:"\u0b86\u0b9f\u0bbf\u0baf\u0bcb \u0b9a\u0bc7\u0bb2\u0b9e\u0bcd\u0b9a\u0bc8\u0baa\u0bcd \u0baa\u0bc6\u0bb1\u0bc1\u0b95",refresh_btn:"\u0baa\u0bc1\u0ba4\u0bbf\u0baf \u0b9a\u0bc7\u0bb2\u0b9e\u0bcd\u0b9a\u0bc8\u0baa\u0bcd \u0baa\u0bc6\u0bb1\u0bc1\u0b95",instructions_visual:"\u0b9a\u0bca\u0bb1\u0bcd\u0b95\u0bb3\u0bc8 \u0b9f\u0bc8\u0baa\u0bcd \u0b9a\u0bc6\u0baf\u0bcd\u0b95:",instructions_context:"\u0baa\u0bc6\u0b9f\u0bcd\u0b9f\u0bbf\u0baf\u0bbf\u0bb2\u0bcd \u0b89\u0bb3\u0bcd\u0bb3 \u0b9a\u0bca\u0bb1\u0bcd\u0b95\u0bb3\u0bc8 \u0b89\u0bb3\u0bcd\u0bb3\u0bbf\u0b9f\u0bc1\u0b95:",instructions_audio:"\u0b95\u0bc7\u0b9f\u0bcd\u0baa\u0ba4\u0bc8 \u0b9f\u0bc8\u0baa\u0bcd \u0b9a\u0bc6\u0baf\u0bcd\u0b95:",help_btn:"\u0b89\u0ba4\u0bb5\u0bbf",play_again:"\u0b92\u0bb2\u0bbf\u0baf\u0bc8 \u0bae\u0bc0\u0ba3\u0bcd\u0b9f\u0bc1\u0bae\u0bcd \u0b87\u0baf\u0b95\u0bcd\u0b95\u0bc1",cant_hear_this:"\u0b92\u0bb2\u0bbf\u0baf\u0bc8 MP3 \u0b86\u0b95 \u0baa\u0ba4\u0bbf\u0bb5\u0bbf\u0bb1\u0b95\u0bcd\u0b95\u0bc1\u0b95",incorrect_try_again:"\u0ba4\u0bb5\u0bb1\u0bbe\u0ba9\u0ba4\u0bc1. \u0bae\u0bc0\u0ba3\u0bcd\u0b9f\u0bc1\u0bae\u0bcd \u0bae\u0bc1\u0baf\u0bb2\u0bb5\u0bc1\u0bae\u0bcd.",image_alt_text:"reCAPTCHA \u0b9a\u0bc7\u0bb2\u0b9e\u0bcd\u0b9a\u0bcd \u0baa\u0b9f\u0bae\u0bcd"},RecaptchaStr_te={visual_challenge:"\u0c12\u0c15 \u0c26\u0c43\u0c36\u0c4d\u0c2f\u0c2e\u0c3e\u0c28 \u0c38\u0c35\u0c3e\u0c32\u0c41\u0c28\u0c41 \u0c38\u0c4d\u0c35\u0c40\u0c15\u0c30\u0c3f\u0c02\u0c1a\u0c02\u0c21\u0c3f",audio_challenge:"\u0c12\u0c15 \u0c06\u0c21\u0c3f\u0c2f\u0c4b \u0c38\u0c35\u0c3e\u0c32\u0c41\u0c28\u0c41 \u0c38\u0c4d\u0c35\u0c40\u0c15\u0c30\u0c3f\u0c02\u0c1a\u0c02\u0c21\u0c3f",refresh_btn:"\u0c15\u0c4d\u0c30\u0c4a\u0c24\u0c4d\u0c24 \u0c38\u0c35\u0c3e\u0c32\u0c41\u0c28\u0c41 \u0c38\u0c4d\u0c35\u0c40\u0c15\u0c30\u0c3f\u0c02\u0c1a\u0c02\u0c21\u0c3f",instructions_visual:"\u0c30\u0c46\u0c02\u0c21\u0c41 \u0c2a\u0c26\u0c3e\u0c32\u0c28\u0c41 \u0c1f\u0c48\u0c2a\u0c4d \u0c1a\u0c47\u0c2f\u0c02\u0c21\u0c3f:",instructions_context:"\u0c2a\u0c26\u0c3e\u0c32\u0c28\u0c41 \u0c2a\u0c46\u0c1f\u0c4d\u0c1f\u0c46\u0c32\u0c4d\u0c32\u0c4b \u0c1f\u0c48\u0c2a\u0c4d \u0c1a\u0c47\u0c2f\u0c02\u0c21\u0c3f:",instructions_audio:"\u0c2e\u0c40\u0c30\u0c41 \u0c35\u0c3f\u0c28\u0c4d\u0c28\u0c26\u0c3f \u0c1f\u0c48\u0c2a\u0c4d \u0c1a\u0c47\u0c2f\u0c02\u0c21\u0c3f:",help_btn:"\u0c38\u0c39\u0c3e\u0c2f\u0c02",play_again:"\u0c27\u0c4d\u0c35\u0c28\u0c3f\u0c28\u0c3f \u0c2e\u0c33\u0c4d\u0c32\u0c40 \u0c2a\u0c4d\u0c32\u0c47 \u0c1a\u0c47\u0c2f\u0c3f",cant_hear_this:"\u0c27\u0c4d\u0c35\u0c28\u0c3f\u0c28\u0c3f MP3 \u0c35\u0c32\u0c46 \u0c21\u0c4c\u0c28\u0c4d\u200c\u0c32\u0c4b\u0c21\u0c4d \u0c1a\u0c47\u0c2f\u0c3f",incorrect_try_again:"\u0c24\u0c2a\u0c4d\u0c2a\u0c41. \u0c2e\u0c33\u0c4d\u0c32\u0c40 \u0c2a\u0c4d\u0c30\u0c2f\u0c24\u0c4d\u0c28\u0c3f\u0c02\u0c1a\u0c02\u0c21\u0c3f.",image_alt_text:"reCAPTCHA \u0c38\u0c35\u0c3e\u0c32\u0c41 \u0c1a\u0c3f\u0c24\u0c4d\u0c30\u0c02"},RecaptchaStr_th={visual_challenge:"\u0e23\u0e31\u0e1a\u0e04\u0e27\u0e32\u0e21\u0e17\u0e49\u0e32\u0e17\u0e32\u0e22\u0e14\u0e49\u0e32\u0e19\u0e20\u0e32\u0e1e",audio_challenge:"\u0e23\u0e31\u0e1a\u0e04\u0e27\u0e32\u0e21\u0e17\u0e49\u0e32\u0e17\u0e32\u0e22\u0e14\u0e49\u0e32\u0e19\u0e40\u0e2a\u0e35\u0e22\u0e07",refresh_btn:"\u0e23\u0e31\u0e1a\u0e04\u0e27\u0e32\u0e21\u0e17\u0e49\u0e32\u0e17\u0e32\u0e22\u0e43\u0e2b\u0e21\u0e48",instructions_visual:"\u0e1e\u0e34\u0e21\u0e1e\u0e4c\u0e04\u0e33\u0e2a\u0e2d\u0e07\u0e04\u0e33\u0e19\u0e31\u0e49\u0e19:",instructions_context:"\u0e1e\u0e34\u0e21\u0e1e\u0e4c\u0e04\u0e33\u0e19\u0e31\u0e49\u0e19\u0e43\u0e19\u0e0a\u0e48\u0e2d\u0e07\u0e19\u0e35\u0e49:",instructions_audio:"\u0e1e\u0e34\u0e21\u0e1e\u0e4c\u0e2a\u0e34\u0e48\u0e07\u0e17\u0e35\u0e48\u0e04\u0e38\u0e13\u0e44\u0e14\u0e49\u0e22\u0e34\u0e19:",help_btn:"\u0e04\u0e27\u0e32\u0e21\u0e0a\u0e48\u0e27\u0e22\u0e40\u0e2b\u0e25\u0e37\u0e2d",play_again:"\u0e40\u0e25\u0e48\u0e19\u0e40\u0e2a\u0e35\u0e22\u0e07\u0e2d\u0e35\u0e01\u0e04\u0e23\u0e31\u0e49\u0e07",cant_hear_this:"\u0e14\u0e32\u0e27\u0e42\u0e2b\u0e25\u0e14\u0e40\u0e2a\u0e35\u0e22\u0e07\u0e40\u0e1b\u0e47\u0e19 MP3",incorrect_try_again:"\u0e44\u0e21\u0e48\u0e16\u0e39\u0e01\u0e15\u0e49\u0e2d\u0e07 \u0e25\u0e2d\u0e07\u0e2d\u0e35\u0e01\u0e04\u0e23\u0e31\u0e49\u0e07",image_alt_text:"\u0e23\u0e2b\u0e31\u0e2a\u0e20\u0e32\u0e1e reCAPTCHA"},RecaptchaStr_tr={visual_challenge:"G\u00f6rsel sorgu al",audio_challenge:"Sesli sorgu al",refresh_btn:"Yeniden y\u00fckle",instructions_visual:"\u0130ki kelimeyi yaz\u0131n:",instructions_context:"Kutudaki kelimeleri yaz\u0131n:",instructions_audio:"Duydu\u011funuzu yaz\u0131n:",help_btn:"Yard\u0131m",play_again:"Sesi tekrar \u00e7al",cant_hear_this:"Sesi MP3 olarak indir",incorrect_try_again:"Yanl\u0131\u015f. Tekrar deneyin.",image_alt_text:"reCAPTCHA sorusu resmi"},RecaptchaStr_uk={visual_challenge:"\u041e\u0442\u0440\u0438\u043c\u0430\u0442\u0438 \u0432\u0456\u0437\u0443\u0430\u043b\u044c\u043d\u0438\u0439 \u0442\u0435\u043a\u0441\u0442",audio_challenge:"\u041e\u0442\u0440\u0438\u043c\u0430\u0442\u0438 \u0430\u0443\u0434\u0456\u043e\u0437\u0430\u043f\u0438\u0441",refresh_btn:"\u041e\u043d\u043e\u0432\u0438\u0442\u0438 \u0442\u0435\u043a\u0441\u0442",instructions_visual:"\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u0434\u0432\u0430 \u0441\u043b\u043e\u0432\u0430:",instructions_context:"\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u0441\u043b\u043e\u0432\u0430 \u0432 \u043f\u043e\u043b\u044f:",instructions_audio:"\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u043f\u043e\u0447\u0443\u0442\u0435:",help_btn:"\u0414\u043e\u0432\u0456\u0434\u043a\u0430",play_again:"\u0412\u0456\u0434\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u0437\u0430\u043f\u0438\u0441 \u0449\u0435 \u0440\u0430\u0437",cant_hear_this:"\u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0438\u0442\u0438 \u0437\u0430\u043f\u0438\u0441 \u044f\u043a MP3",incorrect_try_again:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e. \u0421\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0449\u0435 \u0440\u0430\u0437.",image_alt_text:"\u0417\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u043d\u044f \u0437\u0430\u0432\u0434\u0430\u043d\u043d\u044f reCAPTCHA"},RecaptchaStr_ur={visual_challenge:"\u0627\u06cc\u06a9 \u0645\u0631\u0626\u06cc \u0686\u06cc\u0644\u0646\u062c \u062d\u0627\u0635\u0644 \u06a9\u0631\u06cc\u06ba",audio_challenge:"\u0627\u06cc\u06a9 \u0622\u0688\u06cc\u0648 \u0686\u06cc\u0644\u0646\u062c \u062d\u0627\u0635\u0644 \u06a9\u0631\u06cc\u06ba",refresh_btn:"\u0627\u06cc\u06a9 \u0646\u06cc\u0627 \u0686\u06cc\u0644\u0646\u062c \u062d\u0627\u0635\u0644 \u06a9\u0631\u06cc\u06ba",instructions_visual:"\u062f\u0648 \u0627\u0644\u0641\u0627\u0638 \u0679\u0627\u0626\u067e \u06a9\u0631\u06cc\u06ba:",instructions_context:"\u0627\u0644\u0641\u0627\u0638 \u06a9\u0648 \u062e\u0627\u0646\u0648\u06ba \u0645\u06cc\u06ba \u0679\u0627\u0626\u067e \u06a9\u0631\u06cc\u06ba:",instructions_audio:"\u0622\u067e \u06a9\u0648 \u062c\u0648 \u0633\u0646\u0627\u0626\u06cc \u062f\u06cc\u062a\u0627 \u06c1\u06d2 \u0627\u0633\u06d2 \u0679\u0627\u0626\u067e \u06a9\u0631\u06cc\u06ba:",help_btn:"\u0645\u062f\u062f",play_again:"\u0622\u0648\u0627\u0632 \u062f\u0648\u0628\u0627\u0631\u06c1 \u0686\u0644\u0627\u0626\u06cc\u06ba",cant_hear_this:"\u0622\u0648\u0627\u0632 \u06a9\u0648 MP3 \u06a9\u06d2 \u0628\u0637\u0648\u0631 \u0688\u0627\u0624\u0646 \u0644\u0648\u0688 \u06a9\u0631\u06cc\u06ba",incorrect_try_again:"\u063a\u0644\u0637\u06d4 \u062f\u0648\u0628\u0627\u0631\u06c1 \u06a9\u0648\u0634\u0634 \u06a9\u0631\u06cc\u06ba\u06d4",image_alt_text:"reCAPTCHA \u0686\u06cc\u0644\u0646\u062c \u0648\u0627\u0644\u06cc \u0634\u0628\u06cc\u06c1"},RecaptchaStr_vi={visual_challenge:"Nh\u1eadn th\u1eed th\u00e1ch h\u00ecnh \u1ea3nh",audio_challenge:"Nh\u1eadn th\u1eed th\u00e1ch \u00e2m thanh",refresh_btn:"Nh\u1eadn th\u1eed th\u00e1ch m\u1edbi",instructions_visual:"Nh\u1eadp hai t\u1eeb:",instructions_context:"Nh\u1eadp c\u00e1c t\u1eeb trong c\u00e1c \u00f4:",instructions_audio:"Nh\u1eadp n\u1ed9i dung b\u1ea1n nghe th\u1ea5y:",help_btn:"Tr\u1ee3 gi\u00fap",play_again:"Ph\u00e1t l\u1ea1i \u00e2m thanh",cant_hear_this:"T\u1ea3i \u00e2m thanh xu\u1ed1ng d\u01b0\u1edbi d\u1ea1ng MP3",incorrect_try_again:"Kh\u00f4ng ch\u00ednh x\u00e1c. H\u00e3y th\u1eed l\u1ea1i.",image_alt_text:"H\u00ecnh x\u00e1c th\u1ef1c reCAPTCHA"},RecaptchaStr_zh_cn={visual_challenge:"\u6536\u5230\u4e00\u4e2a\u89c6\u9891\u9080\u8bf7",audio_challenge:"\u6362\u4e00\u7ec4\u97f3\u9891\u9a8c\u8bc1\u7801",refresh_btn:"\u6362\u4e00\u7ec4\u9a8c\u8bc1\u7801",instructions_visual:"\u8bf7\u952e\u5165\u8fd9\u4e24\u4e2a\u8bcd\uff1a",instructions_context:"\u952e\u5165\u6846\u4e2d\u663e\u793a\u7684\u5b57\u8bcd\uff1a",instructions_audio:"\u8bf7\u952e\u5165\u60a8\u542c\u5230\u7684\u5185\u5bb9\uff1a",help_btn:"\u5e2e\u52a9",play_again:"\u91cd\u65b0\u64ad\u653e",cant_hear_this:"\u4ee5 MP3 \u683c\u5f0f\u4e0b\u8f7d\u58f0\u97f3",incorrect_try_again:"\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u8bd5\u3002",image_alt_text:"reCAPTCHA \u9a8c\u8bc1\u56fe\u7247"},RecaptchaStr_zh_hk={visual_challenge:"\u56de\u7b54\u5716\u50cf\u9a57\u8b49\u554f\u984c",audio_challenge:"\u53d6\u5f97\u8a9e\u97f3\u9a57\u8b49\u554f\u984c",refresh_btn:"\u63db\u4e00\u500b\u9a57\u8b49\u554f\u984c",instructions_visual:"\u8acb\u8f38\u5165\u9019\u5169\u500b\u5b57\uff1a",instructions_context:"\u5728\u6846\u5167\u8f38\u5165\u5b57\u8a5e\uff1a",instructions_audio:"\u9375\u5165\u60a8\u6240\u807d\u5230\u7684\uff1a",help_btn:"\u8aaa\u660e",play_again:"\u518d\u6b21\u64ad\u653e\u8072\u97f3",cant_hear_this:"\u5c07\u8072\u97f3\u4e0b\u8f09\u70ba MP3",incorrect_try_again:"\u4e0d\u6b63\u78ba\uff0c\u518d\u8a66\u4e00\u6b21\u3002",image_alt_text:"reCAPTCHA \u9a57\u8b49\u6587\u5b57\u5716\u7247"},RecaptchaStr_zh_tw={visual_challenge:"\u53d6\u5f97\u5716\u7247\u9a57\u8b49\u554f\u984c",audio_challenge:"\u53d6\u5f97\u8a9e\u97f3\u9a57\u8b49\u554f\u984c",refresh_btn:"\u53d6\u5f97\u65b0\u7684\u9a57\u8b49\u554f\u984c",instructions_visual:"\u8acb\u8f38\u5165\u4e0b\u5716\u4e2d\u7684\u5169\u500b\u5b57\uff1a",instructions_context:"\u8acb\u8f38\u5165\u65b9\u584a\u4e2d\u7684\u6587\u5b57\uff1a",instructions_audio:"\u8acb\u8f38\u5165\u8a9e\u97f3\u5167\u5bb9\uff1a",help_btn:"\u8aaa\u660e",play_again:"\u518d\u6b21\u64ad\u653e",cant_hear_this:"\u4ee5 MP3 \u683c\u5f0f\u4e0b\u8f09\u8072\u97f3",incorrect_try_again:"\u9a57\u8b49\u78bc\u6709\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\u3002",image_alt_text:"reCAPTCHA \u9a57\u8b49\u6587\u5b57\u5716\u7247"},RecaptchaStr_zu={visual_challenge:"Thola inselelo ebonakalayo",audio_challenge:"Thola inselelo yokulalelwayo",refresh_btn:"Thola inselelo entsha",instructions_visual:"Bhala lawa magama amabili:",instructions_context:"Bhala amagama asemabhokisini:",instructions_audio:"Bhala okuzwayo:",help_btn:"Usizo",play_again:"Phinda udlale okulalelwayo futhi",cant_hear_this:"Layisha umsindo njenge-MP3",incorrect_try_again:"Akulungile. Zama futhi.",image_alt_text:"umfanekiso oyinselelo we-reCAPTCHA"},RecaptchaLangMap={en:RecaptchaStr_en,af:RecaptchaStr_af,am:RecaptchaStr_am,ar:RecaptchaStr_ar,"ar-EG":RecaptchaStr_ar,bg:RecaptchaStr_bg,bn:RecaptchaStr_bn,ca:RecaptchaStr_ca,cs:RecaptchaStr_cs,da:RecaptchaStr_da,de:RecaptchaStr_de,el:RecaptchaStr_el,"en-GB":RecaptchaStr_en,"en-US":RecaptchaStr_en,es:RecaptchaStr_es,"es-419":RecaptchaStr_es_419,"es-ES":RecaptchaStr_es,et:RecaptchaStr_et,eu:RecaptchaStr_eu,fa:RecaptchaStr_fa,fi:RecaptchaStr_fi,fil:RecaptchaStr_fil,fr:RecaptchaStr_fr,"fr-CA":RecaptchaStr_fr_ca,"fr-FR":RecaptchaStr_fr,gl:RecaptchaStr_gl,gu:RecaptchaStr_gu,hi:RecaptchaStr_hi,hr:RecaptchaStr_hr,hu:RecaptchaStr_hu,hy:RecaptchaStr_hy,id:RecaptchaStr_id,is:RecaptchaStr_is,it:RecaptchaStr_it,iw:RecaptchaStr_iw,ja:RecaptchaStr_ja,kn:RecaptchaStr_kn,ko:RecaptchaStr_ko,ln:RecaptchaStr_fr,lt:RecaptchaStr_lt,lv:RecaptchaStr_lv,ml:RecaptchaStr_ml,mr:RecaptchaStr_mr,ms:RecaptchaStr_ms,nl:RecaptchaStr_nl,no:RecaptchaStr_no,pl:RecaptchaStr_pl,pt:RecaptchaStr_pt,"pt-BR":RecaptchaStr_pt,"pt-PT":RecaptchaStr_pt_pt,ro:RecaptchaStr_ro,ru:RecaptchaStr_ru,sk:RecaptchaStr_sk,sl:RecaptchaStr_sl,sr:RecaptchaStr_sr,sv:RecaptchaStr_sv,sw:RecaptchaStr_sw,ta:RecaptchaStr_ta,te:RecaptchaStr_te,th:RecaptchaStr_th,tr:RecaptchaStr_tr,uk:RecaptchaStr_uk,ur:RecaptchaStr_ur,vi:RecaptchaStr_vi,"zh-CN":RecaptchaStr_zh_cn,"zh-HK":RecaptchaStr_zh_hk,"zh-TW":RecaptchaStr_zh_tw,zu:RecaptchaStr_zu,tl:RecaptchaStr_fil,he:RecaptchaStr_iw,"in":RecaptchaStr_id,mo:RecaptchaStr_ro,zh:RecaptchaStr_zh_cn};var RecaptchaStr=RecaptchaStr_en,RecaptchaOptions,RecaptchaDefaultOptions={tabindex:0,theme:"red",callback:null,lang:null,custom_theme_widget:null,custom_translations:null,includeContext:!1},Recaptcha={widget:null,timer_id:-1,style_set:!1,theme:null,type:"image",ajax_verify_cb:null,$:function(a){return"string"==typeof a?document.getElementById(a):a},create:function(a,b,c){Recaptcha.destroy();b&&(Recaptcha.widget=Recaptcha.$(b));Recaptcha._init_options(c);Recaptcha._call_challenge(a)},destroy:function(){var a=Recaptcha.$("recaptcha_challenge_field");a&&a.parentNode.removeChild(a);-1!=Recaptcha.timer_id&&clearInterval(Recaptcha.timer_id);Recaptcha.timer_id=-1;if(a=Recaptcha.$("recaptcha_image"))a.innerHTML="";Recaptcha.widget&&("custom"!=Recaptcha.theme?Recaptcha.widget.innerHTML="":Recaptcha.widget.style.display="none",Recaptcha.widget=null)},focus_response_field:function(){var a=Recaptcha.$("recaptcha_response_field");a.focus()},get_challenge:function(){return"undefined"==typeof RecaptchaState?null:RecaptchaState.challenge},get_response:function(){var a=Recaptcha.$("recaptcha_response_field");return!a?null:a.value},ajax_verify:function(a){Recaptcha.ajax_verify_cb=a;var a=Recaptcha.get_challenge()||"",b=Recaptcha.get_response()||"",a=Recaptcha._get_api_server()+"/ajaxverify?c="+encodeURIComponent(a)+"&response="+encodeURIComponent(b);Recaptcha._add_script(a)},_ajax_verify_callback:function(a){Recaptcha.ajax_verify_cb(a)},_get_api_server:function(){var a=window.location.protocol,b;if("undefined"!=typeof _RecaptchaOverrideApiServer)b=_RecaptchaOverrideApiServer;else{if("undefined"!=typeof RecaptchaState&&"string"==typeof RecaptchaState.server&&0<RecaptchaState.server.length)return RecaptchaState.server.replace(/\/+$/,"");b="www.google.com/recaptcha/api"}return a+"//"+b},_call_challenge:function(a){a=Recaptcha._get_api_server()+"/challenge?k="+a+"&ajax=1&cachestop="+Math.random();Recaptcha.getLang_()&&(a+="&lang="+Recaptcha.getLang_());"undefined"!=typeof RecaptchaOptions.extra_challenge_params&&(a+="&"+RecaptchaOptions.extra_challenge_params);RecaptchaOptions.includeContext&&(a+="&includeContext=1");Recaptcha._add_script(a)},_add_script:function(a){var b=document.createElement("script");b.type="text/javascript";b.src=a;Recaptcha._get_script_area().appendChild(b)},_get_script_area:function(){var a=document.getElementsByTagName("head");return a=!a||1>a.length?document.body:a[0]},_hash_merge:function(a){for(var b={},c=0;c<a.length;c++)for(var d in a[c])b[d]=a[c][d];"context"==b.theme&&(b.includeContext=!0);return b},_init_options:function(a){a=a||{};RecaptchaOptions=Recaptcha._hash_merge([RecaptchaDefaultOptions,a])},challenge_callback:function(){var a=Recaptcha.widget;Recaptcha._reset_timer();RecaptchaStr=Recaptcha._hash_merge([RecaptchaStr_en,RecaptchaLangMap[Recaptcha.getLang_()]||{},RecaptchaOptions.custom_translations||{}]);window.addEventListener&&window.addEventListener("unload",function(a){Recaptcha.destroy()},!1);Recaptcha._is_ie()&&window.attachEvent&&window.attachEvent("onbeforeunload",function(){});if(0<navigator.userAgent.indexOf("KHTML")){a=document.createElement("iframe");a.src="about:blank";a.style.height="0px";a.style.width="0px";a.style.visibility="hidden";a.style.border="none";var b=document.createTextNode("This frame prevents back/forward cache problems in Safari.");a.appendChild(b);document.body.appendChild(a)}Recaptcha._finish_widget()},_add_css:function(a){if(-1!=navigator.appVersion.indexOf("MSIE 5"))document.write('<style type="text/css">'+a+"</style>");else{var b=document.createElement("style");b.type="text/css";b.styleSheet?b.styleSheet.cssText=a:(a=document.createTextNode(a),b.appendChild(a));Recaptcha._get_script_area().appendChild(b)}},_set_style:function(a){Recaptcha.style_set||(Recaptcha.style_set=!0,Recaptcha._add_css(a+"\n\n.recaptcha_is_showing_audio .recaptcha_only_if_image,.recaptcha_isnot_showing_audio .recaptcha_only_if_audio,.recaptcha_had_incorrect_sol .recaptcha_only_if_no_incorrect_sol,.recaptcha_nothad_incorrect_sol .recaptcha_only_if_incorrect_sol{display:none !important}"))},_init_builtin_theme:function(){var a=Recaptcha.$,b=Recaptcha._get_api_server(),c=b.length-1;"/"==b[c]&&(b=b.substring(0,c));var c=RecaptchaTemplates.VertCss,d=RecaptchaTemplates.VertHtml,e=b+"/img/"+Recaptcha.theme,f="gif",b=Recaptcha.theme;"clean"==b&&(c=RecaptchaTemplates.CleanCss,d=RecaptchaTemplates.CleanHtml,f="png");"context"==b&&(d=RecaptchaTemplates.ContextHtml);c=c.replace(/IMGROOT/g,e);Recaptcha._set_style(c);Recaptcha.widget.innerHTML='<div id="recaptcha_area">'+d+"</div>";c=function(b,c,d,h){var g=a(b+"_btn"),b=a(b);b.src=e+"/"+c+"."+f;c=RecaptchaStr[d];b.alt=c;g.title=c;g.href=h};c("recaptcha_reload","refresh","refresh_btn","javascript:Recaptcha.reload();");c("recaptcha_switch_audio","audio","audio_challenge","javascript:Recaptcha.switch_type('audio');");c("recaptcha_switch_img","text","visual_challenge","javascript:Recaptcha.switch_type('image');");c("recaptcha_whatsthis","help","help_btn",Recaptcha._get_help_link());a("recaptcha_whatsthis_btn").target="_blank";a("recaptcha_whatsthis_btn").onclick=function(){Recaptcha.showhelp();return false};"clean"==b&&(a("recaptcha_logo").src=e+"/logo."+f,a("recaptcha_tagline").src=e+"/tagline."+f);a("recaptcha_table").className="recaptchatable recaptcha_theme_"+Recaptcha.theme;b=function(b,c){var d=a(b);if(d){if(RecaptchaState.rtl&&"span"==d.tagName.toLowerCase())d.dir="rtl";d.appendChild(document.createTextNode(RecaptchaStr[c]))}};b("recaptcha_instructions_image","instructions_visual");b("recaptcha_instructions_context","instructions_context");b("recaptcha_instructions_audio","instructions_audio");b("recaptcha_instructions_error","incorrect_try_again")},_finish_widget:function(){var a=Recaptcha.$,b=RecaptchaOptions,c=b.theme,d={blackglass:1,clean:1,context:1,custom:1,red:1,white:1};c in d||(c="red");Recaptcha.theme||(Recaptcha.theme=c);"custom"!=Recaptcha.theme?Recaptcha._init_builtin_theme():Recaptcha._set_style("");c=document.createElement("span");c.id="recaptcha_challenge_field_holder";c.style.display="none";a("recaptcha_response_field").parentNode.insertBefore(c,a("recaptcha_response_field"));a("recaptcha_response_field").setAttribute("autocomplete","off");a("recaptcha_image").style.width="300px";a("recaptcha_image").style.height="57px";Recaptcha.should_focus=!1;Recaptcha._set_challenge(RecaptchaState.challenge,"image");Recaptcha.updateTabIndexes_();Recaptcha.widget&&(Recaptcha.widget.style.display="");b.callback&&b.callback()},updateTabIndexes_:function(){var a=Recaptcha.$,b=RecaptchaOptions;if(b.tabindex&&(b=b.tabindex,a("recaptcha_response_field").tabIndex=b++,"audio"==Recaptcha.type&&a("recaptcha_audio_play_again")&&(a("recaptcha_audio_play_again").tabIndex=b++,a("recaptcha_audio_download"),a("recaptcha_audio_download").tabIndex=b++),"custom"!=Recaptcha.theme))a("recaptcha_reload_btn").tabIndex=b++,a("recaptcha_switch_audio_btn").tabIndex=b++,a("recaptcha_switch_img_btn").tabIndex=b++,a("recaptcha_whatsthis_btn").tabIndex=b},switch_type:function(a){Recaptcha.type=a;Recaptcha.reload("audio"==Recaptcha.type?"a":"v")},reload:function(a){var b=RecaptchaOptions,c=RecaptchaState;"undefined"==typeof a&&(a="r");c=Recaptcha._get_api_server()+"/reload?c="+c.challenge+"&k="+c.site+"&reason="+a+"&type="+Recaptcha.type;b.includeContext&&(c+="&includeContext=1");Recaptcha.getLang_()&&(c+="&lang="+Recaptcha.getLang_());"undefined"!=typeof b.extra_challenge_params&&(c+="&"+b.extra_challenge_params);"audio"==Recaptcha.type&&(c=b.audio_beta_12_08?c+"&audio_beta_12_08=1":c+"&new_audio_default=1");Recaptcha.should_focus="t"!=a;Recaptcha._add_script(c)},finish_reload:function(a,b){RecaptchaState.is_incorrect=!1;Recaptcha._set_challenge(a,b);Recaptcha.updateTabIndexes_()},_set_challenge:function(a,b){var c=Recaptcha.$,d=RecaptchaState;d.challenge=a;Recaptcha.type=b;c("recaptcha_challenge_field_holder").innerHTML='<input type="hidden" name="recaptcha_challenge_field" id="recaptcha_challenge_field" value="'+d.challenge+'"/>';if("audio"==b)c("recaptcha_image").innerHTML=Recaptcha.getAudioCaptchaHtml();else if("image"==b){var e=Recaptcha._get_api_server()+"/image?c="+d.challenge;c("recaptcha_image").innerHTML='<img style="display:block;" alt="'+RecaptchaStr.image_alt_text+'" height="57" width="300" src="'+e+'" />'}Recaptcha._css_toggle("recaptcha_had_incorrect_sol","recaptcha_nothad_incorrect_sol",d.is_incorrect);Recaptcha._css_toggle("recaptcha_is_showing_audio","recaptcha_isnot_showing_audio","audio"==b);Recaptcha._clear_input();Recaptcha.should_focus&&Recaptcha.focus_response_field();Recaptcha._reset_timer()},_reset_timer:function(){clearInterval(Recaptcha.timer_id);var a=Math.max(1E3*(RecaptchaState.timeout-
60),6E4);Recaptcha.timer_id=setInterval('Recaptcha.reload("t");',a);return a},showhelp:function(){window.open(Recaptcha._get_help_link(),"recaptcha_popup","width=460,height=580,location=no,menubar=no,status=no,toolbar=no,scrollbars=yes,resizable=yes")},_clear_input:function(){Recaptcha.$("recaptcha_response_field").value=""},_displayerror:function(a){var b=Recaptcha.$;b("recaptcha_image").innerHTML="";b("recaptcha_image").appendChild(document.createTextNode(a))},reloaderror:function(a){Recaptcha._displayerror(a)},_is_ie:function(){return 0<navigator.userAgent.indexOf("MSIE")&&!window.opera},_css_toggle:function(a,b,c){var d=Recaptcha.widget;d||(d=document.body);var e=d.className,e=e.replace(RegExp("(^|\\s+)"+a+"(\\s+|$)")," "),e=e.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)")," "),e=e+(" "+(c?a:b));d.className=e},_get_help_link:function(){var a=Recaptcha._get_api_server().replace(/\/[a-zA-Z0-9]+\/?$/,"/help"),a=a+("?c="+RecaptchaState.challenge);Recaptcha.getLang_()&&(a+="&hl="+Recaptcha.getLang_());return a},playAgain:function(){Recaptcha.$("recaptcha_image").innerHTML=Recaptcha.getAudioCaptchaHtml()},getAudioCaptchaHtml:function(){var a=Recaptcha._get_api_server()+"/image?c="+RecaptchaState.challenge;0==a.indexOf("https://")&&(a="http://"+a.substring(8));var b=Recaptcha._get_api_server()+"/img/audiocaptcha.swf?v2",b=Recaptcha._is_ie()?'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="audiocaptcha" width="0" height="0" codebase="https://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab"><param name="movie" value="'+b+'" /><param name="quality" value="high" /><param name="bgcolor" value="#869ca7" /><param name="allowScriptAccess" value="always" /></object><br/>':'<embed src="'+b+'" quality="high" bgcolor="#869ca7" width="0" height="0" name="audiocaptcha" align="middle" play="true" loop="false" quality="high" allowScriptAccess="always" type="application/x-shockwave-flash" pluginspage="http://www.adobe.com/go/getflashplayer" /></embed>',c="";Recaptcha.checkFlashVer()&&(c="<br/>"+Recaptcha.getSpan_('<a id="recaptcha_audio_play_again" class="recaptcha_audio_cant_hear_link" href="#" onclick="Recaptcha.playAgain(); return false;">'+RecaptchaStr.play_again+"</a>"));c+="<br/>"+Recaptcha.getSpan_('<a id="recaptcha_audio_download" class="recaptcha_audio_cant_hear_link" target="_blank" href="'+a+'">'+RecaptchaStr.cant_hear_this+"</a>");return b+c},getSpan_:function(a){return"<span"+(RecaptchaState&&RecaptchaState.rtl?' dir="rtl"':"")+">"+a+"</span>"},gethttpwavurl:function(){if("audio"!=Recaptcha.type)return"";var a=Recaptcha._get_api_server()+"/image?c="+RecaptchaState.challenge;0==a.indexOf("https://")&&(a="http://"+a.substring(8));return a},checkFlashVer:function(){var a=-1!=navigator.appVersion.indexOf("MSIE"),b=-1!=navigator.appVersion.toLowerCase().indexOf("win"),c=-1!=navigator.userAgent.indexOf("Opera"),d=-1;if(null!=navigator.plugins&&0<navigator.plugins.length){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"])a=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"",a=navigator.plugins["Shockwave Flash"+a].description,a=a.split(" "),a=a[2].split("."),d=a[0]}else if(a&&b&&!c)try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),f=e.GetVariable("$version"),d=f.split(" ")[1].split(",")[0]}catch(i){}return 9<=d},getLang_:function(){return"undefined"!=typeof RecaptchaState&&RecaptchaState.lang?RecaptchaState.lang:RecaptchaOptions.lang?RecaptchaOptions.lang:null}};(function(Backbone,_){'use strict';Backbone.Webshop.popup.LoginAndRegistrationBehavior=Backbone.Marionette.Behavior.extend({default:{isRegistration:false,parameters:{"popup":true,"isResponsive":true,"trackAjax":true,"_csrf":jQ("meta[name='_csrf']").attr("content")}},ui:{btnDisconnectFacebook:'#changeFacebookAccount',btnDisconnectPaypal:'#changePaypalAccount',btnFacebookLinked:'#btnFbLinked',btnLinkRegister:'#registerButton',btnLogin:'.btn-wrapper .login',btnLoginFacebook:'.fb-login-button',btnLoginFacebookElevate:'#js-popup-content .fb-elevate-login-button',btnLoginHeader:'#loginButton',btnLoginNavHeader:'.btn-login',btnRegister:'.btn-wrapper .btn-register,[data-requireslogin=newCustomer]',btnRegisterHeader:'#quickReg',btnRegisterNavHeader:'.btn-signup',btnRegisterSubmit:'#buttonRegisterSubmit',btnSmartPassLogin:'.login-button>.btn-primary',linkLogin:'#js-open-login',linkRequiresElevation:'[data-requireselevatedlogin=true]',linkRequiresLogin:'[data-requireslogin=true]',formFacebook:'#js-popup-content #facebookForm',formLinkFacebook:'#linkAccountForm.facebook-login',formLinkPaypal:'#linkAccountForm.paypal-login',formLogin:'.popup-wrapper #simpleLoginForm.regular',formLoginMobile:'#js-popup-content #simpleLoginForm.regular',formLoginElevated:'#simpleLoginForm.elevated',formRegister:'#quickRegAcceptForm',formRegisterLinkedAccount:'#registerForm',formSocialLogin:"#socialLogin"},events:{'click @ui.btnDisconnectFacebook':'disconnectFacebook','click @ui.btnDisconnectPaypal':'disconnectPaypal','click @ui.btnLinkRegister':'registerButtonAction','click @ui.btnLogin':'openLoginPopup','click @ui.btnLoginFacebook':'loginWithFacebook','click @ui.btnLoginFacebookElevate':'reauthenticateWithFacebook','click @ui.btnLoginHeader':'openLoginPopup','click @ui.btnLoginNavHeader':'openLoginPopup','click @ui.linkRequiresElevation':'openElevatedLoginPopup','click @ui.linkRequiresLogin':'openLoginPopup','click @ui.btnRegister':'openRegistrationPopup','click @ui.btnRegisterHeader':'openRegistrationPopup','click @ui.btnRegisterNavHeader':'openRegistrationPopup','click @ui.btnFacebookLinked':'redirectToRegistrationPage','click @ui.btnSmartPassLogin':'openLoginPopup','click @ui.linkLogin':'redirectToLoginPage','submit @ui.formFacebook':'submitFacebookForm','submit @ui.formLinkFacebook':'linkFacebookAccount','submit @ui.formLinkPaypal':'linkPaypalAccount','submit @ui.formLogin':'login','submit @ui.formLoginMobile':'login','submit @ui.formLoginElevated':'loginElevated','submit @ui.formRegister':'register','submit @ui.formRegisterLinkedAccount':'registerLinkedAccount','paypal:redirect':'submitPaypalForm'},facebookServiceEvents:{"identifyUser:dataValid":'redirectToTargetPage',"identifyUser:dataInvalid:emailPresent":'loadLinkAccountOverlay',"identifyUser:dataInvalid:emailAbsent":'goToRegisterForm',"facebookFallback":'facebookFallback'},initialize:function(){var _this=this;if(Backbone.Facebook.getInstance){this.facebookService=Backbone.Facebook.getInstance();this.bindEntityEvents(this.facebookService,this.facebookServiceEvents);}
webshop.gtm.registerEventSource(this);var classNames=['login-modal'];if(Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_INTEGRATION')){classNames.push('sso-full-content-modal');}
this.popupModel=new ocBackbone.popup.AjaxPopupModel({display:false,classNames:classNames});var PopupViewClass=webshop.jsConfig.popupViewClass();new PopupViewClass({model:this.popupModel,className:'rwd-site modal-wrapper',id:'loginPopup'});},updateModel:function(url){var popupModel=this.popupModel;popupModel.removeClass("registrationModal full-sso-registration-modal");popupModel.fetch({url:url,complete:popupModel.show()});},openLoginPopup:function(event){event.preventDefault();var href=event.currentTarget.href;var successRedirect;var targetUri;if(event.currentTarget.getAttribute('data-requireslogin')==="true"){targetUri="/webshop/login.go?from="+this.getPageDestinationFromUrl(href);successRedirect=href;}else{targetUri=href.replace(window.location.origin,'');successRedirect=this.getSuccessRedirectForCurrentLocation();}
if(this.isSsoFullRedirectEnabled()&&targetUri.startsWith('/webshop/login.go')){window.location.href=webshop.popup.utils.addNewParametersFromJsonObject(targetUri,{success_redirect:successRedirect});}else{this.popupModel.setSuccessRedirectUrl(successRedirect);this.updateLogInPopUp(this.getParameterisedUrl(targetUri,successRedirect));this.isRegistration=false;}},isSsoFullRedirectEnabled:function(){return Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_INTEGRATION')&&Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_FULL_REDIRECT');},isSsoElevatedLoginEnabled:function(){return Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_INTEGRATION')&&Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_ELEVATED_LOGIN');},isContextKeepingEnabled:function(){return Backbone.Webshop.mixins.isBetaFeatureEnabled('ACQUISITION_23586_CONTEXT_KEEPING');},getSuccessRedirectForCurrentLocation:function(){return webshop.common.jsTopBodyVariables.doNotRedirectAfterLogin?'':window.location.href;},getPageDestinationFromUrl:function(href){var parts=href.split("/webshop/");var actionComponent=parts[1];return actionComponent.substring(0,actionComponent.indexOf("."));},openElevatedLoginPopup:function(event){event.preventDefault();var targetUri="/webshop/loginElevated.go";var successRedirect=event.currentTarget.href;if(this.isSsoElevatedLoginEnabled()){window.location.href=webshop.popup.utils.addNewParametersFromJsonObject(targetUri,{success_redirect:successRedirect});}else{this.updateModel(this.getParameterisedUrl(targetUri,successRedirect));this.popupModel.setSuccessRedirectUrl(successRedirect);this.popupModel.setTitle(getMessage('login.login.logIn'));}},login:function(event){event.preventDefault();this.loginDebounce(event);},loginDebounce:_.debounce(function(event){webshop.popup.utils.giveSubmitFeedback(".btn-primary");var form=event.target;this.ajaxCall(this.getParameterisedUrl("/webshop/login.go"),form);},2000,true),loginElevated:function(event){event.preventDefault();var form=event.target;this.ajaxCall(this.getParameterisedUrl("/webshop/loginElevated.go"),form);},setRegistrationPopUpClassAndTitle:function(){this.popupModel.addClass('registrationModal');if(Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_INTEGRATION')){this.popupModel.setTitle(null);this.popupModel.addClass('full-sso-registration-modal');}else{this.popupModel.setTitle(getMessage('register.quickReg.header'));}},redirectToRegistrationPage:function(event){event.preventDefault();var _this=this;this.ajaxCall(this.getParameterisedUrl(event.currentTarget.href)).done(function(){_this.setRegistrationPopUpClassAndTitle();});},redirectToLoginPage:function(event){event.preventDefault();this.updateLogInPopUp();},registerButtonAction:function(event){if(Backbone.$(event.target).closest('#js-popup-content').length){this.redirectToRegistrationPage(event);}else{this.openRegistrationPopup(event);}},openRegistrationPopup:function(event){event.preventDefault();if(this.isSsoFullRedirectEnabled()){if(this.isContextKeepingEnabled()){window.location.href=event.currentTarget.href;}else{var successRedirect=this.getSuccessRedirectForCurrentLocation();window.location.href=webshop.popup.utils.addNewParametersFromJsonObject(event.currentTarget.href,{success_redirect:successRedirect});}}else{this.updateModel(this.getParameterisedUrl(event.currentTarget.href));this.setRegistrationPopUpClassAndTitle();this.isRegistration=true;}},register:function(event){event.preventDefault();this.registerDebounce(event);},registerDebounce:_.debounce(function(event){webshop.popup.utils.giveSubmitFeedback(this.ui.btnRegisterSubmit);var form=event.target;this.ajaxCall('/webshop/ajaxQuickRegAcceptForm.do',form).done(function(response){var json=webshop.popup.utils.tryParseJSON(response);if(json){var redirectPath=webshop.popup.utils.getRedirectPath(json);if(redirectPath){webshop.popup.utils.redirectTo(redirectPath);}}});},2000,true),submitFacebookForm:function(event){event.preventDefault();this.isFacebook=true;var successRedirectUrl=jQ('.js-facebook-login-success-redirect').val();if(successRedirectUrl){this.popupModel.setSuccessRedirectUrl(successRedirectUrl);}
var form=Backbone.$(event.target);var _this=this,formData=form.serialize(),authResponse=_.object(_.map(form.serializeArray(),_.values));Backbone.$.ajax({url:'/webshop/isFacebookUserRegistered.go',data:formData,dataType:'json',type:'GET',complete:function(response){if(response.responseText.indexOf('"valid":true')!=-1){if(_this.isRegistration){_this.displayStartShoppingForm(authResponse);}
else{_this.login(event);}}else{if(_this.isRegistration){_this.ajaxCall('/webshop/ajaxFacebookRegistration.do',event.target);}
else{_this.ajaxCall('/webshop/ajaxLinkAccountDisplay.go',event.target);}}}});},displayStartShoppingForm:function(authResponse){var redirectUrl=window.location.href;var startShoppingLoginForm=Handlebars.templates['registration/facebook/startShoppingLoginForm']({loginUrl:'/webshop/login.go?success_redirect='+encodeURIComponent(redirectUrl),authResponse:authResponse,loginToken:Backbone.$('#loginToken').val(),_csrf:jQ("meta[name='_csrf']").attr("content")});Backbone.$(this.ui.formSocialLogin).html(startShoppingLoginForm);},handlePayPalElevatedLogin:function(paypalReturnRedirect){var successRedirectUrl=this.popupModel.getSuccessRedirectUrl();if(successRedirectUrl&&paypalReturnRedirect.indexOf('/webshop/login.go')!==-1&&paypalReturnRedirect.indexOf('success_redirect=')===-1){paypalReturnRedirect=webshop.popup.utils.addNewParametersFromJsonObject(paypalReturnRedirect,{"success_redirect":successRedirectUrl});}
return paypalReturnRedirect;},submitPaypalForm:function(event,paypalReturnRedirect){event.preventDefault();paypalReturnRedirect=paypalReturnRedirect||'/webshop/paypalsignup.do';paypalReturnRedirect=webshop.popup.utils.addNewParametersFromJsonObject(paypalReturnRedirect,this.default.parameters);paypalReturnRedirect=this.handlePayPalElevatedLogin(paypalReturnRedirect);var form=event.target;this.ajaxCall(paypalReturnRedirect,form);this.isFacebook=false;},linkFacebookAccount:function(event){event.preventDefault();var form=event.target;this.ajaxCall('/webshop/linkFacebookAccount.go?ajax=true',form);},linkPaypalAccount:function(event){event.preventDefault();var form=event.target;this.ajaxCall('/webshop/paypalLinkAccountAcceptForm.do?ajax=true',form);},registerLinkedAccount:function(event){event.preventDefault();var url=this.isFacebook?'/webshop/ajaxFacebookRegistration.do':'/webshop/ajaxPaypalRegister.do',_this=this;this.ajaxCall(url).done(function(){_this.setRegistrationPopUpClassAndTitle();});},disconnectFacebook:function(event){event.preventDefault();FB.logout();if(this.isRegistration){this.updateModel('/webshop/ajaxQuickReg.do?from=alreadyLinkedFacebookAccount');this.popupModel.addClass('registrationModal');this.popupModel.addClass('full-sso-registration-modal');}
else{this.updateLogInPopUp(this.getParameterisedUrl("/webshop/login.go"));}},disconnectPaypal:function(event){event.preventDefault();this.updateLogInPopUp(this.getParameterisedUrl("/webshop/login.go"));},updateLogInPopUp:function(href){this.updateModel(href);if(Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_INTEGRATION')){this.popupModel.setTitle(null);}else{this.popupModel.setTitle(getMessage('login.login.logIn'));}},getParameterisedUrl:function(href,successRedirect){var parameters=successRedirect?_.extend({},this.default.parameters,{success_redirect:successRedirect.replace(window.location.origin,'')}):this.default.parameters;var paramUrl=webshop.popup.utils.addNewParametersFromJsonObject(href,parameters);paramUrl=paramUrl.replace("quickReg","ajaxQuickReg");return paramUrl;},ajaxCall:function(url,data){var formData=Backbone.$(data).serialize(),popupModel=this.popupModel,type=data?'POST':'GET';return Backbone.$.ajax({url:url,data:formData,type:type,success:function(response){var json=webshop.popup.utils.tryParseJSON(response);if(json){var redirectPath=webshop.popup.utils.getRedirectPath(json)||popupModel.getSuccessRedirectUrl();if(redirectPath){webshop.popup.utils.redirectTo(redirectPath);}}else{if(response.length>0){popupModel.clearContent();popupModel.setContent(response);}
if(Backbone.$('#recaptcha-ajax-wrapper').length>0){Backbone.$('.login-modal').addClass('popupLoginWithCaptchaContainer');}}}});},loginWithFacebook:function(event){event.preventDefault();this.facebookService.authenticate();this.trigger('gtm:uaEvent',{category:'Login',action:'fb-loginbutton-click'});},reauthenticateWithFacebook:function(event){event.preventDefault();this.facebookService.options.loginToken=Backbone.$('#loginToken').val();this.facebookService.elevateLogin();this.trigger('gtm:uaEvent',{category:'Login',action:'fb-login-reauth'});},redirectToTargetPage:function(loginUrl,response,loginToken){webshop.social.FacebookRedirects.redirectToTargetPage(loginUrl,response,loginToken);},goToRegisterForm:function(fbuid,accessToken,signedRequest){webshop.social.FacebookRedirects.goToRegisterForm(fbuid,accessToken,signedRequest);},loadLinkAccountOverlay:function(emailExists,email,fbuid,accessToken,signedRequest){this.isRegistration=false;webshop.social.FacebookRedirects.loadLinkAccountOverlay(emailExists,email,fbuid,accessToken,signedRequest);},facebookFallback:function(){webshop.social.FacebookRedirects.facebookFallback();}});})(Backbone,_);(function(Backbone){'use strict';Backbone.Webshop.popup.LoginAndRegistrationButtonView=Backbone.Marionette.ItemView.extend({template:false,behaviors:{LoginAndRegistrationBehavior:{},SSOLoginFormBehavior:{},SSORegistrationBehavior:{},}});})(Backbone);'use strict';webshop.analytics=webshop.analytics||{};webshop.analytics.HeaderBasket={createPageComponent:function(item){var pageComponent,pageComponentId;pageComponentId=this._getHeaderBasketPageComponentId(item);pageComponent={id:pageComponentId,type:'FOP_BASKET',fields:this._getHeaderBasketPageComponentFields(item)};Backbone.Webshop.analytics.WebshopAnalytics.reportPageComponents({pageComponents:[pageComponent]});return pageComponentId;},_getHeaderBasketPageComponentId:function(item){return Backbone.Webshop.analytics.mixin.getPageViewId()+'.HeaderBasket.'+item.sku;},_getHeaderBasketPageComponentFields:function(item){return{SKU:item.sku};},};'use strict';webshop.basket=webshop.basket||{};webshop.basket.HeaderBasket={alternativeHeaderEnabled:Backbone.Webshop.mixins.isBetaFeatureEnabled('ALTERNATIVE_HEADER'),alternativeHeaderOpenBasketWhenFirstItemAdded:true,alternativeHeaderAnimateToggleButtonOnSecondItemAdded:true,init:function(){this.registerPageListeners();this.setHeaderMessageTimer();if(!this.alternativeHeaderEnabled){webshop.carousel.start({containerSelector:'.trolleyWrapper',carouselSelector:'.miniTrolley',carouselViewSelector:'.itemsList'});}else{this.registerToggleBehaviour();}
document.observe('webshop:basket:update',this._updateBasket.bind(this));this.setupCheckoutButton();},registerToggleBehaviour:function(){var that=this;var delayShow=200;var delayHide=20;var delayFirstItemHide=5000;var toggleClassName='js-headerMiniTrolleyOpen';var $trolley=jQ('#trolley');var $body=jQ('body');var $trolleyToggleButton=$trolley.find('.js-miniTrolleyToggleButton');var $trolleySummary=jQ('.miniTrolleyBasketSummary');var trolleyVisible=false;var trolleyShowTimer=null;var trolleyHideTimer=null;var trolleyFirstItemHideTimer=null;if($trolley.hasClass('checkoutWalkHeader'))return;if(!$trolley.length||$trolley.hasClass('js-empty-basket')){$trolleySummary.addClass('js-miniTrolleyDirectButton-enable');return;}
$trolleySummary.removeClass('js-miniTrolleyDirectButton');$trolleyToggleButton.on('touchstart.miniTrolley',function(e,firstItemAdded){e.preventDefault();resetTrolleyTimersAndEvents();trolleyVisible=$body[firstItemAdded?'addClass':'toggleClass'](toggleClassName).hasClass(toggleClassName);if(trolleyVisible){$body.one('click.miniTrolley',hideMiniTrolley);}
if(firstItemAdded){trolleyFirstItemHideTimer=setTimeout(hideMiniTrolley,delayFirstItemHide);}});$trolleyToggleButton.on('click',function(e){e.preventDefault();});$trolley.on('mouseenter.miniTrolley',displayMiniTrolley);$trolley.on('mouseleave.miniTrolley',hideMiniTrolley);if(!webshop.common.Util.isPointerEventsSupported()){$trolleySummary.on('click',function(e){e.preventDefault();});$trolleySummary.on('mouseenter.miniTrolley',displayMiniTrolley);$trolleySummary.on('mouseleave.miniTrolley',hideMiniTrolley);}
function displayMiniTrolley(){resetTrolleyTimersAndEvents();that.finishItemAddedAnimation();if(trolleyVisible){return;}
trolleyShowTimer=setTimeout(function(){resetTrolleyTimersAndEvents();$body.addClass(toggleClassName);trolleyVisible=true;},delayShow);window.ocBackbone.pubsub.trigger('notification:force:close');}
function hideMiniTrolley(){resetTrolleyTimersAndEvents();trolleyHideTimer=setTimeout(function(){resetTrolleyTimersAndEvents();$body.removeClass(toggleClassName);trolleyVisible=false;},delayHide);}
function resetTrolleyTimersAndEvents(){clearTimeout(trolleyFirstItemHideTimer);clearTimeout(trolleyShowTimer);clearTimeout(trolleyHideTimer);$body.off('click.miniTrolley',hideMiniTrolley);}},setupCheckoutButton:function(){this.blockCheckoutClicks=jQ('.js-belowMinOrderTooltip').hasClass('belowThreshold');this.getCheckoutButtonLink().on('click',this._belowMinimumOrderValue);this._bindBelowMinOrderTooltip(this.blockCheckoutClicks);},setHeaderMessageTimer:function(){var timeInSeconds=jQ('#headerOverlay').attr('itemprop');if(timeInSeconds){window.setTimeout(webshop.basket.HeaderBasket.removeHeaderMessage,timeInSeconds*1000);}},removeHeaderMessage:function(){jQ('#headerOverlay').fadeOut(600);var messageCode=jQ('input[name=messageCode]').val();jQ.ajax({url:"/webshop/disableHeaderMessage.go",type:"POST",data:{ajax:true,messageCode:messageCode}});return false;},registerPageListeners:function(){var eventSender=new ocBackbone.gtm.TrolleyEventSender();jQ('#trolley #items').on('click','a.increase',(function(clazz){return function(e){if(webshop.common.jsVariables.get('gaTrackBasketUpdateOnSuccess')){var domElement=this;webshop.catalogue.Util.sendUpdateBasketRequest.call(domElement,e,clazz,function(){onUpdateSuccess(domElement,clazz,'add');});}else{var productData=_.extend(getProductData.call(clazz,getItemSku.call(this)),{quantity:1});eventSender.addToTrolley(productData,'Mini Trolley',pageType(),'Mini Trolley');webshop.catalogue.Util.sendUpdateBasketRequest.call(this,e,clazz);}}})(this));jQ('#trolley #items').on('click','a.decrease',(function(clazz){return function(e){if(webshop.common.jsVariables.get('gaTrackBasketUpdateOnSuccess')){var domElement=this;webshop.catalogue.Util.sendUpdateBasketRequest.call(domElement,e,clazz,function(){onUpdateSuccess(domElement,clazz,'remove');});}else{var productData=_.extend(getProductData.call(clazz,getItemSku.call(this)),{quantity:1});eventSender.removeFromTrolley(productData,'Mini Trolley',pageType(),'Mini Trolley');webshop.catalogue.Util.sendUpdateBasketRequest.call(this,e,clazz);}}})(this));jQ('#trolley #items').on('click','.delete, .delHover',(function(clazz){return function(e){if(webshop.common.jsVariables.get('gaTrackBasketUpdateOnSuccess')){var domElement=this;webshop.catalogue.Util.sendUpdateBasketRequest.call(domElement,e,clazz,function(){onUpdateSuccess(domElement,clazz,'removeAll');});}else{var productData=_.extend(getProductData.call(clazz,getItemSku.call(this)),{quantity:getItemQuantity.call(this)});eventSender.removeFromTrolley(productData,'Mini Trolley',pageType(),'Mini Trolley');webshop.catalogue.Util.sendUpdateBasketRequest.call(this,e,clazz);}}})(this));jQ('#headerMsgCloseButton').on('click',this.removeHeaderMessage);function pageType(){if(Backbone.Webshop.mixins.isCheckout()){return'Checkout walk';}else{return'Mini Trolley';}}
function getProductData(sku){var product=_.find(this.getMiniTrolleyModel(),{sku:sku});if(_.isUndefined(product)){return{};}else{return{id:product.sku,name:product.name,brand:product.brand,category:product.category,price:product.price}}}
function getItemQuantity(){var quantityStr=jQ(this).siblings('.quantity').text();return!_.isEmpty(quantityStr)&&Number(quantityStr)||1;}
function getItemSku(){var domItemId=jQ(this).parents('li').attr('id');return!_.isUndefined(domItemId)&&domItemId.replace(/[^\d]+(\d+)$/,'$1')||'0';}
function onUpdateSuccess(domElement,clazz,updateType){var productData=_.extend(getProductData.call(clazz,getItemSku.call(domElement)),{quantity:1});if(!_.isEmpty(productData)){switch(updateType){case'add':{eventSender.addToTrolley(productData,'Mini Trolley',pageType(),'Mini Trolley');break;}
case'remove':{eventSender.removeFromTrolley(productData,'Mini Trolley',pageType(),'Mini Trolley');break;}
case'removeAll':{productData.quantity=getItemQuantity(domElement);eventSender.removeFromTrolley(productData,'Mini Trolley',pageType(),'Mini Trolley');break;}
default:{break;}}}}
webshop.dialogs.OrderConfirmCancelChanges.registerPopup(jQ('.header-editOrder a, .js-cancelOrderChanges'));},getMiniTrolleyModel:function(){this.miniTrolleyModel=this.miniTrolleyModel||_.clone(webshop.common.jsVariables.get('miniTrolleyProducts')||[]);return this.miniTrolleyModel;},addToMiniTrolleyModel:function(productData){if(_.isUndefined(_.find(this.getMiniTrolleyModel(),{sku:productData.sku}))){this.miniTrolleyModel.push(productData);}},parseFormattedPrice:Backbone.Webshop.mixins.parseFormattedPrice,_updateBasket:function(event){var shouldMoveItem=true;var elementHref=event.memo.element.attr('href');if(elementHref){var elementHrefSplit=elementHref.split('?');if(elementHrefSplit){var elementParamsSplit;if(elementHrefSplit.length==2)elementParamsSplit=elementHrefSplit[1].split('&');var elementParams={};for(var i=0;i<elementParamsSplit.length;i++){var elementParamParts=elementParamsSplit[i].split('=');elementParams[elementParamParts[0]]=elementParamParts[1];}
shouldMoveItem=elementParams.fromParentContainer!='BASKET'&&elementParams.fromParentContainer!='SLOTCHANGE_BASKET';}}
if(event.memo.element[0].headerBacketShouldMoveItem!=null){shouldMoveItem=event.memo.element[0].headerBacketShouldMoveItem;}
var json=event.memo.data;if(json.errors&&event.memo.element.parents('ol.miniTrolley').length){webshop.common.Util.displayAddedMessage(json.errors[0]);}
var lastItem=json.lastItemUpdated;var itemIsInBasket=false;if(lastItem){var lastSku=lastItem.sku;if(lastSku){itemIsInBasket=jQ('#trolley').find('#basketItem'+lastSku).length>0;}}
var numItemsInBasket=jQ('#items').children().length;if(itemIsInBasket){this._updateItem(json,shouldMoveItem);if(json.nextHeaderBasketItem&&numItemsInBasket<13){this._populateItemAttributes(json.nextHeaderBasketItem);this._addItem(json.nextHeaderBasketItem,true,json.fromSlotChange);}}else{if(lastItem&&lastItem.itemQuantity>0){this._populateItemAttributes(lastItem);this._addItem(json.lastItemUpdated,false,json.fromSlotChange);}}
if(jQ('div.checkoutWalkHeader').length>0&&jQ('#items').children().length>0){jQ('#lastAdded').css('visibility','visible');}
this._updateChangedPrices(json);this._updateTotal(json);this.setEmptyInformationAndGoogleBasketFlag();if(typeof dataLayer!='undefined'){dataLayer.push({'event':'BasketChangedRule'});}
if(!this.alternativeHeaderEnabled){webshop.carousel.resize();}},_populateItemAttributes:function(item){var productData=webshop.common.jsVariables.get("productDetailsDTO");if(_.isEmpty(productData)){productData=findProductBySku(item.sku);}
if(_.isEmpty(productData)){productData=findCheckoutProductBySku(item.sku);}
if(_.isEmpty(productData)){productData=findSmartBasketProductBySku(item.sku);}
if(!_.isEmpty(productData)){item.brand=productData.brand;item.category=productData.category;}
function findProductBySku(sku){var fopMetaData=jQ('#fopMetaData-'+sku);if(_.isEmpty(fopMetaData)){return{};}else{return JSON.parse(fopMetaData.html());}}
function findCheckoutProductBySku(sku){var productLists=webshop.common.jsVariables.get('checkoutProducts');productLists=productLists&&productLists.productsInSections||{};var productFound;_.forIn(productLists,function(productList,sectionName){productFound=_.find(productList,{sku:sku});return!productFound;});if(!_.isUndefined(productFound)){return productFound;}else{return{};}}
function findSmartBasketProductBySku(sku){var products=webshop.common.jsVariables.get('products');if(products){return _.find(products,{sku:sku});}}},_updateChangedPrices:function(jsonResponse){if(jsonResponse&&jsonResponse.total&&jsonResponse.changedPrices){var changedPrices=jsonResponse.changedPrices;for(var key in changedPrices){if(changedPrices.hasOwnProperty(key)){var price=jQ('#basketItem'+key+' .itemPrice');price.text(changedPrices[key]);}}}},getCheckoutButtonLink:function(){return jQ('#basketCheckoutLinkEnabled > a');},_updateTotal:function(jsonResponse){if(jsonResponse&&jsonResponse.total&&jsonResponse.totalSkus){var itemCount=jsonResponse.totalSkus,totalCompare=parseFloat(jsonResponse.totalInteger.substring('&pound;'.length,jsonResponse.totalInteger.length)+'.'+jsonResponse.totalFraction),minOrderWarning=jQ('#minOrder,#minOrderCheckoutButton'),checkoutButtonLink;if(webshop&&webshop.info){webshop.info.BV=totalCompare;if(typeof dataLayer!='undefined'){dataLayer.push({'BV':webshop.info.BV});}}
if(jsonResponse.hideMinOrderValue){minOrderWarning.removeClass('minOrderShow');}
else{minOrderWarning.addClass('minOrderShow');}
jQ('#basketSummaryTotal').html(jsonResponse.totalInteger+'<span>.'+jsonResponse.totalFraction+'</span>');jQ('#basketSummaryCount').html(itemCount===0?'':itemCount);jQ('#basketSummarySavings').html(jsonResponse.multiBuySaving);if(jsonResponse.multiBuySaving&&jsonResponse.multiBuySavingAmount>0){jQ('#basketSummarySavingsWrapper').removeClass('hidden');jQ('#headerOrderDetails dl.savings dd').html(jsonResponse.multiBuySaving);}else{jQ('#basketSummarySavingsWrapper').addClass('hidden');jQ('#headerOrderDetails dl.savings dd').html('&ndash;');}
var $header=jQ('#header');var $buttonWrap=$header.find('.buttonWrap');if(jsonResponse.checkoutAllowed){$buttonWrap.removeClass('disabled');checkoutButtonLink=this.getCheckoutButtonLink();if(jsonResponse.belowMinimumOrderValue){this.blockCheckoutClicks=true;checkoutButtonLink.htmlTooltip('enable');}else{this.blockCheckoutClicks=false;checkoutButtonLink.htmlTooltip('disable');checkoutButtonLink.attr('href',jQ('.js-belowMinOrderTooltip').data('checkouturl'));checkoutButtonLink.attr('data-requireslogin',!jQ('.js-belowMinOrderTooltip').data('isloggedin'));}}else{$buttonWrap.addClass('disabled');}
if(itemCount===0){jQ('#instantShop').show();}else{jQ('#instantShop').hide();}}},_belowMinimumOrderValue:function(event){if(webshop.basket.HeaderBasket.blockCheckoutClicks){event.preventDefault();jQ(event.target).focus();}},_bindBelowMinOrderTooltip:function(checkoutButtonBlocked){var checkoutButtonLink=this.getCheckoutButtonLink();checkoutButtonLink.htmlTooltip({content:jQ('.js-belowMinOrderTooltip').html(),css:'checkout-info',trigger:'click',destroy:'closeTooltip',enabled:checkoutButtonBlocked});jQ(document).on('click',function(event){var $target=jQ(event.target);var insideTooltip=($target.hasClass('checkout-info')||$target.parents('.checkout-info').length>0)&&!$target.hasClass('close');if(!insideTooltip&&!$target.is(checkoutButtonLink)){checkoutButtonLink.trigger('closeTooltip');}});},_updateCheckoutTotal:function(jsonResponse){if(jsonResponse&&jsonResponse.total&&jsonResponse.totalSkus){var itemCount=jsonResponse.totalSkus;jQ('#bigSummaryTotal').html(jsonResponse.totalInteger+'<span>.'+jsonResponse.totalFraction+'</span>');jQ('#bigSummaryCount').html(itemCount===0?'':itemCount);jQ('#bigSummarySavings').html(jsonResponse.multiBuySaving);if(jsonResponse.multiBuySaving&&jsonResponse.multiBuySavingAmount>0){jQ('#bigSummarySavingsWrapper').show();jQ('#headerOrderDetails dl.savings dd').html(jsonResponse.multiBuySaving);}else{jQ('#bigSummarySavingsWrapper').hide();jQ('#headerOrderDetails dl.savings dd').html('&ndash;');}}},_updateLastAddedItem:function(json,shouldMoveItem){if(parseInt(json.lastItemUpdated.itemQuantity,10)===0){var sku=json.lastItemUpdated.sku;jQ('li#productDetails-'+sku).removeClass('shelfInTrolley');jQ('li#basketItem'+sku).remove();if(jQ('div#lastItemsAdded li').length===0){jQ('div#lastItemsAdded').remove();}}else{this._updateItem(json,shouldMoveItem);}},_addItem:function(jsonItem,appendItem,fromSlotChange){var shortDescription,description,encodedDesc,parentContainer,href,updateUrl,delHover,defaultQuantity,itemPicture,controls,itemName,itemPrice,cssClass,html,customerNum,pageComponentId;var $itemsContainer;var $items;var itemsLength;if(jsonItem){shortDescription=jsonItem.shortDescription;description=jsonItem.description;customerNum=jsonItem.customerNum;if(shortDescription){encodedDesc=webshop.common.Util.encodeDescription(shortDescription);parentContainer=fromSlotChange?'SLOTCHANGE_BASKET':'BASKET';href=application.url+'/product/'+encodedDesc+'/'+jsonItem.sku+'?from=trolley&amp;parentContainer='+parentContainer;pageComponentId=webshop.analytics.HeaderBasket.createPageComponent(jsonItem);updateUrl=application.url
+(customerNum?'/updateBasket.do':'/loggedOutAddToBasket.do')
+'?pageComponentId='+pageComponentId
+'&amp;sku='+jsonItem.sku
+'&amp;fromParentContainer='+parentContainer
+'&amp;_csrf='+jQ("meta[name='_csrf']").attr("content");delHover='<a class="delHover" href="'+updateUrl+'&amp;quantity=0">'+getMessage('catalogue.headerBasketJS.deleteItemLink')+'</a>';if(jsonItem.itemQuantity==='1'){defaultQuantity='<strong class="defaultQuantity quantity hideQuantity">'+jsonItem.itemQuantity+'</strong>';}else{defaultQuantity='<strong class="defaultQuantity quantity">'+jsonItem.itemQuantity+'</strong>';}
itemPicture='<a class="itemPicture" href="'+href+'" title="'+description+'">'+'<img height="40" width="40" src="'+jsonItem.thumbsrc+'" alt="'+description+'"/> '+'</a>';controls='<div class="controls">'+'<a class="delete" href="'+updateUrl+'&amp;quantity=0">'+getMessage('catalogue.headerBasketJS.deleteItemLink')+'</a>'+'<a class="decrease" href="'+updateUrl+'&amp;quantity=-1">'+(this.alternativeHeaderEnabled?'-':getMessage('basket.headerBasketJS.removeFromTrolleyInputTitle',shortDescription))+'</a>'+'<strong class="quantity">'+jsonItem.itemQuantity+'</strong>'+'<a class="increase" href="'+updateUrl+'&amp;quantity=1">'+(this.alternativeHeaderEnabled?'+':getMessage('basket.headerBasketJS.addToTrolleyInputTitle',shortDescription))+'</a>'+'</div>';itemName='<a class="itemName" href="'+href+'" title="'+description+'">'+this._cutShortDescription(shortDescription)+'</a>';itemPrice='<span class="itemPrice">'+jsonItem.itemPrice+'</span>';cssClass=appendItem?'':'itemJustUpdated';html='<li id="basketItem'+jsonItem.sku+'" class="basketItem '+cssClass+'">'+delHover+defaultQuantity+itemPicture+controls+itemName+itemPrice+'</li>';$itemsContainer=jQ('#items');if(appendItem){$itemsContainer.append(html);}else{$items=$itemsContainer.find('li');itemsLength=$items.length;$items.removeClass('itemJustUpdated');$itemsContainer.prepend(html);if(this.alternativeHeaderEnabled){if(this.alternativeHeaderOpenBasketWhenFirstItemAdded&&itemsLength===0){jQ('.js-miniTrolleyToggleButton').trigger('touchstart',true);}else{this.startItemAddedAnimation();}}}
this.addToMiniTrolleyModel({name:encodedDesc,sku:jsonItem.sku,brand:jsonItem.brand,category:jsonItem.category,price:this.parseFormattedPrice({currentPrice:jsonItem.itemCataloguePrice})});}}},_cutShortDescription:function(str){var maxLength=jQ('#trolley').data('trolleyDescriptionLength');if(this.alternativeHeaderEnabled&&maxLength>0&&str.length>maxLength){return str.substr(0,maxLength)+'&hellip;';}
return str;},itemAddedAnimationTimeout:0,startItemAddedAnimation:function(){if(!this.alternativeHeaderAnimateToggleButtonOnSecondItemAdded||jQ('body').hasClass('js-headerMiniTrolleyOpen')){return;}
var $trolley=jQ('#trolley');var that=this;clearTimeout(that.itemAddedAnimationTimeout);$trolley.addClass('js-miniTrolleyItemAdded');this.itemAddedAnimationTimeout=setTimeout(function(){that.finishItemAddedAnimation();},500);},finishItemAddedAnimation:function(){clearTimeout(this.itemAddedAnimationTimeout);jQ('#trolley').removeClass('js-miniTrolleyItemAdded');},_updateItem:function(jsonResponse,shouldMoveItem){var jsonItem=jsonResponse.lastItemUpdated;this._populateItemAttributes(jsonItem);if(jsonItem){var sku=jsonItem.sku;if(sku){var item=jQ('#trolley').find('#basketItem'+sku),quantity=item.find('.defaultQuantity');var added;if(jsonItem.itemQuantity>1){quantity.removeClass('hideQuantity');}else{quantity.addClass('hideQuantity');}
if(item!==null&&item.length>0){added=parseInt(quantity.text(),10)<jsonItem.itemQuantity;jQ('#items li').removeClass('itemJustUpdated');if(jsonItem.itemQuantity<=0){item.remove();}else{item.find('strong.quantity').html(jsonItem.itemQuantity);item.find('.itemPrice').html(jsonItem.itemPrice);item.addClass('itemJustUpdated');if(shouldMoveItem){item.remove();jQ('#trolley #items').prepend(item);}
if(added){this.startItemAddedAnimation();}}}}}},setEmptyInformationAndGoogleBasketFlag:function(){var $smartTrolley=jQ('#smartTrolley');var $trolley=jQ('#trolley');var isBasketEmpty;if(Backbone.Webshop.mixins.areBetaFeaturesEnabled(['ALTERNATIVE_HEADER','ALTERNATIVE_HEADER_VER_O'])){isBasketEmpty=!$trolley.find('#items').children().length;$trolley.find('.trolleyWrapper')[isBasketEmpty?'addClass':'removeClass']('hideJS');}else{isBasketEmpty=$smartTrolley.length>0?!$smartTrolley.find('li.trolley').length:!$trolley.find('#items').children().length;}
$trolley[isBasketEmpty?'addClass':'removeClass']('miniTrolleyEmpty');var info=webshop.info=webshop.info||{};info.EB=isBasketEmpty;if(typeof dataLayer!='undefined'){dataLayer.push({'EB':info.EB});}}};webshop.favourites=webshop.favourites||{};webshop.favourites.importing={init:function(){this.favouritesImportButtonView=new this.FavouritesImportButtonView();},FavouritesImportButtonView:Backbone.View.extend({el:'.favPopup',events:{'click':'clicked'},initialize:function(){webshop.gtm.registerEventSource(this);},clicked:function(){var URI=window.location.pathname;this.trigger('gtm:uaEvent',{category:'Favourites import click',action:URI})}})};(function(Backbone,bowser,jQuery){'use strict';Backbone.Webshop.mixins.showUnsupportedBrowserAlert=function(){function compareVersions(version1,version2){var v1Array=version1.split('.');var v2Array=version2.split('.');var minLength=v1Array.length>v2Array.length?v2Array.length:v1Array.length;for(var i=0;i<minLength;i++){var subV1=parseInt(v1Array[i]);var subV2=parseInt(v2Array[i]);if(subV1>subV2){return 1;}else if(subV1<subV2){return-1;}}
if(v1Array.length>v2Array.length){return 1;}else if(v1Array.length<v2Array.length){return-1;}
return 0;}
if((bowser.msie===true&&bowser.version&&compareVersions(bowser.version,'11'))<0||(bowser.android===true&&bowser.osversion&&compareVersions(bowser.osversion,'4.4')<0)){jQuery('#unsupportedBrowserAlert').css('display','block').append('<img class="invisible-dummy-button" src="/webshop/wa/browser/notSupported" alt="Reporting not supported browser" />');jQuery(window).trigger('oldBrowserDetected');}};})(Backbone,bowser,jQuery);webshop.unsupportedBrowser=webshop.unsupportedBrowser||{};webshop.unsupportedBrowser.detection={init:function(){Backbone.Webshop.mixins.showUnsupportedBrowserAlert.call(this);}};(function(Backbone){'use strict';var PageViewHolder=Backbone.Marionette.Object.extend({initialize:function(){this.pageViewId=webshop.common.jsTopBodyVariables.pageViewId;},setPageViewId:function(pageViewId){this.pageViewId=pageViewId;},getPageViewId:function(){return this.pageViewId;}});Backbone.Webshop.analytics.resource.PageViewHolder={getInstance:_.once(function(){return new PageViewHolder();})};})(Backbone);(function(Backbone){'use strict';var PageViewResource=Backbone.Marionette.Object.extend({requestNewPageView:function(pageType,previousPath){if(!Backbone.Webshop.mixins.isBetaFeatureEnabled("ANALYTICS")){return Backbone.$.Deferred().reject();}
return Backbone.$.ajax({ajax:true,type:'POST',contentType:'application/json',url:"/webshop/wa/pv/",data:JSON.stringify({pageType:pageType,previousPath:_.isEmpty(previousPath)?undefined:previousPath})});}});Backbone.Webshop.analytics.resource.PageViewResource={getInstance:_.once(function(){return new PageViewResource();})};})(Backbone);(function(Backbone,_){'use strict';Backbone.Webshop.analytics.resource.PageViewEmbeddedResource=Backbone.Marionette.Object.extend({url:function(){var resourceUrl=_.result(this,'resourceUrl')||noResourceUrlDefined();return'/webshop/wa'+resourceUrl;},initialize:function(){this.pageViewHolder=Backbone.Webshop.analytics.resource.PageViewHolder.getInstance();},saveIfTrackingEnabled:function(dataOrDataSupplier){if(!isTrackingEnabled.call(this)){return;}
var data=_.isFunction(dataOrDataSupplier)?dataOrDataSupplier():dataOrDataSupplier;return Backbone.$.ajax({ajax:true,type:'POST',contentType:'application/json',url:this.url(),data:JSON.stringify(_.assign(data,{pageViewId:this.pageViewHolder.getPageViewId()}))});}});function isTrackingEnabled(){return!_.isUndefined(this.pageViewHolder.getPageViewId());}
function noResourceUrlDefined(){throw new Error('A "resourceUrl" property must be specified.');}})(Backbone,_);(function(Backbone){'use strict';var instance;var PageComponentsResource=Backbone.Webshop.analytics.resource.PageViewEmbeddedResource.extend({resourceUrl:'/pc/'});Backbone.Webshop.analytics.resource.PageComponentsResource={getInstance:function(){if(instance===undefined){instance=new PageComponentsResource();}
return instance;}};})(Backbone);(function(Backbone){'use strict';var instance;var PageEventsResource=Backbone.Webshop.analytics.resource.PageViewEmbeddedResource.extend({resourceUrl:'/pe/'});Backbone.Webshop.analytics.resource.PageEventsResource={getInstance:function(){if(instance===undefined){instance=new PageEventsResource();}
return instance;}};})(Backbone);(function(Backbone){'use strict';var instance;var PageStatisticsResource=Backbone.Webshop.analytics.resource.PageViewEmbeddedResource.extend({resourceUrl:'/ps/'});Backbone.Webshop.analytics.resource.PageStatisticsResource={getInstance:function(){if(instance===undefined){instance=new PageStatisticsResource();}
return instance;}};})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.analytics.mixin.attachResizeHandler=function(){var windowWidth=window.innerWidth;Backbone.$(window).on('resize',_.debounce(function(){if(window.innerWidth==windowWidth){return;}
windowWidth=window.innerWidth;var windowSize={VIEWPORT_HEIGHT:window.innerHeight,VIEWPORT_WIDTH:window.innerWidth};Backbone.Webshop.analytics.WebshopAnalytics.reportPageEvent("Window resize",windowSize);},1000));};})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.analytics.mixin.reportResolution=function(){var devicePixelRatio=window.devicePixelRatio||1;var pageStatistics={DEVICE_PIXEL_RATIO:devicePixelRatio,SCREEN_HEIGHT:screen.height,SCREEN_WIDTH:screen.width,VIEWPORT_HEIGHT:window.innerHeight,VIEWPORT_WIDTH:window.innerWidth};Backbone.Webshop.analytics.WebshopAnalytics.reportPageStatistics(pageStatistics);};})(Backbone);(function(Backbone,_){'use strict';Backbone.Webshop.analytics.WebshopAnalytics={generateNewPageView:function(pageType,previousPath){var pageViewHolder=Backbone.Webshop.analytics.resource.PageViewHolder.getInstance();return Backbone.Webshop.analytics.resource.PageViewResource.getInstance().requestNewPageView(pageType,previousPath).done(function(generatedPageView){pageViewHolder.setPageViewId(generatedPageView.id);Backbone.Webshop.analytics.mixin.reportResolution();}).fail(function(){pageViewHolder.setPageViewId(undefined);});},reportPageComponents:function(pageComponentsDataOrSupplier){return Backbone.Webshop.analytics.resource.PageComponentsResource.getInstance().saveIfTrackingEnabled(pageComponentsDataOrSupplier);},reportPageStatistics:function(pageStatistics){var pageStatisticsDto={fields:pageStatistics};return Backbone.Webshop.analytics.resource.PageStatisticsResource.getInstance().saveIfTrackingEnabled(pageStatisticsDto);},reportPageEvent:function(description,fields){var pageEventDto={description:description,fields:fields};return Backbone.Webshop.analytics.resource.PageEventsResource.getInstance().saveIfTrackingEnabled({pageEvents:[pageEventDto]});},reportPageEventOfType:function(eventType,fields){var pageEventDto={type:eventType,fields:fields};return Backbone.Webshop.analytics.resource.PageEventsResource.getInstance().saveIfTrackingEnabled({pageEvents:[pageEventDto]});},reportFormValidationErrors:function(errors,type){if(Object.keys(errors).length==0){return;}
return Backbone.Webshop.analytics.resource.PageEventsResource.getInstance().saveIfTrackingEnabled({type:type,description:"",fields:errors});},reportLinkClick:function(event,pageEventParams){var peParams=pageEventParams||event.data||{};var peFields=peParams.fields||[];var url=event.currentTarget.getAttribute('href');if(_.isEmpty(url)){return;}
var shouldNavigate=false;var timeoutId=null;if(!event.isDefaultPrevented()){event.preventDefault();shouldNavigate=true;timeoutId=window.setTimeout(function(){window.location=url;},1000);}
var fields={URL:url};if(peParams.length){for(var i=0,len=peFields.length;i<len;i++){fields[peFields[i].name]=peFields[i].value;}}
Backbone.Webshop.analytics.WebshopAnalytics.reportPageEvent(peParams.description||'Link clicked',fields).always(function(){if(shouldNavigate){window.clearTimeout(timeoutId);window.location=url;}});},};Backbone.$(function(){Backbone.$(document).off('click','a.click-tracking',Backbone.Webshop.analytics.WebshopAnalytics.reportLinkClick);Backbone.$(document).on('click','a.click-tracking',Backbone.Webshop.analytics.WebshopAnalytics.reportLinkClick);});})(Backbone,_);(function(Backbone,webshop,$){"use strict";Backbone.Webshop=Backbone.Webshop||{};Backbone.Webshop.analytics=Backbone.Webshop.analytics||{};Backbone.Webshop.analytics.ScribeBannerView=Backbone.Marionette.ItemView.extend({template:false,alreadyClicked:false,events:{'click':'triggerGtmEvent'},triggerGtmEvent:function(event){var data=this.$el.data();var url=this.$el.attr('href');if(!data.advDocNo){return;}
var shouldNavigate=false;var timeoutId=null;if(!event.isDefaultPrevented()){event.preventDefault();shouldNavigate=true;timeoutId=window.setTimeout(function(){window.location=url;},1000);}
Backbone.Webshop.analytics.WebshopAnalytics.reportPageEventOfType('AD_CLICK',{FROM_ADVERT_DOC_NO:data.advDocNo,FROM_ADVERT_DOC_VERSION_NO:data.advDocVerNo,FROM_ADVERT_PARENT_DOC_NO:data.advParentDocNo,FROM_ADVERT_PARENT_DOC_VERSION_NO:data.advParentDocVerNo,PAGE_COMPONENT_ID:this.$el.find('.analyticsPageComponent').attr('id'),}).always(function(){if(shouldNavigate){window.clearTimeout(timeoutId);window.location=url;}});},});$(document).ready(function(){$('.js-rhs-banner-tracking, .js-graphic-banner-tracking').each(function(index,banner){new Backbone.Webshop.analytics.ScribeBannerView({el:banner});});});})(Backbone,webshop,jQuery);