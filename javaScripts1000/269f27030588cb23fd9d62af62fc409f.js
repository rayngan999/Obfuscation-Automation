(self.webpackChunkweb_shell=self.webpackChunkweb_shell||[]).push([[2702,8061],{8061:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>g});var r=n(7580),o=n(8912),i=n(5977),c=n(9611),a=n(9341),s=n(631),l=n(9337);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}let g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(h,e);var t,n,r,c,u=(r=h,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(c){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return y(this,e)});function h(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),t=u.call(this,e);const n=e&&e.config||null;return t.config=n,t.id=e&&e.id||"",t.sandbox=null,t.sandboxFactory=e&&e.sandboxFactory||null,t.moduleLoader=e&&e.moduleLoader||null,t.extensions=e&&e.extensions||null,t.extensionPoints=null,t._layersLoadPromise=null,t.extensions=t.extensions||[],t._extensionPoints=t._extensionPoints||[],t._logger=o.Z.getLogger(),t.__useMercuryLoader=n&&n.__useMercuryLoader,t.__useMercuryLoader&&t.__experimental_initLoader(),t}return t=h,(n=[{key:"getSandbox",value:function(){return this._getSandbox()}},{key:"getExtensions",value:function(){return this.extensions}},{key:"getExecutableInstance",value:function(e,t){return e=e||this.config.path,this._loadExecutable(e).then((e=>this._createInstance(e,t||{})))}},{key:"getExecutable",value:function(e){return e=e||this.config.path,this._loadExecutable(e)}},{key:"getExecutableInstanceForExtension",value:function(e,t,n){return this._loadExtensionLayers(t).then((()=>this.getExecutableInstance(e,n)))}},{key:"getExecutableForExtension",value:function(e,t){return this._loadExtensionLayers(t).then((()=>this.getExecutable(e)))}},{key:"_loadExtensionLayers",value:function(e){const{layers:t}=e.config,{preloadLayers:n}=e.config;let r=Promise.resolve();return(t||n)&&this.config.hasLayers?(n&&(r=this._loadExecutables(n),t&&this._preloadExecutables(t)),t&&(r=r.then(this._loadExecutables.bind(this,t))),r.catch((e=>{const t=e&&e.message?e.message:e,n=this._createErrorMessage(l.Z.ERROR_PLUGIN_LOAD_EXTENSION_LAYERS,t);throw new Error(n)})),r):r}},{key:"loadLayers",value:function(){if(this._layersLoadPromise)return this._layersLoadPromise;const{config:e}=this;let t;const n=this._getLoaderOptions();if(this._registerPluginWithLoader(n),e.hasLayers){a.Z.publish(a.Z.topics.APP_PRIVATE_START_PLUGIN_LOAD_LAYERS,{pluginId:e.id});const r=this.__useMercuryLoader?e.mercuryPackageId:n.layerPath;t=n.preloadLayers?this._loadExecutables(n.preloadLayers).then((()=>this._loadExecutable(r).then((t=>(a.Z.publish(a.Z.topics.APP_PRIVATE_FINISH_PLUGIN_LOAD_LAYERS,{pluginId:e.id,success:!0}),t))))):this._loadExecutable(r).then((t=>(a.Z.publish(a.Z.topics.APP_PRIVATE_FINISH_PLUGIN_LOAD_LAYERS,{pluginId:e.id,success:!0}),t)))}else t=Promise.resolve();return this._layersLoadPromise=t.catch((e=>{this._logger.logException("Error loading plugin layers for ".concat(this.id),e,{plugin_id:this.id});const t=e&&e.message?e.message:e,n=this._createErrorMessage(l.Z.ERROR_PLUGIN_LOAD_LAYERS,t);throw a.Z.publish(a.Z.topics.APP_PRIVATE_FINISH_PLUGIN_LOAD_LAYERS,{pluginId:this.config.id,success:!1}),new Error(n)})),this._layersLoadPromise}},{key:"_registerPluginWithLoader",value:function(e){const t=this.config._appBuild?this.config._appId:this.config.id;this.moduleLoader.setContext(t,e.baseUrl)}},{key:"onBeforeStart",value:async function(){return this.loadLayers()}},{key:"onAfterStart",value:function(){a.Z.publish(a.Z.topics.APP_PRIVATE_PLUGIN_ON_AFTER_START,{pluginId:this.config.id})}},{key:"onAfterStop",value:function(){a.Z.publish(a.Z.topics.APP_PRIVATE_PLUGIN_ON_AFTER_STOP,{pluginId:this.config.id})}},{key:"_getLoaderOptions",value:function(){const e={},t=this.config.manifestVersion||i.Z.getDefaultVersion();let n;switch(t){case i.Z.supportedVersions.VERSION_ONE:e.baseUrl="".concat(this.config.baseSourceUrl,"/").concat(this.config.id),e.layerPath="".concat(this.config.id,"/").concat(this.config.id);break;case i.Z.supportedVersions.VERSION_FOUR:case i.Z.supportedVersions.VERSION_FIVE:{n=this.config.baseSourceUrl.split("/"),s.Z.isValid(n[n.length-1])&&n.pop(),n=n.join("/"),e.baseUrl=n,this.config.baseSourceUrl=n;const r=this.config._appBuild?this.config._appId:this.config.id;e.layerPath="".concat(r,"/").concat(t===i.Z.supportedVersions.VERSION_FIVE?this.config.remoteEntry:this.config.entry);break}default:e.baseUrl=this.config.baseSourceUrl,e.layerPath="".concat(this.config.id,"/js/").concat(this.config.id)}this.config.layerPath&&(e.layerPath=this.config.layerPath),this.__useMercuryLoader&&(e.locale=this.__experimental_getLocale(),e.environment=this.__experimental_getEnvironment());const{preloadLayers:r}=this.config;return r&&Array.isArray(r)&&r.length>0&&(e.preloadLayers=r),e}},{key:"_createInstance",value:function(e,t){const n=this._getSandbox(),r={};let o,i=!1;t&&t.params&&Object.assign(r,t.params),r.sandbox=n,a.Z.publish(a.Z.topics.APP_PRIVATE_START_PLUGIN_EXECUTABLE_INSTANCE_CREATION,{pluginConfig:n.pluginConfig,extension:r.extension});try{return o=new e(r),i=!0,o}catch(e){const t=e&&e.message?e.message:e,n=this._createErrorMessage(l.Z.ERROR_PLUGIN_CREATING_INSTANCE,t);throw new Error(n)}finally{a.Z.publish(a.Z.topics.APP_PRIVATE_FINISH_PLUGIN_EXECUTABLE_INSTANCE_CREATION,{pluginConfig:n.pluginConfig,extension:r.extension,success:i})}}},{key:"_getSandbox",value:function(){if(this.sandbox)return this.sandbox;const e=this.sandboxFactory||null;let t;return t=e&&"function"==typeof e.create?e.create(this):Object.create(e),t.pluginConfig=this.config,this.sandbox=t,t}},{key:"_preloadExecutables",value:function(e){this.moduleLoader.preload(e)}},{key:"_loadExecutables",value:function(e){const t=[];return e.forEach((e=>{t.push(this._loadExecutable(e))})),Promise.all(t)}},{key:"_loadExecutable",value:function(e){const t=this.moduleLoader;let n="Error fetching an executable in the plugin (i.e. widget, module, activator, controller, etc): executable=".concat(e);return new Promise(((r,o)=>{t.load([e],(t=>{const n=t.loadedModules[e].module;if(n&&"function"==typeof n.then)n.then((e=>{r(e)}),o);else{const n=t.loadedModules[e].module;r(n)}}),(e=>{if(e&&e.failedModules){n+=" failedModules=";for(const t in e.failedModules){const{error:r,moduleId:o}=e.failedModules[t],i=r.message?r.message:r;n+="".concat(o,":").concat(i,"|")}n=n.slice(0,-1)}o(new Error(n))}),{pluginConfig:this.config})}))}},{key:"_createErrorMessage",value:function(e,t){return e.replace("{{pluginId}}",this.id).replace("{{errorMessage}}",t)}},{key:"__experimental_initLoader",value:function(){const{config:e,moduleLoader:t}=this,n=this._getLoaderOptions();t.setContext(e.id,n.baseUrl,this._getSandbox()),this._registerPluginWithLoader(n),"amd"===e.layerType&&e.entry&&(e.mercuryPackageId="".concat(e.id,"-entry@").concat(e.version||""),e.layerPath=e.entry,t.registerPackage(e));const r=e.widgets||{},o=e.builds||{};Object.keys(r).forEach((n=>{const i=r[n];Object.keys(i).forEach((n=>{const r=i[n];r.builds=f(f({},o),r.builds),r.layerType=r.layerType||e.layerType,t.registerPackage(r)}))}))}},{key:"__experimental_getLocale",value:function(){const e=this._getSandbox();return e&&e.appContext&&e.appContext.getLocalizationInfo().locale}},{key:"__experimental_getEnvironment",value:function(){const e=this._getSandbox();return e&&e.appContext&&e.appContext.getEnvironment()}}])&&p(t.prototype,n),h}((0,c.Z)(r.Z))},2702:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var r=n(8061),o=n(9337);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}let f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(p,e);var t,n,r,f,h=(r=p,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=u(r);if(f){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return l(this,e)});function p(){return i(this,p),h.apply(this,arguments)}return t=p,(n=[{key:"onBeforeStart",value:async function(){try{await a(u(p.prototype),"onBeforeStart",this).call(this);const e=await this._getExecutableActivatorInstance();await this._callActivatorOnBeforeStart(e)}catch(e){const t=e.message,n=this._createErrorMessage(o.Z.ERROR_STARTING_PLUGIN,t);throw this._logger.error(n),new Error(n)}}},{key:"onAfterStart",value:async function(){return a(u(p.prototype),"onAfterStart",this).call(this),this._callActivatorLifeCycle("onAfterStart")}},{key:"onBeforeStop",value:async function(){return a(u(p.prototype),"onBeforeStop",this).call(this),this._callActivatorLifeCycle("onBeforeStop")}},{key:"onAfterStop",value:function(){a(u(p.prototype),"onAfterStop",this).call(this),this._callActivatorLifeCycle("onAfterStop"),this._activatorInstance=null}},{key:"_getExecutableActivatorInstance",value:function(){return this.getExecutableInstance(this.config.activator)}},{key:"_callActivatorOnBeforeStart",value:function(e){return this._activatorInstance=e,this._callActivatorLifeCycle("onBeforeStart")}},{key:"_callActivatorLifeCycle",value:async function(e){if(!this._activatorInstance||!this._activatorInstance[e])return Promise.resolve();try{const t=await this._activatorInstance[e]();return Promise.resolve(t)}catch(t){const n=t.message;let r=this._createErrorMessage(o.Z.ERROR_PLUGIN_ACTIVATOR_LIFECYCLE_METHOD,n);if(r=r.replace("{{methodName}}",e),this._logger.error(r),"onAfterStart"!==e)throw new Error(r);return Promise.resolve()}}}])&&c(t.prototype,n),p}(r.default)},9337:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={ERROR_STARTING_PLUGIN:"An error occurred trying to start the plugin: {{pluginId}}. Error: {{errorMessage}}",ERROR_PLUGIN_LOAD_LAYERS:"An error occurred trying to load layers for the plugin: {{pluginId}}. Error: {{errorMessage}}",ERROR_PLUGIN_LOAD_EXTENSION_LAYERS:"An error occurred trying to load extension layers for the plugin: {{pluginId}}. Error: {{errorMessage}}",ERROR_PLUGIN_ACTIVATOR_LIFECYCLE_METHOD:"An error occurred calling the activator's life cycle method {{methodName}} for plugin: {{pluginId}}. Error: {{errorMessage}}",ERROR_PLUGIN_CREATING_INSTANCE:"An error occurred trying to create an instance of the given executable. The error is likely in the plugin constructor. Plugin: {{pluginId}}. Error: {{errorMessage}}"}},9611:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(2768);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const l=e=>function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(h,e);var t,n,l,u,f=(l=h,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(l);if(u){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return a(this,e)});function h(){return o(this,h),f.apply(this,arguments)}return t=h,(n=[{key:"listenTo",value:function(e,t,n){if(n||"object"!=typeof t||(n=this),(this._listeningTo||(this._listeningTo={}))[r.Z.uniqueId("l")]={object:e,name:t,callback:n},e.addEventListener){let r=t.match(/(.*):(.*)/);r&&([,r,t]=r,n=function(e,t,n){return r=>{const o=function(e,t,n){const r=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;for(;e&&1===e.nodeType&&e!==n;){if(r.call(e,t))return e;e=e.parentNode}return!1}(r.target,e,n);o&&t(r,o)}}(r,n,e)),e.addEventListener(t,n,!1)}else e.on&&e.on(t,n,this);return this}},{key:"stopListening",value:function(e,t,n){const r=this._listeningTo;let o,i,c={};if(!r)return this;if(!e||t||n)if(e&&t&&!n)for(i in r)r[i].object===e&&r[i].name===t&&(c[i]=r[i]);else if(e&&t&&n)for(i in r)r[i].object===e&&r[i].name===t&&r[i].callback===n&&(c[i]=r[i]);else e||t||n||(c=r);else for(i in r)r[i].object===e&&(c[i]=r[i]);for(i in c)o=c[i],o.object.removeEventListener?o.object.removeEventListener(o.name,o.callback,!1):o.object.off&&o.object.off(o.name,o.callback,this),delete this._listeningTo[i];return this}}])&&i(t.prototype,n),h}(e)}}]);
//# sourceMappingURL=2702.js.map