var baxiaCommon=function(){"use strict";var e=function(e,t){return!!e&&e.indexOf(t)>-1},t=function(e){for(var t=Array(e.length),n=0;t.length>n;++n)t[n]=e[n];return t},n=function(e,t,n){return e.indexOf("?")>-1?e+"&"+t+"="+n:e+"?"+t+"="+n},r=function(e,t,n){return e+"&"+t+"="+n},a=location,i=document,o=function(e,t,n){(void 0===t&&(t=1),void 0===n&&(n=1),0>=n||Math.random()<n)&&function(e,t){var n=[];for(var r in e)n.push(r+"="+encodeURIComponent(e[r]));(new Image).src=t+n.join("&")}({code:t,msg:(e+"").substr(0,1e3)+";v:1.1.8",pid:"baxia",page:a.href.split(/[#?]/)[0],query:a.search.substr(1),hash:a.hash,referrer:i.referrer,title:i.title,ua:navigator.userAgent},"//gm.mmstat.com/fsp.1.1?")};function s(e){o(e,13,1)}var u=window,c=function(e,t){var n=u.__baxia__||{};return e?n[e]||t:n},f=function(e,t){u.__baxia__=u.__baxia__||{},u.__baxia__[e]=t},d=function(e,t,n,r){if(void 0===r&&(r=!1),t.addEventListener)t.addEventListener(e,n,r);else if(t.attachEvent)return t.attachEvent("on"+e,n),!1},p=function(){var e={test:"true"};try{return Object.defineProperty(e,"test",{enumerable:!1,value:e}),Object.getOwnPropertyDescriptor(XMLHttpRequest.prototype,"readyState")&&e.test==e.test}catch(t){return!1}}(),l=function(e,n,r){var a=e[n];e[n]=function(){var e=t(arguments);if(r&&!1===r.apply(this,e))return;return a.apply(this,e)}},h=function(t){void 0===t&&(t="");var n={valid:!1,type:""};if("object"==typeof t)t=JSON.stringify(t);else try{JSON.parse(t)}catch(o){return n.valid=!0,n}t=t.toLocaleLowerCase();var r=e(t,"rgv587_"),a=!r&&e(t,"assist_flag")&&e(t,"url"),i=!a&&e(t,"_flag_")&&e(t,"url");return r||a||i?n:(n.valid=!0,n)},v=XMLHttpRequest.prototype,y=null,m=function(e){var n,r,a,i,o=e.done;try{p&&function(e,n,r,a){if(Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,n);if(p&&!i||!i)s("éè¯¯ï¼ä¸æ¯æ hookProperty");else{var o=i.set,u=i.get;p&&Object.defineProperty(e,n,{set:function(){var e=t(arguments);if(r){var n=r&&r.apply(this,e);e=n?[n]:e}o&&o.apply(this,e)},get:function(){var e=u&&u.apply(this);return a?a.call(this,e):e}})}}}(v,"readyState",null,function(e){var t=e,n=this;this._onreadystatechange=this._onreadystatechange||this.onreadystatechange;var r=g(n);if(3!==t||h(r).valid){if(4===t&&"json"===n.responseType&&!h(r).valid)return void o({response:r,readyState:t,xhr:this,eventKey:"onreadystatechange"})}else this.onreadystatechange=function(e){var a=this;y=window.event||e||y,r=g(n),o({response:r,readyState:t,xhr:n,eventKey:"onreadystatechange",event:y},function(){a._onreadystatechange(y)})};return t})}catch(u){s("hook xhr ,message:"+u.message)}l(v,"send",function(){var e=this;this.sendParams=arguments,this._onload||(this._onload=this.onload),this.onload&&(this.onload=function(e){var t=this;y=window.event||e;var n=g(this);o({response:n,readyState:3,xhr:this,eventKey:"onload"},function(){t._onload&&t._onload(y)})}),!p&&d("readystatechange",this,function(){var t=g(e);o({response:t,readyState:e.readyState,xhr:e,eventKey:"readystatechange"})})}),v.addEventListener&&(a=function(){var e=t(arguments),n=e[1];return e[1]=function(e){var r=e.type,a=t(arguments);if("load"===r||"readystatechange"===r){var i=g(e.target);if(i){var s=this;return void o({response:i,readyState:3,xhr:s,eventKey:r},function(){n.apply(s,a)})}}n.apply(this,t(arguments))},e},i=(n=v)[r="addEventListener"],n[r]=function(){var e=t(arguments),n=a.apply(void 0,e);return i.apply(this,n)}),l(v,"setRequestHeader",function(e,t){this._header_=this._header_||{},this._header_[e]=t}),l(v,"open",function(){this.openParams=arguments})};function g(e){var t="";try{t=e.response||e.responseText}catch(n){t=""}return t}var b,w=document,x=function(e,t,n){if(!e)return t();var r=w.getElementsByTagName("script")[0],a=w.createElement("script");if(a.async=!0,a.src=e,e.indexOf("alicdn")>-1&&(a.crossOrigin=!0),a.onerror=function(t){o("function:loadJS. msg:"+e+"load errorãpropsï¼"+JSON.stringify(n)),a.onerror=null},t){var i=!1;a.onload=a.onreadystatechange=function(){i||a.readyState&&!/loaded|complete/.test(a.readyState)||(a.onload=a.onreadystatechange=null,i=!0,t())}}r.parentNode.insertBefore(a,r)},O=[],S=function(e,t){void 0===e&&(e="Xhr"),void 0===t&&(t={});try{if(b)return b.handler(t);O.push({pluginName:e,props:t});var n=O[0],r="baxia"+n.pluginName+"Handler",a=function(e,t){return t&&t.result&&t.result.jsPath?t.result.jsPath:""+c("cdnPath","https://g.alicdn.com/sd/baxia/1.1.8/")+e+".js"}(r,n.props);x(a,function(){if(!b){b=new window[r];for(var e=0;O.length>e;e++)b.handler(O[e].props);O=[]}})}catch(i){b=null,o("handler errï¼param:"+e+JSON.stringify(t)+","+i.message+i.stack)}};var k={version:"1.1.8",init:function(){try{m({done:function(e,t){var n=e.response,r=e.readyState,a=e.xhr,i=e.eventKey;n||(n=function(e){var t="";try{t=e.response||e.responseText}catch(n){t=""}return t}(a)),a._processing||(a._processing||3>r||h(n).valid?t&&t():(a._processing=!0,"onreadystatechange"===i&&(a.onload=a._onload),S("Xhr",{result:n,config:{xhr:a,url:a.responseURL,fail:function(){var e=a.onerror||a.onabort||a.ontimeout||t;e&&e()}}})))}})}catch(e){s("hook xhr,m:"+e.message)}}};var _=function(e){var t=e.done,n=window.fetch;n&&(window.fetch=function(){var e=arguments;return new window.Promise(function(r,a){var i=e[1]||{};i.credentials&&"omit"!==i.credentials||(i.credentials="same-origin"),n.apply(window,e).then(function(n){try{var o=n.headers.get("content-type");if(-1>=o.indexOf("json")&&-1>=o.indexOf("text"))return r(n)}catch(s){return r(n)}n.clone().text().then(function(o){return t?t({parentConfig:i,parentArguments:e,response:n,data:o,resolve:r,reject:a}):(r(n),o)})})["catch"](function(e){a(e)})})})};var N={init:function(){try{_({done:function(e){var t,n=e.parentArguments,r=e.response,a=e.data,i=e.resolve,o=e.reject,s=a.config||{};return s&&((s=e.parentConfig).url=n[0].url||n[0]),h(a).valid?((t=s.baxiaData&&s.baxiaData.defer)?t.resolve(r):i(r),a):(s.baxiaData={defer:t={resolve:i,reject:o},response:r},S("Fetch",{result:a,config:s}),t.promise)}})}catch(e){s("Hook Fetch ï¼Message:"+e.message)}}},F=function(e){if(!e||"string"!=typeof e)return!1;var t=c("options",{}).checkApiPath;return!(!t||!t(e))};var H,P={},C=c("events",{}),E={on:function(e,t){return(C[e]||(C[e]=[])).push(t),f("events",C),P},once:function(e,n){var r=this,a=function(){n.apply(r,t(arguments)),r.off(e,a)};return this.on(e,a),P},off:function(e,t){if(!e&&!t)return C={},P;var n=C[e];if(n)if(t)for(var r=n.length-1;r>=0;r--)n[r]===t&&n.splice(r,1);else delete C[e];return P},fire:function(e,t){var n=(C=c("events",{}))[e];if(n)for(var r=0,a=(n=n.slice()).length;a>r;r++)n[r](t);return P}},j="event:awscReady@baxia";!function(e){e[e.Null=0]="Null",e[e.QueryString=1]="QueryString",e[e.JSONString=2]="JSONString",e[e.FormData=3]="FormData",e[e.FormUrlEncoded=4]="FormUrlEncoded",e[e.Form=5]="Form",e[e.XHRHeader=6]="XHRHeader",e[e.FetchHeader=7]="FetchHeader"}(H||(H={}));var A=function(e){if(!e)return e;var t=c("options",{}).asac;return t?e=L(q(e),e,[{key:"bx-asac",value:t}]):e},D=function(e){try{var t=window.fyOBJ,n=t.getUA(),r=t.umidToken,a=T(e),i=[{key:"bx-ua",value:n},{key:"bx-umidtoken",value:r}],s=c("ncData");s&&s.length>0&&(i=i.concat(s)),e=L(a,e,i)}catch(u){o("addParamToRequest:"+u.message)}return e},T=function(e){var t=J(e);if(t)return t;var n=e.params;return!function(e){var t=!0;try{JSON.parse(e)}catch(n){t=!1}return t}(n)?n instanceof FormData?t=H.FormData:"string"==typeof n&&n.indexOf("=")>-1?t=H.FormUrlEncoded:n instanceof HTMLFormElement&&(t=H.Form):t=H.JSONString,t},q=function(e){return J(e)||H.QueryString},J=function(e){var t=null;return"header"===c("options",{}).appendTo&&(e.request instanceof XMLHttpRequest?t=H.XHRHeader:e.request&&"object"==typeof e.request&&(t=H.FetchHeader)),t};function R(e){var t=c("options",{}),n=t.asac,r=t.awscTimeout;if(E.once(j,function(){var t,r,a,i;(e.isAppend()||(n&&(e=A(e)),e=D(e)),t=c()||{},i=t.ncData,!(a=void 0===(r=t.options)?{}:r).renderNC||i&&0!==i.length||((a.unVerifiedCallback||function(){alert("è¯·åå®æéªè¯ååè¿è¡æä½")})(),0))?e.process(e):e.canNotSubmit&&e.canNotSubmit()}),!window.fyOBJ)return setTimeout(function(){E.fire(j)},r||3e3),e;E.fire(j)}function L(e,t,a){switch(e){case H.XHRHeader:U(t.params,a,function(e){t.request.setRequestHeader(e.key,e.value)});break;case H.FetchHeader:var i=t.headers||{};U(t.params,a,function(e){i[e.key]=e.value}),t.headers=i;break;case H.Form:U(t.params,a,function(e){!function(e,t,n){var r=document.createElement("input");r.type="hidden",r.name=t,r.value=n,e.appendChild(r)}(t.params,e.key,e.value)});break;case H.QueryString:U(t.params,a,function(e){t.url=n(t.url,e.key,e.value)});break;case H.FormUrlEncoded:U(t.params,a,function(e){t.params=r(t.params,e.key,e.value)});break;case H.FormData:U(t.params,a,function(e){t.params.append(e.key,e.value)});break;case H.JSONString:var o=t.params?JSON.parse(t.params):{};U(o,a,function(e){o[e.key]=e.value}),t.params=JSON.stringify(o)}return t}function U(e,t,n){for(var r=t.length,a=0;r>a;a++)n(t[a]);return e}var X=XMLHttpRequest.prototype,K=function(){try{r=function(e,t){var n=this;if(!this.effectUrl)return t.apply(this,e);R({url:this.effectUrl,request:this,params:e[0],headers:null,isAppend:function(){return n.appended},process:function(e){t.call(n,e.params)}})},a=(e=X)[n="send"],e[n]=function(){var e=t(arguments);r.call(this,e,a)},function(e,n,r,a){var i=e[n];e[n]=function(){var e=t(arguments);if(!r||a||!1!==r.apply(this,e))return a&&(e=r.apply(this,e)),i.apply(this,e)}}(X,"open",function(){var e=t(arguments),n=e[1];return!F(n)||this.effectUrl?(this.appended=!0,e):(this.effectUrl=e[1],"header"===c("options",{}).appendTo?e:(n=A({url:n,request:null,params:null,headers:null}).url,e[1]=n,e))},!0)}catch(i){s("xhr token"+i.message)}var e,n,r,a},M=function(e){var t="",n=navigator.userAgent.match(/.*(iPhone|iPad|Android|ios|SymbianOS|Windows Phone).*/i);n?(t="register_h5",x("//g.alicdn.com/sd/nch5/index.js",function(){var e=window.NoCaptcha;e.init(i),e.setEnabled(!0)})):(t="register",x("//g.alicdn.com/sd/ncpc/nc.js",function(){window.noCaptcha(i)}));var r=e.verifiedCallback,a=e.showCallback,i={renderTo:"#"+e.renderTo.id,appkey:"NCAPPKEY",token:"NCTOKENSTR",scene:t,replaceCallback:function(e,t,a){var i,o=[];n?i=a.bind(this,"ok"):(i=e.success,t=e.data);var s=JSON.parse(t.p);o.push({key:"bx-nc-ua",value:t.n}),o.push({key:"bx-nc-umidtoken",value:s&&s.umidToken}),f("ncData",o),r&&r(),i({success:!0,result:{code:0}})},language:e.ncLanguage};a&&a()},B=function(){var e=c("options",{});e.renderNC=e.renderNC||location.search.indexOf("renderNC")>-1,e.renderNC&&M(e),function(e){var t=window.AWSC;e.umOptions=e.umOptions||{},e.umOptions.appName=e.umOptions.appName||"security-fourier",e.uabOptions=e.uabOptions||{},e.uabOptions.Flag=e.uabOptions.Flag||2980046,t&&t.configFY(function(e){window.fyOBJ=e,E.fire("event:awscReady@baxia")},e.umOptions,e.uabOptions)}(e),function(){try{var e=window.fetch;if(!e)return;window.fetch=function(){var t=arguments;return new window.Promise(function(n,r){var a=t[0],i=t[1]||{},o=function(){e.apply(window,t).then(function(e){return n(e)})["catch"](function(e){r(e)})};if("string"!=typeof a)return o();if(!F(a))return o();var s=i.headers,u=i.body,c=void 0===u?"{}":u;R({url:a,params:c,headers:s,request:{},isAppend:function(){return s&&s["bx-ua"]||c&&c.indexOf("bx-ua")>-1},process:function(e){var n=e.headers,r=e.params;t[0]=e.url,function(e){if(!e)return!0;for(var t in e)return!1;return!0}(n)||(i.headers=n),r&&"{}"!==r&&(i.body=r),t[1]=i,o()}})})}}catch(t){s("fetch token"+t.message)}}(),K(),function(){try{var e=!1,t=function(t){if("submit"===t.type){var n=t.target||t.srcElement,r=n.getAttribute("action")||location.href;if(!F(r))return;if(!0===e)return void t.preventDefault();e=t.formSubmit,R({url:r,params:n,headers:{},request:{},isAppend:function(){return!!n["bx-ua"]},canNotSubmit:function(){t.preventDefault()},process:function(e){var t=e.url;r!==t&&n.setAttribute("action",t)}})}};d("submit",document,t);var n=window.HTMLFormElement;n&&l(n.prototype,"submit",function(){e=!1,t({type:"submit",target:this,formSubmit:!0,preventDefault:function(){throw"æªå®æéªè¯"}})})}catch(r){s("form token"+r.message)}}()};k.init(),N.init();var Q={set:f,version:"1.1.8",init:function(e){void 0===e&&(e={}),f("options",e),e.checkApiPath&&B()}};return o("i,c",11,.01),Q}();
