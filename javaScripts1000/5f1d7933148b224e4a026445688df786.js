!function(){var e={990:function(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])}return r},writable:!0,configurable:!0})}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}!function(){"use strict";function e(e){const t="str-element-id-xxxx".replace(/[x]/g,(()=>(16*Math.random()%16|0).toString(16)));let r=e.id||e.name;return r||(e.id=t,r=t),r}const t={isSafeFrame:()=>{try{return t.safeFrameWindow(),!0}catch{return!1}},safeFrameWindow:e=>{e||(e=window);try{if(e===window.top){if(e.$sf&&e.$sf.ext)return e;throw new Error("Safeframe not found")}return e.$sf&&e.$sf.ext?e:t.safeFrameWindow(e.parent)}catch{throw new Error("Safeframe not found")}},register:()=>{const e=t.safeFrameWindow(),{w:r,h:n}=t.containerGeometry();e.$sf.ext.register(r,n,((e,t)=>null))},expandFullscreen:()=>Promise.resolve(t.expand(t.expansionGeometry())),expand:e=>{const r=t.safeFrameWindow();return"expanded"==r.$sf.ext.status()?Promise.resolve():Promise.resolve(r.$sf.ext.expand(e))},collapse:()=>{const e=t.safeFrameWindow();return"collapsed"==e.$sf.ext.status()?Promise.resolve():(e.$sf.ext.collapse(),new Promise(((t,r)=>{const n=setInterval((function(){"collapsed"===e.$sf.ext.status()&&(clearInterval(n),t())}),100)})))},expansionGeometry:()=>t.safeFrameWindow().$sf.ext.geom().exp,containerGeometry:()=>t.safeFrameWindow().$sf.ext.geom().self,windowGeometry:()=>t.safeFrameWindow().$sf.ext.geom().win};var n=t;function i(e){const t=e.getBoundingClientRect();return{width:t.width||0,height:t.height||0}}const o={getPlacementLocation:function(){const e=o.windowLocation();let t;try{t=e.ancestorOrigins[0]||e.href}catch(r){e&&(t=e.href)}return t?encodeURIComponent(t):null},renderEnv:function(){return o.isAMP()?`amp-${o.renderFrame()}`:o.renderFrame()},renderFrame:function(){return n.isSafeFrame()?"safeframe":window.self!==window.top?"iframe":window.self===window.top?"top":"unknown"},isAMP:function(){return window.hasOwnProperty("AMP_CONTEXT_DATA")},windowLocation:function(){return window.location}};var a=o;let s="gc-605-d0de189c";const c={types:{Error:"error",IframeBusterFailed:"iframeBusterFailed",JsTrackerFailedToLoad:"jsTrackerFailedToLoad",ReceivedImpression:"impressionReceived",RenderedImpression:"impression",ViewableImpression:"visible",GroundControlPresent:"groundControlPresent",ArticleView:"articleView",ArticleViewDuration:"articleViewDuration",VideoStart:"videoStart",VideoPlay:"videoPlay",AutoplayVideoEngagement:"autoplayVideoEngagement",SilentAutoPlayDuration:"silentAutoPlayDuration",VideoViewDuration:"videoViewDuration",Share:"share",UserEvent:"userEvent",CompletionPercent:"completionPercent",Visible:"visible",TimeInView:"timeInView",DcoRequest:"DCORequest",NurlFail:"winNotificationFail",ImaClick:"imaClick",ImaError:"imaError",ImaAutoplayFailure:"imaAutoplayFailure",BannerRendered:"banner.rendered",VideoVolumeOn:"videoVolumeOn",VastClickthrough:{found:"vastClickthroughFound",notFound:"vastClickthroughNotFound"},VastVpaid:{enabled:"VastVpaidEnabled",notEnabled:"VastVpaidNotEnabled"},DoubleVerifyRender:"doubleVerifyRender",DoubleVerifySuccess:"doubleVerifySuccess",DoubleVerifyFallback:"doubleVerifyFallback",DoubleVerifyError:"doubleVerifyError",SubtitlesEnabled:"subtitlesEnabled"},userEvents:{autoplayVideoEngagement:"autoplayVideoEngagement",clickout:"clickout",share:"share",videoPlay:"videoPlay"},shareTypes:{custom:"custom"},videoTypes:{instantPlay:"instant",clickToPlay:"clickToPlay",youtube:"youtube"},benchmarkTypes:{bootTime:"bootTime",renderLatency:"renderLatency",benchmarkBoot:"benchmarkBoot",benchmarkVisible:"benchmarkVisible"},iframeBusterFailureTypes:{placementTagInsertion:"tagInsertion",iframeNotFound:"notFound"},preResponseParams:()=>{const{width:e,height:t}={width:window.innerWidth,height:window.innerHeight};return{bwidth:e.toString(),bheight:t.toString(),ploc:a.getPlacementLocation()||"",renderEnv:a.renderEnv(),umtime:window.Date.now().toString(),version:s}},defaultParams:(e,t,r=[])=>{let o={};if(t){const e=i(t),r=function(e){let t=0,r=0;try{const e=n.safeFrameWindow().$sf.ext.geom();t=e.self.l,r=e.self.t}catch(n){for(t=e.offsetLeft,r=e.offsetTop;e.offsetParent;)t+=(e=e.offsetParent).offsetLeft,r+=e.offsetTop}return{x:t,y:r}}(t),a=function(e){const t=e.querySelector(".str-thumbnail");return t?i(t):{width:0,height:0}}(t);o={pwidth:e.width.toString(),pheight:e.height.toString(),pxoff:r.x.toString(),pyoff:r.y.toString(),twidth:a.width.toString(),theight:a.height.toString()}}const a={pkey:e.placement.key,tkey:e.placement.templateKey,ckey:e.creative.creativeKey,vkey:e.creative.variantKey,arid:e.adserverRequestId,awid:e.auctionWinId,supplyId:e.supplyId,sourceId:e.creative.sourceId,deal_id:e.creative.dealId,action:e.creative.action,isVast:(!!e.creative.vastUrl).toString(),...o,...c.preResponseParams()};return Object.keys(a).filter((e=>0===r.length||r.includes(e))).reduce(((e,t)=>(e[t]=a[t],e)),{})},setTagVersion:e=>s=e};var d=c;r(990);const f={type:1,arid:2,pkey:3,supplyId:4,tkey:5,ckey:6,vkey:7,userEvent:8,umtime:9};function u(e){return`https://b.sharethrough.com/butler?${function(e,t){if(!e)return"";let r,n;return r=[],Object.keys(e).sort((function(e,r){return void 0===t?0:(t[e]||1e3)-(t[r]||1e3)})).forEach((function(t){n=e[t],Array.isArray(n)?n.forEach((e=>r.push(`${encodeURIComponent(t)}=${encodeURIComponent(e)}`))):r.push(`${encodeURIComponent(t)}=${encodeURIComponent(n)}`)})),r.join("&")}(Object.assign({},e,d.preResponseParams()),f)}`}function l(e,t,r=!0){return Promise.all(e.map((e=>{m.firePixel(e,r).catch((()=>{m.fireWinNotificationError(e,t)}))}))).then((()=>{}))}let m={fireBeacon:function(e,t,r){const n=u({...e,...d.defaultParams(t,r)});return m.firePixel(n)},fireSimpleBeacon:function(e){const t=u({...e});return m.firePixel(t)},fireCustomEngagement:function(e){return function(e,t){return m.fireBeacon({type:d.types.UserEvent,share:e,engagement:!0,userEvent:d.types.Share},t)}(d.shareTypes.custom,e)},firePixel:function(e,t=!1){return new Promise(((r,n)=>{const i=new Image;i.addEventListener("load",(()=>r()),{once:!0}),t&&i.addEventListener("error",(e=>n(e)),{once:!0}),i.src=function(e){return e.replace(/\[timestamp\]/g,window.Date.now().toString()).replace(/%%/g,"%25%25")}(e)}))},fireWinNotification:function(e){return l(e.creative.beacons["win-notification"]||[],e)},fireWinNotificationError:function(e,t){return m.fireBeacon({type:d.types.NurlFail,nurl:e},t)},fireVideoImpression:function(e){return l(e.creative.beacons["video-impression"]||[],e,!1)},fireVideoWinNotification:function(e){return l(e.creative.beacons["video-win-notification"]||[],e)},generateRequest:u};var p=m;class y{constructor(){var e,t;t=void 0,(e="stopRetrying")in this?Object.defineProperty(this,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):this[e]=t,this.stopRetrying=!1}boot(){const t=document.querySelector("[data-str-native-key]");if(!t)return;const r=t.getAttribute("data-str-replace-iframe-container"),n=function(t,r=!1){const n=t.top;let i=t;for(;i.parent!==n&&i.parent&&i.parent.frameElement;)i=i.parent;if(i.frameElement){if(!r)return e(i.frameElement);if(i.frameElement.parentElement)return e(i.frameElement.parentElement)}}(window,!!r);if(!n)return void p.fireSimpleBeacon({pkey:t.getAttribute("data-str-native-key")||"",type:"iframeBusterFailed",failureType:"unfriendlyIframe",iframeHref:encodeURIComponent(location.href),iframeAncestorOrigin:encodeURIComponent(location.ancestorOrigins&&location.ancestorOrigins.length>0?location.ancestorOrigins[location.ancestorOrigins.length-1]:"")});const i=e(window.frameElement),o={placementKey:t.getAttribute("data-str-native-key")||void 0,creativeKey:t.getAttribute("data-str-creative-key")||void 0,campaignKey:t.getAttribute("data-str-campaign-key")||void 0,clickTracker:t.getAttribute("data-str-click-tracker")||void 0,jsTracker:t.getAttribute("data-str-js-tracker")||void 0,dfpIframeIdentifier:n,insertionPointIframeIdentifier:n,originIframeIdentifier:i,bidResponse:y.getBidResponse(t)};this.registerStopRetryListener(),this.gracefulRetry((()=>{(class{static firePostMessage(e){const t={strNativeKey:e.placementKey,strCreativeKey:e.creativeKey,strCampaignKey:e.campaignKey,strJsTracker:e.jsTracker,strClickTracker:e.clickTracker,dfpIframeIdentifier:e.insertionPointIframeIdentifier,insertionPointIframeIdentifier:e.insertionPointIframeIdentifier,originIframeIdentifier:e.originIframeIdentifier,bidResponse:e.bidResponse};window.top.postMessage(JSON.stringify(t),"*")}}).firePostMessage(o)}),100)}static getBidResponse(e){const t=e.getAttribute("data-stx-response-name");return t?window[t]:void 0}registerStopRetryListener(){window.addEventListener("message",(e=>{const t=e.data;"string"==typeof t&&t.indexOf("strStopPosting")>-1&&(this.stopRetrying=!0)}))}gracefulRetry(e,t){setTimeout((()=>{this.stopRetrying||(e(),this.gracefulRetry(e,Math.min(2*t,1e3)))}),t)}}var g=y;window.self!=window.top&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{(new g).boot()})):(new g).boot())}()}();
//# sourceMappingURL=gc-iframe-buster.js.map