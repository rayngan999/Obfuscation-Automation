!function(){"use strict";angular.module("dorgEuiApp",["angular-hal","angularSpinner","checklist-model","dndLists","flash","hard-refresh-interceptor","http-auth-interceptor","mobile-detection","ngAnimate","ngCookies","ngResource","ngSanitize","nvd3","once","ordinal","rzModule","ui.bootstrap.collapse","ui.bootstrap.datepicker","ui.bootstrap.popover","ui.bootstrap","ui.grid.autoResize","ui.grid.infiniteScroll","ui.grid.moveColumns","ui.grid.pagination","ui.grid.pinning","ui.grid.resizeColumns","ui.grid.saveState","ui.grid.selection","ui.grid","ui.highlight","ui.router.title","ui.router","ui.select","ui.tree","dorg.ui.core","vanillaLazyloadJs"])}(),function(){"use strict";function a(a,b,c,d,e){function f(){var a,b={columns:[],directions:[]},c=m();return c?(a=g(c),a.forEach(function(a){b.columns.push(a.name),b.directions.push(a.direction)}),b):b}function g(a){var b=[];for(var c in a){var d=a[c],e=d.sort;e&&b.push({name:d.name,direction:e.direction,priority:e.priority})}return _.sortByOrder(b,"priority")}function h(a,b){J.columns=a,J.directions=b}function i(){return{eventAttendee:!1,filterText:"",matchTypeFilters:{allResults:{id:d.ALL_RESULTS,displayName:"All Results",selected:!1},matches:{id:d.MATCHES,displayName:"Matches",accuracy:"Match",selected:!0},possibleMatches:{id:d.POSSIBLE_MATCHES,displayName:"Possible Matches",accuracy:"Possible Match",selected:!1},unMatched:{id:d.UN_MATCHED,displayName:"Non-Matches",selected:!1}}}}function j(){return[{name:e.DISPLAY_NAME,displayName:"Company",cellTemplate:'<div class="ui-grid-cell-contents"><company-details-popover company-id="row.entity.id" company-name="{{COL_FIELD}}"></company-details-popover></div>'},{name:e.MATCHED_TERM,displayName:"Matched Term(s)"},{name:e.SEARCHED_TERM,displayName:"Searched Term(s)",width:"50%",sort:{direction:b.ASC}},{name:e.ACCURACY,displayName:"Accuracy",width:90}]}function k(){return[{name:e.COMPANY_NAME,displayName:"Company",cellTemplate:'<div class="ui-grid-cell-contents"><company-details-popover company-id="row.entity.companyId" company-name="{{COL_FIELD}}"></company-details-popover></div>'},{name:e.DISPLAY_NAME,displayName:"Employee",cellTemplate:'<div class="ui-grid-cell-contents"><person-name-with-popover person-id="row.entity.id" person-name="{{COL_FIELD}}"></person-name-with-popover></div>'},{name:e.SEARCHED_TERM,displayName:"Searched Term(s)",cellTemplate:'<div class="ui-grid-cell-contents" title="{{COL_FIELD}}">{{COL_FIELD}}</div>',width:"50%",sort:{direction:b.ASC}},{name:e.ACCURACY,displayName:"Accuracy",width:90}]}function l(){return[{name:e.SCORE,displayName:"Match Score",field:e.SCORE,sort:{direction:b.DESC,priority:G.SECOND},width:105},{name:e.COMPANY_NAME,displayName:"Company",cellTemplate:'<div class="ui-grid-cell-contents"><company-details-popover company-id="row.entity.companyId" company-name="{{COL_FIELD}}"></company-details-popover></div>'},{name:e.DISPLAY_NAME,displayName:"Employee",cellTemplate:'<div class="ui-grid-cell-contents"><person-name-with-popover person-id="row.entity.id" person-name="{{COL_FIELD}}"></person-name-with-popover></div>'},{name:"title",displayName:"Job Title"},{name:e.SEARCHED_TERM,displayName:"Searched Term(s)",width:"40%",sort:{direction:b.ASC,priority:G.FIRST},cellTemplate:'<div class="ui-grid-cell-contents" title="{{COL_FIELD}}">{{COL_FIELD}}</div>'}]}function m(){return u()?o():n()}function n(){var b=null;return b=a.isSelectedSearchTypeCompany()?j():a.isSelectedSearchTypeEventAttendee()?l():k()}function o(){return[{name:"value",displayName:"Non-Matches",sort:{direction:b.ASC}}]}function p(a){D=a}function q(a){E=a}function r(){return K.eventAttendee=a.isSelectedSearchTypeEventAttendee(),K}function s(){return _.find(K.matchTypeFilters,function(a){return a.selected})}function t(){return s().id===d.UN_MATCHED?E&&a.getSelectedResultsMatched():D&&a.getSelectedResultsMatched()}function u(){return s().id===d.UN_MATCHED}function v(a){return x(a.value,K.filterText)}function w(a){return x(a.displayName,K.filterText)||x(a.matchedTerm,K.filterText)||x(a.score&&a.score.displayName,K.filterText)||x(a.companyName,K.filterText)||x(a.searchedTerm,K.filterText)||x(a.title,K.filterText)}function x(a,b){var c=new RegExp(b,"i");return a&&a.search(c)!==-1}function y(a,b){var c;return u()?c=M.text(a):(c=L.selectedMatchType(a),c=L.text(c),c=L.score(c,b)),c}function z(b){return K.matchTypeFilters.matches.selected?!!a.isSelectedSearchTypeEventAttendee()||b.score.displayName===a.PERFECT_MATCH:!K.matchTypeFilters.possibleMatches.selected||b.score.displayName!==a.PERFECT_MATCH}function A(b,c){return!a.isSelectedSearchTypeEventAttendee()||!I||parseInt(b.score)>=parseInt(c)}function B(){K.filterText="",K.matchTypeFilters.allResults.selected=!1,K.matchTypeFilters.matches.selected=!0,K.matchTypeFilters.possibleMatches.selected=!1,K.matchTypeFilters.unMatched.selected=!1,a.resetFilteredResults()}function C(a){return J.columns&&J.directions?_.sortByOrder(a,J.columns,J.directions):a}var D,E,F="BulkMatchResultsFiltered",G={FIRST:1,SECOND:2},H="personlistmatch",I=c.findFeatureFlag(null,H),J={},K=i(),L={selectedMatchType:function(a){return a.filter(z)},text:function(a){return a.filter(w)},score:function(a,b){return a.filter(function(a){return A(a,b)})}},M={selectedMatchType:function(a){return a.filter(z)},text:function(a){return a.filter(v)}};return{RESULTS_FILTERED_EVENT_BUCKET:F,getGridFilters:r,setSortSettings:h,getDefaultSortColumnsAndDirections:f,applyFilters:y,applySort:C,getSelectedMatchTypeFilter:s,getSelectedResultsMatched:t,filterUnMatchedTerm:v,resetFilters:B,getMatchedGridColumnDefs:n,getUnMatchedGridColumnDefinitions:o,registerGetMatchedGrid:p,registerGetUnMatchedGrid:q,isUnmatchedSelectedAsMatchType:u}}a.$inject=["bulkMatchService","uiGridConstants","featureFlagService","MATCH_TYPE_FILTERS","BM_FIELD_NAMES"];var b={DISPLAY_NAME:"displayName",MATCHED_TERM:"matchedTerm",SEARCHED_TERM:"searchedTerm",ACCURACY:"accuracy",SCORE:"score",COMPANY_NAME:"companyName"};angular.module("dorgEuiApp").service("bulkMatchGridService",a).constant("BM_FIELD_NAMES",b)}(),function(){"use strict";function a(a,b,c,d){function e(){b.dismiss("close")}function f(a,c){b.close({isCompany:a,data:c})}function g(a){i.async=!!a}function h(){b.close({runAnother:!0})}var i=this;i.dismiss=e,i.returnCallback=f,i.setAsyncCallback=g,i.runAnotherListMatch=h,i.mode=c.getMode,i.async=!1,c.setIsForOppAlert(d)}a.$inject=["$scope","$uibModalInstance","bulkMatchService","isForOppAlert"],angular.module("dorgEuiApp").controller("bulkMatchModalController",a)}(),function(){"use strict";angular.module("dorgEuiApp").factory("bulkMatchListMatchCompanyProcessor",["stringUtil","MATCH_TYPE_STRINGS",function(a,b){function c(a,b){return a.displayName=a.fullName,a.searchedTerm=a.subjectName,a.matchedTerm=a.textOccurrence,"function"==typeof b&&b(a),a.score={value:a.score,displayName:a.accuracy},a}return function(d){var e=d.numberOfRequests,f=d.numberOfUnmatchedRequests,g=0,h=0,i=_.reduce(d.mapOfMatchedRequests,function(a,d){return _.reduce(d,function(a,d){return a.push(c(d,function(a){a.accuracy=b.PERFECT_MATCH,h++})),a},a)},[]);return _.reduce(d.mapOfPossibleMatchedRequests,function(a,d){return _.reduce(d,function(a,d){return a.push(c(d,function(a){a.accuracy=b.PARTIAL_MATCH,g++})),a},a)},i),{numberOfMatchedTerms:h,numberOfUnmatchedTerms:f,numberOfSearchedTerms:e,numberOfPossibleMatches:g,flattenedMatchedTermsScored:i,unmatchedTerms:_.map(d.unmatchedRequests,function(b){return{value:a.decodeHtml(b.name)}})}}}])}(),function(){"use strict";function a(){function a(){b.bulkMatchResultsDisplayController.addPane(b)}var b=this;b.$onInit=a}a.$inject=[],angular.module("dorgEuiApp").component("bulkMatchResultsDisplayPane",{transclude:!0,require:{bulkMatchResultsDisplayController:"^bulkMatchResultsDisplay"},bindings:{tabDisplayName:"@",paneId:"@"},templateUrl:"app/components/bulkMatch/bulkMatchResults/bulk-match-results-display-pane.tpl.html",controller:a})}(),function(){"use strict";function a(a,b){function c(a){0===f.panes.length&&f.selectPane(a),f.panes.push(a)}function d(a){f.panes.forEach(function(a){a.selected=!1}),a.selected=!0}function e(){a.deregisterUpdateFromEventBucket(b.RESULTS_FILTERED_EVENT_BUCKET,g)}var f=this,g="bulkMatchResultsDisplayControllerBulkMatchResultsFilteredListener";f.panes=[],f.addPane=c,f.selectPane=d,f.$onDestroy=e,a.registerUpdateToEventBucket(b.RESULTS_FILTERED_EVENT_BUCKET,{name:g,func:function(){d("unMatched"===b.getSelectedMatchTypeFilter().id?_.find(f.panes,function(a){return"unMatched"===a.paneId}):_.find(f.panes,function(a){return"matches"===a.paneId}))}})}a.$inject=["eventBusService","bulkMatchGridService"],angular.module("dorgEuiApp").component("bulkMatchResultsDisplay",{transclude:!0,templateUrl:"app/components/bulkMatch/bulkMatchResults/bulk-match-results-display.tpl.html",controller:a})}(),function(){"use strict";function a(a,b,c){function d(d){var f=b.getSelectedMatchTypeFilter();f.displayName!==d&&(e.gridFilters.matchTypeFilters.matches.selected=!1,e.gridFilters.matchTypeFilters.allResults.selected=!1,e.gridFilters.matchTypeFilters.possibleMatches.selected=!1,e.gridFilters.matchTypeFilters.unMatched.selected=!1,d===e.gridFilters.matchTypeFilters.matches.displayName?e.gridFilters.matchTypeFilters.matches.selected=!0:d===e.gridFilters.matchTypeFilters.allResults.displayName?e.gridFilters.matchTypeFilters.allResults.selected=!0:d===e.gridFilters.matchTypeFilters.possibleMatches.displayName?e.gridFilters.matchTypeFilters.possibleMatches.selected=!0:d===e.gridFilters.matchTypeFilters.unMatched.displayName&&(e.gridFilters.matchTypeFilters.unMatched.selected=!0),a.setSelectedMatchTypeFilter(b.getSelectedMatchTypeFilter()),c.invokeEventBucketUpdate(b.RESULTS_FILTERED_EVENT_BUCKET))}var e=this,f=a.getLastBulkMatchSearchResults();e.numberOfSearchedTerms=f.numberOfSearchedTerms,e.numberOfMatchedTerms=f.numberOfMatchedTerms,e.numberOfUnmatchedTerms=f.numberOfUnmatchedTerms,e.numberOfPossibleMatches=f.numberOfPossibleMatches,e.numberOfMatchedResults=f.flattenedMatchedTermsScored.length,e.gridFilters=b.getGridFilters(),e.selectMatchResultOption=d}a.$inject=["bulkMatchService","bulkMatchGridService","eventBusService"],angular.module("dorgEuiApp").component("bulkMatchResultsOptions",{templateUrl:"app/components/bulkMatch/bulkMatchResults/bulk-match-results-options.tpl.html",controller:a})}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(a,b){var c,d,e;e=b.length>0?l(b):f.getDefaultSortColumnsAndDirections(),c=e.columns,d=e.directions,f.setSortSettings(c,d),A()}function l(a){var b=[],d=[],e=a[0];return 1===a.length&&e.field===h.SEARCHED_TERM?(b=[h.SEARCHED_TERM,h.SCORE],d=[e.sort.direction,c.DESC]):a.map(function(a){b.push(a.field),d.push(a.sort.direction)}),{columns:b,directions:d}}function m(a){var b,c=e.getLastBulkMatchSearchResults(),d=c.flattenedMatchedTermsScored,g=O[j.MATCH_TYPES];return f.isUnmatchedSelectedAsMatchType()&&(d=c.unmatchedTerms,g=O[j.NON_MATCHES]),b=f.applyFilters(d,a),b=f.applySort(b),B(b),g.setNewUnderlyingCollection(b),b=g.getNextPage()}function n(a){return H.countOfSliderMatchesShown=0,a.forEach(function(a,b){a.isSelected=e.isResultMatchedSelected(a.entity),H.countOfSliderMatchesShown++}),L||(L=!0,q()),a}function o(a){return H.countOfUnmatchedTermsShown=0,a.forEach(function(a){a.visible=f.filterUnMatchedTerm(a.entity),a.visible&&H.countOfUnmatchedTermsShown++,a.isSelected=e.isResultUnmatchedSelected(a.entity)}),a}function p(a,b,c){return b===c?0:(a-b)/(c-b)*100}function q(){var a=angular.element(document.getElementById("match-precision-slider"));e.getLastBulkMatchSearchResults().flattenedMatchedTermsScored.forEach(function(a){r(a.score)}),a.attr("min",H.lowestScore),a.attr("max",N),H.sliderValue=M>H.lowestScore?M:H.lowestScore,H.backgroundPercent=p(H.sliderValue,H.lowestScore,N),a.val(H.sliderValue),a.on("change",_.debounce(s,500))}function r(a){a<H.lowestScore&&(H.lowestScore=a)}function s(){H.sliderValue=this.value,H.backgroundPercent=p(this.value,this.min,this.max),A()}function t(a){F.grid.selection.selectAll=a}function u(a,b){a.options.data=b,H.countOfSliderMatchesShown=0,a.modifyRows(b)}function v(){var a=e.getCountOfCurrentMatchedMatchType();return H.countOfSliderMatchesShown<a}function w(){return H.countOfUnmatchedTermsShown<H.numberOfUnmatchedTerms}function x(){var a=e.getMatchedFilteredCount();return f.isUnmatchedSelectedAsMatchType()&&(a=e.getUnmatchedFilteredCount()),a}function y(){var a=f.getSelectedMatchTypeFilter().id;H.isSelectedSearchTypeEventAttendee&&a===i.MATCHES&&(a=i.ALL_RESULTS);var b=e.getLastBulkMatchSearchResults();return b.mapOfMatchTypesToNumbers[a]}function z(){return e.getLastBulkMatchSearchResults().flattenedMatchedTermsScored.length}function A(){var a=m(H.sliderValue),b=F,c=O[j.MATCH_TYPES];f.isUnmatchedSelectedAsMatchType()&&(b=G,c=O[j.NON_MATCHES]),u(b.grid,a),t(e.areAllFilteredResultsMatchedSelected()),b.grid.queueGridRefresh(),c.reset()}function B(a){var b=e.setMatchedFilteredResults;f.isUnmatchedSelectedAsMatchType()&&(b=e.setUnmatchedFilteredResults),b(a)}function C(){H.showAdvisory=!1,f.resetFilters(),d.deregisterUpdateFromEventBucket(f.RESULTS_FILTERED_EVENT_BUCKET,J)}function D(){H.showAdvisory=!1}function E(){H.showAdvisory=!1,a.$broadcast("showLMResults","")}var F,G,H=this,I=!1,J="bulkMatchResultsControllerBulkMatchResultsFilteredListener",K="app/components/bulkMatch/bulkMatchResults/_bulk-match-results-match-precision-tooltip.html",L=!1,M=95,N=100,O={};H.isUnmatchedSelectedAsMatchType=f.isUnmatchedSelectedAsMatchType,H.gridFilters=f.getGridFilters(),H.isSelectedSearchTypeEventAttendee=e.isSelectedSearchTypeEventAttendee(),H.numberOfMatchedTerms=0,H.numberOfUnmatchedTerms=0,H.getResultsShowingValue=x,H.getResultsTotalValue=y,H.getFullNumberOfMatchResults=z,H.sortChanged=k,H.searchFilter=_.debounce(A,500),H.$onDestroy=C,H.lowestScore=100,H.sliderValue=M,H.countOfSliderMatchesShown=0,H.countOfUnmatchedTermsShown=0,H.matchPrecisionTooltipPath=K,H.backgroundPercent=0,H.dismissAdvisory=D,H.showAdvisory=!1,H.continueViewInAdvancedSearch=E,H.listMatchType=e.getIsForOppAlert()?"OppAlerts":"Advanced Search",H.matchedGridOptions={useExternalSorting:!0,enableColumnMenus:!1,flatEntityAccess:!0,fastWatch:!0,columnDefs:f.getMatchedGridColumnDefs(),onRegisterApi:function(a){var c,d;e.resetFilteredResults(),F=a,c=f.getDefaultSortColumnsAndDirections(),f.setSortSettings(c.columns,c.directions),H.numberOfMatchedTerms=e.getLastBulkMatchSearchResults().numberOfMatchedTerms,e.setSelectedMatchTypeFilter(f.getSelectedMatchTypeFilter()),F.grid.registerRowsProcessor(n,100),F.selection.on.rowSelectionChanged(null,function(a){e.selectMatchedRow(),a.isSelected?e.addSelectedResultMatched(a.entity):e.removeSelectedResultMatched(a.entity)});var h=function(a){var b=e.getMatchedFilteredResults();F.selection.getSelectAllState()?e.removeSelectedResultsMatchedMultiple(b):e.addSelectedResultsMatchedMultiple(b)};F.selection.on.rowSelectionChangedBatch(null,h);var i=F.grid.api.selection.selectAllVisibleRows;F.grid.api.selection.selectAllVisibleRows=function(a){i(a),F.selection.getSelectedRows().length===F.grid.rows.length&&(F.grid.selection.selectAll=!F.grid.selection.selectAll,h(null))},delete O[j.MATCH_TYPES],d=g.createNewInfiniteScroller(F,e.getMatchedFilteredResults(),v),O[j.MATCH_TYPES]=d,f.registerGetMatchedGrid(function(){return F}),F.core.on.sortChanged(b,H.sortChanged),A(),I||(e.addSelectedResultsMatchedMultiple(e.getMatchedFilteredResults()),t(e.areAllFilteredResultsMatchedSelected()),I=!0)}},H.unMatchedGridOptions={useExternalSorting:!0,enableColumnMenus:!1,flatEntityAccess:!0,fastWatch:!0,columnDefs:f.getUnMatchedGridColumnDefinitions(),onRegisterApi:function(a){var c,d;G=a,e.resetFilteredResults(),c=f.getDefaultSortColumnsAndDirections(),f.setSortSettings(c.columns,c.directions),H.numberOfUnmatchedTerms=e.getLastBulkMatchSearchResults().numberOfUnmatchedTerms,G.grid.registerRowsProcessor(o,100),G.selection.on.rowSelectionChanged(null,function(a){a.isSelected?e.addSelectedResultUnmatched(a.entity):e.removeSelectedResultUnmatched(a.entity)}),G.selection.on.rowSelectionChangedBatch(null,function(a){var b=e.getUnmatchedFilteredResults();G.selection.getSelectAllState()?e.removeSelectedResultsUnmatchedMultiple(b):e.addSelectedResultsUnmatchedMultiple(b)}),delete O[j.NON_MATCHES],d=g.createNewInfiniteScroller(G,e.getUnmatchedFilteredResults(),w),O[j.NON_MATCHES]=d,f.registerGetUnMatchedGrid(function(){return G}),G.core.on.sortChanged(b,H.sortChanged),A()}},d.registerUpdateToEventBucket(f.RESULTS_FILTERED_EVENT_BUCKET,{name:J,func:function(){f.isUnmatchedSelectedAsMatchType()&&G?A():!f.isUnmatchedSelectedAsMatchType()&&F&&A()}}),b.$on("showLMAdvisory",function(){H.showAdvisory=!0})}a.$inject=["$rootScope","$scope","uiGridConstants","eventBusService","bulkMatchService","bulkMatchGridService","infiniteScrollFactory","BM_FIELD_NAMES","MATCH_TYPE_FILTERS","MATCH_CATEGORIES"],angular.module("dorgEuiApp").component("bulkMatchResults",{templateUrl:"app/components/bulkMatch/bulkMatchResults/bulk-match-results.tpl.html",bindings:{countOfSliderMatchesShown:"<",sliderValue:"<",countOfUnmatchedTermsShown:"<",getResultsShowingValue:"<",getResultsTotalValue:"<"},controller:a})}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){return d.isSelectedSearchTypeCompany()}function l(){return r()>U}function m(a,b){P.searching=!0;var e=d.getBulkMatchResults(a,b);return e.then(function(a){return a.async?(P.setAsyncCallback(a.async),c.resolve()):(d.setMode("results"),d.updateViewedByUserFlag(),a)}).catch(function(a){return g.create("error","Something went wrong with your search","fail"),c.reject(a)}).finally(function(a){return P.searching=!1,a})}function n(b){b.stopPropagation(),p()&&(e.getSelectedResultsMatched().length>S?a.$broadcast("showLMAdvisory",""):o())}function o(){if(p()){var a=e.getSelectedResultsMatched().map(function(a){return{displayName:a.displayName,id:a.id}});P.returnCallback(d.isSelectedSearchTypeCompany(),a)}}function p(){return d.getSelectedResultsMatchedSize()>0}function q(){return!C()&&p()}function r(){var a;return a=C()?d.getSelectedResultsUnmatchedSize():d.getSelectedResultsMatchedSize()}function s(){if("person"===u())return d.getPersonSearchCountsForListMatch(t()).then(function(a){return a.data.searchCriteriaScoped})}function t(){return d.getSelectedResultsIdsAsSearchCriteria(B())}function u(){return d.getSelectedSearchType().entityType.toLowerCase()}function v(a){_.each(T,function(b){b.value===a&&(P.matchedTemplateUrl=b.templateUrl)}),_.isEmpty(P.matchedTemplateUrl)&&J()}function w(){J()}function x(){var a,b=d.getSelectedSearchType();b.entityType===d.ENTITY_TYPES.COMPANY?a=[{displayName:"Company",field:"displayName"},{displayName:"MatchedTerm(s)",field:"matchedTerm"},{displayName:"SearchedTerm(s)",field:"searchedTerm"},{displayName:"Accuracy",field:"accuracy"}]:b.entityType===d.ENTITY_TYPES.PERSON&&b.requestValueType===d.FIRST_VALUES_AS_LIST?a=[{displayName:"Employee",field:"displayName"},{displayName:"Job Title",field:"title"},{displayName:"Company",field:"companyName"},{displayName:"SearchedTerm(s)",field:"searchedTerm"},{displayName:"Accuracy",field:"accuracy"}]:b.requestValueType===d.PERSON_TITLE_COMPANY&&(a=[{displayName:"Match Score",field:"score"},{displayName:"Company",field:"companyName"},{displayName:"Employee",field:"displayName"},{displayName:"Job Title",field:"title"},{displayName:"SearchedTerm(s)",field:"searchedTerm"}]),z(e.getSelectedResultsMatched(),"_Matched",a),J()}function y(){var a=[{displayName:"Non-Matches",field:"value"}];z(d.getSelectedResultsUnmatched(),"_Unmatched",a)}function z(a,b,c){var e="";e=d.getSelectedSearchType().requestValueType!==d.PERSON_TITLE_COMPANY?_.startCase(d.getSelectedSearchType().entityType.toLowerCase()):"Person-Title";var h="DiscoverOrg_"+e+b+".csv";f.exportCsvFile(a,h,c)?g.create("success","Your export is complete.","flash"):G({success:!1,message:"Your export failed. Your browser may not support this feature."})}function A(){d.setMode("results"),J()}function B(){return d.getSelectedResultsMatchedIds()}function C(){return e.isUnmatchedSelectedAsMatchType()}function D(){d.saveSavedSearch(B(),P.savedAsName).then(F,G)}function E(){H(P.savedAsName).then(function(a){a&&a.status?I(B(),P.savedAsName).then(F,G):G(a)},G)}function F(a){a.status?(J(),g.create("success",a.message,"flash")):G(a)}function G(a){var b="";b=a&&a.message?a.message:"An unknown error occurred, please try again.",g.create("error",b,"fail")}function H(a){return i.getCompanyLists(h.VAD_PORTFOLIO).then(function(b){var c=_.filter(b,function(b){return b.displayName===a}),d=_.isEmpty(c);return{status:d,message:d?"":"Portfolio name already exists"}})}function I(a,b){return i.createPortfolioWithCompanyIds(b,a).then(function(a){return a&&a.status&&200!==a.status?{status:!1}:{status:!0,message:"Portfolio saved as "+a.config.data.name}},function(){return{status:!1}})}function J(){P.matchedPopoverIsOpen=!1,P.savedAsName="",P.matchedTemplateUrl=d.getIsForOppAlert()?R:Q}function K(){d.reset()}function L(){K(),setTimeout(function(){d.showHistory()},1)}function M(){P.matchedPopoverIsOpen=!P.matchedPopoverIsOpen,P.matchedPopoverIsOpen===!0&&N()}function N(){P.saveAsCSVAdvancedOptionLoading=!0,P.areAllOutOfScope=!1,d.checkAllEntitiesOutOfScope(B()).then(function(a){P.areAllOutOfScope="true"==a.data,P.saveAsCSVAdvancedOptionLoading=!1},function(a){P.areAllOutOfScope=!1,P.saveAsCSVAdvancedOptionLoading=!1})}function O(){j.deregisterUpdateFromEventBucket(d.SELECT_MATCHED_ROW_EVENT_BUCKET,V)}var P=this,Q="app/components/bulkMatch/bulkMatchRoot/popovers/matched-save-as-options.tpl.html",R="app/components/bulkMatch/bulkMatchRoot/popovers/oppalert-matched-save-as-options.tpl.html",S=1e4,T=[{value:"CSV"},{value:"SAVED_SEARCH",templateUrl:"app/components/bulkMatch/bulkMatchRoot/popovers/saved-search.tpl.html"},{value:"LIST",templateUrl:"app/components/bulkMatch/bulkMatchRoot/popovers/list.tpl.html"},{value:"PORTFOLIO",templateUrl:"app/components/bulkMatch/bulkMatchRoot/popovers/portfolio.tpl.html"}],U=5e3,V="selectResultGridEventListener";b.$on("showResultsPage",A),P.areAllOutOfScope=!1,P.saveAsCSVAdvancedOptionLoading=!0,P.searching=!1,P.mode=d.getMode,P.searchResults=null,P.requestBulkMatch=m,P.viewInAnotherPageLabel=d.getIsForOppAlert()?"View in OppAlerts":"View in Advanced Search",P.viewInAdvancedSearchOrOppAlert=n,P.areResultsSelected=p,P.areResultsSelectedForMatched=q,P.numberResultsSelected=r,P.countTotalItems=s,P.saveAsTypeSelect=v,P.saveAsCancel=w,P.savedAsName="",P.matchedTemplateUrl=d.getIsForOppAlert()?R:Q,P.matchedPopoverIsOpen=!1,P.getSelectedResultsMatchedIds=B,P.getSelectedResultsIdsAsSearchCriteria=t,P.entityType=u,P.resetPopover=J,P.isSelectedSearchTypeCompany=k,P.saveAsMatchedCsv=x,P.saveAsSavedSearch=D,P.saveAsPortfolio=E,P.saveAsUnmatchedCsv=y,P.saveAsSubmitSuccess=F,P.isUnmatchedSelectedAsMatchType=C,P.resetBulkMatch=K,P.isOverSaveAsThreshold=l,P.showLMHistoryPane=L,P.processSaveAsFeature=M,P.$onDestroy=O,j.registerUpdateToEventBucket(d.SELECT_MATCHED_ROW_EVENT_BUCKET,{name:V,func:function(){J()}}),b.$on("showLMResults",function(){o()})}a.$inject=["$rootScope","$scope","$q","bulkMatchService","bulkMatchGridService","csvDownload","Flash","dorgConfig","AbmService","eventBusService"],angular.module("dorgEuiApp").component("bulkMatchRoot",{transclude:!0,bindings:{returnCallback:"=",setAsyncCallback:"="},templateUrl:"app/components/bulkMatch/bulkMatchRoot/bulk-match-root.tpl.html",controller:a})}(),function(){"use strict";function a(a,b){function c(){return"csv"===h.paneId}function d(){return"history"===h.paneId}function e(){return!b.getSelectedSearchType().csvUploadOnly||(c()||d())}function f(){a.deregisterUpdateFromEventBucket(b.BULK_MATCH_CSV_UPLOAD_ONLY_SEARCH_TYPE_SELECTED,i)}function g(){var a=b.getSelectedSearchType();return a.displayName}var h=this,i="bulkMatchInputPaneControllerCSVUploadOnlySearchTypeSelectedListener";h.isSelectable=e,h.$onDestroy=f,h.selectedSearchType=g,h.$onInit=function(){h.bulkMatchSearchInputController.addPane(h),c()&&a.registerUpdateToEventBucket(b.BULK_MATCH_CSV_UPLOAD_ONLY_SEARCH_TYPE_SELECTED,{name:i,func:function(){h.bulkMatchSearchInputController.selectPane(h)}})}}a.$inject=["eventBusService","bulkMatchService"],angular.module("dorgEuiApp").component("bulkMatchSearchInputPane",{transclude:!0,require:{bulkMatchSearchInputController:"^bulkMatchSearchInput"},bindings:{tabDisplayName:"@",paneId:"@",paneTitle:"@"},templateUrl:"app/components/bulkMatch/bulkMatchSearch/bulk-match-search-input-pane.tpl.html",controller:a})}(),function(){"use strict";function a(a,b,c,d,e,f){function g(a){j()||n.selectPane(a),n.panes.push(a)}function h(a){var c=a.isSelectable();n.isSearchButtonShown="history"!==a.paneId&&c,c&&(b.$broadcast("paneSelected",{paneId:a.paneId}),n.panes.forEach(function(a){a.active=!1}),a.active=!0)}function i(){return _.find(n.panes,function(a){return"history"===a.paneId})}function j(){return _.find(n.panes,function(a){return a.active})}function k(){l()&&n.bulkMatchSearchController.performSearch(j())}function l(){var a=j();return a&&n.bulkMatchSearchController.isSearchEnabled(a)}function m(){e.checkNotifications(),c.deregisterUpdateFromEventBucket(d.SWITCH_TO_LIST_VIEW,o)}var n=this,o="bulkMatchSearchInputControllerSwitchToListViewEventName";n.$onDestroy=m,n.panes=[],n.addPane=g,n.selectPane=h,n.performSearch=k,n.isSearchEnabled=l,n.isSearchButtonShown=!0,n.listMatchNotifications=!1,a.$on("import-event-button-disabled",function(a,b){n.importEventButtonDisabled=b}),e.checkNotifications(),c.registerUpdateToEventBucket(d.SWITCH_TO_LIST_VIEW,{name:o,func:function(){n.selectPane(n.panes[0])}}),a.$on("listMatchNotification",function(a,b){n.listMatchNotifications=d.hasUnviewedListMatchNotification(b,d.getIsForOppAlert())}),b.$on("showImportHistory",function(a,b){f(function(){h(i())},500)})}a.$inject=["$scope","$rootScope","eventBusService","bulkMatchService","NotificationService","$timeout"],angular.module("dorgEuiApp").component("bulkMatchSearchInput",{transclude:!0,require:{bulkMatchSearchController:"^bulkMatchSearch"},templateUrl:"app/components/bulkMatch/bulkMatchSearch/bulk-match-search-input.tpl.html",controller:a})}(),function(){"use strict";function a(a,b){function c(){return e.currentPanelText}function d(){return e.currentPanelHeader}var e=this;e.getPanelText=c,e.getPanelHeader=d,e.searchTypes=a.getSearchTypeOptions(),e.selectedSearchType=a.getSelectedSearchType(),e.selectSearchType=a.selectSearchType;var f="Enter or upload your list of data and ListMatch instantly searches for matches from ZoomInfo.";f+=" Matched results can be saved in multiple formats, or viewed in Advanced Search to be filtered, followed, or uploaded to your connected tools.";var g="Your previous imports are listed to the right with the most recent one displayed on top. Click the link to view the results from your import.",h="ListMatch",i="Import History";e.currentPanelText=f,e.currentPanelHeader=h,b.$on("paneSelected",function(a,b){"history"===b.paneId?(e.currentPanelText=g,e.currentPanelHeader=i):(e.currentPanelText=f,e.currentPanelHeader=h)}),b.$on("selected-search-type",function(a,b){e.selectedSearchType=b})}a.$inject=["bulkMatchService","$scope"],angular.module("dorgEuiApp").component("bulkMatchSearchOptions",{templateUrl:"app/components/bulkMatch/bulkMatchSearch/bulk-match-search-options.tpl.html",controller:a})}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(){return a.isSelectedSearchTypeEventAttendee()}function j(){return"Import Instructions"}function k(){var b=a.getSelectedSearchType();!_.isUndefined(b.csvUploadOnly)&&b.csvUploadOnly?H.importEventButtonDisabled=!0:H.importEventButtonDisabled=!1,g.$broadcast("import-event-button-disabled",H.importEventButtonDisabled);var c=b.value,d=b.entityType,e={listText:"",csvText:""};switch(c){case"NAME":e.listText="Company Names",e.csvText="<strong>Company Name</strong> (must be in <strong>column A</strong>)";break;case"DOMAIN":e.listText="Company Websites / URLs / Domains",e.csvText="<strong>Company Websites / URLs / Domains</strong> (must be in <strong>column A</strong>)";break;case"PARENT_DUNS":e.listText="Parent DUNS",e.csvText="<strong>Parent DUNS</strong> (must be in <strong>column A</strong>)";break;case"PRIMARY_DUNS":e.listText="Primary DUNS",e.csvText="<strong>Primary DUNS</strong> (must be in <strong>column A</strong>)";break;case"ID":"company"===d?(e.listText="DiscoverOrg Company IDs",e.csvText="<strong>DiscoverOrg Company IDs</strong> (must be in <strong>column A</strong>)"):(e.listText="DiscoverOrg Employee IDs",e.csvText="<strong>DiscoverOrg Employee IDs</strong> (must be in <strong>column A</strong>)");break;case"EMAIL":e.listText="Employee Email Addresses",e.csvText="<strong>Employee Email Addresses</strong> (must be in <strong>column A</strong>)";break;case"NAME_TITLE_COMPANYNAME":e.listText="Employee Name OR Title",e.csvText=""}return e}function l(){return a.getSelectedSearchType().inputLimit}function m(){var b=a.getSelectedSearchType();return _.isEmpty(b.csvFileFormatMessage)?b.displayName+" in Column&nbsp;A":b.csvFileFormatMessage}function n(b){var c,d=a.getSelectedSearchType(),f=b.paneId;switch(f){case"list":c=q(H.listEntry),a.sendSearchExecuteEvent();break;case"csv":var g=H.csvIncludesHeader?H.lastImportLines.splice(1):H.lastImportLines;c=r(d,g),a.sendSearchExecuteEvent();break;case"history":break;default:return void console.error("Somehow there is no known selected pane")}o(c,b.paneId,l())&&(H.bulkMatchRootController.requestBulkMatch(d.value,c),e.enableCheckListMatchNotifications())}function o(a,b,c){return!(a.length>c||a.length<1)||(y({errorType:0===a.length?"EMPTY":"EXCEED_LIMIT",inputType:b,message:0===a.length?"You must enter at least one item.":"You have exceeded the "+d("number")(c)+" entry limit."}),!1)}function p(a){switch(a.paneId){case"list":return _.size(H.listEntry)>0&&H.isListEntryDirty;case"csv":var b=H.csvIncludesHeader?1:0;return _.size(H.lastImportLines)>b;default:return console.error("Somehow there is no known selected pane"),!1}}function q(a){return a&&(a=a.replace(/"/g,"")),_.uniq(_.words(a,/[^;\n\t]+/g),_.trim)}function r(b,c){if(a.FIRST_VALUES_AS_LIST===b.requestValueType)return s(c);if(a.PERSON_TITLE_COMPANY===b.requestValueType){for(var d=[],e=0;e<c.length;e++){var f=c[e];""===f.c1||""===f.c2&&""===f.c3||d.push({personName:f.c2?f.c2.replace(/"/g,""):"",personTitle:f.c3?f.c3.replace(/"/g,""):"",companyName:f.c1?f.c1.replace(/"/g,""):""})}return d}return console.error("Unimplemented type "+b.displayName),[]}function s(a){var b=_.filter(a,function(a){return!_.isEmpty(a.c1)});return _.uniq(_.map(b,function(a){return a.c1}))}function t(b){H.loading=!0,C(b),H.csvErrorMessages=[],a.filesParse(b,u,y)}function u(b){c(function(){var c=a.processData(b.target.result);H.lastImportLines=v(c,function(a){H.csvErrorMessages=[J].concat(a.map(function(a){return a.message}))}),D(H.lastImportLines,M),A(!1),H.loading=!1})}function v(a,b){var c=[],d=[];return J="",a.length<=0?d.push({message:"You must search for at least one line item."}):i()?w(a)?a.length<=1?d.push({message:"Your import failed due to no data rows."}):(J=I,_.forEach(a,function(a,b){var e=x(a);e>=K?c.push(a):0!==e&&d.push({message:"Row "+(b+1)+" must contain at least "+K+" values."})}),H.csvIncludesHeader=!0):d.push({message:"Your import failed due to an incorrect header. Please follow template provided."}):c=a,d.length>0&&b(d),c}function w(a){return"Company Name"===a[0].c1&&("Employee Full Name"===a[0].c2&&"Employee Title"===a[0].c3)}function x(b){return Object.keys(b).reduce(function(c,d){return c+(a.isValidCellValue(b[d])?1:0)},0)}function y(a){c(function(){H.loading=!1;var b,c=a&&"csv"===a.inputType?"csv":"list";"csv"===c?z():"list"===c&&(H.isListEntryDirty=!1),b="csv"===c?H.csvErrorMessages:H.listErrorMessages,a&&a.message?b.push(a.message):b.push("ListMatch Error - Please try again.")})}function z(){B(),A(!0)}function A(a){H.csvInputMode=a}function B(){H.listEntry="",H.csvEntry="",
H.listErrorMessages=[],H.csvErrorMessages=[],H.csvFileName="",H.loading=!1,H.csvIncludesHeader=!1,H.csvFileName="",H.lastImportLines=[]}function C(a){H.csvFileName=_.map(a,"name").join(", ")}function D(a,b){H.previewGrid.columnDefs=b,H.previewGrid.data=_.slice(a,0,9)}function E(){b.deregisterUpdateFromEventBucket(a.SEARCH_TYPE_CHANGED,L)}function F(){var b=a.searchTypes,c={};_.forEach(b,function(a){a.displayName===f.EVENT_ATTENDEE_DISPLAY_NAME&&(c=a)}),a.selectSearchType(c),g.$broadcast("selected-search-type",c)}function G(){H.isListEntryDirty=!0}var H=this,I="Rows that do not meet the above criteria have been removed.",J=I,K=2,L="bulkMatchSearchControllerUpdateSearchTypeEventName",M=[{name:"c1",displayName:"A"},{name:"c2",displayName:"B",minWidth:154},{name:"c3",displayName:"C"}];H.$onDestroy=E,H.listEntry="",H.csvEntry="",H.isListEntryDirty=!0,H.performSearch=_.debounce(n,100),H.isSearchEnabled=p,H.getSearchLimit=l,H.getInstructionText=k,H.getInstructionTextHeader=j,H.importEventList=F,H.lastImportLines=[],H.parseCSV=t,H.isSelectedSearchTypeEventAttendee=i,H.changeListEntry=G,H.listErrorMessages=[],H.csvErrorMessages=[],H.csvInputMode=!0,H.csvIncludesHeader=!1,H.csvFileName="",H.csvFileFormatMessage=m,H.loading=!1,H.importEventButtonDisabled=!1,H.previewGrid={enableHorizontalScrollbar:0,enableVerticalScrollbar:0,enableSorting:!1,onRegisterApi:function(a){D(H.lastImportLines,M)}},H.isForOppAlert=a.getIsForOppAlert(),b.registerUpdateToEventBucket(a.SEARCH_TYPE_CHANGED,{name:L,func:function(){B(),A(!0),i()||b.invokeEventBucketUpdate(a.SWITCH_TO_LIST_VIEW)}})}a.$inject=["bulkMatchService","eventBusService","$timeout","$filter","NotificationService","dorgConfig","$rootScope","$scope"],angular.module("dorgEuiApp").component("bulkMatchSearch",{transclude:!0,require:{bulkMatchRootController:"^bulkMatchRoot"},templateUrl:"app/components/bulkMatch/bulkMatchSearch/bulk-match-search.tpl.html",controller:a})}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(){var a='<div class="ui-grid-cell-contents">';return a+="<span ng-class=\"{ 'as-link': !row.entity.failedFl && row.entity.dateTimeProcessed }\"",a+='ng-click="!row.entity.dateTimeProcessed || grid.appScope.openResultsPage(row.entity)">',a+='{{ row.entity.importHistoryLinkName }} {{row.entity.dateTimeSubmitted|date:"MM/dd/yyyy"}}</span><span>&nbsp&nbsp&nbsp</span>',a+='<span class="ihBadge" ng-if="row.entity.failedFl">Failed</span>',a+='<span class="ihBadge" ng-if="!row.entity.failedFl && !row.entity.dateTimeProcessed">Processing</span>',a+='<span class="ihBadge" ng-if="!row.entity.failedFl && row.entity.dateTimeProcessed && !row.entity.viewedByUserFl">New</span>',a+="</div>"}function i(a){return a}function j(){return[{field:"requestType",displayName:"Import",width:"40%",headerCellClass:"grid-text-align-left",cellTemplate:h()},{field:"listSize",cellFilter:"numberDashFilter:this",headerCellClass:"grid-text-align-right",cellClass:"grid-text-align-right-padding",displayName:"Total Records"},{field:"totalMatched",cellFilter:"numberDashFilter:this",headerCellClass:"grid-text-align-right",cellClass:"grid-text-align-right-padding",displayName:"Matches"},{field:"totalPossibleMatched",cellFilter:"numberDashFilter:this",headerCellClass:"grid-text-align-right",cellClass:"grid-text-align-right-padding",displayName:"Possible Matches"},{field:"totalUnmatched",cellFilter:"numberDashFilter:this",headerCellClass:"grid-text-align-right",cellClass:"grid-text-align-right-padding",displayName:"Unmatched Terms"},{field:"id",visible:!1}]}function k(){f.registerUpdateToEventBucket(A,{name:B,func:o})}function l(){a.$emit("showResultsPage")}function m(a){return y.spinnerActive=!0,b.sendRetrieveRequestWithId(a.id).then(function(c){return b.getRetrievedBPSDataAndSetServiceWithData(c,a.requestType)}).then(function(c){return b.selectSearchTypeByRequestType(a.requestType),l(),b.updateViewedByUserFlag(a.id),c}).catch(function(a){return e.create("error","Something went wrong with your search","fail"),$q.reject(a)}).finally(function(a){return y.spinnerActive=!1,y.searching=!1,a})}function n(){p(),b.getBulkMatchHistory().then(u).then(v)}function o(){q(E),s()}function p(){r(),q()}function q(a){a=a||[],y.historyGridOptions.data=a,y.gridApi.grid.queueGridRefresh()}function r(){y.spinnerActive=!0}function s(){y.spinnerActive=!1}function t(a){return a>=1?" ("+a+")":""}function u(a){E=b.getIsForOppAlert()?x(a):a;var d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0;_.forEachRight(a,function(a,b){switch(a.importHistoryLinkName=a.requestType,a.requestType){case"COMPANY_NAME":a.importHistoryLinkName="Company Name"+t(d++);break;case"COMPANY_WEBSITE":a.importHistoryLinkName="Company Website"+t(e++);break;case"PARENT_DUNS":a.importHistoryLinkName="Parent DUNS"+t(g++);break;case"PRIMARY_DUNS":a.importHistoryLinkName="Primary DUNS"+t(h++);break;case"COMPANY_ID":a.importHistoryLinkName="DiscoverOrg Company IDs"+t(j++);break;case"EMPLOYEE_ID":a.importHistoryLinkName="DiscoverOrg Employee IDs"+t(i++);break;case"EMPLOYEE_EMAIL_ADDRESS":a.importHistoryLinkName="Employee Email Address"+t(f++);break;case"PERSON_NAME_AND_OR_TITLE":a.importHistoryLinkName=c.EVENT_ATTENDEE_DISPLAY_NAME+t(k++)}a.failedFl&&(a.totalMatched=a.totalPossibleMatched=a.totalProcessed=a.totalUnmatched="-")}),H()}function v(){f.invokeEventBucketUpdate(A)}function w(){g.enableCheckListMatchNotifications(),G(),f.deregisterUpdateFromEventBucket(A,B)}function x(a){var c=_.map(b.getSearchTypeOptions(),"euiRequestType");return _.filter(a,function(a){return _.includes(c,a.requestType)})}var y=this,z="history",A="IMPORT_HISTORY",B="import_history_refresh";y.$onInit=k,y.$onDestroy=w,y.refreshHistoryGrid=n,y.importLinkName=i,y.spinnerActive=!1;var C,D=j(),E=null,F=3e4,G=function(){d.cancel(C)},H=function(){G(),C=d(n,F)};y.historyGridOptions={enableSorting:!1,enableFiltering:!1,appScopeProvider:{openResultsPage:m},columnDefs:D,enableColumnMenus:!1,onRegisterApi:function(a){y.gridApi=a}},a.$on("paneSelected",function(a,b){b.paneId===z&&n()})}a.$inject=["$scope","bulkMatchService","dorgConfig","$timeout","Flash","eventBusService","NotificationService"],angular.module("dorgEuiApp").component("importHistory",{transclude:!0,bindings:{},templateUrl:"app/components/bulkMatch/bulkMatchSearch/import-history.tpl.html",controller:a}).filter("numberDashFilter",function(){return function(a,b){return b.row.entity.dateTimeProcessed?a.toLocaleString():"â"}})}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a){ub=a}function o(){return ub}function p(a){if(null!==a){var b=pa(a.flattenedMatchedTermsScored,a.numberOfMatchedTerms,a.numberOfUnmatchedTerms,a.numberOfPossibleMatches);ob=_.assign({mapOfMatchTypesToNumbers:b},a)}V(),s()}function q(a){kb=a}function r(a){lb=a}function s(){q(ob&&ob.flattenedMatchedTermsScored?ob.flattenedMatchedTermsScored:[])}function t(){return kb}function u(){return lb}function v(a){mb=a.accuracy,nb=a.id}function w(){a.$broadcast("showImportHistory","")}function x(){return vb}function y(a){vb=a}function z(){return ob}function A(a){return Object.values(a.mapHashToResult)}function B(){return A(Oa)}function C(){return A(Pa)}function D(){var a=[];for(var b in Oa.mapHashToResult)a.push(Oa.mapHashToResult[b].id);return a}function E(a){return a.size}function F(){return E(Oa)}function G(){return E(Pa)}function H(){for(var a=!0,b=0;b<kb.length;b++)if(!K(kb[b])){a=!1;break}return a}function I(a){return"entityId:"+a.id+" - searchedTerm:"+a.searchedTerm}function J(a,b){return b.mapHashToResult.hasOwnProperty(a)}function K(a){return J(I(a),Oa)}function L(a){return J(a.value,Pa)}function M(a){K(a)||(Oa.mapHashToResult[I(a)]=a,Oa.size++)}function N(a){L(a)||(Pa.mapHashToResult[a.value]=a,Pa.size++)}function O(a){for(var b=0;b<a.length;b++)M(a[b])}function P(a){for(var b=0;b<a.length;b++)N(a[b])}function Q(a){K(a)&&(delete Oa.mapHashToResult[I(a)],Oa.size--)}function R(a){L(a)&&(delete Pa.mapHashToResult[a.value],Pa.size--)}function S(a){for(var b=0;b<a.length;b++)Q(a[b])}function T(a){for(var b=0;b<a.length;b++)R(a[b])}function U(){return{size:0,mapHashToResult:{}}}function V(){Oa=U(),Pa=U()}function W(a){sb.forEach(function(a){a.selected=!1}),a.selected=!0,a.csvUploadOnly&&e.invokeEventBucketUpdate($a),e.invokeEventBucketUpdate(_a)}function X(){var a=Fa(),b=_.find(a,function(a){return a.selected});return b?b:(aa(a[0].euiRequestType),a[0])}function Y(a){return $(function(b){return b.euiRequestType===a})}function Z(a){return $(function(b){return b.value===a})}function $(a){return _.find(sb,a)}function aa(a){var b=_.find(sb,function(b){return b.euiRequestType===a});W(b)}function ba(a,b){hb=!1;var d=ca(),e=da(a,b);return c.race([e,d]).catch(la)}function ca(){return i(function(){return hb=!0,c.reject({async:!0})},Ra)}function da(a,b){var d=Z(a);return ga(a,b).then(function(a){if(a.status!==Ta.OK)return c.reject("trouble submitting the batch job")}).then(function(){return ea(d)})}function ea(a){return i(function(){},Sa).then(ha).then(function(b){var d=b.data[0];return d?(d.numberOfRequests&&"function"==typeof a.processor?p(a.processor(d)):d.numberOfRequests?(aa(tb.euiRequestType),p(na(d))):p(ma(d)),ob):hb?c.reject("trouble retrieving the batch job"):ea()})}function fa(a,b){var d=a.data[0];if(d){var e=Y(b);return d.numberOfRequests&&"function"==typeof e.processor?p(e.processor(d)):d.numberOfRequests?(aa(tb.euiRequestType),p(na(d))):p(ma(d)),c.when(ob)}return c.reject("Data is not available yet")}function ga(a,c){var d=d||X().entityType,e=Ya.SUBMIT+"/"+d.toLowerCase();return gb.indexOf(a)>=0&&(e+="/v2"),b.post(e,c,{params:{matchPropertyType:a}})}function ha(){var a=Ya.RETRIEVE;return b.get(a)}function ia(a){var c=Ya.RETRIEVE;return b.get(c,{params:{id:a}})}function ja(){return _.size(kb)}function ka(){return _.size(lb)}function la(a){return a.async?c.when(a):c.reject(a.data.message)}function ma(a){var b=_.size(a.matchedTermsScored),c=0,d=_.size(a.unMatchedTerms),e=0,f=_.reduce(a.matchedTermsScored,function(a,b,d){return _.reduce(b,function(a,b){return b.searchedTerm=d,b.accuracy=b.score.displayName,b&&(b.score.displayName===k.PERFECT_MATCH?c++:e++),a.push(b),a},a)},[]);return{numberOfMatchedTerms:c,numberOfUnmatchedTerms:d,numberOfSearchedTerms:b,numberOfPossibleMatches:e,flattenedMatchedTermsScored:f,unmatchedTerms:qa(a.unMatchedTerms)}}function na(a){var b=a.numberOfRequests,c=a.numberOfMatchedRequests,d=a.numberOfUnmatchedRequests,e=0,f=_.reduce(a.mapOfMatchedRequests,function(a,b,c){return _.reduce(b,function(a,b){return b.searchedTerm=c,b.displayName=b.fullName,b.companyName=b.company.name,b.companyId=b.company.id,b.score>0?b.accuracy=k.PERFECT_MATCH:b.accuracy=k.PARTIAL_MATCH,a.push(b),a},a)},[]);return{numberOfMatchedTerms:c,numberOfUnmatchedTerms:d,numberOfSearchedTerms:b,numberOfPossibleMatches:e,flattenedMatchedTermsScored:f,unmatchedTerms:ra(a.unmatchedRequests)}}function oa(){return Ba()?ob.mapOfMatchTypesToNumbers[j.ALL_RESULTS]:ob.mapOfMatchTypesToNumbers[nb]}function pa(a,b,c,d){var e={};return e[j.ALL_RESULTS]=a.length,e[j.MATCHES]=b,e[j.UN_MATCHED]=c,e[j.POSSIBLE_MATCHES]=d,e}function qa(a){return a.map(function(a){return{value:f.decodeHtml(a)}})}function ra(a){return a.map(function(a){return{value:f.decodeHtml(a.companyName+"|"+a.personName+"|"+a.personTitle)}})}function sa(a,b,c){var d=!1;_.each(a,function(a){if("text/csv"===a.type)try{ua(a,b,c),d=!0}catch(a){d=!1}else{var e=a.name.split(".");if("csv"===e[e.length-1])try{ua(a,b,c),d=!0}catch(a){d=!1}}}),d||c({errorType:"INVALID_CSV_FILE",message:"Only .csv Files Accepted",inputType:"csv"})}function ta(a){var b=[],c=f.csvToArray(a);return _.each(c,function(a){for(var c={},d=0;d<a.length&&d<3;d++){var e=a[d];_.isEmpty(e)&&(e=""),e=e.replace(/^"+|"+$/g,"").replace(/"/g,""),c["c"+(d+1)]=e}Na(c.c1)&&b.push(c)}),b}function ua(a,b,c){var d=new FileReader;d.readAsText(a),d.onload=b,d.onerror=c}function va(a,b){var c={name:b,searchCriteria:wa(a)};return ub?(c.searchCriteria=m.setDefaultOppAlertSearchCriteria(c.searchCriteria),m.saveThisSearch(c).then(xa,ya)):g.saveThisSearch(c).then(xa,ya)}function wa(a){var b={};return X().entityType===db.COMPANY?b.companyIds=a:b.personIds=a,b}function xa(a){return a&&a.status&&200!==a.status?ya(a):{status:!0,message:"Search Successfully saved as "+a.displayName}}function ya(a){return{status:!1}}function za(a){return _.uniq(_.pluck(a,"id"))}function Aa(){var a=X();return a&&db.COMPANY===a.entityType}function Ba(){var a=X();return a&&eb===a.value}function Ca(){p(null),vb="search"}function Da(){var a="api/rest/bulkmatchhistory";return b.get(a).then(function(a){return a.data&&a.data.success?a.data.data:c.reject(a.errors)}).catch(function(a){return c.reject(a.errors)})}function Ea(a){var c="api/rest/notifications/viewed-list-match";a&&(c+="?id="+a),b.post(c)}function Fa(){return ub?_.filter(sb,{isForOppAlertListMatch:ub}):sb}function Ga(a){var b=_.filter(sb,{isForOppAlertListMatch:!0});return _.any(b,{euiRequestType:a})}function Ha(a,b){if(!a||!a.isUnviewed)return!1;if(!b)return a.isUnviewed;if(!_.isEmpty(a.unviewedListMatchResults)){var c=_.map(_.filter(sb,{isForOppAlertListMatch:!0}),"euiRequestType"),d=_.findIndex(a.unviewedListMatchResults,function(a){return _.includes(c,a.requestType)});return d>-1}}function Ia(){return b.post(Za).then(angular.noop)}function Ja(a){return g.getPersonSearchCounts(a)}function Ka(a){b.post("api/rest/notifications/notifications-list-unviewed",a)}function La(a){var d=X().entityType;if(null!=d&&null!=a){var e="";return d===db.COMPANY?e=Va:d===db.PERSON&&(e=Wa),""===e?c.reject("Access scope path is empty"):b.post(e,a)}return c.reject("Search type and entity ids are empty")}function Ma(){e.invokeEventBucketUpdate(Xa)}function Na(a){var b=_.trim(a);return!_.isEmpty(b)&&!_.isEqual(b.toUpperCase(),Qa)}var Oa,Pa,Qa="NULL",Ra=5e3,Sa=2e3,Ta={OK:200},Ua="api/rest/listmatch/",Va="api/rest/companies/allOutOfScope",Wa="api/rest/persons/allOutOfScope",Xa="selecMatchedRowEventBucket",Ya={SUBMIT:Ua+"submit",RETRIEVE:Ua+"retrieve"},Za=Ua+"event/track",$a="BulkMatchCSVOnlySearchTypeSelected",_a="BulkMatchSearchTypeChanged",ab="BulkMatchSwitchToListView",bb="FIRST_VALUES_AS_LIST",cb="PERSON_TITLE_COMPANY",db={COMPANY:"company",PERSON:"person"},eb="NAME_TITLE_COMPANYNAME",fb="NAME",gb=[eb,fb],hb=!1,ib="",jb="";V();var kb=[],lb=[],mb="",nb="",ob=null,pb=20,qb="PARENT_DUNS",rb="PRIMARY_DUNS",sb=[{displayName:"Company Name",value:fb,selected:!0,entityType:db.COMPANY,requestValueType:bb,inputLimit:d.LIST_MATCH_COMPANY_NAME_SEARCH_LIMIT,euiRequestType:"COMPANY_NAME",processor:l,isForOppAlertListMatch:!0},{displayName:"Company Website",value:"DOMAIN",entityType:db.COMPANY,requestValueType:bb,inputLimit:d.LIST_MATCH_COMPANY_WEBSITE_SEARCH_LIMIT,euiRequestType:"COMPANY_WEBSITE",isForOppAlertListMatch:!0},{displayName:"Parent DUNS",value:qb,entityType:db.COMPANY,requestValueType:bb,inputLimit:d.LIST_MATCH_PARENT_DUNS_SEARCH_LIMIT,euiRequestType:qb,isForOppAlertListMatch:!0},{displayName:"Primary DUNS",value:rb,entityType:db.COMPANY,requestValueType:bb,inputLimit:d.LIST_MATCH_PRIMARY_DUNS_SEARCH_LIMIT,euiRequestType:rb,isForOppAlertListMatch:!0},{displayName:"DiscoverOrg Company ID",value:"ID",entityType:db.COMPANY,requestValueType:bb,inputLimit:d.LIST_MATCH_COMPANY_ID_SEARCH_LIMIT,euiRequestType:"COMPANY_ID",isForOppAlertListMatch:!0},{displayName:"DiscoverOrg Employee IDs",value:"ID",entityType:db.PERSON,requestValueType:bb,inputLimit:d.LIST_MATCH_EMPLOYEE_ID_SEARCH_LIMIT,euiRequestType:"EMPLOYEE_ID",isForOppAlertListMatch:!1},{displayName:"Employee Email Addresses",value:"EMAIL",entityType:db.PERSON,requestValueType:bb,inputLimit:d.LIST_MATCH_EMPLOYEE_EMAIL_SEARCH_LIMIT,euiRequestType:"EMPLOYEE_EMAIL_ADDRESS",isForOppAlertListMatch:!1}],tb={displayName:d.EVENT_ATTENDEE_DISPLAY_NAME,value:"NAME_TITLE_COMPANYNAME",entityType:db.PERSON,requestValueType:cb,csvUploadOnly:!0,inputLimit:d.LIST_MATCH_EVENT_LIST_SEARCH_LIMIT,csvFileFormatMessage:'<span class="info">Company Name in Column A, Employee Name in Column B, and Employee Title in Column C</span><p class="info">Note: Company Name plus any combination of Employee Name or Employee Title MUST be present to successfully complete the search.</p>',euiRequestType:"PERSON_NAME_AND_OR_TITLE"},ub=!1,vb="search";return h.getFeatureFlags().then(function(a){var b=_.findWhere(a.data,{name:"personlistmatch"});b&&b.active&&sb.push(tb);var c=_.findWhere(a.data,{name:"hide_listmatch_duns"});c&&c.active&&(sb=_.filter(sb,function(a){return a.value!==qb&&a.value!==rb}))}),{ENTITY_TYPES:db,EVENT_ATTENDEE:eb,FIRST_VALUES_AS_LIST:bb,PERSON_TITLE_COMPANY:cb,PERFECT_MATCH:k.PERFECT_MATCH,BULK_MATCH_CSV_UPLOAD_ONLY_SEARCH_TYPE_SELECTED:$a,SEARCH_TYPE_CHANGED:_a,SWITCH_TO_LIST_VIEW:ab,SELECT_MATCHED_ROW_EVENT_BUCKET:Xa,searchTypes:sb,panelText:ib,panelHeader:jb,getLastBulkMatchSearchResults:z,resultsPageSize:pb,getBulkMatchHistory:Da,selectSearchType:W,getSelectedSearchType:X,getBulkMatchResults:ba,sendRetrieveRequestWithId:ia,getRetrievedBPSDataAndSetServiceWithData:fa,processData:ta,filesParse:sa,saveSavedSearch:va,getIdsFromObjects:za,isSelectedSearchTypeCompany:Aa,isSelectedSearchTypeEventAttendee:Ba,getSelectedResultsIdsAsSearchCriteria:wa,setMode:y,getMode:x,reset:Ca,selectSearchTypeByRequestType:aa,getSelectedResultsMatched:B,getSelectedResultsUnmatched:C,getSelectedResultsMatchedSize:F,getSelectedResultsUnmatchedSize:G,areAllFilteredResultsMatchedSelected:H,getSelectedResultsMatchedIds:D,isResultMatchedSelected:K,isResultUnmatchedSelected:L,addSelectedResultMatched:M,addSelectedResultUnmatched:N,addSelectedResultsMatchedMultiple:O,addSelectedResultsUnmatchedMultiple:P,removeSelectedResultMatched:Q,removeSelectedResultUnmatched:R,removeSelectedResultsMatchedMultiple:S,removeSelectedResultsUnmatchedMultiple:T,setSelectedMatchTypeFilter:v,getMatchedFilteredResults:t,getUnmatchedFilteredResults:u,setMatchedFilteredResults:q,setUnmatchedFilteredResults:r,getMatchedFilteredCount:ja,getUnmatchedFilteredCount:ka,resetFilteredResults:s,showHistory:w,updateViewedByUserFlag:Ea,getCountOfCurrentMatchedMatchType:oa,getSearchTypeOptions:Fa,setIsForOppAlert:n,getIsForOppAlert:o,isOppAlertSearchType:Ga,sendSearchExecuteEvent:Ia,hasUnviewedListMatchNotification:Ha,getPersonSearchCountsForListMatch:Ja,notificationsListUnviewed:Ka,checkAllEntitiesOutOfScope:La,selectMatchedRow:Ma,isValidCellValue:Na}}a.$inject=["$rootScope","$http","$q","dorgConfig","eventBusService","stringUtil","SearchService","featureFlagService","$timeout","MATCH_TYPE_FILTERS","MATCH_TYPE_STRINGS","bulkMatchListMatchCompanyProcessor","TopContentConsumerService"];var b={ALL_RESULTS:"allResults",MATCHES:"matches",POSSIBLE_MATCHES:"possibleMatches",UN_MATCHED:"unMatched"},c={MATCH_TYPES:"MATCH_TYPES",NON_MATCHES:"NON_MATCHES"},d={PERFECT_MATCH:"Match",PARTIAL_MATCH:"Possible Match"};angular.module("dorgEuiApp").service("bulkMatchService",a).constant("MATCH_TYPE_FILTERS",b).constant("MATCH_TYPE_STRINGS",d).constant("MATCH_CATEGORIES",c)}(),function(){"use strict";function a(a){function b(){l.intelligenceContentId="intelligence-content",l.descriptionContentId="description-content",l.tooltipPlace=j(),l.isShowCompanyDepartments=i()}function c(a){if(a===l.descriptionContentId){l.showMore=!l.showMore,l.isShowFull=!l.isEnoughSpace&&!l.showMore;var b="#"+a;if(!l.isShowFull&&!f(b)){var c=$(b).parent(),e=c.closest("div.left-child").first();$("html, body").animate({scrollTop:e.offset().top-d()+"px"})}}else a===l.intelligenceContentId&&(l.showMoreIntel=!l.showMoreIntel,l.isShowFullIntel=!l.isEnoughSpaceIntel&&!l.showMoreIntel)}function d(){return $("nav-bar-component").first().outerHeight()+$("nav#main-nav").first().outerHeight()}function e(){return $("footer").first().outerHeight()}function f(a){var b=$(a).offset().top,c=b+$(a).outerHeight(),f=$(window).scrollTop()+d(),g=f+$(window).height()-e();return c<=g&&b>=f}function g(){a.open({controller:"ResearchRequestController_dep",templateUrl:"app/components/navbar/researchRequest.modal.html"})}function h(){a.open(k())}function i(){var a=!1;return _.each(l.company.companyDepartments,function(b){if(b.numEmployees>0)return void(a=!0)}),a}function j(){return l.viewPort===m?"top":"left"}function k(){return{controller:["$uibModalInstance","$scope","$compile",function(a,b,c){b.company=l.company,b.currentEmployees=l.currentEmployees?l.currentEmployees:{};var d="app/components/company-details-tab/company-info/companyMapPopover.html",e=$("#company-full-map");angular.element(e).ready(function(){var a=c('<map head-quarters="company" satellites="currentEmployees" pop-up-template="'+d+'"></map>')(b);$("#company-full-map").append(a)}),b.close=function(){a.close()},b.$on("$stateChangeStart",function(){a.close()})}],size:"lg",templateUrl:"app/components/company-details-tab/company-info/companyMap.modal.html",windowClass:"modal-full-screen"}}var l=this,m="Desktop";l.toggleShowMore=c,l.openResearchRequest=g,l.viewMap=h,l.$onInit=b,angular.element(document).ready(function(){var a="#"+l.descriptionContentId,b="#"+l.intelligenceContentId;l.showMore=!1,$(a)&&$(a)[0]&&(l.showMore=$(a)[0].scrollHeight>$(a).innerHeight()),l.isEnoughSpace=!l.showMore,l.isShowFull=!l.isEnoughSpace&&!l.showMore,l.showMoreIntel=!1,$(b)&&$(b)[0]&&(l.showMoreIntel=$(b)[0].scrollHeight>$(b).innerHeight()),l.isEnoughSpaceIntel=!l.showMoreIntel,l.isShowFullIntel=!l.isEnoughSpaceIntel&&!l.showMoreIntel,l.noMapAvailable=!1,_.has(l.company.location,"latitude")&&_.has(l.company.location,"longitude")?(l.hqLocation=l.company.location,l.hqLocation.location={longitude:l.company.location.longitude,latitude:l.company.location.latitude,id:l.company.location.id}):l.noMapAvailable=!0})}a.$inject=["singleModalService"],angular.module("dorgEuiApp").component("companyInfoTab",{bindings:{company:"<",canViewDunsInfo:"<",yearFoundedEnabled:"<",locked:"<",currentEmployees:"<",viewPort:"<"},templateUrl:"app/components/company-details-tab/company-info/company-info-tab.html",controller:a,controllerAs:"companyInfoVm"})}(),function(){"use strict";function a(){}angular.module("dorgEuiApp").component("companyEmployeesTab",{bindings:{isCurrentEmployees:"<",hasExistCurrentEmployees:"<",isRecentlyLeft:"<",hasExistLeftEmployees:"<",isResponsibilityMatrix:"<",hasExistResposibilityMatrixEmployees:"<",currentDepartmentViewIdx:"<",currentDeptList:"<",swapDepartmentView:"&",locked:"<",isPartiallyLocked:"<",selectedLocations:"<",openFilterCompanyLocation:"&",isOpen:"<",canExport:"<",selectedEmployees:"<",employees:"<",personExportRowLimit:"<",countAllPerson:"<",exportCriteria:"<",showOutOfScopeEmployees:"<",viewEmpsIdx:"<",totalItems:"<",toggleOutOfScopeCurrentEmployees:"&",spinnerCurEmp:"<",getSelectedRows:"&",canAccessTierTwoData:"<",tierTwoPeopleCount:"<",company:"<",filteredEmpsLeftTabs:"<",currentDepartmentName:"<",filteredEmpsLeft:"<",unlockContent:"&",spinnerLeftEmp:"<",pastEmployees:"<",accessScopeSubjectLine:"<",accessScopeBodyLine:"<",resposibilityMatrixSelectedEmployees:"<",canBulkUpload:"<",spinnerMatrix:"<",spinnerMatrixLoadingByDepartment:"<",responsibilityMatrix:"<",checkLockedDepartmentByName:"&",includeExportSearchCriteria:"<"},templateUrl:"app/components/company-details-tab/employees/company-employees-tab.html",controller:a,controllerAs:"employeesTabVm"})}(),function(){"use strict";function a(a,b,c){function d(){a.getOfficeThenCompanyNumberOrBlank=c.getOfficeThenCompanyNumberOrBlank,a.canExport=g.canExport,a.accessScopeSubjectLineInScope=g.accessScopeSubjectLine,a.accessScopeBodyLineInScope=g.accessScopeBodyLine}function e(){return g.selectedLocations&&g.selectedLocations.length>0}function f(){return 0===g.selectedEmployees.length}var g=this;g.allDepartments="All Departments",g.haveSelectedLocations=e,g.disabled=f,g.$onInit=d}a.$inject=["$scope","$timeout","phoneNumberService"],angular.module("dorgEuiApp").component("companyCurrentEmployeesTab",{bindings:{currentDepartmentViewIdx:"<",currentDeptList:"<",swapDepartmentView:"&",locked:"<",isPartiallyLocked:"<",selectedLocations:"<",openFilterCompanyLocation:"&",isOpen:"<",canExport:"<",selectedEmployees:"<",employees:"<",personExportRowLimit:"<",countAllPerson:"<",exportCriteria:"<",showOutOfScopeEmployees:"<",viewEmpsIdx:"<",totalItems:"<",toggleOutOfScopeCurrentEmployees:"&",spinnerCurEmp:"<",getSelectedRows:"&",canAccessTierTwoData:"<",tierTwoPeopleCount:"<",company:"<",checkLockedDepartmentByName:"&",getOfficeThenCompanyNumberOrBlank:"&",canBulkUpload:"<",accessScopeSubjectLine:"<",accessScopeBodyLine:"<",includeExportSearchCriteria:"<"},templateUrl:"app/components/company-details-tab/employees/current/company-current-employees-tab.html",controller:a,controllerAs:"currentEmployeesVm"})}(),function(){"use strict";function a(a){function b(){a.accessScopeSubjectLineInScope=c.accessScopeSubjectLine,a.accessScopeBodyLineInScope=c.accessScopeBodyLine}var c=this;c.$onInit=b}a.$inject=["$scope"],angular.module("dorgEuiApp").component("companyRecentlyLeftTab",{bindings:{filteredEmpsLeftTabs:"<",currentDepartmentName:"<",swapDepartmentView:"&",locked:"<",filteredEmpsLeft:"<",unlockContent:"&",isPartiallyLocked:"<",spinnerLeftEmp:"<",pastEmployees:"<",accessScopeSubjectLine:"<",accessScopeBodyLine:"<",checkLockedDepartmentByName:"&"},templateUrl:"app/components/company-details-tab/employees/recently-left/company-recently-left-tab.html",controller:a,controllerAs:"recentLeftVm"})}(),function(){"use strict";function a(a){function b(){a.accessScopeSubjectLineInScope=c.accessScopeSubjectLine,a.accessScopeBodyLineInScope=c.accessScopeBodyLine}var c=this;c.$onInit=b}a.$inject=["$scope"],angular.module("dorgEuiApp").component("companyResposibilityMatrixTab",{bindings:{currentDepartmentViewIdx:"<",currentDepartmentName:"<",swapDepartmentView:"&",currentDeptList:"<",locked:"<",isPartiallyLocked:"<",getSelectedRows:"&",isOpen:"<",canExport:"<",resposibilityMatrixSelectedEmployees:"<",canBulkUpload:"<",spinnerMatrix:"<",spinnerMatrixLoadingByDepartment:"<",responsibilityMatrix:"<",accessScopeSubjectLine:"<",accessScopeBodyLine:"<",checkLockedDepartmentByName:"&"},templateUrl:"app/components/company-details-tab/employees/responsibility-matrix/company-responsibility-matrix-tab.html",controller:a,controllerAs:"resposibilityMatrixVm"})}(),function(){"use strict";function a(a){function b(){d.itDepartment=_.find(d.company.companyDepartments,{departmentId:e}),d.departmentsExcludeITAndEmpty=_.filter(d.company.companyDepartments,function(a){return a.departmentId!==e&&a.budget&&a.budget>0}),d.companyFundingRounds=_.sortByOrder(d.companyFundingRounds,["fundingDate"],["desc"]),_.forEach(d.companyFundingRounds,function(a){a.investors=_.sortBy(a.investors,function(a){return a.fullName.toLowerCase()})}),c()}function c(){d.viewPort===f?d.tooltipPlacement="right":d.tooltipPlacement="left"}var d=this,e=1,f="Desktop";d.tooltipClassName="tooltip-investor",d.tooltipPlacement="left",d.dateFormat="MM/dd/yyyy",d.$onInit=b,angular.element(a).bind("resize",function(){c()})}a.$inject=["$window"],angular.module("dorgEuiApp").component("companyFinancialsTab",{bindings:{company:"<",totalFundingAmount:"<",isDepartmentsBudgetEmpty:"<",isShowFunding:"<",isContentProfileFinance:"<",companyInvestors:"<",companyFundingRounds:"<",isHavingNullAmount:"<",viewPort:"<"},templateUrl:"app/components/company-details-tab/financials/financials-tab.html",controller:a,controllerAs:"financialsVm"})}(),function(){"use strict";function a(){}angular.module("dorgEuiApp").component("companyIntelligenceTab",{bindings:{company:"<",isScoopsTab:"<",isOppAlertsTab:"<",locked:"<"},templateUrl:"app/components/company-details-tab/intelligence/company-intelligence-tab.html",controller:a,controllerAs:"intelligenceTabVm"})}(),function(){"use strict";function a(a,b,c,d){function e(){k=a.Session.account,m.oppalerts=c.$defaultGrid("topContent",[],void 0,!0,b),l=m.company,m.accessScopeSubjectLine=encodeURIComponent("Access Request From "+k.firstName+" "+k.lastName+": "+m.company.name),m.accessScopeBodyLine=encodeURIComponent("I am interested in more information on how to gain access to the data set which includes "+m.company.name+"."),m.oppalertsLoaded=!1,i={colName:"",order:"desc"},j={pageNumber:0,pageSize:m.oppalerts.paginationPageSize||25},m.locked?m.oppalertsLoaded=!0:(f(m.oppalerts.columnDefs),l._links.oppalerts&&d.getOppAlertsCount(l.id).then(function(a){m.numberOppAlerts=a}),m.oppalerts.onRegisterApi=g,m.oppalerts.enableGridMenu=!1,m.locked||m.oppalerts&&m.oppalerts.data&&m.oppalerts.data.length||(m.oppalertsLoaded&&(m.oppalertsLoaded=!1),h()))}function f(a){null!=a&&_.remove(a,function(a){return"companyName"===a.field})}function g(a){this.api=a,this.useExternalPagination=!0,this.useExternalSorting=!0,this.api.pagination.on.paginationChanged(b,function(a,b){j.pageNumber=a-1,j.pageSize=b,h()}),this.api.core.on.sortChanged(b,function(a,b){0===b.length?(i.colName="",i.order=""):(i.colName=b[0].name,i.order=b[0].sort.direction),h()})}function h(){m.oppalertsLoaded=!1,d.getOppAlerts(l,j.pageNumber,j.pageSize,i.colName,i.order).then(function(a){m.oppalerts.columnDefs=_.filter(m.oppalerts.columnDefs,function(a){return!_.contains(["Company","Best Contacts"],a.name)}),m.oppalerts.data=a||[],m.oppalerts.totalItems=m.numberOppAlerts,m.oppalertsLoaded||(m.oppalertsLoaded=!0)},function(){m.oppalertsLoaded||(m.oppalertsLoaded=!0)})}var i,j,k,l,m=this;m.$onInit=e}a.$inject=["$rootScope","$scope","$grid","CompanyService"],angular.module("dorgEuiApp").component("intelligenceOppAlertsTab",{bindings:{company:"<",locked:"<"},templateUrl:"app/components/company-details-tab/intelligence/opp-alerts/intelligence-opp-alerts-tab.html",controller:a,controllerAs:"intelligenceOppAlertsVm"})}(),function(){"use strict";function a(a,b,c){function d(){i.triggersToScoopFlag=b.findFeatureFlag(null,"triggerstoscoops"),l=i.company,h(null),i.intel&&i.intel.length||(i.intelLoaded&&(i.intelLoaded=!1),c.getIntel(l).then(function(a){i.intel=k=a||[],i.intelLoaded||(i.intelLoaded=!0),_.size(a)<m?i.hasMoreIntel=!1:i.hasMoreIntel=!0},function(){i.intelLoaded||(i.intelLoaded=!0)}))}function e(){var b=this.filterText;a.cancel(j),j=a(function(){i.intelLoaded&&(i.intelLoaded=!1),m=20,n=0,h(b),g(l,n,m,b,!1)},250)}function f(){if(i.hasMoreIntel&&!i.onLoadMoreIntel){var a=this.filterText;i.onLoadMoreIntel=!0,n+=1,i.intelLoaded&&(i.intelLoaded=!1),g(l,n,m,a,!0)}}function g(a,b,d,e,f){c.getIntel(a,b,d,e).then(function(a){f?i.intel=k=k.concat(a):i.intel=k=a||[],i.intelLoaded||(i.intelLoaded=!0),_.size(a)<d?i.hasMoreIntel=!1:i.hasMoreIntel=!0,f&&(i.onLoadMoreIntel=!1)},function(){i.intelLoaded||(i.intelLoaded=!0),f&&(i.onLoadMoreIntel=!1)})}function h(a){c.getIntelCounts(l.id,a).then(function(a){i.numberScoops=a.searchCriteriaScoped})}var i=this,j=null,k=null,l=null,m=20,n=0;i.filterText="",i.numberScoops=0,i.intelLoaded=!1,i.hasMoreIntel=!1,i.filterIntels=e,i.loadMoreIntel=f,i.$onInit=d}a.$inject=["$timeout","featureFlagService","CompanyService"],angular.module("dorgEuiApp").component("intelligenceScoopsTab",{bindings:{company:"<",locked:"<"},templateUrl:"app/components/company-details-tab/intelligence/scoops/intelligence-scoops-tab.html",controller:a,controllerAs:"intelligenceScoopsVm"})}(),function(){"use strict";function a(){function a(){return c.canAccessTierTwoData&&c.tierTwoPeopleCount>0}function b(a){var b=c.orgChartDeptId({key:a});return b}var c=this;c.getOrgChartDeptId=b,c.showTierTwoContactsButton=a}angular.module("dorgEuiApp").component("companyOrgchartsTab",{bindings:{isPartiallyLocked:"<",spinnerGo:"<",locked:"<",orgchartSpinner:"<",nullOrgcharts:"<",orgChartDataCopy:"<",currentDepartmentName:"<",company:"<",orgChartDeptId:"&",currentEmployees:"<",canExport:"<",canUploadPerson:"<",canAccessTierTwoData:"<",tierTwoPeopleCount:"<",accessScopeSubjectLine:"<",accessScopeBodyLine:"<"},templateUrl:"app/components/company-details-tab/orgcharts/company-orgchart-tab.html",controller:a,controllerAs:"orgchartsTabVm"})}(),function(){"use strict";function a(a){function b(a){f.technologies&&(f.technologies[a].collapseIn=!f.technologies[a].collapseIn,f.isExpandAll=d())}function c(){
f.isExpandAll?$(".collapse").collapse("hide"):$(".collapse").collapse("show"),_.each(f.technologies,function(a){a.collapseIn=!f.isExpandAll}),f.isExpandAll=!f.isExpandAll}function d(){var a=!f.isExpandAll;return _.each(f.technologies,function(b){if(b.collapseIn===f.isExpandAll)return void(a=f.isExpandAll)}),a}function e(){var a=f.filterValue.toLowerCase(),b=!1;_.each(g,function(c){var d=_.cloneDeep(c.technologies),e=new RegExp(".*"+_.escapeRegExp(a.toLowerCase())+".*$");e.test(c.technologyCategory.toLowerCase())||(d=_.filter(d,function(b){return _.includes(b.name.toLowerCase(),a)})),_.find(f.technologies,{technologyCategory:c.technologyCategory}).technologies=d,d&&d.length>0&&(b=!0),f.isExpandAll=!1}),f.showExpandColapseBtn=b,c()}var f=this,g=null;f.isExpandAll=!0,f.filterValue="",f.loaded=!1,f.showExpandColapseBtn=!0,f.clickDelayTime=500,f.collapseExpand=b,f.collapseExpandAll=c,f.filterTech=e,this.$onInit=function(){a.getTechnologies(f.company).then(function(a){_.each(a,function(a){var b=[];_.each(a.technologies,function(a){b.push({name:a})}),b=_.sortBy(b,"name"),a.collapseIn=!0,a.technologies=b}),g=_.cloneDeep(a||[]),f.technologies=a||[],f.technologies&&(f.isExpandAll=!0),f.loaded||(f.loaded=!0)},function(){f.loaded||(f.loaded=!0)})}}a.$inject=["CompanyService"],angular.module("dorgEuiApp").component("companyTechnologiesTab",{bindings:{company:"<"},templateUrl:"app/components/company-details-tab/technologies/company-technologies-tab.html",controller:a,controllerAs:"technologiesVm"})}(),function(){"use strict";function a(){var a=this;a.ALL_TIERS=void 0,a.TIER_ONE=1,a.TIER_TWO=2}angular.module("dorgEuiApp").component("companyTierOption",{templateUrl:"app/components/company-tier-option/company-tier-option.tpl.html",bindings:{colFilter:"="},controller:[a]})}(),function(){"use strict";function a(a){var b=this;b.companyFullAddress=a.generateCompanyFullAddressWithoutStreet(b.companyGeneric,"hqCityName",["hqStateCode","hqPostalCode","hqCountryCode"])}angular.module("dorgEuiApp").component("companyTierTwoGeneric",{bindings:{companyGeneric:"<",canExport:"="},templateUrl:"app/components/company-tier-two/company-generic/company-generic.html",controller:["tierTwoDataService",a],controllerAs:"companyGenericVm"})}(),function(){"use strict";function a(a){var b=this;b.companyFullAddress=a.generateCompanyFullAddressWithoutStreet(b.company,"hqCityName",["hqStateCode","hqPostalCode","hqCountryCode"]),b.isNotEmptyString=a.isNotEmptyString}angular.module("dorgEuiApp").component("companyTierTwoHeadQuartersLocation",{bindings:{headQuarters:"<",company:"<"},templateUrl:"app/components/company-tier-two/company-head-quarters-location/company-head-quarters-location.html",controller:["tierTwoDataService",a],controllerAs:"headQuartersLocationVm"})}(),function(){"use strict";function a(a){var b=this;b.isNotEmptyString=a.isNotEmptyString}angular.module("dorgEuiApp").component("companyTierTwoInfo",{bindings:{companyInfo:"<"},templateUrl:"app/components/company-tier-two/company-info/company-info.html",controller:["tierTwoDataService",a],controllerAs:"companyInfoVm"})}(),function(){"use strict";angular.module("dorgEuiApp").component("companyTierTwoCurrentEmployees",{bindings:{uuid:"<",canExport:"="},templateUrl:"app/components/company-tier-two/current-employees/current-employees.html",controller:"companyTierTwoCurrentEmployeesController",controllerAs:"currentEmployeesVm"})}(),function(){"use strict";function a(a,b,c,d,e){function f(){p.employeeGrid.onRegisterApi=function(b){this.api=b,b.selection.on.rowSelectionChanged(a,function(a){p.numOfSelectedRow=a.isSelected?p.numOfSelectedRow+1:p.numOfSelectedRow-1,p.selectedRows.push(a),a.isSelected||_.remove(p.selectedRows,function(b){return b.entity.fullName===a.entity.fullName})}),b.selection.on.rowSelectionChangedBatch(a,function(a){var b=_.filter(a,function(a){return!a.isSelected});b.length===a.length?(p.numOfSelectedRow-=a.length,_.forEach(b,function(a){_.remove(p.selectedRows,function(b){return b.entity.fullName===a.entity.fullName})})):(p.numOfSelectedRow+=a.length,_.forEach(a,function(a){p.selectedRows.push(a)}))}),b.pagination.on.paginationChanged(a,function(a,b){if(!p.loading){var c={page:p.employeeGrid.paginationCurrentPage-1,size:p.employeeGrid.paginationPageSize,filter:{}};g(this.grid,c),q&&(c.sortField=q.sortField,c.sortOrder=q.sortOrder),j(c)}}),b.core.on.sortChanged(a,function(a,b){if(!p.loading){var c={page:p.employeeGrid.paginationCurrentPage-1,size:p.employeeGrid.paginationPageSize,filter:{}};g(this.grid,c);var d=i(b);c.sortField=d.sortField,c.sortOrder=d.sortOrder,q={sortField:d.sortField,sortOrder:d.sortOrder},j(c)}}),b.core.on.filterChanged(a,function(a,b){var d={page:0,size:p.employeeGrid.paginationPageSize,filter:{}};g(this.grid,d),null!=q&&(d.sortField=q.sortField,d.sortOrder=q.sortOrder),r&&c.cancel(r),r=c(function(){p.loading||j(d)},750,!1)}),b.core.on.rowsRendered(a,function(a){if(p.selectedRows.length>0){var b=a.grid.rows,c=0;_.each(b,function(a){var b=_.find(p.selectedRows,function(b){return b.entity.fullName===a.entity.fullName});b&&(a.setSelected(!0),c++)}),a.grid.selection.selectAll=!1,c===b.length&&(a.grid.selection.selectAll=!0)}}),b.colResizable.on.columnSizeChanged(a,o),b.colMovable.on.columnPositionChanged(a,o),b.core.on.columnVisibilityChanged(a,o)}}function g(a,b){_.each(a.columns,function(a){if(a.visible&&a.filter.term)switch(a.field){case"fullName":b.filter.fullName=a.filter.term;break;case"title":b.filter.title=a.filter.term;break;case"email":b.filter.email=a.filter.term}})}function h(){return!p.selectedRows||p.selectedRows.length<1}function i(a){var b,c,d={sortField:"",sortOrder:""};_.isUndefined(a[0])&&(a[0]={field:"",sort:{direction:null}}),b=a[0],c=b.field.split("."),b.field=c[c.length>1?1:0];try{d.sortField=_.camelCase(b.colDef.field.replace(/\./g,"_"))}catch(a){d.sortField=b.field}return d.sortOrder=b.sort.direction,d}function j(a){p.loading=!0,a=k(a),p.filterPersonTierTwo=a&&a.filter?a.filter:void 0,b.filteringPersonTierTwoList(p.uuid,a).then(function(a){l(a),p.loading=!1,p.initLoading=!1})}function k(a){return null==a&&(a={page:0,size:p.employeeGrid.paginationPageSize}),a}function l(a){p.employeeGrid.data=a.data,p.employeeGrid.totalItems=a.page?a.page.totalElements:0,p.totalEmployees=p.employeeGrid.totalItems,a.page&&a.page.number?p.employeeGrid.paginationCurrentPage=a.page.number+1:p.employeeGrid.paginationCurrentPage=1}function m(a,b){var c={number:"",tooltipText:"",tooltipEnabled:!1,showMobileIcon:!1};return a=a||{},n(a.mobileTelNumber)?(c.number=a.mobileTelNumber,c.tooltipEnabled=!0,c.tooltipText="This is a mobile phone number",c.showMobileIcon=!0):n(a.officeTelNumber)?c.number=a.officeTelNumber:n(a.directDialNumber1)?c.number=a.directDialNumber1:n(a.company.mainPhoneNumber)&&(c.number=a.company.mainPhoneNumber,b&&(c.number+="*"),c.tooltipEnabled=!0,c.tooltipText="This is a company phone number"),c}function n(a){return null!=a&&""!=a.trim()}function o(){e.$broadcast("renderUiGridLockBoxes")}var p=this;p.hasNotSelectedRow=h,p.selectedRows=[],p.loading=!0,p.initLoading=!0;var q=null;p.numOfSelectedRow=0;var r=null;p.context="isCurrentEmployeesGrid",a.getPhoneNumber=m,p.$onInit=function(){p.employeeGrid=b.employeeGrid(),f(),j(),d.$defaultGrid("tierTwoPerson",[],void 0,!0,!1)},p.countTotalItems=function(){return b.countAccessScopeContactsByCompanyUuid(p.uuid).then(function(a){return a})}}a.$inject=["$scope","CompanyTierTwoCurrentEmployeesService","$timeout","$grid","$rootScope"],angular.module("dorgEuiApp").controller("companyTierTwoCurrentEmployeesController",a)}(),function(){function a(a,b,c,d,e){function f(){var a=g();return{columnDefs:e.getCurrentEmployeeDetailColumnConfig(),enableFiltering:!0,enablePaginationControls:!1,enableRowSelection:!0,enableRowHeaderSelection:!0,enableColumnResizing:!0,enableColumnMenus:!0,enableGridMenu:!0,multiSelect:!0,enableSorting:!0,useExternalPagination:!0,useExternalSorting:!0,useExternalFiltering:!0,onRegisterApi:function(a){this.api=a},paginationCurrentPage:1,paginationPageSizes:[10,25,50,75,100],paginationPageSize:+a,pagesToShow:5,virtualizationThreshold:75,enableVerticalScrollbar:!0,enableHorizontalScrollbar:!0,isRowSelectable:function(a){return!a.entity.locked}}}function g(){var a=c.Session.account.preferences,b=25;return a&&a.grid&&a.grid.pageSize&&(b=a.grid.pageSize),b}function h(a,c){return params={page:c.page||0,size:c.size||25,sortField:c.sortField,sortOrder:c.sortOrder},b.post("api/rest/tier2/people/company/"+a,c.filter||{},{params:params}).then(function(a){return{page:a.data.page||{totalElements:0},data:d.$getD(a.data)}},function a(a){return a})}function i(a){return b.post("api/rest/tier2/people/search/counts",{companyUuids:[a]}).then(function(a){return a.data.searchCriteriaScoped})}return{employeeGrid:f,filteringPersonTierTwoList:h,countAccessScopeContactsByCompanyUuid:i}}a.$inject=["uiGridConstants","$http","$rootScope","$embeddedUtils","searchGridTemplateService"],angular.module("dorgEuiApp").service("CompanyTierTwoCurrentEmployeesService",a)}(),function(){"use strict";angular.module("dorgEuiApp").component("companyTierTwoNoEmployees",{templateUrl:"app/components/company-tier-two/no-employees/no-employees.tpl.html"})}(),function(){"use strict";function a(a){var b=this;b.showDetails=!1,b.popoverDelay=200;var c,d=function(){c&&a.cancel(c)};b.mouseLeave=function(){d(),c=a(function(){b.showDetails=!1},b.popoverDelay)},b.mouseOver=function(){d(),c=a(function(){b.showDetails=!0},b.popoverDelay)}}a.$inject=["$timeout"],angular.module("dorgEuiApp").component("companyDetailsPopover",{bindings:{companyId:"<",companyName:"@"},templateUrl:"app/components/companyDetailsPopover/company-details-popover.tpl.html",controller:a})}(),function(){angular.module("dorgEuiApp").component("discoverorgLogoComponent",{templateUrl:"app/components/discoverorg-logo/discoverorg-logo.template.html"})}(),function(){"use strict";function a(a,b){function c(){J.dataForChart=x(J.fundingRounds),J.tooltipTemplateIdPrefix=L,a.onresize=s,J.moveToLeft=f,J.moveToRight=g,b(function(){_.isEmpty(J.dataForChart)||(Y=J.dataForChart.length),u(),F()},0)}function d(a,b){Z=!1;var c=$("#funding-round-timeline-svg"),d=n(a)-c.offset().left-U+2;$("#funding-round-timeline-wrap").animate({scrollLeft:d},{duration:b,complete:h})}function e(a,b){Z=!0;var c=$("#funding-round-timeline-svg"),d=n(a)-c.offset().left-r()+U;l(1,a)&&l(J.dataForChart.length,a)||(d+=T),$("#funding-round-timeline-wrap").animate({scrollLeft:d},{duration:b,complete:h})}function f(){if(Y>1){for(;Y>1&&m(Y);)Y--;e(Y,500)}}function g(){if(Y<J.dataForChart.length){for(;Y<J.dataForChart.length&&m(Y);)Y++;d(Y,500)}}function h(){i(j(),"#btn-move-to-left"),i(k(),"#btn-move-to-right")}function h(){i(j(),"#btn-move-to-left"),i(k(),"#btn-move-to-right")}function i(a,b){a?$(b).css("display","inline"):$(b).css("display","none")}function j(){var a=q();return o()<a.left}function k(){var a=q();return p()>a.right}function l(a,b){var c=n(a),d=n(b),e=r()-S-T;return Math.abs(c-d)<=e}function m(a){var b=q(),c=b.left,d=b.right-V,e=n(a);return a!==J.dataForChart.length&&1!==a&&(c+=T,d-=T),e>=c&&e<=d}function n(a){var b="#"+K+"-"+a;return $(b).offset().left}function o(){var a="#"+K+"-1";return $(a).offset().left}function p(){var a="#"+K+"-"+J.dataForChart.length;return $(a).offset().left}function q(){var a=$("#funding-round-timeline-wrap"),b=a.offset().left,c=a.offset().left+a.outerWidth();return{left:b,right:c}}function r(){return $("#funding-round-timeline-wrap").outerWidth()}function s(){var a=I.select("#finance-funding-round-timeline")[0][0].offsetWidth-S;null!=a&&0!==a&&(I.select("#funding-round-timeline-wrap").style("width",a+"px"),X.selectAll("*").remove(),_.isEmpty(J.dataForChart)||E(),u(a))}function t(a,b,c){var d=a.diff(b,"days"),e=moment(b).add(Math.abs(d),"days"),f=c(new Date(e.format(N)))-c(new Date(b.format(N)));return d>0?f:-f}function u(a){var c=moment(),f=moment(c).subtract(Q+1,"years"),a=a?a:X[0][0].width.baseVal.value-S,g=a;I.select("#funding-round-timeline-wrap").style("width",a+"px");var h=I.time.scale().domain([new Date(f.format(N)),new Date(c.format(N))]).range([S,a-S]),i=moment.min(H(J.fundingRounds)),j=f.diff(i,"days");if(j>0){var k=moment(f).add(Math.abs(j),"days"),l=h(new Date(k.format(N)));a+=l,f=i}var m=moment.max(H(J.fundingRounds));j=m.diff(c,"days");var k=moment(c).add(Math.abs(j),"days"),l=t(m,c,h);if(a+=l,c=m,g>a){var n=S/2/g;f=moment(c).subtract(Q+1+n,"years"),a=g*(1+n)}X.style("width",a+"px"),h=I.time.scale().domain([new Date(f.format(N)),new Date(c.format(N))]).range([S,a-S]);var o=I.svg.axis().scale(h);o.ticks(I.timeYear),o.tickSize(0),o.tickFormat(function(a){return a.getFullYear()}),X.append("g").call(o).attr("class","x axis").attr("transform","translate(0,"+W+")");var p=X.selectAll("g.tick line"),q=X.selectAll("g.tick text");p.attr("y2","12").attr("x1","0").attr("y1","3"),q.attr("y","16");var r=[];if(q.each(function(){r.push(this.textContent)}),q.data(r).append("title").text(function(a){return a}),_.isEmpty(J.dataForChart))return void X.append("text").attr({x:"50%",y:"35",class:"no-funding-in-range"}).text("This company has no recent funding activity.");var s=X.selectAll("circle").data(J.dataForChart).enter().append("g").attr("transform",function(a){return"translate("+h(a.fundingDate)+", "+W+")"}).attr("id",function(a){return C(a.id)}).on("mouseover",function(a){v(a)}).on("mouseout",function(a){var c=b(function(){w(a)},250),d=I.selectAll("#"+B(a.id,!1));if(a.count>1){var e=I.select("#"+C(a.id)+" .data-point-circle-number");e.on("mouseover",function(){b.cancel(c)})}d.on("mouseenter",function(){b.cancel(c)}),d.on("mouseleave",function(){b.cancel(c),w(a)})});s.append("circle").attr("r",7).attr("class","data-point-circle"),s.append("text").attr("class","data-point-circle-number").attr("dx","-3").attr("dy","3").text(function(a){return 1!=a.count?a.count:""}),_.isEmpty(J.dataForChart)||(Z?e(Y,10):d(Y,10))}function v(b){null==I.select("#"+B(b.id,!1))[0][0]&&A(b.id);var c=I.select("#"+B(b.id,!1))[0][0],d=I.select("#"+C(b.id))[0][0],e=d.getBoundingClientRect(),f=c.children[0];c.style.display="block",e.left+c.getBoundingClientRect().width/2+7>document.body.clientWidth?(f.classList.add("arrow-align-right"),c.style.left=e.left-c.getBoundingClientRect().width+22+"px"):(f.classList.add("arrow-align-center"),c.style.left=e.left-c.getBoundingClientRect().width/2+7+"px"),c.getBoundingClientRect().height>e.top?(f.classList.add("arrow-up"),c.style.top=a.pageYOffset+e.top+f.getBoundingClientRect().height+14+"px"):(f.classList.add("arrow-down"),c.style.top=a.pageYOffset+e.top-c.getBoundingClientRect().height-7+"px")}function w(a){D(a.id)}function x(a){if(null==a)return[];a=_.filter(a,function(a){return null!=a.fundingDate}),G(a);var b=_.sortBy(a,"fundingDate"),c="fundingDateForGrouping";b=y(b,c);var d=[],e=_.groupBy(b,c),f=1;return _.forEach(e,function(a,b){d.push({id:f,count:a.length,fundingRounds:a,fundingDate:a[0].fundingDate}),f++}),d}function y(a,b){for(var c=0;c<a.length;c++)0===c?a[c][b]=a[c].fundingDate:z(a,c,c-1,b),a[c].dateString=moment(a[c].fundingDate).format(O);return a}function z(a,b,c,d){if(!(c<0)){var e=a[c],f=a[b],g=moment(e.fundingDate),h=moment(f.fundingDate);h.diff(g,"days")<=P?e[d]===e.fundingDate?f[d]=e.fundingDate:z(a,b,c-1,d):f[d]=f.fundingDate}}function A(a){var b=I.select("#"+B(a,!0)).node(),c=I.select("body").node();if(null!=b&&null!=c){var d=c.lastChild;I.select(d.parentNode.insertBefore(b.cloneNode(!0),d)).attr("id",B(a,!1)).attr("class",function(a){return this.className+" "+R})}}function B(a,b){return b?L+"-"+a:M+"-"+a}function C(a){return K+"-"+a}function D(a){var b=I.select("#"+B(a,!1));b&&b.remove()}function E(){var a=I.select("."+R);a&&a.remove()}function F(){var a=I.select(".company-financial");null!=a&&a.on("scroll",function(){E()})}function G(a){null!=a&&a.forEach(function(a){a.investors=_.sortBy(a.investors,function(a){return a.fullName.toLowerCase()})})}function H(a){return a.map(function(a){return moment(a.fundingDate)})}var I=a.d3,J=this,K="funding-round",L="funding-round-tooltip",M="funding-round-tooltip-copy",N="YYYY-MM-DD",O="MMMM DD, YYYY",P=15,Q=6,R="funding-round-timeline-tooltip-copy",S=13,T=14,U=20,V=14,W=70,X=I.select("#funding-round-timeline-svg"),Y=1,Z=!0;J.$onInit=c}a.$inject=["$window","$timeout"],angular.module("dorgEuiApp").component("financeFundingRoundTimeline",{transclude:!0,bindings:{fundingRounds:"="},templateUrl:"app/components/finance/finance-funding-round-timeline.html",controller:a})}(),function(){"use strict";function a(a,b){function c(){0===o.selectedFollowList.id?i():j()}function d(){o.onCancel()}function e(){o.selectedFollowList.id>0&&(o.newListName="")}function f(){return o.selectedFollowList.id>0||g()}function g(){var a=o.selectedFollowList.id>0||_.isEmpty(o.newListName)||!_.isEmpty(o.availableFollowLists)&&!_.find(o.availableFollowLists,"displayName",o.newListName);return a}function h(){var a="";return g()||(a="Please enter a unique list name or select from the Source List."),a}function i(){a.$newList("follow"+_.startCase(o.entityType.toLowerCase()),o.newListName).then(function(a){k(a).then(function(b){b.status=!0,b.isNew=!0,b.id=a.id,b.displayName=a.displayName,l(b)},m)},m)}function j(){k(o.selectedFollowList).then(function(a){a.status=!0,a.isNew=!1,a.id=o.selectedFollowList.id,a.displayName=o.selectedFollowList.displayName,l(a)},m)}function k(b){return a.$post(b.id,[],o.entityType,{searchCriteria:o.getSearchCriteria()},o.entityType)}function l(a){var b=a.isNew?"List is created as "+a.displayName:"List "+a.displayName+" is updated";o.onSubmit({status:!0,message:b})}function m(a){o.onSubmit({status:!1}),n()}function n(){a.api(o.entityType).then(function(a){var b=_.map(a,function(a){return{id:a.id,displayName:a.displayName}});o.availableFollowLists=_.sortBy(b,"displayName"),o.availableFollowLists.unshift(p)})}var o=this,p={id:0,displayName:"New List"};o.availableFollowLists=[],o.selectedFollowList=p,o.newListName="",o.isAllowSave=f,o.errorMesssage=h,o.saveAsSubmit=c,o.saveAsCancel=d,o.onSelectExistingList=e,n()}a.$inject=["listsDirectiveService","Flash"],angular.module("dorgEuiApp").component("bulkMatchFollowList",{bindings:{returnCallback:"<",onCancel:"<",onSubmit:"<",entityType:"<",getIds:"<",getSearchCriteria:"<"},templateUrl:"app/components/followList/follow-list.tpl.html",controller:a})}(),function(){"use strict";function a(){}a.$inject=[],angular.module("dorgEuiApp").component("hgDataLogo",{templateUrl:"app/components/hgData/hgDataLogo/hg-data-logo.tpl.html",controller:a})}(),function(){"use strict";function a(a){function b(){a.put().then(c,angular.noop)}function c(){d.success=!0}var d=this;b()}a.$inject=["liveAgentChatService"],angular.module("dorgEuiApp").controller("liveAgentChatController",a)}(),function(){"use strict";function a(a){a.state("live-agent-chat",{url:"/live-agent-chat",controller:"liveAgentChatController",controllerAs:"vm",templateUrl:"app/components/live-agent-chat/live-agent-chat.template.html"})}a.$inject=["$stateProvider"],angular.module("dorgEuiApp").config(a)}(),function(){"use strict";function a(a){function b(){return a.put("api/featureflag/customersupport/until/close")}return{put:b}}a.$inject=["$http"],angular.module("dorgEuiApp").service("liveAgentChatService",a)}(),function(){"use strict";function a(){}angular.module("dorgEuiApp").component("lockedBoxLine",{bindings:{heading:"@",fakeContent:"@",isALink:"<",onOpenLockedModal:"&"},templateUrl:"app/components/locked-box/line/locked-box-line.tpl.html",controller:a})}(),function(){"use strict";var a=function(a,b,c,d,e){function f(){h={container:j,content:k,closer:l,template:i.popUpTemplate},n(i.headQuarters,i.satellites,h,i.popUpCallBack,i.expandMapFunction)}function g(a){if(!a)return!1;var b=!1,c=["_links.uploadCompany","_links.uploadCompanyToMAT","_links.uploadCompanyToSDR","_links.uploadContact","_links.uploadLead","_links.uploadContactToMAT","_links.uploadLeadToMAT","_links.uploadContactToSDR","_links.uploadLeadToSDR"];return _.forEach(c,function(c){if(_.has(a,c))return b=!0,!1}),_.has(a,"$has")&&(a.$has("uploadContact")||a.$has("uploadLead"))&&(b=!0),_.has(a,"company")?e.checkUserHasAllowedLeadOrContactUpload()&&b:b}var h,i=this,j=document.getElementById("popup"),k=$("#popup-content"),l=document.getElementById("popup-closer"),m=40;i.popUpData=[],i.additionalData=[],i.getOfficeNumberThenCompanyNumberOrBlank=d.getOfficeNumberThenCompanyNumberOrBlank,i.canUpload=g,i.$onInit=f;var n=function(d,e,f,g,h){function j(a){var b=_.flatten(a.map(function(a){return a.getGeometry().getCoordinates()})),c={lat:[],lon:[]};return b.forEach(function(a,b){c[b%2===0?"lat":"lon"].push(a)}),[_.min(c.lat),_.min(c.lon),_.max(c.lat),_.max(c.lon)]}var k=[],n=[],o={};d&&d.location&&(k=[d.location.longitude,d.location.latitude]);var p=new ol.source.OSM({attributions:[new ol.Attribution({html:'All maps &copy; <a href="http://www.openstreetmap.org/copyright/">Open Street Maps</a>'}),ol.source.OSM.ATTRIBUTION],crossOrigin:null,url:"https://maps.discoverydb.com/{z}/{x}/{y}.png"}),q=new ol.layer.Tile({source:p});d&&e.push(d),_.each(e,function(a){a.location&&a.location.latitude&&a.location.longitude&&(a.location.longitude===k[0]&&a.location.latitude===k[1]?a.isHq=!0:a.isHq=!1,a.location.id&&(o[a.location.id]||(o[a.location.id]=[]),o[a.location.id].push(a)))}),_.each(Object.keys(o),function(a){var b=o[a],c=new ol.Feature({geometry:new ol.geom.Point(ol.proj.fromLonLat([b[0].location.longitude,b[0].location.latitude])),attributes:{info:b}});n.push(c)});var r,s=new ol.source.Vector({features:n}),t=new ol.source.Cluster({distance:m,source:s}),u=new ol.layer.Vector({source:t,style:function(a){var b=a.get("features"),c=b.length,d="#3399CC";b.forEach(function(a){a.get("attributes").info[0].isHq&&(d="#FFB900")});var e=new ol.style.Style({image:new ol.style.Circle({radius:15,stroke:new ol.style.Stroke({color:"#fff"}),fill:new ol.style.Fill({color:d})}),text:new ol.style.Text({text:c.toString(),fill:new ol.style.Fill({color:"#fff"}),font:"13px sans-serif"})});return e}}),v=new ol.Overlay({element:f.container,autoPan:!0,autoPanAnimation:{duration:250},offset:[20,-20]}),w=function(b,c){v.setPosition(b),i.popUpData=null,i.popUpData=c,g&&(i.additionalData=null,i.currentId=c[0].id,g(c).then(function(a){a&&i.currentId===a[0].company.id&&(i.additionalData=a)})),a.$apply()},x=function(a){function b(b){var c=b||{},d=document.createElement("i");d.className="glyphicon glyphicon-resize-full";var e=document.createElement("button");e.appendChild(d);var f=document.createElement("div");f.className="expand-corner ol-unselectable ol-control",f.appendChild(e),a.call(this,{element:f,target:c.target}),e.addEventListener("click",this.handleExpandMap.bind(this),!1)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.handleExpandMap=function(){h()},b}(ol.control.Control);r=h?new ol.Map({controls:ol.control.defaults().extend([new x]),layers:[q,u],target:"map",view:new ol.View({center:[0,0],maxZoom:15,minZoom:2,zoom:2}),interactions:ol.interaction.defaults({mouseWheelZoom:!1}),overlays:[v]}):new ol.Map({layers:[q,u],target:"map",view:new ol.View({center:[0,0],maxZoom:15,minZoom:2,zoom:2}),interactions:ol.interaction.defaults({mouseWheelZoom:!1}),overlays:[v]});var y=u.getSource().getSource().getExtent();y[0]!==1/0&&r.getView().fit(y),f.template&&(f.closer.onclick=function(){return v.setPosition(void 0),l.blur(),!1},c(f.template).then(function(c){var d=angular.element(c);f.content.empty(),f.content.append(d),b(d)(a)}),r.on("click",function(a){var b=u.getSource().getClosestFeatureToCoordinate(a.coordinate),c=b.get("features");1===c.length&&(w(c[0].getGeometry().getCoordinates(),c[0].get("attributes").info),$("#popup-content").scrollTop(0))}),r.on("dblclick",function(a){var b=u.getSource().getClosestFeatureToCoordinate(a.coordinate),c=b.get("features");c.length>1&&(r.getView().fit(j(c),r.getSize()),r.getView().getZoom()===r.getView().getMaxZoom()?r.getView().setZoom(r.getView().getMaxZoom()):r.getView().setZoom(r.getView().getZoom()-2))}),r.on("pointermove",function(a){var b=[],c=r.getEventPixel(a.originalEvent),d=r.forEachFeatureAtPixel(c,function(a){return a});d&&(b=d.get("features")),1===b.length&&(w(b[0].getGeometry().getCoordinates(),b[0].get("attributes").info),$("#popup-content").scrollTop(0))})),r.getView().on("change:resolution",function(a){var b=a.target,c=u.getSource(),d=c.getDistance();b.getZoom()>14&&d>0?c.setDistance(0):b.getZoom()<=14&&0==d&&c.setDistance(m)})}};a.$inject=["$scope","$compile","$templateRequest","phoneNumberService","userSettingsService"],angular.module("dorgEuiApp").component("map",{templateUrl:"app/components/map/map.html",bindings:{headQuarters:"<",satellites:"<",popUpTemplate:"@",popUpCallBack:"<",expandMapFunction:"<"},controller:a})}(),function(){"use strict";function a(){return{link:function(){function a(){if($("#installChromeExtension")[0]){var b,c=!1,d=_.isEmpty($("#logo"))?0:$("#installChromeExtension").position().left-($("#logo").position().left+$("#logo").width());(d<0||d>50)&&(b=parseInt($("#installChromeExtension").find(".installExtensionText").css("font-size"),10)),d<0&&b>3?c=b-2+"px":d>50&&b<13&&(c=b+1+"px"),c&&$("#installChromeExtension").find(".installExtensionText").css("font-size",c)}else window.removeEventListener("resize",a,!0)}window.addEventListener("resize",a,!0),a()},restrict:"A"}}angular.module("dorgEuiApp").directive("gceFit",a)}(),function(){"use strict";function a(a,b,c,d,e){function f(){p.invalidDescription=!1,p.invalidName=!1}function g(){b.close()}function h(a){p.methodOfContact=a}function i(a){p.hourOrDay=a}function j(a){return _.isEmpty(a)||_.isEmpty(_.trim(a))}function k(b){return a.isValidRegex(b,a.internationalPhoneBasic)||j(b)}function l(a){p.invalidDropdown=!1,p.selectedDropdownValue=a,a&&(p.dropdownValueIsSelected=!0)}function m(b){p.invalidEmail=!1;var c=a.isValidRegex(b,a.emailRegex);c||(p.invalidEmail=!0)}function n(a){p.invalidPhone=!1,k(a)||(p.invalidPhone=!0)}function o(){if(p.fullName.length<5||p.invalidName)return void(p.invalidName=!0);if(!p.selectedDropdownValue)return void(p.invalidDropdown=!0);if(p.description.length<=5||p.invalidDescription)return void(p.invalidDescription=!0);if(!a.isValidRegex(p.email,a.emailRegex)||j(p.email))return void(p.invalidEmail=!0);if(!k(p.phone)||j(p.phone))return void(p.invalidPhone=!0);p.requestInitiated=!0;var d={supportDescription:p.description,supportEmail:p.email,supportContactMethod:p.methodOfContact,supportPhone:p.phone,supportProblem:p.selectedDropdownValue,supportContactTimeline:p.hourOrDay,supportName:p.fullName};c.post(d).then(function(){e.create("success","Message Successfully Submitted","flash")},function(){e.create("error","Message Failed to Submit! Please Try Again.","fail")}).finally(function(){b.close()})}var p=this;p.allFalse=f,p.close=g,p.changeEmailOrPhone=h,p.changeHourOrDay=i,p.description="",p.dropdownValueIsSelected=!1,p.email=d.email||"",p.fullName=d.fullName||"",p.invalidDescription=!1,p.invalidDropdown=!1,p.invalidEmail=!1,p.invalidPhone=!1,p.invalidName=!1,p.phone=d.phone||"",p.phoneIsValid=k,p.requestInitiated=!1,p.selectDropdownOption=l,p.selectedDropdownValue=null,p.send=o,p.validateEmail=m,p.validatePhone=n,p.hourDayArray=d.timelineArray.sort(),p.contactArray=d.contactArray,p.supportProblems=d.supportProblems,p.hourOrDay=p.hourDayArray[0],p.methodOfContact=p.contactArray[0]}a.$inject=["dorgValidation","$uibModalInstance","EmailModalService","fullInfo","Flash"],angular.module("dorgEuiApp").controller("helpAndTrainingEmailModalController",a)}(),function(){"use strict";function a(a,b){function c(c){return b.track("Email Modal","Help and Training Email Modal","Sent"),a.post("api/rest/support/request/v3",c)}function d(){return a.get("api/rest/support/categories/v3/problem")}function e(){return a.get("api/rest/support/categories/v3/contactmethod")}function f(){return a.get("api/rest/support/categories/v3/contacttimeline")}return{getContactMethod:e,getContactTimeline:f,getSupportProblems:d,post:c}}a.$inject=["$http","$ga"],angular.module("dorgEuiApp").service("EmailModalService",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){if(S.showListMatchNotification=!1,X=!0,S.unviewList&&S.unviewList.length>0){var a=_.map(S.unviewList,function(a){return a.bpsBatchId});q.notificationsListUnviewed(a)}}function t(){_.isEmpty(Y)||U!==d.current.name?u(!1):q.isOppAlertSearchType(Y)?u(!0):(d.go(V),u(!1))}function u(a){g.open({templateUrl:"app/components/bulkMatch/bulkMatchModal/bulk-match-modal.tpl.html",controller:"bulkMatchModalController as $ctrl",size:"lg",backdrop:"static",windowClass:"search-bulk-match",resolve:{isForOppAlert:function(){return a}}}).result.then(function(c){if(c.data&&c.data.length){var e={listMatchResultIds:{isCompany:c.isCompany,ids:c.data}},f=V;return c.isCompany&&a&&(f=U),void(f===d.current.name?b.$broadcast("viewEntitiesInAdvancedSearchOrOppAlert",e):d.go(f,e))}if(c.runAnother)return void u(a)}),setTimeout(function(){s(),q.showHistory()},500)}function v(){return!(h.innerWidth>S.firstUL+S.secondUL+S.mainNavBarPadding&&h.innerWidth>=1024)}function w(){!_.isUndefined(S.promotionalBanner)&&S.promotionalBanner.url&&(1===S.promotionalBanner.linkTarget?window.open(S.promotionalBanner.url,"_self"):2===S.promotionalBanner.linkTarget?window.open(S.promotionalBanner.url,"_blank"):3===S.promotionalBanner.linkTarget&&window.open(S.promotionalBanner.url,"popup","width=600,height=600"))}function x(){var a=!0,b=window.localStorage&&window.localStorage.bannerHideDate?parseInt(window.localStorage.bannerHideDate,10):null;return b&&!_.isNaN(b)&&S.promotionalBanner&&S.promotionalBanner.lastPublishTime&&(a=S.promotionalBanner.lastPublishTime>b),a}function y(){S.showBanner=!1,window.localStorage&&(window.localStorage.bannerHideDate=(new Date).getTime())}function z(){return i.$promotionalBanner().then(function(a){S.promotionalBanner=a,window.localStorage&&(window.localStorage.loadPromotionalBannerDate=(new Date).getTime(),window.localStorage.promotionalBanner=JSON.stringify(a))})}function A(){g.open({controller:"ResearchRequestController_dep",templateUrl:"app/components/navbar/researchRequest.modal.html"})}function B(){var a,b,c,d=n.getSupportProblems(),e=n.getContactMethod(),f=n.getContactTimeline();o.all([d,e,f]).then(function(d){return a=d[0].data,b=d[1].data,c=d[2].data,a.length>0&&b.length>0&&c.length>0?void g.open({controller:"helpAndTrainingEmailModalController",controllerAs:"vm",templateUrl:"app/components/navbar/help-and-training-email-modal/help-and-training-email-modal.template.html",windowClass:"open-email-us-modal-window",resolve:{fullInfo:function(){return{fullName:S.Session.account.firstName+" "+S.Session.account.lastName,email:S.Session.account.email,phone:S.Session.account.phone,supportProblems:a,contactArray:b,timelineArray:c}}}}):o.reject()}).catch(function(){p.create("error","It appears an error occurred. Please wait a minute and try again.","fail")})}function C(a){a.preventDefault(),a.stopPropagation(),S.phoneNumberDisplayed=!S.phoneNumberDisplayed}function D(a){if(Q){if(a.preventDefault(),a.stopPropagation(),S.contactSupportClicked=!S.contactSupportClicked,S.contactSupportClicked){var b=$("#mobile-nav"),c=b.find("li").first();if(c.hasClass("open")){var d=c.find("ul.dropdown-menu").first();angular.element(document).ready(function(){var a=d.find(".account-nav-chat-tab").first(),b=d.offset().top+d.outerHeight();if(b<=a.offset().top+Z){var c=a[0].offsetTop-d.outerHeight()+Z;d.scrollTop(c)}})}}}else window.open("https://discoverorg.desk.com/customer/portal/articles/2843454-contact-us","_blank")}function E(){g.open({controller:["$scope","$uibModalInstance",function(a,b){a.loading=!0,i.$fetchAcctMgr().then(function(b){a.acct={email:b.accountManagerEmail,name:b.accountManagerName,phone:b.accountManagerPhone},a.loading=!1}),a.close=function(){b.dismiss("Closed")}}],templateUrl:"app/components/navbar/accountManager.modal.html"})}function F(a){return d.includes(a);
}function G(){return P=document.getElementById(S.sfChatLiveAgentOnlineButtonId),"none"!==P.style.display}function H(){S.contactSupportClicked=!1}function I(){var a=document.getElementsByTagName("head")[0],b=document.createElement("script"),c=S.Session.account.firstName+" "+S.Session.account.lastName||"",d=S.Session.account.username||"",e=S.Session.account.phone||"",f=S.Session.company.companyName||"",g=S.Session.company.accountManagerName||"",h=S.Session.company.contactPhone;liveagent.setName(c),liveagent.addCustomDetail("Client Name",c),liveagent.addCustomDetail("Username",d),liveagent.addCustomDetail("Account Name",f),liveagent.addCustomDetail("Account Manager",g),e?liveagent.addCustomDetail("Client Phone",e):h&&liveagent.addCustomDetail("Account Phone",h),b.type="text/javascript",b.innerHTML="if (!window._laq) { window._laq = []; } window._laq.push(function(){ liveagent.showWhenOnline('"+S.servicecloud.buttonId+"', document.getElementById('liveagent_button_online')); liveagent.showWhenOffline('"+S.servicecloud.buttonId+"', document.getElementById('liveagent_button_offline')); });",a.appendChild(b),liveagent.init(S.servicecloud.chatServerUrl,S.servicecloud.chatDeploymentId,S.servicecloud.chatOrgId),S.liveagentstartChat=function(){liveagent.startChat(S.servicecloud.buttonId)}}function J(){return z().then(function(){S.showBanner=x()})}function K(a,b){r.downloadFile(a,b),S.completedExports=S.completedExports.filter(function(b){return b.downloadJobId!=a}),S.showExportNotification=S.completedExports.length>0,window.location.href=b}function L(){if(S.completedExports.length&&S.completedExports.length>0){var a=_.map(S.completedExports,function(a){return a.downloadJobId});r.notificationsListViewed(a),S.completedExports.length=[],S.showExportNotification=!1}}function M(a){switch(a){case"COMPANY":a="Company";break;case"PERSON":a="Employee";break;case"INTEL":a="Scoops";break;case"CONSUMER":a="OppAlerts";break;case"USAGE_TRACK":a="Usage Report";break;case"PERSON_OPT_OUT":a="Person Opt Out";break;case"CORPORATE_HIERARCHY":a="Corporate Hierarchy";break;case"TIER_2_COMPANY":a="Company - Technology Generated";break;case"TIER_2_PERSON":a="Employee - Technology Generated";break;default:a="UNKNOWN"}return a}function N(){S.contactSupportClicked=!1,angular.element(document).ready(function(){var a=$("#mobile-nav"),b=a.find("li").first();if(b.hasClass("open")){var c=b.find("ul.dropdown-menu").first();c.scrollTop(0)}})}function O(a){return a&&(S.doziToggleState=!S.doziToggleState),S.doziToggleState?(S.toggleToDoziLoading=!0,void i.toggleToDozi().then(function(a){a&&a.headers&&(h.location.href=a.headers("Location")),S.toggleToDoziLoading=!1},function(){S.doziToggleState=!1,S.toggleToDoziLoading=!1})):void(S.doziToggleState=!0)}var P,Q,R,S=this,T=[],U="view_top_content_consumers",V="perform_search",W=[{display:"Advanced Search",icon:"fa fa-search fa-fw",root:"perform_search",state:"perform_search"},{display:"Dashboard",icon:"fa fa-dashboard fa-fw",root:"viewDashboard",state:"viewDashboard"},{display:"AccountView",icon:"fa fa-pie-chart fa-fw",root:"view_abm",state:"view_abm"},{display:"My Lists",icon:"fa fa-list fa-fw",root:"user_lists_base",state:"viewMyLists"},{display:"My Alerts",icon:"fa fa-bell fa-fw",root:"viewMyAlerts",state:"viewMyAlerts"},{display:"OppAlerts",icon:"fa fa-bolt fa-fw",root:"view_top_content_consumers",state:"view_top_content_consumers"},{display:"Usage Reports",icon:"fa fa-area-chart fa-fw",root:"view_usage_report",state:"view_usage_report"}];S.sfChatLiveAgentOnlineButtonId=m.liveAgentOnlineButtonId(),S.showBanner=!1,S.Session=b.Session,S.goToUrl=w,S.bannerClose=y,S.researchRequest=A,S.openEmailUsModal=B,S.showPhoneNumber=C,S.showSupport=D,S.accountManager=E,S.isActive=F,S.isSfLiveAgentOnline=G,S.uponOpeningDropdown=H,S.initializeservicecloud=I,S.downloadExportFile=K,S.downloadNotificationsViewed=L,S.setEntityType=M,S.showListMatchNotification=!1,S.dismissListMatchNotification=s,S.dismissAndViewImportHistory=t,S.parentChildQuickSearchFlag=l.findFeatureFlag(null,"parent_child_qk_srch"),S.showExportNotification=!1,S.onExportHistoryPage=h.location.href&&h.location.href.indexOf("#/export-history")!==-1,S.expandCloseMobileNavbar=N,S.doziToggleState=!1,S.toggleToDozi=O,S.toggleToDoziLoading=!1,S.isDoziToggleDisplayed=b.Session.$activeToggleToDozi;var X=!1,Y="",Z=38;c.landing=!1,c.$on("listMatchNotification",function(a,b){b.isUnviewed?(S.unviewList=b.unviewedListMatchResults,S.showListMatchNotification=!X,Y=b.requestType):(S.showListMatchNotification=!1,X=!1,Y="")}),c.$on("exportCompleteNotification",function(a,b){null!=b.completedExports&&b.completedExports.length>0?(S.completedExports=b.completedExports,S.showExportNotification=h.location.href&&h.location.href.indexOf("#/export-history")==-1):S.showExportNotification=!1}),b.$on("$stateChangeSuccess",function(){S.showHeader="viewQuickSearch"!==b.$state.current.name,_.isUndefined(S.promotionalBanner)&&z()}),b.$on("$locationChangeSuccess",function(){h.location.href&&h.location.href.indexOf("#/export-history")!==-1&&(S.showExportNotification=!1)}),c.$on("$destroy",function(){angular.isDefined(R)&&(f.cancel(R),R=void 0)}),h.addEventListener("resize",function(){S.hamburgerTime=v(),i.setHamburgerTime(S.hamburgerTime),c.$apply()}),S.$onInit=function(){J(),l.getFeatureFlags().then(function(a){var b=_.findWhere(a.data,{name:"servicecloudhelp"});Q=b&&b.active}),m.fetchAllProps().then(function(a){S.servicecloud=a[0].data,S.Session.company=a[1].data,S.Session.account=a[2].data;var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript",c.src=S.servicecloud.chatScriptUrl,c.onreadystatechange=S.initializeservicecloud,c.onload=S.initializeservicecloud,b.appendChild(c)}),S.Session.authenticated&&(S.showHeader=!0,S.sQRunning=!1,S.$lms=i.$lms,S.hamburgerTime=!1,S.canManageUsers=b.Session.navigation.$has("view_users"),_.each(W,function(a){(b.Session.navigation.$has(a.state)||"view_abm"===a.state)&&T.push(a)}),S.accountSubMenu=T,angular.element(document).ready(function(){S.showHeader="viewQuickSearch"!==b.$state.current.name;var a;S.mainNavBar=k[0].querySelectorAll("#main-nav"),_.isEmpty(S.mainNavBar)||(a=S.mainNavBar[0].querySelectorAll("ul.list-inline")),S.mainNavBarPadding=50,S.firstUL=a[0].clientWidth,S.secondUL=a[1].clientWidth,S.mainNavBar&&a&&2===a.length&&a[0].clientWidth>0?S.hamburgerTime=v():S.hamburgerTime=!1,i.setHamburgerTime(S.hamburgerTime)}))}}a.$inject=["$ga","$rootScope","$scope","$state","$timeout","$interval","$uibModal","$window","navigation","quickSearch","$element","featureFlagService","serviceCloudChatService","EmailModalService","$q","Flash","bulkMatchService","exportHistoryService"],angular.module("dorgEuiApp").component("navBarComponent",{templateUrl:"app/components/navbar/navbar.html",controllerAs:"vm",bindings:{showHeader:"="},controller:a})}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){return f.$get(e.Session.resource.$href("navigation"))}function h(){return f.$get(e.Session.navigation.$href("researchRequest")).then(function(a){return a})}function i(a,d){return b.track("Navigation","Research Request","Sent"),c.post("api/rest/researchrequest/v2?researchRequestType="+a,d)}function j(){return b.track("Navigation","Account Manager","Click"),e.Session.navigation.$get("companyProfile")}function k(){var a=e.Session.navigation.$href("promotionalBanner");return c.get(a).then(function(a){return a.data})}function l(a){p=a}function m(a){return p}function n(){return c.get("api/rest/toggle-login/redirect-info")}var o=this,p=!1;o.$fetchAcctMgr=j,o.$fetchResearch=h,o.submitResearchRequest=i,o.get=g,o.$promotionalBanner=k,o.setHamburgerTime=l,o.getHamburgerTime=m,o.toggleToDozi=n,o.$post=function(a){return b.track("Navigation","Research Request","Sent"),c.post(e.Session.navigation.$href("researchRequest"),a.researchRequest,{params:{researchRequestType:a.researchRequestType}}).then(function(a){return a})}}angular.module("dorgEuiApp").service("navigation",a),a.$inject=["$embeddedUtils","$ga","$http","$q","$rootScope","halClient"]}(),function(){"use strict";function a(a,b,c,d,e){a.companyName="",a.companyUrl="",a.contactName="",a.maxCompanyLength=90,a.maxContactLength=70,a.miscData="",a.tmpModel=[],a.hasFeature=!1,a.validForm=!0;var f=function(){a.hasFeature=b.findFeatureFlag(null,"RRO"),b.getFeatureFlags().then(function(c){a.hasFeature=b.findFeatureFlag(c.data,"RRO")})};f(),a.companyName="",a.companyUrl="",a.contactName="",a.maxCompanyLength=90,a.maxContactLength=70,a.miscData="",a.tmpModel=[],a.validForm=!0,e.$fetchResearch().then(function(b){a.catList=b.categories.filter(function(a){return a.id<10}),a.catListSelections=""+b.categories[0].id,a.depts=b.departments});var g=["","NEW_COMPANY","NEW_EMPLOYEE_FOR_COMPANY","PHONE_NUMBER","REPORTING_STRUCTURE","OTHER"];a.confirm=function(){var b=[];switch(a.validForm=!0,a.catListSelections){case"1":b=["companyName","companyURL","tmpModel"];break;case"2":case"3":case"4":b=["companyName","contactName"];break;case"5":b=["miscData"]}_.each(b,function(b){a[b]&&a[b].length||(a.validForm=!1)}),a.validForm&&e.$post({researchRequest:{companyName:a.companyName,companyUrl:a.companyURL,departmentIds:a.tmpModel,employeeName:a.contactName,message:a.miscData},researchRequestType:g[a.catListSelections]}).then(function(a){c.close(),d.create("success","Research Request successfully sent","flash")},function(a){c.close(),d.create("error","Research Request unsuccessfully sent","fail")})},a.close=function(){c.dismiss("cancel")}}a.$inject=["$scope","featureFlagService","$uibModalInstance","Flash","navigation"],angular.module("dorgEuiApp").controller("ResearchRequestController_dep",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(){y.companyQuery="",y.departmentIds=[],y.disableDepartments=!1,y.emailAddress="",y.newPersonName="",y.personNotFound=!1,y.personQuery="",y.phoneNumber="",y.selectedCompanyId=null,y.companyWebsite="",y.selectedPersonId=null,y.showWarnings=!1,y.technology="",y.title="",y.hasCompanyId=!1}function i(){y.selectedCompanyId&&_.isEqual(y.companyQuery,z)||(y.companyQuery="",y.hasCompanyId=!1)}function j(){_.isEqual(y.companyQuery,z)||(y.selectedCompanyId=null)}function k(){y.selectedPersonId||(y.personQuery="")}function l(){c.dismissAll()}function m(a){y.companyQuery=z=a.displayName,y.selectedCompanyId=a.id,v(y.selectedCompanyId),y.hasCompanyId=!0}function n(){var a,c={11:"NEW_EMPLOYEE_EXISTING_PROFILE_V2",12:"REPORTING_STRUCTURE_V2",14:"NEW_COMPANY_NEW_DEPARTMENT_V2"};return x()?void(y.showWarnings=!0):(y.showWarnings=!1,a={newCompanyName:y.companyQuery,newPersonName:y.newPersonName,title:y.title,emailAddress:y.emailAddress,phoneNumber:y.phoneNumber,technology:y.technology,website:y.companyWebsite},a.departments=[],y.departmentIds.length&&_.each(y.departmentIds,function(b){a.departments.push(_.findWhere(y.departments,{id:b}).displayName)}),"11"===y.researchOptionId?a.newPersonName=y.newPersonName:a.newPersonName=y.personQuery.split(" - ")[0],y.submitting=!0,void e.submitResearchRequest(c[y.researchOptionId],a).then(function(){d.create("success","Research Request Successfully Submitted","flash"),l()},function(){b.open({controller:["$uibModalInstance",function(a){this.close=function(){a.close()}}],controllerAs:"$ctrl",templateUrl:"app/components/navbar/researchRequest/researchRequest.error.html"})}).finally(function(){y.submitting=!1}))}function o(){a(function(){y.departmentIds.length>1?y.disableDepartments=!0:y.disableDepartments=!1})}function p(a){return _.contains(y.departmentIds,a.id)}function q(a){return!!y.showWarnings&&_.contains(y.missingFields,a)}function r(){h(),e.$fetchResearch().then(function(a){y.departments=_.remove(a.departments,function(a){return!_.isEqual(a.displayName,"Customer Service")}),y.researchOptions=_.filter(a.categories,function(a){if(a.id>10)return!0}),y.researchOptionId=""+y.researchOptions[0].id})}function s(a){a.id?(y.newPersonName=a.displayName,y.selectedPersonId=a.id):(y.newPersonName="",y.selectedPersonId=null)}function t(a){a.id?(y.personQuery=a.displayName,y.selectedPersonId=a.id):(y.personQuery="",y.selectedPersonId=null)}function u(a){return y.personInCompanyList.filter(function(b){return b.displayName.toLowerCase().indexOf(a.toLowerCase())!==-1})}function v(a){f.getPersonInCompany(a).then(function(a){y.personInCompanyList=a.data,y.hasCompanyId=!0})}function w(a,b){return"COMPANY"===b?(y.showCompanySpinner=!0,y.selectedCompanyId=null):(y.showPersonSpinner=!0,y.selectedPersonId=null),g.$quickSearch(a).then(function(a){return y.showCompanySpinner=!1,y.showPersonSpinner=!1,_.where(a,{entityType:b})})}function x(){var b=[],c=[],d=/[^\s@]+@[^\s@]+\.[^\s@]+/,e={newPersonName:2,title:2,technology:1};if(y.submitting)return!0;if(y.emailAddress.length&&!d.test(y.emailAddress))return a(function(){y.invalidEmail=!0},500),!0;if("14"===y.researchOptionId&&y.departmentIds.length<1)return!0;switch(y.invalidEmail=!1,y.researchOptionId){case"11":c=["selectedCompanyId","newPersonName","title"];break;case"12":c=["selectedCompanyId","selectedPersonId"];break;case"13":c=["technology"];break;case"14":c=["companyQuery","companyWebsite"]}return _.each(c,function(a){(!y[a]||e[a]&&y[a].length<e[a])&&b.push(a)}),_.isEqual(y.missingFields,b)||(y.missingFields=b),!!b.length}var y=this,z="";y.blowEmAllAway=h,y.checkCompanySelection=i,y.checkPersonSelection=k,y.filterPersonInCompanyList=u,y.close=l,y.companySelected=m,y.confirm=n,y.departments=[],y.deptChange=o,y.deptIsSelected=p,y.invalidEmail=!1,y.isFieldMissing=q,y.missingFields=[],y.personSelected=t,y.newPersonSelected=s,y.refreshSearch=w,y.researchOptionId="1",y.researchOptions=[],y.showCompanySpinner=!1,y.submitDisabled=x,y.submitting=!1,y.personInCompanyList=[],y.hasCompanyId=!1,y.companyQueryChange=j,r()}a.$inject=["$timeout","$uibModal","$uibModalStack","Flash","navigation","researchRequestService","quickSearch"],angular.module("dorgEuiApp").component("researchRequest",{templateUrl:"app/components/navbar/researchRequest/researchRequest.html",controller:a})}(),function(){"use strict";function a(a){var b=this;b.getPersonInCompany=function(b){return a.get("api/rest/employees/v1/company/"+b+"/names/display")}}angular.module("dorgEuiApp").service("researchRequestService",a),a.$inject=["$http"]}(),function(){"use strict";function a(a){function b(){return a.get("api/configproperty/serviceCloudChatProps")}function c(){var a=[];return a.push(b()),a.push(d()),a.push(e()),Promise.all(a)}function d(){return a.get("api/rest/account/company")}function e(){return a.get("api/rest/account")}function f(){return"liveagent_button_online"}return{fetchAllProps:c,liveAgentOnlineButtonId:f}}a.$inject=["$http"],angular.module("dorgEuiApp").service("serviceCloudChatService",a)}(),function(){"use strict";function a(){function a(){var a=f(k.activeCriteria.topicIds);a.forEach(function(a){var b=_.find(k.selectedTopics,{id:a.id});a.isOpenInSelectedFilter=!0,_.isEmpty(b)||(a.isOpenInSelectedFilter=b.isOpenInSelectedFilter)}),k.selectedTopics=a}function b(a){if(_.isEmpty(a))return void h();if(a.length<j)return void(k.topicsSearchResult=[]);k.topicsSearchResult=[],k.topicsGroupedByCategory.forEach(function(b){var c=_.filter(b.children,function(b){var c=b.displayName.toLowerCase().indexOf(a.toLowerCase());return c>-1});k.topicsSearchResult=k.topicsSearchResult.concat(c)});var b=e(a);_.isEmpty(b)||(k.topicsSearchResult=k.topicsSearchResult.concat(b),k.topicsSearchResult=_.uniq(k.topicsSearchResult,"id")),k.topicsGroupedByCategoryResult=f(k.topicsSearchResult)}function c(b){var c=[];_.forEach(b,function(a){_.findIndex(c,{id:a.id})===-1&&c.push(a)}),k.activeCriteria.topicIds=k.activeCriteria.topicIds.concat(c),k.activeCriteria.topicIds=_.uniq(k.activeCriteria.topicIds,"id"),a()}function d(b){null!=b?_.remove(k.activeCriteria.topicIds,function(a){return _.findIndex(b,{id:a.id})>-1}):k.activeCriteria.topicIds=[],a()}function e(a){var b=_.filter(k.topicsGroupedByCategory,function(b){var c=b.displayName.toLowerCase().indexOf(a.toLowerCase());return c>-1}),c=[];return b.forEach(function(a){c=c.concat(a.children)}),c}function f(a){var b=_.groupBy(a,"cateId"),c=[];return _.forEach(b,function(a,b){if(null!=a[0]){var d=[];_.forEach(a,function(a){_.findIndex(d,{id:a.id})===-1&&d.push(a)}),d=_.sortBy(d,i),c.push({id:a[0].cateId,displayName:a[0].cateDisplayName,topicsNum:d.length,children:d,isOpen:!0})}}),_.sortBy(c,i)}function g(){k.activeCriteria.topicIds=k.activeCriteria.topicIds||[],h(),a()}function h(){k.topicsGroupedByCategoryResult=_.cloneDeep(k.topicsGroupedByCategory),k.topicsGroupedByCategoryResult=_.sortBy(k.topicsGroupedByCategoryResult,i),k.topicsGroupedByCategoryResult.forEach(function(a){var b=a.children;k.topicsSearchResult=k.topicsSearchResult.concat(b)})}function i(a){return a.displayName.toLowerCase()}var j=2,k=this;k.anchorPrefix="opp-alerts-anchor-category-",k.selectedTopics=[],k.topicsSearchResult=[],k.topicKeyword="",k.refreshSelectedTopicToFilter=a,k.findTopics=b,k.selectAll=c,k.clearAll=d,k.$onInit=g}a.$inject=[],angular.module("dorgEuiApp").component("oppAlertsLargeTopicCriteria",{templateUrl:"app/components/oppAlerts/largeTopicCriteria/opp-alerts-large-topic-criteria.tpl.html",controller:a,bindings:{activeCriteria:"=",topicsGroupedByCategory:"<"}})}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(){j();var b=B.topicSearchCategory?B.topicSearchCategory.id:null;a.getAvailableTopicsByCriteria(B.topicSearchName,b,null,0,C).then(function(a){B.availableTopicOptions.data=a.topics.entities,B.availableTopicOptions.total=a.topics.total}),i(),m(),B.manageTopicInfo.isChange=!1}function i(){B.gridCustomerOppalertCurrentTopicsOptions=b.$defaultGrid("customerOppalertTopics",[],void 0,!0,!1),B.gridCustomerOppalertPreviousTopicsOptions=b.$defaultGrid("customerOppalertTopics",[],void 0,!0,!1),B.gridCustomerOppalertPreviousTopicsOptions.onRegisterApi=k,B.gridCustomerOppalertCurrentTopicsOptions.onRegisterApi=l}function j(){a.getUserManageTopicData().then(function(a){B.userManageTopicInfo=a,B.gridCustomerOppalertCurrentTopicsOptions.data=_.cloneDeep(B.userManageTopicInfo.topics),B.userManageTopicInfo.upcomingTopics=_.cloneDeep(B.gridCustomerOppalertCurrentTopicsOptions.data),B.originUpcomingTopics=_.cloneDeep(B.userManageTopicInfo.upcomingTopics),B.alreadyInitUserManageTopicInfo=!0,B.isValidSelectedTopic=null!=B.userManageTopicInfo.topics&&B.userManageTopicInfo.topics.length>0})}function k(a){this.api=a,this.appScope=c,this.paginationPageSize=10,this.selectionRowHeaderWidth=35,this.totalItems=0,this.useExternalFiltering=!0,this.useExternalPagination=!0,this.useExternalSorting=!0,this.enableGridMenu=!1,this.infiniteScrollDown=!0,this.infiniteScrollRowsFromEnd=0;var b=_.findIndex(this.columnDefs,function(a){return"addedByUserName"===a.field});this.columnDefs[b].visible=!1;var e=_.findIndex(this.columnDefs,function(a){return"removedDate"===a.field});this.columnDefs[e].sort={direction:d.DESC,priority:1},this.api.infiniteScroll.on.needLoadMoreData(c,function(){I.pageNumber++,m()}),this.api.core.on.sortChanged(c,function(a,b){0===b.length&&(""===J.colName&&(J.colName=a.columns[0].name,J.order=d.DESC),_.each(a.columns,function(a){a.name===J.colName&&b.push(a)}),b[0].name=J.colName,J.order===d.ASC?b[0].sort.direction=d.DESC:b[0].sort.direction=d.ASC),0!==b.length&&(J.colName=b[0].name,J.order=b[0].sort.direction),I.pageNumber=1,B.gridCustomerOppalertPreviousTopicsOptions.data=[],m()})}function l(a){this.api=a,this.enableGridMenu=!1,this.enableSorting=!1;var b=_.findIndex(this.columnDefs,function(a){return"removedDate"===a.field});this.columnDefs[b].visible=!1}function m(){B.gridCustomerOppalertPreviousTopicsOptions.totalItems&&B.gridCustomerOppalertPreviousTopicsOptions.data&&B.gridCustomerOppalertPreviousTopicsOptions.totalItems<=B.gridCustomerOppalertPreviousTopicsOptions.data.length||a.getPreviousTopics({page:I.pageNumber-1,size:I.pageSize,sortField:J.colName,sortOrder:J.order}).then(function(a){B.gridCustomerOppalertPreviousTopicsOptions.api.infiniteScroll.saveScrollPercentage(),B.gridCustomerOppalertPreviousTopicsOptions.data||(B.gridCustomerOppalertPreviousTopicsOptions.data=[]),B.gridCustomerOppalertPreviousTopicsOptions.data=B.gridCustomerOppalertPreviousTopicsOptions.data.concat(e.$getD(a)),a.page&&(B.gridCustomerOppalertPreviousTopicsOptions.totalItems=a.page.totalElements),B.gridCustomerOppalertPreviousTopicsOptions.api.infiniteScroll.dataLoaded()})}function n(){_.isEmpty(B.topicsToRemove)||(B.topicsToRemove.forEach(function(a){_.remove(B.userManageTopicInfo.upcomingTopics,{topicId:a.topicId})}),B.topicsToRemove=[],B.upcomingTopicsIsChange(),o(0,!1))}function o(b,c,d){if(_.size(B.topicSearchName)<2&&!_.isEmpty(B.topicSearchName)){if(c)return;B.topicSearchName=null}_.isNull(b)||_.isUndefined(b)||(B.availableTopicOptions.currentPage=b);var e=B.topicSearchCategory?B.topicSearchCategory.id:null,f=_.pluck(B.userManageTopicInfo.upcomingTopics,"topicId");null==f&&(f=[]),d&&(f=null),a.getAvailableTopicsByCriteria(B.topicSearchName,e,f,0,C).then(function(a){B.availableTopicOptions.data=a.topics.entities,B.availableTopicOptions.total=a.topics.total,B.userManageTopicInfo.maxAvailableTopic=a.numOfAvailableTopics,E=0})}function p(){if(!(_.isEmpty(B.topicsToAdd)||B.topicsToAdd.length+B.userManageTopicInfo.upcomingTopics.length>B.userManageTopicInfo.maxCurrentTopic)){B.userManageTopicInfo.upcomingTopics||(B.userManageTopicInfo.upcomingTopics=[]);var a=_.clone(B.topicsToAdd);a.forEach(function(a){B.userManageTopicInfo.upcomingTopics.push({id:B.userManageTopicInfo.customerOppAlertId,topicId:a.id,topicName:a.displayName})}),B.topicsToAdd=[],B.upcomingTopicsIsChange(),o(0,!1)}}function q(){if(!(B.availableTopicOptions.total<=B.availableTopicOptions.data.length)){E++;var b=B.topicSearchCategory?B.topicSearchCategory.id:null,c=_.pluck(B.userManageTopicInfo.upcomingTopics,"topicId");a.getAvailableTopicsByCriteria(B.topicSearchName,b,c,E,C).then(function(a){B.availableTopicOptions.data=B.availableTopicOptions.data.concat(a.topics.entities)})}}function r(){var b=_.pluck(B.topicsToAdd,"id");if(B.availableTopicOptions.data.length>0)if(B.availableTopicOptions.total>B.availableTopicOptions.data.length){var c=B.topicSearchCategory?B.topicSearchCategory.id:null,d=_.pluck(B.userManageTopicInfo.upcomingTopics,"topicId");null==d&&(d=[]),_.size(B.topicSearchName)<2&&(B.topicSearchName=null),B.topicLoading=!0,a.getAvailableTopicsByCriteriaNoPaging(B.topicSearchName,c,d).then(function(a){a.length>0&&_.forEach(a,function(a){_.includes(b,a.id)||(B.topicsToAdd=B.topicsToAdd.concat(a))}),B.topicLoading=!1})}else _.forEach(B.availableTopicOptions.data,function(a){_.includes(b,a.id)||(B.topicsToAdd=B.topicsToAdd.concat(a))})}function s(){if(B.availableTopicOptions.data.length>0)if(B.availableTopicOptions.total>B.availableTopicOptions.data.length){var b=B.topicSearchCategory?B.topicSearchCategory.id:null,c=_.pluck(B.userManageTopicInfo.upcomingTopics,"topicId");if(_.size(B.topicSearchName)<2&&(B.topicSearchName=null),_.isEmpty(B.topicSearchName)&&!b)return void(B.topicsToAdd=[]);B.topicLoading=!0,a.getAvailableTopicsByCriteriaNoPaging(B.topicSearchName,b,c).then(function(a){a.length>0&&_.forEach(a,function(a){_.remove(B.topicsToAdd,{id:a.id})}),B.topicLoading=!1})}else _.forEach(B.availableTopicOptions.data,function(a){_.remove(B.topicsToAdd,{id:a.id})})}function t(){var a=_.difference(_.pluck(B.originUpcomingTopics,"topicId"),_.pluck(B.userManageTopicInfo.upcomingTopics,"topicId")).length,b=_.difference(_.pluck(B.userManageTopicInfo.upcomingTopics,"topicId"),_.pluck(B.originUpcomingTopics,"topicId")).length;return B.manageTopicInfo.isChange=a>0||b>0,B.isValidSelectedTopic=null!=B.userManageTopicInfo.upcomingTopics&&B.userManageTopicInfo.upcomingTopics.length>0,B.manageTopicInfo.isChange}function u(){if(B.isValidSelectedTopic){B.manageTopicInfo.isChange=!1;var b=g.open({controller:["topicsChangeRemaining","$uibModalInstance",function(a,b){var c=this;c.topicsChangeRemaining=a,c.close=function(){b.dismiss("cancel")},c.apply=function(){b.close()}}],controllerAs:"confirmPopupVm",size:"sm",templateUrl:"applyChangeConfirmPopup.html",resolve:{topicsChangeRemaining:function(){return B.userManageTopicInfo.topicChangesRemaining-(B.userManageTopicInfo.havingOldSetting&&B.userManageTopicInfo.topicChangesRemaining>0?1:0)}}});b.result.then(function(){a.saveCustomerTopics(B.userManageTopicInfo.upcomingTopics).then(function(a){a.success?(f.create("success","Save topic changes successfully!","flash"),j(),I.pageNumber=1,B.gridCustomerOppalertPreviousTopicsOptions.data=[],m(),B.onRefresh()):f.create("error","Save topic changes failed!","fail")})},function(){B.manageTopicInfo.isChange=!0})}}function v(a){_.remove(B.userManageTopicInfo.upcomingTopics,{topicId:a.topicId}),o(0,!1)}function w(){return!B.userManageTopicInfo.topicChangesRemaining}function x(a){if(B.manageTopicInfo.currentTab!==a)return B.manageTopicInfo.isChange?y(function(){B.userManageTopicInfo.upcomingTopics=[],z(a),o(0,!1,!0)}):(B.currentTab=a,B.manageTopicInfo.currentTab=a,z(),"MANAGE_TAB_KEY"===a&&o(0,!1,!0),void 0)}function y(a){var b=g.open({controller:["$uibModalInstance",function(a){var b=this;b.close=function(){a.dismiss("close")},b.confirm=function(){a.close("continue")}}],controllerAs:"$ctrl",size:"sm",templateUrl:"app/views/topcontentconsumer/partials/manage-topic-leave-page-without-saving.html"});return b.result.then(function(){a()}),b}function z(b){a.getUserManageTopicData().then(function(a){B.userManageTopicInfo=a,B.gridCustomerOppalertCurrentTopicsOptions.data=_.cloneDeep(B.userManageTopicInfo.topics),B.userManageTopicInfo.upcomingTopics=_.cloneDeep(B.gridCustomerOppalertCurrentTopicsOptions.data),B.originUpcomingTopics=_.cloneDeep(B.userManageTopicInfo.upcomingTopics),b&&(B.currentTab=b,B.manageTopicInfo.currentTab=b),B.manageTopicInfo.isChange=!1,B.isValidSelectedTopic=null!=B.userManageTopicInfo.upcomingTopics&&B.userManageTopicInfo.upcomingTopics.length>0})}function A(){return B.manageTopicInfo.currentTab===G}var B=this,C=50,D=14,E=0,F="current",G="manage",H="previous",I={pageNumber:1,pageSize:25},J={colName:"",order:""};B.userManageTopicInfo={},B.availableTopicOptions={},B.gridCustomerOppalertCurrentTopicsOptions={},B.gridCustomerOppalertPreviousTopicsOptions={},B.topicsToAdd=[],B.isValidSelectedTopic=!0,B.removeCustomerTopics=n,B.searchAvailableTopic=o,B.addCustomerTopics=p,B.loadMoreTopics=q,B.selectAllTopics=r,B.removeAllTopics=s,B.upcomingTopicsIsChange=t,B.saveManageTopics=u,B.undoTopicAdded=v,B.disableEditing=w,B.topic_overflow_limit=D,B.changeTab=x,B.currentTab=F,B.currentTabKey=F,B.manageTabKey=G,B.previousTabKey=H,B.alreadyInitUserManageTopicInfo=!1,B.showTopicChangeRemaining=A,B.$onInit=h}a.$inject=["TopContentConsumerService","$grid","$scope","uiGridConstants","$embeddedUtils","Flash","$uibModal"],angular.module("dorgEuiApp").component("oppAlertsManageTopicComponent",{bindings:{manageTopicInfo:"<",onRefresh:"&"},templateUrl:"app/components/oppAlerts/manage-topic/opp-alerts-manage-topic.tpl.html",controller:a})}(),function(){"use strict";angular.module("dorgEuiApp").component("oppAlertsNoTopicMessage",{templateUrl:"app/components/oppAlerts/noTopic/opp-alerts-no-topic-message.tpl.html"})}(),function(){"use strict";function a(a,b){function c(){e.activeCriteria.score.minValue=!e.activeCriteria.score.minValue||e.activeCriteria.score.minValue<60?60:e.activeCriteria.score.minValue,e.scoreSlider={options:{floor:e.minScore,minLimit:e.minScore,ceil:e.maxScore,showSelectionBarEnd:!0,onChange:function(a,b,c,d){e.score=e.activeCriteria.score.minValue}}},e.score=e.activeCriteria.score.minValue,b(function(){a.$broadcast("rzSliderForceRender")},0)}function d(){return null==e.score?void(e.activeCriteria.score.minValue=e.score=e.minScore):(e.score>e.maxScore?e.score=e.maxScore:e.score<e.minScore&&(e.score=e.minScore),void(e.activeCriteria.score.minValue=e.score))}var e=this;e.changeScore=d,e.$onInit=c}angular.module("dorgEuiApp").component("oppAlertsScoreCriteria",{bindings:{activeCriteria:"=",minScore:"<",maxScore:"<"},templateUrl:"app/components/oppAlerts/scoreCriteria/opp-alerts-score-criteria.tpl.html",controller:["$scope","$timeout",a]})}(),function(){"use strict";function a(){function a(){e.activeCriteria.topicIds=e.activeCriteria.topicIds||[],e.topics=d(e.topicsGroupedByCategory)}function b(){_.each(e.topics,function(a){_.some(e.activeCriteria.topicIds,{id:a.id})||e.activeCriteria.topicIds.push(a)})}function c(a){e.activeCriteria.topicIds=[]}function d(a){if(!_.isEmpty(a)){var b=[];return a.forEach(function(a){b=b.concat(a.children)}),_.sortBy(b,function(a){return a.displayName.toLowerCase()})}}var e=this;e.selectAllTopic=b,e.clearAllTopic=c,e.$onInit=a}angular.module("dorgEuiApp").component("oppAlertsSmallTopicCriteria",{bindings:{activeCriteria:"=",topicsGroupedByCategory:"<"},templateUrl:"app/components/oppAlerts/smallTopicCriteria/opp-alerts-small-topic-criteria.tpl.html",controller:a})}(),function(){"use strict";function a(a){function b(){return a.getIndustriesInfo(c.company).otherIndustryNames}var c=this;this.$onInit=function(){c.otherIndustries=b()}}a.$inject=["companyIndustryService"],angular.module("dorgEuiApp").component("otherIndustries",{bindings:{company:"<"},templateUrl:"app/components/other-industries-popover/other-industries.tpl.html",controller:a})}(),function(){"use strict";function a(a){var b=this;b.OWNERSHIP_PRIVATE_ID=2,b.conciseAddress=a.generateCompanyFullAddressWithoutStreet(b.company,"hqCityName",["hqStateCode","hqCountryCode"]),b.isNotEmptyString=a.isNotEmptyString}angular.module("dorgEuiApp").component("personTierTwoCompanyInfo",{bindings:{company:"<",isCompanyTierTwo:"<"},templateUrl:"app/components/person-tier-two/company-info/person-tier-two-company-info.tpl.html",controller:["tierTwoDataService",a]})}(),function(){"use strict";function a(a){function b(){d.isNotEmptyString=a.isNotEmptyString,d.person.phone=c(),d.lockedContentHeading="Locked Content"}function c(){var a={number:"",note:""};return d.isNotEmptyString(d.person.directDialNumber1)?(a.number=d.person.directDialNumber1,a.note="Direct"):d.isNotEmptyString(d.person.directDialNumber2)?(a.number=d.person.directDialNumber2,a.note="Direct"):d.isNotEmptyString(d.person.directDialNumber3)?(a.number=d.person.directDialNumber3,a.note="Direct"):d.isNotEmptyString(d.person.officeTelNumber)?(a.number=d.person.officeTelNumber,a.note="Office"):d.isNotEmptyString(d.person.mobileTelNumber)&&(a.number=d.person.mobileTelNumber,a.note="Mobile"),a}var d=this;d.$onInit=b}angular.module("dorgEuiApp").component("personTierTwoContactInfo",{bindings:{person:"<",onOpenLockedModal:"&"},templateUrl:"app/components/person-tier-two/contact-info/person-tier-two-contact-info.tpl.html",controller:["personTierTwoService",a]})}(),function(){"use strict";function a(a){var b=this;b.isNotEmptyString=a.isNotEmptyString,b.lockedContentHeading="Locked Content"}angular.module("dorgEuiApp").component("personTierTwoHeader",{bindings:{person:"<",onOpenLockedModal:"&"},templateUrl:"app/components/person-tier-two/header/person-tier-two-header.tpl.html",controller:["personTierTwoService",a]})}(),function(){"use strict";function a(a){var b=this;b.companyFullAddress=a.generateCompanyFullAddressWithoutStreet(b.company,"hqCityName",["hqStateCode","hqPostalCode","hqCountryCode"]),b.isNotEmptyString=a.isNotEmptyString}angular.module("dorgEuiApp").component("personTierTwoLocationInfo",{bindings:{hqLocation:"<",company:"<"},templateUrl:"app/components/person-tier-two/location-info/person-tier-two-location-info.tpl.html",controller:["tierTwoDataService",a]})}(),function(){"use strict";function a(){var a=this;a.BLANK="",a.ONLINE_STATE=4,a.getCareerTime=function(){var b=a.BLANK,c=!1;return a.careerhistory.fromYear&&(b+=a.careerhistory.fromYear,c=!0),a.careerhistory.toYear?(c&&(b+=" - "),b+=a.careerhistory.toYear):c&&(b+=" - ",b+="Present"),b},a.getTitle=function(){var b=a.BLANK,c=!1;return a.careerhistory.title&&a.careerhistory.title.trim()!==a.BLANK&&(b+=a.careerhistory.title,
c=!0),c&&a.careerhistory.companyName&&(b+=" @ "),b},a.isOneRow=function(){var b=0;return(a.careerhistory.title||a.careerhistory.companyName)&&b++,a.careerhistory.location&&b++,(a.careerhistory.fromYear||a.careerhistory.toYear)&&b++,1===b}}a.$inject=[],angular.module("dorgEuiApp").component("personCareerItem",{bindings:{careerhistory:"<",ios:"<",ie:"<",lockcontent:"<",isfirst:"<",islast:"<",ishavescroll:"<"},templateUrl:"app/components/personCareer/item/person-career-item.tpl.html",controller:a})}(),function(){"use strict";function a(){var a=this;a.DEFAULT_ROW=11,a.DEFAULT_ENTRY=3,a.isFirst=function(a){return 0===a},a.isLast=function(b){return b===a.careerhistories.length-1},a.checkRow=function(){if(a.careerhistories.length<=a.DEFAULT_ENTRY)return!1;var b=0;return _.each(a.careerhistories,function(a){var c=0;(a.title||a.companyName)&&(b++,c++),a.location&&(b++,c++),(a.fromYear||a.toYear)&&(b++,c++),1===c&&b++}),b=b+a.careerhistories.length-1,b>a.DEFAULT_ROW}}a.$inject=[],angular.module("dorgEuiApp").component("personCareer",{bindings:{careerhistories:"<",ios:"<",ie:"<",lockcontent:"<"},templateUrl:"app/components/personCareer/person-career.tpl.html",controller:a})}(),function(){"use strict";function a(a){var b=this,c=17;b.loadingData=!0,a.$get(b.personId).then(function(a){b.data=a,b.data.privacyEuRequested=a.stateChangeReasonId===c,b.loadingData=!1})}a.$inject=["PersonService"],angular.module("dorgEuiApp").component("personDetails",{bindings:{personId:"<"},templateUrl:"app/components/personDetails/person-details.tpl.html",controller:a})}(),function(){"use strict";function a(a){var b=this;b.showDetails=!1,b.popoverDelay=200;var c,d=function(){c&&a.cancel(c)};b.mouseLeave=function(){d(),c=a(function(){b.showDetails=!1},b.popoverDelay)},b.mouseOver=function(){d(),c=a(function(){b.showDetails=!0},b.popoverDelay)}}a.$inject=["$timeout"],angular.module("dorgEuiApp").component("personNameWithPopover",{bindings:{personId:"<",personName:"@"},templateUrl:"app/components/personDetailsPopover/person-name-with-popover.tpl.html",controller:a})}(),function(){"use strict";function a(a){var b=this;b.DATE_FORMAT_JUST_YEAR="yyyy",b.getEducationTime=function(){var c="",d=!1;return b.education.fromDate&&(c+=a("date")(b.education.fromDate,b.DATE_FORMAT_JUST_YEAR),d=!0),b.education.toDate?(d&&(c+=" - "),c+=a("date")(b.education.toDate,b.DATE_FORMAT_JUST_YEAR)):(d&&(c+=" - "),c+="Present"),c},b.getSchoolName=function(){return b.education.educationSchool&&b.education.educationSchool.name?b.education.educationSchool.name:b.education.titleRaw?b.education.titleRaw:null},b.isOneRow=function(){var a=0;return(b.education.educationSchool&&b.education.educationSchool.name||b.education.titleRaw)&&a++,(b.education.fromDate||b.education.toDate)&&a++,b.education.educationDegreeType&&b.education.educationDegreeType.name&&a++,b.education.fieldOfStudy&&b.education.fieldOfStudy.name&&a++,1===a}}a.$inject=["$filter"],angular.module("dorgEuiApp").component("personEducationItem",{bindings:{education:"<",ios:"<",ie:"<",lockcontent:"<",isfirst:"<",islast:"<",ishavescroll:"<"},templateUrl:"app/components/personEducation/item/person-education-item.tpl.html",controller:a})}(),function(){"use strict";function a(){var a=this;a.DEFAULT_ROW=9,a.DEFAULT_ENTRY=2,a.isFirst=function(a){return 0===a},a.isLast=function(b){return b===a.educations.length-1},a.checkRow=function(){if(a.educations.length<=a.DEFAULT_ENTRY)return!1;var b=0;return _.each(a.educations,function(a){var c=0;(a.educationSchool&&a.educationSchool.name||a.titleRaw)&&(b++,c++),(a.fromDate||a.toDate)&&(b++,c++),a.educationDegreeType&&a.educationDegreeType.name&&(b++,c++),a.fieldOfStudy&&a.fieldOfStudy.name&&(b++,c++),1===c&&b++}),b=b+a.educations.length-1,b>a.DEFAULT_ROW}}a.$inject=[],angular.module("dorgEuiApp").component("personEducation",{bindings:{educations:"<",ios:"<",ie:"<",lockcontent:"<"},templateUrl:"app/components/personEducation/person-education.tpl.html",controller:a})}(),function(){"use strict";function a(a){function b(){h.showMoreNote=!1,$(g)&&$(g)[0]&&(h.showMoreNote=$(g)[0].scrollHeight>$(g).innerHeight()),h.isEnoughSpace=!h.showMoreNote,h.isShownFullNote=!h.isEnoughSpace&&!h.showMoreNote}function c(){h.showMoreNote||d()||$("html,body").animate({scrollTop:$("#"+h.detailNoteId).offset().top-f+"px"}),h.showMoreNote=!h.showMoreNote,h.isShownFullNote=!h.isEnoughSpace&&!h.showMoreNote}function d(){var a=$(g).offset().top,b=a+$(g).outerHeight(),c=$(window).scrollTop(),d=c+$(window).height();return b<=d&&a>=c}var e="person-note-content",f=95,g="#"+e,h=this;h.personNoteContentId=e,h.toggleShowMore=c,a(function(){b()},0)}angular.module("dorgEuiApp").component("personNote",{bindings:{notes:"<",detailNoteId:"<"},templateUrl:"app/components/personNote/person-note.tpl.html",controller:["$timeout",a]})}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(a){k.sQRunning=!0,b.track("Quick Search","Request","Started");var c=i(k.context);return d.$quickSearch(a,c).then(function(c){k.sQRunning=!1,b.track("Quick Search","Request","Resolved"),c||b.track("Quick Search","Failed","Term: "+a);var d=_.findIndex(c,function(a){return a.isTierTwo===!0});return d!==-1&&(c[d].firstOfTierGroup=!0),c.length>0&&(c[0].firstOfTierGroup=!0),c})}function i(b){var c="landing"===b;return a.Session.account.canAccessTierTwoData?{companyCount:c?4:5,personCount:c?4:10,tierTwoCompanyCount:c?4:3,tierTwoPersonCount:c?4:6}:{companyCount:5,personCount:c?5:10}}function j(d,e){if(k.sQRunning=!0,k.qsQuery=d.displayName,a.$qschChildId=d.childId||null,a.$qschChildName=d.childName||null,"undefined"!=typeof d.uuid){var f,g={uuid:d.uuid};f="COMPANY"===d.entityType?"view_company_tier_two":"view_person_tier_two",c.go(f,g)}else b.track("Quick Search","Request","Selected Result",("COMPANY"===d.entityType?"Company: ":"Person: ")+d.id),c.go("COMPANY"===d.entityType?"view_company":"view_person",{detailsFor:d.id});setTimeout(function(){k.clearSearch()},300)}var k=this;k.sQRunning=!1,k.qsQuery="",k.refreshQuickSearch=h,k.qsSelected=j,k.active=0,k.clearSearch=function(){k.qsQuery="",k.sQRunning=!1},a.$on("$stateChangeSuccess",k.clearSearch)}function b(a){return{restrict:"A",link:function(b,c,d,e){var f=null;b.ctrl_=e,b.$watch("ctrl_.$modelValue",function(c,d){c!==d&&null!==c&&(a.cancel(f),f=a(function(){c.length<1&&b.qsHasError===!0&&(b.qsHasError=!1)},250))})},require:"ngModel"}}a.$inject=["$rootScope","$ga","$state","quickSearch","$window","$location","$anchorScroll"],angular.module("dorgEuiApp").component("quickSearchComponent",{templateUrl:"app/components/quickSearch/quick-search.html",controllerAs:"qs",bindings:{sQRunning:"<",qsQuery:"<",context:"@",active:"<"},controller:a}).directive("scrollToExactMatch",["$timeout",function(a){return{restrict:"A",link:function(b,c){var d=null;b.firstExactMatch=null,b.$watchCollection("matches",function(a){var c=_.findIndex(a,function(a){return a.model.isExactMatch});b.firstExactMatch=c>=0?a[c]:null,c>=0?b.selectActive(c):b.selectActive(0)}),b.$watch("firstExactMatch",function(b){return b?void(d=a(function(){var a=document.getElementById(b.id),d=a.offsetHeight,e=a.offsetTop,f=c[0].offsetHeight,g=c[0].scrollTop,h=c[0].scrollHeight;if(f<=0||d<=0)return!1;var i=e>g&&e+d<g+f;i||(c[0].scrollTop=Math.min(h-f,Math.max(0,e+(f-d/2))))})):void(c[0].scrollTop=0)}),b.$on("$destroy",function(){d&&a.cancel(d)})}}}]).directive("typeaheadCheckErrors",b),b.$inject=["$timeout"]}(),function(){"use strict";function a(a,b,c){function d(a,d,e){var f=a.toLowerCase();a=encodeURI(a);var g=c.Session.navigation.$href("quickSearchV2"),h={params:_.isEmpty(d)?{}:d};return h.params.searchString=a,e=e||-1,b.get(g,h).then(function(a){var b=_.filter(_.get(a.data,"quickSearchResultList",[]));return _.has(a.data,"quickSearchTierTwoResultList")&&(b=b.concat(_.map(_.get(a.data,"quickSearchTierTwoResultList",[]),function(a){return _.assign(a,{isTierTwo:!0})}))),_.each(b,function(a){var b=a.displayName.split(" - ");"PERSON"===a.entityType&&f!==a.displayName?a.isExactMatch=b[0].toLowerCase()===f.split(" - ")[0]:a.isExactMatch=a.displayName.toLowerCase()===f}),e<0?b:{data:b,uuid:e}},function(){return[]})}var e=this;e.$quickSearch=d}angular.module("dorgEuiApp").service("quickSearch",a),a.$inject=["$embeddedUtils","$http","$rootScope"]}(),function(){"use strict";function a(a,b,c){function d(){var a=0;return $(".primary-tabs li").each(function(){var b=$(this).outerWidth();a+=b}),a}function e(){return 0===v?0:$(".primary-tabs").position().left}function f(){return $(".wrapper").outerWidth()}function g(a){var b=$(".primary-tabs li");return!_.isEmpty(b)&&a>=0?$(b[a]).outerWidth(!0):s}function h(){l(!0);var a=f()-d()-t>0;a&&r.moveToLeft()}function i(){c(h,u)}function j(){if(v>0){v--;var a=g(v);$(".primary-tabs").animate({left:"+="+a+"px"},"slow",function(){l(!1)})}}function k(){var a=$(".primary-tabs li");if(!_.isEmpty(a)&&!w){var b=g(v);w=!0,v++,$(".primary-tabs").animate({left:"-="+b+"px"},"slow",function(){l(!1),w=!1})}}function l(a){var b=d()+t-f()+e()>0;b?$(".scroller-right").show():$(".scroller-right").hide(),e()<0?$(".scroller-left").show():(a&&$(".item").animate({left:"-="+e()+"px"},"slow"),$(".scroller-left").hide())}function m(a){"employees"===r.tabs[a].name&&r.orgchartsLoading||r.primaryTabIndex!=a&&r.setSelectedTab(a)}function n(a){r.secondaryTabIndex=r.onTabChange({primaryTabIndex:r.primaryTabIndex,secondaryTabIndex:r.secondaryTabIndex,isPrimaryTabChange:a})}function o(a){if(r.selectedTab=r.tabs[a],r.primaryTabIndex!=a&&(r.secondaryTabIndex=0,r.selectedTab&&r.selectedTab.subtabs)){var b=r.selectedTab.subtabs.tabs;if(!_.isEmpty(b)){var c=_.findIndex(b,function(a){return a.avail});c>=0&&(r.secondaryTabIndex=c)}}r.primaryTabIndex=a,r.setChangeTab(!0)}function p(a){r.secondaryTabIndex=a,r.setChangeTab(!1)}function q(){r.setSelectedTab(0),c(h,u)}var r=this;r.moveToLeft=j,r.moveToRight=k,r.onSelectPrimaryTab=m,r.setChangeTab=n,r.setSelectedTab=o,r.onSelectSecondaryTab=p,r.$onInit=q;var s=140,t=32,u=200,v=0,w=!1,x=6;a.$on("updatePrimaryTab",function(){c(h,u)}),a.$on("switchToCorpHierarchyTab",function(a,b){m(x)}),b.onresize=i}a.$inject=["$scope","$window","$timeout"],angular.module("dorgEuiApp").component("tabSet",{templateUrl:"app/components/tabSet/tab-set.tpl.html",controller:a,controllerAs:"tabSetCtrl",bindings:{tabs:"<",onTabChange:"&",secondaryTabIndex:"<",accessScopeSubjectLine:"<",accessScopeBodyLine:"<",viewPort:"<",orgchartsLoading:"<"}})}(),function(){function a(a,b,c){function d(){e()&&c(k,F)}function e(){return s.tab.name==z}function f(){return!_.isEmpty(s.tab.subtabs)}function g(){s.hasOverflow=!1,s.showMore=!1,s.isLoading=!0}function h(){var a=e();a?$(C).removeClass(x):$(C).addClass(x),$(B).addClass(v);var b=$(D);_.isEmpty(b)||b.each(function(){$(this).removeClass(v)})}function i(){var a=!1,b=$(A);return b&&b[0]&&(a=b[0].scrollHeight>b.innerHeight()),a}function j(a){a?$(B).removeClass(v):$(B).addClass(v)}function k(){s.isLoading=!0,s.showMore=!0,h(),s.hasOverflow=i(),j(s.hasOverflow),l(),s.isLoading=!1}function l(){var a=0,b=m(B,!0),c=m(A),d=!1,e=b,f=$(D),g=f.length;if(g>0){var h=0,i=!1;f.each(function(){h+=1;var f=$(this),j=f.outerWidth(!0),k=h==g,l=h==g-1;if(!d){if(a+=j,l){var m=0,n=f.next();_.isEmpty(n)||(m=n.outerWidth(!0)),e=m||b}else e=k?0:b;c<a+e&&(d=!0,i=c<a||c<a+b-j)}if(d){if(f.addClass(v),i){var o=f.prev();_.isEmpty(o)||o.addClass(v),i=!1}}else f.removeClass(v)})}j(d)}function m(a,b){var c=0,d=$(a);return _.isEmpty(d)||(b=b||!1,c=d.outerWidth(b)||0),c}function n(){s.showMore||o()||$("html,body").animate({scrollTop:$(A).offset().top-E+"px"}),s.showMore?($(C).addClass(x),$(D).each(function(){$(this).removeClass(v)})):($(C).removeClass(x),l()),s.showMore=!s.showMore}function o(){var a=$(A).offset().top,b=a+$(A).outerHeight(),c=$(window).scrollTop(),d=c+$(window).height();return b<=d&&a>=c}function p(){if(q())return"bottom";var a=$(".partial-lock-info-link");return $(window).width()-a.offset().left<2*a.outerWidth()?"bottom-right":"bottom"}function q(){return s.viewPort===y}function r(){return q()&&f()}var s=this,t="subTabContentContainer",u="subTabContentDirectionId",v="hide-item",w="sub-tab-content-container",x="sub-tab-content-container-full",y="Phone",z="orgCharts",A="#"+t,B="#"+u,C="."+w,D=C+" button",E=95,F=1500,G=1e3,H=500,I=1e3;s.hasOverflow=!1,s.showMore=!1,s.isLoading=!0,s.$onInit=d,s.checkTabHasToggleShowMore=e,s.subTabContentContainerId=t,s.subTabContentDirectionId=u,s.toggleShowMore=n,s.showSubTabInPhoneScreenView=r,a.$on("initSubTabItem",function(){c(k,F)}),b.addEventListener("resize",function(){e()&&c(k,I)}),s.getPositionPopoverArrow=p,a.accessScopeSubjectLineInScope=s.accessScopeSubjectLine,a.accessScopeBodyLineInScope=s.accessScopeBodyLine,a.$watch("tabItemCtrl.tab.name",function(a,b){_.isEqual(a,b)||(e()?(g(),h(),c(k,H)):(g(),$(B).addClass(v),c(h,G)))},!0)}a.$inject=["$scope","$window","$timeout"],angular.module("dorgEuiApp").component("tabItem",{templateUrl:"app/components/tabSet/tabItem/tab-item.tpl.html",controller:a,controllerAs:"tabItemCtrl",bindings:{tab:"<",onSelectSecondaryTab:"&",secondaryTabIndex:"<",accessScopeSubjectLine:"<",accessScopeBodyLine:"<",viewPort:"<"}})}(),function(){"use strict";function a(a,b,c){a.courseId?c.navigateToCoursePage(a.courseId):a.returnTo?c.navigateToCustomPage({returnTo:a.returnTo}):c.navigateToMainPage()}function b(a){a.state("thoughtindustries_course_redirect",{url:"/courses/{courseId:string}",template:"",controller:"ThoughtindustriesController"}).state("thoughtindustries_custom_redirect",{url:"/university?returnTo",template:"",controller:"ThoughtindustriesController"})}var c=angular.module("dorgEuiApp");c.config(b),a.$inject=["$stateParams","$window","thoughtindustriesService"],c.controller("ThoughtindustriesController",a),b.$inject=["$stateProvider"]}(),function(){"use strict";angular.module("dorgEuiApp").component("tierTwoContactsButton",{bindings:{company:"<"},templateUrl:"app/components/tierTwoContactsButton/tier-two-contacts-button.tpl.html"})}(),angular.module("dorgEuiApp").controller("dorgAnnouncementsCtrl",["$scope","dorgAnnouncementsService",function(a,b){a.title="DiscoverOrg Announcements",a.spinnerGo=!0,b.feed().then(function(b){a.feed=b,a.spinnerGo=!1})}]),angular.module("dorgEuiApp").service("dorgAnnouncementsService",["$rootScope","$http","$embeddedUtils","$q",function(a,b,c,d){var e=c.$fetchLink(a.Session.dashboard,"dorgAnnouncements");this.feed=function(){return _.isNull(e)?d.reject():b.get(e).then(function(a){return c.$getD(a.data)})}}]),angular.module("dorgEuiApp").controller("intelFeedCtrl",["$scope","intelService","featureFlagService",function(a,b,c){function d(){c.getFeatureFlags().then(function(b){var c=_.findWhere(b.data,{name:"triggerstoscoops"});c&&c.active?a.title="Scoops Feed":a.title="Triggers Feed"})}d(),a.spinnerGo=!0,b.$feed().then(function(b){a.feed=b,a.spinnerGo=!1})}]),angular.module("dorgEuiApp").service("intelService",["$rootScope","$http","$embeddedUtils",function(a,b,c){var d=c.$fetchLink(a.Session.dashboard,"intelFeed");this.$feed=function(){return b.get(d).then(function(a){return c.$getD(a.data)})}}]),angular.module("dorgEuiApp").controller("recentlyAddedCtrl",["$scope","recentlyAddedService","$embeddedUtils","$interval",function(a,b,c,d){a.title="Recently Added Companies and Departments",a.spinnerGo=!0;var e,f=function(){b.$feed().then(function(b){var f,g="",h="";202!==b.status&&(a.feed=c.$getD(b.data),_.each(a.feed,function(a){g="",f=a.location,f&&(f.city&&(g+=f.city),f.stateProvinceRegion&&(g&&(g+=", "),g+=f.stateProvinceRegion),f.isoCountryCode&&"US"!==f.isoCountryCode&&(g&&(g+=", "),g+=f.isoCountryCode)),g&&(g="in "+g),h="",a.numEmployees&&a.numEmployees>0&&(h="with "+a.numEmployees+" employees"),a.locationDisplay=g,a.numEmployeesDisplay=h}),a.spinnerGo=!1,d.cancel(e))})};f(),e=d(f,3e4),a.$on("$destroy",function(){d.cancel(e)})}]),angular.module("dorgEuiApp").service("recentlyAddedService",["$rootScope","$http","$embeddedUtils",function(a,b,c){var d=c.$fetchLink(a.Session.dashboard,"newestCompanies");this.$feed=function(){return b.get(d).then(function(a){return a})}}]),angular.module("dorgEuiApp").controller("recentlyLeftCtrl",["$scope","recentlyLeftService",function(a,b){a.title="Recently Left Employees",a.spinnerGo=!0,b.feed().then(function(b){a.feed=b,a.spinnerGo=!1}),a.sortLeftDate=function(a){var b=new Date(a.prevJobLastDay);return b}}]),angular.module("dorgEuiApp").service("recentlyLeftService",["$rootScope","$http","$embeddedUtils",function(a,b,c){var d=c.$fetchLink(a.Session.dashboard,"recentlyLeftEmployees");this.feed=function(){return b.get(d).then(function(a){return c.$getD(a.data)})}}]),angular.module("dorgEuiApp").controller("teamStructureCtrl",["$scope","teamStructureService",function(a,b){a.title="Team Structure",a.spinnerGo=!0,b.feed().then(function(b){a.feed=b,a.spinnerGo=!1})}]),angular.module("dorgEuiApp").service("teamStructureService",["$rootScope","$http","$embeddedUtils",function(a,b,c){var d=c.$fetchLink(a.Session.dashboard,"teamStructure");this.feed=function(){return b.get(d).then(function(a){return c.$getD(a.data)})}}]),angular.module("dorgEuiApp").controller("updatedFollowingListsCtrl",["$scope","updatedFollowingListsService",function(a,b){a.title="Updated Records",a.spinnerGo=!0,b.feedC().then(function(b){a.feedC=b}),b.feedE().then(function(b){a.feedE=b,a.spinnerGo=!1})}]),angular.module("dorgEuiApp").service("updatedFollowingListsService",["$rootScope","$http","$embeddedUtils",function(a,b,c){var d=c.$fetchLink(a.Session.dashboard,"updatedFollowedCompanies"),e=c.$fetchLink(a.Session.dashboard,"updatedFollowedEmployees");this.feedC=function(){return b.get(d).then(function(a){return c.$getD(a.data)})},this.feedE=function(){return b.get(e).then(function(a){return c.$getD(a.data)})}}]),angular.module("dorgEuiApp").controller("usageReportsCtrl",["$scope","usageReportsService",function(a,b){a.title="Usage Reports",a.spinnerGo=!0,b.feed().then(function(b){a.feed=b,a.spinnerGo=!1})}]),angular.module("dorgEuiApp").service("usageReportsService",["$rootScope","$http","$embeddedUtils",function(a,b,c){var d=c.$fetchLink(a.Session.dashboard,"usageReports");this.feed=function(){return b.get(d).then(function(a){return c.$getD(a.data)})}}]),angular.module("dorgEuiApp").controller("alertSubscriptionModalController",["$scope","$uibModal","alertSubscriptionModalService","$q","Flash",function(a,b,c,d,e){this.interact=function(){b.open({controller:["$scope","$uibModalInstance","resolvedView","callback",function(a,b,d,f){a.contentConsumerAlerts=d.entity,a.errorMessage=null,a.confirm=function(){a.errorMessage=null,c.save(a.contentConsumerAlerts).then(function(c){c.duplicateName?(a.errorMessage="Alert subscription must be unique.",$("input#name").focus()):(d.gridRow&&f&&(d.gridRow.entity=c,f(c)),e.create("success","Subscription is successfully created.","flash"),b.close())})},a.close=function(){b.dismiss("cancel")},a.canCreate=d.canCreate}],resolve:{resolvedView:function(){var b=d.defer(),e={gridRow:null,entity:null,canCreate:!0,model:null};if(a.gridRow)e.gridRow=a.gridRow,e.entity=_.clone(a.gridRow.entity),_.isEmpty(a.gridRow.entity)||(e.entity.$get=a.gridRow.entity.$get,e.entity.$put=a.gridRow.entity.$put,e.entity.$href=a.gridRow.entity.$href),b.resolve(e);else{var f=a.searchCriteria();c.createNew().then(function(a){e.entity=_.clone(a),e.entity.catIds=f.catIds,e.entity.catNames=f.catNames,e.entity.indIds=f.indIds,e.entity.indNames=f.indNames,e.entity.topics=f.topics,f.searchCriteria&&(e.entity.searchCriteria=f.searchCriteria),_.isEmpty(a)||(e.entity.$put=a.$put,e.entity.$href=a.$href),c.checkSubscribe(e.entity).then(function(a){e.canCreate=!a.hasSubscribe,b.resolve(e)})})}return b.promise},callback:function(){return a.callback}},size:"lg",templateUrl:"app/directives/alert-subscription-modal-directive/alert.subscription.modal.html"})}}]),angular.module("dorgEuiApp").directive("alertSubscriptionModal",[function(){var a=function(a,b,c,d){b.bind("click",d.interact)},b={request:"=alertSubscriptionModal",gridRow:"=gridRow",searchCriteria:"&",callback:"&"};return{controller:"alertSubscriptionModalController",link:a,restrict:"A",scope:b}}]),angular.module("dorgEuiApp").service("alertSubscriptionModalService",["$http","halClient","$rootScope",function(a,b,c){this.createNew=function(){return c.Session.navigation.$get("create_new_alerts_subscription")},this.save=function(a){return a.$put("self",null,a)},this.getSearchCriteria=function(a){return a.$get("searchsriteria").then(function(a){return a})},this.checkSubscribe=function(a){return a.$put("checksubscribe",null,a)}}]),function(){"use strict";angular.module("dorgEuiApp").directive("checkForMobile",["$window","checkMobile",function(a,b){return{link:function(c,d){var e=b.isMobile();if(e){var f=0,g=0,h=angular.element(document).find("header")[0],i=angular.element(document).find("footer")[0];h&&(f=h.offsetHeight),i&&(f=i.offsetHeight);var j=a.innerHeight-(f+g),k='<div class="check-for-mobile" style="height:'+j+'px"><div class="check-for-mobile-content"><img src="assets/images/do_logo_web_main_2020.svg" width="160" height="35" alt="ZoomInfoDiscover"><p>Due to screen-size and usability constraints, '+c.pageName+" cannot be used on mobile and must be viewed on a traditional Mac, PC, or large tablet.</p></div></div>";d.parent().append(k),d.remove()}},scope:{pageName:"@"}}}])}(),function(){"use strict";function a(a){return{restrict:"A",priority:-1,link:function(b,c,d){function e(b){f?(b.preventDefault(),b.stopImmediatePropagation()):(f=!0,a(function(){f=!1},g,!1))}var f=!1,g=d.clickDelayTime?parseInt(d.clickDelayTime):1500;b.$on("$destroy",function(){c.off("click",e)}),c.on("click",e)}}}a.$inject=["$timeout"],angular.module("dorgEuiApp").directive("clickDelay",a)}(),angular.module("dorgEuiApp").controller("companyNoteDirectiveController",["$scope","companyNoteDirectiveService","$rootScope","$q","singleModalService",function(a,b,c,d,e){var f=a.companyLoc()||"page";this.interact=function(){var g=e.open({controller:["$scope","$uibModalInstance","resourceView","Flash",function(a,d,e,g){a.company=e.company,a.companyName=e.company.name,a.companyNote=e.companyNoteNew,a.companyNotesHistory=e.companyNotesHistory,a.confirm=function(){b.save(a.companyNote).then(function(){a.company.hasNotes=!0,d.close(),c.$broadcast("event:noteSaved",{lType:f,data:[a.company]}),g.create("success","Note successfully saved","flash")})},a.close=function(){a.company.hasNotes=a.companyNotesHistory.length>0,d.close(),c.$broadcast("event:noteSaved",{lType:f,data:[a.company]})},a.getCompanyNote=function(c){b.getCompanyNote(c).then(function(b){a.companyNote=b})},a.deleteNote=function(c){b.deleteNote(c).then(function(){b.getCompanyNotesHistory(e.company).then(function(b){a.companyNotesHistory=b,c.id===a.companyNote.id&&(a.companyNote=e.companyNoteNew)})})},a.newNote=function(){a.companyNote=e.companyNoteNew}}],resolve:{resourceView:function(){var c=d.defer(),e={company:a.company,companyNoteNew:{},companyNotesHistory:[]};return b.getCompanyNotesHistory(a.company).then(function(d){e.companyNotesHistory=d,b.getNewCompanyNote(a.company).then(function(a){e.companyNoteNew=a,c.resolve(e)})}),c.promise}},size:"",templateUrl:"app/directives/company-note-directive/company-note-directive-partials/modal.base.partial.html"});return g}}]),angular.module("dorgEuiApp").directive("companyNote",[function(){var a=function(a,b,c,d){b.bind("click",d.interact)},b={request:"=companyNote",company:"=company",companyLoc:"&companyLoc"};return{controller:"companyNoteDirectiveController",link:a,restrict:"A",scope:b}}]),angular.module("dorgEuiApp").service("companyNoteDirectiveService",["halClient","$rootScope","$q","$http","$embeddedUtils","$ga","$state",function(a,b,c,d,e,f,g){this.getCompanyNote=function(a){return f.track("Directive","Company Note","Retrieved Note, Location Src: "+g.current.name),d.get(e.$self(a)).then(function(a){return a.data})},this.getEntity=function(a){return d.get(e.$self(a)).then(function(a){return e.$getD(a)})},this.save=function(a){return f.track("Directive","Company Note","Saved, Location Src: "+g.current.name),d.put(e.$self(a),a)},this.deleteNote=function(a){return f.track("Directive","Company Note","Deleted, Location Src: "+g.current.name),d.delete(e.$self(a))},this.getCompanyNotesHistory=function(a){var b=e.$fetchLink(a,"companynotes");return d.get(b).then(function(a){return e.$getD(a.data)||[]},function(){return[]})},this.getNewCompanyNote=function(a){var b=e.$fetchLink(a,"newcompanynote");return d.get(b).then(function(a){return a.data})}}]),angular.module("dorgEuiApp").controller("companySummaryReportController",["$scope","$uibModal","companySummaryReportService",function(a,b,c){this.interact=function(){b.open({controller:["$scope","$uibModalInstance","company",function(a,b,d){a.levels=[1,2,3,4,5,6,7,8,9,10],a.level=null,a.close=function(){b.dismiss("cancel")},a.companyDepartments=_.filter(d.companyDepartments,function(a){return a.hasOwnProperty("lockedForUser")&&!a.lockedForUser}),a.gridOptionsCompanySummaryReport={onRegisterApi:function(a){this.api=a},rowHeight:35,enableRowSelection:!0,enableSorting:!0,enableFiltering:!1,enableColumnMenu:!1,selectionRowHeaderWidth:35,columnDefs:[{name:"Department Name",field:"departmentName",enableColumnMenu:!1}],data:a.companyDepartments};var e=[];a.$watch(a.gridOptionsCompanySummaryReport,function(){a.gridOptionsCompanySummaryReport.api.selection.on.rowSelectionChanged(a,function(a){var b=e.indexOf(a.entity.department.id);a.isSelected?b===-1&&e.push(a.entity.department.id):b!==-1&&e.splice(b,1)}),a.gridOptionsCompanySummaryReport.api.selection.on.rowSelectionChangedBatch(a,function(a){e=[],_.each(a,function(a){a.isSelected&&e.push(a.entity.department.id)})})}),a.generateCSR=function(){var f="";null!==e&&_.each(e,function(a,b){f+=a,b<e.length-1&&(f+=",")}),c.generateCSR(d.id,f,null===a.level?-1:a.level),b.close()}}],resolve:{company:function(){return a.company}},size:"",templateUrl:"app/directives/company-summary-report-directive/company-summary-report-partials/modal.html"})}}]),angular.module("dorgEuiApp").directive("companySummaryReportModal",["$rootScope",function(a){var b=function(b,c,d,e){a.Session.$isTrial?c[0].outerHTML="":c.bind("click",e.interact)},c={request:"=companySummaryReportModal",company:"="};return{controller:"companySummaryReportController",link:b,restrict:"A",scope:c}}]),angular.module("dorgEuiApp").service("companySummaryReportService",["$ga",function(a){this.generateCSR=function(b,c,d){var e="api/rest/orgcharts/generateOrgChart",f=document.createElement("form"),g=document.createElement("input"),h=document.createElement("input"),i=document.createElement("input");f.setAttribute("action",e),f.setAttribute("method","GET"),f.setAttribute("target","_blank"),g.setAttribute("type","hidden"),g.setAttribute("name","companyId"),g.setAttribute("value",b),h.setAttribute("type","hidden"),h.setAttribute("name","departmentIds"),h.setAttribute("value",c),i.setAttribute("type","hidden"),i.setAttribute("name","level"),i.setAttribute("value",d),f.appendChild(g),f.appendChild(h),f.appendChild(i),document.body.appendChild(f),f.submit(),a.track("Directive","Summary Report","Download")}}]),angular.module("dorgEuiApp").controller("confirmDeleteEntityDirectiveController",["$scope","$uibModal",function(a,b){this.interact=function(){b.open({animation:!1,controller:["$scope","$uibModalInstance","modalInfo","deleteHandle",function(a,b,c,d){a.title=c.title,a.message=c.message,a.confirm=function(){d(c.entity),b.close()},a.close=function(){b.dismiss("cancel")}}],resolve:{modalInfo:function(){var b={title:a.title,message:a.message,entity:a.entity};return b},deleteHandle:function(){return a.deleteHandle}},size:"sm",templateUrl:"app/directives/confirm-delete-entity-directive/confirm-delete-entity-directive-partials/modal.base.partial.html"})}}]),angular.module("dorgEuiApp").directive("confirmDeleteEntityModal",[function(){var a=function(a,b,c,d){b.bind("click",d.interact)},b={request:"=confirmDeleteEntityModal",title:"=title",message:"=message",entity:"=entity",deleteHandle:"&"};return{controller:"confirmDeleteEntityDirectiveController",link:a,restrict:"A",scope:b}}]),angular.module("dorgEuiApp").directive("getFields",function(){return{link:function(a,b,c){b.bind("click",function(){switch(a.supportedCrmType){case"MARKETO":var b="result.company.id\nresult.company.name\nresult.company.address\nresult.company.city\nresult.company.state\nresult.company.statename\nresult.company.statecode\nresult.company.zip\nresult.company.country\nresult.company.countryname\nresult.company.countrycode\nresult.company.phone\nresult.company.revenue\nresult.company.revenue_mil\nresult.company.employees\nresult.company.itemployees\nresult.company.itbudget_mil\nresult.company.website\nresult.company.industry\nresult.company.companydescription\nresult.company.duns\nresult.company.sic\nresult.company.sic1\nresult.company.sic2\nresult.company.naics\nresult.company.fortuneRank\nresult.company.technologies.Advertising\nresult.company.technologies.AgencyofRecord\nresult.company.technologies.Audit\nresult.company.technologies.ERP\nresult.company.technologies.Finance\nresult.company.technologies.BusinessIntelligence\nresult.company.technologies.CRM-MarketingAutomation\nresult.company.technologies.Collaboration\nresult.company.technologies.DataManagement\nresult.company.technologies.DataStorage\nresult.company.technologies.Databases\nresult.company.technologies.Ecommerce\nresult.company.technologies.HR\nresult.company.technologies.EnterpriseApplications\nresult.company.technologies.Hardware-OS-SystemsEnvironment\nresult.company.technologies.ITSM\nresult.company.technologies.Languages\nresult.company.technologies.Networking\nresult.company.technologies.Medical\nresult.company.technologies.Mobility\nresult.company.technologies.OtherTechnologies-ITOAgreements-ITIntel\nresult.company.technologies.ProgrammingTools\nresult.company.technologies.Security\nresult.company.technologies.Servers\nresult.company.technologies.ServiceProviders\nresult.company.technologies.Telecommunications\nresult.company.technologies.Virtualization\nresult.pers.id\nresult.pers.name\nresult.pers.nametitle\nresult.pers.firstname\nresult.pers.middlename\nresult.pers.lastname\nresult.pers.nickname\nresult.pers.namesuffix\nresult.pers.salutation\nresult.pers.title\nresult.pers.jobfunction\nresult.pers.jobfunction1\nresult.pers.jobfunction2\nresult.pers.jobfunction3\nresult.pers.jobfunction4\nresult.pers.senioritylevel\nresult.pers.phone\nresult.pers.reportsto\nresult.pers.address\nresult.pers.city\nresult.pers.state\nresult.pers.statename\nresult.pers.statecode\nresult.pers.zip\nresult.pers.country\nresult.pers.countryname\nresult.pers.countrycode\nresult.pers.publicNotes\nresult.pers.linkedIn\nresult.pers.twitter\nresult.pers.technologies\nresult.pers.deleted_from_discoverorg\nresult.pers.gdprOptedOut",c=new Blob([b],{type:"text/csv;charset=utf-8"}),d=window.URL||window.webkitURL,e=document.createElementNS("http://www.w3.org/1999/xhtml","a");if(e.href=d.createObjectURL(c),e.download="dorg_marketo_fields.csv",e.dispatchEvent){var f=document.createEvent("MouseEvents");f.initEvent("click",!0,!0),e.dispatchEvent(f)}else e.click()}})},restrict:"A",scope:{supportedCrmType:"@getFields"}}}),angular.module("dorgEuiApp").directive("crmStatus",["$parse",function(a){return{restrict:"A",link:function(b,c,d){var e=function(a){var b=!1;return!a||a.suppressedByUser||a.suppressedByCustomer?b="hidden":a.crmStatus&&"NONE"!==a.crmStatus.crmEntityState||a.matStatus&&"NONE"!==a.matStatus.crmEntityState||a.sdrStatus&&"NONE"!==a.sdrStatus.crmEntityState?a.crmStatus&&"STALE"===a.crmStatus.crmEntityState||a.matStatus&&"STALE"===a.matStatus.crmEntityState||a.sdrStatus&&"STALE"===a.sdrStatus.crmEntityState?b="stale":(a.crmStatus&&"ERROR"===a.crmStatus.crmEntityState||a.matStatus&&"ERROR"===a.matStatus.crmEntityState||a.sdrStatus&&"ERROR"===a.sdrStatus.crmEntityState)&&(b="error"):b="upload",$(c).removeClass("hidden upload stale error"),b&&$(c).addClass(b),b;
},f=function(a){var b="Upload to CRM/MAT/SDR";"stale"===a&&(b="This company's data may have changed since your initial upload."),$(c).attr("title",b)},g=function(){var c=a(d.crmStatus)(b),g=e(c);f(g)};b.$watch(function(){return a(d.crmStatus)(b)},g,!0),g()}}}]),function(){"use strict";function a(a){return{link:function(b,c,d){$(c).on("click",function(c){if(a(d.disableClick)(b))return c.stopPropagation(),c.preventDefault(),!1})},restrict:"A"}}angular.module("dorgEuiApp").directive("disableClick",a),a.$inject=["$parse"]}(),angular.module("dorgEuiApp").controller("downloadExportController",["$rootScope","$scope","singleModalService","downloadExportService","ExportsNotificationService","featureFlagService","Flash","$timeout","$ga",function(a,b,c,d,e,f,g,h,i){function j(a,b,c){g.create(a,b,c),g.pause(),h(g.dismiss,1e4)}function k(){c.open({windowClass:function(){return _.startsWith(b.type,"u")?"usage-report-export-modal":"download-export-modal"}(),controller:["$rootScope","$scope","$uibModalInstance","dataSet","showChTab","exportOptions","type","enhancement","followListId","savedSearchId","searchCriteria","listMethod","alertRequest","dateRange","recentlyLeft","$rootScope","downloadExportService","userSettingsService","featureFlagService","gridFilters","includeGceActivity",function(a,b,c,d,f,i,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z){function A(){var a=x.findFeatureFlag(null,"triggerstoscoops");a?(b.topicsText="Topics",b.triggerText="Scoop"):(b.topicsText="Categories",b.triggerText="Trigger")}function B(){return b.exportEntityRelationships.ultimateParentsOnly?b.exportEntities="ultimateParents":b.exportEntityRelationships.profiledOnly?b.exportEntities="profiledFamily":b.exportEntityRelationships.profiledOnly||(b.exportEntities="allFamily"),b.exportEntities}function C(a,b){v.$post(a,b).then(D).catch(function(a){j("error","There was a problem with your export, please try again later","fail")})}function D(){j("success",'Your export is currently in queue.  <br>We will notify you when your export is ready, <br>or you can monitor its status on the <br><span class="link-text"><a href="#/export-history" close-flash="">export history</a></span> page.',"warning"),e.enableExportsNotifications()}function E(a){g.create("success",a,"flash"),h(g.dismiss,2e3)}function F(a){var b={trigger:a,oppAlert:a,company:a,corporateHierarchy:a,employee:a,location:a,technology:a};return b}function G(a){b.selectedFields[a]=H(angular.copy(J()[a]))}function H(a){var b=a;return _.isEmpty(a)||(b=_.filter(a,function(a){return!a.disabledState})),b}function I(a){b.selectedFields[a]=[],b.exportOptions[a]=angular.copy(J()[a])}function J(){var a=_.startsWith(k,"o")&&!b.oppAlertsExportByBestContacts,c={trigger:angular.copy(i.trigger),oppAlert:b.oppAlertsExportByBestContacts?U:V,employee:a?[]:angular.copy(i.employee),company:angular.copy(i.company),corporateHierarchy:b.corporateHierarchyOptions,employeeLocation:a?[]:angular.copy(i.employeeLocation),companyLocation:angular.copy(i.companyLocation),technology:a?[]:angular.copy(i.technology),technologyCategory:angular.copy(i.technologyCategory)};return c}function K(){var a={trigger:[],oppAlert:[],employee:[],company:[],corporateHierarchy:[],employeeLocation:[],companyLocation:[],technology:[],technologyCategory:[]};return a}function L(){var a=[],c=v.$checkOptions(k);return _.isUndefined(c)||_.each(c,function(c){var d=_.findWhere(b.exportOptions,{displayName:c.displayName});d&&a.push(d)}),a}function M(){var a=K(),c=k;"oppalert"===k&&(c=P()),"company"===k&&(c=R());var d=v.$checkGroupOptions(c);if(_.isUndefined(d)?(a.trigger=_.filter(i.trigger,function(a){return a.preSelected===!0}),a.oppAlert=_.filter(b.exportOptions.oppAlert,function(a){return a.preSelected===!0}),a.employee=_.filter(i.employee,function(a){return a.preSelected===!0}),a.company=_.filter(i.company,function(a){return a.preSelected===!0}),a.corporateHierarchy=_.filter(b.corporateHierarchyOptions,function(a){return a.preSelected===!0}),a.employeeLocation=_.filter(i.employeeLocation,function(a){return a.preSelected===!0}),a.companyLocation=_.filter(i.companyLocation,function(a){return a.preSelected===!0})):(O(a,d,"trigger"),O(a,d,"oppAlert"),O(a,d,"employee"),O(a,d,"company"),O(a,d,"corporateHierarchy"),O(a,d,"employeeLocation"),O(a,d,"companyLocation"),O(a,d,"technology"),O(a,d,"technologyCategory")),p&&_.size(p.technologyProductIds)>0&&"oppalert"!==k){var e=_.filter(i.technology,function(a){return a.preSelected===!0});a.technology=_.uniq(_.union(a.technology,e),!1,_.property("displayName"));var f=_.filter(i.technologyCategory,function(a){return a.preSelected===!0});a.technologyCategory=_.uniq(_.union(a.technologyCategory,f),!1,_.property("displayName"))}return N(a.technology),b.oppAlertExportSelectedCache[P()]=angular.copy(a),a}function N(a){if(!_.isEmpty(a)){var b=_.isUndefined(i.removeDefaultSelectionTechnology)?[]:angular.copy(i.removeDefaultSelectionTechnology);_.isEmpty(b)||_.each(b,function(b){_.remove(a,{displayName:b.displayName})})}}function O(a,c,d){var e=x.findFeatureFlag(null,"triggerstoscoops");_.each(c[d],function(c){var f=c.displayName;if("trigger"===d&&e){var g=v.triggersToScoopsMapFields[c.displayName];f=g?g:f}var h=_.findWhere(b.exportOptions[d],{displayName:f});h&&a[d].push(h)})}function P(){return b.oppAlertsExportByBestContacts?"oppAlertBestContact":"oppAlertSurgingTopic"}function Q(){return b.oppAlertsExportByBestContacts?"oppAlertSurgingTopic":"oppAlertBestContact"}function R(){return b.onCorporateHierarchyTab?"corporateHierarchyExport":"companyExport"}var S=["recommendedContactName","recommendedContactTitle","recommendedContactPhone","recommendedContactEmail"],T=" UTC-8";b.disabledStateMessage=l,b.oppAlertsExportByBestContacts=!1,A();var U=angular.copy(i.oppAlert),V=_.filter(angular.copy(i.oppAlert),function(a){return!_.includes(S,a.fieldIndicator)});if(b.onCorporateHierarchyTab=!1,b.corporateHierarchyExport=!1,b.oppAlertExportSelectedCache={oppAlertSurgingTopic:{},oppAlertBestContact:{}},b.exportEntityRelationships={ultimateParentsOnly:!0,profiledOnly:!0},m?(b.statusOpen=F(!1),"oppalert"===k&&(b.statusOpen.oppAlert=!0),b.exportOptions=J(),b.selectedFields=M()):(b.exportOptions=angular.copy(i.baseFields),b.selectedFields=L()),b.saveSelection=!1,b.getExportBuilderInfo=function(){var c="OppAlert"===b.$exportType||"OppAlerts"===b.$exportType,d=c&&b.oppAlertsExportByBestContacts,e=c&&!b.oppAlertsExportByBestContacts,f="Company"===b.$exportType||"Companies"===b.$exportType;return a.corporateHierarchyExport?void 0:{isOppAlertExportBuilder:c,isOppAlertExportByBestContact:d,isOppAlertExportBySurgingTopic:e,isCompanyExportBuilder:f,technologySectionLabel:e?"Technology Categories":"Technology",technologyCategoryLabel:d?"Technology Categories":"Technology "+b.topicsText,locationSelectedLength:(!e&&b.exportOptions.employeeLocation?b.selectedFields.employeeLocation.length:0)+b.selectedFields.companyLocation.length||0,locationOptionsLength:(!e&&b.exportOptions.employeeLocation?b.exportOptions.employeeLocation.length:0)+b.exportOptions.companyLocation.length||0,technologySelectedLength:(!e&&b.exportOptions.technology?b.selectedFields.technology.length:0)+b.selectedFields.technologyCategory.length||0,technologyOptionsLength:(!e&&b.exportOptions.technology?b.exportOptions.technology.length:0)+b.exportOptions.technologyCategory.length||0}},b.hgDataRemoval=x.findFeatureFlag(null,"hg_data_removal"),v.$formats().then(function(a){b.formats=a,b.formatsDefault=v.$checkFormat(k,a)}),b.getSelectedFieldClass=function(a,b){var c="",d=_.find(b,{id:a.id,displayName:a.displayName,fieldIndicator:a.fieldIndicator});return _.isUndefined(d)||(c="selected"),c},b.toggleAll=function(){b.exportOptions.length!==b.selectedFields.length?b.selectedFields=i.baseFields:(b.selectedFields=[],b.exportOptions=angular.copy(i.baseFields))},b.expandAll=function(){b.statusOpen=F(!0),$(".heading-controls").removeClass("ng-hide"),$('.panel-collapse:not(".in")').collapse("show")},b.collapseAll=function(){b.statusOpen=F(!1),$(".heading-controls").addClass("ng-hide"),$(".panel-collapse.in").collapse("hide")},b.selectAll=function(a,c){if(a.stopImmediatePropagation(),a.preventDefault(),"all"===c){var d=angular.copy(J());_.forEach(d,function(a,b){d[b]=H(a)}),b.selectedFields=d}else"allCompany"===c?(G("company"),G("companyLocation"),G("technology"),G("technologyCategory")):"location"===c?(b.getExportBuilderInfo().isOppAlertExportBySurgingTopic||G("employeeLocation"),G("companyLocation")):"technology"===c?(b.getExportBuilderInfo().isOppAlertExportBySurgingTopic||G("technology"),G("technologyCategory")):G(c)},b.clearAll=function(a,c){a.stopImmediatePropagation(),a.preventDefault(),"all"===c?(b.selectedFields=K(),b.exportOptions=J()):"allCompany"===c?(I("company"),I("companyLocation"),I("technology"),I("technologyCategory")):"location"===c?(I("employeeLocation"),I("companyLocation")):"technology"===c?(I("technology"),I("technologyCategory")):I(c)},b.close=function(){c.dismiss("cancel")},d=_.has(d,"api")?d.api.selection.getSelectedRows():_.isArray(d)?d:new Array(d),d&&d.length>1?b.showChTab=!d.every(function(a){return!a.relationshipTypeName}):"company"===k?b.showChTab=f:b.showChTab=!0,_.isObject(d[0])&&(d=_.pluck(d,"id")),_.startsWith(k,"p"))b.$exportType=1===d.length?"Employee":"Employees";else if(_.startsWith(k,"com"))b.$exportType=1===d.length?"Company":"Companies";else if(_.startsWith(k,"cor"))b.$exportType=1===d.length?"Corporate Hierarchy":"Corporate Hierarchies";else if(_.startsWith(k,"o"))b.$exportType=1===d.length?"OppAlert":"OppAlerts";else if(_.startsWith(k,"u"))b.$exportType="Usage Report";else{var W=x.findFeatureFlag(null,"triggerstoscoops");b.$exportType=1===d.length?W?"Scoop":"Trigger":W?"Scoops":"Triggers"}b.numSelectedFields=function(){var a=0;return a+=b.onCorporateHierarchyTab?_.isUndefined(b.selectedFields.corporateHierarchy)?0:b.selectedFields.corporateHierarchy.length:(_.isUndefined(b.selectedFields.trigger)?0:b.selectedFields.trigger.length)+(_.isUndefined(b.selectedFields.oppAlert)?0:b.selectedFields.oppAlert.length)+(_.isUndefined(b.selectedFields.employee)?0:b.selectedFields.employee.length)+(_.isUndefined(b.selectedFields.company)?0:b.selectedFields.company.length)+(_.isUndefined(b.selectedFields.employeeLocation)?0:b.selectedFields.employeeLocation.length)+(_.isUndefined(b.selectedFields.companyLocation)?0:b.selectedFields.companyLocation.length)+(_.isUndefined(b.selectedFields.technology)?0:b.selectedFields.technology.length)+(_.isUndefined(b.selectedFields.technologyCategory)?0:b.selectedFields.technologyCategory.length)},b.saveSelectedFields=function(){var a=u.Session.account.preferences;if(a.exports||(a.exports={}),m){var c=k;"oppalert"===k&&(c=P()),a.exports[c]={format:b.formatsDefault,groupOptions:b.selectedFields}}else a.exports[k]={format:b.formatsDefault,options:b.selectedFields};w.$setPrefs(a).then(function(){h(w.updateAccount,1e3),E("Export Selections Saved")})},b.restoreDefaultFields=function(){var a=u.Session.account.preferences,c=k;"oppalert"===k&&(c=P()),a.exports&&a.exports[c]&&(a.exports[c]={},w.$setPrefs(a).then(function(){h(w.updateAccount,1e3)})),E("Default Export Fields Restored"),b.formatsDefault=v.$checkFormat(k,b.formats),b.selectedFields=M()},b.exportDownload=function(){var a={};if(a.exportFormatType=b.formatsDefault,a.oppAlertExportByBestContact=b.oppAlertsExportByBestContacts,m?(a.exportFields=[],a.exportFieldsGroup=b.selectedFields,a.searchedTechnologyIds=p&&p.technologyProductIds?p.technologyProductIds:[],a.technologiesApplication=p?p.technologiesApplication:null,b.onCorporateHierarchyTab?(k="corporateHierarchy",a.exportFieldsGroup.company=[],a.exportFieldsGroup.companyLocation=[],a.exportEntities=B()):a.exportFieldsGroup.corporateHierarchy=[]):(a.exportFields=b.selectedFields,a.exportFieldsGroup={}),a.entityIds=d,0===d.length&&(!_.isUndefined(n)&&n>0&&(a.followListId=n),_.isUndefined(o)||(a.savedSearchId=o),_.isUndefined(p)||(a.searchCriteria=p),_.isUndefined(q)||_.isEmpty(q)||_.isObject(q)||(a.listMethod=q.replace(/\$/,"")),_.isUndefined(r)||(a.alertRequest=r),_.isUndefined(y)||_.isNull(y)||(a.gridFilters=JSON.stringify(y))),_.isUndefined(t)||(a.recentlyLeft=t),s){var e=_.cloneDeep(s),f=e.minValue;f&&!_.isDate(f)&&(_.isString(f)&&("usage"===k?f=new Date(f+T):(f=f.split("/"),f=new Date(f[2],f[0]-1,f[1]))),e.minValue=f);var g=e.maxValue;g&&!_.isDate(g)&&(_.isString(g)&&("usage"===k?g=new Date(g+T):(g=g.split("/"),g=new Date(g[2],g[0]-1,g[1]))),e.maxValue=g),a.dateRange=e}if("usage"===k&&z&&(a.includeGCEActivity=z),b.saveSelection){var i=u.Session.account.preferences;i.exports||(i.exports={}),i.exports[k]={format:b.formatsDefault,options:b.selectedFields},w.$setPrefs(i).then(function(){h(w.updateAccount,1e3)})}a.clientTimeZone=Intl.DateTimeFormat().resolvedOptions().timeZone,C(k,a),c.close()},b.companyModalChangeTab=function(a){b.onCorporateHierarchyTab=a},b.oppAlertsExportByChange=function(a){if(b.oppAlertsExportByBestContacts!==a){var c=P(),d=Q();b.oppAlertExportSelectedCache[c]=angular.copy(b.selectedFields),b.oppAlertExportStatusOpenCache||(b.oppAlertExportStatusOpenCache={oppAlertBestContact:{oppAlert:!0},oppAlertSurgingTopic:{oppAlert:!0}}),b.oppAlertExportStatusOpenCache[c]=angular.copy(b.statusOpen),b.oppAlertsExportByBestContacts=a,b.statusOpen=b.oppAlertExportStatusOpenCache[d],b.oppAlertsExportByBestContacts||(S.forEach(function(a){_.remove(b.selectedFields.oppAlert,{fieldIndicator:a})}),b.selectedFields.technology=[],b.selectedFields.employeeLocation=[]),b.exportOptions=J(),b.oppAlertExportSelectedCache[d]&&Object.keys(b.oppAlertExportSelectedCache[d]).length?b.selectedFields=b.oppAlertExportSelectedCache[d]:b.selectedFields=M()}}}],resolve:{exportOptions:function(){return d.$get(b.type,b.includeExportSearchCriteria&&b.searchCriteria?b.searchCriteria.technologyProductIds:[],b.includeExportSearchCriteria).then(function(a){return _.cloneDeep(a)})},dataSet:function(){var a=b.dataSet;return _.has(a,"callback")?a=a.callback():_.has(a,"totalitems")&&(a=[]),a},showChTab:function(){return b.showChTab},type:function(){return b.type},enhancement:function(){return!_.startsWith(b.type,"u")},followListId:function(){return b.followListId},listMethod:function(){return b.listMethod},savedSearchId:function(){return b.savedSearchId},searchCriteria:function(){if(b.includeExportSearchCriteria||_.startsWith(b.type,"o")){var a=b.searchCriteria;return _.has(a,"callback")&&(a=_.isUndefined(a.callback.searchCriteria)?a.callback():a.callback.searchCriteria),a}return null},alertRequest:function(){return b.alertRequest},dateRange:function(){return b.dateRange},recentlyLeft:function(){return b.recentlyLeft},gridFilters:function(){return b.gridFilters},includeGceActivity:function(){return b.includeGceActivity}},size:"lg",templateUrl:function(){return _.startsWith(b.type,"u")?"app/directives/download-export-directive/download-export-partials/modal.html":"app/directives/download-export-directive/download-export-partials/enhancement.modal.html"}()})}var l="Your account is currently not enabled to export this field. Please contact your CSM to inquire about making this field exportable";this.openModal=function(){if(b.downloadExportIgnore)return!1;var a=f.findFeatureFlag(null,"export_limits");_.startsWith(b.type,"p")&&a?d.getNumRecordsExport(b.dataSet).then(function(a){a>0?d.validateLimitingExports(a).then(function(a){var b=a.data;return b&&b.toastMessage?b.exceed?(j("warning",b.toastMessage,"alert-export-limits-exceeded"),!1):(j("danger",b.toastMessage,"alert-export-limits-reached"),!1):void k()}):k()}):k()}}]),angular.module("dorgEuiApp").directive("downloadExport",["$rootScope","downloadExportService",function(a,b){return{controller:"downloadExportController",link:function(c,d,e,f){b.$formats().then(function(a){a&&a.length||(d[0].outerHTML="")}),a.Session.$isTrial&&(d[0].outerHTML=""),"disabled"!==$(this).attr("disabled")&&d.bind("click",f.openModal)},restrict:"AE",scope:{single:"@downloadExportSingle",type:"=downloadExportType",dataSet:"=downloadExport",downloadExportIgnore:"=downloadExportIgnore",followListId:"=downloadExportFollowListId",listMethod:"=downloadExportListMethod",savedSearchId:"=downloadExportSavedId",searchCriteria:"=downloadExportCriteria",alertRequest:"=downloadExportAlertRequest",dateRange:"=downloadExportDateRange",recentlyLeft:"=downloadExportRecentlyLeft",includeExportSearchCriteria:"=downloadExportIncludeSearchCriteria",showChTab:"=downloadExportShowChTab",gridFilters:"=downloadExportGridFilters",includeGceActivity:"=includeGceActivity"}}}]).directive("downloadExportStatus",function(){return{controller:["$scope","$timeout","$sce",function(a,b,c){a.container={},a.total=0,a.$on("event:downloadProgress",function(d,e){a.container[e.id]=e.data,a.total=Object.keys(a.container).length;var f="SUCCESS"==a.container[e.id].exportState,g="FAILED"==a.container[e.id].exportState;if(f||g){var h=1e3;f?a.container[e.id].filePath=c.trustAsResourceUrl(a.container[e.id].filePath):h=1e4,b(function(){delete a.container[e.id],a.total=Object.keys(a.container).length},h)}}),a.$watch("container",function(b){a.hide=Object.keys(b).length<1},!0)}],scope:!0,restrict:"E",replace:!0,templateUrl:"app/directives/download-export-directive/download-export-partials/export.status.html"}}),angular.module("dorgEuiApp").service("downloadExportService",["$rootScope","halClient","$http","$embeddedUtils","$timeout","$ga","$state","$q","navigationService",function(a,b,c,d,e,f,g,h,i){var j=a.Session.navigation,k=j.$href("exportPersonFields"),l=j.$href("exportPersons"),m=j.$href("exportCompanyFields"),n=j.$href("exportCompanies"),o=j.$href("exportCorporateHierarchyFields"),p=j.$href("exportCorporateHierarchy"),q=j.$href("exportIntelFields"),r=j.$href("exportIntel"),s=j.$href("exportOppAlertFields"),t=j.$href("exportOppAlert"),u=j.$href("exportUsageFields"),v=j.$href("exportUsage"),w=function(a){return console.warn("There was an error:",a),{data:{status:{id:0}}}},x="exportFormats";this.triggersToScoopsMapFields={"Trigger Description":"Scoop Description","Trigger Type":"Scoop Types","Trigger Date Published":"Scoop Date Published","Trigger URL":"Scoop URL","Trigger Categories":"Scoop Topics"},this.$get=function(c,d,e){var f;switch(c){case"companies":case"company":f=m;break;case"corporateHierarchy":f=o;break;case"person":case"persons":f=k;break;case"intel":f=q;break;case"usage":f=u;break;case"oppalert":f=s}return d||(d=[]),f===m&&this.getCorpHierarchyFields(d,e).then(a.corporateHierarchyExport=!1),e&&f&&(f=f.replace("includeSearchCriteria=false","includeSearchCriteria=true")),b.$post(f,{},d).then(function(a){return a},w)},this.getCorpHierarchyFields=function(c){return a.corporateHierarchyExport=!0,c||(c=[]),b.$post(o,{},c).then(function(b){return a.corporateHierarchyOptions=b.data.corporateHierarchyFields,a.corporateHierarchyOptions},w)},this.$formats=function(){var a,b=i.getNavigationUrlByHref(x);return b?c.get(b,{cache:!0}).then(function(a){return a.data},function(){return[]}):(a=h.defer(),a.resolve([]),a.promise)},this.maxPersonExportRowCount=function(){return c.get("api/rest/export/personExportRowLimit").then(function(a){return a})},this.maxCompanyExportRowCount=function(){return c.get("api/rest/export/companyExportRowLimit").then(function(a){return a})},this.maxScoopExportRowCount=function(){return c.get("api/rest/export/scoopExportRowLimit").then(function(a){return a})},this.maxOppAlertsRowCount=function(){return c.get("api/rest/export/oppAlertRowlimit").then(function(a){return a})},this.$checkOptions=function(b){var c=a.Session.account.preferences;return _.has(c.exports,[b,"options"])&&""!==c.exports[b].options?c.exports[b].options:void 0},this.$checkGroupOptions=function(b){var c=a.Session.account.preferences;return _.has(c.exports,[b,"groupOptions"])&&""!==c.exports[b].groupOptions&&!_.isEqual(c.exports[b].groupOptions,{})?c.exports[b].groupOptions:void 0},this.$checkFormat=function(b,c){var d=a.Session.account.preferences;return c[0]?_.has(d.exports,[b,"format"])&&""!==d.exports[b].format&&_.findIndex(c,function(a){return!!a&&a.exportFormatType===d.exports[b].format})>-1?d.exports[b].format:c[0].exportFormatType:"CSV_COMMA"},this.$post=function(a,b){var d,e={headers:{Accecpt:"application/text"}};switch(a){case"companies":case"company":d=n;break;case"corporateHierarchy":d=p;break;case"persons":case"person":d=l;break;case"intel":d=r;break;case"usage":d=v;break;case"oppalert":d=t}return c.post(d,b,e).then(function(a){f.track("Directive","Export","Download Started, Location Src: "+g.current.name)})},this.validateLimitingExports=function(a){return c.get("api/rest/export/validatelimitingexports",{params:{numRecords:a}})},this.getNumRecordsExport=function(a){var b=0;return a.length?b=a.length:a.id?b=1:_.has(a,"callback")?(a=a.callback(),b=a.length):_.has(a,"totalitems")?b=a.totalitems():a.api&&(b=a.api.selection?a.api.selection.getSelectedRows().length:0),h.resolve(b)},this.checkCanExport=function(){return c.get("api/rest/export/checkcanexport").then(function(a){return a.data})}}]),angular.module("dorgEuiApp").controller("downloadExportTier2Controller",["$rootScope","$scope","$uibModal","downloadExportTier2Service","ExportsNotificationService","featureFlagService","Flash","$timeout","$ga","SearchService",function(a,b,c,d,e,f,g,h,i,j){function k(a,b,c){g.create(a,b,c),g.pause(),h(g.dismiss,1e4)}function l(){c.open({windowClass:"download-export-modal-tier2",controller:["$rootScope","$scope","$uibModalInstance","dataSet","exportOptions","type","savedSearchId","searchCriteria","listMethod","dateRange","$rootScope","downloadExportTier2Service","userSettingsService","featureFlagService","companyId","personId","selectedRows","filterPersonTierTwo",function(a,b,c,d,f,i,j,l,n,o,p,q,r,s,t,u,v,w){function x(a,b){q.$post(a,b).then(y).catch(function(a){console.error(a),k("error","There was a problem with your export, please try again later","fail")})}function y(){k("success",'Your export is currently in queue.  <br>We will notify you when your export is ready, <br>or you can monitor its status on the <br><span class="link-text"><a href="#/export-history" close-flash="">export history</a></span> page.',"warning"),e.enableExportsNotifications()}function z(a){g.create("success",a,"flash"),h(g.dismiss,2e3)}function A(a){var b={company:a,employee:a,location:a};return b}function B(a){b.selectedFields[a]=C(angular.copy(E()[a]))}function C(a){var b=a;return _.isEmpty(a)||(b=_.filter(a,function(a){return!a.disabledState})),b}function D(a){b.selectedFields[a]=[],b.exportOptions[a]=angular.copy(E()[a])}function E(){var a={employee:_.isUndefined(f.employee)?[]:angular.copy(f.employee),company:angular.copy(f.company),companyLocation:angular.copy(f.companyLocation)};return a}function F(){var a={employee:[],company:[],companyLocation:[]};return a}function G(){var a=F(),b=i;"company"===i&&(b="companyExport");var c=q.$checkGroupOptions(q.getSavedExportTypeName(b));return _.isUndefined(c)?(a.employee=_.filter(f.employee,function(a){return a.preSelected===!0}),a.company=_.filter(f.company,function(a){return a.preSelected===!0}),a.companyLocation=_.filter(f.companyLocation,function(a){return a.preSelected===!0})):(H(a,c,"employee"),H(a,c,"company"),H(a,c,"companyLocation")),a}function H(a,c,d){_.each(c[d],function(c){var e=c.displayName,f=_.findWhere(b.exportOptions[d],{displayName:e});f&&a[d].push(f)})}b.disabledStateMessage=m,b.statusOpen=A(!1),b.exportOptions=E(),b.selectedFields=G(),b.saveSelection=!1,b.getExportBuilderInfo=function(){var a="Company"===b.$exportType||"Companies"===b.$exportType;return{isCompanyExportBuilder:a,locationSelectedLength:b.selectedFields.companyLocation.length||0,locationOptionsLength:b.exportOptions.companyLocation.length||0}},q.$formats().then(function(a){b.formats=a;var c=q.getSavedExportTypeName(i);b.formatsDefault=q.$checkFormat(c,a)}),q.userHasAccessToPreciousData().then(function(a){b.userHasAccessToPreciousData=a}),b.getSelectedFieldClass=function(a,b){var c="",d=_.find(b,{id:a.id,displayName:a.displayName,fieldIndicator:a.fieldIndicator});return _.isUndefined(d)||(c="selected"),c},b.toggleAll=function(){b.exportOptions.length!==b.selectedFields.length?b.selectedFields=f.baseFields:(b.selectedFields=[],b.exportOptions=angular.copy(f.baseFields))},b.expandAll=function(){b.statusOpen=A(!0),$(".heading-controls").removeClass("ng-hide"),$('.panel-collapse:not(".in")').collapse("show")},b.collapseAll=function(){b.statusOpen=A(!1),$(".heading-controls").addClass("ng-hide"),$(".panel-collapse.in").collapse("hide")},b.selectAll=function(a,c){if(a.stopImmediatePropagation(),a.preventDefault(),"all"===c){var d=angular.copy(E());_.forEach(d,function(a,b){d[b]=C(a)}),b.selectedFields=d}else"allCompany"===c?(B("company"),B("companyLocation")):B("location"===c?"companyLocation":c)},b.clearAll=function(a,c){a.stopImmediatePropagation(),a.preventDefault(),"all"===c?(b.selectedFields=F(),b.exportOptions=E()):"allCompany"===c?(D("company"),D("companyLocation")):D("location"===c?"companyLocation":c)},b.close=function(){c.dismiss("cancel")},d=_.has(d,"api")?d.api.selection.getSelectedRows():_.isArray(d)?d:new Array(d),_.isObject(d[0])&&(d=_.pluck(d,"id")),_.includes(i,"Person")||_.includes(i,"person")?b.$exportType=1===d.length?"Employee":"Employees":b.$exportType=1===d.length?"Company":"Companies",b.numSelectedFields=function(){var a=0;return a+=(_.isUndefined(b.selectedFields.trigger)?0:b.selectedFields.trigger.length)+(_.isUndefined(b.selectedFields.employee)?0:b.selectedFields.employee.length)+(_.isUndefined(b.selectedFields.company)?0:b.selectedFields.company.length)+(_.isUndefined(b.selectedFields.companyLocation)?0:b.selectedFields.companyLocation.length)},b.saveSelectedFields=function(){var a=p.Session.account.preferences;a.exports||(a.exports={});var c=q.getSavedExportTypeName(i);a.exports[c]={format:b.formatsDefault,groupOptions:b.selectedFields},r.$setPrefs(a).then(function(){h(r.updateAccount,1e3),z("Export Selections Saved")})},b.restoreDefaultFields=function(){var a=p.Session.account.preferences,c=q.getSavedExportTypeName(i);a.exports&&a.exports[c]&&(a.exports[c]={},r.$setPrefs(a).then(function(){h(r.updateAccount,1e3)})),z("Default Export Fields Restored"),b.formatsDefault=q.$checkFormat(c,b.formats),b.selectedFields=G()},b.exportDownload=function(){var a={};if(a.exportFormatType=b.formatsDefault,a.exportFields=[],a.exportFieldsGroup=b.selectedFields,a.entityIds=d,"tier2Person"===i||"tierTwoPersons"===i?u?a.tier2EntityIds=[u]:t?(a.tier2CompanyIdForEmployees=t,a.personTierTwoDbFilterResource=w?w:{}):v&&v.length&&(a.tier2EntityIds=_.map(v,function(a){return"tierTwoPersons"===i?a.uuid:a.entity.uuid})):t?a.tier2EntityIds=[t]:v&&v.length&&(a.tier2EntityIds=_.map(v,function(a){return"tierTwoCompanies"===i?a.uuid:a.entity.uuid})),null!=a.tier2EntityIds||_.isUndefined(l)||(a.searchCriteria=l),0===d.length&&(_.isUndefined(j)||(a.savedSearchId=j),_.isUndefined(n)||_.isEmpty(n)||_.isObject(n)||(a.listMethod=n.replace(/\$/,""))),o){var e=_.cloneDeep(o),f=e.minValue;f&&!_.isDate(f)&&(_.isString(f)&&(f=f.split("/"),f=new Date(f[2],f[0]-1,f[1])),e.minValue=f);var g=e.maxValue;g&&!_.isDate(g)&&(_.isString(g)&&(g=g.split("/"),g=new Date(g[2],g[0]-1,g[1])),e.maxValue=g),a.dateRange=e}if(b.saveSelection){var k=p.Session.account.preferences;k.exports||(k.exports={});var m=q.getSavedExportTypeName(i);k.exports[m]={format:b.formatsDefault,options:b.selectedFields},r.$setPrefs(k).then(function(){h(r.updateAccount,1e3)})}x(i,a),c.close()}}],resolve:{exportOptions:function(){return d.$get(b.type,[],b.includeExportSearchCriteria).then(function(a){return _.cloneDeep(a)})},dataSet:function(){var a=b.dataSet;return _.has(a,"callback")?a=a.callback():_.has(a,"totalitems")&&(a=[]),a},type:function(){return b.type},listMethod:function(){return b.listMethod},savedSearchId:function(){return b.savedSearchId},searchCriteria:function(){if(b.includeExportSearchCriteria||_.startsWith(b.type,"o")){var a=b.searchCriteria;return _.has(a,"callback")&&(a=_.isUndefined(a.callback.searchCriteria)?a.callback():a.callback.searchCriteria),a}return null},dateRange:function(){return b.dateRange},companyId:function(){return b.companyId},personId:function(){return b.personId},selectedRows:function(){return b.selectedRows},filterPersonTierTwo:function(){return b.filterPersonTierTwo}},size:"lg",templateUrl:function(){return"app/directives/download-export-tier2-directive/download-export-tier2-partials/enhancement.modal.tier2.html"}()})}var m="Your account is currently not enabled to export this field. Please contact your CSM to inquire about making this field exportable";this.openModal=function(){if(b.downloadExportIgnore)return!1;var a=f.findFeatureFlag(null,"export_limits");if("tier2Person"!==b.type&&"tierTwoPersons"!==b.type||!a)try{l()}catch(a){console.error(a)}else{var c=b.dataSet;b.personId?c=1:b.selectedRows&&(c=b.selectedRows.length),d.getNumRecordsExport(c).then(function(a){a>0&&d.validateLimitingExports(a).then(function(a){var b=a.data;if(b&&b.toastMessage)return b.exceed?(k("warning",b.toastMessage,"alert-export-limits-exceeded"),!1):(k("danger",b.toastMessage,"alert-export-limits-reached"),!1);try{l()}catch(a){console.error(a)}})})}}}]),angular.module("dorgEuiApp").directive("downloadExportTier2",["$rootScope","downloadExportTier2Service",function(a,b){return{controller:"downloadExportTier2Controller",link:function(c,d,e,f){b.$formats().then(function(a){a&&a.length||(d[0].outerHTML="")}),a.Session.$isTrial&&(d[0].outerHTML=""),"disabled"!==$(this).attr("disabled")&&d.bind("click",f.openModal)},restrict:"AE",scope:{single:"@downloadExportSingle",type:"=downloadExportType",dataSet:"=downloadExportTier2",downloadExportIgnore:"=downloadExportIgnore",followListId:"=downloadExportFollowListId",listMethod:"=downloadExportListMethod",savedSearchId:"=downloadExportSavedId",searchCriteria:"=downloadExportCriteria",alertRequest:"=downloadExportAlertRequest",dateRange:"=downloadExportDateRange",recentlyLeft:"=downloadExportRecentlyLeft",includeExportSearchCriteria:"=downloadExportIncludeSearchCriteria",showChTab:"=downloadExportShowChTab",companyId:"=downloadExportCompanyId",personId:"=downloadExportPersonId",selectedRows:"=downloadExportSelectedRows",filterPersonTierTwo:"=downloadExportFilterPersonTierTwo"}}}]),angular.module("dorgEuiApp").service("downloadExportTier2Service",["$rootScope","halClient","$http","$embeddedUtils","$timeout","$ga","$state","$q","navigationService",function(a,b,c,d,e,f,g,h,i){var j=a.Session.navigation,k=j.$href("exportPersonTier2Fields"),l=j.$href("exportPersonsTier2"),m=j.$href("exportCompanyTier2Fields"),n=j.$href("exportCompaniesTier2"),o=function(a){return console.warn("There was an error:",a),{data:{status:{id:0}}}},p="exportFormats";this.triggersToScoopsMapFields={"Trigger Description":"Scoop Description","Trigger Type":"Scoop Types","Trigger Date Published":"Scoop Date Published","Trigger URL":"Scoop URL","Trigger Categories":"Scoop Topics"},this.$get=function(a,c,d){var e;switch(a){case"company":case"companies":case"tier2Company":case"tier2Companies":case"tierTwoCompanies":e=m;break;case"employee":case"employees":case"tier2Person":case"tier2Persons":case"tierTwoPersons":e=k}return c||(c=[]),d&&e&&(e=e.replace("includeSearchCriteria=false","includeSearchCriteria=true")),b.$post(e,{},c).then(function(a){return a},o)},this.$formats=function(){var a,b=i.getNavigationUrlByHref(p);return b?c.get(b,{cache:!0}).then(function(a){return a.data},function(){return[]}):(a=h.defer(),a.resolve([]),a.promise)},this.maxPersonExportRowCount=function(){return c.get("api/rest/export/personExportRowLimit").then(function(a){return a})},this.maxCompanyExportRowCount=function(){return c.get("api/rest/export/companyExportRowLimit").then(function(a){return a})},this.userHasAccessToPreciousData=function(){return c.get("api/rest/export/userHasAccessToPreciousData").then(function(a){return a.data})},this.$checkOptions=function(b){var c=a.Session.account.preferences;return _.has(c.exports,[b,"options"])&&""!==c.exports[b].options?c.exports[b].options:void 0;
},this.$checkGroupOptions=function(b){var c=a.Session.account.preferences;return _.has(c.exports,[b,"groupOptions"])&&""!==c.exports[b].groupOptions&&!_.isEqual(c.exports[b].groupOptions,{})?c.exports[b].groupOptions:void 0},this.$checkFormat=function(b,c){var d=a.Session.account.preferences;return c[0]?_.has(d.exports,[b,"format"])&&""!==d.exports[b].format&&_.findIndex(c,function(a){return!!a&&a.exportFormatType===d.exports[b].format})>-1?d.exports[b].format:c[0].exportFormatType:"CSV_COMMA"},this.$post=function(a,b){var d,e={headers:{Accecpt:"application/text"}};switch(a){case"company":case"companies":case"tier2Company":case"tier2Companies":case"tierTwoCompanies":d=n;break;case"person":case"persons":case"employee":case"employees":case"tier2Person":case"tier2Persons":case"tierTwoPersons":d=l}return c.post(d,b,e).then(function(a){f.track("Directive","Export","Download Started, Location Src: "+g.current.name)})},this.validateLimitingExports=function(a){return c.get("api/rest/export/validatelimitingexports",{params:{numRecords:a}})},this.getSavedExportTypeName=function(a){var b=a;switch(a){case"company":case"companies":case"tier2Company":case"tier2Companies":case"tierTwoCompanies":b="tier2Company";break;case"person":case"persons":case"employee":case"employees":case"tier2Person":case"tier2Persons":case"tierTwoPersons":b="tier2Person"}return b},this.getNumRecordsExport=function(a){var b=a;return _.has(a,"totalitems")&&(b=a.totalitems()),h.resolve(b)}}]),angular.module("dorgEuiApp").directive("favicon",["favicon",function(a){return{link:function(b,c){c.attr("src",a.$build(b.websiteUrl,b.size)),c.removeAttr("favicon"),c.removeAttr("favicon-size")},priority:1001,scope:{websiteUrl:"=favicon",size:"@faviconSize"},restrict:"AE"}}]),function(){"use strict";angular.module("dorgEuiApp").directive("fileDrop",function(){return function(a,b,c){b.bind("dragover",function(a){a.stopPropagation(),a.preventDefault(),a.dropEffect="copy"}),b.bind("drop",function(b){b.stopPropagation(),b.preventDefault(),a.$apply(function(){a.$eval(c.fileDrop,{event:b})})})}})}(),function(){"use strict";angular.module("dorgEuiApp").directive("fileReader",function(){return{link:function(a,b,c){b.bind("change",function(b){a.$apply(function(){a.$eval(c.fileReader,{event:b})})}),b.bind("click",function(b){a.$apply(function(){null!=c.$$element[0].value&&(c.$$element[0].value="")})})}}})}(),function(){"use strict";function a(a,b,c,d,e){function f(){var f,g,h;if(!a.openOnce)return a.openOnce=!0,c(function(){a.openOnce=!1},500),d.getFeatureFlags().then(function(c){var d=_.findWhere(c.data,{name:"FIXIT"});if(d&&d.active){if(f=!0,"person"===a.request)a.availableOptions=angular.copy(b.Session.fixitemployee);else{if("company"!==a.request)return;a.availableOptions=angular.copy(b.Session.fixitcompany)}for(var i in a.availableOptions.fixItCategories)if("Unknown"===a.availableOptions.fixItCategories[i].displayName){a.availableOptions.fixItCategories.splice(i,1);break}g="app/directives/fixit-directive/fixit-directive-partials/modal.base.partial.html"}else f=!1,a.availableOptions=b.Session.fixit,g="app/directives/fixit-directive/fixit-directive-partials/modal.diminished.partial.html";h=e.open({controller:"fixitModalController",resolve:{catList:function(){return a.availableOptions.fixItCategories},requestId:function(){return a.id},requestType:function(){return a.request},entityTypes:function(){return a.availableOptions.entityTypes},fullInfo:function(){return a.fullInfo},technologies:function(){if("company"===a.request)return a.technologies||void 0},revenue:function(){if("company"===a.request)return a.revenue||void 0},featureFlag:function(){return f},isPartOfCorporateHierarchy:function(){return a.isPartOfCorporateHierarchy}},templateUrl:g})}),h}var g=this;g.interact=f}a.$inject=["$scope","$rootScope","$timeout","featureFlagService","singleModalService"],angular.module("dorgEuiApp").controller("fixitDirectiveController",a)}(),angular.module("dorgEuiApp").directive("fixit",[function(){var a=function(a,b,c,d){b.bind("click",d.interact)},b={request:"=fixit",id:"=fixitId",fullInfo:"=fixitFullInfo",technologies:"=fixitTech",revenue:"=fixitRevenue",isPartOfCorporateHierarchy:"=fixitIsPartOfCorporateHierarchy"};return{controller:"fixitDirectiveController",link:a,restrict:"A",scope:b}}]),angular.module("dorgEuiApp").service("fixitDirectiveService",["halClient","$ga","$state",function(a,b,c){var d="api/rest/fixit",e="api/rest/fixit/request/v2/";this.$post=function(f,g,h,i){var j=g?e+h+"/"+i:d;return b.track("Directive","FixIt Request","Sent, Location Src: "+c.current.name),a.$post(j,null,f)}}]),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){for(var b=a.catList.length-1;b>=0;b--){var c;"employee"===a.entityType&&(c=a.amendCatList(a.catList[b])),"company"===a.entityType&&(c=a.companyCatList(a.catList[b])),c||a.catList.splice(b,1)}a.maxLength=a.catList.length}function p(b){return!(!b||!b.hasOwnProperty("id"))&&(r(b.id,1)?a.fullInfo.mainPhoneNumber&&a.fullInfo.mainPhoneNumber.length>0:r(b.id,2)?j&&j.toString().length>0:r(b.id,3)?a.fullInfo.numEmployees&&a.fullInfo.numEmployees.toString().length>0:r(b.id,4)?a.fullInfo.industry&&a.fullInfo.industry.name&&a.fullInfo.industry.name.length>0:r(b.id,5)?a.fullInfo.logoFilename&&a.fullInfo.logoFilename.length>0:r(b.id,6)?i&&i.length>0:r(b.id,7)?a.fullInfo.location&&a.fullInfo.location.streetAddress&&a.fullInfo.location.streetAddress.length>0:!r(b.id,t)||a.isPartOfCorporateHierarchy)}function q(b){return!(!b||!b.hasOwnProperty("id"))&&(r(b.id,2)?a.fullInfo.email&&a.fullInfo.email.length>0:r(b.id,3)?s():r(b.id,4)?a.fullInfo.title&&a.fullInfo.title.length>0:r(b.id,5)?a.fullInfo.portraitFilename&&a.fullInfo.portraitFilename.length>0:r(b.id,6)?a.fullInfo.linkedInUrl&&a.fullInfo.linkedInUrl.length>0:r(b.id,8)?!a.fullInfo.email&&(b.displayName=b.displayName+" *",!0):!r(b.id,9)||!s()&&(b.displayName=b.displayName+" *",!0))}function r(a,b){return parseInt(a)===parseInt(b)}function s(){return a.fullInfo.officeTelNumber&&a.fullInfo.officeTelNumber.length>0||a.fullInfo.mobileTelNumber&&a.fullInfo.mobileTelNumber.length>0}a.entityType="person"===f?"employee":"company";var t=8,u=m.getOS();"Windows"===u?a.checkForWindows=!0:a.checkForWindows=!1,k?(a.array={0:{}},a.amendCatList=q,a.catList=e,a.checkers=!1,a.companyCatList=p,a.enabledSubmit=!1,a.fullInfo=h,a.isPartOfCorporateHierarchy=n,a.init=o,o()):(a.requestData="",a.catList=e,a.catListSelections=e[0],a.enabledSubmit=!0),a.confirm=function(){if(a.enabledSubmit){var e;if(k){var h={};if(_.each(a.array,function(a){h[a.id]=a.description}),"employee"===a.entityType){var i;i=a.fullInfo.company.fullName?a.fullInfo.company.fullName:a.fullInfo.company.name,e={emailOptIn:a.checkers.toString(),categories:h,entityContactCompany:i,entityContactPerson:a.fullInfo.fullName}}else{var i;i=a.fullInfo.fullName?a.fullInfo.fullName:a.fullInfo.name,e={emailOptIn:a.checkers.toString(),categories:h,entityContactCompany:i}}}else{var j=0;_.each(g,function(a){a.displayName.toLowerCase()===f&&(j=a.id)}),e={comment:a.requestData,fixitCategory:a.catListSelections.id,entityType:j,entityId:d}}a.enabledSubmit=!1,l.$post(e,k,a.entityType,d).then(function(){c.create("success","FixIt Request Successfully Submitted","flash")},function(){c.create("error","Fixit Request Failed to Submit! Please Try Again.","fail")}).finally(function(){b.close()})}},a.close=function(){b.dismiss("cancel")}}a.$inject=["$scope","$uibModalInstance","Flash","requestId","catList","requestType","entityTypes","fullInfo","technologies","revenue","featureFlag","fixitDirectiveService","getOS","isPartOfCorporateHierarchy"],angular.module("dorgEuiApp").controller("fixitModalController",a)}(),function(){"use strict";function a(){function a(){if(!i.disableAdd&&_.has(i.array[Object.keys(i.array).length-1],"id"))return Object.keys(i.array).length>=i.maxLength?void(i.disableAdd=!0):void(i.array[Object.keys(i.array).length]={})}function b(){i.duplicateFieldNotice=!1}function c(a,b){if(0===Object.keys(i.array).length)return!0;if(1===Object.keys(i.array).length&&Object.keys(i.array[0]).length<1)return!0;for(var c in i.array){var d=0;if(!c)return!0;if(i.array[c].id===a.id){if(b.id!==a.id)return!1;if(!(d<1))return!1;d++}}return!0}function d(a,b){var c=e(a);c&&(i.array[c].description=b),i.duplicateFieldNotice=!1}function e(a){for(var b in i.array)if(a.id===i.array[b].id&&a.displayName===i.array[b].displayName)return b}function f(a,d){if(a&&!(Object.keys(a).length<2)){var f=angular.copy(a),g=e(d);if(b(),!c(a,d))return void(i.duplicateFieldNotice=!0);d.description&&f.id===d.id?f.description=d.description:f.description="",g?i.array[g]=f:i.array[Object.keys(i.array).length-1]=f,Object.keys(i.array).length>=i.maxLength?i.disableAdd=!0:i.disableAdd=!1,i.enabledSubmit=!0}}function g(a){var b=e(a),c=angular.copy(i.array);i.array={},delete c[b];var d=h(c);for(var f in d)i.array[f]=d[f];Object.keys(i.array).length<i.maxLength&&0!==Object.keys(i.array).length&&(i.disableAdd=!1),Object.keys(i.array).length<1&&(i.enabledSubmit=!1,i.disableAdd=!0,i.array={0:{}})}function h(a){var b=[],c={};for(var d in a)b.push(a[d]);for(var e=0;e<b.length;e++)c[e]=b[e];return c}var i=this;this.$onInit=function(){i.addField=a,i.allFalse=b,i.checkIfMatch=c,i.disableAdd=!0,i.editDescField=d,i.pushToArray=f,i.removeField=g,i.duplicateFieldNotice=!1}}angular.module("dorgEuiApp").component("modalFixitFieldsetComponent",{templateUrl:"app/directives/fixit-directive/fixit-directive-partials/modal.fixit.fieldset.html",controllerAs:"vm",bindings:{array:"=",catList:"=",enabledSubmit:"=",maxLength:"="},controller:a})}(),function(){"use strict";function a(){return{restrict:"A",scope:{focusOnTrue:"=focusOnTrue"},link:function(a,b){a.$watch("focusOnTrue",function(a){a&&setTimeout(function(){$(b[0]).select()},5)})}}}angular.module("dorgEuiApp").directive("focusOnTrue",a)}(),angular.module("dorgEuiApp").directive("footer",function(){return{restrict:"AE",templateUrl:"app/components/footer/footer.html"}}),angular.module("dorgEuiApp").directive("track",["$ga",function(a){return{controller:[function(){this.click=function(b){if(b.length<3)throw new Error("Missing params in GA Tracker Directive");a.track(b[0],b[1],b[2])}}],link:function(a,b,c,d){b.bind("click",function(){d.click(c.track.split(","))})}}}]),function(){"use strict";function a(a,b,c){function d(a){return e+a+f}var e="app/directives/grid-actions-directive/_",f=".tpl.html";return{scope:{gridActions:"=",isSearchGrid:"=gridActionsIsSearchgrid",canExport:"=gridCanExport"},priority:1,terminal:!0,templateUrl:function(a,b){return d(b.gridActionsType)},link:function(e,f,g,h){var i;if(!g.gridActionsType)throw new Error("Missing Attribute: `grid-actions-type`.");e.$watchCollection("gridActions",function(h){var j;h&&(f.empty(),e._processed=angular.copy(h),e._processed.locked=!!h.locked,e._processed.__followTitle=e._processed.followed?"Unfollow":"Follow",e._processed.__suppressedTitle=(e._processed.suppressedByCustomer||e._processed.suppressedByUser?"Unblock ":"Block ")+(e._processed.name||e._processed.fullName),e._processed.belongsToHierarchy=!!e._processed.relationshipTypeName,h._links?(e._processed.__hasCompanyUpload=h._links.hasOwnProperty("uploadCompany")||h._links.hasOwnProperty("uploadCompanyToMAT")||h._links.hasOwnProperty("uploadCompanyToSDR"),e._processed.__hasPersonUpload=h._links.hasOwnProperty("uploadLead")||h._links.hasOwnProperty("uploadContact")||h._links.hasOwnProperty("uploadContactToMAT")||h._links.hasOwnProperty("uploadLeadToMAT")||h._links.hasOwnProperty("uploadContactToSDR")||h._links.hasOwnProperty("uploadLeadToSDR")):(e._processed.__hasCompanyUpload=!1,e._processed.__hasPersonUpload=!1),e._processed.email=h.email,_.isUndefined(e.$root.Session.search.criteria)?e._processed.searchCriteria={}:e._processed.searchCriteria=c.transformActiveCriteriaToSearchCriteriaModel(e.$root.Session.search.criteria),e._processed.includeExportSearchCriteria=!!e.isSearchGrid,e._processed.canExport=!!e.canExport,j=angular.element(b.get(d(g.gridActionsType))),a(j)(e),f.append(j),i=e)}),e.$on("$destroy",function(){i&&i.$destroy(),e.$destroy()})}}}a.$inject=["$compile","$templateCache","SearchService"],angular.module("dorgEuiApp").directive("gridActions",a)}(),function(){"use strict";function a(a,b){var c=this;c._data=a.gridStars,c._svc=b}angular.module("dorgEuiApp").controller("GridStarsController",a),a.$inject=["$scope","GridStarsService"]}(),function(){"use strict";function a(){return{scope:{gridStars:"="},priority:1,terminal:!0,controller:"GridStarsController",link:function(a,b,c,d){var e=void 0;a.$watchCollection("gridStars",function(a){a&&(e&&e.$destroy(),b.empty(),d._svc.setProcessing(a).then(function(a){b.append(a.tpl),e=a._scope}))}),a.$on("$destroy",function(){e&&e.$destroy(),a.$destroy()})}}}angular.module("dorgEuiApp").directive("gridStars",a)}(),function(){"use strict";function a(a,b,c,d,e){function f(){var a=c.defer(),d="app/directives/grid-stars-directive/_stars.tpl.html";return e.get(d)?a.resolve(e.get(d)):b.get(d).then(function(a){return e.put(d,a.data||""),a.data||""}).then(a.resolve),a.promise}function g(b){var e=c.defer(),f=d.$new();return f._processed=angular.copy(b),h.getTpl().then(function(b){return b=angular.element(b),a(b)(f),{tpl:b[0],_scope:f}}).then(e.resolve),e.promise}var h=this;h.getTpl=f,h.setProcessing=g}angular.module("dorgEuiApp").service("GridStarsService",a),a.$inject=["$compile","$http","$q","$rootScope","$templateCache"]}(),angular.module("dorgEuiApp").directive("highlight",function(){return{link:function(a,b,c){switch(a.type){case"topic":null!==a.filteredTopic()&&_.each(a.filteredTopic(),function(b){if(b.displayName===a.topicName())return void c.$set("style","font-weight:bold;")});break;case"state":3===a.row().entity.state&&c.$set("style","background-color:#FCEEED;")}},restrict:"A",scope:{topicName:"&",filteredTopic:"&",row:"&",type:"@highlight"}}}),angular.module("dorgEuiApp").directive("intel",["$state","$compile","$parse","favicon","$filter","featureFlagService","intelArticleParserService",function(a,b,c,d,e,f,g){var h={int:"=intel"},i=function(c,d){function h(a){return a&&!a.match(/^[a-zA-Z]+:\/\//)&&(a="http://"+a),a}c.go=function(b,c){a.go("perform_search",{intel:{displayName:b,id:c}})},c.$watch("int",function(i){var j="",k=parseInt(a.params.detailsFor,10),l=angular.copy(i),m=_.size(l),n=0,o=a.current.name;d.empty();var p=f.findFeatureFlag(null,"triggerstoscoops");_.each(l,function(a){var f="";a.company&&($(d[0]).hasClass("intel-tab")||(f=" pop-over='int["+n+"]' pop-over-type='company'")),a.article=g.parseArticle(f,a,p,!1,k,o);var i=e("date")(p?a.displayDate:a.publishDate," ' ('M/d/yyyy')' ");if(_.has(a,"intelCategories")){var l="",q="",r="";_.each(a.intelCategories,function(a){q+="<span class='badge intel-badge'><a ng-click='go(\""+a.name+'", '+a.id+")'>"+a.name+"</a></span> "}),_.each(a.types,function(a){r+="<span class='badge intel-badge type-badge'>"+a.name+"</span> "}),p?a.descLastUpdateDate?(l+='<span class="no-wrap-word">&nbsp<i>(Original Publish Date: '+e("date")(a.publishDate,"M/d/yyyy")+")</i></span>",a.updateScoopText&&(l+="<span ><br/><strong>Update from Organization: </strong>"+(a.updateScoopText?a.updateScoopText:"")+"</span>"),l+="<br />"+i+" ",l+=r,l+=q):(l+="<br />"+i+" ",l+=r,l+=q):l+="<br />"+i+" ",a.article+=l}else a.article+=i;if(j+='<div class="intel-item">'+a.article,a.link&&a.title&&(j+=p?' (<a href="'+h(a.link)+'" target="_blank">'+a.title+"</a>)":' (<a href="'+a.link+'" target="_blank">'+a.title+"</a>)"),j+="</div>\n",n+=1,m===n){var s=angular.element(j);b(s)(c),d.append(s)}})})};return{link:i,restrict:"AE",scope:h}}]),angular.module("dorgEuiApp").directive("dorgIntlTelInput",["$log",function(a){return{link:function(b,c,d,e){if(d.type&&"text"!==d.type&&"tel"!==d.type||"INPUT"!==c[0].tagName)return void a.warn("ng-intl-tel-input can only be applied to a *text* or *tel* input");var f=document.querySelector("#phonenumber"),g=window.intlTelInput(f,{autoPlaceholder:"aggressive",initialCountry:d.initialCountry,separateDialCode:!0,utilsScript:"bower_components/intl-tel-input/build/js/utils.js"});g.promise.then(function(){e.$validators.ngIntlTelInput=function(a){return g.isValidNumber()},e.$parsers.push(function(a){return a&&g.isValidNumber(a)&&(a=g.getNumber(),g.setNumber(a)),a})})},restrict:"A",require:"ngModel",scope:{}}}]),function(){"use strict";angular.module("dorgEuiApp").directive("limitNumberInputLength",[function(){return{restrict:"A",link:function(a,b,c){function d(){var a;return window.getSelection&&window.getSelection().toString()>0&&(a=window.getSelection().toString()),a}function e(a){return a<48||a>57}function f(a){return 8!==a&&37!==a&&39!==a}var g=parseInt(c.limitNumberInputLength);angular.element(b).on("keypress",function(a){var b=a.which||a.keyCode||0,c=d();(e(b)||this.value.length>=g)&&f(b)&&!c&&a.preventDefault()})}}}])}(),angular.module("dorgEuiApp").directive("linkedin",[function(){return{link:function(a,b){_.isEmpty(a.uri)&&(b[0].outerHTML="")},restrict:"A",replace:!0,scope:{uri:"=linkedin"},template:'<i class="fa fa-linkedin-square fa-lg" pop-over="\'{{uri}}\'" pop-over-type="linkedin" pop-over-multi="true"></i>'}}]),angular.module("dorgEuiApp").controller("listsDirectiveController",["$scope","listsDirectiveService","singleModalService",function(a,b,c){function d(){return a.listLoc()||"page"}function e(a){return _.has(a,"api")?a.api.selection.getSelectedRows():a}this.interact=function(){if(a.listIgnore)return!1;var f=c.open({controller:"ListsModalController",controllerAs:"vm",resolve:{meType:function(){return a.listType},selected:function(){return e(a.list)},listOfLists:function(){return b.api(a.listType).then(function(a){return[{id:"new",displayName:"New List"}].concat(a||[])})},supportData:function(){return b.$subscriptionSuppportData()},myListLinks:function(){return b.$myListLinks()},$$scope:function(){return a},lType:function(){return d()}},templateUrl:"app/directives/lists-directive/lists-directive-partials/modal.base.partial.html"});return f}}]),angular.module("dorgEuiApp").directive("lists",[function(){var a=function(a,b,c,d){b.bind("click",d.interact)},b={allAction:"=allAction",list:"=lists",listIgnore:"=listIgnore",listLoc:"&listLoc",listMethod:"=listMethod",listType:"=listType",followListId:"=listFollowListId",savedSearchId:"=listSavedId",searchCriteria:"=listCriteria",sourceMethod:"=sourceMethod"};return{controller:"listsDirectiveController",link:a,restrict:"A",scope:b}}]),angular.module("dorgEuiApp").service("listsDirectiveService",["halClient","$rootScope","$http","$embeddedUtils","Flash","$ga","$state","$filter",function(a,b,c,d,e,f,g,h){var i=b.Session.navigation.$href("viewMyLists"),j="",k=100;this.someType=function(a){switch(a){case"company":case"companies":return"followCompany";case"person":case"persons":return"followPerson"}},this.api=function(a){var b="";return c.get(i).then(function(e){switch(a){case"company":case"companies":b=j=d.$fetchLink(e.data,"followCompanyLists");break;case"person":case"persons":b=j=d.$fetchLink(e.data,"followPersonLists")}return c.get(b).then(function(a){return d.$getD(a.data)})})},this.$post=function(a,e,h,i,j){var k={followListId:a,entityIds:_.isNumber(e[0])?e:_.pluck(e,"id")};_.size(i)>0&&(k.entityIds=[]),k=_.merge(k,i||{}),f.track("Directive","Follow List","Added Entries to List, Location Src: "+g.current.name);var l;return l=d.$fetchLink(e[0],"follow"),(_.isNull(l)||_.isUndefined(l))&&(_.isUndefined(j)||(l="person"===j||"persons"===j?"api/rest/persons/follow":"api/rest/companies/follow")),c.post(l,k).then(function(a){var c=d.$getD(a.data);return b.$broadcast("event:followed",{lType:h,ids:c,call:"followed",data:c}),c},function(){console.warn("Error")})},this.$delete=function(a,h,i,j,k,l,m){var n,o={headers:{"Content-Type":"application/json"},data:{followListId:j||a,entityIds:_.pluck(h,"id"),allAction:k}};return n=h[0]&&h[0].type?d.$fetchLink(h[0],"unFollow")||"api/rest/"+h[0].type+"/unfollow":"person"===l||"persons"===l?"api/rest/persons/unfollow":"api/rest/companies/unfollow",k&&(o.data.entityIds=[],o.data.searchCriteria=m),f.track("Directive","Follow List","Removed Entries From List, Location Src: "+g.current.name),c.delete(n,o).then(function(a){var c=d.$getD(a.data);return b.$broadcast("event:unfollowed",{lType:i,ids:c,call:"unfollowed",data:c}),e.create("success","Selected removed from lists successfully","flash"),c},function(){console.warn("Error")})},this.$newList=function(c,d){return f.track("Directive","Follow List","Created New List, Location Src: "+g.current.name),a.$get(i).then(function(a){return a.$post(c+"Lists",null,d).then(function(a){return b.$broadcast("newListCreated"),a})})},this.$subscriptionSuppportData=function(){return f.track("Directive","Follow List","Added Subscription, Location Src: "+g.current.name),c.get(i).then(function(a){return c.get(d.$fetchLink(a.data,"subscriptionLists")+"/supportdata").then(function(a){return a.data})})},this.$myListLinks=function(){return c.get(i).then(function(a){return a.data._links})},this.unsuppress=function(a){var b=_.pluck(a,"id"),e=d.$fetchLink(a[0],"unSuppress")||d.$fetchLink(a[0],"suppress");if(!e)return!1;var h={data:{entityIds:b},headers:{"Content-Type":"application/json"},method:"DELETE",url:e};return f.track("Directive","Follow List","Unsuppressed Records, Location Src: "+g.current.name),c(h).then(function(a){return a.data})},this.getNameHasSuffixCutOffByLimit=function(a,b){return!_.isEmpty(a)&&b&&(a=h("limitTo")(a,k-b.length)+b),a}}]),angular.module("dorgEuiApp").controller("ListsModalController",["$rootScope","$$scope","$uibModalInstance","$q","listsDirectiveService","userListsBaseService","Flash","listOfLists","meType","myListLinks","selected","supportData","lType",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){var a=o({id:0,name:e.getNameHasSuffixCutOffByLimit(q.newListName," - "+s+" Alerts"),sourceListType:q.sourceListType,sourceListId:q.newListSavedId,link:j.subscriptionLists.href}),b=o({id:0,name:e.getNameHasSuffixCutOffByLimit(q.newListName," - "+s+" Scoop Alerts"),sourceListType:q.sourceListType,sourceListId:q.newListSavedId,subscriptionType:3,link:j.subscriptionLists.href});d.all(a,b).then(function(){g.create("success","Selected added to <em>"+q.newListName+"</em> successfully and subscribed","flash")},function(){g.create("failed","The subscription(s) for your list <em>"+q.newListName+"</em> failed to create. Please go to My Lists to try and create it again","fail")})}function o(a){return f.setSubscription(0,a).then(function(a){return a},function(a){return 422===a.status||a.data.message.indexOf("user_subscription_name")>-1?q.submissionErrorMessage="Subscription Name must be unique.":q.submissionErrorMessage="Something went wrong with this request. Please try again.",!1})}var p,q=this,r={};_.isArray(k)||(k=[k]),p=_.groupBy(k,"followed"),q.allAction=b.allAction,q.availableLists=h,q.availableListsSelection=h[0].id,q.followed=p.true||[],q.frequencyOptions=l.scheduleTypes,q.meType=i,q.newListInputError=!1,q.newListName="",q.newListSavedId=0,q.notFollowed=p.false||[],q.sourceListType="person"===i||"persons"===i?l.followedPersonsListTypeId:l.followedCompaniesListTypeId,q.subjectRef="",q.submissionErrorMessage="",q.submissionSent=!1,q.subscribe=!0,q.subscriptionName="",q.subscriptionTypes=l.subscriptionTypes;var s="";_.has(p,"undefined")&&p.undefined.length&&(q.notFollowed=q.notFollowed.concat(p.undefined)),q.followMode=q.notFollowed.length>q.followed.length,_.isUndefined(b.followListId)||(r.followListId=b.followListId),_.isEmpty(b.sourceMethod)||(r.listMethod=b.sourceMethod.replace(/\$/,"")),_.isUndefined(b.savedSearchId)||(r.savedSearchId=b.savedSearchId),_.isUndefined(b.searchCriteria)||(r.searchCriteria=b.searchCriteria,q.allAction=!0),"companies"===i||"company"===i?q.followMode&&q.notFollowed.length>1||!q.followMode&&q.followed.length>1||q.allAction?q.subjectRef="Companies":q.subjectRef="Company":q.followMode&&q.notFollowed.length>1||!q.followMode&&q.followed.length>1||q.allAction?q.subjectRef="Employees":q.subjectRef="Employee",s=q.subjectRef,q.followListId=r.followListId,q.confirm=function(){var b;q.followMode&&"new"===q.availableListsSelection&&!q.newListName||q.newListInputError||(q.submissionSent=!0,a.$broadcast("followActionExecuting"),q.followMode?"new"!==q.availableListsSelection?(e.$post(q.availableListsSelection,q.notFollowed,m,r,q.meType).then(function(b){a.$broadcast("event:unOrFollowed",{data:b})}),q.numSuppressed()&&e.unsuppress(q.notFollowed),b=_.findWhere(h,{id:q.availableListsSelection}).displayName,g.create("success","Selected added to <em>"+b+"</em> successfully","flash"),c.close()):q.newListSavedId>0?q.subscribeToNewList():e.$newList(e.someType(q.meType),q.newListName).then(function(b){c.close(b),q.newListSavedId=b.id,e.$post(b.id,q.notFollowed,m,r,q.meType).then(function(b){a.$broadcast("event:unOrFollowed",{data:b}),n()})},q.newListError):(e.$delete(0,q.followed,m,r.followListId,q.allAction,q.meType,r.searchCriteria).then(function(b){a.$broadcast("event:unOrFollowed",{data:b})}),c.close()))},q.newListError=function(a){return _.has(a.data,"message")&&a.data.message.indexOf("user_list_name")>-1?q.submissionErrorMessage="Please enter a unique list name or select from the Source List.":q.submissionErrorMessage="Something went wrong with this request. Please try again.",q.newListInputError=!1,q.submissionSent=!1,!1},q.numSuppressed=function(){return _.where(q.notFollowed,{suppressedByUser:!0}).length},q.subscriptionNameFocus=function(){0===q.subscriptionName.trim().length&&q.newListName.trim().length>0&&(q.subscriptionName=SearchService.getSavedSearchNameCutOffByMaxlengthLimit(q.newListName))},q.onSelectExistingList=function(){"new"!==q.availableListsSelection&&(q.newListName="",q.onNewListNameChange())},q.onNewListNameChange=function(){var a=!0;_.each(q.availableLists,function(b){"new"!==b.id&&b.displayName.toLowerCase()===q.newListName.toLowerCase()&&(a=!1)}),a?q.newListInputError&&(q.submissionErrorMessage="",q.newListInputError=!1):(q.submissionErrorMessage="Please enter a unique list name or select from the Source List.",q.newListInputError=!0)},q.close=function(){c.dismiss("cancel")}}]),angular.module("dorgEuiApp").directive("navigation",function(){return{controller:"NavBarController",restrict:"E",templateUrl:"app/components/navbar/navbar.html"}}),angular.module("dorgEuiApp").directive("ngIfOnce",["$animate",function(a){var b="ng-hide",c="ng-hide-animate";return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(d,e,f,g,h){var i,j;d.$watch(f.ngIfOnce,function(d){d?j?a.removeClass(i.clone,b,{tempClasses:c}):h(function(b,c){j=c,b[b.length++]=document.createComment(" end ngIfOnce: "+f.ngIfOnce+" "),i={clone:b},a.enter(b,e.parent(),e)}):i&&a.addClass(i.clone,b,{tempClasses:c})})}}}]),angular.module("dorgEuiApp").directive("ngImgError",["dorgConfig",function(a){return{link:function(b,c,d){c.bind("error",function(){d.$set("src",a.BLANK_IMG)})},restrict:"A"}}]).directive("ngPersonImgError",["dorgConfig",function(a){return{link:function(b,c,d){c.bind("error",function(){d.$set("src",a.BLANK_PERSON)})},restrict:"A"}}]),angular.module("dorgEuiApp").directive("parseList",function(){return{restrict:"A",link:function(a,b,c,d){console.info(d),d.$parsers.push(function(a){return d.$setViewValue(_.map(_.words(a,/[^, \n\t]+/g),_.trim)),a})},require:"ngModel"}}),function(){"use strict";angular.module("dorgEuiApp").directive("numberOnly",[function(){var a=function(a,b,c,d){d.$parsers.push(function(a){if(null==a)return"";var b=a.toString().replace(/^0+|[^0-9]+/g,"");return b!=a&&(d.$setViewValue(b),d.$render()),b})};return{link:a,restrict:"A",require:"ngModel"}}])}(),function(){"use strict";angular.module("dorgEuiApp").directive("onEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.onEnter,{event:b})}),b.preventDefault())})}})}(),function(){"use strict";function a(){return{restrict:"A",link:function(a,b,c){var d;b.bind("click",function(){if(!d)return d=a.$eval(c.openSingleModal),d&&d.result&&"function"==typeof d.result.then?void d.result.finally(function(){d=void 0}):void console.error("Open modal occur error",b,d)})}}}angular.module("dorgEuiApp").directive("openSingleModal",a)}(),angular.module("dorgEuiApp").controller("orgchartController",["$rootScope","$scope","orgChartService","$interval","$state","$timeout","$animate","$uibModal","phoneNumberService","LazyLoadingImage","userSettingsService","$window",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a,d){for(var e=0,f=a.length;e<f;++e)a[e].reporters.length>0&&m(a[e].reporters,d),a[e].showDetails=d&&!a[e].person.locked&&!b.isMinorBouncePerson(a[e]),_.isObject(a[e].person)&&(c.clearFitOrgchart(a[e].person.id,b.deptId),c.fitDataExpandCollapse(a[e].person.id,b.deptId,a[e].showDetails))}function n(a){return a&&!_.isEmpty(a.officeTelNumber)}function o(a){return n(a)||!_.isEmpty(b.mainPhoneNumber)}function p(a){return a&&!_.isEmpty(a.mobileTelNumber)}function q(a){return o(a)||p(a)}function r(a){return a&&!_.isEmpty(a.email)}function s(a,c){return i.getOfficeNumberOrBlank(a)||i.getPhoneNumberOrBlank(b.mainPhoneNumber,c)}function t(a){return i.getMobileNumberOrBlank(a)}function u(a){return k.checkUserHasAllowedLeadOrContactUpload()&&(a.hasOwnProperty("uploadLead")||a.hasOwnProperty("uploadContact")||a.hasOwnProperty("uploadContactToMAT")||a.hasOwnProperty("uploadLeadToMAT")||a.hasOwnProperty("uploadContactToSDR")||a.hasOwnProperty("uploadLeadToSDR"))}function v(a){for(var d=0;d<a.length;++d)a[d].reporters.length>0&&v(a[d].reporters),_.isObject(a[d].person)&&(c.clearFitOrgchart(a[d].person.id,b.deptId),c.fitDataExpandCollapse(a[d].person.id,b.deptId,a[d].showDetails))}function w(a,b){for(var c=0;c<a.length;++c){if(a[c].reporters.length>0&&w(a[c].reporters,b))return!0;if(a[c].person.id===b)return a[c].person.suppressedByUser=!0,a[c].showDetails=!1,!0}return!1}g.enabled(!1);var x=new j({elements_selector:".lazy"}),y=this,z=_.random(100,1e5),A=[],B=!1,C={"-1":!1,1:!1,2:!1,3:!1,4:!1},D=c.updateNodeValues,E=d(function(){var a=$("#renderMsg-"+z),b=$("#orgBlob-"+z);a.length>0&&b.length>0&&(d.cancel(E),a.hide())},5e3,6),F=" | ",G="Privacy Requested";this.walkAndFind=function(a){c.collapseExpandNodes(b.nodes,a)},b.$watch("orgchartSearchQuery",function(){y.filterResults()}),angular.element(l).bind("resize",function(){b.nodes&&b.nodes.length>0&&v(b.nodes)}),this.filterResults=function(){b.hasActiveFilter=!_.isEmpty(b.orgchartSearchQuery),c.collapseExpandFilteredNodes(b.nodes,b.orgchartSearchQuery)},b.getOfficeThenMobileThenCompanyNumberOrBlank=s,b.getMobileNumberOrBlank=t,b.hasOfficePhone=n,b.hasDirectPhone=o,b.hasMobilePhone=p,b.hasPhoneNumber=q,b.hasEmail=r,b.phoneSeparator=F,b.privacyRequestedLabel=G,b.canBulkUpload=c.canBulkUpload(),b.checkcanUpload=u,b.$selectedNodes=A,b.getCssDepth=c.cssDepth,b.$$randHash=z,b.$empAllLoaded="view_person"===e.current.name||B,b.$on("event:orgchart",function(a,c){D(b.nodes,c.data)}),b.$on("event:suppression",function(a,d){if("suppression"===d.call&&"orgChart"===d.lType&&!_.isUndefined(d.data)&&void 0==d.data[0].companyId){if(0==d.data[0].suppressedByUser){var e=_.findIndex(b.nodes,function(a){return a.person.id==d.data[0].id});e>=0?b.nodes[e].person.suppressedByUser=!0:w(b.nodes,d.data[0].id)}c.clearFitOrgchart(d.data[0].id,b.deptId)}}),b.showSlider=!!_.isUndefined(b.showSlider)||b.showSlider,b.showFilter=!!_.isUndefined(b.showFilter)||b.showFilter,b.showBulkActions=!!_.isUndefined(b.showBulk)||b.showBulk;var H=a.Session.account,I=c.setMaxDepth(b.nodes);b.hasUnlockedNodes=c.hasUnlockedNodes(b.nodes),b.slider={sliderValue:I,opts:{max:I,min:1,step:1,range:_.range(1,I),width:parseFloat(100/I)+"%"}},b.level=null,b.changeLevelTab=function(){var a=null!=b.level?b.level:b.slider.opts.max;I>1&&(b.slider.sliderValue=a,y.walkAndFind(a))},b.toggleAllDetailsText=!1,b.toggleAllDetails=function(){if(b.toggleAllDetailsText=!b.toggleAllDetailsText,C[b.deptId||"-1"]){
var a=b.toggleAllDetailsText;void 0==b.deptId?m(b.nodes,a):c.getPersonDetails(b.parentResource.id,b.deptId).then(function(d){var e=d.data;c.allEmployeeDataMerge(b.nodes,e),m(b.nodes,a)})}else c.allDetails(b.nodes,b.deptId,b.toggleAllDetailsText,b.parentResource.id),C[b.deptId||"-1"]=!0},b.toggleAllSelectText=!1,b.toggleAllSelection=function(){if(0!==b.nodes.length){b.toggleAllSelectText=!b.toggleAllSelectText;var a=function a(c){for(var d=0,e=c.length;d<e;++d){c[d].reporters.length>0&&b.nodeHasVisibleChildren(c[d])&&a(c[d].reporters);var f=_.indexOf(b.$selectedNodes,c[d].person);b.toggleAllSelectText&&f<0&&!b.isDisabledNode(c[d])&&!b.isMinorBouncePerson(c[d])?b.isNodeVisible(c[d])&&b.$selectedNodes.push(c[d].person):b.toggleAllSelectText||b.$selectedNodes.splice(f,1)}};a(b.nodes)}},b.toggleAllIndividual=function(){b.toggleAllSelectText=!1},b.toggleNode=function(a){a.toggle()},b.orgChartGotoTop=c.backToTopHandler,b.clickOuterLeaf=function(a,b){a.person.locked||(a.showDetails=!a.showDetails,c.clearFitOrgchart(a.person.id,b),c.singleDetails(a.person,b,a.showDetails))},$(window).scroll(c.toggleFixedItems),b.$watch("$isCompany",function(a){a&&!B&&(c.allEmployeeDataMerge(b.nodes,a),a.length>0&&f(function(){B=!0,C[b.deptId]=!0,b.$empAllLoaded=B},500))}),b.isNodeVisible=function(a){return b.hasActiveFilter&&a.isMatchingFilter||a.isInitialized&&!b.hasActiveFilter},b.nodeHasVisibleChildren=function(a){return a.reporters.length>0&&b.isNodeVisible(a)&&(a.isExpanded&&!b.hasActiveFilter||b.hasActiveFilter&&a.isMatchingFilter&&a.isExpanded!==!1)},b.showUnlockModal=function(a){h.open({controller:["$uibModalInstance",function(c){function d(){c.close(!1)}var e=this,f="";"locked content"!==a.person.fullName.toLowerCase()&&(f=a.person.fullName+" at "),e.close=d,e.subjectLine=encodeURIComponent("Access Request From "+H.firstName+" "+H.lastName+": "+f+b.companyName),e.bodyLine=encodeURIComponent("I am interested in more information on how to gain access to the data set which includes "+f+b.companyName+".")}],controllerAs:"companyUnlockVm",size:"md",templateUrl:"app/views/company/partials/unlock.modal.html",windowClass:"lock-modal"})},b.isDisabledNode=function(a){return a.person.locked||a.person.privacyRequested},b.isBlocked=function(a){return a.person.suppressedByCustomer||a.person.suppressedByUser},b.isMinorBouncePerson=c.isMinorBouncePerson;var J,K=c.getTotalNodesInTree(b.nodes)>100?10:1e3,L=function(){var a=0,e=function b(c){for(var d=0;d<c.length;d++){var e=c[d];if(!e.allChildrenInitialized){if(e.isInitialized||(e.isExpanded=e.reporters.length>0,e.isInitialized=!0,a++),a>=K)return!1;if(e.reporters.length>0?e.allChildrenInitialized=b(e.reporters):e.allChildrenInitialized=!0,!e.allChildrenInitialized)return!1}}return!0};e(b.nodes),a<K&&(d.cancel(J),f(function(){x.update()},0)),c.toggleFixedItems(),x.update()};L(),f(function(){J=d(L,500)},0),b.$on("$destroy",function(){$(window).off("scroll",c.toggleFixedItems)}),b.validateJobFunction=function(a){var c=!1,d=".department-"+b.deptId+" #jobFunction-"+a;return $(d)&&$(d)[0]&&(c=$(d)[0].scrollHeight>$(d).innerHeight()),c}}]).filter("htmlToPlaintext",function(){return function(a){return a?a.replace(/<[^>]+>/gm,""):""}}),angular.module("dorgEuiApp").directive("orgchart",function(){return{controller:"orgchartController",restrict:"AE",scope:{nodes:"=orgchartData",showSlider:"=orgchartShowSlider",showFilter:"=orgchartShowFilter",showBulk:"=orgchartBulkActions",personId:"=orgchartPerson",mainPhoneNumber:"=mainPhoneNumber",parentResource:"=parentResource",deptId:"=orgchartDept",$isCompany:"=orgchartIsCompany",companyId:"=orgchartCompany",companyName:"=orgchartCompanyName",canExport:"=orgchartCanExport",canUpload:"=orgchartCanUpload"},templateUrl:"app/directives/orgchart-directive/orgchart-partials/orgchart.base.html"}}),angular.module("dorgEuiApp").directive("orgchartJobFn",function(){return{restrict:"AE",require:"^orgchart",link:function(a,b){b.append(a.jobs),b.attr("title",a.jobs)},scope:{jobs:"=orgchartJobFn"}}}),angular.module("dorgEuiApp").service("orgChartService",["$http","$rootScope","$embeddedUtils","$checkBulk","$state",function(a,b,c,d,e){function f(a,b,c){c&&!m()&&angular.element(document).ready(function(){var c=!1,d=112,e=i(a,b),f=$(e);if(f.length>0&&(c=f[0].scrollHeight>f.innerHeight()),c){var j=f[0].scrollHeight>d?f[0].scrollHeight:d;l()?(f.css("min-height",j+"px"),f.find("img").css("height",d+"px"),f.find("img").css("width",d+"px"),$(document).ready(function(){f=$(e),f[0].scrollHeight>j&&g(f,f[0].scrollHeight)})):g(f,j)}else h(a,b)})}function g(a,b){a.css("min-height",b+"px"),a.css("height",b+"px")}function h(a,b){var c=i(a,b),d=$(c);d&&(d.css("min-height",""),d.css("min-width",""),d.find("img").css("height",""),d.find("img").css("width",""))}function i(a,b){var c,d=$(".department-"+b);return c=d&&d.length>0?".department-"+b+" #OrgNode-"+a:"#OrgNode-"+a}function j(a){var b="";if(!_.isEmpty(a))for(var c=0;c<a.length;++c){var d=a[c];b+=d.person.id+",",d.reporters.length>0&&(b+=j(d.reporters))}return b}function k(a){$("html, body").animate({scrollTop:$("#orgchart-wrapper").offset().top-a},300)}function l(){var a=$(window).width();return a>p&&a<=q}function m(){var a=$(window).width();return a>q}var n=this,o=$("#well").hasClass("ie"),p=768,q=1112,r=19;this.isMinorBouncePerson=function(a){return a.person.stateChangeReasonId===r},this.canUpload=function(a){var b=!1;return _.has(a,"_links.uploadCompany")&&(b=!0),(_.has(a,"_links.uploadContact")||_.has(a,"_links.uploadLead"))&&(b=!0),_.has(a,"$has")&&(a.$has("uploadContact")||a.$has("uploadLead"))&&(b=!0),b},this.canBulkUpload=d.$checkPersons,this.setMaxDepth=function(a){var b=[],c=function(a,d){_.each(a,function(a){a.reporters.length>0?c(a.reporters,d+1):b.push(d)})};return c(a,1),_.max(b)},this.getTotalNodesInTree=function(a){function b(a){_.each(a,function(a){a.reporters.length>0&&b(a.reporters),c++})}var c=0;return b(a),c},this.cssDepth=function(a){return a%10===0?10:a%10},this.collapseExpandNodes=function(a,b){function c(a,b,d){_.each(a,function(a){a.isExpanded=b>d,a.reporters.length>0&&c(a.reporters,b,d+1)})}c(a,b,1)};var s=["fullName","title","officeTelNumber","email","jobFunction"];this.collapseExpandFilteredNodes=function(a,b){function c(a){var b,e=!1;return _.each(a,function(a){var f=!1;a.reporters.length>0&&(f=c(a.reporters)),a.isMatchingFilter=f||d(a),a.isLastVisibleSibling=!1,a.isMatchingFilter&&(b=a),e=e||a.isMatchingFilter}),b&&(b.isLastVisibleSibling=!0),e}function d(a){var c=!1;return _.each(s,function(d){var e=a.person[d];_.isString(e)&&e.toLowerCase().indexOf(b.toLowerCase())>-1&&(c=!0)}),c&&e(a),c}function e(a){function b(a){_.each(a,function(a){a.isExpanded=!1,a.isMatchingFilter=!0,a.reporters.length>0&&b(a.reporters)})}b(a.reporters)}b=b||"",c(a)},this.updateNodeValues=function(a,b){var c=b,d=function a(b){for(var d=0,e=b.length;d<e;++d){var f=_.where(c,{id:b[d].person.id})[0];b[d].reporters.length>0&&a(b[d].reporters),f&&(b[d].person=_.merge(b[d].person,f))}};d(a)},this.singleDetails=function(d,e,g){a.get(b.$orgDetailsLink,{params:{departmentId:e||"",personIds:d.id}}).then(function(a){d=_.merge(d,c.$getD(a.data)[0]),d.detailsLoaded=!0,f(d.id,e,g)})},this.fitDataExpandCollapse=f,this.clearFitOrgchart=h,this.getPersonDetails=function(b,c){return a.get("api/rest/companies/"+b+"/orgchartpersonsstatuses?departmentId="+c)},this.allDetails=function(d,e,g,i){var k=j(d);a.get(b.$orgDetailsLink,{params:{departmentId:e||"",companyId:i||null,personIds:k}}).then(function(a){var b=c.$getD(a.data),e=function a(c){for(var d=0,e=c.length;d<e;++d)if(c[d].reporters.length>0&&a(c[d].reporters),!c[d].person.locked&&!n.isMinorBouncePerson(c[d])){var i=c[d].person.id,j=c[d].person.departmentId;c[d].showDetails=g,b.length>0&&(c[d].person=_.merge(c[d].person,_.where(b,{id:i})[0]),c[d].person.detailsLoaded=!0),g||h(i,j),f(i,j,g)}};e(d)})},this.allEmployeeDataMerge=function(a,b){var c=function a(c){for(var d=0,e=c.length;d<e;++d)c[d].reporters.length>0&&a(c[d].reporters),b.length>0&&(c[d].person=_.merge(c[d].person,_.where(b,{id:c[d].person.id})[0]),c[d].person.followed=!!c[d].person.followed,c[d].person.detailsLoaded=!0)};c(a)},this.toggleFixedItems=function(){var a,b=$("#hierarchyTopButton");b.length>0?a="#orgchart-wrapper-hierarchy":(b=$(".angular-ui-tree:visible").parent().find(".orgChartTopButton"),a="#orgchart-wrapper");var c;$(a).offset()&&(c=$(window).scrollTop()>$(a).offset().top,b.length>0&&(c?($(".orgchart-number-results-selected").addClass("stickydiv"),"0"===b.css("opacity")&&(o?b.animate({opacity:1,right:50},100):b.css({"-webkit-animation-name":"orgChartTopButtonAnim","animation-name":"orgChartTopButtonAnim"}))):($(".orgchart-number-results-selected").removeClass("stickydiv"),"0"!==b.css("opacity")&&(o?b.animate({opacity:0,right:-150},100):b.css({"-webkit-animation-name":"orgChartTopButtonAnimReversed","animation-name":"orgChartTopButtonAnimReversed"})))))},this.backToTopHandler=function(){"view_company"===e.current.name?$(".right-child").offset()?$("html, body").animate({scrollTop:$(".right-child").offset().top-100},300):k(248):k(120)},this.hasUnlockedNodes=function(a){var b=!1;if(a.length>0){var c=function a(c){for(var d=0,e=c.length;d<e;++d){if(!c[d].person.locked)return b=!0;c[d].reporters.length>0&&a(c[d].reporters)}};c(a)}return b}}]),angular.module("dorgEuiApp").directive("paginationSave",["paginationSaveService",function(a){return{link:function(b,c,d,e){b.$watch(function(){return e.$modelValue},function(b,c){b!==c&&a.setPageSize(b)})},restrict:"A",replace:!1,require:"ngModel",scope:!1}}]),angular.module("dorgEuiApp").service("paginationSaveService",["$http","$grid","$rootScope","account",function(a,b,c,d){this.setPageSize=function(e){var f=c.Session.navigation.$href("accountPreferences"),g=c.Session.account.preferences,h=!!g.grid,i=!!g.grid&&!!g.grid.pageSize;return h||i?g.grid.pageSize=e:(g.grid={},g.grid.pageSize=e),b.sanitizeGrid(g).then(function(b){a.post(f,b).then(d.get).then(function(a){c.Session.account=a})})}}]),angular.module("dorgEuiApp").controller("personNoteDirectiveController",["$scope","personNoteDirectiveService","$rootScope","$q","singleModalService",function(a,b,c,d,e){var f=a.personLoc()||"page";this.interact=function(){var g=e.open({controller:["$scope","$uibModalInstance","resourceView","Flash",function(a,d,e,g){a.personName=e.person.fullName,a.personNote=e.personNoteNew,a.personNotesHistory=e.personNotesHistory,a.person=e.person,a.confirm=function(){b.save(a.personNote).then(function(){var b=_.clone(a.person);b.hasNotes=!0,d.close(),c.$broadcast("event:noteSaved",{lType:f,data:[b]}),g.create("success","Note successfully saved","flash")})},a.close=function(){var b=_.clone(a.person);b.hasNotes=a.personNotesHistory.length>0,d.close(),c.$broadcast("event:noteSaved",{lType:f,data:[b]})},a.getPersonNote=function(c){b.getPersonNote(c).then(function(b){a.personNote=angular.copy(b),_.isEmpty(b)||(a.personNote.$href=b.$href,a.personNote.$put=b.$put)})},a.deleteNote=function(c){b.deleteNote(c).then(function(){b.getPersonNotesHistory(e.person).then(function(b){a.personNotesHistory=b,c.id===a.personNote.id&&(a.personNote=e.personNoteNew)})})},a.newNote=function(){a.personNote=e.personNoteNew}}],resolve:{resourceView:function(){var c=d.defer(),e={person:a.person,personNoteNew:{},personNotesHistory:[]};return b.getPersonNotesHistory(a.person).then(function(d){e.personNotesHistory=d,b.getNewPersonNote(a.person).then(function(a){e.personNoteNew=a,c.resolve(e)})}),c.promise}},size:"",templateUrl:"app/directives/person-note-directive/person-note-directive-partials/modal.base.partial.html"});return g}}]),angular.module("dorgEuiApp").directive("personNote",[function(){var a=function(a,b,c,d){b.bind("click",d.interact)},b={request:"=personNote",person:"=person",personLoc:"&personLoc"};return{controller:"personNoteDirectiveController",link:a,restrict:"A",scope:b}}]),angular.module("dorgEuiApp").service("personNoteDirectiveService",["halClient","$rootScope","$q","$http","$embeddedUtils","$ga","$state",function(a,b,c,d,e,f,g){this.getPersonNote=function(a){return f.track("Directive","Person Notes","Retrieved Note, Location Src: "+g.current.name),a.$get("self")},this.getEntity=function(b){return a.$get(e.$fetchLink(b,"self")).then(function(a){return a})},this.save=function(a){return f.track("Directive","Person Notes","Saved, Location Src: "+g.current.name),d.put(e.$self(a),a)},this.deleteNote=function(a){return f.track("Directive","Person Notes","Deleted, Location Src: "+g.current.name),d.delete(e.$self(a))},this.getPersonNotesHistory=function(b){var c=e.$fetchLink(b,"personnotes");return a.$get(c).then(function(a){return a.$has("personNoteList")?a.$get("personNoteList").then(function(a){return a},function(){return[]}):[]})},this.getNewPersonNote=function(a){var b=e.$fetchLink(a,"newpersonnote");return d.get(b).then(function(a){return a.data})}}]),angular.module("dorgEuiApp").directive("popOver",["$compile","$embeddedUtils","$ga","$http","$parse","$q","$rootScope","$state","$templateCache","$timeout","userSettingsService","CompanyService",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){var a=[];return $(".popover-container:visible").each(function(){a.push({id:$(this).attr("id"),zIndex:$(this).css("z-index")})}),a.sort(function(a,b){return a.zIndex<b.zIndex?-1:a.zIndex>b.zIndex?1:0}),a}function n(){var a=[];return $(".popover-container-glossary:visible").each(function(){a.push({id:$(this).attr("id")})}),a}function o(){$(".popover-container").hide()}_.each(["app/directives/pop-over-directive/company.tpl.html","app/directives/pop-over-directive/dealPredict.tpl.html","app/directives/pop-over-directive/person.tpl.html","app/directives/pop-over-directive/linkedin.tpl.html","app/directives/pop-over-directive/corporateHierarchy.tpl.html","app/directives/pop-over-directive/glossary.tpl.html"],function(a){i.get(a)||d.get(a).then(function(b){i.put(a,b.data)},function(){throw new Error("Error loading pop-over directive TPL "+a)})}),g.$on("$locationChangeStart",o),g.$on("hidePopovers",o),$(window).on("resize",o),$(window).on("keydown",function(a){var b;27===a.keyCode&&(b=m(),b.length&&$("#"+b[b.length-1].id).hide())});var p=0;return angular.element($("body")).bind("mousewheel",function(a){var b=$(".modal-content");if(b.length){var c=b.offset().top;if(0!=p&&p!=c){var d=n();d.length>0&&$("#"+d[d.length-1].id).hide()}p=c}}),{link:{pre:function(a,b,c){if(!c.popOverType||["company","dealPredict","linkedin","corporateHierarchy","person","glossary"].indexOf(c.popOverType)===-1)throw new Error("The pop-over-type is required for the pop-over directive and must be company, linkedin, corporateHierarchy, or person.")},post:function(n,o,p){function q(b){function c(){L=A(),F&&(F.empty().append(m),"person"===p.popOverType&&(L.data.locked&&F.is(":visible")&&F.hide(),F.is(":visible")&&(F.hide(),j(D,10))),a(F.contents())(L),"dealPredict"===p.popOverType&&(L.triggerLink=s),F.find(".close-popover").on("click",function(){F.hide()}),g.resolve())}var d,g=f.defer(),h="",m=i.get("app/directives/pop-over-directive/"+p.popOverType+".tpl.html");return"dealPredict"===p.popOverType&&(h+=" deal-predict-popover",L.data.fitscore.oppAlertFound&&(d=L.data.company?L.data.company:L.data,k.getSupportedFits().then(function(a){var b=[];_.each(_.values(a.userLeadModel.oppAlertCategoryIds),function(c){var d=_.find(a.oppAlertCategoryOptions,{id:c});d&&b.push(d)}),L.oppAlertFound={company:JSON.stringify({id:d.id,displayName:d.name}),oppAlertCategories:JSON.stringify(b)}},function(){L.oppAlertFound={company:JSON.stringify({id:d.id,displayName:d.name})}}))),"corporateHierarchy"===p.popOverType&&(c(),h+=" corporate-hierarchy-popover",l.getCompanyHierarchy(L.data.id).then(function(a){if(a&&a.length>0){var b=r(a[0]);L.data.corpHierarchy=b}})),"glossary"===p.popOverType&&(h+=" popover-container-glossary"),$("body").append('<div class="popover-container'+h+'" id="'+N+'">'+m+"</div>"),F=$("#"+N),n.$on("$destroy",function(){F.remove()}),n.$watchCollection(function(){return e(p.popOver)(n)},c),c(),b&&"function"==typeof b&&j(b),g.promise}function r(a,b,c){return b="undefined"!=typeof b?b:[],c="undefined"!=typeof c?c:"a",a.depth=c,b.push(a),a.children.length>0&&a.children.forEach(function(a){r(a,b,c+"a")}),b}function s(){var a;a=L.data.company?L.data.company.id:L.data.id,k.getSupportedFits().then(function(b){g.$broadcast("intelDPLink",{companyId:a,intelCategoryIds:_.values(b.userLeadModel.intelCategoryIds)})},function(){g.$broadcast("intelDPLink",{companyId:a,oppAlertCategories:[]})})}function t(a){a.stopPropagation()}function u(a){3===a.which&&(O=!0)}function v(){O||j(function(){K||(F.hide(),j.cancel(G))},400)}function w(){var a=$(o).find("a")[0];return 2*(a.offsetLeft+a.offsetWidth)}function x(){var a;return F.hasClass("popover-container-left")?a="auto":(a=$(o).offset().left+$(o).outerWidth(),"linkedin"===p.popOverType&&(a+=13)),"glossary"===p.popOverType&&(a-=100),a}function y(){var a,b=(window.outerHeight-window.innerHeight)/2;if(F.outerHeight()-$(document).height()<b&&(b=0),-document.body.getBoundingClientRect().top+document.body.getBoundingClientRect().height<$(o).offset().top+F.outerHeight()){var c=$(o).offset().top-F.outerHeight()+45,d=c<0?Math.abs(c)+15+b:15;F.find(".arrow").css({bottom:d,top:"auto"}),a=c<0?b:c,"linkedin"===p.popOverType&&(a-=15),"corporateHierarchy"===p.popOverType&&(F.find(".arrow").css({bottom:"auto",top:15}),a=$(o).offset().top-10)}else F.find(".arrow").css({bottom:"auto",top:15}),a=$(o).offset().top-10,"linkedin"===p.popOverType&&(a-=9);return"glossary"===p.popOverType&&(a=$(o).offset().top-F.outerHeight(),F.find(".arrow").css({bottom:a-105}),a-=12),a}function z(){var a;return F.hasClass("popover-container-left")?(a=$("body").width()-$(o).offset().left,"linkedin"===p.popOverType&&(a+=12)):a="auto",a}function A(){L instanceof n.constructor&&L.$destroy();var a,b,c;return L instanceof n.constructor&&L.$destroy(),a=g.$new(),"linkedin"!==p.popOverType&&(c=e(p.popOver)(n),a._links=_.cloneDeep(c._links),"company"===p.popOverType&&c.company?(b=c.company,b.locked=c.locked,c.company._links||(b._links=_.cloneDeep(c._links)),b._links&&b._links.follow&&(b._links.follow.href=b._links.follow.href.replace("persons","companies"))):b=c),"linkedin"!==p.popOverType&&(a.data=b,a.data._links=b._links),_.has(a,["followed"])&&(a._followed=a.followed?"Unfollow":"Follow"),a}function B(a){return!(a>10)&&void j(function(){F.find(".IN-widget").outerHeight()>F.outerHeight()-55&&(F.css("height",F.find(".IN-widget").outerHeight()+55),-document.body.getBoundingClientRect().top+document.body.getBoundingClientRect().height<$(o).offset().top+F.outerHeight()?F.css("top",$(o).offset().top-F.outerHeight()+30).find(".arrow").css({bottom:15,top:"auto"}):F.css("top",$(o).offset().top-19).find(".arrow").css({bottom:"auto",top:15})),B(a+1)},500)}function C(a){var b,c=0;if(a.col&&a.col.grid&&a.col.grid.columns){b=a.col.grid.columns;for(var d=0;d<b.length;d++)b[d].visible&&c++}return 2===c}function D(){$(".popover-container:not(.keep-open)").hide(),p.popOverMulti&&!F.hasClass("keep-open")&&F.addClass("keep-open"),I||($(o).offset().left+$(o).width()+400>$("body").width()?F.addClass("popover-container-left"):F.hasClass("popover-container-left")&&F.removeClass("popover-container-left")),"linkedin"===p.popOverType&&F.css({width:369,height:375}),E(),"linkedin"!==p.popOverType&&L.data.locked||(J?F.hide():F.show(),j(E))}function E(){F.find(".popover-content").css({maxHeight:$(document).height()-75});var a=y(),b=x(),c=z();J=a<0&&"auto"==b||a<0&&"auto"==c,F.css({top:a,left:I?w():b,right:c,"z-index":function(){var a=m();return $(".popover-container:visible").each(function(){a.push({id:$(this).attr("id"),zIndex:$(this).css("z-index")})}),a.sort(function(a,b){return a.zIndex<b.zIndex?-1:a.zIndex>b.zIndex?1:0}),_.each(a,function(a,b){$("#"+a.id).css("z-index",2e3+b)}),a.length+2e3}()})}var F,G,H,I,J,K=!0,L=A(),M=!1,N="pop"+_.uniqueId(),O=!1,P=!1,Q=_.debounce(function(){if("linkedin"!==p.popOverType&&!P){if(I=C(n),M&&"corporateHierarchy"!==p.popOverType||q(function(){$("body").on("click",function(){F.is(":visible")&&(F.hide(),j.cancel(G))}),"corporateHierarchy"===p.popOverType?($(o).on("click",t),F.on("click",t)):(F.on("mouseenter",function(){K=!0,j(function(){K=!1},410)}),$(o).on("click",t).on("mousedown",u).on("mouseleave",v),F.on("click",t).on("mousedown",u).on("mouseleave",v))}),"company"===p.popOverType&&!L.data.location||"person"===p.popOverType&&!L.data.title)return!1;K=!0,j(function(){K=!1},410),M?D():(j(D,10),M=!0),j(function(){"company"===p.popOverType&&(H=b.$fetchLink(L,"topManagers"),H||(H=b.$fetchLink(L,"companyTopManagers")),H||(H="api/rest/companies/"+L.data.id+"/topManagers"),H&&!L.topManagersRequested?G=j(function(){d.get(H).then(function(a){L.topManagersRequested=!0;var c=b.$getD(a.data);c?(L.managers=c,j(function(){F.css("top",y())},5)):L.managers=[]})},300):L.topManagersRequested||(L.managers=[]))},5)}},250);$(o).on("click",function(){if("linkedin"===p.popOverType){var a,b,d=function(){a=F.find(".linkedInSupporter"),b=p.popOver,"'"===b.substring(0,1)&&(b=b.slice(1,-1)),a.attr("data-id")||(a.attr("data-id",b),IN.parse(F.get(0)),B(0),j(function(){L.timeout=!0},6e3))};M||q(function(){F.find(".close-popover").on("click",function(){F.hide()})}).then(d),F.is(":visible")?F.hide():(c.track("Directive","LinkedIn","Page, Location Src: "+h.current.name),M?D():(j(D,10),M=!0),d())}}),"corporateHierarchy"===p.popOverType?$(o).on("click",Q):($(o).on("mouseenter",Q),$(o).on("mouseleave",Q.cancel),$("body").on("mouseup",function(){O=!1})),g.$on("$stateChangeStart",function(){P=!0}),g.$on("updatePopoverHorizontal",function(){$(F).length&&F.css({left:x(),right:z()})})}},restrict:"A"}}]),angular.module("dorgEuiApp").directive("popoverClose",function(){return{controller:["$scope","$timeout",function(a,b){a.close=function(a){angular.element(a.target).scope().$parent.$$childHead.isOpen=!1,b(function(){$(a.target).parents(".popover").remove()},150)}}],replace:!0,restrict:"EA",template:'<i class="fa fa-times popover-close-icon" ng-click="close($event)"></i>'}}),angular.module("dorgEuiApp").controller("promptDialogDirectiveController",["$scope","$uibModal",function(a,b){this.interact=function(){b.open({controller:["$scope","$uibModalInstance","modalInfo",function(a,b,c){a.message=c.message,a.close=function(){b.dismiss("cancel")},setTimeout(function(){b.close()},3e3)}],resolve:{modalInfo:function(){var b={message:a.message};return b}},size:"me",templateUrl:"app/directives/prompt-dialog-directive/prompt-dialog-directive-partials/modal.base.partial.html"})}}]),angular.module("dorgEuiApp").directive("promptDialogModal",[function(){var a=function(a,b,c,d){b.bind("click",function(){"disabled"===$(this).attr("disabled")&&d.interact()})},b={request:"=promptDialogModal",message:"=message"};return{controller:"promptDialogDirectiveController",link:a,restrict:"A",scope:b}}]),function(){"use strict";function a(a,b,c,d,e,f,g){var h={int:"=scoop"},i=function(c,d){function h(a){return a&&!a.match(/^[a-zA-Z]+:\/\//)&&(a="http://"+a),a}c.go=function(b,c){a.go("perform_search",{intel:{displayName:b,id:c}})},c.$watch("int",function(i){var j="",k=parseInt(a.params.detailsFor,10),l=angular.copy(i),m=_.size(l),n=0,o=a.current.name;d.empty();var p=f.findFeatureFlag(null,"triggerstoscoops");_.each(l,function(a){var f="";a.company&&($(d[0]).hasClass("intel-tab")||(f=" pop-over='int["+n+"]' pop-over-type='company'")),a.article=g.parseArticle(f,a,p,!1,k,o);var i=e("date")(p?a.displayDate:a.publishDate," ' ('MM/dd/yyyy')' ");if(_.has(a,"intelCategories")){var l="",q="",r="";_.each(a.intelCategories,function(a){q+="<span class='badge intel-badge'><a ng-click='go(\""+a.name+'", '+a.id+")'>"+a.name+"</a></span> "}),_.each(a.types,function(a){r+="<span class='badge intel-badge type-badge'>"+a.name+"</span> "}),p&&a.descLastUpdateDate&&(l+='<span class="no-wrap-word">&nbsp<i>(Original Publish Date: '+e("date")(a.publishDate,"M/d/yyyy")+")</i></span>",a.updateScoopText&&(l+="<span ><br/><strong>Update from Organization: </strong>"+(a.updateScoopText?a.updateScoopText:"")+"</span>")),a.article+=l}var s='<tr class="row scoop-item">';if(0==n&&(s='<tr class="row scoop-item first-scoop">'),j+=s,j+='<td class="scoop-content col-md-8 col-xs-12">',j+="<span>"+i+"</span>",j+="<span>"+a.article,a.link&&a.title&&(j+=p?' (<a href="'+h(a.link)+'" target="_blank">'+a.title+"</a>)":' (<a href="'+a.link+'" target="_blank">'+a.title+"</a>)"),j+="</span>",j+="</td>",j+='<td class="scoop-topics col-md-4 col-xs-12">',j+=r,j+=q,j+="</td>",j+="</tr>\n",n+=1,m===n){""!==j&&(j='<table class="company-scoops">'+j+"</table>");var t=angular.element(j);b(t)(c),d.append(t)}})})};return{link:i,restrict:"AE",scope:h}}a.$inject=["$state","$compile","$parse","favicon","$filter","featureFlagService","intelArticleParserService"],angular.module("dorgEuiApp").directive("scoop",a)}(),angular.module("dorgEuiApp").controller("suppressDirectiveController",["$scope","suppressDirectiveService","Flash","$rootScope","singleModalService",function(a,b,c,d,e){var f=null,g=function(b){return f=a.lType()||"page",_.has(b,"api")?b.api.selection.getSelectedRows():b};this.interact=function(){if(a.suppressIgnore)return!1;var h=e.open({controller:["$scope","$uibModalInstance","entity","resourceType","s","suppressedFollowLists","$$scope","$ga","$state",function(a,b,e,h,i,j,k,l,m){e=g(e),l.track("Directive","Suppression","Location Type: "+f+", Location Src: "+m.current.name),_.isArray(e)||(e=new Array(e));var n={};_.isUndefined(k.followListId)||(n.followListId=k.followListId),_.isEmpty(k.listMethod)||(n.listMethod=k.listMethod.replace(/\$/,"")),_.isUndefined(k.savedSearchId)||(n.savedSearchId=k.savedSearchId),_.isUndefined(k.searchCriteria)||(n.searchCriteria=k.searchCriteria),a.allAction=!1,_.size(n)>0&&(e[0]._links={suppress:{href:_.startsWith(h,"person")?d.Session.navigation.$href("bulkSuppressPersons"):d.Session.navigation.$href("bulkSuppressCompanies")}},a.allAction=!0);var o=_.has(e[0],"name")?_.pluck(e,"name"):_.pluck(e,"fullName"),p=e[0].suppressedByUser;a.fullName=_.isUndefined(o[0])?["All Available Records"]:o,a.displayNotes=p,a.notes="",a.deleteFollowLists=j,a.suppressed=p?"unblock":"block",a.title=p?"Unblock":"Block",a.confirm=function(){i.$go(e,a.notes,f,h,n).then(function(){c.create("success",(o.length>1?"Items":"<em>"+o.toString()+"</em>")+" Successfully "+a.suppressed+"ed","flash")}),b.close()},a.close=function(){b.dismiss("cancel")}}],resolve:{entity:function(){return a.entity},resourceType:function(){return a.resourceType},suppressedFollowLists:function(){var c=g(a.entity);_.isArray(c)||(c=new Array(c));var d=[],e=c[0];return e.suppressedByUser||_.isUndefined(e.allAction)||!e.allAction?d=e.suppressedByUser?[]:b.suppressedFollowLists(c,a.resourceType):d.push({displayName:"All Followed Lists"}),d},s:function(){return b},$$scope:function(){return a}},templateUrl:"app/directives/suppress-directive/suppress-directive-partials/modal.base.partial.html"});return h}}]),angular.module("dorgEuiApp").directive("suppress",[function(){var a=function(a,b,c,d){_.isUndefined(a.entity)||(a.entity.suppressedByCustomer?b[0].outerHTML="":b.bind("click",d.interact))},b={entity:"=suppress",suppressIgnore:"=suppressIgnore",lType:"&suppressLoc",resourceType:"=suppressType",followListId:"=suppressFollowListId",listMethod:"=listMethod",savedSearchId:"=suppressSavedId",searchCriteria:"=suppressCriteria"};return{controller:"suppressDirectiveController",link:a,restrict:"A",scope:b}}]),angular.module("dorgEuiApp").service("suppressDirectiveService",["$http","$embeddedUtils","$rootScope","$ga",function(a,b,c,d){this.$go=function(e,f,g,h,i){c.$broadcast("event:submitSuppression",""),f=f.length>0?f:"";var j=_.startsWith(h,"compan")?"companies":"persons",k="api/rest/"+j+"/suppress",l=e[0].suppressedByUser?"DELETE":"POST",m=_.pluck(e,"id"),n={data:{entityIds:m},headers:{"Content-Type":"application/json"},method:l,url:k};return e[0].suppressedByUser||(n.data.notes=f),_.isEmpty(i)||(n.data=_.merge(n.data,i),n.data.entityIds=[]),d.track("Directive","Suppression","POST"===l?"Suppressed":"Unsuppressed"),a(n).then(function(a){var d=_.filter(b.$getD(a.data),function(a){return _.contains(m,a.id)});return c.$broadcast("event:suppression",{lType:g,resourceType:h,ids:m,call:"suppression",data:d}),a.data})},this.suppressedFollowLists=function(c){var e=_.has(c[0],"_links.followLists")?b.$fetchLink(c[0],"followLists"):null;if(!_.isNull(e))return d.track("Directive","Suppression","Removed From List(s)"),a.post(e,_.pluck(c,"id").join(",")).then(function(a){return b.$getE(a.data)})}}]),function(){"use strict";function a(){return{link:function(a,b){$(b).find(".ui-select-search").on("keydown",function(a){9===a.keyCode&&$(b).find(".ui-select-choices").is(":visible")&&setTimeout(function(){$(b).find(".ui-select-search").select()},50)})}}}angular.module("dorgEuiApp").directive("tabEqualsEnter",a)}(),angular.module("dorgEuiApp").config(["$provide",function(a){a.decorator("uiGridRowDirective",["$delegate",function(a){var b=function(a,b,c,d){function e(){if(!h.length){var b=[];angular.forEach(f.grid.renderContainers,function(c){c.name!==g.containerId&&b.push(".ui-grid-render-container-"+c.name+" .ui-grid-row:nth-of-type("+(a.rowRenderIndex+1)+")")}),h=_.map(f.grid.element[0].querySelectorAll(b.join(", ")),function(a){return angular.element(a)})}return h}var f=d[0],g=d[1];if(!(_.keys(f.grid.renderContainers).length<=1)){var h=[];b.on("mouseenter",function(){angular.forEach(e(),function(a){a.addClass("hovered")})}),b.on("mouseleave",function(){angular.forEach(e(),function(a){a.removeClass("hovered")})})}};return angular.forEach(a,function(a){var c=a.compile;a.compile=function(){return angular.extend(c.apply(this,arguments),{post:b})}}),a}])}]),angular.module("dorgEuiApp").controller("twitterDirectiveController",["$scope","$uibModal","twitterService",function(a,b,c){this.interact=function(){b.open({controller:["$scope","$uibModalInstance","feed",function(a,b,d){a.message=d.message,a.processing=!0,a.spinner=!0,a.closeDisabled=!0,a.handle=d.handle,c.$get(a.handle).then(function(b){var c={profile:b.profile,tweets:[]};if(a.closeDisabled=!1,a.twitterHandle=b.profile?'(<a href="'+b.profile.profileUrl+'" target="_blank">'+b.profile.screenName+"</a>)":"",c.profile=b.profile,"SUCCESS"===b.status)_.each(b.tweets,function(a){var b=angular.copy(a),d=/(\b(https?|ftp|file):\/\/([-A-Z0-9+&@#%?=~_|!:,.;]*)([-A-Z0-9+&@#%?\/=~_|!:,.;]*)[-A-Z0-9+&@#\/%=~_|])/gi;b.retweet&&(b.text="RT @"+b.originalHandler+": "+b.unmodifiedText),b.text=b.text.replace(d,'<a href="$1" target="_blank">$1</a>'),b.text=b.text.replace(/(^|\W+)\@([\w\-]+)/gm,'$1<span class="atAt">@</span><a href="//twitter.com/$2" target="_blank">$2</a>'),b.text=b.text.replace(/[#]+[A-Za-z0-9-_]+/g,function(a){return a.link("//twitter.com/search?q="+a.replace("#","%23"))}),b.profileImage='<img src="'+b.profileImageUrl+'"></img>',c.tweets.push(b)}),a.processing=!1;else{var d="";switch(b.status){case"NO_TWEETS":d="This user does not have any tweets currently.";break;case"NO_HANDLE":case"DELETED":d="There was an issue retrieving this user's Twitter account. A research request has been submitted to look into the issue.";break;case"PROTECTED":d="This user does not wish for their tweets to be public.",b.profile&&(d+=" \n <br /> To view this person's tweets, you can follow them here: <a href=\""+b.profile.profileUrl+'" target="_blank"> '+b.profile.screenName+"</a>");break;case"ERROR":d="An error has occurred and a research request submitted to look into the issue."}a.message=d}a.spinner=!1,a.feed=c}),a.close=function(){b.dismiss("cancel")}}],resolve:{feed:function(){return{message:"Waiting...",handle:a.handle}}},size:"",templateUrl:"app/directives/twitter-directive/twitter-directive-partials/modal.base.partial.html"})}}]),angular.module("dorgEuiApp").directive("twitter",[function(){var a=function(a,b,c,d){_.isEmpty(a.handle.twitterHandle)?b[0].outerHTML="":b.bind("click",d.interact)},b={handle:"=twitter"
},c='<i class="fa fa-twitter-square fa-lg mousePointer"></i>';return{controller:"twitterDirectiveController",link:a,restrict:"A",replace:!0,scope:b,template:c}}]).directive("twitterGrid",[function(){var a=function(a,b,c,d){a.handle.twitterHandle.length>0?b.bind("click",d.interact):b[0].outerHTML=""},b={handle:"=twitterGrid"};return{controller:"twitterDirectiveController",link:a,restrict:"AE",scope:b}}]),angular.module("dorgEuiApp").service("twitterService",["$rootScope","halClient","$embeddedUtils","$ga","$state",function(a,b,c,d,e){this.$get=function(a){var f=c.$fetchLink(a,"twitterFeed");return d.track("Directive","Twitter","Location Src: "+e.current.name),b.$get(f).then(function(a){return a},function(a){return a})}}]),function(){"use strict";function a(a,b){return{link:function(c,d,e){function f(){var a=$(d);a.width()<85?(a.find(".ui-grid-lock-box-locked-text").hide(),a.find(".ui-grid-lock-box-content-text").hide()):a.width()<120?(a.find(".ui-grid-lock-box-locked-text").show(),a.find(".ui-grid-lock-box-content-text").hide()):(a.find(".ui-grid-lock-box-locked-text").show(),a.find(".ui-grid-lock-box-content-text").show())}var g,h,i=_.debounce(f,300),j=a(e.uiGridLockBox)(c),k=!1;j&&j.privacyEuRequested?(g="app/views/person/privacy-requested.modal.html",k=!0,h="vm"):(g="app/views/person/unlock.modal.html",h="personUnlockVm"),$(d).on("click",function(){b.open({controller:["$rootScope","$scope","$uibModalInstance","entity",function(a,b,c,d){function e(){c.close(!1)}var f=this;f.close=e,k||(f.subjectLine=encodeURIComponent("Access Request From "+a.Session.account.firstName+" "+a.Session.account.lastName+": "),f.bodyLine=encodeURIComponent("I am interested in more information on how to gain access to the data set which includes "),d.title?(f.subjectLine+=encodeURIComponent(d.fullName+" at "+d.company.name),f.bodyLine+=encodeURIComponent(d.fullName+" at "+d.company.name+".")):(f.subjectLine+=encodeURIComponent(d.name),f.bodyLine+=encodeURIComponent(d.name+".")))}],controllerAs:h,resolve:{entity:function(){return j}},size:"md",templateUrl:g,windowClass:"lock-modal"})}),$(window).resize(i),c.$on("renderUiGridLockBoxes",f),f(),setTimeout(f,2e3)},restrict:"A"}}angular.module("dorgEuiApp").directive("uiGridLockBox",a),a.$inject=["$parse","$uibModal"]}(),function(){"use strict";angular.module("dorgEuiApp").directive("unescapeHtml",[function(){var a=function(a,b,c,d){d.$formatters.unshift(function(a){return null!=a&&a?_.unescape(a):""})};return{link:a,restrict:"A",require:"ngModel"}}])}(),angular.module("dorgEuiApp").service("$$uploadFnCallbacks",["$$uploadStatic",function(a){var b=this,c={},d=function(a){return"app/directives/upload-import-directive/upload-import-partials/"+a+".inject.html"};this.init=function(){c={_links:[],continue:!0,fieldsSelected:[],options:[],optionsMore:[],optionSelected:[],accountOptionsShown:{},tpl:null}},this.errorHandler=function(c,e){var f=a.errors[c]?b[a.errors[c]](d(a.errors[c]),e):void 0;return _.isUndefined(f)?a.errors.FAILED:f},this.foundHandler=function(c,e){return a.matches[c]?b[a.matches[c]](d(a.matches[c]),e):void 0},this.matchingRecord=function(a,b){return"contact"===b.matchType&&_.endsWith(b._links.getFromCrm.href,"LEAD")?(_.each(b._links,function(a,c){b._links[c].href=b._links[c].href.replace("LEAD","CONTACT")}),c.foundOtherRecordType=!0):"lead"===b.matchType&&_.endsWith(b._links.getFromCrm.href,"CONTACT")?(_.each(b._links,function(a,c){b._links[c].href=b._links[c].href.replace("CONTACT","LEAD")}),c.foundOtherRecordType=!0):c.foundOtherRecordType=!1,c.tpl=a,c._links=b._links,c.matchType=b.matchType.charAt(0).toUpperCase()+b.matchType.slice(1),c.options=[],c.optionsMore=[],c.optionSelected=[],c.fieldsSelected=[],_.each(b.recordsList,function(a,d){c.options.push({_a:a,_r:b.recordIdsList[d]})}),c},this.noEditMatchingRecord=function(){return"noEditMatchingRecord"},this.fillOnUpdateDoesNotSelected=function(){return"fillOnUpdateDoesNotSelected"},this.matchingCrmAcct=function(a,c){return b.noMatchingCrmAcct(d("noMatchingCrmAcct"),c)},this.noMatchingCrmAcct=function(a,b){return c=_.clone(c),c.visible=0,c.tpl=a,c._links=b._links,c.options=[],c.optionsMore=[],c.optionSelected=[],c.fieldsSelected=[],c.personId=b.personId,b.accountIdsList?c.foundMatchingCompany=!0:c.foundMatchingCompany=!1,_.each(b.accountsList,function(a,d){c.options.push({_a:a,_b:_.has(b,"creatorName")&&null!=b.creatorName?b.creatorName[d]:null,_c:_.has(b,"createAt")&&null!=b.createAt?b.createAt[d]:null,_K:_.has(b,"accountIdsList")&&null!=b.accountIdsList?b.accountIdsList[d]:d}),c.accountOptionsShown[a]||(c.accountOptionsShown[a]=1,c.visible=1)}),c},this.missingCreds=function(a,b){return c.tpl=a,c._links="",c.options=[],c.optionsMore=[],c.optionSelected=[],c.fieldsSelected=[],c.isExit=!0,c},this.sqlError=function(){return"sqlError"},this.credFail=function(){return"credFail"},this.privError=function(){return"privError"},this.noApiAccessError=function(a,b){return c.tpl=a,c.msg=b.responseCode,c.isExit=!0,c},this.apiError=function(a,b){return c.tpl=a,c._links="",c.options=[],c.optionsMore=[],c.optionSelected=[],c.fieldsSelected=[],c.isExit=!0,c.msg=b.responseDetails,b.responseDetails&&b.companyName&&b.personName&&(c.msg=b.personName+", "+b.companyName+": "+b.responseDetails),c},this.unknownResp=function(){return"unknownResp"},this.notAvailableInCrm=function(){return"notAvailableInCrm"},this.singleRequestOnly=function(){return"singleRequestOnly"},this.skippedExistingRecord=function(){return"skippedExistingRecord"},this.uploadFailed=function(){return"uploadFailed"}}]),angular.module("dorgEuiApp").factory("$$uploadStatic",[function(){var a={};return a.supportedCrmTypes={ZOHO:"ZOHO",SUGAR:"SUGAR",NETSUITE:"NETSUITE",ELOQUA:"ELOQUA"},a.errors={ERROR_MISSING_CRM_CREDENTIALS:"missingCreds",ERROR_SQL_ERROR:"sqlError",ERROR_CRM_CREDENTIALS_FAILED:"credFail",ERROR_CRM_PRIVILEGES_ERROR:"privError",ERROR_CRM_API_HANDLER_ERROR:"apiError",ERROR_NO_API_ACCESS:"noApiAccessError",ERROR_UNKNOWN_RESPONSE:"unknownResp",ERROR_OBJECT_TYPE_UNAVAILABLE_IN_CRM:"notAvailableInCrm",ERROR_SIMULTANEOUS_API_CALLS_NOT_ALLOWED:"singleRequestsOnly",ERROR_FILL_ON_UPDATE_DOES_NOT_SELECTED:"fillOnUpdateDoesNotSelected",FAILED:"uploadFailed"},a.success={SUCCESS:""},a.matches={FOUND_MATCHING_CRM_RECORD:"matchingRecord",FOUND_NONEDITABLE_MATCHING_CRM_RECORD:"noEditMatchingRecord",FOUND_MATCHING_CRM_ACCOUNT:"matchingCrmAcct",NO_MATCHING_CRM_ACCOUNT:"noMatchingCrmAcct",SKIPPED_EXISTING_CRM_RECORD:"skippedExistingRecord"},a}]),function(){"use strict";angular.module("dorgEuiApp").service("crmBulkUploadErrorService",["$uibModal","Flash",function(a,b){this.openModal=function(b){a.open({animation:!0,controller:["$rootScope","$scope","$uibModalInstance",function(a,c,d){c.errors=b,c.close=function(){d.dismiss("cancel")}}],size:"lg",templateUrl:"app/directives/upload-import-directive/upload-import-partials/crm.bulk.upload.errors.html"})}}])}(),function(){"use strict";angular.module("dorgEuiApp").service("noMatchingAccountPopupService",["$uibModal","Flash","uploadImportService","$timeout",function(a,b,c,d){this.openModal=function(e,f,g,h,i,j){a.open({animation:!0,controller:["$rootScope","$scope","$uibModalInstance",function(a,k,l){function m(){k.accountSearching[0]=!0,c.findAccounts(f,k.referenceAccounts[0].companyName).then(function(a){null!=k.accountSearchItems[0]&&k.accountSearchItems[0]instanceof Array?(k.accountSearchItems[0]=_.union(k.accountSearchItems[0],a),k.accountSearchItems[0]=_.uniq(k.accountSearchItems[0],"id")):k.accountSearchItems[0]=a,k.accountSearching[0]=!1,k.accountSearching.indexOf(!0)<0&&(k.doneLookingUpAccounts=!0)},function(a){k.accountSearching[0]=!1,l.close(),b.create("danger","Search existing account failed","fail")})}k.canUploadCompany=c.canUploadCompany,k.doneLookingUpAccounts=!1,k.referenceAccounts=e,k.isBulk=!0;var n=c.getURLParameter(f,"supportedCrmType"),o=c.getURLParameter(i,"crmRecordType");k.crmType=c.crmType,k.isCompanyUpload="ACCOUNT"===o,k.allowContactWithoutAccount=c.allowContactWithoutAccount,k.companyLabel="NETSUITE"===n?"Company":"Account",k.companiesLabel="NETSUITE"===n?"Companies":"Accounts",k.accountSearchItems=[],k.accountSearching=[],m(),k.upload=function(){if(!k.isUploadDisabled()){var a=[],d={};_.size(k.referenceAccounts)>0&&_.forEach(k.referenceAccounts,function(b){"NEW_ACCOUNT"===b.selectedId?a.push(b.companyId):d[b.companyId]=b.selectedId}),c.upload(i,null,null,null,null,!0,g,h,a,d,!0,null,j.data.result.successPersonIds).then(function(a){l.close(),_.has(a,"asyncJob")&&b.create("flash","Your Upload is being Started.","flash")},function(a){l.close(),b.create("danger","Create job name failed","fail")})}},k.close=function(){j.isBulk&&c.uploadPlantPersonsIfNeeded(j),l.dismiss("cancel"),d(function(){a.$broadcast("event:crmUpload",{lType:"page",data:h,call:"crmUpload"})},1e3)},k.isUploadDisabled=function(){var a=!1;return _.size(k.referenceAccounts)>0&&_.forEach(k.referenceAccounts,function(b){if(_.isUndefined(b.selectedId)||_.isNull(b.selectedId))return a=!0,!1}),a},k.lookUpAccounts=function(a,d){k.accountSearching[d]=!0,c.findAccounts(f,a).then(function(a){null!=k.accountSearchItems[d]&&k.accountSearchItems[d]instanceof Array?(k.accountSearchItems[d]=_.union(k.accountSearchItems[d],a),k.accountSearchItems[d]=_.uniq(k.accountSearchItems[d],"id")):k.accountSearchItems[d]=a,k.accountSearching[d]=!1,k.accountSearching.indexOf(!0)<0&&(k.doneLookingUpAccounts=!0)},function(a){k.accountSearching[d]=!1,l.close(),b.create("danger","Search existing account failed","fail")})},k.toggleNewAccountForAll=function(a){_.each(k.referenceAccounts,function(b){a?b.selectedId="NEW_ACCOUNT":b.selectedId=null})};var p=!1;_.forEach(k.referenceAccounts,function(a,b){if("FOUND_MATCHING_CRM_ACCOUNT"===a.responseCode)if(a.hasOwnProperty("companyName")&&a.hasOwnProperty("accountId")&&a.companyName&&a.accountId){var c={companyLabel:a.companyName,id:a.accountId};k.accountSearchItems[b]=[c]}else p=!0,k.lookUpAccounts(a.companyName,b)}),p||(k.doneLookingUpAccounts=!0)}],size:"lg",templateUrl:"app/directives/upload-import-directive/upload-import-partials/no.matching.account.popup.modal.html"})}}])}(),angular.module("dorgEuiApp").controller("uploadImportController",["$embeddedUtils","$ga","$q","$rootScope","$scope","$state","$timeout","Flash","uploadImportService","userSettingsService","$$uploadStatic","singleModalService","$userSettingsStatic",function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=function(a){return _.has(a,"api")&&null!==a.api?a.api.selection.getSelectedRows():a},o=function(b,c){var f,g,h=[],i=d.Session.navigation,j=b.length>0&&(!_.isNull(a.$fetchLink(b[0],"uploadCompany"))||!_.isNull(a.$fetchLink(b[0],"uploadCompanyToSDR")));return b.length>1||e.searchCriteria?(j?i.$has("bulkUploadCompany")&&h.push({crmType:"CRM",type:"bulkUploadCompany",href:i.$href("bulkUploadCompany"),name:"Company"}):(i.$has("bulkUploadContact")&&h.push({crmType:"CRM",type:"bulkUploadContact",href:i.$href("bulkUploadContact"),name:"Contact"}),i.$has("bulkUploadLead")&&h.push({crmType:"CRM",type:"bulkUploadLead",href:i.$href("bulkUploadLead"),name:"Lead"})),"companies"===c?i.$has("bulkUploadCompanyToMAT")&&h.push({crmType:"MAT",type:"bulkUploadCompanyToMAT",href:i.$href("bulkUploadCompanyToMAT"),name:"Company"}):j||(i.$has("bulkUploadContactToMAT")&&h.push({crmType:"MAT",type:"bulkUploadContactToMAT",href:i.$href("bulkUploadContactToMAT"),name:"Contact"}),i.$has("bulkUploadLeadToMAT")&&h.push({crmType:"MAT",type:"bulkUploadLeadToMAT",href:i.$href("bulkUploadLeadToMAT"),name:"Bulk Lead"})),j?i.$has("bulkUploadCompanyToSDR")&&h.push({crmType:"SDR",type:"bulkUploadCompanyToSDR",href:i.$href("bulkUploadCompanyToSDR"),name:"Company"}):(i.$has("bulkUploadLeadToSDR")&&!j&&h.push({crmType:"SDR",type:"bulkUploadLeadToSDR",href:i.$href("bulkUploadLeadToSDR"),name:"Bulk Lead"}),i.$has("bulkUploadContactToSDR")&&!j&&h.push({crmType:"SDR",type:"bulkUploadContactToSDR",href:i.$href("bulkUploadContactToSDR"),name:"Bulk Contact"}))):(f=b[0],g=_.has(f,"_links")&&null!==f._links?f._links:[]),_.size(g)<1?(_.isNull(a.$fetchLink(f,"uploadCompany"))||h.push({crmType:"CRM",type:"uploadCompany",href:a.$fetchLink(f,"uploadCompany"),name:"Company"}),_.isNull(a.$fetchLink(f,"uploadLead"))||h.push({crmType:"CRM",type:"uploadLead",href:a.$fetchLink(f,"uploadLead"),name:"Lead"}),_.isNull(a.$fetchLink(f,"uploadContact"))||h.push({crmType:"CRM",type:"uploadContact",href:a.$fetchLink(f,"uploadContact"),name:"Contact"}),_.isNull(a.$fetchLink(f,"uploadCompanyToMAT"))||h.push({crmType:"MAT",type:"uploadCompanyToMAT",href:a.$fetchLink(f,"uploadCompanyToMAT"),name:"Company"}),_.isNull(a.$fetchLink(f,"uploadContactToMAT"))||h.push({crmType:"MAT",type:"uploadContactToMAT",href:a.$fetchLink(f,"uploadContactToMAT"),name:"Contact"}),_.isNull(a.$fetchLink(f,"uploadLeadToMAT"))||h.push({crmType:"MAT",type:"uploadLeadToMAT",href:a.$fetchLink(f,"uploadLeadToMAT"),name:"Lead"}),_.isNull(a.$fetchLink(f,"uploadCompanyToSDR"))||h.push({crmType:"SDR",type:"uploadCompanyToSDR",href:a.$fetchLink(f,"uploadCompanyToSDR"),name:"Company"}),_.isNull(a.$fetchLink(f,"uploadLeadToSDR"))||h.push({crmType:"SDR",type:"uploadLeadToSDR",href:a.$fetchLink(f,"uploadLeadToSDR"),name:"Lead"}),_.isNull(a.$fetchLink(f,"uploadContactToSDR"))||h.push({crmType:"SDR",type:"uploadContactToSDR",href:a.$fetchLink(f,"uploadContactToSDR"),name:"Contact"})):b.length<2&&_.each(g,function(a,b){if(_.startsWith(b,"upload")||_.startsWith(b,"bulk")){var c="CRM";_.endsWith(b,"ToMAT")?c="MAT":_.endsWith(b,"ToSDR")&&(c="SDR"),h.push({crmType:c,type:b,href:a.href,name:_.endsWith(b,"Lead")?"Lead":"Contact"})}}),h};this.openModal=function(){if(e.uploadImportIgnore)return!1;var a=l.open({controller:["$scope","$uibModalInstance","links","selected","searchCriteria","followListId","listMethod","totalUpload","uploadAll",function(a,e,g,l,m,n,o,p,q){b.track("Directive","CRM/MAT/SDR","Location Src: "+f.current.name),a.isBulk=!1,a.directUpload=!1,a.crmLinks=[],a.matLinks=[],a.sdrLinks=[],a.historyLookup=[],a.totalUpload=p,_.each(g,function(b){var c="";"CRM"===b.crmType?c="crmLinks":"MAT"===b.crmType?c="matLinks":"SDR"===b.crmType&&(c="sdrLinks"),""!==c&&a[c].push(b)}),a.hasMultipleCrmTypes=(a.crmLinks.length>0?1:0)+(a.matLinks.length>0?1:0)+(a.sdrLinks.length>0?1:0)>1,a.links=[],a.crmLinks.length>0?(a.crmType="CRM",a.links=a.crmLinks):a.matLinks.length>0?(a.crmType="MAT",a.links=a.matLinks):(a.crmType="SDR",a.links=a.sdrLinks),a.isCompany=a.links.length>0&&_.include(a.links[0].type,"ploadCompany"),a.type=a.isCompany?l.length>1?"these Companies":"this Company":l.length>1?"these Persons":"this Person",a.$$textLookup="",a.isDupe=!1,a.isUploaded=!1,a.isCompany||1!==l.length||d.Session.$canUploadEmaillessPersons!==!1||l[0].hasOwnProperty("email")&&l[0].email?"SDR"===a.crmType?a.error=!(a.links.length>0)&&"Upload failed. Please check your configuration and try again. If this issue persists, contact your administrator or Customer Support.":a.error=!(a.links.length>0)&&"Permission denied.":a.error="Current MAT/SDR configuration does not allow uploads without Email Addresses.",a.size=_.size(a.links),a.selected=l,a.getPardotCampaigns=function(){i.getPardotCampaigns().then(function(b){if(a.pardotCampaigns=b,a.pardotCampaigns.length>0){var c={id:"0",name:"New Campaign"};a.pardotCampaigns.unshift(c),a.showPardotCampaigns=!0,a.showPardotLists&&(a.isLoadingPardotInfo=!1)}})},a.getPardotLists=function(){i.getPardotLists().then(function(b){if(a.pardotLists=b,a.pardotLists.length>0){var c={id:"0",name:"New List"};a.pardotLists.unshift(c),a.showPardotLists=!0,a.showPardotCampaigns&&(a.isLoadingPardotInfo=!1)}})},a.getPipedrivePipelineStages=function(){i.getPipedrivePipelineStages().then(function(b){a.pipedrivePipelineStages=b,a.pipedrivePipelineStages.length>0&&(a.pipedrivePipelineStage=a.pipedrivePipelineStages[0],a.showPipedrivePipelineStages=!0,a.isLoadingPipedriveInfo=!1)})},a.getPipedriveDealParams=function(){var b="";return a.createPipedriveDeal&&(b+="&createDeal=1"),a.pipedriveDealTitle&&(b+="&dealTitle="+encodeURIComponent(a.pipedriveDealTitle)),a.pipedriveDealValue&&(b+="&dealValue="+encodeURIComponent(a.pipedriveDealValue)),a.pipedrivePipelineStage&&(b+="&dealPipelineStage="+a.pipedrivePipelineStage.id),b},a.getSalesloftCadences=function(){i.getSalesloftCadences().then(function(b){null!=b&&b?(a.salesloftCadences=b,a.showSalesloftCadences=!0,a.isLoadingSalesloftInfo=!1):j.getCrmCreds({supportedCrmType:"SALESLOFT"}).then(function(b){j.postCrmCreds(b,{supportedCrmType:"SALESLOFT"}).then(function(b){b||(a.isLoadingSalesloftInfo=!1,e.close({data:l,crmType:a.crmType,state:"ERROR",errorDetail:"credFail"}))})})})},a.getOutreachSequences=function(){i.getOutreachSequences().then(function(b){null!=b&&b&&b.hasOwnProperty("sequences")?(a.outreachSequences=b.sequences,a.outreachSequenceOwners=b.users,a.showOutreachSequences=!0,a.isLoadingOutreachInfo=!1):j.getCrmCreds({supportedCrmType:"OUTREACH"}).then(function(b){j.postCrmCreds(b,{supportedCrmType:"OUTREACH"}).then(function(b){b||(a.isLoadingOutreachInfo=!1,e.close({data:l,crmType:a.crmType,state:"ERROR",errorDetail:"credFail"}))})})})},a.changeCRMType=function(b){a.isSalesloft=!1,a.isOutreach=!1,a.isHubspotCrm=!1,a.canUploadCompany=!1,a.isEloqua=!1,a.isSugarCrm=!1,i.canUploadCompany=!1,i.crmType=b,a.companyLabel="Account","MAT"===b?(a.linksSelected=a.matLinks.length>0?a.matLinks[0].href:"",a.uploadLabel="Continue",a.closeLabel="Cancel","HUBSPOT"===i.getURLParameter(a.matLinks[0].href,"supportedCrmType")&&(a.companyLabel="Company"),"PARDOT"===i.getURLParameter(a.matLinks[0].href,"supportedCrmType")&&"LEAD"===i.getURLParameter(a.matLinks[0].href,"crmRecordType")?(a.isLoadingPardotInfo=!0,a.getPardotCampaigns(),a.getPardotLists()):(a.showPardotCampaigns=!1,a.showPardotLists=!1),"MARKETO"===i.getURLParameter(a.matLinks[0].href,"supportedCrmType")&&"LEAD"===i.getURLParameter(a.matLinks[0].href,"crmRecordType")?(a.showMarketoLeadSource=!0,a.marketoLeadSource="DiscoverOrg"):(a.showMarketoLeadSource=!1,a.marketoLeadSource=""),a.matLinks.length>0&&i.getURLParameter(a.matLinks[0].href,"supportedCrmType")===k.supportedCrmTypes.ELOQUA&&"CONTACT"===i.getURLParameter(a.matLinks[0].href,"crmRecordType")&&(a.isEloqua=!0,a.supportedCrmType=k.supportedCrmTypes.ELOQUA)):"SDR"===b?(a.linksSelected=a.sdrLinks.length>0?a.sdrLinks[0].href:"",a.uploadLabel="Continue",a.closeLabel="Cancel",a.sdrLinks.length>0&&"SALESLOFT"===i.getURLParameter(a.sdrLinks[0].href,"supportedCrmType")&&"LEAD"===i.getURLParameter(a.sdrLinks[0].href,"crmRecordType")?(a.isSalesloft=!0,a.isLoadingSalesloftInfo=!0,a.getSalesloftCadences()):a.showSalesloftCadences=!1,a.sdrLinks.length>0&&"OUTREACH"===i.getURLParameter(a.sdrLinks[0].href,"supportedCrmType")?(a.isOutreach=!0,j.getAllowOutreachAccountCreation().then(function(b){b&&"1"===b&&(a.canUploadCompany=!0,i.canUploadCompany=!0)}),"CONTACT"===i.getURLParameter(a.sdrLinks[0].href,"crmRecordType")&&(a.isLoadingOutreachInfo=!0,a.getOutreachSequences())):a.showOutreachSequences=!1):(a.showPardotCampaigns=!1,a.showPardotLists=!1,a.showSalesloftCadences=!1,a.showOutreachSequences=!1,a.showPipedriveDeal=!1,a.isUploadContactToMAT=!1,a.linksSelected=a.crmLinks.length>0?a.crmLinks[0].href:"",a.uploadLabel="Upload",a.closeLabel="Close",a.crmLinks.length>0&&(a.supportedCrmType=i.getURLParameter(a.crmLinks[0].href,"supportedCrmType"),a.crmRecordType=i.getURLParameter(a.crmLinks[0].href,"crmRecordType"),a.supportedCrmType&&"HUBSPOTCRM"===a.supportedCrmType&&(a.companyLabel="Company",a.isHubspotCrm=!0),a.supportedCrmType&&"PIPEDRIVE"===a.supportedCrmType&&(a.companyLabel="Organization",a.crmRecordType&&"CONTACT"===a.crmRecordType&&(a.showPipedriveDeal=!0,a.isLoadingPipedriveInfo=!0,a.getPipedrivePipelineStages(),a.pipedriveDealTitle=a.selected[0].company.name+" deal")),a.supportedCrmType&&"SUGAR"===a.supportedCrmType&&a.crmRecordType&&"CONTACT"===a.crmRecordType&&(a.isSugarCrm=!0)))},a.changeCRMType(a.crmType),"MAT"===a.crmType&&a.matLinks.length>0&&(a.supportedCrmType=i.getURLParameter(a.matLinks[0].href,"supportedCrmType"),a.isEloqua=a.supportedCrmType===k.supportedCrmTypes.ELOQUA,a.isUploadCompanyToMAT=1===l.length&&"uploadCompanyToMAT"===a.matLinks[0].type,a.isUploadContactToMAT=1===l.length&&"uploadContactToMAT"===a.matLinks[0].type,a.isUploadLeadToMAT=1===l.length&&"uploadLeadToMAT"===a.matLinks[0].type,a.isBulkUploadContactToMAT=l.length>1&&"bulkUploadContactToMAT"===a.matLinks[0].type||q&&p>1&&"bulkUploadContactToMAT"===a.matLinks[0].type,a.isBulkUploadLeadToMAT=l.length>1&&"bulkUploadLeadToMAT"===a.matLinks[0].type),a.dupe=[{title:"No",value:!1},{title:"Yes",value:!0}],a.dupeAllow=a.dupe[0].value,a.crm={continue:null},a.doUpload=function(){a.isUploading||a.needsSelection||(a.confirm(),a.confirmNGo())},a.confirm=function(){if(null===a.crm.continue){var b=_.isUndefined(this)||_.isUndefined(this.linksSelected)?a.linksSelected:this.linksSelected;a.isUploading=!0,a.isExit=!1,a.pardotCampaign>0?b+="&campaignId="+a.pardotCampaign:a.newPardotCampaignName&&(b+="&newCampaignName="+a.newPardotCampaignName),a.pardotList>0?b+="&listId="+a.pardotList:a.newPardotListName&&(b+="&newListName="+a.newPardotListName),a.marketoLeadSource&&(b+="&leadSource="+encodeURIComponent(a.marketoLeadSource)),a.marketoEmailConfirmation&&(b+="&emailWhenDone=1"),a.salesloftCadence>0&&(b+="&cadenceId="+a.salesloftCadence),a.outreachSequence>0&&(b+="&sequenceId="+a.outreachSequence),a.salesloftTags&&(b+="&tags="+encodeURIComponent(a.salesloftTags)),a.outreachTags&&(b+="&tags="+encodeURIComponent(a.outreachTags)),a.createPipedriveDeal&&(b+=a.getPipedriveDealParams()),_.isEmpty(b)||h.create("flash","Upload in Progress...","flash"),i.upload(b,!1,m,l.length>1||q?n:void 0,l.length>1||q?o:void 0,!!q||l.length>1,_.map(l,"id"),l,l).then(function(c){b.toLowerCase().indexOf("netsuite")>=0||b.toLowerCase().indexOf("zoho")>=0||b.toLowerCase().indexOf("hubspot")>=0||b.toLowerCase().indexOf("outreach")>=0||b.toLowerCase().indexOf("oraclesalescloud")>=0?a.allowContactWithoutAccount=1:a.allowContactWithoutAccount=0,i.allowContactWithoutAccount=a.allowContactWithoutAccount,b.toLowerCase().indexOf("hubspot")>=0?a.accountSearchByWebDomain=1:a.accountSearchByWebDomain=0;var d=i.getURLParameter(b,"supportedCrmType");if(null!==d){b.toLowerCase().indexOf("eloqua")>=0?a.canUploadCompany=!0:j.getCustomerCrmSettings({supportedCrmType:d}).then(function(b){"OUTREACH"!==d&&b.allowAccountUpload&&(a.canUploadCompany=!0,i.canUploadCompany=!0),"NETSUITE"===d&&a.crm.options.length>0&&a.crm.foundMatchingCompany&&(a.canUploadCompany=!1,i.canUploadCompany=!1),"OUTREACH"===d&&b.requireAccountForOutreach&&"0"!==b.requireAccountForOutreach&&(a.allowContactWithoutAccount=0,i.allowContactWithoutAccount=a.allowContactWithoutAccount)}),a.companyNames=[],c.bulk&&_.each(c.bulk,function(b){b.options&&b.options[0]&&b.options[0]._a&&a.companyNames.push(b.options[0]._a)}),0==a.companyNames.length&&(!_.isEmpty(l)&&l[0].company&&l[0].company.name?a.companyNames.push(l[0].company.name):!_.isEmpty(l)&&l[0].name?a.companyNames.push(l[0].name):c.options&&c.options[0]&&c.options[0]._a&&a.companyNames.push(c.options[0]._a));var f=c.responseCode&&"PARTIAL_SUCCESS"===c.responseCode?"PARTIAL_SUCCESS":"CURRENT";if("skippedExistingRecord"===c)e.close({data:l,crmType:a.crmType,state:"CURRENT",linksSelected:a.linksSelected,skippedExisting:1,totalUpload:null!=p?p:null});else if("credFail"===c)e.close({data:l,crmType:a.crmType,state:"ERROR",errorDetail:c});else if("fillOnUpdateDoesNotSelected"===c)e.close({data:l,crmType:a.crmType,state:"ERROR",errorDetail:c});else if(c.tooManyBulkUploads)e.close({data:l,crmType:a.crmType,state:"ERROR",tooManyBulkUploads:!0,errorDetail:null});else if("uploadFailed"===c)e.close({data:l,crmType:a.crmType,state:"ERROR",errorDetail:null});else if(c.isExit&&c.msg)e.close({data:l,crmType:a.crmType,state:"ERROR",errorDetail:c.msg});else if(c.continue)if(_.has(c,"bulk")&&null!==c.bulk){a.skippedExistingRecords=0;for(var g=0;g<c.bulk.length;g++)c.bulk[g]&&"skippedExistingRecord"===c.bulk[g]&&a.skippedExistingRecords++;c.bulk=_.filter(c.bulk,"continue"),0===c.bulk.length&&e.close({data:l,crmType:a.crmType,state:f,linksSelected:a.linksSelected,bulkSkippedExisting:a.skippedExistingRecords,total:c.total,countWithoutEmails:c.countWithoutEmails,totalUpload:null!=p?p:null}),a.needsSelection=!0,a.hideModal=!1,a.isUploading=!1,a.directUpload=!1,a.isBulk=!0,a.crm=c}else a.directUpload=!1,a.isExit=c.isExit,a.hideModal=!1,a.needsSelection=!0,a.isUploading=!1,a.crm=c,a.selectedRadio=c.options[0];else e.close({data:l,crmType:a.crmType,state:f,linksSelected:a.linksSelected,asyncJob:c.asyncJob,hasUploadErrors:c.hasUploadErrors,totalUpload:null!=p?p:null})}})}},(a.isOutreach&&a.isCompany||g.length<2&&"PARDOT"!==a.supportedCrmType&&"MARKETO"!==a.supportedCrmType&&!a.isSalesloft&&!a.isOutreach&&("PIPEDRIVE"!==a.supportedCrmType||"CONTACT"!==a.crmRecordType))&&(a.directUpload=!0,a.$eval("confirm")()),a.confirmNGo=function(){if(null!==this.crm.continue)if(a.isUploading=!0,h.create("flash","Upload in Progress...","flash"),a.createPipedriveDeal&&(this.crm._links.upload&&this.crm._links.upload.href&&(this.crm._links.upload.href+=a.getPipedriveDealParams()),this.crm._links.updateFields&&this.crm._links.updateFields.href&&(this.crm._links.updateFields.href+=a.getPipedriveDealParams())),this.crm._links&&(this.crm._links.updateFields&&this.crm._links.updateFields.href&&(a.outreachSequence&&(this.crm._links.updateFields.href+="&sequenceId="+a.outreachSequence),a.outreachTags&&(this.crm._links.updateFields.href+="&tags="+encodeURIComponent(a.outreachTags)),a.salesloftTags&&(this.crm._links.updateFields.href+="&tags="+encodeURIComponent(a.salesloftTags)),a.salesloftCadence&&(this.crm._links.updateFields.href+="&cadenceId="+a.salesloftCadence)),this.crm._links.upload&&this.crm._links.upload.href&&(a.outreachSequence&&(this.crm._links.upload.href+="&sequenceId="+a.outreachSequence),a.salesloftCadence&&(this.crm._links.upload.href+="&cadenceId="+a.salesloftCadence),a.outreachTags&&(this.crm._links.upload.href+="&tags="+encodeURIComponent(a.outreachTags)),a.salesloftTags&&(this.crm._links.upload.href+="&tags="+encodeURIComponent(a.salesloftTags)))),!a.isBulk&&_.has(this.crm,"fieldsSelected")&&null!==this.crm.fieldsSelected&&this.crm.fieldsSelected.length>0)i.$$goodToGo(this.crm).then(function(b){b.responseCode&&b.responseDetails&&"ERROR_CRM_API_HANDLER_ERROR"===b.responseCode?e.close({data:a.selected,crmType:a.crmType,state:"ERROR",errorDetail:b.responseDetails}):b?e.close({data:a.selected,crmType:a.crmType,state:"CURRENT",totalUpload:null!=p?p:null}):console.warn("error")});else if(a.isBulk){var b=[],d=this,f={},g=[];_.each(this.crm.bulk,function(a,b){if(a.options[0]){var c=a.options[0]._a;f[c]||(f[c]=[]),a.optionSelected&&(a.optionSelected._a||a.optionSelected._K)?f[c].unshift(a):f[c].push(a)}g.push(a.personId)});var j=[],m=function(g,h){var m=g[0]._links.upload.href,n=null,o=null;a.outreachSequence&&(m+="&sequenceId="+a.outreachSequence),a.outreachTags&&(m+="&tags="+encodeURIComponent(a.outreachTags));var q="no_account"===g[0].optionSelected._K,r=i.upload(m,!1,null,null,null,!1,[],[]);return j.push(r),b.push(r),r.then(function(h){var m=c.when();h.isExit&&h.msg&&e.close({data:a.selected,crmType:a.crmType,state:"ERROR",errorDetail:h.msg});var r=_.isUndefined(this)||_.isUndefined(this.linksSelected)?a.linksSelected:this.linksSelected;if(g.shift(),g.length>0){var s=_.map(g,"personId");if(s.length>0){q&&(r+="&addContactsWithoutAccount=true"),a.outreachSequence&&(r+="&sequenceId="+a.outreachSequence),a.outreachTags&&(r+="&tags="+encodeURIComponent(a.outreachTags));var t=null;a.isEloqua&&n&&(t={crmExistingAccountId:o,crmExistingAccountName:n}),a.isSugarCrm&&o&&(t={crmExistingAccountId:o}),m=i.upload(r,!1,null,null,null,!0,s,g,null,null,!1,t),b.push(m)}}return j.length===Object.keys(f).length&&c.all(j).then(function(){c.all(b).then(function(b){2==b.length&&b[1].bulk&&b[1].bulk.length>0&&(b=[b[0]].concat(b[1].bulk));for(var c=b.length-1;c>=0;c--)b[c].bulk&&b[c].bulk.length>0&&(b=b.concat(b[c].bulk),b.splice(c,1));var f=_.filter(b,function(a){var b=_.findKey(k.errors,function(b){return b===a});return!_.isUndefined(b)});f.length>0?e.close({data:l,crmType:a.crmType,state:"ERROR",errorDetail:null}):e.close({data:a.selected,crmType:a.crmType,state:_.filter(b,function(a){return!a.continue}).length===d.crm.bulk.length?"CURRENT":"ERROR",linksSelected:a.linksSelected,countWithoutEmails:a.crm.countWithoutEmails?a.crm.countWithoutEmails:null,totalUpload:null!=p?p:null})})}),m})},n=c.when();if(a.isSugarCrm||a.isEloqua){var o=_.isUndefined(this)||_.isUndefined(this.linksSelected)?a.linksSelected:this.linksSelected;i.upload(o,!1,null,null,null,!0,g,null,null,null,!1,null,this.crm.successPersonIds,f).then(function(b){_.filter(b.bulk,function(a){_.startsWith(a.responseCode,"ERROR")}).length>0?e.close({data:l,crmType:a.crmType,state:"ERROR",errorDetail:null}):e.close({data:l,crmType:a.crmType,state:"CURRENT",errorDetail:null})})}else _.each(f,function(b,c){a.isHubspotCrm?n=n.then(function(){return m(b,c)}):m(b,c)})}else i.$$foundNoAccount(this.crm,a.isEloqua).then(function(b){b.continue===!1?e.close({data:a.selected,crmType:a.crmType,state:"CURRENT",linksSelected:a.linksSelected,totalUpload:null!=p?p:null}):b.isExit?e.close({data:a.selected,crmType:a.crmType,state:"ERROR",errorDetail:b.msg}):"uploadFailed"===b&&e.close({data:l,crmType:a.crmType,state:"ERROR",errorDetail:null})})},a.isUploadContactToMAT&&"ACTON"===a.supportedCrmType?(a.hideModal=!0,a.confirm(),a.confirmNGo()):a.hideModal=!1,a.setNeedsSelection=function(){a.showUpdatedRecord&&(a.needsSelection=0===a.crm.fieldsSelected.length)},a.$watchCollection("crm.fieldsSelected",function(b,c){a.setNeedsSelection()}),a.optionSelected=function(b,c){return!this.option||c&&!a.isCompany||a.isCompany&&!this.crm.foundMatchingCompany&&!this.option._getFieldsLink?(this.crm.fieldsSelected=[],void(a.showUpdatedRecord=!1)):(a.firstOption||(a.firstOption={_getFieldsLink:this.crm._links.getFromCrm,_updateFieldsLink:this.crm._links.updateFields}),!this.option._getFieldsLink&&a.firstOption._getFieldsLink&&(this.option._getFieldsLink=a.firstOption._getFieldsLink,this.option._updateFieldsLink=a.firstOption._updateFieldsLink),this.option._getFieldsLink&&"[object Array]"===Object.prototype.toString.call(this.option._getFieldsLink)&&(this.option._getFieldsLink=this.option._getFieldsLink[b]),this.option._updateFieldsLink&&"[object Array]"===Object.prototype.toString.call(this.option._updateFieldsLink)&&(this.option._updateFieldsLink=this.option._updateFieldsLink[b]),this.option._getFieldsLink?(this.crm._links.getFromCrm=this.option._getFieldsLink,this.crm._links.updateFields=this.option._updateFieldsLink,a.needsSelection=!0,void i.$$getUpdatedRecordData(this.crm).then(function(b){b&&(a.showUpdatedRecord=!0),a.availableFields=b,a.needsSelection=!1,a.crm.fieldsSelected=[],_.each(b.fieldNamesList,function(c,d){var e=b.discoverorgValuesList[d],f=b.crmValuesList[d];!e||_.eq(e,f)||Number(e)&&Number(e)==Number(f)||a.crm.fieldsSelected.push(c)}),a.setNeedsSelection()})):void(a.showUpdatedRecord=!1))},a.$$noAcctSelect=function(b){if(!a.isCompany||a.crm._links&&a.crm._links.getFromCrm||(a.crm.noMatchingCompany=!0),a.isBulk){var c=_.filter(a.crm.bulk,function(a){return!_.isArray(a.optionSelected)}).length,d=_.filter(a.crm.bulk,function(a){return a.visible}).length;a.needsSelection=c!==d}else a.needsSelection=!1},a.$$textLookupGo=function(b){a.noResultsForCompany="",a.isSearchingCompany=b.options[0]._a;var c=a.isBulk?b._links.findAccount.href:a.crm._links.findAccount.href;c+="&companyName="+a.isSearchingCompany,_.isEmpty(a.historyLookup)&&a.historyLookup.push(a.isSearchingCompany),i.$$textLookupGo(this.$$textLookup,c).then(function(c){c&&c.length||(a.noResultsForCompany=a.isSearchingCompany),a.isSearchingCompany=null;for(var d in a.historyLookup)for(var e=0;c.length>0&&e<c.length;)a.historyLookup[d]==c[e]._a?c.splice(e,1):e++;a.isBulk?b.optionsMore=c:Array.prototype.push.apply(a.crm.optionsMore,c);
for(var f in c)a.historyLookup.push(c[f]._a)})},a.showHideNewCampaignField=function(b){a.showNewCampaignField=0==b},a.showHideNewListField=function(b){a.showNewListField=0==b},a.$$addAsNew=function(a){a.optionSelected.push({_K:0,_a:""})},a.close=function(){if(this.crm.successPersonIds&&this.crm.successPersonIds.length>0){var b={data:{result:{successPersonIds:this.crm.successPersonIds},_links:this.crm._links},crmRecordType:a.crmRecordType,supportedCrmType:a.supportedCrmType,isBulk:!0};i.uploadPlantPersonsIfNeeded(b)}e.dismiss("cancel")}}],resolve:{links:function(){var a=n(e.ent),b=_.isArray(a)?a:new Array(a);return o(b,e.type)},selected:function(){var a=n(e.ent);return _.isArray(a)?_.filter(a,function(a){return!a.locked}):new Array(a)},searchCriteria:function(){return e.searchCriteria},followListId:function(){return e.followListId},listMethod:function(){return e.listMethod},totalUpload:function(){return e.uploadAll?e.totalUpload:null},uploadAll:function(){return!!e.uploadAll}},size:"lg",templateUrl:"app/directives/upload-import-directive/upload-import-partials/base.modal.html"});return a.result.then(function(a){var b=a.asyncJob?"Upload in Progress...":"Upload Successfully Completed",c=0,e=a.linksSelected&&"ACCOUNT"===i.getURLParameter(a.linksSelected,"crmRecordType"),f=a.linksSelected&&!e&&(a.linksSelected.toLowerCase().indexOf("pardot")>=0||a.linksSelected.toLowerCase().indexOf("acton")>=0||a.linksSelected.toLowerCase().indexOf("salesloft")>=0||a.linksSelected.toLowerCase().indexOf("outreach")>=0||a.linksSelected.toLowerCase().indexOf("hubspot")>=0||a.linksSelected.toLowerCase().indexOf("eloqua")>=0),j=a.linksSelected&&(a.linksSelected.toLowerCase().indexOf("pardot")>=0||a.linksSelected.toLowerCase().indexOf("zoho")>=0||a.linksSelected.toLowerCase().indexOf("hubspot")>=0);if("fillOnUpdateDoesNotSelected"===a.errorDetail)b="No fields are selected to update/create. Please check at least one 'Fill on Update/Create' box in your MAT Settings.",c=1;else if("credFail"===a.errorDetail&&a.crmType)b="There was a problem with your "+a.crmType+" credentials.",c=1;else if(a.errorDetail&&a.errorDetail.indexOf("fieldError")>-1&&a.crmType)b="One or more "+a.crmType+" fields is not compatible with the data being sent. Please check your field mappings.",c=1;else if(a.errorDetail&&a.errorDetail.indexOf("NO_API_ACCESS")>-1&&a.crmType)b="Please contact your "+a.crmType+" Account Manager to have API Connectivity turned on for your "+a.crmType+" account.",c=1;else if(a.tooManyBulkUploads)b="You have reached the maximum number of simultaneous bulk uploads permitted at this time. Please try again after your other uploads have completed.",c=1;else if(a.state&&"ERROR"===a.state&&a.errorDetail)b="Error: "+a.errorDetail,c=1;else if(a.state&&"ERROR"===a.state)b="There was a problem with your "+a.crmType+". Please contact our support team at help@discoverorg.com or 800-914-1220.",c=1;else if(a.skippedExisting)b="Record already exists within Pardot: skipped",c=1;else if(!a.asyncJob&&a.linksSelected&&(j||f)){for(var k=0,l=[],m=0;m<a.data.length;m++)a.data[m].email?l.push(a.data[m]):k++;var n=null!=a.totalUpload&&"CURRENT"===a.state?a.totalUpload:a.data.length;a.hasOwnProperty("total")&&a.total&&(n=a.total),a.hasOwnProperty("countWithoutEmails")&&a.countWithoutEmails&&(k=a.countWithoutEmails),k>0&&f&&(c=1,b=n+" selected, "+(n-k)+" uploaded (minus "+k+" record"+(k>1?"s":"")+" with no email address)"),a.bulkSkippedExisting>0&&j&&(c=1,b=n+" selected, "+(n-a.bulkSkippedExisting)+" uploaded (minus "+a.bulkSkippedExisting+" record"+(a.bulkSkippedExisting>1?"s":"")+" already present)"),k>0&&a.bulkSkippedExisting>0&&f&&j&&(c=1,b=n+" selected, "+(n-(a.bulkSkippedExisting+k))+" uploaded (minus "+k+" record"+(k>1?"s":"")+" with no email address and "+a.bulkSkippedExisting+" record"+(a.bulkSkippedExisting>1?"s":"")+" already present)"),a.data=l}if("ERROR"===a.state?h.create("danger",b,"fail"):a.hasUploadErrors||("PARTIAL_SUCCESS"===a.state?h.create("danger","Upload failed with some records.","fail"):h.create("flash",b,"flash")),c&&h.pause(),!_.isUndefined(a)&&!_.isEmpty(a.data)){var o=a.data;if(!(_.isUndefined(a.state)||"ERROR"!==a.state&&"CURRENT"!==a.state||a.asyncJob)){var p="crmStatus";_.each(o,function(b){_.isEmpty(b[p])&&(b[p]={}),b[p].crmEntityState=a.state})}g(function(){d.$broadcast("event:crmUpload",{lType:"page",data:o,call:"crmUpload"})},1e3)}}),a}}]),angular.module("dorgEuiApp").directive("uploadImport",["$rootScope",function(a){return{controller:"uploadImportController",link:function(b,c,d,e){a.Session.$isTrial===!0?c[0].outerHTML="":a.Session.$hasActiveCrm===!1&&a.Session.$hasActiveMat===!1&&a.Session.$hasActiveSdr===!1?c[0].outerHTML="":("company"!==d.uploadImportType||a.Session.$allowedCompanyUpload)&&("person"!==d.uploadImportType||a.Session.$allowedLeadUpload||a.Session.$allowedContactUpload)&&("person"!==d.uploadImportType||d.uploadImportEmail||a.Session.$canUploadEmaillessPersons!==!1)?c.bind("click",e.openModal):c[0].outerHTML=""},restrict:"A",scope:{ent:"=uploadImport",uploadImportIgnore:"=uploadImportIgnore",type:"=uploadImportType",searchCriteria:"=uploadImportCriteria",followListId:"=uploadImportFollowList",listMethod:"=uploadImportListMethod",totalUpload:"<",uploadAll:"<"}}}]),angular.module("dorgEuiApp").service("uploadImportService",["$rootScope","$http","$$uploadFnCallbacks","$embeddedUtils","$interval","Flash","crmBulkUploadErrorService","$$uploadStatic",function(a,b,c,d,e,f,g,h){var i=a.Session.navigation,j=i.$href("pardotCampaigns"),k=i.$href("pardotLists"),l=i.$href("pipedrivePipelineStages"),m=i.$href("salesloftCadences"),n=i.$href("outreachSequencesV2"),o=function(a,b){var d={continue:!1};if(c.init(),_.has(a,"responseCode")&&null!==a.responseCode&&(d=p(a.responseCode,a)),_.has(a,"bulkUploadResults")&&null!==a.bulkUploadResults){d.bulk=[],d.successPersonIds=[],a._links&&(d._links=a._links);var e=[];if(a.errorCode&&_.startsWith(a.errorCode,"ERROR"))return c.errorHandler(a.errorCode,{responseDetails:a.errorDetails});_.each(a.bulkUploadResults,function(c){a=_.clone(a),"SFDC"===b&&c&&_.startsWith(c.responseCode,"ERROR")&&c.responseDetails?e.push(c):(c._links.findAccount=c._links.findAccount?c._links.findAccount:{href:a._links&&a._links.findAccount?a._links.findAccount.href:""},d.bulk.push(_.clone(p(c.responseCode,c))),"SUCCESS"===c.responseCode&&c.personId&&d.successPersonIds.push(c.personId))}),e.length>0&&(f.create("danger","Upload failed with some records","fail"),g.openModal(e),d.hasUploadErrors=!0),d.continue=_.filter(d.bulk,{continue:!0}).length>0}return _.has(a,"countWithoutEmails")&&null!==a.countWithoutEmails&&(d.countWithoutEmails=_.clone(a.countWithoutEmails)),_.has(a,"total")&&null!==a.total&&(d.total=_.clone(a.total)),d.responseCode=a.responseCode,d},p=function(a,b){var d={continue:!1};return _.startsWith(a,"ERROR")||_.startsWith(a,"FAILED")?d=c.errorHandler(a,b):(_.startsWith(a,"FOUND")||_.startsWith(a,"NO")||_.startsWith(a,"SKIPPED"))&&(d=c.foundHandler(a,b)),d},q=this;this.upload=function(c,d,f,g,h,i,j,k,l,m,n,p,q,r){j=j||[],d=d===!0;var s={headers:{"Content-Type":"application/json"},method:"POST",url:c},t=this.getURLParameter(c,"supportedCrmType"),u=this.getURLParameter(c,"crmRecordType");if(f)s.data={searchCriteria:f};else if(g&&g>0)s.data={followListId:g};else if(h)s.data={listMethod:h.replace("$","")};else if(j.length>1||i){if(s.data={entityIds:j},n&&l&&(s.data.newAccountCompanyIds=l),n&&m&&(s.data.referencesAccounts=m),p&&(s.data.crmExistingAccountId=p.crmExistingAccountId,p.crmExistingAccountName&&(s.data.crmExistingAccountName=p.crmExistingAccountName)),n?s.data.isConfirmed=n:s.data.isConfirmed=!1,s.data.successPersonIds=q,r){var v="ACID_";s.data.recordsByCompany={},s.data.mapCrmAccountIdAccountName={},_.each(r,function(a,b){a[0].optionSelected._K&&(b=v+a[0].optionSelected._K,s.data.mapCrmAccountIdAccountName[a[0].optionSelected._K]=a[0].optionSelected._a),s.data.recordsByCompany[b]=[],_.each(a,function(a){s.data.recordsByCompany[b].push(a.personId)})})}}else s.data=d;return b(s).then(function(d){if(201===d.status&&d.headers("Location")){var f=_.random(100,1e5),g=function(){b.get(d.headers("Location")).then(function(b){("DONE"===b.data.status||"ERROR"===b.data.status||b.data.percentDone>99)&&e.cancel(h),a.$broadcast("event:uploadProgress",{id:f,data:b.data,selected:k,isBulk:i,supportedCrmType:t,crmRecordType:u})},function(){e.cancel(h)})},h=e(g,5e3),l=o(d.data);return l.asyncJob=!0,l}return j.length>1&&c.indexOf("supportedCrmType=NETSUITE")>-1?d.data:o(d.data,t)},function(a){if(429===a.status)return{state:"ERROR",tooManyBulkUploads:!0,continue:!1};var b={responseCode:"FAILED",updateFields:0};return o(b)})},this.getPardotCampaigns=function(){return b.get(j).then(function(a){return a.data},function(){return console.warn("there was a bad request made here :("),[]})},this.getPardotLists=function(){return b.get(k).then(function(a){return a.data},function(){return console.warn("there was a bad request made here :("),[]})},this.getPipedrivePipelineStages=function(){return b.get(l).then(function(a){return a.data},function(){return console.warn("there was a bad request made here :("),[]})},this.getSalesloftCadences=function(){return b.get(m).then(function(a){return a.data},function(){return console.warn("there was a bad request made here :("),[]})},this.getOutreachSequences=function(){return b.get(n).then(function(a){return a.data},function(){return console.warn("there was a bad request made here :("),[]})},this.$$textLookupGo=function(a,c){return b.post(c,a).then(function(a){var b=[];return a.data.accountIdsList?(_.each(a.data.accountsList,function(c,d){b.push({_a:c,_b:_.has(a.data,"creatorName")&&null!=a.data.creatorName?a.data.creatorName[d]:null,_c:_.has(a.data,"createAt")&&null!=a.data.createAt?a.data.createAt[d]:null,_K:a.data.accountIdsList[d],_getFieldsLink:a.data.accountIdsList.length>1?a.data._links.getFromCrm[d]:a.data._links.getFromCrm,_updateFieldsLink:a.data.accountIdsList.length>1?a.data._links.updateFields[d]:a.data._links.updateFields})}),b):b})},this.$$getUpdatedRecordData=function(a){var c;if(a._links.getFromCrm.constructor===Array){for(var d=0;d<a.options.length;d++)if(a.options[d]===a.optionSelected){c=a._links.getFromCrm[d].href;break}}else c=a._links.getFromCrm.href;return b.get(c).then(function(a){return a.data},function(){return console.warn("there was a bad request made here :("),[]})},this.$$goodToGo=function(a){return b.post(a._links.updateFields.href,a.fieldsSelected).then(function(a){return 200===a.status&&(!a.data||"ERROR_CRM_API_HANDLER_ERROR"!==a.data.responseCode||!a.data.responseDetails||a.data)},function(){return!1})},this.getURLParameter=function(a,b){return(new RegExp(b+"=(.+?)(&|$)").exec(a)||[void 0,null])[1]},this.$$foundNoAccount=function(a,b){var c=a._links.upload.href,d="";return d=a.optionSelected._a?encodeURIComponent(a.optionSelected._a):encodeURIComponent(a.options[0]._a),c+=b?0===a.optionSelected._K?"&newAccountName="+d:"&crmAccountId="+a.optionSelected._K+"&crmAccountName="+d:0===a.optionSelected._K?"&newAccountName="+d:"&crmAccountId="+a.optionSelected._K,q.upload(c,!1,null,null,null,!1,[])},this.findAccounts=function(a,c){return b.post(a,c).then(function(a){var b=[];return a.data.accountIdsList?(_.each(a.data.accountsList,function(c,d){b.push({companyLabel:c,id:a.data.accountIdsList[d]})}),b):b})},this.trackAsyncBulkUploadAction=function(a){return b.get(a)},this.canSupportUploadPlantPersons=function(a){return"OUTREACH"===a||"SALESLOFT"===a||"HUBSPOT"===a||"HUBSPOTCRM"===a||"SFDC"===a||"MARKETO"===a||"MSDYNAMICS"===a||a===h.supportedCrmTypes.SUGAR||a===h.supportedCrmTypes.ZOHO||a===h.supportedCrmTypes.NETSUITE||a===h.supportedCrmTypes.ELOQUA},this.uploadPlantPersonsIfNeeded=function(a){if(a.isBulk&&this.canSupportUploadPlantPersons(a.supportedCrmType)&&!_.isEmpty(a.data.result.successPersonIds)){var c=d.$fetchLink(a.data,"uploadPlantPersons"),e=a.data.result.sequenceId?a.data.result.sequenceId:null,f=a.data.result.cadenceId?a.data.result.cadenceId:null,g=a.data.result.tags?a.data.result.tags:[],h={supportedCrmType:a.supportedCrmType,crmRecordType:a.crmRecordType,successPersonIds:a.data.result.successPersonIds,sequenceId:e,cadenceId:f,tags:g};return b.post(c,h)}}}]),function(){"use strict";angular.module("dorgEuiApp").directive("uploadImportStatus",function(){return{controller:["$rootScope","$scope","$timeout","Flash","$uibModal","noMatchingAccountPopupService","$embeddedUtils","crmBulkUploadErrorService","uploadImportService",function(a,b,c,d,e,f,g,h,i){b.container={},b.total=0,b.$on("event:uploadProgress",function(e,j){if(b.container[j.id]=j.data.percentDone?j.data.percentDone:j.data.status,b.total=Object.keys(b.container).length,"DONE"===j.data.status||"ERROR"===j.data.status||b.container[j.id]>99){var k="ERROR";if(c(function(){delete b.container[j.id],b.total=Object.keys(b.container).length},1e3),_.has(j.data,"result")&&_.has(j.data.result,"bulkUploadResults")&&!_.isEmpty(j.data.result.bulkUploadResults)){var l=[],m=[],n=[];_.forEach(j.data.result.bulkUploadResults,function(a){if("NO_MATCHING_CRM_ACCOUNT"===a.responseCode||"FOUND_MATCHING_CRM_ACCOUNT"===a.responseCode){var b={companyName:a.companyName,companyId:a.companyId,responseCode:a.responseCode};a.hasOwnProperty("accountIdsList")&&Array.isArray(a.accountIdsList)&&a.accountIdsList[0]&&(b.accountId=a.accountIdsList[0]),_.findIndex(l,function(b){return b.companyId===a.companyId})<0&&l.push(b),"account"===a.matchType?m.push(a.co_id):m.push(a.pers_id)}else(_.startsWith(a.responseCode,"ERROR")||_.startsWith(j.data.responseCode,"FAILED"))&&n.push(a)});var o=g.$fetchLink(j.data,"findAccount"),p=g.$fetchLink(j.data,"bulkUpload"),q=g.$fetchLink(j.data,"trackUsage");if(j.data.result.sequenceId&&(p+="&sequenceId="+j.data.result.sequenceId),j.data.result.tags&&(p+="&tags="+encodeURIComponent(j.data.result.tags.join())),j.data.result.bulkUploadResults){var r=_.filter(j.data.result.bulkUploadResults,function(a){return"SUCCESS"===a.responseCode});r&&!_.isEmpty(r)&&(j.data.result.successPersonIds||(j.data.result.successPersonIds=[]),_.each(r,function(a){_.some(j.data.result.successPersonIds,a.personId)||j.data.result.successPersonIds.push(a.personId)}))}_.isEmpty(l)?(_.isEmpty(n)?"PARTIAL_SUCCESS"===j.data.result.responseCode?d.create("danger","Upload failed with some records","fail"):(k="CURRENT",d.create("flash","Upload has been completed successfully","flash")):(d.create("danger","Upload failed with some records","fail"),h.openModal(n)),i.trackAsyncBulkUploadAction(q)):_.isEmpty(n)?(k=null,f.openModal(l,o,m,j.selected,p,j)):(d.create("danger","Upload failed with some records. Please check your crm settings","fail"),i.uploadPlantPersonsIfNeeded(j))}else _.has(j.data,"result")&&_.has(j.data.result,"bulkUploadErrorCode")&&null!=j.data.result.bulkUploadErrorCode&&(_.startsWith(j.data.result.bulkUploadErrorCode,"ERROR")||_.startsWith(j.data.result.bulkUploadErrorCode,"FAILED"))&&null!=j.data.result.bulkUploadErrorDetails?(d.create("danger",j.data.result.bulkUploadErrorDetails,"fail"),d.pause()):_.has(j.data,"result")&&_.has(j.data.result,"responseCode")&&null!=j.data.result.responseCode&&(_.startsWith(j.data.result.responseCode,"ERROR")||_.startsWith(j.data.result.responseCode,"FAILED"))?d.create("danger",j.data.result.responseCode,"fail"):j.data.responseCode&&(_.startsWith(j.data.responseCode,"ERROR")||_.startsWith(j.data.responseCode,"FAILED"))?d.create("danger",j.data.responseDetails,"fail"):0==j.data.percentDone&&d.create("danger","Upload failed. Please check your settings","fail");if(k){var s="crmStatus";_.each(j.selected,function(a){_.isEmpty(a[s])&&(a[s]={}),a[s].crmEntityState=k}),c(function(){a.$broadcast("event:crmUpload",{lType:"page",data:j.selected,call:"crmUpload"})},1e3)}}}),b.$watch("container",function(a){b.hide=Object.keys(a).length<1},!0)}],restrict:"E",repalce:!0,templateUrl:"app/directives/upload-import-directive/upload-import-partials/upload.status.html"}})}(),angular.module("dorgEuiApp").directive("parseUrl",function(){return{link:function(a,b,c){var d="http://www.discoverydb.com/EXEC/SiteImprov/MVC/Views/";switch(a.type){case"companyProfileURL":d+="CompanyInfo.php?co.CO_ID="+a.id();break;case"companyOrgChartURL":d+="orgchart.php?co_id="+a.id();break;case"contactProfileURL":d+="PersonInfo.php?persid="+a.id();break;case"contactOrgChartURL":d+="orgchart.php?co_id="+a.companyId()+"&_scrollTo="+a.id()}c.$set("href",d)},restrict:"A",scope:{id:"&parseUrl",companyId:"&",type:"@"}}}),angular.module("dorgEuiApp").directive("vcard",["$rootScope","$ga","$state",function(a,b,c){var d=function(a){this.$get=function(){b.track("Directive","Vcard","Download, Location Src: "+c.current.name);var d=document.createElement("form"),e=a.personObj.hasOwnProperty("_links")?a.personObj._links.vcard.href:a.personObj.$href("vcard");d.setAttribute("action",e),d.setAttribute("method","GET"),d.setAttribute("target","_self"),d.setAttribute("id","vcfDownload"),document.body.appendChild(d),d.submit(),document.body.removeChild(document.getElementById("vcfDownload"))}},e={personObj:"=vcard"};return d.$inject=["$scope"],{controller:d,link:function(b,c,d,e){a.Session.$isTrial?c[0].outerHTML="":c.bind("click",e.$get)},restrict:"AE",scope:e}}]),function(){"use strict";function a(){return{link:function(a,b){$(b).on("click",".ui-select-match-item",function(){a.$selectMultiple.removeChoice($(this).parent().index())})}}}angular.module("dorgEuiApp").directive("wholeTagRemoves",a)}(),angular.module("dorgEuiApp").config(["$stateProvider","$urlRouterProvider","usSpinnerConfigProvider","uiSelectConfig","uiGridConstants","treeConfig","$locationProvider","$qProvider","$compileProvider",function(a,b,c,d,e,f,g,h,i){b.otherwise("/"),c.setDefaults({length:15,lines:11,opacity:0,radius:15,width:2,zIndex:1e3}),f.defaultCollapsed=!1,e.LOG_DEBUG_MESSAGES=!1,e.filter.DATE_LESS_THAN="DATE_LESS_THAN",e.filter.DATE_GREATER_THAN="DATE_GREATER_THAN",d.resetSearchInput=!0,d.closeOnSelect=!0,d.theme="bootstrap",g.hashPrefix(""),h.errorOnUnhandledRejections(!1)}]).config(["$provide",function(a){a.decorator("$http",["$delegate","$q",function(a,b){function c(a,b){var c=a.toLowerCase(),d=encodeURI(b).toLowerCase().split("?")[0];return c+"~"+d}var d=a.get,e=a.post,f={};return a.get=function(){var a,e,g,h=[].slice.call(arguments),i=h[0],j=h[1]||{};return null==j.timeout&&(g="GET",a=c(g,i),e=b.defer(),f[a]=e,j.timeout=e.promise,h[1]=j),d.apply(null,h)},a.post=function(){var a,d,g,h=[].slice.call(arguments),i=h[0],j=h[2]||{};return null==j.timeout&&(g="POST",a=c(g,i),d=b.defer(),f[a]=d,j.timeout=d.promise,h[2]=j),e.apply(null,h)},a.abort=function(a){console.log("aborting");var b,d;b=c(a.method,a.url),d=f[b],null!=d&&(console.log("aborting",b),null!=a.timeout&&"number"!=typeof a.timeout&&(d.resolve(),delete f[b]))},a}])}]),angular.module("dorgEuiApp").constant("dorgConfig",{GRID_FILTER_DEBOUNCE:1e3,NEDRY:"_dennisNedry",WHATS_NEW_DATE:"06/24/2019",IGNORE_STATES:["login","forgot-password","forgot-password-token","registration","try-new-dorg","force-reset-password-token","two-factor-auth","two-factor-auth-verify","logout"],VALID_LANDING:["perform_search","viewDashboard","viewQuickSearch"],FKS_URL:"//cdn.listenloop.com/assets/featurekicker.js",FKS_KEY:"gJ7TNBVNxFwb5QMMV4fr",GA_CODE:"UA-68214322-1",BANNER_LINK:"csm/banner-target.html",BANNER_IMG_PATH:"csm/login-background-image.png",MSG_404:"404 - Not Found",TPL_404:"app/views/_errors/404/404.tpl.html",MSG_409:"409 - Suppressed",TPL_409:"app/views/_errors/409/409.html",CTRL_409:"SuppressionDeniedController",MSG_412:"412 - Employee No Longer with Company",TPL_412:"app/views/_errors/412/412.html",CTRL_412:"RecentlyLeftAccessController",MSG_418:"418 - Access Denied",TPL_418:"app/views/_errors/418/418.html",CTRL_418:"AccessDeniedController",WHATS_NEW_PATH:"app/views/dashboard/whatsnew.html",BLANK_IMG:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",BLANK_PERSON:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABZCAMAAACJ4sOeAAACnVBMVEWXssyYssyYs8yZs82atM2btMybtM2btcybtc2btc6ctMyctc2ctc6cts6dtcydtc2dts2dts6dts+dt8+ets2ets6et86et8+euM+fts2ft82ft8+fuM+fuNCgts2gt82gt86guM6guM+guNCgudChuM6huc+hudCiuM2iuM6iuc6iuc+juc6juc+jus+kus+lus+lu9ClvNGmu8+nvNCovdCovdGpvdCpvdGqvtGqv9Gqv9OrvtGrv9Grv9Ksv9GswNKtv9GtwNKtwNOuwdKvwdOvwtOvwtSwwtOwwtSxwtKxwtOxw9Oxw9Syw9Oyw9SyxNSyxNWzxNW0xdW0xda1xtW1xta2xta2x9a3x9e4ydm5x9W5yNa5yNe5ydi6ydi6yti7yti7ytm7y9q8y9q9y9i9zNm9zNq/zNq/zdrBztzBz9vCz9zDz9zD0NzD0N3E0NzE0dzE0d3F0t7G0t3G0t/H0t3H097I09/J1d/L1d7L1uDM1+HN2OHO2OLQ2uTR2uPR2uTR2+TS2+TS2+XS3OXT2+PT3OTU3OTU3OXU3eXV3eXW3uXX3+bY4ObY4enZ4ObZ4OfZ4eja4eja4urb4ejb4ujb4unc4ujc4+nc4+rc5Ovd4ujd4+nd5Ore4+je5Orf5Onf5erg5erg5uvh5erh5uzi5+vi5+zk6e7l6e7l6u7m6+/n6+/o7O/p7PDp7fDq7fDr7vHs7/Lt8PLt8PPu8PPu8fPv8fPw8vTx8/Tx8/Xy8/Xy9PXy9Pbz9Pbz9fb09ff09vf19fb19vf2+Pj39/j3+Pj4+Pn4+fn5+fn5+fr5+vr6+vr6+/v6+/z7+/v7+/z7/Pz7/P38/Pv8/Pz9/fz9/f3+/fz+/f3+/v7//v3//v7///7////7CJltAAADeElEQVR42tXXiXdMVxzA8RQZV+68TGYSbiVvBO+OkdTaKkGtsa+VEEVrp02bEjslWktriX3fRav2kSBCxFJaSyvRSStBZH5/C87hHA7e+/3uzDuH7x/wOfecu5z7i/Lb1rtCG8LJeUwM51zoEaUFbz0id9Xe/Xs2/jAzM60xE5GihWvo6ku18LzQ34GlQ+M8kaANR7+Cani1h4czmR42LZLzgvB6j/I7OMOk3Wkn4M39MZ3LcGhtcBm8rdBPCV51Wsu4BSYV+HRVWht4G0w70tRQo0Wny2DR5lgl2vAVgWVzmQoduwGsq+gt6LT2HWA67CLTstUVFF07Kp5KuycBri2cSrM1SPp6W0mkEwJIunakoNGy7WVAluOk0XrXSiy9ktNob6/7WHpnDI0WQx5i6YOxNDo+K4Slf3cR6dFo+miCbas+RFy1yHyMpXdRt3EQehu3Rdt2+H50EunPglg6l0Ybout/SDk0Nsoh8LTexvfxv0i6atycjRMFlv6w/8XSA/8j6ZoqgOJkLM3ygVZl9yQk3fA4ka4dJpB0o1NAbKobSbv2UekpWNqxjCjf7ehF0p7xRPpEHPaEGO3/otFLGPrK8O20A5Ih0LRnAok+k4y/6DK1jEJnOwnPE1tKkAsTJYEWPYNoueYLN+m95jvQdEkTSaLFgAco9wFArkb8TvJfHp8ut6Z3f/lNc/LXvcXnLQPW9LcfaPSBQ4p6yy3lYBddabhzT7akT8apzY3ezhVW9Gyn4rSbeNZCvtPBq0jzVRZ0PlOd0UX6PVP5n25JqrSf5ZnSeQ6/Mi1TS83oeUyd9rNFZvT8OmHQYuAjEzrQR6jT8qMyMOn2p15l2u86AmatY+q042dTunp4vDJdNwdMO5Ug1Wg9um8hmLfQoUILR9qKIFgUHN6ATLt5+to7YN3VHvUMCm04E8cUBAHVje9TmIGlhaPdjKIQoCuZkcIlgjY0V78V14DW+RyfU1rQgrX6+lgV0DuXnaiZ0FJz9c67BIoFxsd53kLrLGXSr0EIo2MZ9ZNep6Wbd1tSAmFWvT6NyVdpnfm+OlABEejmgmT3S7SHd15UDJEqMILJqBeXI2trOUSw+4sbP6MlT80OhCDCFTyljaazLoANRflls98A7KH5ArCJlq3L7KIbTAa76OidttGfXLONnlZjG70JbKP/tI+G95F+Atk0GN+Fvr+JAAAAAElFTkSuQmCC",DEFAULT_SMALL_FAVICON:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAALpJREFUeNpiZICCtLS0/wwkgFmzZjGCaCYGCgE2AxYA8QcgPgDED6D4AFRsAbpiFiwGGACxABArQGkGJLYBMS6g2AsXoM59AKWR2ReI8UIClHZAElNAk8PrgkKojQugNl6Ash9A5Qi6oB+LbQZocrR1QT7UzwFoYSAAlSNowAWoYgE0cVgsKBAyAAZgqZABLVERDIMAqOKFwAzjCMIgNlQsgBgvwIA8MIfC0oI8LkX4DEjAlnDQAUCAAQDmdS8gx0HPPAAAAABJRU5ErkJggg==",VAD_PORTFOLIO:"VADPORTFOLIO",MY_LIST:"MYLIST",LIST_MATCH_COMPANY_NAME_SEARCH_LIMIT:5e4,LIST_MATCH_COMPANY_WEBSITE_SEARCH_LIMIT:5e4,LIST_MATCH_PARENT_DUNS_SEARCH_LIMIT:5e4,LIST_MATCH_PRIMARY_DUNS_SEARCH_LIMIT:5e4,LIST_MATCH_COMPANY_ID_SEARCH_LIMIT:5e4,LIST_MATCH_EMPLOYEE_ID_SEARCH_LIMIT:1e5,LIST_MATCH_EMPLOYEE_EMAIL_SEARCH_LIMIT:1e5,LIST_MATCH_EVENT_LIST_SEARCH_LIMIT:1e5,EVENT_ATTENDEE_DISPLAY_NAME:"Employee Name OR Title"}),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){function w(){_.has(window.ga)||(!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),q.ga("create",c.GA_CODE,"auto"),q.ga("set","userId",m.Session.account.uuid))}function x(){var a=m.Session.account.customerDiscoverOrgSalesforceId;a||(a=m.Session.account.customerId.toString()),window.totango_options={service_id:m.Session.account.totangoServiceId,user:{id:m.Session.account.email},account:{id:a+"__usage",parent_id:a,name:m.Session.account.customerName}},function(){var a=window.totango_options.tracker_name||"totango";window.totango_tmp_stack=[],window[a]={go:function(){return-1},setAccountAttributes:function(){},identify:function(){},track:function(a,b,c,d){return window.totango_tmp_stack.push({activity:a,module:b,org:c,user:d}),-1}};var b=document.createElement("script");b.type="text/javascript",b.async=!0,b.src=("https:"===document.location.protocol?"https://":"http://")+"tracker.totango.com/totango3.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}()}function y(a){a.preventDefault(),n.go("307")}function z(a){a.preventDefault(),n.go("503")}function A(){m.Session=f.invalidate(),h().destroy(),u.disableExportsNotifications(),n.go("login")}function B(){f.create().then(function(a){m.Session=a,u.enableExportsNotifications(),t.showUserLoginAlertUploadExportExpiration(),M(),d.getFeatureFlags().then(function(a){d.flags=a.data});var b=angular.copy(a.account),e=null,f={};if(_.isEmpty(b.preferences))e="viewQuickSearch";else{var g=_.isEmpty(b.preferences)?b.preferences={}:b.preferences;(!g.hasOwnProperty("landing")||c.VALID_LANDING.indexOf(g.landing)<0)&&(g.landing="viewQuickSearch"),e=g.landing}e=c.IGNORE_STATES.indexOf(m.$$lastState._t.name)<0?m.$$lastState._t.name:e,f=_.size(m.$$lastState._p)>0?m.$$lastState._p:f,N&&(window.location.hash=m.$$Alpha.hash,N=!1),n.go(e,f),x(),w()})}function C(a,b){var c="",d={};"login"!==n.current.name&&(_.has(m,["Session","account"])&&m.Session.account&&(c=m.Session.account.uuid),m.Session=f.invalidate(),h().destroy(),u.disableExportsNotifications(),m.isNot||(m.isNot=!0,(!_.isObject(b)||"-3"===b.data&&"-2"===b.data)&&(N=angular.copy(window.location)),e.unAuth(b,c)),b.status&&(d=b),n.go("login",d))}function D(){var a={excludeJsFonts:!0,excludeCpuClass:!0,detectScreenOrientation:!1,excludeScreenResolution:!0,excludeAvailableScreenResolution:!0,excludePixelRatio:!0,excludeSessionStorage:!0,excludeUserAgent:!1,excludeLanguage:!0,excludeColorDepth:!0,excludeTimezoneOffset:!0,excludeIndexedDB:!0,excludeAddBehavior:!0,excludeOpenDatabase:!0,excludePlatform:!0,excludeDoNotTrack:!0,excludeWebGL:!0,excludeAdBlock:!0,excludeHasLiedLanguages:!0,excludeHasLiedResolution:!0,excludeHasLiedOs:!0,excludeHasLiedBrowser:!0,excludeFlashFonts:!0,excludePlugins:!0,excludeIEPlugins:!0,excludeTouchSupport:!0,excludeHardwareConcurrency:!0,userDefinedFonts:[]},d=!!window.MSInputMethodContext&&!!document.documentMode;d||new Fingerprint2(a).get(function(a){a!==i.get(c.NEDRY)&&(document.cookie=c.NEDRY+"="+a+"; "+moment().add(1,"year").toDate().toGMTString())}),b.init(),m.$state=n,g.enabled(!window.isIE9),o.put("linkedInPopoverTpl.html",'<popover-close></popover-close><span us-spinner spinner-start-active="true" style="position:relative;z-index:-1;left:50%;top:125px;"></span><script id="" class="linkedInSupporter" type="IN/MemberProfile" data-id="" data-format="inline"></script>'),m.Session=f.invalidate(),m.$$Alpha=angular.copy(window.location),m.isNot=!1,m.isChrome=!!window.chrome,m.safeApply=K,m.copyrightYear=(new Date).getFullYear(),N=_.isObject(m.$$Alpha)&&E(m.$$Alpha.hash)}function E(a){var b=a.split("/");return 0===_.intersection(b,c.IGNORE_STATES).length}function F(a,b,c,d){console.error("State Change Error Occurred:",b,d)}function G(b,e,g,h){"main"===e.name&&m.$$lastState&&m.$$lastState._p&&"viewLookalikesInsearch"===m.$$lastState._p.status&&b.preventDefault(),"view_top_content_consumers"!==e.name||s.canAccessTopContentConsumers()||(n.go(s.getDefaultLandingPage(),{}),b.preventDefault()),m.$$lastState={_t:e,_p:g,_f:h},m.isNot=!1,c.IGNORE_STATES.indexOf(e.name)===-1&&(m.Session.authenticated?"two-factor-auth"!=e.name&&"two-factor-auth-verify"!=e.name&&(a.checkAuthentication(b),q.scrollTo(0,0)):(b.preventDefault(),d.getFeatureFlags().then(function(a){d.flags=a.data}),a.checkAuthentication(b).then(function(){f.create().then(function(a){m.Session=a}).then(w).then(x).finally(function(){n.go(e.name,g),N=void 0})},function(a){b.preventDefault(),m.$broadcast("event:auth-loginRequired",g)})))}function H(){m.isLoginPage="login"===n.current.name;var a=(new Date).getTime();a-O>864e5&&window.location.reload(),m.Session.toggleFlowError&&(v.handleErrorRedirectToDOZI(m.Session.toggleFlowError),m.Session.toggleFlowError=null),null==n.current||"view_person_tier_two"!==n.current.name&&"view_company_tier_two"!==n.current.name||I()}function I(){var a=document.title;document.title="",document.title=a}function J(){q.ga&&p(function(){q.ga("send","pageview",{page:l.path()})},750)}function K(a){var b=m.$$phase;"$apply"===b||"$digest"===b?a&&"function"==typeof a&&a():this.$apply(a)}function L(a,b){m.Session=f.invalidate(),h().destroy(),n.go("force-reset-password-token",{token:b})}function M(){m.Session.navigation.$has("oppalert_manage_topic")&&m.Session.account.havingOppAlertsSubscriptionExpired&&r.open({controller:["$uibModalInstance","$state","TopContentConsumerService",function(a,b,c){function d(){f.doNotShowAgain&&c.dismissOppAlertSubscriptionExpiredWarning(),f.close()}function e(){b.go("view_top_content_consumers",{goToManageTopic:!0}),f.close()}var f=this;f.close=a.dismiss,f.dismissWarning=d,f.goToManageTopicsPage=e}],controllerAs:"$ctrl",windowClass:"oppalert-subscription-expiration-warning",templateUrl:"app/views/topcontentconsumer/partials/oppalert-subscription-expiration-warning.html"})}var N=!1,O=(new Date).getTime();D(),m.$on("error:unavailable",z),m.$on("error:maintenance",y),m.$on("event:auth-loginConfirmed",B),m.$on("event:auth-loginRequired",C),m.$on("event:auth-loginCancelled",A),m.$on("$stateChangeError",F),m.$on("$stateChangeStart",G),m.$on("$stateChangeSuccess",H),m.$on("$viewContentLoaded",J),m.$on("event:auth-loginForceReset",L)}a.$inject=["authentication","checkMobile","dorgConfig","featureFlagService","noAuthService","Session","$animate","$cacheFactory","$cookies","$http","$interval","$location","$rootScope","$state","$templateCache","$timeout","$window","$uibModal","UserService","LoginService","ExportsNotificationService","NotificationService"],angular.module("dorgEuiApp").run(a)}(),angular.module("ui.bootstrap-slider",[]).directive("bsSlider",["$parse","$timeout",function(a,b){return{restrict:"AE",replace:!0,template:'<div><input class="slider-input" type="text" /></div>',require:"ngModel",scope:{max:"=",min:"=",step:"=",value:"=",ngModel:"=",ngDisabled:"=",range:"=",sliderid:"=",formatter:"&",onStartSlide:"&",onStopSlide:"&",onSlide:"&"},link:function(c,d,e,f,g){function h(){function d(a,b,c){m[a]=b||c}function g(a,b,c){m[a]=b?parseFloat(b):c}function h(a,b,c){m[a]=b?b+""=="true":c}function l(a){return angular.isString(a)&&0===a.indexOf("[")?angular.fromJson(a):a}var m={};d("id",c.sliderid),d("orientation",e.orientation,"horizontal"),d("selection",e.selection,"before"),d("handle",e.handle,"round"),d("tooltip",e.sliderTooltip||e.tooltip,"show"),d("tooltipseparator",e.tooltipseparator,":"),g("min",c.min,0),g("max",c.max,10),g("step",c.step,1);var n=m.step+"",o=n.substring(n.lastIndexOf(".")+1);if(g("precision",e.precision,o),h("tooltip_split",e.tooltipsplit,!1),h("enabled",e.enabled,!0),h("naturalarrowkeys",e.naturalarrowkeys,!1),h("reversed",e.reversed,!1),h("range",c.range,!1),m.range){if(angular.isArray(c.value))m.value=c.value;else if(angular.isString(c.value)){if(m.value=l(c.value),!angular.isArray(m.value)){var p=parseFloat(c.value,10);isNaN(p)&&(p=5),p<c.min?(p=c.min,m.value=[p,m.max]):p>c.max?(p=c.max,m.value=[m.min,p]):m.value=[m.min,m.max]}}else m.value=[m.min,m.max];c.ngModel=m.value}else g("value",c.value,5);if(c.formatter&&(m.formatter=c.$eval(c.formatter)),$.fn.slider){$.fn.bootstrapSlider.constructor.prototype.disable=function(){this.picker.off()},$.fn.bootstrapSlider.constructor.prototype.enable=function(){this.picker.on()},k.bootstrapSlider(m);var q=k[0];_.has(q,"parentNode")&&(q.parentNode.removeChild(q),q.style.display="",k.removeAttr("data"),k.off(),k.bootstrapSlider(m));var r=l(e.updateevent);r=_.isString(r)?[r]:["slide"],_.each(r,function(a){k.on(a,function(a){f.$setViewValue(a.value),b(function(){c.$apply()})})}),k.on("change",function(a){f.$setViewValue(a.value.newValue),b(function(){c.$apply()})});var s={slideStart:"onstartslide",slide:"onslide",slideStop:"onstopslide"
};_.each(s,function(d,f){k.on(f,function(f){if(e[d]){var g=a(e[d]);g(c.$parent)(f,f.value),b(function(){c.$apply()})}})}),angular.isFunction(j)&&(j(),j=null),j=c.$parent.$watch("ngDisabled",function(a){k.bootstrapSlider(a?"disable":"enable")}),angular.isFunction(i)&&i(),i=c.$watch("ngModel",function(a){k.bootstrapSlider("setValue",a)},!0)}}var i,j,k=$(d).children(".slider-input");h();var l=["min","max","step","range"];_.each(l,function(a){c.$watch(a,function(a,b){_.isUndefined(a)||h()})})}}}]),angular.module("angular-hal",[]).service("halClient",["$http","$q","$window",function(a,b,c){function d(a,c,d){function h(a,b,c){Object.defineProperty(a,b,{configurable:!1,enumerable:!1,value:c})}function j(a){if(_.isArray(a))return a.map(function(a){return j(a)});var c=a.$href("self");q[c]=b.when(a)}function k(a,b){return a.templated?new i.UriTemplate(a.href).stringify(b):a.href}function l(a,c,d,e){var f;return _.isArray(c)?b.all(c.map(function(b){if("GET"!==a)throw"method is not supported for arrays";return l(a,b,d,e)})):(f=k(c,d),"GET"===a&&_.has(q,f)?q[f]:g(a,f,d,e))}function m(a,b){return _.isArray(b)?b.map(function(b){return m(a,b)}):f(a,b&&b[n]&&b[n].self)}var n=c.linksAttribute||"_links",o=c.embeddedAttribute||"_embedded",p={},q={};a=m(a,d).href,h(this,"$href",function(a,b){return a in p?k(p[a],b):null}),h(this,"$has",function(a){return a in p}),h(this,"$get",function(a,b){var c=p[a];return l("GET",c,b)}),h(this,"$post",function(a,b,c){var d=p[a];return l("POST",d,b,c)}),h(this,"$put",function(a,b,c){var d=p[a];return l("PUT",d,b,c)}),h(this,"$patch",function(a,b,c){var d=p[a];return l("PATCH",d,b,c)}),h(this,"$del",function(a,b){var c=p[a];return l("DELETE",c,b)}),Object.keys(d).filter(function(a){return a!==n&&a!==o&&!~["_","$"].indexOf(a[0])}).forEach(function(a){Object.defineProperty(this,a,{configurable:!1,enumerable:!0,value:d[a]})},this),d[n]&&Object.keys(d[n]).forEach(function(b){var c=d[n][b];c=f(a,c),p[b]=c},this),d[o]&&Object.keys(d[o]).forEach(function(b){var f=d[o][b],g=m(a,f);p[b]=g;var h=e(a,c,f);j(h)},this)}function e(a,b,c){return _.isArray(c)?c.map(function(c){return e(a,b,c)}):new d(a,b,c)}function f(a,b){return _.isArray(b)?b.map(function(b){return f(a,b)}):(b?("string"==typeof b&&(b={href:b}),b.href=h(a,b.href)):b={href:a},b)}function g(c,d,f,g){f||(f={}),f.headers||(f.headers={}),f.headers["Content-Type"]||(f.headers["Content-Type"]="application/json"),f.headers.Accept||(f.headers.Accept="application/hal+json,application/json");var h=a({method:c,url:f.transformUrl?f.transformUrl(d):d,headers:f.headers,data:g}).then(function(a){switch(Math.floor(a.status/100)){case 2:return a.data?e(d,f,a.data):a.headers("Content-Location")?a.headers("Content-Location"):a.headers("Location")?a.headers("Location"):null;default:return b.reject(a.status)}});return h}function h(a,b){for(var c="",d=/^((?:\w+\:)?)((?:\/\/)?)([^\/]*)((?:\/.*)?)$/,e=d.exec(a),f=d.exec(b),g=1;g<5;g++)c+=f[g]?f[g]:e[g];return c}var i=c.rfc6570;this.$get=function(a,b){return g("GET",a,b)},this.$post=function(a,b,c){return g("POST",a,b,c)},this.$put=function(a,b,c){return g("PUT",a,b,c)},this.$patch=function(a,b,c){return g("PATCH",a,b,c)},this.$del=function(a,b,c){return g("DELETE",a,b,c)}}]),function(){"use strict";function a(a){a.interceptors.push(["$q","hardRefreshService",function(a,b){return{response:function(a){return b.hardRefreshCheck(),a},responseError:function(c){return b.hardRefreshCheck(),a.reject(c)}}}])}function b(a){function b(){var b,c,d;window.localStorage&&(b=a.get("$http"),c=new Date,d=new Date(c.getFullYear(),c.getMonth(),c.getDate()),(!window.localStorage.lastHardRefreshCheck||d>parseInt(window.localStorage.lastHardRefreshCheck,10))&&(window.localStorage.lastHardRefreshCheck=(new Date).getTime(),window.location.reload(!0)))}this.hardRefreshCheck=b}angular.module("hard-refresh-checker",[]).service("hardRefreshService",b),angular.module("hard-refresh-interceptor",["hard-refresh-checker"]).config(a),a.$inject=["$httpProvider"],b.$inject=["$injector"]}(),function(){"use strict";angular.module("http-auth-interceptor",["http-auth-interceptor-buffer"]).factory("authService",["$rootScope","httpBuffer",function(a,b){return{loginConfirmed:function(b){a.$broadcast("event:auth-loginConfirmed",b)},loginCancelled:function(c,d){b.rejectAll(d),a.$broadcast("event:auth-loginCancelled",c)}}}]).config(["$httpProvider",function(a){a.interceptors.push(["$rootScope","$q","dorgConfig","$injector","$window",function(a,b,c,d,e){function f(a,b){_.isEmpty(a)||(b[_.camelCase(a)]=!0)}function g(a){switch(a){case"login":case"forgot-password":case"forgot-password-token":case"force-reset-password-token":case"registration":case"two-factor-auth":case"two-factor-auth-verify":return!1;default:return!0}}return{response:function(a){return 401===a.status?b.reject(a):a},responseError:function(h){var i=d.get("$state");if(!h.config.ignoreAuthModule||!_.includes(c.IGNORE_STATES,i.current.name)){var j=h.headers("authentication-failure-detail");switch(h.status){case 401:f(j,h);break;case 418:a.$broadcast("event:Im-a-Teapot",h);break;case 403:console.log(i),f(j,h);break;case 307:a.$broadcast("error:maintenance",h);break;case 503:a.$broadcast("error:unavailable",h);break;case 500:h.headers("RedirectToDozi")&&"true"===h.headers("RedirectToDozi")&&h.headers("Location")&&(e.location.href=h.headers("Location"),h.redirectToDozi=!0)}}if(401===h.status&&g(i.current.name)){var k=h.maxConcurrentSessions?{bounceMsg:"-2",status:"CONCURRENT_USER"}:{};a.$broadcast("event:auth-loginRequired",k)}return b.reject(h)}}}])}]),angular.module("http-auth-interceptor-buffer",[]).factory("httpBuffer",["$injector",function(a){function b(b,d){function e(a){d.resolve(a)}function f(a){d.reject(a)}c=c||a.get("$http"),c(b).then(e,f)}var c,d=[];return{append:function(a,b){d.push({config:a,deferred:b})},rejectAll:function(a){if(a)for(var b=0;b<d.length;++b)d[b].deferred.reject(a);d=[]},retryAll:function(a){for(var c=0;c<d.length;++c)b(a(d[c].config),d[c].deferred);d=[]}}}])}(),angular.module("vanillaLazyloadJs",[]).factory("LazyLoadingImage",["$window",function(a){if(a.LazyLoad){a._thirdParty=a._thirdParty||{},a._thirdParty.LazyLoad=a.LazyLoad;try{delete a.LazyLoad}catch(b){a.LazyLoad=void 0}}var b=a._thirdParty.LazyLoad;return b}]),function(a,b){"use strict";a.module("mobile-detection",[]),a.module("mobile-detection").factory("checkMobile",function(){return{init:function(){window.isMobile=this.isMobile()},isMobile:function(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(b)}}})}(angular,navigator.userAgent||navigator.vendor||window.opera),angular.module("placeholders",["placeholders.img","placeholders.txt"]),angular.module("placeholders.img",[]).directive("phImg",function(){return{restrict:"A",scope:{dimensions:"@phImg"},link:function(a,b,c){function d(){var b=[a.size.h,a.size.w].sort(),c=Math.round(b[1]/16);return Math.max(g.text_size,c)}function e(){f=f||document.createElement("canvas");var b,c,e=f.getContext("2d");return f.width=a.size.w,f.height=a.size.h,e.fillStyle=g.fill_color,e.fillRect(0,0,a.size.w,a.size.h),b=d(),c=a.dimensions,e.fillStyle=g.text_color,e.textAlign="center",e.textBaseline="middle",e.font="bold "+b+"pt sans-serif",e.measureText(c).width/a.size.w>1&&(b=g.text_size/(e.measureText(c).width/a.size.w),e.font="bold "+b+"pt sans-serif"),e.fillText(a.dimensions,a.size.w/2,a.size.h/2),f.toDataURL("image/png")}var f,g={text_size:10,fill_color:"#EEEEEE",text_color:"#AAAAAA"};a.$watch("dimensions",function(){if(angular.isDefined(a.dimensions)){var c,d=a.dimensions.match(/^(\d+)x(\d+)$/);if(!d)return void console.error("Expected '000x000'. Got "+a.dimensions);a.size={w:d[1],h:d[2]},b.prop("title",a.dimensions),b.prop("alt",a.dimensions),c=e(),"IMG"===b.prop("tagName")?b.prop("src",c):b.css("background-image",'url("'+c+'")')}})}}}),angular.module("placeholders.txt",[]).factory("TextGeneratorService",function(){function a(a,b){return Math.floor(Math.random()*(b-a+1))+a}var b=["lorem","ipsum","dolor","sit","amet,","consectetur","adipiscing","elit","ut","aliquam,","purus","sit","amet","luctus","venenatis,","lectus","magna","fringilla","urna,","porttitor","rhoncus","dolor","purus","non","enim","praesent","elementum","facilisis","leo,","vel","fringilla","est","ullamcorper","eget","nulla","facilisi","etiam","dignissim","diam","quis","enim","lobortis","scelerisque","fermentum","dui","faucibus","in","ornare","quam","viverra","orci","sagittis","eu","volutpat","odio","facilisis","mauris","sit","amet","massa","vitae","tortor","condimentum","lacinia","quis","vel","eros","donec","ac","odio","tempor","orci","dapibus","ultrices","in","iaculis","nunc","sed","augue","lacus,","viverra","vitae","congue","eu,","consequat","ac","felis","donec","et","odio","pellentesque","diam","volutpat","commodo","sed","egestas","egestas","fringilla","phasellus","faucibus","scelerisque","eleifend","donec","pretium","vulputate","sapien","nec","sagittis","aliquam","malesuada","bibendum","arcu","vitae","elementum","curabitur","vitae","nunc","sed","velit","dignissim","sodales","ut","eu","sem","integer","vitae","justo","eget","magna","fermentum","iaculis","eu","non","diam","phasellus","vestibulum","lorem","sed","risus","ultricies","tristique","nulla","aliquet","enim","tortor,","at","auctor","urna","nunc","id","cursus","metus","aliquam","eleifend","mi","in","nulla","posuere","sollicitudin","aliquam","ultrices","sagittis","orci,","a","scelerisque","purus","semper","eget","duis","at","tellus","at","urna","condimentum","mattis","pellentesque","id","nibh","tortor,","id","aliquet","lectus","proin","nibh","nisl,","condimentum","id","venenatis","a,","condimentum","vitae","sapien","pellentesque","habitant","morbi","tristique","senectus","et","netus","et","malesuada","fames","ac","turpis","egestas","sed","tempus,","urna","et","pharetra","pharetra,","massa","massa","ultricies","mi,","quis","hendrerit","dolor","magna","eget","est","lorem","ipsum","dolor","sit","amet,","consectetur","adipiscing","elit","pellentesque","habitant","morbi","tristique","senectus","et","netus","et","malesuada","fames","ac","turpis","egestas","integer","eget","aliquet","nibh","praesent","tristique","magna","sit","amet","purus","gravida","quis","blandit","turpis","cursus","in","hac","habitasse","platea","dictumst","quisque","sagittis,","purus","sit","amet","volutpat","consequat,","mauris","nunc","congue","nisi,","vitae","suscipit","tellus","mauris","a","diam","maecenas","sed","enim","ut","sem","viverra","aliquet","eget","sit","amet","tellus","cras","adipiscing","enim","eu","turpis","egestas","pretium","aenean","pharetra,","magna","ac","placerat","vestibulum,","lectus","mauris","ultrices","eros,","in","cursus","turpis","massa","tincidunt","dui","ut","ornare","lectus","sit","amet","est","placerat","in","egestas","erat","imperdiet","sed","euismod","nisi","porta","lorem","mollis","aliquam","ut","porttitor","leo","a","diam","sollicitudin","tempor","id","eu","nisl","nunc","mi","ipsum,","faucibus","vitae","aliquet","nec,","ullamcorper","sit","amet","risus","nullam","eget","felis","eget","nunc","lobortis","mattis","aliquam","faucibus","purus","in","massa","tempor","nec","feugiat","nisl","pretium","fusce","id","velit","ut","tortor","pretium","viverra","suspendisse","potenti","nullam","ac","tortor","vitae","purus","faucibus","ornare","suspendisse","sed","nisi","lacus,","sed","viverra","tellus","in","hac","habitasse","platea","dictumst","vestibulum","rhoncus","est","pellentesque","elit","ullamcorper","dignissim","cras","tincidunt","lobortis","feugiat","vivamus","at","augue","eget","arcu","dictum","varius","duis","at","consectetur","lorem","donec","massa","sapien,","faucibus","et","molestie","ac,","feugiat","sed","lectus","vestibulum","mattis","ullamcorper","velit","sed","ullamcorper","morbi","tincidunt","ornare","massa,","eget","egestas","purus","viverra","accumsan","in","nisl","nisi,","scelerisque","eu","ultrices","vitae,","auctor","eu","augue","ut","lectus","arcu,","bibendum","at","varius","vel,","pharetra","vel","turpis","nunc","eget","lorem","dolor,","sed","viverra","ipsum","nunc","aliquet","bibendum","enim,","facilisis","gravida","neque","convallis","a","cras","semper","auctor","neque,","vitae","tempus","quam","pellentesque","nec","nam","aliquam","sem","et","tortor","consequat","id","porta","nibh","venenatis","cras","sed","felis","eget","velit","aliquet","sagittis","id","consectetur","purus","ut","faucibus","pulvinar","elementum","integer","enim","neque,","volutpat","ac","tincidunt","vitae,","semper","quis","lectus","nulla","at","volutpat","diam","ut","venenatis","tellus","in","metus","vulputate","eu","scelerisque","felis","imperdiet","proin","fermentum","leo","vel","orci","porta","non","pulvinar","neque","laoreet","suspendisse","interdum","consectetur","libero,","id","faucibus","nisl","tincidunt","eget","nullam","non","nisi","est,","sit","amet","facilisis","magna","etiam","tempor,","orci","eu","lobortis","elementum,","nibh","tellus","molestie","nunc,","non","blandit","massa","enim","nec","dui","nunc","mattis","enim","ut","tellus","elementum","sagittis","vitae","et","leo","duis","ut","diam","quam","nulla","porttitor","massa","id","neque","aliquam","vestibulum","morbi","blandit","cursus","risus,","at","ultrices","mi","tempus","imperdiet","nulla","malesuada","pellentesque","elit","eget","gravida","cum","sociis","natoque","penatibus","et","magnis","dis","parturient","montes,","nascetur","ridiculus","mus","mauris","vitae","ultricies","leo","integer","malesuada","nunc","vel","risus","commodo","viverra","maecenas","accumsan,","lacus","vel","facilisis","volutpat,","est","velit","egestas","dui,","id","ornare","arcu","odio","ut","sem","nulla","pharetra","diam","sit","amet","nisl","suscipit","adipiscing","bibendum","est","ultricies","integer","quis","auctor","elit","sed","vulputate","mi","sit","amet","mauris","commodo","quis","imperdiet","massa","tincidunt","nunc","pulvinar","sapien","et","ligula","ullamcorper","malesuada","proin","libero","nunc,","consequat","interdum","varius","sit","amet,","mattis","vulputate","enim","nulla","aliquet","porttitor","lacus,","luctus","accumsan","tortor","posuere","ac","ut","consequat","semper","viverra","nam","libero","justo,","laoreet","sit","amet","cursus","sit","amet,","dictum","sit","amet","justo","donec","enim","diam,","vulputate","ut","pharetra","sit","amet,","aliquam","id","diam","maecenas","ultricies","mi","eget","mauris","pharetra","et","ultrices","neque","ornare","aenean","euismod","elementum","nisi,","quis","eleifend","quam","adipiscing","vitae","proin","sagittis,","nisl","rhoncus","mattis","rhoncus,","urna","neque","viverra","justo,","nec","ultrices","dui","sapien","eget","mi","proin","sed","libero","enim,","sed","faucibus","turpis","in","eu","mi","bibendum","neque","egestas","congue","quisque","egestas","diam","in","arcu","cursus","euismod","quis","viverra","nibh","cras","pulvinar","mattis","nunc,","sed","blandit","libero","volutpat","sed","cras","ornare","arcu","dui","vivamus","arcu","felis,","bibendum","ut","tristique","et,","egestas","quis","ipsum","suspendisse","ultrices","fusce","ut","placerat","orci","nulla","pellentesque","dignissim","enim,","sit","amet","venenatis","urna","cursus","eget","nunc","scelerisque","viverra","mauris,","in","aliquam","sem","fringilla","ut","morbi","tincidunt","augue","interdum","velit","euismod","in","pellentesque","massa","placerat","duis","ultricies","lacus","sed","turpis","tincidunt","id","aliquet","risus","feugiat","in","ante","metus,","dictum","at","tempor","commodo,","ullamcorper","a","lacus","vestibulum","sed","arcu","non","odio","euismod","lacinia","at","quis","risus","sed","vulputate","odio","ut","enim","blandit","volutpat","maecenas","volutpat","blandit","aliquam","etiam","erat","velit,","scelerisque","in","dictum","non,","consectetur","a","erat","nam","at","lectus","urna","duis","convallis","convallis","tellus,","id","interdum","velit","laoreet","id","donec","ultrices","tincidunt","arcu,","non","sodales","neque","sodales","ut","etiam","sit","amet","nisl","purus,","in","mollis","nunc","sed","id","semper","risus","in","hendrerit","gravida","rutrum","quisque","non","tellus","orci,","ac","auctor","augue","mauris","augue","neque,","gravida","in","fermentum","et,","sollicitudin","ac","orci","phasellus","egestas","tellus","rutrum","tellus","pellentesque","eu","tincidunt","tortor","aliquam","nulla","facilisi","cras","fermentum,","odio","eu","feugiat","pretium,","nibh","ipsum","consequat","nisl,","vel","pretium","lectus","quam","id","leo","in","vitae","turpis","massa","sed","elementum","tempus","egestas","sed","sed","risus","pretium","quam","vulputate","dignissim","suspendisse","in","est","ante","in","nibh","mauris,","cursus","mattis","molestie","a,","iaculis","at","erat","pellentesque","adipiscing","commodo","elit,","at","imperdiet","dui","accumsan","sit","amet","nulla","facilisi","morbi","tempus","iaculis","urna,","id","volutpat","lacus","laoreet","non","curabitur","gravida","arcu","ac","tortor","dignissim","convallis","aenean","et","tortor","at","risus","viverra","adipiscing","at","in","tellus","integer","feugiat","scelerisque","varius","morbi","enim","nunc,","faucibus","a","pellentesque","sit","amet,","porttitor","eget","dolor","morbi","non","arcu","risus,","quis","varius","quam","quisque","id","diam","vel","quam","elementum","pulvinar","etiam","non","quam","lacus","suspendisse","faucibus","interdum","posuere","lorem","ipsum","dolor","sit","amet,","consectetur","adipiscing","elit","duis","tristique","sollicitudin","nibh","sit","amet","commodo","nulla","facilisi","nullam","vehicula","ipsum","a","arcu","cursus","vitae","congue","mauris","rhoncus","aenean","vel","elit","scelerisque","mauris","pellentesque","pulvinar","pellentesque","habitant","morbi","tristique","senectus","et","netus","et","malesuada","fames","ac","turpis","egestas","maecenas","pharetra","convallis","posuere","morbi","leo","urna,","molestie","at","elementum","eu,","facilisis","sed","odio","morbi","quis","commodo","odio","aenean","sed","adipiscing","diam","donec","adipiscing","tristique","risus","nec","feugiat","in","fermentum","posuere","urna","nec","tincidunt","praesent","semper","feugiat","nibh","sed","pulvinar","proin","gravida","hendrerit","lectus","a","molestie","gravida","dictum"];return{createSentence:function(c){var d,e;return c=c||a(5,20),d=a(0,b.length-c-1),e=b.slice(d,d+c).join(" ").replace(/\,$/g,"")+".",e=e.charAt(0).toUpperCase()+e.slice(1)},createSentences:function(b){var c=[],d=0;for(b=b||a(3,5),d=0;d<b;d++)c.push(this.createSentence());return c.join(" ")},createParagraph:function(a){var b=this.createSentences(a);return"<p>"+b+"</p>"},createParagraphs:function(b,c){var d=[],e=0;for(b=b||a(3,7),e=0;e<b;e++)d.push(this.createParagraph(c));return d.join("\n")}}}).directive("phTxt",["TextGeneratorService",function(a){return{restrict:"EA",controller:["$scope","$element","$attrs",function(b,c,d){function e(){var b;b=g||!f?a.createParagraphs(g,f):a.createSentences(f),c.html(b)}var f,g;d.$observe("phTxt",function(a){var b,c;b=a.match(/(\d+)p/),c=a.match(/(\d+)s/),g=null!==b&&parseInt(b[1],10),f=null!==c&&parseInt(c[1],10),e()}),d.phTxt||e()}]}}]),angular.module("dorgEuiApp").factory("account",["$rootScope","halClient",function(a,b){return{get:function(){var c=a.Session.resource.$href("current-user");return b.$get(c)}}}]),function(){"use strict";angular.module("dorgEuiApp").factory("authentication",["authService","halClient","$http","$rootScope",function(a,b,c,d){var e=function(b,c){d.Session.resourceTemp=b,_.has(c,["require-tfa"])||(d.Session.resource=b,a.loginConfirmed(b))};return{login:function(a){var b=$.param({username:a.username,password:a.password,_spring_security_remember_me:a.rememberMe,submit:"Login"}),f=d.Session.resource.$href("authentication"),g={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},ignoreAuthModule:"ignoreAuthModule"};return c({method:"POST",url:f,headers:g.headers,data:b}).then(function(a){return e(a.data,a.headers()),a})},logout:function(){var c="api/logout";return null!=d.Session.resource&&null!=d.Session.resource.$href("logout")&&(c=d.Session.resource.$href("logout")),b.$post(c).then(a.loginCancelled)},checkAuthentication:function(){return c.get("protected/authentication_check.gif",{ignoreAuthModule:"ignoreAuthModule"})}}}])}(),function(){"use strict";function a(){function a(a){var c={firstIndustryName:"",otherIndustryNames:[]},d=[],e=[];_.has(a,"companyUuid")||_.has(a,"primaryIndustryName")?(d=_.compact([a.primaryIndustryName]),e=_.sortBy(_.compact([a.secondaryIndustry1Name,a.secondaryIndustry2Name,a.secondaryIndustry3Name]),b)):(d=_.map(_.compact(_.filter(a.companyIndustries,{primary:!0})),"name"),e=_.sortBy(_.map(_.compact(_.filter(a.companyIndustries,{primary:!1})),"name"),b));var f=d.concat(e);return _.size(f)>0&&(c.firstIndustryName=f[0]),f.shift(),c.otherIndustryNames=f,c}function b(a){return a.toLowerCase()}return{getIndustriesInfo:a}}a.$inject=[],angular.module("dorgEuiApp").service("companyIndustryService",a)}(),function(){"use strict";function a(){function a(a){var b=moment(a,"MM/DD/YYYY");return b.isValid()}return{isValidDate:a}}a.$inject=[],angular.module("dorgEuiApp").service("dateValidationService",a)}(),angular.module("dorgEuiApp").service("ExportsNotificationService",["$http","$rootScope","$interval",function(a,b,c){function d(){a.get("api/rest/notifications/exports").then(function(a){e=a.data.hasExportsQueuedOrInProgress,a.data.exportHistoryItems&&a.data.exportHistoryItems.length>0&&b.$broadcast("exportCompleteNotification",{completedExports:a.data.exportHistoryItems})})}var e=!1;this.enableExportsNotifications=function(){e=!0},this.disableExportsNotifications=function(){e=!1},c(function(){e&&d()},2e4)}]),angular.module("dorgEuiApp").service("$gridStatic",["uiGridConstants","featureFlagService","searchGridTemplateService",function(a,b,c){function d(a){var b=_.findIndex(a,function(a){return"publishDate"===a.field}),c={cellTemplate:"app/services/globals/grid_tpls/intel/types_tpl.html",displayName:"Types",enableFiltering:!1,field:"typeId",enableSorting:!1,minWidth:175},d=_.findIndex(a,function(a){return"typeId"===a.field});a[d]=c,a[b].cellTemplate="app/services/globals/grid_tpls/intel/date_only_tpl.html";var e={cellTemplate:"app/services/globals/grid_tpls/intel/scoop_description_tpl.html",displayName:"Description",enableFiltering:!1,enableSorting:!1,field:"article",minWidth:500,width:700},f=_.findIndex(a,function(a){return"article"===a.field});return a[f]=e,a}var e=this;b.getFeatureFlags().then(function(a){e.featureflags=void 0===e.featureflags?{}:e.featureflags,a.data.forEach(function(a){e.featureflags[a.name]=a.active})}),this.$gridDefs=function(f,g,h,i,j){var k=[];switch(h=!_.isUndefined(h)&&h===!0,i=!_.isUndefined(i)&&i===!0,e.viewOnMobile=void 0!=j?j:e.viewOnMobile,f){case"followCompany":k=c.followCompany(h,e.viewOnMobile);break;case"tierTwoCompany":k=c.tierTwoCompany();break;case"uploadCompany":k=c.uploadCompany(h);break;case"followPerson":k=c.followPerson(g,i,h);break;case"tierTwoPerson":k=c.tierTwoPerson();break;case"currentPerson":k=c.currentPerson(i,h,e.viewOnMobile);break;case"uploadPerson":k=c.uploadPerson(g,h);break;case"recentlyLeftEmployee":k=c.recentlyLeftEmployee();break;case"suppressedPersons":k=[{field:"name",displayName:"Employee"}];break;case"userManager":k=c.userManager();break;case"intelResults":case"alertIntel":var l=c.intelResults();k=b.findFeatureFlag(null,"triggerstoscoops")?d(l):l;break;case"subscription":k=c.subscription();break;case"alertCompany":k=c.alertCompany();break;case"alertPerson":k=c.alertPerson();break;case"bulkMatch":k=c.bulkMatch();break;case"alertTopcontentconsumer":case"topContent":k=c.topContent();break;case"customerOppalertTopics":k=c.customerOppalertTopics();break;default:k=e.$gridDefs("followPerson")}for(var m=!_.includes(["followCompany","uploadCompany","followPerson","uploadPerson","intelResults","tierTwoCompany","tierTwoPerson"],f),n=0,o=k.length;n<o;++n)k[n].enableColumnMenu=!1,k[n].cellTooltip=!0,m&&_.isUndefined(k[n].enableSorting)&&(k[n].enableSorting=!0),_.isUndefined(k[n].enableFiltering)&&(k[n].enableFiltering=!0),k[n].filter||(k[n].filter={condition:a.filter.CONTAINS}),"followCompany"===f&&"Company"===k[n].displayName&&(k[n].cellClass="companyCell");return k},this.fitScoreCol=function(){return{cellTemplate:"app/services/globals/grid_tpls/common/stars_tpl.html",displayName:"DealPredict",enableColumnMenu:!1,enableFiltering:!1,enableSorting:!0,field:"fitscore",minWidth:130,width:130,sortDirectionCycle:[a.DESC,a.ASC],sort:{direction:a.DESC,priority:1}}}}]),angular.module("dorgEuiApp").service("noAuthService",["$rootScope","$state","$timeout","$ga",function(a,b,c,d){this.unAuth=function(a,e){if(""===b.current.name)b.go("login");else{var f={url:null,method:null,epoch:(new Date).getTime(),userAgent:navigator.userAgent||navigator.vendor||window.opera,location:b.current.name};if(f.url=a.config?a.config.url:a.failureBody?a.failureBody.config.url:-2,f.method=a.config?a.config.method:a.failureBody?a.failureBody.config.method:-2,f.isConcurrent="-2"===a.data,d.track("Unathorized","UUID: "+e,JSON.stringify(f)),_.isObject(a.data))return;c(b.go,50,!0,"login",{bounceMsg:a.data})}}}]),angular.module("dorgEuiApp").service("$checkBulk",["$rootScope",function(a){this.$checkPersons=function(){return a.Session.navigation.$has("bulkUploadContact")||a.Session.navigation.$has("bulkUploadLead")||a.Session.navigation.$has("bulkUploadContactToMAT")||a.Session.navigation.$has("bulkUploadLeadToMAT")||a.Session.navigation.$has("bulkUploadLeadToSDR")||a.Session.navigation.$has("bulkUploadContactToSDR")},this.$checkCompanies=function(){return a.Session.navigation.$has("bulkUploadCompany")||a.Session.navigation.$has("bulkUploadCompanyToMAT")||a.Session.navigation.$has("bulkUploadCompanyToSDR")}}]),function(){"use strict";function a(){function a(a,c,d){var e=!1,f=b(a,d),g=new Blob([f],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(g,c),e=!0;else{var h=document.createElement("a");if(void 0!==h.download){var i=URL.createObjectURL(g);h.setAttribute("href",i),h.setAttribute("download",c),h.style.visibility="hidden",document.body.appendChild(h),h.click(),document.body.removeChild(h),e=!0}}return e}function b(a,b){var f="",g="",h="";return _.each(b,function(a){g+=""===g?d:e,g+=a.displayName.replace(/""/g,'"')}),""!==g&&(g+=d,f+=g+c),_.each(a,function(a){g="",_.each(b,function(b){g+=""===g?d:e,h=a[b.field],h&&(h=String(h).replace(/""/g,'"')),g+=h}),""!==g&&(g+=d,f+=g+c)}),f}var c="\r\n",d='"',e='","';return{exportCsvFile:a}}a.$inject=[],angular.module("dorgEuiApp").service("csvDownload",a)}(),angular.module("dorgEuiApp").service("$embeddedUtils",function(){var a=this;this.$e=function(a){return _.has(a,"_embedded")},this.$l=function(a){return _.has(a,"_links")},this.$self=function(b){return a.$fetchLink(b,"self")},this.$getE=function(b){return a.$e(b)?b._embedded[Object.keys(b._embedded)[0]]:[]},this.$getD=function(b){var c=_.omit(b,["_links","page"]);return a.$e(c)?a.$getE(b):_.size(c)>0?c[_.keys(c)[0]]:[]},this.$fetchLink=function(a,b){return _.has(a,"$href")?a.$href(b):_.has(a,"_links."+b)?a._links[b].href:null},this.$sf=function(a){return _.filter(a,function(a){return!(a.suppressedByCustomer||!a.suppressedByCustomer&&a.suppressedByUser||a.suppressedByUser)})}});angular.module("dorgEuiApp").service("favicon",["$rootScope","dorgConfig",function(a,b){var c=a.Session.navigation.$href("cdnBaseUrl");this.$build=function(a,d){return d=d||32,a=a||null,null!==a?c+(_.startsWith(a,"/")?a.substr(1):a):b.BLANK_IMG}}]);angular.module("dorgEuiApp").filter("cdn",["$rootScope","dorgConfig",function(a,b){var c=a.Session.navigation.$href("cdnBaseUrl"),d="defaults/P.png",e="defaults/L.png";return function(a,f){return"string"==typeof a?f||_.isEmpty(a)?!f&&_.isEmpty(a)?c+d:f&&!_.isEmpty(a)?(a=_.startsWith(a,"/")?a.substring(1):a,c+a):(a=_.startsWith(a,"/")?a.substring(1):a,c+a):(a=_.startsWith(a,"/")?a.substring(1):a,c+a):"logo"===f?c+e:"person"===f?c+d:"favicon"===f?b.DEFAULT_SMALL_FAVICON:b.BLANK_IMG}}]).filter("absUrl",function(){return function(a){return a=a||"",/^https?:\/\//i.test(a)?a:"http://"+a}}).filter("capitalize",function(){return function(a){return a?a.replace(/([^\W_]+[^\s-]*) */g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}):""}}).filter("monthName",[function(){return function(a){var b=["January","February","March","April","May","June","July","August","September","October","November","December"];return b[a-1<0?0:a-1]}}]).filter("favicon",["favicon",function(a){return function(b,c){return b&&c?a.$build(b,c):""}}]).filter("camel",[function(){return function(a){return _.capitalize(_.camelCase(a))}}]).filter("human",[function(){function a(a){return a.charAt(0).toUpperCase()+a.substring(1)}return function(b){var c=b.match(/[A-Za-z][a-z]*/g);return c.map(a).join(" ")}}]).filter("linkatize",function(){return function(a){return a?(a=a.replace(/\|/gi," <br /> "),a=a.replace(/(?:^|[^href="]|[^\>])(\[(.*?)\]\()(.+?)(\))/g,function(a,b,c,d){return _.startsWith(d,"www")&&(d="http://"+d),' <a href="'+d+'" target="_blank">'+c+"</a>"}),a=a.replace(/(^|[^href="])(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,'$1<a href="$2" target="_blank">$2</a>'),a=a.replace(/(\s|^)(www\.[\S]+(\b|$))/gim,'$1<a href="http://$2" target="_blank">$2</a>'),a=a.replace(/(\s|^)([A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,})(\s|$)/gi,'$1<a href="mailto:$2">$2</a>$3')):""}}).filter("revenueNumber",["$filter",function(a){return function(b){if(null===b)return null;if(0===b)return"$0 M";for(var c="M",d=[{key:"B",value:Math.pow(10,3)},{key:"M",value:1}],e=0;e<d.length;e++){var f=_.round(b/d[e].value,2).toFixed(2);if(f>=1){b=f,c=d[e].key;break}}return"$"+a("currency")(b,"",2)+" "+c}}]).filter("convertLargeCurrency",function(){return function(a,b){var c,d=["K","M","B","T"];return isNaN(a)||null===a?null:a<1e3?"$"+a.toFixed(b):(c=Math.floor(Math.log(a)/Math.log(1e3)),"$"+(a/Math.pow(1e3,c)).toFixed(b)+" "+d[c-1])}}),function(){"use strict";function a(a){this.setCorrectMonth=function(a){switch(a){case 0:return"01";case 1:return"02";case 2:return"03";case 3:return"04";case 4:return"05";case 5:return"06";case 6:return"07";case 7:return"08";case 8:return"09";case 9:return"10";case 10:return"11";case 11:return"12"}},this.setCorrectDate=function(a){switch(a){case 1:return"01";case 2:return"02";case 3:return"03";case 4:return"04";case 5:return"05";case 6:return"06";case 7:return"07";case 8:return"08";case 9:return"09";default:return a.toString()}},this.setTwoDatesFormat=function(b,c){var d=b.getFullYear()+"-"+this.setCorrectMonth(b.getMonth())+"-"+this.setCorrectDate(b.getDate()),e=c.getFullYear()+"-"+this.setCorrectMonth(c.getMonth())+"-"+this.setCorrectDate(c.getDate());return a.findDateDifference(d,e,"days")}}a.$inject=["helperService"],angular.module("dorgEuiApp").service("FormatDatesService",a)}(),angular.module("dorgEuiApp").service("$ga",["$window",function(a){this.track=function(b,c,d){if(!b||!c||!d)throw new Error("Check your GA params. Must include the following: `page`, `event label`, `action`.");b=b||"",c=c||"",d=d||"",a.ga&&a.ga("send","event",b,c,d)}}]),function(){"use strict";function a(){var a=this;return a.getOS=function(){var a=window.navigator.userAgent,b=window.navigator.platform,c=["Macintosh","MacIntel","MacPPC","Mac68K"],d=["Win32","Win64","Windows","WinCE"],e=["iPhone","iPad","iPod"],f=void 0;return c.indexOf(b)!==-1?f="Macintosh":e.indexOf(b)!==-1?f="iOS":d.indexOf(b)!==-1?f="Windows":/Android/.test(a)?f="Android":!f&&/Linux/.test(b)&&(f="Linux"),f},a}angular.module("dorgEuiApp").service("getOS",a)}(),function(){"use strict";function a(){}angular.module("dorgEuiApp").component("lockedContentComponent",{
bindings:{entity:"<"},templateUrl:"app/services/globals/grid_tpls/locked-content/locked-content.template.html",controller:a,controllerAs:"vm"})}(),function(){"use strict";function a(){function a(){b.tooltip=b.isActionCol?c:d,b.position=b.isActionCol?e:f}var b=this,c="Actions are unavailable for this record due to privacy.",d="This information is unavailable for this record due to privacy.",e="auto left",f="auto right";this.$onInit=a}angular.module("dorgEuiApp").component("privacyRequestedComponent",{bindings:{entity:"<",isActionCol:"="},templateUrl:"app/services/globals/grid_tpls/privacy-requested/privacy-requested.template.html",controller:a,controllerAs:"vm"})}(),angular.module("dorgEuiApp").service("$grid",["$http","dorgConfig","$rootScope","account","$templateCache","$state","$q","$gridStatic","uiGridConstants",function(a,b,c,d,e,f,g,h,i){var j=this;this.$gridDefs=h.$gridDefs,this.doMagic=function(a,b){if(!a||!b)throw console.error(arguments),new Error("Missing parameter");var c={employees:"followPerson",currentEmployees:"currentPerson",search_employees:"followPerson",uiTablefollowPerson:"followPerson",alertPerson:"alertPerson",search_tierTwoPersons:"tierTwoPerson",tierTwoPersons:"tierTwoPerson",companies:"followCompany",search_companies:"followCompany",uiTablefollowCompany:"followCompany",alertCompany:"alertCompany",tierTwoCompany:"tierTwoCompany",search_tierTwoCompanies:"tierTwoCompany",intel:"intelResults",search_intel:"intelResults",alertIntel:"alertIntel",alertTopcontentconsumer:"alertTopcontentconsumer",pastEmployees:"recentlyLeftEmployee",subscription:"subscription",uiTablesubscription:"subscription",search_bulkMatch:"bulkMatch",usageReports:"usageReports",userManager:"userManager",suppressedPersons:"suppressedPersons",topContent:"topContent",customerOppalertTopics:"customerOppalertTopics"},d=j.$gridDefs(c[b]),e=d.length,f=[];if("bulkMatch"===b||angular.equals(a,d))return a;for(var g=0;g<a.length;++g){var h=_.findIndex(d,function(b){return b.field===a[g].field});h<0&&a.splice(g,1)}for(var g=0,i=a.length;g<i;++g)for(var k=0;k<e;++k)a[g].field===d[k].field&&(_.merge(a[g],_.omit(d[k],"visible")),d[k].enableColumnResizing===!1&&0!=a[g].width||(a[g].width="*"),f.push(a[g]));if(a.length<e)for(var g=0;g<e;++g){var l=_.findIndex(f,function(a){return a.field===d[g].field});l<0&&f.splice(g,0,d[g])}return f},this.$defaultGrid=function(a,d,g,h,k,l,m,n){d=d||[],g=g!==!1;var o=c.Session.account.preferences,p={columnDefs:j.$gridDefs(a,g,l,m,n),data:d,enableFiltering:!0,enableSorting:!0,enableVerticalScrollbar:i.scrollbars.NEVER,enableHorizontalScrollbar:i.scrollbars.ALWAYS,enablePaginationControls:!1,enableGridMenu:!0,enableRowSelection:!0,paginationPageSizes:[10,25,50,75,100],paginationPageSize:o.grid&&o.grid.pageSize?Number(o.grid.pageSize):25,pagesToShow:10,virtualizationThreshold:100,isRowSelectable:function(a){return!a.entity.locked&&!a.entity.privacyEuRequested&&!a.entity.privacyRequested}},q={followPerson:"employees",currentPerson:"currentEmployees",followCompany:"companies",intelResults:"intel",recentlyLeftEmployee:"pastEmployees",subscription:"subscription",bulkMatch:"bulkMatch",tierTwoPerson:"tierTwoPersons",tierTwoCompany:"tierTwoCompanies",alertPerson:"alertPerson",alertCompany:"alertCompany",alertIntel:"alertIntel",alertTopcontentconsumer:"alertTopcontentconsumer",usageReports:"usageReports",userManager:"userManager",suppressedPersons:"suppressedPersons",topContent:"topContent",customerOppalertTopics:"customerOppalertTopics"};q[a]&&"perform_search"===f.current.name&&(q[a]="search_"+q[a]),q[a]&&_.startsWith(f.current.name,"user_lists_")&&(q[a]="uiTable"+a),p.columnDefs=j.doMagic(o.columnRearrangePosition[q[a]]||p.columnDefs,q[a]),(_.isUndefined(h)||h)&&(p.onRegisterApi=function(b){this.api=b,_.isUndefined(k)||(_.isUndefined(this.api.core)||this.api.core.on.columnVisibilityChanged(k,function(){j.buildAndUpdateColumnDefinition(k,b,a)}),_.isUndefined(this.api.colMovable)||this.api.colMovable.on.columnPositionChanged(k,function(){j.buildAndUpdateColumnDefinition(k,b,a)}))});var r=['<div role="rowgroup" class="ui-grid-viewport" style="overflow: scroll hidden;" ng-style="colContainer.getViewportStyle()">',"<!-- tbody -->",'<div class="ui-grid-canvas">','<div ng-repeat="(rowRenderIndex, row) in rowContainer.renderedRows track by $index" class="ui-grid-row tableRow-{{rowRenderIndex}}" ng-style="Viewport.rowStyle(rowRenderIndex)">','<div role="row" ui-grid-row="row" row-render-index="rowRenderIndex">',"</div>","</div>","</div>","</div>"].join(""),s=['<div class="ui-grid-filter-container" ng-repeat="colFilter in col.filters" ng-class="{\'ui-grid-filter-cancel-button-hidden\' : colFilter.disableCancelFilterButton === true }">',"<div ng-if=\"colFilter.type !== 'select' && colFilter.type !== 'date'\">",'<input type="text" class="ui-grid-filter-input ui-grid-filter-input-{{$index}}" ng-model="colFilter.term" ng-model-options="{debounce:{default:',b.GRID_FILTER_DEBOUNCE,'}}" ng-attr-placeholder="{{colFilter.placeholder || \'\'}}" aria-label="{{colFilter.ariaLabel || aria.defaultFilterLabel}}">','<div role="button" class="ui-grid-filter-button" ng-click="removeFilter(colFilter, $index)" ng-if="!colFilter.disableCancelFilterButton" ng-disabled="colFilter.term === undefined || colFilter.term === null || colFilter.term === \'\'" ng-show="colFilter.term !== undefined &&  colFilter.term !== null && colFilter.term !== \'\'">','<i class="ui-grid-icon-cancel" ui-grid-one-bind-aria-label="aria.removeFilter">&nbsp;</i>',"</div>","</div>","<div ng-if=\"colFilter.type === 'select'\">",' <select class="ui-grid-filter-select ui-grid-filter-input-{{$index}}" ng-model="colFilter.term" ng-attr-placeholder="{{colFilter.placeholder || aria.defaultFilterLabel}}" aria-label="{{colFilter.ariaLabel || \'\'}}" ng-options="option.value as option.label for option in colFilter.selectOptions">','<option value=""></option>',"</select>",'<div role="button" class="ui-grid-filter-button-select" ng-click="removeFilter(colFilter, $index)" ng-if="!colFilter.disableCancelFilterButton" ng-disabled="colFilter.term === undefined || colFilter.term === null || colFilter.term === \'\'" ng-show="colFilter.term !==undefined && colFilter.term !=null">','<i class="ui-grid-icon-cancel" ui-grid-one-bind-aria-label="aria.removeFilter">&nbsp;</i>',"</div>","</div>","<div ng-if=\"colFilter.type === 'date'\">",'<input type="text" ng-datepicker min-date="null" no-max-date ng-model="colFilter.term" ng-model-options="{debounce:{default:',b.GRID_FILTER_DEBOUNCE,'}}" ng-attr-placeholder="{{colFilter.placeholder || \'\'}}" aria-label="{{colFilter.ariaLabel || aria.defaultFilterLabel}}">','<div role="button" class="ui-grid-filter-button" ng-click="removeFilter(colFilter, $index)" ng-if="!colFilter.disableCancelFilterButton" ng-disabled="colFilter.term === undefined || colFilter.term === null || colFilter.term === \'\'" ng-show="colFilter.term !== undefined &&  colFilter.term !== null && colFilter.term !== \'\'">','<i class="ui-grid-icon-cancel" ui-grid-one-bind-aria-label="aria.removeFilter">&nbsp;</i>',"</div>","</div>","</div>"].join("");return e.get("ui-grid/uiGridViewport")!==r&&(e.put("ui-grid/uiGridViewport",r),e.put("ui-grid/ui-grid-filter",s)),e.put("ui-grid/selectionRowHeaderButtons","<div class=\"ui-grid-selection-row-header-buttons\" ng-class=\"{'ui-grid-row-selected': row.isSelected, 'ui-grid-icon-ok': !row.entity.locked && !row.entity.privacyRequested, 'ui-grid-icon-lock': row.entity.locked || row.entity.privacyRequested}\" ng-click=\"selectButtonClick(row, $event)\">&nbsp;</div>"),p},this.buildAndUpdateColumnDefinition=function(a,b,c){var d=a.gridName;if(a.gridNames)for(var e=0,f=a.gridNames.length;e<f;e++)if(a.gridNames[e][c]){d=a.gridNames[e][c];break}j.updateColumnDefinition(b.saveState.save().columns,d)},this.processGridColumns=function(a){for(var b=[],c=0,d=a.length;c<d;++c){var e=a[c];b.push({enableColumnMenu:!1,field:e.name||e.field,width:"*"===e.width?0:e.width,visible:e.visible})}return b},this.sanitizeGrid=function(a){var b=g.defer(),a=a||c.Session.account.preferences,d=Object.keys(a.columnRearrangePosition);if(0===d.length)b.resolve(a);else for(var e=0,f=d.length;e<f;++e)a.columnRearrangePosition[d[e]]=j.processGridColumns(a.columnRearrangePosition[d[e]]),e===f-1&&b.resolve(a);return b.promise},this.updateColumnDefinition=function(b,e){var f=c.Session.navigation.$href("accountPreferences"),h=c.Session.account.preferences;g.defer();e="persons"===e?"employees":e,_.has(h,"widgets")&&_.each(h.widgets,function(a,b){_.each(a,function(a,c){delete h.widgets[b][c].tpl})}),_.has(h,"columnRearrangePosition")||(h.columnRearrangePosition={}),h.columnRearrangePosition[e]=b,j.sanitizeGrid(h).then(function(b){a.post(f,b).then(d.get).then(function(a){c.Session.account=a})})},this.closeAllPopover=function(a){var b=a.querySelectorAll(".popover",".popover-container");b&&_.each(b,function(a){var b=angular.element(a);b.scope().$parent&&(b.scope().$parent.isOpen=!1),b.remove()})}}]),function(){"use strict";function a(a){function b(a,b,e,h,l,m){var n=_.cloneDeep(b);return e?(f(n),g(n,h,l,m),h?i(n):j(a,n,l,m),n.article=n.article.replace(k.contacRegExp,"<em>vacant</em>"),n.article=n.article.replace(new RegExp("&CONTACT","g"),"<em>vacant</em>")):h?c(n):d(n,l),n.article}function c(a){a.personName&&a.personId?a.article=a.article.replace(new RegExp("&CONTACT","g"),'<a data-person-id="'+a.personId+'" href="#/person/'+a.personId+'">'+a.personName+"</a>"):a.article=a.article.replace(new RegExp("&CONTACT","g"),"<em>vacant</em>"),a.article=_.startsWith(a.article,a.companyName)?a.article:a.companyName+" "+a.article}function d(b,c){b.article=b.personName&&b.personId?_(b.article).replace(new RegExp("&CONTACT","g"),c!==b.personId?'<a data-person-id="'+b.personId+'" href="#/person/'+b.personId+'">'+b.personName+"</a>":"<strong>"+b.personName+"</strong>"):_(b.article).replace("&CONTACT","<em>vacant</em>"),b.article=c!==b.companyId?e(b,"")+b.article:"<strong>"+b.companyName+"</strong> "+b.article,c!==b.companyId&&(b.__img=a("cdn")(b.companyIconFileName16,"company"),b.article="<img src='"+b.__img+"' ng-img-error />"+b.article)}function e(a,b){return'<a href="#/company/'+a.companyId+'"'+b+">"+a.companyName+" </a>"}function f(a){_.isEmpty(a.persons)?a.article=a.article.replace(k.contacRegExp,"<em>vacant</em>"):_.size(a.article)>0&&a.article.indexOf("&CONTACT")>-1&&!k.contacRegExp.test(a.article)&&(a.article=a.article.replace(new RegExp("&CONTACT","g"),"&CONTACT_"+a.persons[0].id))}function g(a,b,c,d){_.forEach(a.persons,function(e){b?a.article=a.article.replace(new RegExp("&CONTACT_"+e.id,"g"),h(e)?e.fullName:'<a data-person-id="'+e.id+'" href="#/person/'+e.id+'">'+e.fullName+"</a>"):c!==e.id||"view_person"!==d?a.article=a.article.replace(new RegExp("&CONTACT_"+e.id,"g"),h(e)?e.fullName:'<a data-person-id="'+e.id+'" href="#/person/'+e.id+'">'+e.fullName+"</a>"):a.article=a.article.replace(new RegExp("&CONTACT_"+e.id,"g"),"<strong>"+e.fullName+"</strong>")})}function h(a){var b=0,c=4,d=1;return a.personState===b||a.personState===c&&a.stateChangeReasonId===d}function i(a){_.startsWith(a.article,a.companyName)&&(a.article=_.trimLeft(a.article,a.companyName)),a.article="<strong>"+a.companyName+" </strong>"+a.article}function j(b,c,d,f){var g=d!==c.companyId||"view_company"!==f;c.article=g?e(c,b)+c.article:"<strong>"+c.companyName+"</strong> "+c.article,g&&(c.__img=a("cdn")(c.companyIconFileName16,"company"),c.article="<img src='"+c.__img+"' ng-img-error />"+c.article)}var k=this;k.contacRegExp=new RegExp(/\&CONTACT\_(\d+)/g),k.parseArticle=b}a.$inject=["$filter"],angular.module("dorgEuiApp").service("intelArticleParserService",a)}(),angular.module("dorgEuiApp").service("maps",["$http","$rootScope","$embeddedUtils",function(a,b,c){this.getStyle=function(){return b.Session.mapStyle},this.getBaseStyle=function(){return a.get("assets/maps-test.json").then(function(a){return a.data},function(){return[]})},this.getCompanyEmployees=function(b){return a.get(c.$fetchLink(b,"employees")).then(function(a){return c.$getD(a.data)})},this.getBaseIcon="assets/images/marker_red.png",this.getCompanyIcon="assets/images/marker_yellow.png",this.getCompanyIconGreen="assets/images/marker_green.png",this.getCompanyIconBlue="assets/images/marker_blue.png",this.getCompanyIconPurple="assets/images/marker_purple.png"}]),function(){"use strict";function a(a,b){function c(a,b){var c=void 0!==a&&a.length>0?1:0,d=void 0!==b&&b.length>0?1:0;return c&&d?0:c&&!d?1:!c&&d?-1:0}function d(b,c){return[{cellTemplate:"app/services/globals/grid_tpls/company/name_tpl.html",displayName:"Company",field:"name",minWidth:140,pinnedLeft:!c},{displayName:"Phone",enableFiltering:!1,field:"mainPhoneNumber",minWidth:130},{cellTemplate:"app/services/globals/grid_tpls/company/website_tpl.html",displayName:"Website",field:"websiteUrl",minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/company/industry_tpl.html",displayName:"Industry",field:"industry.name",minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/company/relationshipType_tpl.html",enableFiltering:!1,displayName:"Entity Type",field:"relationshipTypeId",minWidth:150,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/company/ultimateParent_tpl.html",enableFiltering:!0,displayName:"Ultimate Parent",field:"ultimateParent.name",minWidth:130,visible:!1},{displayName:"Street Address",field:"location.streetAddress",minWidth:75,enableSorting:!1,visible:!1},{displayName:"City",field:"location.city",minWidth:75},{displayName:"County",field:"location.countyName",enableSorting:!1,enableFiltering:!1,minWidth:65,visible:!1,cellTemplate:"app/services/globals/grid_tpls/person/county_name_tpl.html"},{displayName:"State",field:"location.stateProvinceRegion",searchGridFiltersName:"locationStateProvinceRegion",minWidth:65},{displayName:"Postal Code",field:"location.postalCode",minWidth:65,visible:!1},{displayName:"Revenue",field:"revenue",cellTemplate:"app/services/globals/grid_tpls/company/revenue_tpl.html",filters:[{condition:a.filter.GREATER_THAN,placeholder:"More Than"},{condition:a.filter.LESS_THAN,placeholder:"Less Than"}],minWidth:70},{displayName:"Employees",field:"numEmployees",cellTemplate:"app/services/globals/grid_tpls/common/number_tpl.html",filters:[{condition:a.filter.GREATER_THAN,placeholder:"More Than"},{condition:a.filter.LESS_THAN,placeholder:"Less Than"}],minWidth:100},{displayName:"C-Suite: Employees",field:"departments[6].numEmployees",name:"departments8NumEmployees",cellTemplate:"app/services/globals/grid_tpls/common/number_tpl.html",filters:[{condition:a.filter.GREATER_THAN,placeholder:"More Than"},{condition:a.filter.LESS_THAN,placeholder:"Less Than"}],enableSorting:!1,visible:!1,minWidth:100},{displayName:"Finance: Employees",field:"departments[1].numEmployees",name:"departments2NumEmployees",cellTemplate:"app/services/globals/grid_tpls/common/number_tpl.html",filters:[{condition:a.filter.GREATER_THAN,placeholder:"More Than"},{condition:a.filter.LESS_THAN,placeholder:"Less Than"}],enableSorting:!1,visible:!1,minWidth:100},{displayName:"HR: Employees",field:"departments[5].numEmployees",name:"departments7NumEmployees",cellTemplate:"app/services/globals/grid_tpls/common/number_tpl.html",filters:[{condition:a.filter.GREATER_THAN,placeholder:"More Than"},{condition:a.filter.LESS_THAN,placeholder:"Less Than"}],enableSorting:!1,visible:!1,minWidth:100},{displayName:"IT: Employees",field:"departments[0].numEmployees",name:"departments1NumEmployees",cellTemplate:"app/services/globals/grid_tpls/common/number_tpl.html",filters:[{condition:a.filter.GREATER_THAN,placeholder:"More Than"},{condition:a.filter.LESS_THAN,placeholder:"Less Than"}],enableSorting:!1,visible:!1,minWidth:100},{displayName:"Legal: Employees",field:"departments[7].numEmployees",name:"departments9NumEmployees",cellTemplate:"app/services/globals/grid_tpls/common/number_tpl.html",filters:[{condition:a.filter.GREATER_THAN,placeholder:"More Than"},{condition:a.filter.LESS_THAN,placeholder:"Less Than"}],enableSorting:!1,visible:!1,minWidth:100},{displayName:"Marketing: Employees",field:"departments[2].numEmployees",name:"departments3NumEmployees",cellTemplate:"app/services/globals/grid_tpls/common/number_tpl.html",filters:[{condition:a.filter.GREATER_THAN,placeholder:"More Than"},{condition:a.filter.LESS_THAN,placeholder:"Less Than"}],enableSorting:!1,visible:!1,minWidth:100},{displayName:"Sales: Employees",field:"departments[4].numEmployees",name:"departments5NumEmployees",cellTemplate:"app/services/globals/grid_tpls/common/number_tpl.html",filters:[{condition:a.filter.GREATER_THAN,placeholder:"More Than"},{condition:a.filter.LESS_THAN,placeholder:"Less Than"}],enableSorting:!1,visible:!1,minWidth:100},{displayName:"TEDD: Employees",field:"departments[3].numEmployees",name:"departments4NumEmployees",cellTemplate:"app/services/globals/grid_tpls/common/number_tpl.html",filters:[{condition:a.filter.GREATER_THAN,placeholder:"More Than"},{condition:a.filter.LESS_THAN,placeholder:"Less Than"}],enableSorting:!1,visible:!1,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/common/date_only_tpl.html",displayName:"Records Added",field:"recordAddedDate",enableFiltering:!1,enableSorting:!0,visible:!1,minWidth:130},{displayName:"Actions",cellTemplate:"app/services/globals/grid_tpls/company/actions_tpl.html",field:"actions",enableColumnResizing:!1,enableFiltering:!1,enableHiding:!1,enableSorting:!1,pinnedRight:!0,minWidth:b?100:150}]}function e(){return[{cellTemplate:"app/services/globals/grid_tpls/company/t2_name_tpl.html",displayName:"Company",enableFiltering:!0,field:"name",minWidth:140,pinnedLeft:!0},{displayName:"Phone",enableFiltering:!1,enableSorting:!1,field:"hqPhoneNumber",minWidth:130},{cellTemplate:"app/services/globals/grid_tpls/company/website_tpl.html",displayName:"Website",enableFiltering:!0,field:"websiteUrl",enableSorting:!1,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/company/industry_tpl.html",displayName:"Industry",enableFiltering:!0,field:"primaryIndustryName",minWidth:100},{displayName:"Street Address",enableFiltering:!0,field:"hqStreetAddress1",minWidth:75,enableSorting:!1,visible:!1},{displayName:"City",enableFiltering:!0,field:"hqCityName",minWidth:75},{displayName:"County",field:"hqCountyName",enableSorting:!1,enableFiltering:!1,minWidth:65,visible:!1},{displayName:"State",enableFiltering:!0,field:"hqStateName",minWidth:65},{displayName:"Postal Code",enableFiltering:!0,field:"hqPostalCode",minWidth:65,visible:!1},{displayName:"Revenue",enableFiltering:!0,field:"revenue",cellFilter:"revenueNumber",filters:[{condition:a.filter.GREATER_THAN,placeholder:"More Than"},{condition:a.filter.LESS_THAN,placeholder:"Less Than"}],minWidth:70},{displayName:"Employees",enableFiltering:!0,field:"numEmployees",cellTemplate:"app/services/globals/grid_tpls/common/number_tpl.html",filters:[{condition:a.filter.GREATER_THAN,placeholder:"More Than"},{condition:a.filter.LESS_THAN,placeholder:"Less Than"}],minWidth:100}]}function f(b){return[{cellTemplate:"app/services/globals/grid_tpls/common/date_tpl.html",displayName:"Last Uploaded",field:"lastUploadDate",enableSorting:!0,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/company/name_tpl.html",displayName:"Company",field:"name",minWidth:140,pinnedLeft:!0},{displayName:"Phone",enableFiltering:!1,field:"mainPhoneNumber",minWidth:130},{cellTemplate:"app/services/globals/grid_tpls/company/website_tpl.html",displayName:"Website",field:"websiteUrl",minWidth:100},{displayName:"Industry",field:"industry.name",minWidth:100},{displayName:"City",field:"location.city",minWidth:75},{displayName:"State",field:"location.stateProvinceRegion",minWidth:65},{displayName:"Revenue",field:"revenue",cellTemplate:"app/services/globals/grid_tpls/company/revenue_tpl.html",minWidth:70},{displayName:"Employees",field:"numEmployees",cellTemplate:"app/services/globals/grid_tpls/common/number_tpl.html",filters:[{condition:a.filter.GREATER_THAN,placeholder:"More Than"},{condition:a.filter.LESS_THAN,placeholder:"Less Than"}],minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/common/date_only_tpl.html",displayName:"Records Added",field:"recordAddedDate",enableFiltering:!1,enableSorting:!0,visible:!1,minWidth:130},{displayName:"Actions",cellTemplate:"app/services/globals/grid_tpls/company/actions_tpl.html",field:"actions",enableColumnResizing:!1,enableFiltering:!1,enableHiding:!1,enableSorting:!1,pinnedRight:!0,minWidth:b?100:150}]}function g(){var a=[{field:"fullName",displayName:"Employee",cellTemplate:"app/services/globals/grid_tpls/person/t2_name_tpl.html",enableHiding:!1,minWidth:135},{cellTemplate:"app/services/globals/grid_tpls/person/departments_tpl.html",displayName:"Department",enableColumnResizing:!0,field:"departments",enableFiltering:!1,minWidth:135},{field:"title",displayName:"Title",cellTemplate:"app/services/globals/grid_tpls/person/title_tpl.html",enableColumnResizing:!0,minWidth:135},{field:"jobFunction",visible:!1,enableFiltering:!1,displayName:"Job Function",cellTemplate:"app/services/globals/grid_tpls/person/job_function_tpl.html",enableColumnResizing:!0,minWidth:135},{field:"email",displayName:"Email Address",cellTemplate:"app/services/globals/grid_tpls/person/email_tpl.html",enableColumnResizing:!0,minWidth:135},{field:"mobileTelNumber",enableFiltering:!1,displayName:"Potential Direct Dial",cellTemplate:"app/services/globals/grid_tpls/person-tier-two/direct_phone_tpl.html",enableColumnResizing:!0,pinnedRight:!0,minWidth:135,enableSorting:!1}];return E(a),a}function h(a,b,c){return[{cellTemplate:"app/services/globals/grid_tpls/person/name_tpl.html",displayName:"Employee",enableHiding:!1,field:"fullName",pinnedLeft:!0,minWidth:140},{cellTemplate:"app/services/globals/grid_tpls/person/company_name_tpl.html",displayName:"Company",field:"company.name",visible:a,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/person/departments_tpl.html",displayName:"Department",field:"departments",enableFiltering:!1,minWidth:100},{displayName:"Title",cellTemplate:"app/services/globals/grid_tpls/person/title_tpl.html",field:"title",minWidth:125},{cellTemplate:"app/services/globals/grid_tpls/person/job_function_tpl.html",displayName:"Job Function",field:"jobFunction",minWidth:140,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/person/reports_to_tpl.html",displayName:"Reports to",field:"reportsTo.fullName",searchGridFiltersName:"reportsToFullName",enableSorting:!b,minWidth:100,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/person/street_address_tpl.html",displayName:"Street Address",field:"location.streetAddress",minWidth:75,enableSorting:!1,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/person/city_tpl.html",displayName:"City",field:"location.city",minWidth:75,visible:!1},{displayName:"County",field:"location.countyName",enableSorting:!1,enableFiltering:!1,minWidth:65,visible:!1,cellTemplate:"app/services/globals/grid_tpls/person/county_name_tpl.html"},{cellTemplate:"app/services/globals/grid_tpls/person/state_tpl.html",displayName:"State",field:"location.stateProvinceRegion",searchGridFiltersName:"locationStateProvinceRegion",minWidth:65,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/person/postal_code_tpl.html",displayName:"Postal Code",field:"location.postalCode",minWidth:65,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/person/country_tpl.html",displayName:"Country",field:"location.countryName",searchGridFiltersName:"locationCountryName",minWidth:65,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/person/email_tpl.html",displayName:"Work Email",field:"email",visible:!0,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/person/email_tpl.html",displayName:"Personal Email",field:"personalEmail",visible:!1,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/person/direct_phone_tpl.html",displayName:"Direct Phone",enableFiltering:!1,field:"officeTelNumber",visible:!0,minWidth:115},{cellTemplate:"app/services/globals/grid_tpls/person/mobile_phone_tpl.html",displayName:"Mobile Phone",enableFiltering:!1,field:"mobileTelNumber",visible:!0,minWidth:115},{displayName:"LinkedIn",cellTemplate:"app/services/globals/grid_tpls/social/linkedin_tpl.html",field:"linkedInUrl",enableColumnResizing:!1,enableFiltering:!1,enableSorting:!1,minWidth:90,visible:!c},{displayName:"Twitter",cellTemplate:"app/services/globals/grid_tpls/social/twitter_tpl.html",field:"twitterHandle",enableColumnResizing:!1,enableFiltering:!1,enableSorting:!1,minWidth:90,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/common/date_only_tpl.html",displayName:"Records Added",field:"recordAddedDate",enableFiltering:!1,enableSorting:!0,visible:!1,minWidth:130},{displayName:"Actions",cellTemplate:"app/services/globals/grid_tpls/person/actions_tpl.html",field:"actions",enableColumnResizing:!1,enableFiltering:!1,enableHiding:!1,enableSorting:!1,pinnedRight:!0,minWidth:c?100:160,name:"actions"}]}function i(b,d,e){return[{cellTemplate:"app/services/globals/grid_tpls/person/name_tpl.html",displayName:"Employee",enableHiding:!1,field:"fullName",pinnedLeft:!e,minWidth:140},{cellTemplate:"app/services/globals/grid_tpls/person/departments_tpl.html",displayName:"Department",field:"departments",enableFiltering:!1,minWidth:100},{displayName:"Title",cellTemplate:"app/services/globals/grid_tpls/person/title_tpl.html",field:"title",minWidth:125},{cellTemplate:"app/services/globals/grid_tpls/person/job_function_tpl.html",displayName:"Job Function",field:"jobFunction",minWidth:140,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/person/reports_to_tpl.html",displayName:"Reports to",field:"reportsTo.fullName",searchGridFiltersName:"reportsToFullName",enableSorting:!b,minWidth:100,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/person/street_address_tpl.html",displayName:"Street Address",field:"location.streetAddress",minWidth:75,enableSorting:!1,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/person/city_tpl.html",displayName:"City",field:"location.city",minWidth:75,visible:!1},{displayName:"County",field:"location.countyName",enableSorting:!1,enableFiltering:!1,minWidth:65,visible:!1,cellTemplate:"app/services/globals/grid_tpls/person/county_name_tpl.html"},{cellTemplate:"app/services/globals/grid_tpls/person/state_tpl.html",displayName:"State",field:"location.stateProvinceRegion",searchGridFiltersName:"locationStateProvinceRegion",minWidth:65,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/person/postal_code_tpl.html",displayName:"Postal Code",field:"location.postalCode",minWidth:65,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/person/country_tpl.html",displayName:"Country",field:"location.countryName",searchGridFiltersName:"locationCountryName",minWidth:65,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/person/email_tpl.html",displayName:"Work Email",field:"email",visible:!0,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/person/email_tpl.html",displayName:"Personal Email",field:"personalEmail",visible:!1,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/person/direct_phone_tpl.html",displayName:"Direct Phone",enableFiltering:!1,field:"officeTelNumber",visible:!0,minWidth:115},{cellTemplate:"app/services/globals/grid_tpls/person/mobile_phone_tpl.html",displayName:"Mobile Phone",enableFiltering:!1,field:"mobileTelNumber",visible:!0,minWidth:115},{displayName:"LinkedIn",cellTemplate:"app/services/globals/grid_tpls/social/linkedin_tpl.html",field:"linkedInUrl",enableColumnResizing:!1,enableFiltering:!1,enableSorting:!0,filter:{term:"",type:a.filter.SELECT,selectOptions:[{value:"HAS",label:"Has"},{value:"DOES_NOT_HAVE",label:"Does not have"}]},minWidth:90,visible:!d,sortingAlgorithm:c},{displayName:"Twitter",cellTemplate:"app/services/globals/grid_tpls/social/twitter_tpl.html",field:"twitterHandle",enableColumnResizing:!1,enableFiltering:!1,enableSorting:!0,filter:{term:"",type:a.filter.SELECT,selectOptions:[{value:"HAS",label:"Has"},{value:"DOES_NOT_HAVE",label:"Does not have"}]},minWidth:90,visible:!1,sortingAlgorithm:c},{cellTemplate:"app/services/globals/grid_tpls/common/date_only_tpl.html",displayName:"Records Added",field:"recordAddedDate",enableFiltering:!1,enableSorting:!0,visible:!1,minWidth:130},{displayName:"Actions",cellTemplate:"app/services/globals/grid_tpls/person/actions_tpl.html",field:"actions",enableColumnResizing:!1,enableFiltering:!1,enableHiding:!1,enableSorting:!1,pinnedRight:!0,minWidth:d?100:160,name:"actions"}]}function j(){return[{cellTemplate:"app/services/globals/grid_tpls/person/t2_name_tpl.html",displayName:"Employee",enableHiding:!1,field:"fullName",pinnedLeft:!0,minWidth:140},{cellTemplate:I+"company_name_tpl.html",displayName:"Company",field:"company.name",minWidth:100},{displayName:"Type",headerCellTemplate:'<div role="columnheader" ng-class="{ \'sortable\': sortable, \'ui-grid-header-cell-last-col\': isLastCol }" ui-grid-one-bind-aria-labelledby-grid="col.uid + \'-header-text \' + col.uid + \'-sortdir-text\'" aria-sort="{{col.sort.direction == asc ? \'ascending\' : ( col.sort.direction == desc ? \'descending\' : (!col.sort.direction ? \'none\' : \'other\'))}}">  <div role="button" tabindex="0" ng-keydown="handleKeyDown($event)" class="ui-grid-cell-contents ui-grid-header-cell-primary-focus" col-index="renderIndex" title="TOOLTIP">    <span class="ui-grid-header-cell-label" ui-grid-one-bind-id-grid="col.uid + \'-header-text\'" uib-tooltip="Company Record Type" tooltip-append-to-body="true">{{ col.displayName CUSTOM_FILTERS }}</span></div><div role="button" tabindex="0" ui-grid-one-bind-id-grid="col.uid + \'-menu-button\'" class="ui-grid-column-menu-button"  ng-if="grid.options.enableColumnMenus && !col.isRowHeader  && col.colDef.enableColumnMenu !== false" ng-click="toggleMenu($event)" ng-keydown="headerCellArrowKeyDown($event)" ui-grid-one-bind-aria-label="i18n.headerCell.aria.columnMenuButtonLabel" aria-haspopup="true"><i class="ui-grid-icon-angle-down" aria-hidden="true"></i></div><div ui-grid-filter></div></div>',cellTemplate:I+"company_type_tpl.html",field:"company.tier",enableFiltering:!0,filterHeaderTemplate:'<div class="ui-grid-filter-container" ng-repeat="colFilter in col.filters"><company-tier-option col-filter="colFilter"></company-type-option></div></div>',enableSorting:!1,enableColumnResizing:!1,width:60,minWidth:60},{cellTemplate:"app/services/globals/grid_tpls/person/departments_tpl.html",displayName:"Department",field:"departments",enableFiltering:!1,minWidth:100},{displayName:"Title",field:"title",minWidth:125},{cellTemplate:I+"job_function_tpl.html",displayName:"Job Function",field:"jobFunction",minWidth:140,visible:!1},{displayName:"Street Address",field:"company.location.streetAddress1",minWidth:75,enableFiltering:!1,enableSorting:!1,visible:!1},{displayName:"City",field:"company.location.city",minWidth:75,visible:!1},{displayName:"County",field:"company.location.countyName",enableSorting:!1,enableFiltering:!1,minWidth:65,visible:!1},{displayName:"State",field:"company.location.stateProvinceRegion",minWidth:65,visible:!1},{displayName:"Postal Code",field:"company.location.postalCode",minWidth:65,visible:!1},{displayName:"Country",field:"company.location.countryName",minWidth:65,visible:!1},{cellTemplate:"app/services/globals/grid_tpls/person/email_tpl.html",displayName:"Email Address",field:"email",enableSorting:!1,visible:!0,minWidth:100},{displayName:"LinkedIn",cellTemplate:"app/services/globals/grid_tpls/social/linkedin_tpl.html",field:"linkedInUrl",enableColumnResizing:!1,enableFiltering:!1,enableSorting:!1,minWidth:90},{cellTemplate:I+"direct_phone_tpl.html",displayName:"Potential Direct Dial",enableSorting:!1,enableFiltering:!1,field:"directDialNumber",visible:!0,minWidth:115}]}function k(a,b){return[{cellTemplate:"app/services/globals/grid_tpls/common/date_tpl.html",displayName:"Last Uploaded",field:"lastUploadDate",enableSorting:!0,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/person/name_tpl.html",
displayName:"Employee",enableHiding:!1,field:"fullName",pinnedLeft:!0,minWidth:140},{cellTemplate:"app/services/globals/grid_tpls/person/company_name_tpl.html",displayName:"Company",field:"company.name",visible:a,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/person/departments_tpl.html",displayName:"Department",field:"departments",enableFiltering:!1,minWidth:100},{displayName:"Title",cellTemplate:"app/services/globals/grid_tpls/person/title_tpl.html",field:"title",minWidth:125},{cellTemplate:"app/services/globals/grid_tpls/person/job_function_tpl.html",displayName:"Job Function",field:"jobFunction",minWidth:140},{cellTemplate:"app/services/globals/grid_tpls/person/reports_to_tpl.html",displayName:"Reports to",field:"reportsTo.fullName",visible:!1,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/person/city_tpl.html",displayName:"City",field:"location.city",minWidth:75,visible:!b},{cellTemplate:"app/services/globals/grid_tpls/person/state_tpl.html",displayName:"State",field:"location.stateProvinceRegion",minWidth:65},{cellTemplate:"app/services/globals/grid_tpls/person/country_tpl.html",displayName:"Country",field:"location.countryName",minWidth:65},{cellTemplate:"app/services/globals/grid_tpls/person/email_tpl.html",displayName:"Work Email",field:"email",visible:!1,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/person/email_tpl.html",displayName:"Personal Email",field:"personalEmail",visible:!1,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/person/direct_phone_tpl.html",displayName:"Direct Phone",enableFiltering:!1,field:"officeTelNumber",visible:!1,minWidth:115},{cellTemplate:"app/services/globals/grid_tpls/person/mobile_phone_tpl.html",displayName:"Mobile Phone",enableFiltering:!1,field:"mobileTelNumber",visible:!0,minWidth:115},{displayName:"LinkedIn",cellTemplate:"app/services/globals/grid_tpls/social/linkedin_tpl.html",field:"linkedInUrl",enableColumnResizing:!1,enableFiltering:!1,enableSorting:!0,filter:{},minWidth:50,visible:!b,sortingAlgorithm:c},{displayName:"Twitter",cellTemplate:"app/services/globals/grid_tpls/social/twitter_tpl.html",field:"twitterHandle",enableColumnResizing:!1,enableFiltering:!1,enableSorting:!0,filter:{},minWidth:50,visible:!b,sortingAlgorithm:c},{cellTemplate:"app/services/globals/grid_tpls/common/date_only_tpl.html",displayName:"Records Added",field:"recordAddedDate",enableFiltering:!1,enableSorting:!0,visible:!1,minWidth:130},{displayName:"Actions",cellTemplate:"app/services/globals/grid_tpls/person/actions_tpl.html",field:"actions",enableColumnResizing:!1,enableFiltering:!1,enableHiding:!1,enableSorting:!1,pinnedRight:!0,minWidth:b?100:160,name:"actions"}]}function l(){return[{cellTemplate:H,displayName:"Employee",enableHiding:!1,field:"fullName",pinnedLeft:!0,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/person/reported_to_tpl.html",displayName:"Reported to",field:"reportsTo.fullName",visible:!0,minWidth:100},{cellTemplate:H,displayName:"Title",field:"title",minWidth:125},{cellTemplate:H,displayName:"Street Address",field:"location.streetAddress",minWidth:125,enableSorting:!1,visible:!1},{cellTemplate:H,displayName:"City",field:"location.city",minWidth:75},{displayName:"County",field:"location.countyName",enableSorting:!1,enableFiltering:!1,minWidth:65,visible:!1,cellTemplate:"app/services/globals/grid_tpls/person/county_name_tpl.html"},{cellTemplate:H,displayName:"State",field:"location.stateProvinceRegion",minWidth:65},{cellTemplate:H,displayName:"Postal Code",field:"location.postalCode",minWidth:65,visible:!1},{cellTemplate:H,displayName:"Country",field:"location.countryName",visible:!1,minWidth:65},{cellTemplate:"app/services/globals/grid_tpls/person/email_tpl.html",displayName:"Personal Email",field:"personalEmail",visible:!0,minWidth:100},{cellTemplate:"app/services/globals/grid_tpls/person/mobile_phone_tpl.html",displayName:"Mobile Phone",enableFiltering:!1,field:"mobileTelNumber",visible:!0,minWidth:115},{displayName:"LinkedIn",cellTemplate:"app/services/globals/grid_tpls/social/linkedin_tpl.html",field:"linkedInUrl",enableColumnResizing:!1,enableFiltering:!1,enableSorting:!0,filter:{},minWidth:50,sortingAlgorithm:c},{displayName:"Twitter",cellTemplate:"app/services/globals/grid_tpls/social/twitter_tpl.html",field:"twitterHandle",enableColumnResizing:!1,enableFiltering:!1,enableSorting:!0,filter:{},minWidth:50,sortingAlgorithm:c}]}function m(){return[{field:"firstName"},{field:"lastName"},{cellTemplate:"app/services/globals/grid_tpls/userManager/email.tpl.html",field:"email"},{cellTemplate:"app/services/globals/grid_tpls/userManager/date_tpl.html",displayName:"Last Activity Date",enableFiltering:!1,field:"lastActivityTime",minWidth:125},{cellTemplate:"app/services/globals/grid_tpls/userManager/date_tpl.html",displayName:"Activated",enableFiltering:!1,field:"lastActivatedTime",minWidth:125},{cellTemplate:"app/services/globals/grid_tpls/userManager/date_tpl.html",displayName:"Registration Sent",enableFiltering:!1,field:"lastRegRequestTime",minWidth:125},{field:"title"},{field:"state",displayName:"Status",cellTemplate:"app/services/globals/grid_tpls/userManager/status_tpl.html",enableFiltering:!1,width:150},{cellTemplate:"app/services/globals/grid_tpls/userManager/edit_tpl.html",enableColumnResizing:!1,enableFiltering:!1,enableHiding:!1,enableSorting:!1,field:"actions",width:100}]}function n(){return[{cellTemplate:"app/services/globals/grid_tpls/common/date_only_tpl.html",displayName:"Date Published",field:"publishDate",enableFiltering:!0,enableSorting:!0,filters:[{type:"date",condition:a.filter.DATE_GREATER_THAN,placeholder:"After"},{type:"date",condition:a.filter.DATE_LESS_THAN,placeholder:"Before"}],minWidth:180},{cellTemplate:"app/services/globals/grid_tpls/person/company_name_tpl.html",displayName:"Company",field:"companyName",minWidth:200},{cellTemplate:'<div class="ui-grid-cell-contents"><span ng-bind-html="row.entity.article"></span><span ng-if="row.entity.link && row.entity.title"> (<a ng-href="{{row.entity.link}}" target="_blank">{{row.entity.title}}</a>)</span></div>',displayName:"Description",enableFiltering:!1,enableSorting:!1,field:"article",minWidth:500,width:700},{cellTemplate:"app/services/globals/grid_tpls/intel/categories_tpl.html",displayName:b.findFeatureFlag(null,"triggerstoscoops")?"Topics":"Categories",enableFiltering:!1,field:"intelCategoriesName",minWidth:175},{displayName:"Type",field:"typeId",enableFiltering:!1,filter:{term:"",type:a.filter.SELECT,selectOptions:[{value:1,label:"Personnel"},{value:2,label:"Project"}]},minWidth:100}]}function o(){return[{displayName:"Name",field:"name",minWidth:130},{displayName:"Source Type",field:"sourceTypeNameDisplay",minWidth:50},{cellTemplate:"app/services/globals/grid_tpls/subscription/source_list_tpl.html",displayName:"Source List",field:"sourceListName",minWidth:50},{displayName:"Delivery Period",field:"scheduleTypeName",minWidth:50},{displayName:"Subjects",field:"subscriptionTypeName",minWidth:50},{displayName:"Actions",cellTemplate:"app/services/globals/grid_tpls/subscription/actions_tpl.html",field:"actions",enableColumnResizing:!1,enableFiltering:!1,enableHiding:!1,enableSorting:!1,pinnedRight:!0,minWidth:45}]}function p(){return[{cellTemplate:"app/services/globals/grid_tpls/person/company_name_tpl.html",displayName:"Company",field:"company.name",minWidth:200},{cellTemplate:"app/services/globals/grid_tpls/intel/date_tpl.html",displayName:"Updated Date",field:"eventTime",minWidth:120,sort:{direction:a.DESC}},{displayName:"Changed Field",field:"detail.field",minWidth:130},{displayName:"Previous Value",field:"detail.origValue",minWidth:130},{displayName:"Updated Value",field:"detail.newValue",minWidth:130}]}function q(){return[{cellTemplate:"app/services/globals/grid_tpls/alert/person_name_tpl.html",displayName:"Employee",enableHiding:!1,field:"person.fullName",pinnedLeft:!0,minWidth:200},{cellTemplate:"app/services/globals/grid_tpls/intel/date_tpl.html",displayName:"Updated Date",field:"eventTime",minWidth:120,sort:{direction:a.DESC}},{cellTemplate:"app/services/globals/grid_tpls/person/company_name_tpl.html",displayName:"Company",field:"company.name",minWidth:200},{displayName:"Changed Field",field:"detail.field",minWidth:130},{displayName:"Previous Value",field:"detail.origValue",minWidth:130},{displayName:"Updated Value",field:"detail.newValue",minWidth:130}]}function r(){return[{cellTemplate:'<div class="ui-grid-cell-contents {{row.entity._class}}" title="{{COL_FIELD}}">{{COL_FIELD}}</div>',cellTooltip:!0,displayName:"Match Name",enableFiltering:!1,field:"displayName",sort:{direction:a.ASC,priority:2}},{cellTemplate:'<div class="ui-grid-cell-contents {{row.entity._class}}" title="{{COL_FIELD}}">{{COL_FIELD}}</div>',cellTooltip:!0,displayName:"Matched Term",enableFiltering:!1,field:"term",sort:{direction:a.ASC,priority:1}},{field:"_class",visible:!1,sort:{direction:a.DESC,priority:0}}]}function s(){return[{displayName:"DATE",field:"issueDate",minWidth:90,maxWidth:90,enableHiding:!1,enableFiltering:!1,cellTemplate:"app/services/globals/grid_tpls/top-content/weekEnding_tpl.html"},{displayName:"COMPANY",field:"companyName",minWidth:104,enableFiltering:!1,enableHiding:!1,cellTemplate:"app/services/globals/grid_tpls/top-content/name_tpl.html"},{displayName:"CATEGORY",field:"categoryName",minWidth:100,maxWidth:250,enableHiding:!1,enableFiltering:!1,cellClass:"break-word",cellTemplate:'<div title="{{ COL_FIELD }}" class="ui-grid-cell-contents topic-cell"><span class="topic topic-name">{{ COL_FIELD }}</span></div>'},{displayName:"TOPIC(S)",field:"topicName",minWidth:120,maxWidth:300,enableHiding:!1,enableFiltering:!1,cellClass:"break-word",cellTemplate:"app/services/globals/grid_tpls/top-content/topic_tpl.html"},{displayName:"SIGNAL SCORE",headerCellTemplate:'<div role="columnheader" class="signal-core" ng-class="{ \'sortable\': sortable, \'ui-grid-header-cell-last-col\': isLastCol }" ui-grid-one-bind-aria-labelledby-grid="col.uid + \'-header-text \' + col.uid + \'-sortdir-text\'" aria-sort="{{col.sort.direction == asc ? \'ascending\' : ( col.sort.direction == desc ? \'descending\' : (!col.sort.direction ? \'none\' : \'other\'))}}">  <div role="button" tabindex="0" ng-keydown="handleKeyDown($event)" class="ui-grid-cell-contents ui-grid-header-cell-primary-focus" col-index="renderIndex" title="TOOLTIP">    <span class="ui-grid-header-cell-label" ui-grid-one-bind-id-grid="col.uid + \'-header-text\'">{{ col.displayName CUSTOM_FILTERS }}<i class="fa fa-info-circle surge-score-column-header-tooltip-icon" uib-tooltip-template="\'app/views/topcontentconsumer/partials/surge-score-column-header-tooltip.html\'" tooltip-placement="top" tooltip-class="oppalert-surge-score-column-header-tooltip" tooltip-append-to-body="true"></i></span><span ui-grid-one-bind-id-grid="col.uid + \'-sortdir-text\'" ui-grid-visible="col.sort.direction" aria-label="{{getSortDirectionAriaLabel()}}"><i ng-class="{ \'ui-grid-icon-up-dir\': col.sort.direction == asc, \'ui-grid-icon-down-dir\': col.sort.direction == desc, \'ui-grid-icon-blank\': !col.sort.direction }" title="{{isSortPriorityVisible() ? i18n.headerCell.priority + \' \' + ( col.sort.priority + 1 )  : null}}" aria-hidden="true"></i><sub ui-grid-visible="isSortPriorityVisible()" class="ui-grid-sort-priority-number">{{col.sort.priority + 1}}</sub></span></div><div role="button" tabindex="0" ui-grid-one-bind-id-grid="col.uid + \'-menu-button\'" class="ui-grid-column-menu-button"  ng-if="grid.options.enableColumnMenus && !col.isRowHeader  && col.colDef.enableColumnMenu !== false" ng-click="toggleMenu($event)" ng-keydown="headerCellArrowKeyDown($event)" ui-grid-one-bind-aria-label="i18n.headerCell.aria.columnMenuButtonLabel" aria-haspopup="true"><i class="ui-grid-icon-angle-down" aria-hidden="true"></i></div><div ui-grid-filter></div></div>',field:"score",minWidth:115,enableHiding:!1,enableFiltering:!1,sortDirectionCycle:[null,a.DESC,a.ASC]},{displayName:"TREND",field:"trend",minWidth:115,enableHiding:!1,enableFiltering:!1,cellTemplate:"app/services/globals/grid_tpls/top-content/trend_tpl.html"},{displayName:"RECOMMENDED CONTACTS",field:"bestContact",minWidth:200,enableColumnMenu:!1,enableFiltering:!1,cellTemplate:"app/services/globals/grid_tpls/top-content/bestContacts_tpl.html",enableSorting:!1}]}function t(){return[{displayName:"NO.",field:"rowNum",enableHiding:!1,enableFiltering:!1,enableColumnMenu:!1,enableSorting:!1,cellTemplate:"app/services/globals/grid_tpls/common/row_number_tpl.html",minWidth:50,width:50},{displayName:"TOPIC",field:"topicName",enableHiding:!1,enableFiltering:!1,enableColumnMenu:!1},{displayName:"CATEGORY",field:"categoryName",enableHiding:!1,enableFiltering:!1,enableColumnMenu:!1},{displayName:"DATE ADDED",field:"addedDate",enableHiding:!1,enableFiltering:!1,cellFilter:"date:'M/d/yyyy'",enableColumnMenu:!1},{displayName:"DATE REMOVED",field:"removedDate",enableHiding:!0,enableFiltering:!1,enableColumnMenu:!1,cellFilter:"date:'M/d/yyyy'"},{displayName:"ADDED BY",field:"addedByUserName",enableHiding:!0,enableFiltering:!1,enableColumnMenu:!1}]}function u(){return{persons:null,companies:null,intel:null,tierTwoCompanies:null,tierTwoPersons:null}}function v(){return{companies:!1,persons:!1,intel:!1,tierTwoCompanies:!1,tierTwoPersons:!1}}function w(){return{intel:[],companies:[],persons:[],tierTwoCompanies:[],tierTwoPersons:[]}}function x(){return{intel:{},companies:{},persons:{},tierTwoCompanies:{},tierTwoPersons:{}}}function y(a){switch(a){case"intel":return"Researcher Verified Scoops";case"companies":return"Researcher Verified Companies";case"tierTwoCompanies":return"Technology Generated Companies";case"tierTwoPersons":return"Technology Generated Employees";default:return"Researcher Verified Employees"}}function z(a){switch(a){case"intel":return"Intel";case"companies":return"Company";case"tierTwoCompanies":return"TierTwoCompany";case"tierTwoPersons":return"TierTwoPerson";default:return"Person"}}function A(a){switch(a){case"intel":return"Scoops";case"companies":return"Companies";case"tierTwoCompanies":return"Tech Gen Companies";case"tierTwoPersons":return"Tech Gen Employees";default:return"Employees"}}function B(a){switch(a){case"intel":return"intelReportList";case"companies":return"companyList";case"tierTwoCompanies":return"tierTwoCompanyList";case"tierTwoPersons":return"tierTwoPersonList";default:return"personList"}}function C(a){switch(a){case"intel":return"intel";case"companies":return"company";case"tierTwoCompanies":return"tierTwoCompany";case"tierTwoPersons":return"tierTwoPerson";default:return"person"}}function D(a,b,c,d){return c||(d=null),{page:a||null,size:b||null,sortField:c||null,sortOrder:d||null}}function E(b){for(var c=0;c<b.length;++c)b[c].enableColumnMenu=!1,b[c].cellTooltip=!0,b[c].filter||(b[c].filter={condition:a.filter.CONTAINS});return b}function F(a){return a?"RESEARCHER_VERIFIED_SEARCH_TAB":"TIER_2_SEARCH_TAB"}function G(a){switch(a){case"havingMobilePhone":return"HAS_MOBILE_PHONE";case"havingPersonalEmail":return"HAS_PERSONAL_EMAIL";default:return null}}var H="app/services/globals/grid_tpls/recently-left-employee/recently-left-employee.tpl.html",I="app/services/globals/grid_tpls/person-tier-two/";return{followCompany:d,uploadCompany:f,followPerson:h,currentPerson:i,uploadPerson:k,recentlyLeftEmployee:l,userManager:m,intelResults:n,subscription:o,alertCompany:p,alertPerson:q,bulkMatch:r,topContent:s,customerOppalertTopics:t,tierTwoPerson:j,tierTwoCompany:e,searchDefaultsToNull:u,searchDefaultsToFalse:v,searchDefaultsToEmptyArray:w,searchDefaultsToEmptyObjects:x,getRadioTrackEventType:G,getSearchName:z,getSearchTrackingTab:F,getSearchPluralName:A,getSingularListName:B,getSingularName:C,getTypeName:y,searchGridParams:D,getCurrentEmployeeDetailColumnConfig:g}}a.$inject=["uiGridConstants","featureFlagService"],angular.module("dorgEuiApp").service("searchGridTemplateService",a)}(),angular.module("dorgEuiApp").service("singleModalService",["$uibModal",function(a){var b,c="open-more-single-modal";return{open:function(d){if(b){var e=b;e.opened.then(function(){e.dismiss(c)})}return b=a.open(d),b.result.then(function(){b=void 0}).catch(function(a){a!==c&&(b=void 0)}),b}}}]),function(){"use strict";function a(){function a(a){var b,c,d="",e=[""],f=[e],g=0,h=0,i=!0;for(b in a)c=a[b],'"'===c?(i&&c===d&&(e[g]+=c),i=!i):","===c&&i?c=e[++g]="":"\n"===c&&i?("\r"===d&&(e[g]=e[g].slice(0,-1)),e=f[++h]=[c=""],g=0):e[g]+=c,d=c;return f}function b(a){var b=document.createElement("textarea");return b.innerHTML=a,b.value}return{csvToArray:a,decodeHtml:b}}a.$inject=[],angular.module("dorgEuiApp").service("stringUtil",a)}(),function(){"use strict";function a(){function a(a,b){var c=[];b=b||e.genRegex;do{var d=b.exec(a);d&&c.push(d[0])}while(d);return _.uniq(c).join(", ")}function b(a){return a?f[a.toLowerCase()]:""}function c(){return f}function d(a,b){var c=new RegExp(b);return c.test(a)}var e=this,f={notempty:"This field is required",pattern:"Invalid characters were detected"};e.allowPhoneCharactersRegex=/^([\d|\-|\s|\.\+|\(|\)])*$/g,e.emailRegex=/^.+@.+/g,e.genRegex=/^[=+*@]/g,e.internationalPhoneBasic=/(?:\d.*){7,}$/g,e.nameRegex=/[^\d ,\-.'"\/a-zA-Z\u00C0-\u00FF]/g,e.notDigitsRegex=/\D/g,e.phoneRegex=/[^+\da-z()\- \.\/:]/g,e.phoneWithTenNumberRegex=/^\d{10}$|^\d{3}-\d{3}-\d{4}$/g,e.findSpecialChars=a,e.getErrorMessage=b,e.getErrors=c,e.isValidRegex=d}a.$inject=[],angular.module("dorgEuiApp").service("dorgValidation",a)}(),function(){"use strict";function a(){function a(a,c,d){if(!a)throw new Error("please make sure to include a gridApi parameter");if(!c)throw new Error("please make sure to include a list parameter");if(!d)throw new Error("please make sure to include a function that can indicate whether to load more data");return new b(a,c,d)}function b(a,b,d){function e(){m=0}function f(){return m}function g(a){b=a,e()}function h(a){n=a}function i(a){return b.slice(a,a+n)}function j(){var a=i(m);return m+=n,a}function k(){a.infiniteScroll.resetScroll(!1,!0)}function l(){a.grid.options.data=a.grid.options.data.concat(j()),a.infiniteScroll.dataLoaded(!1,d()),a.grid.modifyRows(a.grid.options.data)}var a=a,b=b,d=d,m=0,n=c;return a.infiniteScroll.on.needLoadMoreData(null,l),{resetIndex:e,getCurrentIndex:f,setNewUnderlyingCollection:g,setPageSize:h,getNextPage:j,getPageAtIndex:i,reset:k}}var c=20;return{createNewInfiniteScroller:a}}a.$inject=[],angular.module("dorgEuiApp").factory("infiniteScrollFactory",a)}(),function(){"use strict";function a(a){function b(){return!!a.Session&&!!a.Session.authenticated}function c(){return!!b()&&!!a.Session.navigation}function d(b){return!!c()&&a.Session.navigation.$has(b)}function e(b){var c=null;return d(b)&&(c=a.Session.navigation.$href(b)),c}return{hasSession:b,hasNavigationSession:c,hasNavigationByHref:d,getNavigationUrlByHref:e}}a.$inject=["$rootScope"],angular.module("dorgEuiApp").service("navigationService",a)}(),angular.module("dorgEuiApp").service("NotificationService",["$http","$rootScope","$interval","featureFlagService","Flash","$window",function(a,b,c,d,e,f){function g(){a.get("api/rest/notifications").then(function(a){var c=a.data.unviewedListMatchResultsNotifications.length>0;b.$broadcast("listMatchNotification",{isUnviewed:c,requestType:c?a.data.unviewedListMatchResultsNotifications[0].requestType:"",unviewedListMatchResults:c?a.data.unviewedListMatchResultsNotifications:[]})})}var h=!1,i=!1,j="helpmenow@zoominfo.com";this.checkNotifications=function(){g()},this.enableCheckListMatchNotifications=function(){i=!0},c(function(){i&&(g(),h&&(i=!1))},1e4),this.handleErrorRedirectToDOZI=function(a){if(a){var b=f.atob(a),c=JSON.parse(b),d="Error "+c.code+' has occurred. Please try again or contact us at <a href="mailto:'+j+'" close-flash="">'+j+"</a> for further assistance.";e.create("error",d,"fail redirect-flash"),e.pause()}}}]),function(){"use strict";function a(){function a(a){return a=a||{},d(a.mobileTelNumber,!1)}function b(a){return a=a||{},d(a.officeTelNumber,!1)}function c(a,b){return a=a||{},a.company=a.company||{},d(a.company.mainPhoneNumber,b)}function d(a,b){var c=a||"";return c&&b?c+"*":c}function e(a,d){return a=a||{},b(a)||c(a,d)}function f(d,e){return d=d||{},b(d)||a(d)||c(d,e)}function g(c,e,f){return c=c||{},b(c)||a(c)||d(e,f)}function h(a,d){return a=a||{},b(a)||c(a,d)}return{getMobileNumberOrBlank:a,getOfficeNumberOrBlank:b,getPhoneNumberOrBlank:d,getOfficeNumberThenCompanyNumberOrBlank:e,getOfficeThenMobileThenCompanyNumberOrBlank:f,getOfficeThenCompanyNumberOrBlank:h,getOfficeThenMobileThenCompanyNumberOrBlankWithProvidedCompanyPhone:g}}a.$inject=[],angular.module("dorgEuiApp").service("phoneNumberService",a)}(),function(){"use strict";function a(a,b,c,d,e){var f={$isTrial:!1,$hasActiveCrm:!1,$hasActiveMat:!1,$hasActiveSdr:!1,$allowedLeadUpload:!1,$allowedContactUpload:!1,$allowedCompanyUpload:!1,account:null,authenticated:!1,dashboard:null,fixit:null,mapStyle:null,navigation:null,resource:null,$allowedMarketoWebhooks:!1,$allowedHubspotWebhooks:!1,$crmDisabled:!0,$matDisabled:!0,$sdrDisabled:!0,$canUploadEmaillessPersons:!1,allowedSupersetAccess:!1,search:{},oppAlertSelection:[],accessScopeCounts:{}};return{create:function(){return c.$get("api/rest").then(function(c){return f.resource=c,a.all({$account:b.get(),$navigation:e.get()}).then(function(b){return a.all({$fixit:b.$navigation.$get("fixItCategories"),$employee:b.$navigation.$get("fixItEmployeeCategories"),$company:b.$navigation.$get("fixItCompanyCategories"),$dashboard:b.$navigation.$get("viewDashboard")}).then(function(a){var c=b.$account.uuid.split(".");return f.account=b.$account,f.navigation=b.$navigation,f.$hasActiveCrm=b.$account.havingActiveCrm,f.$hasActiveMat=b.$account.havingActiveMat,f.$hasActiveSdr=b.$account.havingActiveSdr,f.$allowedMarketoWebhooks=b.$account.allowedMarketoWebhooks,f.$allowedHubspotWebhooks=b.$account.allowedHubspotWebhooks,f.$crmDisabled=b.$account.crmDisabled,f.$matDisabled=b.$account.matDisabled,f.$sdrDisabled=b.$account.sdrDisabled,f.$allowedLeadUpload=b.$account.allowedLeadUpload,f.$allowedContactUpload=b.$account.allowedContactUpload,f.$allowedCompanyUpload=b.$account.allowedCompanyUpload,f.$activeToggleToDozi=b.$account.activeToggleToDozi,f.$supportPIN=b.$account.supportPIN,f.$canUploadEmaillessPersons=b.$account.canUploadEmaillessPersons,f.fixit=a.$fixit,f.fixitemployee=a.$employee,f.fixitcompany=a.$company,f.mapStyle=d.getBaseStyle(),f.dashboard=a.$dashboard,f.allowedSupersetAccess=b.$account.allowedSupersetAccess,f.authenticated=!0,f.$isTrial=!1,b.$account.roles.length>0&&(f.$isTrial=b.$account.roles.some(function(a){return 5===a.id})),pendo.initialize({apiKey:"e95c0c55-8a01-453a-5029-e1a68991b4d8",visitor:{id:c[1],role:""},account:{id:c[0]}}),f})})})},invalidate:function(){return f.$isTrial=!1,f.$hasActiveCrm=!1,f.$hasActiveMat=!1,f.$hasActiveSdr=!1,f.authenticated=!1,f.resource=null,f.account=null,f.dashboard=null,f.navigation=null,f.fixit=null,f.mapStyle=null,f.$allowedMarketoWebhooks=!1,f.$allowedHubspotWebhooks=!1,f.$crmDisabled=!0,f.$matDisabled=!0,f.$sdrDisabled=!0,f.allowedSupersetAccess=!1,f.oppAlertsCriteria={},f.search={},f.oppAlertSelection=[],f.accessScopeCounts={},f}}}angular.module("dorgEuiApp").factory("Session",a),a.$inject=["$q","account","halClient","maps","navigation"]}(),function(){"use strict";function a(a,b){function c(c){return a.get("api/rest/thoughtindustries/courses/"+c).then(function(a){a.data.redirectUrl&&(b.location.href=a.data.redirectUrl)}).catch(function(a){console.error("Error occurred:",a.status,a.data)})}function d(c){return a.get("api/rest/thoughtindustries/externalredirect",{params:c}).then(function(a){a.data.redirectUrl&&(b.location.href=a.data.redirectUrl)}).catch(function(a){console.error("Error occurred:",a.status,a.data)})}function e(){return a.get("api/rest/thoughtindustries/externalredirect").then(function(a){a.data.redirectUrl&&(b.location.href=a.data.redirectUrl)}).catch(function(a){console.error("Error occurred:",a.status,a.data)})}return{navigateToCoursePage:c,navigateToCustomPage:d,navigateToMainPage:e}}a.$inject=["$http","$window"],angular.module("dorgEuiApp").service("thoughtindustriesService",a)}(),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("307",{url:"/307",templateUrl:"app/views/_errors/307/307.html",controller:[function(){}],resolve:{$title:function(){return"Maintenance"}},onEnter:[function(){$("header").addClass("hideHeaderContent")}],onExit:[function(){$("header").removeClass("hideHeaderContent")}]})}]),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("404",{url:"/NotFound",templateUrl:"app/views/404/404.tpl.html",resolve:{$title:function(){return"404 - Page Not Found"}}})}]),angular.module("dorgEuiApp").controller("SuppressionDeniedController",["$state","$scope",function(a,b){var c={view_person:"Employee",view_company:"Company",Employee:"Employees",Company:"Companies",Employees:"employee",Companies:"company"};b.routeType=c[a.current.name],b.routeTypePlural=c[c[a.current.name]],b.navLoc=c[c[c[a.current.name]]]}]),angular.module("dorgEuiApp").controller("RecentlyLeftAccessController",["$state","$scope","$rootScope","respData",function(a,b,c,d){var e={view_person:"Employee",view_company:"Company",Employee:"Employees",Company:"Companies"},f=d.data.split(",");b.company=f[1],b.companyId=f[2],b.routeType=e[a.current.name]}]),function(){"use strict";function a(a,b,c,d){var e=d.data.split(","),f=e.length>1?e[0]+" at "+e[1]:e[0],g={view_person:"Employee",view_company:"Company",Employee:"Employees",Company:"Companies"};b.accessName=e[0].length<1?g[a.current.name]:e[0],b.bodyLine=encodeURIComponent("I am interested in more information on how to gain access to the data set which includes "+f+"."),b.name=c.Session.account.firstName+" "+c.Session.account.lastName,b.routeType=g[a.current.name],b.routeTypePlural=g[g[a.current.name]],b.subjectLine=encodeURIComponent(b.name+" Request for Additional Access")}angular.module("dorgEuiApp").controller("AccessDeniedController",a),a.$inject=["$state","$scope","$rootScope","respData"]}(),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("418",{url:"/418",templateUrl:"app/views/418/418.html",resolve:{$title:function(){return"418 - Access Denied"}}})}]),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("503",{url:"/503",templateUrl:"app/views/_errors/503/503.html",controller:[function(){}],resolve:{$title:function(){return"Site Unavailable"}},onEnter:[function(){$("header").addClass("hideHeaderContent")}],onExit:[function(){$("header").removeClass("hideHeaderContent")}]})}]),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){function w(a){var b=[];return null==a?b:(a.forEach(function(a){b=b.concat(a.investors)}),b=_.uniq(b,"id"),_.sortBy(b,function(a){return a.fullName.toLowerCase()}))}function x(a){return gb[a]}function y(){if(0===hb.length)hb.push({followCompany:"companies"});else{var a=!1;_.forEach(hb,function(b){_.isEmpty(b.followCompany)||(a=!0)}),a||hb.push({followCompany:"companies"})}jb.gridNames=hb,jb.companies.data=jb.similarCompaniesList,jb.spinnerSimilarCom=!1}function z(a){jb.spinnerSimilarCom=!1,a===i.similarTabKey&&(jb.similarCompaniesList.length?jb.spinnerSimilarCom===!0&&f(y,250):(jb.spinnerSimilarCom=!0,i.getSimilarCompanies(fb).then(function(a){jb.similarCompaniesList=a||[],y()}))),a===i.hierarchyTabKey&&(d.$qschChildName||qa(jb.company.id))}function A(a){return _.map(a,function(a){return a.jobFunctions&&_.each(a.jobFunctions,function(b){a["jobFunction_"+b.id]=!0}),a})}function B(){if(jb.orgChartData){var a=1;C(Eb,0,0,!0);var b=Object.keys(jb.orgChartData);_.forEach(b,function(b){var c=_.find(jb.company.companyDepartments,{departmentName:b});c&&C(c.departmentName,c.departmentId,a++,jb.locked||jb.checkLockedDepartmentByName(c.departmentName))})}else{var c=1;C(Eb,0,0,!0),_.forEach(jb.company.companyDepartments,function(a){C(a.departmentName,a.departmentId,c++,jb.locked||jb.checkLockedDepartmentByName(a.departmentName))})}}function C(a,b,c,d){if(_.findIndex(jb.currentDeptList,{id:b})<0){var e={name:a,id:b,tab:c,locked:d};jb.currentDeptList.push(e)}}function D(){var a=_.filter(jb.currentDeptList,{locked:!1});1===_.size(a)&&(jb.employeesCurrentDepartmentView=a[0].id,jb.employeesCurrentDepartmentViewIdx=a[0].tab,jb.employeesCurrentDepartmentName=a[0].name,jb.viewEmpsIdx=a[0].name),jb.hasCheckedDefaultDepartmentForEmployeesTab=!0}function E(a){jb.selectedEmployees=[],jb.resposibilityMatrixSelectedEmployees=[],jb.tab!==a&&(kb=!1),jb.tab=a;var b=[];if(jb.tab===nb)void 0!==jb.orgChartData&&(b=Object.keys(jb.orgChartData),_.isEmpty(b)||(va(jb.tab,b),ua(jb.currentDepartmentName)));else if(jb.tab===pb){if(B(),va(jb.tab,jb.currentDeptList),jb.showOutOfScopeEmployees=!0,jb.employees.data=[],P(jb.employeesCurrentDepartmentView),jb.spinnerCurEmp){if(0===hb.length)hb.push({followPerson:"employees"});else{var c=!1;_.forEach(hb,function(a){_.isEmpty(a.followPerson)||(c=!0)}),c||hb.push({followPerson:"employees"})}jb.gridNames=hb}}else if(jb.tab===qb)jb.spinnerLeftEmp&&(jb.gridName="pastEmployees",jb.pastEmployees.data=jb.leftEmployees,jb.filteredEmpsLeft=K(jb.leftEmployees),ya(jb.filteredEmpsLeft),jb.spinnerLeftEmp=!1),void 0!==jb.filteredEmpsLeft&&(b=Object.keys(jb.filteredEmpsLeft),_.isEmpty(b)||(va(jb.tab,jb.filteredEmpsLeftTabs),ea(jb.employeesCurrentDepartmentName)));else if(jb.tab===rb&&(kb=!1,va(jb.tab,jb.currentDeptList),jb.responsibilityMatrix.data=[],Q(jb.employeesCurrentDepartmentView),jb.spinnerMatrix)){if(jb.orgChartData){var d=K(jb.rmEmployees);jb.filteredEmps=d}jb.responsibilityMatrix.enableFiltering=!0,jb.responsibilityMatrix.enableGridMenu=!0,jb.responsibilityMatrix.enablePaginationControls=!1,jb.responsibilityMatrix.enableRowSelection=!0,jb.responsibilityMatrix.enableSelectAll=!0,jb.responsibilityMatrix.enableSorting=!0,jb.responsibilityMatrix.multiSelect=!0,jb.responsibilityMatrix.pagesToShow=10,jb.responsibilityMatrix.paginationPageSize=angular.copy(Bb),jb.responsibilityMatrix.paginationPageSizes=[10,Bb,50,75,100],jb.responsibilityMatrix.paginationCurrentPage=1,jb.responsibilityMatrix.enableVerticalScrollbar=v.scrollbars.NEVER,jb.responsibilityMatrix.useExternalPagination=!0,jb.responsibilityMatrix.useExternalFiltering=!0,jb.responsibilityMatrix.useExternalSorting=!0,jb.responsibilityMatrix.isRowSelectable=function(a){return!a.entity.locked&&!a.entity.privacyEuRequested&&!a.entity.privacyRequested},jb.responsibilityMatrix.onRegisterApi=function(a){jb.responsibilityMatrix.api=a,a.core.on.columnVisibilityChanged(e,function(a){mb(fb,gb[jb.employeesCurrentDepartmentView],fa(),jb.responsibilityMatrix.columnDefs)}),a.core.on.rowsRendered(e,function(a){A(jb.rmEmployees);var b=0,c=a.grid.rows;jb.resposibilityMatrixSelectedEmployees.length>0&&_.each(c,function(a){var c=_.find(jb.resposibilityMatrixSelectedEmployees,function(b){return b.fullName===a.entity.fullName});c&&(a.setSelected(!0),b++)}),a.grid.selection.selectAll=b===c.length}),a.core.on.sortChanged(e,function(a,b){if(b.length>0){for(;b.length>1;)b[0].unsort(),b.shift();var c,d;_.each(b,function(a){if(a.field){var b=_.camelCase(a.field.replace(/\./g,"_"));"fullName"===b||"seniorityLevelDisplayName"===b?("seniorityLevelDisplayName"==b&&(b="seniorityLevelName"),Ua(b,a.sort.direction)):(Ua(),c=a.field,d=a.sort.direction)}}),c?jb.responsibilityMatrix.data=_.sortByOrder(jb.responsibilityMatrix.data,[c],[d]):Q(jb.employeesCurrentDepartmentView)}else jb.responsibilityMatrix.sortField?(Ua("fullName"),Q(jb.employeesCurrentDepartmentView)):jb.responsibilityMatrix.data=_.sortBy(jb.responsibilityMatrix.data,function(a){return a.fullName})}),a.colMovable.on.columnPositionChanged(e,function(a,b,c){mb(fb,gb[jb.employeesCurrentDepartmentView],fa(),jb.responsibilityMatrix.columnDefs)}),a.pagination.on.paginationChanged(e,function(a,b){var c=jb.rmPagingInfo.number;jb.rmPagingInfo.number=a-1,jb.rmSuppressRefresh?jb.rmSuppressRefresh=!1:Q(jb.employeesCurrentDepartmentView,c==jb.rmPagingInfo.number);
}),a.selection.on.rowSelectionChanged(e,function(a){a.isSelected?jb.resposibilityMatrixSelectedEmployees.push(a.entity):_.remove(jb.resposibilityMatrixSelectedEmployees,function(b){return b.fullName===a.entity.fullName})}),a.selection.on.rowSelectionChangedBatch(e,function(a){var b=_.filter(a,function(a){return!a.isSelected});b.length===a.length?_.forEach(b,function(a){_.remove(jb.resposibilityMatrixSelectedEmployees,function(b){return b.fullName===a.entity.fullName})}):_.forEach(a,function(a){jb.resposibilityMatrixSelectedEmployees.push(a.entity)})}),a.core.on.filterChanged(e,function(a,b){jb.responsibilityMatrix.filter={},_.each(this.grid.columns,function(a){if(a.visible&&a.filters&&a.filters[0].term)switch(a.field){case"fullName":jb.responsibilityMatrix.filter.employeeName=a.filters[0].term;break;case"seniorityLevel.displayName":jb.responsibilityMatrix.filter.seniorityLevelName=a.filters[0].term,Ta(jb.responsibilityMatrix.filter.seniorityLevelName),jb.responsibilityMatrix.filter.seniorityLevelIds=jb.responsibilityMatrix.seniorityLevelSearchIds}}),Q(jb.employeesCurrentDepartmentView)})},jb.spinnerMatrix=!1}}function F(a,b){var c=_.clone(b);return G(a,c),c}function G(a,b){for(var c in a)null!==a[c]&&(b[c]=a[c])}function H(a,b){var c,d=[];if(c=_.sortBy(_.uniq(_.flattenDeep(_.map(a,function(a){var b=!!a.locked;return _.map(a.jobFunctions,function(a){return{id:a.id,displayName:a.displayName,locked:b}})})),"id"),"id"),d.push({cellTemplate:"app/services/globals/grid_tpls/person/name_tpl.html",displayName:"Employee",enableHiding:!1,enableColumnMenu:!1,field:"fullName",pinnedLeft:!0,minWidth:Sa()?100:db,sort:{direction:jb.responsibilityMatrix.sort.fullName?jb.responsibilityMatrix.sort.fullName:null},filter:{term:jb.responsibilityMatrix.filter.employeeName}}),d.push({cellTemplate:"app/services/globals/grid_tpls/person/seniority_tpl.html",displayName:"Seniority",enableHiding:!1,enableColumnMenu:!1,pinnedLeft:!Sa(),field:"seniorityLevel.displayName",minWidth:db,sort:{direction:jb.responsibilityMatrix.sort.seniorityLevelName?jb.responsibilityMatrix.sort.seniorityLevelName:null},filter:{term:jb.responsibilityMatrix.filter.seniorityLevelName}}),_.isEmpty(b)){var e=[];c.length>Cb&&(e=ja(a));var f=c.filter(function(a){if(!a.locked)return a}),g=_.difference(c,f).map(function(a){return a.id});_.isEmpty(g)?Ga(f,e,d,a):i.getJobFunctionsByIds(fb,g).then(function(b){b=b.concat(f),Ga(b,e,d,a)})}else{var h=b.map(function(a){return a.id}),j=[];_.forEach(c,function(a){var c=a.displayName;if(c&&c.length){var d=_.find(b,{id:a.id}),e=h.indexOf(a.id);e!==-1&&j.push(ka(d.displayName,a.id,!0,e+1))}}),j=_.sortByOrder(j,["order"],["asc"]);var k=c.filter(function(a){if(h.indexOf(a.id)===-1)return a});_.isEmpty(k)?(d=d.concat(j),Ca(d,a)):Ha(d,j,a,k)}}function I(){return _.where(jb.currentEmployees,{locked:!0}).length}function J(a){return"employees"===a?jb.selectedEmployees.length:"responsibilityMatrix"===a?jb.resposibilityMatrixSelectedEmployees.length:e.companyVm[a]&&e.companyVm[a].api?e.companyVm[a].api.selection.getSelectedRows().length:void 0}function K(a){var b={};b[Eb]=[];var c=[],d=!1;return _.each(ib,function(e,f){c=_.filter(a,function(a){return _.indexOf(a.departmentIds,_.parseInt(f))!==-1}),c&&_.size(c)>0&&(!sa(e)||jb.tab===qb)&&(b[e]=c,d||(jb.viewEmpsMatrixIdx=e,d=!0),L(b[Eb],c)),sa(e)&&jb.tab!==qb&&(b[e]=jb.orgChartData[e])}),b}function L(a,b){a.sort(),b.sort();for(var c=0;c<b.length;c+=1)a.indexOf(b[c])===-1&&a.push(b[c])}function M(){return jb.employees.totalItems}function N(){var a,b={companyIds:[jb.company.id],departmentIds:[]};if(a=jb.tab===nb?jb.currentDepartmentView:jb.employeesCurrentDepartmentView,a&&(b.departmentIds=[a]),b.includeOutOfScopeResults=jb.showOutOfScopeEmployees,jb.employees.filter)for(var c in jb.employees.filter)b[c]=jb.employees.filter[c];return b}function O(){jb.newTabs.push({name:nb,label:"Org Charts",avail:jb.hasContactOnline,showTabItem:!1,partialLock:!1,subtabs:{label:"Departments",tabs:[]}}),jb.newTabs.push({name:ob,label:"Employees",avail:jb.hasContactOnline,showTabItem:!1,subtabs:{label:"View",tabs:[{name:pb,label:"Current",avail:jb.hasContactOnline},{name:qb,label:"Recently Left",avail:jb.hasExistLeftEmployees},{name:rb,label:"Responsibility Matrix",avail:jb.hasContactOnline}]}}),jb.newTabs.push({name:sb,label:"Financials",avail:!1,loaded:!1,showTabItem:!0}),jb.newTabs.push({name:tb,label:"Financials",avail:!1,loaded:!1,showTabItem:!0}),jb.newTabs.push({name:ub,label:"Technologies",avail:!1,loaded:!1,showTabItem:!0}),jb.newTabs.push({name:vb,label:"Intelligence",avail:!1,showTabItem:!0,subtabs:{label:"View",tabs:[{name:wb,label:n.findFeatureFlag(null,"triggerstoscoops")?"Scoops":"Triggers",avail:!1,loaded:!1},{name:xb,label:"OppAlerts",avail:!1,loaded:!1}]}}),jb.newTabs.push({name:yb,label:"Hierarchy",avail:!1,loaded:!1,showTabItem:!0}),jb.newTabs.push({name:zb,label:"Similar Companies",avail:!0,showTabItem:!0}),jb.orgChartsTabObj=Ja(nb),jb.employeesTabObj=Ja(ob),jb.currentEmployeesTabObj=Ka(ob,pb),jb.recentlyLeftEmployeesTabObj=Ka(ob,qb),jb.responsibilityMatrixTabObj=Ka(ob,rb),jb.financialsTabObj=Ja(sb),jb.fundingInfoTabObj=Ja(tb),jb.technologiesTabObj=Ja(ub),jb.intelligenceTabObj=Ja(vb),jb.intelTabObj=Ka(vb,wb),jb.oppalertsTabObj=Ka(vb,xb),jb.hierarchyTabObj=Ja(yb),jb.similarTabObj=Ja(zb),Ab||(Ab=!0,i.getTierTwoPeopleCount(fb.id).then(function(a){jb.tierTwoPeopleCount=a}).catch(function(a){Ab=!1,console.error(a)})),jb.canViewDunsInfo=!1,m.isEnableDunsAccess().then(function(a){jb.canViewDunsInfo=a});var a,b=_.findWhere(jb.employees.columnDefs,{field:"departments"});jb.accessScopeSubjectLine=encodeURIComponent("Access Request From "+eb.firstName+" "+eb.lastName+": "+jb.company.name),jb.accessScopeBodyLine=encodeURIComponent("I am interested in more information on how to gain access to the data set which includes "+jb.company.name+"."),jb.employees.onRegisterApi=function(a){f(a.core.clearAllFilters,250),f(a.core.clearAllFilters,500),f(a.core.clearAllFilters,1e3),a.core.on.sortChanged(e,function(a,b){kb=!_.isUndefined(b[0])}),jb.employees.api=a},jb.pastEmployees.onRegisterApi=function(a){a.core.on.sortChanged(e,function(a,b){kb=!_.isUndefined(b[0])}),a.pagination.on.paginationChanged(e,function(){var b=$(".company-recently-left-container .recently-left-employee-grid"),c=jb.pastEmployees.pageNumer;jb.pastEmployees.pageNumer=a.pagination.getPage(),angular.element(b).ready(function(b,d){var e=c==jb.pastEmployees.pageNumer||a.pagination.getPage()==a.pagination.getTotalPages();R(e,cb)})})},b&&(a=function(a,b){var c=_.pluck(_.sortByOrder(a,["displayName"],["asc"]),"displayName").join(""),d=_.pluck(_.sortByOrder(b,["displayName"],["asc"]),"displayName").join("");return c>d?1:c<d?-1:0},b.sortingAlgorithm=a),i.findOrgChartDataByDepartment(jb.currentDepartmentName),i.getOrgCharts().then(function(a){jb.orgChartData=a,jb.orgChartDataCopy={};var b=Object.keys(jb.orgChartData);va(jb.tab,b);var c,e=1;_.forEach(jb.company.companyDepartments,function(a){var d=jb.locked||jb.checkLockedDepartmentByName(a.departmentName);if(b.indexOf(a.departmentName)>=0){C(a.departmentName,a.departmentId,e++,d);var f=_.findIndex(b,function(b){return b===a.departmentName});jb.newTabs[_.findIndex(jb.newTabs,function(a){return a.name==nb})].subtabs.tabs.push({name:f,label:a.departmentName,sortLabel:Pa(a.departmentName),locked:d,avail:!0});var g={name:a.departmentName,idx:f};jb.currentOrgChartDeptList.push(g)}else jb.currentDepartmentName===a.departmentName&&(c={name:a.departmentName,id:a.departmentId,tab:e,locked:d})}),c&&0==jb.currentDeptList.length&&jb.currentDeptList.push(c),_.isEmpty(jb.currentDeptList)||D();var f=jb.newTabs[_.findIndex(jb.newTabs,function(a){return a.name==nb})].subtabs.tabs;if(!_.isEmpty(f)&&jb.tab===nb){var g=_.findIndex(f,function(a){return a.locked===!1});g>=0&&jb.secondaryTab!==g&&(jb.secondaryTab=g)}if(jb.newTabs[_.findIndex(jb.newTabs,function(a){return a.name==nb})].partialLock=T(),i.isEmptyOrgChart(a)?jb.nullOrgcharts=!0:(jb.hasExistCurrentEmployees=!0,jb.orgChartDataCopy.hasOwnProperty(jb.currentDepartmentName)||(jb.orgChartDataCopy[jb.currentDepartmentName]=jb.orgChartData[jb.currentDepartmentName])),_.findIndex(jb.currentDeptList,{id:0})<0&&jb.currentDeptList.unshift({name:Eb,id:0,tab:0,locked:!0}),!jb.orgTabs.currentEmployeesLoaded){var h=_.find(jb.currentDeptList,{name:jb.currentDepartmentName});h?S(h.id):jb.orgTabs.currentEmployeesLoaded=!0}jb.spinnerGo=!1,d.$broadcast("initSubTabItem",{})},function(){jb.spinnerGo=!1,jb.nullOrgcharts=!0}),i.getTechnologiesCounts(fb.id).then(function(a){jb.technologiesTabObj.avail=a>0,d.$broadcast("updatePrimaryTab",{})}),fb._links.oppalerts?u.all({intelData:i.getIntelCounts(fb.id,null),oppAlertsData:i.getOppAlertsCount(fb.id)}).then(function(a){jb.intelTabObj.avail=!!a.intelData.searchCriteriaScoped,jb.oppalertsTabObj.avail=a.oppAlertsData>0,jb.intelligenceTabObj.avail=jb.intelTabObj.avail||jb.oppalertsTabObj.avail,d.$broadcast("updatePrimaryTab",{})}):i.getIntelCounts(fb.id,null).then(function(a){jb.intelTabObj.avail=!!a.searchCriteriaScoped,jb.intelligenceTabObj.avail=jb.intelTabObj.avail||jb.oppalertsTabObj.avail,d.$broadcast("updatePrimaryTab",{})}),n.findFeatureFlag(null,"comp_profile_finance")&&(jb.companyInvestors.length>0||jb.companyFundingRounds.length>0)?(jb.fundingInfoTabObj.avail=!0,d.$broadcast("updatePrimaryTab",{})):!jb.company.revenue&&jb.isDepartmentsBudgetEmpty||(jb.financialsTabObj.avail=!0,d.$broadcast("updatePrimaryTab",{})),jb.financialsTabObj.loaded=!0,jb.fundingInfoTabObj.loaded=!0,i.getCompanyLocations(fb).then(function(a){jb.companyLocations=a}),i.getPastEmployees(fb).then(function(a){jb.leftEmployees=a,jb.hasExistLeftEmployees=jb.leftEmployees.length>0,jb.orgTabs.leftEmployeesLoaded=!0;var b=jb.newTabs[_.findIndex(jb.newTabs,function(a){return a.name==ob})].subtabs.tabs;if(!_.isEmpty(b)){var c=b[_.findIndex(b,function(a){return a.name===qb})];c.avail=jb.hasExistLeftEmployees}},function(){jb.orgTabs.leftEmployeesLoaded=!0}),s.checkCanExport().then(function(a){jb.canExport=a,e.canExport=a}),jb.company.state===Db?i.checkCompanyHasContactOnline(jb.company.id).then(function(a){a?za(jb.hasContactOnline,!1):i.getTierTwoPeopleCount(jb.company.id).then(function(a){jb.hasContactOnline=!1,za(jb.hasContactOnline,a>0)}).catch(function(a){jb.hasContactOnline=!1,za(jb.hasContactOnline,!1),console.error(a)})}).catch(function(a){za(jb.hasContactOnline,!1),console.error(a)}):za(jb.hasContactOnline,!1),t.toggleFixedItems(),i.getSeniorityLevels().then(function(a){jb.seniorityLevels=a.selectOptions})}function P(a,b){var c={page:jb.pagingInfo.number||0,size:jb.employees.paginationPageSize,sortOrder:jb.employees.sortOrder,sortField:jb.employees.sortField};jb.spinnerCurEmp=!0;var d=jb.tab===pb?jb.employeesCurrentDepartmentName:jb.currentDepartmentName,e=d!==Eb||jb.showOutOfScopeEmployees;i.getEmployees(fb,c,a,jb.employees.filter,e).then(function(a){jb.currentEmployees=a.personList,jb.hasExistCurrentEmployees=!0,jb.pagingInfo=a._page,jb.employees.totalItems=jb.pagingInfo.totalElements,jb.currentEmployees&&da(d),jb.orgTabs.currentEmployeesLoaded=!0,jb.spinnerCurEmp=!1,b=b?b:jb.pagingInfo.number==jb.pagingInfo.totalPages,R(b,ab)},function(){jb.orgTabs.currentEmployeesLoaded=!0})}function Q(a,b){if(!jb.locked){a=a>0?a:1;var c=_.find(jb.currentDeptList,function(b){return b.id===a}),d={page:jb.rmPagingInfo.number||0,size:jb.responsibilityMatrix.paginationPageSize||angular.copy(Bb),sortOrder:jb.responsibilityMatrix.sortOrder,sortField:jb.responsibilityMatrix.sortField};jb.spinnerMatrixLoadingByDepartment=!0,i.getEmployees(fb,d,a,jb.responsibilityMatrix.filter,!0).then(function(a){jb.employeesCurrentDepartmentName=c.name,jb.rmEmployees=a.personList,jb.hasExistResposibilityMatrixEmployees=!0,Da(),jb.rmPagingInfo=a._page,jb.rmEmployees.totalItems=jb.rmPagingInfo.totalElements,jb.rmEmployees?da(jb.employeesCurrentDepartmentName):jb.spinnerMatrixLoadingByDepartment=!1,jb.rmEmployees.isPageChanged=b?b:jb.rmPagingInfo.number==jb.rmPagingInfo.totalPages})}}function R(a,b){a&&angular.element(document).ready(function(){if(Sa()){var a=$(".right-child");_.isObject(a)&&_.isObject(a.offset())&&$(window).scrollTop()>a.offset().top&&$("html,body").animate({scrollTop:a.offset().top+"px"},10)}else if($(b)){var c=Wa(b+" .pagination");c||$("html,body").animate({scrollTop:$(b).offset().top-25+"px"},300)}})}function S(a){var b={page:jb.pagingInfo.number||0,size:jb.employees.paginationPageSize,sortOrder:jb.employees.sortOrder,sortField:jb.employees.sortField};i.getEmployees(fb,b,a,{},!0).then(function(a){jb.currentEmployees=a.personList,jb.hasExistCurrentEmployees=!0,jb.orgTabs.currentEmployeesLoaded=!0},function(){jb.orgTabs.currentEmployeesLoaded=!0})}function T(){return _.some(h.companyDepartmentsForOrgChart,{locked:!0,havingEmployee:!0})}function U(){g.open({controller:"ResearchRequestController_dep",templateUrl:"app/components/navbar/researchRequest.modal.html"})}function V(a,b){_.each(b,function(b){var c=_.find(a,"id",b.id);_.isUndefined(c)||G(c,b)})}function W(){var a="";return _.each(h.companyDepartments,function(b){switch(b.departmentId){case 1:a+="(IT)";break;case 2:a+="(FI)";break;case 3:a+="(MK)"}}),a+=" Regarding: "+h.name}function X(a,b){jb.selectedEmployees=[],jb.resposibilityMatrixSelectedEmployees=[];var c=_.find(jb.currentDeptList,function(a){return a.name===b});jb.tab===nb?(jb.currentDepartmentView=a,jb.currentDepartmentViewIdx=c.tab,jb.currentDepartmentName=b):(jb.employeesCurrentDepartmentView=c.id,jb.employeesCurrentDepartmentViewIdx=c.tab,jb.employeesCurrentDepartmentName=b),jb.pagingInfo={number:0,size:jb.employees.paginationPageSize,totalElements:0,totalPages:0},jb.rmPagingInfo={number:0,size:jb.responsibilityMatrix.paginationPageSize,totalElements:0,totalPages:0},jb.employees.paginationCurrentPage=0,jb.responsibilityMatrix.paginationCurrentPage=0,jb.tab===nb&&(S(c.id),ua(b)),wa(jb.tab,b),jb.tab===pb||jb.tab===rb?jb.tab===pb?(P(jb.employeesCurrentDepartmentView),jb.suppressRefresh=!0):(jb.rmSuppressRefresh=!0,Q(jb.employeesCurrentDepartmentView)):jb.tab===qb&&ea(b)}function Y(){jb.spinnerCurEmp||(jb.showOutOfScopeEmployees=!jb.showOutOfScopeEmployees,P(0),da(jb.viewEmpsIdx))}function Z(a){return a?void $("html,body").animate({scrollTop:$("#orgchart-wrapper").offset().top+"px"},900):void g.open({controller:["$scope","$uibModalInstance","subjectLine","bodyLine",function(a,b,c,d){function e(){b.close(!1)}var f=this;f.close=e,f.subjectLine=c,f.bodyLine=d}],controllerAs:"companyUnlockVm",resolve:{subjectLine:function(){return jb.accessScopeSubjectLine},bodyLine:function(){return jb.accessScopeBodyLine}},size:"md",templateUrl:"app/views/company/partials/unlock.modal.html",windowClass:"lock-modal"})}function aa(a,b){if(!_.isUndefined(b)){"suppression"===b.call&&(jb.spinnerSuppress=!1);var c=jb.tab,e=!_.isUndefined(b.data)&&b.data&&!_.has(b.data[0],"name");if("page"===b.lType){var f=_.find(b.data,"id",jb.company.id);_.isUndefined(f)||(f=F(f,jb.company),jb.company=_.clone(f),jb.hidden=f)}if("page"!==b.lType||"crmUpload"===b.call)if(e&&d.$broadcast("event:orgchart",b),"suppression"===b.call)e?(_.isUndefined(jb.employees)||(jb.employees.data=_.filter(jb.employees.data,function(a){return _.indexOf(b.ids,a.id)<0})),_.isUndefined(jb.pastEmployees)||(jb.pastEmployees.data=_.filter(jb.pastEmployees.data,function(a){return _.indexOf(b.ids,a.id)<0}))):jb.companies.data=_.filter(jb.companies.data,function(a){return _.indexOf(b.ids,a.id)<0});else if(e){var g=_.find(jb.currentDeptList,{name:jb.currentDepartmentName}),h=angular.copy(jb.employeesCurrentDepartmentView);g&&c===nb&&(h=angular.copy(g.id)),P(h),c===qb&&i.getPastEmployees(fb).then(function(a){V(a,jb.pastEmployees.data),jb.filteredEmpsLeft=K(a)}),c===rb&&V(b.ids,jb.responsibilityMatrix.data)}else i.getSimilarCompanies(fb).then(function(a){jb.similarCompaniesList=a,jb.companies.data=a})}}function ba(a,b){if(!_.isUndefined(b)){var c=b.data;_.forEach(c,function(a){ca(jb.selectedEmployees,a),ca(jb.currentEmployees,a)})}}function ca(a,b){var c=_.find(a,{id:b.id});c&&(c.followed=b.followed)}function da(a){var b=[];a!==Eb&&(jb.showOutOfScopeEmployees=!0),jb.tab===rb?(b=jb.rmEmployees||[],jb.viewEmpsMatrixIdx=a,ia(jb.tab),i.getJobFunctionsSettingByDepartmentName(fb,gb[a]).then(function(a){H(b,a)})):jb.tab===pb&&(b=jb.currentEmployees||[],jb.viewEmpsIdx=a,a!==Eb||jb.showOutOfScopeEmployees?jb.employees.data=b:jb.employees.data=_.filter(b,function(a){return!a.locked&&!a.privacyEuRequested}),null==jb.employees.sortField&&ia(jb.tab))}function ea(a){jb.viewEmpsLeftIdx=a,jb.pastEmployees.data=jb.filteredEmpsLeft[a]||[],ia(qb)}function fa(){if(jb.responsibilityMatrix.api&&jb.responsibilityMatrix.api.grid){var a=_.map(jb.responsibilityMatrix.api.grid.columns,function(a,b){return{displayName:a.displayName,order:b,visible:a.visible}}),b=_.filter(a,function(a){return a.visible===!0&&"Employee"!==a.displayName&&"Seniority"!==a.displayName&&""!==a.displayName});return b}}function ga(){jb.spinnerSuppress=!0}function ha(){g.open({controller:["$scope","$uibModalInstance","locations","selectedLocations",function(a,c,d,e){function f(){k.hasHqPrimaryLocation=_.some(k.locations,function(a){return 1===a.locationTypeId}),k.hasHqOtherLocation=_.some(k.locations,function(a){return 2===a.locationTypeId}),k.hasOtherLocation=_.some(k.locations,function(a){return 1!==a.locationTypeId&2!==a.locationTypeId})}function g(){k.inputFilter="",P(jb.employeesCurrentDepartmentView),c.close(!1)}function h(){var a=function(a){var b=["streetAddress","city","stateProvinceRegion","postalCode","isoCountryCode","metroArea"];for(var c in a)if(_.contains(b,c)&&(""+a[c]).toLowerCase().indexOf(k.inputFilter.toLowerCase())>-1)return!0;return!1};k.locations=k.inputFilter.length>1?b("filter")(k.locationsClone,a,k.inputFilter):k.locationsClone,f()}function i(){k.inputFilter="",k.selectedLocations=[],jb.selectedLocations=[],delete jb.employees.filter.personLocation}function j(){jb.selectedLocations=k.selectedLocations,jb.employees.filter.personLocation={locationIds:jb.selectedLocations},k.close()}var k=this;k.close=g,k.filter=j,k.clear=i,k.filterLocation=h,k.inputFilter="",k.selectedLocations=e,k.locationsClone=d,k.locations=d,k.numLocation=d.length,f()}],controllerAs:"comLocationVm",resolve:{locations:function(){return jb.companyLocations},selectedLocations:function(){return jb.selectedLocations}},size:"lg",templateUrl:"app/views/company/partials/company-locations.modal.html",windowClass:"filter-location"}).result.then(function(){},function(){jb.viewEmps(jb.currentDepartmentName)})}function ia(a){kb||(a===pb?jb.employees.data=_.sortBy(jb.employees.data,function(a){return a.fullName}):a===qb?jb.pastEmployees.data=_.sortBy(jb.pastEmployees.data,function(a){return a.fullName}):a===rb&&(jb.responsibilityMatrix.data=_.sortBy(jb.responsibilityMatrix.data,function(a){return a.fullName})))}function ja(a){var b=_.countBy(_.flattenDeep(_.map(a,function(a){return _.map(a.jobFunctions,"id")})));return b=_.map(b,function(a,b){return{jobId:b,count:a}}),b=_.sortByOrder(b,["count"],["desc"]),_.dropRight(b,b.length-Cb)}function ka(a,b,c,d){var e={cellTemplate:Fa(),displayName:a,headerCellTemplate:Ea(),minWidth:a.length<20?15*a.length:200,enableColumnMenu:!1,enableFiltering:!1,field:"jobFunction_"+b,visible:c,jobId:b};return d>0&&(e.order=d),e}function la(a){a.toggle()}function ma(){e.$broadcast("angular-ui-tree:expand-all")}function na(){e.$broadcast("angular-ui-tree:collapse-all"),setTimeout(function(){document.getElementById("ultimateParent").click()},1)}function oa(a,b){for(var c in a)if("key"===c){var d=a.relationshipType;b&&b==a.key&&(Fb=pa(d))}else if("children"===c)for(var e=a[c],f=0;f<e.length;f++)oa(e[f],b);return Fb}function pa(a){switch(a){case"Division":return"hilited-division-card";case"Brand":return"hilited-brand-card";case"Subsidiary":return"hilited-subsidiary-card";case"Affiliate":return"hilited-affiliate-card";default:return""}}function qa(a){if(!a)return void(d.$qschChildName=null);var b=a.toString();d.$qschChildId=null,f(function(){var a="#"+b,c=oa(jb.hierarchyNodes[0],b);$(a).length>0&&($(a).addClass(c),$("html,body").animate({scrollTop:$(a).offset().top-100+"px"},300)),d.$qschChildName=null},300)}function ra(a){return null==a||!_.any(a,function(a){return null!=a.budget&&a.budget>0})}function sa(a){var b=_.find(h.companyDepartmentsForOrgChart,{departmentName:a});return null!=b&&b.locked}function ta(){if(_.isEmpty(h.companyDepartmentsForOrgChart))return"";var a=_.find(h.companyDepartmentsForOrgChart,{locked:!1,havingEmployee:!0});return null==a&&(a=_.find(h.companyDepartmentsForOrgChart,{havingEmployee:!0}),null==a)?h.companyDepartmentsForOrgChart[0].departmentName:a.departmentName}function ua(a){if(!jb.orgChartDataCopy.hasOwnProperty(a)){jb.orgchartSpinner=!0;var b=i.findOrgChartDataByDepartment(a);i.getOrgChartByDepartment(b).then(function(b){jb.orgChartDataCopy[a]=b,jb.orgchartSpinner=!1}).catch(function(a){jb.orgchartSpinner=!1})}}function va(a,b){var c=1;if(jb.currentDepartmentViewIdx=c,jb.currentDepartmentView=0,_.isEmpty(jb.currentDepartmentName)&&(jb.currentDepartmentName=ta()),a&&!_.isUndefined(b)&&!_.isEmpty(b)){var d=0,e=!!jb.spinnerGo&&!b[0].name;if(e||a===nb||a===qb){var f=a===nb||e?jb.currentDepartmentName:jb.employeesCurrentDepartmentName,g=_.findIndex(b,function(a){return a===f});a===nb||e?(g=g>=0?g:0,jb.currentDepartmentView=g,jb.currentDepartmentName=b[jb.currentDepartmentView]):a===qb&&(g<=0&&(g=0),jb.employeesCurrentDepartmentView=g,jb.employeesCurrentDepartmentName=b[jb.employeesCurrentDepartmentView])}else if(a===pb||a===rb)if(jb.hasCheckedDefaultDepartmentForEmployeesTab){if(b[0].name){var h=_.find(b,function(a){return a.name===jb.employeesCurrentDepartmentName});if(_.isUndefined(h)||a===rb&&0==h.id){d=_.size(b);var i=d>c?c:0;h=b[i]}_.isUndefined(h)||(jb.employeesCurrentDepartmentView=h.id,jb.employeesCurrentDepartmentViewIdx=h.tab,jb.employeesCurrentDepartmentName=h.name)}}else D()}}function wa(a,b){if(a){var c=xa(a),d=!1;if(_.isEmpty(b))d=!0;else if(a===nb||a===qb){var e=_.findIndex(c,function(a){return a===b});e>=0?a===nb?(jb.currentDepartmentView=e,jb.currentDepartmentName=c[jb.currentDepartmentView]):(jb.employeesCurrentDepartmentView=e,jb.employeesCurrentDepartmentName=c[jb.employeesCurrentDepartmentView]):d=!0}else if(a===pb||a===rb){var f=_.find(c,function(a){return a.name===b});_.isUndefined(f)?d=!0:(jb.employeesCurrentDepartmentView=f.id,jb.employeesCurrentDepartmentViewIdx=f.tab,jb.employeesCurrentDepartmentName=f.name)}d&&va(a,c)}}function xa(a){var b=[];return a===nb?void 0!==jb.orgChartData&&(b=Object.keys(jb.orgChartData)):a===pb||a===rb?b=jb.currentDeptList:a===qb&&(b=jb.filteredEmpsLeftTabs),b}function ya(a){if(!_.isEmpty(jb.company.companyDepartments)&&null!=a){var b=_.keys(a);jb.filteredEmpsLeftTabs=[Eb],_.forEach(jb.company.companyDepartments,function(a){_.includes(b,a.departmentName)&&jb.filteredEmpsLeftTabs.push(a.departmentName)})}}function za(a,b){Aa(b),jb.orgChartsTabObj.showTabItem=a,jb.employeesTabObj.showTabItem=a}function Aa(a){jb.isInLoading=!1,jb.company.hasTier2ContactOnline=a}function Ba(){$("#"+jb.companyFinancialId).animate({scrollTop:0},"slow")}function Ca(a,b){jb.responsibilityMatrix.columnDefs=angular.copy(a),jb.responsibilityMatrix.totalItems=jb.rmEmployees.totalItems,jb.responsibilityMatrix.data=b,R(jb.rmEmployees.isPageChanged,bb),jb.rmEmployees.isPageChanged=!1,jb.responsibilityMatrix.filter.seniorityLevelName||jb.responsibilityMatrix.filter.employeeName||(jb.responsibilityMatrix.employeesInit=jb.rmEmployees||[]),jb.spinnerMatrixLoadingByDepartment=!1}function Da(){if(_.isEmpty(jb.rmEmployees))jb.isLockJobFunction=!1;else{var a=!1;_.each(jb.rmEmployees,function(b){if(void 0===b.locked||!b.locked)return a=!0,!1}),jb.isLockJobFunction=!a}}function Ea(){var a="<div role=\"columnheader\" ng-class=\"{ 'sortable': sortable, 'ui-grid-header-cell-last-col': isLastCol }\" ui-grid-one-bind-aria-labelledby-grid=\"col.uid + '-header-text ' + col.uid + '-sortdir-text'\" aria-sort=\"{{col.sort.direction == asc ? 'ascending' : ( col.sort.direction == desc ? 'descending' : (!col.sort.direction ? 'none' : 'other'))}}\">";return a+='<div role="button" tabindex="0" ng-keydown="handleKeyDown($event)" class="ui-grid-cell-contents ui-grid-header-cell-primary-focus" col-index="renderIndex"',a+=">",a+='<span class="ui-grid-header-cell-label" ui-grid-one-bind-id-grid="col.uid + \'-header-text\'"> {{ col.displayName CUSTOM_FILTERS }}</span>',jb.isLockJobFunction&&(a+='<div class="responsibility-matrix-job-function-lock"><i class="fa fa-lock"></i></div>'),a+='<span ui-grid-one-bind-id-grid="col.uid + \'-sortdir-text\'" ui-grid-visible="col.sort.direction" aria-label="{{getSortDirectionAriaLabel()}}">',a+="<i ng-class=\"{ 'ui-grid-icon-up-dir': col.sort.direction == asc, 'ui-grid-icon-down-dir': col.sort.direction == desc, 'ui-grid-icon-blank': !col.sort.direction }\" title=\"{{isSortPriorityVisible() ? i18n.headerCell.priority + ' ' + ( col.sort.priority + 1 ) aria-hidden=\"true\"></i>",a+='<sub ui-grid-visible="isSortPriorityVisible()" class="ui-grid-sort-priority-number"> {{col.sort.priority + 1}}</sub>',a+="</span>",a+="</div>",a+='<div role="button" tabindex="0" ui-grid-one-bind-id-grid="col.uid + \'-menu-button\'" class="ui-grid-column-menu-button" ng-if="grid.options.enableColumnMenus && !col.isRowHeader  && col.colDef.enableColumnMenu !== false" ng-click="toggleMenu($event)" ng-keydown="headerCellArrowKeyDown($event)" ui-grid-one-bind-aria-label="i18n.headerCell.aria.columnMenuButtonLabel" aria-haspopup="true">',a+='<i class="ui-grid-icon-angle-down" aria-hidden="true">&nbsp;</i>',a+="</div>",a+="<div ui-grid-filter></div>",a+="</div>"}function Fa(){var a='<div class="ui-grid-cell-contents"><div ng-if="!row.entity.locked && !row.entity.privacyEuRequested && COL_FIELD" class="cell-icon-wrapper"><i class="fa fa-check"></i></div>';return a+='<locked-content-component ng-if="row.entity.locked && !row.entity.privacyEuRequested" entity="row.entity"></locked-content-component>',a+='<privacy-requested-component ng-if="row.entity.privacyEuRequested" entity="row.entity"></privacy-requested-component></div>'}function Ga(a,b,c,d){_.forEach(a,function(d){var e=d.displayName;e&&e.length&&(a.length<=Cb||_.findIndex(b,function(a){return a.jobId===d.id.toString()})!==-1)&&c.push(ka(e,d.id,!0,-1))});var e=_.filter(a,function(a){return _.findIndex(b,function(b){return b.jobId===a.id.toString()})===-1});_.isEmpty(e)||(e=_.sortBy(e,function(a){return a.displayName}),_.forEach(e,function(a){var b=a.displayName;b&&b.length&&(Va(c,b)||c.push(ka(b,a.id,!1,-1)))})),Ca(c,d)}function Ha(a,b,c,d){var e=d.filter(function(a){if(!a.locked)return a}),f=_.difference(d,e).map(function(a){return a.id});_.isEmpty(f)?(e=_.sortBy(e,function(a){return a.displayName}),_.forEach(e,function(a){Va(b,a.displayName)||b.push(ka(a.displayName,a.id,!1,-1))}),a=a.concat(b),Ca(a,c)):i.getJobFunctionsByIds(fb,f).then(function(d){d=d.concat(e),_.isEmpty(d)||(d=_.sortBy(d,function(a){return a.displayName}),_.forEach(d,function(a){Va(b,a.displayName)||b.push(ka(a.displayName,a.id,!1,-1))})),a=a.concat(b),Ca(a,c)})}function Ia(){return i.isContentProfileFinance()}function Ja(a){var b=_.findIndex(jb.newTabs,function(b){return b.name===a});return jb.newTabs[b]}function Ka(a,b){var c=_.findIndex(jb.newTabs,function(b){return b.name===a}),d=_.findIndex(jb.newTabs[c].subtabs.tabs,function(a){return a.name===b});return jb.newTabs[c].subtabs.tabs[d]}function La(a){return jb.tab===a}function Ma(){return La(jb.currentEmployeesTabKey)||La(jb.recentlyLeftEmployeesTabKey)||La(jb.responsibilityMatrixTabKey)}function Na(){return La(jb.orgChartsTabKey)||Ma()}function Oa(a,b){return jb.tabIsActive(a)&&b.avail}function Pa(a){var b=a,c=a.split(" ");return c&&c.length>1&&(b=a.match(/\b\w/g).join("")),b}function Qa(){$("html, body").animate({scrollTop:$(".right-child").offset().top-100},300)}function Ra(){var a=$(window).width();return a>=Xa?Za:a>=Ya?$a:_a}function Sa(){return jb.viewPort===$a||jb.viewPort===_a}function Ta(a){jb.responsibilityMatrix.seniorityLevelSearchIds=[],_.each(jb.seniorityLevels,function(b){b.displayName.toLowerCase().indexOf(a.toLowerCase())>-1&&jb.responsibilityMatrix.seniorityLevelSearchIds.push(b.id)}),a&&""!=a&&0===jb.responsibilityMatrix.seniorityLevelSearchIds.length&&(jb.responsibilityMatrix.seniorityLevelSearchIds=[0])}function Ua(a,b){jb.responsibilityMatrix.sort={},jb.responsibilityMatrix.sortField=null,jb.responsibilityMatrix.sortOrder=null,a&&(jb.responsibilityMatrix.sortField=a,b&&(jb.responsibilityMatrix.sortOrder=b,jb.responsibilityMatrix.sort[a]=b))}function Va(a,b){return _.findIndex(a,{displayName:b})>=0}function Wa(a){if($(a)){var b=$(a).offset().top,c=$(window).scrollTop();return b>c+150}return!1}var Xa=992,Ya=480,Za="Desktop",$a="Tablet",_a="Phone",ab=".company-current-employees-container",bb=".company-responsibility-matrix-container",cb=".company-recently-left-container",db=140,eb=d.Session.account,fb=d.Session.obj||h,gb=i.invertedDeptFields,hb=[],ib=i.deptFields,jb=this;jb.viewPort=Ra(),jb.newTabs=[],jb.secondaryTab=0;var kb=!1,lb=function(a,b,c,d){i.saveJobFunctionsDisplaySetting(a,b,c,d)},mb=_.debounce(lb,2e3),nb=i.orgChartsTabKey,ob=i.employeesTabKey,pb=i.currentEmployeesTabKey,qb=i.recentlyLeftEmployeesTabKey,rb=i.responsibilityMatrixTabKey,sb=i.financialsTabKey,tb=i.fundingInfoKey,ub=i.technologiesTabKey,vb=i.intelligenceTabKey,wb=i.intelTabKey,xb=i.oppalertsTabKey,yb=i.hierarchyTabKey,zb=i.similarTabKey,Ab=!1,Bb=25,Cb=3,Db=4,Eb="All Departments";n.getFeatureFlags().then(function(a){jb.yearFoundedEnabled=n.findFeatureFlag(a.data,"year_founded")}),jb.showMap=!1,jb.$$filter="",jb.$orgChartDeptId=x,jb.accessScopeBodyLine="",jb.accessScopeSubjectLine="",jb.canAccessTierTwoData=eb.canAccessTierTwoData,jb.canBulkUpload=i.checkBulk(),jb.canExport=!1,e.canExport=!1,jb.canUpload=_.has(fb._links,"uploadCompany")||_.has(fb._links,"uploadCompanyToMAT")||_.has(fb._links,"uploadCompanyToSDR"),jb.canUploadPerson=m.checkUserHasAllowedLeadOrContactUpload(),jb.changeCompanyTab=z,jb.changeOrgchartTab=E,jb.companies=c.$defaultGrid("followCompany",[],!0,!0,e,void 0,void 0,Sa()),jb.company=_.clone(fb),jb.currentDepartmentView=0,jb.currentDepartmentViewIdx=1,jb.employeesCurrentDepartmentView=0,jb.employeesCurrentDepartmentViewIdx=0,jb.employeesCurrentDepartmentName=Eb,jb.hasCheckedDefaultDepartmentForEmployeesTab=!1,jb.currentDepartmentName=ta(),jb.employees=c.$defaultGrid("currentPerson",[],!1,!0,e,void 0,void 0,Sa()),jb.getNumLocked=I,jb.getSelectedRows=J,jb.hidden=fb,jb.isPartiallyLocked=T,jb.locked=fb.locked,jb.tab=nb,jb.orgChartsTabKey=nb,jb.employeesTabKey=ob,jb.currentEmployeesTabKey=pb,jb.recentlyLeftEmployeesTabKey=qb,jb.responsibilityMatrixTabKey=rb,jb.financialsTabKey=sb,jb.fundingInfoTabKey=tb,jb.technologiesTabKey=ub,jb.intelligenceTabKey=vb,jb.intelTabKey=wb,jb.oppalertsTabKey=xb,jb.hierarchyTabKey=yb,jb.similarTabKey=zb,jb.isContentProfileFinance=Ia,jb.openResearchRequest=U,jb.openFilterCompanyLocation=ha,jb.orgTabs={leftEmployeesLoaded:!1,currentEmployeesLoaded:!1},jb.pastEmployees=c.$defaultGrid("recentlyLeftEmployee",[],!0,!0,e),jb.responsibilityMatrix={},jb.responsibilityMatrix.sort={},jb.responsibilityMatrix.filter={},jb.showOutOfScopeEmployees=!0,jb.similarCompaniesList=[],jb.spinnerCurEmp=!0,jb.spinnerGo=!0,jb.spinnerLeftEmp=!0,jb.spinnerMatrix=!0,jb.spinnerMatrixLoadingByDepartment=!1,jb.spinnerSimilarCom=!1,jb.spinnerSuppress=!1,jb.orgchartSpinner=!1,jb.showMap=!1,jb.hasContactOnline=!0,jb.isInLoading=!0,jb.company.hasTier2ContactOnline=!0,jb.hasExistLeftEmployees=!1,jb.hasExistCurrentEmployees=!1,jb.hasExistResposibilityMatrixEmployees=!1,jb.subjectLine=W(),jb.swapDepartmentView=X,jb.toggleDetail=!a,jb.toggleOutOfScopeCurrentEmployees=Y,jb.unlockContent=Z,jb.viewEmps=da,jb.viewEmpsIdx=Eb,jb.viewEmpsLeft=ea,jb.viewEmpsLeftIdx=Eb,jb.viewEmpsMatrixIdx=Eb,jb.companyLocations=[],jb.selectedLocations=[],jb.triggersToScoopFlag=n.findFeatureFlag(null,"triggerstoscoops"),
jb.popUpTemplate="app/views/company/partials/companyMapPopover.html",jb.filteredEmpsLeftTabs=[],jb.checkLockedDepartmentByName=sa,jb.companyFinancialId="company-financial",jb.scrollToTop=Ba,jb.employees.useExternalPagination=!0,jb.employees.useExternalFiltering=!0,jb.employees.useExternalSorting=!0,jb.employees.sortOrder="asc",jb.employees.sortField=null,jb.employees.filter={},jb.pagingInfo={number:0,size:jb.employees.paginationPageSize,totalElements:0,totalPages:0},jb.rmPagingInfo={number:0,size:jb.responsibilityMatrix.paginationPageSize,totalElements:0,totalPages:0},jb.selectedEmployees=[],jb.resposibilityMatrixSelectedEmployees=[],jb.suppressRefresh=!1,jb.rmSuppressRefresh=!1,jb.selectAll=!1,jb.isPartOfCorporateHierarchy=!1,jb.isLoadingCorporateHierarchy=!0,jb.isDepartmentsBudgetEmpty=ra(jb.company.companyDepartments),jb.companyInvestors=w(r),jb.companyFundingRounds=r,jb.fundingRoundTimelineCheckbox=!1,jb.totalFundingAmount=_.sum(jb.companyFundingRounds,function(a){return a.amount}),jb.isHavingNullAmount=_.any(jb.companyFundingRounds,function(a){return null==a.amount||0===a.amount}),jb.tierTwoPeopleCount=0,jb.hgDataRemoval=n.findFeatureFlag(null,"hg_data_removal"),jb.tabIsActive=La,jb.employeesTabIsActive=Ma,jb.orgChartWrapperIsActive=Na,jb.showTab=Oa,jb.hierarchyGotoTop=Qa,O(),i.getCompanyHierarchy(jb.company.id).then(function(a){if(jb.isLoadingCorporateHierarchy=!1,a&&a.length>0&&(jb.hierarchyNodes=a,jb.hierarchyTabObj.avail=a,d.$broadcast("updatePrimaryTab",{}),d.$qschChildName&&d.$qschChildId)){var b=_.find(i.hierarchyIdValueMapping,function(a){return a.displayName===d.$qschChildName});b&&b.cardId?(d.$broadcast("switchToCorpHierarchyTab",{}),qa(b.cardId)):d.$qschChildName=null}}),jb.toggleNode=la,jb.chExpand=ma,jb.chCollapse=na,jb.isPartOfCorporateHierarchy=!!fb.corporateHierarchyRelationshipTypeId,e.$on("event:crmUpdate",aa),e.$on("event:crmUpload",aa),e.$on("event:followed",aa),e.$on("event:noteSaved",aa),e.$on("event:suppression",aa),e.$on("event:submitSuppression",ga),e.$on("event:unfollowed",aa),e.$on("event:unOrFollowed",ba),angular.element(q).bind("resize",function(){jb.viewPort=Ra()}),jb.countAllPerson=M,jb.exportCriteria=N,jb.includeExportSearchCriteria=!0,jb.currentOrgChartDeptList=[],jb.currentDeptList=[],jb.employees.onRegisterApi=function(a){e.gridApi=a,a.pagination.on.paginationChanged(e,function(){var a=jb.pagingInfo.number;jb.pagingInfo.number=e.gridApi.pagination.getPage()-1,jb.pagingInfo.size=jb.employees.paginationPageSize,jb.suppressRefresh?jb.suppressRefresh=!1:P(jb.employeesCurrentDepartmentView,a==jb.pagingInfo.number)}),a.core.on.sortChanged(e,function(a,b){if(b.length>0){for(;b.length>1;)b[0].unsort(),b.shift();_.each(b,function(a){a.field&&(jb.employees.sortOrder=a.sort.direction,jb.employees.sortField=_.camelCase(a.field.replace(/\./g,"_")))})}else jb.employees.sortOrder=null,jb.employees.sortField="fullName";P(jb.employeesCurrentDepartmentView)}),a.core.on.filterChanged(e,function(a,b){jb.employees.filter={},_.each(this.grid.columns,function(a){if(a.visible&&a.filter.term)switch(a.field){case"fullName":jb.employees.filter.employeeName=a.filter.term;break;case"title":jb.employees.filter.employeeTitle=a.filter.term;break;case"jobFunction":jb.employees.filter.employeeJobFunction=a.filter.term;break;case"reportsTo.fullName":jb.employees.filter.employeeReportToName=a.filter.term;break;case"location.streetAddress":jb.employees.filter.employeeStreetAddress=a.filter.term;break;case"location.city":jb.employees.filter.employeeCity=a.filter.term;break;case"location.stateProvinceRegion":jb.employees.filter.employeeStateProvinceRegion=a.filter.term;break;case"location.postalCode":jb.employees.filter.employeePostalCode=a.filter.term;break;case"location.countryName":jb.employees.filter.employeeCountry=a.filter.term;break;case"email":jb.employees.filter.employeeEmail=a.filter.term;break;case"personalEmail":jb.employees.filter.employeePersonalEmail=a.filter.term}}),jb.selectedLocations&&(jb.employees.filter.personLocation={locationIds:jb.selectedLocations}),P(jb.employeesCurrentDepartmentView)}),a.selection.on.rowSelectionChanged(e,function(a){a.isSelected?jb.selectedEmployees.push(a.entity):_.remove(jb.selectedEmployees,function(b){return b.fullName===a.entity.fullName})}),a.selection.on.rowSelectionChangedBatch(e,function(a){var b=_.filter(a,function(a){return!a.isSelected});b.length===a.length?_.forEach(b,function(a){_.remove(jb.selectedEmployees,function(b){return b.fullName===a.entity.fullName})}):_.forEach(a,function(a){jb.selectedEmployees.push(a.entity)})}),a.core.on.rowsRendered(e,function(a){if(!jb.spinnerCurEmp){var b=0,c=a.grid.rows;jb.selectedEmployees.length>0&&_.each(c,function(a){var c=_.find(jb.selectedEmployees,function(b){return b.fullName===a.entity.fullName});c&&(a.setSelected(!0),b++)}),a.grid.selection.selectAll=b===c.length}})},jb.companies.onRegisterApi=function(a){a.core.on.sortChanged(e,function(a,b){c.closeAllPopover(document)})},j.maxPersonExportRowCount().then(function(a){jb.personExportRowLimit=a.data});var Fb;jb.mockContent="",jb.onTabChange=function(a,b,c){var d=jb.newTabs[a];if(c&&d.name===jb.orgChartsTabKey&&jb.currentDepartmentName!==Eb){var e=_.findIndex(d.subtabs.tabs,function(a){return a.label===jb.currentDepartmentName});b=e>=0?e:b}jb.secondaryTab=b;var f=d.subtabs?d.subtabs.tabs[b]:null;return jb.mockContent=d.label,null!=f&&(jb.mockContent=jb.mockContent+" => "+f.label),d.name===jb.orgChartsTabKey?(jb.changeOrgchartTab(nb),null==f||c||jb.swapDepartmentView(f.name,f.label)):d.name===ob?null!=f&&jb.changeOrgchartTab(f.name):(jb.tab=d.name,d.name===zb||d.name===yb?jb.changeCompanyTab(d.name):d.name===vb&&null!=f&&(jb.tab=f.name)),jb.secondaryTab}}a.$inject=["$$fromExtension","$filter","$grid","$rootScope","$scope","$timeout","$uibModal","companyObj","CompanyService","downloadExportService","employeeList","$compile","userSettingsService","featureFlagService","phoneNumberService","$location","$window","companyFundingRounds","SearchService","orgChartService","$q","uiGridConstants"],angular.module("dorgEuiApp").controller("CompanyController",a)}(),angular.module("dorgEuiApp").config(["$stateProvider","dorgConfig",function(a,b){a.state("view_company",{url:"/company/{detailsFor:[0-9]+}?{orgChart:[0-9]}&employeeList",templateProvider:["companyObj","$http","$templateCache",function(a,c,d){var e="app/views/company/company.html",f=function(a){return a.data};switch(a.status){case 418:case 409:case 404:return d.get(b["TPL_"+a.status])?d.get(b["TPL_"+a.status]):c.get(b["TPL_"+a.status]).then(f);default:return d.get(e)?d.get(e):c.get(e).then(f)}}],controllerProvider:["companyObj",function(a){switch(a.status){case 418:case 409:return b["CTRL_"+a.status];case 404:return;default:return"CompanyController as companyVm"}}],resolve:{detailsFor:["$stateParams",function(a){return a.detailsFor}],$$fromExtension:["$stateParams",function(a){return a.orgChart}],companyObj:["detailsFor","CompanyService",function(a,b){return b.$fetch(a)}],employeeList:["$stateParams",function(a){return a.employeeList}],respData:["companyObj",function(a){return a}],companyFundingRounds:["CompanyService","respData",function(a,b){return _.includes([418,409,404],b.status)?{}:a.getCompanyFundingRounds(b.id)}],$title:["companyObj",function(a){switch(a.status){case 418:case 409:case 404:return b["MSG_"+a.status];default:return a.name}}]}})}]),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(b){return P={},c.get("api/rest/companies/"+b).then(function(b){return _.each(d.$getD(b).companyDepartments,function(a){N[a.departmentId]=a.departmentName,O[a.departmentName]=a.departmentId}),a.$orgDetailsLink=d.$fetchLink(b.data,"orgChartDetailedPersonList"),Q=b.data._links,_.each(b.data._links,function(a,c){if(_.endsWith(c,"OrgChart")){var d=c.slice(0,-8);j(b.data.companyDepartmentsForOrgChart,d)&&(M.push(d),P[d]=null)}}),b.data},function(a){return a})}function j(a,b){var c=_.find(a,{departmentName:b});return null!=c&&c.havingEmployee}function k(a){var b=Q[a+"OrgChart"];if(null!=b)return M.push(a),P[a]=c.get(b.href).then(function(b){return b.data.employees.length>0&&(O[a]=_.findKey(N,function(b){return b===a})),b.data}),P[a]}function l(a){return e.$get("api/rest/companies/"+a).then(function(a){return a},function(a){return a})}function m(a){var b=[],c=[];return _.each(a.employees,function(a){a.isSelected=!1,a.reporters.length>0?c.push(a):(a.isOrphan=!0,b.push(a))}),b.sort(function(a,b){return a.person.fullName>b.person.fullName?1:a.person.fullName<b.person.fullName?-1:0}),c.concat(b)}function n(a){return a.then(function(a){return a.employees.length>0?m(a):[]})}function o(){var a={};return _.each(P,function(b,c){return null==b?void(a[c]=[]):void(a[c]=b.then(function(a){return a.employees.length>0?m(a):[]}))}),b.all(a).then(function(a){var b={},c={};_.each(a,function(a,c){b[c]=a});for(var d=0,e=M.length;d<e;++d)_.has(b,M[d])&&(c[M[d]]=b[M[d]]);return E(c)?{}:c})}function p(a){return B(a,"technologyCategories")}function q(a){return B(a,"technologies")}function r(a,b,c,d,e){return B(a,"oppalerts",b,c,"",d,e)}function s(a,b,c,d){return B(a,"intel",b,c,d)}function t(a,e,f,g,h){if(T={companyIds:[a.id]},f&&(T.departmentIds=[f]),T.includeOutOfScopeResults=!!h,g)for(var i in g)T[i]=g[i];var j=b.defer(),k=e||{page:0,size:50},l="api/rest/persons/search";return j.resolve(c.post(l,T,{params:k}).then(function(a){return{personList:d.$getD(a.data),_page:a.data.page||{totalElements:0,page:0,size:0}}})),j.promise}function u(a){return B(a,"recentPastEmployees")}function v(a){return B(a,"similarCompanies")}function w(a){return B(a,"locations")}function x(a,b){for(var c in a)if("dOrgCompanyId"===c)a[c]&&a.online?(a.profiled=!0,a.useImage=a.icon32Path&&a.icon32Path.trim().length>0):(a.profiled=!1,a.useImage=!1);else if("relationshipType"===c)"Brand"===a[c]&&(a.city=b.city,a.state=b.state);else if("children"===c){var d=a[c].length;d>0&&a.children[d-1].children.length>0&&(a.children[d-1].dangler=!0,ia=!0);for(var e=a[c],f=0;f<e.length;f++){if(S.push({cardId:e[f].key,displayName:e[f].displayName}),ia)for(var g=a.children[e.length-1].children,h=0;h<g.length;h++)g[h].children.length>0&&(g[h].dangler=!1,ia=!1);x(e[f],a)}}return a}function y(a){var b=[],d="api/rest/companies/"+a+"/corporatehierarchy";return c.get(d).then(function(a){if(a.data){var c=x(a.data);b.push(c)}return b})}function z(){return h.findFeatureFlag(null,"comp_profile_finance")}function A(a){return c.get("api/rest/companies/companyFundingRounds/"+a).then(function(a){return a.data})}function B(a,b,e,f,g,h,i){var j="",k=d.$fetchLink(a,b);if(!_.isUndefined(e)&&!_.isUndefined(f)){j="?page="+e+"&size="+f;var l=k.indexOf("?page");l>-1&&(k=k.substring(0,l)+j),_.isNull(h)||(k=k+"&sortField="+encodeURIComponent(h)),_.isNull(i)||(k=k+"&sortOrder="+i),g&&""!==g&&(k=k+"&keyword="+encodeURIComponent(g))}return c.get(k).then(function(a){return d.$getD(a.data)})}function C(a,b){var e=d.$fetchLink(a,"respmatrixusersettings");return c.get(e,{params:{departmentId:b}}).then(function(a){return a.data})}function D(a,b,e,f){var g=_.map(e,function(a){var b=_.find(f,{displayName:a.displayName});return b.jobId}),h=_.map(f,function(a){if(_.has(a,"visible")&&!a.visible)return a.jobId}),i={departmentId:b,enabledJobFunctionIds:g,disabledJobFunctionIds:_.compact(h)},j=d.$fetchLink(a,"respmatrixusersettings");c.post(j,i)}function E(a){if(_.isEmpty(a))return!0;if(_.isObject(a)){var b=_.any(a,function(a,b){return!_.isEmpty(a)});return!b}return!0}function F(a,b){var d="api/rest/companies/"+a+"/intel/counts";return _.isEmpty(b)||(d=d+"?keyword="+b),c.get(d).then(function(a){return a.data})}function G(a){var b="api/rest/companies/"+a+"/technologies/counts";return c.get(b).then(function(a){return a.data})}function H(a){var b="api/rest/companies/oppalerts/"+a+"/counts";return c.get(b).then(function(a){return a.data.searchCriteriaScoped})}function I(a){var b="api/rest/tier2/people/company/"+a+"/counts";return c.get(b).then(function(a){return a.data.totalAccessable})}function J(a,b){var d="api/rest/companies/jobfunctions";return c.get(d,{params:{ids:b}}).then(function(a){return a.data})}function K(a){var b="api/rest/companies/checkCompanyHasContactOnline/"+a;return c.get(b).then(function(a){return a.data.isHasContactOnline})}function L(){var a="api/rest/selectoptions/senioritylevels";return c.get(a).then(function(a){return a.data})}var M=[],N={},O={},P={},Q=[],R=this,S=[],T={},U="info",V="financials",W="funding",X="technologies",Y="oppalerts",Z="intel",$="map",aa="similar",ba="hierarchy",ca="orgCharts",da="employees",ea="currentEmployees",fa="recentlyLeftEmployees",ga="responsibilityMatrix",ha="intelligence";R.infoTabKey=U,R.financialsTabKey=V,R.technologiesTabKey=X,R.oppalertsTabKey=Y,R.intelTabKey=Z,R.mapTabKey=$,R.similarTabKey=aa,R.hierarchyTabKey=ba,R.fundingInfoKey=W,R.orgChartsTabKey=ca,R.employeesTabKey=da,R.currentEmployeesTabKey=ea,R.recentlyLeftEmployeesTabKey=fa,R.responsibilityMatrixTabKey=ga,R.intelligenceTabKey=ha,R.hierarchyIdValueMapping=S,R.$fetch=i,R.$getSingleEnt=l,R.checkBulk=g.$checkPersons,R.companyIcon=f.getCompanyIcon,R.deptFields=N,R.getEmployees=t,R.getIntel=s,R.getMapStyle=f.getStyle,R.getOppAlerts=r,R.getOrgCharts=o,R.getOrgChartByDepartment=n,R.findOrgChartDataByDepartment=k,R.getPastEmployees=u,R.getSimilarCompanies=v,R.getTechnologies=q,R.getTechnologyCategories=p,R.invertedDeptFields=O,R.getCompanyLocations=w,R.getJobFunctionsSettingByDepartmentName=C,R.saveJobFunctionsDisplaySetting=D,R.getSeniorityLevels=L,R.getCompanyHierarchy=y,R.getCompanyFundingRounds=A,R.isEmptyOrgChart=E,R.getIntelCounts=F,R.getTechnologiesCounts=G,R.getOppAlertsCount=H,R.getTierTwoPeopleCount=I,R.getJobFunctionsByIds=J,R.checkCompanyHasContactOnline=K,R.isContentProfileFinance=z;var ia=!1}angular.module("dorgEuiApp").service("CompanyService",a),a.$inject=["$rootScope","$q","$http","$embeddedUtils","halClient","maps","$checkBulk","featureFlagService"]}(),function(){"use strict";function a(a){function c(){f.company=angular.copy(f.company);var c=f.company;c.locationString=d(),c.treeNodeContentClass=b[c.relationshipType].treeNodeContentClass,c.companyIconColorClass=b[c.relationshipType].companyIconColorClass,c.icon32Path=a.Session.navigation.$href("cdnBaseUrl")+c.icon32Path,c.ultimateParentLocation="",c.companyNameTruncatedClass=b[c.relationshipType].companyNameTruncatedClass,c.isTruncatedCompanyInfo=e(c.relationshipType,f.company.displayName)}function d(){var a=f.company,b="";return a.city&&(b+=a.city+", "),a.state&&(b+=a.state),!a.state&&a.country&&(b+=a.country),a.cardId=a.key,"Ultimate Parent"===a.relationshipType&&(a.ultimateParentLocation=b),b&&(a.locationString=b),b}function e(a,b){switch(a){case"Subsidiary":return b.length>65;case"Brand":return b.length>70;default:return b.length>63}}var f=this;f.$onInit=c}var b={"Ultimate Parent":{treeNodeContentClass:"ultimateParentCompany",companyIconColorClass:"ultimateParentColor",companyNameTruncatedClass:"ultimate-parent-truncated"},Division:{treeNodeContentClass:"divisionCompany",companyIconColorClass:"divisionColor",companyNameTruncatedClass:"division-truncated"},Brand:{treeNodeContentClass:"brandCompany",companyIconColorClass:"brandColor",companyNameTruncatedClass:"brand-truncated"},Subsidiary:{treeNodeContentClass:"subsidiaryCompany",companyIconColorClass:"subsidiaryColor",companyNameTruncatedClass:"subsidiary-truncated"},Affiliate:{treeNodeContentClass:"affiliateCompany",companyIconColorClass:"affiliateColor",companyNameTruncatedClass:"affiliate-truncated"}};a.$inject=["$rootScope"],angular.module("dorgEuiApp").component("companyCard",{templateUrl:"app/views/company/partials/company-card-partial.html",bindings:{company:"<"},controller:a})}(),function(){"use strict";function a(a,b,c,d){function e(){var d=b.open(c.$addWidget(a.addableWidgets,a.items));d.result.then(function(b){a.addableWidgets=_.filter(a.addableWidgets,function(a){var c=_.find(b.data,"widget",a.widget);return _.isUndefined(c)})})}function f(){var b=c.whatsNewPrefs(),e=Date.parse(d.WHATS_NEW_DATE);(_.isEmpty(b)||e>b.updateDate)&&(a.showWhatsNewIndicator=!0)}function g(){c.$update(this.items)}function h(b){var d,e=c.getDisplayName(b.widget);b.closed=!0,d=angular.copy(b),c.$update(this.items),d.displayName=_.isUndefined(e)?b.widget:e,d.isChecked=!1,a.addableWidgets.push(d)}function i(a){a.collapsed=!a.collapsed,c.$update(this.items)}a.addableWidgets=c.$getInitialLoadable(),a.addWidget=e,a.items=c.$get().widgets,a.moved=g,a.removeWidget=h,a.reorderWidgets=!1,a.showWhatsNewIndicator=!1,a.toggleCollapse=i,f()}angular.module("dorgEuiApp").controller("DashboardCtrl",a),a.$inject=["$scope","$uibModal","dashboardService","dorgConfig"]}(),function(){"use strict";function a(a,b){function c(c,d){var e=b(d.attr("dash-module"))(c);d.removeAttr("dash-module"),d.attr("ng-controller",_.camelCase(e)+"Ctrl"),a(d)(c)}return{link:c,priority:1,restrict:"A",terminal:!0}}angular.module("dorgEuiApp").directive("dashModule",a),a.$inject=["$compile","$parse"]}(),function(){"use strict";function a(a){a.state("viewDashboard",{url:"/dashboard",templateUrl:"app/views/dashboard/dashboard.html",controller:"DashboardCtrl",resolve:{$title:function(){return"Dashboard"}}}),a.state("whatsnew",{url:"/whatsnew",templateUrl:"app/views/dashboard/whatsnew.html",controller:"WhatsNewCtrl",resolve:{$title:function(){return"What's New"}}})}angular.module("dorgEuiApp").config(a),a.$inject=["$stateProvider"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(a,b){return{controller:["$scope","$uibModalInstance",function(c,d){function e(){var a=_.filter(c.widgets,"isChecked",!0);a.length>0&&(_.each(b,function(b){_.each(b,function(b){_.isUndefined(_.find(a,"widget",b.widget))||(b.closed=!1)})}),t.$update(b)),d.close({data:a})}function f(){d.dismiss("cancel")}function g(){return _.isUndefined(_.find(c.widgets,"isChecked",!0))}c.add=e,c.close=f,c.hasSelectedWidget=g,c.widgets=a}],templateUrl:"app/views/dashboard/partials/modal.partial.html"}}function i(){var b=a.Session.account.preferences;return b.widgets=!_.isEmpty(b)&&q!==!0&&_.has(b,"widgets")&&b.widgets?b.widgets:t.sample(),r=[],_.each(b.widgets,function(a,c){_.each(a,function(a,d){var e=b.widgets[c][d];if(e.tpl=u+a.widget+"/"+a.widget+".html",e.closed===!0&&e.removable===!0){var f=angular.copy(e);f.extras={placement:c,idx:d},f.isChecked=!1,f.displayName=v[f.widget],r.push(f)}})}),b}function j(){return r}function k(b){d.cancel(p),p=d(function(){var d=angular.copy(b),h=a.Session.account.preferences;_.each(d,function(a,b){_.each(a,function(a,c){delete d[b][c].tpl})}),h.widgets=d,g.sanitizeGrid(h).then(function(b){c.post(s,b).then(function(){e.create("success","Saved Dashboard Configuration","flash")}).then(f.get).then(function(b){a.Session.account=b})})},2e3,!1)}function l(a){return v[a]}function m(){return{left:[{closed:!1,collapsed:!1,removable:!1,widget:"dorg-announcements"},{closed:!1,collapsed:!1,removable:!1,widget:"recently-added"},{closed:!1,collapsed:!1,removable:!0,widget:"recently-left"}],right:[{closed:!1,collapsed:!1,removable:!1,widget:"intel-feed"},{closed:!1,collapsed:!1,removable:!1,widget:"updated-following-lists"}]}}function n(b){var d=angular.copy(a.Session.account.preferences),e=a.Session.account.preferences;d.whatsNew={lastClosed:Date.now(),updateDate:b},e.whatsNew=d.whatsNew,_.has(d,"widgets")&&_.each(d.widgets,function(a,b){_.each(a,function(a,c){delete d.widgets[b][c].tpl})}),g.sanitizeGrid(d).then(function(b){c.post(s,b).then(f.get).then(function(b){a.Session.account=b})})}function o(){return a.Session.account.preferences.whatsNew||{}}var p,q=!1,r=[],s=a.Session.navigation.$href("accountPreferences"),t=this,u="app/components/widgets/",v={"dorg-announcements":"DiscoverOrg Announcements","intel-feed":"Intel Feed",map:"Map","recently-added":"Recently Added","recently-left":"Recently Left Employees","team-structure":"Team Structure","updated-following-lists":"Updated Records","usage-reports":"Usage Reports"};t.$addWidget=h,t.$get=i,t.$getInitialLoadable=j,t.$update=k,t.getDisplayName=l,t.sample=m,t.updateWhatsNew=n,t.whatsNewPrefs=o}angular.module("dorgEuiApp").service("dashboardService",a),a.$inject=["$rootScope","$q","$http","$timeout","Flash","account","$grid"]}(),function(){"use strict";function a(a,b){a.updateWhatsNew(Date.parse(b.WHATS_NEW_DATE))}angular.module("dorgEuiApp").controller("WhatsNewCtrl",a),a.$inject=["dashboardService","dorgConfig"]}(),angular.module("dorgEuiApp").controller("docsController",[function(){}]),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("view_api",{resolve:{$title:function(){return"API Docs"}},templateUrl:"app/views/docs/docs.html",url:"/docs"})}]),angular.module("dorgEuiApp").service("docsService",["$http",function(a){var b=window.location.origin,c=b+"/api-docs",d={};this.getRoot=function(){return b},this.getBase=function(){return c},this.getApis=function(){return d},this.init=function(){return a.get(this.getBase()).then(function(b){return _.each(b.data.apis,function(b){a.get(c+b.path).then(function(a){d[b.description]=a.data.apis})}),b.data})}}]),function(){"use strict";function a(a,b,c,d,e){function f(){c.getExportHistory().then(function(a){g.exportHistory=a;var c=!0;_.forEach(g.exportHistory,function(a){"IN_PROGRESS"!==a.status&&"QUEUED"!==a.status||(c=!1)}),c&&b.cancel(h)})}var g=this;f();var h=b(function(){f()},3e4);g.downloadFile=function(a,b){c.downloadFile(a,b),g.exportHistory.filter(function(b){return b.downloadJobId==a})[0].downloadTime=new Date,window.location.href=b},g.downloadNotificationViewed=function(a){c.notificationViewed(a)},g.setEntityTypeName=function(a){switch(a){case"COMPANY":a="Company";break;case"PERSON":a="Employee";break;case"INTEL":a="Scoops";break;case"CONSUMER":a="OppAlerts";break;case"USAGE_TRACK":a="Usage Report";break;case"PERSON_OPT_OUT":a="Person Opt Out";break;case"CORPORATE_HIERARCHY":a="Corporate Hierarchy";break;case"TIER_2_COMPANY":a="Company - Technology Generated";break;case"TIER_2_PERSON":a="Employee - Technology Generated";break;default:a="UNKNOWN"}return a}}angular.module("dorgEuiApp").controller("exportHistoryController",a),a.$inject=["$scope","$interval","exportHistoryService","$ga","$uibModal"]}(),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("export_history",{url:"/export-history",resolve:{$title:function(){return"Export History"}},templateUrl:"app/views/export-history/export-history.html",controller:"exportHistoryController",controllerAs:"vm"})}]),function(){"use strict";function a(a){function b(){return a.get("api/rest/exportHistory").then(function(a){return a.data})}function c(b,c){a.post("api/rest/exportHistory/updateDownloadTime",b).then(function(){$ga.track("Directive","Export","Download Completed")})}function d(b){a.post("api/rest/exportHistory/updateDownloadNotificationViewed",b).then(function(){})}function e(b){a.post("api/rest/exportHistory/updateDownloadNotificationsListViewed",b).then(function(){})}return b(),{getExportHistory:b,downloadFile:c,notificationViewed:d,notificationsListViewed:e}}angular.module("dorgEuiApp").service("exportHistoryService",a),a.$inject=["$http"]}(),angular.module("dorgEuiApp").controller("ForgotPasswordCtrl",["$rootScope","$scope","$log","$state","ForgotPasswordService",function(a,b,c,d,e){b.username="",b.goodToGo=!1,b.errorMessage="",b.submitRequest=function(){e.requestToken(encodeURIComponent(this.username)).then(function(a){switch(a){case 406:b.goodToGo=!1,b.errorMessage="This user account has been deactivated by your internal account administrator. Please contact your account administrator to reactivate your account.";break;case 400:b.goodToGo=!1,b.errorMessage="Authentication failed!";break;default:b.goodToGo=!0}})}}]).controller("ForgotPasswordCtrlReset",["$rootScope","$scope","$log","$state","token","forceChange","ForgotPasswordService",function(a,b,c,d,e,f,g){var h=function(a){var b=a.data||null;return{status:a.status,user:b}},i=function(a){a.user&&200===a.status?b.user=a.user:b.badToken=!0},j=function(a){switch(a.status){case 412:b.msgCode=1;break;case 406:b.msgCode=2;break;case 200:b.msgCode=4;break;case 401:_.isEqual("WRONG_PASSWORD",a.user)?b.msgCode=5:b.msgCode=3;break;default:b.msgCode=3}};b.token=e,b.badToken=!1,b.passLen=!1,b.passes={password:"",confirmPassword:""},b.forceChange=f,b.messages=[{msg:"Looks like your passwords do not match.",type:"danger"},{msg:"Password must be between eight and twenty characters long, contain one Uppercase character, one lowercase character, a number, and a symbol.",type:"warning"},{msg:"Password cannot match a password you have used the last three times.",type:"warning"},{msg:"An unknown error has occurred, please try again.",type:"info"},{msg:'Your password has been successfully changed. Please click <a href="#/login">here</a> to login.',type:"success"},{msg:"The current password is invalid.",type:"danger"}],b.msgCode=-1,g.validateToken(e).then(h,h).then(i),b.update=function(){b.passes.password!==b.passes.confirmPassword?b.matchedPassFail=!0:b.forceChange?g.registerNewPasswordForForcePassReset(b.user,b.passes.password,b.passes.currentPassword,e).then(h,h).then(j):g.registerNewPassword(b.user,b.passes.password,e).then(h,h).then(j)},b.$watch("passes",function(a,c){if(a!==c){var d=0;a.password.length>7&&a.confirmPassword.length>7&&(d+=1),a.confirmPassword===a.password&&(d+=1),b.passLen=2===d}},!0)}]),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("forgot-password",{url:"/forgot-password",templateUrl:"app/views/forgot-password/forgot-password.html",controller:"ForgotPasswordCtrl",resolve:{$title:function(){return"Forgot Password Request"}}}).state("forgot-password-token",{url:"/forgot-password/{token:.*}",templateUrl:"app/views/forgot-password/forgot-password-reset.html",controller:"ForgotPasswordCtrlReset",resolve:{token:["$stateParams",function(a){return a.token}],$title:function(){return"Forgot Password Update"},forceChange:function(){return!1}}}).state("force-reset-password-token",{url:"/reset-password/{token:.*}",templateUrl:"app/views/forgot-password/forgot-password-reset.html",controller:"ForgotPasswordCtrlReset",resolve:{token:["$stateParams",function(a){return a.token}],$title:function(){return"Forgot Password Update"},forceChange:function(){return!0}}})}]),angular.module("dorgEuiApp").factory("ForgotPasswordService",["$http",function(a){var b=function(a){return a.status};return{requestToken:function(c){return a.post("api/password/reset?username="+c,{ignoreAuthModule:"ignoreAuthModule"}).then(b,b)},validateToken:function(b){var c=encodeURIComponent(encodeURIComponent(b));return a.get("api/request/validate/"+c,{ignoreAuthModule:"ignoreAuthModule"})},registerNewPassword:function(b,c,d){var e=encodeURIComponent(encodeURIComponent(d));return a.put("api/password/reset/"+e,{user:b,newPassword:c,confirmNewPassword:c},{ignoreAuthModule:"ignoreAuthModule"})},registerNewPasswordForForcePassReset:function(b,c,d,e){var f=encodeURIComponent(encodeURIComponent(e));return a.put("api/password/force-reset/"+f,{user:b,newPassword:c,confirmNewPassword:c,randomPassword:d},{ignoreAuthModule:"ignoreAuthModule"})}}}]),function(){"use strict";function a(a,b,c,d,e){var f=this;f.sQRunning=!1,f.qsQuery="",f.clearSearch=function(){f.qsQuery=""},f.refreshQuickSearch=function(a){f.sQRunning=!0,c.track("Quick Search","Request","Started");var b={companyCount:5,personCount:5,tierTwoCompanyCount:3,tierTwoPersonCount:3};return e.$quickSearch(a,b).then(function(b){return f.sQRunning=!1,c.track("Quick Search","Request","Resolved"),b||c.track("Quick Search","Failed","Term: "+a),b})},f.qsSelected=function(b,e){f.qsQuery=b.displayName,c.track("Quick Search","Request","Selected Result",("COMPANY"===b.entityType?"Company: ":"Person: ")+b.id),a.$qschChildId=b.childId||null,d.go("COMPANY"===b.entityType?"view_company":"view_person",{detailsFor:b.id})}}angular.module("dorgEuiApp").controller("landingController",a),a.$inject=["$rootScope","$scope","$ga","$state","quickSearch"]}(),function(){"use strict";function a(a){a.state("viewQuickSearch",{url:"/quicksearch",controller:"landingController as qs",templateUrl:"app/views/landing/landing.html",data:{$title:"Quick Search"}})}angular.module("dorgEuiApp").config(a),a.$inject=["$stateProvider"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l){function m(c){a.Session.resource=c,b.BANNER_IMG_PATH=c.$href("cdnBaseUrl")+g.BANNER_IMG_PATH,r(b.BANNER_IMG_PATH)}function n(a){b.userNotActivated=!1,b.passwordResetRequired=!1,b.authenticationError=!1,b.concurrentSessionError=!1,b.deviceRegistration.canReregister=!1,b.deviceRegistration.emailSent=!1,b.deviceRegistration.max=!1,b.sessionTimeout=!1,b.attemptingLogin=!1;var d;a?(b.toggleRedirectLoginSpinner=!0,d={username:u+l,password:l,rememberMe:b.rememberMe}):(b.attemptingLogin=!0,d={username:_.isUndefined(b.username)?document.getElementById("username").value:b.username,password:_.isUndefined(b.password)?document.getElementById("loginPassword").value:b.password,rememberMe:b.rememberMe}),f.login(d).then(function(a){if(k(function(){b.toggleRedirectLoginSpinner=!1,b.attemptingLogin=!1},2e3),_.has(a.headers(),"require-tfa")){var d=JSON.parse(a.headers()["require-tfa"]);switch(d.method){case"REGISTER":c.go("two-factor-auth");break;case"SMS":c.go("two-factor-auth-verify",{tfaMethod:d});break;case"EMAIL":c.go("two-factor-auth-verify",{tfaMethod:d})}}return _.has(a.data,"browserRegistered")&&resource.browserRegistered&&e.open({controller:["$scope","$uibModalInstance",function(a,b){a.close=b.dismiss}],templateUrl:"app/views/login/browser.modal.tpl.html"}),i.initData(),resource},function(a){b.toggleRedirectLoginSpinner=!1,b.attemptingLogin=!1,a.userNotActivated?b.userNotActivated=!0:a.userAccountLocked?b.userAccountLocked=!0:a.passwordResetRequired?b.passwordResetRequired=!0:a.maxRegisteredBrowsers?(b.deviceRegistration.max=!0,_.has(a.headers(),["deregister-email-sent"])?b.deviceRegistration.deregisterEnabledDate=moment(a.headers.deregister-email-sent).add(1,"days").format("MMM D, h:mm a"):b.deviceRegistration.deregisterEnabledDate="later",_.has(a.headers(),["trigger-deregister-email-link"])?(b.deviceRegistration.canReregister=!0,b.deviceRegistration.link=a.headers()["trigger-deregister-email-link"]):b.deviceRegistration.link=null):a.redirectToDozi||(b.authenticationError=!0)}).finally(function(){b.attemptingLogin=!1})}function o(){c.go("forgot-password")}function p(){i.setReregisterDevice(b.deviceRegistration.link,b.username).then(function(){b.deviceRegistration.canReregister=!1,b.deviceRegistration.emailSent=!0})}function q(a){return"url('"+a+"')"}function r(a){x=x||$(v),x&&x[0]&&a&&(x[0].style.backgroundImage=q(a))}if(a.Session&&a.Session.authenticated)return void c.go("main");var s="loginRightPanelContainerId",t="loginRightPanelContentId",u="@@@",v="#"+s,w="#"+t,x=null;b.loginRightPanelContainerId=s,b.loginRightPanelContentId=t,h.$get("api").then(m),b.attemptingLogin=!1,b.concurrentSessionError="CONCURRENT_USER"===d.status,b.login=n,b.oldestDeregistered="EMAIL_TRIGGER_SUCCESS"===d.status,b.rememberMe=!0,b.requestPasswordReset=o,b.reregisterDevice=p,b.sessionTimeout="-3"===c.params.bounceMsg,b.usernameRequiredError=!1,b.toggleRedirectLoginSpinner=!1,b.deviceRegistration={max:!1,canReregister:!1,link:null},angular.element(document).ready(function(){null!=l&&(b.toggleRedirectLoginSpinner=!0),x=$(v),i.getLoginRightPanelContent().then(function(a){var b=$(w);b&&b[0]&&a&&(b[0].innerHTML=a),null!=l&&n(!0)})})}angular.module("dorgEuiApp").controller("LoginCtrl",a),a.$inject=["$rootScope","$scope","$state","$stateParams","$uibModal","authentication","dorgConfig","halClient","LoginService","$cookies","$timeout","toggleUUID"]}(),function(){"use strict";angular.module("dorgEuiApp").config(["$stateProvider","dorgConfig",function(a,b){a.state("login",{url:"/login?status&uuidToken",templateUrl:"app/views/login/login.html",controller:"LoginCtrl",params:{bounceMsg:0,status:null},resolve:{$title:function(){return"Login"},toggleUUID:["$stateParams",function(a){
return a.uuidToken}]},onEnter:[function(){if(!(window.location.hostname.indexOf("go")<0)){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.setAttribute("id","fks-"+b.FKS_KEY),a.setAttribute("fk-public-key",b.FKS_KEY),a.setAttribute("fk-server","app.listenloop.com"),a.src=b.FKS_URL,document.body.appendChild(a)}}],onExit:function(){window.location.hostname.indexOf("go")<0||document.body.removeChild(document.getElementById("fks-"+b.FKS_KEY))}}).state("logout",{url:"/logout",onEnter:["authentication","$state",function(a,b){a.logout().then(function(){b.go("login")})}]})}])}(),function(){"use strict";function a(a,b,c,d,e){function f(){l(),h().then(function(a){a.data&&(m.hasDisabledEmailMatching=a.data.hasDisabledEmailMatching)})}function g(a,d){var e=c.defer(),f=a;return a&&d?b.post(f,d).then(function(a){e.resolve(a.data)},function(){e.reject(!1)}):e.reject(!1),e.promise}function h(){var a=c.defer(),d=n+"account/emailMatchingDisabled";return b.get(d,{}).then(function(b){a.resolve(b)}).catch(function(b){a.reject(b)}),a.promise}function i(){j().then(function(a){if(a.data){var b=a.data;b&&e.open({controller:["$scope","$uibModalInstance",function(a,c){a.loginAlertInformation=b,a.close=c.dismiss}],templateUrl:"app/views/login/loginAlertUploadExportExpiration.modal.tpl.html"})}})}function j(){var a=c.defer(),d=n+"account/loginAlertUploadExportExpiration";return b.get(d,{}).then(function(b){a.resolve(b)}).catch(function(b){a.reject(b)}),a.promise}function k(){var a=o+"loginpage/loginRightPanelContent";return b.get(a).then(function(a){return a.data||""},function(){return""})}function l(){var a=["curShowOppAlertSavedSearchId","curShowOppAlertSavedSearchName","curShowSavedSearchId","curShowSavedSearchName"];_.each(a,function(a){d[a]&&delete d[a]})}var m=this,n="api/rest/",o="api/request/";a.$fetchLink;m.hasDisabledEmailMatching=!1,m.setReregisterDevice=g,m.getUserEmailMatchingDisabledInformation=h,m.showUserLoginAlertUploadExportExpiration=i,m.initData=f,m.getLoginRightPanelContent=k}angular.module("dorgEuiApp").service("LoginService",a),a.$inject=["$embeddedUtils","$http","$q","$rootScope","$uibModal"]}(),angular.module("dorgEuiApp").controller("MainCtrl",function(){}),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("main",{url:"/?status&toggleFlowError",params:{status:null,toggleFlowError:null},templateUrl:"app/views/main/main.html",controller:["$rootScope","$state","$stateParams",function(a,b,c){if(a.Session&&a.Session.authenticated){a.Session.toggleFlowError=c.toggleFlowError;var d=angular.copy(a.Session.account);if(_.isEmpty(d.preferences))b.go("viewQuickSearch",c);else{var e=_.isEmpty(d.preferences)?d.preferences={}:d.preferences,f=["perform_search","viewDashboard","viewQuickSearch"];(!e.hasOwnProperty("landing")||f.indexOf(e.landing)<0)&&(e.landing="viewQuickSearch"),b.go(e.landing,c)}}else a.Session.toggleFlowError=null,b.go("login",c)}]})}]),angular.module("dorgEuiApp").controller("ManageAlertsCtrl",["$rootScope","$scope","$filter","uiGridConstants","ManageAlertsService","resolvedView",function(a,b,c,d,e,f){var g=f.entityList;b.alertsSubscriptionModel=e.$defaultGrid(g),b.deleteAlertSubscription=function(a){e.$delete(a).then(function(){g=_.reject(g,{id:a.id}),b.alertsSubscriptionModel.data=g})},b.notifyDataChange=function(){b.alertsSubscriptionModel.api.core.notifyDataChange(d.dataChange.EDIT)}}]),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("manage_alerts",{title:"DiscoverOrg - Opportunity Alerts",url:"/manage-alerts",templateUrl:"app/views/managealerts/manage-alerts.html",controller:"ManageAlertsCtrl",resolve:{resolvedView:["ManageAlertsService","$q",function(a,b){var c=b.defer(),d={entityList:null,canCreate:!1,model:null};return a.query().then(function(a){return d.entityList=a,c.resolve(d),c.promise})}]}})}]),function(){function a(a,b,c){this.query=function(){return a.Session.navigation.$get("manage_alerts").then(function(a){return null===a?[]:a.$has("contentConsumerAlertsResourceList")?a.$get("contentConsumerAlertsResourceList").then(function(a){return a},function(a){return a}):[]})},this.$get=function(a){return a.$get("self")},this.$delete=function(a){return a.$del("self")},this.$defaultGrid=function(a){a=a||[];for(var b=[{field:"name",sort:{direction:"asc",priority:1}},{cellTemplate:"app/services/globals/grid_tpls/manage-alerts/actions_tpl.html",enableFiltering:!1,enableSorting:!1,field:"actions",width:100}],d=0,e=b.length;d<e;++d)b[d].enableColumnMenu=!1,b[d].cellTooltip=!0,b[d].filter||(b[d].filter={condition:c.filter.CONTAINS});return{columnDefs:b,data:a,enableFiltering:!0,enableHorizontalScrollbar:!1,enablePaginationControls:!1,enableGridMenu:!1,enableRowSelection:!1,onRegisterApi:function(a){this.api=a},paginationPageSizes:[10,25,50,75],paginationPageSize:10,pagesToShow:10,virtualizationThreshold:75}}}angular.module("dorgEuiApp").service("ManageAlertsService",a),a.$inject=["$rootScope","$q","uiGridConstants"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){c.isOppAlertType=w(),c.isOppAlertType&&k()}function k(){var a=new Date(c.alertFilter.dateFrom).valueOf(),b=new Date(c.alertFilter.dateTo).valueOf();if(b||o(),a||p(),a||b){var d=moment(),e=moment().subtract(3,"months");d.startOf("day"),e.startOf("day"),b&&(b>d.valueOf()||b<e.valueOf())&&o(),a&&(a<d.subtract(3,"months").valueOf()||a>moment().startOf("day").valueOf())&&p()}}function l(a){return h.findFeatureFlag(null,"triggerstoscoops")?a[2].displayName="Scoops":c.intelText="Triggers",a}function m(){return c.subjectType&&"topcontentconsumer"==c.subjectType}function n(){_.startsWith(c.alertFilter.subscriptionType.displayName,"Employee")?(c.subjectType="person",c.exportType="persons"):_.startsWith(c.alertFilter.subscriptionType.displayName,"Compan")?(c.subjectType="company",c.exportType="companies"):_.startsWith(c.alertFilter.subscriptionType.displayName,"Trig")||_.startsWith(c.alertFilter.subscriptionType.displayName,"Sco")?(c.subjectType="intel",c.exportType="intel"):_.startsWith(c.alertFilter.subscriptionType.displayName,E)?c.subjectType="topcontentconsumer":c.subjectType="default"}function o(){var a=new Date;c.alertFilter.dateTo=I(a)}function p(){var a=_.isDate(c.alertFilter.dateTo)?c.alertFilter.dateTo:new Date,b=new Date;b.setTime(a.getTime()-6048e5),c.alertFilter.dateFrom=I(b)}function q(a,b){"person"===c.subjectType&&(c.totalItems=0),f.getAlerts(a,c.subjectType,b).then(function(a){var b=c[B];b.data=a.data,b.totalItems=a.page?a.page.totalElements:0,b.paginationCurrentPage=1,"person"===c.subjectType&&(c.totalItems=_.filter(_.uniq(a.data,"personId"),function(a){if(!a.lockedContent)return a}).length),b.totalItems>0?c.disableExport=!1:c.disableExport=!0,a.page&&(b.paginationCurrentPage=a.page.number+1),"intel"===c.subjectType&&(b.rowHeight=90),"topcontentconsumer"!==c.subjectType&&(b.paginationPageSize=100),c.dataLoaded=!0,c.showLoading=!1})}function r(a,b){c.showLoading=!0,m()?i.checkOppAlertSubscriptionWithNoTopic().then(function(d){c.isOppAlertTopicEmpty="true"==d,c.isOppAlertTopicEmpty?(y(c[B]),c.disableExport=!1,c.showLoading=!1):q(a,b)}):q(a,b)}function s(a){this.api=a,this.appScope=c,this.paginationPageSize=D,this.paginationPageSizes=[10,25,50,75,100],this.selectionRowHeaderWidth=35,this.totalItems=0,this.useExternalFiltering=!0,this.useExternalPagination=!0,this.useExternalSorting=!0,this.enableGridMenu=!1,this.api.pagination.on.paginationChanged(c,function(a,b){c[B].params.page=a-1,c[B].params.size=b,t(c[B].params)}),this.api.core.on.sortChanged(c,function(a,b){var d=v(a,b,c[B].params.sortField);c[B].params.sortField=d.colName,c[B].params.sortOrder=d.order,t(c[B].params)}),this.api.core.on.filterChanged(c,function(){c[B].params.textSearchString=u(this.grid),t(c[B].params)})}function t(a){r(c.alertRequest,a)}function u(a){for(var b=0;b<a.columns.length;b++)if("companyName"===a.columns[b].field&&a.columns[b].filter.term)return a.columns[b].filter.term}function v(a,b,c){var d={};return 0!==b.length&&(d.colName=b[0].name.replace(" ","_"),d.order=b[0].sort.direction),d}function w(){return null!=c.alertFilter.subscriptionType&&_.startsWith(c.alertFilter.subscriptionType.displayName,E)}function x(){c.totalItems=0,y(c.uiTablealertPerson),y(c.uiTablealertCompany),y(c.uiTablealertIntel),y(c.uiTablealertTopcontentconsumer)}function y(a){a&&(a.data=[],a.totalItems=0,a.paginationCurrentPage=1,c.disableExport=!0)}function z(a,b){b&&_.isEqual(a,b)||(j(),x())}var A,B,C=" UTC-8",D=25,E="Opp",F=function(b,c){if(b["uiTable"+c]=a.$defaultGrid(c,[],!0,!0),"alertIntel"===c)for(var d=0;d<b["uiTable"+c].columnDefs.length;d++)if("publishDate"===b["uiTable"+c].columnDefs[d].field){b["uiTable"+c].columnDefs[d].filters=[{type:"date",condition:function(a,b){if(!a)return!0;var c=G(b),d=H(a);return c>=d},placeholder:"After"},{type:"date",condition:function(a,b){if(!a)return!0;var c=G(b),d=H(a);return c<=d},placeholder:"Before"}];break}},G=function(a){var b=new Date(a);return new Date(b.getFullYear(),b.getMonth(),b.getDate())},H=function(a){var b=a.replace(/\\/g,"");return new Date(b)},I=function(a){return("0"+(a.getMonth()+1)).slice(-2)+"/"+("0"+a.getDate()).slice(-2)+"/"+a.getFullYear()};c.alertRequest={},c.availableLists={},c.canExport=!1,c.dataLoaded=!1,c.disableExport=!0,c.listSubscriptions=[],c.sourceListTypes=g.sourceListTypes,c.subscriptionTypes=l(g.subscriptionTypes),c.supportData=g,c.onSelectSubscriptionType=z,c.isOppAlertType=!1,c.oppAlertMinDateLimit=moment().subtract(3,"months").toDate(),c.alertFilter={sourceListType:null,listSubscription:null,subscriptionType:null,dateFrom:null,dateTo:null},c.followCompanySource=_.find(c.sourceListTypes,"displayName","Followed Companies"),c.followEmployeesSource=_.find(c.sourceListTypes,"displayName","Followed Persons"),c.subscriptionsSource=_.find(c.sourceListTypes,"displayName","Subscriptions"),c.followCompanySource.label="Companies List",c.followEmployeesSource.label="Persons List",c.subscriptionsSource.label="Subscription",c.showLoading=!1,c.isOppAlertTopicEmpty=!1,c.totalItems=0,f.$subscriptionAvailableLists().then(function(a){a=_.sortBy(a,"name"),c.availableLists[c.subscriptionsSource.id]=a,f.$followedCompaniesList().then(function(a){_.each(a,function(a){a.name=a.displayName}),a=_.sortBy(a,"name"),c.availableLists[c.followCompanySource.id]=a}),f.$followedEmployeesList().then(function(a){_.each(a,function(a){a.name=a.displayName}),a=_.sortBy(a,"name"),c.availableLists[c.followEmployeesSource.id]=a}),F(c,"alertPerson"),F(c,"alertCompany"),F(c,"alertIntel"),F(c,"alertTopcontentconsumer"),c.uiTablealertTopcontentconsumer.onRegisterApi=s,_.isUndefined(d.params)||_.isEmpty(d.params.subId)||c.loadSubscription(d.params.subId)}),e.$formats().then(function(a){a.length&&(c.canExport=!0)}),c.$watch("alertFilter",function(a,b){angular.equals(a,b)||null!==c.alertFilter.listSubscription&&null!=c.alertFilter.sourceListType&&(n(),c.find())},!0),c.onAlertSourceTypeChange=function(){null===c.alertFilter.sourceListType?c.listSubscriptions=[]:c.listSubscriptions=c.availableLists[c.alertFilter.sourceListType.id],j(),x()},c.listSubscriptionChange=function(){if(c.subscriptionTypes=[],c.alertFilter.listSubscription){var a;c.subscriptionsSource===c.alertFilter.sourceListType?(a=_.find(c.supportData.subscriptionTypes,"id",c.alertFilter.listSubscription.subscriptionType),c.subscriptionTypes.push(a),c.alertFilter.subscriptionType=a):c.followEmployeesSource===c.alertFilter.sourceListType?(a=_.find(c.supportData.subscriptionTypes,"displayName","Employees"),c.subscriptionTypes.push(a),c.alertFilter.subscriptionType=a):(c.subscriptionTypes=c.supportData.subscriptionTypes,c.alertFilter.subscriptionType=_.find(c.supportData.subscriptionTypes,"displayName","Companies"))}j(),x()},c.find=function(a){c.showLoading=!0,c.alertFilter.dateTo||o(),c.alertFilter.dateFrom||p();var b={dateFrom:new Date(c.alertFilter.dateFrom+C),dateTo:new Date(c.alertFilter.dateTo+C)};c.alertFilter.sourceListType===c.subscriptionsSource?b.alertsSubscriptionId=c.alertFilter.listSubscription.id:(b.sourceListId=c.alertFilter.listSubscription.id,b.sourceListType=c.alertFilter.sourceListType.id,b.subscriptionType=c.alertFilter.subscriptionType.id),c.alertRequest=b,n(),c.gridView="app/views/my-alerts/partials/"+c.subjectType+"-table.view.html",A="alert"+_.capitalize(c.subjectType),B="uiTable"+A,_.has(c[B],"pagingParam")?a=void 0:("topcontentconsumer"===c.subjectType&&(c[B].params={page:0,size:D}),"intel"===c.subjectType&&(c[B].params={page:0,publishDate:{minValue:null,maxValue:null}}),a=c[B].params),r(b,a)},c.listSubscriptionLabel=function(){return _.isEmpty(c.alertFilter.sourceListType)?"List / Subscription":c.alertFilter.sourceListType.label},c.loadSubscription=function(a){c.alertFilter.sourceListType=c.subscriptionsSource,c.onAlertSourceTypeChange();var b=_.find(c.availableLists[c.subscriptionsSource.id],"id",parseInt(a));_.isUndefined(b)||(c.alertFilter.listSubscription=b,c.listSubscriptionChange(),c.find())},c.clear=function(){for(var a in c.alertFilter)c.alertFilter[a]=null;j(),x()},c.countTotalItems=function(){return c.totalItems}}angular.module("dorgEuiApp").controller("MyAlertsControllerAll",a),a.$inject=["$grid","$rootScope","$scope","$state","downloadExportService","MyAlertsService","supportData","featureFlagService","TopContentConsumerService"]}(),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("viewMyAlerts",{controller:"MyAlertsControllerAll",params:{subId:null},resolve:{$title:function(){return"My Alerts"},supportData:["MyAlertsService",function(a){return a.$supportData()}]},templateUrl:"app/views/my-alerts/my-alerts.html",url:"/account/alerts"}).state("redirectMyAlerts",{url:"/alerts/subscription/{id:.*}",controller:["$state","id",function(a,b){a.go("viewMyAlerts",{subId:b})}],resolve:{id:["$stateParams",function(a){return a.id}]}})}]),angular.module("dorgEuiApp").service("MyAlertsService",["$rootScope","$http","$embeddedUtils","featureFlagService","intelArticleParserService",function(a,b,c,d,e){var f=a.Session.navigation.$href("viewMyAlerts"),g={},h=this;this.$subscriptionAvailableLists=function(){return b.get(f).then(function(a){return _.each(a.data._links,function(a,b){g[b]=a.href}),b.get(g.subscriptionLists).then(function(a){return c.$getE(a.data)})})},this.$followedCompaniesList=function(){return b.get(g.followCompanyLists).then(function(a){return c.$getE(a.data)})},this.$followedEmployeesList=function(){return b.get(g.followPersonLists).then(function(a){return c.$getE(a.data)})},this.processIntels=function(a){var b=d.findFeatureFlag(null,"triggerstoscoops");_.each(a,function(a){a.article=e.parseArticle(null,a,b,!0,0,""),b||(a.typeId=0===a.typeId?"None":1===a.typeId?"Personnel":"Project")})},this.getAlerts=function(a,d,e){var g={};return _.isUndefined(e)?g.params={page:0,size:9999}:g.params=e,b.post(f+"/"+d+"alerts",a,g).then(function(a){var b=c.$getE(a.data);return"intel"===d&&h.processIntels(b),{data:b,page:a.data.page}},function(a){console.log(a)})},this.$supportData=function(){return b.get(f+"/supportdata").then(function(a){return a.data})}}]),function(){"use strict";function a(a,b,c,d){function e(a,b){d.$broadcast("event:downloadProgress",{id:b,data:{percent:100,filePath:a,exportState:"SUCCESS"}}),c.track("Directive","Export","Download Completed")}var f,g=this;g.exportRecords=function(){b.getExportList().then(function(c){var g,h=_.random(100,1e5);c.file?e(c.file,h):(g=function(){b.getExportProgress(c._links.progress.href).then(function(b){b.percentComplete>99?(a.cancel(f),e(b._links.file.href,h)):d.$broadcast("event:downloadProgress",{id:h,data:{percent:b.percentDone}})},function(){a.cancel(f),d.$broadcast("event:downloadProgress",{id:h,data:{percent:-1}})})},f=a(g,1e3))})},b.getOptOutList().then(function(a){g.optOutList=a}),g.getOptOutSinceDate=function(){var a=new Date,b=new Date(a-26784e5);return b.toDateString()}}angular.module("dorgEuiApp").controller("optOutListController",a),a.$inject=["$interval","optOutListService","$ga","$rootScope"]}(),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("opt_out_list",{url:"/opt-out-list",resolve:{$title:function(){return"Opt-Out List"}},templateUrl:"app/views/opt-out-list/opt-out-list.html",controller:"optOutListController",controllerAs:"vm"})}]),function(){"use strict";function a(a){function b(){var b=Intl.DateTimeFormat().resolvedOptions().timeZone;return a.get("api/rest/export/personOptOut",{params:{clientTimeZone:b}}).then(function(a){return a.data})}function c(b){return a.get(b).then(function(a){return a.data})}function d(){return a.get("api/rest/persons/opt_out_list").then(function(a){return a.data})}return{getExportList:b,getOptOutList:d,getExportProgress:c}}angular.module("dorgEuiApp").service("optOutListService",a),a.$inject=["$http"]}(),angular.module("dorgEuiApp").controller("PasswordCtrl",["$scope","PasswordService",function(a,b){b.getViewResource(),a.success=null,a.error=null,a.doNotMatch=null,a.changePassword=function(){a.password!==a.confirmPassword?a.doNotMatch="ERROR":(a.doNotMatch=null,b.save(a.password).then(function(){a.error=null,a.success="OK"},function(){a.success=null,a.error="ERROR"}))}}]),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("password",{url:"/password",templateUrl:"app/views/password/password.html",controller:"PasswordCtrl"})}]),angular.module("dorgEuiApp").factory("PasswordService",["$rootScope",function(a){var b=null;return{getViewResource:function(){a.Session.navigation.$get("password").then(function(a){b=a})},save:function(a){return b.$put("update",null,a)}}}]),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){var a=(new Date).getTime();m(),C.person.personDataConfirmedTime&&a-C.person.personDataConfirmedTime<=K&&(C.person.showConfirmDate=!0),C.person.stateChangeReasonId!==H&&C.person.stateChangeReasonId!==I&&C.person.stateChangeReasonId!==J||(C.person.privacyRequested=!0),C.locked||(e.checkOrgChart().then(e.scrollToOrgChart),e.getTheCharts(d).then(function(a){C.chartData=a,C.spinnerGo=!1})),e.getEmployeeIntel(d).then(function(a){C.locked&&a.length?C.intel=!0:a.length?C.intel=a:C.intel=void 0}),e.getInfo(d).then(function(a){C.employmentHistory=a.history,C.showFollowForMoreDetails=!(d.notes&&d.notes.length||C.person.followed)}),_.has(C.person.location,"latitude")&&_.has(C.person.location,"longitude")?(C.hqLocation=C.person.location,C.hqLocation.location={longitude:C.person.location.longitude,latitude:C.person.location.latitude,id:C.person.location.id}):(C.locked&&!C.person.location.city||!C.locked)&&(C.noMapAvailable=!0),E?(C.lockedContentHeading="Privacy Requested",C.lockedContentMessage="This contact has requested their information be removed."):d.locked&&(C.lockedContentHeading="Locked Content",C.lockedContentMessage="This content is locked because it is outside of your data subscription. Click below to purchase expanded access from your Account Manager."),C.officeNumberThenCompanyNumberOrBlank=g.getOfficeNumberThenCompanyNumberOrBlank(C.person),i.$formats().then(function(a){a.length&&(C.canExport=!0)}),C.canUpload=!(!j.checkUserHasAllowedLeadOrContactUpload()||!(d.$href("uploadContact")||d.$href("uploadLead")||d.$href("uploadContactToMAT")||d.$href("uploadLeadToMAT")||d.$href("uploadContactToSDR")||d.$href("uploadLeadToSDR")))}function l(){return!C.locked&&!E}function m(){f.getFeatureFlags().then(function(a){var c=_.findWhere(a.data,{name:"triggerstoscoops"});c&&c.active?b.intelText="Scoops":b.intelText="Triggers"})}function n(a,b){return a.length<=2&&a.indexOf(".")!==-1?b:a}function o(){return C.locked||E}function p(a){E?t(a):s(a)}function q(){return _.sortBy(_.pluck(C.person.departments,"displayName")).join(", ")}function r(){return _.sortBy(C.person.technologies,function(a){return a.technologyName})}function s(a){return a?void $("html,body").animate({scrollTop:$(".orgchart-blurrow").offset().top+"px"},900):void c.open({controller:["$scope","$uibModalInstance","subjectLine","bodyLine",function(a,b,c,d){function e(){b.close(!1)}var f=this;f.close=e,f.subjectLine=c,f.bodyLine=d}],controllerAs:"personUnlockVm",resolve:{subjectLine:function(){return C.subjectLine},bodyLine:function(){return C.bodyLine}},size:"md",templateUrl:"app/views/person/unlock.modal.html",windowClass:"lock-modal"})}function t(a){return a?void $("html,body").animate({scrollTop:$(".orgchart-blurrow").offset().top+"px"},900):void c.open({controller:["$scope","$uibModalInstance",function(a,b){function c(){b.close(!1)}var d=this;d.close=c}],controllerAs:"vm",size:"md",templateUrl:"app/views/person/privacy-requested.modal.html",windowClass:"lock-modal"})}function u(b,c){if(!_.isUndefined(c.data)&&c.data&&!_.has(c.data[0],"name")){var d=_.find(c.data,"id",C.person.id);_.isUndefined(d)||(C.person=_.assign({},C.person,d),C.hidden=d),a.$broadcast("event:orgchart",c)}}function v(){if(C.person.notes&&C.person.notes.length>F){for(var a=_.clone(F),b=C.person.notes.substring(a-1,a);b!==C.SPACE&&C.person.notes.substring(F,F+1)!==C.SPACE;)a-=1,b=C.person.notes.substring(a-1,a);return C.person.notes.substring(0,a)}return C.person.notes}function w(){return!(C.person.notes&&C.person.notes.length>F)}function x(){return z(C.person.hqLocation)}function y(){return z(C.person.location)}function z(a){if(!a)return C.BLANK;var b=_.clone(C.BLANK);return a.city&&a.city.trim()!==C.BLANK&&(b+=a.city),b!==C.BLANK&&(a.stateProvinceRegion&&a.stateProvinceRegion.trim()!==C.BLANK||a.postalCode&&a.postalCode.trim()!==C.BLANK||a.isoCountryCode&&a.isoCountryCode.trim()!==C.BLANK)&&(b+=",",a.stateProvinceRegion&&a.stateProvinceRegion.trim()!==C.BLANK&&(b+=C.SPACE+a.stateProvinceRegion),a.postalCode&&a.postalCode.trim()!==C.BLANK&&(b+=C.SPACE+a.postalCode),a.isoCountryCode&&a.isoCountryCode.trim()!==C.BLANK&&(b+=C.SPACE+a.isoCountryCode)),b}function A(){navigator.appVersion.indexOf("Mac")!==-1?C.iOS=!0:C.iOS=!1}function B(a){return!(!a||a.trim()===C.BLANK)}var C=this,D=a.Session.account,E=d.privacyEuRequested;C.canExport=!1,C.bodyLine=encodeURIComponent("I am interested in more information on how to gain access to the data set which includes "+d.fullName+" at "+d.company.name+"."),C.canUpload=!1,C.hidden=d,C.locked=d.locked,C.nameCheck=n,C.noMapAvailable=!1,C.openPersonModal=p,C.person=_.clone(d),C.person.$href=d.$href,C.person.personDetailNoteId="person-detail-note-wrapper",C.personDepartments=q,C.showFollowForMoreDetails=!1,C.spinnerGo=!0,C.privacyRequested=E,C.subjectLine=encodeURIComponent("Access Request From "+D.firstName+" "+D.lastName+": "+d.fullName+" at "+d.company.name),C.trial=a.Session.$isTrial,C.unlockContent=s,C.hqLocation={},C.getOfficeNumberThenCompanyNumberOrBlank=g.getOfficeNumberThenCompanyNumberOrBlank,C.allChecksMustBeFalse=l,C.oneCheckMustBeTrue=o,C.orderedTechnologies=r(),C.hgDataRemoval=f.findFeatureFlag(null,"hg_data_removal"),C.hideEducation=!1,C.getShortNote=v;var F=160,G=3;C.showMoreNote=!0,C.isShowFullNote=w,C.getCompanyAddressWithoutStreet=x,C.getPersonAddressWithoutStreet=y,A(),C.isIE=h[0].documentMode>9,$("feGaussianBlur")[0].attributes.stdDeviation.value=G,C.BLANK="",C.SPACE=" ",C.checkStringData=B,C.mapLoading=!0;var H=17,I=20,J=21,K=7776e6;b.$on("event:crmUpload",u),b.$on("event:followed",u),b.$on("event:noteSaved",u),b.$on("event:suppression",u),b.$on("event:unfollowed",u),k();var L=$("#mapContent");angular.element(L).ready(function(){var a=$("#search-advanced-map");a&&a.remove();var b=$("#company-full-map");b&&b.remove(),C.mapLoading=!1})}angular.module("dorgEuiApp").controller("PersonCtrl",a).filter("filterStr",function(){return function(a,b){var c=[],b=null!==b&&""!==b.trim()?b.trim().toLowerCase():"";return _.each(a,function(a){a.technologyName.toLowerCase().indexOf(b)>=0&&c.push(a)}),c}}),a.$inject=["$rootScope","$scope","$uibModal","personData","PersonService","featureFlagService","phoneNumberService","$document","downloadExportService","userSettingsService"]}(),angular.module("dorgEuiApp").config(["$stateProvider","dorgConfig",function(a,b){a.state("view_person",{url:"/person/{detailsFor:[0-9]+}",params:{orgChart:!1},templateProvider:["personData","$http","$templateCache",function(a,c,d){var e="",f=function(a){return a.data};switch(e="app/views/person/person.html",a.status){case 418:case 412:case 409:case 404:return d.get(b["TPL_"+a.status])?d.get(b["TPL_"+a.status]):c.get(b["TPL_"+a.status]).then(f);default:return d.get(e)?d.get(e):c.get(e).then(f)}}],controllerProvider:["personData",function(a){switch(a.status){case 418:case 412:case 409:return b["CTRL_"+a.status];case 404:return;default:return"PersonCtrl as personVm"}}],resolve:{personData:["$stateParams","PersonService",function(a,b){return b.$get(a.detailsFor)}],respData:["personData",function(a){return a}],$title:["personData",function(a){switch(a.status){case 418:case 412:case 409:case 404:return b["MSG_"+a.status];default:return a.fullName+" | "+a.company.name}}]}})}]),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(a){return h.$get("api/rest/persons/"+a).then(function(a){return e.$orgDetailsLink=a.$href("orgChartDetailedPersonList"),a},function(a){return a})}function k(c){return b.get(c.$href("intel")).then(function(b){return a.$getD(b.data)})}function l(c){return b.get(c.$href("orgChart")).then(function(b){return a.$getD(b.data)})}function m(c){return b.get(c.$href("employmentHistory")).then(function(b){return a.$getD(b.data)})}function n(a){return d.all({history:m(a)})}function o(a,b){var c,d=document.getElementById("mapContent"),e=new a.LatLngBounds,f=[new a.LatLng(b.location.latitude,b.location.longitude)],g=new a.LatLngBounds(new a.LatLng(b.location.latitude,b.location.longitude),new a.LatLng(b.hqLocation.latitude,b.hqLocation.longitude)).getCenter(),h={center:g,disableDefaultUI:!0,scrollwheel:!1,zoomControl:!0,zoom:12,mapTypeId:"OSM",streetViewControl:!1,mapTypeControl:!1};if(c=new a.Map(d,h),c.mapTypes.set("OSM",new google.maps.ImageMapType({getTileUrl:function(a,b){var c=1<<b,d=a.x%c;return d<0&&(d=c+d),"https://maps.discoverydb.com/"+b+"/"+d+"/"+a.y+".png"},tileSize:new google.maps.Size(256,256),name:"OpenStreetMap",maxZoom:12})),new a.Marker({icon:i.getBaseIcon,map:c,position:{lat:b.location.latitude,lng:b.location.longitude}}),b.location.latitude!==b.hqLocation.latitude&&b.location.longitude!==b.hqLocation.longitude){new a.Marker({icon:i.getCompanyIcon,map:c,position:{lat:b.hqLocation.latitude,lng:b.hqLocation.longitude}}),f.push(new a.LatLng(b.hqLocation.latitude,b.hqLocation.longitude));for(var j=0,k=f.length;j<k;++j)e.extend(f[j]);c.fitBounds(e)}i.getStyle().then(function(a){c.setOptions({styles:a})})}function p(){var a=d.defer(),b=f.params.orgChart,e=c(function(){b?$("#number-results-selected").is(":visible")&&(c.cancel(e),a.resolve(!0)):(c.cancel(e),a.reject(!1))},250,10);return a.promise}function q(){g(function(){$("html, body").animate({scrollTop:$("#orgchart-wrapper").offset().top-130},300)},250)}var r=this;r.$get=j,r.checkOrgChart=p,r.getEmployeeIntel=k,r.getEmploymentHistory=m,r.getInfo=n,r.getTheCharts=l,r.scrollToOrgChart=q,r.setupMap=o}angular.module("dorgEuiApp").service("PersonService",a),a.$inject=["$embeddedUtils","$http","$interval","$q","$rootScope","$state","$timeout","halClient","maps"]}(),angular.module("dorgEuiApp").controller("RegistrationCtrl",["$rootScope","$scope","token","RegistrationService","$state",function(a,b,c,d,e){a.Session.authenticated&&e.go("main"),b.show=!0,b.msgs=[{msg:'<strong>Registration Success:</strong> <a href="/#/login">Click here to login.</a>',type:"success",code:0},{msg:"<strong>Error:</strong> Your activation link has expired. Please contact your manager to resend your activation link or contact our support team at help@discoverorg.com.",type:"danger",code:1},{msg:"Error: To meet our security standards, your password must:<ul><li>Be between eight and twenty characters long</li><li>Include upper and lower case letters</li><li>Contain at least one number and one special character (like '@' or '$')</li></ul>",type:"danger",code:2},{msg:"<strong>Password Error:</strong> The password and its confirmation do not match!",type:"danger",code:3},{msg:"<strong>Registration Failure:</strong> There was an error processing your request. Please try again or contact your manager to resend your activation link.",type:"danger",code:4},{msg:'<strong>You have already successfully registered using this activation link.</strong><br/><a href="/#/login">Click here to login.</a>',type:"success",code:5}],b.msgCode=-1,d.validateTokenWithUserState(c).then(function(a){208===a.status?b.msgCode=5:b.user=a.data},function(a){401===a.status&&(b.msgCode=1)}),b.update=function(a){this.password!==this.confirmPassword?b.msgCode=3:d.registerUser(a,c,this.password).then(function(a){b.msgCode=0,b.show=!1},function(a){412===a.status?b.msgCode=2:b.msgCode=4})}}]),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("registration",{url:"/registration?token",templateUrl:"app/views/registration/registration.html",controller:"RegistrationCtrl",resolve:{token:["$stateParams",function(a){return a.token}],$title:function(){return"Registration"}}})}]),angular.module("dorgEuiApp").factory("RegistrationService",["$http",function(a){return{validateToken:function(b){return a.get("api/request/validate/"+encodeURIComponent(encodeURIComponent(b)),{ignoreAuthModule:"ignoreAuthModule"})},validateTokenWithUserState:function(b){return a.get("api/request/validateWithUserState/"+encodeURIComponent(encodeURIComponent(b)),{ignoreAuthModule:"ignoreAuthModule"})},registerUser:function(b,c,d){return a.put("api/registration/"+encodeURIComponent(encodeURIComponent(c)),{user:b,newPassword:d,confirmNewPassword:d},{ignoreAuthModule:"ignoreAuthModule"})}}}]),angular.module("dorgEuiApp").service("$searchCache",["$grid","$rootScope","$SearchStaticFactory",function(a,b,c){this.get=function(){return b.Session.search},this.isEmpty=function(){return _.isEmpty(_.omit(this.get(),"rView","selection","tech"))},this.isEmptyCriteria=function(){return _.isEmpty(this.get().criteria)},this.resultsOld=function(){return{companies:_.has(this.get(),"companies.companies")?this.get().companies.companies:a.$defaultGrid("followCompany",[],!1,!0,void 0,void 0,!0),persons:_.has(this.get(),"persons.persons")?this.get().persons.persons:a.$defaultGrid("followPerson",[],!0,!0,void 0,void 0,!0),intel:_.has(this.get(),"intel.intel")?this.get().intel.intel:a.$defaultGrid("intelResults",[],!1,!0,void 0,void 0,!0),tierTwoCompanies:_.has(this.get(),"tierTwoCompanies.tierTwoCompanies")?this.get().tierTwoCompanies.tierTwoCompanies:a.$defaultGrid("tierTwoCompany",[],!1,!0,void 0,void 0,!0),tierTwoPersons:_.has(this.get(),"tierTwoPersons.tierTwoPersons")?this.get().tierTwoPersons.tierTwoPersons:a.$defaultGrid("tierTwoPerson",[],!0,!0,void 0,void 0,!0)}},this.results=function(){var b={useExternalPagination:!0,useExternalSorting:!0,useExternalFiltering:!0},c={companies:_.has(this.get(),"companies.companies")?this.get().companies.companies:angular.extend(a.$defaultGrid("followCompany",[],!1,!0,void 0,void 0,!0),b),persons:_.has(this.get(),"persons.persons")?this.get().persons.persons:angular.extend(a.$defaultGrid("followPerson",[],!0,!0,void 0,void 0,!0),b),intel:_.has(this.get(),"intel.intel")?this.get().intel.intel:angular.extend(a.$defaultGrid("intelResults",[],!1,!0,void 0,void 0,!0),b),tierTwoCompanies:_.has(this.get(),"tierTwoCompanies.tierTwoCompanies")?this.get().tierTwoCompanies.tierTwoCompanies:angular.extend(a.$defaultGrid("tierTwoCompany",[],!1,!0,void 0,void 0,!0),b),tierTwoPersons:_.has(this.get(),"tierTwoPersons.tierTwoPersons")?this.get().tierTwoPersons.tierTwoPersons:angular.extend(a.$defaultGrid("tierTwoPerson",[],!0,!0,void 0,void 0,!0),b)};return c.companies.data=[],c.persons.data=[],c.intel.data=[],c.tierTwoPersons.data=[],c.tierTwoCompanies.data=[],c.companies.alreadyRegistered=!1,c.persons.alreadyRegistered=!1,c.intel.alreadyRegistered=!1,c.tierTwoCompanies.alreadyRegistered=!1,c.tierTwoPersons.alreadyRegistered=!1,c},this.view=function(){
return _.has(this.get(),"rView")?this.get().rView:"persons"},this.isResearcherVerifiedView=function(){return["tierTwoPersons","tierTwoCompanies"].indexOf(this.view())<0},this.criteria=function(a){return this.isEmptyCriteria()?angular.copy(a):this.get().criteria},this.tech=function(){return this.get().tech||[]},this.base=function(){return{companies:this.isEmpty()||_.isUndefined(this.get().companies)?[]:this.get().companies.companies,persons:this.isEmpty()||_.isUndefined(this.get().persons)?[]:this.get().persons.persons,intel:this.isEmpty()||_.isUndefined(this.get().intel)?[]:this.get().intel.intel,tierTwoCompanies:this.isEmpty()||_.isUndefined(this.get().tierTwoCompanies)?[]:this.get().tierTwoCompanies.tierTwoCompanies,tierTwoPersons:this.isEmpty()||_.isUndefined(this.get().tierTwoPersons)?[]:this.get().tierTwoPersons.tierTwoPersons}},this.baseA=function(){return{companies:this.isEmpty()||_.isUndefined(this.get().companies)?[]:this.get().companies.companiesA,companiesCount:this.isEmpty()||_.isUndefined(this.get().companies)?0:this.get().companies.companiesCount,companiesText:this.isEmpty()||_.isUndefined(this.get().companies)?c.textCountDefs.companies:this.get().companies.companiesText,persons:this.isEmpty()||_.isUndefined(this.get().persons)?[]:this.get().persons.personsA,personsCount:this.isEmpty()||_.isUndefined(this.get().persons)?0:this.get().persons.personsCount,personsText:this.isEmpty()||_.isUndefined(this.get().persons)?c.textCountDefs.persons:this.get().persons.personsText,intel:this.isEmpty()||_.isUndefined(this.get().intel)?[]:this.get().intel.intelA,intelCount:this.isEmpty()||_.isUndefined(this.get().intel)?0:this.get().intel.intelCount,intelText:this.isEmpty()||_.isUndefined(this.get().intel)?c.textCountDefs.intel:this.get().intel.intelText,tierTwoCompanies:this.isEmpty()||_.isUndefined(this.get().tierTwoCompanies)?[]:this.get().tierTwoCompanies.tierTwoCompaniesA,tierTwoCompaniesCount:this.isEmpty()||_.isUndefined(this.get().tierTwoCompanies)?0:this.get().tierTwoCompanies.tierTwoCompaniesCount,tierTwoCompaniesText:this.isEmpty()||_.isUndefined(this.get().tierTwoCompanies)?c.textCountDefs.tierTwoCompanies:this.get().tierTwoCompanies.tierTwoCompaniesText,tierTwoPersons:this.isEmpty()||_.isUndefined(this.get().tierTwoPersons)?[]:this.get().tierTwoPersons.tierTwoPersonsA,tierTwoPersonsCount:this.isEmpty()||_.isUndefined(this.get().tierTwoPersons)?0:this.get().tierTwoPersons.tierTwoPersonsCount,tierTwoPersonsText:this.isEmpty()||_.isUndefined(this.get().tierTwoPersons)?c.textCountDefs.tierTwoPersons:this.get().tierTwoPersons.tierTwoPersonsText}},this.selection=function(a){var b={companies:this.isEmpty()||_.isUndefined(this.get().selection.companies)?[]:this.get().selection.companies,persons:this.isEmpty()||_.isUndefined(this.get().selection.persons)?[]:this.get().selection.persons,intel:this.isEmpty()||_.isUndefined(this.get().selection.intel)?[]:this.get().selection.intel,tierTwoCompanies:this.isEmpty()||_.isUndefined(this.get().selection.tierTwoCompanies)?[]:this.get().selection.tierTwoCompanies,tierTwoPersons:this.isEmpty()||_.isUndefined(this.get().selection.tierTwoPersons)?[]:this.get().selection.tierTwoPersons};return a?b[a]:b},this.setEmpty=function(){return b.Session.search={},this},this.setEmptyCriteria=function(){return delete b.Session.search.criteria,this},this.setCriteria=function(a){return b.Session.search.criteria=a,this},this.setView=function(a){return b.Session.search.rView=a,this},this.setTech=function(a){return this.get().tech||(b.Session.search.tech=[]),b.Session.search.tech=_.merge(b.Session.search.tech,a),this},this.setData=function(a,c,d,e,f,g,h){return b.Session.search[a]={},b.Session.search[a][a]=f,b.Session.search[a][a+"A"]=g,b.Session.search[a][d]=h,b.Session.search[a][c]=[e,e],this},this.setSelection=function(a,c,d){var e;if(!a||!c)throw new Error("Missing Parameters when trying to set Selection Cache");if(this.get().selection||(b.Session.search.selection={}),this.get().selection[a]||(b.Session.search.selection[a]=[]),d=d||!1,_.isArray(c))this.get().selection[a]=_.uniq(this.selection(a).concat(c));else if(_.isNumber(c))this.get().selection[a].indexOf(c)<0||d===!0?this.get().selection[a].push(c):this.get().selection[a].splice(this.get().selection[a].indexOf(c),1);else if(_.isObject(c)&&(_.has(c,"id")||_.has(c,"uuid"))){var f=_.has(c,"uuid")?"uuid":"id";e=_.findIndex(this.get().selection[a],_.pick(c,function(a,b){return b===f})),e<0||d===!0?this.get().selection[a].push(c):this.get().selection[a].splice(e,1)}return this},this.clearSelection=function(a){return this.get().selection||(b.Session.search.selection={}),!this.get().selection[a]&&a&&(b.Session.search.selection[a]=[]),a?b.Session.search.selection[a]=[]:b.Session.search.selection={companies:[],persons:[],intel:[],tierTwoCompanies:[],tierTwoPersons:[]},this}}]),angular.module("dorgEuiApp").filter("$$searchGeoFilter",function(){return function(a,b){var c=angular.copy(b);c=c.toLowerCase(),b=_.words(b.toLowerCase());var d=b.length,e=[],f=_.findIndex(a,function(a){return a.displayName.toLowerCase()===c});return e=d<1?a:f>-1?[a[f]]:_.filter(a,function(a){var c=[],e=_.words(a.displayName.toLowerCase()),f=e.length,g=_.words(a.name.toLowerCase()),h=g.length;if(f>=d||h>=d)for(var i=0,j=0,k=0;k<d;++k){for(var l=0;l<f;++l)_.startsWith(e[l],b[k])&&(i+=1),i===d&&c.push(e[l]);if(i<d)for(var l=0;l<h;++l)_.startsWith(g[l],b[k])&&(j+=1),j===d&&c.push(g[l])}return c.length>0})}}),angular.module("dorgEuiApp").service("$SearchModalsService",["$rootScope","SearchService","Flash","$timeout","$grid","$SearchStaticFactory","$ga","featureFlagService",function(a,b,c,d,e,f,g,h){function i(a){return{tab:q[a.tab].displayName,count:a.count}}function j(a){var b=new Date;return b.setDate(b.getDate()-parseInt(a)),new Date(b).getTime()}function k(a,b,c,d,e,f){a[c]=e.Selected?e.value:null,m(b,e),e.Selected||(a[d].minValue=0),f>0&&e.Selected&&l(a,c,d,f)}function l(a,b,c,d){if(0===d)a[c].minValue=0;else{if(!a[b])return;a[c].minValue=j(d),a[c].maxValue&&(a[c].maxValue=null)}}function m(a,b){for(var c=0;c<a.length;c++)b.value&&b.value===a[c].value||(a[c].Selected=!1)}var n=b,o="app/views/search/partials/",p={},q={companies:{displayName:"Companies",countFunction:b.getCompanySearchCounts,showCount:!0},persons:{displayName:"Employees",countFunction:b.getPersonSearchCounts,showCount:!0},intel:{displayName:"Scoops",countFunction:b.getIntelSearchCounts,showCount:!0},tierTwoCompanies:{displayName:"Technology Generated Companies",countFunction:b.getTierTwoCompanyPreviewRecordCounts,showCount:!0},tierTwoPersons:{displayName:"Technology Generated Employees",countFunction:b.getTierTwoPersonPreviewRecordCounts,showCount:!0}},r=!1;h.getFeatureFlags().then(function(a){p=a.data}),a.curShowSavedSearchId=0,a.curShowSavedSearchName="",this.bulkMatchModal=function(a){return{controller:["$scope","$uibModalInstance","catList",function(b,c,d){var f=function(a){return _.trim(a)},g=function(a,b){var c;return _.isUndefined(b)?c=/[^;\n\t]+/g:b===!0?c=/[^;,.\n\t ]+/g:b===!1&&(c=/[^;,\n\t ]+/g),_.map(_.words(a,c),f)},h=function(a,b){var c="",d=[];b=b||!1,a=a||[];for(var e=0,f=a.length;e<f;++e)a[e].length>0&&d.push(a[e]);for(var g=0,h=d.length;g<h;++g)a[g].length>0&&(c+=g!==h-1?a[g]+(b?"\n":", "):a[g]);return c};b.callSource=a,b.isLookupRunning=!1,b.requestData="",b.selectWindow=!1,"abm"===a?b.catList=_.filter(d,function(a){return!_.isNumber(a.pngCategoryType)}):b.catList=d,b.catListSelections=d[0].pngCategoryType,b.results=e.$defaultGrid("bulkMatch",[]),b.results.enableGridMenu=!1,b.results.enableVerticalScrollbar=!1,b.counts={results:0,matched:0,unmatched:0},b.confirm=function(){b.isLookupRunning=!0;var a=[];n.$postBulkMatch(g(b.requestData),b.catListSelections).then(function(c){b.isLookupRunning=!1,b.selectWindow=!0;var d;d=_.isEmpty(c.matchedTermsScored)?c.matchedTerms:c.matchedTermsScored,_.each(d,function(b,d){b.forEach(function(b){var e=!b.score||!c.exactMatchThreshold||b.score>=c.exactMatchThreshold;a.push({id:b.id,displayName:b.displayName,term:d,_class:e?"perfectEntryMatch":"entryMatch",perfectMatch:e})})}),b.results.data=a,b.results.api.grid.modifyRows(b.results.data),b.results.data.forEach(function(a){a.perfectMatch&&b.results.api.selection.selectRow(a)}),b.unmatched=h(c.unMatchedTerms,!0),b.counts={results:b.results.data.length,matched:_.size(d),unmatched:_.size(c.unMatchedTerms)}})},b.updateUnmatched=function(){var a=[];n.$postBulkMatch(g(b.unmatched),b.catListSelections).then(function(c){var d;d=_.isEmpty(c.matchedTermsScored)?c.matchedTerms:c.matchedTermsScored,_.each(d,function(b,d){b.forEach(function(b){var e=!b.score||!c.exactMatchThreshold||b.score>=c.exactMatchThreshold;a.push({id:b.id,displayName:b.displayName,term:d,_class:e?"perfectEntryMatch":"entryMatch",perfectMatch:e})})}),b.results.data=b.results.data.concat(a),b.results.api.grid.modifyRows(b.results.data),b.results.data.forEach(function(a){a.perfectMatch&&b.results.api.selection.selectRow(a)}),b.unmatched=h(c.unMatchedTerms,!0),b.counts={results:b.results.data?b.results.data.length:0,matched:_.size(d)+b.counts.matched,unmatched:c.unMatchedTerms?c.unMatchedTerms.length+b.counts.unmatched:0}})},b.selectedResults=[],b.confirmLookup=function(){c.close({type:"direct",data:{placement:b.catListSelections,info:g(b.requestData,b.catListSelections>-3)}})},b.sendToResults=function(){c.close({type:"indirect",data:_.uniq(b.results.api.selection.getSelectedRows(),"id")})},b.close=function(){c.dismiss("cancel")}}],resolve:{catList:function(){return n.$getBulkMatchCategories}},templateUrl:o+"bm.base.partial.html"}},this.saveSearchModal=function(c,d){return{controller:["$rootScope","dorgValidation","$uibModalInstance","Flash","supportData","isEmpty","featureFlagService","currentSavedSearchSubscriptions","$q",function(a,e,f,g,h,i,j,k,l){function m(a){var b=[];return b.push(u),_.each(a,function(a){b.push(a)}),b}function o(a){return j.getFeatureFlags().then(function(b){var c=_.findWhere(b.data,{name:"triggerstoscoops"});c&&c.active&&(_.each(a,function(a){a.displayName.indexOf("Trigger")!==-1&&(a.displayName=a.displayName.replace("Trigger","Scoop"))}),_.each(t.currentSavedSearchSubscriptions,function(a){a.subscriptionNameAndType.indexOf("Intel")!==-1&&(a.subscriptionNameAndType=a.subscriptionNameAndType.replace("Intel","Scoop"))}))}),a}function p(a){return a?"Invalid characters found: "+a:""}function q(a){t.hasCurrentSavedSearch&&t.isOverWrite?(a.id=t.savedSearchSavedId,n.overWriteThisSearch(a).then(function(a){w(a)})):n.saveThisSearch(a).then(function(a){w(a)})}function r(){return n.checkDuplicateSubscriptionName(h._links.checkValidName.href,t.subscriptionName).then(function(a){t.subscriptionNameError=a?"Subscription Name must be unique.":""})}function s(){return n.checkDuplicateSavedSearchName(t.searchName).then(function(a){t.searchNameError=a?"You already have a saved search with this name. Please re-name this search.":""})}var t=this,u={id:"",displayName:"None"};_.remove(h.subscriptionTypes,function(a){return 4==a.id}),t.isFromAdvancedSearch=!0,t.isEmpty=i,t.searchName="",t.isSaving=!1,t.typeOption=d?h.subscriptionTypes[2]:u,t.frequencyOption=u,t.subscriptionName="",t.searchNameErrors=[],t.subscriptionNameErrors=[],t.frequencyOptions=m(h.scheduleTypes),t.subscriptionTypes=m(o(h.subscriptionTypes)),t.sourceListType=h.savedSearchesListTypeId,t.savedSearchSavedId=0,t.hasCurrentSavedSearch=a.curShowSavedSearchId>0,t.isOverWrite=!0;var v=!t.hasCurrentSavedSearch||!t.isOverWrite;t.subscribe=d?d:v,t.currentSavedSearchSubscriptions=k,a.Session&&a.Session.account&&(t.tierTwo=a.Session.account.canAccessTierTwoData),t.disallowSaveSearchSubmit=function(){return t.subscribe?0===t.searchName.trim().length||_.isEmpty(t.frequencyOption)||!t.frequencyOption.id||_.isEmpty(t.typeOption)||!t.typeOption.id||0===t.subscriptionName.trim().length:0===t.searchName.trim().length},t.subscriptionNameFocus=function(){0===t.subscriptionName.trim().length&&t.searchName.trim().length>0&&(t.subscriptionName=t.searchName,t.typeOption&&t.typeOption.id&&(t.subscriptionName+=" - "+t.typeOption.displayName),t.subscriptionName=b.getSavedSearchNameCutOffByMaxlengthLimit(t.subscriptionName),t.checkForSpecialCharsSubscription())},t.checkForSpecialCharsSubscription=function(){t.subscriptionNameError=p(e.findSpecialChars(t.subscriptionName,e.nameRegex))},t.checkForSpecialCharsSavedSearch=function(){t.searchNameError=p(e.findSpecialChars(t.searchName,e.nameRegex))},t.invalidCharacters=function(){return t.searchNameError||t.subscriptionNameError},t.onIsOverWriteChange=function(){t.isOverWrite?t.getSavedSearchName():t.clearSavedSearchName(),t.subscribe=d?d:!t.isOverWrite},t.getSavedSearchName=function(){t.searchName=a.curShowSavedSearchName,t.savedSearchSavedId=a.curShowSavedSearchId,t.searchNameErrors=[],t.searchNameError=""},t.clearSavedSearchName=function(){t.searchName="",t.savedSearchSavedId=0,t.searchNameError=""},t.init=function(){t.hasCurrentSavedSearch&&t.getSavedSearchName()},t.init(),t.save=function(){t.isSaving=!0;var b={},d=n.transformActiveCriteriaToSearchCriteriaModel(c);b.name=t.searchName,b.searchCriteria=d;var e=[];t.hasCurrentSavedSearch&&t.isOverWrite&&t.searchName===a.curShowSavedSearchName||e.push(s()),t.subscribe&&e.push(r()),_.size(e)>0?l.all(e).then(function(a){t.searchNameError||t.subscriptionNameError?t.isSaving=!1:q(b)}):q(b)};var w=function(a){if(400!==a.status&&403!==a.status||!a.data.errors)412===a.status?t.searchNameErrors.push(a.data.errorMsg):t.subscribe?(t.savedSearchSavedId=a.id,n.$createSubscription(h._links.subscriptions.href,t.savedSearchSavedId,t,f)):(f.close(),g.create("success","Search Successfully saved as "+a.name,"flash"));else{var b="";_.each(a.data.errors,function(a){b=e.getErrorMessage(a.code),_.includes(t.searchNameErrors,b)?_.pullAt(t.searchNameErrors,_.indexOf(t.searchNameErrors,b)):t.searchNameErrors.push(b)})}t.isSaving=!1};t.close=function(){f.dismiss("cancel")}}],controllerAs:"saveSearchVm",resolve:{supportData:function(){return n.$subscriptionSuppportData()},isEmpty:["featureFlagService",function(a){var b=n.$isEmptyCriteria(c);if(a.findFeatureFlag(null,"triggerstoscoops")&&b){var d=!(_.isEmpty(c.intelPublishDate.minValue)&&_.isEmpty(c.intelPublishDate.maxValue)&&_.isEmpty(c.intelUpdatedDate.minValue)&&_.isEmpty(c.intelUpdatedDate.maxValue));b=!d}return b}],savedSearch:function(){return n.getSavedSearches()},currentSavedSearchSubscriptions:function(){return a.curShowSavedSearchId>0?n.getSavedSearchSubscriptionBySourceListId(a.curShowSavedSearchId):[]}},size:"sm-save-search",templateUrl:o+"saveSearch.modal.html"}},this.savedSearchModal=function(){return{controller:["$uibModalInstance","searches",function(b,d){var e=this;e.noOptions=d.length>0,e.options=d,e.optionsFirst=d[0],e.apply=function(){n.getThisSearch(e.optionsFirst.id).then(function(d){a.curShowSavedSearchId=d.savedSearch.id,a.curShowSavedSearchName=d.savedSearch.displayName,b.close(d),c.create("success","Saved Search successfully applied","flash")})},e.close=function(){b.dismiss("cancel")}}],controllerAs:"savedSearchVm",resolve:{searches:function(){return n.getSavedSearches()}},size:"sm",templateUrl:o+"savedSearches.modal.html"}},this.recentSearchModal=function(){return{controller:["$uibModalInstance","searches",function(b,d){var e=this;e.isEmptyRecentSearches=_.isEmpty(d),e.options=d,e.optionsFirst=d[0],e.apply=function(){n.$one(e.optionsFirst).then(function(d){a.curShowSavedSearchId=0,b.close(d),c.create("success","Recent Search successfully applied","flash")})},e.close=function(){b.dismiss("cancel")}}],controllerAs:"recentSearchVm",resolve:{searches:function(){return n.getRecentSearches()}},size:"sm",templateUrl:o+"recentSearches.modal.html"}},this.mapModal=function(a,b){return{controller:["$uibModalInstance","$scope","$timeout","$http","$compile","$q",function(c,d,e,f,g,h){var i="app/views/search/partials/mapEmployeePopoverTemplate.html",j={},k={};d.popUpDataPromise=null,"companies"===b&&(i="app/views/search/partials/mapCompanyPopoverTemplate.html",d.popUpDataPromise=function(a){var b=h.defer();if(j[a[0].id])b.resolve(j[a[0].id]);else if(!k[a[0].id]){k[a[0].id]=!0;var c={companyIds:[a[0].id],includeOutOfScopeResults:!1};f.post("api/rest/persons/search",c).then(function(c){j[a[0].id]=c.data._embedded.personGridRowList,b.resolve(c.data._embedded.personGridRowList),k[a[0].id]=!1})}return b.promise}),e(function(){d.locations=a;var b=g('<map satellites="locations" pop-up-template="'+i+'"  pop-up-call-back="popUpDataPromise"></map>')(d);$("#search-advanced-map").append(b)}),d.close=function(){c.close()},d.$on("$stateChangeStart",function(){c.close()})}],size:"lg",templateUrl:o+"mapsView.modal.html",windowClass:"modal-full-screen"}},this.upgradeModal=function(){return{controller:["$scope","$uibModalInstance","message",function(a,b,c){a.message=c,a.close=function(){b.dismiss("cancel")}}],resolve:{message:function(){return n.$getUpgradeMessage()}},size:"md",templateUrl:o+"upgrade.modal.html"}},this.activeCriteria=function(a,c,d){return{controller:["$scope","$uibModalInstance","$criteria","$jobFunctions","$seniorityLevels","FormatDatesService","ActiveCriteriaCountService","$SearchStaticFactory","featureFlagService","intelLegacyCategoryIds","refreshUnsupportedFiltersFn",function(a,c,d,e,f,g,h,i,j,k,l){a.activeCriteria=d,a.newDataPointsForRecruitersEnabled=j.findFeatureFlag(p,"recruiters_new_dp"),a.newDataPointsForRecruitersEnabled||(a.activeCriteria.havingMobilePhone=!1,a.activeCriteria.havingPersonalEmail=!1,a.activeCriteria.havingOfficePhone=!1,a.activeCriteria.havingAnyEmail=!1);var m=b.getAllKeywordSearchType();if(a.triggersToScoopFlag=j.findFeatureFlag(null,"triggerstoscoops"),_.isEmpty(a.activeCriteria.keywordTermsAplication)||_.isEmpty(a.activeCriteria.textSearchString)||(a.activeKeywordTerms=_.filter(m,function(b){return _.includes(a.activeCriteria.keywordTermsAplication,b.value)})),a.textTermRadios=_.find(i.textTermRadios,function(a){return a.value===d.textTermsApplication}),a.technologyRadios=_.find(i.technologyRadios,function(a){return a.value===d.technologiesApplication}),a.companyRecordType="RECORDS_ADDED"===d.companyRecordsApplication?"Added":"Changed",a.employeeRecordType="RECORDS_ADDED"===d.personRecordsApplication?"Added":"Changed",d.companyRecordsDate.minValue&&(a.companyWithinTheLastNumOfDays=g.setTwoDatesFormat(new Date,new Date(d.companyRecordsDate.minValue))||0),d.personRecordsDate.minValue&&(a.employeeWithinTheLastNumOfDays=g.setTwoDatesFormat(new Date,new Date(d.personRecordsDate.minValue))||0),a.isEmpty=b.$isEmptyCriteria(d),a.triggersToScoopFlag&&a.isEmpty){var n=!(_.isEmpty(d.intelPublishDate.minValue)&&_.isEmpty(d.intelPublishDate.maxValue)&&_.isEmpty(d.intelUpdatedDate.minValue)&&_.isEmpty(d.intelUpdatedDate.maxValue));a.isEmpty=!n}a.showAddressLoc=_.filter(d.geo,_.size).length>0,a.showPostalCodeApplyTo=a.showAddressLoc&&(d.geo.postalCodes&&_.filter(d.geo.postalCodes,_.size).length>0||d.geo.postalCodeCenter&&d.geo.postalCodeCenter.length>0);var o=[],q=function(a){if(!_.has(a,"departmentIds"))return!1;for(var b=0,c=a.departmentIds.length;b<c;++b)if(o.indexOf(a.departmentIds[b])>-1)return!0;return!1};a.isLegacyTopic=function(a){return _.size(k)>0&&_.includes(k,a.id)},a.$watch("activeCriteria",function(c,d){if(c!==d){if(void 0!=a.activeCriteria.departmentIds&&null!==a.activeCriteria.departmentIds&&a.activeCriteria.departmentIds.length>0)if(o=_.pluck(a.activeCriteria.departmentIds,"id"),o.length>0){if(void 0!=a.activeCriteria.jobFunctionIds&&null!==a.activeCriteria.jobFunctionIds&&a.activeCriteria.jobFunctionIds.length>0){var g=[],h=_.filter(e,q);_.each(h,function(b){var c=_.find(a.activeCriteria.jobFunctionIds,function(a){return b.id==a.id});c&&g.push(c)}),a.activeCriteria.jobFunctionIds=g}else a.activeCriteria.jobFunctionIds=[];if(void 0!=a.activeCriteria.seniorityLevelIds&&null!==a.activeCriteria.seniorityLevelIds&&a.activeCriteria.seniorityLevelIds.length>0){var g=[],i=_.filter(f,q);_.each(i,function(b){var c=_.find(a.activeCriteria.seniorityLevelIds,function(a){return b.id==a.id});c&&g.push(c)}),a.activeCriteria.seniorityLevelIds=g}else a.activeCriteria.seniorityLevelIds=[]}else a.activeCriteria.jobFunctionIds=[],a.activeCriteria.seniorityLevelIds=[];if(a.showAddressLoc=_.filter(c.geo,_.size).length>0,a.isEmpty=b.$isEmptyCriteria(c),a.triggersToScoopFlag&&a.isEmpty){var j=!(_.isEmpty(c.intelPublishDate.minValue)&&_.isEmpty(c.intelPublishDate.maxValue)&&_.isEmpty(c.intelUpdatedDate.minValue)&&_.isEmpty(c.intelUpdatedDate.maxValue));a.isEmpty=!j}l()}},!0),a.isSearchCriteriaNumberRangeNonDefault=function(a){return h.isSearchCriteriaNumberRangeNonDefault(a)},a.countActiveCriteriaDepartments=function(a){return h.countActiveCriteriaDepartments(a)},a.removeKeywordTerms=function(b){_.remove(a.activeCriteria.keywordTermsAplication,function(a){return a===b}),_.remove(a.activeKeywordTerms,function(a){return a.value===b}),0===_.size(a.activeCriteria.keywordTermsAplication)&&(a.activeCriteria.textSearchString="")},a.clearRadialPostal=function(){a.activeCriteria.geo.radialDistance="",a.activeCriteria.geo.postalCodeCenter=""},a.defaultSearchCriteriaNumberRange=function(a){a.minValue=0,a.maxValue=0},a.defaultSearchCriteriaNumberRangeNull=function(a){a.minValue=null,a.maxValue=null},a.$updateDateRange=function(){a.activeCriteria.intelPublishDate={minValue:null,maxValue:null}},a.updateUpdatedDateRange=function(){a.activeCriteria.intelUpdatedDate={minValue:null,maxValue:null},a.removeIntelIncludeOnlyUpdated()},a.$updateRecordsCompanyDateRange=function(){a.activeCriteria.companyRecordsDate={minValue:null,maxValue:null}},a.$updateRecordsEmployeeDateRange=function(){a.activeCriteria.personRecordsDate={minValue:null,maxValue:null}},a.$updateEmployeeStartDate=function(){a.activeCriteria.employeeStartDate={minValue:null,maxValue:null}},a.makeSearchCriteriaNumberRangeLabel=function(a){return b.makeSearchCriteriaNumberRangeLabel(a)},a.compareFundingTypeId=function(a,b){return 0===a.value?1:0===b.value?-1:a.value>b.value?1:-1},a.close=function(){c.close()},a.getDateFormat=function(a){return a?a:"Not Defined"},a.isSearchCriteriaNumberRangeHasValue=function(a){return h.isSearchCriteriaNumberRangeHasValue(a)},a.removeIntelIncludeOnlyUpdated=function(){a.activeCriteria.intelIncludeOnlyUpdated=!1}}],resolve:{$criteria:function(){return a},$jobFunctions:function(){return b.getJobFunctionList(c)},$seniorityLevels:function(){return b.getSeniorityLevelList(c)},intelLegacyCategoryIds:function(){return b.getIntelLegacyCategoryIds(c)},refreshUnsupportedFiltersFn:function(){return d}},size:"lg",templateUrl:o+"activeCriteria.modal.html"}},this.companiesCriteria=function(a,c,d,e){var j=h.findFeatureFlag(p,"search_apply_filters");return{controller:["$scope","$uibModalInstance","$criteria","$$ownership","$$industry","$$businessModels","departments","$interval","$uibModal","$SearchModalsService","SearchService","FormatDatesService","featureFlagService","ActiveCriteriaCountService","changeActiveCriteriaObjectFn","fundingTypes",function(a,b,d,h,j,n,o,s,t,u,v,w,x,y,z,A){function B(){a.intermediateCriteriaStorageObject.sicCodes=a.industryCode.sicCodes,a.intermediateCriteriaStorageObject.naicsCodes=a.industryCode.naicsCodes}function C(){v.transFundingDate(a.intermediateCriteriaStorageObject);for(var b in a.intermediateCriteriaStorageObject)a.activeCriteria.hasOwnProperty(b)&&(a.activeCriteria[b]=a.intermediateCriteriaStorageObject[b]);z(a.activeCriteria),a.close()}function D(){return y.checkCounts(a.intermediateCriteriaStorageObject)}var E=null,F=6,G=4,H=function(){var a=d.fortuneRank.maxValue,b=d.globalRank.maxValue,c=0;switch(a+b){case 0:c=0;break;case 500:c=1;break;case 1e3:c=2;break;case 2e3:c=3;break;case 2500:c=4;break;case 3e3:c=5}return c};if(a.addedChangedEnabled=x.findFeatureFlag(p,"addedorupdated"),a.yearFoundedEnabled=x.findFeatureFlag(p,"year_founded"),a.searchApplyFiltersFlagActive=x.findFeatureFlag(p,"search_apply_filters"),a.activeCriteria=d,a.isResearcherVerifiedView=e,a.criteriaToFilter=angular.copy(a.activeCriteria),a.intermediateCriteriaStorageObject=a.activeCriteria,a.searchApplyFiltersFlagActive&&(a.intermediateCriteriaStorageObject=a.criteriaToFilter),a.startsWithArray=f.startsWith,a.fortuneGlobal=f.fortuneGlobal,a.$$filterDebounce=f.filterDebounce,a.recordsRadios=angular.copy(f.recordsRadios),a.intermediateCriteriaStorageObject.companyRecordsDate.minValue){var I=new Date,J=new Date(a.intermediateCriteriaStorageObject.companyRecordsDate.minValue);a.intermediateCriteriaStorageObject.withinTheLastNumOfDays=w.setTwoDatesFormat(I,J)||0;for(var K=0;K<a.recordsRadios.length;K++)a.intermediateCriteriaStorageObject.companyRecordsApplication===a.recordsRadios[K].value&&(a.recordsRadios[K].Selected=!0)}else a.intermediateCriteriaStorageObject.withinTheLastNumOfDays=0;a.resultsCounts=i(v.getResultsCounts()),a.$on("results:getCounts",function(b,c){a.resultsCounts=i(c)}),a.entityTypes=q,a.countedEntityDisplayName="-",r&&(a.countedEntityDisplayName=q[r].displayName),a.isRecordCountDisplayed=a.resultsCounts.count&&r,a.$watch("intermediateCriteriaStorageObject",function(b,c){angular.equals(b,c)||(a.isRecordCountDisplayed=!1)},!0),a.searchCount=function(b){function c(b){a.entityCount=b.data.searchCriteriaScoped}a.countedEntityDisplayName=q[b].displayName;var d=v.transformActiveCriteriaToSearchCriteriaModel(a.intermediateCriteriaStorageObject);a.entityCount="-",q[b].countFunction(d).then(c),r=b,a.isRecordCountDisplayed=!0},a.isRecordCountDisplayed&&a.searchCount(r),a.isItemCounted=function(b){return a.isRecordCountDisplayed&&b===a.countedEntityDisplayName},a.showCount=function(a){return v.showCount(q,a)},a.isTierTwo=function(a){return v.isTierTwo(a)},a.makePreviewRecordCountDrodownItemText=function(b){var c="";return a.isItemCounted(b)&&(c=" ("+a.entityCount.toLocaleString()+")"),v.makePreviewCountedEntityDisplayName(b)+c},a.lists={ownershipTypes:h,industries:j,businessModels:n,companyList:[],departments:o,fundingTypes:A,investorsList:[]},a.tracker=function(a){a=a.open||!1},a.startsWith="",a.industrySearch="",a.applyFilters=C,a.isAnyCriteriaSelected=D,a.fortuneGlobal.selected=H(),a.industryPurviewRadios=[{value:!0,label:"Any"},{value:!1,label:"Primary Industry"}],a.industryCode={naicsCodes:a.intermediateCriteriaStorageObject.naicsCodes,sicCodes:a.intermediateCriteriaStorageObject.sicCodes},a.deselectIndustryCodeTab=function(b){b?a.industryCode.sicCodes=[]:a.industryCode.naicsCodes=[],B()},a.changeIndustryNaicsCodes=function(){a.industryCode.naicsCodes=v.standardizeArrayByDelimiter(a.industryCode.naicsCodes,F),a.industryCode.sicCodes=[],B()},a.changeIndustrySicCodes=function(){a.industryCode.naicsCodes=[],a.industryCode.sicCodes=v.standardizeArrayByDelimiter(a.industryCode.sicCodes,G),B()},a.getInvestorsList=function(b){v.getInvestorsList(c,b).then(function(c){var d=0,e=21,f=_.chunk(c,e),g=250;a.intermediateCriteriaStorageObject.startsWithInvestors=b,s.cancel(E),a.lists.investorsList=[],E=s(function(){if(!f[d])return void s.cancel(E);for(var b=0,c=f[d].length;b<c;++b)a.lists.investorsList.push(f[d][b]);d+=1},g,f.length)})},a.getCompanyList=function(b){v.getCompanyList(c,b).then(function(c){var d=0,e=21,f=_.chunk(c,e),g=250;a.intermediateCriteriaStorageObject.startsWith=b,s.cancel(E),a.lists.companyList=[],E=s(function(){if(!f[d])return void s.cancel(E);for(var b=0,c=f[d].length;b<c;++b)a.lists.companyList.push(f[d][b]);d+=1},g,f.length)})},a.selectAllIndustry=function(b){b.stopImmediatePropagation(),b.preventDefault(),_.each(j,function(b){_.indexOf(a.intermediateCriteriaStorageObject.industryIds,b)<0&&a.intermediateCriteriaStorageObject.industryIds.push(b)})},a.clearAllIndustry=function(b){b.stopImmediatePropagation(),b.preventDefault(),a.intermediateCriteriaStorageObject.industryIds=[],this.industrySearch="",a.industryCode.naicsCodes=[],a.industryCode.sicCodes=[],B()},a.clearAllName=function(b){b.stopImmediatePropagation(),b.preventDefault(),a.intermediateCriteriaStorageObject.companyIds=[],this.intermediateCriteriaStorageObject.startsWith="",s.cancel(E),this.lists.companyList=[]},a.clearAllCompanySize=function(b){b.stopImmediatePropagation(),b.preventDefault(),a.intermediateCriteriaStorageObject.numEmployees.minValue=0,a.intermediateCriteriaStorageObject.numEmployees.maxValue=0,a.intermediateCriteriaStorageObject.revenue.minValue=0,a.intermediateCriteriaStorageObject.revenue.maxValue=0,a.intermediateCriteriaStorageObject.employeeGrowth.minValue=0,a.intermediateCriteriaStorageObject.employeeGrowth.maxValue=0,a.intermediateCriteriaStorageObject.revenueGrowth.minValue=0,a.intermediateCriteriaStorageObject.revenueGrowth.maxValue=0,a.fortuneGlobal.selected=0,a.intermediateCriteriaStorageObject.fortuneRank.maxValue=0,a.intermediateCriteriaStorageObject.fortuneRank.minValue=0,a.intermediateCriteriaStorageObject.globalRank.maxValue=0,a.intermediateCriteriaStorageObject.globalRank.minValue=0},a.validateToValue=function(a){var b="",c=a.minValue,d=a.maxValue;return 0!=d&&c>=d&&(b="invalidEntry"),b},a.setTypeForSearch=function(b,c){k(a.intermediateCriteriaStorageObject,a.recordsRadios,"companyRecordsApplication","companyRecordsDate",b,c)},a.setDaysForSearch=function(b){l(a.intermediateCriteriaStorageObject,"companyRecordsApplication","companyRecordsDate",b)},a.countDepartmentEmployeeSize=function(){return y.countActiveCriteriaDepartments(a.intermediateCriteriaStorageObject.departments)},a.clearAllDepartmentSize=function(b){b.stopImmediatePropagation(),b.preventDefault(),Object.values(a.intermediateCriteriaStorageObject.departments).forEach(function(a){a.numEmployees.minValue=0,a.numEmployees.maxValue=0})},a.clearAllFundingInvestors=function(b){b.stopImmediatePropagation(),b.preventDefault(),a.intermediateCriteriaStorageObject.fundingTypeIds=[],a.intermediateCriteriaStorageObject.fundingAmount.minValue=0,a.intermediateCriteriaStorageObject.fundingAmount.maxValue=0,a.intermediateCriteriaStorageObject.fundingDate.minValue=null,a.intermediateCriteriaStorageObject.fundingDate.maxValue=null,a.intermediateCriteriaStorageObject.investorIds=[],this.intermediateCriteriaStorageObject.startsWithInvestors="",s.cancel(E),this.lists.investorsList=[]},a.countFundingAndInvestors=function(){return y.countFundingAndInvestors(a.intermediateCriteriaStorageObject)},a.selectAllAdditionalDetails=function(b){b.stopImmediatePropagation(),b.preventDefault(),_.each(n,function(b){_.indexOf(a.intermediateCriteriaStorageObject.businessModelIds,b)<0&&a.intermediateCriteriaStorageObject.businessModelIds.push(b)})},a.clearAllAdditionalDetails=function(b,c){b.stopImmediatePropagation(),b.preventDefault(),a.intermediateCriteriaStorageObject.businessModelIds=[],a.intermediateCriteriaStorageObject.yearFounded.minValue=null,a.intermediateCriteriaStorageObject.yearFounded.maxValue=null,a.intermediateCriteriaStorageObject.numLocations.minValue=0,a.intermediateCriteriaStorageObject.numLocations.maxValue=0,a.intermediateCriteriaStorageObject.numHospitalBeds.minValue=0,a.intermediateCriteriaStorageObject.numHospitalBeds.maxValue=0,a.intermediateCriteriaStorageObject.companyRecordsDate.minValue=0,a.intermediateCriteriaStorageObject.companyRecordsApplication=null,a.intermediateCriteriaStorageObject.withinTheLastNumOfDays=0,m(a.recordsRadios,{})},a.$onSelect=function(b){b=b||a.fortuneGlobal.options[0],0===b.id&&(a.fortuneGlobal.selected=0),a.intermediateCriteriaStorageObject.fortuneRank=angular.copy(b.values.fortune),a.intermediateCriteriaStorageObject.globalRank=angular.copy(b.values.global)},a.$bm=function(){arguments[0].preventDefault(),arguments[0].stopPropagation(),g.track("Search","ListMatch - Companies","Click");var b=t.open(u.bulkMatchModal());b.result.then(function(b){if("indirect"===b.type)a.intermediateCriteriaStorageObject.companyIds=_.uniq(a.intermediateCriteriaStorageObject.companyIds.concat(b.data));else if("direct"===b.type)switch(b.data.placement){case-1:a.intermediateCriteriaStorageObject.dunsIds=_.uniq(a.intermediateCriteriaStorageObject.dunsIds.concat(b.data.info));break;case-2:a.intermediateCriteriaStorageObject.personIds=_.uniq(a.intermediateCriteriaStorageObject.personIds.concat(b.data.info));
break;case-3:a.intermediateCriteriaStorageObject.emailAddresses=_.uniq(a.intermediateCriteriaStorageObject.emailAddresses.concat(b.data.info))}})},a.$on("event:DealPredictPerforming",function(b,c){a.isDealPredictPerforming=c.isDealPredictPerforming}),a.close=b.close}],resolve:{$criteria:function(){return a},$$ownership:function(){return b.getOwnershipTypeList(c)},$$industry:function(){return b.getIndustryList(c)},$$businessModels:function(){return b.getBusinessModelTypeList(c)},departments:function(){return b.getDepartmentList(c)},fundingTypes:function(){return b.getFundingTypeList(c)},changeActiveCriteriaObjectFn:function(){return d}},size:"lg",templateUrl:o+"companiesCriteriaWithApplyFilters.modal.html",backdrop:j?"static":"true"}},this.employeesCriteria=function(a,c,d,e){var g=h.findFeatureFlag(p,"search_apply_filters");return{controller:["$scope","$uibModalInstance","$criteria","$$depts","$$jobFunctions","$$seniorityLevels","$$seniorityLevelGroups","SearchService","FormatDatesService","featureFlagService","$rootScope","ActiveCriteriaCountService","changeActiveCriteriaObjectFn","searchGridTemplateService",function(a,b,c,d,g,h,j,m,n,o,s,t,u,v){function w(){for(var b in a.intermediateCriteriaStorageObject)a.activeCriteria.hasOwnProperty(b)&&(a.activeCriteria[b]=a.intermediateCriteriaStorageObject[b]);u(a.activeCriteria),a.close()}function x(b){F(a.intermediateCriteriaStorageObject,a.phoneRadios,b)}function y(b){E(a.intermediateCriteriaStorageObject,a.phoneRadios,{})}function z(b){E(a.intermediateCriteriaStorageObject,a.emailRadios,{})}function A(b){F(a.intermediateCriteriaStorageObject,a.emailRadios,b)}function B(){var b=_.findIndex(a.phoneRadios,function(a){return _.isEqual(a.Selected,a.value)}),c=_.findIndex(a.emailRadios,function(a){return _.isEqual(a.Selected,a.value)}),d=b>=0?1:0;return d+=c>=0?1:0}function C(){return t.checkCounts(a.intermediateCriteriaStorageObject)}function D(){G(a.intermediateCriteriaStorageObject,a.phoneRadios),G(a.intermediateCriteriaStorageObject,a.emailRadios)}function E(a,b,c){c=c||{};for(var d=0;d<b.length;d++)c.value&&c.value===b[d].value||(b[d].Selected=!1,a[b[d].value]=!1)}function F(a,b,c){if(!_.isEmpty(b)){a[c.value]=!0;var d=v.getRadioTrackEventType(c.value);d&&m.trackSearchEventAction(d),E(a,b,c)}}function G(a,b){if(!_.isEmpty(b))for(var c=0;c<b.length;c++){var d=b[c].value;if(a.hasOwnProperty(d)&&a[d]){b[c].Selected=d;break}}}function H(){var b=a.intermediateCriteriaStorageObject.personRecordsDate.minValue>0&&a.intermediateCriteriaStorageObject.personRecordsApplication?1:0;return b+=a.intermediateCriteriaStorageObject.includeOnlySuperset?1:0}if(a.tierTwo=s.Session.account.canAccessTierTwoData,a.addedChangedEnabled=o.findFeatureFlag(p,"addedorupdated"),a.searchApplyFiltersFlagActive=o.findFeatureFlag(p,"search_apply_filters"),a.allowedSupersetAccess=s.Session.allowedSupersetAccess,a.newDataPointsForRecruitersEnabled=o.findFeatureFlag(p,"recruiters_new_dp"),a.activeCriteria=c,a.isResearcherVerifiedView=e,a.newDataPointsForRecruitersEnabled||(a.activeCriteria.havingMobilePhone=!1,a.activeCriteria.havingPersonalEmail=!1,a.activeCriteria.havingOfficePhone=!1,a.activeCriteria.havingAnyEmail=!1),a.criteriaToFilter=angular.copy(a.activeCriteria),a.intermediateCriteriaStorageObject=a.activeCriteria,a.searchApplyFiltersFlagActive&&(a.intermediateCriteriaStorageObject=a.criteriaToFilter),a.resultsCounts=i(m.getResultsCounts()),a.$on("results:getCounts",function(b,c){a.resultsCounts=i(c)}),a.phoneRadios=angular.copy(f.phoneRadios),a.emailRadios=angular.copy(f.emailRadios),D(),a.entityTypes=q,a.setPhoneForSearch=x,a.setEmailForSearch=A,a.clearPhoneSelection=y,a.clearEmailSelection=z,a.countContactInfoCriteria=B,a.countAdditionalDetails=H,a.countedEntityDisplayName="-",r&&(a.countedEntityDisplayName=q[r].displayName),a.isRecordCountDisplayed=a.resultsCounts.count&&r,a.$watch("intermediateCriteriaStorageObject",function(b,c){angular.equals(b,c)||(a.isRecordCountDisplayed=!1)},!0),a.searchCount=function(b){function c(b){a.entityCount=b.data.searchCriteriaScoped}a.countedEntityDisplayName=q[b].displayName;var d=m.transformActiveCriteriaToSearchCriteriaModel(a.intermediateCriteriaStorageObject);a.entityCount="-",q[b].countFunction(d).then(c),r=b,a.isRecordCountDisplayed=!0},a.isRecordCountDisplayed&&a.searchCount(r),a.isItemCounted=function(b){return a.isRecordCountDisplayed&&b===a.countedEntityDisplayName},a.showCount=function(a){return m.showCount(q,a)},a.isTierTwo=function(a){return m.isTierTwo(a)},a.makePreviewRecordCountDrodownItemText=function(b){var c="";return a.isItemCounted(b)&&(c=" ("+a.entityCount.toLocaleString()+")"),m.makePreviewCountedEntityDisplayName(b)+c},a.lists={departments:d,jobFunctions:g,seniorityLevels:h,seniorityLevelGroups:j},a.senSearch="",a.jobFnSearch="",a.startsWithArray=f.startsWith,a.$$filterDebounce=f.filterDebounce,a.recordsRadios=angular.copy(f.recordsRadios),a.intermediateCriteriaStorageObject.personRecordsDate.minValue){var I=new Date,J=new Date(a.intermediateCriteriaStorageObject.personRecordsDate.minValue);a.intermediateCriteriaStorageObject.withinTheLastNumOfDays=n.setTwoDatesFormat(I,J)||0;for(var K=0;K<a.recordsRadios.length;K++)a.intermediateCriteriaStorageObject.personRecordsApplication===a.recordsRadios[K].value&&(a.recordsRadios[K].Selected=!0)}else a.intermediateCriteriaStorageObject.withinTheLastNumOfDays=0;var L=[],M=[],N=function(a){return M.indexOf(a.personSeniorityGroupId)>-1},O=function(a){if(!_.has(a,"departmentIds"))return!1;for(var b=0,c=a.departmentIds.length;b<c;++b)if(L.indexOf(a.departmentIds[b])>-1)return!0;return!1},P=function(b,c){var d=_.pluck(b,"id");a.intermediateCriteriaStorageObject[c]=_.filter(a.intermediateCriteriaStorageObject[c],function(a){return d.indexOf(a.id)>-1})},Q=function(b){M=_.pluck(b.seniorityLevelGroupIds,"id"),L=_.pluck(b.departmentIds,"id"),a.nullOptionDepartments=_.find(b.departmentIds,function(a){return a.nullOption===!0}),!M.length&&!L.length||a.nullOptionDepartments?(a.lists.seniorityLevels=h,a.lists.jobFunctions=g):M.length>0&&L.length>0?(a.lists.seniorityLevels=_.filter(h,function(a){return N(a)&&O(a)}),a.lists.jobFunctions=_.filter(g,O)):M.length>0?(a.lists.seniorityLevels=_.filter(h,N),a.lists.jobFunctions=g):L.length>0&&(a.lists.seniorityLevels=_.filter(h,O),a.lists.jobFunctions=_.filter(g,O)),P(a.lists.seniorityLevels,"seniorityLevelIds"),P(a.lists.jobFunctions,"jobFunctionIds")},R=function(b,c,d){var e=_.filter(b,function(a){return _.includes(a.displayName.toLowerCase(),c.toLowerCase())});_.each(e,function(b){_.indexOf(a.intermediateCriteriaStorageObject[d],b)<0&&a.intermediateCriteriaStorageObject[d].push(b)})};a.applyFilters=w,a.isAnyCriteriaSelected=C,a.filterOptions=function(a){Q(a)},a.filterOptions(a.intermediateCriteriaStorageObject),a.$on("results:getCounts",function(b,c){a.resultsCounts=i(c)}),a.setTypeForSearch=function(b,c){k(a.intermediateCriteriaStorageObject,a.recordsRadios,"personRecordsApplication","personRecordsDate",b,c)},a.setDaysForSearch=function(b){l(a.intermediateCriteriaStorageObject,"personRecordsApplication","personRecordsDate",b)},a.selectAllJobFunction=function(a){a.stopImmediatePropagation(),a.preventDefault(),R(g,this.jobFnSearch,"jobFunctionIds")},a.clearAllJobFunction=function(b){b.stopImmediatePropagation(),b.preventDefault(),a.intermediateCriteriaStorageObject.jobFunctionIds=[],this.jobFnSearch=""},a.selectAllSeniority=function(b){b.stopImmediatePropagation(),b.preventDefault(),R(a.lists.seniorityLevels,this.senSearch,"seniorityLevelIds")},a.clearAllSeniority=function(b){b.stopImmediatePropagation(),b.preventDefault(),a.intermediateCriteriaStorageObject.seniorityLevelIds=[],a.intermediateCriteriaStorageObject.reportsDirectlyToCLevel=!1,this.senSearch=""},a.$on("event:DealPredictPerforming",function(b,c){a.isDealPredictPerforming=c.isDealPredictPerforming}),a.close=b.close}],resolve:{$criteria:function(){return a},$$depts:function(){return b.getDepartmentList(c)},$$jobFunctions:function(){return b.getJobFunctionList(c)},$$seniorityLevels:function(){return b.getSeniorityLevelList(c)},$$seniorityLevelGroups:function(){return b.getSeniorityLevelGroupList(c)},changeActiveCriteriaObjectFn:function(){return d}},size:"lg",templateUrl:o+"employeesCriteriaWithApplyFilters.modal.html",backdrop:g?"static":"true"}},this.techCriteria=function(a,c,d,e){var g=h.findFeatureFlag(p,"search_apply_filters");return{controller:["$scope","$uibModalInstance","$criteria","$categories","$rootScope","$searchCache","$timeout","$interval","SearchService","categoryIdsChecked","featureFlagService","ActiveCriteriaCountService","changeActiveCriteriaObjectFn",function(a,b,d,g,h,j,k,l,m,n,o,s,t){function u(){for(var b in a.intermediateCriteriaStorageObject)a.activeCriteria.hasOwnProperty(b)&&(a.activeCriteria[b]=a.intermediateCriteriaStorageObject[b]);t(a.activeCriteria),a.close()}function v(){return s.checkCounts(a.intermediateCriteriaStorageObject)}var w=null,x=null,y=function(b){var c=0,d=21,e=_.chunk(b.data,d),f=150;l.cancel(x),a.lists.technologyProducts=[],x=l(function(){if(!e[c])return void l.cancel(x);for(var b=0,d=e[c].length;b<d;++b)a.lists.technologyProducts.push(e[c][b]);c+=1},f,e.length),j.setTech(b.idMap)};a.searchApplyFiltersFlagActive=o.findFeatureFlag(p,"search_apply_filters"),a.activeCriteria=d,a.isResearcherVerifiedView=e,a.criteriaToFilter=angular.copy(a.activeCriteria),a.intermediateCriteriaStorageObject=a.activeCriteria,a.searchApplyFiltersFlagActive&&(a.intermediateCriteriaStorageObject=a.criteriaToFilter),a.hgDataRemoval=o.findFeatureFlag(null,"hg_data_removal"),a.lists={technologyProducts:[]},a.resultsCounts=i(m.getResultsCounts()),a.$on("results:getCounts",function(b,c){a.resultsCounts=i(c)}),a.entityTypes=q,a.countedEntityDisplayName="-",r&&(a.countedEntityDisplayName=q[r].displayName),a.isRecordCountDisplayed=a.resultsCounts.count&&r,a.$watch("intermediateCriteriaStorageObject",function(b,c){angular.equals(b,c)||(a.isRecordCountDisplayed=!1)},!0),a.searchCount=function(b){function c(b){a.entityCount=b.data.searchCriteriaScoped}a.countedEntityDisplayName=q[b].displayName;var d=m.transformActiveCriteriaToSearchCriteriaModel(a.intermediateCriteriaStorageObject);a.entityCount="-",q[b].countFunction(d).then(c),r=b,a.isRecordCountDisplayed=!0},a.isRecordCountDisplayed&&a.searchCount(r),a.isItemCounted=function(b){return a.isRecordCountDisplayed&&b===a.countedEntityDisplayName},a.showCount=function(a){return m.showCount(q,a)},a.isTierTwo=function(a){return m.isTierTwo(a)},a.makePreviewRecordCountDrodownItemText=function(b){var c="";return a.isItemCounted(b)&&(c=" ("+a.entityCount.toLocaleString()+")"),m.makePreviewCountedEntityDisplayName(b)+c},a.lists.technologyCategories=g,a.startsWith="",a.applyFilters=u,a.isAnyCriteriaSelected=v,a.startsWithArray=f.startsWith,a.$$filterDebounce=f.filterDebounce,a.technologyRadios=f.technologyRadios,_.isEmpty(a.intermediateCriteriaStorageObject.technologyCategoryIds)||(a.intermediateCriteriaStorageObject.technologyCategoryIds=_.filter(a.intermediateCriteriaStorageObject.technologyCategoryIds,function(a){return _.includes(n,a.id)}),_.isEmpty(a.intermediateCriteriaStorageObject.technologyCategoryIds)||m.getTechnologyList(c,a.startsWith,a.intermediateCriteriaStorageObject.technologyCategoryIds).then(y)),a.$watch("intermediateCriteriaStorageObject.technologyCategoryIds",function(b,d){angular.equals(b,d)||0===b.length||(_.isEmpty(a.intermediateCriteriaStorageObject.technologyCategoryIds)?a.intermediateCriteriaStorageObject.technologyProductIds=[]:m.getTechnologyList(c,"",a.intermediateCriteriaStorageObject.technologyCategoryIds).then(function(b){var c=b.data,d=[];_.each(c,function(b){var c=_.find(a.intermediateCriteriaStorageObject.technologyProductIds,function(a){return b.id==a.id});c&&d.push(c)}),a.intermediateCriteriaStorageObject.technologyProductIds=d}),k.cancel(w),w=k(function(){m.getTechnologyList(c,a.startsWith,a.intermediateCriteriaStorageObject.technologyCategoryIds).then(y)},750))},!0),a.getTechnologyList=function(b){a.startsWith=b,m.getTechnologyList(c,b,a.intermediateCriteriaStorageObject.technologyCategoryIds).then(y)},a.selectVisible=function(){a.lists.technologyProducts.length>a.intermediateCriteriaStorageObject.technologyProductIds.length?_.each(a.lists.technologyProducts,function(b){_.indexOf(a.intermediateCriteriaStorageObject.technologyProductIds,b)<0&&a.intermediateCriteriaStorageObject.technologyProductIds.push(b)}):a.intermediateCriteriaStorageObject.technologyProductIds=[]},a.clearAll=function(b){b.stopImmediatePropagation(),b.preventDefault(),a.intermediateCriteriaStorageObject.technologyProductIds=[],a.intermediateCriteriaStorageObject.technologyCategoryIds=[],this.startsWith="",a.intermediateCriteriaStorageObject.technologiesApplication="COMPANY_TECHNOLOGIES",this.getTechnologyList()},a.$on("event:DealPredictPerforming",function(b,c){a.isDealPredictPerforming=c.isDealPredictPerforming}),a.close=function(){b.close()}}],resolve:{$criteria:function(){return a},$categories:function(){return b.getTechnologyCategoriesList(c)},categoryIdsChecked:function(){return _.isEmpty(a.technologyProductIds)?[]:b.getTechnologyCategoriesByProductIds(c,a.technologyProductIds)},changeActiveCriteriaObjectFn:function(){return d}},size:"lg",templateUrl:o+"techCriteriaWithApplyFilters.modal.html",backdrop:g?"static":"true"}},this.locationCriteria=function(a,b,c,d){var e=h.findFeatureFlag(p,"search_apply_filters");return{controller:["$scope","$uibModalInstance","$criteria","$ga","SearchService","featureFlagService","$geoData","ActiveCriteriaCountService","changeActiveCriteriaObjectFn",function(a,b,c,e,g,h,j,k,l){function m(a){a.stopImmediatePropagation(),a.preventDefault()}function n(){for(var b in a.intermediateCriteriaStorageObject)a.activeCriteria.hasOwnProperty(b)&&(a.activeCriteria[b]=a.intermediateCriteriaStorageObject[b]);l(a.activeCriteria),a.close()}function o(){return k.checkCounts(a.intermediateCriteriaStorageObject)&&a.isGeoProcess}a.activeCriteria=c,a.isResearcherVerifiedView=d,a.resultsCounts=i(g.getResultsCounts()),a.locationRadios=f.locationRadios,a.$$filterDebounce=f.filterDebounce,a.mileRadius=f.mileRadius,a.locationPostalCodeRadios=f.locationPostalCodeRadios,a.isValidPostalCodes=!0,a.isValidPostalCodeCenter=!0,a.isGeoProcess=!0,a.countyFeatureFlag=h.findFeatureFlag(null,"county"),a.searchApplyFiltersFlagActive=h.findFeatureFlag(p,"search_apply_filters"),a.criteriaToFilter=angular.copy(a.activeCriteria),a.intermediateCriteriaStorageObject=a.activeCriteria,a.searchApplyFiltersFlagActive&&(a.intermediateCriteriaStorageObject=a.criteriaToFilter),_.has(a.intermediateCriteriaStorageObject,"geo")&&_.has(a.intermediateCriteriaStorageObject.geo,"postalCodeApplyToUSOnly")?a.geo={postalCodeApplyToUSOnly:a.intermediateCriteriaStorageObject.geo.postalCodeApplyToUSOnly,postalCodes:a.intermediateCriteriaStorageObject.geo.postalCodes.join(", "),postalCodeCenter:a.intermediateCriteriaStorageObject.geo.postalCodeCenter,radialDistance:a.intermediateCriteriaStorageObject.geo.radialDistance}:a.geo={postalCodeApplyToUSOnly:!0,postalCodes:"",postalCodeCenter:"",radialDistance:""},a.countries=j[2],a.states=j[3],a.continents=j[1],a.metro=j[4],a.areaCodes=j[5],a.counties=j[7],a.$onSelect=function(a,b,c){b.$select.search="",e.track("Search","Location","Selected ("+a+"): "+c.displayName)},a.resultsCounts=i(g.getResultsCounts()),a.$on("results:getCounts",function(b,c){a.resultsCounts=i(c)}),a.entityTypes=q,a.countedEntityDisplayName="-",r&&(a.countedEntityDisplayName=q[r].displayName),a.isRecordCountDisplayed=a.resultsCounts.count&&r,a.$watch("intermediateCriteriaStorageObject",function(b,c){angular.equals(b,c)||(a.isRecordCountDisplayed=!1)},!0),a.searchCount=function(b){function c(b){a.entityCount=b.data.searchCriteriaScoped}a.countedEntityDisplayName=q[b].displayName;var d=g.transformActiveCriteriaToSearchCriteriaModel(a.intermediateCriteriaStorageObject);a.entityCount="-",q[b].countFunction(d).then(c),r=b,a.isRecordCountDisplayed=!0},a.isRecordCountDisplayed&&a.searchCount(r),a.isItemCounted=function(b){return a.isRecordCountDisplayed&&b===a.countedEntityDisplayName},a.showCount=function(a){return g.showCount(q,a)},a.isTierTwo=function(a){return g.isTierTwo(a)},a.makePreviewRecordCountDrodownItemText=function(b){var c="";return a.isItemCounted(b)&&(c=" ("+a.entityCount.toLocaleString()+")"),g.makePreviewCountedEntityDisplayName(b)+c},a.$onRemove=function(a,b,c){b.$select.search="",e.track("Search","Location","Removed ("+a+"): "+c.displayName)},a.resetGeoProcess=function(){a.isGeoProcess=!1},a.processSearchingByGeo=function(){var b=g.formatPostalCodesArray(a.geo.postalCodes,a.geo.postalCodeApplyToUSOnly);a.isValidPostalCodes=!a.geo.postalCodeApplyToUSOnly||g.validateUSPostalCodes(b),a.isValidPostalCodes&&(a.isValidPostalCodeCenter=!a.geo.postalCodeApplyToUSOnly||g.validateUSPostalCodes([a.geo.postalCodeCenter]),a.isValidPostalCodeCenter&&(a.geo.radialDistance&&_.isEmpty(a.geo.radialDistance.trim())!==_.isEmpty(a.geo.postalCodeCenter.trim())||(a.intermediateCriteriaStorageObject.geo.postalCodeApplyToUSOnly=a.geo.postalCodeApplyToUSOnly,a.intermediateCriteriaStorageObject.geo.postalCodes=b,a.intermediateCriteriaStorageObject.geo.postalCodeCenter=a.geo.postalCodeCenter,a.intermediateCriteriaStorageObject.geo.radialDistance=a.geo.radialDistance,0!=b.length&&(a.geo.postalCodes=b.join(", "),a.geo.postalCodes+=" "),a.isGeoProcess=!0)))},a.clearAllGeography=function(b){m(b),a.intermediateCriteriaStorageObject.geo.continents=[],a.intermediateCriteriaStorageObject.geo.countries=[],a.intermediateCriteriaStorageObject.geo.states=[],a.intermediateCriteriaStorageObject.geo.metro=[],a.intermediateCriteriaStorageObject.geo.areas=[],a.intermediateCriteriaStorageObject.geo.counties=[],a.intermediateCriteriaStorageObject.locationsApplication="COMPANY_ADDRESS"},a.clearAllPostalCode=function(b){m(b),a.intermediateCriteriaStorageObject.geo.radialDistance="",a.intermediateCriteriaStorageObject.geo.postalCodeCenter="",a.intermediateCriteriaStorageObject.geo.postalCodes=[],a.intermediateCriteriaStorageObject.locationsApplication="COMPANY_ADDRESS",a.intermediateCriteriaStorageObject.geo.postalCodeApplyToUSOnly=!0,a.geo.radialDistance="",a.geo.postalCodeCenter="",a.geo.postalCodes="",a.geo.postalCodeApplyToUSOnly=!0},a.$on("event:DealPredictPerforming",function(b,c){a.isDealPredictPerforming=c.isDealPredictPerforming}),a.close=function(){b.close()},a.applyFilters=n,a.isAnyCriteriaSelected=o}],resolve:{$criteria:function(){return a},$geoData:function(){return b},changeActiveCriteriaObjectFn:function(){return c}},size:"lg",templateUrl:o+"locationCriteriaWithApplyFilters.modal.html",backdrop:e?"static":"true"}},this.intelCriteria=function(a,c,d,e){var g=h.findFeatureFlag(p,"search_apply_filters");return{controller:["$scope","$uibModalInstance","$criteria","$$intelDepts","$$resolve","$$cats","SearchService","featureFlagService","intelLegacyCategoryIds","ActiveCriteriaCountService","changeActiveCriteriaObjectFn","dateValidationService",function(a,b,c,d,g,h,j,k,l,m,n,o){function s(){a.transFormInputDate();for(var b in a.intermediateCriteriaStorageObject)a.activeCriteria.hasOwnProperty(b)&&(a.activeCriteria[b]=a.intermediateCriteriaStorageObject[b]);n(a.activeCriteria),a.close()}function t(){return m.checkCounts(a.intermediateCriteriaStorageObject)}function u(a){return _.filter(a,function(a){return a.nullOption!==!0})}a.searchApplyFiltersFlagActive=k.findFeatureFlag(p,"search_apply_filters"),a.resultsCounts=i(j.getResultsCounts()),a.$on("results:getCounts",function(b,c){a.resultsCounts=i(c)}),a.activeCriteria=c,a.isResearcherVerifiedView=e,a.criteriaToFilter=angular.copy(a.activeCriteria),a.intermediateCriteriaStorageObject=a.activeCriteria,a.searchApplyFiltersFlagActive&&(a.intermediateCriteriaStorageObject=a.criteriaToFilter),a.entityTypes=q,a.countedEntityDisplayName="-",r&&(a.countedEntityDisplayName=q[r].displayName),a.isRecordCountDisplayed=a.resultsCounts.count&&r,a.$watch("intermediateCriteriaStorageObject",function(b,c){angular.equals(b,c)||(a.isRecordCountDisplayed=!1)},!0),a.searchCount=function(b){function c(b){a.entityCount=b.data.searchCriteriaScoped}a.countedEntityDisplayName=q[b].displayName;var d=j.transformActiveCriteriaToSearchCriteriaModel(a.intermediateCriteriaStorageObject);a.entityCount="-",q[b].countFunction(d).then(c),r=b,a.isRecordCountDisplayed=!0},a.isRecordCountDisplayed&&a.searchCount(r),a.isItemCounted=function(b){return a.isRecordCountDisplayed&&b===a.countedEntityDisplayName},a.showCount=function(a){return j.showCount(q,a)},a.isTierTwo=function(a){return j.isTierTwo(a)},a.makePreviewRecordCountDrodownItemText=function(b){var c="";return a.isItemCounted(b)&&(c=" ("+a.entityCount.toLocaleString()+")"),j.makePreviewCountedEntityDisplayName(b)+c},a.applyFilters=s,a.isAnyCriteriaSelected=t,a.lists={intelDepartments:u(d),intelReportTypes:g,intelCategories:h};var v=[];a.changeDateCriteria={showOnlyUpdated:!1,changeDate:{minValue:null,maxValue:null}},a.triggersToScoopFlag=k.findFeatureFlag(null,"triggerstoscoops"),a.intelLegacyCategoriesSelected=[],a.triggersToScoopFlag?(a.intelText="Scoop",a.topicsText="Topics"):(a.intelText="Trigger",a.topicsText="Categories"),a.triggersToScoopFlag&&(_.forEach(a.lists.intelReportTypes,function(a,b){v=v.concat(a.children)}),a.intermediateCriteriaStorageObject.intelUpdatedDate&&(!_.isEmpty(a.intermediateCriteriaStorageObject.intelUpdatedDate.minValue)||!_.isEmpty(a.intermediateCriteriaStorageObject.intelUpdatedDate.maxValue))||a.intermediateCriteriaStorageObject.intelIncludeOnlyUpdated?(a.changeDateCriteria.showOnlyUpdated=!0,a.changeDateCriteria.changeDate=a.intermediateCriteriaStorageObject.intelUpdatedDate):a.changeDateCriteria.changeDate=a.intermediateCriteriaStorageObject.intelPublishDate),a.triggersToScoopFlag&&_.size(a.intermediateCriteriaStorageObject.intelCategoryIds)>0&&_.size(l)>0&&(a.intelLegacyCategoriesSelected=_.sortByOrder(_.filter(a.intermediateCriteriaStorageObject.intelCategoryIds,function(a){return _.includes(l,a.id)}),["displayName"],["asc"])),a.$$filterDebounce=f.filterDebounce,a.intelSearchCats="",a.selectedTypeIds=_.cloneDeep(a.intermediateCriteriaStorageObject.intelTypeIds),a.clickOnIntelType=function(b,c){event.target.checked?_.findIndex(a.selectedTypeIds,function(a){return a.id===b.id})===-1&&a.selectedTypeIds.push(b):_.remove(a.selectedTypeIds,function(a){return a.id===b.id})},a.removeLegacyTopic=function(b){a.intelLegacyCategoriesSelected.splice(b,1)},a.changeScoopChangeDate=function(){_.isEmpty(a.changeDateCriteria.changeDate.minValue)&&(a.changeDateCriteria.changeDate.minValue=null),_.isEmpty(a.changeDateCriteria.changeDate.maxValue)&&(a.changeDateCriteria.changeDate.maxValue=null),a.changeDateCriteria.showOnlyUpdated?(a.intermediateCriteriaStorageObject.intelUpdatedDate=a.changeDateCriteria.changeDate,a.intermediateCriteriaStorageObject.intelPublishDate={minValue:null,maxValue:null},a.intermediateCriteriaStorageObject.intelIncludeOnlyUpdated=!0):(a.intermediateCriteriaStorageObject.intelPublishDate=a.changeDateCriteria.changeDate,a.intermediateCriteriaStorageObject.intelUpdatedDate={minValue:null,maxValue:null}),a.intermediateCriteriaStorageObject.intelIncludeOnlyUpdated=!!a.changeDateCriteria.showOnlyUpdated},a.selectAll=function(b){b.stopImmediatePropagation(),b.preventDefault(),_.each(h,function(b){_.indexOf(a.intermediateCriteriaStorageObject.intelCategoryIds,b)<0&&a.intermediateCriteriaStorageObject.intelCategoryIds.push(b)})},a.clearAll=function(b){b.stopImmediatePropagation(),b.preventDefault(),_.size(a.intermediateCriteriaStorageObject.intelCategoryIds)>0&&_.size(l)>0?_.remove(a.intermediateCriteriaStorageObject.intelCategoryIds,function(a){return!_.includes(l,a.id)}):a.intermediateCriteriaStorageObject.intelCategoryIds=[],this.intelSearchCats=""},a.selectAllTypes=function(b){b.stopImmediatePropagation(),b.preventDefault(),a.intermediateCriteriaStorageObject.intelTypeIds=_.cloneDeep(v),a.selectedTypeIds=_.cloneDeep(a.intermediateCriteriaStorageObject.intelTypeIds)},a.clearAllTypes=function(b){b.stopImmediatePropagation(),b.preventDefault(),a.intermediateCriteriaStorageObject.intelTypeIds=[],a.selectedTypeIds=_.cloneDeep(a.intermediateCriteriaStorageObject.intelTypeIds)},a.clearAllLegacyTopics=function(b){b.stopImmediatePropagation(),b.preventDefault(),a.intelLegacyCategoriesSelected=[],_.size(a.intermediateCriteriaStorageObject.intelCategoryIds)>0&&_.size(l)>0&&_.remove(a.intermediateCriteriaStorageObject.intelCategoryIds,function(a){return _.includes(l,a.id)})},a.$on("event:DealPredictPerforming",function(b,c){a.isDealPredictPerforming=c.isDealPredictPerforming}),a.close=function(){b.close()},a.selectGroupType=function(b,c){var d=_.cloneDeep(a.lists.intelReportTypes[b].children);c.target.checked?a.intermediateCriteriaStorageObject.intelTypeIds=_.uniq(_.union(a.intermediateCriteriaStorageObject.intelTypeIds,d),"id"):_.remove(a.intermediateCriteriaStorageObject.intelTypeIds,function(a){var b=_.find(d,function(b){return a.id===b.id});return!_.isUndefined(b)}),a.selectedTypeIds=_.cloneDeep(a.intermediateCriteriaStorageObject.intelTypeIds)},a.isSelectAllTypeOfGroup=function(b){var c=_.cloneDeep(b.children);return _.remove(c,function(b){var c=_.find(a.selectedTypeIds,function(a){return b.id===a.id});return!_.isUndefined(c)}),0===c.length},a.transFormInputDate=function(){_.isEmpty(a.intermediateCriteriaStorageObject.intelUpdatedDate.minValue)||o.isValidDate(a.intermediateCriteriaStorageObject.intelUpdatedDate.minValue)||(a.intermediateCriteriaStorageObject.intelUpdatedDate.minValue=null),_.isEmpty(a.intermediateCriteriaStorageObject.intelUpdatedDate.maxValue)||o.isValidDate(a.intermediateCriteriaStorageObject.intelUpdatedDate.maxValue)||(a.intermediateCriteriaStorageObject.intelUpdatedDate.maxValue=null),_.isEmpty(a.intermediateCriteriaStorageObject.intelPublishDate.minValue)||o.isValidDate(a.intermediateCriteriaStorageObject.intelPublishDate.minValue)||(a.intermediateCriteriaStorageObject.intelPublishDate.minValue=null),_.isEmpty(a.intermediateCriteriaStorageObject.intelPublishDate.maxValue)||o.isValidDate(a.intermediateCriteriaStorageObject.intelPublishDate.maxValue)||(a.intermediateCriteriaStorageObject.intelPublishDate.maxValue=null)}}],resolve:{$criteria:function(){return a},$$resolve:function(){return b.getIntelReportTypes(c)},$$intelDepts:function(){return b.getDepartmentList(c)},$$cats:function(){return b.getIntelCategoryList(c)},intelLegacyCategoryIds:function(){return b.getIntelLegacyCategoryIds(c)},changeActiveCriteriaObjectFn:function(){return d}},size:"lg",templateUrl:o+"scoopCriteriaWithApplyFilters.modal.html",backdrop:g?"static":"true"}},this.keywordCriteria=function(a,b,c){var d=h.findFeatureFlag(p,"search_apply_filters");return{controller:["$scope","$uibModalInstance","activeCriteria","keywordSearchType","SearchService","featureFlagService","ActiveCriteriaCountService","changeActiveCriteriaObjectFn",function(a,b,d,e,f,g,h,j){function k(){l.intermediateCriteriaStorageObject.textSearchString=_.cloneDeep(l.textSearchString),l.intermediateCriteriaStorageObject.keywordTermsAplication=_.cloneDeep(l.selecteKeywordSearchType)}var l=this,m=f.getAllKeywordSearchType();l.keywordSearchType=e,l.selecteKeywordSearchType=[],l.textSearchString="",l.triggerText=g.findFeatureFlag(p,"triggerstoscoops")?"Scoop Records":"Trigger Records",_.isEmpty(d.keywordTermsAplication)||(l.selecteKeywordSearchType=_.cloneDeep(d.keywordTermsAplication)),_.isEmpty(d.textSearchString)||(l.textSearchString=_.cloneDeep(d.textSearchString)),l.resultsCounts=i(f.getResultsCounts()),a.$on("results:getCounts",function(a,b){l.resultsCounts=i(b)}),l.searchApplyFiltersFlagActive=g.findFeatureFlag(p,"search_apply_filters"),l.isResearcherVerifiedView=c,l.activeCriteria=d,l.criteriaToFilter=angular.copy(l.activeCriteria),l.intermediateCriteriaStorageObject=l.activeCriteria,l.searchApplyFiltersFlagActive&&(l.intermediateCriteriaStorageObject=l.criteriaToFilter),l.selectAllKeywordType=function(a){a.stopImmediatePropagation(),a.preventDefault(),l.selecteKeywordSearchType=_.pluck(m,"value"),_.isEmpty(l.textSearchString)||k()},l.changeKeywordTermsAplication=function(a,b){b?_.isEmpty(l.textSearchString)||(l.intermediateCriteriaStorageObject.keywordTermsAplication.push(a),l.intermediateCriteriaStorageObject.textSearchString=_.cloneDeep(l.textSearchString)):(_.remove(l.intermediateCriteriaStorageObject.keywordTermsAplication,function(b){return b===a}),0===_.size(l.intermediateCriteriaStorageObject.keywordTermsAplication)&&(l.textSearchString="",l.intermediateCriteriaStorageObject.textSearchString=""))},l.updateKeywordSearch=function(a){_.isEmpty(a)||_.isEmpty(l.selecteKeywordSearchType)?l.intermediateCriteriaStorageObject.textSearchString=_.cloneDeep(l.textSearchString):k()},l.getActiveCriteria=function(){return _.isEmpty(l.intermediateCriteriaStorageObject.textSearchString)?0:_.size(l.intermediateCriteriaStorageObject.keywordTermsAplication)},l.isAnyCriteriaSelected=function(){return h.checkCounts(l.intermediateCriteriaStorageObject)},l.clearAllKeywordType=function(a){l.selecteKeywordSearchType=[],l.textSearchString="",l.intermediateCriteriaStorageObject.textSearchString="",l.intermediateCriteriaStorageObject.keywordTermsAplication=[]},a.$on("event:DealPredictPerforming",function(a,b){l.isDealPredictPerforming=b.isDealPredictPerforming}),l.close=function(){_.isEmpty(l.intermediateCriteriaStorageObject.textSearchString)&&(l.intermediateCriteriaStorageObject.keywordTermsAplication=[]),b.close()},l.getSelectedFieldClass=function(a){var b="";return _.includes(l.selecteKeywordSearchType,a)&&(b="selected"),b},l.areKeywordSearchTypeSelected=function(){return!!l.selecteKeywordSearchType&&0!==l.selecteKeywordSearchType.length},l.getKeywordPlaceholderText=function(){return l.areKeywordSearchTypeSelected()?"Enter keyword(s) here...":"Select at least one field to search before entering keyword(s) here..."},l.applyFilters=function(){for(var a in l.intermediateCriteriaStorageObject)l.activeCriteria.hasOwnProperty(a)&&(l.activeCriteria[a]=l.intermediateCriteriaStorageObject[a]);j(l.activeCriteria),l.close()},l.entityTypes=q,l.countedEntityDisplayName="-",r&&(l.countedEntityDisplayName=q[r].displayName),l.isRecordCountDisplayed=l.resultsCounts.count&&r,a.$watch("keywordSearchVm.intermediateCriteriaStorageObject",function(a,b){angular.equals(a,b)||(l.isRecordCountDisplayed=!1)},!0),l.searchCount=function(a){function b(a){l.entityCount=a.data.searchCriteriaScoped}l.countedEntityDisplayName=q[a].displayName;var c=f.transformActiveCriteriaToSearchCriteriaModel(l.intermediateCriteriaStorageObject);l.entityCount="-",q[a].countFunction(c).then(b),r=a,l.isRecordCountDisplayed=!0},l.isRecordCountDisplayed&&l.searchCount(r),l.isItemCounted=function(a){return l.isRecordCountDisplayed&&a===l.countedEntityDisplayName},l.showCount=function(a){return f.showCount(q,a)},l.isTierTwo=function(a){return f.isTierTwo(a)},l.makePreviewRecordCountDrodownItemText=function(a){var b="";return l.isItemCounted(a)&&(b=" ("+l.entityCount.toLocaleString()+")"),f.makePreviewCountedEntityDisplayName(a)+b}}],controllerAs:"keywordSearchVm",resolve:{activeCriteria:function(){return a},keywordSearchType:function(){return f.keywordSearchTypes},changeActiveCriteriaObjectFn:function(){return b}},size:"lg",templateUrl:o+"keywordCriteria.modal.html",backdrop:d?"static":"true"}},this.fitScoreCriteria=function(a,b,c){return{controller:["$scope","$uibModalInstance","$rootScope",function(a,b,d){a.close=b.close,a.canAccessTierTwo=c,a.has=d.Session.account.havingUserLeadModelEnabled,a.$on("$stateChangeStart",b.close)}],size:"",templateUrl:o+"fitscore.modal.html"}},this.unsupportedFilters=function(a){return{controller:["$scope","$uibModalInstance","$rootScope",function(b,c,d){b.unsupportedFilters=a,b.close=c.close,b.has=d.Session.account.havingUserLeadModelEnabled,b.$on("$stateChangeStart",c.close)}],size:"",templateUrl:o+"unsupported-filters.modal.html"}}}]),angular.module("dorgEuiApp").factory("$SearchStaticFactory",function(){
var a={};return a.bulkMatchCategories=[{pngCategoryType:"NAME",displayName:"Company Names"},{pngCategoryType:"DOMAIN",displayName:"Company Websites"},{pngCategoryType:"PARENT_DUNS",displayName:"Parent D.U.N.S"},{pngCategoryType:-1,displayName:"Primary D.U.N.S."},{pngCategoryType:"ID",displayName:"DiscoverOrg Company IDs"},{pngCategoryType:-2,displayName:"DiscoverOrg Employee IDs"},{pngCategoryType:-3,displayName:"Employee Email Addresses"}],a.startsWith=["#","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],a.textTermRadios=[{label:"Companies",value:"COMPANIES"},{label:"Triggers",value:"INTEL"},{label:"Employees",value:"PERSONS"},{label:"Technologies",value:"COMPANY_TECHNOLOGIES"}],a.keywordSearchTypes={company:[{label:"Name",value:"COMPANY_NAME",activeLabel:"Company Name"},{label:"Company Description",value:"COMPANY_DESCRIPTION",activeLabel:"Company Description"},{label:"Technologies",value:"COMPANY_TECHNOLOGIES",activeLabel:"Company Technologies"}],employee:[{label:"Full Name",value:"PERSON_FULL_NAME",activeLabel:"Employee Full Name"},{label:"Title",value:"PERSON_TITLE",activeLabel:"Employee Title"},{label:"Description (Notes)",value:"PERSON_DESCRIPTION",activeLabel:"Employee Description (Notes)"}],trigger:[{label:"Description",value:"INTEL_REPORT_DESCRIPTION",activeLabel:"Trigger"}]},a.keywordSearchTypesForScoop={company:[{label:"Name",value:"COMPANY_NAME",activeLabel:"Company Name"},{label:"Company Description",value:"COMPANY_DESCRIPTION",activeLabel:"Company Description"},{label:"Technologies",value:"COMPANY_TECHNOLOGIES",activeLabel:"Company Technologies"}],employee:[{label:"Full Name",value:"PERSON_FULL_NAME",activeLabel:"Employee Full Name"},{label:"Title",value:"PERSON_TITLE",activeLabel:"Employee Title"},{label:"Description (Notes)",value:"PERSON_DESCRIPTION",activeLabel:"Employee Description (Notes)"}],trigger:[{label:"Description",value:"INTEL_REPORT_DESCRIPTION",activeLabel:"Scoop"}]},a.technologyRadios=[{label:"Companies",value:"COMPANY_TECHNOLOGIES"},{label:"Employees",value:"PERSON_TECHNOLOGIES"}],a.locationRadios=[{label:"Headquarters Address",value:"COMPANY_ADDRESS"},{label:"Employee Address",value:"PERSON_ADDRESS"}],a.recordsRadios=[{label:"Records Added",value:"RECORDS_ADDED"},{label:"Records Changed",value:"RECORDS_CHANGED"}],a.fortuneRank={list:[{value:500,label:"Fortune 500"},{value:1e3,label:"Fortune 1000"},{value:-1,label:"ANY"}],selected:null},a.fortuneGlobal={options:[{id:0,label:"All",values:{fortune:{minValue:0,maxValue:0},global:{minValue:0,maxValue:0}}},{id:1,label:"Fortune 500",values:{fortune:{minValue:1,maxValue:500},global:{minValue:0,maxValue:0}}},{id:2,label:"Fortune 1000",values:{fortune:{minValue:1,maxValue:1e3},global:{minValue:0,maxValue:0}}},{id:3,label:"Global 2000",values:{fortune:{minValue:0,maxValue:0},global:{minValue:0,maxValue:2e3}}},{id:4,label:"Fortune 500 and Global 2000",values:{fortune:{minValue:1,maxValue:500},global:{minValue:0,maxValue:2e3}}},{id:5,label:"Fortune 1000 and Global 2000",values:{fortune:{minValue:1,maxValue:1e3},global:{minValue:0,maxValue:2e3}}}],selected:0},a.textCountDefs={companies:{0:"Companies",1:"Companies"},persons:{0:"Employees",1:"Employees"},intel:{0:"Real Time Triggers",1:"Real Time Triggers"},tierTwoCompanies:{0:"Technology Generated Companies",1:"Technology Generated Companies"},tierTwoPersons:{0:"Technology Generated Employees",1:"Technology Generated Employees"}},a.textCountDefsSingle={companies:{0:"Company",1:"Company"},persons:{0:"Employee",1:"Employee"},intel:{0:"Real Time Trigger",1:"Real Time Trigger"},tierTwoCompanies:{0:"Technology Generated Company",1:"Technology Generated Company"},tierTwoPersons:{0:"Technology Generated Employee",1:"Technology Generated Employee"}},a.filterDebounce=1e3,a.searchExecTimer=1500,a.singleSearchExecTimer=800,a.mileRadius=[{key:"",value:"Select"},{key:"5",value:"5 miles"},{key:"10",value:"10 miles"},{key:"25",value:"25 miles"},{key:"50",value:"50 miles"},{key:"100",value:"100 miles"}],a.locationPostalCodeRadios=[{label:"United States",value:!0},{label:"United States and International",value:!1}],a.phoneRadios=[{label:"Has direct phone (office or mobile)",value:"havingDirectPhone"},{label:"Has office phone",value:"havingOfficePhone"},{label:"Has mobile phone",value:"havingMobilePhone"}],a.emailRadios=[{label:"Has email (work or personal)",value:"havingAnyEmail"},{label:"Has work email",value:"havingEmail"},{label:"Has personal email",value:"havingPersonalEmail"}],a}),function(){"use strict";function a(a,b,c){function d(a){return a&&(a.minValue>0||a.maxValue>0)?1:0}function e(a){return!_.isNull(a)&&!_.isUndefined(a)&&!_.isEmpty(a)}function f(a){return e(a.minValue)||e(a.maxValue)}function g(a,b,c){return a[c].minValue>0&&a[b]?1:0}function h(a){a.total=Object.keys(a).reduce(function(b,c){return b+a[c]},0)}function i(a){return Object.keys(a).reduce(function(b,c){return b+d(a[c].numEmployees)},0)}function j(a){var b={};return b.companyIds=a.companyIds.length,b.departments=i(a.departments),b.industryIds=a.industryIds.length,b.naicsCodes=a.naicsCodes.length,b.sicCodes=a.sicCodes.length,b.ownershipTypeIds=a.ownershipTypeIds.length,b.businessModelIds=a.businessModelIds.length,b.yearFounded=d(a.yearFounded),b.numEmployees=d(a.numEmployees),b.numLocations=d(a.numLocations),b.numHospitalBeds=d(a.numHospitalBeds),b.revenue=d(a.revenue),b.employeeGrowth=d(a.employeeGrowth),b.revenueGrowth=d(a.revenueGrowth),b.fortuneGlobalRank=a.fortuneRank.maxValue>0||a.globalRank.maxValue>0?1:0,b.companyRecordsDate=g(a,"companyRecordsApplication","companyRecordsDate")?1:0,b.fundingTypeIds=a.fundingTypeIds.length,b.fundingAmount=d(a.fundingAmount),b.fundingDate=null!=a.fundingDate.minValue&&""!=a.fundingDate.minValue&&c("startDateIsValid")(a.fundingDate.minValue)||null!=a.fundingDate.maxValue&&""!=a.fundingDate.maxValue&&c("endDateIsValid")(a.fundingDate.minValue,a.fundingDate.maxValue)?1:0,b.investorIds=a.investorIds.length,h(b),b}function k(a){var b={};return b.departmentIds=a.departmentIds.length,b.seniorityLevelIds=a.seniorityLevelIds.length,b.jobFunctionIds=a.jobFunctionIds.length,b.includeOnlySuperset=a.includeOnlySuperset===!0?1:0,b.havingDirectPhone=a.havingDirectPhone===!0?1:0,b.havingEmail=a.havingEmail===!0?1:0,b.havingMobilePhone=a.havingMobilePhone===!0?1:0,b.havingPersonalEmail=a.havingPersonalEmail===!0?1:0,b.havingOfficePhone=a.havingOfficePhone===!0?1:0,b.havingAnyEmail=a.havingAnyEmail===!0?1:0,b.reportsDirectlyToCLevel=a.reportsDirectlyToCLevel===!0?1:0,b.employeeStartDate=null!==a.employeeStartDate.minValue&&""!=a.employeeStartDate.minValue?1:null!==a.employeeStartDate.maxValue&&""!=a.employeeStartDate.maxValue?1:0,b.recordsAddedChanged=g(a,"personRecordsApplication","personRecordsDate")?1:0,h(b),b}function l(a){var b=0;return b+=a.technologyProductIds.length}function m(a){var b={};return a.geo?(b.continents=a.geo.continents.length,b.countries=a.geo.countries.length,b.states=a.geo.states.length,b.metro=a.geo.metro.length,b.areas=a.geo.areas.length,b.counties=a.geo.counties.length,b.postalCodes=a.geo.postalCodes?a.geo.postalCodes.length:0,b.radial=a.geo.radialDistance&&a.geo.postalCodeCenter?1:0,h(b)):b.total=0,b}function n(a){var c={};return c.typeIds=a.intelTypeIds.length,c.departmentIds=a.intelDepartmentIds.length,c.categoryIds=a.intelCategoryIds.length,a.intelPublishDate&&(c.publishDateRange=null!=a.intelPublishDate.minValue&&""!=a.intelPublishDate.minValue&&b.isValidDate(a.intelPublishDate.minValue)?1:null!=a.intelPublishDate.maxValue&&""!=a.intelPublishDate.maxValue&&b.isValidDate(a.intelPublishDate.maxValue)?1:0),a.intelUpdatedDate&&(c.dateCount=null!=a.intelUpdatedDate.minValue&&""!=a.intelUpdatedDate.minValue&&b.isValidDate(a.intelUpdatedDate.minValue)?1:null!=a.intelUpdatedDate.maxValue&&""!=a.intelUpdatedDate.maxValue&&b.isValidDate(a.intelUpdatedDate.maxValue)?1:0),0===c.dateCount&&a.intelIncludeOnlyUpdated&&(c.dateCount=1),h(c),c}function o(a){return _.isEmpty(a.textSearchString)?0:_.size(a.keywordTermsAplication)}function p(a){return j(a).total+k(a).total+m(a).total+n(a).total+a.dunsIds.length+a.personIds.length+a.emailAddresses.length+a.technologyProductIds.length+o(a)}function q(a){return{activeCriteria:p(a),companies:j(a).total,employees:k(a).total,location:m(a).total,technologyProducts:l(a),intel:n(a).total,keyword:o(a)}}function r(a){return{companies:j(a),employees:k(a),location:m(a),technologyProducts:l(a),intel:n(a),keyword:o(a)}}function s(a){var b=0;return b+=a.fundingTypeIds.length+d(a.fundingAmount)+(null!=a.fundingDate.minValue&&""!=a.fundingDate.minValue&&c("startDateIsValid")(a.fundingDate.minValue)||null!=a.fundingDate.maxValue&&""!=a.fundingDate.maxValue&&c("endDateIsValid")(a.fundingDate.minValue,a.fundingDate.maxValue)?1:0)+a.investorIds.length}return{checkCounts:p,countActiveCriteriaCompanies:j,countActiveCriteriaDepartments:i,countActiveCriteriaEmployees:k,countActiveCriteriaTechProducts:l,countActiveCriteriaIntel:n,countActiveCriteriaLocation:m,countActiveCriteriaKeyword:o,getAllTotals:q,getDetailCounts:r,isSearchCriteriaNumberRangeNonDefault:d,recordsAddedChangedHasValue:g,countFundingAndInvestors:s,isSearchCriteriaNumberRangeHasValue:f}}angular.module("dorgEuiApp").service("ActiveCriteriaCountService",a),a.$inject=["featureFlagService","dateValidationService","$filter"]}(),function(){"use strict";function a(a){function b(a,b){return{companyGridFilterResource:a.companyGridFilterResource||{},intelGridFilterResource:a.intelGridFilterResource||{},personGridFilterResource:a.personGridFilterResource||{},companyTierTwoGridFilterResource:b.companyTierTwoGridFilterResource||{},personTierTwoGridFilterResource:b.personTierTwoGridFilterResource||{}}}function c(a){if(null!=a)for(var b=Object.keys(a),c=0,d=b.length;c<d;++c)_.isString(a[b[c]])&&(a[b[c]]=a[b[c]].replace(",","")),a[b[c]]!==n&&a[b[c]]!==l&&(a[b[c]]*=k);return a}function d(b,d,e,f){var g=JSON.parse(JSON.stringify(b)),h=e,i="tierTwoPersons"===d,k="tierTwoCompanies"===d;if(!h||"companies"!==d&&"tierTwoCompanies"!==d)!h||"persons"!==d&&"tierTwoPersons"!==d?h&&"intel"===d&&(g.fitScoreIncluded=!1,h.publishDate&&null!==h.publishDate&&(h.publishDate={minValue:a("date")(h.publishDate.minValue,"MM/dd/yyyy")||null,maxValue:a("date")(h.publishDate.maxValue,"MM/dd/yyyy")||null},h.publishDate.minValue&&(g.intelPublishDate.minValue=new Date(h.publishDate.minValue+o)),h.publishDate.maxValue&&(g.intelPublishDate.maxValue=new Date(h.publishDate.maxValue+o))),g.intelCompanyName=h.companyName,g.intelCategoryName=h.intelCategoriesName):(g.employeeName=h.fullName,g.employeeEmail=h.email,g.employeeCompanyName=h.companyName,g.employeeTitle=h.title,g.employeeJobFunction=i?h.jobFunctionsName:h.jobFunction,g.employeeStreetAddress=i?h.companyLocationStreetAddress1:h.locationStreetAddress,g.employeePostalCode=i?h.companyLocationPostalCode:h.locationPostalCode,g.employeeCity=i?h.companyLocationCity:h.locationCity,g.employeeStateProvinceRegion=i?h.companyLocationStateProvinceRegion:h.locationStateProvinceRegion,g.employeeCountry=i?h.companyLocationCountryName:h.locationCountryName,g.hasLinkedInUrl=h.linkedInUrl,g.employeeReportToName=h.reportsToFullName,g.hasTwitterUrl=h.twitterHandle,g.employeePersonalEmail=h.personalEmail,i&&(g.companyTier=h.companyTier));else{g.companyName=h.name,g.companyWebsite=h.websiteUrl,g.companyStreetAddress=k?h.hqStreetAddress1:h.locationStreetAddress,g.companyPostalCode=k?h.hqPostalCode:h.locationPostalCode,g.companyCity=k?h.hqCityName:h.locationCity,g.companyStateProvinceRegion=k?h.hqStateName:h.locationStateProvinceRegion,g.companyIndustryName=k?h.primaryIndustryName:h.industryName,k||(g.companyUltimateParentName=h.ultimateParentName),g.numEmployees=j(g.numEmployees,h.numEmployees,!1),g.revenue=j(g.revenue,h.revenue,f);for(var l=1;l<=9;l++){var m=h["departments"+l+"NumEmployees"];_.has(g.departments[l],"numEmployees")&&(g.departments[l].numEmployees=j(g.departments[l].numEmployees,m,!1))}g.fundingAmount.minValue=null!=e.fundingAmount&&null!=e.fundingAmount.minValue?e.fundingAmount.minValue:0,g.fundingAmount.maxValue=null!=e.fundingAmount&&null!=e.fundingAmount.maxValue?e.fundingAmount.maxValue:0,f&&(g.fundingAmount=c(g.fundingAmount)),e.fundingDate&&null!==e.fundingDate&&(e.fundingDate={minValue:a("date")(e.fundingDate.minValue,"MM/dd/yyyy")||null,maxValue:a("date")(e.fundingDate.maxValue,"MM/dd/yyyy")||null},e.fundingDate.minValue&&(g.fundingDate.minValue=new Date(e.fundingDate.minValue+o)),e.fundingDate.maxValue&&(g.fundingDate.maxValue=new Date(e.fundingDate.maxValue+o)))}return g}function e(a,b,c){var d=_.cloneDeep(a);return d.textSearchString="",c&&"companies"===b?(d.companyName=null,d.companyPhone=null,c.numEmployees&&(c.numEmployees.minValue||c.numEmployees.maxValue)&&(d.numEmployees={minValue:null,maxValue:null}),c.revenue&&(c.revenue.minValue||searchGridFilters.revenue.maxValue)&&(d.revenue={minValue:null,maxValue:null}),d.companyRecordsApplication=void 0,d.companyRecordsDate={minValue:null,maxValue:null},d.companyStreetAddress=null,d.companyPostalCode=null,d.companyCity=null,d.companyStateProvinceRegion=null,d.companyIndustryName=null,d.companyWebsite=null):!c||"persons"!==b&&"tierTwoPersons"!==b?c&&"intel"===b&&(d.fitScoreIncluded=!1,c.publishDate&&null!==c.publishDate&&(d.intelPublishDate=null),d.intelCompanyName=null,d.intelCategoryName=null,c.typeId&&0!==c.typeId&&(d.intelTypeIds=[])):(d.employeeName=null,d.employeeEmail=null,d.employeeCompanyName=null,d.employeeTitle=null,d.employeeJobFunction=null,d.employeeReportToName=null,d.employeeStreetAddress=null,d.employeePostalCode=null,d.employeeCity=null,d.employeeStateProvinceRegion=null,d.employeeCountry=null,d.hasLinkedInUrl=null,d.hasTwitterUrl=null),d}function f(a,b){var c;return c=b?parseFloat(a):parseInt(a,10),_.isNaN(c)?null:c}function g(a){if(a){a.numEmployees=h(a.numEmployees),a.revenue=i(a.revenue);for(var b=1;b<=9;b++){var c=a["departments"+b+"NumEmployees"];c&&(a["departments"+b+"NumEmployees"]=h(c))}}return a}function h(a){if(a){if(null===a.minValue&&null===a.maxValue)return null;null===a.minValue&&(a.minValue=l),null===a.maxValue&&(a.maxValue=m)}return a}function i(a){if(a){if(null===a.minValue&&null===a.maxValue)return null;null===a.minValue&&(a.minValue=l),null===a.maxValue&&(a.maxValue=n)}return a}function j(a,b,d){if(a){if(b){var e={minValue:b.minValue,maxValue:b.maxValue},f=m;d&&(e=c(e),f=n),e.minValue!==l&&(e.minValue=e.minValue+1),e.maxValue!==f&&(e.maxValue=e.maxValue-1),(e.minValue>a.minValue||0==a.minValue)&&(a.minValue=e.minValue),(e.maxValue<a.maxValue||0==a.maxValue)&&(a.maxValue=e.maxValue)}}else a={minValue:0,maxValue:0};return a}var k=1e6,l=-Math.pow(2,31),m=Math.pow(2,31)-1,n=Math.pow(2,53)-1,o=" UTC-8";return{parseRevenue:c,getGridFilterResourceKeys:b,updateCriteriaToSearchFromSearchGridFilters:d,clearSearchGridFiltersFromSearchCriteria:e,getNumberFilter:f,standardizeGridFilters:g}}a.$inject=["$filter"],angular.module("dorgEuiApp").service("searchFilterService",a)}(),angular.module("dorgEuiApp").controller("SearchCtrl",["$$GCE","$animate","$checkBulk","$filter","$ga","$grid","$gridStatic","$interval","$q","$rootScope","$scope","$searchCache","$SearchModalsService","$SearchStaticFactory","$state","$timeout","$window","downloadExportService","Flash","searchCriteriaViewResource","SearchService","uiGridConstants","$location","AbmService","featureFlagService","bulkMatchService","ActiveCriteriaCountService","phoneNumberService","NotificationService","singleModalService","searchGridTemplateService","searchFilterService","companyIndustryService","$uibModal",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H){function I(a){return a[1].label="Scoops",a}function J(a){e.track("Search","ListMatch","Click"),z.setMode("search");var b=H.open({templateUrl:"app/components/bulkMatch/bulkMatchModal/bulk-match-modal.tpl.html",controller:"bulkMatchModalController as $ctrl",size:"lg",backdrop:"static",windowClass:"search-bulk-match",resolve:{isForOppAlert:function(){return!1}}}).result.then(function(a){return a.data&&a.data.length?void Q({isCompany:a.isCompany,ids:a.data},"id",k.swapResultsView):a.runAnother?void J():void 0});return j.listMatchNotifications&&setTimeout(function(){j.$broadcast("showImportHistory")},500),b}function K(){for(var a=0,b=Object.keys(k.searchResults),c=b.length;a<c;++a){var d=k.searchResults[b[a]];d.data=[],d.api&&d.api.grid&&(Aa(d.api.grid.columns),k.$$searchGridFilters[b[a]]=null,d.api.core.clearAllFilters())}}function L(a){var b=angular.copy(a);k.shouldTrackSearch=!0,ka=!0,b.websiteUrls=[],k.activeCriteria=b,S(k.activeCriteria)}function M(){var a=window.location.href,b=a.indexOf("?url=");b!==-1&&(X=null,w.url(w.path()))}function N(){_.each(k.$$searchGridFilters[k.currentResultsView],function(a,b){var c,d=_.find(k.searchResults[k.currentResultsView].columnDefs,{field:b});d||(c=b.replace(/([A-Z])/,".$1").toLowerCase(),d=_.find(k.searchResults[k.currentResultsView].columnDefs,{field:c})),d||(d=_.find(k.searchResults[k.currentResultsView].columnDefs,{searchGridFiltersName:b})),d||"companyName"!==b||(d=_.find(k.searchResults[k.currentResultsView].columnDefs,{field:"employeeCompanyName"})),d?d.filter.term=a:delete k.$$searchGridFilters[k.currentResultsView][b]})}function O(a){if(!pa&&a){for(var b=a.grid.columns,c={},d=0;d<b.length;++d){var e=b[d].filters,f=b[d].filter,g=_.camelCase(b[d].field);if(la.test(g)&&(g=b[d].name),b[d].enableFiltering&&1===e.length&&(c[g]=f.term&&b[d]?f.term:""),b[d].enableFiltering&&e.length>1){c[g]={};for(var h=0,i=e.length;h<i;++h){var j=e[h].condition,l=v.filter;if(void 0===j&&("More Than"===e[h].placeholder&&(j=l.GREATER_THAN),"Less Than"===e[h].placeholder&&(j=l.LESS_THAN)),j===l.GREATER_THAN||j===l.LESS_THAN){var m=j===l.GREATER_THAN?"minValue":"maxValue",n="revenue"===g,o=F.getNumberFilter(e[h].term,n);c[g][m]=o}else j!==l.DATE_GREATER_THAN&&j!==l.DATE_LESS_THAN||(_.isEmpty(e[h].term)?c[g][j===l.DATE_GREATER_THAN?"minValue":"maxValue"]=null:c[g][j===l.DATE_GREATER_THAN?"minValue":"maxValue"]=new Date(e[h].term+" UTC-8").getTime())}}}var p=Object.keys(c).length<1?null:c;k.$$searchGridFilters[k.currentResultsView]=F.standardizeGridFilters(p)}}function P(){k.countActiveCriteria=A.getAllTotals(k.activeCriteria)}function Q(a,b,c){var d="persons",e="personIds";a.isCompany&&(d="companies",e="companyIds"),a.companyId&&(a.ids=[a.companyId],d="persons",e="companyIds"),c(d),k.activeCriteria[e]=_.uniq(k.activeCriteria[e].concat(a.ids),b)}function R(a){k.currentResultsView=a}function S(a){var b=A.getDetailCounts(a),c=[];return b.companies.total>0&&(b.companies.ownershipTypeIds>0&&c.push("Company Ownership Type"),b.companies.revenueGrowth>0&&c.push("3-Year Growth % - Sales Vol"),b.companies.employeeGrowth>0&&c.push("3-Year Growth % - Employees"),b.companies.departments>0&&c.push("Department Employee Count"),b.companies.fundingTypeIds>0&&c.push("Funding Type"),b.companies.fundingAmount>0&&c.push("Funding Amount"),b.companies.fundingDate>0&&c.push("Funding Date"),b.companies.investorIds>0&&c.push("Investors"),b.companies.businessModelIds>0&&c.push("Business Model"),b.companies.yearFounded>0&&c.push("Year Founded"),b.companies.numLocations>0&&c.push("Number of Locations"),b.companies.numHospitalBeds>0&&c.push("Number of Hospital Beds")),b.employees.total>0&&(b.employees.includeOnlySuperset>0&&c.push("Only show those in Supersets"),b.employees.recordsAddedChanged>0&&c.push("Person Records Added/Changed"),b.employees.reportsDirectlyToCLevel>0&&c.push("Reports Directly to C-Level")),b.technologyProducts>0&&c.push("All Technology Product Filters"),b.intel.total>0&&c.push("All Scoops Filters"),a.keywordTermsAplication.length>0&&(_.includes(a.keywordTermsAplication,"COMPANY_DESCRIPTION")&&c.push("Company Description Keywords"),_.includes(a.keywordTermsAplication,"COMPANY_TECHNOLOGIES")&&c.push("Company Technologies Keywords"),_.includes(a.keywordTermsAplication,"PERSON_DESCRIPTION")&&c.push("Employee Description (Notes) Keywords"),_.includes(a.keywordTermsAplication,"INTEL_REPORT_DESCRIPTION")&&c.push("Scoops Description Keywords")),c}function T(){k.unsupportedFilters=S(k.activeCriteria)}function U(){r.checkCanExport().then(function(a){k.canExport="true"===a})}function V(a,b){k.disabledExportAll=!0,k.exportLimitReached=null,"persons"===a?(k.exportRowLimit=k.personExportRowLimit,k.type=b?b:k.type,k.exportLimitReached=null!=k.searchResultsA.personsCount&&k.searchResultsA.personsCount.searchCriteriaScoped>k.personExportRowLimit,k.disabledExportAll=!(_.isEmpty(k.searchResultsA.personsCount)||!_.has(k.searchResultsA.personsCount,"totalExcludePrivacyRequested"))&&0===k.searchResultsA.personsCount.totalExcludePrivacyRequested||k.exportLimitReached):"companies"===a?(k.exportRowLimit=k.companyExportRowLimit,k.type=b?b:k.type,k.exportLimitReached=null!=k.searchResultsA.companiesCount&&k.searchResultsA.companiesCount.searchCriteriaScoped>k.companyExportRowLimit,k.disabledExportAll=!(_.isEmpty(k.searchResultsA.companiesCount)||!_.has(k.searchResultsA.companiesCount,"searchCriteriaScoped"))&&0===k.searchResultsA.companiesCount.searchCriteriaScoped||k.exportLimitReached):"intel"===a?(k.exportRowLimit=k.scoopExportRowLimit,k.type="Scoops",k.exportLimitReached=null!=k.searchResultsA.intelCount&&k.searchResultsA.intelCount.searchCriteriaScoped>k.scoopExportRowLimit,k.disabledExportAll=!(_.isEmpty(k.searchResultsA.intelCount)||!_.has(k.searchResultsA.intelCount,"searchCriteriaScoped"))&&0===k.searchResultsA.intelCount.searchCriteriaScoped||k.exportLimitReached):"tierTwoPersons"===a?(k.exportRowLimit=k.personExportRowLimit,k.type=b?b:k.type,k.exportLimitReached=null!=k.searchResultsA.tierTwoPersonsCount&&k.searchResultsA.tierTwoPersonsCount.searchCriteriaScoped>k.personExportRowLimit):"tierTwoCompanies"===a&&(k.exportRowLimit=k.companyExportRowLimit,k.type=b?b:k.type,k.exportLimitReached=null!=k.searchResultsA.tierTwoCompaniesCount&&k.searchResultsA.tierTwoCompaniesCount.searchCriteriaScoped>k.companyExportRowLimit)}function W(a,b){if(!_.isUndefined(b)){var c=b.data;_.forEach(c,function(a){var b=_.filter(l.selection(k.currentResultsView),{id:a.id});b.length>0&&(b[0].followed=!b[0].followed)})}}var X=null,Y=!1;k.isSearchGrid=!0,k.geography={},k.activeCriteriaCounts={},k.searchCriteriaByType={},k.currentPageSize=null,k.shouldTrackSearch=!0;var Z,$,aa,ba=o.params,ca=!1,da={},ea=t,fa=t,ga=!0,ha=!0,ia=!1,ja=!1,ka=!1,la=/departments\dNumEmployees/,ma=E.searchGridParams(),na=_.uniqueId(),oa=null,pa=!1,qa=null,ra=function(){if(k.currentPageSize=ma.size,_.each(k.searchResults,function(a){a.onRegisterApi=Ca}),j.Session&&j.Session.account&&(k.tierTwo=j.Session.account.canAccessTierTwoData),null!==ba.company&&(k.clearAllActive(),k.activeCriteria.companyIds.push(ba.company),k.activeCriteria.locationsApplication="COMPANY_ADDRESS"),"ABM"===w.search().textTermsApplication){ca=!0;window.localStorage&&window.localStorage.abmSearchReqSet&&x.getObjectSetFromLocalStorage("abmSearchReqSet").then(function(a){k.currentResultsView="companies",k.searchTypeInput=n.textTermRadios[1].label,a.savedSearch.searchCriteria.textSearchString="",k.activeCriteria=l.criteria(a.savedSearch.searchCriteria),k.doApplySavedSearch(a)})}else"OPPALERT"===w.search().textTermsApplication&&window.localStorage&&window.localStorage.oppAlertSelectedCompanies&&(k.currentResultsView="companies",k.searchTypeInput=n.textTermRadios[1].label,x.getObjectSetFromLocalStorage("oppAlertSelectedCompanies").then(function(a){p(function(){k.activeCriteria.companyIds=a.selectedCompanies})}));P(),u.setGeography(fa),k.geography=i.resolve(sa()),w.search().url&&(X=w.search().url),w.search().switchEmployee&&(Y="true"===w.search().switchEmployee.toLowerCase()),null!==X&&(k.clearAllActive(),""!==X.trim()&&(Y&&"persons"!==k.currentResultsView&&(k.currentResultsView="persons"),k.activeCriteria.websiteUrls=X.trim().split(","))),k.unsupportedFilters=S(k.activeCriteria)},sa=function(){return u.getGeography().then(function(a){return a})},ta=function(){var a=angular.copy(k.activeCriteria);Z=u.transformActiveCriteriaToSearchCriteriaModel(a),Z.isTier2PersonSearchFromCompanyPage||(delete Z.geo,delete Z.dateRange),l.setCriteria(a),k.unsupportedFilters=S(a),ha=k.isResearcherVerifiedView;var b=E.searchDefaultsToEmptyObjects();k.gridSelectedRows=E.searchDefaultsToEmptyArray(),k.searchResultsA[k.currentResultsView+"Count"]=b[k.currentResultsView+"Count"],k.spinner=!1;var c=k.currentResultsView,d=_.capitalize(c),f=ma.sortField||null,g=ma.sortOrder||null;"intel"!==c&&k.isResearcherVerifiedView||"fitscore"!==f||(f=null),k.$singleSearch(Z,E.searchGridParams(null,ma.size,f,g),c,d),j.Session.account.havingUserLeadModelEnabled&&k.activeCriteria.fitScoreIncluded&&"intel"!==c?e.track("Search","Search Request",c):e.track("Search","Search Request",c+" - DealPredict")},ua=function(a,b){var c=_.has(b,"uuid")?"uuid":"id";_.findIndex(k.gridSelectedRows[a],c,b[c])<0&&k.gridSelectedRows[a].push(b)},va=function(a,b){var c=_.has(b,"uuid")?"uuid":"id",d=_.findIndex(k.gridSelectedRows[a],c,b[c]);d>-1&&k.gridSelectedRows[a].splice(d,1)},wa=function(a,b,c,d){k.$eval("$singleSearch")(a,b,c,d)},xa=_.debounce(ta,n.searchExecTimer),ya=_.debounce(wa,n.singleSearchExecTimer),za=function(){xa.cancel(),p(function(){ya.cancel()},100),K(),k.searchResultsA={},k.searchResults[k.currentResultsView].totalItems=0,u.setResultsCount({tab:k.currentResultsView,count:0}),l.setEmptyCriteria(),l.clearSelection(),ga=!0,ma=E.searchGridParams(null,ma.size),Z=u.transformActiveCriteriaToSearchCriteriaModel(k.activeCriteria),P()},Aa=function(a){a=a||[];for(var b=0,c=a.length;b<c;++b)a[b].sort={}},Ba=function(){return"search_"+("persons"===k.currentResultsView?"employees":k.currentResultsView)},Ca=function(a){this.api=a;var b=function(){f.updateColumnDefinition(this.saveState.save().columns,Ba()),j.$broadcast("renderUiGridLockBoxes")};a.colMovable.on.columnPositionChanged(k,b),a.core.on.columnVisibilityChanged(k,b),a.colResizable.on.columnSizeChanged(k,function(){j.$broadcast("renderUiGridLockBoxes")}),a.core.on.filterChanged(k,function(){if(!ja){var a=u.transformActiveCriteriaToSearchCriteriaModel(k.activeCriteria);O(this),ya(F.updateCriteriaToSearchFromSearchGridFilters(a,k.currentResultsView,k.$$searchGridFilters[k.currentResultsView],!0),ma,k.currentResultsView)}}),a.selection.on.rowSelectionChangedBatch(k,function(a){for(var b=0,c=a.length;b<c;++b)a[b].isSelected?ua(k.currentResultsView,a[b].entity):va(k.currentResultsView,a[b].entity),l.setSelection(k.currentResultsView,a[b].entity,a[b].isSelected)}),a.selection.on.rowSelectionChanged(k,function(a){a.isSelected?ua(k.currentResultsView,a.entity):va(k.currentResultsView,a.entity),l.setSelection(k.currentResultsView,a.entity)}),a.pagination.on.paginationChanged(k,function(a,b){if(!ga){k.currentPageSize=b,ma.size!==b&&e.track("Search","Pagination Size Changed",b),oa=na,k.searchResults[k.currentResultsView].paginationPageSize=b,q.scrollTo(0,0),ma.size=b,ma.page=a-1,e.track("Search","Pagination Changed","Click");var c=u.transformActiveCriteriaToSearchCriteriaModel(k.activeCriteria),d=E.getSearchName(k.currentResultsView);k.$eval("$singleSearch")(c,ma,k.currentResultsView,d)}}),a.core.on.sortChanged(k,function(a,b){f.closeAllPopover(document),_.isUndefined(b[0])&&(b[0]={field:"",sort:{direction:null},colDef:{field:""}});var c=b[0];if(k.activeCriteria.fitScoreIncluded&&_.isEmpty(c.colDef.field)){if("fitscore"!==ma.sortField){var d=a.getColumn("fitscore");void 0!==d&&(d.sort.direction=v.DESC,ma.sortField=d.field,ma.sortOrder=d.sort.direction)}}else ma.sortOrder=c.sort.direction,ma.sortField=_.camelCase(c.colDef.field.replace(/\./g,"_"));var g=u.transformActiveCriteriaToSearchCriteriaModel(k.activeCriteria);k.$eval("$singleSearch")(g,ma,k.currentResultsView),e.track("Search","Grid Sort Direction","Field: "+c.displayName+"; Direction: "+c.sort.direction||"default")}),a.core.on.rowsRendered(k,function(){for(var a=this.grid.rows,b=_.map(l.selection(k.currentResultsView),function(b){var c=_.find(a,function(a){var c=_.has(b,"uuid")?"uuid":"id";return a.entity[c]===b[c]});return c?c.entity:b}),c=0,d=[],e=0;e<b.length;++e){d.push(b[e]);for(var f=0,g=a.length;f<g;++f){var h=_.has(a[f].entity,"uuid")?"uuid":"id";if(b[e][h]===a[f].entity[h]){c+=1,a[f].isSelected=!0;break}}}k.gridSelectedRows[k.currentResultsView]=d,c===a.length?this.grid.selection.selectAll=!0:this.grid.selection.selectAll&&(this.grid.selection.selectAll=!1)})},Da=function(){if(!u.$isEmptyCriteria(k.activeCriteria)){var a=k.currentResultsView,b=k.searchResults[a],c=_.capitalize(a),d=u.transformActiveCriteriaToSearchCriteriaModel(k.activeCriteria),e=_.has(b,"api")?b.api:k.searchResults[a];e&&k.$eval("$singleSearch")(d,ma,a,c)}},Ea=function(a){a.locationsApplication="COMPANY_ADDRESS",a.textTerms=[],a.textSearchString="",a.useSecondaryIndustry=!0,a.technologiesApplication="COMPANY_TECHNOLOGIES",a.companyRecordsApplication=null,a.personRecordsApplication=null,a.intelPublishDate={minValue:null,maxValue:null},a.employeeStartDate={minValue:null,maxValue:null},a.companyRecordsDate={minValue:null,maxValue:null},a.personRecordsDate={minValue:null,maxValue:null},a.ownershipTypeIds=[],a.keywordTermsAplication=[],a.fundingTypeIds=[],a.fundingAmount={minValue:0,maxValue:0},a.fundingDate={minValue:null,maxValue:null},a.investorIds=[]};k.showBulkMatch=J,null!==ba.view&&l.setView(ba.view),k.currentResultsView=l.view(),k.isResearcherVerifiedView=l.isResearcherVerifiedView(),k.searchResults=l.results(),ma.size=k.searchResults[k.currentResultsView].paginationPageSize,k.textTermRadios=I(n.textTermRadios),k.$$filterDebounce=n.filterDebounce,k.searchResultsA=l.baseA(),k.canExport=!1,k.isSearch=!0,k.enableSpinnerBG=!0,k.criteriaCollapsed=q.innerWidth<768,k.lists={},k.searchTypeInput=k.textTermRadios[1].label,k.$fitEnabled=u.$fitEnabled,fa.geo=ea.geo={continents:[],countries:[],states:[],metro:[],counties:[],areas:[]},fa.dateRange=ea.dateRange={minValue:null,maxValue:null};var Fa=angular.copy(fa);Ea(Fa),k.activeCriteria=l.criteria(Fa),k.canBulkUploadPersons=c.$checkPersons(),k.canBulkUploadCompanies=c.$checkCompanies(),k.spinner=!1,k.$$searchGridFilters=E.searchDefaultsToNull(),k.gridSelectedRows=E.searchDefaultsToEmptyArray(),k.getOfficeThenMobileThenCompanyNumberOrBlank=B.getOfficeThenMobileThenCompanyNumberOrBlank,k.getOfficeThenCompanyNumberOrBlank=B.getOfficeThenCompanyNumberOrBlank,k.getIndustriesInfo=G.getIndustriesInfo,k.$on("event:suppression",function(){k.gridSelectedRows[k.currentResultsView]=[],l.clearSelection(k.currentResultsView),Da()}),k.$on("event:followed",Da),k.$on("event:unfollowed",Da),k.$on("event:crmUpload",Da),k.$on("event:noteSaved",Da),k.$on("event:unOrFollowed",W),k.$on("intelDPLink",function(a,b){var c,d=JSON.parse(JSON.stringify(k.activeCriteria)),e=[];k.currentResultsView="intel",l.setView("intel"),_.has(k.searchResults.intel,"api")&&k.searchResults.intel.api.core.clearAllFilters(),k.$$searchGridFilters.intel=null,j.$broadcast("hidePopovers"),_.each(b.intelCategoryIds,function(a){e.push({id:a})}),l.clearSelection(k.currentResultsView),d.intelCategoryIds=e,d.companyIds=[{id:b.companyId}],c=u.transformActiveCriteriaToSearchCriteriaModel(d),delete c.geo,delete c.dateRange,k.gridSelectedRows=E.searchDefaultsToEmptyArray(),k.searchResultsA=E.searchDefaultsToEmptyObjects(),k.spinner=!1,k.$singleSearch(c,E.searchGridParams(null,ma.size),"intel","Intel")}),k.exportCriteria=function(){return $},k.$$updateSearchLabel=function(a){k.searchTypeInput=a},k.swapResultsView=function(a){var b=!1;if(!_.isEqual(a,k.currentResultsView)){k.searchResults[a].paginationPageSize!==k.currentPageSize&&(k.searchResults[a].paginationPageSize=k.currentPageSize,b=!0),_.isEqual(k.searchCriteriaByType[a],k.activeCriteria)&&0!=k.searchResults[a].data.length||(b=!0),ma.page=0,ja=!1,k.currentResultsView=a,u.setResultsCount({tab:k.currentResultsView,count:0}),l.setView(a),na=_.uniqueId();var c=k.searchResults[a];_.has(c,"api")&&c.api.core.clearAllFilters(),N();var d;c&&c.api&&c.api.grid&&(d=c.api.grid.getColumnSorting()),
void 0!==d&&d.length>0&&(ma.sortField=d[0].field,ma.sortOrder=d[0].sort.direction),e.track("Search","Results View",E.getTypeName(k.currentResultsView)),k.gridSelectedRows[a]=[],"intel"===a&&u.trackSearchEventAction("SCOOPS_SEARCH_GRID"),U(),!u.$isEmptyCriteria(k.activeCriteria)&&b?(ha=k.isResearcherVerifiedView,k.shouldTrackSearch=!0,ta()):ca?(ha=k.isResearcherVerifiedView,ta(da)):V(k.currentResultsView,E.getSearchName(k.currentResultsView)),j.$broadcast("hidePopovers")}},k.swapVerifiedView=function(a){if(!_.isEqual(k.isResearcherVerifiedView,a)){k.isResearcherVerifiedView=a;var b=E.getSearchTrackingTab(k.isResearcherVerifiedView);return a?"tierTwoCompanies"===k.currentResultsView?k.swapResultsView("companies"):k.swapResultsView("persons"):"companies"===k.currentResultsView?k.swapResultsView("tierTwoCompanies"):k.swapResultsView("tierTwoPersons"),u.trackSearchEventAction(b)}},k.updateTextArea=function(a,b){k.activeCriteria[b]=_.remove(k.activeCriteria[b],function(b){return b+""!==a})},k.clearAllActive=function(){ia=!0,ja=!0,k.activeCriteria=u.clearSearchGridFiltersFromSearchCriteria(angular.copy(ea),k.currentResultsView,k.$$searchGridFilters[k.currentResultsView]),k.unsupportedFilters=[],Ea(k.activeCriteria),k.latestSearchId=_.uniqueId(),k.searchTypeInput=n.textTermRadios[1].label,za(),j.curShowSavedSearchId=0;var a=k.searchResults.persons.columnDefs,b=k.searchResults.companies.columnDefs;"fitscore"===a[a.length-2].field&&a.splice(a.length-2,1),"fitscore"===b[b.length-2].field&&b.splice(b.length-2,1),k.spinner=!1,k.$$searchGridFilters=E.searchDefaultsToNull(),P()},k.saveThisSearch=function(a){return a=!!a,D.open(m.saveSearchModal(k.activeCriteria,a))},k.$bm=function(){arguments[0].preventDefault(),arguments[0].stopPropagation(),e.track("Search","ListMatch","Click");var a=D.open(m.bulkMatchModal());return a.result.then(function(a){if("indirect"===a.type)k.activeCriteria.companyIds=_.uniq(k.activeCriteria.companyIds.concat(a.data));else if("direct"===a.type)switch(a.data.placement){case-1:k.activeCriteria.dunsIds=_.uniq(k.activeCriteria.dunsIds.concat(a.data.info));break;case-2:k.activeCriteria.personIds=_.uniq(k.activeCriteria.personIds.concat(a.data.info));break;case-3:k.activeCriteria.emailAddresses=_.uniq(k.activeCriteria.emailAddresses.concat(a.data.info))}}),a},k.upgrade=function(){D.open(m.upgradeModal()),e.track("Search","Upgrade Modal","Click")},k.viewMap=function(){var a=[],b=k.gridSelectedRows[k.currentResultsView];a=b.length>0?b:k.searchResults[k.currentResultsView],_.has(a,"api")?(a=a.api.selection.getSelectedRows(),a.length<1&&(a=k.searchResults[k.currentResultsView].data)):a.length<1&&(a=k.searchResults[k.currentResultsView].data),a=_.filter(a,function(a){return a.location&&a.location.longitude}),D.open(m.mapModal(a,k.currentResultsView)),e.track("Search","Map","Click")},k.applySearch=function(){var a=aa=D.open(m.savedSearchModal());return a.result.then(function(a){e.track("Search","Saved Search","Click"),k.$eval("doApplySavedSearch")(a)}),a},k.recentSearch=function(){var a=aa=D.open(m.recentSearchModal());return a.result.then(function(a){e.track("Search","Recent Search","Click"),k.$eval("doApplySavedSearch")(a)}),a},k.showActiveCriteria=function(){return e.track("Search","Active Criteria","Click"),D.open(m.activeCriteria(k.activeCriteria,fa,T))},k.showUnsupportedFilters=function(){return e.track("Search","Unsupported Filters","Click"),D.open(m.unsupportedFilters(k.unsupportedFilters))},k.getCacheSelected=function(){return l.selection(k.currentResultsView)},k.countTotalItems=function(){var a=0;return"persons"===k.currentResultsView?a=null!=k.searchResultsA.personsCount?k.searchResultsA.personsCount.searchCriteriaScoped:0:"tierTwoPersons"===k.currentResultsView&&(a=null!=k.searchResultsA.tierTwoPersonsCount?k.searchResultsA.tierTwoPersonsCount.searchCriteriaScoped:0),a},k.doApplySavedSearch=function(a){ja=!0,K(),k.activeCriteria=u.convertSavedSearch(a),S(k.activeCriteria),!j.Session.account.havingUserLeadModelEnabled&&a.savedSearch.searchCriteria.fitScoreIncluded&&(a.savedSearch.searchCriteria.fitScoreIncluded=!1),N(),p(N,n.searchExecTimer);var b=k.searchResults.persons.columnDefs,c=k.searchResults.companies.columnDefs;k.activeCriteria.fitScoreIncluded?("fitscore"!==b[b.length-2].field&&b.splice(b.length-1,0,g.fitScoreCol()),"fitscore"!==c[c.length-2].field&&c.splice(c.length-1,0,g.fitScoreCol())):("fitscore"===b[b.length-2].field&&b.splice(b.length-2,1),"fitscore"===c[c.length-2].field&&c.splice(c.length-2,1)),u.$isEmptyCriteria(k.activeCriteria)?(za(),k.latestSearchId=_.uniqueId()):xa();var d=_.where(n.textTermRadios,{value:k.activeCriteria.textTermsApplication})[0];d&&(k.searchTypeInput=d.label,k.activeCriteria.textTermsApplication=d.value)},k.$watch(function(){return k.searchResults[k.currentResultsView].api&&k.searchResults[k.currentResultsView].api.grid.isScrollingHorizontally},function(){j.$broadcast("updatePopoverHorizontal")}),k.$watch("activeCriteria",function(a,b){if(ia)return void(ia=!1);var c,d=angular.copy(a),e=angular.copy(b);delete d.seniorityLevelGroupIds,delete e.seniorityLevelGroupIds,angular.equals(d,e)||(pa=!0,l.clearSelection(k.currentResultsView),U(),a.geo&&_.isString(a.geo.postalCodes)&&(a.geo.postalCodes=_.compact(a.geo.postalCodes.split(/,| |\n/)),a.postalCodes=a.geo.postalCodes,a.postalCodes=a.geo.postalCodes),u.$isEmptyCriteria(a)?(za(),k.latestSearchId=_.uniqueId()):a.includeOutOfScopeResults===b.includeOutOfScopeResults?xa():(c=k.currentResultsView.toUpperCase(),k.$eval("$singleSearch")(u.transformActiveCriteriaToSearchCriteriaModel(k.activeCriteria),ma,k.currentResultsView,c)))},!0),k.resultsText="Employee",k.latestSearchId=null,k.$singleSearch=function(a,c,e,f){if(_.isUndefined(a)||_.isUndefined(e))throw new Error("Missing Parameter from search - Please check your variables");_.isUndefined(f)&&(f=E.getSearchPluralName(e));var g,h=!_.isUndefined(c),m=E.getSingularListName(k.currentResultsView),o=e+"Count",q=e+"Text",r={intel:"Scoops",companies:"Companies",persons:"Employees"};k.resultsText=E.getTypeName(k.currentResultsView),k.spinner=!0,k.activeCriteria.fitScoreIncluded&&k.isResearcherVerifiedView&&j.$broadcast("event:DealPredictPerforming",{isDealPredictPerforming:!0}),h&&null!==c.page||(k.searchResults[e].paginationCurrentPage=1,ga=!0);var s=_.uniqueId();k.latestSearchId=s,P();var t=JSON.parse(JSON.stringify(k.activeCriteria)),v=E.getSearchName(k.currentResultsView);a=u.updateSearchModelFromActiveCriteria(a,t);var w=F.updateCriteriaToSearchFromSearchGridFilters(a,k.currentResultsView,k.$$searchGridFilters[k.currentResultsView],!0),x="get"+v+"SearchCounts",y="get"+v+"SearchResults";$=_.cloneDeep(w);var z=function(a,b){var c=_.assign(a.data,{searchCriteriaScoped:b._page.totalElements});b._page.totalElements>a.data.totalAccessable&&(delete j.Session.accessScopeCounts[k.currentResultsView],c.totalAccessable=b._page.totalElements),k.searchResultsA[o]=c,V(e,f)},A=function(c){X&&!Y&&1===c._page.totalElements&&window.location.replace("#/company/"+c.companyList[0].id),k.shouldTrackSearch&&(k.shouldTrackSearch=!1,u.trackSearchAction(c._page.totalElements,E.getSingularName(e))),_.isEmpty(c.companyList)||(j.hierarchyInResults=!c.companyList.every(function(a){return!a.relationshipTypeName}));var h=c._page.totalElements;return b.enabled(!1),j.Session.account.havingUserLeadModelEnabled&&k.activeCriteria.fitScoreIncluded&&("companies"===e||"persons"===e)&&_.each(c[m],function(a){a.fitscore%1&&(a.triggerFound=!0),a.fitscore=u.numToArraySize(a.fitscore||0),"Companies"===f&&(a.fitscore.useCompanyArr=!0)}),k.searchResults[e].data=c[m],"intel"===e&&(k.searchResults[e].rowHeight=124),k.searchResults[e].totalItems=h,k.totalItems=h,k.searchResultsA[q]=1!==c[m].length?n.textCountDefs[e]:n.textCountDefsSingle[e],u.setResultsCount({tab:k.currentResultsView,count:h}),qa&&p.cancel(qa),ha&&(qa=p(function(){ha=!1,u.saveRecentSearch(a,d("number")(_.has(k.searchResultsA[o],"searchCriteriaScoped")?k.searchResultsA[o].searchCriteriaScoped:0)+" "+r[e])},5e3)),c&&(g=c[m]),l.setData(e,q,k.searchResultsA[q][0],null,k.searchResults[e],g,k.searchResultsA[o]),c};i.all({counts:u[x](w),results:u[y](a,c,k.$$searchGridFilters[e])}).then(function(a){k.searchCriteriaByType[k.currentResultsView]=angular.copy(k.activeCriteria),(s===k.latestSearchId||k.activeCriteria.isTier2PersonSearchFromCompanyPage)&&a.results&&(A(a.results),z(a.counts,a.results))}).catch(function(){l.setData(e,q,k.searchResultsA[q][0],null,k.searchResults[e],void 0,k.searchResultsA[o])}).finally(function(){k.spinner=!1,k.activeCriteria.fitScoreIncluded&&k.isResearcherVerifiedView&&j.$broadcast("event:DealPredictPerforming",{isDealPredictPerforming:!1}),window.isIE9||b.enabled(!0),pa=!1,ga=!1,ja=!1,ka&&(M(),ka=!1)}),j.$broadcast("hidePopovers")},k.$$launch=function(a,b){ca=!1;var c;return c="location"===a?D.open(m[a+"Criteria"](k.activeCriteria,k.geography,L,b)):"keyword"===a?D.open(m[a+"Criteria"](k.activeCriteria,L,b)):"fitScore"===a?D.open(m[a+"Criteria"](k.activeCriteria,fa,k.tierTwo)):D.open(m[a+"Criteria"](k.activeCriteria,fa,L,b)),e.track("Search","Criteria","Opened: "+a),c.opened.then(function(){k.enableSpinnerBG=!1}),c.result.finally(function(){k.enableSpinnerBG=!0,e.track("Search","Criteria","Closed: "+a)}),c};var Ga=function(){var a=j.Session.account.havingUserLeadModelEnabled;if(a){var b=k.searchResults.persons.columnDefs,c=k.searchResults.companies.columnDefs;if(k.activeCriteria.fitScoreIncluded){k.searchResults.persons.api&&k.searchResults.persons.api.grid&&Aa(k.searchResults.persons.api.grid.columns),k.searchResults.companies.api&&k.searchResults.companies.api.grid&&Aa(k.searchResults.companies.api.grid.columns),k.searchResults.intel.api&&k.searchResults.intel.api.grid&&Aa(k.searchResults.intel.api.grid.columns),k.searchResults.tierTwoPersons.api&&k.searchResults.tierTwoPersons.api.grid&&Aa(k.searchResults.tierTwoPersons.api.grid.columns),k.searchResults.tierTwoCompanies.api&&k.searchResults.tierTwoCompanies.api.grid&&Aa(k.searchResults.tierTwoCompanies.api.grid.columns);var d=g.fitScoreCol();ma.sortField=d.field,ma.sortOrder=d.sort.direction,_.find(b,{field:"fitscore"})||b.splice(b.length-1,0,d),_.find(c,{field:"fitscore"})||c.splice(c.length-1,0,d)}else _.find(b,{field:"fitscore"})&&b.splice(b.length-2,1),_.find(c,{field:"fitscore"})&&c.splice(c.length-2,1),"fitscore"===ma.sortField&&(ma.sortField=null,ma.sortOrder=null)}else k.activeCriteria.fitScoreIncluded=!1};if(k.$$validateHasFitModel=function(){var a=j.Session.account.havingUserLeadModelEnabled;a?(k.activeCriteria.fitScoreIncluded=!k.activeCriteria.fitScoreIncluded,Ga()):k.$eval("$$launch")("fitScore")},k.toggleShowAll=function(){k.activeCriteria.includeOutOfScopeResults=!k.activeCriteria.includeOutOfScopeResults,window.localStorage&&(window.localStorage.includeOutOfScopeResults=k.activeCriteria.includeOutOfScopeResults.toString())},k.$on("listMatchNotification",function(a,b){j.listMatchNotifications=z.hasUnviewedListMatchNotification(b,!1)}),k.$on("viewEntitiesInAdvancedSearchOrOppAlert",function(a,b){b.listMatchResultIds.ids&&b.listMatchResultIds.ids.length&&Q(b.listMatchResultIds,"id",k.swapResultsView)}),C.checkNotifications(),ra(),window.localStorage&&"true"===window.localStorage.includeOutOfScopeResults&&(k.activeCriteria.includeOutOfScopeResults=!0),null!==ba.intel?(l.setEmpty(),_.has(k.searchResults.intel,"api")&&k.searchResults.intel.api.core.clearAllFilters(),k.activeCriteria=angular.copy(fa),k.searchResultsA=l.baseA(),k.activeCriteria.textSearchString="",p(function(){k.activeCriteria.intelCategoryIds=[ba.intel]},150),k.spinner=!0,k.currentResultsView="intel"):null!==ba.savedSearchId?u.getThisSearch(ba.savedSearchId).then(function(a){k.$eval("doApplySavedSearch")(a)}):null!==ba.tech?(l.setEmpty(),k.activeCriteria=angular.copy(fa),k.searchResultsA=l.baseA()):null!=ba.listMatchResultIds&&null!=ba.listMatchResultIds.ids&&Q(ba.listMatchResultIds,"id",R),a){var Ha=_.where(n.textTermRadios,{value:ba.textTermsApplication})[0];k.searchTypeInput=Ha.label,k.activeCriteria.textTermsApplication=Ha.value,k.currentResultsView=Ha.value.toLowerCase(),k.activeCriteria.textSearchString=ba.textSearchString,p(ta,150)}_.isEqual(k.activeCriteria,Fa)||u.$isEmptyCriteria(k.activeCriteria)||p(function(){var a=k.currentResultsView;ma=E.searchGridParams(k.searchResults[k.currentResultsView].paginationCurrentPage-1,ma.size,ma.sortField),k.$singleSearch(u.transformActiveCriteriaToSearchCriteriaModel(k.activeCriteria),ma,a,_.capitalize(k.currentResultsView))},50).then(Ga),r.$formats().then(function(a){a.length&&(k.canExport=!0)}),r.maxPersonExportRowCount().then(function(a){k.personExportRowLimit=a.data}),r.maxCompanyExportRowCount().then(function(a){k.companyExportRowLimit=a.data}),r.maxScoopExportRowCount().then(function(a){k.scoopExportRowLimit=a.data}),u.setResultsCount({tab:k.currentResultsView,count:0})}]),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("perform_search",{url:"/search?textTermsApplication&textSearchString&status&url&switchEmployee",templateUrl:"app/views/search/search.html",controller:"SearchCtrl",params:{savedSearchId:null,view:null,intel:null,tech:null,listMatchResultIds:null,company:null},resolve:{searchCriteriaViewResource:["SearchService",function(a){return a.getSearchCriteriaResource().then(function(a){return a})}],$$GCE:["$stateParams",function(a){var b=((a.textTermsApplication||"").toUpperCase().match(/(PERSONS|COMPANIES|ABM)/)||[]).length>0,c=a.textSearchString||"";return b&&!!c}],$title:function(){return"Search"}}})}]),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(a,b){var c=new RegExp(".{1,"+b+"}","g"),d=[];return _.forEach(a,function(a){d=d.concat(a.match(c))}),d}function t(a){return a&&!a.match(/^[a-zA-Z]+:\/\//)&&(a="http://"+a),a}var u=" UTC-8",v=100,w="Technology Generated",x="tierTwoCompanies",y="tierTwoPersons",z={tierTwoCompany:"TIER_2_COMPANY",tierTwoPerson:"TIER_2_PERSON"},A=!1,B=b.Session.navigation.$href("viewMyLists"),C=b.Session.navigation.$href("recentSearches"),D=b.Session.navigation.$href("fitSettings"),E=1e6,F=null,G=null,H={},I={},J=function(a){return a.displayName.replace(" ","").toLowerCase()},K=function(a,b,c){var f=a.$href(b),g={};return g.params=c||{},d.get(f,g).then(function(a){var b=null,c=e.$getD(a.data);return c&&(b=c.sort(function(a,b){return a.company&&b.company&&(a=a.company,b=b.company),a=J(a),b=J(b),a>b?1:a<b?-1:0})),b})},L=function(a,b){var c=a.$href(b),f={};return f.params={},d.get(c,f).then(function(a){return e.$getD(a.data)})},M=function(a){return a&&a.length&&_.isObject(a[0])?_.pluck(a,"id"):a},N=function(a){var b=n.findFeatureFlag(null,"triggerstoscoops");return _.each(a,function(a){if(a.article=o.parseArticle(null,a,b,!0,0,""),b)a.link=t(a.link);else switch(a.typeId){case 0:a.typeId="None";break;case 1:a.typeId="Personnel";break;case 2:a.typeId="Project";break;case 3:a.typeId="General Business";break;default:a.typeId="None"}a.article=m.trustAsHtml(a.article)})},O=function(a,b){return a.fitScoreIncluded&&(_.has(b,"sortField")?b.sortField=b.sortField||"fitscore":b.sortField="fitscore","fitscore"===b.sortField&&_.has(b,"sortOrder")&&(b.sortOrder=b.sortOrder||"desc")),b},P=b.Session.navigation.$href("savedSearches"),Q=this;this.getSearchCriteriaResource=function(){return b.Session.navigation.$get("perform_search").then(function(a){return b.Session.pg=a.$href("companyMatch"),c.all([a.$get("gridFilters"),a.$get("tierTwoGridFilters")]).then(function(a){var b=a[0]||{},c=a[1]||{};G=q.getGridFilterResourceKeys(b,c)}),F=a,a.$get("criteria").then(function(a){return a.yearFounded.minValue=null,a.yearFounded.maxValue=null,a})})},this.$one=function(a){var b=e.$self(a);return d.get(b).then(function(a){return a.data})},this.trackSearchAction=function(a,b){var c=z[b],e=c?c:b,f={entityType:e.toUpperCase(),entityCount:a};return d.post("api/rest/usage/log/find",f)},this.trackSearchEventAction=function(a){return d.post("api/rest/usage/log/event",{eventType:a})},this.trackViewAction=function(a){return d.post("api/rest/usage/log/view",a)},this.getCompanySearchResults=function(a,b,c){var f=O(a,b||{page:0,size:50}),g=F.$href("company");return this.isFiltered(c)?this.filterGrid(a,c,"companies",f):(delete a.geo,d.post(g,a,{params:f}).then(function(a){return{companyList:e.$getD(a.data),_page:a.data.page||{totalElements:0,page:0,size:0}}}))},this.getTierTwoCompanySearchResults=function(a,b,c){var f=b||{page:0,size:50},g=F.$href("companyTierTwo");return this.isFiltered(c)?this.filterGrid(a,c,x,f):(delete a.geo,d.post(g,a,{params:f}).then(function(a){return{tierTwoCompanyList:e.$getD(a.data),_page:a.data.page||{totalElements:0,page:0,size:0}}}))},this.getCompanySearchCounts=function(a){var b=F.$href("companyCounts");return delete a.geo,d.post(b,a)},this.getTierTwoCompanySearchCounts=function(a){return _.has(b.Session.accessScopeCounts,x)?c(function(a){a(b.Session.accessScopeCounts.tierTwoCompanies)}):R(a,x,!0)},this.getTierTwoCompanyPreviewRecordCounts=function(a){return R(a,x,!1)};var R=function(a,c,e){var f="";return c===x?f=F.$href("companyTierTwoCounts"):c===y&&(f=F.$href("personTierTwoCounts")),""!==f?(delete a.geo,d.post(f,a).then(function(a){return e&&(b.Session.accessScopeCounts[c]=a),a})):0};this.getPersonSearchResults=function(a,b,f){var g=c.defer(),h=O(a,b||{page:0,size:50}),i=F.$href("person");return this.isFiltered(f)?this.filterGrid(a,f,"persons",h):(delete a.geo,A?(A=!1,g.resolve()):(A=!0,g.resolve(d.post(i,a,{params:h}).then(function(a){return A=!1,{personList:e.$getD(a.data),_page:a.data.page||{totalElements:0,page:0,size:0}}}).catch(function(a){A=!1,g.resolve()}))),g.promise)},this.getTierTwoPersonSearchResults=function(a,b,f){var g=c.defer(),h=b||{page:0,size:50},i=F.$href("personTierTwo");return a.includeOutOfScopeResults=!1,this.isFiltered(f)?this.filterGrid(a,f,y,h):(delete a.geo,A?g.resolve():(A=!0,g.resolve(d.post(i,a,{params:h}).then(function(a){return A=!1,{tierTwoPersonList:e.$getD(a.data),_page:a.data.page||{totalElements:0,page:0,size:0}}}))),g.promise)},this.getPersonSearchCounts=function(a){var b=F.$href("personCounts");return delete a.geo,d.post(b,a)},this.getTierTwoPersonSearchCounts=function(a){return _.has(b.Session.accessScopeCounts,y)?c(function(a){a(b.Session.accessScopeCounts.tierTwoPersons)}):R(a,y,!0)},this.getTierTwoPersonPreviewRecordCounts=function(a){return R(a,y,!1)},this.getIntelSearchResults=function(a,b,c){var f=b||{page:0,size:50},g=F.$href("intel");return this.isFiltered(c)?this.filterGrid(a,c,"intel",f):(delete a.geo,d.post(g,a,{params:f}).then(function(a){return{intelReportList:N(e.$getD(a.data)),_page:a.data.page||{totalElements:0,page:0,size:0}}}))},this.getIntelSearchCounts=function(a){var b=F.$href("intelCounts");return delete a.geo,d.post(b,a)},this.tranformPropArrToVal=function(a,b,c){var d=a[b];_.isArray(d)&&(d=_.isEmpty(d)?"":d[0],""!==d||_.isUndefined(c)||("minmax"===c?d={minValue:0,maxValue:0}:"object"===c&&(d={})),a[b]=d),(_.has(d,"postalCodeCenter")||_.has(d,"radialDistance"))&&(Q.tranformPropArrToVal(d,"postalCodeCenter"),Q.tranformPropArrToVal(d,"radialDistance"))},this.clearSearchGridFiltersFromSearchCriteria=function(a,b,c){return I={},q.clearSearchGridFiltersFromSearchCriteria(a,b,c)},this.transformActiveCriteriaToSearchCriteriaModel=function(a,b){var c=JSON.parse(JSON.stringify(a));b&&(c.textTermsApplication=b),_.each(c,function(a,b){I[b]=_.endsWith(b,"Ids")?M(a):a});var d={},e={};"COMPANY_ADDRESS"===c.locationsApplication?(d=I.companyLocation,e=I.personLocation):"PERSON_ADDRESS"===c.locationsApplication&&(d=I.personLocation,e=I.companyLocation);for(var f=angular.copy(I.technologyProductIds),g=0,h=I.technologyProductIds,k=j.tech(),l=h.length;g<l;++g)k[h[g]]&&(f=f.concat(k[h[g]]));I.technologyProductIds=_.uniq(f),c.geo&&(d.continentIds=M(c.geo.continents),d.countryIds=M(c.geo.countries),d.division1Ids=M(c.geo.states),d.marketingRegionIds=M(c.geo.metro),d.areaCodeIds=M(c.geo.areas),d.countyIds=M(c.geo.counties),d.postalCodes=c.geo.postalCodes,d.radialDistance=c.geo.radialDistance,d.postalCodeCenter=c.geo.postalCodeCenter,d.postalCodeApplyToUSOnly=c.geo.postalCodeApplyToUSOnly,e.empty=_.isEmpty(d.continentIds)&&_.isEmpty(d.countryIds)&&_.isEmpty(d.division1Ids)&&_.isEmpty(d.marketingRegionIds)&&_.isEmpty(d.areaCodeIds)&&_.isEmpty(d.countyIds)&&(_.isEmpty(d.radialDistance)||_.isEmpty(d.postalCodeCenter)),e.continentIds=[],e.countryIds=[],e.division1Ids=[],e.marketingRegionIds=[],e.areaCodeIds=[],e.countyIds=[],e.radialDistance=null,e.postalCodeCenter=null,e.postalCodeApplyToUSOnly=null,e.empty=!0,e.postalCodes=[]),I.dunsIds=c.dunsIds,I.numEmployees=c.numEmployees,I.employeeGrowth=c.employeeGrowth,I.revenueGrowth=c.revenueGrowth,I.numLocations=c.numLocations,I.numHospitalBeds=c.numHospitalBeds,I.revenue={minValue:_.isString(c.revenue.minValue)?Number(c.revenue.minValue.replace(",","")*E):c.revenue.minValue*E,maxValue:_.isString(c.revenue.maxValue)?Number(c.revenue.maxValue.replace(",","")*E):c.revenue.maxValue*E},_.isUndefined(c.fundingDate)||(c.fundingDate={minValue:i("startDateIsValid")(c.fundingDate.minValue)?c.fundingDate.minValue:null,maxValue:i("endDateIsValid")(c.fundingDate.minValue,c.fundingDate.maxValue)?c.fundingDate.maxValue:null},c.fundingDate.minValue?I.fundingDate.minValue=new Date(c.fundingDate.minValue+u):I.fundingDate.minValue=null,c.fundingDate.maxValue?I.fundingDate.maxValue=new Date(c.fundingDate.maxValue+u):I.fundingDate.maxValue=null),I.fundingAmount={minValue:_.isString(c.fundingAmount.minValue)?Number(c.fundingAmount.minValue.replace(",","")*E):c.fundingAmount.minValue*E,maxValue:_.isString(c.fundingAmount.maxValue)?Number(c.fundingAmount.maxValue.replace(",","")*E):c.fundingAmount.maxValue*E},I.departmentEmployeeRangeMap=c.departmentEmployeeRangeMap,I.departmentBudgetRangeMap=c.departmentBudgetRangeMap,I.reportsDirectlyToCLevel=c.reportsDirectlyToCLevel,I.includeOnlySuperset=c.includeOnlySuperset,I.havingDirectPhone=c.havingDirectPhone,I.havingEmail=c.havingEmail,I.havingMobilePhone=c.havingMobilePhone,I.havingPersonalEmail=c.havingPersonalEmail,I.havingOfficePhone=c.havingOfficePhone,I.havingAnyEmail=c.havingAnyEmail,I.emailAddresses=c.emailAddresses,Q.tranformPropArrToVal(I,"companyLocation"),Q.tranformPropArrToVal(I,"personLocation"),Q.tranformPropArrToVal(I,"reportsDirectlyToCLevel"),Q.tranformPropArrToVal(I,"includeOnlySuperset"),Q.tranformPropArrToVal(I,"havingDirectPhone"),Q.tranformPropArrToVal(I,"havingEmail"),Q.tranformPropArrToVal(I,"havingMobilePhone"),Q.tranformPropArrToVal(I,"havingPersonalEmail"),Q.tranformPropArrToVal(I,"fortuneRank","minmax"),Q.tranformPropArrToVal(I,"departments","object"),Q.tranformPropArrToVal(I,"havingOfficePhone"),Q.tranformPropArrToVal(I,"havingAnyEmail"),_.isUndefined(c.intelPublishDate)||(c.intelPublishDate={minValue:p.isValidDate(c.intelPublishDate.minValue)?c.intelPublishDate.minValue:null,maxValue:p.isValidDate(c.intelPublishDate.maxValue)?c.intelPublishDate.maxValue:null},c.intelPublishDate.minValue?I.intelPublishDate.minValue=new Date(c.intelPublishDate.minValue+u):I.intelPublishDate.minValue=null,c.intelPublishDate.maxValue?I.intelPublishDate.maxValue=new Date(c.intelPublishDate.maxValue+u):I.intelPublishDate.maxValue=null);var m=n.findFeatureFlag(null,"triggerstoscoops");return m&&(_.isUndefined(c.intelUpdatedDate)||(c.intelUpdatedDate={minValue:p.isValidDate(c.intelUpdatedDate.minValue)?c.intelUpdatedDate.minValue:null,maxValue:p.isValidDate(c.intelUpdatedDate.maxValue)?c.intelUpdatedDate.maxValue:null},c.intelUpdatedDate.minValue?I.intelUpdatedDate.minValue=new Date(c.intelUpdatedDate.minValue+u):I.intelUpdatedDate.minValue=null,c.intelUpdatedDate.maxValue?I.intelUpdatedDate.maxValue=new Date(c.intelUpdatedDate.maxValue+u):I.intelUpdatedDate.maxValue=null)),_.isUndefined(c.employeeStartDate)||(c.employeeStartDate.minValue&&(I.employeeStartDate.minValue=new Date(c.employeeStartDate.minValue)),c.employeeStartDate.maxValue&&(I.employeeStartDate.maxValue=new Date(c.employeeStartDate.maxValue))),I},this.getCompanyList=function(a,b){return b=encodeURI(b),b.length>0?K(a,"companies",{startsWith:b}):K(a,"companies",{startsWith:""})},this.getInvestorsList=function(a,b){return b=encodeURI(b),b.length>0?K(a,"investors",{startsWith:b}):K(a,"investors",{startsWith:""})},this.getTechnologyList=function(a,b,c){return b=_.isUndefined(b)?"":encodeURI(b),d.get(a.$href("technologies-bycategoryidsandpartialname"),{params:{partialname:b,ids:_.pluck(c,"id").join()}}).then(function(a){var b=e.$getD(a.data);return{data:_.size(b)>0?b:[],idMap:a.data.idMap}})},this.getDepartmentList=function(a){return K(a,"departments")},this.getJobFunctionList=function(a){return K(a,"job-functions")},this.getOwnershipTypeList=function(a){return K(a,"ownership-types")},this.getSeniorityLevelList=function(a){return K(a,"seniority-levels")},this.getSeniorityLevelGroupList=function(a){return K(a,"seniority-level-groups")},this.getTechnologyGroupList=function(a){return K(a,"technology-groups")},this.getTechnologyCategoriesList=function(a){return K(a,"technology-categories")},this.getIndustryList=function(a){return K(a,"industries")},this.getBusinessModelTypeList=function(a){return K(a,"business-model-types")},this.getFundingTypeList=function(a){return L(a,"funding-types")},this.getIntelCategoryList=function(a){return K(a,"intelCategories")},this.getIntelLegacyCategoryIds=function(a){if(n.findFeatureFlag(null,"triggerstoscoops")){var b=a.$href("intelLegacyCategoryIds");return d.get(b).then(function(a){return a.data})}return[]},this.getIntelReportTypes=function(a){return n.findFeatureFlag(null,"triggerstoscoops")?L(a,"intelReportTypes"):K(a,"intelReportTypes")},this.saveThisSearch=function(a){return d.post(P,a).then(function(a){return e.$getD(a.data)},function(a){return a})},this.overWriteThisSearch=function(a){return d.put(P,a).then(function(a){return e.$getD(a.data)},function(a){return a})},this.getSavedSearches=function(){return d.get(P).then(function(a){return e.$getD(a.data)||[]})},this.getThisSearch=function(a){return d.get(P+"/"+a).then(function(a){return a.data},function(){return[]})},this.saveRecentSearch=function(a,b){var c={};c.label=b,c.searchCriteria=a,d.post(C,c)},this.getRecentSearches=function(){return d.get(C).then(function(a){var b=e.$getD(a.data);return b?_.sortBy(b,"updateTime"):[]},function(){return[]})},this.getRecentSearchSingle=function(a){return d.get(C+"/"+a).then(function(a){return a.data},function(){return[]})},this.setGeography=function(a){for(var b=1,c=8;b<c;++b)6!==b&&(H[b]=1===b?K(a,"presence-regions",{typeId:b}):K(a,"presence-regions",{typeId:b}).then(function(a){return a}))},this.getGeography=function(){return c.all(H).then(function(a){return a})},this.$saveSubscription=function(a,b){return d.post(a,b).then(function(a){return e.$getD(a.data)},function(a){return a})},this.$createSubscription=function(b,c,d,e){var f={id:0,name:d.subscriptionName,sourceListType:d.sourceListType,sourceListId:c,scheduleType:d.frequencyOption.id,subscriptionType:d.typeOption.id};Q.$saveSubscription(b,f).then(function(b){if(angular.isDefined(b.status)&&b.status>=300){if(400===b.status&&b.data.errors){var c="";_.each(b.data.errors,function(b){c=a.getErrorMessage(b.code),_.includes(d.subscriptionNameErrors,c)?_.pullAt(d.subscriptionNameErrors,_.indexOf(d.subscriptionNameErrors,c)):d.subscriptionNameErrors.push(c)})}return 422===b.status?d.subscriptionErrorMessage="There is already a List with this name. Please use a unique name.":d.subscriptionErrorMessage="Something went wrong with this request. Please try again.",d.isSaving=!1,!1}e.close(),g.create("success","Search and Subscription Successfully saved","flash")})},this.$subscriptionSuppportData=function(){return d.get(B).then(function(a){return d.get(e.$fetchLink(a.data,"subscriptionLists")+"/supportdata").then(function(a){return a.data})})},this.geoFilter=function(a,b,c){},this.getMapStyle=f.getStyle(),this.$getBulkMatchCategories=h.bulkMatchCategories,this.$postBulkMatch=function(a,c){return d.post(b.Session.pg||"api/rest/companymatches",a,{params:{matchPropertyType:c}}).then(function(a){return _.omit(a.data,["_links"])},function(a){return a})},this.$getUpgradeMessage=function(){return d.get(b.Session.account.$href("upsellMessage")).then(function(a){return a.data})},this.$isEmptyCriteria=function(a){var b,c=Object.getOwnPropertyNames(a),d=["fitScoreIncluded","includeOnlySuperset","havingDirectPhone","havingEmail","havingMobilePhone","havingPersonalEmail","havingOfficePhone","havingAnyEmail","reportsDirectlyToCLevel","useSecondaryIndustry","intelIncludeOnlyUpdated"],e=["companyLocation","companyPresenceLocation","companyRecordsApplication","dateRange","includeVacant","locationsApplication","personLocation","personRecordsApplication","previousLastDay","seniorityLevelGroupIds","globalAccessAttributes","technologyCategoryIds","textTerms","textTermsApplication","technologiesApplication","useSecondaryIndustry","postalCodeApplyToUSOnly","withinTheLastNumOfDays"],f=!0,g=["companyRecordsDate","employeeGrowth","fortuneRank","globalRank","intelPublishDate","yearFounded","numEmployees","numLocations","numHospitalBeds","opportunityEndDate","personRecordsDate","revenue","revenueGrowth","employeeStartDate","opportunityTopicRank","score","confidenceScore","intelUpdatedDate","fundingDate","fundingAmount"],h=!_.isUndefined(_.find(a.geo,function(a){if(a)return a.length>0})),j={radialDistance:"postalCodeCenter",postalCodeCenter:"radialDistance",keywordTermsAplication:"textSearchString",textSearchString:"keywordTermsAplication"};if(h||e.push("geo"),!_.isEmpty(a.intelPublishDate.minValue)||!_.isEmpty(a.intelPublishDate.maxValue)){if(!i("startDateIsValid")(a.intelPublishDate.minValue))return!0;if(!i("endDateIsValid")(a.intelPublishDate.minValue,a.intelPublishDate.maxValue))return!0}if(a.intelUpdatedDate&&(!_.isEmpty(a.intelUpdatedDate.minValue)||!_.isEmpty(a.intelUpdatedDate.maxValue))){if(!i("startDateIsValid")(a.intelUpdatedDate.minValue))return!0;if(!i("endDateIsValid")(a.intelUpdatedDate.minValue,a.intelUpdatedDate.maxValue))return!0}if(!_.isEmpty(a.employeeStartDate.minValue)||!_.isEmpty(a.employeeStartDate.maxValue)){if(!i("startDateIsValid")(a.employeeStartDate.minValue))return!0;if(!i("endDateIsValid")(a.employeeStartDate.minValue,a.employeeStartDate.maxValue))return!0}b=_.filter(c,function(a){return e.indexOf(a)<0}),a.geo&&(a.geo.postalCodeCenter||a.geo.radialDistance)&&(f=!1);for(var k=0,l=b.length;k<l;++k){var m=b[k],n=a[m];if(_.includes(g,m))(n.minValue||n.maxValue)&&(f=!1);else if(_.contains(d,m)&&n)f=!1;else if(m in j)_.isEmpty(n)||_.isEmpty(a[j[m]])||(f=!1);else if("departments"===m)for(var o=1;o<=9;o++){var p=a.departments[o];if(p){var q=p.budget,r=p.numEmployees;if(q.minValue>0||q.maxValue>0||r.minValue>0||r.maxValue>0){f=!1;break}}}else _.isEmpty(n)||(f=!1);if(!f)break}return f},this.convertSavedSearch=function(a){var b=a.savedSearch.searchCriteria,c=n.findFeatureFlag(null,"triggerstoscoops"),d=n.findFeatureFlag(null,"recruiters_new_dp");b.companyIds=a.companies,b.departmentIds=a.departments,b.intelDepartmentIds=a.intelDepartments||[],b.seniorityLevelIds=a.seniorityLevels,b.seniorityLevelGroupIds=a.seniorityLevelGroupIds,b.industryIds=a.industries,b.jobFunctionIds=a.jobFunctions,b.ownershipTypeIds=a.ownershipTypes,b.businessModelIds=a.businessModels,b.technologyProductIds=a.technologyProducts,b.technologyCategoryIds=a.technologyCategories,b.intelTypeIds=a.intelTypes,b.intelCategoryIds=a.intelCategories,b.topicIds=a.oppalertTopics,b.fundingTypeIds=a.fundingTypes,b.investorIds=a.investors,b.fundingAmount={minValue:b.fundingAmount.minValue/E,maxValue:b.fundingAmount.maxValue/E},0!==b.fortuneRank.minValue&&(b.fortuneRank.minValue=1),b.personIds=a.persons,d||(b.havingMobilePhone=!1,b.havingPersonalEmail=!1,b.havingOfficePhone=!1,b.havingAnyEmail=!1),b.revenue={minValue:b.revenue.minValue/E,maxValue:b.revenue.maxValue/E},c?(b.intelPublishDate={minValue:i("date")(b.intelPublishDate.minValue,"MM/dd/yyyy")||null,maxValue:i("date")(b.intelPublishDate.maxValue,"MM/dd/yyyy")||null
},b.intelUpdatedDate={minValue:i("date")(b.intelUpdatedDate.minValue,"MM/dd/yyyy")||null,maxValue:i("date")(b.intelUpdatedDate.maxValue,"MM/dd/yyyy")||null}):b.intelPublishDate={minValue:i("date")(b.intelPublishDate.minValue,"MM/dd/yyyy")||null,maxValue:i("date")(b.intelPublishDate.maxValue,"MM/dd/yyyy")||null},b.employeeStartDate={minValue:i("date")(b.employeeStartDate.minValue,"MM/dd/yyyy")||null,maxValue:i("date")(b.employeeStartDate.maxValue,"MM/dd/yyyy")||null},b.opportunityEndDate={minValue:i("date")(b.opportunityEndDate.minValue,"MM/dd/yyyy")||null,maxValue:i("date")(b.opportunityEndDate.maxValue,"MM/dd/yyyy")||null},b.fundingDate={minValue:i("date")(b.fundingDate.minValue,"MM/dd/yyyy")||null,maxValue:i("date")(b.fundingDate.maxValue,"MM/dd/yyyy")||null};var e={continents:a.continents,countries:a.countries,states:a.division1s,metro:a.marketingRegions,areas:a.areaCodes,counties:a.counties,postalCodes:a.postalCodes,postalCodeApplyToUSOnly:a.postalCodeApplyToUSOnly,postalCodeCenter:a.postalCodeCenter,radialDistance:a.radialDistance},f=b.companyLocation.empty?b.personLocation.empty?null:b.personLocation:b.companyLocation;return f?(f.radialDistance&&f.postalCodeCenter&&(e.radialDistance=f.radialDistance,e.postalCodeCenter=f.postalCodeCenter),b.locationsApplication=f.locationsApplication,f.postalCodes&&(e.postalCodes=f.postalCodes),(e.radialDistance&&e.postalCodeCenter||!_.isEmpty(e.postalCodes))&&(e.postalCodeApplyToUSOnly=f.postalCodeApplyToUSOnly)):b.locationsApplication="COMPANY_ADDRESS",delete b.continentIds,delete b.countryIds,delete b.division1Ids,delete b.marketingRegionIds,delete b.areaCodeIds,delete b.countyIds,b.geo=e,b},this.numToArraySize=function(a){var b,c,d,e=!1,f=!1;switch(a=a.toFixed(2),b=parseInt(a[0],10),c=parseInt(a[2],10),d=parseInt(a[3],10),_.isNaN(b)&&(b=0),_.isNaN(c)&&(c=0),_.isNaN(d)&&(d=0),d){case 1:f=!0;break;case 2:e=!0;break;case 3:f=!0,e=!0}return{score:a,companyStars:b,companyStarsArr:new Array(b),personStars:c,personStarsArr:new Array(c),triggerFound:f,oppAlertFound:e}},this.$fitEnabled=!!D,this.filterGrid=function(a,b,c,f){f=f||{},b=angular.copy(b);for(var g={persons:"personGridFilterResource",companies:"companyGridFilterResource",intel:"intelGridFilterResource",tierTwoCompanies:"companyTierTwoGridFilterResource",tierTwoPersons:"personTierTwoGridFilterResource"},h={persons:"personFiltered",companies:"companyFiltered",intel:"intelFiltered",tierTwoCompanies:"companyTierTwoFiltered",tierTwoPersons:"personTierTwoFiltered"},i=F.$href(h[c])||"",j=G[g[c]]||"",k=Object.getOwnPropertyNames(b),l={gridFilterResource:{},searchCriteria:_.cloneDeep(a)},m={params:f},n={_page:{totalElements:0,page:0,size:0}},o="",p=0,r=k.length;p<r;++p)j[k[p]]=b[k[p]];switch("intel"===c?(j.typeId=this.convertIntelTypeId(j.typeId),j.publishDate=this.convertIntelPublishDateToTimestamp(j.publishDate,"MM/DD/YYYY")):"companies"===c||c===x?(j.numEmployees=""===j.numEmployees?{minValue:0,maxValue:0}:j.numEmployees,j.revenue=""===j.revenue?{minValue:0,maxValue:0}:q.parseRevenue(j.revenue)):"persons"===c?(j.linkedInUrl=""===j.linkedInUrl?"EITHER":j.linkedInUrl,j.twitterHandle=""===j.twitterHandle?"EITHER":j.twitterHandle):c===y&&(j.linkedInUrl=""===j.linkedInUrl?"EITHER":j.linkedInUrl),c){case"persons":o="person";break;case"companies":o="company";break;case x:o="tierTwoCompany";break;case y:o="tierTwoPerson";break;default:o="intelReport"}return n[o+"List"]=[],l.gridFilterResource[g[c]]=j,d.post(i,l,m).then(function(a){var b=e.$getD(a.data);return"intel"===c&&(b=N(b)),n[o+"List"]=b,n._page=a.data.page||n._page,n},function(a){return console.warn(a),n})},this.isFiltered=function(a){return!!a&&_.some(a,function(a){return!!a})},this.getResultsCounts=function(){return this.resultsCounts},this.setResultsCount=function(a){this.resultsCounts=a,b.$broadcast("results:getCounts",a)},this.convertIntelPublishDateToTimestamp=function(a,b){return""===a?{minValue:null,maxValue:null}:(moment(a.minValue,b).isValid()&&(a.minValue=new Date(a.minValue+u).getTime()),moment(a.maxValue,b).isValid()&&(a.maxValue=new Date(a.maxValue+u).getTime()),a)},this.convertIntelTypeId=function(a){return""===a?0:_.has(a,"id")?a.id:void 0},this.validateUSPostalCodes=function(a){if(_.isArray(a))for(var b=0;b<a.length;b++)if(a[b]&&(5!==a[b].length||isNaN(a[b])))return!1;return!0},this.standardizeMinMaxValue=function(a,b,c){var d=c?"minValue":"maxValue";return void 0===b?void 0!==a&&void 0!==a[d]?a[d]:0:void 0!==a&&void 0!==a[d]?c?b>a[d]?b:a[d]:b<a[d]&&b>0||0==a[d]?b:a[d]:b},this.standardizeArrayByDelimiter=function(a,b){var c=/,| |\n|;/,d=[];return _.isArray(a)&&_.forEach(a,function(a){d=d.concat(s(a.split(c),b))}),_.compact(d)},this.formatPostalCodesArray=function(a,b){for(var c=/,| |\n/,d=/,|\n/,e=b?c:d,f=a.split(e),g=0;g<f.length;g++)f[g]=f[g].trim();return f=_.uniq(_.compact(f))},this.makeSearchCriteriaNumberRangeLabel=function(a){var b=a.minValue||0;return b+=a.minValue>a.maxValue?"+":" - "+a.maxValue},this.getTechnologyCategoriesByProductIds=function(a,b){var c=a.$href("technologies-categoriesbyproductids");return d.get(c,{params:{techIds:_.pluck(b,"id").join()}}).then(function(a){return a.data})},this.getAllKeywordSearchType=function(){var a=n.findFeatureFlag(null,"triggerstoscoops"),b=[];return _.forOwn(a?h.keywordSearchTypesForScoop:h.keywordSearchTypes,function(a){_.forEach(a,function(a){b.push(a)})}),b},this.checkDuplicateSubscriptionName=function(a,b){return d.get(a,{params:{subscriptionName:b}}).then(function(a){return!1},function(a){return!0})},this.checkDuplicateSavedSearchName=function(a){return d.get(b.Session.navigation.$href("checkValidName"),{params:{name:a}}).then(function(a){return!1},function(a){return!0})},this.getSavedSearchSubscriptionBySourceListId=function(a){return d.get(b.Session.navigation.$href("getSavedSearchSubscriptionBySourceListId"),{params:{sourceListId:a}}).then(function(a){return a.data},function(a){return[]})},this.updateSearchModelFromActiveCriteria=function(a,b){var c=this.convertIntelPublishDateToTimestamp(b.intelPublishDate,"MM/DD/YYYY");return null!==a.intelPublishDate&&(null!==c.minValue&&(_.isNull(a.intelPublishDate.minValue)||a.intelPublishDate.minValue.valueOf()<c.minValue)&&(a.intelPublishDate.minValue=c.minValue),null!==c.maxValue&&(_.isNull(a.intelPublishDate.maxValue)||a.intelPublishDate.maxValue.valueOf()>c.maxValue)&&(a.intelPublishDate.maxValue=c.maxValue)),a},this.getSavedSearchNameCutOffByMaxlengthLimit=function(a){return _.isEmpty(a)||(a=i("limitTo")(a,v)),a},this.isTierTwo=function(a){return _.startsWith(a,w)},this.makePreviewCountedEntityDisplayName=function(a){return this.isTierTwo(a)&&(a=a.replace(w,"")),a.trim()},this.showCount=function(a,c){var d=a[c].showCount;return this.isTierTwo(a[c].displayName)&&(d=d&&b.Session.account.canAccessTierTwoData),d},this.transFundingDate=function(a){a.fundingDate={minValue:i("startDateIsValid")(a.fundingDate.minValue)?a.fundingDate.minValue:null,maxValue:i("endDateIsValid")(a.fundingDate.minValue,a.fundingDate.maxValue)?a.fundingDate.maxValue:null}},this.checkCanExport=function(){return r.checkCanExport().then(function(a){return"true"===a})}}angular.module("dorgEuiApp").service("SearchService",a),a.$inject=["dorgValidation","$rootScope","$q","$http","$embeddedUtils","maps","Flash","$SearchStaticFactory","$filter","$searchCache","ActiveCriteriaCountService","helperService","$sce","featureFlagService","intelArticleParserService","dateValidationService","searchFilterService","downloadExportService"],angular.module("dorgEuiApp").service("SearchService",a)}(),function(){"use strict";function a(a,b,c){function d(){return e(g.company.hqPhoneNumber)||e(g.company.primaryIndustryName)||null!=g.company.revenue&&g.company.revenue>0||null!=g.company.numEmployees&&g.company.numEmployees>0}function e(a){return null!=a&&""!==a.trim()}var f=1,g=this;g.company=a,g.headQuarters={location:{id:f,longitude:g.company.hqLongitude,latitude:g.company.hqLatitude}},g.$onInit=function(){g.isShowCompanyInfoSection=d();var a={entityType:"TIER_2_COMPANY",eventType:"TIER_2_COMPANY_VIEWED",tier2:!0,entityIdentifier:g.company.uuid,entityName:g.company.name};c.trackViewAction(a)},b.$formats().then(function(a){a.length&&(g.canExport=!0)})}a.$inject=["company","downloadExportService","SearchService"],angular.module("dorgEuiApp").controller("companyTierTwoController",a)}(),angular.module("dorgEuiApp").config(["$stateProvider","dorgConfig",function(a,b){a.state("view_company_tier_two",{url:"/company-t2/:uuid",templateProvider:["company","$http","$templateCache",function(a,c,d){var e="app/views/tier-two-data/company-tier-two/company-tier-two.html",f=function(a){return a.data};switch(a.status){case 418:case 409:case 404:return d.get(b["TPL_"+a.status])?d.get(b["TPL_"+a.status]):c.get(b["TPL_"+a.status]).then(f);default:return d.get(e)?d.get(e):c.get(e).then(f)}}],controllerProvider:["company",function(a){switch(a.status){case 418:case 409:return b["CTRL_"+a.status];case 404:return;default:return"companyTierTwoController as companyTierTwoVm"}}],resolve:{company:["$stateParams","CompanyTierTwoService",function(a,b){return b.getCompanyTierTwo(a.uuid)}],$title:["company",function(a){switch(a.status){case 418:case 409:case 404:return b["MSG_"+a.status];default:return a.name}}]}})}]),function(){function a(a){function b(b){return a.get(c+"/"+b).then(function(a){return a.data},function(a){return a})}var c="api/rest/tier2/companies";return{getCompanyTierTwo:b}}a.$inject=["$http"],angular.module("dorgEuiApp").service("CompanyTierTwoService",a)}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){k.isContactInfoAvailable=h(),k.isCompanyInfoAvailable=i();var a={entityType:"TIER_2_PERSON",eventType:"TIER_2_PERSON_VIEWED",tier2:!0,entityIdentifier:k.person.uuid,entityName:k.person.fullName};f.trackViewAction(a),e.$formats().then(function(a){a.length&&(k.canExport=!0)})}function h(){return b.isNotEmptyString(k.person.directDialNumber1)||b.isNotEmptyString(k.person.directDialNumber2)||b.isNotEmptyString(k.person.directDialNumber3)||b.isNotEmptyString(k.person.mobileTelNumber)||b.isNotEmptyString(k.person.officeTelNumber)||b.isNotEmptyString(k.person.department1Name)||b.isNotEmptyString(k.person.department2Name)||b.isNotEmptyString(k.person.department3Name)||b.isNotEmptyString(k.person.jobFunction1Name)||b.isNotEmptyString(k.person.jobFunction2Name)||b.isNotEmptyString(k.person.jobFunction3Name)||b.isNotEmptyString(k.person.personSeniorityName)}function i(){return null!=k.person.company&&(b.isNotEmptyString(k.person.company.name)||b.isNotEmptyString(k.person.company.hqCityName)||b.isNotEmptyString(k.person.company.hqStateCode)||b.isNotEmptyString(k.person.company.hqCountryCode)||b.isNotEmptyString(k.person.company.hqPhoneNumber)||b.isNotEmptyString(k.person.company.websiteUrl)||b.isNotEmptyString(k.person.company.primaryIndustryName)||null!=k.person.company.revenue&&k.person.company.revenue>0||null!=k.person.company.numEmployees&&k.person.company.numEmployees>0)}function j(a){return a?void $("html,body").animate({scrollTop:$(".orgchart-blurrow").offset().top+"px"},900):void c.open({controller:["$scope","$uibModalInstance","subjectLine","bodyLine",function(a,b,c,d){function e(){b.close(!1)}var f=this;f.close=e,f.subjectLine=c,f.bodyLine=d}],controllerAs:"personUnlockVm",resolve:{subjectLine:function(){return k.subjectLine},bodyLine:function(){return k.bodyLine}},size:"md",templateUrl:"app/views/person/unlock.modal.html",windowClass:"lock-modal"})}var k=this;k.person=_.clone(a),void 0===k.person.locked&&(k.person.locked=!1),k.noMapAvailable=null==k.person.hqLocation.location||null==k.person.hqLocation.location.longitude||null==k.person.hqLocation.location.latitude,k.bodyLine=encodeURIComponent("I am interested in more information on how to gain access to the data set which includes "+k.person.fullName+" at "+k.person.company.name+"."),k.subjectLine=encodeURIComponent("Access Request From "+d.Session.account.firstName+" "+d.Session.account.lastName+": "+k.person.fullName+" at "+a.company.name),k.$onInit=g,k.openLockedModal=j}a.$inject=["personData","personTierTwoService","$uibModal","$rootScope","downloadExportService","SearchService"],angular.module("dorgEuiApp").controller("personTierTwoCtrl",a)}(),angular.module("dorgEuiApp").config(["$stateProvider","dorgConfig",function(a,b){a.state("view_person_tier_two",{url:"/person-t2/:uuid",params:{orgChart:!1},templateProvider:["personData","$http","$templateCache",function(a,c,d){var e="app/views/tier-two-data/person-tier-two/person-tier-two.html",f=function(a){return a.data};switch(a.status){case 418:case 412:case 409:case 404:return d.get(b["TPL_"+a.status])?d.get(b["TPL_"+a.status]):c.get(b["TPL_"+a.status]).then(f);default:return d.get(e)?d.get(e):c.get(e).then(f)}}],controllerProvider:["personData",function(a){switch(a.status){case 418:case 412:case 409:return b["CTRL_"+a.status];case 404:return;default:return"personTierTwoCtrl as personVm"}}],resolve:{personData:["$stateParams","personTierTwoService",function(a,b){return b.findByUuid(a.uuid)}],$title:["personData",function(a){switch(a.status){case 418:case 412:case 409:case 404:return b["MSG_"+a.status];default:var c="";return a.fullName&&(c+=a.fullName),a.company&&a.company.name&&(c+=" | "+a.company.name),c}}]}})}]),function(){"use strict";function a(a){function b(b){return a.get("api/rest/tier2/people/"+b).then(function(a){return a.data=c(a.data),a.data},function(a){return a})}function c(a){return null==a.companyTierOne&&null==a.companyTierTwo?(a.hqLocation={},a):(a.companyTierOne?(a.isCompanyTierTwo=!1,a.company=a.companyTierOne,null!=a.company.location&&(a.company.hqPhoneNumber=a.company.mainPhoneNumber,a.company.hqCityName=a.company.location.city,a.company.hqStateCode=a.company.location.stateProvinceRegion,a.company.hqPostalCode=a.company.location.postalCode,a.company.hqCountryName=a.company.location.countryName,a.company.hqCountryCode=a.company.location.isoCountryCode,a.company.hqStreetAddress1=a.company.location.streetAddress1,a.company.hqStreetAddress2=a.company.location.streetAddress2,a.company.hqLongitude=a.company.location.longitude,a.company.hqLatitude=a.company.location.latitude),null!=a.company.companyIndustries&&(a.company.industryNames=_.map(a.company.companyIndustries,"name").join(", "))):(a.isCompanyTierTwo=!0,a.company=a.companyTierTwo),a.hqLocation={location:{id:e,longitude:null==a.company.hqLongitude?f:a.company.hqLongitude,latitude:null==a.company.hqLatitude?g:a.company.hqLatitude}},a)}function d(a){return null!=a&&""!==a.trim()}var e=1,f=0,g=0;return{findByUuid:b,isNotEmptyString:d}}a.$inject=["$http"],angular.module("dorgEuiApp").service("personTierTwoService",a)}(),function(){"use strict";function a(){function a(a,e,f){if(!a)return c;var g=_.clone(c);if(b(a[e])&&(g+=a[e]),g!==c){var h=_.some(f,function(c){return b(a[c])});h&&(g+=",")}return _.forEach(f,function(c){b(a[c])&&(g+=d+a[c])}),g.trim()}function b(a){return null!=a&&a.trim()!==c}var c="",d=" ";return{isNotEmptyString:b,generateCompanyFullAddressWithoutStreet:a}}a.$inject=[],angular.module("dorgEuiApp").service("tierTwoDataService",a)}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){var a=j.activeCriteria.score.minValue>j.oppAlertScoreOptions.minScore?1:0;return a}function h(){a.dismiss("cancel")}function i(a){if(_.isEmpty(a))return 0;var b=0;return a.forEach(function(a){b+=a.children.length}),b}var j=this;j.activeCriteria=b,j.topicsGroupedByCategory=c,j.isTopicEmpty=_.isEmpty(j.topicsGroupedByCategory),j.isLargeFilter=i(j.topicsGroupedByCategory)>25,j.oppAlertScoreOptions=d,j.countTotalScoreSelected=g,j.closeModal=h,e.resultsCounts=f.resultsCounts,e.$on("results:getConsumerCounts",function(a,b){e.resultsCounts.count=b})}a.$inject=["$uibModalInstance","activeCriteria","topicsGroupedByCategory","oppAlertScoreOptions","$scope","TopContentConsumerService"],angular.module("dorgEuiApp").controller("intentCriteriaModalCtrl",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(a){return e.isSearchCriteriaNumberRangeNonDefault(a)}function j(a){return d.makeSearchCriteriaNumberRangeLabel(a)}function k(a){a.minValue=0,a.maxValue=0,o()}function l(a){a.minValue=null,a.maxValue=null,o()}function m(){s.activeCriteria.geo.radialDistance="",s.activeCriteria.geo.postalCodeCenter="",o()}function n(){a.close()}function o(){s.showAddressLoc=_.filter(s.activeCriteria.geo,_.size).length>0,s.isEmpty=c.isEmptyCriteria(s.activeCriteria),g||(s.isEmpty=s.isEmpty&&!c.hasDateRangeValue(c.getDateRange())),s.isEmpty&&f.$broadcast("event:reSearchOppAlert","",!0)}function p(a){"date"===a&&(c.setDateRange({minvalue:null,maxValue:null}),o()),s.isEmpty=c.isEmptyCriteria(s.activeCriteria),g||(s.isEmpty=s.isEmpty&&!c.hasDateRangeValue(c.getDateRange())),f.$broadcast("event:reSearchOppAlert",a,s.isEmpty)}function q(a){var b=_.groupBy(a,"cateId"),c=[];return _.forEach(b,function(a,b){if(null!=a[0]){var d=[];_.forEach(a,function(a){_.findIndex(d,{id:a.id})===-1&&d.push(a)}),c.push({id:a[0].cateId,displayName:a[0].cateDisplayName,topicsNum:d.length})}}),_.sortBy(c,function(a){return a.displayName.toLowerCase()})}function r(a){null!=s.activeCriteria.topicIds&&(s.activeCriteria.topicIds=_.filter(s.activeCriteria.topicIds,function(b){return b.cateId!=a}),s.topicsGroupedByCategory=q(s.activeCriteria.topicIds))}var s=this;s.maxTopics=s.maxCates=100,s.activeCriteria=b,s.isEmpty=c.isEmptyCriteria(s.activeCriteria)&&!c.hasDateRangeValue(c.getDateRange()),s.isSearchCriteriaNumberRangeNonDefault=i,s.makeSearchCriteriaNumberRangeLabel=j,s.defaultSearchCriteriaNumberRange=k,s.defaultSearchCriteriaNumberRangeNull=l,s.showAddressLoc=_.filter(s.activeCriteria.geo,_.size).length>0,s.oppAlertScoreOptions=h,s.showPostalCodeApplyTo=function(){return s.showAddressLoc&&(b.geo.postalCodes&&_.filter(b.geo.postalCodes,_.size).length>0||b.geo.postalCodeCenter&&b.geo.postalCodeCenter.length>0)},s.opportunityEndDate=function(){return c.getDateRange()},s.hasDateRange=function(){return c.hasDateRangeValue(c.getDateRange())},s.clearRadialPostal=m,s.close=n,s.changeActiveCriteria=o,s.changeFilterGridColumns=p,s.opportunityEndDateMin=moment().subtract(6,"months").startOf("day").format("MM/DD/YYYY"),s.opportunityEndDateMax=moment().startOf("day").format("MM/DD/YYYY"),s.topicsGroupedByCategory=[],null!=s.activeCriteria.topicIds&&s.activeCriteria.topicIds.length>s.maxTopics&&(s.topicsGroupedByCategory=q(s.activeCriteria.topicIds)),s.removeTopicsByCategoryId=r}a.$inject=["$uibModalInstance","activeCriteria","TopContentConsumerService","SearchService","ActiveCriteriaCountService","$rootScope","autoPopulateDateRange","oppAlertScoreOptions"],angular.module("dorgEuiApp").controller("topContentConsumerActiveFiltersCtrl",a)}(),angular.module("dorgEuiApp").service("$topContentConsumerCache",["$grid","$rootScope",function(a,b){this.get=function(){return b.Session.oppAlertSelection},this.selection=function(){return this.get()},this.setSelection=function(a,c){var d;if(!a)throw new Error("Missing Parameters when trying to set Selection Cache");return this.get()||(b.Session.oppAlertSelection=[]),c=c||!1,_.isArray(a)||(_.isNumber(a)?this.get().indexOf(a)<0||c===!0?this.get().push(a):this.get().splice(this.get().indexOf(a),1):_.isObject(a)&&_.has(a,"id")&&(d=_.findIndex(this.get(),{id:a.id}),d<0||c===!0?this.get().push(a):this.get().splice(d,1))),this},this.clearSelection=function(){return b.Session.oppAlertSelection=[],this}}]),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){function z(){Aa.activeCriteria={},B(),k.setDateRangeChanged(!1),Aa.topic.selected=[],Aa.topic.list=Ha,c.curShowOppAlertSavedSearchId=0,Y(),Aa.dateRangeOption=Oa}function A(){return j.getGeography().then(function(a){return a})}function B(){_.each(["employeeGrowth","fortuneRank","globalRank","numEmployees","revenue","revenueGrowth","numLocations","numHospitalBeds"],function(a){Aa.activeCriteria[a]={minValue:0,maxValue:0}}),Aa.activeCriteria.yearFounded={minValue:null,maxValue:null},Aa.activeCriteria.useSecondaryIndustry=!0,Aa.activeCriteria.companyIds=[],Aa.activeCriteria.industryIds=[],Aa.activeCriteria.naicsCodes=[],Aa.activeCriteria.sicCodes=[],Aa.activeCriteria.ownershipTypeIds=[],Aa.activeCriteria.businessModelIds=[],Aa.activeCriteria.topicIds=[],Aa.activeCriteria.score={minValue:Aa.oppAlertScoreOptions.minScore,maxValue:Aa.oppAlertScoreOptions.maxScore},j.getSearchCriteriaResource().then(function(a){Aa.activeCriteria.departments=a.departments}),Aa.activeCriteria.geo={postalCodeApplyToUSOnly:!0,radialDistance:"",postalCodeCenter:"",postalCodes:[],continents:[],countries:[],states:[],metro:[],areas:[],counties:[]}}function C(){Aa.havingOppAlertManageTopic&&Sa.push(Ta),Sa.push(Ua),Aa.oppAlertsSubMenuItems=Sa,c.curShowOppAlertSavedSearchId||(c.curShowOppAlertSavedSearchId=0,c.curShowOppAlertSavedSearchName="");var a=!0;if(Aa.gridOptions.onRegisterApi=D,Aa.gridOptions.enableGridMenu=!1,B(),e.company)try{Aa.activeCriteria.companyIds=[JSON.parse(e.company)],Ba(!1)}catch(a){}else if(e.companyInfo)try{Aa.activeCriteria.companyIds=[e.companyInfo],Ba(!1)}catch(a){}else e.goToManageTopic?(f(function(){ga()},0),Aa.manageTopicInfo.currentTab="manage"):_.isUndefined(q.params)||_.isEmpty(q.params.savedSearchId)?null!=e.listMatchResultIds&&e.listMatchResultIds.isCompany?Aa.activeCriteria.companyIds=_.uniq(Aa.activeCriteria.companyIds.concat(e.listMatchResultIds.ids),"id"):c.Session.oppAlertsCriteria&&(c.Session.oppAlertsCriteria.topicSelected&&(Aa.topic.selected=c.Session.oppAlertsCriteria.topicSelected),k.hasDateRangeValue(c.Session.oppAlertsCriteria.opportunityEndDate)&&(Aa.opportunityEndDate={minValue:c.Session.oppAlertsCriteria.opportunityEndDate.minValue,maxValue:c.Session.oppAlertsCriteria.opportunityEndDate.maxValue},Aa.dateRangeOption=c.Session.oppAlertsCriteria.dateRangeOption,a=!1,k.setDateRange(Aa.opportunityEndDate)),c.Session.oppAlertsCriteria.activeCriteria&&(Aa.activeCriteria=c.Session.oppAlertsCriteria.activeCriteria),Ba(!1)):k.getOppAlertSavedSearch(q.params.savedSearchId).then(function(a){c.curShowOppAlertSavedSearchId=a.savedSearch.id,c.curShowOppAlertSavedSearchName=a.savedSearch.displayName,Aa.secondarySortType=q.params.secondarySortType,Aa.secondarySortTypeLoaded=!1,P(a,!0)});i.maxOppAlertsRowCount().then(function(a){Aa.rowLimit=a.data}),c.Session.$isTrial||i.$formats().then(function(a){a.length&&(Aa.canExport=!0)}),Aa.opportunityMinDateLimit=moment().subtract(3,"months").toDate(),a&&Y()}function D(a){this.api=a,this.appScope=d,this.paginationPageSize=25,this.paginationPageSizes=[10,25,50,75,100],this.selectionRowHeaderWidth=35,this.totalItems=0,this.useExternalFiltering=!0,this.useExternalPagination=!0,this.useExternalSorting=!0,this.api.pagination.on.paginationChanged(d,function(a,b){Fa.pageNumber=a,Fa.pageSize=b,H(!0)}),this.api.core.on.sortChanged(d,function(a,c){b.closeAllPopover(document),0===c.length?(Ea.colName="",Ea.order=""):(Ea.colName=c[0].name,Ea.order=c[0].sort.direction),delete Aa.secondarySortType,H(!0)}),this.api.core.on.filterChanged(d,function(){var a=this.grid;za=a.columns[1].filters[0].term,ya&&f.cancel(ya),ya=f(H(!0),750,!1)}),this.api.selection.on.rowSelectionChangedBatch(d,function(a){for(var b=0,c=a.length;b<c;++b)a[b].isSelected?ka(a[b].entity):la(a[b].entity)}),this.api.selection.on.rowSelectionChanged(d,function(a){a.isSelected?ka(a.entity):la(a.entity)});var c=this.api.grid;this.api.core.on.rowsRendered(d,function(){for(var a=this.grid.rows,b=0,d=0;d<a.length;d++)_.find(Aa.selectedRows,{id:a[d].entity.id})&&(a[d].isSelected=!0,b++);b>0&&b===a.length?c.selection.selectAll=!0:c.selection.selectAll&&(c.selection.selectAll=!1)})}function E(a,b,c){Aa[a].selected=c,b.$select.search="",Ba("topic"===a?!1:!1)}function F(a){var b;a<0||(b=G().searchCriteria,za&&(b.textTermsApplication="COMPANIES",b.textSearchString=za),k.exportTopContentConsumers(b,a))}function G(){var a=I(Aa.activeCriteria);return _.includes(a.opportunityCategoryIds,null)&&(a.opportunityCategoryIds=_.without(a.opportunityCategoryIds,null)),a.opportunityEndDate={minValue:Aa.opportunityEndDate.minValue?Date.parse(Aa.opportunityEndDate.minValue+Ja):Date.parse(Na+Ja),maxValue:Aa.opportunityEndDate.maxValue?Date.parse(Aa.opportunityEndDate.maxValue+Ja):Date.parse(Ma+Ja)},{searchCriteria:a}}function H(a){var b,d=Z(),e=!1,g=!!a||Aa.dateRangeOption===Pa;if(c.Session.oppAlertsCriteria={activeCriteria:Aa.activeCriteria},k.hasDateRangeValue(Aa.opportunityEndDate)?(c.Session.oppAlertsCriteria.opportunityEndDate={minValue:Aa.opportunityEndDate.minValue,maxValue:Aa.opportunityEndDate.maxValue},c.Session.oppAlertsCriteria.dateRangeOption=Aa.dateRangeOption):(c.Session.oppAlertsCriteria.opportunityEndDate={minValue:null,maxValue:null},c.Session.oppAlertsCriteria.dateRangeOption=Oa),_.each(["employeeGrowth","fortuneRank","globalRank","numEmployees","revenue","revenueGrowth","numLocations","numHospitalBeds","yearFounded"],function(a){(Aa.activeCriteria[a].minValue||Aa.activeCriteria[a].maxValue)&&(e=!0)}),void 0!==Aa.activeCriteria.departments){var i=Object.keys(Aa.activeCriteria.departments).map(function(a){return Aa.activeCriteria.departments[a]});i&&i.forEach(function(a){0===a.numEmployees.minValue&&0===a.numEmployees.maxValue||(e=!0)})}if(_.each(["companyIds","industryIds","ownershipTypeIds","businessModelIds","naicsCodes","sicCodes","topicIds"],function(a){_.isEmpty(Aa.activeCriteria[a])||(e=!0)}),Aa.activeCriteria.geo&&_.each(["areas","continents","countries","states","metro","postalCodeCenter","radialDistance","postalCodes","counties"],function(a){_.isEmpty(Aa.activeCriteria.geo[a])||(e=!0)}),!e&&_.has(Aa.activeCriteria,"score")&&Aa.activeCriteria.score.minValue>Aa.oppAlertScoreOptions.minScore&&(e=!0),!e&&(!k.hasDateRangeValue(Aa.opportunityEndDate)||k.hasDateRangeValue(Aa.opportunityEndDate)&&!g))return Aa.opportunityEndDate={minValue:null,maxValue:null},aa(),void(Aa.topic.list=Ha);if(k.hasDateRangeValue(Aa.opportunityEndDate)){var j=!1;if(o("startDateIsValid")(Aa.opportunityEndDate.minValue)||(j=!0),o("endDateIsValid")(Aa.opportunityEndDate.minValue,Aa.opportunityEndDate.maxValue)||(j=!0),j)return void aa()}La=!0,Ca=!1,b={body:{},page:0,size:0,sortField:"",sortOrder:"asc"},_.includes(b.body.opportunityCategoryIds,null)&&(b.body.opportunityCategoryIds=_.without(b.body.opportunityCategoryIds,null)),Aa.showLoading=!0,h.scrollTo(0,0),za&&(b.body.textTermsApplication="COMPANIES",b.body.textSearchString=za),null===Fa.pageNumber&&(Fa.pageNumber=Aa.gridOptions.paginationCurrentPage,Fa.pageSize=Aa.gridOptions.paginationPageSize),b.page=Fa.pageNumber-1,b.size=Fa.pageSize,b.sortField=Ea.colName,b.sortOrder=Ea.order,_.each(I(Aa.activeCriteria),function(a,c){b.body[c]=_.clone(a)}),za&&_.isEmpty(b.body.textSearchString)&&(b.body.textTermsApplication="COMPANIES",b.body.textSearchString=za),_.isEmpty(b.body.opportunityCategoryIds)&&(b.body.opportunityCategoryIds=Ga),ma(),b.body.opportunityEndDate={minValue:Aa.opportunityEndDate.minValue?Date.parse(Aa.opportunityEndDate.minValue+Ja):Date.parse(Na+Ja),maxValue:Aa.opportunityEndDate.maxValue?Date.parse(Aa.opportunityEndDate.maxValue+Ja):Date.parse(Ma+Ja)},b.secondarySortType=Aa.secondarySortType,g?(ca(b),da(b,d)):(Aa.dateRangeOption===Oa&&(b.body.opportunityEndDate=null),k.getMostRecentDataDate(b.body).then(function(a){a?(moment(a).isSame(moment(Ma))?(Aa.opportunityEndDate.minValue=moment(Ma).subtract(1,"month").startOf("day").format("MM/DD/YYYY"),Aa.opportunityEndDate.maxValue=Ma):moment(a).isBefore(moment(Ma))&&moment(a).valueOf()>moment(Na).valueOf()&&(Aa.opportunityEndDate.minValue=moment(a).subtract(1,"month").startOf("day").format("MM/DD/YYYY"),Aa.opportunityEndDate.maxValue=moment(a).format("MM/DD/YYYY")),ba(),b.body.opportunityEndDate={minValue:Date.parse(Aa.opportunityEndDate.minValue+Ja),maxValue:Date.parse(Aa.opportunityEndDate.maxValue+Ja)},k.setDateRange(Aa.opportunityEndDate),ca(b),da(b,d)):(ca(b),aa(),Aa.showLoading=!1,Aa.filtersApplied=!0,Y(),La===!0&&f(function(){La=!1,k.saveOppAlertRecentSearch(d,"0 OppAlerts")},5e3))})),a=!1}function I(a){var b=angular.copy(a),c={employeeGrowth:b.employeeGrowth,numEmployees:b.numEmployees,revenueGrowth:b.revenueGrowth};return _.each(b,function(a,b){"geo"!==b&&(c[b]=_.endsWith(b,"Ids")?_.pluck(a,"id"):a)}),b.geo&&(c.companyLocation={areaCodeIds:_.pluck(b.geo.areas,"id"),continentIds:_.pluck(b.geo.continents,"id"),countryIds:_.pluck(b.geo.countries,"id"),division1Ids:_.pluck(b.geo.states,"id"),marketingRegionIds:_.pluck(b.geo.metro,"id"),countyIds:_.pluck(b.geo.counties,"id"),postalCodeCenter:b.geo.postalCodeCenter,radialDistance:b.geo.radialDistance,postalCodes:b.geo.postalCodes,postalCodeApplyToUSOnly:b.geo.postalCodeApplyToUSOnly}),c.revenue={minValue:_.isString(b.revenue.minValue)?Number(1e6*b.revenue.minValue.replace(",","")):1e6*b.revenue.minValue,maxValue:_.isString(b.revenue.maxValue)?Number(1e6*b.revenue.maxValue.replace(",","")):1e6*b.revenue.maxValue},c.opportunityEndDate={minValue:b.opportunityEndDate&&b.opportunityEndDate.minValue?Date.parse(b.opportunityEndDate.minValue+Ja):null,maxValue:b.opportunityEndDate&&b.opportunityEndDate.maxValue?Date.parse(b.opportunityEndDate.maxValue+Ja):null},j.tranformPropArrToVal(c,"companyLocation"),j.tranformPropArrToVal(c,"fortuneRank","minmax"),c}function J(){var a=0;if(a+=Aa.activeCriteria.companyIds.length+Aa.activeCriteria.industryIds.length+Aa.activeCriteria.naicsCodes.length+Aa.activeCriteria.sicCodes.length+Aa.activeCriteria.ownershipTypeIds.length+Aa.activeCriteria.businessModelIds.length+(Aa.activeCriteria.numEmployees.minValue>0?1:Aa.activeCriteria.numEmployees.maxValue>0?1:0)+(Aa.activeCriteria.revenue.minValue>0?1:Aa.activeCriteria.revenue.maxValue>0?1:0)+(Aa.activeCriteria.employeeGrowth.minValue>0?1:Aa.activeCriteria.employeeGrowth.maxValue>0?1:0)+(Aa.activeCriteria.revenueGrowth.minValue>0?1:Aa.activeCriteria.revenueGrowth.maxValue>0?1:0)+(Aa.activeCriteria.fortuneRank.maxValue>0||Aa.activeCriteria.globalRank.maxValue>0?1:0)+(Aa.activeCriteria.yearFounded.minValue&&Aa.activeCriteria.yearFounded.minValue>0?1:Aa.activeCriteria.yearFounded.maxValue&&Aa.activeCriteria.yearFounded.maxValue>0?1:0)+(Aa.activeCriteria.numLocations.minValue>0?1:Aa.activeCriteria.numLocations.maxValue>0?1:0)+(Aa.activeCriteria.numHospitalBeds.minValue>0?1:Aa.activeCriteria.numHospitalBeds.maxValue>0?1:0),void 0!==Aa.activeCriteria.departments){var b=Object.keys(Aa.activeCriteria.departments).map(function(a){return Aa.activeCriteria.departments[a]});b&&b.forEach(function(b){a+=b.numEmployees.minValue>0?1:b.numEmployees.maxValue>0?1:0}.bind(this))}return a}function K(){var a=0;return a+=Aa.activeCriteria.geo.continents.length+Aa.activeCriteria.geo.countries.length+Aa.activeCriteria.geo.states.length+Aa.activeCriteria.geo.metro.length+Aa.activeCriteria.geo.areas.length+Aa.activeCriteria.geo.counties.length+Aa.activeCriteria.geo.postalCodes.length+(Aa.activeCriteria.geo.radialDistance&&Aa.activeCriteria.geo.postalCodeCenter?1:0)}function L(){return k.hasDateRangeValue(Aa.opportunityEndDate)?1:0}function M(){var a=Aa.activeCriteria.score.minValue>Aa.oppAlertScoreOptions.minScore?1:0;return a+Aa.activeCriteria.topicIds.length}function N(){return J()+K()+L()+M()}function O(){var a=W("recentSearch");return a.result.then(function(a){c.curShowOppAlertSavedSearchId=0,P(a,!1)}),a}function P(a,b){_.has(Aa.gridOptions,"api")&&Aa.gridOptions.api.core.clearAllFilters();var c=_.clone(Aa.opportunityEndDate),d=_.clone(Aa.activeCriteria),e=b?"Saved Search successfully applied":"Recent Search successfully applied";Aa.oppAlertsTopicsGroupedByCategory.then(function(f){var g=[],h=[],i=[];if(_.forEach(f,function(a){_.isEmpty(a.children)||(g=g.concat(a.children))}),_.isEmpty(a.oppalertTopics)?a.oppalertTopics=[]:(_.forEach(a.oppalertTopics,function(a){var b=_.find(g,{id:a.id});b?i.push(b):h.push(a)}),a.oppalertTopics=i),_.isEmpty(h))Q(a,d,c),r.create("success",e,"flash");else{var j=y.open({controller:["invalidTopics","isSavedSearch","$uibModalInstance",function(a,b,c){
var d=this;d.invalidTopicNames=a,d.titleMessage=b?"Apply saved search warning":"Apply recent search warning",d.allowApplying=!0,d.isSavedSearch=b,d.close=function(){c.dismiss("cancel")},d.apply=function(){c.close("apply")}}],controllerAs:"opportunityTypesExpiredVm",resolve:{invalidTopics:function(){return _.pluck(h,"displayName")},isSavedSearch:function(){return b}},size:"md",templateUrl:Ia+"expiration-opportunity-type-warning.html"});j.result.then(function(b){r.create("success",e,"flash"),Q(a,d,c)})}})}function Q(a,b,c){Aa.activeCriteria.topicIds=[],Aa.dateRangeOption=a.savedSearch.searchCriteria.opportunityMostRecentDate?Oa:Pa,S(a),_.isEqual(Aa.activeCriteria,b)&&(R(),_.isEqual(Aa.opportunityEndDate,c)||Ba(!1))}function R(){k.isEmptyCriteria(Aa.activeCriteria)&&(Aa.gridOptions.data=[],V(),Aa.filtersApplied=!0)}function S(a){Aa.activeCriteria=j.convertSavedSearch(a),Aa.activeCriteria.opportunityEndDate&&(Aa.activeCriteria.opportunityEndDate.minValue||Aa.activeCriteria.opportunityEndDate.maxValue)?Aa.opportunityEndDate={minValue:Aa.activeCriteria.opportunityEndDate.minValue||null,maxValue:Aa.activeCriteria.opportunityEndDate.maxValue||null}:Aa.dateRangeOption===Pa?Aa.opportunityEndDate={minValue:Na,maxValue:Ma}:Aa.opportunityEndDate={minValue:null,maxValue:null},k.setDateRange(Aa.opportunityEndDate),Aa.dateRangeTooBig=!1,Aa.activeCriteria.opportunityEndDate={minValue:null,maxValue:null},"COMPANIES"!==Aa.activeCriteria.textTermsApplication||_.isEmpty(Aa.activeCriteria.textSearchString)||(Aa.gridOptions.columnDefs[1].filter.term=Aa.activeCriteria.textSearchString)}function T(a){return W("saveSearch",{toSubscription:a})}function U(){var a=W("applySavedSearch");return a.result.then(function(a){P(a,!0)}),a}function V(){Aa.gridOptions.totalItems=0,k.resultsCounts.count=0,c.$broadcast("results:getConsumerCounts",0)}function W(a,b){switch(a){case"companies":return y.open({controller:["$interval","$scope","$SearchModalsService","$SearchStaticFactory","$uibModal","$uibModalInstance","activeCriteria","industry","ownership","resource","businessModel","departments","TopContentConsumerService","ActiveCriteriaCountService","featureFlagService",function(a,b,c,d,e,f,g,h,i,k,l,m,n,o,p){function q(){b.activeCriteria.sicCodes=b.industryCode.sicCodes,b.activeCriteria.naicsCodes=b.industryCode.naicsCodes}function r(){var a=g.fortuneRank.maxValue,b=g.globalRank.maxValue,c=0;switch(a+b){case 500:c=1;break;case 1e3:c=2;break;case 2e3:c=3;break;case 2500:c=4;break;case 3e3:c=5}return c}function s(a){a=a.open||!1}function t(c){j.getCompanyList(k,c).then(function(d){var e=0,f=21,g=_.chunk(d,f),h=250;b.startsWith=c,a.cancel(z),b.lists.companyList=[],z=a(function(){if(!g[e])return void a.cancel(z);for(var c=0,d=g[e].length;c<d;++c)b.lists.companyList.push(g[e][c]);e+=1},h,g.length)})}function u(a){a.stopImmediatePropagation(),a.preventDefault(),_.each(h,function(a){_.indexOf(b.activeCriteria.industryIds,a)<0&&b.activeCriteria.industryIds.push(a)})}function v(a){a.stopImmediatePropagation(),a.preventDefault(),b.activeCriteria.industryIds=[],this.industrySearch="",b.industryCode.naicsCodes=[],b.industryCode.sicCodes=[],q()}function w(a){a.stopImmediatePropagation(),a.preventDefault(),b.activeCriteria.companyIds=[],this.startsWith="",this.lists.companyList=[]}function x(a){a.stopImmediatePropagation(),a.preventDefault(),b.activeCriteria.numEmployees.minValue=0,b.activeCriteria.numEmployees.maxValue=0,b.activeCriteria.revenue.minValue=0,b.activeCriteria.revenue.maxValue=0,b.activeCriteria.employeeGrowth.minValue=0,b.activeCriteria.employeeGrowth.maxValue=0,b.activeCriteria.revenueGrowth.minValue=0,b.activeCriteria.revenueGrowth.maxValue=0,b.fortuneGlobal.selected=0,b.activeCriteria.fortuneRank.maxValue=0,b.activeCriteria.fortuneRank.minValue=0,b.activeCriteria.globalRank.maxValue=0,b.activeCriteria.globalRank.minValue=0}function y(a){a=a||b.fortuneGlobal.options[0],0===a.id&&(b.fortuneGlobal.selected=0),b.activeCriteria.fortuneRank=a.values.fortune,b.activeCriteria.globalRank=a.values.global}var z=null,A=6,B=4;b.$$filterDebounce=d.filterDebounce,b.$onSelect=y,b.activeCriteria=g,b.clearAllIndustry=v,b.clearAllName=w,b.clearAllCompanySize=x,b.close=f.close,b.fortuneGlobal=d.fortuneGlobal,b.fortuneGlobal.selected=r(),b.getCompanyList=t,b.industrySearch="",b.isOppAlerts=!0,b.selectAllIndustry=u,b.showBulkMatch=!1,b.startsWith="",b.startsWithArray=d.startsWith,b.tracker=s,p.getFeatureFlags().then(function(a){b.yearFoundedEnabled=p.findFeatureFlag(a.data,"year_founded")}),b.lists={ownershipTypes:i,industries:h,businessModels:l,companyList:[],departments:m},b.industryPurviewRadios=[{value:!0,label:"Any"},{value:!1,label:"Primary Industry"}],b.industryCode={naicsCodes:b.activeCriteria.naicsCodes,sicCodes:b.activeCriteria.sicCodes},b.deselectIndustryCodeTab=function(a){a?b.industryCode.sicCodes=[]:b.industryCode.naicsCodes=[],q()},b.changeIndustryNaicsCodes=function(){b.industryCode.naicsCodes=j.standardizeArrayByDelimiter(b.industryCode.naicsCodes,A),b.industryCode.sicCodes=[],q()},b.changeIndustrySicCodes=function(){b.industryCode.naicsCodes=[],b.industryCode.sicCodes=j.standardizeArrayByDelimiter(b.industryCode.sicCodes,B),q()},b.resultsCounts=n.resultsCounts,b.$on("results:getConsumerCounts",function(a,c){b.resultsCounts.count=c}),b.validateToValue=function(a){var b="",c=a.minValue,d=a.maxValue;return 0!==d&&c>=d&&(b="invalidEntry"),b},b.clearAllDepartmentSize=function(a){if(a.stopImmediatePropagation(),a.preventDefault(),b.activeCriteria.departments){var c=Object.keys(b.activeCriteria.departments).map(function(a){return b.activeCriteria.departments[a]});c&&c.forEach(function(a){a.numEmployees.minValue=0,a.numEmployees.maxValue=0})}},b.selectAllAdditionalDetails=function(a){a.stopImmediatePropagation(),a.preventDefault(),_.each(l,function(a){_.indexOf(b.activeCriteria.businessModelIds,a)<0&&b.activeCriteria.businessModelIds.push(a)})},b.clearAllAdditionalDetails=function(a){a.stopImmediatePropagation(),a.preventDefault(),b.activeCriteria.businessModelIds=[],b.activeCriteria.yearFounded.minValue=null,b.activeCriteria.yearFounded.maxValue=null,b.activeCriteria.numLocations.minValue=0,b.activeCriteria.numLocations.maxValue=0,b.activeCriteria.numHospitalBeds.minValue=0,b.activeCriteria.numHospitalBeds.maxValue=0},b.countDepartmentEmployeeSize=function(){return o.countActiveCriteriaDepartments(b.activeCriteria.departments)}}],resolve:{activeCriteria:function(){return Aa.activeCriteria},ownership:function(){return j.getOwnershipTypeList(m)},industry:function(){return j.getIndustryList(m)},resource:function(){return m},businessModel:function(){return j.getBusinessModelTypeList(m)},departments:function(){return j.getDepartmentList(m)}},size:"lg",templateUrl:"app/views/search/partials/companiesCriteria.modal.html"});case"location":return y.open({controller:["$scope","geoData","$uibModalInstance","activeCriteria","$SearchStaticFactory","TopContentConsumerService","featureFlagService",function(a,b,c,d,e,f,g){function h(a,b){b.$select.search=""}function i(a,b){b.$select.search=""}function k(){a.activeCriteria.geo.continents=[],a.activeCriteria.geo.countries=[],a.activeCriteria.geo.states=[],a.activeCriteria.geo.metro=[],a.activeCriteria.geo.areas=[],a.activeCriteria.geo.counties=[],a.activeCriteria.geo.radialDistance="",a.activeCriteria.geo.postalCodeCenter=""}function l(){a.activeCriteria.geo.radialDistance="",a.activeCriteria.geo.postalCodeCenter="",a.activeCriteria.geo.postalCodes=[],a.activeCriteria.geo.postalCodeApplyToUSOnly=!0,a.geo.radialDistance="",a.geo.postalCodeCenter="",a.geo.postalCodes="",a.geo.postalCodeApplyToUSOnly=!0}a.$onRemove=h,a.$onSelect=i,a.activeCriteria=d,a.clearAllGeography=k,a.clearAllPostalCode=l,a.close=c.close,a.continents=b[1],a.countries=b[2],a.states=b[3],a.metro=b[4],a.areaCodes=b[5],a.counties=b[7],a.resultsCounts=f.resultsCounts,a.mileRadius=e.mileRadius,a.locationPostalCodeRadios=e.locationPostalCodeRadios,a.isValidPostalCodes=!0,a.isValidPostalCodeCenter=!0,a.countyFeatureFlag=g.findFeatureFlag(null,"county"),_.has(a.activeCriteria,"geo")?a.geo={postalCodeApplyToUSOnly:a.activeCriteria.geo.postalCodeApplyToUSOnly,postalCodes:a.activeCriteria.geo.postalCodes.join(", "),postalCodeCenter:a.activeCriteria.geo.postalCodeCenter,radialDistance:null!=a.activeCriteria.geo.radialDistance?a.activeCriteria.geo.radialDistance.toString():""}:a.geo={postalCodeApplyToUSOnly:!0,postalCodes:"",postalCodeCenter:"",radialDistance:""},a.processSearchingByGeo=function(){var b=j.formatPostalCodesArray(a.geo.postalCodes,a.geo.postalCodeApplyToUSOnly);a.isValidPostalCodes=!a.geo.postalCodeApplyToUSOnly||j.validateUSPostalCodes(b),a.isValidPostalCodes&&(a.isValidPostalCodeCenter=!a.geo.postalCodeApplyToUSOnly||j.validateUSPostalCodes([a.geo.postalCodeCenter]),a.isValidPostalCodeCenter&&_.isEmpty(a.geo.radialDistance.trim())===_.isEmpty(a.geo.postalCodeCenter.trim())&&(a.activeCriteria.geo.postalCodeApplyToUSOnly=a.geo.postalCodeApplyToUSOnly,a.activeCriteria.geo.postalCodes=b,a.activeCriteria.geo.postalCodeCenter=a.geo.postalCodeCenter,a.activeCriteria.geo.radialDistance=a.geo.radialDistance,0!==b.length&&(a.geo.postalCodes=b.join(", "),a.geo.postalCodes+=" ")))},a.$on("results:getConsumerCounts",function(b,c){a.resultsCounts.count=c})}],resolve:{activeCriteria:function(){return Aa.activeCriteria},geoData:function(){return Aa.geography}},size:"lg",templateUrl:"app/views/search/partials/locationCriteria.modal.html"});case"activeFilters":return y.open({controller:"topContentConsumerActiveFiltersCtrl",controllerAs:"oppAlertActiveFiltersVm",resolve:{activeCriteria:function(){return Aa.activeCriteria},autoPopulateDateRange:function(){return Aa.dateRangeOption===Oa},oppAlertScoreOptions:function(){return Aa.oppAlertScoreOptions}},size:"lg",templateUrl:Ia+"top-content-consumer-active-filters/top-content-consumer-active-filters.modal.html"});case"recentSearch":return y.open({controller:["TopContentConsumerService","$uibModalInstance","recentSearches",function(a,b,c){var d=this;d.isEmptyRecentSearches=_.isEmpty(c),d.options=c,d.optionsFirst=c[0],d.isOppAlertPage=!0,d.apply=function(){a.getOppAlertRecentSearch(d.optionsFirst).then(function(a){b.close(a)})},d.close=function(){b.dismiss("cancel")}}],controllerAs:"recentSearchVm",resolve:{recentSearches:function(){return k.getOppAlertRecentSearches()}},size:"sm-plus",templateUrl:Ka+"recentSearches.modal.html"});case"saveSearch":return y.open({controller:["TopContentConsumerService","dorgValidation","searchObj","$uibModalInstance","Flash","isEmpty","supportData","currentSavedSearchSubscriptions","$q",function(a,d,e,f,g,h,i,k,l){function m(a){return a?"Invalid characters found: "+a:""}function n(b){q.hasCurrentSavedSearch&&q.isOverWrite?(b.id=q.savedSearchSavedId,a.overWriteThisSearch(b).then(function(a){t(a)})):a.saveThisSearch(b).then(function(a){t(a)})}function o(){return a.checkDuplicateSubscriptionName(i._links.checkValidName.href,q.subscriptionName).then(function(a){q.subscriptionNameError=a?"Subscription Name must be unique.":""})}function p(){return a.checkDuplicateSavedSearchName(q.searchName).then(function(a){q.searchNameError=a?"You already have a saved search with this name. Please re-name this search.":""})}var q=this;q.isFromAdvancedSearch=!1,q.isEmpty=h,q.searchName="",q.isSaving=!1,q.searchNameErrors=[],q.savedSearchSavedId=0,q.isOppAlertPage=!0,q.hasCurrentSavedSearch=c.curShowOppAlertSavedSearchId>0,q.isOverWrite=!0;var r=!q.hasCurrentSavedSearch||!q.isOverWrite;q.subscribe=b.toSubscription?b.toSubscription:r,q.subscriptionName="",q.subscriptionNameErrors=[],q.subsctiptionType=i.subscriptionTypes[3],q.scheduleType=i.oppAlertSavedSearchScheduleType,q.sourceListType=i.savedSearchesListTypeId,q.currentSavedSearchSubscriptions=k;var s="OppAlerts";q.disallowSaveSearchSubmit=function(){return q.subscribe?0===q.searchName.trim().length||_.isEmpty(q.scheduleType)||!q.scheduleType.id||_.isEmpty(q.subsctiptionType)||!q.subsctiptionType.id||0===q.subscriptionName.trim().length:0===q.searchName.trim().length},q.subscriptionNameFocus=function(){0===q.subscriptionName.trim().length&&q.searchName.trim().length>0&&(q.subscriptionName=q.searchName+" - "+s,q.subscriptionName=j.getSavedSearchNameCutOffByMaxlengthLimit(q.subscriptionName),q.checkForSpecialCharsSubscription())},q.checkForSpecialCharsSubscription=function(){q.subscriptionNameError=m(d.findSpecialChars(q.subscriptionName,d.nameRegex))},q.checkForSpecialCharsSavedSearch=function(){q.searchNameError=m(d.findSpecialChars(q.searchName,d.nameRegex))},q.invalidCharacters=function(){return q.searchNameError||q.subscriptionNameError},q.onIsOverWriteChange=function(){q.isOverWrite?q.getSavedSearchName():q.clearSavedSearchName(),q.subscribe=!q.isOverWrite},q.getSavedSearchName=function(){q.searchName=c.curShowOppAlertSavedSearchName,q.savedSearchSavedId=c.curShowOppAlertSavedSearchId,q.searchNameErrors=[],q.searchNameError=""},q.clearSavedSearchName=function(){q.searchName="",q.savedSearchSavedId=0,q.searchNameError=""},q.init=function(){q.hasCurrentSavedSearch&&q.getSavedSearchName()},q.init(),q.save=function(){q.isSaving=!0;var a={name:q.searchName,searchCriteria:e},b=[];q.hasCurrentSavedSearch&&q.isOverWrite&&q.searchName===c.curShowOppAlertSavedSearchName||b.push(p()),q.subscribe&&b.push(o()),_.size(b)>0?l.all(b).then(function(b){q.searchNameError||q.subscriptionNameError?q.isSaving=!1:n(a)}):n(a)};var t=function(b){if(400!==b.status&&403!==b.status||!b.data.errors)412===b.status?q.searchNameErrors.push(b.data.errorMsg):q.subscribe?(q.savedSearchSavedId=b.id,a.createSubscription(i._links.subscriptions.href,q.savedSearchSavedId,q,f)):(f.close(),g.create("success","Search Successfully saved as "+b.name,"flash"));else{var c="";_.each(b.data.errors,function(a){c=d.getErrorMessage(a.code),_.includes(q.searchNameErrors,c)?_.pullAt(q.searchNameErrors,_.indexOf(q.searchNameErrors,c)):q.searchNameErrors.push(c)})}q.isSaving=!1};q.close=function(){f.dismiss("cancel")}}],controllerAs:"saveSearchVm",resolve:{searchObj:function(){return Z()},isEmpty:function(){return k.isEmptyCriteria(Aa.activeCriteria)&&!k.hasDateRangeValue(Aa.opportunityEndDate)},supportData:function(){return k.subscriptionSuppportData()},currentSavedSearchSubscriptions:function(){return c.curShowOppAlertSavedSearchId>0?k.getSavedSearchSubscriptionBySourceListId(c.curShowOppAlertSavedSearchId):[]}},size:"sm-save-search",templateUrl:Ka+"saveSearch.modal.html"});case"applySavedSearch":return y.open({controller:["TopContentConsumerService","$uibModalInstance","savedSearches","Flash",function(a,b,d,e){var f=this;f.noOptions=d.length>0,f.options=d,f.optionsFirst=d[0],f.isOppAlertPage=!0,f.apply=function(){a.getOppAlertSavedSearch(f.optionsFirst.id).then(function(a){c.curShowOppAlertSavedSearchId=a.savedSearch.id,c.curShowOppAlertSavedSearchName=a.savedSearch.displayName,b.close(a)})},f.close=function(){b.dismiss("cancel")}}],controllerAs:"savedSearchVm",resolve:{savedSearches:function(){return k.getOppAlertSavedSearchs()}},size:"sm-plus",windowClass:"modal-width-plus",templateUrl:Ka+"savedSearches.modal.html"});case"intent":return y.open({controller:"intentCriteriaModalCtrl",controllerAs:"intentModalVm",resolve:{activeCriteria:function(){return Aa.activeCriteria},topicsGroupedByCategory:function(){return Aa.oppAlertsTopicsGroupedByCategory},oppAlertScoreOptions:function(){return Aa.oppAlertScoreOptions}},size:"lg",templateUrl:Ia+"intent/intent-criteria.modal.html"})}}function X(){Aa.dateRangeTooBig=!1;var a=new Date(Aa.opportunityEndDate.minValue).valueOf(),b=new Date(Aa.opportunityEndDate.maxValue).valueOf();if(a||(Aa.opportunityEndDate.minValue=Na),b||(Aa.opportunityEndDate.maxValue=Ma),a||b){var c=moment(),d=moment().subtract(3,"months");c.startOf("day"),d.startOf("day"),b&&(b>c.valueOf()||b<d.valueOf())&&(Aa.opportunityEndDate.maxValue=moment().format("MM/DD/YYYY"),Aa.dateRangeTooBig=!0),a&&(a<c.subtract(3,"months").valueOf()||a>moment().startOf("day").valueOf())&&(Aa.opportunityEndDate.minValue=moment().subtract(3,"months").format("MM/DD/YYYY"),Aa.dateRangeTooBig=!0)}k.setDateRange(Aa.opportunityEndDate),Aa.selectedRows=[],delete Aa.secondarySortType,Ba(!1)}function Y(){Aa.opportunityEndDate={minValue:null,maxValue:null},k.setDateRange(Aa.opportunityEndDate),Aa.dateRangeTooBig=!1}function Z(){var a=I(Aa.activeCriteria);return k.hasDateRangeValue(Aa.opportunityEndDate)?a.opportunityEndDate={minValue:Aa.opportunityEndDate.minValue?Date.parse(Aa.opportunityEndDate.minValue+Ja):null,maxValue:Aa.opportunityEndDate.maxValue?Date.parse(Aa.opportunityEndDate.maxValue+Ja):null}:a.opportunityEndDate={minValue:null,maxValue:null},a.opportunityMostRecentDate=Aa.dateRangeOption===Oa,a}function aa(){Aa.gridOptions.data=[],V(),Ca=!0,Ba.cancel(),Aa.gridOptions.api.core.refresh(),Aa.showLoading=!1,Aa.searchResults={searchCriteriaScoped:0,totalAccessable:0,searchCriteriaNoScope:0},Aa.filtersApplied=!1}function ba(){Aa.opportunityEndDate.minValue&&!moment(Aa.opportunityEndDate.minValue).isBefore(moment(Na))||(Aa.opportunityEndDate.minValue=Na),Aa.opportunityEndDate.maxValue&&!moment(Aa.opportunityEndDate.maxValue).isAfter(moment(Ma))||(Aa.opportunityEndDate.maxValue=Ma)}function ca(a){Da=_.cloneDeep(a),k.searchCountTopContentConsumer(a).then(function(a){Aa.searchResults=a.data,k.resultsCounts.count=a.data.searchCriteriaScoped,c.$broadcast("results:getConsumerCounts",a.data.searchCriteriaScoped)})}function da(b,c){k.searchTopContentConsumer(b).then(function(d){Ca||(Aa.gridOptions.data=a.$getD(d.data),d.page?Aa.gridOptions.totalItems=d.page.totalElements:(d.page={totalElements:0},V()),La===!0&&f(function(){La=!1,k.hasDateRangeValue(Aa.opportunityEndDate)||(b.body.opportunityEndDate={minValue:null,maxValue:null}),k.saveOppAlertRecentSearch(c,o("number")(d.page.totalElements)+" OppAlerts")},5e3))},function(){V()}).finally(function(){Aa.showLoading=!1,Aa.secondarySortTypeLoaded=!0,Aa.filtersApplied=!0})}function ea(a){Aa.opportunityEndDate={minValue:null,maxValue:null},ja("dateOption")}function fa(){Aa.dateRangeOption===Oa&&(Aa.selectedRows=[],delete Aa.secondarySortType,Aa.dateRangeTooBig=!1,k.setDateRange(Aa.opportunityEndDate),Ba(!1))}function ga(){"tab-topic"!==Aa.activeTab&&(Aa.activeTab="tab-topic",qa())}function ha(){ja("searchResult")}function ia(a){return Aa.manageTopicInfo.isChange?oa(function(){return pa(),a()}):(Aa.activeTab="tab-search",a())}function ja(a){var b;switch(a){case"saveSearch":b=function(){return Aa.saveThisSearch(!1)};break;case"applySavedSearch":b=function(){return Aa.applySavedSearch()};break;case"recentSearch":b=function(){return Aa.recentSearch()};break;case"activeFilters":b=function(){return Aa.launchCriteriaModal("activeFilters")};break;case"clearAllFilters":b=function(){return Aa.clearAllFilters()};break;case"launchCompanies":b=function(){return Aa.launchCriteriaModal("companies")};break;case"launchLocation":b=function(){return Aa.launchCriteriaModal("location")};break;case"intent":b=function(){return Aa.launchCriteriaModal("intent")};break;case"dateOption":b=function(){return fa()};break;case"listMatch":b=ra;break;case"manageTopics":default:b=function(){return!0}}return ia(b)}function ka(a){_.findIndex(Aa.selectedRows,"id",a.id)<0&&Aa.selectedRows.push(a)}function la(a){var b=_.findIndex(Aa.selectedRows,"id",a.id);b>-1&&Aa.selectedRows.splice(b,1)}function ma(){Aa.dateRangeOption===Pa&&(Aa.opportunityEndDate.minValue||(Aa.opportunityEndDate.minValue=Na),Aa.opportunityEndDate.maxValue||(Aa.opportunityEndDate.maxValue=Ma),k.setDateRange(Aa.opportunityEndDate))}function na(){return k.getTopics().then(function(a){return a.forEach(function(a){a.children.forEach(function(b){b.cateId=a.id,b.cateDisplayName=a.displayName})}),_.sortBy(a,function(a){return a.displayName.toLowerCase()})})}function oa(a){var b=g.open({controller:["$uibModalInstance",function(a){var b=this;b.close=function(){a.dismiss("close")},b.confirm=function(){a.close("continue")}}],controllerAs:"$ctrl",size:"sm",templateUrl:Ia+"manage-topic-leave-page-without-saving.html"});return b.result.then(function(){Aa.manageTopicInfo.isChange=!1,a()},function(a){Aa.activeTab="tab-topic",Aa.manageTopicInfo.currentTab="manage"}),b}function pa(){Aa.activeTab="tab-search"}function qa(){Aa.oppAlertsTopicsGroupedByCategory=n.resolve(na()),Aa.gridOptions.api.core.refresh(),Aa.oppAlertsTopicsGroupedByCategory.then(function(a){if(_.isEmpty(a))Aa.activeCriteria.topicIds=[],Aa.isOppAlertTopicEmpty=!0;else{Aa.isOppAlertTopicEmpty=!1;var b=[];a.forEach(function(a){b=b.concat(a.children)}),_.remove(Aa.activeCriteria.topicIds,function(a){return!_.some(b,{id:a.id})})}H(!0)})}function ra(){t.track("Search","OppAlert ListMatch","Click"),u.setMode("search"),g.open({templateUrl:"app/components/bulkMatch/bulkMatchModal/bulk-match-modal.tpl.html",controller:"bulkMatchModalController as $ctrl",size:"lg",backdrop:"static",windowClass:"search-bulk-match",resolve:{isForOppAlert:function(){return!0}}}).result.then(function(a){return a.data&&a.data.length&&a.isCompany?void(Aa.activeCriteria.companyIds=_.uniq(Aa.activeCriteria.companyIds.concat(a.data),"id")):a.runAnother?void ra():void 0}),c.listMatchNotifications&&setTimeout(function(){c.$broadcast("showImportHistory")},500)}function sa(){var a=_.uniq(Aa.selectedRows,"companyId"),a=_.map(a,function(a){return{id:a.companyId,displayName:a.companyName}});ua(a)}function ta(){null!=Da&&null!=Da.body&&(Aa.showViewInAdvancedSearchLoading=!0,k.searchCompaniesHavingOppAlert(Da.body).then(function(a){Aa.showViewInAdvancedSearchLoading=!1,_.isEmpty(a)||ua(a)},function(){Aa.showViewInAdvancedSearchLoading=!1}))}function ua(a){a.length<=Ra?window.localStorage&&(window.localStorage.oppAlertSelectedCompanies=JSON.stringify({selectedCompanies:a}),q.go("perform_search",{textTermsApplication:"OPPALERT",status:"viewOppAlertInSearch"})):g.open({controller:["$uibModalInstance",function(a){var b=this;b.maxNumber=Ra,b.close=a.dismiss}],controllerAs:"$ctrl",windowClass:"oppalert-view-in-advanced-search-warning",templateUrl:"app/views/topcontentconsumer/partials/oppalert-view-in-advanced-search-warning.html"})}function va(a){switch(a){case"showSearchResult":ha();break;case"manageTopics":ga()}}function wa(){var a=$("#oppAlertsNavigation"),b=!1;return _.isEmpty(a)||(b=a[0].scrollHeight>a[0].offsetHeight),b}function xa(){var a=wa();return a||(a=w.getHamburgerTime()),a}if(!x.canAccessTopContentConsumers())return void q.go(x.getDefaultLandingPage(),{});var ya,za=null,Aa=this,Ba=_.debounce(H,1500),Ca=!0;d.$on("event:followed",H);var Da,Ea={colName:"",order:""},Fa={pageNumber:null,pageSize:null},Ga=[],Ha=[],Ia="app/views/topcontentconsumer/partials/",Ja=" UTC-8",Ka="app/views/search/partials/",La=!0,Ma=moment().startOf("day").format("MM/DD/YYYY"),Na=moment().startOf("day").subtract("month",3).format("MM/DD/YYYY"),Oa="1",Pa="2",Qa=!1,Ra=1e4,Sa=[{display:"Search Results",icon:"fa fa-list-alt",itemKey:"showSearchResult",isOpenSingleModal:!1,activeTabKey:"tab-search"},{display:"Active Filter Selections â",icon:"fa fa-filter",itemKey:"activeFilters",isOpenSingleModal:!0,activeTabKey:"",isActiveFilterSelections:!0},{display:"Clear Active Selections",icon:"fa fa-times-circle",itemKey:"clearAllFilters",isOpenSingleModal:!0,activeTabKey:""},{display:"Save OppAlert Search",icon:"fa fa-save",itemKey:"saveSearch",isOpenSingleModal:!0,activeTabKey:""},{display:"My Saved OppAlert Searches",icon:"fa fa-list-ol",itemKey:"applySavedSearch",isOpenSingleModal:!0,activeTabKey:""},{display:"Recent OppAlert Searches",icon:"fa fa-archive",itemKey:"recentSearch",isOpenSingleModal:!0,activeTabKey:""}],Ta={display:"Manage Topics",icon:"fa fa-tasks",itemKey:"manageTopics",isOpenSingleModal:!1,activeTabKey:"tab-topic"},Ua={display:"ListMatch",icon:"fa fa-paste",itemKey:"listMatch",isOpenSingleModal:!0,activeTabKey:"",isListMatchItem:!0,tooltipNotification:"Match results from a previous import are available"};j.setGeography(m),Aa.geography=n.resolve(A()),Aa.oppAlertsTopicsGroupedByCategory=n.resolve(na()),Aa.refreshTopics=qa,Aa.activeCriteria={},Aa.canExport=!1,Aa.clearAllFilters=z,Aa.exportTopContentConsumers=F,Aa.getSearchCriteria=G,Aa.gridOptions=b.$defaultGrid("topContent",[],void 0,!0,!1),Aa.launchCriteriaModal=W,Aa.onRemove=E,Aa.onSelect=E,Aa.optionsLoading=!0,Aa.showLoading=!1,Aa.topicsLoading=!1,Aa.topic={selected:[],list:[]},Aa.countActiveCriteriaCompanies=J,Aa.countActiveCriteriaLocations=K,Aa.countActiveCriteriaIntents=M,Aa.countAllActiveCriteria=N,Aa.recentSearch=O,Aa.saveThisSearch=T,Aa.applySavedSearch=U,Aa.isDateRangeTooBig=X,Aa.changeDateOption=ea,Aa.showSearchResult=ha,Aa.opportunityMinDateLimit=null,Aa.opportunityEndDate={minValue:null,maxValue:null},Aa.filterDebounce=p.filterDebounce,Aa.dateRangeOption=Oa,Aa.selectedRows=[],Aa.activeTab="tab-search",Aa.havingOppAlertManageTopic=c.Session.account.havingOppAlertManageTopic&&c.Session.navigation.$has("oppalert_manage_topic"),Aa.manageTopicInfo={isChange:!1,currentTab:"current"},Aa.loadUserTopicPage=ga,Aa.activeSearchPage=ja,Aa.oppAlertScoreOptions=k.getOppAlertScoreOptions(),Aa.searchResults={},Aa.isOppAlertTopicEmpty="true"==s,Aa.viewSelectedCompanies=sa,Aa.viewAllCompanies=ta,Aa.hamburgerTime=xa(),Aa.handelNavClick=va,C(),d.$watch(function(){return Aa.activeCriteria},function(a,b){a&&!_.isEqual(a,b)&&(Aa.selectedRows=[],Aa.secondarySortTypeLoaded&&delete Aa.secondarySortType,Ba(!1))},!0),d.$on("event:reSearchOppAlert",function(a,b,c){var d="topic"===b;("date"===b||c)&&(Y(),"date"===b&&Aa.dateRangeOption===Oa&&(Aa.dateRangeOption=Pa)),c?(aa(),Aa.topic.list=Ha):Ba(d===!0?!1:!1)}),d.$on("listMatchNotification",function(a,b){var d=u.hasUnviewedListMatchNotification(b,!0);c.listMatchNotifications=d,Aa.isListMatchRedDotShown=d}),d.$on("viewEntitiesInAdvancedSearchOrOppAlert",function(a,b){b.listMatchResultIds.ids&&b.listMatchResultIds.ids.length&&b.listMatchResultIds.isCompany&&(Aa.activeCriteria.companyIds=_.uniq(Aa.activeCriteria.companyIds.concat(b.listMatchResultIds.ids),"id"))}),v.checkNotifications(),Aa.getCacheSelected=function(){return Aa.selectedRows},c.$on("$stateChangeStart",function(a,b,c,d){if("view_top_content_consumers"===d.name){if(!Aa.manageTopicInfo.isChange||Qa)return;Qa=!1,oa(function(){Qa=!0,q.go(b.name,c)}),a.preventDefault()}}),h.addEventListener("resize",function(){Aa.hamburgerTime=xa()}),angular.element(function(){Aa.hamburgerTime=xa()})}angular.module("dorgEuiApp").controller("TopContentConsumerCtrl",a),a.$inject=["$embeddedUtils","$grid","$rootScope","$scope","$stateParams","$timeout","$uibModal","$window","downloadExportService","SearchService","TopContentConsumerService","uiGridConstants","searchCriteriaViewResource","$q","$filter","$SearchStaticFactory","$state","Flash","isOppAlertTopicEmpty","$ga","bulkMatchService","NotificationService","navigation","UserService","singleModalService"]}(),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("view_top_content_consumers",{url:"/oppalerts?company&oppAlertCategories",params:{oppAlertCategories:null,company:null,goToManageTopic:null,savedSearchId:null,listMatchResultIds:null,companyInfo:null,secondarySortType:null},templateUrl:"app/views/topcontentconsumer/top-content-consumer.html",controller:"TopContentConsumerCtrl",controllerAs:"oppAlertsVm",resolve:{$title:function(){return"OppAlerts"},searchCriteriaViewResource:["SearchService",function(a){return a.getSearchCriteriaResource().then(function(a){return a})}],isOppAlertTopicEmpty:["TopContentConsumerService","$rootScope","UserService",function(a,b,c){return!c.canAccessTopContentConsumers()||a.checkOppAlertSubscriptionWithNoTopic().then(function(a){return a})}]},onEnter:["TopContentConsumerService",function(a){a.enterOppAlerts()}]}).state("redirectOppAlertSavedSearch",{url:"/oppalertsavedsearch/:id?secondarySortType",controller:["id","secondarySortType","TopContentConsumerService","UserService",function(a,b,c,d){c.goToOppAlertPage({savedSearchId:a,secondarySortType:b})}],resolve:{id:["$stateParams",function(a){return a.id}],secondarySortType:["$stateParams",function(a){return a.secondarySortType}]}}).state("redirectOppAlertCompany",{url:"/oppalertcompany?id&displayName",controller:["$state","$stateParams","TopContentConsumerService",function(a,b,c){c.goToOppAlertPage({companyInfo:{id:Number(b.id),displayName:b.displayName}})}]})}]),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(a,b){var c=new Date(a).valueOf(),d=new Date(b).valueOf(),e=moment(d).subtract(6,"months").valueOf();return c<e}function k(){return ca}function l(a){ca=a}function m(a){return a&&a.data?a.data:[]}function n(){return c.get(X()+"filterOptionsbyType/1").then(m,m)}function o(){return c.get(X()+"topics").then(function(a){return a.data},function(){return[]})}function p(){return c.get(X()+"checkOppAlertSubscriptionWithNoTopic").then(function(a){return a.data},function(){return[]})}function q(a){return console.warn("There was an error:",a),{data:{status:{id:0}}}}function r(){return e.all({categorySelectOption:n()}).then(function(a){return a.industrySelectOption=[],a.categorySelectOption<1&&(a.topicSelectOption=[]),a})}function s(a){var b=a.sortField?a.sortField.replace(" ","_"):"",d="api/rest/top_content_consumers/count?page="+a.page+"&size="+a.size+"&sortField="+b+"&sortOrder="+a.sortOrder;return c.post(d,a.body)}function t(a){var b=a.sortField?a.sortField.replace(" ","_"):"",d="api/rest/top_content_consumers/?page="+a.page+"&size="+a.size+"&sortField="+b+"&sortOrder="+a.sortOrder;return a.secondarySortType&&(d+="&secondarySortType="+a.secondarySortType),c.post(d,a.body).then(function(a){return e.all({data:a.data||[],page:a.data.page||void 0})},m)}function u(b){var c=angular.copy(b),d=a.$getD(c);if(!d.length)return c;for(var e=0,f=d.length;e<f;++e)d[e].$$isIdentical=angular.equals(d[e].activeResearcherTopics,d[e].oppAlertTopics),v(d[e].oppAlertTopics),v(d[e].activeResearcherTopics);return c}function v(a){for(var b=0;b<a.length;b++)b&&_.where(a,{mlTopic:a[b].mlTopic,percent:a[b].percent}).length>1&&(a[b]={hide:!0})}function w(e,h){var i=X()+"exportTopContentConsumers?formatOption="+h;return c.post(i,e).then(function(e){b.track("Directive","Export","Download Started, Location Src: "+g.current.name);var h,i=_.random(100,1e5),j=function(){c.get(a.$fetchLink(e.data,"progress")).then(function(a){a.data.percentDone>99?(d.cancel(h),f.$broadcast("event:downloadProgress",{id:i,data:{percent:a.data.percentDone,filePath:a.data._links.file.href}}),b.track("Directive","Export","Download Completed")):f.$broadcast("event:downloadProgress",{id:i,data:{percent:a.data.percentDone}})},function(){d.cancel(h),f.$broadcast("event:downloadProgress",{id:i,data:{percent:-1}})})};h=d(j,1e3)},q)}function x(a){if(_.isEmpty(a))return!0;if(k())return!1;var b,c,d=["employeeGrowth","fortuneRank","globalRank","numEmployees","revenue","revenueGrowth","numLocations","numHospitalBeds","yearFounded"];for(b=0;b<d.length;++b)if(c=d[b],a[c].minValue||a[c].maxValue)return!1;if(void 0!==a.departments){var e=_.values(a.departments);for(b=0;b<e.length;++b)if(c=e[b],0!==c.numEmployees.minValue||0!==c.numEmployees.maxValue)return!1}var f=["companyIds","industryIds","ownershipTypeIds","businessModelIds","naicsCodes","sicCodes","topicIds"];for(b=0;b<f.length;++b)if(c=f[b],!_.isEmpty(a[c]))return!1;if(a.geo){var g=["areas","continents","countries","metro","postalCodeCenter","radialDistance","postalCodes","counties","states"];for(b=0;b<g.length;++b)if(c=g[b],!_.isEmpty(a.geo[c]))return!1}return!(_.has(a,"score")&&a.score.minValue>60)}function y(b){var d=a.$self(b);return c.get(d,{params:{pageType:Z}}).then(function(a){return a.data})}function z(a,b){var d={};d.label=b,d.searchCriteria=a,d.pageType=Z,c.post($,d)}function A(){return c.get($,{params:{pageType:Z}}).then(function(b){var c=a.$getD(b.data);return c?_.sortBy(c,"updateTime"):[]},function(){return[]})}function B(b){return c.post(aa,b,{params:{pageType:Z}}).then(function(b){return a.$getD(b.data)},function(a){return a})}function C(b){return c.put(aa,b,{
params:{pageType:Z}}).then(function(b){return a.$getD(b.data)},function(a){return a})}function D(a,b){return c.get(a,{params:{subscriptionName:b}}).then(function(a){return!1},function(a){return!0})}function E(a){return c.get(f.Session.navigation.$href("checkValidName"),{params:{name:a,pageType:Z}}).then(function(a){return!1},function(a){return!0})}function F(a){return c.get(aa+"/"+a,{params:{pageType:Z}}).then(function(a){return a.data},function(){return[]})}function G(){return c.get(aa,{params:{pageType:Z}}).then(function(b){return a.$getD(b.data)||[]})}function H(){return c.get(da).then(function(b){return c.get(a.$fetchLink(b.data,"subscriptionLists")+"/supportdata").then(function(a){return a.data})})}function I(a,b,c,d){var e={id:0,name:c.subscriptionName,sourceListType:c.sourceListType,sourceListId:b,scheduleType:c.scheduleType.id,subscriptionType:c.subsctiptionType.id};ba.$saveSubscription(a,e).then(function(a){if(angular.isDefined(a.status)&&a.status>=300){if(400===a.status&&a.data.errors){var b="";_.each(a.data.errors,function(a){b=dorgValidation.getErrorMessage(a.code),_.includes(c.subscriptionNameErrors,b)?_.pullAt(c.subscriptionNameErrors,_.indexOf(c.subscriptionNameErrors,b)):c.subscriptionNameErrors.push(b)})}return 422===a.status?c.subscriptionErrorMessage="There is already a List with this name. Please use a unique name.":c.subscriptionErrorMessage="Something went wrong with this request. Please try again.",c.isSaving=!1,!1}d.close(),h.create("success","Search and Subscription Successfully saved","flash")})}function J(){c.get("api/rest/top_content_consumers/track")}function K(a){return!!a&&(!!a.minValue||!!a.maxValue)}function L(a){return c.post(X()+"getMostRecentDataDate",a).then(function(a){return a.data})}function M(){return ea}function N(a){ea=_.cloneDeep(a)}function O(){return c.get("api/rest/top_content_consumers/managetopic").then(function(a){return a.data})}function P(a){return c.get("api/rest/top_content_consumers/managetopic/previousTopics",{params:a}).then(function(a){return a.data})}function Q(a,b,d,e,f){var g={searchText:a,categoryId:b,excludedTopicIds:d};return c.post("api/rest/top_content_consumers/managetopic/searchTopics?page="+e+"&size="+f,g).then(function(a){return a.data})}function R(a,b,d){var e={searchText:a,categoryId:b,excludedTopicIds:d};return c.post("api/rest/top_content_consumers/managetopic/getTopicNoPaging",e).then(function(a){return a.data})}function S(a){return c.post("api/rest/top_content_consumers/managetopic/update",a).then(function(a){return{success:!0}},function(){return{success:!1}})}function T(){c.post(X()+"dismissOppAlertSubscriptionExpiredWarningPopup")}function U(a){var b=a||{};return b.opportunityEndDate={minValue:null,maxValue:null},b.opportunityMostRecentDate=!0,b}function V(a){return c.post(X()+"searchCompaniesHavingOppAlert",a).then(function(a){return a.data})}function W(a){var b="view_top_content_consumers",c=a||{};i.canAccessTopContentConsumers()||(b=i.getDefaultLandingPage(),c={}),g.go(b,c)}function X(a){var b=null;return i.canAccessTopContentConsumers()&&(b=f.Session.navigation.$href("view_top_content_consumers")+"/"),b}function Y(){return{minScore:60,maxScore:100}}var Z="OPPALERT",$=f.Session.navigation.$href("recentSearches"),aa=f.Session.navigation.$href("savedSearches"),ba=this,ca=!1,da=f.Session.navigation.$href("viewMyLists"),ea={minValue:null,maxValue:null};ba.getViewResource=r,ba.searchCountTopContentConsumer=s,ba.searchTopContentConsumer=t,ba.getFilterTCC=u,ba.exportTopContentConsumers=w,ba.resultsCounts={tab:"",count:0},ba.isEmptyCriteria=x,ba.isDateRangeTooBig=j,ba.hasDateRangeChanged=k,ba.setDateRangeChanged=l,ba.saveOppAlertRecentSearch=z,ba.getOppAlertRecentSearch=y,ba.getOppAlertRecentSearches=A,ba.saveThisSearch=B,ba.getOppAlertSavedSearch=F,ba.getOppAlertSavedSearchs=G,ba.overWriteThisSearch=C,ba.subscriptionSuppportData=H,ba.createSubscription=I,ba.checkDuplicateSubscriptionName=D,ba.checkDuplicateSavedSearchName=E,ba.enterOppAlerts=J,ba.hasDateRangeValue=K,ba.getMostRecentDataDate=L,ba.getDateRange=M,ba.setDateRange=N,ba.getTopics=o,ba.getUserManageTopicData=O,ba.getAvailableTopicsByCriteria=Q,ba.saveCustomerTopics=S,ba.getPreviousTopics=P,ba.getAvailableTopicsByCriteriaNoPaging=R,ba.checkOppAlertSubscriptionWithNoTopic=p,ba.dismissOppAlertSubscriptionExpiredWarning=T,ba.setDefaultOppAlertSearchCriteria=U,ba.searchCompaniesHavingOppAlert=V,ba.goToOppAlertPage=W,ba.getOppAlertScoreOptions=Y,this.$saveSubscription=function(b,d){return c.post(b,d).then(function(b){return a.$getD(b.data)},function(a){return a})},this.getSavedSearchSubscriptionBySourceListId=function(a){return c.get(f.Session.navigation.$href("getSavedSearchSubscriptionBySourceListId"),{params:{sourceListId:a,pageType:Z}}).then(function(a){return a.data},function(a){return[]})}}angular.module("dorgEuiApp").service("TopContentConsumerService",a),a.$inject=["$embeddedUtils","$ga","$http","$interval","$q","$rootScope","$state","Flash","UserService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l){function m(c){a.Session.resource=c,b.BANNER_IMG_PATH=c.$href("cdnBaseUrl")+g.BANNER_IMG_PATH,t(b.BANNER_IMG_PATH)}function n(){c.go("login")}function o(){b.authenticationError=!1,b.twoFactorCodeExpired=!1,b.twoFactorCodeInvalidCookie=!1;var a=document.getElementById("code").value;b.invalidPattern=null===a.match(/^[0-9]{0,5}$/),b.invalidPattern||a.length!=b.CODE_LENGTH||(b.code=a,p())}function p(){b.attemptingVerify=!0;var d=_.isUndefined(b.code)?document.getElementById("code").value:b.code;k.verifyCode(d).then(function(){a.Session.resource=a.Session.resourceTemp,l.loginConfirmed(a.Session.resource)}).catch(function(d){switch(b.attemptingVerify=!1,b.twoFactorCodeExpired=!1,b.twoFactorCodeInvalidCookie=!1,b.authenticationError=!1,b.accountLocked=!1,b.tooManyAttempts=!1,b.hideTwoFactorForm=!1,d.status){case 401:"max-concurrent-sessions"===d.headers("authentication-failure-detail")&&a.$broadcast("event:auth-loginRequired",{bounceMsg:"-2",status:"CONCURRENT_USER"}),c.go("login",{status:"CONCURRENT_USER"});break;case 403:c.go("login");break;case 400:"CODE_EXPIRED"===d.headers("two_factor_failed")?b.twoFactorCodeExpired=!0:"INVALID_COOKIE"===d.headers("two_factor_failed")?b.twoFactorCodeInvalidCookie=!0:b.authenticationError=!0;break;case 429:"ACCOUNT_LOCKED"===d.headers("two_factor_failed")?(b.accountLocked=!0,b.tooManyRequests=!1):b.tooManyAttempts=!0,b.hideTwoFactorForm=!0}})}function q(){b.attemptingResend=!0,k.resendCode().then(function(){b.attemptingResend=!1}).catch(function(d){switch(b.attemptingResend=!1,d.status){case 401:"max-concurrent-sessions"===d.headers("authentication-failure-detail")&&a.$broadcast("event:auth-loginRequired",{bounceMsg:"-2",status:"CONCURRENT_USER"}),c.go("login",{status:"CONCURRENT_USER"});break;case 403:c.go("login");break;case 400:b.errorResending=!0;break;case 429:b.tooManyRequests=!0}})}function r(){e.open({templateUrl:"app/views/two-factor-auth/two-factor-auth-verify/two-factor-auth-verify-email-help.modal.html"})}function s(a){return"url('"+a+"')"}function t(a){y=y||$(w),y&&y[0]&&a&&(y[0].style.backgroundImage=s(a))}if(a.isLoginPage=!0,a.Session&&a.Session.authenticated)return void c.go("main");if(d.tfaMethod)j.putObject("tfaMethod",d.tfaMethod),b.tfaMethod=d.tfaMethod;else if(b.tfaMethod=j.getObject("tfaMethod"),!b.tfaMethod||!b.tfaMethod.value)return void c.go("login");var u="loginRightPanelContainerId",v="loginRightPanelContentId",w="#"+u,x="#"+v,y=null;b.loginRightPanelContainerId=u,b.loginRightPanelContentId=v,h.$get("api").then(m),b.CODE_LENGTH=5,b.attemptingVerify=!1,b.attemptingResend=!1,b.authenticationError=!1,b.errorResending=!1,b.invalidPattern=!1,b.tooManyRequests=!1,b.goLogin=n,b.shouldSendCode=o,b.verifyCode=p,b.resendCode=q,b.displayEmailHelp=r,angular.element(document).ready(function(){y=$(w),i.getLoginRightPanelContent().then(function(a){var b=$(x);b&&b[0]&&a&&(b[0].innerHTML=a)})})}angular.module("dorgEuiApp").controller("TFAVerifyCtrl",a),a.$inject=["$rootScope","$scope","$state","$stateParams","$uibModal","authentication","dorgConfig","halClient","LoginService","$cookies","TwoFactorAuthVerifyService","authService"]}(),function(){"use strict";angular.module("dorgEuiApp").config(["$stateProvider","dorgConfig",function(a,b){a.state("two-factor-auth-verify",{url:"/twofactorauthverify",templateUrl:"app/views/two-factor-auth/two-factor-auth-verify/two-factor-auth-verify.html",controller:"TFAVerifyCtrl",params:{tfaMethod:null},resolve:{$title:function(){return"Two Factor Authentication Verification"}},onEnter:[function(){}],onExit:function(){}})}])}(),function(){"use strict";function a(a,b){return{verifyCode:function(b){return a.post("twoFactor/authenticate/"+b,{ignoreAuthModule:"ignoreAuthModule"})},resendCode:function(){return a.post("twoFactor/resendCode",{ignoreAuthModule:"ignoreAuthModule"})}}}angular.module("dorgEuiApp").service("TwoFactorAuthVerifyService",a),a.$inject=["$http","$q"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(c){a.Session.resource=c,b.BANNER_IMG_PATH=c.$href("cdnBaseUrl")+g.BANNER_IMG_PATH,s(b.BANNER_IMG_PATH)}function m(){b.attemptingSend=!0;var e=_.isUndefined(b.phonenumber)?document.getElementById("phonenumber").value:b.phonenumber;k.registerSms(e).then(function(a){c.go("two-factor-auth-verify",{tfaMethod:a.data})}).catch(function(e){switch(b.attemptingSend=!1,e.status){case 401:"max-concurrent-sessions"===e.headers("authentication-failure-detail")&&a.$broadcast("event:auth-loginRequired",{bounceMsg:"-2",status:"CONCURRENT_USER"}),d.status="CONCURRENT_USER",c.go("login",{status:"CONCURRENT_USER"});break;case 403:c.go("login");break;case 400:b.invalidPhoneNumber=!0}})}function n(){b.attemptingSend=!0,k.registerEmail().then(function(a){c.go("two-factor-auth-verify",{tfaMethod:a.data})}).catch(function(d){switch(b.attemptingSend=!1,d.status){case 401:"max-concurrent-sessions"===d.headers("authentication-failure-detail")&&a.$broadcast("event:auth-loginRequired",{bounceMsg:"-2",status:"CONCURRENT_USER"}),c.go("login",{status:"CONCURRENT_USER"});break;case 403:c.go("login")}})}function o(){c.go("login")}function p(){b.useSms=!1,b.useEmail=!0}function q(){b.useSms=!0,b.useEmail=!1}function r(a){return"url('"+a+"')"}function s(a){x=x||$(v),x&&x[0]&&a&&(x[0].style.backgroundImage=r(a))}if(a.isLoginPage=!0,a.Session&&a.Session.authenticated)return void c.go("main");var t="loginRightPanelContainerId",u="loginRightPanelContentId",v="#"+t,w="#"+u,x=null;b.loginRightPanelContainerId=t,b.loginRightPanelContentId=u,h.$get("api").then(l),b.useSms=!0,b.useEmail=!1,b.attemptingSend=!1,b.invalidPhoneNumber=!1,b.sendCodeSms=m,b.sendCodeEmail=n,b.goLogin=o,b.selectSms=q,b.selectEmail=p,angular.element(document).ready(function(){x=$(v),i.getLoginRightPanelContent().then(function(a){var b=$(w);b&&b[0]&&a&&(b[0].innerHTML=a)})})}angular.module("dorgEuiApp").controller("TFASMSCtrl",a),a.$inject=["$rootScope","$scope","$state","$stateParams","$uibModal","authentication","dorgConfig","halClient","LoginService","$cookies","TwoFactorAuthService"]}(),function(){"use strict";angular.module("dorgEuiApp").config(["$stateProvider","dorgConfig",function(a,b){a.state("two-factor-auth",{url:"/twofactorauth",templateUrl:"app/views/two-factor-auth/two-factor-auth.html",controller:"TFASMSCtrl",params:{method:"sms"},resolve:{$title:function(){return"Two Factor Authentication"}},onEnter:[function(){}],onExit:function(){}})}])}(),function(){"use strict";function a(a,b){return{registerSms:function(b){return a.post("twoFactor/registerSms/"+b,{ignoreAuthModule:"ignoreAuthModule"})},registerEmail:function(){return a.post("twoFactor/registerEmail",{ignoreAuthModule:"ignoreAuthModule"})}}}angular.module("dorgEuiApp").service("TwoFactorAuthService",a),a.$inject=["$http","$q"]}(),angular.module("dorgEuiApp").controller("UsageReportsController",["$scope","UsageReportsService","$uibModal","Flash","$today","$timeout",function(a,b,c,d,e,f){var g=function(a,b){return[a.split("/")[2],a.split("/")[0],a.split("/")[1]].join("")<=[b.split("/")[2],b.split("/")[0],b.split("/")[1]].join("")},h=b.$chunkData,i=[],j=5;a.isDateRange=!1,a.filterRunning=!1,a.date1=a.date2=e,a.usageReportsModel=b.$defaultGrid([]),a.$chartOptions=b.$chartOptions,a.$isChartDisplay=!1,a.$chartData=[],a.$chartApi=[],a.$rowSelection=[],a.breakdownLoginsOpen=!0,a.$chartData=b.compareData(),a.$compareOptions=[{displayName:"Logins",value:"logins"},{displayName:"Exports/Downloads",value:"downloads"},{displayName:"Quick Searches",value:"quickSearches"},{displayName:"Keyword Searches",value:"keywordSearches"},{displayName:"Company Pageviews",value:"companyViews"},{displayName:"Contact Pageviews",value:"personViews"},{displayName:"Alerts Sent",value:"alertsSent"}],a.$compareOptionsGraph=_.map(a.$compareOptions,"value"),a.$$testReGraph=function(){for(var b=a.$chartApi.getScope(),c=angular.copy(b.data),d=0,e=c.length;d<e;++d)c[d].disabled=a.$compareOptionsGraph.indexOf(c[d].$$baseKey)<0;b.api.updateWithData(c)},a.$toggleView=function(){a.$isChartDisplay=!a.$isChartDisplay,a.$isChartDisplay&&a.$chartApi.updateWithTimeout(1)},a.dateRangeFilter=function(){return""===this.date1||""===this.date2?void d.create("success","Please enter both a From and To date","fail"):void(g(this.date1,this.date2)?(a.filterRunning=!0,b.query(this.date1,this.date2).then(function(b){a.usageReportsModel.data=b,a.$chartData=h(b),_.size(b)<j?(a.$chartOptions.chart.stacked=!1,a.$chartApi.updateWithOptions(a.$chartOptions)):(a.$chartOptions.chart.stacked=!0,a.$chartApi.updateWithOptions(a.$chartOptions)),a.isDateRange=_.size(b)>0,a.filterRunning=!1,a.$rowSelection=i=[]})):d.create("success","Please enter dates in chronological order","fail"))},a.$chartSelected=function(){var b=a.usageReportsModel.api.selection.getSelectedRows();_.size(b)<j?(a.$chartOptions.chart.stacked=!1,a.$chartApi.updateWithOptions(a.$chartOptions)):(a.$chartOptions.chart.stacked=!0,a.$chartApi.updateWithOptions(a.$chartOptions)),a.$chartData=b.length>0?h(b):a.$chartData},a.dateRangeClear=function(){var c=this;b.query(e,e).then(function(b){a.usageReportsModel.data=b,a.isDateRange=b.length>0,c.date1=c.date2=e})}}]).controller("ManageReportsController",["$scope","UsageReportsService",function(a,b){a.summary=[],a.$graphSelect="Graph Selected",a.$graphAll="Graph All",a.$backToChart="Back to Grid",a.summaryOptions=b.$managerChartOptions,a.$charts=b.$managerChartDataStructure,a.dataAvailable=!1;var c=b.$chunkDataSummary;b.query2().then(function(b){a.summary=b,a.dataAvailable=!0}),a.$togglePanel=function(){var b=arguments[0],d=a.summary[b];arguments.length>1&&(d=d[arguments[1]]),a.$charts[arguments[0]].tracked.length>0&&1===arguments.length&&(d=a.$charts[arguments[0]].tracked),a.$charts[b].isToggled=!a.$charts[b].isToggled,a.$charts[b].isToggled&&(a.$charts[b].data=c(d),a.$charts[b].api.updateWithTimeout(1))},a.$toggleTrackedSelection=function(b,c,d){var e=_.indexOf(a.$charts[b].tracked,c);a.summary[b][d].isSelected=!a.summary[b][d].isSelected,e<0?a.$charts[b].tracked.push(c):a.$charts[b].tracked.splice(e,1)}}]),angular.module("dorgEuiApp").controller("usageReportsController",["featureFlagService","$rootScope","$scope","$selectionOptions","$selectionOptionsSelected","$timeout","downloadExportService","UsageReportsService","UsageReportsStatic","$serverDate",function(a,b,c,d,e,f,g,h,i,j){function k(){var a,b;if(r(),window.localStorage){if(window.localStorage.compareOptionsSelections){try{a=JSON.parse(window.localStorage.compareOptionsSelections)}catch(a){}a&&a.length&&(x.compareOptionsSelections=a)}if(window.localStorage.fullDataOptionsSelection){try{b=JSON.parse(window.localStorage.fullDataOptionsSelection)}catch(a){}b&&b.length&&(x.fullDataOptionsSelection=b)}}f(function(){p(),f(t)}),g.$formats().then(function(a){a.length&&(x.canExport=!0)})}function l(a,b){a&&!_.isEqual(a,b)&&window.localStorage&&(window.localStorage.compareOptionsSelections=JSON.stringify(a))}function m(a,b){a&&!_.isEqual(a,b)&&window.localStorage&&(window.localStorage.fullDataOptionsSelection=JSON.stringify(a))}function n(a){this.api=a,this.api.selection.on.rowSelectionChanged(c,function(a){z.indexOf(a.entity.userId)<0?z.push(a.entity.userId):z.splice(z.indexOf(a.entity.userId),1)}),this.api.selection.on.rowSelectionChangedBatch(c,function(a){for(var b=0,c=a.length;b<c;++b)z.indexOf(a[b].entity.userId)<0&&a[b].isSelected?z.push(a[b].entity.userId):a[b].isSelected||z.splice(z.indexOf(a[b].entity.userId),1)}),this.api.core.on.rowsRendered(c,function(){if(z.length)for(var a=0,b=z.length;a<b;++a)for(var c=0,d=this.grid.rows.length;c<d;++c)this.grid.rows[c].entity.userId===z[a]&&(this.grid.rows[c].isSelected=!0)})}function o(){var a=x.compareData;angular.equals(x.compareDateRangeFrom,E)&&angular.equals(x.compareDateRangeTo,D)?(a=A(a,x.compareOptionsSelections),x.compareData=a,x.compareDataGraphApi.updateWithData(a)):(E=angular.copy(x.compareDateRangeFrom),D=angular.copy(x.compareDateRangeTo),p())}function p(){x.isCompareRegraphing=!0,h.getCompareRange(x.compareDateRangeFrom,x.compareDateRangeTo).then(function(a){x.isCompareRegraphing=!1,f(function(){x.compareData=A(a,x.compareOptionsSelections,x.compareOptions),f(function(){x.compareDataGraphApi.updateWithData(A(a,x.compareOptionsSelections,x.compareOptions))},100)},100)},function(){x.isCompareRegraphing=!1})}function q(){x.fullDataGraphData=A(x.fullDataGraphData,x.fullDataOptionsSelection)}function r(){h.getAdditionalInformation().then(function(a){x.additionalInformationDisplay=a})}function s(){if(x.fullDataGraphView=!x.fullDataGraphView,x.fullDataGraphView){var a=x.fullDataContainer.api.selection.getSelectedRows();x.fullDataGraphData=a.length?A(h.$chunkData(x.fullDataOptions,a),x.fullDataOptionsSelection):y,x.fullDataGraphApi.updateWithTimeout(1)}}function t(){x.fullDataRunningReport=!0,h.query(x.fullDateRangeFrom,x.fullDateRangeTo).then(function(a){x.fullDataContainer.data=a,x.fullDataGraphData=A(h.$chunkData(x.fullDataOptions,h.setFullDataGraph(z,a)),x.fullDataOptionsSelection),y=angular.copy(x.fullDataGraphData)}).finally(function(){x.fullDataRunningReport=!1})}function u(a,b,c){var d,e;"compare"===a?(d="compareOptions",e="compareOptionsSelections"):(d="fullDataOptions",e="fullDataOptionsSelection"),c?_.each(x[d],function(a){_.includes(a.displayName,b)&&(_.includes(x[e],a.value)||x[e].push(a.value))}):x[e]=_.filter(x[e],function(a){return!_.includes(a.toLowerCase(),b.toLowerCase())})}function v(a){x.compareOptionsOpen===a?x.compareOptionsOpen=null:x.compareOptionsOpen=a}function w(a){x.individualOptionsOpen===a?x.individualOptionsOpen=null:x.individualOptionsOpen=a}var x=this,y=[],z=[],A=h.setRegraph,B=moment(),C=moment(),D=B.format("L"),E=B.subtract(30,"day").format("L");x.breakdownLoginsOpen=!0,x.canExport=!1,x.flag=!1,x.fullDataRunningReport=!1,x.fullDataGraphView=!1,x.canManageUsers=b.Session.navigation.$has("view_users"),x.compareDataGraphApi={},x.breakdownDataGraphApi={},x.fullDataGraphApi={},x.fullDataGraphData=[],x.additionalInformationDisplay={},x.compareDateRangeTo=D,x.compareDateRangeFrom=E,x.minDate=new Date(2016,6,15),x.fullDateRangeTo=C.format("L"),x.fullDateRangeFrom=C.format("L"),x.compareData=[],x.fullDataContainer=h.$defaultGrid(),x.compareOptionsOpen="discoverOrg",x.compareOptionsAllSelections=angular.copy(i.compareOptionsBooleans),x.compareDataGraphOptions=i.compareOptionsChart,x.compareOptions=angular.copy(d),x.compareOptionsSelections=angular.copy(e),x.individualOptionsOpen="discoverOrg",x.fullDataOptionsAllSelections=angular.copy(i.compareOptionsBooleans),x.fullDataOptionsGraph=i.fullDataOptionsGraph,x.fullDataOptions=angular.copy(d),x.fullDataOptionsSelection=angular.copy(e),x.compareDataRegraph=o,x.applyFullDateRange=t,x.fullDataRegraph=q,x.fullDataToggleView=s,x.fullDataContainer.onRegisterApi=n,x.selectAllThatInclude=u,x.setCompareOptionsOpen=v,x.setIndividualOptionsOpen=w,x.serverDate=j.data,c.$watch("vm.compareOptionsSelections",l,!0),c.$watch("vm.fullDataOptionsSelection",m,!0),this.$onInit=function(){x.flag=a.findFeatureFlag(null,"usage_reports"),a.getFeatureFlags().then(function(b){x.flag=a.findFeatureFlag(b.data,"usage_reports")}).finally(function(){x.flag?r():k()})}}]),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("view_usage_reports",{abstract:!0,url:"/usage-reports",templateUrl:"app/views/usage-reports/usage-reports.html",controller:["$scope","UsageReportsService","$state",function(a,b,c){var d="UserReports";"view_usage_report.manage"===c.current.name&&(d="ManagerReports"),a.$activeTab=d,a.$pages=b.$tabs,a.$setTab=function(b,d){a.$activeTab=d,c.transitionTo(b)}}],resolve:{$title:[function(){return"Usage Reports"}]},onEnter:["UsageReportsService",function(a){a.trackEvent()}]}).state("view_usage_report",{parent:"view_usage_reports",url:"",controller:"usageReportsController",templateUrl:"app/views/usage-reports/partials/usage.tpl.html",resolve:{$title:function(){return"User Reports"},$selectionOptions:["UsageReportsService",function(a){return a.getCompareDataPoints()}],$serverDate:["UsageReportsService",function(a){return a.getServerDate()}],$selectionOptionsSelected:[function(){return["discoverOrgLogins","discoverOrgSessions"]}]},controllerAs:"vm"}).state("view_usage_report.manage",{parent:"view_usage_reports",url:"/manage",controller:"ManageReportsController",templateUrl:"app/views/usage-reports/partials/manage.tpl.html",resolve:{$title:function(){return"Manager Reports"}}})}]),angular.module("dorgEuiApp").service("UsageReportsService",["$rootScope","$q","$http","$grid","Flash","$embeddedUtils","$filter","UsageReportsStatic",function(a,b,c,d,e,f,g,h){var i=[],j=[],k=[];this.query=function(d,e,g){d=d||"",e=e||"",g||(g="usageGridData");var h={},i=a.Session.navigation.$href(g),j=b.defer();return(d||e)&&(h.params={dateFrom:d,dateTo:e}),_.isNull(i)?(j.resolve([]),j.promise):c.get(i,h).then(function(a){return f.$getD(a.data)||[]},function(){return[]})},this.query2=function(){return c.get("api/rest/usagetracks/summary").then(function(a){return a.data||[]},function(){return[]})},this.trackEvent=function(){c.get(a.Session.navigation.$href("track_usage_report_enter"))},this.getAdditionalInformation=function(){return c.get(a.Session.navigation.$href("companyProfile")).then(function(a){return a.data||{}},function(){return{}})},this.$chunkData=function(a,b){if(_.size(i)<1)i=angular.copy(a),_.each(i,function(a,b){j.push({__baseKey:a.value,key:a.displayName,values:[]})});else for(var c=0,d=Object.keys(i).length;c<d;++c)j[c].values=[];var e=j;return _.each(b,function(a){_.each(e,function(b,c){e[c].disabled=!1,e[c].values.push({x:a.userFullName,y:a[b.__baseKey]||0})})}),e},this.getCompareRange=function(a,b){var c=moment(a,"MM/DD/YYYY"),d=moment(b,"MM/DD/YYYY");return this.query(c.format("L"),d.format("L"),"userChartData").then(function(a){var b=angular.copy(a);return _.each(b,function(a){a.values.length||(a.disabled=!0)}),b})},this.setCompareDataPoints=function(a){},this.getCompareDataPoints=function(){return c.get(a.Session.navigation.$href("usageTrackFields")).then(function(a){a=f.$getD(a.data);var b=[];return _.each(a,function(a){b.push({hasData:!0,displayName:a.key,value:a.__baseKey})}),b})},this.setFullDataGraph=function(a,b){b=angular.copy(b);var c=a.length,d=b.length,e=[];if(!c||c>=d)return b;for(var f=0;f<c;++f)for(var g=0;g<d;++g)a[f]===b[g].userId&&e.push(b[g]);return e=_.sortBy(e,"userFullName")},this.setRegraph=function(a,b,c){c=c||[];for(var d=angular.copy(a),e=0,f=d.length;e<f;++e){if(d[e].disabled=!d[e].values.length||b.indexOf(d[e].__baseKey)<0,c.length){var g=_.findIndex(c,function(a){return a.value===d[e].__baseKey});c[g].hasData=!!d[e].values.length}if(!d[e].values.length){var h=_.findIndex(b,function(a){return a===d[e].__baseKey});h>-1&&b.splice(h,1)}}return b.length?d:[]},this.$managerChartOptions={chart:{stacked:!1,type:"multiBarChart",height:550,margin:{top:20,right:20,bottom:60,left:55},staggerLabels:!0,showValues:!0,transitionDuration:500}},this.$managerChartDataStructure={loginUsage:{api:[],isToggled:!1,data:[],tracked:[]},featureUtilization:{api:[],isToggled:!1,data:[],tracked:[]},trainingSupportUtilization:{api:[],isToggled:!1,data:[],tracked:[]}},this.$chunkDataSummary=function(a){k=[{__baseKey:"duration",key:"Duration",values:[]},{__baseKey:"month",key:"Month",values:[]},{__baseKey:"quarter",key:"Quarter",values:[]}];var b=k;return _.has(a,"month")?_.each(k,function(c,d){b[d].values.push({x:a.label,y:a[b[d].__baseKey]})}):_.each(a,function(a){_.isObject(a)&&_.each(b,function(c,d){b[d].values.push({x:a.label,y:a[c.__baseKey]})})}),b},this.$defaultGrid=function(a){var b=d.$defaultGrid("usageReports",a);return b.enableRowSelection=!1,b},this.$tabs={tabs:{UserReports:{name:"User Reports",ico:"",route:"view_usage_report"}},tplBase:"src/app/views/usage-reports/partials/"},this.getServerDate=function(){return c.get("api/rest/usagetracks/serverDate")}}]),angular.module("dorgEuiApp").factory("UsageReportsStatic",function(){var a={};return a.compareOptionsBooleans={discoverOrg:0,salesforce:0,bullhorn:0},a.compareOptionsChart={chart:{type:"lineChart",height:450,margin:{top:20,right:55,bottom:55,left:75},useInteractiveGuideline:!0,transitionDuration:500,showControls:!1,showLegend:!1,xAxis:{axisLabel:"",staggerLabels:!0,tickFormat:function(a){return new Date(a).toDateString()}},yAxis:{axisLabel:"",tickFormat:function(a){return d3.format(",d")(a)}}}},a.fullDataOptionsGraph={chart:{stacked:!0,type:"multiBarChart",height:550,margin:{top:20,right:10,bottom:125,left:75},reduceXTicks:!1,rotateLabels:90,showControls:!1,transitionDuration:500,showLegend:!1,xAxis:{axisLabel:""},yAxis:{axisLabel:"",tickFormat:function(a){return d3.format(",0f")(a)}}}},a}),angular.module("dorgEuiApp").controller("userListsBaseController",["$checkBulk","$scope","$state","$timeout","$uibModal","downloadExportService","Flash","userListsBaseModals","userListsBaseService",function(a,b,c,d,e,f,g,h,i){function j(){return m.listCounts.savedSearchLists+m.listCounts.oppAlertSavedSearchLists}function k(a){return a||q}function l(a,c,d){if(a){var e=i.getListActionMap();switch(c.action){case"clone":var f=_.max(m.listData[e[c.tab]],"id");c.tab===n&&d==i.getSecondListDataIndex()&&(f=_.max(m.listData.oppAlertSavedSearchLists,"id")),b.$broadcast("activateList",f,d);break;case"delete":if(c.tab===n){var g=m.activeList.searches,h=_.isEmpty(m.listData[e[c.tab]]),j=_.isEmpty(m.listData.oppAlertSavedSearchLists);h&&j?(m.activeList.searches=p,m.activeList.listDataIndex=q,b.$broadcast("activateList",m.activeList.searches,m.activeList.listDataIndex)):d==i.getFirstListDataIndex()&&!h&&!_.find(m.listData[e[c.tab]],{id:g})||d==i.getSecondListDataIndex()&&j?(m.activeList.searches=_.max(m.listData[e[c.tab]],"id"),m.activeList.listDataIndex=i.getFirstListDataIndex(),b.$broadcast("activateList",m.activeList.searches,m.activeList.listDataIndex)):(d==i.getFirstListDataIndex()&&h||d==i.getSecondListDataIndex()&&!j&&!_.find(m.listData.oppAlertSavedSearchLists,{id:g}))&&(m.activeList.searches=_.max(m.listData.oppAlertSavedSearchLists,"id"),m.activeList.listDataIndex=i.getSecondListDataIndex(),b.$broadcast("activateList",m.activeList.searches,m.activeList.listDataIndex))}}}}var m=this,n=i.savedSearchTabKey,o=0,p=-1,q=i.getFirstListDataIndex(),r=function(a){i.loadListData().then(function(b){m.listCounts.subscriptionLists=b.subscriptionLists.length,m.listCounts.savedSearchLists=b.savedSearchLists.length,m.listCounts.followPersonLists=b.followPersonLists.length,m.listCounts.followCompanyLists=b.followCompanyLists.length,m.listCounts.oppAlertSavedSearchLists=b.oppAlertSavedSearchLists.length,m.listData=b,d(a,0)})};m.canExport=!1,m.listData={},m.listCounts={},m.activeList={company:p,employee:p,searches:p,listDataIndex:q},m.listCounts.subscriptionLists=o,m.listCounts.savedSearchLists=o,m.listCounts.oppAlertSavedSearchLists=o,m.listCounts.followPersonLists=o,m.listCounts.followCompanyLists=o,m.listData.subscriptionLists=[],m.listData.savedSearchLists=[],m.listData.oppAlertSavedSearchLists=[],m.listData.followPersonLists=[],m.listData.followCompanyLists=[],m.OPPALERT_PAGE_TYPE=_.clone(i.oppAlertPageType),m.canBulkUploadPersons=a.$checkPersons(),m.canBulkUploadCompanies=a.$checkCompanies(),m.totalSavedSearchLists=j,m.getActiveListDataIndex=k,r(function(){window.localStorage&&(c.includes("user_lists_company")&&window.localStorage.companyActiveList&&!_.isNull(parseInt(window.localStorage.companyActiveList))&&_.find(m.listData.followCompanyLists,{id:parseInt(window.localStorage.companyActiveList)})&&b.$broadcast("activateList",_.find(m.listData.followCompanyLists,{id:parseInt(window.localStorage.companyActiveList)})),c.includes("user_lists_employee")&&window.localStorage.employeeActiveList&&!_.isNull(parseInt(window.localStorage.employeeActiveList))&&_.find(m.listData.followPersonLists,{id:parseInt(window.localStorage.employeeActiveList)})&&b.$broadcast("activateList",_.find(m.listData.followPersonLists,{id:parseInt(window.localStorage.employeeActiveList)})),c.includes("user_lists_searches")&&window.localStorage.searchesActiveList&&!_.isNull(parseInt(window.localStorage.searchesActiveList))&&_.find(m.listData.subscriptionLists,{id:parseInt(window.localStorage.searchesActiveList)})&&b.$broadcast("activateList",_.find(m.listData.subscriptionLists,{id:parseInt(window.localStorage.searchesActiveList)})))}),f.$formats().then(function(a){a.length&&(m.canExport=!0)}),b.$on("sidebarCollapsed:true",function(){m.sidebarCollapsed=!0}),b.$on("sidebarCollapsed:false",function(){m.sidebarCollapsed=!1}),b.$on("newListCreated",function(){r()}),b.$on("updateSubscriptions",function(){r()}),b.$on("listAction",function(a,c){var d,f=i.getListActionMap();switch(c.action){case"clone":var j=c.tab,k=i.getFirstListDataIndex(),o=c.lists,p=m.listData[f[c.tab]],q=null;c.tab===n&&_.isEmpty(o)&&!_.isEmpty(c.secondLists)&&(k=i.getSecondListDataIndex(),o=c.secondLists,p=m.listData.oppAlertSavedSearchLists,q=m.OPPALERT_PAGE_TYPE),d=e.open(h.cloneModal(j,o,p,q)),d.result.then(function(a){return!!a&&(g.create("success","List is successfully created.","flash"),void r(function(){l(!0,c,m.activeList.listDataIndex)}))});break;case"create":d=e.open(h.newListModal(c.tab,m.listData[f[c.tab]])),d.result.then(function(a){a&&(g.create("success","List is successfully created.","flash"),a.lastActivityDate=(new Date).getTime(),m.listData[f[c.tab]].push(a),m.listCounts[f[c.tab]]=m.listData[f[c.tab]].length,b.$broadcast("activateList",a))});break;case"delete":c.subscriptions=m.listData.subscriptionLists,c.tab!==n||_.isEmpty(c.secondLists)||(c.secondListsPageType=m.OPPALERT_PAGE_TYPE),d=e.open(h.deleteListModal(c)),d.result.then(function(a){_.isObject(a)?(g.create("success","All selected list(s) have been deleted.","flash"),r(function(){l(!0,c,m.activeList.listDataIndex)})):g.create("success","There was an issue removing the selected list(s).","fail")});break;case"merge":d=e.open(h.mergeModal(c.tab,c.lists,m.listData)),d.result.then(function(){g.create("success","Lists have been successfully merged.","flash"),r(function(){b.$broadcast("activateList",_.max(m.listData[f[c.tab]],"id"))})});break;case"rename":var p=m.listData[f[c.tab]],k=i.getFirstListDataIndex();c.tab===n&&_.isEmpty(c.lists)&&!_.isEmpty(c.secondLists)&&(k=i.getSecondListDataIndex(),p=m.listData.oppAlertSavedSearchLists,c.params={params:{pageType:m.OPPALERT_PAGE_TYPE}},c.lists=c.secondLists),d=e.open(h.renameListModal(c,p)),d.result.then(function(a){if(!_.isUndefined(a)&&_.isObject(a))if(g.create("success","List is successfully renamed.","flash"),a.lastActivityDate=(new Date).getTime(),c.tab===n){var b=a.savedSearch;k==i.getFirstListDataIndex()?_.findWhere(m.listData[f[c.tab]],{id:b.id}).displayName=b.displayName:_.findWhere(m.listData.oppAlertSavedSearchLists,{id:b.id}).displayName=b.displayName}else _.findWhere(m.listData[f[c.tab]],{id:a.id}).displayName=a.displayName})}})}]),angular.module("dorgEuiApp").directive("listTitle",[function(){var a=_.debounce(function(a){$(a).css("width",$(".above-grid").width()-$(".above-grid .pull-right").width()-30);
},500);return{link:function(b,c){a(c),$(window).resize(function(){a(c)})},restrict:"A"}}]),angular.module("dorgEuiApp").directive("listsSidebar",["$timeout",function(a){return{controller:["$parse","$q","$scope","$timeout","userListsBaseService",function(a,b,c,d,e){var f,g=b.defer(),h=!1,i=b.defer(),j=this;j.firstListDataIndex=e.getFirstListDataIndex(),j.secondListDataIndex=e.getSecondListDataIndex(),j.activeListIndex=j.firstListDataIndex,j.allSelected=!1,j.isSavedSearchesTab=!1,j.heading="",j.plural="",j.userLists=[],j.secondUserLists=[],j.listActions=[{key:"create",display:"Create New List"},{divider:!0},{key:"delete",display:"Delete List(s)"},{key:"merge",display:"Merge Lists"},{key:"clone",display:"Clone List"},{key:"rename",display:"Rename List"}],j.staticDynamicLists=[{key:"uploadedToCRM",display:"PLURAL Uploaded To CRM"},{key:"uploadedToMAT",display:"PLURAL Uploaded To MAT"},{key:"uploadedToSDR",display:"PLURAL Uploaded To SDR"},{key:"suppressed",display:"Blocked PLURAL"},{key:"withNotes",display:"PLURAL with Notes"}],j.$getAttributes=function(a,b){return g.resolve({attrs:a,scope:b}),i.promise},j.activateList=function(a,b){var d,e=_.cloneDeep(a);return b=b||j.firstListDataIndex,e&&e!==-(1/0)||(e="company"===f||"employee"===f?"uploadedToCRM":"noLists"),j.activeList!==e&&(j.activeListIndex=b,d="string"==typeof e,d?j.activeList=e:(j.activeList=e.id,window.localStorage&&(window.localStorage[f+"ActiveList"]=j.activeList.toString())),void c.$emit("loadList",{data:e,listDataIndex:b,static:d,tab:f}))},j.doListAction=function(a){return!(("clone"===a||"rename"===a)&&1!==j.numSelected()||("delete"===a||"merge"===a)&&j.numSelected()<1)&&void c.$emit("listAction",{action:a,lists:_.where(j.userLists,{selected:!0}),secondLists:_.where(j.secondUserLists,{selected:!0}),tab:f})},j.numSelected=function(){return _.where(j.userLists,{selected:!0}).length+_.where(j.secondUserLists,{selected:!0}).length},j.selectAll=function(){j.allSelected=!j.allSelected,_.each(j.userLists,function(a){a.selected=j.allSelected}),_.each(j.secondUserLists,function(a){a.selected=j.allSelected})},j.selectList=function(a){a.selected=!a.selected,_.where(j.userLists,{selected:!0}).length===j.userLists.length&&_.where(j.secondUserLists,{selected:!0}).length===j.secondUserLists.length?j.allSelected=!0:j.allSelected=!1},j.toggleCollapse=function(){j.sidebarCollapsed=!j.sidebarCollapsed,c.$emit("sidebarCollapsed:"+j.sidebarCollapsed)},c.$on("activateList",function(a,b,c){j.activateList(b,c)}),g.promise.then(function(b){f=b.attrs.listsSidebar;var g=_.throttle(function(){var c=a(b.attrs.activeList)(b.scope);j.activeListIndex=a(b.attrs.activeListIndex)(b.scope)||j.firstListDataIndex,j.isSavedSearchesTab="searches"===f;var g=_.where(j.userLists,{selected:!0}),k=_.where(j.secondUserLists,{selected:!0});if(j.userLists=a(b.attrs.listData)(b.scope),j.secondUserLists=a(b.attrs.secondListData)(b.scope)||[],!j.userLists.length&&!j.secondUserLists.length&&!h)return h=!0,!1;switch(_.each(j.userLists,function(a){g.forEach(function(b){if(b.id===a.id)return void(a.selected=!0)})}),_.each(j.secondUserLists,function(a){k.forEach(function(b){if(b.id===a.id)return void(a.selected=!0)})}),j.userLists.length>0&&_.where(j.userLists,{selected:!0}).length===j.userLists.length?j.allSelected=!0:j.allSelected=!1,c){case-1:var l=_.max(j.userLists,"id");if(l&&l!==-(1/0)||_.isEmpty(j.secondUserLists)||(j.activeListIndex=j.secondListDataIndex,l=_.max(j.secondUserLists,"id")),j.isSavedSearchesTab){var m=_.max(j.userLists,"id"),n=_.max(j.secondUserLists,"id");m&&m!==-(1/0)&&n&&n!==-(1/0)?e.getDefaultSaveSearchId(m.id,n.id).then(function(a){a.data.isSearchAdvSavedSearch?(j.activeListIndex=j.firstListDataIndex,l=m):(j.activeListIndex=j.secondListDataIndex,l=n),j.activateList(l,j.activeListIndex)}):l&&l!==-(1/0)||_.isEmpty(j.secondUserLists)||(j.activeListIndex=j.secondListDataIndex,l=_.max(j.secondUserLists,"id"))}j.activateList(l,j.activeListIndex);break;case-2:j.activateList("uploadedToCRM");break;case-3:j.activateList("uploadedToMAT");break;case-4:j.activateList("uploadedToSDR");break;case-5:j.activateList("suppressed");break;case-6:j.activateList("withNotes");break;default:var o=null;o=j.secondListDataIndex==j.activeListIndex?_.findWhere(j.secondUserLists,{id:c}):_.findWhere(j.userLists,{id:c}),j.activateList(o,j.activeListIndex)}d(i.resolve,0)},1e3);switch(f){case"company":j.heading="Company Lists",j.plural="Companies";break;case"employee":j.heading="Employee Lists",j.plural="Employees";break;case"searches":j.heading="Saved Searches",j.plural="Searches",j.staticDynamicLists=[],j.listActions.splice(0,2),j.listActions.splice(1,1)}_.each(j.staticDynamicLists,function(a){a.display=a.display.replace("PLURAL",j.plural)}),j.userLists.length||g(),c.$watch(function(){return a(b.attrs.listData)(b.scope)},g)})}],controllerAs:"vm",link:{pre:function(a,b,c){if(!c.listData||!c.listsSidebar||!c.activeList)throw new Error("The lists-sidebar directive required data-filled attributes: lists-sidebar, list-data, and active-list.")},post:function(b,c,d,e){var f=_.debounce(function(){var a=$("footer"),b=$(c).find(".user-lists-container");if(!_.isEmpty(a)&&!_.isEmpty(b)){var d=$(document).height(),e=$(window).height(),f=d>e,g="",h=5;if(f){var i=b.offset().top-$(window).scrollTop()+h;g=e-a.outerHeight()-i}else g=a.offset().top-b.offset().top-h;b.css("max-height",g)}},500);e.$getAttributes(d,b).then(function(){a(f,100)}),$(window).resize(f)}},replace:!0,restrict:"A",templateUrl:"app/views/user-lists/_shared/sidebar.base.tpl.html"}}]),angular.module("dorgEuiApp").service("userListsBaseModals",["userListsBaseService",function(a){var b={company:"followCompanyLists",employee:"followPersonLists",searches:"savedSearchLists"};this.checkUniqueListName=function(a,b){if(_.isUndefined(b)||_.isNull(b))return"";if(!_.isUndefined(a)){var c=_.findIndex(a,function(a){return a.displayName.toLowerCase()===b.toLowerCase().trim()});return c!==-1?"New List Name must be unique.":""}return""},this.cloneModal=function(c,d,e,f){return{controllerAs:"vm",controller:["$uibModalInstance","SearchService","userListsBaseModals","TopContentConsumerService",function(g,h,i,j){function k(a){return m.submittingData=!1,a.data.message.indexOf("user_list_name")>-1?m.formErrorMessage="New List Name must be unique.":m.formErrorMessage="Something went wrong with this request. Please try again.",!1}function l(){m.submittingData=!1,g.close(!0)}var m=this;switch(m.action="cloning",m.formErrorMessage="",m.modalHeader="Clone ",m.sourceList=null,m.submittingData=!1,1===d.length&&(m.sourceList=d[0],m.newListName=h.getSavedSearchNameCutOffByMaxlengthLimit((_.isUndefined(m.sourceList.name)?m.sourceList.displayName:m.sourceList.name)+" - Clone")),c){case"company":m.modalHeader+="Companies List";break;case"person":m.modalHeader+="Employees List";break;case"searches":m.modalHeader+="Saved Search"}m.close=function(){g.close(!1)},m.checkUniqueListName=function(){m.formErrorMessage=i.checkUniqueListName(e,m.newListName)},m.confirm=function(){var d,n,o;if(m.submittingData=!0,m.formErrorMessage=i.checkUniqueListName(e,m.newListName),m.formErrorMessage.length>0)return m.submittingData=!1,!1;if("searches"===c)a.oneObject(m.sourceList,f).then(function(a){f?j.saveThisSearch({name:m.newListName,searchCriteria:a.savedSearch.searchCriteria}).then(l,k):h.saveThisSearch({name:m.newListName,searchCriteria:a.savedSearch.searchCriteria}).then(l,k)},function(a){m.submittingData=!1,console.warn("Error with your request: %d",a.message)});else{var p=m.newListName;if(!p){var q=_.find(m.availableLists,function(a){return a.id===m.availableListsSelection});p=q?q.displayName:""}d={sourceListIds:[m.sourceList.id],targetListId:0,newTargetListName:p},n=a.getLinks()[b[c]].split("?"),o=n[0]+"/merge"+(_.isUndefined(n[1])?"":"?"+n[1]),a.laMerge(d,o).then(function(a){m.submittingData=!1,g.close(a)},k)}}}],size:"sm",templateUrl:"app/views/user-lists/_shared/modals/clone.modal.html"}},this.deleteListModal=function(b){return{controllerAs:"vm",controller:["$uibModalInstance","supportData","$q",function(c,d,e){function f(){return!_.isEmpty(g.subscriptions)}var g=this,h=0,i=null,j=null,k=!1;switch(g.cancel=c.dismiss,g.listTypeLabel="",g.modalHeader="Delete ",g.selectedItems=b.lists||[],g.secondSelectedItems=b.secondLists||[],g.submittingData=!1,g.totalItems=g.selectedItems.length+g.secondSelectedItems.length,g.hasSubscription=f,g.totalItems&&(g.modalHeader+=g.totalItems+" Selected "),b.tab){case"company":h=d.followedCompaniesListTypeId,g.listTypeLabel="List"+(b.lists.length>1?"s":""),g.modalHeader+="Company "+g.listTypeLabel;break;case"person":h=d.followedPersonsListTypeId,g.listTypeLabel="List"+(b.lists.length>1?"s":""),g.modalHeader+="Employee "+g.listTypeLabel;break;case"searches":h=d.savedSearchesListTypeId,g.listTypeLabel="Saved Search"+(b.lists.length>1?"es":""),g.modalHeader+=g.listTypeLabel,j=b.secondListsPageType||null,i=d.oppAlertSubscriptionTypeId,k=!0}if(g.subscriptions=_.filter(b.subscriptions,function(a){var c=!k||a.subscriptionType!=i;return a.sourceListType===h&&_.findIndex(b.lists,"id",a.sourceListId)>-1&&c}),!_.isEmpty(g.secondSelectedItems)){var l=_.filter(b.subscriptions,function(a){var b=!k||a.subscriptionType===i;return a.sourceListType===h&&_.findIndex(g.secondSelectedItems,"id",a.sourceListId)>-1&&b});_.isEmpty(l)||_.forEach(l,function(a){_.findIndex(g.subscriptions,"id",a.id)==-1&&g.subscriptions.push(a)})}g.confirm=function(){var d={};_.isEmpty(g.selectedItems)||(d.lists=a.laDelete(g.selectedItems,b.tab)),_.isEmpty(g.secondSelectedItems)||(d.secondLists=a.laDelete(g.secondSelectedItems,b.tab,j)),_.isEmpty(g.subscriptions)||(d.subscriptions=a.laDelete(g.subscriptions,"subscription")),e.all(d).then(c.close)}}],resolve:{supportData:a.getSubscriptionSupportData},templateUrl:"app/views/user-lists/_shared/modals/remove.modal.html"}},this.mergeModal=function(c,d,e){return{controllerAs:"vm",controller:["$uibModalInstance",function(f){var g=this;switch(g.selectedItems=d,g.availableLists=_.filter(e[b[c]],function(a){return _.indexOf(_.pluck(d,"id"),a.id)===-1}),g.availableLists.splice(0,0,{id:"new",displayName:"New List"}),g.availableListsSelection=g.availableLists[0].id,g.modalHeader="Merge "+g.selectedItems.length+" Selected ",g.submittingData=!1,c){case"company":g.listTypeLabel="List"+(g.selectedItems.length>1?"s":""),g.modalHeader+="Company "+g.listTypeLabel;break;case"employee":g.listTypeLabel="List"+(g.selectedItems.length>1?"s":""),g.modalHeader+="Employee "+g.listTypeLabel;break;case"searches":g.listTypeLabel="Saved Search"+(g.selectedItems.length>1?"es":""),g.modalHeader+=g.listTypeLabel}g.cancel=function(){f.dismiss("cancel")},g.confirm=function(){var d=g.newListName;if(!d){var e=_.find(g.availableLists,function(a){return a.id===g.availableListsSelection});d=e?e.displayName:""}var h={newTargetListName:d,sourceListIds:_.pluck(g.selectedItems,"id"),targetListId:"new"===g.availableListsSelection?0:g.availableListsSelection},i=a.getLinks()[b[c]].split("?"),j=i[0]+"/merge"+(_.isUndefined(i[1])?"":"?"+i[1]);g.submittingData=!0,a.laMerge(h,j).then(function(a){f.close(a)},function(a){return 409===a.status&&(g.submissionErrorMessage="Please enter a unique list name or select from the Source List.",g.newListInputError=!0,g.subscribe=!1),a}).finally(function(){g.submittingData=!1})},g.onNewListNameChange=function(){var a=!0;_.each(g.availableLists,function(b){"new"!==b.id&&b.displayName.toLowerCase()===g.newListName.toLowerCase()&&(a=!1)}),g.newListName.length<3&&(g.subscribe=!1),a&&_.each(g.selectedItems,function(b){b.displayName.toLowerCase()===g.newListName.toLowerCase()&&(a=!1)}),a?(g.subscribe=!1,g.newListInputError&&(g.submissionErrorMessage="",g.newListInputError=!1)):(g.submissionErrorMessage="Please enter a unique list name or select from the Source List.",g.newListInputError=!0,g.subscribe=!1)}}],size:"lg",templateUrl:"app/views/user-lists/_shared/modals/merge.modal.html"}},this.newListModal=function(b,c){return{controllerAs:"vm",controller:["$uibModalInstance","userListsBaseModals",function(d,e){var f=this;f.newListName="",f.listType=_.startCase(b),f.submittingData=!1,f.checkUniqueListName=function(){f.formErrorMessage=e.checkUniqueListName(c,f.newListName)},f.confirm=function(){f.submittingData=!0,a.laCreate(b,f.newListName).then(d.close)},f.close=d.dismiss}],size:"sm",templateUrl:"app/views/user-lists/_shared/modals/new.modal.html"}},this.renameListModal=function(b,c){return{controllerAs:"vm",controller:["$uibModalInstance","userListsBaseModals",function(d,e){var f=this;switch(f.action="renaming",f.formErrorMessage="",f.modalHeader="Rename ",f.sourceList=null,f.submittingData=!1,1===b.lists.length&&(f.sourceList=b.lists[0],f.newListName=_.isUndefined(f.sourceList.name)?f.sourceList.displayName:f.sourceList.name),b.tab){case"followCompany":f.modalHeader+="Companies List";break;case"followPerson":f.modalHeader+="Employees List";break;case"savedSearch":f.modalHeader+="Saved Search"}f.checkUniqueListName=function(){f.formErrorMessage=e.checkUniqueListName(_.filter(c,function(a){return a.id!==f.sourceList.id}),f.newListName)},f.confirm=function(){f.submittingData=!0,a.laRename(f.newListName,b).then(d.close,function(a){return f.submittingData=!1,a.indexOf("user_list_name")>-1?f.formErrorMessage="New List Name must be unique.":f.formErrorMessage="Something went wrong with this request. Please try again.",!1})},f.close=d.dismiss}],size:"sm",templateUrl:"app/views/user-lists/_shared/modals/clone.modal.html"}},this.subscriptionModal=function(b,c,d,e){return{controllerAs:"vm",controller:["$uibModalInstance","featureFlagService","supportData","sourceLists","SearchService",function(f,g,h,i,j){function k(){return r.typeOption&&r.typeOption.id!=t}function l(){return k()||r.frequencyOption}function m(){return!r.isNewOppAlert&&l()}function n(){return!!r.isNewOppAlert||l()}function o(){return r.isNewOppAlert||l()}function p(a){return g.findFeatureFlag(null,"triggerstoscoops")&&_.each(a,function(a){a.displayName=a.displayName.replace("Trigger","Scoop")}),a}function q(a){var b=[];return b.push(w),_.forEach(a,function(a){b.push(a)}),b}var r=this,s=null,t=h.oppAlertSubscriptionTypeId||4,u=_.clone(h.oppAlertSavedSearchScheduleType),v=u.id,w={id:"",displayName:"None"};if("Clone"===c&&(b=_.clone(b),b.id=0,b.name=j.getSavedSearchNameCutOffByMaxlengthLimit(b.name+" - Clone")),r.submittingData=!1,r.subscribeWithList=!1,r.uniqueSubscriptionNameError=!1,r.isNewOppAlert=!1,r.list={},r.subscriptionName="",r.frequencyOptions=h.scheduleTypes,r.originalItem=b,r.supportData=h,r.typeOption=null===b?w:{id:b.subscriptionType},r.showSubject=m,r.showFrequencyOption=n,r.showSourceList=o,r.subscriptionErrorMessage="",!_.isUndefined(d)&&null!==d&&!_.isUndefined(e)&&null!==e){switch(r.subscribeWithList=!0,d){case"followCompany":s=i.followedCompanies;break;case"followPerson":s=i.followedPersons;break;case"savedSearch":s=i.savedSearches;break;case"oppAlertSavedSearch":r.isNewOppAlert=!0,s=i.oppAlertSavedSearches}var x=s.filter(function(a){return a.id===e});r.list={selected:x[0]},r.subscriptionName=x[0].displayName}r.isNewOppAlert?(r.existingLists=a.getOppAlertSubscriptionAvailableListsOptions(i,h),r.typeOption=_.find(h.subscriptionTypes,function(a){return a.id===t}),h.scheduleTypes.push(u),r.frequencyOption=_.find(h.scheduleTypes,function(a){return a.id===v})):(r.existingLists=a.getSubscriptionGroupAvailableListsOptions(i,h),_.remove(h.subscriptionTypes,function(a){return a.id===t})),r.subscriptionTypes=q(p(h.subscriptionTypes)),!_.isUndefined(b)&&b?(r.itemId=b.id,r.subscriptionName=b.name,_.each(r.existingLists,function(a){b.sourceListType===a.sourceListTypeId&&a.id===b.sourceListId&&(r.list.selected=a)}),_.each(h.scheduleTypes,function(a){a.id===b.scheduleType&&(r.frequencyOption=a)}),_.each(h.subscriptionTypes,function(a){a.id===b.subscriptionType&&(r.typeOption=a)})):r.itemId=0,c=angular.isDefined(c)?c:0===r.itemId?"New":"Edit",r.deleteMode="Delete"===c,r.modalHeader=r.deleteMode?"Confirm Subscription Deletion":(0===r.itemId?"New":"Edit")+" Subscription",r.gotoSourceList=function(a){f.close({gotoSourceList:a})},r.save=function(){var b=r.originalItem?r.originalItem.sourceListType:null,c=r.originalItem?r.originalItem.sourceListId:null,d=r.originalItem?r.originalItem.scheduleType:null,e=r.originalItem?r.originalItem.subscriptionType:null;r.submittingData=!0,r.list.selected&&(isNaN(r.list.selected.sourceListTypeId)||(b=r.list.selected.sourceListTypeId),isNaN(r.list.selected.id)||(c=r.list.selected.id)),r.isNewOppAlert?(d=v,e=t):(r.frequencyOption&&!isNaN(r.frequencyOption.id)&&(d=r.frequencyOption.id),r.typeOption&&!isNaN(r.typeOption.id)&&(e=r.typeOption.id));var g={id:r.itemId,name:r.subscriptionName,scheduleType:d,sourceListId:c,sourceListType:b,subscriptionType:e};a.setSubscription(r.itemId,g,null,r).then(function(a){422===a.status?r.subscriptionErrorMessage="Subscription Name must be unique.":(!angular.isDefined(a)||angular.isArray(a)||a)&&f.close(a)}).finally(function(){r.submittingData=!1})},r.remove=function(){r.submittingData=!0,a.setSubscription(r.itemId,null,"Delete").then(f.close)},r.$onSelectSubscriptionList=function(){0===r.itemId&&(r.list.selected&&(r.subscriptionName=r.list.selected.displayName),r.subscriptionErrorMessage="")},r.close=f.dismiss}],resolve:{supportData:a.getSubscriptionSupportData,sourceLists:a.getSubscriptionAvailableLists},size:"sm",templateUrl:"app/views/user-lists/_shared/modals/subscription.modal.html"}},this.transferModal=function(b,c,d,e,f){return{controllerAs:"vm",controller:["$uibModalInstance",function(g){var h=this;h.availableListsSelection="new",h.newListName="",h.selectedItems=[],h.sourceList=c,h.submittingData=!1,h.availableLists=[{id:"new",displayName:"New List"}],_.each(b,function(a){a.name=a.name||a.fullName,h.selectedItems.push(a)}),_.each(e,function(a){c.id!==a.id&&h.availableLists.push(a)}),h.cancel=function(){g.dismiss("cancel")},h.confirm=function(){var b={addFollowIds:[],deleteFollowIds:[],entityIds:[]},c="new"===h.availableListsSelection?null:h.availableListsSelection;h.submittingData=!0,_.each(h.selectedItems,function(a){b.entityIds.push(a.id)}),b.deleteFollowIds.push(h.sourceList.id),"new"!==h.availableListsSelection&&b.addFollowIds.push(h.availableListsSelection),null===c?a.laCreate(f,h.newListName).then(function(c){b.addFollowIds.push(c.id),a.transfer(b,d).then(function(){a.getData(h.sourceList).then(function(){g.close(c)})})}):a.transfer(b,d).then(function(){a.getData(h.sourceList).then(function(){g.close(h.sourceList)})})}}],size:"lg",templateUrl:"app/views/user-lists/_shared/modals/transfer.modal.html"}},this.unfollowModal=function(b,c,d,e){return{controllerAs:"vm",controller:["$uibModalInstance",function(f){var g=this;g.selectedItems=b,g.sourceList=c,g.newListName="",g.cancel=f.dismiss,g.confirm=function(){var b={addFollowIds:[],deleteFollowIds:[g.sourceList.id],entityIds:_.pluck(g.selectedItems,"id"),unfollowAllAction:!_.isUndefined(e)&&e};a.transfer(b,d).then(function(){a.getData(g.sourceList).then(f.close)})}}],templateUrl:"app/views/user-lists/_shared/modals/unfollow.modal.html"}}}]),angular.module("dorgEuiApp").service("userListsBaseService",["$embeddedUtils","$grid","$http","$q","$rootScope","uiGridConstants","searchFilterService","UserService",function(a,b,c,d,e,f,g,h){function i(a,b){return _.isUndefined(b)||(!_.isUndefined(b.page)&&b.page&&(a=a.replace(/(page=)[^\&]+/,"$1"+b.page)),!_.isUndefined(b.size)&&b.size&&(a=a.replace(/(size=)[^\&]+/,"$1"+b.size)),!_.isUndefined(b.sortField)&&b.sortField&&(a=a.replace(/(sortField=)[^\&]+/,"$1"+b.sortField)),!_.isUndefined(b.sortOrder)&&b.sortOrder&&(a=a.replace(/(sortOrder=)[^\&]+/,"$1"+b.sortOrder))),a}function j(){e.Session.navigation.$get("perform_search").then(function(a){a.$get("gridFilters").then(function(a){D=a})})}var k=e.Session.navigation.$href("viewMyLists"),l={},m="searches",n="savedSearchLists",o="employee",p="followPersonLists",q="company",r="followCompanyLists",s="subscription",t="subscriptionLists",u="Saved Searches",v="oppAlertSavedSearchLists",w="recordAddedDate",x=[{name:"event:crmUpload",clearSelectedRowsFlag:!1},{name:"event:followed",clearSelectedRowsFlag:!0},{name:"event:noteSaved",clearSelectedRowsFlag:!1},{name:"event:suppression",clearSelectedRowsFlag:!0},{name:"event:unfollowed",clearSelectedRowsFlag:!0}],y={};y[o]=p,y[q]=r,y[s]=t,y[m]=n;var z=1,A=2,B="OPPALERT",C=/departments\dNumEmployees/,D=null;this.savedSearchTabKey=_.clone(m),this.oppAlertPageType=_.clone(B),this.getData=function(b,e){var f;return(f=_.isObject(b)?a.$self(b):l[b])?(f=i(f,e),c.get(f).then(function(b){return{page:b.data.page||{totalElements:0},data:a.$getD(b.data)}})):d.reject()},this.getLinks=function(){return l},this.getSubscriptionAvailableLists=function(){return c.get(l.subscriptionLists+"/availablelists").then(function(a){return a.data})},this.getSubscriptionGroupAvailableListsOptions=function(a,b){var c=[],d=_.clone(u);return _.each(a.followedCompanies,function(a){a.sourceListTypeId=b.followedCompaniesListTypeId,a.sourceListTypeName="Followed Companies List",c.push(a)}),_.each(a.followedPersons,function(a){a.sourceListTypeId=b.followedPersonsListTypeId,a.sourceListTypeName="Followed Employees List",c.push(a)}),_.each(a.savedSearches,function(a){a.sourceListTypeId=b.savedSearchesListTypeId,a.sourceListTypeName=d,c.push(a)}),c},this.getOppAlertSubscriptionAvailableListsOptions=function(a,b){var c=[],d=_.clone(u);return _.each(a.oppAlertSavedSearches,function(a){a.sourceListTypeId=b.savedSearchesListTypeId,a.sourceListTypeName=d,c.push(a)}),c},this.getSubscriptionSupportData=function(){return c.get(l.subscriptionLists+"/supportdata").then(function(a){return a.data})},this.grid=function(a){var c=b.$defaultGrid(a,[],!0,!1);return c.useExternalPagination=!0,c.useExternalSorting=!0,c},this.laCreate=function(a,b){var d=y[a]||a;return c.post(l[d],b).then(function(a){return a.data})},this.laDelete=function(){if(arguments.length<1)throw new Error("Missing arguments for laDelete");var b=_.pluck(arguments[0],"id"),d=arguments[1],e={data:b,headers:{Accept:"application/hal+json,application/json","Content-Type":"application/json"}};if(d===m){var f=arguments[2];f&&(e.params={pageType:f})}return c.delete(l[y[d]],e).then(function(b){return a.$getD(b.data)||[]},function(){return!1})},this.laMerge=function(a,b){return c.put(b,a)},this.laRename=function(){if(arguments.length<1)throw new Error("Missing arguments for laRename");var a=arguments[1],b=arguments[0],d=l[y[a.tab]].split("?"),e=a.params||null,f=d[0]+"/"+a.lists[0].id+(_.isUndefined(d[1])?"":"?"+d[1]);return c.put(f,b,e).then(function(a){return a.data},function(a){return a.data.message})},this.loadListData=function(){return c.get(k).then(function(b){var e=Object.keys(b.data._links),f={},g=[t,n,p,r];return _.each(e,function(d){l[d]=b.data._links[d].href,_.includes(g,d)&&(d===n?(f[d]=c.get(b.data._links[d].href).then(function(b){return a.$getD(b.data)||[]}),h.canAccessTopContentConsumers()?f[v]=c.get(b.data._links[d].href,{params:{pageType:B}}).then(function(b){return a.$getD(b.data)||[]}):f[v]=[]):f[d]=c.get(b.data._links[d].href).then(function(b){return a.$getD(b.data)||[]}))}),d.all(f)})},this.oneObject=function(b,d){var e=d?{params:{pageType:d}}:null;return c.get(a.$self(b),e).then(function(a){return a.data})},this.setSubscription=function(b,d,f,g){var h=null===b||0===b?"POST":"Delete"===(!_.isUndefined(f)&&f)?"DELETE":"PUT";return c({data:d,headers:{"Content-Type":"application/json"},method:h,url:(_.isUndefined(l.subscriptionLists)?d.link:l.subscriptionLists)+("PUT"===h||"DELETE"===h?"/"+b:"")}).then(function(b){return e.$broadcast("updateSubscriptions"),a.$getD(b.data)},function(a){return g&&(422===a.status||_.has(a,["data","message"])&&a.data.message.indexOf("user_subscription_name")>-1?g.subscriptionErrorMessage="Subscription Name must be unique.":g.subscriptionErrorMessage="Something went wrong with this request. Please try again."),a})},this.transfer=function(a,b){return c.put(b,a)},this.isGridNoData=function(a){return!_.has(a,"data")||!(!_.has(a,"data")||a.data.length)},this.updateGridFilters=function(a){for(var b=a.grid.columns,c={},d=0;d<b.length;++d){var e=b[d].filters,h=b[d].filter,i=_.camelCase(b[d].field);if(C.test(i)&&(i=b[d].name),b[d].enableFiltering&&1===e.length&&(c[i]=h.term&&b[d]?h.term:""),b[d].enableFiltering&&e.length>1){c[i]={};for(var j=0,k=e.length;j<k;++j){var l=e[j].condition,m=f.filter;if(void 0===l&&("More Than"===e[j].placeholder&&(l=m.GREATER_THAN),"Less Than"===e[j].placeholder&&(l=m.LESS_THAN)),l===m.GREATER_THAN||l===m.LESS_THAN){var n=l===m.GREATER_THAN?"minValue":"maxValue",o="revenue"===i,p=g.getNumberFilter(e[j].term,o);c[i][n]=p}else l!==m.DATE_GREATER_THAN&&l!==m.DATE_LESS_THAN||(c[i][l===m.DATE_GREATER_THAN?"minValue":"maxValue"]=new Date(e[j].term).getTime()||null)}}}var q=Object.keys(c).length<1?null:c;return g.standardizeGridFilters(q)},this.getGridSortObject=function(a){var b,c={sortField:"",sortOrder:""};_.isUndefined(a[0])&&(a[0]={field:"",sort:{direction:null}}),b=a[0].field.split(".");try{c.sortField=_.camelCase(a[0].colDef.field.replace(/\./g,"_"))}catch(a){c.sortField=b[b.length>1?1:0]}return c.sortOrder=a[0].sort.direction,c},this.filterGrid=function(b,e,f,h){var j;if(j=_.isObject(b)?a.$self(b):l[b],!j)return d.reject();_.isUndefined(e)||(!_.isUndefined(e.page)&&e.page&&(j=j.replace(/(page=)[^\&]+/,"$1"+e.page)),!_.isUndefined(e.size)&&e.size&&(j=j.replace(/(size=)[^\&]+/,"$1"+e.size)),!_.isUndefined(e.sortField)&&e.sortField&&(j=j.replace(/(sortField=)[^\&]+/,"$1"+e.sortField)),!_.isUndefined(e.sortOrder)&&e.sortOrder&&(j=j.replace(/(sortOrder=)[^\&]+/,"$1"+e.sortOrder))),j=i(j,e),f=angular.copy(f);for(var k={persons:"personGridFilterResource",companies:"companyGridFilterResource"},m=D[k[h]]||"",n=Object.getOwnPropertyNames(f),o={gridFilterResource:{},searchCriteria:{}},p=0,q=n.length;p<q;++p)m[n[p]]=f[n[p]];return"companies"===h?(m.numEmployees=""===m.numEmployees?{minValue:0,maxValue:0}:m.numEmployees,m.revenue=""===m.revenue?{minValue:0,maxValue:0}:g.parseRevenue(m.revenue)):"persons"===h&&(m.linkedInUrl=""===m.linkedInUrl?"EITHER":m.linkedInUrl,m.twitterHandle=""===m.twitterHandle?"EITHER":m.twitterHandle),o.gridFilterResource[k[h]]=m,c.post(j,o).then(function(b){return{page:b.data.page||{totalElements:0},data:a.$getD(b.data),gridFilterResource:o.gridFilterResource}})},this.clearSortFieldFromGrid=function(a){a&&_.forEach(a.api.grid.columns,function(a){a.sort={}})},this.isFiltered=function(a){return!!a&&_.some(a,function(a){return _.isObject(a)?!(!a.minValue&&!a.maxValue):!!a})},this.getCountsByFollowList=function(a,b){var d={followRequest:a,filters:b};return c.post("api/rest/persons/follow/counts",d).then(function(a){return a.data})},this.getDefaultSaveSearchId=function(a,b){return c.get(l.savedSearchLists+"/initSaveSearchId",{params:{saveSearchId:a,oppAlertSaveSearchId:b}})},this.getFirstListDataIndex=function(){return z},this.getSecondListDataIndex=function(){return A},this.getListActionMap=function(){var a={};return a[o]=p,a[q]=r,a[m]=n,a},j(),this.getTotalInScope=function(b){var e;return _.isObject(b)?(e=a.$self(b),e=e.substring(0,e.indexOf("?"))+"/countsinscope"):e=l[b+"Counts"],e?c.get(e).then(function(a){return a.data}):d.reject()},this.disableSortRecordAddedDate=function(a){a&&_.each(a,function(a){a.field===w&&(a.enableSorting=!1)})},this.setupEventListeners=function(a,b,c){_.forEach(x,function(d){a.$on(d.name,function(a){b(),d.clearSelectedRowsFlag&&c()})})}}]),angular.module("dorgEuiApp").controller("userListsAlertsController",[function(){}]),angular.module("dorgEuiApp").controller("userListsCompanyController",["$grid","$rootScope","$scope","$SearchModalsService","$state","$uibModal","Flash","userListsBaseModals","userListsBaseService","companyIndustryService","SearchService",function(a,b,c,d,e,f,g,h,i,j,k){function l(){return i.isFiltered(p.gridFilters)?s:null}function m(){var a,b;if(window.localStorage&&window.localStorage.companyListFilters){try{a=JSON.parse(window.localStorage.companyListFilters)}catch(b){a=!1}a&&_.each(a,function(a,c){b=_.find(p.grid.columnDefs,{field:c}),b&&(b.filter=a)})}k.checkCanExport().then(function(a){p.canExport=a})}function n(){p.populateList(p.latestPageStuff)}function o(){p.gridSelectedRows=[]}var p=this;p.canExport=!1,e.params.selectList&&(c.$parent.baseVm.activeList.company=e.params.selectList),e.params.suppressionLoc&&(c.$parent.baseVm.activeList.company=-5),p.activeList=null,p.activeListName="Loading...",p.grid=i.grid("followCompany"),i.disableSortRecordAddedDate(p.grid.columnDefs),p.grid.useExternalFiltering=!0,p.grid.appScopeProvider=p,p.gridSelectedRows=[],p.listData=[],p.loading=!1,p.subscribable=!1,p.gridFilters=null,p.getGridFilterResource=l,p.methodMap={uploadedToCRM:"$uploadedCompaniesToCRM",uploadedToMAT:"$uploadedCompaniesToMAT",uploadedToSDR:"$uploadedCompaniesToSDR",suppressed:"$suppressedCompanies",withNotes:"$notedCompanies"};var q={uploadedToCRM:"crmUploadedCompaniesLists",uploadedToMAT:"matUploadedCompaniesLists",uploadedToSDR:"sdrUploadedCompaniesLists",suppressed:"suppressedCompaniesLists",withNotes:"notedCompaniesLists"};p.noDataGuide="app/views/user-lists/_shared/no-data-guide.html",p.hasData=!1,p.getIndustriesInfo=j.getIndustriesInfo,p.latestPageStuff=null;var r=null;p.populateList=function(a){var c,d=p.activeList;return _.isObject(p.activeList)?p.subscribable=!0:(p.subscribable=!1,d=q[d]),_.isUndefined(a)?(p.gridSelectedRows=[],c={page:p.grid.paginationCurrentPage-1,size:p.grid.paginationPageSize}):c=_.isUndefined(a.page)||_.isUndefined(a.size)?{page:p.grid.paginationCurrentPage-1,size:p.grid.paginationPageSize}:a,k.isFiltered(p.gridFilters)?p.filterGrid(d,c):(p.loading=!0,p.hasData=!1,p.latestPageStuff=c,i.getData(d,c).then(function(a){p.grid.data=a.data,p.hasData=a.data.length>0,p.grid.totalItems=a.page?a.page.totalElements:0,a.page?p.grid.paginationCurrentPage=a.page.number+1:p.grid.paginationCurrentPage=1,p.loading=!1}),void b.$broadcast("hidePopovers"))};var s=null;p.filterGrid=function(a,c){p.subscribable=!0,p.gridSelectedRows=[],p.loading=!0,s=null,i.filterGrid(a,c,p.gridFilters,"companies").then(function(a){p.grid.data=a.data,p.grid.totalItems=a.page?a.page.totalElements:0,s=a.gridFilterResource,_.has(a.page,"number")?p.grid.paginationCurrentPage=a.page.number+1:p.grid.paginationCurrentPage=1,p.loading=!1}),b.$broadcast("hidePopovers")},p.subscribe=function(){if(!i.isGridNoData(p.grid)){var a=f.open(h.subscriptionModal(null,"New","followCompany",p.activeList.id));return a.result.then(function(a){a&&g.create("success","Subscription is successfully created.","flash")}),a}},p.transferFromList=function(){var a;return!!p.gridSelectedRows.length&&(a=f.open(h.transferModal(p.gridSelectedRows,p.activeList,i.getLinks().followCompanyLists,p.listData,"followCompanyLists")),void a.result.then(function(a){a&&(g.create("success","All selected are successfully transferred.","flash"),_.findWhere(p.listData,{id:a.id})||p.listData.push(a),b.$broadcast("activateList",a))}))},p.unfollowFromList=function(a){var b=f.open(h.unfollowModal(p.gridSelectedRows,p.activeList,i.getLinks().followCompanyLists,a));b.result.then(function(){g.create("success","All selected removed from list successfully","flash"),p.populateList()})},p.viewMap=function(){if(!i.isGridNoData(p.grid)){var a=p.gridSelectedRows;a.length||(a=p.grid.data),f.open(d.mapModal(a))}},p.grid.onRegisterApi=function(b){var d=this;this.api=b;var e=function(){a.updateColumnDefinition(this.saveState.save().columns,"uiTablefollowCompany")};this.api.colMovable.on.columnPositionChanged(c,e),this.api.core.on.columnVisibilityChanged(c,e),this.api.core.on.rowsRendered(c,function(){var a=0,b={};window.localStorage&&(_.each(p.grid.columnDefs,function(a){b[a.field]=_.omit(a.filter,"$$hashKey")}),window.localStorage.companyListFilters=JSON.stringify(b)),_.each(this.grid.rows,function(b){_.findWhere(p.gridSelectedRows,{id:b.entity.id})&&(a+=1,b.isSelected=!0)}),a===this.grid.rows.length?d.api.grid.selection.selectAll=!0:d.api.grid.selection.selectAll&&(d.api.grid.selection.selectAll=!1);
}),this.api.core.on.sortChanged(c,function(b,c){a.closeAllPopover(document);var d={page:p.grid.paginationCurrentPage-1,size:p.grid.paginationPageSize},e=i.getGridSortObject(c);d.sortField=e.sortField,d.sortOrder=e.sortOrder,r={sortField:e.sortField,sortOrder:e.sortOrder},p.populateList(d)}),this.api.core.on.filterChanged(c,function(){var a=i.updateGridFilters(p.grid.api);if(null!=p.gridFilters&&!angular.equals(a,p.gridFilters)||null==p.gridFilters&&k.isFiltered(a)){p.gridFilters=a;var b=p.activeList;_.isObject(p.activeList)?p.subscribable=!0:(p.subscribable=!1,b=q[b]);var c={page:p.grid.paginationCurrentPage-1,size:p.grid.paginationPageSize,sortField:null!=r?r.sortField:null,sortOrder:null!=r?r.sortOrder:null};p.filterGrid(b,c)}}),this.api.pagination.on.paginationChanged(c,function(a,b){$("html, body").animate({scrollTop:0},600);var c={page:p.grid.paginationCurrentPage-1,size:p.grid.paginationPageSize};r&&(c.sortField=r.sortField,c.sortOrder=r.sortOrder),p.loading||p.populateList(c)}),this.api.selection.on.rowSelectionChangedBatch(c,function(a){_.each(a,function(a){a.isSelected?p.gridSelectedRows.push(a.entity):p.gridSelectedRows.splice(_.findIndex(p.gridSelectedRows,{id:a.entity.id}),1)})}),this.api.selection.on.rowSelectionChanged(c,function(a){a.isSelected?p.gridSelectedRows.push(a.entity):p.gridSelectedRows.splice(_.findIndex(p.gridSelectedRows,{id:a.entity.id}),1)})},c.$watch("$parent.baseVm.listData.followCompanyLists",function(a){p.listData=a}),c.$watch("companyVm.grid.api.grid.isScrollingHorizontally",function(){b.$broadcast("updatePopoverHorizontal")}),i.setupEventListeners(c,n,o),c.$on("loadList",function(a,b){var d,e;p.activeList=b.data,b.static?(e={uploadedToCRM:{code:-2,name:"Companies Uploaded to CRM"},uploadedToMAT:{code:-3,name:"Companies Uploaded to MAT"},uploadedToSDR:{code:-4,name:"Companies Uploaded to SDR"},suppressed:{code:-5,name:"Blocked Companies"},withNotes:{code:-6,name:"Companies with Notes"}},d=e[b.data].code,p.activeListName=e[b.data].name):d=b.data.id,c.$parent.baseVm.activeList.company=d,c.$parent.baseVm.activeList.listDataIndex=c.$parent.baseVm.getActiveListDataIndex(b.listDataIndex),r&&r.sortOrder&&(i.clearSortFieldFromGrid(p.grid),r=null),_.has(p.grid,"api")&&(p.grid.api.core.clearAllFilters(),p.gridFilters=null),p.populateList({page:0,size:p.grid.paginationPageSize})}),c.$on("followActionExecuting",function(){p.loading=!0}),p.checkShowingNoDataGuide=function(){return 0===p.grid.data.length&&!p.loading&&_.isObject(p.activeList)&&!k.isFiltered(p.gridFilters)},p.checkShowingNoData=function(){return!p.hasData&&!p.loading&&!_.isObject(p.activeList)},m()}]),angular.module("dorgEuiApp").controller("userListsEmployeeController",["$grid","$rootScope","$scope","$SearchModalsService","$state","$uibModal","Flash","userListsBaseModals","userListsBaseService","phoneNumberService","SearchService",function(a,b,c,d,e,f,g,h,i,j,k){function l(){if(q.activeList){var a=q.getGridFilterResource(),b={};_.isUndefined(q.activeList.id)||(b.followListId=q.activeList.id);var c=q.methodMap[q.activeList];return _.isUndefined(c)||_.isEmpty(c)||_.isObject(c)||(b.listMethod=c.replace(/\$/,"")),i.getCountsByFollowList(b,a).then(function(a){return null!=a?a.searchCriteriaScoped:0})}return 0}function m(){return i.isFiltered(q.gridFilters)?t:null}function n(){var a,b;if(window.localStorage&&window.localStorage.employeeListFilters){try{a=JSON.parse(window.localStorage.employeeListFilters)}catch(b){a=!1}a&&_.each(a,function(a,c){b=_.find(q.grid.columnDefs,{field:c}),b&&(b.filter=a)})}k.checkCanExport().then(function(a){q.canExport=a})}function o(){q.populateList(q.latestPageStuff)}function p(){q.gridSelectedRows=[]}var q=this;q.canExport=!1,e.params.selectList&&(c.$parent.baseVm.activeList.employee=e.params.selectList),e.params.suppressionLoc&&(c.$parent.baseVm.activeList.employee=-5),q.activeList=null,q.activeListName="Loading...",q.grid=i.grid("followPerson"),i.disableSortRecordAddedDate(q.grid.columnDefs),q.grid.useExternalFiltering=!0,q.grid.appScopeProvider=q,q.gridSelectedRows=[],q.listData=[],q.loading=!1,q.subscribable=!1,q.getOfficeThenCompanyNumberOrBlank=j.getOfficeThenCompanyNumberOrBlank,q.countTotalItems=l,q.getGridFilterResource=m,q.latestPageStuff=null;var r=null;q.methodMap={uploadedToCRM:"$uploadedEmployeesToCRM",uploadedToMAT:"$uploadedEmployeesToMAT",uploadedToSDR:"$uploadedEmployeesToSDR",suppressed:"$suppressedEmployees",withNotes:"$notedEmployees"};var s={uploadedToCRM:"crmUploadedPersonsLists",uploadedToMAT:"matUploadedPersonsLists",uploadedToSDR:"sdrUploadedPersonsLists",suppressed:"suppressedPersonsLists",withNotes:"notedPersonsLists"};q.noDataGuide="app/views/user-lists/_shared/no-data-guide.html",q.hasData=!1,q.populateList=function(a){var b,c=q.activeList;return _.isObject(q.activeList)?q.subscribable=!0:(q.subscribable=!1,c=s[c]),_.isUndefined(a)?(q.gridSelectedRows=[],b={page:q.grid.paginationCurrentPage-1,size:q.grid.paginationPageSize}):b=_.isUndefined(a.page)||_.isUndefined(a.size)?{page:q.grid.paginationCurrentPage-1,size:q.grid.paginationPageSize}:a,k.isFiltered(q.gridFilters)?q.filterGrid(c,b):(q.loading=!0,q.hasData=!1,i.getTotalInScope(c).then(function(a){q.totalInScope=a}),q.latestPageStuff=b,void i.getData(c,b).then(function(a){q.grid.data=a.data,q.hasData=a.data.length>0,q.grid.totalItems=a.page?a.page.totalElements:0,a.page?q.grid.paginationCurrentPage=a.page.number+1:q.grid.paginationCurrentPage=1,q.loading=!1}))};var t=null;q.filterGrid=function(a,b){q.subscribable=!0,q.gridSelectedRows=[],q.loading=!0,t=null,i.filterGrid(a,b,q.gridFilters,"persons").then(function(a){q.grid.data=a.data,q.grid.totalItems=a.page?a.page.totalElements:0,t=a.gridFilterResource,_.has(a.page,"number")?q.grid.paginationCurrentPage=a.page.number+1:q.grid.paginationCurrentPage=1,q.loading=!1})},q.subscribe=function(){if(!i.isGridNoData(q.grid)){var a=f.open(h.subscriptionModal(null,"New","followPerson",q.activeList.id));return a.result.then(function(a){a&&g.create("success","Subscription is successfully created.","flash")}),a}},q.transferFromList=function(){var a;return!!q.gridSelectedRows.length&&(a=f.open(h.transferModal(q.gridSelectedRows,q.activeList,i.getLinks().followPersonLists,q.listData,"followPersonLists")),void a.result.then(function(a){a&&(g.create("success","All selected are successfully transferred.","flash"),_.findWhere(q.listData,{id:a.id})||q.listData.push(a),b.$broadcast("activateList",a))}))},q.unfollowFromList=function(a){var b=f.open(h.unfollowModal(q.gridSelectedRows,q.activeList,i.getLinks().followPersonLists,a));b.result.then(function(){g.create("success","All selected removed from list successfully","flash"),q.populateList()})},q.viewMap=function(){if(!i.isGridNoData(q.grid)){var a=q.gridSelectedRows;a.length||(a=q.grid.data),f.open(d.mapModal(a))}},q.grid.onRegisterApi=function(d){var e=this;this.api=d;var f=function(){a.updateColumnDefinition(this.saveState.save().columns,"uiTablefollowPerson")};this.api.colMovable.on.columnPositionChanged(c,f),this.api.core.on.columnVisibilityChanged(c,f),this.api.core.on.rowsRendered(c,function(){var a=0,c={};window.localStorage&&(_.each(q.grid.columnDefs,function(a){c[a.field]=_.omit(a.filter,"$$hashKey")}),window.localStorage.employeeListFilters=JSON.stringify(c)),_.each(this.grid.rows,function(b){_.findWhere(q.gridSelectedRows,{id:b.entity.id})&&(a+=1,b.isSelected=!0)}),a===this.grid.rows.length?e.api.grid.selection.selectAll=!0:e.api.grid.selection.selectAll&&(e.api.grid.selection.selectAll=!1),b.$broadcast("hidePopovers")}),this.api.core.on.sortChanged(c,function(a,b){var c={page:q.grid.paginationCurrentPage-1,size:q.grid.paginationPageSize},d=i.getGridSortObject(b);c.sortField=d.sortField,c.sortOrder=d.sortOrder,r={sortField:d.sortField,sortOrder:d.sortOrder},q.populateList(c)}),this.api.core.on.filterChanged(c,function(){var a=i.updateGridFilters(q.grid.api);if(null!=q.gridFilters&&!angular.equals(a,q.gridFilters)||null==q.gridFilters&&k.isFiltered(a)){q.gridFilters=a;var b=q.activeList;_.isObject(q.activeList)?q.subscribable=!0:(q.subscribable=!1,b=s[b]);var c={page:q.grid.paginationCurrentPage-1,size:q.grid.paginationPageSize,sortField:null!=r?r.sortField:null,sortOrder:null!=r?r.sortOrder:null};q.filterGrid(b,c)}}),this.api.pagination.on.paginationChanged(c,function(a,b){$("html, body").animate({scrollTop:0},600);var c={page:q.grid.paginationCurrentPage-1,size:q.grid.paginationPageSize};r&&(c.sortField=r.sortField,c.sortOrder=r.sortOrder),q.loading||q.populateList(c)}),this.api.selection.on.rowSelectionChangedBatch(c,function(a){_.each(a,function(a){a.isSelected?q.gridSelectedRows.push(a.entity):q.gridSelectedRows.splice(_.findIndex(q.gridSelectedRows,{id:a.entity.id}),1)})}),this.api.selection.on.rowSelectionChanged(c,function(a){a.isSelected?q.gridSelectedRows.push(a.entity):q.gridSelectedRows.splice(_.findIndex(q.gridSelectedRows,{id:a.entity.id}),1)})},c.$watch("$parent.baseVm.listData.followPersonLists",function(a){q.listData=a}),c.$watch("employeeVm.grid.api.grid.isScrollingHorizontally",function(){b.$broadcast("updatePopoverHorizontal")}),i.setupEventListeners(c,o,p),c.$on("loadList",function(a,b){var d,e;q.activeList=b.data,b.static?(e={uploadedToCRM:{code:-2,name:"Employees Uploaded to CRM"},uploadedToMAT:{code:-3,name:"Employees Uploaded to MAT"},uploadedToSDR:{code:-4,name:"Employees Uploaded to SDR"},suppressed:{code:-5,name:"Blocked Employees"},withNotes:{code:-6,name:"Employees with Notes"}},d=e[b.data].code,q.activeListName=e[b.data].name):d=b.data.id,c.$parent.baseVm.activeList.employee=d,c.$parent.baseVm.activeList.listDataIndex=c.$parent.baseVm.getActiveListDataIndex(b.listDataIndex),r&&r.sortOrder&&(i.clearSortFieldFromGrid(q.grid),r=null),_.has(q.grid,"api")&&(q.grid.api.core.clearAllFilters(),q.gridFilters=null),q.gridSelectedRows=[],q.populateList({page:0,size:q.grid.paginationPageSize})}),c.$on("followActionExecuting",function(){q.loading=!0}),q.checkShowingNoDataGuide=function(){return 0===q.grid.data.length&&!q.loading&&_.isObject(q.activeList)&&!k.isFiltered(q.gridFilters)},q.checkShowingNoData=function(){return!q.hasData&&!q.loading&&!_.isObject(q.activeList)},n()}]),angular.module("dorgEuiApp").controller("userListsSearchesController",["$scope","$state","$uibModal","Flash","userListsBaseModals","userListsSearchesService","userListsBaseService","featureFlagService","$rootScope","FormatDatesService","TopContentConsumerService",function(a,b,c,d,e,f,g,h,i,j,k){function l(){n.triggersToScoopFlag=h.findFeatureFlag(null,"triggerstoscoops"),n.triggersToScoopFlag?(n.intelText="Scoops",n.intelCategoryText="Topic",n.intelCategoriesText="Topics"):(n.intelText="Triggers",n.intelCategoryText="Category",n.intelCategoriesText="Categories")}function m(){return _.isEmpty(n.listData)}var n=this,o=!1;n.activeList={},n.dataLoaded=!1,n.listData=[],n.secondListData=[],n.listName="Loading...",n.viewData=[],n.lastRun=void 0,n.intelType="Type",n.intelTypes="Types",n.isOppAlertSavedSearch=!1,n.recruitersNewDataPointEnabled=h.findFeatureFlag(null,"recruiters_new_dp"),n.oppAlertScoreOptions=k.getOppAlertScoreOptions(),n.isDisabledSubscribeAndExecuteSearchButton=m,l(),b.params.selectList&&(a.$parent.baseVm.activeList.searches=b.params.selectList),n.subscriptionModal=function(){var b=n.isOppAlertSavedSearch?"oppAlertSavedSearch":"savedSearch",f=c.open(e.subscriptionModal(null,"New",b,n.activeList.id));return f.result.then(function(b){angular.isDefined(b)&&(d.create("success","Subscription is successfully created.","flash"),a.$parent.baseVm.listData.subscriptionLists=b,a.$parent.baseVm.listCounts.subscriptionLists=b.length)}),f},n.execSearch=function(){n.isOppAlertSavedSearch?b.go("redirectOppAlertSavedSearch",{id:n.activeList.id}):(i.curShowSavedSearchId=n.activeList.id,i.curShowSavedSearchName=n.activeList.displayName,b.go("perform_search",{savedSearchId:n.activeList.id}))},a.$watch("$parent.baseVm.listData.savedSearchLists",function(a){n.listData=a}),a.$watch("$parent.baseVm.listData.oppAlertSavedSearchLists",function(a){n.secondListData=a}),a.$on("loadList",function(b,c){if("noLists"===c.data)return void(n.listName="None Available");if(c.static)return o&&(n.listName="None Selected"),void(o=!0);n.activeList=c.data,n.dataLoaded=!1,n.listName=c.data.displayName,n.lastRun=void 0,a.$parent.baseVm.activeList.searches=c.data.id,a.$parent.baseVm.activeList.listDataIndex=a.$parent.baseVm.getActiveListDataIndex(c.listDataIndex);var d=c.listDataIndex==g.getSecondListDataIndex()?a.$parent.baseVm.OPPALERT_PAGE_TYPE:null;f.get(c.data,d).then(function(a){n.isOppAlertSavedSearch=!!d,n.lastRun=a.lastRun,n.viewData=a.search,n.viewData.companyRecordsDate.minValue&&(n.companyWithinTheLastNumOfDays=j.setTwoDatesFormat(new Date,new Date(n.viewData.companyRecordsDate.minValue))||0),n.viewData.personRecordsDate.minValue&&(n.employeeWithinTheLastNumOfDays=j.setTwoDatesFormat(new Date,new Date(n.viewData.personRecordsDate.minValue))||0),n.showAddressLoc=_.filter(n.viewData.geo,_.size).length>0,n.recruitersNewDataPointEnabled||(n.viewData.havingMobilePhone=!1,n.viewData.havingPersonalEmail=!1,n.viewData.havingOfficePhone=!1,n.viewData.havingAnyEmail=!1)}).finally(function(){n.dataLoaded=!0})}),n.makeSearchCriteriaNumberRangeLabel=function(a){var b=a.minValue||0;return b+=a.minValue>a.maxValue?"+":" - "+a.maxValue}}]),angular.module("dorgEuiApp").service("userListsSearchesService",["$embeddedUtils","$http","SearchService",function(a,b,c){var d=c.convertSavedSearch;this.get=function(c,e){var f=e?{params:{pageType:e}}:null;return b.get(a.$fetchLink(c,"self"),f).then(function(a){return{lastRun:a.data.savedSearch.lastRunTime,search:d(a.data)}},function(){return{}})}}]),angular.module("dorgEuiApp").controller("userListsSubscriptionsController",["$grid","$scope","$state","Flash","userListsBaseModals","userListsSubscriptionsService","featureFlagService","singleModalService",function(a,b,c,d,e,f,g,h){function i(a){return g.findFeatureFlag(null,"triggerstoscoops")&&_.each(a,function(a){a.name.indexOf("Trigger")!==-1&&(a.name=a.name.replace("Trigger","Scoop")),a.subscriptionTypeName.indexOf("Trigger")!==-1&&(a.subscriptionTypeName=a.subscriptionTypeName.replace("Trigger","Scoop"))}),a}var j=this;j.grid=f.grid(),j.grid.appScopeProvider=j,j.subscriptionModal=function(a,c){var f=h.open(e.subscriptionModal(a,c));return f.result.then(function(a){if(angular.isDefined(a))if(a.gotoSourceList)j.viewList(a.gotoSourceList);else{switch(c){case"Edit":d.create("success","Your subscription has been edited.","flash");break;case"Delete":d.create("success","Your subscription has been deleted.","flash");break;case"Clone":d.create("success","Your subscription has been cloned.","flash");break;default:d.create("success","Your subscription has been created.","flash")}b.$parent.baseVm.listData.subscriptionLists=a,b.$parent.baseVm.listCounts.subscriptionLists=a.length}}),f},j.viewList=function(a){var b=_.isUndefined(a.sourceListId)?a.id:a.sourceListId,d=void 0;_.contains(a.sourceListTypeName,"Search")?d="user_lists_searches":_.contains(a.sourceListTypeName,"Companies")?d="user_lists_company":(_.contains(a.sourceListTypeName,"Persons")||_.contains(a.sourceListTypeName,"Employees"))&&(d="user_lists_employee"),c.go(d,{selectList:b})},b.$watch("$parent.baseVm.listData.subscriptionLists",function(a){j.grid.data=i(a)})}]),angular.module("dorgEuiApp").service("userListsSubscriptionsService",["$grid",function(a){this.grid=function(){var b=a.$defaultGrid("subscription",[],!0,!1);return b}}]),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("user_lists_base",{abstract:!0,controller:"userListsBaseController",controllerAs:"baseVm",templateUrl:"app/views/user-lists/_shared/base.tpl.html",params:{suppressionLoc:null},resolve:{$title:function(){return"My Lists"}},onExit:["$state",function(a){a.params.suppressionLoc=null}],url:"/account/lists"}),a.state("viewMyLists",{parent:"user_lists_base",url:"",controller:["$state",function(a){a.params.suppressionLoc?a.go("user_lists_"+a.params.suppressionLoc):a.go("user_lists_company")}]}),a.state("user_lists_company",{parent:"user_lists_base",controller:"userListsCompanyController",controllerAs:"companyVm",templateUrl:"app/views/user-lists/company/company.tpl.html",params:{selectList:null},resolve:{$title:function(){return"Company Lists"}},url:"/company"}),a.state("user_lists_employee",{parent:"user_lists_base",controller:"userListsEmployeeController",controllerAs:"employeeVm",templateUrl:"app/views/user-lists/employee/employee.tpl.html",params:{selectList:null},resolve:{$title:function(){return"Employee Lists"}},url:"/employee"}),a.state("user_lists_searches",{parent:"user_lists_base",controller:"userListsSearchesController",controllerAs:"searchesVm",templateUrl:"app/views/user-lists/searches/searches.tpl.html",params:{selectList:null},resolve:{$title:function(){return"Saved Search Lists"}},url:"/searches"}),a.state("user_lists_alerts",{parent:"user_lists_base",controller:"userListsAlertsController",controllerAs:"alertsVm",templateUrl:"app/views/user-lists/alerts/alerts.tpl.html",resolve:{$title:function(){return"Alert Lists"}},url:"/alerts"}),a.state("user_lists_subscriptions",{parent:"user_lists_base",controller:"userListsSubscriptionsController",controllerAs:"subscriptionVm",templateUrl:"app/views/user-lists/subscriptions/subscriptions.tpl.html",params:{unsubscribe:null},resolve:{$title:function(){return"Subscription Lists"}},url:"/subscriptions"}),a.state("user_lists_subscriptions_unsubscribe",{parent:"user_lists_base",url:"/subscriptions/{unsubscribe:.*}",controller:["$state","unsubscribe",function(a,b){a.go("user_lists_subscriptions",{unsubscribe:b})}],resolve:{unsubscribe:["$stateParams",function(a){return a.unsubscribe}]}}),a.state("user_lists_base_redirect",{url:"/list/subscription/{unsubscribe:.*}",controller:["$state",function(a,b){a.go("user_lists_subscriptions",{unsubscribe:b})}],resolve:{unsubscribe:["$stateParams",function(a){return a.unsubscribe}]}})}]),angular.module("dorgEuiApp").factory("$userSettingsStatic",function(){var a={},b="app/views/user-settings/partials/";return a.partials=b,a.crms={SFDC:{displayName:"Salesforce",url:b+"crm-partials/salesforce.html",mappingUrl:b+"crm-partials/mapping-partials/salesforce-mapping.html"},HUBSPOT:{displayName:"HubSpot",url:b+"mat-partials/hubspot.html",mappingUrl:b+"mat-partials/mapping-partials/hubspot-mapping.html"},HUBSPOTCRM:{displayName:"HubSpot",url:b+"crm-partials/hubspot.html",mappingUrl:b+"crm-partials/mapping-partials/hubspot-mapping.html"},MARKETO:{displayName:"Marketo",url:b+"mat-partials/marketo.html",mappingUrl:b+"mat-partials/mapping-partials/marketo-mapping.html"},SUGAR:{displayName:"SugarCRM",url:b+"crm-partials/sugarcrm.html",mappingUrl:b+"crm-partials/mapping-partials/sugarcrm-mapping.html"},MSDYNAMICS:{displayName:"Microsoft Dynamics",url:b+"crm-partials/msdynamics.html"},TALENTROVER:{displayName:"Talent Rover",url:b+"crm-partials/salesforce.html",mappingUrl:b+"crm-partials/mapping-partials/salesforce-mapping.html"},NETSUITE:{displayName:"NetSuite",url:b+"crm-partials/netsuite.html",mappingUrl:b+"crm-partials/mapping-partials/netsuite-mapping.html"},PARDOT:{displayName:"Pardot",url:b+"mat-partials/pardot.html",mappingUrl:b+"mat-partials/mapping-partials/pardot-mapping.html"},ELOQUA:{displayName:"Eloqua",url:b+"mat-partials/eloqua.html",mappingUrl:b+"mat-partials/mapping-partials/eloqua-mapping.html"},ACTON:{displayName:"Act-On",url:b+"mat-partials/acton.html",mappingUrl:b+"mat-partials/mapping-partials/acton-mapping.html"},SALESLOFT:{displayName:"SalesLoft",url:b+"sdr-partials/salesloft.html",mappingUrl:b+"sdr-partials/mapping-partials/salesloft-mapping.html"},OUTREACH:{displayName:"Outreach",url:b+"sdr-partials/outreach.html",mappingUrl:b+"sdr-partials/mapping-partials/outreach-mapping.html"},ZOHO:{displayName:"Zoho",url:b+"crm-partials/zoho.html",mappingUrl:b+"crm-partials/mapping-partials/zoho-mapping.html"},PIPEDRIVE:{displayName:"Pipedrive",url:b+"crm-partials/pipedrive.html",mappingUrl:b+"crm-partials/mapping-partials/pipedrive-mapping.html"},ORACLESALESCLOUD:{displayName:"Oracle Sales Cloud",url:b+"crm-partials/oraclesalescloud.html",mappingUrl:b+"crm-partials/mapping-partials/oraclesalescloud-mapping.html"}},a.mats=[{name:"MARKETO",displayName:"Marketo",url:b+"mat-partials/marketo.html",mappingUrl:b+"mat-partials/mapping-partials/marketo-mapping.html"},{name:"ELOQUA",displayName:"Eloqua",url:b+"mat-partials/eloqua.html",mappingUrl:b+"mat-partials/mapping-partials/eloqua-mapping.html"},{name:"HUBSPOT",displayName:"HubSpot",url:b+"mat-partials/hubspot.html"},{name:"PARDOT",displayName:"Pardot",url:b+"mat-partials/pardot.html"},{name:"ACTON",displayName:"Act-On",url:b+"mat-partials/acton.html"}],a.sdrs=[{name:"SALESLOFT",displayName:"SalesLoft",url:b+"sdr-partials/salesloft.html",mappingUrl:b+"sdr-partials/mapping-partials/salesloft-mapping.html"},{name:"OUTREACH",displayName:"Outreach",url:b+"sdr-partials/outreach.html",mappingUrl:b+"sdr-partials/mapping-partials/outreach-mapping.html"}],a.salesforce=[{displayName:"Account",url:b+"crm-partials/mapping-partials/salesforce-mapping-account.html"},{displayName:"Contact",url:b+"crm-partials/mapping-partials/salesforce-mapping-contact.html"},{displayName:"Lead",url:b+"crm-partials/mapping-partials/salesforce-mapping-lead.html"}],a.defaultLanding=[{displayName:"Search",route:"viewQuickSearch"},{displayName:"Dashboard",route:"viewDashboard"},{displayName:"Advanced Search",route:"perform_search"}],a.defaultExportOptions=[{displayName:"Export Options...",option:-1},{displayName:"Companies",option:"companies"},{displayName:"Employees",option:"persons"}],a.defaultExportObj={companies:{options:[],format:""},persons:{options:[],format:""},intel:{options:[],format:""}},a.passwordChange={MISSING_UPPER_CASE:"Your password must contain an Upper Case Character",MISSING_LOWER_CASE:"Your password must contain a Lower Case Character",MISSING_SPECIAL_CHARACTER:"Your password must contain a Special Character",MISSING_NUMBER:"Your password must contain a Number",REPEATED:"This password has been used previously"},a.tabsets=[{heading:"My Profile",tpl:b+"my-profile.html"},{heading:"CRM Settings",tpl:b+"crm-settings.html"},{heading:"MAT Settings",tpl:b+"mat-settings.html"},{heading:"SDR Settings",tpl:b+"sdr-settings.html"},{heading:"Site Preferences",dunsControlHeading:"Site Settings",tpl:b+"dashboard-settings.html"}],a.eloquaDorgFields={contactEmail:"Email Address",contactFirstName:"First Name",contactLastName:"Last Name",contactMiddleName:"Contact Middle Name",contactSalutation:"Contact Salutation",companyName:"Company Name",companyWebsite:"Company Website",contactTitle:"Title",contactAddress:"Address",contactCity:"City",contactState:"State or Province",contactZIPCode:"Zip or Postal Code",contactCountry:"Country",directPhone:"Business Phone",cellPhone:"Mobile Phone",department:"Department",departments:"Departments",reportsTo:"Reports to",linkedInURL:"LinkedIn URL",managementLevel:"Management Level",titleCategory:"Title Category",industry:"Industry",fortuneRank:"Fortune Rank",revenue:"Revenue (mil)",employees:"Employees",address:"Address",city:"City",stateOrProvince:"State or Province",leadSourceOriginal:"Lead Source - Original",jobRole:"Job Role",sicCodes:"SIC Codes",naicsCodes:"NAICS Codes"},a}),function(){"use strict";function a(a){var b=this;b.run=function(){a.dismissAll("run")},b.close=function(){a.dismissAll("cancel")}}a.$inject=["$uibModalStack"],angular.module("dorgEuiApp").component("confirmAppendClean",{templateUrl:"app/views/user-settings/partials/mat-partials/modals/confirmAppendClean/confirmAppendClean.html",controller:a})}(),function(){"use strict";function a(a,b){var c=this;c.showFields={emailReason:!1,removeFromDisco:!1,dateUpdated:!1,contactId:!1,emailInvalid:!1},c.$onInit=function(){a.checkedFieldsArray.map(function(a){"email_invalid_reason"===a.internalName?c.showFields.emailReason=!0:"discoverorg_removed"===a.internalName?c.showFields.removeFromDisco=!0:"date_updated"===a.internalName?c.showFields.dateUpdated=!0:"discoverorg_id"===a.internalName?c.showFields.contactId=!0:"email_invalid"===a.internalName&&(c.showFields.emailInvalid=!0)})},c.run=function(){b.dismissAll("run")},c.close=function(){b.dismissAll("cancel")}}angular.module("dorgEuiApp").component("fieldWarning",{templateUrl:"app/views/user-settings/partials/mat-partials/modals/fieldWarning/fieldWarning.html",controller:a}),a.$inject=["userSettingsService","$uibModalStack"]}(),function(){"use strict";function a(a,b,c){var d=this;d.listSize=b,d.close=c.close,d.isTooLarge=b>=5e5,d.listName=a}a.$inject=["listName","listSize","$uibModalInstance"],angular.module("dorgEuiApp").controller("listSizeWarningController",a)}(),function(){"use strict";function a(a,b,c){c.optOutType=a.optOutType;var d=this;d.ok=function(){b.dismissAll("ok")},d.close=function(){b.dismissAll("cancel")}}angular.module("dorgEuiApp").component("optOutWarning",{templateUrl:"app/views/user-settings/partials/mat-partials/modals/optOutWarning/optOutWarning.html",controller:a}),a.$inject=["userSettingsService","$uibModalStack","$scope"]}(),angular.module("dorgEuiApp").controller("UserSettingsCtrl",["dorgValidation","$scope","$rootScope","userSettingsService","$timeout","$http","$interval","Flash","$userSettingsStatic","$location","downloadExportService","$state","$uibModal","dorgConfig","featureFlagService","$q",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){o.getFeatureFlags().then(function(a){var c=_.findWhere(a.data,{name:"triggerstoscoops"});c&&c.active?(b.topicsText="Topics",b.useTopicsPlaceholderText="Select Scoop Topics..."):(b.topicsText="Categories",b.useTopicsPlaceholderText="Select Trigger Categories...")})}function r(){o.getFeatureFlags().then(function(a){var c=_.findWhere(a.data,{name:"triggerstoscoops"});c&&c.active?b.intelText="Scoop":b.intelText="Trigger"})}function s(a){return!!a&&"Invalid characters found: "+a}function t(a,c){if(a.programName){if(a.programName.indexOf(".")>-1)return void(b.marketoProgramNameError=!0);c.listName=a.programName+"."+a.listName}else c.listName=a.listName;return c}function u(){d.getDunsAccessSetting().then(function(a){b.canViewDunsAccessSettings=!1,b.dunsAccessSetting={},a.data&&!a.data.disableDunsAccess&&(b.canViewDunsAccessSettings=!0,b.dunsAccessSetting=a.data)})}function v(){return d.updateDunsAccessSetting(b.dunsAccessSetting)}function w(){var a={landing:b.defaultLandingPageSelect,exports:b.selectedFields};return _.has(a.exports,b.defaultExportOptionsSelect)||(a.exports[b.defaultExportOptionsSelect]={}),a.exports[b.defaultExportOptionsSelect].format=b.formatsDefault,b.isSavingUserPrefs=!0,d.$setPrefs(a)}function x(){d.hasCustomerCrmSettings()&&d.getCustomerCrmSettings(K).then(function(a){b.customerCrmSettings=a,a.hasOwnProperty("updateBlankFieldsOnly")||(b.customerCrmSettings.updateBlankFieldsOnly="1"),a.hasOwnProperty("outreachAccountCreationOption")||(b.customerCrmSettings.outreachAccountCreationOption="1"),a.hasOwnProperty("requireAccountForOutreach")||(b.customerCrmSettings.requireAccountForOutreach="0"),b.customerCrmSettings.outreachAppendAndCleanUser&&(b.outreachAppendAndCleanEnabled=!0)}),d.hasUserCrmSettings()&&d.getUserCrmSettings(K).then(function(a){b.userCrmSettings=a;var c=["hubspotWebhookOptedOut","marketoConnectorOptedOut","hubspotConnectorOptedOut","eloquaConnectorOptedOut","marketoWebhookOptedOut","actOnConnectorOptedOut","outreachConnectorOptedOut","zohoConnectorOptedOut"];c.forEach(function(a){b.userCrmSettings.hasOwnProperty(a)||(b.userCrmSettings[a]=0)}),b.userCrmSettings.hasOwnProperty("outreachAppendAndCleanEmail")&&!b.userCrmSettings.outreachAppendAndCleanEmail||(b.outreachAppendAndCleanEmailEnabled=!0)})}function y(a,c){"CRM"===a?b.isActiveCRM=null!==b.activeCRM&&c===b.activeCRM:"MAT"===a?b.isActiveMAT=null!==b.activeMAT&&c===b.activeMAT:b.isActiveSDR=null!==b.activeSDR&&c===b.activeSDR}function z(a,c){var e="";null!==c&&(e=c.name),null!==c&&"HUBSPOTCRM"===e?b.toggleMatEnabled("HUBSPOT",!1):"CRM"===a&&b.toggleMatEnabled("HUBSPOT",!0),null!==c&&"HUBSPOT"===e?b.toggleCrmEnabled("HUBSPOTCRM",!1):"MAT"===a&&b.toggleCrmEnabled("HUBSPOTCRM",!0),"CRM"===a?b.crmCredsValidated=!1:"MAT"===a?b.matCredsValidated=!1:b.sdrCredsValidated=!1;var f={crmType:a,supportedCrmType:e};d.saveActiveCrm(f).then(function(a){"CRM"===a.crmType?b.activeCRM=c:"MAT"===a.crmType?b.activeMAT=c:b.activeSDR=c,y(a.crmType,c),d.updateNavigation(),_.has(a,"activeCrm")&&null!=a.activeCrm&&h.create("success","Saved successfully.","flash")})}b.startsWith="",b.salesforceTokenExpired=!1;var A={year:"numeric",month:"numeric",day:"numeric"},B=c.Session.navigation,C=B.$href("activeMat"),D=(B.$href("activeCrm"),B.$href("salesloftAuthUrl")),E=!!B.$href("duns_access_settings"),F=!c.Session.$crmDisabled,G=null!==C,H=null!==D;b.dunsControlFeatureFlag=o.findFeatureFlag(null,"duns_control"),b.appendAndCleanSettings={enabled:!1,listName:"",programName:"",frequency:"weekly",nextRun:null},b.outreachAppendAndCleanEnabled=!1,b.outreachAppendAndCleanEmailEnabled=!1;var I=function(){return{enabled:!1,listName:"",frequency:null}};b.marketoProgramNameError=!1,b.marketoListNameError=!1,b.enableStatusEmail=!1,b.enableAppendAndClean=o.findFeatureFlag(null,"MAC"),b.appendAndCleanNoList=[],o.getFeatureFlags().then(function(a){b.enableAppendAndClean=o.findFeatureFlag(a.data,"MAC"),b.appendAndCleanNoList=o.findFeatureFlag(a.data,"MAC_list")}),b.getCrmSettings=x,q(),d.accountSettingsTabUsageTrack();var J=d.$get(),K={supportedCrmType:"",crmRecordType:{}},L=angular.copy(c.Session.account),M="[New custom field]",N=function(){h.create("success","Settings Saved Successfully.","flash")},O=function(a){b.crmSettingsSuccess=a,b.crmSettingsError=!a,a?h.create("success","Settings Saved Successfully.","flash"):h.create("success","Invalid Credentials.","fail")},P=function(a,c){d.$hasSupportedCrms&&d.getActiveCrm({crmType:a}).then(function(d){var e=null;null!==d&&null!==d.activeCrm&&_.each(c,function(a){if(a.name===d.activeCrm)return e=a,!1}),"CRM"===d.crmType?(b.activeCRM=e,b.selectedCRM=e,null!=e&&"HUBSPOTCRM"===e.name?b.toggleMatEnabled("HUBSPOT",!1):b.toggleMatEnabled("HUBSPOT",!0)):"MAT"===d.crmType?(b.activeMAT=e,b.selectedMAT=e,null!=e&&"HUBSPOT"===e.name?b.toggleCrmEnabled("HUBSPOTCRM",!1):b.toggleCrmEnabled("HUBSPOTCRM",!0)):(b.activeSDR=e,b.selectedSDR=e),y(a,e)})},Q=function(a,b){var c=[];return _.each(a,function(a){a.crmField===b&&c.push(a)}),c},R=function(a){return Q(b.mapFields,a)},S=function(a){return Q(b.mapConstants,a)},T=function(){b.mapConstants.push(_.clone(b.newConstant)),b.newConstant={crmField:null,constantValue:null}},U=function(a,b){_.each(a,function(a){a.disabled=b})},V=function(){_.each(b.mapFields,function(a){if(a.disabled===!0&&a.crmField!==b.identifierField&&S(a.crmField).length<1){var c=R(a.crmField);return U(c,!1),!1}})},W=function(){_.each(b.mapConstants,function(a){if(a.disabled===!0&&R(a.crmField).length<1){var b=S(a.crmField);return U(b,!1),!1}})},X=function(a){_.each(a,function(c){if(null!==c.crmField&&!_.isEmpty(c.crmField)){var d=Q(a,c.crmField);d.length>1?(_.each(d,function(a){a.hasError=!0}),b.canSaveFieldMappings=!1):c.hasError=!1}})},Y=function(){b.canSaveFieldMappings=!0,X(b.mapFields),X(b.mapConstants),b.canSaveFieldMappings!==!0&&h.create("success","You have already mapped this value. Please try another one.","fail")},Z={INVALID:"new_constant_invalid",ALREADY_MAPPED_INVALID:"new_constant_already_mapped_invalid",DUPLICATE_CONFIRMATION_NEEDED:"new_constant_duplicate_confirmation_needed",VALID:"new_constant_valid"},aa=function(a){if(_.isEmpty(a.crmField)||_.isEmpty(a.constantValue))return Z.INVALID;var b=S(a.crmField);if(b.length>0)return Z.ALREADY_MAPPED_INVALID;var c=R(a.crmField);return c.length>0?Z.DUPLICATE_CONFIRMATION_NEEDED:Z.VALID},ba=function(a){switch(a){case Z.INVALID:case Z.ALREADY_MAPPED_INVALID:return!1;case Z.DUPLICATE_CONFIRMATION_NEEDED:return window.confirm("You have already mapped this field above. Do you wish to set a constant for this field instead?");
default:return!0}},ca=function(a){if(!_.isEmpty(a)){var b=R(a.crmField);b.length>0&&U(b,!0)}},da=function(a){var b=aa(a),c=ba(b);return c?(Z.DUPLICATE_CONFIRMATION_NEEDED===b&&ca(a),T()):Z.ALREADY_MAPPED_INVALID===b&&h.create("success","You have already mapped this value. Please try another one.","fail"),c};if(b.usTab="tab-0",b.changeSettingsTab=function(a){b.customerCrmSettings||b.getCrmSettings(),b.usTab!==a&&("tab-1"!==a||null===b.selectedCRM||_.isUndefined(b.selectedCRM)?"tab-2"!==a||null===b.selectedMAT||_.isUndefined(b.selectedMAT)?"tab-3"!==a||null===b.selectedSDR||_.isUndefined(b.selectedSDR)||!b.isShowAuthorizationResult&&b.sdrCredsValidated||b.getCrmCredentials(b.selectedSDR.name,"SDR"):!b.isShowAuthorizationResult&&b.matCredsValidated||(b.getCrmCredentials(b.selectedMAT.name,"MAT"),b.reportUrl="","MARKETO"===b.selectedMAT.name&&(b.reportUrl=d.getUserReport(b.selectedMAT.name,"LEAD")),d.getEmailSubscription().then(function(a){b.enableStatusEmail="true"===a.data}),d.getScheduledJob().then(function(a){var c="",d="",e=a.data.listName.split(".");e.length>1?(c=e[0],d=e[1]):d=a.data.listName,b.appendAndCleanSettings={enabled:a.data.enabled,listName:d,programName:c,frequency:a.data.jobFrequency.toLowerCase(),nextRun:new Date(a.data.nextRun).toLocaleDateString("en-US",A)}}),d.getLastRunDate().then(function(a){""===a.data?b.lastRunDate="":b.lastRunDate=new Date(a.data).toLocaleDateString("en-US",A)})):!b.isShowAuthorizationResult&&b.crmCredsValidated||b.getCrmCredentials(b.selectedCRM.name,"CRM")),"tab-4"===a&&e(function(){$("#search-industries .ui-select-search").focus().blur()},100),b.settingsSuccess=!1,b.usTab=a},d.$hasSupportedCrms&&d.getSupportedCrms().then(function(a){a=_.sortBy(a,"displayName"),b.supportedCrms=a,P("CRM",b.supportedCrms),b.idx=0}),E&&u(),_.find(c.Session.account.roles,{id:11})&&(b.isIndividualUser=!0,b.cancelSubject="Please cancel my ZoomInfo subscription - "+c.Session.account.username,b.cancelBodyLine="I would like to cancel my ZoomInfo subscription."),d.getCompanyProfile().then(function(a){b.loggedInUserCompanyData=a}),b.tabsets=i.tabsets,b.defaultLandingPage=i.defaultLanding,b.defaultExportOptions=i.defaultExportOptions,b.mats=i.mats,b.sdrs=i.sdrs,b.salesforceFM=i.salesforce,b.talentroverFM=i.talentrover,b.netsuiteFM=i.netsuite,b.tCrms=i.crms,b.eloquaDorgFields=i.eloquaDorgFields,b.showFieldMapSettings=!1,b.checkedUncheckedAll={includeWhenCreating:!1,includeWhenUpdating:!1,updateBlankOnly:!1,includeWhenAutoUpdating:!1},d.canFit){var ea=_.findIndex(b.tabsets,function(a){return"DealPredict Settings"===a.heading});ea<0&&b.tabsets.splice(b.tabsets.length-1,0,{heading:"DealPredict Settings",tpl:i.partials+"fit-settings.html"}),l.params.goToFit&&b.$eval("changeSettingsTab")("tab-"+_.findIndex(b.tabsets,{tpl:"app/views/user-settings/partials/fit-settings.html"})),b.company={},b.technology={},b.fitEnabled=0,b.$disableSubmissionFit=!1;var fa,ga={};d.getSupportedFits().then(function(a){_.each(_.without(_.keys(a.userLeadModel),"enabled","version","minEmployeeCount","maxEmployeeCount","minRevenue","maxRevenue"),function(b){a.userLeadModel[b]=_.values(a.userLeadModel[b])}),fa=a,b.userLeadModel=a.userLeadModel,b.fitEnabled=b.userLeadModel.enabled;var c=function(a,b){if(!a)return[];if(!b)return a;for(var c=[],d=_.pluck(b,"id"),e=0,f=a.length;e<f;++e){var g=d.indexOf(a[e]);g>-1&&c.push(b[g])}return c},d=c(a.userLeadModel.industryIds,a.industryOptions),e=c(a.userLeadModel.departmentIds,a.departmentOptions),f=c(a.userLeadModel.jobFunctionIds,a.jobFunctionOptions),g=c(a.userLeadModel.seniorityLevelIds,a.seniorityLevelOptions),h=c(a.userLeadModel.intelCategoryIds,a.intelCategoryOptions),i=c(a.userLeadModel.oppAlertCategoryIds,a.oppAlertCategoryOptions),j=c(a.userLeadModel.technologies,void 0);b.industry={selected:d,list:a.industryOptions},b.department={selected:e,list:a.departmentOptions},b.jobFunction={selected:f,list:a.jobFunctionOptions},b.seniorityLevel={selected:g,list:a.seniorityLevelOptions},b.intelCategory={selected:h,list:a.intelCategoryOptions},b.oppAlertCategory={selected:i,list:a.oppAlertCategoryOptions},b.technology={selected:j,list:[]},ga.userLeadModel=_.cloneDeep(a.userLeadModel),ga.selectedindustries=_.cloneDeep(d),ga.selectedtechnologies=_.cloneDeep(j),ga.selecteddepartments=_.cloneDeep(e),ga.selectedjobfunctions=_.cloneDeep(f),ga.selectedsenioritylevels=_.cloneDeep(g),ga.selectedintelcategories=_.cloneDeep(h),ga.selectedoppalertcategories=_.cloneDeep(i),b.$watchCollection(function(){return{empMin:b.userLeadModel.minEmployeeCount,empMax:b.userLeadModel.maxEmployeeCount,revMin:b.userLeadModel.minRevenue,revMax:b.userLeadModel.maxRevenue,industry:b.industry.selected,dept:b.department.selected,job:b.jobFunction.selected,senior:b.seniorityLevel.selected,intel:b.intelCategory.selected,oppalert:b.oppAlertCategory.selected,tech:b.technology.selected}},function(a){b.$disableSubmissionFit=_.filter(a,function(a){return!_.isUndefined(a)&&!_.isNull(a)&&(!_.isArray(a)||a.length>0)}).length<1})}),b.getTechnologyList=function(a){return""===a?(b.technology.list=[],[]):void d.getTechnologyList(fa,"technologies",a).then(function(a){b.technology.list=a})}}if(b.tabsets[1]._hidden=!F,b.tabsets[2]._hidden=!G,b.tabsets[3]._hidden=!d.hasExportAccess||!H,b.hasExportAccess=d.hasExportAccess,b.allowedHubspotWebhooks=d.allowedHubspotWebhooks,b.allowedMarketoWebhooks=d.allowedMarketoWebhooks,b.settingsSuccess=!1,b.canSave=!1,b.canSaveFieldMappings=!0,b.crmCredsValidated=!1,b.matCredsValidated=!1,b.crmLoading=!1,b.isSaving=!1,b.isGetWebHookURL=!1,b.webHookUrl="",b.isShowAuthorizationResult=!1,b.passwordChangeError=!1,b.passwordInvalidCurrent=!1,b.isSavingUserPrefs=!1,b.exportOptionsVisible=null,b.changePsw={currentPassword:"",newPassword:"",confirmNewPassword:""},b.crmCredentialValidationFormData={},b.matCredentialValidationFormData={},b.sdrCredentialValidationFormData={},b.selectedSalesforceFields={},b.crmFields=[],b.constantCrmFields=[],b.mapFields=[],b.identifierField=null,b.mapConstants=[],b.newConstant={crmField:null,constantValue:null},b.fieldMapping={},b.selectedFields=J.exports||i.defaultExportObj,b.idx=0,b.currentSalesforceFM=b.salesforceFM[b.idx],b.confirmtoken="",b.defaultLandingPageSelect=_.has(c.Session.account,"preferences.landing")?c.Session.account.preferences.landing:b.defaultLandingPage[0].route,b.defaultExportOptionsSelect=b.defaultExportOptions[0].option,b.userProfileFormData=L,_.has(L,"managerNotesJson"))try{b.userProfileFormData.managerNotes=JSON.parse(L.managerNotesJson)}catch(a){b.userProfileFormData.managerNotes={}}else b.userProfileFormData.managerNotes={};b.userProfileFormData.userType=_.isEmpty(L.roles)?"":L.roles[0].description,b.isActiveCRM=!1,b.isActiveMAT=!1,b.isActiveSDR=!1,P("MAT",b.mats),P("SDR",b.sdrs),r();var ha=function(a){m.open({openedClass:"warning-modal",templateUrl:"app/views/user-settings/partials/mat-partials/modals/confirmAppendClean/confirmAppendClean.modal.html"}).result.then(function(){},function(c){"run"===c&&b.updatePendAndClean(a)})},ia=function(a){var c=!1;d.checkedFieldsArray=[],b.savedMarketoFieldMappings.map(function(a){a.crmField.checkedField!==!0&&a.crmField.requiredField!==!0||a.nameOfCrmField||(c=!0,d.checkedFieldsArray.push(a.crmField))}),c?m.open({openedClass:"warning-modal",templateUrl:"app/views/user-settings/partials/mat-partials/modals/fieldWarning/fieldWarning.modal.html"}).result.then(function(){},function(b){"run"===b&&ha(a)}):ha(a)};b.checkForSpecialChars=function(c){b.firstNameError=s(a.findSpecialChars(c.firstName,a.nameRegex)),b.lastNameError=s(a.findSpecialChars(c.lastName,a.nameRegex)),b.phoneError=s(a.findSpecialChars(c.phone,a.phoneRegex)),b.invalidCharacters=b.firstNameError||b.lastNameError||b.phoneError},b.verifyMarketoListThenRunAppendClean=function(a){b.marketoListEmptyOrNotFound=!1,b.marketoListNameError=!1,b.marketoProgramNameError=!1;var c=I();if(a.listName){if(a.listName.indexOf(".")>-1)return void(b.marketoListNameError=!0);if(c=t(a,c),b.marketoProgramNameError===!0)return;d.marketoListSize({listName:c.listName}).then(function(d){d<=0?b.marketoListEmptyOrNotFound=!0:d>2e5?m.open({openedClass:"warning-modal",templateUrl:"app/views/user-settings/partials/mat-partials/modals/listSizeWarning/listSizeWarning.tpl.html",controller:"listSizeWarningController",controllerAs:"listSizeVm",resolve:{listSize:function(){return d},listName:function(){return c.listName}}}).result.then(function(){ia(a)}):ia(a)})}else!b.appendAndCleanNoList||a.listName&&""!==a.listName?ia(a):b.marketoListEmptyOrNotFound=!0},b.saveSiteSettings=function(){b.isSavingUserPrefs=!0;var a;a=b.canViewDunsAccessSettings?p.all([v(),w()]):p.all([w()]),a.then(function(a){N(),e(d.updateAccount,100)}).finally(function(){b.isSavingUserPrefs=!1})},b.savePrefs=function(){var a={landing:this.defaultLandingPageSelect,exports:this.selectedFields};_.has(a.exports,this.defaultExportOptionsSelect)||(a.exports[this.defaultExportOptionsSelect]={}),a.exports[this.defaultExportOptionsSelect].format=this.formatsDefault,b.isSavingUserPrefs=!0,d.$setPrefs(a).then(function(a){""!==a&&a||N()}).then(e(d.updateAccount,100)).finally(function(){b.isSavingUserPrefs=!1})},b.changePassword=function(){d.$setPassword(this.changePsw).then(function(a){"success"===a.status?(b.passwordChangeError=!1,b.passwordInvalidCurrent=!1,h.create("success","Password has been updated.","flash")):("INVALID_CURRENT"===a.$$msgType?(b.passwordInvalidCurrent=!0,b.passwordChangeError=!1):(b.passwordInvalidCurrent=!1,b.passwordChangeError=!0,b.passwordChangeErrorText=i.passwordChange[a.$$msgType]||"There was an error submitting this password"),h.create("success","Password has not been updated.","fail"),h.pause())})},b.validateThenLoadMappings=function(a,c){var d=b.validateAndSaveCrmCredentials(a,c).then(function(c){if(c)switch(a){case"ELOQUA":b.getMatFieldMappings(a);break;case"HUBSPOT":b.idx=1;case"HUBSPOTCRM":b.getHubspotOwners();default:b.CRMValidated=!0,b.getFieldMappings(a)}return c});return d},b.getHubspotOwners=function(){d.getHubspotOwners().then(function(a){if(b.hubspotOwners=a,b.userCrmSettings.hubspotOwner){var c=_.pluck(a,"id");_.includes(c,b.userCrmSettings.hubspotOwner)||(b.userCrmSettings.hubspotOwner=null,d.saveUserSettings({},b.userCrmSettings))}else _.each(b.hubspotOwners,function(a){if(a.email===b.userProfileFormData.email)return b.userCrmSettings.hubspotOwner=a.id,d.saveUserSettings({},b.userCrmSettings),!1})})},b.checkFieldsForAppendAndClean=function(a){"MARKETO"===a?b.apDisabled=b.savedMarketoFieldMappings.some(function(a){if(!(a.crmField.requiredField!==!0||a.nameOfCrmField&&a.includeWhenUpdating))return!0}):d.checkAppendAndCleanRequiredFields(a).then(function(c){b.outreachAppendCleanDisabled="false"===c.data,b.outreachAppendCleanDisabled&&b.toggleAppendAndClean(a,!0)})},b.updatePendAndClean=function(a){var b=I();b=t(a,b),b.enabled=a.enabled,b.frequency=a.frequency,d.updateAppendAncCleanSettings(b).then(function(a){h.create("success","Settings Saved Successfully.","flash")})},b.toggleAppendAndClean=function(a,c){if("MARKETO"===a)b.appendAndCleanSettings.enabled=!c,b.appendAndCleanSettings.enabled===!1&&(d.deleteScheduledJob(),b.appendAndCleanSettings={listName:"",frequency:"weekly",nextRun:null});else if("OUTREACH"===a){if(b.outreachAppendCleanDisabled&&!c)return;b.outreachAppendAndCleanEnabled=!c,d.toggleAppendAndClean(a,b.outreachAppendAndCleanEnabled).then(function(){x(),h.create("success","Settings Saved Successfully.","flash")})}},b.toggleAppendAndCleanEmail=function(a,c){if("OUTREACH"===a){if(b.outreachAppendCleanDisabled&&!c)return;b.outreachAppendAndCleanEmailEnabled=!c,d.toggleAppendAndCleanEmail(a,b.outreachAppendAndCleanEmailEnabled).then(function(){x(),h.create("success","Settings Saved Successfully.","flash")})}},b.toggleStatusEmail=function(a){b.enableStatusEmail=!a,d.setEmailSubscription(!a)},b.getTodaysDate=function(){var a=new Date,b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear();return c+"/"+b+"/"+d},b.getCrmCredentials=function(a,c){K.supportedCrmType=a;var e=0;d.getCrmCreds(K).then(function(f){switch(c){case"CRM":b.crmCredentialValidationFormData=f;break;case"MAT":b.matCredentialValidationFormData=f;break;case"SDR":b.sdrCredentialValidationFormData=f}"MSDYNAMICS"===a&&"tab-1"===b.usTab?(b.crmCredentialValidationFormData.confirmPassword=b.crmCredentialValidationFormData.password,d.hasFieldMapPermission()&&(b.showFieldMapSettings=!0)):"SUGAR"===a&&"tab-1"===b.usTab?(b.crmCredentialValidationFormData.confirmPassword=b.crmCredentialValidationFormData.password,e=1,b.validateThenLoadMappings(a,e)):"MARKETO"===a&&"tab-2"===b.usTab?(b.matCredentialValidationFormData.confirmEncryptionKey=b.matCredentialValidationFormData.encryptionKey,e=1,b.validateThenLoadMappings(a,e)):"PARDOT"===a&&"tab-2"===b.usTab?(b.matCredentialValidationFormData.confirmPassword=b.matCredentialValidationFormData.password,e=1,b.validateThenLoadMappings(a,e)):"ELOQUA"===a&&"tab-2"===b.usTab?(b.matCredentialValidationFormData.confirmPassword=b.matCredentialValidationFormData.password,e=1,b.validateAndSaveCrmCredentials(a,e).then(function(c){c&&b.getMatFieldMappings(a)})):"ZOHO"===a&&"tab-1"===b.usTab?(b.crmCredentialValidationFormData.confirmRefreshToken=b.crmCredentialValidationFormData.refreshToken,e=1,b.validateThenLoadMappings(a,e).then(function(a){b.crmCredsValidated=a,b.isShowAuthorizationResult&&(a?h.create("success","The authorization succeeded.","flash"):h.create("error","The authorization failed.","fail"),b.isShowAuthorizationResult=!1)})):"ORACLESALESCLOUD"===a&&"tab-1"===b.usTab?(b.crmCredentialValidationFormData.confirmPassword=b.crmCredentialValidationFormData.password,e=1,b.validateThenLoadMappings(a,e)):"PIPEDRIVE"===a&&"tab-1"===b.usTab?(b.crmCredentialValidationFormData.confirmApiToken=b.crmCredentialValidationFormData.apiToken,e=1,b.validateThenLoadMappings(a,e)):"HUBSPOT"===a&&"tab-2"===b.usTab?(b.idx=1,b.isShowAuthorizationResult?(b.matCredsValidated?h.create("success","The authorization succeeded.","flash"):h.create("error","The authorization failed.","flash"),b.isShowAuthorizationResult=!1):b.matCredsValidated=f.crmCredsValidated,e=1,b.validateThenLoadMappings(a,e)):"HUBSPOTCRM"===a&&"tab-1"===b.usTab?(b.idx=1,b.isShowAuthorizationResult?(b.crmCredsValidated?h.create("success","The authorization succeeded.","flash"):h.create("error","The authorization failed.","flash"),b.isShowAuthorizationResult=!1):b.crmCredsValidated=f.crmCredsValidated,e=1,b.validateThenLoadMappings(a,e)):"SFDC"!==a&&"TALENTROVER"!==a||"tab-1"!==b.usTab?"NETSUITE"===a&&"tab-1"===b.usTab?(b.crmCredentialValidationFormData.confirmPassword=b.crmCredentialValidationFormData.password,b.idx=1,b.crmCredentialValidationFormData.password&&b.crmCredentialValidationFormData.account_id&&(e=1,b.validateThenLoadMappings(a,e))):"ACTON"===a&&"tab-2"===b.usTab?(b.idx=1,b.matCredentialValidationFormData.accessToken&&(e=1,b.validateAndSaveCrmCredentials(a,e).then(function(c){b.matCredsValidated=c,b.isShowAuthorizationResult&&(c?h.create("success","The authorization succeeded.","flash"):h.create("error","The authorization failed.","flash"),b.isShowAuthorizationResult=!1),c&&b.matCredentialValidationFormData.refreshToken&&(b.getFieldMappings(a),d.hasFieldMapPermission()?b.showActOnUpdateRules=!0:b.showActOnUpdateRules=!1)}))):"SALESLOFT"!==a&&"OUTREACH"!==a||"tab-3"!==b.usTab||(b.idx=1,b.sdrCredentialValidationFormData.accessToken&&(e=1,b.validateAndSaveCrmCredentials(a,e).then(function(c){b.sdrCredsValidated=c,b.isShowAuthorizationResult&&(c?h.create("success","The authorization succeeded.","flash"):h.create("error","The authorization failed.","flash"),b.isShowAuthorizationResult=!1),c&&b.sdrCredentialValidationFormData.refreshToken&&b.getFieldMappings(a)}))):(b.idx=1,b.isShowAuthorizationResult&&(b.crmCredsValidated?h.create("success","The authorization succeeded.","flash"):h.create("error","The authorization failed.","flash"),b.isShowAuthorizationResult=!1),b.crmCredentialValidationFormData.oauthToken&&(e=1,b.validateThenLoadMappings(a,e)),b.crmCredentialValidationFormData.sandbox||(b.crmCredentialValidationFormData.sandbox=!1))})},b.validateAndSaveCrmCredentials=function(a,c){b.isSaving=!0,K.supportedCrmType=a,b.idx=0;var e=b.crmCredentialValidationFormData;"ELOQUA"!==a&&"PARDOT"!==a&&"MARKETO"!==a&&"ACTON"!==a&&"HUBSPOT"!==a||(e=b.matCredentialValidationFormData),"SALESLOFT"!==a&&"OUTREACH"!==a||(e=b.sdrCredentialValidationFormData);var f=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);document.cookie="csrfBlock="+f,e.csrfBlock=f;var g=d.postCrmCreds(e,K).then(function(e){return"ELOQUA"===a||"PARDOT"===a||"MARKETO"===a||"ACTON"===a?b.matCredsValidated=e:"SALESLOFT"===a||"OUTREACH"===a?b.sdrCredsValidated=e:b.crmCredsValidated=e,b.isSaving=!1,c||O(e),e?d.updateNavigation():"SFDC"===a&&b.crmCredentialValidationFormData.oauthToken?b.salesforceTokenExpired=!0:b.salesforceTokenExpired=!1,e});return g},b.authorizeHubspot=function(a){b.isSaving=!0;var c=a?b.crmCredentialValidationFormData.portalId:b.matCredentialValidationFormData.portalId;d.getHubspotAuthUrl(c,j.absUrl()).then(function(a){0!=a&&(window.location.href=a),b.isSaving=!1})},b.authorizeSalesforce=function(){b.isSaving=!0,d.getSalesforceAuthUrl(b.crmCredentialValidationFormData.sandbox).then(function(a){window.location.href=a,b.isSaving=!1})},b.authorizeActOn=function(){b.isSaving=!0;var a=window.location.href;d.getActOnAuthUrl(a).then(function(a){window.location.href=a,b.isSaving=!1})},b.authorizeSalesloft=function(){b.isSaving=!0,d.getSalesloftAuthUrl().then(function(a){window.location.href=a,b.isSaving=!1})},b.authorizeOutreach=function(){b.isSaving=!0,d.getOutreachAuthUrl().then(function(a){window.location.href=a,b.isSaving=!1})},b.authorizeZoho=function(){b.isSaving=!0;var a=window.location.href;d.getZohoAuthUrl(a).then(function(a){0!=a&&(window.location.href=a),b.isSaving=!1})},b.getNetsuiteCompanyEntityStatuses=function(){b.companyEntityStatusesLoading=!0,d.getNetsuiteCompanyEntityStatuses().then(function(a){b.netsuite_company_entity_statuses=a,b.companyEntityStatusesLoading=!1})},b.getNetsuitePicklistFieldsWithConstantValues=function(a,b){var c=[];return _.each(a,function(a){if(a.netsuiteSelectList)return _.each(b,function(b){if(b.nameOfCrmField===a.name&&b.netsuiteConstantValue)return a.constant_value||(a.constant_value=b.netsuiteConstantValue),b.netsuiteCustomField&&(a.netsuite_custom_field=b.netsuiteCustomField),void(b.netsuiteCustomFieldId&&(a.netsuite_custom_field_id=b.netsuiteCustomFieldId))}),void c.push(a)}),c},b.getWebHookURL=function(a){var c=this;K.supportedCrmType=a,d.getWebhookUrl(K).then(function(a){c.webHookUrl=a.webHookUrl}),b.isGetWebHookURL=!0},b.swapFM=function(a,c,d,e){"undefined"!=typeof c&&"undefined"!=typeof d&&"undefined"!=typeof e&&(b.savedFM||(b.savedFM={}),b.savedFM[e]||(b.savedFM[e]={}),b.savedFM[e][c]=d),b.idx=a,b.currentSalesforceFM=b.salesforceFM[b.idx],b.getFieldMappings(this.selectedCRM.name)},b.handleCustomField=function(a){a.nameOfCrmField&&a.nameOfCrmField===M&&(a.nameOfCrmField="",a.newCustomField=!0)},b.updateMappingTracker=function(a){if(a&&a.crmField){if(b.dorgFieldByCrmField||(b.dorgFieldByCrmField={}),b.crmFieldByDorgField||(b.crmFieldByDorgField={}),b.crmFieldByDorgField[a.crmField.displayName]&&b.crmFieldByDorgField[a.crmField.displayName]!==a.nameOfCrmField){var c=b.crmFieldByDorgField[a.crmField.displayName];b.dorgFieldByCrmField[c]===a.crmField.displayName&&(b.dorgFieldByCrmField[c]=null)}a.nameOfCrmField&&(b.dorgFieldByCrmField[a.nameOfCrmField]=a.crmField.displayName),b.crmFieldByDorgField[a.crmField.displayName]=a.nameOfCrmField}},b.getFieldMappings=function(a){if(!d.hasFieldMapPermission()&&"ACTON"!==a)return void(b.showFieldMapSettings=!1);b.showFieldMapSettings=!0,b.crmLoading=!0,K.supportedCrmType=a;var c={supportedCrmType:a};"ACTON"===a&&(K.actOnListId=b.customerCrmSettings.actOnListId),b.idx=this.idx,d.getFieldMappings(this.idx,K,a).then(function(e){return b.dorgFieldByCrmField={},b.crmFieldByDorgField={},"PARDOT"===a?(b.pardotFieldMappings=e.data,b.matCredsValidated=d.hasCrmFieldMappings,_.each(b.pardotFieldMappings,function(a){b.updateMappingTracker(a)})):"ACTON"===a?(b.actOnFieldMappings=e.data,d.getActOnLists().then(function(a){b.availableActOnLists=a}),b.customerCrmSettings.actOnListId?(d.hasCrmFieldMappings=!0,c.actOnListId=b.customerCrmSettings.actOnListId):b.crmLoading=!1,_.each(b.actOnFieldMappings,function(a){b.updateMappingTracker(a)})):"SALESLOFT"===a?(b.salesloftFieldMappings=e.data,b.sdrCredsValidated=d.hasCrmFieldMappings,_.each(b.salesloftFieldMappings,function(a){b.updateMappingTracker(a)})):"OUTREACH"===a?(b.outreachFieldMappings=e.data,b.sdrCredsValidated=d.hasCrmFieldMappings,b.checkFieldsForAppendAndClean(a),_.each(b.outreachFieldMappings,function(a){b.updateMappingTracker(a)})):"HUBSPOTCRM"===a?(b.hubspotFieldMappings=e.data,b.crmCredsValidated=d.hasCrmFieldMappings,_.each(b.hubspotFieldMappings,function(a){b.updateMappingTracker(a)})):"HUBSPOT"===a?(b.hubspotFieldMappings=e.data,b.matCredsValidated=d.hasCrmFieldMappings,_.each(b.hubspotFieldMappings,function(a){b.updateMappingTracker(a)})):"NETSUITE"===a?(b.savedFM&&b.savedFM.NETSUITE&&b.savedFM.NETSUITE[b.idx]?b.netsuiteFieldMappings=b.savedFM.NETSUITE[b.idx]:b.netsuiteFieldMappings=e.data,b.crmCredsValidated=d.hasCrmFieldMappings,_.each(b.netsuiteFieldMappings,function(a){b.updateMappingTracker(a)})):"MARKETO"===a?(b.marketoFieldMappings=e.data,b.savedMarketoFieldMappings=_.clone(b.marketoFieldMappings,!0),b.matCredsValidated=d.hasCrmFieldMappings,b.checkFieldsForAppendAndClean(a),_.each(b.marketoFieldMappings,function(a){b.updateMappingTracker(a)})):"ZOHO"===a?(b.zohoFieldMappings=e.data,b.crmCredsValidated=d.hasCrmFieldMappings,_.each(b.zohoFieldMappings,function(a){b.updateMappingTracker(a)})):"ORACLESALESCLOUD"===a?(b.oracleSalesCloudFieldMappings=e.data,b.crmCredsValidated=d.hasCrmFieldMappings,_.each(b.oracleSalesCloudFieldMappings,function(a){b.updateMappingTracker(a)})):"PIPEDRIVE"===a?(b.pipedriveFieldMappings=e.data,b.crmCredsValidated=d.hasCrmFieldMappings,_.each(b.pipedriveFieldMappings,function(a){b.updateMappingTracker(a)})):"SUGAR"===a?(b.sugarFieldMappings=e.data,b.crmCredsValidated=d.hasCrmFieldMappings,_.each(b.sugarFieldMappings,function(a){b.updateMappingTracker(a)})):(b.salesforceFieldMappings=e.data,b.crmCredsValidated=d.hasCrmFieldMappings,_.each(b.salesforceFieldMappings,function(a){b.updateMappingTracker(a)})),e.idx}).then(function(e){"NETSUITE"===a&&0===e&&b.storedNetsuiteCompanyFields?(b.availableNetsuiteFields=b.storedNetsuiteCompanyFields,b.netsuiteStandardPicklistFields=b.getNetsuitePicklistFieldsWithConstantValues(b.storedNetsuiteCompanyStandardPicklistFields,b.netsuiteFieldMappings),b.netsuiteCustomPicklistFields=b.getNetsuitePicklistFieldsWithConstantValues(b.storedNetsuiteCompanyCustomPicklistFields,b.netsuiteFieldMappings),b.crmLoading=!1):"NETSUITE"===a&&1===e&&b.storedNetsuiteContactFields?(b.availableNetsuiteFields=b.storedNetsuiteContactFields,b.netsuiteStandardPicklistFields=b.getNetsuitePicklistFieldsWithConstantValues(b.storedNetsuiteContactStandardPicklistFields,b.netsuiteFieldMappings),b.netsuiteCustomPicklistFields=b.getNetsuitePicklistFieldsWithConstantValues(b.storedNetsuiteContactCustomPicklistFields,b.netsuiteFieldMappings),b.crmLoading=!1):d.hasCrmFieldMappings?d.availableFields(e,c).then(function(c){if(c&&c.length&&(b.crmLoading=!1),"PARDOT"===a)b.availablePardotFields=c;else if(_.startsWith(a,"HUBSPOT"))b.availableHubspotFields=c;else if("ACTON"===a){if(!c){b.crmLoading=!1;var f=h.create("success","This list exceeds the maximum number of columns for uploading to Act-On. Please choose another list.","fail");return h.pause(),void setTimeout(function(){h.dismiss(f)},5e3)}b.availableActOnFields=c;var g={name:M};b.availableActOnFields.unshift(g)}else if("SALESLOFT"===a)b.availableSalesloftFields=c;else if("OUTREACH"===a)b.availableOutreachFields=c;else if("ZOHO"===a)b.availableZohoFields=c;else if("ORACLESALESCLOUD"===a)b.availableOracleSalesCloudFields=c;else if("PIPEDRIVE"===a)b.availablePipedriveFields=c;else if("SUGAR"===a)b.availableSugarFields=c;else if("NETSUITE"===a){b.getNetsuiteCompanyEntityStatuses();var i=c,j=[],k=[],l=[];_.each(i,function(a){return a.netsuiteSelectList?a.netsuiteCustomField?void l.push(a):void k.push(a):void j.push(a)}),b.availableNetsuiteFields=j,0===e?(b.storedNetsuiteCompanyFields=j,b.storedNetsuiteCompanyStandardPicklistFields=k,b.storedNetsuiteCompanyCustomPicklistFields=l):1===e&&(b.storedNetsuiteContactFields=j,b.storedNetsuiteContactStandardPicklistFields=k,b.storedNetsuiteContactCustomPicklistFields=l),b.netsuiteStandardPicklistFields=b.getNetsuitePicklistFieldsWithConstantValues(k,b.netsuiteFieldMappings),b.netsuiteCustomPicklistFields=b.getNetsuitePicklistFieldsWithConstantValues(l,b.netsuiteFieldMappings)}else"MARKETO"===a?(b.availableMarketoFields=c,b.adjustCheckUncheckAll(b.marketoFieldMappings,"includeWhenCreating"),b.adjustCheckUncheckAll(b.marketoFieldMappings,"includeWhenUpdating"),b.adjustCheckUncheckAll(b.marketoFieldMappings,"updateBlankOnly"),b.adjustCheckUncheckAll(b.marketoFieldMappings,"includeWhenAutoUpdating")):c&&c.length>0?b.availableSalesforceFields=c:d.checkApiAccess(K).then(function(a){null!=a&&"false"===a&&(b.showFieldMapSettings=!1,h.create("success","Please contact your Salesforce Account Manager to have API Connectivity turned on for your Salesforce account.","fail"),h.pause())})}):b.crmLoading=!1})},b.saveSettings=function(a){K.supportedCrmType=a,d.saveCustomerSettings(K,b.customerCrmSettings).then(function(){d.saveUserSettings(K,b.userCrmSettings).then(O)})},b.getFullNetsuiteFieldMappings=function(a,b,c,d){var e=[];return _.each(a,function(a){return a.hasOwnProperty("nameOfCrmField")?(_.each(b,function(b){if(b.name===a.nameOfCrmField)return b.netsuiteAddressField?a.netsuiteAddressField=1:a.netsuiteAddressField=0,b.netsuiteCustomField?a.netsuiteCustomField=1:a.netsuiteCustomField=0,void(b.netsuiteCustomFieldId?a.netsuiteCustomFieldId=b.netsuiteCustomFieldId:a.netsuiteCustomFieldId=null)}),void e.push(a)):void e.push(a)}),_.each(c,function(a){var b={nameOfCrmField:a.name,netsuiteConstantValue:a.constant_value,netsuiteSelectList:1};e.push(b)}),_.each(d,function(a){var b={nameOfCrmField:a.name,netsuiteConstantValue:a.constant_value,netsuiteCustomField:1,netsuiteCustomFieldId:a.netsuiteCustomFieldId,netsuiteSelectList:1};e.push(b)}),e},b.processMappingForm=function(a){if(K.supportedCrmType=a,"SFDC"===a||"TALENTROVER"===a)b.fieldMappings=b.salesforceFieldMappings;else if("PARDOT"===a)b.fieldMappings=b.pardotFieldMappings;else if("SALESLOFT"===a)b.fieldMappings=b.salesloftFieldMappings;else if("OUTREACH"===a)b.fieldMappings=b.outreachFieldMappings;else if("ZOHO"===a)b.fieldMappings=b.zohoFieldMappings;else if("ORACLESALESCLOUD"===a)b.fieldMappings=b.oracleSalesCloudFieldMappings;else if("PIPEDRIVE"===a)b.fieldMappings=b.pipedriveFieldMappings;else if("SUGAR"===a)b.fieldMappings=b.sugarFieldMappings;else if(_.startsWith(a,"HUBSPOT"))b.fieldMappings=b.hubspotFieldMappings;else if("NETSUITE"===a)b.fieldMappings=b.getFullNetsuiteFieldMappings(b.netsuiteFieldMappings,b.availableNetsuiteFields,b.netsuiteStandardPicklistFields,b.netsuiteCustomPicklistFields);else if("MARKETO"===a)b.fieldMappings=b.marketoFieldMappings,b.savedMarketoFieldMappings=_.clone(b.marketoFieldMappings,!0),b.checkFieldsForAppendAndClean(a);else if("ACTON"===a){if(b.customerCrmSettings.actOnListId){var c={listId:b.customerCrmSettings.actOnListId};d.setActOnList(c)}b.fieldMappings=[];for(var e=0;e<b.actOnFieldMappings.length;e++){for(var f=b.actOnFieldMappings[e],g=!1,i=0;i<b.availableActOnFields.length;i++){var j=b.availableActOnFields[i];if(j.name===f.nameOfCrmField){g=!0;break}}g||f.newCustomField||(f.nameOfCrmField=null),b.fieldMappings.push(f)}}d.postFieldMappings(this.idx,b.fieldMappings,K,a).then(function(){b.saveSettings(a),"OUTREACH"===a&&b.checkFieldsForAppendAndClean(a),h.create("success","Settings saved successfully.","flash")})},b.updateUser=function(){d.updateUser(b.userProfileFormData).then(function(a){b.userSettingsSuccess=a,b.userSettingsError=!a,a&&h.create("success","Profile is updated.","flash")},function(c){400===c.status&&c.data&&c.data.errors&&(c.data.errors.forEach(function(c){b[c.fieldName+"Error"]=a.getErrorMessage(c.code.toLowerCase())}),b.invalidCharacters=!0)})},b.addConstant=function(){da(b.newConstant)},b.removeConstant=function(a){if(b.mapConstants=_.reject(b.mapConstants,{crmField:a.crmField,constantValue:a.constantValue}),a.disabled!==!0){var c=R(a.crmField);c.length>0&&(alert("By removing this constant you will activate the value in the field mapping section above. If you do not wish to receive data in this field, make sure the mapping above is empty."),U(c,!1))}Y()},b.onFieldMappingSelected=function(a,b){var c,d=S(b);d.length>0?window.confirm("You have already mapped this as a constant below. Do you wish to set a field mapping for this field instead?")?(W(),U(d,!0),c=R(b),c.length>0&&U(c,!1)):(c=R(b),c.length>0&&(U(c,!0),U(d,!1))):W(),Y()},b.isAlreadyMapped=function(a,b,c){var d=_.filter(a,function(a){return""!==c.statement&&c.statement!==b&&a.crmField===c.statement});return d.length>0},b.onMapConstantSelected=function(a,b){var c,d=R(b);d.length>0?window.confirm("You have already mapped this field above. Do you wish to set a constant for this field instead?")?(V(),U(d,!0),c=S(b),null!==c&&U(c,!1)):(c=S(b),null!==c&&(V(),U(c,!0),U(d,!1))):V(),Y()},b.swapSDRFM=function(a){b.idx=a,b.getFieldMappings(this.selectedSDR.name)},b.swapMATFM=function(a){b.idx=a,b.getMatFieldMappings(this.selectedMAT.name)},b.getMatFieldMappings=function(a){"ELOQUA"===a?(d.hasEloquaFieldMapPermission()?b.showFieldMapSettings=!0:b.showFieldMapSettings=!1,b.crmLoading=!0,d.getMatFieldMappings(this.idx,K).then(function(a){var c=a.data;b.crmFields=c.crmFields,b.crmFields.unshift({name:"Do Not Map",statement:""}),b.fieldMapping=c.fieldMapping,b.mapFields=[],_.each(Object.keys(c.fieldMapping.fields),function(a){var d=c.fieldMapping.fields[a],e=a===c.fieldMapping.identifierFieldName;e&&(b.identifierField=d),b.mapFields.push({dOrgField:a,crmField:d,disabled:e||!_.isEmpty(d)&&1===c.fieldMapping.mappingPriorities[d],hasError:!1})}),b.newConstant={crmField:null,constantValue:null},b.mapConstants=[],_.each(Object.keys(c.fieldMapping.mappingConstants),function(a){b.mapConstants.push({crmField:a,constantValue:c.fieldMapping.mappingConstants[a],disabled:!_.isEmpty(a)&&0===c.fieldMapping.mappingPriorities[a],hasError:!1})}),b.constantCrmFields=_.clone(c.crmFields),_.each(b.constantCrmFields,function(a){(a.statement===b.identifierField||_.isEmpty(a.statement))&&(b.constantCrmFields=_.reject(b.constantCrmFields,a))}),b.crmLoading=!1})):b.getFieldMappings(a)},b.saveMatFieldMappings=function(a){if(_.isEmpty(b.newConstant.crmField)||_.isEmpty(b.newConstant.constantValue)||da(b.newConstant)){b.fieldMapping.fields={},b.fieldMapping.mappingPriorities={},_.each(b.mapFields,function(a){b.fieldMapping.fields[a.dOrgField]=a.crmField}),b.fieldMapping.mappingConstants={};var c=!1;_.each(b.mapConstants,function(a){return _.isEmpty(a.crmField)?(c=!0,!1):void(null!==a.crmField&&null!==a.constantValue&&(b.fieldMapping.mappingConstants[a.crmField]=a.constantValue,a.disabled===!0?b.fieldMapping.mappingPriorities[a.crmField]=0:a.disabled===!1&&(b.fieldMapping.mappingPriorities[a.crmField]=1)))}),c?h.create("success","Please make sure all constant fields have been filled out in order to save mapping settings.","fail"):d.postMatFieldMappings(this.idx,b.fieldMapping,K).then(O)}},b.resetValues=function(){b.isGetWebHookURL=!1},b.selectConnector=function(a,c){if(null!=a){if(null===c){if(!window.confirm("You will no longer have an active "+a))return void("CRM"===a?this.selectedCRM=b.activeCRM:"MAT"===a?this.selectedMAT=b.activeMAT:this.selectedSDR=b.activeSDR);"CRM"===a?(b.crmCredsValidated=!1,b.toggleMatEnabled("HUBSPOT",!0)):"MAT"===a?(b.matCredsValidated=!1,
b.toggleCrmEnabled("HUBSPOTCRM",!0)):b.sdrCredsValidated=!1}z(a,c)}},b.toggleMatEnabled=function(a,c){_.each(b.mats,function(b){b.name===a&&(b.disabled=!c)})},b.toggleCrmEnabled=function(a,c){_.each(b.supportedCrms,function(b){b.name===a&&(b.disabled=!c)})},b.saveSfdcSandbox=function(){d.saveSfdcSandbox(b.crmCredentialValidationFormData.sandbox)};var ja=function(a){for(var b=[],c=0,d=a.length;c<d;++c)b.push({id:a[c].id,displayName:a[c].displayName});return b};b.saveFitSettings=function(){var a,c=this.fitEnabled;b.userLeadModel.industryIds=_.pluck(b.industry.selected,"id"),b.userLeadModel.technologies=ja(b.technology.selected),b.userLeadModel.departmentIds=_.pluck(b.department.selected,"id"),b.userLeadModel.jobFunctionIds=_.pluck(b.jobFunction.selected,"id"),b.userLeadModel.seniorityLevelIds=_.pluck(b.seniorityLevel.selected,"id"),b.userLeadModel.intelCategoryIds=_.pluck(b.intelCategory.selected,"id"),b.userLeadModel.oppAlertCategoryIds=_.pluck(b.oppAlertCategory.selected,"id"),b.userLeadModel.enabled=c,a=_.cloneDeep(b.userLeadModel),_.each(_.without(_.keys(a),"enabled","version","minEmployeeCount","maxEmployeeCount","minRevenue","maxRevenue"),function(b){var c={},d=1;_.each(a[b],function(a){c[d]=a,d+=1}),a[b]=c}),c?a.enabled=1:a.enabled=0,d.saveFitSettings(a).then(function(a){a&&(ga.userLeadModel=_.cloneDeep(b.userLeadModel),ga.selectedindustries=_.cloneDeep(b.industry.selected),ga.selectedtechnologies=_.cloneDeep(b.technology.selected),ga.selecteddepartments=_.cloneDeep(b.department.selected),ga.selectedjobfunctions=_.cloneDeep(b.jobFunction.selected),ga.selectedsenioritylevels=_.cloneDeep(b.seniorityLevel.selected),ga.selectedintelcategories=_.cloneDeep(b.intelCategory.selected),ga.selectedoppalertcategories=_.cloneDeep(b.oppAlertCategory.selected),h.create("success","Saved successfully.","flash"))}).finally(d.updateAccount)},b.clearFitSettings=function(){var a=_.cloneDeep(ga);b.userLeadModel=a.userLeadModel,b.industry.selected=a.selectedindustries,b.department.selected=a.selecteddepartments,b.jobFunction.selected=a.selectedjobfunctions,b.seniorityLevel.selected=a.selectedsenioritylevels,b.intelCategory.selected=a.selectedintelcategories,b.oppAlertCategory.selected=a.selectedoppalertcategories,this.fitEnabled=_.clone(a.userLeadModel.enabled),b.technology.selected=a.userLeadModel.technologies},b.checkUncheckAll=function(a,c){_.each(a,function(a){a.hasOwnProperty("nameOfCrmField")&&(a[c]=b.checkedUncheckedAll[c]?1:0)})},b.adjustCheckUncheckAll=function(a,c){var d=!0,e=!0;_.each(a,function(a){a.hasOwnProperty("nameOfCrmField")&&(a[c]?e=!1:d=!1)}),b.checkedUncheckedAll[c]=d,document.getElementById("marketoCheckAll-"+c).indeterminate=!(d||e)},b.confirmOptOut=function(a,c){return 0===b.userCrmSettings.hubspotWebhookOptedOut&&0===a.indexOf("HUBSPOT")&&c||0===b.userCrmSettings.hubspotConnectorOptedOut&&0===a.indexOf("HUBSPOT")&&!c||0===b.userCrmSettings.marketoWebhookOptedOut&&"MARKETO"===a&&c||0===b.userCrmSettings.marketoConnectorOptedOut&&"MARKETO"===a&&!c||0===b.userCrmSettings.eloquaConnectorOptedOut&&"ELOQUA"===a||0===b.userCrmSettings.actOnConnectorOptedOut&&"ACTON"===a||0===b.userCrmSettings.zohoConnectorOptedOut&&"ZOHO"===a||0===b.userCrmSettings.outreachConnectorOptedOut&&"OUTREACH"===a?void b.saveSettings(a):(d.optOutType=c?"Webhooks":"Connector",void m.open({openedClass:"warning-modal",templateUrl:"app/views/user-settings/partials/mat-partials/modals/optOutWarning/optOutWarning.modal.html"}).result.then(function(){},function(d){"ok"===d?b.saveSettings(a):"MARKETO"===a&&c?b.userCrmSettings.marketoWebhookOptedOut=0:"MARKETO"!==a||c?0===a.indexOf("HUBSPOT")&&c?b.userCrmSettings.hubspotWebhookOptedOut=0:0!==a.indexOf("HUBSPOT")||c?"ELOQUA"===a?b.userCrmSettings.eloquaConnectorOptedOut=0:"ACTON"===a?b.userCrmSettings.actOnConnectorOptedOut=0:"OUTREACH"===a?b.userCrmSettings.outreachConnectorOptedOut=0:"ZOHO"===a&&(b.userCrmSettings.zohoConnectorOptedOut=0):b.userCrmSettings.hubspotConnectorOptedOut=0:b.userCrmSettings.marketoConnectorOptedOut=0}))},b.changeExportOptions=function(){if(this.defaultExportOptionsSelect!==-1){var a=this;d.getExportOptions(this.defaultExportOptionsSelect).then(function(a){b.exportOptions=a}),d.getExportOptionsFormats().then(function(c){b.formats=c,a.formatsDefault=k.$checkFormat(a.defaultExportOptionsSelect,c)})}},b.changeLandingPage=function(a){b.defaultLandingPageSelect=a},b.toggleAllExportOptions=function(){_.has(this.selectedFields,this.defaultExportOptionsSelect)||(this.selectedFields[this.defaultExportOptionsSelect]={options:[],format:""}),this.exportOptions.length!==this.selectedFields[this.defaultExportOptionsSelect].options.length?this.selectedFields[this.defaultExportOptionsSelect].options=b.exportOptions:(this.selectedFields[this.defaultExportOptionsSelect].options=[],this.exportOptions=angular.copy(b.exportOptions))},b.clearHubspotCallbackWatcher=b.$watch("matCredentialValidationFormData.refreshToken",function(a,c){a!==c&&l.gotohubspot&&(b.clearHubspotCallbackWatcher(),b.matCredsValidated=!l.hubspotauthfailed,b.selectedMAT=i.mats[2],b.isShowAuthorizationResult=!0,b.changeSettingsTab("tab-2"))}),b.clearHubspotCrmCallbackWatcher=b.$watch("crmCredentialValidationFormData.refreshToken",function(a,c){a!==c&&l.gotohubspotcrm&&(b.clearHubspotCrmCallbackWatcher(),b.crmCredsValidated=!l.hubspotcrmauthfailed,b.selectedCRM=_.find(b.supportedCrms,function(a){return"HUBSPOTCRM"===a.name}),b.isShowAuthorizationResult=!0,b.changeSettingsTab("tab-1"))}),b.clearSalesforceCallbackWatcher=b.$watch("crmCredentialValidationFormData.oauthToken",function(a,c){a!==c&&l.gotosfdc&&(b.clearSalesforceCallbackWatcher(),b.crmCredsValidated=!l.sfdcauthfailed,b.isShowAuthorizationResult=!0,d.getActiveCrm({crmType:"CRM"}).then(function(a){a.activeCrm&&"TALENTROVER"===a.activeCrm?b.selectedCRM=_.find(b.supportedCrms,function(a){return"TALENTROVER"===a.name}):b.selectedCRM=_.find(b.supportedCrms,function(a){return"SFDC"===a.name}),b.changeSettingsTab("tab-1")}))}),b.clearActOnCallbackWatcher=b.$watch("matCredentialValidationFormData.accessToken",function(a,c){a!==c&&l.gotoacton&&(b.clearActOnCallbackWatcher(),b.matCredsValidated=!l.actonauthfailed,b.selectedMAT=i.mats[4],b.isShowAuthorizationResult=!0,b.changeSettingsTab("tab-2"))}),b.clearSalesloftCallbackWatcher=b.$watch("sdrCredentialValidationFormData.accessToken",function(a,c){a!==c&&l.gotosalesloft&&(b.clearSalesloftCallbackWatcher(),b.sdrCredsValidated=!l.salesloftauthfailed,b.selectedSDR=i.sdrs[0],b.isShowAuthorizationResult=!0,b.changeSettingsTab("tab-3"))}),b.clearOutreachCallbackWatcher=b.$watch("sdrCredentialValidationFormData.accessToken",function(a,c){a!==c&&l.gotooutreach&&(b.clearOutreachCallbackWatcher(),b.sdrCredsValidated=!l.outreachauthfailed,b.selectedSDR=i.sdrs[1],b.isShowAuthorizationResult=!0,b.changeSettingsTab("tab-3"))}),b.clearZohoCallbackWatcher=b.$watch("crmCredentialValidationFormData.refreshToken",function(a,c){a!==c&&l.gotozoho&&(b.clearZohoCallbackWatcher(),b.crmCredsValidated=!l.zohoauthfailed,b.selectedCRM=_.find(b.supportedCrms,function(a){return"ZOHO"===a.name}),b.isShowAuthorizationResult=!0,b.changeSettingsTab("tab-1"))}),b.$watch("changePsw",function(a,c){if(a!==c){var d=0;a.currentPassword.length>4&&(d+=1),a.newPassword.length>7&&a.confirmNewPassword===a.newPassword&&a.confirmNewPassword.length>7&&(d+=2),a.currentPassword!==a.newPassword&&(d+=1),b.canSave=4===d}},!0),b.$watch("crmCredentialValidationFormData",function(a,c){a===c||_.isEmpty(c)||(a.apiToken?b.confirmError=a.apiToken!==a.confirmApiToken:a.authToken?b.confirmError=a.authToken!==a.confirmAuthToken:b.confirmError=a.password!==a.confirmPassword)},!0),b.$watch("matCredentialValidationFormData",function(a,c){a===c||_.isEmpty(c)||(b.confirmError=a.password!==a.confirmPassword,b.confirmEncryptionKeyError=a.encryptionKey!==a.confirmEncryptionKey)},!0),l.marketoAppendCleanReport&&(b.changeSettingsTab("tab-2"),delete l.marketoAppendCleanReport,window.location.href="api/rest/crm/settings/appendCleanReport?supportedCrmType=MARKETO&crmRecordType=LEAD"),l.outreachAppendCleanPersonReport&&(b.changeSettingsTab("tab-3"),delete l.outreachAppendCleanPersonReport,window.location.href="api/rest/crm/settings/appendCleanReport?supportedCrmType=OUTREACH&crmRecordType=CONTACT"),l.outreachAppendCleanCompanyReport&&(b.changeSettingsTab("tab-3"),delete l.outreachAppendCleanCompanyReport,window.location.href="api/rest/crm/settings/appendCleanReport?supportedCrmType=OUTREACH&crmRecordType=ACCOUNT"),b.browserCollection=[],b.deviceRegistration={deregister:function(a){var b=this,c=m.open({controller:["$record","$scope","$uibModalInstance",function(a,b,c){b.recordName=a.name,b.no=c.dismiss,b.yes=c.close}],resolve:{$record:function(){return a}},size:"sm",templateUrl:"app/views/user-settings/partials/device-deregister.modal.tpl.html"});c.result.then(function(){d.setUserDeviceDelete(a).then(b.get)})},update:function(a){d.setUserDeviceName(a).then(function(){h.create("success","Browser successfully renamed.","flash")}).finally(this.get)},get:function(){d.getUserDevices().then(function(a){b.browserCollection=a})}},b.deviceRegistration.get()}]),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("user_settings",{url:"/account/settings?hubspotauthcallback&hubspotcrmauthcallback&sfdcauthcallback&actonauthcallback&salesloftauthcallback&outreachauthcallback&authfailed&marketoAppendCleanReport&outreachAppendCleanPersonReport&outreachAppendCleanCompanyReport&zohoauthcallback",templateUrl:"app/views/user-settings/user-settings.html",controller:"UserSettingsCtrl",params:{goToFit:!1},resolve:{$title:function(){return"Settings"},preCache:["userSettingsService",function(a){a.preCache()}]},onEnter:["$state","$stateParams",function(a,b){b.hubspotauthcallback?(a.gotohubspot=1,b.authfailed?a.hubspotauthfailed=1:a.hubspotauthfailed=0,a.go("user_settings")):b.hubspotcrmauthcallback?(a.gotohubspotcrm=1,b.authfailed?a.hubspotcrmauthfailed=1:a.hubspotcrmauthfailed=0,a.go("user_settings")):b.sfdcauthcallback?(a.gotosfdc=1,b.authfailed?a.sfdcauthfailed=1:a.sfdcauthfailed=0,a.go("user_settings")):b.actonauthcallback?(a.gotoacton=1,b.authfailed?a.actonauthfailed=1:a.actonauthfailed=0,a.go("user_settings")):b.salesloftauthcallback?(a.gotosalesloft=1,b.authfailed?a.salesloftauthfailed=1:a.salesloftauthfailed=0,a.go("user_settings")):b.outreachauthcallback?(a.gotooutreach=1,b.authfailed?a.outreachauthfailed=1:a.outreachauthfailed=0,a.go("user_settings")):b.marketoAppendCleanReport?(a.marketoAppendCleanReport=1,delete b.marketoAppendCleanReport):b.outreachAppendCleanPersonReport?(a.outreachAppendCleanPersonReport=1,delete b.outreachAppendCleanPersonReport):b.outreachAppendCleanCompanyReport?(a.outreachAppendCleanCompanyReport=1,delete b.outreachAppendCleanCompanyReport):b.zohoauthcallback&&(a.gotozoho=1,b.authfailed?a.zohoauthfailed=1:a.zohoauthfailed=0,a.go("user_settings"))}],onExit:["Flash",function(a){a.dismiss()}]})}]),angular.module("dorgEuiApp").service("userSettingsService",["$rootScope","$http","$userSettingsStatic","$templateCache","$q","navigation","downloadExportService","account","Session","$embeddedUtils","$grid",function(a,b,c,d,e,f,g,h,i,j,k){var l=this,m=a.Session.navigation,n=m.$href("accountPreferences"),o=m.$href("changePassword"),p=m.$href("customerCrmSettings"),q=m.$href("userCrmSettings"),r=m.$href("supportedCrms"),s=m.$href("activeMat"),t=m.$href("credentials"),u=m.$href("checkApiAccess"),v=a.Session.navigation.$href("actOnAuthUrl"),w=a.Session.navigation.$href("actOnLists"),x=a.Session.navigation.$href("actOnList"),y=a.Session.navigation.$href("salesloftAuthUrl"),z=a.Session.navigation.$href("outreachAuthUrl"),A=a.Session.navigation.$href("zohoAuthUrl"),B=a.Session.navigation.$href("hubspotAuthUrl"),C=a.Session.navigation.$href("hubspotAuthCallback"),D=a.Session.navigation.$href("hubspotOwners"),E=a.Session.navigation.$href("salesforceAuthUrl"),F=a.Session.navigation.$href("netsuiteCompanyEntityStatuses"),G=a.Session.navigation.$href("marketoListSize"),H=a.Session.navigation.$href("marketoAppendAndClean"),I=a.Session.navigation.$href("toggleAppendAndClean"),J=a.Session.navigation.$href("toggleAppendAndCleanEmail"),K=a.Session.navigation.$href("checkAppendAndCleanRequiredFields"),L=m.$href("fieldMappings"),M=m.$href("eloquaFieldMapping"),N=m.$href("actOnFieldMappings"),O=m.$href("companyProfile"),P=m.$href("profile"),Q=m.$href("availableFields"),R=m.$href("matfieldmappings"),S=m.$href("activeCrm"),T=m.$href("webhookUrl"),U=m.$href("saveSfdcSandbox"),V=m.$href("fitSettings"),W=m.$href("getAllowOutreachAccountCreation"),X=a.Session.account.preferences,Y=function(a,b){return"PARDOT"===a.supportedCrmType?a.crmRecordType="LEAD":b<1?a.crmRecordType="ACCOUNT":1===b?a.crmRecordType="CONTACT":a.crmRecordType="LEAD",a},Z=function(){return!0},$=function(){return!1},aa=function(a){return 200===a.status},ba=function(a){return a.data};l.checkedFieldsArray=[],this.$get=function(){return _.isEmpty(a.Session.account.preferences)?{}:angular.copy(a.Session.account.preferences)},this.$setPrefs=function(a){return X.landing=a.landing||"viewDashboard",X.exports=a.exports||{},_.each(X.widgets,function(a,b){_.each(a,function(a,c){delete X.widgets[b][c].tpl})}),k.sanitizeGrid(X).then(function(a){b.post(n,a).then(ba,function(a){console.error(a)})})},this.$setPassword=function(a){return b.post(o,a).then(function(a){return{status:204===a.status?"success":"error",$$msgType:""}},function(a){return{status:"error",$$msgType:a.data}})};var ca=function(a,c,d){var e=a.$href(c),f={};return f.params=d||{},b.get(e,f).then(function(a){var b=null,c=j.$getD(a.data);return c&&(b=c.sort(function(a,b){return a.company&&b.company&&(a=a.company,b=b.company),a=a.displayName.replace(" ","").toLowerCase(),b=b.displayName.replace(" ","").toLowerCase(),a>b?1:a<b?-1:0})),b})};this.$hasSupportedCrms=!!r,this.getSupportedCrms=function(){return b.get(r).then(ba)},this.getSupportedFits=function(){return m.$get("fitSettings")},this.saveFitSettings=function(a){return b.post(V,a).then(aa,$)},this.getActiveMat=function(){return b.get(s).then(ba)},this.getCustomerCrmSettings=function(a){return b.get(p,{params:a}).then(ba)},this.getAllowOutreachAccountCreation=function(){return b.get(W).then(ba)},this.getUserCrmSettings=function(a){return b.get(q,{params:a}).then(ba)},this.getCrmCreds=function(a){return b.get(t,{params:a}).then(ba)},this.postCrmCreds=function(a,c){return b.post(t,a,{params:c}).then(aa,$)},this.checkApiAccess=function(a){return b.get(u+"?supportedCrmType="+a.supportedCrmType).then(ba)},this.accountSettingsTabUsageTrack=function(){return b.post("api/rest/crm/settings/track").then(ba)},this.getTechnologyList=function(a,b,c){return c=_.isUndefined(c)?"":encodeURI(c),ca(a,b,{partialName:c})},this.getCompaniesList=function(a,b,c){return c=_.isUndefined(c)?"":encodeURI(c),ca(a,b,{startsWith:c})},this.hasFieldMapPermission=function(){var b=a.Session.navigation.$href("fieldMappings");return!!b},this.hasEloquaFieldMapPermission=function(){return!!M},this.getFieldMappings=function(a,c,d){var f=Y(c,a);if("ACTON"===d)return b.get(N,{params:f}).then(function(b){return{idx:a,data:b.data}});var g=e.defer();return g.resolve([]),l.hasCrmFieldMappings===!1?g.promise:b.get(L,{params:f}).then(function(b){return{idx:a,data:b.data}})},this.postFieldMappings=function(a,c,d,e){return"ACTON"===e?b.post(N,c,{params:Y(d,a)}).then(Z,$):b.post(L,c,{params:Y(d,a)}).then(Z,$)},this.getMatFieldMappings=function(a,c){var d=Y(c,a);return b.get(R,{params:d}).then(function(b){return{idx:a,data:b.data}})},this.postMatFieldMappings=function(a,c,d){return b.post(R,c,{params:Y(d,a)}).then(Z,$)},this.availableFields=function(a,c){return b.get(Q,{params:Y(c,a)}).then(ba,aa)},this.getCompanyProfile=function(){return b.get(O).then(ba)},this.updateUser=function(a){return b.put(P,a)},this.saveCustomerSettings=function(a,c){return b.post(p,c,{params:a}).then(aa,$)},this.saveUserSettings=function(a,c){return b.post(q,c,{params:a}).then(aa,$)},this.getHubspotAuthUrl=function(a,c){return b.get(B+"?portalId="+a+"&originUrl="+encodeURIComponent(c)+"&callbackUrl="+encodeURIComponent(C)).then(ba,$)},this.getHubspotOwners=function(){return b.get(D).then(ba)},this.getSalesforceAuthUrl=function(a){return a||(a="0"),b.get(E+"?sandbox="+a).then(ba,$)},this.getActOnAuthUrl=function(a){return b.get(v+"?originUrl="+encodeURIComponent(a)).then(ba,$)},this.getSalesloftAuthUrl=function(){return b.get(y).then(ba,$)},this.getOutreachAuthUrl=function(){return b.get(z).then(ba,$)},this.getOutreachAuthUrl=function(){return b.get(z).then(ba,$)},this.getOutreachAuthUrl=function(){return b.get(z).then(ba,$)},this.getZohoAuthUrl=function(a){return b.get(A+"?originUrl="+encodeURIComponent(a)).then(ba,$)},this.getNetsuiteCompanyEntityStatuses=function(){return b.get(F).then(ba)},this.getActOnLists=function(){return b.get(w).then(ba)},this.setActOnList=function(a){return b.post(x,null,{params:a}).then(ba,$)},this.marketoListSize=function(a){return b.get(G,{params:a}).then(ba)},this.marketoAppendAndClean=function(a){return b({method:"POST",url:H,headers:{"Content-Type":"text/plain"},data:a})},this.getActiveCrm=function(a){return b.get(S,{params:a}).then(ba)},this.saveActiveCrm=function(a){return b.post(S,null,{params:a}).then(ba,$)},this.getWebhookUrl=function(a){return b.get(T,{params:a}).then(ba)},this.saveSfdcSandbox=function(a){return b.post(U,null,{params:{isSandbox:a}})},this.hasCrmAccess=!a.Session.$crmDisabled,this.hasMatAccess=null===s,this.hasExportAccess=!a.Session.$isTrial,this.hasCrmFieldMappings=null!==L,this.allowedHubspotWebhooks=a.Session.$allowedHubspotWebhooks,this.allowedMarketoWebhooks=a.Session.$allowedMarketoWebhooks,this.allowedSupersetAccess=a.Session.allowedSupersetAccess,this.canFit=!!V,this.updateNavigation=function(){i.create()},this.updateAccount=function(){h.get().then(function(b){a.Session.account=b})},this.getExportOptions=function(a){return g.$get(a)},this.getExportOptionsFormats=function(){return g.$formats()},this.getUserDevices=function(){return b.get("api/rest/registeredbrowsers").then(function(a){return a.data||[]},function(){return[]})},this.setUserDeviceName=function(a){return b.post("api/rest/registeredbrowsers",a).then(function(a){return!0},function(){return!1})},this.setUserDeviceDelete=function(a){return b.put("api/rest/registeredbrowsers",a).then(function(a){return!0},function(){return!1})},this.getUserReport=function(a,b){return"api/rest/crm/settings/appendCleanReport?supportedCrmType="+a+"&crmRecordType="+b},this.getScheduledJob=function(){return b.get("api/rest/crm/settings/scheduledMarketoAppendAndClean")},this.getEmailSubscription=function(){return b.get("api/rest/crm/settings/subscribeMacEmail")},this.getLastRunDate=function(){return b.get("api/rest/crm/settings/lastRunDate")},this.isEnableDunsAccess=function(){return l.getDunsAccessSetting().then(function(a){return!a.data.disableDunsAccess&&a.data.enableDunsAccess})},this.deleteScheduledJob=function(){b.delete("api/rest/crm/settings/scheduledMarketoAppendAndClean")},this.updateAppendAncCleanSettings=function(a){return b({method:"POST",url:"api/rest/crm/settings/scheduledMarketoAppendAndClean",headers:{"Content-Type":"application/json"},data:a})},this.toggleAppendAndClean=function(a,c){return b({method:"POST",url:I,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"supportedCrmType="+a+"&onOff="+c})},this.toggleAppendAndCleanEmail=function(a,c){return b({method:"POST",url:J,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"supportedCrmType="+a+"&onOff="+c})},this.checkAppendAndCleanRequiredFields=function(a){return b.get(K+"?crm="+a)},this.getDunsAccessSetting=function(){return b.get("api/rest/account/customer/dunssettings")},this.updateDunsAccessSetting=function(a){return b.put("api/rest/account/customer/dunssettings",a)},this.setEmailSubscription=function(a){return b({method:"POST",url:"api/rest/crm/settings/subscribeMacEmail",headers:{"Content-Type":"text/plain"},data:a})},this.preCache=function(){_.each(c,function(a){_.each(a,function(a){_.has(a,"url")&&(d.get(a.url)||b.get(a.url).then(function(b){d.put(a.url,b.data)})),_.has(a,"tpl")&&(d.get(a.tpl)||b.get(a.tpl).then(function(b){d.put(a.tpl,b.data)})),_.has(a,"mappingUrl")&&(d.get(a.mappingUrl)||b.get(a.mappingUrl).then(function(b){d.put(a.mappingUrl,b.data)}))})})},this.checkUserHasAllowedLeadOrContactUpload=function(){return a.Session.$allowedLeadUpload||a.Session.$allowedContactUpload},l.hasCustomerCrmSettings=function(){return!_.isEmpty(p)},l.hasUserCrmSettings=function(){return!_.isEmpty(q)}}]),function(){"use strict";function a(a,b,c,d,e){function f(a){h.errors=[],a.data?a.data.errors.forEach(function(a){var c="Something was wrong with your file.";a.message&&(c=a.message.replace(/template/gi,g("template"))),h.errors.push(b.trustAsHtml(c))}):h.errors.push({message:"Error communicating with the server. Please try again later."})}function g(a){return'<a target="_self" download="BulkUserUploadTemplate.csv" href="https://cdn1.aws.discoverydb.com/app/eui/bulk_user_upload_template.csv">'+a+"</a>"}var h=this;h.errorBannerText="Error Messages",h.close=function(){c.dismiss("close")},h.chooseFileUpload=function(a){h.uploadingFile&&a.preventDefault()},h.uploadFile=function(a){!h.uploadingFile&&a.target&&a.target.files&&a.target.files.length&&(h.uploadingFile=!0,d.bulkUploadUsers(a.target.files[0]).then(function(a){a.data&&a.data.success?(h.uploadingFile=!1,c.dismiss(),e.create("success","Users have been updated","flash")):f(a)},function(a){f(a)}).finally(function(){h.uploadingFile=!1}))},a.$on("modal.closing",function(a,b,c){h.uploadingFile&&a.preventDefault()})}a.$inject=["$scope","$sce","$uibModalInstance","bulkUserUploadService","Flash"],angular.module("dorgEuiApp").controller("bulkUserUploadModalController",a)}(),function(){"use strict";function a(a){var b=this;b.downloadTemplate=function(){return a({url:"api/rest/users/userBulkUpload/downloadTemplate",method:"GET",responseType:"arraybuffer"}).then(function(a){return console.log("bulkUserUploadService.downloadTemplate() success data:",a),a},function(a){return console.log("bulkUserUploadService.downloadTemplate() fail data:",a),a})},b.bulkUploadUsers=function(b){var c=new FormData;return c.append("file",b),a.post("api/rest/users/userBulkUpload/uploadUsers",c,{headers:{"Content-Type":void 0}}).then(function(a){return console.log(a),a},function(a){console.log("error:",a)})}}a.$inject=["$http"],angular.module("dorgEuiApp").service("bulkUserUploadService",a)}(),angular.module("dorgEuiApp").controller("UsersController",["$scope","$rootScope","UserService","$uibModal","Flash","$timeout",function(a,b,c,d,e,f){function g(){f(function(){a.exportPercent&&a.exportPercent<91?(a.exportPercent=a.exportPercent+_.random(0,9),g()):(a.exportPercent=0,a.exportInProgress=!1)},1e3)}function h(){var b=a.filteredUsersByState,c=0,d=0;b[0]&&(c=b[0].length),b[2]&&(d=b[2].length);var e=c+d,f=a.companyProfile.maxSeats;return e<f}var i=function(a){return _.groupBy(a,function(a){return a.state})};c.companyProfile().then(function(b){a.companyProfile=b}).then(c.query).then(function(b){a.showLoading=!1,a.userModel.data=b,a.filteredUsersByState=i(b),a.canCreate=c.canCreate();var d=null==a.filteredUsersByState[0]?0:a.filteredUsersByState[0].length;a.availableUserCount=a.companyProfile.activeSeats+d}).then(c.$supportData).then(function(b){a.resolvedSupportData=b}),a.userModel=c.$defaultGrid([]),a.showLoading=!0,a.filterStateId=-1,a.filterState=function(b){a.filterStateId=_.isUndefined(b)?-1:b;var c=a.filteredUserList();a.userModel.data=c},a.hasUsersForState=function(b){return a.filteredUsersByState.hasOwnProperty(b)},a.modalTrigger=function(a,b){d.open(c.modalTrigger(a,b))},a.createUser=function(a,b){h()&&d.open(c.modalTrigger(a,b))},a.bulkUploadUsers=function(){h()&&d.open({templateUrl:"app/views/users/partials/bulk-user-upload/bulk-user-upload-modal.tpl.html",controller:"bulkUserUploadModalController as $ctrl"})},a.exportUserList=function(){e.create("success","Your Export is being Started.","flash"),a.exportPercent=1,a.exportInProgress=!0,g(),c.exportUserList().then(function(a){e.create("success","Your Export is success.","flash")},function(a){e.create("error","Your Export failed.","flash")}).finally(function(){a.exportPercent=100,f(function(){a.exportPercent=0},1e3),a.exportInProgress=!1})},a.delete=function(b){c.delete(b).then(function(){c.query().then(function(c){a.filteredUsersByState=i(c),a.userModel.data=a.filteredUserList(),e.create("success","The user "+b.firstName+" "+b.lastName+" has been deleted.","flash")})})},a.resendPending=function(a){c.resend(a).then(function(){e.create("success",a.firstName+" "+a.lastName+" has been sent another activation email.","flash")})},a.filteredUserList=function(){var b;return!_.isUndefined(a.filterStateId)&&a.filterStateId>-1?b=a.filteredUsersByState[a.filterStateId]:(b=_.flatten(_.map(a.filteredUsersByState,function(a){return a})),b=_.sortByOrder(b,["lastActivatedTime"],[!1])),_.isUndefined(b)&&(b=[]),b},a.toggleActive=function(b){c.toggleActive(b).then(function(){c.query().then(function(d){a.filteredUsersByState=i(d),a.userModel.data=a.filteredUserList(),e.create("success","The user "+b.firstName+" "+b.lastName+" has been "+(3===b.state?"activated":"deactivated")+".","flash"),c.companyProfile().then(function(b){a.companyProfile=b})})},function(a){426===a.status&&d.open(c.exceedUsersModal())})},a.canUpdate=function(a){return c.canUpdate(a)},a.canDelete=function(a){return c.canDelete(a)},a.canDeactivate=function(a){return c.canDeactivate(a)},a.canActivate=function(a){return c.canActivate(a)},a.hasAvailableSeats=h,a.$on("event:updatelist",function(){c.query().then(function(b){a.filteredUsersByState=i(b),a.userModel.data=a.filteredUserList()})})}]),angular.module("dorgEuiApp").config(["$stateProvider",function(a){a.state("view_users",{url:"/users",templateUrl:"app/views/users/users.html",controller:"UsersController",resolve:{$title:function(){return"Manage Users"}}})}]),angular.module("dorgEuiApp").service("UserService",["$rootScope","$http","$q","$log","$grid","Flash","$timeout","$userSettingsStatic",function(a,b,c,d,e,f,g,h){function i(b){return b===_.parseInt(a.Session.account.uuid.split(".")[1])}var j=null,k=this;this.query=function(){return a.Session.navigation.$get("view_users").then(function(a){return j=a,a.$has("userList")?a.$get("userList"):[]})},this.companyProfile=function(){return a.Session.navigation.$get("companyProfile")},this.get=function(a){return a.$get("self")},this.save=function(a){return a.id>0?a.$put("self",null,a):j.$post("create",null,a)},this.toggleActive=function(a){var b=3===a.state?"activate":"deactivate";return a.$put(b,null,a)},this.delete=function(a){return a.$del("self")},this.resend=function(a){return a.$post("resend")},this.canCreate=function(){return j.$has("create")},this.canUpdate=function(a){return a.$has("update")&&!i(a.id)},this.canDelete=function(a){return a.$has("delete")},this.canDeactivate=function(a){return a.$has("deactivate")&&!i(a.id)},this.canActivate=function(a){return a.$has("activate")},this.$supportData=function(){return j.$get("supportData")},this.$detailedUser=function(a){return a.$get("self").then(function(a){return a})},this.$defaultGrid=function(a){var b=e.$defaultGrid("userManager",a);return b.enableHorizontalScrollbar=!1,b.enableGridMenu=!1,b.enableRowSelection=!1,b},this.exceedUsersModal=function(){return{controller:["$scope","$uibModalInstance",function(a,b){a.modalHeader="Active Users Exceeded",a.close=function(){b.close()}}],size:"md",templateUrl:"app/views/users/partials/modal/exceed.modal.html"}},this.modalTrigger=function(b,c){return{controller:["dorgValidation","$scope","$uibModalInstance","modalHeader","entity","supportData",function(b,c,d,e,g,h){function i(a){return!!a&&"Invalid characters found: "+a}function j(a){return _.isEmpty(a)||_.isEmpty(_.trim(a))}function l(a){return j(a.firstName)||j(a.lastName)||j(a.phone)||j(a.email)||j(a.emailConfirm)}c.modalHeader=e,c.managerOptions=h.managers,c.selectedRole=h.roles[0],c.selectedManager=h.managers[0],c.externalRoleOptions=h.roles;var m={recruiterRoleId:19,recruiterManagerRoleId:20,trialRoleId:5};_.remove(c.externalRoleOptions,function(a){return a.id===m.recruiterRoleId||a.id===m.recruiterManagerRoleId||a.id===m.trialRoleId});var n="Direct Phone number must have at least 10 digits and cannot contain letters",o="Please enter a valid email for this user",p="The confirm email does not match";c.isSaving=!1,c.invalidCharacters=!1,g.id>0&&k.$detailedUser(g).then(function(a){c.detailedUser=a,a.externalRoles.length>0&&_.each(h.roles,function(b){b.id===a.externalRoles[0].id&&(c.selectedRole=b)}),a.managerId&&_.each(h.managers,function(b){b.id===a.managerId&&(c.selectedManager=b)});var b=angular.fromJson(a.managerNotesJson);c.entity.geographicFocus=_.isUndefined(b)?"":b.geographicFocus,c.entity.accounts=_.isUndefined(b)?"":b.accounts}),c.entity=angular.copy(g),c.entity.emailConfirm=c.entity.email,c.validatePhoneInput=function(a){var c=String.fromCharCode(a.which);b.isValidRegex(c,b.allowPhoneCharactersRegex)||a.preventDefault()},c.validateUserInput=function(a,d){var e=i(b.findSpecialChars(a.firstName,b.nameRegex)),f=i(b.findSpecialChars(a.lastName,b.nameRegex)),g=!1;j(a.phone)||(!b.isValidRegex(a.phone,b.allowPhoneCharactersRegex)||a.phone.replace(b.notDigitsRegex,"").length<10)&&(g=n);var h=!b.isValidRegex(a.email,b.emailRegex)&&!j(a.email)&&o,k=a.emailConfirm!==a.email&&!j(a.emailConfirm)&&p;switch(d){case"firstName":c.firstNameError=e;break;case"lastName":c.lastNameError=f;break;case"phone":c.phoneError=g;break;case"email":c.emailError=h,c.confirmEmailError=k;break;case"emailConfirm":c.confirmEmailError=k}a.id>0&&(c.emailError=!1,c.confirmEmailError=!1),c.invalidCharacters=l(a)||e||f||g||h||k},c.$watch("entity",function(a,b){a===b||_.isEmpty(b)||(c.confirmError=a.email!==a.emailConfirm,c.isDuplicateEmail===!0&&(c.isDuplicateEmail=!1),c.isInvalidEmailDomain===!0&&(c.isInvalidEmailDomain=!1),c.emailSatisfied=null!=a.email&&!c.confirmError&&!c.isDuplicateEmail)},!0),c.isDuplicateEmail=!1,c.isInvalidEmailDomain=!1,g.id||c.validateUserInput(g),c.confirm=function(){if(!c.invalidCharacters&&c.createUpdateUserForm.$valid){c.isSaving=!0,c.entity.roleIds=[],null!==c.selectedRole&&c.entity.roleIds.push(c.selectedRole.id),c.entity.managerId=c.selectedManager.id;var e={geographicFocus:c.entity.geographicFocus,accounts:c.entity.accounts};c.entity.managerNotesJson=angular.toJson(e),c.entity.$put=g.$put,c.entity.$get=g.$get,c.entity.$self=g.$self,c.entity.$href=g.$href,k.save(c.entity).then(function(b){f.create("success","User successfully saved","flash"),a.$broadcast("event:updatelist",{data:b}),d.close()},function(a){400===a.status&&(a.data.validDomains?(c.isInvalidEmailDomain=!0,c.validDomainList=a.data.validDomains.join(", ")):a.data.errors?(a.data.errors.forEach(function(a){c[a.fieldName+"Error"]=b.getErrorMessage(a.code.toLowerCase())}),c.invalidCharacters=!0):a.data.isDuplicateEmail&&(c.isDuplicateEmail=!0))}).finally(function(){c.isSaving=!1})}},c.cancel=function(){d.dismiss("cancel")}}],resolve:{modalHeader:function(){return b},entity:function(){return c||{}},supportData:k.$supportData},templateUrl:"app/views/users/partials/modal/users.modal.html"}},this.exportUserList=function(){var a=Intl.DateTimeFormat().resolvedOptions().timeZone;return b.get("api/rest/users/export_user_list/",{params:{clientTimeZone:a}}).then(function(a){if(a.data.name){var b=c.defer();return g(function(){var b=document.createElement("a");b.href=a.data.name,b.download=a.data.name.substr(a.data.name.lastIndexOf("/")+1),b.style.visibility="hidden",document.body.appendChild(b),b.click(),document.body.removeChild(b)},50).then(function(){b.resolve("success")},function(){b.reject("error")}),b.promise}})},this.getDefaultLandingPage=function(){var b=h.defaultLanding[0].route;return!_.has(a.Session.account,"preferences.landing")||_.isEmpty(a.Session.account.preferences.landing)||_.isEmpty(_.trim(a.Session.account.preferences.landing))||(b=a.Session.account.preferences.landing),
b},this.canAccessTopContentConsumers=function(){return a.Session&&a.Session.navigation&&a.Session.navigation.$has("view_top_content_consumers")}}]),function(){"use strict";function a(a){a.state("view_abm",{url:"/accountview",templateUrl:"app/views/vad/abm.html",data:{$title:"AccountView"}})}angular.module("dorgEuiApp").config(a),a.$inject=["$stateProvider"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(){return ia}function j(a){ia=a}function k(a){ga=_.clone(a.companyList)}function l(b){return a.post("api/rest/vad/VadList",{name:b.listName,myListId:b.selectListId,listType:b.type})}function m(c){return a.get("api/rest/vad/VadList",{params:{listType:c}}).then(function(a){return b.$getD(a.data)||[]})}function n(a){var b=c.defer();if(window.localStorage&&window.localStorage[a])try{b.resolve(JSON.parse(window.localStorage[a]))}catch(a){b.reject()}else b.reject();return b.promise}function o(c){return a.get("api/rest/companies/followed/"+c,{params:{page:0,size:9999}}).then(function(a){return _.pluck(b.$getD(a.data),"id")||[]})}function p(a){window.localStorage&&window.localStorage.abmCompanySet&&delete window.localStorage[a]}function q(a,b){window.localStorage&&(window.localStorage[a]=JSON.stringify(b))}function r(a){ca.filterUnlockBucket=ca.filterUnlockBucket.filter(function(b){return b.name!==a})}function s(a){ca.filterUnlockBucket.push(a)}function t(){ca.filterUnlockBucket.forEach(function(a){a.func()})}function u(a){ca.spinnerBucket=ca.spinnerBucket.filter(function(b){return b.name!==a})}function v(a){ca.spinnerBucket.push(a)}function w(){ca.spinnerBucket.forEach(function(a){a.func()})}function x(){return da}function y(){da=[],ea=[]}function z(a){da=da.filter(function(b){return b.key!==a.key}),""!==a.value&&a.value.length>0&&da.push(a)}function A(a){ea=ea.filter(function(b){return b.key!==a.key}),""!==a.value&&ea.push(a)}function B(a){fa=_.reject(fa,function(b){return b.data===a})}function C(a){fa.push(a)}function D(a){fa=a}function E(){return fa}function F(){var a=c.defer();return a.resolve({abmUserPrefs:{charts:[{name:"Revenue",listType:"bar",data:"revenueRanges",ordinal:0},{name:"Number of Employees",listType:"bar",data:"employeeRanges",ordinal:1},{name:"Primary Industry",listType:"pie",data:"primaryIndustry",ordinal:2},{name:"Technology",listType:"selectList",data:"technologies",ordinal:3},{name:"Ownership Structure",listType:"pie",data:"ownershipStructure",ordinal:4},{name:"SIC Code",listType:"selectList",data:"sicCodes",ordinal:5},{name:"NAICS Code",listType:"selectList",data:"naicsCodes",ordinal:6}]}}),a.promise}function G(a){return a>=1e9?"$"+parseFloat(a/1e9).toFixed(1)+"B":a>=1e6?"$"+parseFloat(a/1e6).toFixed(1)+"M":a?"$"+parseFloat(a/1e3).toFixed(1)+"K":"--"}function H(a){return a>=1e3?parseFloat(a/1e3).toFixed(1)+"K":a}function I(a,b){var c={};return a.forEach(function(a){"string"==typeof a.value?c[a.key]=a.value:"revenueRanges"===a.key||"employeeRanges"===a.key?c[a.key]=a.value.map(function(a){return a.value}):c[a.key]=a.value.map(function(a){return a.id})}),!ha&&ca.currentDataSet.data&&(c.excludeIds=ca.currentDataSet.data.companiesNotInScope),b&&Object.assign(c,b),c}function J(a){ha=!a}function K(a){var b={};return a.forEach(function(a){b[a.key]=a.value}),void 0===b.revenueRange&&(b.revenueRange=ca.currentDataSet.revenueRange),void 0===b.employeeRange&&(b.employeeRange=ca.currentDataSet.employeeRange),b}function L(a){switch(a){case"revenue":return[{bracket:{low:0,high:499999},name:"Under $500K"},{bracket:{low:5e5,high:1e6},name:"$500K - $1M"},{bracket:{low:1000001,high:5e6},name:"$1M - $5M"},{bracket:{low:5000001,high:1e7},name:"$5M - $10M"},{bracket:{low:10000001,high:25e6},name:"$10M - $25M"},{bracket:{low:25000001,high:5e7},name:"$25M - $50M"},{bracket:{low:50000001,high:1e8},name:"$50M - $100M"},{bracket:{low:100000001,high:25e7},name:"$100M - $250M"},{bracket:{low:250000001,high:5e8},name:"$250M - $500M"},{bracket:{low:500000001,high:1e9},name:"$500M - $1B"},{bracket:{low:1000000001,high:5e9},name:"$1B - $5B"},{bracket:{low:5000000001,high:null},name:"Over $5B"}];case"numEmployees":return[{bracket:{low:1,high:5},name:"1 - 5"},{bracket:{low:6,high:10},name:"6 - 10"},{bracket:{low:11,high:20},name:"11 - 20"},{bracket:{low:21,high:50},name:"21 - 50"},{bracket:{low:51,high:100},name:"51 - 100"},{bracket:{low:101,high:250},name:"101 - 250"},{bracket:{low:251,high:500},name:"251 - 500"},{bracket:{low:501,high:1e3},name:"501 - 1000"},{bracket:{low:1001,high:5e3},name:"1001 - 5000"},{bracket:{low:5001,high:1e4},name:"5001 - 10000"},{bracket:{low:10001,high:null},name:"Over 10000"}]}}function M(b){return ca.currentDataSetId=b||ca.currentDataSetId,a.post("api/rest/vad/lists/"+ca.currentDataSetId,I(da))}function N(){ca.currentDataSet.data.companyList=ca.currentDataSet.data.companyList.map(function(a){return a.hasAccess=!0,ca.currentDataSet.data.companiesNotInScope.forEach(function(b){b===a.companyId&&(a.hasAccess=!1)}),a})}function O(b){return a.put("api/rest/followlists/"+b.id+"?entityType=COMPANY",b.displayName)}function P(b){var c={data:[b.id],headers:{Accept:"application/hal+json,application/json","Content-Type":"application/json"}};return a.delete("api/rest/followlists?entityType=COMPANY",c)}function Q(b,c,d){var f=e.VAD_PORTFOLIO;return"list"===d&&(f=e.MY_LIST),a.post("api/rest/vad/SimilarCompanies",{name:b,listType:f,searchCriteria:c})}function R(b,c){return a.post("api/rest/vad/search/"+ca.currentDataSetId+"?page="+b+"&size="+c,K(ea))}function S(b,c,d,e){return"naicsCodes"===b?a.post("api/rest/vad/naics/"+ca.currentDataSetId+"?page="+c+"&size="+d,I(da,e)):"sicCodes"===b?a.post("api/rest/vad/sic/"+ca.currentDataSetId+"?page="+c+"&size="+d,I(da,e)):"primaryIndustry"===b?a.post("api/rest/vad/industry/"+ca.currentDataSetId,I(da)):"technologies"===b?a.post("api/rest/vad/technology/"+ca.currentDataSetId+"?page="+c+"&size="+d,I(da,e)):"ownershipStructure"===b?a.post("api/rest/vad/ownership/"+ca.currentDataSetId,I(da)):void 0}function T(b){return a.get("api/rest/companies/"+b)}function U(b){return a.get(b)}function V(b){return a.post("api/rest/vad/BulkMatch",{bulkMatchNameAndUrlRequestItems:b})}function W(b,c){return a.post("api/rest/vad/BulkCompanies",{name:b,companyIds:c})}function X(b){return a.post("api/rest/persons/search/counts",{companyIds:b})}function Y(){return ga}function Z(){return a.post("api/rest/vad/searchCounts/"+ca.currentDataSetId,K(ea))}function $(b){var c=b||ca.currentDataSetId;return angular.forEach(a.pendingRequests,function(b){a.abort(b)}),ca.getCompaniesByListId(c).then(function(a){ca.currentDataSet.data=a.data,ca.setOutOfScopeCompanies(),ca.currentDataSet.companyTotal=ca.currentDataSet.data.totalCompanyCount,ca.currentDataSet.revenueRange=ca.currentDataSet.data.revenueRange,ca.currentDataSet.employeeRange=ca.currentDataSet.data.employeeRange;var b=[];_.forEach(ca.currentDataSet.data.companyList,function(a){_.isUndefined(a.revenue)&&(a.revenue=0),b.push(a.companyId)}),X(b).then(function(a){ca.currentDataSet.contactsScope=a.data.searchCriteriaScoped,ca.currentDataSet.contactsNoScope=a.data.searchCriteriaNoScope,ca.invokeEventBucketUpdate("updateContactsCount")}),Z().then(function(a){ca.searchCriteriaScoped=a.data.searchCountsSummary.searchCriteriaScoped,ca.savedSearchRequest=a.data.searchCriteria,ca.invokeEventBucketUpdate("updateSearchCriteriaScoped")}),ca.invokeEventBucketUpdate("portfolioUpdateBucket"),ca.invokeEventBucketUpdate("updateFilterHeader"),ca.invokeEventBucketUpdate("chartUpdate")})}function aa(){ca.saveObjectSetToLocalStorage("abmSearchReqSet",ca.savedSearchRequest);var a=f.href("perform_search",{textTermsApplication:"ABM",status:"viewLookalikesInsearch"});g.open(a,"_blank")}function ba(a){switch(a){case"technologies":return"technologyProductIds";case"primaryIndustry":return"industryIds";case"ownershipStructure":return"ownershipTypeIds";default:return a}}var ca=this;ca.getCompanyLists=m,ca.getObjectSetFromLocalStorage=n,ca.getListCompanyIds=o,ca.removeObjectSetFromLocalStorage=p,ca.saveObjectSetToLocalStorage=q,ca.getCompaniesByListId=M,ca.getSupplmentalData=S,ca.getUserPreferences=F,ca.setOutOfScopeCompanies=N,ca.setOutOfScopeFilter=J,ca.getRevenueString=G,ca.getEmployeeCountString=H,ca.getRangeBands=L,ca.getSearchKey=ba,ca.saveSimilarCompanies=Q,ca.renameList=O,ca.deleteList=P,ca.dataUpdate=$,ca.processBulkMatch=V,ca.createPortfolioWithCompanyIds=W,ca.getFullCompanyList=Y,ca.getCompanyContactsCount=X,ca.getSimilarSearchCount=Z,ca.openLookalikesInSearch=aa,ca.searchCriteriaScoped=0,ca.registerSpinner=v,ca.deregisterSpinner=u,ca.invokeSpinner=w,ca.registerFilterUnlock=s,ca.invokeFilterUnlock=t,ca.deregisterFilterUnlock=r,ca.registerUpdateToEventBucket=h.registerUpdateToEventBucket,ca.deregisterUpdateFromEventBucket=h.deregisterUpdateFromEventBucket,ca.invokeEventBucketUpdate=h.invokeEventBucketUpdate,ca.clearAllEvents=h.clearAllEvents,ca.getSimilarCompanies=R,ca.getCompanyData=T,ca.callLink=U,ca.getCurrentFilters=x,ca.setCurrentFilters=z,ca.clearCurrentFilters=y,ca.setSearchCriteria=A,ca.setCurrentCharts=D,ca.getCurrentCharts=E,ca.addChart=C,ca.removeChart=B,ca.cloneFullCompanyList=k,ca.currentDataSet={},ca.rawDataSet={},ca.currentDataSet.companyTotal=0,ca.currentDataSet.contactsTotal=0,ca.currentDataSet.revenueRange=[],ca.currentDataSet.employeeRange=[],ca.currentCompanyName="",ca.chartUpdateBucket=[],ca.filterUnlockBucket=[],ca.spinnerBucket=[],ca.setPortfolioList=j,ca.getPortfolioList=i,ca.createVadList=l,ca.savedSearchRequest={},ca.totalAccessibleSearchCount=0,ca.finishInit=!1;var da=[],ea=[],fa=[],ga=!1,ha=!0,ia=[];ca.chartList=[{name:"Revenue",listType:"bar",data:"revenueRanges"},{name:"Number of Employees",listType:"bar",data:"employeeRanges"},{name:"Technology",listType:"selectList",data:"technologies"},{name:"Ownership Structure",listType:"pie",data:"ownershipStructure"},{name:"Primary Industry",listType:"pie",data:"primaryIndustry"},{name:"SIC Codes",listType:"selectList",data:"sicCodes"},{name:"NAICS Codes",listType:"selectList",data:"naicsCodes"}]}angular.module("dorgEuiApp").service("AbmService",a),a.$inject=["$http","$embeddedUtils","$q","$timeout","dorgConfig","$state","$window","eventBusService"]}(),function(){"use strict";var a=function(a,b){function c(){var b=a.chartList,c=a.getCurrentCharts();d.availableCharts=_.filter(b,function(a){return _.every(c,function(b){return a.data!==b.data})})}var d=this;d.availableCharts=[],d.selectedChartName="",d.close=function(){b.dismissAll(),a.deregisterUpdateFromEventBucket("tileUpdate","tileUpdate")},d.addChart=function(c){c&&(a.addChart(c),a.invokeEventBucketUpdate("tileUpdate",c),b.dismissAll())},d.selectChart=function(a){var b=_.findWhere(d.availableCharts,{name:a.target.dataset.value});d.selectedChart=b,[].forEach.call(a.currentTarget.parentNode.children,function(a){a.classList.remove("selected")}),a.currentTarget.classList.add("selected")},c()};a.$inject=["AbmService","$uibModalStack"],angular.module("dorgEuiApp").component("addChartDialogue",{templateUrl:"app/views/vad/components/addChartDialogue/addChartDialogue.html",controller:a})}(),function(){"use strict";function a(a,b,c,d){function e(){c.dismissAll()}function f(){b(g,500)}function g(){r=!1,s.showPopOver=!1}function h(a){return d.getEmployeeCountString(a)}function i(a){return d.getRevenueString(a)}function j(c,e){o&&b.cancel(o),o=b(function(){var b=a[0].children[0].getElementsByClassName("civ-sortable-table-container")[0].getBoundingClientRect(),c=document.getElementsByClassName("modal-company-pop-over")[0],f=b.top-225;r=!1,s.popOver.companyId=e.companyId,s.popOver.name=e.name,s.showPopOver=!0,c.setAttribute("style","top: "+f+"px;margin-left: 450px;"),d.invokeEventBucketUpdate("loadCompanyDataCivModal",{name:e.name,id:e.companyId})},500)}function k(){if(_.has(d.currentDataSet,"data")){var a=[];p=d.currentDataSet.data.companyList,a=_.pluck(p,"companyId"),s.inViewCount=p.length,q=_.filter(d.getFullCompanyList(),function(b){return!_.contains(a,b.companyId)}),s.outOfViewCount=q.length,n(s.activeTab),d.deregisterUpdateFromEventBucket("dismissPopOver","dismissPopOver"),d.registerUpdateToEventBucket("dismissPopOver",{name:"dismessPopOver",func:g}),d.deregisterUpdateFromEventBucket("isOverPopUp","setIsOverPopUp"),d.registerUpdateToEventBucket("isOverPopUp",{name:"setIsOverPopUp",func:l})}}function l(){r=!0}function m(a){s.sortBy===a?"asc"===s.sortDir?s.sortDir="desc":s.sortDir="asc":(s.sortBy=a,s.sortDir="asc"),s.companies=_.sortByOrder(s.companies,[a],[s.sortDir])}function n(a){s.activeTab=a,"inView"===a?s.companies=_.sortByOrder(p,[s.sortBy],[s.sortDir]):s.companies=_.sortByOrder(q,[s.sortBy],[s.sortDir])}var o,p=[],q=[],r=!1,s=this;s.activeTab="inView",s.close=e,s.closePopover=f,s.companies=[],s.getEmployeeString=h,s.getRevenueString=i,s.openPopover=j,s.popOver={},s.sortBy="name",s.sortCompanies=m,s.sortDir="asc",s.switchTabTo=n,k()}angular.module("dorgEuiApp").component("companiesInViewDialogue",{templateUrl:"app/views/vad/components/companiesInViewDialogue/companiesInViewDialogue.html",controller:a}),a.$inject=["$element","$timeout","$uibModalStack","AbmService"]}(),function(){"use strict";var a=function(a,b){function c(){var b=a.getPortfolioList().length>0?"default":"noLists";d.switchView(b)}var d=this,e=d.nocompanylists;d.title="Welcome to AccountView",d.getView=function(){e?d.switchView("noLists"):d.switchView("default")},d.close=function(){b.dismissAll()},d.switchView=function(a){switch(d.view=a,a){case"csv":d.title="Upload a CSV";break;case"default":d.title="Create a Portfolio";break;case"noLists":d.title="Welcome to AccountView";break;case"bulk":d.title="Create a Portfolio using ListMatch";break;case"import":d.title="Import a List From My Lists";break;default:d.title="Create a Portfolio"}},c()};a.$inject=["AbmService","$uibModalStack"],angular.module("dorgEuiApp").component("createPortfolioDialogue",{templateUrl:"app/views/vad/components/createPortfolioDialogue/createPortfolioDialogue.html",controller:a})}(),function(){"use strict";var a=function(a,b,c){function d(a){var b=a.target.result;e(b)}function e(a){h.lines=[];var b=a.split(/\r\n|\n|\r/);b.length>5e3&&(b=b.slice(0,5e3));for(var c=0;c<b.length;c++){var d=b[c].split(","),e={};d[0]&&(e.companyName=d[0],d[1]&&(e.url=d[1]),h.lines.push(e))}h.processBulkMatch(h.lines)}function f(a){h.showSpinner=!1}function g(){h.view="bulk"===h.key?"bulk":"fileUpload",h.bulkListSuggestions.push({categoryType:"Company Names"})}var h=this;h.bulkListSuggestions=[],h.lines=[],h.matchedArray=[],h.unMatchedArray=[],h.processArrayIds=[],h.totalMatchCount=0,h.totalDisplay=20,h.isAllSelected=!1,h.hasError=!1,h.showSpinner=!1,h.errorMessage="CSV Import Failed - Please Try Again.";var i=function(a){var b=new FileReader;b.readAsText(a),b.onload=d,b.onerror=f},j=function(a){for(var b,d=0;b=a[d];d++)if("text/csv"===b.type)i(b);else if(b.type||""===b.type){var e=b.name.split(".");"csv"===e[e.length-1]?i(b):(h.hasError=!0,h.showSpinner=!1,h.errorMessage="Cannot read file of this type.",c(function(){h.hasError=!1},2e3))}};h.parseDropCSV=function(a){h.showSpinner=!0;var b=a.dataTransfer.files;j(b)},h.close=function(){b.dismissAll()},h.parseCSV=function(a){var b=a.target.files;j(b)},h.selectAll=function(a){h.isAllSelected=!a,h.processArrayIds=[],h.matchedArray.forEach(function(a){a.selected=h.isAllSelected,h.isAllSelected&&h.processArrayIds.push(a.id)})},h.selectData=function(a){a.selected=!a.selected,a.selected?h.processArrayIds.push(a.id):h.processArrayIds=h.processArrayIds.filter(function(b){return b!==a.id})},h.process=function(c,d){h.showSpinner=!0;var e=a.getPortfolioList().filter(function(a){return a.displayName===c});e.length>0?(h.hasError=!0,h.errorMessage="Portfolio name must be unique. Please enter a unique name."):d.length>0&&(a.invokeEventBucketUpdate("preSave",{name:c}),a.createPortfolioWithCompanyIds(c,d).then(function(){b.dismissAll("close"),a.invokeEventBucketUpdate("updateLeftRailList")},function(){h.error=!0,h.errorMessage="An error has occurred.  Please try again."}).finally(function(){h.showSpinner=!1}))},h.isDisabled=function(a){return h.processArrayIds.length>0&&a&&""!==a},h.processBulkMatch=function(b){h.showSpinner=!0,"bulk"===h.view&&(b=b.split("\n"),b=_.map(b,function(a){return{companyName:a.trim()}})),a.processBulkMatch(b).then(function(a){var b=0;h.matchedTermsLength=Object.keys(a.data.matchedTerms).length,h.unMatchedTermsLength=Object.keys(a.data.unMatchedTerms).length,_.each(a.data.matchedTerms,function(a,c){_.each(a,function(d){var e=c.toLowerCase()===d.displayName.toLowerCase(),f={key:c,displayName:d.displayName,id:d.id,selected:e,multimatch:a.length>1||!1,exactMatch:e};h.matchedArray.push(f),h.totalMatchCount++,f.selected&&b++,f.exactMatch&&h.processArrayIds.push(f.id)})}),b===h.totalMatchCount&&(h.isAllSelected=!0),h.unMatchedTerms=a.data.unMatchedTerms.join("\n"),h.showSpinner=!1,h.view="bulkMatches"})},h.loadMore=function(){h.totalDisplay+=5},this.$onInit=function(){h.key=this.key,g()}};a.$inject=["AbmService","$uibModalStack","$timeout"],angular.module("dorgEuiApp").component("csvUpload",{templateUrl:"app/views/vad/components/csvUpload/csvUpload.html",controller:a,bindings:{key:"="}})}(),function(){"use strict";var a=function(a,b){var c=this;c.confirm=function(){b.invokeEventBucketUpdate("deletePortfolio"),a.dismissAll()},c.cancel=function(){a.dismissAll()}};a.$inject=["$uibModalStack","AbmService"],angular.module("dorgEuiApp").component("deletePortfolio",{templateUrl:"app/views/vad/components/deletePortfolio/deletePortfolio.html",controller:a})}(),function(){"use strict";var a=function(a,b,c){function d(){a.openLookalikesInSearch()}function e(){b.open({openedClass:"lookalike-modal",templateUrl:"app/views/vad/partials/lookalikes.modal.html"})}function f(){j.searchCriteriaScoped=a.searchCriteriaScoped<=5e3?a.searchCriteriaScoped:"5000+"}function g(){j.isSaveDisabled=!0}function h(){j.isSaveDisabled=!1}function i(){a.registerUpdateToEventBucket("updateSearchCriteriaScoped",{name:"updateSearchCriteriaScoped",func:f}),a.registerUpdateToEventBucket("preSave",{name:"preSaveExport",func:g}),a.registerUpdateToEventBucket("updateLeftRailList",{name:"leftRailUpdateExport",func:h}),f()}var j=this;j.openLookalikesInSearch=d,j.openLookalikesModal=e,j.isSaveDisabled=!1,i()};a.$inject=["AbmService","$uibModal","$uibModalStack","$state","$window"],angular.module("dorgEuiApp").component("exportLookalikes",{templateUrl:"app/views/vad/components/exportLookalikes/exportLookalikes.html",controller:a})}(),function(){"use strict";var a=function(a,b){function c(){e.currentFilters=angular.copy(a.getCurrentFilters()),e.currentFilters.forEach(function(a){switch(a.value=a.value.map(function(a){return a.name}).join(", "),a.key){case"employeeRanges":a.displayName="Employees";break;case"ownershipStructure":a.displayName="Ownership";break;case"primaryIndustry":a.displayName="Industry";break;case"naicsCodes":a.displayName="NAICS";break;case"sicCodes":a.displayName="SIC";break;case"revenueRanges":a.displayName="Revenue";break;case"technologies":a.displayName="Technologies";break;default:a.displayName=a.key}})}function d(){a.registerUpdateToEventBucket("updateFilterHeader",{name:"filterHeaderUpdate",func:c})}var e=this;e.listData={},e.portfolioTotalCount=0,e.currentFilterCount=0,e.name="";var f=function(){a.invokeEventBucketUpdate("removeFilter"),a.invokeSpinner(),a.dataUpdate()};e.removeFilter=function(b){var c="";switch(b){case"technologies":c="technologyProductIds";break;case"primaryIndustry":c="industryIds";break;case"ownershipStructure":c="ownershipTypeIds";break;default:c=b}a.setCurrentFilters({key:b,value:""}),a.setSearchCriteria({key:c,value:""}),f()},e.clearFilters=function(){a.clearCurrentFilters(),f()},d()};a.$inject=["AbmService"],angular.module("dorgEuiApp").component("filterHeader",{templateUrl:"app/views/vad/components/filterHeader/filterHeader.html",controller:a})}(),function(){"use strict";var a=function(a,b,c){function d(){a.getCompanyLists(b.MY_LIST).then(function(a){e.myLists=a})}var e=this;e.import={},e.import.selectListId=null,e.import.listName="",e.hasError=!1,e.showSpinner=!1,e.myLists=[],e.importList=function(d){e.hasError=!1;var f=a.getPortfolioList().filter(function(a){return!_.isUndefined(d.listName)&&!_.isNull(d.listName)&&a.displayName.toLowerCase()===d.listName.toLowerCase()});f.length>0?(e.hasError=!0,e.errorMessage="Portfolio name must be unique. Please enter a unique name."):(e.showSpinner=!0,d.type=b.VAD_PORTFOLIO,a.invokeEventBucketUpdate("preSave",{name:d.listName}),a.createVadList(d).then(function(){a.invokeEventBucketUpdate("updateLeftRailList"),c.dismissAll("close")},function(){e.hasError=!0,e.errorMessage="An error has occurred.  Please try again."}).finally(function(){e.showSpinner=!1}))},e.importDisabled=function(){return""===e.import.listName||!e.import.selectListId},e.selectOption=function(a){e.import.selectListId=a.target.dataset.value},d()};a.$inject=["AbmService","dorgConfig","$uibModalStack"],angular.module("dorgEuiApp").component("importMyList",{templateUrl:"app/views/vad/components/importMyList/importMyList.html",controller:a})}(),function(){"use strict";var a=function(){};angular.module("dorgEuiApp").component("leftRail",{templateUrl:"app/views/vad/components/leftRail/leftRail.html",controller:a})}(),function(){"use strict";var a=function(a,b,c,d,e,f,g,h){function i(){a.registerUpdateToEventBucket("chartUpdate",{name:"similarCompanies",func:l.updateSearchList}),a.registerUpdateToEventBucket("similarCompaniesSearch",{name:"similarCompanies",func:j}),l.totalAccessible=a.totalAccessibleSearchCount,j()}function j(a){l.page=0,l.runSearch=!a,l.runSearch||(l.searchResults=[]),l.searchSimilarCompanies()}var k,l=this,m={};l.errorText="",l.exportCriteria={},l.hasError=!1,l.hasSpinner=!1,l.isCompanySearch=!1,l.myLists=[],l.page=0,l.pageSize=50,l.portfolioName=a.currentCompanyName+" Lookalike",l.searchResults=[],l.showSpinner=!1,l.runSearch=!1,l.sortReverse=!1,l.sortType="name",l.title="Export Lookalike Companies",l.totalAccessible=0,l.totalCompanies=0,l.view="default",l.close=function(){f.dismissAll()},l.companySearch=function(c){k&&b.cancel(k),k=b(function(){a.setSearchCriteria({key:"companyName",value:c}),l.isCompanySearch=!0,l.showSpinner=!0,l.page=0,a.getSimilarCompanies(l.page,l.pageSize).then(function(a){a.data.pagedResources?(l.searchResults=a.data.pagedResources.content,l.page++):l.searchResults=[],""===c&&(l.isCompanySearch=!1),l.showSpinner=!1})},500)},l.getEmployeeString=function(b){return a.getEmployeeCountString(b)},l.getRevenueString=function(b){return a.getRevenueString(b)},l.importDisabled=function(a){return a&&""!==a},l.openCompanyInNewTab=function(a){l.showSpinner=!0;var b=d.href("view_company",{detailsFor:a.id});c.open(b,"_blank"),l.showSpinner=!1},l.openLookalikesInSearch=function(){a.openLookalikesInSearch()},l.saveSimilarCompaniesModal=function(){a.savedSearchRequest=m,e.open({templateUrl:"app/views/vad/partials/similarCompaniesSave.modal.html"})},l.saveSimilarCompanies=function(b,c){l.hasSpinner=!0,l.hasError=!1,l.isListExist(l.portfolioName)?(l.hasError=!0,l.errorText="Duplicate names are not allowed. Please enter a unique name.",l.hasSpinner=!1):"list"!==c?(a.invokeEventBucketUpdate("preSave",{name:b}),a.saveSimilarCompanies(b,a.savedSearchRequest.savedSearch.searchCriteria,c).then(function(b){f.dismissAll("close"),a.savedSearchRequest=null,a.invokeEventBucketUpdate("updateLeftRailList"),g.create("success","Export Successful!","flash")},function(){l.hasError=!0,l.errorText="Creating a Portfolio failed. Please try again."}).finally(function(){l.hasSpinner=!1})):(f.dismissAll("close"),a.saveSimilarCompanies(b,a.savedSearchRequest.savedSearch.searchCriteria,c).then(function(b){a.savedSearchRequest=null,g.create("success","List Successfully Created!","flash")},function(){l.hasError=!0,l.errorText="Creating a List failed. Please try again."}).finally(function(){l.hasSpinner=!1}))},l.searchSimilarCompanies=function(){return l.isCompanySearch?void(l.isCompanySearch=!1):void(l.runSearch&&(l.showSpinner=!0,a.getSimilarCompanies(l.page,l.pageSize).then(function(b){200===b.status&&(b.data.searchCriteria&&(a.savedSearchRequest=b.data.searchCriteria,b.data.searchCriteria.savedSearch&&(l.exportCriteria=b.data.searchCriteria.savedSearch.searchCriteria)),l.searchResults=l.searchResults.concat(b.data.pagedResources.content),l.totalCompanies=b.data.pagedResources.page.totalElements,l.page++)}).finally(function(){l.showSpinner=!1})))},l.switchView=function(b){switch(l.view=b,l.hasError=!1,l.portfolioName=a.currentCompanyName+" Lookalike",b){case"list":l.title="Create New My List";break;case"default":l.title="Export Lookalike Companies";break;case"portfolio":l.title="Create New Portfolio";break;default:l.title="Export Lookalike Companies"}},l.updateSearchList=function(){l.searchResults=[],l.page=0,l.searchSimilarCompanies()},l.isListExist=function(b){var c=!1,d=a.getPortfolioList().filter(function(a){return a.displayName===b});return d.length>0&&(c=!0),c},i()};a.$inject=["AbmService","$timeout","$window","$state","$uibModal","$uibModalStack","Flash","dorgConfig"],angular.module("dorgEuiApp").component("lookalikesDialogue",{templateUrl:"app/views/vad/components/lookalikesDialogue/lookalikesDialogue.html",controller:a})}(),function(){"use strict";function a(a,b,c){function d(){c.registerUpdateToEventBucket("portfolioUpdateBucket",{name:"headerBarUpdate",func:g}),c.registerUpdateToEventBucket("updateContactsCount",{name:"updateContacts",func:h}),c.registerUpdateToEventBucket("updateSearchCriteriaScoped",{name:"updateSearchCriteriaScopedHeader",func:i}),i()}function e(){b.open({templateUrl:"app/views/vad/partials/companiesInView.modal.html"})}function f(){b.open({openedClass:"lookalike-modal",templateUrl:"app/views/vad/partials/lookalikes.modal.html"})}function g(){j.contactsTotal=c.currentDataSet.contactsTotal,j.currentFilterCount=c.currentDataSet.data.companyList.length,j.inScopeCount=c.currentDataSet.data.countInScope||0,j.name=c.currentCompanyName,j.portfolioTotalCount=c.currentDataSet.companyTotal}function h(){j.contactsTotal=c.currentDataSet.contactsNoScope}function i(){j.searchCriteriaScoped=c.searchCriteriaScoped<=5e3?c.searchCriteriaScoped:"5000+"}var j=this;j.contactsTotal=0,j.currentFilterCount=0,j.name="",j.openCompaniesInViewModal=e,j.openExportLookalikesModal=f,j.portfolioTotalCount=0,d()}angular.module("dorgEuiApp").component("portfolioHeader",{templateUrl:"app/views/vad/components/portfolioHeader/portfolioHeader.html",controller:a}),a.$inject=["$scope","$uibModal","AbmService"]}(),function(){"use strict";var a=function(a,b,c,d,e,f){function g(){k.listsLoading=!0,a.getCompanyLists(b.VAD_PORTFOLIO).then(function(b){k.listsLoading=!1,b.length?(k.lists=b,k.listId=b[0].id,k.selectedListId=b[0].id,k.portfolioName=b[0].displayName,k.portfolioCount=b.length,a.setPortfolioList(b)):c.open({template:"<create-portfolio-dialogue ></create-portfolio-dialogue>"})})}function h(a){var b={displayName:a.name,id:null};k.lists.unshift(b),k.isSaveDisabled=!0}function i(){k.listsLoading=!0,a.getCompanyLists(b.VAD_PORTFOLIO).then(function(b){k.listsLoading=!1,a.setPortfolioList(b),b.length&&(k.lists=b,k.portfolioCount=k.lists.length,k.listId=b[0].id,k.getListData(b[0],b[0].displayName),k.portfolioName=b[0].displayName,k.isSaveDisabled=!1,f.create("success","Portfolio Successfully Created!","flash"))})}function j(){a.registerUpdateToEventBucket("preSave",{name:"preSave",func:h}),a.registerUpdateToEventBucket("updateLeftRailList",{name:"leftRailUpdate",func:i}),a.registerUpdateToEventBucket("deletePortfolio",{name:"deletePortfolio",func:q}),a.getObjectSetFromLocalStorage().then(function(a){k.hasCompanySet=!0,k.companySet=a},g)}var k=this,l=null,m="",n=!1,o=!1;k.isOpen=!1,k.lists=[],k.listId=null,k.listsLoading=!1,k.portfolioCount=0,k.portfolioName="Portfolios",k.hasError=!1,k.errorMessage="Cannot have duplicate names for Portfolios.",k.isSaveDisabled=!1;var p=function(){c.open({templateUrl:"app/views/vad/partials/delete.modal.html"})};k.getPortfolioName=function(){return k.isOpen||0===a.getPortfolioList().length?k.portfolioName="Portfolios":(k.portfolioName=a.currentCompanyName,k.portfolioName.length>25&&(k.portfolioName=k.portfolioName.substring(0,24)+"...")),k.portfolioName},k.openList=function(){k.isOpen=!k.isOpen,k.isOpen&&(o=!0,e(function(){o=!1},200)),e(function(){document.getElementsByClassName("portfolio-list")[0].focus()})},k.listBlur=function(){if(!o&&k.isOpen!==!1)return n?void(n=!1):void(k.isOpen=!1)},k.getListData=function(b,c){o=!0,e(function(){o=!1},200),null===b.id||k.selectedListId===b.id||b.renaming||(a.clearCurrentFilters(),a.invokeFilterUnlock(),a.invokeSpinner(),a.currentCompanyName=c,k.selectedListId=b.id,1===k.lists.length?a.invokeEventBucketUpdate("reinit"):a.finishInit?(a.dataUpdate(b.id).then(function(){a.cloneFullCompanyList(a.currentDataSet.data)}),k.portfolioName=c):a.invokeEventBucketUpdate("reinit",{listId:b.id}))},k.createNewList=function(){k.isSaveDisabled===!1&&c.open({templateUrl:"app/views/vad/partials/createlist.modal.html"})},k.listActions={rename:function(a){n=!0,k.lists.forEach(function(a){a.renaming=!1}),a.renaming=!a.renaming||!0,m=a.displayName},deleteList:function(a){n=!0,l=a,p()}},k.renameList=function(b){""!==b.displayName?a.renameList(b).then(function(){b.renaming=!1,n=!1,document.getElementsByClassName("portfolio-list")[0].focus(),b.id===k.selectedListId&&(k.portfolioName=b.displayName,a.currentCompanyName=b.displayName,a.invokeEventBucketUpdate("portfolioUpdateBucket"))},function(){k.errorMessage="Cannot have duplicate names for Portfolios.",k.hasError=!0,b.displayName=m,b.renaming=!1,n=!1,e(function(){k.hasError=!1},2e3)}):(b.displayName=m,k.errorMessage="Portfolio name cannot be blank.",k.hasError=!0,e(function(){k.hasError=!1},2e3))};var q=function(){a.deleteList(l).then(function(){if(document.getElementsByClassName("portfolio-list")[0].focus(),k.lists=k.lists.filter(function(a){return a.id!==l.id}),k.portfolioCount=k.lists.length,k.lists&&k.lists.length>0){var b=k.lists[0].displayName,d=k.lists[0].id;a.clearCurrentFilters(),a.invokeFilterUnlock(),a.invokeSpinner(),a.currentCompanyName=b,k.selectedListId=d,a.dataUpdate(d)}else a.invokeEventBucketUpdate("reinit"),c.open({template:"<create-portfolio-dialogue ></create-portfolio-dialogue>"})})};k.stopProp=function(a){a.stopPropagation(),o=!0,e(function(){o=!1},200)},j()};a.$inject=["AbmService","dorgConfig","$uibModal","$uibModalStack","$timeout","Flash"],angular.module("dorgEuiApp").component("portfolioSelector",{templateUrl:"app/views/vad/components/portfolioSelector/portfolioSelector.html",controller:a})}(),function(){"use strict";var a=function(a){function b(){a.clearAllEvents()}var c=this;c.listData={},c.companySet=[],c.hasCompanySet=!1,c.listId=null,c.lists=[{id:null,displayName:"Loading lists..."}],c.listsLoading=!1,c.loadingCompaniesFromList=!1,b()};a.$inject=["AbmService"],angular.module("dorgEuiApp").component("vadRoot",{templateUrl:"app/views/vad/components/vadRoot/vadRoot.html",controller:a})}(),function(){"use strict";angular.module("dorgEuiApp").directive("abmDashboard",["AbmService","$q","$compile","dorgConfig",function(a,b,c,d){return{templateUrl:"app/views/vad/directives/abmDashboard/abmDashboard.html",scope:{},link:function(e,f){function g(){if(a.getCurrentCharts().length<a.chartList.length){for(var b=document.getElementsByClassName("tile-list")[0],d=b.children.length,g=d-1;g>d-5;g--)$(b.children[g]).remove();b=f.children(".tile-list");var h=[];h.push('<li><div class="tiles" tiles></div></li>');for(var i=0;i<4;i++)h.push("<li></li>");h.forEach(function(a){b.append(c(a)(e))})}}var h,i=function(g){e.spinnerGo=!0,a.currentCompanyName="",a.getCompanyLists(d.VAD_PORTFOLIO).then(function(d){if(a.clearCurrentFilters(),!d||0===d.length)return e.spinnerGo=!1,a.setPortfolioList(d),a.currentDataSet.contactsScope=0,a.currentDataSet.contactsNoScope=0,a.currentDataSet.data={},a.currentDataSet.data.companyList=[],a.invokeEventBucketUpdate("updateContactsCount"),
a.currentDataSet.revenueRange=[0,0],a.currentDataSet.employeeRange=[0,0],a.invokeEventBucketUpdate("portfolioUpdateBucket"),f.html("<div></div>"),f.append('<img id="no-lists-image" src="assets/images/accountview-empty-state-image.png" ng-if="abmService.setPortfolioList().length <= 0"></img>'),void f.append("<p>Get started with AccountView by creating a new Portfolio</p>");f.children(".no-lists-image")&&f.children(".no-lists-image").remove(),a.currentCompanyName=d[0].displayName,a.invokeSpinner();var h=d[0].id;g&&g.listId&&(h=g.listId),b.all([a.getCompaniesByListId(h),a.getUserPreferences()]).then(function(b){a.currentDataSet.revenueRange=b[0].data.revenueRange,a.currentDataSet.employeeRange=b[0].data.employeeRange,a.getSimilarSearchCount().then(function(b){a.searchCriteriaScoped=b.data.searchCountsSummary.searchCriteriaScoped,a.savedSearchRequest=b.data.searchCriteria,a.totalAccessibleSearchCount=b.data.searchCountsSummary.totalAccessable,a.invokeEventBucketUpdate("updateSearchCriteriaScoped")}),a.currentDataSet.data=b[0].data,a.setOutOfScopeCompanies(),a.setCurrentCharts(b[1].abmUserPrefs.charts),f.append('<ul class="tile-list"></ul>');var d=f.children(".tile-list"),g=[];b[1].abmUserPrefs.charts.forEach(function(a){var b="";a.listType&&(b='<li><div draggable="true" class="tiles" tiles chart-type="'+a.listType+'" graph-type="'+a.data+'" chart-name="'+a.name+'"></div></li>'),""!==b&&g.push(b)}),a.cloneFullCompanyList(a.currentDataSet.data),a.currentDataSet.CompanyTotal=a.currentDataSet.data.companyList.length;var h=[];_.forEach(a.currentDataSet.data.companyList,function(a){_.isUndefined(a.revenue)&&(a.revenue=0),h.push(a.companyId)}),a.getCompanyContactsCount(h).then(function(b){a.currentDataSet.contactsScope=b.data.searchCriteriaScoped,a.currentDataSet.contactsNoScope=b.data.searchCriteriaNoScope,a.invokeEventBucketUpdate("updateContactsCount")}),a.currentDataSet.revenueRange=a.currentDataSet.data.revenueRange,a.currentDataSet.employeeRange=a.currentDataSet.data.employeeRange,a.invokeEventBucketUpdate("portfolioUpdateBucket"),a.getCurrentCharts().length<a.chartList.length&&g.push('<div class="tiles" tiles></div>');for(var i=0;i<4;i++)g.push("<li></li>");g.forEach(function(a){d.append(c(a)(e))}),a.finishInit=!0,e.spinnerGo=!1})})};i(),document.addEventListener("dragstart",function(a){h=a.target.id},!1),document.addEventListener("dragenter",function(a){a.target.classList.contains("dropzone")},!1),document.addEventListener("drop",function(a){a.preventDefault(),console.log(a)}),document.addEventListener("dragleave",function(a){a.target.classList.contains("dropzone")&&(a.target.style.width="450px")},!1),a.registerUpdateToEventBucket("tileUpdate",{name:"newTileUpdate",func:g}),a.registerUpdateToEventBucket("reinit",{name:"reinit",func:i})}}}])}(),function(){"use strict";angular.module("dorgEuiApp").directive("bufferedScroll",["$parse",function(a){return function(b,c,d){var e=a(d.bufferedScroll);c[0].addEventListener("scroll",function(a){var d=c[0].scrollTop,f=c[0].scrollHeight,g=c[0].offsetHeight;d+1>f-g&&b.$apply(function(){e(b)})})}}])}(),function(){"use strict";var a=function(a,b,c,d){function e(){var a=d[0].children[0].getElementsByClassName("graph-pos")[0].getBoundingClientRect(),b=document.getElementsByClassName("company-pop-over")[0],c=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,e=a.top+c-225,f="margin-left: 450px;";a.right+500>window.innerWidth&&(f="margin-left: -400px;"),b.setAttribute("style","top: "+e+"px;"+f)}var f=this;f.list=[],f.totalDisplay=20,f.listId=f.graphType+"_id",f.popUp={},f.popUp.name=null,f.popUp.companyId=null,f.showPopUp=!1;var g,h,i=[],j=!1,k=function(){d.querySelectorAll(".companyRowHover").removeClass("companyRowHover"),j=!1,f.showPopUp=!1},l=function(){j=!0},m=function(){f.list=f.listData,i=f.listData,a.registerUpdateToEventBucket("chartUpdate",{name:f.graphType,func:f.getListData}),a.deregisterUpdateFromEventBucket("dismissPopOver","dismissPopOver"),a.registerUpdateToEventBucket("dismissPopOver",{name:"dismessPopOver",func:k}),a.deregisterUpdateFromEventBucket("isOverPopUp","setIsOverPopUp"),a.registerUpdateToEventBucket("isOverPopUp",{name:"setIsOverPopUp",func:l})};f.getRevenueString=function(b){return a.getRevenueString(b)},f.getEmployeeString=function(b){return a.getEmployeeCountString(b)},f.getListData=function(){f.totalDisplay=20;var b=document.getElementById(f.listId);b.scrollTop=1;var c=a.currentDataSet.data;"companyNames"===f.graphType&&(i=f.list=c.companyList),"similarCompanies"===f.graphType&&a.getSimularCompanies(c).then(function(a){f.list=a})},f.search=function(a){h&&b.cancel(h),h=b(function(){a&&""!==a?f.list=_.filter(i,function(b){return b.name.toLowerCase().includes(a.toLowerCase())}):f.list=i},500)},f.mouseOver=function(c,h){d.querySelectorAll(".companyRowHover").removeClass("companyRowHover"),$(c.currentTarget).addClass("companyRowHover"),g&&b.cancel(g),g=h.hasAccess===!0?b(function(){j=!1,f.popUp.name=h.name,f.popUp.companyId=h.companyId,f.showPopUp=!0,e(),a.invokeEventBucketUpdate("loadCompanyDataTile",{name:h.name,id:h.companyId})},500):b(function(){j=!1,f.showPopUp=!1},500)},f.mouseOut=function(){b(function(){j===!1&&k()},500)},f.loadMore=function(){f.totalDisplay+=5},m()};a.$inject=["AbmService","$timeout","$compile","$element"],angular.module("dorgEuiApp").directive("companyListChart",[function(){return{templateUrl:"app/views/vad/directives/companyListChart/companyListChart.html",scope:{graphType:"@",listData:"="},bindToController:!0,controller:a,controllerAs:"slc"}}])}(),function(){"use strict";angular.module("dorgEuiApp").directive("companyPopOver",["AbmService",function(a){return{templateUrl:"app/views/vad/directives/companyPopOver/companyPopOver.html",scope:{bucketName:"@",companyId:"@",companyName:"@"},link:function(b){var c={},d={};b.data={},b.managers=[];var e=function(e){b.spinnerGo=!0,b.data={},b.managers={},e.id&&!c[e.id]?a.getCompanyData(e.id).then(function(f){b.data=f.data,c[e.id]=f.data,a.callLink(f.data._links.topManagers.href).then(function(a){b.spinnerGo=!1,a.data._embedded&&(d[e.id]=a.data._embedded.companyDepartmentForTopManagerList,b.managers=a.data._embedded.companyDepartmentForTopManagerList)})}):(b.spinnerGo=!1,b.data=c[e.id],b.managers=d[e.id])};b.bucketName?(b.mouseOut=function(){a.invokeEventBucketUpdate("dismissPopOver")},b.mouseOver=function(){a.invokeEventBucketUpdate("isOverPopUp")},a.deregisterUpdateFromEventBucket(b.bucketName,"loadData"),a.registerUpdateToEventBucket(b.bucketName,{name:"loadData",func:e})):e({id:b.companyId,name:b.comanyName})}}}])}(),function(){"use strict";angular.module("dorgEuiApp").directive("listDataSetSelector",["AbmService","$compile",function(a,b){return{scope:{graphType:"@"},link:function(c,d,e){c.listData=[];var f=function(){var f=a.currentDataSet.data;a.setOutOfScopeCompanies(),"companyNames"===e.graphType&&(c.listData=f.companyList,d.append(b('<div company-list-chart graph-type={{graphType}} list-data="listData"></div>')(c)))},g=function(){f()};g()}}}])}(),function(){"use strict";angular.module("dorgEuiApp").directive("multiSelectListChart",["AbmService","$timeout",function(a,b){return{templateUrl:"app/views/vad/directives/multiSelectListChart/multiSelectListChart.html",scope:{graphType:"@",displayPercent:"=",threeColumn:"@"},link:function(c,d,e){function f(){c.spinnerGo=!0}function g(b,d){a.getSupplmentalData(e.graphType,p,q,d).then(function(d){var e=d.config.data.name;p++;a.currentDataSet.data.companyList.length;a.getCurrentFilters()<1&&(l=[]);var f=_.sortBy(d.data.graphData,function(a){return a.percentage*-1});b?c.data=f:c.data=c.data.concat(f),void 0===e&&c.data.length<=0?c.showFilter=!1:c.showFilter=!0,c.spinnerGo=!1,c.isInitializing=!1,c.totalDisplayed=20;var g=document.getElementById(c.listId);g&&b&&(g.scrollTop=1)}).catch(function(){c.spinnerGo=!1,c.isInitializing=!1,console.log("error")})}function h(a){return o===!0?(c.spinnerGo=!1,void(o=!1)):(a||(c.query=""),p=0,n=[],void g(!0,a))}var i,j,k=null,l=[],m=[],n=[],o=!1,p=0,q=25;c.query="",c.totalDisplayed=25,c.spinnerGo=!0,c.isInitializing=!0,h(),c.listId=c.graphType+"_chart",c.search=function(a){j&&b.cancel(j),a&&""!==a?j=b(function(){h(!isNaN(a)&&c.threeColumn?{code:a}:{name:a})},250):h()};var r=function(a){if(a.isSelected)l.push(a),m.push(a.id);else{var b=_.findIndex(l,{id:a.id}),c=m.indexOf(a.id);l.splice(b,1),m.splice(c,1)}},s=function(b,c){a.setCurrentFilters(b),console.log(b.key),a.setSearchCriteria({key:a.getSearchKey(b.key),value:c})};c.select=function(d,f){if(d.isSelected=!d.isSelected,window.event.shiftKey){var g=0,h=0;k<f?(g=k+1,h=f):(g=f,h=k-1);for(var j=g;j<=h;j++)c.data[j].isSelected=d.isSelected,r(c.data[j]),window.getSelection().removeAllRanges()}else r(d);k=f,i&&b.cancel(i),i=b(function(){s({key:e.graphType,value:l},m),a.invokeSpinner(),o=!0,a.dataUpdate(),i=null},1e3)};var t=function(){c.data.forEach(function(){c.data.isSelected=!1,l=[],m=[]})},u=function(){var b=_.find(a.getCurrentFilters(),function(a){return a.key===e.graphType});b||t()};c.loadMore=function(a){c.spinnerGo=!0,a&&""!==a?!isNaN(a)&&c.threeColumn?g(!1,{code:a}):g(!1,{name:a}):g(!1,0)},a.registerUpdateToEventBucket("chartUpdate",{name:e.graphType,func:h}),a.registerSpinner({name:e.graphType,func:f}),a.registerUpdateToEventBucket("removeFilter",{name:e.graphType,func:u})}}}])}(),function(){"use strict";var a=function(a,b){function c(a){return a.forEach(function(a,b){var c=b;b>q.length-1&&(c=Math.floor(Math.random()*(r.length-1))+1),a.color=q[c]}),e(a)}function d(a){var b=_.sortBy(a,function(a){return a.frequency});return _(b).reverse().value()}function e(a){var b={},c=0,d=[];if(w=[],!_.isEmpty(a)&&a.length>=10){for(var e=9;e<a.length;e++)c+=a[e].frequency,d.push(a[e].name),w.push(a[e]);b.id=v,b.frequency=c,b.name="Other",b.names=d,b.color=_.last(q),a=a.splice(0,9),a.push(b)}return a}function f(a,b){!_.has(a.data)&&a.name&&(a.data={name:a.name});var c=m.graphType+"_tile_id",d=_.compact(d3.selectAll("#"+c+" .nv-series").select(function(b){return a.data.name===b.name?this:null})[0])[0],e=_.compact(d3.selectAll("#"+c+" .nv-pie").selectAll(".nv-slice").select(function(b){return b.data.name===a.data.name?this:null})[0])[0];_.contains(e.classList,"slice-selected")&&(b=!0),d3.select(d).select("text").classed("legend-highlight",b)}function g(a,b){if(a.name!==t){var c=172.79,d=167.66,e=b?Math.min(c,d)/2:79,f=m.graphType+"_tile_id",g=_.compact(d3.selectAll("#"+f+" .nv-pie").selectAll(".nv-slice").select(function(b){return b.data.name===a.name?this:null})[0])[0];d3.select(g).classed("hover",b);var h=d3.svg.arc().outerRadius(e);d3.select(g).select("path").transition().duration(70).attr("d",h)}}function h(){u=0,a.getSupplmentalData(m.graphType).then(function(a){if(s&&a.data.graphData.length<=m.data.length)return m.spinnerGo=!1,void(s=!1);if(s=!1,a.data.graphData){var e=d(a.data.graphData);b(function(){m.data=c(e),m.spinnerGo=!1},500)}else m.data=[{name:t,frequency:1}],m.spinnerGo=!1}).catch(function(){console.log("error")})}function i(){s=!1,n=[],o=[]}function j(){var b=_.find(a.getCurrentFilters(),function(a){return a.key===m.graphType});b||(n=[],o=[],m.api.refresh())}function k(){m.spinnerGo=!0}function l(a){if(null===a)return"";var b=function(a,b){return a},c=function(a,b){return a},d=d3.select(document.createElement("table")),e=d.selectAll("tbody").data([a]).enter().append("tbody"),f=e.selectAll("tr").data(function(a){return a.series}).enter().append("tr").classed("highlight",function(a){return a.highlight});if(f.append("td").classed("legend-color-guide",!0).append("div").style("background-color",function(a){return a.color}),f.append("td").classed("key",!0).classed("total",function(a){return!!a.total}).html(function(a,b){return c(a.key,b)}),f.append("td").classed("value",!0).html(function(a,c){return b(a.value,c,a)}),f.selectAll("td").each(function(a){if(a.highlight){var b=d3.scale.linear().domain([0,1]).range(["#fff",a.color]),c=.6;d3.select(this).style("border-bottom-color",b(c)).style("border-top-color",b(c))}}),a.data.names&&!_.isEmpty(a.data.names)){var g=e.selectAll("tr.extra-companies").data(function(a){return a.data.names}).enter().append("tr").classed("extra-companies",!0);g.append("td").classed("key",!0).html(""),g.append("td").classed("key",!0).html(function(a){return a})}return d.node().outerHTML}var m=this,n=[],o=[],p="#add3f2",q=["#039","#faa41a","#b51d00","#393","#f60","#1469be","#039","#fbaf36","#7b47a3","#b51d00"],r=angular.copy(q),s=!1,t="No Companies in Set",u=-1,v=0,w=[];m.api={},m.data=[],m.isInitializing=!0,m.spinnerGo=!0,this.$onInit=function(){b(function(){a.getSupplmentalData(m.graphType).then(function(a){var b=d(a.data.graphData);m.data=c(b),m.isInitializing=!1,m.spinnerGo=!1})},500),a.registerFilterUnlock({name:m.graphType,func:i}),a.registerUpdateToEventBucket("chartUpdate",{name:m.graphType,func:h}),a.registerSpinner({name:m.graphType,func:k}),a.registerUpdateToEventBucket("removeFilter",{name:m.graphType,func:j})},m.options={chart:{type:"pieChart",id:123,height:330,width:430,x:function(a){return a.name},y:function(a){return a.frequency},margin:{top:0,left:60,bottom:-5,right:-25},color:function(a,b){var c=_.find(n,function(b){return b.name===a.name});return c?p:a.color},showLegend:!0,showLabels:!1,duration:250,labelThreshold:.01,labelSunbeamLayout:!1,labelsOutside:!0,legendPosition:"right",legend:{margin:{top:0,right:100,bottom:0,left:0}},dispatch:{renderEnd:function(a){var b=m.graphType+"_tile_id",c=d3.selectAll("#"+b+" .nv-legend"),d=d3.selectAll("#"+b+" svg").node().getBoundingClientRect().height,e=c.node().getBoundingClientRect().height,f=(d-e)/2;c.attr("transform","translate(25,"+f+")"),c.select("g").attr("transform","translate(0,0)")}},callback:function(b){b&&(b.legend.dispatch.on("legendMouseover",function(a){f(a,!0),g(a,!0)}.bind(m)),b.legend.dispatch.on("legendMouseover.tooltip",function(a){a.series={key:a.name,value:a.frequency,color:a.color},a.data={name:a.name,frequency:a.frequency,color:a.color,names:a.names||[]},b.tooltip.data(a).hidden(!1)}.bind(b)),b.legend.dispatch.on("legendMouseout",function(a){f(a,!1),g(a,!1)}.bind(m)),b.legend.dispatch.on("legendMouseout.tooltip",function(a){b.tooltip.hidden(!0)}.bind(b)),b.pie.dispatch.on("elementMouseover",function(a){f(a,!0)}.bind(m)),b.pie.dispatch.on("elementMouseout",function(a){f(a,!1)}.bind(m)),b.tooltip.contentGenerator(function(a){return l(a)}),b.legend.dispatch.on("legendClick",function(b){var c,d;if(b.disabled=!0,b.name!==t&&!s){var e=angular.copy(n);s=!0;var g=m.graphType+"_tile_id",h=_.compact(d3.selectAll("#"+g+" .nv-pie").selectAll(".nv-slice").select(function(a){return a.data.name===b.name?this:null})[0])[0],i=_.find(n,function(a){return a.id===b.id});i?(e=n=n.filter(function(a){return a!==i}),o=o.filter(function(a){return a!==b.id}),d3.select(h).classed("slice-selected",!1),h.setAttribute("fill",b.color),0===i.id&&w.forEach(function(a){for(var b=0;b<o.length;b++)a.id===o[b]&&o.splice(b,1)}),c=_.find(n,function(a){return 0===a.id}),c&&(e=e.concat(w),e=e.filter(function(a){return a.id!==v}),d=w.map(function(a){return a.id}),o=o.concat(d))):(n.push(b),h.setAttribute("fill",p),d3.select(h).classed("slice-selected",!0),c=_.find(n,function(a){return 0===a.id}),(b.id===v||c)&&(e=e.concat(w),e=e.filter(function(a){return a.id!==v}),d=w.map(function(a){return a.id}),o=o.concat(d)),0!==b.id&&(o.push(b.id),e.push(b))),f(b,!1);var j={key:m.graphType,value:e},k={key:a.getSearchKey(m.graphType),value:o};a.setCurrentFilters(j),a.setSearchCriteria(k),a.invokeSpinner(),a.dataUpdate()}}.bind(m)),b.pie.dispatch.on("elementClick",function(b){var c,d;if(b.data.name!==t&&!s){var e=angular.copy(n);s=!0;var g=d3.select(b.element)[0][0],h=_.find(n,function(a){return a.id===b.data.id});h?(e=n=n.filter(function(a){return a!==h}),o=o.filter(function(a){return a!==b.data.id}),d3.select(g).classed("slice-selected",!1),g.setAttribute("fill",b.data.color),0===h.id&&w.forEach(function(a){for(var b=0;b<o.length;b++)a.id===o[b]&&o.splice(b,1)}),c=_.find(n,function(a){return 0===a.id}),c&&(e=e.concat(w),e=e.filter(function(a){return a.id!==v}),d=w.map(function(a){return a.id}),o=o.concat(d))):(n.push(b.data),g.setAttribute("fill",p),d3.select(g).classed("slice-selected",!0),c=_.find(n,function(a){return 0===a.id}),(b.data.id===v||c)&&(e=e.concat(w),e=e.filter(function(a){return a.id!==v}),d=w.map(function(a){return a.id}),o=o.concat(d)),0!==b.data.id&&(o.push(b.data.id),e.push(b.data))),f(b,!0);var i={key:m.graphType,value:e},j={key:a.getSearchKey(m.graphType),value:o};a.setCurrentFilters(i),a.setSearchCriteria(j),a.invokeSpinner(),a.dataUpdate()}}.bind(m)))}}}};a.$inject=["AbmService","$timeout"],angular.module("dorgEuiApp").directive("pieChart",[function(){return{templateUrl:"app/views/vad/directives/pieChart/pieChart.html",controller:a,controllerAs:"pcc",scope:{graphType:"@"},bindToController:!0}}])}(),function(){"use strict";angular.module("dorgEuiApp").directive("tiles",["AbmService","$compile","$uibModal",function(a,b,c){return{templateUrl:"app/views/vad/directives/tiles/tiles.html",scope:{graphType:"@",chartType:"@",chartName:"@"},link:function(d,e,f){function g(){if(f.graphType&&f.chartType){d.isAddState=!1;var a="";switch(f.$set("id",f.graphType+"_tile_id"),f.chartType){case"bar":a='<div class="graph-pos" vertical-bar-chart graph-type="'+f.graphType+'"></div>';break;case"pie":a='<div pie-chart graph-type="'+f.graphType+'" height="500"></div>';break;case"selectList":var c=!1;"sicCodes"!==f.graphType&&"naicsCodes"!==f.graphType||(c=!0),a="technologies"===f.graphType?'<div multi-select-list-chart graph-type="'+f.graphType+'" display-percent="false" three-column="'+c+'"></div>':'<div multi-select-list-chart graph-type="'+f.graphType+'" display-percent="true" three-column="'+c+'"></div>';break;case"list":a='<div list-data-set-selector graph-type="'+f.graphType+'"></div>'}""!==a&&e.append(b(a)(d))}}function h(b){d.title=b.name,f.graphType=b.data,f.chartType=b.listType,g(),a.deregisterUpdateFromEventBucket("tileUpdate",i)}var i="tileUpdate";d.isAddState=!0,d.title=f.chartName,d.addGraph=function(){a.registerUpdateToEventBucket("tileUpdate",{name:i,func:h}),c.open({templateUrl:"app/views/vad/partials/addChart.modal.html"})},d.removeTile=function(){d.$destroy();var b="";switch(f.graphType){case"technologies":b="technologyProductIds";break;case"primaryIndustry":b="industryIds";break;case"ownershipStructure":b="ownershipTypeIds";break;default:b=f.graphType}a.setSearchCriteria({key:b,value:""}),a.setCurrentFilters({key:f.graphType,value:""}),a.invokeEventBucketUpdate("removeFilter"),a.invokeEventBucketUpdate("updateFilterHeader"),a.removeChart(f.graphType),a.deregisterFilterUnlock(f.graphType),a.deregisterUpdateFromEventBucket("removeFilter",f.graphType),a.deregisterUpdateFromEventBucket("chartUpdate",f.graphType),a.deregisterSpinner(f.graphType),a.invokeSpinner(),a.getCurrentCharts().length===a.chartList.length-1&&a.invokeEventBucketUpdate("tileUpdate"),a.dataUpdate(),$(e.parent()).remove(),$(e).remove()},g()}}}])}(),function(){"use strict";angular.module("dorgEuiApp").directive("verticalBarChart",["AbmService","$timeout","$compile",function(a,b,c){return{templateUrl:"app/views/vad/directives/verticalBarChart/verticalBarChart.html",scope:{graphType:"@"},link:function(d,e,f){function g(a){var b=t.selectAll("#"+a.id);if(a.isSelected=!a.isSelected,a.isSelected)r.push({id:a.id,value:a.bracket,name:a.name});else{var c=r.map(function(a){return a.id}).indexOf(a.id);r.splice(c,1)}b.attr("fill",function(){return a.isSelected?q:p});var d=r.map(function(a){return{name:a.name,value:a.value}});i({key:f.graphType,value:d})}function h(b,c,e){for(var f=a.getRangeBands(e),g=[],h=!1,i=0;i<f.length;i++){r.filter(function(a){return a.id===e+i}).length>0&&(h=!0);var j={bracket:f[i].bracket,name:f[i].name,value:0,fill:h?q:p,id:e+i,isSelected:h};g.push(j)}for(var k=0;k<c.companyList.length;k++)for(var l=0;l<g.length;l++)if(null===g[l].bracket.high&&c.companyList[k][e]>=g[l].bracket.low)g[l].value++;else if(c.companyList[k][e]>=g[l].bracket.low&&c.companyList[k][e]<=parseInt(g[l].bracket.high)){g[l].value++;continue}return d.noData=c.companyList.length<=0,d.isInitializing=!1,d.spinnerGo=!1,g}function i(b){a.setCurrentFilters(b);var c=b.value.map(function(a){return a.value});a.setSearchCriteria({key:a.getSearchKey(b.key),value:c}),l=!0,a.invokeSpinner(),a.dataUpdate()}var j=a.currentDataSet.data,k=a.currentDataSet[f.graphType],l=!1,m={top:50,right:15,bottom:60,left:15},n=e.parent()[0].offsetWidth-m.bottom-m.top-10,o=e.parent()[0].offsetWidth-m.right-m.left,p="#393",q="#1b5eac",r=[],s="revenue";switch(d.spinnerGo=!0,d.isInitializing=!0,d.noData=!1,f.graphType){case"employeeRanges":s="numEmployees";break;case"revenueRanges":s="revenue";break;default:s="revenue"}var t=d3.select(e[0]).append("svg").attr("width",o+20+"px").attr("ng-hide","noData").attr("height",n+"px").append("g").attr("transform","translate(15)"),u=function(){if(d.spinnerGo=!0,b(function(){d.spinnerGo=!1},250),!(l&&r.length>0)){var c=a.currentDataSet.data,e=a.currentDataSet[f.graphType],i=h(e,c,s),j=(d3.scale.ordinal().domain(d3.range(i.length)).rangeRoundBands([0,o],.05),d3.scale.linear().domain([0,d3.max(i,function(a){return a.value})]).range([0,n-m.bottom]));t.selectAll("rect").data(i).transition().attr("y",function(a){return n-j(a.value)-m.bottom}).attr("height",function(a){return j(a.value)}).attr("class","bars").attr("fill",function(a){return a.fill}).attr("data-value",function(a){return a.bracket}),t.selectAll(".bars").on("click",function(a){g(a)}),t.selectAll(".xaxis text").data(i).text(function(a){return a.name})}},v=function(){l=!1,r=[]},w=function(){d.spinnerGo=!0},x=function(){var b=_.find(a.getCurrentFilters(),function(a){return a.key===f.graphType});b||v()},y=h(k,j,s),z=d3.scale.ordinal().domain(d3.range(y.length)).rangeRoundBands([0,o],.05),A=d3.scale.linear().domain([0,d3.max(y,function(a){return a.value})]).range([0,n-m.bottom]),B=d3.svg.axis().orient("bottom").scale(z).tickFormat(d3.format(",.0f"));t.selectAll("rect").data(y).enter().append("rect").attr("x",function(a,b){return z(b)}).attr("y",function(a){return n-A(a.value)-m.bottom}).attr("width",z.rangeBand()).attr("height",function(a){return A(a.value)}).attr("fill",function(a){return a.fill}).attr("class","bars").attr("id",function(a){return a.id}).attr("data-value",function(a){return a.bracket}),t.selectAll(".bars").on("click",function(a){g(a)}),t.append("g").attr("class","xaxis axis").attr("transform","translate(0,"+(n-m.bottom)+")").call(B),t.selectAll(".xaxis text").data(y).text(function(a){return a.name}),t.selectAll(".xaxis text").attr("transform",function(){return"translate("+this.getBBox().height*-1+",20)rotate(-35)"}),t.selectAll(".resize").append("rect").attr("class","range").attr("height",20).attr("width",60).attr("transform","translate(-45, 0)").attr("rx",5).attr("ry",5),t.selectAll(".resize").append("text").attr("class","range_text").attr("transform","translate(-15,14)"),a.registerUpdateToEventBucket("chartUpdate",{name:f.graphType,func:u}),a.registerFilterUnlock({name:f.graphType,func:v}),a.registerSpinner({name:f.graphType,func:w}),a.deregisterUpdateFromEventBucket("removeFilter",f.graphType),a.registerUpdateToEventBucket("removeFilter",{name:f.graphType,func:x}),c(e.contents())(d)}}}])}();