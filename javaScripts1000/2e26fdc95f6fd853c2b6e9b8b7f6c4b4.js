!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=222)}([function(module,exports,__webpack_require__){"use strict";var valuesById,values,$protobuf=__webpack_require__(121),$Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots.default||($protobuf.roots.default={});$root.ProtoAdBreak=function(){function ProtoAdBreak(properties){if(this.types=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoAdBreak.prototype.types=$util.emptyArray,ProtoAdBreak.prototype.maxAdPodDuration=0,ProtoAdBreak.prototype.maxAdSlotDuration=180,ProtoAdBreak.prototype.numberOfAdSlots=1,ProtoAdBreak.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoAdBreak;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:if(message.types&&message.types.length||(message.types=[]),2==(7&tag))for(var end2=reader.uint32()+reader.pos;reader.pos<end2;)message.types.push(reader.int32());else message.types.push(reader.int32());break;case 2:message.maxAdPodDuration=reader.int32();break;case 3:message.maxAdSlotDuration=reader.int32();break;case 4:message.numberOfAdSlots=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoAdBreak.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.types=[]),options.defaults&&(object.maxAdPodDuration=0,object.maxAdSlotDuration=180,object.numberOfAdSlots=1),message.types&&message.types.length){object.types=[];for(var j=0;j<message.types.length;++j)object.types[j]=options.enums===String?$root.ProtoAdBreakTypeEnum[message.types[j]]:message.types[j]}return null!=message.maxAdPodDuration&&message.hasOwnProperty("maxAdPodDuration")&&(object.maxAdPodDuration=message.maxAdPodDuration),null!=message.maxAdSlotDuration&&message.hasOwnProperty("maxAdSlotDuration")&&(object.maxAdSlotDuration=message.maxAdSlotDuration),null!=message.numberOfAdSlots&&message.hasOwnProperty("numberOfAdSlots")&&(object.numberOfAdSlots=message.numberOfAdSlots),object},ProtoAdBreak}(),$root.ProtoAdDomainBlockingResponse=function(){function ProtoAdDomainBlockingResponse(properties){if(this.domains=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoAdDomainBlockingResponse.prototype.domains=$util.emptyArray,ProtoAdDomainBlockingResponse.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoAdDomainBlockingResponse;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.domains&&message.domains.length||(message.domains=[]),message.domains.push(reader.string());break;default:reader.skipType(7&tag)}}return message},ProtoAdDomainBlockingResponse.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.domains=[]),message.domains&&message.domains.length){object.domains=[];for(var j=0;j<message.domains.length;++j)object.domains[j]=message.domains[j]}return object},ProtoAdDomainBlockingResponse}(),$root.ProtoCoreTamBidRequest=function(){function ProtoCoreTamBidRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoCoreTamBidRequest.prototype.lineItemId="",ProtoCoreTamBidRequest.prototype.code="",ProtoCoreTamBidRequest.prototype.metadata=null,ProtoCoreTamBidRequest.prototype.exploration=!1,ProtoCoreTamBidRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.lineItemId&&Object.hasOwnProperty.call(message,"lineItemId")&&writer.uint32(10).string(message.lineItemId),null!=message.code&&Object.hasOwnProperty.call(message,"code")&&writer.uint32(18).string(message.code),null!=message.metadata&&Object.hasOwnProperty.call(message,"metadata")&&$root.MetadataModel.encode(message.metadata,writer.uint32(26).fork()).ldelim(),null!=message.exploration&&Object.hasOwnProperty.call(message,"exploration")&&writer.uint32(32).bool(message.exploration),writer},ProtoCoreTamBidRequest.fromObject=function(object){if(object instanceof $root.ProtoCoreTamBidRequest)return object;var message=new $root.ProtoCoreTamBidRequest;if(null!=object.lineItemId&&(message.lineItemId=String(object.lineItemId)),null!=object.code&&(message.code=String(object.code)),null!=object.metadata){if("object"!=typeof object.metadata)throw TypeError(".ProtoCoreTamBidRequest.metadata: object expected");message.metadata=$root.MetadataModel.fromObject(object.metadata)}return null!=object.exploration&&(message.exploration=Boolean(object.exploration)),message},ProtoCoreTamBidRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoCoreTamBidRequest}(),$root.MetadataModel=function(){function MetadataModel(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return MetadataModel.prototype.version=0,MetadataModel.prototype.sessionId="",MetadataModel.prototype.playerId="",MetadataModel.prototype.userId="",MetadataModel.prototype.browser=null,MetadataModel.prototype.geo=null,MetadataModel.prototype.clientAb0=0,MetadataModel.prototype.clientAb1=0,MetadataModel.prototype.serverAb0=0,MetadataModel.prototype.serverAb1=0,MetadataModel.prototype.pageUrl="",MetadataModel.prototype.bundleId="",MetadataModel.prototype.implementationType=0,MetadataModel.prototype.trackAllRequests=!1,MetadataModel.prototype.customParam1="",MetadataModel.prototype.customParam2="",MetadataModel.prototype.customParam3="",MetadataModel.prototype.abTestId="",MetadataModel.prototype.pageInFocus=!1,MetadataModel.prototype.customParam4="",MetadataModel.prototype.customParam5="",MetadataModel.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.version&&Object.hasOwnProperty.call(message,"version")&&writer.uint32(8).int32(message.version),null!=message.sessionId&&Object.hasOwnProperty.call(message,"sessionId")&&writer.uint32(18).string(message.sessionId),null!=message.playerId&&Object.hasOwnProperty.call(message,"playerId")&&writer.uint32(26).string(message.playerId),null!=message.userId&&Object.hasOwnProperty.call(message,"userId")&&writer.uint32(34).string(message.userId),null!=message.browser&&Object.hasOwnProperty.call(message,"browser")&&$root.Browser.encode(message.browser,writer.uint32(42).fork()).ldelim(),null!=message.geo&&Object.hasOwnProperty.call(message,"geo")&&$root.GeoLocation.encode(message.geo,writer.uint32(50).fork()).ldelim(),null!=message.clientAb0&&Object.hasOwnProperty.call(message,"clientAb0")&&writer.uint32(56).int32(message.clientAb0),null!=message.clientAb1&&Object.hasOwnProperty.call(message,"clientAb1")&&writer.uint32(64).int32(message.clientAb1),null!=message.serverAb0&&Object.hasOwnProperty.call(message,"serverAb0")&&writer.uint32(72).int32(message.serverAb0),null!=message.serverAb1&&Object.hasOwnProperty.call(message,"serverAb1")&&writer.uint32(80).int32(message.serverAb1),null!=message.pageUrl&&Object.hasOwnProperty.call(message,"pageUrl")&&writer.uint32(122).string(message.pageUrl),null!=message.bundleId&&Object.hasOwnProperty.call(message,"bundleId")&&writer.uint32(138).string(message.bundleId),null!=message.implementationType&&Object.hasOwnProperty.call(message,"implementationType")&&writer.uint32(144).int32(message.implementationType),null!=message.trackAllRequests&&Object.hasOwnProperty.call(message,"trackAllRequests")&&writer.uint32(152).bool(message.trackAllRequests),null!=message.customParam1&&Object.hasOwnProperty.call(message,"customParam1")&&writer.uint32(162).string(message.customParam1),null!=message.customParam2&&Object.hasOwnProperty.call(message,"customParam2")&&writer.uint32(170).string(message.customParam2),null!=message.customParam3&&Object.hasOwnProperty.call(message,"customParam3")&&writer.uint32(178).string(message.customParam3),null!=message.abTestId&&Object.hasOwnProperty.call(message,"abTestId")&&writer.uint32(194).string(message.abTestId),null!=message.pageInFocus&&Object.hasOwnProperty.call(message,"pageInFocus")&&writer.uint32(200).bool(message.pageInFocus),null!=message.customParam4&&Object.hasOwnProperty.call(message,"customParam4")&&writer.uint32(210).string(message.customParam4),null!=message.customParam5&&Object.hasOwnProperty.call(message,"customParam5")&&writer.uint32(218).string(message.customParam5),writer},MetadataModel.fromObject=function(object){if(object instanceof $root.MetadataModel)return object;var message=new $root.MetadataModel;if(null!=object.version&&(message.version=0|object.version),null!=object.sessionId&&(message.sessionId=String(object.sessionId)),null!=object.playerId&&(message.playerId=String(object.playerId)),null!=object.userId&&(message.userId=String(object.userId)),null!=object.browser){if("object"!=typeof object.browser)throw TypeError(".MetadataModel.browser: object expected");message.browser=$root.Browser.fromObject(object.browser)}if(null!=object.geo){if("object"!=typeof object.geo)throw TypeError(".MetadataModel.geo: object expected");message.geo=$root.GeoLocation.fromObject(object.geo)}switch(null!=object.clientAb0&&(message.clientAb0=0|object.clientAb0),null!=object.clientAb1&&(message.clientAb1=0|object.clientAb1),null!=object.serverAb0&&(message.serverAb0=0|object.serverAb0),null!=object.serverAb1&&(message.serverAb1=0|object.serverAb1),null!=object.pageUrl&&(message.pageUrl=String(object.pageUrl)),null!=object.bundleId&&(message.bundleId=String(object.bundleId)),object.implementationType){case"Web":case 0:message.implementationType=0;break;case"Amp":case 1:message.implementationType=1}return null!=object.trackAllRequests&&(message.trackAllRequests=Boolean(object.trackAllRequests)),null!=object.customParam1&&(message.customParam1=String(object.customParam1)),null!=object.customParam2&&(message.customParam2=String(object.customParam2)),null!=object.customParam3&&(message.customParam3=String(object.customParam3)),null!=object.abTestId&&(message.abTestId=String(object.abTestId)),null!=object.pageInFocus&&(message.pageInFocus=Boolean(object.pageInFocus)),null!=object.customParam4&&(message.customParam4=String(object.customParam4)),null!=object.customParam5&&(message.customParam5=String(object.customParam5)),message},MetadataModel.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},MetadataModel}(),$root.Browser=function(){function Browser(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return Browser.prototype.browserVersion="",Browser.prototype.browserType="",Browser.prototype.osCode="",Browser.prototype.device=0,Browser.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.browserVersion&&Object.hasOwnProperty.call(message,"browserVersion")&&writer.uint32(10).string(message.browserVersion),null!=message.browserType&&Object.hasOwnProperty.call(message,"browserType")&&writer.uint32(18).string(message.browserType),null!=message.osCode&&Object.hasOwnProperty.call(message,"osCode")&&writer.uint32(26).string(message.osCode),null!=message.device&&Object.hasOwnProperty.call(message,"device")&&writer.uint32(32).int32(message.device),writer},Browser.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.Browser;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.browserVersion=reader.string();break;case 2:message.browserType=reader.string();break;case 3:message.osCode=reader.string();break;case 4:message.device=reader.int32();break;default:reader.skipType(7&tag)}}return message},Browser.fromObject=function(object){if(object instanceof $root.Browser)return object;var message=new $root.Browser;switch(null!=object.browserVersion&&(message.browserVersion=String(object.browserVersion)),null!=object.browserType&&(message.browserType=String(object.browserType)),null!=object.osCode&&(message.osCode=String(object.osCode)),object.device){case"Desktop":case 0:message.device=0;break;case"Smartphone":case 1:message.device=1;break;case"Tablet":case 2:message.device=2;break;case"GameConsole":case 3:message.device=3;break;case"SmartTV":case 4:message.device=4;break;case"WearableComputer":case 5:message.device=5;break;case"PDA":case 6:message.device=6;break;case"Unrecognized":case 7:message.device=7}return message},Browser.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.browserVersion="",object.browserType="",object.osCode="",object.device=options.enums===String?"Desktop":0),null!=message.browserVersion&&message.hasOwnProperty("browserVersion")&&(object.browserVersion=message.browserVersion),null!=message.browserType&&message.hasOwnProperty("browserType")&&(object.browserType=message.browserType),null!=message.osCode&&message.hasOwnProperty("osCode")&&(object.osCode=message.osCode),null!=message.device&&message.hasOwnProperty("device")&&(object.device=options.enums===String?$root.ProtoDeviceType[message.device]:message.device),object},Browser.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},Browser}(),$root.GeoLocation=function(){function GeoLocation(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return GeoLocation.prototype.countryGeoId=0,GeoLocation.prototype.cityId=0,GeoLocation.prototype.subdivisionId=0,GeoLocation.prototype.dmaId=0,GeoLocation.prototype.ip="",GeoLocation.prototype.lat=0,GeoLocation.prototype.lon=0,GeoLocation.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.countryGeoId&&Object.hasOwnProperty.call(message,"countryGeoId")&&writer.uint32(8).int32(message.countryGeoId),null!=message.cityId&&Object.hasOwnProperty.call(message,"cityId")&&writer.uint32(16).int32(message.cityId),null!=message.subdivisionId&&Object.hasOwnProperty.call(message,"subdivisionId")&&writer.uint32(24).int32(message.subdivisionId),null!=message.dmaId&&Object.hasOwnProperty.call(message,"dmaId")&&writer.uint32(32).int32(message.dmaId),null!=message.ip&&Object.hasOwnProperty.call(message,"ip")&&writer.uint32(42).string(message.ip),null!=message.lat&&Object.hasOwnProperty.call(message,"lat")&&writer.uint32(49).double(message.lat),null!=message.lon&&Object.hasOwnProperty.call(message,"lon")&&writer.uint32(57).double(message.lon),writer},GeoLocation.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.GeoLocation;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.countryGeoId=reader.int32();break;case 2:message.cityId=reader.int32();break;case 3:message.subdivisionId=reader.int32();break;case 4:message.dmaId=reader.int32();break;case 5:message.ip=reader.string();break;case 6:message.lat=reader.double();break;case 7:message.lon=reader.double();break;default:reader.skipType(7&tag)}}return message},GeoLocation.fromObject=function(object){if(object instanceof $root.GeoLocation)return object;var message=new $root.GeoLocation;return null!=object.countryGeoId&&(message.countryGeoId=0|object.countryGeoId),null!=object.cityId&&(message.cityId=0|object.cityId),null!=object.subdivisionId&&(message.subdivisionId=0|object.subdivisionId),null!=object.dmaId&&(message.dmaId=0|object.dmaId),null!=object.ip&&(message.ip=String(object.ip)),null!=object.lat&&(message.lat=Number(object.lat)),null!=object.lon&&(message.lon=Number(object.lon)),message},GeoLocation.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.countryGeoId=0,object.cityId=0,object.subdivisionId=0,object.dmaId=0,object.ip="",object.lat=0,object.lon=0),null!=message.countryGeoId&&message.hasOwnProperty("countryGeoId")&&(object.countryGeoId=message.countryGeoId),null!=message.cityId&&message.hasOwnProperty("cityId")&&(object.cityId=message.cityId),null!=message.subdivisionId&&message.hasOwnProperty("subdivisionId")&&(object.subdivisionId=message.subdivisionId),null!=message.dmaId&&message.hasOwnProperty("dmaId")&&(object.dmaId=message.dmaId),null!=message.ip&&message.hasOwnProperty("ip")&&(object.ip=message.ip),null!=message.lat&&message.hasOwnProperty("lat")&&(object.lat=options.json&&!isFinite(message.lat)?String(message.lat):message.lat),null!=message.lon&&message.hasOwnProperty("lon")&&(object.lon=options.json&&!isFinite(message.lon)?String(message.lon):message.lon),object},GeoLocation.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},GeoLocation}(),$root.ProtoCoreTamBidResponse=function(){function ProtoCoreTamBidResponse(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoCoreTamBidResponse.prototype.errorMessage="",ProtoCoreTamBidResponse.prototype.encryptedBidPrice="",ProtoCoreTamBidResponse.prototype.ofskp=0,ProtoCoreTamBidResponse.prototype.impressionTimeSpent=0,ProtoCoreTamBidResponse.prototype.bidRate=0,ProtoCoreTamBidResponse.prototype.successRate=0,ProtoCoreTamBidResponse.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoCoreTamBidResponse;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.errorMessage=reader.string();break;case 10:message.encryptedBidPrice=reader.string();break;case 12:message.ofskp=reader.double();break;case 13:message.impressionTimeSpent=reader.int32();break;case 14:message.bidRate=reader.double();break;case 15:message.successRate=reader.double();break;default:reader.skipType(7&tag)}}return message},ProtoCoreTamBidResponse.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.errorMessage="",object.encryptedBidPrice="",object.ofskp=0,object.impressionTimeSpent=0,object.bidRate=0,object.successRate=0),null!=message.errorMessage&&message.hasOwnProperty("errorMessage")&&(object.errorMessage=message.errorMessage),null!=message.encryptedBidPrice&&message.hasOwnProperty("encryptedBidPrice")&&(object.encryptedBidPrice=message.encryptedBidPrice),null!=message.ofskp&&message.hasOwnProperty("ofskp")&&(object.ofskp=options.json&&!isFinite(message.ofskp)?String(message.ofskp):message.ofskp),null!=message.impressionTimeSpent&&message.hasOwnProperty("impressionTimeSpent")&&(object.impressionTimeSpent=message.impressionTimeSpent),null!=message.bidRate&&message.hasOwnProperty("bidRate")&&(object.bidRate=options.json&&!isFinite(message.bidRate)?String(message.bidRate):message.bidRate),null!=message.successRate&&message.hasOwnProperty("successRate")&&(object.successRate=options.json&&!isFinite(message.successRate)?String(message.successRate):message.successRate),object},ProtoCoreTamBidResponse}(),$root.ProtoCookieSettings=function(){function ProtoCookieSettings(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoCookieSettings.prototype.name="",ProtoCookieSettings.prototype.value="",ProtoCookieSettings.prototype.timestamp=$util.Long?$util.Long.fromBits(0,0,!1):0,ProtoCookieSettings.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.name&&Object.hasOwnProperty.call(message,"name")&&writer.uint32(10).string(message.name),null!=message.value&&Object.hasOwnProperty.call(message,"value")&&writer.uint32(18).string(message.value),null!=message.timestamp&&Object.hasOwnProperty.call(message,"timestamp")&&writer.uint32(24).int64(message.timestamp),writer},ProtoCookieSettings.fromObject=function(object){if(object instanceof $root.ProtoCookieSettings)return object;var message=new $root.ProtoCookieSettings;return null!=object.name&&(message.name=String(object.name)),null!=object.value&&(message.value=String(object.value)),null!=object.timestamp&&($util.Long?(message.timestamp=$util.Long.fromValue(object.timestamp)).unsigned=!1:"string"==typeof object.timestamp?message.timestamp=parseInt(object.timestamp,10):"number"==typeof object.timestamp?message.timestamp=object.timestamp:"object"==typeof object.timestamp&&(message.timestamp=new $util.LongBits(object.timestamp.low>>>0,object.timestamp.high>>>0).toNumber())),message},ProtoCookieSettings.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoCookieSettings}(),$root.ProtoCookieSyncRequest=function(){function ProtoCookieSyncRequest(properties){if(this.cookieList=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoCookieSyncRequest.prototype.cookieList=$util.emptyArray,ProtoCookieSyncRequest.prototype.secureMode=0,ProtoCookieSyncRequest.prototype.browserInfo=null,ProtoCookieSyncRequest.encode=function(message,writer){if(writer||(writer=$Writer.create()),null!=message.cookieList&&message.cookieList.length)for(var i=0;i<message.cookieList.length;++i)$root.ProtoCookieSettings.encode(message.cookieList[i],writer.uint32(10).fork()).ldelim();return null!=message.secureMode&&Object.hasOwnProperty.call(message,"secureMode")&&writer.uint32(16).int32(message.secureMode),null!=message.browserInfo&&Object.hasOwnProperty.call(message,"browserInfo")&&$root.Browser.encode(message.browserInfo,writer.uint32(26).fork()).ldelim(),writer},ProtoCookieSyncRequest.fromObject=function(object){if(object instanceof $root.ProtoCookieSyncRequest)return object;var message=new $root.ProtoCookieSyncRequest;if(object.cookieList){if(!Array.isArray(object.cookieList))throw TypeError(".ProtoCookieSyncRequest.cookieList: array expected");message.cookieList=[];for(var i=0;i<object.cookieList.length;++i){if("object"!=typeof object.cookieList[i])throw TypeError(".ProtoCookieSyncRequest.cookieList: object expected");message.cookieList[i]=$root.ProtoCookieSettings.fromObject(object.cookieList[i])}}switch(object.secureMode){case"Secure":case 0:message.secureMode=0;break;case"Unsecure":case 1:message.secureMode=1;break;case"Auto":case 2:message.secureMode=2}if(null!=object.browserInfo){if("object"!=typeof object.browserInfo)throw TypeError(".ProtoCookieSyncRequest.browserInfo: object expected");message.browserInfo=$root.Browser.fromObject(object.browserInfo)}return message},ProtoCookieSyncRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoCookieSyncRequest}(),$root.ProtoUserInformation=function(){function ProtoUserInformation(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoUserInformation.prototype.userId="",ProtoUserInformation.prototype.lookupId="",ProtoUserInformation.prototype.lookupResponseCode=0,ProtoUserInformation.prototype.callFraudSensor=!1,ProtoUserInformation.prototype.publisherAdsTxt="",ProtoUserInformation.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoUserInformation;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.userId=reader.string();break;case 3:message.lookupId=reader.string();break;case 4:message.lookupResponseCode=reader.int32();break;case 5:message.callFraudSensor=reader.bool();break;case 6:message.publisherAdsTxt=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoUserInformation.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.userId="",object.lookupId="",object.lookupResponseCode=0,object.callFraudSensor=!1,object.publisherAdsTxt=""),null!=message.userId&&message.hasOwnProperty("userId")&&(object.userId=message.userId),null!=message.lookupId&&message.hasOwnProperty("lookupId")&&(object.lookupId=message.lookupId),null!=message.lookupResponseCode&&message.hasOwnProperty("lookupResponseCode")&&(object.lookupResponseCode=message.lookupResponseCode),null!=message.callFraudSensor&&message.hasOwnProperty("callFraudSensor")&&(object.callFraudSensor=message.callFraudSensor),null!=message.publisherAdsTxt&&message.hasOwnProperty("publisherAdsTxt")&&(object.publisherAdsTxt=message.publisherAdsTxt),object},ProtoUserInformation}(),$root.CreativeTrackerViewModel=function(){function CreativeTrackerViewModel(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return CreativeTrackerViewModel.prototype.type=0,CreativeTrackerViewModel.prototype.trigger=0,CreativeTrackerViewModel.prototype.url="",CreativeTrackerViewModel.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.CreativeTrackerViewModel;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.type=reader.int32();break;case 2:message.trigger=reader.int32();break;case 3:message.url=reader.string();break;default:reader.skipType(7&tag)}}return message},CreativeTrackerViewModel.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.type=options.enums===String?"Image":0,object.trigger=options.enums===String?"Impression":0,object.url=""),null!=message.type&&message.hasOwnProperty("type")&&(object.type=options.enums===String?$root.ProtoTrackerType[message.type]:message.type),null!=message.trigger&&message.hasOwnProperty("trigger")&&(object.trigger=options.enums===String?$root.ProtoTrackerTriggerType[message.trigger]:message.trigger),null!=message.url&&message.hasOwnProperty("url")&&(object.url=message.url),object},CreativeTrackerViewModel}(),$root.ProtoLineItemAdBreakTargeting=function(){function ProtoLineItemAdBreakTargeting(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLineItemAdBreakTargeting.prototype.adRollType=0,ProtoLineItemAdBreakTargeting.prototype.adBreakTypeEnum=1,ProtoLineItemAdBreakTargeting.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoLineItemAdBreakTargeting;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.adRollType=reader.int32();break;case 2:message.adBreakTypeEnum=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoLineItemAdBreakTargeting.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.adRollType=options.enums===String?"None":0,object.adBreakTypeEnum=options.enums===String?"All":1),null!=message.adRollType&&message.hasOwnProperty("adRollType")&&(object.adRollType=options.enums===String?$root.ProtoAdBreakTypeEnum[message.adRollType]:message.adRollType),null!=message.adBreakTypeEnum&&message.hasOwnProperty("adBreakTypeEnum")&&(object.adBreakTypeEnum=options.enums===String?$root.ProtoLineItemAdBreakTypeEnum[message.adBreakTypeEnum]:message.adBreakTypeEnum),object},ProtoLineItemAdBreakTargeting}(),$root.ProtoLineItemAdPodTargeting=function(){function ProtoLineItemAdPodTargeting(properties){if(this.adSlotPositions=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLineItemAdPodTargeting.prototype.targetingType=0,ProtoLineItemAdPodTargeting.prototype.adSlotTargetingType=1,ProtoLineItemAdPodTargeting.prototype.adSlotPositions=$util.emptyArray,ProtoLineItemAdPodTargeting.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoLineItemAdPodTargeting;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.targetingType=reader.int32();break;case 2:message.adSlotTargetingType=reader.int32();break;case 3:if(message.adSlotPositions&&message.adSlotPositions.length||(message.adSlotPositions=[]),2==(7&tag))for(var end2=reader.uint32()+reader.pos;reader.pos<end2;)message.adSlotPositions.push(reader.int32());else message.adSlotPositions.push(reader.int32());break;default:reader.skipType(7&tag)}}return message},ProtoLineItemAdPodTargeting.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.adSlotPositions=[]),options.defaults&&(object.targetingType=options.enums===String?"Only":0,object.adSlotTargetingType=options.enums===String?"SpecificSlots":1),null!=message.targetingType&&message.hasOwnProperty("targetingType")&&(object.targetingType=options.enums===String?$root.ProtoLineItemTargetingTypeEnum[message.targetingType]:message.targetingType),null!=message.adSlotTargetingType&&message.hasOwnProperty("adSlotTargetingType")&&(object.adSlotTargetingType=options.enums===String?$root.ProtoLineItemAdSlotTargetingTypeEnum[message.adSlotTargetingType]:message.adSlotTargetingType),message.adSlotPositions&&message.adSlotPositions.length){object.adSlotPositions=[];for(var j=0;j<message.adSlotPositions.length;++j)object.adSlotPositions[j]=message.adSlotPositions[j]}return object},ProtoLineItemAdPodTargeting}(),$root.ProtoLineItemAdBreakSettings=function(){function ProtoLineItemAdBreakSettings(properties){if(this.adBreakTargeting=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLineItemAdBreakSettings.prototype.adBreakTargeting=$util.emptyArray,ProtoLineItemAdBreakSettings.prototype.adPodTargeting=null,ProtoLineItemAdBreakSettings.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoLineItemAdBreakSettings;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.adBreakTargeting&&message.adBreakTargeting.length||(message.adBreakTargeting=[]),message.adBreakTargeting.push($root.ProtoLineItemAdBreakTargeting.decode(reader,reader.uint32()));break;case 2:message.adPodTargeting=$root.ProtoLineItemAdPodTargeting.decode(reader,reader.uint32());break;default:reader.skipType(7&tag)}}return message},ProtoLineItemAdBreakSettings.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.adBreakTargeting=[]),options.defaults&&(object.adPodTargeting=null),message.adBreakTargeting&&message.adBreakTargeting.length){object.adBreakTargeting=[];for(var j=0;j<message.adBreakTargeting.length;++j)object.adBreakTargeting[j]=$root.ProtoLineItemAdBreakTargeting.toObject(message.adBreakTargeting[j],options)}return null!=message.adPodTargeting&&message.hasOwnProperty("adPodTargeting")&&(object.adPodTargeting=$root.ProtoLineItemAdPodTargeting.toObject(message.adPodTargeting,options)),object},ProtoLineItemAdBreakSettings}(),$root.ProtoLineItem=function(){function ProtoLineItem(properties){if(this.trackers=[],this.renditions=[],this.floorPrices=[],this.advertiserContextualTargeting=[],this.publisherContextualTargeting=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLineItem.prototype.publisherLineItemId="",ProtoLineItem.prototype.advertiserLineItemId="",ProtoLineItem.prototype.adTag="",ProtoLineItem.prototype.creativeType=0,ProtoLineItem.prototype.sound=!1,ProtoLineItem.prototype.viewability=!1,ProtoLineItem.prototype.impressionTimeSpent=0,ProtoLineItem.prototype.vendorId="",ProtoLineItem.prototype.trackers=$util.emptyArray,ProtoLineItem.prototype.duration=0,ProtoLineItem.prototype.renditions=$util.emptyArray,ProtoLineItem.prototype.mediaCreativeId="",ProtoLineItem.prototype.ignoreFilledRequests=!1,ProtoLineItem.prototype.requestCap=3,ProtoLineItem.prototype.impressionCap=0,ProtoLineItem.prototype.successRate=0,ProtoLineItem.prototype.lineItemPriority=0,ProtoLineItem.prototype.headerBidderBids="",ProtoLineItem.prototype.headerBidderTimeout=0,ProtoLineItem.prototype.mediaCreativeClickUrl="",ProtoLineItem.prototype.resetRequestsCapTime=60,ProtoLineItem.prototype.resetImpressionsCapTime=60,ProtoLineItem.prototype.resetCapType=0,ProtoLineItem.prototype.creativeHlsFileName="",ProtoLineItem.prototype.timeBetweenRequests=0,ProtoLineItem.prototype.skipMode=0,ProtoLineItem.prototype.mediaIdTargeting=null,ProtoLineItem.prototype.mediaKeywordsTargeting=null,ProtoLineItem.prototype.mediaLanguageTargeting=null,ProtoLineItem.prototype.adType=0,ProtoLineItem.prototype.overlayTime=30,ProtoLineItem.prototype.floorPrice=0,ProtoLineItem.prototype.adBreakSettings=null,ProtoLineItem.prototype.floorPrices=$util.emptyArray,ProtoLineItem.prototype.bidRate=0,ProtoLineItem.prototype.pauseAdOutOfView=0,ProtoLineItem.prototype.moatTrackingEnabled=!1,ProtoLineItem.prototype.cnxCreativeId="",ProtoLineItem.prototype.blockedDomainsRevisionNumber=0,ProtoLineItem.prototype.advertiserContextualTargeting=$util.emptyArray,ProtoLineItem.prototype.publisherContextualTargeting=$util.emptyArray,ProtoLineItem.prototype.amazonDealId="",ProtoLineItem.prototype.playerSizeTargetings=null,ProtoLineItem.prototype.playerSize="",ProtoLineItem.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoLineItem;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.publisherLineItemId=reader.string();break;case 2:message.advertiserLineItemId=reader.string();break;case 3:message.adTag=reader.string();break;case 4:message.creativeType=reader.int32();break;case 6:message.sound=reader.bool();break;case 7:message.viewability=reader.bool();break;case 9:message.impressionTimeSpent=reader.int32();break;case 10:message.vendorId=reader.string();break;case 12:message.trackers&&message.trackers.length||(message.trackers=[]),message.trackers.push($root.CreativeTrackerViewModel.decode(reader,reader.uint32()));break;case 13:message.duration=reader.int32();break;case 14:message.renditions&&message.renditions.length||(message.renditions=[]),message.renditions.push($root.ProtoRendition.decode(reader,reader.uint32()));break;case 15:message.mediaCreativeId=reader.string();break;case 16:message.ignoreFilledRequests=reader.bool();break;case 17:message.requestCap=reader.int32();break;case 18:message.impressionCap=reader.int32();break;case 19:message.successRate=reader.double();break;case 20:message.lineItemPriority=reader.int32();break;case 21:message.headerBidderBids=reader.string();break;case 22:message.headerBidderTimeout=reader.int32();break;case 23:message.mediaCreativeClickUrl=reader.string();break;case 24:message.resetRequestsCapTime=reader.int32();break;case 25:message.resetImpressionsCapTime=reader.int32();break;case 26:message.resetCapType=reader.int32();break;case 27:message.creativeHlsFileName=reader.string();break;case 28:message.timeBetweenRequests=reader.int32();break;case 29:message.skipMode=reader.int32();break;case 30:message.mediaIdTargeting=$root.ProtoTargetingChoiceModel.decode(reader,reader.uint32());break;case 31:message.mediaKeywordsTargeting=$root.ProtoTargetingChoiceModel.decode(reader,reader.uint32());break;case 32:message.mediaLanguageTargeting=$root.ProtoTargetingChoiceModel.decode(reader,reader.uint32());break;case 33:message.adType=reader.int32();break;case 34:message.overlayTime=reader.int32();break;case 35:message.floorPrice=reader.double();break;case 36:message.adBreakSettings=$root.ProtoLineItemAdBreakSettings.decode(reader,reader.uint32());break;case 38:if(message.floorPrices&&message.floorPrices.length||(message.floorPrices=[]),2==(7&tag))for(var end2=reader.uint32()+reader.pos;reader.pos<end2;)message.floorPrices.push(reader.double());else message.floorPrices.push(reader.double());break;case 39:message.bidRate=reader.double();break;case 40:message.pauseAdOutOfView=reader.int32();break;case 41:message.moatTrackingEnabled=reader.bool();break;case 42:message.cnxCreativeId=reader.string();break;case 44:message.blockedDomainsRevisionNumber=reader.int32();break;case 45:message.advertiserContextualTargeting&&message.advertiserContextualTargeting.length||(message.advertiserContextualTargeting=[]),message.advertiserContextualTargeting.push($root.ProtoContextualTargetingCaseModel.decode(reader,reader.uint32()));break;case 46:message.publisherContextualTargeting&&message.publisherContextualTargeting.length||(message.publisherContextualTargeting=[]),message.publisherContextualTargeting.push($root.ProtoContextualTargetingCaseModel.decode(reader,reader.uint32()));break;case 48:message.amazonDealId=reader.string();break;case 47:message.playerSizeTargetings=$root.ProtoPlayerSizeTargetings.decode(reader,reader.uint32());break;case 101:message.playerSize=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoLineItem.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.trackers=[],object.renditions=[],object.floorPrices=[],object.advertiserContextualTargeting=[],object.publisherContextualTargeting=[]),options.defaults&&(object.publisherLineItemId="",object.advertiserLineItemId="",object.adTag="",object.creativeType=options.enums===String?"ThirdParty":0,object.sound=!1,object.viewability=!1,object.impressionTimeSpent=0,object.vendorId="",object.duration=0,object.mediaCreativeId="",object.ignoreFilledRequests=!1,object.requestCap=3,object.impressionCap=0,object.successRate=0,object.lineItemPriority=options.enums===String?"House":0,object.headerBidderBids="",object.headerBidderTimeout=0,object.mediaCreativeClickUrl="",object.resetRequestsCapTime=60,object.resetImpressionsCapTime=60,object.resetCapType=options.enums===String?"TimeCapping":0,object.creativeHlsFileName="",object.timeBetweenRequests=0,object.skipMode=options.enums===String?"IfLongerThan31Sec":0,object.mediaIdTargeting=null,object.mediaKeywordsTargeting=null,object.mediaLanguageTargeting=null,object.adType=options.enums===String?"Video":0,object.overlayTime=30,object.floorPrice=0,object.adBreakSettings=null,object.bidRate=0,object.pauseAdOutOfView=options.enums===String?"Default":0,object.moatTrackingEnabled=!1,object.cnxCreativeId="",object.blockedDomainsRevisionNumber=0,object.playerSizeTargetings=null,object.amazonDealId="",object.playerSize=""),null!=message.publisherLineItemId&&message.hasOwnProperty("publisherLineItemId")&&(object.publisherLineItemId=message.publisherLineItemId),null!=message.advertiserLineItemId&&message.hasOwnProperty("advertiserLineItemId")&&(object.advertiserLineItemId=message.advertiserLineItemId),null!=message.adTag&&message.hasOwnProperty("adTag")&&(object.adTag=message.adTag),null!=message.creativeType&&message.hasOwnProperty("creativeType")&&(object.creativeType=options.enums===String?$root.ProtoCreativeTypeEnum[message.creativeType]:message.creativeType),null!=message.sound&&message.hasOwnProperty("sound")&&(object.sound=message.sound),null!=message.viewability&&message.hasOwnProperty("viewability")&&(object.viewability=message.viewability),null!=message.impressionTimeSpent&&message.hasOwnProperty("impressionTimeSpent")&&(object.impressionTimeSpent=message.impressionTimeSpent),null!=message.vendorId&&message.hasOwnProperty("vendorId")&&(object.vendorId=message.vendorId),message.trackers&&message.trackers.length){object.trackers=[];for(var j=0;j<message.trackers.length;++j)object.trackers[j]=$root.CreativeTrackerViewModel.toObject(message.trackers[j],options)}if(null!=message.duration&&message.hasOwnProperty("duration")&&(object.duration=message.duration),message.renditions&&message.renditions.length){object.renditions=[];for(j=0;j<message.renditions.length;++j)object.renditions[j]=$root.ProtoRendition.toObject(message.renditions[j],options)}if(null!=message.mediaCreativeId&&message.hasOwnProperty("mediaCreativeId")&&(object.mediaCreativeId=message.mediaCreativeId),null!=message.ignoreFilledRequests&&message.hasOwnProperty("ignoreFilledRequests")&&(object.ignoreFilledRequests=message.ignoreFilledRequests),null!=message.requestCap&&message.hasOwnProperty("requestCap")&&(object.requestCap=message.requestCap),null!=message.impressionCap&&message.hasOwnProperty("impressionCap")&&(object.impressionCap=message.impressionCap),null!=message.successRate&&message.hasOwnProperty("successRate")&&(object.successRate=options.json&&!isFinite(message.successRate)?String(message.successRate):message.successRate),null!=message.lineItemPriority&&message.hasOwnProperty("lineItemPriority")&&(object.lineItemPriority=options.enums===String?$root.ProtoLineItemPriority[message.lineItemPriority]:message.lineItemPriority),null!=message.headerBidderBids&&message.hasOwnProperty("headerBidderBids")&&(object.headerBidderBids=message.headerBidderBids),null!=message.headerBidderTimeout&&message.hasOwnProperty("headerBidderTimeout")&&(object.headerBidderTimeout=message.headerBidderTimeout),null!=message.mediaCreativeClickUrl&&message.hasOwnProperty("mediaCreativeClickUrl")&&(object.mediaCreativeClickUrl=message.mediaCreativeClickUrl),null!=message.resetRequestsCapTime&&message.hasOwnProperty("resetRequestsCapTime")&&(object.resetRequestsCapTime=message.resetRequestsCapTime),null!=message.resetImpressionsCapTime&&message.hasOwnProperty("resetImpressionsCapTime")&&(object.resetImpressionsCapTime=message.resetImpressionsCapTime),null!=message.resetCapType&&message.hasOwnProperty("resetCapType")&&(object.resetCapType=options.enums===String?$root.ProtoResetCapTypeEnum[message.resetCapType]:message.resetCapType),null!=message.creativeHlsFileName&&message.hasOwnProperty("creativeHlsFileName")&&(object.creativeHlsFileName=message.creativeHlsFileName),null!=message.timeBetweenRequests&&message.hasOwnProperty("timeBetweenRequests")&&(object.timeBetweenRequests=message.timeBetweenRequests),null!=message.skipMode&&message.hasOwnProperty("skipMode")&&(object.skipMode=options.enums===String?$root.ProtoAdSkipMode[message.skipMode]:message.skipMode),null!=message.mediaIdTargeting&&message.hasOwnProperty("mediaIdTargeting")&&(object.mediaIdTargeting=$root.ProtoTargetingChoiceModel.toObject(message.mediaIdTargeting,options)),null!=message.mediaKeywordsTargeting&&message.hasOwnProperty("mediaKeywordsTargeting")&&(object.mediaKeywordsTargeting=$root.ProtoTargetingChoiceModel.toObject(message.mediaKeywordsTargeting,options)),null!=message.mediaLanguageTargeting&&message.hasOwnProperty("mediaLanguageTargeting")&&(object.mediaLanguageTargeting=$root.ProtoTargetingChoiceModel.toObject(message.mediaLanguageTargeting,options)),null!=message.adType&&message.hasOwnProperty("adType")&&(object.adType=options.enums===String?$root.ProtoAdType[message.adType]:message.adType),null!=message.overlayTime&&message.hasOwnProperty("overlayTime")&&(object.overlayTime=message.overlayTime),null!=message.floorPrice&&message.hasOwnProperty("floorPrice")&&(object.floorPrice=options.json&&!isFinite(message.floorPrice)?String(message.floorPrice):message.floorPrice),null!=message.adBreakSettings&&message.hasOwnProperty("adBreakSettings")&&(object.adBreakSettings=$root.ProtoLineItemAdBreakSettings.toObject(message.adBreakSettings,options)),message.floorPrices&&message.floorPrices.length){object.floorPrices=[];for(j=0;j<message.floorPrices.length;++j)object.floorPrices[j]=options.json&&!isFinite(message.floorPrices[j])?String(message.floorPrices[j]):message.floorPrices[j]}if(null!=message.bidRate&&message.hasOwnProperty("bidRate")&&(object.bidRate=options.json&&!isFinite(message.bidRate)?String(message.bidRate):message.bidRate),null!=message.pauseAdOutOfView&&message.hasOwnProperty("pauseAdOutOfView")&&(object.pauseAdOutOfView=options.enums===String?$root.ProtoLineItemPauseAdOutOfViewEnum[message.pauseAdOutOfView]:message.pauseAdOutOfView),null!=message.moatTrackingEnabled&&message.hasOwnProperty("moatTrackingEnabled")&&(object.moatTrackingEnabled=message.moatTrackingEnabled),null!=message.cnxCreativeId&&message.hasOwnProperty("cnxCreativeId")&&(object.cnxCreativeId=message.cnxCreativeId),null!=message.blockedDomainsRevisionNumber&&message.hasOwnProperty("blockedDomainsRevisionNumber")&&(object.blockedDomainsRevisionNumber=message.blockedDomainsRevisionNumber),message.advertiserContextualTargeting&&message.advertiserContextualTargeting.length){object.advertiserContextualTargeting=[];for(j=0;j<message.advertiserContextualTargeting.length;++j)object.advertiserContextualTargeting[j]=$root.ProtoContextualTargetingCaseModel.toObject(message.advertiserContextualTargeting[j],options)}if(message.publisherContextualTargeting&&message.publisherContextualTargeting.length){object.publisherContextualTargeting=[];for(j=0;j<message.publisherContextualTargeting.length;++j)object.publisherContextualTargeting[j]=$root.ProtoContextualTargetingCaseModel.toObject(message.publisherContextualTargeting[j],options)}return null!=message.playerSizeTargetings&&message.hasOwnProperty("playerSizeTargetings")&&(object.playerSizeTargetings=$root.ProtoPlayerSizeTargetings.toObject(message.playerSizeTargetings,options)),null!=message.amazonDealId&&message.hasOwnProperty("amazonDealId")&&(object.amazonDealId=message.amazonDealId),null!=message.playerSize&&message.hasOwnProperty("playerSize")&&(object.playerSize=message.playerSize),object},ProtoLineItem}(),$root.ProtoTargetingChoiceModel=function(){function ProtoTargetingChoiceModel(properties){if(this.items=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoTargetingChoiceModel.prototype.choiceCriteria=0,ProtoTargetingChoiceModel.prototype.items=$util.emptyArray,ProtoTargetingChoiceModel.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoTargetingChoiceModel;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.choiceCriteria=reader.int32();break;case 2:message.items&&message.items.length||(message.items=[]),message.items.push(reader.string());break;default:reader.skipType(7&tag)}}return message},ProtoTargetingChoiceModel.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.items=[]),options.defaults&&(object.choiceCriteria=options.enums===String?"Only":0),null!=message.choiceCriteria&&message.hasOwnProperty("choiceCriteria")&&(object.choiceCriteria=options.enums===String?$root.ProtoChoiceCriteriaEnum[message.choiceCriteria]:message.choiceCriteria),message.items&&message.items.length){object.items=[];for(var j=0;j<message.items.length;++j)object.items[j]=message.items[j]}return object},ProtoTargetingChoiceModel}(),$root.ProtoContextualTargetingCaseModel=function(){function ProtoContextualTargetingCaseModel(properties){if(this.filters=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoContextualTargetingCaseModel.prototype.filters=$util.emptyArray,ProtoContextualTargetingCaseModel.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoContextualTargetingCaseModel;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.filters&&message.filters.length||(message.filters=[]),message.filters.push($root.ProtoContextualTargetingFilterModel.decode(reader,reader.uint32()));break;default:reader.skipType(7&tag)}}return message},ProtoContextualTargetingCaseModel.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.filters=[]),message.filters&&message.filters.length){object.filters=[];for(var j=0;j<message.filters.length;++j)object.filters[j]=$root.ProtoContextualTargetingFilterModel.toObject(message.filters[j],options)}return object},ProtoContextualTargetingCaseModel}(),$root.ProtoContextualTargetingFilterModel=function(){function ProtoContextualTargetingFilterModel(properties){if(this.items=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoContextualTargetingFilterModel.prototype.type=0,ProtoContextualTargetingFilterModel.prototype.items=$util.emptyArray,ProtoContextualTargetingFilterModel.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoContextualTargetingFilterModel;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.type=reader.int32();break;case 2:message.items&&message.items.length||(message.items=[]),message.items.push(reader.string());break;default:reader.skipType(7&tag)}}return message},ProtoContextualTargetingFilterModel.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.items=[]),options.defaults&&(object.type=options.enums===String?"IncludeAny":0),null!=message.type&&message.hasOwnProperty("type")&&(object.type=options.enums===String?$root.ProtoLineItemContextualTargetingEnum[message.type]:message.type),message.items&&message.items.length){object.items=[];for(var j=0;j<message.items.length;++j)object.items[j]=message.items[j]}return object},ProtoContextualTargetingFilterModel}(),$root.ProtoPlayerSizeTargetings=function(){function ProtoPlayerSizeTargetings(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayerSizeTargetings.prototype.sizeChoiceCriteria=0,ProtoPlayerSizeTargetings.prototype.minWidth=0,ProtoPlayerSizeTargetings.prototype.maxWidth=0,ProtoPlayerSizeTargetings.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayerSizeTargetings;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.sizeChoiceCriteria=reader.int32();break;case 2:message.minWidth=reader.int32();break;case 3:message.maxWidth=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoPlayerSizeTargetings.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.sizeChoiceCriteria=options.enums===String?"GreaterThan":0,object.minWidth=0,object.maxWidth=0),null!=message.sizeChoiceCriteria&&message.hasOwnProperty("sizeChoiceCriteria")&&(object.sizeChoiceCriteria=options.enums===String?$root.ProtoSizeChoiceCriteriaEnum[message.sizeChoiceCriteria]:message.sizeChoiceCriteria),null!=message.minWidth&&message.hasOwnProperty("minWidth")&&(object.minWidth=message.minWidth),null!=message.maxWidth&&message.hasOwnProperty("maxWidth")&&(object.maxWidth=message.maxWidth),object},ProtoPlayerSizeTargetings}(),$root.ProtoRendition=function(){function ProtoRendition(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoRendition.prototype.height=0,ProtoRendition.prototype.codec="",ProtoRendition.prototype.file="",ProtoRendition.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoRendition;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.height=reader.int32();break;case 2:message.codec=reader.string();break;case 3:message.file=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoRendition.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.height=0,object.codec="",object.file=""),null!=message.height&&message.hasOwnProperty("height")&&(object.height=message.height),null!=message.codec&&message.hasOwnProperty("codec")&&(object.codec=message.codec),null!=message.file&&message.hasOwnProperty("file")&&(object.file=message.file),object},ProtoRendition}(),$root.ProtoLiveMediaMetadataResponse=function(){function ProtoLiveMediaMetadataResponse(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLiveMediaMetadataResponse.prototype.startDate="",ProtoLiveMediaMetadataResponse.prototype.outputUrl="",ProtoLiveMediaMetadataResponse.prototype.thumbnailUrl="",ProtoLiveMediaMetadataResponse.prototype.altText="",ProtoLiveMediaMetadataResponse.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoLiveMediaMetadataResponse;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.startDate=reader.string();break;case 2:message.outputUrl=reader.string();break;case 3:message.thumbnailUrl=reader.string();break;case 4:message.altText=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoLiveMediaMetadataResponse.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.startDate="",object.outputUrl="",object.thumbnailUrl="",object.altText=""),null!=message.startDate&&message.hasOwnProperty("startDate")&&(object.startDate=message.startDate),null!=message.outputUrl&&message.hasOwnProperty("outputUrl")&&(object.outputUrl=message.outputUrl),null!=message.thumbnailUrl&&message.hasOwnProperty("thumbnailUrl")&&(object.thumbnailUrl=message.thumbnailUrl),null!=message.altText&&message.hasOwnProperty("altText")&&(object.altText=message.altText),object},ProtoLiveMediaMetadataResponse}(),$root.ProtoLoggingRequest=function(){function ProtoLoggingRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLoggingRequest.prototype.message="",ProtoLoggingRequest.prototype.version=0,ProtoLoggingRequest.prototype.level=0,ProtoLoggingRequest.prototype.callStack="",ProtoLoggingRequest.prototype.pageUrl="",ProtoLoggingRequest.prototype.exception="",ProtoLoggingRequest.prototype.sessionId="",ProtoLoggingRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.message&&Object.hasOwnProperty.call(message,"message")&&writer.uint32(10).string(message.message),null!=message.version&&Object.hasOwnProperty.call(message,"version")&&writer.uint32(16).int32(message.version),null!=message.level&&Object.hasOwnProperty.call(message,"level")&&writer.uint32(24).int32(message.level),null!=message.callStack&&Object.hasOwnProperty.call(message,"callStack")&&writer.uint32(34).string(message.callStack),null!=message.pageUrl&&Object.hasOwnProperty.call(message,"pageUrl")&&writer.uint32(42).string(message.pageUrl),null!=message.exception&&Object.hasOwnProperty.call(message,"exception")&&writer.uint32(50).string(message.exception),null!=message.sessionId&&Object.hasOwnProperty.call(message,"sessionId")&&writer.uint32(58).string(message.sessionId),writer},ProtoLoggingRequest.fromObject=function(object){if(object instanceof $root.ProtoLoggingRequest)return object;var message=new $root.ProtoLoggingRequest;switch(null!=object.message&&(message.message=String(object.message)),null!=object.version&&(message.version=0|object.version),object.level){case"FATAL":case 0:message.level=0;break;case"WARNING":case 1:message.level=1;break;case"INFO":case 2:message.level=2}return null!=object.callStack&&(message.callStack=String(object.callStack)),null!=object.pageUrl&&(message.pageUrl=String(object.pageUrl)),null!=object.exception&&(message.exception=String(object.exception)),null!=object.sessionId&&(message.sessionId=String(object.sessionId)),message},ProtoLoggingRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoLoggingRequest}(),$root.ProtoSpriteSheet=function(){function ProtoSpriteSheet(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoSpriteSheet.prototype.file="",ProtoSpriteSheet.prototype.height=0,ProtoSpriteSheet.prototype.count=0,ProtoSpriteSheet.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoSpriteSheet;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.file=reader.string();break;case 2:message.height=reader.int32();break;case 3:message.count=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoSpriteSheet.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.file="",object.height=0,object.count=0),null!=message.file&&message.hasOwnProperty("file")&&(object.file=message.file),null!=message.height&&message.hasOwnProperty("height")&&(object.height=message.height),null!=message.count&&message.hasOwnProperty("count")&&(object.count=message.count),object},ProtoSpriteSheet}(),$root.ProtoTrack=function(){function ProtoTrack(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoTrack.prototype.file="",ProtoTrack.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoTrack;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.file=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoTrack.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.file=""),null!=message.file&&message.hasOwnProperty("file")&&(object.file=message.file),object},ProtoTrack}(),$root.ProtoCustomField=function(){function ProtoCustomField(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoCustomField.prototype.name="",ProtoCustomField.prototype.value="",ProtoCustomField.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoCustomField;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.name=reader.string();break;case 2:message.value=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoCustomField.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.name="",object.value=""),null!=message.name&&message.hasOwnProperty("name")&&(object.name=message.name),null!=message.value&&message.hasOwnProperty("value")&&(object.value=message.value),object},ProtoCustomField}(),$root.ProtoMediaMetadataResponse=function(){function ProtoMediaMetadataResponse(properties){if(this.keywordList=[],this.trackList=[],this.renditionList=[],this.customFields=[],this.videoIndexes=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoMediaMetadataResponse.prototype.title="",ProtoMediaMetadataResponse.prototype.description="",ProtoMediaMetadataResponse.prototype.duration=0,ProtoMediaMetadataResponse.prototype.clickUrl="",ProtoMediaMetadataResponse.prototype.keywordList=$util.emptyArray,ProtoMediaMetadataResponse.prototype.trackList=$util.emptyArray,ProtoMediaMetadataResponse.prototype.spriteSheet=null,ProtoMediaMetadataResponse.prototype.thumbnail="",ProtoMediaMetadataResponse.prototype.renditionList=$util.emptyArray,ProtoMediaMetadataResponse.prototype.customFields=$util.emptyArray,ProtoMediaMetadataResponse.prototype.hlsFilePath="",ProtoMediaMetadataResponse.prototype.languageId="",ProtoMediaMetadataResponse.prototype.sourceItemId="",ProtoMediaMetadataResponse.prototype.altText="",ProtoMediaMetadataResponse.prototype.videoIndexes=$util.emptyArray,ProtoMediaMetadataResponse.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoMediaMetadataResponse;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.title=reader.string();break;case 2:message.description=reader.string();break;case 3:message.duration=reader.int32();break;case 4:message.clickUrl=reader.string();break;case 5:message.keywordList&&message.keywordList.length||(message.keywordList=[]),message.keywordList.push(reader.string());break;case 6:message.trackList&&message.trackList.length||(message.trackList=[]),message.trackList.push($root.ProtoTrack.decode(reader,reader.uint32()));break;case 7:message.spriteSheet=$root.ProtoSpriteSheet.decode(reader,reader.uint32());break;case 8:message.thumbnail=reader.string();break;case 9:message.renditionList&&message.renditionList.length||(message.renditionList=[]),message.renditionList.push($root.ProtoRendition.decode(reader,reader.uint32()));break;case 10:message.customFields&&message.customFields.length||(message.customFields=[]),message.customFields.push($root.ProtoCustomField.decode(reader,reader.uint32()));break;case 11:message.hlsFilePath=reader.string();break;case 12:message.languageId=reader.string();break;case 13:message.sourceItemId=reader.string();break;case 14:message.altText=reader.string();break;case 15:message.videoIndexes&&message.videoIndexes.length||(message.videoIndexes=[]),message.videoIndexes.push(reader.string());break;default:reader.skipType(7&tag)}}return message},ProtoMediaMetadataResponse.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.keywordList=[],object.trackList=[],object.renditionList=[],object.customFields=[],object.videoIndexes=[]),options.defaults&&(object.title="",object.description="",object.duration=0,object.clickUrl="",object.spriteSheet=null,object.thumbnail="",object.hlsFilePath="",object.languageId="",object.sourceItemId="",object.altText=""),null!=message.title&&message.hasOwnProperty("title")&&(object.title=message.title),null!=message.description&&message.hasOwnProperty("description")&&(object.description=message.description),null!=message.duration&&message.hasOwnProperty("duration")&&(object.duration=message.duration),null!=message.clickUrl&&message.hasOwnProperty("clickUrl")&&(object.clickUrl=message.clickUrl),message.keywordList&&message.keywordList.length){object.keywordList=[];for(var j=0;j<message.keywordList.length;++j)object.keywordList[j]=message.keywordList[j]}if(message.trackList&&message.trackList.length){object.trackList=[];for(j=0;j<message.trackList.length;++j)object.trackList[j]=$root.ProtoTrack.toObject(message.trackList[j],options)}if(null!=message.spriteSheet&&message.hasOwnProperty("spriteSheet")&&(object.spriteSheet=$root.ProtoSpriteSheet.toObject(message.spriteSheet,options)),null!=message.thumbnail&&message.hasOwnProperty("thumbnail")&&(object.thumbnail=message.thumbnail),message.renditionList&&message.renditionList.length){object.renditionList=[];for(j=0;j<message.renditionList.length;++j)object.renditionList[j]=$root.ProtoRendition.toObject(message.renditionList[j],options)}if(message.customFields&&message.customFields.length){object.customFields=[];for(j=0;j<message.customFields.length;++j)object.customFields[j]=$root.ProtoCustomField.toObject(message.customFields[j],options)}if(null!=message.hlsFilePath&&message.hasOwnProperty("hlsFilePath")&&(object.hlsFilePath=message.hlsFilePath),null!=message.languageId&&message.hasOwnProperty("languageId")&&(object.languageId=message.languageId),null!=message.sourceItemId&&message.hasOwnProperty("sourceItemId")&&(object.sourceItemId=message.sourceItemId),null!=message.altText&&message.hasOwnProperty("altText")&&(object.altText=message.altText),message.videoIndexes&&message.videoIndexes.length){object.videoIndexes=[];for(j=0;j<message.videoIndexes.length;++j)object.videoIndexes[j]=message.videoIndexes[j]}return object},ProtoMediaMetadataResponse}(),$root.ProtoRtbRequest=function(){function ProtoRtbRequest(properties){if(this.lineItems={},this.customMacros={},properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoRtbRequest.prototype.metadata=null,ProtoRtbRequest.prototype.coppa=!1,ProtoRtbRequest.prototype.refererUrl="",ProtoRtbRequest.prototype.testMode=!1,ProtoRtbRequest.prototype.videoWidth=0,ProtoRtbRequest.prototype.videoHeight=0,ProtoRtbRequest.prototype.gdprCompliant=!1,ProtoRtbRequest.prototype.soundOn=!1,ProtoRtbRequest.prototype.gdprConsentData="",ProtoRtbRequest.prototype.explorationMode=!1,ProtoRtbRequest.prototype.viewability=!1,ProtoRtbRequest.prototype.outstream=!1,ProtoRtbRequest.prototype.domainURL="",ProtoRtbRequest.prototype.isClickToPlay=!1,ProtoRtbRequest.prototype.appVersion="",ProtoRtbRequest.prototype.deviceID="",ProtoRtbRequest.prototype.lineItems=$util.emptyObject,ProtoRtbRequest.prototype.isCcpaBlockingUserInfo=!1,ProtoRtbRequest.prototype.usPrivacyString="",ProtoRtbRequest.prototype.adSkippability=0,ProtoRtbRequest.prototype.skipAdAfter=5,ProtoRtbRequest.prototype.gdprConsentMode=0,ProtoRtbRequest.prototype.maxAdDuration=180,ProtoRtbRequest.prototype.customMacros=$util.emptyObject,ProtoRtbRequest.prototype.maxBidPrice=0,ProtoRtbRequest.prototype.adsMustBeSkippableIfLongerThan=31,ProtoRtbRequest.encode=function(message,writer){if(writer||(writer=$Writer.create()),null!=message.metadata&&Object.hasOwnProperty.call(message,"metadata")&&$root.MetadataModel.encode(message.metadata,writer.uint32(10).fork()).ldelim(),null!=message.coppa&&Object.hasOwnProperty.call(message,"coppa")&&writer.uint32(32).bool(message.coppa),null!=message.refererUrl&&Object.hasOwnProperty.call(message,"refererUrl")&&writer.uint32(42).string(message.refererUrl),null!=message.testMode&&Object.hasOwnProperty.call(message,"testMode")&&writer.uint32(48).bool(message.testMode),null!=message.videoWidth&&Object.hasOwnProperty.call(message,"videoWidth")&&writer.uint32(56).int32(message.videoWidth),null!=message.videoHeight&&Object.hasOwnProperty.call(message,"videoHeight")&&writer.uint32(64).int32(message.videoHeight),null!=message.gdprCompliant&&Object.hasOwnProperty.call(message,"gdprCompliant")&&writer.uint32(72).bool(message.gdprCompliant),null!=message.soundOn&&Object.hasOwnProperty.call(message,"soundOn")&&writer.uint32(80).bool(message.soundOn),null!=message.gdprConsentData&&Object.hasOwnProperty.call(message,"gdprConsentData")&&writer.uint32(90).string(message.gdprConsentData),null!=message.explorationMode&&Object.hasOwnProperty.call(message,"explorationMode")&&writer.uint32(96).bool(message.explorationMode),null!=message.viewability&&Object.hasOwnProperty.call(message,"viewability")&&writer.uint32(104).bool(message.viewability),null!=message.outstream&&Object.hasOwnProperty.call(message,"outstream")&&writer.uint32(112).bool(message.outstream),null!=message.domainURL&&Object.hasOwnProperty.call(message,"domainURL")&&writer.uint32(130).string(message.domainURL),null!=message.isClickToPlay&&Object.hasOwnProperty.call(message,"isClickToPlay")&&writer.uint32(144).bool(message.isClickToPlay),null!=message.appVersion&&Object.hasOwnProperty.call(message,"appVersion")&&writer.uint32(170).string(message.appVersion),null!=message.deviceID&&Object.hasOwnProperty.call(message,"deviceID")&&writer.uint32(194).string(message.deviceID),null!=message.lineItems&&Object.hasOwnProperty.call(message,"lineItems"))for(var keys=Object.keys(message.lineItems),i=0;i<keys.length;++i)writer.uint32(202).fork().uint32(10).string(keys[i]),$root.ProtoRtbRequestLineItemEntry.encode(message.lineItems[keys[i]],writer.uint32(18).fork()).ldelim().ldelim();if(null!=message.isCcpaBlockingUserInfo&&Object.hasOwnProperty.call(message,"isCcpaBlockingUserInfo")&&writer.uint32(208).bool(message.isCcpaBlockingUserInfo),null!=message.usPrivacyString&&Object.hasOwnProperty.call(message,"usPrivacyString")&&writer.uint32(218).string(message.usPrivacyString),null!=message.adSkippability&&Object.hasOwnProperty.call(message,"adSkippability")&&writer.uint32(256).int32(message.adSkippability),null!=message.skipAdAfter&&Object.hasOwnProperty.call(message,"skipAdAfter")&&writer.uint32(264).int32(message.skipAdAfter),null!=message.gdprConsentMode&&Object.hasOwnProperty.call(message,"gdprConsentMode")&&writer.uint32(288).int32(message.gdprConsentMode),null!=message.maxAdDuration&&Object.hasOwnProperty.call(message,"maxAdDuration")&&writer.uint32(296).int32(message.maxAdDuration),null!=message.customMacros&&Object.hasOwnProperty.call(message,"customMacros"))for(keys=Object.keys(message.customMacros),i=0;i<keys.length;++i)writer.uint32(306).fork().uint32(10).string(keys[i]).uint32(18).string(message.customMacros[keys[i]]).ldelim();return null!=message.maxBidPrice&&Object.hasOwnProperty.call(message,"maxBidPrice")&&writer.uint32(313).double(message.maxBidPrice),null!=message.adsMustBeSkippableIfLongerThan&&Object.hasOwnProperty.call(message,"adsMustBeSkippableIfLongerThan")&&writer.uint32(320).int32(message.adsMustBeSkippableIfLongerThan),writer},ProtoRtbRequest.fromObject=function(object){if(object instanceof $root.ProtoRtbRequest)return object;var message=new $root.ProtoRtbRequest;if(null!=object.metadata){if("object"!=typeof object.metadata)throw TypeError(".ProtoRtbRequest.metadata: object expected");message.metadata=$root.MetadataModel.fromObject(object.metadata)}if(null!=object.coppa&&(message.coppa=Boolean(object.coppa)),null!=object.refererUrl&&(message.refererUrl=String(object.refererUrl)),null!=object.testMode&&(message.testMode=Boolean(object.testMode)),null!=object.videoWidth&&(message.videoWidth=0|object.videoWidth),null!=object.videoHeight&&(message.videoHeight=0|object.videoHeight),null!=object.gdprCompliant&&(message.gdprCompliant=Boolean(object.gdprCompliant)),null!=object.soundOn&&(message.soundOn=Boolean(object.soundOn)),null!=object.gdprConsentData&&(message.gdprConsentData=String(object.gdprConsentData)),null!=object.explorationMode&&(message.explorationMode=Boolean(object.explorationMode)),null!=object.viewability&&(message.viewability=Boolean(object.viewability)),null!=object.outstream&&(message.outstream=Boolean(object.outstream)),null!=object.domainURL&&(message.domainURL=String(object.domainURL)),null!=object.isClickToPlay&&(message.isClickToPlay=Boolean(object.isClickToPlay)),null!=object.appVersion&&(message.appVersion=String(object.appVersion)),null!=object.deviceID&&(message.deviceID=String(object.deviceID)),object.lineItems){if("object"!=typeof object.lineItems)throw TypeError(".ProtoRtbRequest.lineItems: object expected");message.lineItems={};for(var keys=Object.keys(object.lineItems),i=0;i<keys.length;++i){if("object"!=typeof object.lineItems[keys[i]])throw TypeError(".ProtoRtbRequest.lineItems: object expected");message.lineItems[keys[i]]=$root.ProtoRtbRequestLineItemEntry.fromObject(object.lineItems[keys[i]])}}switch(null!=object.isCcpaBlockingUserInfo&&(message.isCcpaBlockingUserInfo=Boolean(object.isCcpaBlockingUserInfo)),null!=object.usPrivacyString&&(message.usPrivacyString=String(object.usPrivacyString)),object.adSkippability){case"IfLongerThan":case 0:message.adSkippability=0;break;case"Always":case 1:message.adSkippability=1;break;case"NoRestrictions":case 2:message.adSkippability=2}switch(null!=object.skipAdAfter&&(message.skipAdAfter=0|object.skipAdAfter),object.gdprConsentMode){case"Unknown":case 0:message.gdprConsentMode=0;break;case"NoCmp":case 1:message.gdprConsentMode=1;break;case"NoConsent":case 2:message.gdprConsentMode=2;break;case"NoConnatixConsent":case 3:message.gdprConsentMode=3;break;case"NotAllDemandConsent":case 4:message.gdprConsentMode=4;break;case"AllGood":case 5:message.gdprConsentMode=5}if(null!=object.maxAdDuration&&(message.maxAdDuration=0|object.maxAdDuration),object.customMacros){if("object"!=typeof object.customMacros)throw TypeError(".ProtoRtbRequest.customMacros: object expected");message.customMacros={};for(keys=Object.keys(object.customMacros),i=0;i<keys.length;++i)message.customMacros[keys[i]]=String(object.customMacros[keys[i]])}return null!=object.maxBidPrice&&(message.maxBidPrice=Number(object.maxBidPrice)),null!=object.adsMustBeSkippableIfLongerThan&&(message.adsMustBeSkippableIfLongerThan=0|object.adsMustBeSkippableIfLongerThan),message},ProtoRtbRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoRtbRequest}(),$root.ProtoRtbRequestLineItemEntry=function(){function ProtoRtbRequestLineItemEntry(properties){if(this.ignoredFloorPriceFactorIndexes=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}var $oneOfFields;return ProtoRtbRequestLineItemEntry.prototype.cachedFloorPrice=null,ProtoRtbRequestLineItemEntry.prototype.availableRequests=0,ProtoRtbRequestLineItemEntry.prototype.ignoredFloorPriceFactorIndexes=$util.emptyArray,ProtoRtbRequestLineItemEntry.prototype.gdprConsent=!1,ProtoRtbRequestLineItemEntry.prototype.publisherLineItemId="",ProtoRtbRequestLineItemEntry.prototype.slotWidth=0,ProtoRtbRequestLineItemEntry.prototype.slotHeight=0,Object.defineProperty(ProtoRtbRequestLineItemEntry.prototype,"_cachedFloorPrice",{get:$util.oneOfGetter($oneOfFields=["cachedFloorPrice"]),set:$util.oneOfSetter($oneOfFields)}),ProtoRtbRequestLineItemEntry.encode=function(message,writer){if(writer||(writer=$Writer.create()),null!=message.availableRequests&&Object.hasOwnProperty.call(message,"availableRequests")&&writer.uint32(8).int32(message.availableRequests),null!=message.cachedFloorPrice&&Object.hasOwnProperty.call(message,"cachedFloorPrice")&&writer.uint32(17).double(message.cachedFloorPrice),null!=message.ignoredFloorPriceFactorIndexes&&message.ignoredFloorPriceFactorIndexes.length)for(var i=0;i<message.ignoredFloorPriceFactorIndexes.length;++i)writer.uint32(24).int32(message.ignoredFloorPriceFactorIndexes[i]);return null!=message.gdprConsent&&Object.hasOwnProperty.call(message,"gdprConsent")&&writer.uint32(32).bool(message.gdprConsent),null!=message.publisherLineItemId&&Object.hasOwnProperty.call(message,"publisherLineItemId")&&writer.uint32(42).string(message.publisherLineItemId),null!=message.slotWidth&&Object.hasOwnProperty.call(message,"slotWidth")&&writer.uint32(48).int32(message.slotWidth),null!=message.slotHeight&&Object.hasOwnProperty.call(message,"slotHeight")&&writer.uint32(56).int32(message.slotHeight),writer},ProtoRtbRequestLineItemEntry.fromObject=function(object){if(object instanceof $root.ProtoRtbRequestLineItemEntry)return object;var message=new $root.ProtoRtbRequestLineItemEntry;if(null!=object.cachedFloorPrice&&(message.cachedFloorPrice=Number(object.cachedFloorPrice)),null!=object.availableRequests&&(message.availableRequests=0|object.availableRequests),object.ignoredFloorPriceFactorIndexes){if(!Array.isArray(object.ignoredFloorPriceFactorIndexes))throw TypeError(".ProtoRtbRequestLineItemEntry.ignoredFloorPriceFactorIndexes: array expected");message.ignoredFloorPriceFactorIndexes=[];for(var i=0;i<object.ignoredFloorPriceFactorIndexes.length;++i)message.ignoredFloorPriceFactorIndexes[i]=0|object.ignoredFloorPriceFactorIndexes[i]}return null!=object.gdprConsent&&(message.gdprConsent=Boolean(object.gdprConsent)),null!=object.publisherLineItemId&&(message.publisherLineItemId=String(object.publisherLineItemId)),null!=object.slotWidth&&(message.slotWidth=0|object.slotWidth),null!=object.slotHeight&&(message.slotHeight=0|object.slotHeight),message},ProtoRtbRequestLineItemEntry.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoRtbRequestLineItemEntry}(),$root.ProtoRtbResponse=function(){function ProtoRtbResponse(properties){if(this.lineItemResponses=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoRtbResponse.prototype.lineItemResponses=$util.emptyArray,ProtoRtbResponse.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoRtbResponse;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 3:message.lineItemResponses&&message.lineItemResponses.length||(message.lineItemResponses=[]),message.lineItemResponses.push($root.ProtoRtbLineItem.decode(reader,reader.uint32()));break;default:reader.skipType(7&tag)}}return message},ProtoRtbResponse.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.lineItemResponses=[]),message.lineItemResponses&&message.lineItemResponses.length){object.lineItemResponses=[];for(var j=0;j<message.lineItemResponses.length;++j)object.lineItemResponses[j]=$root.ProtoRtbLineItem.toObject(message.lineItemResponses[j],options)}return object},ProtoRtbResponse}(),$root.ProtoRtbBid=function(){function ProtoRtbBid(properties){if(this.billingNoticeUrlList=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoRtbBid.prototype.winNoticeUrl="",ProtoRtbBid.prototype.adQualityCheckUrl="",ProtoRtbBid.prototype.vastTag="",ProtoRtbBid.prototype.encryptedPrice="",ProtoRtbBid.prototype.creativeId="",ProtoRtbBid.prototype.seatId="",ProtoRtbBid.prototype.adomain="",ProtoRtbBid.prototype.syncedUser=!1,ProtoRtbBid.prototype.requestedFloorPrice=0,ProtoRtbBid.prototype.floorPriceFactorIndex=0,ProtoRtbBid.prototype.campaignId="",ProtoRtbBid.prototype.width=0,ProtoRtbBid.prototype.height=0,ProtoRtbBid.prototype.billingNoticeUrlList=$util.emptyArray,ProtoRtbBid.prototype.mime="text/html",ProtoRtbBid.prototype.gtkpbp=0,ProtoRtbBid.prototype.successRate=0,ProtoRtbBid.prototype.impressionTimeSpent=0,ProtoRtbBid.prototype.bidRate=0,ProtoRtbBid.prototype.dspId="",ProtoRtbBid.prototype.cnxBidId="",ProtoRtbBid.prototype.logAuctionInformation=!1,ProtoRtbBid.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoRtbBid;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 2:message.winNoticeUrl=reader.string();break;case 3:message.adQualityCheckUrl=reader.string();break;case 4:message.vastTag=reader.string();break;case 6:message.encryptedPrice=reader.string();break;case 7:message.creativeId=reader.string();break;case 8:message.seatId=reader.string();break;case 9:message.adomain=reader.string();break;case 10:message.syncedUser=reader.bool();break;case 11:message.requestedFloorPrice=reader.double();break;case 12:message.floorPriceFactorIndex=reader.int32();break;case 13:message.campaignId=reader.string();break;case 14:message.width=reader.int32();break;case 15:message.height=reader.int32();break;case 16:message.billingNoticeUrlList&&message.billingNoticeUrlList.length||(message.billingNoticeUrlList=[]),message.billingNoticeUrlList.push(reader.string());break;case 17:message.mime=reader.string();break;case 18:message.gtkpbp=reader.double();break;case 19:message.successRate=reader.double();break;case 20:message.impressionTimeSpent=reader.int32();break;case 21:message.bidRate=reader.double();break;case 22:message.dspId=reader.string();break;case 23:message.cnxBidId=reader.string();break;case 24:message.logAuctionInformation=reader.bool();break;default:reader.skipType(7&tag)}}return message},ProtoRtbBid.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.billingNoticeUrlList=[]),options.defaults&&(object.winNoticeUrl="",object.adQualityCheckUrl="",object.vastTag="",object.encryptedPrice="",object.creativeId="",object.seatId="",object.adomain="",object.syncedUser=!1,object.requestedFloorPrice=0,object.floorPriceFactorIndex=0,object.campaignId="",object.width=0,object.height=0,object.mime="text/html",object.gtkpbp=0,object.successRate=0,object.impressionTimeSpent=0,object.bidRate=0,object.dspId="",object.cnxBidId="",object.logAuctionInformation=!1),null!=message.winNoticeUrl&&message.hasOwnProperty("winNoticeUrl")&&(object.winNoticeUrl=message.winNoticeUrl),null!=message.adQualityCheckUrl&&message.hasOwnProperty("adQualityCheckUrl")&&(object.adQualityCheckUrl=message.adQualityCheckUrl),null!=message.vastTag&&message.hasOwnProperty("vastTag")&&(object.vastTag=message.vastTag),null!=message.encryptedPrice&&message.hasOwnProperty("encryptedPrice")&&(object.encryptedPrice=message.encryptedPrice),null!=message.creativeId&&message.hasOwnProperty("creativeId")&&(object.creativeId=message.creativeId),null!=message.seatId&&message.hasOwnProperty("seatId")&&(object.seatId=message.seatId),null!=message.adomain&&message.hasOwnProperty("adomain")&&(object.adomain=message.adomain),null!=message.syncedUser&&message.hasOwnProperty("syncedUser")&&(object.syncedUser=message.syncedUser),null!=message.requestedFloorPrice&&message.hasOwnProperty("requestedFloorPrice")&&(object.requestedFloorPrice=options.json&&!isFinite(message.requestedFloorPrice)?String(message.requestedFloorPrice):message.requestedFloorPrice),null!=message.floorPriceFactorIndex&&message.hasOwnProperty("floorPriceFactorIndex")&&(object.floorPriceFactorIndex=message.floorPriceFactorIndex),null!=message.campaignId&&message.hasOwnProperty("campaignId")&&(object.campaignId=message.campaignId),null!=message.width&&message.hasOwnProperty("width")&&(object.width=message.width),null!=message.height&&message.hasOwnProperty("height")&&(object.height=message.height),message.billingNoticeUrlList&&message.billingNoticeUrlList.length){object.billingNoticeUrlList=[];for(var j=0;j<message.billingNoticeUrlList.length;++j)object.billingNoticeUrlList[j]=message.billingNoticeUrlList[j]}return null!=message.mime&&message.hasOwnProperty("mime")&&(object.mime=message.mime),null!=message.gtkpbp&&message.hasOwnProperty("gtkpbp")&&(object.gtkpbp=options.json&&!isFinite(message.gtkpbp)?String(message.gtkpbp):message.gtkpbp),null!=message.successRate&&message.hasOwnProperty("successRate")&&(object.successRate=options.json&&!isFinite(message.successRate)?String(message.successRate):message.successRate),null!=message.impressionTimeSpent&&message.hasOwnProperty("impressionTimeSpent")&&(object.impressionTimeSpent=message.impressionTimeSpent),null!=message.bidRate&&message.hasOwnProperty("bidRate")&&(object.bidRate=options.json&&!isFinite(message.bidRate)?String(message.bidRate):message.bidRate),null!=message.dspId&&message.hasOwnProperty("dspId")&&(object.dspId=message.dspId),null!=message.cnxBidId&&message.hasOwnProperty("cnxBidId")&&(object.cnxBidId=message.cnxBidId),null!=message.logAuctionInformation&&message.hasOwnProperty("logAuctionInformation")&&(object.logAuctionInformation=message.logAuctionInformation),object},ProtoRtbBid}(),$root.ProtoRtbNoBid=function(){function ProtoRtbNoBid(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoRtbNoBid.prototype.connatixReason=0,ProtoRtbNoBid.prototype.partnerReason=0,ProtoRtbNoBid.prototype.syncedUser=!1,ProtoRtbNoBid.prototype.requestedFloorPrice=0,ProtoRtbNoBid.prototype.floorPriceFactorIndex=0,ProtoRtbNoBid.prototype.partnerCustomHeaders="",ProtoRtbNoBid.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoRtbNoBid;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.connatixReason=reader.int32();break;case 2:message.partnerReason=reader.int32();break;case 3:message.syncedUser=reader.bool();break;case 4:message.requestedFloorPrice=reader.double();break;case 5:message.floorPriceFactorIndex=reader.int32();break;case 6:message.partnerCustomHeaders=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoRtbNoBid.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.connatixReason=options.enums===String?"RequestException":0,object.partnerReason=options.enums===String?"Unknown":0,object.syncedUser=!1,object.requestedFloorPrice=0,object.floorPriceFactorIndex=0,object.partnerCustomHeaders=""),null!=message.connatixReason&&message.hasOwnProperty("connatixReason")&&(object.connatixReason=options.enums===String?$root.ConnatixNoBidReasonEnum[message.connatixReason]:message.connatixReason),null!=message.partnerReason&&message.hasOwnProperty("partnerReason")&&(object.partnerReason=options.enums===String?$root.PartnerNoBidReasonEnum[message.partnerReason]:message.partnerReason),null!=message.syncedUser&&message.hasOwnProperty("syncedUser")&&(object.syncedUser=message.syncedUser),null!=message.requestedFloorPrice&&message.hasOwnProperty("requestedFloorPrice")&&(object.requestedFloorPrice=options.json&&!isFinite(message.requestedFloorPrice)?String(message.requestedFloorPrice):message.requestedFloorPrice),null!=message.floorPriceFactorIndex&&message.hasOwnProperty("floorPriceFactorIndex")&&(object.floorPriceFactorIndex=message.floorPriceFactorIndex),null!=message.partnerCustomHeaders&&message.hasOwnProperty("partnerCustomHeaders")&&(object.partnerCustomHeaders=message.partnerCustomHeaders),object},ProtoRtbNoBid}(),$root.ProtoRtbLineItem=function(){function ProtoRtbLineItem(properties){if(this.bids=[],this.noBids=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoRtbLineItem.prototype.id="",ProtoRtbLineItem.prototype.cachedFloorPrice=0,ProtoRtbLineItem.prototype.bids=$util.emptyArray,ProtoRtbLineItem.prototype.noBids=$util.emptyArray,ProtoRtbLineItem.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoRtbLineItem;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.id=reader.string();break;case 2:message.cachedFloorPrice=reader.double();break;case 3:message.bids&&message.bids.length||(message.bids=[]),message.bids.push($root.ProtoRtbBid.decode(reader,reader.uint32()));break;case 4:message.noBids&&message.noBids.length||(message.noBids=[]),message.noBids.push($root.ProtoRtbNoBid.decode(reader,reader.uint32()));break;default:reader.skipType(7&tag)}}return message},ProtoRtbLineItem.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.bids=[],object.noBids=[]),options.defaults&&(object.id="",object.cachedFloorPrice=0),null!=message.id&&message.hasOwnProperty("id")&&(object.id=message.id),null!=message.cachedFloorPrice&&message.hasOwnProperty("cachedFloorPrice")&&(object.cachedFloorPrice=options.json&&!isFinite(message.cachedFloorPrice)?String(message.cachedFloorPrice):message.cachedFloorPrice),message.bids&&message.bids.length){object.bids=[];for(var j=0;j<message.bids.length;++j)object.bids[j]=$root.ProtoRtbBid.toObject(message.bids[j],options)}if(message.noBids&&message.noBids.length){object.noBids=[];for(j=0;j<message.noBids.length;++j)object.noBids[j]=$root.ProtoRtbNoBid.toObject(message.noBids[j],options)}return object},ProtoRtbLineItem}(),$root.ProtoSupplyChain=function(){function ProtoSupplyChain(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoSupplyChain.prototype.businessDomain="",ProtoSupplyChain.prototype.supplyChainId="",ProtoSupplyChain.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoSupplyChain;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.businessDomain=reader.string();break;case 3:message.supplyChainId=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoSupplyChain.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.businessDomain="",object.supplyChainId=""),null!=message.businessDomain&&message.hasOwnProperty("businessDomain")&&(object.businessDomain=message.businessDomain),null!=message.supplyChainId&&message.hasOwnProperty("supplyChainId")&&(object.supplyChainId=message.supplyChainId),object},ProtoSupplyChain}(),$root.ProtoAdClickTrackingRequest=function(){function ProtoAdClickTrackingRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoAdClickTrackingRequest.prototype.trackingRequestMeta=null,ProtoAdClickTrackingRequest.prototype.mediaGuid="",ProtoAdClickTrackingRequest.prototype.publisherLineItemId="",ProtoAdClickTrackingRequest.prototype.advertiserLineItemId="",ProtoAdClickTrackingRequest.prototype.type=1,ProtoAdClickTrackingRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.trackingRequestMeta&&Object.hasOwnProperty.call(message,"trackingRequestMeta")&&$root.MetadataModel.encode(message.trackingRequestMeta,writer.uint32(10).fork()).ldelim(),null!=message.mediaGuid&&Object.hasOwnProperty.call(message,"mediaGuid")&&writer.uint32(18).string(message.mediaGuid),null!=message.publisherLineItemId&&Object.hasOwnProperty.call(message,"publisherLineItemId")&&writer.uint32(26).string(message.publisherLineItemId),null!=message.advertiserLineItemId&&Object.hasOwnProperty.call(message,"advertiserLineItemId")&&writer.uint32(34).string(message.advertiserLineItemId),null!=message.type&&Object.hasOwnProperty.call(message,"type")&&writer.uint32(40).int32(message.type),writer},ProtoAdClickTrackingRequest.fromObject=function(object){if(object instanceof $root.ProtoAdClickTrackingRequest)return object;var message=new $root.ProtoAdClickTrackingRequest;if(null!=object.trackingRequestMeta){if("object"!=typeof object.trackingRequestMeta)throw TypeError(".ProtoAdClickTrackingRequest.trackingRequestMeta: object expected");message.trackingRequestMeta=$root.MetadataModel.fromObject(object.trackingRequestMeta)}switch(null!=object.mediaGuid&&(message.mediaGuid=String(object.mediaGuid)),null!=object.publisherLineItemId&&(message.publisherLineItemId=String(object.publisherLineItemId)),null!=object.advertiserLineItemId&&(message.advertiserLineItemId=String(object.advertiserLineItemId)),object.type){case"AdClick":case 1:message.type=1;break;case"AdClickThrough":case 2:message.type=2;break;case"AdSkipClick":case 3:message.type=3;break;case"VolumeClick":case 4:message.type=4;break;case"PauseClick":case 5:message.type=5;break;case"PlayClick":case 6:message.type=6;break;case"FullScreenClick":case 7:message.type=7;break;case"MuteClick":case 8:message.type=8;break;case"UnmuteClick":case 9:message.type=9}return message},ProtoAdClickTrackingRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoAdClickTrackingRequest}(),$root.ProtoAdOpportunityRequest=function(){function ProtoAdOpportunityRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoAdOpportunityRequest.prototype.sessionId="",ProtoAdOpportunityRequest.prototype.trackingRequestMeta=null,ProtoAdOpportunityRequest.prototype.adBreak=0,ProtoAdOpportunityRequest.prototype.playerWidth=0,ProtoAdOpportunityRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.sessionId&&Object.hasOwnProperty.call(message,"sessionId")&&writer.uint32(10).string(message.sessionId),null!=message.trackingRequestMeta&&Object.hasOwnProperty.call(message,"trackingRequestMeta")&&$root.MetadataModel.encode(message.trackingRequestMeta,writer.uint32(18).fork()).ldelim(),null!=message.adBreak&&Object.hasOwnProperty.call(message,"adBreak")&&writer.uint32(24).int32(message.adBreak),null!=message.playerWidth&&Object.hasOwnProperty.call(message,"playerWidth")&&writer.uint32(32).int32(message.playerWidth),writer},ProtoAdOpportunityRequest.fromObject=function(object){if(object instanceof $root.ProtoAdOpportunityRequest)return object;var message=new $root.ProtoAdOpportunityRequest;if(null!=object.sessionId&&(message.sessionId=String(object.sessionId)),null!=object.trackingRequestMeta){if("object"!=typeof object.trackingRequestMeta)throw TypeError(".ProtoAdOpportunityRequest.trackingRequestMeta: object expected");message.trackingRequestMeta=$root.MetadataModel.fromObject(object.trackingRequestMeta)}switch(object.adBreak){case"None":case 0:message.adBreak=0;break;case"PreRoll":case 1:message.adBreak=1;break;case"MidRoll":case 2:message.adBreak=2;break;case"PostRoll":case 3:message.adBreak=3}return null!=object.playerWidth&&(message.playerWidth=0|object.playerWidth),message},ProtoAdOpportunityRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoAdOpportunityRequest}(),$root.ProtoAuctionInfoRequest=function(){function ProtoAuctionInfoRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoAuctionInfoRequest.prototype.cnxBidId="",ProtoAuctionInfoRequest.prototype.auctionInformation=null,ProtoAuctionInfoRequest.prototype.auctionLossReason=0,ProtoAuctionInfoRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.cnxBidId&&Object.hasOwnProperty.call(message,"cnxBidId")&&writer.uint32(10).string(message.cnxBidId),null!=message.auctionInformation&&Object.hasOwnProperty.call(message,"auctionInformation")&&$root.ProtoAuctionInformation.encode(message.auctionInformation,writer.uint32(18).fork()).ldelim(),null!=message.auctionLossReason&&Object.hasOwnProperty.call(message,"auctionLossReason")&&writer.uint32(24).int32(message.auctionLossReason),writer},ProtoAuctionInfoRequest.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoAuctionInfoRequest;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.cnxBidId=reader.string();break;case 2:message.auctionInformation=$root.ProtoAuctionInformation.decode(reader,reader.uint32());break;case 3:message.auctionLossReason=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoAuctionInfoRequest.fromObject=function(object){if(object instanceof $root.ProtoAuctionInfoRequest)return object;var message=new $root.ProtoAuctionInfoRequest;if(null!=object.cnxBidId&&(message.cnxBidId=String(object.cnxBidId)),null!=object.auctionInformation){if("object"!=typeof object.auctionInformation)throw TypeError(".ProtoAuctionInfoRequest.auctionInformation: object expected");message.auctionInformation=$root.ProtoAuctionInformation.fromObject(object.auctionInformation)}switch(object.auctionLossReason){case"TargetingMismatch":case 0:message.auctionLossReason=0;break;case"CompetitorPriority":case 1:message.auctionLossReason=1;break;case"AdOpportunityEnd":case 2:message.auctionLossReason=2}return message},ProtoAuctionInfoRequest.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.cnxBidId="",object.auctionInformation=null,object.auctionLossReason=options.enums===String?"TargetingMismatch":0),null!=message.cnxBidId&&message.hasOwnProperty("cnxBidId")&&(object.cnxBidId=message.cnxBidId),null!=message.auctionInformation&&message.hasOwnProperty("auctionInformation")&&(object.auctionInformation=$root.ProtoAuctionInformation.toObject(message.auctionInformation,options)),null!=message.auctionLossReason&&message.hasOwnProperty("auctionLossReason")&&(object.auctionLossReason=options.enums===String?$root.ProtoAuctionLossReasonEnum[message.auctionLossReason]:message.auctionLossReason),object},ProtoAuctionInfoRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoAuctionInfoRequest}(),$root.ProtoAuctionInformation=function(){function ProtoAuctionInformation(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoAuctionInformation.prototype.highestObfuscatedBidPrice=0,ProtoAuctionInformation.prototype.secondHighestObfuscatedBidPrice=0,ProtoAuctionInformation.prototype.bidDensity=0,ProtoAuctionInformation.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.highestObfuscatedBidPrice&&Object.hasOwnProperty.call(message,"highestObfuscatedBidPrice")&&writer.uint32(9).double(message.highestObfuscatedBidPrice),null!=message.secondHighestObfuscatedBidPrice&&Object.hasOwnProperty.call(message,"secondHighestObfuscatedBidPrice")&&writer.uint32(17).double(message.secondHighestObfuscatedBidPrice),null!=message.bidDensity&&Object.hasOwnProperty.call(message,"bidDensity")&&writer.uint32(24).int32(message.bidDensity),writer},ProtoAuctionInformation.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoAuctionInformation;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.highestObfuscatedBidPrice=reader.double();break;case 2:message.secondHighestObfuscatedBidPrice=reader.double();break;case 3:message.bidDensity=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoAuctionInformation.fromObject=function(object){if(object instanceof $root.ProtoAuctionInformation)return object;var message=new $root.ProtoAuctionInformation;return null!=object.highestObfuscatedBidPrice&&(message.highestObfuscatedBidPrice=Number(object.highestObfuscatedBidPrice)),null!=object.secondHighestObfuscatedBidPrice&&(message.secondHighestObfuscatedBidPrice=Number(object.secondHighestObfuscatedBidPrice)),null!=object.bidDensity&&(message.bidDensity=0|object.bidDensity),message},ProtoAuctionInformation.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.highestObfuscatedBidPrice=0,object.secondHighestObfuscatedBidPrice=0,object.bidDensity=0),null!=message.highestObfuscatedBidPrice&&message.hasOwnProperty("highestObfuscatedBidPrice")&&(object.highestObfuscatedBidPrice=options.json&&!isFinite(message.highestObfuscatedBidPrice)?String(message.highestObfuscatedBidPrice):message.highestObfuscatedBidPrice),null!=message.secondHighestObfuscatedBidPrice&&message.hasOwnProperty("secondHighestObfuscatedBidPrice")&&(object.secondHighestObfuscatedBidPrice=options.json&&!isFinite(message.secondHighestObfuscatedBidPrice)?String(message.secondHighestObfuscatedBidPrice):message.secondHighestObfuscatedBidPrice),null!=message.bidDensity&&message.hasOwnProperty("bidDensity")&&(object.bidDensity=message.bidDensity),object},ProtoAuctionInformation.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoAuctionInformation}(),$root.ProtoPrebid=function(){function ProtoPrebid(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPrebid.prototype.publisherLineItemId="",ProtoPrebid.prototype.advertiserLineItemId="",ProtoPrebid.prototype.syncedUser=!1,ProtoPrebid.prototype.timeSpent=0,ProtoPrebid.prototype.reason=0,ProtoPrebid.prototype.rtbRequestNumber=0,ProtoPrebid.prototype.partnerReason=0,ProtoPrebid.prototype.requestedFloorPrice=0,ProtoPrebid.prototype.partnerCustomHeaders="",ProtoPrebid.prototype.prebidJsBidderName="",ProtoPrebid.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.publisherLineItemId&&Object.hasOwnProperty.call(message,"publisherLineItemId")&&writer.uint32(10).string(message.publisherLineItemId),null!=message.advertiserLineItemId&&Object.hasOwnProperty.call(message,"advertiserLineItemId")&&writer.uint32(18).string(message.advertiserLineItemId),null!=message.syncedUser&&Object.hasOwnProperty.call(message,"syncedUser")&&writer.uint32(24).bool(message.syncedUser),null!=message.timeSpent&&Object.hasOwnProperty.call(message,"timeSpent")&&writer.uint32(32).int32(message.timeSpent),null!=message.reason&&Object.hasOwnProperty.call(message,"reason")&&writer.uint32(40).int32(message.reason),null!=message.rtbRequestNumber&&Object.hasOwnProperty.call(message,"rtbRequestNumber")&&writer.uint32(48).int32(message.rtbRequestNumber),null!=message.partnerReason&&Object.hasOwnProperty.call(message,"partnerReason")&&writer.uint32(56).int32(message.partnerReason),null!=message.requestedFloorPrice&&Object.hasOwnProperty.call(message,"requestedFloorPrice")&&writer.uint32(65).double(message.requestedFloorPrice),null!=message.partnerCustomHeaders&&Object.hasOwnProperty.call(message,"partnerCustomHeaders")&&writer.uint32(74).string(message.partnerCustomHeaders),null!=message.prebidJsBidderName&&Object.hasOwnProperty.call(message,"prebidJsBidderName")&&writer.uint32(98).string(message.prebidJsBidderName),writer},ProtoPrebid.fromObject=function(object){if(object instanceof $root.ProtoPrebid)return object;var message=new $root.ProtoPrebid;switch(null!=object.publisherLineItemId&&(message.publisherLineItemId=String(object.publisherLineItemId)),null!=object.advertiserLineItemId&&(message.advertiserLineItemId=String(object.advertiserLineItemId)),null!=object.syncedUser&&(message.syncedUser=Boolean(object.syncedUser)),null!=object.timeSpent&&(message.timeSpent=0|object.timeSpent),object.reason){case"RequestException":case 0:message.reason=0;break;case"Timeout":case 1:message.reason=1;break;case"EmptyResponse":case 2:message.reason=2;break;case"InvalidResponse":case 3:message.reason=3;break;case"NoBid":case 4:message.reason=4;break;case"BidBelowFloor":case 5:message.reason=5;break;case"DealIdMismatch":case 6:message.reason=6;break;case"CsInvalidResponse":case 7:message.reason=7;break;case"CsRequestException":case 8:message.reason=8;break;case"CsEmptyResponse":case 9:message.reason=9;break;case"NoLibInPage":case 11:message.reason=11}switch(null!=object.rtbRequestNumber&&(message.rtbRequestNumber=0|object.rtbRequestNumber),object.partnerReason){case"Unknown":case 0:message.partnerReason=0;break;case"TechnicalError":case 1:message.partnerReason=1;break;case"InvalidRequest":case 2:message.partnerReason=2;break;case"KnownWebSpider":case 3:message.partnerReason=3;break;case"SuspectedNonHumanTraffic":case 4:message.partnerReason=4;break;case"CloudIP":case 5:message.partnerReason=5;break;case"UnsupportedDevice":case 6:message.partnerReason=6;break;case"BlockedPublisher":case 7:message.partnerReason=7;break;case"UnmatchedUser":case 8:message.partnerReason=8;break;case"DailyReaderCapMet":case 9:message.partnerReason=9;break;case"DailyDomainCapMet":case 10:message.partnerReason=10}return null!=object.requestedFloorPrice&&(message.requestedFloorPrice=Number(object.requestedFloorPrice)),null!=object.partnerCustomHeaders&&(message.partnerCustomHeaders=String(object.partnerCustomHeaders)),null!=object.prebidJsBidderName&&(message.prebidJsBidderName=String(object.prebidJsBidderName)),message},ProtoPrebid.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoPrebid}(),$root.ProtoBid=function(){function ProtoBid(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoBid.prototype.publisherLineItemId="",ProtoBid.prototype.advertiserLineItemId="",ProtoBid.prototype.syncedUser=!1,ProtoBid.prototype.timeSpent=0,ProtoBid.prototype.rtbRequestNumber=0,ProtoBid.prototype.creativeId="",ProtoBid.prototype.rtbSeatId="",ProtoBid.prototype.rtbAdomain="",ProtoBid.prototype.encryptedPrice="",ProtoBid.prototype.requestedFloorPrice=0,ProtoBid.prototype.prebidJsBidderName="",ProtoBid.prototype.customClientPrice=0,ProtoBid.prototype.dspId="",ProtoBid.prototype.cnxBidId="",ProtoBid.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.publisherLineItemId&&Object.hasOwnProperty.call(message,"publisherLineItemId")&&writer.uint32(10).string(message.publisherLineItemId),null!=message.advertiserLineItemId&&Object.hasOwnProperty.call(message,"advertiserLineItemId")&&writer.uint32(18).string(message.advertiserLineItemId),null!=message.syncedUser&&Object.hasOwnProperty.call(message,"syncedUser")&&writer.uint32(24).bool(message.syncedUser),null!=message.timeSpent&&Object.hasOwnProperty.call(message,"timeSpent")&&writer.uint32(32).int32(message.timeSpent),null!=message.rtbRequestNumber&&Object.hasOwnProperty.call(message,"rtbRequestNumber")&&writer.uint32(40).int32(message.rtbRequestNumber),null!=message.creativeId&&Object.hasOwnProperty.call(message,"creativeId")&&writer.uint32(50).string(message.creativeId),null!=message.rtbSeatId&&Object.hasOwnProperty.call(message,"rtbSeatId")&&writer.uint32(58).string(message.rtbSeatId),null!=message.rtbAdomain&&Object.hasOwnProperty.call(message,"rtbAdomain")&&writer.uint32(66).string(message.rtbAdomain),null!=message.encryptedPrice&&Object.hasOwnProperty.call(message,"encryptedPrice")&&writer.uint32(74).string(message.encryptedPrice),null!=message.requestedFloorPrice&&Object.hasOwnProperty.call(message,"requestedFloorPrice")&&writer.uint32(81).double(message.requestedFloorPrice),null!=message.prebidJsBidderName&&Object.hasOwnProperty.call(message,"prebidJsBidderName")&&writer.uint32(106).string(message.prebidJsBidderName),null!=message.customClientPrice&&Object.hasOwnProperty.call(message,"customClientPrice")&&writer.uint32(113).double(message.customClientPrice),null!=message.dspId&&Object.hasOwnProperty.call(message,"dspId")&&writer.uint32(122).string(message.dspId),null!=message.cnxBidId&&Object.hasOwnProperty.call(message,"cnxBidId")&&writer.uint32(130).string(message.cnxBidId),writer},ProtoBid.fromObject=function(object){if(object instanceof $root.ProtoBid)return object;var message=new $root.ProtoBid;return null!=object.publisherLineItemId&&(message.publisherLineItemId=String(object.publisherLineItemId)),null!=object.advertiserLineItemId&&(message.advertiserLineItemId=String(object.advertiserLineItemId)),null!=object.syncedUser&&(message.syncedUser=Boolean(object.syncedUser)),null!=object.timeSpent&&(message.timeSpent=0|object.timeSpent),null!=object.rtbRequestNumber&&(message.rtbRequestNumber=0|object.rtbRequestNumber),null!=object.creativeId&&(message.creativeId=String(object.creativeId)),null!=object.rtbSeatId&&(message.rtbSeatId=String(object.rtbSeatId)),null!=object.rtbAdomain&&(message.rtbAdomain=String(object.rtbAdomain)),null!=object.encryptedPrice&&(message.encryptedPrice=String(object.encryptedPrice)),null!=object.requestedFloorPrice&&(message.requestedFloorPrice=Number(object.requestedFloorPrice)),null!=object.prebidJsBidderName&&(message.prebidJsBidderName=String(object.prebidJsBidderName)),null!=object.customClientPrice&&(message.customClientPrice=Number(object.customClientPrice)),null!=object.dspId&&(message.dspId=String(object.dspId)),null!=object.cnxBidId&&(message.cnxBidId=String(object.cnxBidId)),message},ProtoBid.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoBid}(),$root.ProtoPostBid=function(){function ProtoPostBid(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPostBid.prototype.publisherLineItemId="",ProtoPostBid.prototype.advertiserLineItemId="",ProtoPostBid.prototype.syncedUser=!1,ProtoPostBid.prototype.timeSpent=0,ProtoPostBid.prototype.error="",ProtoPostBid.prototype.loaded=!1,ProtoPostBid.prototype.creativeId="",ProtoPostBid.prototype.rtbSeatId="",ProtoPostBid.prototype.rtbAdomain="",ProtoPostBid.prototype.adsourceType=0,ProtoPostBid.prototype.vastMediaType="",ProtoPostBid.prototype.adPodSlotPosition=0,ProtoPostBid.prototype.prebidJsBidderName="",ProtoPostBid.prototype.dspId="",ProtoPostBid.prototype.cnxBidId="",ProtoPostBid.prototype.winToAdLoadedTime=0,ProtoPostBid.prototype.auctionInformation=null,ProtoPostBid.prototype.auctionPostbidReason=0,ProtoPostBid.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.publisherLineItemId&&Object.hasOwnProperty.call(message,"publisherLineItemId")&&writer.uint32(10).string(message.publisherLineItemId),null!=message.advertiserLineItemId&&Object.hasOwnProperty.call(message,"advertiserLineItemId")&&writer.uint32(18).string(message.advertiserLineItemId),null!=message.syncedUser&&Object.hasOwnProperty.call(message,"syncedUser")&&writer.uint32(24).bool(message.syncedUser),null!=message.timeSpent&&Object.hasOwnProperty.call(message,"timeSpent")&&writer.uint32(32).int32(message.timeSpent),null!=message.error&&Object.hasOwnProperty.call(message,"error")&&writer.uint32(42).string(message.error),null!=message.loaded&&Object.hasOwnProperty.call(message,"loaded")&&writer.uint32(48).bool(message.loaded),null!=message.creativeId&&Object.hasOwnProperty.call(message,"creativeId")&&writer.uint32(58).string(message.creativeId),null!=message.rtbSeatId&&Object.hasOwnProperty.call(message,"rtbSeatId")&&writer.uint32(66).string(message.rtbSeatId),null!=message.rtbAdomain&&Object.hasOwnProperty.call(message,"rtbAdomain")&&writer.uint32(74).string(message.rtbAdomain),null!=message.adsourceType&&Object.hasOwnProperty.call(message,"adsourceType")&&writer.uint32(80).int32(message.adsourceType),null!=message.vastMediaType&&Object.hasOwnProperty.call(message,"vastMediaType")&&writer.uint32(90).string(message.vastMediaType),null!=message.adPodSlotPosition&&Object.hasOwnProperty.call(message,"adPodSlotPosition")&&writer.uint32(96).int32(message.adPodSlotPosition),null!=message.prebidJsBidderName&&Object.hasOwnProperty.call(message,"prebidJsBidderName")&&writer.uint32(106).string(message.prebidJsBidderName),null!=message.dspId&&Object.hasOwnProperty.call(message,"dspId")&&writer.uint32(114).string(message.dspId),null!=message.cnxBidId&&Object.hasOwnProperty.call(message,"cnxBidId")&&writer.uint32(122).string(message.cnxBidId),null!=message.winToAdLoadedTime&&Object.hasOwnProperty.call(message,"winToAdLoadedTime")&&writer.uint32(128).int32(message.winToAdLoadedTime),null!=message.auctionInformation&&Object.hasOwnProperty.call(message,"auctionInformation")&&$root.ProtoAuctionInformation.encode(message.auctionInformation,writer.uint32(146).fork()).ldelim(),null!=message.auctionPostbidReason&&Object.hasOwnProperty.call(message,"auctionPostbidReason")&&writer.uint32(152).int32(message.auctionPostbidReason),writer},ProtoPostBid.fromObject=function(object){if(object instanceof $root.ProtoPostBid)return object;var message=new $root.ProtoPostBid;switch(null!=object.publisherLineItemId&&(message.publisherLineItemId=String(object.publisherLineItemId)),null!=object.advertiserLineItemId&&(message.advertiserLineItemId=String(object.advertiserLineItemId)),null!=object.syncedUser&&(message.syncedUser=Boolean(object.syncedUser)),null!=object.timeSpent&&(message.timeSpent=0|object.timeSpent),null!=object.error&&(message.error=String(object.error)),null!=object.loaded&&(message.loaded=Boolean(object.loaded)),null!=object.creativeId&&(message.creativeId=String(object.creativeId)),null!=object.rtbSeatId&&(message.rtbSeatId=String(object.rtbSeatId)),null!=object.rtbAdomain&&(message.rtbAdomain=String(object.rtbAdomain)),object.adsourceType){case"Unknown":case 0:message.adsourceType=0;break;case"Vpaid":case 1:message.adsourceType=1;break;case"VastMedia":case 2:message.adsourceType=2;break;case"CnxMedia":case 3:message.adsourceType=3;break;case"Jw":case 4:message.adsourceType=4;break;case"Ima":case 5:message.adsourceType=5;break;case"AOL":case 6:message.adsourceType=6}if(null!=object.vastMediaType&&(message.vastMediaType=String(object.vastMediaType)),null!=object.adPodSlotPosition&&(message.adPodSlotPosition=0|object.adPodSlotPosition),null!=object.prebidJsBidderName&&(message.prebidJsBidderName=String(object.prebidJsBidderName)),null!=object.dspId&&(message.dspId=String(object.dspId)),null!=object.cnxBidId&&(message.cnxBidId=String(object.cnxBidId)),null!=object.winToAdLoadedTime&&(message.winToAdLoadedTime=0|object.winToAdLoadedTime),null!=object.auctionInformation){if("object"!=typeof object.auctionInformation)throw TypeError(".ProtoPostBid.auctionInformation: object expected");message.auctionInformation=$root.ProtoAuctionInformation.fromObject(object.auctionInformation)}switch(object.auctionPostbidReason){case"CreativeError":case 0:message.auctionPostbidReason=0;break;case"SDKFailure":case 1:message.auctionPostbidReason=1;break;case"UnsupportedMedia":case 2:message.auctionPostbidReason=2;break;case"TargetingMismatch":case 3:message.auctionPostbidReason=3;break;case"PlayerError":case 4:message.auctionPostbidReason=4}return message},ProtoPostBid.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoPostBid}(),$root.ProtoBidTrackingsRequest=function(){function ProtoBidTrackingsRequest(properties){if(this.prebids=[],this.bids=[],this.postBids=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoBidTrackingsRequest.prototype.trackingRequestMeta=null,ProtoBidTrackingsRequest.prototype.mediaGuid="",ProtoBidTrackingsRequest.prototype.prebids=$util.emptyArray,ProtoBidTrackingsRequest.prototype.bids=$util.emptyArray,ProtoBidTrackingsRequest.prototype.postBids=$util.emptyArray,ProtoBidTrackingsRequest.prototype.logEveryting=!1,ProtoBidTrackingsRequest.prototype.hasGdprConsentPayload=!1,ProtoBidTrackingsRequest.prototype.gdprConsentMode=0,ProtoBidTrackingsRequest.prototype.useExploration=!1,ProtoBidTrackingsRequest.encode=function(message,writer){if(writer||(writer=$Writer.create()),null!=message.trackingRequestMeta&&Object.hasOwnProperty.call(message,"trackingRequestMeta")&&$root.MetadataModel.encode(message.trackingRequestMeta,writer.uint32(10).fork()).ldelim(),null!=message.mediaGuid&&Object.hasOwnProperty.call(message,"mediaGuid")&&writer.uint32(18).string(message.mediaGuid),null!=message.prebids&&message.prebids.length)for(var i=0;i<message.prebids.length;++i)$root.ProtoPrebid.encode(message.prebids[i],writer.uint32(34).fork()).ldelim();if(null!=message.bids&&message.bids.length)for(i=0;i<message.bids.length;++i)$root.ProtoBid.encode(message.bids[i],writer.uint32(42).fork()).ldelim();if(null!=message.postBids&&message.postBids.length)for(i=0;i<message.postBids.length;++i)$root.ProtoPostBid.encode(message.postBids[i],writer.uint32(50).fork()).ldelim();return null!=message.logEveryting&&Object.hasOwnProperty.call(message,"logEveryting")&&writer.uint32(56).bool(message.logEveryting),null!=message.hasGdprConsentPayload&&Object.hasOwnProperty.call(message,"hasGdprConsentPayload")&&writer.uint32(80).bool(message.hasGdprConsentPayload),null!=message.gdprConsentMode&&Object.hasOwnProperty.call(message,"gdprConsentMode")&&writer.uint32(88).int32(message.gdprConsentMode),null!=message.useExploration&&Object.hasOwnProperty.call(message,"useExploration")&&writer.uint32(96).bool(message.useExploration),writer},ProtoBidTrackingsRequest.fromObject=function(object){if(object instanceof $root.ProtoBidTrackingsRequest)return object;var message=new $root.ProtoBidTrackingsRequest;if(null!=object.trackingRequestMeta){if("object"!=typeof object.trackingRequestMeta)throw TypeError(".ProtoBidTrackingsRequest.trackingRequestMeta: object expected");message.trackingRequestMeta=$root.MetadataModel.fromObject(object.trackingRequestMeta)}if(null!=object.mediaGuid&&(message.mediaGuid=String(object.mediaGuid)),object.prebids){if(!Array.isArray(object.prebids))throw TypeError(".ProtoBidTrackingsRequest.prebids: array expected");message.prebids=[];for(var i=0;i<object.prebids.length;++i){if("object"!=typeof object.prebids[i])throw TypeError(".ProtoBidTrackingsRequest.prebids: object expected");message.prebids[i]=$root.ProtoPrebid.fromObject(object.prebids[i])}}if(object.bids){if(!Array.isArray(object.bids))throw TypeError(".ProtoBidTrackingsRequest.bids: array expected");message.bids=[];for(i=0;i<object.bids.length;++i){if("object"!=typeof object.bids[i])throw TypeError(".ProtoBidTrackingsRequest.bids: object expected");message.bids[i]=$root.ProtoBid.fromObject(object.bids[i])}}if(object.postBids){if(!Array.isArray(object.postBids))throw TypeError(".ProtoBidTrackingsRequest.postBids: array expected");message.postBids=[];for(i=0;i<object.postBids.length;++i){if("object"!=typeof object.postBids[i])throw TypeError(".ProtoBidTrackingsRequest.postBids: object expected");message.postBids[i]=$root.ProtoPostBid.fromObject(object.postBids[i])}}switch(null!=object.logEveryting&&(message.logEveryting=Boolean(object.logEveryting)),null!=object.hasGdprConsentPayload&&(message.hasGdprConsentPayload=Boolean(object.hasGdprConsentPayload)),object.gdprConsentMode){case"Unknown":case 0:message.gdprConsentMode=0;break;case"NoCmp":case 1:message.gdprConsentMode=1;break;case"NoConsent":case 2:message.gdprConsentMode=2;break;case"NoConnatixConsent":case 3:message.gdprConsentMode=3;break;case"NotAllDemandConsent":case 4:message.gdprConsentMode=4;break;case"AllGood":case 5:message.gdprConsentMode=5}return null!=object.useExploration&&(message.useExploration=Boolean(object.useExploration)),message},ProtoBidTrackingsRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoBidTrackingsRequest}(),$root.ProtoHeavyAdTrackingRequest=function(){function ProtoHeavyAdTrackingRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoHeavyAdTrackingRequest.prototype.trackingRequestMeta=null,ProtoHeavyAdTrackingRequest.prototype.advertiserLineItemId="",ProtoHeavyAdTrackingRequest.prototype.heavyAdBlockTypeEnum=0,ProtoHeavyAdTrackingRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.trackingRequestMeta&&Object.hasOwnProperty.call(message,"trackingRequestMeta")&&$root.MetadataModel.encode(message.trackingRequestMeta,writer.uint32(10).fork()).ldelim(),null!=message.advertiserLineItemId&&Object.hasOwnProperty.call(message,"advertiserLineItemId")&&writer.uint32(18).string(message.advertiserLineItemId),null!=message.heavyAdBlockTypeEnum&&Object.hasOwnProperty.call(message,"heavyAdBlockTypeEnum")&&writer.uint32(24).int32(message.heavyAdBlockTypeEnum),writer},ProtoHeavyAdTrackingRequest.fromObject=function(object){if(object instanceof $root.ProtoHeavyAdTrackingRequest)return object;var message=new $root.ProtoHeavyAdTrackingRequest;if(null!=object.trackingRequestMeta){if("object"!=typeof object.trackingRequestMeta)throw TypeError(".ProtoHeavyAdTrackingRequest.trackingRequestMeta: object expected");message.trackingRequestMeta=$root.MetadataModel.fromObject(object.trackingRequestMeta)}switch(null!=object.advertiserLineItemId&&(message.advertiserLineItemId=String(object.advertiserLineItemId)),object.heavyAdBlockTypeEnum){case"Global":case 0:message.heavyAdBlockTypeEnum=0;break;case"Script":case 1:message.heavyAdBlockTypeEnum=1;break;case"VpaidIframe":case 2:message.heavyAdBlockTypeEnum=2;break;case"OverlayIframe":case 3:message.heavyAdBlockTypeEnum=3}return message},ProtoHeavyAdTrackingRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoHeavyAdTrackingRequest}(),$root.ProtoMediaClickTrackingRequest=function(){function ProtoMediaClickTrackingRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoMediaClickTrackingRequest.prototype.trackingRequestMeta=null,ProtoMediaClickTrackingRequest.prototype.mediaGuid="",ProtoMediaClickTrackingRequest.prototype.type=0,ProtoMediaClickTrackingRequest.prototype.clickUrl="",ProtoMediaClickTrackingRequest.prototype.slideTitle="",ProtoMediaClickTrackingRequest.prototype.slideNumber=0,ProtoMediaClickTrackingRequest.prototype.slideMediaType=0,ProtoMediaClickTrackingRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.trackingRequestMeta&&Object.hasOwnProperty.call(message,"trackingRequestMeta")&&$root.MetadataModel.encode(message.trackingRequestMeta,writer.uint32(10).fork()).ldelim(),null!=message.mediaGuid&&Object.hasOwnProperty.call(message,"mediaGuid")&&writer.uint32(18).string(message.mediaGuid),null!=message.type&&Object.hasOwnProperty.call(message,"type")&&writer.uint32(24).int32(message.type),null!=message.clickUrl&&Object.hasOwnProperty.call(message,"clickUrl")&&writer.uint32(34).string(message.clickUrl),null!=message.slideTitle&&Object.hasOwnProperty.call(message,"slideTitle")&&writer.uint32(42).string(message.slideTitle),null!=message.slideNumber&&Object.hasOwnProperty.call(message,"slideNumber")&&writer.uint32(48).int32(message.slideNumber),null!=message.slideMediaType&&Object.hasOwnProperty.call(message,"slideMediaType")&&writer.uint32(56).int32(message.slideMediaType),writer},ProtoMediaClickTrackingRequest.fromObject=function(object){if(object instanceof $root.ProtoMediaClickTrackingRequest)return object;var message=new $root.ProtoMediaClickTrackingRequest;if(null!=object.trackingRequestMeta){if("object"!=typeof object.trackingRequestMeta)throw TypeError(".ProtoMediaClickTrackingRequest.trackingRequestMeta: object expected");message.trackingRequestMeta=$root.MetadataModel.fromObject(object.trackingRequestMeta)}switch(null!=object.mediaGuid&&(message.mediaGuid=String(object.mediaGuid)),object.type){case"Click":case 0:message.type=0;break;case"UrlClick":case 1:message.type=1;break;case"VolumeClick":case 2:message.type=2;break;case"PlayClick":case 3:message.type=3;break;case"PauseClick":case 4:message.type=4;break;case"NextClick":case 5:message.type=5;break;case"PreviousClick":case 6:message.type=6;break;case"MuteClick":case 7:message.type=7;break;case"UnmuteClick":case 8:message.type=8;break;case"CloseClick":case 9:message.type=9;break;case"ScrollClick":case 10:message.type=10;break;case"GalleryClick":case 11:message.type=11;break;case"SubtitleClick":case 12:message.type=12;break;case"FullScreenClick":case 13:message.type=13;break;case"ExitFullScreenClick":case 14:message.type=14}switch(null!=object.clickUrl&&(message.clickUrl=String(object.clickUrl)),null!=object.slideTitle&&(message.slideTitle=String(object.slideTitle)),null!=object.slideNumber&&(message.slideNumber=0|object.slideNumber),object.slideMediaType){case"Image":case 0:message.slideMediaType=0;break;case"Video":case 1:message.slideMediaType=1}return message},ProtoMediaClickTrackingRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoMediaClickTrackingRequest}(),$root.ProtoMediaTrackingRequest=function(){function ProtoMediaTrackingRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoMediaTrackingRequest.prototype.trackingRequestMeta=null,ProtoMediaTrackingRequest.prototype.mediaGuid="",ProtoMediaTrackingRequest.prototype.quartile=0,ProtoMediaTrackingRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.trackingRequestMeta&&Object.hasOwnProperty.call(message,"trackingRequestMeta")&&$root.MetadataModel.encode(message.trackingRequestMeta,writer.uint32(10).fork()).ldelim(),null!=message.mediaGuid&&Object.hasOwnProperty.call(message,"mediaGuid")&&writer.uint32(18).string(message.mediaGuid),null!=message.quartile&&Object.hasOwnProperty.call(message,"quartile")&&writer.uint32(32).int32(message.quartile),writer},ProtoMediaTrackingRequest.fromObject=function(object){if(object instanceof $root.ProtoMediaTrackingRequest)return object;var message=new $root.ProtoMediaTrackingRequest;if(null!=object.trackingRequestMeta){if("object"!=typeof object.trackingRequestMeta)throw TypeError(".ProtoMediaTrackingRequest.trackingRequestMeta: object expected");message.trackingRequestMeta=$root.MetadataModel.fromObject(object.trackingRequestMeta)}switch(null!=object.mediaGuid&&(message.mediaGuid=String(object.mediaGuid)),object.quartile){case"Start":case 0:message.quartile=0;break;case"First":case 1:message.quartile=1;break;case"Second":case 2:message.quartile=2;break;case"Third":case 3:message.quartile=3;break;case"Fourth":case 4:message.quartile=4}return message},ProtoMediaTrackingRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoMediaTrackingRequest}(),$root.ProtoSessionAdBlockerRequest=function(){function ProtoSessionAdBlockerRequest(properties){if(this.dynamicElkFieldsValues={},properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoSessionAdBlockerRequest.prototype.trackingRequestMeta=null,ProtoSessionAdBlockerRequest.prototype.adBlockDetectionType=0,ProtoSessionAdBlockerRequest.prototype.dynamicElkFieldsValues=$util.emptyObject,ProtoSessionAdBlockerRequest.encode=function(message,writer){if(writer||(writer=$Writer.create()),null!=message.trackingRequestMeta&&Object.hasOwnProperty.call(message,"trackingRequestMeta")&&$root.MetadataModel.encode(message.trackingRequestMeta,writer.uint32(10).fork()).ldelim(),null!=message.adBlockDetectionType&&Object.hasOwnProperty.call(message,"adBlockDetectionType")&&writer.uint32(16).int32(message.adBlockDetectionType),null!=message.dynamicElkFieldsValues&&Object.hasOwnProperty.call(message,"dynamicElkFieldsValues"))for(var keys=Object.keys(message.dynamicElkFieldsValues),i=0;i<keys.length;++i)writer.uint32(802).fork().uint32(10).string(keys[i]).uint32(18).string(message.dynamicElkFieldsValues[keys[i]]).ldelim();return writer},ProtoSessionAdBlockerRequest.fromObject=function(object){if(object instanceof $root.ProtoSessionAdBlockerRequest)return object;var message=new $root.ProtoSessionAdBlockerRequest;if(null!=object.trackingRequestMeta){if("object"!=typeof object.trackingRequestMeta)throw TypeError(".ProtoSessionAdBlockerRequest.trackingRequestMeta: object expected");message.trackingRequestMeta=$root.MetadataModel.fromObject(object.trackingRequestMeta)}switch(object.adBlockDetectionType){case"Banner":case 0:message.adBlockDetectionType=0;break;case"Network":case 1:message.adBlockDetectionType=1}if(object.dynamicElkFieldsValues){if("object"!=typeof object.dynamicElkFieldsValues)throw TypeError(".ProtoSessionAdBlockerRequest.dynamicElkFieldsValues: object expected");message.dynamicElkFieldsValues={};for(var keys=Object.keys(object.dynamicElkFieldsValues),i=0;i<keys.length;++i)message.dynamicElkFieldsValues[keys[i]]=String(object.dynamicElkFieldsValues[keys[i]])}return message},ProtoSessionAdBlockerRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoSessionAdBlockerRequest}(),$root.ProtoSessionTimeTrackingRequest=function(){function ProtoSessionTimeTrackingRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoSessionTimeTrackingRequest.prototype.trackingRequestMeta=null,ProtoSessionTimeTrackingRequest.prototype.timePlayed=0,ProtoSessionTimeTrackingRequest.prototype.timePlayedInView=0,ProtoSessionTimeTrackingRequest.prototype.sessionTime=0,ProtoSessionTimeTrackingRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.trackingRequestMeta&&Object.hasOwnProperty.call(message,"trackingRequestMeta")&&$root.MetadataModel.encode(message.trackingRequestMeta,writer.uint32(10).fork()).ldelim(),null!=message.timePlayed&&Object.hasOwnProperty.call(message,"timePlayed")&&writer.uint32(16).int32(message.timePlayed),null!=message.timePlayedInView&&Object.hasOwnProperty.call(message,"timePlayedInView")&&writer.uint32(24).int32(message.timePlayedInView),null!=message.sessionTime&&Object.hasOwnProperty.call(message,"sessionTime")&&writer.uint32(32).int32(message.sessionTime),writer},ProtoSessionTimeTrackingRequest.fromObject=function(object){if(object instanceof $root.ProtoSessionTimeTrackingRequest)return object;var message=new $root.ProtoSessionTimeTrackingRequest;if(null!=object.trackingRequestMeta){if("object"!=typeof object.trackingRequestMeta)throw TypeError(".ProtoSessionTimeTrackingRequest.trackingRequestMeta: object expected");message.trackingRequestMeta=$root.MetadataModel.fromObject(object.trackingRequestMeta)}return null!=object.timePlayed&&(message.timePlayed=0|object.timePlayed),null!=object.timePlayedInView&&(message.timePlayedInView=0|object.timePlayedInView),null!=object.sessionTime&&(message.sessionTime=0|object.sessionTime),message},ProtoSessionTimeTrackingRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoSessionTimeTrackingRequest}(),$root.ProtoTrackingRequest=function(){function ProtoTrackingRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoTrackingRequest.prototype.trackingRequestMeta=null,ProtoTrackingRequest.prototype.hasAdBlocker=!1,ProtoTrackingRequest.prototype.bundleName="",ProtoTrackingRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.trackingRequestMeta&&Object.hasOwnProperty.call(message,"trackingRequestMeta")&&$root.MetadataModel.encode(message.trackingRequestMeta,writer.uint32(10).fork()).ldelim(),null!=message.hasAdBlocker&&Object.hasOwnProperty.call(message,"hasAdBlocker")&&writer.uint32(32).bool(message.hasAdBlocker),null!=message.bundleName&&Object.hasOwnProperty.call(message,"bundleName")&&writer.uint32(42).string(message.bundleName),writer},ProtoTrackingRequest.fromObject=function(object){if(object instanceof $root.ProtoTrackingRequest)return object;var message=new $root.ProtoTrackingRequest;if(null!=object.trackingRequestMeta){if("object"!=typeof object.trackingRequestMeta)throw TypeError(".ProtoTrackingRequest.trackingRequestMeta: object expected");message.trackingRequestMeta=$root.MetadataModel.fromObject(object.trackingRequestMeta)}return null!=object.hasAdBlocker&&(message.hasAdBlocker=Boolean(object.hasAdBlocker)),null!=object.bundleName&&(message.bundleName=String(object.bundleName)),message},ProtoTrackingRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoTrackingRequest}(),$root.ProtoTrackingResponse=function(){function ProtoTrackingResponse(properties){if(this.platformCappedLineItemIdList=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoTrackingResponse.prototype.errorMessage="",ProtoTrackingResponse.prototype.platformCappedLineItemIdList=$util.emptyArray,ProtoTrackingResponse.prototype.impressionRevenue=0,ProtoTrackingResponse.prototype.adServerLineItemName="",ProtoTrackingResponse.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoTrackingResponse;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.errorMessage=reader.string();break;case 2:message.platformCappedLineItemIdList&&message.platformCappedLineItemIdList.length||(message.platformCappedLineItemIdList=[]),message.platformCappedLineItemIdList.push(reader.string());break;case 3:message.impressionRevenue=reader.double();break;case 4:message.adServerLineItemName=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoTrackingResponse.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.platformCappedLineItemIdList=[]),options.defaults&&(object.errorMessage="",object.impressionRevenue=0,object.adServerLineItemName=""),null!=message.errorMessage&&message.hasOwnProperty("errorMessage")&&(object.errorMessage=message.errorMessage),message.platformCappedLineItemIdList&&message.platformCappedLineItemIdList.length){object.platformCappedLineItemIdList=[];for(var j=0;j<message.platformCappedLineItemIdList.length;++j)object.platformCappedLineItemIdList[j]=message.platformCappedLineItemIdList[j]}return null!=message.impressionRevenue&&message.hasOwnProperty("impressionRevenue")&&(object.impressionRevenue=options.json&&!isFinite(message.impressionRevenue)?String(message.impressionRevenue):message.impressionRevenue),null!=message.adServerLineItemName&&message.hasOwnProperty("adServerLineItemName")&&(object.adServerLineItemName=message.adServerLineItemName),object},ProtoTrackingResponse}(),$root.ProtoVideoAdImpressionRequest=function(){function ProtoVideoAdImpressionRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoVideoAdImpressionRequest.prototype.trackingRequestMeta=null,ProtoVideoAdImpressionRequest.prototype.mediaGuid="",ProtoVideoAdImpressionRequest.prototype.publisherLineItemId="",ProtoVideoAdImpressionRequest.prototype.advertiserLineItemId="",ProtoVideoAdImpressionRequest.prototype.syncedUser=!1,ProtoVideoAdImpressionRequest.prototype.timeSpent=0,ProtoVideoAdImpressionRequest.prototype.encryptedPrice="",ProtoVideoAdImpressionRequest.prototype.creativeId="",ProtoVideoAdImpressionRequest.prototype.rtbSeatId="",ProtoVideoAdImpressionRequest.prototype.rtbAdomain="",ProtoVideoAdImpressionRequest.prototype.customClientPrice=0,ProtoVideoAdImpressionRequest.prototype.adsourceType=0,ProtoVideoAdImpressionRequest.prototype.vastMediaType="",ProtoVideoAdImpressionRequest.prototype.adPodSlotPosition=0,ProtoVideoAdImpressionRequest.prototype.prebidJsBidderName="",ProtoVideoAdImpressionRequest.prototype.dspId="",ProtoVideoAdImpressionRequest.prototype.cnxBidId="",ProtoVideoAdImpressionRequest.prototype.winToAdLoadedTime=0,ProtoVideoAdImpressionRequest.prototype.startAdToImpressionTime=0,ProtoVideoAdImpressionRequest.prototype.declaredDuration=0,ProtoVideoAdImpressionRequest.prototype.impressionDuration=0,ProtoVideoAdImpressionRequest.prototype.useExploration=!1,ProtoVideoAdImpressionRequest.prototype.auctionInformation=null,ProtoVideoAdImpressionRequest.prototype.playerWidth=0,ProtoVideoAdImpressionRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.trackingRequestMeta&&Object.hasOwnProperty.call(message,"trackingRequestMeta")&&$root.MetadataModel.encode(message.trackingRequestMeta,writer.uint32(10).fork()).ldelim(),null!=message.mediaGuid&&Object.hasOwnProperty.call(message,"mediaGuid")&&writer.uint32(26).string(message.mediaGuid),null!=message.publisherLineItemId&&Object.hasOwnProperty.call(message,"publisherLineItemId")&&writer.uint32(42).string(message.publisherLineItemId),null!=message.advertiserLineItemId&&Object.hasOwnProperty.call(message,"advertiserLineItemId")&&writer.uint32(50).string(message.advertiserLineItemId),null!=message.syncedUser&&Object.hasOwnProperty.call(message,"syncedUser")&&writer.uint32(56).bool(message.syncedUser),null!=message.timeSpent&&Object.hasOwnProperty.call(message,"timeSpent")&&writer.uint32(64).int32(message.timeSpent),null!=message.encryptedPrice&&Object.hasOwnProperty.call(message,"encryptedPrice")&&writer.uint32(74).string(message.encryptedPrice),null!=message.creativeId&&Object.hasOwnProperty.call(message,"creativeId")&&writer.uint32(82).string(message.creativeId),null!=message.rtbSeatId&&Object.hasOwnProperty.call(message,"rtbSeatId")&&writer.uint32(90).string(message.rtbSeatId),null!=message.rtbAdomain&&Object.hasOwnProperty.call(message,"rtbAdomain")&&writer.uint32(98).string(message.rtbAdomain),null!=message.customClientPrice&&Object.hasOwnProperty.call(message,"customClientPrice")&&writer.uint32(105).double(message.customClientPrice),null!=message.adsourceType&&Object.hasOwnProperty.call(message,"adsourceType")&&writer.uint32(112).int32(message.adsourceType),null!=message.vastMediaType&&Object.hasOwnProperty.call(message,"vastMediaType")&&writer.uint32(122).string(message.vastMediaType),null!=message.adPodSlotPosition&&Object.hasOwnProperty.call(message,"adPodSlotPosition")&&writer.uint32(144).int32(message.adPodSlotPosition),null!=message.prebidJsBidderName&&Object.hasOwnProperty.call(message,"prebidJsBidderName")&&writer.uint32(154).string(message.prebidJsBidderName),null!=message.dspId&&Object.hasOwnProperty.call(message,"dspId")&&writer.uint32(162).string(message.dspId),null!=message.cnxBidId&&Object.hasOwnProperty.call(message,"cnxBidId")&&writer.uint32(170).string(message.cnxBidId),null!=message.winToAdLoadedTime&&Object.hasOwnProperty.call(message,"winToAdLoadedTime")&&writer.uint32(176).int32(message.winToAdLoadedTime),null!=message.startAdToImpressionTime&&Object.hasOwnProperty.call(message,"startAdToImpressionTime")&&writer.uint32(184).int32(message.startAdToImpressionTime),null!=message.declaredDuration&&Object.hasOwnProperty.call(message,"declaredDuration")&&writer.uint32(193).double(message.declaredDuration),null!=message.impressionDuration&&Object.hasOwnProperty.call(message,"impressionDuration")&&writer.uint32(201).double(message.impressionDuration),null!=message.useExploration&&Object.hasOwnProperty.call(message,"useExploration")&&writer.uint32(208).bool(message.useExploration),null!=message.auctionInformation&&Object.hasOwnProperty.call(message,"auctionInformation")&&$root.ProtoAuctionInformation.encode(message.auctionInformation,writer.uint32(218).fork()).ldelim(),null!=message.playerWidth&&Object.hasOwnProperty.call(message,"playerWidth")&&writer.uint32(224).int32(message.playerWidth),writer},ProtoVideoAdImpressionRequest.fromObject=function(object){if(object instanceof $root.ProtoVideoAdImpressionRequest)return object;var message=new $root.ProtoVideoAdImpressionRequest;if(null!=object.trackingRequestMeta){if("object"!=typeof object.trackingRequestMeta)throw TypeError(".ProtoVideoAdImpressionRequest.trackingRequestMeta: object expected");message.trackingRequestMeta=$root.MetadataModel.fromObject(object.trackingRequestMeta)}switch(null!=object.mediaGuid&&(message.mediaGuid=String(object.mediaGuid)),null!=object.publisherLineItemId&&(message.publisherLineItemId=String(object.publisherLineItemId)),null!=object.advertiserLineItemId&&(message.advertiserLineItemId=String(object.advertiserLineItemId)),null!=object.syncedUser&&(message.syncedUser=Boolean(object.syncedUser)),null!=object.timeSpent&&(message.timeSpent=0|object.timeSpent),null!=object.encryptedPrice&&(message.encryptedPrice=String(object.encryptedPrice)),null!=object.creativeId&&(message.creativeId=String(object.creativeId)),null!=object.rtbSeatId&&(message.rtbSeatId=String(object.rtbSeatId)),null!=object.rtbAdomain&&(message.rtbAdomain=String(object.rtbAdomain)),null!=object.customClientPrice&&(message.customClientPrice=Number(object.customClientPrice)),object.adsourceType){case"Unknown":case 0:message.adsourceType=0;break;case"Vpaid":case 1:message.adsourceType=1;break;case"VastMedia":case 2:message.adsourceType=2;break;case"CnxMedia":case 3:message.adsourceType=3;break;case"Jw":case 4:message.adsourceType=4;break;case"Ima":case 5:message.adsourceType=5;break;case"AOL":case 6:message.adsourceType=6}if(null!=object.vastMediaType&&(message.vastMediaType=String(object.vastMediaType)),null!=object.adPodSlotPosition&&(message.adPodSlotPosition=0|object.adPodSlotPosition),null!=object.prebidJsBidderName&&(message.prebidJsBidderName=String(object.prebidJsBidderName)),null!=object.dspId&&(message.dspId=String(object.dspId)),null!=object.cnxBidId&&(message.cnxBidId=String(object.cnxBidId)),null!=object.winToAdLoadedTime&&(message.winToAdLoadedTime=0|object.winToAdLoadedTime),null!=object.startAdToImpressionTime&&(message.startAdToImpressionTime=0|object.startAdToImpressionTime),null!=object.declaredDuration&&(message.declaredDuration=Number(object.declaredDuration)),null!=object.impressionDuration&&(message.impressionDuration=Number(object.impressionDuration)),null!=object.useExploration&&(message.useExploration=Boolean(object.useExploration)),null!=object.auctionInformation){if("object"!=typeof object.auctionInformation)throw TypeError(".ProtoVideoAdImpressionRequest.auctionInformation: object expected");message.auctionInformation=$root.ProtoAuctionInformation.fromObject(object.auctionInformation)}return null!=object.playerWidth&&(message.playerWidth=0|object.playerWidth),message},ProtoVideoAdImpressionRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoVideoAdImpressionRequest}(),$root.ProtoVideoAdImpressionViewableRequest=function(){function ProtoVideoAdImpressionViewableRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoVideoAdImpressionViewableRequest.prototype.trackingRequestMeta=null,ProtoVideoAdImpressionViewableRequest.prototype.mediaGuid="",ProtoVideoAdImpressionViewableRequest.prototype.publisherLineItemId="",ProtoVideoAdImpressionViewableRequest.prototype.advertiserLineItemId="",ProtoVideoAdImpressionViewableRequest.prototype.rtbSeatId="",ProtoVideoAdImpressionViewableRequest.prototype.dspId="",ProtoVideoAdImpressionViewableRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.trackingRequestMeta&&Object.hasOwnProperty.call(message,"trackingRequestMeta")&&$root.MetadataModel.encode(message.trackingRequestMeta,writer.uint32(10).fork()).ldelim(),null!=message.mediaGuid&&Object.hasOwnProperty.call(message,"mediaGuid")&&writer.uint32(26).string(message.mediaGuid),null!=message.publisherLineItemId&&Object.hasOwnProperty.call(message,"publisherLineItemId")&&writer.uint32(42).string(message.publisherLineItemId),null!=message.advertiserLineItemId&&Object.hasOwnProperty.call(message,"advertiserLineItemId")&&writer.uint32(50).string(message.advertiserLineItemId),null!=message.rtbSeatId&&Object.hasOwnProperty.call(message,"rtbSeatId")&&writer.uint32(58).string(message.rtbSeatId),null!=message.dspId&&Object.hasOwnProperty.call(message,"dspId")&&writer.uint32(66).string(message.dspId),writer},ProtoVideoAdImpressionViewableRequest.fromObject=function(object){if(object instanceof $root.ProtoVideoAdImpressionViewableRequest)return object;var message=new $root.ProtoVideoAdImpressionViewableRequest;if(null!=object.trackingRequestMeta){if("object"!=typeof object.trackingRequestMeta)throw TypeError(".ProtoVideoAdImpressionViewableRequest.trackingRequestMeta: object expected");message.trackingRequestMeta=$root.MetadataModel.fromObject(object.trackingRequestMeta)}return null!=object.mediaGuid&&(message.mediaGuid=String(object.mediaGuid)),null!=object.publisherLineItemId&&(message.publisherLineItemId=String(object.publisherLineItemId)),null!=object.advertiserLineItemId&&(message.advertiserLineItemId=String(object.advertiserLineItemId)),null!=object.rtbSeatId&&(message.rtbSeatId=String(object.rtbSeatId)),null!=object.dspId&&(message.dspId=String(object.dspId)),message},ProtoVideoAdImpressionViewableRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoVideoAdImpressionViewableRequest}(),$root.ProtoVideoAdQuartilesRequest=function(){function ProtoVideoAdQuartilesRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoVideoAdQuartilesRequest.prototype.trackingRequestMeta=null,ProtoVideoAdQuartilesRequest.prototype.mediaGuid="",ProtoVideoAdQuartilesRequest.prototype.publisherLineItemId="",ProtoVideoAdQuartilesRequest.prototype.advertiserLineItemId="",ProtoVideoAdQuartilesRequest.prototype.quartile=0,ProtoVideoAdQuartilesRequest.prototype.rtbSeatId="",ProtoVideoAdQuartilesRequest.prototype.dspId="",ProtoVideoAdQuartilesRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.trackingRequestMeta&&Object.hasOwnProperty.call(message,"trackingRequestMeta")&&$root.MetadataModel.encode(message.trackingRequestMeta,writer.uint32(10).fork()).ldelim(),null!=message.mediaGuid&&Object.hasOwnProperty.call(message,"mediaGuid")&&writer.uint32(26).string(message.mediaGuid),null!=message.publisherLineItemId&&Object.hasOwnProperty.call(message,"publisherLineItemId")&&writer.uint32(42).string(message.publisherLineItemId),null!=message.advertiserLineItemId&&Object.hasOwnProperty.call(message,"advertiserLineItemId")&&writer.uint32(50).string(message.advertiserLineItemId),null!=message.quartile&&Object.hasOwnProperty.call(message,"quartile")&&writer.uint32(56).int32(message.quartile),null!=message.rtbSeatId&&Object.hasOwnProperty.call(message,"rtbSeatId")&&writer.uint32(66).string(message.rtbSeatId),null!=message.dspId&&Object.hasOwnProperty.call(message,"dspId")&&writer.uint32(74).string(message.dspId),writer},ProtoVideoAdQuartilesRequest.fromObject=function(object){if(object instanceof $root.ProtoVideoAdQuartilesRequest)return object;var message=new $root.ProtoVideoAdQuartilesRequest;if(null!=object.trackingRequestMeta){if("object"!=typeof object.trackingRequestMeta)throw TypeError(".ProtoVideoAdQuartilesRequest.trackingRequestMeta: object expected");message.trackingRequestMeta=$root.MetadataModel.fromObject(object.trackingRequestMeta)}switch(null!=object.mediaGuid&&(message.mediaGuid=String(object.mediaGuid)),null!=object.publisherLineItemId&&(message.publisherLineItemId=String(object.publisherLineItemId)),null!=object.advertiserLineItemId&&(message.advertiserLineItemId=String(object.advertiserLineItemId)),object.quartile){case"Start":case 0:message.quartile=0;break;case"First":case 1:message.quartile=1;break;case"Second":case 2:message.quartile=2;break;case"Third":case 3:message.quartile=3;break;case"Fourth":case 4:message.quartile=4}return null!=object.rtbSeatId&&(message.rtbSeatId=String(object.rtbSeatId)),null!=object.dspId&&(message.dspId=String(object.dspId)),message},ProtoVideoAdQuartilesRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoVideoAdQuartilesRequest}(),$root.ProtoUserSyncRequest=function(){function ProtoUserSyncRequest(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoUserSyncRequest.prototype.userId="",ProtoUserSyncRequest.prototype.demandPartner=0,ProtoUserSyncRequest.prototype.demandPartnerUserId="",ProtoUserSyncRequest.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.userId&&Object.hasOwnProperty.call(message,"userId")&&writer.uint32(10).string(message.userId),null!=message.demandPartner&&Object.hasOwnProperty.call(message,"demandPartner")&&writer.uint32(16).int32(message.demandPartner),null!=message.demandPartnerUserId&&Object.hasOwnProperty.call(message,"demandPartnerUserId")&&writer.uint32(26).string(message.demandPartnerUserId),writer},ProtoUserSyncRequest.fromObject=function(object){if(object instanceof $root.ProtoUserSyncRequest)return object;var message=new $root.ProtoUserSyncRequest;return null!=object.userId&&(message.userId=String(object.userId)),null!=object.demandPartner&&(message.demandPartner=0|object.demandPartner),null!=object.demandPartnerUserId&&(message.demandPartnerUserId=String(object.demandPartnerUserId)),message},ProtoUserSyncRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoUserSyncRequest}(),$root.ProtoPlayerPlaybackModeEnum=(valuesById={},(values=Object.create(valuesById))[valuesById[0]="Autoplay"]=0,values[valuesById[1]="ScrollToPlay"]=1,values[valuesById[2]="ClickToPlay"]=2,values),$root.ProtoPlayerCloseButtonMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Off"]=0,values[valuesById[1]="OnHover"]=1,values[valuesById[2]="OnHoverAfterFirstAd"]=2,values[valuesById[3]="AlwaysOn"]=3,values}(),$root.ProtoPlayerFloatingMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Off"]=0,values[valuesById[1]="OnPageLoad"]=1,values[valuesById[2]="AfterInView"]=2,values[valuesById[3]="Always"]=3,values}(),$root.ProtoPlayerSoundMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Mute"]=0,values[valuesById[1]="On"]=1,values[valuesById[2]="Hover"]=2,values}(),$root.ProtoPlayerInsertMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="WithinContainer"]=0,values[valuesById[1]="BeforeContainer"]=1,values[valuesById[2]="AfterContainer"]=2,values[valuesById[3]="ReplaceContainer"]=3,values[valuesById[4]="HideContainer"]=4,values}(),$root.ProtoAdViewabilityPolicy=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Default"]=0,values[valuesById[1]="Strict"]=1,values}(),$root.ProtoSharingDestination=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Facebook"]=0,values[valuesById[1]="Twitter"]=1,values[valuesById[2]="LinkedIn"]=2,values}(),$root.ProtoFloatingFixedPositionMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Page"]=0,values[valuesById[1]="Element"]=1,values}(),$root.ProtoPositionMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="BottomRight"]=0,values[valuesById[1]="BottomLeft"]=1,values[valuesById[2]="TopRight"]=2,values[valuesById[3]="TopLeft"]=3,values}(),$root.ProtoAdPlaybackMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Autoplay"]=0,values[valuesById[1]="ScrollToPlay"]=1,values}(),$root.ProtoFloatingAppendLocationEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Above"]=0,values[valuesById[1]="Below"]=1,values[valuesById[2]="Within"]=2,values}(),$root.ProtoPlayerAdSkippability=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="IfLongerThan"]=0,values[valuesById[1]="Always"]=1,values[valuesById[2]="NoRestrictions"]=2,values}(),$root.ProtoVideoQuality=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Auto"]=0,values[valuesById[1]="High1080p"]=1,values[valuesById[2]="High720p"]=2,values[valuesById[3]="Medium360p"]=3,values}(),$root.ProtoImplementationType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Web"]=0,values[valuesById[1]="Amp"]=1,values}(),$root.ProtoAdBreakTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="None"]=0,values[valuesById[1]="PreRoll"]=1,values[valuesById[2]="MidRoll"]=2,values[valuesById[3]="PostRoll"]=3,values}(),$root.ProtoAdSlotAdTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="SingleAd"]=0,values[valuesById[1]="AdPod"]=1,values}(),$root.ProtoDeviceType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Desktop"]=0,values[valuesById[1]="Smartphone"]=1,values[valuesById[2]="Tablet"]=2,values[valuesById[3]="GameConsole"]=3,values[valuesById[4]="SmartTV"]=4,values[valuesById[5]="WearableComputer"]=5,values[valuesById[6]="PDA"]=6,values[valuesById[7]="Unrecognized"]=7,values}(),$root.ProtoCookieSecureModeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Secure"]=0,values[valuesById[1]="Unsecure"]=1,values[valuesById[2]="Auto"]=2,values}(),$root.ProtoTrackerType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Image"]=0,values[valuesById[1]="Javascript"]=1,values}(),$root.ProtoTrackerTriggerType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Impression"]=0,values[valuesById[1]="Complete25Pc"]=1,values[valuesById[2]="Complete50Pc"]=2,values[valuesById[3]="Complete75Pc"]=3,values[valuesById[4]="ViewCompletion"]=4,values[valuesById[5]="VideoClick"]=5,values[valuesById[6]="Pause"]=6,values[valuesById[7]="Resume"]=7,values[valuesById[8]="Mute"]=8,values[valuesById[9]="Unmute"]=9,values}(),$root.ProtoCreativeTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="ThirdParty"]=0,values[valuesById[1]="MediaFile"]=1,values[valuesById[2]="Rtb"]=2,values[valuesById[3]="External"]=3,values[valuesById[4]="HeaderBidder"]=4,values[valuesById[7]="Tam"]=7,values[valuesById[8]="TamDeal"]=8,values}(),$root.ProtoResetCapTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="TimeCapping"]=0,values[valuesById[1]="ContentCapping"]=1,values[valuesById[2]="OpportunityCapping"]=2,values}(),$root.ProtoAdSlotsEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="PreRoll"]=0,values[valuesById[1]="MidRoll"]=1,values[valuesById[2]="PostRoll"]=2,values}(),$root.ProtoLineItemPriority=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="House"]=0,values[valuesById[1]="Default"]=1,values[valuesById[2]="Preferred"]=2,values[valuesById[3]="Top"]=3,values}(),$root.ProtoAdSkipMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="IfLongerThan31Sec"]=0,values[valuesById[1]="Always"]=1,values[valuesById[2]="Never"]=2,values[valuesById[3]="NotAplicable"]=3,values}(),$root.ProtoAdType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Video"]=0,values[valuesById[1]="Overlay"]=1,values}(),$root.ProtoChoiceCriteriaEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Only"]=0,values[valuesById[1]="Except"]=1,values}(),$root.ProtoLineItemAdBreakTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[1]="All"]=1,values[valuesById[2]="SingleAd"]=2,values[valuesById[3]="AdPod"]=3,values}(),$root.ProtoLineItemTargetingTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Only"]=0,values[valuesById[1]="Except"]=1,values}(),$root.ProtoLineItemAdSlotTargetingTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[1]="SpecificSlots"]=1,values[valuesById[2]="Interval"]=2,values}(),$root.ProtoLineItemPauseAdOutOfViewEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Default"]=0,values[valuesById[1]="Strict"]=1,values}(),$root.ProtoLineItemContextualTargetingEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="IncludeAny"]=0,values[valuesById[1]="IncludeAll"]=1,values[valuesById[2]="ExcludeAny"]=2,values[valuesById[3]="ExcludeAll"]=3,values}(),$root.ProtoSizeChoiceCriteriaEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="GreaterThan"]=0,values[valuesById[1]="SmallerThan"]=1,values[valuesById[2]="Between"]=2,values}(),$root.ProtoLoggingLevelEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="FATAL"]=0,values[valuesById[1]="WARNING"]=1,values[valuesById[2]="INFO"]=2,values}(),$root.ProtoMediaTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Image"]=0,values[valuesById[1]="Video"]=1,values}(),$root.ConnatixNoBidReasonEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="RequestException"]=0,values[valuesById[1]="Timeout"]=1,values[valuesById[2]="EmptyResponse"]=2,values[valuesById[3]="InvalidResponse"]=3,values[valuesById[4]="NoBid"]=4,values[valuesById[5]="BidBelowFloor"]=5,values[valuesById[6]="DealIdMismatch"]=6,values[valuesById[7]="CsInvalidResponse"]=7,values[valuesById[8]="CsRequestException"]=8,values[valuesById[9]="CsEmptyResponse"]=9,values[valuesById[11]="NoLibInPage"]=11,values}(),$root.PartnerNoBidReasonEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Unknown"]=0,values[valuesById[1]="TechnicalError"]=1,values[valuesById[2]="InvalidRequest"]=2,values[valuesById[3]="KnownWebSpider"]=3,values[valuesById[4]="SuspectedNonHumanTraffic"]=4,values[valuesById[5]="CloudIP"]=5,values[valuesById[6]="UnsupportedDevice"]=6,values[valuesById[7]="BlockedPublisher"]=7,values[valuesById[8]="UnmatchedUser"]=8,values[valuesById[9]="DailyReaderCapMet"]=9,values[valuesById[10]="DailyDomainCapMet"]=10,values}(),$root.ProtoAdBlockDetectionTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Banner"]=0,values[valuesById[1]="Network"]=1,values}(),$root.ProtoAdClickTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[1]="AdClick"]=1,values[valuesById[2]="AdClickThrough"]=2,values[valuesById[3]="AdSkipClick"]=3,values[valuesById[4]="VolumeClick"]=4,values[valuesById[5]="PauseClick"]=5,values[valuesById[6]="PlayClick"]=6,values[valuesById[7]="FullScreenClick"]=7,values[valuesById[8]="MuteClick"]=8,values[valuesById[9]="UnmuteClick"]=9,values}(),$root.ProtoAdsourceTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Unknown"]=0,values[valuesById[1]="Vpaid"]=1,values[valuesById[2]="VastMedia"]=2,values[valuesById[3]="CnxMedia"]=3,values[valuesById[4]="Jw"]=4,values[valuesById[5]="Ima"]=5,values[valuesById[6]="AOL"]=6,values}(),$root.ProtoAuctionLossReasonEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="TargetingMismatch"]=0,values[valuesById[1]="CompetitorPriority"]=1,values[valuesById[2]="AdOpportunityEnd"]=2,values}(),$root.ProtoGdprConsentModeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Unknown"]=0,values[valuesById[1]="NoCmp"]=1,values[valuesById[2]="NoConsent"]=2,values[valuesById[3]="NoConnatixConsent"]=3,values[valuesById[4]="NotAllDemandConsent"]=4,values[valuesById[5]="AllGood"]=5,values}(),$root.ProtoAuctionPostbidReasonEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="CreativeError"]=0,values[valuesById[1]="SDKFailure"]=1,values[valuesById[2]="UnsupportedMedia"]=2,values[valuesById[3]="TargetingMismatch"]=3,values[valuesById[4]="PlayerError"]=4,values}(),$root.ProtoHeavyAdBlockTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Global"]=0,values[valuesById[1]="Script"]=1,values[valuesById[2]="VpaidIframe"]=2,values[valuesById[3]="OverlayIframe"]=3,values}(),$root.ProtoMediaClickTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Click"]=0,values[valuesById[1]="UrlClick"]=1,values[valuesById[2]="VolumeClick"]=2,values[valuesById[3]="PlayClick"]=3,values[valuesById[4]="PauseClick"]=4,values[valuesById[5]="NextClick"]=5,values[valuesById[6]="PreviousClick"]=6,values[valuesById[7]="MuteClick"]=7,values[valuesById[8]="UnmuteClick"]=8,values[valuesById[9]="CloseClick"]=9,values[valuesById[10]="ScrollClick"]=10,values[valuesById[11]="GalleryClick"]=11,values[valuesById[12]="SubtitleClick"]=12,values[valuesById[13]="FullScreenClick"]=13,values[valuesById[14]="ExitFullScreenClick"]=14,values}(),$root.ProtoQuartilesEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Start"]=0,values[valuesById[1]="First"]=1,values[valuesById[2]="Second"]=2,values[valuesById[3]="Third"]=3,values[valuesById[4]="Fourth"]=4,values}(),module.exports=$root},function(module,exports){module.exports=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}},function(module,exports){function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}module.exports=function(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}},function(module,exports){function _getPrototypeOf(o){return module.exports=_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}module.exports=_getPrototypeOf},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",function(){return isString}),__webpack_require__.d(__webpack_exports__,"d",function(){return isNumeric}),__webpack_require__.d(__webpack_exports__,"e",function(){return isPositiveNumber}),__webpack_require__.d(__webpack_exports__,"h",function(){return isStringDefined}),__webpack_require__.d(__webpack_exports__,"a",function(){return isDefined}),__webpack_require__.d(__webpack_exports__,"b",function(){return isFunction}),__webpack_require__.d(__webpack_exports__,"f",function(){return isRealObject}),__webpack_require__.d(__webpack_exports__,"c",function(){return isIframe});var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__);function isString(str){return"string"==typeof str}function isNumeric(value){return!isNaN(parseFloat(value))&&isFinite(value)}function isPositiveNumber(value){return isNumeric(value)&&value>0}function isStringDefined(str){return isString(str)&&str.length>0}function isDefined(variable){return void 0!==variable}function isFunction(func){return"function"==typeof func}function isRealObject(object){return"object"===_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(object)&&null!==object&&!Array.isArray(object)}function isIframe($container){try{if($container.contentWindow||$container.contentDocument)return!0}catch(e){}return!1}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"v",function(){return hideHtmlElement}),__webpack_require__.d(__webpack_exports__,"R",function(){return showHtmlElement}),__webpack_require__.d(__webpack_exports__,"Q",function(){return setInlineStyle}),__webpack_require__.d(__webpack_exports__,"N",function(){return removeInlineStyleProperty}),__webpack_require__.d(__webpack_exports__,"M",function(){return removeElement}),__webpack_require__.d(__webpack_exports__,"B",function(){return insertStyleSheet}),__webpack_require__.d(__webpack_exports__,"A",function(){return insertScript}),__webpack_require__.d(__webpack_exports__,"z",function(){return insertInlineScript}),__webpack_require__.d(__webpack_exports__,"a",function(){return addClass}),__webpack_require__.d(__webpack_exports__,"L",function(){return removeClass}),__webpack_require__.d(__webpack_exports__,"u",function(){return hasClass}),__webpack_require__.d(__webpack_exports__,"U",function(){return toggleClass}),__webpack_require__.d(__webpack_exports__,"O",function(){return replaceClass}),__webpack_require__.d(__webpack_exports__,"m",function(){return getElementById}),__webpack_require__.d(__webpack_exports__,"l",function(){return getComputedStyle}),__webpack_require__.d(__webpack_exports__,"n",function(){return getElementsByClassName}),__webpack_require__.d(__webpack_exports__,"b",function(){return addCssString}),__webpack_require__.d(__webpack_exports__,"c",function(){return addPreconnect}),__webpack_require__.d(__webpack_exports__,"f",function(){return createElementByString}),__webpack_require__.d(__webpack_exports__,"V",function(){return toggleMutedAttribute}),__webpack_require__.d(__webpack_exports__,"o",function(){return getFullscreenKeys}),__webpack_require__.d(__webpack_exports__,"i",function(){return forceRepaint}),__webpack_require__.d(__webpack_exports__,"P",function(){return requestAnimationFrameHelper}),__webpack_require__.d(__webpack_exports__,"e",function(){return cancelRequestAnimationFrame}),__webpack_require__.d(__webpack_exports__,"q",function(){return getTitleFontFamily}),__webpack_require__.d(__webpack_exports__,"j",function(){return getBodyFontFamily}),__webpack_require__.d(__webpack_exports__,"t",function(){return getWindowFromElement}),__webpack_require__.d(__webpack_exports__,"d",function(){return appendChild}),__webpack_require__.d(__webpack_exports__,"y",function(){return insertChild}),__webpack_require__.d(__webpack_exports__,"x",function(){return insertBefore}),__webpack_require__.d(__webpack_exports__,"w",function(){return insertAfter}),__webpack_require__.d(__webpack_exports__,"k",function(){return getChildIndex}),__webpack_require__.d(__webpack_exports__,"h",function(){return fadeOut}),__webpack_require__.d(__webpack_exports__,"g",function(){return fadeIn}),__webpack_require__.d(__webpack_exports__,"E",function(){return isElementHidden}),__webpack_require__.d(__webpack_exports__,"J",function(){return prependChild}),__webpack_require__.d(__webpack_exports__,"T",function(){return stripHtmlTags}),__webpack_require__.d(__webpack_exports__,"D",function(){return isDoNotTrackEnabled}),__webpack_require__.d(__webpack_exports__,"s",function(){return getTopWindowIfHasProperty}),__webpack_require__.d(__webpack_exports__,"r",function(){return getTopWindowIfHasFrame}),__webpack_require__.d(__webpack_exports__,"K",function(){return querySelectorAll}),__webpack_require__.d(__webpack_exports__,"F",function(){return isHttpsProtocolUsed}),__webpack_require__.d(__webpack_exports__,"W",function(){return upgradeInsecureRequests}),__webpack_require__.d(__webpack_exports__,"p",function(){return getPageReferrer}),__webpack_require__.d(__webpack_exports__,"G",function(){return isURLSameDomainToTop}),__webpack_require__.d(__webpack_exports__,"S",function(){return stripAnchorTag}),__webpack_require__.d(__webpack_exports__,"H",function(){return logIframeClick}),__webpack_require__.d(__webpack_exports__,"C",function(){return iosUnfreezeVideo}),__webpack_require__.d(__webpack_exports__,"I",function(){return preloadScriptTag});var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(52),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_1__),Common_Config_BrowserConfig__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(34),Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(4),Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(13),Common_Config_CssClassesConfig__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7),Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(15),Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(0),_Logging__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(11);function changeDisplayProperty($domElement,display){$domElement&&($domElement.style.display=display?"":"none")}function _addClass($elem,newClass){if(Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.a)($elem.classList))$elem.classList.add(newClass);else{var classList="".concat($elem.getAttribute("class")," ").concat(newClass);$elem.setAttribute("class",classList)}}function _removeClass($elem,classToRemove){if(Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.a)($elem.classList))$elem.classList.remove(classToRemove);else{var classList=$elem.getAttribute("class").replace(classToRemove,"");$elem.setAttribute("class",classList)}}function hideHtmlElement($domElement){changeDisplayProperty($domElement,!1)}function showHtmlElement($domElement){changeDisplayProperty($domElement,!0)}function setInlineStyle(elem,propertyObject){for(var property in propertyObject)propertyObject.hasOwnProperty(property)&&(elem.style[property]=propertyObject[property])}function removeInlineStyleProperty(elem){for(var _len=arguments.length,propertyNames=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)propertyNames[_key-1]=arguments[_key];propertyNames.forEach(function(propertyName){elem.style[propertyName]=""})}function removeElement($domElement){$domElement&&$domElement.parentNode&&$domElement.parentNode.removeChild($domElement)}function insertStyleSheet(script,$desiredParent,GLOBAL,onLoad,onError){if($desiredParent)try{var styleSheet=GLOBAL.document.createElement("link");return styleSheet.id=script.id,styleSheet.type="text/css",styleSheet.rel="stylesheet",styleSheet.href=script.src,Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.b)(onLoad)&&(styleSheet.onload=function(){onLoad()}),Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.b)(onError)&&(styleSheet.onerror=function(event){$desiredParent.removeChild(styleSheet),Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.g)(event)?onError("link_stylesheet_load_error_".concat(event)):onError("link_stylesheet_load_error_".concat(function(GLOBAL,$elem){var tmpDivEl=GLOBAL.document.createElement("div");return tmpDivEl.appendChild($elem),tmpDivEl.innerHTML}(GLOBAL,styleSheet)))}),$desiredParent.appendChild(styleSheet),styleSheet}catch(e){return null}}function insertScript(script,$desiredParent,GLOBAL,onLoad,onError){var shouldLog=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],loggingMessage=arguments.length>6?arguments[6]:void 0;try{var scriptTag=GLOBAL.document.createElement("script");return scriptTag.src=script.src,scriptTag.async=!0,scriptTag.type="text/javascript",script.id&&(scriptTag.id=script.id),Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.b)(onLoad)&&(scriptTag.onload=function(){onLoad()}),scriptTag.onerror=function(event){$desiredParent.removeChild(scriptTag),shouldLog&&Object(_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({message:loggingMessage,exception:"script_load_error",callStack:script.src,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.INFO,throttle:2,sendMaxLog:!1}),Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.b)(onError)&&onError()},$desiredParent.appendChild(scriptTag),scriptTag}catch(event){return shouldLog&&Object(_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({message:loggingMessage,exception:"script_insert_error_".concat(event.message,"_").concat(event.stack),callStack:script.src,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.FATAL,throttle:2,sendMaxLog:!1}),Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.b)(onError)&&onError(),null}}function insertInlineScript($desiredParent,GLOBAL,inlineCode){if($desiredParent)try{var $scriptTag=GLOBAL.document.createElement("script"),textNode=GLOBAL.document.createTextNode(inlineCode);return $scriptTag.appendChild(textNode),$desiredParent.appendChild($scriptTag),$scriptTag}catch(e){return null}}function addClass(element){if(element){for(var _len2=arguments.length,classNames=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)classNames[_key2-1]=arguments[_key2];classNames.forEach(function(name){Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.h)(name)&&_addClass(element,name)})}}function removeClass(element){if(element){for(var _len3=arguments.length,classNames=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)classNames[_key3-1]=arguments[_key3];classNames.forEach(function(name){Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.h)(name)&&_removeClass(element,name)})}}function hasClass(element,className){return element&&element.classList.contains(className)}function toggleClass(element,className,condition){return!!element&&(Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.a)(condition)?condition?(addClass(element,className),!0):(removeClass(element,className),!1):element.classList.toggle(className))}function replaceClass(elem,currentClassName,newClassName){var forceElementRepaint=arguments.length>3&&void 0!==arguments[3]&&arguments[3];elem&&(_removeClass(elem,currentClassName),forceElementRepaint&&forceRepaint(elem),_addClass(elem,newClassName))}var getElementById=function(elementId,GLOBAL){return GLOBAL.document.getElementById(elementId)},getComputedStyle=function(element,GLOBAL,pseudoElt){return GLOBAL.getComputedStyle(element,pseudoElt)},getElementsByClassName=function(className,GLOBAL){return GLOBAL.document.getElementsByClassName(className)};function addCssString(cssText){var id=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",GLOBAL=arguments.length>2?arguments[2]:void 0,head=GLOBAL.document.getElementsByTagName("head")[0],style=GLOBAL.document.createElement("style");style.setAttribute("type","text/css"),style.id=id,style.styleSheet?style.styleSheet.cssText=cssText:style.appendChild(GLOBAL.document.createTextNode(cssText)),head.appendChild(style)}function addPreconnect(url,GLOBAL){var head=GLOBAL.document.getElementsByTagName("head")[0],link=GLOBAL.document.createElement("link");link.setAttribute("rel","preconnect"),link.setAttribute("link",url),head.appendChild(link)}function createElementByString(htmlString,GLOBAL){var htmlElement=GLOBAL.document.createElement("div");return htmlElement.innerHTML=htmlString,htmlElement.firstElementChild}function toggleMutedAttribute(videoContainer,volume){volume>0?(videoContainer.removeAttribute("muted"),videoContainer.muted=!1):(videoContainer.setAttribute("muted",""),videoContainer.muted=!0)}function getFullscreenKeys(element){return Common_Config_BrowserConfig__WEBPACK_IMPORTED_MODULE_2__.b.find(function(item){if(item.keys.fullscreenEnabled in element)return!0})}function forceRepaint(element){element.getBoundingClientRect()}function requestAnimationFrameHelper(GLOBAL,callback){return(GLOBAL.requestAnimationFrame||GLOBAL.webkitRequestAnimationFrame||function(timeoutCallback){return setTimeout(timeoutCallback,20)})(callback)}function cancelRequestAnimationFrame(GLOBAL,handle){return(GLOBAL.cancelAnimationFrame||GLOBAL.webkitCancelAnimationFrame||function(timeoutHandle){return clearTimeout(timeoutHandle)})(handle)}function getElementCSSStyle(elementsSelectors,container){var element=function(elementsSelectors,container){for(var el=container,_loop=function(){var parent=el.parentNode;if(parent){var selectedElement=elementsSelectors.reduce(function(acc,selector){return acc||parent.querySelector(selector)},null);if(selectedElement)return{v:selectedElement}}el=parent};el;){var _ret=_loop();if("object"===_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_1___default()(_ret))return _ret.v}return null}(elementsSelectors,container);return element?getComputedStyle(element,getWindowFromElement(element)):null}function getElementCSSPropertyValue(elementsSelectors,container,property){var elementCSSStyle=getElementCSSStyle(elementsSelectors,container);return elementCSSStyle?function(computedElement,property){return computedElement.getPropertyValue(property)}(elementCSSStyle,property):null}function getTitleFontFamily(container){var cssFontFamily=getElementCSSPropertyValue(["h1","h2"],container,"font-family");return cssFontFamily||"inherit"}function getBodyFontFamily(container){var cssFontFamily=getElementCSSPropertyValue(["p"],container,"font-family");return cssFontFamily||"inherit"}function getWindowFromElement($domElement){try{return $domElement.ownerDocument.defaultView}catch(e){return null}}function appendChild(newChild,parent){newChild&&parent&&(Array.isArray(newChild)?newChild.forEach(function($child){return parent.appendChild($child)}):parent.appendChild(newChild))}function insertChild(newChild,parent,index){for(var inserted=!1,children=Object(Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_4__.c)(parent.children),i=0;i<children.length;i++)if(index-1===i||0===index){inserted=!0,Array.isArray(newChild)?insertBefore.apply(void 0,[children[i]].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(newChild))):insertBefore(children[i],newChild);break}inserted||appendChild(newChild,parent)}function insertBefore(refChild){if(refChild&&refChild.parentElement){for(var _len4=arguments.length,elements=new Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++)elements[_key4-1]=arguments[_key4];for(var childIndex=elements.length;childIndex--;)refChild.parentElement.insertBefore(elements[childIndex],refChild)}}function insertAfter(refChild){for(var _len5=arguments.length,elements=new Array(_len5>1?_len5-1:0),_key5=1;_key5<_len5;_key5++)elements[_key5-1]=arguments[_key5];for(var childIndex=elements.length;childIndex--;)refChild.parentNode.insertBefore(elements[childIndex],refChild.nextSibling)}function getChildIndex($child,$parent){return Object(Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_4__.c)($parent.children).indexOf($child)}function removeDisplayNone($element){var GLOBAL=getWindowFromElement($element);GLOBAL&&("none"===getComputedStyle($element,GLOBAL).display&&($element.style.display="block"))}function fadeOut($element){var callback=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};addClass($element,Common_Config_CssClassesConfig__WEBPACK_IMPORTED_MODULE_5__.n.FadeOutBase),removeDisplayNone($element),forceRepaint($element),$element.addEventListener("transitionend",function onTransitionEnd(event){"opacity"===event.propertyName&&(removeClass($element,Common_Config_CssClassesConfig__WEBPACK_IMPORTED_MODULE_5__.n.FadeOutBase,Common_Config_CssClassesConfig__WEBPACK_IMPORTED_MODULE_5__.n.FadeOut),callback(),$element.removeEventListener("transitionend",onTransitionEnd))}),addClass($element,Common_Config_CssClassesConfig__WEBPACK_IMPORTED_MODULE_5__.n.FadeOut)}function fadeIn($element){var callback=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};addClass($element,Common_Config_CssClassesConfig__WEBPACK_IMPORTED_MODULE_5__.n.FadeInBase),removeDisplayNone($element),forceRepaint($element),$element.addEventListener("transitionend",function onTransitionEnd(event){"opacity"===event.propertyName&&(removeClass($element,Common_Config_CssClassesConfig__WEBPACK_IMPORTED_MODULE_5__.n.FadeInBase,Common_Config_CssClassesConfig__WEBPACK_IMPORTED_MODULE_5__.n.FadeIn),callback(),$element.removeEventListener("transitionend",onTransitionEnd))}),addClass($element,Common_Config_CssClassesConfig__WEBPACK_IMPORTED_MODULE_5__.n.FadeIn)}function isElementHidden($element){var GLOBAL=getWindowFromElement($element);if(!GLOBAL)return!0;var _getComputedStyle2=getComputedStyle($element,GLOBAL),display=_getComputedStyle2.display,opacity=_getComputedStyle2.opacity;return"none"===display||"0"===opacity}function prependChild(parentContainer,childContainer){return null===parentContainer.firstChild?parentContainer.appendChild(childContainer):parentContainer.insertBefore(childContainer,parentContainer.firstChild)}function stripHtmlTags(text,GLOBAL){var tmpDivEl=GLOBAL.document.createElement("div");return tmpDivEl.innerHTML=text||"",tmpDivEl.innerText}function isDoNotTrackEnabled(){var dnt=window.navigator&&window.navigator.doNotTrack||window.doNotTrack;return"1"===dnt||"yes"===dnt}function getTopWindowIfHasProperty(global,property){var topWindow=Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_6__.f)(global).topFrame;return topWindow[property]?topWindow:null}function getTopWindowIfHasFrame(GLOBAL,frameKey){var frame=GLOBAL,foundFrame=null;try{for(;!foundFrame;){try{frame.frames[frameKey]&&(foundFrame=frame)}catch(e){}if(!GLOBAL.top||GLOBAL.top===frame)break;frame=frame.parent}}catch(e){}return foundFrame}function querySelectorAll(selectors,GLOBAL){var selectedElements=[];try{selectedElements=selectedElements.slice.call(GLOBAL.document.querySelectorAll(selectors),0)}catch(e){}return selectedElements}function isHttpsProtocolUsed(global){return-1!==Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_6__.f)(global).topFrame.location.protocol.indexOf("https")}function upgradeInsecureRequests(global){isHttpsProtocolUsed(global)&&[window,global].forEach(function(win){if(null===win.document.querySelector("meta[content=upgrade-insecure-requests]")){var meta=win.document.createElement("meta");meta.setAttribute("http-equiv","Content-Security-Policy"),meta.content="upgrade-insecure-requests",win.document.head.appendChild(meta)}})}function getPageReferrer(global){return Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_6__.f)(global).topFrame.document.referrer}function isURLSameDomainToTop(url,global){var globalHost=Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_6__.f)(global).topFrame.location.hostname,urlPathProp=Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_6__.g)(url);return urlPathProp&&urlPathProp.hostname===globalHost}function stripAnchorTag(anchorElement){anchorElement.removeAttribute("href"),anchorElement.removeAttribute("target"),anchorElement.removeAttribute("download"),anchorElement.removeAttribute("ping"),anchorElement.removeAttribute("rel"),anchorElement.removeAttribute("media"),anchorElement.removeAttribute("hreflang"),anchorElement.removeAttribute("type")}function logIframeClick(windowObject,callerName){try{windowObject.onclick=function(event){var _event$target=event.target,tagName=_event$target.tagName,className=_event$target.className;Object(_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({message:"".concat(callerName," - click on tag:").concat(tagName," class:").concat(className),level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.INFO})}}catch(e){Object(_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({message:"".concat(callerName,"_Error - iframe click"),level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.WARNING,callStack:e.stack})}}function iosUnfreezeVideo(video){video.currentTime=video.currentTime+.01}function preloadScriptTag(src,GLOBAL){!function(GLOBAL,resourceUrl,asAttribute){var linkTag=GLOBAL.document.createElement("link");linkTag.rel="preload",linkTag.href=resourceUrl,linkTag.as=asAttribute,GLOBAL.document.head.appendChild(linkTag)}(GLOBAL,src,"script")}},function(module,exports){module.exports=function(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}},function(module,__webpack_exports__,__webpack_require__){"use strict";var ClassModifiersEnum,ClassFlagsEnum,ClassStatesEnum;__webpack_require__.d(__webpack_exports__,"h",function(){return ClassModifiersEnum}),__webpack_require__.d(__webpack_exports__,"g",function(){return ClassFlagsEnum}),__webpack_require__.d(__webpack_exports__,"j",function(){return ClassStatesEnum}),__webpack_require__.d(__webpack_exports__,"t",function(){return VideoClassBreakPointsEnum}),__webpack_require__.d(__webpack_exports__,"p",function(){return PlayspaceClassBreakPointsEnum}),__webpack_require__.d(__webpack_exports__,"i",function(){return ClassPlayerSizesEnum}),__webpack_require__.d(__webpack_exports__,"k",function(){return ContextClassEnum}),__webpack_require__.d(__webpack_exports__,"f",function(){return ClassColorThemeEnum}),__webpack_require__.d(__webpack_exports__,"m",function(){return CssFontFamiliesEnum}),__webpack_require__.d(__webpack_exports__,"l",function(){return CssColorsEnum}),__webpack_require__.d(__webpack_exports__,"e",function(){return CaptionsClassEnum}),__webpack_require__.d(__webpack_exports__,"o",function(){return FloatingClassEnum}),__webpack_require__.d(__webpack_exports__,"n",function(){return FadeHelperClassEnum}),__webpack_require__.d(__webpack_exports__,"r",function(){return SlideHelperClassEnum}),__webpack_require__.d(__webpack_exports__,"s",function(){return TooltipClassEnum}),__webpack_require__.d(__webpack_exports__,"b",function(){return CSSClassMainEnum}),__webpack_require__.d(__webpack_exports__,"c",function(){return CSSClassRatioContainer}),__webpack_require__.d(__webpack_exports__,"d",function(){return CSSClassVideoHandlerHideVideo}),__webpack_require__.d(__webpack_exports__,"q",function(){return SkipAdButtonClassEnum}),__webpack_require__.d(__webpack_exports__,"a",function(){return AdLoadingScreenClassEnum}),function(ClassModifiersEnum){ClassModifiersEnum.Invisible="cnx-mod-invisible",ClassModifiersEnum.HoverStart="cnx-mod-hover-s",ClassModifiersEnum.HoverEnd="cnx-mod-hover",ClassModifiersEnum.HoverBoom="cnx-mod-boom",ClassModifiersEnum.DisplayNone="cnx-mod-display-none",ClassModifiersEnum.Active="cnx-mod-active",ClassModifiersEnum.HideOnVolumeHover="cnx-hide-on-volume-hover",ClassModifiersEnum.HideOnSingleVideo="cnx-hide-on-single-video",ClassModifiersEnum.NoTransition="cnx-mod-no-transition",ClassModifiersEnum.Collapsable="cnx-mod-collapsable",ClassModifiersEnum.HasCustomScrollbar="cnx-mod-scrollbar",ClassModifiersEnum.Show="cnx-mod-show",ClassModifiersEnum.Hide="cnx-mod-hide",ClassModifiersEnum.OnHold="cnx-mod-onhold",ClassModifiersEnum.ForceLineBreak="cnx-mod-force-line-break",ClassModifiersEnum.HideOnAdOverlay="cnx-mod-ad-overlay-none",ClassModifiersEnum.HideOnPodLoadingScreen="cnx-mod-pod-loading-none"}(ClassModifiersEnum||(ClassModifiersEnum={})),function(ClassFlagsEnum){ClassFlagsEnum.Fullscreen="cnx-in-fullscreen",ClassFlagsEnum.Ad="cnx-in-ad",ClassFlagsEnum.AdOverlayType="cnx-in-ad-overlay",ClassFlagsEnum.AdFullSize="cnx-in-ad-full",ClassFlagsEnum.AdShowCard="cnx-ad-show-card",ClassFlagsEnum.ShowControls="cnx-in-show-controls",ClassFlagsEnum.Mobile="cnx-in-mobile",ClassFlagsEnum.Desktop="cnx-in-desktop",ClassFlagsEnum.Muted="cnx-in-mute",ClassFlagsEnum.Collapsed="cnx-in-collapse",ClassFlagsEnum.GalleryPortrait="cnx-in-g-portrait",ClassFlagsEnum.GalleryLandscape="cnx-in-g-landscape",ClassFlagsEnum.ContextController="cnx-context-controller",ClassFlagsEnum.HideUI="cnx-in-hide-ui",ClassFlagsEnum.PodLoadingScreen="cnx-in-pod-loading",ClassFlagsEnum.CloseOn="cnx-close-on",ClassFlagsEnum.CloseOff="cnx-close-off",ClassFlagsEnum.CloseHover="cnx-close-hover",ClassFlagsEnum.CloseFloatOn="cnx-close-float-on",ClassFlagsEnum.CloseFloatOff="cnx-close-float-off",ClassFlagsEnum.CloseFloatHover="cnx-close-float-hover",ClassFlagsEnum.UiInView="cnx-ui-in-view"}(ClassFlagsEnum||(ClassFlagsEnum={})),function(ClassStatesEnum){ClassStatesEnum.Playing="cnx-is-playing",ClassStatesEnum.Paused="cnx-is-paused",ClassStatesEnum.Stopped="cnx-is-stopped",ClassStatesEnum.Preroll="cnx-is-preroll",ClassStatesEnum.Postroll="cnx-is-postroll",ClassStatesEnum.Loading="cnx-is-loading",ClassStatesEnum.LiveEnded="cnx-live-ended"}(ClassStatesEnum||(ClassStatesEnum={}));var ClassPlayerSizesEnum,ContextClassEnum,ClassColorThemeEnum,CssFontFamiliesEnum,CssColorsEnum,CaptionsClassEnum,FloatingClassEnum,VideoClassBreakPointsEnum={Xxl:"cnx-bp-xxl-v",Xl:"cnx-bp-xl-v",Lg:"cnx-bp-lg-v",Md:"cnx-bp-md-v",Sm:"cnx-bp-sm-v",Xs:"cnx-bp-xs-v",Xxs:"cnx-bp-xxs-v"},PlayspaceClassBreakPointsEnum={Xxl:"cnx-bp-xxl-st",Xl:"cnx-bp-xl-st",Lg:"cnx-bp-lg-st",Md:"cnx-bp-md-st",Sm:"cnx-bp-sm-st",Xs:"cnx-bp-xs-st",Xxs:"cnx-bp-xxs-st"};!function(ClassPlayerSizesEnum){ClassPlayerSizesEnum.Responsive="cnx-size-responsive",ClassPlayerSizesEnum.Fixed="cnx-size-fixed"}(ClassPlayerSizesEnum||(ClassPlayerSizesEnum={})),function(ContextClassEnum){ContextClassEnum.ClickOption="cnx-cm-item--click",ContextClassEnum.ToggleOption="cnx-cm-item--toggle",ContextClassEnum.SubmenuOption="cnx-cm-item--submenu",ContextClassEnum.ItemIcon="cnx-cm-item__icon",ContextClassEnum.ItemTitle="cnx-cm-item__title",ContextClassEnum.ItemExtra="cnx-cm-item__extra",ContextClassEnum.Items="cnx-cm-items",ContextClassEnum.Container="cnx-cm-container"}(ContextClassEnum||(ContextClassEnum={})),function(ClassColorThemeEnum){ClassColorThemeEnum.Icons="cnx-color-icon",ClassColorThemeEnum.TooltipText="cnx-color-tt-text",ClassColorThemeEnum.TooltipBackground="cnx-color-tt-bg",ClassColorThemeEnum.AccentColor="cnx-color-accent",ClassColorThemeEnum.PrimaryColor="cnx-color-primary",ClassColorThemeEnum.SecondaryColor="cnx-color-secondary",ClassColorThemeEnum.TitleComponent="cnx-title-component",ClassColorThemeEnum.TitleLink="cnx-color-title-link",ClassColorThemeEnum.SlideProgressBar="cnx-slides-progress-bar",ClassColorThemeEnum.ProgressFill="cnx-progress-fill"}(ClassColorThemeEnum||(ClassColorThemeEnum={})),function(CssFontFamiliesEnum){CssFontFamiliesEnum.InheritTitleFontFamily="cnx-inherit-title-font-family",CssFontFamiliesEnum.InheritBodyFontFamily="cnx-inherit-body-font-family"}(CssFontFamiliesEnum||(CssFontFamiliesEnum={})),function(CssColorsEnum){CssColorsEnum.Connatix="#0099FF",CssColorsEnum.Icons="#FFFFFF",CssColorsEnum.PrimaryBackground="#F1F1F1",CssColorsEnum.PrimaryForeground="#000000",CssColorsEnum.SecondaryBackground="#000000",CssColorsEnum.SecondaryForeground="#F1F1F1",CssColorsEnum.AccentForeground="#FFFFFF"}(CssColorsEnum||(CssColorsEnum={})),function(CaptionsClassEnum){CaptionsClassEnum.CaptionContainer="cnx-captions-text-holder"}(CaptionsClassEnum||(CaptionsClassEnum={})),function(FloatingClassEnum){FloatingClassEnum.MainClass="cnx-float",FloatingClassEnum.TransitionClass="cnx-float-transition"}(FloatingClassEnum||(FloatingClassEnum={}));var SlideHelperClassEnum,TooltipClassEnum,GalleryCSSClasses,FadeHelperClassEnum={FadeOutBase:"cnx-fade-out-base",FadeOut:"cnx-fade-out",FadeInBase:"cnx-fade-in-base",FadeIn:"cnx-fade-in"};!function(SlideHelperClassEnum){SlideHelperClassEnum.CurrentSlide="cnx-slide-current",SlideHelperClassEnum.NextSlide="cnx-slide-next",SlideHelperClassEnum.SlideLeft="cnx-slide-left",SlideHelperClassEnum.SlideRight="cnx-slide-right"}(SlideHelperClassEnum||(SlideHelperClassEnum={})),function(TooltipClassEnum){TooltipClassEnum.OpacityInTransition="cnx-tooltip-animation-in"}(TooltipClassEnum||(TooltipClassEnum={})),function(GalleryCSSClasses){GalleryCSSClasses.Card="cnx-g-card",GalleryCSSClasses.CardSlot="cnx-g-card-slot",GalleryCSSClasses.CardImage="cnx-g-card-image",GalleryCSSClasses.CardText="cnx-g-card-text",GalleryCSSClasses.CardTextContainer="cnx-g-card-text-container",GalleryCSSClasses.CardPlaceholder="cnx-g-card-placeholder",GalleryCSSClasses.CardRail="cnx-g-rail",GalleryCSSClasses.StyleDetailed="cnx-g-style-detailed",GalleryCSSClasses.StyleVisual="cnx-g-style-visual",GalleryCSSClasses.ExploreMore="cnx-g-explore-more",GalleryCSSClasses.FadeOut="cnx-g-fade-out"}(GalleryCSSClasses||(GalleryCSSClasses={}));var CSSClassMainEnum={MainContainer:"cnx-main-container",MainContainerFlex:"cnx-main-container-flex",PlayerWrapper:"cnx-player-wrapper",ImagePlaceholder:"cnx-image-placeholder"},CSSClassRatioContainer="cnx-ratio",CSSClassVideoHandlerHideVideo="cnx-hide-video",SkipAdButtonClassEnum={Text:"cnx-skip-ad-text",Timer:"cnx-timer-loader",Icon:"cnx-skip-ad-icon",SkipAdButton:"cnx-skip-ad-button",InTimer:"cnx-skip-ad-in-timer"},AdLoadingScreenClassEnum={Icon:"cnx-pod-open-new-icon",Button:"cnx-pod-read-more-btn",ButtonContainer:"cnx-pod-read-more-container",Wrapper:"cnx-pod-read-more-wrapper",BackgroundImg:"cnx-pod-loading-background",InfoContainer:"cnx-pod-loading-info",FallbackContainer:"cnx-pod-loading-fallback",SlotCountText:"cnx-pod-slot-count-text"}},function(module,exports,__webpack_require__){var _typeof=__webpack_require__(52),assertThisInitialized=__webpack_require__(16);module.exports=function(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?assertThisInitialized(self):call}},function(module,exports,__webpack_require__){var setPrototypeOf=__webpack_require__(300);module.exports=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&setPrototypeOf(subClass,superClass)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var VastViewModeEnum,VpaidEventsEnum;__webpack_require__.d(__webpack_exports__,"a",function(){return VastViewModeEnum}),__webpack_require__.d(__webpack_exports__,"b",function(){return VpaidEventsEnum}),function(VastViewModeEnum){VastViewModeEnum.Fullscreen="fullscreen",VastViewModeEnum.Normal="normal",VastViewModeEnum.Thumbnail="thumbnail"}(VastViewModeEnum||(VastViewModeEnum={})),function(VpaidEventsEnum){VpaidEventsEnum.AdLoaded="AdLoaded",VpaidEventsEnum.AdStarted="AdStarted",VpaidEventsEnum.AdStopped="AdStopped",VpaidEventsEnum.AdSkipped="AdSkipped",VpaidEventsEnum.AdSkippableStateChange="AdSkippableStateChange",VpaidEventsEnum.AdSizeChange="AdSizeChange",VpaidEventsEnum.AdLinearChange="AdLinearChange",VpaidEventsEnum.AdDurationChange="AdDurationChange",VpaidEventsEnum.AdExpandedChange="AdExpandedChange",VpaidEventsEnum.AdRemainingTimeChange="AdRemainingTimeChange",VpaidEventsEnum.AdVolumeChange="AdVolumeChange",VpaidEventsEnum.AdImpression="AdImpression",VpaidEventsEnum.AdVideoStart="AdVideoStart",VpaidEventsEnum.AdVideoFirstQuartile="AdVideoFirstQuartile",VpaidEventsEnum.AdVideoMidpoint="AdVideoMidpoint",VpaidEventsEnum.AdVideoThirdQuartile="AdVideoThirdQuartile",VpaidEventsEnum.AdVideoComplete="AdVideoComplete",VpaidEventsEnum.AdClickThru="AdClickThru",VpaidEventsEnum.AdInteraction="AdInteraction",VpaidEventsEnum.AdUserAcceptInvitation="AdUserAcceptInvitation",VpaidEventsEnum.AdUserMinimize="AdUserMinimize",VpaidEventsEnum.AdUserClose="AdUserClose",VpaidEventsEnum.AdPaused="AdPaused",VpaidEventsEnum.AdPlaying="AdPlaying",VpaidEventsEnum.AdLog="AdLog",VpaidEventsEnum.AdError="AdError"}(VpaidEventsEnum||(VpaidEventsEnum={}))},function(module,__webpack_exports__,__webpack_require__){"use strict";var EnvironmentConfig=__webpack_require__(27),XhrUtils=__webpack_require__(35),protos=__webpack_require__(0),EndPointResolver=__webpack_require__(22),LoggingStorage=__webpack_require__(44),LOG_THROTTLING_ENABLED=!0,LOG_THROTTLING_MAX_LOGS=30,LoggingStateStorage=__webpack_require__(56);__webpack_require__.d(__webpack_exports__,"a",function(){return cnxLog});var __rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t},MAX_CALLSTACK_LENGTH=500,pageUrl=window.location&&window.location.href,_playerDestroyed=!1;try{pageUrl=window.top.location.href}catch(e){}function cnxLog(_a){var _a$throttle=_a.throttle,throttle=void 0===_a$throttle?LOG_THROTTLING_MAX_LOGS:_a$throttle,_a$sendMaxLog=_a.sendMaxLog,sendMaxLog=void 0===_a$sendMaxLog||_a$sendMaxLog,_a$logJsonState=_a.logJsonState,logJsonState=void 0!==_a$logJsonState&&_a$logJsonState,requestData=__rest(_a,["throttle","sendMaxLog","logJsonState"]);if(!_playerDestroyed)if(requestData.playerDestroyed&&(_playerDestroyed=!0),requestData.sessionId=LoggingStorage.a.sessionId,LOG_THROTTLING_ENABLED&&(LoggingStorage.a.incrementLogCount(requestData.message),LoggingStorage.a.isMaxLogOverflow(requestData.message)&&cnxLog({message:"Logging_max_log_overflow_1000",exception:requestData.message,callStack:requestData.callStack,level:protos.ProtoLoggingLevelEnum.FATAL,sendMaxLog:!1,throttle:100,sessionId:LoggingStorage.a.sessionId}),LoggingStorage.a.isMaxLog(requestData.message,throttle)))sendMaxLog&&!LoggingStorage.a.isMaxLogSent(requestData.message)&&(LoggingStorage.a.setMaxLogSent(requestData.message),cnxLog({message:"Logging_max_log_sent",exception:requestData.message,callStack:requestData.callStack,level:protos.ProtoLoggingLevelEnum.FATAL,sessionId:LoggingStorage.a.sessionId}));else{if(logJsonState&&(requestData.callStack=LoggingStateStorage.a.getJsonString()),void 0===requestData.callStack){var error=new Error(requestData.message);requestData.callStack=error.stack}if(requestData.callStack=requestData.callStack.substring(0,MAX_CALLSTACK_LENGTH),EnvironmentConfig.a.logToServer){var endpoint;requestData.pageUrl=pageUrl,requestData.version=EnvironmentConfig.a.version;try{endpoint=EndPointResolver.a.endPoints.tracking.logging}catch(e){endpoint=EndPointResolver.a.defaultErrorLogging}var requestOptions={requestData:requestData,endpoint:endpoint,ProtoRequest:protos.ProtoLoggingRequest,logError:!0};requestData.sendBeacon?XhrUtils.a.sendProtoBeaconRequest(requestOptions):XhrUtils.a.sendProtoRequest(requestOptions).catch(function(e){})}EnvironmentConfig.a.logToConsole&&function(requestData){var loggingCollor;switch(requestData.level){case protos.ProtoLoggingLevelEnum.FATAL:loggingCollor="#8B0000";break;case protos.ProtoLoggingLevelEnum.WARNING:loggingCollor="#FF8C00";break;case protos.ProtoLoggingLevelEnum.INFO:loggingCollor="#000000"}console.log("%cConnatix Logging:\n   message: ".concat(requestData.message,"\n   exception: ").concat(requestData.exception,"\n   level: ").concat(requestData.level,"\n   version: ").concat(requestData.version,"\n   sessionId: ").concat(requestData.sessionId,"\n   callStack: ").concat(requestData.callStack),"color:".concat(loggingCollor))}(requestData)}}},function(module,exports,__webpack_require__){__webpack_require__(3);var superPropBase=__webpack_require__(299);function _get(target,property,receiver){return"undefined"!=typeof Reflect&&Reflect.get?module.exports=_get=Reflect.get:module.exports=_get=function(target,property,receiver){var base=superPropBase(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}},_get(target,property,receiver||target)}module.exports=_get},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",function(){return inArray}),__webpack_require__.d(__webpack_exports__,"m",function(){return toArray}),__webpack_require__.d(__webpack_exports__,"e",function(){return filterArrayByUniqueObjectProp}),__webpack_require__.d(__webpack_exports__,"c",function(){return convertIteratorToArray}),__webpack_require__.d(__webpack_exports__,"f",function(){return getStringArrayFromEnum}),__webpack_require__.d(__webpack_exports__,"h",function(){return isArrayDefined}),__webpack_require__.d(__webpack_exports__,"i",function(){return isArrayNumber}),__webpack_require__.d(__webpack_exports__,"l",function(){return serializeArray}),__webpack_require__.d(__webpack_exports__,"j",function(){return isEqualArrays}),__webpack_require__.d(__webpack_exports__,"a",function(){return arrayDifference}),__webpack_require__.d(__webpack_exports__,"b",function(){return arrayIntersection}),__webpack_require__.d(__webpack_exports__,"n",function(){return uniqueArrayItems}),__webpack_require__.d(__webpack_exports__,"k",function(){return removeItemFromArray}),__webpack_require__.d(__webpack_exports__,"d",function(){return convertSetToArray});var _ObjectUtils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(45),_GeneralUtils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(15),Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4),Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(11),Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(0);function inArray(needle,haystack){return haystack.indexOf(needle)>-1}function toArray(toTransform){return Array.isArray(toTransform)?toTransform:[toTransform]}function filterArrayByUniqueObjectProp(propertyName,objectArray){var result=[],map=new Map;return objectArray.forEach(function(object){map.has(object[propertyName])||(map.set(object[propertyName],!0),result.push(object))}),result}function convertIteratorToArray(iterator){return[].slice.call(iterator)}function getStringArrayFromEnum(enumerator){var stringArray=[];for(var prop in enumerator)prop&&parseInt(prop,10)>=0&&stringArray.push(enumerator[prop]);return stringArray}function isArrayDefined(array){return array&&array.length>0}function isArrayNumber(array){return array.every(function(value){return Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_2__.d)(value)})}function serializeArray(array){for(var arrayString="[",i=0;i<array.length;i++)arrayString+=Object(_ObjectUtils__WEBPACK_IMPORTED_MODULE_0__.c)(array[i])+(i===array.length-1?"":",");return arrayString+="]"}function isEqualArrays(a,b){return!(!a||!b)&&(a.length===b.length&&(a===b||0===a.length&&0===b.length||a.every(function(itemA,index){return Object(_GeneralUtils__WEBPACK_IMPORTED_MODULE_1__.i)(itemA,b[index])})))}function arrayDifference(firstArray,secondArray){return firstArray.filter(function(item){return!secondArray.includes(item)})}function arrayIntersection(firstArray,secondArray){return firstArray.filter(function(item){return secondArray.includes(item)})}function uniqueArrayItems(array){return array.filter(function(item,position){return array.indexOf(item)===position})}function removeItemFromArray(arr,item){var indexOfItem=arr.indexOf(item);-1!==indexOfItem?arr.splice(indexOfItem,1):Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_3__.a)({message:"removeItemFromArray_error_item_not_found",exception:JSON.stringify(item),level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_4__.ProtoLoggingLevelEnum.WARNING})}function convertSetToArray(set){var array=[];return set.forEach(function(item){return array.push(item)}),array}},function(module,exports,__webpack_require__){var arrayWithoutHoles=__webpack_require__(274),iterableToArray=__webpack_require__(275),nonIterableSpread=__webpack_require__(276);module.exports=function(arr){return arrayWithoutHoles(arr)||iterableToArray(arr)||nonIterableSpread()}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",function(){return generateGUID}),__webpack_require__.d(__webpack_exports__,"d",function(){return generateGUIDWithoutDashes}),__webpack_require__.d(__webpack_exports__,"e",function(){return getBestPageUrl}),__webpack_require__.d(__webpack_exports__,"g",function(){return getUrlComponentsFromString}),__webpack_require__.d(__webpack_exports__,"f",function(){return getClosestTop}),__webpack_require__.d(__webpack_exports__,"m",function(){return trackWithImages}),__webpack_require__.d(__webpack_exports__,"l",function(){return selectAB}),__webpack_require__.d(__webpack_exports__,"b",function(){return checkAutoplayWithSound}),__webpack_require__.d(__webpack_exports__,"a",function(){return callAsync}),__webpack_require__.d(__webpack_exports__,"i",function(){return isEqualBase}),__webpack_require__.d(__webpack_exports__,"h",function(){return hasClassInTargetParents}),__webpack_require__.d(__webpack_exports__,"j",function(){return lightenHexToHsl}),__webpack_require__.d(__webpack_exports__,"k",function(){return retryPromise});var Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(26),Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4),Common_Utils_ObjectUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(45),Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(13);function generateGUID(){var dateVar=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(stringChar){var random=(dateVar+16*Math.random())%16|0;return dateVar=Math.floor(dateVar/16),("x"===stringChar?random:3&random|8).toString(16)})}function generateGUIDWithoutDashes(){return generateGUID().replace(/-/g,"")}function getBestPageUrl(closest,GLOBAL){var bestPageUrl="";if(!closest.err)try{bestPageUrl=closest.topFrame.location.href}catch(e){}if(!bestPageUrl||0===bestPageUrl.length)try{bestPageUrl=GLOBAL.top.location.href}catch(e){}if(!bestPageUrl||0===bestPageUrl.length)try{bestPageUrl=closest.topFrame.document.referrer}catch(e){}return bestPageUrl}function getUrlComponentsFromString(locationString){try{var urlParts=locationString.match(/^(https?:)\/\/(([^:\/?#]*)(?::([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);return{href:locationString,protocol:urlParts[1],host:urlParts[2],hostname:urlParts[3],port:urlParts[4],pathname:urlParts[5],search:urlParts[6],hash:urlParts[7]}}catch(e){return null}}function getClosestTop(GLOBAL){var frame=GLOBAL,previousFrame=null,exc=!1;try{for(;frame.parent.document!==frame.document;){if(!frame.parent.document){exc=!0;break}previousFrame=frame,frame=frame.parent}}catch(e){exc=!0}return{topFrame:frame,topChildFrame:previousFrame,err:exc}}function trackWithImages(){var requestUrls=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],GLOBAL=arguments.length>1?arguments[1]:void 0,requestData=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};requestUrls.forEach(function(requestUrl){var object,prefix,str;Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_1__.g)(requestUrl)&&((new GLOBAL.Image).src="".concat(requestUrl).concat(Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_0__.c)(requestUrl)).concat((object=requestData,str=[],Object.keys(object).forEach(function(propertyName){var k=prefix?"".concat(prefix,"[").concat(propertyName,"]"):propertyName,v=object[propertyName];if(Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_1__.f)(v))str.push("".concat(encodeURIComponent(k),"=").concat(Object(Common_Utils_ObjectUtils__WEBPACK_IMPORTED_MODULE_2__.c)(v)));else if(Array.isArray(v))str.push("".concat(encodeURIComponent(k),"=").concat(Object(Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_3__.l)(v)));else if(null!=v){var value=encodeURIComponent(v),key=encodeURIComponent(k);value&&key&&str.push("".concat(key,"=").concat(value))}}),str.join("&"))))})}function selectAB(percent){for(var r=Math.floor(100*Math.random()),no=0,p=0,i=0;i<percent.length;i++)if(r<(p+=percent[i])){no=i;break}return no}function checkAutoplayWithSound(){var pass=!1;try{var audioTest=document.createElement("audio");audioTest.volume=1,audioTest.muted=!1;var playPromise=audioTest.play();void 0!==playPromise&&playPromise.catch(function(){}),pass=!audioTest.paused,audioTest.pause()}catch(e){}return pass}function callAsync(callback){for(var _this=this,delay=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,_len=arguments.length,args=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++)args[_key-2]=arguments[_key];return setTimeout(function(){callback.apply(_this,args)},delay)}function isEqualBase(a,b){return Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_1__.f)(a)?Object(Common_Utils_ObjectUtils__WEBPACK_IMPORTED_MODULE_2__.b)(a,b):Array.isArray(a)?Object(Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_3__.j)(a,b):a===b}function hasClassInTargetParents(target,className,levels){for(var steps=0,container=target;steps<=levels;){if(steps++,container.classList.contains(className))return!0;if(!(container=container.parentElement))return!1}return!1}function lightenHexToHsl(hex,percentage){try{var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex),r=parseInt(result[1],16),g=parseInt(result[2],16),b=parseInt(result[3],16);r/=255,g/=255,b/=255;var h,s,max=Math.max(r,g,b),min=Math.min(r,g,b),l=(max+min)/2;if(max===min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return h=Math.round(360*h),s=Math.round(100*s),l=Math.round(100*l),l+=percentage/100*(100-l),"hsl(".concat(h,",").concat(s,"%,").concat(l,"%)")}catch(e){return hex}}function retryPromise(promise){var retriesLeft=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return new Promise(function(resolve,reject){promise().then(resolve).catch(function(error){1!==retriesLeft?retryPromise(promise,retriesLeft-1).then(resolve,reject):reject(error)})})}},function(module,exports){module.exports=function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}},function(module,__webpack_exports__,__webpack_require__){"use strict";var UiInteractionEventsEnum;!function(UiInteractionEventsEnum){UiInteractionEventsEnum[UiInteractionEventsEnum.HoldStart=0]="HoldStart",UiInteractionEventsEnum[UiInteractionEventsEnum.HoldEnd=1]="HoldEnd",UiInteractionEventsEnum[UiInteractionEventsEnum.TapLeft=2]="TapLeft",UiInteractionEventsEnum[UiInteractionEventsEnum.TapRight=3]="TapRight",UiInteractionEventsEnum[UiInteractionEventsEnum.SwipeEnd=4]="SwipeEnd",UiInteractionEventsEnum[UiInteractionEventsEnum.SwipeMove=5]="SwipeMove",UiInteractionEventsEnum[UiInteractionEventsEnum.Scroll=6]="Scroll",UiInteractionEventsEnum[UiInteractionEventsEnum.Click=7]="Click"}(UiInteractionEventsEnum||(UiInteractionEventsEnum={})),__webpack_exports__.a=UiInteractionEventsEnum},function(module,exports,__webpack_require__){"use strict";var valuesById,values,$protobuf=__webpack_require__(121),$Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots.default||($protobuf.roots.default={});$root.ProtoPlayspaceVideoSlideRendition=function(){function ProtoPlayspaceVideoSlideRendition(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceVideoSlideRendition.prototype.width=0,ProtoPlayspaceVideoSlideRendition.prototype.height=0,ProtoPlayspaceVideoSlideRendition.prototype.videoUrl="",ProtoPlayspaceVideoSlideRendition.prototype.codec=0,ProtoPlayspaceVideoSlideRendition.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceVideoSlideRendition;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.width=reader.int32();break;case 2:message.height=reader.int32();break;case 3:message.videoUrl=reader.string();break;case 4:message.codec=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceVideoSlideRendition.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.width=0,object.height=0,object.videoUrl="",object.codec=options.enums===String?"h264":0),null!=message.width&&message.hasOwnProperty("width")&&(object.width=message.width),null!=message.height&&message.hasOwnProperty("height")&&(object.height=message.height),null!=message.videoUrl&&message.hasOwnProperty("videoUrl")&&(object.videoUrl=message.videoUrl),null!=message.codec&&message.hasOwnProperty("codec")&&(object.codec=options.enums===String?$root.ProtoPlayspaceCodecEnum[message.codec]:message.codec),object},ProtoPlayspaceVideoSlideRendition}(),$root.ProtoPlayspaceVideoSettings=function(){function ProtoPlayspaceVideoSettings(properties){if(this.renditions=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceVideoSettings.prototype.renditions=$util.emptyArray,ProtoPlayspaceVideoSettings.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceVideoSettings;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.renditions&&message.renditions.length||(message.renditions=[]),message.renditions.push($root.ProtoPlayspaceVideoSlideRendition.decode(reader,reader.uint32()));break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceVideoSettings.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.renditions=[]),message.renditions&&message.renditions.length){object.renditions=[];for(var j=0;j<message.renditions.length;++j)object.renditions[j]=$root.ProtoPlayspaceVideoSlideRendition.toObject(message.renditions[j],options)}return object},ProtoPlayspaceVideoSettings}(),$root.ProtoSlideCapabilityMetadata=function(){function ProtoSlideCapabilityMetadata(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoSlideCapabilityMetadata.prototype.label="",ProtoSlideCapabilityMetadata.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoSlideCapabilityMetadata;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.label=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoSlideCapabilityMetadata.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.label=""),null!=message.label&&message.hasOwnProperty("label")&&(object.label=message.label),object},ProtoSlideCapabilityMetadata}(),$root.ProtoPlayspaceSlideCapability=function(){function ProtoPlayspaceSlideCapability(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceSlideCapability.prototype.type=0,ProtoPlayspaceSlideCapability.prototype.metadata=null,ProtoPlayspaceSlideCapability.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceSlideCapability;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.type=reader.int32();break;case 2:message.metadata=$root.ProtoSlideCapabilityMetadata.decode(reader,reader.uint32());break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceSlideCapability.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.type=options.enums===String?"VolumeControls":0,object.metadata=null),null!=message.type&&message.hasOwnProperty("type")&&(object.type=options.enums===String?$root.ProtoPlayspaceSlideCapabilitiesEnum[message.type]:message.type),null!=message.metadata&&message.hasOwnProperty("metadata")&&(object.metadata=$root.ProtoSlideCapabilityMetadata.toObject(message.metadata,options)),object},ProtoPlayspaceSlideCapability}(),$root.ProtoFallbackStoryResponse=function(){function ProtoFallbackStoryResponse(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoFallbackStoryResponse.prototype.storyId="",ProtoFallbackStoryResponse.prototype.activeVersionId="",ProtoFallbackStoryResponse.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoFallbackStoryResponse;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.storyId=reader.string();break;case 2:message.activeVersionId=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoFallbackStoryResponse.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.storyId="",object.activeVersionId=""),null!=message.storyId&&message.hasOwnProperty("storyId")&&(object.storyId=message.storyId),null!=message.activeVersionId&&message.hasOwnProperty("activeVersionId")&&(object.activeVersionId=message.activeVersionId),object},ProtoFallbackStoryResponse}(),$root.ProtoPlayspaceMediaMetadataResponse=function(){function ProtoPlayspaceMediaMetadataResponse(properties){if(this.slides=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceMediaMetadataResponse.prototype.slides=$util.emptyArray,ProtoPlayspaceMediaMetadataResponse.prototype.storyTitle="",ProtoPlayspaceMediaMetadataResponse.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceMediaMetadataResponse;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.slides&&message.slides.length||(message.slides=[]),message.slides.push($root.ProtoPlayspaceSlideMetadata.decode(reader,reader.uint32()));break;case 2:message.storyTitle=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceMediaMetadataResponse.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.slides=[]),options.defaults&&(object.storyTitle=""),message.slides&&message.slides.length){object.slides=[];for(var j=0;j<message.slides.length;++j)object.slides[j]=$root.ProtoPlayspaceSlideMetadata.toObject(message.slides[j],options)}return null!=message.storyTitle&&message.hasOwnProperty("storyTitle")&&(object.storyTitle=message.storyTitle),object},ProtoPlayspaceMediaMetadataResponse}(),$root.ProtoPlayspaceSlideMetadata=function(){function ProtoPlayspaceSlideMetadata(properties){if(this.capabilityList=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceSlideMetadata.prototype.mediaType=0,ProtoPlayspaceSlideMetadata.prototype.title="",ProtoPlayspaceSlideMetadata.prototype.clickUrl="",ProtoPlayspaceSlideMetadata.prototype.imageUrl="",ProtoPlayspaceSlideMetadata.prototype.slideDuration=0,ProtoPlayspaceSlideMetadata.prototype.videoRendition=null,ProtoPlayspaceSlideMetadata.prototype.type=0,ProtoPlayspaceSlideMetadata.prototype.coverMetadata=null,ProtoPlayspaceSlideMetadata.prototype.descriptionMetadata=null,ProtoPlayspaceSlideMetadata.prototype.bulletListMetadata=null,ProtoPlayspaceSlideMetadata.prototype.quoteMetadata=null,ProtoPlayspaceSlideMetadata.prototype.instagramMetadata=null,ProtoPlayspaceSlideMetadata.prototype.capabilityList=$util.emptyArray,ProtoPlayspaceSlideMetadata.prototype.portraitImageUrl="",ProtoPlayspaceSlideMetadata.prototype.mediaContext=0,ProtoPlayspaceSlideMetadata.prototype.altText="",ProtoPlayspaceSlideMetadata.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceSlideMetadata;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.mediaType=reader.int32();break;case 2:message.title=reader.string();break;case 3:message.clickUrl=reader.string();break;case 4:message.imageUrl=reader.string();break;case 5:message.slideDuration=reader.int32();break;case 6:message.videoRendition=$root.ProtoPlayspaceVideoSettings.decode(reader,reader.uint32());break;case 7:message.type=reader.int32();break;case 8:message.coverMetadata=$root.ProtoPlayspaceCoverMetadata.decode(reader,reader.uint32());break;case 9:message.descriptionMetadata=$root.ProtoPlayspaceDescriptionMetadata.decode(reader,reader.uint32());break;case 10:message.bulletListMetadata=$root.ProtoPlayspaceBulletListMetadata.decode(reader,reader.uint32());break;case 12:message.quoteMetadata=$root.ProtoPlayspaceQuoteMetadata.decode(reader,reader.uint32());break;case 16:message.instagramMetadata=$root.ProtoPlayspaceInstagramMetadata.decode(reader,reader.uint32());break;case 13:message.capabilityList&&message.capabilityList.length||(message.capabilityList=[]),message.capabilityList.push($root.ProtoPlayspaceSlideCapability.decode(reader,reader.uint32()));break;case 14:message.portraitImageUrl=reader.string();break;case 15:message.mediaContext=reader.int32();break;case 17:message.altText=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceSlideMetadata.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.capabilityList=[]),options.defaults&&(object.mediaType=options.enums===String?"Image":0,object.title="",object.clickUrl="",object.imageUrl="",object.slideDuration=0,object.videoRendition=null,object.type=options.enums===String?"Default":0,object.coverMetadata=null,object.descriptionMetadata=null,object.bulletListMetadata=null,object.quoteMetadata=null,object.portraitImageUrl="",object.mediaContext=options.enums===String?"None":0,object.instagramMetadata=null,object.altText=""),null!=message.mediaType&&message.hasOwnProperty("mediaType")&&(object.mediaType=options.enums===String?$root.ProtoMediaTypeEnum[message.mediaType]:message.mediaType),null!=message.title&&message.hasOwnProperty("title")&&(object.title=message.title),null!=message.clickUrl&&message.hasOwnProperty("clickUrl")&&(object.clickUrl=message.clickUrl),null!=message.imageUrl&&message.hasOwnProperty("imageUrl")&&(object.imageUrl=message.imageUrl),null!=message.slideDuration&&message.hasOwnProperty("slideDuration")&&(object.slideDuration=message.slideDuration),null!=message.videoRendition&&message.hasOwnProperty("videoRendition")&&(object.videoRendition=$root.ProtoPlayspaceVideoSettings.toObject(message.videoRendition,options)),null!=message.type&&message.hasOwnProperty("type")&&(object.type=options.enums===String?$root.ProtoPlayspaceSlideTypeEnum[message.type]:message.type),null!=message.coverMetadata&&message.hasOwnProperty("coverMetadata")&&(object.coverMetadata=$root.ProtoPlayspaceCoverMetadata.toObject(message.coverMetadata,options)),null!=message.descriptionMetadata&&message.hasOwnProperty("descriptionMetadata")&&(object.descriptionMetadata=$root.ProtoPlayspaceDescriptionMetadata.toObject(message.descriptionMetadata,options)),null!=message.bulletListMetadata&&message.hasOwnProperty("bulletListMetadata")&&(object.bulletListMetadata=$root.ProtoPlayspaceBulletListMetadata.toObject(message.bulletListMetadata,options)),null!=message.quoteMetadata&&message.hasOwnProperty("quoteMetadata")&&(object.quoteMetadata=$root.ProtoPlayspaceQuoteMetadata.toObject(message.quoteMetadata,options)),message.capabilityList&&message.capabilityList.length){object.capabilityList=[];for(var j=0;j<message.capabilityList.length;++j)object.capabilityList[j]=$root.ProtoPlayspaceSlideCapability.toObject(message.capabilityList[j],options)}return null!=message.portraitImageUrl&&message.hasOwnProperty("portraitImageUrl")&&(object.portraitImageUrl=message.portraitImageUrl),null!=message.mediaContext&&message.hasOwnProperty("mediaContext")&&(object.mediaContext=options.enums===String?$root.ProtoMediaContextEnum[message.mediaContext]:message.mediaContext),null!=message.instagramMetadata&&message.hasOwnProperty("instagramMetadata")&&(object.instagramMetadata=$root.ProtoPlayspaceInstagramMetadata.toObject(message.instagramMetadata,options)),null!=message.altText&&message.hasOwnProperty("altText")&&(object.altText=message.altText),object},ProtoPlayspaceSlideMetadata}(),$root.ProtoPlayspaceCoverMetadata=function(){function ProtoPlayspaceCoverMetadata(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceCoverMetadata.prototype.title="",ProtoPlayspaceCoverMetadata.prototype.subtitle="",ProtoPlayspaceCoverMetadata.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceCoverMetadata;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.title=reader.string();break;case 2:message.subtitle=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceCoverMetadata.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.title="",object.subtitle=""),null!=message.title&&message.hasOwnProperty("title")&&(object.title=message.title),null!=message.subtitle&&message.hasOwnProperty("subtitle")&&(object.subtitle=message.subtitle),object},ProtoPlayspaceCoverMetadata}(),$root.ProtoPlayspaceDescriptionChunk=function(){function ProtoPlayspaceDescriptionChunk(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceDescriptionChunk.prototype.text="",ProtoPlayspaceDescriptionChunk.prototype.colorScheme=0,ProtoPlayspaceDescriptionChunk.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceDescriptionChunk;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.text=reader.string();break;case 2:message.colorScheme=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceDescriptionChunk.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.text="",object.colorScheme=options.enums===String?"Default":0),null!=message.text&&message.hasOwnProperty("text")&&(object.text=message.text),null!=message.colorScheme&&message.hasOwnProperty("colorScheme")&&(object.colorScheme=options.enums===String?$root.ProtoPlayspaceColorSchemeEnum[message.colorScheme]:message.colorScheme),object},ProtoPlayspaceDescriptionChunk}(),$root.ProtoPlayspaceDescriptionMetadata=function(){function ProtoPlayspaceDescriptionMetadata(properties){if(this.chunkList=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceDescriptionMetadata.prototype.chunkList=$util.emptyArray,ProtoPlayspaceDescriptionMetadata.prototype.label=null,ProtoPlayspaceDescriptionMetadata.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceDescriptionMetadata;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.chunkList&&message.chunkList.length||(message.chunkList=[]),message.chunkList.push($root.ProtoPlayspaceDescriptionChunk.decode(reader,reader.uint32()));break;case 2:message.label=$root.ProtoPlayspaceDescriptionChunk.decode(reader,reader.uint32());break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceDescriptionMetadata.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.chunkList=[]),options.defaults&&(object.label=null),message.chunkList&&message.chunkList.length){object.chunkList=[];for(var j=0;j<message.chunkList.length;++j)object.chunkList[j]=$root.ProtoPlayspaceDescriptionChunk.toObject(message.chunkList[j],options)}return null!=message.label&&message.hasOwnProperty("label")&&(object.label=$root.ProtoPlayspaceDescriptionChunk.toObject(message.label,options)),object},ProtoPlayspaceDescriptionMetadata}(),$root.ProtoBulletOptions=function(){function ProtoBulletOptions(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoBulletOptions.prototype.title="",ProtoBulletOptions.prototype.description="",ProtoBulletOptions.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoBulletOptions;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.title=reader.string();break;case 2:message.description=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoBulletOptions.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.title="",object.description=""),null!=message.title&&message.hasOwnProperty("title")&&(object.title=message.title),null!=message.description&&message.hasOwnProperty("description")&&(object.description=message.description),object},ProtoBulletOptions}(),$root.ProtoPlayspaceBulletListMetadata=function(){function ProtoPlayspaceBulletListMetadata(properties){if(this.items=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceBulletListMetadata.prototype.title="",ProtoPlayspaceBulletListMetadata.prototype.items=$util.emptyArray,ProtoPlayspaceBulletListMetadata.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceBulletListMetadata;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.title=reader.string();break;case 2:message.items&&message.items.length||(message.items=[]),message.items.push($root.ProtoBulletOptions.decode(reader,reader.uint32()));break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceBulletListMetadata.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.items=[]),options.defaults&&(object.title=""),null!=message.title&&message.hasOwnProperty("title")&&(object.title=message.title),message.items&&message.items.length){object.items=[];for(var j=0;j<message.items.length;++j)object.items[j]=$root.ProtoBulletOptions.toObject(message.items[j],options)}return object},ProtoPlayspaceBulletListMetadata}(),$root.ProtoPlayspaceQuoteMetadata=function(){function ProtoPlayspaceQuoteMetadata(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceQuoteMetadata.prototype.text="",ProtoPlayspaceQuoteMetadata.prototype.source="",ProtoPlayspaceQuoteMetadata.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceQuoteMetadata;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.text=reader.string();break;case 2:message.source=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceQuoteMetadata.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.text="",object.source=""),null!=message.text&&message.hasOwnProperty("text")&&(object.text=message.text),null!=message.source&&message.hasOwnProperty("source")&&(object.source=message.source),object},ProtoPlayspaceQuoteMetadata}(),$root.ProtoPlayspaceInstagramMetadata=function(){function ProtoPlayspaceInstagramMetadata(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceInstagramMetadata.prototype.handle="",ProtoPlayspaceInstagramMetadata.prototype.createdDate="",ProtoPlayspaceInstagramMetadata.prototype.likes="",ProtoPlayspaceInstagramMetadata.prototype.comments="",ProtoPlayspaceInstagramMetadata.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceInstagramMetadata;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.handle=reader.string();break;case 2:message.createdDate=reader.string();break;case 3:message.likes=reader.string();break;case 4:message.comments=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceInstagramMetadata.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.handle="",object.createdDate="",object.likes="",object.comments=""),null!=message.handle&&message.hasOwnProperty("handle")&&(object.handle=message.handle),null!=message.createdDate&&message.hasOwnProperty("createdDate")&&(object.createdDate=message.createdDate),null!=message.likes&&message.hasOwnProperty("likes")&&(object.likes=message.likes),null!=message.comments&&message.hasOwnProperty("comments")&&(object.comments=message.comments),object},ProtoPlayspaceInstagramMetadata}(),$root.ProtoPlayspaceColorPrimary=function(){function ProtoPlayspaceColorPrimary(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceColorPrimary.prototype.background="#F1F1F1",ProtoPlayspaceColorPrimary.prototype.foreground="#000000",ProtoPlayspaceColorPrimary.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceColorPrimary;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.background=reader.string();break;case 2:message.foreground=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceColorPrimary.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.background="#F1F1F1",object.foreground="#000000"),null!=message.background&&message.hasOwnProperty("background")&&(object.background=message.background),null!=message.foreground&&message.hasOwnProperty("foreground")&&(object.foreground=message.foreground),object},ProtoPlayspaceColorPrimary}(),$root.ProtoPlayspaceColorSecondary=function(){function ProtoPlayspaceColorSecondary(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceColorSecondary.prototype.background="#000000 ",ProtoPlayspaceColorSecondary.prototype.foreground="#F1F1F1",ProtoPlayspaceColorSecondary.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceColorSecondary;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.background=reader.string();break;case 2:message.foreground=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceColorSecondary.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.background="#000000 ",object.foreground="#F1F1F1"),null!=message.background&&message.hasOwnProperty("background")&&(object.background=message.background),null!=message.foreground&&message.hasOwnProperty("foreground")&&(object.foreground=message.foreground),object},ProtoPlayspaceColorSecondary}(),$root.ProtoPlayspaceColorAccent=function(){function ProtoPlayspaceColorAccent(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceColorAccent.prototype.background="",ProtoPlayspaceColorAccent.prototype.foreground="",ProtoPlayspaceColorAccent.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceColorAccent;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.background=reader.string();break;case 2:message.foreground=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceColorAccent.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.background="",object.foreground=""),null!=message.background&&message.hasOwnProperty("background")&&(object.background=message.background),null!=message.foreground&&message.hasOwnProperty("foreground")&&(object.foreground=message.foreground),object},ProtoPlayspaceColorAccent}(),$root.ProtoPlayspaceRequest=function(){function ProtoPlayspaceRequest(properties){if(this.tokens=[],this.forceLineItemIds=[],this.queryJsTargeting={},this.reloadedPlayers={},properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceRequest.prototype.tokens=$util.emptyArray,ProtoPlayspaceRequest.prototype.pageUrl="",ProtoPlayspaceRequest.prototype.userId="",ProtoPlayspaceRequest.prototype.forcePlayerId="",ProtoPlayspaceRequest.prototype.forceStoryId="",ProtoPlayspaceRequest.prototype.version=0,ProtoPlayspaceRequest.prototype.clientAb0=0,ProtoPlayspaceRequest.prototype.clientAb1=0,ProtoPlayspaceRequest.prototype.forceLineItemIds=$util.emptyArray,ProtoPlayspaceRequest.prototype.customParam1="",ProtoPlayspaceRequest.prototype.customParam2="",ProtoPlayspaceRequest.prototype.customParam3="",ProtoPlayspaceRequest.prototype.forceExploration=!1,ProtoPlayspaceRequest.prototype.es6=!1,ProtoPlayspaceRequest.prototype.bundleId="",ProtoPlayspaceRequest.prototype.parseDomain=!1,ProtoPlayspaceRequest.prototype.implementationType=0,ProtoPlayspaceRequest.prototype.queryJsTargeting=$util.emptyObject,ProtoPlayspaceRequest.prototype.isConsentConnatix=!0,ProtoPlayspaceRequest.prototype.reloadedPlayers=$util.emptyObject,ProtoPlayspaceRequest.prototype.disableTracking=!1,ProtoPlayspaceRequest.prototype.referrer="",ProtoPlayspaceRequest.prototype.customParam4="",ProtoPlayspaceRequest.prototype.customParam5="",ProtoPlayspaceRequest.encode=function(message,writer){if(writer||(writer=$Writer.create()),null!=message.tokens&&message.tokens.length)for(var i=0;i<message.tokens.length;++i)writer.uint32(10).string(message.tokens[i]);if(null!=message.pageUrl&&Object.hasOwnProperty.call(message,"pageUrl")&&writer.uint32(26).string(message.pageUrl),null!=message.userId&&Object.hasOwnProperty.call(message,"userId")&&writer.uint32(42).string(message.userId),null!=message.forcePlayerId&&Object.hasOwnProperty.call(message,"forcePlayerId")&&writer.uint32(58).string(message.forcePlayerId),null!=message.forceStoryId&&Object.hasOwnProperty.call(message,"forceStoryId")&&writer.uint32(66).string(message.forceStoryId),null!=message.version&&Object.hasOwnProperty.call(message,"version")&&writer.uint32(72).int32(message.version),null!=message.clientAb0&&Object.hasOwnProperty.call(message,"clientAb0")&&writer.uint32(80).int32(message.clientAb0),null!=message.clientAb1&&Object.hasOwnProperty.call(message,"clientAb1")&&writer.uint32(88).int32(message.clientAb1),null!=message.forceLineItemIds&&message.forceLineItemIds.length)for(i=0;i<message.forceLineItemIds.length;++i)writer.uint32(98).string(message.forceLineItemIds[i]);if(null!=message.customParam1&&Object.hasOwnProperty.call(message,"customParam1")&&writer.uint32(114).string(message.customParam1),null!=message.customParam2&&Object.hasOwnProperty.call(message,"customParam2")&&writer.uint32(122).string(message.customParam2),null!=message.customParam3&&Object.hasOwnProperty.call(message,"customParam3")&&writer.uint32(130).string(message.customParam3),null!=message.forceExploration&&Object.hasOwnProperty.call(message,"forceExploration")&&writer.uint32(136).bool(message.forceExploration),null!=message.es6&&Object.hasOwnProperty.call(message,"es6")&&writer.uint32(144).bool(message.es6),null!=message.bundleId&&Object.hasOwnProperty.call(message,"bundleId")&&writer.uint32(154).string(message.bundleId),null!=message.parseDomain&&Object.hasOwnProperty.call(message,"parseDomain")&&writer.uint32(160).bool(message.parseDomain),null!=message.implementationType&&Object.hasOwnProperty.call(message,"implementationType")&&writer.uint32(168).int32(message.implementationType),null!=message.queryJsTargeting&&Object.hasOwnProperty.call(message,"queryJsTargeting")){var keys=Object.keys(message.queryJsTargeting);for(i=0;i<keys.length;++i)writer.uint32(178).fork().uint32(10).string(keys[i]).uint32(18).string(message.queryJsTargeting[keys[i]]).ldelim()}if(null!=message.isConsentConnatix&&Object.hasOwnProperty.call(message,"isConsentConnatix")&&writer.uint32(184).bool(message.isConsentConnatix),null!=message.reloadedPlayers&&Object.hasOwnProperty.call(message,"reloadedPlayers"))for(keys=Object.keys(message.reloadedPlayers),i=0;i<keys.length;++i)writer.uint32(202).fork().uint32(10).string(keys[i]).uint32(18).string(message.reloadedPlayers[keys[i]]).ldelim();return null!=message.disableTracking&&Object.hasOwnProperty.call(message,"disableTracking")&&writer.uint32(216).bool(message.disableTracking),null!=message.referrer&&Object.hasOwnProperty.call(message,"referrer")&&writer.uint32(226).string(message.referrer),null!=message.customParam4&&Object.hasOwnProperty.call(message,"customParam4")&&writer.uint32(234).string(message.customParam4),null!=message.customParam5&&Object.hasOwnProperty.call(message,"customParam5")&&writer.uint32(242).string(message.customParam5),writer},ProtoPlayspaceRequest.fromObject=function(object){if(object instanceof $root.ProtoPlayspaceRequest)return object;var message=new $root.ProtoPlayspaceRequest;if(object.tokens){if(!Array.isArray(object.tokens))throw TypeError(".ProtoPlayspaceRequest.tokens: array expected");message.tokens=[];for(var i=0;i<object.tokens.length;++i)message.tokens[i]=String(object.tokens[i])}if(null!=object.pageUrl&&(message.pageUrl=String(object.pageUrl)),null!=object.userId&&(message.userId=String(object.userId)),null!=object.forcePlayerId&&(message.forcePlayerId=String(object.forcePlayerId)),null!=object.forceStoryId&&(message.forceStoryId=String(object.forceStoryId)),null!=object.version&&(message.version=0|object.version),null!=object.clientAb0&&(message.clientAb0=0|object.clientAb0),null!=object.clientAb1&&(message.clientAb1=0|object.clientAb1),object.forceLineItemIds){if(!Array.isArray(object.forceLineItemIds))throw TypeError(".ProtoPlayspaceRequest.forceLineItemIds: array expected");message.forceLineItemIds=[];for(i=0;i<object.forceLineItemIds.length;++i)message.forceLineItemIds[i]=String(object.forceLineItemIds[i])}switch(null!=object.customParam1&&(message.customParam1=String(object.customParam1)),null!=object.customParam2&&(message.customParam2=String(object.customParam2)),null!=object.customParam3&&(message.customParam3=String(object.customParam3)),null!=object.forceExploration&&(message.forceExploration=Boolean(object.forceExploration)),null!=object.es6&&(message.es6=Boolean(object.es6)),null!=object.bundleId&&(message.bundleId=String(object.bundleId)),null!=object.parseDomain&&(message.parseDomain=Boolean(object.parseDomain)),object.implementationType){case"Web":case 0:message.implementationType=0;break;case"Amp":case 1:message.implementationType=1}if(object.queryJsTargeting){if("object"!=typeof object.queryJsTargeting)throw TypeError(".ProtoPlayspaceRequest.queryJsTargeting: object expected");message.queryJsTargeting={};var keys=Object.keys(object.queryJsTargeting);for(i=0;i<keys.length;++i)message.queryJsTargeting[keys[i]]=String(object.queryJsTargeting[keys[i]])}if(null!=object.isConsentConnatix&&(message.isConsentConnatix=Boolean(object.isConsentConnatix)),object.reloadedPlayers){if("object"!=typeof object.reloadedPlayers)throw TypeError(".ProtoPlayspaceRequest.reloadedPlayers: object expected");message.reloadedPlayers={};for(keys=Object.keys(object.reloadedPlayers),i=0;i<keys.length;++i)message.reloadedPlayers[keys[i]]=String(object.reloadedPlayers[keys[i]])}return null!=object.disableTracking&&(message.disableTracking=Boolean(object.disableTracking)),null!=object.referrer&&(message.referrer=String(object.referrer)),null!=object.customParam4&&(message.customParam4=String(object.customParam4)),null!=object.customParam5&&(message.customParam5=String(object.customParam5)),message},ProtoPlayspaceRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoPlayspaceRequest}(),$root.ProtoPlayspace=function(){function ProtoPlayspace(properties){if(this.sharingDestinations=[],this.floatingDeviceMode=[],this.lineItems=[],this.adBreaks=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspace.prototype.playerId="",ProtoPlayspace.prototype.playbackMode=0,ProtoPlayspace.prototype.soundMode=0,ProtoPlayspace.prototype.endOfCycleMode=0,ProtoPlayspace.prototype.containerSelector="",ProtoPlayspace.prototype.position=0,ProtoPlayspace.prototype.insertPosition=0,ProtoPlayspace.prototype.forceInsertPath=!1,ProtoPlayspace.prototype.renderInFrame=!1,ProtoPlayspace.prototype.scrollHijackingProtection=!1,ProtoPlayspace.prototype.preRollBreak=0,ProtoPlayspace.prototype.postRollBreak=0,ProtoPlayspace.prototype.midRollNumber=-1,ProtoPlayspace.prototype.slidesBetweenAds=0,ProtoPlayspace.prototype.minSlidesBeforeFirstAd=0,ProtoPlayspace.prototype.adViewabilityPolicy=0,ProtoPlayspace.prototype.casting=!1,ProtoPlayspace.prototype.sharingDestinations=$util.emptyArray,ProtoPlayspace.prototype.expandButton=!1,ProtoPlayspace.prototype.closeButtonMode=0,ProtoPlayspace.prototype.floatingMode=0,ProtoPlayspace.prototype.floatingDeviceMode=$util.emptyArray,ProtoPlayspace.prototype.floatingCloseButtonMode=0,ProtoPlayspace.prototype.floatingFixedPosition=0,ProtoPlayspace.prototype.floatingPageElement="",ProtoPlayspace.prototype.floatingUseElementWidth=!1,ProtoPlayspace.prototype.floatingScrollPosition=0,ProtoPlayspace.prototype.floatingGutterX=0,ProtoPlayspace.prototype.floatingGutterY=0,ProtoPlayspace.prototype.floatingWidth=0,ProtoPlayspace.prototype.html="",ProtoPlayspace.prototype.logoUrl="",ProtoPlayspace.prototype.lineItems=$util.emptyArray,ProtoPlayspace.prototype.adPlaybackMode=0,ProtoPlayspace.prototype.css="",ProtoPlayspace.prototype.sessionId="",ProtoPlayspace.prototype.orientation=0,ProtoPlayspace.prototype.orientationBreakpoint=0,ProtoPlayspace.prototype.activeVersion="",ProtoPlayspace.prototype.storyId="",ProtoPlayspace.prototype.floatingAppendLocation=0,ProtoPlayspace.prototype.floatingYAxisPadding=0,ProtoPlayspace.prototype.contentTitleTextColor="",ProtoPlayspace.prototype.useAccentColorForProgressBar=!1,ProtoPlayspace.prototype.primaryColorList=null,ProtoPlayspace.prototype.secondaryColorList=null,ProtoPlayspace.prototype.accentColorList=null,ProtoPlayspace.prototype.customJsCode="",ProtoPlayspace.prototype.initializationSettingsJson="",ProtoPlayspace.prototype.publisherName="",ProtoPlayspace.prototype.adSkippability=0,ProtoPlayspace.prototype.skipAdAfter=5,ProtoPlayspace.prototype.adBreaks=$util.emptyArray,ProtoPlayspace.prototype.amazonTamSlotId="",ProtoPlayspace.prototype.limitClientSideApiUse=!1,ProtoPlayspace.prototype.abTestId="",ProtoPlayspace.prototype.adsMustBeSkippableIfLongerThan=31,ProtoPlayspace.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspace;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.playerId=reader.string();break;case 2:message.playbackMode=reader.int32();break;case 3:message.soundMode=reader.int32();break;case 4:message.endOfCycleMode=reader.int32();break;case 5:message.containerSelector=reader.string();break;case 6:message.position=reader.int32();break;case 7:message.insertPosition=reader.int32();break;case 8:message.forceInsertPath=reader.bool();break;case 9:message.renderInFrame=reader.bool();break;case 10:message.scrollHijackingProtection=reader.bool();break;case 11:message.preRollBreak=reader.int32();break;case 12:message.postRollBreak=reader.int32();break;case 13:message.midRollNumber=reader.int32();break;case 14:message.slidesBetweenAds=reader.int32();break;case 15:message.minSlidesBeforeFirstAd=reader.int32();break;case 16:message.adViewabilityPolicy=reader.int32();break;case 18:message.casting=reader.bool();break;case 19:if(message.sharingDestinations&&message.sharingDestinations.length||(message.sharingDestinations=[]),2==(7&tag))for(var end2=reader.uint32()+reader.pos;reader.pos<end2;)message.sharingDestinations.push(reader.int32());else message.sharingDestinations.push(reader.int32());break;case 20:message.expandButton=reader.bool();break;case 21:message.closeButtonMode=reader.int32();break;case 22:message.floatingMode=reader.int32();break;case 23:if(message.floatingDeviceMode&&message.floatingDeviceMode.length||(message.floatingDeviceMode=[]),2==(7&tag))for(end2=reader.uint32()+reader.pos;reader.pos<end2;)message.floatingDeviceMode.push(reader.int32());else message.floatingDeviceMode.push(reader.int32());break;case 24:message.floatingCloseButtonMode=reader.int32();break;case 25:message.floatingFixedPosition=reader.int32();break;case 26:message.floatingPageElement=reader.string();break;case 27:message.floatingUseElementWidth=reader.bool();break;case 28:message.floatingScrollPosition=reader.int32();break;case 29:message.floatingGutterX=reader.int32();break;case 30:message.floatingGutterY=reader.int32();break;case 31:message.floatingWidth=reader.int32();break;case 35:message.html=reader.string();break;case 36:message.logoUrl=reader.string();break;case 37:message.lineItems&&message.lineItems.length||(message.lineItems=[]),message.lineItems.push($root.ProtoLineItem.decode(reader,reader.uint32()));break;case 38:message.adPlaybackMode=reader.int32();break;case 39:message.css=reader.string();break;case 40:message.sessionId=reader.string();break;case 41:message.orientation=reader.int32();break;case 42:message.orientationBreakpoint=reader.int32();break;case 43:message.activeVersion=reader.string();break;case 44:message.storyId=reader.string();break;case 50:message.floatingAppendLocation=reader.int32();break;case 51:message.floatingYAxisPadding=reader.int32();break;case 57:message.contentTitleTextColor=reader.string();break;case 58:message.useAccentColorForProgressBar=reader.bool();break;case 59:message.primaryColorList=$root.ProtoPlayspaceColorPrimary.decode(reader,reader.uint32());break;case 60:message.secondaryColorList=$root.ProtoPlayspaceColorSecondary.decode(reader,reader.uint32());break;case 61:message.accentColorList=$root.ProtoPlayspaceColorAccent.decode(reader,reader.uint32());break;case 62:message.customJsCode=reader.string();break;case 63:message.initializationSettingsJson=reader.string();break;case 64:message.publisherName=reader.string();break;case 65:message.adSkippability=reader.int32();break;case 66:message.skipAdAfter=reader.int32();break;case 67:message.adBreaks&&message.adBreaks.length||(message.adBreaks=[]),message.adBreaks.push($root.ProtoAdBreak.decode(reader,reader.uint32()));break;case 68:message.amazonTamSlotId=reader.string();break;case 69:message.limitClientSideApiUse=reader.bool();break;case 70:message.abTestId=reader.string();break;case 71:message.adsMustBeSkippableIfLongerThan=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoPlayspace.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.sharingDestinations=[],object.floatingDeviceMode=[],object.lineItems=[],object.adBreaks=[]),options.defaults&&(object.playerId="",object.playbackMode=options.enums===String?"Autoplay":0,object.soundMode=options.enums===String?"Mute":0,object.endOfCycleMode=options.enums===String?"Loop":0,object.containerSelector="",object.position=0,object.insertPosition=options.enums===String?"WithinContainer":0,object.forceInsertPath=!1,object.renderInFrame=!1,object.scrollHijackingProtection=!1,object.preRollBreak=0,object.postRollBreak=0,object.midRollNumber=-1,object.slidesBetweenAds=0,object.minSlidesBeforeFirstAd=0,object.adViewabilityPolicy=options.enums===String?"Default":0,object.casting=!1,object.expandButton=!1,object.closeButtonMode=options.enums===String?"Off":0,object.floatingMode=options.enums===String?"Off":0,object.floatingCloseButtonMode=options.enums===String?"Off":0,object.floatingFixedPosition=options.enums===String?"Page":0,object.floatingPageElement="",object.floatingUseElementWidth=!1,object.floatingScrollPosition=options.enums===String?"BottomRight":0,object.floatingGutterX=0,object.floatingGutterY=0,object.floatingWidth=0,object.html="",object.logoUrl="",object.adPlaybackMode=options.enums===String?"Autoplay":0,object.css="",object.sessionId="",object.orientation=options.enums===String?"Mixed":0,object.orientationBreakpoint=0,object.activeVersion="",object.storyId="",object.floatingAppendLocation=options.enums===String?"Above":0,object.floatingYAxisPadding=0,object.contentTitleTextColor="",object.useAccentColorForProgressBar=!1,object.primaryColorList=null,object.secondaryColorList=null,object.accentColorList=null,object.customJsCode="",object.initializationSettingsJson="",object.publisherName="",object.adSkippability=options.enums===String?"IfLongerThan":0,object.skipAdAfter=5,object.amazonTamSlotId="",object.limitClientSideApiUse=!1,object.abTestId="",object.adsMustBeSkippableIfLongerThan=31),null!=message.playerId&&message.hasOwnProperty("playerId")&&(object.playerId=message.playerId),null!=message.playbackMode&&message.hasOwnProperty("playbackMode")&&(object.playbackMode=options.enums===String?$root.ProtoPlayerPlaybackModeEnum[message.playbackMode]:message.playbackMode),null!=message.soundMode&&message.hasOwnProperty("soundMode")&&(object.soundMode=options.enums===String?$root.ProtoPlayerSoundMode[message.soundMode]:message.soundMode),null!=message.endOfCycleMode&&message.hasOwnProperty("endOfCycleMode")&&(object.endOfCycleMode=options.enums===String?$root.ProtoEndOfSlideCycleMode[message.endOfCycleMode]:message.endOfCycleMode),null!=message.containerSelector&&message.hasOwnProperty("containerSelector")&&(object.containerSelector=message.containerSelector),null!=message.position&&message.hasOwnProperty("position")&&(object.position=message.position),null!=message.insertPosition&&message.hasOwnProperty("insertPosition")&&(object.insertPosition=options.enums===String?$root.ProtoPlayerInsertMode[message.insertPosition]:message.insertPosition),null!=message.forceInsertPath&&message.hasOwnProperty("forceInsertPath")&&(object.forceInsertPath=message.forceInsertPath),null!=message.renderInFrame&&message.hasOwnProperty("renderInFrame")&&(object.renderInFrame=message.renderInFrame),null!=message.scrollHijackingProtection&&message.hasOwnProperty("scrollHijackingProtection")&&(object.scrollHijackingProtection=message.scrollHijackingProtection),null!=message.preRollBreak&&message.hasOwnProperty("preRollBreak")&&(object.preRollBreak=message.preRollBreak),null!=message.postRollBreak&&message.hasOwnProperty("postRollBreak")&&(object.postRollBreak=message.postRollBreak),null!=message.midRollNumber&&message.hasOwnProperty("midRollNumber")&&(object.midRollNumber=message.midRollNumber),null!=message.slidesBetweenAds&&message.hasOwnProperty("slidesBetweenAds")&&(object.slidesBetweenAds=message.slidesBetweenAds),null!=message.minSlidesBeforeFirstAd&&message.hasOwnProperty("minSlidesBeforeFirstAd")&&(object.minSlidesBeforeFirstAd=message.minSlidesBeforeFirstAd),null!=message.adViewabilityPolicy&&message.hasOwnProperty("adViewabilityPolicy")&&(object.adViewabilityPolicy=options.enums===String?$root.ProtoAdViewabilityPolicy[message.adViewabilityPolicy]:message.adViewabilityPolicy),null!=message.casting&&message.hasOwnProperty("casting")&&(object.casting=message.casting),message.sharingDestinations&&message.sharingDestinations.length){object.sharingDestinations=[];for(var j=0;j<message.sharingDestinations.length;++j)object.sharingDestinations[j]=options.enums===String?$root.ProtoSharingDestination[message.sharingDestinations[j]]:message.sharingDestinations[j]}if(null!=message.expandButton&&message.hasOwnProperty("expandButton")&&(object.expandButton=message.expandButton),null!=message.closeButtonMode&&message.hasOwnProperty("closeButtonMode")&&(object.closeButtonMode=options.enums===String?$root.ProtoPlayerCloseButtonMode[message.closeButtonMode]:message.closeButtonMode),null!=message.floatingMode&&message.hasOwnProperty("floatingMode")&&(object.floatingMode=options.enums===String?$root.ProtoPlayerFloatingMode[message.floatingMode]:message.floatingMode),message.floatingDeviceMode&&message.floatingDeviceMode.length){object.floatingDeviceMode=[];for(j=0;j<message.floatingDeviceMode.length;++j)object.floatingDeviceMode[j]=options.enums===String?$root.ProtoDeviceType[message.floatingDeviceMode[j]]:message.floatingDeviceMode[j]}if(null!=message.floatingCloseButtonMode&&message.hasOwnProperty("floatingCloseButtonMode")&&(object.floatingCloseButtonMode=options.enums===String?$root.ProtoPlayerCloseButtonMode[message.floatingCloseButtonMode]:message.floatingCloseButtonMode),null!=message.floatingFixedPosition&&message.hasOwnProperty("floatingFixedPosition")&&(object.floatingFixedPosition=options.enums===String?$root.ProtoFloatingFixedPositionMode[message.floatingFixedPosition]:message.floatingFixedPosition),null!=message.floatingPageElement&&message.hasOwnProperty("floatingPageElement")&&(object.floatingPageElement=message.floatingPageElement),null!=message.floatingUseElementWidth&&message.hasOwnProperty("floatingUseElementWidth")&&(object.floatingUseElementWidth=message.floatingUseElementWidth),null!=message.floatingScrollPosition&&message.hasOwnProperty("floatingScrollPosition")&&(object.floatingScrollPosition=options.enums===String?$root.ProtoPositionMode[message.floatingScrollPosition]:message.floatingScrollPosition),null!=message.floatingGutterX&&message.hasOwnProperty("floatingGutterX")&&(object.floatingGutterX=message.floatingGutterX),null!=message.floatingGutterY&&message.hasOwnProperty("floatingGutterY")&&(object.floatingGutterY=message.floatingGutterY),null!=message.floatingWidth&&message.hasOwnProperty("floatingWidth")&&(object.floatingWidth=message.floatingWidth),null!=message.html&&message.hasOwnProperty("html")&&(object.html=message.html),null!=message.logoUrl&&message.hasOwnProperty("logoUrl")&&(object.logoUrl=message.logoUrl),message.lineItems&&message.lineItems.length){object.lineItems=[];for(j=0;j<message.lineItems.length;++j)object.lineItems[j]=$root.ProtoLineItem.toObject(message.lineItems[j],options)}if(null!=message.adPlaybackMode&&message.hasOwnProperty("adPlaybackMode")&&(object.adPlaybackMode=options.enums===String?$root.ProtoAdPlaybackMode[message.adPlaybackMode]:message.adPlaybackMode),null!=message.css&&message.hasOwnProperty("css")&&(object.css=message.css),null!=message.sessionId&&message.hasOwnProperty("sessionId")&&(object.sessionId=message.sessionId),null!=message.orientation&&message.hasOwnProperty("orientation")&&(object.orientation=options.enums===String?$root.ProtoPlayerOrientationEnum[message.orientation]:message.orientation),null!=message.orientationBreakpoint&&message.hasOwnProperty("orientationBreakpoint")&&(object.orientationBreakpoint=message.orientationBreakpoint),null!=message.activeVersion&&message.hasOwnProperty("activeVersion")&&(object.activeVersion=message.activeVersion),null!=message.storyId&&message.hasOwnProperty("storyId")&&(object.storyId=message.storyId),null!=message.floatingAppendLocation&&message.hasOwnProperty("floatingAppendLocation")&&(object.floatingAppendLocation=options.enums===String?$root.ProtoFloatingAppendLocationEnum[message.floatingAppendLocation]:message.floatingAppendLocation),null!=message.floatingYAxisPadding&&message.hasOwnProperty("floatingYAxisPadding")&&(object.floatingYAxisPadding=message.floatingYAxisPadding),null!=message.contentTitleTextColor&&message.hasOwnProperty("contentTitleTextColor")&&(object.contentTitleTextColor=message.contentTitleTextColor),null!=message.useAccentColorForProgressBar&&message.hasOwnProperty("useAccentColorForProgressBar")&&(object.useAccentColorForProgressBar=message.useAccentColorForProgressBar),null!=message.primaryColorList&&message.hasOwnProperty("primaryColorList")&&(object.primaryColorList=$root.ProtoPlayspaceColorPrimary.toObject(message.primaryColorList,options)),null!=message.secondaryColorList&&message.hasOwnProperty("secondaryColorList")&&(object.secondaryColorList=$root.ProtoPlayspaceColorSecondary.toObject(message.secondaryColorList,options)),null!=message.accentColorList&&message.hasOwnProperty("accentColorList")&&(object.accentColorList=$root.ProtoPlayspaceColorAccent.toObject(message.accentColorList,options)),null!=message.customJsCode&&message.hasOwnProperty("customJsCode")&&(object.customJsCode=message.customJsCode),null!=message.initializationSettingsJson&&message.hasOwnProperty("initializationSettingsJson")&&(object.initializationSettingsJson=message.initializationSettingsJson),null!=message.publisherName&&message.hasOwnProperty("publisherName")&&(object.publisherName=message.publisherName),null!=message.adSkippability&&message.hasOwnProperty("adSkippability")&&(object.adSkippability=options.enums===String?$root.ProtoPlayerAdSkippability[message.adSkippability]:message.adSkippability),null!=message.skipAdAfter&&message.hasOwnProperty("skipAdAfter")&&(object.skipAdAfter=message.skipAdAfter),message.adBreaks&&message.adBreaks.length){object.adBreaks=[];for(j=0;j<message.adBreaks.length;++j)object.adBreaks[j]=$root.ProtoAdBreak.toObject(message.adBreaks[j],options)}return null!=message.amazonTamSlotId&&message.hasOwnProperty("amazonTamSlotId")&&(object.amazonTamSlotId=message.amazonTamSlotId),null!=message.limitClientSideApiUse&&message.hasOwnProperty("limitClientSideApiUse")&&(object.limitClientSideApiUse=message.limitClientSideApiUse),null!=message.abTestId&&message.hasOwnProperty("abTestId")&&(object.abTestId=message.abTestId),null!=message.adsMustBeSkippableIfLongerThan&&message.hasOwnProperty("adsMustBeSkippableIfLongerThan")&&(object.adsMustBeSkippableIfLongerThan=message.adsMustBeSkippableIfLongerThan),object},ProtoPlayspace}(),$root.ProtoPlayspaceResponse=function(){function ProtoPlayspaceResponse(properties){if(this.players=[],this.lineItems=[],this.cookieSyncUrls={},properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayspaceResponse.prototype.errorMessage="",ProtoPlayspaceResponse.prototype.players=$util.emptyArray,ProtoPlayspaceResponse.prototype.browser=null,ProtoPlayspaceResponse.prototype.geoLocation=null,ProtoPlayspaceResponse.prototype.lineItems=$util.emptyArray,ProtoPlayspaceResponse.prototype.cookieSyncUrls=$util.emptyObject,ProtoPlayspaceResponse.prototype.explorationMode=!1,ProtoPlayspaceResponse.prototype.supplyChain=null,ProtoPlayspaceResponse.prototype.secondLevelDomain="",ProtoPlayspaceResponse.prototype.userInformation=null,ProtoPlayspaceResponse.prototype.serverAb0=0,ProtoPlayspaceResponse.prototype.serverAb1=0,ProtoPlayspaceResponse.prototype.isSeoTraffic=!1,ProtoPlayspaceResponse.prototype.bandwidthLoggingEnabled=!1,ProtoPlayspaceResponse.prototype.publisherNetworkCode=0,ProtoPlayspaceResponse.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var key,value,end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayspaceResponse;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.errorMessage=reader.string();break;case 10:message.players&&message.players.length||(message.players=[]),message.players.push($root.ProtoPlayspace.decode(reader,reader.uint32()));break;case 11:message.browser=$root.Browser.decode(reader,reader.uint32());break;case 12:message.geoLocation=$root.GeoLocation.decode(reader,reader.uint32());break;case 13:message.lineItems&&message.lineItems.length||(message.lineItems=[]),message.lineItems.push($root.ProtoLineItem.decode(reader,reader.uint32()));break;case 14:message.cookieSyncUrls===$util.emptyObject&&(message.cookieSyncUrls={});var end2=reader.uint32()+reader.pos;for(key=0,value="";reader.pos<end2;){var tag2=reader.uint32();switch(tag2>>>3){case 1:key=reader.int32();break;case 2:value=reader.string();break;default:reader.skipType(7&tag2)}}message.cookieSyncUrls[key]=value;break;case 15:message.explorationMode=reader.bool();break;case 17:message.supplyChain=$root.ProtoSupplyChain.decode(reader,reader.uint32());break;case 18:message.secondLevelDomain=reader.string();break;case 20:message.userInformation=$root.ProtoUserInformation.decode(reader,reader.uint32());break;case 21:message.serverAb0=reader.int32();break;case 22:message.serverAb1=reader.int32();break;case 23:message.isSeoTraffic=reader.bool();break;case 24:message.bandwidthLoggingEnabled=reader.bool();break;case 25:message.publisherNetworkCode=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoPlayspaceResponse.toObject=function(message,options){options||(options={});var keys2,object={};if((options.arrays||options.defaults)&&(object.players=[],object.lineItems=[]),(options.objects||options.defaults)&&(object.cookieSyncUrls={}),options.defaults&&(object.errorMessage="",object.browser=null,object.geoLocation=null,object.explorationMode=!1,object.supplyChain=null,object.secondLevelDomain="",object.userInformation=null,object.serverAb0=0,object.serverAb1=0,object.isSeoTraffic=!1,object.bandwidthLoggingEnabled=!1,object.publisherNetworkCode=0),null!=message.errorMessage&&message.hasOwnProperty("errorMessage")&&(object.errorMessage=message.errorMessage),message.players&&message.players.length){object.players=[];for(var j=0;j<message.players.length;++j)object.players[j]=$root.ProtoPlayspace.toObject(message.players[j],options)}if(null!=message.browser&&message.hasOwnProperty("browser")&&(object.browser=$root.Browser.toObject(message.browser,options)),null!=message.geoLocation&&message.hasOwnProperty("geoLocation")&&(object.geoLocation=$root.GeoLocation.toObject(message.geoLocation,options)),message.lineItems&&message.lineItems.length){object.lineItems=[];for(j=0;j<message.lineItems.length;++j)object.lineItems[j]=$root.ProtoLineItem.toObject(message.lineItems[j],options)}if(message.cookieSyncUrls&&(keys2=Object.keys(message.cookieSyncUrls)).length){object.cookieSyncUrls={};for(j=0;j<keys2.length;++j)object.cookieSyncUrls[keys2[j]]=message.cookieSyncUrls[keys2[j]]}return null!=message.explorationMode&&message.hasOwnProperty("explorationMode")&&(object.explorationMode=message.explorationMode),null!=message.supplyChain&&message.hasOwnProperty("supplyChain")&&(object.supplyChain=$root.ProtoSupplyChain.toObject(message.supplyChain,options)),null!=message.secondLevelDomain&&message.hasOwnProperty("secondLevelDomain")&&(object.secondLevelDomain=message.secondLevelDomain),null!=message.userInformation&&message.hasOwnProperty("userInformation")&&(object.userInformation=$root.ProtoUserInformation.toObject(message.userInformation,options)),null!=message.serverAb0&&message.hasOwnProperty("serverAb0")&&(object.serverAb0=message.serverAb0),null!=message.serverAb1&&message.hasOwnProperty("serverAb1")&&(object.serverAb1=message.serverAb1),null!=message.isSeoTraffic&&message.hasOwnProperty("isSeoTraffic")&&(object.isSeoTraffic=message.isSeoTraffic),null!=message.bandwidthLoggingEnabled&&message.hasOwnProperty("bandwidthLoggingEnabled")&&(object.bandwidthLoggingEnabled=message.bandwidthLoggingEnabled),null!=message.publisherNetworkCode&&message.hasOwnProperty("publisherNetworkCode")&&(object.publisherNetworkCode=message.publisherNetworkCode),object},ProtoPlayspaceResponse}(),$root.Browser=function(){function Browser(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return Browser.prototype.browserVersion="",Browser.prototype.browserType="",Browser.prototype.osCode="",Browser.prototype.device=0,Browser.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.browserVersion&&Object.hasOwnProperty.call(message,"browserVersion")&&writer.uint32(10).string(message.browserVersion),null!=message.browserType&&Object.hasOwnProperty.call(message,"browserType")&&writer.uint32(18).string(message.browserType),null!=message.osCode&&Object.hasOwnProperty.call(message,"osCode")&&writer.uint32(26).string(message.osCode),null!=message.device&&Object.hasOwnProperty.call(message,"device")&&writer.uint32(32).int32(message.device),writer},Browser.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.Browser;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.browserVersion=reader.string();break;case 2:message.browserType=reader.string();break;case 3:message.osCode=reader.string();break;case 4:message.device=reader.int32();break;default:reader.skipType(7&tag)}}return message},Browser.fromObject=function(object){if(object instanceof $root.Browser)return object;var message=new $root.Browser;switch(null!=object.browserVersion&&(message.browserVersion=String(object.browserVersion)),null!=object.browserType&&(message.browserType=String(object.browserType)),null!=object.osCode&&(message.osCode=String(object.osCode)),object.device){case"Desktop":case 0:message.device=0;break;case"Smartphone":case 1:message.device=1;break;case"Tablet":case 2:message.device=2;break;case"GameConsole":case 3:message.device=3;break;case"SmartTV":case 4:message.device=4;break;case"WearableComputer":case 5:message.device=5;break;case"PDA":case 6:message.device=6;break;case"Unrecognized":case 7:message.device=7}return message},Browser.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.browserVersion="",object.browserType="",object.osCode="",object.device=options.enums===String?"Desktop":0),null!=message.browserVersion&&message.hasOwnProperty("browserVersion")&&(object.browserVersion=message.browserVersion),null!=message.browserType&&message.hasOwnProperty("browserType")&&(object.browserType=message.browserType),null!=message.osCode&&message.hasOwnProperty("osCode")&&(object.osCode=message.osCode),null!=message.device&&message.hasOwnProperty("device")&&(object.device=options.enums===String?$root.ProtoDeviceType[message.device]:message.device),object},Browser.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},Browser}(),$root.GeoLocation=function(){function GeoLocation(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return GeoLocation.prototype.countryGeoId=0,GeoLocation.prototype.cityId=0,GeoLocation.prototype.subdivisionId=0,GeoLocation.prototype.dmaId=0,GeoLocation.prototype.ip="",GeoLocation.prototype.lat=0,GeoLocation.prototype.lon=0,GeoLocation.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.countryGeoId&&Object.hasOwnProperty.call(message,"countryGeoId")&&writer.uint32(8).int32(message.countryGeoId),null!=message.cityId&&Object.hasOwnProperty.call(message,"cityId")&&writer.uint32(16).int32(message.cityId),null!=message.subdivisionId&&Object.hasOwnProperty.call(message,"subdivisionId")&&writer.uint32(24).int32(message.subdivisionId),null!=message.dmaId&&Object.hasOwnProperty.call(message,"dmaId")&&writer.uint32(32).int32(message.dmaId),null!=message.ip&&Object.hasOwnProperty.call(message,"ip")&&writer.uint32(42).string(message.ip),null!=message.lat&&Object.hasOwnProperty.call(message,"lat")&&writer.uint32(49).double(message.lat),null!=message.lon&&Object.hasOwnProperty.call(message,"lon")&&writer.uint32(57).double(message.lon),writer},GeoLocation.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.GeoLocation;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.countryGeoId=reader.int32();break;case 2:message.cityId=reader.int32();break;case 3:message.subdivisionId=reader.int32();break;case 4:message.dmaId=reader.int32();break;case 5:message.ip=reader.string();break;case 6:message.lat=reader.double();break;case 7:message.lon=reader.double();break;default:reader.skipType(7&tag)}}return message},GeoLocation.fromObject=function(object){if(object instanceof $root.GeoLocation)return object;var message=new $root.GeoLocation;return null!=object.countryGeoId&&(message.countryGeoId=0|object.countryGeoId),null!=object.cityId&&(message.cityId=0|object.cityId),null!=object.subdivisionId&&(message.subdivisionId=0|object.subdivisionId),null!=object.dmaId&&(message.dmaId=0|object.dmaId),null!=object.ip&&(message.ip=String(object.ip)),null!=object.lat&&(message.lat=Number(object.lat)),null!=object.lon&&(message.lon=Number(object.lon)),message},GeoLocation.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.countryGeoId=0,object.cityId=0,object.subdivisionId=0,object.dmaId=0,object.ip="",object.lat=0,object.lon=0),null!=message.countryGeoId&&message.hasOwnProperty("countryGeoId")&&(object.countryGeoId=message.countryGeoId),null!=message.cityId&&message.hasOwnProperty("cityId")&&(object.cityId=message.cityId),null!=message.subdivisionId&&message.hasOwnProperty("subdivisionId")&&(object.subdivisionId=message.subdivisionId),null!=message.dmaId&&message.hasOwnProperty("dmaId")&&(object.dmaId=message.dmaId),null!=message.ip&&message.hasOwnProperty("ip")&&(object.ip=message.ip),null!=message.lat&&message.hasOwnProperty("lat")&&(object.lat=options.json&&!isFinite(message.lat)?String(message.lat):message.lat),null!=message.lon&&message.hasOwnProperty("lon")&&(object.lon=options.json&&!isFinite(message.lon)?String(message.lon):message.lon),object},GeoLocation.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},GeoLocation}(),$root.CreativeTrackerViewModel=function(){function CreativeTrackerViewModel(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return CreativeTrackerViewModel.prototype.type=0,CreativeTrackerViewModel.prototype.trigger=0,CreativeTrackerViewModel.prototype.url="",CreativeTrackerViewModel.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.CreativeTrackerViewModel;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.type=reader.int32();break;case 2:message.trigger=reader.int32();break;case 3:message.url=reader.string();break;default:reader.skipType(7&tag)}}return message},CreativeTrackerViewModel.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.type=options.enums===String?"Image":0,object.trigger=options.enums===String?"Impression":0,object.url=""),null!=message.type&&message.hasOwnProperty("type")&&(object.type=options.enums===String?$root.ProtoTrackerType[message.type]:message.type),null!=message.trigger&&message.hasOwnProperty("trigger")&&(object.trigger=options.enums===String?$root.ProtoTrackerTriggerType[message.trigger]:message.trigger),null!=message.url&&message.hasOwnProperty("url")&&(object.url=message.url),object},CreativeTrackerViewModel}(),$root.ProtoLineItemAdBreakTargeting=function(){function ProtoLineItemAdBreakTargeting(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLineItemAdBreakTargeting.prototype.adRollType=0,ProtoLineItemAdBreakTargeting.prototype.adBreakTypeEnum=1,ProtoLineItemAdBreakTargeting.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoLineItemAdBreakTargeting;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.adRollType=reader.int32();break;case 2:message.adBreakTypeEnum=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoLineItemAdBreakTargeting.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.adRollType=options.enums===String?"None":0,object.adBreakTypeEnum=options.enums===String?"All":1),null!=message.adRollType&&message.hasOwnProperty("adRollType")&&(object.adRollType=options.enums===String?$root.ProtoAdBreakTypeEnum[message.adRollType]:message.adRollType),null!=message.adBreakTypeEnum&&message.hasOwnProperty("adBreakTypeEnum")&&(object.adBreakTypeEnum=options.enums===String?$root.ProtoLineItemAdBreakTypeEnum[message.adBreakTypeEnum]:message.adBreakTypeEnum),object},ProtoLineItemAdBreakTargeting}(),$root.ProtoLineItemAdPodTargeting=function(){function ProtoLineItemAdPodTargeting(properties){if(this.adSlotPositions=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLineItemAdPodTargeting.prototype.targetingType=0,ProtoLineItemAdPodTargeting.prototype.adSlotTargetingType=1,ProtoLineItemAdPodTargeting.prototype.adSlotPositions=$util.emptyArray,ProtoLineItemAdPodTargeting.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoLineItemAdPodTargeting;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.targetingType=reader.int32();break;case 2:message.adSlotTargetingType=reader.int32();break;case 3:if(message.adSlotPositions&&message.adSlotPositions.length||(message.adSlotPositions=[]),2==(7&tag))for(var end2=reader.uint32()+reader.pos;reader.pos<end2;)message.adSlotPositions.push(reader.int32());else message.adSlotPositions.push(reader.int32());break;default:reader.skipType(7&tag)}}return message},ProtoLineItemAdPodTargeting.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.adSlotPositions=[]),options.defaults&&(object.targetingType=options.enums===String?"Only":0,object.adSlotTargetingType=options.enums===String?"SpecificSlots":1),null!=message.targetingType&&message.hasOwnProperty("targetingType")&&(object.targetingType=options.enums===String?$root.ProtoLineItemTargetingTypeEnum[message.targetingType]:message.targetingType),null!=message.adSlotTargetingType&&message.hasOwnProperty("adSlotTargetingType")&&(object.adSlotTargetingType=options.enums===String?$root.ProtoLineItemAdSlotTargetingTypeEnum[message.adSlotTargetingType]:message.adSlotTargetingType),message.adSlotPositions&&message.adSlotPositions.length){object.adSlotPositions=[];for(var j=0;j<message.adSlotPositions.length;++j)object.adSlotPositions[j]=message.adSlotPositions[j]}return object},ProtoLineItemAdPodTargeting}(),$root.ProtoLineItemAdBreakSettings=function(){function ProtoLineItemAdBreakSettings(properties){if(this.adBreakTargeting=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLineItemAdBreakSettings.prototype.adBreakTargeting=$util.emptyArray,ProtoLineItemAdBreakSettings.prototype.adPodTargeting=null,ProtoLineItemAdBreakSettings.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoLineItemAdBreakSettings;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.adBreakTargeting&&message.adBreakTargeting.length||(message.adBreakTargeting=[]),message.adBreakTargeting.push($root.ProtoLineItemAdBreakTargeting.decode(reader,reader.uint32()));break;case 2:message.adPodTargeting=$root.ProtoLineItemAdPodTargeting.decode(reader,reader.uint32());break;default:reader.skipType(7&tag)}}return message},ProtoLineItemAdBreakSettings.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.adBreakTargeting=[]),options.defaults&&(object.adPodTargeting=null),message.adBreakTargeting&&message.adBreakTargeting.length){object.adBreakTargeting=[];for(var j=0;j<message.adBreakTargeting.length;++j)object.adBreakTargeting[j]=$root.ProtoLineItemAdBreakTargeting.toObject(message.adBreakTargeting[j],options)}return null!=message.adPodTargeting&&message.hasOwnProperty("adPodTargeting")&&(object.adPodTargeting=$root.ProtoLineItemAdPodTargeting.toObject(message.adPodTargeting,options)),object},ProtoLineItemAdBreakSettings}(),$root.ProtoLineItem=function(){function ProtoLineItem(properties){if(this.trackers=[],this.renditions=[],this.floorPrices=[],this.advertiserContextualTargeting=[],this.publisherContextualTargeting=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLineItem.prototype.publisherLineItemId="",ProtoLineItem.prototype.advertiserLineItemId="",ProtoLineItem.prototype.adTag="",ProtoLineItem.prototype.creativeType=0,ProtoLineItem.prototype.sound=!1,ProtoLineItem.prototype.viewability=!1,ProtoLineItem.prototype.impressionTimeSpent=0,ProtoLineItem.prototype.vendorId="",ProtoLineItem.prototype.trackers=$util.emptyArray,ProtoLineItem.prototype.duration=0,ProtoLineItem.prototype.renditions=$util.emptyArray,ProtoLineItem.prototype.mediaCreativeId="",ProtoLineItem.prototype.ignoreFilledRequests=!1,ProtoLineItem.prototype.requestCap=3,ProtoLineItem.prototype.impressionCap=0,ProtoLineItem.prototype.successRate=0,ProtoLineItem.prototype.lineItemPriority=0,ProtoLineItem.prototype.headerBidderBids="",ProtoLineItem.prototype.headerBidderTimeout=0,ProtoLineItem.prototype.mediaCreativeClickUrl="",ProtoLineItem.prototype.resetRequestsCapTime=60,ProtoLineItem.prototype.resetImpressionsCapTime=60,ProtoLineItem.prototype.resetCapType=0,ProtoLineItem.prototype.creativeHlsFileName="",ProtoLineItem.prototype.timeBetweenRequests=0,ProtoLineItem.prototype.skipMode=0,ProtoLineItem.prototype.mediaIdTargeting=null,ProtoLineItem.prototype.mediaKeywordsTargeting=null,ProtoLineItem.prototype.mediaLanguageTargeting=null,ProtoLineItem.prototype.adType=0,ProtoLineItem.prototype.overlayTime=30,ProtoLineItem.prototype.floorPrice=0,ProtoLineItem.prototype.adBreakSettings=null,ProtoLineItem.prototype.floorPrices=$util.emptyArray,ProtoLineItem.prototype.bidRate=0,ProtoLineItem.prototype.pauseAdOutOfView=0,ProtoLineItem.prototype.moatTrackingEnabled=!1,ProtoLineItem.prototype.cnxCreativeId="",ProtoLineItem.prototype.blockedDomainsRevisionNumber=0,ProtoLineItem.prototype.advertiserContextualTargeting=$util.emptyArray,ProtoLineItem.prototype.publisherContextualTargeting=$util.emptyArray,ProtoLineItem.prototype.amazonDealId="",ProtoLineItem.prototype.playerSizeTargetings=null,ProtoLineItem.prototype.playerSize="",ProtoLineItem.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoLineItem;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.publisherLineItemId=reader.string();break;case 2:message.advertiserLineItemId=reader.string();break;case 3:message.adTag=reader.string();break;case 4:message.creativeType=reader.int32();break;case 6:message.sound=reader.bool();break;case 7:message.viewability=reader.bool();break;case 9:message.impressionTimeSpent=reader.int32();break;case 10:message.vendorId=reader.string();break;case 12:message.trackers&&message.trackers.length||(message.trackers=[]),message.trackers.push($root.CreativeTrackerViewModel.decode(reader,reader.uint32()));break;case 13:message.duration=reader.int32();break;case 14:message.renditions&&message.renditions.length||(message.renditions=[]),message.renditions.push($root.ProtoRendition.decode(reader,reader.uint32()));break;case 15:message.mediaCreativeId=reader.string();break;case 16:message.ignoreFilledRequests=reader.bool();break;case 17:message.requestCap=reader.int32();break;case 18:message.impressionCap=reader.int32();break;case 19:message.successRate=reader.double();break;case 20:message.lineItemPriority=reader.int32();break;case 21:message.headerBidderBids=reader.string();break;case 22:message.headerBidderTimeout=reader.int32();break;case 23:message.mediaCreativeClickUrl=reader.string();break;case 24:message.resetRequestsCapTime=reader.int32();break;case 25:message.resetImpressionsCapTime=reader.int32();break;case 26:message.resetCapType=reader.int32();break;case 27:message.creativeHlsFileName=reader.string();break;case 28:message.timeBetweenRequests=reader.int32();break;case 29:message.skipMode=reader.int32();break;case 30:message.mediaIdTargeting=$root.ProtoTargetingChoiceModel.decode(reader,reader.uint32());break;case 31:message.mediaKeywordsTargeting=$root.ProtoTargetingChoiceModel.decode(reader,reader.uint32());break;case 32:message.mediaLanguageTargeting=$root.ProtoTargetingChoiceModel.decode(reader,reader.uint32());break;case 33:message.adType=reader.int32();break;case 34:message.overlayTime=reader.int32();break;case 35:message.floorPrice=reader.double();break;case 36:message.adBreakSettings=$root.ProtoLineItemAdBreakSettings.decode(reader,reader.uint32());break;case 38:if(message.floorPrices&&message.floorPrices.length||(message.floorPrices=[]),2==(7&tag))for(var end2=reader.uint32()+reader.pos;reader.pos<end2;)message.floorPrices.push(reader.double());else message.floorPrices.push(reader.double());break;case 39:message.bidRate=reader.double();break;case 40:message.pauseAdOutOfView=reader.int32();break;case 41:message.moatTrackingEnabled=reader.bool();break;case 42:message.cnxCreativeId=reader.string();break;case 44:message.blockedDomainsRevisionNumber=reader.int32();break;case 45:message.advertiserContextualTargeting&&message.advertiserContextualTargeting.length||(message.advertiserContextualTargeting=[]),message.advertiserContextualTargeting.push($root.ProtoContextualTargetingCaseModel.decode(reader,reader.uint32()));break;case 46:message.publisherContextualTargeting&&message.publisherContextualTargeting.length||(message.publisherContextualTargeting=[]),message.publisherContextualTargeting.push($root.ProtoContextualTargetingCaseModel.decode(reader,reader.uint32()));break;case 48:message.amazonDealId=reader.string();break;case 47:message.playerSizeTargetings=$root.ProtoPlayerSizeTargetings.decode(reader,reader.uint32());break;case 101:message.playerSize=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoLineItem.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.trackers=[],object.renditions=[],object.floorPrices=[],object.advertiserContextualTargeting=[],object.publisherContextualTargeting=[]),options.defaults&&(object.publisherLineItemId="",object.advertiserLineItemId="",object.adTag="",object.creativeType=options.enums===String?"ThirdParty":0,object.sound=!1,object.viewability=!1,object.impressionTimeSpent=0,object.vendorId="",object.duration=0,object.mediaCreativeId="",object.ignoreFilledRequests=!1,object.requestCap=3,object.impressionCap=0,object.successRate=0,object.lineItemPriority=options.enums===String?"House":0,object.headerBidderBids="",object.headerBidderTimeout=0,object.mediaCreativeClickUrl="",object.resetRequestsCapTime=60,object.resetImpressionsCapTime=60,object.resetCapType=options.enums===String?"TimeCapping":0,object.creativeHlsFileName="",object.timeBetweenRequests=0,object.skipMode=options.enums===String?"IfLongerThan31Sec":0,object.mediaIdTargeting=null,object.mediaKeywordsTargeting=null,object.mediaLanguageTargeting=null,object.adType=options.enums===String?"Video":0,object.overlayTime=30,object.floorPrice=0,object.adBreakSettings=null,object.bidRate=0,object.pauseAdOutOfView=options.enums===String?"Default":0,object.moatTrackingEnabled=!1,object.cnxCreativeId="",object.blockedDomainsRevisionNumber=0,object.playerSizeTargetings=null,object.amazonDealId="",object.playerSize=""),null!=message.publisherLineItemId&&message.hasOwnProperty("publisherLineItemId")&&(object.publisherLineItemId=message.publisherLineItemId),null!=message.advertiserLineItemId&&message.hasOwnProperty("advertiserLineItemId")&&(object.advertiserLineItemId=message.advertiserLineItemId),null!=message.adTag&&message.hasOwnProperty("adTag")&&(object.adTag=message.adTag),null!=message.creativeType&&message.hasOwnProperty("creativeType")&&(object.creativeType=options.enums===String?$root.ProtoCreativeTypeEnum[message.creativeType]:message.creativeType),null!=message.sound&&message.hasOwnProperty("sound")&&(object.sound=message.sound),null!=message.viewability&&message.hasOwnProperty("viewability")&&(object.viewability=message.viewability),null!=message.impressionTimeSpent&&message.hasOwnProperty("impressionTimeSpent")&&(object.impressionTimeSpent=message.impressionTimeSpent),null!=message.vendorId&&message.hasOwnProperty("vendorId")&&(object.vendorId=message.vendorId),message.trackers&&message.trackers.length){object.trackers=[];for(var j=0;j<message.trackers.length;++j)object.trackers[j]=$root.CreativeTrackerViewModel.toObject(message.trackers[j],options)}if(null!=message.duration&&message.hasOwnProperty("duration")&&(object.duration=message.duration),message.renditions&&message.renditions.length){object.renditions=[];for(j=0;j<message.renditions.length;++j)object.renditions[j]=$root.ProtoRendition.toObject(message.renditions[j],options)}if(null!=message.mediaCreativeId&&message.hasOwnProperty("mediaCreativeId")&&(object.mediaCreativeId=message.mediaCreativeId),null!=message.ignoreFilledRequests&&message.hasOwnProperty("ignoreFilledRequests")&&(object.ignoreFilledRequests=message.ignoreFilledRequests),null!=message.requestCap&&message.hasOwnProperty("requestCap")&&(object.requestCap=message.requestCap),null!=message.impressionCap&&message.hasOwnProperty("impressionCap")&&(object.impressionCap=message.impressionCap),null!=message.successRate&&message.hasOwnProperty("successRate")&&(object.successRate=options.json&&!isFinite(message.successRate)?String(message.successRate):message.successRate),null!=message.lineItemPriority&&message.hasOwnProperty("lineItemPriority")&&(object.lineItemPriority=options.enums===String?$root.ProtoLineItemPriority[message.lineItemPriority]:message.lineItemPriority),null!=message.headerBidderBids&&message.hasOwnProperty("headerBidderBids")&&(object.headerBidderBids=message.headerBidderBids),null!=message.headerBidderTimeout&&message.hasOwnProperty("headerBidderTimeout")&&(object.headerBidderTimeout=message.headerBidderTimeout),null!=message.mediaCreativeClickUrl&&message.hasOwnProperty("mediaCreativeClickUrl")&&(object.mediaCreativeClickUrl=message.mediaCreativeClickUrl),null!=message.resetRequestsCapTime&&message.hasOwnProperty("resetRequestsCapTime")&&(object.resetRequestsCapTime=message.resetRequestsCapTime),null!=message.resetImpressionsCapTime&&message.hasOwnProperty("resetImpressionsCapTime")&&(object.resetImpressionsCapTime=message.resetImpressionsCapTime),null!=message.resetCapType&&message.hasOwnProperty("resetCapType")&&(object.resetCapType=options.enums===String?$root.ProtoResetCapTypeEnum[message.resetCapType]:message.resetCapType),null!=message.creativeHlsFileName&&message.hasOwnProperty("creativeHlsFileName")&&(object.creativeHlsFileName=message.creativeHlsFileName),null!=message.timeBetweenRequests&&message.hasOwnProperty("timeBetweenRequests")&&(object.timeBetweenRequests=message.timeBetweenRequests),null!=message.skipMode&&message.hasOwnProperty("skipMode")&&(object.skipMode=options.enums===String?$root.ProtoAdSkipMode[message.skipMode]:message.skipMode),null!=message.mediaIdTargeting&&message.hasOwnProperty("mediaIdTargeting")&&(object.mediaIdTargeting=$root.ProtoTargetingChoiceModel.toObject(message.mediaIdTargeting,options)),null!=message.mediaKeywordsTargeting&&message.hasOwnProperty("mediaKeywordsTargeting")&&(object.mediaKeywordsTargeting=$root.ProtoTargetingChoiceModel.toObject(message.mediaKeywordsTargeting,options)),null!=message.mediaLanguageTargeting&&message.hasOwnProperty("mediaLanguageTargeting")&&(object.mediaLanguageTargeting=$root.ProtoTargetingChoiceModel.toObject(message.mediaLanguageTargeting,options)),null!=message.adType&&message.hasOwnProperty("adType")&&(object.adType=options.enums===String?$root.ProtoAdType[message.adType]:message.adType),null!=message.overlayTime&&message.hasOwnProperty("overlayTime")&&(object.overlayTime=message.overlayTime),null!=message.floorPrice&&message.hasOwnProperty("floorPrice")&&(object.floorPrice=options.json&&!isFinite(message.floorPrice)?String(message.floorPrice):message.floorPrice),null!=message.adBreakSettings&&message.hasOwnProperty("adBreakSettings")&&(object.adBreakSettings=$root.ProtoLineItemAdBreakSettings.toObject(message.adBreakSettings,options)),message.floorPrices&&message.floorPrices.length){object.floorPrices=[];for(j=0;j<message.floorPrices.length;++j)object.floorPrices[j]=options.json&&!isFinite(message.floorPrices[j])?String(message.floorPrices[j]):message.floorPrices[j]}if(null!=message.bidRate&&message.hasOwnProperty("bidRate")&&(object.bidRate=options.json&&!isFinite(message.bidRate)?String(message.bidRate):message.bidRate),null!=message.pauseAdOutOfView&&message.hasOwnProperty("pauseAdOutOfView")&&(object.pauseAdOutOfView=options.enums===String?$root.ProtoLineItemPauseAdOutOfViewEnum[message.pauseAdOutOfView]:message.pauseAdOutOfView),null!=message.moatTrackingEnabled&&message.hasOwnProperty("moatTrackingEnabled")&&(object.moatTrackingEnabled=message.moatTrackingEnabled),null!=message.cnxCreativeId&&message.hasOwnProperty("cnxCreativeId")&&(object.cnxCreativeId=message.cnxCreativeId),null!=message.blockedDomainsRevisionNumber&&message.hasOwnProperty("blockedDomainsRevisionNumber")&&(object.blockedDomainsRevisionNumber=message.blockedDomainsRevisionNumber),message.advertiserContextualTargeting&&message.advertiserContextualTargeting.length){object.advertiserContextualTargeting=[];for(j=0;j<message.advertiserContextualTargeting.length;++j)object.advertiserContextualTargeting[j]=$root.ProtoContextualTargetingCaseModel.toObject(message.advertiserContextualTargeting[j],options)}if(message.publisherContextualTargeting&&message.publisherContextualTargeting.length){object.publisherContextualTargeting=[];for(j=0;j<message.publisherContextualTargeting.length;++j)object.publisherContextualTargeting[j]=$root.ProtoContextualTargetingCaseModel.toObject(message.publisherContextualTargeting[j],options)}return null!=message.playerSizeTargetings&&message.hasOwnProperty("playerSizeTargetings")&&(object.playerSizeTargetings=$root.ProtoPlayerSizeTargetings.toObject(message.playerSizeTargetings,options)),null!=message.amazonDealId&&message.hasOwnProperty("amazonDealId")&&(object.amazonDealId=message.amazonDealId),null!=message.playerSize&&message.hasOwnProperty("playerSize")&&(object.playerSize=message.playerSize),object},ProtoLineItem}(),$root.ProtoTargetingChoiceModel=function(){function ProtoTargetingChoiceModel(properties){if(this.items=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoTargetingChoiceModel.prototype.choiceCriteria=0,ProtoTargetingChoiceModel.prototype.items=$util.emptyArray,ProtoTargetingChoiceModel.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoTargetingChoiceModel;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.choiceCriteria=reader.int32();break;case 2:message.items&&message.items.length||(message.items=[]),message.items.push(reader.string());break;default:reader.skipType(7&tag)}}return message},ProtoTargetingChoiceModel.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.items=[]),options.defaults&&(object.choiceCriteria=options.enums===String?"Only":0),null!=message.choiceCriteria&&message.hasOwnProperty("choiceCriteria")&&(object.choiceCriteria=options.enums===String?$root.ProtoChoiceCriteriaEnum[message.choiceCriteria]:message.choiceCriteria),message.items&&message.items.length){object.items=[];for(var j=0;j<message.items.length;++j)object.items[j]=message.items[j]}return object},ProtoTargetingChoiceModel}(),$root.ProtoContextualTargetingCaseModel=function(){function ProtoContextualTargetingCaseModel(properties){if(this.filters=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoContextualTargetingCaseModel.prototype.filters=$util.emptyArray,ProtoContextualTargetingCaseModel.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoContextualTargetingCaseModel;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.filters&&message.filters.length||(message.filters=[]),message.filters.push($root.ProtoContextualTargetingFilterModel.decode(reader,reader.uint32()));break;default:reader.skipType(7&tag)}}return message},ProtoContextualTargetingCaseModel.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.filters=[]),message.filters&&message.filters.length){object.filters=[];for(var j=0;j<message.filters.length;++j)object.filters[j]=$root.ProtoContextualTargetingFilterModel.toObject(message.filters[j],options)}return object},ProtoContextualTargetingCaseModel}(),$root.ProtoContextualTargetingFilterModel=function(){function ProtoContextualTargetingFilterModel(properties){if(this.items=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoContextualTargetingFilterModel.prototype.type=0,ProtoContextualTargetingFilterModel.prototype.items=$util.emptyArray,ProtoContextualTargetingFilterModel.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoContextualTargetingFilterModel;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.type=reader.int32();break;case 2:message.items&&message.items.length||(message.items=[]),message.items.push(reader.string());break;default:reader.skipType(7&tag)}}return message},ProtoContextualTargetingFilterModel.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.items=[]),options.defaults&&(object.type=options.enums===String?"IncludeAny":0),null!=message.type&&message.hasOwnProperty("type")&&(object.type=options.enums===String?$root.ProtoLineItemContextualTargetingEnum[message.type]:message.type),message.items&&message.items.length){object.items=[];for(var j=0;j<message.items.length;++j)object.items[j]=message.items[j]}return object},ProtoContextualTargetingFilterModel}(),$root.ProtoPlayerSizeTargetings=function(){function ProtoPlayerSizeTargetings(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayerSizeTargetings.prototype.sizeChoiceCriteria=0,ProtoPlayerSizeTargetings.prototype.minWidth=0,ProtoPlayerSizeTargetings.prototype.maxWidth=0,ProtoPlayerSizeTargetings.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayerSizeTargetings;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.sizeChoiceCriteria=reader.int32();break;case 2:message.minWidth=reader.int32();break;case 3:message.maxWidth=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoPlayerSizeTargetings.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.sizeChoiceCriteria=options.enums===String?"GreaterThan":0,object.minWidth=0,object.maxWidth=0),null!=message.sizeChoiceCriteria&&message.hasOwnProperty("sizeChoiceCriteria")&&(object.sizeChoiceCriteria=options.enums===String?$root.ProtoSizeChoiceCriteriaEnum[message.sizeChoiceCriteria]:message.sizeChoiceCriteria),null!=message.minWidth&&message.hasOwnProperty("minWidth")&&(object.minWidth=message.minWidth),null!=message.maxWidth&&message.hasOwnProperty("maxWidth")&&(object.maxWidth=message.maxWidth),object},ProtoPlayerSizeTargetings}(),$root.ProtoRendition=function(){function ProtoRendition(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoRendition.prototype.height=0,ProtoRendition.prototype.codec="",ProtoRendition.prototype.file="",ProtoRendition.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoRendition;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.height=reader.int32();break;case 2:message.codec=reader.string();break;case 3:message.file=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoRendition.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.height=0,object.codec="",object.file=""),null!=message.height&&message.hasOwnProperty("height")&&(object.height=message.height),null!=message.codec&&message.hasOwnProperty("codec")&&(object.codec=message.codec),null!=message.file&&message.hasOwnProperty("file")&&(object.file=message.file),object},ProtoRendition}(),$root.ProtoSupplyChain=function(){function ProtoSupplyChain(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoSupplyChain.prototype.businessDomain="",ProtoSupplyChain.prototype.supplyChainId="",ProtoSupplyChain.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoSupplyChain;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.businessDomain=reader.string();break;case 3:message.supplyChainId=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoSupplyChain.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.businessDomain="",object.supplyChainId=""),null!=message.businessDomain&&message.hasOwnProperty("businessDomain")&&(object.businessDomain=message.businessDomain),null!=message.supplyChainId&&message.hasOwnProperty("supplyChainId")&&(object.supplyChainId=message.supplyChainId),object},ProtoSupplyChain}(),$root.ProtoUserInformation=function(){function ProtoUserInformation(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoUserInformation.prototype.userId="",ProtoUserInformation.prototype.lookupId="",ProtoUserInformation.prototype.lookupResponseCode=0,ProtoUserInformation.prototype.callFraudSensor=!1,ProtoUserInformation.prototype.publisherAdsTxt="",ProtoUserInformation.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoUserInformation;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.userId=reader.string();break;case 3:message.lookupId=reader.string();break;case 4:message.lookupResponseCode=reader.int32();break;case 5:message.callFraudSensor=reader.bool();break;case 6:message.publisherAdsTxt=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoUserInformation.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.userId="",object.lookupId="",object.lookupResponseCode=0,object.callFraudSensor=!1,object.publisherAdsTxt=""),null!=message.userId&&message.hasOwnProperty("userId")&&(object.userId=message.userId),null!=message.lookupId&&message.hasOwnProperty("lookupId")&&(object.lookupId=message.lookupId),null!=message.lookupResponseCode&&message.hasOwnProperty("lookupResponseCode")&&(object.lookupResponseCode=message.lookupResponseCode),null!=message.callFraudSensor&&message.hasOwnProperty("callFraudSensor")&&(object.callFraudSensor=message.callFraudSensor),null!=message.publisherAdsTxt&&message.hasOwnProperty("publisherAdsTxt")&&(object.publisherAdsTxt=message.publisherAdsTxt),object},ProtoUserInformation}(),$root.ProtoAdBreak=function(){function ProtoAdBreak(properties){if(this.types=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoAdBreak.prototype.types=$util.emptyArray,ProtoAdBreak.prototype.maxAdPodDuration=0,ProtoAdBreak.prototype.maxAdSlotDuration=180,ProtoAdBreak.prototype.numberOfAdSlots=1,ProtoAdBreak.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoAdBreak;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:if(message.types&&message.types.length||(message.types=[]),2==(7&tag))for(var end2=reader.uint32()+reader.pos;reader.pos<end2;)message.types.push(reader.int32());else message.types.push(reader.int32());break;case 2:message.maxAdPodDuration=reader.int32();break;case 3:message.maxAdSlotDuration=reader.int32();break;case 4:message.numberOfAdSlots=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoAdBreak.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.types=[]),options.defaults&&(object.maxAdPodDuration=0,object.maxAdSlotDuration=180,object.numberOfAdSlots=1),message.types&&message.types.length){object.types=[];for(var j=0;j<message.types.length;++j)object.types[j]=options.enums===String?$root.ProtoAdBreakTypeEnum[message.types[j]]:message.types[j]}return null!=message.maxAdPodDuration&&message.hasOwnProperty("maxAdPodDuration")&&(object.maxAdPodDuration=message.maxAdPodDuration),null!=message.maxAdSlotDuration&&message.hasOwnProperty("maxAdSlotDuration")&&(object.maxAdSlotDuration=message.maxAdSlotDuration),null!=message.numberOfAdSlots&&message.hasOwnProperty("numberOfAdSlots")&&(object.numberOfAdSlots=message.numberOfAdSlots),object},ProtoAdBreak}(),$root.ProtoPlayspaceCodecEnum=(valuesById={},(values=Object.create(valuesById))[valuesById[0]="h264"]=0,values[valuesById[1]="hevc"]=1,values),$root.ProtoPlayerOrientationEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Mixed"]=0,values[valuesById[1]="Portrait"]=1,values[valuesById[2]="Landscape"]=2,values}(),$root.ProtoEndOfSlideCycleMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Loop"]=0,values[valuesById[1]="Stop"]=1,values}(),$root.ProtoPlayspaceColorSchemeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Default"]=0,values[valuesById[1]="Accent"]=1,values[valuesById[2]="Primary"]=2,values[valuesById[3]="Secondary"]=3,values}(),$root.ProtoPlayspaceSlideTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Default"]=0,values[valuesById[1]="Cover"]=1,values[valuesById[2]="Description"]=2,values[valuesById[3]="BulletList"]=3,values[valuesById[4]="Stock"]=4,values[valuesById[5]="Quote"]=5,values[valuesById[6]="Instagram"]=6,values}(),$root.ProtoPlayspaceSlideCapabilitiesEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="VolumeControls"]=0,values[valuesById[1]="PlaybackControls"]=1,values[valuesById[2]="PlaylistControls"]=2,values[valuesById[3]="CtaButton"]=3,values[valuesById[4]="TopStoryTitle"]=4,values[valuesById[5]="TopSlideTitle"]=5,values}(),$root.ProtoMediaContextEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="None"]=0,values[valuesById[1]="Logo"]=1,values}(),$root.ProtoMediaTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Image"]=0,values[valuesById[1]="Video"]=1,values}(),$root.ProtoDeviceType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Desktop"]=0,values[valuesById[1]="Smartphone"]=1,values[valuesById[2]="Tablet"]=2,values[valuesById[3]="GameConsole"]=3,values[valuesById[4]="SmartTV"]=4,values[valuesById[5]="WearableComputer"]=5,values[valuesById[6]="PDA"]=6,values[valuesById[7]="Unrecognized"]=7,values}(),$root.ProtoTrackerType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Image"]=0,values[valuesById[1]="Javascript"]=1,values}(),$root.ProtoTrackerTriggerType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Impression"]=0,values[valuesById[1]="Complete25Pc"]=1,values[valuesById[2]="Complete50Pc"]=2,values[valuesById[3]="Complete75Pc"]=3,values[valuesById[4]="ViewCompletion"]=4,values[valuesById[5]="VideoClick"]=5,values[valuesById[6]="Pause"]=6,values[valuesById[7]="Resume"]=7,values[valuesById[8]="Mute"]=8,values[valuesById[9]="Unmute"]=9,values}(),$root.ProtoCreativeTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="ThirdParty"]=0,values[valuesById[1]="MediaFile"]=1,values[valuesById[2]="Rtb"]=2,values[valuesById[3]="External"]=3,values[valuesById[4]="HeaderBidder"]=4,values[valuesById[7]="Tam"]=7,values[valuesById[8]="TamDeal"]=8,values}(),$root.ProtoResetCapTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="TimeCapping"]=0,values[valuesById[1]="ContentCapping"]=1,values[valuesById[2]="OpportunityCapping"]=2,values}(),$root.ProtoAdSlotsEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="PreRoll"]=0,values[valuesById[1]="MidRoll"]=1,values[valuesById[2]="PostRoll"]=2,values}(),$root.ProtoLineItemPriority=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="House"]=0,values[valuesById[1]="Default"]=1,values[valuesById[2]="Preferred"]=2,values[valuesById[3]="Top"]=3,values}(),$root.ProtoAdSkipMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="IfLongerThan31Sec"]=0,values[valuesById[1]="Always"]=1,values[valuesById[2]="Never"]=2,values[valuesById[3]="NotAplicable"]=3,values}(),$root.ProtoAdType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Video"]=0,values[valuesById[1]="Overlay"]=1,values}(),$root.ProtoChoiceCriteriaEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Only"]=0,values[valuesById[1]="Except"]=1,values}(),$root.ProtoLineItemAdBreakTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[1]="All"]=1,values[valuesById[2]="SingleAd"]=2,values[valuesById[3]="AdPod"]=3,values}(),$root.ProtoLineItemTargetingTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Only"]=0,values[valuesById[1]="Except"]=1,values}(),$root.ProtoLineItemAdSlotTargetingTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[1]="SpecificSlots"]=1,values[valuesById[2]="Interval"]=2,values}(),$root.ProtoLineItemPauseAdOutOfViewEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Default"]=0,values[valuesById[1]="Strict"]=1,values}(),$root.ProtoLineItemContextualTargetingEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="IncludeAny"]=0,values[valuesById[1]="IncludeAll"]=1,values[valuesById[2]="ExcludeAny"]=2,values[valuesById[3]="ExcludeAll"]=3,values}(),$root.ProtoSizeChoiceCriteriaEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="GreaterThan"]=0,values[valuesById[1]="SmallerThan"]=1,values[valuesById[2]="Between"]=2,values}(),$root.ProtoPlayerPlaybackModeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Autoplay"]=0,values[valuesById[1]="ScrollToPlay"]=1,values[valuesById[2]="ClickToPlay"]=2,values}(),$root.ProtoPlayerCloseButtonMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Off"]=0,values[valuesById[1]="OnHover"]=1,values[valuesById[2]="OnHoverAfterFirstAd"]=2,values[valuesById[3]="AlwaysOn"]=3,values}(),$root.ProtoPlayerFloatingMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Off"]=0,values[valuesById[1]="OnPageLoad"]=1,values[valuesById[2]="AfterInView"]=2,values[valuesById[3]="Always"]=3,values}(),$root.ProtoPlayerSoundMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Mute"]=0,values[valuesById[1]="On"]=1,values[valuesById[2]="Hover"]=2,values}(),$root.ProtoPlayerInsertMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="WithinContainer"]=0,values[valuesById[1]="BeforeContainer"]=1,values[valuesById[2]="AfterContainer"]=2,values[valuesById[3]="ReplaceContainer"]=3,values[valuesById[4]="HideContainer"]=4,values}(),$root.ProtoAdViewabilityPolicy=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Default"]=0,values[valuesById[1]="Strict"]=1,values}(),$root.ProtoSharingDestination=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Facebook"]=0,values[valuesById[1]="Twitter"]=1,values[valuesById[2]="LinkedIn"]=2,values}(),$root.ProtoFloatingFixedPositionMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Page"]=0,values[valuesById[1]="Element"]=1,values}(),$root.ProtoPositionMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="BottomRight"]=0,values[valuesById[1]="BottomLeft"]=1,values[valuesById[2]="TopRight"]=2,values[valuesById[3]="TopLeft"]=3,values}(),$root.ProtoAdPlaybackMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Autoplay"]=0,values[valuesById[1]="ScrollToPlay"]=1,values}(),$root.ProtoFloatingAppendLocationEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Above"]=0,values[valuesById[1]="Below"]=1,values[valuesById[2]="Within"]=2,values}(),$root.ProtoPlayerAdSkippability=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="IfLongerThan"]=0,values[valuesById[1]="Always"]=1,values[valuesById[2]="NoRestrictions"]=2,values}(),$root.ProtoVideoQuality=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Auto"]=0,values[valuesById[1]="High1080p"]=1,values[valuesById[2]="High720p"]=2,values[valuesById[3]="Medium360p"]=3,values}(),$root.ProtoImplementationType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Web"]=0,values[valuesById[1]="Amp"]=1,values}(),$root.ProtoAdBreakTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="None"]=0,values[valuesById[1]="PreRoll"]=1,values[valuesById[2]="MidRoll"]=2,values[valuesById[3]="PostRoll"]=3,values}(),$root.ProtoAdSlotAdTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="SingleAd"]=0,values[valuesById[1]="AdPod"]=1,values}(),module.exports=$root},function(module,__webpack_exports__,__webpack_require__){"use strict";var AdStatusEnum,VastMediaFileType,PostBidErrorsEnum,OverlayCreativeMime;__webpack_require__.d(__webpack_exports__,"a",function(){return AdStatusEnum}),__webpack_require__.d(__webpack_exports__,"d",function(){return VastMediaFileType}),__webpack_require__.d(__webpack_exports__,"c",function(){return PostBidErrorsEnum}),__webpack_require__.d(__webpack_exports__,"b",function(){return OverlayCreativeMime}),function(AdStatusEnum){AdStatusEnum[AdStatusEnum.Idle=0]="Idle",AdStatusEnum[AdStatusEnum.Loading=1]="Loading",AdStatusEnum[AdStatusEnum.Ready=2]="Ready",AdStatusEnum[AdStatusEnum.Error=3]="Error",AdStatusEnum[AdStatusEnum.Capped=4]="Capped",AdStatusEnum[AdStatusEnum.InWin=5]="InWin",AdStatusEnum[AdStatusEnum.Consumed=6]="Consumed",AdStatusEnum[AdStatusEnum.InImpression=7]="InImpression"}(AdStatusEnum||(AdStatusEnum={})),function(VastMediaFileType){VastMediaFileType[VastMediaFileType.Javascript=0]="Javascript",VastMediaFileType[VastMediaFileType.Video=1]="Video"}(VastMediaFileType||(VastMediaFileType={})),function(PostBidErrorsEnum){PostBidErrorsEnum.Timeout="timeout",PostBidErrorsEnum.TimeoutLoaded="timeout_loaded",PostBidErrorsEnum.ImaError="imaError",PostBidErrorsEnum.ImaScriptFailure="imaScriptFailure",PostBidErrorsEnum.ImaObjectNotFound="imaObjectNotFound",PostBidErrorsEnum.ImaManagerInit="imaManagerInit",PostBidErrorsEnum.ImaInitSdkError="initImasdkError",PostBidErrorsEnum.VastVideoTagEventError="vastVideoTagEventError",PostBidErrorsEnum.VastUnsupportedMedia="vastUnsupportedMedia",PostBidErrorsEnum.VastPlayPromiseReject="playPromiseReject",PostBidErrorsEnum.AdStopped="adStopped",PostBidErrorsEnum.MuteEnforce="muteEnforce",PostBidErrorsEnum.VpaidOnLoad="vpaidOnLoad",PostBidErrorsEnum.VpaidInvalid="vpaidInvalid",PostBidErrorsEnum.VpaidGetVpaidAdError="vpaidGetVpaidAdError",PostBidErrorsEnum.CnxMediaNoRenditions="noRenditions",PostBidErrorsEnum.CnxMediaSrcNotSupported="srcNotSupported",PostBidErrorsEnum.InvalidVpaidEvent="invalidVpaidEvent",PostBidErrorsEnum.AdxOverlayNoFill="adxOverlayNoFill",PostBidErrorsEnum.AdxOverlayGptScriptLoad="adxOverlayGptScriptLoad",PostBidErrorsEnum.DisplayIntegratorIframeLoad="displayIntegratorIframeLoad",PostBidErrorsEnum.EnforcementMalware="malwareDetected",PostBidErrorsEnum.EnforcementVolume="volumeDetected",PostBidErrorsEnum.Cancelled="adManagerRemoved",PostBidErrorsEnum.DomainBlocked="domainBlocked",PostBidErrorsEnum.AdaptorStartAdError="adaptorStartAdError",PostBidErrorsEnum.AdaptorInitAdError="adaptorInitAdError",PostBidErrorsEnum.WrapperStartAdError="wrapperStartAdError",PostBidErrorsEnum.WrapperInitAdError="wrapperInitAdError"}(PostBidErrorsEnum||(PostBidErrorsEnum={})),function(OverlayCreativeMime){OverlayCreativeMime.Html="text/html",OverlayCreativeMime.Javascript="application/javascript"}(OverlayCreativeMime||(OverlayCreativeMime={}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return DURATION_REGEX}),__webpack_require__.d(__webpack_exports__,"d",function(){return MS_IN_HOUR}),__webpack_require__.d(__webpack_exports__,"e",function(){return MS_IN_MINUTE}),__webpack_require__.d(__webpack_exports__,"f",function(){return MS_IN_SECOND}),__webpack_require__.d(__webpack_exports__,"g",function(){return SECONDS_IN_MINUTES}),__webpack_require__.d(__webpack_exports__,"a",function(){return DAY_TO_MILLISECONDS}),__webpack_require__.d(__webpack_exports__,"c",function(){return MINUTES_IN_HOUR});var DURATION_REGEX=/(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/,MS_IN_HOUR=36e5,MS_IN_MINUTE=6e4,MS_IN_SECOND=1e3,SECONDS_IN_MINUTES=60,DAY_TO_MILLISECONDS=864e5,MINUTES_IN_HOUR=60},function(module,__webpack_exports__,__webpack_require__){"use strict";var VPAID_EVENTS=__webpack_require__(10).b,CnxTrackingEventsEnum=Object.assign(Object.assign({},VPAID_EVENTS),{AdBreakStart:"adBreakStart",AdComplete:"adComplete",AdBreakComplete:"adBreakComplete",Pause:"pause",AdPause:"adPause",Play:"play",AdPlay:"adPlay",ContentComplete:"contentComplete",SessionStart:"sessionStart",SessionEnd:"sessionEnd",PlayerResized:"playerStateResize",OnEnterFullscreen:"onEnterFullscreen",OnExitFullscreen:"onExitFullscreen",PlayerCollapsed:"playerCollapsed",PlayerExpanded:"playerExpanded",PlayError:"playError",RenderError:"renderError",AdStateChange:"adStateChange",VolumeChange:"volumeChange",Destroy:"destroy"});__webpack_exports__.a=CnxTrackingEventsEnum},function(module,__webpack_exports__,__webpack_require__){"use strict";var classCallCheck=__webpack_require__(1),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(2),createClass_default=__webpack_require__.n(createClass),EnvironmentConfig=__webpack_require__(27),EnvironmentEndpoints_EnvironmentEndPoints=function(){function EnvironmentEndPoints(baseEndPoints){classCallCheck_default()(this,EnvironmentEndPoints),this.base=baseEndPoints,this.api={pls:baseEndPoints.core+"core/pls",story:baseEndPoints.core+"core/story",rtb:baseEndPoints.core+"rtb/g",syncUrls:baseEndPoints.core+"core/us",fallbackstory:baseEndPoints.core+"core/fallbackstory",cookie:baseEndPoints.core+"core/ck",tam:baseEndPoints.core+"core/atam"},this.tracking={session_rendered:baseEndPoints.tracking+"sr",session_view:baseEndPoints.tracking+"sv",session_time:baseEndPoints.tracking+"st",session_client_error:baseEndPoints.tracking+"e",media_quartile:baseEndPoints.tracking+"mq",media_click:baseEndPoints.tracking+"mc",ad_impression:baseEndPoints.tracking+"ai",bids:baseEndPoints.tracking+"abt",ad_impression_viewable:baseEndPoints.tracking+"av",ad_quartile:baseEndPoints.tracking+"aq",ad_click:baseEndPoints.tracking+"ac",logging:baseEndPoints.tracking+"e",playerStart:baseEndPoints.tracking+"ps",adOpportunity:baseEndPoints.tracking+"ao",sessionAdBlocker:baseEndPoints.tracking+"sab",heavy_ad_intervention:baseEndPoints.tracking+"ha",auctionInformation:baseEndPoints.tracking+"aucinfo"},this.assets={css:{elements:"".concat(this._getAssetsBaseEndpoint(baseEndPoints.assets),"player.css"),playspace:"".concat(this._getAssetsBaseEndpoint(baseEndPoints.assets),"connatix.playspace.css")},plugins:{adobeAnalytics:"".concat(baseEndPoints.plugins,"p/plugins/adobe.plugin.js"),moatAnalytics:"".concat(baseEndPoints.plugins,"p/plugins/moat.plugin.js"),prebidScript:"".concat(baseEndPoints.plugins,"p/plugins/prebid4.43.0-1.js")}}}return createClass_default()(EnvironmentEndPoints,[{key:"_getAssetsBaseEndpoint",value:function(assetsBase){return"development"===EnvironmentConfig.a.env?"//cd.".concat(EndPointResolver_EndPointResolver.bundleDomain,"/"):"".concat(assetsBase,"p/").concat(EnvironmentConfig.a.version,"/")}}]),EnvironmentEndPoints}(),HrefUtils=__webpack_require__(26),GeneralUtils=__webpack_require__(15),TypeUtils=__webpack_require__(4);__webpack_require__.d(__webpack_exports__,"a",function(){return EndPointResolver_EndPointResolver});var EndPointResolver_EndPointResolver=function(){function EndPointResolver(){classCallCheck_default()(this,EndPointResolver)}return createClass_default()(EndPointResolver,null,[{key:"_getBaseEndPoints",value:function(domain){return{video:"//vid.".concat(domain,"/"),image:"//img.".concat(domain,"/"),core:"https://capi{{env}}.".concat(domain,"/"),tracking:"https://capi{{env}}.".concat(domain,"/tr/"),metadata:"//vid.".concat(domain,"/"),assets:"//cds{{env}}.".concat(domain,"/"),plugins:"//cds.".concat(domain,"/"),lineItems:"//lit.".concat(domain,"/")}}},{key:"_constructEndPoints",value:function(){var environment=Object(HrefUtils.b)("cnxEnv",Object(GeneralUtils.f)(window).topFrame.location.href);environment&&(EnvironmentConfig.a.domainPrefix="-".concat(environment));var baseEndPoints=this._getBaseEndPoints(this.bundleDomain);return Object.keys(baseEndPoints).forEach(function(key){baseEndPoints[key]=baseEndPoints[key].replace("{{env}}",EnvironmentConfig.a.domainPrefix)}),new EnvironmentEndpoints_EnvironmentEndPoints(baseEndPoints)}},{key:"bundleDomain",set:function(domain){this._bundleDomain=domain},get:function(){if(!Object(TypeUtils.h)(this._bundleDomain))throw new Error("bundleDomain missing");return this._bundleDomain}},{key:"endPoints",get:function(){return null===EndPointResolver._constructedEndpoints&&(EndPointResolver._constructedEndpoints=EndPointResolver._constructEndPoints()),EndPointResolver._constructedEndpoints}}]),EndPointResolver}();EndPointResolver_EndPointResolver.defaultErrorLogging="//capi.connatix.com/tr/e/",EndPointResolver_EndPointResolver._constructedEndpoints=null},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",function(){return mapNumber}),__webpack_require__.d(__webpack_exports__,"c",function(){return getClosestNumberFromArray}),__webpack_require__.d(__webpack_exports__,"d",function(){return getGreatestCommonDivisor}),__webpack_require__.d(__webpack_exports__,"e",function(){return getNumberByPercentage}),__webpack_require__.d(__webpack_exports__,"h",function(){return roundPrecision}),__webpack_require__.d(__webpack_exports__,"f",function(){return isInvalidDimensions}),__webpack_require__.d(__webpack_exports__,"a",function(){return bigNumberFormat}),__webpack_require__.d(__webpack_exports__,"b",function(){return calculateRatio});var Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4);function mapNumber(fromStart,fromEnd,toStart,toEnd,value){return toStart+(toEnd-toStart)*function(start,end,value){return(value-start)/(end-start)}(fromStart,fromEnd,value)}function getClosestNumberFromArray(desiredNumber,availableNumber){return availableNumber.reduce(function(prev,curr){return Math.abs(curr-desiredNumber)<=Math.abs(prev-desiredNumber)?curr:prev})}function getGreatestCommonDivisor(firstNumber,secondNumber){for(var first=firstNumber,second=secondNumber;0!==first&&0!==second;)first>second?first%=second:second%=first;return 0===first?second:first}function getNumberByPercentage(number,percentage){return percentage/100*number}function roundPrecision(value,precision){var multiplier=Math.pow(10,precision);return Math.round(value*multiplier)/multiplier}function isInvalidDimensions(dimensions){return!Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_0__.e)(dimensions.width)||!Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_0__.e)(dimensions.height)}function bigNumberFormat(number){var i,thresholds=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"}];for(i=thresholds.length-1;i>0&&!(number>=thresholds[i].value);i--);return number/thresholds[i].value<thresholds[i].value/10?(Math.floor(number/thresholds[i].value*10)/10).toFixed(1).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+thresholds[i].symbol:Math.floor(number/thresholds[i].value).toFixed(0)+thresholds[i].symbol}function calculateRatio(width,height){for(var i=height;i>1;i--)width%i==0&&height%i==0&&(width/=i,height/=i);return{widthRatio:width,heightRatio:height}}},function(module,exports,__webpack_require__){"undefined"!=typeof window&&(module.exports=function(e){var t={};function r(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(a,i,function(t){return e[t]}.bind(null,i));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=13)}([function(e,t,r){"use strict";r.d(t,"a",function(){return u}),r.d(t,"b",function(){return f});var a=r(5);function i(){}var n={trace:i,debug:i,log:i,warn:i,info:i,error:i},s=n,l=Object(a.a)(),u=function(e){if(l.console&&!0===e||"object"==typeof e){!function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];r.forEach(function(t){s[t]=e[t]?e[t].bind(e):function(e){var t=l.console[e];return t?function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];a[0]&&(a[0]=function(e,t){return t="["+e+"] > "+t}(e,a[0])),t.apply(l.console,a)}:i}(t)})}(e,"debug","log","info","warn","error");try{s.log()}catch(e){s=n}}else s=n},f=s},function(e,t,r){"use strict";t.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},function(e,t,r){"use strict";var a,i;r.d(t,"b",function(){return a}),r.d(t,"a",function(){return i}),function(e){e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError"}(a||(a={})),function(e){e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException"}(i||(i={}))},function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)}},function(e,t,r){"use strict";r.d(t,"b",function(){return o});var a,i=r(5),n=function(){function e(){}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,r){for(var a=r,i=0;e.isHeader(t,r);)i+=10,i+=e._readSize(t,r+6),e.isFooter(t,r+10)&&(i+=10),r+=i;if(i>0)return t.subarray(a,a+i)},e._readSize=function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]},e.getTimeStamp=function(t){for(var r=e.getID3Frames(t),a=0;a<r.length;a++){var i=r[a];if(e.isTimeStampFrame(i))return e._readTimeStamp(i)}},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),a=e._readSize(t,4);return{type:r,size:a,data:t.subarray(10,10+a)}},e.getID3Frames=function(t){for(var r=0,a=[];e.isHeader(t,r);){for(var i=e._readSize(t,r+6),n=(r+=10)+i;r+8<n;){var s=e._getFrameData(t.subarray(r)),o=e._decodeFrame(s);o&&a.push(o),r+=s.size+10}e.isFooter(t,r)&&(r+=10)}return a},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],a=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return a/=45,r&&(a+=47721858.84),Math.round(a)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var r=e._utf8ArrayToStr(t.data,!0),a=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:a.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var r=1,a=e._utf8ArrayToStr(t.data.subarray(r),!0);r+=a.length+1;var i=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:a,data:i}}var n=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:n}}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var r=1,a=e._utf8ArrayToStr(t.data.subarray(r));r+=a.length+1;var i=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:a,data:i}}var n=e._utf8ArrayToStr(t.data);return{key:t.type,data:n}},e._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);var r=s();if(r){var a=r.decode(e);if(t){var i=a.indexOf("\0");return-1!==i?a.substring(0,i):a}return a.replace(/\0/g,"")}for(var n,o,l,d=e.length,u="",f=0;f<d;){if(0===(n=e[f++])&&t)return u;if(0!==n&&3!==n)switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(n);break;case 12:case 13:o=e[f++],u+=String.fromCharCode((31&n)<<6|63&o);break;case 14:o=e[f++],l=e[f++],u+=String.fromCharCode((15&n)<<12|(63&o)<<6|(63&l)<<0)}}return u},e}();function s(){var e=Object(i.a)();return a||void 0===e.TextDecoder||(a=new e.TextDecoder("utf-8")),a}var o=n._utf8ArrayToStr;t.a=n},function(e,t,r){"use strict";function a(){return"undefined"==typeof window?self:window.cnxRenderWindow?window.cnxRenderWindow:window}r.d(t,"a",function(){return a})},function(e,t){e.exports=void 0},function(e,t,r){var a,i,n,s,o;a=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/?#]*)(.*)$/,n=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var a=o.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");return a.path=o.normalizePath(a.path),o.buildURLFromParts(a)}var n=o.parseURL(t);if(!n)throw new Error("Error trying to parse relative URL.");if(n.scheme)return r.alwaysNormalize?(n.path=o.normalizePath(n.path),o.buildURLFromParts(n)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=i.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var d={scheme:s.scheme,netLoc:n.netLoc,path:null,params:n.params,query:n.query,fragment:n.fragment};if(!n.netLoc&&(d.netLoc=s.netLoc,"/"!==n.path[0]))if(n.path){var u=s.path,f=u.substring(0,u.lastIndexOf("/")+1)+n.path;d.path=o.normalizePath(f)}else d.path=s.path,n.params||(d.params=s.params,n.query||(d.query=s.query));return null===d.path&&(d.path=r.alwaysNormalize?o.normalizePath(n.path):n.path),o.buildURLFromParts(d)},parseURL:function(e){var t=a.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(n,"");e.length!==(e=e.replace(s,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o},function(e,t,r){"use strict";var a=Object.prototype.hasOwnProperty,i="~";function n(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,r,a,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new s(r,a||e,n),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function d(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),d.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)a.call(e,t)&&r.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},d.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var a=0,n=r.length,s=new Array(n);a<n;a++)s[a]=r[a].fn;return s},d.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},d.prototype.emit=function(e,t,r,a,n,s){var o=i?i+e:e;if(!this._events[o])return!1;var l,d,u=this._events[o],f=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),f){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,a),!0;case 5:return u.fn.call(u.context,t,r,a,n),!0;case 6:return u.fn.call(u.context,t,r,a,n,s),!0}for(d=1,l=new Array(f-1);d<f;d++)l[d-1]=arguments[d];u.fn.apply(u.context,l)}else{var h,c=u.length;for(d=0;d<c;d++)switch(u[d].once&&this.removeListener(e,u[d].fn,void 0,!0),f){case 1:u[d].fn.call(u[d].context);break;case 2:u[d].fn.call(u[d].context,t);break;case 3:u[d].fn.call(u[d].context,t,r);break;case 4:u[d].fn.call(u[d].context,t,r,a);break;default:if(!l)for(h=1,l=new Array(f-1);h<f;h++)l[h-1]=arguments[h];u[d].fn.apply(u[d].context,l)}}return!0},d.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},d.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},d.prototype.removeListener=function(e,t,r,a){var n=i?i+e:e;if(!this._events[n])return this;if(!t)return l(this,n),this;var s=this._events[n];if(s.fn)s.fn!==t||a&&!s.once||r&&s.context!==r||l(this,n);else{for(var o=0,d=[],u=s.length;o<u;o++)(s[o].fn!==t||a&&!s[o].once||r&&s[o].context!==r)&&d.push(s[o]);d.length?this._events[n]=1===d.length?d[0]:d:l(this,n)}return this},d.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&l(this,t)):(this._events=new n,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=i,d.EventEmitter=d,e.exports=d},function(e,t,r){"use strict";var a=r(1),i=r(2),n=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),s=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}(),o=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),a=0;a<4;a++)r[a]=t.getUint32(4*a);return r},t.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,a=r[0],i=r[1],n=r[2],s=r[3],o=this.invSubMix,l=o[0],d=o[1],u=o[2],f=o[3],h=new Uint32Array(256),c=0,v=0,p=0;for(p=0;p<256;p++)h[p]=p<128?p<<1:p<<1^283;for(p=0;p<256;p++){var g=v^v<<1^v<<2^v<<3^v<<4;g=g>>>8^255&g^99,e[c]=g,t[g]=c;var m=h[c],y=h[m],b=h[y],E=257*h[g]^16843008*g;a[c]=E<<24|E>>>8,i[c]=E<<16|E>>>16,n[c]=E<<8|E>>>24,s[c]=E,E=16843009*b^65537*y^257*m^16843008*c,l[g]=E<<24|E>>>8,d[g]=E<<16|E>>>16,u[g]=E<<8|E>>>24,f[g]=E,c?(c=m^h[h[h[b^m]]],v^=h[h[v]]):c=v=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,a=0;a<t.length&&r;)r=t[a]===this.key[a],a++;if(!r){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var n,s,o,l,d=this.ksRows=4*(i+6+1),u=this.keySchedule=new Uint32Array(d),f=this.invKeySchedule=new Uint32Array(d),h=this.sBox,c=this.rcon,v=this.invSubMix,p=v[0],g=v[1],m=v[2],y=v[3];for(n=0;n<d;n++)n<i?o=u[n]=t[n]:(l=o,n%i==0?(l=h[(l=l<<8|l>>>24)>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l],l^=c[n/i|0]<<24):i>6&&n%i==4&&(l=h[l>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l]),u[n]=o=(u[n-i]^l)>>>0);for(s=0;s<d;s++)n=d-s,l=3&s?u[n]:u[n-4],f[s]=s<4||n<=4?l:p[h[l>>>24]]^g[h[l>>>16&255]]^m[h[l>>>8&255]]^y[h[255&l]],f[s]=f[s]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,r,a){for(var i,n,s,o,l,d,u,f,h,c,v,p,g,m,y,b,E,T=this.keySize+6,S=this.invKeySchedule,A=this.invSBox,_=this.invSubMix,R=_[0],L=_[1],w=_[2],D=_[3],k=this.uint8ArrayToUint32Array_(r),x=k[0],O=k[1],I=k[2],C=k[3],P=new Int32Array(e),F=new Int32Array(P.length),M=this.networkToHostOrderSwap;t<P.length;){for(h=M(P[t]),c=M(P[t+1]),v=M(P[t+2]),p=M(P[t+3]),l=h^S[0],d=p^S[1],u=v^S[2],f=c^S[3],g=4,m=1;m<T;m++)i=R[l>>>24]^L[d>>16&255]^w[u>>8&255]^D[255&f]^S[g],n=R[d>>>24]^L[u>>16&255]^w[f>>8&255]^D[255&l]^S[g+1],s=R[u>>>24]^L[f>>16&255]^w[l>>8&255]^D[255&d]^S[g+2],o=R[f>>>24]^L[l>>16&255]^w[d>>8&255]^D[255&u]^S[g+3],l=i,d=n,u=s,f=o,g+=4;i=A[l>>>24]<<24^A[d>>16&255]<<16^A[u>>8&255]<<8^A[255&f]^S[g],n=A[d>>>24]<<24^A[u>>16&255]<<16^A[f>>8&255]<<8^A[255&l]^S[g+1],s=A[u>>>24]<<24^A[f>>16&255]<<16^A[l>>8&255]<<8^A[255&d]^S[g+2],o=A[f>>>24]<<24^A[l>>16&255]<<16^A[d>>8&255]<<8^A[255&u]^S[g+3],g+=3,F[t]=M(i^x),F[t+1]=M(o^O),F[t+2]=M(s^I),F[t+3]=M(n^C),x=h,O=c,I=v,C=p,t+=4}return a?(y=F.buffer,b=y.byteLength,(E=b&&new DataView(y).getUint8(b-1))?y.slice(0,b-E):y):F.buffer},t.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}(),l=r(0),d=r(5),u=function(){function e(e,t,r){var a=(void 0===r?{}:r).removePKCS7Padding,i=void 0===a||a;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=i,i)try{var n=Object(d.a)().crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}var t=e.prototype;return t.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.decrypt=function(e,t,r,a){var i=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(l.b.log("JS AES decrypt"),this.logEnabled=!1);var d=this.decryptor;d||(this.decryptor=d=new o),d.expandKey(t),a(d.decrypt(e,0,r,this.removePKCS7Padding))}else{this.logEnabled&&(l.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var u=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new s(u,t)),this.fastAesKey.expandKey().then(function(s){new n(u,r).decrypt(e,s).catch(function(n){i.onWebCryptoError(n,e,t,r,a)}).then(function(e){a(e)})}).catch(function(n){i.onWebCryptoError(n,e,t,r,a)})}},t.onWebCryptoError=function(e,t,r,n,s){this.config.enableSoftwareAES?(l.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,n,s)):(l.b.error("decrypting error : "+e.message),this.observer.trigger(a.a.ERROR,{type:i.b.MEDIA_ERROR,details:i.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},t.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}(),f=r(3);function h(e,t){return 255===e[t]&&240==(246&e[t+1])}function c(e,t){return 1&e[t+1]?7:9}function v(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function p(e,t){return!!(t+1<e.length&&h(e,t))}function g(e,t){if(p(e,t)){var r=c(e,t);t+5<e.length&&(r=v(e,t));var a=t+r;if(a===e.length||a+1<e.length&&h(e,a))return!0}return!1}function m(e,t,r,n,s){if(!e.samplerate){var o=function(e,t,r,n){var s,o,d,u,f,h=navigator.userAgent.toLowerCase(),c=n,v=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(s=1+((192&t[r+2])>>>6),!((o=(60&t[r+2])>>>2)>v.length-1))return u=(1&t[r+2])<<2,u|=(192&t[r+3])>>>6,l.b.log("manifest codec:"+n+",ADTS data:type:"+s+",sampleingIndex:"+o+"["+v[o]+"Hz],channelConfig:"+u),/firefox/i.test(h)?o>=6?(s=5,f=new Array(4),d=o-3):(s=2,f=new Array(2),d=o):-1!==h.indexOf("android")?(s=2,f=new Array(2),d=o):(s=5,f=new Array(4),n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&o>=6?d=o-3:((n&&-1!==n.indexOf("mp4a.40.2")&&(o>=6&&1===u||/vivaldi/i.test(h))||!n&&1===u)&&(s=2,f=new Array(2)),d=o)),f[0]=s<<3,f[0]|=(14&o)>>1,f[1]|=(1&o)<<7,f[1]|=u<<3,5===s&&(f[1]|=(14&d)>>1,f[2]=(1&d)<<7,f[2]|=8,f[3]=0),{config:f,samplerate:v[o],channelCount:u,codec:"mp4a.40."+s,manifestCodec:c};e.trigger(a.a.ERROR,{type:i.b.MEDIA_ERROR,details:i.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+o})}(t,r,n,s);e.config=o.config,e.samplerate=o.samplerate,e.channelCount=o.channelCount,e.codec=o.codec,e.manifestCodec=o.manifestCodec,l.b.log("parsed codec:"+e.codec+",rate:"+o.samplerate+",nb channel:"+o.channelCount)}}function y(e){return 9216e4/e}function b(e,t,r,a,i){var n=function(e,t,r,a,i){var n,s,o=e.length;if(n=c(e,t),s=v(e,t),(s-=n)>0&&t+n+s<=o)return{headerLength:n,frameLength:s,stamp:r+a*i}}(t,r,a,i,y(e.samplerate));if(n){var s=n.stamp,o=n.headerLength,l=n.frameLength,d={unit:t.subarray(r+o,r+o+l),pts:s,dts:s};return e.samples.push(d),{sample:d,length:l+o}}}var E=r(4),T=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,r,a){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:a,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(E.a.getID3Data(e,0)||[]).length,r=e.length;t<r;t++)if(g(e,t))return l.b.log("ADTS sync word found !"),!0;return!1},t.append=function(e,t,r,a){for(var i=this._audioTrack,n=E.a.getID3Data(e,0)||[],s=E.a.getTimeStamp(n),o=Object(f.a)(s)?90*s:9e4*t,d=0,u=o,h=e.length,c=n.length,v=[{pts:u,dts:u,data:n}];c<h-1;)if(p(e,c)&&c+5<h){m(i,this.observer,e,c,i.manifestCodec);var g=b(i,e,c,o,d);if(!g){l.b.log("Unable to parse AAC frame");break}c+=g.length,u=g.sample.pts,d++}else E.a.isHeader(e,c)?(n=E.a.getID3Data(e,c),v.push({pts:u,dts:u,data:n}),c+=n.length):c++;this.remuxer.remux(i,{samples:[]},{samples:v,inputTimeScale:9e4},{samples:[]},t,r,a)},t.destroy=function(){},e}(),S=r(10),A={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,r,a,i){if(!(r+24>t.length)){var n=this.parseHeader(t,r);if(n&&r+n.frameLength<=t.length){var s=a+i*(9e4*n.samplesPerFrame/n.sampleRate),o={unit:t.subarray(r,r+n.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=n.channelCount,e.samplerate=n.sampleRate,e.samples.push(o),{sample:o,length:n.frameLength}}}},parseHeader:function(e,t){var r=e[t+1]>>3&3,a=e[t+1]>>1&3,i=e[t+2]>>4&15,n=e[t+2]>>2&3,s=e[t+2]>>1&1;if(1!==r&&0!==i&&15!==i&&3!==n){var o=3===r?3-a:3===a?3:4,l=1e3*A.BitratesMap[14*o+i-1],d=3===r?0:2===r?1:2,u=A.SamplingRateMap[3*d+n],f=e[t+3]>>6==3?1:2,h=A.SamplesCoefficients[r][a],c=A.BytesInSlot[a],v=8*h*c;return{sampleRate:u,channelCount:f,frameLength:parseInt(h*l/u+s,10)*c,samplesPerFrame:v}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),a=4;r&&r.frameLength&&(a=r.frameLength);var i=t+a;if(i===e.length||i+1<e.length&&this.isHeaderPattern(e,i))return!0}return!1}},_=A,R=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,a=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");a.set(e.subarray(r,r+i)),this.word=new DataView(a.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i},t.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return e>32&&l.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){var t,r=8,a=8;for(t=0;t<e;t++)0!==a&&(a=(r+this.readEG()+256)%256),r=0===a?r:a},t.readSPS=function(){var e,t,r,a,i,n,s,o=0,l=0,d=0,u=0,f=this.readUByte.bind(this),h=this.readBits.bind(this),c=this.readUEG.bind(this),v=this.readBoolean.bind(this),p=this.skipBits.bind(this),g=this.skipEG.bind(this),m=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(f(),e=f(),h(5),p(3),f(),m(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var b=c();if(3===b&&p(1),m(),m(),p(1),v())for(n=3!==b?8:12,s=0;s<n;s++)v()&&y(s<6?16:64)}m();var E=c();if(0===E)c();else if(1===E)for(p(1),g(),g(),t=c(),s=0;s<t;s++)g();m(),p(1),r=c(),a=c(),0===(i=h(1))&&p(1),p(1),v()&&(o=c(),l=c(),d=c(),u=c());var T=[1,1];if(v()&&v())switch(f()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[f()<<8|f(),f()<<8|f()]}return{width:Math.ceil(16*(r+1)-2*o-2*l),height:(2-i)*(a+1)*16-(i?2:4)*(d+u),pixelRatio:T}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),L=function(){function e(e,t,r,a){this.decryptdata=r,this.discardEPB=a,this.decrypter=new u(e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},t.decryptAacSample=function(e,t,r,a){var i=e[t].unit,n=i.subarray(16,i.length-i.length%16),s=n.buffer.slice(n.byteOffset,n.byteOffset+n.length),o=this;this.decryptBuffer(s,function(n){n=new Uint8Array(n),i.set(n,16),a||o.decryptAacSamples(e,t+1,r)})},t.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var a=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,a),!a)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),a=0,i=32;i<=e.length-16;i+=160,a+=16)r.set(e.subarray(i,i+16),a);return r},t.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var r=0,a=32;a<=e.length-16;a+=160,r+=16)e.set(t.subarray(r,r+16),a);return e},t.decryptAvcSample=function(e,t,r,a,i,n){var s=this.discardEPB(i.data),o=this.getAvcEncryptedData(s),l=this;this.decryptBuffer(o.buffer,function(o){i.data=l.getAvcDecryptedUnit(s,o),n||l.decryptAvcSamples(e,t,r+1,a)})},t.decryptAvcSamples=function(e,t,r,a){for(;;t++,r=0){if(t>=e.length)return void a();for(var i=e[t].units;!(r>=i.length);r++){var n=i[r];if(!(n.length<=48||1!==n.type&&5!==n.type)){var s=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,a,n,s),!s)return}}}},e}(),w={video:1,audio:2,id3:3,text:4},D=function(){function e(e,t,r,a){this.observer=e,this.config=r,this.typeSupported=a,this.remuxer=t,this.sampleAes=null}var t=e.prototype;return t.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new L(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var r=e._syncOffset(t);return!(r<0||(r&&l.b.warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?"),0))},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),r=0;r<t;){if(71===e[r]&&71===e[r+188]&&71===e[r+376])return r;r++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:w[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},t.resetInitSegment=function(t,r,a,i){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video",i),this._audioTrack=e.createTrack("audio",i),this._id3Track=e.createTrack("id3",i),this._txtTrack=e.createTrack("text",i),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=r,this.videoCodec=a,this._duration=i},t.resetTimeStamp=function(){},t.append=function(t,r,n,s){var o,d,u,f,h,c=t.length,v=!1;this.contiguous=n;var p=this.pmtParsed,g=this._avcTrack,m=this._audioTrack,y=this._id3Track,b=g.pid,E=m.pid,T=y.pid,S=this._pmtId,A=g.pesData,_=m.pesData,R=y.pesData,L=this._parsePAT,w=this._parsePMT,D=this._parsePES,k=this._parseAVCPES.bind(this),x=this._parseAACPES.bind(this),O=this._parseMPEGPES.bind(this),I=this._parseID3PES.bind(this),C=e._syncOffset(t);for(c-=(c+C)%188,o=C;o<c;o+=188)if(71===t[o]){if(d=!!(64&t[o+1]),u=((31&t[o+1])<<8)+t[o+2],(48&t[o+3])>>4>1){if((f=o+5+t[o+4])===o+188)continue}else f=o+4;switch(u){case b:d&&(A&&(h=D(A))&&k(h,!1),A={data:[],size:0}),A&&(A.data.push(t.subarray(f,o+188)),A.size+=o+188-f);break;case E:d&&(_&&(h=D(_))&&(m.isAAC?x(h):O(h)),_={data:[],size:0}),_&&(_.data.push(t.subarray(f,o+188)),_.size+=o+188-f);break;case T:d&&(R&&(h=D(R))&&I(h),R={data:[],size:0}),R&&(R.data.push(t.subarray(f,o+188)),R.size+=o+188-f);break;case 0:d&&(f+=t[f]+1),S=this._pmtId=L(t,f);break;case S:d&&(f+=t[f]+1);var P=w(t,f,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(b=P.avc)>0&&(g.pid=b),(E=P.audio)>0&&(m.pid=E,m.isAAC=P.isAAC),(T=P.id3)>0&&(y.pid=T),v&&!p&&(l.b.log("reparse from beginning"),v=!1,o=C-188),p=this.pmtParsed=!0;break;case 17:case 8191:break;default:v=!0}}else this.observer.trigger(a.a.ERROR,{type:i.b.MEDIA_ERROR,details:i.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});A&&(h=D(A))?(k(h,!0),g.pesData=null):g.pesData=A,_&&(h=D(_))?(m.isAAC?x(h):O(h),m.pesData=null):(_&&_.size&&l.b.log("last AAC PES packet truncated,might overlap between fragments"),m.pesData=_),R&&(h=D(R))?(I(h),y.pesData=null):y.pesData=R,null==this.sampleAes?this.remuxer.remux(m,g,y,this._txtTrack,r,n,s):this.decryptAndRemux(m,g,y,this._txtTrack,r,n,s)},t.decryptAndRemux=function(e,t,r,a,i,n,s){if(e.samples&&e.isAAC){var o=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){o.decryptAndRemuxAvc(e,t,r,a,i,n,s)})}else this.decryptAndRemuxAvc(e,t,r,a,i,n,s)},t.decryptAndRemuxAvc=function(e,t,r,a,i,n,s){if(t.samples){var o=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){o.remuxer.remux(e,t,r,a,i,n,s)})}else this.remuxer.remux(e,t,r,a,i,n,s)},t.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},t._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},t._parsePMT=function(e,t,r,a){var i,n,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(i=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<i;){switch(n=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!a){l.b.log("unknown stream type:"+e[t]);break}case 15:-1===s.audio&&(s.audio=n);break;case 21:-1===s.id3&&(s.id3=n);break;case 219:if(!a){l.b.log("unknown stream type:"+e[t]);break}case 27:-1===s.avc&&(s.avc=n);break;case 3:case 4:r?-1===s.audio&&(s.audio=n,s.isAAC=!1):l.b.log("MPEG audio found, not supported in this browser for now");break;case 36:l.b.warn("HEVC stream type found, not supported for now");break;default:l.b.log("unknown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return s},t._parsePES=function(e){var t,r,a,i,n,s,o,d,u=0,f=e.data;if(!e||0===e.size)return null;for(;f[0].length<19&&f.length>1;){var h=new Uint8Array(f[0].length+f[1].length);h.set(f[0]),h.set(f[1],f[0].length),f[0]=h,f.splice(1,1)}if(1===((t=f[0])[0]<<16)+(t[1]<<8)+t[2]){if((a=(t[4]<<8)+t[5])&&a>e.size-6)return null;if(192&(r=t[7])&&((s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)>4294967295&&(s-=8589934592),64&r?((o=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>4294967295&&(o-=8589934592),s-o>54e5&&(l.b.warn(Math.round((s-o)/9e4)+"s delta between PTS and DTS, align them"),s=o)):o=s),d=(i=t[8])+9,e.size<=d)return null;e.size-=d,n=new Uint8Array(e.size);for(var c=0,v=f.length;c<v;c++){var p=(t=f[c]).byteLength;if(d){if(d>p){d-=p;continue}t=t.subarray(d),p-=d,d=0}n.set(t,u),u+=p}return a&&(a-=i+3),{data:n,pts:s,dts:o,len:a}}return null},t.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var r=t.samples,a=r.length;if(isNaN(e.pts)){if(!a)return void t.dropped++;var i=r[a-1];e.pts=i.pts,e.dts=i.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(a||this.contiguous)?(e.id=a,r.push(e)):t.dropped++}e.debug.length&&l.b.log(e.pts+"/"+e.dts+":"+e.debug)},t._parseAVCPES=function(e,t){var r,a,i,n=this,s=this._avcTrack,o=this._parseAVCNALu(e.data),l=this.avcSample,d=!1,u=this.pushAccesUnit.bind(this),f=function(e,t,r,a){return{key:e,pts:t,dts:r,units:[],debug:a}};e.data=null,l&&o.length&&!s.audFound&&(u(l,s),l=this.avcSample=f(!1,e.pts,e.dts,"")),o.forEach(function(t){switch(t.type){case 1:a=!0,l||(l=n.avcSample=f(!0,e.pts,e.dts,"")),l.frame=!0;var o=t.data;if(d&&o.length>4){var h=new R(o).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(l.key=!0)}break;case 5:a=!0,l||(l=n.avcSample=f(!0,e.pts,e.dts,"")),l.key=!0,l.frame=!0;break;case 6:a=!0,(r=new R(n.discardEPB(t.data))).readUByte();for(var c=0,v=0,p=!1,g=0;!p&&r.bytesAvailable>1;){c=0;do{c+=g=r.readUByte()}while(255===g);v=0;do{v+=g=r.readUByte()}while(255===g);if(4===c&&0!==r.bytesAvailable){if(p=!0,181===r.readUByte()&&49===r.readUShort()&&1195456820===r.readUInt()&&3===r.readUByte()){var m=r.readUByte(),y=31&m,b=[m,r.readUByte()];for(i=0;i<y;i++)b.push(r.readUByte()),b.push(r.readUByte()),b.push(r.readUByte());n._insertSampleInOrder(n._txtTrack.samples,{type:3,pts:e.pts,bytes:b})}}else if(5===c&&0!==r.bytesAvailable){if(p=!0,v>16){var T=[];for(i=0;i<16;i++)T.push(r.readUByte().toString(16)),3!==i&&5!==i&&7!==i&&9!==i||T.push("-");var S=v-16,A=new Uint8Array(S);for(i=0;i<S;i++)A[i]=r.readUByte();n._insertSampleInOrder(n._txtTrack.samples,{pts:e.pts,payloadType:c,uuid:T.join(""),userDataBytes:A,userData:Object(E.b)(A.buffer)})}}else if(v<r.bytesAvailable)for(i=0;i<v;i++)r.readUByte()}break;case 7:if(a=!0,d=!0,!s.sps){var _=(r=new R(t.data)).readSPS();s.width=_.width,s.height=_.height,s.pixelRatio=_.pixelRatio,s.sps=[t.data],s.duration=n._duration;var L=t.data.subarray(1,4),w="avc1.";for(i=0;i<3;i++){var D=L[i].toString(16);D.length<2&&(D="0"+D),w+=D}s.codec=w}break;case 8:a=!0,s.pps||(s.pps=[t.data]);break;case 9:a=!1,s.audFound=!0,l&&u(l,s),l=n.avcSample=f(!1,e.pts,e.dts,"");break;case 12:a=!1;break;default:a=!1,l&&(l.debug+="unknown NAL "+t.type+" ")}l&&a&&l.units.push(t)}),t&&l&&(u(l,s),this.avcSample=null)},t._insertSampleInOrder=function(e,t){var r=e.length;if(r>0){if(t.pts>=e[r-1].pts)e.push(t);else for(var a=r-1;a>=0;a--)if(t.pts<e[a].pts){e.splice(a,0,t);break}}else e.push(t)},t._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var r=this._avcTrack.samples;t=r[r.length-1]}if(t){var a=t.units;e=a[a.length-1]}return e},t._parseAVCNALu=function(e){var t,r,a,i,n=0,s=e.byteLength,o=this._avcTrack,l=o.naluState||0,d=l,u=[],f=-1;for(-1===l&&(f=0,i=31&e[0],l=0,n=1);n<s;)if(t=e[n++],l)if(1!==l)if(t)if(1===t){if(f>=0)a={data:e.subarray(f,n-l-1),type:i},u.push(a);else{var h=this._getLastNalUnit();if(h&&(d&&n<=4-d&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-d)),(r=n-l-1)>0)){var c=new Uint8Array(h.data.byteLength+r);c.set(h.data,0),c.set(e.subarray(0,r),h.data.byteLength),h.data=c}}n<s?(f=n,i=31&e[n],l=0):l=-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;if(f>=0&&l>=0&&(a={data:e.subarray(f,s),type:i,state:l},u.push(a)),0===u.length){var v=this._getLastNalUnit();if(v){var p=new Uint8Array(v.data.byteLength+e.byteLength);p.set(v.data,0),p.set(e,v.data.byteLength),v.data=p}}return o.naluState=l,u},t.discardEPB=function(e){for(var t,r,a=e.byteLength,i=[],n=1;n<a-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(i.push(n+2),n+=2):n++;if(0===i.length)return e;t=a-i.length,r=new Uint8Array(t);var s=0;for(n=0;n<t;s++,n++)s===i[0]&&(s++,i.shift()),r[n]=e[s];return r},t._parseAACPES=function(e){var t,r,n,s,o,d,u,f=this._audioTrack,h=e.data,c=e.pts,v=this.aacOverFlow,g=this.aacLastPTS;if(v){var E=new Uint8Array(v.byteLength+h.byteLength);E.set(v,0),E.set(h,v.byteLength),h=E}for(n=0,o=h.length;n<o-1&&!p(h,n);n++);if(!n||(n<o-1?(d="AAC PES did not start with ADTS header,offset:"+n,u=!1):(d="no ADTS header found in AAC PES",u=!0),l.b.warn("parsing error:"+d),this.observer.trigger(a.a.ERROR,{type:i.b.MEDIA_ERROR,details:i.a.FRAG_PARSING_ERROR,fatal:u,reason:d}),!u)){if(m(f,this.observer,h,n,this.audioCodec),r=0,t=y(f.samplerate),v&&g){var T=g+t;Math.abs(T-c)>1&&(l.b.log("AAC: align PTS for overlapping frames by "+Math.round((T-c)/90)),c=T)}for(;n<o;){if(p(h,n)){if(n+5<o){var S=b(f,h,n,c,r);if(S){n+=S.length,s=S.sample.pts,r++;continue}}break}n++}v=n<o?h.subarray(n,o):null,this.aacOverFlow=v,this.aacLastPTS=s}},t._parseMPEGPES=function(e){for(var t=e.data,r=t.length,a=0,i=0,n=e.pts;i<r;)if(_.isHeader(t,i)){var s=_.appendFrame(this._audioTrack,t,i,n,a);if(!s)break;i+=s.length,a++}else i++},t._parseID3PES=function(e){this._id3Track.samples.push(e)},e}(),k=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,r,a){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:a,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){var t,r,a=E.a.getID3Data(e,0);if(a&&void 0!==E.a.getTimeStamp(a))for(t=a.length,r=Math.min(e.length-1,t+100);t<r;t++)if(_.probe(e,t))return l.b.log("MPEG Audio sync word found !"),!0;return!1},t.append=function(e,t,r,a){for(var i=E.a.getID3Data(e,0),n=E.a.getTimeStamp(i),s=n?90*n:9e4*t,o=i.length,l=e.length,d=0,u=0,f=this._audioTrack,h=[{pts:s,dts:s,data:i}];o<l;)if(_.isHeader(e,o)){var c=_.appendFrame(f,e,o,s,d);if(!c)break;o+=c.length,u=c.sample.pts,d++}else E.a.isHeader(e,o)?(i=E.a.getID3Data(e,o),h.push({pts:u,dts:u,data:i}),o+=i.length):o++;this.remuxer.remux(f,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,r,a)},t.destroy=function(){},e}(),x=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),O=Math.pow(2,32)-1,I=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),a=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:a};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=n,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,s,l,s,o),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))},e.box=function(e){for(var t,r=Array.prototype.slice.call(arguments,1),a=8,i=r.length,n=i;i--;)a+=r[i].byteLength;for((t=new Uint8Array(a))[0]=a>>24&255,t[1]=a>>16&255,t[2]=a>>8&255,t[3]=255&a,t.set(e,4),i=0,a=8;i<n;i++)t.set(r[i],a),a+=r[i].byteLength;return t},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var a=Math.floor(r/(O+1)),i=Math.floor(r%(O+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,a>>24,a>>16&255,a>>8&255,255&a,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,a){return e.box(e.types.moof,e.mfhd(t),e.traf(a,r))},e.moov=function(t){for(var r=t.length,a=[];r--;)a[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(a).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,a=[];r--;)a[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(a))},e.mvhd=function(t,r){r*=t;var a=Math.floor(r/(O+1)),i=Math.floor(r%(O+1)),n=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,a>>24,a>>16&255,a>>8&255,255&a,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,n)},e.sdtp=function(t){var r,a,i=t.samples||[],n=new Uint8Array(4+i.length);for(a=0;a<i.length;a++)r=i[a].flags,n[a+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,n)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var r,a,i,n=[],s=[];for(r=0;r<t.sps.length;r++)i=(a=t.sps[r]).byteLength,n.push(i>>>8&255),n.push(255&i),n=n.concat(Array.prototype.slice.call(a));for(r=0;r<t.pps.length;r++)i=(a=t.pps[r]).byteLength,s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(a));var o=e.box(e.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|t.sps.length].concat(n).concat([t.pps.length]).concat(s))),l=t.width,d=t.height,u=t.pixelRatio[0],f=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,d>>8&255,255&d,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,f>>24,f>>16&255,f>>8&255,255&f])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var r=t.id,a=t.duration*t.timescale,i=t.width,n=t.height,s=Math.floor(a/(O+1)),o=Math.floor(a%(O+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,n>>8&255,255&n,0,0]))},e.traf=function(t,r){var a=e.sdtp(t),i=t.id,n=Math.floor(r/(O+1)),s=Math.floor(r%(O+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,a.length+16+20+8+16+8+8),a)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var a,i,n,s,o,l,d=t.samples||[],u=d.length,f=12+16*u,h=new Uint8Array(f);for(r+=8+f,h.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),a=0;a<u;a++)n=(i=d[a]).duration,s=i.size,o=i.flags,l=i.cts,h.set([n>>>24&255,n>>>16&255,n>>>8&255,255&n,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*a);return e.box(e.types.trun,h)},e.initSegment=function(t){e.types||e.init();var r,a=e.moov(t);return(r=new Uint8Array(e.FTYP.byteLength+a.byteLength)).set(e.FTYP),r.set(a,e.FTYP.byteLength),r},e}();function C(e,t,r,a){void 0===r&&(r=1),void 0===a&&(a=!1);var i=e*t*r;return a?Math.round(i):i}function P(e,t){return void 0===t&&(t=!1),C(e,1e3,1/9e4,t)}function F(e,t){return void 0===t&&(t=1),C(e,9e4,1/t)}var M,U=F(10),B=F(.2),N=function(){function e(e,t,r,a){this.observer=e,this.config=t,this.typeSupported=r;var i=navigator.userAgent;this.isSafari=a&&a.indexOf("Apple")>-1&&i&&!i.match("CriOS"),this.ISGenerated=!1}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},t.resetInitSegment=function(){this.ISGenerated=!1},t.remux=function(e,t,r,i,n,s,o){if(this.ISGenerated||this.generateIS(e,t,n),this.ISGenerated){var d=e.samples.length,u=t.samples.length,f=n,h=n;if(d&&u){var c=(e.samples[0].pts-t.samples[0].pts)/t.inputTimeScale;f+=Math.max(0,c),h+=Math.max(0,-c)}if(d){e.timescale||(l.b.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,n));var v,p=this.remuxAudio(e,f,s,o);u&&(p&&(v=p.endPTS-p.startPTS),t.timescale||(l.b.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,n)),this.remuxVideo(t,h,s,v,o))}else if(u){var g=this.remuxVideo(t,h,s,0,o);g&&e.codec&&this.remuxEmptyAudio(e,f,s,g)}}r.samples.length&&this.remuxID3(r,n),i.samples.length&&this.remuxText(i,n),this.observer.trigger(a.a.FRAG_PARSED)},t.generateIS=function(e,t,r){var n,s,o=this.observer,d=e.samples,u=t.samples,f=this.typeSupported,h="audio/mp4",c={},v={tracks:c},p=void 0===this._initPTS;if(p&&(n=s=1/0),e.config&&d.length&&(e.timescale=e.samplerate,l.b.log("audio sampling rate : "+e.samplerate),e.isAAC||(f.mpeg?(h="audio/mpeg",e.codec=""):f.mp3&&(e.codec="mp3")),c.audio={container:h,codec:e.codec,initSegment:!e.isAAC&&f.mpeg?new Uint8Array:I.initSegment([e]),metadata:{channelCount:e.channelCount}},p&&(n=s=d[0].pts-e.inputTimeScale*r)),t.sps&&t.pps&&u.length){var g=t.inputTimeScale;t.timescale=g,c.video={container:"video/mp4",codec:t.codec,initSegment:I.initSegment([t]),metadata:{width:t.width,height:t.height}},p&&(n=Math.min(n,u[0].pts-g*r),s=Math.min(s,u[0].dts-g*r),this.observer.trigger(a.a.INIT_PTS_FOUND,{initPTS:n}))}Object.keys(c).length?(o.trigger(a.a.FRAG_PARSING_INIT_SEGMENT,v),this.ISGenerated=!0,p&&(this._initPTS=n,this._initDTS=s)):o.trigger(a.a.ERROR,{type:i.b.MEDIA_ERROR,details:i.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},t.remuxVideo=function(e,t,r,n,s){var o,d,u,f,h,c,v,p=8,g=e.timescale,m=e.samples,y=[],b=m.length,E=this._PTSNormalize,T=this._initPTS,S=this.nextAvcDts,A=this.isSafari;if(0!==b){A&&(r|=m.length&&S&&(s&&Math.abs(t-S/g)<.1||Math.abs(m[0].pts-S-T)<g/5)),r||(S=t*g),m.forEach(function(e){e.pts=E(e.pts-T,S),e.dts=E(e.dts-T,S)}),m.sort(function(e,t){var r=e.dts-t.dts,a=e.pts-t.pts;return r||a||e.id-t.id});var _=m.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-1*B)},0);if(_<0){l.b.warn("PTS < DTS detected in video samples, shifting DTS by "+P(_,!0)+" ms to overcome this issue");for(var R=0;R<m.length;R++)m[R].dts+=_}var L=m[0];h=Math.max(L.dts,0),f=Math.max(L.pts,0);var w=h-S;r&&w&&(w>1?l.b.log("AVC: "+P(w,!0)+" ms hole between fragments detected,filling it"):w<-1&&l.b.log("AVC: "+P(-w,!0)+" ms overlapping between fragments detected"),h=S,m[0].dts=h,f=Math.max(f-w,S),m[0].pts=f,l.b.log("Video: PTS/DTS adjusted: "+P(f,!0)+"/"+P(h,!0)+", delta: "+P(w,!0)+" ms")),L=m[m.length-1],v=Math.max(L.dts,0),c=Math.max(L.pts,0,v),A&&(o=Math.round((v-h)/(m.length-1)));for(var D=0,k=0,x=0;x<b;x++){for(var O=m[x],C=O.units,F=C.length,M=0,U=0;U<F;U++)M+=C[U].data.length;k+=M,D+=F,O.length=M,O.dts=A?h+x*o:Math.max(O.dts,h),O.pts=Math.max(O.pts,O.dts)}var N=k+4*D+8;try{d=new Uint8Array(N)}catch(e){return void this.observer.trigger(a.a.ERROR,{type:i.b.MUX_ERROR,details:i.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:N,reason:"fail allocating video mdat "+N})}var G=new DataView(d.buffer);G.setUint32(0,N),d.set(I.types.mdat,4);for(var j=0;j<b;j++){for(var K=m[j],H=K.units,V=0,W=void 0,Y=0,z=H.length;Y<z;Y++){var X=H[Y],q=X.data,Q=X.data.byteLength;G.setUint32(p,Q),p+=4,d.set(q,p),p+=Q,V+=4+Q}if(A)W=Math.max(0,o*Math.round((K.pts-K.dts)/o));else{if(j<b-1)o=m[j+1].dts-K.dts;else{var Z=this.config,J=K.dts-m[j>0?j-1:j].dts;if(Z.stretchShortVideoTrack){var $=Z.maxBufferHole,ee=Math.floor($*g),te=(n?f+n*g:this.nextAudioPts)-K.pts;te>ee?((o=te-J)<0&&(o=J),l.b.log("It is approximately "+P(te,!1)+" ms to the next segment; using duration "+P(o,!1)+" ms for the last video frame.")):o=J}else o=J}W=Math.round(K.pts-K.dts)}y.push({size:V,duration:o,cts:W,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:K.key?2:1,isNonSync:K.key?0:1}})}this.nextAvcDts=v+o;var re=e.dropped;if(e.nbNalu=0,e.dropped=0,y.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var ae=y[0].flags;ae.dependsOn=2,ae.isNonSync=0}e.samples=y,u=I.moof(e.sequenceNumber++,h,e),e.samples=[];var ie={data1:u,data2:d,startPTS:f/g,endPTS:(c+o)/g,startDTS:h/g,endDTS:this.nextAvcDts/g,type:"video",hasAudio:!1,hasVideo:!0,nb:y.length,dropped:re};return this.observer.trigger(a.a.FRAG_PARSING_DATA,ie),ie}},t.remuxAudio=function(e,t,r,n){var s,o,d,u,f,h,c=e.inputTimeScale,v=e.timescale,p=c/v,g=(e.isAAC?1024:1152)*p,m=this._PTSNormalize,y=this._initPTS,b=!e.isAAC&&this.typeSupported.mpeg,E=b?0:8,T=e.samples,S=[],A=this.nextAudioPts;if(r|=T.length&&A&&(n&&Math.abs(t-A/c)<.1||Math.abs(T[0].pts-A-y)<20*g),T.forEach(function(e){e.pts=e.dts=m(e.pts-y,t*c)}),0!==(T=T.filter(function(e){return e.pts>=0})).length){if(r||(A=n?t*c:T[0].pts),e.isAAC)for(var _=this.config.maxAudioFramesDrift,R=0,L=A;R<T.length;){var w,D=T[R];if((w=D.pts-L)<=-_*g)l.b.warn("Dropping 1 audio frame @ "+P(L,!0)+" ms due to "+P(w,!0)+" ms overlap."),T.splice(R,1);else if(w>=_*g&&w<U&&L){var k=Math.round(w/g);l.b.warn("Injecting "+k+" audio frames @ "+P(L,!0)+" ms due to "+P(L,!0)+" ms gap.");for(var O=0;O<k;O++){var C=Math.max(L,0);(o=x.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(l.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),o=D.unit.subarray()),T.splice(R,0,{unit:o,pts:C,dts:C}),L+=g,R++}D.pts=D.dts=L,L+=g,R++}else Math.abs(w),D.pts=D.dts=L,L+=g,R++}for(var F=T.length,M=0;F--;)M+=T[F].unit.byteLength;for(var B=0,N=T.length;B<N;B++){var G=T[B],j=G.unit,K=G.pts;if(void 0!==h)s.duration=Math.round((K-h)/p);else{var H=K-A,V=0;if(r&&e.isAAC&&H){if(H>0&&H<U)V=Math.round((K-A)/g),l.b.log(P(H,!0)+" ms hole between AAC samples detected,filling it"),V>0&&((o=x.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o=j.subarray()),M+=V*o.length);else if(H<-12){l.b.log("drop overlapping AAC sample, expected/parsed/delta: "+P(A,!0)+" ms / "+P(K,!0)+" ms / "+P(-H,!0)+" ms"),M-=j.byteLength;continue}K=A}if(f=K,!(M>0))return;M+=E;try{d=new Uint8Array(M)}catch(e){return void this.observer.trigger(a.a.ERROR,{type:i.b.MUX_ERROR,details:i.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:M,reason:"fail allocating audio mdat "+M})}b||(new DataView(d.buffer).setUint32(0,M),d.set(I.types.mdat,4));for(var W=0;W<V;W++)(o=x.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(l.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),o=j.subarray()),d.set(o,E),E+=o.byteLength,s={size:o.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},S.push(s)}d.set(j,E);var Y=j.byteLength;E+=Y,s={size:Y,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},S.push(s),h=K}var z=0;if((F=S.length)>=2&&(z=S[F-2].duration,s.duration=z),F){this.nextAudioPts=A=h+p*z,e.samples=S,u=b?new Uint8Array:I.moof(e.sequenceNumber++,f/p,e),e.samples=[];var X=f/c,q=A/c,Q={data1:u,data2:d,startPTS:X,endPTS:q,startDTS:X,endDTS:q,type:"audio",hasAudio:!0,hasVideo:!1,nb:F};return this.observer.trigger(a.a.FRAG_PARSING_DATA,Q),Q}return null}},t.remuxEmptyAudio=function(e,t,r,a){var i=e.inputTimeScale,n=i/(e.samplerate?e.samplerate:i),s=this.nextAudioPts,o=(void 0!==s?s:a.startDTS*i)+this._initDTS,d=a.endDTS*i+this._initDTS,u=1024*n,f=Math.ceil((d-o)/u),h=x.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(l.b.warn("remux empty Audio"),h){for(var c=[],v=0;v<f;v++){var p=o+v*u;c.push({unit:h,pts:p,dts:p})}e.samples=c,this.remuxAudio(e,t,r)}else l.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},t.remuxID3=function(e){var t,r=e.samples.length,i=e.inputTimeScale,n=this._initPTS,s=this._initDTS;if(r){for(var o=0;o<r;o++)(t=e.samples[o]).pts=(t.pts-n)/i,t.dts=(t.dts-s)/i;this.observer.trigger(a.a.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[]},t.remuxText=function(e){e.samples.sort(function(e,t){return e.pts-t.pts});var t,r=e.samples.length,i=e.inputTimeScale,n=this._initPTS;if(r){for(var s=0;s<r;s++)(t=e.samples[s]).pts=(t.pts-n)/i;this.observer.trigger(a.a.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},t._PTSNormalize=function(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e},e}(),G=function(){function e(e){this.observer=e}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(){},t.resetInitSegment=function(){},t.remux=function(e,t,r,i,n,s,o,l){var d=this.observer,u="";e&&(u+="audio"),t&&(u+="video"),d.trigger(a.a.FRAG_PARSING_DATA,{data1:l,startPTS:n,startDTS:n,type:u,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),d.trigger(a.a.FRAG_PARSED)},e}(),j=Object(d.a)();try{M=j.performance.now.bind(j.performance)}catch(e){l.b.debug("Unable to use Performance API on this environment"),M=j.Date.now}var K=function(){function e(e,t,r,a){this.observer=e,this.typeSupported=t,this.config=r,this.vendor=a}var t=e.prototype;return t.destroy=function(){var e=this.demuxer;e&&e.destroy()},t.push=function(e,t,r,i,n,s,o,l,d,f,h,c){var v=this;if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var p=this.decrypter;null==p&&(p=this.decrypter=new u(this.observer,this.config));var g=M();p.decrypt(e,t.key.buffer,t.iv.buffer,function(e){var u=M();v.observer.trigger(a.a.FRAG_DECRYPTED,{stats:{tstart:g,tdecrypt:u}}),v.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),i,n,s,o,l,d,f,h,c)})}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),i,n,s,o,l,d,f,h,c)},t.pushDecrypted=function(e,t,r,n,s,o,l,d,u,f,h,c){var v=this.demuxer;if(!v||(l||d)&&!this.probe(e)){for(var p=this.observer,g=this.typeSupported,m=this.config,y=[{demux:D,remux:N},{demux:S.a,remux:G},{demux:T,remux:N},{demux:k,remux:N}],b=0,E=y.length;b<E;b++){var A=y[b],_=A.demux.probe;if(_(e)){var R=this.remuxer=new A.remux(p,m,g,this.vendor);v=new A.demux(p,R,m,g),this.probe=_;break}}if(!v)return void p.trigger(a.a.ERROR,{type:i.b.MEDIA_ERROR,details:i.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=v}var L=this.remuxer;(l||d)&&(v.resetInitSegment(r,n,s,f),L.resetInitSegment()),l&&(v.resetTimeStamp(c),L.resetTimeStamp(c)),"function"==typeof v.setDecryptData&&v.setDecryptData(t),v.append(e,o,u,h)},e}();t.a=K},function(e,t,r){"use strict";var a=r(0),i=r(1),n=Math.pow(2,32)-1,s=function(){function e(e,t){this.observer=e,this.remuxer=t}var t=e.prototype;return t.resetTimeStamp=function(e){this.initPTS=e},t.resetInitSegment=function(t,r,a,n){if(t&&t.byteLength){var s=this.initData=e.parseInitSegment(t);null==r&&(r="mp4a.40.5"),null==a&&(a="avc1.42e01e");var o={};s.audio&&s.video?o.audiovideo={container:"video/mp4",codec:r+","+a,initSegment:n?t:null}:(s.audio&&(o.audio={container:"audio/mp4",codec:r,initSegment:n?t:null}),s.video&&(o.video={container:"video/mp4",codec:a,initSegment:n?t:null})),this.observer.trigger(i.a.FRAG_PARSING_INIT_SEGMENT,{tracks:o})}else r&&(this.audioCodec=r),a&&(this.videoCodec=a)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<8|e[t+1];return r<0?65536+r:r},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r},e.writeUint32=function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},e.findBox=function(t,r){var a,i,n,s,o,l,d=[];if(t.data?(o=t.start,n=t.end,t=t.data):(o=0,n=t.byteLength),!r.length)return null;for(a=o;a<n;)l=(i=e.readUint32(t,a))>1?a+i:n,e.bin2str(t.subarray(a+4,a+8))===r[0]&&(1===r.length?d.push({data:t,start:a+8,end:l}):(s=e.findBox({data:t,start:a+8,end:l},r.slice(1))).length&&(d=d.concat(s))),a=l;return d},e.parseSegmentIndex=function(t){var r,a=e.findBox(t,["moov"])[0],i=a?a.end:null,n=0,s=e.findBox(t,["sidx"]);if(!s||!s[0])return null;r=[];var o=(s=s[0]).data[0];n=0===o?8:16;var l=e.readUint32(s,n);n+=4,n+=0===o?8:16,n+=2;var d=s.end+0,u=e.readUint16(s,n);n+=2;for(var f=0;f<u;f++){var h=n,c=e.readUint32(s,h);h+=4;var v=2147483647&c;if(1==(2147483648&c)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var p=e.readUint32(s,h);h+=4,r.push({referenceSize:v,subsegmentDuration:p,info:{duration:p/l,start:d,end:d+v-1}}),d+=v,n=h+=4}return{earliestPresentationTime:0,timescale:l,version:o,referencesCount:u,references:r,moovEndOffset:i}},e.parseInitSegment=function(t){var r=[];return e.findBox(t,["moov","trak"]).forEach(function(t){var i=e.findBox(t,["tkhd"])[0];if(i){var n=i.data[i.start],s=0===n?12:20,o=e.readUint32(i,s),l=e.findBox(t,["mdia","mdhd"])[0];if(l){s=0===(n=l.data[l.start])?12:20;var d=e.readUint32(l,s),u=e.findBox(t,["mdia","hdlr"])[0];if(u){var f={soun:"audio",vide:"video"}[e.bin2str(u.data.subarray(u.start+8,u.start+12))];if(f){var h=e.findBox(t,["mdia","minf","stbl","stsd"]);if(h.length){h=h[0];var c=e.bin2str(h.data.subarray(h.start+12,h.start+16));a.b.log("MP4Demuxer:"+f+":"+c+" found")}r[o]={timescale:d,type:f},r[f]={timescale:d,id:o}}}}}}),r},e.getStartDTS=function(t,r){var a,i,n;return a=e.findBox(r,["moof","traf"]),i=[].concat.apply([],a.map(function(r){return e.findBox(r,["tfhd"]).map(function(a){var i,n;return i=e.readUint32(a,4),n=t[i].timescale||9e4,e.findBox(r,["tfdt"]).map(function(t){var r,a;return r=t.data[t.start],a=e.readUint32(t,4),1===r&&(a*=Math.pow(2,32),a+=e.readUint32(t,8)),a})[0]/n})})),n=Math.min.apply(null,i),isFinite(n)?n:0},e.offsetStartDTS=function(t,r,a){e.findBox(r,["moof","traf"]).map(function(r){return e.findBox(r,["tfhd"]).map(function(i){var s=e.readUint32(i,4),o=t[s].timescale||9e4;e.findBox(r,["tfdt"]).map(function(t){var r=t.data[t.start],i=e.readUint32(t,4);if(0===r)e.writeUint32(t,4,i-a*o);else{i*=Math.pow(2,32),i+=e.readUint32(t,8),i-=a*o,i=Math.max(i,0);var s=Math.floor(i/(n+1)),l=Math.floor(i%(n+1));e.writeUint32(t,4,s),e.writeUint32(t,8,l)}})})})},t.append=function(t,r,a,n){var s=this.initData;s||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),s=this.initData);var o,l=this.initPTS;if(void 0===l){var d=e.getStartDTS(s,t);this.initPTS=l=d-r,this.observer.trigger(i.a.INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(s,t,l),o=e.getStartDTS(s,t),this.remuxer.remux(s.audio,s.video,null,null,o,a,n,t)},t.destroy=function(){},e}();t.a=s},function(e,t,r){function a(e){var t={};function r(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var a=r(r.s=ENTRY_MODULE);return a.default||a}var i="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function n(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function s(e,t,a){var s={};s[a]=[];var o=t.toString(),l=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!l)return s;for(var d,u=l[1],f=new RegExp("(\\\\n|\\W)"+n(u)+i,"g");d=f.exec(o);)"dll-reference"!==d[3]&&s[a].push(d[3]);for(f=new RegExp("\\("+n(u)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)'+i,"g");d=f.exec(o);)e[d[2]]||(s[a].push(d[1]),e[d[2]]=r(d[1]).m),s[d[2]]=s[d[2]]||[],s[d[2]].push(d[4]);for(var h,c=Object.keys(s),v=0;v<c.length;v++)for(var p=0;p<s[c[v]].length;p++)h=s[c[v]][p],isNaN(1*h)||(s[c[v]][p]=1*s[c[v]][p]);return s}function o(e){return Object.keys(e).reduce(function(t,r){return t||e[r].length>0},!1)}e.exports=function(e,t){t=t||{};var i={main:r.m},n=t.all?{main:Object.keys(i.main)}:function(e,t){for(var r={main:[t]},a={main:[]},i={main:{}};o(r);)for(var n=Object.keys(r),l=0;l<n.length;l++){var d=n[l],u=r[d].pop();if(i[d]=i[d]||{},!i[d][u]&&e[d][u]){i[d][u]=!0,a[d]=a[d]||[],a[d].push(u);for(var f=s(e,e[d][u],d),h=Object.keys(f),c=0;c<h.length;c++)r[h[c]]=r[h[c]]||[],r[h[c]]=r[h[c]].concat(f[h[c]])}}return a}(i,e),l="";Object.keys(n).filter(function(e){return"main"!==e}).forEach(function(e){for(var t=0;n[e][t];)t++;n[e].push(t),i[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",l=l+"var "+e+" = ("+a.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+n[e].map(function(t){return JSON.stringify(t)+": "+i[e][t].toString()}).join(",")+"});\n"}),l=l+"new (("+a.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+n.main.map(function(e){return JSON.stringify(e)+": "+i.main[e].toString()}).join(",")+"}))(self);";var d=new window.Blob([l],{type:"text/javascript"});if(t.bare)return d;var u=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(d),f=new window.Worker(u);return f.objectURL=u,f}},function(e,t,r){"use strict";r.r(t);var a=r(9),i=r(1),n=r(0),s=r(8);t.default=function(e){var t=new s.EventEmitter;t.trigger=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];t.emit.apply(t,[e,e].concat(a))},t.off=function(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];t.removeListener.apply(t,[e].concat(a))};var r=function(t,r){e.postMessage({event:t,data:r})};e.addEventListener("message",function(i){var s=i.data;switch(s.cmd){case"init":var o=JSON.parse(s.config);e.demuxer=new a.a(t,s.typeSupported,o,s.vendor),Object(n.a)(o.debug),r("init",null);break;case"demux":e.demuxer.push(s.data,s.decryptdata,s.initSegment,s.audioCodec,s.videoCodec,s.timeOffset,s.discontinuity,s.trackSwitch,s.contiguous,s.duration,s.accurateTimeOffset,s.defaultInitPTS)}}),t.on(i.a.FRAG_DECRYPTED,r),t.on(i.a.FRAG_PARSING_INIT_SEGMENT,r),t.on(i.a.FRAG_PARSED,r),t.on(i.a.ERROR,r),t.on(i.a.FRAG_PARSING_METADATA,r),t.on(i.a.FRAG_PARSING_USERDATA,r),t.on(i.a.INIT_PTS_FOUND,r),t.on(i.a.FRAG_PARSING_DATA,function(t,r){var a=[],i={event:t,data:r};r.data1&&(i.data1=r.data1.buffer,a.push(r.data1.buffer),delete r.data1),r.data2&&(i.data2=r.data2.buffer,a.push(r.data2.buffer),delete r.data2),e.postMessage(i,a)})}},function(e,t,r){"use strict";r.r(t);var a,i,n=r(7),s=r(2),o=r(3),l=r(1),d=r(0),u={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},f=function(){function e(e){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=e,this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){},t.onHandlerDestroyed=function(){},t.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},t.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if(u[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)},this)},t.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)},t.onEvent=function(e,t){this.onEventGeneric(e,t)},t.onEventGeneric=function(e,t){try{(function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)}).call(this,e,t).call()}catch(t){d.b.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.hls.trigger(l.a.ERROR,{type:s.b.OTHER_ERROR,details:s.a.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},e}();!function(e){e.MANIFEST="manifest",e.LEVEL="level",e.AUDIO_TRACK="audioTrack",e.SUBTITLE_TRACK="subtitleTrack"}(a||(a={})),function(e){e.MAIN="main",e.AUDIO="audio",e.SUBTITLE="subtitle"}(i||(i={}));var h=r(10);function c(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var v,p=function(){function e(e,t){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=e,this.reluri=t}var t,r;return t=e,(r=[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(n.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&c(t.prototype,r),e}();function g(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}!function(e){e.AUDIO="audio",e.VIDEO="video"}(v||(v={}));var m=function(){function e(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((e={})[v.AUDIO]=!1,e[v.VIDEO]=!1,e),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var t,r,i=e.prototype;return i.setByteRange=function(e,t){var r=e.split("@",2),a=[];1===r.length?a[0]=t?t.byteRangeEndOffset:0:a[0]=parseInt(r[1]),a[1]=parseInt(r[0])+a[0],this._byteRange=a},i.addElementaryStream=function(e){this._elementaryStreams[e]=!0},i.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},i.createInitializationVector=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t},i.setDecryptDataFromLevelKey=function(e,t){var r=e;return e&&e.method&&e.uri&&!e.iv&&((r=new p(e.baseuri,e.reluri)).method=e.method,r.iv=this.createInitializationVector(t)),r},t=e,(r=[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(n.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&d.b.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(o.a)(this.programDateTime))return null;var e=Object(o.a)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&g(t.prototype,r),e}();function y(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var b=function(){function e(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}var t,r;return t=e,(r=[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(o.a)(this.fragments[0].programDateTime))}}])&&y(t.prototype,r),e}(),E=/^(\d+)x(\d+)$/,T=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,S=function(){function e(t){for(var r in"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(r)&&(this[r]=t[r])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),a=0;a<t.length/2;a++)r[a]=parseInt(t.slice(2*a,2*a+2),16);return r}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.enumeratedString=function(e){return this[e]},t.decimalResolution=function(e){var t=E.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,r={};for(T.lastIndex=0;null!==(t=T.exec(e));){var a=t[2];0===a.indexOf('"')&&a.lastIndexOf('"')===a.length-1&&(a=a.slice(1,-1)),r[t[1]]=a}return r},e}(),A={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function _(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var R=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,L=/#EXT-X-MEDIA:(.*)/g,w=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),D=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,k=/\.(mp4|m4s|m4v|m4a)$/i,x=function(){function e(){}return e.findGroup=function(e,t){for(var r=0;r<e.length;r++){var a=e[r];if(a.id===t)return a}},e.convertAVC1ToAVCOTI=function(e){var t,r=e.split(".");return r.length>2?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t},e.resolve=function(e,t){return n.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,r){var a,i=[];function n(e,t){["video","audio"].forEach(function(r){var a=e.filter(function(e){return function(e,t){var r=A[t];return!!r&&!0===r[e.slice(0,4)]}(e,r)});if(a.length){var i=a.filter(function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)});t[r+"Codec"]=i.length>0?i[0]:a[0],e=e.filter(function(e){return-1===a.indexOf(e)})}}),t.unknownCodecs=e}for(R.lastIndex=0;null!=(a=R.exec(t));){var s={},o=s.attrs=new S(a[1]);s.url=e.resolve(a[2],r);var l=o.decimalResolution("RESOLUTION");l&&(s.width=l.width,s.height=l.height),s.bitrate=o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH"),s.name=o.NAME,n([].concat((o.CODECS||"").split(/[ ,]+/)),s),s.videoCodec&&-1!==s.videoCodec.indexOf("avc1")&&(s.videoCodec=e.convertAVC1ToAVCOTI(s.videoCodec)),i.push(s)}return i},e.parseMasterPlaylistMedia=function(t,r,a,i){var n;void 0===i&&(i=[]);var s=[],o=0;for(L.lastIndex=0;null!==(n=L.exec(t));){var l=new S(n[1]);if(l.TYPE===a){var d={id:o++,groupId:l["GROUP-ID"],name:l.NAME||l.LANGUAGE,type:a,default:"YES"===l.DEFAULT,autoselect:"YES"===l.AUTOSELECT,forced:"YES"===l.FORCED,lang:l.LANGUAGE};if(l.URI&&(d.url=e.resolve(l.URI,r)),i.length){var u=e.findGroup(i,d.groupId);d.audioCodec=u?u.codec:i[0].codec}s.push(d)}}return s},e.parseLevelPlaylist=function(e,t,r,a,i){var n,s,l,u=0,f=0,h=new b(t),c=0,v=null,g=new m,y=null;for(w.lastIndex=0;null!==(n=w.exec(e));){var E=n[1];if(E){g.duration=parseFloat(E);var T=(" "+n[2]).slice(1);g.title=T||null,g.tagList.push(T?["INF",E,T]:["INF",E])}else if(n[3]){if(Object(o.a)(g.duration)){var A=u++;g.type=a,g.start=f,l&&(g.levelkey=l),g.sn=A,g.level=r,g.cc=c,g.urlId=i,g.baseurl=t,g.relurl=(" "+n[3]).slice(1),O(g,v),h.fragments.push(g),v=g,f+=g.duration,g=new m}}else if(n[4]){var _=(" "+n[4]).slice(1);v?g.setByteRange(_,v):g.setByteRange(_)}else if(n[5])g.rawProgramDateTime=(" "+n[5]).slice(1),g.tagList.push(["PROGRAM-DATE-TIME",g.rawProgramDateTime]),null===y&&(y=h.fragments.length);else{if(!(n=n[0].match(D))){d.b.warn("No matches on slow regex match for level playlist!");continue}for(s=1;s<n.length&&void 0===n[s];s++);var R=(" "+n[s+1]).slice(1),L=(" "+n[s+2]).slice(1);switch(n[s]){case"#":g.tagList.push(L?[R,L]:[R]);break;case"PLAYLIST-TYPE":h.type=R.toUpperCase();break;case"MEDIA-SEQUENCE":u=h.startSN=parseInt(R);break;case"TARGETDURATION":h.targetduration=parseFloat(R);break;case"VERSION":h.version=parseInt(R);break;case"EXTM3U":break;case"ENDLIST":h.live=!1;break;case"DIS":c++,g.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":c=parseInt(R);break;case"KEY":var x=new S(R),I=x.enumeratedString("METHOD"),C=x.URI,P=x.hexadecimalInteger("IV");I&&(l=new p(t,C),C&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(I)>=0&&(l.method=I,l.key=null,l.iv=P));break;case"START":var F=new S(R).decimalFloatingPoint("TIME-OFFSET");Object(o.a)(F)&&(h.startTimeOffset=F);break;case"MAP":var M=new S(R);g.relurl=M.URI,M.BYTERANGE&&g.setByteRange(M.BYTERANGE),g.baseurl=t,g.level=r,g.type=a,g.sn="initSegment",h.initSegment=g,(g=new m).rawProgramDateTime=h.initSegment.rawProgramDateTime;break;default:d.b.warn("line parsed but not handled: "+n)}}}return(g=v)&&!g.relurl&&(h.fragments.pop(),f-=g.duration),h.totalduration=f,h.averagetargetduration=f/h.fragments.length,h.endSN=u-1,h.startCC=h.fragments[0]?h.fragments[0].cc:0,h.endCC=c,!h.initSegment&&h.fragments.length&&h.fragments.every(function(e){return k.test(e.relurl)})&&(d.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(g=new m).relurl=h.fragments[0].relurl,g.baseurl=t,g.level=r,g.type=a,g.sn="initSegment",h.initSegment=g,h.needSidxRanges=!0),y&&function(e,t){for(var r=e[t],a=t-1;a>=0;a--){var i=e[a];i.programDateTime=r.programDateTime-1e3*i.duration,r=i}}(h.fragments,y),h},e}();function O(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),Object(o.a)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}var I=window.performance,C=function(e){var t,r;function n(t){var r;return(r=e.call(this,t,l.a.MANIFEST_LOADING,l.a.LEVEL_LOADING,l.a.AUDIO_TRACK_LOADING,l.a.SUBTITLE_TRACK_LOADING)||this).loaders={},r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,n.canHaveQualityLevels=function(e){return e!==a.AUDIO_TRACK&&e!==a.SUBTITLE_TRACK},n.mapContextToLevelType=function(e){switch(e.type){case a.AUDIO_TRACK:return i.AUDIO;case a.SUBTITLE_TRACK:return i.SUBTITLE;default:return i.MAIN}},n.getResponseUrl=function(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r};var u=n.prototype;return u.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,a=t.loader,i=new(r||a)(t);return e.loader=i,this.loaders[e.type]=i,i},u.getInternalLoader=function(e){return this.loaders[e.type]},u.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},u.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},u.destroy=function(){this.destroyInternalLoaders(),e.prototype.destroy.call(this)},u.onManifestLoading=function(e){this.load({url:e.url,type:a.MANIFEST,level:0,id:null,responseType:"text"})},u.onLevelLoading=function(e){this.load({url:e.url,type:a.LEVEL,level:e.level,id:e.id,responseType:"text"})},u.onAudioTrackLoading=function(e){this.load({url:e.url,type:a.AUDIO_TRACK,level:null,id:e.id,responseType:"text"})},u.onSubtitleTrackLoading=function(e){this.load({url:e.url,type:a.SUBTITLE_TRACK,level:null,id:e.id,responseType:"text"})},u.load=function(e){var t=this.hls.config;d.b.debug("Loading playlist of type "+e.type+", level: "+e.level+", id: "+e.id);var r,i,n,s,o=this.getInternalLoader(e);if(o){var l=o.context;if(l&&l.url===e.url)return d.b.trace("playlist request ongoing"),!1;d.b.warn("aborting previous loader for type: "+e.type),o.abort()}switch(e.type){case a.MANIFEST:r=t.manifestLoadingMaxRetry,i=t.manifestLoadingTimeOut,n=t.manifestLoadingRetryDelay,s=t.manifestLoadingMaxRetryTimeout;break;case a.LEVEL:r=0,s=0,n=0,i=t.levelLoadingTimeOut;break;default:r=t.levelLoadingMaxRetry,i=t.levelLoadingTimeOut,n=t.levelLoadingRetryDelay,s=t.levelLoadingMaxRetryTimeout}o=this.createInternalLoader(e);var u={timeout:i,maxRetry:r,retryDelay:n,maxRetryDelay:s},f={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return d.b.debug("Calling internal loader delegate for URL: "+e.url),o.load(e,u,f),!0},u.loadsuccess=function(e,t,r,a){if(void 0===a&&(a=null),r.isSidxRequest)return this._handleSidxRequest(e,r),void this._handlePlaylistLoaded(e,t,r,a);if(this.resetInternalLoader(r.type),"string"!=typeof e.data)throw new Error('expected responseType of "text" for PlaylistLoader');var i=e.data;t.tload=I.now(),0===i.indexOf("#EXTM3U")?i.indexOf("#EXTINF:")>0||i.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,r,a):this._handleMasterPlaylist(e,t,r,a):this._handleManifestParsingError(e,r,"no EXTM3U delimiter",a)},u.loaderror=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!1,e)},u.loadtimeout=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!0)},u._handleMasterPlaylist=function(e,t,r,a){var i=this.hls,s=e.data,o=n.getResponseUrl(e,r),u=x.parseMasterPlaylist(s,o);if(u.length){var f=u.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}),h=x.parseMasterPlaylistMedia(s,o,"AUDIO",f),c=x.parseMasterPlaylistMedia(s,o,"SUBTITLES");if(h.length){var v=!1;h.forEach(function(e){e.url||(v=!0)}),!1===v&&u[0].audioCodec&&!u[0].attrs.AUDIO&&(d.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1}))}i.trigger(l.a.MANIFEST_LOADED,{levels:u,audioTracks:h,subtitles:c,url:o,stats:t,networkDetails:a})}else this._handleManifestParsingError(e,r,"no level found in manifest",a)},u._handleTrackOrLevelPlaylist=function(e,t,r,i){var s=this.hls,d=r.id,u=r.level,f=r.type,h=n.getResponseUrl(e,r),c=Object(o.a)(d)?d:0,v=Object(o.a)(u)?u:c,p=n.mapContextToLevelType(r),g=x.parseLevelPlaylist(e.data,h,v,p,c);if(g.tload=t.tload,f===a.MANIFEST){var m={url:h,details:g};s.trigger(l.a.MANIFEST_LOADED,{levels:[m],audioTracks:[],url:h,stats:t,networkDetails:i})}if(t.tparsed=I.now(),g.needSidxRanges){var y=g.initSegment.url;this.load({url:y,isSidxRequest:!0,type:f,level:u,levelDetails:g,id:d,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else r.levelDetails=g,this._handlePlaylistLoaded(e,t,r,i)},u._handleSidxRequest=function(e,t){if("string"==typeof e.data)throw new Error("sidx request must be made with responseType of array buffer");var r=h.a.parseSegmentIndex(new Uint8Array(e.data));if(r){var a=r.references,i=t.levelDetails;a.forEach(function(e,t){var r=e.info;if(i){var a=i.fragments[t];0===a.byteRange.length&&a.setByteRange(String(1+r.end-r.start)+"@"+String(r.start))}}),i&&i.initSegment.setByteRange(String(r.moovEndOffset)+"@0")}},u._handleManifestParsingError=function(e,t,r,a){this.hls.trigger(l.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:r,networkDetails:a})},u._handleNetworkError=function(e,t,r,i){var n,o;void 0===r&&(r=!1),void 0===i&&(i=null),d.b.info("A network error occured while loading a "+e.type+"-type playlist");var u=this.getInternalLoader(e);switch(e.type){case a.MANIFEST:n=r?s.a.MANIFEST_LOAD_TIMEOUT:s.a.MANIFEST_LOAD_ERROR,o=!0;break;case a.LEVEL:n=r?s.a.LEVEL_LOAD_TIMEOUT:s.a.LEVEL_LOAD_ERROR,o=!1;break;case a.AUDIO_TRACK:n=r?s.a.AUDIO_TRACK_LOAD_TIMEOUT:s.a.AUDIO_TRACK_LOAD_ERROR,o=!1;break;default:o=!1}u&&(u.abort(),this.resetInternalLoader(e.type));var f={type:s.b.NETWORK_ERROR,details:n,fatal:o,url:e.url,loader:u,context:e,networkDetails:t};i&&(f.response=i),this.hls.trigger(l.a.ERROR,f)},u._handlePlaylistLoaded=function(e,t,r,i){var s=r.type,o=r.level,d=r.id,u=r.levelDetails;if(u&&u.targetduration)if(n.canHaveQualityLevels(r.type))this.hls.trigger(l.a.LEVEL_LOADED,{details:u,level:o||0,id:d||0,stats:t,networkDetails:i});else switch(s){case a.AUDIO_TRACK:this.hls.trigger(l.a.AUDIO_TRACK_LOADED,{details:u,id:d,stats:t,networkDetails:i});break;case a.SUBTITLE_TRACK:this.hls.trigger(l.a.SUBTITLE_TRACK_LOADED,{details:u,id:d,stats:t,networkDetails:i})}else this._handleManifestParsingError(e,r,"invalid target duration",i)},n}(f),P=function(e){var t,r;function a(t){var r;return(r=e.call(this,t,l.a.FRAG_LOADING)||this).loaders={},r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=a.prototype;return i.destroy=function(){var t=this.loaders;for(var r in t){var a=t[r];a&&a.destroy()}this.loaders={},e.prototype.destroy.call(this)},i.onFragLoading=function(e){var t=e.frag,r=t.type,a=this.loaders,i=this.hls.config,n=i.fLoader,s=i.loader;t.loaded=0;var l,u,f,h=a[r];h&&(d.b.warn("abort previous fragment loader for type: "+r),h.abort()),h=a[r]=t.loader=i.fLoader?new n(i):new s(i),l={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var c=t.byteRangeStartOffset,v=t.byteRangeEndOffset;Object(o.a)(c)&&Object(o.a)(v)&&(l.rangeStart=c,l.rangeEnd=v),u={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},f={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},h.load(l,u,f)},i.loadsuccess=function(e,t,r,a){void 0===a&&(a=null);var i=e.data,n=r.frag;n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(l.a.FRAG_LOADED,{payload:i,frag:n,stats:t,networkDetails:a})},i.loaderror=function(e,t,r){void 0===r&&(r=null);var a=t.frag,i=a.loader;i&&i.abort(),this.loaders[a.type]=void 0,this.hls.trigger(l.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})},i.loadtimeout=function(e,t,r){void 0===r&&(r=null);var a=t.frag,i=a.loader;i&&i.abort(),this.loaders[a.type]=void 0,this.hls.trigger(l.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})},i.loadprogress=function(e,t,r,a){void 0===a&&(a=null);var i=t.frag;i.loaded=e.loaded,this.hls.trigger(l.a.FRAG_LOAD_PROGRESS,{frag:i,stats:e,networkDetails:a})},a}(f),F=function(e){var t,r;function a(t){var r;return(r=e.call(this,t,l.a.KEY_LOADING)||this).loaders={},r.decryptkey=null,r.decrypturl=null,r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=a.prototype;return i.destroy=function(){for(var t in this.loaders){var r=this.loaders[t];r&&r.destroy()}this.loaders={},e.prototype.destroy.call(this)},i.onKeyLoading=function(e){var t=e.frag,r=t.type,a=this.loaders[r];if(t.decryptdata){var i=t.decryptdata.uri;if(i!==this.decrypturl||null===this.decryptkey){var n=this.hls.config;if(a&&(d.b.warn("abort previous key loader for type:"+r),a.abort()),!i)return void d.b.warn("key uri is falsy");t.loader=this.loaders[r]=new n.loader(n),this.decrypturl=i,this.decryptkey=null;var s={url:i,frag:t,responseType:"arraybuffer"},o={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:n.fragLoadingRetryDelay,maxRetryDelay:n.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};t.loader.load(s,o,u)}else this.decryptkey&&(t.decryptdata.key=this.decryptkey,this.hls.trigger(l.a.KEY_LOADED,{frag:t}))}else d.b.warn("Missing decryption data on fragment in onKeyLoading")},i.loadsuccess=function(e,t,r){var a=r.frag;a.decryptdata?(this.decryptkey=a.decryptdata.key=new Uint8Array(e.data),a.loader=void 0,delete this.loaders[a.type],this.hls.trigger(l.a.KEY_LOADED,{frag:a})):d.b.error("after key load, decryptdata unset")},i.loaderror=function(e,t){var r=t.frag,a=r.loader;a&&a.abort(),delete this.loaders[r.type],this.hls.trigger(l.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})},i.loadtimeout=function(e,t){var r=t.frag,a=r.loader;a&&a.abort(),delete this.loaders[r.type],this.hls.trigger(l.a.ERROR,{type:s.b.NETWORK_ERROR,details:s.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},a}(f),M="NOT_LOADED",U="APPENDING",B="PARTIAL",G=function(e){var t,r;function a(t){var r;return(r=e.call(this,t,l.a.BUFFER_APPENDED,l.a.FRAG_BUFFERED,l.a.FRAG_LOADED)||this).bufferPadding=.2,r.fragments=Object.create(null),r.timeRanges=Object.create(null),r.config=t.config,r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=a.prototype;return i.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,f.prototype.destroy.call(this),e.prototype.destroy.call(this)},i.getBufferedFrag=function(e,t){var r=this.fragments,a=Object.keys(r).filter(function(a){var i=r[a];if(i.body.type!==t)return!1;if(!i.buffered)return!1;var n=i.body;return n.startPTS<=e&&e<=n.endPTS});if(0===a.length)return null;var i=a.pop();return r[i].body},i.detectEvictedFragments=function(e,t){var r,a,i=this;Object.keys(this.fragments).forEach(function(n){var s=i.fragments[n];if(!0===s.buffered){var o=s.range[e];if(o){r=o.time;for(var l=0;l<r.length;l++)if(a=r[l],!1===i.isTimeBuffered(a.startPTS,a.endPTS,t)){i.removeFragment(s.body);break}}}})},i.detectPartialFragments=function(e){var t=this,r=this.getFragmentKey(e),a=this.fragments[r];a&&(a.buffered=!0,Object.keys(this.timeRanges).forEach(function(r){if(e.hasElementaryStream(r)){var i=t.timeRanges[r];a.range[r]=t.getBufferedTimes(e.startPTS,e.endPTS,i)}}))},i.getBufferedTimes=function(e,t,r){for(var a,i,n=[],s=!1,o=0;o<r.length;o++){if(a=r.start(o)-this.bufferPadding,i=r.end(o)+this.bufferPadding,e>=a&&t<=i){n.push({startPTS:Math.max(e,r.start(o)),endPTS:Math.min(t,r.end(o))});break}if(e<i&&t>a)n.push({startPTS:Math.max(e,r.start(o)),endPTS:Math.min(t,r.end(o))}),s=!0;else if(t<=a)break}return{time:n,partial:s}},i.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},i.getPartialFragment=function(e){var t,r,a,i=this,n=null,s=0;return Object.keys(this.fragments).forEach(function(o){var l=i.fragments[o];i.isPartial(l)&&(r=l.body.startPTS-i.bufferPadding,a=l.body.endPTS+i.bufferPadding,e>=r&&e<=a&&(t=Math.min(e-r,a-e),s<=t&&(n=l.body,s=t)))}),n},i.getState=function(e){var t=this.getFragmentKey(e),r=this.fragments[t],a=M;return void 0!==r&&(a=r.buffered?!0===this.isPartial(r)?B:"OK":U),a},i.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},i.isTimeBuffered=function(e,t,r){for(var a,i,n=0;n<r.length;n++){if(a=r.start(n)-this.bufferPadding,i=r.end(n)+this.bufferPadding,e>=a&&t<=i)return!0;if(t<=a)return!1}return!1},i.onFragLoaded=function(e){var t=e.frag;Object(o.a)(t.sn)&&!t.bitrateTest&&(this.fragments[this.getFragmentKey(t)]={body:t,range:Object.create(null),buffered:!1})},i.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach(function(e){var r=t.timeRanges[e];t.detectEvictedFragments(e,r)})},i.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},i.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},i.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},i.removeAllFragments=function(){this.fragments=Object.create(null)},a}(f),j={search:function(e,t){for(var r=0,a=e.length-1,i=null,n=null;r<=a;){var s=t(n=e[i=(r+a)/2|0]);if(s>0)r=i+1;else{if(!(s<0))return n;a=i-1}}return null}},K=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var r=e.buffered,a=0;a<r.length;a++)if(t>=r.start(a)&&t<=r.end(a))return!0}catch(e){}return!1},e.bufferInfo=function(e,t,r){try{if(e){var a,i=e.buffered,n=[];for(a=0;a<i.length;a++)n.push({start:i.start(a),end:i.end(a)});return this.bufferedInfo(n,t,r)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,r){e.sort(function(e,t){var r=e.start-t.start;return r||t.end-e.end});var a=[];if(r)for(var i=0;i<e.length;i++){var n=a.length;if(n){var s=a[n-1].end;e[i].start-s<r?e[i].end>s&&(a[n-1].end=e[i].end):a.push(e[i])}else a.push(e[i])}else a=e;for(var o,l=0,d=t,u=t,f=0;f<a.length;f++){var h=a[f].start,c=a[f].end;if(t+r>=h&&t<c)d=h,l=(u=c)-t;else if(t+r<h){o=h;break}}return{len:l,start:d,end:u,nextStart:o}},e}(),H=r(8),V=r(11),W=r(9);function Y(){return window.MediaSource||window.WebKitMediaSource}var z=r(5),X=function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.trigger=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];this.emit.apply(this,[e,e].concat(r))},a}(H.EventEmitter),q=Y()||{isTypeSupported:function(){return!1}},Q=function(){function e(e,t){var r=this;this.hls=e,this.id=t;var a=this.observer=new X,i=e.config,n=function(t,a){(a=a||{}).frag=r.frag,a.id=r.id,e.trigger(t,a)};a.on(l.a.FRAG_DECRYPTED,n),a.on(l.a.FRAG_PARSING_INIT_SEGMENT,n),a.on(l.a.FRAG_PARSING_DATA,n),a.on(l.a.FRAG_PARSED,n),a.on(l.a.ERROR,n),a.on(l.a.FRAG_PARSING_METADATA,n),a.on(l.a.FRAG_PARSING_USERDATA,n),a.on(l.a.INIT_PTS_FOUND,n);var o={mp4:q.isTypeSupported("video/mp4"),mpeg:q.isTypeSupported("audio/mpeg"),mp3:q.isTypeSupported('audio/mp4; codecs="mp3"')},u=navigator.vendor;if(i.enableWorker&&"undefined"!=typeof Worker){var f;d.b.log("demuxing in webworker");try{f=this.w=V(12),this.onwmsg=this.onWorkerMessage.bind(this),f.addEventListener("message",this.onwmsg),f.onerror=function(t){e.trigger(l.a.ERROR,{type:s.b.OTHER_ERROR,details:s.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},f.postMessage({cmd:"init",typeSupported:o,vendor:u,id:t,config:JSON.stringify(i)})}catch(e){d.b.warn("Error in worker:",e),d.b.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),f&&Object(z.a)().URL.revokeObjectURL(f.objectURL),this.demuxer=new W.a(a,o,i,u),this.w=void 0}}else this.demuxer=new W.a(a,o,i,u)}var t=e.prototype;return t.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},t.push=function(e,t,r,a,i,n,s,l){var u=this.w,f=Object(o.a)(i.startPTS)?i.startPTS:i.start,h=i.decryptdata,c=this.frag,v=!(c&&i.cc===c.cc),p=!(c&&i.level===c.level),g=c&&i.sn===c.sn+1,m=!p&&g;if(v&&d.b.log(this.id+":discontinuity detected"),p&&d.b.log(this.id+":switch detected"),this.frag=i,u)u.postMessage({cmd:"demux",data:e,decryptdata:h,initSegment:t,audioCodec:r,videoCodec:a,timeOffset:f,discontinuity:v,trackSwitch:p,contiguous:m,duration:n,accurateTimeOffset:s,defaultInitPTS:l},e instanceof ArrayBuffer?[e]:[]);else{var y=this.demuxer;y&&y.push(e,h,t,r,a,f,v,p,m,n,s,l)}},t.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case"init":Object(z.a)().URL.revokeObjectURL(this.w.objectURL);break;case l.a.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},e}();function Z(e,t,r){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(r);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(r)}}function J(e,t,r){var a=e[t],i=e[r],n=i.startPTS;Object(o.a)(n)?r>t?(a.duration=n-a.start,a.duration<0&&d.b.warn("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!")):(i.duration=a.start-n,i.duration<0&&d.b.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):i.start=r>t?a.start+a.duration:Math.max(a.start-i.duration,0)}function $(e,t,r,a,i,n){var s=r;if(Object(o.a)(t.startPTS)){var l=Math.abs(t.startPTS-r);Object(o.a)(t.deltaPTS)?t.deltaPTS=Math.max(l,t.deltaPTS):t.deltaPTS=l,s=Math.max(r,t.startPTS),r=Math.min(r,t.startPTS),a=Math.max(a,t.endPTS),i=Math.min(i,t.startDTS),n=Math.max(n,t.endDTS)}var d=r-t.start;t.start=t.startPTS=r,t.maxStartPTS=s,t.endPTS=a,t.startDTS=i,t.endDTS=n,t.duration=a-r;var u,f,h,c=t.sn;if(!e||c<e.startSN||c>e.endSN)return 0;for(u=c-e.startSN,(f=e.fragments)[u]=t,h=u;h>0;h--)J(f,h,h-1);for(h=u;h<f.length-1;h++)J(f,h,h+1);return e.PTSKnown=!0,d}var te={toString:function(e){for(var t="",r=e.length,a=0;a<r;a++)t+="["+e.start(a).toFixed(3)+","+e.end(a).toFixed(3)+"]";return t}};function re(e,t){t.fragments.forEach(function(t){if(t){var r=t.start+e;t.start=t.startPTS=r,t.endPTS=r+t.duration}}),t.PTSKnown=!0}function ae(e,t,r){!function(e,t,r){if(function(e,t,r){var a=!1;return t&&t.details&&r&&(r.endCC>r.startCC||e&&e.cc<r.startCC)&&(a=!0),a}(e,r,t)){var a=function(e,t){var r=e.fragments,a=t.fragments;if(a.length&&r.length){var i=function(e,t){for(var r=null,a=0;a<e.length;a+=1){var i=e[a];if(i&&i.cc===t){r=i;break}}return r}(r,a[0].cc);if(i&&(!i||i.startPTS))return i;d.b.log("No frag in previous level to align on")}else d.b.log("No fragments to align")}(r.details,t);a&&(d.b.log("Adjusting PTS using last level due to CC increase within current level"),re(a.start,t))}}(e,r,t),!r.PTSKnown&&t&&function(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var r=t.fragments[0].programDateTime,a=(e.fragments[0].programDateTime-r)/1e3+t.fragments[0].start;Object(o.a)(a)&&(d.b.log("adjusting PTS using programDateTime delta, sliding:"+a.toFixed(3)),re(a,e))}}(r,t.details)}function ie(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0);var a=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-a<=e?1:r.start-a>e&&r.start?-1:0}function ne(e,t,r){var a=1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-a>e}var se=function(){function e(e,t,r,a){this.config=e,this.media=t,this.fragmentTracker=r,this.hls=a,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var t=e.prototype;return t.poll=function(e){var t=this.config,r=this.media,a=this.stalled,i=r.currentTime,n=r.seeking,s=this.seeking&&!n,o=!this.seeking&&n;if(this.seeking=n,i===e){if((o||s)&&(this.stalled=null),!r.paused&&!r.ended&&0!==r.playbackRate&&r.buffered.length){var l=K.bufferInfo(r,i,0),u=l.len>0,f=l.nextStart||0;if(u||f){if(n){if(l.len>2||!f||f-i>2)return;this.moved=!1}if(!this.moved&&this.stalled){var h=Math.max(f,l.start||0)-i;if(h>0&&h<=2)return void this._trySkipBufferHole(null)}var c=self.performance.now();if(null!==a){var v=c-a;!n&&v>=250&&this._reportStall(l.len);var p=K.bufferInfo(r,i,t.maxBufferHole);this._tryFixBufferStall(p,v)}else this.stalled=c}}}else if(this.moved=!0,null!==a){if(this.stallReported){var g=self.performance.now()-a;d.b.warn("playback not stuck anymore @"+i+", after "+Math.round(g)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},t._tryFixBufferStall=function(e,t){var r=this.config,a=this.fragmentTracker,i=this.media.currentTime,n=a.getPartialFragment(i);n&&this._trySkipBufferHole(n)||e.len>r.maxBufferHole&&t>1e3*r.highBufferWatchdogPeriod&&(d.b.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},t._reportStall=function(e){var t=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,d.b.warn("Playback stalling at @"+r.currentTime+" due to low buffer"),t.trigger(l.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t._trySkipBufferHole=function(e){for(var t=this.config,r=this.hls,a=this.media,i=a.currentTime,n=0,o=0;o<a.buffered.length;o++){var u=a.buffered.start(o);if(i+t.maxBufferHole>=n&&i<u){var f=Math.max(u+.05,a.currentTime+.1);return d.b.warn("skipping hole, adjusting currentTime from "+i+" to "+f),this.moved=!0,this.stalled=null,a.currentTime=f,e&&r.trigger(l.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+i+" to "+f,frag:e}),f}n=a.buffered.end(o)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,r=this.media,a=r.currentTime,i=(this.nudgeRetry||0)+1;if(this.nudgeRetry=i,i<e.nudgeMaxRetry){var n=a+i*e.nudgeOffset;d.b.warn("Nudging 'currentTime' from "+a+" to "+n),r.currentTime=n,t.trigger(l.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else d.b.error("Playhead still not moving while enough data buffered @"+a+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(l.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_STALLED_ERROR,fatal:!0})},e}(),le="STOPPED",de="IDLE",ue="KEY_LOADING",fe="FRAG_LOADING",he="FRAG_LOADING_WAITING_RETRY",ce="PARSING",ve="PARSED",pe="BUFFER_FLUSHING",me="ERROR",ye="WAITING_LEVEL";function be(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var Ee=function(e){var t,r;function a(t,r){var a;return(a=e.call(this,t,l.a.MEDIA_ATTACHED,l.a.MEDIA_DETACHING,l.a.MANIFEST_LOADING,l.a.MANIFEST_PARSED,l.a.LEVEL_LOADED,l.a.KEY_LOADED,l.a.FRAG_LOADED,l.a.FRAG_LOAD_EMERGENCY_ABORTED,l.a.FRAG_PARSING_INIT_SEGMENT,l.a.FRAG_PARSING_DATA,l.a.FRAG_PARSED,l.a.ERROR,l.a.AUDIO_TRACK_SWITCHING,l.a.AUDIO_TRACK_SWITCHED,l.a.BUFFER_CREATED,l.a.BUFFER_APPENDED,l.a.BUFFER_FLUSHED)||this).fragmentTracker=r,a.config=t.config,a.audioCodecSwap=!1,a._state=le,a.stallReported=!1,a.gapController=null,a.altAudio=!1,a}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var n,u,h=a.prototype;return h.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var a=r.startLevel;-1===a&&(a=0,this.bitrateTest=!0),this.level=r.nextLoadLevel=a,this.loadedmetadata=!1}t>0&&-1===e&&(d.b.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=de,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=le},h.stopLoad=function(){this.forceStartLoad=!1,e.prototype.stopLoad.call(this)},h.doTick=function(){switch(this.state){case pe:this.fragLoadError=0;break;case de:this._doTickIdle();break;case ye:var e=this.levels[this.level];e&&e.details&&(this.state=de);break;case he:var t=window.performance.now(),r=this.retryDate;(!r||t>=r||this.media&&this.media.seeking)&&(d.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=de)}this._checkBuffer(),this._checkFragmentChanged()},h._doTickIdle=function(){var e=this.hls,t=e.config,r=this.media;if(void 0!==this.levelLastLoaded&&(r||!this.startFragRequested&&t.startFragPrefetch)){var a;a=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var i=e.nextLoadLevel,n=this.levels[i];if(n){var s,o=n.bitrate;s=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var u=K.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,a,t.maxBufferHole),f=u.len;if(!(f>=s)){d.b.trace("buffer length of "+f.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=i;var h=n.details;if(!h||h.live&&this.levelLastLoaded!==i)this.state=ye;else{if(this._streamEnded(u,h)){var c={};return this.altAudio&&(c.type="video"),this.hls.trigger(l.a.BUFFER_EOS,c),void(this.state="ENDED")}this._fetchPayloadOrEos(a,u,h)}}}}},h._fetchPayloadOrEos=function(e,t,r){var a=this.fragPrevious,i=this.level,n=r.fragments,s=n.length;if(0!==s){var o,l=n[0].start,u=n[s-1].start+n[s-1].duration,f=t.end;if(r.initSegment&&!r.initSegment.data)o=r.initSegment;else if(r.live){var h=this.config.initialLiveManifestSize;if(s<h)return void d.b.warn("Can not start playback of a level, reason: not enough fragments "+s+" < "+h);if(null===(o=this._ensureFragmentAtLivePoint(r,f,l,u,a,n,s)))return}else f<l&&(o=n[0]);o||(o=this._findFragment(l,a,s,n,f,u,r)),o&&(o.encrypted?(d.b.log("Loading key for "+o.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+i),this._loadKey(o)):(d.b.log("Loading "+o.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+i+", currentTime:"+e.toFixed(3)+",bufferEnd:"+f.toFixed(3)),this._loadFragment(o)))}},h._ensureFragmentAtLivePoint=function(e,t,r,a,i,n,s){var l,u=this.hls.config,f=this.media,h=void 0!==u.liveMaxLatencyDuration?u.liveMaxLatencyDuration:u.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(r-u.maxFragLookUpTolerance,a-h)){var c=this.liveSyncPosition=this.computeLivePosition(r,e);t=c,f&&!f.paused&&f.readyState&&f.duration>c&&c>f.currentTime&&(d.b.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+c.toFixed(3)),f.currentTime=c),this.nextLoadPosition=c}if(e.PTSKnown&&t>a&&f&&f.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(i)if(e.hasProgramDateTime)d.b.log("live playlist, switching playlist, load frag with same PDT: "+i.programDateTime),l=function(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!Object(o.a)(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;r=r||0;for(var a=0;a<e.length;++a){var i=e[a];if(ne(t,r,i))return i}return null}(n,i.endProgramDateTime,u.maxFragLookUpTolerance);else{var v=i.sn+1;if(v>=e.startSN&&v<=e.endSN){var p=n[v-e.startSN];i.cc===p.cc&&(l=p,d.b.log("live playlist, switching playlist, load frag with next SN: "+l.sn))}l||(l=j.search(n,function(e){return i.cc-e.cc}))&&d.b.log("live playlist, switching playlist, load frag with same CC: "+l.sn)}l||(l=n[Math.min(s-1,Math.round(s/2))],d.b.log("live playlist, switching playlist, unknown, load middle frag : "+l.sn))}return l},h._findFragment=function(e,t,r,a,i,n,s){var o,l=this.hls.config;if(o=i<n?function(e,t,r,a){void 0===r&&(r=0),void 0===a&&(a=0);var i=e?t[e.sn-t[0].sn+1]:null;return i&&!ie(r,a,i)?i:j.search(t,ie.bind(null,r,a))}(t,a,i,i>n-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance):a[r-1]){var u=o.sn-s.startSN,f=t&&o.level===t.level,h=a[u-1],c=a[u+1];if(t&&o.sn===t.sn)if(f&&!o.backtracked)if(o.sn<s.endSN){var v=t.deltaPTS;v&&v>l.maxBufferHole&&t.dropped&&u?(o=h,d.b.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(o=c,d.b.log("Re-loading fragment with SN: "+o.sn))}else o=null;else o.backtracked&&(c&&c.backtracked?(d.b.warn("Already backtracked from fragment "+c.sn+", will not backtrack to fragment "+o.sn+". Loading fragment "+c.sn),o=c):(d.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),o.dropped=0,h?(o=h).backtracked=!0:u&&(o=null)))}return o},h._loadKey=function(e){this.state=ue,this.hls.trigger(l.a.KEY_LOADING,{frag:e})},h._loadFragment=function(e){var t=this.fragmentTracker.getState(e);this.fragCurrent=e,"initSegment"!==e.sn&&(this.startFragRequested=!0),Object(o.a)(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||t===M||t===B?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,this.hls.trigger(l.a.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new Q(this.hls,"main")),this.state=fe):t===U&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},h.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,i.MAIN)},h.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},h._checkFragmentChanged=function(){var e,t,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((t=r.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),K.isBuffered(r,t)?e=this.getBufferedFrag(t):K.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var a=e;if(a!==this.fragPlaying){this.hls.trigger(l.a.FRAG_CHANGED,{frag:a});var i=a.level;this.fragPlaying&&this.fragPlaying.level===i||this.hls.trigger(l.a.LEVEL_SWITCHED,{level:i}),this.fragPlaying=a}}},h.immediateLevelSwitch=function(){if(d.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e,t=this.media;t?(e=t.paused,t.pause()):e=!0,this.previouslyPaused=e}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},h.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,K.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},h.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,r,a;if((r=this.getBufferedFrag(e.currentTime))&&r.startPTS>1&&this.flushMainBuffer(0,r.startPTS-1),e.paused)t=0;else{var i=this.hls.nextLoadLevel,n=this.levels[i],s=this.fragLastKbps;t=s&&this.fragCurrent?this.fragCurrent.duration*n.bitrate/(1e3*s)+1:0}if((a=this.getBufferedFrag(e.currentTime+t))&&(a=this.followingBufferedFrag(a))){var o=this.fragCurrent;o&&o.loader&&o.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(a.maxStartPTS,Number.POSITIVE_INFINITY)}}},h.flushMainBuffer=function(e,t){this.state=pe;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(l.a.BUFFER_FLUSHING,r)},h.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition),this.gapController=new se(r,t,this.fragmentTracker,this.hls)},h.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(d.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},h.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;Object(o.a)(t)&&d.b.log("media seeked to "+t.toFixed(3)),this.tick()},h.onManifestLoading=function(){d.b.log("trigger BUFFER_RESET"),this.hls.trigger(l.a.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},h.onManifestParsed=function(e){var t,r=!1,a=!1;e.levels.forEach(function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),-1!==t.indexOf("mp4a.40.5")&&(a=!0))}),this.audioCodecSwitch=r&&a,this.audioCodecSwitch&&d.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=e.altAudio,this.levels=e.levels,this.startFragRequested=!1;var i=this.config;(i.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(i.startPosition)},h.onLevelLoaded=function(e){var t=e.details,r=e.level,a=this.levels[this.levelLastLoaded],i=this.levels[r],n=t.totalduration,s=0;if(d.b.log("level "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+n),t.live){var u=i.details;u&&t.fragments.length>0?(function(e,t){t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment);var r,a=0;if(function(e,t,r){if(e&&t)for(var a=Math.max(e.startSN,t.startSN)-t.startSN,i=Math.min(e.endSN,t.endSN)-t.startSN,n=t.startSN-e.startSN,s=a;s<=i;s++){var o=e.fragments[n+s],l=t.fragments[s];if(!o||!l)break;r(o,l,s)}}(e,t,function(e,i){a=e.cc-i.cc,Object(o.a)(e.startPTS)&&(i.start=i.startPTS=e.startPTS,i.endPTS=e.endPTS,i.duration=e.duration,i.backtracked=e.backtracked,i.dropped=e.dropped,r=i),t.PTSKnown=!0}),t.PTSKnown){if(a){d.b.log("discontinuity sliding from playlist, take drift into account");for(var i=t.fragments,n=0;n<i.length;n++)i[n].cc+=a}r?$(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):function(e,t){var r=t.startSN-e.startSN,a=e.fragments,i=t.fragments;if(!(r<0||r>a.length))for(var n=0;n<i.length;n++)i[n].start+=a[r].start}(e,t),t.PTSKnown=e.PTSKnown}}(u,t),s=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(s,u),t.PTSKnown&&Object(o.a)(s)?d.b.log("live playlist sliding:"+s.toFixed(3)):(d.b.log("live playlist - outdated PTS, unknown sliding"),ae(this.fragPrevious,a,t))):(d.b.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,ae(this.fragPrevious,a,t))}else t.PTSKnown=!1;if(i.details=t,this.levelLastLoaded=r,this.hls.trigger(l.a.LEVEL_UPDATED,{details:t,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var f=t.startTimeOffset;Object(o.a)(f)?(f<0&&(d.b.log("negative start time offset "+f+", count from end of last fragment"),f=s+n+f),d.b.log("start time offset found in playlist, adjust startPosition to "+f),this.startPosition=f):t.live?(this.startPosition=this.computeLivePosition(s,t),d.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===ye&&(this.state=de),this.tick()},h.onKeyLoaded=function(){this.state===ue&&(this.state=de,this.tick())},h.onFragLoaded=function(e){var t=this.fragCurrent,r=this.hls,a=this.levels,i=this.media,n=e.frag;if(this.state===fe&&t&&"main"===n.type&&n.level===t.level&&n.sn===t.sn){var s=e.stats,o=a[t.level],u=o.details;if(this.bitrateTest=!1,this.stats=s,d.b.log("Loaded "+t.sn+" of ["+u.startSN+" ,"+u.endSN+"],level "+t.level),n.bitrateTest&&r.nextLoadLevel)this.state=de,this.startFragRequested=!1,s.tparsed=s.tbuffered=window.performance.now(),r.trigger(l.a.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else if("initSegment"===n.sn)this.state=de,s.tparsed=s.tbuffered=window.performance.now(),u.initSegment.data=e.payload,r.trigger(l.a.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else{d.b.log("Parsing "+t.sn+" of ["+u.startSN+" ,"+u.endSN+"],level "+t.level+", cc "+t.cc),this.state=ce,this.pendingBuffering=!0,this.appended=!1,n.bitrateTest&&(n.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:n}));var f=!(i&&i.seeking)&&(u.PTSKnown||!u.live),h=u.initSegment?u.initSegment.data:[],c=this._getAudioCodec(o);(this.demuxer=this.demuxer||new Q(this.hls,"main")).push(e.payload,h,c,o.videoCodec,t,u.totalduration,f)}}this.fragLoadError=0},h.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===ce){var a,i,n=e.tracks;if(n.audio&&this.altAudio&&delete n.audio,i=n.audio){var s=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();s&&this.audioCodecSwap&&(d.b.log("swapping playlist audio codec"),s=-1!==s.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==i.metadata.channelCount&&-1===o.indexOf("firefox")&&(s="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==i.container&&(s="mp4a.40.2",d.b.log("Android: force audio codec to "+s)),i.levelCodec=s,i.id=e.id}for(a in(i=n.video)&&(i.levelCodec=this.levels[this.level].videoCodec,i.id=e.id),this.hls.trigger(l.a.BUFFER_CODECS,n),n){i=n[a],d.b.log("main track:"+a+",container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var u=i.initSegment;u&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(l.a.BUFFER_APPENDING,{type:a,data:u,parent:"main",content:"initSegment"}))}this.tick()}},h.onFragParsingData=function(e){var t=this,r=this.fragCurrent,a=e.frag;if(r&&"main"===e.id&&a.sn===r.sn&&a.level===r.level&&("audio"!==e.type||!this.altAudio)&&this.state===ce){var i=this.levels[this.level],n=r;if(Object(o.a)(e.endPTS)||(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),!0===e.hasAudio&&n.addElementaryStream(v.AUDIO),!0===e.hasVideo&&n.addElementaryStream(v.VIDEO),d.b.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(n.dropped=e.dropped,n.dropped)if(n.backtracked)d.b.warn("Already backtracked on this fragment, appending with the gap",n.sn);else{var s=i.details;if(!s||n.sn!==s.startSN)return d.b.warn("missing video frame(s), backtracking fragment",n.sn),this.fragmentTracker.removeFragment(n),n.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=de,this.fragPrevious=n,void this.tick();d.b.warn("missing video frame(s) on first frag, appending with gap",n.sn)}else n.backtracked=!1;var u=$(i.details,n,e.startPTS,e.endPTS,e.startDTS,e.endDTS),f=this.hls;f.trigger(l.a.LEVEL_PTS_UPDATED,{details:i.details,level:this.level,drift:u,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach(function(r){r&&r.length&&t.state===ce&&(t.appended=!0,t.pendingBuffering=!0,f.trigger(l.a.BUFFER_APPENDING,{type:e.type,data:r,parent:"main",content:"data"}))}),this.tick()}},h.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===ce&&(this.stats.tparsed=window.performance.now(),this.state=ve,this._checkAppendedParsed())},h.onAudioTrackSwitching=function(e){var t=!!e.url,r=e.id;if(!t){if(this.mediaBuffer!==this.media){d.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var a=this.fragCurrent;a.loader&&(d.b.log("switching to main audio track, cancel main fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=de}var i=this.hls;i.trigger(l.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),i.trigger(l.a.AUDIO_TRACK_SWITCHED,{id:r}),this.altAudio=!1}},h.onAudioTrackSwitched=function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var a=this.videoBuffer;a&&this.mediaBuffer!==a&&(d.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=a)}this.altAudio=r,this.tick()},h.onBufferCreated=function(e){var t,r,a=e.tracks,i=!1;for(var n in a){var s=a[n];"main"===s.id?(r=n,t=s,"video"===n&&(this.videoBuffer=a[n].buffer)):i=!0}i&&t?(d.b.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},h.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==ce&&t!==ve||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},h._checkAppendedParsed=function(){if(!(this.state!==ve||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;d.b.log("main buffered : "+te.toString(t.buffered)),this.fragPrevious=e;var r=this.stats;r.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),this.hls.trigger(l.a.FRAG_BUFFERED,{stats:r,frag:e,id:"main"}),this.state=de}this.tick()}},h.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var r=!!this.media&&K.isBuffered(this.media,this.media.currentTime)&&K.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case s.a.FRAG_LOAD_ERROR:case s.a.FRAG_LOAD_TIMEOUT:case s.a.KEY_LOAD_ERROR:case s.a.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var a=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);d.b.warn("mediaController: frag loading failed, retry in "+a+" ms"),this.retryDate=window.performance.now()+a,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=he}else d.b.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=me;break;case s.a.LEVEL_LOAD_ERROR:case s.a.LEVEL_LOAD_TIMEOUT:this.state!==me&&(e.fatal?(this.state=me,d.b.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==ye||(this.state=de));break;case s.a.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==ce&&this.state!==ve||(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=de):(d.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},h._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,d.b.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},h._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},h.onFragLoadEmergencyAborted=function(){this.state=de,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},h.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;e&&this.fragmentTracker.detectEvictedFragments(v.VIDEO,e.buffered),this.state=de,this.fragPrevious=null},h.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},h._seekToStartPos=function(){var e=this.media,t=e.currentTime,r=e.seeking?t:this.startPosition;t!==r&&r>=0&&(d.b.log("target start position not buffered, seek to buffered.start(0) "+r+" from current time "+t+" "),e.currentTime=r)},h._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(d.b.log("swapping playlist audio codec"),t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},n=a,(u=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,d.b.log("main stream-controller: "+t+"->"+e),this.hls.trigger(l.a.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}])&&be(n.prototype,u),a}(function(e){var t,r;function a(){return e.apply(this,arguments)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=a.prototype;return i.doTick=function(){},i.startLoad=function(){},i.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=le},i._streamEnded=function(e,t){var r=this.fragCurrent,a=this.fragmentTracker;if(!t.live&&r&&!r.backtracked&&r.sn===t.endSN&&!e.nextStart){var i=a.getState(r);return i===B||"OK"===i}return!1},i.onMediaSeeking=function(){var e=this.config,t=this.media,r=this.mediaBuffer,a=this.state,i=t?t.currentTime:null,n=K.bufferInfo(r||t,i,this.config.maxBufferHole);if(Object(o.a)(i)&&d.b.log("media seeking to "+i.toFixed(3)),a===fe){var s=this.fragCurrent;if(0===n.len&&s){var l=e.maxFragLookUpTolerance,u=s.start-l,f=s.start+s.duration+l;i<u||i>f?(s.loader&&(d.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),s.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=de):d.b.log("seeking outside of buffer but within currently loaded fragment range")}}else"ENDED"===a&&(0===n.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=de);t&&(this.lastCurrentTime=i),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=i),this.tick()},i.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},i.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},i.onHandlerDestroyed=function(){this.state=le,this.fragmentTracker=null},i.computeLivePosition=function(e,t){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)},a}(function(e){var t,r;function a(t){for(var r,a=arguments.length,i=new Array(a>1?a-1:0),n=1;n<a;n++)i[n-1]=arguments[n];return(r=e.call.apply(e,[this,t].concat(i))||this)._boundTick=void 0,r._tickTimer=null,r._tickInterval=null,r._tickCallCount=0,r._boundTick=r.tick.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=a.prototype;return i.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},i.hasInterval=function(){return!!this._tickInterval},i.hasNextTick=function(){return!!this._tickTimer},i.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},i.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},i.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},i.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},i.doTick=function(){},a}(f)));function Te(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}window.performance;var Se,Ae=function(e){var t,r;function a(t){var r;return(r=e.call(this,t,l.a.MANIFEST_LOADED,l.a.LEVEL_LOADED,l.a.AUDIO_TRACK_SWITCHED,l.a.FRAG_LOADED,l.a.ERROR)||this).canload=!1,r.currentLevelIndex=null,r.manualLevelIndex=-1,r.timer=null,Se=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i,n,u=a.prototype;return u.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},u.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},u.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),null!==this.timer&&this.loadLevel()},u.stopLoad=function(){this.canload=!1},u.onManifestLoaded=function(e){var t,r=[],a=[],i={},n=null,o=!1,u=!1;if(e.levels.forEach(function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,o=o||!!e.videoCodec,u=u||!!e.audioCodec,Se&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(n=i[e.bitrate])?n.url.push(e.url):(e.url=[e.url],e.urlId=0,i[e.bitrate]=e,r.push(e)),t&&(t.AUDIO&&(u=!0,Z(n||e,"audio",t.AUDIO)),t.SUBTITLES&&Z(n||e,"text",t.SUBTITLES))}),o&&u&&(r=r.filter(function(e){return!!e.videoCodec})),r=r.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||_(t,"audio"))&&(!r||_(r,"video"))}),e.audioTracks&&(a=e.audioTracks.filter(function(e){return!e.audioCodec||_(e.audioCodec,"audio")})).forEach(function(e,t){e.id=t}),r.length>0){t=r[0].bitrate,r.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=r;for(var f=0;f<r.length;f++)if(r[f].bitrate===t){this._firstLevel=f,d.b.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+t);break}this.hls.trigger(l.a.MANIFEST_PARSED,{levels:r,audioTracks:a,firstLevel:this._firstLevel,stats:e.stats,audio:u,video:o,altAudio:a.some(function(e){return!!e.url})})}else this.hls.trigger(l.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},u.setLevelInternal=function(e){var t=this._levels,r=this.hls;if(e>=0&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){d.b.log("switching to level "+e),this.currentLevelIndex=e;var a=t[e];a.level=e,r.trigger(l.a.LEVEL_SWITCHING,a)}var i=t[e],n=i.details;if(!n||n.live){var o=i.urlId;r.trigger(l.a.LEVEL_LOADING,{url:i.url[o],level:e,id:o})}}else r.trigger(l.a.ERROR,{type:s.b.OTHER_ERROR,details:s.a.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},u.onError=function(e){if(e.fatal)e.type===s.b.NETWORK_ERROR&&this.clearTimer();else{var t,r=!1,a=!1;switch(e.details){case s.a.FRAG_LOAD_ERROR:case s.a.FRAG_LOAD_TIMEOUT:case s.a.KEY_LOAD_ERROR:case s.a.KEY_LOAD_TIMEOUT:t=e.frag.level,a=!0;break;case s.a.LEVEL_LOAD_ERROR:case s.a.LEVEL_LOAD_TIMEOUT:t=e.context.level,r=!0;break;case s.a.REMUX_ALLOC_ERROR:t=e.level,r=!0}void 0!==t&&this.recoverLevel(e,t,r,a)}},u.recoverLevel=function(e,t,r,a){var i,n,s,o=this,l=this.hls.config,u=e.details,f=this._levels[t];if(f.loadError++,f.fragmentError=a,r){if(!(this.levelRetryCount+1<=l.levelLoadingMaxRetry))return d.b.error("level controller, cannot recover from "+u+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);n=Math.min(Math.pow(2,this.levelRetryCount)*l.levelLoadingRetryDelay,l.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return o.loadLevel()},n),e.levelRetry=!0,this.levelRetryCount++,d.b.warn("level controller, "+u+", retry in "+n+" ms, current retry count is "+this.levelRetryCount)}(r||a)&&((i=f.url.length)>1&&f.loadError<i?(f.urlId=(f.urlId+1)%i,f.details=void 0,d.b.warn("level controller, "+u+" for level "+t+": switching to redundant URL-id "+f.urlId)):-1===this.manualLevelIndex?(s=0===t?this._levels.length-1:t-1,d.b.warn("level controller, "+u+": switch to "+s),this.hls.nextAutoLevel=this.currentLevelIndex=s):a&&(d.b.warn("level controller, "+u+": reload a fragment"),this.currentLevelIndex=null))},u.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var r=this._levels[t.level];void 0!==r&&(r.fragmentError=!1,r.loadError=0,this.levelRetryCount=0)}},u.onLevelLoaded=function(e){var t=this,r=e.level,a=e.details;if(r===this.currentLevelIndex){var i=this._levels[r];if(i.fragmentError||(i.loadError=0,this.levelRetryCount=0),a.live){var n=function(e,t,r){var a=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),i=a/2;return e&&t.endSN===e.endSN&&(a=i),r&&(a=Math.max(i,a-(window.performance.now()-r))),Math.round(a)}(i.details,a,e.stats.trequest);d.b.log("live playlist, reload in "+Math.round(n)+" ms"),this.timer=setTimeout(function(){return t.loadLevel()},n)}else this.clearTimer()}},u.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var a=-1,i=0;i<r.audioGroupIds.length;i++)if(r.audioGroupIds[i]===t){a=i;break}a!==r.urlId&&(r.urlId=a,this.startLoad())}},u.loadLevel=function(){if(d.b.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&e.url.length>0){var t=this.currentLevelIndex,r=e.urlId,a=e.url[r];d.b.log("Attempt loading level index "+t+" with URL-id "+r),this.hls.trigger(l.a.LEVEL_LOADING,{url:a,level:t,id:r})}}},i=a,(n=[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&Te(i.prototype,n),a}(f),_e=r(4);function Re(e,t){var r;try{r=new Event("addtrack")}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)}var Le=function(e){var t,r;function a(t){var r;return(r=e.call(this,t,l.a.MEDIA_ATTACHED,l.a.MEDIA_DETACHING,l.a.FRAG_PARSING_METADATA,l.a.LIVE_BACK_BUFFER_REACHED)||this).id3Track=void 0,r.media=void 0,r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=a.prototype;return i.destroy=function(){f.prototype.destroy.call(this)},i.onMediaAttached=function(e){this.media=e.media,this.media},i.onMediaDetaching=function(){!function(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}(this.id3Track),this.id3Track=void 0,this.media=void 0},i.getID3Track=function(e){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return Re(r,this.media),r}return this.media.addTextTrack("metadata","id3")},i.onFragParsingMetadata=function(e){var t=e.frag,r=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var a=this.hls.config.cnxRenderWindow.WebKitDataCue||his.hls.config.cnxRenderWindow.VTTCue||his.hls.config.cnxRenderWindow.TextTrackCue,i=0;i<r.length;i++){var n=_e.a.getID3Frames(r[i].data);if(n){var s=r[i].pts,o=i<r.length-1?r[i+1].pts:t.endPTS;s===o?o+=1e-4:s>o&&(d.b.warn("detected an id3 sample with endTime < startTime, adjusting endTime to (startTime + 0.25)"),o=s+.25);for(var l=0;l<n.length;l++){var u=n[l];if(!_e.a.isTimeStampFrame(u)){var f=new a(s,o,"");f.value=u,this.id3Track.addCue(f)}}}}},i.onLiveBackBufferReached=function(e){var t=e.bufferEnd,r=this.id3Track;if(r&&r.cues&&r.cues.length){var a=function(e,t){if(t<e[0].endTime)return e[0];if(t>e[e.length-1].endTime)return e[e.length-1];for(var r=0,a=e.length-1;r<=a;){var i=Math.floor((a+r)/2);if(t<e[i].endTime)a=i-1;else{if(!(t>e[i].endTime))return e[i];r=i+1}}return e[r].endTime-t<t-e[a].endTime?e[r]:e[a]}(r.cues,t);if(a)for(;r.cues[0]!==a;)r.removeCue(r.cues[0])}},a}(f),we=function(){function e(e){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}var t=e.prototype;return t.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}(),De=function(){function e(e,t,r,a){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=e,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new we(t),this.fast_=new we(r)}var t=e.prototype;return t.sample=function(e,t){var r=(e=Math.max(e,this.minDelayMs_))/1e3,a=8*t/r;this.fast_.sample(r,a),this.slow_.sample(r,a)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}();function ke(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var xe=window.performance,Oe=function(e){var t,r;function a(t){var r;return(r=e.call(this,t,l.a.FRAG_LOADING,l.a.FRAG_LOADED,l.a.FRAG_BUFFERED,l.a.ERROR)||this).lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=t,r.timer=null,r.bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i,n,h=a.prototype;return h.destroy=function(){this.clearTimer(),f.prototype.destroy.call(this)},h.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this.bwEstimator)){var r,a,i=this.hls,n=i.config,s=t.level;i.levels[s].details.live?(r=n.abrEwmaFastLive,a=n.abrEwmaSlowLive):(r=n.abrEwmaFastVoD,a=n.abrEwmaSlowVoD),this.bwEstimator=new De(i,a,r,n.abrEwmaDefaultEstimate)}},h._abandonRulesCheck=function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(r){var a=r.loader,i=e.minAutoLevel;if(!a||a.stats&&a.stats.aborted)return d.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var n=a.stats;if(t&&n&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var s=xe.now()-n.trequest,o=Math.abs(t.playbackRate);if(s>500*r.duration/o){var u=e.levels,f=Math.max(1,n.bw?n.bw/8:1e3*n.loaded/s),h=u[r.level],c=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,v=n.total?n.total:Math.max(n.loaded,Math.round(r.duration*c/8)),p=t.currentTime,g=(v-n.loaded)/f,m=(K.bufferInfo(t,p,e.config.maxBufferHole).end-p)/o;if(m<2*r.duration/o&&g>m){var y;for(y=r.level-1;y>i;y--){var b=u[y].realBitrate?Math.max(u[y].realBitrate,u[y].bitrate):u[y].bitrate;if(r.duration*b/(6.4*f)<m)break}void 0<g&&(d.b.warn("loading too slow, abort fragment loading and switch to level "+y+":fragLoadedDelay["+y+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+(void 0).toFixed(1)+"<"+g.toFixed(1)+":"+m.toFixed(1)),e.nextLoadLevel=y,this.bwEstimator.sample(s,n.loaded),a.abort(),this.clearTimer(),e.trigger(l.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:n}))}}}}},h.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&Object(o.a)(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[t.level],a=(r.loaded?r.loaded.bytes:0)+e.stats.loaded,i=(r.loaded?r.loaded.duration:0)+e.frag.duration;r.loaded={bytes:a,duration:i},r.realBitrate=Math.round(8*a/i)}if(e.frag.bitrateTest){var n=e.stats;n.tparsed=n.tbuffered=n.tload,this.onFragBuffered(e)}}},h.onFragBuffered=function(e){var t=e.stats,r=e.frag;if(!0!==t.aborted&&"main"===r.type&&Object(o.a)(r.sn)&&(!r.bitrateTest||t.tload===t.tbuffered)){var a=t.tparsed-t.trequest;d.b.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this.bwEstimator.sample(a,t.loaded),t.bwEstimate=this.bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}},h.onError=function(e){switch(e.details){case s.a.FRAG_LOAD_ERROR:case s.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},h.clearTimer=function(){clearInterval(this.timer),this.timer=null},h._findBestLevel=function(e,t,r,a,i,n,s,o,l){for(var u=i;u>=a;u--){var f=l[u];if(f){var h=f.details,c=h?h.totalduration/h.fragments.length:t,v=!!h&&h.live,p=void 0;p=u<=e?s*r:o*r;var g=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,m=g*c/p;if(d.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(p)+"/"+g+"/"+c+"/"+n+"/"+m),p>g&&(!m||v&&!this.bitrateTestDelay||m<n))return u}}return-1},i=a,(n=[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this.bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this.nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e}},{key:"nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,a=e.config,i=e.minAutoLevel,n=e.media,s=this.lastLoadedFragLevel,o=this.fragCurrent?this.fragCurrent.duration:0,l=n?n.currentTime:0,u=n&&0!==n.playbackRate?Math.abs(n.playbackRate):1,f=this.bwEstimator?this.bwEstimator.getEstimate():a.abrEwmaDefaultEstimate,h=(K.bufferInfo(n,l,a.maxBufferHole).end-l)/u,c=this._findBestLevel(s,o,f,i,t,h,a.abrBandWidthFactor,a.abrBandWidthUpFactor,r);if(c>=0)return c;d.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var v=o?Math.min(o,a.maxStarvationDelay):a.maxStarvationDelay,p=a.abrBandWidthFactor,g=a.abrBandWidthUpFactor;if(0===h){var m=this.bitrateTestDelay;m&&(v=(o?Math.min(o,a.maxLoadingDelay):a.maxLoadingDelay)-m,d.b.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*v)+" ms"),p=g=1)}return c=this._findBestLevel(s,o,f,i,t,h+v,p,g,r),Math.max(c,0)}}])&&ke(i.prototype,n),a}(f),Ie=Y(),Ce=function(e){var t,r;function a(t){var r;return(r=e.call(this,t,l.a.MEDIA_ATTACHING,l.a.MEDIA_DETACHING,l.a.MANIFEST_PARSED,l.a.BUFFER_RESET,l.a.BUFFER_APPENDING,l.a.BUFFER_CODECS,l.a.BUFFER_EOS,l.a.BUFFER_FLUSHING,l.a.LEVEL_PTS_UPDATED,l.a.LEVEL_UPDATED)||this)._msDuration=null,r._levelDuration=null,r._levelTargetDuration=10,r._live=null,r._objectUrl=null,r._needsFlush=!1,r._needsEos=!1,r.config=void 0,r.audioTimestampOffset=void 0,r.bufferCodecEventsExpected=0,r._bufferCodecEventsTotal=0,r.media=null,r.mediaSource=null,r.segments=[],r.parent=void 0,r.appending=!1,r.appended=0,r.appendError=0,r.flushBufferCounter=0,r.tracks={},r.pendingTracks={},r.sourceBuffer={},r.flushRange=[],r._onMediaSourceOpen=function(){d.b.log("media source opened"),r.hls.trigger(l.a.MEDIA_ATTACHED,{media:r.media});var e=r.mediaSource;e&&e.removeEventListener("sourceopen",r._onMediaSourceOpen),r.checkPendingTracks()},r._onMediaSourceClose=function(){d.b.log("media source closed")},r._onMediaSourceEnded=function(){d.b.log("media source ended")},r._onSBUpdateEnd=function(){if(r.audioTimestampOffset&&r.sourceBuffer.audio){var e=r.sourceBuffer.audio;d.b.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+r.audioTimestampOffset),e.timestampOffset=r.audioTimestampOffset,delete r.audioTimestampOffset}r._needsFlush&&r.doFlush(),r._needsEos&&r.checkEos(),r.appending=!1;var t=r.parent,a=r.segments.reduce(function(e,r){return r.parent===t?e+1:e},0),i={},n=r.sourceBuffer;for(var s in n){var o=n[s];if(!o)throw Error("handling source buffer update end error: source buffer for "+s+" uninitilized and unable to update buffered TimeRanges.");i[s]=o.buffered}r.hls.trigger(l.a.BUFFER_APPENDED,{parent:t,pending:a,timeRanges:i}),r._needsFlush||r.doAppending(),r.updateMediaElementDuration(),0===a&&r.flushLiveBackBuffer()},r._onSBUpdateError=function(e){d.b.error("sourceBuffer error:",e),r.hls.trigger(l.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_APPENDING_ERROR,fatal:!1})},r.config=t.config,r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=a.prototype;return i.destroy=function(){f.prototype.destroy.call(this)},i.onLevelPtsUpdated=function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var a=this.sourceBuffer.audio;if(!a)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(Math.abs(a.timestampOffset-e.start)>.1){var i=a.updating;try{a.abort()}catch(e){d.b.warn("can not abort audio buffer: "+e)}i?this.audioTimestampOffset=e.start:(d.b.warn("change mpeg audio timestamp offset from "+a.timestampOffset+" to "+e.start),a.timestampOffset=e.start)}}},i.onManifestParsed=function(e){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=e.altAudio?2:1,d.b.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},i.onMediaAttaching=function(e){var t=this.media=e.media;if(t&&Ie){var r=this.mediaSource=new Ie;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),t.src=window.URL.createObjectURL(r),this._objectUrl=t.src}},i.onMediaDetaching=function(){d.b.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){d.b.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&this.hls.config.cnxRenderWindow.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):d.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(l.a.MEDIA_DETACHED)},i.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,r=Object.keys(t).length;(r&&!e||2===r)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},i.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{r&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this._onSBUpdateEnd),r.removeEventListener("error",this._onSBUpdateError))}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},i.onBufferCodecs=function(e){var t=this;Object.keys(this.sourceBuffer).length||(Object.keys(e).forEach(function(r){t.pendingTracks[r]=e[r]}),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},i.createSourceBuffers=function(e){var t=this.sourceBuffer,r=this.mediaSource;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(var a in e)if(!t[a]){var i=e[a];if(!i)throw Error("source buffer exists for track "+a+", however track does not");var n=i.levelCodec||i.codec,o=i.container+";codecs="+n;d.b.log("creating sourceBuffer("+o+")");try{var u=t[a]=r.addSourceBuffer(o);u.addEventListener("updateend",this._onSBUpdateEnd),u.addEventListener("error",this._onSBUpdateError),this.tracks[a]={buffer:u,codec:n,id:i.id,container:i.container,levelCodec:i.levelCodec}}catch(e){d.b.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(l.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:o})}}this.hls.trigger(l.a.BUFFER_CREATED,{tracks:this.tracks})},i.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},i.onBufferEos=function(e){for(var t in this.sourceBuffer)if(!e.type||e.type===t){var r=this.sourceBuffer[t];r&&!r.ended&&(r.ended=!0,d.b.log(t+" sourceBuffer now EOS"))}this.checkEos()},i.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var a=e[r];if(a){if(!a.ended)return;if(a.updating)return void(this._needsEos=!0)}}d.b.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){d.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},i.onBufferFlushing=function(e){e.type?this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}):(this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"video"}),this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},i.flushLiveBackBuffer=function(){if(this._live){var e=this.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))if(this.media)for(var t=this.media.currentTime,r=this.sourceBuffer,a=Object.keys(r),i=t-Math.max(e,this._levelTargetDuration),n=a.length-1;n>=0;n--){var s=a[n],o=r[s];if(o){var u=o.buffered;u.length>0&&i>u.start(0)&&this.removeBufferRange(s,o,0,i)&&this.hls.trigger(l.a.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i})}}else d.b.error("flushLiveBackBuffer called without attaching media")}},i.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},i.updateMediaElementDuration=function(){var e,t=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var r in this.sourceBuffer){var a=this.sourceBuffer[r];if(a&&!0===a.updating)return}e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(d.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||!Object(o.a)(e))&&(d.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},i.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var a in r){var i=r[a];i&&(t+=i.buffered.length)}}catch(e){d.b.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(l.a.BUFFER_FLUSHED)}},i.doAppending=function(){var e=this.config,t=this.hls,r=this.segments,a=this.sourceBuffer;if(Object.keys(a).length){if(!this.media||this.media.error)return this.segments=[],void d.b.error("trying to append although a media error occured, flush segment and abort");if(!this.appending){var i=r.shift();if(i)try{var n=a[i.type];if(!n)return void this._onSBUpdateEnd();if(n.updating)return void r.unshift(i);n.ended=!1,this.parent=i.parent,n.appendBuffer(i.data),this.appendError=0,this.appended++,this.appending=!0}catch(a){d.b.error("error while trying to append buffer:"+a.message),r.unshift(i);var o={type:s.b.MEDIA_ERROR,parent:i.parent,details:"",fatal:!1};22===a.code?(this.segments=[],o.details=s.a.BUFFER_FULL_ERROR):(this.appendError++,o.details=s.a.BUFFER_APPEND_ERROR,this.appendError>e.appendErrorMaxRetry&&(d.b.log("fail "+e.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],o.fatal=!0)),t.trigger(l.a.ERROR,o)}}}},i.flushBuffer=function(e,t,r){var a=this.sourceBuffer;if(!Object.keys(a).length)return!0;var i="null";if(this.media&&(i=this.media.currentTime.toFixed(3)),d.b.log("flushBuffer,pos/start/end: "+i+"/"+e+"/"+t),this.flushBufferCounter>=this.appended)return d.b.warn("abort flushing too many retries"),!0;var n=a[r];if(n){if(n.ended=!1,n.updating)return d.b.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(r,n,e,t))return this.flushBufferCounter++,!1}return d.b.log("buffer flushed"),!0},i.removeBufferRange=function(e,t,r,a){try{for(var i=0;i<t.buffered.length;i++){var n=t.buffered.start(i),s=t.buffered.end(i),o=Math.max(n,r),l=Math.min(s,a);if(Math.min(l,s)-o>.5){var u="null";return this.media&&(u=this.media.currentTime.toString()),d.b.log("sb remove "+e+" ["+o+","+l+"], of ["+n+","+s+"], pos:"+u),t.remove(o,l),!0}}}catch(e){d.b.warn("removeBufferRange failed",e)}return!1},a}(f);function Pe(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var Me,Fe=function(e){var t,r;function a(t){var r;return(r=e.call(this,t,l.a.FPS_DROP_LEVEL_CAPPING,l.a.MEDIA_ATTACHING,l.a.MANIFEST_PARSED,l.a.BUFFER_CODECS,l.a.MEDIA_DETACHING)||this).autoLevelCapping=Number.POSITIVE_INFINITY,r.firstLevel=null,r.levels=[],r.media=null,r.restrictedLevels=[],r.timer=null,r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i,n,s,o=a.prototype;return o.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.stopCapping())},o.onFpsDropLevelCapping=function(e){a.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},o.onMediaAttaching=function(e){this.media=e.media instanceof this.hls.config.cnxRenderWindow.HTMLVideoElement?e.media:null},o.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onLevelsUpdated=function(e){this.levels=e.levels},o.onMediaDetaching=function(){this.stopCapping()},o.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},o.getMaxLevel=function(e){var t=this;if(!this.levels)return-1;var r=this.levels.filter(function(r,i){return a.isLevelAllowed(i,t.restrictedLevels)&&i<=e});return a.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)},o.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},o.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},a.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},a.getMaxLevelByMediaSize=function(e,t,r){if(!e||e&&!e.length)return-1;for(var a,i,n=e.length-1,s=0;s<e.length;s+=1){var o=e[s];if((o.width>=t||o.height>=r)&&(a=o,!(i=e[s+1])||a.width!==i.width||a.height!==i.height)){n=s;break}}return n},i=a,s=[{key:"contentScaleFactor",get:function(){return 1}}],(n=[{key:"mediaWidth",get:function(){var e,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=a.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=a.contentScaleFactor),e}}])&&Pe(i.prototype,n),s&&Pe(i,s),a}(f),Ue=window.performance,Be=function(e){var t,r;function a(t){return e.call(this,t,l.a.MEDIA_ATTACHING)||this}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=a.prototype;return i.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},i.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof this.hls.config.cnxRenderWindow.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},i.checkFPS=function(e,t,r){var a=Ue.now();if(t){if(this.lastTime){var i=a-this.lastTime,n=r-this.lastDroppedFrames,s=t-this.lastDecodedFrames,o=1e3*n/i,u=this.hls;if(u.trigger(l.a.FPS_DROP,{currentDropped:n,currentDecoded:s,totalDroppedFrames:r}),o>0&&n>u.config.fpsDroppedMonitoringThreshold*s){var f=u.currentLevel;d.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+f),f>0&&(-1===u.autoLevelCapping||u.autoLevelCapping>=f)&&(f-=1,u.trigger(l.a.FPS_DROP_LEVEL_CAPPING,{level:f,droppedLevel:u.currentLevel}),u.autoLevelCapping=f,u.streamController.nextLevelSwitch())}}this.lastTime=a,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},i.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},a}(f),Ne=window,Ge=Ne.performance,je=Ne.XMLHttpRequest,Ke=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}var t=e.prototype;return t.destroy=function(){this.abort(),this.loader=null},t.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.load=function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:Ge.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e,t=this.context;e=this.loader=new je;var r=this.stats;r.tfirst=0,r.loaded=0;var a=this.xhrSetup;try{if(a)try{a(e,t.url)}catch(r){e.open("GET",t.url,!0),a(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(r){return void this.callbacks.onError({code:e.status,text:r.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},t.readystatechange=function(e){var t=e.currentTarget,r=t.readyState,a=this.stats,i=this.context,n=this.config;if(!a.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===a.tfirst&&(a.tfirst=Math.max(Ge.now(),a.trequest)),4===r){var s=t.status;if(s>=200&&s<300){var o,l;a.tload=Math.max(a.tfirst,Ge.now()),l="arraybuffer"===i.responseType?(o=t.response).byteLength:(o=t.responseText).length,a.loaded=a.total=l;var u={url:t.responseURL,data:o};this.callbacks.onSuccess(u,a,i,t)}else a.retry>=n.maxRetry||s>=400&&s<499?(d.b.error(s+" while loading "+i.url),this.callbacks.onError({code:s,text:t.statusText},i,t)):(d.b.warn(s+" while loading "+i.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,n.maxRetryDelay),a.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),n.timeout)},t.loadtimeout=function(){d.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.loadprogress=function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var a=this.callbacks.onProgress;a&&a(r,this.context,null,t)},e}();r(6),function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready"}(Me||(Me={}));var He=function(){var e=window.cnxRenderWindow;return void 0!==e&&e.navigator&&e.navigator.requestMediaKeySystemAccess?e.navigator.requestMediaKeySystemAccess.bind(e.navigator):null}();function Ve(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var We=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){Ve(e,t,r[t])})}return e}({cnxRenderWindow:window,autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Ke,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:Oe,bufferController:Ce,capLevelController:Fe,fpsController:Be,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:He},{},{subtitleStreamController:void 0,subtitleTrackController:void 0,timelineController:void 0,audioStreamController:void 0,audioTrackController:void 0,emeController:void 0});function Ye(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xe(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function qe(e,t,r){return t&&Xe(e.prototype,t),r&&Xe(e,r),e}r.d(t,"default",function(){return Qe});var Qe=function(e){var t,r;function a(t){var r;void 0===t&&(t={}),(r=e.call(this)||this).config=void 0,r._autoLevelCapping=void 0,r.abrController=void 0,r.capLevelController=void 0,r.levelController=void 0,r.streamController=void 0,r.networkControllers=void 0,r.audioTrackController=void 0,r.subtitleTrackController=void 0,r.emeController=void 0,r.coreComponents=void 0,r.media=null,r.url=null;var i=a.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");r.config=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){Ye(e,t,r[t])})}return e}({},i,t),window.cnxRenderWindow=r.config.cnxRenderWindow;var n=ze(r).config;if(void 0!==n.liveMaxLatencyDurationCount&&n.liveMaxLatencyDurationCount<=n.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==n.liveMaxLatencyDuration&&(void 0===n.liveSyncDuration||n.liveMaxLatencyDuration<=n.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(d.a)(n.debug),r._autoLevelCapping=-1;var s=r.abrController=new n.abrController(ze(r)),o=new n.bufferController(ze(r)),l=r.capLevelController=new n.capLevelController(ze(r)),u=new n.fpsController(ze(r)),f=new C(ze(r)),h=new P(ze(r)),c=new F(ze(r)),v=new Le(ze(r)),p=r.levelController=new Ae(ze(r)),g=new G(ze(r)),m=[p,r.streamController=new Ee(ze(r),g)],y=n.audioStreamController;y&&m.push(new y(ze(r),g)),r.networkControllers=m;var b=[f,h,c,s,o,l,u,v,g];if(y=n.audioTrackController){var E=new y(ze(r));r.audioTrackController=E,b.push(E)}if(y=n.subtitleTrackController){var T=new y(ze(r));r.subtitleTrackController=T,m.push(T)}if(y=n.emeController){var S=new y(ze(r));r.emeController=S,b.push(S)}return(y=n.subtitleStreamController)&&m.push(new y(ze(r),g)),(y=n.timelineController)&&b.push(new y(ze(r))),r.coreComponents=b,r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.isSupported=function(){return function(){var e=Y();if(!e)return!1;var t=self.SourceBuffer||self.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),a=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!r&&!!a}()},qe(a,null,[{key:"version",get:function(){}},{key:"Events",get:function(){return l.a}},{key:"ErrorTypes",get:function(){return s.b}},{key:"ErrorDetails",get:function(){return s.a}},{key:"DefaultConfig",get:function(){return a.defaultConfig?a.defaultConfig:We},set:function(e){a.defaultConfig=e}}]);var i=a.prototype;return i.destroy=function(){d.b.log("destroy"),this.trigger(l.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},i.attachMedia=function(e){d.b.log("attachMedia"),this.media=e,this.trigger(l.a.MEDIA_ATTACHING,{media:e})},i.detachMedia=function(){d.b.log("detachMedia"),this.trigger(l.a.MEDIA_DETACHING),this.media=null},i.loadSource=function(e){e=n.buildAbsoluteURL(this.config.cnxRenderWindow.location.href,e,{alwaysNormalize:!0}),d.b.log("loadSource:"+e),this.url=e,this.trigger(l.a.MANIFEST_LOADING,{url:e})},i.startLoad=function(e){void 0===e&&(e=-1),d.b.log("startLoad("+e+")"),this.networkControllers.forEach(function(t){t.startLoad(e)})},i.stopLoad=function(){d.b.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},i.swapAudioCodec=function(){d.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},i.recoverMediaError=function(){d.b.log("recoverMediaError");var e=this.media;this.detachMedia(),e&&this.attachMedia(e)},qe(a,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){d.b.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){d.b.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){d.b.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){d.b.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){d.b.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){d.b.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"bandwidthEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,a=0;a<r;a++)if((e[a].realBitrate?Math.max(e[a].realBitrate,e[a].bitrate):e[a].bitrate)>t)return a;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),a}(X);Qe.defaultConfig=void 0}]).default)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",function(){return ExperienceApiEventsEnum}),__webpack_require__.d(__webpack_exports__,"d",function(){return SDKDebuggingEvents}),__webpack_require__.d(__webpack_exports__,"b",function(){return CommonApiEventsEnum}),__webpack_require__.d(__webpack_exports__,"a",function(){return ApiErrorsEnum});var ApiErrorsEnum,ExperienceApiEventsEnum={FullscreenChanged:"fullscreenChanged",PlayerFloatChanged:"playerFloatChanged"},SDKDebuggingEvents={OmidViewabilityThreshold:"OmidViewabilityThreshold"},CommonApiEventsEnum=Object.assign(Object.assign(Object.assign(Object.assign({Ready:"ready",Removed:"removed",SetupError:"setupError",IsViewable:"isViewable",SizeChanged:"sizeChanged",BrandingClicked:"brandingClicked",ImpressionPrice:"impressionPrice",ImpressionRevenue:"impressionRevenue"},{Play:"play",Pause:"pause",QualityChanged:"qualityChanged",PlayError:"playError",VolumeChanged:"volumeChanged"}),ExperienceApiEventsEnum),SDKDebuggingEvents),{AdClick:"adClick",AdPlay:"adPlay",AdPause:"adPause",AdImpression:"adImpression",AdCompleted25:"adCompleted25",AdCompleted50:"adCompleted50",AdCompleted75:"adCompleted75",AdCompleted100:"adCompleted100",AdSkipped:"adSkipped",AdError:"adError",AdStopped:"adStopped",AdCompanion:"adCompanion"});!function(ApiErrorsEnum){ApiErrorsEnum.SetupError="SetupError",ApiErrorsEnum.NoPlayer="NoPlayer",ApiErrorsEnum.RenderError="RenderError"}(ApiErrorsEnum||(ApiErrorsEnum={}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return getQueryParam}),__webpack_require__.d(__webpack_exports__,"e",function(){return updateQuerryParams}),__webpack_require__.d(__webpack_exports__,"c",function(){return getQueryParamSeparator}),__webpack_require__.d(__webpack_exports__,"a",function(){return extractDomain}),__webpack_require__.d(__webpack_exports__,"d",function(){return stripAmpUrl});var Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4),AMP_CACHE_URL=".cdn.ampproject.org";function getQueryParam(name,url){url||(url=location.search),name=name.replace(/\[/,"\\[").replace(/]/,"\\]");var results=new RegExp("[\\?&]".concat(name,"=([^&#]*)"),"i").exec(url);return null===results?null:decodeURIComponent(results[1])}function updateQuerryParams(uri,key,value){var re=new RegExp("([?&])".concat(key,"=.*?(&|$)"),"i"),separator=-1!==uri.indexOf("?")?"&":"?";return uri.match(re)?value?uri.replace(re,"$1".concat(key,"=").concat(value,"$2")):uri.replace(re,"$1"):"".concat(uri).concat(separator).concat(key,"=").concat(value)}function getQueryParamSeparator(url){return url.indexOf("?")>-1?"&":"?"}function extractDomain(url){if(Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_0__.h)(url))return url.indexOf("://")>-1?url.split("/")[2]:url.split("/")[0]}function getAmpPageWithProtocol(ampPageUrl,originalPageUrl){var isOriginalPageHttps=/(\/s\/)+/.test(ampPageUrl.replace(originalPageUrl,""));return"".concat("http"+(isOriginalPageHttps?"s":""),"://").concat(originalPageUrl)}function stripAmpUrl(pageUrl){var extractEncodedUrl=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return pageUrl=function(pageUrl){return-1===pageUrl.indexOf(AMP_CACHE_URL)?pageUrl:(pageUrl=(pageUrl=(pageUrl=(pageUrl=(pageUrl=(pageUrl=(pageUrl=pageUrl.replace(AMP_CACHE_URL,"")).replace("www-","www.")).replace("amp-","amp.")).cnx_replaceAll("--","=")).cnx_replaceAll("-",".")).cnx_replaceAll("=","-")).replace("www.","amp.")).indexOf("amp.")>-1?pageUrl:pageUrl=(pageUrl=pageUrl.replace("http://","".concat("http://").concat("amp."))).replace("https://","".concat("https://").concat("amp."))}(pageUrl=function(pageUrl){var regExExec=/^https:\/\/www.google\..*?\/amp\/s*\/*/.exec(pageUrl);if(null!==regExExec){var originalPageUrl=pageUrl.replace(regExExec[0],"");return getAmpPageWithProtocol(pageUrl,originalPageUrl)}return pageUrl}(pageUrl=function(pageUrl){if(pageUrl.indexOf(AMP_CACHE_URL)>-1){pageUrl=pageUrl.replace("https://","");var everythingBeforeOriginalPageRegex=/^[^\/]+(\/[a-z]+\/)+s*\/*/,originalPageUrl=everythingBeforeOriginalPageRegex.test(pageUrl)?pageUrl.replace(everythingBeforeOriginalPageRegex.exec(pageUrl)[0],""):pageUrl;return getAmpPageWithProtocol(pageUrl,originalPageUrl)}return pageUrl}(pageUrl))),extractEncodedUrl&&(pageUrl=function(pageUrl){if(-1===pageUrl.indexOf("#origin-")&&-1===pageUrl.indexOf("viewerUrl-"))return pageUrl;var partial=pageUrl.split("#origin-")[1].split("viewerUrl-");return stripAmpUrl(pageUrl=decodeURIComponent(partial[1]),!1)}(pageUrl)),pageUrl}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return EXPORTED_CONFIG}),__webpack_require__.d(__webpack_exports__,"b",function(){return IS_ES6});var EXPORTED_CONFIG=JSON.parse('{"version":125328,"domainPrefix":"","logToConsole":false,"logToServer":true,"env":"production"}'),IS_ES6=!1},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Mediator});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(13),Mediator=function(){function Mediator(){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,Mediator),this._channels={}}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(Mediator,[{key:"subscribe",value:function(channel,context,func){this._channels[channel]||(this._channels[channel]=[]),this._channels[channel].push({context:context,func:func})}},{key:"unsubscribe",value:function(channel,context,func){this._channels[channel]&&(this._channels[channel]=this._channels[channel].filter(function(elem){return!(elem.context===context&&(elem.func===func||!func))}))}},{key:"unsubscribeAll",value:function(context){var _this=this;Object.keys(this._channels).forEach(function(channel){_this._channels[channel]=_this._channels[channel].filter(function(elem){return elem.context!==context})})}},{key:"publish",value:function(context,channel){var data=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{payload:void 0};Object.prototype.hasOwnProperty.call(this._channels,channel)&&this._channels[channel].forEach(function(element){element.context===context&&element.func(data)})}},{key:"relay",value:function(channel,source,currentContext,parentMediator){var _this2=this;Object(Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_2__.m)(channel).forEach(function(event){_this2.subscribe(event,source,function(data){parentMediator.publish(currentContext,event,data)})})}},{key:"relayBulk",value:function(relayList,currentContext,parentMediator){var _this3=this;relayList.forEach(function(relay){_this3.relay(relay.channel,relay.source,currentContext,parentMediator)})}}]),Mediator}()},function(module,__webpack_exports__,__webpack_require__){"use strict";var AxisEnum,InteractionEventEnum,SpecialInteractionEnum,UiSwipeDirectionEnum;__webpack_require__.d(__webpack_exports__,"a",function(){return AxisEnum}),__webpack_require__.d(__webpack_exports__,"b",function(){return InteractionEventEnum}),__webpack_require__.d(__webpack_exports__,"c",function(){return SpecialInteractionEnum}),__webpack_require__.d(__webpack_exports__,"d",function(){return UiSwipeDirectionEnum}),function(AxisEnum){AxisEnum[AxisEnum.X=0]="X",AxisEnum[AxisEnum.Y=1]="Y"}(AxisEnum||(AxisEnum={})),function(InteractionEventEnum){InteractionEventEnum.Click="click",InteractionEventEnum.InteractionStart="interactionstart",InteractionEventEnum.Interaction="interaction",InteractionEventEnum.InteractionEnd="interactionend"}(InteractionEventEnum||(InteractionEventEnum={})),function(SpecialInteractionEnum){SpecialInteractionEnum[SpecialInteractionEnum.Swipe=0]="Swipe",SpecialInteractionEnum[SpecialInteractionEnum.Hold=1]="Hold"}(SpecialInteractionEnum||(SpecialInteractionEnum={})),function(UiSwipeDirectionEnum){UiSwipeDirectionEnum[UiSwipeDirectionEnum.Left=0]="Left",UiSwipeDirectionEnum[UiSwipeDirectionEnum.Right=1]="Right"}(UiSwipeDirectionEnum||(UiSwipeDirectionEnum={}))},function(module,__webpack_exports__,__webpack_require__){"use strict";var ExperienceTrackings;__webpack_require__.d(__webpack_exports__,"c",function(){return ExperienceTrackings}),__webpack_require__.d(__webpack_exports__,"b",function(){return ExperienceEventsEnum}),__webpack_require__.d(__webpack_exports__,"a",function(){return BaseExperienceEventsEnum}),function(ExperienceTrackings){ExperienceTrackings.SessionRendered="rendered",ExperienceTrackings.SessionView="enter_view"}(ExperienceTrackings||(ExperienceTrackings={}));var ExperienceEventsEnum={UserInteraction:"userInteraction",GeneralUserInteraction:"generalUserInteraction",CanStart:"canStart",Destroy:"destroy"},BaseExperienceEventsEnum={StateChanged:"stateChanged"}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return __extends});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)};function __extends(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return MOBILE_DEVICES}),__webpack_require__.d(__webpack_exports__,"b",function(){return OSEnum});var OSEnum,_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),MOBILE_DEVICES=[_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_0__.ProtoDeviceType.Smartphone,_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_0__.ProtoDeviceType.Tablet];!function(OSEnum){OSEnum.Ios="ios",OSEnum.Android="android",OSEnum.Mac="macos",OSEnum.Windows="windows",OSEnum.Linux="linux"}(OSEnum||(OSEnum={}))},function(module,__webpack_exports__,__webpack_require__){"use strict";var UserConsentApiEnum;__webpack_require__.d(__webpack_exports__,"a",function(){return UserConsentApiEnum}),function(UserConsentApiEnum){UserConsentApiEnum[UserConsentApiEnum.CmpApi=0]="CmpApi",UserConsentApiEnum[UserConsentApiEnum.TcfApi=1]="TcfApi"}(UserConsentApiEnum||(UserConsentApiEnum={}))},function(module,__webpack_exports__,__webpack_require__){"use strict";var BrowsersEnum,Vendors;__webpack_require__.d(__webpack_exports__,"a",function(){return BrowsersEnum}),__webpack_require__.d(__webpack_exports__,"d",function(){return Vendors}),__webpack_require__.d(__webpack_exports__,"b",function(){return FullscreenVendors}),__webpack_require__.d(__webpack_exports__,"c",function(){return OpenTargetEnum}),function(BrowsersEnum){BrowsersEnum.Chrome="chrome",BrowsersEnum.Firefox="firefox",BrowsersEnum.Edge="edge",BrowsersEnum.Safari="safari",BrowsersEnum.Opera="opera",BrowsersEnum.Samsung="samsung",BrowsersEnum.Facebook="facebook",BrowsersEnum.InternetExplorer="ie"}(BrowsersEnum||(BrowsersEnum={})),function(Vendors){Vendors.Standard="standard",Vendors.Webkit="webkit",Vendors.Moz="moz",Vendors.Ms="ms",Vendors.O="o"}(Vendors||(Vendors={}));var OpenTargetEnum,FullscreenVendors=[{name:Vendors.Standard,keys:{fullscreenEnabled:"fullscreenEnabled",fullscreenElement:"fullscreenElement",requestFullscreen:"requestFullscreen",exitFullscreen:"exitFullscreen",fullscreenchange:"fullscreenchange",fullscreenerror:"fullscreenerror"}},{name:Vendors.Webkit,keys:{fullscreenEnabled:"webkitFullscreenEnabled",fullscreenElement:"webkitFullscreenElement",requestFullscreen:"webkitRequestFullscreen",exitFullscreen:"webkitExitFullscreen",fullscreenchange:"webkitfullscreenchange",fullscreenerror:"webkitfullscreenerror"}},{name:Vendors.Webkit,keys:{fullscreenEnabled:"webkitSupportsFullscreen",fullscreenElement:"webkitFullscreenElement",requestFullscreen:"webkitEnterFullscreen",exitFullscreen:"webkitExitFullscreen",fullscreenchange:"webkitfullscreenchange",fullscreenerror:"webkitfullscreenerror"}},{name:Vendors.Moz,keys:{fullscreenEnabled:"mozFullScreenEnabled",fullscreenElement:"mozFullScreenElement",requestFullscreen:"mozRequestFullScreen",exitFullscreen:"mozCancelFullScreen",fullscreenchange:"mozfullscreenchange",fullscreenerror:"mozfullscreenerror"}},{name:Vendors.Ms,keys:{fullscreenEnabled:"msFullscreenEnabled",fullscreenElement:"msFullscreenElement",requestFullscreen:"msRequestFullscreen",exitFullscreen:"msExitFullscreen",fullscreenchange:"MSFullscreenChange",fullscreenerror:"MSFullscreenError"}}];!function(OpenTargetEnum){OpenTargetEnum.Self="_self",OpenTargetEnum.Blank="_blank",OpenTargetEnum.Parent="_parent",OpenTargetEnum.Top="_top"}(OpenTargetEnum||(OpenTargetEnum={}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return XhrUtils});var XhrUtils,_Logging__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(11),Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(15),Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(4),Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(26);!function(XhrUtils){var xhrRequestTimeout=3e4;function _fetchXhttpRequest(xhttpRequestSettings,requestBody){var request=function(_ref){var requestUrl=_ref.requestUrl,_ref$requestType=_ref.requestType,requestType=void 0===_ref$requestType?"POST":_ref$requestType,_ref$contentType=_ref.contentType,contentType=void 0===_ref$contentType?"":_ref$contentType,_ref$responseType=_ref.responseType,responseType=void 0===_ref$responseType?"":_ref$responseType,_ref$withCredentials=_ref.withCredentials,withCredentials=void 0!==_ref$withCredentials&&_ref$withCredentials,request=new XMLHttpRequest;return request.open(requestType,requestUrl,!0),contentType.length>0&&request.setRequestHeader("Content-Type",contentType),responseType.length>0&&(request.responseType=responseType),request.timeout=xhrRequestTimeout,request.withCredentials=withCredentials,request}(xhttpRequestSettings),startDate=new Date;return new Promise(function(resolve,reject){request.onreadystatechange=function(){if(request.readyState===XMLHttpRequest.DONE)if(200===request.status)resolve(request.response);else{var responseText="";try{responseText=request.responseText}catch(e){}var spentTime=(new Date).getTime()-startDate.getTime();reject(new Error("Request fail. status:".concat(request.status,", readyState:").concat(request.readyState,", response:").concat(responseText,", time:").concat(spentTime)))}},request.ontimeout=function(){var spentTime=(new Date).getTime()-startDate.getTime();reject(new Error("Request timeout status:".concat(request.status,". time:").concat(spentTime)))},request.send(requestBody)})}function _getProtoEncodedRequestData(ProtoRequest,requestData,requestUrl){try{var shouldLog=Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_2__.l)([95,5]);!shouldLog||requestData&&0!==Object.keys(requestData).length||Object(_Logging__WEBPACK_IMPORTED_MODULE_0__.a)({message:"empty_proto_request",callStack:"empty_function_argument",exception:requestUrl,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__.ProtoLoggingLevelEnum.INFO,sendMaxLog:!1});var request=ProtoRequest.fromObject(requestData);!shouldLog||request&&0!==Object.keys(request).length||Object(_Logging__WEBPACK_IMPORTED_MODULE_0__.a)({message:"empty_proto_request",callStack:"empty_fromObject_result",exception:requestUrl,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__.ProtoLoggingLevelEnum.INFO,sendMaxLog:!1});var encodeResult=ProtoRequest.encode(request).finish();return!shouldLog||encodeResult&&0!==Object.keys(encodeResult).length||Object(_Logging__WEBPACK_IMPORTED_MODULE_0__.a)({message:"empty_proto_request",callStack:"empty_encode_result",exception:requestUrl,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__.ProtoLoggingLevelEnum.INFO,sendMaxLog:!1}),encodeResult}catch(e){throw Object(_Logging__WEBPACK_IMPORTED_MODULE_0__.a)({throttle:10,sendMaxLog:!0,exception:requestUrl,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__.ProtoLoggingLevelEnum.FATAL,callStack:JSON.stringify(requestData),message:"Protobuf_encode"}),Error()}}function _fetchProtobufRequest(ProtoInterface,requestUrl){var requestType=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",requestBody=arguments.length>3?arguments[3]:void 0;return function(ProtoInterface,responsePromise,requestUrl){return new Promise(function(resolve,reject){responsePromise.then(function(data){if(ProtoInterface){var decodedMessage=null;try{var sanitizedData=data?new Uint8Array(data):new Uint8Array;decodedMessage=ProtoInterface.toObject(ProtoInterface.decode(sanitizedData),{defaults:!0,arrays:!0,objects:!0})}catch(e){Object(_Logging__WEBPACK_IMPORTED_MODULE_0__.a)({exception:"".concat(requestUrl,"__").concat(e.message),message:"Protobuf_decode",callStack:e.stack,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__.ProtoLoggingLevelEnum.WARNING,sendMaxLog:!0,throttle:100})}decodedMessage&&decodedMessage.errorMessage&&"500"===decodedMessage.errorMessage&&reject(decodedMessage.errorMessage),resolve(decodedMessage)}}).catch(function(message){reject(message)})})}(ProtoInterface,_fetchXhttpRequest({requestUrl:requestUrl,requestType:requestType,withCredentials:arguments.length>4?arguments[4]:void 0,contentType:"POST"===requestType?"multipart/form-data":"",responseType:"arraybuffer"},requestBody),requestUrl)}XhrUtils.fetchXMLRequest=function(requestUrl){var xmlRequestPromise=_fetchXhttpRequest({requestUrl:requestUrl,requestType:"GET",withCredentials:!(arguments.length>1&&void 0!==arguments[1])||arguments[1]});return new Promise(function(resolve,reject){xmlRequestPromise.then(function(data){resolve(data)}).catch(function(message){reject(message)})})},XhrUtils.sendProtoRequest=function(_ref2){var ProtoResponse=_ref2.ProtoResponse,ProtoRequest=_ref2.ProtoRequest,requestData=_ref2.requestData,endpoint=_ref2.endpoint,requestType=_ref2.requestType,withCredentials=_ref2.withCredentials,queryParams=_ref2.queryParams,logError=_ref2.logError,encodedRequest=requestData?_getProtoEncodedRequestData(ProtoRequest,requestData,endpoint):null;return _fetchProtobufRequest(ProtoResponse,endpoint=function(endpoint,queryParams){return Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.f)(queryParams)?(Object.keys(queryParams).forEach(function(key){return endpoint=Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_4__.e)(endpoint,key,queryParams[key])}),endpoint):endpoint}(endpoint,queryParams),requestType,encodedRequest,withCredentials).catch(function(reason){throw logError&&Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_2__.l)([95,5])&&Object(_Logging__WEBPACK_IMPORTED_MODULE_0__.a)({message:"Xhr_error",exception:endpoint,callStack:"".concat(reason),level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__.ProtoLoggingLevelEnum.INFO}),new Error(reason)})},XhrUtils.sendProtoBeaconRequest=function(_ref3){var ProtoRequest=_ref3.ProtoRequest,requestData=_ref3.requestData,endpoint=_ref3.endpoint,encodedRequest=requestData?_getProtoEncodedRequestData(ProtoRequest,requestData,endpoint):null;return navigator.sendBeacon(endpoint,encodedRequest)},XhrUtils.trackPixel=function(url){try{(new Image).src=url}catch(e){Object(_Logging__WEBPACK_IMPORTED_MODULE_0__.a)({message:"Xhr_trackPixel",exception:e.message,callStack:e.stack,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__.ProtoLoggingLevelEnum.FATAL})}}}(XhrUtils||(XhrUtils={}))},function(module,exports,__webpack_require__){"use strict";var valuesById,values,$protobuf=__webpack_require__(121),$Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots.default||($protobuf.roots.default={});$root.ProtoElementsRequest=function(){function ProtoElementsRequest(properties){if(this.tokens=[],this.forceLineItemIds=[],this.queryJsTargeting={},this.reloadedPlayers={},properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoElementsRequest.prototype.tokens=$util.emptyArray,ProtoElementsRequest.prototype.pageUrl="",ProtoElementsRequest.prototype.userId="",ProtoElementsRequest.prototype.forcePlayerId="",ProtoElementsRequest.prototype.forceMediaId="",ProtoElementsRequest.prototype.forcePlaylistId="",ProtoElementsRequest.prototype.version=0,ProtoElementsRequest.prototype.forceLineItemIds=$util.emptyArray,ProtoElementsRequest.prototype.clientAb0=0,ProtoElementsRequest.prototype.clientAb1=0,ProtoElementsRequest.prototype.customParam1="",ProtoElementsRequest.prototype.customParam2="",ProtoElementsRequest.prototype.customParam3="",ProtoElementsRequest.prototype.forceExploration=!1,ProtoElementsRequest.prototype.es6=!1,ProtoElementsRequest.prototype.bundleId="",ProtoElementsRequest.prototype.forceSourceItemId="",ProtoElementsRequest.prototype.parseDomain=!1,ProtoElementsRequest.prototype.implementationType=0,ProtoElementsRequest.prototype.queryJsTargeting=$util.emptyObject,ProtoElementsRequest.prototype.isConsentConnatix=!0,ProtoElementsRequest.prototype.reloadedPlayers=$util.emptyObject,ProtoElementsRequest.prototype.disableTracking=!1,ProtoElementsRequest.prototype.referrer="",ProtoElementsRequest.prototype.localTimestamp=$util.Long?$util.Long.fromBits(0,0,!1):0,ProtoElementsRequest.prototype.customParam4="",ProtoElementsRequest.prototype.customParam5="",ProtoElementsRequest.encode=function(message,writer){if(writer||(writer=$Writer.create()),null!=message.tokens&&message.tokens.length)for(var i=0;i<message.tokens.length;++i)writer.uint32(10).string(message.tokens[i]);if(null!=message.pageUrl&&Object.hasOwnProperty.call(message,"pageUrl")&&writer.uint32(26).string(message.pageUrl),null!=message.userId&&Object.hasOwnProperty.call(message,"userId")&&writer.uint32(42).string(message.userId),null!=message.forcePlayerId&&Object.hasOwnProperty.call(message,"forcePlayerId")&&writer.uint32(58).string(message.forcePlayerId),null!=message.forceMediaId&&Object.hasOwnProperty.call(message,"forceMediaId")&&writer.uint32(66).string(message.forceMediaId),null!=message.forcePlaylistId&&Object.hasOwnProperty.call(message,"forcePlaylistId")&&writer.uint32(74).string(message.forcePlaylistId),null!=message.version&&Object.hasOwnProperty.call(message,"version")&&writer.uint32(80).int32(message.version),null!=message.forceLineItemIds&&message.forceLineItemIds.length)for(i=0;i<message.forceLineItemIds.length;++i)writer.uint32(90).string(message.forceLineItemIds[i]);if(null!=message.clientAb0&&Object.hasOwnProperty.call(message,"clientAb0")&&writer.uint32(96).int32(message.clientAb0),null!=message.clientAb1&&Object.hasOwnProperty.call(message,"clientAb1")&&writer.uint32(104).int32(message.clientAb1),null!=message.customParam1&&Object.hasOwnProperty.call(message,"customParam1")&&writer.uint32(130).string(message.customParam1),null!=message.customParam2&&Object.hasOwnProperty.call(message,"customParam2")&&writer.uint32(138).string(message.customParam2),null!=message.customParam3&&Object.hasOwnProperty.call(message,"customParam3")&&writer.uint32(146).string(message.customParam3),null!=message.forceExploration&&Object.hasOwnProperty.call(message,"forceExploration")&&writer.uint32(160).bool(message.forceExploration),null!=message.es6&&Object.hasOwnProperty.call(message,"es6")&&writer.uint32(168).bool(message.es6),null!=message.bundleId&&Object.hasOwnProperty.call(message,"bundleId")&&writer.uint32(178).string(message.bundleId),null!=message.forceSourceItemId&&Object.hasOwnProperty.call(message,"forceSourceItemId")&&writer.uint32(186).string(message.forceSourceItemId),null!=message.parseDomain&&Object.hasOwnProperty.call(message,"parseDomain")&&writer.uint32(192).bool(message.parseDomain),null!=message.implementationType&&Object.hasOwnProperty.call(message,"implementationType")&&writer.uint32(200).int32(message.implementationType),null!=message.queryJsTargeting&&Object.hasOwnProperty.call(message,"queryJsTargeting")){var keys=Object.keys(message.queryJsTargeting);for(i=0;i<keys.length;++i)writer.uint32(210).fork().uint32(10).string(keys[i]).uint32(18).string(message.queryJsTargeting[keys[i]]).ldelim()}if(null!=message.isConsentConnatix&&Object.hasOwnProperty.call(message,"isConsentConnatix")&&writer.uint32(216).bool(message.isConsentConnatix),null!=message.reloadedPlayers&&Object.hasOwnProperty.call(message,"reloadedPlayers"))for(keys=Object.keys(message.reloadedPlayers),i=0;i<keys.length;++i)writer.uint32(234).fork().uint32(10).string(keys[i]).uint32(18).string(message.reloadedPlayers[keys[i]]).ldelim();return null!=message.disableTracking&&Object.hasOwnProperty.call(message,"disableTracking")&&writer.uint32(248).bool(message.disableTracking),null!=message.referrer&&Object.hasOwnProperty.call(message,"referrer")&&writer.uint32(258).string(message.referrer),null!=message.localTimestamp&&Object.hasOwnProperty.call(message,"localTimestamp")&&writer.uint32(264).int64(message.localTimestamp),null!=message.customParam4&&Object.hasOwnProperty.call(message,"customParam4")&&writer.uint32(274).string(message.customParam4),null!=message.customParam5&&Object.hasOwnProperty.call(message,"customParam5")&&writer.uint32(282).string(message.customParam5),writer},ProtoElementsRequest.fromObject=function(object){if(object instanceof $root.ProtoElementsRequest)return object;var message=new $root.ProtoElementsRequest;if(object.tokens){if(!Array.isArray(object.tokens))throw TypeError(".ProtoElementsRequest.tokens: array expected");message.tokens=[];for(var i=0;i<object.tokens.length;++i)message.tokens[i]=String(object.tokens[i])}if(null!=object.pageUrl&&(message.pageUrl=String(object.pageUrl)),null!=object.userId&&(message.userId=String(object.userId)),null!=object.forcePlayerId&&(message.forcePlayerId=String(object.forcePlayerId)),null!=object.forceMediaId&&(message.forceMediaId=String(object.forceMediaId)),null!=object.forcePlaylistId&&(message.forcePlaylistId=String(object.forcePlaylistId)),null!=object.version&&(message.version=0|object.version),object.forceLineItemIds){if(!Array.isArray(object.forceLineItemIds))throw TypeError(".ProtoElementsRequest.forceLineItemIds: array expected");message.forceLineItemIds=[];for(i=0;i<object.forceLineItemIds.length;++i)message.forceLineItemIds[i]=String(object.forceLineItemIds[i])}switch(null!=object.clientAb0&&(message.clientAb0=0|object.clientAb0),null!=object.clientAb1&&(message.clientAb1=0|object.clientAb1),null!=object.customParam1&&(message.customParam1=String(object.customParam1)),null!=object.customParam2&&(message.customParam2=String(object.customParam2)),null!=object.customParam3&&(message.customParam3=String(object.customParam3)),null!=object.forceExploration&&(message.forceExploration=Boolean(object.forceExploration)),null!=object.es6&&(message.es6=Boolean(object.es6)),null!=object.bundleId&&(message.bundleId=String(object.bundleId)),null!=object.forceSourceItemId&&(message.forceSourceItemId=String(object.forceSourceItemId)),null!=object.parseDomain&&(message.parseDomain=Boolean(object.parseDomain)),object.implementationType){case"Web":case 0:message.implementationType=0;break;case"Amp":case 1:message.implementationType=1}if(object.queryJsTargeting){if("object"!=typeof object.queryJsTargeting)throw TypeError(".ProtoElementsRequest.queryJsTargeting: object expected");message.queryJsTargeting={};var keys=Object.keys(object.queryJsTargeting);for(i=0;i<keys.length;++i)message.queryJsTargeting[keys[i]]=String(object.queryJsTargeting[keys[i]])}if(null!=object.isConsentConnatix&&(message.isConsentConnatix=Boolean(object.isConsentConnatix)),object.reloadedPlayers){if("object"!=typeof object.reloadedPlayers)throw TypeError(".ProtoElementsRequest.reloadedPlayers: object expected");message.reloadedPlayers={};for(keys=Object.keys(object.reloadedPlayers),i=0;i<keys.length;++i)message.reloadedPlayers[keys[i]]=String(object.reloadedPlayers[keys[i]])}return null!=object.disableTracking&&(message.disableTracking=Boolean(object.disableTracking)),null!=object.referrer&&(message.referrer=String(object.referrer)),null!=object.localTimestamp&&($util.Long?(message.localTimestamp=$util.Long.fromValue(object.localTimestamp)).unsigned=!1:"string"==typeof object.localTimestamp?message.localTimestamp=parseInt(object.localTimestamp,10):"number"==typeof object.localTimestamp?message.localTimestamp=object.localTimestamp:"object"==typeof object.localTimestamp&&(message.localTimestamp=new $util.LongBits(object.localTimestamp.low>>>0,object.localTimestamp.high>>>0).toNumber())),null!=object.customParam4&&(message.customParam4=String(object.customParam4)),null!=object.customParam5&&(message.customParam5=String(object.customParam5)),message},ProtoElementsRequest.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},ProtoElementsRequest}(),$root.ProtoPlaylistItem=function(){function ProtoPlaylistItem(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlaylistItem.prototype.mediaId="",ProtoPlaylistItem.prototype.revisionNumber=0,ProtoPlaylistItem.prototype.mediaContentVersionId="",ProtoPlaylistItem.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlaylistItem;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.mediaId=reader.string();break;case 2:message.revisionNumber=reader.int32();break;case 3:message.mediaContentVersionId=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoPlaylistItem.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.mediaId="",object.revisionNumber=0,object.mediaContentVersionId=""),null!=message.mediaId&&message.hasOwnProperty("mediaId")&&(object.mediaId=message.mediaId),null!=message.revisionNumber&&message.hasOwnProperty("revisionNumber")&&(object.revisionNumber=message.revisionNumber),null!=message.mediaContentVersionId&&message.hasOwnProperty("mediaContentVersionId")&&(object.mediaContentVersionId=message.mediaContentVersionId),object},ProtoPlaylistItem}(),$root.ProtoElements=function(){function ProtoElements(properties){if(this.sharingDestinations=[],this.floatingDeviceMode=[],this.lineItems=[],this.playlist=[],this.adBreaks=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoElements.prototype.playerId="",ProtoElements.prototype.playbackMode=0,ProtoElements.prototype.soundMode=0,ProtoElements.prototype.upNextMode=1,ProtoElements.prototype.containerSelector="",ProtoElements.prototype.position=0,ProtoElements.prototype.insertPosition=0,ProtoElements.prototype.forceInsertPath=!1,ProtoElements.prototype.renderInFrame=!1,ProtoElements.prototype.scrollHijackingProtection=!1,ProtoElements.prototype.preRollBreak=0,ProtoElements.prototype.postRollBreak=0,ProtoElements.prototype.midRollNumber=-1,ProtoElements.prototype.timeBetweenAds=0,ProtoElements.prototype.minTimeBeforeFirstAd=0,ProtoElements.prototype.adViewabilityPolicy=0,ProtoElements.prototype.responsive=!1,ProtoElements.prototype.ratioWidth=0,ProtoElements.prototype.ratioHeight=0,ProtoElements.prototype.fixedWidth=0,ProtoElements.prototype.fixedHeight=0,ProtoElements.prototype.casting=!1,ProtoElements.prototype.sharingDestinations=$util.emptyArray,ProtoElements.prototype.closedCaption=!1,ProtoElements.prototype.muteWatermark=!1,ProtoElements.prototype.expandButton=!1,ProtoElements.prototype.closeButtonMode=0,ProtoElements.prototype.floatingMode=0,ProtoElements.prototype.floatingDeviceMode=$util.emptyArray,ProtoElements.prototype.floatingCloseButtonMode=0,ProtoElements.prototype.floatingFixedPosition=0,ProtoElements.prototype.floatingPageElement="",ProtoElements.prototype.floatingUseElementWidth=!1,ProtoElements.prototype.floatingScrollPosition=0,ProtoElements.prototype.floatingGutterX=0,ProtoElements.prototype.floatingGutterY=0,ProtoElements.prototype.floatingWidth=0,ProtoElements.prototype.iconsColor="",ProtoElements.prototype.accentColor="",ProtoElements.prototype.tooltipTextColor="",ProtoElements.prototype.tooltipBackgroundColor="",ProtoElements.prototype.html="",ProtoElements.prototype.galleryStyle=0,ProtoElements.prototype.logoPosition=0,ProtoElements.prototype.logoUrl="",ProtoElements.prototype.lineItems=$util.emptyArray,ProtoElements.prototype.adPlaybackMode=0,ProtoElements.prototype.css="",ProtoElements.prototype.sessionId="",ProtoElements.prototype.playlistId="",ProtoElements.prototype.playerType=0,ProtoElements.prototype.outstreamInitialRendering=0,ProtoElements.prototype.outstreamHouseBackgroundColor="",ProtoElements.prototype.outstreamTotalAdBreakLength=0,ProtoElements.prototype.outstreamEndAdBreakPolicy=0,ProtoElements.prototype.galleryOrientation=0,ProtoElements.prototype.playlist=$util.emptyArray,ProtoElements.prototype.floatingAppendLocation=0,ProtoElements.prototype.floatingYAxisPadding=0,ProtoElements.prototype.customJsCode="",ProtoElements.prototype.videoQuality=0,ProtoElements.prototype.initializationSettingsJson="",ProtoElements.prototype.adSkippability=0,ProtoElements.prototype.skipAdAfter=5,ProtoElements.prototype.adBreaks=$util.emptyArray,ProtoElements.prototype.amazonTamSlotId="",ProtoElements.prototype.midRollOnlyOnLongContent=!0,ProtoElements.prototype.limitClientSideApiUse=!1,ProtoElements.prototype.abTestId="",ProtoElements.prototype.adsMustBeSkippableIfLongerThan=31,ProtoElements.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoElements;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.playerId=reader.string();break;case 2:message.playbackMode=reader.int32();break;case 3:message.soundMode=reader.int32();break;case 4:message.upNextMode=reader.int32();break;case 5:message.containerSelector=reader.string();break;case 6:message.position=reader.int32();break;case 7:message.insertPosition=reader.int32();break;case 8:message.forceInsertPath=reader.bool();break;case 9:message.renderInFrame=reader.bool();break;case 10:message.scrollHijackingProtection=reader.bool();break;case 11:message.preRollBreak=reader.int32();break;case 12:message.postRollBreak=reader.int32();break;case 13:message.midRollNumber=reader.int32();break;case 14:message.timeBetweenAds=reader.int32();break;case 15:message.minTimeBeforeFirstAd=reader.int32();break;case 16:message.adViewabilityPolicy=reader.int32();break;case 18:message.responsive=reader.bool();break;case 19:message.ratioWidth=reader.int32();break;case 20:message.ratioHeight=reader.int32();break;case 21:message.fixedWidth=reader.int32();break;case 22:message.fixedHeight=reader.int32();break;case 23:message.casting=reader.bool();break;case 24:if(message.sharingDestinations&&message.sharingDestinations.length||(message.sharingDestinations=[]),2==(7&tag))for(var end2=reader.uint32()+reader.pos;reader.pos<end2;)message.sharingDestinations.push(reader.int32());else message.sharingDestinations.push(reader.int32());break;case 25:message.closedCaption=reader.bool();break;case 26:message.muteWatermark=reader.bool();break;case 27:message.expandButton=reader.bool();break;case 28:message.closeButtonMode=reader.int32();break;case 29:message.floatingMode=reader.int32();break;case 30:if(message.floatingDeviceMode&&message.floatingDeviceMode.length||(message.floatingDeviceMode=[]),2==(7&tag))for(end2=reader.uint32()+reader.pos;reader.pos<end2;)message.floatingDeviceMode.push(reader.int32());else message.floatingDeviceMode.push(reader.int32());break;case 31:message.floatingCloseButtonMode=reader.int32();break;case 32:message.floatingFixedPosition=reader.int32();break;case 33:message.floatingPageElement=reader.string();break;case 34:message.floatingUseElementWidth=reader.bool();break;case 35:message.floatingScrollPosition=reader.int32();break;case 36:message.floatingGutterX=reader.int32();break;case 37:message.floatingGutterY=reader.int32();break;case 38:message.floatingWidth=reader.int32();break;case 39:message.iconsColor=reader.string();break;case 40:message.accentColor=reader.string();break;case 41:message.tooltipTextColor=reader.string();break;case 42:message.tooltipBackgroundColor=reader.string();break;case 43:message.html=reader.string();break;case 45:message.galleryStyle=reader.int32();break;case 46:message.logoPosition=reader.int32();break;case 47:message.logoUrl=reader.string();break;case 49:message.lineItems&&message.lineItems.length||(message.lineItems=[]),message.lineItems.push($root.ProtoLineItem.decode(reader,reader.uint32()));break;case 50:message.adPlaybackMode=reader.int32();break;case 51:message.css=reader.string();break;case 52:message.sessionId=reader.string();break;case 53:message.playlistId=reader.string();break;case 54:message.playerType=reader.int32();break;case 55:message.outstreamInitialRendering=reader.int32();break;case 56:message.outstreamHouseBackgroundColor=reader.string();break;case 57:message.outstreamTotalAdBreakLength=reader.int32();break;case 58:message.outstreamEndAdBreakPolicy=reader.int32();break;case 59:message.galleryOrientation=reader.int32();break;case 60:message.playlist&&message.playlist.length||(message.playlist=[]),message.playlist.push($root.ProtoPlaylistItem.decode(reader,reader.uint32()));break;case 61:message.floatingAppendLocation=reader.int32();break;case 62:message.floatingYAxisPadding=reader.int32();break;case 63:message.customJsCode=reader.string();break;case 64:message.videoQuality=reader.int32();break;case 65:message.initializationSettingsJson=reader.string();break;case 66:message.adSkippability=reader.int32();break;case 67:message.skipAdAfter=reader.int32();break;case 68:message.adBreaks&&message.adBreaks.length||(message.adBreaks=[]),message.adBreaks.push($root.ProtoAdBreak.decode(reader,reader.uint32()));break;case 69:message.amazonTamSlotId=reader.string();break;case 70:message.midRollOnlyOnLongContent=reader.bool();break;case 71:message.limitClientSideApiUse=reader.bool();break;case 72:message.abTestId=reader.string();break;case 73:message.adsMustBeSkippableIfLongerThan=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoElements.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.sharingDestinations=[],object.floatingDeviceMode=[],object.lineItems=[],object.playlist=[],object.adBreaks=[]),options.defaults&&(object.playerId="",object.playbackMode=options.enums===String?"Autoplay":0,object.soundMode=options.enums===String?"Mute":0,object.upNextMode=options.enums===String?"Next":1,object.containerSelector="",object.position=0,object.insertPosition=options.enums===String?"WithinContainer":0,object.forceInsertPath=!1,object.renderInFrame=!1,object.scrollHijackingProtection=!1,object.preRollBreak=0,object.postRollBreak=0,object.midRollNumber=-1,object.timeBetweenAds=0,object.minTimeBeforeFirstAd=0,object.adViewabilityPolicy=options.enums===String?"Default":0,object.responsive=!1,object.ratioWidth=0,object.ratioHeight=0,object.fixedWidth=0,object.fixedHeight=0,object.casting=!1,object.closedCaption=!1,object.muteWatermark=!1,object.expandButton=!1,object.closeButtonMode=options.enums===String?"Off":0,object.floatingMode=options.enums===String?"Off":0,object.floatingCloseButtonMode=options.enums===String?"Off":0,object.floatingFixedPosition=options.enums===String?"Page":0,object.floatingPageElement="",object.floatingUseElementWidth=!1,object.floatingScrollPosition=options.enums===String?"BottomRight":0,object.floatingGutterX=0,object.floatingGutterY=0,object.floatingWidth=0,object.iconsColor="",object.accentColor="",object.tooltipTextColor="",object.tooltipBackgroundColor="",object.html="",object.galleryStyle=options.enums===String?"None":0,object.logoPosition=options.enums===String?"None":0,object.logoUrl="",object.adPlaybackMode=options.enums===String?"Autoplay":0,object.css="",object.sessionId="",object.playlistId="",object.playerType=options.enums===String?"InStream":0,object.outstreamInitialRendering=options.enums===String?"ExpandWithAd":0,object.outstreamHouseBackgroundColor="",object.outstreamTotalAdBreakLength=0,object.outstreamEndAdBreakPolicy=options.enums===String?"Hide":0,object.galleryOrientation=options.enums===String?"Landscape":0,object.floatingAppendLocation=options.enums===String?"Above":0,object.floatingYAxisPadding=0,object.customJsCode="",object.videoQuality=options.enums===String?"Auto":0,object.initializationSettingsJson="",object.adSkippability=options.enums===String?"IfLongerThan":0,object.skipAdAfter=5,object.amazonTamSlotId="",object.midRollOnlyOnLongContent=!0,object.limitClientSideApiUse=!1,object.abTestId="",object.adsMustBeSkippableIfLongerThan=31),null!=message.playerId&&message.hasOwnProperty("playerId")&&(object.playerId=message.playerId),null!=message.playbackMode&&message.hasOwnProperty("playbackMode")&&(object.playbackMode=options.enums===String?$root.ProtoPlayerPlaybackModeEnum[message.playbackMode]:message.playbackMode),null!=message.soundMode&&message.hasOwnProperty("soundMode")&&(object.soundMode=options.enums===String?$root.ProtoPlayerSoundMode[message.soundMode]:message.soundMode),null!=message.upNextMode&&message.hasOwnProperty("upNextMode")&&(object.upNextMode=options.enums===String?$root.ProtoPlayerUpNextMode[message.upNextMode]:message.upNextMode),null!=message.containerSelector&&message.hasOwnProperty("containerSelector")&&(object.containerSelector=message.containerSelector),null!=message.position&&message.hasOwnProperty("position")&&(object.position=message.position),null!=message.insertPosition&&message.hasOwnProperty("insertPosition")&&(object.insertPosition=options.enums===String?$root.ProtoPlayerInsertMode[message.insertPosition]:message.insertPosition),null!=message.forceInsertPath&&message.hasOwnProperty("forceInsertPath")&&(object.forceInsertPath=message.forceInsertPath),null!=message.renderInFrame&&message.hasOwnProperty("renderInFrame")&&(object.renderInFrame=message.renderInFrame),null!=message.scrollHijackingProtection&&message.hasOwnProperty("scrollHijackingProtection")&&(object.scrollHijackingProtection=message.scrollHijackingProtection),null!=message.preRollBreak&&message.hasOwnProperty("preRollBreak")&&(object.preRollBreak=message.preRollBreak),null!=message.postRollBreak&&message.hasOwnProperty("postRollBreak")&&(object.postRollBreak=message.postRollBreak),null!=message.midRollNumber&&message.hasOwnProperty("midRollNumber")&&(object.midRollNumber=message.midRollNumber),null!=message.timeBetweenAds&&message.hasOwnProperty("timeBetweenAds")&&(object.timeBetweenAds=message.timeBetweenAds),null!=message.minTimeBeforeFirstAd&&message.hasOwnProperty("minTimeBeforeFirstAd")&&(object.minTimeBeforeFirstAd=message.minTimeBeforeFirstAd),null!=message.adViewabilityPolicy&&message.hasOwnProperty("adViewabilityPolicy")&&(object.adViewabilityPolicy=options.enums===String?$root.ProtoAdViewabilityPolicy[message.adViewabilityPolicy]:message.adViewabilityPolicy),null!=message.responsive&&message.hasOwnProperty("responsive")&&(object.responsive=message.responsive),null!=message.ratioWidth&&message.hasOwnProperty("ratioWidth")&&(object.ratioWidth=message.ratioWidth),null!=message.ratioHeight&&message.hasOwnProperty("ratioHeight")&&(object.ratioHeight=message.ratioHeight),null!=message.fixedWidth&&message.hasOwnProperty("fixedWidth")&&(object.fixedWidth=message.fixedWidth),null!=message.fixedHeight&&message.hasOwnProperty("fixedHeight")&&(object.fixedHeight=message.fixedHeight),null!=message.casting&&message.hasOwnProperty("casting")&&(object.casting=message.casting),message.sharingDestinations&&message.sharingDestinations.length){object.sharingDestinations=[];for(var j=0;j<message.sharingDestinations.length;++j)object.sharingDestinations[j]=options.enums===String?$root.ProtoSharingDestination[message.sharingDestinations[j]]:message.sharingDestinations[j]}if(null!=message.closedCaption&&message.hasOwnProperty("closedCaption")&&(object.closedCaption=message.closedCaption),null!=message.muteWatermark&&message.hasOwnProperty("muteWatermark")&&(object.muteWatermark=message.muteWatermark),null!=message.expandButton&&message.hasOwnProperty("expandButton")&&(object.expandButton=message.expandButton),null!=message.closeButtonMode&&message.hasOwnProperty("closeButtonMode")&&(object.closeButtonMode=options.enums===String?$root.ProtoPlayerCloseButtonMode[message.closeButtonMode]:message.closeButtonMode),null!=message.floatingMode&&message.hasOwnProperty("floatingMode")&&(object.floatingMode=options.enums===String?$root.ProtoPlayerFloatingMode[message.floatingMode]:message.floatingMode),message.floatingDeviceMode&&message.floatingDeviceMode.length){object.floatingDeviceMode=[];for(j=0;j<message.floatingDeviceMode.length;++j)object.floatingDeviceMode[j]=options.enums===String?$root.ProtoDeviceType[message.floatingDeviceMode[j]]:message.floatingDeviceMode[j]}if(null!=message.floatingCloseButtonMode&&message.hasOwnProperty("floatingCloseButtonMode")&&(object.floatingCloseButtonMode=options.enums===String?$root.ProtoPlayerCloseButtonMode[message.floatingCloseButtonMode]:message.floatingCloseButtonMode),null!=message.floatingFixedPosition&&message.hasOwnProperty("floatingFixedPosition")&&(object.floatingFixedPosition=options.enums===String?$root.ProtoFloatingFixedPositionMode[message.floatingFixedPosition]:message.floatingFixedPosition),null!=message.floatingPageElement&&message.hasOwnProperty("floatingPageElement")&&(object.floatingPageElement=message.floatingPageElement),null!=message.floatingUseElementWidth&&message.hasOwnProperty("floatingUseElementWidth")&&(object.floatingUseElementWidth=message.floatingUseElementWidth),null!=message.floatingScrollPosition&&message.hasOwnProperty("floatingScrollPosition")&&(object.floatingScrollPosition=options.enums===String?$root.ProtoPositionMode[message.floatingScrollPosition]:message.floatingScrollPosition),null!=message.floatingGutterX&&message.hasOwnProperty("floatingGutterX")&&(object.floatingGutterX=message.floatingGutterX),null!=message.floatingGutterY&&message.hasOwnProperty("floatingGutterY")&&(object.floatingGutterY=message.floatingGutterY),null!=message.floatingWidth&&message.hasOwnProperty("floatingWidth")&&(object.floatingWidth=message.floatingWidth),null!=message.iconsColor&&message.hasOwnProperty("iconsColor")&&(object.iconsColor=message.iconsColor),null!=message.accentColor&&message.hasOwnProperty("accentColor")&&(object.accentColor=message.accentColor),null!=message.tooltipTextColor&&message.hasOwnProperty("tooltipTextColor")&&(object.tooltipTextColor=message.tooltipTextColor),null!=message.tooltipBackgroundColor&&message.hasOwnProperty("tooltipBackgroundColor")&&(object.tooltipBackgroundColor=message.tooltipBackgroundColor),null!=message.html&&message.hasOwnProperty("html")&&(object.html=message.html),null!=message.galleryStyle&&message.hasOwnProperty("galleryStyle")&&(object.galleryStyle=options.enums===String?$root.ProtoGalleryStyleMode[message.galleryStyle]:message.galleryStyle),null!=message.logoPosition&&message.hasOwnProperty("logoPosition")&&(object.logoPosition=options.enums===String?$root.ProtoLogoPositionMode[message.logoPosition]:message.logoPosition),null!=message.logoUrl&&message.hasOwnProperty("logoUrl")&&(object.logoUrl=message.logoUrl),message.lineItems&&message.lineItems.length){object.lineItems=[];for(j=0;j<message.lineItems.length;++j)object.lineItems[j]=$root.ProtoLineItem.toObject(message.lineItems[j],options)}if(null!=message.adPlaybackMode&&message.hasOwnProperty("adPlaybackMode")&&(object.adPlaybackMode=options.enums===String?$root.ProtoAdPlaybackMode[message.adPlaybackMode]:message.adPlaybackMode),null!=message.css&&message.hasOwnProperty("css")&&(object.css=message.css),null!=message.sessionId&&message.hasOwnProperty("sessionId")&&(object.sessionId=message.sessionId),null!=message.playlistId&&message.hasOwnProperty("playlistId")&&(object.playlistId=message.playlistId),null!=message.playerType&&message.hasOwnProperty("playerType")&&(object.playerType=options.enums===String?$root.ProtoElementsTypeEnum[message.playerType]:message.playerType),null!=message.outstreamInitialRendering&&message.hasOwnProperty("outstreamInitialRendering")&&(object.outstreamInitialRendering=options.enums===String?$root.ProtoOutstreamInitialRenderingEnum[message.outstreamInitialRendering]:message.outstreamInitialRendering),null!=message.outstreamHouseBackgroundColor&&message.hasOwnProperty("outstreamHouseBackgroundColor")&&(object.outstreamHouseBackgroundColor=message.outstreamHouseBackgroundColor),null!=message.outstreamTotalAdBreakLength&&message.hasOwnProperty("outstreamTotalAdBreakLength")&&(object.outstreamTotalAdBreakLength=message.outstreamTotalAdBreakLength),null!=message.outstreamEndAdBreakPolicy&&message.hasOwnProperty("outstreamEndAdBreakPolicy")&&(object.outstreamEndAdBreakPolicy=options.enums===String?$root.ProtoOutstreamEndAdBreakPolicyEnum[message.outstreamEndAdBreakPolicy]:message.outstreamEndAdBreakPolicy),null!=message.galleryOrientation&&message.hasOwnProperty("galleryOrientation")&&(object.galleryOrientation=options.enums===String?$root.ProtoGalleryOrientationEnum[message.galleryOrientation]:message.galleryOrientation),message.playlist&&message.playlist.length){object.playlist=[];for(j=0;j<message.playlist.length;++j)object.playlist[j]=$root.ProtoPlaylistItem.toObject(message.playlist[j],options)}if(null!=message.floatingAppendLocation&&message.hasOwnProperty("floatingAppendLocation")&&(object.floatingAppendLocation=options.enums===String?$root.ProtoFloatingAppendLocationEnum[message.floatingAppendLocation]:message.floatingAppendLocation),null!=message.floatingYAxisPadding&&message.hasOwnProperty("floatingYAxisPadding")&&(object.floatingYAxisPadding=message.floatingYAxisPadding),null!=message.customJsCode&&message.hasOwnProperty("customJsCode")&&(object.customJsCode=message.customJsCode),null!=message.videoQuality&&message.hasOwnProperty("videoQuality")&&(object.videoQuality=options.enums===String?$root.ProtoVideoQuality[message.videoQuality]:message.videoQuality),null!=message.initializationSettingsJson&&message.hasOwnProperty("initializationSettingsJson")&&(object.initializationSettingsJson=message.initializationSettingsJson),null!=message.adSkippability&&message.hasOwnProperty("adSkippability")&&(object.adSkippability=options.enums===String?$root.ProtoPlayerAdSkippability[message.adSkippability]:message.adSkippability),null!=message.skipAdAfter&&message.hasOwnProperty("skipAdAfter")&&(object.skipAdAfter=message.skipAdAfter),message.adBreaks&&message.adBreaks.length){object.adBreaks=[];for(j=0;j<message.adBreaks.length;++j)object.adBreaks[j]=$root.ProtoAdBreak.toObject(message.adBreaks[j],options)}return null!=message.amazonTamSlotId&&message.hasOwnProperty("amazonTamSlotId")&&(object.amazonTamSlotId=message.amazonTamSlotId),null!=message.midRollOnlyOnLongContent&&message.hasOwnProperty("midRollOnlyOnLongContent")&&(object.midRollOnlyOnLongContent=message.midRollOnlyOnLongContent),null!=message.limitClientSideApiUse&&message.hasOwnProperty("limitClientSideApiUse")&&(object.limitClientSideApiUse=message.limitClientSideApiUse),null!=message.abTestId&&message.hasOwnProperty("abTestId")&&(object.abTestId=message.abTestId),null!=message.adsMustBeSkippableIfLongerThan&&message.hasOwnProperty("adsMustBeSkippableIfLongerThan")&&(object.adsMustBeSkippableIfLongerThan=message.adsMustBeSkippableIfLongerThan),object},ProtoElements}(),$root.ProtoElementsResponse=function(){function ProtoElementsResponse(properties){if(this.players=[],this.lineItems=[],this.cookieSyncUrls={},properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoElementsResponse.prototype.errorMessage="",ProtoElementsResponse.prototype.players=$util.emptyArray,ProtoElementsResponse.prototype.browser=null,ProtoElementsResponse.prototype.geoLocation=null,ProtoElementsResponse.prototype.lineItems=$util.emptyArray,ProtoElementsResponse.prototype.cookieSyncUrls=$util.emptyObject,ProtoElementsResponse.prototype.explorationMode=!1,ProtoElementsResponse.prototype.supplyChain=null,ProtoElementsResponse.prototype.secondLevelDomain="",ProtoElementsResponse.prototype.userInformation=null,ProtoElementsResponse.prototype.serverAb0=0,ProtoElementsResponse.prototype.serverAb1=0,ProtoElementsResponse.prototype.isSeoTraffic=!1,ProtoElementsResponse.prototype.bandwidthLoggingEnabled=!1,ProtoElementsResponse.prototype.publisherNetworkCode=0,ProtoElementsResponse.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var key,value,end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoElementsResponse;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.errorMessage=reader.string();break;case 10:message.players&&message.players.length||(message.players=[]),message.players.push($root.ProtoElements.decode(reader,reader.uint32()));break;case 11:message.browser=$root.Browser.decode(reader,reader.uint32());break;case 12:message.geoLocation=$root.GeoLocation.decode(reader,reader.uint32());break;case 13:message.lineItems&&message.lineItems.length||(message.lineItems=[]),message.lineItems.push($root.ProtoLineItem.decode(reader,reader.uint32()));break;case 14:message.cookieSyncUrls===$util.emptyObject&&(message.cookieSyncUrls={});var end2=reader.uint32()+reader.pos;for(key=0,value="";reader.pos<end2;){var tag2=reader.uint32();switch(tag2>>>3){case 1:key=reader.int32();break;case 2:value=reader.string();break;default:reader.skipType(7&tag2)}}message.cookieSyncUrls[key]=value;break;case 15:message.explorationMode=reader.bool();break;case 17:message.supplyChain=$root.ProtoSupplyChain.decode(reader,reader.uint32());break;case 18:message.secondLevelDomain=reader.string();break;case 20:message.userInformation=$root.ProtoUserInformation.decode(reader,reader.uint32());break;case 21:message.serverAb0=reader.int32();break;case 22:message.serverAb1=reader.int32();break;case 23:message.isSeoTraffic=reader.bool();break;case 24:message.bandwidthLoggingEnabled=reader.bool();break;case 25:message.publisherNetworkCode=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoElementsResponse.toObject=function(message,options){options||(options={});var keys2,object={};if((options.arrays||options.defaults)&&(object.players=[],object.lineItems=[]),(options.objects||options.defaults)&&(object.cookieSyncUrls={}),options.defaults&&(object.errorMessage="",object.browser=null,object.geoLocation=null,object.explorationMode=!1,object.supplyChain=null,object.secondLevelDomain="",object.userInformation=null,object.serverAb0=0,object.serverAb1=0,object.isSeoTraffic=!1,object.bandwidthLoggingEnabled=!1,object.publisherNetworkCode=0),null!=message.errorMessage&&message.hasOwnProperty("errorMessage")&&(object.errorMessage=message.errorMessage),message.players&&message.players.length){object.players=[];for(var j=0;j<message.players.length;++j)object.players[j]=$root.ProtoElements.toObject(message.players[j],options)}if(null!=message.browser&&message.hasOwnProperty("browser")&&(object.browser=$root.Browser.toObject(message.browser,options)),null!=message.geoLocation&&message.hasOwnProperty("geoLocation")&&(object.geoLocation=$root.GeoLocation.toObject(message.geoLocation,options)),message.lineItems&&message.lineItems.length){object.lineItems=[];for(j=0;j<message.lineItems.length;++j)object.lineItems[j]=$root.ProtoLineItem.toObject(message.lineItems[j],options)}if(message.cookieSyncUrls&&(keys2=Object.keys(message.cookieSyncUrls)).length){object.cookieSyncUrls={};for(j=0;j<keys2.length;++j)object.cookieSyncUrls[keys2[j]]=message.cookieSyncUrls[keys2[j]]}return null!=message.explorationMode&&message.hasOwnProperty("explorationMode")&&(object.explorationMode=message.explorationMode),null!=message.supplyChain&&message.hasOwnProperty("supplyChain")&&(object.supplyChain=$root.ProtoSupplyChain.toObject(message.supplyChain,options)),null!=message.secondLevelDomain&&message.hasOwnProperty("secondLevelDomain")&&(object.secondLevelDomain=message.secondLevelDomain),null!=message.userInformation&&message.hasOwnProperty("userInformation")&&(object.userInformation=$root.ProtoUserInformation.toObject(message.userInformation,options)),null!=message.serverAb0&&message.hasOwnProperty("serverAb0")&&(object.serverAb0=message.serverAb0),null!=message.serverAb1&&message.hasOwnProperty("serverAb1")&&(object.serverAb1=message.serverAb1),null!=message.isSeoTraffic&&message.hasOwnProperty("isSeoTraffic")&&(object.isSeoTraffic=message.isSeoTraffic),null!=message.bandwidthLoggingEnabled&&message.hasOwnProperty("bandwidthLoggingEnabled")&&(object.bandwidthLoggingEnabled=message.bandwidthLoggingEnabled),null!=message.publisherNetworkCode&&message.hasOwnProperty("publisherNetworkCode")&&(object.publisherNetworkCode=message.publisherNetworkCode),object},ProtoElementsResponse}(),$root.ProtoLineItemAdBreakTargeting=function(){function ProtoLineItemAdBreakTargeting(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLineItemAdBreakTargeting.prototype.adRollType=0,ProtoLineItemAdBreakTargeting.prototype.adBreakTypeEnum=1,ProtoLineItemAdBreakTargeting.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoLineItemAdBreakTargeting;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.adRollType=reader.int32();break;case 2:message.adBreakTypeEnum=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoLineItemAdBreakTargeting.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.adRollType=options.enums===String?"None":0,object.adBreakTypeEnum=options.enums===String?"All":1),null!=message.adRollType&&message.hasOwnProperty("adRollType")&&(object.adRollType=options.enums===String?$root.ProtoAdBreakTypeEnum[message.adRollType]:message.adRollType),null!=message.adBreakTypeEnum&&message.hasOwnProperty("adBreakTypeEnum")&&(object.adBreakTypeEnum=options.enums===String?$root.ProtoLineItemAdBreakTypeEnum[message.adBreakTypeEnum]:message.adBreakTypeEnum),object},ProtoLineItemAdBreakTargeting}(),$root.ProtoLineItemAdPodTargeting=function(){function ProtoLineItemAdPodTargeting(properties){if(this.adSlotPositions=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLineItemAdPodTargeting.prototype.targetingType=0,ProtoLineItemAdPodTargeting.prototype.adSlotTargetingType=1,ProtoLineItemAdPodTargeting.prototype.adSlotPositions=$util.emptyArray,ProtoLineItemAdPodTargeting.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoLineItemAdPodTargeting;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.targetingType=reader.int32();break;case 2:message.adSlotTargetingType=reader.int32();break;case 3:if(message.adSlotPositions&&message.adSlotPositions.length||(message.adSlotPositions=[]),2==(7&tag))for(var end2=reader.uint32()+reader.pos;reader.pos<end2;)message.adSlotPositions.push(reader.int32());else message.adSlotPositions.push(reader.int32());break;default:reader.skipType(7&tag)}}return message},ProtoLineItemAdPodTargeting.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.adSlotPositions=[]),options.defaults&&(object.targetingType=options.enums===String?"Only":0,object.adSlotTargetingType=options.enums===String?"SpecificSlots":1),null!=message.targetingType&&message.hasOwnProperty("targetingType")&&(object.targetingType=options.enums===String?$root.ProtoLineItemTargetingTypeEnum[message.targetingType]:message.targetingType),null!=message.adSlotTargetingType&&message.hasOwnProperty("adSlotTargetingType")&&(object.adSlotTargetingType=options.enums===String?$root.ProtoLineItemAdSlotTargetingTypeEnum[message.adSlotTargetingType]:message.adSlotTargetingType),message.adSlotPositions&&message.adSlotPositions.length){object.adSlotPositions=[];for(var j=0;j<message.adSlotPositions.length;++j)object.adSlotPositions[j]=message.adSlotPositions[j]}return object},ProtoLineItemAdPodTargeting}(),$root.ProtoLineItemAdBreakSettings=function(){function ProtoLineItemAdBreakSettings(properties){if(this.adBreakTargeting=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLineItemAdBreakSettings.prototype.adBreakTargeting=$util.emptyArray,ProtoLineItemAdBreakSettings.prototype.adPodTargeting=null,ProtoLineItemAdBreakSettings.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoLineItemAdBreakSettings;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.adBreakTargeting&&message.adBreakTargeting.length||(message.adBreakTargeting=[]),message.adBreakTargeting.push($root.ProtoLineItemAdBreakTargeting.decode(reader,reader.uint32()));break;case 2:message.adPodTargeting=$root.ProtoLineItemAdPodTargeting.decode(reader,reader.uint32());break;default:reader.skipType(7&tag)}}return message},ProtoLineItemAdBreakSettings.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.adBreakTargeting=[]),options.defaults&&(object.adPodTargeting=null),message.adBreakTargeting&&message.adBreakTargeting.length){object.adBreakTargeting=[];for(var j=0;j<message.adBreakTargeting.length;++j)object.adBreakTargeting[j]=$root.ProtoLineItemAdBreakTargeting.toObject(message.adBreakTargeting[j],options)}return null!=message.adPodTargeting&&message.hasOwnProperty("adPodTargeting")&&(object.adPodTargeting=$root.ProtoLineItemAdPodTargeting.toObject(message.adPodTargeting,options)),object},ProtoLineItemAdBreakSettings}(),$root.ProtoLineItem=function(){function ProtoLineItem(properties){if(this.trackers=[],this.renditions=[],this.floorPrices=[],this.advertiserContextualTargeting=[],this.publisherContextualTargeting=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoLineItem.prototype.publisherLineItemId="",ProtoLineItem.prototype.advertiserLineItemId="",ProtoLineItem.prototype.adTag="",ProtoLineItem.prototype.creativeType=0,ProtoLineItem.prototype.sound=!1,ProtoLineItem.prototype.viewability=!1,ProtoLineItem.prototype.impressionTimeSpent=0,ProtoLineItem.prototype.vendorId="",ProtoLineItem.prototype.trackers=$util.emptyArray,ProtoLineItem.prototype.duration=0,ProtoLineItem.prototype.renditions=$util.emptyArray,ProtoLineItem.prototype.mediaCreativeId="",ProtoLineItem.prototype.ignoreFilledRequests=!1,ProtoLineItem.prototype.requestCap=3,ProtoLineItem.prototype.impressionCap=0,ProtoLineItem.prototype.successRate=0,ProtoLineItem.prototype.lineItemPriority=0,ProtoLineItem.prototype.headerBidderBids="",ProtoLineItem.prototype.headerBidderTimeout=0,ProtoLineItem.prototype.mediaCreativeClickUrl="",ProtoLineItem.prototype.resetRequestsCapTime=60,ProtoLineItem.prototype.resetImpressionsCapTime=60,ProtoLineItem.prototype.resetCapType=0,ProtoLineItem.prototype.creativeHlsFileName="",ProtoLineItem.prototype.timeBetweenRequests=0,ProtoLineItem.prototype.skipMode=0,ProtoLineItem.prototype.mediaIdTargeting=null,ProtoLineItem.prototype.mediaKeywordsTargeting=null,ProtoLineItem.prototype.mediaLanguageTargeting=null,ProtoLineItem.prototype.adType=0,ProtoLineItem.prototype.overlayTime=30,ProtoLineItem.prototype.floorPrice=0,ProtoLineItem.prototype.adBreakSettings=null,ProtoLineItem.prototype.floorPrices=$util.emptyArray,ProtoLineItem.prototype.bidRate=0,ProtoLineItem.prototype.pauseAdOutOfView=0,ProtoLineItem.prototype.moatTrackingEnabled=!1,ProtoLineItem.prototype.cnxCreativeId="",ProtoLineItem.prototype.blockedDomainsRevisionNumber=0,ProtoLineItem.prototype.advertiserContextualTargeting=$util.emptyArray,ProtoLineItem.prototype.publisherContextualTargeting=$util.emptyArray,ProtoLineItem.prototype.amazonDealId="",ProtoLineItem.prototype.playerSizeTargetings=null,ProtoLineItem.prototype.playerSize="",ProtoLineItem.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoLineItem;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.publisherLineItemId=reader.string();break;case 2:message.advertiserLineItemId=reader.string();break;case 3:message.adTag=reader.string();break;case 4:message.creativeType=reader.int32();break;case 6:message.sound=reader.bool();break;case 7:message.viewability=reader.bool();break;case 9:message.impressionTimeSpent=reader.int32();break;case 10:message.vendorId=reader.string();break;case 12:message.trackers&&message.trackers.length||(message.trackers=[]),message.trackers.push($root.CreativeTrackerViewModel.decode(reader,reader.uint32()));break;case 13:message.duration=reader.int32();break;case 14:message.renditions&&message.renditions.length||(message.renditions=[]),message.renditions.push($root.ProtoRendition.decode(reader,reader.uint32()));break;case 15:message.mediaCreativeId=reader.string();break;case 16:message.ignoreFilledRequests=reader.bool();break;case 17:message.requestCap=reader.int32();break;case 18:message.impressionCap=reader.int32();break;case 19:message.successRate=reader.double();break;case 20:message.lineItemPriority=reader.int32();break;case 21:message.headerBidderBids=reader.string();break;case 22:message.headerBidderTimeout=reader.int32();break;case 23:message.mediaCreativeClickUrl=reader.string();break;case 24:message.resetRequestsCapTime=reader.int32();break;case 25:message.resetImpressionsCapTime=reader.int32();break;case 26:message.resetCapType=reader.int32();break;case 27:message.creativeHlsFileName=reader.string();break;case 28:message.timeBetweenRequests=reader.int32();break;case 29:message.skipMode=reader.int32();break;case 30:message.mediaIdTargeting=$root.ProtoTargetingChoiceModel.decode(reader,reader.uint32());break;case 31:message.mediaKeywordsTargeting=$root.ProtoTargetingChoiceModel.decode(reader,reader.uint32());break;case 32:message.mediaLanguageTargeting=$root.ProtoTargetingChoiceModel.decode(reader,reader.uint32());break;case 33:message.adType=reader.int32();break;case 34:message.overlayTime=reader.int32();break;case 35:message.floorPrice=reader.double();break;case 36:message.adBreakSettings=$root.ProtoLineItemAdBreakSettings.decode(reader,reader.uint32());break;case 38:if(message.floorPrices&&message.floorPrices.length||(message.floorPrices=[]),2==(7&tag))for(var end2=reader.uint32()+reader.pos;reader.pos<end2;)message.floorPrices.push(reader.double());else message.floorPrices.push(reader.double());break;case 39:message.bidRate=reader.double();break;case 40:message.pauseAdOutOfView=reader.int32();break;case 41:message.moatTrackingEnabled=reader.bool();break;case 42:message.cnxCreativeId=reader.string();break;case 44:message.blockedDomainsRevisionNumber=reader.int32();break;case 45:message.advertiserContextualTargeting&&message.advertiserContextualTargeting.length||(message.advertiserContextualTargeting=[]),message.advertiserContextualTargeting.push($root.ProtoContextualTargetingCaseModel.decode(reader,reader.uint32()));break;case 46:message.publisherContextualTargeting&&message.publisherContextualTargeting.length||(message.publisherContextualTargeting=[]),message.publisherContextualTargeting.push($root.ProtoContextualTargetingCaseModel.decode(reader,reader.uint32()));break;case 48:message.amazonDealId=reader.string();break;case 47:message.playerSizeTargetings=$root.ProtoPlayerSizeTargetings.decode(reader,reader.uint32());break;case 101:message.playerSize=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoLineItem.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.trackers=[],object.renditions=[],object.floorPrices=[],object.advertiserContextualTargeting=[],object.publisherContextualTargeting=[]),options.defaults&&(object.publisherLineItemId="",object.advertiserLineItemId="",object.adTag="",object.creativeType=options.enums===String?"ThirdParty":0,object.sound=!1,object.viewability=!1,object.impressionTimeSpent=0,object.vendorId="",object.duration=0,object.mediaCreativeId="",object.ignoreFilledRequests=!1,object.requestCap=3,object.impressionCap=0,object.successRate=0,object.lineItemPriority=options.enums===String?"House":0,object.headerBidderBids="",object.headerBidderTimeout=0,object.mediaCreativeClickUrl="",object.resetRequestsCapTime=60,object.resetImpressionsCapTime=60,object.resetCapType=options.enums===String?"TimeCapping":0,object.creativeHlsFileName="",object.timeBetweenRequests=0,object.skipMode=options.enums===String?"IfLongerThan31Sec":0,object.mediaIdTargeting=null,object.mediaKeywordsTargeting=null,object.mediaLanguageTargeting=null,object.adType=options.enums===String?"Video":0,object.overlayTime=30,object.floorPrice=0,object.adBreakSettings=null,object.bidRate=0,object.pauseAdOutOfView=options.enums===String?"Default":0,object.moatTrackingEnabled=!1,object.cnxCreativeId="",object.blockedDomainsRevisionNumber=0,object.playerSizeTargetings=null,object.amazonDealId="",object.playerSize=""),null!=message.publisherLineItemId&&message.hasOwnProperty("publisherLineItemId")&&(object.publisherLineItemId=message.publisherLineItemId),null!=message.advertiserLineItemId&&message.hasOwnProperty("advertiserLineItemId")&&(object.advertiserLineItemId=message.advertiserLineItemId),null!=message.adTag&&message.hasOwnProperty("adTag")&&(object.adTag=message.adTag),null!=message.creativeType&&message.hasOwnProperty("creativeType")&&(object.creativeType=options.enums===String?$root.ProtoCreativeTypeEnum[message.creativeType]:message.creativeType),null!=message.sound&&message.hasOwnProperty("sound")&&(object.sound=message.sound),null!=message.viewability&&message.hasOwnProperty("viewability")&&(object.viewability=message.viewability),null!=message.impressionTimeSpent&&message.hasOwnProperty("impressionTimeSpent")&&(object.impressionTimeSpent=message.impressionTimeSpent),null!=message.vendorId&&message.hasOwnProperty("vendorId")&&(object.vendorId=message.vendorId),message.trackers&&message.trackers.length){object.trackers=[];for(var j=0;j<message.trackers.length;++j)object.trackers[j]=$root.CreativeTrackerViewModel.toObject(message.trackers[j],options)}if(null!=message.duration&&message.hasOwnProperty("duration")&&(object.duration=message.duration),message.renditions&&message.renditions.length){object.renditions=[];for(j=0;j<message.renditions.length;++j)object.renditions[j]=$root.ProtoRendition.toObject(message.renditions[j],options)}if(null!=message.mediaCreativeId&&message.hasOwnProperty("mediaCreativeId")&&(object.mediaCreativeId=message.mediaCreativeId),null!=message.ignoreFilledRequests&&message.hasOwnProperty("ignoreFilledRequests")&&(object.ignoreFilledRequests=message.ignoreFilledRequests),null!=message.requestCap&&message.hasOwnProperty("requestCap")&&(object.requestCap=message.requestCap),null!=message.impressionCap&&message.hasOwnProperty("impressionCap")&&(object.impressionCap=message.impressionCap),null!=message.successRate&&message.hasOwnProperty("successRate")&&(object.successRate=options.json&&!isFinite(message.successRate)?String(message.successRate):message.successRate),null!=message.lineItemPriority&&message.hasOwnProperty("lineItemPriority")&&(object.lineItemPriority=options.enums===String?$root.ProtoLineItemPriority[message.lineItemPriority]:message.lineItemPriority),null!=message.headerBidderBids&&message.hasOwnProperty("headerBidderBids")&&(object.headerBidderBids=message.headerBidderBids),null!=message.headerBidderTimeout&&message.hasOwnProperty("headerBidderTimeout")&&(object.headerBidderTimeout=message.headerBidderTimeout),null!=message.mediaCreativeClickUrl&&message.hasOwnProperty("mediaCreativeClickUrl")&&(object.mediaCreativeClickUrl=message.mediaCreativeClickUrl),null!=message.resetRequestsCapTime&&message.hasOwnProperty("resetRequestsCapTime")&&(object.resetRequestsCapTime=message.resetRequestsCapTime),null!=message.resetImpressionsCapTime&&message.hasOwnProperty("resetImpressionsCapTime")&&(object.resetImpressionsCapTime=message.resetImpressionsCapTime),null!=message.resetCapType&&message.hasOwnProperty("resetCapType")&&(object.resetCapType=options.enums===String?$root.ProtoResetCapTypeEnum[message.resetCapType]:message.resetCapType),null!=message.creativeHlsFileName&&message.hasOwnProperty("creativeHlsFileName")&&(object.creativeHlsFileName=message.creativeHlsFileName),null!=message.timeBetweenRequests&&message.hasOwnProperty("timeBetweenRequests")&&(object.timeBetweenRequests=message.timeBetweenRequests),null!=message.skipMode&&message.hasOwnProperty("skipMode")&&(object.skipMode=options.enums===String?$root.ProtoAdSkipMode[message.skipMode]:message.skipMode),null!=message.mediaIdTargeting&&message.hasOwnProperty("mediaIdTargeting")&&(object.mediaIdTargeting=$root.ProtoTargetingChoiceModel.toObject(message.mediaIdTargeting,options)),null!=message.mediaKeywordsTargeting&&message.hasOwnProperty("mediaKeywordsTargeting")&&(object.mediaKeywordsTargeting=$root.ProtoTargetingChoiceModel.toObject(message.mediaKeywordsTargeting,options)),null!=message.mediaLanguageTargeting&&message.hasOwnProperty("mediaLanguageTargeting")&&(object.mediaLanguageTargeting=$root.ProtoTargetingChoiceModel.toObject(message.mediaLanguageTargeting,options)),null!=message.adType&&message.hasOwnProperty("adType")&&(object.adType=options.enums===String?$root.ProtoAdType[message.adType]:message.adType),null!=message.overlayTime&&message.hasOwnProperty("overlayTime")&&(object.overlayTime=message.overlayTime),null!=message.floorPrice&&message.hasOwnProperty("floorPrice")&&(object.floorPrice=options.json&&!isFinite(message.floorPrice)?String(message.floorPrice):message.floorPrice),null!=message.adBreakSettings&&message.hasOwnProperty("adBreakSettings")&&(object.adBreakSettings=$root.ProtoLineItemAdBreakSettings.toObject(message.adBreakSettings,options)),message.floorPrices&&message.floorPrices.length){object.floorPrices=[];for(j=0;j<message.floorPrices.length;++j)object.floorPrices[j]=options.json&&!isFinite(message.floorPrices[j])?String(message.floorPrices[j]):message.floorPrices[j]}if(null!=message.bidRate&&message.hasOwnProperty("bidRate")&&(object.bidRate=options.json&&!isFinite(message.bidRate)?String(message.bidRate):message.bidRate),null!=message.pauseAdOutOfView&&message.hasOwnProperty("pauseAdOutOfView")&&(object.pauseAdOutOfView=options.enums===String?$root.ProtoLineItemPauseAdOutOfViewEnum[message.pauseAdOutOfView]:message.pauseAdOutOfView),null!=message.moatTrackingEnabled&&message.hasOwnProperty("moatTrackingEnabled")&&(object.moatTrackingEnabled=message.moatTrackingEnabled),null!=message.cnxCreativeId&&message.hasOwnProperty("cnxCreativeId")&&(object.cnxCreativeId=message.cnxCreativeId),null!=message.blockedDomainsRevisionNumber&&message.hasOwnProperty("blockedDomainsRevisionNumber")&&(object.blockedDomainsRevisionNumber=message.blockedDomainsRevisionNumber),message.advertiserContextualTargeting&&message.advertiserContextualTargeting.length){object.advertiserContextualTargeting=[];for(j=0;j<message.advertiserContextualTargeting.length;++j)object.advertiserContextualTargeting[j]=$root.ProtoContextualTargetingCaseModel.toObject(message.advertiserContextualTargeting[j],options)}if(message.publisherContextualTargeting&&message.publisherContextualTargeting.length){object.publisherContextualTargeting=[];for(j=0;j<message.publisherContextualTargeting.length;++j)object.publisherContextualTargeting[j]=$root.ProtoContextualTargetingCaseModel.toObject(message.publisherContextualTargeting[j],options)}return null!=message.playerSizeTargetings&&message.hasOwnProperty("playerSizeTargetings")&&(object.playerSizeTargetings=$root.ProtoPlayerSizeTargetings.toObject(message.playerSizeTargetings,options)),null!=message.amazonDealId&&message.hasOwnProperty("amazonDealId")&&(object.amazonDealId=message.amazonDealId),null!=message.playerSize&&message.hasOwnProperty("playerSize")&&(object.playerSize=message.playerSize),object},ProtoLineItem}(),$root.ProtoTargetingChoiceModel=function(){function ProtoTargetingChoiceModel(properties){if(this.items=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoTargetingChoiceModel.prototype.choiceCriteria=0,ProtoTargetingChoiceModel.prototype.items=$util.emptyArray,ProtoTargetingChoiceModel.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoTargetingChoiceModel;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.choiceCriteria=reader.int32();break;case 2:message.items&&message.items.length||(message.items=[]),message.items.push(reader.string());break;default:reader.skipType(7&tag)}}return message},ProtoTargetingChoiceModel.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.items=[]),options.defaults&&(object.choiceCriteria=options.enums===String?"Only":0),null!=message.choiceCriteria&&message.hasOwnProperty("choiceCriteria")&&(object.choiceCriteria=options.enums===String?$root.ProtoChoiceCriteriaEnum[message.choiceCriteria]:message.choiceCriteria),message.items&&message.items.length){object.items=[];for(var j=0;j<message.items.length;++j)object.items[j]=message.items[j]}return object},ProtoTargetingChoiceModel}(),$root.ProtoContextualTargetingCaseModel=function(){function ProtoContextualTargetingCaseModel(properties){if(this.filters=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoContextualTargetingCaseModel.prototype.filters=$util.emptyArray,ProtoContextualTargetingCaseModel.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoContextualTargetingCaseModel;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.filters&&message.filters.length||(message.filters=[]),message.filters.push($root.ProtoContextualTargetingFilterModel.decode(reader,reader.uint32()));break;default:reader.skipType(7&tag)}}return message},ProtoContextualTargetingCaseModel.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.filters=[]),message.filters&&message.filters.length){object.filters=[];for(var j=0;j<message.filters.length;++j)object.filters[j]=$root.ProtoContextualTargetingFilterModel.toObject(message.filters[j],options)}return object},ProtoContextualTargetingCaseModel}(),$root.ProtoContextualTargetingFilterModel=function(){function ProtoContextualTargetingFilterModel(properties){if(this.items=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoContextualTargetingFilterModel.prototype.type=0,ProtoContextualTargetingFilterModel.prototype.items=$util.emptyArray,ProtoContextualTargetingFilterModel.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoContextualTargetingFilterModel;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.type=reader.int32();break;case 2:message.items&&message.items.length||(message.items=[]),message.items.push(reader.string());break;default:reader.skipType(7&tag)}}return message},ProtoContextualTargetingFilterModel.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.items=[]),options.defaults&&(object.type=options.enums===String?"IncludeAny":0),null!=message.type&&message.hasOwnProperty("type")&&(object.type=options.enums===String?$root.ProtoLineItemContextualTargetingEnum[message.type]:message.type),message.items&&message.items.length){object.items=[];for(var j=0;j<message.items.length;++j)object.items[j]=message.items[j]}return object},ProtoContextualTargetingFilterModel}(),$root.ProtoPlayerSizeTargetings=function(){function ProtoPlayerSizeTargetings(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoPlayerSizeTargetings.prototype.sizeChoiceCriteria=0,ProtoPlayerSizeTargetings.prototype.minWidth=0,ProtoPlayerSizeTargetings.prototype.maxWidth=0,ProtoPlayerSizeTargetings.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoPlayerSizeTargetings;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.sizeChoiceCriteria=reader.int32();break;case 2:message.minWidth=reader.int32();break;case 3:message.maxWidth=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoPlayerSizeTargetings.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.sizeChoiceCriteria=options.enums===String?"GreaterThan":0,object.minWidth=0,object.maxWidth=0),null!=message.sizeChoiceCriteria&&message.hasOwnProperty("sizeChoiceCriteria")&&(object.sizeChoiceCriteria=options.enums===String?$root.ProtoSizeChoiceCriteriaEnum[message.sizeChoiceCriteria]:message.sizeChoiceCriteria),null!=message.minWidth&&message.hasOwnProperty("minWidth")&&(object.minWidth=message.minWidth),null!=message.maxWidth&&message.hasOwnProperty("maxWidth")&&(object.maxWidth=message.maxWidth),object},ProtoPlayerSizeTargetings}(),$root.CreativeTrackerViewModel=function(){function CreativeTrackerViewModel(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return CreativeTrackerViewModel.prototype.type=0,CreativeTrackerViewModel.prototype.trigger=0,CreativeTrackerViewModel.prototype.url="",CreativeTrackerViewModel.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.CreativeTrackerViewModel;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.type=reader.int32();break;case 2:message.trigger=reader.int32();break;case 3:message.url=reader.string();break;default:reader.skipType(7&tag)}}return message},CreativeTrackerViewModel.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.type=options.enums===String?"Image":0,object.trigger=options.enums===String?"Impression":0,object.url=""),null!=message.type&&message.hasOwnProperty("type")&&(object.type=options.enums===String?$root.ProtoTrackerType[message.type]:message.type),null!=message.trigger&&message.hasOwnProperty("trigger")&&(object.trigger=options.enums===String?$root.ProtoTrackerTriggerType[message.trigger]:message.trigger),null!=message.url&&message.hasOwnProperty("url")&&(object.url=message.url),object},CreativeTrackerViewModel}(),$root.ProtoRendition=function(){function ProtoRendition(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoRendition.prototype.height=0,ProtoRendition.prototype.codec="",ProtoRendition.prototype.file="",ProtoRendition.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoRendition;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.height=reader.int32();break;case 2:message.codec=reader.string();break;case 3:message.file=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoRendition.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.height=0,object.codec="",object.file=""),null!=message.height&&message.hasOwnProperty("height")&&(object.height=message.height),null!=message.codec&&message.hasOwnProperty("codec")&&(object.codec=message.codec),null!=message.file&&message.hasOwnProperty("file")&&(object.file=message.file),object},ProtoRendition}(),$root.Browser=function(){function Browser(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return Browser.prototype.browserVersion="",Browser.prototype.browserType="",Browser.prototype.osCode="",Browser.prototype.device=0,Browser.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.browserVersion&&Object.hasOwnProperty.call(message,"browserVersion")&&writer.uint32(10).string(message.browserVersion),null!=message.browserType&&Object.hasOwnProperty.call(message,"browserType")&&writer.uint32(18).string(message.browserType),null!=message.osCode&&Object.hasOwnProperty.call(message,"osCode")&&writer.uint32(26).string(message.osCode),null!=message.device&&Object.hasOwnProperty.call(message,"device")&&writer.uint32(32).int32(message.device),writer},Browser.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.Browser;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.browserVersion=reader.string();break;case 2:message.browserType=reader.string();break;case 3:message.osCode=reader.string();break;case 4:message.device=reader.int32();break;default:reader.skipType(7&tag)}}return message},Browser.fromObject=function(object){if(object instanceof $root.Browser)return object;var message=new $root.Browser;switch(null!=object.browserVersion&&(message.browserVersion=String(object.browserVersion)),null!=object.browserType&&(message.browserType=String(object.browserType)),null!=object.osCode&&(message.osCode=String(object.osCode)),object.device){case"Desktop":case 0:message.device=0;break;case"Smartphone":case 1:message.device=1;break;case"Tablet":case 2:message.device=2;break;case"GameConsole":case 3:message.device=3;break;case"SmartTV":case 4:message.device=4;break;case"WearableComputer":case 5:message.device=5;break;case"PDA":case 6:message.device=6;break;case"Unrecognized":case 7:message.device=7}return message},Browser.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.browserVersion="",object.browserType="",object.osCode="",object.device=options.enums===String?"Desktop":0),null!=message.browserVersion&&message.hasOwnProperty("browserVersion")&&(object.browserVersion=message.browserVersion),null!=message.browserType&&message.hasOwnProperty("browserType")&&(object.browserType=message.browserType),null!=message.osCode&&message.hasOwnProperty("osCode")&&(object.osCode=message.osCode),null!=message.device&&message.hasOwnProperty("device")&&(object.device=options.enums===String?$root.ProtoDeviceType[message.device]:message.device),object},Browser.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},Browser}(),$root.GeoLocation=function(){function GeoLocation(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return GeoLocation.prototype.countryGeoId=0,GeoLocation.prototype.cityId=0,GeoLocation.prototype.subdivisionId=0,GeoLocation.prototype.dmaId=0,GeoLocation.prototype.ip="",GeoLocation.prototype.lat=0,GeoLocation.prototype.lon=0,GeoLocation.encode=function(message,writer){return writer||(writer=$Writer.create()),null!=message.countryGeoId&&Object.hasOwnProperty.call(message,"countryGeoId")&&writer.uint32(8).int32(message.countryGeoId),null!=message.cityId&&Object.hasOwnProperty.call(message,"cityId")&&writer.uint32(16).int32(message.cityId),null!=message.subdivisionId&&Object.hasOwnProperty.call(message,"subdivisionId")&&writer.uint32(24).int32(message.subdivisionId),null!=message.dmaId&&Object.hasOwnProperty.call(message,"dmaId")&&writer.uint32(32).int32(message.dmaId),null!=message.ip&&Object.hasOwnProperty.call(message,"ip")&&writer.uint32(42).string(message.ip),null!=message.lat&&Object.hasOwnProperty.call(message,"lat")&&writer.uint32(49).double(message.lat),null!=message.lon&&Object.hasOwnProperty.call(message,"lon")&&writer.uint32(57).double(message.lon),writer},GeoLocation.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.GeoLocation;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.countryGeoId=reader.int32();break;case 2:message.cityId=reader.int32();break;case 3:message.subdivisionId=reader.int32();break;case 4:message.dmaId=reader.int32();break;case 5:message.ip=reader.string();break;case 6:message.lat=reader.double();break;case 7:message.lon=reader.double();break;default:reader.skipType(7&tag)}}return message},GeoLocation.fromObject=function(object){if(object instanceof $root.GeoLocation)return object;var message=new $root.GeoLocation;return null!=object.countryGeoId&&(message.countryGeoId=0|object.countryGeoId),null!=object.cityId&&(message.cityId=0|object.cityId),null!=object.subdivisionId&&(message.subdivisionId=0|object.subdivisionId),null!=object.dmaId&&(message.dmaId=0|object.dmaId),null!=object.ip&&(message.ip=String(object.ip)),null!=object.lat&&(message.lat=Number(object.lat)),null!=object.lon&&(message.lon=Number(object.lon)),message},GeoLocation.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.countryGeoId=0,object.cityId=0,object.subdivisionId=0,object.dmaId=0,object.ip="",object.lat=0,object.lon=0),null!=message.countryGeoId&&message.hasOwnProperty("countryGeoId")&&(object.countryGeoId=message.countryGeoId),null!=message.cityId&&message.hasOwnProperty("cityId")&&(object.cityId=message.cityId),null!=message.subdivisionId&&message.hasOwnProperty("subdivisionId")&&(object.subdivisionId=message.subdivisionId),null!=message.dmaId&&message.hasOwnProperty("dmaId")&&(object.dmaId=message.dmaId),null!=message.ip&&message.hasOwnProperty("ip")&&(object.ip=message.ip),null!=message.lat&&message.hasOwnProperty("lat")&&(object.lat=options.json&&!isFinite(message.lat)?String(message.lat):message.lat),null!=message.lon&&message.hasOwnProperty("lon")&&(object.lon=options.json&&!isFinite(message.lon)?String(message.lon):message.lon),object},GeoLocation.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},GeoLocation}(),$root.ProtoSupplyChain=function(){function ProtoSupplyChain(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoSupplyChain.prototype.businessDomain="",ProtoSupplyChain.prototype.supplyChainId="",ProtoSupplyChain.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoSupplyChain;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.businessDomain=reader.string();break;case 3:message.supplyChainId=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoSupplyChain.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.businessDomain="",object.supplyChainId=""),null!=message.businessDomain&&message.hasOwnProperty("businessDomain")&&(object.businessDomain=message.businessDomain),null!=message.supplyChainId&&message.hasOwnProperty("supplyChainId")&&(object.supplyChainId=message.supplyChainId),object},ProtoSupplyChain}(),$root.ProtoUserInformation=function(){function ProtoUserInformation(properties){if(properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoUserInformation.prototype.userId="",ProtoUserInformation.prototype.lookupId="",ProtoUserInformation.prototype.lookupResponseCode=0,ProtoUserInformation.prototype.callFraudSensor=!1,ProtoUserInformation.prototype.publisherAdsTxt="",ProtoUserInformation.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoUserInformation;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:message.userId=reader.string();break;case 3:message.lookupId=reader.string();break;case 4:message.lookupResponseCode=reader.int32();break;case 5:message.callFraudSensor=reader.bool();break;case 6:message.publisherAdsTxt=reader.string();break;default:reader.skipType(7&tag)}}return message},ProtoUserInformation.toObject=function(message,options){options||(options={});var object={};return options.defaults&&(object.userId="",object.lookupId="",object.lookupResponseCode=0,object.callFraudSensor=!1,object.publisherAdsTxt=""),null!=message.userId&&message.hasOwnProperty("userId")&&(object.userId=message.userId),null!=message.lookupId&&message.hasOwnProperty("lookupId")&&(object.lookupId=message.lookupId),null!=message.lookupResponseCode&&message.hasOwnProperty("lookupResponseCode")&&(object.lookupResponseCode=message.lookupResponseCode),null!=message.callFraudSensor&&message.hasOwnProperty("callFraudSensor")&&(object.callFraudSensor=message.callFraudSensor),null!=message.publisherAdsTxt&&message.hasOwnProperty("publisherAdsTxt")&&(object.publisherAdsTxt=message.publisherAdsTxt),object},ProtoUserInformation}(),$root.ProtoAdBreak=function(){function ProtoAdBreak(properties){if(this.types=[],properties)for(var keys=Object.keys(properties),i=0;i<keys.length;++i)null!=properties[keys[i]]&&(this[keys[i]]=properties[keys[i]])}return ProtoAdBreak.prototype.types=$util.emptyArray,ProtoAdBreak.prototype.maxAdPodDuration=0,ProtoAdBreak.prototype.maxAdSlotDuration=180,ProtoAdBreak.prototype.numberOfAdSlots=1,ProtoAdBreak.decode=function(reader,length){reader instanceof $Reader||(reader=$Reader.create(reader));for(var end=void 0===length?reader.len:reader.pos+length,message=new $root.ProtoAdBreak;reader.pos<end;){var tag=reader.uint32();switch(tag>>>3){case 1:if(message.types&&message.types.length||(message.types=[]),2==(7&tag))for(var end2=reader.uint32()+reader.pos;reader.pos<end2;)message.types.push(reader.int32());else message.types.push(reader.int32());break;case 2:message.maxAdPodDuration=reader.int32();break;case 3:message.maxAdSlotDuration=reader.int32();break;case 4:message.numberOfAdSlots=reader.int32();break;default:reader.skipType(7&tag)}}return message},ProtoAdBreak.toObject=function(message,options){options||(options={});var object={};if((options.arrays||options.defaults)&&(object.types=[]),options.defaults&&(object.maxAdPodDuration=0,object.maxAdSlotDuration=180,object.numberOfAdSlots=1),message.types&&message.types.length){object.types=[];for(var j=0;j<message.types.length;++j)object.types[j]=options.enums===String?$root.ProtoAdBreakTypeEnum[message.types[j]]:message.types[j]}return null!=message.maxAdPodDuration&&message.hasOwnProperty("maxAdPodDuration")&&(object.maxAdPodDuration=message.maxAdPodDuration),null!=message.maxAdSlotDuration&&message.hasOwnProperty("maxAdSlotDuration")&&(object.maxAdSlotDuration=message.maxAdSlotDuration),null!=message.numberOfAdSlots&&message.hasOwnProperty("numberOfAdSlots")&&(object.numberOfAdSlots=message.numberOfAdSlots),object},ProtoAdBreak}(),$root.ProtoOutstreamInitialRenderingEnum=(valuesById={},(values=Object.create(valuesById))[valuesById[0]="ExpandWithAd"]=0,values[valuesById[1]="FullyRendered"]=1,values),$root.ProtoOutstreamEndAdBreakPolicyEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Hide"]=0,values[valuesById[1]="HouseScreen"]=1,values[valuesById[2]="Loop"]=2,values}(),$root.ProtoGalleryStyleMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="None"]=0,values[valuesById[1]="Detailed"]=1,values[valuesById[2]="Visual"]=2,values}(),$root.ProtoLogoPositionMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="None"]=0,values[valuesById[1]="ControlBar"]=1,values[valuesById[2]="BottomRight"]=2,values[valuesById[3]="BottomLeft"]=3,values[valuesById[4]="TopRight"]=4,values[valuesById[5]="TopLeft"]=5,values[valuesById[6]="Center"]=6,values}(),$root.ProtoGalleryOrientationEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Landscape"]=0,values[valuesById[1]="Portrait"]=1,values}(),$root.ProtoElementsTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="InStream"]=0,values[valuesById[1]="OutStream"]=1,values[valuesById[2]="InStreamInApp"]=2,values[valuesById[3]="Live"]=3,values}(),$root.ProtoPlayerUpNextMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Loop"]=0,values[valuesById[1]="Next"]=1,values[valuesById[2]="Stop"]=2,values}(),$root.ProtoCreativeTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="ThirdParty"]=0,values[valuesById[1]="MediaFile"]=1,values[valuesById[2]="Rtb"]=2,values[valuesById[3]="External"]=3,values[valuesById[4]="HeaderBidder"]=4,values[valuesById[7]="Tam"]=7,values[valuesById[8]="TamDeal"]=8,values}(),$root.ProtoResetCapTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="TimeCapping"]=0,values[valuesById[1]="ContentCapping"]=1,values[valuesById[2]="OpportunityCapping"]=2,values}(),$root.ProtoAdSlotsEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="PreRoll"]=0,values[valuesById[1]="MidRoll"]=1,values[valuesById[2]="PostRoll"]=2,values}(),$root.ProtoLineItemPriority=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="House"]=0,values[valuesById[1]="Default"]=1,values[valuesById[2]="Preferred"]=2,values[valuesById[3]="Top"]=3,values}(),$root.ProtoAdSkipMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="IfLongerThan31Sec"]=0,values[valuesById[1]="Always"]=1,values[valuesById[2]="Never"]=2,values[valuesById[3]="NotAplicable"]=3,values}(),$root.ProtoAdType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Video"]=0,values[valuesById[1]="Overlay"]=1,values}(),$root.ProtoChoiceCriteriaEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Only"]=0,values[valuesById[1]="Except"]=1,values}(),$root.ProtoLineItemAdBreakTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[1]="All"]=1,values[valuesById[2]="SingleAd"]=2,values[valuesById[3]="AdPod"]=3,values}(),$root.ProtoLineItemTargetingTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Only"]=0,values[valuesById[1]="Except"]=1,values}(),$root.ProtoLineItemAdSlotTargetingTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[1]="SpecificSlots"]=1,values[valuesById[2]="Interval"]=2,values}(),$root.ProtoLineItemPauseAdOutOfViewEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Default"]=0,values[valuesById[1]="Strict"]=1,values}(),$root.ProtoLineItemContextualTargetingEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="IncludeAny"]=0,values[valuesById[1]="IncludeAll"]=1,values[valuesById[2]="ExcludeAny"]=2,values[valuesById[3]="ExcludeAll"]=3,values}(),$root.ProtoSizeChoiceCriteriaEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="GreaterThan"]=0,values[valuesById[1]="SmallerThan"]=1,values[valuesById[2]="Between"]=2,values}(),$root.ProtoTrackerType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Image"]=0,values[valuesById[1]="Javascript"]=1,values}(),$root.ProtoTrackerTriggerType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Impression"]=0,values[valuesById[1]="Complete25Pc"]=1,values[valuesById[2]="Complete50Pc"]=2,values[valuesById[3]="Complete75Pc"]=3,values[valuesById[4]="ViewCompletion"]=4,values[valuesById[5]="VideoClick"]=5,values[valuesById[6]="Pause"]=6,values[valuesById[7]="Resume"]=7,values[valuesById[8]="Mute"]=8,values[valuesById[9]="Unmute"]=9,values}(),$root.ProtoPlayerPlaybackModeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Autoplay"]=0,values[valuesById[1]="ScrollToPlay"]=1,values[valuesById[2]="ClickToPlay"]=2,values}(),$root.ProtoPlayerCloseButtonMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Off"]=0,values[valuesById[1]="OnHover"]=1,values[valuesById[2]="OnHoverAfterFirstAd"]=2,values[valuesById[3]="AlwaysOn"]=3,values}(),$root.ProtoPlayerFloatingMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Off"]=0,values[valuesById[1]="OnPageLoad"]=1,values[valuesById[2]="AfterInView"]=2,values[valuesById[3]="Always"]=3,values}(),$root.ProtoPlayerSoundMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Mute"]=0,values[valuesById[1]="On"]=1,values[valuesById[2]="Hover"]=2,values}(),$root.ProtoPlayerInsertMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="WithinContainer"]=0,values[valuesById[1]="BeforeContainer"]=1,values[valuesById[2]="AfterContainer"]=2,values[valuesById[3]="ReplaceContainer"]=3,values[valuesById[4]="HideContainer"]=4,values}(),$root.ProtoAdViewabilityPolicy=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Default"]=0,values[valuesById[1]="Strict"]=1,values}(),$root.ProtoSharingDestination=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Facebook"]=0,values[valuesById[1]="Twitter"]=1,values[valuesById[2]="LinkedIn"]=2,values}(),$root.ProtoFloatingFixedPositionMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Page"]=0,values[valuesById[1]="Element"]=1,values}(),$root.ProtoPositionMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="BottomRight"]=0,values[valuesById[1]="BottomLeft"]=1,values[valuesById[2]="TopRight"]=2,values[valuesById[3]="TopLeft"]=3,values}(),$root.ProtoAdPlaybackMode=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Autoplay"]=0,values[valuesById[1]="ScrollToPlay"]=1,values}(),$root.ProtoFloatingAppendLocationEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Above"]=0,values[valuesById[1]="Below"]=1,values[valuesById[2]="Within"]=2,values}(),$root.ProtoPlayerAdSkippability=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="IfLongerThan"]=0,values[valuesById[1]="Always"]=1,values[valuesById[2]="NoRestrictions"]=2,values}(),$root.ProtoVideoQuality=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Auto"]=0,values[valuesById[1]="High1080p"]=1,values[valuesById[2]="High720p"]=2,values[valuesById[3]="Medium360p"]=3,values}(),$root.ProtoImplementationType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Web"]=0,values[valuesById[1]="Amp"]=1,values}(),$root.ProtoAdBreakTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="None"]=0,values[valuesById[1]="PreRoll"]=1,values[valuesById[2]="MidRoll"]=2,values[valuesById[3]="PostRoll"]=3,values}(),$root.ProtoAdSlotAdTypeEnum=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="SingleAd"]=0,values[valuesById[1]="AdPod"]=1,values}(),$root.ProtoDeviceType=function(){var valuesById={},values=Object.create(valuesById);return values[valuesById[0]="Desktop"]=0,values[valuesById[1]="Smartphone"]=1,values[valuesById[2]="Tablet"]=2,values[valuesById[3]="GameConsole"]=3,values[valuesById[4]="SmartTV"]=4,values[valuesById[5]="WearableComputer"]=5,values[valuesById[6]="PDA"]=6,values[valuesById[7]="Unrecognized"]=7,values}(),module.exports=$root},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"j",function(){return SESSION_CLIENT_VERSION}),__webpack_require__.d(__webpack_exports__,"k",function(){return VERIFICATION_CLIENT_VERSION}),__webpack_require__.d(__webpack_exports__,"i",function(){return PARTNER_NAME}),__webpack_require__.d(__webpack_exports__,"d",function(){return OmidErrorTypeEnum}),__webpack_require__.d(__webpack_exports__,"g",function(){return OmidInteractionTypeEnum}),__webpack_require__.d(__webpack_exports__,"h",function(){return OmidVideoPositionEnum}),__webpack_require__.d(__webpack_exports__,"b",function(){return OmidAdSessionEventsEnum}),__webpack_require__.d(__webpack_exports__,"f",function(){return OmidImpressionTypeEnum}),__webpack_require__.d(__webpack_exports__,"c",function(){return OmidCreativeTypeEnum}),__webpack_require__.d(__webpack_exports__,"e",function(){return OmidEventsEnum}),__webpack_require__.d(__webpack_exports__,"a",function(){return AdViewReasonsEnum});var OmidErrorTypeEnum,OmidInteractionTypeEnum,OmidVideoPositionEnum,OmidAdSessionEventsEnum,OmidImpressionTypeEnum,OmidCreativeTypeEnum,OmidEventsEnum,AdViewReasonsEnum,SESSION_CLIENT_VERSION="1.3.13-iab2343",VERIFICATION_CLIENT_VERSION="1.3.13-iab2343",PARTNER_NAME="Connatix";!function(OmidErrorTypeEnum){OmidErrorTypeEnum.Generic="generic",OmidErrorTypeEnum.Video="video"}(OmidErrorTypeEnum||(OmidErrorTypeEnum={})),function(OmidInteractionTypeEnum){OmidInteractionTypeEnum.Click="click",OmidInteractionTypeEnum.InvitationAccept="invitationAccept"}(OmidInteractionTypeEnum||(OmidInteractionTypeEnum={})),function(OmidVideoPositionEnum){OmidVideoPositionEnum.PreRoll="preroll",OmidVideoPositionEnum.MidRoll="midroll",OmidVideoPositionEnum.PostRoll="postroll",OmidVideoPositionEnum.Standalone="standalone"}(OmidVideoPositionEnum||(OmidVideoPositionEnum={})),function(OmidAdSessionEventsEnum){OmidAdSessionEventsEnum.SessionStart="sessionStart",OmidAdSessionEventsEnum.SessionError="sessionError",OmidAdSessionEventsEnum.SessionFinish="sessionFinish"}(OmidAdSessionEventsEnum||(OmidAdSessionEventsEnum={})),function(OmidImpressionTypeEnum){OmidImpressionTypeEnum.DefinedByJavascript="definedByJavaScript",OmidImpressionTypeEnum.BeginToRender="beginToRender"}(OmidImpressionTypeEnum||(OmidImpressionTypeEnum={})),function(OmidCreativeTypeEnum){OmidCreativeTypeEnum.DefinedByJavascript="definedByJavaScript",OmidCreativeTypeEnum.Video="video"}(OmidCreativeTypeEnum||(OmidCreativeTypeEnum={})),function(OmidEventsEnum){OmidEventsEnum.sessionError="sessionError",OmidEventsEnum.geometryChange="geometryChange"}(OmidEventsEnum||(OmidEventsEnum={})),function(AdViewReasonsEnum){AdViewReasonsEnum.backgrounded="backgrounded",AdViewReasonsEnum.notFound="notFound"}(AdViewReasonsEnum||(AdViewReasonsEnum={}))},function(module,__webpack_exports__,__webpack_require__){"use strict";var Subscriber=__webpack_require__(40);var rxSubscriber=__webpack_require__(71),Observer=__webpack_require__(79);var observable=__webpack_require__(61),identity=__webpack_require__(103);function pipeFromArray(fns){return 0===fns.length?identity.a:1===fns.length?fns[0]:function(input){return fns.reduce(function(prev,fn){return fn(prev)},input)}}var config=__webpack_require__(50);__webpack_require__.d(__webpack_exports__,"a",function(){return Observable_Observable});var Observable_Observable=function(){function Observable(subscribe){this._isScalar=!1,subscribe&&(this._subscribe=subscribe)}return Observable.prototype.lift=function(operator){var observable=new Observable;return observable.source=this,observable.operator=operator,observable},Observable.prototype.subscribe=function(observerOrNext,error,complete){var operator=this.operator,sink=function(nextOrObserver,error,complete){if(nextOrObserver){if(nextOrObserver instanceof Subscriber.a)return nextOrObserver;if(nextOrObserver[rxSubscriber.a])return nextOrObserver[rxSubscriber.a]()}return nextOrObserver||error||complete?new Subscriber.a(nextOrObserver,error,complete):new Subscriber.a(Observer.a)}(observerOrNext,error,complete);if(operator?sink.add(operator.call(sink,this.source)):sink.add(this.source||config.a.useDeprecatedSynchronousErrorHandling&&!sink.syncErrorThrowable?this._subscribe(sink):this._trySubscribe(sink)),config.a.useDeprecatedSynchronousErrorHandling&&sink.syncErrorThrowable&&(sink.syncErrorThrowable=!1,sink.syncErrorThrown))throw sink.syncErrorValue;return sink},Observable.prototype._trySubscribe=function(sink){try{return this._subscribe(sink)}catch(err){config.a.useDeprecatedSynchronousErrorHandling&&(sink.syncErrorThrown=!0,sink.syncErrorValue=err),!function(observer){for(;observer;){var _a=observer,closed_1=_a.closed,destination=_a.destination,isStopped=_a.isStopped;if(closed_1||isStopped)return!1;observer=destination&&destination instanceof Subscriber.a?destination:null}return!0}(sink)?console.warn(err):sink.error(err)}},Observable.prototype.forEach=function(next,promiseCtor){var _this=this;return new(promiseCtor=getPromiseCtor(promiseCtor))(function(resolve,reject){var subscription;subscription=_this.subscribe(function(value){try{next(value)}catch(err){reject(err),subscription&&subscription.unsubscribe()}},reject,resolve)})},Observable.prototype._subscribe=function(subscriber){var source=this.source;return source&&source.subscribe(subscriber)},Observable.prototype[observable.a]=function(){return this},Observable.prototype.pipe=function(){for(var operations=[],_i=0;_i<arguments.length;_i++)operations[_i]=arguments[_i];return 0===operations.length?this:pipeFromArray(operations)(this)},Observable.prototype.toPromise=function(promiseCtor){var _this=this;return new(promiseCtor=getPromiseCtor(promiseCtor))(function(resolve,reject){var value;_this.subscribe(function(x){return value=x},function(err){return reject(err)},function(){return resolve(value)})})},Observable.create=function(subscribe){return new Observable(subscribe)},Observable}();function getPromiseCtor(promiseCtor){if(promiseCtor||(promiseCtor=config.a.Promise||Promise),!promiseCtor)throw new Error("no Promise impl found");return promiseCtor}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"f",function(){return YO_SCORE_MULTIPLIER}),__webpack_require__.d(__webpack_exports__,"g",function(){return YO_SCORE_PENALIZE_COEFFICIENT}),__webpack_require__.d(__webpack_exports__,"h",function(){return YO_SCORE_RECOMPENSE_COEFFICIENT}),__webpack_require__.d(__webpack_exports__,"d",function(){return SKIPPABILITY_LIMITATION_SECS}),__webpack_require__.d(__webpack_exports__,"b",function(){return AD_VIEWABLE_IMPRESSION_VIDEO}),__webpack_require__.d(__webpack_exports__,"a",function(){return AD_VIEWABLE_IMPRESSION_OVERLAY}),__webpack_require__.d(__webpack_exports__,"e",function(){return VIEWABILITY_THRESHOLD}),__webpack_require__.d(__webpack_exports__,"c",function(){return CNX_SUPPLIER_ID});var YO_SCORE_MULTIPLIER=200,YO_SCORE_PENALIZE_COEFFICIENT=.9,YO_SCORE_RECOMPENSE_COEFFICIENT=1.1,SKIPPABILITY_LIMITATION_SECS=31,AD_VIEWABLE_IMPRESSION_VIDEO=2e3,AD_VIEWABLE_IMPRESSION_OVERLAY=1e3,VIEWABILITY_THRESHOLD=.5,CNX_SUPPLIER_ID="connatix.com"},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Subscriber});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(31),_util_isFunction__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(72),_Observer__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(79),_Subscription__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(43),_internal_symbol_rxSubscriber__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(71),_config__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(50),_util_hostReportError__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(64),Subscriber=function(_super){function Subscriber(destinationOrNext,error,complete){var _this=_super.call(this)||this;switch(_this.syncErrorValue=null,_this.syncErrorThrown=!1,_this.syncErrorThrowable=!1,_this.isStopped=!1,arguments.length){case 0:_this.destination=_Observer__WEBPACK_IMPORTED_MODULE_2__.a;break;case 1:if(!destinationOrNext){_this.destination=_Observer__WEBPACK_IMPORTED_MODULE_2__.a;break}if("object"==typeof destinationOrNext){destinationOrNext instanceof Subscriber?(_this.syncErrorThrowable=destinationOrNext.syncErrorThrowable,_this.destination=destinationOrNext,destinationOrNext.add(_this)):(_this.syncErrorThrowable=!0,_this.destination=new SafeSubscriber(_this,destinationOrNext));break}default:_this.syncErrorThrowable=!0,_this.destination=new SafeSubscriber(_this,destinationOrNext,error,complete)}return _this}return tslib__WEBPACK_IMPORTED_MODULE_0__.a(Subscriber,_super),Subscriber.prototype[_internal_symbol_rxSubscriber__WEBPACK_IMPORTED_MODULE_4__.a]=function(){return this},Subscriber.create=function(next,error,complete){var subscriber=new Subscriber(next,error,complete);return subscriber.syncErrorThrowable=!1,subscriber},Subscriber.prototype.next=function(value){this.isStopped||this._next(value)},Subscriber.prototype.error=function(err){this.isStopped||(this.isStopped=!0,this._error(err))},Subscriber.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},Subscriber.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,_super.prototype.unsubscribe.call(this))},Subscriber.prototype._next=function(value){this.destination.next(value)},Subscriber.prototype._error=function(err){this.destination.error(err),this.unsubscribe()},Subscriber.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},Subscriber.prototype._unsubscribeAndRecycle=function(){var _parentOrParents=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=_parentOrParents,this},Subscriber}(_Subscription__WEBPACK_IMPORTED_MODULE_3__.a),SafeSubscriber=function(_super){function SafeSubscriber(_parentSubscriber,observerOrNext,error,complete){var next,_this=_super.call(this)||this;_this._parentSubscriber=_parentSubscriber;var context=_this;return Object(_util_isFunction__WEBPACK_IMPORTED_MODULE_1__.a)(observerOrNext)?next=observerOrNext:observerOrNext&&(next=observerOrNext.next,error=observerOrNext.error,complete=observerOrNext.complete,observerOrNext!==_Observer__WEBPACK_IMPORTED_MODULE_2__.a&&(context=Object.create(observerOrNext),Object(_util_isFunction__WEBPACK_IMPORTED_MODULE_1__.a)(context.unsubscribe)&&_this.add(context.unsubscribe.bind(context)),context.unsubscribe=_this.unsubscribe.bind(_this))),_this._context=context,_this._next=next,_this._error=error,_this._complete=complete,_this}return tslib__WEBPACK_IMPORTED_MODULE_0__.a(SafeSubscriber,_super),SafeSubscriber.prototype.next=function(value){if(!this.isStopped&&this._next){var _parentSubscriber=this._parentSubscriber;_config__WEBPACK_IMPORTED_MODULE_5__.a.useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?this.__tryOrSetError(_parentSubscriber,this._next,value)&&this.unsubscribe():this.__tryOrUnsub(this._next,value)}},SafeSubscriber.prototype.error=function(err){if(!this.isStopped){var _parentSubscriber=this._parentSubscriber,useDeprecatedSynchronousErrorHandling=_config__WEBPACK_IMPORTED_MODULE_5__.a.useDeprecatedSynchronousErrorHandling;if(this._error)useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?(this.__tryOrSetError(_parentSubscriber,this._error,err),this.unsubscribe()):(this.__tryOrUnsub(this._error,err),this.unsubscribe());else if(_parentSubscriber.syncErrorThrowable)useDeprecatedSynchronousErrorHandling?(_parentSubscriber.syncErrorValue=err,_parentSubscriber.syncErrorThrown=!0):Object(_util_hostReportError__WEBPACK_IMPORTED_MODULE_6__.a)(err),this.unsubscribe();else{if(this.unsubscribe(),useDeprecatedSynchronousErrorHandling)throw err;Object(_util_hostReportError__WEBPACK_IMPORTED_MODULE_6__.a)(err)}}},SafeSubscriber.prototype.complete=function(){var _this=this;if(!this.isStopped){var _parentSubscriber=this._parentSubscriber;if(this._complete){var wrappedComplete=function(){return _this._complete.call(_this._context)};_config__WEBPACK_IMPORTED_MODULE_5__.a.useDeprecatedSynchronousErrorHandling&&_parentSubscriber.syncErrorThrowable?(this.__tryOrSetError(_parentSubscriber,wrappedComplete),this.unsubscribe()):(this.__tryOrUnsub(wrappedComplete),this.unsubscribe())}else this.unsubscribe()}},SafeSubscriber.prototype.__tryOrUnsub=function(fn,value){try{fn.call(this._context,value)}catch(err){if(this.unsubscribe(),_config__WEBPACK_IMPORTED_MODULE_5__.a.useDeprecatedSynchronousErrorHandling)throw err;Object(_util_hostReportError__WEBPACK_IMPORTED_MODULE_6__.a)(err)}},SafeSubscriber.prototype.__tryOrSetError=function(parent,fn,value){if(!_config__WEBPACK_IMPORTED_MODULE_5__.a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{fn.call(this._context,value)}catch(err){return _config__WEBPACK_IMPORTED_MODULE_5__.a.useDeprecatedSynchronousErrorHandling?(parent.syncErrorValue=err,parent.syncErrorThrown=!0,!0):(Object(_util_hostReportError__WEBPACK_IMPORTED_MODULE_6__.a)(err),!0)}return!1},SafeSubscriber.prototype._unsubscribe=function(){var _parentSubscriber=this._parentSubscriber;this._context=null,this._parentSubscriber=null,_parentSubscriber.unsubscribe()},SafeSubscriber}(Subscriber)},,function(module,__webpack_exports__,__webpack_require__){"use strict";var VendorIdsEnum;__webpack_require__.d(__webpack_exports__,"c",function(){return VendorIdsEnum}),__webpack_require__.d(__webpack_exports__,"a",function(){return GLOBAL_STORAGE_NAME}),__webpack_require__.d(__webpack_exports__,"b",function(){return US_PRIVACY_STRINGS_SELLABLE}),function(VendorIdsEnum){VendorIdsEnum.Connatix="143",VendorIdsEnum.AppNexus="32",VendorIdsEnum.DistrictM="144",VendorIdsEnum.IndexExchange="10",VendorIdsEnum.Lkqd="237",VendorIdsEnum.OneVideo="25",VendorIdsEnum.Openx="69",VendorIdsEnum.Pubmatic="76",VendorIdsEnum.RhythmOne="36",VendorIdsEnum.Rubicon="52",VendorIdsEnum.Spotx="165",VendorIdsEnum.Telaria="202",VendorIdsEnum.MediaNet="142",VendorIdsEnum.AdMan="149",VendorIdsEnum.IronSource="",VendorIdsEnum.Undertone="677",VendorIdsEnum.SynacorMedia="",VendorIdsEnum.AmxRTB="737",VendorIdsEnum.Smaato="82"}(VendorIdsEnum||(VendorIdsEnum={}));var GLOBAL_STORAGE_NAME="cnx_usr_storage",US_PRIVACY_STRINGS_SELLABLE=["1YNY"]},function(module,__webpack_exports__,__webpack_require__){"use strict";var isArray=__webpack_require__(101),isObject=__webpack_require__(102),isFunction=__webpack_require__(72),UnsubscriptionError=function(){function UnsubscriptionErrorImpl(errors){return Error.call(this),this.message=errors?errors.length+" errors occurred during unsubscription:\n"+errors.map(function(err,i){return i+1+") "+err.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=errors,this}return UnsubscriptionErrorImpl.prototype=Object.create(Error.prototype),UnsubscriptionErrorImpl}();__webpack_require__.d(__webpack_exports__,"a",function(){return Subscription_Subscription});var Subscription_Subscription=function(){function Subscription(unsubscribe){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,unsubscribe&&(this._ctorUnsubscribe=!0,this._unsubscribe=unsubscribe)}var empty;return Subscription.prototype.unsubscribe=function(){var errors;if(!this.closed){var _parentOrParents=this._parentOrParents,_ctorUnsubscribe=this._ctorUnsubscribe,_unsubscribe=this._unsubscribe,_subscriptions=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,_parentOrParents instanceof Subscription)_parentOrParents.remove(this);else if(null!==_parentOrParents)for(var index=0;index<_parentOrParents.length;++index){_parentOrParents[index].remove(this)}if(Object(isFunction.a)(_unsubscribe)){_ctorUnsubscribe&&(this._unsubscribe=void 0);try{_unsubscribe.call(this)}catch(e){errors=e instanceof UnsubscriptionError?flattenUnsubscriptionErrors(e.errors):[e]}}if(Object(isArray.a)(_subscriptions)){index=-1;for(var len=_subscriptions.length;++index<len;){var sub=_subscriptions[index];if(Object(isObject.a)(sub))try{sub.unsubscribe()}catch(e){errors=errors||[],e instanceof UnsubscriptionError?errors=errors.concat(flattenUnsubscriptionErrors(e.errors)):errors.push(e)}}}if(errors)throw new UnsubscriptionError(errors)}},Subscription.prototype.add=function(teardown){var subscription=teardown;if(!teardown)return Subscription.EMPTY;switch(typeof teardown){case"function":subscription=new Subscription(teardown);case"object":if(subscription===this||subscription.closed||"function"!=typeof subscription.unsubscribe)return subscription;if(this.closed)return subscription.unsubscribe(),subscription;if(!(subscription instanceof Subscription)){var tmp=subscription;(subscription=new Subscription)._subscriptions=[tmp]}break;default:throw new Error("unrecognized teardown "+teardown+" added to Subscription.")}var _parentOrParents=subscription._parentOrParents;if(null===_parentOrParents)subscription._parentOrParents=this;else if(_parentOrParents instanceof Subscription){if(_parentOrParents===this)return subscription;subscription._parentOrParents=[_parentOrParents,this]}else{if(-1!==_parentOrParents.indexOf(this))return subscription;_parentOrParents.push(this)}var subscriptions=this._subscriptions;return null===subscriptions?this._subscriptions=[subscription]:subscriptions.push(subscription),subscription},Subscription.prototype.remove=function(subscription){var subscriptions=this._subscriptions;if(subscriptions){var subscriptionIndex=subscriptions.indexOf(subscription);-1!==subscriptionIndex&&subscriptions.splice(subscriptionIndex,1)}},Subscription.EMPTY=((empty=new Subscription).closed=!0,empty),Subscription}();function flattenUnsubscriptionErrors(errors){return errors.reduce(function(errs,err){return errs.concat(err instanceof UnsubscriptionError?err.errors:err)},[])}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return LoggingStorage});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),LoggingStorage=function LoggingStorage(){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,LoggingStorage)};LoggingStorage.MaxLogOverflow=1e3,LoggingStorage.maxLogOverflowCount={},LoggingStorage.logCount={},LoggingStorage.maxLogSent={},LoggingStorage.sessionId="",LoggingStorage.pageFocus=!1,LoggingStorage.incrementLogCount=function(message){LoggingStorage.logCount[message]?(++LoggingStorage.maxLogOverflowCount[message],++LoggingStorage.logCount[message]):(LoggingStorage.logCount[message]=1,LoggingStorage.maxLogOverflowCount[message]=1)},LoggingStorage.isMaxLog=function(message,throttle){return!!(LoggingStorage.logCount[message]&&LoggingStorage.logCount[message]>throttle)},LoggingStorage.isMaxLogOverflow=function(message){return LoggingStorage.maxLogOverflowCount[message]>LoggingStorage.MaxLogOverflow&&(LoggingStorage.maxLogOverflowCount[message]=1,!0)},LoggingStorage.setMaxLogSent=function(message){LoggingStorage.maxLogSent[message]=!0},LoggingStorage.isMaxLogSent=function(message){return!!LoggingStorage.maxLogSent[message]}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return getObjectValues}),__webpack_require__.d(__webpack_exports__,"c",function(){return serializeObject}),__webpack_require__.d(__webpack_exports__,"b",function(){return isEqualObjects});var _GeneralUtils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(15),_TypeUtils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4),getObjectValues=function(object){return Object.keys(object).map(function(key){return object[key]})};function serializeObject(object){for(var prop in object)object.hasOwnProperty(prop)&&"string"==typeof object[prop]&&(object[prop]="%22".concat(encodeURIComponent(object[prop]),"%22"));return JSON.stringify(object).cnx_replaceAll('"',"")}function isEqualObjects(a,b){if(!Object(_TypeUtils__WEBPACK_IMPORTED_MODULE_1__.f)(a)||!Object(_TypeUtils__WEBPACK_IMPORTED_MODULE_1__.f)(b))return!1;var aProps=Object.getOwnPropertyNames(a),bProps=Object.getOwnPropertyNames(b);return aProps.length===bProps.length&&aProps.every(function(propName){return Object(_GeneralUtils__WEBPACK_IMPORTED_MODULE_0__.i)(a[propName],b[propName])})}},function(module,__webpack_exports__,__webpack_require__){"use strict";var classCallCheck=__webpack_require__(1),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(2),createClass_default=__webpack_require__.n(createClass),GoogleConfig=__webpack_require__(100),CSS_CLASSES=["adBanner","banner-search","abc_banner","Banner_Top","ad_container","pub_300x250","pub_300x250m","pub_728x90","text-ad","text_ad","textAd","text-ad-links","text_ads","text-ads","text-ad-links"],protos=__webpack_require__(0),DomUtils=__webpack_require__(5),GeneralUtils=__webpack_require__(15),Logging=__webpack_require__(11),tslib_es6=__webpack_require__(31),Subject=__webpack_require__(220),ObjectUnsubscribedError=__webpack_require__(68),BehaviorSubject_BehaviorSubject=function(_super){function BehaviorSubject(_value){var _this=_super.call(this)||this;return _this._value=_value,_this}return tslib_es6.a(BehaviorSubject,_super),Object.defineProperty(BehaviorSubject.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),BehaviorSubject.prototype._subscribe=function(subscriber){var subscription=_super.prototype._subscribe.call(this,subscriber);return subscription&&!subscription.closed&&subscriber.next(this._value),subscription},BehaviorSubject.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ObjectUnsubscribedError.a;return this._value},BehaviorSubject.prototype.next=function(value){_super.prototype.next.call(this,this._value=value)},BehaviorSubject}(Subject.a),filter=__webpack_require__(305);__webpack_require__.d(__webpack_exports__,"a",function(){return AdBlockerDetectionService_AdBlockerDetectionService});var AdBlockerDetectionService_AdBlockerDetectionService=function(){function AdBlockerDetectionService(){classCallCheck_default()(this,AdBlockerDetectionService)}return createClass_default()(AdBlockerDetectionService,null,[{key:"onAdBlockerDetected",value:function(){return this._onAdBlockerDetected.asObservable().pipe(Object(filter.a)(function(value){return null!==value}))}},{key:"detectUsingCSS",value:function(global){try{var foundAdBlocker=!1;global.document.body.insertAdjacentHTML("beforeend",this._getAdBannerTemplate());var element=global.document.getElementById("cnxtestadblock");return 0!==element.getBoundingClientRect().height&&0!==element.getBoundingClientRect().width||(foundAdBlocker=!0),global.document.body.removeChild(element),this._onCSSDetection(foundAdBlocker),foundAdBlocker}catch(e){return this._onCSSDetection(!1),!1}}},{key:"detectUsingScript",value:function(){var _this=this;return new Promise(function(resolve){var topFrame=Object(GeneralUtils.f)(window).topFrame,resolvePromise=function(hasAdBlocker){_this._onAdBlockerDetected.next(hasAdBlocker),_this._onAdBlockerDetected.complete(),resolve(hasAdBlocker)};topFrame.googletag&&resolvePromise(!1),Object(DomUtils.A)({src:GoogleConfig.a},topFrame.document.head,topFrame,function(){return topFrame.googletag?resolvePromise(!1):resolvePromise(!0)},function(){return resolvePromise(!0)})})}},{key:"_onCSSDetection",value:function(flag){null!==this._bannerDetected&&this._bannerDetected!==flag&&Object(Logging.a)({message:"AdBlockerDetection_changed_after_new_global",throttle:2,sendMaxLog:!1,level:protos.ProtoLoggingLevelEnum.INFO,exception:"".concat(this._bannerDetected)}),this._bannerDetected=flag,this._bannerDetected&&(this._onAdBlockerDetected.next(!0),this._onAdBlockerDetected.complete())}},{key:"_getAdBannerTemplate",value:function(){var cssClasses=CSS_CLASSES.join(" ");return'<style>.adBanner{background-color: transparent; height: 1px !important; width: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important; display:block !important; }</style><div id="'.concat("cnxtestadblock",'" class="').concat(cssClasses,'"></div>')}},{key:"isBannerBlocked",get:function(){return this._bannerDetected}}]),AdBlockerDetectionService}();AdBlockerDetectionService_AdBlockerDetectionService._bannerDetected=null,AdBlockerDetectionService_AdBlockerDetectionService._onAdBlockerDetected=new BehaviorSubject_BehaviorSubject(null)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return durationToMs}),__webpack_require__.d(__webpack_exports__,"d",function(){return offsetToMs}),__webpack_require__.d(__webpack_exports__,"b",function(){return generateExpireTimestamp}),__webpack_require__.d(__webpack_exports__,"f",function(){return timeToString}),__webpack_require__.d(__webpack_exports__,"e",function(){return timeSince}),__webpack_require__.d(__webpack_exports__,"c",function(){return isCurrentDateInsideInterval});var _TypeUtils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4),Common_Config_TimeConfig__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(20);function durationToMs(durationStr){var match,durationInMs;return Object(_TypeUtils__WEBPACK_IMPORTED_MODULE_0__.g)(durationStr)&&(match=durationStr.match(Common_Config_TimeConfig__WEBPACK_IMPORTED_MODULE_1__.b))&&(durationInMs=parseInt(match[1],10)*Common_Config_TimeConfig__WEBPACK_IMPORTED_MODULE_1__.d+parseInt(match[2],10)*Common_Config_TimeConfig__WEBPACK_IMPORTED_MODULE_1__.e+parseInt(match[3],10)*Common_Config_TimeConfig__WEBPACK_IMPORTED_MODULE_1__.f+parseInt(match[5]||0,10)),isNaN(durationInMs)?null:durationInMs}function offsetToMs(offset,duration){return/^\d+(\.\d+)?%$/g.test(offset)?duration?duration*parseFloat(offset.replace("%",""))/100:null:durationToMs(offset)}function generateExpireTimestamp(daysExpire){return Date.now()+daysExpire*Common_Config_TimeConfig__WEBPACK_IMPORTED_MODULE_1__.a}function timeToString(seconds){var separator=arguments.length>1&&void 0!==arguments[1]?arguments[1]:":",toString=function(number){return number>=10?number:"0".concat(number)},computedMinutes=toString(Math.floor(seconds/60)),computedSeconds=toString(Math.floor(seconds%60));return"".concat(computedMinutes).concat(separator).concat(computedSeconds)}function timeSince(date){var parsedDate=Date.parse(date+" GMT");if(Object(_TypeUtils__WEBPACK_IMPORTED_MODULE_0__.d)(parsedDate)){var seconds=Math.floor((Date.parse(new Date(Date.now()).toUTCString())-parsedDate)/1e3);if(!Object(_TypeUtils__WEBPACK_IMPORTED_MODULE_0__.e)(seconds))return"just now";var i,thresholds=[{value:1,symbol:"s"},{value:60,symbol:"m"},{value:3599,symbol:"h"},{value:86399,symbol:"d"}];for(i=thresholds.length-1;i>0&&!(seconds>=thresholds[i].value);i--);return Math.floor(seconds/thresholds[i].value).toFixed(0)+thresholds[i].symbol+" ago"}}function isCurrentDateInsideInterval(startDate,endDate){var currentTimestamp=Date.now();return!(currentTimestamp<startDate||currentTimestamp>endDate)}},function(module,exports){module.exports="object"==typeof window&&window&&window.Math==Math?window:"object"==typeof self&&self&&self.Math==Math?self:Function("return this")()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return CONNATIX_PRIVACY_PAGE}),__webpack_require__.d(__webpack_exports__,"b",function(){return PLAYER_VERSION_KEY});var CONNATIX_PRIVACY_PAGE="https://connatix.com/privacy-policy/",PLAYER_VERSION_KEY="v"},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return config});var _enable_super_gross_mode_that_will_cause_bad_things=!1,config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(value){value&&(new Error).stack;_enable_super_gross_mode_that_will_cause_bad_things=value},get useDeprecatedSynchronousErrorHandling(){return _enable_super_gross_mode_that_will_cause_bad_things}}},function(module,exports,__webpack_require__){"use strict";function __export(r){for(var e in r)exports.hasOwnProperty(e)||(exports[e]=r[e])}Object.defineProperty(exports,"__esModule",{value:!0}),__export(__webpack_require__(277)),__export(__webpack_require__(278)),__export(__webpack_require__(279)),__export(__webpack_require__(280))},function(module,exports){function _typeof2(obj){return(_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _typeof(obj){return"function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?module.exports=_typeof=function(obj){return _typeof2(obj)}:module.exports=_typeof=function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},_typeof(obj)}module.exports=_typeof},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return ABServiceType}),__webpack_require__.d(__webpack_exports__,"a",function(){return ABService});var _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__),ElementsABService=function ElementsABService(){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this,ElementsABService)};ElementsABService.clientAb0=0,ElementsABService.clientAb1=0;var ABServiceType,PlayspaceABService=function PlayspaceABService(){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this,PlayspaceABService)};PlayspaceABService.clientAb0=0,PlayspaceABService.clientAb1=0,function(ABServiceType){ABServiceType[ABServiceType.ElementsABService=0]="ElementsABService",ABServiceType[ABServiceType.PlayspaceABService=1]="PlayspaceABService"}(ABServiceType||(ABServiceType={}));var ABService=function(){function ABService(){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this,ABService)}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_0___default()(ABService,null,[{key:"getABValueForKey",value:function(key){switch(this.abServiceType){case ABServiceType.PlayspaceABService:return PlayspaceABService[key];default:return ElementsABService[key]}}},{key:"clientAb0",get:function(){return this.getABValueForKey("clientAb0")}},{key:"clientAb1",get:function(){return this.getABValueForKey("clientAb1")}}]),ABService}()},function(module,exports,__webpack_require__){var store=__webpack_require__(83)("wks"),uid=__webpack_require__(94),Symbol=__webpack_require__(48).Symbol,NATIVE_SYMBOL=__webpack_require__(140);module.exports=function(name){return store[name]||(store[name]=NATIVE_SYMBOL&&Symbol[name]||(NATIVE_SYMBOL?Symbol:uid)("Symbol."+name))}},function(module,exports,__webpack_require__){"use strict";function __export(e){for(var r in e)exports.hasOwnProperty(r)||(exports[r]=e[r])}Object.defineProperty(exports,"__esModule",{value:!0}),__export(__webpack_require__(157)),__export(__webpack_require__(281)),__export(__webpack_require__(158)),__export(__webpack_require__(159)),__export(__webpack_require__(282)),__export(__webpack_require__(123)),__export(__webpack_require__(160)),__export(__webpack_require__(283)),__export(__webpack_require__(284))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return LoggingStateStorage});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),Common_Modules_Monetization_Config_MonetisationConfig__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(19),Common_Config_VastConfig__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10),Elements_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(36),LoggingStateStorage=function(){function LoggingStateStorage(){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,LoggingStateStorage)}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(LoggingStateStorage,null,[{key:"_generateLoggingId",value:function(){var currentLoggingId=LoggingStateStorage._loggingId;return LoggingStateStorage._loggingId++,currentLoggingId}},{key:"_getLineItemLoggingId",value:function(advertiserLineItemId){return LoggingStateStorage._adListMapping[advertiserLineItemId]}},{key:"_mapAdList",value:function(adList){adList.forEach(function(lineItem){LoggingStateStorage._adListMapping[lineItem.advertiserLineItemId]&&LoggingStateStorage.addCustomHistoryLine("duplicate",{id:lineItem.advertiserLineItemId}),LoggingStateStorage._adListMapping[lineItem.advertiserLineItemId]=LoggingStateStorage._generateLoggingId()})}},{key:"_stripLineItems",value:function(lineItems){return lineItems.map(function(lineItem){return{advertiserLineItemId:lineItem.advertiserLineItemId,creativeType:lineItem.creativeType,impressionTimeout:lineItem.impressionTimeSpent,lineItemPriority:lineItem.lineItemPriority,playerSize:lineItem.playerSize,requestCap:lineItem.requestCap,sound:lineItem.sound,viewability:lineItem.viewability}})}},{key:"setClientSideAdList",value:function(lineItems){LoggingStateStorage._isEnabled&&(LoggingStateStorage._clientAdList=LoggingStateStorage._stripLineItems(JSON.parse(JSON.stringify(lineItems))),LoggingStateStorage._mapAdList(LoggingStateStorage._clientAdList))}},{key:"setRtbAdList",value:function(lineItems){LoggingStateStorage._isEnabled&&(LoggingStateStorage._rtbAdList=LoggingStateStorage._stripLineItems(JSON.parse(JSON.stringify(lineItems))),LoggingStateStorage._mapAdList(LoggingStateStorage._rtbAdList))}},{key:"setHeaderBidderAdList",value:function(lineItems){LoggingStateStorage._isEnabled&&(LoggingStateStorage._headerBidderAdList=LoggingStateStorage._stripLineItems(JSON.parse(JSON.stringify(lineItems))),LoggingStateStorage._mapAdList(LoggingStateStorage._headerBidderAdList))}},{key:"setTamAdList",value:function(lineItems){LoggingStateStorage._isEnabled&&(LoggingStateStorage._tamAdList=LoggingStateStorage._stripLineItems(JSON.parse(JSON.stringify(lineItems))),LoggingStateStorage._mapAdList(LoggingStateStorage._tamAdList))}},{key:"setLineItemStatus",value:function(advertiserLineItemId,lineItemStatus){if(LoggingStateStorage._isEnabled){var loggingId=LoggingStateStorage._getLineItemLoggingId(advertiserLineItemId);LoggingStateStorage._flowHistory.push({type:"status",id:loggingId,status:Common_Modules_Monetization_Config_MonetisationConfig__WEBPACK_IMPORTED_MODULE_2__.a[lineItemStatus]})}}},{key:"setVpaidEvent",value:function(lineItemId,vpaidEvent){if(LoggingStateStorage._isEnabled)try{var loggingId=LoggingStateStorage._getLineItemLoggingId(lineItemId);switch(vpaidEvent){case Common_Config_VastConfig__WEBPACK_IMPORTED_MODULE_3__.b.AdLoaded:case Common_Config_VastConfig__WEBPACK_IMPORTED_MODULE_3__.b.AdStarted:case Common_Config_VastConfig__WEBPACK_IMPORTED_MODULE_3__.b.AdError:case Common_Config_VastConfig__WEBPACK_IMPORTED_MODULE_3__.b.AdSkipped:case Common_Config_VastConfig__WEBPACK_IMPORTED_MODULE_3__.b.AdStopped:case Common_Config_VastConfig__WEBPACK_IMPORTED_MODULE_3__.b.AdPaused:case Common_Config_VastConfig__WEBPACK_IMPORTED_MODULE_3__.b.AdPlaying:case Common_Config_VastConfig__WEBPACK_IMPORTED_MODULE_3__.b.AdImpression:LoggingStateStorage._flowHistory.push({type:"vpaid",id:loggingId,event:vpaidEvent})}}catch(e){}}},{key:"setViewabilityState",value:function(inView){LoggingStateStorage._isEnabled&&LoggingStateStorage._flowHistory.push({type:"view",inView:inView})}},{key:"setFocusState",value:function(inFocus){LoggingStateStorage._isEnabled&&LoggingStateStorage._flowHistory.push({type:"focus",inView:inFocus})}},{key:"setAdState",value:function(adState){LoggingStateStorage._isEnabled&&LoggingStateStorage._flowHistory.push({type:"adState",state:Elements_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_4__.ProtoAdSlotsEnum[adState]})}},{key:"enforcerAction",value:function(action){LoggingStateStorage._isEnabled&&LoggingStateStorage._flowHistory.push({type:"enforcer",action:action})}},{key:"addCustomHistoryLine",value:function(type,data){LoggingStateStorage._isEnabled&&LoggingStateStorage._flowHistory.push(Object.assign({type:type},data))}},{key:"getJsonString",value:function(){return LoggingStateStorage._isEnabled?JSON.stringify({clientAdList:LoggingStateStorage._clientAdList,rtbAdList:LoggingStateStorage._rtbAdList,headerBidderAdList:LoggingStateStorage._headerBidderAdList,mappedAdList:LoggingStateStorage._adListMapping,history:LoggingStateStorage._flowHistory}).substring(0,LoggingStateStorage._maxStringLength):""}},{key:"playerDestroyed",value:function(){this._playerDestroyed=!0}},{key:"isPlayerDestroyed",value:function(){return this._playerDestroyed}}]),LoggingStateStorage}();LoggingStateStorage._isEnabled=Date.now()-1581093917537<0,LoggingStateStorage._maxStringLength=5e4,LoggingStateStorage._loggingId=0,LoggingStateStorage._adListMapping={},LoggingStateStorage._clientAdList=[],LoggingStateStorage._rtbAdList=[],LoggingStateStorage._headerBidderAdList=[],LoggingStateStorage._tamAdList=[],LoggingStateStorage._flowHistory=[],LoggingStateStorage._playerDestroyed=!1},function(module,__webpack_exports__,__webpack_require__){"use strict";var UserConsentPurposeEnum;__webpack_require__.d(__webpack_exports__,"a",function(){return UserConsentPurposeEnum}),function(UserConsentPurposeEnum){UserConsentPurposeEnum[UserConsentPurposeEnum.P1=1]="P1",UserConsentPurposeEnum[UserConsentPurposeEnum.P2=2]="P2",UserConsentPurposeEnum[UserConsentPurposeEnum.P3=3]="P3",UserConsentPurposeEnum[UserConsentPurposeEnum.P4=4]="P4",UserConsentPurposeEnum[UserConsentPurposeEnum.P5=5]="P5",UserConsentPurposeEnum[UserConsentPurposeEnum.P6=6]="P6",UserConsentPurposeEnum[UserConsentPurposeEnum.P7=7]="P7",UserConsentPurposeEnum[UserConsentPurposeEnum.P8=8]="P8",UserConsentPurposeEnum[UserConsentPurposeEnum.P9=9]="P9",UserConsentPurposeEnum[UserConsentPurposeEnum.P10=10]="P10"}(UserConsentPurposeEnum||(UserConsentPurposeEnum={}))},function(module,exports){var hasOwnProperty={}.hasOwnProperty;module.exports=function(it,key){return hasOwnProperty.call(it,key)}},function(module,exports){module.exports=function(exec){try{return!!exec()}catch(error){return!0}}},function(module,exports){module.exports=function(it){return"object"==typeof it?null!==it:"function"==typeof it}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return observable});var observable=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},function(module,exports,__webpack_require__){var DESCRIPTORS=__webpack_require__(65),IE8_DOM_DEFINE=__webpack_require__(136),anObject=__webpack_require__(67),toPrimitive=__webpack_require__(116),nativeDefineProperty=Object.defineProperty;exports.f=DESCRIPTORS?nativeDefineProperty:function(O,P,Attributes){if(anObject(O),P=toPrimitive(P,!0),anObject(Attributes),IE8_DOM_DEFINE)try{return nativeDefineProperty(O,P,Attributes)}catch(error){}if("get"in Attributes||"set"in Attributes)throw TypeError("Accessors not supported");return"value"in Attributes&&(O[P]=Attributes.value),O}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return DeferredPromise});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),DeferredPromise=function(){function DeferredPromise(){var _this=this;_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,DeferredPromise),this._lock=!1,this.promise=new Promise(function(resolve,reject){_this._resolve=resolve,_this._reject=reject})}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(DeferredPromise,[{key:"_lockValidation",value:function(){this._lock||(this._lock=!0)}},{key:"resolve",value:function(value){this._lockValidation(),this._resolve(value)}},{key:"reject",value:function(reason){this._lockValidation(),this._reject(reason)}},{key:"isPending",get:function(){return!this._lock}}]),DeferredPromise}()},function(module,__webpack_exports__,__webpack_require__){"use strict";function hostReportError(err){setTimeout(function(){throw err},0)}__webpack_require__.d(__webpack_exports__,"a",function(){return hostReportError})},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(59)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(module,exports,__webpack_require__){var definePropertyModule=__webpack_require__(62),createPropertyDescriptor=__webpack_require__(90);module.exports=__webpack_require__(65)?function(object,key,value){return definePropertyModule.f(object,key,createPropertyDescriptor(1,value))}:function(object,key,value){return object[key]=value,object}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(60);module.exports=function(it){if(!isObject(it))throw TypeError(String(it)+" is not an object");return it}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return ObjectUnsubscribedError});var ObjectUnsubscribedError=function(){function ObjectUnsubscribedErrorImpl(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return ObjectUnsubscribedErrorImpl.prototype=Object.create(Error.prototype),ObjectUnsubscribedErrorImpl}()},function(module,exports,__webpack_require__){"use strict";(function(global){var util=exports;function merge(dst,src,ifNotSet){for(var keys=Object.keys(src),i=0;i<keys.length;++i)void 0!==dst[keys[i]]&&ifNotSet||(dst[keys[i]]=src[keys[i]]);return dst}function newError(name){function CustomError(message,properties){if(!(this instanceof CustomError))return new CustomError(message,properties);Object.defineProperty(this,"message",{get:function(){return message}}),Error.captureStackTrace?Error.captureStackTrace(this,CustomError):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),properties&&merge(this,properties)}return(CustomError.prototype=Object.create(Error.prototype)).constructor=CustomError,Object.defineProperty(CustomError.prototype,"name",{get:function(){return name}}),CustomError.prototype.toString=function(){return this.name+": "+this.message},CustomError}util.asPromise=__webpack_require__(261),util.base64=__webpack_require__(262),util.EventEmitter=__webpack_require__(263),util.float=__webpack_require__(264),util.inquire=__webpack_require__(265),util.utf8=__webpack_require__(266),util.pool=__webpack_require__(267),util.LongBits=__webpack_require__(268),util.isNode=Boolean(void 0!==global&&global&&global.process&&global.process.versions&&global.process.versions.node),util.global=util.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,util.emptyArray=Object.freeze?Object.freeze([]):[],util.emptyObject=Object.freeze?Object.freeze({}):{},util.isInteger=Number.isInteger||function(value){return"number"==typeof value&&isFinite(value)&&Math.floor(value)===value},util.isString=function(value){return"string"==typeof value||value instanceof String},util.isObject=function(value){return value&&"object"==typeof value},util.isset=util.isSet=function(obj,prop){var value=obj[prop];return!(null==value||!obj.hasOwnProperty(prop))&&("object"!=typeof value||(Array.isArray(value)?value.length:Object.keys(value).length)>0)},util.Buffer=function(){try{var Buffer=util.inquire("buffer").Buffer;return Buffer.prototype.utf8Write?Buffer:null}catch(e){return null}}(),util._Buffer_from=null,util._Buffer_allocUnsafe=null,util.newBuffer=function(sizeOrArray){return"number"==typeof sizeOrArray?util.Buffer?util._Buffer_allocUnsafe(sizeOrArray):new util.Array(sizeOrArray):util.Buffer?util._Buffer_from(sizeOrArray):"undefined"==typeof Uint8Array?sizeOrArray:new Uint8Array(sizeOrArray)},util.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,util.Long=util.global.dcodeIO&&util.global.dcodeIO.Long||util.global.Long||util.inquire("long"),util.key2Re=/^true|false|0|1$/,util.key32Re=/^-?(?:0|[1-9][0-9]*)$/,util.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,util.longToHash=function(value){return value?util.LongBits.from(value).toHash():util.LongBits.zeroHash},util.longFromHash=function(hash,unsigned){var bits=util.LongBits.fromHash(hash);return util.Long?util.Long.fromBits(bits.lo,bits.hi,unsigned):bits.toNumber(Boolean(unsigned))},util.merge=merge,util.lcFirst=function(str){return str.charAt(0).toLowerCase()+str.substring(1)},util.newError=newError,util.ProtocolError=newError("ProtocolError"),util.oneOfGetter=function(fieldNames){for(var fieldMap={},i=0;i<fieldNames.length;++i)fieldMap[fieldNames[i]]=1;return function(){for(var keys=Object.keys(this),i=keys.length-1;i>-1;--i)if(1===fieldMap[keys[i]]&&void 0!==this[keys[i]]&&null!==this[keys[i]])return keys[i]}},util.oneOfSetter=function(fieldNames){return function(name){for(var i=0;i<fieldNames.length;++i)fieldNames[i]!==name&&delete this[fieldNames[i]]}},util.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},util._configure=function(){var Buffer=util.Buffer;Buffer?(util._Buffer_from=Buffer.from!==Uint8Array.from&&Buffer.from||function(value,encoding){return new Buffer(value,encoding)},util._Buffer_allocUnsafe=Buffer.allocUnsafe||function(size){return new Buffer(size)}):util._Buffer_from=util._Buffer_allocUnsafe=null}}).call(this,__webpack_require__(109))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var errors_1=__webpack_require__(51),IntEncoder=function(){function r(){}return r.encode=function(r,e){var n;if("string"==typeof r&&(r=parseInt(r,10)),(n=r.toString(2)).length>e||r<0)throw new errors_1.EncodingError(r+" too large to encode into "+e);return n.length<e&&(n="0".repeat(e-n.length)+n),n},r.decode=function(r,e){if(e!==r.length)throw new errors_1.DecodingError("invalid bit length");return parseInt(r,2)},r}();exports.IntEncoder=IntEncoder},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return rxSubscriber});var rxSubscriber=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},function(module,__webpack_exports__,__webpack_require__){"use strict";function isFunction(x){return"function"==typeof x}__webpack_require__.d(__webpack_exports__,"a",function(){return isFunction})},function(module,exports,__webpack_require__){var IndexedObject=__webpack_require__(110),requireObjectCoercible=__webpack_require__(133);module.exports=function(it){return IndexedObject(requireObjectCoercible(it))}},function(module,exports,__webpack_require__){var global=__webpack_require__(48),getOwnPropertyDescriptor=__webpack_require__(115).f,hide=__webpack_require__(66),redefine=__webpack_require__(82),setGlobal=__webpack_require__(117),copyConstructorProperties=__webpack_require__(231),isForced=__webpack_require__(139);module.exports=function(options,source){var target,key,targetProperty,sourceProperty,descriptor,TARGET=options.target,GLOBAL=options.global,STATIC=options.stat;if(target=GLOBAL?global:STATIC?global[TARGET]||setGlobal(TARGET,{}):(global[TARGET]||{}).prototype)for(key in source){if(sourceProperty=source[key],targetProperty=options.noTargetGet?(descriptor=getOwnPropertyDescriptor(target,key))&&descriptor.value:target[key],!isForced(GLOBAL?key:TARGET+(STATIC?".":"#")+key,options.forced)&&void 0!==targetProperty){if(typeof sourceProperty==typeof targetProperty)continue;copyConstructorProperties(sourceProperty,targetProperty)}(options.sham||targetProperty&&targetProperty.sham)&&hide(sourceProperty,"sham",!0),redefine(target,key,sourceProperty,options)}}},function(module,exports,__webpack_require__){"use strict";var __values=this&&this.__values||function(e){var r="function"==typeof Symbol&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0});var Cloneable=function(){function e(){}return e.prototype.clone=function(){var e=this,r=new this.constructor;return Object.keys(this).forEach(function(t){var n=e.deepClone(e[t]);void 0!==n&&(r[t]=n)}),r},e.prototype.deepClone=function(e){var r,t,n=typeof e;if("number"===n||"string"===n||"boolean"===n)return e;if(null!==e&&"object"===n){if("function"==typeof e.clone)return e.clone();if(e instanceof Date)return new Date(e.getTime());if(void 0!==e[Symbol.iterator]){var o=[];try{for(var i=__values(e),l=i.next();!l.done;l=i.next()){var a=l.value;o.push(this.deepClone(a))}}catch(e){r={error:e}}finally{try{l&&!l.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return e instanceof Array?o:new e.constructor(o)}var u={};for(var f in e)e.hasOwnProperty(f)&&(u[f]=this.deepClone(e[f]));return u}},e}();exports.Cloneable=Cloneable},function(module,__webpack_exports__,__webpack_require__){"use strict";var DebugLineItemStateEnum;__webpack_require__(1),__webpack_require__(2);!function(DebugLineItemStateEnum){DebugLineItemStateEnum.prebid="prebid",DebugLineItemStateEnum.bid="bid",DebugLineItemStateEnum.win="win",DebugLineItemStateEnum.impression="impression",DebugLineItemStateEnum.viewableImpression="viewableImpression",DebugLineItemStateEnum.postbid="postbid",DebugLineItemStateEnum.initAd="initAd",DebugLineItemStateEnum.request="request"}(DebugLineItemStateEnum||(DebugLineItemStateEnum={}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return fetchBlockedDomains}),__webpack_require__.d(__webpack_exports__,"b",function(){return isDomainBlocked});var promise,Common_Modules_MediaMetadataHandler_MediaMetadataHandler__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(99),Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),Common_Services_EndPointsService_EndPointResolver__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(22),Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(4),Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(11),mediaMetadataHandler=new Common_Modules_MediaMetadataHandler_MediaMetadataHandler__WEBPACK_IMPORTED_MODULE_0__.a(Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__.ProtoAdDomainBlockingResponse,"AdDomainBlockingService"),ENDPOINT_RETRY_COUNT=2,blockedDomains=new Map;function fetchBlockedDomains(lineItems){promise||(promise=new Promise(function(resolve){var blockedDomainsLineItem=lineItems.find(function(lineItem){return lineItem.blockedDomainsRevisionNumber});if(blockedDomainsLineItem){var publisherLineItemId=blockedDomainsLineItem.publisherLineItemId,blockedDomainsRevisionNumber=blockedDomainsLineItem.blockedDomainsRevisionNumber,requestUrl="".concat(Common_Services_EndPointsService_EndPointResolver__WEBPACK_IMPORTED_MODULE_2__.a.endPoints.base.lineItems).concat(publisherLineItemId,"/blockedDomains_").concat(blockedDomainsRevisionNumber,".bin");mediaMetadataHandler.fetchMetadata(requestUrl,ENDPOINT_RETRY_COUNT).then(function(response){blockedDomains.set(publisherLineItemId,response.domains),resolve()}).catch(function(){Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_4__.a)({message:"AdDomainBlockingService_fetchBlockedDomains_endpoint_unavailable",level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__.ProtoLoggingLevelEnum.FATAL,throttle:2,sendMaxLog:!1}),resolve()})}else resolve()}))}function isDomainBlocked(publisherLineItemId,url){return new Promise(function(resolve){Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.h)(url)?promise.then(function(){blockedDomains.has(publisherLineItemId)&&blockedDomains.get(publisherLineItemId).some(function(domain){return url.includes(domain)})?resolve(!0):resolve(!1)}):resolve(!1)})}},function(module,exports){module.exports='<svg viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd"><path d="M5 21.453c2.022 1.627 4.6 2.602 7.387 2.602 3.973 0 7.485-1.967 9.622-4.977l-4.596-3.34a3.87 3.87 0 0 0-4.548 0L5 21.453zM22 4.977A11.75 11.75 0 0 0 12.387 0 11.74 11.74 0 0 0 5 2.602l7.9 5.74a3.81 3.81 0 0 0 4.479 0l4.63-3.364zm1.563 11.395c.494-1.3.767-2.712.767-4.186S24.057 9.3 23.563 8l-3.858 2.803a1.71 1.71 0 0 0 0 2.766l3.858 2.803z" fill="#fff"></path><path d="M2.378 5c-.024-.017-.057-.012-.074.01A11.74 11.74 0 0 0 0 12.025a11.74 11.74 0 0 0 2.304 7.004c.017.023.05.028.074.01l8.013-5.822c.81-.59.81-1.797 0-2.386L2.378 5z" fill="#09f"></path></svg>'},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return empty});var _config__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(50),_util_hostReportError__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(64),empty={closed:!0,next:function(value){},error:function(err){if(_config__WEBPACK_IMPORTED_MODULE_0__.a.useDeprecatedSynchronousErrorHandling)throw err;Object(_util_hostReportError__WEBPACK_IMPORTED_MODULE_1__.a)(err)},complete:function(){}}},function(module,exports){module.exports="<cnx class=cnx-ui-progress-label> <cnx-span></cnx-span> </cnx> "},function(module,exports){module.exports={}},function(module,exports,__webpack_require__){var global=__webpack_require__(48),hide=__webpack_require__(66),has=__webpack_require__(58),setGlobal=__webpack_require__(117),nativeFunctionToString=__webpack_require__(138),InternalStateModule=__webpack_require__(92),getInternalState=InternalStateModule.get,enforceInternalState=InternalStateModule.enforce,TEMPLATE=String(nativeFunctionToString).split("toString");__webpack_require__(83)("inspectSource",function(it){return nativeFunctionToString.call(it)}),(module.exports=function(O,key,value,options){var unsafe=!!options&&!!options.unsafe,simple=!!options&&!!options.enumerable,noTargetGet=!!options&&!!options.noTargetGet;"function"==typeof value&&("string"!=typeof key||has(value,"name")||hide(value,"name",key),enforceInternalState(value).source=TEMPLATE.join("string"==typeof key?key:"")),O!==global?(unsafe?!noTargetGet&&O[key]&&(simple=!0):delete O[key],simple?O[key]=value:hide(O,key,value)):simple?O[key]=value:setGlobal(key,value)})(Function.prototype,"toString",function(){return"function"==typeof this&&getInternalState(this).source||nativeFunctionToString.call(this)})},function(module,exports,__webpack_require__){var global=__webpack_require__(48),setGlobal=__webpack_require__(117),store=global["__core-js_shared__"]||setGlobal("__core-js_shared__",{});(module.exports=function(key,value){return store[key]||(store[key]=void 0!==value?value:{})})("versions",[]).push({version:"3.0.1",mode:__webpack_require__(91)?"pure":"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})},function(module,exports){module.exports={}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var BooleanEncoder=function(){function e(){}return e.encode=function(e){return+e+""},e.decode=function(e){return"1"===e},e}();exports.BooleanEncoder=BooleanEncoder},function(module,__webpack_exports__,__webpack_require__){"use strict";var CookieNamesEnum,classCallCheck=__webpack_require__(1),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(2),createClass_default=__webpack_require__.n(createClass),defineProperty=__webpack_require__(6),defineProperty_default=__webpack_require__.n(defineProperty),GeneralUtils=__webpack_require__(15),UserManagerConfig=__webpack_require__(42),XhrUtils=__webpack_require__(35),protos=__webpack_require__(0),EndPointResolver=__webpack_require__(22),TypeUtils=__webpack_require__(4),PlayerConfig=__webpack_require__(49),EnvironmentConfig=__webpack_require__(27),UserGlobalStorage_UserGlobalStorage=function(){function UserGlobalStorage(_globalScope){classCallCheck_default()(this,UserGlobalStorage),this._globalScope=_globalScope,this._isCcpaApplicable=!0,this._usPrivacyString="",this._pendingPlsCall=!1,this._coreAPICallbackList=[]}return createClass_default()(UserGlobalStorage,[{key:"getScope",value:function(){return this._globalScope}},{key:"syncDemandPartner",value:function(settings){if(this.userId){var requestData={userId:this.userId,demandPartner:parseInt(settings.demandPartner,10),demandPartnerUserId:settings.demandPartnerUserId};XhrUtils.a.sendProtoRequest({ProtoRequest:protos.ProtoUserSyncRequest,endpoint:EndPointResolver.a.endPoints.api.syncUrls,requestData:requestData,queryParams:defineProperty_default()({},PlayerConfig.b,EnvironmentConfig.a.version),logError:!0}).then(function(response){}).catch(function(e){})}}},{key:"registerPlsCall",value:function(callback){var _this=this;return this._pendingPlsCall?(this._coreAPICallbackList.push(callback),function(){}):this.userId?(callback(),function(){}):(this._pendingPlsCall=!0,callback(),function(){_this._pendingPlsCall=!1,_this._coreAPICallbackList.forEach(function(cb){return cb()}),_this._coreAPICallbackList=[]})}},{key:"userId",get:function(){if(Object(TypeUtils.h)(this._userId))return this._userId.split("_")[0]},set:function(value){this._userId=value}},{key:"isCcpaApplicable",get:function(){return this._isCcpaApplicable},set:function(value){this._isCcpaApplicable=value}},{key:"usPrivacyString",get:function(){return this._usPrivacyString},set:function(value){this._usPrivacyString=value}},{key:"consentPayload",get:function(){return this._consentPayload},set:function(value){this._consentPayload||(this._consentPayload=value)}}],[{key:"getInstance",value:function(GLOBAL){var instanceGlobalName=UserManagerConfig.a,topGLOBAL=Object(GeneralUtils.f)(GLOBAL).topFrame;return topGLOBAL[instanceGlobalName]||(topGLOBAL[instanceGlobalName]=new UserGlobalStorage(topGLOBAL)),topGLOBAL[instanceGlobalName]}}]),UserGlobalStorage}(),TimeUtils=__webpack_require__(47),Logging=__webpack_require__(11),ArrayUtils=__webpack_require__(13);function _createForOfIteratorHelper(o){if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(o=function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))){var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var it,err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}!function(CookieNamesEnum){CookieNamesEnum.USER_ID="cnx_userId"}(CookieNamesEnum||(CookieNamesEnum={}));var _USER_CONSENT_API_MAP,UserManagerPublicEventsEnum,UserManagerPrivateEventsEnum,UserCookieManager_UserCookieManager=function(){function UserCookieManager(_globalStorage,_global){classCallCheck_default()(this,UserCookieManager),this._globalStorage=_globalStorage,this._global=_global,this._cookieExpireDays=defineProperty_default()({},CookieNamesEnum.USER_ID,30),this._unsecuredSyncBrowserList=["Facebook App","Google App","Flipboard App","Instagram App","Pinterest App"],this._unsecuredCookieSync=!1}return createClass_default()(UserCookieManager,[{key:"_storeCookieValue",value:function(_ref){var name=_ref.name,value=_ref.value;name===CookieNamesEnum.USER_ID&&(this._globalStorage.userId=this._stripCookieValueTimestamp(value))}},{key:"_setFirstPartyCookie",value:function(cookie){var expires="",expireDays=this._cookieExpireDays[cookie.name];if(expireDays){var date=new Date(Object(TimeUtils.b)(expireDays));expires="; expires=".concat(date.toUTCString())}this._global.document.cookie="".concat(cookie.name,"=").concat(cookie.value).concat(expires,"; path=/")}},{key:"_setThirdPartyCookie",value:function(cookieList,unsecuredCookie){if(Object(ArrayUtils.h)(cookieList)){var requestData={cookieList:cookieList,secureMode:unsecuredCookie?protos.ProtoCookieSecureModeEnum.Unsecure:protos.ProtoCookieSecureModeEnum.Auto,browserInfo:this._browserInfo};return XhrUtils.a.sendProtoRequest({requestData:requestData,ProtoRequest:protos.ProtoCookieSyncRequest,endpoint:EndPointResolver.a.endPoints.api.cookie,withCredentials:!0,queryParams:defineProperty_default()({},PlayerConfig.b,EnvironmentConfig.a.version),logError:!1}).catch(function(e){return Object(Logging.a)({message:"UserCookieManager_setThirdPartyCookie",exception:e.message,callStack:e.callStack,level:protos.ProtoLoggingLevelEnum.FATAL})})}}},{key:"_stripCookieValueTimestamp",value:function(cookieValue){return cookieValue.split("_")[0]}},{key:"_getFirstPartyCookie",value:function(cookieName){try{var _step,name=cookieName+"=",_iterator=_createForOfIteratorHelper(decodeURIComponent(this._global.document.cookie).split(";"));try{for(_iterator.s();!(_step=_iterator.n()).done;){for(var c=_step.value;" "===c.charAt(0);)c=c.substring(1);if(0===c.indexOf(name))return this._stripCookieValueTimestamp(c.substring(name.length,c.length))}}catch(err){_iterator.e(err)}finally{_iterator.f()}}catch(e){}return""}},{key:"getUserId",value:function(){return this._globalStorage.userId}},{key:"syncFirstPartyCookie",value:function(name){var cookie={name:name,value:"",timestamp:Object(TimeUtils.b)(this._cookieExpireDays[name])};name===CookieNamesEnum.USER_ID&&(cookie.value=this._globalStorage.userId),Object(TypeUtils.h)(cookie.value)&&this._setFirstPartyCookie(cookie)}},{key:"syncThirdPartyCookieList",value:function(unsecuredCookie){var _this=this,cookiesToSync=[CookieNamesEnum.USER_ID],cookieList=[];cookiesToSync.forEach(function(name){name===CookieNamesEnum.USER_ID&&Object(TypeUtils.h)(_this._globalStorage.userId)&&cookieList.push({name:CookieNamesEnum.USER_ID,value:_this._globalStorage.userId,timestamp:Object(TimeUtils.b)(_this._cookieExpireDays[CookieNamesEnum.USER_ID])})}),this._setThirdPartyCookie(cookieList,unsecuredCookie)}},{key:"setBrowserInfo",value:function(browser,isConsentConnatix){this._browserInfo=browser,this._unsecuredCookieSync=this._unsecuredSyncBrowserList.includes(browser.browserType),this._unsecuredCookieSync&&isConsentConnatix&&this.syncThirdPartyCookieList(this._unsecuredCookieSync)}},{key:"setUserInformation",value:function(userInformation){userInformation&&this._storeCookieValue({name:CookieNamesEnum.USER_ID,value:userInformation.userId})}},{key:"fetchCookies",value:function(){var _this2=this;[CookieNamesEnum.USER_ID].map(function(name){return{name:name,value:_this2._getFirstPartyCookie(name)}}).filter(function(_ref2){var value=_ref2.value;return Object(TypeUtils.h)(value)}).forEach(function(cookie){return _this2._storeCookieValue(cookie)})}},{key:"unsecuredCookieSync",get:function(){return this._unsecuredCookieSync}}]),UserCookieManager}(),helpers_typeof=__webpack_require__(52),typeof_default=__webpack_require__.n(helpers_typeof),UserConsentApiEnum=__webpack_require__(33),USER_CONSENT_API_MAPPING=(_USER_CONSENT_API_MAP={},defineProperty_default()(_USER_CONSENT_API_MAP,UserConsentApiEnum.a.CmpApi,{windowPropertyName:"__cmp",framePropertyName:"__cmpLocator",getVendorConsentDataMethodName:"getVendorConsents",getConsentDataMethodName:"getConsentData"}),defineProperty_default()(_USER_CONSENT_API_MAP,UserConsentApiEnum.a.TcfApi,{windowPropertyName:"__tcfapi",framePropertyName:"__tcfapiLocator",getVendorConsentDataMethodName:"getTCData",consentUpdateMethodName:"addEventListener",removeUpdateListenerMethodName:"removeEventListener"}),_USER_CONSENT_API_MAP),CmpApi_CmpApi=function(){function CmpApi(_cmpApiWindow,_cmpApiLocatorFrame){var _this=this;classCallCheck_default()(this,CmpApi),this._cmpApiWindow=_cmpApiWindow,this._cmpApiLocatorFrame=_cmpApiLocatorFrame,this.apiType=UserConsentApiEnum.a.CmpApi,this._consentData={},this._consentPayload=null,this._processCmpMessage=function(event){return new Promise(function(resolve,reject){try{var eventData="string"==typeof event.data?JSON.parse(event.data):event.data;if("object"===typeof_default()(eventData)&&eventData.__cmpReturn)if(eventData.__cmpReturn.callId===_this._consentsMessageId){var vendorConsents=eventData.__cmpReturn.returnValue&&eventData.__cmpReturn.returnValue.vendorConsents;_this._setConsentData(vendorConsents).then(function(){return resolve(_this._consentsMessageId)})}else if(eventData.__cmpReturn.callId===_this._consentsPayloadMessageId){var consentData=eventData.__cmpReturn.returnValue&&eventData.__cmpReturn.returnValue.consentData;_this._setConsentPayload(consentData).then(function(){return resolve(_this._consentsPayloadMessageId)})}}catch(e){reject()}})}}return createClass_default()(CmpApi,[{key:"isApiOnPage",value:function(){return null!==this._cmpApiWindow||null!==this._cmpApiLocatorFrame}},{key:"bindToApi",value:function(){var _this2=this;return null!==this._cmpApiWindow?new Promise(function(resolve,reject){_this2._fetchVendorConsents(_this2._cmpApiWindow).then(function(){return resolve()}).catch(function(e){return reject(e)})}):null!==this._cmpApiLocatorFrame?this._fetchVendorConsentsThroughIframe(this._cmpApiLocatorFrame):Promise.reject()}},{key:"isConsentForVendor",value:function(vendorId){return!!this._consentData[vendorId]}},{key:"getConsentPayload",value:function(){return this._consentPayload}},{key:"setInAppConsentData",value:function(consentData){this._setConsentData(consentData),this._setConsentPayload(consentData.consentString)}},{key:"hasIvtConsent",value:function(){return this.isConsentForVendor(UserManagerConfig.c.Connatix)}},{key:"isConsentForPurposes",value:function(purposes){return!0}},{key:"_fetchVendorConsentsThroughIframe",value:function(cmpFrame){var _this3=this;this._consentsPayloadMessageId=Object(GeneralUtils.c)(),this._consentsMessageId=Object(GeneralUtils.c)();var messages={};return new Promise(function(resolve){window.addEventListener("message",function listenToCmpMessages(event){_this3._processCmpMessage(event).then(function(messageId){messages[messageId]=!0,messages[_this3._consentsPayloadMessageId]&&messages[_this3._consentsMessageId]&&(window.removeEventListener("message",listenToCmpMessages,!1),resolve())}).catch(function(e){})},!1);var getVendorConsentDataMethodName=USER_CONSENT_API_MAPPING[UserConsentApiEnum.a.CmpApi].getVendorConsentDataMethodName,getConsentDataMethodName=USER_CONSENT_API_MAPPING[UserConsentApiEnum.a.CmpApi].getConsentDataMethodName;cmpFrame.postMessage({__cmpCall:{command:getVendorConsentDataMethodName,parameter:null,callId:_this3._consentsMessageId}},"*"),cmpFrame.postMessage({__cmpCall:{command:getConsentDataMethodName,parameter:null,callId:_this3._consentsPayloadMessageId}},"*")})}},{key:"_fetchVendorConsents",value:function(cmpFrame){var _this4=this,windowPropertyName=USER_CONSENT_API_MAPPING[UserConsentApiEnum.a.CmpApi].windowPropertyName,getVendorConsentDataMethodName=USER_CONSENT_API_MAPPING[UserConsentApiEnum.a.CmpApi].getVendorConsentDataMethodName,getConsentDataMethodName=USER_CONSENT_API_MAPPING[UserConsentApiEnum.a.CmpApi].getConsentDataMethodName;if(cmpFrame&&cmpFrame[windowPropertyName]){var getVendorConsentsPromise=new Promise(function(resolve){cmpFrame[windowPropertyName](getVendorConsentDataMethodName,null,function(vendorConsentsObject,success){if(success){var vendorConsents=vendorConsentsObject.vendorConsents;_this4._setConsentData(vendorConsents).then(function(){return resolve()})}})}),getConsentDataPromise=new Promise(function(resolve){cmpFrame[windowPropertyName](getConsentDataMethodName,null,function(vendorConsentData,success){if(success){var consentData=vendorConsentData.consentData;_this4._setConsentPayload(consentData).then(function(){return resolve()})}})});return Promise.all([getVendorConsentsPromise,getConsentDataPromise])}return Promise.reject()}},{key:"_setConsentData",value:function(consentData){return Object(TypeUtils.f)(consentData)?(this._consentData=consentData,Promise.resolve()):Promise.reject()}},{key:"_setConsentPayload",value:function(consentPayload){return Object(TypeUtils.g)(consentPayload)?(this._consentPayload=consentPayload,Promise.resolve()):Promise.reject()}}]),CmpApi}(),DomUtils=__webpack_require__(5),TCString=__webpack_require__(168),dist=__webpack_require__(169),UserConsentUtils_getConsentApiWindow=function(global,userConsentApi){var windowProperty=USER_CONSENT_API_MAPPING[userConsentApi].windowPropertyName;return Object(DomUtils.s)(global,windowProperty)},UserConsentUtils_getConsentApiLocatorFrame=function(global,userConsentApi){var frameProperty=USER_CONSENT_API_MAPPING[userConsentApi].framePropertyName;return Object(DomUtils.r)(global,frameProperty)},isConsentFrameworkInPage=function(global,userConsentApi){return null!==UserConsentUtils_getConsentApiWindow(global,userConsentApi)||null!==UserConsentUtils_getConsentApiLocatorFrame(global,userConsentApi)},UserConsentUtils_decodeTCF=function(tcString){var tcModel=TCString.TCString.decode(tcString),vendorConsents={},purposeConsents={};return tcModel.vendorConsents.forEach(function(value,id){return vendorConsents[id]=value}),tcModel.purposeConsents.forEach(function(value,id){return purposeConsents[id]=value}),{vendorConsents:vendorConsents,purposeConsents:purposeConsents,tcString:tcString}},UserConsentUtils_decodeCMP=function(encodedConsentString){for(var cmpConsentData=dist.decodeConsentString(encodedConsentString),allowedVendorIdString="",maxVendorId=cmpConsentData.maxVendorId,i=1;i<=maxVendorId;i++)allowedVendorIdString+="0";var allowedVendorIdArray=allowedVendorIdString.split("");return cmpConsentData.allowedVendorIds.forEach(function(index){allowedVendorIdArray[index-1]="1"}),function(consentString){for(var consents={consentString:consentString},i=0;i<consentString.length;i++)consents[i+1]="1"===consentString[i];return consents}(allowedVendorIdArray.join(""))},UserConsentUtils_decodeConsentString=function(encodedConsentString,preferredDecoder,fallbackDecoder){var decodedData;try{decodedData=preferredDecoder(encodedConsentString)}catch(_a){}if(Object(TypeUtils.f)(decodedData))return decodedData;try{decodedData=fallbackDecoder(encodedConsentString)}catch(_b){}return decodedData},UserConsentUtils_isTCFObject=function(decodedData){var _a;return Object(TypeUtils.h)(null===(_a=decodedData)||void 0===_a?void 0:_a.tcString)},UserConsentUtils_isCMPObject=function(decodedData){var _a;return Object(TypeUtils.h)(null===(_a=decodedData)||void 0===_a?void 0:_a.consentString)},UserConsentUtils_getDecodedConsentData=function(_ref){var cmpEncodedString=_ref.cmpEncodedString,tcfEncodedString=_ref.tcfEncodedString;if(!Object(TypeUtils.h)(cmpEncodedString)&&!Object(TypeUtils.h)(tcfEncodedString))return null;var decodedData=null;return Object(TypeUtils.h)(tcfEncodedString)&&(decodedData=UserConsentUtils_decodeConsentString(tcfEncodedString,UserConsentUtils_decodeTCF,UserConsentUtils_decodeCMP)),Object(TypeUtils.f)(decodedData)?decodedData:Object(TypeUtils.h)(cmpEncodedString)?(decodedData=UserConsentUtils_decodeConsentString(cmpEncodedString,UserConsentUtils_decodeCMP,UserConsentUtils_decodeTCF),Object(TypeUtils.f)(decodedData)?decodedData:(Object(Logging.a)({message:"UserManagerService_getDecodedConsentData",exception:"cmpEncodedString failed to decode",callStack:JSON.stringify({cmpEncodedString:cmpEncodedString,tcfEncodedString:tcfEncodedString}),level:protos.ProtoLoggingLevelEnum.FATAL}),null)):(Object(Logging.a)({message:"UserManagerService_getDecodedConsentData",exception:"tcfEncodedString failed to decode",callStack:JSON.stringify({tcfEncodedString:tcfEncodedString}),level:protos.ProtoLoggingLevelEnum.FATAL}),null)},TcfApi_TcfApi=function(){function TcfApi(_tcfApiWindow,_tcfApiLocatorFrame){var _this=this;classCallCheck_default()(this,TcfApi),this._tcfApiWindow=_tcfApiWindow,this._tcfApiLocatorFrame=_tcfApiLocatorFrame,this.apiType=UserConsentApiEnum.a.TcfApi,this._processTcfMessage=function(event){return new Promise(function(resolve,reject){try{var eventData=event.data;if("string"==typeof event.data)try{eventData=JSON.parse(event.data)}catch(error){eventData=void 0}if("object"===typeof_default()(eventData)&&eventData.__tcfapiReturn&&eventData.__tcfapiReturn.callId===_this._consentMessageId){var tcString=eventData.__tcfapiReturn.returnValue.tcString;_this._setConsentData(tcString).then(function(){return resolve(_this._consentMessageId)}).catch(function(e){return reject()})}}catch(e){reject()}})}}return createClass_default()(TcfApi,[{key:"isApiOnPage",value:function(){return null!==this._tcfApiWindow||null!==this._tcfApiLocatorFrame}},{key:"bindToApi",value:function(){var _this2=this;return null!==this._tcfApiWindow?new Promise(function(resolve,reject){_this2._fetchVendorConsents(_this2._tcfApiWindow).then(function(){return resolve()}).catch(function(e){return reject(e)})}):null!==this._tcfApiLocatorFrame?this._fetchVendorConsentsThroughIframe(this._tcfApiLocatorFrame):Promise.reject()}},{key:"isConsentForVendor",value:function(vendorId){var _a,_b;return!(null===(_a=this._consentObject)||void 0===_a||!_a.vendorConsents)&&!!(null===(_b=this._consentObject)||void 0===_b?void 0:_b.vendorConsents[vendorId])}},{key:"getConsentPayload",value:function(){var _a;return null===(_a=this._consentObject)||void 0===_a?void 0:_a.tcString}},{key:"setInAppConsentData",value:function(consentData){this._consentObject=Object.assign(Object.assign({},this._consentObject),consentData)}},{key:"hasIvtConsent",value:function(){return!0}},{key:"isConsentForPurposes",value:function(purposes){var _a,_this3=this;return!(null===(_a=this._consentObject)||void 0===_a||!_a.purposeConsents)&&purposes.every(function(purpose){return!!_this3._consentObject.purposeConsents[purpose]})}},{key:"_fetchVendorConsentsThroughIframe",value:function(tcfFrame){var _this4=this;this._consentMessageId=Object(GeneralUtils.c)();var messages={};return new Promise(function(resolve){window.addEventListener("message",function listenToTcfMessages(event){_this4._processTcfMessage(event).then(function(messageId){messages[messageId]=!0,messages[_this4._consentMessageId]&&(window.removeEventListener("message",listenToTcfMessages,!1),resolve())}).catch(function(e){})},!1);var getVendorConsentDataMethodName=USER_CONSENT_API_MAPPING[UserConsentApiEnum.a.TcfApi].getVendorConsentDataMethodName;tcfFrame.postMessage({__tcfapiCall:{command:getVendorConsentDataMethodName,parameter:null,callId:_this4._consentMessageId}},"*")})}},{key:"_fetchVendorConsents",value:function(tcfFrame){var _this5=this,windowPropertyName=USER_CONSENT_API_MAPPING[UserConsentApiEnum.a.TcfApi].windowPropertyName,consentUpdateMethodName=USER_CONSENT_API_MAPPING[UserConsentApiEnum.a.TcfApi].consentUpdateMethodName,removeUpdateListenerMethodName=USER_CONSENT_API_MAPPING[UserConsentApiEnum.a.TcfApi].removeUpdateListenerMethodName;return tcfFrame&&tcfFrame[windowPropertyName]?new Promise(function(resolve){_this5._tcfApiWindow[windowPropertyName](consentUpdateMethodName,2,function(tcData,isSuccess){if(isSuccess&&("useractioncomplete"===tcData.eventStatus||"tcloaded"===tcData.eventStatus)){var tcString=tcData.tcString;_this5._setConsentData(tcString).then(function(){return resolve()}),_this5._tcfApiWindow[windowPropertyName](removeUpdateListenerMethodName,2,function(){},tcData.listenerId)}})}):Promise.reject()}},{key:"_setConsentData",value:function(tcfEncodedString){var consentData=UserConsentUtils_getDecodedConsentData({tcfEncodedString:tcfEncodedString});return UserConsentUtils_isTCFObject(consentData)?(this._consentObject=consentData,Promise.resolve()):Promise.reject()}}]),TcfApi}(),UserConsentPurposeEnum=__webpack_require__(57),CONNATIX_REQUIRED_PURPOSES=[UserConsentPurposeEnum.a.P1,UserConsentPurposeEnum.a.P2,UserConsentPurposeEnum.a.P4,UserConsentPurposeEnum.a.P7,UserConsentPurposeEnum.a.P8],UserConsentApiManager_UserConsentApiManager=function(){function UserConsentApiManager(_isGdpr,_global){var _a,_b,_appSettings=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};classCallCheck_default()(this,UserConsentApiManager),this._isGdpr=_isGdpr,this._global=_global;var decodedData=UserConsentUtils_getDecodedConsentData({cmpEncodedString:null===(_a=_appSettings.cmp)||void 0===_a?void 0:_a.consentString,tcfEncodedString:null===(_b=_appSettings.tcf)||void 0===_b?void 0:_b.tcString}),consentApiType=this._getConsentApiType(decodedData);null!==consentApiType?(this._initApi(consentApiType),(UserConsentUtils_isTCFObject(decodedData)||UserConsentUtils_isCMPObject(decodedData))&&this._userConsentApi.setInAppConsentData(decodedData)):Object(Logging.a)({message:"UserManagerService_UserConsentApiManager",exception:"failed to find the right api, no consent string and no framework on page was found",callStack:JSON.stringify({_appSettings:_appSettings}),level:protos.ProtoLoggingLevelEnum.FATAL})}return createClass_default()(UserConsentApiManager,[{key:"setPageUrl",value:function(pageUrl){this._pageUrl=pageUrl}},{key:"setAmpUserConsent",value:function(ampUserConsent){var _a,_b;if(this.isConsentRequired()){var userConsentApiFound,ccpaEnumValue=ampUserConsent.consentStringTypeEnum.US_PRIVACY_STRING,consentStringType=null===(_a=ampUserConsent.consentMetadata)||void 0===_a?void 0:_a.consentStringType,encodedConsentString=ampUserConsent.encodeConsentString||(null===(_b=ampUserConsent.consentMetadata)||void 0===_b?void 0:_b.additionalConsent);if(Object(TypeUtils.h)(encodedConsentString))if(consentStringType!==ccpaEnumValue){var decodedConsent=UserConsentUtils_getDecodedConsentData({tcfEncodedString:encodedConsentString,cmpEncodedString:encodedConsentString});UserConsentUtils_isTCFObject(decodedConsent)?userConsentApiFound=new TcfApi_TcfApi(null,null):UserConsentUtils_isCMPObject(decodedConsent)&&(userConsentApiFound=new CmpApi_CmpApi(null,null)),userConsentApiFound?userConsentApiFound?(this._userConsentApi=userConsentApiFound,this._userConsentApi.setInAppConsentData(decodedConsent)):Object(Logging.a)({message:"UserConsentApiManager_amp_userConsentApi_not_found",level:protos.ProtoLoggingLevelEnum.WARNING,callStack:encodedConsentString,exception:"".concat(JSON.stringify(ampUserConsent),"__pageURL__").concat(this._pageUrl),throttle:2,sendMaxLog:!1}):Object(Logging.a)({message:"UserConsentApiManager_encoded_string_not_tcf_and_not_cmp",level:protos.ProtoLoggingLevelEnum.WARNING,callStack:encodedConsentString,exception:"".concat(JSON.stringify(ampUserConsent),"__pageURL__").concat(this._pageUrl),throttle:2,sendMaxLog:!1})}else Object(Logging.a)({message:"UserConsentApiManager_CCPA_encoded_string_from_amp_not_used",level:protos.ProtoLoggingLevelEnum.WARNING,callStack:encodedConsentString,exception:"".concat(JSON.stringify(ampUserConsent),"__pageURL_").concat(this._pageUrl),throttle:2,sendMaxLog:!1});else Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.INFO,message:"AMP_no_consent_string_provided",callStack:JSON.stringify(ampUserConsent),exception:this._pageUrl})}}},{key:"isConsentRequired",value:function(){return this._isGdpr}},{key:"isConsent",value:function(vendorId){var purposes=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return!this.isConsentRequired()||this._userConsentApi.isConsentForVendor(vendorId)&&this._userConsentApi.isConsentForPurposes(purposes)}},{key:"isConsentConnatix",value:function(){return this.isConsent(UserManagerConfig.c.Connatix,CONNATIX_REQUIRED_PURPOSES)}},{key:"getConsentDataPayload",value:function(){return this._userConsentApi.getConsentPayload()}},{key:"bindToConsentApi",value:function(){return this._userConsentApi.bindToApi()}},{key:"isConsentApiOnPage",value:function(){return this._userConsentApi.isApiOnPage()}},{key:"hasIVTConsent",value:function(){return this._userConsentApi.hasIvtConsent()}},{key:"getConsentApiType",value:function(){return this._userConsentApi.apiType}},{key:"_initApi",value:function(consentApiType){var apiWindow=UserConsentUtils_getConsentApiWindow(this._global,consentApiType),apiLocatorFrame=UserConsentUtils_getConsentApiLocatorFrame(this._global,consentApiType);consentApiType===UserConsentApiEnum.a.TcfApi?this._userConsentApi=new TcfApi_TcfApi(apiWindow,apiLocatorFrame):this._userConsentApi=new CmpApi_CmpApi(apiWindow,apiLocatorFrame)}},{key:"_getConsentApiType",value:function(decodedData){return UserConsentUtils_isTCFObject(decodedData)?UserConsentApiEnum.a.TcfApi:UserConsentUtils_isCMPObject(decodedData)?UserConsentApiEnum.a.CmpApi:isConsentFrameworkInPage(this._global,UserConsentApiEnum.a.TcfApi)?UserConsentApiEnum.a.TcfApi:isConsentFrameworkInPage(this._global,UserConsentApiEnum.a.CmpApi)?UserConsentApiEnum.a.CmpApi:UserConsentApiEnum.a.TcfApi}}]),UserConsentApiManager}(),HrefUtils=__webpack_require__(26),VALIDATION_MESSAGES_SCRIPT_ERROR="UserThirdPartySyncManager_Pubmatic",VALIDATION_MESSAGES_SCRIPT_NOT_PROPERLY_LOADED="CookieSync_syncScript_not_properly_loaded",VALIDATION_MESSAGES_PARAM_PARSING_ERROR="CookieSync_param_not_parsed_properly",PubmaticCookieSync_isSyncValid=function(pid,predirect){if(!window.PubMaticSync)return PubmaticCookieSync_logSyncProblem(VALIDATION_MESSAGES_SCRIPT_NOT_PROPERLY_LOADED,"PUBMATIC"),!1;var pubId=Number.parseInt(pid,10);return Object(TypeUtils.d)(pubId)?!!Object(TypeUtils.h)(predirect)||(PubmaticCookieSync_logSyncProblem(VALIDATION_MESSAGES_PARAM_PARSING_ERROR,"PUBMATIC","predirect"),!1):(PubmaticCookieSync_logSyncProblem(VALIDATION_MESSAGES_PARAM_PARSING_ERROR,"PUBMATIC","p"),!1)},sync=function(pid,redirectUrl,isGdpr,gdprConsent){var syncObject={pubId:Number.parseInt(pid,10),url:redirectUrl};isGdpr&&(syncObject.delay=1e3,syncObject.gdpr=1,syncObject.gdprConsent=gdprConsent),window.PubMaticSync.sync(syncObject)},PubmaticCookieSync_logSyncProblem=function(message,callStack){var exception=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object(Logging.a)({message:message,callStack:callStack,exception:exception,level:protos.ProtoLoggingLevelEnum.FATAL,throttle:1,sendMaxLog:!1})},UserThirdPartySyncManager_UserThirdPartySyncManager=function(){function UserThirdPartySyncManager(_consentManager,_isGdpr){classCallCheck_default()(this,UserThirdPartySyncManager),this._consentManager=_consentManager,this._isGdpr=_isGdpr,this._syncUrlsStorage=[]}return createClass_default()(UserThirdPartySyncManager,[{key:"replaceuserIdMacros",value:function(url,userId){var newUrl=url;return newUrl=(newUrl=(newUrl=newUrl.replace("%5BuserId%5D",userId)).replace("[userId]",userId)).replace("%7bUSER_ID%7d",userId)}},{key:"_insertSyncUrl",value:function(syncUrl,GLOBAL){try{if(this._insertSyncUrlUsingIframe(syncUrl)){var ifr=GLOBAL.document.createElement("iframe");ifr.setAttribute("style","width:1px;height:1px;border:0px;margin:0px;padding:0px"),ifr.src=syncUrl.url,GLOBAL.document.body.appendChild(ifr)}else Object(DomUtils.A)({src:syncUrl.url},GLOBAL.document.head,GLOBAL,null,null,1===Object(GeneralUtils.l)([95,5]),"UserManager_unable_to_insert_sync_url_script");return!0}catch(e){return!1}}},{key:"_insertSyncUrlUsingIframe",value:function(syncUrl){switch(syncUrl.vendorId){case UserManagerConfig.c.Rubicon:case UserManagerConfig.c.Pubmatic:return!0;default:return syncUrl.url.indexOf("yellowblue.io")>-1}}},{key:"syncUrls",value:function(userId,GLOBAL){var _this=this;this._syncUrlsStorage.forEach(function(syncUrl){if(_this._consentManager.isConsent(syncUrl.vendorId)&&!syncUrl.synced){if(syncUrl.vendorId===UserManagerConfig.c.Pubmatic)return void function(syncUrl,isGdpr,gdprConsent){return new Promise(function(resolve,reject){var pid=Object(HrefUtils.b)("p",syncUrl),redirectUrl=Object(HrefUtils.b)("predirect",syncUrl);if(window.PubMaticSync){if(!PubmaticCookieSync_isSyncValid(pid,redirectUrl))return void reject();sync(pid,redirectUrl,isGdpr,gdprConsent),resolve(!0)}else Object(DomUtils.A)({src:"//ads.pubmatic.com/AdServer/js/userSync.js"},window.document.head,window,function(){PubmaticCookieSync_isSyncValid(pid,redirectUrl)?(sync(pid,redirectUrl,isGdpr,gdprConsent),resolve(!0)):reject()},function(){reject()},!0,VALIDATION_MESSAGES_SCRIPT_ERROR)})}(syncUrl.url,_this._consentManager.isConsentRequired(),_this._consentManager.getConsentDataPayload()).then(function(){syncUrl.synced=!0});if(-1!==syncUrl.url.indexOf("openx.net"))return syncUrl.url="".concat(syncUrl.url.split("r=")[0],"&r=\n                        ").concat(encodeURIComponent("".concat(EndPointResolver.a.endPoints.api.syncUrls,"?DemandPartner=8&UserId=").concat(userId,"&DemandPartnerUserId="))),syncUrl.url=_this.replaceuserIdMacros(syncUrl.url,userId),XhrUtils.a.trackPixel(syncUrl.url),void(syncUrl.synced=!0);if(syncUrl.url.indexOf("pixel.advertising.com")>-1&&(syncUrl.url=syncUrl.url.replace("gdpr=","gdpr=".concat(_this._consentManager.isConsentRequired()?1:0)),syncUrl.url=syncUrl.url.replace("gdpr_consent=","gdpr_consent=0")),syncUrl.url=_this.replaceuserIdMacros(syncUrl.url,userId),_this._isGdpr){syncUrl.url=Object(HrefUtils.e)(syncUrl.url,"gdpr","1");var consentString=_this._consentManager.getConsentDataPayload();syncUrl.url=Object(HrefUtils.e)(syncUrl.url,"gdpr_consent",consentString)}_this._insertSyncUrl(syncUrl,GLOBAL)&&(syncUrl.synced=!0)}})}},{key:"setSyncUrls",value:function(){var _this2=this,syncUrls=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!(this._syncUrlsStorage.length>0)&&(this._syncUrlsStorage=[],Object.keys(syncUrls).forEach(function(key){_this2._syncUrlsStorage.push({vendorId:key,url:syncUrls[key],synced:!1})}),!0)}}]),UserThirdPartySyncManager}(),DeferredPromise=__webpack_require__(63),GeoLocationConfig_subdivision={California:5332921},GeoLocationConfig_country={US:6252001},UserCcpaManager_UserCcpaManager=function(){function UserCcpaManager(_globalStorage,usPrivacyString){classCallCheck_default()(this,UserCcpaManager),this._globalStorage=_globalStorage,this._uspVersion=1,this._globalUspFunctionName="__uspapi",this._globalUspFunctionCommand="getUSPData",this._setUsPrivacyString(usPrivacyString)}return createClass_default()(UserCcpaManager,[{key:"getUsPrivacyString",value:function(){if(this._globalStorage.usPrivacyString||this._globalStorage.isCcpaApplicable)return this._globalStorage.usPrivacyString}},{key:"isCcpaApplicable",value:function(){return this._globalStorage.isCcpaApplicable}},{key:"isSellUserAllowed",value:function(){return!this._globalStorage.isCcpaApplicable||this._isPrivacyStringSellable()}},{key:"setGeoLocation",value:function(geoLocation){this._geoLocation=geoLocation,geoLocation.subdivisionId!==GeoLocationConfig_subdivision.California&&(this._globalStorage.isCcpaApplicable=!1)}},{key:"fetchUsPrivacyString",value:function(){var _this=this;return this._shouldLogCCPA()&&this._logCCPA(),this.isCcpaApplicable()?new Promise(function(resolve){_this.getUsPrivacyString()?resolve():resolve(_this._fetchUsPrivacyStringFromVendor())}):Promise.resolve()}},{key:"_fetchUsPrivacyStringFromVendor",value:function(){var _this2=this;return new Promise(function(resolve,reject){var privacyStringGetter=_this2._globalStorage.getScope()[_this2._globalUspFunctionName];privacyStringGetter?privacyStringGetter(_this2._globalUspFunctionCommand,_this2._uspVersion,function(uspData,success){success?(_this2._setUsPrivacyString(uspData.uspString),resolve()):reject()}):reject()})}},{key:"_isPrivacyStringSellable",value:function(){return!this._globalStorage.usPrivacyString||Object(ArrayUtils.g)(this._globalStorage.usPrivacyString,UserManagerConfig.b)}},{key:"_setUsPrivacyString",value:function(usPrivacyString){this._globalStorage.usPrivacyString=usPrivacyString}},{key:"_shouldLogCCPA",value:function(){if(!Object(GeneralUtils.l)([95,5]))return!1;var startDate=new Date(2020,10,16,12,0,0).getTime(),endDate=new Date(2020,10,17,12,0,0).getTime();return Object(TimeUtils.c)(startDate,endDate)}},{key:"_logCCPA",value:function(){var _this$_geoLocation=this._geoLocation,countryGeoId=_this$_geoLocation.countryGeoId,subdivisionId=_this$_geoLocation.subdivisionId;countryGeoId===GeoLocationConfig_country.US&&Object(Logging.a)({message:"UserCcpaManager_logCCPA",level:protos.ProtoLoggingLevelEnum.INFO,callStack:JSON.stringify(subdivisionId),exception:this._globalStorage.usPrivacyString})}}]),UserCcpaManager}();__webpack_require__.d(__webpack_exports__,"a",function(){return UserManagerPublicEventsEnum}),__webpack_require__.d(__webpack_exports__,"b",function(){return UserManagerService_UserManagerService}),function(UserManagerPublicEventsEnum){UserManagerPublicEventsEnum.CCPA_INFO_RECEIVED="ccpaInfoReceived",UserManagerPublicEventsEnum.CONSENT_DATA_UPDATE="consentDataUpdate"}(UserManagerPublicEventsEnum||(UserManagerPublicEventsEnum={})),function(UserManagerPrivateEventsEnum){UserManagerPrivateEventsEnum.SYNC_URLS_RECEIVED="thirdPartySyncUrlsReceived",UserManagerPrivateEventsEnum.USER_INFO_RECEIVED="userInfoReceived"}(UserManagerPrivateEventsEnum||(UserManagerPrivateEventsEnum={}));var UserManagerService_UserManagerService=function(){function UserManagerService(GLOBAL,_isInApp,_isAmp){var _this=this,_appSettings=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};classCallCheck_default()(this,UserManagerService),this._isInApp=_isInApp,this._isAmp=_isAmp,this._appSettings=_appSettings,this.gdprConsentMode=protos.ProtoGdprConsentModeEnum.Unknown,this._eventMap={},this._isEu="",this._syncCookies=!1,this._handleUserConsentData=function(){!_this._consentManager.isConsentRequired()||_this._isInApp?_this.resolveEvent(UserManagerPublicEventsEnum.CONSENT_DATA_UPDATE):(_this.gdprConsentMode=_this._consentManager.isConsentApiOnPage()||_this._isAmp?protos.ProtoGdprConsentModeEnum.NoConsent:protos.ProtoGdprConsentModeEnum.NoCmp,_this._consentManager.bindToConsentApi().then(function(){_this.isConsentConnatix()||(_this.gdprConsentMode=protos.ProtoGdprConsentModeEnum.NoConnatixConsent),_this.resolveEvent(UserManagerPublicEventsEnum.CONSENT_DATA_UPDATE)}).catch(function(reason){}))},this._handleSyncing=function(){_this.isConsentConnatix()&&(_this.onEvent([UserManagerPrivateEventsEnum.USER_INFO_RECEIVED]).then(function(){_this._syncCookies&&(_this._cookieManager.syncThirdPartyCookieList(),_this._cookieManager.unsecuredCookieSync&&_this._cookieManager.syncThirdPartyCookieList(_this._cookieManager.unsecuredCookieSync),_this._cookieManager.syncFirstPartyCookie(CookieNamesEnum.USER_ID))}),_this.onEvent([UserManagerPrivateEventsEnum.SYNC_URLS_RECEIVED,UserManagerPublicEventsEnum.CONSENT_DATA_UPDATE,UserManagerPublicEventsEnum.CCPA_INFO_RECEIVED]).then(function(){if(_this.isConsentConnatix()&&_this._ccpaManager.isSellUserAllowed())try{_this._syncManager.syncUrls(_this._globalStorage.userId,_this._globalStorage.getScope())}catch(e){Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.WARNING,message:"UserManager_syncUrls",exception:e.message,callStack:e.stack})}}))};try{this._globalStorage=UserGlobalStorage_UserGlobalStorage.getInstance(GLOBAL),this._isInApp||(this._cookieManager=new UserCookieManager_UserCookieManager(this._globalStorage,GLOBAL));var _this$_appSettings=this._appSettings,cmp=_this$_appSettings.cmp,tcf=_this$_appSettings.tcf;this._consentManager=new UserConsentApiManager_UserConsentApiManager(!!this._isEu,GLOBAL,{cmp:cmp,tcf:tcf}),this._syncManager=new UserThirdPartySyncManager_UserThirdPartySyncManager(this._consentManager,this.isGDPR()),this._ccpaManager=new UserCcpaManager_UserCcpaManager(this._globalStorage,this._appSettings.usPrivacyString),this._init()}catch(e){Object(Logging.a)({callStack:e.stack,exception:e.message,message:"UserManager_constructor",level:protos.ProtoLoggingLevelEnum.FATAL})}}return createClass_default()(UserManagerService,[{key:"_init",value:function(){var _this2=this;this._cookieManager&&this._cookieManager.fetchCookies(),this._handleUserConsentData(),this.onEvent([UserManagerPublicEventsEnum.CONSENT_DATA_UPDATE]).then(function(){setTimeout(function(){try{if(_this2._isInApp)return;_this2._handleSyncing()}catch(e){Object(Logging.a)({callStack:e.stack,exception:e.message,message:"UserManager_consent_data_received",level:protos.ProtoLoggingLevelEnum.FATAL})}},0)})}},{key:"_getEventPromise",value:function(eventName){var _this3=this;return void 0===this._eventMap[eventName]&&(this._eventMap[eventName]=new DeferredPromise.a,this._eventMap[eventName].promise.catch(function(){return _this3._eventMap[eventName].reject()})),this._eventMap[eventName]}},{key:"resolveEvent",value:function(eventName,payload){this._getEventPromise(eventName).resolve(payload)}},{key:"setAmpUserConsent",value:function(ampUserConsent){this._consentManager.setAmpUserConsent(ampUserConsent),this.resolveEvent(UserManagerPublicEventsEnum.CONSENT_DATA_UPDATE)}},{key:"setPageUrl",value:function(pageUrl){this._consentManager&&this._consentManager.setPageUrl(pageUrl)}},{key:"onEvent",value:function(eventNames){var _this4=this,eventPromises=eventNames.map(function(eventName){return _this4._getEventPromise(eventName).promise});return Promise.all(eventPromises)}},{key:"isConsent",value:function(vendorId,purposes){return this._consentManager.isConsent(vendorId,purposes)}},{key:"isConsentConnatix",value:function(){return this._consentManager.isConsentConnatix()}},{key:"getConsentPayload",value:function(){return this._consentManager.getConsentDataPayload()}},{key:"isConsentRequired",value:function(){return this._consentManager.isConsentRequired()}},{key:"setThirdPartySyncUrls",value:function(syncUrlList){this._isInApp||this._syncManager.setSyncUrls(syncUrlList)&&this.resolveEvent(UserManagerPrivateEventsEnum.SYNC_URLS_RECEIVED)}},{key:"setGeoLocation",value:function(geoLocation){var _this5=this;this._ccpaManager.setGeoLocation(geoLocation),this._ccpaManager.fetchUsPrivacyString().then(function(){_this5.resolveEvent(UserManagerPublicEventsEnum.CCPA_INFO_RECEIVED)}).catch(function(){_this5.resolveEvent(UserManagerPublicEventsEnum.CCPA_INFO_RECEIVED)})}},{key:"getUserId",value:function(){if(this.isConsentConnatix()&&this._cookieManager)return this._cookieManager.getUserId()}},{key:"_forceGetUserId",value:function(){return this._cookieManager&&this._cookieManager.getUserId()}},{key:"setUserInformation",value:function(userInformation){this._cookieManager&&(this._cookieManager.setUserInformation(userInformation),this.resolveEvent(UserManagerPrivateEventsEnum.USER_INFO_RECEIVED),!this._isInApp&&this.isConsentConnatix()&&this._cookieManager.syncFirstPartyCookie(CookieNamesEnum.USER_ID))}},{key:"isGDPR",value:function(){return!!this._isEu}},{key:"getUsPrivacyString",value:function(){return this._ccpaManager.getUsPrivacyString()}},{key:"isCcpaApplicable",value:function(){return this._ccpaManager.isCcpaApplicable()}},{key:"isSellUserAllowed",value:function(){return this._isInApp||this._ccpaManager.isSellUserAllowed()}},{key:"getDeviceId",value:function(){if(this.isConsentConnatix())return this._appSettings.deviceID}},{key:"_forceGetDeviceId",value:function(){return this._appSettings.deviceID}},{key:"getTrackableUser",value:function(){return this._isInApp?this.getDeviceId():this.getUserId()}},{key:"getForcedTrackableUser",value:function(){return this._isInApp?this._forceGetDeviceId():this._forceGetUserId()}},{key:"registerPlsCall",value:function(callback){return this.isConsentConnatix()||(this._syncCookies=!0),this._globalStorage.registerPlsCall(callback)}},{key:"setBrowserInfo",value:function(browser){this._cookieManager&&this._cookieManager.setBrowserInfo(browser,this.isConsentConnatix())}},{key:"getGdprConsentApiType",value:function(){return this._consentManager.getConsentApiType()}}]),UserManagerService}()},function(module,exports,__webpack_require__){var internalObjectKeys=__webpack_require__(132),enumBugKeys=__webpack_require__(113);module.exports=Object.keys||function(O){return internalObjectKeys(O,enumBugKeys)}},function(module,exports){exports.f=Object.getOwnPropertySymbols},function(module,exports,__webpack_require__){"use strict";var nativePropertyIsEnumerable={}.propertyIsEnumerable,nativeGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,NASHORN_BUG=nativeGetOwnPropertyDescriptor&&!nativePropertyIsEnumerable.call({1:2},1);exports.f=NASHORN_BUG?function(V){var descriptor=nativeGetOwnPropertyDescriptor(this,V);return!!descriptor&&descriptor.enumerable}:nativePropertyIsEnumerable},function(module,exports){module.exports=function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value:value}}},function(module,exports){module.exports=!1},function(module,exports,__webpack_require__){var set,get,has,NATIVE_WEAK_MAP=__webpack_require__(230),isObject=__webpack_require__(60),hide=__webpack_require__(66),objectHas=__webpack_require__(58),sharedKey=__webpack_require__(93),hiddenKeys=__webpack_require__(81),WeakMap=__webpack_require__(48).WeakMap;if(NATIVE_WEAK_MAP){var store=new WeakMap,wmget=store.get,wmhas=store.has,wmset=store.set;set=function(it,metadata){return wmset.call(store,it,metadata),metadata},get=function(it){return wmget.call(store,it)||{}},has=function(it){return wmhas.call(store,it)}}else{var STATE=sharedKey("state");hiddenKeys[STATE]=!0,set=function(it,metadata){return hide(it,STATE,metadata),metadata},get=function(it){return objectHas(it,STATE)?it[STATE]:{}},has=function(it){return objectHas(it,STATE)}}module.exports={set:set,get:get,has:has,enforce:function(it){return has(it)?get(it):set(it,{})},getterFor:function(TYPE){return function(it){var state;if(!isObject(it)||(state=get(it)).type!==TYPE)throw TypeError("Incompatible receiver, "+TYPE+" required");return state}}}},function(module,exports,__webpack_require__){var shared=__webpack_require__(83)("keys"),uid=__webpack_require__(94);module.exports=function(key){return shared[key]||(shared[key]=uid(key))}},function(module,exports){var id=0,postfix=Math.random();module.exports=function(key){return"Symbol(".concat(void 0===key?"":key,")_",(++id+postfix).toString(36))}},function(module,exports,__webpack_require__){var defineProperty=__webpack_require__(62).f,has=__webpack_require__(58),TO_STRING_TAG=__webpack_require__(54)("toStringTag");module.exports=function(it,TAG,STATIC){it&&!has(it=STATIC?it:it.prototype,TO_STRING_TAG)&&defineProperty(it,TO_STRING_TAG,{configurable:!0,value:TAG})}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(67),defineProperties=__webpack_require__(236),enumBugKeys=__webpack_require__(113),html=__webpack_require__(237),documentCreateElement=__webpack_require__(137),IE_PROTO=__webpack_require__(93)("IE_PROTO"),Empty=function(){},createDict=function(){var iframeDocument,iframe=documentCreateElement("iframe"),length=enumBugKeys.length;for(iframe.style.display="none",html.appendChild(iframe),iframe.src=String("javascript:"),(iframeDocument=iframe.contentWindow.document).open(),iframeDocument.write("<script>document.F=Object<\/script>"),iframeDocument.close(),createDict=iframeDocument.F;length--;)delete createDict.prototype[enumBugKeys[length]];return createDict()};module.exports=Object.create||function(O,Properties){var result;return null!==O?(Empty.prototype=anObject(O),result=new Empty,Empty.prototype=null,result[IE_PROTO]=O):result=createDict(),void 0===Properties?result:defineProperties(result,Properties)},__webpack_require__(81)[IE_PROTO]=!0},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return PageFocusService});var HiddenDocPropertyEnum,VisibilityEventEnum,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__);!function(HiddenDocPropertyEnum){HiddenDocPropertyEnum.hidden="hidden",HiddenDocPropertyEnum.msHidden="msHidden",HiddenDocPropertyEnum.webkitHidden="webkitHidden"}(HiddenDocPropertyEnum||(HiddenDocPropertyEnum={})),function(VisibilityEventEnum){VisibilityEventEnum.visibilitychange="visibilitychange",VisibilityEventEnum.msvisibilitychange="msvisibilitychange",VisibilityEventEnum.webkitvisibilitychange="webkitvisibilitychange"}(VisibilityEventEnum||(VisibilityEventEnum={}));var PageFocusService=function(){function PageFocusService(_globalDomUtils){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,PageFocusService),this._globalDomUtils=_globalDomUtils,this._cashedCallbacks=[],this._setBrowserSpecific(),this._setBrowserSpecificPropertyNames()}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(PageFocusService,[{key:"on",value:function(callback){this._cashedCallbacks.push(callback),callback(this.isDocumentVisible())}},{key:"off",value:function(callback){this._cashedCallbacks=this._cashedCallbacks.filter(function(cachedCallback){return cachedCallback!==callback})}},{key:"_setBrowserSpecific",value:function(){void 0!==this._globalDomUtils.getDocumentProperty(HiddenDocPropertyEnum.hidden)?(this._hidden=HiddenDocPropertyEnum.hidden,this._visibilityChange=VisibilityEventEnum.visibilitychange):void 0!==this._globalDomUtils.getDocumentProperty(HiddenDocPropertyEnum.msHidden)?(this._hidden=HiddenDocPropertyEnum.msHidden,this._visibilityChange=VisibilityEventEnum.msvisibilitychange):void 0!==this._globalDomUtils.getDocumentProperty(HiddenDocPropertyEnum.webkitHidden)&&(this._hidden=HiddenDocPropertyEnum.webkitHidden,this._visibilityChange=VisibilityEventEnum.webkitvisibilitychange)}},{key:"_setBrowserSpecificPropertyNames",value:function(){var _this=this;this._globalDomUtils.addEventListenerOnGlobal(this._visibilityChange,function(){_this._cashedCallbacks.forEach(function(callback){callback(_this.isDocumentVisible())})},!0,!1)}},{key:"isDocumentVisible",value:function(){return!this._globalDomUtils.getDocumentProperty(this._hidden)}}]),PageFocusService}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return AdStateChangeEnum}),__webpack_require__.d(__webpack_exports__,"b",function(){return AdStateProtoAdSlotsMap});var _AdStateProtoAdSlotsM,AdStateChangeEnum,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__),Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0);!function(AdStateChangeEnum){AdStateChangeEnum[AdStateChangeEnum.PreRoll=0]="PreRoll",AdStateChangeEnum[AdStateChangeEnum.MidRoll=1]="MidRoll",AdStateChangeEnum[AdStateChangeEnum.PostRoll=2]="PostRoll",AdStateChangeEnum[AdStateChangeEnum.Standalone=3]="Standalone"}(AdStateChangeEnum||(AdStateChangeEnum={}));var AdStateProtoAdSlotsMap=(_AdStateProtoAdSlotsM={},_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(_AdStateProtoAdSlotsM,Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__.ProtoAdSlotsEnum.PreRoll,AdStateChangeEnum.PreRoll),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(_AdStateProtoAdSlotsM,Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__.ProtoAdSlotsEnum.MidRoll,AdStateChangeEnum.MidRoll),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(_AdStateProtoAdSlotsM,Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_1__.ProtoAdSlotsEnum.PostRoll,AdStateChangeEnum.PostRoll),_AdStateProtoAdSlotsM)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return MediaMetadataHandler});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(15),Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(11),Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(4),Common_Utils_XhrUtils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(35),MediaMetadataHandler=function(){function MediaMetadataHandler(_protoResponseModel,_identifier){var _this=this;_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,MediaMetadataHandler),this._protoResponseModel=_protoResponseModel,this._identifier=_identifier,this._doProtoRequest=function(url){return new Promise(function(resolve,reject){Common_Utils_XhrUtils__WEBPACK_IMPORTED_MODULE_6__.a.sendProtoRequest({ProtoResponse:_this._protoResponseModel,endpoint:url,requestType:"GET",logError:!0}).then(function(videoMeta){resolve(videoMeta)}).catch(function(e){reject(e)})})}}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(MediaMetadataHandler,[{key:"fetchMetadata",value:function(url){var _this2=this,retryCount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return new Promise(function(resolve,reject){Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_3__.k)(function(){return _this2._doProtoRequest(url)},retryCount).then(function(metadata){if(Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_5__.f)(metadata))return resolve(metadata);var e=new Error("invalid metadata");return _this2._logError({url:url,metadata:metadata,e:e}),reject(e)}).catch(function(e){_this2._logError({url:url,e:e}),reject(e)})})}},{key:"_logError",value:function(options){var _a,errorMessage=Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_5__.h)(null===(_a=options.e)||void 0===_a?void 0:_a.message)?options.e.message:"";-1===errorMessage.indexOf("XhrUtils_XMLHttpRequest_error")&&Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_4__.a)({message:"MediaMetadataHandler_fetchMetadata",exception:"".concat(this._identifier,"_").concat(errorMessage,":").concat(JSON.stringify(options)),callStack:options.e&&options.e.stack,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_2__.ProtoLoggingLevelEnum.FATAL})}}]),MediaMetadataHandler}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return GPT_SCRIPT_URL});var GPT_SCRIPT_URL="//securepubads.g.doubleclick.net/tag/js/gpt.js"},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return isArray});var isArray=function(){return Array.isArray||function(x){return x&&"number"==typeof x.length}}()},function(module,__webpack_exports__,__webpack_require__){"use strict";function isObject(x){return null!==x&&"object"==typeof x}__webpack_require__.d(__webpack_exports__,"a",function(){return isObject})},function(module,__webpack_exports__,__webpack_require__){"use strict";function identity(x){return x}__webpack_require__.d(__webpack_exports__,"a",function(){return identity})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return UrlSuffixerService});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(13),Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(4),UrlSuffixerService=function(){function UrlSuffixerService(){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,UrlSuffixerService),this._params={}}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(UrlSuffixerService,[{key:"setQueryParams",value:function(params){this._params=params}},{key:"appendParamsToUrl",value:function(URL){var _this=this;return this._addUrlQueryParam(URL,Object.keys(this._params).map(function(p){return{paramName:p,paramValue:_this._params[p]}}))}},{key:"_addUrlQueryParam",value:function(URL,paramList){if(!Object(Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_2__.h)(paramList))return URL;URL+=URL.includes("?")?"&":"?";var paramString="";return paramList.forEach(function(suffix){Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.h)(suffix.paramName)&&Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_3__.h)(suffix.paramValue)&&(paramString+="".concat(paramString.length>0?"&":"").concat(suffix.paramName,"=").concat(suffix.paramValue))}),URL+paramString}}]),UrlSuffixerService}()},function(module,exports){module.exports='<cnx class="cnx-icon-button cnx-button-settings cnx-context-controller cnx-ui-btn-hoverable"> <cnx class=cnx-btn-container> <cnx class=cnx-settings-icon> <svg markup-inline class=cnx-color-icon xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink viewBox="0 0 22 22"><path d="M18.454 5.847l-2.642 1.05-1.03-.784c-.444-.338-.904-.603-1.39-.8l-1.205-.488-.404-2.786h-1.563l-.404 2.786-1.205.488c-.465.188-.93.46-1.413.817L6.17 6.9 3.546 5.847l-.783 1.34 2.232 1.727-.16 1.266c-.042.33-.062.59-.062.82s.02.49.062.82l.16 1.266-2.233 1.727.783 1.34 2.642-1.05 1.03.784c.444.338.904.603 1.39.8l1.205.488.404 2.786h1.563l.404-2.786 1.205-.488c.465-.188.93-.46 1.413-.817l1.025-.76 2.625 1.043.783-1.34-2.233-1.727.16-1.266c.043-.337.062-.584.062-.82s-.02-.483-.062-.82l-.16-1.266 2.233-1.727-.783-1.34zm.71 6.227l2.32 1.81c.21.164.264.46.132.702l-2.198 3.793c-.132.24-.418.34-.67.24l-2.736-1.096c-.57.427-1.187.8-1.857 1.074l-.418 2.905c-.033.263-.264.46-.538.46H8.802c-.275 0-.506-.197-.538-.46l-.418-2.905c-.67-.274-1.286-.636-1.857-1.074l-2.736 1.096c-.242.088-.538 0-.67-.24L.385 14.584c-.132-.24-.077-.537.132-.702l2.32-1.81A8.67 8.67 0 0 1 2.758 11a8.67 8.67 0 0 1 .077-1.074l-2.32-1.81a.54.54 0 0 1-.132-.702l2.198-3.793c.132-.24.418-.34.67-.24L5.99 4.478c.57-.427 1.187-.8 1.857-1.074L8.264.5c.033-.263.264-.46.538-.46h4.396c.275 0 .506.197.538.46l.418 2.905c.67.274 1.286.636 1.857 1.074l2.736-1.096c.242-.088.538 0 .67.24l2.198 3.793c.132.24.077.537-.132.702l-2.32 1.81A8.52 8.52 0 0 1 19.242 11a8.52 8.52 0 0 1-.077 1.074zM11 14.256A3.26 3.26 0 0 0 14.256 11 3.26 3.26 0 0 0 11 7.744 3.26 3.26 0 0 0 7.744 11 3.26 3.26 0 0 0 11 14.256zm0-2A1.26 1.26 0 0 1 9.744 11 1.26 1.26 0 0 1 11 9.744 1.26 1.26 0 0 1 12.256 11 1.26 1.26 0 0 1 11 12.256z"/></svg> </cnx> <cnx class=cnx-hd-flag> <svg markup-inline xmlns=http://www.w3.org/2000/svg viewBox="0 0 17 11"><g fill=none><rect class=cnx-color-accent width=17 height=11 rx=2 fill=#09F /><path class=cnx-color-icon d="M8 9L6.9 9 6.9 5.9 4.1 5.9 4.1 9 3 9 3 2 4.1 2 4.1 4.9 6.9 4.9 6.9 2 8 2 8 9ZM10 9L10 2 12 2C12.6 2 13.1 2.2 13.6 2.4 14 2.7 14.4 3.1 14.6 3.6 14.9 4.1 15 4.7 15 5.3L15 5.7C15 6.4 14.9 6.9 14.6 7.4 14.4 7.9 14 8.3 13.5 8.6 13.1 8.9 12.5 9 11.9 9L10 9ZM11 3L11 8 12.2 8C12.8 8 13.2 7.8 13.5 7.4 13.8 7 14 6.4 14 5.7L14 5.3C14 4.6 13.8 4 13.5 3.6 13.2 3.2 12.8 3 12.2 3L11 3Z"/></g></svg> </cnx> </cnx> </cnx> '},function(module,exports){module.exports='<cnx class="cnx-icon-button cnx-button-caption cnx-ui-btn-hoverable"> <cnx class=cnx-btn-container> <cnx class=cnx-caption-off-icon> <svg markup-inline class=cnx-color-icon xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><path d="M20.556 5H3.444C3.163 5 3 5.15 3 5.25v13.5c0 .1.163.25.444.25h17.11c.275 0 .444-.156.444-.25V5.25c0-.094-.17-.25-.444-.25zm0-2C21.9 3 23 4.013 23 5.25v13.5c0 1.238-1.1 2.25-2.444 2.25H3.444C2.088 21 1 19.988 1 18.75V5.25C1 4.013 2.088 3 3.444 3h17.11zM11 11H9.5v-.5h-2v3h2V13H11v1c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1zm7 0h-1.5v-.5h-2v3h2V13H18v1c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1z" fill-rule=evenodd /></svg> </cnx> <cnx class=cnx-caption-on-icon> <svg markup-inline class=cnx-color-icon xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><g fill=none><path d="M20.6 3C21.9 3 23 4 23 5.3L23 18.8C23 20 21.9 21 20.6 21L3.4 21C2.1 21 1 20 1 18.8L1 5.3C1 4 2.1 3 3.4 3L20.6 3Z" class=cnx-color-accent /><path d="M11 11L9.5 11 9.5 10.5 7.5 10.5 7.5 13.5 9.5 13.5 9.5 13 11 13 11 14C11 14.6 10.6 15 10 15L7 15C6.5 15 6 14.6 6 14L6 10C6 9.5 6.5 9 7 9L10 9C10.6 9 11 9.5 11 10L11 11ZM18 11L16.5 11 16.5 10.5 14.5 10.5 14.5 13.5 16.5 13.5 16.5 13 18 13 18 14C18 14.6 17.6 15 17 15L14 15C13.5 15 13 14.6 13 14L13 10C13 9.5 13.5 9 14 9L17 9C17.6 9 18 9.5 18 10L18 11Z" class=cnx-color-icon /></g></svg> </cnx> </cnx> </cnx> '},function(module,exports){module.exports='<cnx class="cnx-progress-bar cnx-video-progress"> <cnx class=cnx-progress-rail-container> <cnx class=cnx-progress-rail></cnx> <cnx class="cnx-progress-fill cnx-color-accent"></cnx> <cnx class=cnx-progress-follow></cnx> </cnx> <cnx class="cnx-progress-handle cnx-color-accent"></cnx> <cnx class=cnx-progress-hitarea></cnx> </cnx> '},function(module,exports){module.exports='<cnx class=cnx-ui-loader> <svg class=cnx-color-accent version=1.1 viewBox="0 0 79 90" xmlns=http://www.w3.org/2000/svg><polygon points="21 73.322 11 79 11 12 21 17.678" fill=none stroke-linecap=round stroke-linejoin=round /><polygon points="27 70 27 21 38 27.267 38 63.733" fill=transparent stroke-linecap=round stroke-linejoin=round /><polygon points="44 61 44 31 54 36.769 54 55.231" fill=none stroke-linecap=round stroke-linejoin=round /><polygon points="60 51 60 40 70 45.5" fill=none stroke-linecap=round stroke-linejoin=round /></svg> </cnx> '},function(module,exports){var g;g=function(){return this}();try{g=g||new Function("return this")()}catch(e){"object"==typeof window&&(g=window)}module.exports=g},function(module,exports,__webpack_require__){var fails=__webpack_require__(59),classof=__webpack_require__(111),split="".split;module.exports=fails(function(){return!Object("z").propertyIsEnumerable(0)})?function(it){return"String"==classof(it)?split.call(it,""):Object(it)}:Object},function(module,exports){var toString={}.toString;module.exports=function(it){return toString.call(it).slice(8,-1)}},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(135),min=Math.min;module.exports=function(argument){return argument>0?min(toInteger(argument),9007199254740991):0}},function(module,exports){module.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(module,exports,__webpack_require__){var requireObjectCoercible=__webpack_require__(133);module.exports=function(argument){return Object(requireObjectCoercible(argument))}},function(module,exports,__webpack_require__){var DESCRIPTORS=__webpack_require__(65),propertyIsEnumerableModule=__webpack_require__(89),createPropertyDescriptor=__webpack_require__(90),toIndexedObject=__webpack_require__(73),toPrimitive=__webpack_require__(116),has=__webpack_require__(58),IE8_DOM_DEFINE=__webpack_require__(136),nativeGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;exports.f=DESCRIPTORS?nativeGetOwnPropertyDescriptor:function(O,P){if(O=toIndexedObject(O),P=toPrimitive(P,!0),IE8_DOM_DEFINE)try{return nativeGetOwnPropertyDescriptor(O,P)}catch(error){}if(has(O,P))return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O,P),O[P])}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(60);module.exports=function(it,S){if(!isObject(it))return it;var fn,val;if(S&&"function"==typeof(fn=it.toString)&&!isObject(val=fn.call(it)))return val;if("function"==typeof(fn=it.valueOf)&&!isObject(val=fn.call(it)))return val;if(!S&&"function"==typeof(fn=it.toString)&&!isObject(val=fn.call(it)))return val;throw TypeError("Can't convert object to primitive value")}},function(module,exports,__webpack_require__){var global=__webpack_require__(48),hide=__webpack_require__(66);module.exports=function(key,value){try{hide(global,key,value)}catch(error){global[key]=value}return value}},function(module,exports,__webpack_require__){var internalObjectKeys=__webpack_require__(132),hiddenKeys=__webpack_require__(113).concat("length","prototype");exports.f=Object.getOwnPropertyNames||function(O){return internalObjectKeys(O,hiddenKeys)}},function(module,exports,__webpack_require__){var UNSCOPABLES=__webpack_require__(54)("unscopables"),create=__webpack_require__(96),hide=__webpack_require__(66),ArrayPrototype=Array.prototype;null==ArrayPrototype[UNSCOPABLES]&&hide(ArrayPrototype,UNSCOPABLES,create(null)),module.exports=function(key){ArrayPrototype[UNSCOPABLES][key]=!0}},function(module,exports,__webpack_require__){var aFunction=__webpack_require__(245);module.exports=function(fn,that,length){if(aFunction(fn),void 0===that)return fn;switch(length){case 0:return function(){return fn.call(that)};case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}}},function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(260)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var model_1=__webpack_require__(55),BitLength=function(){function e(){}var s,d,i,o,l,n,t,r,m,p,u,_,a,c,F,g,v,y;return s=model_1.Fields.cmpId,d=model_1.Fields.cmpVersion,i=model_1.Fields.consentLanguage,o=model_1.Fields.consentScreen,l=model_1.Fields.created,n=model_1.Fields.isServiceSpecific,t=model_1.Fields.lastUpdated,r=model_1.Fields.policyVersion,m=model_1.Fields.publisherCountryCode,p=model_1.Fields.publisherLegitimateInterests,u=model_1.Fields.publisherConsents,_=model_1.Fields.purposeConsents,a=model_1.Fields.purposeLegitimateInterests,c=model_1.Fields.purposeOneTreatment,F=model_1.Fields.specialFeatureOptins,g=model_1.Fields.useNonStandardStacks,v=model_1.Fields.vendorListVersion,y=model_1.Fields.version,e[s]=12,e[d]=12,e[i]=12,e[o]=6,e[l]=36,e[n]=1,e[t]=36,e[r]=6,e[m]=12,e[p]=24,e[u]=24,e[_]=24,e[a]=24,e[c]=1,e[F]=12,e[g]=1,e[v]=12,e[y]=6,e.anyBoolean=1,e.encodingType=1,e.maxId=16,e.numCustomPurposes=6,e.numEntries=12,e.numRestrictions=12,e.purposeId=6,e.restrictionType=2,e.segmentType=3,e.singleOrRange=1,e.vendorId=16,e}();exports.BitLength=BitLength},function(module,exports,__webpack_require__){"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),(e=exports.RestrictionType||(exports.RestrictionType={}))[e.NOT_ALLOWED=0]="NOT_ALLOWED",e[e.REQUIRE_CONSENT=1]="REQUIRE_CONSENT",e[e.REQUIRE_LI=2]="REQUIRE_LI"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var BooleanEncoder_1=__webpack_require__(85),errors_1=__webpack_require__(51),model_1=__webpack_require__(55),FixedVectorEncoder=function(){function e(){}return e.encode=function(e,o){for(var r="",n=1;n<=o;n++)r+=BooleanEncoder_1.BooleanEncoder.encode(e.has(n));return r},e.decode=function(e,o){if(e.length!==o)throw new errors_1.DecodingError("bitfield encoding length mismatch");for(var r=new model_1.Vector,n=1;n<=o;n++)BooleanEncoder_1.BooleanEncoder.decode(e[n-1])&&r.set(n);return r.bitLength=e.length,r},e}();exports.FixedVectorEncoder=FixedVectorEncoder},function(module,exports){module.exports='<svg class="cnx-color-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 21h3V3h-3v18zM3 21l14-9L3 3v18z" fill-rule="evenodd"></path></svg>'},function(module,exports){module.exports='<svg class="cnx-color-icon" xmlns="http://www.w3.org/2000/svg"><path d="M8.6 16.6l4.58-4.6L8.6 7.4 10 6l6 6-6 6-1.4-1.4z"></path></svg>'},function(module,exports){module.exports='<svg class="cnx-color-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.6 3H10v2H5v5H3V4.6A1.58 1.58 0 0 1 4.6 3zM5 14v5h5v2H4.6A1.58 1.58 0 0 1 3 19.4V14h2zM19.4 3A1.58 1.58 0 0 1 21 4.6V10h-2V5h-5V3h5.4zM19 14h2v5.4a1.58 1.58 0 0 1-1.6 1.6H14v-2h5v-5z" fill-rule="evenodd"></path></svg>'},function(module,exports){module.exports='<svg class="cnx-color-icon" xmlns="http://www.w3.org/2000/svg"><g stroke-width="3" viewBox="0 0 32 32"><circle class="cnx-svg-circle-stroke" cx="16" cy="17" r="14"></circle></g></svg>'},function(module,exports){module.exports='<svg xmlns="http://www.w3.org/2000/svg" class="cnx-color-accent cnx-quote-icon" viewBox="0 0 13 10"><path d="M7 6.9C7 6.2 7.1 5.5 7.3 4.7 7.5 4 7.9 3.4 8.4 2.8 8.8 2.2 9.5 1.7 10.2 1.2 11 0.7 11.9 0.3 13 0L13 1.5C11.8 1.9 10.9 2.3 10.4 2.8 9.8 3.4 9.5 4 9.5 4.7 9.5 4.9 9.6 5.1 9.7 5.2 9.9 5.4 10 5.5 10.2 5.7 10.4 5.8 10.6 5.9 10.9 6 11.1 6.1 11.3 6.3 11.5 6.4 11.7 6.6 11.9 6.8 12 7 12.1 7.3 12.2 7.6 12.2 7.9 12.2 8.6 12 9.1 11.5 9.5 11.1 9.8 10.5 10 9.8 10 9.5 10 9.1 9.9 8.8 9.8 8.4 9.7 8.1 9.5 7.8 9.2 7.6 9 7.4 8.6 7.2 8.2 7.1 7.9 7 7.4 7 6.9ZM0 6.9C0 6.2 0.1 5.5 0.3 4.7 0.5 4 0.9 3.4 1.4 2.8 1.8 2.2 2.5 1.7 3.2 1.2 4 0.7 4.9 0.3 6 0L6 1.5C4.8 1.9 3.9 2.3 3.4 2.8 2.8 3.4 2.5 4 2.5 4.7 2.5 4.9 2.6 5.1 2.7 5.2 2.8 5.4 3 5.5 3.2 5.7 3.4 5.8 3.6 5.9 3.9 6 4.1 6.1 4.3 6.3 4.5 6.4 4.7 6.6 4.9 6.8 5 7 5.1 7.3 5.2 7.6 5.2 7.9 5.2 8.6 5 9.1 4.5 9.5 4.1 9.8 3.5 10 2.8 10 2.4 10 2.1 9.9 1.7 9.8 1.4 9.7 1.1 9.5 0.8 9.2 0.6 9 0.4 8.6 0.2 8.2 0.1 7.9 0 7.4 0 6.9Z"></path></svg>'},function(module,exports,__webpack_require__){"use strict";(function(global){function rawAsap(task){queue.length||(requestFlush(),!0),queue[queue.length]=task}module.exports=rawAsap;var requestFlush,queue=[],index=0,capacity=1024;function flush(){for(;index<queue.length;){var currentIndex=index;if(index+=1,queue[currentIndex].call(),index>capacity){for(var scan=0,newLength=queue.length-index;scan<newLength;scan++)queue[scan]=queue[scan+index];queue.length-=index,index=0}}queue.length=0,index=0,!1}var toggle,observer,node,scope=void 0!==global?global:self,BrowserMutationObserver=scope.MutationObserver||scope.WebKitMutationObserver;function makeRequestCallFromTimer(callback){return function(){var timeoutHandle=setTimeout(handleTimer,0),intervalHandle=setInterval(handleTimer,50);function handleTimer(){clearTimeout(timeoutHandle),clearInterval(intervalHandle),callback()}}}"function"==typeof BrowserMutationObserver?(toggle=1,observer=new BrowserMutationObserver(flush),node=document.createTextNode(""),observer.observe(node,{characterData:!0}),requestFlush=function(){toggle=-toggle,node.data=toggle}):requestFlush=makeRequestCallFromTimer(flush),rawAsap.requestFlush=requestFlush,rawAsap.makeRequestCallFromTimer=makeRequestCallFromTimer}).call(this,__webpack_require__(109))},function(module,exports,__webpack_require__){"use strict";var asap=__webpack_require__(130);function noop(){}var LAST_ERROR=null,IS_ERROR={};function Promise(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("Promise constructor's argument is not a function");this._U=0,this._V=0,this._W=null,this._X=null,fn!==noop&&doResolve(fn,this)}function handle(self,deferred){for(;3===self._V;)self=self._W;if(Promise._Y&&Promise._Y(self),0===self._V)return 0===self._U?(self._U=1,void(self._X=deferred)):1===self._U?(self._U=2,void(self._X=[self._X,deferred])):void self._X.push(deferred);!function(self,deferred){asap(function(){var cb=1===self._V?deferred.onFulfilled:deferred.onRejected;if(null!==cb){var ret=function(fn,a){try{return fn(a)}catch(ex){return LAST_ERROR=ex,IS_ERROR}}(cb,self._W);ret===IS_ERROR?reject(deferred.promise,LAST_ERROR):resolve(deferred.promise,ret)}else 1===self._V?resolve(deferred.promise,self._W):reject(deferred.promise,self._W)})}(self,deferred)}function resolve(self,newValue){if(newValue===self)return reject(self,new TypeError("A promise cannot be resolved with itself."));if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=function(obj){try{return obj.then}catch(ex){return LAST_ERROR=ex,IS_ERROR}}(newValue);if(then===IS_ERROR)return reject(self,LAST_ERROR);if(then===self.then&&newValue instanceof Promise)return self._V=3,self._W=newValue,void finale(self);if("function"==typeof then)return void doResolve(then.bind(newValue),self)}self._V=1,self._W=newValue,finale(self)}function reject(self,newValue){self._V=2,self._W=newValue,Promise._Z&&Promise._Z(self,newValue),finale(self)}function finale(self){if(1===self._U&&(handle(self,self._X),self._X=null),2===self._U){for(var i=0;i<self._X.length;i++)handle(self,self._X[i]);self._X=null}}function Handler(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,promise){var done=!1,res=function(fn,a,b){try{fn(a,b)}catch(ex){return LAST_ERROR=ex,IS_ERROR}}(fn,function(value){done||(done=!0,resolve(promise,value))},function(reason){done||(done=!0,reject(promise,reason))});done||res!==IS_ERROR||(done=!0,reject(promise,LAST_ERROR))}module.exports=Promise,Promise._Y=null,Promise._Z=null,Promise._0=noop,Promise.prototype.then=function(onFulfilled,onRejected){if(this.constructor!==Promise)return function(self,onFulfilled,onRejected){return new self.constructor(function(resolve,reject){var res=new Promise(noop);res.then(resolve,reject),handle(self,new Handler(onFulfilled,onRejected,res))})}(this,onFulfilled,onRejected);var res=new Promise(noop);return handle(this,new Handler(onFulfilled,onRejected,res)),res}},function(module,exports,__webpack_require__){var has=__webpack_require__(58),toIndexedObject=__webpack_require__(73),arrayIndexOf=__webpack_require__(134)(!1),hiddenKeys=__webpack_require__(81);module.exports=function(object,names){var key,O=toIndexedObject(object),i=0,result=[];for(key in O)!has(hiddenKeys,key)&&has(O,key)&&result.push(key);for(;names.length>i;)has(O,key=names[i++])&&(~arrayIndexOf(result,key)||result.push(key));return result}},function(module,exports){module.exports=function(it){if(null==it)throw TypeError("Can't call method on "+it);return it}},function(module,exports,__webpack_require__){var toIndexedObject=__webpack_require__(73),toLength=__webpack_require__(112),toAbsoluteIndex=__webpack_require__(229);module.exports=function(IS_INCLUDES){return function($this,el,fromIndex){var value,O=toIndexedObject($this),length=toLength(O.length),index=toAbsoluteIndex(fromIndex,length);if(IS_INCLUDES&&el!=el){for(;length>index;)if((value=O[index++])!=value)return!0}else for(;length>index;index++)if((IS_INCLUDES||index in O)&&O[index]===el)return IS_INCLUDES||index||0;return!IS_INCLUDES&&-1}}},function(module,exports){var ceil=Math.ceil,floor=Math.floor;module.exports=function(argument){return isNaN(argument=+argument)?0:(argument>0?floor:ceil)(argument)}},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(65)&&!__webpack_require__(59)(function(){return 7!=Object.defineProperty(__webpack_require__(137)("div"),"a",{get:function(){return 7}}).a})},function(module,exports,__webpack_require__){var isObject=__webpack_require__(60),document=__webpack_require__(48).document,exist=isObject(document)&&isObject(document.createElement);module.exports=function(it){return exist?document.createElement(it):{}}},function(module,exports,__webpack_require__){module.exports=__webpack_require__(83)("native-function-to-string",Function.toString)},function(module,exports,__webpack_require__){var fails=__webpack_require__(59),replacement=/#|\.prototype\./,isForced=function(feature,detection){var value=data[normalize(feature)];return value==POLYFILL||value!=NATIVE&&("function"==typeof detection?fails(detection):!!detection)},normalize=isForced.normalize=function(string){return String(string).replace(replacement,".").toLowerCase()},data=isForced.data={},NATIVE=isForced.NATIVE="N",POLYFILL=isForced.POLYFILL="P";module.exports=isForced},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(59)(function(){return!String(Symbol())})},function(module,exports,__webpack_require__){exports.f=__webpack_require__(54)},function(module,exports,__webpack_require__){module.exports=__webpack_require__(48)},function(module,exports,__webpack_require__){var classof=__webpack_require__(111);module.exports=Array.isArray||function(arg){return"Array"==classof(arg)}},function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(74),createIteratorConstructor=__webpack_require__(240),getPrototypeOf=__webpack_require__(146),setPrototypeOf=__webpack_require__(147),setToStringTag=__webpack_require__(95),hide=__webpack_require__(66),redefine=__webpack_require__(82),IS_PURE=__webpack_require__(91),ITERATOR=__webpack_require__(54)("iterator"),Iterators=__webpack_require__(84),IteratorsCore=__webpack_require__(145),IteratorPrototype=IteratorsCore.IteratorPrototype,BUGGY_SAFARI_ITERATORS=IteratorsCore.BUGGY_SAFARI_ITERATORS,returnThis=function(){return this};module.exports=function(Iterable,NAME,IteratorConstructor,next,DEFAULT,IS_SET,FORCED){createIteratorConstructor(IteratorConstructor,NAME,next);var CurrentIteratorPrototype,methods,KEY,getIterationMethod=function(KIND){if(KIND===DEFAULT&&defaultIterator)return defaultIterator;if(!BUGGY_SAFARI_ITERATORS&&KIND in IterablePrototype)return IterablePrototype[KIND];switch(KIND){case"keys":case"values":case"entries":return function(){return new IteratorConstructor(this,KIND)}}return function(){return new IteratorConstructor(this)}},TO_STRING_TAG=NAME+" Iterator",INCORRECT_VALUES_NAME=!1,IterablePrototype=Iterable.prototype,nativeIterator=IterablePrototype[ITERATOR]||IterablePrototype["@@iterator"]||DEFAULT&&IterablePrototype[DEFAULT],defaultIterator=!BUGGY_SAFARI_ITERATORS&&nativeIterator||getIterationMethod(DEFAULT),anyNativeIterator="Array"==NAME&&IterablePrototype.entries||nativeIterator;if(anyNativeIterator&&(CurrentIteratorPrototype=getPrototypeOf(anyNativeIterator.call(new Iterable)),IteratorPrototype!==Object.prototype&&CurrentIteratorPrototype.next&&(IS_PURE||getPrototypeOf(CurrentIteratorPrototype)===IteratorPrototype||(setPrototypeOf?setPrototypeOf(CurrentIteratorPrototype,IteratorPrototype):"function"!=typeof CurrentIteratorPrototype[ITERATOR]&&hide(CurrentIteratorPrototype,ITERATOR,returnThis)),setToStringTag(CurrentIteratorPrototype,TO_STRING_TAG,!0,!0),IS_PURE&&(Iterators[TO_STRING_TAG]=returnThis))),"values"==DEFAULT&&nativeIterator&&"values"!==nativeIterator.name&&(INCORRECT_VALUES_NAME=!0,defaultIterator=function(){return nativeIterator.call(this)}),IS_PURE&&!FORCED||IterablePrototype[ITERATOR]===defaultIterator||hide(IterablePrototype,ITERATOR,defaultIterator),Iterators[NAME]=defaultIterator,DEFAULT)if(methods={values:getIterationMethod("values"),keys:IS_SET?defaultIterator:getIterationMethod("keys"),entries:getIterationMethod("entries")},FORCED)for(KEY in methods)!BUGGY_SAFARI_ITERATORS&&!INCORRECT_VALUES_NAME&&KEY in IterablePrototype||redefine(IterablePrototype,KEY,methods[KEY]);else $export({target:NAME,proto:!0,forced:BUGGY_SAFARI_ITERATORS||INCORRECT_VALUES_NAME},methods);return methods}},function(module,exports,__webpack_require__){"use strict";var IteratorPrototype,PrototypeOfArrayIteratorPrototype,arrayIterator,getPrototypeOf=__webpack_require__(146),hide=__webpack_require__(66),has=__webpack_require__(58),IS_PURE=__webpack_require__(91),ITERATOR=__webpack_require__(54)("iterator"),BUGGY_SAFARI_ITERATORS=!1;[].keys&&("next"in(arrayIterator=[].keys())?(PrototypeOfArrayIteratorPrototype=getPrototypeOf(getPrototypeOf(arrayIterator)))!==Object.prototype&&(IteratorPrototype=PrototypeOfArrayIteratorPrototype):BUGGY_SAFARI_ITERATORS=!0),null==IteratorPrototype&&(IteratorPrototype={}),IS_PURE||has(IteratorPrototype,ITERATOR)||hide(IteratorPrototype,ITERATOR,function(){return this}),module.exports={IteratorPrototype:IteratorPrototype,BUGGY_SAFARI_ITERATORS:BUGGY_SAFARI_ITERATORS}},function(module,exports,__webpack_require__){var has=__webpack_require__(58),toObject=__webpack_require__(114),IE_PROTO=__webpack_require__(93)("IE_PROTO"),CORRECT_PROTOTYPE_GETTER=__webpack_require__(241),ObjectPrototype=Object.prototype;module.exports=CORRECT_PROTOTYPE_GETTER?Object.getPrototypeOf:function(O){return O=toObject(O),has(O,IE_PROTO)?O[IE_PROTO]:"function"==typeof O.constructor&&O instanceof O.constructor?O.constructor.prototype:O instanceof Object?ObjectPrototype:null}},function(module,exports,__webpack_require__){var validateSetPrototypeOfArguments=__webpack_require__(242);module.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var setter,correctSetter=!1,test={};try{(setter=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(test,[]),correctSetter=test instanceof Array}catch(error){}return function(O,proto){return validateSetPrototypeOfArguments(O,proto),correctSetter?setter.call(O,proto):O.__proto__=proto,O}}():void 0)},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(48),isForced=__webpack_require__(139),$export=__webpack_require__(74),redefine=__webpack_require__(82),InternalMetadataModule=__webpack_require__(149),iterate=__webpack_require__(150),anInstance=__webpack_require__(151),isObject=__webpack_require__(60),fails=__webpack_require__(59),checkCorrectnessOfIteration=__webpack_require__(254),setToStringTag=__webpack_require__(95),inheritIfRequired=__webpack_require__(255);module.exports=function(CONSTRUCTOR_NAME,wrapper,common,IS_MAP,IS_WEAK){var NativeConstructor=global[CONSTRUCTOR_NAME],NativePrototype=NativeConstructor&&NativeConstructor.prototype,Constructor=NativeConstructor,ADDER=IS_MAP?"set":"add",exported={},fixMethod=function(KEY){var nativeMethod=NativePrototype[KEY];redefine(NativePrototype,KEY,"add"==KEY?function(a){return nativeMethod.call(this,0===a?0:a),this}:"delete"==KEY?function(a){return!(IS_WEAK&&!isObject(a))&&nativeMethod.call(this,0===a?0:a)}:"get"==KEY?function(a){return IS_WEAK&&!isObject(a)?void 0:nativeMethod.call(this,0===a?0:a)}:"has"==KEY?function(a){return!(IS_WEAK&&!isObject(a))&&nativeMethod.call(this,0===a?0:a)}:function(a,b){return nativeMethod.call(this,0===a?0:a,b),this})};if(isForced(CONSTRUCTOR_NAME,"function"!=typeof NativeConstructor||!(IS_WEAK||NativePrototype.forEach&&!fails(function(){(new NativeConstructor).entries().next()}))))Constructor=common.getConstructor(wrapper,CONSTRUCTOR_NAME,IS_MAP,ADDER),InternalMetadataModule.REQUIRED=!0;else if(isForced(CONSTRUCTOR_NAME,!0)){var instance=new Constructor,HASNT_CHAINING=instance[ADDER](IS_WEAK?{}:-0,1)!=instance,THROWS_ON_PRIMITIVES=fails(function(){instance.has(1)}),ACCEPT_ITERABLES=checkCorrectnessOfIteration(function(iterable){new NativeConstructor(iterable)}),BUGGY_ZERO=!IS_WEAK&&fails(function(){for(var $instance=new NativeConstructor,index=5;index--;)$instance[ADDER](index,index);return!$instance.has(-0)});ACCEPT_ITERABLES||((Constructor=wrapper(function(target,iterable){anInstance(target,Constructor,CONSTRUCTOR_NAME);var that=inheritIfRequired(new NativeConstructor,target,Constructor);return null!=iterable&&iterate(iterable,that[ADDER],that,IS_MAP),that})).prototype=NativePrototype,NativePrototype.constructor=Constructor),(THROWS_ON_PRIMITIVES||BUGGY_ZERO)&&(fixMethod("delete"),fixMethod("has"),IS_MAP&&fixMethod("get")),(BUGGY_ZERO||HASNT_CHAINING)&&fixMethod(ADDER),IS_WEAK&&NativePrototype.clear&&delete NativePrototype.clear}return exported[CONSTRUCTOR_NAME]=Constructor,$export({global:!0,forced:Constructor!=NativeConstructor},exported),setToStringTag(Constructor,CONSTRUCTOR_NAME),IS_WEAK||common.setStrong(Constructor,CONSTRUCTOR_NAME,IS_MAP),Constructor}},function(module,exports,__webpack_require__){var METADATA=__webpack_require__(94)("meta"),FREEZING=__webpack_require__(249),isObject=__webpack_require__(60),has=__webpack_require__(58),defineProperty=__webpack_require__(62).f,id=0,isExtensible=Object.isExtensible||function(){return!0},setMetadata=function(it){defineProperty(it,METADATA,{value:{objectID:"O"+ ++id,weakData:{}}})},meta=module.exports={REQUIRED:!1,fastKey:function(it,create){if(!isObject(it))return"symbol"==typeof it?it:("string"==typeof it?"S":"P")+it;if(!has(it,METADATA)){if(!isExtensible(it))return"F";if(!create)return"E";setMetadata(it)}return it[METADATA].objectID},getWeakData:function(it,create){if(!has(it,METADATA)){if(!isExtensible(it))return!0;if(!create)return!1;setMetadata(it)}return it[METADATA].weakData},onFreeze:function(it){return FREEZING&&meta.REQUIRED&&isExtensible(it)&&!has(it,METADATA)&&setMetadata(it),it}};__webpack_require__(81)[METADATA]=!0},function(module,exports,__webpack_require__){var anObject=__webpack_require__(67),isArrayIteratorMethod=__webpack_require__(250),toLength=__webpack_require__(112),bind=__webpack_require__(120),getIteratorMethod=__webpack_require__(251),callWithSafeIterationClosing=__webpack_require__(253),BREAK={};(module.exports=function(iterable,fn,that,ENTRIES,ITERATOR){var iterator,iterFn,index,length,step,boundFunction=bind(fn,that,ENTRIES?2:1);if(ITERATOR)iterator=iterable;else{if("function"!=typeof(iterFn=getIteratorMethod(iterable)))throw TypeError("Target is not iterable");if(isArrayIteratorMethod(iterFn)){for(index=0,length=toLength(iterable.length);length>index;index++)if((ENTRIES?boundFunction(anObject(step=iterable[index])[0],step[1]):boundFunction(iterable[index]))===BREAK)return BREAK;return}iterator=iterFn.call(iterable)}for(;!(step=iterator.next()).done;)if(callWithSafeIterationClosing(iterator,boundFunction,step.value,ENTRIES)===BREAK)return BREAK}).BREAK=BREAK},function(module,exports){module.exports=function(it,Constructor,name){if(!(it instanceof Constructor))throw TypeError("Incorrect "+(name?name+" ":"")+"invocation");return it}},function(module,exports,__webpack_require__){"use strict";var defineProperty=__webpack_require__(62).f,create=__webpack_require__(96),redefineAll=__webpack_require__(256),bind=__webpack_require__(120),anInstance=__webpack_require__(151),iterate=__webpack_require__(150),defineIterator=__webpack_require__(144),setSpecies=__webpack_require__(257),DESCRIPTORS=__webpack_require__(65),fastKey=__webpack_require__(149).fastKey,InternalStateModule=__webpack_require__(92),setInternalState=InternalStateModule.set,internalStateGetterFor=InternalStateModule.getterFor;module.exports={getConstructor:function(wrapper,CONSTRUCTOR_NAME,IS_MAP,ADDER){var C=wrapper(function(that,iterable){anInstance(that,C,CONSTRUCTOR_NAME),setInternalState(that,{type:CONSTRUCTOR_NAME,index:create(null),first:void 0,last:void 0,size:0}),DESCRIPTORS||(that.size=0),null!=iterable&&iterate(iterable,that[ADDER],that,IS_MAP)}),getInternalState=internalStateGetterFor(CONSTRUCTOR_NAME),define=function(that,key,value){var previous,index,state=getInternalState(that),entry=getEntry(that,key);return entry?entry.value=value:(state.last=entry={index:index=fastKey(key,!0),key:key,value:value,previous:previous=state.last,next:void 0,removed:!1},state.first||(state.first=entry),previous&&(previous.next=entry),DESCRIPTORS?state.size++:that.size++,"F"!==index&&(state.index[index]=entry)),that},getEntry=function(that,key){var entry,state=getInternalState(that),index=fastKey(key);if("F"!==index)return state.index[index];for(entry=state.first;entry;entry=entry.next)if(entry.key==key)return entry};return redefineAll(C.prototype,{clear:function(){for(var state=getInternalState(this),data=state.index,entry=state.first;entry;)entry.removed=!0,entry.previous&&(entry.previous=entry.previous.next=void 0),delete data[entry.index],entry=entry.next;state.first=state.last=void 0,DESCRIPTORS?state.size=0:this.size=0},delete:function(key){var state=getInternalState(this),entry=getEntry(this,key);if(entry){var next=entry.next,prev=entry.previous;delete state.index[entry.index],entry.removed=!0,prev&&(prev.next=next),next&&(next.previous=prev),state.first==entry&&(state.first=next),state.last==entry&&(state.last=prev),DESCRIPTORS?state.size--:this.size--}return!!entry},forEach:function(callbackfn){for(var entry,state=getInternalState(this),boundFunction=bind(callbackfn,arguments.length>1?arguments[1]:void 0,3);entry=entry?entry.next:state.first;)for(boundFunction(entry.value,entry.key,this);entry&&entry.removed;)entry=entry.previous},has:function(key){return!!getEntry(this,key)}}),redefineAll(C.prototype,IS_MAP?{get:function(key){var entry=getEntry(this,key);return entry&&entry.value},set:function(key,value){return define(this,0===key?0:key,value)}}:{add:function(value){return define(this,value=0===value?0:value,value)}}),DESCRIPTORS&&defineProperty(C.prototype,"size",{get:function(){return getInternalState(this).size}}),C},setStrong:function(C,CONSTRUCTOR_NAME,IS_MAP){var ITERATOR_NAME=CONSTRUCTOR_NAME+" Iterator",getInternalCollectionState=internalStateGetterFor(CONSTRUCTOR_NAME),getInternalIteratorState=internalStateGetterFor(ITERATOR_NAME);defineIterator(C,CONSTRUCTOR_NAME,function(iterated,kind){setInternalState(this,{type:ITERATOR_NAME,target:iterated,state:getInternalCollectionState(iterated),kind:kind,last:void 0})},function(){for(var state=getInternalIteratorState(this),kind=state.kind,entry=state.last;entry&&entry.removed;)entry=entry.previous;return state.target&&(state.last=entry=entry?entry.next:state.state.first)?"keys"==kind?{value:entry.key,done:!1}:"values"==kind?{value:entry.value,done:!1}:{value:[entry.key,entry.value],done:!1}:(state.target=void 0,{value:void 0,done:!0})},IS_MAP?"entries":"values",!IS_MAP,!0),setSpecies(CONSTRUCTOR_NAME)}}},function(module,exports,__webpack_require__){"use strict";module.exports=Writer;var BufferWriter,util=__webpack_require__(69),LongBits=util.LongBits,base64=util.base64,utf8=util.utf8;function Op(fn,len,val){this.fn=fn,this.len=len,this.next=void 0,this.val=val}function noop(){}function State(writer){this.head=writer.head,this.tail=writer.tail,this.len=writer.len,this.next=writer.states}function Writer(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create=function(){return util.Buffer?function(){return(Writer.create=function(){return new BufferWriter})()}:function(){return new Writer}};function writeByte(val,buf,pos){buf[pos]=255&val}function VarintOp(len,val){this.len=len,this.next=void 0,this.val=val}function writeVarint64(val,buf,pos){for(;val.hi;)buf[pos++]=127&val.lo|128,val.lo=(val.lo>>>7|val.hi<<25)>>>0,val.hi>>>=7;for(;val.lo>127;)buf[pos++]=127&val.lo|128,val.lo=val.lo>>>7;buf[pos++]=val.lo}function writeFixed32(val,buf,pos){buf[pos]=255&val,buf[pos+1]=val>>>8&255,buf[pos+2]=val>>>16&255,buf[pos+3]=val>>>24}Writer.create=create(),Writer.alloc=function(size){return new util.Array(size)},util.Array!==Array&&(Writer.alloc=util.pool(Writer.alloc,util.Array.prototype.subarray)),Writer.prototype._push=function(fn,len,val){return this.tail=this.tail.next=new Op(fn,len,val),this.len+=len,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=function(val,buf,pos){for(;val>127;)buf[pos++]=127&val|128,val>>>=7;buf[pos]=val},Writer.prototype.uint32=function(value){return this.len+=(this.tail=this.tail.next=new VarintOp((value>>>=0)<128?1:value<16384?2:value<2097152?3:value<268435456?4:5,value)).len,this},Writer.prototype.int32=function(value){return value<0?this._push(writeVarint64,10,LongBits.fromNumber(value)):this.uint32(value)},Writer.prototype.sint32=function(value){return this.uint32((value<<1^value>>31)>>>0)},Writer.prototype.uint64=function(value){var bits=LongBits.from(value);return this._push(writeVarint64,bits.length(),bits)},Writer.prototype.int64=Writer.prototype.uint64,Writer.prototype.sint64=function(value){var bits=LongBits.from(value).zzEncode();return this._push(writeVarint64,bits.length(),bits)},Writer.prototype.bool=function(value){return this._push(writeByte,1,value?1:0)},Writer.prototype.fixed32=function(value){return this._push(writeFixed32,4,value>>>0)},Writer.prototype.sfixed32=Writer.prototype.fixed32,Writer.prototype.fixed64=function(value){var bits=LongBits.from(value);return this._push(writeFixed32,4,bits.lo)._push(writeFixed32,4,bits.hi)},Writer.prototype.sfixed64=Writer.prototype.fixed64,Writer.prototype.float=function(value){return this._push(util.float.writeFloatLE,4,value)},Writer.prototype.double=function(value){return this._push(util.float.writeDoubleLE,8,value)};var writeBytes=util.Array.prototype.set?function(val,buf,pos){buf.set(val,pos)}:function(val,buf,pos){for(var i=0;i<val.length;++i)buf[pos+i]=val[i]};Writer.prototype.bytes=function(value){var len=value.length>>>0;if(!len)return this._push(writeByte,1,0);if(util.isString(value)){var buf=Writer.alloc(len=base64.length(value));base64.decode(value,buf,0),value=buf}return this.uint32(len)._push(writeBytes,len,value)},Writer.prototype.string=function(value){var len=utf8.length(value);return len?this.uint32(len)._push(utf8.write,len,value):this._push(writeByte,1,0)},Writer.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer.prototype.ldelim=function(){var head=this.head,tail=this.tail,len=this.len;return this.reset().uint32(len),len&&(this.tail.next=head.next,this.tail=tail,this.len+=len),this},Writer.prototype.finish=function(){for(var head=this.head.next,buf=this.constructor.alloc(this.len),pos=0;head;)head.fn(head.val,buf,pos),pos+=head.len,head=head.next;return buf},Writer._configure=function(BufferWriter_){BufferWriter=BufferWriter_,Writer.create=create(),BufferWriter._configure()}},function(module,exports,__webpack_require__){"use strict";module.exports=Reader;var BufferReader,util=__webpack_require__(69),LongBits=util.LongBits,utf8=util.utf8;function indexOutOfRange(reader,writeLength){return RangeError("index out of range: "+reader.pos+" + "+(writeLength||1)+" > "+reader.len)}function Reader(buffer){this.buf=buffer,this.pos=0,this.len=buffer.length}var value,create_array="undefined"!=typeof Uint8Array?function(buffer){if(buffer instanceof Uint8Array||Array.isArray(buffer))return new Reader(buffer);throw Error("illegal buffer")}:function(buffer){if(Array.isArray(buffer))return new Reader(buffer);throw Error("illegal buffer")},create=function(){return util.Buffer?function(buffer){return(Reader.create=function(buffer){return util.Buffer.isBuffer(buffer)?new BufferReader(buffer):create_array(buffer)})(buffer)}:create_array};function readLongVarint(){var bits=new LongBits(0,0),i=0;if(!(this.len-this.pos>4)){for(;i<3;++i){if(this.pos>=this.len)throw indexOutOfRange(this);if(bits.lo=(bits.lo|(127&this.buf[this.pos])<<7*i)>>>0,this.buf[this.pos++]<128)return bits}return bits.lo=(bits.lo|(127&this.buf[this.pos++])<<7*i)>>>0,bits}for(;i<4;++i)if(bits.lo=(bits.lo|(127&this.buf[this.pos])<<7*i)>>>0,this.buf[this.pos++]<128)return bits;if(bits.lo=(bits.lo|(127&this.buf[this.pos])<<28)>>>0,bits.hi=(bits.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return bits;if(i=0,this.len-this.pos>4){for(;i<5;++i)if(bits.hi=(bits.hi|(127&this.buf[this.pos])<<7*i+3)>>>0,this.buf[this.pos++]<128)return bits}else for(;i<5;++i){if(this.pos>=this.len)throw indexOutOfRange(this);if(bits.hi=(bits.hi|(127&this.buf[this.pos])<<7*i+3)>>>0,this.buf[this.pos++]<128)return bits}throw Error("invalid varint encoding")}function readFixed32_end(buf,end){return(buf[end-4]|buf[end-3]<<8|buf[end-2]<<16|buf[end-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.create=create(),Reader.prototype._slice=util.Array.prototype.subarray||util.Array.prototype.slice,Reader.prototype.uint32=(value=4294967295,function(){if(value=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return value;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return value}),Reader.prototype.int32=function(){return 0|this.uint32()},Reader.prototype.sint32=function(){var value=this.uint32();return value>>>1^-(1&value)|0},Reader.prototype.bool=function(){return 0!==this.uint32()},Reader.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var value=util.float.readFloatLE(this.buf,this.pos);return this.pos+=4,value},Reader.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var value=util.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,value},Reader.prototype.bytes=function(){var length=this.uint32(),start=this.pos,end=this.pos+length;if(end>this.len)throw indexOutOfRange(this,length);return this.pos+=length,Array.isArray(this.buf)?this.buf.slice(start,end):start===end?new this.buf.constructor(0):this._slice.call(this.buf,start,end)},Reader.prototype.string=function(){var bytes=this.bytes();return utf8.read(bytes,0,bytes.length)},Reader.prototype.skip=function(length){if("number"==typeof length){if(this.pos+length>this.len)throw indexOutOfRange(this,length);this.pos+=length}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader.prototype.skipType=function(wireType){switch(wireType){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(wireType=7&this.uint32());)this.skipType(wireType);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+wireType+" at offset "+this.pos)}return this},Reader._configure=function(BufferReader_){BufferReader=BufferReader_,Reader.create=create(),BufferReader._configure();var fn=util.Long?"toLong":"toNumber";util.merge(Reader.prototype,{int64:function(){return readLongVarint.call(this)[fn](!1)},uint64:function(){return readLongVarint.call(this)[fn](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[fn](!1)},fixed64:function(){return readFixed64.call(this)[fn](!0)},sfixed64:function(){return readFixed64.call(this)[fn](!1)}})}},function(module,exports,__webpack_require__){"use strict";function __export(e){for(var r in e)exports.hasOwnProperty(r)||(exports[r]=e[r])}Object.defineProperty(exports,"__esModule",{value:!0}),__export(__webpack_require__(156)),__export(__webpack_require__(122)),__export(__webpack_require__(285)),__export(__webpack_require__(289)),__export(__webpack_require__(161)),__export(__webpack_require__(167))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var errors_1=__webpack_require__(51),Base64Url=function(){function r(){}return r.encode=function(r){if(!/^[0-1]+$/.test(r))throw new errors_1.EncodingError("Invalid bitField");var e=r.length%this.LCM;r+=e?"0".repeat(this.LCM-e):"";for(var t="",n=0;n<r.length;n+=this.BASIS)t+=this.DICT[parseInt(r.substr(n,this.BASIS),2)];return t},r.decode=function(r){if(!/^[A-Za-z0-9\-_]+$/.test(r))throw new errors_1.DecodingError("Invalidly encoded Base64URL string");for(var e="",t=0;t<r.length;t++){var n=this.REVERSE_DICT.get(r[t]).toString(2);e+="0".repeat(this.BASIS-n.length)+n}return e},r.DICT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",r.REVERSE_DICT=new Map([["A",0],["B",1],["C",2],["D",3],["E",4],["F",5],["G",6],["H",7],["I",8],["J",9],["K",10],["L",11],["M",12],["N",13],["O",14],["P",15],["Q",16],["R",17],["S",18],["T",19],["U",20],["V",21],["W",22],["X",23],["Y",24],["Z",25],["a",26],["b",27],["c",28],["d",29],["e",30],["f",31],["g",32],["h",33],["i",34],["j",35],["k",36],["l",37],["m",38],["n",39],["o",40],["p",41],["q",42],["r",43],["s",44],["t",45],["u",46],["v",47],["w",48],["x",49],["y",50],["z",51],["0",52],["1",53],["2",54],["3",55],["4",56],["5",57],["6",58],["7",59],["8",60],["9",61],["-",62],["_",63]]),r.BASIS=6,r.LCM=24,r}();exports.Base64Url=Base64Url},function(module,exports,__webpack_require__){"use strict";var t,__extends=this&&this.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)},function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)});Object.defineProperty(exports,"__esModule",{value:!0});var BinarySearchTree=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.root=null,e}return __extends(e,t),e.prototype.isEmpty=function(){return!this.root},e.prototype.add=function(t){var e,r={value:t,left:null,right:null};if(this.isEmpty())this.root=r;else for(e=this.root;;)if(t<e.value){if(null===e.left){e.left=r;break}e=e.left}else{if(!(t>e.value))break;if(null===e.right){e.right=r;break}e=e.right}},e.prototype.get=function(){for(var t=[],e=this.root;e;)if(e.left){for(var r=e.left;r.right&&r.right!=e;)r=r.right;r.right==e?(r.right=null,t.push(e.value),e=e.right):(r.right=e,e=e.left)}else t.push(e.value),e=e.right;return t},e.prototype.contains=function(t){for(var e=!1,r=this.root;r;){if(r.value===t){e=!0;break}t>r.value?r=r.right:t<r.value&&(r=r.left)}return e},e.prototype.min=function(t){var e;for(void 0===t&&(t=this.root);t;)t.left?t=t.left:(e=t.value,t=null);return e},e.prototype.max=function(t){var e;for(void 0===t&&(t=this.root);t;)t.right?t=t.right:(e=t.value,t=null);return e},e.prototype.remove=function(t,e){void 0===e&&(e=this.root);for(var r=null,o="left";e;)if(t<e.value)r=e,e=e.left,o="left";else if(t>e.value)r=e,e=e.right,o="right";else{if(e.left||e.right)if(e.left)if(e.right){var i=this.min(e.right);this.remove(i,e.right),e.value=i}else r?r[o]=e.left:this.root=e.left;else r?r[o]=e.right:this.root=e.right;else r?r[o]=null:this.root=null;e=null}},e}(__webpack_require__(75).Cloneable);exports.BinarySearchTree=BinarySearchTree},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Fields=function(){function e(){}return e.cmpId="cmpId",e.cmpVersion="cmpVersion",e.consentLanguage="consentLanguage",e.consentScreen="consentScreen",e.created="created",e.supportOOB="supportOOB",e.isServiceSpecific="isServiceSpecific",e.lastUpdated="lastUpdated",e.numCustomPurposes="numCustomPurposes",e.policyVersion="policyVersion",e.publisherCountryCode="publisherCountryCode",e.publisherCustomConsents="publisherCustomConsents",e.publisherCustomLegitimateInterests="publisherCustomLegitimateInterests",e.publisherLegitimateInterests="publisherLegitimateInterests",e.publisherConsents="publisherConsents",e.publisherRestrictions="publisherRestrictions",e.purposeConsents="purposeConsents",e.purposeLegitimateInterests="purposeLegitimateInterests",e.purposeOneTreatment="purposeOneTreatment",e.specialFeatureOptins="specialFeatureOptins",e.useNonStandardStacks="useNonStandardStacks",e.vendorConsents="vendorConsents",e.vendorLegitimateInterests="vendorLegitimateInterests",e.vendorListVersion="vendorListVersion",e.vendorsAllowed="vendorsAllowed",e.vendorsDisclosed="vendorsDisclosed",e.version="version",e}();exports.Fields=Fields},function(module,exports,__webpack_require__){"use strict";var e,__extends=this&&this.__extends||(e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)},function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)});Object.defineProperty(exports,"__esModule",{value:!0});var Cloneable_1=__webpack_require__(75),errors_1=__webpack_require__(51),RestrictionType_1=__webpack_require__(123),PurposeRestriction=function(e){function t(t,r){var o=e.call(this)||this;return void 0!==t&&(o.purposeId=t),void 0!==r&&(o.restrictionType=r),o}return __extends(t,e),t.unHash=function(e){var r=e.split(this.hashSeparator),o=new t;if(2!==r.length)throw new errors_1.TCModelError("hash",e);return o.purposeId=parseInt(r[0],10),o.restrictionType=parseInt(r[1],10),o},Object.defineProperty(t.prototype,"hash",{get:function(){if(!this.isValid())throw new Error("cannot hash invalid PurposeRestriction");return""+this.purposeId+t.hashSeparator+this.restrictionType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"purposeId",{get:function(){return this.purposeId_},set:function(e){this.purposeId_=e},enumerable:!0,configurable:!0}),t.prototype.isValid=function(){return Number.isInteger(this.purposeId)&&this.purposeId>0&&(this.restrictionType===RestrictionType_1.RestrictionType.NOT_ALLOWED||this.restrictionType===RestrictionType_1.RestrictionType.REQUIRE_CONSENT||this.restrictionType===RestrictionType_1.RestrictionType.REQUIRE_LI)},t.prototype.isSameAs=function(e){return this.purposeId===e.purposeId&&this.restrictionType===e.restrictionType},t.hashSeparator="-",t}(Cloneable_1.Cloneable);exports.PurposeRestriction=PurposeRestriction},function(module,exports,__webpack_require__){"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),(e=exports.Segment||(exports.Segment={})).CORE="core",e.VENDORS_DISCLOSED="vendorsDisclosed",e.VENDORS_ALLOWED="vendorsAllowed",e.PUBLISHER_TC="publisherTC"},function(module,exports,__webpack_require__){"use strict";function __export(e){for(var r in e)exports.hasOwnProperty(r)||(exports[r]=e[r])}Object.defineProperty(exports,"__esModule",{value:!0}),__export(__webpack_require__(85)),__export(__webpack_require__(162)),__export(__webpack_require__(286)),__export(__webpack_require__(124)),__export(__webpack_require__(70)),__export(__webpack_require__(163)),__export(__webpack_require__(164)),__export(__webpack_require__(166)),__export(__webpack_require__(165))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var IntEncoder_1=__webpack_require__(70),errors_1=__webpack_require__(51),DateEncoder=function(){function e(){}return e.encode=function(e,r){return IntEncoder_1.IntEncoder.encode(Math.round(e.getTime()/100),r)},e.decode=function(e,r){if(r!==e.length)throw new errors_1.DecodingError("invalid bit length");var n=new Date;return n.setTime(100*IntEncoder_1.IntEncoder.decode(e,r)),n},e}();exports.DateEncoder=DateEncoder},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var IntEncoder_1=__webpack_require__(70),errors_1=__webpack_require__(51),LangEncoder=function(){function e(){}return e.encode=function(e,r){var n=(e=e.toUpperCase()).charCodeAt(0)-65,o=e.charCodeAt(1)-65;if(n<0||n>25||o<0||o>25)throw new errors_1.EncodingError("invalid language code: "+e);if(r%2==1)throw new errors_1.EncodingError("numBits must be even, "+r+" is not valid");return r/=2,IntEncoder_1.IntEncoder.encode(n,r)+IntEncoder_1.IntEncoder.encode(o,r)},e.decode=function(e,r){if(r!==e.length||e.length%2)throw new errors_1.DecodingError("invalid bit length for language");var n=e.length/2,o=IntEncoder_1.IntEncoder.decode(e.slice(0,n),n)+65,t=IntEncoder_1.IntEncoder.decode(e.slice(n),n)+65;return String.fromCharCode(o)+String.fromCharCode(t)},e}();exports.LangEncoder=LangEncoder},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var BitLength_1=__webpack_require__(122),BooleanEncoder_1=__webpack_require__(85),errors_1=__webpack_require__(51),IntEncoder_1=__webpack_require__(70),model_1=__webpack_require__(55),PurposeRestrictionVectorEncoder=function(){function e(){}return e.encode=function(e){var t=IntEncoder_1.IntEncoder.encode(e.numRestrictions,BitLength_1.BitLength.numRestrictions);return e.isEmpty()||e.getRestrictions().forEach(function(n){t+=IntEncoder_1.IntEncoder.encode(n.purposeId,BitLength_1.BitLength.purposeId),t+=IntEncoder_1.IntEncoder.encode(n.restrictionType,BitLength_1.BitLength.restrictionType);for(var r=e.getVendors(n),o=r.length,i=0,d=0,c="",s=0;s<o;s++){var B=r[s];if(0===d&&(i++,d=B),s===o-1||r[s+1]>B+1){var g=!(B===d);c+=BooleanEncoder_1.BooleanEncoder.encode(g),c+=IntEncoder_1.IntEncoder.encode(d,BitLength_1.BitLength.vendorId),g&&(c+=IntEncoder_1.IntEncoder.encode(B,BitLength_1.BitLength.vendorId)),d=0}}t+=IntEncoder_1.IntEncoder.encode(i,BitLength_1.BitLength.numEntries),t+=c}),t},e.decode=function(e){var t=0,n=new model_1.PurposeRestrictionVector,r=IntEncoder_1.IntEncoder.decode(e.substr(t,BitLength_1.BitLength.numRestrictions),BitLength_1.BitLength.numRestrictions);t+=BitLength_1.BitLength.numRestrictions;for(var o=0;o<r;o++){var i=IntEncoder_1.IntEncoder.decode(e.substr(t,BitLength_1.BitLength.purposeId),BitLength_1.BitLength.purposeId);t+=BitLength_1.BitLength.purposeId;var d=IntEncoder_1.IntEncoder.decode(e.substr(t,BitLength_1.BitLength.restrictionType),BitLength_1.BitLength.restrictionType);t+=BitLength_1.BitLength.restrictionType;var c=new model_1.PurposeRestriction(i,d),s=IntEncoder_1.IntEncoder.decode(e.substr(t,BitLength_1.BitLength.numEntries),BitLength_1.BitLength.numEntries);t+=BitLength_1.BitLength.numEntries;for(var B=0;B<s;B++){var g=BooleanEncoder_1.BooleanEncoder.decode(e.substr(t,BitLength_1.BitLength.anyBoolean));t+=BitLength_1.BitLength.anyBoolean;var h=IntEncoder_1.IntEncoder.decode(e.substr(t,BitLength_1.BitLength.vendorId),BitLength_1.BitLength.vendorId);if(t+=BitLength_1.BitLength.vendorId,g){var L=IntEncoder_1.IntEncoder.decode(e.substr(t,BitLength_1.BitLength.vendorId),BitLength_1.BitLength.vendorId);if(t+=BitLength_1.BitLength.vendorId,L<h)throw new errors_1.DecodingError("Invalid RangeEntry: endVendorId "+L+" is less than "+h);for(var _=h;_<=L;_++)n.add(_,c)}else n.add(h,c)}}return n.bitLength=t,n},e}();exports.PurposeRestrictionVectorEncoder=PurposeRestrictionVectorEncoder},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var model_1=__webpack_require__(55),__1=__webpack_require__(155),IntEncoder_1=__webpack_require__(70),BooleanEncoder_1=__webpack_require__(85),FixedVectorEncoder_1=__webpack_require__(124),VectorEncodingType_1=__webpack_require__(166),errors_1=__webpack_require__(51),VendorVectorEncoder=function(){function e(){}return e.encode=function(e){var n,r=[],o=[],t=IntEncoder_1.IntEncoder.encode(e.maxId,__1.BitLength.maxId),d="",c=__1.BitLength.maxId+__1.BitLength.encodingType,_=c+e.maxId,i=2*__1.BitLength.vendorId+__1.BitLength.singleOrRange+__1.BitLength.numEntries,E=c+__1.BitLength.numEntries;return e.forEach(function(t,c){d+=BooleanEncoder_1.BooleanEncoder.encode(t),(n=e.maxId>i&&E<_)&&t&&(e.has(c+1)?0===o.length&&(o.push(c),E+=__1.BitLength.singleOrRange,E+=__1.BitLength.vendorId):(o.push(c),E+=__1.BitLength.vendorId,r.push(o),o=[]))}),n?(t+=VectorEncodingType_1.VectorEncodingType.RANGE+"",t+=this.buildRangeEncoding(r)):(t+=VectorEncodingType_1.VectorEncodingType.FIELD+"",t+=d),t},e.decode=function(e,n){var r,o=0,t=IntEncoder_1.IntEncoder.decode(e.substr(o,__1.BitLength.maxId),__1.BitLength.maxId);o+=__1.BitLength.maxId;var d=IntEncoder_1.IntEncoder.decode(e.charAt(o),__1.BitLength.encodingType);if(o+=__1.BitLength.encodingType,d===VectorEncodingType_1.VectorEncodingType.RANGE){if(r=new model_1.Vector,1===n){if("1"===e.substr(o,1))throw new errors_1.DecodingError("Unable to decode default consent=1");o++}var c=IntEncoder_1.IntEncoder.decode(e.substr(o,__1.BitLength.numEntries),__1.BitLength.numEntries);o+=__1.BitLength.numEntries;for(var _=0;_<c;_++){var i=BooleanEncoder_1.BooleanEncoder.decode(e.charAt(o));o+=__1.BitLength.singleOrRange;var E=IntEncoder_1.IntEncoder.decode(e.substr(o,__1.BitLength.vendorId),__1.BitLength.vendorId);if(o+=__1.BitLength.vendorId,i){var g=IntEncoder_1.IntEncoder.decode(e.substr(o,__1.BitLength.vendorId),__1.BitLength.vendorId);o+=__1.BitLength.vendorId;for(var a=E;a<=g;a++)r.set(a)}else r.set(E)}}else{var h=e.substr(o,t);o+=t,r=FixedVectorEncoder_1.FixedVectorEncoder.decode(h,t)}return r.bitLength=o,r},e.buildRangeEncoding=function(e){var n=e.length,r=IntEncoder_1.IntEncoder.encode(n,__1.BitLength.numEntries);return e.forEach(function(e){var n=1===e.length;r+=BooleanEncoder_1.BooleanEncoder.encode(!n),r+=IntEncoder_1.IntEncoder.encode(e[0],__1.BitLength.vendorId),n||(r+=IntEncoder_1.IntEncoder.encode(e[1],__1.BitLength.vendorId))}),r},e}();exports.VendorVectorEncoder=VendorVectorEncoder},function(module,exports,__webpack_require__){"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),(e=exports.VectorEncodingType||(exports.VectorEncodingType={}))[e.FIELD=0]="FIELD",e[e.RANGE=1]="RANGE"},function(module,exports,__webpack_require__){"use strict";function __export(e){for(var r in e)exports.hasOwnProperty(r)||(exports[r]=e[r])}Object.defineProperty(exports,"__esModule",{value:!0}),__export(__webpack_require__(287)),__export(__webpack_require__(288))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var encoder_1=__webpack_require__(155),model_1=__webpack_require__(55),IntEncoder_1=__webpack_require__(70),TCModel_1=__webpack_require__(290),TCString=function(){function e(){}return e.encode=function(e,n){var r,o,t="";return e=encoder_1.SemanticPreEncoder.process(e,n),(o=Array.isArray(null===(r=n)||void 0===r?void 0:r.segments)?n.segments:new encoder_1.SegmentSequence(e,n)[""+e.version]).forEach(function(n,r){var d="";r<o.length-1&&(d="."),t+=encoder_1.SegmentEncoder.encode(e,n)+d}),t},e.decode=function(e,n){var r=e.split("."),o=r.length;n||(n=new TCModel_1.TCModel);for(var t=0;t<o;t++){var d=r[t],c=encoder_1.Base64Url.decode(d.charAt(0)).substr(0,encoder_1.BitLength.segmentType),i=model_1.SegmentIDs.ID_TO_KEY[IntEncoder_1.IntEncoder.decode(c,encoder_1.BitLength.segmentType).toString()];encoder_1.SegmentEncoder.decode(d,n,i)}return n},e}();exports.TCString=TCString},function(module,exports,__webpack_require__){"use strict";var decodeConsentString=__webpack_require__(293).decodeConsentString;module.exports={decodeConsentString:decodeConsentString}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Loader});var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(14),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(8),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(3),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(9),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6__),Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(0),Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__),Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(11),Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(15),Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(5),Common_Services_TrackingService_TrackingService__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(217),Common_Services_ResizeObserverService_ResizeObserverService__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(214),Common_Services_MacrosService_MacrosService__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(171),Common_Models_AppConfig_AppConfig__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(172),Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(26),Common_Config_EnvironmentConfig__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(27),Common_GlobalServices_LoggingStorage_LoggingStorage__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(44),Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(4),Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(13),Common_Config_ApiConfig__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(25),Common_Services_PageFocusService_PageFocusService__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(97),Common_GlobalServices_ABService_ABService__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(53),Common_Services_UserManagerService_UserManagerService__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(86),Common_Services_TrackingService_EmptyTrackingService__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(173),Common_Modules_PluginsHandler_PluginsHandler__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(215),Common_OMID_SessionClientWrapper_SessionClientWrapper__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(216),Common_OMID_Config_OmidConfig__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(37),Common_Config_BrowserConfig__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(34),Common_Modules_Loader_Modules_PlayerReloader_PlayerReloader__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(174),Common_Modules_Mediator_Mediator__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(28),Common_Config_ExperienceConfig__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(30),Common_Config_CssClassesConfig__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(7),Common_Services_GlobalDomUtilsService_GlobalDomUtilsService__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(175),Common_Modules_FraudSensor_FraudSensor__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(218),Common_Services_InteractionService_InteractionService__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(219),Common_Services_AdDomainBlockingService_AdDomainBlockingService__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(77),Common_GlobalServices_AdBlockerDetectionService_AdBlockerDetectionService__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(46),Common_Services_UrlSuffixerService_UrlSuffixerService__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(104);function _createSuper(Derived){return function(){var result,Super=_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(Derived);if(_isNativeReflectConstruct()){var NewTarget=_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5___default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default()(this,result)}}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var CUSTOM_API_NAME="player_instance",CNX_LINE_ITEM_ID_SEPARATOR=",",Loader=function(_Mediator){_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_6___default()(Loader,_Mediator);var _super=_createSuper(Loader);function Loader(services,GLOBAL,_isInApp,_isAmp,_isInAppSDK,_isOVPDomain,readyCallback){var _this;return _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default()(this,Loader),(_this=_super.call(this)).services=services,_this.GLOBAL=GLOBAL,_this._isInApp=_isInApp,_this._isAmp=_isAmp,_this._isInAppSDK=_isInAppSDK,_this._isOVPDomain=_isOVPDomain,_this.readyCallback=readyCallback,_this._playerVariantOptions={},_this._TEMPLATE_ELEMENT="<cnx-placeholder></cnx-placeholder>",_this._FIND_INSERT_PATH_TIMEOUT=100,_this._FIND_CNX_REF_TIMEOUT=1e3,_this.isServerlessMode=!1,_this._isGroupScript=!1,_this._apiResponses=[],_this._omidVerificationClient="{{omidVerificationClient}}",_this._isInApp&&_this._insertOmidVerificationClient(),Common_GlobalServices_AdBlockerDetectionService_AdBlockerDetectionService__WEBPACK_IMPORTED_MODULE_37__.a.detectUsingCSS(_this.GLOBAL),_this._referrer=Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__.p)(_this.GLOBAL),_this}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default()(Loader,[{key:"_stripDownJsApiConfigForGroupScript",value:function(){var strippedDownConfig={playerId:this.externalAttributes.playerId,_appSettings:this.externalAttributes._appSettings,settings:{_connatixInternals:this.externalAttributes.settings._connatixInternals,advertising:{},customization:{},rendering:{},plugins:{}}};this.externalAttributes.customParam1&&(strippedDownConfig.customParam1=this.externalAttributes.customParam1),this.externalAttributes.customParam2&&(strippedDownConfig.customParam2=this.externalAttributes.customParam2),this.externalAttributes.customParam3&&(strippedDownConfig.customParam3=this.externalAttributes.customParam3),this.externalAttributes.customParam4&&(strippedDownConfig.customParam4=this.externalAttributes.customParam4),this.externalAttributes.customParam5&&(strippedDownConfig.customParam5=this.externalAttributes.customParam5),this.externalAttributes.settings.useExternalViewabilityService&&(strippedDownConfig.settings.useExternalViewabilityService=this.externalAttributes.settings.useExternalViewabilityService),this.externalAttributes=strippedDownConfig}},{key:"_toggleIframeVisibility",value:function(renderInFrame){var frameElement=this.GLOBAL.frameElement;if(!!Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__.E)(frameElement)){var hideIframe=!0;frameElement&&renderInFrame&&(hideIframe=!1),hideIframe?Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__.v)(frameElement):Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__.R)(frameElement)}}},{key:"_getInsertPathTarget",value:function(selector,GLOBAL){try{return this._getElementFromSelector(selector,GLOBAL)}catch(_a){return null}}},{key:"_getComputedSelector",value:function _getComputedSelector(insertPath){var selector;try{selector=eval(insertPath)}catch(e){selector=insertPath.replace(/\[(\d+)]/g,":nth-child($1)")}return selector}},{key:"_findInsertPathParent",value:function(selector,GLOBAL){var _this2=this,parent=this._getInsertPathTarget(selector,GLOBAL);return null===parent?new Promise(function(resolve){setTimeout(function(){resolve(_this2._findInsertPathParent(selector,GLOBAL))},_this2._FIND_INSERT_PATH_TIMEOUT)}):Promise.resolve(parent)}},{key:"_getInsertPathParent",value:function(insertPath,GLOBAL){var selector=this._getComputedSelector(insertPath);return Promise.resolve(this._findInsertPathParent(selector,GLOBAL))}},{key:"_getElementFromSelector",value:function(selector,GLOBAL){var computedData,_this3=this;return selector.split(/(\.cnxEq\(\d+\))/).filter(function(elem){return elem}).forEach(function(section){computedData=-1===section.indexOf("cnxEq")?computedData?computedData.querySelectorAll(section):Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__.K)(section,GLOBAL):_this3._applyEq(computedData,section)}),computedData?(computedData.hasOwnProperty("length")&&(computedData=computedData.length>0?computedData[0]:null),computedData):null}},{key:"_applyEq",value:function(elementCollection,section){var eqIndex=/\d+/g.exec(section),index=parseInt(eqIndex[0],10);return index>elementCollection.length?Object(Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_19__.c)(elementCollection)[elementCollection.length-1]:Object(Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_19__.c)(elementCollection)[index]}},{key:"_getImplementationType",value:function(){return this._isAmp?Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoImplementationType.Amp:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoImplementationType.Web}},{key:"_getInsertContainer",value:function(player,playerResponse){var forceInsertPath,_this4=this,findFrameResult=Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_9__.f)(this.GLOBAL);return forceInsertPath=Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_18__.a)(this.externalAttributes.settings.rendering.forceInsertPath)?this.externalAttributes.settings.rendering.forceInsertPath:playerResponse.forceInsertPath,new Promise(function(resolve,reject){var containerSelector,insertPosition,position,placeholder=Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__.f)(_this4._TEMPLATE_ELEMENT,_this4.GLOBAL);forceInsertPath||player.tag.parentNode===_this4.GLOBAL.document.head&&(!findFrameResult.topChildFrame||playerResponse.renderInFrame)?(findFrameResult.topChildFrame&&Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__.L)(findFrameResult.topChildFrame.frameElement,Common_Config_CssClassesConfig__WEBPACK_IMPORTED_MODULE_32__.h.DisplayNone),containerSelector=Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_18__.h)(_this4.externalAttributes.settings.rendering.containerSelector)?_this4.externalAttributes.settings.rendering.containerSelector:playerResponse.containerSelector,insertPosition=Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_18__.a)(_this4.externalAttributes.settings.rendering.insertPosition)?_this4.externalAttributes.settings.rendering.insertPosition:playerResponse.insertPosition,position=Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_18__.a)(_this4.externalAttributes.settings.rendering.position)?_this4.externalAttributes.settings.rendering.position:playerResponse.position,_this4._getInsertPathParent(containerSelector,findFrameResult.topFrame).then(function(insertParent){_this4._insertElementByPosition(insertParent,placeholder,insertPosition,position),resolve({insertContainer:placeholder,insertWindow:findFrameResult.topFrame})})):findFrameResult.topChildFrame&&!playerResponse.renderInFrame?(placeholder=Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__.f)(_this4._TEMPLATE_ELEMENT,findFrameResult.topFrame),findFrameResult.topChildFrame.frameElement.parentNode.insertBefore(placeholder,findFrameResult.topChildFrame.frameElement),Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__.a)(findFrameResult.topChildFrame.frameElement,Common_Config_CssClassesConfig__WEBPACK_IMPORTED_MODULE_32__.h.DisplayNone),resolve({insertContainer:placeholder,insertWindow:findFrameResult.topFrame})):(player.tag.parentNode.insertBefore(placeholder,player.tag),resolve({insertContainer:placeholder}))})}},{key:"_insertElementWithinContainer",value:function(targetElement,placeholderElement,position){Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__.y)(placeholderElement,targetElement,position)}},{key:"_insertElementOutsideContainer",value:function(targetElement,placeholderElement,insertPosition){switch(insertPosition){case Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoPlayerInsertMode.BeforeContainer:targetElement.parentElement.insertBefore(placeholderElement,targetElement);break;case Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoPlayerInsertMode.ReplaceContainer:targetElement.parentElement.insertBefore(placeholderElement,targetElement),Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__.M)(targetElement);break;case Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoPlayerInsertMode.HideContainer:targetElement.parentElement.insertBefore(placeholderElement,targetElement),Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__.v)(targetElement);break;case Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoPlayerInsertMode.AfterContainer:targetElement.nextElementSibling?targetElement.parentElement.insertBefore(placeholderElement,targetElement.nextElementSibling):targetElement.parentElement.appendChild(placeholderElement)}}},{key:"_insertElementByPosition",value:function(targetElement,placeholderElement,insertPosition,position){insertPosition===Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoPlayerInsertMode.WithinContainer?this._insertElementWithinContainer(targetElement,placeholderElement,position):this._insertElementOutsideContainer(targetElement,placeholderElement,insertPosition)}},{key:"_mergeAdSources",value:function(player){var commonAdSources=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];player.lineItems=[].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(player.lineItems),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(commonAdSources));var receivedLineItemsLength=player.lineItems.length;player.lineItems=Object(Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_19__.e)("advertiserLineItemId",player.lineItems),receivedLineItemsLength!==player.lineItems.length&&Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.WARNING,message:"Loader_duplicated_adsources",callStack:"_"})}},{key:"_sendDataToRenderer",value:function(playerResponse,index){var _this5=this,currentPlayer=playerResponse.players[index],_this$_playerVariantO=this._playerVariantOptions[index],playerModel=_this$_playerVariantO.playerModel,globalDomUtilsService=_this$_playerVariantO.globalDomUtilsService,urlSuffixerService=_this$_playerVariantO.urlSuffixerService;if(this._setThirdPartySyncUrls(playerResponse.cookieSyncUrls),this.services.UserManagerService.setGeoLocation(playerResponse.geoLocation),Common_GlobalServices_LoggingStorage_LoggingStorage__WEBPACK_IMPORTED_MODULE_17__.a.sessionId=currentPlayer.sessionId,this._playerReloader.addPlayerSession(currentPlayer.playerId,currentPlayer.sessionId),playerModel){var appConfig=new Common_Models_AppConfig_AppConfig__WEBPACK_IMPORTED_MODULE_14__.a({browser:playerResponse.browser,geoLocation:playerResponse.geoLocation,pageUrl:this.pageUrl,playerId:playerModel.playerId,explorationMode:playerResponse.explorationMode,bundleID:this.externalAttributes._appSettings.bundleID,appID:this.externalAttributes._appSettings.appID,domainURL:this.externalAttributes._appSettings.domainURL,storeURL:this.externalAttributes._appSettings.storeURL,appCategories:this.externalAttributes._appSettings.appCategories,appIsPaid:this.externalAttributes._appSettings.appIsPaid,appName:this.externalAttributes._appSettings.appName,appPrivacyPolicy:this.externalAttributes._appSettings.appPrivacyPolicy,appVersion:this.externalAttributes._appSettings.appVersion,deviceId:this.externalAttributes._appSettings.deviceID,isRecyclerViewIntegration:this.externalAttributes._appSettings.isRecyclerViewIntegration,appPageURL:this.externalAttributes._appSettings.appPageURL,isOVPDomain:this._isOVPDomain}),forceFallbackImplementation=appConfig.browser.browserType===Common_Config_BrowserConfig__WEBPACK_IMPORTED_MODULE_28__.a.InternetExplorer,pageFocusService=new Common_Services_PageFocusService_PageFocusService__WEBPACK_IMPORTED_MODULE_21__.a(globalDomUtilsService),viewabilityService=this.getViewabilityService(playerModel,pageFocusService,forceFallbackImplementation);Common_GlobalServices_AdBlockerDetectionService_AdBlockerDetectionService__WEBPACK_IMPORTED_MODULE_37__.a.detectUsingCSS(playerModel.global);var macrosService=new Common_Services_MacrosService_MacrosService__WEBPACK_IMPORTED_MODULE_13__.a(playerModel,playerResponse.geoLocation,appConfig.pageUrl,appConfig.pageDomain,this.externalAttributes._appSettings,this._referrer,playerResponse.publisherNetworkCode),app={services:{GlobalDomUtilsService:globalDomUtilsService,ViewabilityService:viewabilityService,TrackingService:this._getTrackingServiceInstance(playerModel,playerResponse,index),ResizeObserver:new Common_Services_ResizeObserverService_ResizeObserverService__WEBPACK_IMPORTED_MODULE_12__.a(playerModel.global),UserManagerService:this.services.UserManagerService,MacrosService:macrosService,EventsStorageService:this.services.EventsStorageService,PageFocusService:pageFocusService,InteractionService:new Common_Services_InteractionService_InteractionService__WEBPACK_IMPORTED_MODULE_35__.a(playerModel.global,appConfig.isMobile),UrlSuffixerService:urlSuffixerService},config:appConfig};Common_GlobalServices_AdBlockerDetectionService_AdBlockerDetectionService__WEBPACK_IMPORTED_MODULE_37__.a.isBannerBlocked&&app.services.TrackingService.trackSessionAdBlocker(Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoAdBlockDetectionTypeEnum.Banner),app.services.UserManagerService.setPageUrl(app.config.pageUrl);var implementationType=this._getImplementationType();app.services.TrackingService.setImplementationTypeOnMeta(implementationType),playerModel.externalMacros&&app.services.MacrosService.addExtraMacros(playerModel.externalMacros),app.services.UserManagerService.onEvent([Common_Services_UserManagerService_UserManagerService__WEBPACK_IMPORTED_MODULE_23__.a.CCPA_INFO_RECEIVED]).then(function(){app.services.MacrosService.setUsPrivacyString(app.services.UserManagerService.getUsPrivacyString())}),app.services.UserManagerService.onEvent([Common_Services_UserManagerService_UserManagerService__WEBPACK_IMPORTED_MODULE_23__.a.CONSENT_DATA_UPDATE]).then(function(){app.services.TrackingService.updateMetadataModel({userId:app.services.UserManagerService.getTrackableUser()});var consentPayload=app.services.UserManagerService.getConsentPayload();if(app.services.TrackingService.hasGdprConsentPayload=Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_18__.h)(consentPayload),_this5.services.UserManagerService.gdprConsentMode===Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoGdprConsentModeEnum.NoConsent||_this5._isInApp){var allDemandConsented=playerModel.lineItemSettings.lineItems.filter(function(lineItem){return Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_18__.h)(lineItem.vendorId)}).every(function(lineItem){return _this5.services.UserManagerService.isConsent(lineItem.vendorId)});_this5.services.UserManagerService.gdprConsentMode=allDemandConsented?Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoGdprConsentModeEnum.AllGood:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoGdprConsentModeEnum.NotAllDemandConsent}});var reloadData={wasPlayerReloaded:this._playerReloader.wasPlayerReloaded(currentPlayer.playerId),wasPlayerInView:this._playerReloader.getSessionInView(currentPlayer.playerId)};this.renderer=this.getRendererInstance(playerModel,app,reloadData,this.externalAttributes._appSettings),this.subscribe(Common_Config_ExperienceConfig__WEBPACK_IMPORTED_MODULE_31__.c.SessionView,this.renderer,function(){_this5._playerReloader.addSessionInView(currentPlayer.playerId)}),this.subscribe(Common_Config_ExperienceConfig__WEBPACK_IMPORTED_MODULE_31__.c.SessionRendered,this.renderer,function(){_this5._initFraudSensor(macrosService,globalDomUtilsService,app.config)});var apiObject=Object.assign({configEnums:this.getApiConfigEnums(),configEvents:this.getApiConfigEvents()},this.renderer.getApiMethods()),customJsCode=currentPlayer.customJsCode;if(customJsCode){var cnxJsApiName="".concat(CUSTOM_API_NAME,"_").concat(app.config.appId);this.GLOBAL[cnxJsApiName]=apiObject,customJsCode=customJsCode.cnx_replaceAll('"{{'.concat(CUSTOM_API_NAME,'}}"'),"window.".concat(cnxJsApiName))}this.renderer.init(function(){_this5._addCustomScriptToGlobal(customJsCode)})?this.registerApiSuccess(apiObject):this.registerApiError(Common_Config_ApiConfig__WEBPACK_IMPORTED_MODULE_20__.a.RenderError,"Player size under supported value")}else this.registerApiError(Common_Config_ApiConfig__WEBPACK_IMPORTED_MODULE_20__.a.SetupError,"No playlist was provided!")}},{key:"_getTrackingServiceInstance",value:function(playerModel,playerResponse,index){return playerModel.disableTracking?new Common_Services_TrackingService_EmptyTrackingService__WEBPACK_IMPORTED_MODULE_24__.a:new Common_Services_TrackingService_TrackingService__WEBPACK_IMPORTED_MODULE_11__.a({userManagerService:this.services.UserManagerService,browser:playerResponse.browser,geoLocation:playerResponse.geoLocation,playerId:playerModel.playerId,userId:this.services.UserManagerService.getTrackableUser(),sessionId:playerResponse.players[index].sessionId,pageUrl:this.pageUrl,bundleId:this.externalAttributes._appSettings.bundleID,customParam1:this.externalAttributes.customParam1,customParam2:this.externalAttributes.customParam2,customParam3:this.externalAttributes.customParam3,customParam4:this.externalAttributes.customParam4,customParam5:this.externalAttributes.customParam5,abTestId:playerResponse.players[index].abTestId,explorationMode:playerResponse.explorationMode})}},{key:"_addCustomScriptToGlobal",value:function(customJsScript){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{useSafeMode:!0};if(customJsScript){var safeCustomJsScript,global=options.global,useSafeMode=options.useSafeMode,desiredGlobal=global||this.GLOBAL;safeCustomJsScript=useSafeMode?'\n        (function() {\n            "use strict";\n            try {\n                '.concat(customJsScript,"\n            }catch(e){\n                console.warn('---CnxCustomApiError---');\n                console.warn(e.message);\n            }\n          })()\n        "):customJsScript,Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_10__.z)(desiredGlobal.document.head,desiredGlobal,safeCustomJsScript.trim())}}},{key:"_insertOmidVerificationClient",value:function(){if(!this._omidVerificationClient.includes("{{omidVerificationClient")){var options={useSafeMode:!1,global:window};this._addCustomScriptToGlobal(decodeURI(this._omidVerificationClient),options)}}},{key:"_doPlayerIdCall",value:function(){var _this6=this,_this$_player=this._player,playerId=_this$_player.playerId,parseDomain=_this$_player.parseDomain;return this._getPlsData(playerId,parseDomain).catch(function(e){var error=new Error(e);throw Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({callStack:error.stack,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.FATAL,exception:error.message,message:"Prerender_Loader_player_id_call_get_pls",throttle:1e3}),_this6.registerApiError(Common_Config_ApiConfig__WEBPACK_IMPORTED_MODULE_20__.a.SetupError,"player data call error"),_this6._onPlsFinally(),error})}},{key:"_onPlsResponse",value:function(playerResponse){var _this7=this,browser=playerResponse.browser,userInformation=playerResponse.userInformation;if(this.services.UserManagerService.setUserInformation(userInformation),this.services.UserManagerService.setBrowserInfo(browser),userInformation&&userInformation.callFraudSensor){var lookupId=userInformation.lookupId,lookupResponseCode=userInformation.lookupResponseCode,publisherAdsTxt=userInformation.publisherAdsTxt;this._fraudSensorConfig={lookupId:lookupId,lookupResponseCode:lookupResponseCode,publisherAdsTxt:publisherAdsTxt,deviceType:browser.device}}Common_GlobalServices_ABService_ABService__WEBPACK_IMPORTED_MODULE_22__.a.serverAb0=playerResponse.serverAb0,Common_GlobalServices_ABService_ABService__WEBPACK_IMPORTED_MODULE_22__.a.serverAb1=playerResponse.serverAb1,Object(Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_19__.h)(playerResponse.players)?(playerResponse.players.length>1&&(this._stripDownJsApiConfigForGroupScript(),this._isGroupScript=!0),Object.keys(playerResponse.players).forEach(function(playerIndex){_this7._processPlsData(playerResponse,_this7._player,playerIndex)})):this.registerApiError(Common_Config_ApiConfig__WEBPACK_IMPORTED_MODULE_20__.a.NoPlayer,"No player available for given player id:".concat(this._player.playerId)),this._onPlsFinally()}},{key:"_onPlsFinally",value:function(){this._deregisterPlsCall(),this._tieLooseEndsSinceICantUseFinally()}},{key:"_tieLooseEndsSinceICantUseFinally",value:function(){var _this8=this;setTimeout(function(){if(!_this8._isGroupScript){var apiResponse=_this8._apiResponses[0];_this8.readyCallback&&_this8.readyCallback(apiResponse.apiErrorObj,apiResponse.apiConfigObj)}_this8._handleApiResponses()})}},{key:"_handleApiResponses",value:function(){var _this9=this;this._apiResponses.filter(function(response){return response.apiErrorObj}).forEach(function(){_this9.services.EventsStorageService.emitRenderError()})}},{key:"_processPlsData",value:function(playerResponse,playerData,index){var player=playerResponse.players[index],playerModel=this._playerVariantOptions[index].playerModel;this._toggleIframeVisibility(player.renderInFrame),this._sendDataToRenderer(playerResponse,index),this._initConnatixPlugins(playerModel,this.renderer.playerContainer)}},{key:"_getPlsData",value:function(playerId){var _this10=this,requestData={parseDomain:arguments.length>1&&void 0!==arguments[1]&&arguments[1],referrer:this._referrer,pageUrl:this.pageUrl,tokens:[playerId]};requestData.bundleId=this.externalAttributes._appSettings.bundleID,this.queryParams.cnxLineItemId&&(requestData.forceLineItemIds=this.queryParams.cnxLineItemId.split(CNX_LINE_ITEM_ID_SEPARATOR).filter(function(token){return Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_18__.h)(token)})),this.queryParams.cnxPlayerId?requestData.forcePlayerId=this.queryParams.cnxPlayerId:this.externalAttributes.settings._connatixInternals.skipServingRules&&(requestData.forcePlayerId=playerId),this.queryParams.cnxExplorationMode&&(requestData.forceExploration=!0);var queryJsTargeting=this.externalAttributes.settings.queryJsTargeting;return Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_18__.f)(queryJsTargeting)&&Object.keys(queryJsTargeting).length>0&&(requestData.queryJsTargeting=Object.keys(queryJsTargeting).reduce(function(acc,key){return Object.assign(Object.assign({},acc),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()({},key,"".concat(queryJsTargeting[key])))},{})),requestData.customParam1=this.externalAttributes.customParam1,requestData.customParam2=this.externalAttributes.customParam2,requestData.customParam3=this.externalAttributes.customParam3,requestData.customParam4=this.externalAttributes.customParam4,requestData.customParam5=this.externalAttributes.customParam5,requestData.disableTracking=this.externalAttributes.settings._connatixInternals.disableTracking,requestData.version=Common_Config_EnvironmentConfig__WEBPACK_IMPORTED_MODULE_16__.a.version,requestData.es6=Common_Config_EnvironmentConfig__WEBPACK_IMPORTED_MODULE_16__.b,requestData.userId=this.services.UserManagerService.getForcedTrackableUser(),requestData.isConsentConnatix=this.services.UserManagerService.isConsentConnatix(),requestData.clientAb0=Common_GlobalServices_ABService_ABService__WEBPACK_IMPORTED_MODULE_22__.a.clientAb0,requestData.clientAb1=Common_GlobalServices_ABService_ABService__WEBPACK_IMPORTED_MODULE_22__.a.clientAb1,requestData.implementationType=this._getImplementationType(),requestData.reloadedPlayers=this._playerReloader.getCookiePlayersSession(),requestData=Object.assign(Object.assign({},requestData),this.getSpecificRequestData()),this._player.playerId?this.getPlayerResponse(requestData,this._player.playerId||"serverless"):new Promise(function(resolve,reject){_this10.isServerlessMode=!0,resolve(_this10.defaultInitFromProto())})}},{key:"_getQueryParams",value:function(){var videoPosition=Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__.b)("cnxVideoPosition",this.pageUrl),forcedStoryPosition=parseInt(Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__.b)("cnxStoryPosition",this.pageUrl),10);return{cnxStoryId:Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__.b)("cnxStoryId",this.pageUrl),cnxLineItemId:Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__.b)("cnxLineItemId",this.pageUrl),cnxPlayerId:Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__.b)("cnxPlayerId",this.pageUrl),cnxMediaId:Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__.b)("cnxMediaId",this.pageUrl),cnxPlaylistId:Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__.b)("cnxPlaylistId",this.pageUrl),cnxVideoPosition:videoPosition?parseInt(videoPosition,10):null,cnxExplorationMode:"true"===Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__.b)("cnxExplorationMode",this.pageUrl),cnxStoryPosition:Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_18__.e)(forcedStoryPosition)?forcedStoryPosition:null,cnxSkipAdsFlag:"true"===Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__.b)("cnxSkipAdsFlag",this.pageUrl),cnxReloadTime:parseInt(Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__.b)("cnxReloadTime",this.pageUrl),10),cnxOverrideLineitems:"true"===Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__.b)("cnxOverrideLineitems",this.pageUrl),cnxIsSeoTraffic:"true"===Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__.b)("cnxIsSeoTraffic",this.pageUrl)}}},{key:"_initConnatixPlugins",value:function(playerModel,playerContainer){var delegateHandlers=this.getDelegateHandler(),pluginsHandler=new Common_Modules_PluginsHandler_PluginsHandler__WEBPACK_IMPORTED_MODULE_25__.a(this.GLOBAL,this.services.EventsStorageService,delegateHandlers,playerModel,playerContainer);this._isOVPDomain?Common_GlobalServices_AdBlockerDetectionService_AdBlockerDetectionService__WEBPACK_IMPORTED_MODULE_37__.a.isBannerBlocked||Common_GlobalServices_AdBlockerDetectionService_AdBlockerDetectionService__WEBPACK_IMPORTED_MODULE_37__.a.onAdBlockerDetected().subscribe(function(hasAdBlocker){hasAdBlocker||pluginsHandler.start()}):pluginsHandler.start()}},{key:"_initFraudSensor",value:function(macrosService,globalDomUtilsService,appConfig){if(this._fraudSensorConfig){var userId=this.services.UserManagerService.getUserId();this._fraudSensorConfig.deviceIdentifier=appConfig.isInAppAndroid?appConfig.bundleID:appConfig.appId;var fraudSensor=new Common_Modules_FraudSensor_FraudSensor__WEBPACK_IMPORTED_MODULE_34__.a(macrosService,globalDomUtilsService,this._fraudSensorConfig,userId);this._isOVPDomain?Common_GlobalServices_AdBlockerDetectionService_AdBlockerDetectionService__WEBPACK_IMPORTED_MODULE_37__.a.onAdBlockerDetected().subscribe(function(hasAdBlocker){hasAdBlocker||fraudSensor.addFraudSensorScript()}):fraudSensor.addFraudSensorScript()}}},{key:"_setThirdPartySyncUrls",value:function(cookieSyncUrls){var _this11=this;Common_GlobalServices_AdBlockerDetectionService_AdBlockerDetectionService__WEBPACK_IMPORTED_MODULE_37__.a.isBannerBlocked||(this._isOVPDomain?Common_GlobalServices_AdBlockerDetectionService_AdBlockerDetectionService__WEBPACK_IMPORTED_MODULE_37__.a.onAdBlockerDetected().subscribe(function(hasAdBlocker){hasAdBlocker||_this11.services.UserManagerService.setThirdPartySyncUrls(cookieSyncUrls)}):this.services.UserManagerService.setThirdPartySyncUrls(cookieSyncUrls))}},{key:"_initSessionClientWrapper",value:function(){var omidSessionClient=this.GLOBAL.OmidSessionClient&&this.GLOBAL.OmidSessionClient[Common_OMID_Config_OmidConfig__WEBPACK_IMPORTED_MODULE_27__.j];omidSessionClient?this._sessionClientWrapper=new Common_OMID_SessionClientWrapper_SessionClientWrapper__WEBPACK_IMPORTED_MODULE_26__.a(omidSessionClient,this.services.EventsStorageService,this.externalAttributes._appSettings.sdkVersion):Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({message:"OmidSessionClient not found.",level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.FATAL})}},{key:"_addCss",value:function(globalDomUtilsService){var _this12=this;return Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_9__.k)(function(){return new Promise(function(resolve,reject){var scriptData=_this12._getCssScriptData();globalDomUtilsService.addCssStylesheetToHead(scriptData,function(){return resolve()},function(e){return reject(e)})})}).catch(function(e){throw Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({message:"Loader_add_css_link",exception:e,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.INFO}),new Error(e)})}},{key:"updateQueryParams",value:function(){this.queryParams=this._getQueryParams()}},{key:"loadScriptTag",value:function(apiConfig,scriptId){var scriptTag;if(this.externalAttributes=apiConfig,scriptId&&(scriptTag=this.GLOBAL.document.getElementById(scriptId)),!scriptTag)return Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({message:"Loader_no_script_id",exception:"".concat(apiConfig.playerId),level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.WARNING}),this.registerApiError(Common_Config_ApiConfig__WEBPACK_IMPORTED_MODULE_20__.a.SetupError,"Could not locate any script tag ids in the page"),!1;var parseDomain=Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_18__.f)(apiConfig.settings.plugins.adobeAnalyticsSettings);return this._isInAppSDK&&this._initSessionClientWrapper(),this._player={parseDomain:parseDomain,playerId:apiConfig.playerId,tag:scriptTag},!0}},{key:"insertRenderer",value:function(){var _this13=this;try{this._playerReloader=new Common_Modules_Loader_Modules_PlayerReloader_PlayerReloader__WEBPACK_IMPORTED_MODULE_29__.a(this.queryParams.cnxReloadTime),this._toggleIframeVisibility();this._deregisterPlsCall=this.services.UserManagerService.registerPlsCall(function(){try{_this13._doPlayerIdCall().then(function(playerResponse){var promises=[];playerResponse.players.forEach(function(response,index){playerResponse.players[index].limitClientSideApiUse&&_this13._stripDownJsApiConfigForGroupScript();var promise=_this13._getInsertContainer(_this13._player,response).then(function(insertData){_this13._mergeAdSources(response,playerResponse.lineItems);var urlSuffixerService=new Common_Services_UrlSuffixerService_UrlSuffixerService__WEBPACK_IMPORTED_MODULE_38__.a;playerResponse.bandwidthLoggingEnabled&&urlSuffixerService.setQueryParams({playerId:playerResponse.players[index].playerId});var playerModel=_this13.getPlayerModel(insertData,playerResponse,urlSuffixerService,index.toString()),globalDomUtilsService=new Common_Services_GlobalDomUtilsService_GlobalDomUtilsService__WEBPACK_IMPORTED_MODULE_33__.a(playerModel.global);return Object(Common_Services_AdDomainBlockingService_AdDomainBlockingService__WEBPACK_IMPORTED_MODULE_36__.a)(playerModel.lineItemSettings.lineItems),_this13._playerVariantOptions[index]={playerModel:playerModel,globalDomUtilsService:globalDomUtilsService,urlSuffixerService:urlSuffixerService},_this13._addCss(globalDomUtilsService)}).catch(function(e){_this13.registerApiError(Common_Config_ApiConfig__WEBPACK_IMPORTED_MODULE_20__.a.SetupError,"rendering error"),Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({message:"Loader_send_data_to_renderer",exception:e.message,callStack:e.stack,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.FATAL})});promises.push(promise)}),Promise.all(promises).then(function(){return _this13._onPlsResponse(playerResponse)})})}catch(e){Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({message:"Prerender_Loader_do_player_call",callStack:e.stack,exception:e.message,throttle:1e3})}})}catch(e){Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({message:"Prerender_Loader_insert_renderer",exception:e.message,callStack:e.stack,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.FATAL})}}},{key:"findPageUrl",value:function(GLOBAL,ampUrl){var _this14=this,isRetry=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(GLOBAL.cnx_page_url)this.pageUrl=GLOBAL.cnx_page_url;else try{GLOBAL["cnxAmpAd)"]?this.pageUrl=GLOBAL.context.sourceUrl||GLOBAL.context.location.href:this.pageUrl=ampUrl||Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_9__.e)(Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_9__.f)(this.GLOBAL),this.GLOBAL)}catch(e){}if(!this.pageUrl||0===this.pageUrl.length)return isRetry||Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({message:"Prerender_Loader_find_page_url",level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.INFO,throttle:1e3}),new Promise(function(resolve){setTimeout(function(){_this14.findPageUrl(GLOBAL,ampUrl,!0).then(function(){return resolve()})},_this14._FIND_CNX_REF_TIMEOUT)});try{return this.pageUrl=Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_15__.d)(this.pageUrl),Promise.resolve()}catch(e){return Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_8__.a)({message:"Loader_find_page_url",exception:e.message,callStack:e.stack,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.FATAL}),Promise.reject()}}},{key:"registerApiError",value:function(){var type=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Common_Config_ApiConfig__WEBPACK_IMPORTED_MODULE_20__.a.SetupError,message=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this._apiResponses.push({apiErrorObj:{type:type,message:message}})}},{key:"registerApiSuccess",value:function(apiObject){this._apiResponses.push({apiConfigObj:apiObject})}},{key:"destroy",value:function(){this.renderer&&this.renderer.destroy()}}]),Loader}(Common_Modules_Mediator_Mediator__WEBPACK_IMPORTED_MODULE_30__.a)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return MacrosService});var MacrosEnum,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(15),Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5),Common_Utils_ObjectUtils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(45),Common_Config_MonetizationConfig__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(39),Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(4);!function(MacrosEnum){MacrosEnum.AppUrl="APP_URL",MacrosEnum.AppBundle="APP_BUNDLE",MacrosEnum.AppName="APP_NAME",MacrosEnum.Uuid="UUID",MacrosEnum.PageUrl="PAGE_URL",MacrosEnum.AdPosition="AD_POSITION",MacrosEnum.VideoTitle="VIDEO_TITLE",MacrosEnum.MediaTitle="MEDIA_TITLE",MacrosEnum.VideoDuration="VIDEO_DURATION",MacrosEnum.ContentLength="CONTENT_LENGTH",MacrosEnum.VideoDescription="VIDEO_DESCRIPTION",MacrosEnum.VideoUrl="VIDEO_URL",MacrosEnum.VideoId="VIDEO_ID",MacrosEnum.VideoTime="VIDEO_TIME",MacrosEnum.DescriptionUrl="DESCRIPTION_URL",MacrosEnum.VideoKeywords="VIDEO_KEYWORDS",MacrosEnum.Autoplay="AUTOPLAY",MacrosEnum.UserAgent="UA",MacrosEnum.Ip="IP",MacrosEnum.CashBuster="CB",MacrosEnum.Width="WIDTH",MacrosEnum.Height="HEIGHT",MacrosEnum.Domain="DOMAIN",MacrosEnum.SourceReferrer="SOURCE_REFERRER",MacrosEnum.Gdpr="GDPR",MacrosEnum.GdprConsent="GDPR_CONSENT",MacrosEnum.Consent="CONSENT",MacrosEnum.Ctd="CTD",MacrosEnum.Publisher="PUBLISHER",MacrosEnum.Random="RAND",MacrosEnum.Site="SITE",MacrosEnum.SubId="SUB_ID",MacrosEnum.Url="URL",MacrosEnum.UserLat="USER_LAT",MacrosEnum.UserLong="USER_LONG",MacrosEnum.UsPrivacyString="US_PRIVACY",MacrosEnum.DoNotTrack="DNT",MacrosEnum.FraudSensorUserId="FS_USER_ID",MacrosEnum.PublisherId="PUBLISHER_ID",MacrosEnum.SessionId="SESSION_ID",MacrosEnum.FraudSensorDeviceType="FS_DEVICE_TYPE",MacrosEnum.FraudSensorLookupId="MGID",MacrosEnum.FraudSensorLookupResponseCode="MGTO",MacrosEnum.FraudSensorMediaType="FS_MEDIA_TYPE",MacrosEnum.FraudSensorDeviceIdentifier="FS_DEVICE_IDENT",MacrosEnum.CnxSupplierId="CNX_SUPPLIER_ID",MacrosEnum.AdxPublisherNetworkCode="ADX_CPNC"}(MacrosEnum||(MacrosEnum={}));var MacrosService=function(){function MacrosService(playerSettings,geoLocation,pageUrl,pageDomain,appSettings,referrer,adxPublisherNetworkCode){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,MacrosService),this._macros=new Map,this._macroSymbolLeft="[",this._macroSymbolRight="]",this._macros.set(MacrosEnum.Autoplay,playerSettings.playbackMode===Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_2__.ProtoPlayerPlaybackModeEnum.Autoplay),this._macros.set(MacrosEnum.UserAgent,navigator.userAgent),this._macros.set(MacrosEnum.UserLong,geoLocation.lon),this._macros.set(MacrosEnum.UserLat,geoLocation.lat),this._macros.set(MacrosEnum.Ip,geoLocation.ip),this._addAppMacros(appSettings),this._setSourceReferrer(referrer),this._setUrl(pageUrl),this._setDoNotTrackFlag(),this._macros.set(MacrosEnum.Domain,pageDomain),this._macros.set(MacrosEnum.CnxSupplierId,Common_Config_MonetizationConfig__WEBPACK_IMPORTED_MODULE_6__.c),this._macros.set(MacrosEnum.SessionId,playerSettings.sessionId),adxPublisherNetworkCode&&this._macros.set(MacrosEnum.AdxPublisherNetworkCode,",".concat(adxPublisherNetworkCode))}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(MacrosService,[{key:"_addAppMacros",value:function(appSettings){this._macros.set(MacrosEnum.AppBundle,appSettings.bundleID),this._macros.set(MacrosEnum.AppName,appSettings.appName),this._macros.set(MacrosEnum.AppUrl,appSettings.storeURL)}},{key:"_setSourceReferrer",value:function(referrer){this._macros.set(MacrosEnum.SourceReferrer,referrer)}},{key:"_setDoNotTrackFlag",value:function(){var doNotTrackFlag=Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_4__.D)()?1:0;this._macros.set(MacrosEnum.DoNotTrack,doNotTrackFlag)}},{key:"_setUrl",value:function(url){this._macros.set(MacrosEnum.PageUrl,url),this._macros.set(MacrosEnum.Url,url),this._macros.set(MacrosEnum.Publisher,url),this._macros.set(MacrosEnum.Site,url),this._macros.set(MacrosEnum.DescriptionUrl,url)}},{key:"_setCacheBuster",value:function(){var guid=Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_3__.c)();this._macros.set(MacrosEnum.CashBuster,guid),this._macros.set(MacrosEnum.Random,guid),this._macros.set(MacrosEnum.Ctd,guid)}},{key:"_getUrlPath",value:function(url){return url.split("?")[0]}},{key:"_getUrlQuery",value:function(url){return url.split("?").slice(1).join("?")}},{key:"_isMacroString",value:function(value,startSymbol,endSymbol){return 0===value.indexOf(startSymbol)&&value.indexOf(endSymbol,endSymbol.length)===value.length-startSymbol.length}},{key:"_replaceMacros",value:function(url,macros){var urlPath=this._getUrlPath(url),parsedUrlQuery=this._handleMacros(this._getUrlQuery(url),macros),urlQuery=parsedUrlQuery?"?".concat(parsedUrlQuery):"";return"".concat(urlPath).concat(urlQuery)}},{key:"_handleMacros",value:function(url,macros){var _this=this,wasEncoded=arguments.length>2&&void 0!==arguments[2]&&arguments[2],query=url;return query.split("&").forEach(function(elem){var pair=elem.split("=");if(pair[1])if(_this._isMacroString(pair[1],_this._macroSymbolLeft,_this._macroSymbolRight))query=query.replace(pair[1],_this._setMacro(pair[1].toLowerCase(),macros,wasEncoded));else if(decodeURIComponent(pair[1]).split("=").length>1){var newq=_this._handleMacros(decodeURIComponent(pair[1]),macros,!0);query=query.replace(pair[1],encodeURIComponent(newq))}}),query=this._handleAdxPublisherNetworkCodeMacro(query,macros),this._encodeMissingMacros(query)}},{key:"_encodeMissingMacros",value:function(url){return url.indexOf(this._macroSymbolLeft)>-1&&(url=url.cnx_replaceAll(this._macroSymbolLeft,encodeURIComponent(this._macroSymbolLeft))),url.indexOf(this._macroSymbolRight)>-1&&(url=url.cnx_replaceAll(this._macroSymbolRight,encodeURIComponent(this._macroSymbolRight))),url}},{key:"_setMacro",value:function(macro,macros,wasEncoded){var encodeComponent,_this2=this,newUrl=macro;return macros.forEach(function(value,key){for(;newUrl.indexOf(_this2._macroSymbolLeft+key.toLowerCase()+_this2._macroSymbolRight)>-1;)encodeComponent=wasEncoded?value:encodeURIComponent(value),newUrl=newUrl.replace(_this2._macroSymbolLeft+key.toLowerCase()+_this2._macroSymbolRight,encodeComponent)}),newUrl}},{key:"_handleAdxPublisherNetworkCodeMacro",value:function(url,macros){var macro="".concat(this._macroSymbolLeft).concat(MacrosEnum.AdxPublisherNetworkCode).concat(this._macroSymbolRight);return-1===url.indexOf(macro)?url:macros.has(MacrosEnum.AdxPublisherNetworkCode)?url.cnx_replaceAll(macro,macros.get(MacrosEnum.AdxPublisherNetworkCode)):url.cnx_replaceAll(macro,"")}},{key:"setAdWidth",value:function(width){this._macros.set(MacrosEnum.Width,Math.floor(width))}},{key:"setAdHeight",value:function(height){this._macros.set(MacrosEnum.Height,Math.floor(height))}},{key:"setSubId",value:function(subId){this._macros.set(MacrosEnum.SubId,subId)}},{key:"setGDPR",value:function(gdpr){this._macros.set(MacrosEnum.Gdpr,gdpr)}},{key:"setUUID",value:function(deviceId){this._macros.set(MacrosEnum.Uuid,deviceId)}},{key:"setGDPRConsent",value:function(consent){this._macros.set(MacrosEnum.GdprConsent,consent)}},{key:"setConsent",value:function(consent){this._macros.set(MacrosEnum.Consent,consent)}},{key:"setVideoId",value:function(videoId){this._macros.set(MacrosEnum.VideoId,videoId)}},{key:"setVideoTime",value:function(videoTime){this._macros.set(MacrosEnum.VideoTime,Math.floor(videoTime))}},{key:"setVideoUrl",value:function(videoUrl){this._macros.set(MacrosEnum.VideoUrl,videoUrl)}},{key:"setVideoDescription",value:function(videoDescription){this._macros.set(MacrosEnum.VideoDescription,videoDescription)}},{key:"setVideoDuration",value:function(videoDuration){this._macros.set(MacrosEnum.VideoDuration,videoDuration),this._macros.set(MacrosEnum.ContentLength,videoDuration)}},{key:"setVideoTitle",value:function(videoTitle){var videoKeywords;this._macros.set(MacrosEnum.VideoTitle,videoTitle),this._macros.set(MacrosEnum.MediaTitle,videoTitle),videoTitle&&(videoKeywords=videoTitle.split(" ").join(",")),this._macros.set(MacrosEnum.VideoKeywords,videoKeywords)}},{key:"setAdPosition",value:function(){var adPosition=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"midRoll";this._macros.set(MacrosEnum.AdPosition,adPosition)}},{key:"setupMacros",value:function(url){return this._setCacheBuster(),this._replaceMacros(url,this._macros)}},{key:"addExtraMacros",value:function(macros){var _this3=this,macrosEnumValues=Object(Common_Utils_ObjectUtils__WEBPACK_IMPORTED_MODULE_5__.a)(MacrosEnum);Object.keys(macros).filter(function(key){return!macrosEnumValues.includes(key.toUpperCase())}).forEach(function(key){_this3._macros.set(key,macros[key])})}},{key:"getExtraMacros",value:function(){var macrosEnumValues=Object(Common_Utils_ObjectUtils__WEBPACK_IMPORTED_MODULE_5__.a)(MacrosEnum),customMacros={};return this._macros.forEach(function(value,key){macrosEnumValues.includes(key)||null==value||(customMacros[key]=Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_7__.h)(value)?value:JSON.stringify(value))}),customMacros}},{key:"setUsPrivacyString",value:function(usPrivacyString){var sanitizedString=usPrivacyString||"";this._macros.set(MacrosEnum.UsPrivacyString,sanitizedString)}},{key:"setUserId",value:function(userId){this._macros.set(MacrosEnum.FraudSensorUserId,userId)}},{key:"setPublisherId",value:function(publisherId){this._macros.set(MacrosEnum.PublisherId,publisherId)}},{key:"setFraudSensorMacros",value:function(options){this._macros.set(MacrosEnum.FraudSensorDeviceType,options.deviceType),this._macros.set(MacrosEnum.FraudSensorLookupId,options.lookupId),this._macros.set(MacrosEnum.FraudSensorLookupResponseCode,options.lookupResponseCode),this._macros.set(MacrosEnum.FraudSensorMediaType,options.mediaType),this._macros.set(MacrosEnum.FraudSensorDeviceIdentifier,options.deviceIdentifier)}},{key:"destroy",value:function(){}}]),MacrosService}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return AppConfig});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),Common_Config_OsConfig__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(32),Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(15),Common_Config_BrowserConfig__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(34),Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(26),Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4),AppConfig=function(){function AppConfig(_settings){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,AppConfig),this._settings=_settings,this._pageUrlTruncLength=100,this._topWindow=Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_3__.f)(window).topFrame,this._isMobile=Common_Config_OsConfig__WEBPACK_IMPORTED_MODULE_2__.a.indexOf(this._settings.browser.device)>-1,this._appId=Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_3__.d)(),this._browser={browserType:this._getBrowserType(),browserVersion:this._settings.browser.browserVersion},this._os=this._getOSType(),this._pageUrlTrunc=this.pageUrl.substr(0,this._pageUrlTruncLength),this._pageDomain=Object(Common_Utils_HrefUtils__WEBPACK_IMPORTED_MODULE_5__.a)(this._pageUrlTrunc)}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(AppConfig,[{key:"_getBrowserType",value:function(){var browser,_this=this;return Object.keys(Common_Config_BrowserConfig__WEBPACK_IMPORTED_MODULE_4__.a).forEach(function(key){_this._settings.browser.browserType.toLowerCase().indexOf(Common_Config_BrowserConfig__WEBPACK_IMPORTED_MODULE_4__.a[key])>-1&&(browser=Common_Config_BrowserConfig__WEBPACK_IMPORTED_MODULE_4__.a[key])}),browser}},{key:"_getOSType",value:function(){var osCode,osVersion=0,osArray=this._settings.browser.osCode.split("_"),osName=osArray[0].toLowerCase();return Object.keys(Common_Config_OsConfig__WEBPACK_IMPORTED_MODULE_2__.b).forEach(function(key){osName.indexOf(Common_Config_OsConfig__WEBPACK_IMPORTED_MODULE_2__.b[key])>-1&&(osCode=Common_Config_OsConfig__WEBPACK_IMPORTED_MODULE_2__.b[key])}),osArray.length>1&&(osVersion=parseFloat("".concat(osArray[1]||0,".").concat(osArray[2]||0))),{os:osCode,osVersion:osVersion}}},{key:"device",get:function(){return this._settings.browser.device}},{key:"browser",get:function(){return this._browser}},{key:"os",get:function(){return this._os}},{key:"geoLocation",get:function(){return this._settings.geoLocation}},{key:"pageUrl",get:function(){return this._settings.pageUrl||""}},{key:"pageUrlTrunc",get:function(){return this._pageUrlTrunc}},{key:"pageDomain",get:function(){return this._pageDomain}},{key:"isMobile",get:function(){return this._isMobile}},{key:"isInApp",get:function(){return Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_6__.h)(this._settings.bundleID)}},{key:"isInAppAndroid",get:function(){return this.isInApp&&this.os.os===Common_Config_OsConfig__WEBPACK_IMPORTED_MODULE_2__.b.Android}},{key:"playerId",get:function(){return this._settings.playerId}},{key:"appId",get:function(){return this._appId}},{key:"bundleID",get:function(){return this._settings.bundleID}},{key:"iOSAppID",get:function(){return this._settings.appID}},{key:"domainURL",get:function(){return this._settings.domainURL}},{key:"storeURL",get:function(){return this._settings.storeURL}},{key:"explorationMode",get:function(){return this._settings.explorationMode}},{key:"appName",get:function(){return this._settings.appName}},{key:"appCategories",get:function(){return this._settings.appCategories}},{key:"appVersion",get:function(){return this._settings.appVersion}},{key:"appPrivacyPolicy",get:function(){return this._settings.appPrivacyPolicy}},{key:"appIsPaid",get:function(){return this._settings.appIsPaid}},{key:"deviceId",get:function(){return this._settings.deviceId}},{key:"topWindow",get:function(){return this._topWindow}},{key:"isRecyclerViewIntegration",get:function(){return this._settings.isRecyclerViewIntegration}},{key:"appPageURL",get:function(){return this._settings.appPageURL}},{key:"isOVPDomain",get:function(){return this._settings.isOVPDomain}}]),AppConfig}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return EmptyTrackingService});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),EmptyTrackingService=function(){function EmptyTrackingService(){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,EmptyTrackingService)}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(EmptyTrackingService,[{key:"setNewMedia",value:function(){}},{key:"updateMediaMetadata",value:function(){}},{key:"setMediaStart",value:function(){}},{key:"setContentStart",value:function(){}},{key:"setSessionPlayback",value:function(){}},{key:"setSessionViewability",value:function(){}},{key:"trackSessionRendered",value:function(){}},{key:"trackSessionViewability",value:function(){}},{key:"trackMediaQuartile",value:function(){}},{key:"trackMediaClick",value:function(){}},{key:"setAdStart",value:function(){}},{key:"startBidRequests",value:function(){}},{key:"addPrebid",value:function(){}},{key:"addPostBid",value:function(){}},{key:"addBid",value:function(){}},{key:"trackAuctionInfoForBid",value:function(){}},{key:"trackVideoAdImpression",value:function(){}},{key:"trackVideoAdImpressionViewable",value:function(){}},{key:"trackVideoAdQuartile",value:function(){}},{key:"trackAdClick",value:function(){}},{key:"trackAdOpportunity",value:function(){}},{key:"trackSessionAdBlocker",value:function(){}},{key:"getMetadataModel",value:function(){}},{key:"updateMetadataModel",value:function(){}},{key:"setIsConsentPayload",value:function(){}},{key:"destroy",value:function(){}},{key:"publish",value:function(){}},{key:"setImplementationTypeOnMeta",value:function(){}},{key:"addPlatformCappedLineItemSubscriber",value:function(){}},{key:"removePlatformCappedLineItemSubscriber",value:function(){}},{key:"setImpressionRevenueSubscriber",value:function(){}},{key:"unsubscribeToImpressionRevenue",value:function(){}},{key:"trackHeavyAdIntervention",value:function(){}}]),EmptyTrackingService}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return PlayerReloader});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(15),Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(11),Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(0),Common_Config_TimeConfig__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(20),PlayerReloader=function(){function PlayerReloader(customTime){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,PlayerReloader),this.RELOAD_TIME=Common_Config_TimeConfig__WEBPACK_IMPORTED_MODULE_5__.a,this.RELOAD_COOKIES="cnx_player_reload",this.SESSION_IN_VIEW_FLAG="_sessionWasViewed",this._cookiePlayerSessions={},this._cachedPlayerSessions={},this._playersInView={},this._topWindow=Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_2__.f)(window).topFrame,this._startReloadTimeout(customTime);try{this._getReloadCookie()}catch(e){Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_3__.a)({message:"PlayerReloader_cookie_fetch_failed",level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_4__.ProtoLoggingLevelEnum.WARNING,exception:e})}}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(PlayerReloader,[{key:"wasPlayerReloaded",value:function(playerId){return!!this._cookiePlayerSessions[playerId]}},{key:"addPlayerSession",value:function(playerId,sessionId){this._cachedPlayerSessions[playerId]=sessionId}},{key:"getCookiePlayersSession",value:function(){return this._cookiePlayerSessions}},{key:"addSessionInView",value:function(playerId){this._cachedPlayerSessions[playerId]+=this.SESSION_IN_VIEW_FLAG}},{key:"getSessionInView",value:function(playerId){return this._playersInView[playerId]}},{key:"_startReloadTimeout",value:function(customTime){var _this=this;setTimeout(function(){_this._saveReloadCookie(),_this._topWindow.location.reload()},customTime||this.RELOAD_TIME)}},{key:"_getReloadCookie",value:function(){var _this2=this;decodeURIComponent(this._topWindow.document.cookie).split(";").forEach(function(splitCookie){var splitEqual=splitCookie.split("=");splitEqual[0].indexOf(_this2.RELOAD_COOKIES)>-1&&(_this2._cookiePlayerSessions=JSON.parse(splitEqual[1]))}),this._savePlayersInViewAndRemoveFlag(),this._deleteReloadCookies()}},{key:"_savePlayersInViewAndRemoveFlag",value:function(){var _this3=this;Object.keys(this._cookiePlayerSessions).forEach(function(playerId){var indexOfFlag=_this3._cookiePlayerSessions[playerId].indexOf(_this3.SESSION_IN_VIEW_FLAG);indexOfFlag>-1&&(_this3._cookiePlayerSessions[playerId]=_this3._cookiePlayerSessions[playerId].substr(0,indexOfFlag),_this3._playersInView[playerId]=!0)})}},{key:"_deleteReloadCookies",value:function(){this._topWindow.document.cookie="".concat(this.RELOAD_COOKIES,"=; expires = Thu, 01 Jan 1970 00:00:00 GMT; path=/")}},{key:"_saveReloadCookie",value:function(){var _this4=this;Object.keys(this._playersInView).forEach(function(playerId){-1===_this4._cachedPlayerSessions[playerId].indexOf(_this4.SESSION_IN_VIEW_FLAG)&&_this4.addSessionInView(playerId)});var now=new Date,time=now.getTime();time+=Common_Config_TimeConfig__WEBPACK_IMPORTED_MODULE_5__.g*Common_Config_TimeConfig__WEBPACK_IMPORTED_MODULE_5__.f,now.setTime(time),this._topWindow.document.cookie="".concat(this.RELOAD_COOKIES,"=").concat(JSON.stringify(this._cachedPlayerSessions),"; expires=").concat(now.toUTCString(),"; path=/")}}]),PlayerReloader}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return GlobalDomUtilsService});var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1__),Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(15),Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(5),Common_Services_EndPointsService_EndPointResolver__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(22),Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(13),Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(11),Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(0),Common_AdaptiveStreamingGenerated_Hls_hls__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(24),Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(4),GlobalDomUtilsService=function(){function GlobalDomUtilsService(GLOBAL){var _this=this;_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_0___default()(this,GlobalDomUtilsService),this.createElement=function(tagName){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:_this._global).document.createElement(tagName)},this._global=GLOBAL,this.addPreconnect()}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_1___default()(GlobalDomUtilsService,[{key:"initHls",value:function(config){return config.cnxRenderWindow=this._global,new Common_AdaptiveStreamingGenerated_Hls_hls__WEBPACK_IMPORTED_MODULE_8__(config)}},{key:"addCssString",value:function(cssText){var id=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.b)(cssText,id,this._global)}},{key:"addPreconnect",value:function(){Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.c)(Common_Services_EndPointsService_EndPointResolver__WEBPACK_IMPORTED_MODULE_4__.a.endPoints.base.video,this._global),Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.c)(Common_Services_EndPointsService_EndPointResolver__WEBPACK_IMPORTED_MODULE_4__.a.endPoints.base.core,this._global),Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.c)(Common_Services_EndPointsService_EndPointResolver__WEBPACK_IMPORTED_MODULE_4__.a.endPoints.base.image,this._global)}},{key:"getLineHeightPropertyValue",value:function(elem){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.l)(elem,this._global).getPropertyValue("line-height")}},{key:"getFontSizePropertyValue",value:function(elem){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.l)(elem,this._global).getPropertyValue("font-size")}},{key:"getFontWeightPropertyValue",value:function(elem){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.l)(elem,this._global).getPropertyValue("font-weight")}},{key:"getTransformPropertyValue",value:function(elem){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.l)(elem,this._global).getPropertyValue("transform")}},{key:"getPaddingTopPropertyValue",value:function(elem){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.l)(elem,this._global).getPropertyValue("padding-top")}},{key:"getPaddingBottomPropertyValue",value:function(elem){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.l)(elem,this._global).getPropertyValue("padding-bottom")}},{key:"getMarginTopPropertyValue",value:function(elem){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.l)(elem,this._global).getPropertyValue("margin-top")}},{key:"getMarginBottomPropertyValue",value:function(elem){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.l)(elem,this._global).getPropertyValue("margin-bottom")}},{key:"getMarginLeftPropertyValue",value:function(elem){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.l)(elem,this._global).getPropertyValue("margin-left")}},{key:"getMarginRightPropertyValue",value:function(elem){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.l)(elem,this._global).getPropertyValue("margin-right")}},{key:"createElementByString",value:function(htmlString){var GLOBAL=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._global;return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.f)(htmlString,GLOBAL)}},{key:"createDocumentFragment",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._global).document.createDocumentFragment()}},{key:"isHttpsProtocolUsed",value:function(){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.F)(this._global)}},{key:"isURLSameDomainToTop",value:function(url){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.G)(url,this._global)}},{key:"isDetachedFromDOM",value:function(element){for(var currentElement=element;currentElement.parentNode;)if((currentElement=currentElement.parentNode)===this._global.document.body)return!1;return!0}},{key:"querySelector",value:function(selectors){var selectedElements,GLOBAL=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._global;try{selectedElements=GLOBAL.document.querySelector(selectors)}catch(e){}return selectedElements}},{key:"addCssStylesheetToHead",value:function(scriptData,onLoad,onError){var _document=this._global.document;_document.getElementById(scriptData.id)?Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_9__.b)(onLoad)&&onLoad():Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.B)(scriptData,_document.head,this._global,onLoad,onError)}},{key:"getFullscreenKeys",value:function(element){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.o)(element||this._global.document)}},{key:"exitFullscreen",value:function(key,element){(element||this._global.document)[key]()}},{key:"getDocumentProperty",value:function(key){return this._global.document[key]}},{key:"addEventListenerOnGlobal",value:function(type,listener,onDocument){var useCapture=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(onDocument?this._global.document:this._global).addEventListener(type,listener,useCapture)}},{key:"removeEventListenerOnGlobal",value:function(type,listener,onDocument){var useCapture=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(onDocument?this._global.document:this._global).removeEventListener(type,listener,useCapture)}},{key:"trackWithImages",value:function(requestUrls,requestData){Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_2__.m)(requestUrls,this._global,requestData)}},{key:"getElementCoordinates",value:function($element){var _$element$getBounding=$element.getBoundingClientRect(),clientY=_$element$getBounding.top,clientX=_$element$getBounding.left,_$element$getBounding2=$element.getBoundingClientRect(),width=_$element$getBounding2.width,height=_$element$getBounding2.height,scrollTop=this._global.pageYOffset;return{clientX:clientX+=this._global.pageXOffset,clientY:clientY+=scrollTop,width:width,height:height}}},{key:"requestAnimationFrameHelper",value:function(callback){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.P)(this._global,callback)}},{key:"cancelRequestAnimationFrame",value:function(handle){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.e)(this._global,handle)}},{key:"getGlobalLocationProperties",value:function(){var location=this._global.location;return{hostname:location.hostname,pathname:location.pathname,href:location.href,protocol:location.protocol,host:location.host,port:location.port,search:location.search,hash:location.hash}}},{key:"open",value:function(url,target){this._global.open(url,target)}},{key:"getComputedTranslateX",value:function($element){var translatedX=0,matrix=Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.l)($element,this._global).getPropertyValue("transform").match(/^matrix\((.+)\)$/);return Object(Common_Utils_ArrayUtils__WEBPACK_IMPORTED_MODULE_5__.h)(matrix)&&(translatedX=parseFloat(matrix[1].split(", ")[4])),translatedX}},{key:"getBodyDimensions",value:function(){try{var topBody=Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_2__.f)(this._global).topFrame.document.body,width=topBody.offsetWidth,height=topBody.offsetHeight,bodyStyle=Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.l)(topBody,this._global);return{width:width+=parseInt(bodyStyle.marginLeft,10)+parseInt(bodyStyle.marginRight,10),height:height+=parseInt(bodyStyle.marginTop,10)+parseInt(bodyStyle.marginBottom,10)}}catch(e){return Object(Common_Utils_Logging__WEBPACK_IMPORTED_MODULE_6__.a)({message:"DomUtils_error_getting_body_dimensions",exception:e.message,callStack:e.stack,level:Common_ProtoModels_Generated_protos__WEBPACK_IMPORTED_MODULE_7__.ProtoLoggingLevelEnum.FATAL}),{width:0,height:0}}}},{key:"getViewportWidth",value:function(){return Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_2__.f)(this._global).topFrame.innerWidth}},{key:"getViewportHeight",value:function(){return Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_2__.f)(this._global).topFrame.innerHeight}},{key:"getGlobalClosestTop",value:function(){return Object(Common_Utils_GeneralUtils__WEBPACK_IMPORTED_MODULE_2__.f)(this._global)}},{key:"stripHtmlTags",value:function(text){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.T)(text,this._global)}},{key:"getComputedStyle",value:function($element,pseudoElt){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.l)($element,this._global,pseudoElt)}},{key:"getElementById",value:function(elementId){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.m)(elementId,this._global)}},{key:"getElementsByClassName",value:function(className){return Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.n)(className,this._global)}},{key:"insertScript",value:function(scriptData,onLoad,loggingMessage){this._global.document.getElementById(scriptData.id)?Object(Common_Utils_TypeUtils__WEBPACK_IMPORTED_MODULE_9__.b)(onLoad)&&onLoad():Object(Common_Utils_DomUtils__WEBPACK_IMPORTED_MODULE_3__.A)(scriptData,this._global.document.head,this._global,onLoad,null,!0,loggingMessage)}},{key:"destroy",value:function(){}}]),GlobalDomUtilsService}()},function(module,exports,__webpack_require__){var arrayWithHoles=__webpack_require__(301),iterableToArrayLimit=__webpack_require__(302),nonIterableRest=__webpack_require__(303);module.exports=function(arr,i){return arrayWithHoles(arr)||iterableToArrayLimit(arr,i)||nonIterableRest()}},function(module,exports){module.exports='<cnx class="cnx-tooltip-holder cnx-color-tt-bg"> <cnx class="cnx-tooltip-text cnx-color-tt-text">TEST</cnx> </cnx> '},function(module,exports){module.exports='<cnx class="cnx-up-next-container cnx-hide-on-single-video"> <cnx class=cnx-up-next-box> <cnx class=cnx-up-next-box-image> <img/> </cnx> <cnx class=cnx-up-next-box-gradient></cnx> <cnx class=cnx-up-next-box-text></cnx> <cnx class=cnx-up-next-box-button> <cnx class=cnx-up-next-box-button-text>NEXT</cnx> </cnx> </cnx> </cnx> '},function(module,exports){module.exports='<cnx class="cnx-ui-cm cnx-ui-cm-context"> <cnx class=cnx-cm-container></cnx> </cnx> '},function(module,exports){module.exports='<cnx class="cnx-ui-cm cnx-ui-cm-settings"> <cnx class=cnx-cm-container></cnx> </cnx> '},function(module,exports){module.exports="<cnx class=cnx-captions> <cnx class=cnx-captions-container> <cnx-span class=cnx-captions-text-holder></cnx-span> </cnx> </cnx> "},function(module,exports){module.exports='<svg class="cnx-color-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 4v16l16-8z" fill-rule="evenodd"></path></svg>'},function(module,exports){module.exports='<svg class="cnx-color-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 21H3V3h6v18zm12 0h-6V3h6v18z" fill-rule="evenodd"></path></svg>'},function(module,exports){module.exports='<cnx class=cnx-progress-bar> <cnx class=cnx-progress-rail-container> <cnx class=cnx-progress-rail></cnx> <cnx class="cnx-progress-fill cnx-color-icon"></cnx> </cnx> <cnx class="cnx-progress-handle cnx-color-icon"></cnx> </cnx> '},function(module,exports){module.exports='<cnx class="cnx-icon-button cnx-ui-btn-hoverable"> <cnx class=cnx-btn-container> <cnx class=cnx-expand-icon> <svg markup-inline class=cnx-color-icon xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><path d="M4.6 3H10v2H5v5H3V4.6A1.58 1.58 0 0 1 4.6 3zM5 14v5h5v2H4.6A1.58 1.58 0 0 1 3 19.4V14h2zM19.4 3A1.58 1.58 0 0 1 21 4.6V10h-2V5h-5V3h5.4zM19 14h2v5.4a1.58 1.58 0 0 1-1.6 1.6H14v-2h5v-5z" fill-rule=evenodd /></svg> </cnx> <cnx class=cnx-collapse-icon> <svg markup-inline class=cnx-color-icon xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24" fill-rule=evenodd><path d="M16.6 15a1.58 1.58 0 0 0-1.6 1.6V22h2v-5h5v-2h-5.4zM17 2h-2v5.4A1.58 1.58 0 0 0 16.6 9H22V7h-5V2zM7.4 15A1.58 1.58 0 0 1 9 16.6V22H7v-5H2v-2h5.4zM7 2h2v5.4A1.58 1.58 0 0 1 7.4 9H2V7h5V2z"/></svg> </cnx> </cnx> </cnx> '},function(module,exports){module.exports='<cnx class="cnx-ui-cm cnx-ui-cm-quality"> <cnx class=cnx-cm-container></cnx> </cnx> '},function(module,exports){module.exports='<svg viewBox="0 0 22 22" class="cnx-color-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M18 5.4L16.6 4 11 9.6 5.4 4 4 5.4 9.6 11 4 16.6 5.4 18l5.6-5.6 5.6 5.6 1.4-1.4-5.6-5.6z"></path></svg>'},function(module,exports){module.exports='<svg class="cnx-color-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 22 22"><path d="M11 7c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg>'},function(module,exports){module.exports='<cnx class="cnx-ad-skip-button cnx-ui-btn"> <cnx class=cnx-icon-button> <cnx class=cnx-skip-ad-text> Skip <cnx-span></cnx-span> </cnx> <cnx class=cnx-skip-ad-icon> <svg markup-inline viewBox="0 0 24 24" class=cnx-color-icon xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><path d="M18 21h3V3h-3v18zM3 21l14-9L3 3v18z" fill-rule=evenodd /></svg> </cnx> </cnx> <cnx class=cnx-timer-loader> <svg markup-inline xmlns=http://www.w3.org/2000/svg width=36 height=36 viewBox="0 0 36 36"><circle class=cnx-svg-circle-stroke cx=18 cy=18 r=17 /></svg> </cnx> </cnx> '},function(module,exports){module.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="2 2 20 20"><path d="M14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3m-2 16H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7h-2v7z"></path></svg>'},function(module,exports){module.exports='<cnx class=cnx-pod-loading-screen-container> <img alt="Loading Pods" class=cnx-pod-loading-background /> <cnx class=cnx-pod-loading-info> <cnx class=cnx-pod-open-new-icon> </cnx> <cnx class=cnx-pod-visit-website-text> <cnx-span>Visit Advertiser website</cnx-span> </cnx> <cnx class=cnx-pod-read-more-container> <cnx-span class=cnx-pod-read-more-btn>GO TO PAGE</cnx-span> </cnx> </cnx> <cnx class=cnx-pod-loading-fallback> <cnx class=cnx-pod-loading-spinner></cnx> <cnx-span class=cnx-pod-slot-count-text></cnx-span> </cnx> </cnx>'},function(module,exports){module.exports='<svg class="cnx-color-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 3H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM1 18v3h3c0-1.66-1.34-3-3-3zm0-4v2c2.76 0 5 2.24 5 5h2c0-3.87-3.13-7-7-7zm0-4v2c4.97 0 9 4.03 9 9h2c0-6.08-4.93-11-11-11z" fill-rule="evenodd"></path></svg>'},function(module,exports){module.exports='<svg class="cnx-color-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.9 12.7c.05-.23.1-.46.1-.7s-.04-.47-.1-.7l7.05-4.1c.54.5 1.25.8 2.04.8 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.1.7L8.04 9.8C7.5 9.3 6.8 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.8 0 1.5-.3 2.04-.8l7.12 4.16a2.82 2.82 0 0 0-.08.65c0 1.6 1.3 2.92 2.92 2.92s2.92-1.3 2.92-2.92-1.3-2.92-2.92-2.92z" fill-rule="evenodd"></path></svg>'},function(module,exports){module.exports='<cnx class=cnx-icon-button> <cnx class=cnx-btn-container> <cnx class=cnx-unmute-icon> <svg markup-inline class=cnx-color-icon xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><path d="M0 7.913v7.913h4.946l5.935 5.045V1.978L4.946 7.913zm16.815 3.957c.03-2.078-1.12-3.994-2.967-4.946v9.9c1.847-.952 2.997-2.867 2.967-4.945zM13.848 0v2.077a10.39 10.39 0 0 1 0 19.585v2.077a12.05 12.05 0 0 0 8.9-11.87A12.05 12.05 0 0 0 13.848 0z"/></svg> </cnx> <cnx class=cnx-mute-icon> <svg markup-inline class=cnx-color-icon xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><path d="M11 2L8.25 4.25 11 7zM0 7v9h5l6 5v-6.5L3.85 7zm17 4.5c0-1.965-1.2-3.735-3-4.5v3l2.8 2.8a3.73 3.73 0 0 0 .2-1.3zm3.4 7.45l-1.85-1.85-2.65-2.6-1.9-1.95-3-3-4.15-4.1-4.95-5L1.45 0 0 1.45 17.15 18.6 19 20.4l3.55 3.6L24 22.55zM14 23a11.83 11.83 0 0 0 3.65-1.55l-1.25-1.3c-.747.498-1.553.902-2.4 1.2V23zm9-11.5A11.77 11.77 0 0 0 14 0v1.6A10.53 10.53 0 0 1 20 16l1.45 1.45A11.99 11.99 0 0 0 23 11.5z"/></svg> </cnx> </cnx> </cnx> '},function(module,exports){module.exports='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="nonzero"><path d="M22 15.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13z" fill="#FFF"></path><path d="M22 18a4 4 0 110 8 4 4 0 010-8z" fill="#FF4047"></path><path d="M37.598 7.541c7.955 7.972 8.036 20.846.243 28.918l-.243.248-1.77-1.765c6.985-7 7.062-18.302.233-25.397l-.233-.238 1.77-1.766zm-4.722 5.225c4.34 4.926 4.415 12.803.224 17.831l-.224.262L31 29.206c3.515-3.989 3.583-10.465.203-14.55L31 14.42l1.876-1.653z" fill="#FFF"></path><path d="M6.598 7.541c7.955 7.972 8.036 20.846.243 28.918l-.243.248-1.77-1.765c6.985-7 7.062-18.302.233-25.397l-.233-.238 1.77-1.766zm-4.722 5.225c4.34 4.926 4.415 12.803.224 17.831l-.224.262L0 29.206c3.515-3.989 3.583-10.465.203-14.55L0 14.42l1.876-1.653z" fill="#FFF" transform="matrix(-1 0 0 1 12.626 0)"></path></g></svg>'},function(module,exports){module.exports='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><g fill="#FFF" fill-rule="evenodd"><rect class="cnx-live-icon-svg-rectangle" transform="rotate(90 22.06 21.43)" x="20.059" y="15.929"></rect><path d="M37.598 7.541c7.955 7.972 8.036 20.846.243 28.918l-.243.248-1.77-1.765c6.985-7 7.062-18.302.233-25.397l-.233-.238 1.77-1.766zm-4.722 5.225c4.34 4.926 4.415 12.803.224 17.831l-.224.262L31 29.206c3.515-3.989 3.583-10.465.203-14.55L31 14.42l1.876-1.653z" fill-rule="nonzero" opacity=".5"></path><path d="M6.598 7.541c7.955 7.972 8.036 20.846.243 28.918l-.243.248-1.77-1.765c6.985-7 7.062-18.302.233-25.397l-.233-.238 1.77-1.766zm-4.722 5.225c4.34 4.926 4.415 12.803.224 17.831l-.224.262L0 29.206c3.515-3.989 3.583-10.465.203-14.55L0 14.42l1.876-1.653z" fill-rule="nonzero" opacity=".5" transform="matrix(-1 0 0 1 12.626 0)"></path></g></svg>'},function(module,exports){module.exports='<cnx class="cnx-live-poster cnx-mod-active"> <cnx class=cnx-live-broadcast> <cnx class=cnx-live-icon> <svg class=cnx-live-icon-starting markup-inline viewBox="0 0 44 44" xmlns=http://www.w3.org/2000/svg><g fill=none fill-rule=nonzero><path d="M22 15.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13z" fill=#FFF /><path d="M22 18a4 4 0 110 8 4 4 0 010-8z" fill=#FF4047 /><path d="M37.598 7.541c7.955 7.972 8.036 20.846.243 28.918l-.243.248-1.77-1.765c6.985-7 7.062-18.302.233-25.397l-.233-.238 1.77-1.766zm-4.722 5.225c4.34 4.926 4.415 12.803.224 17.831l-.224.262L31 29.206c3.515-3.989 3.583-10.465.203-14.55L31 14.42l1.876-1.653z" fill=#FFF /><path d="M6.598 7.541c7.955 7.972 8.036 20.846.243 28.918l-.243.248-1.77-1.765c6.985-7 7.062-18.302.233-25.397l-.233-.238 1.77-1.766zm-4.722 5.225c4.34 4.926 4.415 12.803.224 17.831l-.224.262L0 29.206c3.515-3.989 3.583-10.465.203-14.55L0 14.42l1.876-1.653z" fill=#FFF transform="matrix(-1 0 0 1 12.626 0)"/></g></svg> <svg class=cnx-live-icon-ended markup-inline viewBox="0 0 44 44" xmlns=http://www.w3.org/2000/svg><g fill=#FFF fill-rule=evenodd><rect class=cnx-live-icon-svg-rectangle transform="rotate(90 22.06 21.43)" x=20.059 y=15.929 /><path d="M37.598 7.541c7.955 7.972 8.036 20.846.243 28.918l-.243.248-1.77-1.765c6.985-7 7.062-18.302.233-25.397l-.233-.238 1.77-1.766zm-4.722 5.225c4.34 4.926 4.415 12.803.224 17.831l-.224.262L31 29.206c3.515-3.989 3.583-10.465.203-14.55L31 14.42l1.876-1.653z" fill-rule=nonzero opacity=.5 /><path d="M6.598 7.541c7.955 7.972 8.036 20.846.243 28.918l-.243.248-1.77-1.765c6.985-7 7.062-18.302.233-25.397l-.233-.238 1.77-1.766zm-4.722 5.225c4.34 4.926 4.415 12.803.224 17.831l-.224.262L0 29.206c3.515-3.989 3.583-10.465.203-14.55L0 14.42l1.876-1.653z" fill-rule=nonzero opacity=.5 transform="matrix(-1 0 0 1 12.626 0)"/></g></svg> </cnx> <cnx class=cnx-live-message> <cnx-span></cnx-span> </cnx> </cnx> </cnx> '},function(module,exports){module.exports='<cnx class="cnx-ui-live-badge-wrapper cnx-d-md-none"> <cnx class=cnx-ui-live-badge> <svg markup-inline xmlns=http://www.w3.org/2000/svg viewBox="0 0 37 9" fill-rule=nonzero><path d="M15.223 9V7.816H11.35V.47H9.868V9h5.356zm3.7 0V.47h-1.477V9h1.477zm6.555 0L28.55.47h-1.63l-2.168 6.674L22.608.47h-1.623L24.043 9h1.436zm10.6 0V7.816h-4.096V5.2h3.504V4.02h-3.504V1.664h4.055V.47H30.5V9h5.578zM3 2a3 3 0 1 0 0 6 3 3 0 1 0 0-6z" fill=#fff /><path d="M3 3a2 2 0 1 1 0 4 2 2 0 1 1 0-4z" fill=#ff4047 /></svg> </cnx> </cnx> '},function(module,exports){module.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 22"><path d="M26,22H0V0H31.93L32,16A6,6,0,0,1,26,22Z" style="fill:#ffc800;fill-rule:evenodd"></path><path d="M12,5.29h0L16.45,16.7H14.83l-1.06-2.85H8.86l-1,2.85H6.21L10.6,5.31h0Zm5.89,11.42V5.29h3.63A5.52,5.52,0,0,1,26.65,11a5.33,5.33,0,0,1-4.93,5.7H17.89Zm1.46-1.36h2.17c1.77,0,3.7-1.49,3.7-4.35s-1.93-4.28-3.7-4.28H19.35Zm-8-8.16-2,5.24h3.86Z" style="fill-rule:evenodd"></path></svg>'},function(module,exports){module.exports='<cnx class=cnx-progress-bar> <cnx class=cnx-progress-rail-container> <cnx class=cnx-progress-rail></cnx> <cnx class="cnx-progress-fill cnx-color-accent"></cnx> <cnx class=cnx-progress-follow></cnx> </cnx> <cnx class=cnx-progress-hitarea></cnx> </cnx> '},function(module,exports){module.exports="<cnx class=cnx-slides-progress-bar> </cnx> "},function(module,exports){module.exports='<svg class="cnx-color-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill-rule="evenodd"><path d="M16.6 15a1.58 1.58 0 0 0-1.6 1.6V22h2v-5h5v-2h-5.4zM17 2h-2v5.4A1.58 1.58 0 0 0 16.6 9H22V7h-5V2zM7.4 15A1.58 1.58 0 0 1 9 16.6V22H7v-5H2v-2h5.4zM7 2h2v5.4A1.58 1.58 0 0 1 7.4 9H2V7h5V2z"></path></svg>'},function(module,exports){module.exports='<cnx class="cnx-ui-cm cnx-ui-cm-settings"> <cnx class=cnx-cm-container></cnx> </cnx> '},function(module,exports){module.exports='<cnx class="cnx-icon-button cnx-ui-btn-hoverable"> <cnx class=cnx-btn-container> <cnx class=cnx-unmute-icon> <svg markup-inline class=cnx-color-icon xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><path d="M0 7.913v7.913h4.946l5.935 5.045V1.978L4.946 7.913zm16.815 3.957c.03-2.078-1.12-3.994-2.967-4.946v9.9c1.847-.952 2.997-2.867 2.967-4.945zM13.848 0v2.077a10.39 10.39 0 0 1 0 19.585v2.077a12.05 12.05 0 0 0 8.9-11.87A12.05 12.05 0 0 0 13.848 0z"/></svg> </cnx> <cnx class=cnx-mute-icon> <svg markup-inline class=cnx-color-icon xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><path d="M11 2L8.25 4.25 11 7zM0 7v9h5l6 5v-6.5L3.85 7zm17 4.5c0-1.965-1.2-3.735-3-4.5v3l2.8 2.8a3.73 3.73 0 0 0 .2-1.3zm3.4 7.45l-1.85-1.85-2.65-2.6-1.9-1.95-3-3-4.15-4.1-4.95-5L1.45 0 0 1.45 17.15 18.6 19 20.4l3.55 3.6L24 22.55zM14 23a11.83 11.83 0 0 0 3.65-1.55l-1.25-1.3c-.747.498-1.553.902-2.4 1.2V23zm9-11.5A11.77 11.77 0 0 0 14 0v1.6A10.53 10.53 0 0 1 20 16l1.45 1.45A11.99 11.99 0 0 0 23 11.5z"/></svg> </cnx> </cnx> </cnx> '},function(module,exports){module.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M14.2,0A5.8,5.8,0,0,1,20,5.8v8.4A5.8,5.8,0,0,1,14.2,20H5.8A5.8,5.8,0,0,1,0,14.2V5.8A5.8,5.8,0,0,1,5.8,0ZM2,5.6v8.8A3.59,3.59,0,0,0,5.6,18h8.8A3.59,3.59,0,0,0,18,14.4V5.6A3.59,3.59,0,0,0,14.4,2H5.6A3.59,3.59,0,0,0,2,5.6Zm14.5-.8a1.3,1.3,0,1,1-1.3-1.3A1.32,1.32,0,0,1,16.5,4.8ZM15,10a5,5,0,1,1-5-5A5,5,0,0,1,15,10ZM10,7a3,3,0,0,0-3,3,3,3,0,0,0,3,3,3,3,0,0,0,3-3A3,3,0,0,0,10,7Z"></path></svg>'},function(module,exports){module.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 12"><polygon points="0 5 16.17 5 12.59 1.41 14 0 20 6 14 12 12.59 10.59 16.17 7 0 7 0 5"></polygon></svg>'},function(module,exports){module.exports='<cnx class=cnx-ui-click-to-play-btn> <cnx class=cnx-ui-click-to-play-btn-content> <svg markup-inline class="cnx-click-to-play-btn-icon cnx-color-accent" class=cnx-color-icon xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><polygon points="5 1 5 23 23 11.9165764"></polygon></svg> <cnx class=cnx-onion-ring></cnx> <cnx-span class=cnx-click-to-play-btn-text>PLAY</cnx-span> </cnx> </cnx> '},function(module,exports){module.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11 11"><path d="M5.55,9.4h0C2.85,6.8,1.15,5,1.15,3.3a2,2,0,0,1,1.9-2.1,2.28,2.28,0,0,1,2,1.4h1a2.17,2.17,0,0,1,2-1.4A2,2,0,0,1,10,3.3c0,1.7-1.8,3.4-4.4,6.1ZM8,0a3.34,3.34,0,0,0-2.5,1.2A3.13,3.13,0,0,0,3.05,0a3.09,3.09,0,0,0-3,3.3c0,2.3,1.9,4.1,4.7,6.9l.8.8.8-.8c2.8-2.8,4.7-4.7,4.7-6.9A3.16,3.16,0,0,0,8,0Z" style="fill:#a0a0a0;opacity:0.8598999977111816"></path></svg>'},function(module,exports){module.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11 11"><path style="opacity:0.8598999977111816;fill:#a0a0a0" d="M3.85,11a.58.58,0,0,1-.6-.6V8.8H1.05A1.11,1.11,0,0,1,0,7.7V1.1A1.11,1.11,0,0,1,1.05,0h8.8A1.11,1.11,0,0,1,11,1.1V7.7a1.11,1.11,0,0,1-1.1,1.1H6.45l-2,2a.52.52,0,0,1-.4.2h-.2m.6-3.3V9.4l1.7-1.7H10V1.1H1.15V7.7h3.3M2.25,2.8h6.6V3.9H2.25V2.8m0,2.1h4.9V6H2.25Z"></path></svg>'},function(module,exports){module.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12"><path style="opacity:0.8598999977111816;fill:#a0a0a0" d="M6.05,11a5,5,0,0,0,5-5,5,5,0,0,0-5-5,5,5,0,0,0-5,5,5,5,0,0,0,5,5m0-11a5.6,5.6,0,0,1,4.2,1.8A6.37,6.37,0,0,1,12.05,6a6,6,0,0,1-12,0,6,6,0,0,1,6-6m0,3V5.9l3,1.5-.5.6L5.05,6.3V3Z"></path></svg>'},function(module,exports){module.exports=" <cnx class=cnx-button-text-label>1 min. story</cnx> "},function(module,exports){module.exports='<cnx class="cnx-ui-ps-image-container cnx-ui-ps-image-background"> </cnx>'},function(module,exports){module.exports="<cnx class=cnx-ui-ps-video-container></cnx> "},function(module,__webpack_exports__,__webpack_require__){"use strict";var ResizeObserverBoxOptions,classCallCheck=__webpack_require__(1),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(2),createClass_default=__webpack_require__.n(createClass),Logging=__webpack_require__(11),protos=__webpack_require__(0),DomUtils=__webpack_require__(5),resizeObservers=[],msg="ResizeObserver loop completed with undelivered notifications.";!function(ResizeObserverBoxOptions){ResizeObserverBoxOptions.BORDER_BOX="border-box",ResizeObserverBoxOptions.CONTENT_BOX="content-box",ResizeObserverBoxOptions.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(ResizeObserverBoxOptions||(ResizeObserverBoxOptions={}));var trigger,DOMRectReadOnly=function(){function DOMRectReadOnly(x,y,width,height){return this.x=x,this.y=y,this.width=width,this.height=height,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Object.freeze(this)}return DOMRectReadOnly.prototype.toJSON=function(){var _a=this;return{x:_a.x,y:_a.y,top:_a.top,right:_a.right,bottom:_a.bottom,left:_a.left,width:_a.width,height:_a.height}},DOMRectReadOnly.fromRect=function(rectangle){return new DOMRectReadOnly(rectangle.x,rectangle.y,rectangle.width,rectangle.height)},DOMRectReadOnly}(),isSVG=function(target){return target instanceof SVGElement&&"getBBox"in target},isHidden=function(target){if(isSVG(target)){var _a=target.getBBox(),width=_a.width,height=_a.height;return!width&&!height}var _b=target,offsetWidth=_b.offsetWidth,offsetHeight=_b.offsetHeight;return!(offsetWidth||offsetHeight||target.getClientRects().length)},isElement=function(obj){var _a,_b,scope=null===(_b=null===(_a=obj)||void 0===_a?void 0:_a.ownerDocument)||void 0===_b?void 0:_b.defaultView;return!!(scope&&obj instanceof scope.Element)},global="undefined"!=typeof window?window:{},cache=new WeakMap,scrollRegexp=/auto|scroll/,verticalRegexp=/^tb|vertical/,IE=/msie|trident/i.test(global.navigator&&global.navigator.userAgent),parseDimension=function(pixel){return parseFloat(pixel||"0")},calculateBoxSize_size=function(inlineSize,blockSize,switchSizes){return void 0===inlineSize&&(inlineSize=0),void 0===blockSize&&(blockSize=0),void 0===switchSizes&&(switchSizes=!1),Object.freeze({inlineSize:(switchSizes?blockSize:inlineSize)||0,blockSize:(switchSizes?inlineSize:blockSize)||0})},zeroBoxes=Object.freeze({devicePixelContentBoxSize:calculateBoxSize_size(),borderBoxSize:calculateBoxSize_size(),contentBoxSize:calculateBoxSize_size(),contentRect:new DOMRectReadOnly(0,0,0,0)}),calculateBoxSizes=function(target,forceRecalculation){if(void 0===forceRecalculation&&(forceRecalculation=!1),cache.has(target)&&!forceRecalculation)return cache.get(target);if(isHidden(target))return cache.set(target,zeroBoxes),zeroBoxes;var cs=getComputedStyle(target),svg=isSVG(target)&&target.ownerSVGElement&&target.getBBox(),removePadding=!IE&&"border-box"===cs.boxSizing,switchSizes=verticalRegexp.test(cs.writingMode||""),canScrollVertically=!svg&&scrollRegexp.test(cs.overflowY||""),canScrollHorizontally=!svg&&scrollRegexp.test(cs.overflowX||""),paddingTop=svg?0:parseDimension(cs.paddingTop),paddingRight=svg?0:parseDimension(cs.paddingRight),paddingBottom=svg?0:parseDimension(cs.paddingBottom),paddingLeft=svg?0:parseDimension(cs.paddingLeft),borderTop=svg?0:parseDimension(cs.borderTopWidth),borderRight=svg?0:parseDimension(cs.borderRightWidth),borderBottom=svg?0:parseDimension(cs.borderBottomWidth),horizontalPadding=paddingLeft+paddingRight,verticalPadding=paddingTop+paddingBottom,horizontalBorderArea=(svg?0:parseDimension(cs.borderLeftWidth))+borderRight,verticalBorderArea=borderTop+borderBottom,horizontalScrollbarThickness=canScrollHorizontally?target.offsetHeight-verticalBorderArea-target.clientHeight:0,verticalScrollbarThickness=canScrollVertically?target.offsetWidth-horizontalBorderArea-target.clientWidth:0,widthReduction=removePadding?horizontalPadding+horizontalBorderArea:0,heightReduction=removePadding?verticalPadding+verticalBorderArea:0,contentWidth=svg?svg.width:parseDimension(cs.width)-widthReduction-verticalScrollbarThickness,contentHeight=svg?svg.height:parseDimension(cs.height)-heightReduction-horizontalScrollbarThickness,borderBoxWidth=contentWidth+horizontalPadding+verticalScrollbarThickness+horizontalBorderArea,borderBoxHeight=contentHeight+verticalPadding+horizontalScrollbarThickness+verticalBorderArea,boxes=Object.freeze({devicePixelContentBoxSize:calculateBoxSize_size(Math.round(contentWidth*devicePixelRatio),Math.round(contentHeight*devicePixelRatio),switchSizes),borderBoxSize:calculateBoxSize_size(borderBoxWidth,borderBoxHeight,switchSizes),contentBoxSize:calculateBoxSize_size(contentWidth,contentHeight,switchSizes),contentRect:new DOMRectReadOnly(paddingLeft,paddingTop,contentWidth,contentHeight)});return cache.set(target,boxes),boxes},calculateBoxSize=function(target,observedBox,forceRecalculation){var _a=calculateBoxSizes(target,forceRecalculation),borderBoxSize=_a.borderBoxSize,contentBoxSize=_a.contentBoxSize,devicePixelContentBoxSize=_a.devicePixelContentBoxSize;switch(observedBox){case ResizeObserverBoxOptions.DEVICE_PIXEL_CONTENT_BOX:return devicePixelContentBoxSize;case ResizeObserverBoxOptions.BORDER_BOX:return borderBoxSize;default:return contentBoxSize}},ResizeObserverEntry_ResizeObserverEntry=function(){return function(target){var boxes=calculateBoxSizes(target);this.target=target,this.contentRect=boxes.contentRect,this.borderBoxSize=[boxes.borderBoxSize],this.contentBoxSize=[boxes.contentBoxSize],this.devicePixelContentBoxSize=[boxes.devicePixelContentBoxSize]}}(),calculateDepthForNode=function(node){if(isHidden(node))return 1/0;for(var depth=0,parent=node.parentNode;parent;)depth+=1,parent=parent.parentNode;return depth},broadcastActiveObservations=function(){var shallowestDepth=1/0,callbacks=[];resizeObservers.forEach(function(ro){if(0!==ro.activeTargets.length){var entries=[];ro.activeTargets.forEach(function(ot){var entry=new ResizeObserverEntry_ResizeObserverEntry(ot.target),targetDepth=calculateDepthForNode(ot.target);entries.push(entry),ot.lastReportedSize=calculateBoxSize(ot.target,ot.observedBox),targetDepth<shallowestDepth&&(shallowestDepth=targetDepth)}),callbacks.push(function(){ro.callback.call(ro.observer,entries,ro.observer)}),ro.activeTargets.splice(0,ro.activeTargets.length)}});for(var _i=0,callbacks_1=callbacks;_i<callbacks_1.length;_i++){(0,callbacks_1[_i])()}return shallowestDepth},gatherActiveObservationsAtDepth=function(depth){resizeObservers.forEach(function(ro){ro.activeTargets.splice(0,ro.activeTargets.length),ro.skippedTargets.splice(0,ro.skippedTargets.length),ro.observationTargets.forEach(function(ot){ot.isActive()&&(calculateDepthForNode(ot.target)>depth?ro.activeTargets.push(ot):ro.skippedTargets.push(ot))})})},process=function(){var event,depth=0;for(gatherActiveObservationsAtDepth(depth);resizeObservers.some(function(ro){return ro.activeTargets.length>0});)depth=broadcastActiveObservations(),gatherActiveObservationsAtDepth(depth);return resizeObservers.some(function(ro){return ro.skippedTargets.length>0})&&("function"==typeof ErrorEvent?event=new ErrorEvent("error",{message:msg}):((event=document.createEvent("Event")).initEvent("error",!1,!1),event.message=msg),window.dispatchEvent(event)),depth>0},queueMicroTask_callbacks=[],queueMicroTask=function(callback){if(!trigger){var toggle_1=0,el_1=document.createTextNode("");new MutationObserver(function(){return queueMicroTask_callbacks.splice(0).forEach(function(cb){return cb()})}).observe(el_1,{characterData:!0}),trigger=function(){el_1.textContent=""+(toggle_1?toggle_1--:toggle_1++)}}queueMicroTask_callbacks.push(callback),trigger()},watching=0,observerConfig={attributes:!0,characterData:!0,childList:!0,subtree:!0},events=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],time=function(timeout){return void 0===timeout&&(timeout=0),Date.now()+timeout},scheduled=!1,scheduler=new(function(){function Scheduler(){var _this=this;this.stopped=!0,this.listener=function(){return _this.schedule()}}return Scheduler.prototype.run=function(timeout){var _this=this;if(void 0===timeout&&(timeout=250),!scheduled){scheduled=!0;var cb,until=time(timeout);cb=function(){var elementsHaveResized=!1;try{elementsHaveResized=process()}finally{if(scheduled=!1,timeout=until-time(),!watching)return;elementsHaveResized?_this.run(1e3):timeout>0?_this.run(timeout):_this.start()}},queueMicroTask(function(){requestAnimationFrame(cb)})}},Scheduler.prototype.schedule=function(){this.stop(),this.run()},Scheduler.prototype.observe=function(){var _this=this,cb=function(){return _this.observer&&_this.observer.observe(document.body,observerConfig)};document.body?cb():global.addEventListener("DOMContentLoaded",cb)},Scheduler.prototype.start=function(){var _this=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),events.forEach(function(name){return global.addEventListener(name,_this.listener,!0)}))},Scheduler.prototype.stop=function(){var _this=this;this.stopped||(this.observer&&this.observer.disconnect(),events.forEach(function(name){return global.removeEventListener(name,_this.listener,!0)}),this.stopped=!0)},Scheduler}()),updateCount=function(n){!watching&&n>0&&scheduler.start(),!(watching+=n)&&scheduler.stop()},ResizeObservation_ResizeObservation=function(){function ResizeObservation(target,observedBox){this.target=target,this.observedBox=observedBox||ResizeObserverBoxOptions.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return ResizeObservation.prototype.isActive=function(){var target,size=calculateBoxSize(this.target,this.observedBox,!0);return target=this.target,isSVG(target)||function(target){switch(target.tagName){case"INPUT":if("image"!==target.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(target)||"inline"!==getComputedStyle(target).display||(this.lastReportedSize=size),this.lastReportedSize.inlineSize!==size.inlineSize||this.lastReportedSize.blockSize!==size.blockSize},ResizeObservation}(),ResizeObserverDetail=function(){return function(resizeObserver,callback){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=resizeObserver,this.callback=callback}}(),observerMap=new WeakMap,getObservationIndex=function(observationTargets,target){for(var i=0;i<observationTargets.length;i+=1)if(observationTargets[i].target===target)return i;return-1},ResizeObserverController_ResizeObserverController=function(){function ResizeObserverController(){}return ResizeObserverController.connect=function(resizeObserver,callback){var detail=new ResizeObserverDetail(resizeObserver,callback);observerMap.set(resizeObserver,detail)},ResizeObserverController.observe=function(resizeObserver,target,options){var detail=observerMap.get(resizeObserver),firstObservation=0===detail.observationTargets.length;getObservationIndex(detail.observationTargets,target)<0&&(firstObservation&&resizeObservers.push(detail),detail.observationTargets.push(new ResizeObservation_ResizeObservation(target,options&&options.box)),updateCount(1),scheduler.schedule())},ResizeObserverController.unobserve=function(resizeObserver,target){var detail=observerMap.get(resizeObserver),index=getObservationIndex(detail.observationTargets,target),lastObservation=1===detail.observationTargets.length;index>=0&&(lastObservation&&resizeObservers.splice(resizeObservers.indexOf(detail),1),detail.observationTargets.splice(index,1),updateCount(-1))},ResizeObserverController.disconnect=function(resizeObserver){var _this=this,detail=observerMap.get(resizeObserver);detail.observationTargets.slice().forEach(function(ot){return _this.unobserve(resizeObserver,ot.target)}),detail.activeTargets.splice(0,detail.activeTargets.length)},ResizeObserverController}(),ResizeObserver_ResizeObserver=function(){function ResizeObserver(callback){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof callback)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");ResizeObserverController_ResizeObserverController.connect(this,callback)}return ResizeObserver.prototype.observe=function(target,options){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!isElement(target))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");ResizeObserverController_ResizeObserverController.observe(this,target,options)},ResizeObserver.prototype.unobserve=function(target){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!isElement(target))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");ResizeObserverController_ResizeObserverController.unobserve(this,target)},ResizeObserver.prototype.disconnect=function(){ResizeObserverController_ResizeObserverController.disconnect(this)},ResizeObserver.toString=function(){return"function ResizeObserver () { [polyfill code] }"},ResizeObserver}();__webpack_require__.d(__webpack_exports__,"a",function(){return ResizeObserverService_ResizeObserverService});var ResizeObserverService_ResizeObserverService=function(){function ResizeObserverService(_global){var _this=this;classCallCheck_default()(this,ResizeObserverService),this._observableElementList=[],this._onResize=function(entries,observer){entries.forEach(function(entry){_this._getObservableElementListByElement(entry.target).forEach(function(observableElement){observableElement&&(Object(DomUtils.i)(observableElement.element),observableElement.callback(observableElement.element))})})};try{var ResizeObserverClass=_global.ResizeObserver||ResizeObserver_ResizeObserver;this._resizeObserver=new ResizeObserverClass(this._onResize)}catch(error){Object(Logging.a)({message:"ResizeObserver_constructor",callStack:error.stack,exception:error.message,level:protos.ProtoLoggingLevelEnum.FATAL})}}return createClass_default()(ResizeObserverService,[{key:"on",value:function(element,callback){this._getObservableElementByParams(element,callback)||(this._observableElementList.push({element:element,callback:callback}),this._resizeObserver.observe(element))}},{key:"off",value:function(element,callback){var observableElement=this._getObservableElementByParams(element,callback);if(observableElement){this._resizeObserver.unobserve(observableElement.element);var index=this._observableElementList.indexOf(observableElement);index>=0&&this._observableElementList.splice(index,1)}}},{key:"destroy",value:function(){if(this._observableElementList)for(;this._observableElementList.length>0;)this._observableElementList.pop();this._resizeObserver.disconnect()}},{key:"_getObservableElementListByElement",value:function(element){return this._observableElementList.filter(function(observableElement){return observableElement.element===element})}},{key:"_getObservableElementByParams",value:function(element,callback){return this._observableElementList.find(function(observableElement){return observableElement.element===element&&observableElement.callback===callback})}}]),ResizeObserverService}()},function(module,__webpack_exports__,__webpack_require__){"use strict";var PluginsEnum,classCallCheck=__webpack_require__(1),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(2),createClass_default=__webpack_require__.n(createClass),DomUtils=__webpack_require__(5),PluginEventsCacheHandler_PluginEventsCacheHandler=function(){function PluginEventsCacheHandler(eventsStorageService){var _this=this;classCallCheck_default()(this,PluginEventsCacheHandler),this._cachedEvents=[],this._onEventEmited=function(event){_this._cachedEvents.push(event)},this._unsubscribe=eventsStorageService.subscribe(this._onEventEmited)}return createClass_default()(PluginEventsCacheHandler,[{key:"destroy",value:function(){this._cachedEvents=null,this._unsubscribe()}},{key:"cachedEvents",get:function(){return this._cachedEvents}}]),PluginEventsCacheHandler}();!function(PluginsEnum){PluginsEnum.AdobeAnalytics="AdobeAnalytics",PluginsEnum.MoatAnalytics="MoatAnalytics"}(PluginsEnum||(PluginsEnum={}));var TypeUtils=__webpack_require__(4),Logging=__webpack_require__(11),protos=__webpack_require__(0),ArrayUtils=__webpack_require__(13),ObjectUtils=__webpack_require__(45),GeneralUtils=__webpack_require__(15),HrefUtils=__webpack_require__(26),EnvironmentConfig=__webpack_require__(27),EndPointResolver=__webpack_require__(22);__webpack_require__.d(__webpack_exports__,"a",function(){return PluginsHandler_PluginsHandler});var PluginsHandler_PluginsHandler=function(){function PluginsHandler(GLOBAL,_eventsStorageService,_delegateHandlers,_playerSettings,_playerContainer){var _this=this;classCallCheck_default()(this,PluginsHandler),this._eventsStorageService=_eventsStorageService,this._delegateHandlers=_delegateHandlers,this._playerSettings=_playerSettings,this._playerContainer=_playerContainer,this._unachedPlugins=[],this._initPlugin=function(pluginWrapper){try{_this._cachePlugin(pluginWrapper);var cachedEvents,newPlugin=_this._unachedPlugins.find(function(element){return element.name===pluginWrapper.type});if(newPlugin&&!newPlugin.started){newPlugin.started=!0;var eventsCacheHandler=newPlugin.eventsCacheHandler;cachedEvents=eventsCacheHandler.cachedEvents,eventsCacheHandler.destroy()}var _this$_playerSettings=_this._playerSettings.apiConfig.settings.plugins,adobeAnalyticsSettings=_this$_playerSettings.adobeAnalyticsSettings,moatAnalyticsSettings=_this$_playerSettings.moatAnalyticsSettings,_debugLogging=_this$_playerSettings._debugLogging,_this$_playerSettings2=_this._playerSettings,pluginSettings={cachedEvents:cachedEvents,adobeAnalyticsSettings:adobeAnalyticsSettings,moatAnalyticsSettings:moatAnalyticsSettings,_debugLogging:_debugLogging,secondLevelDomain:_this$_playerSettings2.secondLevelDomain,playerId:_this$_playerSettings2.playerId,pageName:_this._pageName,pageUrl:_this._pageUrl,version:EnvironmentConfig.a.version,delegateHandlers:_this._delegateHandlers,playerContainer:_this._playerContainer,playerWindow:window};pluginWrapper.getInstance().start(_this._eventsStorageService,pluginSettings)}catch(e){Object(Logging.a)({callStack:e.stack,exception:e.message,level:protos.ProtoLoggingLevelEnum.FATAL,message:"PluginsHandler_initPlugin"})}};var findFrameResult=Object(GeneralUtils.f)(GLOBAL);this._global=findFrameResult.topFrame,this._pageUrl=Object(GeneralUtils.e)(findFrameResult,this._global),this._pageUrl=Object(HrefUtils.d)(this._pageUrl),this._pageName=Object(HrefUtils.a)(this._pageUrl)}return createClass_default()(PluginsHandler,[{key:"start",value:function(){this._initCachedPlugins(),this._initNewPlugins(),this._global.cnxPlugins.pluginsHandlers.push(this._initPlugin)}},{key:"_initCachedPlugins",value:function(){var _this2=this,cachedPlugins=[];Array.isArray(this._global.cnxPlugins)&&this._global.cnxPlugins.length>0&&(cachedPlugins=this._global.cnxPlugins).forEach(function(callback){return _this2._initPlugin(callback)}),Object(TypeUtils.f)(this._global.cnxPlugins)||this._rewriteCnxPlugins(cachedPlugins)}},{key:"_initNewPlugins",value:function(){var currentPlugins=this._getCurrentPlayerPlugins();Object(ArrayUtils.h)(currentPlugins)&&this._addNewPlugins(currentPlugins)}},{key:"_getCachedPlugin",value:function(type){var cachedPlugins=this._global.cnxPlugins.cachedPlugins;if(Object(ArrayUtils.h)(cachedPlugins))return cachedPlugins.find(function(plugin){return plugin.type===type})}},{key:"_cachePlugin",value:function(plugin){this._getCachedPlugin(plugin.type)||this._global.cnxPlugins.cachedPlugins.push(plugin)}},{key:"_rewriteCnxPlugins",value:function(cachedPlugins){this._global.cnxPlugins={cachedPlugins:cachedPlugins,pluginsHandlers:[],push:function(plugin){this.pluginsHandlers.forEach(function(pluginHandler){pluginHandler(plugin)})}}}},{key:"_addNewPlugins",value:function(currentPlugins){var _this3=this;currentPlugins.forEach(function(newPlugin){_this3._getCachedPlugin(newPlugin)||_this3._unachedPlugins.push({name:newPlugin,started:!1,eventsCacheHandler:new PluginEventsCacheHandler_PluginEventsCacheHandler(_this3._eventsStorageService)})}),this._unachedPlugins.forEach(function(_ref){var name=_ref.name;return _this3._addScriptToHead(name)})}},{key:"_isValidSettings",value:function(settings){return Object(ObjectUtils.a)(settings).every(function(value){return Object(TypeUtils.h)(value)})}},{key:"_getCurrentPlayerPlugins",value:function(){var currentPlugins=[];return this._playerSettings.apiConfig.settings.plugins.adobeAnalyticsSettings&&this._isValidSettings(this._playerSettings.apiConfig.settings.plugins.adobeAnalyticsSettings)&&currentPlugins.push(PluginsEnum.AdobeAnalytics),this._playerSettings.moatTrackingEnabled&&currentPlugins.push(PluginsEnum.MoatAnalytics),currentPlugins}},{key:"_addScriptToHead",value:function(pluginName){var config={id:"cnx-".concat(pluginName),src:""};switch(pluginName){case PluginsEnum.AdobeAnalytics:config.src=EndPointResolver.a.endPoints.assets.plugins.adobeAnalytics;break;case PluginsEnum.MoatAnalytics:config.src=EndPointResolver.a.endPoints.assets.plugins.moatAnalytics}this._global.document.getElementById(config.id)||Object(DomUtils.A)(config,this._global.document.head,this._global,null,null,!0,"PluginsHandler_unable_to_insert_plugin_script")}}]),PluginsHandler}()},function(module,__webpack_exports__,__webpack_require__){"use strict";var OmidPlayerStateEnum,PlayerStateEventsEnum,defineProperty=__webpack_require__(6),defineProperty_default=__webpack_require__.n(defineProperty),classCallCheck=__webpack_require__(1),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(2),createClass_default=__webpack_require__.n(createClass),assertThisInitialized=__webpack_require__(16),assertThisInitialized_default=__webpack_require__.n(assertThisInitialized),possibleConstructorReturn=__webpack_require__(8),possibleConstructorReturn_default=__webpack_require__.n(possibleConstructorReturn),getPrototypeOf=__webpack_require__(3),getPrototypeOf_default=__webpack_require__.n(getPrototypeOf),inherits=__webpack_require__(9),inherits_default=__webpack_require__.n(inherits),OmidConfig=__webpack_require__(37),CnxTrackingEventsEnum=__webpack_require__(21),AdStateEnum=__webpack_require__(98);!function(OmidPlayerStateEnum){OmidPlayerStateEnum.Minimized="minimized",OmidPlayerStateEnum.Collapsed="collapsed",OmidPlayerStateEnum.Normal="normal",OmidPlayerStateEnum.Expanded="expanded",OmidPlayerStateEnum.Fullscreen="fullscreen"}(OmidPlayerStateEnum||(OmidPlayerStateEnum={})),function(PlayerStateEventsEnum){PlayerStateEventsEnum.StateChanged="stateChanged"}(PlayerStateEventsEnum||(PlayerStateEventsEnum={}));var PlayerStateHandler_PlayerStateHandler=function(){function PlayerStateHandler(mediator){classCallCheck_default()(this,PlayerStateHandler),this.mediator=mediator}return createClass_default()(PlayerStateHandler,[{key:"computeState",value:function(dimensions){var currentState=this._getCurrentStateName(dimensions);this._currentStateInfo&&this._currentStateInfo.name===currentState||this.mediator.publish(this,PlayerStateEventsEnum.StateChanged,{payload:{state:currentState}}),this._currentStateInfo={dimensions:dimensions,name:currentState},this._cachedNormalStateInfo||currentState!==OmidPlayerStateEnum.Normal||(this._cachedNormalStateInfo=Object.assign({},this._currentStateInfo))}},{key:"setPlayerState",value:function(state){this._currentStateInfo&&this._currentStateInfo.name===state||this.mediator.publish(this,PlayerStateEventsEnum.StateChanged,{payload:{state:state}}),this._currentStateInfo={name:state},this._cachedNormalStateInfo||state!==OmidPlayerStateEnum.Normal||(this._cachedNormalStateInfo=Object.assign({},this._currentStateInfo))}},{key:"_getCurrentStateName",value:function(dimensions){if(!this._cachedNormalStateInfo)return OmidPlayerStateEnum.Normal;var _this$_cachedNormalSt=this._cachedNormalStateInfo.dimensions,cachedArea=_this$_cachedNormalSt.width*_this$_cachedNormalSt.height,currentArea=dimensions.width*dimensions.height;switch(!0){case cachedArea<currentArea:return OmidPlayerStateEnum.Expanded;case cachedArea>currentArea:return OmidPlayerStateEnum.Collapsed;default:return OmidPlayerStateEnum.Normal}}},{key:"currentState",get:function(){return this._currentStateInfo&&this._currentStateInfo.name}}]),PlayerStateHandler}(),Mediator=__webpack_require__(28),Logging=__webpack_require__(11),protos=__webpack_require__(0);function _createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}__webpack_require__.d(__webpack_exports__,"a",function(){return SessionClientWrapper_SessionClientWrapper});var SessionClientWrapper_SessionClientWrapper=function(_Mediator){inherits_default()(SessionClientWrapper,_Mediator);var _super=_createSuper(SessionClientWrapper);function SessionClientWrapper(_omidSessionClient,_eventsStorageService,sdkVersion){var _this$_eventHandlerMa,_this;classCallCheck_default()(this,SessionClientWrapper),(_this=_super.call(this))._omidSessionClient=_omidSessionClient,_this._eventsStorageService=_eventsStorageService,_this._playerStateHandler=new PlayerStateHandler_PlayerStateHandler(assertThisInitialized_default()(_this)),_this._inImpression=!1,_this._eventHandlerMap=(_this$_eventHandlerMa={},defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdError,function(){return _this._onAdError()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.PlayError,function(){return _this._onPlayError()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.RenderError,function(){return _this._onRenderError()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdImpression,function(){return _this._onAdImpression()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdComplete,function(){return _this._onAdComplete()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdVideoStart,function(_ref){var adVideoStartMetadata=_ref.adVideoStartMetadata;return _this._onAdVideoStart(adVideoStartMetadata)}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdVideoFirstQuartile,function(){return _this._onAdVideoFirstQuartile()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdVideoMidpoint,function(){return _this._onAdVideoMidpoint()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdVideoThirdQuartile,function(){return _this._onAdVideoThirdQuartile()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdVideoComplete,function(){return _this._onAdVideoComplete()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.VolumeChange,function(_ref2){var volume=_ref2.volume;return _this._onVolumeChange(volume)}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdPause,function(){return _this._onAdPaused()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdPlay,function(){return _this._onAdPlay()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdSkipped,function(){return _this._onAdSkipped()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdClickThru,function(){return _this._onAdClickThru()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdInteraction,function(){return _this._onAdInteraction()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdLoaded,function(_ref3){var adLoadedMetadata=_ref3.adLoadedMetadata;return _this._onAdLoaded(adLoadedMetadata)}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.AdStateChange,function(_ref4){var adStateChangedMetadata=_ref4.adStateChangedMetadata;return _this._onAdStateChanged(adStateChangedMetadata)}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.PlayerResized,function(_ref5){var playerDimensionsMetadata=_ref5.playerDimensionsMetadata;return _this._onPlayerResize(playerDimensionsMetadata)}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.OnEnterFullscreen,function(){return _this._onEnterFullscreen()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.PlayerCollapsed,function(){return _this._onPlayerCollapsed()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.PlayerExpanded,function(){return _this._onPlayerExpanded()}),defineProperty_default()(_this$_eventHandlerMa,CnxTrackingEventsEnum.a.Destroy,function(){return _this.unsubscribeAll(_this._playerStateHandler)}),_this$_eventHandlerMa),_this._onEventStorageEvent=function(event){try{var eventHandler=_this._eventHandlerMap[event.name];if(!eventHandler)return;eventHandler(event.metadata)}catch(e){Object(Logging.a)({message:"SessionClientWrapper_omsdk__onEventStorageEvent",exception:e.message,callStack:e.callStack,level:protos.ProtoLoggingLevelEnum.WARNING})}};try{var _this$_omidSessionCli=_this._omidSessionClient,AdSession=_this$_omidSessionCli.AdSession,AdEvents=_this$_omidSessionCli.AdEvents,MediaEvents=_this$_omidSessionCli.MediaEvents,context=_this._getNewContext(sdkVersion);_this._adSession=new AdSession(context),_this._adEvents=new AdEvents(_this._adSession),_this._mediaEvents=new MediaEvents(_this._adSession),_this._eventsStorageService.subscribe(_this._onEventStorageEvent),_this.subscribe(PlayerStateEventsEnum.StateChanged,_this._playerStateHandler,function(_ref6){var state=_ref6.payload.state;_this._emitPlayerStateChanged(state)}),_this._subscribeToAdSessionEvents()}catch(e){Object(Logging.a)({message:"SessionClientWrapper_omsdk_classes_init_err",exception:e.message,callStack:e.callStack,level:protos.ProtoLoggingLevelEnum.WARNING})}return _this}return createClass_default()(SessionClientWrapper,[{key:"_onAdError",value:function(){this._adSession.error(OmidConfig.d.Video,CnxTrackingEventsEnum.a.AdError)}},{key:"_onPlayError",value:function(){this._adSession.error(OmidConfig.d.Video,CnxTrackingEventsEnum.a.PlayError)}},{key:"_onRenderError",value:function(){this._adSession.error(OmidConfig.d.Generic,CnxTrackingEventsEnum.a.RenderError)}},{key:"_getNewContext",value:function(sdkVersion){var _this$_omidSessionCli2=this._omidSessionClient,Partner=_this$_omidSessionCli2.Partner;return new(0,_this$_omidSessionCli2.Context)(new Partner(OmidConfig.i,sdkVersion))}},{key:"_onAdImpression",value:function(){this._inImpression=!0,this._adEvents.impressionOccurred();var currentState=this._playerStateHandler.currentState;currentState!==OmidPlayerStateEnum.Normal&&this._emitPlayerStateChanged(currentState)}},{key:"_onAdComplete",value:function(){this._inImpression=!1}},{key:"_onAdVideoStart",value:function(metadata){var duration=metadata.duration,mediaPlayerVolume=metadata.mediaPlayerVolume;this._mediaEvents.start(duration,mediaPlayerVolume)}},{key:"_onAdVideoFirstQuartile",value:function(){this._mediaEvents.firstQuartile()}},{key:"_onAdVideoMidpoint",value:function(){this._mediaEvents.midpoint()}},{key:"_onAdVideoThirdQuartile",value:function(){this._mediaEvents.thirdQuartile()}},{key:"_onAdVideoComplete",value:function(){this._mediaEvents.complete()}},{key:"_onVolumeChange",value:function(volume){this._inImpression&&this._mediaEvents.volumeChange(volume)}},{key:"_onAdPaused",value:function(){this._mediaEvents.pause()}},{key:"_onAdPlay",value:function(){this._mediaEvents.resume()}},{key:"_onAdSkipped",value:function(){this._mediaEvents.skipped()}},{key:"_onAdClickThru",value:function(){this._mediaEvents.adUserInteraction(OmidConfig.g.Click)}},{key:"_onAdInteraction",value:function(){this._mediaEvents.adUserInteraction(OmidConfig.g.InvitationAccept)}},{key:"_onAdLoaded",value:function(adLoadedMetadata){var isSkippable=adLoadedMetadata.isSkippable,skipOffset=adLoadedMetadata.skipOffset,isAutoPlay=adLoadedMetadata.isAutoPlay,vastProperties=new(0,this._omidSessionClient.VastProperties)(isSkippable,skipOffset,isAutoPlay,this._currentAdState);this._adEvents.loaded(vastProperties)}},{key:"_onAdStateChanged",value:function(_ref7){var state=_ref7.state;this._currentAdState=OmidConfig.h[AdStateEnum.a[state]]}},{key:"_emitPlayerStateChanged",value:function(state){state&&this._mediaEvents.playerStateChange(state)}},{key:"_computePlayerState",value:function(dimensions){this._playerStateHandler.computeState(dimensions)}},{key:"_setPlayerState",value:function(state){this._playerStateHandler.setPlayerState(state)}},{key:"_onPlayerResize",value:function(dimensions){this._computePlayerState(dimensions)}},{key:"_onEnterFullscreen",value:function(){this._setPlayerState(OmidPlayerStateEnum.Fullscreen)}},{key:"_onPlayerCollapsed",value:function(){this._setPlayerState(OmidPlayerStateEnum.Minimized)}},{key:"_onPlayerExpanded",value:function(){this._setPlayerState(OmidPlayerStateEnum.Normal)}},{key:"_subscribeToAdSessionEvents",value:function(){var _this2=this;this._adSession.registerSessionObserver(function(event){event.type===OmidConfig.b.SessionStart?_this2._onAdSessionStart(event):event.type===OmidConfig.b.SessionError&&Object(Logging.a)({message:"SessionClientWrapper_omsdk_session_error",exception:event.type,callStack:JSON.stringify(event),level:protos.ProtoLoggingLevelEnum.WARNING,throttle:1,sendMaxLog:!1})})}},{key:"_onAdSessionStart",value:function(event){event.data.creativeType===OmidConfig.c.DefinedByJavascript&&this._adSession.setCreativeType(OmidConfig.c.Video),event.data.impressionType===OmidConfig.f.DefinedByJavascript&&this._adSession.setImpressionType(OmidConfig.f.BeginToRender)}}]),SessionClientWrapper}(Mediator.a)},function(module,__webpack_exports__,__webpack_require__){"use strict";var defineProperty=__webpack_require__(6),defineProperty_default=__webpack_require__.n(defineProperty),classCallCheck=__webpack_require__(1),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(2),createClass_default=__webpack_require__.n(createClass),possibleConstructorReturn=__webpack_require__(8),possibleConstructorReturn_default=__webpack_require__.n(possibleConstructorReturn),getPrototypeOf=__webpack_require__(3),getPrototypeOf_default=__webpack_require__.n(getPrototypeOf),inherits=__webpack_require__(9),inherits_default=__webpack_require__.n(inherits),XhrUtils=__webpack_require__(35),protos=__webpack_require__(0),EnvironmentConfig=__webpack_require__(27),EndPointResolver=__webpack_require__(22),TimeConfig=__webpack_require__(20),TimeStorage_TimeStorage=function(){function TimeStorage(){classCallCheck_default()(this,TimeStorage),this._startTime=null,this._storedTime=0}return createClass_default()(TimeStorage,[{key:"_cacheElapsedTime",value:function(){if(null!==this._startTime){var currentTime=(new Date).getTime();this._storedTime=currentTime-this._startTime}}},{key:"startCountingTime",value:function(){this._startTime=(new Date).getTime()}},{key:"stopCountingTime",value:function(){this._cacheElapsedTime(),this._startTime=null}},{key:"fetchTime",value:function(maxTimeCount){this._cacheElapsedTime();var countedTime=Math.round(this._storedTime/TimeConfig.f);return this._storedTime=0,null!==this._startTime&&this.startCountingTime(),countedTime>maxTimeCount?maxTimeCount:countedTime}}]),TimeStorage}(),Mediator=__webpack_require__(28),TypeUtils=__webpack_require__(4),ABService=__webpack_require__(53),PlayerConfig=__webpack_require__(49),GeneralUtils=__webpack_require__(15),ArrayUtils=__webpack_require__(13),LoggingStorage=__webpack_require__(44);__webpack_require__(76);function _createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}__webpack_require__.d(__webpack_exports__,"a",function(){return TrackingService_TrackingService});var TrackingService_TrackingService=function(_Mediator){inherits_default()(TrackingService,_Mediator);var _super=_createSuper(TrackingService);function TrackingService(_ref){var _this,userId=_ref.userId,playerId=_ref.playerId,geoLocation=_ref.geoLocation,browser=_ref.browser,sessionId=_ref.sessionId,pageUrl=_ref.pageUrl,bundleId=_ref.bundleId,userManagerService=(_ref._logAllAdRequests,_ref.userManagerService),customParam1=_ref.customParam1,customParam2=_ref.customParam2,customParam3=_ref.customParam3,customParam4=_ref.customParam4,customParam5=_ref.customParam5,abTestId=_ref.abTestId,explorationMode=_ref.explorationMode;classCallCheck_default()(this,TrackingService),(_this=_super.call(this)).hasGdprConsentPayload=!1,_this._trackingRequestMeta={},_this._currentMediaTrackingMetadata={},_this._sessionRenderTracked=!1,_this._sessionViewTracked=!1,_this._sessionPlayback=!1,_this._sessionViewability=!1,_this._adBids=[],_this._adPreBids=[],_this._adPostBids=[],_this._timeBidsIntervalFrequency=5e3,_this._trackedPlayerStart=!1,_this._logAllAdRequests=!1,_this._sessionTimeTrackingPoints=[{delay:7,timesRepeatDelay:1},{delay:8,timesRepeatDelay:1},{delay:15,timesRepeatDelay:3},{delay:30,timesRepeatDelay:2},{delay:60,timesRepeatDelay:1},{delay:120,timesRepeatDelay:1},{delay:300,timesRepeatDelay:8},{delay:600,timesRepeatDelay:13},{delay:1800}],_this._currentSessionTimeTrackingPointIndex=0,_this._platformCappedLineItemsSubscriberList=[];return Object(ArrayUtils.g)(playerId,["47286b3d-90c5-4634-ac87-0061769d15a8","2a9c6007-6213-4187-9b0d-1a6e9d7826f0","dac6e2fc-472a-46e6-8a6b-b5bea57a50bc","112cdb88-91ea-452d-990c-03a7d3118d2c","075127fa-fec9-4ee7-9a4c-bfb4478a4412","2febda63-6ec9-4951-9c07-5939376b8226","55ca7ad7-f311-4854-b29a-a2d590760493","62bbbcda-024e-4769-968a-db84830f65cc","648d8d4d-fa41-496c-8415-26f3ad2d1989","6fdffbf5-b899-44ac-96a6-4eab50497b5b","b6094ff6-54a0-4ddd-b799-66193f8346c7","c81bb1f8-de80-428b-ae42-1ce0e75d3998","ddbadb2c-9e78-442a-b757-a49113a791ed","20d71b12-41ce-45db-8135-1a3cd111b25d","13e4ee65-6bed-40e6-8e41-4ef9087c294b","62d76d13-cd32-4021-a243-98b2444cd14d","b1c78103-4bb7-47ac-9cfe-dcd9b603e8a2","77a7ef56-c608-456d-8ff9-a382d139ff95","5d8eeea7-4ee0-4ad7-9023-97fbc8d97fa7","ed379095-5f46-4c1c-917d-ad063d84eaf1","0527ea2b-cb60-408e-85c1-e500bee128c3","148a0193-55d6-47a1-8a33-2c4ba9c97b5e","27937f13-f008-457b-938c-87c9fe447de8","4c2b6243-5715-4651-a27e-f6052b61af80","10efae62-af17-4d47-a65e-baabc2b60496","65d7cfb4-70a5-480a-95a7-25a713d61695","6e3ef6a1-2ccf-48b3-973c-55244487dc38","13426e00-211b-4c70-981e-d71a622543cf","728b020d-aa32-4009-ad0d-9c1b6b57b3c9","77e6bf0d-befe-4364-9f95-df37d478f297","19e14bfd-d5ef-4f82-8c9d-ea19512d0793","8c175c10-202a-4275-9e10-5ab9b216a61d","9429315c-a644-4fbf-938f-30cd23f2b098","a1bf91f8-98cb-4642-a2ec-2124782bf273","3025741e-c645-46ee-93db-c6b1c5cdb842","c32f1fb1-68d7-41cc-9a33-5f541d5b0cfd","c92ebcd4-b4c1-449e-809a-6744a0cd21d1","d0ad8360-284d-47d3-861d-6be5b09619e1","9b3b0ce6-cae5-43e0-b669-023c76e9127f","bbb6ab44-3b47-44d8-990c-642de4bb12ba","eeb97179-3486-4ca8-968c-c18f49e3be4a","ffc13c6a-6d6b-48dc-9965-d5a5adfea0f1","a8ec4044-50c7-46b1-8e8a-4da98ff95aed","ce2e36d0-8e66-4433-bb3c-47e78ad6f250","079b7e9c-6d8f-4772-b5d7-579c6f5f873b","04f884af-47ec-4754-a913-b38823f701a5","2e7b1501-840a-46f0-a3ae-015008b666d8","2ea0b3ba-66c9-46f4-a4a3-300f1bb36a93","3e1fcf24-0e7a-4aeb-9dce-a98d552dd7c7","5156a44c-a3d9-40ad-a592-b6ffb8019b2a","6b55d261-63c7-4349-804f-3d9bbd7aac85","8d95a3a5-ffa0-4932-8208-e06a8f659b55","a49d8dbb-b91f-41a3-b5a8-8a5b053af776","a585524a-2784-4b2d-924b-d872994cb7a8","225f96d6-6d58-483b-8856-ddffd61bac40","ad5efc62-db13-40f2-a76e-df9b90a2687b","08b46451-1849-433c-9019-85b2aeca87d1","bb5ad3b4-8fcd-4cb8-af70-383839db3712","e68c7376-e6c7-44ff-ad65-775691372f19","f5a3920b-15fc-4b52-8586-16091b9bedde","0c83603a-5d0c-4b62-a613-5f2db36510d3","0f3c7056-05d4-46fe-824c-32df48115369","81329826-a1f3-4f0b-86e1-2c1fb58cac85","a7b4eaad-8dea-41d5-8bd0-c8f13cd84296","c1282781-f75a-46b7-b774-5695e0a74c3d","d47819ae-be18-4054-8ffd-dc86eb6fdb5a"])?_this._trackingRequestMeta.trackAllRequests=!0:_this._trackingRequestMeta.trackAllRequests=1===Object(GeneralUtils.l)([99,1]),_this._userManagerService=userManagerService,_this._trackingRequestMeta.userId=userId,_this._trackingRequestMeta.playerId=playerId,_this._trackingRequestMeta.geo=geoLocation,_this._trackingRequestMeta.browser=browser,_this._trackingRequestMeta.version=EnvironmentConfig.a.version,_this._trackingRequestMeta.sessionId=sessionId,_this._trackingRequestMeta.clientAb0=ABService.a.clientAb0,_this._trackingRequestMeta.clientAb1=ABService.a.clientAb1,_this._trackingRequestMeta.serverAb0=ABService.a.serverAb0,_this._trackingRequestMeta.serverAb1=ABService.a.serverAb1,_this._trackingRequestMeta.pageUrl=pageUrl,_this._trackingRequestMeta.bundleId=bundleId,_this._trackingRequestMeta.customParam1=customParam1,_this._trackingRequestMeta.customParam2=customParam2,_this._trackingRequestMeta.customParam3=customParam3,_this._trackingRequestMeta.customParam4=customParam4,_this._trackingRequestMeta.customParam5=customParam5,_this._trackingRequestMeta.abTestId=abTestId,_this._sessionPlayTime=new TimeStorage_TimeStorage,_this._sessionPlayInViewTime=new TimeStorage_TimeStorage,_this._explorationMode=explorationMode,_this}return createClass_default()(TrackingService,[{key:"_sendTrackingViaBeacon",value:function(endpoint){var protoRequestModel=arguments.length>1&&void 0!==arguments[1]?arguments[1]:protos.ProtoTrackingRequest,requestData=arguments.length>2?arguments[2]:void 0,sendTrackingMeta=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return this._trackingRequestMeta.pageInFocus=LoggingStorage.a.pageFocus,XhrUtils.a.sendProtoBeaconRequest({endpoint:endpoint,ProtoRequest:protoRequestModel,requestData:Object.assign({trackingRequestMeta:sendTrackingMeta?this._trackingRequestMeta:void 0},requestData),logError:!1})}},{key:"_sendTracking",value:function(endpoint){var _this2=this,protoRequestModel=arguments.length>1&&void 0!==arguments[1]?arguments[1]:protos.ProtoTrackingRequest,requestData=arguments.length>2?arguments[2]:void 0,sendTrackingMeta=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this._trackingRequestMeta.pageInFocus=LoggingStorage.a.pageFocus;var protoPromise=XhrUtils.a.sendProtoRequest({endpoint:endpoint,ProtoRequest:protoRequestModel,ProtoResponse:protos.ProtoTrackingResponse,requestData:Object.assign({trackingRequestMeta:sendTrackingMeta?this._trackingRequestMeta:void 0},requestData),queryParams:defineProperty_default()({},PlayerConfig.b,EnvironmentConfig.a.version),withCredentials:!0,logError:!0});return protoPromise.then(function(trackingResponse){var platformCappedLineItemIdList=trackingResponse.platformCappedLineItemIdList;Object(ArrayUtils.h)(platformCappedLineItemIdList)&&_this2._platformCappedLineItemsSubscriberList.forEach(function(subscriber){subscriber.setPlatformCappedLineItemIdList(platformCappedLineItemIdList)});var impressionRevenue=trackingResponse.impressionRevenue,adServerLineItemName=trackingResponse.adServerLineItemName;Object(TypeUtils.e)(impressionRevenue)&&Object(TypeUtils.h)(adServerLineItemName)&&_this2._impressionRevenueSubscriber&&_this2._impressionRevenueSubscriber.notifyImpressionRevenue({impressionRevenue:impressionRevenue,adServerLineItemName:adServerLineItemName})}).catch(function(e){}),protoPromise}},{key:"addPlatformCappedLineItemSubscriber",value:function(subscriber){this._platformCappedLineItemsSubscriberList.push(subscriber)}},{key:"removePlatformCappedLineItemSubscriber",value:function(subscriber){var index=this._platformCappedLineItemsSubscriberList.indexOf(subscriber);index>=0&&this._platformCappedLineItemsSubscriberList.splice(index,1)}},{key:"setImpressionRevenueSubscriber",value:function(subscriber){this._impressionRevenueSubscriber=subscriber}},{key:"unsubscribeToImpressionRevenue",value:function(subscriber){this._impressionRevenueSubscriber!==subscriber&&(this._impressionRevenueSubscriber=void 0)}},{key:"_sendMediaTracking",value:function(endpoint,customObject){var protoObject=arguments.length>2&&void 0!==arguments[2]?arguments[2]:protos.ProtoMediaTrackingRequest,data=Object.assign({},customObject);Object(TypeUtils.h)(this._currentMediaTrackingMetadata.mediaId)&&(data.mediaGuid=this._currentMediaTrackingMetadata.mediaId),this._sendTracking(endpoint,protoObject,data)}},{key:"_sendPlayerStart",value:function(){this._trackedPlayerStart||(this._trackedPlayerStart=!0,this._sendTracking(EndPointResolver.a.endPoints.tracking.playerStart,protos.ProtoTrackingRequest))}},{key:"_sendImpressionTracking",value:function(endpoint,customObject){var protoObject=arguments.length>2&&void 0!==arguments[2]?arguments[2]:protos.ProtoMediaTrackingRequest;return this._sendTracking(endpoint,protoObject,Object.assign({mediaGuid:this._currentMediaTrackingMetadata.mediaId},customObject))}},{key:"_sendMediaQuartilesTracking",value:function(quartile){this._sendMediaTracking(EndPointResolver.a.endPoints.tracking.media_quartile,{baseMeta:this._currentMediaTrackingMetadata,mediaId:this._currentMediaTrackingMetadata.mediaId,quartile:quartile})}},{key:"_sendBidsRequestTracking",value:function(){this._sendBidsTracking(this._adPreBids,this._adBids,this._adPostBids),this._adPreBids=[],this._adBids=[],this._adPostBids=[]}},{key:"_sendBidsTracking",value:function(preBids,bids,postBids){if(0!==preBids.length||0!==bids.length||0!==postBids.length){postBids.forEach(function(postbid){postbid.error&&postbid.error.length>0&&(postbid.error=postbid.error.substring(0,500))});var bidTrackingParams={mediaGuid:this._currentMediaTrackingMetadata.mediaId,prebids:preBids,bids:bids,postBids:postBids,logEveryting:this._logAllAdRequests,hasGdprConsentPayload:this.hasGdprConsentPayload,gdprConsentMode:this._userManagerService.gdprConsentMode,useExploration:this._explorationMode};this._sendTracking(EndPointResolver.a.endPoints.tracking.bids,protos.ProtoBidTrackingsRequest,bidTrackingParams)}}},{key:"_sendAdClickTracking",value:function(customObject){this._sendTracking(EndPointResolver.a.endPoints.tracking.ad_click,protos.ProtoAdClickTrackingRequest,Object.assign({mediaGuid:this._currentMediaTrackingMetadata.mediaId},customObject))}},{key:"_sendHeavyAdInterventionTracking",value:function(heavyAdTrackingData){this._sendTrackingViaBeacon(EndPointResolver.a.endPoints.tracking.heavy_ad_intervention,protos.ProtoHeavyAdTrackingRequest,heavyAdTrackingData)}},{key:"_handleSessionTimeTracking",value:function(){var _this3=this,currentTrackingPoint=this._sessionTimeTrackingPoints[this._currentSessionTimeTrackingPointIndex];clearTimeout(this._timeSessionIntervalId),this._timeSessionIntervalId=setTimeout(function(){_this3._sendSessionTimeTracking(currentTrackingPoint.delay),Object(TypeUtils.e)(currentTrackingPoint.timesRepeatDelay)&&currentTrackingPoint.timesRepeatDelay--,0===currentTrackingPoint.timesRepeatDelay&&_this3._currentSessionTimeTrackingPointIndex++,_this3._handleSessionTimeTracking()},1e3*currentTrackingPoint.delay)}},{key:"_sendSessionTimeTracking",value:function(elapsedTime){this._sendTracking(EndPointResolver.a.endPoints.tracking.session_time,protos.ProtoSessionTimeTrackingRequest,{trackingRequestMeta:this._trackingRequestMeta,sessionTime:elapsedTime,timePlayed:this._sessionPlayTime.fetchTime(elapsedTime),timePlayedInView:this._sessionPlayInViewTime.fetchTime(elapsedTime)})}},{key:"setNewMedia",value:function(mediaMetadata){this._currentMediaTrackingMetadata=mediaMetadata}},{key:"updateMediaMetadata",value:function(mediaMetadata){this._currentMediaTrackingMetadata=mediaMetadata}},{key:"setImplementationTypeOnMeta",value:function(implementationType){this._trackingRequestMeta.implementationType=implementationType}},{key:"setMediaStart",value:function(){this._sendMediaQuartilesTracking(protos.ProtoQuartilesEnum.Start)}},{key:"setContentStart",value:function(){this._sendPlayerStart()}},{key:"setSessionPlayback",value:function(flag){this._sessionPlayback!==flag&&(this._sessionPlayback=flag,this._sessionViewability&&this._sessionPlayback&&this._sessionPlayInViewTime.startCountingTime(),this._sessionPlayback?this._sessionPlayTime.startCountingTime():(this._sessionPlayTime.stopCountingTime(),this._sessionPlayInViewTime.stopCountingTime()))}},{key:"setSessionViewability",value:function(flag){this._sessionViewability!==flag&&(this._sessionViewability=flag,this._sessionViewability&&this._sessionPlayback?this._sessionPlayInViewTime.startCountingTime():this._sessionViewability||this._sessionPlayInViewTime.stopCountingTime())}},{key:"trackSessionRendered",value:function(hasAdBlocker){if(!this._sessionRenderTracked){this._sendTracking(EndPointResolver.a.endPoints.tracking.session_rendered,protos.ProtoTrackingRequest,{hasAdBlocker:hasAdBlocker,bundleName:"playspace.es5.dc.js"}),this._sessionRenderTracked=!0,this._handleSessionTimeTracking()}}},{key:"trackSessionViewability",value:function(){!this._sessionViewTracked&&this._trackedPlayerStart&&(this._sendTracking(EndPointResolver.a.endPoints.tracking.session_view),this._sessionViewTracked=!0)}},{key:"trackMediaQuartile",value:function(quartile){this._sendMediaQuartilesTracking(quartile)}},{key:"trackMediaClick",value:function(){var type=arguments.length>0&&void 0!==arguments[0]?arguments[0]:protos.ProtoMediaClickTypeEnum.Click,clickMetadata={type:type,clickUrl:type===protos.ProtoMediaClickTypeEnum.UrlClick?this._currentMediaTrackingMetadata.clickUrl:void 0,slideTitle:this._currentMediaTrackingMetadata.slideTitle,slideNumber:this._currentMediaTrackingMetadata.slideNumber,slideMediaType:this._currentMediaTrackingMetadata.slideMediaType};this._sendMediaTracking(EndPointResolver.a.endPoints.tracking.media_click,clickMetadata,protos.ProtoMediaClickTrackingRequest)}},{key:"setAdStart",value:function(){this._sendPlayerStart()}},{key:"startBidRequests",value:function(){var _this4=this;this._bidRequestsIntervalId=setInterval(function(){_this4._sendBidsRequestTracking()},this._timeBidsIntervalFrequency)}},{key:"addPrebid",value:function(preBidData){this._adPreBids.push(preBidData)}},{key:"addPostBid",value:function(postBidData){Object(TypeUtils.g)(postBidData.error)||(postBidData.error=JSON.stringify(postBidData.error)),this._adPostBids.push(postBidData)}},{key:"addBid",value:function(bidData){this._adBids.push(bidData)}},{key:"trackAuctionInfoForBid",value:function(auctionInfoRequestData){this._sendTracking(EndPointResolver.a.endPoints.tracking.auctionInformation,protos.ProtoAuctionInfoRequest,auctionInfoRequestData)}},{key:"trackVideoAdImpression",value:function(impressionData){return this._sendImpressionTracking(EndPointResolver.a.endPoints.tracking.ad_impression,impressionData,protos.ProtoVideoAdImpressionRequest)}},{key:"trackVideoAdImpressionViewable",value:function(impressionViewableData){return this._sendImpressionTracking(EndPointResolver.a.endPoints.tracking.ad_impression_viewable,impressionViewableData,protos.ProtoVideoAdImpressionViewableRequest)}},{key:"trackVideoAdQuartile",value:function(quartileData){this._sendMediaTracking(EndPointResolver.a.endPoints.tracking.ad_quartile,quartileData,protos.ProtoVideoAdQuartilesRequest)}},{key:"trackAdClick",value:function(clickData){this._sendAdClickTracking(clickData)}},{key:"trackAdOpportunity",value:function(adOpportunityRequest){var sessionId=this._trackingRequestMeta.sessionId;adOpportunityRequest.sessionId=sessionId,this._sendTracking(EndPointResolver.a.endPoints.tracking.adOpportunity,protos.ProtoAdOpportunityRequest,adOpportunityRequest)}},{key:"trackSessionAdBlocker",value:function(data){this._sendTracking(EndPointResolver.a.endPoints.tracking.sessionAdBlocker,protos.ProtoSessionAdBlockerRequest,{trackingRequestMeta:this._trackingRequestMeta,adBlockDetectionType:data})}},{key:"getMetadataModel",value:function(){return this._trackingRequestMeta}},{key:"updateMetadataModel",value:function(meta){this._trackingRequestMeta=Object.assign(Object.assign({},this._trackingRequestMeta),meta)}},{key:"trackHeavyAdIntervention",value:function(heavyAdTrackingData){this._sendHeavyAdInterventionTracking(heavyAdTrackingData)}},{key:"destroy",value:function(){clearInterval(this._timeSessionIntervalId),clearInterval(this._bidRequestsIntervalId)}}]),TrackingService}(Mediator.a)},function(module,__webpack_exports__,__webpack_require__){"use strict";var _FRAUD_SENSOR_DEVICE_,FraudSensorDeviceTypeEnum,classCallCheck=__webpack_require__(1),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(2),createClass_default=__webpack_require__.n(createClass),TypeUtils=__webpack_require__(4),defineProperty=__webpack_require__(6),defineProperty_default=__webpack_require__.n(defineProperty),protos=__webpack_require__(0);!function(FraudSensorDeviceTypeEnum){FraudSensorDeviceTypeEnum[FraudSensorDeviceTypeEnum.Desktop=2]="Desktop",FraudSensorDeviceTypeEnum[FraudSensorDeviceTypeEnum.SmartTV=3]="SmartTV",FraudSensorDeviceTypeEnum[FraudSensorDeviceTypeEnum.Smartphone=4]="Smartphone",FraudSensorDeviceTypeEnum[FraudSensorDeviceTypeEnum.Tablet=5]="Tablet",FraudSensorDeviceTypeEnum[FraudSensorDeviceTypeEnum.GameConsole=6]="GameConsole",FraudSensorDeviceTypeEnum[FraudSensorDeviceTypeEnum.Unrecognized=7]="Unrecognized"}(FraudSensorDeviceTypeEnum||(FraudSensorDeviceTypeEnum={}));var FRAUD_SENSOR_DEVICE_TYPE_MAP=(_FRAUD_SENSOR_DEVICE_={},defineProperty_default()(_FRAUD_SENSOR_DEVICE_,protos.ProtoDeviceType.Desktop,FraudSensorDeviceTypeEnum.Desktop),defineProperty_default()(_FRAUD_SENSOR_DEVICE_,protos.ProtoDeviceType.Smartphone,FraudSensorDeviceTypeEnum.Smartphone),defineProperty_default()(_FRAUD_SENSOR_DEVICE_,protos.ProtoDeviceType.Tablet,FraudSensorDeviceTypeEnum.Tablet),defineProperty_default()(_FRAUD_SENSOR_DEVICE_,protos.ProtoDeviceType.GameConsole,FraudSensorDeviceTypeEnum.GameConsole),defineProperty_default()(_FRAUD_SENSOR_DEVICE_,protos.ProtoDeviceType.SmartTV,FraudSensorDeviceTypeEnum.SmartTV),defineProperty_default()(_FRAUD_SENSOR_DEVICE_,protos.ProtoDeviceType.WearableComputer,FraudSensorDeviceTypeEnum.Unrecognized),defineProperty_default()(_FRAUD_SENSOR_DEVICE_,protos.ProtoDeviceType.PDA,FraudSensorDeviceTypeEnum.Unrecognized),defineProperty_default()(_FRAUD_SENSOR_DEVICE_,protos.ProtoDeviceType.Unrecognized,FraudSensorDeviceTypeEnum.Unrecognized),_FRAUD_SENSOR_DEVICE_);__webpack_require__.d(__webpack_exports__,"a",function(){return FraudSensor_FraudSensor});var FraudSensor_FraudSensor=function(){function FraudSensor(_macrosService,_gobalDomUtilsService,_fraudSensorConfig,userId){classCallCheck_default()(this,FraudSensor),this._macrosService=_macrosService,this._gobalDomUtilsService=_gobalDomUtilsService,this._fraudSensorConfig=_fraudSensorConfig,this._setMacros(userId)}return createClass_default()(FraudSensor,[{key:"addFraudSensorScript",value:function(){if(!this._gobalDomUtilsService.getElementById("cnx_fraud_sensor")){var scriptData={id:"cnx_fraud_sensor",src:this._macrosService.setupMacros("https://s.srvsynd.com/2/234175/analytics.js?dt=2341751597675869250012&di=[DOMAIN]&ui=[FS_USER_ID]&md=[FS_MEDIA_TYPE]&ap=[FS_DEVICE_IDENT]&sr=[CNX_SUPPLIER_ID]&pp=[PUBLISHER_ID]&ti=[SESSION_ID]&de=[FS_DEVICE_TYPE]&to=[MGTO]&pv=[MGID]")};this._gobalDomUtilsService.insertScript(scriptData,null,"FraudSensor_script_error")}}},{key:"_setMacros",value:function(userId){userId=Object(TypeUtils.h)(userId)?userId:"00000000-0000-0000-0000-000000000000";var _this$_fraudSensorCon=this._fraudSensorConfig,lookupId=_this$_fraudSensorCon.lookupId,lookupResponseCode=_this$_fraudSensorCon.lookupResponseCode,publisherAdsTxt=_this$_fraudSensorCon.publisherAdsTxt,deviceIdentifier=_this$_fraudSensorCon.deviceIdentifier,deviceType=FRAUD_SENSOR_DEVICE_TYPE_MAP[this._fraudSensorConfig.deviceType];this._macrosService.setPublisherId(publisherAdsTxt),this._macrosService.setUserId(userId),this._macrosService.setFraudSensorMacros({lookupId:lookupId,lookupResponseCode:lookupResponseCode,deviceType:deviceType,mediaType:2,deviceIdentifier:deviceIdentifier})}}]),FraudSensor}()},function(module,__webpack_exports__,__webpack_require__){"use strict";var classCallCheck=__webpack_require__(1),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(2),createClass_default=__webpack_require__.n(createClass),CssClassesConfig=__webpack_require__(7),UiInteractionEventsEnum=__webpack_require__(17),InteractionServiceEnums=__webpack_require__(29),ArrayUtils=__webpack_require__(13),DomUtils=__webpack_require__(5),BUTTONS={MAIN:0,AUXILIARY:1,SECONDARY:2,FOURTH:3,FIFTH:4};function isLeftClick(e){return e.button===BUTTONS.MAIN}var NumberUtils=__webpack_require__(23),TypeUtils=__webpack_require__(4);__webpack_require__.d(__webpack_exports__,"a",function(){return InteractionService_InteractionService});var SCROLL_THRESHOLD_IN_PIXELS=25,HOLD_TAP_TRIGGER_TIME_IN_MS=250,LEFT_TAP_THRESHOLD_PERCENTAGE=30,InteractionService_InteractionService=function(){function InteractionService(_GLOBAL,_isMobile,config){var _this=this;classCallCheck_default()(this,InteractionService),this._GLOBAL=_GLOBAL,this._isMobile=_isMobile,this.mediator=null,this._leftTapSizeThreshold=LEFT_TAP_THRESHOLD_PERCENTAGE,this._holdTriggerDuration=HOLD_TAP_TRIGGER_TIME_IN_MS,this._scrollThreshold=SCROLL_THRESHOLD_IN_PIXELS,this._registeredTargets=[],this._globalActionConfig={},this._startY=0,this._startX=0,this._scrollDidNotLeaveThreshold=!0,this._holdTimerId=null,this._isHoldDurationExceeded=!1,this._isTap=!1,this._shouldTriggerHoldEnd=!1,this._swipeStarted=!1,this._cachedDeltaX=0,this._cachedDeltaXCounter=0,this._lockedAxis=null,this._requestAnimationFrameId=null,this._interactionStartTarget=null,this._isScrollEventEnabled=!0,this._shouldFireClickEvent=!1,this._enableListeners=function(target){_this._isMobile?(target.element.addEventListener("touchstart",_this._onTouchStart,{passive:!0}),target.element.addEventListener("touchmove",_this._onTouchMove,{passive:!0}),target.element.addEventListener("touchend",_this._onTouchEnd),target.element.addEventListener("touchcancel",_this._onTouchCancel),target.element.addEventListener("mouseup",_this._onClickEnd)):(target.element.addEventListener("mousedown",_this._onClickStart),target.element.addEventListener("mouseup",_this._onClickEnd))},this._disableListeners=function(target){_this._isMobile?(target.element.removeEventListener("touchstart",_this._onTouchStart),target.element.removeEventListener("touchmove",_this._onTouchMove),target.element.removeEventListener("touchend",_this._onTouchEnd),target.element.removeEventListener("touchcancel",_this._onTouchCancel),target.element.removeEventListener("mouseup",_this._onClickEnd)):(target.element.removeEventListener("mousedown",_this._onClickStart),target.element.removeEventListener("mouseup",_this._onClickEnd))},this._onTouchStart=function(event){event.stopPropagation();var eventTarget=_this._getEventTarget(event);_this._interactionStartTarget=eventTarget,_this._isTap=!1,_this._canDoSpecialInteraction(eventTarget,InteractionServiceEnums.c.Hold)&&_this._checkHoldStart(event);var eventData=_this._getEventData(event);_this._startX=eventData.eventX,_this._startY=eventData.eventY,_this._executeInteraction(event,eventTarget,InteractionServiceEnums.b.InteractionStart),_this._scrollDidNotLeaveThreshold=!0},this._onTouchMove=function(event){event.stopPropagation();var eventTarget=_this._getEventTarget(event),eventData=_this._getEventData(event);if(_this._scrollDidNotLeaveThreshold&&(Math.abs(eventData.deltaXFromStart)>_this._scrollThreshold||Math.abs(eventData.deltaYFromStart)>_this._scrollThreshold)&&(_this._scrollDidNotLeaveThreshold=!1),_this._isHoldDurationExceeded||_this._canDoSpecialInteraction(eventTarget,InteractionServiceEnums.c.Swipe)){if(null===_this._lockedAxis&&_this._checkSwipeStart(eventTarget,eventData),_this._lockedAxis===InteractionServiceEnums.a.Y)return;null===_this._requestAnimationFrameId&&(_this._requestAnimationFrameId=Object(DomUtils.P)(_this._GLOBAL,function(){_this._requestAnimationFrameId=null,_this._cacheDeltaX(eventData.deltaXFromStart),eventTarget.mediator.publish(eventTarget.context,UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.SwipeMove],{payload:eventData.deltaXFromStart})}))}},this._onTouchEnd=function(event){var eventTarget=_this._getEventTarget(event);if(_this._shouldFireClickEvent=!1,_this._interactionStartTarget===eventTarget){var eventData=_this._getEventData(event);event.cancelable&&_this._canDoSpecialInteraction(eventTarget,InteractionServiceEnums.c.Hold)&&Math.abs(eventData.deltaXFromStart)<_this._scrollThreshold&&Math.abs(eventData.deltaYFromStart)<_this._scrollThreshold&&event.preventDefault(),_this._handleEnd(event,eventTarget,eventData),_this._getIntendedAxis(eventData)===InteractionServiceEnums.a.Y&&Math.abs(eventData.deltaYFromStart)>=_this._scrollThreshold?_this._isScrollEventEnabled&&eventTarget.mediator.publish(eventTarget.context,UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Scroll]):!_this._scrollDidNotLeaveThreshold||_this._shouldTriggerHoldEnd||_this._isTap||(_this._shouldFireClickEvent=!0)}_this._interactionStartTarget=null},this._onTouchCancel=function(event){var eventTarget=_this._getEventTarget(event);_this._handleEnd(event,eventTarget),_this._interactionStartTarget=null},this._onClickStart=function(event){if(isLeftClick(event)){var eventTarget=_this._getEventTarget(event);_this._interactionStartTarget=eventTarget,event.stopPropagation(),event.preventDefault(),_this._canDoSpecialInteraction(eventTarget,InteractionServiceEnums.c.Hold)&&_this._checkHoldStart(event),_this._executeInteraction(event,eventTarget,InteractionServiceEnums.b.InteractionStart)}else _this._executeGlobalActions(InteractionServiceEnums.b.InteractionStart,event)},this._onClickEnd=function(event){var eventTarget=_this._getEventTarget(event);return _this._shouldFireClickEvent?(eventTarget.mediator.publish(eventTarget.context,UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Click]),void(_this._shouldFireClickEvent=!1)):isLeftClick(event)&&_this._interactionStartTarget?(event.stopPropagation(),event.preventDefault(),_this._executeInteraction(event,_this._interactionStartTarget,InteractionServiceEnums.b.Interaction),_this._executeInteraction(event,_this._interactionStartTarget,InteractionServiceEnums.b.InteractionEnd),(_this._isHoldDurationExceeded||_this._canDoSpecialInteraction(eventTarget,InteractionServiceEnums.c.Hold))&&_this._checkHoldEnd(event),_this._interactionStartTarget===eventTarget&&(_this._executeInteraction(event,eventTarget,InteractionServiceEnums.b.Click),eventTarget.mediator.publish(eventTarget.context,UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Click])),void(_this._interactionStartTarget=null)):(_this._executeGlobalActions(InteractionServiceEnums.b.Interaction,event),void _this._executeGlobalActions(InteractionServiceEnums.b.InteractionEnd,event))},this._onWindowClickStart=function(event){if(!isLeftClick(event))return _this._executeGlobalActions(InteractionServiceEnums.b.Interaction,event),void _this._executeGlobalActions(InteractionServiceEnums.b.InteractionEnd,event);_this._interactionStartTarget=null},this._onWindowClickEnd=function(event){if(!isLeftClick(event)||!_this._interactionStartTarget)return _this._executeGlobalActions(InteractionServiceEnums.b.Interaction,event),void _this._executeGlobalActions(InteractionServiceEnums.b.InteractionEnd,event);_this._executeInteraction(event,_this._interactionStartTarget,InteractionServiceEnums.b.Interaction),_this._executeInteraction(event,_this._interactionStartTarget,InteractionServiceEnums.b.InteractionEnd),(_this._isHoldDurationExceeded||_this._canDoSpecialInteraction(_this._interactionStartTarget,InteractionServiceEnums.c.Hold))&&_this._checkHoldEnd(event),_this._interactionStartTarget=null};var _Object$assign=Object.assign({},config),leftTapSizeThreshold=_Object$assign.leftTapSizeThreshold,holdTriggerDuration=_Object$assign.holdTriggerDuration,scrollThreshold=_Object$assign.scrollThreshold;this._leftTapSizeThreshold=leftTapSizeThreshold||this._leftTapSizeThreshold,this._holdTriggerDuration=holdTriggerDuration||this._holdTriggerDuration,this._scrollThreshold=scrollThreshold||this._scrollThreshold,this._GLOBAL.document.addEventListener("mousedown",this._onWindowClickStart),this._GLOBAL.document.addEventListener("mouseup",this._onWindowClickEnd)}return createClass_default()(InteractionService,[{key:"register",value:function(element,mediator,context){var interactibleElement={element:element,mediator:mediator,context:context,callbacks:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{})||{},allowedSpecialInteractions:arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],disabledSpecialInteractions:[]};this._registeredTargets.push(interactibleElement),this._enableListeners(interactibleElement)}},{key:"unregister",value:function(element){var elementToRemove=this._registeredTargets.find(function(target){return target.element===element});elementToRemove&&(this._registeredTargets=this._registeredTargets.filter(function(target){return target.element!==element}),this._disableListeners(elementToRemove))}},{key:"unregisterAll",value:function(mediator){var elementsToRemove=this._registeredTargets.filter(function(target){return target.mediator===mediator});elementsToRemove.forEach(this._disableListeners),this._registeredTargets=Object(ArrayUtils.a)(this._registeredTargets,elementsToRemove)}},{key:"addGlobalActions",value:function(initiator,callbacks){var _this2=this;Object.keys(Object.assign({},callbacks)).forEach(function(interaction){_this2._globalActionConfig[interaction]=_this2._globalActionConfig[interaction]||[],_this2._globalActionConfig[interaction].push({initiator:initiator,action:callbacks[interaction]})})}},{key:"removeGlobalActions",value:function(initiator){var _this3=this;Object.keys(this._globalActionConfig).forEach(function(interaction){_this3._globalActionConfig[interaction].some(function(trigger){return trigger.initiator===initiator})&&(_this3._globalActionConfig[interaction]=_this3._globalActionConfig[interaction].filter(function(trigger){return trigger.initiator!==initiator}))})}},{key:"disableSpecialInteractions",value:function(element){var target=this._getInteractibleFromElement(element);target.disabledSpecialInteractions=Object(ArrayUtils.n)(target.allowedSpecialInteractions)}},{key:"enableSpecialInteractions",value:function(element){this._getInteractibleFromElement(element).disabledSpecialInteractions=[]}},{key:"getNonInterruptibleInteractions",value:function(){return[UiInteractionEventsEnum.a.HoldStart,UiInteractionEventsEnum.a.HoldEnd,UiInteractionEventsEnum.a.SwipeMove,UiInteractionEventsEnum.a.SwipeEnd,UiInteractionEventsEnum.a.Scroll]}},{key:"disableScrollEvent",value:function(){this._isScrollEventEnabled=!1}},{key:"enableScrollEvent",value:function(){this._isScrollEventEnabled=!0}},{key:"destroy",value:function(){clearTimeout(this._holdTimerId),this._registeredTargets.forEach(this._disableListeners),this._GLOBAL.document.removeEventListener("mousedown",this._onWindowClickStart),this._GLOBAL.document.removeEventListener("mouseup",this._onWindowClickEnd)}},{key:"_checkTap",value:function(event){var eventTarget=this._getEventTarget(event),containerRect=eventTarget.element.getBoundingClientRect(),eventOffsetX=this._getEventOffsetX(event),fromEndAbsolute=containerRect.width,tapDistancePercentage=Object(NumberUtils.g)(0,fromEndAbsolute,0,100,eventOffsetX);this._sendTapEvent(eventTarget,this._leftTapSizeThreshold,tapDistancePercentage)}},{key:"_sendTapEvent",value:function(eventTarget,leftPercentage,tapDistancePercentage){tapDistancePercentage<leftPercentage?eventTarget.mediator.publish(eventTarget.context,UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.TapLeft]):eventTarget.mediator.publish(eventTarget.context,UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.TapRight])}},{key:"_checkHoldStart",value:function(event){var _this4=this;clearTimeout(this._holdTimerId),this._isHoldDurationExceeded=!1,this._shouldTriggerHoldEnd=!1;var eventTarget=this._getEventTarget(event);Object(DomUtils.a)(eventTarget.element,CssClassesConfig.h.OnHold),this._holdTimerId=setTimeout(function(){_this4._isHoldDurationExceeded=!0,_this4._scrollDidNotLeaveThreshold&&(_this4._shouldTriggerHoldEnd=!0,eventTarget.mediator.publish(eventTarget.context,UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.HoldStart]))},this._holdTriggerDuration)}},{key:"_checkHoldEnd",value:function(event){clearTimeout(this._holdTimerId);var eventTarget=this._getEventTarget(event);Object(DomUtils.L)(eventTarget.element,CssClassesConfig.h.OnHold),this._isHoldDurationExceeded?(this._isHoldDurationExceeded=!1,this._shouldTriggerHoldEnd&&(this._shouldTriggerHoldEnd=!1,eventTarget.mediator.publish(eventTarget.context,UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.HoldEnd]))):(this._isTap=!0,this._checkTap(event))}},{key:"_handleEnd",value:function(event,eventTarget,eventData){eventData=eventData||this._getEventData(event),event.stopPropagation(),this._executeInteraction(event,eventTarget,InteractionServiceEnums.b.Interaction),this._executeInteraction(event,eventTarget,InteractionServiceEnums.b.InteractionEnd),(this._isHoldDurationExceeded||this._swipeStarted||this._scrollDidNotLeaveThreshold&&this._canDoSpecialInteraction(eventTarget,InteractionServiceEnums.c.Hold))&&this._checkHoldEnd(event),(this._swipeStarted||this._canDoSpecialInteraction(eventTarget,InteractionServiceEnums.c.Swipe))&&this._checkSwipeEnd(eventTarget,eventData)}},{key:"_checkSwipeStart",value:function(eventTarget,eventData){this._lockedAxis=this._getIntendedAxis(eventData),this._lockedAxis===InteractionServiceEnums.a.X&&(this._swipeStarted=!0,this._isHoldDurationExceeded||(clearTimeout(this._holdTimerId),this._holdTimerId=null,this._isHoldDurationExceeded=!0,eventTarget.mediator.publish(eventTarget.context,UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.HoldStart])))}},{key:"_checkSwipeEnd",value:function(eventTarget,eventData){if(this._swipeStarted){var direction=this._getDirection(eventData);eventTarget.mediator.publish(eventTarget.context,UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.SwipeEnd],{payload:direction})}Object(DomUtils.e)(this._GLOBAL,this._requestAnimationFrameId),this._requestAnimationFrameId=null,this._swipeStarted=!1,this._startX=null,this._startY=null,this._lockedAxis=null,this._cachedDeltaX=0,this._cachedDeltaXCounter=0}},{key:"_cacheDeltaX",value:function(deltaX){this._cachedDeltaXCounter<this._scrollThreshold?this._cachedDeltaXCounter++:(this._cachedDeltaX=deltaX,this._cachedDeltaXCounter=0)}},{key:"_getIntendedAxis",value:function(eventData){return Math.abs(eventData.deltaXFromStart)>=Math.abs(eventData.deltaYFromStart)?InteractionServiceEnums.a.X:InteractionServiceEnums.a.Y}},{key:"_getDirection",value:function(eventData){return eventData.deltaXFromStart-this._cachedDeltaX<0?InteractionServiceEnums.d.Left:InteractionServiceEnums.d.Right}},{key:"_getEventData",value:function(event){var touch=event.changedTouches[0];return{deltaXFromStart:touch.clientX-this._startX,deltaYFromStart:touch.clientY-this._startY,eventX:touch.clientX,eventY:touch.clientY}}},{key:"_getEventTarget",value:function(event){return this._interactionStartTarget||this._getInteractibleFromElement(event.currentTarget)}},{key:"_getInteractibleFromElement",value:function(element){return this._registeredTargets.find(function(item){return item.element===element})}},{key:"_getEventOffsetX",value:function(event){var eventTarget=this._getEventTarget(event);return this._isMobile?event.changedTouches[0].clientX-eventTarget.element.getBoundingClientRect().left:event.offsetX}},{key:"_canDoSpecialInteraction",value:function(target,interaction){return target.allowedSpecialInteractions.includes(interaction)&&!target.disabledSpecialInteractions.includes(interaction)}},{key:"_executeInteraction",value:function(event,target,interaction){var interactionHandler=target.callbacks[interaction];Object(TypeUtils.b)(interactionHandler)&&interactionHandler(event),this._executeGlobalActions(interaction,event)}},{key:"_executeGlobalActions",value:function(interaction,event){var _a;null===(_a=this._globalActionConfig[interaction])||void 0===_a||_a.forEach(function(trigger){trigger.action(event)})}}]),InteractionService}()},function(module,__webpack_exports__,__webpack_require__){"use strict";var tslib_es6=__webpack_require__(31),Observable=__webpack_require__(38),Subscriber=__webpack_require__(40),Subscription=__webpack_require__(43),ObjectUnsubscribedError=__webpack_require__(68),SubjectSubscription_SubjectSubscription=function(_super){function SubjectSubscription(subject,subscriber){var _this=_super.call(this)||this;return _this.subject=subject,_this.subscriber=subscriber,_this.closed=!1,_this}return tslib_es6.a(SubjectSubscription,_super),SubjectSubscription.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var subject=this.subject,observers=subject.observers;if(this.subject=null,observers&&0!==observers.length&&!subject.isStopped&&!subject.closed){var subscriberIndex=observers.indexOf(this.subscriber);-1!==subscriberIndex&&observers.splice(subscriberIndex,1)}}},SubjectSubscription}(Subscription.a),rxSubscriber=__webpack_require__(71);__webpack_require__.d(__webpack_exports__,"a",function(){return Subject_Subject});var Subject_SubjectSubscriber=function(_super){function SubjectSubscriber(destination){var _this=_super.call(this,destination)||this;return _this.destination=destination,_this}return tslib_es6.a(SubjectSubscriber,_super),SubjectSubscriber}(Subscriber.a),Subject_Subject=function(_super){function Subject(){var _this=_super.call(this)||this;return _this.observers=[],_this.closed=!1,_this.isStopped=!1,_this.hasError=!1,_this.thrownError=null,_this}return tslib_es6.a(Subject,_super),Subject.prototype[rxSubscriber.a]=function(){return new Subject_SubjectSubscriber(this)},Subject.prototype.lift=function(operator){var subject=new Subject_AnonymousSubject(this,this);return subject.operator=operator,subject},Subject.prototype.next=function(value){if(this.closed)throw new ObjectUnsubscribedError.a;if(!this.isStopped)for(var observers=this.observers,len=observers.length,copy=observers.slice(),i=0;i<len;i++)copy[i].next(value)},Subject.prototype.error=function(err){if(this.closed)throw new ObjectUnsubscribedError.a;this.hasError=!0,this.thrownError=err,this.isStopped=!0;for(var observers=this.observers,len=observers.length,copy=observers.slice(),i=0;i<len;i++)copy[i].error(err);this.observers.length=0},Subject.prototype.complete=function(){if(this.closed)throw new ObjectUnsubscribedError.a;this.isStopped=!0;for(var observers=this.observers,len=observers.length,copy=observers.slice(),i=0;i<len;i++)copy[i].complete();this.observers.length=0},Subject.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},Subject.prototype._trySubscribe=function(subscriber){if(this.closed)throw new ObjectUnsubscribedError.a;return _super.prototype._trySubscribe.call(this,subscriber)},Subject.prototype._subscribe=function(subscriber){if(this.closed)throw new ObjectUnsubscribedError.a;return this.hasError?(subscriber.error(this.thrownError),Subscription.a.EMPTY):this.isStopped?(subscriber.complete(),Subscription.a.EMPTY):(this.observers.push(subscriber),new SubjectSubscription_SubjectSubscription(this,subscriber))},Subject.prototype.asObservable=function(){var observable=new Observable.a;return observable.source=this,observable},Subject.create=function(destination,source){return new Subject_AnonymousSubject(destination,source)},Subject}(Observable.a),Subject_AnonymousSubject=function(_super){function AnonymousSubject(destination,source){var _this=_super.call(this)||this;return _this.destination=destination,_this.source=source,_this}return tslib_es6.a(AnonymousSubject,_super),AnonymousSubject.prototype.next=function(value){var destination=this.destination;destination&&destination.next&&destination.next(value)},AnonymousSubject.prototype.error=function(err){var destination=this.destination;destination&&destination.error&&this.destination.error(err)},AnonymousSubject.prototype.complete=function(){var destination=this.destination;destination&&destination.complete&&this.destination.complete()},AnonymousSubject.prototype._subscribe=function(subscriber){return this.source?this.source.subscribe(subscriber):Subscription.a.EMPTY},AnonymousSubject}(Subject_Subject)},,function(module,exports,__webpack_require__){__webpack_require__(223),__webpack_require__(227),__webpack_require__(233),__webpack_require__(239),__webpack_require__(243),__webpack_require__(247),__webpack_require__(248),__webpack_require__(259),module.exports=__webpack_require__(304)},function(module,exports,__webpack_require__){__webpack_require__(224);"undefined"==typeof Promise&&(Promise=__webpack_require__(131),__webpack_require__(225)),__webpack_require__(226)},function(module,exports,__webpack_require__){"use strict";var rawAsap=__webpack_require__(130),freeTasks=[],pendingErrors=[],requestErrorThrow=rawAsap.makeRequestCallFromTimer(function(){if(pendingErrors.length)throw pendingErrors.shift()});function asap(task){var rawTask;(rawTask=freeTasks.length?freeTasks.pop():new RawTask).task=task,rawAsap(rawTask)}function RawTask(){this.task=null}module.exports=asap,RawTask.prototype.call=function(){try{this.task.call()}catch(error){asap.onerror?asap.onerror(error):(pendingErrors.push(error),requestErrorThrow())}finally{this.task=null,freeTasks[freeTasks.length]=this}}},function(module,exports,__webpack_require__){"use strict";var Promise=__webpack_require__(131);module.exports=Promise;var TRUE=valuePromise(!0),FALSE=valuePromise(!1),NULL=valuePromise(null),UNDEFINED=valuePromise(void 0),ZERO=valuePromise(0),EMPTYSTRING=valuePromise("");function valuePromise(value){var p=new Promise(Promise._0);return p._V=1,p._W=value,p}Promise.resolve=function(value){if(value instanceof Promise)return value;if(null===value)return NULL;if(void 0===value)return UNDEFINED;if(!0===value)return TRUE;if(!1===value)return FALSE;if(0===value)return ZERO;if(""===value)return EMPTYSTRING;if("object"==typeof value||"function"==typeof value)try{var then=value.then;if("function"==typeof then)return new Promise(then.bind(value))}catch(ex){return new Promise(function(resolve,reject){reject(ex)})}return valuePromise(value)};var iterableToArray=function(iterable){return"function"==typeof Array.from?(iterableToArray=Array.from,Array.from(iterable)):(iterableToArray=function(x){return Array.prototype.slice.call(x)},Array.prototype.slice.call(iterable))};Promise.all=function(arr){var args=iterableToArray(arr);return new Promise(function(resolve,reject){if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){if(val&&("object"==typeof val||"function"==typeof val)){if(val instanceof Promise&&val.then===Promise.prototype.then){for(;3===val._V;)val=val._W;return 1===val._V?res(i,val._W):(2===val._V&&reject(val._W),void val.then(function(val){res(i,val)},reject))}var then=val.then;if("function"==typeof then)return void new Promise(then.bind(val)).then(function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}for(var i=0;i<args.length;i++)res(i,args[i])})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){iterableToArray(values).forEach(function(value){Promise.resolve(value).then(resolve,reject)})})},Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)}},function(module,exports){"function"!=typeof Promise.prototype.done&&(Promise.prototype.done=function(onFulfilled,onRejected){(arguments.length?this.then.apply(this,arguments):this).then(null,function(err){setTimeout(function(){throw err},0)})})},function(module,exports,__webpack_require__){var assign=__webpack_require__(228);__webpack_require__(74)({target:"Object",stat:!0,forced:Object.assign!==assign},{assign:assign})},function(module,exports,__webpack_require__){"use strict";var objectKeys=__webpack_require__(87),getOwnPropertySymbolsModule=__webpack_require__(88),propertyIsEnumerableModule=__webpack_require__(89),toObject=__webpack_require__(114),IndexedObject=__webpack_require__(110),nativeAssign=Object.assign;module.exports=!nativeAssign||__webpack_require__(59)(function(){var A={},B={},symbol=Symbol();return A[symbol]=7,"abcdefghijklmnopqrst".split("").forEach(function(chr){B[chr]=chr}),7!=nativeAssign({},A)[symbol]||"abcdefghijklmnopqrst"!=objectKeys(nativeAssign({},B)).join("")})?function(target,source){for(var T=toObject(target),argumentsLength=arguments.length,index=1,getOwnPropertySymbols=getOwnPropertySymbolsModule.f,propertyIsEnumerable=propertyIsEnumerableModule.f;argumentsLength>index;)for(var key,S=IndexedObject(arguments[index++]),keys=getOwnPropertySymbols?objectKeys(S).concat(getOwnPropertySymbols(S)):objectKeys(S),length=keys.length,j=0;length>j;)propertyIsEnumerable.call(S,key=keys[j++])&&(T[key]=S[key]);return T}:nativeAssign},function(module,exports,__webpack_require__){var toInteger=__webpack_require__(135),max=Math.max,min=Math.min;module.exports=function(index,length){var integer=toInteger(index);return integer<0?max(integer+length,0):min(integer,length)}},function(module,exports,__webpack_require__){var nativeFunctionToString=__webpack_require__(138),WeakMap=__webpack_require__(48).WeakMap;module.exports="function"==typeof WeakMap&&/native code/.test(nativeFunctionToString.call(WeakMap))},function(module,exports,__webpack_require__){var has=__webpack_require__(58),ownKeys=__webpack_require__(232),getOwnPropertyDescriptorModule=__webpack_require__(115),definePropertyModule=__webpack_require__(62);module.exports=function(target,source){for(var keys=ownKeys(source),defineProperty=definePropertyModule.f,getOwnPropertyDescriptor=getOwnPropertyDescriptorModule.f,i=0;i<keys.length;i++){var key=keys[i];has(target,key)||defineProperty(target,key,getOwnPropertyDescriptor(source,key))}}},function(module,exports,__webpack_require__){var getOwnPropertyNamesModule=__webpack_require__(118),getOwnPropertySymbolsModule=__webpack_require__(88),anObject=__webpack_require__(67),Reflect=__webpack_require__(48).Reflect;module.exports=Reflect&&Reflect.ownKeys||function(it){var keys=getOwnPropertyNamesModule.f(anObject(it)),getOwnPropertySymbols=getOwnPropertySymbolsModule.f;return getOwnPropertySymbols?keys.concat(getOwnPropertySymbols(it)):keys}},function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(48),has=__webpack_require__(58),DESCRIPTORS=__webpack_require__(65),IS_PURE=__webpack_require__(91),$export=__webpack_require__(74),redefine=__webpack_require__(82),hiddenKeys=__webpack_require__(81),fails=__webpack_require__(59),shared=__webpack_require__(83),setToStringTag=__webpack_require__(95),uid=__webpack_require__(94),wellKnownSymbol=__webpack_require__(54),wrappedWellKnownSymbolModule=__webpack_require__(141),defineWellKnownSymbol=__webpack_require__(234),enumKeys=__webpack_require__(235),isArray=__webpack_require__(143),anObject=__webpack_require__(67),isObject=__webpack_require__(60),toIndexedObject=__webpack_require__(73),toPrimitive=__webpack_require__(116),createPropertyDescriptor=__webpack_require__(90),nativeObjectCreate=__webpack_require__(96),getOwnPropertyNamesExternal=__webpack_require__(238),getOwnPropertyDescriptorModule=__webpack_require__(115),definePropertyModule=__webpack_require__(62),propertyIsEnumerableModule=__webpack_require__(89),hide=__webpack_require__(66),objectKeys=__webpack_require__(87),HIDDEN=__webpack_require__(93)("hidden"),InternalStateModule=__webpack_require__(92),setInternalState=InternalStateModule.set,getInternalState=InternalStateModule.getterFor("Symbol"),nativeGetOwnPropertyDescriptor=getOwnPropertyDescriptorModule.f,nativeDefineProperty=definePropertyModule.f,nativeGetOwnPropertyNames=getOwnPropertyNamesExternal.f,$Symbol=global.Symbol,JSON=global.JSON,nativeJSONStringify=JSON&&JSON.stringify,TO_PRIMITIVE=wellKnownSymbol("toPrimitive"),nativePropertyIsEnumerable=propertyIsEnumerableModule.f,SymbolRegistry=shared("symbol-registry"),AllSymbols=shared("symbols"),ObjectPrototypeSymbols=shared("op-symbols"),WellKnownSymbolsStore=shared("wks"),ObjectPrototype=Object.prototype,QObject=global.QObject,NATIVE_SYMBOL=__webpack_require__(140),USE_SETTER=!QObject||!QObject.prototype||!QObject.prototype.findChild,setSymbolDescriptor=DESCRIPTORS&&fails(function(){return 7!=nativeObjectCreate(nativeDefineProperty({},"a",{get:function(){return nativeDefineProperty(this,"a",{value:7}).a}})).a})?function(it,key,D){var ObjectPrototypeDescriptor=nativeGetOwnPropertyDescriptor(ObjectPrototype,key);ObjectPrototypeDescriptor&&delete ObjectPrototype[key],nativeDefineProperty(it,key,D),ObjectPrototypeDescriptor&&it!==ObjectPrototype&&nativeDefineProperty(ObjectPrototype,key,ObjectPrototypeDescriptor)}:nativeDefineProperty,wrap=function(tag,description){var symbol=AllSymbols[tag]=nativeObjectCreate($Symbol.prototype);return setInternalState(symbol,{type:"Symbol",tag:tag,description:description}),DESCRIPTORS||(symbol.description=description),symbol},isSymbol=NATIVE_SYMBOL&&"symbol"==typeof $Symbol.iterator?function(it){return"symbol"==typeof it}:function(it){return Object(it)instanceof $Symbol},$defineProperty=function(it,key,D){return it===ObjectPrototype&&$defineProperty(ObjectPrototypeSymbols,key,D),anObject(it),key=toPrimitive(key,!0),anObject(D),has(AllSymbols,key)?(D.enumerable?(has(it,HIDDEN)&&it[HIDDEN][key]&&(it[HIDDEN][key]=!1),D=nativeObjectCreate(D,{enumerable:createPropertyDescriptor(0,!1)})):(has(it,HIDDEN)||nativeDefineProperty(it,HIDDEN,createPropertyDescriptor(1,{})),it[HIDDEN][key]=!0),setSymbolDescriptor(it,key,D)):nativeDefineProperty(it,key,D)},$defineProperties=function(it,P){anObject(it);for(var key,keys=enumKeys(P=toIndexedObject(P)),i=0,l=keys.length;l>i;)$defineProperty(it,key=keys[i++],P[key]);return it},$propertyIsEnumerable=function(key){var E=nativePropertyIsEnumerable.call(this,key=toPrimitive(key,!0));return!(this===ObjectPrototype&&has(AllSymbols,key)&&!has(ObjectPrototypeSymbols,key))&&(!(E||!has(this,key)||!has(AllSymbols,key)||has(this,HIDDEN)&&this[HIDDEN][key])||E)},$getOwnPropertyDescriptor=function(it,key){if(it=toIndexedObject(it),key=toPrimitive(key,!0),it!==ObjectPrototype||!has(AllSymbols,key)||has(ObjectPrototypeSymbols,key)){var D=nativeGetOwnPropertyDescriptor(it,key);return!D||!has(AllSymbols,key)||has(it,HIDDEN)&&it[HIDDEN][key]||(D.enumerable=!0),D}},$getOwnPropertyNames=function(it){for(var key,names=nativeGetOwnPropertyNames(toIndexedObject(it)),result=[],i=0;names.length>i;)has(AllSymbols,key=names[i++])||has(hiddenKeys,key)||result.push(key);return result},$getOwnPropertySymbols=function(it){for(var key,IS_OP=it===ObjectPrototype,names=nativeGetOwnPropertyNames(IS_OP?ObjectPrototypeSymbols:toIndexedObject(it)),result=[],i=0;names.length>i;)!has(AllSymbols,key=names[i++])||IS_OP&&!has(ObjectPrototype,key)||result.push(AllSymbols[key]);return result};NATIVE_SYMBOL||(redefine(($Symbol=function(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor");var description=void 0===arguments[0]?void 0:String(arguments[0]),tag=uid(description),setter=function(value){this===ObjectPrototype&&setter.call(ObjectPrototypeSymbols,value),has(this,HIDDEN)&&has(this[HIDDEN],tag)&&(this[HIDDEN][tag]=!1),setSymbolDescriptor(this,tag,createPropertyDescriptor(1,value))};return DESCRIPTORS&&USE_SETTER&&setSymbolDescriptor(ObjectPrototype,tag,{configurable:!0,set:setter}),wrap(tag,description)}).prototype,"toString",function(){return getInternalState(this).tag}),propertyIsEnumerableModule.f=$propertyIsEnumerable,definePropertyModule.f=$defineProperty,getOwnPropertyDescriptorModule.f=$getOwnPropertyDescriptor,__webpack_require__(118).f=getOwnPropertyNamesExternal.f=$getOwnPropertyNames,__webpack_require__(88).f=$getOwnPropertySymbols,DESCRIPTORS&&(nativeDefineProperty($Symbol.prototype,"description",{configurable:!0,get:function(){return getInternalState(this).description}}),IS_PURE||redefine(ObjectPrototype,"propertyIsEnumerable",$propertyIsEnumerable,{unsafe:!0})),wrappedWellKnownSymbolModule.f=function(name){return wrap(wellKnownSymbol(name),name)}),$export({global:!0,wrap:!0,forced:!NATIVE_SYMBOL,sham:!NATIVE_SYMBOL},{Symbol:$Symbol});for(var wellKnownSymbols=objectKeys(WellKnownSymbolsStore),k=0;wellKnownSymbols.length>k;)defineWellKnownSymbol(wellKnownSymbols[k++]);$export({target:"Symbol",stat:!0,forced:!NATIVE_SYMBOL},{for:function(key){return has(SymbolRegistry,key+="")?SymbolRegistry[key]:SymbolRegistry[key]=$Symbol(key)},keyFor:function(sym){if(!isSymbol(sym))throw TypeError(sym+" is not a symbol");for(var key in SymbolRegistry)if(SymbolRegistry[key]===sym)return key},useSetter:function(){USE_SETTER=!0},useSimple:function(){USE_SETTER=!1}}),$export({target:"Object",stat:!0,forced:!NATIVE_SYMBOL,sham:!DESCRIPTORS},{create:function(it,P){return void 0===P?nativeObjectCreate(it):$defineProperties(nativeObjectCreate(it),P)},defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor}),$export({target:"Object",stat:!0,forced:!NATIVE_SYMBOL},{getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols}),JSON&&$export({target:"JSON",stat:!0,forced:!NATIVE_SYMBOL||fails(function(){var symbol=$Symbol();return"[null]"!=nativeJSONStringify([symbol])||"{}"!=nativeJSONStringify({a:symbol})||"{}"!=nativeJSONStringify(Object(symbol))})},{stringify:function(it){for(var replacer,$replacer,args=[it],i=1;arguments.length>i;)args.push(arguments[i++]);if($replacer=replacer=args[1],(isObject(replacer)||void 0!==it)&&!isSymbol(it))return isArray(replacer)||(replacer=function(key,value){if("function"==typeof $replacer&&(value=$replacer.call(this,key,value)),!isSymbol(value))return value}),args[1]=replacer,nativeJSONStringify.apply(JSON,args)}}),$Symbol.prototype[TO_PRIMITIVE]||hide($Symbol.prototype,TO_PRIMITIVE,$Symbol.prototype.valueOf),setToStringTag($Symbol,"Symbol"),hiddenKeys[HIDDEN]=!0},function(module,exports,__webpack_require__){var path=__webpack_require__(142),has=__webpack_require__(58),wrappedWellKnownSymbolModule=__webpack_require__(141),defineProperty=__webpack_require__(62).f;module.exports=function(NAME){var Symbol=path.Symbol||(path.Symbol={});has(Symbol,NAME)||defineProperty(Symbol,NAME,{value:wrappedWellKnownSymbolModule.f(NAME)})}},function(module,exports,__webpack_require__){var objectKeys=__webpack_require__(87),getOwnPropertySymbolsModule=__webpack_require__(88),propertyIsEnumerableModule=__webpack_require__(89);module.exports=function(it){var result=objectKeys(it),getOwnPropertySymbols=getOwnPropertySymbolsModule.f;if(getOwnPropertySymbols)for(var key,symbols=getOwnPropertySymbols(it),propertyIsEnumerable=propertyIsEnumerableModule.f,i=0;symbols.length>i;)propertyIsEnumerable.call(it,key=symbols[i++])&&result.push(key);return result}},function(module,exports,__webpack_require__){var DESCRIPTORS=__webpack_require__(65),definePropertyModule=__webpack_require__(62),anObject=__webpack_require__(67),objectKeys=__webpack_require__(87);module.exports=DESCRIPTORS?Object.defineProperties:function(O,Properties){anObject(O);for(var key,keys=objectKeys(Properties),length=keys.length,i=0;length>i;)definePropertyModule.f(O,key=keys[i++],Properties[key]);return O}},function(module,exports,__webpack_require__){var document=__webpack_require__(48).document;module.exports=document&&document.documentElement},function(module,exports,__webpack_require__){var toIndexedObject=__webpack_require__(73),nativeGetOwnPropertyNames=__webpack_require__(118).f,toString={}.toString,windowNames="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];module.exports.f=function(it){return windowNames&&"[object Window]"==toString.call(it)?function(it){try{return nativeGetOwnPropertyNames(it)}catch(error){return windowNames.slice()}}(it):nativeGetOwnPropertyNames(toIndexedObject(it))}},function(module,exports,__webpack_require__){"use strict";var toIndexedObject=__webpack_require__(73),addToUnscopables=__webpack_require__(119),Iterators=__webpack_require__(84),InternalStateModule=__webpack_require__(92),defineIterator=__webpack_require__(144),setInternalState=InternalStateModule.set,getInternalState=InternalStateModule.getterFor("Array Iterator");module.exports=defineIterator(Array,"Array",function(iterated,kind){setInternalState(this,{type:"Array Iterator",target:toIndexedObject(iterated),index:0,kind:kind})},function(){var state=getInternalState(this),target=state.target,kind=state.kind,index=state.index++;return!target||index>=target.length?(state.target=void 0,{value:void 0,done:!0}):"keys"==kind?{value:index,done:!1}:"values"==kind?{value:target[index],done:!1}:{value:[index,target[index]],done:!1}},"values"),Iterators.Arguments=Iterators.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries")},function(module,exports,__webpack_require__){"use strict";var IteratorPrototype=__webpack_require__(145).IteratorPrototype,create=__webpack_require__(96),createPropertyDescriptor=__webpack_require__(90),setToStringTag=__webpack_require__(95),Iterators=__webpack_require__(84),returnThis=function(){return this};module.exports=function(IteratorConstructor,NAME,next){var TO_STRING_TAG=NAME+" Iterator";return IteratorConstructor.prototype=create(IteratorPrototype,{next:createPropertyDescriptor(1,next)}),setToStringTag(IteratorConstructor,TO_STRING_TAG,!1,!0),Iterators[TO_STRING_TAG]=returnThis,IteratorConstructor}},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(59)(function(){function F(){}return F.prototype.constructor=null,Object.getPrototypeOf(new F)!==F.prototype})},function(module,exports,__webpack_require__){var isObject=__webpack_require__(60),anObject=__webpack_require__(67);module.exports=function(O,proto){if(anObject(O),!isObject(proto)&&null!==proto)throw TypeError("Can't set "+String(proto)+" as a prototype")}},function(module,exports,__webpack_require__){"use strict";var internalFind=__webpack_require__(244)(5),SKIPS_HOLES=!0;"find"in[]&&Array(1).find(function(){SKIPS_HOLES=!1}),__webpack_require__(74)({target:"Array",proto:!0,forced:SKIPS_HOLES},{find:function(callbackfn){return internalFind(this,callbackfn,arguments.length>1?arguments[1]:void 0)}}),__webpack_require__(119)("find")},function(module,exports,__webpack_require__){var bind=__webpack_require__(120),IndexedObject=__webpack_require__(110),toObject=__webpack_require__(114),toLength=__webpack_require__(112),arraySpeciesCreate=__webpack_require__(246);module.exports=function(TYPE,specificCreate){var IS_MAP=1==TYPE,IS_FILTER=2==TYPE,IS_SOME=3==TYPE,IS_EVERY=4==TYPE,IS_FIND_INDEX=6==TYPE,NO_HOLES=5==TYPE||IS_FIND_INDEX,create=specificCreate||arraySpeciesCreate;return function($this,callbackfn,that){for(var value,result,O=toObject($this),self=IndexedObject(O),boundFunction=bind(callbackfn,that,3),length=toLength(self.length),index=0,target=IS_MAP?create($this,length):IS_FILTER?create($this,0):void 0;length>index;index++)if((NO_HOLES||index in self)&&(result=boundFunction(value=self[index],index,O),TYPE))if(IS_MAP)target[index]=result;else if(result)switch(TYPE){case 3:return!0;case 5:return value;case 6:return index;case 2:target.push(value)}else if(IS_EVERY)return!1;return IS_FIND_INDEX?-1:IS_SOME||IS_EVERY?IS_EVERY:target}}},function(module,exports){module.exports=function(it){if("function"!=typeof it)throw TypeError(String(it)+" is not a function");return it}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(60),isArray=__webpack_require__(143),SPECIES=__webpack_require__(54)("species");module.exports=function(originalArray,length){var C;return isArray(originalArray)&&("function"!=typeof(C=originalArray.constructor)||C!==Array&&!isArray(C.prototype)?isObject(C)&&null===(C=C[SPECIES])&&(C=void 0):C=void 0),new(void 0===C?Array:C)(0===length?0:length)}},function(module,exports,__webpack_require__){"use strict";var internalIncludes=__webpack_require__(134)(!0);__webpack_require__(74)({target:"Array",proto:!0},{includes:function(el){return internalIncludes(this,el,arguments.length>1?arguments[1]:void 0)}}),__webpack_require__(119)("includes")},function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(148)("Map",function(get){return function(){return get(this,arguments.length>0?arguments[0]:void 0)}},__webpack_require__(152),!0)},function(module,exports,__webpack_require__){module.exports=!__webpack_require__(59)(function(){return Object.isExtensible(Object.preventExtensions({}))})},function(module,exports,__webpack_require__){var Iterators=__webpack_require__(84),ITERATOR=__webpack_require__(54)("iterator"),ArrayPrototype=Array.prototype;module.exports=function(it){return void 0!==it&&(Iterators.Array===it||ArrayPrototype[ITERATOR]===it)}},function(module,exports,__webpack_require__){var classof=__webpack_require__(252),ITERATOR=__webpack_require__(54)("iterator"),Iterators=__webpack_require__(84);module.exports=function(it){if(null!=it)return it[ITERATOR]||it["@@iterator"]||Iterators[classof(it)]}},function(module,exports,__webpack_require__){var classofRaw=__webpack_require__(111),TO_STRING_TAG=__webpack_require__(54)("toStringTag"),CORRECT_ARGUMENTS="Arguments"==classofRaw(function(){return arguments}());module.exports=function(it){var O,tag,result;return void 0===it?"Undefined":null===it?"Null":"string"==typeof(tag=function(it,key){try{return it[key]}catch(error){}}(O=Object(it),TO_STRING_TAG))?tag:CORRECT_ARGUMENTS?classofRaw(O):"Object"==(result=classofRaw(O))&&"function"==typeof O.callee?"Arguments":result}},function(module,exports,__webpack_require__){var anObject=__webpack_require__(67);module.exports=function(iterator,fn,value,ENTRIES){try{return ENTRIES?fn(anObject(value)[0],value[1]):fn(value)}catch(error){var returnMethod=iterator.return;throw void 0!==returnMethod&&anObject(returnMethod.call(iterator)),error}}},function(module,exports,__webpack_require__){var ITERATOR=__webpack_require__(54)("iterator"),SAFE_CLOSING=!1;try{var called=0,iteratorWithReturn={next:function(){return{done:!!called++}},return:function(){SAFE_CLOSING=!0}};iteratorWithReturn[ITERATOR]=function(){return this},Array.from(iteratorWithReturn,function(){throw 2})}catch(error){}module.exports=function(exec,SKIP_CLOSING){if(!SKIP_CLOSING&&!SAFE_CLOSING)return!1;var ITERATION_SUPPORT=!1;try{var object={};object[ITERATOR]=function(){return{next:function(){return{done:ITERATION_SUPPORT=!0}}}},exec(object)}catch(error){}return ITERATION_SUPPORT}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(60),setPrototypeOf=__webpack_require__(147);module.exports=function(that,target,C){var P,S=target.constructor;return S!==C&&"function"==typeof S&&(P=S.prototype)!==C.prototype&&isObject(P)&&setPrototypeOf&&setPrototypeOf(that,P),that}},function(module,exports,__webpack_require__){var redefine=__webpack_require__(82);module.exports=function(target,src,options){for(var key in src)redefine(target,key,src[key],options);return target}},function(module,exports,__webpack_require__){"use strict";var getBuiltIn=__webpack_require__(258),definePropertyModule=__webpack_require__(62),DESCRIPTORS=__webpack_require__(65),SPECIES=__webpack_require__(54)("species");module.exports=function(CONSTRUCTOR_NAME){var C=getBuiltIn(CONSTRUCTOR_NAME),defineProperty=definePropertyModule.f;DESCRIPTORS&&C&&!C[SPECIES]&&defineProperty(C,SPECIES,{configurable:!0,get:function(){return this}})}},function(module,exports,__webpack_require__){var path=__webpack_require__(142),global=__webpack_require__(48),aFunction=function(variable){return"function"==typeof variable?variable:void 0};module.exports=function(namespace,method){return arguments.length<2?aFunction(path[namespace])||aFunction(global[namespace]):path[namespace]&&path[namespace][method]||global[namespace]&&global[namespace][method]}},function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(148)("Set",function(get){return function(){return get(this,arguments.length>0?arguments[0]:void 0)}},__webpack_require__(152))},function(module,exports,__webpack_require__){"use strict";var protobuf=exports;function configure(){protobuf.util._configure(),protobuf.Writer._configure(protobuf.BufferWriter),protobuf.Reader._configure(protobuf.BufferReader)}protobuf.build="minimal",protobuf.Writer=__webpack_require__(153),protobuf.BufferWriter=__webpack_require__(269),protobuf.Reader=__webpack_require__(154),protobuf.BufferReader=__webpack_require__(270),protobuf.util=__webpack_require__(69),protobuf.rpc=__webpack_require__(271),protobuf.roots=__webpack_require__(273),protobuf.configure=configure,configure()},function(module,exports,__webpack_require__){"use strict";module.exports=function(fn,ctx){var params=new Array(arguments.length-1),offset=0,index=2,pending=!0;for(;index<arguments.length;)params[offset++]=arguments[index++];return new Promise(function(resolve,reject){params[offset]=function(err){if(pending)if(pending=!1,err)reject(err);else{for(var params=new Array(arguments.length-1),offset=0;offset<params.length;)params[offset++]=arguments[offset];resolve.apply(null,params)}};try{fn.apply(ctx||null,params)}catch(err){pending&&(pending=!1,reject(err))}})}},function(module,exports,__webpack_require__){"use strict";var base64=exports;base64.length=function(string){var p=string.length;if(!p)return 0;for(var n=0;--p%4>1&&"="===string.charAt(p);)++n;return Math.ceil(3*string.length)/4-n};for(var b64=new Array(64),s64=new Array(123),i=0;i<64;)s64[b64[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;base64.encode=function(buffer,start,end){for(var t,parts=null,chunk=[],i=0,j=0;start<end;){var b=buffer[start++];switch(j){case 0:chunk[i++]=b64[b>>2],t=(3&b)<<4,j=1;break;case 1:chunk[i++]=b64[t|b>>4],t=(15&b)<<2,j=2;break;case 2:chunk[i++]=b64[t|b>>6],chunk[i++]=b64[63&b],j=0}i>8191&&((parts||(parts=[])).push(String.fromCharCode.apply(String,chunk)),i=0)}return j&&(chunk[i++]=b64[t],chunk[i++]=61,1===j&&(chunk[i++]=61)),parts?(i&&parts.push(String.fromCharCode.apply(String,chunk.slice(0,i))),parts.join("")):String.fromCharCode.apply(String,chunk.slice(0,i))};base64.decode=function(string,buffer,offset){for(var t,start=offset,j=0,i=0;i<string.length;){var c=string.charCodeAt(i++);if(61===c&&j>1)break;if(void 0===(c=s64[c]))throw Error("invalid encoding");switch(j){case 0:t=c,j=1;break;case 1:buffer[offset++]=t<<2|(48&c)>>4,t=c,j=2;break;case 2:buffer[offset++]=(15&t)<<4|(60&c)>>2,t=c,j=3;break;case 3:buffer[offset++]=(3&t)<<6|c,j=0}}if(1===j)throw Error("invalid encoding");return offset-start},base64.test=function(string){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(string)}},function(module,exports,__webpack_require__){"use strict";function EventEmitter(){this._listeners={}}module.exports=EventEmitter,EventEmitter.prototype.on=function(evt,fn,ctx){return(this._listeners[evt]||(this._listeners[evt]=[])).push({fn:fn,ctx:ctx||this}),this},EventEmitter.prototype.off=function(evt,fn){if(void 0===evt)this._listeners={};else if(void 0===fn)this._listeners[evt]=[];else for(var listeners=this._listeners[evt],i=0;i<listeners.length;)listeners[i].fn===fn?listeners.splice(i,1):++i;return this},EventEmitter.prototype.emit=function(evt){var listeners=this._listeners[evt];if(listeners){for(var args=[],i=1;i<arguments.length;)args.push(arguments[i++]);for(i=0;i<listeners.length;)listeners[i].fn.apply(listeners[i++].ctx,args)}return this}},function(module,exports,__webpack_require__){"use strict";function factory(exports){return"undefined"!=typeof Float32Array?function(){var f32=new Float32Array([-0]),f8b=new Uint8Array(f32.buffer),le=128===f8b[3];function writeFloat_f32_cpy(val,buf,pos){f32[0]=val,buf[pos]=f8b[0],buf[pos+1]=f8b[1],buf[pos+2]=f8b[2],buf[pos+3]=f8b[3]}function writeFloat_f32_rev(val,buf,pos){f32[0]=val,buf[pos]=f8b[3],buf[pos+1]=f8b[2],buf[pos+2]=f8b[1],buf[pos+3]=f8b[0]}function readFloat_f32_cpy(buf,pos){return f8b[0]=buf[pos],f8b[1]=buf[pos+1],f8b[2]=buf[pos+2],f8b[3]=buf[pos+3],f32[0]}function readFloat_f32_rev(buf,pos){return f8b[3]=buf[pos],f8b[2]=buf[pos+1],f8b[1]=buf[pos+2],f8b[0]=buf[pos+3],f32[0]}exports.writeFloatLE=le?writeFloat_f32_cpy:writeFloat_f32_rev,exports.writeFloatBE=le?writeFloat_f32_rev:writeFloat_f32_cpy,exports.readFloatLE=le?readFloat_f32_cpy:readFloat_f32_rev,exports.readFloatBE=le?readFloat_f32_rev:readFloat_f32_cpy}():function(){function writeFloat_ieee754(writeUint,val,buf,pos){var sign=val<0?1:0;if(sign&&(val=-val),0===val)writeUint(1/val>0?0:2147483648,buf,pos);else if(isNaN(val))writeUint(2143289344,buf,pos);else if(val>3.4028234663852886e38)writeUint((sign<<31|2139095040)>>>0,buf,pos);else if(val<1.1754943508222875e-38)writeUint((sign<<31|Math.round(val/1.401298464324817e-45))>>>0,buf,pos);else{var exponent=Math.floor(Math.log(val)/Math.LN2);writeUint((sign<<31|exponent+127<<23|8388607&Math.round(val*Math.pow(2,-exponent)*8388608))>>>0,buf,pos)}}function readFloat_ieee754(readUint,buf,pos){var uint=readUint(buf,pos),sign=2*(uint>>31)+1,exponent=uint>>>23&255,mantissa=8388607&uint;return 255===exponent?mantissa?NaN:sign*(1/0):0===exponent?1.401298464324817e-45*sign*mantissa:sign*Math.pow(2,exponent-150)*(mantissa+8388608)}exports.writeFloatLE=writeFloat_ieee754.bind(null,writeUintLE),exports.writeFloatBE=writeFloat_ieee754.bind(null,writeUintBE),exports.readFloatLE=readFloat_ieee754.bind(null,readUintLE),exports.readFloatBE=readFloat_ieee754.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var f64=new Float64Array([-0]),f8b=new Uint8Array(f64.buffer),le=128===f8b[7];function writeDouble_f64_cpy(val,buf,pos){f64[0]=val,buf[pos]=f8b[0],buf[pos+1]=f8b[1],buf[pos+2]=f8b[2],buf[pos+3]=f8b[3],buf[pos+4]=f8b[4],buf[pos+5]=f8b[5],buf[pos+6]=f8b[6],buf[pos+7]=f8b[7]}function writeDouble_f64_rev(val,buf,pos){f64[0]=val,buf[pos]=f8b[7],buf[pos+1]=f8b[6],buf[pos+2]=f8b[5],buf[pos+3]=f8b[4],buf[pos+4]=f8b[3],buf[pos+5]=f8b[2],buf[pos+6]=f8b[1],buf[pos+7]=f8b[0]}function readDouble_f64_cpy(buf,pos){return f8b[0]=buf[pos],f8b[1]=buf[pos+1],f8b[2]=buf[pos+2],f8b[3]=buf[pos+3],f8b[4]=buf[pos+4],f8b[5]=buf[pos+5],f8b[6]=buf[pos+6],f8b[7]=buf[pos+7],f64[0]}function readDouble_f64_rev(buf,pos){return f8b[7]=buf[pos],f8b[6]=buf[pos+1],f8b[5]=buf[pos+2],f8b[4]=buf[pos+3],f8b[3]=buf[pos+4],f8b[2]=buf[pos+5],f8b[1]=buf[pos+6],f8b[0]=buf[pos+7],f64[0]}exports.writeDoubleLE=le?writeDouble_f64_cpy:writeDouble_f64_rev,exports.writeDoubleBE=le?writeDouble_f64_rev:writeDouble_f64_cpy,exports.readDoubleLE=le?readDouble_f64_cpy:readDouble_f64_rev,exports.readDoubleBE=le?readDouble_f64_rev:readDouble_f64_cpy}():function(){function writeDouble_ieee754(writeUint,off0,off1,val,buf,pos){var sign=val<0?1:0;if(sign&&(val=-val),0===val)writeUint(0,buf,pos+off0),writeUint(1/val>0?0:2147483648,buf,pos+off1);else if(isNaN(val))writeUint(0,buf,pos+off0),writeUint(2146959360,buf,pos+off1);else if(val>1.7976931348623157e308)writeUint(0,buf,pos+off0),writeUint((sign<<31|2146435072)>>>0,buf,pos+off1);else{var mantissa;if(val<2.2250738585072014e-308)writeUint((mantissa=val/5e-324)>>>0,buf,pos+off0),writeUint((sign<<31|mantissa/4294967296)>>>0,buf,pos+off1);else{var exponent=Math.floor(Math.log(val)/Math.LN2);1024===exponent&&(exponent=1023),writeUint(4503599627370496*(mantissa=val*Math.pow(2,-exponent))>>>0,buf,pos+off0),writeUint((sign<<31|exponent+1023<<20|1048576*mantissa&1048575)>>>0,buf,pos+off1)}}}function readDouble_ieee754(readUint,off0,off1,buf,pos){var lo=readUint(buf,pos+off0),hi=readUint(buf,pos+off1),sign=2*(hi>>31)+1,exponent=hi>>>20&2047,mantissa=4294967296*(1048575&hi)+lo;return 2047===exponent?mantissa?NaN:sign*(1/0):0===exponent?5e-324*sign*mantissa:sign*Math.pow(2,exponent-1075)*(mantissa+4503599627370496)}exports.writeDoubleLE=writeDouble_ieee754.bind(null,writeUintLE,0,4),exports.writeDoubleBE=writeDouble_ieee754.bind(null,writeUintBE,4,0),exports.readDoubleLE=readDouble_ieee754.bind(null,readUintLE,0,4),exports.readDoubleBE=readDouble_ieee754.bind(null,readUintBE,4,0)}(),exports}function writeUintLE(val,buf,pos){buf[pos]=255&val,buf[pos+1]=val>>>8&255,buf[pos+2]=val>>>16&255,buf[pos+3]=val>>>24}function writeUintBE(val,buf,pos){buf[pos]=val>>>24,buf[pos+1]=val>>>16&255,buf[pos+2]=val>>>8&255,buf[pos+3]=255&val}function readUintLE(buf,pos){return(buf[pos]|buf[pos+1]<<8|buf[pos+2]<<16|buf[pos+3]<<24)>>>0}function readUintBE(buf,pos){return(buf[pos]<<24|buf[pos+1]<<16|buf[pos+2]<<8|buf[pos+3])>>>0}module.exports=factory(factory)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(module,exports,__webpack_require__){"use strict";var utf8=exports;utf8.length=function(string){for(var len=0,c=0,i=0;i<string.length;++i)(c=string.charCodeAt(i))<128?len+=1:c<2048?len+=2:55296==(64512&c)&&56320==(64512&string.charCodeAt(i+1))?(++i,len+=4):len+=3;return len},utf8.read=function(buffer,start,end){if(end-start<1)return"";for(var t,parts=null,chunk=[],i=0;start<end;)(t=buffer[start++])<128?chunk[i++]=t:t>191&&t<224?chunk[i++]=(31&t)<<6|63&buffer[start++]:t>239&&t<365?(t=((7&t)<<18|(63&buffer[start++])<<12|(63&buffer[start++])<<6|63&buffer[start++])-65536,chunk[i++]=55296+(t>>10),chunk[i++]=56320+(1023&t)):chunk[i++]=(15&t)<<12|(63&buffer[start++])<<6|63&buffer[start++],i>8191&&((parts||(parts=[])).push(String.fromCharCode.apply(String,chunk)),i=0);return parts?(i&&parts.push(String.fromCharCode.apply(String,chunk.slice(0,i))),parts.join("")):String.fromCharCode.apply(String,chunk.slice(0,i))},utf8.write=function(string,buffer,offset){for(var c1,c2,start=offset,i=0;i<string.length;++i)(c1=string.charCodeAt(i))<128?buffer[offset++]=c1:c1<2048?(buffer[offset++]=c1>>6|192,buffer[offset++]=63&c1|128):55296==(64512&c1)&&56320==(64512&(c2=string.charCodeAt(i+1)))?(c1=65536+((1023&c1)<<10)+(1023&c2),++i,buffer[offset++]=c1>>18|240,buffer[offset++]=c1>>12&63|128,buffer[offset++]=c1>>6&63|128,buffer[offset++]=63&c1|128):(buffer[offset++]=c1>>12|224,buffer[offset++]=c1>>6&63|128,buffer[offset++]=63&c1|128);return offset-start}},function(module,exports,__webpack_require__){"use strict";module.exports=function(alloc,slice,size){var SIZE=size||8192,MAX=SIZE>>>1,slab=null,offset=SIZE;return function(size){if(size<1||size>MAX)return alloc(size);offset+size>SIZE&&(slab=alloc(SIZE),offset=0);var buf=slice.call(slab,offset,offset+=size);return 7&offset&&(offset=1+(7|offset)),buf}}},function(module,exports,__webpack_require__){"use strict";module.exports=LongBits;var util=__webpack_require__(69);function LongBits(lo,hi){this.lo=lo>>>0,this.hi=hi>>>0}var zero=LongBits.zero=new LongBits(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits.zeroHash="\0\0\0\0\0\0\0\0";LongBits.fromNumber=function(value){if(0===value)return zero;var sign=value<0;sign&&(value=-value);var lo=value>>>0,hi=(value-lo)/4294967296>>>0;return sign&&(hi=~hi>>>0,lo=~lo>>>0,++lo>4294967295&&(lo=0,++hi>4294967295&&(hi=0))),new LongBits(lo,hi)},LongBits.from=function(value){if("number"==typeof value)return LongBits.fromNumber(value);if(util.isString(value)){if(!util.Long)return LongBits.fromNumber(parseInt(value,10));value=util.Long.fromString(value)}return value.low||value.high?new LongBits(value.low>>>0,value.high>>>0):zero},LongBits.prototype.toNumber=function(unsigned){if(!unsigned&&this.hi>>>31){var lo=1+~this.lo>>>0,hi=~this.hi>>>0;return lo||(hi=hi+1>>>0),-(lo+4294967296*hi)}return this.lo+4294967296*this.hi},LongBits.prototype.toLong=function(unsigned){return util.Long?new util.Long(0|this.lo,0|this.hi,Boolean(unsigned)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(unsigned)}};var charCodeAt=String.prototype.charCodeAt;LongBits.fromHash=function(hash){return hash===zeroHash?zero:new LongBits((charCodeAt.call(hash,0)|charCodeAt.call(hash,1)<<8|charCodeAt.call(hash,2)<<16|charCodeAt.call(hash,3)<<24)>>>0,(charCodeAt.call(hash,4)|charCodeAt.call(hash,5)<<8|charCodeAt.call(hash,6)<<16|charCodeAt.call(hash,7)<<24)>>>0)},LongBits.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits.prototype.zzEncode=function(){var mask=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^mask)>>>0,this.lo=(this.lo<<1^mask)>>>0,this},LongBits.prototype.zzDecode=function(){var mask=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^mask)>>>0,this.hi=(this.hi>>>1^mask)>>>0,this},LongBits.prototype.length=function(){var part0=this.lo,part1=(this.lo>>>28|this.hi<<4)>>>0,part2=this.hi>>>24;return 0===part2?0===part1?part0<16384?part0<128?1:2:part0<2097152?3:4:part1<16384?part1<128?5:6:part1<2097152?7:8:part2<128?9:10}},function(module,exports,__webpack_require__){"use strict";module.exports=BufferWriter;var Writer=__webpack_require__(153);(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util=__webpack_require__(69);function BufferWriter(){Writer.call(this)}function writeStringBuffer(val,buf,pos){val.length<40?util.utf8.write(val,buf,pos):buf.utf8Write?buf.utf8Write(val,pos):buf.write(val,pos)}BufferWriter._configure=function(){BufferWriter.alloc=util._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util.Buffer&&util.Buffer.prototype instanceof Uint8Array&&"set"===util.Buffer.prototype.set.name?function(val,buf,pos){buf.set(val,pos)}:function(val,buf,pos){if(val.copy)val.copy(buf,pos,0,val.length);else for(var i=0;i<val.length;)buf[pos++]=val[i++]}},BufferWriter.prototype.bytes=function(value){util.isString(value)&&(value=util._Buffer_from(value,"base64"));var len=value.length>>>0;return this.uint32(len),len&&this._push(BufferWriter.writeBytesBuffer,len,value),this},BufferWriter.prototype.string=function(value){var len=util.Buffer.byteLength(value);return this.uint32(len),len&&this._push(writeStringBuffer,len,value),this},BufferWriter._configure()},function(module,exports,__webpack_require__){"use strict";module.exports=BufferReader;var Reader=__webpack_require__(154);(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util=__webpack_require__(69);function BufferReader(buffer){Reader.call(this,buffer)}BufferReader._configure=function(){util.Buffer&&(BufferReader.prototype._slice=util.Buffer.prototype.slice)},BufferReader.prototype.string=function(){var len=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+len,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+len,this.len))},BufferReader._configure()},function(module,exports,__webpack_require__){"use strict";exports.Service=__webpack_require__(272)},function(module,exports,__webpack_require__){"use strict";module.exports=Service;var util=__webpack_require__(69);function Service(rpcImpl,requestDelimited,responseDelimited){if("function"!=typeof rpcImpl)throw TypeError("rpcImpl must be a function");util.EventEmitter.call(this),this.rpcImpl=rpcImpl,this.requestDelimited=Boolean(requestDelimited),this.responseDelimited=Boolean(responseDelimited)}(Service.prototype=Object.create(util.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function rpcCall(method,requestCtor,responseCtor,request,callback){if(!request)throw TypeError("request must be specified");var self=this;if(!callback)return util.asPromise(rpcCall,self,method,requestCtor,responseCtor,request);if(self.rpcImpl)try{return self.rpcImpl(method,requestCtor[self.requestDelimited?"encodeDelimited":"encode"](request).finish(),function(err,response){if(err)return self.emit("error",err,method),callback(err);if(null!==response){if(!(response instanceof responseCtor))try{response=responseCtor[self.responseDelimited?"decodeDelimited":"decode"](response)}catch(err){return self.emit("error",err,method),callback(err)}return self.emit("data",response,method),callback(null,response)}self.end(!0)})}catch(err){return self.emit("error",err,method),void setTimeout(function(){callback(err)},0)}else setTimeout(function(){callback(Error("already ended"))},0)},Service.prototype.end=function(endedByRPC){return this.rpcImpl&&(endedByRPC||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(module,exports,__webpack_require__){"use strict";module.exports={}},function(module,exports){module.exports=function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}},function(module,exports){module.exports=function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}},function(module,exports){module.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(module,exports,__webpack_require__){"use strict";var r,__extends=this&&this.__extends||(r=function(t,o){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var o in t)t.hasOwnProperty(o)&&(r[o]=t[o])})(t,o)},function(t,o){function e(){this.constructor=t}r(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)});Object.defineProperty(exports,"__esModule",{value:!0});var DecodingError=function(r){function t(t){var o=r.call(this,t)||this;return o.name="DecodingError",o}return __extends(t,r),t}(Error);exports.DecodingError=DecodingError},function(module,exports,__webpack_require__){"use strict";var r,__extends=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n])})(t,n)},function(t,n){function o(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(exports,"__esModule",{value:!0});var EncodingError=function(r){function t(t){var n=r.call(this,t)||this;return n.name="EncodingError",n}return __extends(t,r),t}(Error);exports.EncodingError=EncodingError},function(module,exports,__webpack_require__){"use strict";var r,__extends=this&&this.__extends||(r=function(t,o){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var o in t)t.hasOwnProperty(o)&&(r[o]=t[o])})(t,o)},function(t,o){function e(){this.constructor=t}r(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)});Object.defineProperty(exports,"__esModule",{value:!0});var GVLError=function(r){function t(t){var o=r.call(this,t)||this;return o.name="GVLError",o}return __extends(t,r),t}(Error);exports.GVLError=GVLError},function(module,exports,__webpack_require__){"use strict";var r,__extends=this&&this.__extends||(r=function(t,o){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var o in t)t.hasOwnProperty(o)&&(r[o]=t[o])})(t,o)},function(t,o){function e(){this.constructor=t}r(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)});Object.defineProperty(exports,"__esModule",{value:!0});var TCModelError=function(r){function t(t,o,e){void 0===e&&(e="");var n=r.call(this,"invalid value "+o+" passed for "+t+" "+e)||this;return n.name="TCModelError",n}return __extends(t,r),t}(Error);exports.TCModelError=TCModelError},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ConsentLanguages=function(){function e(){}return e.prototype.has=function(n){return e.langSet.has(n)},e.prototype.forEach=function(n){e.langSet.forEach(n)},Object.defineProperty(e.prototype,"size",{get:function(){return e.langSet.size},enumerable:!0,configurable:!0}),e.langSet=new Set(["BG","CA","CS","DA","DE","EL","EN","ES","ET","FI","FR","HR","HU","IT","LT","LV","MT","NL","NO","PL","PT","RO","RU","SK","SL","SV","ZH"]),e}();exports.ConsentLanguages=ConsentLanguages},function(module,exports,__webpack_require__){"use strict";var e,__extends=this&&this.__extends||(e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)},function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)});Object.defineProperty(exports,"__esModule",{value:!0});var PurposeRestriction_1=__webpack_require__(159),BinarySearchTree_1=__webpack_require__(157),RestrictionType_1=__webpack_require__(123),PurposeRestrictionVector=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bitLength=0,t.map=new Map,t}return __extends(t,e),t.prototype.has=function(e){return this.map.has(e)},t.prototype.isOkToHave=function(e,t,r){var i,o=!0;if(null===(i=this.gvl)||void 0===i?void 0:i.vendors){var n=this.gvl.vendors[r];if(n)if(e===RestrictionType_1.RestrictionType.NOT_ALLOWED)o=n.legIntPurposes.includes(t)||n.purposes.includes(t);else if(n.flexiblePurposes.length)switch(e){case RestrictionType_1.RestrictionType.REQUIRE_CONSENT:o=n.flexiblePurposes.includes(t)&&n.legIntPurposes.includes(t);break;case RestrictionType_1.RestrictionType.REQUIRE_LI:o=n.flexiblePurposes.includes(t)&&n.purposes.includes(t)}else o=!1;else o=!1}return o},t.prototype.add=function(e,t){if(this.isOkToHave(t.restrictionType,t.purposeId,e)){var r=t.hash;this.has(r)||(this.map.set(r,new BinarySearchTree_1.BinarySearchTree),this.bitLength=0),this.map.get(r).add(e)}},t.prototype.getVendors=function(e){var t=[];if(e){var r=e.hash;this.has(r)&&(t=this.map.get(r).get())}else{var i=new Set;this.map.forEach(function(e){e.get().forEach(function(e){i.add(e)})}),t=Array.from(i)}return t},t.prototype.getRestrictionType=function(e,t){var r;return this.getRestrictions(e).forEach(function(e){e.purposeId===t&&(void 0===r||r>e.restrictionType)&&(r=e.restrictionType)}),r},t.prototype.vendorHasRestriction=function(e,t){for(var r=!1,i=this.getRestrictions(e),o=0;o<i.length&&!r;o++)r=t.isSameAs(i[o]);return r},t.prototype.getMaxVendorId=function(){var e=0;return this.map.forEach(function(t){e=Math.max(t.max(),e)}),e},t.prototype.getRestrictions=function(e){var t=[];return this.map.forEach(function(r,i){e?r.contains(e)&&t.push(PurposeRestriction_1.PurposeRestriction.unHash(i)):t.push(PurposeRestriction_1.PurposeRestriction.unHash(i))}),t},t.prototype.getPurposes=function(){var e=new Set;return this.map.forEach(function(t,r){e.add(PurposeRestriction_1.PurposeRestriction.unHash(r).purposeId)}),Array.from(e)},t.prototype.remove=function(e,t){var r=t.hash,i=this.map.get(r);i&&(i.remove(e),i.isEmpty()&&(this.map.delete(r),this.bitLength=0))},Object.defineProperty(t.prototype,"gvl",{get:function(){return this.gvl_},set:function(e){var t=this;this.gvl_||(this.gvl_=e,this.map.forEach(function(e,r){var i=PurposeRestriction_1.PurposeRestriction.unHash(r);e.get().forEach(function(r){t.isOkToHave(i.restrictionType,i.purposeId,r)||e.remove(r)})}))},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.map.size},Object.defineProperty(t.prototype,"numRestrictions",{get:function(){return this.map.size},enumerable:!0,configurable:!0}),t}(__webpack_require__(75).Cloneable);exports.PurposeRestrictionVector=PurposeRestrictionVector},function(module,exports,__webpack_require__){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0});var Segment_1=__webpack_require__(160),SegmentIDs=function(){function e(){}return e.ID_TO_KEY=[Segment_1.Segment.CORE,Segment_1.Segment.VENDORS_DISCLOSED,Segment_1.Segment.VENDORS_ALLOWED,Segment_1.Segment.PUBLISHER_TC],e.KEY_TO_ID=((_a={})[Segment_1.Segment.CORE]=0,_a[Segment_1.Segment.VENDORS_DISCLOSED]=1,_a[Segment_1.Segment.VENDORS_ALLOWED]=2,_a[Segment_1.Segment.PUBLISHER_TC]=3,_a),e}();exports.SegmentIDs=SegmentIDs},function(module,exports,__webpack_require__){"use strict";var t,__extends=this&&this.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),__generator=this&&this.__generator||function(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},__values=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(exports,"__esModule",{value:!0});var Cloneable_1=__webpack_require__(75),errors_1=__webpack_require__(51),Vector=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bitLength=0,e.maxId_=0,e.set_=new Set,e}return __extends(e,t),e.prototype[Symbol.iterator]=function(){var t;return __generator(this,function(e){switch(e.label){case 0:t=1,e.label=1;case 1:return t<=this.maxId?[4,[t,this.has(t)]]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})},e.prototype.values=function(){return this.set_.values()},Object.defineProperty(e.prototype,"maxId",{get:function(){return this.maxId_},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this.set_.has(t)},e.prototype.unset=function(t){var e=this;Array.isArray(t)?t.forEach(function(t){return e.unset(t)}):"object"==typeof t?this.unset(Object.keys(t).map(function(t){return+t})):(this.set_.delete(t),this.bitLength=0,t===this.maxId&&(this.maxId_=0,this.set_.forEach(function(t){e.maxId_=Math.max(e.maxId,t)})))},e.prototype.isIntMap=function(t){var e=this,r="object"==typeof t;return r&&Object.keys(t).every(function(r){var n=Number.isInteger(parseInt(r,10));return(n=n&&e.isValidNumber(t[r].id))&&void 0!==t[r].name})},e.prototype.isValidNumber=function(t){return parseInt(t,10)>0},e.prototype.isSet=function(t){var e=!1;return t instanceof Set&&(e=Array.from(t).every(this.isValidNumber)),e},e.prototype.set=function(t){var e=this;if(Array.isArray(t))t.forEach(function(t){return e.set(t)});else if(this.isSet(t))this.set(Array.from(t));else if(this.isIntMap(t))this.set(Object.keys(t).map(function(t){return+t}));else{if(!this.isValidNumber(t))throw new errors_1.TCModelError("set()",t,"must be positive integer array, positive integer, Set<number>, or IntMap");this.set_.add(t),this.maxId_=Math.max(this.maxId,t),this.bitLength=0}},e.prototype.empty=function(){this.set_=new Set},e.prototype.forEach=function(t){var e,r;try{for(var n=__values(this),o=n.next();!o.done;o=n.next()){var i=o.value;t(i[1],i[0])}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},Object.defineProperty(e.prototype,"size",{get:function(){return this.set_.size},enumerable:!0,configurable:!0}),e.prototype.setAll=function(t){this.set(t)},e}(Cloneable_1.Cloneable);exports.Vector=Vector},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Base64Url_1=__webpack_require__(156),BitLength_1=__webpack_require__(122),field_1=__webpack_require__(161),sequence_1=__webpack_require__(167),errors_1=__webpack_require__(51),Fields_1=__webpack_require__(158),model_1=__webpack_require__(55),SegmentEncoder=function(){function e(){}return e.encode=function(e,r){var n,i=this;try{n=this.fieldSequence[""+e.version][r]}catch(n){throw new errors_1.EncodingError("Unable to encode version: "+e.version+", segment: "+r)}var t="";return r!==model_1.Segment.CORE&&(t=field_1.IntEncoder.encode(model_1.SegmentIDs.KEY_TO_ID[r],BitLength_1.BitLength.segmentType)),n.forEach(function(n){var o=e[n],s=field_1.FieldEncoderMap[n],d=BitLength_1.BitLength[n];void 0===d&&i.isPublisherCustom(n)&&(d=+e[Fields_1.Fields.numCustomPurposes]);try{t+=s.encode(o,d)}catch(e){throw new errors_1.EncodingError("Error encoding "+r+"->"+n+": "+e.message)}}),Base64Url_1.Base64Url.encode(t)},e.decode=function(e,r,n){var i=this,t=Base64Url_1.Base64Url.decode(e),o=0;return n===model_1.Segment.CORE&&(r.version=field_1.IntEncoder.decode(t.substr(o,BitLength_1.BitLength[Fields_1.Fields.version]),BitLength_1.BitLength[Fields_1.Fields.version])),n!==model_1.Segment.CORE&&(o+=BitLength_1.BitLength.segmentType),this.fieldSequence[""+r.version][n].forEach(function(e){var n=field_1.FieldEncoderMap[e],s=BitLength_1.BitLength[e];if(void 0===s&&i.isPublisherCustom(e)&&(s=+r[Fields_1.Fields.numCustomPurposes]),0!==s){var d=t.substr(o,s);if(n===field_1.VendorVectorEncoder?r[e]=n.decode(d,r.version):r[e]=n.decode(d,s),Number.isInteger(s))o+=s;else{if(!Number.isInteger(r[e].bitLength))throw new errors_1.DecodingError(e);o+=r[e].bitLength}}}),r},e.isPublisherCustom=function(e){return 0===e.indexOf("publisherCustom")},e.fieldSequence=new sequence_1.FieldSequence,e}();exports.SegmentEncoder=SegmentEncoder},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var model_1=__webpack_require__(55),BooleanEncoder_1=__webpack_require__(85),DateEncoder_1=__webpack_require__(162),FixedVectorEncoder_1=__webpack_require__(124),IntEncoder_1=__webpack_require__(70),LangEncoder_1=__webpack_require__(163),PurposeRestrictionVectorEncoder_1=__webpack_require__(164),VendorVectorEncoder_1=__webpack_require__(165),FieldEncoderMap=function(){function e(){}var o,r,d,n,c,t,i,s,l,E,_,F,V,a,m,u,p,I,x,g,L,v,C,q,B,b;return o=model_1.Fields.version,r=model_1.Fields.created,d=model_1.Fields.lastUpdated,n=model_1.Fields.cmpId,c=model_1.Fields.cmpVersion,t=model_1.Fields.consentScreen,i=model_1.Fields.consentLanguage,s=model_1.Fields.vendorListVersion,l=model_1.Fields.policyVersion,E=model_1.Fields.isServiceSpecific,_=model_1.Fields.useNonStandardStacks,F=model_1.Fields.specialFeatureOptins,V=model_1.Fields.purposeConsents,a=model_1.Fields.purposeLegitimateInterests,m=model_1.Fields.purposeOneTreatment,u=model_1.Fields.publisherCountryCode,p=model_1.Fields.vendorConsents,I=model_1.Fields.vendorLegitimateInterests,x=model_1.Fields.publisherRestrictions,g=model_1.Fields.vendorsDisclosed,L=model_1.Fields.vendorsAllowed,v=model_1.Fields.publisherConsents,C=model_1.Fields.publisherLegitimateInterests,q=model_1.Fields.numCustomPurposes,B=model_1.Fields.publisherCustomConsents,b=model_1.Fields.publisherCustomLegitimateInterests,e[o]=IntEncoder_1.IntEncoder,e[r]=DateEncoder_1.DateEncoder,e[d]=DateEncoder_1.DateEncoder,e[n]=IntEncoder_1.IntEncoder,e[c]=IntEncoder_1.IntEncoder,e[t]=IntEncoder_1.IntEncoder,e[i]=LangEncoder_1.LangEncoder,e[s]=IntEncoder_1.IntEncoder,e[l]=IntEncoder_1.IntEncoder,e[E]=BooleanEncoder_1.BooleanEncoder,e[_]=BooleanEncoder_1.BooleanEncoder,e[F]=FixedVectorEncoder_1.FixedVectorEncoder,e[V]=FixedVectorEncoder_1.FixedVectorEncoder,e[a]=FixedVectorEncoder_1.FixedVectorEncoder,e[m]=BooleanEncoder_1.BooleanEncoder,e[u]=LangEncoder_1.LangEncoder,e[p]=VendorVectorEncoder_1.VendorVectorEncoder,e[I]=VendorVectorEncoder_1.VendorVectorEncoder,e[x]=PurposeRestrictionVectorEncoder_1.PurposeRestrictionVectorEncoder,e.segmentType=IntEncoder_1.IntEncoder,e[g]=VendorVectorEncoder_1.VendorVectorEncoder,e[L]=VendorVectorEncoder_1.VendorVectorEncoder,e[v]=FixedVectorEncoder_1.FixedVectorEncoder,e[C]=FixedVectorEncoder_1.FixedVectorEncoder,e[q]=IntEncoder_1.IntEncoder,e[B]=FixedVectorEncoder_1.FixedVectorEncoder,e[b]=FixedVectorEncoder_1.FixedVectorEncoder,e}();exports.FieldEncoderMap=FieldEncoderMap},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var model_1=__webpack_require__(55);exports.FieldSequence=function(){var e,d;this[1]=((e={})[model_1.Segment.CORE]=[model_1.Fields.version,model_1.Fields.created,model_1.Fields.lastUpdated,model_1.Fields.cmpId,model_1.Fields.cmpVersion,model_1.Fields.consentScreen,model_1.Fields.consentLanguage,model_1.Fields.vendorListVersion,model_1.Fields.purposeConsents,model_1.Fields.vendorConsents],e),this[2]=((d={})[model_1.Segment.CORE]=[model_1.Fields.version,model_1.Fields.created,model_1.Fields.lastUpdated,model_1.Fields.cmpId,model_1.Fields.cmpVersion,model_1.Fields.consentScreen,model_1.Fields.consentLanguage,model_1.Fields.vendorListVersion,model_1.Fields.policyVersion,model_1.Fields.isServiceSpecific,model_1.Fields.useNonStandardStacks,model_1.Fields.specialFeatureOptins,model_1.Fields.purposeConsents,model_1.Fields.purposeLegitimateInterests,model_1.Fields.purposeOneTreatment,model_1.Fields.publisherCountryCode,model_1.Fields.vendorConsents,model_1.Fields.vendorLegitimateInterests,model_1.Fields.publisherRestrictions],d[model_1.Segment.PUBLISHER_TC]=[model_1.Fields.publisherConsents,model_1.Fields.publisherLegitimateInterests,model_1.Fields.numCustomPurposes,model_1.Fields.publisherCustomConsents,model_1.Fields.publisherCustomLegitimateInterests],d[model_1.Segment.VENDORS_ALLOWED]=[model_1.Fields.vendorsAllowed],d[model_1.Segment.VENDORS_DISCLOSED]=[model_1.Fields.vendorsDisclosed],d)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var model_1=__webpack_require__(55);exports.SegmentSequence=function(e,s){if(this[1]=[model_1.Segment.CORE],this[2]=[model_1.Segment.CORE],2===e.version)if(e.isServiceSpecific)this[2].push(model_1.Segment.PUBLISHER_TC);else{var t=!(!s||!s.isForVendors);t&&!0!==e[model_1.Fields.supportOOB]||this[2].push(model_1.Segment.VENDORS_DISCLOSED),t&&(e[model_1.Fields.supportOOB]&&e[model_1.Fields.vendorsAllowed].size>0&&this[2].push(model_1.Segment.VENDORS_ALLOWED),this[2].push(model_1.Segment.PUBLISHER_TC))}}},function(module,exports,__webpack_require__){"use strict";var __values=this&&this.__values||function(e){var r="function"==typeof Symbol&&Symbol.iterator,o=r&&e[r],t=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=this&&this.__read||function(e,r){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var t,n,i=o.call(e),s=[];try{for(;(void 0===r||r-- >0)&&!(t=i.next()).done;)s.push(t.value)}catch(e){n={error:e}}finally{try{t&&!t.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s};Object.defineProperty(exports,"__esModule",{value:!0});var errors_1=__webpack_require__(51),model_1=__webpack_require__(55),SemanticPreEncoder=function(){function e(){}return e.process=function(e,r){var o,t,n=e.gvl;if(!n)throw new errors_1.EncodingError("Unable to encode TCModel without a GVL");if(!n.isReady)throw new errors_1.EncodingError("Unable to encode TCModel tcModel.gvl.readyPromise is not resolved");(e=e.clone()).consentLanguage=n.language.toUpperCase(),(null===(o=r)||void 0===o?void 0:o.version)>0&&(null===(t=r)||void 0===t?void 0:t.version)<=this.processor.length?e.version=r.version:e.version=this.processor.length;var i=e.version-1;if(!this.processor[i])throw new errors_1.EncodingError("Invalid version: "+e.version);return this.processor[i](e,n)},e.processor=[function(e){return e},function(e,r){var o,t,n,i;e.publisherRestrictions.gvl=r,e.purposeLegitimateInterests.unset(1);var s=new Map;s.set("legIntPurposes",e.vendorLegitimateInterests),s.set("purposes",e.vendorConsents);try{for(var l=__values(s),a=l.next();!a.done;a=l.next()){var u=__read(a.value,2),c=u[0],v=u[1];try{for(var d=(n=void 0,__values(v.values())),f=d.next();!f.done;f=d.next()){var p=f.value,h=r.vendors[p];if(!h||h.deletedDate)v.unset(p);else if(0===h[c].length)if(e.isServiceSpecific)if(0===h.flexiblePurposes.length)v.unset(p);else{for(var y=e.publisherRestrictions.getRestrictions(p),_=!1,g=0,m=y.length;g<m&&!_;g++)_=y[g].restrictionType===model_1.RestrictionType.REQUIRE_CONSENT&&"purposes"===c||y[g].restrictionType===model_1.RestrictionType.REQUIRE_LI&&"legIntPurposes"===c;_||v.unset(p)}else v.unset(p)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}}}catch(e){o={error:e}}finally{try{a&&!a.done&&(t=l.return)&&t.call(l)}finally{if(o)throw o.error}}return e.vendorsDisclosed.set(r.vendors),e}],e}();exports.SemanticPreEncoder=SemanticPreEncoder},function(module,exports,__webpack_require__){"use strict";var e,__extends=this&&this.__extends||(e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)},function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)});Object.defineProperty(exports,"__esModule",{value:!0});var Cloneable_1=__webpack_require__(75),errors_1=__webpack_require__(51),GVL_1=__webpack_require__(291),model_1=__webpack_require__(55),TCModel=function(e){function t(t){var n=e.call(this)||this;return n.isServiceSpecific_=!1,n.supportOOB_=!0,n.useNonStandardStacks_=!1,n.purposeOneTreatment_=!1,n.publisherCountryCode_="AA",n.version_=2,n.consentScreen_=0,n.policyVersion_=2,n.consentLanguage_="EN",n.cmpId_=0,n.cmpVersion_=0,n.vendorListVersion_=0,n.numCustomPurposes_=0,n.specialFeatureOptins=new model_1.Vector,n.purposeConsents=new model_1.Vector,n.purposeLegitimateInterests=new model_1.Vector,n.publisherConsents=new model_1.Vector,n.publisherLegitimateInterests=new model_1.Vector,n.publisherCustomConsents=new model_1.Vector,n.publisherCustomLegitimateInterests=new model_1.Vector,n.vendorConsents=new model_1.Vector,n.vendorLegitimateInterests=new model_1.Vector,n.vendorsDisclosed=new model_1.Vector,n.vendorsAllowed=new model_1.Vector,n.publisherRestrictions=new model_1.PurposeRestrictionVector,t&&(n.gvl=t),n.created=new Date,n.updated(),n}return __extends(t,e),Object.defineProperty(t.prototype,"gvl",{get:function(){return this.gvl_},set:function(e){GVL_1.GVL.isInstanceOf(e)||(e=new GVL_1.GVL(e)),this.gvl_=e,this.publisherRestrictions.gvl=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cmpId",{get:function(){return this.cmpId_},set:function(e){if(!(Number.isInteger(+e)&&e>1))throw new errors_1.TCModelError("cmpId",e);this.cmpId_=+e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cmpVersion",{get:function(){return this.cmpVersion_},set:function(e){if(!(Number.isInteger(+e)&&e>-1))throw new errors_1.TCModelError("cmpVersion",e);this.cmpVersion_=+e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"consentScreen",{get:function(){return this.consentScreen_},set:function(e){if(!(Number.isInteger(+e)&&e>-1))throw new errors_1.TCModelError("consentScreen",e);this.consentScreen_=+e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"consentLanguage",{get:function(){return this.consentLanguage_},set:function(e){this.consentLanguage_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"publisherCountryCode",{get:function(){return this.publisherCountryCode_},set:function(e){if(!/^([A-z]){2}$/.test(e))throw new errors_1.TCModelError("publisherCountryCode",e);this.publisherCountryCode_=e.toUpperCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vendorListVersion",{get:function(){return this.gvl?this.gvl.vendorListVersion:this.vendorListVersion_},set:function(e){if((e=+e>>0)<0)throw new errors_1.TCModelError("vendorListVersion",e);this.vendorListVersion_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"policyVersion",{get:function(){return this.gvl?this.gvl.tcfPolicyVersion:this.policyVersion_},set:function(e){if(this.policyVersion_=parseInt(e,10),this.policyVersion_<0)throw new errors_1.TCModelError("policyVersion",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this.version_},set:function(e){this.version_=parseInt(e,10)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isServiceSpecific",{get:function(){return this.isServiceSpecific_},set:function(e){this.isServiceSpecific_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useNonStandardStacks",{get:function(){return this.useNonStandardStacks_},set:function(e){this.useNonStandardStacks_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"supportOOB",{get:function(){return this.supportOOB_},set:function(e){this.supportOOB_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"purposeOneTreatment",{get:function(){return this.purposeOneTreatment_},set:function(e){this.purposeOneTreatment_=e},enumerable:!0,configurable:!0}),t.prototype.setAllVendorConsents=function(){this.vendorConsents.set(this.gvl.vendors)},t.prototype.unsetAllVendorConsents=function(){this.vendorConsents.empty()},t.prototype.setAllVendorsDisclosed=function(){this.vendorsDisclosed.set(this.gvl.vendors)},t.prototype.unsetAllVendorsDisclosed=function(){this.vendorsDisclosed.empty()},t.prototype.setAllVendorsAllowed=function(){this.vendorsAllowed.set(this.gvl.vendors)},t.prototype.unsetAllVendorsAllowed=function(){this.vendorsAllowed.empty()},t.prototype.setAllVendorLegitimateInterests=function(){this.vendorLegitimateInterests.set(this.gvl.vendors)},t.prototype.unsetAllVendorLegitimateInterests=function(){this.vendorLegitimateInterests.empty()},t.prototype.setAllPurposeConsents=function(){this.purposeConsents.set(this.gvl.purposes)},t.prototype.unsetAllPurposeConsents=function(){this.purposeConsents.empty()},t.prototype.setAllPurposeLegitimateInterests=function(){this.purposeLegitimateInterests.set(this.gvl.purposes)},t.prototype.unsetAllPurposeLegitimateInterests=function(){this.purposeLegitimateInterests.empty()},t.prototype.setAllSpecialFeatureOptins=function(){this.specialFeatureOptins.set(this.gvl.specialFeatures)},t.prototype.unsetAllSpecialFeatureOptins=function(){this.specialFeatureOptins.empty()},t.prototype.setAll=function(){this.setAllVendorConsents(),this.setAllPurposeLegitimateInterests(),this.setAllSpecialFeatureOptins(),this.setAllPurposeConsents(),this.setAllVendorLegitimateInterests()},t.prototype.unsetAll=function(){this.unsetAllVendorConsents(),this.unsetAllPurposeLegitimateInterests(),this.unsetAllSpecialFeatureOptins(),this.unsetAllPurposeConsents(),this.unsetAllVendorLegitimateInterests()},Object.defineProperty(t.prototype,"numCustomPurposes",{get:function(){var e=this.numCustomPurposes_;if("object"==typeof this.customPurposes){var t=Object.keys(this.customPurposes).sort(function(e,t){return+e-+t});e=parseInt(t.pop(),10)}return e},set:function(e){if(this.numCustomPurposes_=parseInt(e,10),this.numCustomPurposes_<0)throw new errors_1.TCModelError("numCustomPurposes",e)},enumerable:!0,configurable:!0}),t.prototype.updated=function(){this.lastUpdated=new Date},t.consentLanguages=GVL_1.GVL.consentLanguages,t}(Cloneable_1.Cloneable);exports.TCModel=TCModel},function(module,exports,__webpack_require__){"use strict";var e,__extends=this&&this.__extends||(e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)},function(t,r){function s(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(s.prototype=r.prototype,new s)}),__awaiter=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))(function(n,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,a)}u((s=s.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){var r,s,n,o,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,s=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){i.label=o[1];break}if(6===o[0]&&i.label<n[1]){i.label=n[1],n=o;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(o);break}n[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],s=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(exports,"__esModule",{value:!0});var Cloneable_1=__webpack_require__(75),errors_1=__webpack_require__(51),Json_1=__webpack_require__(292),model_1=__webpack_require__(55),GVL=function(e){function t(r){var s=e.call(this)||this;s.isReady_=!1,s.isLatest=!1;var n=t.baseUrl;if(s.lang_=t.DEFAULT_LANGUAGE,s.isVendorList(r))s.populate(r),s.readyPromise=Promise.resolve();else{if(!n)throw new errors_1.GVLError("must specify GVL.baseUrl before loading GVL json");if(r>0){var o=r;t.CACHE.has(o)?(s.populate(t.CACHE.get(o)),s.readyPromise=Promise.resolve()):(n+=t.versionedFilename.replace("[VERSION]",o+""),s.readyPromise=s.fetchJson(n))}else t.CACHE.has(t.LATEST_CACHE_KEY)?(s.populate(t.CACHE.get(t.LATEST_CACHE_KEY)),s.readyPromise=Promise.resolve()):(s.isLatest=!0,s.readyPromise=s.fetchJson(n+t.latestFilename))}return s}return __extends(t,e),Object.defineProperty(t,"baseUrl",{get:function(){return this.baseUrl_},set:function(e){if(/^https?:\/\/vendorlist\.consensu\.org\//.test(e))throw new errors_1.GVLError("Invalid baseUrl!  You may not pull directly from vendorlist.consensu.org and must provide your own cache");e.length>0&&"/"!==e[e.length-1]&&(e+="/"),this.baseUrl_=e},enumerable:!0,configurable:!0}),t.emptyLanguageCache=function(e){var r=!1;return void 0===e&&t.LANGUAGE_CACHE.size>0?(t.LANGUAGE_CACHE=new Map,r=!0):"string"==typeof e&&this.consentLanguages.has(e.toUpperCase())&&(t.LANGUAGE_CACHE.delete(e.toUpperCase()),r=!0),r},t.emptyCache=function(e){var r=!1;return Number.isInteger(e)&&e>=0?(t.CACHE.delete(e),r=!0):void 0===e&&(t.CACHE=new Map,r=!0),r},t.prototype.cacheLanguage=function(){t.LANGUAGE_CACHE.has(this.lang_)||t.LANGUAGE_CACHE.set(this.lang_,{purposes:this.purposes,specialPurposes:this.specialPurposes,features:this.features,specialFeatures:this.specialFeatures,stacks:this.stacks})},t.prototype.fetchJson=function(e){return __awaiter(this,void 0,void 0,function(){var t,r;return __generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),t=this.populate,[4,Json_1.Json.fetch(e)];case 1:return t.apply(this,[s.sent()]),[3,3];case 2:throw r=s.sent(),new errors_1.GVLError(r.message);case 3:return[2]}})})},t.prototype.getJson=function(){return JSON.parse(JSON.stringify({gvlSpecificationVersion:this.gvlSpecificationVersion,vendorListVersion:this.vendorListVersion,tcfPolicyVersion:this.tcfPolicyVersion,lastUpdated:this.lastUpdated,purposes:this.purposes,specialPurposes:this.specialPurposes,features:this.features,specialFeatures:this.specialFeatures,stacks:this.stacks,vendors:this.fullVendorList}))},t.prototype.changeLanguage=function(e){return __awaiter(this,void 0,void 0,function(){var r,s,n,o,i;return __generator(this,function(a){switch(a.label){case 0:if(r=e.toUpperCase(),!t.consentLanguages.has(r))return[3,6];if(r===this.lang_)return[3,5];if(this.lang_=r,!t.LANGUAGE_CACHE.has(r))return[3,1];for(n in s=t.LANGUAGE_CACHE.get(r))s.hasOwnProperty(n)&&(this[n]=s[n]);return[3,5];case 1:o=t.baseUrl+t.languageFilename.replace("[LANG]",e),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.fetchJson(o)];case 3:return a.sent(),this.cacheLanguage(),[3,5];case 4:throw i=a.sent(),new errors_1.GVLError("unable to load language: "+i.message);case 5:return[3,7];case 6:throw new errors_1.GVLError("unsupported language "+e);case 7:return[2]}})})},Object.defineProperty(t.prototype,"language",{get:function(){return this.lang_},enumerable:!0,configurable:!0}),t.prototype.isVendorList=function(e){return void 0!==e&&void 0!==e.vendors},t.prototype.populate=function(e){this.purposes=e.purposes,this.specialPurposes=e.specialPurposes,this.features=e.features,this.specialFeatures=e.specialFeatures,this.stacks=e.stacks,this.isVendorList(e)&&(this.gvlSpecificationVersion=e.gvlSpecificationVersion,this.tcfPolicyVersion=e.tcfPolicyVersion,this.vendorListVersion=e.vendorListVersion,this.lastUpdated=e.lastUpdated,"string"==typeof this.lastUpdated&&(this.lastUpdated=new Date(this.lastUpdated)),this.vendors_=e.vendors,this.fullVendorList=e.vendors,this.mapVendors(),this.isReady_=!0,this.isLatest&&t.CACHE.set(t.LATEST_CACHE_KEY,this.getJson()),t.CACHE.has(this.vendorListVersion)||t.CACHE.set(this.vendorListVersion,this.getJson())),this.cacheLanguage()},t.prototype.mapVendors=function(e){var t=this;this.byPurposeVendorMap={},this.bySpecialPurposeVendorMap={},this.byFeatureVendorMap={},this.bySpecialFeatureVendorMap={},Object.keys(this.purposes).forEach(function(e){t.byPurposeVendorMap[e]={legInt:new Set,consent:new Set,flexible:new Set}}),Object.keys(this.specialPurposes).forEach(function(e){t.bySpecialPurposeVendorMap[e]=new Set}),Object.keys(this.features).forEach(function(e){t.byFeatureVendorMap[e]=new Set}),Object.keys(this.specialFeatures).forEach(function(e){t.bySpecialFeatureVendorMap[e]=new Set}),Array.isArray(e)||(e=Object.keys(this.fullVendorList).map(function(e){return+e})),this.vendorIds=new Set(e),this.vendors_=e.reduce(function(e,r){var s=t.vendors_[""+r];return s&&void 0===s.deletedDate&&(s.purposes.forEach(function(e){t.byPurposeVendorMap[e+""].consent.add(r)}),s.specialPurposes.forEach(function(e){t.bySpecialPurposeVendorMap[e+""].add(r)}),s.legIntPurposes.forEach(function(e){t.byPurposeVendorMap[e+""].legInt.add(r)}),s.flexiblePurposes&&s.flexiblePurposes.forEach(function(e){t.byPurposeVendorMap[e+""].flexible.add(r)}),s.features.forEach(function(e){t.byFeatureVendorMap[e+""].add(r)}),s.specialFeatures.forEach(function(e){t.bySpecialFeatureVendorMap[e+""].add(r)}),e[r]=s),e},{})},t.prototype.getFilteredVendors=function(e,t,r,s){var n=this,o=e.charAt(0).toUpperCase()+e.slice(1),i={};return("purpose"===e&&r?this["by"+o+"VendorMap"][t+""][r]:this["by"+(s?"Special":"")+o+"VendorMap"][t+""]).forEach(function(e){i[e+""]=n.vendors[e+""]}),i},t.prototype.getVendorsWithConsentPurpose=function(e){return this.getFilteredVendors("purpose",e,"consent")},t.prototype.getVendorsWithLegIntPurpose=function(e){return this.getFilteredVendors("purpose",e,"legInt")},t.prototype.getVendorsWithFlexiblePurpose=function(e){return this.getFilteredVendors("purpose",e,"flexible")},t.prototype.getVendorsWithSpecialPurpose=function(e){return this.getFilteredVendors("purpose",e,void 0,!0)},t.prototype.getVendorsWithFeature=function(e){return this.getFilteredVendors("feature",e)},t.prototype.getVendorsWithSpecialFeature=function(e){return this.getFilteredVendors("feature",e,void 0,!0)},Object.defineProperty(t.prototype,"vendors",{get:function(){return this.vendors_},enumerable:!0,configurable:!0}),t.prototype.narrowVendorsTo=function(e){this.mapVendors(e)},Object.defineProperty(t.prototype,"isReady",{get:function(){return this.isReady_},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.getJson())},t.isInstanceOf=function(e){return"object"==typeof e&&"function"==typeof e.narrowVendorsTo},t.LANGUAGE_CACHE=new Map,t.CACHE=new Map,t.LATEST_CACHE_KEY=0,t.DEFAULT_LANGUAGE="EN",t.consentLanguages=new model_1.ConsentLanguages,t.latestFilename="vendor-list.json",t.versionedFilename="archives/vendor-list-v[VERSION].json",t.languageFilename="purposes-[LANG].json",t}(Cloneable_1.Cloneable);exports.GVL=GVL},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Json=function(){function e(){}return e.absCall=function(e,t,n,r){return new Promise(function(o,s){var i=new XMLHttpRequest;i.withCredentials=n,i.addEventListener("load",function(){if(i.readyState==XMLHttpRequest.DONE)if(i.status>=200&&i.status<300){var e=i.response;if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}o(e)}else s(new Error("HTTP Status: "+i.status+" response type: "+i.responseType))}),i.addEventListener("error",function(){s(new Error("error"))}),i.addEventListener("abort",function(){s(new Error("aborted"))}),null===t?i.open("GET",e,!0):i.open("POST",e,!0),i.responseType="json",i.timeout=r,i.ontimeout=function(){s(new Error("Timeout "+r+"ms "+e))},i.send(t)})},e.post=function(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=0),this.absCall(e,JSON.stringify(t),n,r)},e.fetch=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=0),this.absCall(e,null,t,n)},e}();exports.Json=Json},function(module,exports,__webpack_require__){"use strict";var _require=__webpack_require__(294),decodeBitsToIds=_require.decodeBitsToIds,decodeFromBase64=_require.decodeFromBase64;module.exports={decodeConsentString:function(consentString){var _decodeFromBase=decodeFromBase64(consentString),version=_decodeFromBase.version,cmpId=_decodeFromBase.cmpId,vendorListVersion=_decodeFromBase.vendorListVersion,purposeIdBitString=_decodeFromBase.purposeIdBitString,maxVendorId=_decodeFromBase.maxVendorId,created=_decodeFromBase.created,lastUpdated=_decodeFromBase.lastUpdated,isRange=_decodeFromBase.isRange,defaultConsent=_decodeFromBase.defaultConsent,vendorIdBitString=_decodeFromBase.vendorIdBitString,vendorRangeList=_decodeFromBase.vendorRangeList,cmpVersion=_decodeFromBase.cmpVersion,consentScreen=_decodeFromBase.consentScreen,consentLanguage=_decodeFromBase.consentLanguage,consentStringData={version:version,cmpId:cmpId,vendorListVersion:vendorListVersion,allowedPurposeIds:decodeBitsToIds(purposeIdBitString),maxVendorId:maxVendorId,created:created,lastUpdated:lastUpdated,cmpVersion:cmpVersion,consentScreen:consentScreen,consentLanguage:consentLanguage};if(isRange){var idMap=vendorRangeList.reduce(function(acc,_ref){for(var isRange=_ref.isRange,startVendorId=_ref.startVendorId,endVendorId=_ref.endVendorId,lastVendorId=isRange?endVendorId:startVendorId,i=startVendorId;i<=lastVendorId;i+=1)acc[i]=!0;return acc},{});consentStringData.allowedVendorIds=[];for(var i=1;i<=maxVendorId;i+=1)(defaultConsent&&!idMap[i]||!defaultConsent&&idMap[i])&&-1===consentStringData.allowedVendorIds.indexOf(i)&&consentStringData.allowedVendorIds.push(i)}else consentStringData.allowedVendorIds=decodeBitsToIds(vendorIdBitString);return consentStringData}}},function(module,exports,__webpack_require__){"use strict";var base64=__webpack_require__(295),_require=__webpack_require__(297),versionNumBits=_require.versionNumBits,vendorVersionMap=_require.vendorVersionMap;function decodeBitsToInt(bitString,start,length){return parseInt(bitString.substr(start,length),2)}function decodeBitsToDate(bitString,start,length){return new Date(100*decodeBitsToInt(bitString,start,length))}function decodeBitsToLetter(bitString){var letterCode=decodeBitsToInt(bitString);return String.fromCharCode(letterCode+65).toLowerCase()}function decodeBitsToLanguage(bitString,start,length){var languageBitString=bitString.substr(start,length);return decodeBitsToLetter(languageBitString.slice(0,length/2))+decodeBitsToLetter(languageBitString.slice(length/2))}function decodeField(_ref){var input=_ref.input,output=_ref.output,startPosition=_ref.startPosition,field=_ref.field,type=field.type,numBits=field.numBits,decoder=field.decoder,validator=field.validator,listCount=field.listCount;if("function"==typeof validator&&!validator(output))return{newPosition:startPosition};if("function"==typeof decoder)return decoder(input,output,startPosition);var bitString,start,bitCount="function"==typeof numBits?numBits(output):numBits;switch(type){case"int":return{fieldValue:decodeBitsToInt(input,startPosition,bitCount)};case"bool":return{fieldValue:(bitString=input,start=startPosition,1===parseInt(bitString.substr(start,1),2))};case"date":return{fieldValue:decodeBitsToDate(input,startPosition,bitCount)};case"bits":return{fieldValue:input.substr(startPosition,bitCount)};case"list":return function(input,output,startPosition,field,listCount){var listEntryCount=0;"function"==typeof listCount?listEntryCount=listCount(output):"number"==typeof listCount&&(listEntryCount=listCount);for(var newPosition=startPosition,fieldValue=[],i=0;i<listEntryCount;i+=1){var decodedFields=decodeFields({input:input,fields:field.fields,startPosition:newPosition});newPosition=decodedFields.newPosition,fieldValue.push(decodedFields.decodedObject)}return{fieldValue:fieldValue,newPosition:newPosition}}(input,output,startPosition,field,listCount);case"language":return{fieldValue:decodeBitsToLanguage(input,startPosition,bitCount)};default:throw new Error("ConsentString - Unknown field type "+type+" for decoding")}}function decodeFields(_ref2){var input=_ref2.input,fields=_ref2.fields,_ref2$startPosition=_ref2.startPosition,position=void 0===_ref2$startPosition?0:_ref2$startPosition;return{decodedObject:fields.reduce(function(acc,field){var name=field.name,numBits=field.numBits,_decodeField=decodeField({input:input,output:acc,startPosition:position,field:field}),fieldValue=_decodeField.fieldValue,newPosition=_decodeField.newPosition;return void 0!==fieldValue&&(acc[name]=fieldValue),void 0!==newPosition?position=newPosition:"number"==typeof numBits&&(position+=numBits),acc},{}),newPosition:position}}module.exports={decodeBitsToIds:function(bitString){return bitString.split("").reduce(function(acc,bit,index){return"1"===bit&&-1===acc.indexOf(index+1)&&acc.push(index+1),acc},[])},decodeFromBase64:function(consentString,definitionMap){for(var unsafe=consentString;unsafe.length%4!=0;)unsafe+="=";unsafe=unsafe.replace(/-/g,"+").replace(/_/g,"/");for(var string,padding,bytes=base64.decode(unsafe),inputBits="",i=0;i<bytes.length;i+=1){var bitString=bytes.charCodeAt(i).toString(2);inputBits+=(string=bitString,padding=8-bitString.length,function(count){for(var string=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",padString="",i=0;i<count;i+=1)padString+=string;return padString}(Math.max(0,padding))+string)}return function(bitString){var definitionMap=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vendorVersionMap,version=decodeBitsToInt(bitString,0,versionNumBits);if("number"!=typeof version)throw new Error("ConsentString - Unknown version number in the string to decode");if(!vendorVersionMap[version])throw new Error("ConsentString - Unsupported version "+version+" in the string to decode");return decodeFields({input:bitString,fields:definitionMap[version].fields}).decodedObject}(inputBits,definitionMap)}}},function(module,exports,__webpack_require__){(function(module,global){var __WEBPACK_AMD_DEFINE_RESULT__;/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */!function(root){var freeExports=exports,freeGlobal=(module&&module.exports,"object"==typeof global&&global);freeGlobal.global!==freeGlobal&&freeGlobal.window;var InvalidCharacterError=function(message){this.message=message};(InvalidCharacterError.prototype=new Error).name="InvalidCharacterError";var error=function(message){throw new InvalidCharacterError(message)},TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",REGEX_SPACE_CHARACTERS=/[\t\n\f\r ]/g,base64={encode:function(input){input=String(input),/[^\0-\xFF]/.test(input)&&error("The string to be encoded contains characters outside of the Latin1 range.");for(var a,b,c,buffer,padding=input.length%3,output="",position=-1,length=input.length-padding;++position<length;)a=input.charCodeAt(position)<<16,b=input.charCodeAt(++position)<<8,c=input.charCodeAt(++position),output+=TABLE.charAt((buffer=a+b+c)>>18&63)+TABLE.charAt(buffer>>12&63)+TABLE.charAt(buffer>>6&63)+TABLE.charAt(63&buffer);return 2==padding?(a=input.charCodeAt(position)<<8,b=input.charCodeAt(++position),output+=TABLE.charAt((buffer=a+b)>>10)+TABLE.charAt(buffer>>4&63)+TABLE.charAt(buffer<<2&63)+"="):1==padding&&(buffer=input.charCodeAt(position),output+=TABLE.charAt(buffer>>2)+TABLE.charAt(buffer<<4&63)+"=="),output},decode:function(input){var length=(input=String(input).replace(REGEX_SPACE_CHARACTERS,"")).length;length%4==0&&(length=(input=input.replace(/==?$/,"")).length),(length%4==1||/[^+a-zA-Z0-9/]/.test(input))&&error("Invalid character: the string to be decoded is not correctly encoded.");for(var bitStorage,buffer,bitCounter=0,output="",position=-1;++position<length;)buffer=TABLE.indexOf(input.charAt(position)),bitStorage=bitCounter%4?64*bitStorage+buffer:buffer,bitCounter++%4&&(output+=String.fromCharCode(255&bitStorage>>(-2*bitCounter&6)));return output},version:"0.1.0"};void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return base64}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()}).call(this,__webpack_require__(296)(module),__webpack_require__(109))},function(module,exports){module.exports=function(module){return module.webpackPolyfill||(module.deprecate=function(){},module.paths=[],module.children||(module.children=[]),Object.defineProperty(module,"loaded",{enumerable:!0,get:function(){return module.l}}),Object.defineProperty(module,"id",{enumerable:!0,get:function(){return module.i}}),module.webpackPolyfill=1),module}},function(module,exports,__webpack_require__){"use strict";module.exports={versionNumBits:6,vendorVersionMap:{1:{version:1,metadataFields:["version","created","lastUpdated","cmpId","cmpVersion","consentScreen","vendorListVersion"],fields:[{name:"version",type:"int",numBits:6},{name:"created",type:"date",numBits:36},{name:"lastUpdated",type:"date",numBits:36},{name:"cmpId",type:"int",numBits:12},{name:"cmpVersion",type:"int",numBits:12},{name:"consentScreen",type:"int",numBits:6},{name:"consentLanguage",type:"language",numBits:12},{name:"vendorListVersion",type:"int",numBits:12},{name:"purposeIdBitString",type:"bits",numBits:24},{name:"maxVendorId",type:"int",numBits:16},{name:"isRange",type:"bool",numBits:1},{name:"vendorIdBitString",type:"bits",numBits:function(decodedObject){return decodedObject.maxVendorId},validator:function(decodedObject){return!decodedObject.isRange}},{name:"defaultConsent",type:"bool",numBits:1,validator:function(decodedObject){return decodedObject.isRange}},{name:"numEntries",numBits:12,type:"int",validator:function(decodedObject){return decodedObject.isRange}},{name:"vendorRangeList",type:"list",listCount:function(decodedObject){return decodedObject.numEntries},validator:function(decodedObject){return decodedObject.isRange},fields:[{name:"isRange",type:"bool",numBits:1},{name:"startVendorId",type:"int",numBits:16},{name:"endVendorId",type:"int",numBits:16,validator:function(decodedObject){return decodedObject.isRange}}]}]}}}},function(module,exports){String.prototype.cnx_replaceAll=function(search,replacement){return this.split(search).join(replacement)}},function(module,exports,__webpack_require__){var getPrototypeOf=__webpack_require__(3);module.exports=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=getPrototypeOf(object)););return object}},function(module,exports){function _setPrototypeOf(o,p){return module.exports=_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}module.exports=_setPrototypeOf},function(module,exports){module.exports=function(arr){if(Array.isArray(arr))return arr}},function(module,exports){module.exports=function(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}},function(module,exports){module.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var ReportingObserverOptionsTypeEnum,Logging=__webpack_require__(11),UserManagerService=__webpack_require__(86),protos=(__webpack_require__(298),__webpack_require__(0)),defineProperty=__webpack_require__(6),defineProperty_default=__webpack_require__.n(defineProperty),classCallCheck=__webpack_require__(1),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(2),createClass_default=__webpack_require__.n(createClass),helpers_get=__webpack_require__(12),get_default=__webpack_require__.n(helpers_get),possibleConstructorReturn=__webpack_require__(8),possibleConstructorReturn_default=__webpack_require__.n(possibleConstructorReturn),getPrototypeOf=__webpack_require__(3),getPrototypeOf_default=__webpack_require__.n(getPrototypeOf),inherits=__webpack_require__(9),inherits_default=__webpack_require__.n(inherits),Loader=__webpack_require__(170),Mediator=__webpack_require__(28),ExperienceConfig=__webpack_require__(30),ObjectUtils=__webpack_require__(45),ArrayUtils=__webpack_require__(13),CssClassesConfig=__webpack_require__(7),LoggingStateStorage=__webpack_require__(56);!function(ReportingObserverOptionsTypeEnum){ReportingObserverOptionsTypeEnum.Deprecation="deprecation",ReportingObserverOptionsTypeEnum.Intervention="intervention",ReportingObserverOptionsTypeEnum.Crash="crash"}(ReportingObserverOptionsTypeEnum||(ReportingObserverOptionsTypeEnum={}));var HEAVY_AD_INTERVENTION_ID="HeavyAdIntervention",ReportingObserverWrapper_ReportingObserverWrapper=function(){function ReportingObserverWrapper(_global,_trackingService,_heavyAdTrackingData){var _this=this;classCallCheck_default()(this,ReportingObserverWrapper),this._global=_global,this._trackingService=_trackingService,this._heavyAdTrackingData=_heavyAdTrackingData,this._unloadDataSent=!1,this._handleVisibilityChange=function(){"hidden"===_this._global.document.visibilityState&&_this._onUnload()},this._onUnload=function(){if(!_this._unloadDataSent&&_this._observer){var reports=_this._observer.takeRecords();_this._logObserverReports(reports),_this._unloadDataSent=!0}},this._logObserverReports=function(reports){reports.filter(function(_ref){var _a;return(null===(_a=_ref.body)||void 0===_a?void 0:_a.id)===HEAVY_AD_INTERVENTION_ID}).forEach(function(){_this._trackingService.trackHeavyAdIntervention(_this._heavyAdTrackingData)})},this._canInit()&&this._init()}return createClass_default()(ReportingObserverWrapper,[{key:"destroy",value:function(){this._global.removeEventListener("pagehide",this._onUnload),this._global.removeEventListener("visibilitychange",this._handleVisibilityChange)}},{key:"_canInit",value:function(){return!!this._global.ReportingObserver}},{key:"_init",value:function(){var _this2=this;this._observer=new this._global.ReportingObserver(function(reports){_this2._logObserverReports(reports)},{buffered:!0,types:[ReportingObserverOptionsTypeEnum.Intervention]}),this._observer.observe(),this._global.addEventListener("pagehide",this._onUnload),this._global.addEventListener("visibilitychange",this._handleVisibilityChange)}}]),ReportingObserverWrapper}(),AdBlockerDetectionService=__webpack_require__(46);function _createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var FloatingEventsEnum,FloatingTransitionState,FloatingStatesEnum,Renderer_Renderer=function(_Mediator){inherits_default()(Renderer,_Mediator);var _super=_createSuper(Renderer);function Renderer(mediator,playerModel,app,_reloadData,_appSettings){var _this;return classCallCheck_default()(this,Renderer),(_this=_super.call(this)).mediator=mediator,_this.playerModel=playerModel,_this.app=app,_this._reloadData=_reloadData,_this._appSettings=_appSettings,_this.macroElements={player:[]},_this._isDestroyed=!1,_this._macroStrings={description:"{{description}}",title:"{{title}}",player:"{{player}}"},_this._autoDestroyIntervalId=null,_this._autoDestroyInterval=500,_this.createExperience(playerModel,_appSettings),_this._globalReportingObserver=new ReportingObserverWrapper_ReportingObserverWrapper(playerModel.global,_this.app.services.TrackingService,{heavyAdBlockTypeEnum:protos.ProtoHeavyAdBlockTypeEnum.Global}),_this._scriptReportingObserver=new ReportingObserverWrapper_ReportingObserverWrapper(window,_this.app.services.TrackingService,{heavyAdBlockTypeEnum:protos.ProtoHeavyAdBlockTypeEnum.Script}),_this}return createClass_default()(Renderer,[{key:"subscribeToEvents",value:function(){var _this2=this;this.subscribe(ExperienceConfig.b.Destroy,this.experience,function(){_this2.destroy()}),this.subscribe(ExperienceConfig.b.CanStart,this.experience,function(){_this2.experience.start()}),this.subscribe(ExperienceConfig.c.SessionRendered,this.experience,function(){_this2._reloadData.wasPlayerReloaded||_this2.app.services.TrackingService.trackSessionRendered(AdBlockerDetectionService.a.isBannerBlocked),_this2.mediator.publish(_this2,ExperienceConfig.c.SessionRendered)}),this.subscribe(ExperienceConfig.c.SessionView,this.experience,function(){_this2._reloadData.wasPlayerInView||(_this2.app.services.TrackingService.trackSessionViewability(),_this2.mediator.publish(_this2,ExperienceConfig.c.SessionView))}),Object(ObjectUtils.a)(this.experience.events).forEach(function(event){_this2.subscribe(event,_this2.experience,function(data){_this2.experienceApi.trigger(event,data.payload)})})}},{key:"updateMacroContent",value:function(macroElement,value){macroElement&&macroElement.forEach(function(element){element.textContent=value})}},{key:"_addCss",value:function(){this.playerModel.css&&this.app.services.GlobalDomUtilsService.addCssString(this.playerModel.css,"cnx-custom-css-".concat(this.app.config.appId))}},{key:"_getProcessedCustomHtmlString",value:function(htmlString){return"<cnx>".concat(htmlString,"</cnx>").replace(/{\{([^}]+)}}/g,"<cnx-span>$&</cnx-span>")}},{key:"_addHtml",value:function(){var _this3=this;if(this.experienceContainer=this._getExperienceTemplate(),this.playerModel.html){var customHtml=this.app.services.GlobalDomUtilsService.createElementByString(this._getProcessedCustomHtmlString(this.playerModel.html));this._cacheMacroElements(customHtml);var playerMacro=this.macroElements.player[0];if(!playerMacro)throw Error("player macro was not found");playerMacro.innerHTML="",playerMacro.parentNode.insertBefore(this.experienceContainer,playerMacro),playerMacro.parentNode.removeChild(playerMacro),Object(ArrayUtils.c)(customHtml.children).forEach(function(childElement){_this3.playerModel.targetContainer.parentNode.insertBefore(childElement,_this3.playerModel.targetContainer)})}else this.playerModel.targetContainer.parentNode.insertBefore(this.experienceContainer,this.playerModel.targetContainer);this.playerModel.targetContainer.parentElement.removeChild(this.playerModel.targetContainer)}},{key:"_getExperienceTemplate",value:function(){var deviceClass=this.app.config.isMobile?CssClassesConfig.g.Mobile:CssClassesConfig.g.Desktop;return this.app.services.GlobalDomUtilsService.createElementByString('<cnx class="'.concat(CssClassesConfig.b.MainContainer," ").concat(deviceClass," ").concat(this._platformClass,'"></cnx>'))}},{key:"_cacheMacroElements",value:function(htmlNode){var _this4=this;Object(ArrayUtils.c)(htmlNode.children).forEach(function(child){child.children.length>0&&_this4._cacheMacroElements(child),Object.keys(_this4._macroStrings).forEach(function(key){var macro=_this4._macroStrings[key];child.textContent.indexOf(macro)>-1&&_this4._addMacroElement(key,child)})})}},{key:"_addMacroElement",value:function(macro,macroElement){this.macroElements[macro]||(this.macroElements[macro]=[]),this.macroElements[macro].push(macroElement),macroElement.textContent=""}},{key:"_clearDestroyInterval",value:function(){null!==this._autoDestroyIntervalId&&(clearInterval(this._autoDestroyIntervalId),this._autoDestroyIntervalId=null)}},{key:"init",value:function(onRenderExperience){var _this5=this;this._addCss(),this._addHtml();var device=this.app.config.device;return this.isSupportedBreakpoint(device)?(this.subscribeToEvents(),this.experience._renderExperience(this.playerModel,this.app,this.experienceContainer,onRenderExperience),this._autoDestroyIntervalId=setInterval(function(){_this5._isDestroyed?_this5._clearDestroyInterval():_this5.app.services.GlobalDomUtilsService.isDetachedFromDOM(_this5.experienceContainer)&&(_this5.destroy(),Object(Logging.a)({message:"player_removed_from_DOM",level:protos.ProtoLoggingLevelEnum.INFO}))},this._autoDestroyInterval),!0):(this.destroy(),!1)}},{key:"getApiMethods",value:function(){return this.experienceApi.getApiMethods()}},{key:"destroy",value:function(){try{LoggingStateStorage.a.playerDestroyed(),this._isDestroyed=!0,this._clearDestroyInterval(),this.app.services.TrackingService.destroy(),this.app.services.ResizeObserver.destroy(),this.app.services.ViewabilityService.destroy(),this.app.services.InteractionService.destroy(),this.experienceApi.setDestroyed(),this.unsubscribeAll(this.experience),this.experience&&(this.experience.destroy(),this.experience=null),this.experienceContainer.parentNode&&this.experienceContainer.parentNode.removeChild(this.experienceContainer),this._globalReportingObserver.destroy(),this._scriptReportingObserver.destroy()}catch(e){Object(Logging.a)({callStack:e.stack,level:protos.ProtoLoggingLevelEnum.WARNING,message:"Renderer_destroy",exception:e.message})}}},{key:"playerContainer",get:function(){return this.experienceContainer}}]),Renderer}(Mediator.a),assertThisInitialized=__webpack_require__(16),assertThisInitialized_default=__webpack_require__.n(assertThisInitialized),VastConfig=__webpack_require__(10);!function(FloatingEventsEnum){FloatingEventsEnum.EnterStart="enterStart",FloatingEventsEnum.EnterStop="enterStop",FloatingEventsEnum.ExitStart="exitStart",FloatingEventsEnum.ExitStop="exitStop"}(FloatingEventsEnum||(FloatingEventsEnum={})),function(FloatingTransitionState){FloatingTransitionState[FloatingTransitionState.DirectionIn=0]="DirectionIn",FloatingTransitionState[FloatingTransitionState.DirectionOut=1]="DirectionOut",FloatingTransitionState[FloatingTransitionState.FadeIn=2]="FadeIn"}(FloatingTransitionState||(FloatingTransitionState={})),function(FloatingStatesEnum){FloatingStatesEnum.Float="float",FloatingStatesEnum.Embed="embed"}(FloatingStatesEnum||(FloatingStatesEnum={}));var FLOAT_WIDTH=400,DomUtils=__webpack_require__(5),FloatingBase_FloatingBase=function(){function FloatingBase(_resizeObserverService,_settings,_targetElement,_device,_globalDomUtils){var _this=this,_breakpoint=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;classCallCheck_default()(this,FloatingBase),this._resizeObserverService=_resizeObserverService,this._settings=_settings,this._targetElement=_targetElement,this._device=_device,this._globalDomUtils=_globalDomUtils,this._breakpoint=_breakpoint,this._hidingPosition=0,this._isInFloating=void 0,this._findElementIntervalTimer=null,this._destroyed=!1,this._FIND_PAGE_ELEMENT_INTERVAL=500,this._onScrollPage=function(){_this._isInFloating&&_this._translateFloatingOnPageElement()},this._onSelectedElementResize=function(){if(_this._settings.width=_this._selectedElement.clientWidth,_this._onElementResize(),_this._isInFloating){_this._positionOnPageElementXAxis(!1)}},this._onElementResize=function(){_this._checkAllowBreakpoint()?!_this._canEnterFloating||_this._isInFloating||_this._destroyed?_this._onElementResizeCallback():_this._enterToFloating():_this._isInFloating&&_this._exitFromFloating()},this._onTransitionEnd=function(event){if(_this._isValidTransitionEndProperty(event.propertyName))switch(_this.transitionState){case FloatingTransitionState.DirectionIn:_this.transitionState=void 0,_this._onFloatingEnterStop();break;case FloatingTransitionState.DirectionOut:_this.transitionState=void 0,_this._exitFloatingStop();break;case FloatingTransitionState.FadeIn:_this.transitionState=void 0,_this._onFadeInStop()}},this._setHidingPosition()}return createClass_default()(FloatingBase,[{key:"_addClass",value:function(){for(var _len=arguments.length,classNames=new Array(_len),_key=0;_key<_len;_key++)classNames[_key]=arguments[_key];DomUtils.a.apply(void 0,[this._targetElement].concat(classNames))}},{key:"_removeClass",value:function(){for(var _len2=arguments.length,classNames=new Array(_len2),_key2=0;_key2<_len2;_key2++)classNames[_key2]=arguments[_key2];DomUtils.L.apply(void 0,[this._targetElement].concat(classNames))}},{key:"_onElementResizeCallback",value:function(){this._device!==protos.ProtoDeviceType.Smartphone&&(this._targetElement.style.width="".concat(this._settings.width,"px"));var width=this._targetElement.getBoundingClientRect().width;this._targetElement.style.height=this._settings.getHeight(width)}},{key:"_checkDevice",value:function(){return Object(ArrayUtils.g)(this._device,this._settings.floatingDeviceMode)}},{key:"_addScrollHandler",value:function(){this._globalDomUtils.addEventListenerOnGlobal("scroll",this._onScrollPage)}},{key:"_translateFloatingOnPageElement",value:function(){this._selectedElement&&(this._setFloatingTopLimit(),this._onElementTopLimit<this._settings.floatingGutterY?this._translateElementOnYAxis(this._settings.floatingGutterY):this._translateElementOnYAxis(this._onElementTopLimit))}},{key:"_getPageElement",value:function(){this._selectedElement=this._globalDomUtils.querySelector(this._settings.pageElement),this._selectedElement&&(clearInterval(this._findElementIntervalTimer),this._settings.width=this._selectedElement.clientWidth,this._onElementResize(),this._resizeObserverService.on(this._selectedElement,this._onSelectedElementResize),this._resizeObserverService.on(this._globalDomUtils.getGlobalClosestTop().topFrame.document.body,this._onSelectedElementResize))}},{key:"_setFloatingTopLimit",value:function(){switch(this._settings.appendLocation){case protos.ProtoFloatingAppendLocationEnum.Above:this._onElementTopLimit=this._selectedElement.getBoundingClientRect().top-this._targetElement.offsetHeight-this._settings.floatingYAxisPadding;break;case protos.ProtoFloatingAppendLocationEnum.Below:this._onElementTopLimit=this._selectedElement.getBoundingClientRect().top+this._selectedElement.offsetHeight+this._settings.floatingYAxisPadding;break;case protos.ProtoFloatingAppendLocationEnum.Within:this._onElementTopLimit=this._selectedElement.getBoundingClientRect().top}}},{key:"_findElementOnPage",value:function(){var _this2=this;this._findElementIntervalTimer=setInterval(function(){_this2._getPageElement()},this._FIND_PAGE_ELEMENT_INTERVAL),this._getPageElement()}},{key:"_isFloatingOnPageElement",value:function(){return this._settings.floatingPosition===protos.ProtoFloatingFixedPositionMode.Element}},{key:"_isValidTransitionEndProperty",value:function(transitionPropertyName){switch(this.transitionState){case FloatingTransitionState.DirectionIn:case FloatingTransitionState.DirectionOut:if("right"===transitionPropertyName||"left"===transitionPropertyName)return!0;break;case FloatingTransitionState.FadeIn:if("opacity"===transitionPropertyName)return!0}return!1}},{key:"_resetAllStyles",value:function(){this._targetElement.style.top="",this._targetElement.style.bottom="",this._targetElement.style.left="",this._targetElement.style.right="",this._targetElement.style.width="",this._targetElement.style.height="",this._targetElement.style.transform=""}},{key:"_exitFloatingStop",value:function(){this._isInFloating=!1,this._removeClass(CssClassesConfig.o.MainClass,CssClassesConfig.o.TransitionClass,this._settings.positionClass),this._resetAllStyles(),this._onFloatingExitStop()}},{key:"_positionElementOnYAxis",value:function(){this._settings.isPositionedTop?(this._targetElement.style.top="".concat(this._settings.floatingGutterY,"px"),this._targetElement.style.bottom="auto"):this._settings.isPositionedBottom&&(this._targetElement.style.top="auto",this._targetElement.style.bottom="".concat(this._settings.floatingGutterY,"px"))}},{key:"_translateElementOnYAxis",value:function(coordinateY){this._targetElement.style.transform="translateY(".concat(coordinateY,"px)")}},{key:"_useTransition",value:function(useTransition){useTransition?this._addClass(CssClassesConfig.o.TransitionClass):this._removeClass(CssClassesConfig.o.TransitionClass)}},{key:"_positionElementOnXAxis",value:function(positionFromMargin){var useTransition=arguments.length>1&&void 0!==arguments[1]&&arguments[1],useOnlyLeft=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._useTransition(useTransition),useOnlyLeft||this._settings.isPositionedLeft?(this._targetElement.style.left="".concat(positionFromMargin,"px"),this._targetElement.style.right="auto"):(this._targetElement.style.left="auto",this._targetElement.style.right="".concat(positionFromMargin,"px"))}},{key:"_checkAllowBreakpoint",value:function(){return Object(DomUtils.t)(this._targetElement).document.body.getBoundingClientRect().width>=this._breakpoint}},{key:"_enterToFloating",value:function(){if(this._checkAllowBreakpoint()&&(!this._isFloatingOnPageElement()||this._selectedElement&&(!this._selectedElement||0!==this._selectedElement.clientWidth)))if(this._isInFloating=!0,this.transitionState=FloatingTransitionState.DirectionIn,this._addClass(CssClassesConfig.o.MainClass,this._settings.positionClass),this._onElementResize(),this._isFloatingOnPageElement()?(this._targetElement.style.top="0px",this._setFloatingLeftOrRight(),this._positionElementOnXAxis(this._hidingPosition,!1,!0),this._translateFloatingOnPageElement()):(this._positionElementOnYAxis(),this._positionElementOnXAxis(this._hidingPosition)),this._onFloatingEnterStart(),Object(DomUtils.i)(this._targetElement),this._selectedElement){this._positionOnPageElementXAxis(!0)}else this._positionElementOnXAxis(this._settings.floatingGutterX,!0)}},{key:"_setFloatingLeftOrRight",value:function(){this._selectedElement&&(this._globalDomUtils.getElementCoordinates(this._selectedElement).clientX<this._globalDomUtils.getBodyDimensions().width/2?(this._settings.isPositionedLeft=!0,this._settings.isPositionedRight=!1):(this._settings.isPositionedLeft=!1,this._settings.isPositionedRight=!0),this._setHidingPosition())}},{key:"_setHidingPosition",value:function(){this._isFloatingOnPageElement()&&this._settings.isPositionedRight?this._hidingPosition=this._globalDomUtils.getBodyDimensions().width+(this._settings.floatingWidth||1e3)+20:this._hidingPosition=-((this._settings.floatingWidth||1e3)+20)}},{key:"_positionOnPageElementXAxis",value:function(withAnimation){var floatingXCoordinates;this._setFloatingLeftOrRight(),floatingXCoordinates=this._globalDomUtils.getElementCoordinates(this._selectedElement).clientX,this._settings.isPositionedLeft?floatingXCoordinates+=this._settings.floatingGutterX:floatingXCoordinates-=this._settings.floatingGutterX,this._positionElementOnXAxis(floatingXCoordinates,withAnimation,!0)}},{key:"_exitFromFloating",value:function(){var useOnlyLeft,useTransition=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];useTransition&&(this.transitionState=FloatingTransitionState.DirectionOut),this._onFloatingExitStart(),useOnlyLeft=this._isFloatingOnPageElement(),this._positionElementOnXAxis(this._hidingPosition,useTransition,useOnlyLeft),useTransition||this._exitFloatingStop()}},{key:"_start",value:function(){this._targetElement.addEventListener("transitionend",this._onTransitionEnd),this._resizeObserverService.on(this._targetElement,this._onElementResize),this._isFloatingOnPageElement()&&(this._findElementOnPage(),this._addScrollHandler())}},{key:"_destroy",value:function(){this._resizeObserverService.off(this._targetElement,this._onElementResize),this._targetElement.removeEventListener("transitionend",this._onTransitionEnd),this._selectedElement&&(this._resizeObserverService.off(this._selectedElement,this._onSelectedElementResize),this._resizeObserverService.off(this._globalDomUtils.getGlobalClosestTop().topFrame.document.body,this._onSelectedElementResize),this._globalDomUtils.removeEventListenerOnGlobal("scroll",this._onScrollPage),clearInterval(this._findElementIntervalTimer))}},{key:"transitionState",get:function(){return this._transitionState},set:function(newState){this._transitionState===FloatingTransitionState.FadeIn&&this._removeClass(CssClassesConfig.n.FadeInBase,CssClassesConfig.n.FadeIn),this._transitionState=newState}},{key:"isInFloating",get:function(){return this._isInFloating}}]),FloatingBase}();function Floating_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var UiComponentEventsEnum,Floating_Floating=function(_FloatingBase){inherits_default()(Floating,_FloatingBase);var _super=Floating_createSuper(Floating);function Floating(mediator,_viewabilityService,resizeObserverService,targetElement,settings,device,globalDomUtils){var _this,breakpoint=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return classCallCheck_default()(this,Floating),(_this=_super.call(this,resizeObserverService,settings,targetElement,device,globalDomUtils,breakpoint)).mediator=mediator,_this._viewabilityService=_viewabilityService,_this._floatingStartRestricted=!0,_this._enabled=!0,_this._isFullScreen=!1,_this._canEnterFloating=!1,_this._viewabilityCallback=function(inView){var isTabInFocus=_this._viewabilityService.getIsTabInFocus();inView&&_this.isInFloating&&(_this._canEnterFloating=!1,_this._exitFromFloating()),_this._floatingStartRestricted&&_this._settings.floatingMode===protos.ProtoPlayerFloatingMode.AfterInView&&inView&&(_this._floatingStartRestricted=!1),!inView&&!_this._floatingStartRestricted&&_this._enabled&&isTabInFocus&&(_this._canEnterFloating=!0,get_default()(getPrototypeOf_default()(Floating.prototype),"_enterToFloating",assertThisInitialized_default()(_this)).call(assertThisInitialized_default()(_this)))},_this._onElementResizeCallback=function(){_this.isInFloating&&get_default()(getPrototypeOf_default()(Floating.prototype),"_onElementResizeCallback",assertThisInitialized_default()(_this)).call(assertThisInitialized_default()(_this))},_this}return createClass_default()(Floating,[{key:"_exitFromFloating",value:function(){var useTransition=!this._isFullScreen;get_default()(getPrototypeOf_default()(Floating.prototype),"_exitFromFloating",this).call(this,useTransition)}},{key:"_onFloatingExitStart",value:function(){this.mediator.publish(this,FloatingEventsEnum.ExitStart)}},{key:"_onFloatingExitStop",value:function(){this._fadeIn()}},{key:"_onFloatingEnterStart",value:function(){this.mediator.publish(this,FloatingEventsEnum.EnterStart)}},{key:"_fadeIn",value:function(){this.transitionState=FloatingTransitionState.FadeIn,this._removeClass(CssClassesConfig.n.FadeIn),this._addClass(CssClassesConfig.n.FadeInBase),Object(DomUtils.i)(this._targetElement),this._addClass(CssClassesConfig.n.FadeIn)}},{key:"_onFloatingEnterStop",value:function(){this.mediator.publish(this,FloatingEventsEnum.EnterStop)}},{key:"_onFadeInStop",value:function(){this._removeClass(CssClassesConfig.n.FadeInBase,CssClassesConfig.n.FadeIn),this.mediator.publish(this,FloatingEventsEnum.ExitStop),this._destroyed&&get_default()(getPrototypeOf_default()(Floating.prototype),"_destroy",this).call(this)}},{key:"_startViewabilityService",value:function(){this._viewabilityService.on(this._targetElement.parentElement,this._viewabilityCallback,{threshold:.5})}},{key:"_stopViewabilityService",value:function(){this._viewabilityService.off(this._targetElement.parentElement,this._viewabilityCallback)}},{key:"start",value:function(){this._checkDevice()&&(get_default()(getPrototypeOf_default()(Floating.prototype),"_start",this).call(this),this._settings.floatingMode===protos.ProtoPlayerFloatingMode.OnPageLoad&&(this._floatingStartRestricted=!1),this._startViewabilityService(),this._viewabilityCallback(this._viewabilityService.check({element:this._targetElement.parentElement,threshold:.5})))}},{key:"canFloat",value:function(){return this._checkDevice()&&this._settings.floatingMode!==protos.ProtoPlayerFloatingMode.Off}},{key:"destroy",value:function(){this.isInFloating?(this._exitFloatingStop(),this._destroyed=!0):get_default()(getPrototypeOf_default()(Floating.prototype),"_destroy",this).call(this),this._stopViewabilityService()}},{key:"fullscreenStateChange",value:function(inFullscreen){this._isFullScreen=inFullscreen,inFullscreen?this._stopViewabilityService():this._startViewabilityService(),this._viewabilityCallback(inFullscreen)}},{key:"enabled",get:function(){return this._enabled},set:function(flag){this._enabled=flag}}]),Floating}(FloatingBase_FloatingBase);!function(UiComponentEventsEnum){UiComponentEventsEnum[UiComponentEventsEnum.Play=0]="Play",UiComponentEventsEnum[UiComponentEventsEnum.Pause=1]="Pause",UiComponentEventsEnum[UiComponentEventsEnum.Replay=2]="Replay",UiComponentEventsEnum[UiComponentEventsEnum.Volume=3]="Volume",UiComponentEventsEnum[UiComponentEventsEnum.Mute=4]="Mute",UiComponentEventsEnum[UiComponentEventsEnum.Unmute=5]="Unmute",UiComponentEventsEnum[UiComponentEventsEnum.Seek=6]="Seek",UiComponentEventsEnum[UiComponentEventsEnum.DraggingStart=7]="DraggingStart",UiComponentEventsEnum[UiComponentEventsEnum.DraggingStopped=8]="DraggingStopped",UiComponentEventsEnum[UiComponentEventsEnum.SeekingStart=9]="SeekingStart",UiComponentEventsEnum[UiComponentEventsEnum.SeekingStopped=10]="SeekingStopped",UiComponentEventsEnum[UiComponentEventsEnum.Expand=11]="Expand",UiComponentEventsEnum[UiComponentEventsEnum.Collapse=12]="Collapse",UiComponentEventsEnum[UiComponentEventsEnum.Quality=13]="Quality",UiComponentEventsEnum[UiComponentEventsEnum.Close=14]="Close",UiComponentEventsEnum[UiComponentEventsEnum.Next=15]="Next",UiComponentEventsEnum[UiComponentEventsEnum.Prev=16]="Prev",UiComponentEventsEnum[UiComponentEventsEnum.Settings=17]="Settings",UiComponentEventsEnum[UiComponentEventsEnum.CaptionOn=18]="CaptionOn",UiComponentEventsEnum[UiComponentEventsEnum.CaptionOff=19]="CaptionOff",UiComponentEventsEnum[UiComponentEventsEnum.CaptionUpdate=20]="CaptionUpdate",UiComponentEventsEnum[UiComponentEventsEnum.VolumeHoverStart=21]="VolumeHoverStart",UiComponentEventsEnum[UiComponentEventsEnum.VolumeHoverStopped=22]="VolumeHoverStopped",UiComponentEventsEnum[UiComponentEventsEnum.OverlayClick=23]="OverlayClick",UiComponentEventsEnum[UiComponentEventsEnum.UIHideStart=24]="UIHideStart",UiComponentEventsEnum[UiComponentEventsEnum.UIShowStart=25]="UIShowStart",UiComponentEventsEnum[UiComponentEventsEnum.UIEndShowHide=26]="UIEndShowHide",UiComponentEventsEnum[UiComponentEventsEnum.AboutClick=27]="AboutClick",UiComponentEventsEnum[UiComponentEventsEnum.ContextClick=28]="ContextClick",UiComponentEventsEnum[UiComponentEventsEnum.SettingsMenu=29]="SettingsMenu",UiComponentEventsEnum[UiComponentEventsEnum.HoverStart=30]="HoverStart",UiComponentEventsEnum[UiComponentEventsEnum.HoverEnd=31]="HoverEnd",UiComponentEventsEnum[UiComponentEventsEnum.StateChanged=32]="StateChanged",UiComponentEventsEnum[UiComponentEventsEnum.RebindComponent=33]="RebindComponent",UiComponentEventsEnum[UiComponentEventsEnum.SkipAd=34]="SkipAd",UiComponentEventsEnum[UiComponentEventsEnum.LogoClicked=35]="LogoClicked",UiComponentEventsEnum[UiComponentEventsEnum.ContextMenuOpen=36]="ContextMenuOpen",UiComponentEventsEnum[UiComponentEventsEnum.ContextMenuClose=37]="ContextMenuClose"}(UiComponentEventsEnum||(UiComponentEventsEnum={}));var TypeUtils=__webpack_require__(4),ApiConfig=__webpack_require__(25);function AlwaysFloating_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var QuartilesEnum,AlwaysFloating_AlwaysFloating=function(_FloatingBase){inherits_default()(AlwaysFloating,_FloatingBase);var _super=AlwaysFloating_createSuper(AlwaysFloating);function AlwaysFloating(mediator,resizeObserverService,targetElement,settings,device,globalDomUtils){var _this,breakpoint=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;return classCallCheck_default()(this,AlwaysFloating),(_this=_super.call(this,resizeObserverService,settings,targetElement,device,globalDomUtils,breakpoint)).mediator=mediator,_this._canEnterFloating=!0,_this}return createClass_default()(AlwaysFloating,[{key:"_onFloatingEnterStart",value:function(){}},{key:"_onFloatingEnterStop",value:function(){this.mediator.publish(this,FloatingEventsEnum.EnterStop)}},{key:"_onFloatingExitStart",value:function(){}},{key:"_onFloatingExitStop",value:function(){}},{key:"_onFadeInStop",value:function(){}},{key:"start",value:function(){this._checkDevice()&&(get_default()(getPrototypeOf_default()(AlwaysFloating.prototype),"_start",this).call(this),get_default()(getPrototypeOf_default()(AlwaysFloating.prototype),"_enterToFloating",this).call(this))}}]),AlwaysFloating}(FloatingBase_FloatingBase),AdHandlerEventsEnum_DetachedFromDom="detachedFromDom",AdHandlerEventsEnum_AdSlotResized="adSlotResized",AdManagerEvents={DetachedFromDom:"detachedFromDom",AdsEnabled:"adsEnabled"},BreakPointsHandler_BreakPointsHandler=function(){function BreakPointsHandler(_targetElement,deviceType,breakpoints,_breakpointClasses){classCallCheck_default()(this,BreakPointsHandler),this._targetElement=_targetElement,this._breakpointClasses=_breakpointClasses,this._bpModel=this._getBpModels(breakpoints,deviceType)}return createClass_default()(BreakPointsHandler,[{key:"_getBpModels",value:function(breakpoints,deviceType){return Object.assign({},breakpoints[deviceType]||breakpoints[protos.ProtoDeviceType.Smartphone])}},{key:"updateWidth",value:function(width){var newSizeClass=this._getNewSizeClass(width);newSizeClass!==this.currentBreakpointClass&&(Object(DomUtils.L)(this._targetElement,this.currentBreakpointClass),Object(DomUtils.a)(this._targetElement,newSizeClass),this.currentBreakpointClass=newSizeClass)}},{key:"_getNewSizeClass",value:function(width){switch(!0){case width>=this._bpModel.xxl:return this._breakpointClasses.Xxl;case width>=this._bpModel.xl:return this._breakpointClasses.Xl;case width>=this._bpModel.lg:return this._breakpointClasses.Lg;case width>=this._bpModel.md:return this._breakpointClasses.Md;case width>=this._bpModel.sm:return this._breakpointClasses.Sm;case width>=this._bpModel.xs:return this._breakpointClasses.Xs;default:return this._breakpointClasses.Xxs}}}]),BreakPointsHandler}(),Generated_protos=__webpack_require__(36),AdsControllerEvents={MidRollCapped:"midRollCapped",TotalAdBreakLengthExpired:"totalAdBreakLengthExpired",EnableAds:"enableAds",DisableAds:"disableAds",ForceStopAdSlot:"ForceStopAdSlot",ForceStopAdPod:"ForceStopAdPod",AdOpportunity:"adOpportunity",AdPodRemainingTime:"AdPodRemainingTime"},MonetizationConfig=__webpack_require__(39),TimeConfig=__webpack_require__(20);!function(QuartilesEnum){QuartilesEnum[QuartilesEnum.FirstQuartile=0]="FirstQuartile",QuartilesEnum[QuartilesEnum.SecondQuartile=1]="SecondQuartile",QuartilesEnum[QuartilesEnum.ThirdQuartile=2]="ThirdQuartile",QuartilesEnum[QuartilesEnum.FourthQuartile=3]="FourthQuartile"}(QuartilesEnum||(QuartilesEnum={}));var slicedToArray=__webpack_require__(176),slicedToArray_default=__webpack_require__.n(slicedToArray),Observable=__webpack_require__(38),tslib_es6=__webpack_require__(31),Subscription=__webpack_require__(43),AsyncAction_AsyncAction=function(_super){function AsyncAction(scheduler,work){var _this=_super.call(this,scheduler,work)||this;return _this.scheduler=scheduler,_this.work=work,_this.pending=!1,_this}return tslib_es6.a(AsyncAction,_super),AsyncAction.prototype.schedule=function(state,delay){if(void 0===delay&&(delay=0),this.closed)return this;this.state=state;var id=this.id,scheduler=this.scheduler;return null!=id&&(this.id=this.recycleAsyncId(scheduler,id,delay)),this.pending=!0,this.delay=delay,this.id=this.id||this.requestAsyncId(scheduler,this.id,delay),this},AsyncAction.prototype.requestAsyncId=function(scheduler,id,delay){return void 0===delay&&(delay=0),setInterval(scheduler.flush.bind(scheduler,this),delay)},AsyncAction.prototype.recycleAsyncId=function(scheduler,id,delay){if(void 0===delay&&(delay=0),null!==delay&&this.delay===delay&&!1===this.pending)return id;clearInterval(id)},AsyncAction.prototype.execute=function(state,delay){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var error=this._execute(state,delay);if(error)return error;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},AsyncAction.prototype._execute=function(state,delay){var errored=!1,errorValue=void 0;try{this.work(state)}catch(e){errored=!0,errorValue=!!e&&e||new Error(e)}if(errored)return this.unsubscribe(),errorValue},AsyncAction.prototype._unsubscribe=function(){var id=this.id,scheduler=this.scheduler,actions=scheduler.actions,index=actions.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==index&&actions.splice(index,1),null!=id&&(this.id=this.recycleAsyncId(scheduler,id,null)),this.delay=null},AsyncAction}(function(_super){function Action(scheduler,work){return _super.call(this)||this}return tslib_es6.a(Action,_super),Action.prototype.schedule=function(state,delay){return void 0===delay&&(delay=0),this},Action}(Subscription.a)),Scheduler=function(){function Scheduler(SchedulerAction,now){void 0===now&&(now=Scheduler.now),this.SchedulerAction=SchedulerAction,this.now=now}return Scheduler.prototype.schedule=function(work,delay,state){return void 0===delay&&(delay=0),new this.SchedulerAction(this,work).schedule(state,delay)},Scheduler.now=function(){return Date.now()},Scheduler}(),async_async=new(function(_super){function AsyncScheduler(SchedulerAction,now){void 0===now&&(now=Scheduler.now);var _this=_super.call(this,SchedulerAction,function(){return AsyncScheduler.delegate&&AsyncScheduler.delegate!==_this?AsyncScheduler.delegate.now():now()})||this;return _this.actions=[],_this.active=!1,_this.scheduled=void 0,_this}return tslib_es6.a(AsyncScheduler,_super),AsyncScheduler.prototype.schedule=function(work,delay,state){return void 0===delay&&(delay=0),AsyncScheduler.delegate&&AsyncScheduler.delegate!==this?AsyncScheduler.delegate.schedule(work,delay,state):_super.prototype.schedule.call(this,work,delay,state)},AsyncScheduler.prototype.flush=function(action){var actions=this.actions;if(this.active)actions.push(action);else{var error;this.active=!0;do{if(error=action.execute(action.state,action.delay))break}while(action=actions.shift());if(this.active=!1,error){for(;action=actions.shift();)action.unsubscribe();throw error}}},AsyncScheduler}(Scheduler))(AsyncAction_AsyncAction),isArray=__webpack_require__(101);function interval(period,scheduler){var val;return void 0===period&&(period=0),void 0===scheduler&&(scheduler=async_async),val=period,(Object(isArray.a)(val)||!(val-parseFloat(val)+1>=0)||period<0)&&(period=0),scheduler&&"function"==typeof scheduler.schedule||(scheduler=async_async),new Observable.a(function(subscriber){return subscriber.add(scheduler.schedule(dispatch,period,{subscriber:subscriber,counter:0,period:period})),subscriber})}function dispatch(state){var subscriber=state.subscriber,counter=state.counter,period=state.period;subscriber.next(counter),this.schedule({subscriber:subscriber,counter:counter+1,period:period},period)}function _createForOfIteratorHelper(o){if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(o=function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))){var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var it,err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var TimerService_TimerService=function(){function TimerService(){classCallCheck_default()(this,TimerService)}return createClass_default()(TimerService,null,[{key:"setTimeout",value:function(callback){var duration=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._source||this._initialize(),this._addRecord(callback,duration,!0)}},{key:"setInterval",value:function(callback){var duration=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._source||this._initialize(),this._addRecord(callback,duration,!1)}},{key:"clearTimeout",value:function(id){this._records.delete(id)}},{key:"clearInterval",value:function(id){this._records.delete(id)}},{key:"_initialize",value:function(){var _this=this;this._source=interval(100),this._source.subscribe(function(){return _this._onTick()})}},{key:"_executeCallback",value:function(record){try{record.callback()}catch(e){Object(Logging.a)({message:"TimerService_error",callStack:e.stack,exception:e.message,throttle:1,level:protos.ProtoLoggingLevelEnum.INFO})}}},{key:"_onTick",value:function(){var _step,now=(new Date).getTime(),toBeDeleted=[],_iterator=_createForOfIteratorHelper(this._records);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=slicedToArray_default()(_step.value,2),_id=_step$value[0],record=_step$value[1];now-record.startTime<record.duration*(record.intervalTimesCalled+1)||(this._executeCallback(record),record.isTimeout?toBeDeleted.push(_id):record.intervalTimesCalled++)}}catch(err){_iterator.e(err)}finally{_iterator.f()}for(var _i=0,_toBeDeleted=toBeDeleted;_i<_toBeDeleted.length;_i++){var id=_toBeDeleted[_i];this._records.delete(id)}}},{key:"_addRecord",value:function(callback,duration,isTimeout){var id=++this._nextId;return this._records.set(id,{startTime:(new Date).getTime(),isTimeout:isTimeout,callback:callback,duration:duration,intervalTimesCalled:0}),id}}]),TimerService}();TimerService_TimerService._records=new Map,TimerService_TimerService._nextId=0;var DisableAdsReasonEnum,NumberUtils=__webpack_require__(23),Subject=__webpack_require__(220),Timer_Timer=function(){function Timer(){var _this=this,timerDuration=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,_intervalTick=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,_decimalPrecision=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;classCallCheck_default()(this,Timer),this.timerDuration=timerDuration,this._intervalTick=_intervalTick,this._decimalPrecision=_decimalPrecision,this._currentTimeElapsed=0,this._intervalId=null,this._disabled=!1,this._isStarted=!1,this._onTimeUpdate=new Subject.a,this._onTimeElapsed=new Subject.a,this._onQuartile=new Subject.a,this._quartileEvents=[{event:QuartilesEnum.FirstQuartile,quartile:1},{event:QuartilesEnum.SecondQuartile,quartile:2},{event:QuartilesEnum.ThirdQuartile,quartile:3},{event:QuartilesEnum.FourthQuartile,quartile:4}],this._currentQuartile=null,this._handleIntervalTick=function(){_this._cacheCurrentTime(),_this._onTimeUpdate.next(),_this._checkElapsedTime(),_this._startingTime=(new Date).getTime()},timerDuration||this.disable()}return createClass_default()(Timer,[{key:"start",value:function(){this._isStarted=!0,null===this._intervalId&&this._resumeTimer()}},{key:"stop",value:function(){this._isStarted=!1,null!==this._intervalId&&(this._cacheCurrentTime(),this._pauseTimer())}},{key:"reset",value:function(newDuration){newDuration&&(this.timerDuration=newDuration),this._currentTimeElapsed=0,this._disabled=!1,this._currentQuartile=null,(null!==this._intervalId||this._isStarted)&&(this._pauseTimer(),this._resumeTimer())}},{key:"disable",value:function(){this._disabled=!0,this._pauseTimer()}},{key:"_cacheCurrentTime",value:function(){this._currentTimeElapsed+=(new Date).getTime()-this._startingTime}},{key:"_resumeTimer",value:function(){this._disabled||(this._checkElapsedTime(),this._startingTime=(new Date).getTime(),this._intervalId=TimerService_TimerService.setInterval(this._handleIntervalTick,this._intervalTick))}},{key:"_pauseTimer",value:function(){TimerService_TimerService.clearInterval(this._intervalId),this._intervalId=null}},{key:"_handleTimeElapsed",value:function(){this.disable(),this._onTimeElapsed.next(),this._handleQuartileCalculation(this._currentTimeElapsed,this.timerDuration,this._decimalPrecision),this._currentTimeElapsed=0}},{key:"_checkElapsedTime",value:function(){this._currentTimeElapsed/TimeConfig.f>=this.timerDuration/TimeConfig.f&&this._handleTimeElapsed()}},{key:"_handleQuartileCalculation",value:function(timeElapsed,totalDuration,decimalPrecision){var remainingTimeInSeconds=Object(NumberUtils.h)(timeElapsed/TimeConfig.f,decimalPrecision);this._handleQuartiles(remainingTimeInSeconds,totalDuration)}},{key:"_handleQuartiles",value:function(elapsedTime,duration){var _this2=this,calculatedQuartile=Math.floor(Object(NumberUtils.g)(0,duration,0,4,elapsedTime));this._currentQuartile<=calculatedQuartile&&(this._quartileEvents.forEach(function(_ref){var event=_ref.event;_ref.quartile===calculatedQuartile&&_this2._onQuartile.next(event)}),this._currentQuartile++)}},{key:"timeElapsed",get:function(){return this._currentTimeElapsed}},{key:"timeRemaining",get:function(){return this.timerDuration-this._currentTimeElapsed}},{key:"onTimeUpdate",get:function(){return this._onTimeUpdate.asObservable()}},{key:"onTimeElapsed",get:function(){return this._onTimeElapsed.asObservable()}},{key:"onQuartile",get:function(){return this._onQuartile.asObservable()}}]),Timer}();function clearSubscriptions(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(subscription){return subscription.unsubscribe()})}function AdsController_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}!function(DisableAdsReasonEnum){DisableAdsReasonEnum[DisableAdsReasonEnum.Unknown=0]="Unknown",DisableAdsReasonEnum[DisableAdsReasonEnum.TimeoutBetweenAds=1]="TimeoutBetweenAds"}(DisableAdsReasonEnum||(DisableAdsReasonEnum={}));var PlayspaceLayoutEnum,AdsController_AdsController=function(_Mediator){inherits_default()(AdsController,_Mediator);var _super=AdsController_createSuper(AdsController);function AdsController(mediator,currentPlayerViewability,controlData,app){var _this;return classCallCheck_default()(this,AdsController),(_this=_super.call(this)).mediator=mediator,_this.controlData=controlData,_this.app=app,_this._rollsNumbers=0,_this._midRollNumbers=0,_this._skipAdDurationTimeoutId=null,_this._timerSubscriptions=new Map,_this.currentPlayerAdSlot=Generated_protos.ProtoAdSlotsEnum.PreRoll,_this._disableReasons={stopped:!1,viewability:!1,inImpression:!1,forceDisable:!1,zeroDimension:!1,isAppBackgrounded:!1,inAppRecyclerViewViewability:!1},_this.firstAdBreakStarted=!1,_this._canTriggerAdOpportunity=!1,_this.viewabilityStateChanged(currentPlayerViewability),_this.onResize(_this.controlData.playerDimensions.width,_this.controlData.playerDimensions.height),_this.controlData.totalAdBreakLength&&(_this._totalAdBreakLengthTimer=new Timer_Timer(_this.controlData.totalAdBreakLength),_this._timerSubscriptions.set(_this._totalAdBreakLengthTimer,[_this._totalAdBreakLengthTimer.onTimeElapsed.subscribe(function(){_this.mediator.publish(assertThisInitialized_default()(_this),AdsControllerEvents.TotalAdBreakLengthExpired)})])),_this}return createClass_default()(AdsController,[{key:"_isMidrollLimit",value:function(){return this._midRollNumbers>=this.controlData.numberOfMidRolls&&-1!==this.controlData.numberOfMidRolls}},{key:"_clearAdTimer",value:function(adDurationTimer){if(adDurationTimer)return adDurationTimer.stop(),clearSubscriptions(this._timerSubscriptions.get(adDurationTimer)),this._timerSubscriptions.delete(adDurationTimer),null}},{key:"_enableAds",value:function(){if(this._canTriggerAdOpportunity){this._canTriggerAdOpportunity=!1;var slotToBreakMapping=(_ref={},defineProperty_default()(_ref,protos.ProtoAdSlotsEnum.PreRoll,protos.ProtoAdBreakTypeEnum.PreRoll),defineProperty_default()(_ref,protos.ProtoAdSlotsEnum.MidRoll,protos.ProtoAdBreakTypeEnum.MidRoll),defineProperty_default()(_ref,protos.ProtoAdSlotsEnum.PostRoll,protos.ProtoAdBreakTypeEnum.PostRoll),_ref);this.mediator.publish(this,AdsControllerEvents.AdOpportunity,{payload:{adBreakType:slotToBreakMapping[this.currentPlayerAdSlot]}})}var _ref;this.mediator.publish(this,AdsControllerEvents.EnableAds),this._totalAdBreakLengthTimer&&this._totalAdBreakLengthTimer.start()}},{key:"canEnableAds",value:function(){return this._disableReasons.stopped||this._disableReasons.viewability||this._disableReasons.inImpression||this._disableReasons.forceDisable||this._disableReasons.zeroDimension||this._disableReasons.isAppBackgrounded||this._disableReasons.inAppRecyclerViewViewability?{enableAds:!1,disableReason:DisableAdsReasonEnum.Unknown}:this.currentPlayerAdSlot===Generated_protos.ProtoAdSlotsEnum.MidRoll&&this._isMidrollLimit()?{enableAds:!1,disableReason:DisableAdsReasonEnum.Unknown}:this.currentPlayerAdSlot!==Generated_protos.ProtoAdSlotsEnum.MidRoll&&this._rollsNumbers>0?{enableAds:!1,disableReason:DisableAdsReasonEnum.Unknown}:{enableAds:!0,disableReason:DisableAdsReasonEnum.Unknown}}},{key:"toggleEnableAds",value:function(){var canEnableAds=this.canEnableAds();canEnableAds.enableAds?this._enableAds():(this.mediator.publish(this,AdsControllerEvents.DisableAds,{payload:canEnableAds.disableReason}),this._totalAdBreakLengthTimer&&!this._disableReasons.inImpression&&this._totalAdBreakLengthTimer.stop())}},{key:"startAds",value:function(){this._disableReasons.stopped=!1,this.toggleEnableAds()}},{key:"forceRecheck",value:function(){this.toggleEnableAds()}},{key:"onAdImpression",value:function(data){var _this2=this;this.currentPlayerAdSlot===Generated_protos.ProtoAdSlotsEnum.MidRoll&&(this.firstAdBreakStarted||(this.firstAdBreakStarted=!0)),this._disableReasons.inImpression=!0,this.toggleEnableAds(),this._startAdSlotDurationTimer(),this._startAdPodDurationTimer();var limitAdPlaybackTime=this._getLimitAdPlaytimeRegardingSkippability(data.payload.adSkipMode,data.payload.adDuration);limitAdPlaybackTime>0&&(this._skipAdDurationTimeoutId=setTimeout(function(){_this2.mediator.publish(_this2,AdsControllerEvents.ForceStopAdSlot)},limitAdPlaybackTime*TimeConfig.f))}},{key:"_startAdPodDurationTimer",value:function(){var _this3=this;this.controlData.maxAdPodDuration&&!this._adPodDurationTimer&&(this._adPodDurationTimer=new Timer_Timer(this.controlData.maxAdPodDuration),this._adPodDurationTimer.start(),this._timerSubscriptions.set(this._adPodDurationTimer,[this._adPodDurationTimer.onTimeElapsed.subscribe(function(){_this3.mediator.publish(_this3,AdsControllerEvents.ForceStopAdPod)}),this._adPodDurationTimer.onTimeUpdate.subscribe(function(){var podRemainingTime=_this3._adPodDurationTimer.timeRemaining;_this3.mediator.publish(_this3,AdsControllerEvents.AdPodRemainingTime,{payload:{remainingTime:podRemainingTime}})})]))}},{key:"_startAdSlotDurationTimer",value:function(){var _this4=this;this.controlData.maxAdSlotDuration&&!this._adSlotDurationTimer&&(this._adSlotDurationTimer=new Timer_Timer(this.controlData.maxAdSlotDuration),this._adSlotDurationTimer.start(),this._timerSubscriptions.set(this._adSlotDurationTimer,[this._adSlotDurationTimer.onTimeElapsed.subscribe(function(){_this4.mediator.publish(_this4,AdsControllerEvents.ForceStopAdSlot)})]))}},{key:"_getLimitAdPlaytimeRegardingSkippability",value:function(adSkipMode,adDuration){switch(this.controlData.playerAdsSkippability){case protos.ProtoPlayerAdSkippability.IfLongerThan:if((adSkipMode===protos.ProtoAdSkipMode.Never||adSkipMode===protos.ProtoAdSkipMode.IfLongerThan31Sec)&&!adDuration)return this.controlData.adsMustBeSkippableIfLongerThan;if(adSkipMode===protos.ProtoAdSkipMode.Never&&adDuration>this.controlData.adsMustBeSkippableIfLongerThan)return this.controlData.adsMustBeSkippableIfLongerThan;break;case protos.ProtoPlayerAdSkippability.NoRestrictions:if(adSkipMode===protos.ProtoAdSkipMode.IfLongerThan31Sec&&!adDuration)return MonetizationConfig.d}return 0}},{key:"onAdFinished",value:function(inImpression){var inPod=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._adSlotDurationTimer=this._clearAdTimer(this._adSlotDurationTimer),inPod||(this._adPodDurationTimer=this._clearAdTimer(this._adPodDurationTimer),this.currentPlayerAdSlot===Generated_protos.ProtoAdSlotsEnum.MidRoll?this._midRollNumbers++:this._rollsNumbers++),this._isMidrollLimit()&&!inPod&&this.mediator.publish(this,AdsControllerEvents.MidRollCapped),inImpression&&(this._canTriggerAdOpportunity=!0),this._disableReasons.inImpression=!1,inPod?this._enableAds():this.toggleEnableAds(),clearTimeout(this._skipAdDurationTimeoutId)}},{key:"onAdPause",value:function(){this._adPodDurationTimer&&this._adPodDurationTimer.stop(),this._adSlotDurationTimer&&this._adSlotDurationTimer.stop(),this._totalAdBreakLengthTimer&&this._totalAdBreakLengthTimer.stop()}},{key:"onAdPlay",value:function(){this._adPodDurationTimer&&this._adPodDurationTimer.start(),this._adSlotDurationTimer&&this._adSlotDurationTimer.start(),this._totalAdBreakLengthTimer&&this._totalAdBreakLengthTimer.start()}},{key:"onStop",value:function(){this.currentPlayerAdSlot=null,this._disableReasons.stopped=!0,this.toggleEnableAds()}},{key:"onAdStateChange",value:function(adSlot,durationLimits,contentDuration){this.controlData.maxAdSlotDuration=durationLimits.maxAdSlotDuration,this.controlData.maxAdPodDuration=durationLimits.maxAdPodDuration,adSlot===this.currentPlayerAdSlot&&adSlot===Generated_protos.ProtoAdSlotsEnum.MidRoll||(null===adSlot&&this._previousPlayerAdSlot===Generated_protos.ProtoAdSlotsEnum.MidRoll||(this._canTriggerAdOpportunity=!0),adSlot!==Generated_protos.ProtoAdSlotsEnum.MidRoll&&(this._rollsNumbers=0,this.firstAdBreakStarted=!1),this.currentPlayerAdSlot=adSlot,this._previousPlayerAdSlot=adSlot,this.startAds())}},{key:"contentChanged",value:function(){this._midRollNumbers=0,this.firstAdBreakStarted=!1,this.toggleEnableAds()}},{key:"viewabilityStateChanged",value:function(inView){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var inPodLoading=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._inView=inView,this.controlData.viewabilityPolicy===Generated_protos.ProtoAdViewabilityPolicy.Strict&&(this._disableReasons.viewability=!inView),inPodLoading||this.toggleEnableAds()}},{key:"setToggleAdsReason",value:function(reasons){this._disableReasons.isAppBackgrounded=reasons.isAppBackgrounded,this._disableReasons.inAppRecyclerViewViewability=reasons.inAppRecyclerViewViewability,this.toggleEnableAds()}},{key:"disableAdvertising",value:function(){this._disableReasons.forceDisable=!0,this.toggleEnableAds()}},{key:"enableAdvertising",value:function(){this._disableReasons.forceDisable=!1,this.toggleEnableAds()}},{key:"destroy",value:function(){this._totalAdBreakLengthTimer&&this._totalAdBreakLengthTimer.disable(),clearTimeout(this._skipAdDurationTimeoutId),this._adSlotDurationTimer=this._clearAdTimer(this._adSlotDurationTimer),this._adPodDurationTimer=this._clearAdTimer(this._adPodDurationTimer)}},{key:"onResize",value:function(width,height){this._disableReasons.zeroDimension=0===width||0===height,this.toggleEnableAds()}},{key:"inView",get:function(){return this._inView}}]),AdsController}(Mediator.a);!function(PlayspaceLayoutEnum){PlayspaceLayoutEnum[PlayspaceLayoutEnum.Portrait=0]="Portrait",PlayspaceLayoutEnum[PlayspaceLayoutEnum.Landscape=1]="Landscape"}(PlayspaceLayoutEnum||(PlayspaceLayoutEnum={}));var VideoQualityEnum,ContentStatesEnum,VideoEncodingsEnum,Config_PlayspaceLayoutEnum=PlayspaceLayoutEnum,ImageCachingHandler_ImageCachingHandler=function(){function ImageCachingHandler(urlSuffixerService){classCallCheck_default()(this,ImageCachingHandler),this.urlSuffixerService=urlSuffixerService,this._cachedImages={},this._imageInfoList=[]}return createClass_default()(ImageCachingHandler,[{key:"getImage",value:function(baseUrl,altText,width,height){var params=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",useClosestImage=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this._baseUrl=baseUrl,this._altText=Object(TypeUtils.h)(altText)?altText:"",this._width=width,this._height=height,this._params=params,this._useClosestImage=useClosestImage,this._cacheImage()}},{key:"_cacheImage",value:function(){var cachedImage=this._getCachedImage();if(cachedImage)return cachedImage;var url=this._baseUrl+this._params,img=new Image;return img.src=this.urlSuffixerService.appendParamsToUrl(url),img.alt=this._altText,this._cachedImages[this._baseUrl]=this._cachedImages[this._baseUrl]||{},this._cachedImages[this._baseUrl][this._width]=this._cachedImages[this._baseUrl][this._width]||{},this._cachedImages[this._baseUrl][this._width][this._height]=this._cachedImages[this._baseUrl][this._width][this._height]||{},this._cachedImages[this._baseUrl][this._width][this._height][this._params]=img,img}},{key:"_getCachedImage",value:function(){var exactMatch=this._getExactMatch();if(exactMatch)return exactMatch;if(this._useClosestImage){this._computeImageInfoList();var closestLargerImage=this._getClosestLargerImage();if(closestLargerImage)return closestLargerImage;var closestSmallerImage=this._getClosestSmallerImage();return closestSmallerImage||void 0}}},{key:"_computeImageInfoList",value:function(){var _this=this,imageInfoList=[];if(this._cachedImages[this._baseUrl]){var cachedImagesByUrl=this._cachedImages[this._baseUrl],currentOrientation=this._width>this._height?Config_PlayspaceLayoutEnum.Landscape:Config_PlayspaceLayoutEnum.Portrait;Object.keys(cachedImagesByUrl).forEach(function(widthKey){var width=parseInt(widthKey,10);Object.keys(cachedImagesByUrl[widthKey]).filter(function(heightKey){return!!cachedImagesByUrl[widthKey][heightKey]}).forEach(function(heightKey){var height=parseInt(heightKey,10);if((width>height?Config_PlayspaceLayoutEnum.Landscape:Config_PlayspaceLayoutEnum.Portrait)===currentOrientation){var imageInfo={area:width*height,img:_this._getCachedImageByWidthAndHeight(_this._baseUrl,width,height)};imageInfoList.push(imageInfo)}})}),this._imageInfoList=[].concat(imageInfoList)}else this._imageInfoList=[]}},{key:"_getCachedImageByWidthAndHeight",value:function(baseUrl,width,height){if(this._cachedImages[baseUrl]&&this._cachedImages[baseUrl][width]&&this._cachedImages[baseUrl][width][height])return this._cachedImages[baseUrl][width][height][Object.keys(this._cachedImages[baseUrl][width][height])[0]]}},{key:"_getExactMatch",value:function(){return this._cachedImages[this._baseUrl]&&this._cachedImages[this._baseUrl][this._width]&&this._cachedImages[this._baseUrl][this._width][this._height]&&this._cachedImages[this._baseUrl][this._width][this._height][this._params]}},{key:"_getClosestLargerImage",value:function(){if(0!==this._imageInfoList.length){var currentArea=this._width*this._height,orderedImageInfoList=this._imageInfoList.filter(function(_ref){return _ref.area>currentArea}).sort(function(a,b){return a.area-b.area});if(0!==orderedImageInfoList.length)return orderedImageInfoList[0].img}}},{key:"_getClosestSmallerImage",value:function(){if(0!==this._imageInfoList.length){var currentArea=this._width*this._height,orderedImageInfoList=this._imageInfoList.filter(function(_ref2){var area=_ref2.area;return area<currentArea&&currentArea/area<=1.3}).sort(function(a,b){return b.area-a.area});if(0!==orderedImageInfoList.length)return orderedImageInfoList[0].img}}}]),ImageCachingHandler}(),AdStateEnum=__webpack_require__(98),VideoTagEvents={Play:"play",Pause:"pause",Mute:"mute",Unmute:"unmute",Canplay:"canplay",Ended:"ended",Timeupdate:"timeupdate",Seeking:"seeking",Seeked:"seeked",Volumechange:"volumechange",Durationchange:"durationchange",Fullscreen:"fullscreen",LoadedData:"loadeddata",LoadedMetadata:"loadedmetadata",Error:"error"};!function(VideoQualityEnum){VideoQualityEnum[VideoQualityEnum.Auto=0]="Auto",VideoQualityEnum[VideoQualityEnum.Strict=1]="Strict"}(VideoQualityEnum||(VideoQualityEnum={})),function(ContentStatesEnum){ContentStatesEnum[ContentStatesEnum.PlayingState=0]="PlayingState",ContentStatesEnum[ContentStatesEnum.PausedState=1]="PausedState",ContentStatesEnum[ContentStatesEnum.PrerollState=2]="PrerollState",ContentStatesEnum[ContentStatesEnum.PostrollState=3]="PostrollState",ContentStatesEnum[ContentStatesEnum.StoppedState=4]="StoppedState",ContentStatesEnum[ContentStatesEnum.ReplayState=5]="ReplayState",ContentStatesEnum[ContentStatesEnum.HiddenState=6]="HiddenState",ContentStatesEnum[ContentStatesEnum.BufferingState=7]="BufferingState",ContentStatesEnum[ContentStatesEnum.LiveStreamStarting=8]="LiveStreamStarting",ContentStatesEnum[ContentStatesEnum.LiveStreamEnded=9]="LiveStreamEnded",ContentStatesEnum[ContentStatesEnum.LiveStreamStopped=10]="LiveStreamStopped",ContentStatesEnum[ContentStatesEnum.LiveStreamNotSupported=11]="LiveStreamNotSupported"}(ContentStatesEnum||(ContentStatesEnum={})),function(VideoEncodingsEnum){VideoEncodingsEnum.H264="h264",VideoEncodingsEnum.Hevc="hevc"}(VideoEncodingsEnum||(VideoEncodingsEnum={}));var ExternalQualityEnum,VideoEventsEnum={PlayError:"playError",NewVideo:"newVideo",Buffering:"buffering",Buffered:"buffered",LevelSwitching:"levelSwitching",EndOfStream:"endOfStream",LiveStreamNotPlayable:"liveNotPlayable"},VideoQualityEventsEnum={Change:"VideoQualityChanged",CurrentQuality:"CurrentQuality",Loaded:"QualityListLoaded"};!function(ExternalQualityEnum){ExternalQualityEnum[ExternalQualityEnum.Low144p=144]="Low144p",ExternalQualityEnum[ExternalQualityEnum.Low240p=240]="Low240p",ExternalQualityEnum[ExternalQualityEnum.Medium360p=360]="Medium360p",ExternalQualityEnum[ExternalQualityEnum.Medium480p=480]="Medium480p",ExternalQualityEnum[ExternalQualityEnum.High720p=720]="High720p",ExternalQualityEnum[ExternalQualityEnum.High1080p=1080]="High1080p"}(ExternalQualityEnum||(ExternalQualityEnum={}));var VIDEO_HD_HEIGHT=720;function getPlaylistHelperIndexes(playlist,currentIndex){var lastIndex=playlist.length-1;return{currentIndex:currentIndex,nextIndex:currentIndex===lastIndex?0:currentIndex+1,prevIndex:0===currentIndex?lastIndex:currentIndex-1,firstIndex:0,lastIndex:lastIndex}}var AdBreakController_AdBreakController=function(){function AdBreakController(_adBreaks){classCallCheck_default()(this,AdBreakController),this._adBreaks=_adBreaks,this._currentAdBreakStatus={breakType:protos.ProtoAdBreakTypeEnum.None,currentPodNumber:0,maxAdSlotDuration:0,maxAdPodDuration:0,totalNumberOfAdSlots:0},this._podTimeout=null}return createClass_default()(AdBreakController,[{key:"setNewBreak",value:function(adSlot){var _this=this;this._adBreaks.forEach(function(adBreak){adBreak.types.forEach(function(adBreakType){(function(adBreakType,adSlotType){var matches=!1;switch(adBreakType){case protos.ProtoAdBreakTypeEnum.PreRoll:matches=adSlotType===protos.ProtoAdSlotsEnum.PreRoll;break;case protos.ProtoAdBreakTypeEnum.MidRoll:matches=adSlotType===protos.ProtoAdSlotsEnum.MidRoll;break;case protos.ProtoAdBreakTypeEnum.PostRoll:matches=adSlotType===protos.ProtoAdSlotsEnum.PostRoll}return matches})(adBreakType,adSlot)&&(_this._currentAdBreakStatus.currentPodNumber=adBreak.numberOfAdSlots,_this._currentAdBreakStatus.maxAdSlotDuration=adBreak.maxAdSlotDuration,_this._currentAdBreakStatus.maxAdPodDuration=adBreak.maxAdPodDuration,_this._currentAdBreakStatus.totalNumberOfAdSlots=adBreak.numberOfAdSlots)})})}},{key:"adStarted",value:function(){this._stopAdPodLoadingTimeout(),0===this._currentAdBreakStatus.currentPodNumber&&(this._currentAdBreakStatus.currentPodNumber=this._currentAdBreakStatus.totalNumberOfAdSlots),this._currentAdBreakStatus.currentPodNumber--}},{key:"endPod",value:function(){this._stopAdPodLoadingTimeout(),this._currentAdBreakStatus.currentPodNumber=0}},{key:"enterPodTimeout",value:function(onTimeoutFinished){var _this2=this;this._stopAdPodLoadingTimeout(),this._podTimeout=setTimeout(function(){_this2._stopAdPodLoadingTimeout(),onTimeoutFinished()},5e3)}},{key:"isInAdPod",value:function(){return this._currentAdBreakStatus.currentPodNumber>0}},{key:"isCurrentBreakInPod",value:function(){return this._currentAdBreakStatus.totalNumberOfAdSlots>1}},{key:"getMaxAdSlotDuration",value:function(){return this._currentAdBreakStatus.maxAdSlotDuration}},{key:"getMaxAdPodDuration",value:function(){return this._currentAdBreakStatus.maxAdPodDuration}},{key:"getMaxAdSlotPossibleDuration",value:function(){for(var maxAdSlotPossibleDuration=0,i=0;i<this._adBreaks.length;i++){if(0===this._adBreaks[i].maxAdSlotDuration)return 0;maxAdSlotPossibleDuration=Math.max(maxAdSlotPossibleDuration,this._adBreaks[i].maxAdSlotDuration)}return maxAdSlotPossibleDuration}},{key:"getCurrentSlotIndex",value:function(){return this._currentAdBreakStatus.totalNumberOfAdSlots-this._currentAdBreakStatus.currentPodNumber}},{key:"getNextSlotIndex",value:function(){var currentSlotIndex=this.getCurrentSlotIndex();return this._currentAdBreakStatus.totalNumberOfAdSlots>currentSlotIndex?currentSlotIndex+1:1}},{key:"getTotalNumberOfSlots",value:function(){return this._currentAdBreakStatus.totalNumberOfAdSlots}},{key:"isInPodTimeout",value:function(){return!!this._podTimeout}},{key:"_stopAdPodLoadingTimeout",value:function(){clearTimeout(this._podTimeout),this._podTimeout=null}}]),AdBreakController}(),GeneralUtils=__webpack_require__(15),OsConfig=__webpack_require__(32);function BaseExperience_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var UiComponentsEnum,ALLOW_INVALID_DIMENSIONS_FOR_BUNDLE_IDS=["com.accuweather.android"],IOS_RESUME_AD_DELAY=.05*TimeConfig.f,BaseExperience_BaseExperience=function(_Mediator){inherits_default()(BaseExperience,_Mediator);var _super=BaseExperience_createSuper(BaseExperience);function BaseExperience(mediator,_appSettings,_urlSuffixerService){var _this$_vpaidEventsAct,_this;return classCallCheck_default()(this,BaseExperience),(_this=_super.call(this)).mediator=mediator,_this._appSettings=_appSettings,_this._urlSuffixerService=_urlSuffixerService,_this._VIEWABILITY_THRESHOLD=.01,_this._VIEWABILITY_TRACKING_THRESHOLD=.5,_this._VIEWABILITY_TIMEOUT_RENDERED=2e3,_this._initialViewThreshold=0,_this._soundOnHoverListenersEnabled=!1,_this._experienceStarted=!1,_this._emittedAdBreak=!1,_this._emittedContentPlaying=!1,_this._emittedSessionStart=!1,_this._emittedWithinPostroll=!1,_this._inView=!1,_this._currentAdState=protos.ProtoAdSlotsEnum.PreRoll,_this._isFullscreen=!1,_this._isViewabilityTrackable=!1,_this._hasPlayerStarted=!1,_this._adPausedWithUserInteraction=!1,_this._forceBackgroundPaused=!1,_this._forcedBackgroundBeforePausedState=!1,_this._isContentPausedState=!1,_this._vpaidEventsActions=(_this$_vpaidEventsAct={},defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdRemainingTimeChange,function(data){var _a;_this._forceBackgroundPaused&&_this.app.config.isInAppAndroid&&(null===(_a=_this.adHandler)||void 0===_a||_a.pause())}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdImpression,function(data){_this._adsController.onAdImpression(data),_this._showAd(),_this.mediator.publish(assertThisInitialized_default()(_this),ApiConfig.b.AdImpression,data);var _data$payload=data.payload,adSourceData=_data$payload.adSourceData,customAdData=_data$payload.customAdData;_this._emitAdImpression(adSourceData,customAdData)}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdStopped,function(data){_this.mediator.publish(assertThisInitialized_default()(_this),ApiConfig.b.AdStopped,data),_this._onAdStopped(),_this._emitAdComplete(),_this.app.services.EventsStorageService.emitAdStopped(),_this._inView&&_this._emitAdBreakComplete()}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdError,function(data){_this.adHandler.inImpression&&_this._onAdStopped(),_this.mediator.publish(assertThisInitialized_default()(_this),ApiConfig.b.AdError,data),_this.app.services.EventsStorageService.emitAdError()}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdSkipped,function(data){_this.mediator.publish(assertThisInitialized_default()(_this),ApiConfig.b.AdSkipped,data),_this.app.services.EventsStorageService.emitAdSkipped();_this.floatingModule&&(_this.floatingModule.enabled=!0),_this._onAdStopped(!0),_this._emitAdComplete(),_this._inView&&_this._emitAdBreakComplete()}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdPaused,function(data){_this._adsController.onAdPause(),_this.app.services.TrackingService.setSessionPlayback(!1),_this.app.services.EventsStorageService.emitAdPaused(),_this.mediator.publish(assertThisInitialized_default()(_this),ApiConfig.b.AdPause,data)}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdPlaying,function(data){_this._adsController.onAdPlay(),_this.app.services.TrackingService.setSessionPlayback(!0),_this.app.services.EventsStorageService.emitAdPlaying(),_this.mediator.publish(assertThisInitialized_default()(_this),ApiConfig.b.AdPlay,data)}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdVideoFirstQuartile,function(data){_this.mediator.publish(assertThisInitialized_default()(_this),ApiConfig.b.AdCompleted25,data),_this.app.services.EventsStorageService.emitAdVideoFirstQuartile()}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdVideoMidpoint,function(data){_this.mediator.publish(assertThisInitialized_default()(_this),ApiConfig.b.AdCompleted50,data),_this.app.services.EventsStorageService.emitAdVideoMidpoint()}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdVideoThirdQuartile,function(data){_this.mediator.publish(assertThisInitialized_default()(_this),ApiConfig.b.AdCompleted75,data),_this.app.services.EventsStorageService.emitAdVideoThirdQuartile()}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdVideoComplete,function(data){_this.mediator.publish(assertThisInitialized_default()(_this),ApiConfig.b.AdCompleted100,data),_this.app.services.EventsStorageService.emitAdVideoComplete()}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdClickThru,function(data){_this.mediator.publish(assertThisInitialized_default()(_this),ApiConfig.b.AdClick,data),_this.app.services.EventsStorageService.emitAdClickThru()}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdInteraction,function(){_this.app.services.EventsStorageService.emitAdInteraction()}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdUserAcceptInvitation,function(){_this.app.services.EventsStorageService.emitAdInteraction()}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdUserClose,function(){_this.app.services.EventsStorageService.emitAdInteraction()}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdUserMinimize,function(){_this.app.services.EventsStorageService.emitAdInteraction()}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdVideoStart,function(data){var adSourceData=data.payload.adSourceData,adVideoStartMetadata={duration:adSourceData&&adSourceData.length,mediaPlayerVolume:_this.getVolume()};_this.app.services.EventsStorageService.emitAdVideoStart(adVideoStartMetadata)}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdLoaded,function(data){var _a,adLoadedData=data.payload.adLoadedData;(null===(_a=adLoadedData)||void 0===_a?void 0:_a.skipOffset)<0&&(adLoadedData.skipOffset=void 0);var properties=_this._getAdLoadedProperties(adLoadedData);_this.app.services.EventsStorageService.emitAdLoaded(properties)}),defineProperty_default()(_this$_vpaidEventsAct,VastConfig.b.AdVolumeChange,function(){_this.app.services.EventsStorageService.emitAdVolumeChange()}),_this$_vpaidEventsAct),_this._getVpaidEventAction=function(event){return function(data){var vpaidEventAction=_this._vpaidEventsActions[event];vpaidEventAction&&vpaidEventAction(data)}},_this._onViewCallback=function(inView){_this._isViewabilityTrackable=inView,inView&&(_this.app.services.ViewabilityService.off(_this.$playerContainer,_this._onViewCallback),_this._handleSessionViewTracking())},_this._handleIosWebBackgrounded=function(inView){inView&&_this.adHandler&&!_this._adPausedWithUserInteraction&&setTimeout(function(){_this.adHandler.resumeWithoutUserInteraction()},IOS_RESUME_AD_DELAY)},_this._onMainContainerResize=function(){!_this._experienceStarted&&_this._canStart()&&(_this.mediator.publish(assertThisInitialized_default()(_this),ExperienceConfig.b.CanStart),_this.app.services.ResizeObserver.off(_this.$experienceContainer,_this._onMainContainerResize))},_this._handleFloatingOnUserInteraction=function(_ref){var _ref$payload=_ref.payload,playback=_ref$payload.playback,isFullscreenClose=_ref$payload.isFullscreenClose;_this.floatingModule&&Object(TypeUtils.a)(playback)&&!isFullscreenClose&&(_this.floatingModule.enabled=playback)},_this._handleHoverOverPlayer=function(){_this._setVolumeIfNeeded(1)},_this._handleHoverOutPlayer=function(){_this._setVolumeIfNeeded(0)},_this._onAdHandlerUserInteraction=function(data){_this._handleFloatingOnUserInteraction(data);var playback=data.payload.playback;Object(TypeUtils.a)(playback)&&(playback?(_this.app.services.EventsStorageService.emitAdPlay(),_this._adPausedWithUserInteraction=!1):(_this.app.services.EventsStorageService.emitAdPause(),_this._adPausedWithUserInteraction=!0))},_this._imageCachingHandler=new ImageCachingHandler_ImageCachingHandler(_urlSuffixerService),_this}return createClass_default()(BaseExperience,[{key:"_initRatioFacade",value:function(){}},{key:"_emitAdImpression",value:function(adObjectMetadata,customAdMetadata){this.app.services.EventsStorageService.emitAdImpression(adObjectMetadata,customAdMetadata)}},{key:"_emitAdComplete",value:function(){this.app.services.EventsStorageService.emitAdComplete()}},{key:"_emitAdBreakStart",value:function(){}},{key:"_emitAdBreakComplete",value:function(){}},{key:"_emitSessionStart",value:function(){}},{key:"_emitPlay",value:function(){}},{key:"_emitPause",value:function(){}},{key:"_emitSessionEnd",value:function(){}},{key:"_emitContentComplete",value:function(){}},{key:"_emitAdStateChange",value:function(state){var adStateChangeMetadata={state:state};this.app.services.EventsStorageService.emitAdStateChange(adStateChangeMetadata)}},{key:"_emitPlayerResized",value:function(){var _this$$playerContaine=this.$playerContainer,dimensions={width:_this$$playerContaine.clientWidth,height:_this$$playerContaine.clientHeight};this.app.services.EventsStorageService.emitPlayerResized(dimensions)}},{key:"_emitOnEnterFullscreen",value:function(){this.app.services.EventsStorageService.emitOnEnterFullscreen()}},{key:"_emitOnExitFullscreen",value:function(){this.app.services.EventsStorageService.emitOnExitFullscreen()}},{key:"_emitOnPlayerCollapsed",value:function(){this.app.services.EventsStorageService.emitOnPlayerCollapsed()}},{key:"_emitOnPlayerExpanded",value:function(){this.app.services.EventsStorageService.emitOnPlayerExpanded()}},{key:"_changeAdState",value:function(adState){this._updateAdBreaksHelperState(adState),this._updateAdHandlerState(adState),this._updateAdsControllerState(adState),this._currentAdState=adState,this._onChangeAdStateEmitAdStateChange(adState)}},{key:"_updateAdHandlerState",value:function(adState){this.adHandler&&this.adHandler.adStateChange(adState,this._adBreaksHelper.getMaxAdSlotDuration())}},{key:"_updateAdsControllerState",value:function(adState){this._adsController.onAdStateChange(adState,{maxAdPodDuration:this._adBreaksHelper.getMaxAdPodDuration(),maxAdSlotDuration:this._adBreaksHelper.getMaxAdSlotDuration()})}},{key:"_updateAdBreaksHelperState",value:function(adState){this._adBreaksHelper.setNewBreak(adState)}},{key:"_onChangeAdStateEmitAdStateChange",value:function(adState){this._emitAdStateChange(AdStateEnum.b[adState])}},{key:"_onContentChange",value:function(){this.adHandler&&this.adHandler.contentChanged(),this._adsController.contentChanged()}},{key:"_initAdHandler",value:function(){var _this2=this;this.adHandler=this._getAdHandler(),this._subscribeToVpaidEvents(),this.relay(ApiConfig.b.ImpressionPrice,this.adHandler,this,this.mediator),this.relay(ApiConfig.b.ImpressionRevenue,this.adHandler,this,this.mediator),this.subscribe(ExperienceConfig.b.UserInteraction,this.adHandler,this._onAdHandlerUserInteraction),this.subscribe(AdHandlerEventsEnum_DetachedFromDom,this.adHandler,function(){_this2.app.services.GlobalDomUtilsService.isDetachedFromDOM(_this2.$experienceContainer)?_this2.triggerDestroy():(_this2.unsubscribeAll(_this2.adHandler),_this2.adHandler.destroy(),_this2.adHandler=null,Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"only_adHandler_destroyed",sendMaxLog:!1,throttle:1}))});this.subscribe(AdManagerEvents.AdsEnabled,this.adHandler,function onAdsEnabled(){_this2.app.services.TrackingService.setAdStart(),_this2._hasPlayerStarted=!0,_this2._adPausedWithUserInteraction=!1,_this2._handleSessionViewTracking(),_this2.unsubscribe(AdManagerEvents.AdsEnabled,_this2.adHandler,onAdsEnabled)}),this.subscribe(AdHandlerEventsEnum_AdSlotResized,this.adHandler,function(_ref2){var _ref2$payload=_ref2.payload,width=_ref2$payload.width,height=_ref2$payload.height;_this2._adsController.onResize(width,height)})}},{key:"_subscribeToVpaidEvents",value:function(){var _this3=this;Object.keys(VastConfig.b).forEach(function(key){_this3.subscribe(VastConfig.b[key],_this3.adHandler,function(data){var vpaidEvent=VastConfig.b[key];_this3._getVpaidEventAction(vpaidEvent)(data),_this3.mediator.publish(_this3,vpaidEvent,data)})})}},{key:"_onAdStopped",value:function(){var forceStopAd=arguments.length>0&&void 0!==arguments[0]&&arguments[0],isInPod=this._adBreaksHelper.isInAdPod();forceStopAd&&(isInPod=!1,this._adBreaksHelper.endPod()),this._adsController.onAdFinished(this.adHandler.inImpression,isInPod),this._hideAd(),this._playerModel.isCloseButton&&this.adHandler&&this.adHandler.firstAdShown&&(this._playerModel.closeButtonMode!==protos.ProtoPlayerCloseButtonMode.OnHoverAfterFirstAd||Object(DomUtils.u)(this.$playerContainer,CssClassesConfig.g.CloseHover)||Object(DomUtils.a)(this.$playerContainer,CssClassesConfig.g.CloseHover),this._playerModel.floatingSettings.floatingCloseButtonMode!==protos.ProtoPlayerCloseButtonMode.OnHoverAfterFirstAd||Object(DomUtils.u)(this.$playerContainer,CssClassesConfig.g.CloseFloatHover)||Object(DomUtils.a)(this.$playerContainer,CssClassesConfig.g.CloseFloatHover))}},{key:"_showAd",value:function(){this._adBreaksHelper.adStarted(),this.adHandler.show()}},{key:"_hideAd",value:function(){this.adHandler.hide()}},{key:"_enterAdPodLoadingState",value:function(exitPodStateCallback){var _this4=this;this.adHandler.enterAdPodLoadingState(),this._adBreaksHelper.enterPodTimeout(function(){_this4._adBreaksHelper.endPod(),exitPodStateCallback()})}},{key:"_initAdsController",value:function(){var _this5=this;Object(DomUtils.i)(this.$playerContainer),this._adsController=this._createAdsController(),this.subscribe(AdsControllerEvents.EnableAds,this._adsController,function(){_this5.adHandler&&_this5.adHandler.enableAds()}),this.subscribe(AdsControllerEvents.DisableAds,this._adsController,function(data){_this5.adHandler&&_this5.adHandler.disableAds(data.payload)}),this.subscribe(AdsControllerEvents.ForceStopAdSlot,this._adsController,function(){_this5.adHandler&&_this5.adHandler.stopAd("forceStopAdSlot")}),this.subscribe(AdsControllerEvents.ForceStopAdPod,this._adsController,function(){if(_this5.adHandler)if(_this5.adHandler.inImpression)_this5._adBreaksHelper.endPod(),_this5.adHandler.stopAd("forceStopAdPod");else{_this5._onAdStopped(!0)}}),this.subscribe(AdsControllerEvents.AdPodRemainingTime,this._adsController,function(data){_this5.adHandler&&_this5.adHandler.updatePodRemainingTime(data.payload.remainingTime)}),this.subscribe(AdsControllerEvents.AdOpportunity,this._adsController,function(data){var _a,adBreakType=data.payload.adBreakType,adContainerWidth=null===(_a=_this5.adHandler)||void 0===_a?void 0:_a.getAdContainerWidth(),adOpportunityRequest={adBreak:adBreakType,playerWidth:Object(TypeUtils.a)(adContainerWidth)?adContainerWidth:_this5.$playerContainer.clientWidth};_this5.app.services.TrackingService.trackAdOpportunity(adOpportunityRequest),_this5.adHandler&&_this5.adHandler.newAdOpportunity()})}},{key:"_addViewabilityService",value:function(){var _this6=this;this.app.services.ViewabilityService.on(this.$playerContainer,this._onViewCallback,{threshold:this._VIEWABILITY_TRACKING_THRESHOLD,callbackDelay:this._VIEWABILITY_TIMEOUT_RENDERED}),this.app.services.ViewabilityService.on(this.$playerContainer,function(inView,isAppBackgrounded){return _this6._viewabilityCallback(inView,isAppBackgrounded)},{threshold:this._VIEWABILITY_THRESHOLD}),this.app.services.ViewabilityService.subscribe(ApiConfig.d.OmidViewabilityThreshold,function(data){_this6.mediator.publish(_this6,ApiConfig.d.OmidViewabilityThreshold,{payload:{threshold:data}})}),this.app.config.os.os===OsConfig.b.Ios&&this.app.services.PageFocusService.on(this._handleIosWebBackgrounded)}},{key:"_handleSessionViewTracking",value:function(){this._isViewabilityTrackable&&this._hasPlayerStarted&&this.mediator.publish(this,ExperienceConfig.c.SessionView)}},{key:"_viewabilityCallback",value:function(inView){var _a,isAppBackgrounded=arguments.length>1&&void 0!==arguments[1]&&arguments[1],isRecyclerViewIntegration=this.app.config.isRecyclerViewIntegration;this._adsController.setToggleAdsReason({isAppBackgrounded:isAppBackgrounded,inAppRecyclerViewViewability:isRecyclerViewIntegration&&!inView}),this.app.config.isInApp&&(isAppBackgrounded?(this._forceBackgroundPaused=!0,this._isContentPausedState?this._forcedBackgroundBeforePausedState=!0:this._forcedBackgroundBeforePausedState=!1,this._cachedVolume=this.getVolume(),this.setVolume(0),null===(_a=this.adHandler)||void 0===_a||_a.disableAds(DisableAdsReasonEnum.Unknown),this.pause()):(this._cachedVolume&&(this.setVolume(this._cachedVolume),this._cachedVolume=null),this._forceBackgroundPaused&&(this._forceBackgroundPaused=!1,this._forcedBackgroundBeforePausedState||this.play()))),this._inView=inView,this.mediator.publish(this,ApiConfig.b.IsViewable,{payload:inView}),this._adsController.viewabilityStateChanged(this.checkFloatingViewability(inView),this._adBreaksHelper.isInAdPod(),this._adBreaksHelper.isInPodTimeout()),this.app.services.TrackingService.setSessionViewability(inView)}},{key:"checkFloatingViewability",value:function(inView){var isTabInFocus=this.app.services.ViewabilityService.getIsTabInFocus();return!(inView||!this.floatingModule||!this.floatingModule.isInFloating||!isTabInFocus)||inView}},{key:"_onPlayerResize",value:function(){var _this7=this,playerWidth=this.$playerContainer.clientWidth,playerHeight=this.$playerContainer.clientHeight;if(this.adHandler){var vastViewMode=this._isFullscreen?VastConfig.a.Fullscreen:VastConfig.a.Normal;this.adHandler.resizeAd(playerWidth,playerHeight,vastViewMode)}else this._adsController.onResize(playerWidth,playerHeight);this.breakPointsHandler.updateWidth(playerWidth),setTimeout(function(){_this7.mediator.publish(_this7,ApiConfig.b.SizeChanged,{payload:{width:playerWidth,height:playerHeight}}),_this7._onResizeEmitPlayerResized()})}},{key:"_onResizeEmitPlayerResized",value:function(){this._isFullscreen||this._emitPlayerResized()}},{key:"_addResizeObserver",value:function(){var _this8=this;this.app.services.ResizeObserver.on(this.$playerContainer,function(){_this8._onPlayerResize()})}},{key:"_onFullscreenEnter",value:function(){this._isFullscreen=!0,this.app.services.InteractionService.disableScrollEvent(),this._emitOnEnterFullscreen(),this.adHandler&&this.adHandler.setVastViewMode(VastConfig.a.Fullscreen)}},{key:"_onFullscreenExit",value:function(){this._isFullscreen=!1,this.app.services.InteractionService.enableScrollEvent(),this._emitOnExitFullscreen(),this.adHandler&&this.adHandler.setVastViewMode(VastConfig.a.Normal)}},{key:"_getRatioContainer",value:function(){var html="<cnx class='".concat(CssClassesConfig.c,"'></cnx>"),ratioContainer=this.app.services.GlobalDomUtilsService.createElementByString(html);return this._applyRatioToContainer(ratioContainer),ratioContainer}},{key:"_applyRatioToContainer",value:function($container){Object(DomUtils.Q)($container,{"padding-bottom":"".concat(this._getPlayerRatio(),"%")})}},{key:"_getPlayerRatio",value:function(){return this._playerModel.playerSize.ratioHeight/this._playerModel.playerSize.ratioWidth*100}},{key:"_subscribeToFloatingEvents",value:function(){var _this9=this;this.subscribe(FloatingEventsEnum.EnterStart,this.floatingModule,function(){_this9.mediator.publish(_this9,ApiConfig.c.PlayerFloatChanged,{payload:FloatingStatesEnum.Float})}),this.subscribe(FloatingEventsEnum.ExitStop,this.floatingModule,function(){_this9.mediator.publish(_this9,ApiConfig.c.PlayerFloatChanged,{payload:FloatingStatesEnum.Embed})}),this.subscribe(FloatingEventsEnum.EnterStop,this.floatingModule,function(){_this9._viewabilityCallback(!0)})}},{key:"_initFloatingModule",value:function(){this.floatingModule=new Floating_Floating(this,this.app.services.ViewabilityService,this.app.services.ResizeObserver,this.$playerContainer,this._playerModel.floatingSettings,this.app.config.device,this.app.services.GlobalDomUtilsService,this._floatingBreakpoint),this._subscribeToFloatingEvents(),this.floatingModule.start()}},{key:"_initAlwaysFloatingModule",value:function(){var _this10=this,alwaysFloatingModule=new AlwaysFloating_AlwaysFloating(this,this.app.services.ResizeObserver,this.$experienceContainer,this._playerModel.floatingSettings,this.app.config.device,this.app.services.GlobalDomUtilsService);this.subscribe(FloatingEventsEnum.EnterStop,alwaysFloatingModule,function(){_this10.app.services.ViewabilityService.triggerRecheck(_this10.$playerContainer)}),alwaysFloatingModule.start()}},{key:"setNewVolume",value:function(volume){this.adHandler&&this.adHandler.setVolume(volume)}},{key:"_initSoundOnHover",value:function(){this._addSoundOnHoverListeners(),this.adHandler&&this._subscribeToVolumeUserInteraction(this.adHandler)}},{key:"_subscribeToVolumeUserInteraction",value:function(mediated){var _this11=this;this.subscribe(ExperienceConfig.b.UserInteraction,mediated,function(_ref3){_ref3.payload.volume&&_this11._removeSoundOnHoverListeners()})}},{key:"_onVolumeChange",value:function(volume){this.mediator.publish(this,ApiConfig.b.VolumeChanged,{payload:volume}),this.app.services.EventsStorageService.emitVolumeChange(volume)}},{key:"_setVolumeIfNeeded",value:function(volume){this.getVolume()!==volume&&this.setNewVolume(volume)}},{key:"_addSoundOnHoverListeners",value:function(){this._soundOnHoverListenersEnabled=!0,this.$playerContainer.addEventListener("mouseover",this._handleHoverOverPlayer),this.$playerContainer.addEventListener("mouseout",this._handleHoverOutPlayer)}},{key:"_removeSoundOnHoverListeners",value:function(){this._soundOnHoverListenersEnabled&&(this._soundOnHoverListenersEnabled=!1,this.$playerContainer.removeEventListener("mouseover",this._handleHoverOverPlayer),this.$playerContainer.removeEventListener("mouseout",this._handleHoverOutPlayer))}},{key:"_initBreakPointsHandler",value:function(){this.breakPointsHandler=new BreakPointsHandler_BreakPointsHandler(this.$playerContainer,this.app.config.device,this._breakpointsConfig,this._breakpointsClasses),this.breakPointsHandler.updateWidth(this.$playerContainer.clientWidth)}},{key:"_initClosePlayer",value:function(){var _this12=this;if(this._playerModel.isCloseButton){switch(this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Close],this.adHandler,function(){_this12.handleClose()}),this._playerModel.closeButtonMode){case protos.ProtoPlayerCloseButtonMode.AlwaysOn:Object(DomUtils.a)(this.$playerContainer,CssClassesConfig.g.CloseOn);break;case protos.ProtoPlayerCloseButtonMode.Off:Object(DomUtils.a)(this.$playerContainer,CssClassesConfig.g.CloseOff);break;case protos.ProtoPlayerCloseButtonMode.OnHover:Object(DomUtils.a)(this.$playerContainer,CssClassesConfig.g.CloseHover)}switch(this._playerModel.floatingSettings.floatingCloseButtonMode){case protos.ProtoPlayerCloseButtonMode.AlwaysOn:Object(DomUtils.a)(this.$playerContainer,CssClassesConfig.g.CloseFloatOn);break;case protos.ProtoPlayerCloseButtonMode.Off:Object(DomUtils.a)(this.$playerContainer,CssClassesConfig.g.CloseFloatOff);break;case protos.ProtoPlayerCloseButtonMode.OnHover:Object(DomUtils.a)(this.$playerContainer,CssClassesConfig.g.CloseFloatHover)}}}},{key:"_getAdLoadedProperties",value:function(metadata){var skipOffset=metadata.skipOffset;return{isAutoPlay:this._playerModel.playbackMode===protos.ProtoPlayerPlaybackModeEnum.Autoplay,skipOffset:skipOffset,isSkippable:Object(TypeUtils.d)(skipOffset)}}},{key:"_handleContentStart",value:function(){this._hasPlayerStarted=!0,this.app.services.TrackingService.setContentStart(),this._handleSessionViewTracking()}},{key:"_canStart",value:function(){var _this$$experienceCont=this.$experienceContainer,width=_this$$experienceCont.clientWidth,height=_this$$experienceCont.clientHeight;return!Object(NumberUtils.f)({width:width,height:height})||this._shouldAllowInvalidDimensionsForBundleId()}},{key:"_shouldAllowInvalidDimensionsForBundleId",value:function(){return ALLOW_INVALID_DIMENSIONS_FOR_BUNDLE_IDS.includes(this.app.config.bundleID)}},{key:"_getElementInfo",value:function($element){try{var _this$app$services$Gl=this.app.services.GlobalDomUtilsService.getComputedStyle($element),display=_this$app$services$Gl.display,compWidth=_this$app$services$Gl.width,compHeight=_this$app$services$Gl.height,flex=_this$app$services$Gl.flex,maxWidth=_this$app$services$Gl.maxWidth,minWidth=_this$app$services$Gl.minWidth,_$element$getBounding=$element.getBoundingClientRect(),styles={display:display,compWidth:compWidth,boundWidth:_$element$getBounding.width,compHeight:compHeight,boundHeight:_$element$getBounding.height,flex:flex,maxWidth:maxWidth,minWidth:minWidth};return{type:$element.nodeName,styles:JSON.stringify(styles)}}catch(err){return{err:"BaseExperience_getElementInfo_error"}}}},{key:"_logInvalidDimensions",value:function(){if(Object(GeneralUtils.l)([95,5])){var styles={parent:this._getElementInfo(this.$experienceContainer.parentElement),main:this._getElementInfo(this.$experienceContainer)};Object(Logging.a)({message:"BaseExperience_invalid_dimensions",level:protos.ProtoLoggingLevelEnum.INFO,exception:JSON.stringify(styles)})}}},{key:"_initAdBreakController",value:function(){this._adBreaksHelper=new AdBreakController_AdBreakController(this._playerModel.adBreaks)}},{key:"_renderExperience",value:function(playerModel,app,experienceContainer,onRenderExperience){this._playerModel=playerModel,this.app=app,this.$experienceContainer=experienceContainer,onRenderExperience&&onRenderExperience(),this._initRatioFacade(),this.app.services.ViewabilityService.setViewableThreshold(this._initialViewThreshold),this.generateHTML(),this._initAdBreakController(),this.app.services.ResizeObserver.on(this.$experienceContainer,this._onMainContainerResize),this._canStart()?this.mediator.publish(this,ExperienceConfig.b.CanStart):this._logInvalidDimensions()}},{key:"start",value:function(){var _this13=this;this._experienceStarted=!0,Object(DomUtils.a)(this.$experienceContainer,CssClassesConfig.b.MainContainerFlex),this.mediator.publish(this,ExperienceConfig.c.SessionRendered),this._initBreakPointsHandler(),this._addResizeObserver(),this._playerModel.floatingSettings.floatingMode===protos.ProtoPlayerFloatingMode.Always?this._initAlwaysFloatingModule():(this._emitPlayerResized(),this._initFloatingModule()),this._addViewabilityService(),this._playerModel.lineItemSettings.lineItems.length>0&&!this._playerModel.disableAdvertising&&!AdBlockerDetectionService.a.isBannerBlocked&&(this.app.config.isOVPDomain?AdBlockerDetectionService.a.onAdBlockerDetected().subscribe(function(hasAdBlocker){hasAdBlocker||_this13._initAdHandler()}):this._initAdHandler()),this.app.config.isMobile||this._playerModel.soundMode!==protos.ProtoPlayerSoundMode.Hover||this._initSoundOnHover(),this._playerModel.isCloseButton&&this._initClosePlayer(),this._initAdsController(),AdBlockerDetectionService.a.isBannerBlocked||AdBlockerDetectionService.a.detectUsingScript().then(function(hasAdBlocker){hasAdBlocker&&(_this13.app.services.TrackingService.trackSessionAdBlocker(protos.ProtoAdBlockDetectionTypeEnum.Network),_this13._adsController.disableAdvertising())})}},{key:"play",value:function(){this.adHandler&&this.adHandler.inImpression&&this.adHandler.play()}},{key:"pause",value:function(){this.adHandler&&this.adHandler.inImpression&&this.adHandler.pause()}},{key:"setVolume",value:function(volume){this.setNewVolume(volume),this._removeSoundOnHoverListeners()}},{key:"getSize",value:function(){return{width:this.$experienceContainer.clientWidth,height:this.$experienceContainer.clientHeight}}},{key:"setSize",value:function(width,height){Object(NumberUtils.f)({width:width,height:height})||Object(DomUtils.Q)(this.$experienceContainer,{width:"".concat(width,"px"),height:"".concat(height,"px")})}},{key:"setCustomMacros",value:function(macros){this.app.services.MacrosService.addExtraMacros(macros)}},{key:"isViewable",value:function(){return this.app.services.ViewabilityService.check({element:this.$playerContainer,threshold:this._VIEWABILITY_THRESHOLD})}},{key:"setViewableThreshold",value:function(threshold){this.app?this.app.services.ViewabilityService.setViewableThreshold(threshold):this._initialViewThreshold=threshold}},{key:"setAmpUserConsent",value:function(ampUserConsent){this.app.services.UserManagerService.setAmpUserConsent(ampUserConsent)}},{key:"triggerDestroy",value:function(){this.app.services.EventsStorageService.destroy(),this.mediator.publish(this,ExperienceConfig.b.Destroy)}},{key:"disableAdvertising",value:function(){this._adsController.disableAdvertising()}},{key:"enableAdvertising",value:function(){this._adsController.enableAdvertising()}},{key:"destroy",value:function(){this.adHandler&&this.adHandler.destroy(),this._adsController&&this._adsController.destroy(),this.floatingModule&&(this.floatingModule.destroy(),this.floatingModule=null)}}]),BaseExperience}(Mediator.a),EndPointResolver=__webpack_require__(22),ImageUrlBuilder_ImageUrlBuilder=function(){function ImageUrlBuilder(){classCallCheck_default()(this,ImageUrlBuilder)}return createClass_default()(ImageUrlBuilder,null,[{key:"getScaledImageUrl",value:function(imageUrl,width,height,suffixerService,percentage){if(imageUrl&&!Object(NumberUtils.f)({width:width,height:height}))return Object(TypeUtils.e)(percentage)&&(width=Object(NumberUtils.e)(width,percentage),height=Object(NumberUtils.e)(height,percentage)),suffixerService.appendParamsToUrl("".concat(imageUrl).concat(ImageUrlBuilder.getScaledImageQueryParams(width,height)).trim())}},{key:"getScaledImageQueryParams",value:function(width,height){return Object(NumberUtils.f)({width:width,height:height})?"":"?width=".concat(width,"&height=").concat(height,"&fit=bounds")}},{key:"getSmartCroppedImageUrl",value:function(imageUrl,width,height,suffixerService){return Object(TypeUtils.h)(imageUrl)||(imageUrl=EndPointResolver.a.endPoints.base.image),Object(NumberUtils.f)({width:width,height:height})&&(width=140,height=80),suffixerService.appendParamsToUrl("".concat(imageUrl).concat(ImageUrlBuilder.getSmartCroppedImageQueryParams(width,height)))}},{key:"getSmartCroppedImageQueryParams",value:function(width,height){return Object(NumberUtils.f)({width:width,height:height})?"":"?crop=".concat(width,":").concat(height,",smart&width=").concat(width,"&height=").concat(height,"&format=jpeg&quality=60&fit=crop")}}]),ImageUrlBuilder}(),AUiState_AUiState=function(){function AUiState(context){classCallCheck_default()(this,AUiState),this.context=context}return createClass_default()(AUiState,[{key:"onClick",value:function(){}},{key:"canTransitionToState",value:function(newState){return!0}},{key:"enterState",value:function(){this.initState(),this.context.currentState=this}}]),AUiState}();!function(UiComponentsEnum){UiComponentsEnum[UiComponentsEnum.PlayButton=0]="PlayButton",UiComponentsEnum[UiComponentsEnum.BigPlayButton=1]="BigPlayButton",UiComponentsEnum[UiComponentsEnum.VolumeButton=2]="VolumeButton",UiComponentsEnum[UiComponentsEnum.VolumeProgress=3]="VolumeProgress",UiComponentsEnum[UiComponentsEnum.VolumeControls=4]="VolumeControls",UiComponentsEnum[UiComponentsEnum.ExpandButton=5]="ExpandButton",UiComponentsEnum[UiComponentsEnum.SettingsButton=6]="SettingsButton",UiComponentsEnum[UiComponentsEnum.CaptionButton=7]="CaptionButton",UiComponentsEnum[UiComponentsEnum.CaptionComponent=8]="CaptionComponent",UiComponentsEnum[UiComponentsEnum.CastButton=9]="CastButton",UiComponentsEnum[UiComponentsEnum.ShareButton=10]="ShareButton",UiComponentsEnum[UiComponentsEnum.UpNextButton=11]="UpNextButton",UiComponentsEnum[UiComponentsEnum.UpNextBox=12]="UpNextBox",UiComponentsEnum[UiComponentsEnum.PreviousButton=13]="PreviousButton",UiComponentsEnum[UiComponentsEnum.LogoComponent=14]="LogoComponent",UiComponentsEnum[UiComponentsEnum.LogoOutstream=15]="LogoOutstream",UiComponentsEnum[UiComponentsEnum.MoreButton=16]="MoreButton",UiComponentsEnum[UiComponentsEnum.ElapsedTimeLabel=17]="ElapsedTimeLabel",UiComponentsEnum[UiComponentsEnum.TotalDurationLabel=18]="TotalDurationLabel",UiComponentsEnum[UiComponentsEnum.ProgressBar=19]="ProgressBar",UiComponentsEnum[UiComponentsEnum.QualityMenu=20]="QualityMenu",UiComponentsEnum[UiComponentsEnum.QueStateOverlay=21]="QueStateOverlay",UiComponentsEnum[UiComponentsEnum.Loader=22]="Loader",UiComponentsEnum[UiComponentsEnum.ContextMenu=23]="ContextMenu",UiComponentsEnum[UiComponentsEnum.ElementsSettingsMenu=24]="ElementsSettingsMenu",UiComponentsEnum[UiComponentsEnum.CloseButton=25]="CloseButton",UiComponentsEnum[UiComponentsEnum.SkipAdButton=26]="SkipAdButton",UiComponentsEnum[UiComponentsEnum.AdLoadingScreen=27]="AdLoadingScreen",UiComponentsEnum[UiComponentsEnum.CtaButton=28]="CtaButton",UiComponentsEnum[UiComponentsEnum.PlayspaceProgressBar=29]="PlayspaceProgressBar",UiComponentsEnum[UiComponentsEnum.PlayspaceSettingsMenu=30]="PlayspaceSettingsMenu",UiComponentsEnum[UiComponentsEnum.ClickToPlayButton=31]="ClickToPlayButton",UiComponentsEnum[UiComponentsEnum.SlideTitle=32]="SlideTitle",UiComponentsEnum[UiComponentsEnum.SkipAd=33]="SkipAd",UiComponentsEnum[UiComponentsEnum.TopTitle=34]="TopTitle",UiComponentsEnum[UiComponentsEnum.TopLogo=35]="TopLogo",UiComponentsEnum[UiComponentsEnum.TopSlideTitle=36]="TopSlideTitle",UiComponentsEnum[UiComponentsEnum.TopStoryTitle=37]="TopStoryTitle",UiComponentsEnum[UiComponentsEnum.TextLabel=38]="TextLabel",UiComponentsEnum[UiComponentsEnum.LivePoster=39]="LivePoster",UiComponentsEnum[UiComponentsEnum.LiveIcon=40]="LiveIcon"}(UiComponentsEnum||(UiComponentsEnum={}));var PositionFlags,toConsumableArray=__webpack_require__(14),toConsumableArray_default=__webpack_require__.n(toConsumableArray);function moveElementToCoordinatesWithinContainer($elementToPosition,targetCoordinates,containerCoordinates,align){$elementToPosition.style.top="".concat(function($elementToPosition,clientY,height,containerCoordinates,align){var top=clientY-containerCoordinates.clientY,bottom=containerCoordinates.clientY+containerCoordinates.height-clientY;align.alignTop&&top>$elementToPosition.offsetHeight?top-=$elementToPosition.offsetHeight:!align.alignTop&&bottom<$elementToPosition.offsetHeight?top-=$elementToPosition.offsetHeight-bottom:(top+=height)+$elementToPosition.offsetHeight>containerCoordinates.height&&(top=containerCoordinates.height-$elementToPosition.offsetHeight);return top}($elementToPosition,targetCoordinates.clientY,targetCoordinates.height,containerCoordinates,align),"px"),$elementToPosition.style.left="".concat(function($elementToPosition,clientX,containerCoordinates,align){var distanceFromMargin=align.distanceFromMargin?align.distanceFromMargin:0,left=Math.ceil(clientX)-Math.ceil(containerCoordinates.clientX),cmLeftMargin=clientX,cmRightMargin=cmLeftMargin+$elementToPosition.offsetWidth,playerRightMargin=containerCoordinates.clientX+containerCoordinates.width;if(align.alignMiddle){var halfMenuWidth=$elementToPosition.offsetWidth/2;left-=Math.ceil(halfMenuWidth),cmLeftMargin-=halfMenuWidth,cmRightMargin-=halfMenuWidth}if(align.alignMiddle||align.forceRight)return containerCoordinates.clientX>cmLeftMargin?left=0+distanceFromMargin:playerRightMargin<cmRightMargin&&(left-=Math.ceil(cmRightMargin)-Math.ceil(playerRightMargin)+distanceFromMargin),left;cmRightMargin>playerRightMargin&&(left-=$elementToPosition.offsetWidth);return left}($elementToPosition,targetCoordinates.clientX,containerCoordinates,align),"px")}function ABaseComponent_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}!function(PositionFlags){PositionFlags[PositionFlags.Top=1]="Top",PositionFlags[PositionFlags.Bottom=2]="Bottom",PositionFlags[PositionFlags.Right=4]="Right",PositionFlags[PositionFlags.Left=8]="Left",PositionFlags[PositionFlags.Middle=16]="Middle"}(PositionFlags||(PositionFlags={}));var ABaseComponent_ABaseComponent=function(_Mediator){inherits_default()(ABaseComponent,_Mediator);var _super=ABaseComponent_createSuper(ABaseComponent);function ABaseComponent(mediator,_globalDomUtils,_interactionService,template,_isMobile){var _this;return classCallCheck_default()(this,ABaseComponent),(_this=_super.call(this)).mediator=mediator,_this._globalDomUtils=_globalDomUtils,_this._interactionService=_interactionService,_this._isMobile=_isMobile,_this._$container=_globalDomUtils.createElementByString(template),_this}return createClass_default()(ABaseComponent,[{key:"getContainer",value:function(){return this._$container}},{key:"getCoordinates",value:function(anchorPoint){var coordinates=this._globalDomUtils.getElementCoordinates(this._$container);return this._isMobile&&anchorPoint?((anchorPoint&PositionFlags.Top)===PositionFlags.Top&&(coordinates.clientY-=this._$container.clientHeight),(anchorPoint&PositionFlags.Right)===PositionFlags.Right&&(coordinates.clientX+=this._$container.clientWidth)):coordinates.clientX+=coordinates.width/2,coordinates}},{key:"showComponent",value:function(){var useTransition=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._$container&&this._$container.parentElement){var $element=Object(DomUtils.u)(this._$container.parentElement,"cnx-ui-btn")?this._$container.parentElement:this._$container;useTransition&&Object(DomUtils.E)($element)?Object(DomUtils.g)($element):Object(DomUtils.R)($element)}}},{key:"hideComponent",value:function(){var useTransition=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._$container&&this._$container.parentElement){var $element=Object(DomUtils.u)(this._$container.parentElement,"cnx-ui-btn")?this._$container.parentElement:this._$container;useTransition&&!Object(DomUtils.E)($element)?Object(DomUtils.h)($element,function(){return Object(DomUtils.v)($element)}):Object(DomUtils.v)($element)}}},{key:"destroy",value:function(){this._$container.innerHTML="",this._$container.style.display="none",this._interactionService.unregisterAll(this)}}]),ABaseComponent}(Mediator.a),UiInteractionEventsEnum=__webpack_require__(17);function AClickComponent_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AClickComponent_AClickComponent=function(_ABaseComponent){inherits_default()(AClickComponent,_ABaseComponent);var _super=AClickComponent_createSuper(AClickComponent);function AClickComponent(mediator,globalDomUtils,interactionService,template,isMobile){var _this;return classCallCheck_default()(this,AClickComponent),(_this=_super.call(this,mediator,globalDomUtils,interactionService,template,isMobile)).eventList=[UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Scroll],UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Click]],_this._callInteractionHandler=function(event){_this.onInteractionHandler(event)},_this.onBeforeClick=function(event){event.stopPropagation()},_this.onClick=function(event){_this.onInteractionHandler(event),_this.onClickHandler(event)},_this}return createClass_default()(AClickComponent,[{key:"onInteractionHandler",value:function(event){event.stopPropagation()}},{key:"onClickHandler",value:function(event){}},{key:"initComponent",value:function(){var _this2=this,callbackConfig={interactionstart:this.onBeforeClick,interaction:this._callInteractionHandler,click:this.onClick};this._interactionService.register(this._$container,this,this._interactionService,callbackConfig),this._isMobile&&(this.subscribe(UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Click],this._interactionService,function(){_this2.onClickHandler()}),this.relay(UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Scroll],this._interactionService,this,this.mediator))}},{key:"destroy",value:function(){this.unsubscribeAll(this._interactionService),get_default()(getPrototypeOf_default()(AClickComponent.prototype),"destroy",this).call(this)}}]),AClickComponent}(ABaseComponent_ABaseComponent);function AClickBoomComponent_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}function AClickHoverComponent_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var PlayButtonStates,AClickHoverComponent_AClickHoverComponent=function(_AClickBoomComponent){inherits_default()(AClickHoverComponent,_AClickBoomComponent);var _super=AClickHoverComponent_createSuper(AClickHoverComponent);function AClickHoverComponent(){var _this;return classCallCheck_default()(this,AClickHoverComponent),(_this=_super.apply(this,arguments)).eventList=[UiComponentEventsEnum[UiComponentEventsEnum.HoverStart],UiComponentEventsEnum[UiComponentEventsEnum.HoverEnd]].concat(toConsumableArray_default()(_this.eventList)),_this.onStartHover=function(){Object(DomUtils.a)(_this._$container,CssClassesConfig.h.HoverStart),Object(DomUtils.a)(_this._$container,CssClassesConfig.h.HoverEnd),_this.mediator.publish(assertThisInitialized_default()(_this),UiComponentEventsEnum[UiComponentEventsEnum.HoverStart])},_this.onEndHover=function(){Object(DomUtils.L)(_this._$container,CssClassesConfig.h.HoverEnd),_this.mediator.publish(assertThisInitialized_default()(_this),UiComponentEventsEnum[UiComponentEventsEnum.HoverEnd])},_this}return createClass_default()(AClickHoverComponent,[{key:"initComponent",value:function(){get_default()(getPrototypeOf_default()(AClickHoverComponent.prototype),"initComponent",this).call(this),this._isMobile?(this._$container.addEventListener("touchstart",this.onStartHover,{passive:!0}),this._$container.addEventListener("touchend",this.onEndHover),this._$container.addEventListener("touchcancel",this.onEndHover)):(this._$container.addEventListener("mouseenter",this.onStartHover),this._$container.addEventListener("mouseleave",this.onEndHover))}},{key:"destroy",value:function(){this._isMobile?(this._$container.removeEventListener("touchstart",this.onStartHover),this._$container.removeEventListener("touchend",this.onEndHover),this._$container.removeEventListener("touchcancel",this.onEndHover)):(this._$container.removeEventListener("mouseenter",this.onStartHover),this._$container.removeEventListener("mouseleave",this.onEndHover)),get_default()(getPrototypeOf_default()(AClickHoverComponent.prototype),"destroy",this).call(this)}},{key:"onInteractionHandler",value:function(event){this.onEndHoverClick()}},{key:"onEndHoverClick",value:function(){Object(DomUtils.L)(this._$container,CssClassesConfig.h.HoverEnd),Object(DomUtils.L)(this._$container,CssClassesConfig.h.HoverStart)}}]),AClickHoverComponent}(function(_AClickComponent){inherits_default()(AClickBoomComponent,_AClickComponent);var _super=AClickBoomComponent_createSuper(AClickBoomComponent);function AClickBoomComponent(){var _this;return classCallCheck_default()(this,AClickBoomComponent),(_this=_super.apply(this,arguments)).onClick=function(event){_this.onInteractionHandler(event),_this.onClickHandler(),_this.addBoomEffect()},_this}return createClass_default()(AClickBoomComponent,[{key:"addBoomEffect",value:function(){var _this2=this;Object(DomUtils.a)(this._$container,"cnx-boom"),this._$container.getClientRects(),Object(DomUtils.a)(this._$container,"cnx-boom-anim");this._$container.addEventListener("transitionend",function hoverBoomClear(event){"transform"===event.propertyName&&(Object(DomUtils.L)(_this2._$container,"cnx-boom"),Object(DomUtils.L)(_this2._$container,"cnx-boom-anim"),_this2._$container.removeEventListener("transitionend",hoverBoomClear))})}},{key:"initComponent",value:function(){get_default()(getPrototypeOf_default()(AClickBoomComponent.prototype),"initComponent",this).call(this),this._$container.appendChild(this._globalDomUtils.createElementByString('<cnx class="cnx-boom-elem"></cnx>'))}}]),AClickBoomComponent}(AClickComponent_AClickComponent));function PlayButton_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}!function(PlayButtonStates){PlayButtonStates[PlayButtonStates.Play=0]="Play",PlayButtonStates[PlayButtonStates.Pause=1]="Pause"}(PlayButtonStates||(PlayButtonStates={}));var PlayButton_PlayButton=function(_AClickHoverComponent){inherits_default()(PlayButton,_AClickHoverComponent);var _super=PlayButton_createSuper(PlayButton);function PlayButton(mediator,globalDomUtils,interactionService,templateString,isMobile){var _this;return classCallCheck_default()(this,PlayButton),(_this=_super.call(this,mediator,globalDomUtils,interactionService,templateString,isMobile))._isReplay=!1,_this.eventList=[UiComponentEventsEnum[UiComponentEventsEnum.Play],UiComponentEventsEnum[UiComponentEventsEnum.Pause],UiComponentEventsEnum[UiComponentEventsEnum.Replay],UiComponentEventsEnum[UiComponentEventsEnum.StateChanged]].concat(toConsumableArray_default()(_this.eventList)),_this._TOOLTIP_PLAY_INFO="Play",_this._TOOLTIP_PAUSE_INFO="Pause",_this.setState(PlayButtonStates.Pause),_this}return createClass_default()(PlayButton,[{key:"onClickHandler",value:function(){this._state===PlayButtonStates.Pause?this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Pause]):this._isReplay?this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Replay]):this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Play])}},{key:"_updateUi",value:function(){}},{key:"toggleReplay",value:function(flag){this._isReplay=flag}},{key:"setState",value:function(state){this._state!==state&&(this._state=state,this._updateUi(),this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.StateChanged]))}},{key:"tooltip",get:function(){return this._state===PlayButtonStates.Play?this._TOOLTIP_PLAY_INFO:this._TOOLTIP_PAUSE_INFO}}]),PlayButton}(AClickHoverComponent_AClickHoverComponent);function AUiStatePlaying_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AUiStatePlaying_AUiStatePlaying=function(_AUiState){inherits_default()(AUiStatePlaying,_AUiState);var _super=AUiStatePlaying_createSuper(AUiStatePlaying);function AUiStatePlaying(){return classCallCheck_default()(this,AUiStatePlaying),_super.apply(this,arguments)}return createClass_default()(AUiStatePlaying,[{key:"initState",value:function(){this.context.$uiContainer.classList.add(CssClassesConfig.j.Playing);var playBtn=this.context.getComponent(UiComponentsEnum.PlayButton);playBtn&&playBtn.setState(PlayButtonStates.Pause);var bigPlay=this.context.getComponent(UiComponentsEnum.BigPlayButton);bigPlay&&bigPlay.setState(PlayButtonStates.Pause)}},{key:"exitState",value:function(){this.context.$uiContainer.classList.remove(CssClassesConfig.j.Playing)}}]),AUiStatePlaying}(AUiState_AUiState);function AdStatePlaying_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AdStatePlaying_AdStatePlaying=function(_AUiStatePlaying){inherits_default()(AdStatePlaying,_AUiStatePlaying);var _super=AdStatePlaying_createSuper(AdStatePlaying);function AdStatePlaying(){var _this;return classCallCheck_default()(this,AdStatePlaying),(_this=_super.apply(this,arguments))._fakeProgressStep=100,_this}return createClass_default()(AdStatePlaying,[{key:"_startFakeProgress",value:function(){var _this2=this;if(!this.elapsedTimeoutId&&this.context.duration){var timeoutStarted=Date.now();this.elapsedTimeoutId=setTimeout(function(){_this2.context.elapsedTime+=(Date.now()-timeoutStarted)/1e3;var progressBar=_this2.context.getComponent(UiComponentsEnum.ProgressBar);progressBar&&progressBar.setProgress(Object(NumberUtils.g)(0,_this2.context.duration,0,100,_this2.context.elapsedTime)),_this2.elapsedTimeoutId=null,_this2._startFakeProgress()},this._fakeProgressStep)}}},{key:"initState",value:function(){get_default()(getPrototypeOf_default()(AdStatePlaying.prototype),"initState",this).call(this),this.context.duration&&this._startFakeProgress()}},{key:"exitState",value:function(){get_default()(getPrototypeOf_default()(AdStatePlaying.prototype),"exitState",this).call(this),this.context.duration&&(clearTimeout(this.elapsedTimeoutId),this.elapsedTimeoutId=null)}}]),AdStatePlaying}(AUiStatePlaying_AUiStatePlaying);function AUiStatePaused_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AUiStatePaused_AUiStatePaused=function(_AUiState){inherits_default()(AUiStatePaused,_AUiState);var _super=AUiStatePaused_createSuper(AUiStatePaused);function AUiStatePaused(){return classCallCheck_default()(this,AUiStatePaused),_super.apply(this,arguments)}return createClass_default()(AUiStatePaused,[{key:"initState",value:function(){this.context.$uiContainer.classList.add(CssClassesConfig.j.Paused);var playBtn=this.context.getComponent(UiComponentsEnum.PlayButton);playBtn&&playBtn.setState(PlayButtonStates.Play);var bigPlay=this.context.getComponent(UiComponentsEnum.BigPlayButton);bigPlay&&bigPlay.setState(PlayButtonStates.Play)}},{key:"exitState",value:function(){this.context.$uiContainer.classList.remove(CssClassesConfig.j.Paused)}}]),AUiStatePaused}(AUiState_AUiState);function AdStatePaused_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AdStatePaused_AdStatePaused=function(_AUiStatePaused){inherits_default()(AdStatePaused,_AUiStatePaused);var _super=AdStatePaused_createSuper(AdStatePaused);function AdStatePaused(){return classCallCheck_default()(this,AdStatePaused),_super.apply(this,arguments)}return createClass_default()(AdStatePaused,[{key:"initState",value:function(){get_default()(getPrototypeOf_default()(AdStatePaused.prototype),"initState",this).call(this)}},{key:"exitState",value:function(){get_default()(getPrototypeOf_default()(AdStatePaused.prototype),"exitState",this).call(this)}}]),AdStatePaused}(AUiStatePaused_AUiStatePaused),UiTemplateEngine_UiTemplateEngine=function(){function UiTemplateEngine(_templateString,_globalDomUtils){classCallCheck_default()(this,UiTemplateEngine),this._templateString=_templateString,this._globalDomUtils=_globalDomUtils,this._templateStringRegex=/\[\[([0-9]+)]]/g,this._componentNamesList=[],this._renderedSlots=[],this._renderedTemplate=this._globalDomUtils.createElementByString(this._getProcessedTemplate(this._templateString))}return createClass_default()(UiTemplateEngine,[{key:"_getPlaceHolder",value:function(placeholderId){return'<cnx class="pl_'.concat(placeholderId,'"></cnx>')}},{key:"_getProcessedTemplate",value:function(templateString){var _this=this;return templateString.replace(this._templateStringRegex,function(matchedString,insideBrackets){return _this._componentNamesList.push(parseInt(insideBrackets,10)),_this._getPlaceHolder(insideBrackets)})}},{key:"_getSlot",value:function(slotId,component){return this._renderedSlots.some(function(item){return item.slotName===slotId})?null:this._renderedSlots.some(function(renderedSlot){return renderedSlot.component===component})?null:this._renderedTemplate.getElementsByClassName("pl_".concat(slotId))[0]}},{key:"getComponentList",value:function(){return this._componentNamesList}},{key:"getRenderedDom",value:function(){return this._renderedTemplate}},{key:"registerSlot",value:function(slotName,component){var $slot=this._getSlot(slotName,component);if(null!==$slot){var $componentDom=component.getContainer();return $slot.parentNode.replaceChild($componentDom,$slot),this._renderedSlots.push({component:component,slotName:slotName}),!0}return!1}},{key:"initComponents",value:function(){this._renderedSlots.forEach(function(renderedSlot){return renderedSlot.component.initComponent()})}}]),UiTemplateEngine}();function AUiComponentHandler_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AUiComponentHandler_AUiComponentHandler=function(_Mediator){inherits_default()(AUiComponentHandler,_Mediator);var _super=AUiComponentHandler_createSuper(AUiComponentHandler);function AUiComponentHandler(globalDomUtilsService,templateString,componentFactory){var _this;return classCallCheck_default()(this,AUiComponentHandler),(_this=_super.call(this)).globalDomUtilsService=globalDomUtilsService,_this.templateString=templateString,_this.componentFactory=componentFactory,_this._renderedComponents={},_this._templateEngine=new UiTemplateEngine_UiTemplateEngine(templateString,globalDomUtilsService),_this.addComponents(),_this}return createClass_default()(AUiComponentHandler,[{key:"addComponents",value:function(){var _this2=this;this._templateEngine.getComponentList().forEach(function(componentName){var newComponent=_this2.componentFactory.createComponent(componentName,_this2);_this2.registerComponent(componentName,newComponent)})}},{key:"registerComponent",value:function(componentName,component){this._templateEngine.registerSlot(componentName,component),this._renderedComponents[componentName]=component,this._bindToComponentEvents(component)}},{key:"_bindToComponentEvents",value:function(component){var _this3=this;component.eventList.forEach(function(eventName){_this3.subscribe(eventName,component,function(eventData){eventName===UiComponentEventsEnum[UiComponentEventsEnum.RebindComponent]&&_this3.rebindComponentEvents(component),_this3.handleComponentEvent(eventName,eventData,component)})})}},{key:"rebindComponentEvents",value:function(component){component&&(this.unsubscribeAll(component),this._bindToComponentEvents(component))}},{key:"getComponent",value:function(componentName){return this._renderedComponents[componentName]}},{key:"destroy",value:function(){var _this4=this;Object.keys(this._renderedComponents).forEach(function(componentKey){_this4._renderedComponents[componentKey].destroy()})}}]),AUiComponentHandler}(Mediator.a);function AUiBase_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var ExpandButtonStatesEnum,AUiBase_AUiBase=function(_AUiComponentHandler){inherits_default()(AUiBase,_AUiComponentHandler);var _super=AUiBase_createSuper(AUiBase);function AUiBase(mediator,$container,globalDomUtils,templateString,componentFactory){var _this;return classCallCheck_default()(this,AUiBase),(_this=_super.call(this,globalDomUtils,templateString,componentFactory)).mediator=mediator,_this.$container=$container,_this.componentFactory=componentFactory,_this.$uiContainer=_this._templateEngine.getRenderedDom(),$container.appendChild(_this.$uiContainer),_this._templateEngine.initComponents(),_this}return createClass_default()(AUiBase,[{key:"changeState",value:function(newStateEnumValue){var newState=this._states[newStateEnumValue];newState!==this.currentState&&this.currentState.canTransitionToState(newState)&&(this.currentState.exitState(newState),newState.enterState())}},{key:"hide",value:function(){Object(DomUtils.a)(this.$uiContainer,CssClassesConfig.h.DisplayNone)}},{key:"show",value:function(){Object(DomUtils.L)(this.$uiContainer,CssClassesConfig.h.DisplayNone)}},{key:"destroy",value:function(){get_default()(getPrototypeOf_default()(AUiBase.prototype),"destroy",this).call(this),this.$uiContainer.parentNode.removeChild(this.$uiContainer)}}]),AUiBase}(AUiComponentHandler_AUiComponentHandler),tooltipTemplate=__webpack_require__(177),tooltipTemplate_default=__webpack_require__.n(tooltipTemplate),TooltipHandler_TooltipHandler=function(){function TooltipHandler(_$uiContainer,_globalDomUtils){classCallCheck_default()(this,TooltipHandler),this._$uiContainer=_$uiContainer,this._globalDomUtils=_globalDomUtils,this._activeElements=[],this._distanceConfig={top:12,bottom:24,margin:4},this._disableTooltips=!1}return createClass_default()(TooltipHandler,[{key:"_cacheCoordinates",value:function(){this._playerCoordinates=this._globalDomUtils.getElementCoordinates(this._$uiContainer.parentElement)}},{key:"_addTooltip",value:function(tooltipContainer,tooltip){tooltipContainer.getElementsByClassName("cnx-tooltip-text")[0].innerHTML=tooltip}},{key:"_showTooltip",value:function(component){if(component&&component.tooltip&&!this._disableTooltips&&!this._activeElements.find(function(el){return el.component===component})){var $tooltipContainer=this._globalDomUtils.createElementByString(tooltipTemplate_default.a);this._addTooltip($tooltipContainer,component.tooltip),this._cacheCoordinates();var targetCoordinates=component.getCoordinates(),alignTop=!1,buttonClientY=targetCoordinates.clientY,buttonHeight=targetCoordinates.height,_this$_globalDomUtils=this._globalDomUtils.getElementCoordinates(this._$uiContainer);buttonClientY<=_this$_globalDomUtils.clientY+_this$_globalDomUtils.height/2-buttonHeight?targetCoordinates.clientY+=this._distanceConfig.top:(targetCoordinates.clientY-=this._distanceConfig.bottom,alignTop=!0),this._$uiContainer.appendChild($tooltipContainer),moveElementToCoordinatesWithinContainer($tooltipContainer,targetCoordinates,this._playerCoordinates,{alignMiddle:!0,alignTop:alignTop,forceRight:!0,distanceFromMargin:this._distanceConfig.margin}),Object(DomUtils.i)($tooltipContainer),Object(DomUtils.a)($tooltipContainer,CssClassesConfig.s.OpacityInTransition),this._activeElements.push({component:component,domElement:$tooltipContainer})}}},{key:"_hideTooltip",value:function(component){if(component.tooltip){var activeComponent=this._activeElements.find(function(element){return element.component===component});if(activeComponent){var $tooltipContainer=activeComponent.domElement;this._$uiContainer.removeChild($tooltipContainer),this._activeElements=this._activeElements.filter(function(element){return element.component!==component})}}}},{key:"_refreshTooltip",value:function(component){var _this=this;if(component.tooltip){var hoveredActiveElement=this._activeElements.find(function(el){return el.component===_this._hoveredComponent});hoveredActiveElement&&this._addTooltip(hoveredActiveElement.domElement,component.tooltip)}}},{key:"_removeAllTooltips",value:function(){var _this2=this;this._hoveredComponent=null,this._activeElements.forEach(function(el){return _this2._hideTooltip(el.component)})}},{key:"setDistanceValues",value:function(distanceConfig){this._distanceConfig=Object.assign(Object.assign({},this._distanceConfig),distanceConfig)}},{key:"hoverStart",value:function(component){this._hoveredComponent=component,this._showTooltip(component)}},{key:"hoverEnd",value:function(component){this._hoveredComponent=null,this._hideTooltip(component)}},{key:"stateChanged",value:function(component){this._hoveredComponent===component&&this._refreshTooltip(component)}},{key:"disableTooltips",value:function(){this._disableTooltips=!0,this._removeAllTooltips()}},{key:"enableTooltips",value:function(){this._disableTooltips=!1,this._showTooltip(this._hoveredComponent)}}]),TooltipHandler}();function ExpandButton_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}!function(ExpandButtonStatesEnum){ExpandButtonStatesEnum[ExpandButtonStatesEnum.expand=0]="expand",ExpandButtonStatesEnum[ExpandButtonStatesEnum.collapse=1]="collapse"}(ExpandButtonStatesEnum||(ExpandButtonStatesEnum={}));var ExpandButton_ExpandButton=function(_AClickHoverComponent){inherits_default()(ExpandButton,_AClickHoverComponent);var _super=ExpandButton_createSuper(ExpandButton);function ExpandButton(){var _this;return classCallCheck_default()(this,ExpandButton),(_this=_super.apply(this,arguments)).eventList=[UiComponentEventsEnum[UiComponentEventsEnum.Expand],UiComponentEventsEnum[UiComponentEventsEnum.Collapse]].concat(toConsumableArray_default()(_this.eventList)),_this._TOOLTIP_ENTER_INFO="Full Screen",_this._TOOLTIP_EXIT_INFO="Exit Full Screen",_this}return createClass_default()(ExpandButton,[{key:"onClickHandler",value:function(){switch(this._state){case ExpandButtonStatesEnum.collapse:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Expand]);break;case ExpandButtonStatesEnum.expand:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Collapse]);break;default:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Expand])}}},{key:"_updateUi",value:function(){this._$container&&(this._state===ExpandButtonStatesEnum.expand?this._$container.classList.add(CssClassesConfig.h.Active):this._$container.classList.remove(CssClassesConfig.h.Active))}},{key:"setState",value:function(state){this._state!==state&&(this._state=state,this._updateUi())}},{key:"tooltip",get:function(){return this._state===ExpandButtonStatesEnum.expand?this._TOOLTIP_EXIT_INFO:this._TOOLTIP_ENTER_INFO}}]),ExpandButton}(AClickHoverComponent_AClickHoverComponent);function AUiVideoBase_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AUiVideoBase_AUiVideoBase=function(_AUiBase){inherits_default()(AUiVideoBase,_AUiBase);var _super=AUiVideoBase_createSuper(AUiVideoBase);function AUiVideoBase(mediator,$container,globalDomUtils,templateString,componentFactory){var _this;return classCallCheck_default()(this,AUiVideoBase),(_this=_super.call(this,mediator,$container,globalDomUtils,templateString,componentFactory))._tooltipHandler=new TooltipHandler_TooltipHandler(_this.$uiContainer,globalDomUtils),_this}return createClass_default()(AUiVideoBase,[{key:"handleComponentEvent",value:function(eventName,eventData,component){var targetComponent=component;switch(eventData.payload&&eventData.payload.targetComponent&&(targetComponent=eventData.payload.targetComponent),eventName){case UiComponentEventsEnum[UiComponentEventsEnum.HoverStart]:this._tooltipHandler.hoverStart(targetComponent);break;case UiComponentEventsEnum[UiComponentEventsEnum.HoverEnd]:this._tooltipHandler.hoverEnd(targetComponent);break;case UiComponentEventsEnum[UiComponentEventsEnum.StateChanged]:this._tooltipHandler.stateChanged(targetComponent)}}},{key:"updateDuration",value:function(elapsedTime,duration){if(Object(DomUtils.u)(this.$uiContainer,CssClassesConfig.g.ShowControls)){var elapsedTimeLabel=this.getComponent(UiComponentsEnum.ElapsedTimeLabel),durationLabel=this.getComponent(UiComponentsEnum.TotalDurationLabel),progressBar=this.getComponent(UiComponentsEnum.ProgressBar);if(elapsedTimeLabel&&elapsedTimeLabel.setTime(elapsedTime),durationLabel&&durationLabel.setTime(duration),progressBar){var fromEnd=duration;progressBar.setProgress(Object(NumberUtils.g)(0,fromEnd,0,100,elapsedTime))}}}},{key:"updateVolume",value:function(volume){}},{key:"expand",value:function(){this.getComponent(UiComponentsEnum.ExpandButton).setState(ExpandButtonStatesEnum.expand)}},{key:"collapse",value:function(){this.getComponent(UiComponentsEnum.ExpandButton).setState(ExpandButtonStatesEnum.collapse)}}]),AUiVideoBase}(AUiBase_AUiBase);function SettingsButton_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var SettingsButton_SettingsButton=function(_AClickHoverComponent){inherits_default()(SettingsButton,_AClickHoverComponent);var _super=SettingsButton_createSuper(SettingsButton);function SettingsButton(){var _this;return classCallCheck_default()(this,SettingsButton),(_this=_super.apply(this,arguments)).eventList=[UiComponentEventsEnum[UiComponentEventsEnum.Settings]].concat(toConsumableArray_default()(_this.eventList)),_this._TOOLTIP_INFO="Settings",_this}return createClass_default()(SettingsButton,[{key:"onClickHandler",value:function(){this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Settings])}},{key:"toggleHDFlag",value:function(isHD){isHD?Object(DomUtils.a)(this._$container,CssClassesConfig.h.Active):Object(DomUtils.L)(this._$container,CssClassesConfig.h.Active)}},{key:"tooltip",get:function(){return this._TOOLTIP_INFO}}]),SettingsButton}(AClickHoverComponent_AClickHoverComponent),settingsButtonTemplate=__webpack_require__(105),settingsButtonTemplate_default=__webpack_require__.n(settingsButtonTemplate);function AClickToggleComponent_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AClickToggleComponent_AClickToggleComponent=function(_AClickHoverComponent){inherits_default()(AClickToggleComponent,_AClickHoverComponent);var _super=AClickToggleComponent_createSuper(AClickToggleComponent);function AClickToggleComponent(mediator,globalDomUtils,interactionService,templateString,classNameToggle){var _this,defaultState=arguments.length>5&&void 0!==arguments[5]&&arguments[5],isMobile=arguments.length>6?arguments[6]:void 0;return classCallCheck_default()(this,AClickToggleComponent),(_this=_super.call(this,mediator,globalDomUtils,interactionService,templateString,isMobile))._classNameToggle=classNameToggle,_this.isActive=defaultState,_this}return createClass_default()(AClickToggleComponent,[{key:"onClickHandler",value:function(){this.isActive=!this.isActive,this.onStateChange()}},{key:"isActive",get:function(){return this._state},set:function(active){this._state=active,this._state?Object(DomUtils.a)(this._$container,this._classNameToggle):Object(DomUtils.L)(this._$container,this._classNameToggle)}}]),AClickToggleComponent}(AClickHoverComponent_AClickHoverComponent);function CaptionButton_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var CaptionButton_CaptionButton=function(_AClickToggleComponen){inherits_default()(CaptionButton,_AClickToggleComponen);var _super=CaptionButton_createSuper(CaptionButton);function CaptionButton(){var _this;return classCallCheck_default()(this,CaptionButton),(_this=_super.apply(this,arguments)).eventList=[UiComponentEventsEnum[UiComponentEventsEnum.CaptionOn],UiComponentEventsEnum[UiComponentEventsEnum.CaptionOff],UiComponentEventsEnum[UiComponentEventsEnum.StateChanged]].concat(toConsumableArray_default()(_this.eventList)),_this._TOOLTIP_ON_INFO="Subtitles On",_this._TOOLTIP_OFF_INFO="Subtitles Off",_this}return createClass_default()(CaptionButton,[{key:"onStateChange",value:function(){this.mediator.publish(this,this.isActive?UiComponentEventsEnum[UiComponentEventsEnum.CaptionOn]:UiComponentEventsEnum[UiComponentEventsEnum.CaptionOff]),this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.StateChanged])}},{key:"tooltip",get:function(){return this.isActive?this._TOOLTIP_OFF_INFO:this._TOOLTIP_ON_INFO}}]),CaptionButton}(AClickToggleComponent_AClickToggleComponent),captionButtonTemplate=__webpack_require__(106),captionButtonTemplate_default=__webpack_require__.n(captionButtonTemplate),upNextCardTemplate=__webpack_require__(178),upNextCardTemplate_default=__webpack_require__.n(upNextCardTemplate);function UpNextBox_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var UpNextBox_UpNextBox=function(_AClickComponent){inherits_default()(UpNextBox,_AClickComponent);var _super=UpNextBox_createSuper(UpNextBox);function UpNextBox(){var _this;return classCallCheck_default()(this,UpNextBox),(_this=_super.apply(this,arguments))._inView=!1,_this.eventList=[UiComponentEventsEnum[UiComponentEventsEnum.Next]],_this}return createClass_default()(UpNextBox,[{key:"onClickHandler",value:function(){this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Next])}},{key:"show",value:function(){this._inView=!0,this._$container.classList.add("cnx-fade-in-up-next")}},{key:"hide",value:function(){this._inView=!1,this._$container.classList.remove("cnx-fade-in-up-next")}},{key:"isInView",value:function(){return this._inView}},{key:"updateCard",value:function(imgUrl,description){var image=this._$container.getElementsByTagName("img")[0];image.setAttribute("src",imgUrl),image.style.display="none",image.onload=function(){image.style.display="block"},this._$container.getElementsByClassName("cnx-up-next-box-text")[0].innerHTML=Object(TypeUtils.h)(description)?description:""}}]),UpNextBox}(AClickComponent_AClickComponent);function LogoComponent_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var LogoComponent_LogoComponent=function(_ABaseComponent){inherits_default()(LogoComponent,_ABaseComponent);var _super=LogoComponent_createSuper(LogoComponent);function LogoComponent(mediator,globalDomUtils,interactionService,templateString,settings){var _this;return classCallCheck_default()(this,LogoComponent),(_this=_super.call(this,mediator,globalDomUtils,interactionService,templateString)).settings=settings,_this.eventList=[],_this._maxWidth=144,_this._maxHeight=36,_this}return createClass_default()(LogoComponent,[{key:"createLogo",value:function(){var _this2=this,logo=this._globalDomUtils.createElement("img");logo.onload=function(){logo=_this2.resizeLogo(logo),_this2._$container.appendChild(logo)},logo.src=this.settings.logoUrl,logo.alt=""}},{key:"resizeLogo",value:function(logo){var width=logo.naturalWidth,height=logo.naturalHeight;if(!width||!height)return logo;if(this.settings.logoPosition===Generated_protos.ProtoLogoPositionMode.ControlBar)logo.style.setProperty("height","".concat(this._maxHeight,"px"),"important"),logo.style.setProperty("width","".concat(this._maxHeight,"px"),"important");else{var ratio=width/height;this._maxHeight*ratio>this._maxWidth?(logo.style.setProperty("width","".concat(this._maxWidth,"px"),"important"),logo.style.setProperty("height","auto","important")):(logo.style.setProperty("width","auto","important"),logo.style.setProperty("height","".concat(this._maxHeight,"px"),"important"))}return logo}},{key:"initComponent",value:function(){try{this.createLogo()}catch(e){Object(Logging.a)({message:"LogoComponent_createLogo",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.FATAL})}}}]),LogoComponent}(ABaseComponent_ABaseComponent),TimeUtils=__webpack_require__(47);function TimeLabel_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var TimeLabel_TimeLabel=function(_ABaseComponent){inherits_default()(TimeLabel,_ABaseComponent);var _super=TimeLabel_createSuper(TimeLabel);function TimeLabel(){var _this;return classCallCheck_default()(this,TimeLabel),(_this=_super.apply(this,arguments)).eventList=[],_this}return createClass_default()(TimeLabel,[{key:"initComponent",value:function(){this._$label=this._$container.getElementsByTagName("cnx-span")[0]}},{key:"setTime",value:function(seconds){isNaN(seconds)||"number"!=typeof seconds?Object(DomUtils.a)(this._$container,CssClassesConfig.h.Invisible):(this._$label.innerHTML=Object(TimeUtils.f)(seconds),Object(DomUtils.L)(this._$container,CssClassesConfig.h.Invisible))}}]),TimeLabel}(ABaseComponent_ABaseComponent),timeLabelTemplate=__webpack_require__(80),timeLabelTemplate_default=__webpack_require__.n(timeLabelTemplate);function AProgressComponent_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AProgressComponent_AProgressComponent=function(_ABaseComponent){inherits_default()(AProgressComponent,_ABaseComponent);var _super=AProgressComponent_createSuper(AProgressComponent);function AProgressComponent(mediator,globalDomUtils,interactionService,templateString){var _this,isMobile=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return classCallCheck_default()(this,AProgressComponent),(_this=_super.call(this,mediator,globalDomUtils,interactionService,templateString,isMobile))._railFullWidth=0,_this._railStartPosX=null,_this._cachedTranslation=0,_this._progressStartValue=0,_this._progressEndValue=100,_this.cacheDomElements(),_this}return createClass_default()(AProgressComponent,[{key:"cacheDomElements",value:function(){this._$railFill=this._$container.getElementsByClassName("cnx-progress-fill")[0],this._$rail=this._$container.getElementsByClassName("cnx-progress-rail")[0]}},{key:"cacheWidths",value:function(){this._railFullWidth=this.fixedRailWidth?this.fixedRailWidth:this._$rail.getBoundingClientRect().width,this._railStartPosX=this._$rail.getBoundingClientRect().left}},{key:"updateUi",value:function(pixels){var computedTranslation=this.getComputedTranslation(pixels);this._cachedTranslation=computedTranslation,this._$railFill.style.transform="translateX(".concat(computedTranslation,"px)")}},{key:"isValidTranslation",value:function(){return this._cachedTranslation>=0&&this._cachedTranslation<=this._railFullWidth}},{key:"getComputedTranslation",value:function(pixels){return pixels<0?0:pixels>this._railFullWidth?this._railFullWidth:pixels}},{key:"setProgress",value:function(percentage){this.cacheWidths();var computedPixels=this.getComputedTranslation(Object(NumberUtils.g)(0,100,0,this._railFullWidth,percentage));this.updateUi(computedPixels)}},{key:"disableTransition",value:function(){Object(DomUtils.a)(this._$container,CssClassesConfig.h.NoTransition)}},{key:"enableTransition",value:function(){Object(DomUtils.L)(this._$container,CssClassesConfig.h.NoTransition)}},{key:"_changeProgressBarState",value:function(progressValue){this.disableTransition(),this.setProgress(progressValue),Object(DomUtils.i)(this._$railFill),this.enableTransition()}},{key:"forceStartState",value:function(){this._changeProgressBarState(this._progressStartValue)}},{key:"forceEndState",value:function(){this._changeProgressBarState(this._progressEndValue)}},{key:"initComponent",value:function(){this.cacheWidths()}},{key:"destroy",value:function(){get_default()(getPrototypeOf_default()(AProgressComponent.prototype),"destroy",this).call(this)}}]),AProgressComponent}(ABaseComponent_ABaseComponent);function ADraggableProgressComponent_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var ADraggableProgressComponent_ADraggableProgressComponent=function(_AProgressComponent){inherits_default()(ADraggableProgressComponent,_AProgressComponent);var _super=ADraggableProgressComponent_createSuper(ADraggableProgressComponent);function ADraggableProgressComponent(mediator,globalDomUtils,interactionService,templateString){var _this,isMobile=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return classCallCheck_default()(this,ADraggableProgressComponent),(_this=_super.call(this,mediator,globalDomUtils,interactionService,templateString,isMobile))._railHandleHalfWidth=0,_this._requestAnimationFrameId=null,_this._isDrag=!1,_this.eventList=[UiComponentEventsEnum[UiComponentEventsEnum.DraggingStart],UiComponentEventsEnum[UiComponentEventsEnum.DraggingStopped]],_this._startDrag=function(event){_this.cacheWidths(),_this._cacheCoordinatesAndUpdateProgress(_this._getClientX(event)),_this._isMobile?_this._$container.addEventListener(_this._moveEvent,_this._moveDrag):_this._globalDomUtils.addEventListenerOnGlobal(_this._moveEvent,_this._moveDrag),_this.onDragStart()},_this._moveDrag=function(event){null===_this._requestAnimationFrameId&&(_this._isDrag||(_this._isDrag=!0,_this.disableTransition()),_this._requestAnimationFrameId=_this._globalDomUtils.requestAnimationFrameHelper(function(){var pixelTranslation=_this._dragRailStartOrigin+(_this._getClientX(event)-_this._dragClientOrigin);_this.isValidTranslation()&&_this._updateProgressFromInteraction(pixelTranslation),_this._requestAnimationFrameId=null}))},_this._endDrag=function(event){event.stopPropagation(),_this._isMobile?_this._$container.removeEventListener(_this._moveEvent,_this._moveDrag):_this._globalDomUtils.removeEventListenerOnGlobal(_this._moveEvent,_this._moveDrag),_this._isDrag=!1,_this.enableTransition(),_this.onDragEnd()},_this._moveEvent=isMobile?"touchmove":"mousemove",_this}return createClass_default()(ADraggableProgressComponent,[{key:"cacheDomElements",value:function(){get_default()(getPrototypeOf_default()(ADraggableProgressComponent.prototype),"cacheDomElements",this).call(this),this._$railHandle=this._$container.getElementsByClassName("cnx-progress-handle")[0]}},{key:"cacheWidths",value:function(){get_default()(getPrototypeOf_default()(ADraggableProgressComponent.prototype),"cacheWidths",this).call(this),this._railHandleHalfWidth=this._$railHandle.getBoundingClientRect().width/2}},{key:"updateUi",value:function(pixels){get_default()(getPrototypeOf_default()(ADraggableProgressComponent.prototype),"updateUi",this).call(this,pixels);var computedTranslation=this.getComputedTranslation(pixels);this._$railHandle.style.transform="translateX(".concat(computedTranslation-this._railHandleHalfWidth,"px)")}},{key:"onDragEnd",value:function(){this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.DraggingStopped])}},{key:"onDragStart",value:function(){this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.DraggingStart])}},{key:"_getClientX",value:function(event){return this._isMobile?event.touches.item(0).clientX:event.clientX}},{key:"_cacheCoordinatesAndUpdateProgress",value:function(clientX){this._dragRailStartOrigin=clientX-this._railStartPosX,this._dragClientOrigin=clientX,this._updateProgressFromInteraction(this._dragRailStartOrigin)}},{key:"_updateProgressFromInteraction",value:function(pixels){if(this.isValidTranslation()){var pixelTranslation=this.getComputedTranslation(pixels),fromEnd=this._railFullWidth;this.updateUi(pixelTranslation),this.onProgressChange(Object(NumberUtils.g)(0,fromEnd,0,100,pixelTranslation))}}},{key:"setProgress",value:function(percentage){get_default()(getPrototypeOf_default()(ADraggableProgressComponent.prototype),"setProgress",this).call(this,percentage)}},{key:"initComponent",value:function(){get_default()(getPrototypeOf_default()(ADraggableProgressComponent.prototype),"initComponent",this).call(this);var callbackConfig={interactionstart:this._startDrag,interactionend:this._endDrag};this._interactionService.register(this._$container,this,this._interactionService,callbackConfig)}},{key:"destroy",value:function(){get_default()(getPrototypeOf_default()(ADraggableProgressComponent.prototype),"destroy",this).call(this)}}]),ADraggableProgressComponent}(AProgressComponent_AProgressComponent);function ProgressBar_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var ProgressBar_ProgressBar=function(_ADraggableProgressCo){inherits_default()(ProgressBar,_ADraggableProgressCo);var _super=ProgressBar_createSuper(ProgressBar);function ProgressBar(mediator,globalDomUtils,interactionService,templateString){var _this,isMobile=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return classCallCheck_default()(this,ProgressBar),(_this=_super.call(this,mediator,globalDomUtils,interactionService,templateString,isMobile))._inHoverBounds=!1,_this._onHoverEnterHandler=function(event){Object(DomUtils.a)(_this._$container,CssClassesConfig.h.HoverEnd),_this._inHoverBounds=!0},_this._onHoverMoveHandler=function(event){var computedTranslation=_this.getComputedTranslation(event.clientX-_this._railStartPosX);_this._$railFollow.style.transform="translateX(".concat(computedTranslation,"px)")},_this._onHoverEndHandler=function(event){_this._$railFollow.style.transform="translateX(0)",_this._inHoverBounds=!1,_this._handleHoverEndFreeze()},_this.eventList=_this.eventList.concat([UiComponentEventsEnum[UiComponentEventsEnum.Seek],UiComponentEventsEnum[UiComponentEventsEnum.SeekingStart],UiComponentEventsEnum[UiComponentEventsEnum.SeekingStopped]]),_this}return createClass_default()(ProgressBar,[{key:"onProgressChange",value:function(percentage){this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Seek],{payload:percentage-.1})}},{key:"onDragEnd",value:function(){get_default()(getPrototypeOf_default()(ProgressBar.prototype),"onDragEnd",this).call(this),this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.SeekingStopped]),this._handleHoverEndFreeze()}},{key:"onDragStart",value:function(){get_default()(getPrototypeOf_default()(ProgressBar.prototype),"onDragStart",this).call(this),this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.SeekingStart])}},{key:"_handleHoverEndFreeze",value:function(){this._inHoverBounds||this._isDrag||Object(DomUtils.L)(this._$container,CssClassesConfig.h.HoverEnd)}},{key:"initComponent",value:function(){get_default()(getPrototypeOf_default()(ProgressBar.prototype),"initComponent",this).call(this),this._$container.addEventListener("mousemove",this._onHoverMoveHandler),this._$container.addEventListener("mouseenter",this._onHoverEnterHandler),this._$container.addEventListener("mouseleave",this._onHoverEndHandler),this._$railFollow=this._$container.getElementsByClassName("cnx-progress-follow")[0]}},{key:"hide",value:function(){Object(DomUtils.v)(this._$container)}},{key:"show",value:function(){Object(DomUtils.R)(this._$container)}},{key:"destroy",value:function(){get_default()(getPrototypeOf_default()(ProgressBar.prototype),"destroy",this).call(this),this._$container.removeEventListener("mousemove",this._onHoverMoveHandler),this._$container.removeEventListener("mouseenter",this._onHoverEnterHandler),this._$container.removeEventListener("mouseleave",this._onHoverEndHandler)}}]),ProgressBar}(ADraggableProgressComponent_ADraggableProgressComponent),draggableProgressBarTemplate=__webpack_require__(107),draggableProgressBarTemplate_default=__webpack_require__.n(draggableProgressBarTemplate);function QueStateOverlay_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var MenuOptionsTypeEnum,QueStateOverlay_QueStateOverlay=function(_ABaseComponent){inherits_default()(QueStateOverlay,_ABaseComponent);var _super=QueStateOverlay_createSuper(QueStateOverlay);function QueStateOverlay(){var _this;return classCallCheck_default()(this,QueStateOverlay),(_this=_super.apply(this,arguments)).eventList=[],_this}return createClass_default()(QueStateOverlay,[{key:"initComponent",value:function(){this.hide()}},{key:"show",value:function(){Object(DomUtils.R)(this._$container)}},{key:"hide",value:function(){Object(DomUtils.v)(this._$container)}}]),QueStateOverlay}(ABaseComponent_ABaseComponent),contextMenuTemplate=__webpack_require__(179),contextMenuTemplate_default=__webpack_require__.n(contextMenuTemplate),loaderTemplate=__webpack_require__(108),loaderTemplate_default=__webpack_require__.n(loaderTemplate),settingsMenuTemplate=__webpack_require__(180),settingsMenuTemplate_default=__webpack_require__.n(settingsMenuTemplate);function AContextMenuComponent_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}!function(MenuOptionsTypeEnum){MenuOptionsTypeEnum[MenuOptionsTypeEnum.SimpleMenuItem=0]="SimpleMenuItem",MenuOptionsTypeEnum[MenuOptionsTypeEnum.ToggleMenuItem=1]="ToggleMenuItem",MenuOptionsTypeEnum[MenuOptionsTypeEnum.SubmenuMenuItem=2]="SubmenuMenuItem"}(MenuOptionsTypeEnum||(MenuOptionsTypeEnum={}));var AContextMenuComponent_AContextMenuComponent=function(_ABaseComponent){inherits_default()(AContextMenuComponent,_ABaseComponent);var _super=AContextMenuComponent_createSuper(AContextMenuComponent);function AContextMenuComponent(mediator,globalDomUtils,interactionService,template,eventName,_menuComponent,_$parentContainer,isMobile){var _this;return classCallCheck_default()(this,AContextMenuComponent),(_this=_super.call(this,mediator,globalDomUtils,interactionService,template,isMobile)).eventName=eventName,_this._menuComponent=_menuComponent,_this._$parentContainer=_$parentContainer,_this._currentMenuOptions=[],_this.eventList=[UiComponentEventsEnum[UiComponentEventsEnum.RebindComponent],UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.HoldStart],UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.HoldEnd],UiComponentEventsEnum[UiComponentEventsEnum.ContextMenuOpen],UiComponentEventsEnum[UiComponentEventsEnum.ContextMenuClose]],_this._onHoldPause=!1,_this._levelsToSearchClassInParent=10,_this._onSubmenuTransitionEnd=function(e){_this._$menuContainer.removeChild(e.target),_this._$menuContainer.style.width="".concat(_this._$container.clientWidth,"px")},_this.close=function(e){e&&Object(GeneralUtils.h)(e.target,CssClassesConfig.g.ContextController,_this._levelsToSearchClassInParent)||!1!==_this.isOpen&&(_this._onHoldPause&&(_this.mediator.publish(assertThisInitialized_default()(_this),UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.HoldEnd]),Object(DomUtils.L)(_this._$parentContainer,CssClassesConfig.h.OnHold),_this._onHoldPause=!1),_this.isOpen=!1,_this.mediator.publish(assertThisInitialized_default()(_this),UiComponentEventsEnum[UiComponentEventsEnum.ContextMenuClose]),Object(DomUtils.a)(_this._$container,CssClassesConfig.h.Invisible),_this._interactionService.removeGlobalActions(_this._$container),_this.closeAllSubmenuItems())},_this.close(),_this.cacheCoordinates(),_this.eventList.push(_this.eventName),_this._$menuContainer=_this._$container.getElementsByClassName(CssClassesConfig.k.Container)[0],_this._$menuOptionsContainer=_this._globalDomUtils.createElementByString('<cnx class="'.concat(CssClassesConfig.k.Items,'"></cnx>')),_this._$menuContainer.appendChild(_this._$menuOptionsContainer),Object(DomUtils.a)(_this._$menuContainer,CssClassesConfig.g.ContextController),_this}return createClass_default()(AContextMenuComponent,[{key:"addNewItemsEvent",value:function(events){var _this2=this,newEvents=events.filter(function(newEvent){return!Object(ArrayUtils.g)(newEvent,_this2.eventList)});newEvents.length>0&&(this.eventList=[].concat(toConsumableArray_default()(this.eventList),toConsumableArray_default()(newEvents)),this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.RebindComponent],{payload:this._menuComponent}))}},{key:"cacheCoordinates",value:function(){this._playerCoordinates=this._globalDomUtils.getElementCoordinates(this._$parentContainer)}},{key:"positionContextMenu",value:function(coordinates){this.cacheCoordinates(),moveElementToCoordinatesWithinContainer(this._$container,coordinates,this._playerCoordinates,{alignMiddle:this.alignMiddle,alignTop:this.alignTop,forceRight:this.forceRight})}},{key:"_handleItemsEvents",value:function(item){switch(item.type){case MenuOptionsTypeEnum.SimpleMenuItem:this.close();break;case MenuOptionsTypeEnum.SubmenuMenuItem:this._toggleSubmenu(item)}}},{key:"sendEvent",value:function(event,data){this.mediator.publish(this,event,data)}},{key:"_toggleSubmenu",value:function(item){var menuWidth=this._$container.clientWidth;item.isOpen?(item.$menuContainer.addEventListener("transitionend",this._onSubmenuTransitionEnd),this._$menuOptionsContainer.style.left="0px",item.$menuContainer.style.left="0px"):(item.$menuContainer.removeEventListener("transitionend",this._onSubmenuTransitionEnd),this._$menuContainer.style.width="".concat(2*menuWidth,"px"),this._$menuContainer.appendChild(item.$menuContainer),Object(DomUtils.i)(this._$menuContainer),this._$menuOptionsContainer.style.left="".concat(-menuWidth,"px"),item.$menuContainer.style.left="".concat(-menuWidth,"px")),item.isOpen=!item.isOpen}},{key:"closeAllSubmenuItems",value:function(){var _this3=this;this._currentMenuOptions.forEach(function(item){item.type===MenuOptionsTypeEnum.SubmenuMenuItem&&item.isOpen&&_this3._toggleSubmenu(item)})}},{key:"buildContextMenu",value:function(options){var _this4=this,itemsEvents=[];this._$menuOptionsContainer.innerHTML="",this._$menuContainer.style.width="".concat(this._$container.clientWidth,"px"),this._currentMenuOptions.forEach(function(item){return _this4.unsubscribeAll(item)}),this._currentMenuOptions=options,this._currentMenuOptions.forEach(function(item){itemsEvents=[].concat(toConsumableArray_default()(itemsEvents),toConsumableArray_default()(item.eventList)),item.eventList.forEach(function(event){return _this4.subscribe(event,item,function(data){_this4._handleItemsEvents(item),_this4.sendEvent(event,data)})}),item.initComponent(),_this4._$menuOptionsContainer.appendChild(item.getContainer())}),this.addNewItemsEvent(itemsEvents)}},{key:"getAnchorCoordinatesTo",value:function(linkedComponent){var _a;return null===(_a=linkedComponent)||void 0===_a?void 0:_a.getCoordinates()}},{key:"open",value:function(coordinates){var holdPause=arguments.length>1&&void 0!==arguments[1]&&arguments[1];holdPause&&(this._onHoldPause=holdPause,this.mediator.publish(this,UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.HoldStart]),Object(DomUtils.a)(this._$parentContainer,CssClassesConfig.h.OnHold)),this.isOpen=!0,this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.ContextMenuOpen]),this.positionContextMenu(coordinates);var callbackConfig={interactionend:this.close};this._interactionService.addGlobalActions(this._$container,callbackConfig),Object(DomUtils.L)(this._$container,CssClassesConfig.h.Invisible)}}]),AContextMenuComponent}(ABaseComponent_ABaseComponent);function SimpleMenuItem_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var SimpleMenuItem_SimpleMenuItem=function(_AClickComponent){inherits_default()(SimpleMenuItem,_AClickComponent);var _super=SimpleMenuItem_createSuper(SimpleMenuItem);function SimpleMenuItem(mediator,globalDomUtils,interactionService,isMobile,data){var _this;return classCallCheck_default()(this,SimpleMenuItem),(_this=_super.call(this,mediator,globalDomUtils,interactionService,SimpleMenuItem.getTemplate(data),isMobile)).mediator=mediator,_this._isActive=!1,_this.type=MenuOptionsTypeEnum.SimpleMenuItem,_this.eventList=[],_this.event=data.activeEvent,_this.name=data.name,data.eventList?_this.eventList=data.eventList:_this.eventList.push(_this.event),_this._$nameContainer=_this._$container.getElementsByClassName(CssClassesConfig.k.ItemTitle)[0],_this._$iconContainer=_this._$container.getElementsByClassName(CssClassesConfig.k.ItemIcon)[0],_this}return createClass_default()(SimpleMenuItem,[{key:"onClickHandler",value:function(event){this.mediator.publish(this,this.event)}},{key:"changeItemName",value:function(name){this._$nameContainer.innerHTML=name}},{key:"changeItemIcon",value:function(icon){this._$iconContainer.innerHTML=icon}},{key:"isActive",get:function(){return this._isActive},set:function(active){this._isActive=active,this._isActive?Object(DomUtils.a)(this._$container,CssClassesConfig.h.Active,CssClassesConfig.f.AccentColor):Object(DomUtils.L)(this._$container,CssClassesConfig.h.Active,CssClassesConfig.f.AccentColor)}}],[{key:"getTemplate",value:function(options){var icon='<cnx class="'.concat(CssClassesConfig.k.ItemIcon,'">').concat(options.icon,"</cnx>"),label='<cnx class="'.concat(CssClassesConfig.k.ItemExtra,'">').concat(options.label,"</cnx>");return'<cnx class="'.concat(CssClassesConfig.k.ClickOption,'">\n                    ').concat(options.icon?icon:"",'\n                    <cnx class="').concat(CssClassesConfig.k.ItemTitle,'">').concat(options.name,"</cnx>\n                    ").concat(options.label?label:"","\n                </cnx>")}}]),SimpleMenuItem}(AClickComponent_AClickComponent),connatixLogo=__webpack_require__(78),connatixLogo_default=__webpack_require__.n(connatixLogo),EnvironmentConfig=__webpack_require__(27);function ContextMenu_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var ContextMenu_ContextMenu=function(_AContextMenuComponen){inherits_default()(ContextMenu,_AContextMenuComponen);var _super=ContextMenu_createSuper(ContextMenu);function ContextMenu(){var _this;return classCallCheck_default()(this,ContextMenu),(_this=_super.apply(this,arguments)).alignMiddle=!1,_this.alignTop=!1,_this.forceRight=!0,_this}return createClass_default()(ContextMenu,[{key:"_createContextMenu",value:function(){var version=EnvironmentConfig.a.version?"V".concat(EnvironmentConfig.a.version):"dev",menuOptions=[new SimpleMenuItem_SimpleMenuItem(this,this._globalDomUtils,this._interactionService,this._isMobile,{activeEvent:UiComponentEventsEnum[UiComponentEventsEnum.AboutClick],name:"About Connatix",icon:connatixLogo_default.a,label:version})];this.buildContextMenu(menuOptions)}},{key:"initComponent",value:function(){this._createContextMenu()}},{key:"onResize",value:function(){this.cacheCoordinates(),this.close()}}]),ContextMenu}(AContextMenuComponent_AContextMenuComponent);function ToggleMenuItem_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var ToggleMenuItem_ToggleMenuItem=function(_AClickToggleComponen){inherits_default()(ToggleMenuItem,_AClickToggleComponen);var _super=ToggleMenuItem_createSuper(ToggleMenuItem);function ToggleMenuItem(mediator,globalDomUtils,interactionService,isMobile,data){var _this;return classCallCheck_default()(this,ToggleMenuItem),(_this=_super.call(this,mediator,globalDomUtils,interactionService,ToggleMenuItem.getTemplate(data),CssClassesConfig.h.Active,data.defaultState,isMobile)).mediator=mediator,_this.eventList=[],_this.type=MenuOptionsTypeEnum.ToggleMenuItem,_this._eventOn=data.eventOn,_this._eventOff=data.eventOff,_this.eventList.push(_this._eventOn,_this._eventOff),_this}return createClass_default()(ToggleMenuItem,[{key:"onStateChange",value:function(){this.mediator.publish(this,this.isActive?this._eventOn:this._eventOff)}},{key:"tooltip",get:function(){return""}}],[{key:"getTemplate",value:function(options){var icon='<cnx class="'.concat(CssClassesConfig.k.ItemIcon,'">').concat(options.icon,"</cnx>");return'<cnx class="'.concat(CssClassesConfig.k.ToggleOption," ").concat(options.defaultState?CssClassesConfig.h.Active:"",'">\n                    ').concat(options.icon?icon:"",'\n                    <cnx class="').concat(CssClassesConfig.k.ItemTitle,'">').concat(options.name,'</cnx>\n                    <cnx class="').concat(CssClassesConfig.k.ItemExtra,'">\n                        <cnx class="cnx-cm-toggle-switch">\n                            <cnx class="cnx-cm-slider ').concat(CssClassesConfig.f.AccentColor,'"></cnx>\n                        </cnx>\n                    </cnx>\n                </cnx>')}}]),ToggleMenuItem}(AClickToggleComponent_AClickToggleComponent),ElementsComponentLabelsEnum={ContextAbout:"About Connatix",ContextQuality:"Video Settings",ContextCaption:"Closed Caption"};function ElementsSettingsMenu_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var ElementsSettingsMenu_ElementsSettingsMenu=function(_AContextMenuComponen){inherits_default()(ElementsSettingsMenu,_AContextMenuComponen);var _super=ElementsSettingsMenu_createSuper(ElementsSettingsMenu);function ElementsSettingsMenu(mediator,globalDomUtils,interactionService,template,eventName,menuComponent,$parentContainer,currentBreakpointClass,isMobile){var _this,defaultCaptionState=!(arguments.length>9&&void 0!==arguments[9])||arguments[9];return classCallCheck_default()(this,ElementsSettingsMenu),(_this=_super.call(this,mediator,globalDomUtils,interactionService,template,eventName,menuComponent,$parentContainer,isMobile)).alignMiddle=!1,_this.alignTop=!1,_this.forceRight=!1,_this._baseOptions=[new SimpleMenuItem_SimpleMenuItem(assertThisInitialized_default()(_this),_this._globalDomUtils,_this._interactionService,_this._isMobile,{activeEvent:UiComponentEventsEnum[UiComponentEventsEnum.AboutClick],name:ElementsComponentLabelsEnum.ContextAbout,icon:connatixLogo_default.a,label:EnvironmentConfig.a.version?"V".concat(EnvironmentConfig.a.version):"dev"})],_this._captionButton=new ToggleMenuItem_ToggleMenuItem(assertThisInitialized_default()(_this),_this._globalDomUtils,_this._interactionService,_this._isMobile,{eventOff:UiComponentEventsEnum[UiComponentEventsEnum.CaptionOff],eventOn:UiComponentEventsEnum[UiComponentEventsEnum.CaptionOn],defaultState:defaultCaptionState,name:ElementsComponentLabelsEnum.ContextCaption,icon:captionButtonTemplate_default.a}),_this._extendedOptions=[_this._captionButton],_this._breakPointClass=currentBreakpointClass,_this}return createClass_default()(ElementsSettingsMenu,[{key:"_createSettingsMenu",value:function(){var options=this._baseOptions;this._breakPointClass===CssClassesConfig.t.Lg&&(options=[].concat(toConsumableArray_default()(this._extendedOptions),toConsumableArray_default()(this._baseOptions))),this.buildContextMenu(options)}},{key:"initComponent",value:function(){this._createSettingsMenu()}},{key:"onResize",value:function(coordinates,breakPointClass){this.isOpen&&this.positionContextMenu(coordinates),this._breakPointClass!==breakPointClass?(this._breakPointClass=breakPointClass,this.closeAllSubmenuItems(),this._createSettingsMenu()):this._breakPointClass=breakPointClass}},{key:"toggleCaptionState",value:function(active){this._captionButton.isActive!==active&&(this._captionButton.isActive=active)}},{key:"hideCaptionOption",value:function(){this._captionButton.hideComponent()}},{key:"showCaptionOption",value:function(){this._captionButton.showComponent()}},{key:"getAnchorCoordinatesTo",value:function(linkedComponent){var anchorPoint=PositionFlags.Right;return this._breakPointClass!==CssClassesConfig.t.Xl&&this._breakPointClass!==CssClassesConfig.t.Xxl&&(anchorPoint|=PositionFlags.Top),linkedComponent.getCoordinates(anchorPoint)}}]),ElementsSettingsMenu}(AContextMenuComponent_AContextMenuComponent);function sanitizeHyphens(text){return text.replace(/[-â]/g,"&#x2011;")}function sanitizeDfpMacros(macros){try{return Object.keys(macros).reduce(function(acc,key){return Object.assign(Object.assign({},acc),defineProperty_default()({},key,Object(TypeUtils.h)(macros[key])&&macros[key].includes("%%")?void 0:macros[key]))},{})}catch(e){return Object(Logging.a)({message:"sanitizeDfpMacros_error",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.WARNING}),Object.keys(macros).reduce(function(acc,key){return Object.assign(Object.assign({},acc),defineProperty_default()({},key,Object(TypeUtils.h)(macros[key])&&macros[key].indexOf("%%")>-1?void 0:macros[key]))},{})}}function isJapaneseText(text){return!!text.match(/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/)}function CaptionComponent_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var CaptionComponent_CaptionComponent=function(_ABaseComponent){inherits_default()(CaptionComponent,_ABaseComponent);var _super=CaptionComponent_createSuper(CaptionComponent);function CaptionComponent(){var _this;return classCallCheck_default()(this,CaptionComponent),(_this=_super.apply(this,arguments)).eventList=[],_this}return createClass_default()(CaptionComponent,[{key:"initComponent",value:function(){this._$captionContainer=this._$container.getElementsByClassName(CssClassesConfig.e.CaptionContainer)[0]}},{key:"updateCaptions",value:function(activeCue){var inputString,replaceWith;this._$captionContainer.innerHTML=activeCue&&activeCue.text?(inputString=activeCue.text,replaceWith="<br>",inputString.replace(/(?:\r\n|\r|\n)/g,replaceWith)):""}}]),CaptionComponent}(ABaseComponent_ABaseComponent),captionTemplate=__webpack_require__(181),captionTemplate_default=__webpack_require__.n(captionTemplate);function LogoOutstream_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var LogoOutstream_LogoOutstream=function(_LogoComponent){inherits_default()(LogoOutstream,_LogoComponent);var _super=LogoOutstream_createSuper(LogoOutstream);function LogoOutstream(){var _this;return classCallCheck_default()(this,LogoOutstream),(_this=_super.apply(this,arguments))._classSquareLogo="cnx-logo-height",_this._classLongLogo="cnx-logo-width",_this}return createClass_default()(LogoOutstream,[{key:"createLogo",value:function(){var _this2=this;this._$container.onload=function(){_this2._$container.style.visibility="visible",_this2.resizeLogo(_this2._$container)},this._$container.style.visibility="hidden",this._$container.src=this.settings.logoUrl}},{key:"resizeLogo",value:function(logo){var width=logo.naturalWidth,height=logo.naturalHeight;return width&&height?(width>height?Object(DomUtils.a)(logo,this._classLongLogo):Object(DomUtils.a)(logo,this._classSquareLogo),logo):logo}}]),LogoOutstream}(LogoComponent_LogoComponent),svg_play=__webpack_require__(182),play_default=__webpack_require__.n(svg_play),svg_pause=__webpack_require__(183),pause_default=__webpack_require__.n(svg_pause);function VolumeProgress_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var VolumeProgress_VolumeProgress=function(_ADraggableProgressCo){inherits_default()(VolumeProgress,_ADraggableProgressCo);var _super=VolumeProgress_createSuper(VolumeProgress);function VolumeProgress(mediator,globalDomUtils,interactionService,templateString){var _this,isMobile=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return classCallCheck_default()(this,VolumeProgress),(_this=_super.call(this,mediator,globalDomUtils,interactionService,templateString,isMobile))._volumeProgressWidth=80,_this.fixedRailWidth=_this._volumeProgressWidth,_this.eventList.push(UiComponentEventsEnum[UiComponentEventsEnum.Volume]),_this}return createClass_default()(VolumeProgress,[{key:"onProgressChange",value:function(percentage){this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Volume],{payload:percentage})}}]),VolumeProgress}(ADraggableProgressComponent_ADraggableProgressComponent),volumeProgress=__webpack_require__(184),volumeProgress_default=__webpack_require__.n(volumeProgress),expandButtonTemplate=__webpack_require__(185),expandButtonTemplate_default=__webpack_require__.n(expandButtonTemplate);function onUpdateQuality(qualityItems,currentQuality,isAutoSelected){var activeQuality=isAutoSelected?VideoQualityEnum[VideoQualityEnum.Auto]:currentQuality.height.toString();qualityItems.forEach(function(item){return item.name.indexOf(activeQuality)>-1?item.isActive=!0:item.isActive=!1});var autoItem=qualityItems.find(function(item){return VideoQualityEnum[item.event]===VideoQualityEnum.Auto});if(isAutoSelected){var selectedQuality=qualityItems.find(function(item){return item.event===currentQuality.height.toString()});if(selectedQuality){var autoLabel="".concat(autoItem.name," (").concat(selectedQuality.name,")");autoItem.changeItemName(autoLabel)}}else autoItem.changeItemName(autoItem.name)}function QualityMenu_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var QualityMenu_QualityMenu=function(_AContextMenuComponen){inherits_default()(QualityMenu,_AContextMenuComponen);var _super=QualityMenu_createSuper(QualityMenu);function QualityMenu(){var _this;return classCallCheck_default()(this,QualityMenu),(_this=_super.apply(this,arguments)).alignMiddle=!0,_this.alignTop=!0,_this.forceRight=!1,_this._menuItems=[],_this._currentQuality={height:360,quality:VideoQualityEnum.Auto},_this._isAutoSelected=!0,_this}return createClass_default()(QualityMenu,[{key:"sendEvent",value:function(event){this._isAutoSelected=VideoQualityEnum[event]===VideoQualityEnum.Auto,this.mediator.publish(this,this.eventName,{payload:{height:this._isAutoSelected?this._currentQuality.height:parseInt(event,10),quality:this._isAutoSelected?VideoQualityEnum.Auto:VideoQualityEnum.Strict}})}},{key:"initComponent",value:function(){}},{key:"createQualityMenu",value:function(availableQualities){var _this2=this;this._menuItems=[],this._availableQualities=availableQualities,this._availableQualities.forEach(function(quality){_this2._menuItems.push(new SimpleMenuItem_SimpleMenuItem(_this2,_this2._globalDomUtils,_this2._interactionService,_this2._isMobile,{name:"".concat(quality.videoHeight,"p"),activeEvent:quality.videoHeight.toString(),label:quality.isHD?"HD":void 0}))}),this._menuItems.push(new SimpleMenuItem_SimpleMenuItem(this,this._globalDomUtils,this._interactionService,this._isMobile,{name:VideoQualityEnum[VideoQualityEnum.Auto],activeEvent:VideoQualityEnum[VideoQualityEnum.Auto]})),onUpdateQuality(this._menuItems,this._currentQuality,this._isAutoSelected),this.buildContextMenu(this._menuItems)}},{key:"onResize",value:function(coordinates){this.cacheCoordinates(),this.isOpen&&this.positionContextMenu(coordinates)}},{key:"updateQuality",value:function(qualitySettings){Object(ArrayUtils.h)(this._availableQualities)&&(this._isAutoSelected=qualitySettings.quality===VideoQualityEnum.Auto,this._currentQuality.quality=qualitySettings.quality,this._currentQuality.height=Object(NumberUtils.c)(qualitySettings.height,this._availableQualities.map(function(elem){return elem.videoHeight})),onUpdateQuality(this._menuItems,this._currentQuality,this._isAutoSelected))}}]),QualityMenu}(AContextMenuComponent_AContextMenuComponent),qualityMenuTemplate=__webpack_require__(186),qualityMenuTemplate_default=__webpack_require__.n(qualityMenuTemplate);function LoaderOverlay_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var LoaderOverlay_LoaderOverlay=function(_ABaseComponent){inherits_default()(LoaderOverlay,_ABaseComponent);var _super=LoaderOverlay_createSuper(LoaderOverlay);function LoaderOverlay(){var _this;return classCallCheck_default()(this,LoaderOverlay),(_this=_super.apply(this,arguments)).eventList=[],_this}return createClass_default()(LoaderOverlay,[{key:"initComponent",value:function(){this.hide()}},{key:"show",value:function(){Object(DomUtils.R)(this._$container),Object(DomUtils.i)(this._$container),Object(DomUtils.a)(this._$container,CssClassesConfig.h.Active)}},{key:"hide",value:function(){Object(DomUtils.L)(this._$container,CssClassesConfig.h.Active),Object(DomUtils.v)(this._$container)}}]),LoaderOverlay}(ABaseComponent_ABaseComponent);function HoverButton_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var HoverButton_HoverButton=function(_AClickHoverComponent){inherits_default()(HoverButton,_AClickHoverComponent);var _super=HoverButton_createSuper(HoverButton);function HoverButton(mediator,globalDomUtils,interactionService,templateString,isMobile,component,tooltip){var _this;return classCallCheck_default()(this,HoverButton),(_this=_super.call(this,mediator,globalDomUtils,interactionService,templateString,isMobile)).tooltip=tooltip,_this._buttonName=UiComponentsEnum[component],_this.eventList.push(_this._buttonName),_this}return createClass_default()(HoverButton,[{key:"onClickHandler",value:function(){this.mediator.publish(this,this._buttonName)}}]),HoverButton}(AClickHoverComponent_AClickHoverComponent);function ClickButton_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var ClickButton_ClickButton=function(_AClickComponent){inherits_default()(ClickButton,_AClickComponent);var _super=ClickButton_createSuper(ClickButton);function ClickButton(mediator,globalDomUtils,interactionService,template,isMobile,component,tooltip){var _this;return classCallCheck_default()(this,ClickButton),(_this=_super.call(this,mediator,globalDomUtils,interactionService,template,isMobile)).tooltip=tooltip,_this.eventList=[],_this._buttonName=UiComponentsEnum[component],_this.eventList.push(_this._buttonName),_this}return createClass_default()(ClickButton,[{key:"onClickHandler",value:function(){this.mediator.publish(this,this._buttonName)}}]),ClickButton}(AClickComponent_AClickComponent),GeneralButtonFactory_GeneralButtonFactory=function(){function GeneralButtonFactory(_globalDomUtils,_interactionService,_isMobile,componentsConfig){var _this=this;classCallCheck_default()(this,GeneralButtonFactory),this._globalDomUtils=_globalDomUtils,this._interactionService=_interactionService,this._isMobile=_isMobile,this._generalComponents=new Map,Object.keys(componentsConfig).forEach(function(component){return _this._registerGeneralComponent(UiComponentsEnum[component],componentsConfig[component])})}return createClass_default()(GeneralButtonFactory,[{key:"getButton",value:function(component,componentMediator){var _this$_getComponentSe=this._getComponentSettings(component),isHoverable=_this$_getComponentSe.isHoverable,template=_this$_getComponentSe.template,tooltip=_this$_getComponentSe.tooltip;return isHoverable?new HoverButton_HoverButton(componentMediator,this._globalDomUtils,this._interactionService,template,this._isMobile,component,tooltip):new ClickButton_ClickButton(componentMediator,this._globalDomUtils,this._interactionService,template,this._isMobile,component,tooltip)}},{key:"isGeneralComponent",value:function(component){return this._generalComponents.has(component)}},{key:"_getComponentSettings",value:function(component){return this._generalComponents.get(component)}},{key:"_registerGeneralComponent",value:function(component,settings){this._generalComponents.set(component,settings)}}]),GeneralButtonFactory}(),svg_close=__webpack_require__(187),close_default=__webpack_require__.n(svg_close);function getGeneralButtonTemplate(component,template){return!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?'\n            <cnx class="cnx-icon-button cnx-button-'.concat(UiComponentsEnum[component].toLowerCase(),' cnx-ui-btn-hoverable">\n                <cnx class="cnx-btn-container">\n                    ').concat(template,"\n                </cnx>\n            </cnx>\n        ").trim():'<cnx class="cnx-button-'.concat(UiComponentsEnum[component].toLowerCase(),'">').concat(template,"</cnx>")}var _CommonGeneralCompone,upNext=__webpack_require__(125),upNext_default=__webpack_require__.n(upNext),moreButton=__webpack_require__(188),moreButton_default=__webpack_require__.n(moreButton),Config_CommonGeneralComponentsConfig=(_CommonGeneralCompone={},defineProperty_default()(_CommonGeneralCompone,UiComponentsEnum[UiComponentsEnum.MoreButton],{template:getGeneralButtonTemplate(UiComponentsEnum.MoreButton,moreButton_default.a),tooltip:"More",isHoverable:!0}),defineProperty_default()(_CommonGeneralCompone,UiComponentsEnum[UiComponentsEnum.CloseButton],{template:getGeneralButtonTemplate(UiComponentsEnum.CloseButton,close_default.a),tooltip:"Close Player",isHoverable:!0}),defineProperty_default()(_CommonGeneralCompone,UiComponentsEnum[UiComponentsEnum.UpNextButton],{template:getGeneralButtonTemplate(UiComponentsEnum.UpNextButton,upNext_default.a),tooltip:"Next",isHoverable:!0}),defineProperty_default()(_CommonGeneralCompone,UiComponentsEnum[UiComponentsEnum.PreviousButton],{template:getGeneralButtonTemplate(UiComponentsEnum.PreviousButton,upNext_default.a),tooltip:"Previous",isHoverable:!0}),_CommonGeneralCompone);function SkipAdButton_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var SkipAdButton_SkipAdButton=function(_AClickHoverComponent){inherits_default()(SkipAdButton,_AClickHoverComponent);var _super=SkipAdButton_createSuper(SkipAdButton);function SkipAdButton(){var _this;return classCallCheck_default()(this,SkipAdButton),(_this=_super.apply(this,arguments)).eventList=[UiComponentEventsEnum[UiComponentEventsEnum.SkipAd]].concat(toConsumableArray_default()(_this.eventList)),_this._secondsUntilSkip=-1,_this._currentlyRemainingSeconds=-1,_this}return createClass_default()(SkipAdButton,[{key:"initComponent",value:function(){get_default()(getPrototypeOf_default()(SkipAdButton.prototype),"initComponent",this).call(this),this.hideComponent(),this._$skipAdAfterLabel=this._$container.getElementsByTagName("cnx-span")[0],this._$skipAdAfterLabel.innerHTML="Ad",this._$skipAdTimer=this._$container.querySelectorAll(".".concat(CssClassesConfig.q.Timer," svg"))[0]}},{key:"setSecondsUntilSkip",value:function(seconds){this._secondsUntilSkip=Math.ceil(seconds),this._currentlyRemainingSeconds=-1,this._secondsUntilSkip>0&&Object(DomUtils.Q)(this._$skipAdTimer,{"animation-duration":this._secondsUntilSkip+"s"})}},{key:"tickDown",value:function(elapsedSeconds){var differenceWithElapsed=this._secondsUntilSkip-Math.floor(elapsedSeconds);if(!(differenceWithElapsed<0||0===this._currentlyRemainingSeconds)){var isInTimer=Object(DomUtils.u)(this._$container,CssClassesConfig.q.InTimer);this._currentlyRemainingSeconds=differenceWithElapsed,0===this._currentlyRemainingSeconds?(isInTimer&&Object(DomUtils.L)(this._$container,CssClassesConfig.q.InTimer),this._$skipAdAfterLabel.innerHTML="Ad"):(isInTimer||Object(DomUtils.a)(this._$container,CssClassesConfig.q.InTimer),this._$skipAdAfterLabel.innerHTML="in ".concat(this._currentlyRemainingSeconds,"s"))}}},{key:"onClickHandler",value:function(){0===this._currentlyRemainingSeconds&&this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.SkipAd])}},{key:"tooltip",get:function(){}}]),SkipAdButton}(AClickHoverComponent_AClickHoverComponent),skipAdButtonTemplate=__webpack_require__(189),skipAdButtonTemplate_default=__webpack_require__.n(skipAdButtonTemplate),open_in_new=__webpack_require__(190),open_in_new_default=__webpack_require__.n(open_in_new),BrowserConfig=__webpack_require__(34);function AdLoadingScreen_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var VolumeButtonStates,AdLoadingScreen_AdLoadingScreen=function(_ABaseComponent){inherits_default()(AdLoadingScreen,_ABaseComponent);var _super=AdLoadingScreen_createSuper(AdLoadingScreen);function AdLoadingScreen(){var _this;return classCallCheck_default()(this,AdLoadingScreen),(_this=_super.apply(this,arguments)).eventList=[],_this}return createClass_default()(AdLoadingScreen,[{key:"initComponent",value:function(){this._$backgroundImg=this._$container.getElementsByClassName(CssClassesConfig.a.BackgroundImg)[0],this._$openIcon=this._$container.getElementsByClassName(CssClassesConfig.a.Icon)[0],this._$openIcon.innerHTML=open_in_new_default.a,this._$readMoreContainer=this._$container.getElementsByClassName(CssClassesConfig.a.ButtonContainer)[0];var textElem=this._$container.getElementsByClassName(CssClassesConfig.a.Button)[0];this._$readMoreWrapper=this._globalDomUtils.createElementByString('<a class="'.concat(CssClassesConfig.a.Wrapper,'" href="#">')),this._$readMoreWrapper.target=BrowserConfig.c.Blank,this._$readMoreWrapper.appendChild(textElem),this._$readMoreContainer.innerHTML="",this._$readMoreContainer.appendChild(this._$readMoreWrapper),this._$infoContainer=this._$container.getElementsByClassName(CssClassesConfig.a.InfoContainer)[0],this._$fallbackContainer=this._$container.getElementsByClassName(CssClassesConfig.a.FallbackContainer)[0],this._$slotCountText=this._$container.getElementsByClassName(CssClassesConfig.a.SlotCountText)[0]}},{key:"setBackgroundImg",value:function(backgroundSrc){Object(TypeUtils.h)(backgroundSrc)?(Object(DomUtils.L)(this._$backgroundImg,CssClassesConfig.h.DisplayNone),this._$backgroundImg.src=backgroundSrc):Object(DomUtils.a)(this._$backgroundImg,CssClassesConfig.h.DisplayNone)}},{key:"setClickUrl",value:function(clickUrl){if(!Object(TypeUtils.h)(clickUrl))return Object(DomUtils.R)(this._$fallbackContainer),void Object(DomUtils.v)(this._$infoContainer);Object(DomUtils.R)(this._$infoContainer),Object(DomUtils.v)(this._$fallbackContainer),this._$readMoreWrapper.href=clickUrl}},{key:"setFallbackText",value:function(currentAdSlotIndex,slotsInBreak){var sanitizedParams={currentAdSlotIndex:currentAdSlotIndex||1,slotsInBreak:slotsInBreak||1};this._$slotCountText.innerHTML="".concat("Loading ad"," ").concat(sanitizedParams.currentAdSlotIndex,"/").concat(sanitizedParams.slotsInBreak)}}]),AdLoadingScreen}(ABaseComponent_ABaseComponent),adLoadingScreenTemplate=__webpack_require__(191),adLoadingScreenTemplate_default=__webpack_require__.n(adLoadingScreenTemplate),AUiBaseComponentFactory_AUiBaseComponentFactory=function(){function AUiBaseComponentFactory(_globalDomUtils,_interactionService,_$container){var _this$_createBaseComp,_this=this,_settings=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},customComponentsConfig=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};classCallCheck_default()(this,AUiBaseComponentFactory),this._globalDomUtils=_globalDomUtils,this._interactionService=_interactionService,this._$container=_$container,this._settings=_settings,this._createBaseComponentsActions=(_this$_createBaseComp={},defineProperty_default()(_this$_createBaseComp,UiComponentsEnum.PlayButton,function(componentMediator){return _this._createPlayButton(!1,componentMediator)}),defineProperty_default()(_this$_createBaseComp,UiComponentsEnum.BigPlayButton,function(componentMediator){return _this._createPlayButton(!0,componentMediator)}),defineProperty_default()(_this$_createBaseComp,UiComponentsEnum.VolumeProgress,function(componentMediator){return new VolumeProgress_VolumeProgress(componentMediator,_this._globalDomUtils,_this._interactionService,volumeProgress_default.a)}),defineProperty_default()(_this$_createBaseComp,UiComponentsEnum.ExpandButton,function(componentMediator){return new ExpandButton_ExpandButton(componentMediator,_this._globalDomUtils,_this._interactionService,expandButtonTemplate_default.a,_this._settings.isMobile)}),defineProperty_default()(_this$_createBaseComp,UiComponentsEnum.QualityMenu,function(componentMediator){return new QualityMenu_QualityMenu(componentMediator,_this._globalDomUtils,_this._interactionService,qualityMenuTemplate_default.a,UiComponentEventsEnum[UiComponentEventsEnum.Quality],UiComponentsEnum.QualityMenu,_this._$container,_this._settings.isMobile)}),defineProperty_default()(_this$_createBaseComp,UiComponentsEnum.Loader,function(componentMediator){return new LoaderOverlay_LoaderOverlay(componentMediator,_this._globalDomUtils,_this._interactionService,loaderTemplate_default.a)}),defineProperty_default()(_this$_createBaseComp,UiComponentsEnum.SkipAdButton,function(componentMediator){return new SkipAdButton_SkipAdButton(componentMediator,_this._globalDomUtils,_this._interactionService,skipAdButtonTemplate_default.a,_this._settings.isMobile)}),defineProperty_default()(_this$_createBaseComp,UiComponentsEnum.AdLoadingScreen,function(componentMediator){return new AdLoadingScreen_AdLoadingScreen(componentMediator,_this._globalDomUtils,_this._interactionService,adLoadingScreenTemplate_default.a)}),_this$_createBaseComp),this._createPlayButton=function(isBig,componentMediator){return new PlayButton_PlayButton(componentMediator,_this._globalDomUtils,_this._interactionService,function(){var isBigPlay=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return'\n    <cnx class="cnx-icon-button cnx-ui-btn-hoverable '.concat(isBigPlay?"cnx-button-big-play":"",'">\n        <cnx class="cnx-btn-container">\n            <cnx class="cnx-play-icon">').concat(play_default.a,'</cnx>\n            <cnx class="cnx-pause-icon">').concat(pause_default.a,"</cnx>\n        </cnx>\n    </cnx>\n").trim()}(isBig),_this._settings.isMobile)},this._getCreateBaseComponentAction=function(componentName){return function(componentMediator){var createComponent=_this._createBaseComponentsActions[componentName];if(createComponent)return createComponent(componentMediator)}},this._generalButtonFactory=new GeneralButtonFactory_GeneralButtonFactory(this._globalDomUtils,this._interactionService,this._settings.isMobile,Object.assign(Object.assign({},Config_CommonGeneralComponentsConfig),customComponentsConfig))}return createClass_default()(AUiBaseComponentFactory,[{key:"createComponent",value:function(componentName,componentMediator){var createComponent=this._getCreateBaseComponentAction(componentName),component=createComponent(componentMediator);return component||(this._generalButtonFactory.isGeneralComponent(componentName)?this._generalButtonFactory.getButton(componentName,componentMediator):void 0)}}]),AUiBaseComponentFactory}();function VolumeButton_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}!function(VolumeButtonStates){VolumeButtonStates[VolumeButtonStates.Mute=0]="Mute",VolumeButtonStates[VolumeButtonStates.Unmute=1]="Unmute"}(VolumeButtonStates||(VolumeButtonStates={}));var VolumeButton_VolumeButton=function(_AClickHoverComponent){inherits_default()(VolumeButton,_AClickHoverComponent);var _super=VolumeButton_createSuper(VolumeButton);function VolumeButton(mediator,globalDomUtils,interactionService,templateString,initialState,isMobile){var _this;return classCallCheck_default()(this,VolumeButton),(_this=_super.call(this,mediator,globalDomUtils,interactionService,templateString,isMobile)).eventList=[UiComponentEventsEnum[UiComponentEventsEnum.Mute],UiComponentEventsEnum[UiComponentEventsEnum.Unmute],UiComponentEventsEnum[UiComponentEventsEnum.StateChanged]].concat(toConsumableArray_default()(_this.eventList)),_this._TOOLTIP_MUTE_INFO="Mute",_this._TOOLTIP_UNMUTE_INFO="Unmute",_this._state=initialState,_this}return createClass_default()(VolumeButton,[{key:"onClickHandler",value:function(){this._state===VolumeButtonStates.Mute?(this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Unmute]),this.setState(VolumeButtonStates.Unmute)):(this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Mute]),this.setState(VolumeButtonStates.Mute))}},{key:"_updateUi",value:function(){this._state===VolumeButtonStates.Mute?Object(DomUtils.O)(this._$container,"cnx-sound-on","cnx-sound-off"):Object(DomUtils.O)(this._$container,"cnx-sound-off","cnx-sound-on")}},{key:"initComponent",value:function(){get_default()(getPrototypeOf_default()(VolumeButton.prototype),"initComponent",this).call(this),this._updateUi()}},{key:"setState",value:function(state){this._state!==state&&(this._state=state,this._updateUi(),this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.StateChanged]))}},{key:"setVolume",value:function(volume){volume>0?this.setState(VolumeButtonStates.Unmute):this.setState(VolumeButtonStates.Mute)}},{key:"tooltip",get:function(){return this._state===VolumeButtonStates.Mute?this._TOOLTIP_UNMUTE_INFO:this._TOOLTIP_MUTE_INFO}}]),VolumeButton}(AClickHoverComponent_AClickHoverComponent);function AMasterComponent_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AMasterComponent_AMasterComponent=function(_AUiComponentHandler){inherits_default()(AMasterComponent,_AUiComponentHandler);var _super=AMasterComponent_createSuper(AMasterComponent);function AMasterComponent(mediator,globalDomUtils,templateString,factory){var _this;return classCallCheck_default()(this,AMasterComponent),(_this=_super.call(this,globalDomUtils,templateString,factory)).mediator=mediator,_this._$container=_this._templateEngine.getRenderedDom(),_this}return createClass_default()(AMasterComponent,[{key:"getContainer",value:function(){return this._$container}},{key:"initComponent",value:function(){this._templateEngine.initComponents()}},{key:"showComponent",value:function(){Object(DomUtils.R)(this._$container)}},{key:"hideComponent",value:function(){Object(DomUtils.v)(this._$container)}}]),AMasterComponent}(AUiComponentHandler_AUiComponentHandler);function VolumeControl_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var _ElementsGeneralCompo,VolumeControl_VolumeControls=function(_AMasterComponent){inherits_default()(VolumeControls,_AMasterComponent);var _super=VolumeControl_createSuper(VolumeControls);function VolumeControls(mediator,globalDomUtils,templateString,factory){var _this;return classCallCheck_default()(this,VolumeControls),(_this=_super.call(this,mediator,globalDomUtils,templateString,factory))._hoverTimeoutId=null,_this.eventList=[UiComponentEventsEnum[UiComponentEventsEnum.Volume],UiComponentEventsEnum[UiComponentEventsEnum.VolumeHoverStart],UiComponentEventsEnum[UiComponentEventsEnum.VolumeHoverStopped],UiComponentEventsEnum[UiComponentEventsEnum.DraggingStopped],UiComponentEventsEnum[UiComponentEventsEnum.DraggingStart],UiComponentEventsEnum[UiComponentEventsEnum.HoverStart],UiComponentEventsEnum[UiComponentEventsEnum.HoverEnd],UiComponentEventsEnum[UiComponentEventsEnum.StateChanged]],_this._minVolumeCache=.2,_this._volumeCloseTimeout=600,_this._inDrag=!1,_this._onStartHover=function(event){clearTimeout(_this._hoverTimeoutId),Object(DomUtils.a)(_this._$container,"cnx-mod-hover"),_this.mediator.publish(assertThisInitialized_default()(_this),UiComponentEventsEnum[UiComponentEventsEnum.VolumeHoverStart])},_this._onEndHover=function(){_this._inDrag||(null!==_this._hoverTimeoutId&&clearTimeout(_this._hoverTimeoutId),_this._hoverTimeoutId=setTimeout(function(){Object(DomUtils.L)(_this._$container,"cnx-mod-hover"),_this.mediator.publish(assertThisInitialized_default()(_this),UiComponentEventsEnum[UiComponentEventsEnum.VolumeHoverStopped])},_this._volumeCloseTimeout))},_this._volumeCache=_this._minVolumeCache,_this._volumeButton=_this.getComponent(UiComponentsEnum.VolumeButton),_this._volumeProgress=_this.getComponent(UiComponentsEnum.VolumeProgress),_this}return createClass_default()(VolumeControls,[{key:"handleComponentEvent",value:function(eventName,eventData,component){var volume;switch(eventName){case UiComponentEventsEnum[UiComponentEventsEnum.Volume]:volume=eventData.payload/100,this._setVolumeCache(volume),this._setVolumeButton(eventData.payload);break;case UiComponentEventsEnum[UiComponentEventsEnum.Mute]:volume=0,this.setVolumeProgress(0);break;case UiComponentEventsEnum[UiComponentEventsEnum.Unmute]:volume=this._volumeCache,this.setVolumeProgress(100*this._volumeCache);break;case UiComponentEventsEnum[UiComponentEventsEnum.DraggingStopped]:this._inDrag=!1,this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.DraggingStopped]),this._onEndHover();break;case UiComponentEventsEnum[UiComponentEventsEnum.DraggingStart]:this._inDrag=!0,this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.DraggingStart]);break;case UiComponentEventsEnum[UiComponentEventsEnum.HoverStart]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.HoverStart],{payload:{targetComponent:component}});break;case UiComponentEventsEnum[UiComponentEventsEnum.HoverEnd]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.HoverEnd],{payload:{targetComponent:component}});break;case UiComponentEventsEnum[UiComponentEventsEnum.StateChanged]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.StateChanged],{payload:{targetComponent:component}})}void 0!==volume&&this._sendVolume(volume)}},{key:"_setVolumeCache",value:function(volume){volume<this._minVolumeCache?this._volumeCache=this._minVolumeCache:this._volumeCache=volume}},{key:"_sendVolume",value:function(volume){this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Volume],{payload:volume})}},{key:"_setVolumeButton",value:function(percentage){0===percentage?this._volumeButton.setState(VolumeButtonStates.Mute):this._volumeButton.setState(VolumeButtonStates.Unmute)}},{key:"setVolumeProgress",value:function(percentage){this._volumeProgress.setProgress(percentage)}},{key:"initComponent",value:function(){get_default()(getPrototypeOf_default()(VolumeControls.prototype),"initComponent",this).call(this),this._$container.addEventListener("mouseenter",this._onStartHover),this._$container.addEventListener("mouseleave",this._onEndHover)}},{key:"setVolume",value:function(volume){var percentage=100*volume;this._setVolumeButton(percentage),this.setVolumeProgress(percentage)}},{key:"destroy",value:function(){get_default()(getPrototypeOf_default()(VolumeControls.prototype),"destroy",this).call(this),this._$container.removeEventListener("mouseenter",this._onStartHover),this._$container.removeEventListener("mouseleave",this._onEndHover)}}]),VolumeControls}(AMasterComponent_AMasterComponent),VolumeControlTemplate='\n    <cnx class="cnx-volume-container">\n        <cnx class="cnx-ui-btn cnx-volume-btn">\n            [['.concat(UiComponentsEnum.VolumeButton,']]\n        </cnx>\n        <cnx class="cnx-volume-bar">\n            [[').concat(UiComponentsEnum.VolumeProgress,"]]\n        </cnx>\n    </cnx>\n").trim(),cast=__webpack_require__(192),cast_default=__webpack_require__.n(cast),share=__webpack_require__(193),share_default=__webpack_require__.n(share),Config_ElementsGeneralComponentsConfig=(_ElementsGeneralCompo={},defineProperty_default()(_ElementsGeneralCompo,UiComponentsEnum[UiComponentsEnum.ShareButton],{template:getGeneralButtonTemplate(UiComponentsEnum.ShareButton,share_default.a),tooltip:"Share",isHoverable:!0}),defineProperty_default()(_ElementsGeneralCompo,UiComponentsEnum[UiComponentsEnum.CastButton],{template:getGeneralButtonTemplate(UiComponentsEnum.CastButton,cast_default.a),tooltip:"Cast",isHoverable:!0}),_ElementsGeneralCompo),volumeButtonTemplate=__webpack_require__(194),volumeButtonTemplate_default=__webpack_require__.n(volumeButtonTemplate),broadcast_live_icon=__webpack_require__(195),broadcast_live_icon_default=__webpack_require__.n(broadcast_live_icon),broadcast_finished_live_icon=__webpack_require__(196),broadcast_finished_live_icon_default=__webpack_require__.n(broadcast_finished_live_icon);function LivePoster_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var HOUR_CUTOFF=90*TimeConfig.g,LivePoster_LivePoster=function(_ABaseComponent){inherits_default()(LivePoster,_ABaseComponent);var _super=LivePoster_createSuper(LivePoster);function LivePoster(){var _this;return classCallCheck_default()(this,LivePoster),(_this=_super.apply(this,arguments)).eventList=[],_this._repaintInterval=null,_this}return createClass_default()(LivePoster,[{key:"initComponent",value:function(){this._$img=this._globalDomUtils.createElementByString("<img/>"),this._$container.appendChild(this._$img),this._$message=this._$container.getElementsByTagName("cnx-span")[0],this._$messageWrapper=this._$container.getElementsByClassName("cnx-live-message")[0],this._$streamIcon=this._$container.getElementsByClassName("cnx-live-icon")[0]}},{key:"setPosterSrc",value:function(posterURL){Object(TypeUtils.h)(posterURL)&&(this._$img.src=posterURL)}},{key:"setPosterAltText",value:function(altText){this._$img.alt=altText}},{key:"setIconToStarting",value:function(){this._$streamIcon.innerHTML="".concat(broadcast_live_icon_default.a)}},{key:"setIconToEnded",value:function(){this._$streamIcon.innerHTML="".concat(broadcast_finished_live_icon_default.a)}},{key:"setMessageToStarting",value:function(){this._setMessage("This live stream will start shortly")}},{key:"setMessageToEnded",value:function(){this._setMessage("This live stream is not currently available. Please check again shortly")}},{key:"setMessageToNotSupported",value:function(){this._setMessage("Live stream not supported by browser")}},{key:"handleDelayedStart",value:function(startDate){var _this2=this;Object(TypeUtils.e)(Date.parse(startDate))&&(this._streamStartTime=new Date(startDate),this._getSecondsUntilStart()>0&&(this._refreshTimeUntilStart(),clearInterval(this._repaintInterval),this._repaintInterval=setInterval(function(){_this2._refreshTimeUntilStart()},TimeConfig.f*TimeConfig.g)))}},{key:"showMessage",value:function(){Object(DomUtils.R)(this._$streamIcon),Object(DomUtils.R)(this._$messageWrapper)}},{key:"hideMessage",value:function(){Object(DomUtils.v)(this._$streamIcon),Object(DomUtils.v)(this._$messageWrapper)}},{key:"show",value:function(){Object(DomUtils.R)(this._$container),Object(DomUtils.a)(this._$container,CssClassesConfig.h.Active)}},{key:"hide",value:function(){Object(DomUtils.L)(this._$container,CssClassesConfig.h.Active),Object(DomUtils.v)(this._$container)}},{key:"destroy",value:function(){get_default()(getPrototypeOf_default()(LivePoster.prototype),"destroy",this).call(this),clearInterval(this._repaintInterval)}},{key:"_refreshTimeUntilStart",value:function(){var secToStreamStart=this._getSecondsUntilStart();if(secToStreamStart>0){var remainingTimeText=this._getRemainingTimeTextFromSeconds(secToStreamStart);this._setMessage("Live in ".concat(remainingTimeText))}else this._setMessage("This live stream will start shortly"),clearInterval(this._repaintInterval),this._repaintInterval=null}},{key:"_getSecondsUntilStart",value:function(){return(Math.max(this._streamStartTime.getTime(),Date.now())-Date.now())/TimeConfig.f}},{key:"_getRemainingTimeTextFromSeconds",value:function(remainingSeconds){var remainingTime=remainingSeconds>=HOUR_CUTOFF?Math.round(remainingSeconds/(TimeConfig.g*TimeConfig.c)):Math.ceil(remainingSeconds/TimeConfig.g),timeIndicator=remainingSeconds>=HOUR_CUTOFF?"hours":"minute".concat(1===remainingTime?"":"s");return"".concat(remainingTime," ").concat(timeIndicator)}},{key:"_setMessage",value:function(message){this._$message.innerHTML=message}}]),LivePoster}(ABaseComponent_ABaseComponent),livePosterTemplate=__webpack_require__(197),livePosterTemplate_default=__webpack_require__.n(livePosterTemplate);function LiveIcon_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var LiveIcon_LiveIcon=function(_ABaseComponent){inherits_default()(LiveIcon,_ABaseComponent);var _super=LiveIcon_createSuper(LiveIcon);function LiveIcon(){var _this;return classCallCheck_default()(this,LiveIcon),(_this=_super.apply(this,arguments)).eventList=[],_this}return createClass_default()(LiveIcon,[{key:"initComponent",value:function(){this.hideComponent()}}]),LiveIcon}(ABaseComponent_ABaseComponent),liveIconTemplate=__webpack_require__(198),liveIconTemplate_default=__webpack_require__.n(liveIconTemplate);function UiElementsComponentFactory_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var CSSClassAd,UiElementsComponentFactory_UiElementsComponentFactory=function(_AUiBaseComponentFact){inherits_default()(UiElementsComponentFactory,_AUiBaseComponentFact);var _super=UiElementsComponentFactory_createSuper(UiElementsComponentFactory);function UiElementsComponentFactory(_globalDomUtils,interactionService,_$container,_settings,_currentBreakpointClass){var _this$_createComponen,_this;return classCallCheck_default()(this,UiElementsComponentFactory),(_this=_super.call(this,_globalDomUtils,interactionService,_$container,_settings,Config_ElementsGeneralComponentsConfig))._globalDomUtils=_globalDomUtils,_this._$container=_$container,_this._settings=_settings,_this._currentBreakpointClass=_currentBreakpointClass,_this._createComponentActions=(_this$_createComponen={},defineProperty_default()(_this$_createComponen,UiComponentsEnum.VolumeControls,function(componentMediator){return new VolumeControl_VolumeControls(componentMediator,_this._globalDomUtils,VolumeControlTemplate,assertThisInitialized_default()(_this))}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.VolumeButton,function(componentMediator){return new VolumeButton_VolumeButton(componentMediator,_this._globalDomUtils,_this._interactionService,volumeButtonTemplate_default.a,VolumeButtonStates.Mute,_this._settings.isMobile)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.SettingsButton,function(componentMediator){return new SettingsButton_SettingsButton(componentMediator,_this._globalDomUtils,_this._interactionService,settingsButtonTemplate_default.a,_this._settings.isMobile)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.CaptionButton,function(componentMediator){return new CaptionButton_CaptionButton(componentMediator,_this._globalDomUtils,_this._interactionService,captionButtonTemplate_default.a,CssClassesConfig.h.Active,_this._settings.closedCaptionDefault,_this._settings.isMobile)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.UpNextBox,function(componentMediator){return new UpNextBox_UpNextBox(componentMediator,_this._globalDomUtils,_this._interactionService,upNextCardTemplate_default.a,_this._settings.isMobile)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.LogoComponent,function(componentMediator){if(!Object(TypeUtils.a)(_this._settings.logoUrl)&&!Object(TypeUtils.a)(_this._settings.logoPosition))throw new Error("custom logo is undefined");return new LogoComponent_LogoComponent(componentMediator,_this._globalDomUtils,_this._interactionService,'<cnx class="cnx-logo"></cnx>',{logoUrl:_this._settings.logoUrl,logoPosition:_this._settings.logoPosition})}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.LogoOutstream,function(componentMediator){if(!Object(TypeUtils.a)(_this._settings.logoUrl)&&!Object(TypeUtils.a)(_this._settings.logoPosition))throw new Error("outstream logo undefined");return new LogoOutstream_LogoOutstream(componentMediator,_this._globalDomUtils,_this._interactionService,'<img class="cnx-home-screen-logo" />',{logoUrl:_this._settings.logoUrl})}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.LivePoster,function(componentMediator){return new LivePoster_LivePoster(componentMediator,_this._globalDomUtils,_this._interactionService,livePosterTemplate_default.a)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.LiveIcon,function(componentMediator){return new LiveIcon_LiveIcon(componentMediator,_this._globalDomUtils,_this._interactionService,liveIconTemplate_default.a)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.ElapsedTimeLabel,function(componentMediator){return new TimeLabel_TimeLabel(componentMediator,_this._globalDomUtils,_this._interactionService,timeLabelTemplate_default.a)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.TotalDurationLabel,function(componentMediator){return new TimeLabel_TimeLabel(componentMediator,_this._globalDomUtils,_this._interactionService,timeLabelTemplate_default.a)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.ProgressBar,function(componentMediator){return new ProgressBar_ProgressBar(componentMediator,_this._globalDomUtils,_this._interactionService,draggableProgressBarTemplate_default.a,_this._settings.isMobile)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.QueStateOverlay,function(componentMediator){return new QueStateOverlay_QueStateOverlay(componentMediator,_this._globalDomUtils,_this._interactionService,loaderTemplate_default.a)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.ContextMenu,function(componentMediator){return new ContextMenu_ContextMenu(componentMediator,_this._globalDomUtils,_this._interactionService,contextMenuTemplate_default.a,UiComponentEventsEnum[UiComponentEventsEnum.ContextClick],UiComponentsEnum.ContextMenu,_this._$container,_this._settings.isMobile)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.ElementsSettingsMenu,function(componentMediator){return new ElementsSettingsMenu_ElementsSettingsMenu(componentMediator,_this._globalDomUtils,_this._interactionService,settingsMenuTemplate_default.a,UiComponentEventsEnum[UiComponentEventsEnum.SettingsMenu],UiComponentsEnum.ElementsSettingsMenu,_this._$container,_this._currentBreakpointClass,_this._settings.isMobile,_this._settings.closedCaptionDefault)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.CaptionComponent,function(componentMediator){return new CaptionComponent_CaptionComponent(componentMediator,_this._globalDomUtils,_this._interactionService,captionTemplate_default.a)}),_this$_createComponen),_this._getCreateComponentAction=function(componentName){return function(componentMediator){var createComponent=_this._createComponentActions[componentName];if(createComponent)return createComponent(componentMediator)}},_this}return createClass_default()(UiElementsComponentFactory,[{key:"createComponent",value:function(componentName,componentMediator){var createComponent=this._getCreateComponentAction(componentName);return createComponent(componentMediator)||get_default()(getPrototypeOf_default()(UiElementsComponentFactory.prototype),"createComponent",this).call(this,componentName,componentMediator)}}]),UiElementsComponentFactory}(AUiBaseComponentFactory_AUiBaseComponentFactory);function UiAd_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}!function(CSSClassAd){CSSClassAd.InPod="cnx-ad-in-pod",CSSClassAd.AdMarkerInPodTextContainer="cnx-ad-marker-text",CSSClassAd.CardImage="cnx-ad-card-image",CSSClassAd.CardTitle="cnx-ad-card-title",CSSClassAd.AdUiContent="cnx-ui-ad-content"}(CSSClassAd||(CSSClassAd={}));var UiAd_UiAd=function(_AUiVideoBase){inherits_default()(UiAd,_AUiVideoBase);var _super=UiAd_createSuper(UiAd);function UiAd(mediator,globalDomUtilsService,_viewabilityService,interactionService,$container,templateString){var _this$_states,_this,settings=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},componentsFactory=arguments.length>7?arguments[7]:void 0;return classCallCheck_default()(this,UiAd),(_this=_super.call(this,mediator,$container,globalDomUtilsService,templateString,componentsFactory||new UiElementsComponentFactory_UiElementsComponentFactory(globalDomUtilsService,interactionService,$container,settings))).mediator=mediator,_this.globalDomUtilsService=globalDomUtilsService,_this._viewabilityService=_viewabilityService,_this.$container=$container,_this.settings=settings,_this._states=(_this$_states={},defineProperty_default()(_this$_states,ContentStatesEnum.PlayingState,new AdStatePlaying_AdStatePlaying(assertThisInitialized_default()(_this))),defineProperty_default()(_this$_states,ContentStatesEnum.PausedState,new AdStatePaused_AdStatePaused(assertThisInitialized_default()(_this))),_this$_states),_this._elapsedTime=0,_this._requestAnimationFrameId=null,_this._onViewabilityCallback=function(inView){Object(DomUtils.U)(_this.$uiContainer,CssClassesConfig.g.UiInView,inView)},_this._tooltipHandler.setDistanceValues({top:4,bottom:4}),_this._states[ContentStatesEnum.PausedState].enterState(),_this._$cardImage=_this.$container.querySelector(".".concat(CSSClassAd.CardImage)),_this._$cardTitle=_this.$container.querySelector(".".concat(CSSClassAd.CardTitle)),_this._$adUiContent=_this.$container.querySelector(".".concat(CSSClassAd.AdUiContent)),_this}return createClass_default()(UiAd,[{key:"handleComponentEvent",value:function(eventName,eventData,component){switch(get_default()(getPrototypeOf_default()(UiAd.prototype),"handleComponentEvent",this).call(this,eventName,eventData,component),eventName){case UiComponentEventsEnum[UiComponentEventsEnum.Volume]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Volume],eventData);break;case UiComponentEventsEnum[UiComponentEventsEnum.Mute]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Mute]);break;case UiComponentEventsEnum[UiComponentEventsEnum.Unmute]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Unmute]);break;case UiComponentsEnum[UiComponentsEnum.CloseButton]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Close]);break;case UiComponentEventsEnum[UiComponentEventsEnum.Expand]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Expand]);break;case UiComponentEventsEnum[UiComponentEventsEnum.Collapse]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Collapse]);break;default:this.mediator.publish(this,eventName,eventData)}}},{key:"updateDuration",value:function(duration){var progressBar=this.getComponent(UiComponentsEnum.ProgressBar),durationLabel=this.getComponent(UiComponentsEnum.TotalDurationLabel),skipAdButton=this.getComponent(UiComponentsEnum.SkipAdButton);!duration&&skipAdButton&&(skipAdButton.setSecondsUntilSkip(0),skipAdButton.tickDown(0)),duration||!progressBar?(this.elapsedTime=0,this.duration=duration,progressBar&&progressBar.setProgress(Object(NumberUtils.g)(0,duration,0,100,0)),durationLabel&&durationLabel.setTime(duration),this._updateElapseTime(this._elapsedTime)):progressBar.setProgress(100)}},{key:"updateVolume",value:function(volume){var volumeControls=this.getComponent(UiComponentsEnum.VolumeControls),volumeButton=this.getComponent(UiComponentsEnum.VolumeButton);volumeControls&&volumeControls.setVolume(volume),volumeButton&&volumeButton.setVolume(volume)}},{key:"showSkipAdButton",value:function(skipAdAfter){var skipAdButton=this.getComponent(UiComponentsEnum.SkipAdButton);skipAdButton&&(skipAdButton.showComponent(),skipAdButton.setSecondsUntilSkip(skipAdAfter))}},{key:"hideSkipAdButton",value:function(){var skipAdButton=this.getComponent(UiComponentsEnum.SkipAdButton);skipAdButton&&skipAdButton.hideComponent()}},{key:"addPodAdMarker",value:function(currentSlot,totalSlots){Object(DomUtils.a)(this.$uiContainer,CSSClassAd.InPod),Object(ArrayUtils.c)(this.$uiContainer.getElementsByClassName(CSSClassAd.AdMarkerInPodTextContainer)).forEach(function(element){element.innerHTML="".concat(currentSlot+1,"/").concat(totalSlots)})}},{key:"removeAddPodAdMarker",value:function(){Object(DomUtils.L)(this.$uiContainer,CSSClassAd.InPod)}},{key:"_updateElapseTime",value:function(elapsedTime){var elapsedTimeLabel=this.getComponent(UiComponentsEnum.ElapsedTimeLabel);elapsedTimeLabel&&elapsedTimeLabel.setTime(elapsedTime);var skipAdButton=this.getComponent(UiComponentsEnum.SkipAdButton);skipAdButton&&skipAdButton.tickDown(elapsedTime)}},{key:"hideAdLoadingScreen",value:function(){var adLoadingScreen=this.getComponent(UiComponentsEnum.AdLoadingScreen);adLoadingScreen&&adLoadingScreen.hideComponent(),Object(DomUtils.L)(this.$container,CssClassesConfig.g.PodLoadingScreen)}},{key:"showAdLoadingScreen",value:function(backgroundUrl,clickThroughUrl,currentAdIndex,nrOfSlotsInBreak){var adLoadingScreen=this.getComponent(UiComponentsEnum.AdLoadingScreen);adLoadingScreen&&(adLoadingScreen.showComponent(),adLoadingScreen.setBackgroundImg(backgroundUrl),adLoadingScreen.setClickUrl(clickThroughUrl),adLoadingScreen.setFallbackText(currentAdIndex,nrOfSlotsInBreak),Object(DomUtils.a)(this.$container,CssClassesConfig.g.PodLoadingScreen))}},{key:"hideAdMarker",value:function(){var adMarker=this.$container.querySelector(".cnx-ad-marker");Object(DomUtils.v)(adMarker)}},{key:"hideProgressBar",value:function(){this.getComponent(UiComponentsEnum.ProgressBar).hideComponent()}},{key:"setContinueReadingCard",value:function(cardMetadata){this._$cardImage.style.backgroundImage='url("'.concat(cardMetadata.imageSrc,'")'),this._$cardTitle.innerHTML=cardMetadata.title}},{key:"cardHasData",value:function(){return Object(TypeUtils.h)(this._$cardImage.style.backgroundImage)&&Object(TypeUtils.h)(this._$cardTitle.innerHTML)}},{key:"showContinueReadingCard",value:function(adContainer){var _this2=this;Object(DomUtils.a)(this.$container,CssClassesConfig.g.AdShowCard),null===this._requestAnimationFrameId&&(this._requestAnimationFrameId=this.globalDomUtilsService.requestAnimationFrameHelper(function(){_this2._requestAnimationFrameId=null,Object(DomUtils.Q)(adContainer,{height:"".concat(_this2._$adUiContent.clientHeight,"px")})}))}},{key:"hideContinueReadingCard",value:function(adContainer){Object(DomUtils.L)(this.$container,CssClassesConfig.g.AdShowCard),Object(DomUtils.N)(adContainer,"height")}},{key:"show",value:function(){get_default()(getPrototypeOf_default()(UiAd.prototype),"show",this).call(this),this._viewabilityService.on(this.$uiContainer,this._onViewabilityCallback,{threshold:.5})}},{key:"hide",value:function(){get_default()(getPrototypeOf_default()(UiAd.prototype),"hide",this).call(this);Object(DomUtils.U)(this.$uiContainer,CssClassesConfig.g.UiInView,!1),this._viewabilityService.off(this.$uiContainer,this._onViewabilityCallback)}},{key:"expand",value:function(){this.getComponent(UiComponentsEnum.ExpandButton).setState(ExpandButtonStatesEnum.expand)}},{key:"collapse",value:function(){this.getComponent(UiComponentsEnum.ExpandButton).setState(ExpandButtonStatesEnum.collapse)}},{key:"elapsedTime",get:function(){return this._elapsedTime},set:function(time){this._elapsedTime=time,this._updateElapseTime(this._elapsedTime)}}]),UiAd}(AUiVideoBase_AUiVideoBase),adSign=__webpack_require__(199),adSign_default=__webpack_require__.n(adSign),AdTemplate_AdTemplate=function(){function AdTemplate(showExpandButton){classCallCheck_default()(this,AdTemplate),this.showExpandButton=showExpandButton}return createClass_default()(AdTemplate,[{key:"getExpandTemplate",value:function(){return this.showExpandButton?'<cnx class="cnx-ad-expand-button cnx-ui-btn cnx-hide-on-volume-hover cnx-d-sm-none">[['.concat(UiComponentsEnum.ExpandButton,"]]</cnx>"):""}},{key:"template",get:function(){return'\n            <cnx class="cnx-ui cnx-ui-ad">\n                <cnx class="cnx-ui-ad-content '.concat(this.showExpandButton?"cnx-ad-fs":"",'">\n                    <cnx class="cnx-ad-marker">\n                        <cnx class="cnx-ad-marker-svg">').concat(adSign_default.a,'</cnx>\n                        <cnx class="cnx-ad-marker-text">1/1</cnx>\n                    </cnx>\n                    <cnx class="cnx-ad-close-button cnx-ui-btn">[[').concat(UiComponentsEnum.CloseButton,']]</cnx>\n                    <cnx class="cnx-ad-buttons">\n                        <cnx class="cnx-ad-play-button cnx-ui-btn">[[').concat(UiComponentsEnum.PlayButton,']]</cnx>\n                        <cnx class="cnx-ad-volume-controls">[[').concat(UiComponentsEnum.VolumeControls,']]</cnx>\n                        <cnx class="cnx-ad-volume-button cnx-ui-btn">[[').concat(UiComponentsEnum.VolumeButton,"]]</cnx>\n                    </cnx>\n                    [[").concat(UiComponentsEnum.SkipAdButton,"]]\n                    ").concat(this.getExpandTemplate(),'\n                    <cnx class="cnx-ad-progress-bar">[[').concat(UiComponentsEnum.ProgressBar,']]</cnx>\n                </cnx>\n                <cnx class="cnx-ad-card">\n                    <svg class="').concat(CSSClassAd.CardImage,'" viewBox="0 0 16 9" />\n                    <cnx class="cnx-ad-card-text">\n                        <cnx>Continue watching</cnx>\n                        <cnx class="').concat(CSSClassAd.CardTitle,'"></cnx>\n                        <cnx>after the ad</cnx>\n                    </cnx>\n                </cnx>\n                [[').concat(UiComponentsEnum.AdLoadingScreen,"]]\n            </cnx>\n        ").trim()}}]),AdTemplate}(),HrefUtils=__webpack_require__(26);function getBaseUISettings(playerModel,appConfig){return{logoUrl:playerModel.logoUrl,isMobile:appConfig.isMobile,closeButtonMode:playerModel.closeButtonMode,floatingCloseButtonMode:playerModel.floatingSettings.floatingCloseButtonMode,isCloseButton:playerModel.isCloseButton,uiComponentsVisibility:playerModel.uiComponentsVisibility,sharingDestinations:playerModel.sharingDestinations}}function AdHandler_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var _PrebidBiddersVendorM,PrebidBiddersEnum,AdHandler_AdHandler=function(_Mediator){inherits_default()(AdHandler,_Mediator);var _super=AdHandler_createSuper(AdHandler);function AdHandler(mediator,_playerSettings,_parentContainer,_currentPlayerViewability,_adBreakHelper,_app,_urlSuffixerService){var _this;return classCallCheck_default()(this,AdHandler),(_this=_super.call(this)).mediator=mediator,_this._playerSettings=_playerSettings,_this._parentContainer=_parentContainer,_this._currentPlayerViewability=_currentPlayerViewability,_this._adBreakHelper=_adBreakHelper,_this._app=_app,_this._urlSuffixerService=_urlSuffixerService,_this._adSlotList=[],_this.firstAdShown=!1,_this._inImpression=!1,_this._currentVolume=0,_this._enableVpaidEventsPropagation=!0,_this._skipButtonAllowed=!1,_this._inAdPodLoadingState=!1,_this._vastViewMode=VastConfig.a.Normal,_this._adManager=_this.getNewAdManager(),_this.subscribe(AdManagerEvents.AdsEnabled,_this._adManager,function(){_this.mediator.publish(assertThisInitialized_default()(_this),AdManagerEvents.AdsEnabled)}),_this}return createClass_default()(AdHandler,[{key:"_initAdManager",value:function(width,height,volume){this._adManager.initAd(width,height,this._vastViewMode,1,volume,[{container:this._adContainer,width:width,height:height,type:protos.ProtoAdType.Video}])}},{key:"_showSkipButton",value:function(){this._adUserInterface.showSkipAdButton(this._playerSettings.skipAdAfter)}},{key:"_trackAdClicks",value:function(event){var trackingProperties=this._adManager.getCurrentAdClickTrackingProperties();trackingProperties&&this._app.services.TrackingService.trackAdClick(Object.assign(Object.assign({},trackingProperties),{type:event}))}},{key:"_canShowSkipButton",value:function(adData){if(adData.payload.adLoadedData.skipOffset&&adData.payload.adLoadedData.skipOffset>=0)return!1;var adDuration=this._adManager.getAdDuration();switch(this._playerSettings.adSkippability){case protos.ProtoPlayerAdSkippability.IfLongerThan:if(adData.payload.adSkipMode===protos.ProtoAdSkipMode.IfLongerThan31Sec&&(adDuration<this._playerSettings.adsMustBeSkippableIfLongerThan||!adDuration)||adData.payload.adSkipMode===protos.ProtoAdSkipMode.Never)return!1;break;case protos.ProtoPlayerAdSkippability.NoRestrictions:if(adData.payload.adSkipMode===protos.ProtoAdSkipMode.Never||adData.payload.adSkipMode===protos.ProtoAdSkipMode.IfLongerThan31Sec&&(adDuration<MonetizationConfig.d||!adDuration))return!1}return!0}},{key:"_activateAdSlotContainer",value:function(selectedAdSlotContainer){this._adSlotList.filter(function(currentAdSlot){return currentAdSlot!==selectedAdSlotContainer}).forEach(function(currentAdSlot){Object(DomUtils.a)(currentAdSlot,CssClassesConfig.h.Hide)})}},{key:"_resetVisibilityAdSlotContainers",value:function(){this._adSlotList.forEach(function(currentAdSlot){Object(DomUtils.L)(currentAdSlot,CssClassesConfig.h.Hide)})}},{key:"updateFilterConfig",value:function(mediaRestrictions){this._adManager.updateFilterConfig(mediaRestrictions)}},{key:"_exitAdPodLoadingState",value:function(){this._inAdPodLoadingState=!1,this._adUserInterface.hideAdLoadingScreen()}},{key:"_hideSkipButton",value:function(){this._adUserInterface.hideSkipAdButton()}},{key:"_subscribeToEvents",value:function(){var adEnded,_this2=this;Object.keys(VastConfig.b).forEach(function(key){_this2.subscribe(VastConfig.b[key],_this2._adManager,function(data){switch(adEnded=!1,VastConfig.b[key]){case VastConfig.b.AdLoaded:var loadedData=data;_this2._skipButtonAllowed=_this2._canShowSkipButton(data),_this2._skipButtonAllowed&&(loadedData.payload.adLoadedData.skipOffset=_this2._playerSettings.skipAdAfter);break;case VastConfig.b.AdPaused:_this2._adUserInterface.changeState(ContentStatesEnum.PausedState);break;case VastConfig.b.AdPlaying:_this2._adUserInterface.changeState(ContentStatesEnum.PlayingState);break;case VastConfig.b.AdImpression:_this2._handleImpression(data);break;case VastConfig.b.AdSkipped:_this2._trackAdClicks(protos.ProtoAdClickTypeEnum.AdSkipClick),_this2._resetVisibilityAdSlotContainers(),adEnded=!0;break;case VastConfig.b.AdStopped:case VastConfig.b.AdError:_this2._resetVisibilityAdSlotContainers(),adEnded=!0;break;case VastConfig.b.AdClickThru:_this2._trackAdClicks(protos.ProtoAdClickTypeEnum.AdClickThrough)}_this2._enableVpaidEventsPropagation&&_this2.mediator.publish(_this2,VastConfig.b[key],data),_this2._enableVpaidEventsPropagation=!0,adEnded&&(_this2._inImpression=!1,_this2._adUserInterface.changeState(ContentStatesEnum.PausedState))})}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Volume],this._adUserInterface,function(_ref){var volume=_ref.payload;_this2.setVolume(volume),_this2._trackAdClicks(protos.ProtoAdClickTypeEnum.VolumeClick)}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Play],this._adUserInterface,function(){_this2._trackAdClicks(protos.ProtoAdClickTypeEnum.PlayClick),_this2.play()}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Pause],this._adUserInterface,function(){_this2._trackAdClicks(protos.ProtoAdClickTypeEnum.PauseClick),_this2.pause()}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Close],this._adUserInterface,function(){_this2.mediator.publish(_this2,ExperienceConfig.b.UserInteraction,{payload:{playback:!1}}),_this2.mediator.publish(_this2,UiComponentEventsEnum[UiComponentEventsEnum.Close])}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Mute],this._adUserInterface,function(){_this2.setVolume(0),_this2._trackAdClicks(protos.ProtoAdClickTypeEnum.MuteClick)}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Unmute],this._adUserInterface,function(){_this2.setVolume(1),_this2._trackAdClicks(protos.ProtoAdClickTypeEnum.UnmuteClick)}),this.subscribe(AdManagerEvents.DetachedFromDom,this._adManager,function(){_this2.mediator.publish(_this2,AdHandlerEventsEnum_DetachedFromDom)}),this.relay(ApiConfig.b.ImpressionPrice,this._adManager,this,this.mediator),this.relay(ApiConfig.b.ImpressionRevenue,this._adManager,this,this.mediator)}},{key:"_handleImpression",value:function(data){this._hideSkipButton(),this.updateContinueReadingCard(),data.payload.adDuration=this._adManager.getAdDuration(),data.payload.adDuration||this.firstAdShown||this.show(),this.firstAdShown=!0,this._inImpression=!0,this._skipButtonAllowed&&this._showSkipButton(),this._adUserInterface.updateDuration(data.payload.adDuration),this._adUserInterface.changeState(ContentStatesEnum.PlayingState),this._clickThroughUrl=data.payload.clickThroughUrl,this._activateAdSlotContainer(data.payload.selectedAdSlot),this._adBreakHelper.getTotalNumberOfSlots()>1?this._adUserInterface.addPodAdMarker(this._adBreakHelper.getCurrentSlotIndex(),this._adBreakHelper.getTotalNumberOfSlots()):this._adUserInterface.removeAddPodAdMarker()}},{key:"_addAdSlot",value:function(element){this._parentContainer.appendChild(element)}},{key:"_createAdSlot",value:function(){var customClass=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._app.services.GlobalDomUtilsService.createElementByString('<div class= "cnx-ad-container cnx-full-height '.concat(customClass,'"></div>'))}},{key:"_initAdSlots",value:function(){this._adContainer=this._createAdSlot(),this._addAdSlot(this._adContainer),this._adSlotList.push(this._adContainer)}},{key:"_initAdInterface",value:function(){var showExpandButton=arguments.length>0&&void 0!==arguments[0]&&arguments[0],settings=getBaseUISettings(this._playerSettings,this._app.config);this._adUserInterface=new UiAd_UiAd(this,this._app.services.GlobalDomUtilsService,this._app.services.ViewabilityService,this._app.services.InteractionService,this._parentContainer,new AdTemplate_AdTemplate(showExpandButton).template,settings),this._adUserInterface.hide()}},{key:"start",value:function(width,height,volume){var showExpandButton=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{this._initAdInterface(showExpandButton),this._initAdSlots(),this._initAdManager(width,height,volume),this.setVolume(volume),this._subscribeToEvents()}catch(e){Object(Logging.a)({callStack:e.stack,level:protos.ProtoLoggingLevelEnum.FATAL,exception:e.message,message:"adhandler_start"})}}},{key:"getVolume",value:function(){return this._currentVolume}},{key:"hide",value:function(){Object(DomUtils.L)(this._parentContainer,CssClassesConfig.g.Ad,CssClassesConfig.g.AdOverlayType),this._adUserInterface.hide()}},{key:"show",value:function(){var cssClass=[CssClassesConfig.g.Ad],currentAdType=this._adManager.getCurrentAdType();currentAdType===protos.ProtoAdType.Overlay&&cssClass.push(CssClassesConfig.g.AdOverlayType),this._lastAdType=currentAdType,DomUtils.a.apply(void 0,[this._parentContainer].concat(cssClass)),this._adUserInterface.show(),this._adUserInterface.updateVolume(this._currentVolume),this._exitAdPodLoadingState()}},{key:"getAdContainerWidth",value:function(){return this._adManager.getAdContainerWidth()}},{key:"setVolume",value:function(volume){this._currentVolume=volume,this._adManager.setAdVolume(volume),this._adUserInterface&&this._adUserInterface.updateVolume(volume),this.mediator.publish(this,ExperienceConfig.b.UserInteraction,{payload:{volume:!0}}),this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Volume],{payload:{volume:volume}})}},{key:"resizeAd",value:function(width,height,viewMode){this.setVastViewMode(viewMode),this.updateContinueReadingCard(),this.mediator.publish(this,AdHandlerEventsEnum_AdSlotResized,{payload:{width:width,height:height}})}},{key:"adStateChange",value:function(adState,maxAdSlotDuration){this._adManager.onAdStateChange(adState,maxAdSlotDuration)}},{key:"contentChanged",value:function(){this._adManager.onContentChange()}},{key:"resumeWithoutUserInteraction",value:function(){this._adManager.resumeAd(!1)}},{key:"play",value:function(){this._adManager.resumeAd(!0),this.mediator.publish(this,ExperienceConfig.b.UserInteraction,{payload:{playback:!0}})}},{key:"_canShowContinueReadingCard",value:function(adMediaSize){if(Object(HrefUtils.b)("cnxShowAdCard",this._app.config.pageUrl))return!0;var cardHasEnoughSpace=!1;if(adMediaSize.adType===protos.ProtoAdType.Video){var projectedAdHeight=this._parentContainer.clientWidth*(adMediaSize.heightRatio/adMediaSize.widthRatio);cardHasEnoughSpace=this._parentContainer.clientHeight-projectedAdHeight>=76}return adMediaSize.adType===protos.ProtoAdType.Overlay&&(cardHasEnoughSpace=this._parentContainer.clientHeight-adMediaSize.height>=76),cardHasEnoughSpace}},{key:"updateContinueReadingCard",value:function(){var adMediaSize=this._adManager.getAdMediaSize();Object(TypeUtils.a)(adMediaSize)&&(this._canShowContinueReadingCard(this._adManager.getAdMediaSize())?this._adUserInterface.showContinueReadingCard(this._adContainer):this._adUserInterface.hideContinueReadingCard(this._adContainer))}},{key:"setContinueReadingCard",value:function(cardMetadata){this._adUserInterface.setContinueReadingCard({imageSrc:ImageUrlBuilder_ImageUrlBuilder.getSmartCroppedImageUrl(cardMetadata.imageSrc,270,150,this._urlSuffixerService),title:cardMetadata.title})}},{key:"pause",value:function(){this._adManager.pauseAd(!0),this.mediator.publish(this,ExperienceConfig.b.UserInteraction,{payload:{playback:!1}})}},{key:"stopAd",value:function(reason){var _this3=this,handleAdStoppedBubbleUp=function(){_this3.mediator.publish(_this3,VastConfig.b.AdStopped),_this3._enableVpaidEventsPropagation=!1};this._adManager&&this.inImpression?(handleAdStoppedBubbleUp(),this._adManager.stopAd(reason)):this.inAdPodLoadingState&&handleAdStoppedBubbleUp()}},{key:"skipAd",value:function(){this._adManager&&this.inImpression?this._adManager.skipAd():this._inAdPodLoadingState&&(this.mediator.publish(this,VastConfig.b.AdSkipped),this._exitAdPodLoadingState())}},{key:"userInteraction",value:function(playback){this._adManager.userInteraction(playback)}},{key:"enableAds",value:function(){this._adManager.enableAds()}},{key:"enterAdPodLoadingState",value:function(){this._inAdPodLoadingState=!0;var _this$_adManager$getL=this._adManager.getLastAdSlot(this._lastAdType),width=_this$_adManager$getL.width,height=_this$_adManager$getL.height;this._adUserInterface.showAdLoadingScreen(ImageUrlBuilder_ImageUrlBuilder.getSmartCroppedImageUrl(this._adLoadingBackgroundBaseUrl,width,height,this._urlSuffixerService),this._clickThroughUrl,this._adBreakHelper.getNextSlotIndex(),this._adBreakHelper.getTotalNumberOfSlots())}},{key:"setAdLoadingBackgroundUrl",value:function(baseUrl){this._adLoadingBackgroundBaseUrl=baseUrl}},{key:"updatePodRemainingTime",value:function(podRemainingTime){this._adManager.updatePodRemainingTime(podRemainingTime)}},{key:"newAdOpportunity",value:function(){this._adManager.newAdOpportunity()}},{key:"disableAds",value:function(reason){this._adManager.disableAds(reason)}},{key:"setVastViewMode",value:function(vastViewMode){this._vastViewMode=vastViewMode,this._adManager.setVastViewMode(vastViewMode)}},{key:"destroy",value:function(){var _a,_b,_c;null===(_a=this._adManager)||void 0===_a||_a.disableAds(DisableAdsReasonEnum.Unknown),null===(_b=this._adUserInterface)||void 0===_b||_b.destroy(),null===(_c=this._adManager)||void 0===_c||_c.destroy()}},{key:"inImpression",get:function(){return this._inImpression}},{key:"adInWin",get:function(){return this._adManager.adInWin}},{key:"inAdPodLoadingState",get:function(){return this._inAdPodLoadingState}}]),AdHandler}(Mediator.a),UserManagerConfig=__webpack_require__(42);!function(PrebidBiddersEnum){PrebidBiddersEnum.AppNexus="appnexus",PrebidBiddersEnum.DistrictM="districtm",PrebidBiddersEnum.IndexExchange="ix",PrebidBiddersEnum.Lkqd="lkqd",PrebidBiddersEnum.OneVideo="oneVideo",PrebidBiddersEnum.OpenX="openx",PrebidBiddersEnum.Pubmatic="pubmatic",PrebidBiddersEnum.RhythmOne="rhythmone",PrebidBiddersEnum.Rubicon="rubicon",PrebidBiddersEnum.SpotX="spotx",PrebidBiddersEnum.Telaria="telaria",PrebidBiddersEnum.MediaNet="medianet",PrebidBiddersEnum.Adman="adman",PrebidBiddersEnum.IronSource="ironsource",PrebidBiddersEnum.Undertone="undertone",PrebidBiddersEnum.SynacorMedia="synacormedia",PrebidBiddersEnum.AmxRTB="amx",PrebidBiddersEnum.Smaato="smaato",PrebidBiddersEnum.SmartAdServer="smartadserver"}(PrebidBiddersEnum||(PrebidBiddersEnum={}));var PrebidBiddersVendorMapping=(_PrebidBiddersVendorM={},defineProperty_default()(_PrebidBiddersVendorM,PrebidBiddersEnum.Lkqd,UserManagerConfig.c.Lkqd),defineProperty_default()(_PrebidBiddersVendorM,PrebidBiddersEnum.RhythmOne,UserManagerConfig.c.RhythmOne),defineProperty_default()(_PrebidBiddersVendorM,PrebidBiddersEnum.Telaria,UserManagerConfig.c.Telaria),defineProperty_default()(_PrebidBiddersVendorM,PrebidBiddersEnum.IronSource,UserManagerConfig.c.IronSource),defineProperty_default()(_PrebidBiddersVendorM,PrebidBiddersEnum.Undertone,UserManagerConfig.c.Undertone),defineProperty_default()(_PrebidBiddersVendorM,PrebidBiddersEnum.SynacorMedia,UserManagerConfig.c.SynacorMedia),_PrebidBiddersVendorM),PrebidBiddersTCF1SupportList=[PrebidBiddersEnum.AppNexus,PrebidBiddersEnum.DistrictM,PrebidBiddersEnum.IndexExchange,PrebidBiddersEnum.OneVideo,PrebidBiddersEnum.OpenX,PrebidBiddersEnum.Pubmatic,PrebidBiddersEnum.RhythmOne,PrebidBiddersEnum.Rubicon,PrebidBiddersEnum.SpotX,PrebidBiddersEnum.Telaria,PrebidBiddersEnum.MediaNet,PrebidBiddersEnum.Adman,PrebidBiddersEnum.IronSource,PrebidBiddersEnum.Undertone,PrebidBiddersEnum.AmxRTB,PrebidBiddersEnum.Smaato,PrebidBiddersEnum.SmartAdServer],PrebidBiddersTCF2SupportList=[PrebidBiddersEnum.AppNexus,PrebidBiddersEnum.DistrictM,PrebidBiddersEnum.IndexExchange,PrebidBiddersEnum.OneVideo,PrebidBiddersEnum.OpenX,PrebidBiddersEnum.Pubmatic,PrebidBiddersEnum.RhythmOne,PrebidBiddersEnum.Rubicon,PrebidBiddersEnum.SpotX,PrebidBiddersEnum.Telaria,PrebidBiddersEnum.MediaNet,PrebidBiddersEnum.Adman,PrebidBiddersEnum.AmxRTB,PrebidBiddersEnum.Smaato,PrebidBiddersEnum.SmartAdServer],PrebidBiddersCcpaSupportList=[PrebidBiddersEnum.OneVideo,PrebidBiddersEnum.IndexExchange,PrebidBiddersEnum.Rubicon,PrebidBiddersEnum.Pubmatic,PrebidBiddersEnum.SpotX,PrebidBiddersEnum.AppNexus,PrebidBiddersEnum.DistrictM,PrebidBiddersEnum.OpenX,PrebidBiddersEnum.MediaNet,PrebidBiddersEnum.Adman,PrebidBiddersEnum.IronSource,PrebidBiddersEnum.Undertone,PrebidBiddersEnum.SynacorMedia,PrebidBiddersEnum.AmxRTB,PrebidBiddersEnum.Smaato,PrebidBiddersEnum.SmartAdServer],PREBIDJS_VIDEO_MIME_TYPES=["video/mp4","video/webm","application/javascript","video/ogg","video/mpeg"],PREBIDJS_PROTOCOL={VAST_1:1,VAST_2:2,VAST_3:3,VAST_1_WRAPPER:4,VAST_2_WRAPPER:5,VAST_3_WRAPPER:6,VAST_4:7,VAST_4_WRAPPER:8},PREBIDJS_LINEARILITY_LINEAR=1,PREBIDJS_API={VPAID_1:1,VPAID_2:2},BID_PRICE_DECODE_DIVISION_FACTOR=2,BID_PRICE_DECODE_SUBTRACT_FACTOR=41;function decodeObfuscatedBidPrice(obfuscatedPrice){return(obfuscatedPrice+BID_PRICE_DECODE_SUBTRACT_FACTOR)*BID_PRICE_DECODE_DIVISION_FACTOR}function encodeBidPrice(bidPrice){return bidPrice/BID_PRICE_DECODE_DIVISION_FACTOR-BID_PRICE_DECODE_SUBTRACT_FACTOR}var _CreativeTriggerTypeM,_AdCallRejectionReaso,AdCallRejectionReason,BidRequestGatekeeper_AdRequestGatekeeper=function(){function AdRequestGatekeeper(){classCallCheck_default()(this,AdRequestGatekeeper),this._startTimestamp=Date.now(),this._gatekeeperDataStructure={advertiser:{}}}return createClass_default()(AdRequestGatekeeper,[{key:"addPrebid",value:function(advertiserLineItemId){Object(TypeUtils.a)(this._gatekeeperDataStructure.advertiser[advertiserLineItemId])||this._initGatekeeperDataForAdvertiser(advertiserLineItemId),this._gatekeeperDataStructure.advertiser[advertiserLineItemId].prebidData.push({timestamp:Date.now()})}},{key:"addBid",value:function(advertiserLineItemId,floorPrice){Object(TypeUtils.a)(this._gatekeeperDataStructure.advertiser[advertiserLineItemId])||this._initGatekeeperDataForAdvertiser(advertiserLineItemId),this._gatekeeperDataStructure.advertiser[advertiserLineItemId].bidsFloorPriceList.push({timestamp:Date.now(),floorPrice:floorPrice})}},{key:"addImpression",value:function(advertiserLineItemId,obfuscatedPrice){Object(TypeUtils.a)(this._gatekeeperDataStructure.advertiser[advertiserLineItemId])||this._initGatekeeperDataForAdvertiser(advertiserLineItemId),this._gatekeeperDataStructure.advertiser[advertiserLineItemId].impressionRevenueList.push({timestamp:Date.now(),obfuscatedPrice:obfuscatedPrice})}},{key:"shouldRequestLineItem",value:function(advertiserLineItemId){var currentTime=Date.now();return!(this._hasMinutesPassed(currentTime,3)&&this._histImpressionSumRevenue(advertiserLineItemId,currentTime,5)<-.5&&this._histPrebidCount(advertiserLineItemId,currentTime,3)>=11.5&&this._histBidPercentileFloorPrice(advertiserLineItemId,currentTime,10,.1)<.35)}},{key:"_hasMinutesPassed",value:function(currentTime,minutes){return currentTime-this._startTimestamp>=minutes*TimeConfig.e}},{key:"_histImpressionSumRevenue",value:function(advertiserLineItemId,currentTimeMs,minutes){var advertiserLineItemIdData=this._gatekeeperDataStructure.advertiser[advertiserLineItemId];if(!Object(TypeUtils.a)(advertiserLineItemIdData))return-1;var obfuscatedPriceListOnGivenTimeline=this._sliceDataForTimeIntervalInMinutes(advertiserLineItemIdData.impressionRevenueList,currentTimeMs,minutes).map(function(advertiserData){return advertiserData.obfuscatedPrice}),revenue=0;return Object(ArrayUtils.h)(obfuscatedPriceListOnGivenTimeline)&&(revenue=obfuscatedPriceListOnGivenTimeline.reduce(function(accumulator,currentValue){return accumulator+decodeObfuscatedBidPrice(currentValue)})),this._sanitizeHistoricMetricResult(revenue)}},{key:"_histPrebidCount",value:function(advertiserLineItemId,currentTimeMs,minutes){var advertiserLineItemIdData=this._gatekeeperDataStructure.advertiser[advertiserLineItemId];if(!Object(TypeUtils.a)(advertiserLineItemIdData))return-1;var prebidCount=this._sliceDataForTimeIntervalInMinutes(advertiserLineItemIdData.prebidData,currentTimeMs,minutes).length;return this._sanitizeHistoricMetricResult(prebidCount)}},{key:"_histBidPercentileFloorPrice",value:function(advertiserLineItemId,currentTimeMs,minutes,percentile){var advertiserLineItemIdData=this._gatekeeperDataStructure.advertiser[advertiserLineItemId];if(!Object(TypeUtils.a)(advertiserLineItemIdData))return-1;var floorPricesForLastTenMinutes=this._sliceDataForTimeIntervalInMinutes(advertiserLineItemIdData.impressionRevenueList,currentTimeMs,minutes).map(function(advertiserData){return advertiserData.floorPrice}),tenPercentileFloorPricesLastTenMinutes=this._calculatePercentile(floorPricesForLastTenMinutes,percentile);return this._sanitizeHistoricMetricResult(tenPercentileFloorPricesLastTenMinutes)}},{key:"_sliceDataForTimeIntervalInMinutes",value:function(gatekeeperDataForSpecificAdvertiser,currentTimeMs,minutes){for(var lastSecondMs=currentTimeMs-TimeConfig.f,lastSpecifiedMinutesMs=currentTimeMs-minutes*TimeConfig.e,dataForSpecifiedTimeline=[],i=gatekeeperDataForSpecificAdvertiser.length-1;i>=0&&gatekeeperDataForSpecificAdvertiser[i].timestamp>=lastSpecifiedMinutesMs;i--)gatekeeperDataForSpecificAdvertiser[i].timestamp<=lastSecondMs&&dataForSpecifiedTimeline.push(gatekeeperDataForSpecificAdvertiser[i]);return dataForSpecifiedTimeline}},{key:"_sanitizeHistoricMetricResult",value:function(metricResult){return 0===metricResult?-1:metricResult}},{key:"_initGatekeeperDataForAdvertiser",value:function(advertiserLineItemId){this._gatekeeperDataStructure.advertiser[advertiserLineItemId]={prebidData:[],bidsFloorPriceList:[],impressionRevenueList:[]}}},{key:"_calculatePercentile",value:function(numbers,percentile){if(0===numbers.length)return 0;if(percentile<=0)return numbers[0];if(percentile>=1)return numbers[numbers.length-1];var index=((numbers=numbers.sort(function(a,b){return a-b})).length-1)*percentile,lower=Math.floor(index),upper=lower+1,weight=index%1;return upper>=numbers.length?numbers[lower]:numbers[lower]*(1-weight)+numbers[upper]*weight}}]),AdRequestGatekeeper}(),PlatformCappedLineItemRepository_PlatformCappedLineItemRepository=function(){function PlatformCappedLineItemRepository(){classCallCheck_default()(this,PlatformCappedLineItemRepository),this._platformCappedLineItemIdList=new Set}return createClass_default()(PlatformCappedLineItemRepository,[{key:"addPlatformCappedLineItemIdList",value:function(lineItemIdList){var _this=this;lineItemIdList.forEach(function(lineItemId){Object(TypeUtils.h)(lineItemId)&&_this._platformCappedLineItemIdList.add(lineItemId)})}},{key:"isLineItemPlatformCapped",value:function(_ref){var advertiserLineItemId=_ref.advertiserLineItemId,publisherLineItemId=_ref.publisherLineItemId;return this._platformCappedLineItemIdList.has(advertiserLineItemId)||this._platformCappedLineItemIdList.has(publisherLineItemId)}}]),PlatformCappedLineItemRepository}(),AdBidPool_AdBidPool=function(){function AdBidPool(){classCallCheck_default()(this,AdBidPool),this._onBid=new Subject.a,this._onBidConsumed=new Subject.a,this._onBidLoadingConsumed=new Subject.a,this._onBidReady=new Subject.a,this._onBidStarted=new Subject.a,this._onBidReadyConsumed=new Subject.a,this.callingLineItems=[],this.bids=[],this.bidsLoading=[],this.bidsReady=[],this.bidStarted=null}return createClass_default()(AdBidPool,[{key:"getAllBids",value:function(){var startedBids=this.bidStarted?[this.bidStarted]:[];return[].concat(toConsumableArray_default()(this.getAllBidsExceptStartedBid()),startedBids)}},{key:"getAllBidsExceptStartedBid",value:function(){return[].concat(toConsumableArray_default()(this.bids),toConsumableArray_default()(this.bidsLoading),toConsumableArray_default()(this.bidsReady))}},{key:"addBid",value:function(bid){this.bids.push(bid),this._onBid.next(bid)}},{key:"moveBidToLoading",value:function(bid){this.bidsLoading.push(bid),this.consumeBid(bid)}},{key:"moveBidToReady",value:function(bid){this.bidsReady.push(bid),this.consumeBidLoading(bid),this._onBidReady.next(bid)}},{key:"moveBidToStarted",value:function(bid){this.bidStarted=bid,this.consumeBidReady(bid),this._onBidStarted.next(bid)}},{key:"consumeBid",value:function(bid){Object(ArrayUtils.k)(this.bids,bid),this._onBidConsumed.next(bid)}},{key:"consumeBidLoading",value:function(bid){Object(ArrayUtils.k)(this.bidsLoading,bid),this._onBidLoadingConsumed.next(bid)}},{key:"consumeBidReady",value:function(bid){Object(ArrayUtils.k)(this.bidsReady,bid)}},{key:"consumeBidStarted",value:function(bid){this.bidStarted=null,this._onBidReadyConsumed.next(bid)}},{key:"onBid",get:function(){return this._onBid.asObservable()}},{key:"onBidConsumed",get:function(){return this._onBidConsumed.asObservable()}},{key:"onBidLoadingConsumed",get:function(){return this._onBidLoadingConsumed.asObservable()}},{key:"onBidReady",get:function(){return this._onBidReady.asObservable()}},{key:"onBidStarted",get:function(){return this._onBidStarted.asObservable()}},{key:"onBidReadyConsumed",get:function(){return this._onBidReadyConsumed.asObservable()}}]),AdBidPool}(),VastTrackingEvents_VastTrackingEvents=function VastTrackingEvents(){classCallCheck_default()(this,VastTrackingEvents),this.creativeView=[],this.start=[],this.firstQuartile=[],this.midpoint=[],this.thirdQuartile=[],this.impression=[],this.complete=[],this.mute=[],this.unmute=[],this.pause=[],this.rewind=[],this.resume=[],this.fullscreen=[],this.exitFullscreen=[],this.expand=[],this.collapse=[],this.close=[],this.closeLinear=[],this.acceptInvitationLinear=[],this.acceptInvitation=[],this.skip=[],this.progress=[],this.playerExpand=[],this.playerCollapse=[],this.adExpand=[],this.adCollapse=[],this.fullScreen=[],this.canPlayThrough=[],this.stalled=[],this.waiting=[],this.otherAdInteraction=[]},VastTrackings_VastTrackings=function(){function VastTrackings(vastAd){classCallCheck_default()(this,VastTrackings),this.clickTrackings=[],this.customClicks=[],this.errorUrls=[],this.impressions=[],this.trackingEvents=new VastTrackingEvents_VastTrackingEvents,vastAd.inLine?this._addInLine(vastAd.inLine):this._addWrapper(vastAd.wrapper)}return createClass_default()(VastTrackings,[{key:"_addInLine",value:function(ad){this._addErrorTrackUrl(ad.errors),this._addImpressions(ad.impressions),this._addCreatives(ad.creatives)}},{key:"_addWrapper",value:function(ad){this._addErrorTrackUrl(ad.errors),this._addImpressions(ad.impressions),this._addCreatives(ad.creatives)}},{key:"_addLinear",value:function(linear){this._addTrackingEvents(linear.trackingEvents),this._addVideoClicks(linear.videoClicks)}},{key:"_addVideoClicks",value:function(videoClicks){videoClicks&&(this._addClickTrackings(videoClicks.clickTrackings),this._addCustomClicks(videoClicks.customClicks))}},{key:"_addClickTrackings",value:function(clickTrackings){var _this$clickTrackings;(_this$clickTrackings=this.clickTrackings).push.apply(_this$clickTrackings,toConsumableArray_default()(clickTrackings))}},{key:"_addCustomClicks",value:function(customClicks){var _this$customClicks;(_this$customClicks=this.customClicks).push.apply(_this$customClicks,toConsumableArray_default()(customClicks))}},{key:"_addTrackingEvents",value:function(trackings){var _this=this;trackings.forEach(function(tracking){try{_this.trackingEvents[tracking.name].push(tracking.uri)}catch(e){Object(Logging.a)({message:"AdManager_VastResponse_tracker",exception:"".concat(tracking.name),callStack:e.stack,level:protos.ProtoLoggingLevelEnum.INFO})}})}},{key:"_addCreatives",value:function(creatives){var _this2=this;creatives.forEach(function(creative){creative.linear&&_this2._addLinear(creative.linear)})}},{key:"_addErrorTrackUrl",value:function(errorUrl){var _this$errorUrls;(_this$errorUrls=this.errorUrls).push.apply(_this$errorUrls,toConsumableArray_default()(errorUrl))}},{key:"_addImpressions",value:function(impressions){var _this$impressions;(_this$impressions=this.impressions).push.apply(_this$impressions,toConsumableArray_default()(impressions))}}]),VastTrackings}(),CreativeTriggerTypeMap=(_CreativeTriggerTypeM={},defineProperty_default()(_CreativeTriggerTypeM,protos.ProtoTrackerTriggerType.Impression,"adImpression"),defineProperty_default()(_CreativeTriggerTypeM,protos.ProtoTrackerTriggerType.Complete25Pc,"adQuartileFirst"),defineProperty_default()(_CreativeTriggerTypeM,protos.ProtoTrackerTriggerType.Complete50Pc,"adQuartileSecond"),defineProperty_default()(_CreativeTriggerTypeM,protos.ProtoTrackerTriggerType.Complete75Pc,"adQuartileThird"),defineProperty_default()(_CreativeTriggerTypeM,protos.ProtoTrackerTriggerType.ViewCompletion,"adQuartileFourth"),defineProperty_default()(_CreativeTriggerTypeM,protos.ProtoTrackerTriggerType.VideoClick,"adClick"),defineProperty_default()(_CreativeTriggerTypeM,protos.ProtoTrackerTriggerType.Pause,"adPause"),defineProperty_default()(_CreativeTriggerTypeM,protos.ProtoTrackerTriggerType.Resume,"adResume"),defineProperty_default()(_CreativeTriggerTypeM,protos.ProtoTrackerTriggerType.Mute,"adMute"),defineProperty_default()(_CreativeTriggerTypeM,protos.ProtoTrackerTriggerType.Unmute,"adUnmute"),_CreativeTriggerTypeM),TrackersInformation_TrackersInformation=function(){function TrackersInformation(){classCallCheck_default()(this,TrackersInformation),this.adError=[],this.adWin=[],this.adImpression=[],this.adStarted=[],this.adVideoStart=[],this.adQuartileFirst=[],this.adQuartileSecond=[],this.adQuartileThird=[],this.adQuartileFourth=[],this.adClick=[],this.adPause=[],this.adResume=[],this.adSkip=[],this.adMute=[],this.adUnmute=[],this.adUserClose=[],this.adUserAcceptInvitation=[],this.adUserMinimize=[]}return createClass_default()(TrackersInformation,null,[{key:"track",value:function(trackerList,adMacroReplacer,lineItem,adManagerState){if(Array.isArray(trackerList)){var _adManagerState$adCon=adManagerState.adContainerState.get(lineItem.adType),adWidth=_adManagerState$adCon.width,adHeight=_adManagerState$adCon.height,adPostion=adManagerState.adBreakState.adBreakType,_adManagerState$media=adManagerState.media,mediaDescription=_adManagerState$media.mediaDescription,mediaDuration=_adManagerState$media.mediaDuration,mediaId=_adManagerState$media.mediaId,mediaUrl=_adManagerState$media.mediaUrl,mediaTitle=_adManagerState$media.mediaTitle;trackerList.forEach(function(tracker){if(tracker.url)try{var url=adMacroReplacer.replace(tracker.url,lineItem.vendorId,{adMacros:{adWidth:adWidth,adHeight:adHeight,adPostion:adPostion},mediaMacros:{mediaDescription:mediaDescription,mediaDuration:mediaDuration,mediaId:mediaId,mediaUrl:mediaUrl,mediaTitle:mediaTitle}});switch(tracker.type){case protos.ProtoTrackerType.Image:Object(GeneralUtils.m)([url],window);break;case protos.ProtoTrackerType.Javascript:Object(DomUtils.A)({src:url},window.document.head,window)}}catch(_a){}})}}}]),TrackersInformation}();function addTrackersFromCreative(creativeTrackers,trackerInformation){creativeTrackers.forEach(function(tracker){return function(creativeTracker,trackerInformation){(function(creativeTriggerType,trackerInformation){return trackerInformation[CreativeTriggerTypeMap[creativeTriggerType]]})(creativeTracker.trigger,trackerInformation).push({type:creativeTracker.type,url:creativeTracker.url})}(tracker,trackerInformation)})}function createImageTracker(url){return{type:protos.ProtoTrackerType.Image,url:url}}function getImageTrackers(urls){return urls.map(function(url){return createImageTracker(url)})}!function(AdCallRejectionReason){AdCallRejectionReason[AdCallRejectionReason.HandlingSdkUrl=0]="HandlingSdkUrl",AdCallRejectionReason[AdCallRejectionReason.NetworkRequestUrl=1]="NetworkRequestUrl",AdCallRejectionReason[AdCallRejectionReason.XmlInvalidString=2]="XmlInvalidString",AdCallRejectionReason[AdCallRejectionReason.XmlParseGeneral=3]="XmlParseGeneral",AdCallRejectionReason[AdCallRejectionReason.XmlInvalidTree=4]="XmlInvalidTree",AdCallRejectionReason[AdCallRejectionReason.XmlInvalidAd=5]="XmlInvalidAd",AdCallRejectionReason[AdCallRejectionReason.XmlAdaptorWrapperLimit=6]="XmlAdaptorWrapperLimit",AdCallRejectionReason[AdCallRejectionReason.HTMLUnknownMimeType=7]="HTMLUnknownMimeType",AdCallRejectionReason[AdCallRejectionReason.ImaAdsManagerInit=8]="ImaAdsManagerInit",AdCallRejectionReason[AdCallRejectionReason.ImaVastEmptyResponse=9]="ImaVastEmptyResponse",AdCallRejectionReason[AdCallRejectionReason.ImaRequestException=10]="ImaRequestException",AdCallRejectionReason[AdCallRejectionReason.ImaTimeout=11]="ImaTimeout",AdCallRejectionReason[AdCallRejectionReason.ImaInvalidResponse=12]="ImaInvalidResponse"}(AdCallRejectionReason||(AdCallRejectionReason={}));var EnforcerEventsEnum,EnforcerTypesEnum,AdCallRejectionReasonNoBidMapping=(_AdCallRejectionReaso={},defineProperty_default()(_AdCallRejectionReaso,AdCallRejectionReason.HandlingSdkUrl,protos.ConnatixNoBidReasonEnum.CsRequestException),defineProperty_default()(_AdCallRejectionReaso,AdCallRejectionReason.NetworkRequestUrl,protos.ConnatixNoBidReasonEnum.CsRequestException),defineProperty_default()(_AdCallRejectionReaso,AdCallRejectionReason.XmlInvalidString,protos.ConnatixNoBidReasonEnum.CsEmptyResponse),defineProperty_default()(_AdCallRejectionReaso,AdCallRejectionReason.XmlParseGeneral,protos.ConnatixNoBidReasonEnum.CsInvalidResponse),defineProperty_default()(_AdCallRejectionReaso,AdCallRejectionReason.XmlInvalidTree,protos.ConnatixNoBidReasonEnum.CsInvalidResponse),defineProperty_default()(_AdCallRejectionReaso,AdCallRejectionReason.XmlInvalidAd,protos.ConnatixNoBidReasonEnum.CsInvalidResponse),defineProperty_default()(_AdCallRejectionReaso,AdCallRejectionReason.XmlAdaptorWrapperLimit,protos.ConnatixNoBidReasonEnum.CsInvalidResponse),defineProperty_default()(_AdCallRejectionReaso,AdCallRejectionReason.HTMLUnknownMimeType,protos.ConnatixNoBidReasonEnum.CsInvalidResponse),defineProperty_default()(_AdCallRejectionReaso,AdCallRejectionReason.ImaAdsManagerInit,protos.ConnatixNoBidReasonEnum.CsRequestException),defineProperty_default()(_AdCallRejectionReaso,AdCallRejectionReason.ImaVastEmptyResponse,protos.ConnatixNoBidReasonEnum.CsInvalidResponse),defineProperty_default()(_AdCallRejectionReaso,AdCallRejectionReason.ImaRequestException,protos.ConnatixNoBidReasonEnum.CsRequestException),defineProperty_default()(_AdCallRejectionReaso,AdCallRejectionReason.ImaTimeout,protos.ConnatixNoBidReasonEnum.Timeout),defineProperty_default()(_AdCallRejectionReaso,AdCallRejectionReason.ImaInvalidResponse,protos.ConnatixNoBidReasonEnum.CsInvalidResponse),_AdCallRejectionReaso),MonetisationConfig=__webpack_require__(19);!function(EnforcerEventsEnum){EnforcerEventsEnum.VOLUME_DETECTED="volume_detected",EnforcerEventsEnum.MALWARE_DETECTED="malware_detected",EnforcerEventsEnum.BADURI_DETECTED="baduri_detected"}(EnforcerEventsEnum||(EnforcerEventsEnum={})),function(EnforcerTypesEnum){EnforcerTypesEnum[EnforcerTypesEnum.None=0]="None",EnforcerTypesEnum[EnforcerTypesEnum.Mute=1]="Mute",EnforcerTypesEnum[EnforcerTypesEnum.ScrollHijack=2]="ScrollHijack",EnforcerTypesEnum[EnforcerTypesEnum.MemoryLeak=4]="MemoryLeak",EnforcerTypesEnum[EnforcerTypesEnum.Malware=8]="Malware",EnforcerTypesEnum[EnforcerTypesEnum.All=15]="All"}(EnforcerTypesEnum||(EnforcerTypesEnum={}));var BidLifeCycleEvent,AVpaidEventDispatcher_AVpaidEventDispatcher=function(){function AVpaidEventDispatcher(){classCallCheck_default()(this,AVpaidEventDispatcher),this._onVpaidEvent=new Subject.a}return createClass_default()(AVpaidEventDispatcher,[{key:"handshakeVersion",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return"2.0"}},{key:"onVpaidEvent",get:function(){return this._onVpaidEvent.asObservable()}}]),AVpaidEventDispatcher}();!function(BidLifeCycleEvent){BidLifeCycleEvent[BidLifeCycleEvent.Win=0]="Win",BidLifeCycleEvent[BidLifeCycleEvent.AdLoaded=1]="AdLoaded",BidLifeCycleEvent[BidLifeCycleEvent.AdStarted=2]="AdStarted",BidLifeCycleEvent[BidLifeCycleEvent.AdImpression=3]="AdImpression"}(BidLifeCycleEvent||(BidLifeCycleEvent={}));var AdVpaidEventsTimeoutsEnum,BidLifecycleHandler_BidLifeCycleHandler=function(){function BidLifeCycleHandler(_bid){classCallCheck_default()(this,BidLifeCycleHandler),this._bid=_bid,this._lifecycleTimestamp=new Map,Object(TypeUtils.a)(this._bid.settings.bidLifecycle)||(this._bid.settings.bidLifecycle={})}return createClass_default()(BidLifeCycleHandler,[{key:"onTrackingLifecycleEvent",value:function(lifecycleEvent){switch(this._lifecycleTimestamp.set(lifecycleEvent,Date.now()),lifecycleEvent){case BidLifeCycleEvent.AdLoaded:this._setWinToAdLoadedTimeOnBid();break;case BidLifeCycleEvent.AdImpression:this._setStartAdToImpressionTimeOnBid()}}},{key:"_setWinToAdLoadedTimeOnBid",value:function(){this._bid.settings.bidLifecycle.winToAdLoadedTime=this._winToAdLoadedTime}},{key:"_setStartAdToImpressionTimeOnBid",value:function(){this._bid.settings.bidLifecycle.startAdToImpressionTime=this._startAdToImpressionTime}},{key:"_startAdToImpressionTime",get:function(){return this._lifecycleTimestamp.get(BidLifeCycleEvent.AdImpression)&&this._lifecycleTimestamp.get(BidLifeCycleEvent.AdStarted)?this._lifecycleTimestamp.get(BidLifeCycleEvent.AdImpression)-this._lifecycleTimestamp.get(BidLifeCycleEvent.AdStarted):0}},{key:"_winToAdLoadedTime",get:function(){return this._lifecycleTimestamp.get(BidLifeCycleEvent.AdLoaded)&&this._lifecycleTimestamp.get(BidLifeCycleEvent.Win)?this._lifecycleTimestamp.get(BidLifeCycleEvent.AdLoaded)-this._lifecycleTimestamp.get(BidLifeCycleEvent.Win):0}}]),BidLifeCycleHandler}();function getRealYoScore(yoScore){return[yoScore-(yoScore-yoScore%100),yoScore-yoScore%100]}function calculateYoScore(yoScoreMetrics){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return Math.random();var successRate=yoScoreMetrics.successRate,cpm=yoScoreMetrics.cpm,priority=yoScoreMetrics.priority;0===successRate&&Math.random();return 1,1*cpm+MonetizationConfig.f*priority}function getBidCpmBasedOnCreativeType(bidSettings){switch(bidSettings.creativeType){case protos.ProtoCreativeTypeEnum.Tam:case protos.ProtoCreativeTypeEnum.TamDeal:case protos.ProtoCreativeTypeEnum.Rtb:return decodeObfuscatedBidPrice(bidSettings.obfuscatedPrice);case protos.ProtoCreativeTypeEnum.HeaderBidder:return bidSettings.cpm;default:return bidSettings.floorPrice}}function ABaseBidAdaptor_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}!function(AdVpaidEventsTimeoutsEnum){AdVpaidEventsTimeoutsEnum.IMPRESSION_TIMEOUT="IMPRESSION_TIMEOUT",AdVpaidEventsTimeoutsEnum.VIEWABLE_IMPRESSION_TIMEOUT="VIEWABLE_IMPRESSION_TIMEOUT",AdVpaidEventsTimeoutsEnum.SKIP_AD_TIMEOUT="SKIP_AD_TIMEOUT",AdVpaidEventsTimeoutsEnum.STOP_AD_TIMEOUT="STOP_AD_TIMEOUT",AdVpaidEventsTimeoutsEnum.AD_LOADED_TIMEOUT="AD_LOADED_TIMEOUT"}(AdVpaidEventsTimeoutsEnum||(AdVpaidEventsTimeoutsEnum={}));var ABaseBidAdaptor_ABaseBidAdaptor=function(_AVpaidEventDispatche){inherits_default()(ABaseBidAdaptor,_AVpaidEventDispatche);var _super=ABaseBidAdaptor_createSuper(ABaseBidAdaptor);function ABaseBidAdaptor(settings){var _this$_timeoutHandles,_this;classCallCheck_default()(this,ABaseBidAdaptor),(_this=_super.call(this)).settings=settings,_this._$adSlot=null,_this._$videoSlot=null,_this._$parentSlot=null,_this._adSlotContainer=null,_this._creativeId=void 0,_this._impressionStarted=!1,_this._destroyed=!1,_this._initCalled=!1,_this._startCalled=!1,_this._destroyTimeoutHandle=null,_this._subscriptions=[],_this._onAdViewableImpression=new Subject.a,_this._impressionTimeoutHandler=function(){_this._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.Timeout}}),_this._clearAdVpaidEventsTimeouts()},_this._viewableImpressionTimeoutHandler=function(){_this._trackAdViewableImpression(),_this._adTimeoutController(AdVpaidEventsTimeoutsEnum.VIEWABLE_IMPRESSION_TIMEOUT).clearTimeout(),_this.settings.viewabilityService.off(_this._$adSlot,_this._onViewabilityChange)},_this._onViewabilityChange=function(inView){var timeoutController=_this._adTimeoutController(AdVpaidEventsTimeoutsEnum.VIEWABLE_IMPRESSION_TIMEOUT);inView?timeoutController.timeoutHandle.timeoutId||timeoutController.setTimeout():timeoutController.clearTimeout()},_this._skipAdTimeoutHandler=function(){_this._sendVpaidEvent({type:VastConfig.b.AdSkipped}),_this._clearAdVpaidEventsTimeouts()},_this._stopAdTimeoutHandler=function(){_this._sendVpaidEvent({type:VastConfig.b.AdStopped,payload:{shouldTrackPostBid:!0}}),_this._clearAdVpaidEventsTimeouts()},_this._adLoadedTimeoutHandler=function(){_this._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.TimeoutLoaded}}),_this._clearAdVpaidEventsTimeouts()},_this._adTimeoutController=function(timeoutType){var timeoutHandle=_this._timeoutHandles[timeoutType];return{timeoutHandle:timeoutHandle,setTimeout:function(){timeoutHandle.timeoutId=TimerService_TimerService.setTimeout(function(){timeoutHandle.callback()},timeoutHandle.timeout)},clearTimeout:function(){null!==timeoutHandle.timeoutId&&(TimerService_TimerService.clearTimeout(timeoutHandle.timeoutId),timeoutHandle.timeoutId=null)}}},_this.creativeId=_this.settings.externalCreativeId,_this._parentSlotId="cnx-ad-bid-slot-id-".concat(_this.settings.requestMetadata.data.cnxBidId),_this._adSlotId="cnx-ad-slot-".concat(_this.settings.id);var adType=_this.settings.adManagerLineItem.protoLineItem.adType;return _this._timeoutHandles=(_this$_timeoutHandles={},defineProperty_default()(_this$_timeoutHandles,AdVpaidEventsTimeoutsEnum.IMPRESSION_TIMEOUT,{callback:_this._impressionTimeoutHandler,timeout:25e3,timeoutId:null}),defineProperty_default()(_this$_timeoutHandles,AdVpaidEventsTimeoutsEnum.VIEWABLE_IMPRESSION_TIMEOUT,{callback:_this._viewableImpressionTimeoutHandler,timeout:adType===Generated_protos.ProtoAdType.Video?MonetizationConfig.b:MonetizationConfig.a,timeoutId:null}),defineProperty_default()(_this$_timeoutHandles,AdVpaidEventsTimeoutsEnum.SKIP_AD_TIMEOUT,{callback:_this._skipAdTimeoutHandler,timeout:500,timeoutId:null}),defineProperty_default()(_this$_timeoutHandles,AdVpaidEventsTimeoutsEnum.STOP_AD_TIMEOUT,{callback:_this._stopAdTimeoutHandler,timeout:500,timeoutId:null}),defineProperty_default()(_this$_timeoutHandles,AdVpaidEventsTimeoutsEnum.AD_LOADED_TIMEOUT,{callback:_this._adLoadedTimeoutHandler,timeout:25e3,timeoutId:null}),_this$_timeoutHandles),_this._urlSuffixerService=settings.urlSuffixerService,_this}return createClass_default()(ABaseBidAdaptor,[{key:"getPrice",value:function(){var _this$settings$adMana=this.settings.adManagerLineItem.protoLineItem,advertiserLineItemId=_this$settings$adMana.advertiserLineItemId,creativeType=_this$settings$adMana.creativeType,floorPrice=_this$settings$adMana.floorPrice,lineItemPriority=_this$settings$adMana.lineItemPriority;return getBidCpmBasedOnCreativeType({lineItemId:advertiserLineItemId,bidId:this.settings.id,creativeType:creativeType,floorPrice:floorPrice,obfuscatedPrice:this.settings.obfuscatedPrice,successRate:this.settings.successRate,priority:lineItemPriority,cpm:this.settings.cpm})}},{key:"skipAd",value:function(){this._adTimeoutController(AdVpaidEventsTimeoutsEnum.SKIP_AD_TIMEOUT).setTimeout()}},{key:"stopAd",value:function(reason){this._adTimeoutController(AdVpaidEventsTimeoutsEnum.STOP_AD_TIMEOUT).setTimeout()}},{key:"startAd",value:function(){this._startCalled&&Object(Logging.a)({message:"AdManager_ABaseBidAdaptor_samebid",exception:"startAd",callStack:"adv:".concat(this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId," bidid: ").concat(this._adSlotId),level:protos.ProtoLoggingLevelEnum.FATAL}),this._startCalled=!0,this._adTimeoutController(AdVpaidEventsTimeoutsEnum.IMPRESSION_TIMEOUT).setTimeout()}},{key:"initAd",value:function(width,height,viewMode,desireBitrate,creativeData,environmentVars,volume){this._initCalled&&Object(Logging.a)({message:"AdManager_ABaseBidAdaptor_samebid",exception:"initAd",callStack:"adv:".concat(this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId," bidid: ").concat(this._adSlotId),level:protos.ProtoLoggingLevelEnum.FATAL}),this._initCalled=!0,this._adTimeoutController(AdVpaidEventsTimeoutsEnum.AD_LOADED_TIMEOUT).setTimeout(),this._prepareAdSlot(volume),this._bidLifecycleHandler=new BidLifecycleHandler_BidLifeCycleHandler(this),this._bidLifecycleHandler.onTrackingLifecycleEvent(BidLifeCycleEvent.Win)}},{key:"setAdVolume",value:function(volume){this._$videoSlot.volume=volume,Object(DomUtils.V)(this._$videoSlot,volume),volume<=0?this.settings.adEnforcer.start(EnforcerTypesEnum.Mute):this.settings.adEnforcer.stop(EnforcerTypesEnum.Mute)}},{key:"_getAdLoadedEventData",value:function(vpaidWrapperAdLoadedEvent){var skipOffset;Object(TypeUtils.d)(vpaidWrapperAdLoadedEvent.payload.skipOffset)&&(skipOffset=vpaidWrapperAdLoadedEvent.payload.skipOffset);var adLoadedPayload={type:VastConfig.b.AdLoaded,payload:{adLoadedData:{skipOffset:skipOffset},adSkipMode:this.settings.adManagerLineItem.protoLineItem.skipMode}};return this.settings.adLoadedPayload=adLoadedPayload,adLoadedPayload}},{key:"_getAdImpressionEventData",value:function(vpaidWrapperImpressionEvent){return{type:VastConfig.b.AdImpression,payload:{adSkipMode:this.settings.adManagerLineItem.protoLineItem.skipMode,adSourceData:{moatTrackingEnabled:this.settings.adManagerLineItem.protoLineItem.moatTrackingEnabled,creativeId:this.settings.adManagerLineItem.protoLineItem.cnxCreativeId,adId:this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,length:this.getAdDuration(),adVideoUrl:this.adVideoUrl,name:"Connatix Ad"},customAdData:{ADVERTISER:this.settings.requestMetadata.data.rtbAdomain,CREATIVE_ID:this.creativeId,CAMPAIGN_ID:this.settings.requestMetadata.data.rtbCampainId}}}}},{key:"_getAdVideoStartEventData",value:function(vpaidWrapperAdStartedEvent){return{type:VastConfig.b.AdVideoStart,payload:{adSkipMode:this.settings.adManagerLineItem.protoLineItem.skipMode,adSourceData:{moatTrackingEnabled:this.settings.adManagerLineItem.protoLineItem.moatTrackingEnabled,creativeId:this.settings.adManagerLineItem.protoLineItem.cnxCreativeId,adId:this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,length:this.getAdDuration(),name:"Connatix Ad"},customAdData:{ADVERTISER:this.settings.requestMetadata.data.rtbAdomain,CREATIVE_ID:this.creativeId,CAMPAIGN_ID:this.settings.requestMetadata.data.rtbCampainId}}}}},{key:"_sendVpaidEvent",value:function(eventData){if(this._isValidVpaidEvent(eventData))switch(eventData.type){case VastConfig.b.AdLoaded:this._bidLifecycleHandler.onTrackingLifecycleEvent(BidLifeCycleEvent.AdLoaded),this._adTimeoutController(AdVpaidEventsTimeoutsEnum.AD_LOADED_TIMEOUT).clearTimeout(),this._onVpaidEvent.next(this._getAdLoadedEventData(eventData));break;case VastConfig.b.AdImpression:this._bidLifecycleHandler.onTrackingLifecycleEvent(BidLifeCycleEvent.AdImpression),this._adTimeoutController(AdVpaidEventsTimeoutsEnum.IMPRESSION_TIMEOUT).clearTimeout(),this._startViewableImpressionTracking(),Object(DomUtils.a)(this._$parentSlot,"cnx-ad-bid-slot-selected"),this._onVpaidEvent.next(this._getAdImpressionEventData(eventData)),this._impressionStarted=!0;break;case VastConfig.b.AdVideoStart:this._bidLifecycleHandler.onTrackingLifecycleEvent(BidLifeCycleEvent.AdStarted),this._onVpaidEvent.next(this._getAdVideoStartEventData(eventData));break;case VastConfig.b.AdStopped:case VastConfig.b.AdSkipped:case VastConfig.b.AdError:this._destroyed&&Object(Logging.a)({message:"AdManager_ABaseBidAdaptor_double_destroy",exception:this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,level:protos.ProtoLoggingLevelEnum.WARNING}),this._destroy(),this._onVpaidEvent.next(eventData);break;default:this._onVpaidEvent.next(eventData)}else this._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.InvalidVpaidEvent}})}},{key:"_prepareAdSlot",value:function(volume){var _this2=this;this._adSlotContainer=this._requestAdSlot(),this._$parentSlot=this._adSlotContainer.slotsContainer,Object(DomUtils.a)(this._$parentSlot,this._parentSlotId),this._$adSlot=this._adSlotContainer.adSlot,this._$adSlot.id=this._adSlotId,this._$parentSlot.id=this.settings.bidSlotId,this._$videoSlot=this._adSlotContainer.videoSlot,this._$videoSlot.volume=volume,Object(DomUtils.V)(this._$videoSlot,volume),this.settings.adEnforcer.registerContainer(this._$parentSlot,this._adSlotId),this._subscriptions.push(this.settings.adEnforcer.onEnforcerEvent.subscribe(function(event){_this2._onEnforcerEvent(event)})),this.settings.adEnforcer.start(EnforcerTypesEnum.All)}},{key:"_requestAdSlot",value:function(){return this.settings.adSlotContainerRecycler.requestAdSlot(this.settings.adContainer)}},{key:"_destroy",value:function(){this._destroyed=!0,Object(DomUtils.L)(this._$parentSlot,"cnx-ad-bid-slot-selected"),Object(DomUtils.L)(this._$parentSlot,this._parentSlotId),this._$adSlot.removeAttribute("id"),this._$parentSlot.removeAttribute("id"),clearSubscriptions(this._subscriptions),this._clearAdVpaidEventsTimeouts(),this.settings.adEnforcer.deregisterContainer(this._$parentSlot),this.settings.viewabilityService.off(this._$adSlot,this._onViewabilityChange),null!==this._destroyTimeoutHandle&&TimerService_TimerService.clearTimeout(this._destroyTimeoutHandle),this._freeAdSlot()}},{key:"_freeAdSlot",value:function(){var _this3=this;this._destroyTimeoutHandle=TimerService_TimerService.setTimeout(function(){_this3.settings.adSlotContainerRecycler.destroyAdSlot(_this3._adSlotContainer)},500)}},{key:"_trackAdViewableImpression",value:function(){var _this$settings$adMana2=this.settings.adManagerLineItem.protoLineItem,advertiserLineItemId=_this$settings$adMana2.advertiserLineItemId,publisherLineItemId=_this$settings$adMana2.publisherLineItemId;this._onAdViewableImpression.next({advertiserLineItemId:advertiserLineItemId,publisherLineItemId:publisherLineItemId,rtbSeatId:this.settings.requestMetadata.data.rtbSeatId,dspId:this.settings.requestMetadata.data.dspId})}},{key:"_startViewableImpressionTracking",value:function(){var threshold=MonetizationConfig.e,element=this._$adSlot;this.settings.viewabilityService.on(element,this._onViewabilityChange,{threshold:threshold}),this._onViewabilityChange(this.settings.viewabilityService.check({threshold:threshold,element:element}))}},{key:"_clearAdVpaidEventsTimeouts",value:function(){var _this4=this;Object.keys(this._timeoutHandles).forEach(function(key){_this4._adTimeoutController(key).clearTimeout()})}},{key:"_isValidVpaidEvent",value:function(eventData){return!(!this._impressionStarted&&(eventData.type===VastConfig.b.AdStopped||eventData.type===VastConfig.b.AdSkipped))}},{key:"_onEnforcerEvent",value:function(event){if(event.detectedContainer===this._$parentSlot){var loggingMessage;switch(event.type){case EnforcerEventsEnum.BADURI_DETECTED:loggingMessage="AdManager_enforcer_BadUri";break;case EnforcerEventsEnum.MALWARE_DETECTED:loggingMessage="AdManager_enforcer_malware",this._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.EnforcementMalware}});break;case EnforcerEventsEnum.VOLUME_DETECTED:loggingMessage="AdManager_enforcer_soundBlock",this._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.EnforcementVolume}})}Object(Logging.a)({message:loggingMessage,exception:event.message,level:protos.ProtoLoggingLevelEnum.WARNING})}}},{key:"_logVpaidEventError",value:function(className,methodName,error){var _a,_b,advertiserLineItemId=this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,creativeId=this.creativeId;Object(Logging.a)({message:"AdManager_".concat(className,"_").concat(methodName),exception:"advertiserLineItemId:".concat(advertiserLineItemId,"_creativeId:").concat(creativeId,"_errorMessage:").concat(null===(_a=error)||void 0===_a?void 0:_a.message),callStack:null===(_b=error)||void 0===_b?void 0:_b.stack,throttle:5,level:protos.ProtoLoggingLevelEnum.WARNING,sendMaxLog:!0})}},{key:"impressionStarted",get:function(){return this._impressionStarted}},{key:"creativeId",get:function(){return this._creativeId},set:function(value){Object(TypeUtils.h)(this.creativeId)||(this._creativeId=value)}},{key:"onAdViewableImpression",get:function(){return this._onAdViewableImpression.asObservable()}}]),ABaseBidAdaptor}(AVpaidEventDispatcher_AVpaidEventDispatcher),AdDomainBlockingService=__webpack_require__(77);function AdImaWrapper_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AdImaWrapper_AdImaWrapper=function(_AVpaidEventDispatche){inherits_default()(AdImaWrapper,_AVpaidEventDispatche);var _super=AdImaWrapper_createSuper(AdImaWrapper);function AdImaWrapper(_imaSdk,_os,_imaAdsLoader,_adTagUrl,_imaAdsManager,_userContext,_publisherLineItemId){var _this;return classCallCheck_default()(this,AdImaWrapper),(_this=_super.call(this))._imaSdk=_imaSdk,_this._os=_os,_this._imaAdsLoader=_imaAdsLoader,_this._adTagUrl=_adTagUrl,_this._imaAdsManager=_imaAdsManager,_this._userContext=_userContext,_this._publisherLineItemId=_publisherLineItemId,_this._onCreativeReceived=new Subject.a,_this._onImaAdError=function(event){if(_this._isEventGeneratedByCurrentRequest(event)){var message="";try{message=event.getError().getMessage()+"_"+event.getError().getErrorCode()+"_"+event.getError().getVastErrorCode()}catch(e){}_this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.ImaError+"_"+message}})}},_this._onAdEvent=function(event){var adEventType=_this._imaSdk.AdEvent.Type;switch(event.type){case adEventType.CLICK:_this._onVpaidEvent.next({type:VastConfig.b.AdClickThru,payload:{}});break;case adEventType.LOADED:_this._onAdLoaded(event);break;case adEventType.IMPRESSION:var imaMetadata={adsManager:_this._imaAdsManager,adContainer:_this._imaSdkSlot,viewMode:_this._getViewMode(_this._viewMode),adTag:_this._adTagUrl};_this._onVpaidEvent.next({type:VastConfig.b.AdVideoStart}),_this._onVpaidEvent.next({type:VastConfig.b.AdImpression,payload:{imaMetadata:imaMetadata}});break;case adEventType.STARTED:_this._onVpaidEvent.next({type:VastConfig.b.AdStarted});break;case adEventType.FIRST_QUARTILE:_this._onVpaidEvent.next({type:VastConfig.b.AdVideoFirstQuartile});break;case adEventType.MIDPOINT:_this._onVpaidEvent.next({type:VastConfig.b.AdVideoMidpoint});break;case adEventType.THIRD_QUARTILE:_this._onVpaidEvent.next({type:VastConfig.b.AdVideoThirdQuartile});break;case adEventType.COMPLETE:_this._onVpaidEvent.next({type:VastConfig.b.AdVideoComplete}),_this._onVpaidEvent.next({type:VastConfig.b.AdStopped,payload:{shouldTrackPostBid:!0}});break;case adEventType.ALL_ADS_COMPLETED:break;case adEventType.DURATION_CHANGE:_this._onVpaidEvent.next({type:VastConfig.b.AdDurationChange});break;case adEventType.PAUSED:_this._onVpaidEvent.next({type:VastConfig.b.AdPaused});break;case adEventType.RESUMED:_this._onVpaidEvent.next({type:VastConfig.b.AdPlaying});break;case adEventType.LINEAR_CHANGED:_this._onVpaidEvent.next({type:VastConfig.b.AdLinearChange});break;case adEventType.SKIPPABLE_STATE_CHANGED:_this._onVpaidEvent.next({type:VastConfig.b.AdSkippableStateChange});break;case adEventType.SKIPPED:_this._onVpaidEvent.next({type:VastConfig.b.AdSkipped});break;case adEventType.VOLUME_CHANGED:_this._onVpaidEvent.next({type:VastConfig.b.AdVolumeChange});break;case adEventType.USER_CLOSE:_this._onVpaidEvent.next({type:VastConfig.b.AdUserClose});break;case adEventType.LOG:_this._onVpaidEvent.next({type:VastConfig.b.AdLog})}},_this._bindToEvents(),_this}return createClass_default()(AdImaWrapper,[{key:"initAd",value:function(width,height,viewMode,desireBitrate,creativeData,environmentVars){this._imaSdkSlot=environmentVars.slot,this._videoSlot=environmentVars.videoSlot,this._viewMode=viewMode||VastConfig.a.Normal;try{this._imaAdsManager.setVolume(0),this._imaAdsManager.init(width,height,this._getViewMode(this._viewMode))}catch(e){this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.ImaManagerInit}})}}},{key:"startAd",value:function(){try{this._imaAdsManager.start()}catch(e){this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.WrapperStartAdError+"_".concat(e.message)}})}}},{key:"stopAd",value:function(reason){this._imaAdsManager.stop(),this._onVpaidEvent.next({type:VastConfig.b.AdStopped,payload:{shouldTrackPostBid:!0}})}},{key:"resizeAd",value:function(width,height,viewMode){this._imaAdsManager.resize(width,height,this._getViewMode(viewMode))}},{key:"pauseAd",value:function(){this._imaAdsManager.pause()}},{key:"resumeAd",value:function(){this._imaAdsManager.resume(),this._os===OsConfig.b.Ios&&Object(DomUtils.C)(this._videoSlot)}},{key:"expandAd",value:function(){this._imaAdsManager.expand()}},{key:"collapseAd",value:function(){this._imaAdsManager.collapse()}},{key:"skipAd",value:function(){this._imaAdsManager.skip()}},{key:"getAdRemainingTime",value:function(){return this._imaAdsManager.getRemainingTime()||0}},{key:"getAdDuration",value:function(){return this._imaAd?this._imaAd.getDuration():0}},{key:"getAdVolume",value:function(){return this._imaAdsManager.getVolume()}},{key:"getAdMediaWidth",value:function(){return this._imaAd?this._imaAd.getVastMediaWidth():0}},{key:"getAdMediaHeight",value:function(){return this._imaAd?this._imaAd.getVastMediaHeight():0}},{key:"setAdVolume",value:function(volume){this._imaAdsManager.setVolume(volume)}},{key:"getMediaFile",value:function(){return this._imaAd?this._imaAd.getMediaUrl():void 0}},{key:"_bindToEvents",value:function(){var _this2=this;this._imaAdsLoader.addEventListener(this._imaSdk.AdErrorEvent.Type.AD_ERROR,this._onImaAdError),this._imaAdsManager.addEventListener(this._imaSdk.AdErrorEvent.Type.AD_ERROR,this._onImaAdError),Object.keys(this._imaSdk.AdEvent.Type).forEach(function(key){_this2._imaAdsManager.addEventListener(_this2._imaSdk.AdEvent.Type[key],_this2._onAdEvent,!1)})}},{key:"_unbindFromEvents",value:function(){var _this3=this;this._imaAdsLoader.removeEventListener(this._imaSdk.AdErrorEvent.Type.AD_ERROR,this._onImaAdError),this._imaAdsManager.removeEventListener(this._imaSdk.AdErrorEvent.Type.AD_ERROR,this._onImaAdError),Object.keys(this._imaSdk.AdEvent.Type).forEach(function(key){_this3._imaAdsManager.removeEventListener(_this3._imaSdk.AdEvent.Type[key],_this3._onAdEvent,!1)})}},{key:"_getViewMode",value:function(vastViewMode){return vastViewMode===VastConfig.a.Fullscreen?this._imaSdk.ViewMode.FULLSCREEN:this._imaSdk.ViewMode.NORMAL}},{key:"_isEventGeneratedByCurrentRequest",value:function(event){var context=event.getUserRequestContext();return!context||context.id===this._userContext.id}},{key:"_onAdLoaded",value:function(event){var _this4=this;this._imaAd=event.getAd(),this._onCreativeReceived.next(this._imaAd.getCreativeId());var imaSkipOffset=-1,clickThroughUrl="";try{imaSkipOffset=this._imaAd.getSkipTimeOffset();var extractedUrl=event.getAdData().clickThroughUrl;clickThroughUrl=Object(TypeUtils.h)(extractedUrl)?extractedUrl:void 0}catch(e){}Object(AdDomainBlockingService.b)(this._publisherLineItemId,clickThroughUrl).then(function(blocked){blocked?_this4._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.DomainBlocked}}):_this4._onVpaidEvent.next({type:VastConfig.b.AdLoaded,payload:{skipOffset:imaSkipOffset}})})}},{key:"destroy",value:function(){var _this5=this;try{this._unbindFromEvents(),setTimeout(function(){_this5._imaAdsManager.destroy()})}catch(e){}}},{key:"onCreativeReceived",get:function(){return this._onCreativeReceived.asObservable()}}]),AdImaWrapper}(AVpaidEventDispatcher_AVpaidEventDispatcher),FETCH_FAILURE_REASONS={ImaObjectNotFound:MonetisationConfig.c.ImaObjectNotFound,ImaScriptFailure:MonetisationConfig.c.ImaScriptFailure},IMA_SDK_URI="//imasdk.googleapis.com/js/sdkloader/ima3.js",ImaSdkFetchService_ImaSdkFetchService=function(){function ImaSdkFetchService(){classCallCheck_default()(this,ImaSdkFetchService)}return createClass_default()(ImaSdkFetchService,null,[{key:"preloadImaSdk",value:function(GLOBAL){Object(DomUtils.I)(IMA_SDK_URI,GLOBAL)}},{key:"fetchImaSdk",value:function(GLOBAL,logErrors){return new Promise(function(resolve,reject){var imaSDK=ImaSdkFetchService._getImaSdkFromGlobal(GLOBAL);if(imaSDK)resolve(imaSDK);else{var shouldLogError=logErrors&&1===Object(GeneralUtils.l)([95,5]);Object(DomUtils.A)({src:IMA_SDK_URI},GLOBAL.document.head,GLOBAL,function(){var imaSdk=ImaSdkFetchService._getImaSdkFromGlobal(GLOBAL);imaSdk?resolve(imaSdk):(shouldLogError&&Object(Logging.a)({message:"AdManager_ImaIntegrator_no_image_object_found_after_loading_script",level:protos.ProtoLoggingLevelEnum.FATAL,throttle:2,sendMaxLog:!1}),reject(FETCH_FAILURE_REASONS.ImaObjectNotFound))},function(){reject(FETCH_FAILURE_REASONS.ImaScriptFailure)},shouldLogError,"AdManager_ImaIntegrator_unable_to_insert_ima_sdk_script")}})}},{key:"_getImaSdkFromGlobal",value:function(GLOBAL){return GLOBAL.google&&GLOBAL.google.ima}}]),ImaSdkFetchService}();function ImaBidAdaptor_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var ImaBidAdaptor_ImaBidAdaptor=function(_ABaseBidAdaptor){inherits_default()(ImaBidAdaptor,_ABaseBidAdaptor);var _super=ImaBidAdaptor_createSuper(ImaBidAdaptor);function ImaBidAdaptor(settings){var _this;return classCallCheck_default()(this,ImaBidAdaptor),(_this=_super.call(this,settings)).settings=settings,_this._adSlotContainer=null,_this.adMediaType="ima",_this.adSourceType=protos.ProtoAdsourceTypeEnum.Ima,_this._imaSubscriptions=[],_this._adSlotContainer=_this.settings.imaAdSlotContainer,_this._imaVpaidWrapper=new AdImaWrapper_AdImaWrapper(_this.settings.imaSdk,_this.settings.os,_this.settings.imaAdsLoader,_this.settings.url,_this.settings.imaAdsManager,_this.settings.requestAdsContext,_this.settings.adManagerLineItem.protoLineItem.publisherLineItemId),_this}return createClass_default()(ImaBidAdaptor,[{key:"initAd",value:function(width,height,viewMode,desireBitrate,creativeData,environmentVars,volume){var _this2=this;try{get_default()(getPrototypeOf_default()(ImaBidAdaptor.prototype),"initAd",this).call(this,width,height,viewMode,desireBitrate,creativeData,environmentVars,volume),this.settings.adManagerLineItem.protoLineItem.moatTrackingEnabled&&this._insertImaSdkForMoatTracking(),this._imaSubscriptions.push(this._imaVpaidWrapper.onVpaidEvent.subscribe(function(vpaidEvent){_this2._sendVpaidEvent(vpaidEvent)}),this._imaVpaidWrapper.onCreativeReceived.subscribe(function(imaCreativeId){_this2.creativeId=imaCreativeId})),this._imaVpaidWrapper.initAd(width,height,viewMode,desireBitrate,creativeData,{slot:this._$adSlot,videoSlot:this._$videoSlot})}catch(e){this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.AdaptorInitAdError+"_".concat(e.message)}})}}},{key:"startAd",value:function(){try{get_default()(getPrototypeOf_default()(ImaBidAdaptor.prototype),"startAd",this).call(this),this._imaVpaidWrapper.startAd()}catch(e){this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.AdaptorStartAdError+"_".concat(e.message)}})}}},{key:"stopAd",value:function(reason){try{get_default()(getPrototypeOf_default()(ImaBidAdaptor.prototype),"stopAd",this).call(this,reason),this._imaVpaidWrapper.stopAd(reason)}catch(e){this._logVpaidEventError("ImaBidAdaptor","stopAd",e)}}},{key:"resizeAd",value:function(width,height,viewMode){try{this._imaVpaidWrapper.resizeAd(width,height,viewMode)}catch(e){this._logVpaidEventError("ImaBidAdaptor","resizeAd",e)}}},{key:"pauseAd",value:function(){try{this._imaVpaidWrapper.pauseAd()}catch(e){this._logVpaidEventError("ImaBidAdaptor","pauseAd",e)}}},{key:"resumeAd",value:function(){try{this._imaVpaidWrapper.resumeAd()}catch(e){this._logVpaidEventError("ImaBidAdaptor","resumeAd",e)}}},{key:"expandAd",value:function(){try{this._imaVpaidWrapper.expandAd()}catch(e){this._logVpaidEventError("ImaBidAdaptor","expandAd",e)}}},{key:"collapseAd",value:function(){try{this._imaVpaidWrapper.collapseAd()}catch(e){this._logVpaidEventError("ImaBidAdaptor","collapseAd",e)}}},{key:"skipAd",value:function(){try{get_default()(getPrototypeOf_default()(ImaBidAdaptor.prototype),"skipAd",this).call(this),this._imaVpaidWrapper.skipAd()}catch(e){this._logVpaidEventError("ImaBidAdaptor","skipAd",e)}}},{key:"getAdRemainingTime",value:function(){try{return this._imaVpaidWrapper.getAdRemainingTime()}catch(e){return this._logVpaidEventError("ImaBidAdaptor","getAdRemainingTime",e),0}}},{key:"getAdDuration",value:function(){try{return this._imaVpaidWrapper&&this._imaVpaidWrapper.getAdDuration()||this.settings.adManagerLineItem.protoLineItem.duration}catch(e){return this._logVpaidEventError("ImaBidAdaptor","getAdDuration",e),0}}},{key:"getAdVolume",value:function(){try{return this._imaVpaidWrapper.getAdVolume()}catch(e){return this._logVpaidEventError("ImaBidAdaptor","getAdVolume",e),0}}},{key:"getAdMediaSize",value:function(){return{width:this._imaVpaidWrapper.getAdMediaWidth(),height:this._imaVpaidWrapper.getAdMediaHeight()}}},{key:"setAdVolume",value:function(volume){try{get_default()(getPrototypeOf_default()(ImaBidAdaptor.prototype),"setAdVolume",this).call(this,volume),this._imaVpaidWrapper.setAdVolume(volume)}catch(e){this._logVpaidEventError("ImaBidAdaptor","setAdVolume",e)}}},{key:"_getAdImpressionEventData",value:function(vpaidWrapperImpressionEvent){var adImpressionEventData=get_default()(getPrototypeOf_default()(ImaBidAdaptor.prototype),"_getAdImpressionEventData",this).call(this,vpaidWrapperImpressionEvent);return adImpressionEventData.payload.adSourceData.imaMetadata=vpaidWrapperImpressionEvent.payload.imaMetadata,adImpressionEventData}},{key:"_requestAdSlot",value:function(){return this._adSlotContainer}},{key:"_freeAdSlot",value:function(){this.settings.adSlotContainerRecycler.recycleAdSlot(this._adSlotContainer)}},{key:"_insertImaSdkForMoatTracking",value:function(){ImaSdkFetchService_ImaSdkFetchService.fetchImaSdk(this.settings.globalDomUtilsService.getGlobalClosestTop().topFrame,!1)}},{key:"_destroy",value:function(){try{get_default()(getPrototypeOf_default()(ImaBidAdaptor.prototype),"_destroy",this).call(this),clearSubscriptions(this._imaSubscriptions),this._imaVpaidWrapper.destroy()}catch(e){this._logVpaidEventError("ImaBidAdaptor","_destroy",e)}}},{key:"adVideoUrl",get:function(){return this._imaVpaidWrapper.getMediaFile()}},{key:"declaredDurationInSeconds",get:function(){return this._imaVpaidWrapper.getAdDuration()}}]),ImaBidAdaptor}(ABaseBidAdaptor_ABaseBidAdaptor),LOAD_VIDEO_TIMEOUT_SECONDS=25,ImaLoader_ImaLoader=function(){function ImaLoader(_imaSdk,_imaAdsLoader,_width,_height,_adTagUrl,_videoSlot,_pageUrl){var _this=this;classCallCheck_default()(this,ImaLoader),this._imaSdk=_imaSdk,this._imaAdsLoader=_imaAdsLoader,this._width=_width,this._height=_height,this._adTagUrl=_adTagUrl,this._videoSlot=_videoSlot,this._pageUrl=_pageUrl,this._onSuccess=new Subject.a,this._onError=new Subject.a,this._imaRequestAdsContext={id:Object(GeneralUtils.c)()},this._imaAdsManager=null,this._onImaAdError=function(event){if(_this._isEventGeneratedByCurrentRequest(event))switch(event.getError().getErrorCode()){case _this._imaSdk.AdError.ErrorCode.VAST_EMPTY_RESPONSE:_this._triggerError(AdCallRejectionReason.ImaVastEmptyResponse);break;case _this._imaSdk.AdError.ErrorCode.VAST_WRAPPER_ERROR:case _this._imaSdk.AdError.ErrorCode.VAST_MALFORMED_RESPONSE:_this._triggerError(AdCallRejectionReason.ImaInvalidResponse);break;default:_this._triggerError(AdCallRejectionReason.ImaRequestException)}},this._onAdsManagerLoaded=function(event){_this._isEventGeneratedByCurrentRequest(event)&&(_this._imaAdsManager=event.getAdsManager(_this._videoSlot,{loadVideoTimeout:LOAD_VIDEO_TIMEOUT_SECONDS*TimeConfig.f}),_this._removeEventListeners(),_this._onSuccess.next({imaAdsManager:_this._imaAdsManager,requestAdsContext:_this._imaRequestAdsContext}))},this._imaAdsLoader.addEventListener(this._imaSdk.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this._onAdsManagerLoaded),this._imaAdsLoader.addEventListener(this._imaSdk.AdErrorEvent.Type.AD_ERROR,this._onImaAdError)}return createClass_default()(ImaLoader,[{key:"loadAd",value:function(){var imaAdsRequest=new this._imaSdk.AdsRequest;imaAdsRequest.adTagUrl=this._adTagUrl,imaAdsRequest.linearAdSlotWidth=imaAdsRequest.nonLinearAdSlotWidth=this._width,imaAdsRequest.linearAdSlotHeight=imaAdsRequest.nonLinearAdSlotHeight=this._height,imaAdsRequest.pageUrl=this._pageUrl,this._imaAdsLoader.requestAds(imaAdsRequest,this._imaRequestAdsContext)}},{key:"_triggerError",value:function(rejectionReason){this._onError.next(rejectionReason)}},{key:"_removeEventListeners",value:function(){this._imaAdsLoader.removeEventListener(this._imaSdk.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this._onAdsManagerLoaded),this._imaAdsLoader.removeEventListener(this._imaSdk.AdErrorEvent.Type.AD_ERROR,this._onImaAdError)}},{key:"_isEventGeneratedByCurrentRequest",value:function(event){var context=event.getUserRequestContext();return!context||context.id===this._imaRequestAdsContext.id}},{key:"destroy",value:function(){var _a;try{this._removeEventListeners(),null===(_a=this._imaAdsManager)||void 0===_a||_a.destroy()}catch(e){}}},{key:"onSuccess",get:function(){return this._onSuccess.asObservable()}},{key:"onError",get:function(){return this._onError.asObservable()}}]),ImaLoader}(),ImaCallAdaptor_ImaCallAdaptor=function(){function ImaCallAdaptor(settings){classCallCheck_default()(this,ImaCallAdaptor),this.settings=settings,this._resolved=!1,this._imaLoaderSubscriptions=[],this.metrics={created:(new Date).getTime()}}return createClass_default()(ImaCallAdaptor,[{key:"fetchBid",value:function(){var _this=this;this.metrics.fetchStart=(new Date).getTime(),this._imaAdSlotContainer=this.settings.adSlotContainerRecycler.requestAdSlotIma(this.settings.adContainer);var timeoutRejectPromise=new Promise(function(resolve,reject){setTimeout(function(){reject(AdCallRejectionReason.ImaTimeout)},25e3)}),adLoadPromise=this._fetchImaAd(this._imaAdSlotContainer);return Promise.race([adLoadPromise,timeoutRejectPromise]).then(function(bidAdaptor){return _this.metrics.fetchEnd=(new Date).getTime(),_this._resolved=!0,_this._imaLoader&&clearSubscriptions(_this._imaLoaderSubscriptions),bidAdaptor}).catch(function(reason){throw _this.metrics.fetchEnd=(new Date).getTime(),_this._resolved=!0,_this._imaLoader&&(clearSubscriptions(_this._imaLoaderSubscriptions),_this._imaLoader.destroy(),_this.settings.adSlotContainerRecycler.recycleAdSlot(_this._imaAdSlotContainer)),reason})}},{key:"_fetchImaAd",value:function(imaAdSlot){var _this2=this;return imaAdSlot.fetchImaDependencies().then(function(imaDependencies){return _this2._imaDependecies=imaDependencies,_this2._loadImaAd(imaDependencies)}).then(function(imaSuccessPayload){return _this2._createBidAdaptor(imaSuccessPayload)}).catch(function(reason){throw Object(TypeUtils.a)(reason)?reason:AdCallRejectionReason.ImaRequestException})}},{key:"_loadImaAd",value:function(imaDependencies){var _this3=this;return this._resolved?Promise.reject():new Promise(function(resolve,reject){var size=_this3._getSize();_this3._imaLoader=new ImaLoader_ImaLoader(imaDependencies.imaSdk,imaDependencies.imaAdsLoader,size.width,size.height,_this3.settings.url,_this3._imaAdSlotContainer.videoSlot,_this3.settings.pageUrl),_this3._imaLoaderSubscriptions.push(_this3._imaLoader.onSuccess.subscribe(function(successPayload){resolve(successPayload)}),_this3._imaLoader.onError.subscribe(function(reason){reject(reason)})),_this3._imaLoader.loadAd()})}},{key:"_getSize",value:function(){return this.settings.callingState.adContainerState.get(this.settings.adManagerLineItem.protoLineItem.adType)}},{key:"_createBidAdaptor",value:function(imaLoadedPayload){return new ImaBidAdaptor_ImaBidAdaptor({id:this.settings.id,adManagerLineItem:this.settings.adManagerLineItem,trackers:this.settings.trackersInformation,url:this.settings.url,requestMetadata:this.settings.requestMetadata,callingState:this.settings.callingState,adContainer:this.settings.adContainer,globalDomUtilsService:this.settings.globalDomUtilsService,viewabilityService:this.settings.viewabilityService,cpm:this.settings.cpm,obfuscatedPrice:this.settings.obfuscatedPrice,adEnforcer:this.settings.adEnforcer,successRate:this.settings.successRate,os:this.settings.os,adSlotContainerRecycler:this.settings.adSlotContainerRecycler,externalCreativeId:this.settings.creativeId,imaSdk:this._imaDependecies.imaSdk,imaAdsLoader:this._imaDependecies.imaAdsLoader,imaAdsManager:imaLoadedPayload.imaAdsManager,requestAdsContext:imaLoadedPayload.requestAdsContext,imaAdSlotContainer:this._imaAdSlotContainer,bidSlotId:this.settings.bidSlotId,pageUrl:this.settings.pageUrl,urlSuffixerService:this.settings.urlSuffixerService})}}]),ImaCallAdaptor}();function getBestMediaFile(mediaFiles,width){mediaFiles.sort(function(a,b){return a.width===b.width?a.bitrate-b.bitrate:a.width-b.width});for(var i=0;i<mediaFiles.length;i++)if(mediaFiles[i].width>=width)return mediaFiles[i-1]||mediaFiles[i];return mediaFiles[mediaFiles.length-1]}var AdUtils_generateBidSlotId=function(){return"cnx_bid_slot_".concat(Object(GeneralUtils.c)())},hls=__webpack_require__(24),isHlsMediaSourceExtensionSupported=hls&&hls.isSupported(),hasBuiltInHlsSupport=function(videoTag){return videoTag.canPlayType("application/vnd.apple.mpegurl")},HLS_CONFIG={enableWorker:!1,capLevelToPlayerSize:!0,cnxRenderWindow:window,maxBufferSize:5e6,maxBufferLength:5,maxMaxBufferLength:10,liveBackBufferLength:0},HlsAdSourceHandler_HlsAdSourceHandler=function(){function HlsAdSourceHandler(_hlsSource,_videoTag,_globalDomUtilsService,_adHlsConfig){var _this=this;classCallCheck_default()(this,HlsAdSourceHandler),this._hlsSource=_hlsSource,this._videoTag=_videoTag,this._globalDomUtilsService=_globalDomUtilsService,this._adHlsConfig=_adHlsConfig,this._availableQualityList=[],this._handleHlsSDKErrors=function(event,data){if(data.fatal)switch(data.type){case hls.ErrorTypes.NETWORK_ERROR:if(data.details===hls.ErrorDetails.MANIFEST_PARSING_ERROR||data.details===hls.ErrorDetails.MANIFEST_LOAD_ERROR)return void _this._hlsFailedCallback();_this._hlsSDK.startLoad();break;case hls.ErrorTypes.MEDIA_ERROR:_this._hlsSDK.recoverMediaError();break;default:_this._hlsFailedCallback()}},this._hlsSDKMediaAttached=function(){_this._hlsSDK.off(hls.Events.MEDIA_ATTACHED,_this._hlsSDKMediaAttached),_this._hlsSDK.loadSource(_this._hlsSource),_this._hlsSDK.once(hls.Events.MANIFEST_PARSED,_this._hlsSDKManifestParsed)},this._hlsSDKManifestParsed=function(){_this._hlsSDK.off(hls.Events.MANIFEST_PARSED,_this._hlsSDKManifestParsed),_this._updateAvailableQualityAfterManifestParsed(),_this._adHlsConfig.forceMaxLevel&&_this._setMaxLevel(),_this._adHlsConfig.forceResolutionHeight&&_this._setLevelAtResolution(_this._adHlsConfig.forceResolutionHeight),_this._hlsSuccessCallback()},(this._adHlsConfig.forceMaxLevel||this._adHlsConfig.forceResolutionHeight)&&(HLS_CONFIG.capLevelToPlayerSize=!1)}return createClass_default()(HlsAdSourceHandler,[{key:"start",value:function(hlsSuccessCallback,hlsFailedCallback){this._hlsSuccessCallback=hlsSuccessCallback,this._hlsFailedCallback=hlsFailedCallback,isHlsMediaSourceExtensionSupported?(this._hlsSDK=this._globalDomUtilsService.initHls(HLS_CONFIG),this._attachMedia()):this._hlsFailedCallback()}},{key:"destroy",value:function(){this._hlsSDK&&(this._hlsSDK.destroy(),this._hlsSDK=null)}},{key:"_attachMedia",value:function(){this._hlsSDK.on(hls.Events.ERROR,this._handleHlsSDKErrors),this._hlsSDK.attachMedia(this._videoTag),this._hlsSDK.once(hls.Events.MEDIA_ATTACHED,this._hlsSDKMediaAttached)}},{key:"_setMaxLevel",value:function(){var maxLevel=this._hlsSDK.levels.length-1;this._setLevel(maxLevel)}},{key:"_setLevelAtResolution",value:function(resolutionHeight){var currentRes=this._availableQualityList.find(function(quality){return quality.height===resolutionHeight});currentRes&&this._setLevel(currentRes.level)}},{key:"_setLevel",value:function(level){this._hlsSDK.currentLevel=level,this._hlsSDK.startLevel=level,this._hlsSDK.nextLevel=level}},{key:"_updateAvailableQualityAfterManifestParsed",value:function(){var _this2=this;this._hlsSDK.levels.forEach(function(level,index){_this2._availableQualityList.push({level:index,height:level.height})})}}]),HlsAdSourceHandler}(),PageFocusService=__webpack_require__(97);function AdVideoWrapper_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AdErrorReason,BUZZFEED_DOMAIN_FORCED_RESOLUTION_domain="huffpost",BUZZFEED_DOMAIN_FORCED_RESOLUTION_resolutionHeight=540,AdVideoWrapper_AdVideoWrapper=function(_AVpaidEventDispatche){inherits_default()(AdVideoWrapper,_AVpaidEventDispatche);var _super=AdVideoWrapper_createSuper(AdVideoWrapper);function AdVideoWrapper(_globalDomUtils,_src,_videoSlot,_os,_clickUrl,_loopAdWhenFinished,_pauseAdWhenFinished,_isHlsSource){var _this,_blockVideoTagResume=arguments.length>8&&void 0!==arguments[8]&&arguments[8],_pageDomain=arguments.length>9?arguments[9]:void 0;return classCallCheck_default()(this,AdVideoWrapper),(_this=_super.call(this))._globalDomUtils=_globalDomUtils,_this._src=_src,_this._videoSlot=_videoSlot,_this._os=_os,_this._clickUrl=_clickUrl,_this._loopAdWhenFinished=_loopAdWhenFinished,_this._pauseAdWhenFinished=_pauseAdWhenFinished,_this._isHlsSource=_isHlsSource,_this._blockVideoTagResume=_blockVideoTagResume,_this._pageDomain=_pageDomain,_this._videoLoaded=!1,_this.pageFocus=new PageFocusService.a(_this._globalDomUtils),_this._videoEvents=Object(ObjectUtils.a)(VideoTagEvents),_this._playAllowed=!1,_this._shouldRestrictPause=!0,_this._adVideoComplete=!1,_this._quartileEventVpaidMapping=[{event:VastConfig.b.AdVideoStart,position:0},{event:VastConfig.b.AdVideoFirstQuartile,position:25},{event:VastConfig.b.AdVideoMidpoint,position:50},{event:VastConfig.b.AdVideoThirdQuartile,position:75},{event:VastConfig.b.AdVideoComplete,position:100}],_this._nextQuartilePosition=_this._quartileEventVpaidMapping[0],_this._onVideoEvent=function(event){try{switch(event.type){case VideoTagEvents.Pause:if(_this._loopAdWhenFinished&&!_this._shouldRestrictPause)return void(_this._shouldRestrictPause=!0);_this._playAllowed=!1;break;case VideoTagEvents.Play:if(!_this._playAllowed&&_this._blockVideoTagResume)return void _this._videoSlot.pause();break;case VideoTagEvents.Canplay:case VideoTagEvents.Durationchange:_this._sendAdLoadedEvent();break;case VideoTagEvents.Timeupdate:_this._handleTimeUpdateEvent();break;case VideoTagEvents.Error:_this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.VastVideoTagEventError}});break;case"click":_this._onVpaidEvent.next({type:VastConfig.b.AdClickThru,payload:{}})}}catch(e){Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,callStack:e.stack,message:"AdManager_VastIntegrator_onVideoEvent",exception:e.message,throttle:10,sendMaxLog:!1})}},_this}return createClass_default()(AdVideoWrapper,[{key:"initAd",value:function(width,height,viewMode,desireBitrate,creativeData,environmentVars){try{this._videoSlot=environmentVars.videoSlot,this.width=width,this.height=height,this._addClickThrough(this._clickUrl,this._videoSlot.parentElement),this.resizeAd(width,height,viewMode),this.addVideoEvents(this._videoSlot),this._isHlsSource&&isHlsMediaSourceExtensionSupported?this._addHlsSourceHandler():(this._videoSlot.setAttribute("src",this._src),this._videoSlot.setAttribute("preload","metadata"),this._videoSlot.load()),this.pageFocus.isDocumentVisible()||this._sendAdLoadedEvent()}catch(e){this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.WrapperInitAdError+"_".concat(e.message)}})}}},{key:"startAd",value:function(){var _this2=this;try{Object(DomUtils.a)(this._videoSlot,"cnx-ad-video-slot"),this._playAllowed=!0,this.pageFocus.isDocumentVisible()?this._videoSlot.play().then(function(){_this2._onVpaidEvent.next({type:VastConfig.b.AdStarted}),_this2._onVpaidEvent.next({type:VastConfig.b.AdImpression,payload:{}})}).catch(function(message){_this2._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.VastPlayPromiseReject}})}):(this._onVpaidEvent.next({type:VastConfig.b.AdStarted}),this._onVpaidEvent.next({type:VastConfig.b.AdImpression,payload:{}}),this._videoSlot.play())}catch(e){this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.WrapperStartAdError+"_".concat(e.message)}})}}},{key:"stopAd",value:function(reason){this._blockVideoTagResume&&this._videoSlot.pause(),"videoComplete"===reason&&this._loopAdWhenFinished?this._onVpaidEvent.next({type:VastConfig.b.AdStopped,payload:{shouldTrackPostBid:!1}}):this._onVpaidEvent.next({type:VastConfig.b.AdStopped,payload:{shouldTrackPostBid:!0}})}},{key:"resizeAd",value:function(width,height,viewMode){Object(DomUtils.Q)(this._videoSlot,{width:"".concat(width,"px"),height:"".concat(height,"px")}),this._onVpaidEvent.next({type:VastConfig.b.AdSizeChange})}},{key:"pauseAd",value:function(){this._playAllowed=!1,this._pauseAdWhenFinished&&void 0===this._nextQuartilePosition&&(this._nextQuartilePosition=this._quartileEventVpaidMapping[0]),this._videoSlot.pause(),this._onVpaidEvent.next({type:VastConfig.b.AdPaused})}},{key:"resumeAd",value:function(){this._loopAdWhenFinished&&void 0===this._nextQuartilePosition&&(this._nextQuartilePosition=this._quartileEventVpaidMapping[0]),this._playAllowed=!0,this._videoSlot.play(),this._os===OsConfig.b.Ios&&Object(DomUtils.C)(this._videoSlot),this._onVpaidEvent.next({type:VastConfig.b.AdPlaying})}},{key:"expandAd",value:function(){}},{key:"collapseAd",value:function(){}},{key:"skipAd",value:function(){this._onVpaidEvent.next({type:VastConfig.b.AdSkipped})}},{key:"getAdRemainingTime",value:function(){return this._videoSlot.duration-this._videoSlot.currentTime}},{key:"getAdDuration",value:function(){return this._videoSlot.duration?this._videoSlot.duration:0}},{key:"getAdVolume",value:function(){return this._videoSlot.volume}},{key:"setAdVolume",value:function(volume){this._videoSlot.volume=volume}},{key:"getAdMediaWidth",value:function(){return this._videoSlot.videoWidth}},{key:"getAdMediaHeight",value:function(){return this._videoSlot.videoHeight}},{key:"destroy",value:function(){if(!this._pauseAdWhenFinished&&!this._loopAdWhenFinished)try{Object(DomUtils.L)(this._videoSlot,"cnx-ad-video-slot"),this._removeVideoEvents(this._videoSlot),this._videoSlot.removeAttribute("src"),this._hlsSourceHandler&&(this._hlsSourceHandler.destroy(),this._hlsSourceHandler=null)}catch(e){Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.WARNING,message:"AdManager_VastIntegrator_destroyAd",exception:e.message,callStack:e.stack})}}},{key:"_addHlsSourceHandler",value:function(){var _this3=this,hlsConfig={forceMaxLevel:!0};this._pageDomain&&this._pageDomain.indexOf(BUZZFEED_DOMAIN_FORCED_RESOLUTION_domain)>-1&&(hlsConfig={forceMaxLevel:!1,forceResolutionHeight:BUZZFEED_DOMAIN_FORCED_RESOLUTION_resolutionHeight}),this._hlsSourceHandler=new HlsAdSourceHandler_HlsAdSourceHandler(this._src,this._videoSlot,this._globalDomUtils,hlsConfig),this._hlsSourceHandler.start(function(){_this3._sendAdLoadedEvent()},function(){_this3._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.CnxMediaSrcNotSupported}})})}},{key:"_addClickThrough",value:function(clickThroughUrl,container){this._clickThroughSlot=this._globalDomUtils.createElement("a"),clickThroughUrl&&(this._clickThroughSlot.href=clickThroughUrl,this._clickThroughSlot.target="_blank"),Object(DomUtils.a)(this._clickThroughSlot,"cnx-ad-slot"),container.appendChild(this._clickThroughSlot),this._clickThroughSlot.addEventListener("click",this._onVideoEvent)}},{key:"addVideoEvents",value:function(videoSlot){var _this4=this;this._videoEvents.forEach(function(event){videoSlot.addEventListener(event,_this4._onVideoEvent)}),this._clickThroughSlot&&this._clickThroughSlot.addEventListener("click",this._onVideoEvent)}},{key:"_removeVideoEvents",value:function(videoSlot){var _this5=this;this._videoEvents.forEach(function(event){videoSlot.removeEventListener(event,_this5._onVideoEvent)}),this._clickThroughSlot&&this._clickThroughSlot.removeEventListener("click",this._onVideoEvent)}},{key:"_sendAdLoadedEvent",value:function(){this._videoLoaded||(this._videoLoaded=!0,this._onVpaidEvent.next({type:VastConfig.b.AdLoaded,payload:{}}))}},{key:"_handleTimeUpdateEvent",value:function(){this._onVpaidEvent.next({type:VastConfig.b.AdRemainingTimeChange});var percentPlayed=Object(NumberUtils.g)(0,this._videoSlot.duration,0,100,this._videoSlot.currentTime);if(this._nextQuartilePosition&&percentPlayed>=this._nextQuartilePosition.position){this._adVideoComplete||this._onVpaidEvent.next({type:this._nextQuartilePosition.event});var currentQuartile=this._nextQuartilePosition;this._nextQuartilePosition=this._quartileEventVpaidMapping[this._quartileEventVpaidMapping.indexOf(this._nextQuartilePosition)+1],currentQuartile.event===VastConfig.b.AdVideoComplete&&(this._shouldRestrictPause=!1,this.stopAd("videoComplete"),this._adVideoComplete=!0)}}}]),AdVideoWrapper}(AVpaidEventDispatcher_AVpaidEventDispatcher),helpers_typeof=__webpack_require__(52),typeof_default=__webpack_require__.n(helpers_typeof);!function(AdErrorReason){AdErrorReason.errorIframe="Error creating iframe"}(AdErrorReason||(AdErrorReason={}));var mandatoryVpaidMethods,proxyJsScript="\n    window.".concat("cnxProxyTask"," = function(task) {\n        setTimeout(function(){\n            task();\n        }, 0);\n    }\n"),ProxyTaskRunnerService_ProxyTaskRunnerService=function(){function ProxyTaskRunnerService(){classCallCheck_default()(this,ProxyTaskRunnerService)}return createClass_default()(ProxyTaskRunnerService,null,[{key:"executeAsync",value:function(context,task){this._getProxy(context)(task)}},{key:"_isProxyScriptDeployed",value:function(context){return!!context.cnxProxyTask}},{key:"_getProxy",value:function(context){return this._isProxyScriptDeployed(context)||this._deployProxyScript(context),context.cnxProxyTask}},{key:"_deployProxyScript",value:function(context){var head=context.document.head;Object(DomUtils.z)(head,context,proxyJsScript)}}]),ProxyTaskRunnerService}(),IframeLoader_IframeLoader=function(){function IframeLoader(_globalDomUtils,_trackingService,_GLOBAL){classCallCheck_default()(this,IframeLoader),this._globalDomUtils=_globalDomUtils,this._trackingService=_trackingService,this._GLOBAL=_GLOBAL}return createClass_default()(IframeLoader,[{key:"_getSetIframeContentCallback",value:function(template,macros,handleIframe){var _this=this,wasCalled=!1;return function(iframe){iframe.contentWindow&&!wasCalled&&(wasCalled=!0,_this._setIframeContent(iframe,_this._addMacrosToTemplate(template,macros),handleIframe))}}},{key:"_createIframeWithContent",value:function(container,template,macros,cb,GLOBAL){return this._createFriendlyIframe(container,this._getSetIframeContentCallback(template,macros,cb),GLOBAL)}},{key:"_createFriendlyIframe",value:function(container,onLoadIframe,GLOBAL){var iframeEl=this._globalDomUtils.createElement("iframe",GLOBAL);return iframeEl.allow="autoplay",iframeEl.src="javascript:false",iframeEl.srcdoc="",iframeEl.width="100%",iframeEl.height="100%",iframeEl.style.position="absolute",iframeEl.style.left="0",iframeEl.style.top="0",iframeEl.style.margin="0px",iframeEl.style.padding="0px",iframeEl.style.border="0px",iframeEl.style.width="100%",iframeEl.style.height="100%",iframeEl.setAttribute("SCROLLING","NO"),iframeEl.onload=function(){onLoadIframe(iframeEl)},container.appendChild(iframeEl),onLoadIframe(iframeEl),iframeEl}},{key:"_setIframeContent",value:function(iframeEl,template,handleIframe){var _this2=this,iframeParentWindow=Object(DomUtils.t)(iframeEl);ProxyTaskRunnerService_ProxyTaskRunnerService.executeAsync(iframeParentWindow,function(){try{var iframeDoc=iframeEl.contentWindow&&iframeEl.contentWindow.document;iframeDoc.open(),iframeDoc.write(template)}catch(e){_this2._handleError(iframeEl,e),iframeEl=null}handleIframe(iframeEl)})}},{key:"_addMacrosToTemplate",value:function(template,macros){return Object.keys(macros).forEach(function(key){var value;value="object"===typeof_default()(value)?JSON.stringify(macros[key]):macros[key],template=template.replace(new RegExp("{{".concat(key,"}}"),"g"),value)}),template}},{key:"loadIframe",value:function(settings){var _this3=this,iframeTemplate='<!DOCTYPE html><html lang="en"><head>'+(settings.customHead?settings.customHead:"")+'<meta charset="UTF-8"></head><body style="margin:0;padding:0">'+(settings.customHtml?settings.customHtml:"")+'<script type="text/javascript">window.postMessage(\'{"event": "ready", "id": "{{iframeID}}"}\', \'*\');<\/script></body></html>',iframeId="cnx-iframe_"+Object(GeneralUtils.c)();return new Promise(function(resolve,reject){_this3._frame=_this3._createIframeWithContent(settings.container,iframeTemplate,{iframeID:iframeId},function(iframe){if(null!==iframe)try{iframe.contentWindow.addEventListener("message",function onMessageReceived(e){var result;try{result=JSON.parse(e.data)}catch(err){return}result.id===iframeId&&(iframe.contentWindow?(iframe.contentWindow.document.close(),iframe.contentWindow.removeEventListener("message",onMessageReceived),resolve({iframe:iframe})):reject("The Iframe is no longer in the DOM"))});var _settings$customRepor=settings.customReportingLog,advertiserLineItemId=_settings$customRepor.advertiserLineItemId,heavyAdBlockTypeEnum=_settings$customRepor.heavyAdBlockTypeEnum;_this3._reportingObserver=new ReportingObserverWrapper_ReportingObserverWrapper(_this3._frame.contentWindow,_this3._trackingService,{advertiserLineItemId:advertiserLineItemId,heavyAdBlockTypeEnum:heavyAdBlockTypeEnum})}catch(e){_this3._handleError(iframe,e),reject("Iframe callback error")}else reject(AdErrorReason.errorIframe)},_this3._GLOBAL)})}},{key:"destroy",value:function(){this._reportingObserver.destroy(),this._frame=null}},{key:"_handleError",value:function(iframeEl,error){this._globalDomUtils.isDetachedFromDOM(iframeEl)?Object(Logging.a)({message:"iframeLoader_(inDom_false)",exception:error.message,callStack:error.stack,level:protos.ProtoLoggingLevelEnum.WARNING,sendMaxLog:!1,throttle:1}):Object(Logging.a)({message:"iframeLoader_(inDom_true)",exception:error.message,callStack:error.stack,level:protos.ProtoLoggingLevelEnum.WARNING,logJsonState:!0,sendMaxLog:!1,throttle:1}),Object(DomUtils.M)(iframeEl)}},{key:"iframe",get:function(){return this._frame}}]),IframeLoader}(),VPAIDClient_VPAIDClient=function(){function VPAIDClient(_adTag,_globalDomUtils,_trackingService,_appId,_advertiserLineItemId){classCallCheck_default()(this,VPAIDClient),this._adTag=_adTag,this._globalDomUtils=_globalDomUtils,this._trackingService=_trackingService,this._appId=_appId,this._advertiserLineItemId=_advertiserLineItemId,this._iframeSettings={bodyTamplate:'<div class="ad-element" id="cnx-ad-element"></div><script type="text/javascript" src="'.concat(this._adTag,"\"><\/script>'\n        <script type=\"text/javascript\">\n            window.Object.defineProperty(Object.prototype, 'cnxInnerTag', { enumerable: !1, writable: !0, value: '").concat(this._appId,"' });\n            window.Object.defineProperty(Function.prototype, 'cnxInnerTag',\n            { enumerable: !1, writable: !0, value: '").concat(this._appId,"' });\n            cnxtimeouts = [];\n            cnxintervals = [];\n            oldSetTimeout = setTimeout;\n            setTimeout = function (e, t) { var n = oldSetTimeout.apply(null, arguments); return cnxtimeouts.push(n), n };\n            oldSetInterval = setInterval;\n            setInterval = function (e, t) { var n = oldSetInterval.apply(null, arguments); return cnxintervals.push(n), n };\n            clearAll = function () {\n                setTimeout = function () { };\n                setInterval = function () { };\n                for (var e = 0; e < cnxtimeouts.length; e++) {\n                    clearTimeout(cnxtimeouts[e]);\n                }\n                for (e = 0; e < cnxintervals.length; e++) {\n                    clearInterval(cnxintervals[e]);\n                }\n            };\n        <\/script>"),headTamplate:" <style>\n            html,\n            body,\n            .ad-element {\n                width: 100%;\n                height: 100%;\n            }\n            </style>"},this._iframeLoader=new IframeLoader_IframeLoader(this._globalDomUtils,this._trackingService)}return createClass_default()(VPAIDClient,[{key:"_loadIframeData",value:function(container){return this._iframeLoader.loadIframe({customHead:this._iframeSettings.headTamplate,customHtml:this._iframeSettings.bodyTamplate,container:container,customReportingLog:{heavyAdBlockTypeEnum:protos.ProtoHeavyAdBlockTypeEnum.VpaidIframe,advertiserLineItemId:this._advertiserLineItemId}})}},{key:"loadAdUnitIframe",value:function(container){var _this=this;return new Promise(function(resolve,rejects){_this._loadIframeData(container).then(function(iframeData){iframeData.adContainer=iframeData.iframe.contentWindow.document.querySelector(".ad-element"),resolve(iframeData)}).catch(function(reason){rejects(reason)})})}},{key:"destroyAdUnit",value:function(){var _a,_b;try{var clearAll=this._iframeLoader.iframe.contentWindow.clearAll;clearAll&&clearAll()}catch(e){Object(Logging.a)({message:"AdManager_VPAIClient_destroyAdUnit",exception:null===(_a=e)||void 0===_a?void 0:_a.message,callStack:null===(_b=e)||void 0===_b?void 0:_b.stack,level:protos.ProtoLoggingLevelEnum.WARNING,throttle:2,sendMaxLog:!0})}this._iframeLoader.destroy(),this._iframeLoader=null}}]),VPAIDClient}();function AdVpaidWrapper_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}!function(mandatoryVpaidMethods){mandatoryVpaidMethods[mandatoryVpaidMethods.handshakeVersion=0]="handshakeVersion",mandatoryVpaidMethods[mandatoryVpaidMethods.initAd=1]="initAd",mandatoryVpaidMethods[mandatoryVpaidMethods.startAd=2]="startAd",mandatoryVpaidMethods[mandatoryVpaidMethods.stopAd=3]="stopAd",mandatoryVpaidMethods[mandatoryVpaidMethods.skipAd=4]="skipAd",mandatoryVpaidMethods[mandatoryVpaidMethods.resizeAd=5]="resizeAd",mandatoryVpaidMethods[mandatoryVpaidMethods.pauseAd=6]="pauseAd",mandatoryVpaidMethods[mandatoryVpaidMethods.resumeAd=7]="resumeAd",mandatoryVpaidMethods[mandatoryVpaidMethods.expandAd=8]="expandAd",mandatoryVpaidMethods[mandatoryVpaidMethods.collapseAd=9]="collapseAd",mandatoryVpaidMethods[mandatoryVpaidMethods.subscribe=10]="subscribe",mandatoryVpaidMethods[mandatoryVpaidMethods.unsubscribe=11]="unsubscribe"}(mandatoryVpaidMethods||(mandatoryVpaidMethods={}));var AdVpaidWrapper_AdVpaidWrapper=function(_AVpaidEventDispatche){inherits_default()(AdVpaidWrapper,_AVpaidEventDispatche);var _super=AdVpaidWrapper_createSuper(AdVpaidWrapper);function AdVpaidWrapper(_src,_globalDomUtils,_trackingService,_uniqueReferenceId,_advertiserLineItemId,_creativeId,_os){var _this;return classCallCheck_default()(this,AdVpaidWrapper),(_this=_super.call(this))._src=_src,_this._globalDomUtils=_globalDomUtils,_this._trackingService=_trackingService,_this._uniqueReferenceId=_uniqueReferenceId,_this._advertiserLineItemId=_advertiserLineItemId,_this._creativeId=_creativeId,_this._os=_os,_this._subscribers=[],_this._blockedVpaidEvents=new Set,_this._receivedVpaidEvents=new Set,_this._clickThroughHandler=function(url,id,playerHandles){var data={url:url,playerHandles:playerHandles};_this._handleThirdPartyVpaidEvent(VastConfig.b.AdClickThru,data)},_this._handleThirdPartyVpaidEvent=function(type,data){if(_this._receivedVpaidEvents.add(type),!_this._blockedVpaidEvents.has(type))return type!==VastConfig.b.AdImpression||_this._receivedVpaidEvents.has(VastConfig.b.AdLoaded)?void _this._dispatchVpaidEvent(type,data):(Object(Logging.a)({message:"AdManager_AdVpaidWrapper_ImpressionBeforeAdLoaded",exception:"advertiserLineItemId:".concat(_this._advertiserLineItemId,"_creativeId:").concat(_this._creativeId,"_vpaidSrc:").concat(_this._src),callStack:JSON.stringify(Object(ArrayUtils.d)(_this._receivedVpaidEvents)),throttle:1e3,level:protos.ProtoLoggingLevelEnum.WARNING,sendMaxLog:!0}),_this._blockedVpaidEvents.add(VastConfig.b.AdLoaded),void _this._dispatchVpaidEvent(VastConfig.b.AdLoaded,data))},_this._dispatchVpaidEvent=function(type,data){switch(type){case VastConfig.b.AdError:_this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:Object(TypeUtils.g)(data)?data:JSON.stringify(data)}});break;case VastConfig.b.AdLoaded:_this._onVpaidEvent.next({type:VastConfig.b.AdLoaded,payload:{skipOffset:Object(TypeUtils.f)(data)?data.skipOffset:void 0}});break;case VastConfig.b.AdImpression:_this._onVpaidEvent.next({type:VastConfig.b.AdImpression,payload:{}});break;case VastConfig.b.AdClickThru:_this._onVpaidEvent.next({type:VastConfig.b.AdClickThru,payload:Object(TypeUtils.f)(data)?data:{}});break;default:_this._onVpaidEvent.next({type:VastConfig.b[type]})}},_this}return createClass_default()(AdVpaidWrapper,[{key:"initAd",value:function(width,height,viewMode,desireBitrate,creativeData,environmentVars){var _this2=this;try{this._width=width,this._height=height,this._viewMode=viewMode,this._desireBitrate=desireBitrate,this._creativeData=creativeData,this._environmentVars=environmentVars,this._vpaidClient=new VPAIDClient_VPAIDClient(this._src,this._globalDomUtils,this._trackingService,this._uniqueReferenceId,this._advertiserLineItemId),this._adUnitLoadPromise=this._vpaidClient.loadAdUnitIframe(environmentVars.slot).then(function(elem){_this2._adUnitLoaded(elem)}).catch(function(reason){_this2._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.VpaidOnLoad}})})}catch(e){this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.VpaidOnLoad}})}}},{key:"startAd",value:function(){try{this._receivedVpaidEvents.has(VastConfig.b.AdImpression)&&!this._blockedVpaidEvents.has(VastConfig.b.AdImpression)&&(Object(Logging.a)({message:"AdManager_AdVpaidWrapper_brokenImpressionHandle",exception:"advertiserLineItemId:".concat(this._advertiserLineItemId,"_creativeId:").concat(this._creativeId,"_vpaidSrc:").concat(this._src),callStack:JSON.stringify(Object(ArrayUtils.d)(this._receivedVpaidEvents)),throttle:1e3,level:protos.ProtoLoggingLevelEnum.WARNING,sendMaxLog:!0}),this._blockedVpaidEvents.add(VastConfig.b.AdImpression),this._onVpaidEvent.next({type:VastConfig.b.AdImpression,payload:{}})),this._vpaidAdObject.startAd()}catch(e){this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.WrapperStartAdError}})}}},{key:"stopAd",value:function(reason){var _a,_this3=this;null===(_a=this._adUnitLoadPromise)||void 0===_a||_a.then(function(){_this3._vpaidAdObject?_this3._vpaidAdObject.stopAd(reason):Object(Logging.a)({message:"stopAd",exception:reason,level:protos.ProtoLoggingLevelEnum.WARNING})})}},{key:"resizeAd",value:function(width,height,viewMode){this._vpaidAdObject.resizeAd(width,height,viewMode)}},{key:"pauseAd",value:function(){this._vpaidAdObject.pauseAd()}},{key:"resumeAd",value:function(){this._vpaidAdObject.resumeAd(),this._os===OsConfig.b.Ios&&Object(DomUtils.C)(this._environmentVars.videoSlot)}},{key:"expandAd",value:function(){this._vpaidAdObject.expandAd()}},{key:"collapseAd",value:function(){this._vpaidAdObject.collapseAd()}},{key:"skipAd",value:function(){this._vpaidAdObject.skipAd()}},{key:"getAdRemainingTime",value:function(){return this._vpaidAdObject.getAdRemainingTime()}},{key:"getAdDuration",value:function(){var _a;return null===(_a=this._vpaidAdObject)||void 0===_a?void 0:_a.getAdDuration()}},{key:"getAdVolume",value:function(){return this._vpaidAdObject.getAdVolume()}},{key:"setAdVolume",value:function(volume){this._vpaidAdObject.setAdVolume(volume)}},{key:"destroy",value:function(){var _a;this._unsubscribeFromAllVpaidEvents(),this._subscribers.length=0,this._vpaidAdObject=null,null===(_a=this._vpaidClient)||void 0===_a||_a.destroyAdUnit()}},{key:"_adUnitLoaded",value:function(iframeLoaderOutput){var createAd=iframeLoaderOutput.iframe.contentWindow.getVPAIDAd;if("function"==typeof createAd){var vpaidAdObject=createAd();this._vpaidAdObject=vpaidAdObject,this._subscribeToVpaidEvents(),this._checkVPAIDInteface(vpaidAdObject)?vpaidAdObject.initAd(this._width,this._height,this._viewMode,this._desireBitrate,this._creativeData,{slot:iframeLoaderOutput.adContainer,videoSlot:this._environmentVars.videoSlot}):this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.VpaidInvalid}})}else this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.VpaidGetVpaidAdError}})}},{key:"_subscribeToVpaidEvents",value:function(){var _this4=this;Object.keys(VastConfig.b).forEach(function(vpaidEventKey){var callback=_this4._handleThirdPartyVpaidEvent.bind(_this4,VastConfig.b[vpaidEventKey]);VastConfig.b[vpaidEventKey]===VastConfig.b.AdClickThru&&(callback=_this4._clickThroughHandler),_this4._subscribers.push({handler:callback,event:vpaidEventKey}),_this4._vpaidAdObject.subscribe(callback,vpaidEventKey)})}},{key:"_unsubscribeFromAllVpaidEvents",value:function(){var _this5=this;this._subscribers.forEach(function(sub){_this5._vpaidAdObject.unsubscribe(sub.handler,sub.event)})}},{key:"_checkVPAIDInteface",value:function(VPAIDCreative){return Object.keys(Object(ArrayUtils.f)(mandatoryVpaidMethods)).every(function(key){return Object(TypeUtils.b)(VPAIDCreative[mandatoryVpaidMethods[key]])})}}]),AdVpaidWrapper}(AVpaidEventDispatcher_AVpaidEventDispatcher);function VastBidAdaptor_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var XMLUtils,VastBidAdaptor_VastBidAdaptor=function(_ABaseBidAdaptor){inherits_default()(VastBidAdaptor,_ABaseBidAdaptor);var _super=VastBidAdaptor_createSuper(VastBidAdaptor);function VastBidAdaptor(settings){var _this;return classCallCheck_default()(this,VastBidAdaptor),(_this=_super.call(this,settings)).settings=settings,_this.adSourceType=protos.ProtoAdsourceTypeEnum.Unknown,_this._vastSubscriptions=[],_this.creativeId=settings.vastResponse.creativeId,_this}return createClass_default()(VastBidAdaptor,[{key:"initAd",value:function(width,height,viewMode,desireBitrate,creativeData,environmentVars,volume){var _this2=this;try{get_default()(getPrototypeOf_default()(VastBidAdaptor.prototype),"initAd",this).call(this,width,height,viewMode,desireBitrate,creativeData,environmentVars,volume),Object(AdDomainBlockingService.b)(this.settings.adManagerLineItem.protoLineItem.publisherLineItemId,this.settings.vastResponse.clickThrough).then(function(blocked){if(blocked)_this2._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.DomainBlocked}});else if(_this2._currentMediaFile=_this2._getBestMedia(width,_this2._$videoSlot),null!==_this2._currentMediaFile){_this2.adMediaType=_this2._currentMediaFile.type,_this2._currentMediaFile.getMediaFileType()===MonetisationConfig.d.Video?(_this2._vpaidBridge=new AdVideoWrapper_AdVideoWrapper(_this2.settings.globalDomUtilsService,_this2._currentMediaFile.src,_this2._$videoSlot,_this2.settings.os,_this2.settings.vastResponse.clickThrough,_this2.settings.loopAdWhenFinished),_this2.adSourceType=protos.ProtoAdsourceTypeEnum.VastMedia):(_this2._vpaidBridge=new AdVpaidWrapper_AdVpaidWrapper(_this2._currentMediaFile.src,_this2.settings.globalDomUtilsService,_this2.settings.trackingService,_this2._adSlotId,_this2.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,_this2.creativeId,_this2.settings.os),_this2.adSourceType=protos.ProtoAdsourceTypeEnum.Vpaid),_this2._vastSubscriptions.push(_this2._vpaidBridge.onVpaidEvent.subscribe(function(vpaidEvent){if(vpaidEvent.type===VastConfig.b.AdLoaded&&(vpaidEvent.payload.skipOffset=_this2.settings.vastResponse.skipoffset),vpaidEvent.type===VastConfig.b.AdClickThru){_this2._vpaidClickThroughEventUrl=vpaidEvent.payload.url;var url=vpaidEvent.payload.url||_this2.settings.vastResponse.clickThrough;url&&vpaidEvent.payload.playerHandles&&_this2.settings.globalDomUtilsService.open(url,BrowserConfig.c.Blank)}_this2._sendVpaidEvent(vpaidEvent)}));var vastResponseCreativeData={AdParameters:_this2.settings.vastResponse.adParameters,adParameters:_this2.settings.vastResponse.adParameters};_this2._vpaidBridge.initAd(width,height,viewMode,desireBitrate,vastResponseCreativeData,{slot:_this2._$adSlot,videoSlot:_this2._$videoSlot})}else _this2._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.VastUnsupportedMedia}})}).catch(function(e){return _this2._onInitAdError(e)})}catch(e){this._onInitAdError(e)}}},{key:"startAd",value:function(){try{get_default()(getPrototypeOf_default()(VastBidAdaptor.prototype),"startAd",this).call(this),this._vpaidBridge.startAd()}catch(e){this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.AdaptorStartAdError+"_".concat(e.message)}})}}},{key:"stopAd",value:function(reason){get_default()(getPrototypeOf_default()(VastBidAdaptor.prototype),"stopAd",this).call(this,reason),this._vpaidBridge?this._vpaidBridge.stopAd(reason):Object(Logging.a)({message:"stopAd",exception:reason,level:protos.ProtoLoggingLevelEnum.WARNING})}},{key:"resizeAd",value:function(width,height,viewMode){try{this._vpaidBridge.resizeAd(width,height,viewMode)}catch(e){this._logVpaidEventError("VastBidAdaptor","resizeAd",e)}}},{key:"pauseAd",value:function(){try{this._vpaidBridge.pauseAd()}catch(e){this._logVpaidEventError("VastBidAdaptor","pauseAd",e)}}},{key:"resumeAd",value:function(){try{this._vpaidBridge.resumeAd()}catch(e){this._logVpaidEventError("VastBidAdaptor","resumeAd",e)}}},{key:"expandAd",value:function(){try{this._vpaidBridge.expandAd()}catch(e){this._logVpaidEventError("VastBidAdaptor","expandAd",e)}}},{key:"collapseAd",value:function(){try{this._vpaidBridge.collapseAd()}catch(e){this._logVpaidEventError("VastBidAdaptor","collapseAd",e)}}},{key:"skipAd",value:function(){try{get_default()(getPrototypeOf_default()(VastBidAdaptor.prototype),"skipAd",this).call(this),this._vpaidBridge.skipAd()}catch(e){this._logVpaidEventError("VastBidAdaptor","skipAd",e)}}},{key:"getAdRemainingTime",value:function(){try{return this._vpaidBridge.getAdRemainingTime()}catch(e){return this._logVpaidEventError("VastBidAdaptor","getAdRemainingTime",e),0}}},{key:"getAdDuration",value:function(){try{return this._vpaidBridge&&this._vpaidBridge.getAdDuration()||Math.round(this.settings.vastResponse.duration/TimeConfig.f)}catch(e){return this._logVpaidEventError("VastBidAdaptor","getAdDuration",e),0}}},{key:"getAdVolume",value:function(){try{return this._vpaidBridge.getAdVolume()}catch(e){return this._logVpaidEventError("VastBidAdaptor","getAdVolume",e),0}}},{key:"getAdMediaSize",value:function(){var mediaWidth=0,mediaHeight=0;return this._vpaidBridge instanceof AdVideoWrapper_AdVideoWrapper?(mediaWidth=this._vpaidBridge.getAdMediaWidth(),mediaHeight=this._vpaidBridge.getAdMediaHeight()):(mediaWidth=this._currentMediaFile.width,mediaHeight=this._currentMediaFile.height),{width:mediaWidth,height:mediaHeight}}},{key:"setAdVolume",value:function(volume){try{get_default()(getPrototypeOf_default()(VastBidAdaptor.prototype),"setAdVolume",this).call(this,volume),this._vpaidBridge.setAdVolume(volume)}catch(e){this._logVpaidEventError("VastBidAdaptor","setAdVolume",e)}}},{key:"_getAdVideoStartEventData",value:function(vpaidWrapperAdStartedEvent){var adStartedEventData=get_default()(getPrototypeOf_default()(VastBidAdaptor.prototype),"_getAdVideoStartEventData",this).call(this,vpaidWrapperAdStartedEvent);return this._addExtraVastBidParamsToEventData(adStartedEventData)}},{key:"_getAdImpressionEventData",value:function(vpaidWrapperImpressionEvent){var adImpressionEventData=get_default()(getPrototypeOf_default()(VastBidAdaptor.prototype),"_getAdImpressionEventData",this).call(this,vpaidWrapperImpressionEvent);return this._addExtraVastBidParamsToEventData(adImpressionEventData)}},{key:"_destroy",value:function(){var _a;if(!this.settings.loopAdWhenFinished)try{get_default()(getPrototypeOf_default()(VastBidAdaptor.prototype),"_destroy",this).call(this),clearSubscriptions(this._vastSubscriptions),null===(_a=this._vpaidBridge)||void 0===_a||_a.destroy()}catch(e){this._logVpaidEventError("VastBidAdaptor","_destroy",e)}}},{key:"_addExtraVastBidParamsToEventData",value:function(eventData){var _a;return eventData.payload.adSourceData.name=null===(_a=this.settings.vastResponse)||void 0===_a?void 0:_a.adTitle,eventData.payload.clickThroughUrl=this._vpaidClickThroughEventUrl||this.settings.vastResponse.clickThrough,eventData}},{key:"_getSupportedVideoMediaFiles",value:function(mediaFiles,videoSlot){return mediaFiles.filter(function(mediaFile){return mediaFile.getMediaFileType()===MonetisationConfig.d.Video&&videoSlot.canPlayType(mediaFile.type)})}},{key:"_getBestMedia",value:function(width,videoSlot){var supportedVideoMediaFiles=this._getSupportedVideoMediaFiles(this.settings.vastResponse.mediaFiles,videoSlot),bestVideoMediaFiles=supportedVideoMediaFiles.filter(function(mediaFile){return"video/mp4"===mediaFile.type});if(bestVideoMediaFiles.length)return getBestMediaFile(bestVideoMediaFiles,width);if(supportedVideoMediaFiles.length)return getBestMediaFile(supportedVideoMediaFiles,width);var vpaidMediaFiles=this.settings.vastResponse.mediaFiles.filter(function(mediaFile){return mediaFile.getMediaFileType()===MonetisationConfig.d.Javascript});return vpaidMediaFiles.length?getBestMediaFile(vpaidMediaFiles,width):null}},{key:"_onInitAdError",value:function(e){this._onVpaidEvent.next({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.AdaptorInitAdError+"_".concat(e.message)}})}},{key:"adVideoUrl",get:function(){var _a;return null===(_a=this._currentMediaFile)||void 0===_a?void 0:_a.src}},{key:"declaredDurationInSeconds",get:function(){return this.settings.vastResponse.duration/TimeConfig.f}}]),VastBidAdaptor}(ABaseBidAdaptor_ABaseBidAdaptor);!function(XMLUtils){function parseText(sValue){return/^\s*$/.test(sValue)?null:/^(?:true|false)$/i.test(sValue)?"true"===sValue.toLowerCase():isFinite(sValue)?parseFloat(sValue):isFinite(Date.parse(sValue))?new Date(sValue):"string"==typeof sValue?sValue.trim():sValue}XMLUtils.JXONTree=function JXONTree(oXMLParent){var nAttrLen=0,sCollectedTxt="";if(this.keyAttributes||(this.keyAttributes={}),oXMLParent.hasChildNodes()){for(var oNode,sProp,vContent,nItem=0;nItem<oXMLParent.childNodes.length;nItem++)((oNode=oXMLParent.childNodes.item(nItem)).nodeType-1|1)===Node.TEXT_NODE?sCollectedTxt+=oNode.nodeType===Node.TEXT_NODE?oNode.nodeValue.trim():oNode.nodeValue:1!==oNode.nodeType||oNode.prefix||(sProp=oNode.nodeName.toLowerCase(),vContent=new JXONTree(oNode),this.hasOwnProperty(sProp)?(this[sProp].constructor!==Array&&(this[sProp]=[this[sProp]]),this[sProp].push(vContent)):this[sProp]=vContent);this.keyValue=sCollectedTxt?parseText(sCollectedTxt):null}if(void 0===oXMLParent.hasAttributes?oXMLParent.attributes.length>0:oXMLParent.hasAttributes())for(var oAttrib;nAttrLen<oXMLParent.attributes.length;nAttrLen++)oAttrib=oXMLParent.attributes.item(nAttrLen),this.keyAttributes[oAttrib.name.toLowerCase()]=parseText(oAttrib.value.trim())},XMLUtils.getKeyValue=function(xmlObj){if(xmlObj&&xmlObj.keyValue)return xmlObj.keyValue},XMLUtils.decodeXMLText=function(text){if("string"==typeof text)return text.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")}}(XMLUtils||(XMLUtils={}));var VastUtils_VastUtils,MediaFile_MediaFile=function(){function MediaFile(mediaFileJTree){classCallCheck_default()(this,MediaFile),this._jsMimeTypes=["text/javascript","text/javascript1.0","text/javascript1.2","text/javascript1.4","text/jscript","application/javascript","application/x-javascript","text/ecmascript","text/ecmascript1.0","text/ecmascript1.2","text/ecmascript1.4","text/livescript","application/ecmascript","application/x-ecmascript"],this._apiFrameworkType="VPAID",this.delivery=void 0,this.type=void 0,this.width=0,this.height=0,this.codec=void 0,this.id=void 0,this.bitrate=void 0,this.minBitrate=void 0,this.maxBitrate=void 0,this.scalable=void 0,this.maintainAspectRatio=void 0,this.apiFramework=void 0,this.src=void 0,this.delivery=mediaFileJTree.keyAttributes.delivery,this.type=mediaFileJTree.keyAttributes.type,this.width=mediaFileJTree.keyAttributes.width,this.height=mediaFileJTree.keyAttributes.height,this.codec=mediaFileJTree.keyAttributes.codec,this.id=mediaFileJTree.keyAttributes.id,this.bitrate=mediaFileJTree.keyAttributes.bitrate,this.minBitrate=mediaFileJTree.keyAttributes.minbitrate,this.maxBitrate=mediaFileJTree.keyAttributes.maxbitrate,this.scalable=mediaFileJTree.keyAttributes.scalable,this.maintainAspectRatio=mediaFileJTree.keyAttributes.maintainaspectratio,this.apiFramework=mediaFileJTree.keyAttributes.apiframework,this.src=XMLUtils.getKeyValue(mediaFileJTree)}return createClass_default()(MediaFile,[{key:"isSupported",value:function(){return!("application/x-shockwave-flash"===this.type||"video/x-flv"===this.type)}},{key:"getMediaFileType",value:function(){return this.apiFramework===this._apiFrameworkType||Object(ArrayUtils.g)(this.type,this._jsMimeTypes)?MonetisationConfig.d.Javascript:MonetisationConfig.d.Video}}]),MediaFile}(),TrackingEvent_TrackingEvent=function TrackingEvent(trackingEventJTree,duration){classCallCheck_default()(this,TrackingEvent),this.name=trackingEventJTree.keyAttributes.event,this.uri=XMLUtils.getKeyValue(trackingEventJTree),"progress"===this.name&&(this.offset=Object(TimeUtils.d)(trackingEventJTree.keyAttributes.offset,duration))},VideoClicks_VideoClicks=function(){function VideoClicks(videoClicksJTree){classCallCheck_default()(this,VideoClicks),this.clickThrough=void 0,this.clickTrackings=[],this.customClicks=[],this.clickThrough=XMLUtils.getKeyValue(videoClicksJTree.clickthrough),this.clickTrackings=this._parseClickTrackings(Object(ArrayUtils.m)(videoClicksJTree.clicktracking)),this.customClicks=this._parseClickTrackings(Object(ArrayUtils.m)(videoClicksJTree.customclick))}return createClass_default()(VideoClicks,[{key:"_parseClickTrackings",value:function(trackingsData){var clickTrackings=[];return void 0!==trackingsData[0]&&trackingsData.forEach(function(clickTrackingData){clickTrackings.push(XMLUtils.getKeyValue(clickTrackingData))}),clickTrackings}}]),VideoClicks}(),Linear_Linear=function(){function Linear(linearJTree){classCallCheck_default()(this,Linear),this.duration=void 0,this.mediaFiles=[],this.trackingEvents=[],this.skipoffset=void 0,this.videoClicks=void 0,this.duration=Object(TimeUtils.a)(XMLUtils.getKeyValue(linearJTree.duration)),this.skipoffset=Object(TimeUtils.d)(linearJTree.keyAttributes.skipoffset,this.duration),linearJTree.mediafiles&&(this.mediaFiles=this._parseMediaFiles(Object(ArrayUtils.m)(linearJTree.mediafiles.mediafile))),linearJTree.trackingevents&&(this.trackingEvents=this._parseTrackingEvents(Object(ArrayUtils.m)(linearJTree.trackingevents.tracking))),linearJTree.videoclicks&&(this.videoClicks=new VideoClicks_VideoClicks(linearJTree.videoclicks)),linearJTree.adparameters&&(this.adParameters=XMLUtils.getKeyValue(linearJTree.adparameters),linearJTree.adparameters["@xmlEncoded"]&&(this.adParameters=XMLUtils.decodeXMLText(this.adParameters)))}return createClass_default()(Linear,[{key:"_parseTrackingEvents",value:function(trackingEventsJTree){var _this=this,trackings=[];return void 0!==trackingEventsJTree[0]&&trackingEventsJTree.forEach(function(trackingElem){trackings.push(new TrackingEvent_TrackingEvent(trackingElem,_this.duration))}),trackings}},{key:"_parseMediaFiles",value:function(mediaFilesJTree){var mediaFiles=[];return void 0!==mediaFilesJTree[0]&&mediaFilesJTree.forEach(function(mediaElem){var mediaFile=new MediaFile_MediaFile(mediaElem);mediaFile.isSupported()&&mediaFiles.push(mediaFile)}),mediaFiles}},{key:"isSupported",value:function(){return!0}}]),Linear}(),Creative_Creative=function(){function Creative(creativeJTree){classCallCheck_default()(this,Creative),this.id=void 0,this.sequence=void 0,this.adId=void 0,this.linear=void 0,this.id=creativeJTree.keyAttributes.id,this.sequence=creativeJTree.keyAttributes.sequence,this.adId=creativeJTree.keyAttributes.adid,creativeJTree.linear&&(this.linear=new Linear_Linear(creativeJTree.linear))}return createClass_default()(Creative,[{key:"isSupported",value:function(){return!0}}]),Creative}();!function(VastUtils){function parseJKey(jTree){var keys=[];return void 0!==jTree[0]&&jTree.forEach(function(elem){keys.push(XMLUtils.getKeyValue(elem))}),keys}VastUtils.parseImpressions=function(impressionsJTree){return parseJKey(impressionsJTree)},VastUtils.parseCretives=function(creativesJTree){var creatives=[];return creativesJTree.forEach(function(elem){creatives.push(new Creative_Creative(elem))}),creatives},VastUtils.parseErrors=function(errorsJTree){return parseJKey(errorsJTree)}}(VastUtils_VastUtils||(VastUtils_VastUtils={}));var SdkType,InLine_InLine=function(){function InLine(inLineJTree){var _a;classCallCheck_default()(this,InLine),this.description=void 0,this.advertiser=void 0,this.surveys=void 0,this.errors=void 0,this.pricing=void 0,this.extensions=void 0,this.adTitle=XMLUtils.getKeyValue(inLineJTree.adtitle),this.adSystem=XMLUtils.getKeyValue(inLineJTree.adsystem),this.impressions=VastUtils_VastUtils.parseImpressions(Object(ArrayUtils.m)(inLineJTree.impression)),this.creatives=(null===(_a=inLineJTree.creatives)||void 0===_a?void 0:_a.creative)?VastUtils_VastUtils.parseCretives(Object(ArrayUtils.m)(inLineJTree.creatives.creative)):[],this.description=XMLUtils.getKeyValue(inLineJTree.description),this.advertiser=XMLUtils.getKeyValue(inLineJTree.advertiser),this.surveys=XMLUtils.getKeyValue(inLineJTree.survey),this.errors=VastUtils_VastUtils.parseErrors(Object(ArrayUtils.m)(inLineJTree.error)),this.pricing=XMLUtils.getKeyValue(inLineJTree.pricing),this.extensions=XMLUtils.getKeyValue(inLineJTree.extensions)}return createClass_default()(InLine,[{key:"isSupported",value:function(){return!0}}]),InLine}(),Wrapper_Wrapper=function Wrapper(wrapperJTree){var _a;classCallCheck_default()(this,Wrapper),this.adSystem=void 0,this.impressions=[],this.VASTAdTagURI=void 0,this.creatives=[],this.errors=void 0,this.extensions=void 0,this.fallowAdditionalWrappers=void 0,this.allowMultipleAds=void 0,this.fallbackOnNoAd=void 0,this.adSystem=XMLUtils.getKeyValue(wrapperJTree.adSystem),this.impressions=VastUtils_VastUtils.parseImpressions(Object(ArrayUtils.m)(wrapperJTree.impression)),this.VASTAdTagURI=XMLUtils.getKeyValue(wrapperJTree.vastadtaguri),this.creatives=(null===(_a=wrapperJTree.creatives)||void 0===_a?void 0:_a.creative)?VastUtils_VastUtils.parseCretives(Object(ArrayUtils.m)(wrapperJTree.creatives.creative)):[],this.errors=VastUtils_VastUtils.parseErrors(Object(ArrayUtils.m)(wrapperJTree.error)),this.extensions=wrapperJTree.extensions,this.fallowAdditionalWrappers=!wrapperJTree.keyAttributes.followadditionalwrappers||wrapperJTree.keyAttributes.followadditionalwrappers,this.allowMultipleAds=wrapperJTree.keyAttributes.allowmultipleads,this.fallbackOnNoAd=wrapperJTree.keyAttributes.fallbackonnoad},VastAd_VastAd=function(){function VastAd(JXONTree){classCallCheck_default()(this,VastAd),Array.isArray(JXONTree)?this._handleAdList(JXONTree):this._handleSingleAd(JXONTree)}return createClass_default()(VastAd,[{key:"isSupported",value:function(){return!0}},{key:"_handleSingleAd",value:function(JXONTree){this.id=JXONTree.keyAttributes.id,this.sequence=JXONTree.keyAttributes.sequence,JXONTree.inline?this.inLine=new InLine_InLine(JXONTree.inline):JXONTree.wrapper&&(this.wrapper=new Wrapper_Wrapper(JXONTree.wrapper))}},{key:"_handleAdList",value:function(JXONTree){var _this=this,linearAds=JXONTree.filter(function(ad){var linearCreativeList=_this._getCreativeTreeList(ad).filter(function(creative){return creative.linear});return!!Object(ArrayUtils.h)(linearCreativeList)});Object(ArrayUtils.h)(linearAds)&&this._handleSingleAd(linearAds[0])}},{key:"_getCreativeTreeList",value:function(ad){return ad.inline?Object(ArrayUtils.m)(ad.inline.creatives.creative):ad.wrapper?Object(ArrayUtils.m)(ad.wrapper.creatives.creative):[]}}]),VastAd}(),VastXmlParser_VastXmlParser=function(){function VastXmlParser(){var _minVastSupportedVersion=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;classCallCheck_default()(this,VastXmlParser),this._minVastSupportedVersion=_minVastSupportedVersion}return createClass_default()(VastXmlParser,[{key:"parseVastXml",value:function(xml){try{if(!this._isValidXmlString(xml))return{error:!0,errorReason:AdCallRejectionReason.XmlInvalidString};var xmlDocument=(new DOMParser).parseFromString(xml,"application/xml"),vastTree=new XMLUtils.JXONTree(xmlDocument.documentElement);if(!this._isValidVastTree(vastTree,this._minVastSupportedVersion))return{error:!0,errorReason:AdCallRejectionReason.XmlInvalidTree};var vastAd=new VastAd_VastAd(vastTree.ad);return this._isValidVastAd(vastAd)?{error:!1,result:vastAd}:{error:!0,errorReason:AdCallRejectionReason.XmlInvalidAd}}catch(e){return{error:!0,errorReason:AdCallRejectionReason.XmlParseGeneral}}}},{key:"_isValidXmlString",value:function(xml){return Object(TypeUtils.h)(xml)}},{key:"_isValidVastTree",value:function(vastTree,vastSupportedVersion){if(!vastTree.ad)return!1;var vastVersion=parseInt(vastTree.keyAttributes.version,10);return!(vastVersion&&vastVersion<vastSupportedVersion)}},{key:"_isValidVastAd",value:function(vastAd){var wrapper=vastAd.wrapper,inLine=vastAd.inLine;if(!inLine&&!wrapper)return!1;if(wrapper&&!wrapper.VASTAdTagURI)return!1;if(!wrapper&&!toConsumableArray_default()(inLine.creatives).filter(function(creative){var _a,_b;return null===(_b=null===(_a=creative)||void 0===_a?void 0:_a.linear)||void 0===_b?void 0:_b.mediaFiles.length}).length)return!1;return!0}}]),VastXmlParser}(),VastFlatCreative_VastFlatCreative=function(){function VastFlatCreative(adsChain){var _this=this;classCallCheck_default()(this,VastFlatCreative),this.mediaFiles=[],this.adTitle=void 0,this.adParameters=void 0,this.clickThrough=void 0,this.creativeId=void 0,adsChain.forEach(function(adElem){adElem.inLine?(_this.adTitle=adElem.inLine.adTitle,_this._addCreatives(adElem.inLine.creatives)):adElem.wrapper&&_this._addCreatives(adElem.wrapper.creatives)})}return createClass_default()(VastFlatCreative,[{key:"_addLinear",value:function(linear){this.duration=linear.duration,this._addMediaFiles(linear.mediaFiles),this._addSkipoffset(linear.skipoffset),this._addAdParameters(linear.adParameters),linear.videoClicks&&linear.videoClicks.clickThrough&&this._addClickThrough(linear.videoClicks.clickThrough)}},{key:"_addAdParameters",value:function(adParameters){this.adParameters=adParameters}},{key:"_addSkipoffset",value:function(skipoffset){this.skipoffset=skipoffset}},{key:"_addMediaFiles",value:function(mediaFiles){this.mediaFiles=[].concat(toConsumableArray_default()(this.mediaFiles),toConsumableArray_default()(mediaFiles))}},{key:"_addClickThrough",value:function(clickThrough){this.clickThrough=clickThrough}},{key:"_addCreatives",value:function(creatives){var _this2=this;creatives.forEach(function(creative){creative.linear&&(_this2.creativeId=creative.id,_this2._addLinear(creative.linear))})}}]),VastFlatCreative}(),DEFAULT_MAX_WRAPPER_LIMIT=10,VastXmlCallAdaptor_VastXmlCallAdaptor=function(){function VastXmlCallAdaptor(settings){classCallCheck_default()(this,VastXmlCallAdaptor),this.settings=settings,this.metrics={created:(new Date).getTime()},this.settings.vastAdsChain||(this.settings.vastAdsChain=[]),void 0===this.settings.maxWrapperLimit&&(this.settings.maxWrapperLimit=DEFAULT_MAX_WRAPPER_LIMIT)}return createClass_default()(VastXmlCallAdaptor,[{key:"fetchBid",value:function(){var _this=this;return this.metrics.fetchStart=(new Date).getTime(),this._fetchBidFromXml(this.settings.xml).then(function(bid){return _this.metrics.fetchEnd=(new Date).getTime(),bid}).catch(function(error){throw _this.metrics.fetchEnd=(new Date).getTime(),error})}},{key:"_fetchBidFromXml",value:function(xml){var _this2=this;return new Promise(function(resolve,reject){var parseResult=new VastXmlParser_VastXmlParser(2).parseVastXml(xml);!0!==parseResult.error?(_this2._setVastInfo(parseResult.result),resolve(_this2._fetchBidFromVastAd(parseResult.result))):reject(parseResult.errorReason)})}},{key:"_fetchBidFromVastAd",value:function(vastAd){var _this3=this;return new Promise(function(resolve,reject){if(vastAd.wrapper){_this3.settings.maxWrapperLimit<=0&&reject(AdCallRejectionReason.XmlAdaptorWrapperLimit);var maxWrapperLimit=_this3.settings.maxWrapperLimit-1;resolve(new VastUrlCallAdaptor_VastUrlCallAdaptor({id:_this3.settings.id,adManagerLineItem:_this3.settings.adManagerLineItem,trackersInformation:_this3.settings.trackersInformation,maxWrapperLimit:maxWrapperLimit,url:vastAd.wrapper.VASTAdTagURI,replaceTrackingMacros:!1,requestMetadata:_this3.settings.requestMetadata,callingState:_this3.settings.callingState,adMacroReplacer:_this3.settings.adMacroReplacer,adContainer:_this3.settings.adContainer,globalDomUtilsService:_this3.settings.globalDomUtilsService,viewabilityService:_this3.settings.viewabilityService,trackingService:_this3.settings.trackingService,cpm:_this3.settings.cpm,obfuscatedPrice:_this3.settings.obfuscatedPrice,adEnforcer:_this3.settings.adEnforcer,requestWithCredentials:_this3.settings.requestWithCredentials,successRate:_this3.settings.successRate,os:_this3.settings.os,adSlotContainerRecycler:_this3.settings.adSlotContainerRecycler,creativeId:_this3.settings.creativeId,bidSlotId:_this3.settings.bidSlotId,loopAdWhenFinished:_this3.settings.loopAdWhenFinished,pageUrl:_this3.settings.pageUrl,urlSuffixerService:_this3.settings.urlSuffixerService}).fetchBid())}else{resolve(new VastBidAdaptor_VastBidAdaptor({id:_this3.settings.id,adManagerLineItem:_this3.settings.adManagerLineItem,trackers:_this3.settings.trackersInformation,vastResponse:new VastFlatCreative_VastFlatCreative(_this3.settings.vastAdsChain),requestMetadata:_this3.settings.requestMetadata,callingState:_this3.settings.callingState,adContainer:_this3.settings.adContainer,globalDomUtilsService:_this3.settings.globalDomUtilsService,trackingService:_this3.settings.trackingService,viewabilityService:_this3.settings.viewabilityService,cpm:_this3.settings.cpm,obfuscatedPrice:_this3.settings.obfuscatedPrice,adEnforcer:_this3.settings.adEnforcer,successRate:_this3.settings.successRate,os:_this3.settings.os,adSlotContainerRecycler:_this3.settings.adSlotContainerRecycler,externalCreativeId:_this3.settings.creativeId,bidSlotId:_this3.settings.bidSlotId,loopAdWhenFinished:_this3.settings.loopAdWhenFinished,urlSuffixerService:_this3.settings.urlSuffixerService}))}})}},{key:"_setVastInfo",value:function(vastAd){!function(vastAd,trackerInformation){var _trackerInformation$a,_trackerInformation$a2,_trackerInformation$a3,_trackerInformation$a4,_trackerInformation$a5,_trackerInformation$a6,_trackerInformation$a7,_trackerInformation$a8,_trackerInformation$a9,_trackerInformation$a10,_trackerInformation$a11,_trackerInformation$a12,_trackerInformation$a13,_trackerInformation$a14,_trackerInformation$a15,_trackerInformation$a16,_trackerInformation$a17,vastTrackings=new VastTrackings_VastTrackings(vastAd);(_trackerInformation$a=trackerInformation.adError).push.apply(_trackerInformation$a,toConsumableArray_default()(getImageTrackers(vastTrackings.errorUrls))),(_trackerInformation$a2=trackerInformation.adImpression).push.apply(_trackerInformation$a2,toConsumableArray_default()(getImageTrackers(vastTrackings.impressions))),(_trackerInformation$a3=trackerInformation.adClick).push.apply(_trackerInformation$a3,toConsumableArray_default()(getImageTrackers(vastTrackings.clickTrackings))),(_trackerInformation$a4=trackerInformation.adMute).push.apply(_trackerInformation$a4,toConsumableArray_default()(getImageTrackers(vastTrackings.trackingEvents.mute))),(_trackerInformation$a5=trackerInformation.adPause).push.apply(_trackerInformation$a5,toConsumableArray_default()(getImageTrackers(vastTrackings.trackingEvents.pause))),(_trackerInformation$a6=trackerInformation.adQuartileFirst).push.apply(_trackerInformation$a6,toConsumableArray_default()(getImageTrackers(vastTrackings.trackingEvents.firstQuartile))),(_trackerInformation$a7=trackerInformation.adQuartileSecond).push.apply(_trackerInformation$a7,toConsumableArray_default()(getImageTrackers(vastTrackings.trackingEvents.midpoint))),(_trackerInformation$a8=trackerInformation.adQuartileThird).push.apply(_trackerInformation$a8,toConsumableArray_default()(getImageTrackers(vastTrackings.trackingEvents.thirdQuartile))),(_trackerInformation$a9=trackerInformation.adQuartileFourth).push.apply(_trackerInformation$a9,toConsumableArray_default()(getImageTrackers(vastTrackings.trackingEvents.complete))),(_trackerInformation$a10=trackerInformation.adResume).push.apply(_trackerInformation$a10,toConsumableArray_default()(getImageTrackers(vastTrackings.trackingEvents.resume))),(_trackerInformation$a11=trackerInformation.adSkip).push.apply(_trackerInformation$a11,toConsumableArray_default()(getImageTrackers(vastTrackings.trackingEvents.skip))),(_trackerInformation$a12=trackerInformation.adStarted).push.apply(_trackerInformation$a12,toConsumableArray_default()(getImageTrackers(vastTrackings.trackingEvents.creativeView))),(_trackerInformation$a13=trackerInformation.adVideoStart).push.apply(_trackerInformation$a13,toConsumableArray_default()(getImageTrackers(toConsumableArray_default()(vastTrackings.trackingEvents.start)))),(_trackerInformation$a14=trackerInformation.adUnmute).push.apply(_trackerInformation$a14,toConsumableArray_default()(trackerInformation.adUnmute).concat(toConsumableArray_default()(getImageTrackers(vastTrackings.trackingEvents.unmute)))),(_trackerInformation$a15=trackerInformation.adUserAcceptInvitation).push.apply(_trackerInformation$a15,toConsumableArray_default()(getImageTrackers([].concat(toConsumableArray_default()(vastTrackings.trackingEvents.acceptInvitation),toConsumableArray_default()(vastTrackings.trackingEvents.acceptInvitationLinear))))),(_trackerInformation$a16=trackerInformation.adUserClose).push.apply(_trackerInformation$a16,toConsumableArray_default()(getImageTrackers(vastTrackings.trackingEvents.close))),(_trackerInformation$a17=trackerInformation.adUserMinimize).push.apply(_trackerInformation$a17,toConsumableArray_default()(trackerInformation.adUserMinimize).concat(toConsumableArray_default()(getImageTrackers([].concat(toConsumableArray_default()(vastTrackings.trackingEvents.collapse),toConsumableArray_default()(vastTrackings.trackingEvents.playerCollapse),toConsumableArray_default()(vastTrackings.trackingEvents.adCollapse))))))}(vastAd,this.settings.trackersInformation),this.settings.vastAdsChain.push(vastAd)}}]),VastXmlCallAdaptor}(),XhrUtils=__webpack_require__(35);!function(SdkType){SdkType[SdkType.None=0]="None",SdkType[SdkType.Ima=1]="Ima"}(SdkType||(SdkType={}));var SdkUrlPartMap=defineProperty_default()({},SdkType.Ima,".g.doubleclick.net"),CALL_WITH_CREDENTIALS_DEFAULT=!0,VastUrlCallAdaptor_VastUrlCallAdaptor=function(){function VastUrlCallAdaptor(settings){classCallCheck_default()(this,VastUrlCallAdaptor),this.settings=settings,void 0===this.settings.requestWithCredentials&&(this.settings.requestWithCredentials=CALL_WITH_CREDENTIALS_DEFAULT),this.metrics={created:(new Date).getTime()}}return createClass_default()(VastUrlCallAdaptor,[{key:"fetchBid",value:function(){var _this=this;return this.metrics.fetchStart=(new Date).getTime(),this._fetchCallAdaptorFromUrl(this.settings.url).then(function(adaptor){return adaptor.fetchBid()}).then(function(bid){return _this.metrics.fetchEnd=(new Date).getTime(),bid}).catch(function(error){throw _this.metrics.fetchEnd=(new Date).getTime(),error})}},{key:"_getSdkTypeFromUrl",value:function(url){var sdk=SdkType.None;return Object.keys(SdkUrlPartMap).forEach(function(sdkTypeKey){-1!==url.indexOf(SdkUrlPartMap[sdkTypeKey])&&(sdk=parseInt(sdkTypeKey,10))}),sdk}},{key:"_fetchCallAdaptorFromUrl",value:function(url){var macroReplacedUrl=this._replaceUrlMacros(url);switch(this._getSdkTypeFromUrl(url)){case SdkType.None:return this._fetchVastAdaptor(macroReplacedUrl);case SdkType.Ima:return this._fetchImaAdaptor(macroReplacedUrl);default:return Promise.reject(AdCallRejectionReason.HandlingSdkUrl)}}},{key:"_fetchImaAdaptor",value:function(url){return Promise.resolve(new ImaCallAdaptor_ImaCallAdaptor({url:url,id:this.settings.id,adManagerLineItem:this.settings.adManagerLineItem,trackersInformation:this.settings.trackersInformation,replaceTrackingMacros:!1,requestMetadata:this.settings.requestMetadata,callingState:this.settings.callingState,adContainer:this.settings.adContainer,globalDomUtilsService:this.settings.globalDomUtilsService,viewabilityService:this.settings.viewabilityService,cpm:this.settings.cpm,obfuscatedPrice:this.settings.obfuscatedPrice,adEnforcer:this.settings.adEnforcer,successRate:this.settings.successRate,os:this.settings.os,adSlotContainerRecycler:this.settings.adSlotContainerRecycler,creativeId:this.settings.creativeId,bidSlotId:this.settings.bidSlotId,pageUrl:this.settings.pageUrl,urlSuffixerService:this.settings.urlSuffixerService}))}},{key:"_fetchVastAdaptor",value:function(url){var _this2=this;return XhrUtils.a.fetchXMLRequest(url,this.settings.requestWithCredentials).catch(function(){return!1===_this2.settings.requestWithCredentials?Promise.reject(AdCallRejectionReason.NetworkRequestUrl):XhrUtils.a.fetchXMLRequest(url,!1)}).catch(function(){return Promise.reject(AdCallRejectionReason.NetworkRequestUrl)}).then(function(xmlResponse){return new VastXmlCallAdaptor_VastXmlCallAdaptor({id:_this2.settings.id,adManagerLineItem:_this2.settings.adManagerLineItem,trackersInformation:_this2.settings.trackersInformation,vastAdsChain:_this2.settings.vastAdsChain,xml:xmlResponse,replaceTrackingMacros:!1,requestMetadata:_this2.settings.requestMetadata,callingState:_this2.settings.callingState,adMacroReplacer:_this2.settings.adMacroReplacer,adContainer:_this2.settings.adContainer,globalDomUtilsService:_this2.settings.globalDomUtilsService,viewabilityService:_this2.settings.viewabilityService,trackingService:_this2.settings.trackingService,cpm:_this2.settings.cpm,obfuscatedPrice:_this2.settings.obfuscatedPrice,adEnforcer:_this2.settings.adEnforcer,requestWithCredentials:_this2.settings.requestWithCredentials,successRate:_this2.settings.successRate,os:_this2.settings.os,adSlotContainerRecycler:_this2.settings.adSlotContainerRecycler,creativeId:_this2.settings.creativeId,bidSlotId:_this2.settings.bidSlotId,loopAdWhenFinished:_this2.settings.loopAdWhenFinished,pageUrl:_this2.settings.pageUrl,urlSuffixerService:_this2.settings.urlSuffixerService})})}},{key:"_replaceUrlMacros",value:function(url){var _this$settings$callin=this.settings.callingState.adContainerState.get(this.settings.adManagerLineItem.protoLineItem.adType),width=_this$settings$callin.width,adMacroSettings={adHeight:_this$settings$callin.height,adWidth:width,adPostion:this.settings.callingState.adBreakState.adBreakType},mediaMacroSettings={mediaDescription:this.settings.callingState.media.mediaDescription,mediaDuration:this.settings.callingState.media.mediaDuration,mediaId:this.settings.callingState.media.mediaId,mediaTitle:this.settings.callingState.media.mediaTitle,mediaUrl:this.settings.callingState.media.mediaUrl};return this.settings.adMacroReplacer.replace(url,this.settings.adManagerLineItem.protoLineItem.vendorId,{adMacros:adMacroSettings,mediaMacros:mediaMacroSettings})}}]),VastUrlCallAdaptor}(),InternalRequestTrackingMetadata_InternalRequestTrackingMetadata=function InternalRequestTrackingMetadata(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};classCallCheck_default()(this,InternalRequestTrackingMetadata),this.data=data,Object(TypeUtils.h)(this.data.cnxBidId)||(this.data.cnxBidId=Object(GeneralUtils.c)())},PlayerConfig=__webpack_require__(49);function getLineItemByAdvertiserId(lineItemRequestDataList,advertiserId){return lineItemRequestDataList.find(function(lineItemRequestData){return lineItemRequestData.adManagerLineItem.protoLineItem.advertiserLineItemId===advertiserId}).adManagerLineItem}function getUsedFloorPriceIndexes(lineItem){var floorPriceIndexes=[];return lineItem.callers.forEach(function(caller){var index=caller.settings.requestMetadata.data.requestedFloorPriceIndex;void 0===index||Object(ArrayUtils.g)(index,floorPriceIndexes)||floorPriceIndexes.push(index)}),lineItem.bids.forEach(function(bid){var index=bid.settings.requestMetadata.data.requestedFloorPriceIndex;void 0===index||Object(ArrayUtils.g)(index,floorPriceIndexes)||floorPriceIndexes.push(index)}),floorPriceIndexes}function shouldAggregateCreativeType(creativeType){return[protos.ProtoCreativeTypeEnum.Tam,protos.ProtoCreativeTypeEnum.TamDeal,protos.ProtoCreativeTypeEnum.Rtb,protos.ProtoCreativeTypeEnum.HeaderBidder].includes(creativeType)}var _QUARTILE_EVENT_MAP,AdHtmlWrapper_AdHtmlWrapper=function(){function AdHtmlWrapper(_mime,_html,_advertiserLineItemId,_globalDomUtils,_trackingService){classCallCheck_default()(this,AdHtmlWrapper),this._mime=_mime,this._html=_html,this._advertiserLineItemId=_advertiserLineItemId,this._globalDomUtils=_globalDomUtils,this._trackingService=_trackingService,this._slotId="div-cnx-display",this._onDisplay=new Subject.a,this._onError=new Subject.a}return createClass_default()(AdHtmlWrapper,[{key:"initializeAd",value:function(adSlot,size){var _this=this;try{this._$adSlot=adSlot,this._iframeLoader=new IframeLoader_IframeLoader(this._globalDomUtils,this._trackingService);var customHtml="";this._mime===MonetisationConfig.b.Html&&(customHtml=this._html);var iframeContainer=this._getIframeContainer(this._$adSlot,size);this._iframeLoader.loadIframe({customHead:"<style>html, body {position:relative;width:100%;height:100%}#"+this._slotId+"{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}#"+this._slotId+"{border:3px solid white}#"+this._slotId+" iframe{display:block}</style>",customHtml:'<div id="'+this._slotId+'">'+customHtml+"</div>",container:iframeContainer,customReportingLog:{heavyAdBlockTypeEnum:protos.ProtoHeavyAdBlockTypeEnum.OverlayIframe,advertiserLineItemId:this._advertiserLineItemId}}).then(function(iframeLoaderOutput){_this._$iframe=iframeLoaderOutput.iframe;var ifrWindow=_this._$iframe.contentWindow;if(_this._$adSlotMedia=ifrWindow.document.getElementById(_this._slotId),_this._mime===MonetisationConfig.b.Javascript&&Object(DomUtils.z)(_this._$adSlotMedia,ifrWindow,_this._html),""===_this._$iframe.contentWindow.document.head.innerHTML){_this._setIframeStyle("html, body {position:relative;width:100%;height:100%;margin:0;border:0}")}Object(DomUtils.H)(_this._$iframe.contentWindow,"AdHtmlWrapper"),_this._onDisplay.next()}).catch(function(reason){_this._onError.next(MonetisationConfig.c.DisplayIntegratorIframeLoad)})}catch(e){this._onError.next(MonetisationConfig.c.WrapperInitAdError)}}},{key:"getAdMediaWidth",value:function(){return this._$adSlotMedia.clientWidth}},{key:"getAdMediaHeight",value:function(){return this._$adSlotMedia.clientHeight}},{key:"destroy",value:function(){this._$iframe&&this._$adSlot&&Object(DomUtils.M)(this._$iframe),this._iframeLoader&&(this._iframeLoader.destroy(),this._iframeLoader=null)}},{key:"_getIframeContainer",value:function(adSlot,dimensions){if(!dimensions.width||!dimensions.height)return adSlot;var iframeContainer=this._globalDomUtils.createElementByString('<div class="cnx-iframe-container" style="width: '.concat(dimensions.width,"px; height: ").concat(dimensions.height,'px"></div>'));return this._$adSlot.appendChild(iframeContainer),iframeContainer}},{key:"_setIframeStyle",value:function(inlineCode){var $styleTag=this._$iframe.contentWindow.document.createElement("style"),textNode=this._$iframe.contentWindow.document.createTextNode(inlineCode);$styleTag.appendChild(textNode),this._$iframe.contentWindow.document.head.appendChild($styleTag)}},{key:"onDisplayAd",get:function(){return this._onDisplay.asObservable()}},{key:"onError",get:function(){return this._onError.asObservable()}}]),AdHtmlWrapper}();function HtmlBidAdaptor_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var _headerBidderParamsHa,QUARTILE_EVENT_MAP=(_QUARTILE_EVENT_MAP={},defineProperty_default()(_QUARTILE_EVENT_MAP,QuartilesEnum.FirstQuartile,VastConfig.b.AdVideoFirstQuartile),defineProperty_default()(_QUARTILE_EVENT_MAP,QuartilesEnum.SecondQuartile,VastConfig.b.AdVideoMidpoint),defineProperty_default()(_QUARTILE_EVENT_MAP,QuartilesEnum.ThirdQuartile,VastConfig.b.AdVideoThirdQuartile),defineProperty_default()(_QUARTILE_EVENT_MAP,QuartilesEnum.FourthQuartile,VastConfig.b.AdVideoComplete),_QUARTILE_EVENT_MAP),HtmlBidAdaptor_HtmlBidAdaptor=function(_ABaseBidAdaptor){inherits_default()(HtmlBidAdaptor,_ABaseBidAdaptor);var _super=HtmlBidAdaptor_createSuper(HtmlBidAdaptor);function HtmlBidAdaptor(settings){var _this;classCallCheck_default()(this,HtmlBidAdaptor),(_this=_super.call(this,settings)).settings=settings,_this.adMediaType="displayHtml",_this.adSourceType=protos.ProtoAdsourceTypeEnum.Unknown,_this._vastMediaType="html",_this._intervalTick=500,_this._decimalPrecision=1,_this._htmlSubscriptions=[];var durationInMs=_this.settings.adManagerLineItem.protoLineItem.overlayTime*TimeConfig.f;return _this._timer=new Timer_Timer(durationInMs,_this._intervalTick,_this._decimalPrecision),_this._htmlSubscriptions.push(_this._timer.onTimeUpdate.subscribe(function(){_this._sendVpaidEvent({type:VastConfig.b.AdRemainingTimeChange})}),_this._timer.onTimeElapsed.subscribe(function(){_this.stopAd("htmlTimerElapsed")}),_this._timer.onQuartile.subscribe(function(quartile){_this._sendVpaidEvent({type:QUARTILE_EVENT_MAP[quartile],payload:{}})})),_this}return createClass_default()(HtmlBidAdaptor,[{key:"initAd",value:function(width,height,viewMode,desireBitrate,creativeData,environmentVars,volume){try{get_default()(getPrototypeOf_default()(HtmlBidAdaptor.prototype),"initAd",this).call(this,width,height,viewMode,desireBitrate,creativeData,environmentVars,volume),this._width=width,this._height=height,this._sendVpaidEvent({type:VastConfig.b.AdLoaded,payload:{}})}catch(e){this._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.AdaptorInitAdError+"_".concat(e.message)}})}}},{key:"startAd",value:function(){var _this2=this;try{get_default()(getPrototypeOf_default()(HtmlBidAdaptor.prototype),"startAd",this).call(this),this._timer.start(),this._adHtmlWrapper=new AdHtmlWrapper_AdHtmlWrapper(this.settings.mime,this.settings.html,this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,this.settings.globalDomUtilsService,this.settings.trackingService),this._htmlSubscriptions.push(this._adHtmlWrapper.onDisplayAd.subscribe(function(){_this2._sendVpaidEvent({type:VastConfig.b.AdStarted}),_this2._sendVpaidEvent({type:VastConfig.b.AdVideoStart}),_this2._sendVpaidEvent({type:VastConfig.b.AdImpression,payload:{}})}),this._adHtmlWrapper.onError.subscribe(function(postbidReason){_this2._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:postbidReason}}),_this2._timer.stop()})),this._adHtmlWrapper.initializeAd(this._$adSlot,{width:this._width,height:this._height})}catch(e){this._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.AdaptorStartAdError+"_".concat(e.message)}})}}},{key:"stopAd",value:function(reason){try{get_default()(getPrototypeOf_default()(HtmlBidAdaptor.prototype),"stopAd",this).call(this,reason),this._timer.stop(),this._sendVpaidEvent({type:VastConfig.b.AdStopped,payload:{shouldTrackPostBid:!0}})}catch(e){this._logVpaidEventError("HtmlBidAdaptor","stopAd",e)}}},{key:"skipAd",value:function(){try{get_default()(getPrototypeOf_default()(HtmlBidAdaptor.prototype),"skipAd",this).call(this),this._sendVpaidEvent({type:VastConfig.b.AdSkipped})}catch(e){this._logVpaidEventError("HtmlBidAdaptor","skipAd",e)}}},{key:"pauseAd",value:function(){try{this._timer.stop(),this._sendVpaidEvent({type:VastConfig.b.AdPaused})}catch(e){this._logVpaidEventError("HtmlBidAdaptor","pauseAd",e)}}},{key:"resumeAd",value:function(){try{this._timer.start(),this._sendVpaidEvent({type:VastConfig.b.AdPlaying})}catch(e){this._logVpaidEventError("HtmlBidAdaptor","resumeAd",e)}}},{key:"collapseAd",value:function(){}},{key:"expandAd",value:function(){}},{key:"getAdDuration",value:function(){return this._timer.timerDuration/TimeConfig.f}},{key:"getAdRemainingTime",value:function(){return this._timer.timeRemaining/TimeConfig.f}},{key:"getAdVolume",value:function(){return 0}},{key:"getAdMediaSize",value:function(){return{width:this._adHtmlWrapper.getAdMediaWidth(),height:this._adHtmlWrapper.getAdMediaHeight()}}},{key:"setAdVolume",value:function(volume){}},{key:"resizeAd",value:function(width,height,viewMode){this._width=width,this._height=height}},{key:"_destroy",value:function(){var _a;try{get_default()(getPrototypeOf_default()(HtmlBidAdaptor.prototype),"_destroy",this).call(this),this._timer.stop(),clearSubscriptions(this._htmlSubscriptions),null===(_a=this._adHtmlWrapper)||void 0===_a||_a.destroy()}catch(e){this._logVpaidEventError("HtmlBidAdaptor","_destroy",e)}}},{key:"adVideoUrl",get:function(){return this._vastMediaType}},{key:"declaredDurationInSeconds",get:function(){return this.settings.adManagerLineItem.protoLineItem.overlayTime}}]),HtmlBidAdaptor}(ABaseBidAdaptor_ABaseBidAdaptor),HtmlCallAdaptor_HtmlCallAdaptor=function(){function HtmlCallAdaptor(settings){classCallCheck_default()(this,HtmlCallAdaptor),this.settings=settings,this.metrics={created:(new Date).getTime()}}return createClass_default()(HtmlCallAdaptor,[{key:"fetchBid",value:function(){if(this.metrics.fetchStart=(new Date).getTime(),!this._isValidMimeType(this.settings.mime))return Promise.reject(AdCallRejectionReason.HTMLUnknownMimeType);var adaptor=new HtmlBidAdaptor_HtmlBidAdaptor({id:this.settings.id,adManagerLineItem:this.settings.adManagerLineItem,trackers:this.settings.trackersInformation,html:this.settings.html,mime:this.settings.mime,minDimensions:this.settings.dimensions,requestMetadata:this.settings.requestMetadata,callingState:this.settings.callingState,globalDomUtilsService:this.settings.globalDomUtilsService,trackingService:this.settings.trackingService,viewabilityService:this.settings.viewabilityService,adContainer:this.settings.adContainer,cpm:this.settings.cpm,obfuscatedPrice:this.settings.obfuscatedPrice,adEnforcer:this.settings.adEnforcer,successRate:this.settings.successRate,os:this.settings.os,adSlotContainerRecycler:this.settings.adSlotContainerRecycler,externalCreativeId:this.settings.creativeId,bidSlotId:this.settings.bidSlotId,urlSuffixerService:this.settings.urlSuffixerService});return this.metrics.fetchEnd=(new Date).getTime(),Promise.resolve(adaptor)}},{key:"_isValidMimeType",value:function(mimeType){return Object.keys(MonetisationConfig.b).some(function(key){return MonetisationConfig.b[key]===mimeType})}}]),HtmlCallAdaptor}(),RtbCallAggregator_RtbCallAggregator=function(){function RtbCallAggregator(_isOutstream,_skipAdsSettings,_app,_adMacroReplacer,_adContainerMap,_adRequestGatekeeper,_adEnforcer,_adSlotContainerRecycler){classCallCheck_default()(this,RtbCallAggregator),this._isOutstream=_isOutstream,this._skipAdsSettings=_skipAdsSettings,this._app=_app,this._adMacroReplacer=_adMacroReplacer,this._adContainerMap=_adContainerMap,this._adRequestGatekeeper=_adRequestGatekeeper,this._adEnforcer=_adEnforcer,this._adSlotContainerRecycler=_adSlotContainerRecycler,this._endpointRequestNumber=0,this._cachedFloorPriceMap=new Map}return createClass_default()(RtbCallAggregator,[{key:"request",value:function(requestData){var _this=this,_requestData$callingS=requestData.callingState.adContainerState.get(protos.ProtoAdType.Video),width=_requestData$callingS.width,height=_requestData$callingS.height,isValidSize=this._isValidSize(width,height),rtbRequestData=this._getRtbRequestData(requestData);return!isValidSize||Object.keys(rtbRequestData.lineItems).length<=0?Promise.resolve({bids:[],noBids:[]}):this._fetchRtbResponse(rtbRequestData).then(function(rtbResponse){return _this._parseRtbResponse(rtbResponse,requestData)}).catch(function(error){return Object(Logging.a)({message:"RtbCallAggregator",exception:error.message,level:protos.ProtoLoggingLevelEnum.FATAL,sendMaxLog:!0}),{bids:[],noBids:[]}})}},{key:"destroy",value:function(){}},{key:"_parseRtbResponse",value:function(rtbResponse,requestData){var _this2=this,aggregatorResponse={bids:[],noBids:[]};return rtbResponse.lineItemResponses.forEach(function(lineItemResponse){var adManagerLineItem=getLineItemByAdvertiserId(requestData.lineItemRequestDataList,lineItemResponse.id);Object(TypeUtils.e)(lineItemResponse.cachedFloorPrice)&&_this2._cachedFloorPriceMap.set(lineItemResponse.id,lineItemResponse.cachedFloorPrice),lineItemResponse.bids.forEach(function(bid){var adapter=_this2._createAdaptorFromRtbBid(bid,adManagerLineItem,rtbResponse,requestData.callingState);adapter&&aggregatorResponse.bids.push(adapter)}),lineItemResponse.noBids.forEach(function(noBid){aggregatorResponse.noBids.push(_this2._createNoBidFromRtbNoBid(noBid,adManagerLineItem,rtbResponse))})}),aggregatorResponse}},{key:"_createNoBidFromRtbNoBid",value:function(noBid,lineItem,rtbResponse){return{lineItem:lineItem,requestMetadata:new InternalRequestTrackingMetadata_InternalRequestTrackingMetadata({requestedFloorPrice:noBid.requestedFloorPrice,requestedFloorPriceIndex:noBid.floorPriceFactorIndex,rtbRequestNumber:this._endpointRequestNumber,syncedUser:noBid.syncedUser,partnerCustomHeaders:noBid.partnerCustomHeaders,partnerReason:noBid.partnerReason,requestTrackingHandledByServer:!0}),reason:noBid.connatixReason}}},{key:"_createAdaptorFromRtbBid",value:function(protoBid,lineItem,rtbResponse,callingState){var bid=protoBid,trackerInformation=this._getRtbBidTrackers(bid,lineItem),internalTrackingInformation=new InternalRequestTrackingMetadata_InternalRequestTrackingMetadata({requestedFloorPrice:bid.requestedFloorPrice,requestedFloorPriceIndex:bid.floorPriceFactorIndex,syncedUser:bid.syncedUser,rtbRequestNumber:this._endpointRequestNumber,encryptedPrice:bid.encryptedPrice,dspId:bid.dspId,rtbAdomain:bid.adomain,rtbSeatId:bid.seatId,rtbCampainId:bid.campaignId,cnxBidId:bid.cnxBidId,requestTrackingHandledByServer:!0,logAuctionInformation:bid.logAuctionInformation}),bidSlotId=AdUtils_generateBidSlotId();switch(lineItem.protoLineItem.adType){case protos.ProtoAdType.Video:return new VastXmlCallAdaptor_VastXmlCallAdaptor({id:Object(GeneralUtils.c)(),adManagerLineItem:lineItem,replaceTrackingMacros:!0,trackersInformation:trackerInformation,xml:bid.vastTag,bidSlotId:bidSlotId,requestMetadata:internalTrackingInformation,callingState:callingState,adMacroReplacer:this._adMacroReplacer,adContainer:this._adContainerMap.get(lineItem.protoLineItem.adType),globalDomUtilsService:this._app.services.GlobalDomUtilsService,viewabilityService:this._app.services.ViewabilityService,trackingService:this._app.services.TrackingService,obfuscatedPrice:bid.gtkpbp,adEnforcer:this._adEnforcer,creativeId:bid.creativeId,successRate:bid.successRate,os:this._app.config.os.os,adSlotContainerRecycler:this._adSlotContainerRecycler,pageUrl:this._app.config.pageUrl,urlSuffixerService:this._app.services.UrlSuffixerService});case protos.ProtoAdType.Overlay:return new HtmlCallAdaptor_HtmlCallAdaptor({id:Object(GeneralUtils.c)(),adManagerLineItem:lineItem,dimensions:{width:bid.width,height:bid.height},html:bid.vastTag,mime:bid.mime,bidSlotId:bidSlotId,replaceTrackingMacros:!0,requestMetadata:internalTrackingInformation,trackersInformation:trackerInformation,callingState:callingState,adContainer:this._adContainerMap.get(lineItem.protoLineItem.adType),globalDomUtilsService:this._app.services.GlobalDomUtilsService,viewabilityService:this._app.services.ViewabilityService,trackingService:this._app.services.TrackingService,obfuscatedPrice:bid.gtkpbp,adEnforcer:this._adEnforcer,creativeId:bid.creativeId,successRate:bid.successRate,os:this._app.config.os.os,adSlotContainerRecycler:this._adSlotContainerRecycler,urlSuffixerService:this._app.services.UrlSuffixerService})}}},{key:"_getRtbBidTrackers",value:function(bid,lineItem){var _trackerInformation$a,trackerInformation=new TrackersInformation_TrackersInformation;addTrackersFromCreative(lineItem.protoLineItem.trackers,trackerInformation);var impressionTrackerList=[].concat(toConsumableArray_default()(bid.billingNoticeUrlList),[bid.adQualityCheckUrl]).filter(function(url){return Object(TypeUtils.h)(url)}).map(function(url){return createImageTracker(url)});return(_trackerInformation$a=trackerInformation.adImpression).push.apply(_trackerInformation$a,toConsumableArray_default()(impressionTrackerList)),Object(TypeUtils.h)(bid.winNoticeUrl)&&trackerInformation.adWin.push(createImageTracker(bid.winNoticeUrl)),trackerInformation}},{key:"_tryGetRtbRequestLineItemSize",value:function(lineItem,callingState){if(lineItem.protoLineItem.adType===protos.ProtoAdType.Overlay){var videoContainerSizes=callingState.adContainerState.get(protos.ProtoAdType.Video),lineItemContainerSizes=callingState.adContainerState.get(lineItem.protoLineItem.adType);if(videoContainerSizes.height!==lineItemContainerSizes.height||videoContainerSizes.width!==lineItemContainerSizes.width)return{width:lineItemContainerSizes.width,height:lineItemContainerSizes.height}}return null}},{key:"_constructRtbRequestLineItems",value:function(lineItemRequestDataList,callingState){var _this3=this,lineitemsRequestModel={};return lineItemRequestDataList.filter(function(lineItem){return _this3._adRequestGatekeeper.shouldRequestLineItem(lineItem.adManagerLineItem.protoLineItem.advertiserLineItemId)}).forEach(function(lineItemRequestData){var _a,_b,cachedFloorPrice,lineItem=lineItemRequestData.adManagerLineItem,lineItemSize=_this3._tryGetRtbRequestLineItemSize(lineItem,callingState);_this3._cachedFloorPriceMap.has(lineItem.protoLineItem.advertiserLineItemId)&&(cachedFloorPrice=_this3._cachedFloorPriceMap.get(lineItem.protoLineItem.advertiserLineItemId)),lineitemsRequestModel[lineItem.protoLineItem.advertiserLineItemId]={availableRequests:lineItemRequestData.maxAvailableRequests,gdprConsent:_this3._app.services.UserManagerService.isConsent(lineItem.protoLineItem.vendorId),cachedFloorPrice:cachedFloorPrice,ignoredFloorPriceFactorIndexes:getUsedFloorPriceIndexes(lineItem),publisherLineItemId:lineItem.protoLineItem.publisherLineItemId,slotHeight:null===(_a=lineItemSize)||void 0===_a?void 0:_a.height,slotWidth:null===(_b=lineItemSize)||void 0===_b?void 0:_b.width}}),lineitemsRequestModel}},{key:"_getRtbRequestData",value:function(aggregatorRequest){var _aggregatorRequest$ca=aggregatorRequest.callingState.adContainerState.get(protos.ProtoAdType.Video),width=_aggregatorRequest$ca.width,height=_aggregatorRequest$ca.height,viewability=_aggregatorRequest$ca.viewability;return{metadata:this._app.services.TrackingService.getMetadataModel(),gdprCompliant:this._app.services.UserManagerService.isGDPR(),gdprConsentData:this._app.services.UserManagerService.getConsentPayload(),soundOn:aggregatorRequest.callingState.sound,videoHeight:height,videoWidth:width,testMode:"true"===Object(HrefUtils.b)("cnxRtbTest",this._app.config.pageUrl),explorationMode:this._app.config.explorationMode,viewability:viewability,outstream:this._isOutstream,domainURL:this._app.config.domainURL,isClickToPlay:aggregatorRequest.callingState.clickToPlay,appVersion:this._app.config.appVersion,deviceID:this._app.services.UserManagerService.getDeviceId(),isCcpaBlockingUserInfo:!this._app.services.UserManagerService.isSellUserAllowed(),usPrivacyString:this._app.services.UserManagerService.getUsPrivacyString(),adSkippability:this._skipAdsSettings.adSkippability,skipAdAfter:this._skipAdsSettings.skipAdAfter,gdprConsentMode:this._app.services.UserManagerService.gdprConsentMode,customMacros:this._app.services.MacrosService.getExtraMacros(),maxAdDuration:aggregatorRequest.maxAdDuration,lineItems:this._constructRtbRequestLineItems(aggregatorRequest.lineItemRequestDataList,aggregatorRequest.callingState),maxBidPrice:aggregatorRequest.maxBidPrice,adsMustBeSkippableIfLongerThan:this._skipAdsSettings.adsMustBeSkippableIfLongerThan}}},{key:"_fetchRtbResponse",value:function(requestData){return this._endpointRequestNumber++,XhrUtils.a.sendProtoRequest({endpoint:EndPointResolver.a.endPoints.api.rtb,ProtoRequest:protos.ProtoRtbRequest,ProtoResponse:protos.ProtoRtbResponse,requestData:requestData,queryParams:defineProperty_default()({},PlayerConfig.b,EnvironmentConfig.a.version),logError:!1})}},{key:"_isValidSize",value:function(width,height){return 0!==width&&0!==height||(Object(Logging.a)({message:"AdManager_BidderCaller_dimensions",exception:"width:".concat(width,"_height:").concat(height,"_destroyed:").concat(LoggingStateStorage.a.isPlayerDestroyed()),throttle:5,level:protos.ProtoLoggingLevelEnum.FATAL,sendMaxLog:!0}),!1)}}]),RtbCallAggregator}(),UserConsentApiEnum=__webpack_require__(33),UserConsentPurposeEnum=__webpack_require__(57),HEADER_BIDDER_REQUIRED_PURPOSES=[UserConsentPurposeEnum.a.P1,UserConsentPurposeEnum.a.P2,UserConsentPurposeEnum.a.P4,UserConsentPurposeEnum.a.P7,UserConsentPurposeEnum.a.P8],HeaderBidderConsentHelper_HeaderBidderConsentHelper=function(){function HeaderBidderConsentHelper(_userManagerService){classCallCheck_default()(this,HeaderBidderConsentHelper),this._userManagerService=_userManagerService}return createClass_default()(HeaderBidderConsentHelper,[{key:"_isPrebidJsGdprConsentSupported",value:function(bidderName,gdprApiType){var defaultSupportList=[];switch(gdprApiType){case UserConsentApiEnum.a.CmpApi:defaultSupportList=PrebidBiddersTCF1SupportList;break;case UserConsentApiEnum.a.TcfApi:defaultSupportList=PrebidBiddersTCF2SupportList}return Object(ArrayUtils.g)(bidderName,defaultSupportList)}},{key:"_isBidderGdprCallable",value:function(bidderName){var gdprApiType=this._userManagerService.getGdprConsentApiType();if(this._isPrebidJsGdprConsentSupported(bidderName,gdprApiType))return!0;var bidderVendorId=PrebidBiddersVendorMapping[bidderName]||"";return this._userManagerService.isConsent(bidderVendorId,HEADER_BIDDER_REQUIRED_PURPOSES)}},{key:"_isBidderCcpaCallable",value:function(bidderName){return!!Object(ArrayUtils.g)(bidderName,PrebidBiddersCcpaSupportList)||!!this._userManagerService.isSellUserAllowed()}},{key:"isBidderCallable",value:function(bidderName){return this._userManagerService.isGDPR()?this._isBidderGdprCallable(bidderName):!this._userManagerService.isCcpaApplicable()||this._isBidderCcpaCallable(bidderName)}}]),HeaderBidderConsentHelper}(),HeaderBidderConfig_getPrebidJSConfig=function(isGDPR,isCCPA,supplyChainSettings,pageUrl){var prebidJsConfig={usePrebidCache:!0,cache:{url:"https://prebid.adnxs.com/pbc/v1/cache"},userSync:{syncEnabled:!0,iframeEnabled:!0,pixelEnabled:!0,filterSettings:{iframe:{bidders:"*",filter:"include"},image:{bidders:"*",filter:"include"}},syncsPerBidder:0,syncDelay:3e3,auctionDelay:0,aliasSyncEnabled:!0,userIds:[{name:"criteo"},{name:"pubCommonId",params:{enableSharedId:!0},storage:{type:"cookie",name:"_pubcid",expires:180}},{name:"flocId",params:{token:"A3dHTSoNUMjjERBLlrvJSelNnwWUCwVQhZ5tNQ+sll7y+LkPPVZXtB77u2y7CweRIxiYaGwGXNlW1/dFp8VMEgIAAAB+eyJvcmlnaW4iOiJodHRwczovL3NoYXJlZGlkLm9yZzo0NDMiLCJmZWF0dXJlIjoiSW50ZXJlc3RDb2hvcnRBUEkiLCJleHBpcnkiOjE2MjYyMjA3OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"}},{name:"uid2"}]},ix:{timeout:900}};return supplyChainSettings&&(prebidJsConfig.schain=function(supplyChainSettings){return{validation:"strict",config:{ver:"1.0",complete:1,nodes:[{asi:supplyChainSettings.businessDomain,hp:1,sid:Object(TypeUtils.h)(supplyChainSettings.supplyChainId)?supplyChainSettings.supplyChainId:null}]}}}(supplyChainSettings)),(isGDPR||isCCPA)&&(prebidJsConfig.consentManagement=function(isGDPR,isCCPA){return isGDPR?{gdpr:{cmpApi:"iab",timeout:2e3,defaultGdprScope:!0,allowAuctionWithoutConsent:!1,rules:[{purpose:"storage",enforcePurpose:!0,enforceVendor:!0},{purpose:"basicAds",enforcePurpose:!0,enforceVendor:!0},{purpose:"measurement",enforcePurpose:!0,enforceVendor:!0}]}}:isCCPA?{usp:{cmpApi:"iab",timeout:2e3}}:{}}(isGDPR,isCCPA)),Object(TypeUtils.h)(pageUrl)&&(prebidJsConfig.pageUrl=pageUrl),prebidJsConfig},connatixPrebidMimes=toConsumableArray_default()(PREBIDJS_VIDEO_MIME_TYPES),connatixPrebidVastProtocols=[PREBIDJS_PROTOCOL.VAST_2_WRAPPER,PREBIDJS_PROTOCOL.VAST_2,PREBIDJS_PROTOCOL.VAST_3,PREBIDJS_PROTOCOL.VAST_3_WRAPPER],connatixPrebidVpaidProtocols=[PREBIDJS_API.VPAID_1,PREBIDJS_API.VPAID_2],headerBidderParamsHandlerMap=(_headerBidderParamsHa={},defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.AppNexus,function(params,config){var appNexusParams=Object.assign({},params),floorPrice=config.floorPrice;return Object(TypeUtils.e)(floorPrice)&&(appNexusParams.reserve=floorPrice),appNexusParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.DistrictM,function(params,config){var districtMBidParams=Object.assign({},params),floorPrice=config.floorPrice;return Object(TypeUtils.e)(floorPrice)&&(districtMBidParams.reserve=floorPrice),districtMBidParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.Telaria,function(params,config){var telariaParams=Object.assign({},params);return params.srcPageUrl||(telariaParams.srcPageUrl=config.pageUrl),telariaParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.OneVideo,function(params,config){Object(TypeUtils.h)(params.pubId)||Object(Logging.a)({message:"AdManager_HeaderBidder_OneVideo_pubId_missing",level:protos.ProtoLoggingLevelEnum.FATAL,throttle:2,sendMaxLog:!1});var oneVideoParams=Object.assign(Object.assign({},params),{pubId:params.pubId,video:{playerWidth:Math.floor(config.playerWidth),playerHeight:Math.floor(config.playerHeight),mimes:connatixPrebidMimes,protocols:connatixPrebidVastProtocols,api:connatixPrebidVpaidProtocols},site:{page:config.pageUrl}}),floorPrice=config.floorPrice;return Object(TypeUtils.e)(floorPrice)&&(oneVideoParams.bidfloor=floorPrice),oneVideoParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.IndexExchange,function(params,config){var siteId=params.siteId;if(Object(TypeUtils.h)(siteId)){var protocols=Object.keys(PREBIDJS_PROTOCOL).map(function(key){return PREBIDJS_PROTOCOL[key]}),indexExchangeBidParams={siteId:siteId,size:[Math.floor(config.playerWidth),Math.floor(config.playerHeight)],video:{mimes:PREBIDJS_VIDEO_MIME_TYPES,minduration:0,maxduration:config.maxDuration,protocols:protocols}};Object(TypeUtils.d)(params.minduration)&&(indexExchangeBidParams.video.minduration=params.minduration),Object(TypeUtils.d)(params.maxduration)&&params.maxduration<=config.maxDuration&&(indexExchangeBidParams.video.maxduration=params.maxduration),Object(TypeUtils.h)(params.id)&&(indexExchangeBidParams.id=params.id);var floorPrice=config.floorPrice;return Object(TypeUtils.e)(floorPrice)&&(indexExchangeBidParams.bidFloor=floorPrice,indexExchangeBidParams.bidFloorCur="USD"),indexExchangeBidParams}Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_IX_adapter_missing_siteId",callStack:config.lineItemId})}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.Rubicon,function(params,config){var rubiconParams=Object.assign({},params),floorPrice=config.floorPrice;return Object(TypeUtils.e)(floorPrice)&&(rubiconParams.floor=floorPrice),rubiconParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.RhythmOne,function(params,config){var rhythmOneParams=Object.assign({},params),floorPrice=config.floorPrice;return Object(TypeUtils.e)(floorPrice)&&(rhythmOneParams.floor=floorPrice),rhythmOneParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.Pubmatic,function(params,config){var pubmaticParams=Object.assign({},params),floorPrice=config.floorPrice;return Object(TypeUtils.e)(floorPrice)&&(pubmaticParams.kadfloor=String(floorPrice)),pubmaticParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.SpotX,function(params,config){var spotXParams=Object.assign({},params);spotXParams.hide_skin=!0;var floorPrice=config.floorPrice;return Object(TypeUtils.e)(floorPrice)&&(spotXParams.price_floor=floorPrice),config.isOutstream&&(spotXParams.outstream_options={slot:config.bidSlotId}),spotXParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.MediaNet,function(params,config){var mediaNetParams=Object.assign({},params);Object(TypeUtils.h)(mediaNetParams.cid)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_MediaNet_adapter_missing_cid",callStack:config.lineItemId}),Object(TypeUtils.h)(mediaNetParams.crid)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_MediaNet_adapter_missing_crid",callStack:config.lineItemId});var floorPrice=config.floorPrice;return Object(TypeUtils.e)(floorPrice)&&(mediaNetParams.bidFloor=floorPrice),mediaNetParams.video={api:Object.keys(PREBIDJS_API).map(function(key){return PREBIDJS_API[key]}),mimes:Object.keys(PREBIDJS_VIDEO_MIME_TYPES).map(function(key){return PREBIDJS_VIDEO_MIME_TYPES[key]}),protocols:Object.keys(PREBIDJS_PROTOCOL).map(function(key){return PREBIDJS_PROTOCOL[key]}),maxDuration:config.maxDuration,w:config.playerWidth,h:config.playerHeight},mediaNetParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.Adman,function(params,config){var admanParams=Object.assign({},params);return Object(TypeUtils.h)(admanParams.placementId)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_Adman_adapter_missing_placementId",callStack:config.lineItemId}),admanParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.IronSource,function(params,config){var ironSourceParams=Object.assign({},params);Object(TypeUtils.h)(ironSourceParams.isOrg)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_IronSource_adapter_missing_isOrg_string",callStack:config.lineItemId});var floorPrice=config.floorPrice;return Object(TypeUtils.e)(floorPrice)&&(ironSourceParams.floorPrice=floorPrice),ironSourceParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.Undertone,function(params,config){var undertoneParams=Object.assign({},params);return Object(TypeUtils.h)(undertoneParams.placementId)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_Undertone_adapter_missing_placementId",callStack:config.lineItemId}),Object(TypeUtils.d)(undertoneParams.publisherId)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_Undertone_adapter_missing_publisherId",callStack:config.lineItemId}),undertoneParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.SynacorMedia,function(params,config){var synacorMediaParams=Object.assign({},params);Object(TypeUtils.h)(synacorMediaParams.seatId)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_SynacorMedia_adapter_missing_seatId",callStack:config.lineItemId}),Object(TypeUtils.h)(synacorMediaParams.tagId)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_SynacorMedia_adapter_missing_tagId",callStack:config.lineItemId});var floorPrice=config.floorPrice;return Object(TypeUtils.e)(floorPrice)&&(synacorMediaParams.bidfloor=floorPrice),synacorMediaParams.video={api:Object.keys(PREBIDJS_API).map(function(key){return PREBIDJS_API[key]}),mimes:Object.keys(PREBIDJS_VIDEO_MIME_TYPES).map(function(key){return PREBIDJS_VIDEO_MIME_TYPES[key]}),protocols:Object.keys(PREBIDJS_PROTOCOL).map(function(key){return PREBIDJS_PROTOCOL[key]}),maxduration:config.maxDuration},synacorMediaParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.AmxRTB,function(params,config){var amxParams=Object.assign({},params),floorPrice=config.floorPrice;return Object(TypeUtils.e)(floorPrice)&&(amxParams.floor=floorPrice),amxParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.Smaato,function(params,config){var smaatoParams=Object.assign({},params);return Object(TypeUtils.h)(smaatoParams.publisherId)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_Smaato_adapter_missing_publisherId",callStack:config.lineItemId}),Object(TypeUtils.h)(smaatoParams.adspaceId)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_Smaato_adapter_missing_adspaceId",callStack:config.lineItemId}),smaatoParams}),defineProperty_default()(_headerBidderParamsHa,PrebidBiddersEnum.SmartAdServer,function(params,config){var smartAdServerParams=Object.assign({},params),floorPrice=config.floorPrice;Object(TypeUtils.e)(floorPrice)&&(smartAdServerParams.bidfloor=floorPrice);var smartAdServerVideo=Object.assign(Object.assign({},params.video),{protocol:PREBIDJS_PROTOCOL.VAST_3_WRAPPER});return smartAdServerParams.video=smartAdServerVideo,Object(TypeUtils.e)(smartAdServerParams.networkId)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_SmartAdServer_adapter_missing_networkId_integer",callStack:config.lineItemId}),Object(TypeUtils.e)(smartAdServerParams.formatId)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_SmartAdServer_adapter_missing_formatId_integer",callStack:config.lineItemId}),Object(TypeUtils.e)(smartAdServerParams.pageId)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_SmartAdServer_adapter_missing_pageId_integer",callStack:config.lineItemId}),Object(TypeUtils.e)(smartAdServerParams.siteId)||Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PrebidJS_SmartAdServer_adapter_missing_siteId_integer",callStack:config.lineItemId}),smartAdServerParams}),_headerBidderParamsHa),HeaderBidderUtils_getPrebidJsBidderName=function(bidderParamsJsonString,lineItemId){try{var headerBidderBidsArray=JSON.parse(bidderParamsJsonString);return headerBidderBidsArray.length>1&&Object(Logging.a)({message:"AdManager_AdSourceWrappe_multiple_bidders",level:protos.ProtoLoggingLevelEnum.WARNING,callStack:lineItemId,exception:bidderParamsJsonString,throttle:1,sendMaxLog:!1}),headerBidderBidsArray[0].bidder}catch(e){Object(Logging.a)({message:"AdManager_AdSourceWrapper_cannot_get_bidder",level:protos.ProtoLoggingLevelEnum.WARNING,callStack:lineItemId,exception:bidderParamsJsonString,throttle:2,sendMaxLog:!1})}},HeaderBidderRequester_HeaderBidderRequester=function(){function HeaderBidderRequester(_schainSettings,_pageUrl,_isOutstream,_isGDPR,_isCCPA){classCallCheck_default()(this,HeaderBidderRequester),this._schainSettings=_schainSettings,this._pageUrl=_pageUrl,this._isOutstream=_isOutstream,this._isGDPR=_isGDPR,this._isCCPA=_isCCPA}return createClass_default()(HeaderBidderRequester,[{key:"requestHeaderBidder",value:function(requestDataList,playerWidth,playerHeight){var _this=this;return new Promise(function(resolve,reject){_this._insertPrebidJsScriptIfNeeded().then(function(){var requestPromiseList=requestDataList.map(function(requestData){return _this._requestHeaderBidderAdSources(requestData,playerWidth,playerHeight).then(function(prebidAdSourcesResponse){return prebidAdSourcesResponse})});Promise.all(requestPromiseList).then(function(prebidResponseList){resolve(prebidResponseList)})}).catch(function(e){reject(protos.ConnatixNoBidReasonEnum.NoBid)})})}},{key:"_requestHeaderBidderAdSources",value:function(requestData,playerWidth,playerHeight){var _this2=this;return new Promise(function(resolve){var promises=[];if(requestData.availableRequests>0){var floorPrices=requestData.lineItem.floorPrices;if(Object(ArrayUtils.h)(floorPrices)){promises=_this2._getPredictedFloorPrices(floorPrices,requestData.availableRequests,requestData.maxBidPrice).map(function(floorPriceData){return _this2._getPrebidRequestPromise(requestData.lineItem,floorPriceData.floorPrice,floorPriceData.floorPriceIndex,playerWidth,playerHeight,floorPrices,requestData.maxAdDuration)})}else{var promise=_this2._getPrebidRequestPromise(requestData.lineItem,requestData.lineItem.floorPrice,-1,playerWidth,playerHeight,floorPrices,requestData.maxAdDuration);promises.push(promise)}}Promise.all(promises).then(function(results){var bids=[],noBids=[],lineItemId=requestData.lineItem.advertiserLineItemId;results.forEach(function(result){result.reason?noBids.push(result):bids.push(result)}),resolve({bids:bids,noBids:noBids,lineItemId:lineItemId})})})}},{key:"_getPrebidRequestPromise",value:function(lineItem,floorPrice,floorPriceIndex,playerWidth,playerHeight,floorPrices,maxAdDuration){var _this3=this;return new Promise(function(resolve){_this3._requestPrebidJsBids(lineItem,floorPrice,floorPriceIndex,playerWidth,playerHeight,floorPrices,maxAdDuration).then(function(bid){resolve(bid)}).catch(function(noBid){resolve(noBid)})})}},{key:"_insertPrebidJsScriptIfNeeded",value:function(){var _this4=this;return new Promise(function(resolve,reject){window.pbjs?(_this4._prebidJs=window.pbjs,resolve()):Object(DomUtils.A)({src:EndPointResolver.a.endPoints.assets.plugins.prebidScript},window.document.head,window,function(){_this4._prebidJs=window.pbjs,_this4._addPrebidJSConfig(),resolve()},function(){reject(protos.ConnatixNoBidReasonEnum.NoBid)},!0,"AdManager_HeaderBidder_unable_to_insert_prebidJs_script")})}},{key:"_addPrebidJSConfig",value:function(){var prebidJSConfig=HeaderBidderConfig_getPrebidJSConfig(this._isGDPR,this._isCCPA,this._schainSettings,this._pageUrl);window.pbjs.setConfig(prebidJSConfig)}},{key:"_requestPrebidJsBids",value:function(lineItem,floorPrice,floorPriceIndex,playerWidth,playerHeight,floorPrices,maxAdDuration){var _this5=this;return new Promise(function(resolve,reject){var prebidAdUnit=function(playerWidth,playerHeight,isOutstream,maxAdDuration,floorPrice){var prebidAdUnit={code:Object(GeneralUtils.c)(),mediaTypes:{video:{playerSize:[Math.floor(playerWidth),Math.floor(playerHeight)],context:isOutstream?"outstream":"instream",mimes:connatixPrebidMimes,protocols:connatixPrebidVastProtocols,linearity:PREBIDJS_LINEARILITY_LINEAR,api:connatixPrebidVpaidProtocols,frameworks:[PREBIDJS_API.VPAID_1,PREBIDJS_API.VPAID_2],maxduration:maxAdDuration,minDuration:0}},bids:[]};return Object(TypeUtils.e)(floorPrice)&&(prebidAdUnit.floors=function(floorPrice){return{currency:"USD",schema:{fields:["mediaType"]},values:{video:floorPrice}}}(floorPrice)),prebidAdUnit}(playerWidth,playerHeight,_this5._isOutstream,maxAdDuration,floorPrice);try{var prebidJsJSONString=lineItem.headerBidderBids;prebidAdUnit.bids=JSON.parse(prebidJsJSONString)}catch(e){return Object(Logging.a)({message:"AdManager_HeaderBidder_unable_to_parse_header_bidder",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.WARNING}),void reject({reason:protos.ConnatixNoBidReasonEnum.NoBid,floorPrice:floorPrice,floorPriceIndex:floorPriceIndex})}var bidSlotId=AdUtils_generateBidSlotId();prebidAdUnit.bids.forEach(function(bid){return _this5._setBidderParams(bid,playerWidth,playerHeight,floorPrice,lineItem.advertiserLineItemId,maxAdDuration,bidSlotId)}),_this5._prebidJs.que.push(function(){_this5._prebidJs.addAdUnits(prebidAdUnit);var bidRequestObj={timeout:lineItem.headerBidderTimeout,adUnits:[prebidAdUnit],bidsBackHandler:function(){try{var highestCpmBid;if(!(highestCpmBid=_this5._prebidJs.getHighestCpmBids(prebidAdUnit.code)[0]))return void reject({reason:protos.ConnatixNoBidReasonEnum.CsEmptyResponse,floorPrice:floorPrice,floorPriceIndex:floorPriceIndex});if(!_this5._validateHeaderBidderResponse(highestCpmBid))return Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.WARNING,message:"AdManager_HeaderBidder_no_content",exception:JSON.stringify(highestCpmBid)}),void reject({reason:protos.ConnatixNoBidReasonEnum.CsInvalidResponse,floorPrice:floorPrice,floorPriceIndex:floorPriceIndex});var cacheVastUrl=_this5._getCachedBidUrl(highestCpmBid),cpm=highestCpmBid.cpm||highestCpmBid.adResponse.ad.cpm,bid={adTag:cacheVastUrl,lineItemId:lineItem.advertiserLineItemId,floorPrice:floorPrice,floorPriceIndex:floorPriceIndex,cpm:cpm,slotId:bidSlotId};Object(TypeUtils.e)(floorPrice)&&cpm<floorPrice&&Object(Logging.a)({message:"AdManager_HeaderBidderRequester_cpm_lower_than_floorprice",level:protos.ProtoLoggingLevelEnum.WARNING,sendMaxLog:!1,throttle:5,exception:"floorPrices_".concat(floorPrices,"_index_").concat(floorPriceIndex,"_cpm_").concat(cpm,"_li_").concat(lineItem.advertiserLineItemId),callStack:HeaderBidderUtils_getPrebidJsBidderName(lineItem.headerBidderBids,lineItem.advertiserLineItemId)}),resolve(bid)}catch(e){Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.WARNING,message:"AdManager_HeaderBidder_Prebidjs_error",exception:e.message,callStack:e.stack}),reject({reason:protos.ConnatixNoBidReasonEnum.NoBid,floorPrice:floorPrice,floorPriceIndex:floorPriceIndex})}}};_this5._prebidJs.requestBids(bidRequestObj)})})}},{key:"_setBidderParams",value:function(bid,playerWidth,playerHeight,floorPrice,lineItemId,maxAdDuration,bidSlotId){var getParamsHandler=headerBidderParamsHandlerMap[bid.bidder];getParamsHandler&&(bid.params=getParamsHandler(bid.params,{playerWidth:playerWidth,playerHeight:playerHeight,maxDuration:maxAdDuration,pageUrl:this._pageUrl,floorPrice:floorPrice,lineItemId:lineItemId,isOutstream:this._isOutstream,bidSlotId:bidSlotId}))}},{key:"_validateHeaderBidderResponse",value:function(bid){return bid.adserverTargeting&&Object(TypeUtils.h)(bid.adserverTargeting.hb_cache_id)}},{key:"_getCachedBidUrl",value:function(bid){return"".concat("https://prebid.adnxs.com/pbc/v1/cache","?uuid=").concat(bid.adserverTargeting.hb_cache_id)}},{key:"_getPredictedFloorPrices",value:function(floorPrices,availableRequests,maxBidPrice){if(0===availableRequests)return[];var remainingRequestsToFill=availableRequests,floorPriceDataList=floorPrices.map(function(price,index){return{floorPrice:price,floorPriceIndex:index}}).filter(function(_ref){return _ref.floorPrice>=maxBidPrice&&remainingRequestsToFill>0&&(remainingRequestsToFill--,!0)});return floorPriceDataList.length||floorPriceDataList.push({floorPrice:maxBidPrice,floorPriceIndex:-1}),floorPriceDataList}}]),HeaderBidderRequester}(),PrebidCallAggregator_PrebidCallAggregator=function(){function PrebidCallAggregator(_isOutstream,_schainSettings,_app,_adMacroReplacer,_adContainerMap,_adEnforcer,_adSlotContainerRecycler,_loopAdWhenFinished){classCallCheck_default()(this,PrebidCallAggregator),this._isOutstream=_isOutstream,this._schainSettings=_schainSettings,this._app=_app,this._adMacroReplacer=_adMacroReplacer,this._adContainerMap=_adContainerMap,this._adEnforcer=_adEnforcer,this._adSlotContainerRecycler=_adSlotContainerRecycler,this._loopAdWhenFinished=_loopAdWhenFinished,this._prebidJsBidderNameMap=new Map,this._prebidRequester=new HeaderBidderRequester_HeaderBidderRequester(this._schainSettings,this._app.config.pageUrl,this._isOutstream,this._app.services.UserManagerService.isGDPR(),this._app.services.UserManagerService.isCcpaApplicable()),this._headerBidderConsentHelper=new HeaderBidderConsentHelper_HeaderBidderConsentHelper(this._app.services.UserManagerService)}return createClass_default()(PrebidCallAggregator,[{key:"request",value:function(requestData){var _this=this,_requestData$callingS=requestData.callingState.adContainerState.get(protos.ProtoAdType.Video),width=_requestData$callingS.width,height=_requestData$callingS.height,isValidSize=this._isValidSize(width,height),lineItemsThatCanBeCalled=this._filterOutLineItemsThatCannotBeCalled(requestData.lineItemRequestDataList);return Object(ArrayUtils.h)(lineItemsThatCanBeCalled)&&isValidSize?(requestData.lineItemRequestDataList=lineItemsThatCanBeCalled,this._fetchPrebidJsResponse(requestData).then(function(response){return Promise.resolve(_this._parsePrebidJsResponse(response,requestData))}).catch(function(){return Promise.resolve({bids:[],noBids:[]})})):Promise.resolve({bids:[],noBids:[]})}},{key:"destroy",value:function(){}},{key:"_parsePrebidJsResponse",value:function(response,request){var _this2=this,aggregatorResponse={bids:[],noBids:[]};return response.forEach(function(item){var adManagerLineItem=getLineItemByAdvertiserId(request.lineItemRequestDataList,item.lineItemId);item.bids.forEach(function(bid){var trackerInformation=new TrackersInformation_TrackersInformation,requestMetadata=new InternalRequestTrackingMetadata_InternalRequestTrackingMetadata({requestedFloorPrice:bid.floorPrice,requestedFloorPriceIndex:bid.floorPriceIndex,prebidJsBidderName:_this2._getPrebidBidderName(adManagerLineItem)});addTrackersFromCreative(adManagerLineItem.protoLineItem.trackers,trackerInformation),aggregatorResponse.bids.push(new VastUrlCallAdaptor_VastUrlCallAdaptor({id:Object(GeneralUtils.c)(),adManagerLineItem:adManagerLineItem,replaceTrackingMacros:!0,requestMetadata:requestMetadata,trackersInformation:trackerInformation,url:bid.adTag,callingState:request.callingState,adMacroReplacer:_this2._adMacroReplacer,adContainer:_this2._adContainerMap.get(adManagerLineItem.protoLineItem.adType),globalDomUtilsService:_this2._app.services.GlobalDomUtilsService,viewabilityService:_this2._app.services.ViewabilityService,trackingService:_this2._app.services.TrackingService,cpm:bid.cpm,adEnforcer:_this2._adEnforcer,os:_this2._app.config.os.os,adSlotContainerRecycler:_this2._adSlotContainerRecycler,bidSlotId:bid.slotId,loopAdWhenFinished:_this2._loopAdWhenFinished,pageUrl:_this2._app.config.pageUrl,urlSuffixerService:_this2._app.services.UrlSuffixerService}))}),item.noBids.forEach(function(noBid){var requestMetadata=new InternalRequestTrackingMetadata_InternalRequestTrackingMetadata({requestedFloorPrice:noBid.floorPrice,requestedFloorPriceIndex:noBid.floorPriceIndex});aggregatorResponse.noBids.push({lineItem:adManagerLineItem,requestMetadata:requestMetadata,reason:noBid.reason})})}),aggregatorResponse}},{key:"_fetchPrebidJsResponse",value:function(requestData){var _this3=this,_requestData$callingS2=requestData.callingState.adContainerState.get(protos.ProtoAdType.Video),width=_requestData$callingS2.width,height=_requestData$callingS2.height,lineitemRequestList=requestData.lineItemRequestDataList.map(function(lineItemRequestData){return _this3._getLineItemRequest(lineItemRequestData,requestData.maxAdDuration,requestData.maxBidPrice)});return this._prebidRequester.requestHeaderBidder(lineitemRequestList,width,height)}},{key:"_getLineItemRequest",value:function(lineItemRequestData,maxAdDuration,maxBidPrice){var lineItem=lineItemRequestData.adManagerLineItem;return{availableRequests:lineItemRequestData.maxAvailableRequests,lineItem:lineItem.protoLineItem,maxAdDuration:maxAdDuration,maxBidPrice:maxBidPrice}}},{key:"_filterOutLineItemsThatCannotBeCalled",value:function(lineItemRequestDataList){var _this4=this;return lineItemRequestDataList.filter(function(lineItemRequestData){var bidderName=_this4._getPrebidBidderName(lineItemRequestData.adManagerLineItem);return _this4._isAdBidderCallable(bidderName)})}},{key:"_isValidSize",value:function(width,height){return 0!==width&&0!==height||(Object(Logging.a)({message:"AdManager_PrebidAggregator_dimensions",exception:"width:".concat(width,"_height:").concat(height,"_destroyed:").concat(LoggingStateStorage.a.isPlayerDestroyed()),throttle:5,level:protos.ProtoLoggingLevelEnum.FATAL,sendMaxLog:!0}),!1)}},{key:"_isAdBidderCallable",value:function(bidderName){return this._headerBidderConsentHelper.isBidderCallable(bidderName)}},{key:"_getPrebidBidderName",value:function(lineItem){var prebidJsBidderName=this._prebidJsBidderNameMap.get(lineItem);return Object(TypeUtils.h)(prebidJsBidderName)?prebidJsBidderName:HeaderBidderUtils_getPrebidJsBidderName(lineItem.protoLineItem.headerBidderBids,lineItem.protoLineItem.advertiserLineItemId)||""}}]),PrebidCallAggregator}(),TamConfig_libPropertyName="apstag",TamConfig_mediaType="video",TamRequester_TamRequester=function(){function TamRequester(_app,_amazonTamSlotId){var _this=this;classCallCheck_default()(this,TamRequester),this._app=_app,this._amazonTamSlotId=_amazonTamSlotId,this._onTopFrameLoad=function(){_this._tamLib||_this._bindToTamScript(),_this._retryIntervalId&&clearInterval(_this._retryIntervalId),_this._tamLib||Object(Logging.a)({message:"TamRequester_TAM_lib_not_found_on_page_loaded",level:protos.ProtoLoggingLevelEnum.WARNING})};var global=this._app.config.topWindow;this._topFrame=Object(GeneralUtils.f)(global).topFrame,this._bindToTamScript()}return createClass_default()(TamRequester,[{key:"requestBids",value:function(lineItemList){var _this2=this,tamRequests=lineItemList.map(function(lineItem){return _this2._fetchTamLineItemResponse(lineItem)});return Promise.all(tamRequests)}},{key:"destroy",value:function(){this._retryIntervalId&&clearInterval(this._retryIntervalId),this._topFrame.removeEventListener("load",this._onTopFrameLoad)}},{key:"_fetchTamLineItemResponse",value:function(lineItem){var _this3=this;return this._fetchBids(this._amazonTamSlotId,TamConfig_mediaType,lineItem.amazonDealId).then(function(tamBid){return lineItem.amazonDealId?_this3._getBidResponseForTamDeal(lineItem,tamBid):_this3._callCoreTam(lineItem,tamBid)}).then(function(tamResponse){return{bids:[tamResponse],lineItemId:lineItem.advertiserLineItemId,noBids:[]}}).catch(function(reason){return{bids:[],lineItemId:lineItem.advertiserLineItemId,noBids:[{reason:reason}]}})}},{key:"_fetchBids",value:function(slotId,mediaType,dealId){var _this4=this;return new Promise(function(resolve,reject){_this4._tamLib?_this4._tamLib.fetchBids({slots:[{slotID:slotId,mediaType:mediaType}]},function(bids){Object(ArrayUtils.h)(bids)?Object(TypeUtils.h)(dealId)?resolve(_this4._processTamDealBidResponse(bids,dealId)):resolve(_this4._processTamBidResponse(bids)):reject(protos.ConnatixNoBidReasonEnum.EmptyResponse)}):reject(protos.ConnatixNoBidReasonEnum.NoLibInPage)})}},{key:"_processTamBidResponse",value:function(bids){var _this5=this;return new Promise(function(resolve,reject){var tamBids=_this5._getValidTamBids(bids);if(!Object(ArrayUtils.h)(tamBids))return _this5._logFetchBidsCreativeTypeMismatch(),void reject(protos.ConnatixNoBidReasonEnum.InvalidResponse);resolve(tamBids[0])})}},{key:"_processTamDealBidResponse",value:function(bids,dealId){var _this6=this;return new Promise(function(resolve,reject){var tamDealBids=_this6._getValidTamDealBids(bids);if(!Object(ArrayUtils.h)(tamDealBids))return _this6._logFetchBidsCreativeTypeMismatch(),void reject(protos.ConnatixNoBidReasonEnum.InvalidResponse);var dealBid=bids.find(function(bid){return bid.targeting.amzndeals.includes(dealId)});dealBid?resolve(dealBid):reject(protos.ConnatixNoBidReasonEnum.DealIdMismatch)})}},{key:"_getValidTamBids",value:function(bids){return bids.filter(function(bid){var _a;return!!(bid.amznbid||(null===(_a=bid.targeting)||void 0===_a?void 0:_a.amzniid))})}},{key:"_getValidTamDealBids",value:function(bids){return bids.filter(function(bid){var _a;return Object(ArrayUtils.h)(null===(_a=bid.targeting)||void 0===_a?void 0:_a.amzndeals)})}},{key:"_logFetchBidsCreativeTypeMismatch",value:function(){Object(Logging.a)({message:"TamRequester_FetchBids_CreativeType_Mismatch",throttle:1,level:protos.ProtoLoggingLevelEnum.FATAL})}},{key:"_callCoreTam",value:function(lineItem,bid){var _a,_this7=this,requestData={lineItemId:lineItem.advertiserLineItemId,code:bid.amznbid||(null===(_a=bid.targeting)||void 0===_a?void 0:_a.amznbid),metadata:this._app.services.TrackingService.getMetadataModel(),exploration:this._app.config.explorationMode};return new Promise(function(resolve,reject){XhrUtils.a.sendProtoRequest({endpoint:EndPointResolver.a.endPoints.api.tam,ProtoRequest:protos.ProtoCoreTamBidRequest,ProtoResponse:protos.ProtoCoreTamBidResponse,requestData:requestData,queryParams:defineProperty_default()({},PlayerConfig.b,EnvironmentConfig.a.version),logError:!0}).then(function(tamResponse){Object(TypeUtils.h)(tamResponse.errorMessage)?reject(protos.ConnatixNoBidReasonEnum.RequestException):tamResponse.encryptedBidPrice?resolve({encryptedPrice:tamResponse.encryptedBidPrice,vastTag:_this7._getVastTagForTamBid(bid),ofskp:tamResponse.ofskp,successRate:tamResponse.successRate,slotId:AdUtils_generateBidSlotId()}):reject(protos.ConnatixNoBidReasonEnum.InvalidResponse)}).catch(function(){reject(protos.ConnatixNoBidReasonEnum.RequestException)})})}},{key:"_getBidResponseForTamDeal",value:function(lineItem,bid){return{encryptedPrice:null,vastTag:this._getVastTagForTamDealBid(bid),ofskp:encodeBidPrice(lineItem.floorPrice),successRate:lineItem.successRate,slotId:AdUtils_generateBidSlotId()}}},{key:"_getVastTagForTamBid",value:function(bid){var _a,_b,amzniid=bid.amzniid||(null===(_a=bid.targeting)||void 0===_a?void 0:_a.amzniid),amznbid=bid.amznbid||(null===(_b=bid.targeting)||void 0===_b?void 0:_b.amznbid);return"".concat("https://aax.amazon-adsystem.com/e/dtb/vast","?b=").concat(amzniid,"&pp=").concat(amznbid,"&rnd=").concat(Object(GeneralUtils.c)())}},{key:"_getVastTagForTamDealBid",value:function(bid){var key=bid.helpers.targetingKeys[0];return"".concat("https://aax.amazon-adsystem.com/e/dtb/vast","?b=").concat(bid.targeting[key],"&rnd=").concat(Object(GeneralUtils.c)())}},{key:"_bindToTamScript",value:function(){var _this8=this;this._topFrame[TamConfig_libPropertyName]?this._tamLib=this._topFrame[TamConfig_libPropertyName]:this._retryIntervalId||"complete"!==this._topFrame.document.readyState&&(this._topFrame.addEventListener("load",this._onTopFrameLoad),this._retryIntervalId=setInterval(function(){_this8._bindToTamScript()},TimeConfig.f)),this._tamLib&&clearInterval(this._retryIntervalId)}}]),TamRequester}(),TamCallAggregator_TamCallAggregator=function(){function TamCallAggregator(_app,_amazonSlotId,_adMacroReplacer,_adContainerMap,_adEnforcer,_adSlotContainerRecycler){classCallCheck_default()(this,TamCallAggregator),this._app=_app,this._amazonSlotId=_amazonSlotId,this._adMacroReplacer=_adMacroReplacer,this._adContainerMap=_adContainerMap,this._adEnforcer=_adEnforcer,this._adSlotContainerRecycler=_adSlotContainerRecycler,this._tamRequester=new TamRequester_TamRequester(this._app,this._amazonSlotId)}return createClass_default()(TamCallAggregator,[{key:"request",value:function(requestData){var _this=this,_requestData$callingS=requestData.callingState.adContainerState.get(protos.ProtoAdType.Video),width=_requestData$callingS.width,height=_requestData$callingS.height;return this._isValidSize(width,height)?this._fetchTamResponse(requestData).then(function(response){return Promise.resolve(_this._parseTamResponse(response,requestData))}).catch(function(){return Promise.resolve({bids:[],noBids:[]})}):Promise.resolve({bids:[],noBids:[]})}},{key:"destroy",value:function(){this._tamRequester.destroy()}},{key:"_fetchTamResponse",value:function(requestData){var lineItemList=requestData.lineItemRequestDataList.map(function(lineItemRequestData){return lineItemRequestData.adManagerLineItem.protoLineItem});return this._tamRequester.requestBids(lineItemList)}},{key:"_parseTamResponse",value:function(response,request){var _this2=this,aggregatorResponse={bids:[],noBids:[]};return response.forEach(function(item){var adManagerLineItem=getLineItemByAdvertiserId(request.lineItemRequestDataList,item.lineItemId);item.bids.forEach(function(bid){var trackerInformation=new TrackersInformation_TrackersInformation,requestMetadata=new InternalRequestTrackingMetadata_InternalRequestTrackingMetadata({encryptedPrice:bid.encryptedPrice});addTrackersFromCreative(adManagerLineItem.protoLineItem.trackers,trackerInformation),aggregatorResponse.bids.push(new VastUrlCallAdaptor_VastUrlCallAdaptor({id:Object(GeneralUtils.c)(),adManagerLineItem:adManagerLineItem,replaceTrackingMacros:!0,requestMetadata:requestMetadata,trackersInformation:trackerInformation,url:bid.vastTag,bidSlotId:bid.slotId,callingState:request.callingState,adMacroReplacer:_this2._adMacroReplacer,adContainer:_this2._adContainerMap.get(adManagerLineItem.protoLineItem.adType),globalDomUtilsService:_this2._app.services.GlobalDomUtilsService,viewabilityService:_this2._app.services.ViewabilityService,trackingService:_this2._app.services.TrackingService,adEnforcer:_this2._adEnforcer,requestWithCredentials:!1,successRate:bid.successRate,obfuscatedPrice:bid.ofskp,os:_this2._app.config.os.os,adSlotContainerRecycler:_this2._adSlotContainerRecycler,pageUrl:_this2._app.config.pageUrl,urlSuffixerService:_this2._app.services.UrlSuffixerService}))}),item.noBids.forEach(function(noBid){aggregatorResponse.noBids.push({lineItem:adManagerLineItem,requestMetadata:new InternalRequestTrackingMetadata_InternalRequestTrackingMetadata,reason:noBid.reason})})}),aggregatorResponse}},{key:"_isValidSize",value:function(width,height){return 0!==width&&0!==height||(Object(Logging.a)({message:"AdManager_PrebidAggregator_dimensions",exception:"width:".concat(width,"_height:").concat(height,"_destroyed:").concat(LoggingStateStorage.a.isPlayerDestroyed()),throttle:5,level:protos.ProtoLoggingLevelEnum.FATAL,sendMaxLog:!0}),!1)}}]),TamCallAggregator}(),GPT_SUPPORTED_SIZES=[[88,31],[120,20],[120,30],[120,60],[120,90],[125,125],[168,28],[168,42],[180,150],[200,200],[200,446],[216,36],[216,54],[220,90],[234,60],[240,133],[250,250],[250,360],[292,30],[300,31],[300,50],[300,75],[300,100],[300,250],[320,50],[320,100],[320,240],[336,280],[400,350],[468,60],[480,320]],GptWrapper_GptWrapper=function(){function GptWrapper(_googletag,_domain,_adUnitPath){classCallCheck_default()(this,GptWrapper),this._googletag=_googletag,this._domain=_domain,this._adUnitPath=_adUnitPath,this._slotId="div-gpt-ad-1589549806211-".concat(Object(GeneralUtils.c)()),this._onDisplay=new Subject.a,this._onError=new Subject.a,this._onCreativeReceived=new Subject.a}return createClass_default()(GptWrapper,[{key:"getAdMediaHeight",value:function(){return this._googleTagIframe?this._googleTagIframe.clientHeight:0}},{key:"getAdMediaWidth",value:function(){return this._googleTagIframe?this._googleTagIframe.clientWidth:0}},{key:"initializeAd",value:function(adSlot,size){var _this=this;try{this._adSlot=adSlot,this._prepareAdSlot(adSlot);var adUnitSize=this._getAdUnitSizes(size.width,size.height);this._googletag.cmd.push(function(){_this._googleTagSlot=_this._googletag.defineSlot(_this._adUnitPath,adUnitSize,_this._slotId).addService(_this._googletag.pubads()).setTargeting("domains",_this._domain),_this._googletag.enableServices(),_this._subscribeToSlotEvents(_this._googleTagSlot),_this._googletag.pubads().isInitialLoadDisabled()&&_this._googletag.pubads().refresh([_this._googleTagSlot]),_this._googletag.display(_this._slotId)})}catch(e){this._onError.next(MonetisationConfig.c.WrapperInitAdError)}}},{key:"destroy",value:function(){var _this2=this;this._googletag.cmd.push(function(){_this2._googletag.destroySlots&&_this2._googleTagSlot&&_this2._googletag.destroySlots([_this2._googleTagSlot])})}},{key:"_subscribeToSlotEvents",value:function(googleTagSlot){var _this3=this;this._googletag.pubads().addEventListener("slotOnload",function(event){var _a,_b,_c;if(event.slot===googleTagSlot){try{var gptCreativeId=null===(_c=null===(_b=null===(_a=event)||void 0===_a?void 0:_a.slot)||void 0===_b?void 0:_b.getResponseInformation())||void 0===_c?void 0:_c.creativeId;gptCreativeId&&_this3._onCreativeReceived.next(gptCreativeId.toString())}catch(e){Object(Logging.a)({message:"AdManager_GptWrapper_creativeId",level:protos.ProtoLoggingLevelEnum.WARNING,exception:e.message,callStack:e.stack})}_this3._onDisplay.next()}}),this._googletag.pubads().addEventListener("slotRenderEnded",function(event){var _a;if(event.slot===_this3._googleTagSlot){try{_this3._googleTagIframe=null===(_a=_this3._adSlot)||void 0===_a?void 0:_a.getElementsByTagName("iframe")[0],Object(TypeUtils.a)(_this3._googleTagSlot)&&Object(DomUtils.H)(_this3._googleTagIframe.contentWindow,"GPTWrapper")}catch(e){}event.isEmpty&&_this3._onError.next(MonetisationConfig.c.AdxOverlayNoFill)}})}},{key:"_prepareAdSlot",value:function(adSlot){adSlot.id=this._slotId}},{key:"_getAdUnitSizes",value:function(maxWidth,maxHeight){return GPT_SUPPORTED_SIZES.filter(function(size){return!Array.isArray(size)||!Object(ArrayUtils.i)(size)||Object(ArrayUtils.h)(size)&&size[0]<=maxWidth&&size[1]<=maxHeight})}},{key:"onCreativeReceived",get:function(){return this._onCreativeReceived.asObservable()}},{key:"onDisplayAd",get:function(){return this._onDisplay.asObservable()}},{key:"onError",get:function(){return this._onError.asObservable()}}]),GptWrapper}(),GoogleConfig=__webpack_require__(100);function AdxBidAdaptor_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AD_PROGRESSION_TICK_MS=500,AdxBidAdaptor_AdxBidAdaptor=function(_ABaseBidAdaptor){inherits_default()(AdxBidAdaptor,_ABaseBidAdaptor);var _super=AdxBidAdaptor_createSuper(AdxBidAdaptor);function AdxBidAdaptor(settings){var _this$_quartileEventM,_this;classCallCheck_default()(this,AdxBidAdaptor),(_this=_super.call(this,settings)).settings=settings,_this.adMediaType="displayAdx",_this.adSourceType=protos.ProtoAdsourceTypeEnum.Unknown,_this._vastMediaType="adx",_this._quartileEventMap=(_this$_quartileEventM={},defineProperty_default()(_this$_quartileEventM,QuartilesEnum.FirstQuartile,VastConfig.b.AdVideoFirstQuartile),defineProperty_default()(_this$_quartileEventM,QuartilesEnum.SecondQuartile,VastConfig.b.AdVideoMidpoint),defineProperty_default()(_this$_quartileEventM,QuartilesEnum.ThirdQuartile,VastConfig.b.AdVideoThirdQuartile),defineProperty_default()(_this$_quartileEventM,QuartilesEnum.FourthQuartile,VastConfig.b.AdVideoComplete),_this$_quartileEventM),_this._adxSubscriptions=[];var durationInMs=_this.settings.adManagerLineItem.protoLineItem.overlayTime*TimeConfig.f;return _this._timer=new Timer_Timer(durationInMs,AD_PROGRESSION_TICK_MS),_this._adxSubscriptions.push(_this._timer.onTimeUpdate.subscribe(function(){_this._sendVpaidEvent({type:VastConfig.b.AdRemainingTimeChange})}),_this._timer.onTimeElapsed.subscribe(function(){_this.stopAd("adxTimerElapsed")}),_this._timer.onQuartile.subscribe(function(quartile){_this._sendVpaidEvent({type:_this._quartileEventMap[quartile],payload:{}})})),_this}return createClass_default()(AdxBidAdaptor,[{key:"initAd",value:function(width,height,viewMode,desireBitrate,creativeData,environmentVars,volume){var _this2=this;try{get_default()(getPrototypeOf_default()(AdxBidAdaptor.prototype),"initAd",this).call(this,width,height,viewMode,desireBitrate,creativeData,environmentVars,volume),this._cachedSize={width:width,height:height},this._fetchGoogleTag().then(function(googleTag){_this2._gptWrapper=new GptWrapper_GptWrapper(googleTag,_this2.settings.domain,_this2.settings.adxAdUnitPath),_this2._adxSubscriptions.push(_this2._gptWrapper.onCreativeReceived.subscribe(function(gptCreativeId){_this2.creativeId=gptCreativeId})),_this2._sendVpaidEvent({type:VastConfig.b.AdLoaded,payload:{skipOffset:0}})}).catch(function(e){_this2._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.AdxOverlayGptScriptLoad+"_".concat(e.message)}})})}catch(e){this._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.AdaptorInitAdError+"_".concat(e.message)}})}}},{key:"startAd",value:function(){var _this3=this;try{get_default()(getPrototypeOf_default()(AdxBidAdaptor.prototype),"startAd",this).call(this),this._adxSubscriptions.push(this._gptWrapper.onDisplayAd.subscribe(function(){_this3._sendVpaidEvent({type:VastConfig.b.AdStarted}),_this3._sendVpaidEvent({type:VastConfig.b.AdVideoStart}),_this3._sendVpaidEvent({type:VastConfig.b.AdImpression,payload:{}}),_this3._timer.start()}),this._gptWrapper.onError.subscribe(function(postbidReason){_this3._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:postbidReason}}),_this3._timer.stop()})),this._gptWrapper.initializeAd(this._$adSlot,this._cachedSize)}catch(e){this._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.AdaptorStartAdError+"_".concat(e.exception)}})}}},{key:"stopAd",value:function(reason){try{get_default()(getPrototypeOf_default()(AdxBidAdaptor.prototype),"stopAd",this).call(this,reason),this._timer.stop(),this._sendVpaidEvent({type:VastConfig.b.AdStopped,payload:{shouldTrackPostBid:!0}})}catch(e){this._logVpaidEventError("AdxBidAdaptor","stopAd",e)}}},{key:"resizeAd",value:function(width,height,viewMode){this._cachedSize&&(this._cachedSize.width=width,this._cachedSize.height=height)}},{key:"pauseAd",value:function(){try{this._timer.stop(),this._sendVpaidEvent({type:VastConfig.b.AdPaused})}catch(e){this._logVpaidEventError("AdxBidAdaptor","pauseAd",e)}}},{key:"resumeAd",value:function(){try{this._timer.start(),this._sendVpaidEvent({type:VastConfig.b.AdPlaying})}catch(e){this._logVpaidEventError("AdxBidAdaptor","resumeAd",e)}}},{key:"expandAd",value:function(){}},{key:"collapseAd",value:function(){}},{key:"skipAd",value:function(){try{get_default()(getPrototypeOf_default()(AdxBidAdaptor.prototype),"skipAd",this).call(this),this._sendVpaidEvent({type:VastConfig.b.AdSkipped})}catch(e){this._logVpaidEventError("AdxBidAdaptor","skipAd",e)}}},{key:"getAdRemainingTime",value:function(){return this._timer.timeRemaining/TimeConfig.f}},{key:"getAdDuration",value:function(){return this._timer.timerDuration/TimeConfig.f}},{key:"getAdVolume",value:function(){return 0}},{key:"getAdMediaSize",value:function(){return{width:this._gptWrapper.getAdMediaWidth(),height:this._gptWrapper.getAdMediaHeight()}}},{key:"setAdVolume",value:function(volume){}},{key:"_fetchGoogleTag",value:function(){var topWindow=Object(GeneralUtils.f)(window).topFrame;if(topWindow.googletag)return Promise.resolve(topWindow.googletag);return topWindow.googletag=window.googletag||{cmd:[]},new Promise(function(resolve,reject){Object(DomUtils.A)({src:GoogleConfig.a},topWindow.document.head,topWindow,function(){resolve(topWindow.googletag)},function(){reject()})})}},{key:"_destroy",value:function(){var _a;try{get_default()(getPrototypeOf_default()(AdxBidAdaptor.prototype),"_destroy",this).call(this),this._timer.stop(),clearSubscriptions(this._adxSubscriptions),null===(_a=this._gptWrapper)||void 0===_a||_a.destroy()}catch(e){this._logVpaidEventError("AdxBidAdaptor","_destroy",e)}}},{key:"adVideoUrl",get:function(){return this._vastMediaType}},{key:"declaredDurationInSeconds",get:function(){return this.settings.adManagerLineItem.protoLineItem.duration}}]),AdxBidAdaptor}(ABaseBidAdaptor_ABaseBidAdaptor),AdxCallAdaptor_AdxCallAdaptor=function(){function AdxCallAdaptor(settings){classCallCheck_default()(this,AdxCallAdaptor),this.settings=settings,this.metrics={created:(new Date).getTime()}}return createClass_default()(AdxCallAdaptor,[{key:"fetchBid",value:function(){this.metrics.fetchStart=(new Date).getTime();var adaptor=new AdxBidAdaptor_AdxBidAdaptor({id:this.settings.id,adManagerLineItem:this.settings.adManagerLineItem,trackers:this.settings.trackersInformation,adxAdUnitPath:this._getAdUnitPath(this.settings.url),requestMetadata:this.settings.requestMetadata,callingState:this.settings.callingState,domain:this.settings.pageDomain,adContainer:this.settings.adContainer,globalDomUtilsService:this.settings.globalDomUtilsService,viewabilityService:this.settings.viewabilityService,cpm:this.settings.cpm,successRate:this.settings.successRate,obfuscatedPrice:this.settings.obfuscatedPrice,adEnforcer:this.settings.adEnforcer,os:this.settings.os,adSlotContainerRecycler:this.settings.adSlotContainerRecycler,bidSlotId:this.settings.bidSlotId,urlSuffixerService:this.settings.urlSuffixerService});return this.metrics.fetchEnd=(new Date).getTime(),Promise.resolve(adaptor)}},{key:"_getAdUnitPath",value:function(urlString){return urlString.substr("https://adx.connatix.com".length)}}]),AdxCallAdaptor}();function MediaBidAdaptor_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var ThreadStateEnum,MediaBidAdaptor_MediaBidAdaptor=function(_ABaseBidAdaptor){inherits_default()(MediaBidAdaptor,_ABaseBidAdaptor);var _super=MediaBidAdaptor_createSuper(MediaBidAdaptor);function MediaBidAdaptor(settings){var _this;return classCallCheck_default()(this,MediaBidAdaptor),(_this=_super.call(this,settings)).settings=settings,_this.adMediaType="cnxMedia",_this.adSourceType=protos.ProtoAdsourceTypeEnum.CnxMedia,_this._mediaSubscriptions=[],_this}return createClass_default()(MediaBidAdaptor,[{key:"initAd",value:function(width,height,viewMode,desireBitrate,creativeData,environmentVars,volume){var _this2=this;try{var src;get_default()(getPrototypeOf_default()(MediaBidAdaptor.prototype),"initAd",this).call(this,width,height,viewMode,desireBitrate,creativeData,environmentVars,volume);var isHlsSource=!1;if(Object(TypeUtils.h)(this.settings.externalMediaFile))src=this.settings.externalMediaFile;else if(Object(TypeUtils.h)(this.settings.externalHlsFile))src=this.settings.externalHlsFile,isHlsSource=!0;else{if(!Object(ArrayUtils.h)(this.settings.renditions))return void this._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.CnxMediaNoRenditions}});src=this._getRenditionUrl(this.settings.renditions,height,this.settings.mediaId)}this._currentAdSrc=src,this._mediaVpaidBridge=new AdVideoWrapper_AdVideoWrapper(this.settings.globalDomUtilsService,this._currentAdSrc,this._$videoSlot,this.settings.os,this.settings.clickUrl,this.settings.loopAdWhenFinished,this.settings.pauseAdWhenFinished,isHlsSource,this.settings.inApp,this.settings.pageDomain),this._mediaSubscriptions.push(this._mediaVpaidBridge.onVpaidEvent.subscribe(function(vpaidEvent){_this2._sendVpaidEvent(vpaidEvent)})),this._mediaVpaidBridge.initAd(width,height,viewMode,desireBitrate,creativeData,{slot:this._$adSlot,videoSlot:this._$videoSlot})}catch(e){this._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.AdaptorInitAdError+"_".concat(e.message)}})}}},{key:"startAd",value:function(){try{get_default()(getPrototypeOf_default()(MediaBidAdaptor.prototype),"startAd",this).call(this),this._mediaVpaidBridge.startAd()}catch(e){this._sendVpaidEvent({type:VastConfig.b.AdError,payload:{errorMessage:MonetisationConfig.c.AdaptorStartAdError+"_".concat(e.message)}})}}},{key:"stopAd",value:function(reason){get_default()(getPrototypeOf_default()(MediaBidAdaptor.prototype),"stopAd",this).call(this,reason),this._mediaVpaidBridge?this._mediaVpaidBridge.stopAd(reason):Object(Logging.a)({message:"stopAd",exception:reason,level:protos.ProtoLoggingLevelEnum.WARNING})}},{key:"resizeAd",value:function(width,height,viewMode){try{this._mediaVpaidBridge.resizeAd(width,height,viewMode)}catch(e){this._logVpaidEventError("CnxMediaBidAdaptor","resizeAd",e)}}},{key:"pauseAd",value:function(){try{this._mediaVpaidBridge.pauseAd()}catch(e){this._logVpaidEventError("CnxMediaBidAdaptor","pauseAd",e)}}},{key:"resumeAd",value:function(){try{this._mediaVpaidBridge.resumeAd()}catch(e){this._logVpaidEventError("CnxMediaBidAdaptor","resumeAd",e)}}},{key:"expandAd",value:function(){try{this._mediaVpaidBridge.expandAd()}catch(e){this._logVpaidEventError("CnxMediaBidAdaptor","expandAd",e)}}},{key:"collapseAd",value:function(){try{this._mediaVpaidBridge.collapseAd()}catch(e){this._logVpaidEventError("CnxMediaBidAdaptor","collapseAd",e)}}},{key:"skipAd",value:function(){try{get_default()(getPrototypeOf_default()(MediaBidAdaptor.prototype),"skipAd",this).call(this),this._mediaVpaidBridge.skipAd()}catch(e){this._logVpaidEventError("CnxMediaBidAdaptor","skipAd",e)}}},{key:"getAdRemainingTime",value:function(){try{return this._mediaVpaidBridge.getAdRemainingTime()}catch(e){return this._logVpaidEventError("CnxMediaBidAdaptor","getAdRemainingTime",e),0}}},{key:"getAdDuration",value:function(){try{return this._mediaVpaidBridge?this._mediaVpaidBridge.getAdDuration():this.settings.adManagerLineItem.protoLineItem.duration}catch(e){return this._logVpaidEventError("CnxMediaBidAdaptor","getAdDuration",e),0}}},{key:"getAdVolume",value:function(){try{return this._mediaVpaidBridge.getAdVolume()}catch(e){return this._logVpaidEventError("CnxMediaBidAdaptor","getAdVolume",e),0}}},{key:"getAdMediaSize",value:function(){return{width:this._mediaVpaidBridge.getAdMediaWidth(),height:this._mediaVpaidBridge.getAdMediaHeight()}}},{key:"setAdVolume",value:function(volume){try{get_default()(getPrototypeOf_default()(MediaBidAdaptor.prototype),"setAdVolume",this).call(this,volume),this._mediaVpaidBridge.setAdVolume(volume)}catch(e){this._logVpaidEventError("CnxMediaBidAdaptor","setAdVolume",e)}}},{key:"_destroy",value:function(){var _a;if(!this.settings.pauseAdWhenFinished&&!this.settings.loopAdWhenFinished)try{get_default()(getPrototypeOf_default()(MediaBidAdaptor.prototype),"_destroy",this).call(this),clearSubscriptions(this._mediaSubscriptions),null===(_a=this._mediaVpaidBridge)||void 0===_a||_a.destroy()}catch(e){this._logVpaidEventError("CnxMediaBidAdaptor","_destroy",e)}}},{key:"_getRenditionUrl",value:function(mediaRenditions,height,mediaId){var closestRenditionHeight,filteredRenditions;return filteredRenditions=mediaRenditions.filter(function(rendition){return rendition.codec===VideoEncodingsEnum.H264}),closestRenditionHeight=Object(NumberUtils.c)(height,filteredRenditions.map(function(rend){return rend.height})),(filteredRenditions=filteredRenditions.filter(function(rendition){return rendition.height===closestRenditionHeight})).length>0?this._urlSuffixerService.appendParamsToUrl("".concat(EndPointResolver.a.endPoints.base.video).concat(mediaId,"/").concat(filteredRenditions[0].file)):null}},{key:"adVideoUrl",get:function(){return this._currentAdSrc}},{key:"declaredDurationInSeconds",get:function(){return this.settings.adManagerLineItem.protoLineItem.duration}}]),MediaBidAdaptor}(ABaseBidAdaptor_ABaseBidAdaptor),MediaCallAdaptor_MediaCallAdaptor=function(){function MediaCallAdaptor(settings){classCallCheck_default()(this,MediaCallAdaptor),this.settings=settings,this.metrics={created:(new Date).getTime()}}return createClass_default()(MediaCallAdaptor,[{key:"fetchBid",value:function(){this.metrics.fetchStart=(new Date).getTime();var adaptor=new MediaBidAdaptor_MediaBidAdaptor({id:this.settings.id,adManagerLineItem:this.settings.adManagerLineItem,trackers:this.settings.trackersInformation,mediaId:this.settings.mediaId,renditions:this.settings.renditions,clickUrl:this.settings.clickUrl,requestMetadata:this.settings.requestMetadata,callingState:this.settings.callingState,globalDomUtilsService:this.settings.globalDomUtilsService,viewabilityService:this.settings.viewabilityService,adContainer:this.settings.adContainer,cpm:this.settings.cpm,obfuscatedPrice:this.settings.obfuscatedPrice,adEnforcer:this.settings.adEnforcer,externalMediaFile:this.settings.adManagerLineItem.protoLineItem.externalMediaFile,externalHlsFile:this.settings.adManagerLineItem.protoLineItem.externalHlsFile,pauseAdWhenFinished:this.settings.pauseAdWhenFinished,loopAdWhenFinished:this.settings.loopAdWhenFinished,inApp:this.settings.inApp,os:this.settings.os,adSlotContainerRecycler:this.settings.adSlotContainerRecycler,bidSlotId:this.settings.bidSlotId,urlSuffixerService:this.settings.urlSuffixerService,pageDomain:this.settings.pageDomain});return this.metrics.fetchEnd=(new Date).getTime(),Promise.resolve(adaptor)}}]),MediaCallAdaptor}();!function(ThreadStateEnum){ThreadStateEnum[ThreadStateEnum.IDLE=0]="IDLE",ThreadStateEnum[ThreadStateEnum.RUNNING=1]="RUNNING",ThreadStateEnum[ThreadStateEnum.STOPPING=2]="STOPPING"}(ThreadStateEnum||(ThreadStateEnum={}));var PrerollProblemLoggingUtils_PrerollProblemLoggingUtils,_AggregatorTypeMappin,PromiseThread_PromiseThread=function(){function PromiseThread(_promiseGetter){classCallCheck_default()(this,PromiseThread),this._promiseGetter=_promiseGetter,this._state=ThreadStateEnum.IDLE,this._promise=Promise.resolve()}return createClass_default()(PromiseThread,[{key:"start",value:function(){this._state===ThreadStateEnum.IDLE?(this._state=ThreadStateEnum.RUNNING,this._recurse()):this._state===ThreadStateEnum.STOPPING&&(this._state=ThreadStateEnum.RUNNING,this._recurse())}},{key:"stop",value:function(){this._state=ThreadStateEnum.STOPPING}},{key:"setPromiseNotifier",value:function(promiseNotifier){return this._promiseNotifier=promiseNotifier,this}},{key:"setIdleNotifier",value:function(idleNotifier){return this._idleNotifier=idleNotifier,this}},{key:"getState",value:function(){return this._state}},{key:"_getItem",value:function(){var _this=this,promise=this._promiseGetter();void 0!==promise?this._promise=promise.then(function(v){_this._promiseNotifier&&_this._promiseNotifier(v)}).then(function(){_this._state===ThreadStateEnum.STOPPING&&(_this._state=ThreadStateEnum.IDLE)}):this._state=ThreadStateEnum.IDLE}},{key:"_recurse",value:function(){var _this2=this;this._state===ThreadStateEnum.IDLE?this._idleNotifier&&this._idleNotifier():this._state===ThreadStateEnum.RUNNING&&(this._getItem(),this._promise.then(function(){_this2._recurse()}))}}]),PromiseThread}(),PromiseParallelCaller_PromiseParallelCaller=function(){function PromiseParallelCaller(_promiseGetter){var _numberOfThreads=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;classCallCheck_default()(this,PromiseParallelCaller),this._promiseGetter=_promiseGetter,this._numberOfThreads=_numberOfThreads,this._threads=[],this._registerNewThreads(_numberOfThreads)}return createClass_default()(PromiseParallelCaller,[{key:"start",value:function(){return this._threads.forEach(function(thread){thread.start()}),this}},{key:"stop",value:function(){return this._threads.forEach(function(thread){thread.stop()}),this}},{key:"setPromiseNotifier",value:function(promiseNotifier){return this._threads.forEach(function(thread){thread.setPromiseNotifier(promiseNotifier)}),this}},{key:"setAllThreadsIdleNotifier",value:function(idleNotifier){return this._allThreadsIdleNotifier=idleNotifier,this._registerThreadIdleNotifiers(),this}},{key:"setNumberOfThreads",value:function(numberOfThreads){if(!(numberOfThreads<=0)){this._numberOfThreads=numberOfThreads;var threadNumberDifference=numberOfThreads-this._numberOfThreads;threadNumberDifference>0?this._registerNewThreads(threadNumberDifference):threadNumberDifference<0&&this._closeThreads(threadNumberDifference)}}},{key:"getState",value:function(){var _this$_threads$reduce;return this._threads.reduce(function(acc,thread){return acc[thread.getState()]++,acc},(_this$_threads$reduce={},defineProperty_default()(_this$_threads$reduce,ThreadStateEnum.IDLE,0),defineProperty_default()(_this$_threads$reduce,ThreadStateEnum.RUNNING,0),defineProperty_default()(_this$_threads$reduce,ThreadStateEnum.STOPPING,0),_this$_threads$reduce))}},{key:"_registerNewThreads",value:function(numberOfThreads){for(var i=0;i<numberOfThreads;i++){var newThread=new PromiseThread_PromiseThread(this._promiseGetter).setPromiseNotifier(this._promiseNotifier);this._threads.push(newThread)}}},{key:"_closeThreads",value:function(numberOfThreads){numberOfThreads=Math.min(numberOfThreads,this._threads.length);for(var i=0;i<numberOfThreads;i++)this._threads.pop().stop()}},{key:"_registerThreadIdleNotifiers",value:function(){var _this=this,threadIdleNotifier=function(){_this.getState()[ThreadStateEnum.IDLE]===_this._threads.length&&_this._allThreadsIdleNotifier()};this._threads.forEach(function(thread){thread.setIdleNotifier(threadIdleNotifier)})}}]),PromiseParallelCaller}(),CallingValidationAggregator_CallingValidationAggregator=function(){function CallingValidationAggregator(){classCallCheck_default()(this,CallingValidationAggregator),this._validators=[]}return createClass_default()(CallingValidationAggregator,[{key:"canCall",value:function(lineItem,categoryId){return this._validators.every(function(callingValidator){return callingValidator.canCall(lineItem,categoryId)})}},{key:"registerRequestForLineItem",value:function(lineItem,categoryId){return this._validators.forEach(function(validatorService){validatorService.registerRequestForLineItem(lineItem,categoryId)}),this}},{key:"registerImpressionForLineItem",value:function(lineItem,categoryId){return this._validators.forEach(function(validatorService){validatorService.registerImpressionForLineItem(lineItem,categoryId)}),this}},{key:"registerCallingValidator",value:function(callingValidator){return this._validators.push(callingValidator),this}},{key:"registerCallingValidators",value:function(callingValidators){var _this=this;return callingValidators.forEach(function(callingValidator){_this.registerCallingValidator(callingValidator)}),this}},{key:"destroy",value:function(){this._validators.forEach(function(callingValidator){callingValidator.destroy()})}}]),CallingValidationAggregator}(),PrerollProblemLoggingUtils_PrerollProblemMetadata=(__webpack_require__(76),function PrerollProblemMetadata(){classCallCheck_default()(this,PrerollProblemMetadata),this.initialized=!1,this.logged=!1,this.startTime=0,this.winIds=[]}),PrerollProblemLoggingUtils_PrerollProblemMetrics=function PrerollProblemMetrics(){classCallCheck_default()(this,PrerollProblemMetrics),this.adSlotType=protos.ProtoAdBreakTypeEnum[protos.ProtoAdBreakTypeEnum.PreRoll],this.timeToFirstBid=-1,this.timeToFirstWin=-1,this.timeToFirstBidReady=-1,this.timeToFirstPostBid=-1,this.timeToFirstStartAd=-1,this.timeToFirstAdImpression=-1,this.prerollLength=-1,this.numberOfBids=0,this.numberOfBidsReady=0,this.numberOfWins=0,this.numberOfPostBids=0,this.indexOfWinThatGaveImpression=-1,this.playerId=""},PrerollProblemLoggingUtils_PrerollProblemDataRecord=function PrerollProblemDataRecord(){classCallCheck_default()(this,PrerollProblemDataRecord),this.metadata=new PrerollProblemLoggingUtils_PrerollProblemMetadata,this.metrics=new PrerollProblemLoggingUtils_PrerollProblemMetrics},dataset=new Map;function getRecord(playerId){return dataset.has(playerId)||dataset.set(playerId,new PrerollProblemLoggingUtils_PrerollProblemDataRecord),dataset.get(playerId)}!function(PrerollProblemLoggingUtils){function log(playerId){var trackEnd=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(dataset.has(playerId)&&Object(GeneralUtils.l)([95,5])){var record=dataset.get(playerId);record.metadata.initialized&&!record.metadata.logged&&(trackEnd&&(record.metrics.prerollLength=(new Date).getTime()-record.metadata.startTime),record.metadata.logged=!0,record.metrics.playerId=playerId,Object(Logging.a)({message:"Preroll_Problem_Logs",exception:JSON.stringify(record.metrics),level:protos.ProtoLoggingLevelEnum.INFO}))}}PrerollProblemLoggingUtils.initialize=function(playerId){var record=getRecord(playerId);record.metadata.initialized=!0,record.metadata.startTime=(new Date).getTime()},PrerollProblemLoggingUtils.log=log,PrerollProblemLoggingUtils.trackBid=function(playerId){var record=getRecord(playerId),now=(new Date).getTime();0===record.metrics.numberOfBids&&(record.metrics.timeToFirstBid=now-record.metadata.startTime,record.metrics.timeToFirstBid>TimeConfig.a&&(record.metrics.timeToFirstBid=0)),record.metrics.numberOfBids++},PrerollProblemLoggingUtils.trackBidReady=function(playerId){var record=getRecord(playerId),now=(new Date).getTime();0===record.metrics.numberOfBidsReady&&(record.metrics.timeToFirstBidReady=now-record.metadata.startTime,record.metrics.timeToFirstBidReady>TimeConfig.a&&(record.metrics.timeToFirstBidReady=0)),record.metrics.numberOfBidsReady++},PrerollProblemLoggingUtils.trackStartAd=function(playerId){var record=getRecord(playerId);-1===record.metrics.timeToFirstStartAd&&(record.metrics.timeToFirstStartAd=(new Date).getTime()-record.metadata.startTime)},PrerollProblemLoggingUtils.trackAdImpression=function(playerId,bid){var record=getRecord(playerId);-1===record.metrics.timeToFirstAdImpression&&(record.metrics.timeToFirstAdImpression=(new Date).getTime()-record.metadata.startTime),record.metrics.indexOfWinThatGaveImpression=record.metadata.winIds.indexOf(bid.settings.id),log(playerId)},PrerollProblemLoggingUtils.trackPostBid=function(playerId){var record=getRecord(playerId),now=(new Date).getTime();0===record.metrics.numberOfPostBids&&(record.metrics.timeToFirstPostBid=now-record.metadata.startTime,record.metrics.timeToFirstPostBid>TimeConfig.a&&(record.metrics.timeToFirstPostBid=0)),record.metrics.numberOfPostBids++},PrerollProblemLoggingUtils.trackWin=function(playerId,bid){var record=getRecord(playerId);record.metadata.winIds.push(bid.settings.id),0===record.metrics.numberOfWins&&(record.metrics.timeToFirstWin=(new Date).getTime()-record.metadata.startTime,record.metrics.timeToFirstWin>TimeConfig.a&&(record.metrics.timeToFirstWin=0)),record.metrics.numberOfWins++}}(PrerollProblemLoggingUtils_PrerollProblemLoggingUtils||(PrerollProblemLoggingUtils_PrerollProblemLoggingUtils={}));var AggregatorType,DEFAULT_CALLING_THREADS_NUMBER=4;!function(AggregatorType){AggregatorType[AggregatorType.Rtb=1]="Rtb",AggregatorType[AggregatorType.HeaderBidder=2]="HeaderBidder",AggregatorType[AggregatorType.Tam=3]="Tam"}(AggregatorType||(AggregatorType={}));var AggregatorTypeMapping=(_AggregatorTypeMappin={},defineProperty_default()(_AggregatorTypeMappin,protos.ProtoCreativeTypeEnum.Rtb,AggregatorType.Rtb),defineProperty_default()(_AggregatorTypeMappin,protos.ProtoCreativeTypeEnum.HeaderBidder,AggregatorType.HeaderBidder),defineProperty_default()(_AggregatorTypeMappin,protos.ProtoCreativeTypeEnum.Tam,AggregatorType.Tam),defineProperty_default()(_AggregatorTypeMappin,protos.ProtoCreativeTypeEnum.TamDeal,AggregatorType.Tam),_AggregatorTypeMappin),AdCallerController_AdCallerController=function(){function AdCallerController(settings){var _this=this;classCallCheck_default()(this,AdCallerController),this.settings=settings,this._callAggregatorMap=new Map,this._subscriptions=[],this._callingAllowed=!1,this._onFirstAggregatedBatchFinished=new Subject.a,this._executeCallingTask=function(){var bestCallable=_this._selectBestCallable();if(bestCallable)return _this._registerPendingCalls(bestCallable.lineItemList),_this._requestBids(bestCallable.lineItemList,bestCallable.state).then(function(){_this._removePendingCalls(bestCallable.lineItemList),_this._checkAuctionFinished()}).catch(function(){_this._removePendingCalls(bestCallable.lineItemList),_this._checkAuctionFinished()})},this._sortCallAdaptorsByYoScore=function(callAdaptorA,callAdaptorB){return _this.settings.adCallerYo.getWinningYoScore(callAdaptorB.settings.id)-_this.settings.adCallerYo.getWinningYoScore(callAdaptorA.settings.id)},this.settings.lineItemList.forEach(function(lineItem){shouldAggregateCreativeType(lineItem.protoLineItem.creativeType)?lineItem.protoLineItem.timeBetweenRequests=10:lineItem.protoLineItem.timeBetweenRequests=6}),this._subscriptions.push(this.settings.lineItemServices.lineItemServicesTimer.onTimer().subscribe(function(){_this._startCall()}),this.settings.adBidPool.onBidConsumed.subscribe(function(){_this._startCall()}),this.settings.adBidPool.onBidLoadingConsumed.subscribe(function(){_this._startCall()}),this.settings.adBidPool.onBidReadyConsumed.subscribe(function(){_this._startCall()})),this._callingValidationAggregator=(new CallingValidationAggregator_CallingValidationAggregator).registerCallingValidators([this.settings.lineItemServices.requestCapsService,this.settings.lineItemServices.impressionCapsService,this.settings.lineItemServices.timeBetweenRequestsService]),this._promiseParallelCaller=new PromiseParallelCaller_PromiseParallelCaller(this._executeCallingTask,DEFAULT_CALLING_THREADS_NUMBER),this.settings.lineItemList.find(function(lineItem){return lineItem.protoLineItem.creativeType===protos.ProtoCreativeTypeEnum.Rtb})&&this._callAggregatorMap.set(AggregatorType.Rtb,{auctionPending:!1,caller:new RtbCallAggregator_RtbCallAggregator(this.settings.isOutstream,this.settings.skipAdSettings,this.settings.app,this.settings.adMacroReplacer,this.settings.adContainerMap,this.settings.adRequestGatekeeper,this.settings.adEnforcer,this.settings.adSlotContainerRecycler)}),this.settings.lineItemList.find(function(lineItem){return lineItem.protoLineItem.creativeType===protos.ProtoCreativeTypeEnum.HeaderBidder})&&this._callAggregatorMap.set(AggregatorType.HeaderBidder,{auctionPending:!1,caller:new PrebidCallAggregator_PrebidCallAggregator(this.settings.isOutstream,this.settings.schainSettings,this.settings.app,this.settings.adMacroReplacer,this.settings.adContainerMap,this.settings.adEnforcer,this.settings.adSlotContainerRecycler,this.settings.loopAdWhenFinished)}),this.settings.lineItemList.find(function(lineItem){return lineItem.protoLineItem.creativeType===protos.ProtoCreativeTypeEnum.Tam||lineItem.protoLineItem.creativeType===protos.ProtoCreativeTypeEnum.TamDeal})&&this._callAggregatorMap.set(AggregatorType.Tam,{auctionPending:!1,caller:new TamCallAggregator_TamCallAggregator(this.settings.app,this.settings.amazonSlotId,this.settings.adMacroReplacer,this.settings.adContainerMap,this.settings.adEnforcer,this.settings.adSlotContainerRecycler)}),this._promiseParallelCaller.setAllThreadsIdleNotifier(function(){_this.settings.lineItemServices.lineItemServicesTimer.start()})}return createClass_default()(AdCallerController,[{key:"call",value:function(callSettings){this._promiseParallelCaller.setNumberOfThreads(callSettings.maxParallelCalls),this._callingStateSettings=callSettings,this._callingAllowed=!0,this._startCall()}},{key:"stop",value:function(){this._callingAllowed=!1,this._promiseParallelCaller.stop()}},{key:"destroy",value:function(){this.stop(),this._callingValidationAggregator.destroy(),this._callAggregatorMap.forEach(function(aggregator){aggregator.caller.destroy()}),clearSubscriptions(this._subscriptions)}},{key:"_checkAuctionFinished",value:function(){var allFinished=!0;this._callAggregatorMap.forEach(function(aggregator){aggregator.auctionPending&&(allFinished=!1)}),allFinished&&this._onFirstAggregatedBatchFinished.next()}},{key:"_getCallableLineItems",value:function(lineItemList){var _this2=this;return lineItemList.filter(function(lineItem){return!(lineItem.aggregators.size>0)&&(!(!shouldAggregateCreativeType(lineItem.protoLineItem.creativeType)&&(lineItem.bids.size>0||lineItem.callers.size>0))&&_this2._callingValidationAggregator.canCall(lineItem,_this2._getAdOpportunityId()))}).filter(function(callableLineItem){return!_this2.settings.platformCappedLineItemRepo.isLineItemPlatformCapped(callableLineItem.protoLineItem)})}},{key:"_startCall",value:function(){this._callingAllowed&&this._promiseParallelCaller.start()}},{key:"_selectBestCallable",value:function(){var callableLineItems=this._getCallableLineItems(this.settings.lineItemList),bestCallable=this.settings.adCallerYo.getBestCallable(callableLineItems,this._callingStateSettings.stateSettings);if(bestCallable&&this._isBetterCallableComparedToAvailableBids(bestCallable.lineItemList[0],bestCallable.state))return bestCallable}},{key:"_isBetterCallableComparedToAvailableBids",value:function(callableLineItem,callingState){var _this3=this;if(shouldAggregateCreativeType(callableLineItem.protoLineItem.creativeType))return!0;for(var allBids=this.settings.adBidPool.getAllBidsExceptStartedBid().filter(function(bid){return _this3.settings.adCallerYo.isBidTargetingAllowed(bid,callingState,_this3.settings.lineItemServices.impressionCapsService,_this3.settings.platformCappedLineItemRepo)}),callableLineItemBidPrice=callableLineItem.protoLineItem.floorPrice||callableLineItem.protoLineItem.customCpm,callableLineItemYoScore=this.settings.adCallerYo.getCallingYoScore(callableLineItem.protoLineItem.advertiserLineItemId),allCalling=this.settings.adBidPool.callingLineItems,allPrices=toConsumableArray_default()(allBids.map(function(bid){return bid.getPrice()})),allYo=toConsumableArray_default()(allCalling.map(function(ln){return _this3.settings.adCallerYo.getCallingYoScore(ln.protoLineItem.advertiserLineItemId)})),i=0;i<allPrices.length;i++)if(callableLineItemBidPrice<allPrices[i])return!1;for(var _i=0;_i<allYo.length;_i++)if(callableLineItemYoScore<allYo[_i])return!1;return!0}},{key:"_registerPendingCalls",value:function(lineItemList){this.settings.adBidPool.callingLineItems=[].concat(toConsumableArray_default()(this.settings.adBidPool.callingLineItems),toConsumableArray_default()(lineItemList))}},{key:"_removePendingCalls",value:function(lineItemList){this.settings.adBidPool.callingLineItems=this.settings.adBidPool.callingLineItems.filter(function(lineItem){return!Object(ArrayUtils.g)(lineItem,lineItemList)})}},{key:"_requestBids",value:function(lineItemList,callingState){return shouldAggregateCreativeType(lineItemList[0].protoLineItem.creativeType)?this._requestAggregatorSideBids(lineItemList,callingState):this._requestClientSideBids(lineItemList[0],callingState)}},{key:"_requestClientSideBids",value:function(lineItem,callingState){this._callingValidationAggregator.registerRequestForLineItem(lineItem,this._getAdOpportunityId());var callAdaptor=this._constructClientSideCallAdaptor(lineItem,callingState);return this._registerCallAdaptorInYoScoreManager(callAdaptor),this._handleCallAdaptorRequest(callAdaptor)}},{key:"_requestAggregatorSideBids",value:function(lineItemList,callingState){var _this4=this,aggregator=this._callAggregatorMap.get(AggregatorTypeMapping[lineItemList[0].protoLineItem.creativeType]);lineItemList.forEach(function(lineItem){return lineItem.aggregators.add(aggregator.caller)}),aggregator.auctionPending=!0;var requestData={lineItemRequestDataList:lineItemList.map(function(lineItem){return{adManagerLineItem:lineItem,maxAvailableRequests:_this4.settings.lineItemServices.requestCapsService.getAvailableRequestsForLineItem(lineItem,_this4._getAdOpportunityId())}}),callingState:callingState,maxAdDuration:callingState.adBreakState.maxAdDuration,maxBidPrice:this._getBestBidPriceFromPool(callingState)};return aggregator.caller.request(requestData).then(function(aggregatorResponse){aggregatorResponse.bids.length||aggregatorResponse.noBids.length||lineItemList.forEach(function(lineItem){_this4._callingValidationAggregator.registerRequestForLineItem(lineItem,_this4._getAdOpportunityId())}),lineItemList.forEach(function(lineItem){return lineItem.aggregators.delete(aggregator.caller)}),aggregatorResponse.noBids.forEach(function(noBid){_this4._callingValidationAggregator.registerRequestForLineItem(noBid.lineItem,_this4._getAdOpportunityId()),_this4._handleRequestError(callingState,noBid.lineItem,noBid.reason,noBid.requestMetadata)}),aggregatorResponse.bids.forEach(function(callAdaptor){return _this4._registerCallAdaptorInYoScoreManager(callAdaptor)}),aggregatorResponse.bids.sort(_this4._sortCallAdaptorsByYoScore);var adaptorPromises=aggregatorResponse.bids.map(function(callAdaptor){return _this4._callingValidationAggregator.registerRequestForLineItem(callAdaptor.settings.adManagerLineItem,_this4._getAdOpportunityId()),_this4._handleCallAdaptorRequest(callAdaptor)});return Promise.all(adaptorPromises)}).catch().then(function(){aggregator.auctionPending=!1})}},{key:"_handleCallAdaptorRequest",value:function(callAdaptor){var _this5=this;return callAdaptor.settings.adManagerLineItem.callers.add(callAdaptor),callAdaptor.fetchBid().catch(function(prebidReason){callAdaptor.settings.adManagerLineItem.callers.delete(callAdaptor),_this5.settings.adCallerYo.registerPreBid(callAdaptor.settings.id);var reason=AdCallRejectionReasonNoBidMapping[prebidReason]?AdCallRejectionReasonNoBidMapping[prebidReason]:protos.ConnatixNoBidReasonEnum.RequestException;return _this5._handleRequestError(callAdaptor.settings.callingState,callAdaptor.settings.adManagerLineItem,reason,callAdaptor.settings.requestMetadata,callAdaptor.settings.trackersInformation,Date.now()-callAdaptor.metrics.fetchStart),Promise.reject()}).then(function(bid){callAdaptor.settings.adManagerLineItem.callers.delete(callAdaptor),_this5._handleRequestSuccess(bid,Date.now()-callAdaptor.metrics.fetchStart)}).catch(function(e){void 0!==e&&Object(Logging.a)({message:"AdManager_AdCallerController_handleCallAdaptorRequest",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.FATAL,throttle:5,sendMaxLog:!0})})}},{key:"_handleRequestSuccess",value:function(bid,timeSpent){var lineItem=bid.settings.adManagerLineItem,requestMetadata=bid.settings.requestMetadata;if(bid.settings.requestMetadata.data.requestTrackingHandledByServer||this.settings.trackingService.addBid({advertiserLineItemId:lineItem.protoLineItem.advertiserLineItemId,publisherLineItemId:lineItem.protoLineItem.publisherLineItemId,requestedFloorPrice:requestMetadata.data.requestedFloorPrice,rtbRequestNumber:requestMetadata.data.rtbRequestNumber,syncedUser:requestMetadata.data.syncedUser,prebidJsBidderName:requestMetadata.data.prebidJsBidderName,customClientPrice:bid.settings.cpm,timeSpent:timeSpent,dspId:requestMetadata.data.dspId,encryptedPrice:requestMetadata.data.encryptedPrice,rtbAdomain:requestMetadata.data.rtbAdomain,creativeId:bid.creativeId,rtbSeatId:requestMetadata.data.rtbSeatId,cnxBidId:bid.settings.requestMetadata.data.cnxBidId}),this.settings.adRequestGatekeeper.addBid(lineItem.protoLineItem.advertiserLineItemId,requestMetadata.data.requestedFloorPrice),!this.settings.adCallerYo.isBidTargetingAllowedEverInSession(bid,bid.settings.callingState))return this.settings.adCallerYo.registerPreBid(bid.settings.id),void this.settings.auctionInfoLogging.bidIsNotWinnableEverInSession(bid);PrerollProblemLoggingUtils_PrerollProblemLoggingUtils.trackBid(this.settings.app.config.playerId),bid.settings.adManagerLineItem.bids.add(bid),this.settings.adBidPool.addBid(bid)}},{key:"_handleRequestError",value:function(callingState,lineItem,prebidReason,requestMetadata,trackersInformation,timeSpent){trackersInformation&&TrackersInformation_TrackersInformation.track(trackersInformation.adError,this.settings.adMacroReplacer,lineItem.protoLineItem,callingState),requestMetadata.data.requestTrackingHandledByServer||this.settings.trackingService.addPrebid({advertiserLineItemId:lineItem.protoLineItem.advertiserLineItemId,publisherLineItemId:lineItem.protoLineItem.publisherLineItemId,partnerCustomHeaders:requestMetadata.data.partnerCustomHeaders,partnerReason:requestMetadata.data.partnerReason,requestedFloorPrice:requestMetadata.data.requestedFloorPrice,rtbRequestNumber:requestMetadata.data.rtbRequestNumber,syncedUser:requestMetadata.data.syncedUser,prebidJsBidderName:requestMetadata.data.prebidJsBidderName,reason:prebidReason,timeSpent:timeSpent}),this.settings.adRequestGatekeeper.addPrebid(lineItem.protoLineItem.advertiserLineItemId)}},{key:"_constructClientSideCallAdaptor",value:function(lineItem,callingState){var trackersInformation=new TrackersInformation_TrackersInformation;addTrackersFromCreative(lineItem.protoLineItem.trackers,trackersInformation);var callAdaptorSettings={id:Object(GeneralUtils.c)(),adManagerLineItem:lineItem,replaceTrackingMacros:!0,requestMetadata:new InternalRequestTrackingMetadata_InternalRequestTrackingMetadata,trackersInformation:trackersInformation,callingState:callingState,adContainer:this.settings.adContainerMap.get(lineItem.protoLineItem.adType),globalDomUtilsService:this.settings.app.services.GlobalDomUtilsService,viewabilityService:this.settings.app.services.ViewabilityService,cpm:lineItem.protoLineItem.floorPrice||lineItem.protoLineItem.customCpm,adEnforcer:this.settings.adEnforcer,os:this.settings.os,adSlotContainerRecycler:this.settings.adSlotContainerRecycler,bidSlotId:AdUtils_generateBidSlotId(),urlSuffixerService:this.settings.app.services.UrlSuffixerService};switch(lineItem.protoLineItem.creativeType){case protos.ProtoCreativeTypeEnum.External:case protos.ProtoCreativeTypeEnum.ThirdParty:return lineItem.protoLineItem.adType===protos.ProtoAdType.Overlay?new AdxCallAdaptor_AdxCallAdaptor(Object.assign(Object.assign({},callAdaptorSettings),{url:lineItem.protoLineItem.adTag,pageDomain:this.settings.app.config.pageDomain})):new VastUrlCallAdaptor_VastUrlCallAdaptor(Object.assign(Object.assign({},callAdaptorSettings),{url:lineItem.protoLineItem.adTag,adMacroReplacer:this.settings.adMacroReplacer,trackingService:this.settings.trackingService,loopAdWhenFinished:this.settings.loopAdWhenFinished,pageUrl:this.settings.app.config.pageUrl}));case protos.ProtoCreativeTypeEnum.MediaFile:return new MediaCallAdaptor_MediaCallAdaptor(Object.assign(Object.assign({},callAdaptorSettings),{clickUrl:lineItem.protoLineItem.mediaCreativeClickUrl,mediaId:lineItem.protoLineItem.mediaCreativeId,renditions:lineItem.protoLineItem.renditions,pauseAdWhenFinished:this.settings.pauseAdWhenFinished,loopAdWhenFinished:this.settings.loopAdWhenFinished,inApp:this.settings.app.config.isInApp,pageDomain:this.settings.app.config.pageDomain}))}}},{key:"_registerCallAdaptorInYoScoreManager",value:function(callAdaptor){var _callAdaptor$settings=callAdaptor.settings.adManagerLineItem.protoLineItem,creativeType=_callAdaptor$settings.creativeType,floorPrice=_callAdaptor$settings.floorPrice,successRate=_callAdaptor$settings.successRate,advertiserLineItemId=_callAdaptor$settings.advertiserLineItemId,lineItemPriority=_callAdaptor$settings.lineItemPriority;this.settings.adCallerYo.registerBiddingInformation({creativeType:creativeType,floorPrice:floorPrice,lineItemId:advertiserLineItemId,priority:lineItemPriority,bidId:callAdaptor.settings.id,cpm:callAdaptor.settings.cpm,obfuscatedPrice:callAdaptor.settings.obfuscatedPrice,successRate:callAdaptor.settings.successRate||successRate})}},{key:"_getAdOpportunityId",value:function(){return(this._callingStateSettings.stateSettings.currentState||this._callingStateSettings.stateSettings.predictedState).adOpportunity.id}},{key:"_getBestBidPriceFromPool",value:function(state){var _this6=this,bids=[].concat(toConsumableArray_default()(this.settings.adBidPool.bids),toConsumableArray_default()(this.settings.adBidPool.bidsLoading),toConsumableArray_default()(this.settings.adBidPool.bidsReady)).filter(function(bid){return _this6.settings.adCallerYo.isBidTargetingAllowed(bid,state,_this6.settings.lineItemServices.impressionCapsService,_this6.settings.platformCappedLineItemRepo)});return Object(ArrayUtils.h)(bids)?Math.max.apply(Math,toConsumableArray_default()(bids.map(function(bid){return bid.getPrice()}))):0}},{key:"onFirstAggregatedBatchFinished",get:function(){return this._onFirstAggregatedBatchFinished.asObservable()}}]),AdCallerController}();function ABaseCapsValidationService_createForOfIteratorHelper(o){if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(o=function(o,minLen){if(!o)return;if("string"==typeof o)return ABaseCapsValidationService_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ABaseCapsValidationService_arrayLikeToArray(o,minLen)}(o))){var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var it,err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function ABaseCapsValidationService_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ABaseCapsValidationService_ABaseCapsValidationService=function(){function ABaseCapsValidationService(){classCallCheck_default()(this,ABaseCapsValidationService)}return createClass_default()(ABaseCapsValidationService,[{key:"resetCapsBasedOnExternalEvent",value:function(resetCapsEventType){var _step,_iterator=ABaseCapsValidationService_createForOfIteratorHelper(this._map.keys());try{for(_iterator.s();!(_step=_iterator.n()).done;){var lineItem=_step.value;this._doesLineItemHaveThisResetCapType(lineItem,resetCapsEventType)&&this._resetLineItemCap(lineItem,"uncategorized")}}catch(err){_iterator.e(err)}finally{_iterator.f()}}},{key:"_doesLineItemHaveThisResetCapType",value:function(lineItem,resetCapType){return lineItem.protoLineItem.resetCapType===resetCapType}},{key:"_isLineItemTimeCapped",value:function(lineItem){return this._doesLineItemHaveThisResetCapType(lineItem,protos.ProtoResetCapTypeEnum.TimeCapping)&&this._getResetCapTimeInMs(lineItem)>0}}]),ABaseCapsValidationService}(),ImpressionCapsMetadata_ImpressionCapsMetadata=function(){function ImpressionCapsMetadata(_lineItemResetCapType){classCallCheck_default()(this,ImpressionCapsMetadata),this._lineItemResetCapType=_lineItemResetCapType,this._numberOfImpressions=new Map}return createClass_default()(ImpressionCapsMetadata,[{key:"setNumberOfImpressions",value:function(_ref){var value=_ref.value,categoryId=_ref.categoryId;Object(TypeUtils.a)(categoryId)&&this._lineItemResetCapType===protos.ProtoResetCapTypeEnum.OpportunityCapping||(categoryId="uncategorized"),this._numberOfImpressions.set(categoryId,value)}},{key:"getNumberOfImpressions",value:function(_ref2){var categoryId=_ref2.categoryId;return Object(TypeUtils.a)(categoryId)&&this._lineItemResetCapType===protos.ProtoResetCapTypeEnum.OpportunityCapping||(categoryId="uncategorized"),this._numberOfImpressions.get(categoryId)||0}}]),ImpressionCapsMetadata}();function ImpressionCapsValidationService_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var ImpressionCapsValidationService_ImpressionCapsValidationService=function(_ABaseCapsValidationS){inherits_default()(ImpressionCapsValidationService,_ABaseCapsValidationS);var _super=ImpressionCapsValidationService_createSuper(ImpressionCapsValidationService);function ImpressionCapsValidationService(){var _this,_initTimestamp=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return classCallCheck_default()(this,ImpressionCapsValidationService),(_this=_super.call(this))._initTimestamp=_initTimestamp,_this._map=new Map,_this}return createClass_default()(ImpressionCapsValidationService,[{key:"canCall",value:function(lineItem,categoryId){this._resetCapBasedOnTime(lineItem);var entry=this._map.get(lineItem);return void 0===entry||(0===lineItem.protoLineItem.impressionCap||entry.getNumberOfImpressions({categoryId:categoryId})<lineItem.protoLineItem.impressionCap)}},{key:"registerImpressionForLineItem",value:function(lineItem,categoryId){var entry=this._map.get(lineItem);return void 0===entry&&(this._map.set(lineItem,new ImpressionCapsMetadata_ImpressionCapsMetadata(lineItem.protoLineItem.resetCapType)),entry=this._map.get(lineItem),this._isLineItemTimeCapped(lineItem)&&(entry.nextImpressionCapResetTimestamp=this._getResetCapTimeframeLimit(this._getResetCapTimeInMs(lineItem)))),entry.setNumberOfImpressions({value:entry.getNumberOfImpressions({categoryId:categoryId})+1,categoryId:categoryId}),this}},{key:"registerRequestForLineItem",value:function(lineItem,categoryId){return this}},{key:"destroy",value:function(){this._map.clear()}},{key:"_resetLineItemCap",value:function(lineItem,categoryId){this._map.get(lineItem).setNumberOfImpressions({value:0,categoryId:categoryId})}},{key:"_getResetCapTimeInMs",value:function(lineItem){return lineItem.protoLineItem.resetImpressionsCapTime*TimeConfig.f}},{key:"_resetCapBasedOnTime",value:function(lineItem){var currentTime=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();if(this._isLineItemTimeCapped(lineItem)){var entry=this._map.get(lineItem);void 0!==entry&&this._shouldLineItemBeResetNowBasedOnTime(lineItem,currentTime)&&(entry.setNumberOfImpressions({value:0}),entry.nextImpressionCapResetTimestamp=this._getResetCapTimeframeLimit(this._getResetCapTimeInMs(lineItem),currentTime))}}},{key:"_shouldLineItemBeResetNowBasedOnTime",value:function(lineItem,currentTime){return currentTime>=this._map.get(lineItem).nextImpressionCapResetTimestamp}},{key:"_getResetCapTimeframeLimit",value:function(timeFrameSize){var currentTime=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),timeFrameLimitSinceInitTimestamp=Math.ceil((currentTime-this._initTimestamp)/timeFrameSize)*timeFrameSize;return this._initTimestamp+timeFrameLimitSinceInitTimestamp}}]),ImpressionCapsValidationService}(ABaseCapsValidationService_ABaseCapsValidationService),RequestCapsMetadata_RequestCapsMetadata=function(){function RequestCapsMetadata(_lineItemResetCapType){classCallCheck_default()(this,RequestCapsMetadata),this._lineItemResetCapType=_lineItemResetCapType,this._numberOfRequests=new Map}return createClass_default()(RequestCapsMetadata,[{key:"setNumberOfRequests",value:function(_ref){var value=_ref.value,categoryId=_ref.categoryId;Object(TypeUtils.a)(categoryId)&&this._lineItemResetCapType===protos.ProtoResetCapTypeEnum.OpportunityCapping||(categoryId="uncategorized"),this._numberOfRequests.set(categoryId,value)}},{key:"getNumberOfRequests",value:function(_ref2){var categoryId=_ref2.categoryId;return Object(TypeUtils.a)(categoryId)&&this._lineItemResetCapType===protos.ProtoResetCapTypeEnum.OpportunityCapping||(categoryId="uncategorized"),this._numberOfRequests.get(categoryId)||0}}]),RequestCapsMetadata}();function RequestCapsValidationService_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var RequestCapsValidationService_RequestCapsValidationService=function(_ABaseCapsValidationS){inherits_default()(RequestCapsValidationService,_ABaseCapsValidationS);var _super=RequestCapsValidationService_createSuper(RequestCapsValidationService);function RequestCapsValidationService(){var _this,_initTimestamp=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return classCallCheck_default()(this,RequestCapsValidationService),(_this=_super.call(this))._initTimestamp=_initTimestamp,_this.allowResetOnTime=!0,_this._map=new Map,_this}return createClass_default()(RequestCapsValidationService,[{key:"canCall",value:function(lineItem,categoryId){this._resetCapBasedOnTime(lineItem);var entry=this._map.get(lineItem);return void 0===entry||(0===lineItem.protoLineItem.requestCap||entry.getNumberOfRequests({categoryId:categoryId})<lineItem.protoLineItem.requestCap)}},{key:"registerRequestForLineItem",value:function(lineItem,categoryId){arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();var entry=this._map.get(lineItem);return void 0===entry&&(this._map.set(lineItem,new RequestCapsMetadata_RequestCapsMetadata(lineItem.protoLineItem.resetCapType)),entry=this._map.get(lineItem),this._isLineItemTimeCapped(lineItem)&&(entry.nextRequestCapResetTimestamp=this._getResetCapTimeframeLimit(this._getResetCapTimeInMs(lineItem)))),entry.setNumberOfRequests({value:entry.getNumberOfRequests({categoryId:categoryId})+1,categoryId:categoryId}),this}},{key:"registerImpressionForLineItem",value:function(lineItem){return this}},{key:"getAvailableRequestsForLineItem",value:function(lineItem,categoryId){var entry=this._map.get(lineItem);return void 0===entry?lineItem.protoLineItem.requestCap:lineItem.protoLineItem.requestCap-entry.getNumberOfRequests({categoryId:categoryId})}},{key:"restoreOneCapForLineItem",value:function(lineItem,categoryId){if(lineItem.protoLineItem.ignoreFilledRequests){var entry=this._map.get(lineItem);if(void 0===entry)return;var numberOfRequests=entry.getNumberOfRequests({categoryId:categoryId});numberOfRequests>0&&entry.setNumberOfRequests({value:numberOfRequests-1,categoryId:categoryId})}}},{key:"destroy",value:function(){this._map.clear()}},{key:"_resetLineItemCap",value:function(lineItem,categoryId){this._map.get(lineItem).setNumberOfRequests({value:0,categoryId:categoryId})}},{key:"_getResetCapTimeInMs",value:function(lineItem){return lineItem.protoLineItem.resetRequestsCapTime*TimeConfig.f}},{key:"_resetCapBasedOnTime",value:function(lineItem){var currentTime=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();if(this._isLineItemTimeCapped(lineItem)){var entry=this._map.get(lineItem);void 0!==entry&&this._shouldLineItemBeResetNowBasedOnTime(lineItem,currentTime)&&(entry.setNumberOfRequests({value:0}),entry.nextRequestCapResetTimestamp=this._getResetCapTimeframeLimit(this._getResetCapTimeInMs(lineItem),currentTime))}}},{key:"_shouldLineItemBeResetNowBasedOnTime",value:function(lineItem,currentTime){return currentTime>=this._map.get(lineItem).nextRequestCapResetTimestamp&&this.allowResetOnTime}},{key:"_getResetCapTimeframeLimit",value:function(timeFrameSize){var currentTime=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),timeFrameLimitSinceInitTimestamp=Math.ceil((currentTime-this._initTimestamp)/timeFrameSize)*timeFrameSize;return this._initTimestamp+timeFrameLimitSinceInitTimestamp}}]),RequestCapsValidationService}(ABaseCapsValidationService_ABaseCapsValidationService),TimeBetweenRequestsService_TimeBetweenRequestsValidationService=function(){function TimeBetweenRequestsValidationService(){classCallCheck_default()(this,TimeBetweenRequestsValidationService),this._map=new Map}return createClass_default()(TimeBetweenRequestsValidationService,[{key:"registerRequestForLineItem",value:function(lineItem,categoryId){var requestTimestamp=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),entry=this._map.get(lineItem);return void 0===entry&&(this._map.set(lineItem,{}),entry=this._map.get(lineItem)),entry.lastRequestTimestamp=requestTimestamp,entry.categoryId=categoryId,this}},{key:"registerImpressionForLineItem",value:function(lineItem){return this}},{key:"canCall",value:function(lineItem,categoryId){var currentTimestamp=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),entry=this._map.get(lineItem);return void 0===entry||(0===lineItem.protoLineItem.timeBetweenRequests||(currentTimestamp>=entry.lastRequestTimestamp+lineItem.protoLineItem.timeBetweenRequests*TimeConfig.f||!(entry.categoryId===categoryId||lineItem.protoLineItem.resetCapType!==protos.ProtoResetCapTypeEnum.OpportunityCapping)))}},{key:"destroy",value:function(){this._map.clear()}}]),TimeBetweenRequestsValidationService}(),IntervalService_IntervalService=function(){function IntervalService(){classCallCheck_default()(this,IntervalService),this._intervalHandle=null,this._notifier=new Subject.a}return createClass_default()(IntervalService,[{key:"start",value:function(){return this._createInterval(),this}},{key:"stop",value:function(){return this._clearInterval(),this}},{key:"onTimer",value:function(){return this._notifier.asObservable()}},{key:"destroy",value:function(){this._clearInterval()}},{key:"_createInterval",value:function(){var _this=this;null===this._intervalHandle&&(this._intervalHandle=TimerService_TimerService.setInterval(function(){_this._notifier.next()},500))}},{key:"_clearInterval",value:function(){TimerService_TimerService.clearInterval(this._intervalHandle),this._intervalHandle=null}}]),IntervalService}();function AdContainer_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var _AdSlotMacroMapping,AdContainer_AdContainer=function(_Mediator){inherits_default()(AdContainer,_Mediator);var _super=AdContainer_createSuper(AdContainer);function AdContainer(_containerMap,_resizeService,_viewabilityService,_viewabilityThreshold){var _this$_adTypeViewabil,_this;return classCallCheck_default()(this,AdContainer),(_this=_super.call(this))._containerMap=_containerMap,_this._resizeService=_resizeService,_this._viewabilityService=_viewabilityService,_this._viewabilityThreshold=_viewabilityThreshold,_this._onContainerStateUpdate=new Subject.a,_this.forceTriggerUpdateState=function(){toConsumableArray_default()(_this._containerMap.keys()).forEach(function(adType){return _this._updateState(adType)})},_this._updateState=function(adType,inView){_this._containerStateCache.set(adType,_this._getContainerState(_this._containerMap.get(adType),inView))},_this._onVideoContainerViewability=function(inView){_this._onServiceUpdate([protos.ProtoAdType.Video],inView)},_this._onOverlayContainerViewability=function(inView){_this._onServiceUpdate([protos.ProtoAdType.Overlay],inView)},_this._onResize=function(){_this._onServiceUpdate([protos.ProtoAdType.Overlay,protos.ProtoAdType.Video])},_this._onServiceUpdate=function(adTypeList,inView){adTypeList.forEach(function(adType){return _this._updateState(adType,inView)}),_this._onContainerStateUpdate.next()},_this._containerStateCache=new Map,_this._adTypeViewabilityCallbackMap=(_this$_adTypeViewabil={},defineProperty_default()(_this$_adTypeViewabil,protos.ProtoAdType.Video,_this._onVideoContainerViewability),defineProperty_default()(_this$_adTypeViewabil,protos.ProtoAdType.Overlay,_this._onOverlayContainerViewability),_this$_adTypeViewabil),_this.forceTriggerUpdateState(),_this._containerMap.forEach(function(element,adType){_this._resizeService.on(element,_this._onResize),_this._viewabilityService.on(element,_this._adTypeViewabilityCallbackMap[adType],{threshold:_this._viewabilityThreshold})}),_this}return createClass_default()(AdContainer,[{key:"getContainerMap",value:function(){return this._containerMap}},{key:"getContainerStateMap",value:function(){return this._containerStateCache}},{key:"destroy",value:function(){var _this2=this;this._containerMap.forEach(function(element,adType){_this2._resizeService.off(element,_this2._onResize),_this2._viewabilityService.off(element,_this2._adTypeViewabilityCallbackMap[adType])})}},{key:"_getContainerState",value:function(container,inView){var viewability=inView;return void 0===viewability&&(viewability=this._viewabilityService.check({element:container,threshold:this._viewabilityThreshold})),{width:container.clientWidth,height:container.clientHeight,viewability:viewability}}},{key:"onContainerStateUpdate",get:function(){return this._onContainerStateUpdate.asObservable()}}]),AdContainer}(Mediator.a),VIDEO_REFERENCE_ATTRIBUTE="cnxpl-rf",EnforcerMute_EnforcerMute=function(){function EnforcerMute(){var _this=this;classCallCheck_default()(this,EnforcerMute),this._paused=!0,this._onVolumeDetected=new Subject.a,this._enforcedTags=[],this._muteEnforce=function(event){if(!_this._paused){var $videoTag=event.target;if($videoTag.volume>0&&($videoTag.volume=0,!$videoTag.paused)){var referenceId=$videoTag.getAttribute(VIDEO_REFERENCE_ATTRIBUTE);_this._onVolumeDetected.next(referenceId)}event.preventDefault?event.preventDefault():event.returnValue=!1}}}return createClass_default()(EnforcerMute,[{key:"enforce",value:function($container,referenceId){var _this2=this,$domElement=$container;Object(TypeUtils.c)($container)&&($domElement=$container.contentDocument||$container.contentWindow.document),this._paused=!1,Object(ArrayUtils.c)($domElement.getElementsByTagName("video")).forEach(function($video){_this2._bindMuteEnforceOnVideoTag($video,referenceId)})}},{key:"stopEnforce",value:function(){this._paused=!0}},{key:"clearEnforce",value:function(referenceId){var _this3=this;try{var enforcedTagsOnReference=[];this._enforcedTags=this._enforcedTags.filter(function($videoTag){return $videoTag.getAttribute(VIDEO_REFERENCE_ATTRIBUTE)!==referenceId||(enforcedTagsOnReference.push($videoTag),!1)}),enforcedTagsOnReference.forEach(function($videoTag){$videoTag.removeAttribute("cnxpl-vl"),$videoTag.removeAttribute(VIDEO_REFERENCE_ATTRIBUTE),$videoTag.removeEventListener("volumechange",_this3._muteEnforce)})}catch(e){}}},{key:"_bindMuteEnforceOnVideoTag",value:function($videoTag,referenceId){$videoTag&&!$videoTag.getAttribute("cnxpl-vl")&&($videoTag.volume=0,$videoTag.setAttribute("cnxpl-vl","true"),$videoTag.setAttribute(VIDEO_REFERENCE_ATTRIBUTE,referenceId),$videoTag.addEventListener("volumechange",this._muteEnforce),this._enforcedTags.push($videoTag))}},{key:"onVolumeDetected",get:function(){return this._onVolumeDetected.asObservable()}}]),EnforcerMute}(),EnforcerScroll_EnforcerScroll=function(){function EnforcerScroll(){classCallCheck_default()(this,EnforcerScroll)}return createClass_default()(EnforcerScroll,[{key:"_doDestructiveEnforce",value:function(iframeWindow){var voidFunction=function(){};iframeWindow.Element.prototype.scrollIntoView=voidFunction,iframeWindow.Element.prototype.scrollIntoViewIfNeeded=voidFunction,iframeWindow.scroll=voidFunction,iframeWindow.scrollTo=voidFunction,iframeWindow.scrollBy=voidFunction}},{key:"enforce",value:function($container){Object(TypeUtils.c)($container)&&this._doDestructiveEnforce($container.contentWindow)}},{key:"stopEnforce",value:function(){}},{key:"clearEnforce",value:function(){}}]),EnforcerScroll}(),EnforcerMemory_EnforcerMemory=function(){function EnforcerMemory(global){classCallCheck_default()(this,EnforcerMemory),this._getMemoryEnforcerStorage=function(GLOBAL){return GLOBAL.cnxEnfStorage?GLOBAL.cnxEnfStorage:null},this._global=global;try{this._getMemoryEnforcerStorage(this._global)||this._bindMemoryEnforcers(this._global)}catch(e){Object(Logging.a)({message:"AdManager_EnforcerMemory_bind_enforcement",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.FATAL})}}return createClass_default()(EnforcerMemory,[{key:"_bindMemoryEnforcers",value:function(GLOBAL){Object(DomUtils.z)(GLOBAL.document.head,GLOBAL,'!function(){function n(n){window["cnx"+n]||(window["cnx"+n]=window[n],window[n]=function(e){var t="";try{e&&(t=function n(e,t){try{if(!e)return"";if(e.cnxInnerTag)return e.cnxInnerTag;if(t<2){var r=t+1;return n(e.caller,r)}}catch(n){return""}return""}(e))}catch(n){}var r=window["cnx"+n].apply(null,arguments);if(t){var i=window.cnxEnfStorage;i[n][t]=i[n][t]||[],i[n][t].push(r)}return r})}window.cnxEnfStorage={setTimeout:{},setInterval:{},eventListeners:{},errors:[]};var e=window.location.hostname.split("."),t=window.btoa(e[e.length-2]+"."+e[e.length-1]);-1===["dG16LmNvbQ==","YmlsbGJvYXJkLmNvbQ==","aG9sbHl3b29kcmVwb3J0ZXIuY29t","dmliZS5jb20=","aG9yb3Njb3BlLmNvbQ==","YXN0cm9sb2d5LmNvbQ==","YWhvcmFtaXNtby5jb20="].indexOf(t)&&(!function(){const n=window.EventTarget?window.EventTarget.prototype:window.document;n.cnxAddEventListener||(n.cnxAddEventListener=n.addEventListener,n.addEventListener=function(n,e,t){var r=this||window;if(e&&e.cnxInnerTag){var i=window.cnxEnfStorage;i.eventListeners[e.cnxInnerTag]=i.eventListeners[e.cnxInnerTag]||[],i.eventListeners[e.cnxInnerTag].push({element:r,type:n,handler:e,options:t})}try{r.cnxAddEventListener(n,e,t)}catch(n){n.message="adlstn_"+n.message,i.errors.push(n)}})}(),n("setTimeout"),n("setInterval"))}();')}},{key:"enforce",value:function($iframe,referenceId){if(Object(TypeUtils.c)($iframe))try{$iframe.contentWindow.self===top||$iframe.contentWindow.Function.prototype.cnxInnerTag||$iframe.contentWindow.Object.defineProperty($iframe.contentWindow.Function.prototype,"cnxInnerTag",{enumerable:!1,writable:!0,value:referenceId}),$iframe.contentWindow.self===top||$iframe.contentWindow.Object.prototype.cnxInnerTag||$iframe.contentWindow.Object.defineProperty($iframe.contentWindow.Object.prototype,"cnxInnerTag",{enumerable:!1,writable:!0,value:referenceId})}catch(e){}}},{key:"stopEnforce",value:function(){}},{key:"clearEnforce",value:function(referenceId){var _this=this;try{var storage=this._getMemoryEnforcerStorage(this._global);storage.eventListeners[referenceId]&&(storage.eventListeners[referenceId].forEach(function(listenerSettings){listenerSettings.element.removeEventListener(listenerSettings.type,listenerSettings.handler,listenerSettings.options)}),storage.eventListeners[referenceId]=[]),storage.setInterval[referenceId]&&(storage.setInterval[referenceId].forEach(function(id){return _this._global.clearInterval(id)}),storage.setInterval[referenceId]=[]),storage.setTimeout[referenceId]&&(storage.setTimeout[referenceId].forEach(function(id){return _this._global.clearTimeout(id)}),storage.setTimeout[referenceId]=[])}catch(e){}}}]),EnforcerMemory}(),EnforcerMalware_EnforcerMalware=function(){function EnforcerMalware(){classCallCheck_default()(this,EnforcerMalware),this._malwareIframeSources=["viralgains","serving-sys.com","commercialadsdistributor"],this._malwareScriptSources=["beachfrontmedia","commercialadsdistributor"],this._malwareAnchorSources=["commercialadsdistributor"],this._malwareImageSources=["pixel.clearstream.tv","pixel.clrstm.com"],this._onMalwareDetected=new Subject.a,this._onBadUriDetected=new Subject.a}return createClass_default()(EnforcerMalware,[{key:"enforce",value:function($iframe,referenceId){if(Object(TypeUtils.c)($iframe)){this._currentReferenceId=referenceId;try{this._enforceIframeSource($iframe),this._enforceScriptSources($iframe),this._enforceAnchorSources($iframe),this._enforceImageSources($iframe)}catch(e){}}}},{key:"stopEnforce",value:function(){}},{key:"clearEnforce",value:function(){}},{key:"_detectBadUri",value:function(mandatoryPatterns,sourceObject,sourceUrl,badUriEventPrefix){mandatoryPatterns.every(function(pattern){return-1===sourceUrl.indexOf(pattern)})&&!sourceObject.getAttribute("cnx")&&(sourceObject.setAttribute("cnx","true"),this._onBadUriDetected.next({referenceId:this._currentReferenceId,enforcementMessage:"".concat(badUriEventPrefix,"-").concat(sourceObject)}))}},{key:"_enforceIframeSource",value:function($iframe){var _this=this,iframeSource=$iframe.getAttribute("src");iframeSource&&(this._malwareIframeSources.forEach(function(malwareSource){iframeSource.indexOf(malwareSource)>-1&&_this._onMalwareDetected.next({referenceId:_this._currentReferenceId,enforcementMessage:"malware-".concat(malwareSource)})}),this._detectBadUri(["//","about:blank","about:self","javascript:"],$iframe,iframeSource,"iframe"))}},{key:"_enforceScriptSources",value:function($iframe){var _this2=this;Object(ArrayUtils.c)($iframe.contentDocument.getElementsByTagName("script")).forEach(function($script){var scriptSource=$script.getAttribute("src");scriptSource&&(_this2._malwareScriptSources.forEach(function(malwareSource){scriptSource.indexOf(malwareSource)>-1&&_this2._onMalwareDetected.next({referenceId:_this2._currentReferenceId,enforcementMessage:"malware-".concat(malwareSource)})}),_this2._detectBadUri(["//"],$script,scriptSource,"script"))})}},{key:"_enforceAnchorSources",value:function($iframe){var _this3=this;Object(ArrayUtils.c)($iframe.contentDocument.getElementsByTagName("a")).forEach(function($anchor){var anchorSource=$anchor.getAttribute("href");anchorSource&&_this3._malwareAnchorSources.forEach(function(malwareSource){anchorSource.indexOf(malwareSource)>-1&&_this3._onMalwareDetected.next({referenceId:_this3._currentReferenceId,enforcementMessage:"malware-".concat(malwareSource)})})})}},{key:"_enforceImageSources",value:function($iframe){var _this4=this;Object(ArrayUtils.c)($iframe.contentDocument.getElementsByTagName("img")).forEach(function($img){var imgSource=$img.getAttribute("src");imgSource&&_this4._malwareImageSources.forEach(function(malwareSource){imgSource.indexOf(malwareSource)>-1&&_this4._onMalwareDetected.next({referenceId:_this4._currentReferenceId,enforcementMessage:"malware-".concat(malwareSource)})})})}},{key:"onMalwareDetected",get:function(){return this._onMalwareDetected.asObservable()}},{key:"onBadUriDetected",get:function(){return this._onBadUriDetected.asObservable()}}]),EnforcerMalware}(),AdEnforcerController_AdEnforcerController=function(){function AdEnforcerController(isMobile,renderingWindow,_disableScrollHijackEnforcement){var _this=this;if(classCallCheck_default()(this,AdEnforcerController),this._disableScrollHijackEnforcement=_disableScrollHijackEnforcement,this._enforceIntervalId=null,this._enforcers=new Map,this._activeEnforcersBitMask=EnforcerTypesEnum.None,this._enforcerIntervalDelay=300,this._subscriptions=[],this._registeredContainersMap=new Map,this._onEnforcerEvent=new Subject.a,this._enforcers.set(EnforcerTypesEnum.MemoryLeak,new EnforcerMemory_EnforcerMemory(renderingWindow)),_disableScrollHijackEnforcement||this._enforcers.set(EnforcerTypesEnum.ScrollHijack,new EnforcerScroll_EnforcerScroll),!isMobile){var muteEnforcer=new EnforcerMute_EnforcerMute;this._enforcers.set(EnforcerTypesEnum.Mute,muteEnforcer),this._subscriptions.push(muteEnforcer.onVolumeDetected.subscribe(function(referenceId){_this._dispatchEnforcerEvent(EnforcerEventsEnum.VOLUME_DETECTED,referenceId,"")}))}var malwareEnforcer=new EnforcerMalware_EnforcerMalware;this._subscriptions.push(malwareEnforcer.onBadUriDetected.subscribe(function(event){_this._dispatchEnforcerEvent(EnforcerEventsEnum.BADURI_DETECTED,event.referenceId,event.enforcementMessage)}),malwareEnforcer.onMalwareDetected.subscribe(function(event){_this._dispatchEnforcerEvent(EnforcerEventsEnum.MALWARE_DETECTED,event.referenceId,event.enforcementMessage)})),this._enforcers.set(EnforcerTypesEnum.Malware,malwareEnforcer)}return createClass_default()(AdEnforcerController,[{key:"registerContainer",value:function(container,uniqueReferenceId){this._registeredContainersMap.get(container)||this._registeredContainersMap.set(container,uniqueReferenceId)}},{key:"deregisterContainer",value:function(container){var _this2=this;this._registeredContainersMap.get(container)&&(this._enforcers.forEach(function(enforcer){enforcer.clearEnforce(_this2._registeredContainersMap.get(container))}),this._registeredContainersMap.delete(container),this._registeredContainersMap.size||this.stop(EnforcerTypesEnum.All))}},{key:"start",value:function(enforcerBitMask){var _this3=this;this._disableScrollHijackEnforcement&&(enforcerBitMask^=EnforcerTypesEnum.ScrollHijack),this._activeEnforcersBitMask|=enforcerBitMask,null===this._enforceIntervalId&&(this._enforceIntervalId=setInterval(function(){try{_this3._registeredContainersMap.forEach(function(referenceId,container){_this3._doRecursiveEnforce(container,referenceId)})}catch(e){}},this._enforcerIntervalDelay))}},{key:"stop",value:function(enforcerBitMask){this._activeEnforcersBitMask&=~enforcerBitMask,this._activeEnforcersBitMask===EnforcerTypesEnum.None&&(clearInterval(this._enforceIntervalId),this._enforceIntervalId=null),this._enforcers.forEach(function(enforcer,enforcerType){enforcerBitMask&enforcerType&&enforcer.stopEnforce()})}},{key:"destroy",value:function(){var _this4=this;this.stop(EnforcerTypesEnum.All),clearSubscriptions(this._subscriptions),this._registeredContainersMap.forEach(function(reference,container){_this4.deregisterContainer(container)})}},{key:"_doRecursiveEnforce",value:function($container,parentContainerReferenceId){var _this5=this;Object(ArrayUtils.c)($container.getElementsByTagName("iframe")).forEach(function($frame){try{_this5._doRecursiveEnforce($frame,parentContainerReferenceId)}catch(e){}}),this._enforcers.forEach(function(enforcer,enforcerType){_this5._activeEnforcersBitMask&enforcerType&&enforcer.enforce($container,parentContainerReferenceId)})}},{key:"_dispatchEnforcerEvent",value:function(eventType,referenceId,detectionMessage){var container;this._registeredContainersMap.forEach(function(reference,key){reference===referenceId&&(container=key)}),this._onEnforcerEvent.next({message:detectionMessage,type:eventType,detectedContainer:container})}},{key:"onEnforcerEvent",get:function(){return this._onEnforcerEvent.asObservable()}}]),AdEnforcerController}(),AdImpressionerController_AdImpressionerController=function(){function AdImpressionerController(_settings){var _this=this;classCallCheck_default()(this,AdImpressionerController),this._settings=_settings,this._isSelectingAllowed=!1,this._startedBid=void 0,this._startedBidSubscriptions=[],this._subscriptions=[],this._isStartedBidInImpression=!1,this._onAdSelected=new Subject.a,this._onAdFinished=new Subject.a,this._quartilesSent=[],this._subscriptions.push(this._settings.adBidPool.onBidReady.subscribe(function(){PrerollProblemLoggingUtils_PrerollProblemLoggingUtils.trackBidReady(_this._settings.playerId),_this._tryStartBestBid()}),this._settings.impressionCapsTimer.onTimer().subscribe(function(){_this._tryStartBestBid()}))}return createClass_default()(AdImpressionerController,[{key:"start",value:function(state){this._cachedState=state,this._isSelectingAllowed=!0,this._tryStartBestBid()}},{key:"stop",value:function(){this._isSelectingAllowed=!1}},{key:"destroy",value:function(){this.stop(),clearSubscriptions(this._subscriptions),this._startedBid||this._removeStartedBid()}},{key:"_tryStartBestBid",value:function(){if(this._isSelectingAllowed&&!this._isStartedBidInImpression){var selectedBid=this._getBestBidFromPool(this._cachedState);if(selectedBid){var isBidBetterThanStarted=this._isBidBetterThanStartedBid(selectedBid);this._startedBid&&this._settings.removeBidIfHigherYoScore&&isBidBetterThanStarted?(this._removeStartedBid(),this._startedBid.stopAd("removeStartedBid"),this._startBidReady(selectedBid)):this._startedBid||this._startBidReady(selectedBid)}}}},{key:"_startBidReady",value:function(bid){this._startedBid=bid,this._quartilesSent=[],this._settings.adBidPool.moveBidToStarted(bid),this._onAdSelected.next(bid),this._subscribeToBidStartedEvents(bid),PrerollProblemLoggingUtils_PrerollProblemLoggingUtils.trackStartAd(this._settings.playerId),bid.startAd()}},{key:"_removeStartedBid",value:function(){this._startedBid&&(clearSubscriptions(this._startedBidSubscriptions),this._startedBidSubscriptions=[],this._settings.adBidPool.consumeBidStarted(this._startedBid),this._startedBid=void 0,this._quartilesSent=[])}},{key:"_canBeSelected",value:function(bid){var lineItem=bid.settings.adManagerLineItem;return this._settings.impressionCapsService.canCall(lineItem,this._cachedState.adOpportunity.id)}},{key:"_getBestBidFromPool",value:function(state){var _this2=this,availableBids=this._settings.adBidPool.bidsReady.filter(function(bidReady){return _this2._canBeSelected(bidReady)});return this._settings.adImpressionerYo.getBestBid(availableBids,state)}},{key:"_isBidBetterThanStartedBid",value:function(bid){return!!this._startedBid&&this._settings.adImpressionerYo.getBetterBid(bid,this._startedBid)!==this._startedBid}},{key:"_handleAdImpression",value:function(bid,timeSpent){this._isStartedBidInImpression&&Object(Logging.a)({message:"AdManager_ABaseBidAdaptor_multipleImpressions",exception:"advertiserLineItemId:".concat(bid.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,"_creativeId:").concat(bid.creativeId),callStack:"".concat(bid.adMediaType),throttle:1e3,level:protos.ProtoLoggingLevelEnum.FATAL,sendMaxLog:!0}),this._settings.adImpressionerYo.registerImpression(bid.settings.id,bid.settings.adManagerLineItem.protoLineItem.creativeType),PrerollProblemLoggingUtils_PrerollProblemLoggingUtils.trackAdImpression(this._settings.playerId,bid),this._isStartedBidInImpression=!0,this._settings.adRequestGatekeeper.addImpression(bid.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,bid.settings.obfuscatedPrice),this._settings.impressionCapsService.registerImpressionForLineItem(bid.settings.adManagerLineItem,this._cachedState.adOpportunity.id),this._settings.requestCapsService.restoreOneCapForLineItem(bid.settings.adManagerLineItem,this._cachedState.adOpportunity.id),bid.settings.adManagerLineItem.bids.delete(bid);var auctionInfo=this._settings.auctionInfoLogging.onImpression(bid);this._handleAdImpressionTracking(bid,timeSpent,auctionInfo)}},{key:"_handleAdStop",value:function(bid,timeSpent,postbidReason){var shouldTrackPostBid=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this._handlePostBidOnAdStop(bid,timeSpent,postbidReason,shouldTrackPostBid),this._settings.loopAdWhenFinished?bid.resumeAd():this._settings.pauseAdWhenFinished?bid.pauseAd():(this._onAdFinished.next(bid),this._removeStartedBid(),this._tryStartBestBid())}},{key:"_handlePostBidOnAdStop",value:function(bid,timeSpent,postbidReason){var shouldTrackPostBid=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(this._isStartedBidInImpression)this._isStartedBidInImpression=!1;else if(shouldTrackPostBid){this._settings.adImpressionerYo.registerPostBid(bid.settings.id,bid.settings.adManagerLineItem.protoLineItem.creativeType,postbidReason);var auctionInfo=this._settings.auctionInfoLogging.onPostBid(bid);this._handlePostBidTracking(bid,postbidReason,timeSpent,auctionInfo),bid.settings.adManagerLineItem.bids.delete(bid)}}},{key:"_handleAdImpressionTracking",value:function(bid,timeSpent,auctionInformation){var _a,_b,adBreakState=this._cachedState.adBreakState,detectedDuration=Object(TypeUtils.d)(Object(NumberUtils.h)(bid.getAdDuration(),2))?Object(NumberUtils.h)(bid.getAdDuration(),2):0,declaredDuration=Object(TypeUtils.d)(Object(NumberUtils.h)(bid.declaredDurationInSeconds,2))?Object(NumberUtils.h)(bid.declaredDurationInSeconds,2):0,deltaImpressionDuration=detectedDuration-declaredDuration,videoAdImpression={adPodSlotPosition:adBreakState.adPodSlotIndex,adsourceType:bid.adSourceType,advertiserLineItemId:bid.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,publisherLineItemId:bid.settings.adManagerLineItem.protoLineItem.publisherLineItemId,customClientPrice:bid.settings.cpm,encryptedPrice:bid.settings.requestMetadata.data.encryptedPrice,prebidJsBidderName:bid.settings.requestMetadata.data.prebidJsBidderName,rtbAdomain:bid.settings.requestMetadata.data.rtbAdomain,creativeId:bid.creativeId,rtbSeatId:bid.settings.requestMetadata.data.rtbSeatId,syncedUser:bid.settings.requestMetadata.data.syncedUser,timeSpent:timeSpent,vastMediaType:bid.adMediaType,dspId:bid.settings.requestMetadata.data.dspId,cnxBidId:bid.settings.requestMetadata.data.cnxBidId,winToAdLoadedTime:null===(_a=bid.settings.bidLifecycle)||void 0===_a?void 0:_a.winToAdLoadedTime,startAdToImpressionTime:null===(_b=bid.settings.bidLifecycle)||void 0===_b?void 0:_b.startAdToImpressionTime,impressionDuration:deltaImpressionDuration,declaredDuration:declaredDuration,useExploration:this._settings.explorationMode,playerWidth:this._settings.adContainer.getContainerStateMap().get(bid.settings.adManagerLineItem.protoLineItem.adType).width};Object(TypeUtils.a)(auctionInformation)&&(videoAdImpression.auctionInformation=auctionInformation),this._settings.trackingService.trackVideoAdImpression(videoAdImpression)}},{key:"_handlePostBidTracking",value:function(bid,postbidReason,timeSpent,auctionInformation){var _a,adBreakState=this._cachedState.adBreakState;PrerollProblemLoggingUtils_PrerollProblemLoggingUtils.trackPostBid(this._settings.playerId);var postbid={adPodSlotPosition:adBreakState.adPodSlotIndex,adsourceType:bid.adSourceType,advertiserLineItemId:bid.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,publisherLineItemId:bid.settings.adManagerLineItem.protoLineItem.publisherLineItemId,error:postbidReason,loaded:!0,prebidJsBidderName:bid.settings.requestMetadata.data.prebidJsBidderName,vastMediaType:bid.adMediaType,syncedUser:bid.settings.requestMetadata.data.syncedUser,rtbSeatId:bid.settings.requestMetadata.data.rtbSeatId,rtbAdomain:bid.settings.requestMetadata.data.rtbAdomain,creativeId:bid.creativeId,timeSpent:timeSpent,dspId:bid.settings.requestMetadata.data.dspId,cnxBidId:bid.settings.requestMetadata.data.cnxBidId,winToAdLoadedTime:null===(_a=bid.settings.bidLifecycle)||void 0===_a?void 0:_a.winToAdLoadedTime};Object(TypeUtils.a)(auctionInformation)&&(postbid.auctionInformation=auctionInformation,postbid.auctionPostbidReason=this._settings.auctionInfoLogging.getGeneralPostbidReason(postbidReason)),this._settings.trackingService.addPostBid(postbid)}},{key:"_handleQuartilesTracking",value:function(bid,quartile){this._quartilesSent.indexOf(quartile)>=0&&!(this._settings.pauseAdWhenFinished||this._settings.loopAdWhenFinished)?1===Object(GeneralUtils.l)([99,1])&&Object(Logging.a)({message:"AdManager_AdImpressionerController_handleQuartilesTracking_track_same_quartile_twice",level:protos.ProtoLoggingLevelEnum.WARNING,exception:bid.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,callStack:bid.adMediaType}):(this._quartilesSent.push(quartile),this._settings.trackingService.trackVideoAdQuartile({advertiserLineItemId:bid.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,publisherLineItemId:bid.settings.adManagerLineItem.protoLineItem.publisherLineItemId,quartile:quartile,rtbSeatId:bid.settings.requestMetadata.data.rtbSeatId,dspId:bid.settings.requestMetadata.data.dspId}))}},{key:"_subscribeToBidStartedEvents",value:function(bid){var _this3=this,startTime=Date.now();this._startedBidSubscriptions.push(bid.onVpaidEvent.subscribe(function(eventData){var _a,trackers=function(vpaidEvent,trackerInformation){switch(vpaidEvent){case VastConfig.b.AdImpression:return trackerInformation.adImpression;case VastConfig.b.AdClickThru:return trackerInformation.adClick;case VastConfig.b.AdStarted:return trackerInformation.adStarted;case VastConfig.b.AdVideoStart:return trackerInformation.adVideoStart;case VastConfig.b.AdVideoFirstQuartile:return trackerInformation.adQuartileFirst;case VastConfig.b.AdVideoMidpoint:return trackerInformation.adQuartileSecond;case VastConfig.b.AdVideoThirdQuartile:return trackerInformation.adQuartileThird;case VastConfig.b.AdVideoComplete:return trackerInformation.adQuartileFourth;case VastConfig.b.AdPaused:return trackerInformation.adPause;case VastConfig.b.AdPlaying:return trackerInformation.adResume;case VastConfig.b.AdSkipped:return trackerInformation.adSkip;case VastConfig.b.AdUserClose:return trackerInformation.adUserClose;case VastConfig.b.AdUserAcceptInvitation:return trackerInformation.adUserAcceptInvitation;case VastConfig.b.AdUserMinimize:return trackerInformation.adUserMinimize;case VastConfig.b.AdError:return trackerInformation.adError}}(eventData.type,bid.settings.trackers),timeElapsed=Date.now()-startTime;switch(trackers||eventData.type!==VastConfig.b.AdImpression||(_this3._logImpressionTrackingFailed("AdManager_AdImpressionController_tracker_impression_not_found"),Object(Logging.a)({sendMaxLog:!1,message:"AdManager_AdImpressionController_tracker_impression_not_found",level:protos.ProtoLoggingLevelEnum.FATAL})),TrackersInformation_TrackersInformation.track(trackers,_this3._settings.adMacroReplacer,bid.settings.adManagerLineItem.protoLineItem,bid.settings.callingState),eventData.type){case VastConfig.b.AdError:_this3._handleAdStop(bid,timeElapsed,eventData.payload.errorMessage);break;case VastConfig.b.AdSkipped:_this3._handleAdStop(bid,timeElapsed,MonetisationConfig.c.AdStopped);break;case VastConfig.b.AdStopped:_this3._handleAdStop(bid,timeElapsed,MonetisationConfig.c.AdStopped,null===(_a=eventData.payload)||void 0===_a?void 0:_a.shouldTrackPostBid);break;case VastConfig.b.AdImpression:_this3._handleAdImpression(bid,timeElapsed);break;case VastConfig.b.AdVideoFirstQuartile:_this3._handleQuartilesTracking(bid,protos.ProtoQuartilesEnum.First);break;case VastConfig.b.AdVideoMidpoint:_this3._handleQuartilesTracking(bid,protos.ProtoQuartilesEnum.Second);break;case VastConfig.b.AdVideoThirdQuartile:_this3._handleQuartilesTracking(bid,protos.ProtoQuartilesEnum.Third);break;case VastConfig.b.AdVideoComplete:_this3._handleQuartilesTracking(bid,protos.ProtoQuartilesEnum.Fourth)}})),this._startedBidSubscriptions.push(bid.onAdViewableImpression.subscribe(function(eventData){_this3._settings.trackingService.trackVideoAdImpressionViewable(eventData)}))}},{key:"_logImpressionTrackingFailed",value:function(message,error){var _a,_b;Object(Logging.a)({message:message,level:protos.ProtoLoggingLevelEnum.FATAL,sendMaxLog:!1,exception:null===(_a=error)||void 0===_a?void 0:_a.message,callStack:null===(_b=error)||void 0===_b?void 0:_b.stack})}},{key:"onAdSelected",get:function(){return this._onAdSelected.asObservable()}},{key:"onAdFinished",get:function(){return this._onAdFinished.asObservable()}}]),AdImpressionerController}(),AdSlotMacroMapping=(_AdSlotMacroMapping={},defineProperty_default()(_AdSlotMacroMapping,protos.ProtoAdBreakTypeEnum.PreRoll,"preRoll"),defineProperty_default()(_AdSlotMacroMapping,protos.ProtoAdBreakTypeEnum.MidRoll,"midRoll"),defineProperty_default()(_AdSlotMacroMapping,protos.ProtoAdBreakTypeEnum.PostRoll,"postRoll"),_AdSlotMacroMapping),AdMacroReplacer_AdMacroReplacer=function(){function AdMacroReplacer(_macroService,_userManagerService){classCallCheck_default()(this,AdMacroReplacer),this._macroService=_macroService,this._userManagerService=_userManagerService}return createClass_default()(AdMacroReplacer,[{key:"replace",value:function(url,adVendorId,dynamicMacroSettings){this._macroService.setAdWidth(dynamicMacroSettings.adMacros.adWidth),this._macroService.setAdHeight(dynamicMacroSettings.adMacros.adHeight),this._macroService.setAdPosition(AdSlotMacroMapping[dynamicMacroSettings.adMacros.adPostion]),dynamicMacroSettings.mediaMacros.mediaDescription&&this._macroService.setVideoDescription(dynamicMacroSettings.mediaMacros.mediaDescription),dynamicMacroSettings.mediaMacros.mediaDuration&&this._macroService.setVideoDuration(dynamicMacroSettings.mediaMacros.mediaDuration),dynamicMacroSettings.mediaMacros.mediaId&&this._macroService.setVideoId(dynamicMacroSettings.mediaMacros.mediaId),dynamicMacroSettings.mediaMacros.mediaTitle&&this._macroService.setVideoTitle(dynamicMacroSettings.mediaMacros.mediaTitle),dynamicMacroSettings.mediaMacros.mediaUrl&&this._macroService.setVideoUrl(dynamicMacroSettings.mediaMacros.mediaUrl);var vendorConsent=this._userManagerService.isConsent(adVendorId);this._macroService.setGDPR(this._userManagerService.isConsentRequired()?1:0),this._macroService.setConsent(vendorConsent?1:0),this._macroService.setGDPRConsent(this._userManagerService.getConsentPayload());var trackableUUID=this._userManagerService.getTrackableUser(),uuid=this._userManagerService.isConsentConnatix()&&vendorConsent?trackableUUID:void 0;return this._macroService.setUUID(uuid),this._macroService.setupMacros(url)}}]),AdMacroReplacer}(),MAX_TIME_IN_PAUSE=30*TimeConfig.f,AdPauser_AdPauser=function(){function AdPauser(){classCallCheck_default()(this,AdPauser),this._currentAdPlayingData=null}return createClass_default()(AdPauser,[{key:"onAdRemoved",value:function(){this._currentAdPlayingData=null,this._clearAdPauseTimeout()}},{key:"pauseViaUserInteraction",value:function(){this._currentAdPlayingData&&(this._currentAdPlayingData.pausedWithUserInteraction=!0)}},{key:"resumeViaUserInteraction",value:function(){this._currentAdPlayingData&&(this._currentAdPlayingData.pausedWithUserInteraction=!1,this._clearAdPauseTimeout())}},{key:"_resetCurrentAdState",value:function(currentAd){this._currentAdPlayingData={currentAd:currentAd,isPaused:!1,pausedWithUserInteraction:!1,remainingTimeForAdToBePaused:MAX_TIME_IN_PAUSE,lastAdPausedStartedTimestamp:void 0},this._clearAdPauseTimeout()}},{key:"checkPauseAd",value:function(currentAd,viewability){currentAd&&(null===this._currentAdPlayingData&&this._resetCurrentAdState(currentAd),viewability?this._checkResumeAdInView(currentAd):this._checkPauseAdOutOfView(currentAd))}},{key:"_checkPauseAdOutOfView",value:function(currentAd){var _this=this;this._isAdPlayingEligibleForPause(currentAd)&&(this._currentAdPlayingData.isPaused=!0,this._currentAdPlayingData.lastAdPausedStartedTimestamp=Date.now(),currentAd.pauseAd(),this._clearAdPauseTimeout(),this._adPauseTimeout=setTimeout(function(){currentAd.stopAd("pauseOutOfView"),_this._currentAdPlayingData=null,_this._clearAdPauseTimeout()},this._currentAdPlayingData.remainingTimeForAdToBePaused))}},{key:"_checkResumeAdInView",value:function(currentAd){currentAd.settings.adManagerLineItem.protoLineItem.pauseAdOutOfView&&currentAd.impressionStarted&&this._currentAdPlayingData.isPaused&&!this._currentAdPlayingData.pausedWithUserInteraction&&(this._clearAdPauseTimeout(),this._currentAdPlayingData.isPaused=!1,this._currentAdPlayingData.remainingTimeForAdToBePaused=this._currentAdPlayingData.remainingTimeForAdToBePaused-(Date.now()-this._currentAdPlayingData.lastAdPausedStartedTimestamp),currentAd.resumeAd())}},{key:"_clearAdPauseTimeout",value:function(){clearTimeout(this._adPauseTimeout),this._adPauseTimeout=void 0}},{key:"_isAdPlayingEligibleForPause",value:function(currentAd){return currentAd.settings.adManagerLineItem.protoLineItem.pauseAdOutOfView&&currentAd.impressionStarted&&!this._currentAdPlayingData.isPaused&&!this._currentAdPlayingData.pausedWithUserInteraction}}]),AdPauser}();var Subscriber=__webpack_require__(40);function map(project,thisArg){return function(source){if("function"!=typeof project)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return source.lift(new MapOperator(project,thisArg))}}var MapOperator=function(){function MapOperator(project,thisArg){this.project=project,this.thisArg=thisArg}return MapOperator.prototype.call=function(subscriber,source){return source.subscribe(new map_MapSubscriber(subscriber,this.project,this.thisArg))},MapOperator}(),map_MapSubscriber=function(_super){function MapSubscriber(destination,project,thisArg){var _this=_super.call(this,destination)||this;return _this.project=project,_this.count=0,_this.thisArg=thisArg||_this,_this}return tslib_es6.a(MapSubscriber,_super),MapSubscriber.prototype._next=function(value){var result;try{result=this.project.call(this.thisArg,value,this.count++)}catch(err){return void this.destination.error(err)}this.destination.next(result)},MapSubscriber}(Subscriber.a),subscribeToArray=function(array){return function(subscriber){for(var i=0,len=array.length;i<len&&!subscriber.closed;i++)subscriber.next(array[i]);subscriber.complete()}},hostReportError=__webpack_require__(64);function getSymbolIterator(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var iterator_iterator=getSymbolIterator(),symbol_observable=__webpack_require__(61),isArrayLike=function(x){return x&&"number"==typeof x.length&&"function"!=typeof x};function isPromise(value){return!!value&&"function"!=typeof value.subscribe&&"function"==typeof value.then}var isObject=__webpack_require__(102),subscribeTo=function(result){if(result&&"function"==typeof result[symbol_observable.a])return obj=result,function(subscriber){var obs=obj[symbol_observable.a]();if("function"!=typeof obs.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return obs.subscribe(subscriber)};if(isArrayLike(result))return subscribeToArray(result);if(isPromise(result))return promise=result,function(subscriber){return promise.then(function(value){subscriber.closed||(subscriber.next(value),subscriber.complete())},function(err){return subscriber.error(err)}).then(null,hostReportError.a),subscriber};if(result&&"function"==typeof result[iterator_iterator])return iterable=result,function(subscriber){for(var iterator=iterable[iterator_iterator]();;){var item=void 0;try{item=iterator.next()}catch(err){return subscriber.error(err),subscriber}if(item.done){subscriber.complete();break}if(subscriber.next(item.value),subscriber.closed)break}return"function"==typeof iterator.return&&subscriber.add(function(){iterator.return&&iterator.return()}),subscriber};var iterable,promise,obj,value=Object(isObject.a)(result)?"an invalid object":"'"+result+"'";throw new TypeError("You provided "+value+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function scheduleArray(input,scheduler){return new Observable.a(function(subscriber){var sub=new Subscription.a,i=0;return sub.add(scheduler.schedule(function(){i!==input.length?(subscriber.next(input[i++]),subscriber.closed||sub.add(this.schedule())):subscriber.complete()})),sub})}function scheduled(input,scheduler){if(null!=input){if(function(input){return input&&"function"==typeof input[symbol_observable.a]}(input))return function(input,scheduler){return new Observable.a(function(subscriber){var sub=new Subscription.a;return sub.add(scheduler.schedule(function(){var observable=input[symbol_observable.a]();sub.add(observable.subscribe({next:function(value){sub.add(scheduler.schedule(function(){return subscriber.next(value)}))},error:function(err){sub.add(scheduler.schedule(function(){return subscriber.error(err)}))},complete:function(){sub.add(scheduler.schedule(function(){return subscriber.complete()}))}}))})),sub})}(input,scheduler);if(isPromise(input))return function(input,scheduler){return new Observable.a(function(subscriber){var sub=new Subscription.a;return sub.add(scheduler.schedule(function(){return input.then(function(value){sub.add(scheduler.schedule(function(){subscriber.next(value),sub.add(scheduler.schedule(function(){return subscriber.complete()}))}))},function(err){sub.add(scheduler.schedule(function(){return subscriber.error(err)}))})})),sub})}(input,scheduler);if(isArrayLike(input))return scheduleArray(input,scheduler);if(function(input){return input&&"function"==typeof input[iterator_iterator]}(input)||"string"==typeof input)return function(input,scheduler){if(!input)throw new Error("Iterable cannot be null");return new Observable.a(function(subscriber){var iterator,sub=new Subscription.a;return sub.add(function(){iterator&&"function"==typeof iterator.return&&iterator.return()}),sub.add(scheduler.schedule(function(){iterator=input[iterator_iterator](),sub.add(scheduler.schedule(function(){if(!subscriber.closed){var value,done;try{var result=iterator.next();value=result.value,done=result.done}catch(err){return void subscriber.error(err)}done?subscriber.complete():(subscriber.next(value),this.schedule())}}))})),sub})}(input,scheduler)}throw new TypeError((null!==input&&typeof input||input)+" is not observable")}var innerSubscribe_SimpleInnerSubscriber=function(_super){function SimpleInnerSubscriber(parent){var _this=_super.call(this)||this;return _this.parent=parent,_this}return tslib_es6.a(SimpleInnerSubscriber,_super),SimpleInnerSubscriber.prototype._next=function(value){this.parent.notifyNext(value)},SimpleInnerSubscriber.prototype._error=function(error){this.parent.notifyError(error),this.unsubscribe()},SimpleInnerSubscriber.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},SimpleInnerSubscriber}(Subscriber.a),innerSubscribe_SimpleOuterSubscriber=(Subscriber.a,function(_super){function SimpleOuterSubscriber(){return null!==_super&&_super.apply(this,arguments)||this}return tslib_es6.a(SimpleOuterSubscriber,_super),SimpleOuterSubscriber.prototype.notifyNext=function(innerValue){this.destination.next(innerValue)},SimpleOuterSubscriber.prototype.notifyError=function(err){this.destination.error(err)},SimpleOuterSubscriber.prototype.notifyComplete=function(){this.destination.complete()},SimpleOuterSubscriber}(Subscriber.a));Subscriber.a;function mergeMap(project,resultSelector,concurrent){return void 0===concurrent&&(concurrent=Number.POSITIVE_INFINITY),"function"==typeof resultSelector?function(source){return source.pipe(mergeMap(function(a,i){return(input=project(a,i),scheduler?scheduled(input,scheduler):input instanceof Observable.a?input:new Observable.a(subscribeTo(input))).pipe(map(function(b,ii){return resultSelector(a,b,i,ii)}));var input,scheduler},concurrent))}:("number"==typeof resultSelector&&(concurrent=resultSelector),function(source){return source.lift(new MergeMapOperator(project,concurrent))})}var MergeMapOperator=function(){function MergeMapOperator(project,concurrent){void 0===concurrent&&(concurrent=Number.POSITIVE_INFINITY),this.project=project,this.concurrent=concurrent}return MergeMapOperator.prototype.call=function(observer,source){return source.subscribe(new mergeMap_MergeMapSubscriber(observer,this.project,this.concurrent))},MergeMapOperator}(),mergeMap_MergeMapSubscriber=function(_super){function MergeMapSubscriber(destination,project,concurrent){void 0===concurrent&&(concurrent=Number.POSITIVE_INFINITY);var _this=_super.call(this,destination)||this;return _this.project=project,_this.concurrent=concurrent,_this.hasCompleted=!1,_this.buffer=[],_this.active=0,_this.index=0,_this}return tslib_es6.a(MergeMapSubscriber,_super),MergeMapSubscriber.prototype._next=function(value){this.active<this.concurrent?this._tryNext(value):this.buffer.push(value)},MergeMapSubscriber.prototype._tryNext=function(value){var result,index=this.index++;try{result=this.project(value,index)}catch(err){return void this.destination.error(err)}this.active++,this._innerSub(result)},MergeMapSubscriber.prototype._innerSub=function(ish){var innerSubscriber=new innerSubscribe_SimpleInnerSubscriber(this),destination=this.destination;destination.add(innerSubscriber);var innerSubscription=function(result,innerSubscriber){if(!innerSubscriber.closed)return result instanceof Observable.a?result.subscribe(innerSubscriber):subscribeTo(result)(innerSubscriber)}(ish,innerSubscriber);innerSubscription!==innerSubscriber&&destination.add(innerSubscription)},MergeMapSubscriber.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},MergeMapSubscriber.prototype.notifyNext=function(innerValue){this.destination.next(innerValue)},MergeMapSubscriber.prototype.notifyComplete=function(){var buffer=this.buffer;this.active--,buffer.length>0?this._next(buffer.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},MergeMapSubscriber}(innerSubscribe_SimpleOuterSubscriber),identity=__webpack_require__(103);function merge(){for(var observables=[],_i=0;_i<arguments.length;_i++)observables[_i]=arguments[_i];var value,concurrent=Number.POSITIVE_INFINITY,scheduler=null,last=observables[observables.length-1];return(value=last)&&"function"==typeof value.schedule?(scheduler=observables.pop(),observables.length>1&&"number"==typeof observables[observables.length-1]&&(concurrent=observables.pop())):"number"==typeof last&&(concurrent=observables.pop()),null===scheduler&&1===observables.length&&observables[0]instanceof Observable.a?observables[0]:function(concurrent){return void 0===concurrent&&(concurrent=Number.POSITIVE_INFINITY),mergeMap(identity.a,concurrent)}(concurrent)(function(input,scheduler){return scheduler?scheduleArray(input,scheduler):new Observable.a(subscribeToArray(input))}(observables,scheduler))}var operators_filter=__webpack_require__(305);function takeWhile(predicate,inclusive){return void 0===inclusive&&(inclusive=!1),function(source){return source.lift(new TakeWhileOperator(predicate,inclusive))}}var TakeWhileOperator=function(){function TakeWhileOperator(predicate,inclusive){this.predicate=predicate,this.inclusive=inclusive}return TakeWhileOperator.prototype.call=function(subscriber,source){return source.subscribe(new takeWhile_TakeWhileSubscriber(subscriber,this.predicate,this.inclusive))},TakeWhileOperator}(),takeWhile_TakeWhileSubscriber=function(_super){function TakeWhileSubscriber(destination,predicate,inclusive){var _this=_super.call(this,destination)||this;return _this.predicate=predicate,_this.inclusive=inclusive,_this.index=0,_this}return tslib_es6.a(TakeWhileSubscriber,_super),TakeWhileSubscriber.prototype._next=function(value){var result,destination=this.destination;try{result=this.predicate(value,this.index++)}catch(err){return void destination.error(err)}this.nextOrComplete(value,result)},TakeWhileSubscriber.prototype.nextOrComplete=function(value,predicateResult){var destination=this.destination;Boolean(predicateResult)?destination.next(value):(this.inclusive&&destination.next(value),destination.complete())},TakeWhileSubscriber}(Subscriber.a);function noop(){}var isFunction=__webpack_require__(72);function tap(nextOrObserver,error,complete){return function(source){return source.lift(new DoOperator(nextOrObserver,error,complete))}}var TargetingUtils_TargetingUtils,DoOperator=function(){function DoOperator(nextOrObserver,error,complete){this.nextOrObserver=nextOrObserver,this.error=error,this.complete=complete}return DoOperator.prototype.call=function(subscriber,source){return source.subscribe(new tap_TapSubscriber(subscriber,this.nextOrObserver,this.error,this.complete))},DoOperator}(),tap_TapSubscriber=function(_super){function TapSubscriber(destination,observerOrNext,error,complete){var _this=_super.call(this,destination)||this;return _this._tapNext=noop,_this._tapError=noop,_this._tapComplete=noop,_this._tapError=error||noop,_this._tapComplete=complete||noop,Object(isFunction.a)(observerOrNext)?(_this._context=_this,_this._tapNext=observerOrNext):observerOrNext&&(_this._context=observerOrNext,_this._tapNext=observerOrNext.next||noop,_this._tapError=observerOrNext.error||noop,_this._tapComplete=observerOrNext.complete||noop),_this}return tslib_es6.a(TapSubscriber,_super),TapSubscriber.prototype._next=function(value){try{this._tapNext.call(this._context,value)}catch(err){return void this.destination.error(err)}this.destination.next(value)},TapSubscriber.prototype._error=function(err){try{this._tapError.call(this._context,err)}catch(err){return void this.destination.error(err)}this.destination.error(err)},TapSubscriber.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(err){return void this.destination.error(err)}return this.destination.complete()},TapSubscriber}(Subscriber.a),BidLoader_BidLoader=function(){function BidLoader(bid){var _this=this;classCallCheck_default()(this,BidLoader),this.bid=bid,this.cancelled=!1,this._onCancel=new Subject.a,this._bidLoadingConsumed=!1,this._onSuccess=this.bid.onVpaidEvent.pipe(Object(operators_filter.a)(function(eventData){return eventData.type===VastConfig.b.AdLoaded}),takeWhile(function(){return!_this._bidLoadingConsumed}),tap(function(){_this._bidLoadingConsumed=!0})),this._onError=this.bid.onVpaidEvent.pipe(Object(operators_filter.a)(function(eventData){return eventData.type===VastConfig.b.AdError}),map(function(adError){return adError.payload.errorMessage}),takeWhile(function(){return!_this._bidLoadingConsumed}),tap(function(){_this._bidLoadingConsumed=!0}))}return createClass_default()(BidLoader,[{key:"loadBid",value:function(width,height,viewMode,desiredBitrate,volume){this.bid.initAd(width,height,viewMode,desiredBitrate,void 0,void 0,volume)}},{key:"onSuccess",get:function(){return this._onSuccess}},{key:"onFailure",get:function(){return merge(this._onCancel,this._onError)}}]),BidLoader}(),DEFAULT_WINNING_THREADS_NUMBER=1,AdWinnerController_AdWinnerController=function(){function AdWinnerController(_settings){var _this=this;classCallCheck_default()(this,AdWinnerController),this._settings=_settings,this._loadingBids=new Set,this._bidUnsubscribeMap=new Map,this._subscriptions=[],this._enabled=!1,this._executeWinningTask=function(){if(!_this._isMaxNumberOfReadyBids()){var bidSelectionResult=_this._selectBestBidForWin();if(bidSelectionResult.selectedBid){var date=Date.now();return _this._settings.auctionInfoLogging.winBid(bidSelectionResult.selectedBid),_this._winBid(bidSelectionResult,_this._winSettings.vastViewMode).catch(function(reason){var selectedBid=bidSelectionResult.selectedBid,auctionInformation=_this._settings.auctionInfoLogging.onPostBid(bidSelectionResult.selectedBid);throw _this._handlePostbid(selectedBid,date,reason,auctionInformation),_this._startWinning(),bidSelectionResult}).then(function(){_this._startWinning()}).catch(function(e){if(e!==bidSelectionResult){var jsonError="";try{jsonError=JSON.stringify(e)}catch(_a){}Object(Logging.a)({message:"AdManager_winBid_failed",level:protos.ProtoLoggingLevelEnum.FATAL,exception:e,callStack:jsonError,throttle:3,sendMaxLog:!1})}})}}},this._promiseParallelCaller=new PromiseParallelCaller_PromiseParallelCaller(this._executeWinningTask,DEFAULT_WINNING_THREADS_NUMBER),this._subscriptions.push(this._settings.adBidPool.onBid.subscribe(function(newBid){var winSelectionResult=_this._selectBestBidForWin();_this._settings.auctionInfoLogging.newBidAdded(newBid,winSelectionResult),_this._startWinning()}),this._settings.adBidPool.onBidStarted.subscribe(function(){_this._startWinning()}),this._settings.adBidPool.onBidReadyConsumed.subscribe(function(){_this._startWinning()}),this._settings.impressionCapsTimer.onTimer().subscribe(function(){_this._startWinning()}))}return createClass_default()(AdWinnerController,[{key:"isLoadingBids",value:function(){return this._loadingBids.size>0}},{key:"win",value:function(winSettings){this._winSettings=winSettings,this._promiseParallelCaller.setNumberOfThreads(winSettings.maxParallelWins),this._enabled=!0,this._startWinning()}},{key:"stop",value:function(){this._enabled=!1,this._promiseParallelCaller.stop()}},{key:"destroy",value:function(){this.stop(),clearSubscriptions(this._subscriptions),this._bidUnsubscribeMap.forEach(function(unsubscribe){return unsubscribe()})}},{key:"_startWinning",value:function(){this._enabled&&this._promiseParallelCaller.start()}},{key:"_selectBestBidForWin",value:function(){var unprocessedBidSelectionResult=this._selectBestUnprocessedBid(),processedBidSelectionResult=this._selectBestProcessedBid();return this._getFinalWinSelectionResult(unprocessedBidSelectionResult,processedBidSelectionResult)}},{key:"_getFinalWinSelectionResult",value:function(unprocessedBidSelectionResult,processedBidSelectionResult){var winSelectionResult=Object.assign({},unprocessedBidSelectionResult);return unprocessedBidSelectionResult.selectedBid&&processedBidSelectionResult.selectedBid?(this._isBidBetter(processedBidSelectionResult.selectedBid,unprocessedBidSelectionResult.selectedBid)&&(winSelectionResult.selectedBid=void 0,winSelectionResult.unselectedBidList.push({bid:unprocessedBidSelectionResult.selectedBid,lossReason:protos.ProtoAuctionLossReasonEnum.CompetitorPriority})),winSelectionResult):winSelectionResult}},{key:"_isMaxNumberOfReadyBids",value:function(){return-1!==this._settings.maxNumberOfWins&&this._settings.adBidPool.bidsReady.length+this._loadingBids.size+(this._settings.adBidPool.bidStarted?1:0)>=this._settings.maxNumberOfWins}},{key:"_selectBestUnprocessedBid",value:function(){return this._selectBestBid(this._settings.adBidPool.bids)}},{key:"_selectBestProcessedBid",value:function(){var loadingBids=Object(ArrayUtils.d)(this._loadingBids).map(function(bidLoader){return bidLoader.bid}),readyBids=this._settings.adBidPool.bidsReady,pooledBids=[].concat(toConsumableArray_default()(loadingBids),toConsumableArray_default()(readyBids));return this._selectBestBid(pooledBids)}},{key:"_selectBestBid",value:function(bidList){return this._settings.adWinnerYo.selectBestBid(bidList,this._winSettings.stateSettings,this._settings.impressionCapsService,this._settings.platformCappedLineItemRepo)}},{key:"_isBidBetter",value:function(bidA,bidB){return!(this._settings.adWinnerYo.getWinningYoScore(bidA.settings.id)<=this._settings.adWinnerYo.getWinningYoScore(bidB.settings.id))}},{key:"_winBid",value:function(bidSelectionResult,vastViewMode){var _this2=this;return new Promise(function(resolve,reject){var bid=bidSelectionResult.selectedBid,state=bidSelectionResult.state,bidLoader=new BidLoader_BidLoader(bid);_this2._loadingBids.add(bidLoader),_this2._settings.adBidPool.moveBidToLoading(bid),bidLoader.onSuccess.subscribe(function(){_this2._loadingBids.delete(bidLoader),_this2._settings.adBidPool.moveBidToReady(bid),resolve()}),bidLoader.onFailure.subscribe(function(reason){_this2._loadingBids.delete(bidLoader),_this2._settings.adBidPool.consumeBidLoading(bid),bidSelectionResult.selectedBid.settings.adManagerLineItem.bids.delete(bid),reject(reason)});var _state$adContainerSta=state.adContainerState.get(bid.settings.adManagerLineItem.protoLineItem.adType),width=_state$adContainerSta.width,height=_state$adContainerSta.height;bidLoader.loadBid(width,height,vastViewMode,_this2._settings.desiredBitRateForWins,state.soundValue),TrackersInformation_TrackersInformation.track(bid.settings.trackers.adWin,_this2._settings.adMacroReplacer,bid.settings.adManagerLineItem.protoLineItem,state),PrerollProblemLoggingUtils_PrerollProblemLoggingUtils.trackWin(_this2._settings.playerId,bid)})}},{key:"_handlePostbid",value:function(bid,date,reason,pgInfo){this._trackPostbid(bid,Date.now()-date,reason,pgInfo),this._settings.adWinnerYo.registerPostBid(bid.settings.id,bid.settings.adManagerLineItem.protoLineItem.creativeType,reason)}},{key:"_trackPostbid",value:function(bid,timeSpent,postbidReason,auctionInfo){var _a,_b,_c,_d,_e,adBreakState=(null===(_b=null===(_a=this._winSettings.stateSettings)||void 0===_a?void 0:_a.currentState)||void 0===_b?void 0:_b.adBreakState)||(null===(_d=null===(_c=this._winSettings.stateSettings)||void 0===_c?void 0:_c.predictedState)||void 0===_d?void 0:_d.adBreakState);TrackersInformation_TrackersInformation.track(bid.settings.trackers.adError,this._settings.adMacroReplacer,bid.settings.adManagerLineItem.protoLineItem,bid.settings.callingState),PrerollProblemLoggingUtils_PrerollProblemLoggingUtils.trackPostBid(this._settings.playerId);var postbid={adPodSlotPosition:adBreakState.adPodSlotIndex,adsourceType:bid.adSourceType,advertiserLineItemId:bid.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,publisherLineItemId:bid.settings.adManagerLineItem.protoLineItem.publisherLineItemId,error:postbidReason,loaded:!1,prebidJsBidderName:bid.settings.requestMetadata.data.prebidJsBidderName,vastMediaType:bid.adMediaType,syncedUser:bid.settings.requestMetadata.data.syncedUser,rtbSeatId:bid.settings.requestMetadata.data.rtbSeatId,rtbAdomain:bid.settings.requestMetadata.data.rtbAdomain,creativeId:bid.creativeId,timeSpent:timeSpent,dspId:bid.settings.requestMetadata.data.dspId,cnxBidId:bid.settings.requestMetadata.data.cnxBidId,winToAdLoadedTime:null===(_e=bid.settings.bidLifecycle)||void 0===_e?void 0:_e.winToAdLoadedTime};Object(TypeUtils.a)(auctionInfo)&&(postbid.auctionInformation=auctionInfo,postbid.auctionPostbidReason=this._settings.auctionInfoLogging.getGeneralPostbidReason(postbidReason)),this._settings.trackingService.addPostBid(postbid)}}]),AdWinnerController}();!function(TargetingUtils){function stringTargetingFiltering(stringRestriction,targetingModel){if(Object(ArrayUtils.h)(targetingModel.items)&&Array.isArray(stringRestriction)){var intersectionLength=Object(ArrayUtils.b)(stringRestriction,targetingModel.items).length;return targetingModel.choiceCriteria===protos.ProtoChoiceCriteriaEnum.Only?intersectionLength>0:0===intersectionLength}var needleFound=Object(ArrayUtils.g)(stringRestriction,targetingModel.items);return targetingModel.choiceCriteria===protos.ProtoChoiceCriteriaEnum.Only?needleFound:!needleFound}function isContextualTargetingValid(targetingCases,videoIndexes){return targetingCases.some(function(targetingCase){return function(targetingCase,videoIndexes){for(var _loop=function(i){var filter=targetingCase.filters[i],matchingVideoIndexesCount=videoIndexes.filter(function(videoIndex){return filter.items.includes(videoIndex)}).length;switch(filter.type){case protos.ProtoLineItemContextualTargetingEnum.IncludeAny:if(0===matchingVideoIndexesCount)return{v:!1};break;case protos.ProtoLineItemContextualTargetingEnum.IncludeAll:if(matchingVideoIndexesCount!==filter.items.length)return{v:!1};break;case protos.ProtoLineItemContextualTargetingEnum.ExcludeAny:if(matchingVideoIndexesCount>0)return{v:!1};break;case protos.ProtoLineItemContextualTargetingEnum.ExcludeAll:if(matchingVideoIndexesCount===filter.items.length)return{v:!1}}},i=0;i<targetingCase.filters.length;i++){var _ret=_loop(i);if("object"===typeof_default()(_ret))return _ret.v}return!0}(targetingCase,videoIndexes)})}TargetingUtils.isAllowedBySound=function(lineItem,state){return!lineItem.protoLineItem.sound||state.sound},TargetingUtils.isAllowedByViewability=function(lineItem,state){var viewability=state.adContainerState.get(lineItem.protoLineItem.adType).viewability;return!lineItem.protoLineItem.viewability||viewability},TargetingUtils.isAllowedByAdBreakType=function(lineItem,state){return!lineItem.protoLineItem.adBreakSettings||lineItem.protoLineItem.adBreakSettings.adBreakTargeting.some(function(adBreakTargeting){if(adBreakTargeting.adRollType===state.adBreakState.adBreakType)return function(adBreakType,isBreakInPod){switch(adBreakType){case protos.ProtoLineItemAdBreakTypeEnum.All:return!0;case protos.ProtoLineItemAdBreakTypeEnum.AdPod:return isBreakInPod;case protos.ProtoLineItemAdBreakTypeEnum.SingleAd:return!isBreakInPod}}(adBreakTargeting.adBreakTypeEnum,state.adBreakState.isAdPodBreak)})},TargetingUtils.isAllowedByMediaTargeting=function(lineItem,state){return!(lineItem.protoLineItem.mediaIdTargeting&&!stringTargetingFiltering(state.media.mediaId,lineItem.protoLineItem.mediaIdTargeting)||lineItem.protoLineItem.mediaKeywordsTargeting&&!stringTargetingFiltering(state.media.mediaKeywords,lineItem.protoLineItem.mediaKeywordsTargeting)||lineItem.protoLineItem.mediaLanguageTargeting&&!stringTargetingFiltering(state.media.mediaLanguage,lineItem.protoLineItem.mediaLanguageTargeting))},TargetingUtils.isAllowedByContextualTargeting=function(lineItem,state){var _lineItem$protoLineIt=lineItem.protoLineItem,advertiserContextualTargeting=_lineItem$protoLineIt.advertiserContextualTargeting,publisherContextualTargeting=_lineItem$protoLineIt.publisherContextualTargeting,videoIndexes=state.media.videoIndexes||[];return!(Object(ArrayUtils.h)(advertiserContextualTargeting)&&!isContextualTargetingValid(advertiserContextualTargeting,videoIndexes)||Object(ArrayUtils.h)(publisherContextualTargeting)&&!isContextualTargetingValid(publisherContextualTargeting,videoIndexes))},TargetingUtils.isAllowedByPlayerSizeTargeting=function(lineItem,state){var playerSizeTargetings=lineItem.protoLineItem.playerSizeTargetings,width=state.adContainerState.get(lineItem.protoLineItem.adType).width;return!Object(TypeUtils.f)(playerSizeTargetings)||!Object(TypeUtils.d)(width)||(playerSizeTargetings.sizeChoiceCriteria===protos.ProtoSizeChoiceCriteriaEnum.GreaterThan?!Object(TypeUtils.d)(playerSizeTargetings.minWidth)||width>=playerSizeTargetings.minWidth:playerSizeTargetings.sizeChoiceCriteria===protos.ProtoSizeChoiceCriteriaEnum.SmallerThan?!Object(TypeUtils.d)(playerSizeTargetings.maxWidth)||width<=playerSizeTargetings.maxWidth:playerSizeTargetings.sizeChoiceCriteria!==protos.ProtoSizeChoiceCriteriaEnum.Between||!Object(TypeUtils.d)(playerSizeTargetings.maxWidth)||!Object(TypeUtils.d)(playerSizeTargetings.minWidth)||width>=playerSizeTargetings.minWidth&&width<=playerSizeTargetings.maxWidth)},TargetingUtils.isAllowedByPodTargeting=function(lineItem,state){var _a,adPodTargeting=null===(_a=lineItem.protoLineItem.adBreakSettings)||void 0===_a?void 0:_a.adPodTargeting;if(!adPodTargeting)return!0;if(!state.adBreakState.isAdPodBreak)return!0;var nextSlotIndex=state.adBreakState.adPodSlotIndex,allowed=!0;switch(adPodTargeting.adSlotTargetingType){case protos.ProtoLineItemAdSlotTargetingTypeEnum.Interval:(nextSlotIndex<adPodTargeting.adSlotPositions[0]||nextSlotIndex>adPodTargeting.adSlotPositions[1])&&(allowed=!1);break;case protos.ProtoLineItemAdSlotTargetingTypeEnum.SpecificSlots:-1===adPodTargeting.adSlotPositions.indexOf(nextSlotIndex)&&(allowed=!1)}return adPodTargeting.targetingType===protos.ProtoLineItemTargetingTypeEnum.Except&&(allowed=!allowed),allowed},TargetingUtils.isAllowedRegardingDuration=function(adDuration,maxDurationLimit){return!adDuration||0===maxDurationLimit||adDuration<=maxDurationLimit},TargetingUtils.isAllowedRegardingSkippability=function(adDuration,adSkipMode,skipPlayerSettings){switch(skipPlayerSettings.adSkippability){case protos.ProtoPlayerAdSkippability.IfLongerThan:if(adSkipMode===protos.ProtoAdSkipMode.Never&&adDuration>skipPlayerSettings.adsMustBeSkippableIfLongerThan||adSkipMode===protos.ProtoAdSkipMode.IfLongerThan31Sec&&adDuration<MonetizationConfig.d&&adDuration>skipPlayerSettings.adsMustBeSkippableIfLongerThan)return!1;break;case protos.ProtoPlayerAdSkippability.Always:if(adSkipMode===protos.ProtoAdSkipMode.IfLongerThan31Sec&&adDuration&&adDuration<MonetizationConfig.d)return!1}return!0}}(TargetingUtils_TargetingUtils||(TargetingUtils_TargetingUtils={}));var ABaseAdYo_ABaseAdYo=function(){function ABaseAdYo(_yoScoreManager,_skipPlayerSettings){classCallCheck_default()(this,ABaseAdYo),this._yoScoreManager=_yoScoreManager,this._skipPlayerSettings=_skipPlayerSettings}return createClass_default()(ABaseAdYo,[{key:"getCallingYoScore",value:function(advertiserLineItemId){return this._yoScoreManager.getCallingYoScore(advertiserLineItemId)}},{key:"getWinningYoScore",value:function(bidId){return this._yoScoreManager.getWinningYoScore(bidId)}},{key:"getImpressionYoScore",value:function(bidId){return this._yoScoreManager.getImpressionYoScore(bidId)}},{key:"registerBiddingInformation",value:function(bidSettings){this._yoScoreManager.registerBiddingInformation(bidSettings)}},{key:"registerPreBid",value:function(bidId){this._yoScoreManager.registerPreBid(bidId)}},{key:"registerImpression",value:function(bidId,creativeType){this._yoScoreManager.registerImpression(bidId,creativeType)}},{key:"registerPostBid",value:function(bidId,creativeType,reason){this._yoScoreManager.registerPostBid(bidId,creativeType,reason)}},{key:"_isLineItemTargetingAllowed",value:function(lineItem,state){return TargetingUtils_TargetingUtils.isAllowedByViewability(lineItem,state)&&TargetingUtils_TargetingUtils.isAllowedBySound(lineItem,state)&&TargetingUtils_TargetingUtils.isAllowedByAdBreakType(lineItem,state)&&TargetingUtils_TargetingUtils.isAllowedByMediaTargeting(lineItem,state)&&TargetingUtils_TargetingUtils.isAllowedByPodTargeting(lineItem,state)&&TargetingUtils_TargetingUtils.isAllowedByContextualTargeting(lineItem,state)&&TargetingUtils_TargetingUtils.isAllowedByPlayerSizeTargeting(lineItem,state)}},{key:"_isDurationSessionMaxAllowed",value:function(bid,state){var adDuration=bid.getAdDuration(),adSkipMode=bid.settings.adManagerLineItem.protoLineItem.skipMode,maxDuration=state.adBreakState.sessionMaxAdDuration;return TargetingUtils_TargetingUtils.isAllowedRegardingDuration(adDuration,maxDuration)&&TargetingUtils_TargetingUtils.isAllowedRegardingSkippability(adDuration,adSkipMode,this._skipPlayerSettings)}},{key:"_isDurationRemainingAllowed",value:function(bid,state){var adDuration=bid.getAdDuration(),maxDuration=state.adBreakState.remainingAdDuration;return TargetingUtils_TargetingUtils.isAllowedRegardingDuration(adDuration,maxDuration)}},{key:"_isBidTargetingAllowed",value:function(bid,state,impressionCapService,platformCappedLineItemRepo){return!platformCappedLineItemRepo.isLineItemPlatformCapped(bid.settings.adManagerLineItem.protoLineItem)&&impressionCapService.canCall(bid.settings.adManagerLineItem,state.adOpportunity.id)&&this._isLineItemTargetingAllowed(bid.settings.adManagerLineItem,state)&&this._isDurationSessionMaxAllowed(bid,state)&&this._isDurationRemainingAllowed(bid,state)}}]),ABaseAdYo}();function AdCallerYo_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AdCallerYo_AdCallerYo=function(_ABaseAdYo){inherits_default()(AdCallerYo,_ABaseAdYo);var _super=AdCallerYo_createSuper(AdCallerYo);function AdCallerYo(){return classCallCheck_default()(this,AdCallerYo),_super.apply(this,arguments)}return createClass_default()(AdCallerYo,[{key:"getBestCallable",value:function(lineItemList,callerState){return this._getCallable(lineItemList,callerState.currentState||callerState.predictedState)}},{key:"isBidTargetingAllowed",value:function(bid,callingState,impressionCapService,platformCappedLineItemRepo){return this._isBidTargetingAllowed(bid,callingState,impressionCapService,platformCappedLineItemRepo)}},{key:"isBidTargetingAllowedEverInSession",value:function(bid,callingState){return this._isDurationSessionMaxAllowed(bid,callingState)}},{key:"_getCallable",value:function(lineItemList,callingState){if(callingState){var callableLineItems=this._filterCallableLineItems(lineItemList,callingState),bestLineItem=this._getBestLineItem(callableLineItems);return bestLineItem?{state:callingState,lineItemList:this._aggregateLineItems(bestLineItem,callableLineItems)}:void 0}}},{key:"_getBestLineItem",value:function(lineItemList){var selectionList=lineItemList;return lineItemList.some(function(lineItem){return shouldAggregateCreativeType(lineItem.protoLineItem.creativeType)})&&(selectionList=selectionList.filter(function(lineItem){return shouldAggregateCreativeType(lineItem.protoLineItem.creativeType)})),this._sortBasedOnYoScore(selectionList)[0]}},{key:"_sortBasedOnYoScore",value:function(){var _this=this;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).sort(function(a,b){return _this.getCallingYoScore(b.protoLineItem.advertiserLineItemId)-_this.getCallingYoScore(a.protoLineItem.advertiserLineItemId)})}},{key:"_filterCallableLineItems",value:function(lineItemList,callingState){var _this2=this;return lineItemList.filter(function(lineItem){return _this2._isLineItemTargetingAllowed(lineItem,callingState)})}},{key:"_aggregateLineItems",value:function(targetLineItem,lineItemList){var creativeType=targetLineItem.protoLineItem.creativeType;return shouldAggregateCreativeType(creativeType)?this._sortBasedOnYoScore(lineItemList.filter(function(lineItem){return creativeType===lineItem.protoLineItem.creativeType})):[targetLineItem]}}]),AdCallerYo}(ABaseAdYo_ABaseAdYo);function AdImpressionerYo_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AdImpressionerYo_AdImpressionerYo=function(_ABaseAdYo){inherits_default()(AdImpressionerYo,_ABaseAdYo);var _super=AdImpressionerYo_createSuper(AdImpressionerYo);function AdImpressionerYo(){return classCallCheck_default()(this,AdImpressionerYo),_super.apply(this,arguments)}return createClass_default()(AdImpressionerYo,[{key:"getBestBid",value:function(bidList,state){return this._getBestBid(bidList,state)}},{key:"getBetterBid",value:function(bidA,bidB){return this.getImpressionYoScore(bidA.settings.id)>this.getImpressionYoScore(bidB.settings.id)?bidA:bidB}},{key:"_getBestBid",value:function(bidList,state){var _this=this;return toConsumableArray_default()(bidList).sort(function(a,b){return _this.getImpressionYoScore(b.settings.id)-_this.getImpressionYoScore(a.settings.id)})[0]}}]),AdImpressionerYo}(ABaseAdYo_ABaseAdYo);function AdWinnerYo_createForOfIteratorHelper(o){if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(o=function(o,minLen){if(!o)return;if("string"==typeof o)return AdWinnerYo_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AdWinnerYo_arrayLikeToArray(o,minLen)}(o))){var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var it,err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function AdWinnerYo_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AdWinnerYo_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AdWinnerYo_AdWinnerYo=function(_ABaseAdYo){inherits_default()(AdWinnerYo,_ABaseAdYo);var _super=AdWinnerYo_createSuper(AdWinnerYo);function AdWinnerYo(){var _this;return classCallCheck_default()(this,AdWinnerYo),(_this=_super.apply(this,arguments))._getBidListSplitByTargetingAllowed=function(bidList,state,impressionCapsService,platformCappedLineItemRepo){var _step,bidsAllowedByTargeting=[],bidsNotAllowedByTargeting=[],_iterator=AdWinnerYo_createForOfIteratorHelper(bidList);try{for(_iterator.s();!(_step=_iterator.n()).done;){var bid=_step.value;_this._isBidTargetingAllowed(bid,state.currentState||state.predictedState,impressionCapsService,platformCappedLineItemRepo)?bidsAllowedByTargeting.push(bid):bidsNotAllowedByTargeting.push(bid)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return{allowedBidList:bidsAllowedByTargeting,notAllowedBidList:bidsNotAllowedByTargeting}},_this}return createClass_default()(AdWinnerYo,[{key:"selectBestBid",value:function(bidList,state,impressionCapsService,platformCappedLineItemRepo){var _this2=this,bidListSplitByTargetingAllowed=this._getBidListSplitByTargetingAllowed(bidList,state,impressionCapsService,platformCappedLineItemRepo),allowedBidList=bidListSplitByTargetingAllowed.allowedBidList,notAllowedBidList=bidListSplitByTargetingAllowed.notAllowedBidList,adManagerState=state.currentState||state.predictedState,bestWinnableBid=this._getBestWinnableBid(allowedBidList),bidsNotAllowedByTargeting=notAllowedBidList.map(function(bidNotAllowedByTargeting){return{bid:bidNotAllowedByTargeting,lossReason:_this2._getBidLossTargetingReason(bidNotAllowedByTargeting,adManagerState)}}),bidsThatLooseTheAuctionDueToCompetitorPririty=allowedBidList.filter(function(bid){return bid!==bestWinnableBid}).map(function(bid){return{bid:bid,lossReason:protos.ProtoAuctionLossReasonEnum.CompetitorPriority}});return{state:adManagerState,selectedBid:bestWinnableBid,unselectedBidList:[].concat(toConsumableArray_default()(bidsNotAllowedByTargeting),toConsumableArray_default()(bidsThatLooseTheAuctionDueToCompetitorPririty))}}},{key:"isBetterBid",value:function(bidA,bidB){return this.getWinningYoScore(bidA.settings.id)>this.getWinningYoScore(bidB.settings.id)}},{key:"_getBestWinnableBid",value:function(winnableBidList){var _this3=this;if(Object(ArrayUtils.h)(winnableBidList))return toConsumableArray_default()(winnableBidList).sort(function(a,b){return _this3.getWinningYoScore(b.settings.id)-_this3.getWinningYoScore(a.settings.id)})[0]}},{key:"_getBidLossTargetingReason",value:function(bidNotAllowedByTargeting,state){return this._isDurationRemainingAllowed(bidNotAllowedByTargeting,state)?protos.ProtoAuctionLossReasonEnum.AdOpportunityEnd:protos.ProtoAuctionLossReasonEnum.TargetingMismatch}}]),AdWinnerYo}(ABaseAdYo_ABaseAdYo),AuctionManager_AuctionManager=function(){function AuctionManager(_settings){var _this=this;classCallCheck_default()(this,AuctionManager),this._settings=_settings,this._onAuctionEnd=new Subject.a,this._locked=!1,this._cancelled=!1,this._timeoutId=null,this._auctionTimeoutReached=!1,this._sortCallingLineItemsByYoScore=function(a,b){return _this._settings.yoScoreManager.getCallingYoScore(b.protoLineItem.advertiserLineItemId)-_this._settings.yoScoreManager.getCallingYoScore(a.protoLineItem.advertiserLineItemId)},this._locked=_settings.locked,_settings.adBidPool.onBid.subscribe(function(){_this._locked||_this._dispatchIfBestFound()})}return createClass_default()(AuctionManager,[{key:"startAuction",value:function(timeoutLength){var _this2=this;this._cancelled=!1,0!==timeoutLength||this._locked||null!==this._timeoutId?this._dispatchIfBestFound()||(this._auctionTimeoutReached=!1,this._clearTimeout(),this._timeoutId=setTimeout(function(){_this2._auctionTimeoutReached=!0,_this2._locked||_this2._onAuctionEnd.next()},timeoutLength)):this._onAuctionEnd.next()}},{key:"lock",value:function(){this._locked=!0}},{key:"unlock",value:function(){this._locked=!1,this._cancelled||(this._auctionTimeoutReached?this._onAuctionEnd.next():this._dispatchIfBestFound())}},{key:"cancel",value:function(){this._cancelled=!0,this._clearTimeout()}},{key:"_clearTimeout",value:function(){clearTimeout(this._timeoutId),this._timeoutId=null}},{key:"_dispatchIfBestFound",value:function(){var _a,_this3=this;if(this._cancelled)return!1;this._settings.adBidPool.bids.sort(function(a,b){return _this3._settings.yoScoreManager.getWinningYoScore(b.settings.id)-_this3._settings.yoScoreManager.getWinningYoScore(a.settings.id)});var bestBid=this._settings.adBidPool.bids[0];if(!bestBid)return!1;this._settings.adBidPool.callingLineItems.sort(this._sortCallingLineItemsByYoScore);var bestCalling=this._settings.adBidPool.callingLineItems[0],winningYoScore=this._settings.yoScoreManager.getWinningYoScore(bestBid.settings.id),callingYoScore=this._settings.yoScoreManager.getCallingYoScore(null===(_a=bestCalling)||void 0===_a?void 0:_a.protoLineItem.advertiserLineItemId);return(!bestCalling||winningYoScore>=callingYoScore)&&(this._onAuctionEnd.next(),this._clearTimeout(),!0)}},{key:"onAuctionEnd",get:function(){return this._onAuctionEnd.asObservable()}}]),AuctionManager}(),AdManagerLineItem_AdManagerLineItem=function AdManagerLineItem(protoLineItem){classCallCheck_default()(this,AdManagerLineItem),this.protoLineItem=protoLineItem,this.allowedSlots=[],this.bids=new Set,this.callers=new Set,this.aggregators=new Set},SLOTS_CONTAINER_CLASS="cnx-ad-bid-slot",SLOT_CLASS="cnx-ad-slot",VIDEO_SLOT_CLASS="cnx-ad-video-slot",AdSlotContainer_AdSlotContainer=function(){function AdSlotContainer(parentContainer,_globalDomUtilsService){classCallCheck_default()(this,AdSlotContainer),this.parentContainer=parentContainer,this._globalDomUtilsService=_globalDomUtilsService,this.isImaSlot=!1,this.slotsContainer=this._globalDomUtilsService.createElementByString('<div class= "'.concat(SLOTS_CONTAINER_CLASS,'"></div>')),this.adSlot=this._globalDomUtilsService.createElementByString('<div class="'.concat(SLOT_CLASS,'"></div>')),this.videoSlot=this._globalDomUtilsService.createElementByString('<video class="'.concat(SLOT_CLASS," ").concat(VIDEO_SLOT_CLASS,'"></video>')),this.videoSlot.setAttribute("playsinline",""),this.videoSlot.setAttribute("webkit-playsinline",""),this.slotsContainer.appendChild(this.videoSlot),this.slotsContainer.appendChild(this.adSlot),this.parentContainer.appendChild(this.slotsContainer)}return createClass_default()(AdSlotContainer,[{key:"destroy",value:function(){this.parentContainer.removeChild(this.slotsContainer)}},{key:"sanitize",value:function(){}}]),AdSlotContainer}();function AdSlotContainerIma_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var PrefetchStateTypeEnum,AdSlotContainerIma_AdSlotContainerIma=function(_AdSlotContainer){inherits_default()(AdSlotContainerIma,_AdSlotContainer);var _super=AdSlotContainerIma_createSuper(AdSlotContainerIma);function AdSlotContainerIma(){var _this;return classCallCheck_default()(this,AdSlotContainerIma),(_this=_super.apply(this,arguments)).isImaSlot=!0,_this._imaDependenciesLoaded=!1,_this._imaDependencies={imaAdDisplayContainer:void 0,imaAdsLoader:void 0,imaSdk:void 0},_this}return createClass_default()(AdSlotContainerIma,[{key:"fetchImaDependencies",value:function(){var _this2=this;return ImaSdkFetchService_ImaSdkFetchService.fetchImaSdk(window,!0).then(function(imaSdk){return _this2._getImaDependencies(imaSdk)})}},{key:"destroy",value:function(){this._imaDependencies.imaAdsLoader&&this._imaDependencies.imaAdsLoader.destroy(),this._imaDependencies.imaAdDisplayContainer&&this._imaDependencies.imaAdDisplayContainer.destroy(),get_default()(getPrototypeOf_default()(AdSlotContainerIma.prototype),"destroy",this).call(this)}},{key:"sanitize",value:function(){this._imaDependencies.imaAdsLoader.contentComplete(),get_default()(getPrototypeOf_default()(AdSlotContainerIma.prototype),"sanitize",this).call(this)}},{key:"_getImaDependencies",value:function(imaSdk){if(this._imaDependenciesLoaded)return this._imaDependencies;imaSdk.settings.setDisableCustomPlaybackForIOS10Plus(!0);var imaDisplayContainer=this._constructImaAdDisplayContainer(imaSdk),imaAdsLoader=this._constructImaAdsLoader(imaSdk,imaDisplayContainer);return this._imaDependencies={imaSdk:imaSdk,imaAdDisplayContainer:imaDisplayContainer,imaAdsLoader:imaAdsLoader},this._imaDependenciesLoaded=!0,this._imaDependencies}},{key:"_constructImaAdDisplayContainer",value:function(imaSdk){var imaDisplayContainer=new imaSdk.AdDisplayContainer(this.adSlot,this.videoSlot);return imaDisplayContainer.initialize(),imaDisplayContainer}},{key:"_constructImaAdsLoader",value:function(imaSdk,imaDisplayContainer){var imaAdsLoader=new imaSdk.AdsLoader(imaDisplayContainer);return imaAdsLoader.getSettings().setVpaidMode(imaSdk.ImaSdkSettings.VpaidMode.INSECURE),imaAdsLoader}}]),AdSlotContainerIma}(AdSlotContainer_AdSlotContainer),IMA_PRELOAD_SLOT_COUNT=3,AdSlotContainerRecycler_AdSlotContainerRecycler=function(){function AdSlotContainerRecycler(settings){classCallCheck_default()(this,AdSlotContainerRecycler),this.settings=settings,this._freeSlots=new Set,this._usedSlots=new Set,this._loggingPoints=[10,15,20],this._currentLoggingPointIndex=0,ImaSdkFetchService_ImaSdkFetchService.preloadImaSdk(window);for(var i=1;i<=IMA_PRELOAD_SLOT_COUNT;i++){var imaSlot=new AdSlotContainerIma_AdSlotContainerIma(settings.slot,this.settings.globalDomUtilsService);imaSlot.fetchImaDependencies(),this._freeSlots.add(imaSlot)}}return createClass_default()(AdSlotContainerRecycler,[{key:"requestAdSlot",value:function(mainAdContainer){var slot=new AdSlotContainer_AdSlotContainer(mainAdContainer,this.settings.globalDomUtilsService);return this._markSlotAsUsed(slot),this._checkToLogAdSlotUsage(),slot}},{key:"requestAdSlotIma",value:function(mainAdContainer){var slot=this._getFreeImaSlot();return slot||(slot=new AdSlotContainerIma_AdSlotContainerIma(mainAdContainer,this.settings.globalDomUtilsService)),this._markSlotAsUsed(slot),this._checkToLogAdSlotUsage(),slot}},{key:"destroyAdSlot",value:function(adSlot){this._usedSlots.delete(adSlot),adSlot.destroy()}},{key:"recycleAdSlot",value:function(adSlot){this._usedSlots.delete(adSlot),this._isImaSlot(adSlot)?(adSlot.sanitize(),this._freeSlots.add(adSlot)):this.destroyAdSlot(adSlot)}},{key:"_isImaSlot",value:function(adSlot){return adSlot.isImaSlot}},{key:"_getFreeImaSlot",value:function(){var _this=this,imaSlot=null;return this._freeSlots.forEach(function(adSlot){_this._isImaSlot(adSlot)&&null===imaSlot&&(imaSlot=adSlot)}),imaSlot}},{key:"_markSlotAsUsed",value:function(adSlot){this._freeSlots.delete(adSlot),this._usedSlots.add(adSlot)}},{key:"_checkToLogAdSlotUsage",value:function(){var numberOfSlotsInDom=this._freeSlots.size+this._usedSlots.size;numberOfSlotsInDom===this._loggingPoints[this._currentLoggingPointIndex]&&(this._sendAdSlotUsageLogging(this._loggingPoints[this._currentLoggingPointIndex]),numberOfSlotsInDom===this._loggingPoints[this._loggingPoints.length-1]&&this._loggingPoints.push(this._loggingPoints[this._loggingPoints.length-1]+20),this._currentLoggingPointIndex++)}},{key:"_sendAdSlotUsageLogging",value:function(count){Object(Logging.a)({message:"AdSlotContainerRecycler_slotcount",exception:"".concat(count),callStack:"",level:protos.ProtoLoggingLevelEnum.INFO,throttle:20,sendMaxLog:!0})}}]),AdSlotContainerRecycler}(),YoScoreManager_YoScoreManager=function(){function YoScoreManager(lineItemList,_exploration){classCallCheck_default()(this,YoScoreManager),this._exploration=_exploration,this._yoScoreCache=this._getYoScoreLineItemsMap(lineItemList)}return createClass_default()(YoScoreManager,[{key:"registerBiddingInformation",value:function(bidSettings){var cpm=getBidCpmBasedOnCreativeType(bidSettings),priority=bidSettings.priority,successRate=bidSettings.successRate,lineItemId=bidSettings.lineItemId,bidId=bidSettings.bidId,yoScore=0;yoScore=shouldAggregateCreativeType(bidSettings.creativeType)?calculateYoScore({cpm:cpm,priority:priority,successRate:successRate},this._exploration):this.getCallingYoScore(bidSettings.lineItemId),this._updateWinningYoScore(lineItemId,bidId,yoScore)}},{key:"registerPreBid",value:function(bidId){this._unregisterBiddingInformation(bidId)}},{key:"registerImpression",value:function(bidId,creativeType){this._unregisterBiddingInformation(bidId),shouldAggregateCreativeType(creativeType)||this._recompenseBidYoScore(bidId)}},{key:"registerPostBid",value:function(bidId,creativeType,reason){this._unregisterBiddingInformation(bidId),shouldAggregateCreativeType(creativeType)||reason===MonetisationConfig.c.Cancelled||this._penalizeBidYoScore(bidId)}},{key:"getCallingYoScore",value:function(lineItemId){var lineItemData=this._getLineItemData(lineItemId);return lineItemData?lineItemData.yoScore:0}},{key:"getWinningYoScore",value:function(bidId){var lineItemData=this._getLineItemDataByBidId(bidId);return lineItemData?lineItemData.bidMap.get(bidId):(Object(Logging.a)({message:"YoScoreManager_getWinningYoScore_error",exception:"bid was not yet registered: ".concat(bidId),level:protos.ProtoLoggingLevelEnum.WARNING}),0)}},{key:"getImpressionYoScore",value:function(bidId){return this.getWinningYoScore(bidId)}},{key:"_penalizeBidYoScore",value:function(bidId){var lineItemData=this._getLineItemDataByBidId(bidId);if(lineItemData){var yoScore,realScore,newYoScore=(yoScore=lineItemData.yoScore,(realScore=getRealYoScore(yoScore))[1]+realScore[0]*MonetizationConfig.g);this._updateCallingYoScore(lineItemData,newYoScore)}}},{key:"_recompenseBidYoScore",value:function(bidId){var lineItemData=this._getLineItemDataByBidId(bidId);if(lineItemData){var yoScore,realScore,newYoScore=(yoScore=lineItemData.yoScore,(realScore=getRealYoScore(yoScore))[1]+realScore[0]*MonetizationConfig.h);this._updateCallingYoScore(lineItemData,newYoScore)}}},{key:"_updateCallingYoScore",value:function(lineItemData,yoScore){lineItemData&&(lineItemData.yoScore=yoScore)}},{key:"_updateWinningYoScore",value:function(lineItemId,bidId,yoScore){var lineItemData=this._getLineItemData(lineItemId);if(lineItemData){var yoScoreBasedOnLineItem=this._getBidYoScoreByLineItemData(lineItemData);!this._exploration||lineItemData.bidMap.has(bidId)||-1===yoScoreBasedOnLineItem?this._canUpdateYoScore(lineItemData,bidId)&&lineItemData.bidMap.set(bidId,yoScore):lineItemData.bidMap.set(bidId,yoScoreBasedOnLineItem)}}},{key:"_getBidYoScoreByLineItemData",value:function(lineItemData){var bidYoScoreList=toConsumableArray_default()(lineItemData.bidMap.values());return Object(ArrayUtils.h)(bidYoScoreList)?bidYoScoreList[0]:-1}},{key:"_canUpdateYoScore",value:function(lineItemData,bidId){return!this._exploration||!lineItemData.bidMap.has(bidId)}},{key:"_getYoScoreLineItemsMap",value:function(lineItemList){var _this=this;return lineItemList.map(function(lineItem){var cpm=lineItem.floorPrice,priority=lineItem.lineItemPriority,successRate=lineItem.successRate;return{lineItemId:lineItem.advertiserLineItemId,yoScore:shouldAggregateCreativeType(lineItem.creativeType)?Math.random():calculateYoScore({cpm:cpm,priority:priority,successRate:successRate},_this._exploration),bidMap:new Map}})}},{key:"_getLineItemData",value:function(lineItemId){return this._yoScoreCache.find(function(item){return item.lineItemId===lineItemId})}},{key:"_getLineItemDataByBidId",value:function(bidId){return this._yoScoreCache.find(function(item){return item.bidMap.has(bidId)})}},{key:"_unregisterBiddingInformation",value:function(bidId){if(bidId){var lineItemData=this._getLineItemDataByBidId(bidId);lineItemData&&0!==lineItemData.bidMap.size&&lineItemData.bidMap.delete(bidId)}}}]),YoScoreManager}(),AuctionInfoLogging_AuctionInfoLogging=function(){function AuctionInfoLogging(_adBidPool,_trackingService){classCallCheck_default()(this,AuctionInfoLogging),this._adBidPool=_adBidPool,this._trackingService=_trackingService,this._winBidSnapshotsMap=new Map}return createClass_default()(AuctionInfoLogging,[{key:"bidIsNotWinnableEverInSession",value:function(bid){if(this._shouldLogBid(bid)){var allBidPricesSortedFromBidPool=[].concat(toConsumableArray_default()(this._getSortedAllBidPricesFromBidPool()),[this._getBidPrice(bid)]).sort(function(a,b){return b-a}),auctionInformation=this._getAuctionInformationBySortedPrices(allBidPricesSortedFromBidPool);this._trackAuctionInfo(bid.settings.requestMetadata.data.cnxBidId,auctionInformation,protos.ProtoAuctionLossReasonEnum.TargetingMismatch)}}},{key:"newBidAdded",value:function(bid,bidSelectionResult){this._shouldLogBid(bid)&&(bidSelectionResult.selectedBid?bidSelectionResult.selectedBid!==bid?this._logAuctionLost(bid,bidSelectionResult):this._logAuctionWin(bid):this._logAuctionLost(bid,bidSelectionResult))}},{key:"winBid",value:function(bid){if(this._shouldLogBid(bid)){var allBidPricesSortedFromBidPool=this._getSortedAllBidPricesFromBidPool(),auctionInformation=this._getAuctionInformationBySortedPrices(allBidPricesSortedFromBidPool);this._winBidSnapshotsMap.set(bid,auctionInformation)}}},{key:"onPostBid",value:function(winBid){return this._winBidConsumed(winBid)}},{key:"onImpression",value:function(winBid){return this._winBidConsumed(winBid)}},{key:"_shouldLogBid",value:function(bid){return bid.settings.requestMetadata.data.logAuctionInformation}},{key:"_logAuctionWin",value:function(bid){var cnxBidId=bid.settings.requestMetadata.data.cnxBidId,allBidPricesSortedFromBidPool=this._getSortedAllBidPricesFromBidPool(),auctionInformation=this._getAuctionInformationBySortedPrices(allBidPricesSortedFromBidPool);this._trackAuctionInfo(cnxBidId,auctionInformation,protos.ProtoAuctionLossReasonEnum.CompetitorPriority)}},{key:"_winBidConsumed",value:function(winBid){var auctionInformation=this._getAuctionInformationForBidInWin(winBid);return this._winBidFinished(winBid),auctionInformation}},{key:"_logAuctionLost",value:function(bid,bidSelectionResult){var _a,_b,_c,_d,cnxBidId=bid.settings.requestMetadata.data.cnxBidId,allBidPricesSortedFromBidPool=this._getSortedAllBidPricesFromBidPool(),auctionLossReason=this._getLossReasonForBid(bid,bidSelectionResult),auctionInformation=this._getAuctionInformationBySortedPrices(allBidPricesSortedFromBidPool);Object(TypeUtils.a)(auctionLossReason)?this._trackAuctionInfo(cnxBidId,auctionInformation,auctionLossReason):this._logFatalMessage("AdManager_AuctionInfoLogging_lossReason_cannot_be_found",bid.settings.requestMetadata.data.cnxBidId,null===(_d=null===(_c=null===(_b=null===(_a=bidSelectionResult.selectedBid)||void 0===_a?void 0:_a.settings)||void 0===_b?void 0:_b.requestMetadata)||void 0===_c?void 0:_c.data)||void 0===_d?void 0:_d.cnxBidId)}},{key:"_getAuctionInformationForBidInWin",value:function(bid){if(this._winBidSnapshotsMap.has(bid))return this._winBidSnapshotsMap.get(bid);this._shouldLogBid(bid)&&this._logFatalMessage("AdManager_AuctionInfoLogging_cannot_find_win_bid_snapshot",bid.settings.requestMetadata.data.cnxBidId)}},{key:"_winBidFinished",value:function(bid){this._winBidSnapshotsMap.has(bid)&&this._winBidSnapshotsMap.delete(bid)}},{key:"_getLossReasonForBid",value:function(bid,bidSelectionResult){var _a;return null===(_a=bidSelectionResult.unselectedBidList.find(function(bidThatLostTheAuction){return bidThatLostTheAuction.bid===bid}))||void 0===_a?void 0:_a.lossReason}},{key:"getGeneralPostbidReason",value:function(postbidError){switch(postbidError){case MonetisationConfig.c.ImaScriptFailure:case MonetisationConfig.c.ImaObjectNotFound:case MonetisationConfig.c.ImaManagerInit:case MonetisationConfig.c.ImaInitSdkError:case MonetisationConfig.c.AdxOverlayGptScriptLoad:case MonetisationConfig.c.DisplayIntegratorIframeLoad:return protos.ProtoAuctionPostbidReasonEnum.SDKFailure;case MonetisationConfig.c.VastUnsupportedMedia:case MonetisationConfig.c.CnxMediaSrcNotSupported:return protos.ProtoAuctionPostbidReasonEnum.UnsupportedMedia;case MonetisationConfig.c.DomainBlocked:return protos.ProtoAuctionPostbidReasonEnum.TargetingMismatch;case MonetisationConfig.c.AdaptorInitAdError:case MonetisationConfig.c.AdaptorStartAdError:case MonetisationConfig.c.WrapperInitAdError:case MonetisationConfig.c.WrapperStartAdError:return protos.ProtoAuctionPostbidReasonEnum.TargetingMismatch;default:return protos.ProtoAuctionPostbidReasonEnum.CreativeError}}},{key:"_getSortedAllBidPricesFromBidPool",value:function(){var _this=this;return this._adBidPool.getAllBids().map(function(bid){return _this._getBidPrice(bid)}).sort(function(a,b){return b-a})}},{key:"_getBidPrice",value:function(bid){switch(bid.settings.adManagerLineItem.protoLineItem.creativeType){case protos.ProtoCreativeTypeEnum.Rtb:case protos.ProtoCreativeTypeEnum.Tam:case protos.ProtoCreativeTypeEnum.TamDeal:return decodeObfuscatedBidPrice(bid.settings.obfuscatedPrice);case protos.ProtoCreativeTypeEnum.HeaderBidder:return bid.settings.cpm;default:return bid.settings.adManagerLineItem.protoLineItem.floorPrice||bid.settings.adManagerLineItem.protoLineItem.customCpm}}},{key:"_getAuctionInformationBySortedPrices",value:function(allBidPricesSortedFromBidPool){var highestObfuscatedBidPrice=allBidPricesSortedFromBidPool[0]?encodeBidPrice(allBidPricesSortedFromBidPool[0]):void 0,secondHighestObfuscatedBidPrice=allBidPricesSortedFromBidPool[1]?encodeBidPrice(allBidPricesSortedFromBidPool[1]):void 0;return highestObfuscatedBidPrice||this._logFatalMessage("AdManager_AuctionInfoLogging_highestBidPrice_missing","".concat(highestObfuscatedBidPrice)),{bidDensity:allBidPricesSortedFromBidPool.length,highestObfuscatedBidPrice:highestObfuscatedBidPrice,secondHighestObfuscatedBidPrice:secondHighestObfuscatedBidPrice}}},{key:"_trackAuctionInfo",value:function(cnxBidId,auctionInformation,auctionLossReason){this._trackingService.trackAuctionInfoForBid({cnxBidId:cnxBidId,auctionInformation:auctionInformation,auctionLossReason:auctionLossReason})}},{key:"_logFatalMessage",value:function(message){var callStack=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",exception=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object(Logging.a)({message:message,level:protos.ProtoLoggingLevelEnum.FATAL,throttle:5,callStack:callStack,exception:exception})}}]),AuctionInfoLogging}();!function(PrefetchStateTypeEnum){PrefetchStateTypeEnum[PrefetchStateTypeEnum.NoPrefetch=0]="NoPrefetch",PrefetchStateTypeEnum[PrefetchStateTypeEnum.StartSessionPrefetch=1]="StartSessionPrefetch",PrefetchStateTypeEnum[PrefetchStateTypeEnum.MidSessionPrefetch=2]="MidSessionPrefetch"}(PrefetchStateTypeEnum||(PrefetchStateTypeEnum={}));var _AdSlotMatchingTable,MAX_WINS_DEFAULT=-1,DEFAULT_DESIRED_BITRATE=1,REMOVE_BIDS_DEFAULT=!1,AdManager_AdManager=function(){function AdManager(_settings){var _this=this;classCallCheck_default()(this,AdManager),this._settings=_settings,this._impressionsAllowed=!1,this._adFetchingAllowed=!1,this._subscriptions=[],this._currentAd=null,this._currentAdInImpression=!1,this._onVpaidEvent=new Subject.a,this._onImpressionRevenueEvent=new Subject.a,this._predictMode=!1,this._platformCappedLineItemRepository=new PlatformCappedLineItemRepository_PlatformCappedLineItemRepository,this._adPauser=new AdPauser_AdPauser,this._settings.app.services.TrackingService.addPlatformCappedLineItemSubscriber(this),this._settings.app.services.TrackingService.setImpressionRevenueSubscriber(this),this._settings.app.services.TrackingService.startBidRequests();var lineItems=this._settings.lineItemList.map(function(lineItem){return new AdManagerLineItem_AdManagerLineItem(lineItem)}),yoScoreManager=new YoScoreManager_YoScoreManager(this._settings.lineItemList,this._settings.app.config.explorationMode);this._triggerMonetisationTimer=new IntervalService_IntervalService,this._impressionCapsService=new ImpressionCapsValidationService_ImpressionCapsValidationService,this._requestCapsService=new RequestCapsValidationService_RequestCapsValidationService,this._timeBetweenRequestsService=new TimeBetweenRequestsService_TimeBetweenRequestsValidationService,this._adContainer=new AdContainer_AdContainer(this._settings.adContainerMap,this._settings.app.services.ResizeObserver,this._settings.app.services.ViewabilityService,MonetizationConfig.e);var adSlotContainerRecycler=new AdSlotContainerRecycler_AdSlotContainerRecycler({globalDomUtilsService:this._settings.app.services.GlobalDomUtilsService,recycleAdSlots:!0,slot:this._adContainer.getContainerMap().get(protos.ProtoAdType.Video)});this._adBidPool=new AdBidPool_AdBidPool,this._auctionInfoLogging=new AuctionInfoLogging_AuctionInfoLogging(this._adBidPool,this._settings.app.services.TrackingService),this._auctionManager=new AuctionManager_AuctionManager({adBidPool:this._adBidPool,locked:!0,yoScoreManager:yoScoreManager}),this._adRequestGatekeeper=new BidRequestGatekeeper_AdRequestGatekeeper,this._adMacroReplacer=new AdMacroReplacer_AdMacroReplacer(this._settings.app.services.MacrosService,this._settings.app.services.UserManagerService),this._adCallerController=new AdCallerController_AdCallerController({adBidPool:this._adBidPool,adCallerYo:new AdCallerYo_AdCallerYo(yoScoreManager,this._settings.skipPlayerSettings),auctionInfoLogging:this._auctionInfoLogging,adContainerMap:this._adContainer.getContainerMap(),adMacroReplacer:this._adMacroReplacer,amazonSlotId:this._settings.amazonTamSlotId,app:this._settings.app,isOutstream:this._settings.outstream,lineItemList:lineItems,schainSettings:this._settings.pbjsSchainSettings,skipAdSettings:this._settings.skipPlayerSettings,trackingService:this._settings.app.services.TrackingService,lineItemServices:{impressionCapsService:this._impressionCapsService,lineItemServicesTimer:this._triggerMonetisationTimer,requestCapsService:this._requestCapsService,timeBetweenRequestsService:this._timeBetweenRequestsService},adRequestGatekeeper:this._adRequestGatekeeper,platformCappedLineItemRepo:this._platformCappedLineItemRepository,adEnforcer:new AdEnforcerController_AdEnforcerController(this._settings.app.config.isMobile,Object(DomUtils.t)(this._settings.adContainerMap.get(protos.ProtoAdType.Video)),this._settings.disableScrollHijackEnforcement),pauseAdWhenFinished:this._settings.pauseAdWhenFinished,loopAdWhenFinished:this._settings.loopAdWhenFinished,os:this._settings.app.config.os.os,adSlotContainerRecycler:adSlotContainerRecycler}),this._adWinnerController=new AdWinnerController_AdWinnerController({adBidPool:this._adBidPool,adWinnerYo:new AdWinnerYo_AdWinnerYo(yoScoreManager,this._settings.skipPlayerSettings),auctionInfoLogging:this._auctionInfoLogging,desiredBitRateForWins:DEFAULT_DESIRED_BITRATE,maxNumberOfWins:MAX_WINS_DEFAULT,trackingService:this._settings.app.services.TrackingService,impressionCapsService:this._impressionCapsService,impressionCapsTimer:this._triggerMonetisationTimer,platformCappedLineItemRepo:this._platformCappedLineItemRepository,adMacroReplacer:this._adMacroReplacer,playerId:this._settings.app.config.playerId}),this._adImpressionerController=new AdImpressionerController_AdImpressionerController({adBidPool:this._adBidPool,adContainer:this._adContainer,adImpressionerYo:new AdImpressionerYo_AdImpressionerYo(yoScoreManager,this._settings.skipPlayerSettings),auctionInfoLogging:this._auctionInfoLogging,impressionCapsService:this._impressionCapsService,impressionCapsTimer:this._triggerMonetisationTimer,requestCapsService:this._requestCapsService,playerSkippability:this._settings.skipPlayerSettings.adSkippability,removeBidIfHigherYoScore:REMOVE_BIDS_DEFAULT,trackingService:this._settings.app.services.TrackingService,adRequestGatekeeper:this._adRequestGatekeeper,pauseAdWhenFinished:this._settings.pauseAdWhenFinished,loopAdWhenFinished:this._settings.loopAdWhenFinished,adMacroReplacer:this._adMacroReplacer,explorationMode:this._settings.app.config.explorationMode,playerId:this._settings.app.config.playerId}),this._subscriptions.push(this._auctionManager.onAuctionEnd.subscribe(function(){_this._impressionsAllowed=!0,_this._fetchImpressions()}),this._adContainer.onContainerStateUpdate.subscribe(function(){if(_this._currentAd){var _this$_getCurrentAdCo=_this._getCurrentAdContainerState(),width=_this$_getCurrentAdCo.width,height=_this$_getCurrentAdCo.height,viewability=_this$_getCurrentAdCo.viewability;_this._checkAdPauser(viewability),_this._currentAd.resizeAd(width,height,_this._currentAdViewMode)}_this._adFetchingAllowed&&_this._fetchAds(),_this._impressionsAllowed&&_this._fetchImpressions()}),this._adImpressionerController.onAdSelected.subscribe(function(bid){_this._currentAd=bid,_this._subscribeToCurrentAd(),bid.setAdVolume(_this._currentAdPlayerState.sound)}),this._adImpressionerController.onAdFinished.subscribe(function(bid){_this._destroyCurrentAd()}),this._adBidPool.onBidReady.subscribe(function(bid){_this._predictMode&&(_this._adCallerController.stop(),_this._adFetchingAllowed=!1)}));var callerAuctionSubscription=this._adCallerController.onFirstAggregatedBatchFinished.subscribe(function(){_this._auctionManager.unlock(),callerAuctionSubscription.unsubscribe()})}return createClass_default()(AdManager,[{key:"setAdVolume",value:function(volume){this._currentAd&&(this._trackAdVolume(volume),this._currentAd.setAdVolume(volume))}},{key:"setAdViewMode",value:function(viewMode){if(this._currentAd){this._currentAdViewMode=viewMode;var _this$_getCurrentAdCo2=this._getCurrentAdContainerState(),width=_this$_getCurrentAdCo2.width,height=_this$_getCurrentAdCo2.height;this._currentAd.resizeAd(width,height,viewMode)}}},{key:"stopAd",value:function(reason){this._currentAd&&this._currentAd.stopAd(reason)}},{key:"pauseAd",value:function(userInteraction){this._currentAd&&this._currentAd.pauseAd(),userInteraction&&this._adPauser.pauseViaUserInteraction()}},{key:"resumeAd",value:function(userInteraction){this._currentAd&&this._currentAd.resumeAd(),userInteraction&&this._adPauser.resumeViaUserInteraction()}},{key:"skipAd",value:function(){this._currentAd&&(this._currentAd.setAdVolume(0),this._currentAd.skipAd())}},{key:"getVideoAdContainerState",value:function(){return this._adContainer.getContainerStateMap().get(protos.ProtoAdType.Video)}},{key:"getCurrentAdMetadata",value:function(){if(this._currentAd)return{advertiserLineItemId:this._currentAd.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,publisherLineItemId:this._currentAd.settings.adManagerLineItem.protoLineItem.publisherLineItemId,adType:this._currentAd.settings.adManagerLineItem.protoLineItem.adType,duration:this._currentAd.getAdDuration(),adSkipMode:this._currentAd.settings.adManagerLineItem.protoLineItem.skipMode,moatTrackingEnabled:this._currentAd.settings.adManagerLineItem.protoLineItem.moatTrackingEnabled}}},{key:"enableImpressions",value:function(adPlayerState){this.disablePredict(),this._predictMode=!1,this._handlePrerollProblemLogs(adPlayerState),this._currentAdPlayerState=adPlayerState,this._predictedAdPlayerState||(this._predictedAdPlayerState=this._currentAdPlayerState),this._requestCapsService.allowResetOnTime=!0,this._adContainer.forceTriggerUpdateState(),this._checkCapResets(adPlayerState),this._adFetchingAllowed=!0,this._fetchAds(),adPlayerState.adOpportunity&&!adPlayerState.adOpportunity.startedAuctionWithTimeout?(adPlayerState.adOpportunity.startAuctionWithTimeout(),this._auctionManager.startAuction(0)):this._auctionManager.startAuction(0)}},{key:"disableImpressions",value:function(){this._impressionsAllowed&&(this._auctionManager.cancel(),this._adImpressionerController.stop(),this._adCallerController.stop(),this._impressionsAllowed=!1,this._adFetchingAllowed=!1,this._currentAd&&!this._currentAdInImpression&&this._settings.app.config.isInApp&&this._currentAd.stopAd("inApp_disable"))}},{key:"enablePredict",value:function(adPlayerState,prefetchStateType){if(!(this._adBidPool.bidsReady.length>0)){switch(this._currentAdPlayerState=null,this._predictMode=!0,this._predictedAdPlayerState=adPlayerState,this._predictedAdPlayerState.prefetchStateType=prefetchStateType,prefetchStateType){case PrefetchStateTypeEnum.StartSessionPrefetch:this._requestCapsService.allowResetOnTime=!1;break;case PrefetchStateTypeEnum.MidSessionPrefetch:this._requestCapsService.allowResetOnTime=!0}this._adFetchingAllowed=!0,this._fetchAds()}}},{key:"disablePredict",value:function(){this._predictMode&&(this._adCallerController.stop(),this._adFetchingAllowed=!1)}},{key:"setPlatformCappedLineItemIdList",value:function(lineItemIdList){this._platformCappedLineItemRepository.addPlatformCappedLineItemIdList(lineItemIdList)}},{key:"notifyImpressionRevenue",value:function(impressionRevenueData){this._onImpressionRevenueEvent.next(impressionRevenueData)}},{key:"getAdMediaSize",value:function(){if(this._currentAd){var mediaWidth=this._currentAd.getAdMediaSize().width,mediaHeight=this._currentAd.getAdMediaSize().height,_calculateRatio=Object(NumberUtils.b)(mediaWidth,mediaHeight);return{width:mediaWidth,height:mediaHeight,widthRatio:_calculateRatio.widthRatio,heightRatio:_calculateRatio.heightRatio,adType:this._currentAd.settings.adManagerLineItem.protoLineItem.adType}}}},{key:"destroy",value:function(){this.disableImpressions(),clearSubscriptions(this._subscriptions),this._adCallerController.destroy(),this._adWinnerController.destroy(),this._adImpressionerController.destroy(),this._triggerMonetisationTimer.destroy(),this._currentAd&&(this._unsubscribeToCurrentAd(),this._currentAd.stopAd("adManagerDestroy"),this._destroyCurrentAd()),this._settings.app.services.TrackingService.removePlatformCappedLineItemSubscriber(this),this._settings.app.services.TrackingService.unsubscribeToImpressionRevenue(this)}},{key:"isLoadingAds",value:function(){return!!this._currentAd||!!this._adWinnerController.isLoadingBids()}},{key:"_fetchImpressions",value:function(){(this._currentAdPlayerState||this._predictedAdPlayerState)&&this._currentAdPlayerState&&this._adImpressionerController.start(this._getCurrentAdManagerState(this._currentAdPlayerState))}},{key:"_fetchAds",value:function(){this._adCallerController.call(this._getCallSettings()),this._adWinnerController.win(this._getWinSettings())}},{key:"_getCallSettings",value:function(){return{maxParallelCalls:5,stateSettings:{currentState:this._getCurrentAdManagerState(this._currentAdPlayerState),predictedState:this._getPredictedAdManagerState(this._predictedAdPlayerState)}}}},{key:"_getWinSettings",value:function(){return{desiredBitRate:DEFAULT_DESIRED_BITRATE,maxParallelWins:10,vastViewMode:this._currentAdPlayerState?this._currentAdPlayerState.vastViewMode:this._predictedAdPlayerState.vastViewMode,stateSettings:{currentState:this._getCurrentAdManagerState(this._currentAdPlayerState),predictedState:this._getPredictedAdManagerState(this._predictedAdPlayerState)}}}},{key:"_getPredictedAdManagerState",value:function(adPlayerState){var adContainersPredictedState;if(adPlayerState)return adPlayerState.prefetchStateType===PrefetchStateTypeEnum.StartSessionPrefetch?(adContainersPredictedState=new Map,this._adContainer.getContainerStateMap().forEach(function(value,key){adContainersPredictedState.set(key,Object.assign(Object.assign({},value),{viewability:!0}))})):adContainersPredictedState=this._adContainer.getContainerStateMap(),{clickToPlay:adPlayerState.clickToPlay,media:adPlayerState.mediaMetada,sound:!!adPlayerState.sound,soundValue:adPlayerState.sound,adContainerState:adContainersPredictedState,adBreakState:adPlayerState.adBreakState,adOpportunity:adPlayerState.adOpportunity}}},{key:"_getCurrentAdManagerState",value:function(adPlayerState){if(adPlayerState)return{clickToPlay:adPlayerState.clickToPlay,media:adPlayerState.mediaMetada,sound:!!adPlayerState.sound,soundValue:adPlayerState.sound,adContainerState:this._adContainer.getContainerStateMap(),adBreakState:adPlayerState.adBreakState,adOpportunity:adPlayerState.adOpportunity}}},{key:"_subscribeToCurrentAd",value:function(){var _a,_this2=this;this._onVpaidEvent.next({type:VastConfig.b.AdLoaded,payload:null===(_a=this._currentAd.settings.adLoadedPayload)||void 0===_a?void 0:_a.payload}),this._currentAdSubscription=this._currentAd.onVpaidEvent.subscribe(function(eventData){if(eventData.type===VastConfig.b.AdImpression){_this2._currentAdInImpression=!0;var viewability=_this2._getCurrentAdContainerState().viewability;_this2._checkAdPauser(viewability)}_this2._onVpaidEvent.next(eventData)})}},{key:"_getCurrentAdContainerState",value:function(){return this._adContainer.getContainerStateMap().get(this._currentAd.settings.adManagerLineItem.protoLineItem.adType)}},{key:"_unsubscribeToCurrentAd",value:function(){this._currentAdSubscription&&(this._currentAdSubscription.unsubscribe(),this._currentAdSubscription=null)}},{key:"_destroyCurrentAd",value:function(){this._currentAdInImpression=!1,this._adPauser.onAdRemoved(),this._currentAd=null,this._unsubscribeToCurrentAd()}},{key:"_checkAdPauser",value:function(viewability){this._adPauser.checkPauseAd(this._currentAd,viewability)}},{key:"_checkCapResets",value:function(adPlayerState){var capsServices=[this._impressionCapsService,this._requestCapsService];adPlayerState.newContent&&capsServices.forEach(function(currentCapsService){currentCapsService.resetCapsBasedOnExternalEvent(protos.ProtoResetCapTypeEnum.ContentCapping)})}},{key:"_trackAdVolume",value:function(volume){var currentVolume=this._currentAd.getAdVolume(),volumeTracker=null;0===currentVolume&&volume>0?volumeTracker=this._currentAd.settings.trackers.adUnmute:currentVolume>0&&0===volume&&(volumeTracker=this._currentAd.settings.trackers.adMute),volumeTracker&&TrackersInformation_TrackersInformation.track(volumeTracker,this._adMacroReplacer,this._currentAd.settings.adManagerLineItem.protoLineItem,this._getCurrentAdManagerState(this._currentAdPlayerState||this._predictedAdPlayerState))}},{key:"_handlePrerollProblemLogs",value:function(adPlayerState){var playerId=this._settings.app.config.playerId,adOpportunity=adPlayerState.adOpportunity,adBreakType=adPlayerState.adBreakState.adBreakType;adOpportunity&&adBreakType===protos.ProtoAdBreakTypeEnum.PreRoll&&PrerollProblemLoggingUtils_PrerollProblemLoggingUtils.initialize(playerId),adBreakType!==protos.ProtoAdBreakTypeEnum.PreRoll&&PrerollProblemLoggingUtils_PrerollProblemLoggingUtils.log(playerId,!0)}},{key:"onVpaidEvent",get:function(){return this._onVpaidEvent.asObservable()}},{key:"onImpressionRevenueEvent",get:function(){return this._onImpressionRevenueEvent.asObservable()}}]),AdManager}(),AdOpportunity_AdOpportunity=function(){function AdOpportunity(){classCallCheck_default()(this,AdOpportunity),this._id=Object(GeneralUtils.c)(),this._startedAuctionWithTimeout=!1}return createClass_default()(AdOpportunity,[{key:"startAuctionWithTimeout",value:function(){this._startedAuctionWithTimeout=!0}},{key:"id",get:function(){return this._id}},{key:"startedAuctionWithTimeout",get:function(){return this._startedAuctionWithTimeout}}]),AdOpportunity}();function AdManagerBridge_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var AdSlotMatchingTable=(_AdSlotMatchingTable={},defineProperty_default()(_AdSlotMatchingTable,protos.ProtoAdSlotsEnum.PreRoll,protos.ProtoAdBreakTypeEnum.PreRoll),defineProperty_default()(_AdSlotMatchingTable,protos.ProtoAdSlotsEnum.MidRoll,protos.ProtoAdBreakTypeEnum.MidRoll),defineProperty_default()(_AdSlotMatchingTable,protos.ProtoAdSlotsEnum.PostRoll,protos.ProtoAdBreakTypeEnum.PostRoll),_AdSlotMatchingTable),AdManagerBridge_AdManagerBridge=function(_Mediator){inherits_default()(AdManagerBridge,_Mediator);var _super=AdManagerBridge_createSuper(AdManagerBridge);function AdManagerBridge(mediator,_adSourceSettings,_pbjsSchainSettings,_skipPlayerSettings,_app){var _this,_outstream=arguments.length>5&&void 0!==arguments[5]&&arguments[5],_adBreakHelper=(arguments.length>6&&arguments[6],arguments.length>7?arguments[7]:void 0),_amazonTamSlotId=arguments.length>8?arguments[8]:void 0,_prerollTimeMs=(arguments.length>9&&arguments[9],arguments.length>10?arguments[10]:void 0),_pauseAdWhenFinished=arguments.length>11?arguments[11]:void 0,_adPlaybackMode=arguments.length>12?arguments[12]:void 0,_adBreaks=arguments.length>13?arguments[13]:void 0,_loopAdWhenFinished=arguments.length>14?arguments[14]:void 0;classCallCheck_default()(this,AdManagerBridge),(_this=_super.call(this)).mediator=mediator,_this._adSourceSettings=_adSourceSettings,_this._pbjsSchainSettings=_pbjsSchainSettings,_this._skipPlayerSettings=_skipPlayerSettings,_this._app=_app,_this._outstream=_outstream,_this._adBreakHelper=_adBreakHelper,_this._amazonTamSlotId=_amazonTamSlotId,_this._prerollTimeMs=_prerollTimeMs,_this._pauseAdWhenFinished=_pauseAdWhenFinished,_this._adPlaybackMode=_adPlaybackMode,_this._adBreaks=_adBreaks,_this._loopAdWhenFinished=_loopAdWhenFinished,_this._subscriptions=[],_this._adsEnabled=!1,_this._adsManagerInitialized=!1,_this._adContainerMap=new Map,_this._prefetchState=PrefetchStateTypeEnum.NoPrefetch;var adBreakType=protos.ProtoAdBreakTypeEnum.MidRoll;_this._adBreaks.forEach(function(adBreak){adBreak.types.some(function(type){return type===protos.ProtoAdBreakTypeEnum.PreRoll})&&(adBreakType=protos.ProtoAdBreakTypeEnum.PreRoll)});var adBreakState=_this._getAdBreakState(_this._adBreakHelper.getMaxAdSlotDuration(),adBreakType);return _this._currentAdPlayerState={mediaMetada:{},clickToPlay:!1,adOpportunity:new AdOpportunity_AdOpportunity,newContent:!1,sound:0,vastViewMode:VastConfig.a.Normal,adBreakState:adBreakState},_this}return createClass_default()(AdManagerBridge,[{key:"enableAds",value:function(){this._adsEnabled=!0,this._adManagerEnableImpressionsWrapper(),this.mediator.publish(this,AdManagerEvents.AdsEnabled)}},{key:"disableAds",value:function(reason){this._adsEnabled=!1,this._adManager&&(this._adManager.disableImpressions(),this._prefetchState===PrefetchStateTypeEnum.NoPrefetch&&reason===DisableAdsReasonEnum.TimeoutBetweenAds&&this._enablePrefetchMode(PrefetchStateTypeEnum.MidSessionPrefetch))}},{key:"updateFilterConfig",value:function(mediaRestrictions){this._currentAdPlayerState.mediaMetada.mediaId=mediaRestrictions.mediaId,this._currentAdPlayerState.mediaMetada.mediaLanguage=mediaRestrictions.mediaLanguage,this._currentAdPlayerState.mediaMetada.mediaKeywords=mediaRestrictions.mediaKeywords;var newMediaMetadata=Object.assign(this._currentAdPlayerState.mediaMetada,mediaRestrictions);this._adManagerEnableImpressionsWrapper({mediaMetada:newMediaMetadata})}},{key:"userInteraction",value:function(playback){this._adManagerEnableImpressionsWrapper({clickToPlay:!0})}},{key:"newAdOpportunity",value:function(){this._prefetchState===PrefetchStateTypeEnum.NoPrefetch&&(this._currentAdPlayerState.adOpportunity=new AdOpportunity_AdOpportunity),this._adManagerEnableImpressionsWrapper({adOpportunity:this._currentAdPlayerState.adOpportunity}),this._disablePrefetchMode()}},{key:"initAd",value:function(width,height,viewMode,desireBitrate,startVolume,adContainers){var _this2=this;adContainers.forEach(function(currentAdContainer){_this2._adContainerMap.set(currentAdContainer.type,currentAdContainer.container),_this2._adContainerMap.get(protos.ProtoAdType.Overlay)||_this2._adContainerMap.set(protos.ProtoAdType.Overlay,_this2._adContainerMap.get(protos.ProtoAdType.Video))}),this._initAdManager(),this._adsManagerInitialized=!0,this._adManagerEnableImpressionsWrapper({sound:startVolume})}},{key:"setAdVolume",value:function(volume){var _a;null===(_a=this._adManager)||void 0===_a||_a.setAdVolume(volume),this._adManagerEnableImpressionsWrapper({sound:volume})}},{key:"resizeAd",value:function(width,height,viewMode){var _a;this._cachedAdViewMode!==viewMode&&(this.setVastViewMode(viewMode),null===(_a=this._adManager)||void 0===_a||_a.setAdViewMode(viewMode))}},{key:"stopAd",value:function(reason){var _a;null===(_a=this._adManager)||void 0===_a||_a.stopAd(reason)}},{key:"pauseAd",value:function(userInteraction){var _a;null===(_a=this._adManager)||void 0===_a||_a.pauseAd(userInteraction)}},{key:"resumeAd",value:function(userInteraction){var _a;null===(_a=this._adManager)||void 0===_a||_a.resumeAd(userInteraction)}},{key:"skipAd",value:function(){var _a;null===(_a=this._adManager)||void 0===_a||_a.skipAd()}},{key:"getAdContainerWidth",value:function(){var _a;return null===(_a=this._adManager)||void 0===_a?void 0:_a.getVideoAdContainerState().width}},{key:"getAdMediaSize",value:function(){var _a;return null===(_a=this._adManager)||void 0===_a?void 0:_a.getAdMediaSize()}},{key:"getCurrentAdClickTrackingProperties",value:function(){var _a,_ref=null===(_a=this._adManager)||void 0===_a?void 0:_a.getCurrentAdMetadata();return{publisherLineItemId:_ref.publisherLineItemId,advertiserLineItemId:_ref.advertiserLineItemId}}},{key:"getAdDuration",value:function(){return this._adManager.getCurrentAdMetadata().duration}},{key:"getCurrentAdType",value:function(){return this._adManager.getCurrentAdMetadata().adType}},{key:"getLastAdSlot",value:function(adType){var adContainer=this._adContainerMap.get(adType);return{height:adContainer.clientHeight,width:adContainer.clientWidth}}},{key:"updatePodRemainingTime",value:function(podRemainingTime){if(!(podRemainingTime<=0)){var adBreak=this._currentAdPlayerState.adBreakState;Math.round(podRemainingTime/TimeConfig.f)>adBreak.remainingAdDuration||this._adManagerEnableImpressionsWrapper({adBreakState:this._getAdBreakState(podRemainingTime,adBreak.adBreakType)})}}},{key:"onAdStateChange",value:function(adSlot,maxAdSlotDuration){var adBreakType=AdSlotMatchingTable[adSlot];this._adManagerEnableImpressionsWrapper({adBreakState:this._getAdBreakState(maxAdSlotDuration,adBreakType)})}},{key:"onContentChange",value:function(){this._adManagerEnableImpressionsWrapper({newContent:!0})}},{key:"setVastViewMode",value:function(vastViewMode){this._cachedAdViewMode=vastViewMode,this._updateCurrentAdPlayerState({vastViewMode:vastViewMode})}},{key:"destroy",value:function(){clearSubscriptions(this._subscriptions)}},{key:"_adManagerEnableImpressionsWrapper",value:function(adPlayerState){this._updateCurrentAdPlayerState(adPlayerState),this._adsEnabled&&this._adsManagerInitialized&&(this._adManager.enableImpressions(this._currentAdPlayerState),this._resetAdPlayerStateFlags())}},{key:"_updateCurrentAdPlayerState",value:function(stateOverrides){Object.assign(this._currentAdPlayerState,stateOverrides),this._currentAdPlayerState.adBreakState=this._getAdBreakState(this._currentAdPlayerState.adBreakState.remainingAdDuration,this._currentAdPlayerState.adBreakState.adBreakType)}},{key:"_resetAdPlayerStateFlags",value:function(){this._updateCurrentAdPlayerState({clickToPlay:!1,newContent:!1})}},{key:"_getAdBreakState",value:function(adSlotDuration,adSlot){return{isAdPodBreak:this._adBreakHelper.isCurrentBreakInPod(),adPodSlotIndex:this._adBreakHelper.isCurrentBreakInPod()?this._adBreakHelper.getNextSlotIndex():0,maxAdDuration:Math.round(this._adBreakHelper.getMaxAdSlotDuration()/TimeConfig.f||180),remainingAdDuration:Math.round(adSlotDuration/TimeConfig.f),sessionMaxAdDuration:Math.round(this._adBreakHelper.getMaxAdSlotPossibleDuration()/TimeConfig.f),adBreakType:adSlot}}},{key:"_initAdManager",value:function(){var _this3=this;this._adManager=new AdManager_AdManager({adBreakHelper:this._adBreakHelper,adContainerMap:this._adContainerMap,amazonTamSlotId:this._amazonTamSlotId,app:this._app,lineItemList:this._adSourceSettings.lineItems,outstream:this._outstream,pbjsSchainSettings:this._pbjsSchainSettings,prerollTimeMs:this._prerollTimeMs,skipPlayerSettings:this._skipPlayerSettings,disableScrollHijackEnforcement:!this._adSourceSettings.disableScrollHijackEnforcement,pauseAdWhenFinished:this._pauseAdWhenFinished,loopAdWhenFinished:this._loopAdWhenFinished}),this._subscriptions.push(this._adManager.onVpaidEvent.subscribe(function(event){switch(event.type){case VastConfig.b.AdLoaded:_this3._publishAdLoadedEvent(event);break;case VastConfig.b.AdImpression:_this3._publishAdImpressionEvent(event);break;case VastConfig.b.AdVideoStart:case VastConfig.b.AdError:_this3.mediator.publish(_this3,event.type,{payload:event.payload});break;default:_this3.mediator.publish(_this3,event.type,{payload:{}})}})),this._adManager.onImpressionRevenueEvent.subscribe(function(impressionRevenueData){_this3.mediator.publish(_this3,ApiConfig.b.ImpressionPrice,{payload:impressionRevenueData.impressionRevenue}),_this3.mediator.publish(_this3,ApiConfig.b.ImpressionRevenue,{payload:impressionRevenueData})}),this._adPlaybackMode===protos.ProtoAdPlaybackMode.ScrollToPlay&&this._enablePrefetchMode(PrefetchStateTypeEnum.StartSessionPrefetch)}},{key:"_enablePrefetchMode",value:function(prefetchStateType){this._prefetchState=prefetchStateType,this._currentAdPlayerState.adOpportunity=new AdOpportunity_AdOpportunity,this._adManager.enablePredict(this._currentAdPlayerState,prefetchStateType)}},{key:"_disablePrefetchMode",value:function(){this._prefetchState=PrefetchStateTypeEnum.NoPrefetch}},{key:"_publishAdLoadedEvent",value:function(adLoadedAdManagerEvent){var adLoadedPayload={payload:{adSkipMode:adLoadedAdManagerEvent.payload.adSkipMode,adLoadedData:{skipOffset:adLoadedAdManagerEvent.payload.adLoadedData.skipOffset}}};this.mediator.publish(this,adLoadedAdManagerEvent.type,adLoadedPayload)}},{key:"_publishAdImpressionEvent",value:function(adImpressionAdManagerEvent){var _a,_b,_adImpressionAdManage=adImpressionAdManagerEvent.payload.adSourceData,adId=_adImpressionAdManage.adId,adVideoUrl=_adImpressionAdManage.adVideoUrl,creativeId=_adImpressionAdManage.creativeId,name=_adImpressionAdManage.name,length=_adImpressionAdManage.length,imaMetadata=_adImpressionAdManage.imaMetadata,moatTrackingEnabled=_adImpressionAdManage.moatTrackingEnabled,currentAdMetadata=this._adManager.getCurrentAdMetadata(),adImpressionPayload={payload:{adSkipMode:adImpressionAdManagerEvent.payload.adSkipMode,adSourceData:{moatTrackingEnabled:moatTrackingEnabled,adId:adId,length:length,imaMetadata:imaMetadata,adVideoUrl:adVideoUrl,creativeId:creativeId,name:name},clickThroughUrl:adImpressionAdManagerEvent.payload.clickThroughUrl,customAdData:{ADVERTISER:null===(_a=adImpressionAdManagerEvent.payload.customAdData)||void 0===_a?void 0:_a.ADVERTISER,CAMPAIGN_ID:null===(_b=adImpressionAdManagerEvent.payload.customAdData)||void 0===_b?void 0:_b.CAMPAIGN_ID,CREATIVE_ID:adImpressionAdManagerEvent.payload.customAdData.CREATIVE_ID},adDuration:adImpressionAdManagerEvent.payload.adSourceData.length,selectedAdSlot:this._adContainerMap.get(currentAdMetadata.adType)}};this.mediator.publish(this,adImpressionAdManagerEvent.type,adImpressionPayload)}},{key:"adInWin",get:function(){return this._adManager.isLoadingAds()}}]),AdManagerBridge}(Mediator.a),CssClassFlagsPlayspaceEnum_OrientationPortrait="cnx-in-ps-portrait",CssClassFlagsPlayspaceEnum_OrientationLandscape="cnx-in-ps-landscape",CSSClassMainPlayspaceEnum={Container:"cnx-playspace-container",Content:"cnx-playspace-content",Footer:"cnx-playspace-footer",Slider:"cnx-playspace-slider",Slide:"cnx-playspace-slide-container",Overlay:"cnx-ui-click-to-play-overlay",ImageWrapper:"cnx-ui-ps-image-wrapper",ImageBackground:"cnx-ui-ps-image-background",MediaLogo:"cnx-is-media-logo"},CSSClassPlayspaceAd_VideoSizeSlot="cnx-ad-video-size-slot",CSSClassTopArticleComponentEnum={Main:"cnx-top-title",LogoContainer:"cnx-top-title-logo-container",Logo:"cnx-top-title-logo",LogoPortrait:"cnx-top-title-logo-portrait",LogoLandscape:"cnx-top-title-logo-landscape",LogoAnimation:"cnx-top-title-logo-animation",TitlesContainer:"cnx-top-title-text-container",TopStoryTitle:"cnx-top-title-story-text",TopSlideTitle:"cnx-top-title-slide-text",TextPlaceholder:"cnx-top-title-highlight-text-placeholder",Text:"cnx-top-title-highlight-text",TextOuterContainer:"cnx-top-title-highlight-text-outer-container",TextInnerContainer:"cnx-top-title-highlight-text-inner-container",SlideIn:"cnx-top-title-slide-in",SlideOut:"cnx-top-title-slide-out",SlideDown:"cnx-top-title-slide-down",SlideInitial:"cnx-top-title-slide-initial"};function PlayspaceAdHandler_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var SlidingDirectionEnum,PlayspaceAdHandler_PlayspaceAdHandler=function(_AdHandler){inherits_default()(PlayspaceAdHandler,_AdHandler);var _super=PlayspaceAdHandler_createSuper(PlayspaceAdHandler);function PlayspaceAdHandler(mediator,playerSettings,$adBody,currentPlayerViewability,_adBreakHelper,app,_urlSuffixerService){return classCallCheck_default()(this,PlayspaceAdHandler),_super.call(this,mediator,playerSettings,$adBody,currentPlayerViewability,_adBreakHelper,app,_urlSuffixerService)}return createClass_default()(PlayspaceAdHandler,[{key:"getNewAdManager",value:function(){var skipAdsSettings={adSkippability:this._playerSettings.adSkippability,skipAdAfter:this._playerSettings.skipAdAfter,adsMustBeSkippableIfLongerThan:this._playerSettings.adsMustBeSkippableIfLongerThan};return new AdManagerBridge_AdManagerBridge(this,this._playerSettings.lineItemSettings,this._playerSettings.supplyChainSettings,skipAdsSettings,this._app,!1,this._playerSettings.adSkippability,this._adBreakHelper,this._playerSettings.amazonTamSlotId,this._playerSettings.global,this._playerSettings.preRollBreak,this._playerSettings.pauseAdWhenFinished,this._playerSettings.adPlaybackMode,this._playerSettings.adBreaks,this._playerSettings.loopAdWhenFinished)}},{key:"_initAdManager",value:function(width,height,volume){this._adManager.initAd(width,height,this._vastViewMode,1,volume,[{container:this._adContainer,width:this._adContainer.offsetWidth,height:this._adContainer.offsetHeight,type:protos.ProtoAdType.Overlay},{container:this._secondaryAdContainer,width:this._secondaryAdContainer.offsetWidth,height:this._secondaryAdContainer.offsetHeight,type:protos.ProtoAdType.Video}])}},{key:"_initAdInterface",value:function(){var settings=getBaseUISettings(this._playerSettings,this._app.config);this._adUserInterface=new UiAd_UiAd(this,this._app.services.GlobalDomUtilsService,this._app.services.ViewabilityService,this._app.services.InteractionService,this._parentContainer,(new AdTemplate_AdTemplate).template,settings),this._adUserInterface.hide()}},{key:"_initSecondaryAdSlot",value:function(){this._secondaryAdContainer=this._createAdSlot(CSSClassPlayspaceAd_VideoSizeSlot),this._addAdSlot(this._secondaryAdContainer),this._adSlotList.push(this._secondaryAdContainer)}},{key:"_initAdSlots",value:function(){get_default()(getPrototypeOf_default()(PlayspaceAdHandler.prototype),"_initAdSlots",this).call(this),this._initSecondaryAdSlot()}},{key:"_activateAdSlotContainer",value:function(selectedAdSlotContainer){get_default()(getPrototypeOf_default()(PlayspaceAdHandler.prototype),"_activateAdSlotContainer",this).call(this,selectedAdSlotContainer),selectedAdSlotContainer===this._secondaryAdContainer&&Object(DomUtils.a)(this._parentContainer,CssClassesConfig.g.AdFullSize)}},{key:"_subscribeToEvents",value:function(){var _this=this;get_default()(getPrototypeOf_default()(PlayspaceAdHandler.prototype),"_subscribeToEvents",this).call(this),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.SkipAd],this._adUserInterface,function(){return _this._skipAd()})}},{key:"_skipAd",value:function(){this.skipAd(),this.userInteraction(!0)}},{key:"updateContinueReadingCard",value:function(){var adMediaSize=this._adManager.getAdMediaSize();Object(TypeUtils.a)(adMediaSize)&&(this._canShowContinueReadingCard(this._adManager.getAdMediaSize())?this._adUserInterface.showContinueReadingCard(this._adContainer):this._adUserInterface.hideContinueReadingCard(this._adContainer))}}]),PlayspaceAdHandler}(AdHandler_AdHandler),UiPlayspaceEventsEnum={ProgressBarItemClicked:"progressBarItemClicked",CallToAction:"callToAction",CloseButtonClicked:"closeButtonClicked",GeneralClickInteraction:"generalClickInteraction"},PlayspaceExperienceApiEventsEnum={ChangeSlide:"changeSlide",ContentStart:"contentStart",ContentComplete:"contentComplete",LayoutChanged:"layoutChanged"},PlayspaceExperienceEventsEnum=Object.assign(Object.assign({},ExperienceConfig.a),{ContentHandlerReady:"contentHandlerReady",NewStory:"newStory",ContentStart:"ContentStart",ContentEnd:"ContentEnd"}),PlayspaceContentEventsEnum={SlideTransitionStart:"slideTransitionStart",SlideChanged:"slideChanged",SlideTransitionEnd:"slideTransitionEnd",SlideTimeUpdate:"slideTimeUpdate",SlideCycleEnd:"slideCycleEnd"},PlayspaceApiEventsEnum=Object.assign(Object.assign({},PlayspaceExperienceApiEventsEnum),UiPlayspaceEventsEnum),DEFAULT_SLIDE_INDEX=0,LANDSCAPE_BOTTOM_HEIGHT=72,SlidesPlaylist_SlidesPlaylist=function(){function SlidesPlaylist(_slides){var _startIndex=arguments.length>1&&void 0!==arguments[1]?arguments[1]:DEFAULT_SLIDE_INDEX;classCallCheck_default()(this,SlidesPlaylist),this._slides=_slides,this.setCurrentSlide(_startIndex)}return createClass_default()(SlidesPlaylist,[{key:"_getHelperIndexes",value:function(){var index=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._slides.indexOf(this._currentSlide);return getPlaylistHelperIndexes(this._slides,index)}},{key:"getCurrentThumbnailUrlParams",value:function(width,height){return this._currentSlide.media.getThumbnailUrlParams(width,height)}},{key:"getCurrentMetadata",value:function(){return this._currentSlide.metadata}},{key:"setCurrentSlide",value:function(index){this._currentSlide=this._slides[index]}},{key:"getAdjacentSlides",value:function(){for(var index=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._getHelperIndexes().currentIndex,adjacentSlides=[],i=0,nextIndex=index,prevIndex=index;i<2;i++)nextIndex=this._getHelperIndexes(nextIndex).nextIndex,prevIndex=this._getHelperIndexes(prevIndex).prevIndex,adjacentSlides.push(this._slides[prevIndex],this._slides[nextIndex]);return Object(ArrayUtils.n)(adjacentSlides)}},{key:"currentSlide",get:function(){return this._currentSlide}},{key:"currentSlideIndex",get:function(){return this._getHelperIndexes().currentIndex}},{key:"nextSlideIndex",get:function(){return this._getHelperIndexes().nextIndex}},{key:"prevSlideIndex",get:function(){return this._getHelperIndexes().prevIndex}},{key:"firstSlideIndex",get:function(){return this._getHelperIndexes().firstIndex}},{key:"lastSlideIndex",get:function(){return this._getHelperIndexes().lastIndex}},{key:"slides",get:function(){return this._slides}},{key:"nextSlide",get:function(){return this.slides[this.nextSlideIndex]}},{key:"prevSlide",get:function(){return this.slides[this.prevSlideIndex]}}]),SlidesPlaylist}();function SlidingHelper_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}!function(SlidingDirectionEnum){SlidingDirectionEnum[SlidingDirectionEnum.Right=0]="Right",SlidingDirectionEnum[SlidingDirectionEnum.Left=1]="Left"}(SlidingDirectionEnum||(SlidingDirectionEnum={}));var SlidingHelper_SlidingHelper=function(_Mediator){inherits_default()(SlidingHelper,_Mediator);var _super=SlidingHelper_createSuper(SlidingHelper);function SlidingHelper(mediator,_$slidingContainer){var _this;return classCallCheck_default()(this,SlidingHelper),(_this=_super.call(this)).mediator=mediator,_this._$slidingContainer=_$slidingContainer,_this.inTransition=!1,_this._currentIndex=0,_this._transitionEndTimeout=null,_this._canDoTransitionEnd=!1,_this._transitionSlideTime=400,_this._animationAllowed=!0,_this._goToNextSlide=function(){clearTimeout(_this._transitionEndTimeout),_this._transitionEndTimeout=null,_this._canDoTransitionEnd=!1,_this._disableTransition(),_this._currentIndex=_this._getIndexOfSlide(_this._$nextSlide),_this.mediator.publish(assertThisInitialized_default()(_this),PlayspaceContentEventsEnum.SlideTransitionEnd),_this._publishSlideChanged()},_this._onSlidingTransitionStart=function(e){e.stopPropagation(),e.target.parentElement===_this._$slidingContainer&&_this._currentSlideHasTransitionClass()&&(_this._transitionEndTimeout=setTimeout(function(){_this._canDoTransitionEnd&&_this._cleanupTansitionAndMoveToNext()},_this._transitionSlideTime))},_this._onSlidingTransitionEnd=function(e){e.stopPropagation(),e.target.parentElement===_this._$slidingContainer&&_this.inTransition&&_this._canDoTransitionEnd&&_this._currentSlideHasTransitionClass()&&_this._cleanupTansitionAndMoveToNext()},_this._slideList=Object(ArrayUtils.c)(_this._$slidingContainer.childNodes),_this._$slidingContainer.addEventListener("transitionstart",_this._onSlidingTransitionStart),_this._$slidingContainer.addEventListener("transitionend",_this._onSlidingTransitionEnd),_this}return createClass_default()(SlidingHelper,[{key:"destroy",value:function(){clearTimeout(this._transitionEndTimeout),this._transitionEndTimeout=null,this._$slidingContainer.removeEventListener("transitionend",this._onSlidingTransitionEnd),this._$slidingContainer.removeEventListener("transitionstart",this._onSlidingTransitionStart)}},{key:"setCurrentSlide",value:function($slide,slidingDirection){var withTransition=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._$nextSlide=$slide,this._animationAllowed||(withTransition=!1),withTransition&&!this._isSlideSameAsCurrent(this._$nextSlide)&&this._isCurrentSlideDefined()&&this._animationAllowed?this.inTransition||(this._currentIndex<this._getIndexOfSlide(this._$nextSlide)?this._transitionToNextSlide(slidingDirection):this._transitionToNextSlide(SlidingDirectionEnum.Left)):this._showNextSlide()}},{key:"offsetSlides",value:function(offsetValue,$upcomingSlide){this.inTransition||(Object(DomUtils.a)($upcomingSlide,CssClassesConfig.r.NextSlide),this._disableTransition(),this._translateSlider(offsetValue))}},{key:"removeNextClass",value:function(containerList){containerList.forEach(function($container){Object(DomUtils.L)($container,CssClassesConfig.r.NextSlide)})}},{key:"cleanLastSlide",value:function($currentSlide,$nextSlide){Object(DomUtils.N)($currentSlide,"transform"),Object(DomUtils.L)($nextSlide,CssClassesConfig.r.NextSlide)}},{key:"setAnimationAllowed",value:function(isAllowed){this._animationAllowed=isAllowed}},{key:"_translateSlider",value:function(pixels){Object(DomUtils.Q)(this._getCurrentSlide(),{transform:"translate(".concat(pixels,"px)")})}},{key:"_showNextSlide",value:function(){Object(DomUtils.L)(this._getCurrentSlide(),CssClassesConfig.r.CurrentSlide,CssClassesConfig.r.SlideLeft,CssClassesConfig.r.SlideRight),this._publishSlidingStarted(this._getIndexOfSlide(this._$nextSlide)),Object(DomUtils.a)(this._$nextSlide,CssClassesConfig.r.CurrentSlide),this._goToNextSlide()}},{key:"_transitionToNextSlide",value:function(slidingDirection){this._publishSlidingStarted(this._getIndexOfSlide(this._$nextSlide)),this._enableTransition(),Object(DomUtils.a)(this._$nextSlide,CssClassesConfig.r.NextSlide),slidingDirection===SlidingDirectionEnum.Right?(Object(DomUtils.a)(this._$nextSlide,CssClassesConfig.r.CurrentSlide),Object(DomUtils.a)(this._getCurrentSlide(),CssClassesConfig.r.SlideLeft)):slidingDirection===SlidingDirectionEnum.Left&&(Object(DomUtils.a)(this._$nextSlide,CssClassesConfig.r.CurrentSlide),Object(DomUtils.a)(this._getCurrentSlide(),CssClassesConfig.r.SlideRight)),Object(DomUtils.N)(this._getCurrentSlide(),"transform")}},{key:"_isSlideSameAsCurrent",value:function($container){return $container===this._getCurrentSlide()}},{key:"_publishSlideChanged",value:function(){this.mediator.publish(this,PlayspaceContentEventsEnum.SlideChanged)}},{key:"_publishSlidingStarted",value:function(index){this._canDoTransitionEnd=!0,this.mediator.publish(this,PlayspaceContentEventsEnum.SlideTransitionStart,{payload:{nextIndex:index}})}},{key:"_isCurrentSlideDefined",value:function(){return Object(TypeUtils.a)(this._getCurrentSlide())}},{key:"_getIndexOfSlide",value:function($slide){return Object(DomUtils.k)($slide,this._$slidingContainer)}},{key:"_getCurrentSlide",value:function(){return this._slideList[this._currentIndex]}},{key:"_enableTransition",value:function(){this._enableSliderTransition(),this._enableTransitionFlag()}},{key:"_disableTransition",value:function(){this._disableTransitionFlag(),this._disableSliderTransition()}},{key:"_disableSliderTransition",value:function(){Object(DomUtils.a)(this._$slidingContainer,CssClassesConfig.h.NoTransition)}},{key:"_enableSliderTransition",value:function(){Object(DomUtils.L)(this._$slidingContainer,CssClassesConfig.h.NoTransition)}},{key:"_disableTransitionFlag",value:function(){this.inTransition=!1}},{key:"_enableTransitionFlag",value:function(){this.inTransition=!0}},{key:"_transitionCleanup",value:function(){Object(DomUtils.L)(this._getCurrentSlide(),CssClassesConfig.r.CurrentSlide,CssClassesConfig.r.SlideLeft,CssClassesConfig.r.SlideRight),Object(DomUtils.O)(this._$nextSlide,CssClassesConfig.r.NextSlide,CssClassesConfig.r.CurrentSlide)}},{key:"_cleanupTansitionAndMoveToNext",value:function(){this._transitionCleanup(),this._goToNextSlide()}},{key:"_currentSlideHasTransitionClass",value:function(){return Object(DomUtils.u)(this._getCurrentSlide(),CssClassesConfig.r.SlideLeft)||Object(DomUtils.u)(this._getCurrentSlide(),CssClassesConfig.r.SlideRight)}}]),SlidingHelper}(Mediator.a);function SlidesManager_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var SlidesManager_SlidesManager=function(_Mediator){inherits_default()(SlidesManager,_Mediator);var _super=SlidesManager_createSuper(SlidesManager);function SlidesManager(mediator,_globalDomUtilsService,_pageFocusService,_$playerContainer,_slideFactory,_isSeoTraffic){var _this;return classCallCheck_default()(this,SlidesManager),(_this=_super.call(this)).mediator=mediator,_this._globalDomUtilsService=_globalDomUtilsService,_this._pageFocusService=_pageFocusService,_this._$playerContainer=_$playerContainer,_this._slideFactory=_slideFactory,_this._isSeoTraffic=_isSeoTraffic,_this._isPlaying=!1,_this._slidesMeta=[],_this._pageinFocus=!1,_this._onSlideTimeEnd=function(){_this.goToNextSlide()},_this._onSlideTimeUpdate=function(){_this.mediator.publish(assertThisInitialized_default()(_this),PlayspaceContentEventsEnum.SlideTimeUpdate,{payload:{elapsedTime:_this._timer.timeElapsed,duration:_this._slidesPlaylist.currentSlide.media.duration}})},_this._$slider=_this._globalDomUtilsService.createElementByString('<cnx class="'.concat(CSSClassMainPlayspaceEnum.Slider,'"></cnx>')),_this._$playerContainer.appendChild(_this._$slider),_this._initTimer(),_this}return createClass_default()(SlidesManager,[{key:"_addPageFocusService",value:function(){var _this2=this;this._pageFocusService.on(function(inFocus){_this2._pageinFocus=inFocus,_this2._slidingHelper.setAnimationAllowed(inFocus)})}},{key:"_slideToCurrentSlide",value:function(){var slidingDirection=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SlidingDirectionEnum.Right;this._slidingHelper.setCurrentSlide(this._slidesPlaylist.currentSlide.$container,slidingDirection)}},{key:"_prepareCurrentSlide",value:function(){this._slidesPlaylist.currentSlide.load(),(this._isSeoTraffic?toConsumableArray_default()(this._slidesPlaylist.slides):toConsumableArray_default()(this._slidesPlaylist.getAdjacentSlides())).forEach(function(slide){return slide.load()})}},{key:"_initSlidingHelper",value:function(){var _this3=this;this._slidingHelper=new SlidingHelper_SlidingHelper(this,this._$slider),this.subscribe(PlayspaceContentEventsEnum.SlideTransitionStart,this._slidingHelper,function(_ref){var nextIndex=_ref.payload.nextIndex;_this3._pageinFocus&&_this3._timer.disable(),_this3.mediator.publish(_this3,PlayspaceContentEventsEnum.SlideTransitionStart,{payload:{nextSlide:_this3._slidesPlaylist.slides[nextIndex]}})}),this.subscribe(PlayspaceContentEventsEnum.SlideChanged,this._slidingHelper,function(){_this3._timer.reset(_this3._slidesPlaylist.currentSlide.media.duration),_this3._slidesPlaylist.slides.forEach(function(slide){return slide.media.reset()});var data={payload:{index:_this3._slidesPlaylist.currentSlideIndex}};_this3.mediator.publish(_this3,PlayspaceContentEventsEnum.SlideChanged,data),_this3._isPlaying?_this3._slidesPlaylist.currentSlide.media.play():_this3.pause()}),this.subscribe(PlayspaceContentEventsEnum.SlideTransitionEnd,this._slidingHelper,function(){_this3.mediator.publish(_this3,PlayspaceContentEventsEnum.SlideTransitionEnd)})}},{key:"_initTimer",value:function(){this._timer=new Timer_Timer(0,100),this._timer.onTimeElapsed.subscribe(this._onSlideTimeEnd),this._timer.onTimeUpdate.subscribe(this._onSlideTimeUpdate)}},{key:"_setSlides",value:function(slidesMeta){var _this4=this;this._slidesMeta=slidesMeta;var totalReadingTime=this._getTotalReadingTime(slidesMeta),slides=slidesMeta.map(function(metadata){var slide=_this4._slideFactory.getSlide(metadata,_this4,totalReadingTime);return _this4.subscribe(UiPlayspaceEventsEnum.CallToAction,slide,function(){_this4.mediator.publish(_this4,UiPlayspaceEventsEnum.CallToAction)}),_this4.relay(UiPlayspaceEventsEnum.GeneralClickInteraction,slide,_this4,_this4.mediator),_this4.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Next],slide,function(){_this4.mediator.publish(_this4,UiComponentEventsEnum[UiComponentEventsEnum.Next])}),slide});this._slidesPlaylist=new SlidesPlaylist_SlidesPlaylist(slides),this._timer.reset(this._slidesPlaylist.currentSlide.media.duration),this._$slider.innerHTML="",this._slidesPlaylist.slides.forEach(function(slide){Object(DomUtils.d)(slide.$container,_this4._$slider),_this4.relay(VideoQualityEventsEnum.Change,slide.media,_this4,_this4.mediator)})}},{key:"_getTotalReadingTime",value:function(slideMetaList){var seconds=slideMetaList.map(function(item){return item.slideDuration}).reduce(function(prev,current){return prev+current},0);return Object(TypeUtils.e)(seconds)?Math.ceil(seconds/TimeConfig.g):1}},{key:"_removeAdjacentSlidesNextClass",value:function(){var adjacentSlidesContainerList=this._slidesPlaylist.getAdjacentSlides().map(function(slide){return slide.$container});this._slidingHelper.removeNextClass(adjacentSlidesContainerList)}},{key:"_getUpcomingSlideContainer",value:function(offsetValue){return(offsetValue>0?this._slidesPlaylist.prevSlide:this._slidesPlaylist.nextSlide).$container}},{key:"getNextSlide",value:function(){return this._slidesPlaylist.nextSlide}},{key:"setCurrentSlide",value:function(index,slidingDirection){this._slidingHelper.inTransition||(this._slidesPlaylist.currentSlide&&this._slidesPlaylist.currentSlide.media.pause(),this._slidesPlaylist.setCurrentSlide(index),this._prepareCurrentSlide(),this._slideToCurrentSlide(slidingDirection))}},{key:"getCurrentSlide",value:function(){if(this._slidesPlaylist)return this._slidesPlaylist.currentSlide}},{key:"getCurrentThumbnailUrlParams",value:function(width,height){if(this._slidesPlaylist)return this._slidesPlaylist.getCurrentThumbnailUrlParams(width,height)}},{key:"getCurrentMetadata",value:function(){if(this._slidesPlaylist)return this._slidesPlaylist.getCurrentMetadata()}},{key:"goToNextSlide",value:function(){if(this._slidesPlaylist.currentSlideIndex===this._slidesPlaylist.lastSlideIndex)return this._slidingHelper.cleanLastSlide(this.getCurrentSlide().$container,this.getNextSlide().$container),void this.mediator.publish(this,PlayspaceContentEventsEnum.SlideCycleEnd);this.setCurrentSlide(this._slidesPlaylist.nextSlideIndex,SlidingDirectionEnum.Right)}},{key:"goToPrevSlide",value:function(){this.setCurrentSlide(this._slidesPlaylist.prevSlideIndex,SlidingDirectionEnum.Left)}},{key:"resetSlider",value:function(){this.setCurrentSlide(this._slidesPlaylist.firstSlideIndex)}},{key:"setVolume",value:function(volume){this._slidesPlaylist&&this._slidesPlaylist.slides.forEach(function(slide){slide.media.type===protos.ProtoMediaTypeEnum.Video&&(slide.media.volume=volume)})}},{key:"play",value:function(){this._isPlaying=!0,this._timer.start(),this._slidesPlaylist.currentSlide.media.play()}},{key:"pause",value:function(){this._isPlaying=!1,this._timer.stop(),this._slidesPlaylist.currentSlide.media.pause()}},{key:"stop",value:function(){this._slidesPlaylist.setCurrentSlide(this._slidesPlaylist.firstSlideIndex),this._prepareCurrentSlide(),this.pause(),this._slidingHelper.setCurrentSlide(this._slidesPlaylist.currentSlide.$container,null,!1)}},{key:"setQuality",value:function(qualitySettings){this._slidesPlaylist.slides.forEach(function(slide){if(slide.media.type===protos.ProtoMediaTypeEnum.Video){var newQualitySettings={height:slide.media.getClosestSourceQuality(qualitySettings.height).videoHeight,quality:qualitySettings.quality};slide.media.setQuality(newQualitySettings)}})}},{key:"getQuality",value:function(){var currentSlide=this._slidesPlaylist.currentSlide;if(currentSlide.media.type!==protos.ProtoMediaTypeEnum.Image){var _currentSlide$media=currentSlide.media;return(0,_currentSlide$media.getClosestSourceQuality)(_currentSlide$media.currentQuality.height).videoHeight}}},{key:"start",value:function(slides){try{this._setSlides(slides),this._initSlidingHelper(),this._addPageFocusService()}catch(e){Object(Logging.a)({message:"SlidesManager_start",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.FATAL})}}},{key:"offsetSlides",value:function(offsetValue){if(this._removeAdjacentSlidesNextClass(),0!==offsetValue){var $upcomingSlideContainer=this._getUpcomingSlideContainer(offsetValue);this._slidingHelper.offsetSlides(offsetValue,$upcomingSlideContainer)}}},{key:"destroy",value:function(){this._timer.disable(),this._slidingHelper&&this._slidingHelper.destroy()}},{key:"onPlayerContainerResize",value:function(){Object(TypeUtils.a)(this._slidesPlaylist)&&Object(ArrayUtils.h)(this._slidesPlaylist.slides)&&this._slidesPlaylist.slides.forEach(function(slide){return slide.media.onSlideResizeCallback()})}},{key:"updateCapabilityMetadata",value:function(slideIndex,capability){if(Object(TypeUtils.a)(this._slidesPlaylist)&&Object(ArrayUtils.h)(this._slidesPlaylist.slides)){var slide=this._slidesPlaylist.slides[slideIndex];slide&&slide.updateCapabilityMetadata(capability)}}},{key:"remainingTime",get:function(){return this._timer.timeRemaining}},{key:"isPlaying",get:function(){return this._isPlaying}},{key:"slides",get:function(){return Object(TypeUtils.a)(this._slidesPlaylist)&&Object(ArrayUtils.h)(this._slidesPlaylist.slides)?this._slidesPlaylist.slides:[]}},{key:"currentSlideIndex",get:function(){return Object(TypeUtils.a)(this._slidesPlaylist)?this._slidesPlaylist.currentSlideIndex:0}},{key:"slidesMetadata",get:function(){return this._slidesMeta}}]),SlidesManager}(Mediator.a),ProtoModels_Generated_protos=__webpack_require__(18),PlayspaceTemplate_PlayspaceTemplate=function(){function PlayspaceTemplate(_templateSettings){classCallCheck_default()(this,PlayspaceTemplate),this._templateSettings=_templateSettings}return createClass_default()(PlayspaceTemplate,[{key:"_getProgressBarComponent",value:function(){return this._templateSettings.disableStoryProgressBarRendering?"":"[[".concat(UiComponentsEnum.PlayspaceProgressBar,"]]")}},{key:"_getSlideTitleComponent",value:function(){return this._templateSettings.disableTitleRendering?"":"[[".concat(UiComponentsEnum.SlideTitle,"]]")}},{key:"template",get:function(){return'\n        <cnx class="cnx-ui cnx-ui-ps">\n            <cnx class="cnx-ui-click-to-play-overlay"></cnx>\n            <cnx class="'.concat(CSSClassMainPlayspaceEnum.Content,'">\n                [[').concat(UiComponentsEnum.ClickToPlayButton,']]\n                <cnx class="cnx-ui-ratio-container">\n                    <cnx class="cnx-ui-ps-head">\n                    <cnx class="cnx-ui-ps-nav">\n                        ').concat(this._getProgressBarComponent(),'\n                    </cnx>\n                    <cnx class="cnx-ui-ps-subhead cnx-ui-ps-side-mg">\n                        <cnx class="cnx-ui-ps-branding">\n                            [[').concat(UiComponentsEnum.TopTitle,']]\n                        </cnx>\n                        <cnx class="cnx-ui-ps-btns">\n                            <cnx class="cnx-ui-btn ').concat(CssClassesConfig.g.ContextController,'">[[').concat(UiComponentsEnum.MoreButton,']]</cnx>\n                            <cnx class="cnx-ui-btn cnx-close-button">[[').concat(UiComponentsEnum.CloseButton,']]</cnx>\n                        </cnx>\n                    </cnx>\n                </cnx>\n                <cnx class="cnx-ui-ps-controls--wrapper cnx-ui-ps-side-mg">\n                    <cnx class="cnx-ui-ps-controls">\n                        <cnx class="cnx-ui-btn cnx-ui-ps-nav-btn">[[').concat(UiComponentsEnum.PreviousButton,']]</cnx>\n                        <cnx class="cnx-ui-btn">[[').concat(UiComponentsEnum.PlayButton,']]</cnx>\n                        <cnx class="cnx-ui-btn cnx-ui-ps-nav-btn">[[').concat(UiComponentsEnum.UpNextButton,']]</cnx>\n                        <cnx class="cnx-ui-btn">[[').concat(UiComponentsEnum.VolumeButton,']]</cnx>\n                    </cnx>\n                </cnx>\n                <cnx class="cnx-ui-ps-footer cnx-ui-ps-side-mg"></cnx>\n                [[').concat(UiComponentsEnum.PlayspaceSettingsMenu,']]\n                </cnx>\n            </cnx>\n            <cnx class="').concat(CSSClassMainPlayspaceEnum.Footer,'">\n                <cnx class="cnx-ui-ps-content cnx-ui-ps-side-mg">\n                    ').concat(this._getSlideTitleComponent(),"\n                </cnx>\n            </cnx>\n            [[").concat(UiComponentsEnum.Loader,"]]\n        </cnx>\n        ").trim()}}]),PlayspaceTemplate}();function SlideItemProgressBar_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var SlideItemProgressBar_SlideItemProgressBar=function(_AProgressComponent){inherits_default()(SlideItemProgressBar,_AProgressComponent);var _super=SlideItemProgressBar_createSuper(SlideItemProgressBar);function SlideItemProgressBar(){var _this;return classCallCheck_default()(this,SlideItemProgressBar),(_this=_super.apply(this,arguments))._fullProgressPercentage=100,_this.eventList=[UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Scroll]],_this.isEndState=!1,_this._onClickHandler=function(){_this.mediator.publish(assertThisInitialized_default()(_this),UiPlayspaceEventsEnum.ProgressBarItemClicked,{payload:_this._$container})},_this._onBeforeClickHandler=function(e){e.stopPropagation()},_this}return createClass_default()(SlideItemProgressBar,[{key:"_getCurrentProgress",value:function(){var progressPixels=this._globalDomUtils.getComputedTranslateX(this._$railFill),fromEnd=this._railFullWidth;return Object(NumberUtils.g)(0,fromEnd,0,100,progressPixels)}},{key:"_addTransition",value:function(duration){Object(DomUtils.Q)(this._$railFill,{transition:"transform ".concat(duration,"ms linear")})}},{key:"_removeTransition",value:function(){Object(DomUtils.Q)(this._$railFill,{transition:"none"})}},{key:"startProgress",value:function(duration){this._addTransition(duration),this.setProgress(this._fullProgressPercentage)}},{key:"pauseProgress",value:function(){this.setProgress(this._getCurrentProgress()),this._removeTransition()}},{key:"forceEndState",value:function(){this._removeTransition(),get_default()(getPrototypeOf_default()(SlideItemProgressBar.prototype),"forceEndState",this).call(this),this.isEndState=!0}},{key:"forceStartState",value:function(){this._removeTransition(),get_default()(getPrototypeOf_default()(SlideItemProgressBar.prototype),"forceStartState",this).call(this),this.isEndState=!1}},{key:"initComponent",value:function(){var _this2=this;get_default()(getPrototypeOf_default()(SlideItemProgressBar.prototype),"initComponent",this).call(this);var callbackConfig={click:this._onClickHandler,interactionstart:this._onBeforeClickHandler};this._interactionService.register(this._$container,this,this._interactionService,callbackConfig),this._isMobile&&(this.subscribe(UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Click],this._interactionService,function(){_this2._onClickHandler()}),this.relay(UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Scroll],this._interactionService,this,this.mediator))}},{key:"destroy",value:function(){get_default()(getPrototypeOf_default()(SlideItemProgressBar.prototype),"destroy",this).call(this)}},{key:"onResize",value:function(remainingTime,isPlaying){this.setProgress(this._getCurrentProgress()),this._removeTransition(),isPlaying&&(this.setProgress(this._fullProgressPercentage),this._addTransition(remainingTime))}}]),SlideItemProgressBar}(AProgressComponent_AProgressComponent),progressBarTemplate=__webpack_require__(200),progressBarTemplate_default=__webpack_require__.n(progressBarTemplate);function PlayspaceProgressBar_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var PlayspaceProgressBar_PlayspaceProgressBar=function(_ABaseComponent){inherits_default()(PlayspaceProgressBar,_ABaseComponent);var _super=PlayspaceProgressBar_createSuper(PlayspaceProgressBar);function PlayspaceProgressBar(){var _this;return classCallCheck_default()(this,PlayspaceProgressBar),(_this=_super.apply(this,arguments)).eventList=[UiPlayspaceEventsEnum.ProgressBarItemClicked,UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Scroll]],_this._slides=[],_this._onSlideItemClicked=function(_ref){var $slideContainer=_ref.payload,index=Object(DomUtils.k)($slideContainer,_this._$container);_this.mediator.publish(assertThisInitialized_default()(_this),UiPlayspaceEventsEnum.ProgressBarItemClicked,{payload:index})},_this}return createClass_default()(PlayspaceProgressBar,[{key:"_restartSlide",value:function(index){var currentSlide=this._slides[index];currentSlide.forceStartState(),currentSlide.startProgress(this._duration)}},{key:"startProgress",value:function(){if(Object(TypeUtils.a)(this._currentIndex)){for(var i=0;i<this._slides.length;i++)i<this._currentIndex?this._slides[i].forceEndState():(i!==this._currentIndex||this._slides[i].isEndState)&&this._slides[i].forceStartState();this._slides[this._currentIndex].startProgress(this._duration)}}},{key:"pauseProgress",value:function(){this._slides[this._currentIndex]&&this._slides[this._currentIndex].pauseProgress()}},{key:"resetProgress",value:function(){Object(TypeUtils.a)(this._currentIndex)&&this._slides.forEach(function(slide){return slide.forceStartState()})}},{key:"setSlides",value:function(numberOfSlides){if(!numberOfSlides)throw new Error("PlayspaceProgressBar: no slides provided");for(var i=0;i<numberOfSlides;i++){var slideComponent=new SlideItemProgressBar_SlideItemProgressBar(this,this._globalDomUtils,this._interactionService,progressBarTemplate_default.a,this._isMobile);this.subscribe(UiPlayspaceEventsEnum.ProgressBarItemClicked,slideComponent,this._onSlideItemClicked),this.relay(UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Scroll],slideComponent,this,this.mediator),this._slides.push(slideComponent),slideComponent.initComponent(),this._$container.appendChild(slideComponent.getContainer())}}},{key:"setDuration",value:function(duration){this._duration=duration}},{key:"setCurrentIndex",value:function(index){index===this._currentIndex&&this._restartSlide(index),this._currentIndex=index}},{key:"initComponent",value:function(){}},{key:"destroy",value:function(){get_default()(getPrototypeOf_default()(PlayspaceProgressBar.prototype),"destroy",this).call(this),this._slides.forEach(function(slide){return slide.destroy()})}},{key:"resizeProgressBar",value:function(remainingTime,isPlaying){var _this2=this;this._slides.forEach(function(slide,index){index<_this2._currentIndex&&slide.forceEndState(),index===_this2._currentIndex&&slide.onResize(remainingTime,isPlaying)})}}]),PlayspaceProgressBar}(ABaseComponent_ABaseComponent),playspaceProgressBarTemplate=__webpack_require__(201),playspaceProgressBarTemplate_default=__webpack_require__.n(playspaceProgressBarTemplate),rightArrow=__webpack_require__(126),rightArrow_default=__webpack_require__.n(rightArrow);function SubmenuMenuItem_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}function QualitySubmenuMenuItem_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var QualitySubmenuMenuItem_QualitySubmenuMenuItem=function(_SubmenuMenuItem){inherits_default()(QualitySubmenuMenuItem,_SubmenuMenuItem);var _super=QualitySubmenuMenuItem_createSuper(QualitySubmenuMenuItem);function QualitySubmenuMenuItem(mediator,globalDomUtils,interactionService,isMobile,name){var _this;return classCallCheck_default()(this,QualitySubmenuMenuItem),(_this=_super.call(this,mediator,globalDomUtils,interactionService,isMobile,{event:UiComponentEventsEnum[UiComponentEventsEnum.Quality],name:name,icon:settingsButtonTemplate_default.a,options:[]})).mediator=mediator,_this._currentQuality={height:360,quality:VideoQualityEnum.Auto},_this._isAutoSelected=!0,_this}return createClass_default()(QualitySubmenuMenuItem,[{key:"handleItemsEvents",value:function(event){if(event!==UiComponentEventsEnum[UiComponentEventsEnum.Quality]){this._isAutoSelected=event===VideoQualityEnum[VideoQualityEnum.Auto];var payload={height:this._isAutoSelected?this._currentQuality.height:parseInt(event,10),quality:this._isAutoSelected?VideoQualityEnum.Auto:VideoQualityEnum.Strict};this.mediator.publish(this,this.event,{payload:payload})}}},{key:"_updateQualitySubmenuLabel",value:function(){var _this2=this,labelName=null;if(this._isAutoSelected)labelName=VideoQualityEnum[VideoQualityEnum.Auto];else{var selectedQuality=this._qualitySubmenuItems.find(function(item){return item.event===_this2._currentQuality.height.toString()});selectedQuality&&(labelName=selectedQuality.name)}labelName&&this.changeLabel(labelName)}},{key:"updateQuality",value:function(qualitySettings){var isHD=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(ArrayUtils.h)(this._availableQualities)&&(this._isAutoSelected=qualitySettings.quality===VideoQualityEnum.Auto,this._currentQuality.quality=qualitySettings.quality,this._currentQuality.height=Object(NumberUtils.c)(qualitySettings.height,this._availableQualities.map(function(elem){return elem.videoHeight})),this._updateQualitySubmenuLabel(),onUpdateQuality(this._qualitySubmenuItems,this._currentQuality,this._isAutoSelected),this.isActive=isHD)}},{key:"updateAvailableQualities",value:function(availableQualities){var _this3=this;this._qualitySubmenuItems=[],this._availableQualities=availableQualities,this._qualitySubmenuItems=this._availableQualities.map(function(quality){return new SimpleMenuItem_SimpleMenuItem(_this3,_this3._globalDomUtils,_this3._interactionService,_this3._isMobile,{name:"".concat(quality.videoHeight,"p"),activeEvent:quality.videoHeight.toString(),label:quality.isHD?"HD":void 0})}),this._qualitySubmenuItems.push(new SimpleMenuItem_SimpleMenuItem(this,this._globalDomUtils,this._interactionService,this._isMobile,{name:VideoQualityEnum[VideoQualityEnum.Auto],activeEvent:VideoQualityEnum[VideoQualityEnum.Auto]})),this._updateQualitySubmenuLabel(),onUpdateQuality(this._qualitySubmenuItems,this._currentQuality,this._isAutoSelected),this.buildContextMenu(this._qualitySubmenuItems)}}]),QualitySubmenuMenuItem}(function(_AClickComponent){inherits_default()(SubmenuMenuItem,_AClickComponent);var _super=SubmenuMenuItem_createSuper(SubmenuMenuItem);function SubmenuMenuItem(mediator,globalDomUtils,interactionService,isMobile,data){var _this;return classCallCheck_default()(this,SubmenuMenuItem),(_this=_super.call(this,mediator,globalDomUtils,interactionService,SubmenuMenuItem.getTemplate(data),isMobile)).mediator=mediator,_this._currentMenuOptions=[],_this._isActive=!1,_this.type=MenuOptionsTypeEnum.SubmenuMenuItem,_this.eventList=[],_this.isOpen=!1,_this.event=data.event,_this.eventList.push(_this.event),_this._titleOption=new SimpleMenuItem_SimpleMenuItem(assertThisInitialized_default()(_this),globalDomUtils,interactionService,isMobile,{activeEvent:data.event,name:data.name.toUpperCase(),icon:""}),_this.$menuContainer=_this._globalDomUtils.createElementByString('<cnx class="'.concat(CssClassesConfig.k.Items,'"></cnx>')),_this._$labelContainer=_this._$container.getElementsByClassName(CssClassesConfig.k.ItemExtra)[0],_this}return createClass_default()(SubmenuMenuItem,[{key:"onClickHandler",value:function(event){this.mediator.publish(this,this.event)}},{key:"handleItemsEvents",value:function(event){this.mediator.publish(this,this.event,{payload:event===this.event?void 0:event})}},{key:"buildContextMenu",value:function(options){var _this2=this;this.$menuContainer.innerHTML="",this._currentMenuOptions.forEach(function(item){return _this2.unsubscribeAll(item)}),this._currentMenuOptions=[this._titleOption].concat(toConsumableArray_default()(options)),this._currentMenuOptions.forEach(function(item){item.eventList.forEach(function(event){return _this2.subscribe(event,item,function(){return _this2.handleItemsEvents(event)})}),item.initComponent(),_this2.$menuContainer.appendChild(item.getContainer())})}},{key:"changeLabel",value:function(label){this._$labelContainer.innerHTML="".concat(label).concat(rightArrow_default.a)}},{key:"isActive",get:function(){return this._isActive},set:function(active){this._isActive=active,this._isActive?Object(DomUtils.a)(this._$container,CssClassesConfig.h.Active):Object(DomUtils.L)(this._$container,CssClassesConfig.h.Active)}}],[{key:"getTemplate",value:function(options){var icon='<cnx class="'.concat(CssClassesConfig.k.ItemIcon,'">').concat(options.icon,"</cnx>");return'<cnx class="'.concat(CssClassesConfig.k.SubmenuOption,'">\n                    ').concat(options.icon?icon:"",'\n                    <cnx class="').concat(CssClassesConfig.k.ItemTitle,'">').concat(options.name,'</cnx>\n                    <cnx class="').concat(CssClassesConfig.k.ItemExtra," ").concat(CssClassesConfig.f.AccentColor,'">').concat(options.label?options.label:"").concat(rightArrow_default.a,"</cnx>\n                </cnx>")}}]),SubmenuMenuItem}(AClickComponent_AClickComponent)),svg_expand=__webpack_require__(127),expand_default=__webpack_require__.n(svg_expand),svg_collapse=__webpack_require__(202),collapse_default=__webpack_require__.n(svg_collapse),PlayspaceComponentLabelsEnum_ContextAbout="About Connatix",PlayspaceComponentLabelsEnum_ContextQuality="Video Settings",PlayspaceComponentLabelsEnum_ContextExpand="Full Screen";function PlayspaceSettingsMenu_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var SlideCapabilityTypeEnum,SlideTitleTypeEnum,PlayspaceSettingsMenu_PlayspaceSettingsMenu=function(_AContextMenuComponen){inherits_default()(PlayspaceSettingsMenu,_AContextMenuComponen);var _super=PlayspaceSettingsMenu_createSuper(PlayspaceSettingsMenu);function PlayspaceSettingsMenu(mediator,globalDomUtils,interactionService,template,eventName,menuComponent,$parentContainer,isMobile){var _this;return classCallCheck_default()(this,PlayspaceSettingsMenu),(_this=_super.call(this,mediator,globalDomUtils,interactionService,template,eventName,menuComponent,$parentContainer,isMobile)).alignMiddle=!1,_this.alignTop=!1,_this.forceRight=!1,_this}return createClass_default()(PlayspaceSettingsMenu,[{key:"initComponent",value:function(){this._fullScreenItem=new SimpleMenuItem_SimpleMenuItem(this,this._globalDomUtils,this._interactionService,this._isMobile,{activeEvent:UiComponentEventsEnum[UiComponentEventsEnum.Expand],eventList:[UiComponentEventsEnum[UiComponentEventsEnum.Expand],UiComponentEventsEnum[UiComponentEventsEnum.Collapse]],icon:expand_default.a,name:PlayspaceComponentLabelsEnum_ContextExpand}),this._qualityItem=new QualitySubmenuMenuItem_QualitySubmenuMenuItem(this,this._globalDomUtils,this._interactionService,this._isMobile,PlayspaceComponentLabelsEnum_ContextQuality),this.buildContextMenu([this._qualityItem,this._fullScreenItem,new SimpleMenuItem_SimpleMenuItem(this,this._globalDomUtils,this._interactionService,this._isMobile,{activeEvent:UiComponentEventsEnum[UiComponentEventsEnum.AboutClick],name:PlayspaceComponentLabelsEnum_ContextAbout,icon:connatixLogo_default.a,label:EnvironmentConfig.a.version?"V".concat(EnvironmentConfig.a.version):"dev"})])}},{key:"setExpand",value:function(){this._fullScreenItem.event=UiComponentEventsEnum[UiComponentEventsEnum.Collapse],this._fullScreenItem.changeItemIcon(collapse_default.a)}},{key:"setCollapse",value:function(){this._fullScreenItem.event=UiComponentEventsEnum[UiComponentEventsEnum.Expand],this._fullScreenItem.changeItemIcon(expand_default.a)}},{key:"showExpandButton",value:function(){this._fullScreenItem.showComponent()}},{key:"hideExpandButton",value:function(){this._fullScreenItem.hideComponent()}},{key:"updateQualityMenu",value:function(availableQualities){Object(ArrayUtils.h)(availableQualities)?(this._qualityItem.updateAvailableQualities(availableQualities),this._qualityItem.showComponent()):this._qualityItem.hideComponent()}},{key:"updateQuality",value:function(qualitySettings){var isHD=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._qualityItem.updateQuality(qualitySettings,isHD)}}]),PlayspaceSettingsMenu}(AContextMenuComponent_AContextMenuComponent),playspaceSettingsMenuTemplate=__webpack_require__(203),playspaceSettingsMenuTemplate_default=__webpack_require__.n(playspaceSettingsMenuTemplate),volumeButtonHoverableTemplate=__webpack_require__(204),volumeButtonHoverableTemplate_default=__webpack_require__.n(volumeButtonHoverableTemplate);!function(SlideCapabilityTypeEnum){SlideCapabilityTypeEnum[SlideCapabilityTypeEnum.VolumeControls=0]="VolumeControls",SlideCapabilityTypeEnum[SlideCapabilityTypeEnum.PlaybackControls=1]="PlaybackControls",SlideCapabilityTypeEnum[SlideCapabilityTypeEnum.PlaylistControls=2]="PlaylistControls",SlideCapabilityTypeEnum[SlideCapabilityTypeEnum.CtaButton=3]="CtaButton",SlideCapabilityTypeEnum[SlideCapabilityTypeEnum.SlideTitle=4]="SlideTitle",SlideCapabilityTypeEnum[SlideCapabilityTypeEnum.TopLogo=5]="TopLogo",SlideCapabilityTypeEnum[SlideCapabilityTypeEnum.TopStoryTitle=6]="TopStoryTitle",SlideCapabilityTypeEnum[SlideCapabilityTypeEnum.TopSlideTitle=7]="TopSlideTitle",SlideCapabilityTypeEnum[SlideCapabilityTypeEnum.TextLabel=8]="TextLabel"}(SlideCapabilityTypeEnum||(SlideCapabilityTypeEnum={})),function(SlideTitleTypeEnum){SlideTitleTypeEnum[SlideTitleTypeEnum.Default=0]="Default",SlideTitleTypeEnum[SlideTitleTypeEnum.Description=1]="Description",SlideTitleTypeEnum[SlideTitleTypeEnum.Quote=2]="Quote",SlideTitleTypeEnum[SlideTitleTypeEnum.Bullet=3]="Bullet",SlideTitleTypeEnum[SlideTitleTypeEnum.Cover=4]="Cover",SlideTitleTypeEnum[SlideTitleTypeEnum.Instagram=5]="Instagram"}(SlideTitleTypeEnum||(SlideTitleTypeEnum={}));var CSSClassCtaButtonEnum_TimerLabel="cnx-cta-btn-timer-label",CSSClassCtaButtonEnum_TimerLoader="cnx-svg-circle-stroke",CSSClassCtaButtonEnum_TextLabel="cnx-cta-btn-text",CSSClassCtaButtonEnum_TextContainer="cnx-cta-btn-content",CSSClassCtaButtonEnum_AlignWithContent="cnx-cta-align-with-content";function CtaButton_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var CtaButton_CtaButton=function(_AClickComponent){inherits_default()(CtaButton,_AClickComponent);var _super=CtaButton_createSuper(CtaButton);function CtaButton(mediator,_globalDomUtils,interactionService,_resizeObserver,_templateInstance,_isMobile,_disableClickUrl){var _this;return classCallCheck_default()(this,CtaButton),(_this=_super.call(this,mediator,_globalDomUtils,interactionService,_templateInstance.template,_isMobile))._resizeObserver=_resizeObserver,_this._templateInstance=_templateInstance,_this._disableClickUrl=_disableClickUrl,_this.eventList=[UiPlayspaceEventsEnum.CallToAction,UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Scroll]],_this._hasProgress=!1,_this._alignToFooter=!1,_this._resizeObserverInitialized=!1,_this._onResize=function(){_this._adjustDynamicBottom()},_this._onTimeUpdate=function(){var duration=Math.round(_this._timer.timeRemaining/TimeConfig.f);_this._setTimerLabel(duration.toString())},_this._$anchorTag=_this._$container.querySelector(".cnx-ui-ps-cta"),_this}return createClass_default()(CtaButton,[{key:"startProgress",value:function(){this._hasProgress=!0,this._timer&&(this._timer.start(),this._onTimeUpdate())}},{key:"pauseProgress",value:function(){this._hasProgress=!1,this._timer&&(this._timer.stop(),this._onTimeUpdate())}},{key:"changeLabel",value:function(label){Object(TypeUtils.h)(label)&&(this._$label.innerHTML=label.substring(0,16))}},{key:"initComponent",value:function(){get_default()(getPrototypeOf_default()(CtaButton.prototype),"initComponent",this).call(this),this._$label=this._$container.querySelector(".".concat(CSSClassCtaButtonEnum_TextLabel)),this._$labelContainer=this._$container.querySelector(".".concat(CSSClassCtaButtonEnum_TextContainer))}},{key:"onSlideTimeUpdate",value:function(){}},{key:"onSlideTransitionEnd",value:function(){}},{key:"onSlideTransitionStart",value:function(capabilityList){if(Object(ArrayUtils.h)(capabilityList)){var capability=capabilityList.find(function(_ref){return _ref.type===SlideCapabilityTypeEnum.CtaButton});if(capability&&capability.metadata){var _capability$metadata=capability.metadata,url=_capability$metadata.url,label=_capability$metadata.label,duration=_capability$metadata.duration,ctaAlignToContent=_capability$metadata.ctaAlignToContent,ctaAlignToFooter=_capability$metadata.ctaAlignToFooter,title=_capability$metadata.title;this._alignToFooter=ctaAlignToFooter,this._changeUrl(url,title),this.changeLabel(label);var hasTimer=Object(TypeUtils.e)(duration);this._toggleTimerContainer(hasTimer),this._setTimerTime(hasTimer,duration),this._setAlignToContent(ctaAlignToContent),this._initResizeObserver()}}}},{key:"setFooterElement",value:function(footer){this._$footer=footer,this._initResizeObserver()}},{key:"handleCapabilities",value:function(capabilityList){this.onSlideTransitionStart(capabilityList)}},{key:"hideComponent",value:function(){get_default()(getPrototypeOf_default()(CtaButton.prototype),"hideComponent",this).call(this),this._destroyTimer()}},{key:"_setAlignToContent",value:function(enable){enable?Object(DomUtils.a)(this._$anchorTag,CSSClassCtaButtonEnum_AlignWithContent):Object(DomUtils.L)(this._$anchorTag,CSSClassCtaButtonEnum_AlignWithContent)}},{key:"onClickHandler",value:function(){var data={payload:null};Object(TypeUtils.h)(this._url)&&(data.payload=this._url),this.mediator.publish(this,UiPlayspaceEventsEnum.CallToAction,data)}},{key:"_initResizeObserver",value:function(){this._resizeObserverInitialized||this._$footer&&this._alignToFooter&&(this._resizeObserver.on(this._$footer,this._onResize),this._resizeObserverInitialized=!0)}},{key:"_adjustDynamicBottom",value:function(){if(this._$footer){var bottomHeight=(this._$footer.clientHeight-this._$container.clientHeight)/2*-1;Object(DomUtils.Q)(this._$container,{bottom:"".concat(bottomHeight,"px")})}else Object(DomUtils.N)(this._$container,"bottom")}},{key:"_toggleTimerContainer",value:function(show){show?this._$timerContainer||this._addTimerContainer():this._removeTimerContainer()}},{key:"_addTimerContainer",value:function(){this._$timerContainer=this._globalDomUtils.createElementByString(this._templateInstance.getTimerTemplate()),Object(DomUtils.x)(this._$labelContainer,this._$timerContainer),this._cacheTimerElements(this._$timerContainer)}},{key:"_cacheTimerElements",value:function($timerContainer){this._$timerLabel=$timerContainer.querySelector(".".concat(CSSClassCtaButtonEnum_TimerLabel)),this._$timerLoader=$timerContainer.querySelector(".".concat(CSSClassCtaButtonEnum_TimerLoader))}},{key:"_removeTimerContainer",value:function(){Object(DomUtils.M)(this._$timerContainer),this._$timerContainer=null,this._$timerLabel=null,this._$timerLoader=null}},{key:"_setTimerTime",value:function(hasTimer,duration){hasTimer?(this._initTimerUtil(),this._timer.reset(duration*TimeConfig.f),this._setTimerLabel(duration.toString()),this._hasProgress&&this._timer.start(),this._restartTimerLoaderAnimation(),Object(DomUtils.Q)(this._$timerLoader,{"animation-duration":"".concat(duration,"s")})):this._destroyTimer()}},{key:"_initTimerUtil",value:function(){this._timer||(this._timer=new Timer_Timer,this._onTimeUpdateSubscription=this._timer.onTimeUpdate.subscribe(this._onTimeUpdate))}},{key:"_destroyTimer",value:function(){this._timer&&(this._onTimeUpdateSubscription.unsubscribe(),this._timer.disable(),this._timer=null)}},{key:"_restartTimerLoaderAnimation",value:function(){Object(DomUtils.O)(this._$timerLoader,CSSClassCtaButtonEnum_TimerLoader,CSSClassCtaButtonEnum_TimerLoader,!0)}},{key:"_setTimerLabel",value:function(label){this._$timerLabel&&Object(TypeUtils.h)(label)&&(this._$timerLabel.innerText=label)}},{key:"_changeUrl",value:function(url,title){if(this._url=url,url&&(this._$anchorTag.title=title,!this._disableClickUrl)){this._$anchorTag.href=url;var isSameDomain=this._globalDomUtils.isURLSameDomainToTop(url);this._$anchorTag.target=isSameDomain?BrowserConfig.c.Top:BrowserConfig.c.Blank,this._$anchorTag.rel="nofollow"}}}]),CtaButton}(AClickComponent_AClickComponent),circle=__webpack_require__(128),circle_default=__webpack_require__.n(circle),instagram_logo=__webpack_require__(205),instagram_logo_default=__webpack_require__.n(instagram_logo),readMoreArrow=__webpack_require__(206),readMoreArrow_default=__webpack_require__.n(readMoreArrow),CtaButtonTemplate_CtaButtonTemplate=function(){function CtaButtonTemplate(){classCallCheck_default()(this,CtaButtonTemplate)}return createClass_default()(CtaButtonTemplate,[{key:"getTimerTemplate",value:function(){return'\n            <cnx class="cnx-cta-btn-timer-container">\n                <cnx class="cnx-cta-btn-timer-loader-wrapper">\n                    '.concat(circle_default.a,"\n                    ").concat(circle_default.a,'\n                </cnx>\n                <cnx class="cnx-cta-btn-timer-label-wrapper">\n                    <cnx class="').concat(CSSClassCtaButtonEnum_TimerLabel,'">\n                    </cnx>\n                </cnx>\n            </cnx>\n        ').trim()}},{key:"template",get:function(){return'\n        <cnx class="cnx-ui-ps-cta-placeholder">\n            <a class="cnx-ui-ps-cta">\n                <cnx class="cnx-cta-btn cnx-color-accent">\n                    <cnx class="cnx-cta-btn-container">\n                        <cnx class="cnx-cta-btn-content">\n                            <cnx-span class="cnx-cta-btn-instagram">\n                                '.concat(instagram_logo_default.a,'\n                            </cnx-span>\n                            <cnx-span class="cnx-cta-btn-text">\n                                READ MORE\n                            </cnx-span>\n                            <cnx-span class="cnx-cta-btn-arrow">\n                                ').concat(readMoreArrow_default.a,"\n                            </cnx-span>\n                        </cnx>\n                    </cnx>\n                </cnx>\n            </a>\n        </cnx>\n        ").trim()}}]),CtaButtonTemplate}();function ClickToPlayButton_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var _TopTitleComponentsMa,_TopTitleSlideCapabil,TopTitleComponentsEnum,ClickToPlayButton_ClickToPlayButton=function(_AClickComponent){inherits_default()(ClickToPlayButton,_AClickComponent);var _super=ClickToPlayButton_createSuper(ClickToPlayButton);function ClickToPlayButton(){var _this;return classCallCheck_default()(this,ClickToPlayButton),(_this=_super.apply(this,arguments)).eventList=[UiComponentEventsEnum[UiComponentEventsEnum.Play]],_this}return createClass_default()(ClickToPlayButton,[{key:"onClickHandler",value:function(){this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Play])}}]),ClickToPlayButton}(AClickComponent_AClickComponent),clickToPlayButtonTemplate=__webpack_require__(207),clickToPlayButtonTemplate_default=__webpack_require__.n(clickToPlayButtonTemplate);!function(TopTitleComponentsEnum){TopTitleComponentsEnum[TopTitleComponentsEnum.TopLogo=0]="TopLogo",TopTitleComponentsEnum[TopTitleComponentsEnum.TopSlideTitle=1]="TopSlideTitle",TopTitleComponentsEnum[TopTitleComponentsEnum.TopStoryTitle=2]="TopStoryTitle"}(TopTitleComponentsEnum||(TopTitleComponentsEnum={}));var TopTitleComponentsMap=(_TopTitleComponentsMa={},defineProperty_default()(_TopTitleComponentsMa,SlideCapabilityTypeEnum.TopLogo,TopTitleComponentsEnum.TopLogo),defineProperty_default()(_TopTitleComponentsMa,SlideCapabilityTypeEnum.TopSlideTitle,TopTitleComponentsEnum.TopSlideTitle),defineProperty_default()(_TopTitleComponentsMa,SlideCapabilityTypeEnum.TopStoryTitle,TopTitleComponentsEnum.TopStoryTitle),_TopTitleComponentsMa),TopTitleSlideCapabilityTypeMap=(_TopTitleSlideCapabil={},defineProperty_default()(_TopTitleSlideCapabil,TopTitleComponentsEnum.TopLogo,SlideCapabilityTypeEnum.TopLogo),defineProperty_default()(_TopTitleSlideCapabil,TopTitleComponentsEnum.TopSlideTitle,SlideCapabilityTypeEnum.TopSlideTitle),defineProperty_default()(_TopTitleSlideCapabil,TopTitleComponentsEnum.TopStoryTitle,SlideCapabilityTypeEnum.TopStoryTitle),_TopTitleSlideCapabil);function TopTitle_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var CSSClassSlideTitleEnum,CSSClassSlideTitleAnimationEnum,CSSClassSlideTitleTypesEnum,ALL_TITLE_COMPONENTS=[TopTitleComponentsEnum.TopLogo,TopTitleComponentsEnum.TopStoryTitle,TopTitleComponentsEnum.TopSlideTitle],TopTitle_TopTitle=function(_AMasterComponent){inherits_default()(TopTitle,_AMasterComponent);var _super=TopTitle_createSuper(TopTitle);function TopTitle(mediator,_globalDomUtils,template,factory){var _this;return classCallCheck_default()(this,TopTitle),(_this=_super.call(this,mediator,_globalDomUtils,template,factory)).eventList=[UiComponentEventsEnum[UiComponentEventsEnum.LogoClicked],UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Scroll]],_this._currentTitleComponents=[],_this._capabilities={},_this._$titlesContainer=_this._$container.querySelector(".".concat(CSSClassTopArticleComponentEnum.TitlesContainer)),_this}return createClass_default()(TopTitle,[{key:"triggerLogoAnimation",value:function(){var topLogo=this.getComponent(UiComponentsEnum.TopLogo);topLogo&&topLogo.triggerLogoAnimation()}},{key:"onSlideTransitionStart",value:function(capabilityList){var capabilities=this._convertCapabilityList(capabilityList);this._capabilities=Object.assign({},capabilities),this._toggleComponents(capabilityList)}},{key:"onSlideTransitionEnd",value:function(){}},{key:"onSlideTimeUpdate",value:function(elapsedTime,totalDuration){}},{key:"handleComponentEvent",value:function(eventName,eventData,component){this.mediator.publish(this,eventName,eventData)}},{key:"_getCurrentComponents",value:function(capabilityList){return capabilityList.map(function(_ref){var type=_ref.type;return TopTitleComponentsMap[type]}).filter(function(component){return Object(TypeUtils.a)(component)})}},{key:"_convertCapabilityList",value:function(capabilityList){var _this2=this;return capabilityList.reduce(function(acc,_ref2){var type=_ref2.type,metadata=_ref2.metadata;switch(type){case TopTitleSlideCapabilityTypeMap[TopTitleComponentsEnum.TopStoryTitle]:if(!metadata.label&&!metadata.useFallbackLabel)return acc;var title=metadata.label||"Top Articles";return Object.assign(Object.assign({},acc),defineProperty_default()({},TopTitleComponentsEnum[TopTitleComponentsEnum.TopStoryTitle],_this2._getTitleCapabilityMetadata(title,metadata.useTransition)));case TopTitleSlideCapabilityTypeMap[TopTitleComponentsEnum.TopSlideTitle]:return Object.assign(Object.assign({},acc),defineProperty_default()({},TopTitleComponentsEnum[TopTitleComponentsEnum.TopSlideTitle],_this2._getTitleCapabilityMetadata(metadata.label,metadata.useTransition)));case TopTitleSlideCapabilityTypeMap[TopTitleComponentsEnum.TopLogo]:return Object.assign(Object.assign({},acc),defineProperty_default()({},TopTitleComponentsEnum[TopTitleComponentsEnum.TopLogo],Object.assign({},metadata)));default:return acc}},{})}},{key:"_getTitleCapabilityMetadata",value:function(title){return{useTransition:arguments.length>1&&void 0!==arguments[1]&&arguments[1],label:this._trimTitle(title)}}},{key:"_trimTitle",value:function(title){if(title)return title.length>36?"".concat(title.substring(0,36),"..."):title}},{key:"_toggleComponents",value:function(capabilityList){var _this3=this,skipAnimation=arguments.length>1&&void 0!==arguments[1]&&arguments[1],newTitleComponents=this._getCurrentComponents(capabilityList),componentsToHide=Object(ArrayUtils.a)(ALL_TITLE_COMPONENTS,newTitleComponents),componentsToShow=Object(ArrayUtils.a)(newTitleComponents,this._currentTitleComponents),componentsToUpdate=Object(ArrayUtils.b)(newTitleComponents,this._currentTitleComponents);this._currentTitleComponents=newTitleComponents,this._slideTitlesContainer(newTitleComponents),Object(DomUtils.i)(this._$titlesContainer),componentsToHide.forEach(function(componentName){return _this3._hideComponent(componentName,skipAnimation)}),componentsToShow.forEach(function(componentName){return _this3._showComponent(componentName,skipAnimation)}),componentsToUpdate.forEach(function(componentName){return _this3._updateComponent(componentName,skipAnimation)})}},{key:"_slideTitlesContainer",value:function(activeComponentsNames){switch(!0){case this._shouldTitleContainerSlideToInitialPosition(activeComponentsNames):this._slideTitleContainerToInitialPosition();break;case this._shouldTitleContainerSlideDown(activeComponentsNames):this._slideTitleContainerDown();break;default:this._removeSlideAnimationsFromTitleContainer()}}},{key:"_shouldTitleContainerSlideToInitialPosition",value:function(activeComponentsNames){return activeComponentsNames.includes(TopTitleComponentsEnum.TopSlideTitle)&&activeComponentsNames.includes(TopTitleComponentsEnum.TopStoryTitle)}},{key:"_shouldTitleContainerSlideDown",value:function(activeComponentsNames){var hasOnlyTopSlideTitle=activeComponentsNames.includes(TopTitleComponentsEnum.TopSlideTitle)&&!activeComponentsNames.includes(TopTitleComponentsEnum.TopStoryTitle),hasOnlyTopStoryTitle=!activeComponentsNames.includes(TopTitleComponentsEnum.TopSlideTitle)&&activeComponentsNames.includes(TopTitleComponentsEnum.TopStoryTitle);return hasOnlyTopSlideTitle||hasOnlyTopStoryTitle}},{key:"_slideTitleContainerToInitialPosition",value:function(){Object(DomUtils.L)(this._$titlesContainer,CSSClassTopArticleComponentEnum.SlideDown),Object(DomUtils.a)(this._$titlesContainer,CSSClassTopArticleComponentEnum.SlideInitial)}},{key:"_slideTitleContainerDown",value:function(){Object(DomUtils.L)(this._$titlesContainer,CSSClassTopArticleComponentEnum.SlideInitial),Object(DomUtils.a)(this._$titlesContainer,CSSClassTopArticleComponentEnum.SlideDown)}},{key:"_removeSlideAnimationsFromTitleContainer",value:function(){Object(DomUtils.L)(this._$titlesContainer,CSSClassTopArticleComponentEnum.SlideInitial,CSSClassTopArticleComponentEnum.SlideDown)}},{key:"_hideComponent",value:function(componentName){var skipAnimation=arguments.length>1&&void 0!==arguments[1]&&arguments[1],component=this._getComponent(componentName);if(component){var componentProperties=this._getComponentProperties(componentName);skipAnimation&&(componentProperties.useTransition=!1),component.hide(componentProperties)}}},{key:"_showComponent",value:function(componentName){var skipAnimation=arguments.length>1&&void 0!==arguments[1]&&arguments[1],component=this._getComponent(componentName);if(component){var componentProperties=this._getComponentProperties(componentName);skipAnimation&&(componentProperties.useTransition=!1),component.show(componentProperties)}}},{key:"_updateComponent",value:function(componentName){var skipAnimation=arguments.length>1&&void 0!==arguments[1]&&arguments[1],component=this._getComponent(componentName);if(component){var componentProperties=this._getComponentProperties(componentName);skipAnimation&&(componentProperties.useTransition=!1),component.update(componentProperties)}}},{key:"_getComponent",value:function(componentName){return this.getComponent(UiComponentsEnum[TopTitleComponentsEnum[componentName]])}},{key:"_getComponentProperties",value:function(componentName){return this._capabilities[TopTitleComponentsEnum[componentName]]||{}}}]),TopTitle}(AMasterComponent_AMasterComponent);!function(CSSClassSlideTitleEnum){CSSClassSlideTitleEnum.Wrapper="cnx-ui-ps__wrapper",CSSClassSlideTitleEnum.Container="cnx-ui-ps__container",CSSClassSlideTitleEnum.Placeholder="cnx-ui-ps__placeholder",CSSClassSlideTitleEnum.Text="cnx-ui__span--text",CSSClassSlideTitleEnum.Label="cnx-ui__span--label",CSSClassSlideTitleEnum.Title="cnx-ui__span--title",CSSClassSlideTitleEnum.VerticalLine="cnx-ui-ps__vertical-line",CSSClassSlideTitleEnum.Instagram="cnx-ui-ps__slide--instagram",CSSClassSlideTitleEnum.Cover="cnx-ui-ps__slide--cover",CSSClassSlideTitleEnum.HighlightInner="cnx-top-title-highlight-text-inner-container",CSSClassSlideTitleEnum.HighlightText="cnx-ui-ps-highlight-text"}(CSSClassSlideTitleEnum||(CSSClassSlideTitleEnum={})),function(CSSClassSlideTitleAnimationEnum){CSSClassSlideTitleAnimationEnum.Default="cnx-ui-ps__sliding--default",CSSClassSlideTitleAnimationEnum.Basic="cnx-ui-ps__sliding--basic",CSSClassSlideTitleAnimationEnum.Cover="cnx-ui-ps__sliding--cover",CSSClassSlideTitleAnimationEnum.SlideIn="cnx-title-slide-in",CSSClassSlideTitleAnimationEnum.SlideOut="cnx-title-slide-out"}(CSSClassSlideTitleAnimationEnum||(CSSClassSlideTitleAnimationEnum={})),function(CSSClassSlideTitleTypesEnum){CSSClassSlideTitleTypesEnum.Cover="cnx-ui-ps__title--cover",CSSClassSlideTitleTypesEnum.Quote="cnx-ui-ps__title--quote",CSSClassSlideTitleTypesEnum.Bullet="cnx-ui-ps__title--bullet",CSSClassSlideTitleTypesEnum.Default="cnx-ui-ps__title--default",CSSClassSlideTitleTypesEnum.Description="cnx-ui-ps__title--description",CSSClassSlideTitleTypesEnum.Instagram="cnx-ui-ps__title--instagram"}(CSSClassSlideTitleTypesEnum||(CSSClassSlideTitleTypesEnum={}));var DEFAULT_START_INDEX=0,DEFAULT_IS_CIRCULAR=!0,PlaylistManager_PlaylistManager=function(){function PlaylistManager(_list){var _startIndex=arguments.length>1&&void 0!==arguments[1]?arguments[1]:DEFAULT_START_INDEX,_isCircularList=arguments.length>2&&void 0!==arguments[2]?arguments[2]:DEFAULT_IS_CIRCULAR;if(classCallCheck_default()(this,PlaylistManager),this._list=_list,this._isCircularList=_isCircularList,!Object(ArrayUtils.h)(this._list))throw new Error("PlaylistManager: list was not supplied");this.setCurrentItem(_startIndex)}return createClass_default()(PlaylistManager,[{key:"setCurrentItem",value:function(index){this._currentItem=this._list[index]}},{key:"goToNextItem",value:function(){this._getHelperIndexes().nextIndex===this._getHelperIndexes().firstIndex&&this._isCircularList?this.setCurrentItem(this._getHelperIndexes().firstIndex):this.setCurrentItem(this._getHelperIndexes().nextIndex)}},{key:"_getHelperIndexes",value:function(){var index=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._list.indexOf(this._currentItem);return getPlaylistHelperIndexes(this._list,index)}},{key:"currentItem",get:function(){return this._currentItem}},{key:"listLength",get:function(){return this._list.length}},{key:"previousItem",get:function(){return this._list[this._getHelperIndexes().prevIndex]}},{key:"currentItemIndex",get:function(){return this._getHelperIndexes().currentIndex}}]),PlaylistManager}(),TextChunker_TextChunker=function(){function TextChunker(_rules){classCallCheck_default()(this,TextChunker),this._rules=_rules}return createClass_default()(TextChunker,[{key:"getChunks",value:function(text){return function(text){return/<[a-z/][\s\S]*>/i.test(text)}(text)?this._getChunksFromHTMLText(text):this._getChunksFromSimpleText(text)}},{key:"_getChunksFromSimpleText",value:function(text){for(var chunkArray=[],substringCache="",i=0;i<text.length;i++)substringCache+=text[i],this._testChar(text[i])&&(chunkArray.push(substringCache),substringCache="");return substringCache.length>0&&chunkArray.push(substringCache),chunkArray}},{key:"_getChunksFromHTMLText",value:function(text){var _this=this;try{var placeholder=document.createElement("cnx");placeholder.innerHTML=text;var wordsArray=[];return Object(ArrayUtils.c)(placeholder.childNodes).forEach(function(node){node.outerHTML?wordsArray.push(node.outerHTML):wordsArray.push.apply(wordsArray,toConsumableArray_default()(_this._getChunksFromSimpleText(node.nodeValue)))}),wordsArray}catch(e){return Object(Logging.a)({message:"TextChunker_splitHtmlStringIntoWords",exception:e.message,level:protos.ProtoLoggingLevelEnum.INFO,callStack:e.stack,throttle:1,sendMaxLog:!1}),[text]}}},{key:"_testChar",value:function(_char){return this._rules.some(function(rule){return rule(_char)})}}]),TextChunker}(),SplitText_SplitText=function(){function SplitText(_globalDomUtils){classCallCheck_default()(this,SplitText),this._globalDomUtils=_globalDomUtils,this._textChunker=new TextChunker_TextChunker([function(_char){return/\s/.test(_char)}])}return createClass_default()(SplitText,[{key:"_baseLineWrap",value:function(words,baseLineOptions){var maxLineWidth=baseLineOptions.maxLineWidth,maxLines=baseLineOptions.maxLines,minLines=baseLineOptions.minLines,textData=toConsumableArray_default()(words),lines=[],isJapaneseWords=words.map(function(word){return word.innerHTML}).some(function(text){return isJapaneseText(text)});if(!textData.length||!Object(TypeUtils.e)(maxLineWidth))return lines;for(var lineWidth=0,lineIndex=-1,loopCount=0;textData.length>0;){if(lineWidth=0,lines[++lineIndex]=[],++loopCount>=250){Object(Logging.a)({message:"Split text base line wrap infinite loop",level:protos.ProtoLoggingLevelEnum.INFO,throttle:1,sendMaxLog:!1});break}for(;textData[0]&&lineWidth+textData[0].width<=maxLineWidth;)if(lineWidth+=textData[0].width,lines[lineIndex].push(textData.shift()),++loopCount>=250){Object(Logging.a)({message:"Split text base line wrap infinite loop",level:protos.ProtoLoggingLevelEnum.INFO,throttle:1,sendMaxLog:!1});break}if(textData[0]&&lines.length>=maxLines){var _lines$lineIndex;(_lines$lineIndex=lines[lineIndex]).push.apply(_lines$lineIndex,toConsumableArray_default()(textData));break}if(1===textData.length&&textData[0].width>maxLineWidth){var _lines$lineIndex2;(_lines$lineIndex2=lines[lineIndex]).push.apply(_lines$lineIndex2,toConsumableArray_default()(textData));break}}return lines.length<minLines&&lines[0].length>4&&(lines[1]=lines[0].splice(-2,2)),!isJapaneseWords&&lines[lineIndex].length<2&&lines.length>1&&lines[lineIndex].unshift(lines[lineIndex-1].pop()),lines}},{key:"_getElementMeasurements",value:function(textElements){return textElements.map(function(word){return{innerHTML:"cnx-aux"===word.nodeName.toLowerCase()?word.innerHTML:word.outerHTML,width:word.getBoundingClientRect().width,height:word.getBoundingClientRect().height}})}},{key:"getWordsHtml",value:function(text){return Object(TypeUtils.h)(text)?this._textChunker.getChunks(text.trim()).map(function(chunk){return"<".concat("cnx-aux",">").concat(chunk,"</").concat("cnx-aux",">")}).join(""):""}},{key:"_brakeLongLines",value:function($container,lineSelector){var _this=this,linesToBreak=$container.querySelectorAll(lineSelector),containerWidth=$container.clientWidth?$container.clientWidth:$container.getBoundingClientRect().width;Object(ArrayUtils.c)(linesToBreak).forEach(function($lineElement){var textElements=Object(ArrayUtils.c)($lineElement.querySelectorAll("cnx-aux")),$lineParent=$lineElement.parentElement;if(textElements.length&&$lineElement.nodeType===Node.ELEMENT_NODE){var computedStyle=_this._globalDomUtils.getComputedStyle($lineElement),maxLineWidth=parseInt(_this._globalDomUtils.getComputedStyle($lineElement,"before").getPropertyValue("width"),10),maxLineNumber=parseInt(computedStyle.getPropertyValue("--max-title-lines"),10),minLineNumber=parseInt(computedStyle.getPropertyValue("--min-title-lines"),10),fontSize=parseInt(computedStyle.getPropertyValue("font-size"),10),baseLineOptions={maxLineWidth:maxLineWidth||$lineElement.getBoundingClientRect().width-20,maxLines:maxLineNumber||15,minLines:minLineNumber||1},wordSplitData=_this._getElementMeasurements(textElements),baseLines=_this._baseLineWrap(wordSplitData,baseLineOptions),lineFragment=_this._globalDomUtils.createElementByString("<cnx class='".concat("cnx-ui-lines","'></cnx>"));lineFragment.dataset.split=containerWidth.toString(),lineFragment.dataset.split+=","+fontSize,baseLines.forEach(function(line){var lineClone=$lineElement.cloneNode();Object(DomUtils.L)(lineClone,"cnx-aux-container");var wordInners=line.filter(function(word){return Object(TypeUtils.f)(word)}).map(function(word){return word.innerHTML});lineClone.innerHTML+=wordInners.join("").trim(),lineFragment.dataset.split+=","+line.length,Object(DomUtils.d)(lineClone,lineFragment)}),_this._getSplitCache(lineFragment).lines!==_this._getSplitCache($lineParent).lines?$lineElement.classList.contains("cnx-aux-container")?_this._globalDomUtils.requestAnimationFrameHelper(function(){null!==$lineParent.parentNode&&Object(DomUtils.w)($lineParent,lineFragment),Object(DomUtils.M)($lineParent)}):_this._globalDomUtils.requestAnimationFrameHelper(function(){null!==$lineElement.parentNode&&Object(DomUtils.w)($lineElement,lineFragment),Object(DomUtils.M)($lineElement)}):Object(DomUtils.M)($lineElement)}})}},{key:"brakeLongLines",value:function($container,lineSelector){var _this2=this,linesToBreak=$container.querySelectorAll(lineSelector);if(linesToBreak.length){var containerWidth=$container.clientWidth?$container.clientWidth:$container.getBoundingClientRect().width,splitData=this._getSplitCache(linesToBreak[0].parentElement);if(isNaN(splitData.width))this._brakeLongLines($container,lineSelector);else if(!splitData.width||0!==Math.abs(splitData.width-containerWidth)){var linesToMerge=$container.querySelectorAll(".".concat("cnx-ui-lines","[data-split]"));Object(ArrayUtils.c)(linesToMerge).forEach(function($lineContainer){var childElements=$lineContainer.querySelectorAll(lineSelector),tempLineElement=childElements[0].cloneNode(!1),mergedChildInner=Object(ArrayUtils.c)(childElements).map(function($lineElement){return $lineElement.innerHTML}).join("");tempLineElement.innerHTML=_this2.getWordsHtml(mergedChildInner),Object(DomUtils.a)(tempLineElement,"cnx-aux-container"),$lineContainer.prepend(tempLineElement)}),this._brakeLongLines($container,lineSelector)}}}},{key:"_getSplitCache",value:function($container){var splitData=$container.dataset.split?$container.dataset.split.split(","):[],width=splitData.shift();return{width:parseInt(width,10),lines:splitData.join("")}}}]),SplitText}();function BaseSlideTitle_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var _COLOR_SCHEME_MAP,BaseSlideTitle_BaseSlideTitle=function(_AClickComponent){inherits_default()(BaseSlideTitle,_AClickComponent);var _super=BaseSlideTitle_createSuper(BaseSlideTitle);function BaseSlideTitle(mediator,_globalDomUtils,interactionService,_resizeObserver,_isMobile,_titleTemplate){var _this;return classCallCheck_default()(this,BaseSlideTitle),(_this=_super.call(this,mediator,_globalDomUtils,interactionService,_titleTemplate.template,_isMobile)).mediator=mediator,_this._globalDomUtils=_globalDomUtils,_this._resizeObserver=_resizeObserver,_this._isMobile=_isMobile,_this._titleTemplate=_titleTemplate,_this.splitTextSelector=".".concat(CSSClassSlideTitleEnum.Text),_this._onResize=function(){_this._globalDomUtils.requestAnimationFrameHelper(function(){_this._splitText.brakeLongLines(_this._$container,_this.splitTextSelector)})},_this._$templateFragment=_globalDomUtils.createDocumentFragment(),_this._splitText=new SplitText_SplitText(_globalDomUtils),_this}return createClass_default()(BaseSlideTitle,[{key:"_createTitleElement",value:function(text,colorClass){var template=this._titleTemplate.titleTemplate(text,colorClass);return this._globalDomUtils.createElementByString(template)}},{key:"_createLabelElement",value:function(text,colorClass){var template=this._titleTemplate.labelTemplate(text,colorClass);return this._globalDomUtils.createElementByString(template)}},{key:"_createTextElement",value:function(text,colorClass){var template=this._titleTemplate.textTemplate(text,colorClass);return this._globalDomUtils.createElementByString(template)}},{key:"_createPlaceholderElement",value:function(){var template=this._titleTemplate.placeholderTemplate();return this._globalDomUtils.createElementByString(template)}},{key:"_adjustDynamicBottom",value:function(){}},{key:"_slideIn",value:function(){this.resetAnimation(),Object(DomUtils.a)(this._$container,CSSClassSlideTitleAnimationEnum.SlideIn)}},{key:"_slideOut",value:function(){this.resetAnimation(),Object(DomUtils.a)(this._$container,CSSClassSlideTitleAnimationEnum.SlideOut)}},{key:"onSlideTransitionStart",value:function(metadata){this._preRender(metadata),this.resetAnimation(),this.render()}},{key:"onSlideTransitionEnd",value:function(){this._slideIn()}},{key:"onSlideTimeUpdate",value:function(elapsedTime,totalDuration){}},{key:"resetAnimation",value:function(){var classNames=[CSSClassSlideTitleAnimationEnum.SlideIn,CSSClassSlideTitleAnimationEnum.SlideOut];DomUtils.L.apply(void 0,[this._$container].concat(classNames))}},{key:"initComponent",value:function($host){get_default()(getPrototypeOf_default()(BaseSlideTitle.prototype),"initComponent",this).call(this),this._$hostElement=$host,this._resizeObserver.on(this._$hostElement,this._onResize)}},{key:"render",value:function(){Object(DomUtils.J)(this._$container,this._$templateFragment),Object(DomUtils.d)(this._$container,this._$hostElement)}},{key:"setFooterElement",value:function($footer){return this._$footer=$footer,this._adjustDynamicBottom(),this._$footer}},{key:"destroy",value:function(){this._resizeObserver.off(this._$hostElement,this._onResize),Object(DomUtils.M)(this._$container),this._$container=this._globalDomUtils.createElementByString(this._titleTemplate.template),this.unsubscribeAll(this._interactionService),this._interactionService.unregisterAll(this)}},{key:"$templateFragment",get:function(){return this._$templateFragment}}]),BaseSlideTitle}(AClickComponent_AClickComponent);function sanitizeTitle(title,tag){return function(text,tag){var escapedTag=tag.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),regex=new RegExp("<".concat(escapedTag,">(.*?)</").concat(escapedTag,">"),"g");return text.replace(regex,function(matchedString,insideTags){return insideTags.split(" ").map(function(word){return"<".concat(tag,">").concat(word,"</").concat(tag,">")}).join(" ")})}(sanitizeHyphens(title.replace(/^\s+|\s+$|\s+(?=\s)/g,"")),tag)}function DescriptionTitle_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var COLOR_SCHEME_MAP=(_COLOR_SCHEME_MAP={},defineProperty_default()(_COLOR_SCHEME_MAP,ProtoModels_Generated_protos.ProtoPlayspaceColorSchemeEnum.Accent,CssClassesConfig.f.AccentColor),defineProperty_default()(_COLOR_SCHEME_MAP,ProtoModels_Generated_protos.ProtoPlayspaceColorSchemeEnum.Primary,CssClassesConfig.f.PrimaryColor),defineProperty_default()(_COLOR_SCHEME_MAP,ProtoModels_Generated_protos.ProtoPlayspaceColorSchemeEnum.Secondary,CssClassesConfig.f.SecondaryColor),_COLOR_SCHEME_MAP),DescriptionTitle_DescriptionTitle=function(_BaseSlideTitle){inherits_default()(DescriptionTitle,_BaseSlideTitle);var _super=DescriptionTitle_createSuper(DescriptionTitle);function DescriptionTitle(mediator,_globalDomUtils,interactionService,_resizeObserver,_isMobile,_titleTemplate){var _this;return classCallCheck_default()(this,DescriptionTitle),(_this=_super.call(this,mediator,_globalDomUtils,interactionService,_resizeObserver,_isMobile,_titleTemplate)).mediator=mediator,_this._globalDomUtils=_globalDomUtils,_this._isMobile=_isMobile,_this._titleTemplate=_titleTemplate,_this.eventList=[],_this.className=CSSClassSlideTitleTypesEnum.Description,_this}return createClass_default()(DescriptionTitle,[{key:"_getChunkDuration",value:function(totalDuration){return totalDuration/this._chunkList.listLength*(this._chunkList.currentItemIndex+1)}},{key:"_initChunkListManager",value:function(chunkList){var _this2=this,extendedChunkList=chunkList.map(function(chunk,index){var $element=_this2._text(chunk);return Object(DomUtils.d)($element,_this2.$templateFragment),0===index&&Object(DomUtils.a)($element,"active"),Object.assign(Object.assign({},chunk),{shown:!1,element:$element})});this._chunkList=new PlaylistManager_PlaylistManager(extendedChunkList)}},{key:"_label",value:function(chunk){return this._createLabelElement(chunk.text,COLOR_SCHEME_MAP[chunk.colorScheme])}},{key:"_text",value:function(chunk){return this._createTextElement(this._splitText.getWordsHtml(sanitizeTitle(chunk.text,"em")),COLOR_SCHEME_MAP[chunk.colorScheme])}},{key:"_preRender",value:function(metadata){var chunkList=metadata.descriptionChunkList,label={text:metadata.label,colorScheme:metadata.labelColorScheme};Object(TypeUtils.h)(label.text)&&Object(DomUtils.d)(this._label(label),this.$templateFragment),Object(ArrayUtils.h)(chunkList)&&this._initChunkListManager(chunkList)}},{key:"_goToNext",value:function(){var _this3=this;this._chunkList.currentItem.shown=!0,Object(DomUtils.L)(this._chunkList.currentItem.element,"active"),this._chunkList.goToNextItem(),this._globalDomUtils.requestAnimationFrameHelper(function(){_this3.resetAnimation(),_this3._globalDomUtils.requestAnimationFrameHelper(function(){Object(DomUtils.a)(_this3._chunkList.currentItem.element,"active"),_this3._slideIn()})})}},{key:"onSlideTimeUpdate",value:function(elapsedTime,totalDuration){elapsedTime>=totalDuration||elapsedTime>=this._getChunkDuration(totalDuration)&&!this._chunkList.currentItem.shown&&this._goToNext()}}]),DescriptionTitle}(BaseSlideTitle_BaseSlideTitle),BaseSlideTitleTemplate_BaseSlideTitleTemplate=function(){function BaseSlideTitleTemplate(){classCallCheck_default()(this,BaseSlideTitleTemplate)}return createClass_default()(BaseSlideTitleTemplate,[{key:"titleTemplate",value:function(text,colorClass){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Title," ").concat(colorClass,'">').concat(text,"</cnx>")}},{key:"labelTemplate",value:function(text,colorClass){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Label," ").concat(colorClass,' ">').concat(text,"</cnx>")}},{key:"textTemplate",value:function(text,colorClass){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Text," ").concat(colorClass,'">').concat(text,"</cnx>")}},{key:"containerTemplate",value:function(){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Container,'"></cnx>')}},{key:"placeholderTemplate",value:function(){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Placeholder,'"></cnx>')}},{key:"wrapeprTemplate",value:function(){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Wrapper,'"></cnx>')}},{key:"template",get:function(){return'<cnx class="'.concat(CssClassesConfig.f.TitleComponent,'"></cnx>')}}]),BaseSlideTitleTemplate}();function DescriptionTitleTemplate_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var DescriptionTitleTemplate_DescriptionTitleTemplate=function(_BaseSlideTitleTempla){inherits_default()(DescriptionTitleTemplate,_BaseSlideTitleTempla);var _super=DescriptionTitleTemplate_createSuper(DescriptionTitleTemplate);function DescriptionTitleTemplate(){return classCallCheck_default()(this,DescriptionTitleTemplate),_super.apply(this,arguments)}return createClass_default()(DescriptionTitleTemplate,[{key:"textTemplate",value:function(text,colorClass){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Placeholder,'">\n            <cnx class="').concat(CSSClassSlideTitleEnum.Text," ").concat(colorClass,'">').concat(text,"</cnx>\n        </cnx>")}},{key:"template",get:function(){return'<cnx class="'.concat(CSSClassSlideTitleAnimationEnum.Basic," ").concat(CssClassesConfig.f.TitleComponent,'"></cnx>')}}]),DescriptionTitleTemplate}(BaseSlideTitleTemplate_BaseSlideTitleTemplate);function DefaultTitleTemplate_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var DefaultTitleTemplate_DefaultTitleTemplate=function(_BaseSlideTitleTempla){inherits_default()(DefaultTitleTemplate,_BaseSlideTitleTempla);var _super=DefaultTitleTemplate_createSuper(DefaultTitleTemplate);function DefaultTitleTemplate(){return classCallCheck_default()(this,DefaultTitleTemplate),_super.apply(this,arguments)}return createClass_default()(DefaultTitleTemplate,[{key:"textTemplate",value:function(text){return'<cnx class="'.concat(CssClassesConfig.m.InheritBodyFontFamily," ").concat(CSSClassSlideTitleEnum.Text," ").concat(CssClassesConfig.f.PrimaryColor," ").concat(CSSClassSlideTitleEnum.HighlightInner," ").concat(CSSClassSlideTitleEnum.HighlightText,'">').concat(text,"</cnx>").trim()}},{key:"template",get:function(){return'<cnx class="'.concat(CSSClassSlideTitleAnimationEnum.Default," ").concat(CssClassesConfig.f.TitleComponent,'">\n            <cnx class="').concat(CSSClassSlideTitleEnum.VerticalLine," ").concat(CssClassesConfig.f.AccentColor,'"></cnx>\n        </cnx>').trim()}}]),DefaultTitleTemplate}(BaseSlideTitleTemplate_BaseSlideTitleTemplate);function DefaultTitle_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var DefaultTitle_DefaultTitle=function(_BaseSlideTitle){inherits_default()(DefaultTitle,_BaseSlideTitle);var _super=DefaultTitle_createSuper(DefaultTitle);function DefaultTitle(mediator,_globalDomUtils,interactionService,_resizeObserver,_isMobile,_titleTemplate){var _this;return classCallCheck_default()(this,DefaultTitle),(_this=_super.call(this,mediator,_globalDomUtils,interactionService,_resizeObserver,_isMobile,_titleTemplate)).mediator=mediator,_this._globalDomUtils=_globalDomUtils,_this._isMobile=_isMobile,_this._titleTemplate=_titleTemplate,_this.className=CSSClassSlideTitleTypesEnum.Default,_this._timedSlideOutEnabled=!0,_this.eventList=[].concat(toConsumableArray_default()(_this.eventList),[UiPlayspaceEventsEnum.CallToAction]),_this}return createClass_default()(DefaultTitle,[{key:"_preRender",value:function(metadata){var url=metadata.url,label=metadata.label;if(url?(this._$container.setAttribute("title",url),Object(DomUtils.a)(this._$container,CssClassesConfig.f.TitleLink)):(this._$container.removeAttribute("title"),Object(DomUtils.L)(this._$container,CssClassesConfig.f.TitleLink)),Object(TypeUtils.h)(label)){var title=this._splitText.getWordsHtml(sanitizeTitle(label,"em"));Object(DomUtils.d)(this._createTextElement(title),this.$templateFragment)}}},{key:"onClickHandler",value:function(){this.mediator.publish(this,UiPlayspaceEventsEnum.CallToAction)}},{key:"onSlideTransitionEnd",value:function(){get_default()(getPrototypeOf_default()(DefaultTitle.prototype),"onSlideTransitionEnd",this).call(this),this._timedSlideOutEnabled=!0}},{key:"onSlideTimeUpdate",value:function(elapsedTime,totalDuration){this._timedSlideOutEnabled&&totalDuration-elapsedTime<1200&&(this._slideOut(),this._timedSlideOutEnabled=!1)}},{key:"destroy",value:function(){get_default()(getPrototypeOf_default()(DefaultTitle.prototype),"destroy",this).call(this),this.unsubscribeAll(this._interactionService),this._interactionService.unregisterAll(this)}}]),DefaultTitle}(BaseSlideTitle_BaseSlideTitle);function BulletTitle_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var BulletTitle_BulletTitle=function(_BaseSlideTitle){inherits_default()(BulletTitle,_BaseSlideTitle);var _super=BulletTitle_createSuper(BulletTitle);function BulletTitle(mediator,_globalDomUtils,interactionService,_resizeObserver,_isMobile,_titleTemplate){var _this;return classCallCheck_default()(this,BulletTitle),(_this=_super.call(this,mediator,_globalDomUtils,interactionService,_resizeObserver,_isMobile,_titleTemplate)).mediator=mediator,_this._globalDomUtils=_globalDomUtils,_this._isMobile=_isMobile,_this._titleTemplate=_titleTemplate,_this.eventList=[],_this.className=CSSClassSlideTitleTypesEnum.Bullet,_this}return createClass_default()(BulletTitle,[{key:"_initChunkListManager",value:function(chunkList){var _this2=this,extendedChunkList=chunkList.map(function(bulletItem){if(Object(TypeUtils.h)(bulletItem.title)){var $element=_this2._bulletItem(bulletItem);return Object(DomUtils.d)($element,_this2.$templateFragment),Object.assign(Object.assign({},bulletItem),{activated:!1,element:$element,titleElement:$element.firstChild,containerElement:$element.querySelector(".".concat(CSSClassSlideTitleEnum.Container))})}});this._descriptionPlaylist=new PlaylistManager_PlaylistManager(extendedChunkList)}},{key:"_openListItem",value:function(listItem){var listContainer=listItem.element.querySelector(".".concat(CSSClassSlideTitleEnum.Container)),listTextElement=listContainer.querySelectorAll(".".concat(CSSClassSlideTitleEnum.Text)),numLines=Object(TypeUtils.a)(listTextElement)?listTextElement.length:0,textLineHeight=Object(TypeUtils.a)(listTextElement[0])?listTextElement[0].clientHeight:0;Object(DomUtils.Q)(listContainer,{"max-height":"".concat(numLines*textLineHeight,"px")}),listItem.activated=!0,Object(DomUtils.O)(listItem.titleElement,CssClassesConfig.f.PrimaryColor,CssClassesConfig.f.SecondaryColor),Object(DomUtils.a)(listItem.element,"active")}},{key:"_closeListItem",value:function(listItem){var listContainer=listItem.element.querySelector(".".concat(CSSClassSlideTitleEnum.Container));Object(DomUtils.N)(listContainer,"max-height"),Object(DomUtils.O)(listItem.titleElement,CssClassesConfig.f.SecondaryColor,CssClassesConfig.f.PrimaryColor),Object(DomUtils.L)(listItem.element,"active")}},{key:"_bulletTitleElement",value:function(text){var template=this._titleTemplate.labelTemplate(text);return this._globalDomUtils.createElementByString(template)}},{key:"_bulletItem",value:function(bulletItem){var title=this._bulletTitleElement(bulletItem.title),description=this._createTextElement(this._splitText.getWordsHtml(bulletItem.description)),container=this._createPlaceholderElement();return Object(DomUtils.d)([title,description],container),container}},{key:"_preRender",value:function(metadata){var label=metadata.label,bulletChunkList=metadata.bulletChunkList;Object(TypeUtils.h)(label)&&Object(DomUtils.d)(this._createTitleElement(label),this.$templateFragment),Object(ArrayUtils.h)(bulletChunkList)&&this._initChunkListManager(bulletChunkList.slice(0,3))}},{key:"onSlideTimeUpdate",value:function(elapsedTime,totalDuration){var playlist=this._descriptionPlaylist;playlist&&!playlist.currentItem.activated&&(0===playlist.currentItemIndex?elapsedTime>=1e3&&(this._openListItem(playlist.currentItem),playlist.goToNextItem()):(totalDuration-1e3)/playlist.listLength*playlist.currentItemIndex+1e3<elapsedTime&&(this._closeListItem(playlist.previousItem),this._openListItem(playlist.currentItem),playlist.goToNextItem()))}}]),BulletTitle}(BaseSlideTitle_BaseSlideTitle);function BulletTitleTamplate_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var BulletTitleTamplate_BulletTitleTemplate=function(_BaseSlideTitleTempla){inherits_default()(BulletTitleTemplate,_BaseSlideTitleTempla);var _super=BulletTitleTamplate_createSuper(BulletTitleTemplate);function BulletTitleTemplate(){return classCallCheck_default()(this,BulletTitleTemplate),_super.apply(this,arguments)}return createClass_default()(BulletTitleTemplate,[{key:"titleTemplate",value:function(text){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Title," ").concat(CssClassesConfig.f.AccentColor,'">').concat(text,"</cnx>")}},{key:"labelTemplate",value:function(text){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Label," ").concat(CssClassesConfig.f.PrimaryColor,'">\n            <cnx class="').concat(CSSClassSlideTitleEnum.VerticalLine," ").concat(CssClassesConfig.f.AccentColor,'"></cnx>\n            ').concat(text,"\n        </cnx>").trim()}},{key:"textTemplate",value:function(text){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Container,'">\n                    <cnx class="').concat(CSSClassSlideTitleEnum.Text,"  ").concat(CssClassesConfig.f.SecondaryColor,'">').concat(text,"</cnx>\n                </cnx>\n        ").trim()}},{key:"template",get:function(){return'<cnx class="'.concat(CSSClassSlideTitleAnimationEnum.Basic," ").concat(CssClassesConfig.f.TitleComponent,'"></cnx>')}}]),BulletTitleTemplate}(BaseSlideTitleTemplate_BaseSlideTitleTemplate);function CoverTitle_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var CoverTitle_CoverTitle=function(_BaseSlideTitle){inherits_default()(CoverTitle,_BaseSlideTitle);var _super=CoverTitle_createSuper(CoverTitle);function CoverTitle(mediator,_globalDomUtils,interactionService,_resizeObserver,_isMobile,_titleTemplate){var _this;return classCallCheck_default()(this,CoverTitle),(_this=_super.call(this,mediator,_globalDomUtils,interactionService,_resizeObserver,_isMobile,_titleTemplate)).mediator=mediator,_this._globalDomUtils=_globalDomUtils,_this._isMobile=_isMobile,_this._titleTemplate=_titleTemplate,_this.eventList=[],_this.className=CSSClassSlideTitleTypesEnum.Cover,_this.splitTextSelector=".".concat(CSSClassSlideTitleEnum.Text,", .").concat(CSSClassSlideTitleEnum.Title),_this._onResize=function(){_this._globalDomUtils.requestAnimationFrameHelper(function(){if(_this._splitText.brakeLongLines(_this._$container,_this.splitTextSelector),_this._$footer){var bottomHeight=_this._$footer.clientHeight/2*-1;Object(DomUtils.Q)(_this.labelElement,{bottom:"".concat(bottomHeight,"px"),position:"absolute"})}})},_this}return createClass_default()(CoverTitle,[{key:"_preRender",value:function(metadata){var _metadata$coverChunk=metadata.coverChunk,title=_metadata$coverChunk.title,subtitle=_metadata$coverChunk.subtitle,label=metadata.label;if(Object(TypeUtils.h)(title)&&(title=sanitizeTitle(title,"em"),Object(DomUtils.d)(this._createTitleElement(this._splitText.getWordsHtml(title)),this.$templateFragment)),Object(TypeUtils.h)(subtitle)&&(subtitle=sanitizeTitle(subtitle,"em"),Object(DomUtils.d)(this._createTextElement(this._splitText.getWordsHtml(subtitle)),this.$templateFragment)),Object(TypeUtils.h)(label)){if(this.labelElement=this._createLabelElement(label),this._$footer){var bottomHeight=(this._$footer.clientHeight-this._$container.clientHeight)/2*-1;Object(DomUtils.Q)(this.labelElement,{bottom:"".concat(bottomHeight,"px"),position:"absolute"})}Object(DomUtils.d)(this.labelElement,this.$templateFragment)}}}]),CoverTitle}(BaseSlideTitle_BaseSlideTitle);function CoverTitleTemplate_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var CoverTitleTemplate_CoverTitleTemplate=function(_BaseSlideTitleTempla){inherits_default()(CoverTitleTemplate,_BaseSlideTitleTempla);var _super=CoverTitleTemplate_createSuper(CoverTitleTemplate);function CoverTitleTemplate(){return classCallCheck_default()(this,CoverTitleTemplate),_super.apply(this,arguments)}return createClass_default()(CoverTitleTemplate,[{key:"titleTemplate",value:function(text){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Placeholder,'">\n            <cnx class="').concat(CSSClassSlideTitleEnum.Title," ").concat(CssClassesConfig.f.PrimaryColor,'">').concat(text,"</cnx>\n        </cnx>")}},{key:"textTemplate",value:function(text){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Placeholder,'">\n            <cnx class="').concat(CSSClassSlideTitleEnum.Text," ").concat(CssClassesConfig.f.SecondaryColor,'">').concat(text,"</cnx>\n        </cnx>")}},{key:"labelTemplate",value:function(text){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Placeholder,'">\n            <cnx class="').concat(CSSClassSlideTitleEnum.Label,'">').concat(text,"</cnx>\n        </cnx>")}},{key:"template",get:function(){return'<cnx class="'.concat(CSSClassSlideTitleAnimationEnum.Cover," ").concat(CssClassesConfig.f.TitleComponent,'"></cnx>')}}]),CoverTitleTemplate}(BaseSlideTitleTemplate_BaseSlideTitleTemplate),quoteMark=__webpack_require__(129),quoteMark_default=__webpack_require__.n(quoteMark);function QuoteTitle_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var QuoteTitle_QuoteTitle=function(_BaseSlideTitle){inherits_default()(QuoteTitle,_BaseSlideTitle);var _super=QuoteTitle_createSuper(QuoteTitle);function QuoteTitle(mediator,_globalDomUtils,interactionService,_resizeObserver,_isMobile,_titleTemplate){var _this;return classCallCheck_default()(this,QuoteTitle),(_this=_super.call(this,mediator,_globalDomUtils,interactionService,_resizeObserver,_isMobile,_titleTemplate)).mediator=mediator,_this._globalDomUtils=_globalDomUtils,_this._isMobile=_isMobile,_this._titleTemplate=_titleTemplate,_this.eventList=[],_this.className=CSSClassSlideTitleTypesEnum.Quote,_this}return createClass_default()(QuoteTitle,[{key:"_preRender",value:function(metadata){var text=metadata.quote,source=metadata.source;if(Object(TypeUtils.h)(text)){var quoute=this._splitText.getWordsHtml("".concat(quoteMark_default.a).concat(sanitizeHyphens(text)).concat(quoteMark_default.a));Object(DomUtils.d)(this._createTextElement(quoute),this.$templateFragment)}Object(TypeUtils.h)(source)&&Object(DomUtils.d)(this._createLabelElement(source),this.$templateFragment)}}]),QuoteTitle}(BaseSlideTitle_BaseSlideTitle);function QuoteTitleTemplate_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var QuoteTitleTemplate_QuoteTitleTemplate=function(_BaseSlideTitleTempla){inherits_default()(QuoteTitleTemplate,_BaseSlideTitleTempla);var _super=QuoteTitleTemplate_createSuper(QuoteTitleTemplate);function QuoteTitleTemplate(){return classCallCheck_default()(this,QuoteTitleTemplate),_super.apply(this,arguments)}return createClass_default()(QuoteTitleTemplate,[{key:"textTemplate",value:function(text){return'\n        <cnx class="'.concat(CSSClassSlideTitleEnum.Text," ").concat(CssClassesConfig.f.PrimaryColor,'"> ').concat(text,"</cnx>").trim()}},{key:"labelTemplate",value:function(text){return'<cnx class="'.concat(CSSClassSlideTitleEnum.Label,'">').concat(text,"</cnx>").trim()}},{key:"template",get:function(){return'\n            <cnx class="'.concat(CSSClassSlideTitleAnimationEnum.Basic," ").concat(CssClassesConfig.f.TitleComponent,'"></cnx>\n        ').trim()}}]),QuoteTitleTemplate}(BaseSlideTitleTemplate_BaseSlideTitleTemplate);function InstagramTitle_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var InstagramTitle_InstagramTitle=function(_BaseSlideTitle){inherits_default()(InstagramTitle,_BaseSlideTitle);var _super=InstagramTitle_createSuper(InstagramTitle);function InstagramTitle(mediator,_globalDomUtils,interactionService,_resizeObserver,_isMobile,_titleTemplate){var _this;return classCallCheck_default()(this,InstagramTitle),(_this=_super.call(this,mediator,_globalDomUtils,interactionService,_resizeObserver,_isMobile,_titleTemplate)).mediator=mediator,_this._globalDomUtils=_globalDomUtils,_this._isMobile=_isMobile,_this._titleTemplate=_titleTemplate,_this.eventList=[],_this.className=CSSClassSlideTitleTypesEnum.Instagram,_this}return createClass_default()(InstagramTitle,[{key:"_preRender",value:function(metadata){var _metadata$instagramMe=metadata.instagramMetadata,createdDate=_metadata$instagramMe.createdDate,comments=_metadata$instagramMe.comments,likes=_metadata$instagramMe.likes,label=metadata.label;this._prerenderInstagramTemplate({createdDate:createdDate,comments:comments,likes:likes}),Object(TypeUtils.h)(label)&&Object(DomUtils.d)(this._createTitleElement(label),this.$templateFragment)}},{key:"_prerenderInstagramTemplate",value:function(metadata){var createdDate=metadata.createdDate,comments=metadata.comments,likes=metadata.likes,instagramMetaComponent=this._globalDomUtils.createElementByString(this._titleTemplate.instagramMetaTemplate(createdDate,likes,comments));if(this._isInvalidProperty(comments)&&this._isInvalidProperty(likes)){var labelElement=instagramMetaComponent.querySelector(".".concat(CSSClassSlideTitleEnum.Instagram,"-date cnx-span"));Object(DomUtils.a)(labelElement,CssClassesConfig.h.Show)}Object(DomUtils.d)(instagramMetaComponent,this.$templateFragment)}},{key:"_isInvalidProperty",value:function(property){return!Object(TypeUtils.h)(property)||"0"===property}}]),InstagramTitle}(BaseSlideTitle_BaseSlideTitle),svg_likes=__webpack_require__(208),likes_default=__webpack_require__.n(svg_likes),svg_comments=__webpack_require__(209),comments_default=__webpack_require__.n(svg_comments),timestamp=__webpack_require__(210),timestamp_default=__webpack_require__.n(timestamp);function InstagramTitleTemplate_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var InstagramTitleTemplate_InstagramTitleTemplate=function(_BaseSlideTitleTempla){inherits_default()(InstagramTitleTemplate,_BaseSlideTitleTempla);var _super=InstagramTitleTemplate_createSuper(InstagramTitleTemplate);function InstagramTitleTemplate(){return classCallCheck_default()(this,InstagramTitleTemplate),_super.apply(this,arguments)}return createClass_default()(InstagramTitleTemplate,[{key:"instagramMetaTemplate",value:function(createdDate,likes,comments){var dateContainer=Object(TypeUtils.h)(createdDate)?'\n            <cnx-span class="cnx-ui-ps-instagram-title-date '.concat(CssClassesConfig.m.InheritBodyFontFamily,'">\n                ').concat(timestamp_default.a,'\n                <cnx-span class="cnx-date-label ').concat(CssClassesConfig.m.InheritBodyFontFamily,'">Posted </cnx-span>').concat(Object(TimeUtils.e)(createdDate),"\n            </cnx-span>").trim():"",likeContainer=Object(TypeUtils.h)(likes)?'\n            <cnx-span class="cnx-ui-ps-instagram-title-likes '.concat(CssClassesConfig.m.InheritBodyFontFamily,'">\n                ').concat(likes_default.a," ").concat(Object(NumberUtils.a)(parseInt(likes,10)),"\n            </cnx-span>").trim():"",commentContainer=Object(TypeUtils.h)(comments)?'\n            <cnx-span class="cnx-ui-ps-instagram-title-comments '.concat(CssClassesConfig.m.InheritBodyFontFamily,'">\n                ').concat(comments_default.a," ").concat(Object(NumberUtils.a)(parseInt(comments,10)),"\n            </cnx-span>").trim():"";return'\n            <cnx class="cnx-ui-ps-instagram-title-row '.concat(CssClassesConfig.m.InheritBodyFontFamily,'">\n                ').concat(dateContainer,"\n                ").concat(likeContainer,"\n                ").concat(commentContainer,"\n            </cnx>\n        ").trim()}},{key:"titleTemplate",value:function(title){return'\n            <cnx class="cnx-ui-ps-instagram-title-row '.concat(CSSClassSlideTitleEnum.Instagram,"-title ").concat(CssClassesConfig.m.InheritBodyFontFamily,'">\n                ').concat(title,"\n            </cnx>\n        ").trim()}},{key:"template",get:function(){return'<cnx class="'.concat(CSSClassSlideTitleAnimationEnum.Basic," ").concat(CssClassesConfig.f.TitleComponent,'"></cnx>').trim()}}]),InstagramTitleTemplate}(BaseSlideTitleTemplate_BaseSlideTitleTemplate);function SlideTitle_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var SlideTitle_SlideTitle=function(_ABaseComponent){inherits_default()(SlideTitle,_ABaseComponent);var _super=SlideTitle_createSuper(SlideTitle);function SlideTitle(mediator,_globalDomUtils,interactionService,templateString,_resizeObserver,_isMobile,_disableClickUrl){var _this;return classCallCheck_default()(this,SlideTitle),(_this=_super.call(this,mediator,_globalDomUtils,interactionService,templateString,_isMobile)).mediator=mediator,_this._globalDomUtils=_globalDomUtils,_this._resizeObserver=_resizeObserver,_this._isMobile=_isMobile,_this._disableClickUrl=_disableClickUrl,_this.eventList=[],_this._titleMap=new Map,_this._initTitleTypes(),_this}return createClass_default()(SlideTitle,[{key:"setFooterElement",value:function($footer){this._titleMap.forEach(function(title){title.setFooterElement($footer)})}},{key:"onSlideTransitionStart",value:function(capabilityList){Object(DomUtils.S)(this._$container),this._$container.removeAttribute("title");var titleCapability=capabilityList.find(function(_ref){return _ref.type===SlideCapabilityTypeEnum.SlideTitle}),ctaCapability=capabilityList.find(function(_ref2){return _ref2.type===SlideCapabilityTypeEnum.CtaButton});if(ctaCapability&&ctaCapability.metadata&&ctaCapability.metadata.url){if(this._currentCtaUrl=ctaCapability.metadata.url,!this._disableClickUrl){this._$container.href=this._currentCtaUrl;var isSameDomain=this._globalDomUtils.isURLSameDomainToTop(this._currentCtaUrl);this._$container.target=isSameDomain?BrowserConfig.c.Top:BrowserConfig.c.Blank}this._$container.title=titleCapability.metadata.label,ctaCapability.metadata.title=titleCapability.metadata.label}if(Object(TypeUtils.f)(titleCapability)&&Object(TypeUtils.f)(titleCapability.metadata)){var currTitle=this._titleMap.get(titleCapability.metadata.titleType);if(currTitle){if(this._setCurrentTitle(currTitle),Object(TypeUtils.h)(titleCapability.metadata.label))isJapaneseText(titleCapability.metadata.label)&&Object(DomUtils.a)(this._$container,"cnx-japanese-charset");this._currentTitle.onSlideTransitionStart(titleCapability.metadata)}}}},{key:"onSlideTransitionEnd",value:function(){this._currentTitle&&this._currentTitle.onSlideTransitionEnd()}},{key:"onSlideTimeUpdate",value:function(elapsedTime,totalDuration){this._currentTitle&&this._currentTitle.onSlideTimeUpdate(elapsedTime,totalDuration)}},{key:"initComponent",value:function(){}},{key:"_setCurrentTitle",value:function(title){this._currentTitle?(this._currentTitle.destroy(),Object(DomUtils.O)(this._$container,this._currentTitleClass,title.className)):Object(DomUtils.a)(this._$container,title.className),this._currentTitleClass=title.className,this._$container.innerHTML="",this._currentTitle=title,this._currentTitle.initComponent(this._$container)}},{key:"_initTitleTypes",value:function(){var _this2=this;this._titleMap.set(SlideTitleTypeEnum.Default,new DefaultTitle_DefaultTitle(this,this._globalDomUtils,this._interactionService,this._resizeObserver,this._isMobile,new DefaultTitleTemplate_DefaultTitleTemplate)),this._titleMap.set(SlideTitleTypeEnum.Description,new DescriptionTitle_DescriptionTitle(this,this._globalDomUtils,this._interactionService,this._resizeObserver,this._isMobile,new DescriptionTitleTemplate_DescriptionTitleTemplate)),this._titleMap.set(SlideTitleTypeEnum.Quote,new QuoteTitle_QuoteTitle(this,this._globalDomUtils,this._interactionService,this._resizeObserver,this._isMobile,new QuoteTitleTemplate_QuoteTitleTemplate)),this._titleMap.set(SlideTitleTypeEnum.Bullet,new BulletTitle_BulletTitle(this,this._globalDomUtils,this._interactionService,this._resizeObserver,this._isMobile,new BulletTitleTamplate_BulletTitleTemplate)),this._titleMap.set(SlideTitleTypeEnum.Cover,new CoverTitle_CoverTitle(this,this._globalDomUtils,this._interactionService,this._resizeObserver,this._isMobile,new CoverTitleTemplate_CoverTitleTemplate)),this._titleMap.set(SlideTitleTypeEnum.Instagram,new InstagramTitle_InstagramTitle(this,this._globalDomUtils,this._interactionService,this._resizeObserver,this._isMobile,new InstagramTitleTemplate_InstagramTitleTemplate)),this._titleMap.forEach(function(title){title.eventList.forEach(function(event){_this2.subscribe(event,title,function(){var data={payload:null};event===UiPlayspaceEventsEnum.CallToAction&&(data.payload=_this2._currentCtaUrl),_this2.mediator.publish(_this2,event,data)})})})}},{key:"destroy",value:function(){get_default()(getPrototypeOf_default()(SlideTitle.prototype),"destroy",this).call(this),this._currentTitle&&this._currentTitle.destroy()}}]),SlideTitle}(ABaseComponent_ABaseComponent),Config_PlayspaceGeneralComponentsConfig=defineProperty_default()({},UiComponentsEnum[UiComponentsEnum.SkipAd],{template:getGeneralButtonTemplate(UiComponentsEnum.SkipAd,"Skip Ad",!1),tooltip:"Skip Ad",isHoverable:!1}),TopTitleTemplate_TopTitleTemplate=function(){function TopTitleTemplate(_logoUrl){classCallCheck_default()(this,TopTitleTemplate),this._logoUrl=_logoUrl}return createClass_default()(TopTitleTemplate,[{key:"_getLogoComponnent",value:function(){return this._logoUrl?"[[".concat(UiComponentsEnum.TopLogo,"]]"):""}},{key:"template",get:function(){return'\n            <cnx class="'.concat(CSSClassTopArticleComponentEnum.Main,'">\n                ').concat(this._getLogoComponnent(),'\n                <cnx class="').concat(CSSClassTopArticleComponentEnum.TitlesContainer,'">\n                    [[').concat(UiComponentsEnum.TopStoryTitle,"]]\n                    [[").concat(UiComponentsEnum.TopSlideTitle,"]]\n                </cnx>\n            </cnx>\n        ").trim()}}]),TopTitleTemplate}(),SlideTitleTemplate_SlideTitleTemplate=function(){function SlideTitleTemplate(){classCallCheck_default()(this,SlideTitleTemplate)}return createClass_default()(SlideTitleTemplate,[{key:"template",get:function(){return'<a class="'.concat(CSSClassSlideTitleEnum.Wrapper,'"></a>')}}]),SlideTitleTemplate}();function TopLogo_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var TopLogo_TopLogo=function(_AClickComponent){inherits_default()(TopLogo,_AClickComponent);var _super=TopLogo_createSuper(TopLogo);function TopLogo(mediator,_globalDomUtils,interactionService,template,_isMobile,logoUrl){var _this;return classCallCheck_default()(this,TopLogo),(_this=_super.call(this,mediator,_globalDomUtils,interactionService,template,_isMobile)).mediator=mediator,_this._isMobile=_isMobile,_this.eventList=[].concat(toConsumableArray_default()(_this.eventList),[UiComponentEventsEnum[UiComponentEventsEnum.LogoClicked]]),_this.hideComponent(!1),_this._$logo=_this._$container.querySelector(".".concat(CSSClassTopArticleComponentEnum.Logo)),_this._$logo.src="".concat(logoUrl),_this._$logo.alt="",_this._$logo.onload=function(){_this._setOrientation()},_this}return createClass_default()(TopLogo,[{key:"show",value:function(properties){this.showComponent(properties.useTransition)}},{key:"hide",value:function(properties){this.hideComponent(properties.useTransition)}},{key:"update",value:function(properties){this.showComponent(properties.useTransition)}},{key:"triggerLogoAnimation",value:function(){Object(DomUtils.a)(this._$container,CSSClassTopArticleComponentEnum.LogoAnimation)}},{key:"onClickHandler",value:function(){this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.LogoClicked])}},{key:"_setOrientation",value:function(){this._$logo.naturalHeight>this._$logo.naturalWidth?this._$logo.naturalWidth>this._$logo.parentElement.clientWidth&&this._$logo.naturalWidth/this._$logo.naturalHeight>=.8?Object(DomUtils.a)(this._$logo,CSSClassTopArticleComponentEnum.LogoLandscape):Object(DomUtils.a)(this._$logo,CSSClassTopArticleComponentEnum.LogoPortrait):this._$logo.naturalHeight>this._$logo.parentElement.clientHeight&&this._$logo.naturalHeight/this._$logo.naturalWidth>=.8?Object(DomUtils.a)(this._$logo,CSSClassTopArticleComponentEnum.LogoPortrait):Object(DomUtils.a)(this._$logo,CSSClassTopArticleComponentEnum.LogoLandscape)}}]),TopLogo}(AClickComponent_AClickComponent),TopLogoTemplate_TopLogoTemplate=function(){function TopLogoTemplate(){classCallCheck_default()(this,TopLogoTemplate)}return createClass_default()(TopLogoTemplate,[{key:"template",get:function(){return'\n            <cnx class="'.concat(CSSClassTopArticleComponentEnum.LogoContainer,'">\n                <img class="').concat(CSSClassTopArticleComponentEnum.Logo,'" />\n            </cnx>\n        ').trim()}}]),TopLogoTemplate}(),TopSlideTitleTemplate_TopSlideTitleTemplate=function(){function TopSlideTitleTemplate(){classCallCheck_default()(this,TopSlideTitleTemplate)}return createClass_default()(TopSlideTitleTemplate,[{key:"template",get:function(){return'\n            <cnx class="'.concat(CSSClassTopArticleComponentEnum.TopSlideTitle," ").concat(CssClassesConfig.m.InheritTitleFontFamily,'">\n                <cnx class="').concat(CSSClassTopArticleComponentEnum.TextPlaceholder,'">\n                    <cnx class="').concat(CSSClassTopArticleComponentEnum.Text," ").concat(CssClassesConfig.f.SecondaryColor,'">\n                        <cnx class="').concat(CSSClassTopArticleComponentEnum.TextOuterContainer,'">\n                            <cnx class="').concat(CSSClassTopArticleComponentEnum.TextInnerContainer,'"></cnx>\n                        </cnx>\n                    </cnx>\n                </cnx>\n            </cnx>\n        ').trim()}}]),TopSlideTitleTemplate}(),TopStoryTitleTemplate_TopStoryTitleTemplate=function(){function TopStoryTitleTemplate(){classCallCheck_default()(this,TopStoryTitleTemplate)}return createClass_default()(TopStoryTitleTemplate,[{key:"template",get:function(){return'\n            <cnx class="'.concat(CSSClassTopArticleComponentEnum.TopStoryTitle," ").concat(CssClassesConfig.m.InheritTitleFontFamily,'">\n                <cnx class="').concat(CSSClassTopArticleComponentEnum.TextPlaceholder,'">\n                    <cnx class="').concat(CSSClassTopArticleComponentEnum.Text," ").concat(CssClassesConfig.f.SecondaryColor,'">\n                        <cnx class="').concat(CSSClassTopArticleComponentEnum.TextOuterContainer,'">\n                            <cnx class="').concat(CSSClassTopArticleComponentEnum.TextInnerContainer,'"></cnx>\n                        </cnx>\n                    </cnx>\n                </cnx>\n            </cnx>\n        ').trim()}}]),TopStoryTitleTemplate}();function TopSlideItem_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var TopSlideItem_TopSlideItem=function(_ABaseComponent){inherits_default()(TopSlideItem,_ABaseComponent);var _super=TopSlideItem_createSuper(TopSlideItem);function TopSlideItem(mediator,_globalDomUtilsService,interactionService,template,_isMobile){var _this;return classCallCheck_default()(this,TopSlideItem),(_this=_super.call(this,mediator,_globalDomUtilsService,interactionService,template,_isMobile)).mediator=mediator,_this.eventList=[],_this._$textContainer=_this._$container.querySelector(".".concat(CSSClassTopArticleComponentEnum.TextInnerContainer)),_this}return createClass_default()(TopSlideItem,[{key:"show",value:function(properties){if(this._$textContainer){var label=properties.label,useTransition=properties.useTransition;Object(TypeUtils.h)(label)&&label!==this._label&&(clearTimeout(this._slideInAnimationTimer),this._label=label,this._setInnerText(label),this._slideIn(useTransition))}}},{key:"initComponent",value:function(){}},{key:"hide",value:function(properties){var useTransition=properties.useTransition;clearTimeout(this._slideInAnimationTimer),this._slideOut(useTransition),this._label=null}},{key:"update",value:function(properties){var _this2=this;if(this._$textContainer){var label=properties.label,useTransition=properties.useTransition;Object(TypeUtils.h)(label)&&label!==this._label&&(clearTimeout(this._slideInAnimationTimer),this._slideOut(useTransition),this._label=label,this._slideInAnimationTimer=setTimeout(function(){_this2._setInnerText(label),_this2._slideIn(useTransition)},600))}}},{key:"_setInnerText",value:function(label){Object(TypeUtils.h)(label)&&isJapaneseText(label)&&Object(DomUtils.a)(this._$container,"cnx-japanese-charset"),this._$textContainer.innerHTML=label}},{key:"_slideIn",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]){if(Object(DomUtils.u)(this._$container,CSSClassTopArticleComponentEnum.SlideIn))return;this._resetAnimation(),Object(DomUtils.L)(this._$container,CssClassesConfig.h.Hide,CssClassesConfig.h.Active),Object(DomUtils.i)(this._$container),Object(DomUtils.O)(this._$container,CSSClassTopArticleComponentEnum.SlideOut,CSSClassTopArticleComponentEnum.SlideIn)}else Object(DomUtils.O)(this._$container,CssClassesConfig.h.Hide,CssClassesConfig.h.Active),Object(DomUtils.L)(this._$container,CSSClassTopArticleComponentEnum.SlideIn,CSSClassTopArticleComponentEnum.SlideOut)}},{key:"_slideOut",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(Object(DomUtils.L)(this._$container,CssClassesConfig.h.Hide,CssClassesConfig.h.Active),Object(DomUtils.O)(this._$container,CSSClassTopArticleComponentEnum.SlideIn,CSSClassTopArticleComponentEnum.SlideOut)):(Object(DomUtils.O)(this._$container,CssClassesConfig.h.Active,CssClassesConfig.h.Hide),Object(DomUtils.L)(this._$container,CSSClassTopArticleComponentEnum.SlideIn,CSSClassTopArticleComponentEnum.SlideOut))}},{key:"_resetAnimation",value:function(){var classNames=[CSSClassTopArticleComponentEnum.SlideIn,CSSClassTopArticleComponentEnum.SlideOut];DomUtils.L.apply(void 0,[this._$textContainer].concat(classNames)),Object(DomUtils.i)(this._$textContainer)}}]),TopSlideItem}(ABaseComponent_ABaseComponent);function TextLabel_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var TextLabel_TextLabel=function(_ABaseComponent){inherits_default()(TextLabel,_ABaseComponent);var _super=TextLabel_createSuper(TextLabel);function TextLabel(){var _this;return classCallCheck_default()(this,TextLabel),(_this=_super.apply(this,arguments)).eventList=[],_this}return createClass_default()(TextLabel,[{key:"initComponent",value:function(){}},{key:"onSlideTimeUpdate",value:function(){}},{key:"onSlideTransitionEnd",value:function(){}},{key:"onSlideTransitionStart",value:function(capabilityList){var textLabelCapability=this._getTextLabelCapability(capabilityList);textLabelCapability&&this._setLabel(textLabelCapability.metadata.label)}},{key:"_getTextLabelCapability",value:function(capabilityList){return capabilityList.find(function(_ref){var type=_ref.type,metadata=_ref.metadata;return type===SlideCapabilityTypeEnum.TextLabel&&Object(TypeUtils.f)(metadata)})}},{key:"_setLabel",value:function(label){Object(TypeUtils.h)(label)&&(this._$container.innerText=label)}}]),TextLabel}(ABaseComponent_ABaseComponent),TextLabelTemplate=__webpack_require__(211),TextLabelTemplate_default=__webpack_require__.n(TextLabelTemplate);function UiPlayspaceComponentFactory_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var UiPlayspaceComponentFactory_UiPlayspaceComponentFactory=function(_AUiBaseComponentFact){inherits_default()(UiPlayspaceComponentFactory,_AUiBaseComponentFact);var _super=UiPlayspaceComponentFactory_createSuper(UiPlayspaceComponentFactory);function UiPlayspaceComponentFactory(_globalDomUtils,_interactionService,_resizeObserverService,_$container,_settings){var _this$_createComponen,_this;return classCallCheck_default()(this,UiPlayspaceComponentFactory),(_this=_super.call(this,_globalDomUtils,_interactionService,_$container,_settings,Config_PlayspaceGeneralComponentsConfig))._globalDomUtils=_globalDomUtils,_this._interactionService=_interactionService,_this._resizeObserverService=_resizeObserverService,_this._$container=_$container,_this._settings=_settings,_this._createComponentActions=(_this$_createComponen={},defineProperty_default()(_this$_createComponen,UiComponentsEnum.VolumeButton,function(componentMediator){return new VolumeButton_VolumeButton(componentMediator,_this._globalDomUtils,_this._interactionService,volumeButtonHoverableTemplate_default.a,VolumeButtonStates.Mute,_this._settings.isMobile)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.PlayspaceProgressBar,function(componentMediator){return new PlayspaceProgressBar_PlayspaceProgressBar(componentMediator,_this._globalDomUtils,_this._interactionService,playspaceProgressBarTemplate_default.a,_this._settings.isMobile)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.PlayspaceSettingsMenu,function(componentMediator){return new PlayspaceSettingsMenu_PlayspaceSettingsMenu(componentMediator,_this._globalDomUtils,_this._interactionService,playspaceSettingsMenuTemplate_default.a,UiComponentEventsEnum[UiComponentEventsEnum.SettingsMenu],UiComponentsEnum.PlayspaceSettingsMenu,_this._$container,_this._settings.isMobile)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.CtaButton,function(componentMediator){return new CtaButton_CtaButton(componentMediator,_this._globalDomUtils,_this._interactionService,_this._resizeObserverService,new CtaButtonTemplate_CtaButtonTemplate,_this._settings.isMobile,_this._settings.disableClickUrl)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.ClickToPlayButton,function(componentMediator){return new ClickToPlayButton_ClickToPlayButton(componentMediator,_this._globalDomUtils,_this._interactionService,clickToPlayButtonTemplate_default.a,_this._settings.isMobile)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.TopTitle,function(componentMediator){return new TopTitle_TopTitle(componentMediator,_this._globalDomUtils,new TopTitleTemplate_TopTitleTemplate(_this._settings.logoUrl).template,assertThisInitialized_default()(_this))}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.TopLogo,function(componentMediator){return new TopLogo_TopLogo(componentMediator,_this._globalDomUtils,_this._interactionService,(new TopLogoTemplate_TopLogoTemplate).template,_this._settings.isMobile,_this._settings.logoUrl)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.TopSlideTitle,function(componentMediator){return new TopSlideItem_TopSlideItem(componentMediator,_this._globalDomUtils,_this._interactionService,(new TopSlideTitleTemplate_TopSlideTitleTemplate).template,_this._settings.isMobile)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.TopStoryTitle,function(componentMediator){return new TopSlideItem_TopSlideItem(componentMediator,_this._globalDomUtils,_this._interactionService,(new TopStoryTitleTemplate_TopStoryTitleTemplate).template,_this._settings.isMobile)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.SlideTitle,function(componentMediator){return new SlideTitle_SlideTitle(componentMediator,_this._globalDomUtils,_this._interactionService,(new SlideTitleTemplate_SlideTitleTemplate).template,_this._resizeObserverService,_this._settings.isMobile,_this._settings.disableClickUrl)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.ElapsedTimeLabel,function(componentMediator){return new TimeLabel_TimeLabel(componentMediator,_this._globalDomUtils,_this._interactionService,timeLabelTemplate_default.a)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.TotalDurationLabel,function(componentMediator){return new TimeLabel_TimeLabel(componentMediator,_this._globalDomUtils,_this._interactionService,timeLabelTemplate_default.a)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.VolumeControls,function(componentMediator){return new VolumeControl_VolumeControls(componentMediator,_this._globalDomUtils,VolumeControlTemplate,assertThisInitialized_default()(_this))}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.ProgressBar,function(componentMediator){return new ProgressBar_ProgressBar(componentMediator,_this._globalDomUtils,_this._interactionService,draggableProgressBarTemplate_default.a,_this._settings.isMobile)}),defineProperty_default()(_this$_createComponen,UiComponentsEnum.TextLabel,function(componentMediator){return new TextLabel_TextLabel(componentMediator,_this._globalDomUtils,_this._interactionService,TextLabelTemplate_default.a)}),_this$_createComponen),_this._getCreateComponentAction=function(componentName){return function(componentMediator){var createComponent=_this._createComponentActions[componentName];if(createComponent)return createComponent(componentMediator)}},_this}return createClass_default()(UiPlayspaceComponentFactory,[{key:"createComponent",value:function(componentName,componentMediator){var createComponent=this._getCreateComponentAction(componentName);return createComponent(componentMediator)||get_default()(getPrototypeOf_default()(UiPlayspaceComponentFactory.prototype),"createComponent",this).call(this,componentName,componentMediator)}}]),UiPlayspaceComponentFactory}(AUiBaseComponentFactory_AUiBaseComponentFactory),UiContextMenuHandler_UiContextMenuHandler=function(){function UiContextMenuHandler(_contextMenuList){classCallCheck_default()(this,UiContextMenuHandler),this._contextMenuList=_contextMenuList}return createClass_default()(UiContextMenuHandler,[{key:"_getAllOtherContextMenus",value:function(targetContextMenu){return this._contextMenuList.filter(function(contextMenu){return targetContextMenu.instance!==contextMenu.instance})}},{key:"_getContextMenu",value:function(contextMenuName){return this._contextMenuList.find(function(_ref){var name=_ref.name;return contextMenuName===name})}},{key:"_closeContextMenus",value:function(contextMenuList){contextMenuList.forEach(function(_ref2){var instance=_ref2.instance;instance.isOpen&&instance.close()})}},{key:"toggleContextMenu",value:function(contextMenuName){var settings=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},contextMenu=this._getContextMenu(contextMenuName);if(contextMenu.instance.isOpen)return contextMenu.instance.close(),!1;var targetCoordinates=settings.targetCoordinates,holdPause=settings.holdPause,coordinates=targetCoordinates||contextMenu.instance.getAnchorCoordinatesTo(contextMenu.linkedComponent);return contextMenu.instance.open(coordinates,holdPause),this._closeContextMenus(this._getAllOtherContextMenus(contextMenu)),!0}},{key:"isAnyContextMenuOpen",value:function(){return!!this._contextMenuList.find(function(_ref3){return _ref3.instance.isOpen})}},{key:"closeContextMenu",value:function(name){var instance=this._getContextMenu(name).instance;instance.isOpen&&instance.close()}},{key:"closeAllContextMenus",value:function(){this._closeContextMenus(this._contextMenuList)}}]),UiContextMenuHandler}();function PlayspaceStatePlaying_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var PlayspaceStatePlaying_PlayspaceStatePlaying=function(_AUiStatePlaying){inherits_default()(PlayspaceStatePlaying,_AUiStatePlaying);var _super=PlayspaceStatePlaying_createSuper(PlayspaceStatePlaying);function PlayspaceStatePlaying(){return classCallCheck_default()(this,PlayspaceStatePlaying),_super.apply(this,arguments)}return createClass_default()(PlayspaceStatePlaying,[{key:"enterState",value:function(){get_default()(getPrototypeOf_default()(PlayspaceStatePlaying.prototype),"enterState",this).call(this);var progress=this.context.getComponent(UiComponentsEnum.PlayspaceProgressBar);progress&&progress.startProgress();var cta=this.context.getComponent(UiComponentsEnum.CtaButton);cta&&cta.startProgress(),this.context.interactionService.enableSpecialInteractions(this.context.$container),this.context.autoHideHandler&&this.context.autoHideHandler.startAutoHide()}},{key:"exitState",value:function(){get_default()(getPrototypeOf_default()(PlayspaceStatePlaying.prototype),"exitState",this).call(this),this.context.autoHideHandler&&this.context.autoHideHandler.showUi()}},{key:"updateDuration",value:function(){var progress=this.context.getComponent(UiComponentsEnum.PlayspaceProgressBar);progress&&progress.startProgress()}}]),PlayspaceStatePlaying}(AUiStatePlaying_AUiStatePlaying);function PlayspaceStatePaused_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var PlayspaceStatePaused_PlayspaceStatePaused=function(_AUiStatePaused){inherits_default()(PlayspaceStatePaused,_AUiStatePaused);var _super=PlayspaceStatePaused_createSuper(PlayspaceStatePaused);function PlayspaceStatePaused(){return classCallCheck_default()(this,PlayspaceStatePaused),_super.apply(this,arguments)}return createClass_default()(PlayspaceStatePaused,[{key:"enterState",value:function(){get_default()(getPrototypeOf_default()(PlayspaceStatePaused.prototype),"enterState",this).call(this);var progress=this.context.getComponent(UiComponentsEnum.PlayspaceProgressBar);progress&&progress.pauseProgress();var cta=this.context.getComponent(UiComponentsEnum.CtaButton);cta&&cta.pauseProgress(),this.context.interactionService.disableSpecialInteractions(this.context.$container)}},{key:"exitState",value:function(){get_default()(getPrototypeOf_default()(PlayspaceStatePaused.prototype),"exitState",this).call(this)}},{key:"updateDuration",value:function(){}}]),PlayspaceStatePaused}(AUiStatePaused_AUiStatePaused);function PlayspaceStateStopped_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var PlayspaceStateStopped_PlayspaceStateStopped=function(_PlayspaceStatePaused){inherits_default()(PlayspaceStateStopped,_PlayspaceStatePaused);var _super=PlayspaceStateStopped_createSuper(PlayspaceStateStopped);function PlayspaceStateStopped(){return classCallCheck_default()(this,PlayspaceStateStopped),_super.apply(this,arguments)}return createClass_default()(PlayspaceStateStopped,[{key:"enterState",value:function(){get_default()(getPrototypeOf_default()(PlayspaceStateStopped.prototype),"enterState",this).call(this),this.context.interactionService.disableSpecialInteractions(this.context.$container)}},{key:"exitState",value:function(){get_default()(getPrototypeOf_default()(PlayspaceStateStopped.prototype),"exitState",this).call(this)}}]),PlayspaceStateStopped}(PlayspaceStatePaused_PlayspaceStatePaused);function PlayspaceStateRoll_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var PlayspaceStateRoll_PlayspaceStateRoll=function(_PlayspaceStatePaused){inherits_default()(PlayspaceStateRoll,_PlayspaceStatePaused);var _super=PlayspaceStateRoll_createSuper(PlayspaceStateRoll);function PlayspaceStateRoll(){return classCallCheck_default()(this,PlayspaceStateRoll),_super.apply(this,arguments)}return createClass_default()(PlayspaceStateRoll,[{key:"enterState",value:function(){get_default()(getPrototypeOf_default()(PlayspaceStateRoll.prototype),"enterState",this).call(this),Object(DomUtils.a)(this.context.$uiContainer,CssClassesConfig.j.Preroll);var rollLoader=this.context.getComponent(UiComponentsEnum.Loader);rollLoader&&rollLoader.show(),this.context.interactionService.disableSpecialInteractions(this.context.$container)}},{key:"exitState",value:function(){get_default()(getPrototypeOf_default()(PlayspaceStateRoll.prototype),"exitState",this).call(this),Object(DomUtils.L)(this.context.$uiContainer,CssClassesConfig.j.Preroll);var rollLoader=this.context.getComponent(UiComponentsEnum.Loader);rollLoader&&rollLoader.hide()}}]),PlayspaceStateRoll}(PlayspaceStatePaused_PlayspaceStatePaused);function PlayspaceStateHidden_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var _SLIDE_CAPABILITY_MAP,PlayspaceStateHidden_PlayspaceStateHidden=function(_PlayspaceStatePaused){inherits_default()(PlayspaceStateHidden,_PlayspaceStatePaused);var _super=PlayspaceStateHidden_createSuper(PlayspaceStateHidden);function PlayspaceStateHidden(){return classCallCheck_default()(this,PlayspaceStateHidden),_super.apply(this,arguments)}return createClass_default()(PlayspaceStateHidden,[{key:"enterState",value:function(){get_default()(getPrototypeOf_default()(PlayspaceStateHidden.prototype),"enterState",this).call(this),this.context.interactionService.disableSpecialInteractions(this.context.$container)}},{key:"exitState",value:function(){get_default()(getPrototypeOf_default()(PlayspaceStateHidden.prototype),"exitState",this).call(this)}},{key:"updateDuration",value:function(){var progress=this.context.getComponent(UiComponentsEnum.PlayspaceProgressBar);progress&&progress.resetProgress()}}]),PlayspaceStateHidden}(PlayspaceStatePaused_PlayspaceStatePaused),SlideCapabilityMap=(_SLIDE_CAPABILITY_MAP={},defineProperty_default()(_SLIDE_CAPABILITY_MAP,SlideCapabilityTypeEnum.PlaybackControls,[UiComponentsEnum.PlayButton]),defineProperty_default()(_SLIDE_CAPABILITY_MAP,SlideCapabilityTypeEnum.VolumeControls,[UiComponentsEnum.VolumeButton]),defineProperty_default()(_SLIDE_CAPABILITY_MAP,SlideCapabilityTypeEnum.CtaButton,[UiComponentsEnum.CtaButton]),defineProperty_default()(_SLIDE_CAPABILITY_MAP,SlideCapabilityTypeEnum.PlaylistControls,[UiComponentsEnum.UpNextButton,UiComponentsEnum.PreviousButton]),defineProperty_default()(_SLIDE_CAPABILITY_MAP,SlideCapabilityTypeEnum.SlideTitle,[UiComponentsEnum.SlideTitle]),defineProperty_default()(_SLIDE_CAPABILITY_MAP,SlideCapabilityTypeEnum.TextLabel,[UiComponentsEnum.TextLabel]),_SLIDE_CAPABILITY_MAP),UiSlideCapabilityHandler_UiSlideCapabilityHandler=function(){function UiSlideCapabilityHandler(){classCallCheck_default()(this,UiSlideCapabilityHandler),this._componentList=Object.keys(SlideCapabilityMap).reduce(function(components,capability){return[].concat(toConsumableArray_default()(components),toConsumableArray_default()(SlideCapabilityMap[capability]))},[])}return createClass_default()(UiSlideCapabilityHandler,[{key:"setCapabilityList",value:function(capabilityList){this._currentComponentList=capabilityList.map(function(capability){return SlideCapabilityMap[capability.type]}).filter(function(capability){return Array.isArray(capability)}).reduce(function(components,capability){return[].concat(toConsumableArray_default()(components),toConsumableArray_default()(capability))},[])}},{key:"getComponentList",value:function(){return{excludedComponents:Object(ArrayUtils.a)(this._componentList,this._currentComponentList),includedComponents:Object(ArrayUtils.b)(this._componentList,this._currentComponentList)}}}]),UiSlideCapabilityHandler}(),MobileUIAutoHideHandler_MobileUIAutoHideHandler=function(){function MobileUIAutoHideHandler(_$container){classCallCheck_default()(this,MobileUIAutoHideHandler),this._$container=_$container,this._isUIHidden=!1}return createClass_default()(MobileUIAutoHideHandler,[{key:"isUIHidden",value:function(){return this._isUIHidden}},{key:"startAutoHide",value:function(){var _this=this;this._autoHideTimeout=setTimeout(function(){_this._hideUI()},3e3)}},{key:"showUi",value:function(){clearTimeout(this._autoHideTimeout),this._showUi()}},{key:"resetAutoHideTimer",value:function(){clearTimeout(this._autoHideTimeout),this._showUi(),this.startAutoHide()}},{key:"_hideUI",value:function(){Object(DomUtils.a)(this._$container,CssClassesConfig.g.HideUI),this._isUIHidden=!0}},{key:"_showUi",value:function(){Object(DomUtils.L)(this._$container,CssClassesConfig.g.HideUI),this._isUIHidden=!1}}]),MobileUIAutoHideHandler}(),InteractionServiceEnums=__webpack_require__(29);function UiPlayspace_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var UiPlayspace_UiPlayspace=function(_AUiBase){inherits_default()(UiPlayspace,_AUiBase);var _super=UiPlayspace_createSuper(UiPlayspace);function UiPlayspace(mediator,$container,globalDomUtilsService,resizeObserverService,templateString,settings,_appId,_startState,interactionService){var _this$_states,_this;return classCallCheck_default()(this,UiPlayspace),(_this=_super.call(this,mediator,$container,globalDomUtilsService,templateString,new UiPlayspaceComponentFactory_UiPlayspaceComponentFactory(globalDomUtilsService,interactionService,resizeObserverService,$container,settings))).mediator=mediator,_this.$container=$container,_this.globalDomUtilsService=globalDomUtilsService,_this.settings=settings,_this._appId=_appId,_this.interactionService=interactionService,_this._lightenAccentPercentage=80,_this._slidingTimelineComponents=[UiComponentsEnum.SlideTitle,UiComponentsEnum.CtaButton,UiComponentsEnum.TopTitle,UiComponentsEnum.TextLabel],_this._states=(_this$_states={},defineProperty_default()(_this$_states,ContentStatesEnum.PlayingState,new PlayspaceStatePlaying_PlayspaceStatePlaying(assertThisInitialized_default()(_this))),defineProperty_default()(_this$_states,ContentStatesEnum.PausedState,new PlayspaceStatePaused_PlayspaceStatePaused(assertThisInitialized_default()(_this))),defineProperty_default()(_this$_states,ContentStatesEnum.StoppedState,new PlayspaceStateStopped_PlayspaceStateStopped(assertThisInitialized_default()(_this))),defineProperty_default()(_this$_states,ContentStatesEnum.HiddenState,new PlayspaceStateHidden_PlayspaceStateHidden(assertThisInitialized_default()(_this))),defineProperty_default()(_this$_states,ContentStatesEnum.PrerollState,new PlayspaceStateRoll_PlayspaceStateRoll(assertThisInitialized_default()(_this))),defineProperty_default()(_this$_states,ContentStatesEnum.PostrollState,new PlayspaceStateRoll_PlayspaceStateRoll(assertThisInitialized_default()(_this))),_this$_states),_this._capabilityHandler=new UiSlideCapabilityHandler_UiSlideCapabilityHandler,_this._onOverlayClick=function(){_this.mediator.publish(assertThisInitialized_default()(_this),UiComponentEventsEnum[UiComponentEventsEnum.Play]),_this._trackClickEvents(UiComponentEventsEnum[UiComponentEventsEnum.Play])},_this._$footer=_this.$container.querySelector(".".concat(CSSClassMainPlayspaceEnum.Footer)),_this._setSlideTitleFooter(),_this._addCustomColorsCss(),_this._addContextMenuHandler(),_this._handleContentInteraction(),_this._states[_startState].enterState(),_this._setCurrentCapabilityList(),_this._applyCurrentCapabilityList(!1),_this._conditionallyHideExpandButton(),_this._$mediaContainer=_this.$uiContainer.querySelector(".".concat(CSSClassMainPlayspaceEnum.Content)),_this._$overlayComponent=_this.$uiContainer.querySelector(".".concat(CSSClassMainPlayspaceEnum.Overlay)),_this.interactionService.register(_this._$overlayComponent,assertThisInitialized_default()(_this),_this.interactionService),_this.subscribe(UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Click],_this.interactionService,function(){_this._onOverlayClick()}),_this}return createClass_default()(UiPlayspace,[{key:"_setSlideTitleFooter",value:function(){var slideTitle=this.getComponent(UiComponentsEnum.SlideTitle);slideTitle&&slideTitle.setFooterElement(this.footer)}},{key:"_resizeProgressBar",value:function(remainingTime,isPlaying){var playspaceProgressBar=this.getComponent(UiComponentsEnum.PlayspaceProgressBar);playspaceProgressBar&&playspaceProgressBar.resizeProgressBar(remainingTime,isPlaying)}},{key:"handleComponentEvent",value:function(eventName,eventData,component){switch(this._trackClickEvents(eventName),eventName){case UiComponentEventsEnum[UiComponentEventsEnum.Mute]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Volume],{payload:0});break;case UiComponentEventsEnum[UiComponentEventsEnum.Unmute]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Volume],{payload:1});break;case UiComponentsEnum[UiComponentsEnum.CloseButton]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Close]);break;case UiComponentsEnum[UiComponentsEnum.MoreButton]:this._contextMenuHandler.toggleContextMenu(UiComponentsEnum.PlayspaceSettingsMenu,{holdPause:!0});break;case UiComponentEventsEnum[UiComponentEventsEnum.AboutClick]:this.globalDomUtilsService.open(PlayerConfig.a,BrowserConfig.c.Blank);break;case UiComponentEventsEnum[UiComponentEventsEnum.Quality]:eventData.payload&&this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Quality],{payload:eventData.payload});break;case UiComponentsEnum[UiComponentsEnum.UpNextButton]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Next]);break;case UiComponentsEnum[UiComponentsEnum.PreviousButton]:this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Prev]);break;case UiPlayspaceEventsEnum.CallToAction:Object(TypeUtils.h)(eventData.payload)?this.mediator.publish(this,UiPlayspaceEventsEnum.CallToAction,eventData):this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Next]);break;default:this.mediator.publish(this,eventName,eventData)}}},{key:"_trackClickEvents",value:function(eventName){switch(eventName){case UiPlayspaceEventsEnum.CallToAction:this.mediator.publish(this,UiPlayspaceEventsEnum.GeneralClickInteraction,{payload:protos.ProtoMediaClickTypeEnum.UrlClick});break;case UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Scroll]:this.mediator.publish(this,UiPlayspaceEventsEnum.GeneralClickInteraction,{payload:protos.ProtoMediaClickTypeEnum.ScrollClick});break;case UiComponentsEnum[UiComponentsEnum.VolumeButton]:case UiComponentsEnum[UiComponentsEnum.VolumeProgress]:case UiComponentsEnum[UiComponentsEnum.VolumeControls]:this.mediator.publish(this,UiPlayspaceEventsEnum.GeneralClickInteraction,{payload:protos.ProtoMediaClickTypeEnum.VolumeClick});break;case UiComponentsEnum[UiComponentsEnum.PlayButton]:case UiComponentsEnum[UiComponentsEnum.BigPlayButton]:case UiComponentsEnum[UiComponentsEnum.ClickToPlayButton]:case UiComponentEventsEnum[UiComponentEventsEnum.Play]:this.mediator.publish(this,UiPlayspaceEventsEnum.GeneralClickInteraction,{payload:protos.ProtoMediaClickTypeEnum.PlayClick});break;case UiComponentEventsEnum[UiComponentEventsEnum.Pause]:this.mediator.publish(this,UiPlayspaceEventsEnum.GeneralClickInteraction,{payload:protos.ProtoMediaClickTypeEnum.PauseClick});break;case UiComponentEventsEnum[UiComponentEventsEnum.Next]:case UiComponentsEnum[UiComponentsEnum.UpNextButton]:case UiComponentsEnum[UiComponentsEnum.UpNextBox]:case UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.TapRight]:this.mediator.publish(this,UiPlayspaceEventsEnum.GeneralClickInteraction,{payload:protos.ProtoMediaClickTypeEnum.NextClick});break;case UiComponentEventsEnum[UiComponentEventsEnum.Prev]:case UiComponentsEnum[UiComponentsEnum.PreviousButton]:case UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.TapLeft]:this.mediator.publish(this,UiPlayspaceEventsEnum.GeneralClickInteraction,{payload:protos.ProtoMediaClickTypeEnum.PreviousClick});break;case UiComponentEventsEnum[UiComponentEventsEnum.Mute]:this.mediator.publish(this,UiPlayspaceEventsEnum.GeneralClickInteraction,{payload:protos.ProtoMediaClickTypeEnum.MuteClick});break;case UiComponentEventsEnum[UiComponentEventsEnum.Unmute]:this.mediator.publish(this,UiPlayspaceEventsEnum.GeneralClickInteraction,{payload:protos.ProtoMediaClickTypeEnum.UnmuteClick});break;case UiComponentEventsEnum[UiComponentEventsEnum.Close]:case UiComponentsEnum[UiComponentsEnum.CloseButton]:this.mediator.publish(this,UiPlayspaceEventsEnum.GeneralClickInteraction,{payload:protos.ProtoMediaClickTypeEnum.CloseClick})}}},{key:"_addContextMenuHandler",value:function(){var contextBindings=[],settingsMenu=this._getPlayspaceSettingsMenuComponent();settingsMenu&&contextBindings.push({instance:settingsMenu,linkedComponent:this.getComponent(UiComponentsEnum.MoreButton),name:UiComponentsEnum.PlayspaceSettingsMenu}),this._contextMenuHandler=new UiContextMenuHandler_UiContextMenuHandler(contextBindings)}},{key:"_handleContentInteraction",value:function(){var _this2=this;this.settings.isMobile&&this._addAutoHideHandler(),this.interactionService.register(this.$container,this,this.interactionService,{},[InteractionServiceEnums.c.Hold,InteractionServiceEnums.c.Swipe]);var nonInterruptibleInteractions=this.interactionService.getNonInterruptibleInteractions();Object.keys(UiInteractionEventsEnum.a).filter(function(x){return isNaN(parseInt(x,10))}).forEach(function(key){_this2.subscribe(key,_this2.interactionService,function(eventData){var isInteractionInterruptible=!nonInterruptibleInteractions.includes(UiInteractionEventsEnum.a[key]);if(_this2.autoHideHandler&&isInteractionInterruptible){if(_this2.autoHideHandler.isUIHidden())return void _this2.autoHideHandler.resetAutoHideTimer();_this2.autoHideHandler.resetAutoHideTimer()}_this2._trackClickEvents(key),_this2.mediator.publish(_this2,key,eventData)})})}},{key:"_addAutoHideHandler",value:function(){this.autoHideHandler=new MobileUIAutoHideHandler_MobileUIAutoHideHandler(this.$container)}},{key:"_addCustomColorsCss",value:function(){var uniqueID="id_".concat(this._appId);this.$uiContainer.id=uniqueID;var _this$_getFontFamily=this._getFontFamily(),bodyFontFamily=_this$_getFontFamily.bodyFontFamily,titleFontFamily=_this$_getFontFamily.titleFontFamily,cssString="\n            #".concat(uniqueID," .").concat(CssClassesConfig.f.AccentColor," {\n                fill: ").concat(this.settings.accentColorList.background,";\n                background-color: ").concat(this.settings.accentColorList.background,";\n                color: ").concat(this.settings.accentColorList.foreground,";\n                stroke: ").concat(this.settings.accentColorList.background,";\n            }\n            #").concat(uniqueID," .").concat(CssClassesConfig.f.AccentColor," .cnx-cta-btn-arrow svg{\n                fill: ").concat(this.settings.accentColorList.foreground,";\n            }\n            @keyframes ").concat(uniqueID,"-bar {\n                1% {\n                  fill: transparent; transform: scaleY(1)\n                }\n                30% {fill: ").concat(this.settings.accentColorList.background,"; transform: scaleY(1.1)}\n                60% {fill: transparent; transform: scaleY(1)}\n                100% {fill: transparent; transform: scaleY(1)}\n            }\n            #").concat(uniqueID," .cnx-ui-loader polygon {\n                animation-name: ").concat(uniqueID,"-bar;\n            }\n            #").concat(uniqueID," .").concat(CssClassesConfig.f.PrimaryColor," {\n                background: ").concat(this.settings.primaryColorList.background,";\n                color: ").concat(this.settings.primaryColorList.foreground,";\n            }\n            #").concat(uniqueID," .").concat(CssClassesConfig.f.SecondaryColor," {\n                background: ").concat(this.settings.secondaryColorList.background,";\n                color: ").concat(this.settings.secondaryColorList.foreground,";\n            }\n            #").concat(uniqueID," .").concat(CssClassesConfig.f.TitleComponent,".").concat(CssClassesConfig.f.TitleLink,":").concat(this.settings.isMobile?"active":"hover"," .").concat(CSSClassSlideTitleEnum.Text," {\n                background-color: ").concat(Object(GeneralUtils.j)(this.settings.accentColorList.background,this._lightenAccentPercentage),"\n            }\n            #").concat(uniqueID," .").concat(CssClassesConfig.f.SlideProgressBar," .").concat(CssClassesConfig.f.ProgressFill,".").concat(CssClassesConfig.f.AccentColor," {\n                background-color: ").concat(this.settings.useAccentColorForProgressBar?this.settings.accentColorList.background:CssClassesConfig.l.Icons,"\n            }\n            #").concat(uniqueID," em {\n                color: ").concat(this.settings.accentColorList.background,";\n            }\n            #").concat(uniqueID," .").concat(CssClassesConfig.m.InheritTitleFontFamily," {\n                font-family: ").concat(titleFontFamily," !important;\n            }\n            #").concat(uniqueID," .").concat(CssClassesConfig.m.InheritBodyFontFamily," {\n                font-family: ").concat(bodyFontFamily," !important;\n            }\n        ").trim();this.globalDomUtilsService.addCssString(cssString)}},{key:"_getFontFamily",value:function(){var _this$settings$fontFa=this.settings.fontFamilySettings,bodyFontFamily=_this$settings$fontFa.bodyFontFamily,titleFontFamily=_this$settings$fontFa.titleFontFamily;return Object(TypeUtils.h)(bodyFontFamily)&&Object(TypeUtils.h)(titleFontFamily)?this.settings.fontFamilySettings:{titleFontFamily:Object(DomUtils.q)(this.$container),bodyFontFamily:Object(DomUtils.j)(this.$container)}}},{key:"_conditionallyHideExpandButton",value:function(){this._shouldHideExpandButton()&&this.hideExpandButton()}},{key:"_shouldHideExpandButton",value:function(){return this._isIOS()||!this._isExpandButtonEnabled()}},{key:"_isIOS",value:function(){return this.settings.os===OsConfig.b.Ios}},{key:"_isExpandButtonEnabled",value:function(){return!0===this.settings.expandButtonEnabled}},{key:"_changeCtaLabel",value:function(){var metadata=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},ctaBtn=this.getComponent(UiComponentsEnum.CtaButton);ctaBtn&&Object(TypeUtils.h)(metadata.label)&&ctaBtn.changeLabel(metadata.label)}},{key:"hideExpandButton",value:function(){this._getPlayspaceSettingsMenuComponent().hideExpandButton()}},{key:"showExpandButton",value:function(){this._getPlayspaceSettingsMenuComponent().showExpandButton()}},{key:"_getPlayspaceSettingsMenuComponent",value:function(){return this.getComponent(UiComponentsEnum.PlayspaceSettingsMenu)}},{key:"_setCurrentCapabilityList",value:function(){var capabilityList=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._capabilityHandler.setCapabilityList(capabilityList)}},{key:"_applyCurrentCapabilityList",value:function(){var _this3=this,useTransition=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],_this$_capabilityHand=this._capabilityHandler.getComponentList(),excludedComponents=_this$_capabilityHand.excludedComponents,includedComponents=_this$_capabilityHand.includedComponents;excludedComponents.map(function(item){return _this3.getComponent(item)}).forEach(function(component){return component&&component.hideComponent(useTransition)}),includedComponents.map(function(item){return _this3.getComponent(item)}).forEach(function(component){return component&&component.showComponent(useTransition)})}},{key:"updateQualityMenu",value:function(qualities){var settingsMenu=this.getComponent(UiComponentsEnum.PlayspaceSettingsMenu);settingsMenu&&settingsMenu.updateQualityMenu(qualities)}},{key:"updateQuality",value:function(quality){var settingsMenu=this.getComponent(UiComponentsEnum.PlayspaceSettingsMenu);settingsMenu&&settingsMenu.updateQuality(quality)}},{key:"setTotalSlides",value:function(numberOfSlides){var playspaceProgressBar=this.getComponent(UiComponentsEnum.PlayspaceProgressBar);playspaceProgressBar&&playspaceProgressBar.setSlides(numberOfSlides)}},{key:"setDuration",value:function(duration){var playspaceProgressBar=this.getComponent(UiComponentsEnum.PlayspaceProgressBar);playspaceProgressBar&&(playspaceProgressBar.setDuration(duration),this.currentState.updateDuration())}},{key:"setCurrentIndex",value:function(index){var playspaceProgressBar=this.getComponent(UiComponentsEnum.PlayspaceProgressBar);playspaceProgressBar&&playspaceProgressBar.setCurrentIndex(index)}},{key:"updateVolume",value:function(volume){var volumeButton=this.getComponent(UiComponentsEnum.VolumeButton);volumeButton&&volumeButton.setState(volume>0?VolumeButtonStates.Unmute:VolumeButtonStates.Mute)}},{key:"expand",value:function(){this._getPlayspaceSettingsMenuComponent().setExpand()}},{key:"collapse",value:function(){this._getPlayspaceSettingsMenuComponent().setCollapse()}},{key:"onResizeUi",value:function(remainingTime,isPlaying){this._contextMenuHandler.closeAllContextMenus(),this._resizeProgressBar(remainingTime,isPlaying)}},{key:"onFirstTimeInView",value:function(){var playspaceTopTitle=this.getComponent(UiComponentsEnum.TopTitle);playspaceTopTitle&&playspaceTopTitle.triggerLogoAnimation()}},{key:"hide",value:function(){get_default()(getPrototypeOf_default()(UiPlayspace.prototype),"hide",this).call(this)}},{key:"setMediaContainerRatio",value:function($ratioElement){Object(DomUtils.J)(this._$mediaContainer,$ratioElement)}},{key:"onSlideTransitionStart",value:function(capabilityList){var _this4=this,playspaceProgressBar=this.getComponent(UiComponentsEnum.PlayspaceProgressBar);playspaceProgressBar&&playspaceProgressBar.pauseProgress(),this._setCurrentCapabilityList(capabilityList),this._applyCurrentCapabilityList(),this._slidingTimelineComponents.forEach(function(slidingTimelineComponent){var renderedSlidingTimelineComponent=_this4.getComponent(slidingTimelineComponent);renderedSlidingTimelineComponent&&renderedSlidingTimelineComponent.onSlideTransitionStart&&renderedSlidingTimelineComponent.onSlideTransitionStart(capabilityList)})}},{key:"onSlideTransitionEnd",value:function(){var _this5=this;this._slidingTimelineComponents.forEach(function(slidingTimelineComponent){var renderedSlidingTimelineComponent=_this5.getComponent(slidingTimelineComponent);renderedSlidingTimelineComponent&&renderedSlidingTimelineComponent.onSlideTransitionEnd&&renderedSlidingTimelineComponent.onSlideTransitionEnd()})}},{key:"onSlideTimeUpdate",value:function(elapsedTime,totalDuration){var _this6=this;this._slidingTimelineComponents.forEach(function(slidingTimelineComponent){var renderedSlidingTimelineComponent=_this6.getComponent(slidingTimelineComponent);renderedSlidingTimelineComponent&&renderedSlidingTimelineComponent.onSlideTimeUpdate&&renderedSlidingTimelineComponent.onSlideTimeUpdate(elapsedTime,totalDuration)})}},{key:"updateCapabilityMetadata",value:function(capability){switch(capability.type){case SlideCapabilityTypeEnum.CtaButton:this._changeCtaLabel(capability.metadata)}}},{key:"destroy",value:function(){this.interactionService.unregisterAll(this),this.unsubscribeAll(this),get_default()(getPrototypeOf_default()(UiPlayspace.prototype),"destroy",this).call(this)}},{key:"$mediaContainer",get:function(){return this._$mediaContainer}},{key:"footer",get:function(){return this._$footer}}]),UiPlayspace}(AUiBase_AUiBase),PlayspaceStateManagerEvents_StateChanged="stateChanged",PlayspaceStateManagerEvents_ContentReset="contentReset",PlayspaceStateManager_PlayspaceStateManager=function(){function PlayspaceStateManager(mediator,_slidesManager,_userInterface,_hasPreroll,_hasPostroll,_endOfCycleMode,_skipFirstPreRoll){var _this=this;classCallCheck_default()(this,PlayspaceStateManager),this.mediator=mediator,this._slidesManager=_slidesManager,this._userInterface=_userInterface,this._hasPreroll=_hasPreroll,this._hasPostroll=_hasPostroll,this._endOfCycleMode=_endOfCycleMode,this._skipFirstPreRoll=_skipFirstPreRoll,this._prerollConsumed=!1,this._postrollConsumed=!1,this._hiddenStateLocked=!1,this._inView=!1,this._playOnToggle=!1,this._sendContentStartOnPlay=!0,this._onPrerollEnd=function(){_this._prerollConsumed=!0,_this._playbackIntention===ContentStatesEnum.PlayingState?_this.play(!1):_this.pause(!1)},this._onPostrollEnd=function(){switch(_this._postrollConsumed=!0,_this._endOfCycleMode){case ProtoModels_Generated_protos.ProtoEndOfSlideCycleMode.Loop:_this.reset();break;case ProtoModels_Generated_protos.ProtoEndOfSlideCycleMode.Stop:_this.stop()}},this._currentState=null,this._previousState=null,this._skipFirstPreRoll&&(this._prerollConsumed=!0)}return createClass_default()(PlayspaceStateManager,[{key:"_transitionToState",value:function(state){this._currentState!==state&&(this._previousState=this._currentState,this._currentState=state,this.mediator.publish(this,PlayspaceStateManagerEvents_StateChanged,{payload:this._currentState}))}},{key:"_isCurrentState",value:function(state){return this._currentState===state}},{key:"resume",value:function(){this._previousState&&this._transitionToState(this._previousState)}},{key:"stop",value:function(){this._slidesManager.stop(),this._transitionToState(ContentStatesEnum.StoppedState)}},{key:"handleSlidesEnd",value:function(){this._enterPostroll()}},{key:"_enterPreroll",value:function(){this._transitionToState(ContentStatesEnum.PrerollState)}},{key:"_enterPostroll",value:function(){this.mediator.publish(this,PlayspaceExperienceEventsEnum.ContentEnd),this._hasPostroll?this._transitionToState(ContentStatesEnum.PostrollState):this._onPostrollEnd()}},{key:"_isRollState",value:function(stateToCheck){return stateToCheck===ContentStatesEnum.PrerollState||stateToCheck===ContentStatesEnum.PostrollState}},{key:"_isRollStateConsumed",value:function(stateToCheck){return stateToCheck===ContentStatesEnum.PrerollState&&this._prerollConsumed||stateToCheck===ContentStatesEnum.PostrollState&&this._postrollConsumed}},{key:"setViewabilityState",value:function(inView){this._inView=inView}},{key:"play",value:function(userInteraction){if(this._playbackIntention=ContentStatesEnum.PlayingState,!(this._isCurrentState(ContentStatesEnum.PlayingState)||this._isCurrentState(ContentStatesEnum.HiddenState)&&this._hiddenStateLocked||this._isRollState(this._currentState)&&!this._isRollStateConsumed(this._currentState)||this._isCurrentState(ContentStatesEnum.StoppedState)&&!userInteraction))if(!this._hasPreroll||this._prerollConsumed){if(this._isCurrentState(ContentStatesEnum.StoppedState))return this._prerollConsumed=!1,void this.reset();this._userInterface.setDuration(this._slidesManager.remainingTime),this._slidesManager.play(),this._transitionToState(ContentStatesEnum.PlayingState),this._sendContentStartOnPlay&&(this._sendContentStartOnPlay=!1,this.mediator.publish(this,PlayspaceExperienceEventsEnum.ContentStart))}else this._enterPreroll()}},{key:"reset",value:function(){this.mediator.publish(this,PlayspaceStateManagerEvents_ContentReset),this._currentState=null,this._postrollConsumed=!1,this._sendContentStartOnPlay=!0,this._slidesManager.resetSlider(),this.play(!1)}},{key:"pause",value:function(userInteraction){this._playbackIntention=ContentStatesEnum.PausedState,this._isCurrentState(ContentStatesEnum.PausedState)||this._isCurrentState(ContentStatesEnum.HiddenState)||this._isRollState(this._currentState)&&!this._isRollStateConsumed(this._currentState)||this._isCurrentState(ContentStatesEnum.StoppedState)&&!userInteraction||(this._slidesManager.pause(),this._transitionToState(ContentStatesEnum.PausedState))}},{key:"pauseToggle",value:function(){if(this._isCurrentState(ContentStatesEnum.PausedState)||this._isCurrentState(ContentStatesEnum.PlayingState))return this._isCurrentState(ContentStatesEnum.PausedState)&&this._playOnToggle?(this._playOnToggle=!1,void this.play(!1)):this._isCurrentState(ContentStatesEnum.PlayingState)?(this._playOnToggle=!0,void this.pause(!1)):void 0}},{key:"hide",value:function(){this._slidesManager.pause(),this._hiddenStateLocked=!0,this._transitionToState(ContentStatesEnum.HiddenState)}},{key:"show",value:function(){this._isCurrentState(ContentStatesEnum.HiddenState)&&(this._hiddenStateLocked=!1,this._previousState!==ContentStatesEnum.PostrollState?this._previousState!==ContentStatesEnum.PrerollState?this._inView?this.goToNextSlide():this._playbackIntention===ContentStatesEnum.PlayingState?this.play(!1):this.pause(!1):this._onPrerollEnd():this._onPostrollEnd())}},{key:"setCurrentSlide",value:function(index){this._isRollState(this._currentState)&&!this._isRollStateConsumed(this._currentState)||this._slidesManager.setCurrentSlide(index)}},{key:"goToNextSlide",value:function(){this._isRollState(this._currentState)&&!this._isRollStateConsumed(this._currentState)||(this._slidesManager.goToNextSlide(),this._isCurrentState(ContentStatesEnum.StoppedState)||this.play(!1))}},{key:"goToPrevSlide",value:function(){this._isRollState(this._currentState)||(this.play(!1),this._slidesManager.goToPrevSlide())}},{key:"exitRollBreak",value:function(){this._currentState!==ContentStatesEnum.PostrollState?this._onPrerollEnd():this._onPostrollEnd()}}]),PlayspaceStateManager}();function SlideBase_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var SlideBase_SlideBase=function(_Mediator){inherits_default()(SlideBase,_Mediator);var _super=SlideBase_createSuper(SlideBase);function SlideBase(mediator,_metadata,_globalDomUtilsService,_resizeObserverService,_urlSuffixerService){var _this;return classCallCheck_default()(this,SlideBase),(_this=_super.call(this)).mediator=mediator,_this._metadata=_metadata,_this._globalDomUtilsService=_globalDomUtilsService,_this._resizeObserverService=_resizeObserverService,_this._urlSuffixerService=_urlSuffixerService,_this._isActive=!1,_this._isLoaded=!1,Object(TypeUtils.h)(_metadata.imageUrl)||(_metadata.imageUrl=EndPointResolver.a.endPoints.base.image),_this._imageCachingHandler=new ImageCachingHandler_ImageCachingHandler(_urlSuffixerService),_this._$mediaContainer=_this._globalDomUtilsService.createElementByString(_this._getTemplate()),_this._initImageSourceList(),_this}return createClass_default()(SlideBase,[{key:"_getImageParams",value:function(desiredWidth,desiredHeight){var orientation=desiredWidth>desiredHeight?Config_PlayspaceLayoutEnum.Landscape:Config_PlayspaceLayoutEnum.Portrait;return{imageUrl:this._imageSourceData[orientation],altText:Object(TypeUtils.a)(this._metadata.altText)?this._metadata.altText:"",queryParams:this._metadata.mediaContext===ProtoModels_Generated_protos.ProtoMediaContextEnum.Logo?ImageUrlBuilder_ImageUrlBuilder.getScaledImageQueryParams(desiredWidth,desiredHeight):ImageUrlBuilder_ImageUrlBuilder.getSmartCroppedImageQueryParams(desiredWidth,desiredHeight),width:desiredWidth,height:desiredHeight}}},{key:"_initImageSourceList",value:function(){var _this$_imageSourceDat,_this$_metadata=this._metadata,imageUrl=_this$_metadata.imageUrl,portraitImageUrl=_this$_metadata.portraitImageUrl;this._imageSourceData=(_this$_imageSourceDat={},defineProperty_default()(_this$_imageSourceDat,Config_PlayspaceLayoutEnum.Landscape,imageUrl),defineProperty_default()(_this$_imageSourceDat,Config_PlayspaceLayoutEnum.Portrait,Object(TypeUtils.h)(portraitImageUrl)?portraitImageUrl:imageUrl),_this$_imageSourceDat)}},{key:"getThumbnailUrlParams",value:function(desiredWidth,desiredHeight){return this._getImageParams(desiredWidth,desiredHeight)}},{key:"destroy",value:function(){}},{key:"isLoaded",set:function(state){this._isLoaded=state},get:function(){return this._isLoaded}},{key:"duration",get:function(){return this._metadata.slideDuration*TimeConfig.f}}]),SlideBase}(Mediator.a),SlideImageTemplate=__webpack_require__(212),SlideImageTemplate_default=__webpack_require__.n(SlideImageTemplate);function SlideImage_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var SlideImage_SlideImage=function(_SlideBase){inherits_default()(SlideImage,_SlideBase);var _super=SlideImage_createSuper(SlideImage);function SlideImage(mediator,_metadata,_globalDomUtilsService,_resizeObserverService,_urlSuffixerService){var _this;return classCallCheck_default()(this,SlideImage),(_this=_super.call(this,mediator,_metadata,_globalDomUtilsService,_resizeObserverService,_urlSuffixerService)).type=protos.ProtoMediaTypeEnum.Image,_this._onImageDrag=function(e){e.preventDefault()},_this._addContextualClass(),_this}return createClass_default()(SlideImage,[{key:"_addContextualClass",value:function(){this._metadata.mediaContext===ProtoModels_Generated_protos.ProtoMediaContextEnum.Logo&&Object(DomUtils.a)(this._$mediaContainer,CSSClassMainPlayspaceEnum.MediaLogo)}},{key:"_setupPreviousImageContainerSize",value:function(){this._previousImageContainerWidth=this._$mediaContainer.clientWidth,this._previousImageContainerHeight=this._$mediaContainer.clientHeight}},{key:"_setImageSrc",value:function(){var _this2=this;this._imageTimeoutId=setTimeout(function(){var _this2$_$mediaContain=_this2._$mediaContainer.parentElement,clientWidth=_this2$_$mediaContain.clientWidth,clientHeight=_this2$_$mediaContain.clientHeight,_this2$_getImageParam=_this2._getImageParams(clientWidth,clientHeight),imageUrl=_this2$_getImageParam.imageUrl,altText=_this2$_getImageParam.altText,width=_this2$_getImageParam.width,height=_this2$_getImageParam.height,queryParams=_this2$_getImageParam.queryParams,$currImg=_this2._imageCachingHandler.getImage(imageUrl,altText,width,height,queryParams,!0);_this2._$img&&_this2._$mediaContainer.removeChild(_this2._$img),$currImg&&(_this2._$mediaContainer.appendChild($currImg),_this2._$img=$currImg,_this2._addImgEventListener(_this2._$img))},0)}},{key:"_onImageResize",value:function(){this._$img&&Object(TypeUtils.h)(this._metadata.imageUrl)&&this._setImageSrc()}},{key:"_areImageContainerAndPreviousSizesLoaded",value:function(){return Object(TypeUtils.a)(this._$mediaContainer)&&Object(TypeUtils.a)(this._previousImageContainerWidth)&&Object(TypeUtils.a)(this._previousImageContainerHeight)}},{key:"_playerContainerWidthDiffMoreThanThreshold",value:function(thresholdRatio){return!!this._areImageContainerAndPreviousSizesLoaded()&&Math.abs(this._previousImageContainerWidth-this._$mediaContainer.clientWidth)>=this._previousImageContainerWidth/thresholdRatio}},{key:"_playerContainerHeightDiffMoreThanThreshold",value:function(thresholdRatio){return!!this._areImageContainerAndPreviousSizesLoaded()&&Math.abs(this._previousImageContainerHeight-this._$mediaContainer.clientHeight)>=this._previousImageContainerHeight/thresholdRatio}},{key:"_addImgEventListener",value:function($img){$img.addEventListener("mousedown",this._onImageDrag)}},{key:"_removeImgEventListener",value:function($img){$img.removeEventListener("mousedown",this._onImageDrag)}},{key:"_getTemplate",value:function(){return SlideImageTemplate_default.a}},{key:"reset",value:function(){this.isLoaded&&(this._$mediaContainer.style.transitionDuration="",this._$mediaContainer.style.transform="matrix(1.1, 0, 0, 1.1, 0, 0)")}},{key:"onSlideResizeCallback",value:function(){(this._playerContainerWidthDiffMoreThanThreshold(10)||this._playerContainerHeightDiffMoreThanThreshold(10))&&(this._onImageResize(),this._setupPreviousImageContainerSize())}},{key:"play",value:function(){this.isLoaded&&(this._$mediaContainer.style.transform="",this._$mediaContainer.style.transitionDuration="".concat(this._metadata.slideDuration,"s"),Object(DomUtils.O)(this._$mediaContainer,CssClassesConfig.j.Paused,CssClassesConfig.j.Playing))}},{key:"pause",value:function(){this.isLoaded&&(this._$mediaContainer.style.transitionDuration="",this._$mediaContainer.style.transform=this._globalDomUtilsService.getTransformPropertyValue(this._$mediaContainer),Object(DomUtils.O)(this._$mediaContainer,CssClassesConfig.j.Playing,CssClassesConfig.j.Paused))}},{key:"load",value:function($mediaWrapper){this.isLoaded||(this.isLoaded=!0,$mediaWrapper.appendChild(this._$mediaContainer),this._setupPreviousImageContainerSize(),this.pause(),this._setImageSrc())}},{key:"destroy",value:function(){this._$img&&this._removeImgEventListener(this._$img),clearTimeout(this._imageTimeoutId),get_default()(getPrototypeOf_default()(SlideImage.prototype),"destroy",this).call(this)}}]),SlideImage}(SlideBase_SlideBase),SlideVideoTemplate=__webpack_require__(213),SlideVideoTemplate_default=__webpack_require__.n(SlideVideoTemplate),VideoEncoding_VideoEncoding=function(){function VideoEncoding(videoEncoding){classCallCheck_default()(this,VideoEncoding),this._encodingOptions=[{id:VideoEncodingsEnum.H264,extension:"mp4",type:"video/mp4"},{id:VideoEncodingsEnum.Hevc,extension:"mp4",type:"video/mp4"}],this._options=this._encodingOptions.find(function(item){return item.id===videoEncoding})}return createClass_default()(VideoEncoding,[{key:"type",get:function(){var codecs=this._options.codecs?"codecs=".concat(this._options.codecs):"";return"".concat(this._options.type,"; ").concat(codecs)}},{key:"id",get:function(){return this._options.id}}]),VideoEncoding}(),VideoQuality_VideoQuality=function(){function VideoQuality(mediator,_resizeObserverService,_element){var _this=this;classCallCheck_default()(this,VideoQuality),this.mediator=mediator,this._resizeObserverService=_resizeObserverService,this._element=_element,this._currentQualitySettings={quality:VideoQualityEnum.Auto,height:360},this.resizeObserverBinded=!1,this._minHeightDifference=30,this._onElementResize=function(){var height=_this._element.clientHeight;if(_this._isBiggerEnough(height)&&_this.currentQualitySettings.quality===VideoQualityEnum.Auto){var newQualitySettings={height:height,quality:VideoQualityEnum.Auto};_this.setCurrentQualitySettings(newQualitySettings),_this.mediator.publish(_this,VideoQualityEventsEnum.CurrentQuality,{payload:newQualitySettings})}}}return createClass_default()(VideoQuality,[{key:"setCurrentQualitySettings",value:function(qualitySettings){this._currentQualitySettings.quality=qualitySettings.quality,this._currentQualitySettings.height!==qualitySettings.height&&(this._currentQualitySettings.height=qualitySettings.height,this.mediator.publish(this,VideoQualityEventsEnum.Change))}},{key:"_isBiggerEnough",value:function(height){return!this._currentQualitySettings.height||height/this._currentQualitySettings.height*100-100>this._minHeightDifference}},{key:"addResizeObserver",value:function(){this.resizeObserverBinded=!0,this._resizeObserverService.on(this._element,this._onElementResize)}},{key:"removeResizeObserver",value:function(){this.resizeObserverBinded=!1,this._resizeObserverService.off(this._element,this._onElementResize)}},{key:"setQuality",value:function(qualitySettings){qualitySettings.quality===VideoQualityEnum.Auto?this.resizeObserverBinded||(this.setCurrentQualitySettings({height:qualitySettings.height,quality:qualitySettings.quality}),this.addResizeObserver(),this._onElementResize()):(this.resizeObserverBinded&&this.removeResizeObserver(),this.setCurrentQualitySettings(qualitySettings)),this.mediator.publish(this,VideoQualityEventsEnum.CurrentQuality,{payload:this._currentQualitySettings})}},{key:"destroy",value:function(){this.removeResizeObserver()}},{key:"currentQualitySettings",get:function(){return this._currentQualitySettings}}]),VideoQuality}(),VideoSourceEventsEnum={TrackLoaded:"trackLoaded"},DEFAULT_VIDEO_QUALITY={height:0,quality:VideoQualityEnum.Auto};function SourceHandlerBase_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var SourceHandlerBase_SourceHandlerBase=function(_Mediator){inherits_default()(SourceHandlerBase,_Mediator);var _super=SourceHandlerBase_createSuper(SourceHandlerBase);function SourceHandlerBase(mediator,_globalDomUtilsService,_videoTag){var _this;return classCallCheck_default()(this,SourceHandlerBase),(_this=_super.call(this)).mediator=mediator,_this._globalDomUtilsService=_globalDomUtilsService,_this._videoTag=_videoTag,_this._subtitleTracks=[],_this._onTrackLoaded=function(){_this.mediator.publish(assertThisInitialized_default()(_this),VideoSourceEventsEnum.TrackLoaded)},_this}return createClass_default()(SourceHandlerBase,[{key:"_setSource",value:function(source){this._videoSource=source,this._setSubtitleTrackSources()}},{key:"_addVideoTagSources",value:function(sources){var _this2=this;this._videoTag.innerHTML="",sources.forEach(function(sourceElement){_this2._videoTag.appendChild(sourceElement)})}},{key:"_getSubtitleTrackSources",value:function(){return this._subtitleTracks}},{key:"_setSubtitleTrackSources",value:function(){if(this._subtitleTracks=[],this._videoSource&&this._videoSource.subtitle){var track=this._globalDomUtilsService.createElement("track");track.src=this._videoSource.subtitle,track.srclang="en",track.kind="subtitle",track.default=!0,track.addEventListener("load",this._onTrackLoaded,!1),track.addEventListener("loaded",this._onTrackLoaded,!1),this._subtitleTracks.push(track)}}}]),SourceHandlerBase}(Mediator.a);function MP4SourceHandler_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var HlsHttpProtocol,MP4SourceHandler_MP4SourceHandler=function(_SourceHandlerBase){inherits_default()(MP4SourceHandler,_SourceHandlerBase);var _super=MP4SourceHandler_createSuper(MP4SourceHandler);function MP4SourceHandler(mediator,_globalDomUtilsService,_resizeObserverService,_parentContainer,_videoTag){var _this,options=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},_videoQuality=arguments.length>6?arguments[6]:void 0;return classCallCheck_default()(this,MP4SourceHandler),(_this=_super.call(this,mediator,_globalDomUtilsService,_videoTag))._resizeObserverService=_resizeObserverService,_this._parentContainer=_parentContainer,_this._videoQuality=_videoQuality,_this._sources=null,_this._minIosHvcVersion=10.13,_this._currentEncodings=_this._getVideoEncodings(options),_this}return createClass_default()(MP4SourceHandler,[{key:"start",value:function(){try{this._videoQualityModule=new VideoQuality_VideoQuality(this,this._resizeObserverService,this._parentContainer),this._bindEvents(),this.setQuality(this._videoQuality)}catch(e){Object(Logging.a)({message:"Mp4SourceHandler_start",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.FATAL})}}},{key:"onQualityChanged",value:function(){return this.attachMedia()}},{key:"setSource",value:function(source){var preloadVideoSources=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._setSource(source),this._setVideoSources(this._getVideoElementSources(),preloadVideoSources)}},{key:"setQuality",value:function(newQualitySettings){this._videoQualityModule.setQuality(newQualitySettings)}},{key:"attachMedia",value:function(){var _this2=this;return new Promise(function(resolve){_this2._loadSources(),resolve()})}},{key:"detachMedia",value:function(){this._videoTag.removeAttribute("src"),this._setVideoSources(null)}},{key:"destroy",value:function(){this._videoQualityModule.destroy()}},{key:"_bindEvents",value:function(){var _this3=this;this.relay(VideoQualityEventsEnum.CurrentQuality,this._videoQualityModule,this,this.mediator),this.subscribe(VideoQualityEventsEnum.Change,this._videoQualityModule,function(){_this3._onQualityChanged()})}},{key:"_onQualityChanged",value:function(){this._setVideoSources(this._getVideoElementSources()),this.mediator.publish(this,VideoQualityEventsEnum.Change,{payload:this._videoQualityModule.currentQualitySettings.height})}},{key:"_addSources",value:function(sources){this._addVideoTagSources(sources),this._videoTag.load()}},{key:"_getVideoElementSources",value:function(){var videoSources=this._getVideoSources(),subtitleTrackSources=this._getSubtitleTrackSources();return[].concat(toConsumableArray_default()(videoSources),toConsumableArray_default()(subtitleTrackSources))}},{key:"_getVideoSources",value:function(){var _this4=this;if(!this._videoTag||!this._videoSource)return[];var sources=[];return this._videoSource.getSources(this._videoQualityModule.currentQualitySettings.height,this._currentEncodings).forEach(function(videoSource){var source=_this4._globalDomUtilsService.createElement("source");source.src=videoSource.src,source.type=videoSource.type,sources.push(source)}),sources}},{key:"_loadSources",value:function(){this._sources&&(this._addSources(this._sources),this._sources=null)}},{key:"_setVideoSources",value:function(sources){var preloadVideoSources=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._sources=sources,preloadVideoSources&&this._loadSources()}},{key:"_getVideoEncodings",value:function(options){var currentEncodings;switch(options.os){case OsConfig.b.Ios:currentEncodings=[VideoEncodingsEnum.Hevc,VideoEncodingsEnum.H264];break;case OsConfig.b.Mac:currentEncodings=options.osVersion>this._minIosHvcVersion&&options.browser===BrowserConfig.a.Safari?[VideoEncodingsEnum.Hevc,VideoEncodingsEnum.H264]:[VideoEncodingsEnum.H264];break;default:currentEncodings=[VideoEncodingsEnum.H264]}return currentEncodings.map(function(enc){return new VideoEncoding_VideoEncoding(enc)})}},{key:"currentQualitySettings",get:function(){return this._videoQualityModule.currentQualitySettings}}]),MP4SourceHandler}(SourceHandlerBase_SourceHandlerBase),HlsEventEnum={UnexpectedError:"unexpectedError",BufferingError:"bufferingError",FragBuffered:"fragBuffered",ManifestLoaded:"manifestLoaded",LevelSwitching:"levelSwitching",StreamEnded:"streamEnded"};!function(HlsHttpProtocol){HlsHttpProtocol.Http="http",HlsHttpProtocol.Https="https"}(HlsHttpProtocol||(HlsHttpProtocol={}));var DeferredPromise=__webpack_require__(63);function HLSSourceHandler_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var TextTrackModeEnum,HLSSourceHandler_HLS_CONFIG={enableWorker:!1,capLevelToPlayerSize:!0,cnxRenderWindow:window,maxBufferSize:5e6,maxBufferLength:5,maxMaxBufferLength:10,liveBackBufferLength:0},HLSSourceHandler_HLSSourceHandler=function(_SourceHandlerBase){inherits_default()(HLSSourceHandler,_SourceHandlerBase);var _super=HLSSourceHandler_createSuper(HLSSourceHandler);function HLSSourceHandler(mediator,_globalDomUtilsService,_videoTag,_httpProtocol,_videoQuality,_inApp,_urlSuffixerService){var _this;return classCallCheck_default()(this,HLSSourceHandler),(_this=_super.call(this,mediator,_globalDomUtilsService,_videoTag))._httpProtocol=_httpProtocol,_this._videoQuality=_videoQuality,_this._inApp=_inApp,_this._urlSuffixerService=_urlSuffixerService,_this._availableQualityList=[],_this._currentQualityMode=VideoQualityEnum.Auto,_this._currentResolution=320,_this._isFragLoading=!1,_this._isBufferAppending=!1,_this._inRecovery=!1,_this._hlsSDKMediaAttached=function(){_this._hlsSDK.off(hls.Events.MEDIA_ATTACHED,_this._hlsSDKMediaAttached);var hlsUrl=_this._getHlsSourceFullUrl(_this._loadingSourceMeta);_this._hlsSDK.loadSource(hlsUrl),_this._hlsSDK.once(hls.Events.MANIFEST_PARSED,_this._hlsSDKManifestParsed)},_this._hlsSDKManifestParsed=function(){_this._hlsSDK.off(hls.Events.MANIFEST_PARSED,_this._hlsSDKManifestParsed),_this._hlsSDK.on(hls.Events.LEVEL_SWITCHING,_this._handleHlsSDKLevelSwitching),_this._hlsSDK.on(hls.Events.LEVEL_SWITCHED,_this._handleHlsSDKLevelSwitched),_this._hlsSDK.on(hls.Events.FRAG_BUFFERED,_this._fragBuffered),_this._hlsSDK.on(hls.Events.FRAG_LOADING,_this._fragLoading),_this._hlsSDK.on(hls.Events.FRAG_LOADED,_this._fragLoaded),_this._hlsSDK.on(hls.Events.BUFFER_APPENDING,_this._bufferAppending),_this._hlsSDK.on(hls.Events.BUFFER_APPENDED,_this._bufferAppended),_this._hlsSDK.on(hls.Events.BUFFER_EOS,_this._handleBufferEndOfStream),_this._loadingSourceMeta=null,_this._updateAvailableQualityAfterManifestParsed(),_this._publishUpdateAvailableQualities(),_this._setQualityHlsSDK(),_this._attachMediaToHlsSDKDeferredPromise.resolve()},_this._videoTagLoadedMetadata=function(){_this._loadingSourceMeta=null,_this._videoTag.removeEventListener(VideoTagEvents.LoadedMetadata,_this._videoTagLoadedMetadata),_this._attachMediaToVideoTagDeferredPromise.resolve()},_this._publishUpdateAvailableQualities=function(){var qualityList=_this._availableQualityList.map(function(availableQuality){return{videoHeight:availableQuality.height,isHD:availableQuality.height>=VIDEO_HD_HEIGHT,label:availableQuality.level.toString()}});_this.mediator.publish(assertThisInitialized_default()(_this),HlsEventEnum.ManifestLoaded,{payload:{qualityList:qualityList}})},_this._fragBuffered=function(){_this.mediator.publish(assertThisInitialized_default()(_this),HlsEventEnum.FragBuffered)},_this._fragLoading=function(){_this._isFragLoading=!0},_this._fragLoaded=function(){_this._isFragLoading=!1},_this._bufferAppending=function(){_this._isBufferAppending=!0},_this._bufferAppended=function(){_this._isBufferAppending=!1},_this._handleBufferEndOfStream=function(){_this.mediator.publish(assertThisInitialized_default()(_this),HlsEventEnum.StreamEnded)},_this._handleHlsSDKErrors=function(event,data){if(data.details===hls.ErrorDetails.BUFFER_STALLED_ERROR&&(_this._isFragLoading||_this._isBufferAppending?_this.mediator.publish(assertThisInitialized_default()(_this),HlsEventEnum.BufferingError):(_this._inRecovery||(_this._hlsSDK.recoverMediaError(),_this._videoTag.play().then(function(){_this._inRecovery=!1}).catch(function(){_this._inRecovery=!1})),_this._inRecovery=!0)),data.fatal)switch(data.type){case hls.ErrorTypes.NETWORK_ERROR:if(data.details===hls.ErrorDetails.MANIFEST_PARSING_ERROR)return void _this._publishUnexpectedError("hls_network_error_manifest_parsing_error_FATAL");if(data.details===hls.ErrorDetails.MANIFEST_LOAD_ERROR)return void _this.mediator.publish(assertThisInitialized_default()(_this),HlsEventEnum.UnexpectedError);_this._hlsSDK.startLoad();break;case hls.ErrorTypes.MEDIA_ERROR:_this._hlsSDK.recoverMediaError();break;default:_this._publishUnexpectedError("hls_unexpected_error_FATAL","type_".concat(data.type,"_details_").concat(data.details))}else data.type===hls.ErrorTypes.MEDIA_ERROR&&data.details===hls.ErrorDetails.BUFFER_APPENDING_ERROR&&_this._publishUnexpectedError("hls_media_error_buffer_appending_error"),data.type===hls.ErrorTypes.NETWORK_ERROR&&data.details===hls.ErrorDetails.MANIFEST_PARSING_ERROR&&_this._publishUnexpectedError("hls_network_error_manifest_parsing_error")},_this._handlerVideoTagError=function(){_this._publishUnexpectedError("hls_video_tag_error","code_".concat(_this._videoTag.error.code,"_message_").concat(_this._videoTag.error.message))},_this._handleHlsSDKLevelSwitched=function(event,data){_this._currentResolution=_this._availableQualityList.find(function(quality){return quality.level===data.level}).height,_this.mediator.publish(assertThisInitialized_default()(_this),VideoQualityEventsEnum.Change,{payload:_this.currentQualitySettings.height}),_this.mediator.publish(assertThisInitialized_default()(_this),VideoQualityEventsEnum.CurrentQuality,{payload:_this.currentQualitySettings})},_this._handleHlsSDKLevelSwitching=function(){_this.mediator.publish(assertThisInitialized_default()(_this),HlsEventEnum.LevelSwitching)},isHlsMediaSourceExtensionSupported&&(_this._hlsSDK=_this._globalDomUtilsService.initHls(HLSSourceHandler_HLS_CONFIG),_this._inApp&&(_this._hlsSDK.autoLevelCapping=1)),_this._currentResolution=_this._videoQuality.height,_this._currentQualityMode=_this._videoQuality.quality,_this}return createClass_default()(HLSSourceHandler,[{key:"start",value:function(){}},{key:"setSource",value:function(source){var preloadVideoSources=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._currentMediaId=source.id,this._setSource(source),this._loadingSourceMeta=source,preloadVideoSources&&this.attachMedia()}},{key:"attachMedia",value:function(){var _this2=this;return new Promise(function(resolve){if(_this2._hlsSDK?_this2._hlsSDK.on(hls.Events.ERROR,_this2._handleHlsSDKErrors):_this2._videoTag.addEventListener(VideoTagEvents.Error,_this2._handlerVideoTagError),_this2._loadingSourceMeta){var subtitleTrackSources=_this2._getSubtitleTrackSources();_this2._addVideoTagSources(subtitleTrackSources),_this2._hlsSDK?_this2._attachMediaToHlsSDK().then(function(){resolve()}):_this2._attachMediaToVideoTag().then(function(){resolve()})}else resolve()})}},{key:"detachMedia",value:function(){this._availableQualityList=[],this._hlsSDK?(this._hlsSDK.detachMedia(),this._removeHlsSDKEventListeners()):(this._videoTag.removeAttribute("src"),this._videoTag.removeEventListener(VideoTagEvents.LoadedMetadata,this._videoTagLoadedMetadata),this._videoTag.removeEventListener(VideoTagEvents.Error,this._handlerVideoTagError))}},{key:"setQuality",value:function(newQualitySettings){this._currentQualityMode=newQualitySettings.quality,this._currentResolution=newQualitySettings.height,this._hlsSDK&&this._setQualityHlsSDK(),this.mediator.publish(this,VideoQualityEventsEnum.Change,{payload:this.currentQualitySettings.height}),this.mediator.publish(this,VideoQualityEventsEnum.CurrentQuality,{payload:this.currentQualitySettings})}},{key:"onQualityChanged",value:function(){return new Promise(function(){})}},{key:"destroy",value:function(){this._hlsSDK?(this._removeHlsSDKEventListeners(),this._hlsSDK.destroy(),this._hlsSDK=null):(this._videoTag.removeEventListener(VideoTagEvents.LoadedMetadata,this._videoTagLoadedMetadata),this._videoTag.removeEventListener(VideoTagEvents.Error,this._handlerVideoTagError))}},{key:"_attachMediaToHlsSDK",value:function(){return this._attachMediaToHlsSDKDeferredPromise=new DeferredPromise.a,this._hlsSDK.attachMedia(this._videoTag),this._hlsSDK.once(hls.Events.MEDIA_ATTACHED,this._hlsSDKMediaAttached),this._attachMediaToHlsSDKDeferredPromise.promise}},{key:"_attachMediaToVideoTag",value:function(){return this._attachMediaToVideoTagDeferredPromise=new DeferredPromise.a,this._videoTag.src=this._getHlsSourceFullUrl(this._loadingSourceMeta),this._videoTag.addEventListener(VideoTagEvents.LoadedMetadata,this._videoTagLoadedMetadata),this._attachMediaToVideoTagDeferredPromise.promise}},{key:"_removeHlsSDKEventListeners",value:function(){this._hlsSDK.off(hls.Events.MEDIA_ATTACHED,this._hlsSDKMediaAttached),this._hlsSDK.off(hls.Events.MANIFEST_PARSED,this._hlsSDKManifestParsed),this._hlsSDK.off(hls.Events.ERROR,this._handleHlsSDKErrors),this._hlsSDK.off(hls.Events.LEVEL_SWITCHING,this._handleHlsSDKLevelSwitching),this._hlsSDK.off(hls.Events.LEVEL_SWITCHED,this._handleHlsSDKLevelSwitched),this._hlsSDK.off(hls.Events.FRAG_BUFFERED,this._fragBuffered),this._hlsSDK.off(hls.Events.FRAG_LOADING,this._fragLoading),this._hlsSDK.off(hls.Events.FRAG_LOADED,this._fragLoaded),this._hlsSDK.off(hls.Events.BUFFER_APPENDING,this._bufferAppending),this._hlsSDK.off(hls.Events.BUFFER_APPENDED,this._bufferAppended),this._hlsSDK.off(hls.Events.BUFFER_EOS,this._handleBufferEndOfStream)}},{key:"_updateAvailableQualityAfterManifestParsed",value:function(){var _this3=this;this._hlsSDK.levels.forEach(function(level,index){_this3._inApp&&index>1||_this3._availableQualityList.push({level:index,height:level.height})})}},{key:"_publishUnexpectedError",value:function(message,details){Object(Logging.a)({message:message,exception:this._currentMediaId,level:protos.ProtoLoggingLevelEnum.WARNING,callStack:details}),this.mediator.publish(this,HlsEventEnum.UnexpectedError)}},{key:"_setQualityHlsSDK",value:function(){var _this4=this;if(this._currentQualityMode===VideoQualityEnum.Auto)this._hlsSDK.currentLevel=-1;else try{this._hlsSDK.currentLevel=this._availableQualityList.find(function(availableQuality){return availableQuality.height===_this4._currentResolution}).level}catch(e){Object(Logging.a)({message:"HlsSourceHandler_quality_not_present_in_hls_manifest",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.FATAL})}}},{key:"_getHlsSourceFullUrl",value:function(sourceMeta){try{var hlsSource=sourceMeta.getHlsSource(),hlsSourceUlComponents=Object(GeneralUtils.g)(hlsSource);return hlsSourceUlComponents&&hlsSourceUlComponents.protocol?this._urlSuffixerService.appendParamsToUrl(hlsSource):this._urlSuffixerService.appendParamsToUrl("".concat(this._httpProtocol,":").concat(hlsSource))}catch(e){Object(Logging.a)({exception:e.message,message:"HlsSourceHandler_undefined_sourceMeta",level:protos.ProtoLoggingLevelEnum.FATAL,callStack:e.stack,throttle:5,sendMaxLog:!1})}}},{key:"liveSyncPosition",get:function(){if(this._hlsSDK)return this._hlsSDK.liveSyncPosition}},{key:"currentQualitySettings",get:function(){return{quality:this._currentQualityMode,height:this._currentResolution}}}]),HLSSourceHandler}(SourceHandlerBase_SourceHandlerBase);!function(TextTrackModeEnum){TextTrackModeEnum.Disabled="disabled",TextTrackModeEnum.Hidden="hidden",TextTrackModeEnum.Showing="showing"}(TextTrackModeEnum||(TextTrackModeEnum={}));var ContentPlayer_ContentPlayer=function(){function ContentPlayer(mediator,_videoTag,_videoEvents,initialVolume,_app){var _this=this;classCallCheck_default()(this,ContentPlayer),this.mediator=mediator,this._videoTag=_videoTag,this._videoEvents=_videoEvents,this._app=_app,this._playing=!1,this._isMetaLoaded=!1,this._trackMode=TextTrackModeEnum.Hidden,this._playPendingCount=0,this._playAllowed=!1,this._playPromise=null,this._onEvent=function(event){switch(event.type){case VideoTagEvents.Play:if(!_this._playAllowed&&_this._app.config.isInAppAndroid)return void _this.pause();_this._playing=!0;break;case VideoTagEvents.Timeupdate:_this.mediator.publish(_this,event.type,{payload:_this._playing});break;case VideoTagEvents.Error:var error=_this._videoTag.error?_this._videoTag.error.message:"";_this.mediator.publish(_this,VideoEventsEnum.PlayError,{payload:error});break;case VideoTagEvents.LoadedMetadata:_this._isMetaLoaded=!0,Object(TypeUtils.d)(_this._cachedTime)&&(_this.currentTime=_this._cachedTime,_this._cachedTime=null),_this.mediator.publish(_this,event.type);break;default:_this.mediator.publish(_this,event.type)}},this.play=function(){return _this._playAllowed=!0,_this._playPromise=_this._videoTag.play(),null!==_this._playPromise?(_this._playPendingCount++,_this._playPromise.then(function(){_this._playing=!0,_this._app.config.os.os===OsConfig.b.Ios&&Object(DomUtils.C)(_this._videoTag),_this._playPendingCount--,_this._initTrackModes(),_this._playPromise=null}).catch(function(reason){throw _this.mediator.publish(_this,VideoEventsEnum.PlayError,{payload:reason}),_this._playing=!1,_this._playPendingCount--,_this._playPromise=null,reason})):Promise.resolve()},this.pause=function(){null!==_this._playPromise?_this._playPromise.then(_this._pauseWhenAllPlayPromisesSettled).catch(_this._pauseWhenAllPlayPromisesSettled):_this._unsafePause()},this._pauseWhenAllPlayPromisesSettled=function(){_this._playPendingCount>1||_this._unsafePause()},this.volume=initialVolume,this._bindEvents()}return createClass_default()(ContentPlayer,[{key:"_bindEvents",value:function(){var _this2=this;this._videoEvents.forEach(function(event){_this2._videoTag.addEventListener(event,_this2._onEvent)})}},{key:"_initTrackModes",value:function(){var _this3=this;this._videoTag.textTracks&&0!==this._videoTag.textTracks.length&&Object.keys(this._videoTag.textTracks).forEach(function(key){_this3._videoTag.textTracks[key].mode=_this3._trackMode})}},{key:"_unsafePause",value:function(){this._videoTag.pause(),this._playing=!1,this._playAllowed=!1}},{key:"destroy",value:function(){var _this4=this;this._videoEvents.forEach(function(event){_this4._videoTag.removeEventListener(event,_this4._onEvent)})}},{key:"setTrackModes",value:function(mode){this._trackMode=mode,this._initTrackModes()}},{key:"setMetaLoaded",value:function(value){this._isMetaLoaded=value}},{key:"setCrossOriginAttribute",value:function(){this._videoTag.getAttribute("crossorigin")||this._videoTag.setAttribute("crossorigin","anonymous")}},{key:"setPoster",value:function(videoSource){this.poster=videoSource.getThumbnailUrl(this._videoTag.clientWidth,this._videoTag.clientHeight)}},{key:"getCurrentTrack",value:function(){return this._videoTag.textTracks&&0!==this._videoTag.textTracks.length?this._videoTag.textTracks[0]:null}},{key:"isPlayPending",value:function(){return this._playPendingCount>0}},{key:"poster",set:function(imageSrc){Object(TypeUtils.h)(imageSrc)&&(this._videoTag.poster=imageSrc)},get:function(){return this._videoTag.poster}},{key:"volume",get:function(){return this._cachedVolume},set:function(value){this._cachedVolume=value<=1?value:value/100,this._videoTag.volume=this._cachedVolume,Object(DomUtils.V)(this._videoTag,this._cachedVolume)}},{key:"currentTime",get:function(){return this._videoTag.currentTime},set:function(seconds){this._isMetaLoaded?this._videoTag.currentTime=seconds:this._cachedTime=seconds}},{key:"duration",get:function(){return this._videoTag.duration}},{key:"playing",get:function(){return this._playing}}]),ContentPlayer}();function VideoHandler_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var VideoHandler_VideoHandler=function(_Mediator){inherits_default()(VideoHandler,_Mediator);var _super=VideoHandler_createSuper(VideoHandler);function VideoHandler(mediator,_app,_globalDomUtilsService,_parentContainer,_resizeObserverService,_initialVolume){var _this,_options=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},_forceStartTime=arguments.length>7?arguments[7]:void 0,_videoQuality=arguments.length>8?arguments[8]:void 0;if(classCallCheck_default()(this,VideoHandler),(_this=_super.call(this)).mediator=mediator,_this._app=_app,_this._globalDomUtilsService=_globalDomUtilsService,_this._parentContainer=_parentContainer,_this._resizeObserverService=_resizeObserverService,_this._initialVolume=_initialVolume,_this._options=_options,_this._forceStartTime=_forceStartTime,_this._videoQuality=_videoQuality,_this._hlsSupported=!0,_this._isIosFullscreen=!1,_this._hlsUnexpectedError=!1,_this._onCueChange=function(){var activeCue;_this.currentTrack.activeCues&&_this.currentTrack.activeCues.length>0&&(activeCue=_this.currentTrack.activeCues[0]),_this.mediator.publish(assertThisInitialized_default()(_this),UiComponentEventsEnum[UiComponentEventsEnum.CaptionUpdate],{payload:activeCue})},_this._onTrackLoaded=function(){_this.currentTrack&&(_this.currentTrack.mode=_this._captionsEnabled?TextTrackModeEnum.Hidden:TextTrackModeEnum.Disabled,_this.currentTrack.oncuechange=_this._onCueChange)},_this._createElements(),_this._videoContainer.appendChild(_this._videoTag),_this._parentContainer.appendChild(_this._videoContainer),_this._videoQuality=_this._videoQuality||DEFAULT_VIDEO_QUALITY,_this._mp4SourceHandler=new MP4SourceHandler_MP4SourceHandler(assertThisInitialized_default()(_this),_globalDomUtilsService,_this._resizeObserverService,_this._parentContainer,_this._videoTag,_this._options,_this._videoQuality),isHlsMediaSourceExtensionSupported||hasBuiltInHlsSupport(_this._videoTag)){var hlsHttpProtocol=_this._globalDomUtilsService.isHttpsProtocolUsed()?HlsHttpProtocol.Https:HlsHttpProtocol.Http,inApp=Object(TypeUtils.h)(_this._app.config.bundleID);_this._hlsSourceHandler=new HLSSourceHandler_HLSSourceHandler(assertThisInitialized_default()(_this),_this._globalDomUtilsService,_this._videoTag,hlsHttpProtocol,_this._videoQuality,inApp,_this._app.services.UrlSuffixerService),_this._subscribeToHlsSourceHandlerEvents()}else _this._hlsSupported=!1,Object(Logging.a)({message:"Hls_not_supported",level:protos.ProtoLoggingLevelEnum.INFO});return _this}return createClass_default()(VideoHandler,[{key:"start",value:function(){try{this._videoEvents=Object(ObjectUtils.a)(VideoTagEvents),this._contentPlayerModule=new ContentPlayer_ContentPlayer(this,this._videoTag,this._videoEvents,this._initialVolume,this._app),this._startMp4SourceHandler(),this._startHlsSourceHandler(),this._handleContentPlayerEvents()}catch(e){Object(Logging.a)({message:"VideoHandler_start",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.FATAL})}}},{key:"_handleHlsUnexpectedError",value:function(){var _this2=this,cachedTime=this.currentTime;this.setSource(this._currentVideoSource,!0,this._mp4SourceHandler),this._currentSourceHandler.attachMedia().then(function(){_this2._contentPlayerModule.play().then(function(){_this2._hlsUnexpectedError=!1,_this2._playDeferredPromise.resolve(),_this2._contentPlayerModule.currentTime=cachedTime}).catch(function(e){_this2._playDeferredPromise&&_this2._playDeferredPromise.isPending&&(_this2._hlsUnexpectedError=!1,_this2._playDeferredPromise.reject(),Object(Logging.a)({message:"VideoHandler_hls_error_content_player_play",exception:e.message,callStack:e.callStack,level:protos.ProtoLoggingLevelEnum.FATAL}))})}).catch(function(e){_this2._playDeferredPromise&&_this2._playDeferredPromise.isPending&&(_this2._hlsUnexpectedError=!1,_this2._playDeferredPromise.reject()),Object(Logging.a)({message:"VideoHandler_hls_error_attach_media",exception:e.message,callStack:e.callStack,level:protos.ProtoLoggingLevelEnum.FATAL})})}},{key:"_subscribeToHlsSourceHandlerEvents",value:function(){var _this3=this;this.subscribe(HlsEventEnum.UnexpectedError,this._hlsSourceHandler,function(){_this3._hlsUnexpectedError=!0,_this3._handleHlsUnexpectedError()}),this.subscribe(HlsEventEnum.ManifestLoaded,this._hlsSourceHandler,function(_ref){var qualityList=_ref.payload;_this3.mediator.publish(_this3,VideoQualityEventsEnum.Loaded,{payload:{qualityList:qualityList,videoMeta:_this3._currentVideoSource}}),_this3._contentPlayerModule.setMetaLoaded(!0)}),this.subscribe(HlsEventEnum.BufferingError,this._hlsSourceHandler,function(){_this3.mediator.publish(_this3,VideoEventsEnum.Buffering)}),this.subscribe(HlsEventEnum.FragBuffered,this._hlsSourceHandler,function(){_this3.mediator.publish(_this3,VideoEventsEnum.Buffered)}),this.subscribe(HlsEventEnum.StreamEnded,this._hlsSourceHandler,function(){_this3.mediator.publish(_this3,VideoEventsEnum.EndOfStream)}),this.subscribe(HlsEventEnum.LevelSwitching,this._hlsSourceHandler,function(){_this3.mediator.publish(_this3,VideoEventsEnum.LevelSwitching)})}},{key:"_startMp4SourceHandler",value:function(){this._startSourceHandler(this._mp4SourceHandler)}},{key:"_startHlsSourceHandler",value:function(){this._hlsSourceHandler&&this._startSourceHandler(this._hlsSourceHandler)}},{key:"_startSourceHandler",value:function(sourceHandler){sourceHandler.start(),this._handleEvents(sourceHandler)}},{key:"_handleContentPlayerEvents",value:function(){var _this4=this;this._videoEvents.forEach(function(event){_this4.subscribe(event,_this4._contentPlayerModule,function(data){event===VideoTagEvents.Canplay&&_this4._forceStartTime&&(_this4.currentTime=_this4._forceStartTime,_this4._forceStartTime=null),_this4.mediator.publish(_this4,event,data)})}),this.relay(VideoEventsEnum.PlayError,this._contentPlayerModule,this,this.mediator)}},{key:"_handleEvents",value:function(sourceHandler){var _this5=this;this.relay([VideoQualityEventsEnum.CurrentQuality,VideoEventsEnum.NewVideo],sourceHandler,this,this.mediator),this.subscribe(VideoQualityEventsEnum.Change,sourceHandler,function(_ref2){var height=_ref2.payload;_this5.onQualityChanged(height)}),this.subscribe(VideoSourceEventsEnum.TrackLoaded,sourceHandler,function(){_this5._onTrackLoaded()})}},{key:"forceCurrentTime",value:function(value){this._contentPlayerModule.currentTime=value,this._forceStartTime=value}},{key:"hide",value:function(){Object(DomUtils.a)(this._videoContainer,CssClassesConfig.d)}},{key:"show",value:function(){Object(DomUtils.L)(this._videoContainer,CssClassesConfig.d)}},{key:"setSource",value:function(source){var _this6=this,preloadVideoSources=arguments.length>1&&void 0!==arguments[1]&&arguments[1],forceSourceHandler=arguments.length>2?arguments[2]:void 0;return this._forceStartTime=null,new Promise(function(resolve,reject){try{_this6._currentVideoSource=source,_this6._currentSourceHandler&&_this6._currentSourceHandler.detachMedia(),forceSourceHandler?_this6._forceSourceHandler(forceSourceHandler):Object(TypeUtils.h)(source.hlsFilePath)&&_this6._hlsSourceHandler?_this6._currentSourceHandler=_this6._hlsSourceHandler:_this6._forceSourceHandler(_this6._mp4SourceHandler),source&&source.subtitle&&_this6._contentPlayerModule.setCrossOriginAttribute(),_this6._contentPlayerModule.setPoster(source),_this6._contentPlayerModule.setTrackModes(_this6._captionsEnabled?TextTrackModeEnum.Hidden:TextTrackModeEnum.Disabled),preloadVideoSources&&_this6._contentPlayerModule.setMetaLoaded(!1),_this6._currentSourceHandler.setSource(source,preloadVideoSources),_this6.mediator.publish(_this6,VideoEventsEnum.NewVideo),resolve()}catch(e){Object(Logging.a)({message:"VideoHandler_set_video_source",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.FATAL}),reject()}})}},{key:"setQuality",value:function(newQualitySettings){this._currentSourceHandler.setQuality(newQualitySettings)}},{key:"pause",value:function(){this._contentPlayerModule.pause()}},{key:"play",value:function(){var _this7=this;return this._playDeferredPromise=new DeferredPromise.a,this._currentSourceHandler.attachMedia().then(function(){_this7._contentPlayerModule.play().then(function(){_this7._playDeferredPromise.resolve()}).catch(function(e){!_this7._hlsUnexpectedError&&_this7._playDeferredPromise&&_this7._playDeferredPromise.isPending&&(_this7._playDeferredPromise.reject(),Object(Logging.a)({message:"VideoHandler_public_play_content_player_play",exception:e.message,callStack:e.callStack,level:protos.ProtoLoggingLevelEnum.FATAL}))})}).catch(function(e){_this7._playDeferredPromise&&_this7._playDeferredPromise.isPending&&_this7._playDeferredPromise.reject(e),Object(Logging.a)({message:"VideoHandler_public_play_attach_media_error",exception:e.message,callStack:e.callStack,level:protos.ProtoLoggingLevelEnum.FATAL})}),this._playDeferredPromise.promise}},{key:"isPlayPending",value:function(){return this._contentPlayerModule.isPlayPending()}},{key:"showCaptions",value:function(){this._captionsEnabled=!0,this._contentPlayerModule.setTrackModes(TextTrackModeEnum.Hidden)}},{key:"hideCaptions",value:function(){this._captionsEnabled=!1,this._contentPlayerModule.setTrackModes(TextTrackModeEnum.Disabled),this.currentTrack&&this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.CaptionUpdate])}},{key:"destroy",value:function(){this._currentSourceHandler.destroy(),this._videoContainer.parentNode.removeChild(this._videoContainer)}},{key:"_createElements",value:function(){this._videoContainer=this._globalDomUtilsService.createElementByString('<cnx class="cnx-video-wrapper"></cnx>'),this._videoTag=this._globalDomUtilsService.createElementByString('<video class="cnx-video-tag"></video>'),this._options.os===OsConfig.b.Ios&&(this._videoTag.setAttribute("playsinline",""),this._videoTag.setAttribute("webkit-playsinline",""))}},{key:"_forceSourceHandler",value:function(sourceHandler){this._currentSourceHandler=sourceHandler,this._currentSourceHandler.setQuality({quality:VideoQualityEnum.Auto,height:0})}},{key:"onQualityChanged",value:function(height){var _this8=this,playing=this._contentPlayerModule.playing;this._forceStartTime=this.currentTime,playing&&this._currentSourceHandler.onQualityChanged&&this._currentSourceHandler.onQualityChanged().then(function(){_this8._contentPlayerModule.setMetaLoaded(!1),_this8._contentPlayerModule.play().catch(function(e){Object(Logging.a)({message:"VideoHandler_quality_changed",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.FATAL})})}),this.mediator.publish(this,VideoQualityEventsEnum.Change,{payload:height})}},{key:"_showNativeCaptions",value:function(){this.currentTrack&&(this.currentTrack.oncuechange=null,this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.CaptionUpdate]),this.currentTrack.mode=TextTrackModeEnum.Showing)}},{key:"_hideNativeCaptions",value:function(){if(this.currentTrack){switch(this.currentTrack.mode){case TextTrackModeEnum.Showing:case TextTrackModeEnum.Hidden:this._captionsEnabled=!0;break;case TextTrackModeEnum.Disabled:this._captionsEnabled=!1}this.mediator.publish(this,this._captionsEnabled?UiComponentEventsEnum[UiComponentEventsEnum.CaptionOn]:UiComponentEventsEnum[UiComponentEventsEnum.CaptionOff])}this._onTrackLoaded()}},{key:"width",get:function(){return this._videoContainer.getBoundingClientRect().width}},{key:"height",get:function(){return this._videoContainer.getBoundingClientRect().height}},{key:"currentTime",get:function(){return this._contentPlayerModule.currentTime},set:function(value){this._contentPlayerModule.currentTime=value}},{key:"duration",get:function(){return this._contentPlayerModule.duration}},{key:"volume",get:function(){return this._contentPlayerModule.volume},set:function(value){this._contentPlayerModule.volume=value}},{key:"playing",get:function(){return this._contentPlayerModule.playing}},{key:"isIosFullscreen",get:function(){return this._isIosFullscreen},set:function(value){this._isIosFullscreen=value,this._isIosFullscreen&&this._captionsEnabled?this._showNativeCaptions():this._hideNativeCaptions()}},{key:"currentQualitySettings",get:function(){return this._currentSourceHandler.currentQualitySettings}},{key:"currentTrack",get:function(){return this._contentPlayerModule.getCurrentTrack()}}]),VideoHandler}(Mediator.a);function SlideVideoSourceMeta_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var SlideVideoSourceMeta_SlideVideoSourceMeta=function(_VideoSourceMeta){inherits_default()(SlideVideoSourceMeta,_VideoSourceMeta);var _super=SlideVideoSourceMeta_createSuper(SlideVideoSourceMeta);function SlideVideoSourceMeta(metadata,_urlSuffixerService){var _this;return classCallCheck_default()(this,SlideVideoSourceMeta),(_this=_super.call(this,null,null,metadata,_urlSuffixerService))._urlSuffixerService=_urlSuffixerService,_this}return createClass_default()(SlideVideoSourceMeta,[{key:"getSources",value:function(quality,encodings){var _this2=this;return encodings.map(function(_ref){var id=_ref.id,type=_ref.type,rendition=_this2._getRendition(quality,id);if(rendition)return{type:type,src:_this2._urlSuffixerService.appendParamsToUrl("".concat(rendition.file))}}).filter(function(rendition){return rendition})}},{key:"getThumbnailUrl",value:function(desiredWidth,desiredHeight){return ImageUrlBuilder_ImageUrlBuilder.getSmartCroppedImageUrl(this._thumbnail,desiredWidth,desiredHeight,this._urlSuffixerService)}}]),SlideVideoSourceMeta}(function(){function VideoSourceMeta(_id,_mediaContentVersionId,metadata,_urlSuffixerService){classCallCheck_default()(this,VideoSourceMeta),this._id=_id,this._mediaContentVersionId=_mediaContentVersionId,this._urlSuffixerService=_urlSuffixerService,this._keywordList=[],this._trackList=[],this._renditionList=[],this._customFields=[],this._videoIndexes=[],this._availableQualities=[],this._title=metadata.title,this._altText=metadata.altText,this._description=metadata.description,this._clickUrl=metadata.clickUrl,this._keywordList=metadata.keywordList,this._languageId=metadata.languageId,this._trackList=metadata.trackList,this._thumbnail=metadata.thumbnail,this._duration=metadata.duration,this._customFields=metadata.customFields,this._hlsFilePath=metadata.hlsFilePath,this._sourceItemId=metadata.sourceItemId,this._videoIndexes=metadata.videoIndexes,Object(ArrayUtils.h)(metadata.renditionList)&&(this._renditionList=this._sortRenditionsAscending(metadata.renditionList),this._createAvailableQualities(metadata.renditionList))}return createClass_default()(VideoSourceMeta,[{key:"_sortRenditionsAscending",value:function(renditionList){return renditionList.sort(function(a,b){return a.height-b.height})}},{key:"setAvailableQualities",value:function(availableQualities){this._availableQualities=availableQualities}},{key:"_createAvailableQualities",value:function(renditions){var _this=this;Object(ArrayUtils.e)("height",renditions).forEach(function(rendition,index){_this._availableQualities.push({videoHeight:rendition.height,label:"".concat(rendition.height,"p"),isHD:rendition.height>=VIDEO_HD_HEIGHT})})}},{key:"_findRendition",value:function(codec,height){return this._renditionList.find(function(rendition){return rendition.codec===codec&&rendition.height===height})}},{key:"_getAssetUrl",value:function(endpointString,assetName){var assetUrl="".concat(endpointString).concat(this._id,"/");return Object(TypeUtils.h)(this._mediaContentVersionId)?assetUrl+="".concat(this._mediaContentVersionId,"/").concat(assetName):assetUrl+=assetName,assetUrl}},{key:"_getRendition",value:function(quality,encoding){var closestHeight=Object(NumberUtils.c)(quality,this._availableQualities.map(function(elem){return elem.videoHeight}));return this._findRendition(encoding,closestHeight)}},{key:"getAvailableQualities",value:function(){return this._availableQualities}},{key:"getClosestSourceQuality",value:function(quality){var videoItem,closestHeight=Object(NumberUtils.c)(quality,this._availableQualities.map(function(elem){return elem.videoHeight}));return this._availableQualities.forEach(function(videoQualityItem){videoQualityItem.videoHeight===closestHeight&&(videoItem=videoQualityItem)}),videoItem}},{key:"getSources",value:function(quality,encodings){var _this2=this,sources=[];return encodings.forEach(function(videoEncoding){var rendition=_this2._getRendition(quality,videoEncoding.id);Object(ArrayUtils.h)(sources)||rendition&&sources.push({src:_this2._urlSuffixerService.appendParamsToUrl(_this2._getAssetUrl(EndPointResolver.a.endPoints.base.video,rendition.file)),type:videoEncoding.type})}),sources}},{key:"getHlsSource",value:function(){return this._urlSuffixerService.appendParamsToUrl(this._getAssetUrl(EndPointResolver.a.endPoints.base.video,this._hlsFilePath))}},{key:"getThumbnailUrl",value:function(desiredWidth,desiredHeight){var imageUrl=this._getAssetUrl(EndPointResolver.a.endPoints.base.image,this._thumbnail);return ImageUrlBuilder_ImageUrlBuilder.getSmartCroppedImageUrl(imageUrl,desiredWidth,desiredHeight,this._urlSuffixerService)}},{key:"hlsFilePath",get:function(){return this._hlsFilePath}},{key:"title",get:function(){return this._title}},{key:"altText",get:function(){return Object(TypeUtils.a)(this._altText)?this._altText:""}},{key:"description",get:function(){return this._description}},{key:"clickUrl",get:function(){return this._clickUrl}},{key:"keywords",get:function(){return this._keywordList}},{key:"languageId",get:function(){return this._languageId}},{key:"sourceItemId",get:function(){return this._sourceItemId}},{key:"subtitle",get:function(){if(this._trackList&&this._trackList[0])return this._urlSuffixerService.appendParamsToUrl(this._getAssetUrl(EndPointResolver.a.endPoints.base.video,this._trackList[0].file))}},{key:"spriteSheet",get:function(){return this._spriteSheet}},{key:"duration",get:function(){return this._duration}},{key:"id",get:function(){return this._id}},{key:"customFields",get:function(){return this._customFields}},{key:"videoIndexes",get:function(){return this._videoIndexes}}]),VideoSourceMeta}());function SlideVideo_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var SlideVideo_SlideVideo=function(_SlideBase){inherits_default()(SlideVideo,_SlideBase);var _super=SlideVideo_createSuper(SlideVideo);function SlideVideo(mediator,_metadata,_app,_globalDomUtilsService,_resizeObserverService){var _this$_videoData,_this,_initialVolume=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,_options=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};return classCallCheck_default()(this,SlideVideo),(_this=_super.call(this,mediator,_metadata,_globalDomUtilsService,_resizeObserverService,_app.services.UrlSuffixerService))._app=_app,_this._initialVolume=_initialVolume,_this._options=_options,_this._defaultStartingVideoTime=.1,_this.type=protos.ProtoMediaTypeEnum.Video,_this._videoData=(_this$_videoData={},defineProperty_default()(_this$_videoData,Config_PlayspaceLayoutEnum.Landscape,{renditionList:[],videoSourceMeta:void 0}),defineProperty_default()(_this$_videoData,Config_PlayspaceLayoutEnum.Portrait,{renditionList:[],videoSourceMeta:void 0}),_this$_videoData),_this._cachedQuality=null,_this.getClosestSourceQuality=function(quality){return _this._currentOrientation||_this._setCurrentOrientation(),_this._videoData[_this._currentOrientation].videoSourceMeta.getClosestSourceQuality(quality)},_this._initRenditionList(),_this._initVideoSourceData(),_this}return createClass_default()(SlideVideo,[{key:"_initRenditionList",value:function(){var _this2=this;this._metadata.videoRendition.renditions.forEach(function(_ref){var codec=_ref.codec,height=_ref.height,width=_ref.width,file=_ref.videoUrl,rendition={codec:ProtoModels_Generated_protos.ProtoPlayspaceCodecEnum[codec],height:height,file:file};height<width?_this2._videoData[Config_PlayspaceLayoutEnum.Landscape].renditionList.push(rendition):_this2._videoData[Config_PlayspaceLayoutEnum.Portrait].renditionList.push(rendition)});var landscapeRenditions=this._videoData[Config_PlayspaceLayoutEnum.Landscape].renditionList,portraitRenditions=this._videoData[Config_PlayspaceLayoutEnum.Portrait].renditionList;Object(ArrayUtils.h)(landscapeRenditions)||Object(ArrayUtils.h)(portraitRenditions)?(Object(ArrayUtils.h)(landscapeRenditions)||(this._videoData[Config_PlayspaceLayoutEnum.Landscape].renditionList=portraitRenditions),Object(ArrayUtils.h)(portraitRenditions)||(this._videoData[Config_PlayspaceLayoutEnum.Portrait].renditionList=landscapeRenditions)):Object(Logging.a)({message:"SlideVideo_no_renditions",level:protos.ProtoLoggingLevelEnum.FATAL})}},{key:"_initVideoSourceData",value:function(){var _this3=this;Object.keys(this._videoData).forEach(function(item){var videoData=_this3._videoData[item];videoData.videoSourceMeta=new SlideVideoSourceMeta_SlideVideoSourceMeta({title:_this3._metadata.title,altText:_this3._metadata.altText,clickUrl:_this3._metadata.clickUrl,renditionList:videoData.renditionList,thumbnail:_this3._metadata.imageUrl},_this3._urlSuffixerService)})}},{key:"_initVideoHandler",value:function($parentContainer){this._videoHandler=new VideoHandler_VideoHandler(this,this._app,this._globalDomUtilsService,$parentContainer,this._resizeObserverService,this._initialVolume,this._options,this._defaultStartingVideoTime)}},{key:"_subscribeToQualityChange",value:function(){var _this4=this;this.subscribe(VideoQualityEventsEnum.Change,this._videoHandler,function(_ref2){var quality=_ref2.payload,currentHeight=_this4.getClosestSourceQuality(quality);_this4.mediator.publish(_this4,VideoQualityEventsEnum.Change,{payload:currentHeight.videoHeight})})}},{key:"_setCurrentOrientation",value:function(){var _this$_$mediaContaine=this._$mediaContainer,clientHeight=_this$_$mediaContaine.clientHeight,clientWidth=_this$_$mediaContaine.clientWidth;this._currentOrientation=clientHeight<clientWidth?Config_PlayspaceLayoutEnum.Landscape:Config_PlayspaceLayoutEnum.Portrait}},{key:"_setVideo",value:function(matchCurrentTime){var forceStartTime,_this5=this;this._videoHandler&&(matchCurrentTime&&(forceStartTime=this._videoHandler.currentTime),this._videoHandler.setSource(this._videoData[this._currentOrientation].videoSourceMeta,!0).then(function(){matchCurrentTime&&_this5._videoHandler.forceCurrentTime(forceStartTime),_this5._videoHandler.playing&&_this5._playContent()}))}},{key:"_getTemplate",value:function(){return SlideVideoTemplate_default.a}},{key:"_playContent",value:function(){this._videoHandler.play().catch(function(){})}},{key:"play",value:function(){this.isLoaded&&this._playContent()}},{key:"pause",value:function(){this.isLoaded&&this._videoHandler.pause()}},{key:"reset",value:function(){this._isLoaded&&(this._videoHandler.currentTime=this._defaultStartingVideoTime)}},{key:"load",value:function($mediaWrapper){this.isLoaded||($mediaWrapper.appendChild(this._$mediaContainer),this.isLoaded=!0,this._initVideoHandler(this._$mediaContainer),this._subscribeToQualityChange(),this._videoHandler.start(),this._setCurrentOrientation(),this._setVideo(),this._cachedQuality&&this.setQuality(this._cachedQuality),this.pause())}},{key:"getAvailableQualities",value:function(){return this._videoData[this._currentOrientation].videoSourceMeta.getAvailableQualities()}},{key:"setQuality",value:function(newQualitySettings){this._videoHandler?this._videoHandler.setQuality(newQualitySettings):this._cachedQuality=newQualitySettings}},{key:"onSlideResizeCallback",value:function(){var _this6=this,oldOrientation=this._currentOrientation;this._globalDomUtilsService.cancelRequestAnimationFrame(this._raf),this._raf=this._globalDomUtilsService.requestAnimationFrameHelper(function(){if(_this6._setCurrentOrientation(),oldOrientation!==_this6._currentOrientation){_this6._setVideo(!0)}})}},{key:"currentQuality",get:function(){return this._videoHandler.currentQualitySettings}},{key:"volume",get:function(){return this.isLoaded?this._videoHandler.volume:this._initialVolume},set:function(volume){this.isLoaded?this._videoHandler.volume=volume:this._initialVolume=volume}}]),SlideVideo}(SlideBase_SlideBase),SlideTemplate_SlideTemplate=function(){function SlideTemplate(_templateSettings){classCallCheck_default()(this,SlideTemplate),this._templateSettings=_templateSettings}return createClass_default()(SlideTemplate,[{key:"_getCtaButtonComponent",value:function(){return this._templateSettings.disableCTARendering?"":"[[".concat(UiComponentsEnum.CtaButton,"]]")}},{key:"template",get:function(){return'\n        <cnx class="cnx-ui-ps-slide-wrapper">\n            <cnx class="cnx-ui-ps-slide"></cnx>\n            <cnx class="cnx-ui-ps-slide-bg"></cnx>\n            <cnx class="cnx-ui-ps-cta-wrapper">\n                '.concat(this._getCtaButtonComponent(),"\n            </cnx>\n        </cnx>\n        ").trim()}}]),SlideTemplate}();function UiSlideStatePlaying_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var UiSlideStatePlaying_UiSlideStatePlaying=function(_AUiStatePlaying){inherits_default()(UiSlideStatePlaying,_AUiStatePlaying);var _super=UiSlideStatePlaying_createSuper(UiSlideStatePlaying);function UiSlideStatePlaying(){return classCallCheck_default()(this,UiSlideStatePlaying),_super.apply(this,arguments)}return createClass_default()(UiSlideStatePlaying,[{key:"enterState",value:function(){get_default()(getPrototypeOf_default()(UiSlideStatePlaying.prototype),"enterState",this).call(this);var progress=this.context.getComponent(UiComponentsEnum.PlayspaceProgressBar);progress&&progress.startProgress();var cta=this.context.getComponent(UiComponentsEnum.CtaButton);cta&&cta.startProgress()}},{key:"exitState",value:function(){get_default()(getPrototypeOf_default()(UiSlideStatePlaying.prototype),"exitState",this).call(this)}},{key:"updateDuration",value:function(){var progress=this.context.getComponent(UiComponentsEnum.PlayspaceProgressBar);progress&&progress.startProgress()}}]),UiSlideStatePlaying}(AUiStatePlaying_AUiStatePlaying);function UiSlideStatePaused_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var UiSlideStatePaused_UiSlideStatePaused=function(_AUiStatePaused){inherits_default()(UiSlideStatePaused,_AUiStatePaused);var _super=UiSlideStatePaused_createSuper(UiSlideStatePaused);function UiSlideStatePaused(){return classCallCheck_default()(this,UiSlideStatePaused),_super.apply(this,arguments)}return createClass_default()(UiSlideStatePaused,[{key:"enterState",value:function(){get_default()(getPrototypeOf_default()(UiSlideStatePaused.prototype),"enterState",this).call(this);var progress=this.context.getComponent(UiComponentsEnum.PlayspaceProgressBar);progress&&progress.pauseProgress();var cta=this.context.getComponent(UiComponentsEnum.CtaButton);cta&&cta.pauseProgress()}},{key:"exitState",value:function(){get_default()(getPrototypeOf_default()(UiSlideStatePaused.prototype),"exitState",this).call(this)}},{key:"updateDuration",value:function(){}}]),UiSlideStatePaused}(AUiStatePaused_AUiStatePaused);function UiSlideStateStopped_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var UiSlideStateStopped_UiSlideStateStopped=function(_UiSlideStatePaused){inherits_default()(UiSlideStateStopped,_UiSlideStatePaused);var _super=UiSlideStateStopped_createSuper(UiSlideStateStopped);function UiSlideStateStopped(){return classCallCheck_default()(this,UiSlideStateStopped),_super.apply(this,arguments)}return createClass_default()(UiSlideStateStopped,[{key:"enterState",value:function(){get_default()(getPrototypeOf_default()(UiSlideStateStopped.prototype),"enterState",this).call(this)}},{key:"exitState",value:function(){get_default()(getPrototypeOf_default()(UiSlideStateStopped.prototype),"exitState",this).call(this)}}]),UiSlideStateStopped}(UiSlideStatePaused_UiSlideStatePaused);function UiSlideStateHidden_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var UiSlideStateHidden_UiSlideStateHidden=function(_UiSlideStatePaused){inherits_default()(UiSlideStateHidden,_UiSlideStatePaused);var _super=UiSlideStateHidden_createSuper(UiSlideStateHidden);function UiSlideStateHidden(){return classCallCheck_default()(this,UiSlideStateHidden),_super.apply(this,arguments)}return createClass_default()(UiSlideStateHidden,[{key:"enterState",value:function(){get_default()(getPrototypeOf_default()(UiSlideStateHidden.prototype),"enterState",this).call(this)}},{key:"exitState",value:function(){get_default()(getPrototypeOf_default()(UiSlideStateHidden.prototype),"exitState",this).call(this)}}]),UiSlideStateHidden}(UiSlideStatePaused_UiSlideStatePaused);function UiSlideStateRoll_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var UiSlideStateRoll_UiSlideStateRoll=function(_UiSlideStatePaused){inherits_default()(UiSlideStateRoll,_UiSlideStatePaused);var _super=UiSlideStateRoll_createSuper(UiSlideStateRoll);function UiSlideStateRoll(){return classCallCheck_default()(this,UiSlideStateRoll),_super.apply(this,arguments)}return createClass_default()(UiSlideStateRoll,[{key:"enterState",value:function(){get_default()(getPrototypeOf_default()(UiSlideStateRoll.prototype),"enterState",this).call(this)}},{key:"exitState",value:function(){get_default()(getPrototypeOf_default()(UiSlideStateRoll.prototype),"exitState",this).call(this)}}]),UiSlideStateRoll}(UiSlideStatePaused_UiSlideStatePaused);function UiSlide_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var UiSlide_UiSlide=function(_AUiBase){inherits_default()(UiSlide,_AUiBase);var _super=UiSlide_createSuper(UiSlide);function UiSlide(mediator,$container,_globalDomUtilsService,_resizeObserverService,templateString,_isMobile,_$footer,_startState,interactionService){var _this$_states,_this;return classCallCheck_default()(this,UiSlide),(_this=_super.call(this,mediator,$container,_globalDomUtilsService,templateString,new UiPlayspaceComponentFactory_UiPlayspaceComponentFactory(_globalDomUtilsService,interactionService,_resizeObserverService,$container,{isMobile:_isMobile}))).mediator=mediator,_this.$container=$container,_this._globalDomUtilsService=_globalDomUtilsService,_this._$footer=_$footer,_this._componentList=[UiComponentsEnum.CtaButton],_this._capabilityHandler=new UiSlideCapabilityHandler_UiSlideCapabilityHandler,_this._states=(_this$_states={},defineProperty_default()(_this$_states,ContentStatesEnum.PlayingState,new UiSlideStatePlaying_UiSlideStatePlaying(assertThisInitialized_default()(_this))),defineProperty_default()(_this$_states,ContentStatesEnum.PausedState,new UiSlideStatePaused_UiSlideStatePaused(assertThisInitialized_default()(_this))),defineProperty_default()(_this$_states,ContentStatesEnum.StoppedState,new UiSlideStateStopped_UiSlideStateStopped(assertThisInitialized_default()(_this))),defineProperty_default()(_this$_states,ContentStatesEnum.HiddenState,new UiSlideStateHidden_UiSlideStateHidden(assertThisInitialized_default()(_this))),defineProperty_default()(_this$_states,ContentStatesEnum.PrerollState,new UiSlideStateRoll_UiSlideStateRoll(assertThisInitialized_default()(_this))),defineProperty_default()(_this$_states,ContentStatesEnum.PostrollState,new UiSlideStateRoll_UiSlideStateRoll(assertThisInitialized_default()(_this))),_this$_states),_this._setCtaButtonFooter(),_this._states[_startState].enterState(),_this._setCurrentCapabilityList(),_this._applyCurrentCapabilityList(!1),_this}return createClass_default()(UiSlide,[{key:"_setCtaButtonFooter",value:function(){var ctaButton=this.getComponent(UiComponentsEnum.CtaButton);ctaButton&&ctaButton.setFooterElement(this._$footer)}},{key:"_setCurrentCapabilityList",value:function(){var capabilityList=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._capabilityHandler.setCapabilityList(capabilityList)}},{key:"_applyCurrentCapabilityList",value:function(){var _this2=this,useTransition=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],_this$_capabilityHand=this._capabilityHandler.getComponentList(),excludedComponents=_this$_capabilityHand.excludedComponents,includedComponents=_this$_capabilityHand.includedComponents;excludedComponents.map(function(item){return _this2.getComponent(item)}).forEach(function(component){return component&&component.hideComponent(useTransition)}),includedComponents.map(function(item){return _this2.getComponent(item)}).forEach(function(component){return component&&component.showComponent(useTransition)})}},{key:"_trackClickEvents",value:function(eventName){switch(eventName){case UiPlayspaceEventsEnum.CallToAction:this.mediator.publish(this,UiPlayspaceEventsEnum.GeneralClickInteraction,{payload:protos.ProtoMediaClickTypeEnum.UrlClick});break;case UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.Scroll]:this.mediator.publish(this,UiPlayspaceEventsEnum.GeneralClickInteraction,{payload:protos.ProtoMediaClickTypeEnum.ScrollClick})}}},{key:"handleComponentEvent",value:function(eventName,eventData,component){this._trackClickEvents(eventName),eventName===UiPlayspaceEventsEnum.CallToAction?Object(TypeUtils.h)(eventData.payload)?this.mediator.publish(this,UiPlayspaceEventsEnum.CallToAction,eventData):this.mediator.publish(this,UiComponentEventsEnum[UiComponentEventsEnum.Next]):this.mediator.publish(this,eventName,eventData)}},{key:"handleCapabilityList",value:function(capabilityList){var _this3=this;this._setCurrentCapabilityList(capabilityList),this._applyCurrentCapabilityList(),this._componentList.forEach(function(slidingComponent){var renderedSlidingComponent=_this3.getComponent(slidingComponent);renderedSlidingComponent&&renderedSlidingComponent.handleCapabilities(capabilityList)})}}]),UiSlide}(AUiBase_AUiBase);function ABaseSlide_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var CSS_SLIDE_MEDIA_WRAPPER="cnx-ui-ps-slide",ABaseSlide_ABaseSlide=function(_Mediator){inherits_default()(ABaseSlide,_Mediator);var _super=ABaseSlide_createSuper(ABaseSlide);function ABaseSlide(mediator,_metadata,_globalDomUtilsService,_interactionService,_resizeObserverService,_media,_isMobile,_templateSettings,_$footer,_playerModel){var _this;return classCallCheck_default()(this,ABaseSlide),(_this=_super.call(this)).mediator=mediator,_this._metadata=_metadata,_this._globalDomUtilsService=_globalDomUtilsService,_this._interactionService=_interactionService,_this._resizeObserverService=_resizeObserverService,_this._media=_media,_this._isMobile=_isMobile,_this._templateSettings=_templateSettings,_this._$footer=_$footer,_this._playerModel=_playerModel,_this._slideCapabilityList=[{type:SlideCapabilityTypeEnum.TopLogo,metadata:{}}],_this._$container=_this._globalDomUtilsService.createElementByString('<cnx class="'.concat(CSSClassMainPlayspaceEnum.Slide,'"></cnx>')),_this._initUserInterface(),_this._$mediaWrapper=_this._$container.querySelector(".".concat(CSS_SLIDE_MEDIA_WRAPPER)),_this}return createClass_default()(ABaseSlide,[{key:"load",value:function(){this._media.load(this._$mediaWrapper)}},{key:"updateCapabilityMetadata",value:function(capability){if(Object(ArrayUtils.h)(this._slideCapabilityList)){var slideCapability=this._slideCapabilityList.find(function(_ref){return _ref.type===capability.type});slideCapability&&(slideCapability.metadata=Object.assign(Object.assign({},slideCapability.metadata),capability.metadata))}}},{key:"changeState",value:function(newState){this._userInterface.changeState(newState)}},{key:"_initUserInterface",value:function(){var _this2=this;this._userInterface=new UiSlide_UiSlide(this,this._$container,this._globalDomUtilsService,this._resizeObserverService,this._getTemplate(),this._isMobile,this._$footer,this._playerModel.playbackMode===ProtoModels_Generated_protos.ProtoPlayerPlaybackModeEnum.ClickToPlay?ContentStatesEnum.StoppedState:ContentStatesEnum.PausedState,this._interactionService),this.subscribe(UiPlayspaceEventsEnum.CallToAction,this._userInterface,function(_ref2){_ref2.payload;_this2.mediator.publish(_this2,UiPlayspaceEventsEnum.CallToAction)}),this.relay(UiPlayspaceEventsEnum.GeneralClickInteraction,this._userInterface,this,this.mediator),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Next],this._userInterface,function(){_this2.mediator.publish(_this2,UiComponentEventsEnum[UiComponentEventsEnum.Next])})}},{key:"_getTemplate",value:function(){return new SlideTemplate_SlideTemplate(this._templateSettings).template}},{key:"_addCapability",value:function(type,metadata){this._slideCapabilityList.push({type:type,metadata:metadata})}},{key:"_addTopSlideTitleCapability",value:function(){var topSlideTitle=this._computeTopSlideTitle(this._metadata);if(topSlideTitle){var metadata={label:topSlideTitle,useTransition:!0};this._addCapability(SlideCapabilityTypeEnum.TopSlideTitle,metadata)}}},{key:"_computeTopSlideTitle",value:function(metadata){var slideTitle=metadata.publisherName||metadata.title,strippedTitle=this._globalDomUtilsService.stripHtmlTags(slideTitle).trim();return metadata.publisherName?"by <em>".concat(strippedTitle,"</em>"):strippedTitle}},{key:"onSlideTransitionStart",value:function(capabilityList){this._userInterface&&this._userInterface.handleCapabilityList(capabilityList)}},{key:"$container",get:function(){return this._$container}},{key:"slideCapabilityList",get:function(){return this._slideCapabilityList}},{key:"metadata",get:function(){return this._metadata}},{key:"media",get:function(){return this._media}},{key:"clickUrl",get:function(){return this._metadata.clickUrl}}]),ABaseSlide}(Mediator.a);function BulletSlide_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var BulletSlide_BulletSlide=function(_ABaseSlide){inherits_default()(BulletSlide,_ABaseSlide);var _super=BulletSlide_createSuper(BulletSlide);function BulletSlide(mediator,_metadata,_globalDomUtilsService,_interactionService,_resizeObserverService,_media,_isMobile,_slideTemplateSettings,_$footer,_playerModel){var _this;return classCallCheck_default()(this,BulletSlide),(_this=_super.call(this,mediator,_metadata,_globalDomUtilsService,_interactionService,_resizeObserverService,_media,_isMobile,_slideTemplateSettings,_$footer,_playerModel)).type=ProtoModels_Generated_protos.ProtoPlayspaceSlideTypeEnum.BulletList,Object(TypeUtils.f)(_metadata.bulletListMetadata)&&Object(ArrayUtils.h)(_this.metadata.bulletListMetadata.items)?(_this._addBulletSlideCapabilities(),_this.onSlideTransitionStart(_this._slideCapabilityList),_this):(Object(Logging.a)({message:"BulletSlide_no_metadata",level:protos.ProtoLoggingLevelEnum.FATAL}),possibleConstructorReturn_default()(_this))}return createClass_default()(BulletSlide,[{key:"_addBulletSlideCapabilities",value:function(){this._addBulletCapability(),this._addTopSlideTitleCapability(),this._addTopStoryTitleCapability()}},{key:"_addBulletCapability",value:function(){var _this$_metadata$bulle=this._metadata.bulletListMetadata,title=_this$_metadata$bulle.title,items=_this$_metadata$bulle.items;items.length>4&&(items.length=4);var type=SlideCapabilityTypeEnum.SlideTitle,metadata={bulletChunkList:items,titleType:SlideTitleTypeEnum.Bullet};Object(TypeUtils.h)(title)&&(metadata.label=title),this._addCapability(type,metadata)}},{key:"_addTopStoryTitleCapability",value:function(){var metadata={label:this._metadata.storyTitle,useFallbackLabel:!0};this._addCapability(SlideCapabilityTypeEnum.TopStoryTitle,metadata)}}]),BulletSlide}(ABaseSlide_ABaseSlide);function DescriptionSlide_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var _CTA_DEFAULT_LABEL,DescriptionSlide_DescriptionSlide=function(_ABaseSlide){inherits_default()(DescriptionSlide,_ABaseSlide);var _super=DescriptionSlide_createSuper(DescriptionSlide);function DescriptionSlide(mediator,_metadata,_globalDomUtilsService,_interactionService,_resizeObserverService,_media,_isMobile,_slideTemplateSettings,_$footer,_playerModel){var _this;return classCallCheck_default()(this,DescriptionSlide),(_this=_super.call(this,mediator,_metadata,_globalDomUtilsService,_interactionService,_resizeObserverService,_media,_isMobile,_slideTemplateSettings,_$footer,_playerModel)).type=ProtoModels_Generated_protos.ProtoPlayspaceSlideTypeEnum.Description,Object(TypeUtils.f)(_metadata.descriptionMetadata)&&Object(ArrayUtils.h)(_this.metadata.descriptionMetadata.chunkList)?(_this._setMetadataDefaults(),_this._constructCapabilityList(),_this.onSlideTransitionStart(_this._slideCapabilityList),_this):(Object(Logging.a)({message:"DescriptionSlide_no_metadata",level:protos.ProtoLoggingLevelEnum.FATAL}),possibleConstructorReturn_default()(_this))}return createClass_default()(DescriptionSlide,[{key:"_setMetadataDefaults",value:function(){var _this$_metadata$descr=this._metadata.descriptionMetadata,chunkList=_this$_metadata$descr.chunkList,label=_this$_metadata$descr.label,hasLabel=!1,isColorSchemeDefined=function(colorScheme){return Object(TypeUtils.e)(colorScheme)};Object(TypeUtils.f)(label)&&Object(TypeUtils.h)(label.text)&&(hasLabel=!0,label.colorScheme=isColorSchemeDefined(label.colorScheme)?label.colorScheme:ProtoModels_Generated_protos.ProtoPlayspaceColorSchemeEnum.Primary),Object(ArrayUtils.h)(chunkList)&&chunkList.forEach(function(chunk,index){chunk.colorScheme=0!==index||hasLabel?isColorSchemeDefined(chunk.colorScheme)?chunk.colorScheme:ProtoModels_Generated_protos.ProtoPlayspaceColorSchemeEnum.Secondary:isColorSchemeDefined(chunk.colorScheme)?chunk.colorScheme:ProtoModels_Generated_protos.ProtoPlayspaceColorSchemeEnum.Primary})}},{key:"_constructCapabilityList",value:function(){this._addDescriptionCapability(),this._addTopStoryTitleCapability(),this._addTopSlideTitleCapability()}},{key:"_addDescriptionCapability",value:function(){var _this$_metadata$descr2=this._metadata.descriptionMetadata,descriptionChunkList=_this$_metadata$descr2.chunkList,labelChunk=_this$_metadata$descr2.label,type=SlideCapabilityTypeEnum.SlideTitle,metadata={descriptionChunkList:descriptionChunkList,titleType:SlideTitleTypeEnum.Description};Object(TypeUtils.f)(labelChunk)&&(metadata.label=labelChunk.text,metadata.labelColorScheme=labelChunk.colorScheme),this._addCapability(type,metadata)}},{key:"_addTopStoryTitleCapability",value:function(){var metadata={label:this._metadata.storyTitle,useFallbackLabel:!0};this._addCapability(SlideCapabilityTypeEnum.TopStoryTitle,metadata)}}]),DescriptionSlide}(ABaseSlide_ABaseSlide);function DefaultSlide_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var CTA_DEFAULT_LABEL=(_CTA_DEFAULT_LABEL={},defineProperty_default()(_CTA_DEFAULT_LABEL,protos.ProtoMediaTypeEnum.Image,"Read more"),defineProperty_default()(_CTA_DEFAULT_LABEL,protos.ProtoMediaTypeEnum.Video,"Continue video"),_CTA_DEFAULT_LABEL),DefaultSlide_DefaultSlide=function(_ABaseSlide){inherits_default()(DefaultSlide,_ABaseSlide);var _super=DefaultSlide_createSuper(DefaultSlide);function DefaultSlide(mediator,_metadata,_globalDomUtilsService,_interactionService,_resizeObserverService,_media,_isMobile,_slideTemplateSettings,_$footer,_playerModel){var _this;return classCallCheck_default()(this,DefaultSlide),(_this=_super.call(this,mediator,_metadata,_globalDomUtilsService,_interactionService,_resizeObserverService,_media,_isMobile,_slideTemplateSettings,_$footer,_playerModel)).type=ProtoModels_Generated_protos.ProtoPlayspaceSlideTypeEnum.Default,_this._constructCapabilityList(),_this.onSlideTransitionStart(_this._slideCapabilityList),_this}return createClass_default()(DefaultSlide,[{key:"_constructCapabilityList",value:function(){this._addSlideTitleCapability(),this._addPlaybackControlsCapability(),this._addPlaylistControlsCapability(),this._addVolumeControlsCapability(),this._addCtaButtonCapability(),this._addTopStoryTitleCapability(),this._metadata.publisherName&&this._addTopSlideTitleCapability()}},{key:"_addSlideTitleCapability",value:function(){var _this$_metadata=this._metadata,metadata={url:_this$_metadata.clickUrl,label:_this$_metadata.title,titleType:SlideTitleTypeEnum.Default};this._addCapability(SlideCapabilityTypeEnum.SlideTitle,metadata)}},{key:"_addPlaybackControlsCapability",value:function(){this._addCapability(SlideCapabilityTypeEnum.PlaybackControls)}},{key:"_addPlaylistControlsCapability",value:function(){this._addCapability(SlideCapabilityTypeEnum.PlaylistControls)}},{key:"_addCtaButtonCapability",value:function(){var _this$_metadata2=this._metadata,url=_this$_metadata2.clickUrl,title=_this$_metadata2.title;if(Object(TypeUtils.h)(url)){var metadata={url:url,label:this._getCtaLabel(this._metadata),title:title,ctaAlignToContent:!0};this._addCapability(SlideCapabilityTypeEnum.CtaButton,metadata)}}},{key:"_addVolumeControlsCapability",value:function(){this._metadata.mediaType===protos.ProtoMediaTypeEnum.Video&&this._addCapability(SlideCapabilityTypeEnum.VolumeControls)}},{key:"_addTopStoryTitleCapability",value:function(){var topSlideTitle=this._globalDomUtilsService.stripHtmlTags(this._metadata.storyTitle).trim();if(topSlideTitle){var metadata={label:topSlideTitle,useFallbackLabel:!0};this._addCapability(SlideCapabilityTypeEnum.TopStoryTitle,metadata)}}},{key:"_getCtaLabel",value:function(metadata){var capabilityList=metadata.capabilityList,mediaType=metadata.mediaType;if(!Object(ArrayUtils.h)(capabilityList))return CTA_DEFAULT_LABEL[mediaType];var ctaCapability=capabilityList.find(function(_ref){return _ref.type===ProtoModels_Generated_protos.ProtoPlayspaceSlideCapabilitiesEnum.CtaButton});return ctaCapability&&ctaCapability.metadata?ctaCapability.metadata.label:CTA_DEFAULT_LABEL[mediaType]}}]),DefaultSlide}(ABaseSlide_ABaseSlide);function CoverSlide_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var CoverSlide_CoverSlide=function(_ABaseSlide){inherits_default()(CoverSlide,_ABaseSlide);var _super=CoverSlide_createSuper(CoverSlide);function CoverSlide(mediator,_metadata,_globalDomUtilsService,_interactionService,_resizeObserverService,_media,_totalReadingTime,_isMobile,_slideTemplateSettings,_$footer,_playerModel){var _this;return classCallCheck_default()(this,CoverSlide),(_this=_super.call(this,mediator,_metadata,_globalDomUtilsService,_interactionService,_resizeObserverService,_media,_isMobile,_slideTemplateSettings,_$footer,_playerModel))._totalReadingTime=_totalReadingTime,_this.type=ProtoModels_Generated_protos.ProtoPlayspaceSlideTypeEnum.Cover,_this._setContainerClass(),_this._constructCapabilityList(),_this.onSlideTransitionStart(_this._slideCapabilityList),_this}return createClass_default()(CoverSlide,[{key:"_setContainerClass",value:function(){Object(DomUtils.a)(this._$container,CSSClassSlideTitleEnum.Cover)}},{key:"_constructCapabilityList",value:function(){this._addSlideTitleCapability(),this._addCtaButtonCapability()}},{key:"_addSlideTitleCapability",value:function(){var type=SlideCapabilityTypeEnum.SlideTitle,metadata={titleType:SlideTitleTypeEnum.Cover,coverChunk:this._metadata.coverMetadata,label:"".concat(this._totalReadingTime," min. story")};this._addCapability(type,metadata)}},{key:"_addCtaButtonCapability",value:function(){var metadata={label:"START",duration:this._metadata.slideDuration,ctaAlignToContent:!1,ctaAlignToFooter:!0};this._addCapability(SlideCapabilityTypeEnum.CtaButton,metadata)}}]),CoverSlide}(ABaseSlide_ABaseSlide);function QuoteSlide_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var QuoteSlide_QuoteSlide=function(_ABaseSlide){inherits_default()(QuoteSlide,_ABaseSlide);var _super=QuoteSlide_createSuper(QuoteSlide);function QuoteSlide(mediator,_metadata,_globalDomUtilsService,_interactionService,_resizeObserverService,_media,_isMobile,_slideTemplateSettings,_$footer,_playerModel){var _this;return classCallCheck_default()(this,QuoteSlide),(_this=_super.call(this,mediator,_metadata,_globalDomUtilsService,_interactionService,_resizeObserverService,_media,_isMobile,_slideTemplateSettings,_$footer,_playerModel)).type=ProtoModels_Generated_protos.ProtoPlayspaceSlideTypeEnum.Quote,Object(TypeUtils.f)(_metadata.quoteMetadata)?(_this._constructCapabilityList(),_this.onSlideTransitionStart(_this._slideCapabilityList),_this):(Object(Logging.a)({message:"QuoteSlide_no_metadata",level:protos.ProtoLoggingLevelEnum.FATAL}),possibleConstructorReturn_default()(_this))}return createClass_default()(QuoteSlide,[{key:"_constructCapabilityList",value:function(){this._addTopStoryTitleCapability(),this._addTopSlideTitleCapability(),this._addQuoteCapability()}},{key:"_addTopStoryTitleCapability",value:function(){var metadata={label:this._metadata.storyTitle,useFallbackLabel:!0};this._addCapability(SlideCapabilityTypeEnum.TopStoryTitle,metadata)}},{key:"_addQuoteCapability",value:function(){var _this$_metadata$quote=this._metadata.quoteMetadata,quote=_this$_metadata$quote.text,source=_this$_metadata$quote.source,type=SlideCapabilityTypeEnum.SlideTitle,metadata={quote:quote,source:source,titleType:SlideTitleTypeEnum.Quote};this._addCapability(type,metadata)}}]),QuoteSlide}(ABaseSlide_ABaseSlide);function InstagramSlide_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var InstagramSlide_InstagramSlide=function(_ABaseSlide){inherits_default()(InstagramSlide,_ABaseSlide);var _super=InstagramSlide_createSuper(InstagramSlide);function InstagramSlide(mediator,_metadata,_globalDomUtilsService,_interactionService,_resizeObserverService,_media,_isMobile,_slideTemplateSettings,_$footer,_playerModel){var _this;return classCallCheck_default()(this,InstagramSlide),(_this=_super.call(this,mediator,_metadata,_globalDomUtilsService,_interactionService,_resizeObserverService,_media,_isMobile,_slideTemplateSettings,_$footer,_playerModel)).type=ProtoModels_Generated_protos.ProtoPlayspaceSlideTypeEnum.Instagram,_this._setContainerClass(),_this._constructCapabilityList(),_this.onSlideTransitionStart(_this._slideCapabilityList),_this}return createClass_default()(InstagramSlide,[{key:"_setContainerClass",value:function(){Object(DomUtils.a)(this._$container,CSSClassSlideTitleEnum.Instagram)}},{key:"_constructCapabilityList",value:function(){this._addInstagramCapability(),this._addTopStoryTitleCapability(),this._addTopSlideTitleCapability(),this._addCtaButtonCapability()}},{key:"_addInstagramCapability",value:function(){var _this$_metadata$insta=this._metadata.instagramMetadata,createdDate=_this$_metadata$insta.createdDate,comments=_this$_metadata$insta.comments,likes=_this$_metadata$insta.likes,metadata={label:this._metadata.title,instagramMetadata:{createdDate:createdDate,comments:comments,likes:likes},titleType:SlideTitleTypeEnum.Instagram};this._addCapability(SlideCapabilityTypeEnum.SlideTitle,metadata)}},{key:"_addTopStoryTitleCapability",value:function(){var metadata={label:this._metadata.storyTitle,useFallbackLabel:!0};this._addCapability(SlideCapabilityTypeEnum.TopStoryTitle,metadata)}},{key:"_addCtaButtonCapability",value:function(){var _this$_metadata=this._metadata,url=_this$_metadata.clickUrl,title=_this$_metadata.title;if(Object(TypeUtils.h)(url)){var metadata={url:url,label:"VISIT POST",title:title,ctaAlignToContent:!1,ctaAlignToFooter:!0};this._addCapability(SlideCapabilityTypeEnum.CtaButton,metadata)}}},{key:"_computeInstagramHandleTitle",value:function(metadata){var slideTitle=this.metadata.instagramMetadata.handle||metadata.publisherName,strippedTitle=this._globalDomUtilsService.stripHtmlTags(slideTitle).trim();return metadata.publisherName?"by <em>".concat(strippedTitle,"</em>"):strippedTitle}},{key:"_addTopSlideTitleCapability",value:function(){var topSlideTitle=this._computeInstagramHandleTitle(this._metadata);if(topSlideTitle){var metadata={label:topSlideTitle,useTransition:!0};this._addCapability(SlideCapabilityTypeEnum.TopSlideTitle,metadata)}}}]),InstagramSlide}(ABaseSlide_ABaseSlide),SlideFactory_SlideFactory=function(){function SlideFactory(_app,_globalDomUtilsService,_interactionService,_resizeObserverService,_initialVolume,_options,_isMobile,_slideTemplateSettings,_$footer,_playerModel){var _this$_slideType;classCallCheck_default()(this,SlideFactory),this._app=_app,this._globalDomUtilsService=_globalDomUtilsService,this._interactionService=_interactionService,this._resizeObserverService=_resizeObserverService,this._initialVolume=_initialVolume,this._options=_options,this._isMobile=_isMobile,this._slideTemplateSettings=_slideTemplateSettings,this._$footer=_$footer,this._playerModel=_playerModel,this._slideType=(_this$_slideType={},defineProperty_default()(_this$_slideType,ProtoModels_Generated_protos.ProtoPlayspaceSlideTypeEnum.Description,DescriptionSlide_DescriptionSlide),defineProperty_default()(_this$_slideType,ProtoModels_Generated_protos.ProtoPlayspaceSlideTypeEnum.Default,DefaultSlide_DefaultSlide),defineProperty_default()(_this$_slideType,ProtoModels_Generated_protos.ProtoPlayspaceSlideTypeEnum.Quote,QuoteSlide_QuoteSlide),defineProperty_default()(_this$_slideType,ProtoModels_Generated_protos.ProtoPlayspaceSlideTypeEnum.BulletList,BulletSlide_BulletSlide),defineProperty_default()(_this$_slideType,ProtoModels_Generated_protos.ProtoPlayspaceSlideTypeEnum.Instagram,InstagramSlide_InstagramSlide),_this$_slideType)}return createClass_default()(SlideFactory,[{key:"getSlide",value:function(metadata,mediator,totalReadingTime){var slideClass=this._slideType[metadata.type]||DefaultSlide_DefaultSlide,slideMedia=this._getSlideMedia(metadata,mediator);switch(metadata.type){case ProtoModels_Generated_protos.ProtoPlayspaceSlideTypeEnum.Cover:return new CoverSlide_CoverSlide(mediator,metadata,this._globalDomUtilsService,this._interactionService,this._resizeObserverService,slideMedia,totalReadingTime,this._isMobile,this._slideTemplateSettings,this._$footer,this._playerModel);default:return new slideClass(mediator,metadata,this._globalDomUtilsService,this._interactionService,this._resizeObserverService,slideMedia,this._isMobile,this._slideTemplateSettings,this._$footer,this._playerModel)}}},{key:"_getSlideMedia",value:function(metadata,mediator){if(metadata.mediaType===protos.ProtoMediaTypeEnum.Video)return new SlideVideo_SlideVideo(mediator,metadata,this._app,this._globalDomUtilsService,this._resizeObserverService,this._initialVolume,this._options);if(metadata.mediaType===protos.ProtoMediaTypeEnum.Image)return new SlideImage_SlideImage(mediator,metadata,this._globalDomUtilsService,this._resizeObserverService,this._app.services.UrlSuffixerService);throw new Error("Slide not found")}}]),SlideFactory}(),MediaMetadataHandler=__webpack_require__(99);function PlayspaceContentHandler_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var _PLAYSPACE_BREAK_POIN,PlaybackHandlerEvents,MEDIA_METADATA_HANDLER_ID="PlayspaceContentHandler",PlayspaceContentHandler_PlayspaceContentHandler=function(_Mediator){inherits_default()(PlayspaceContentHandler,_Mediator);var _super=PlayspaceContentHandler_createSuper(PlayspaceContentHandler);function PlayspaceContentHandler(mediator,_globalDomUtilsService,_resizeObserverService,_playerModel,_app,_$playerContainer,_ratioFacade){var _this;return classCallCheck_default()(this,PlayspaceContentHandler),(_this=_super.call(this)).mediator=mediator,_this._globalDomUtilsService=_globalDomUtilsService,_this._resizeObserverService=_resizeObserverService,_this._playerModel=_playerModel,_this._app=_app,_this._$playerContainer=_$playerContainer,_this._ratioFacade=_ratioFacade,_this._mediaMetadataHandler=new MediaMetadataHandler.a(ProtoModels_Generated_protos.ProtoPlayspaceMediaMetadataResponse,MEDIA_METADATA_HANDLER_ID),_this._volume=0,_this._fallBackStoryUsed=!1,_this._onFirstTimeInView=function(inView){inView&&(_this._userInterface.onFirstTimeInView(),_this._app.services.ViewabilityService.off(_this._$playerContainer,_this._onFirstTimeInView))},_this._updateUserSettings(),_this._initUserInterface(),_this._initSlidesManager(),_this._initStateManager(),_this.volume=_this._playerModel.soundMode===protos.ProtoPlayerSoundMode.On?1:0,_this._subscribeToEvents(),_this._app.services.ViewabilityService.on(_this._$playerContainer,_this._onFirstTimeInView,{threshold:.5}),_this}return createClass_default()(PlayspaceContentHandler,[{key:"_fetchMetadata",value:function(requestUrl){var _this2=this;return new Promise(function(resolve,reject){_this2._mediaMetadataHandler.fetchMetadata(requestUrl).then(function(storyMeta){if(window.parent.cnx_ps_slide_list&&Object(HrefUtils.b)("cnx_ps_slide_list",_this2._app.config.pageUrl)&&(storyMeta.slides=[].concat(toConsumableArray_default()(window.parent.cnx_ps_slide_list),toConsumableArray_default()(storyMeta.slides))),storyMeta.slides=_this2._fillterOutMatchingClickUrls(storyMeta.slides),storyMeta.slides=_this2._filterUnimplementedSlides(storyMeta.slides),storyMeta.slides.length>=2)resolve(storyMeta);else{if(_this2._fallBackStoryUsed)return void reject({message:"fallbackstory_already_used"});_this2._fallBackStoryUsed=!0,_this2._getDefaultStoryMeta().then(function(storyData){var requestUrlDefaultSlides=_this2._app.services.UrlSuffixerService.appendParamsToUrl("".concat(EndPointResolver.a.endPoints.base.metadata).concat(storyData.storyId,"/").concat(storyData.activeVersionId,".bin"));resolve(_this2._fetchMetadata(requestUrlDefaultSlides))}).catch(function(e){Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.FATAL,message:"PlayspaceContentH_error_getting_default_story"}),reject(e)})}}).catch(function(e){reject(e)})})}},{key:"_getDefaultStoryMeta",value:function(){return new Promise(function(resolve,reject){XhrUtils.a.sendProtoRequest({ProtoResponse:ProtoModels_Generated_protos.ProtoFallbackStoryResponse,endpoint:EndPointResolver.a.endPoints.api.fallbackstory,logError:!0}).then(function(storyMeta){resolve(storyMeta)}).catch(function(e){reject(e)})})}},{key:"_fillterOutMatchingClickUrls",value:function(storySlides){var pageURL;if(Object(TypeUtils.h)(this._app.config.appPageURL)){var _getUrlComponentsFrom=Object(GeneralUtils.g)(this._app.config.appPageURL),hostname=_getUrlComponentsFrom.hostname,pathname=_getUrlComponentsFrom.pathname;pageURL="".concat(hostname).concat(pathname)}else{var _this$_globalDomUtils=this._globalDomUtilsService.getGlobalLocationProperties(),_hostname=_this$_globalDomUtils.hostname,_pathname=_this$_globalDomUtils.pathname;pageURL="".concat(_hostname).concat(_pathname)}return storySlides.filter(function(slide){var clickUrlPathProp=Object(GeneralUtils.g)(slide.clickUrl);return!(clickUrlPathProp&&clickUrlPathProp.hostname+clickUrlPathProp.pathname===pageURL)})}},{key:"_filterUnimplementedSlides",value:function(storySlides){return storySlides.filter(function(slide){return slide.type!==ProtoModels_Generated_protos.ProtoPlayspaceSlideTypeEnum.Stock})}},{key:"_initSlidesManager",value:function(){var browser=this._app.config.browser.browserType,_this$_app$config$os=this._app.config.os,os=_this$_app$config$os.os,osVersion=_this$_app$config$os.osVersion,slideTemplateSettings={disableCTARendering:this._playerModel.disableCTARendering};this._slidesManager=new SlidesManager_SlidesManager(this,this._globalDomUtilsService,this._app.services.PageFocusService,this._userInterface.$mediaContainer,new SlideFactory_SlideFactory(this._app,this._globalDomUtilsService,this._app.services.InteractionService,this._resizeObserverService,this._playerModel.soundMode===protos.ProtoPlayerSoundMode.On?1:0,{browser:browser,os:os,osVersion:osVersion},this._app.config.isMobile,slideTemplateSettings,this._userInterface.footer,this._playerModel),this._playerModel.isSeoTraffic)}},{key:"_updateUserSettings",value:function(){this._uiSettings={logoUrl:this._playerModel.logoUrl,isMobile:this._app.config.isMobile,closeButtonMode:this._playerModel.closeButtonMode,floatingCloseButtonMode:this._playerModel.floatingSettings.floatingCloseButtonMode,isCloseButton:this._playerModel.isCloseButton,sharingDestinations:this._playerModel.sharingDestinations,os:this._app.config.os.os,expandButtonEnabled:this._playerModel.uiComponentsVisibility.expandButton,primaryColorList:{background:this._playerModel.primaryColorList.background||CssClassesConfig.l.PrimaryBackground,foreground:this._playerModel.primaryColorList.foreground||CssClassesConfig.l.PrimaryForeground},secondaryColorList:{background:this._playerModel.secondaryColorList.background||CssClassesConfig.l.SecondaryBackground,foreground:this._playerModel.secondaryColorList.foreground||CssClassesConfig.l.SecondaryForeground},accentColorList:{background:this._playerModel.accentColorList.background,foreground:this._playerModel.accentColorList.foreground||CssClassesConfig.l.AccentForeground},useAccentColorForProgressBar:this._playerModel.useAccentColorForProgressBar,disableClickUrl:this._playerModel.disableClickUrl,fontFamilySettings:this._playerModel.fontFamilySettings}}},{key:"_initUserInterface",value:function(){var playspaceTemplate=new PlayspaceTemplate_PlayspaceTemplate({disableStoryProgressBarRendering:this._playerModel.disableStoryProgressBarRendering,disableTitleRendering:this._playerModel.disableTitleRendering});this._userInterface=new UiPlayspace_UiPlayspace(this,this._$playerContainer,this._app.services.GlobalDomUtilsService,this._app.services.ResizeObserver,playspaceTemplate.template,this._uiSettings,this._app.config.appId,this._playerModel.playbackMode===protos.ProtoPlayerPlaybackModeEnum.ClickToPlay?ContentStatesEnum.StoppedState:ContentStatesEnum.PausedState,this._app.services.InteractionService),this._userInterface.setMediaContainerRatio(this._ratioFacade.getContentRatioContainer()),this._userInterface.show()}},{key:"_subscribeToEvents",value:function(){var _this3=this;this.subscribe(PlayspaceContentEventsEnum.SlideTransitionStart,this._slidesManager,function(_ref){var targetSlide=_ref.payload.nextSlide,availableQualities=[];targetSlide.media.type===protos.ProtoMediaTypeEnum.Video&&(availableQualities=targetSlide.media.getAvailableQualities(),_this3._userInterface.updateQuality(targetSlide.media.currentQuality)),_this3._userInterface.updateQualityMenu(availableQualities),_this3._userInterface.onSlideTransitionStart(targetSlide.slideCapabilityList),targetSlide.onSlideTransitionStart(targetSlide.slideCapabilityList)}),this.subscribe(PlayspaceContentEventsEnum.SlideTransitionEnd,this._slidesManager,function(){_this3._userInterface.onSlideTransitionEnd()}),this.subscribe(PlayspaceContentEventsEnum.SlideTimeUpdate,this._slidesManager,function(_ref2){var _ref2$payload=_ref2.payload,elapsedTime=_ref2$payload.elapsedTime,duration=_ref2$payload.duration;_this3._userInterface.onSlideTimeUpdate(elapsedTime,duration)}),this.subscribe(PlayspaceContentEventsEnum.SlideChanged,this._slidesManager,function(_ref3){var index=_ref3.payload.index;_this3._userInterface.setCurrentIndex(index),_this3._userInterface.setDuration(_this3._slidesManager.remainingTime),_this3.mediator.publish(_this3,PlayspaceExperienceApiEventsEnum.ChangeSlide)}),this.subscribe(PlayspaceContentEventsEnum.SlideCycleEnd,this._slidesManager,function(){_this3._stateManager.handleSlidesEnd()}),this.subscribe(VideoQualityEventsEnum.Change,this._slidesManager,function(_ref4){var quality=_ref4.payload,currentSlide=_this3._slidesManager.getCurrentSlide();currentSlide&&currentSlide.media.type===protos.ProtoMediaTypeEnum.Video&&_this3._userInterface.updateQuality(currentSlide.media.currentQuality),_this3.mediator.publish(_this3,VideoQualityEventsEnum.Change,{payload:quality})}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Play],this._userInterface,function(){_this3.mediator.publish(_this3,ExperienceConfig.b.UserInteraction,{payload:{playback:!0}});_this3.play(!0)}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Pause],this._userInterface,function(){_this3.mediator.publish(_this3,ExperienceConfig.b.UserInteraction,{payload:{playback:!1}});_this3.pause(!0)}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Volume],this._userInterface,function(_ref5){var volume=_ref5.payload;_this3.volume=volume,_this3.mediator.publish(_this3,ExperienceConfig.b.UserInteraction,{payload:{volume:!0}}),_this3.mediator.publish(_this3,UiComponentEventsEnum[UiComponentEventsEnum.Volume],{payload:{volume:volume}})}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Close],this._userInterface,function(){_this3.mediator.publish(_this3,ExperienceConfig.b.UserInteraction,{payload:{playback:!1}}),_this3.mediator.publish(_this3,UiComponentEventsEnum[UiComponentEventsEnum.Close])}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.LogoClicked],this._userInterface,function(){_this3.mediator.publish(_this3,UiComponentEventsEnum[UiComponentEventsEnum.LogoClicked])}),this.subscribe(UiPlayspaceEventsEnum.ProgressBarItemClicked,this._userInterface,function(_ref6){var index=_ref6.payload;_this3.mediator.publish(_this3,ExperienceConfig.b.UserInteraction,{payload:{playback:!0}}),_this3.setSlide(index),_this3.mediator.publish(_this3,UiPlayspaceEventsEnum.ProgressBarItemClicked,{payload:index})}),this.subscribe(UiPlayspaceEventsEnum.CallToAction,this._slidesManager,function(){_this3.mediator.publish(_this3,UiPlayspaceEventsEnum.CallToAction)}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Expand],this._userInterface,function(){_this3.mediator.publish(_this3,UiComponentEventsEnum[UiComponentEventsEnum.Expand])}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Collapse],this._userInterface,function(){_this3.mediator.publish(_this3,UiComponentEventsEnum[UiComponentEventsEnum.Collapse])}),this.subscribe(UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.HoldStart],this._userInterface,function(){_this3._stateManager.pauseToggle()}),this.subscribe(UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.HoldEnd],this._userInterface,function(){_this3._stateManager.pauseToggle()}),this.subscribe(UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.TapLeft],this._userInterface,function(){_this3._sendUserInteraction(),_this3.goToPrevSlide()}),this.subscribe(UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.TapRight],this._userInterface,function(){_this3._sendUserInteraction(),_this3.goToNextSlide()}),this.subscribe(UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.SwipeEnd],this._userInterface,function(_ref7){_ref7.payload===InteractionServiceEnums.d.Left?_this3._stateManager.goToNextSlide():_this3._stateManager.goToPrevSlide()}),this.subscribe(UiInteractionEventsEnum.a[UiInteractionEventsEnum.a.SwipeMove],this._userInterface,function(_ref8){var deltaX=_ref8.payload;_this3._slidesManager.offsetSlides(deltaX)}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Quality],this._userInterface,function(_ref9){var quality=_ref9.payload;_this3._slidesManager.setQuality(quality)}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Next],this._userInterface,function(){_this3._sendUserInteraction(),_this3.goToNextSlide()}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Next],this._slidesManager,function(){_this3._sendUserInteraction(),_this3.goToNextSlide()}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Prev],this._userInterface,function(){_this3._sendUserInteraction(),_this3.goToPrevSlide()}),this.relay(UiPlayspaceEventsEnum.GeneralClickInteraction,this._userInterface,this,this.mediator),this.relay(UiPlayspaceEventsEnum.GeneralClickInteraction,this._slidesManager,this,this.mediator)}},{key:"_startSlides",value:function(){var _this4=this;if(Object(TypeUtils.a)(this._playerModel.storyMetadata)){var metadata=this._playerModel.storyMetadata;this._updateWithMetadata(metadata)}else{var _this$_playerModel=this._playerModel,storyId=_this$_playerModel.storyId,activeVersion=_this$_playerModel.activeVersion,forceFallbackStory=Object(HrefUtils.b)("cnx_force_fallback",this._app.config.pageUrl);forceFallbackStory&&(storyId="00000000-0000-0000-0000-000000000002",activeVersion=forceFallbackStory);var requestUrl=this._app.services.UrlSuffixerService.appendParamsToUrl("".concat(EndPointResolver.a.endPoints.base.metadata).concat(storyId,"/").concat(activeVersion,".bin"));if(!Object(TypeUtils.h)(activeVersion))return void this._useDefaultStory();this._fetchMetadata(requestUrl).then(function(metadata){_this4._updateWithMetadata(metadata)}).catch(function(){_this4._useDefaultStory()})}}},{key:"_useDefaultStory",value:function(){var _this5=this;this._getDefaultStoryMeta().then(function(storyData){var requestUrlDefaultSlides=_this5._app.services.UrlSuffixerService.appendParamsToUrl("".concat(EndPointResolver.a.endPoints.base.metadata).concat(storyData.storyId,"/").concat(storyData.activeVersionId,".bin"));return _this5._fetchMetadata(requestUrlDefaultSlides)}).then(function(metadata){_this5._updateWithMetadata(metadata)})}},{key:"_updateWithMetadata",value:function(metadata){var _this6=this;metadata.slides=metadata.slides.map(function(slide){return Object.assign(Object.assign({},slide),{storyTitle:metadata.storyTitle,publisherName:_this6._playerModel.publisherName})}),this._slidesManager.start(metadata.slides),this._userInterface.setTotalSlides(metadata.slides.length);var startSlideIndex=this._playerModel.storyPosition&&this._playerModel.storyPosition<metadata.slides.length?this._playerModel.storyPosition:DEFAULT_SLIDE_INDEX;this._slidesManager.setCurrentSlide(startSlideIndex),this.mediator.publish(this,PlayspaceExperienceEventsEnum.ContentHandlerReady)}},{key:"_initStateManager",value:function(){var _this$_playerModel2=this._playerModel,preRollBreak=_this$_playerModel2.preRollBreak,postRollBreak=_this$_playerModel2.postRollBreak,hasPreroll=Object(TypeUtils.e)(preRollBreak),hasPostroll=Object(TypeUtils.e)(postRollBreak);this._stateManager=new PlayspaceStateManager_PlayspaceStateManager(this,this._slidesManager,this._userInterface,hasPreroll,hasPostroll,this._playerModel.endOfSlideCycleMode,null!==this._playerModel.storyPosition),this._subscribeToStateManager()}},{key:"_subscribeToStateManager",value:function(){var _this7=this;this.subscribe(PlayspaceStateManagerEvents_StateChanged,this._stateManager,function(_ref10){var state=_ref10.payload;_this7._userInterface.changeState(state);var currentSlide=_this7._slidesManager.getCurrentSlide();currentSlide&&currentSlide.changeState(state),_this7.mediator.publish(_this7,PlayspaceExperienceEventsEnum.StateChanged,{payload:state})}),this.subscribe(PlayspaceStateManagerEvents_ContentReset,this._stateManager,function(){_this7.mediator.publish(_this7,PlayspaceExperienceEventsEnum.NewStory)}),this.relay([PlayspaceExperienceEventsEnum.ContentStart,PlayspaceExperienceEventsEnum.ContentEnd],this._stateManager,this,this.mediator)}},{key:"_sendUserInteraction",value:function(){this.mediator.publish(this,ExperienceConfig.b.UserInteraction,{payload:{playback:!0}})}},{key:"setViewabilityState",value:function(inView){this._stateManager.setViewabilityState(inView)}},{key:"goToNextSlide",value:function(){this._stateManager.goToNextSlide()}},{key:"goToPrevSlide",value:function(){this._stateManager.goToPrevSlide()}},{key:"getNextSlide",value:function(){return this._slidesManager.getNextSlide()}},{key:"getCurrentThumbnailUrlParams",value:function(width,height){return this._slidesManager.getCurrentThumbnailUrlParams(width,height)}},{key:"getCurrentMetadata",value:function(){return this._slidesManager.getCurrentMetadata()}},{key:"start",value:function(){this._startSlides()}},{key:"play",value:function(userInteraction){this._stateManager.play(userInteraction)}},{key:"pause",value:function(userInteraction){this._stateManager.pause(userInteraction)}},{key:"show",value:function(){this._stateManager.show()}},{key:"hide",value:function(){this._stateManager.hide()}},{key:"enterFullscreen",value:function(){this._userInterface.expand()}},{key:"exitFullscreen",value:function(){this._userInterface.collapse()}},{key:"setSlide",value:function(slideIndex){this.play(!1),this._stateManager.setCurrentSlide(slideIndex)}},{key:"onResize",value:function(){this._slidesManager.onPlayerContainerResize(),this._userInterface.onResizeUi(this._slidesManager.remainingTime,this._slidesManager.isPlaying)}},{key:"updateCtaLabel",value:function(slideIndex,label){var capability={type:SlideCapabilityTypeEnum.CtaButton,metadata:{label:label}};this._slidesManager.updateCapabilityMetadata(slideIndex,capability),slideIndex===this._slidesManager.currentSlideIndex&&this._userInterface.updateCapabilityMetadata(capability)}},{key:"toggleExpandButton",value:function(show){show?this._userInterface.showExpandButton():this._userInterface.hideExpandButton()}},{key:"getQuality",value:function(){return this._slidesManager.getQuality()}},{key:"setQuality",value:function(height){var qualitySettings={height:height,quality:VideoQualityEnum.Strict};this._slidesManager.setQuality(qualitySettings)}},{key:"stop",value:function(){this._stateManager&&this._stateManager.stop()}},{key:"resume",value:function(){this._stateManager&&this._stateManager.resume()}},{key:"startContent",value:function(){this._stateManager.exitRollBreak()}},{key:"destroy",value:function(){this._slidesManager&&this._slidesManager.destroy(),this._userInterface&&this._userInterface.destroy()}},{key:"volume",get:function(){return this._volume},set:function(volume){this._volume=volume,this._slidesManager.setVolume(volume),this._userInterface.updateVolume(volume)}},{key:"currentSlideIndex",get:function(){return this._slidesManager.currentSlideIndex}},{key:"slides",get:function(){return this._slidesManager.slides}},{key:"slidesMetadata",get:function(){return this._slidesManager.slidesMetadata}}]),PlayspaceContentHandler}(Mediator.a),BREAK_POINTS={lg:630,md:400,sm:320,xs:0},PLAYSPACE_BREAK_POINTS=(_PLAYSPACE_BREAK_POIN={},defineProperty_default()(_PLAYSPACE_BREAK_POIN,protos.ProtoDeviceType.Desktop,Object.assign({},BREAK_POINTS)),defineProperty_default()(_PLAYSPACE_BREAK_POIN,protos.ProtoDeviceType.Tablet,Object.assign({},BREAK_POINTS)),defineProperty_default()(_PLAYSPACE_BREAK_POIN,protos.ProtoDeviceType.Smartphone,Object.assign({},BREAK_POINTS)),_PLAYSPACE_BREAK_POIN),PLAYSPACE_FLOATING_BREAKPOINT=288;!function(PlaybackHandlerEvents){PlaybackHandlerEvents[PlaybackHandlerEvents.Play=0]="Play",PlaybackHandlerEvents[PlaybackHandlerEvents.Pause=1]="Pause"}(PlaybackHandlerEvents||(PlaybackHandlerEvents={}));var FullscreenEventsEnum,PlaybackHandler_PlaybackHandler=function(){function PlaybackHandler(mediator,playbackMode){switch(classCallCheck_default()(this,PlaybackHandler),this.mediator=mediator,this.inView=!1,this._playbackDisabled=!1,this._playbackStarted=!1,this._currentStrategy=function(){},playbackMode){case protos.ProtoPlayerPlaybackModeEnum.Autoplay:this._setStrategy(this._autoplayStrategyHandler);break;case protos.ProtoPlayerPlaybackModeEnum.ClickToPlay:this._setStrategy(this._clickToPlayStrategyHandler);break;case protos.ProtoPlayerPlaybackModeEnum.ScrollToPlay:this._setStrategy(this._scrollToPlayStrategyHandler)}}return createClass_default()(PlaybackHandler,[{key:"_setStrategy",value:function(strategy){var _this=this;this._currentStrategy=function(){_this._playbackDisabled||strategy.call(_this)}}},{key:"_autoplayStrategyHandler",value:function(){!this._playbackStarted&&this.inView&&(this._playbackStarted=!0,this.mediator.publish(this,PlaybackHandlerEvents[PlaybackHandlerEvents.Play]))}},{key:"_scrollToPlayStrategyHandler",value:function(){this.inView?this.mediator.publish(this,PlaybackHandlerEvents[PlaybackHandlerEvents.Play]):this.mediator.publish(this,PlaybackHandlerEvents[PlaybackHandlerEvents.Pause])}},{key:"_clickToPlayStrategyHandler",value:function(){}},{key:"setViewability",value:function(viewability){this.inView=viewability,this._currentStrategy()}},{key:"setUserPlayback",value:function(userPlayback){!this._playbackStarted&&userPlayback&&(this._playbackStarted=userPlayback),this._playbackDisabled=!userPlayback}}]),PlaybackHandler}();!function(FullscreenEventsEnum){FullscreenEventsEnum.enter="enterFullscreen",FullscreenEventsEnum.exit="exitFullscreen"}(FullscreenEventsEnum||(FullscreenEventsEnum={}));var _VIDEO_BREAK_POINTS,_PORTRAIT_VISUAL_GALL,_LANDSCAPE_VISUAL_GAL,_PORTRAIT_DETAILED_GA,_LANDSCAPE_DETAILED_G,_ProtoGalleryOrientat,_ProtoGalleryOrientat2,_GALLERY_BREAK_POINTS,OrientationHandlerEventsEnum,FullScreen_FullScreen=function(){function FullScreen(mediator,_globalDomUtilsService,element,_os){var _this=this;if(classCallCheck_default()(this,FullScreen),this.mediator=mediator,this._globalDomUtilsService=_globalDomUtilsService,this._os=_os,this._requestFullscreenCalled=!1,this._fallbackTimeoutLength=1e3,this._isFullscreenSupported=!0,this._isFullscreen=!1,this._iosEnterFullscreen=function(){_this._requestFullscreenCalled&&_this._successHandler()},this._changeHandler=function(event){_this._requestFullscreenCalled?null!==_this.fullscreenElement?_this._successHandler():_this._errorHandler():_this.mediator.publish(_this,FullscreenEventsEnum.exit)},this._errorHandler=function(){_this._isFullscreen=!1,_this._requestFullscreenDeferred.reject(),_this._requestFullscreenCalled=!1,clearTimeout(_this._fallbackTimeoutId)},this._element=_os&&_os===OsConfig.b.Ios?element.getElementsByTagName("video")[0]:element,!this._element)throw new Error("element is missing");try{var currentFullScreenKeys=this._getFullscreenKeys();if(null==currentFullScreenKeys)return void(this._isFullscreenSupported=!1);this._fullscreenKeys=currentFullScreenKeys.keys,this._vendor=currentFullScreenKeys.name,this._bindEvents()}catch(e){this._isFullscreenSupported=!1,Object(Logging.a)({message:"Fullscreen init failed",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.FATAL})}}return createClass_default()(FullScreen,[{key:"_getFullscreenKeys",value:function(){return this._os===OsConfig.b.Ios?this._globalDomUtilsService.getFullscreenKeys(this._element):this._globalDomUtilsService.getFullscreenKeys()}},{key:"enterFullScreen",value:function(){if(this._isFullscreenSupported){this._requestFullscreenDeferred=new DeferredPromise.a,this._requestFullscreenCalled=!0,clearTimeout(this._fallbackTimeoutId),this._fallbackTimeoutId=setTimeout(this._errorHandler,this._fallbackTimeoutLength);try{this._element[this._fullscreenKeys.requestFullscreen]()}catch(e){this._errorHandler()}return this._requestFullscreenDeferred.promise}}},{key:"exitFullScreen",value:function(){try{this._globalDomUtilsService.exitFullscreen(this._fullscreenKeys.exitFullscreen,this._os===OsConfig.b.Ios?this._element:void 0)}catch(e){Object(Logging.a)({message:"fullscreen_exit",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.WARNING})}this._isFullscreen=!1}},{key:"_bindEvents",value:function(){this._vendor===BrowserConfig.d.Moz||this._vendor===BrowserConfig.d.Ms?(this._globalDomUtilsService.addEventListenerOnGlobal(this._fullscreenKeys.fullscreenchange,this._changeHandler),this._globalDomUtilsService.addEventListenerOnGlobal(this._fullscreenKeys.fullscreenerror,this._errorHandler)):(this._element.addEventListener(this._fullscreenKeys.fullscreenchange,this._changeHandler),this._element.addEventListener(this._fullscreenKeys.fullscreenerror,this._errorHandler)),this._os===OsConfig.b.Ios&&(this._element.addEventListener("webkitbeginfullscreen",this._iosEnterFullscreen),this._element.addEventListener("webkitendfullscreen",this._changeHandler))}},{key:"_removeEvents",value:function(){this._vendor===BrowserConfig.d.Moz||this._vendor===BrowserConfig.d.Ms?(this._globalDomUtilsService.removeEventListenerOnGlobal(this._fullscreenKeys.fullscreenchange,this._changeHandler),this._globalDomUtilsService.removeEventListenerOnGlobal(this._fullscreenKeys.fullscreenerror,this._errorHandler)):(this._element.removeEventListener(this._fullscreenKeys.fullscreenchange,this._changeHandler),this._element.removeEventListener(this._fullscreenKeys.fullscreenerror,this._errorHandler)),this._os===OsConfig.b.Ios&&(this._element.removeEventListener("webkitbeginfullscreen",this._iosEnterFullscreen),this._element.removeEventListener("webkitendfullscreen",this._changeHandler))}},{key:"_successHandler",value:function(){this._isFullscreen=!0,this.mediator.publish(this,FullscreenEventsEnum.enter),this._requestFullscreenDeferred.resolve(),this._requestFullscreenCalled=!1,clearTimeout(this._fallbackTimeoutId)}},{key:"destroy",value:function(){this.isFullscreen&&this.exitFullScreen(),this._removeEvents(),this._requestFullscreenDeferred&&this._requestFullscreenDeferred.isPending&&this._requestFullscreenDeferred.reject()}},{key:"fullscreenElement",get:function(){return this._globalDomUtilsService.getDocumentProperty(this._fullscreenKeys.fullscreenElement)}},{key:"fullscreenEnabled",get:function(){return this._globalDomUtilsService.getDocumentProperty(this._fullscreenKeys.fullscreenEnabled)}},{key:"isFullscreen",get:function(){return this._isFullscreen}}]),FullScreen}(),VIDEO_MOBILE_BREAK_POINTS={xl:720,lg:320,md:204,sm:142,xs:0},VIDEO_BREAK_POINTS=(_VIDEO_BREAK_POINTS={},defineProperty_default()(_VIDEO_BREAK_POINTS,protos.ProtoDeviceType.Desktop,{xl:468,lg:388,md:248,sm:142,xs:0}),defineProperty_default()(_VIDEO_BREAK_POINTS,protos.ProtoDeviceType.Tablet,Object.assign({},VIDEO_MOBILE_BREAK_POINTS)),defineProperty_default()(_VIDEO_BREAK_POINTS,protos.ProtoDeviceType.Smartphone,Object.assign({},VIDEO_MOBILE_BREAK_POINTS)),_VIDEO_BREAK_POINTS),PORTRAIT_VISUAL_GALLERY_MOBILE_BREAK_POINTS={xl:720,lg:320,md:204,sm:142,xs:0},PORTRAIT_VISUAL_GALLERY_BREAK_POINTS=(_PORTRAIT_VISUAL_GALL={},defineProperty_default()(_PORTRAIT_VISUAL_GALL,protos.ProtoDeviceType.Desktop,{xl:468,lg:388,md:248,sm:142,xs:0}),defineProperty_default()(_PORTRAIT_VISUAL_GALL,protos.ProtoDeviceType.Tablet,Object.assign({},PORTRAIT_VISUAL_GALLERY_MOBILE_BREAK_POINTS)),defineProperty_default()(_PORTRAIT_VISUAL_GALL,protos.ProtoDeviceType.Smartphone,Object.assign({},PORTRAIT_VISUAL_GALLERY_MOBILE_BREAK_POINTS)),_PORTRAIT_VISUAL_GALL),LANDSCAPE_VISUAL_GALLERY_WIDTH_xl=176,LANDSCAPE_VISUAL_GALLERY_WIDTH_lg=160,LANDSCAPE_VISUAL_GALLERY_WIDTH_md=144,LANDSCAPE_VISUAL_GALLERY_WIDTH_sm=112,LANDSCAPE_VISUAL_GALLERY_MOBILE_BREAK_POINTS={xl:PORTRAIT_VISUAL_GALLERY_MOBILE_BREAK_POINTS.xl+LANDSCAPE_VISUAL_GALLERY_WIDTH_xl,lg:PORTRAIT_VISUAL_GALLERY_MOBILE_BREAK_POINTS.lg+LANDSCAPE_VISUAL_GALLERY_WIDTH_lg,md:PORTRAIT_VISUAL_GALLERY_MOBILE_BREAK_POINTS.md+LANDSCAPE_VISUAL_GALLERY_WIDTH_md,sm:PORTRAIT_VISUAL_GALLERY_MOBILE_BREAK_POINTS.sm+LANDSCAPE_VISUAL_GALLERY_WIDTH_sm},LANDSCAPE_VISUAL_GALLERY_BREAK_POINTS=(_LANDSCAPE_VISUAL_GAL={},defineProperty_default()(_LANDSCAPE_VISUAL_GAL,protos.ProtoDeviceType.Desktop,{xl:468+LANDSCAPE_VISUAL_GALLERY_WIDTH_xl,lg:388+LANDSCAPE_VISUAL_GALLERY_WIDTH_lg,md:248+LANDSCAPE_VISUAL_GALLERY_WIDTH_md,sm:142+LANDSCAPE_VISUAL_GALLERY_WIDTH_sm,xs:0}),defineProperty_default()(_LANDSCAPE_VISUAL_GAL,protos.ProtoDeviceType.Tablet,Object.assign({},LANDSCAPE_VISUAL_GALLERY_MOBILE_BREAK_POINTS)),defineProperty_default()(_LANDSCAPE_VISUAL_GAL,protos.ProtoDeviceType.Smartphone,Object.assign({},LANDSCAPE_VISUAL_GALLERY_MOBILE_BREAK_POINTS)),_LANDSCAPE_VISUAL_GAL),PORTRAIT_DETAILED_GALLERY_MOBILE_BREAK_POINTS={lg:320,md:204,sm:0},PORTRAIT_DETAILED_GALLERY_BREAK_POINTS=(_PORTRAIT_DETAILED_GA={},defineProperty_default()(_PORTRAIT_DETAILED_GA,protos.ProtoDeviceType.Desktop,{xl:468,lg:388,md:248,sm:0}),defineProperty_default()(_PORTRAIT_DETAILED_GA,protos.ProtoDeviceType.Tablet,Object.assign({},PORTRAIT_DETAILED_GALLERY_MOBILE_BREAK_POINTS)),defineProperty_default()(_PORTRAIT_DETAILED_GA,protos.ProtoDeviceType.Smartphone,Object.assign({},PORTRAIT_DETAILED_GALLERY_MOBILE_BREAK_POINTS)),_PORTRAIT_DETAILED_GA),LANDSCAPE_DETAILED_GALLERY_MOBILE_BREAK_POINTS={xxl:1080,xl:0},LANDSCAPE_DETAILED_GALLERY_BREAK_POINTS=(_LANDSCAPE_DETAILED_G={},defineProperty_default()(_LANDSCAPE_DETAILED_G,protos.ProtoDeviceType.Desktop,{xxl:720,xl:0}),defineProperty_default()(_LANDSCAPE_DETAILED_G,protos.ProtoDeviceType.Tablet,Object.assign({},LANDSCAPE_DETAILED_GALLERY_MOBILE_BREAK_POINTS)),defineProperty_default()(_LANDSCAPE_DETAILED_G,protos.ProtoDeviceType.Smartphone,Object.assign({},LANDSCAPE_DETAILED_GALLERY_MOBILE_BREAK_POINTS)),_LANDSCAPE_DETAILED_G),PlayspaceConfigEvents=(_GALLERY_BREAK_POINTS={},defineProperty_default()(_GALLERY_BREAK_POINTS,Generated_protos.ProtoGalleryOrientationEnum.Landscape,(_ProtoGalleryOrientat={},defineProperty_default()(_ProtoGalleryOrientat,Generated_protos.ProtoGalleryStyleMode.Detailed,LANDSCAPE_DETAILED_GALLERY_BREAK_POINTS),defineProperty_default()(_ProtoGalleryOrientat,Generated_protos.ProtoGalleryStyleMode.Visual,LANDSCAPE_VISUAL_GALLERY_BREAK_POINTS),_ProtoGalleryOrientat)),defineProperty_default()(_GALLERY_BREAK_POINTS,Generated_protos.ProtoGalleryOrientationEnum.Portrait,(_ProtoGalleryOrientat2={},defineProperty_default()(_ProtoGalleryOrientat2,Generated_protos.ProtoGalleryStyleMode.Detailed,PORTRAIT_DETAILED_GALLERY_BREAK_POINTS),defineProperty_default()(_ProtoGalleryOrientat2,Generated_protos.ProtoGalleryStyleMode.Visual,PORTRAIT_VISUAL_GALLERY_BREAK_POINTS),_ProtoGalleryOrientat2)),Object.assign(Object.assign({},ApiConfig.b),PlayspaceApiEventsEnum));!function(OrientationHandlerEventsEnum){OrientationHandlerEventsEnum[OrientationHandlerEventsEnum.PlayerOrientationChange=0]="PlayerOrientationChange",OrientationHandlerEventsEnum[OrientationHandlerEventsEnum.MainOrientationChange=1]="MainOrientationChange"}(OrientationHandlerEventsEnum||(OrientationHandlerEventsEnum={}));var OrientationHandler_OrientationHandler=function(){function OrientationHandler(mediator,_settings,_getOrientationClass,_globalDomUtils){classCallCheck_default()(this,OrientationHandler),this.mediator=mediator,this._settings=_settings,this._getOrientationClass=_getOrientationClass,this._globalDomUtils=_globalDomUtils,this._playerContainerOrientation={current:null,previous:null},this._mainContainerOrientation={current:null,previous:null},this._forcedOrientation=!1}return createClass_default()(OrientationHandler,[{key:"setFloatingModule",value:function(floatingModule){this._floatingModule=floatingModule}},{key:"start",value:function(playerContainer){this._playerContainer=playerContainer,this._computePlayerOrientation(this._settings.orientation),this._computeMainOrientation(this._settings.orientation)}},{key:"forceOrientation",value:function(orientation){this._forcedOrientation=!1,this.setMainOrientation(orientation),this.setPlayerClassByOrientation(orientation),this._forcedOrientation=!0}},{key:"setPlayerClassByOrientation",value:function(){var orientation=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._settings.orientation;this._computePlayerOrientation(orientation),this._playerContainerOrientation.previous&&this._playerContainerOrientation.current===this._playerContainerOrientation.previous||(this._setOrientationClass(this._getOrientationClass),this._playerContainerOrientation.previous=this._playerContainerOrientation.current,this.mediator.publish(this,OrientationHandlerEventsEnum[OrientationHandlerEventsEnum.PlayerOrientationChange],{payload:this._playerContainerOrientation.current}))}},{key:"setMainOrientation",value:function(){var orientation=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._settings.orientation;this._computeMainOrientation(orientation),this._mainContainerOrientation.previous&&this._mainContainerOrientation.previous===this._mainContainerOrientation.current||(this._mainContainerOrientation.previous=this._mainContainerOrientation.current,this.mediator.publish(this,OrientationHandlerEventsEnum[OrientationHandlerEventsEnum.MainOrientationChange],{payload:this._mainContainerOrientation.current}))}},{key:"shouldChangeMainOrientation",value:function(){return!this._isInFloating()}},{key:"_computePlayerOrientation",value:function(orientation){this._playerContainerOrientation.current=this._getPlayerOrientation(orientation)}},{key:"_computeMainOrientation",value:function(orientation){this._mainContainerOrientation.current=this._getMainOrientation(orientation)}},{key:"_getPlayerOrientation",value:function(orientation){if(this._isInFloating())return ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Landscape;if(this._forcedOrientation)return this._mainContainerOrientation.current;switch(orientation){case ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Mixed:return this._getMixedTypePlayerOrientation();default:return orientation}}},{key:"_getMainOrientation",value:function(orientation){if(this._forcedOrientation)return this._mainContainerOrientation.current;switch(orientation){case ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Mixed:return this._getMixedTypePlayerOrientation();default:return orientation}}},{key:"_isInFloating",value:function(){return this._floatingModule&&this._floatingModule.isInFloating}},{key:"_getMixedTypePlayerOrientation",value:function(){return this._globalDomUtils.getViewportWidth()<this._settings.orientationBreakpoint?ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Portrait:ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Landscape}},{key:"_setOrientationClass",value:function(getOrientationClass){this._playerContainerOrientation.previous?Object(DomUtils.O)(this._playerContainer,getOrientationClass(this._playerContainerOrientation.previous),getOrientationClass(this._playerContainerOrientation.current)):Object(DomUtils.a)(this._playerContainer,getOrientationClass(this._playerContainerOrientation.current))}},{key:"playerOrientation",get:function(){return this._playerContainerOrientation.current}},{key:"mainOrientation",get:function(){return this._mainContainerOrientation.current}}]),OrientationHandler}(),RatioContainerHandler_RatioContainerHandler=function(){function RatioContainerHandler(_globalDomUtilsService){classCallCheck_default()(this,RatioContainerHandler),this._globalDomUtilsService=_globalDomUtilsService,this._$containerList=[]}return createClass_default()(RatioContainerHandler,[{key:"createRatioContainer",value:function(ratio){var newRatioContainer=this._getContainer();return this._$containerList.push(newRatioContainer),this.setRatio(ratio),newRatioContainer}},{key:"setRatio",value:function(ratio){this._ratio=ratio,this._applyRatio()}},{key:"_getContainer",value:function(){return this._globalDomUtilsService.createElementByString("<cnx class='".concat(CssClassesConfig.c,"'></cnx>"))}},{key:"_applyRatio",value:function(){var _this=this;this._$containerList.forEach(function($container){Object(DomUtils.Q)($container,{"padding-bottom":"".concat(_this._ratio,"%")})})}}]),RatioContainerHandler}(),PlayspaceRatioHandler_PlayspaceRatioHandler=function(){function PlayspaceRatioHandler(landscapeRatio,portraitRatio){classCallCheck_default()(this,PlayspaceRatioHandler),this._contentPortraitRatio={width:1,height:1},this._landscapeRatio=landscapeRatio,this._portraitRatio=portraitRatio}return createClass_default()(PlayspaceRatioHandler,[{key:"start",value:function(wrapperContainer){this._initWrapperContainer(wrapperContainer)}},{key:"getComputedPlayspaceRatio",value:function(orientation){return this._getPlayspaceHeight(orientation)/this._getPlayspaceWidth(orientation)*100}},{key:"getComputedContentRatio",value:function(orientation){return this._getContentHeight(orientation)/this._getContentWidth(orientation)*100}},{key:"_initWrapperContainer",value:function(wrapperContainer){this._wrapperContainer=wrapperContainer}},{key:"_getPlayspaceWidth",value:function(orientation){if(orientation===ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Landscape){if(!this._wrapperContainer.clientWidth)return this._landscapeRatio.width;var greatestCommonDivisor=this._getLandscapeDimensionsGreatestCommonDivisor();return this._wrapperContainer.clientWidth/greatestCommonDivisor}return this._portraitRatio.width}},{key:"_getPlayspaceHeight",value:function(orientation){return orientation===ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Landscape?this._wrapperContainer.clientWidth?this._getLandscapeHeightInPixels()/this._getLandscapeDimensionsGreatestCommonDivisor():this._landscapeRatio.height:this._portraitRatio.height}},{key:"_getLandscapeHeightInPixels",value:function(){return this._landscapeRatio.height/this._landscapeRatio.width*this._wrapperContainer.clientWidth+LANDSCAPE_BOTTOM_HEIGHT}},{key:"_getLandscapeDimensionsGreatestCommonDivisor",value:function(){var wrapperHeightInPixels=this._getLandscapeHeightInPixels();return Object(NumberUtils.d)(this._wrapperContainer.clientWidth,wrapperHeightInPixels)}},{key:"_getContentWidth",value:function(orientation){return orientation===ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Landscape?this._landscapeRatio.width:this._contentPortraitRatio.width}},{key:"_getContentHeight",value:function(orientation){return orientation===ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Landscape?this._landscapeRatio.height:this._contentPortraitRatio.height}}]),PlayspaceRatioHandler}();function PlayspaceRatioManager_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var PlayspaceRatioManager_PlayspaceRatioManager=function(_Mediator){inherits_default()(PlayspaceRatioManager,_Mediator);var _super=PlayspaceRatioManager_createSuper(PlayspaceRatioManager);function PlayspaceRatioManager(mediator,_settings,landscapeRatio,portraitRatio,_globalDomUtilsService){var _this;return classCallCheck_default()(this,PlayspaceRatioManager),(_this=_super.call(this)).mediator=mediator,_this._settings=_settings,_this._globalDomUtilsService=_globalDomUtilsService,_this._initOrientationHandler(),_this._ratioHandler=new PlayspaceRatioHandler_PlayspaceRatioHandler(landscapeRatio,portraitRatio),_this._playspaceRatioContainerHandler=new RatioContainerHandler_RatioContainerHandler(_globalDomUtilsService),_this._contentRatioContainerHandler=new RatioContainerHandler_RatioContainerHandler(_globalDomUtilsService),_this}return createClass_default()(PlayspaceRatioManager,[{key:"setFloatingModule",value:function(floatingModule){this._orientationHandler.setFloatingModule(floatingModule),this.setRatio()}},{key:"start",value:function($playerContainer,$playerWrapper){this._orientationHandler.start($playerContainer),this._ratioHandler.start($playerWrapper)}},{key:"getPlayspaceRatioContainer",value:function(){return this._playspaceRatioContainerHandler.createRatioContainer(this._getPlayspaceRatio())}},{key:"getContentRatioContainer",value:function(){return this._contentRatioContainerHandler.createRatioContainer(this._getContentRatio())}},{key:"setRatio",value:function(){var syncPlayerAndContent=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._orientationHandler.setPlayerClassByOrientation(),(syncPlayerAndContent||this._orientationHandler.shouldChangeMainOrientation())&&(this._orientationHandler.setMainOrientation(),this._playspaceRatioContainerHandler.setRatio(this._getPlayspaceRatio())),this._contentRatioContainerHandler.setRatio(this._getContentRatio())}},{key:"getOrientation",value:function(){return this._orientationHandler.playerOrientation}},{key:"setOrientation",value:function(orientation){this._orientationHandler.forceOrientation(orientation),this._playspaceRatioContainerHandler.setRatio(this._getPlayspaceRatio()),this._contentRatioContainerHandler.setRatio(this._getContentRatio())}},{key:"_initOrientationHandler",value:function(){var _this2=this;this._orientationHandler=new OrientationHandler_OrientationHandler(this,this._settings,this._getOrientationClass,this._globalDomUtilsService),this.subscribe(OrientationHandlerEventsEnum[OrientationHandlerEventsEnum.PlayerOrientationChange],this._orientationHandler,function(_ref){var orientation=_ref.payload;_this2.mediator.publish(_this2,OrientationHandlerEventsEnum[OrientationHandlerEventsEnum.PlayerOrientationChange],{payload:orientation})}),this.subscribe(OrientationHandlerEventsEnum[OrientationHandlerEventsEnum.MainOrientationChange],this._orientationHandler,function(_ref2){var orientation=_ref2.payload;_this2.mediator.publish(_this2,OrientationHandlerEventsEnum[OrientationHandlerEventsEnum.MainOrientationChange],{payload:orientation})})}},{key:"_getPlayspaceRatio",value:function(){var orientation=this._orientationHandler.mainOrientation;return this._ratioHandler.getComputedPlayspaceRatio(orientation)}},{key:"_getContentRatio",value:function(){var orientation=this._orientationHandler.playerOrientation;return this._ratioHandler.getComputedContentRatio(orientation)}},{key:"_getOrientationClass",value:function(playerOrientation){return playerOrientation===ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Portrait?CssClassFlagsPlayspaceEnum_OrientationPortrait:CssClassFlagsPlayspaceEnum_OrientationLandscape}}]),PlayspaceRatioManager}(Mediator.a),ApiConfigEnums={PlaybackModeEnum:{AutoPlay:protos.ProtoPlayerPlaybackModeEnum.Autoplay,ScrollToPlay:protos.ProtoPlayerPlaybackModeEnum.ScrollToPlay,ClickToPlay:protos.ProtoPlayerPlaybackModeEnum.ClickToPlay},DefaultSoundModeEnum:{On:protos.ProtoPlayerSoundMode.On,Off:protos.ProtoPlayerSoundMode.Mute,OnHover:protos.ProtoPlayerSoundMode.Hover},InsertPositionEnum:{WithinContainer:protos.ProtoPlayerInsertMode.WithinContainer,BeforeContainer:protos.ProtoPlayerInsertMode.BeforeContainer,AfterContainer:protos.ProtoPlayerInsertMode.AfterContainer,ReplaceContainer:protos.ProtoPlayerInsertMode.ReplaceContainer,HideContainer:protos.ProtoPlayerInsertMode.HideContainer},CloseButtonModeEnum:{Off:protos.ProtoPlayerCloseButtonMode.Off,On:protos.ProtoPlayerCloseButtonMode.OnHover,OnAfterFirstAd:protos.ProtoPlayerCloseButtonMode.OnHoverAfterFirstAd,OnHover:protos.ProtoPlayerCloseButtonMode.OnHover,OnHoverAfterFirstAd:protos.ProtoPlayerCloseButtonMode.OnHoverAfterFirstAd,AlwaysOn:protos.ProtoPlayerCloseButtonMode.AlwaysOn},QualityEnum:ExternalQualityEnum,LineItemExcludedSlotsEnum:{PreRoll:protos.ProtoAdSlotsEnum.PreRoll,MidRoll:protos.ProtoAdSlotsEnum.MidRoll,PostRoll:protos.ProtoAdSlotsEnum.PostRoll},ErrorTypesEnum:{SetupError:ApiConfig.a.SetupError,NoPlayer:ApiConfig.a.NoPlayer},FloatingModeEnum:{Off:protos.ProtoPlayerFloatingMode.Off,OnPageLoad:protos.ProtoPlayerFloatingMode.OnPageLoad,AfterInView:protos.ProtoPlayerFloatingMode.AfterInView,Always:protos.ProtoPlayerFloatingMode.Always},FloatingDevicesEnum:{Desktop:protos.ProtoDeviceType.Desktop,Smartphone:protos.ProtoDeviceType.Smartphone,Tablet:protos.ProtoDeviceType.Tablet,Other:protos.ProtoDeviceType.GameConsole},FloatingFixedPositionModeEnum:{Page:protos.ProtoFloatingFixedPositionMode.Page,Element:protos.ProtoFloatingFixedPositionMode.Element},FloatingScrollPositionEnum:{BottomRight:protos.ProtoPositionMode.BottomRight,BottomLeft:protos.ProtoPositionMode.BottomLeft,TopRight:protos.ProtoPositionMode.TopRight,TopLeft:protos.ProtoPositionMode.TopLeft},FloatingStatesEnum:{Float:FloatingStatesEnum.Float,Embed:FloatingStatesEnum.Embed},ImplementationTypeEnum:{Amp:protos.ProtoImplementationType.Amp,Web:protos.ProtoImplementationType.Web}},PlayspaceConfigEnum=Object.assign(Object.assign({},ApiConfigEnums),{EndOfSlideCycleEnum:{Loop:ProtoModels_Generated_protos.ProtoEndOfSlideCycleMode.Loop,Stop:ProtoModels_Generated_protos.ProtoEndOfSlideCycleMode.Stop},LayoutEnum:{Portrait:Config_PlayspaceLayoutEnum.Portrait,Landscape:Config_PlayspaceLayoutEnum.Landscape},OrientationEnum:{Mixed:ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Mixed,Portrait:ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Portrait,Landscape:ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Landscape}});function PlayspaceAdsController_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var PlayspaceAdsController_PlayspaceAdsController=function(_AdsController){inherits_default()(PlayspaceAdsController,_AdsController);var _super=PlayspaceAdsController_createSuper(PlayspaceAdsController);function PlayspaceAdsController(mediator,currentPlayerViewability,controlData,app){var _this;return classCallCheck_default()(this,PlayspaceAdsController),(_this=_super.call(this,mediator,currentPlayerViewability,controlData,app)).mediator=mediator,_this.controlData=controlData,_this._slideCounterBetween=0,_this._slideCounterTotal=0,_this.onStop(),_this._disableReasons.slides=!1,_this._checkSlidesDisableReason(),_this}return createClass_default()(PlayspaceAdsController,[{key:"_checkDisableMinSlidesBeforeFirstAd",value:function(){this.controlData.minSlidesBeforeFirstAd&&this._slideCounterTotal<=this.controlData.minSlidesBeforeFirstAd&&(this._disableReasons.slides=!0)}},{key:"_checkDisableSlidesBetweenAds",value:function(){this.controlData.slidesBetweenAds&&this._slideCounterBetween<=this.controlData.slidesBetweenAds&&(this._disableReasons.slides=!0)}},{key:"_checkSlidesDisableReason",value:function(){this._disableReasons.slides=!1,this.firstAdBreakStarted?this._checkDisableSlidesBetweenAds():this._checkDisableMinSlidesBeforeFirstAd(),this.toggleEnableAds()}},{key:"canEnableAds",value:function(){var canEnableAdsForGeneralRestrictions=get_default()(getPrototypeOf_default()(PlayspaceAdsController.prototype),"canEnableAds",this).call(this);return canEnableAdsForGeneralRestrictions.enableAds&&this.currentPlayerAdSlot===protos.ProtoAdSlotsEnum.MidRoll&&this._disableReasons.slides&&this._inView?{enableAds:!1,disableReason:DisableAdsReasonEnum.TimeoutBetweenAds}:canEnableAdsForGeneralRestrictions}},{key:"contentPlaybackStateChanged",value:function(playback){}},{key:"slideChanged",value:function(){this._slideCounterBetween++,this._slideCounterTotal++,this._checkSlidesDisableReason()}},{key:"onAdImpression",value:function(data){this._slideCounterBetween=0,get_default()(getPrototypeOf_default()(PlayspaceAdsController.prototype),"onAdImpression",this).call(this,data)}},{key:"onAdFinished",value:function(inImpression){var inPod=arguments.length>1&&void 0!==arguments[1]&&arguments[1];inPod||this._checkSlidesDisableReason(),get_default()(getPrototypeOf_default()(PlayspaceAdsController.prototype),"onAdFinished",this).call(this,inImpression,inPod)}},{key:"contentChanged",value:function(){this._checkSlidesDisableReason(),get_default()(getPrototypeOf_default()(PlayspaceAdsController.prototype),"contentChanged",this).call(this)}}]),PlayspaceAdsController}(AdsController_AdsController),DEFAULT_ROLL_EXTEND_TIME=1200,AdRollBreakController_AdRollBreakController=function(){function AdRollBreakController(_contentHandler,_adHandler,_preRollBreak,_postRollBreak){var _this=this,_adBreakExtendingTime=arguments.length>4&&void 0!==arguments[4]?arguments[4]:DEFAULT_ROLL_EXTEND_TIME;classCallCheck_default()(this,AdRollBreakController),this._contentHandler=_contentHandler,this._adHandler=_adHandler,this._preRollBreak=_preRollBreak,this._postRollBreak=_postRollBreak,this._adBreakExtendingTime=_adBreakExtendingTime,this._rollTimeoutId=null,this._adBreakExended=!1,this._endAdBreak=function(){if(_this._clearTimeout(),!_this._adBreakExended&&_this._adHandler&&_this._adHandler.adInWin)return _this._adBreakExended=!0,void _this._startRoll(_this._adBreakExtendingTime);_this._contentHandler.startContent()}}return createClass_default()(AdRollBreakController,[{key:"destroy",value:function(){this._clearTimeout()}},{key:"changeState",value:function(state){switch(state){case ContentStatesEnum.PrerollState:this._adBreakExended=!1,this._startRoll(this._preRollBreak);break;case ContentStatesEnum.PostrollState:this._adBreakExended=!1,this._startRoll(this._postRollBreak);break;default:this._rollTimeoutId&&this._clearTimeout()}}},{key:"_clearTimeout",value:function(){clearTimeout(this._rollTimeoutId),this._rollTimeoutId=null}},{key:"_startRoll",value:function(duration){this._clearTimeout(),this._rollTimeoutId=setTimeout(this._endAdBreak,duration)}}]),AdRollBreakController}();function PlayspaceExperience_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var PlayspaceExperience_PlayspaceExperience=function(_BaseExperience){inherits_default()(PlayspaceExperience,_BaseExperience);var _super=PlayspaceExperience_createSuper(PlayspaceExperience);function PlayspaceExperience(){var _this;return classCallCheck_default()(this,PlayspaceExperience),(_this=_super.apply(this,arguments))._breakpointsConfig=PLAYSPACE_BREAK_POINTS,_this._breakpointsClasses=CssClassesConfig.p,_this._floatingBreakpoint=PLAYSPACE_FLOATING_BREAKPOINT,_this._landscapeRatio={width:16,height:9},_this._portraitRatio={width:4,height:5},_this.events=Object.assign({},PlayspaceConfigEvents),_this._onContentHandlerReady=function(){_this._setNewMediaTracking(),_this._initPlaybackLogic(),_this._playerModel.adPlaybackMode===ProtoModels_Generated_protos.ProtoAdPlaybackMode.Autoplay&&_this._playerModel.playbackMode!==ProtoModels_Generated_protos.ProtoPlayerPlaybackModeEnum.ClickToPlay&&0===_this._playerModel.preRollBreak&&_this._changeAdState(ProtoModels_Generated_protos.ProtoAdSlotsEnum.MidRoll),_this.mediator.publish(assertThisInitialized_default()(_this),PlayspaceConfigEvents.Ready)},_this._enterFullScreen=function(){_this._fullScreenModule.enterFullScreen().then(function(){_this._enterFullScreenCallback()}).catch(function(){Object(Logging.a)({message:"PlayspaceExperience_enterFullscreen",level:protos.ProtoLoggingLevelEnum.WARNING})})},_this._onFullscreenExit=function(){_this._contentHandler.exitFullscreen(),_this.floatingModule&&_this.floatingModule.fullscreenStateChange(!1),_this.mediator.publish(assertThisInitialized_default()(_this),PlayspaceConfigEvents.FullscreenChanged,{payload:!1}),get_default()(getPrototypeOf_default()(PlayspaceExperience.prototype),"_onFullscreenExit",assertThisInitialized_default()(_this)).call(assertThisInitialized_default()(_this))},_this._onFullscreenEnter=function(){_this.mediator.publish(assertThisInitialized_default()(_this),PlayspaceConfigEvents.FullscreenChanged,{payload:!0}),get_default()(getPrototypeOf_default()(PlayspaceExperience.prototype),"_onFullscreenEnter",assertThisInitialized_default()(_this)).call(assertThisInitialized_default()(_this))},_this}return createClass_default()(PlayspaceExperience,[{key:"_initRatioFacade",value:function(){var _this2=this,orientationSettings={orientation:this._playerModel.orientation,orientationBreakpoint:this._playerModel.orientationBreakpoint};this._ratioManager=new PlayspaceRatioManager_PlayspaceRatioManager(this,orientationSettings,this._landscapeRatio,this._portraitRatio,this.app.services.GlobalDomUtilsService),this.subscribe(OrientationHandlerEventsEnum[OrientationHandlerEventsEnum.PlayerOrientationChange],this._ratioManager,function(_ref){var orientation=_ref.payload;_this2.mediator.publish(_this2,PlayspaceConfigEvents.LayoutChanged,{payload:PlayspaceConfigEnum.LayoutEnum[ProtoModels_Generated_protos.ProtoPlayerOrientationEnum[orientation]]})}),this.subscribe(OrientationHandlerEventsEnum[OrientationHandlerEventsEnum.MainOrientationChange],this._ratioManager,function(_ref2){switch(_ref2.payload){case ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Landscape:Object(DomUtils.N)(_this2.$experienceContainer,"maxWidth");break;case ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Portrait:Object(DomUtils.Q)(_this2.$experienceContainer,{maxWidth:"".concat(PLAYSPACE_BREAK_POINTS[_this2.app.config.device].lg-1,"px")})}})}},{key:"_setFloatingForRatioFacade",value:function(floatingModule){this._ratioManager.setFloatingModule(floatingModule)}},{key:"generateHTML",value:function(){this.$playerWrapper=this.app.services.GlobalDomUtilsService.createElementByString('<cnx class="'.concat(CssClassesConfig.b.PlayerWrapper,'"></cnx>')),this.$playerContainer=this.app.services.GlobalDomUtilsService.createElementByString('<cnx class="'.concat(CSSClassMainPlayspaceEnum.Container,'"></cnx>')),this._ratioManager.start(this.$playerContainer,this.$playerWrapper),this.addPlayerSize(),this.$experienceContainer.appendChild(this.$playerWrapper),this.$playerWrapper.appendChild(this.$playerContainer),this._ratioManager.setRatio(),this._initThumbnail()}},{key:"_initThumbnail",value:function(){this._$thumbnailWrapper=this.app.services.GlobalDomUtilsService.createElementByString('<cnx class="'.concat(CSSClassMainPlayspaceEnum.ImageWrapper," ").concat(CSSClassMainPlayspaceEnum.ImageBackground,'"></cnx>')),this.$playerWrapper.appendChild(this._$thumbnailWrapper)}},{key:"_getThumbnailUrlParams",value:function(){return this._contentHandler.getCurrentThumbnailUrlParams(this.$experienceContainer.clientWidth,this.$experienceContainer.clientHeight)}},{key:"_updateThumbnail",value:function(){var urlParams=this._getThumbnailUrlParams();if(urlParams){var imageUrl=urlParams.imageUrl,altText=urlParams.altText,width=urlParams.width,height=urlParams.height,queryParams=urlParams.queryParams,$currImg=this._imageCachingHandler.getImage(imageUrl,altText,width,height,queryParams,!0);$currImg&&($currImg.className=CssClassesConfig.b.ImagePlaceholder,this._$floatingThumbnail&&this._$thumbnailWrapper.removeChild(this._$floatingThumbnail),this._$thumbnailWrapper.appendChild($currImg),this._$floatingThumbnail=$currImg,this.adHandler&&this.adHandler.setAdLoadingBackgroundUrl(imageUrl))}}},{key:"_resizeThumbnail",value:function(){this.floatingModule&&this.floatingModule.canFloat()&&this._updateThumbnail()}},{key:"_toggleMediaContextClass",value:function(){var isMediaLogo=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._$thumbnailWrapper&&(isMediaLogo?Object(DomUtils.a)(this._$thumbnailWrapper,CSSClassMainPlayspaceEnum.MediaLogo):Object(DomUtils.L)(this._$thumbnailWrapper,CSSClassMainPlayspaceEnum.MediaLogo))}},{key:"addPlayerSize",value:function(){var $playspaceRatioContainer=this._ratioManager.getPlayspaceRatioContainer();this.$playerWrapper.appendChild($playspaceRatioContainer),Object(DomUtils.a)(this.$playerWrapper,CssClassesConfig.i.Responsive)}},{key:"handleClose",value:function(){this.mediator.publish(this,PlayspaceConfigEvents.CloseButtonClicked),this._isInFloating()?(this.floatingModule.destroy(),this.pause()):this._fullScreenModule&&this._fullScreenModule.isFullscreen?this._fullScreenModule.exitFullScreen():this.triggerDestroy()}},{key:"getVolume",value:function(){return this._contentHandler.volume}},{key:"setNewVolume",value:function(volume){get_default()(getPrototypeOf_default()(PlayspaceExperience.prototype),"setNewVolume",this).call(this,volume),this._contentHandler.volume=volume,this._onVolumeChange(volume)}},{key:"destroy",value:function(){var _a;get_default()(getPrototypeOf_default()(PlayspaceExperience.prototype),"destroy",this).call(this),null===(_a=this._adRollBreakController)||void 0===_a||_a.destroy(),this._contentHandler&&this._contentHandler.destroy(),this._fullScreenModule&&this._fullScreenModule.destroy()}},{key:"_initContentHandler",value:function(){var _this3=this;this._contentHandler=new PlayspaceContentHandler_PlayspaceContentHandler(this,this.app.services.GlobalDomUtilsService,this.app.services.ResizeObserver,this._playerModel,this.app,this.$playerContainer,this._ratioManager),this.subscribe(PlayspaceExperienceEventsEnum.ContentHandlerReady,this._contentHandler,this._onContentHandlerReady),this._playerModel.isCloseButton&&this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Close],this._contentHandler,function(){return _this3.handleClose()}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Volume],this._contentHandler,function(_ref3){var volume=_ref3.payload.volume;_this3._onVolumeChange(volume),_this3.adHandler&&_this3.adHandler.setVolume(volume)}),this.subscribe(PlayspaceExperienceEventsEnum.StateChanged,this._contentHandler,function(_ref4){var _a,state=_ref4.payload;null===(_a=_this3._adRollBreakController)||void 0===_a||_a.changeState(state),_this3._handleAdsOnContentStateChange(state),state===ContentStatesEnum.PlayingState&&_this3._handleContentStart(),_this3._handleExternalApiEventsOnContentStateChange(state)}),this.subscribe(PlayspaceExperienceApiEventsEnum.ChangeSlide,this._contentHandler,function(){_this3._adsController.slideChanged();var metadata=_this3._getCurrentMetadata();if(_this3._updateThumbnail(),_this3.floatingModule&&_this3.floatingModule.canFloat()){var isMediaLogo=metadata&&metadata.mediaContext===ProtoModels_Generated_protos.ProtoMediaContextEnum.Logo;_this3._toggleMediaContextClass(isMediaLogo)}_this3.app.services.TrackingService.updateMediaMetadata(_this3._getMediaMetadata()),_this3.mediator.publish(_this3,PlayspaceConfigEvents.ChangeSlide,{payload:metadata})}),this.subscribe(PlayspaceExperienceEventsEnum.NewStory,this._contentHandler,function(){_this3._onContentChange(),_this3._setNewMediaTracking()}),this.subscribe(PlayspaceExperienceEventsEnum.ContentStart,this._contentHandler,function(){_this3.app.services.TrackingService.setMediaStart(),_this3.mediator.publish(_this3,PlayspaceConfigEvents.ContentStart,{payload:_this3.getStoryMetadata()})}),this.subscribe(PlayspaceExperienceEventsEnum.ContentEnd,this._contentHandler,function(){_this3.app.services.TrackingService.trackMediaQuartile(protos.ProtoQuartilesEnum.Fourth),_this3.mediator.publish(_this3,PlayspaceConfigEvents.ContentComplete,{payload:_this3.getStoryMetadata()})}),this.floatingModule&&this.subscribe(ExperienceConfig.b.UserInteraction,this._contentHandler,this._handleFloatingOnUserInteraction),this.subscribe(UiPlayspaceEventsEnum.ProgressBarItemClicked,this._contentHandler,function(_ref5){var index=_ref5.payload;_this3.mediator.publish(_this3,PlayspaceConfigEvents.ProgressBarItemClicked,{payload:_this3._getSlideMetadataByIndex(index)})}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Volume],this.adHandler,function(_ref6){var volume=_ref6.payload.volume;_this3._onVolumeChange(volume),_this3._contentHandler.volume=volume}),this.subscribe(UiPlayspaceEventsEnum.CallToAction,this._contentHandler,function(){_this3.mediator.publish(_this3,PlayspaceConfigEvents.CallToAction,{payload:_this3._getCurrentMetadata()})}),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.LogoClicked],this._contentHandler,function(){_this3.mediator.publish(_this3,PlayspaceConfigEvents.BrandingClicked)}),this.subscribe(VideoQualityEventsEnum.Change,this._contentHandler,function(_ref7){var quality=_ref7.payload;_this3._cachedQuality!==quality&&(_this3._cachedQuality=quality,_this3.mediator.publish(_this3,PlayspaceConfigEvents.QualityChanged,{payload:quality}))}),this.subscribe(UiPlayspaceEventsEnum.GeneralClickInteraction,this._contentHandler,function(_ref8){var mediaClickType=_ref8.payload;_this3.app.services.TrackingService.trackMediaClick(mediaClickType)}),this._contentHandler.start()}},{key:"_initAdRollBreakController",value:function(contentHandler,adHandler){var _this$_playerModel=this._playerModel,preRollBreak=_this$_playerModel.preRollBreak,postRollBreak=_this$_playerModel.postRollBreak;this._adRollBreakController=new AdRollBreakController_AdRollBreakController(contentHandler,adHandler,preRollBreak,postRollBreak)}},{key:"_handleAdsOnContentStateChange",value:function(state){switch(state){case ContentStatesEnum.PlayingState:this._changeAdState(ProtoModels_Generated_protos.ProtoAdSlotsEnum.MidRoll);break;case ContentStatesEnum.PrerollState:this._changeAdState(ProtoModels_Generated_protos.ProtoAdSlotsEnum.PreRoll);break;case ContentStatesEnum.PostrollState:this._changeAdState(ProtoModels_Generated_protos.ProtoAdSlotsEnum.PostRoll);break;case ContentStatesEnum.PausedState:this._playerModel.adViewabilityPolicy===protos.ProtoAdViewabilityPolicy.Default&&!this._playbackHandler.inView||this._adsController.onStop();break;case ContentStatesEnum.StoppedState:this._adsController.onStop()}}},{key:"_handleExternalApiEventsOnContentStateChange",value:function(state){switch(state){case ContentStatesEnum.PlayingState:this.app.services.TrackingService.setSessionPlayback(!0),this.mediator.publish(this,PlayspaceConfigEvents.Play,{payload:this._getCurrentMetadata()});break;case ContentStatesEnum.PausedState:this.mediator.publish(this,PlayspaceConfigEvents.Pause,{payload:this._getCurrentMetadata()}),this.app.services.TrackingService.setSessionPlayback(!1);break;case ContentStatesEnum.StoppedState:this.mediator.publish(this,PlayspaceConfigEvents.ContentComplete,{payload:this.getStoryMetadata()}),this.app.services.TrackingService.setSessionPlayback(!1);break;default:this.app.services.TrackingService.setSessionPlayback(!0)}}},{key:"_initPlaybackLogic",value:function(){var _this4=this;this._playbackHandler=new PlaybackHandler_PlaybackHandler(this,this._playerModel.playbackMode),this.subscribe(PlaybackHandlerEvents[PlaybackHandlerEvents.Play],this._playbackHandler,function(){_this4._contentHandler.play(!1)}),this.subscribe(PlaybackHandlerEvents[PlaybackHandlerEvents.Pause],this._playbackHandler,function(){_this4._contentHandler.pause(!1)}),this.subscribe(ExperienceConfig.b.UserInteraction,this._contentHandler,function(_ref9){var playback=_ref9.payload.playback;Object(TypeUtils.a)(playback)&&_this4._playbackHandler.setUserPlayback(playback)}),this._playbackHandler.setViewability(this.app.services.ViewabilityService.check({element:this.$playerContainer,threshold:this._VIEWABILITY_THRESHOLD}))}},{key:"_startAdHandler",value:function(){this.adHandler&&(this.adHandler.start(this.$playerContainer.clientWidth,this.$playerContainer.clientHeight,this._playerModel.soundMode===ProtoModels_Generated_protos.ProtoPlayerSoundMode.On?1:0),this._adsController.forceRecheck())}},{key:"_showAd",value:function(){var nextSlide=this.getNextSlide();this.adHandler.setContinueReadingCard({imageSrc:nextSlide.metadata.imageUrl,title:nextSlide.metadata.title}),get_default()(getPrototypeOf_default()(PlayspaceExperience.prototype),"_showAd",this).call(this),this._contentHandler.hide()}},{key:"_hideAd",value:function(){var _this5=this;this._adBreaksHelper.isInAdPod()?this._enterAdPodLoadingState(function(){_this5._adsController.onAdFinished(_this5.adHandler.inImpression,_this5._adBreaksHelper.isInAdPod()),get_default()(getPrototypeOf_default()(PlayspaceExperience.prototype),"_hideAd",_this5).call(_this5),_this5._contentHandler.show()}):(get_default()(getPrototypeOf_default()(PlayspaceExperience.prototype),"_hideAd",this).call(this),this._contentHandler.show())}},{key:"_getAdHandler",value:function(){return new PlayspaceAdHandler_PlayspaceAdHandler(this,this._playerModel,this.$playerContainer,this.checkFloatingViewability(this.isViewable()),this._adBreaksHelper,this.app,this._urlSuffixerService)}},{key:"_createAdsController",value:function(){return new PlayspaceAdsController_PlayspaceAdsController(this,this.isViewable(),{minSlidesBeforeFirstAd:this._playerModel.minSlidesBeforeFirstAd,slidesBetweenAds:this._playerModel.slidesBetweenAds,numberOfMidRolls:this._playerModel.midRollNumber,viewabilityPolicy:this._playerModel.adViewabilityPolicy,maxAdSlotDuration:this._adBreaksHelper.getMaxAdSlotDuration(),maxAdPodDuration:this._adBreaksHelper.getMaxAdPodDuration(),playerDimensions:{width:this.$playerContainer.offsetWidth,height:this.$playerContainer.offsetHeight},playerAdsSkippability:this._playerModel.adSkippability,adsMustBeSkippableIfLongerThan:this._playerModel.adsMustBeSkippableIfLongerThan},this.app)}},{key:"_onPlayerResize",value:function(){get_default()(getPrototypeOf_default()(PlayspaceExperience.prototype),"_onPlayerResize",this).call(this),this._contentHandler&&this._contentHandler.onResize(),this._ratioManager.setRatio(),this._resizeThumbnail(),this._videoBreakpointsHandler.updateWidth(this.$playerContainer.clientWidth)}},{key:"_isInFloating",value:function(){return this.floatingModule&&this.floatingModule.isInFloating}},{key:"_viewabilityCallback",value:function(inView){var isAppBackgrounded=arguments.length>1&&void 0!==arguments[1]&&arguments[1];get_default()(getPrototypeOf_default()(PlayspaceExperience.prototype),"_viewabilityCallback",this).call(this,inView,isAppBackgrounded),this._playbackHandler&&this._playbackHandler.setViewability(inView),this._contentHandler&&this._contentHandler.setViewabilityState(inView)}},{key:"_initViewportResize",value:function(){var _this6=this,topBody=this.app.services.GlobalDomUtilsService.getGlobalClosestTop().topFrame.document.body;this.app.services.ResizeObserver.on(topBody,function(){_this6._ratioManager.setRatio(!0)})}},{key:"_getAdLoadedProperties",value:function(){return{isAutoPlay:this._playerModel.playbackMode===ProtoModels_Generated_protos.ProtoPlayerPlaybackModeEnum.Autoplay,isSkippable:!0,skipOffset:0}}},{key:"start",value:function(){try{get_default()(getPrototypeOf_default()(PlayspaceExperience.prototype),"start",this).call(this),this._setFloatingForRatioFacade(this.floatingModule),this._initContentHandler(),this._startAdHandler(),this._initAdRollBreakController(this._contentHandler,this.adHandler),this._subscribeToVolumeUserInteraction(this._contentHandler),this._initFullScreen(),this._initViewportResize(),this._videoBreakpointsHandler=new BreakPointsHandler_BreakPointsHandler(this.$playerContainer,this.app.config.device,VIDEO_BREAK_POINTS,CssClassesConfig.t),this._forcePlayerHeight(this.$playerContainer)}catch(e){Object(Logging.a)({message:"PlayspaceExperience_start",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.FATAL})}}},{key:"setSlide",value:function(slideIndex){this._contentHandler.setSlide(slideIndex)}},{key:"getNextSlide",value:function(){return this._contentHandler.getNextSlide()}},{key:"play",value:function(){get_default()(getPrototypeOf_default()(PlayspaceExperience.prototype),"play",this).call(this);this._contentHandler.play(!1)}},{key:"pause",value:function(){get_default()(getPrototypeOf_default()(PlayspaceExperience.prototype),"pause",this).call(this);this._contentHandler.pause(!1)}},{key:"getStoryId",value:function(){return this._playerModel.storyId}},{key:"getStoryPosition",value:function(){return this._contentHandler.currentSlideIndex}},{key:"getStoryTimeline",value:function(){return this._contentHandler.slides.map(function(slide){return slide.media.duration/TimeConfig.f})}},{key:"updateCtaLabel",value:function(slideIndex,label){Object(TypeUtils.d)(slideIndex)&&Object(TypeUtils.h)(label)&&this._contentHandler.updateCtaLabel(slideIndex,label)}},{key:"getStoryMetadata",value:function(){return this._contentHandler.slidesMetadata.map(function(_ref10){return{title:_ref10.title,clickUrl:_ref10.clickUrl,duration:_ref10.slideDuration}})}},{key:"toggleFullscreenButton",value:function(show){this._contentHandler.toggleExpandButton(show)}},{key:"toggleFullscreen",value:function(enterFullscreen){Object(TypeUtils.a)(enterFullscreen)||(enterFullscreen=!this._fullScreenModule.isFullscreen),this._fullScreenModule.isFullscreen!==enterFullscreen&&(enterFullscreen?this._enterFullScreen():this._fullScreenModule.exitFullScreen())}},{key:"getQuality",value:function(){return this._contentHandler.getQuality()}},{key:"setQuality",value:function(height){this._contentHandler.setQuality(height)}},{key:"getOrientation",value:function(){return this._ratioManager.getOrientation()}},{key:"setOrientation",value:function(orientation){this._ratioManager.setOrientation(orientation)}},{key:"_initFullScreen",value:function(){this.app.config.os.os!==OsConfig.b.Ios&&(this._fullScreenModule=new FullScreen_FullScreen(this,this.app.services.GlobalDomUtilsService,this.$playerContainer,this.app.config.os.os),this._subscribeToFullScreenEvents())}},{key:"_subscribeToFullScreenEvents",value:function(){var _this7=this;this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Expand],this._contentHandler,this._enterFullScreen),this.subscribe(UiComponentEventsEnum[UiComponentEventsEnum.Collapse],this._contentHandler,function(){return _this7._fullScreenModule.exitFullScreen()}),this.subscribe(FullscreenEventsEnum.exit,this._fullScreenModule,this._onFullscreenExit),this.subscribe(FullscreenEventsEnum.enter,this._fullScreenModule,this._onFullscreenEnter)}},{key:"_enterFullScreenCallback",value:function(){this._contentHandler.enterFullscreen(),this.floatingModule&&this.floatingModule.fullscreenStateChange(!0)}},{key:"_getCurrentMetadata",value:function(){return this._contentHandler.getCurrentMetadata()}},{key:"_getSlideMetadataByIndex",value:function(index){if(!(index<0||this._contentHandler.slidesMetadata.length<index))return this._contentHandler.slidesMetadata[index]}},{key:"_setNewMediaTracking",value:function(){this.app.services.TrackingService.setNewMedia(this._getMediaMetadata())}},{key:"_getMediaMetadata",value:function(){var currentSlideMetadata=this._contentHandler.getCurrentMetadata(),slideTitle=currentSlideMetadata.title||currentSlideMetadata.coverMetadata&&currentSlideMetadata.coverMetadata.title;return{mediaId:this._playerModel.storyId,clickUrl:currentSlideMetadata.clickUrl,slideTitle:slideTitle,slideNumber:this._contentHandler.currentSlideIndex+1,slideMediaType:currentSlideMetadata.mediaType}}},{key:"_forcePlayerHeight",value:function($playerContainer){if(!Object(TypeUtils.h)(this._playerModel.sdkVersion)&&Object(TypeUtils.h)(this.app.config.bundleID)){var bodyElement=this.app.services.GlobalDomUtilsService.querySelector("body");Object(DomUtils.Q)(bodyElement,{margin:"0"}),$playerContainer.clientWidth>=300&&(Object(DomUtils.Q)($playerContainer,{"min-height":"".concat(250,"px")}),Object(DomUtils.i)($playerContainer)),Object(GeneralUtils.l)([95,5])&&Object(Logging.a)({message:"PlayspaceExperience_start",exception:"IN_APP_RENDER_PLAYER_SIZE",callStack:"width: ".concat(this.$playerContainer.clientWidth,": height: ").concat(this.$playerContainer.clientHeight," "),level:protos.ProtoLoggingLevelEnum.INFO})}}},{key:"_updateAlwaysOnFlag",value:function(){}}]),PlayspaceExperience}(BaseExperience_BaseExperience),Observer_Observer=function(){function Observer(){classCallCheck_default()(this,Observer),this._subscriptions={}}return createClass_default()(Observer,[{key:"on",value:function(event,callback){var _this=this;if(this._subscriptions[event]=this._subscriptions[event]||[],!Object(TypeUtils.b)(callback))throw new Error("".concat(event," event callback is not a function"));return this._subscriptions[event].push(callback),function(){return _this._subscriptions[event]=_this._subscriptions[event].filter(function(cb){return cb!==callback})}}},{key:"once",value:function(event,callback){var destroy=this.on(event,function(data){try{callback(data)}catch(e){}destroy()})}},{key:"remove",value:function(event,callback){this._subscriptions[event]&&(this._subscriptions[event]=this._subscriptions[event].filter(function(cb){return cb!==callback}))}},{key:"removeAll",value:function(){this._subscriptions={}}},{key:"trigger",value:function(event,data){this._subscriptions[event]&&this._subscriptions[event].forEach(function(callback){try{callback(data)}catch(e){}})}}]),Observer}();function PlayspaceExperienceApi_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var PlayspaceExperienceApi_PlayspaceExperienceApi=function(_BaseExperienceApi){inherits_default()(PlayspaceExperienceApi,_BaseExperienceApi);var _super=PlayspaceExperienceApi_createSuper(PlayspaceExperienceApi);function PlayspaceExperienceApi(){var _this;return classCallCheck_default()(this,PlayspaceExperienceApi),(_this=_super.apply(this,arguments))._getStoryPosition=function(){return _this.experience.getStoryPosition()},_this._getStoryId=function(){return _this.experience.getStoryId()},_this._getStoryTimeline=function(){return _this.experience.getStoryTimeline()},_this._setStoryPosition=function(slideIndex){_this.experience.setSlide(slideIndex)},_this._setCtaLabel=function(slideIndex,label){_this.experience.updateCtaLabel(slideIndex,label)},_this._getStoryMetadata=function(){return _this.experience.getStoryMetadata()},_this._toggleFullscreenButton=function(show){_this.experience.toggleFullscreenButton(show)},_this._toggleFullscreen=function(enterFullscreen){_this.experience.toggleFullscreen(enterFullscreen)},_this._getQuality=function(){return _this.experience.getQuality()},_this._setQuality=function(height){_this.experience.setQuality(height)},_this._getLayout=function(){var orientation=_this.experience.getOrientation();return PlayspaceConfigEnum.LayoutEnum[ProtoModels_Generated_protos.ProtoPlayerOrientationEnum[orientation]]},_this._setLayout=function(orientation){var layout=Object.keys(PlayspaceConfigEnum.LayoutEnum).find(function(key){return PlayspaceConfigEnum.LayoutEnum[key]===orientation});layout&&ProtoModels_Generated_protos.ProtoPlayerOrientationEnum[layout]&&_this.experience.setOrientation(ProtoModels_Generated_protos.ProtoPlayerOrientationEnum[layout])},_this._getPlayerSize=function(){return _this.experience.getSize()},_this}return createClass_default()(PlayspaceExperienceApi,[{key:"getApiMethods",value:function(){return Object.assign(Object.assign({},get_default()(getPrototypeOf_default()(PlayspaceExperienceApi.prototype),"getApiMethods",this).call(this)),{getStoryPosition:this._getStoryPosition,setStoryPosition:this._setStoryPosition,getStoryId:this._getStoryId,getStoryTimeline:this._getStoryTimeline,setCtaLabel:this._setCtaLabel,getStoryMetadata:this._getStoryMetadata,toggleFullscreen:this._toggleFullscreen,toggleFullscreenButton:this._toggleFullscreenButton,getQuality:this._getQuality,setQuality:this._setQuality,getLayout:this._getLayout,setLayout:this._setLayout,getPlayerSize:this._getPlayerSize})}}]),PlayspaceExperienceApi}(function(){function BaseExperienceApi(experience){var _this=this;classCallCheck_default()(this,BaseExperienceApi),this.experience=experience,this._on=function(event,callback){return _this._observer.on(event,callback)},this._remove=function(event,callback){_this._observer.remove(event,callback)},this._removeAll=function(){_this._observer.removeAll()},this._once=function(event,callback){_this._observer.once(event,callback)},this._isViewable=function(){return _this.experience.isViewable()},this._setViewableThreshold=function(threshold){_this.experience.setViewableThreshold(threshold)},this._play=function(){_this.experience.play()},this._pause=function(){_this.experience.pause()},this._getVolume=function(){return _this.experience.getVolume()},this._setVolume=function(volume){_this.experience.setVolume(volume)},this._destroy=function(){_this.experience.triggerDestroy()},this._disableAdvertising=function(){_this.experience.disableAdvertising()},this._enableAdvertising=function(){_this.experience.enableAdvertising()},this._setCustomMacros=function(macros){_this.experience.setCustomMacros(macros)},this._setAmpUserConsent=function(ampUserConsent){_this.experience.setAmpUserConsent(ampUserConsent)},this._observer=new Observer_Observer}return createClass_default()(BaseExperienceApi,[{key:"trigger",value:function(event,data){this._observer.trigger(event,data)}},{key:"setDestroyed",value:function(){this.trigger(ApiConfig.b.Removed)}},{key:"getApiMethods",value:function(){return{on:this._on,remove:this._remove,removeAll:this._removeAll,once:this._once,isViewable:this._isViewable,setViewableThreshold:this._setViewableThreshold,play:this._play,pause:this._pause,getVolume:this._getVolume,setVolume:this._setVolume,disableAdvertising:this._disableAdvertising,enableAdvertising:this._enableAdvertising,setMacros:this._setCustomMacros,setAmpUserConsent:this._setAmpUserConsent,destroy:this._destroy}}}]),BaseExperienceApi}());function PlayspaceRenderer_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var IframeMode,PlayspaceRenderer_PlayspaceRenderer=function(_Renderer){inherits_default()(PlayspaceRenderer,_Renderer);var _super=PlayspaceRenderer_createSuper(PlayspaceRenderer);function PlayspaceRenderer(){var _this;return classCallCheck_default()(this,PlayspaceRenderer),(_this=_super.apply(this,arguments))._platformClass="cnx-ps",_this}return createClass_default()(PlayspaceRenderer,[{key:"createExperience",value:function(playerModel,appSettings){this.experience=new PlayspaceExperience_PlayspaceExperience(this,appSettings,this.app.services.UrlSuffixerService),this.experienceApi=new PlayspaceExperienceApi_PlayspaceExperienceApi(this.experience)}},{key:"getApiMethods",value:function(){return this.experienceApi.getApiMethods()}},{key:"isSupportedBreakpoint",value:function(device){return!(this.experienceContainer.clientWidth<PLAYSPACE_BREAK_POINTS[device].xs)}}]),PlayspaceRenderer}(Renderer_Renderer),LoggingStorage=__webpack_require__(44);!function(IframeMode){IframeMode[IframeMode.none=0]="none",IframeMode[IframeMode.friendly=1]="friendly",IframeMode[IframeMode.safe=2]="safe"}(IframeMode||(IframeMode={}));var PlayerModeEnum,ViewabilityService_ViewabilityService=function(){function ViewabilityService(_global,_pageFocusService,forceFallbackImplementation){var _this=this;classCallCheck_default()(this,ViewabilityService),this._global=_global,this._pageFocusService=_pageFocusService,this._viewList=[],this._iframeMode=IframeMode.none,this._viewabilitySupport={intersectionObserver:!1,fallbackImplementation:!1},this._scrollTimeoutId=null,this._thresholdObserver=[0,.01,.1,.2,.5],this._scrollTimeout=250,this._isTabInFocus=!1,this._setFocusState=function(inFocus){_this._isTabInFocus=inFocus,_this._viewabilityChecker(),LoggingStateStorage.a.setFocusState(inFocus),LoggingStorage.a.pageFocus=inFocus},this._viewabilityChecker=function(){_this._viewList.forEach(function(elem){var percInView=_this._viewPercentage(elem.element);_this.onViewHandle(elem,percInView)})},this._onScroll=function(){null===_this._scrollTimeoutId&&(_this._scrollTimeoutId=setTimeout(function(){_this._viewabilityChecker(),clearTimeout(_this._scrollTimeoutId),_this._scrollTimeoutId=null},_this._scrollTimeout))},this._setup(forceFallbackImplementation),this._initObserver(),this._initPageInFocusService()}return createClass_default()(ViewabilityService,[{key:"_initPageInFocusService",value:function(){this._pageFocusService.on(this._setFocusState),LoggingStorage.a.pageFocus=this._pageFocusService.isDocumentVisible()}},{key:"_setup",value:function(forceFallbackImplementation){this._global.IntersectionObserver&&!forceFallbackImplementation?this._viewabilitySupport.intersectionObserver=!0:this._viewabilitySupport.fallbackImplementation=!0,this._global.self!==this._global.top?(this._parentIframe=this._getTopIframeElement(this._global),null!==this._parentIframe?this._iframeMode=IframeMode.friendly:this._iframeMode=IframeMode.safe):this._parentIframe=this._global.frameElement}},{key:"_getTopIframeElement",value:function(currentWindow){var parentWindow;try{if((parentWindow=currentWindow.parent)===this._global.top)return currentWindow.frameElement}catch(e){return null}return this._getTopIframeElement(parentWindow)}},{key:"_initObserver",value:function(){this._viewabilitySupport.intersectionObserver?this._intersectionObserver=new this._global.IntersectionObserver(this.onObserverEnter.bind(this),{root:null,rootMargin:"0px",threshold:this._thresholdObserver}):(this._global.addEventListener("scroll",this._onScroll),this._global.addEventListener("load",this._viewabilityChecker),this._global.addEventListener("resize",this._viewabilityChecker))}},{key:"_getWatcher",value:function(element){return this._viewList.find(function(view){return view.element===element})}},{key:"_viewPercentage",value:function(element){if(this._iframeMode===IframeMode.safe){var watcher=this._getWatcher(element);return watcher?watcher.cachedPercentInView:0}var percent=1,rect=element.getBoundingClientRect(),intersectionRatios={bottomRatio:rect.bottom/rect.height,topRatio:(this._global.top.innerHeight-rect.top)/rect.height,leftRatio:(this._global.top.innerWidth-rect.left)/rect.width,rightRatio:rect.right/rect.width};return Object.keys(intersectionRatios).forEach(function(key){intersectionRatios[key]<=0&&(percent=0),intersectionRatios[key]>0&&intersectionRatios[key]<1&&(percent*=intersectionRatios[key])}),percent}},{key:"onObserverEnter",value:function(entries){var _this2=this;entries.forEach(function(entry){_this2._viewList.filter(function(elem){return elem.element===entry.target}).forEach(function(elem){_this2.onViewHandle(elem,entry.intersectionRatio)})})}},{key:"onViewHandle",value:function(element,intersectionRatio){var _this3=this;element.cachedPercentInView=intersectionRatio,element.list.forEach(function(elem){!elem.callbackSent&&elem.threshold<=intersectionRatio&&_this3._isTabInFocus?(elem.callbackSent=!0,elem.timeout=Object(GeneralUtils.a)(elem.callback,elem.callbackDelay,!0)):elem.callbackSent&&(elem.threshold>intersectionRatio||!_this3._isTabInFocus)&&(elem.callbackSent=!1,clearTimeout(elem.timeout),elem.timeout=Object(GeneralUtils.a)(elem.callback,0,!1))})}},{key:"on",value:function(element,callback){var settings=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},alreadyObserved=!1;if(this._viewabilitySupport.fallbackImplementation)if(this._iframeMode===IframeMode.friendly&&element.ownerDocument.defaultView!==this._global.top)element=this._parentIframe;else if(this._iframeMode===IframeMode.safe)return void Object(GeneralUtils.a)(callback,0,!1);var existingWatcher=this._viewList.find(function(elem){return elem.element===element});existingWatcher?alreadyObserved=!0:(existingWatcher={element:element,list:[],cachedPercentInView:0},this._viewList.push(existingWatcher)),existingWatcher.list.push({threshold:settings.threshold,callbackSent:!1,callbackDelay:settings.callbackDelay,timeout:null,callback:callback}),this._viewabilitySupport.intersectionObserver?(alreadyObserved&&this._intersectionObserver.unobserve(element),this._intersectionObserver.observe(element)):this._viewabilitySupport.fallbackImplementation&&this._viewabilityChecker()}},{key:"off",value:function(element,callback){var viewElem=this._viewList.find(function(elem){return elem.element===element});if(viewElem){for(var i=viewElem.list.length;i;)i--,viewElem.list[i].callback===callback&&viewElem.list.splice(i,1);0===viewElem.list.length&&(this._intersectionObserver&&this._intersectionObserver.unobserve(element),this._viewList.splice(this._viewList.indexOf(viewElem),1))}}},{key:"check",value:function(){var settings=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{threshold:.1};if(!settings.element)return!1;var target=settings.element;return this._iframeMode===IframeMode.friendly&&(target=this._parentIframe),this._viewPercentage(target)>=settings.threshold&&this._isTabInFocus}},{key:"triggerRecheck",value:function(element){var _this4=this;this._viewabilitySupport.fallbackImplementation&&element&&this._viewList.forEach(function(elem){if(elem.element===element){var percInView=_this4._viewPercentage(elem.element);_this4.onViewHandle(elem,percInView)}})}},{key:"setViewableThreshold",value:function(threshold){}},{key:"getIsTabInFocus",value:function(){return this._isTabInFocus}},{key:"subscribe",value:function(event,callback){}},{key:"destroy",value:function(){var _this5=this;this._global.removeEventListener("scroll",this._onScroll),this._global.removeEventListener("load",this._viewabilityChecker),this._global.removeEventListener("resize",this._viewabilityChecker),[].slice.call(this._viewList).forEach(function(watcher){[].slice.call(watcher.list).forEach(function(watcherDetails){_this5.off(watcher.element,watcherDetails.callback),_this5._global.clearTimeout(watcherDetails.timeout)})}),this._pageFocusService.off(this._setFocusState),clearTimeout(this._scrollTimeoutId)}}]),ViewabilityService}(),ExternalViewabilityService_ExternalViewabilityService=function(){function ExternalViewabilityService(){var _this=this;classCallCheck_default()(this,ExternalViewabilityService),this._viewList=[],this._viewPercentage=0,this._isBackgrounded=!1,this._viewabilityChecker=function(element){_this._viewList.forEach(function(elem){element&&element!==elem.element||_this._onViewHandle(elem,_this._viewPercentage)})}}return createClass_default()(ExternalViewabilityService,[{key:"_getWatcherList",value:function(element){var existingWatcher=this._viewList.find(function(elem){return elem.element===element});return existingWatcher||(existingWatcher={element:element,list:[],cachedPercentInView:0},this._viewList.push(existingWatcher)),existingWatcher.list}},{key:"_onViewHandle",value:function(element,intersectionRatio){var _this2=this;element.list.forEach(function(elem){!elem.callbackSent&&elem.threshold<=intersectionRatio?(elem.callbackSent=!0,elem.timeout=Object(GeneralUtils.a)(elem.callback,elem.callbackDelay,!0,_this2._isBackgrounded)):elem.callbackSent&&elem.threshold>intersectionRatio&&(elem.callbackSent=!1,clearTimeout(elem.timeout),elem.timeout=Object(GeneralUtils.a)(elem.callback,0,!1,_this2._isBackgrounded))})}},{key:"on",value:function(element,callback,settings){this._getWatcherList(element).push({threshold:settings.threshold,callbackSent:!1,callbackDelay:settings.callbackDelay,timeout:null,callback:callback}),this._viewabilityChecker()}},{key:"off",value:function(element,callback){var viewElem=this._viewList.find(function(elem){return elem.element===element});if(viewElem){for(var i=viewElem.list.length;i--;)viewElem.list[i].callback===callback&&viewElem.list.splice(i,1);0===viewElem.list.length&&this._viewList.splice(this._viewList.indexOf(viewElem))}}},{key:"check",value:function(){var settings=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{threshold:.1};return this._viewPercentage>=settings.threshold}},{key:"triggerRecheck",value:function(element){this._viewabilityChecker(element)}},{key:"_setIsBackgrounded",value:function(isBackgrounded){this._isBackgrounded=isBackgrounded}},{key:"setViewableThreshold",value:function(threshold){this._viewPercentage=threshold,this.triggerRecheck()}},{key:"getIsTabInFocus",value:function(){return!0}},{key:"subscribe",value:function(event,callback){}},{key:"destroy",value:function(){for(var i=this._viewList.length;i--;)for(var element=this._viewList[i],j=element.list.length;j--;)clearTimeout(element.list[j].timeout),this.off(element.element,element.list[j].callback)}}]),ExternalViewabilityService}(),FloatingRatio_FloatingRatio=function(){function FloatingRatio(){var _extraHeight=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;classCallCheck_default()(this,FloatingRatio),this._extraHeight=_extraHeight,this._widthRatio=16,this._heightRatio=9}return createClass_default()(FloatingRatio,[{key:"getHeightByRatio",value:function(width){return Math.round(width/this._widthRatio*this._heightRatio)+this._extraHeight}}]),FloatingRatio}(),FloatingModel_FloatingSettingsModel=function(){function FloatingSettingsModel(playerResponse,extraHeight){var floating=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};classCallCheck_default()(this,FloatingSettingsModel),this.floatingMode=Object(TypeUtils.a)(floating.mode)?floating.mode:playerResponse.floatingMode,Object(ArrayUtils.h)(floating.devices)?this.floatingDeviceMode=floating.devices:this.floatingDeviceMode=Object(ArrayUtils.h)(playerResponse.floatingDeviceMode)?playerResponse.floatingDeviceMode:[protos.ProtoDeviceType.Desktop],Object(TypeUtils.a)(floating.closeButton)?this.floatingCloseButtonMode=floating.closeButton:Object(TypeUtils.a)(playerResponse.floatingCloseButtonMode)?this.floatingCloseButtonMode=playerResponse.floatingCloseButtonMode:this.floatingCloseButtonMode=protos.ProtoPlayerCloseButtonMode.OnHover,this.floatingPosition=Object(TypeUtils.a)(floating.fixedPosition)?floating.fixedPosition:playerResponse.floatingFixedPosition,this.floatingScrollPosition=Object(TypeUtils.a)(floating.scrollPosition)?floating.scrollPosition:playerResponse.floatingScrollPosition,this.floatingWidth=Object(TypeUtils.a)(floating.floatingWidth)?floating.floatingWidth:playerResponse.floatingWidth||FLOAT_WIDTH,this.floatingGutterX=Object(TypeUtils.a)(floating.floatingGutterX)?floating.floatingGutterX:playerResponse.floatingGutterX,this.floatingGutterY=Object(TypeUtils.a)(floating.floatingGutterY)?floating.floatingGutterY:playerResponse.floatingGutterY,this.pageElement=playerResponse.floatingPageElement,this.appendLocation=playerResponse.floatingAppendLocation,this.floatingYAxisPadding=playerResponse.floatingYAxisPadding,this._isPositionedLeft=this.floatingScrollPosition===protos.ProtoPositionMode.BottomLeft||this.floatingScrollPosition===protos.ProtoPositionMode.TopLeft,this._isPositionedRight=this.floatingScrollPosition===protos.ProtoPositionMode.BottomRight||this.floatingScrollPosition===protos.ProtoPositionMode.TopRight,this._isPositionedTop=this.floatingScrollPosition===protos.ProtoPositionMode.TopLeft||this.floatingScrollPosition===protos.ProtoPositionMode.TopRight,this._isPositionedBottom=this.floatingScrollPosition===protos.ProtoPositionMode.BottomRight||this.floatingScrollPosition===protos.ProtoPositionMode.BottomLeft,this._floatingRatio=new FloatingRatio_FloatingRatio(extraHeight)}return createClass_default()(FloatingSettingsModel,[{key:"getHeight",value:function(width){return"".concat(this._floatingRatio.getHeightByRatio(width),"px")}},{key:"isPositionedLeft",get:function(){return this._isPositionedLeft},set:function(value){this._isPositionedLeft=value}},{key:"isPositionedRight",get:function(){return this._isPositionedRight},set:function(value){this._isPositionedRight=value}},{key:"isPositionedTop",get:function(){return this._isPositionedTop}},{key:"isPositionedBottom",get:function(){return this._isPositionedBottom},set:function(value){this._isPositionedBottom=value}},{key:"positionClass",get:function(){switch(this.floatingScrollPosition){case protos.ProtoPositionMode.BottomLeft:return"bottom-left";case protos.ProtoPositionMode.TopLeft:return"top-left";case protos.ProtoPositionMode.TopRight:return"top-right";default:return"bottom-right"}}},{key:"width",set:function(value){this.floatingWidth=value},get:function(){return this.floatingWidth}}]),FloatingSettingsModel}();function isMergeableObject(val){return Object(TypeUtils.f)(val)&&"[object RegExp]"!==Object.prototype.toString.call(val)&&"[object Date]"!==Object.prototype.toString.call(val)}function cloneIfNecessary(value){return isMergeableObject(value)?deepMerge({},value):value}function deepMerge(target,source){return function(target,source){var destination={};return isMergeableObject(target)&&Object.keys(target).forEach(function(key){destination[key]=cloneIfNecessary(target[key])}),Object.keys(source).forEach(function(key){isMergeableObject(source[key])&&target[key]?destination[key]=deepMerge(target[key],source[key]):destination[key]=cloneIfNecessary(source[key])}),destination}(target,source)}function PlayspacePlayerModel_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}!function(PlayerModeEnum){PlayerModeEnum[PlayerModeEnum.Normal=0]="Normal",PlayerModeEnum[PlayerModeEnum.Buzzfeed=1]="Buzzfeed"}(PlayerModeEnum||(PlayerModeEnum={}));var PlayspacePlayerModel_PlayspacePlayerModel=function(_PlayerModel){inherits_default()(PlayspacePlayerModel,_PlayerModel);var _super=PlayspacePlayerModel_createSuper(PlayspacePlayerModel);function PlayspacePlayerModel(global,targetContainer,_playerResponse,_device,secondLevelDomain,_apiConfig,isServerlessMode,supplyChainSettings,_urlSuffixerService,videoPosition,storyPosition,isSeoTraffic){var _this;return classCallCheck_default()(this,PlayspacePlayerModel),(_this=_super.call(this,global,targetContainer,_playerResponse,_device,secondLevelDomain,_apiConfig,isServerlessMode,supplyChainSettings,isSeoTraffic,_urlSuffixerService,videoPosition,LANDSCAPE_BOTTOM_HEIGHT)).global=global,_this.targetContainer=targetContainer,_this._playerResponse=_playerResponse,_this._urlSuffixerService=_urlSuffixerService,_this.videoPosition=videoPosition,_this.storyPosition=storyPosition,_this.fontFamilySettings={},_this.primaryColorList={},_this.secondaryColorList={},_this.accentColorList={},_this.disableCTARendering=!1,_this.disableStoryProgressBarRendering=!1,_this.disableTitleRendering=!1,_this.activeVersion=_this._playerResponse.activeVersion,_this.storyId=_this._playerResponse.storyId,_this.storyMetadata=_this.apiConfig.settings.story,_this.sdkVersion=_this.apiConfig._appSettings.sdkVersion,_this.minSlidesBeforeFirstAd=Object(TypeUtils.a)(_this.apiConfig.settings.advertising.slidesBeforeFirstAd)?_this.apiConfig.settings.advertising.slidesBeforeFirstAd:_this._playerResponse.minSlidesBeforeFirstAd,_this.slidesBetweenAds=Object(TypeUtils.a)(_this.apiConfig.settings.advertising.slidesBetweenAds)?_this.apiConfig.settings.advertising.slidesBetweenAds:_this._playerResponse.slidesBetweenAds,_this._playerResponse.floatingMode===ProtoModels_Generated_protos.ProtoPlayerFloatingMode.Always?_this.orientation=ProtoModels_Generated_protos.ProtoPlayerOrientationEnum.Landscape:_this.orientation=Object(TypeUtils.a)(_this.apiConfig.settings.customization.orientation)?_this.apiConfig.settings.customization.orientation:_this._playerResponse.orientation,_this.orientationBreakpoint=Object(TypeUtils.a)(_this.apiConfig.settings.customization.orientationBreakpoint)?_this.apiConfig.settings.customization.orientationBreakpoint:_this._playerResponse.orientationBreakpoint,Object(TypeUtils.f)(_this.apiConfig.settings.customization.fontFamilySettings)&&(_this.fontFamilySettings=_this.apiConfig.settings.customization.fontFamilySettings),_this._initPrimaryBackgroundColor(),_this._initPrimaryForegroundColor(),_this._initSecondaryBackgroundColor(),_this._initSecondaryForegroundColor(),_this._initAccentBackgroundColor(),_this._initAccentForegroundColor(),_this.useAccentColorForProgressBar=Object(TypeUtils.a)(_this.apiConfig.settings.customization.useAccentColorForProgressBar)?_this.apiConfig.settings.customization.useAccentColorForProgressBar:_this._playerResponse.useAccentColorForProgressBar,_this.endOfSlideCycleMode=Object(TypeUtils.a)(_this.apiConfig.settings.endOfSlideCycleMode)?_this.apiConfig.settings.endOfSlideCycleMode:_this._playerResponse.endOfCycleMode,_this.uiComponentsVisibility.expandButton=!1,_this.disableCTARendering=Object(TypeUtils.a)(_this.apiConfig.settings.disableCTARendering)&&_this.apiConfig.settings.disableCTARendering,_this.disableStoryProgressBarRendering=Object(TypeUtils.a)(_this.apiConfig.settings.disableStoryProgressBarRendering)&&_this.apiConfig.settings.disableStoryProgressBarRendering,_this.disableTitleRendering=Object(TypeUtils.a)(_this.apiConfig.settings.disableTitleRendering)&&_this.apiConfig.settings.disableTitleRendering,_this.publisherName=Object(TypeUtils.h)(_this.apiConfig.settings.customization.publisherName)?_this.apiConfig.settings.customization.publisherName:_this._playerResponse.publisherName,_this}return createClass_default()(PlayspacePlayerModel,[{key:"_initPrimaryBackgroundColor",value:function(){this.apiConfig.settings.customization.primaryColorList&&Object(TypeUtils.h)(this.apiConfig.settings.customization.primaryColorList.background)?this.primaryColorList.background=this.apiConfig.settings.customization.primaryColorList.background:this._playerResponse.primaryColorList&&Object(TypeUtils.h)(this._playerResponse.primaryColorList.background)&&(this.primaryColorList.background=this._playerResponse.primaryColorList.background)}},{key:"_initPrimaryForegroundColor",value:function(){this.apiConfig.settings.customization.primaryColorList&&Object(TypeUtils.h)(this.apiConfig.settings.customization.primaryColorList.foreground)?this.primaryColorList.foreground=this.apiConfig.settings.customization.primaryColorList.foreground:this._playerResponse.primaryColorList&&Object(TypeUtils.h)(this._playerResponse.primaryColorList.foreground)&&(this.primaryColorList.foreground=this._playerResponse.primaryColorList.foreground)}},{key:"_initSecondaryBackgroundColor",value:function(){this.apiConfig.settings.customization.secondaryColorList&&Object(TypeUtils.h)(this.apiConfig.settings.customization.secondaryColorList.background)?this.secondaryColorList.background=this.apiConfig.settings.customization.secondaryColorList.background:this._playerResponse.secondaryColorList&&Object(TypeUtils.h)(this._playerResponse.secondaryColorList.background)&&(this.secondaryColorList.background=this._playerResponse.secondaryColorList.background)}},{key:"_initSecondaryForegroundColor",value:function(){this.apiConfig.settings.customization.secondaryColorList&&Object(TypeUtils.h)(this.apiConfig.settings.customization.secondaryColorList.foreground)?this.secondaryColorList.foreground=this.apiConfig.settings.customization.secondaryColorList.foreground:this._playerResponse.secondaryColorList&&Object(TypeUtils.h)(this._playerResponse.secondaryColorList.foreground)&&(this.secondaryColorList.foreground=this._playerResponse.secondaryColorList.foreground)}},{key:"_initAccentBackgroundColor",value:function(){this.apiConfig.settings.customization.accentColorList&&Object(TypeUtils.h)(this.apiConfig.settings.customization.accentColorList.background)?this.accentColorList.background=this.apiConfig.settings.customization.accentColorList.background:this._playerResponse.accentColorList&&Object(TypeUtils.h)(this._playerResponse.accentColorList.background)&&(this.accentColorList.background=this._playerResponse.accentColorList.background)}},{key:"_initAccentForegroundColor",value:function(){this.apiConfig.settings.customization.accentColorList&&Object(TypeUtils.h)(this.apiConfig.settings.customization.accentColorList.foreground)?this.accentColorList.foreground=this.apiConfig.settings.customization.accentColorList.foreground:this._playerResponse.accentColorList&&Object(TypeUtils.h)(this._playerResponse.accentColorList.foreground)&&(this.accentColorList.foreground=this._playerResponse.accentColorList.foreground)}}]),PlayspacePlayerModel}(function(){function PlayerModel(global,targetContainer,_playerResponse,_device,secondLevelDomain,apiConfig,isServerlessMode,supplyChainSettings,isSeoTraffic,_urlSuffixerService,videoPosition){var _this=this,_floatingExtraHeight=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0;if(classCallCheck_default()(this,PlayerModel),this.global=global,this.targetContainer=targetContainer,this._playerResponse=_playerResponse,this._device=_device,this.secondLevelDomain=secondLevelDomain,this.apiConfig=apiConfig,this.supplyChainSettings=supplyChainSettings,this.isSeoTraffic=isSeoTraffic,this._urlSuffixerService=_urlSuffixerService,this.videoPosition=videoPosition,this.sharingDestinations=[],this.disableAdvertising=!1,this.adBreaks=[],this.disableClickUrl=!1,this.moatTrackingEnabled=!1,this.pauseAdWhenFinished=!1,this.loopAdWhenFinished=!1,this.adsMustBeSkippableIfLongerThan=MonetizationConfig.d,Object(TypeUtils.h)(_playerResponse.initializationSettingsJson))try{var initSettingsJSON=JSON.parse(_playerResponse.initializationSettingsJson);this.apiConfig=deepMerge(this.apiConfig,initSettingsJSON)}catch(e){Object(Logging.a)({message:"invalid_init_json",exception:e.message,callStack:e.callStack,level:protos.ProtoLoggingLevelEnum.FATAL})}(this.apiConfig.playerMode===PlayerModeEnum.Buzzfeed||this.apiConfig.settings.pauseAdWhenFinished)&&(this.pauseAdWhenFinished=!0),this._sanitizeLineItems(this._playerResponse.lineItems);var lineItemsToAdd=[];this.soundMode=Object(TypeUtils.a)(this.apiConfig.settings.defaultSoundMode)?this.apiConfig.settings.defaultSoundMode:_playerResponse.soundMode,this.playbackMode=Object(TypeUtils.a)(this.apiConfig.settings.playbackMode)?this.apiConfig.settings.playbackMode:_playerResponse.playbackMode,this.playbackMode===protos.ProtoPlayerPlaybackModeEnum.ClickToPlay||this.soundMode===protos.ProtoPlayerSoundMode.Mute||Object(GeneralUtils.b)()||(this.soundMode=protos.ProtoPlayerSoundMode.Mute),this.html=_playerResponse.html,this.css=_playerResponse.css,this.floatingSettings=new FloatingModel_FloatingSettingsModel(_playerResponse,_floatingExtraHeight,this.apiConfig.settings.customization.floating),this.logoUrl=Object(TypeUtils.h)(this.apiConfig.settings.customization.logoUrl)?this.apiConfig.settings.customization.logoUrl:_playerResponse.logoUrl;var amazonTamSlotId=_playerResponse.amazonTamSlotId;if(Object(TypeUtils.h)(amazonTamSlotId)&&(this.amazonTamSlotId=amazonTamSlotId),Object(TypeUtils.a)(this.apiConfig.settings.advertising.macros)&&(this.externalMacros=this.apiConfig.settings.advertising.macros),Object(TypeUtils.a)(this.apiConfig.settings.disableAdvertising)&&(this.disableAdvertising=this.apiConfig.settings.disableAdvertising),this._mergeAdBreaks(),this._sanitizeAdBreaks(),Object(ArrayUtils.h)(this.apiConfig.settings.advertising.lineItems)){var externalLineItems=_playerResponse.lineItems.filter(function(lineItem){return lineItem.creativeType===protos.ProtoCreativeTypeEnum.External});this.apiConfig.settings.advertising.lineItems.forEach(function(apiLineItem){if(_this._fallbackUnlimitedRequestCap(apiLineItem),isServerlessMode){var defaultLineItem=_this._getDefaultLineItem(),newLineItem=_this._mergeLineItems(apiLineItem,defaultLineItem);lineItemsToAdd.push(newLineItem)}else externalLineItems.forEach(function(protoLineItem){if(apiLineItem.id===protoLineItem.advertiserLineItemId&&(apiLineItem.url||apiLineItem.headerBidderBids||apiLineItem.externalMediaFile||apiLineItem.externalHlsFile)){var _newLineItem=_this._mergeLineItems(apiLineItem,protoLineItem);lineItemsToAdd.push(_newLineItem)}})})}!0!==this.apiConfig.settings.advertising.blockConnatixDemand&&lineItemsToAdd.push.apply(lineItemsToAdd,toConsumableArray_default()(_playerResponse.lineItems.filter(function(lineItem){return lineItem.creativeType!==protos.ProtoCreativeTypeEnum.External}))),lineItemsToAdd.forEach(function(lineItem){lineItem.creativeType===protos.ProtoCreativeTypeEnum.External&&(lineItem.headerBidderBids&&"[]"!==lineItem.headerBidderBids?lineItem.creativeType=protos.ProtoCreativeTypeEnum.HeaderBidder:lineItem.externalMediaFile||lineItem.externalHlsFile?lineItem.creativeType=protos.ProtoCreativeTypeEnum.MediaFile:lineItem.creativeType=protos.ProtoCreativeTypeEnum.ThirdParty)});var lineItemsToAddFiltered=this._filterOutLineItemsThatCantWin(lineItemsToAdd),disableScrollHijackEnforcement=Object(TypeUtils.a)(this.apiConfig.settings.rendering.scrollHijackingProtection)?this.apiConfig.settings.rendering.scrollHijackingProtection:_playerResponse.scrollHijackingProtection;this.lineItemSettings={lineItems:lineItemsToAddFiltered,disableScrollHijackEnforcement:disableScrollHijackEnforcement},this.midRollNumber=Object(TypeUtils.a)(this.apiConfig.settings.advertising.maxNumberOfMidRolls)?this.apiConfig.settings.advertising.maxNumberOfMidRolls:_playerResponse.midRollNumber,this.adViewabilityPolicy=_playerResponse.adViewabilityPolicy,this.preRollBreak=(Object(TypeUtils.a)(this.apiConfig.settings.advertising.preRollBreak)?this.apiConfig.settings.advertising.preRollBreak:_playerResponse.preRollBreak)*TimeConfig.f,this.postRollBreak=(Object(TypeUtils.a)(this.apiConfig.settings.advertising.postRollBreak)?this.apiConfig.settings.advertising.postRollBreak:_playerResponse.postRollBreak)*TimeConfig.f,this.playerId=_playerResponse.playerId,this.floatingSettings.floatingMode===protos.ProtoPlayerFloatingMode.Always?this.closeButtonMode=this.floatingSettings.floatingCloseButtonMode:this.closeButtonMode=Object(TypeUtils.a)(this.apiConfig.settings.customization.closeButtonMode)?this.apiConfig.settings.customization.closeButtonMode:_playerResponse.closeButtonMode,this.isCloseButton=!!this.closeButtonMode||!!this.floatingSettings.floatingCloseButtonMode,this.uiComponentsVisibility={casting:!1,expandButton:Object(TypeUtils.a)(this.apiConfig.settings.customization.showExpandButton)?this.apiConfig.settings.customization.showExpandButton:_playerResponse.expandButton},this.sharingDestinations=void 0,this.adPlaybackMode=_playerResponse.adPlaybackMode,Object(TypeUtils.a)(this.apiConfig.settings.disableClickUrl)&&(this.disableClickUrl=this.apiConfig.settings.disableClickUrl);var skipAdAfter=(apiConfig.settings.advertising.skipAdSettings||{}).skipAdAfter,adSkippability=(apiConfig.settings.advertising.skipAdSettings||{}).adSkippability,adsMustBeSkippableIfLongerThan=(apiConfig.settings.advertising.skipAdSettings||{}).adsMustBeSkippableIfLongerThan;this.skipAdAfter=Object(TypeUtils.a)(skipAdAfter)?skipAdAfter:_playerResponse.skipAdAfter,this.adSkippability=Object(TypeUtils.a)(adSkippability)?adSkippability:_playerResponse.adSkippability,Object(TypeUtils.a)(adsMustBeSkippableIfLongerThan)?adsMustBeSkippableIfLongerThan>0&&adsMustBeSkippableIfLongerThan<=MonetizationConfig.d&&(this.adsMustBeSkippableIfLongerThan=adsMustBeSkippableIfLongerThan):Object(TypeUtils.a)(adSkippability)||_playerResponse.adsMustBeSkippableIfLongerThan&&(this.adsMustBeSkippableIfLongerThan=_playerResponse.adsMustBeSkippableIfLongerThan),(apiConfig.settings._connatixInternals.disableTracking||isServerlessMode||this.isSeoTraffic)&&(this.disableTracking=!0),this.sessionId=this._playerResponse.sessionId,this.moatTrackingEnabled=this.lineItemSettings.lineItems.some(function(lineItem){return lineItem.moatTrackingEnabled})}return createClass_default()(PlayerModel,[{key:"_overwriteLineItem",value:function(apiLineItem,protoLineItem){protoLineItem.adTag=Object(TypeUtils.a)(apiLineItem.url)?apiLineItem.url:protoLineItem.adTag,protoLineItem.requestCap=Object(TypeUtils.a)(apiLineItem.contentRequestCap)?apiLineItem.contentRequestCap:protoLineItem.requestCap,protoLineItem.impressionCap=Object(TypeUtils.a)(apiLineItem.contentImpressionCap)?apiLineItem.contentImpressionCap:protoLineItem.impressionCap,protoLineItem.viewability=Object(TypeUtils.a)(apiLineItem.viewability)?apiLineItem.viewability:protoLineItem.viewability,protoLineItem.sound=Object(TypeUtils.a)(apiLineItem.sound)?apiLineItem.sound:protoLineItem.sound,protoLineItem.ignoreFilledRequests=Object(TypeUtils.a)(apiLineItem.ignoreFilledRequests)?apiLineItem.ignoreFilledRequests:protoLineItem.ignoreFilledRequests,protoLineItem.headerBidderBids=Object(TypeUtils.a)(apiLineItem.headerBidderBids)?apiLineItem.headerBidderBids:protoLineItem.headerBidderBids,protoLineItem.headerBidderTimeout=Object(TypeUtils.a)(apiLineItem.headerBidderTimeout)?apiLineItem.headerBidderTimeout:protoLineItem.headerBidderTimeout,protoLineItem.resetRequestsCapTime=Object(TypeUtils.a)(apiLineItem.resetRequestsCapTime)?apiLineItem.resetRequestsCapTime:protoLineItem.resetRequestsCapTime,protoLineItem.resetImpressionsCapTime=Object(TypeUtils.a)(apiLineItem.resetImpressionsCapTime)?apiLineItem.resetImpressionsCapTime:protoLineItem.resetImpressionsCapTime,protoLineItem.resetCapType=Object(TypeUtils.a)(apiLineItem.resetCapType)?apiLineItem.resetCapType:protoLineItem.resetCapType,protoLineItem.timeBetweenRequests=Object(TypeUtils.a)(apiLineItem.timeBetweenRequests)?apiLineItem.timeBetweenRequests:protoLineItem.timeBetweenRequests,protoLineItem.skipMode=Object(TypeUtils.a)(apiLineItem.skipMode)?apiLineItem.skipMode:protoLineItem.skipMode,protoLineItem.floorPrice=Object(TypeUtils.a)(apiLineItem.floorPrice)?apiLineItem.floorPrice:protoLineItem.floorPrice,protoLineItem.adBreakSettings=Object(TypeUtils.a)(apiLineItem.adBreakSettings)?apiLineItem.adBreakSettings:protoLineItem.adBreakSettings,protoLineItem.pauseAdOutOfView=Object(TypeUtils.a)(apiLineItem.pauseAdOutOfView)?apiLineItem.pauseAdOutOfView:protoLineItem.pauseAdOutOfView}},{key:"_mergeAdBreaks",value:function(){this._checkAndAddBreak(this.apiConfig.settings.advertising.preRollBreak,protos.ProtoAdBreakTypeEnum.PreRoll),this._checkAndAddBreak(this.apiConfig.settings.advertising.postRollBreak,protos.ProtoAdBreakTypeEnum.PostRoll),this._checkAndAddBreak(this.apiConfig.settings.advertising.maxNumberOfMidRolls,protos.ProtoAdBreakTypeEnum.MidRoll)}},{key:"_checkAndAddBreak",value:function(jsApiValue,roll){var jsApiAdBreak=this._getRollFromBreak(this.apiConfig.settings.advertising.adBreaks,roll),playerAdBreak=this._getRollFromBreak(this._playerResponse.adBreaks,roll),defaultAdBreak={maxAdPodDuration:0,maxAdSlotDuration:0,numberOfAdSlots:1,types:[roll]};jsApiAdBreak?this.adBreaks.push(jsApiAdBreak):!Object(TypeUtils.a)(jsApiValue)||jsApiAdBreak||playerAdBreak?!jsApiAdBreak&&playerAdBreak&&this.adBreaks.push(playerAdBreak):this.adBreaks.push(defaultAdBreak)}},{key:"_getRollFromBreak",value:function(adBreaks,roll){var foundAdBreak;if(adBreaks)return adBreaks.forEach(function(adBreak){adBreak.types.includes(roll)&&((foundAdBreak=Object.assign({},adBreak)).types=[roll])}),foundAdBreak}},{key:"_filterOutLineItemsThatCantWin",value:function(lineItems){var _this2=this,adBreaks=this.adBreaks,incompatibleLineItems=lineItems,flatAdBreaks=[];return adBreaks.forEach(function(adBreak){adBreak.types.forEach(function(type){return flatAdBreaks.push(Object.assign(Object.assign({},adBreak),{types:[type]}))})}),flatAdBreaks.forEach(function(adBreak){incompatibleLineItems=_this2.removeCompatibleLineItems(adBreak,incompatibleLineItems)}),lineItems.filter(function(lineItem){return!incompatibleLineItems.includes(lineItem)})}},{key:"removeCompatibleLineItems",value:function(adBreak,remainingLineItems){var adRollType=adBreak.types[0],adBreakType=adBreak.numberOfAdSlots>1?protos.ProtoLineItemAdBreakTypeEnum.AdPod:protos.ProtoLineItemAdBreakTypeEnum.SingleAd;return remainingLineItems.filter(function(lineItem){return!lineItem.adBreakSettings.adBreakTargeting.some(function(lineItemAdBreakSetting){return lineItemAdBreakSetting.adRollType===adRollType&&(lineItemAdBreakSetting.adBreakTypeEnum===protos.ProtoLineItemAdBreakTypeEnum.All||lineItemAdBreakSetting.adBreakTypeEnum===adBreakType)})})}},{key:"_sanitizeLineItems",value:function(lineItems){var _this3=this;lineItems.forEach(function(lineItem){lineItem.adBreakSettings||_this3._addDefaultAdBreakSettings(lineItem),_this3._fallbackUnlimitedRequestCap(lineItem)})}},{key:"_addDefaultAdBreakSettings",value:function(lineItem){lineItem.adBreakSettings={adBreakTargeting:[{adRollType:protos.ProtoAdBreakTypeEnum.PreRoll,adBreakTypeEnum:protos.ProtoLineItemAdBreakTypeEnum.All},{adRollType:protos.ProtoAdBreakTypeEnum.MidRoll,adBreakTypeEnum:protos.ProtoLineItemAdBreakTypeEnum.All},{adRollType:protos.ProtoAdBreakTypeEnum.PostRoll,adBreakTypeEnum:protos.ProtoLineItemAdBreakTypeEnum.All}]}}},{key:"_fallbackUnlimitedRequestCap",value:function(lineItem){0===lineItem.requestCap&&(lineItem.requestCap=20)}},{key:"_sanitizeAdBreaks",value:function(){this.adBreaks.forEach(function(adBreak){adBreak.maxAdSlotDuration*=TimeConfig.f,adBreak.maxAdPodDuration*=TimeConfig.f,adBreak.numberOfAdSlots<=1?adBreak.maxAdPodDuration=0:adBreak.maxAdSlotDuration>adBreak.maxAdPodDuration&&(adBreak.maxAdSlotDuration=adBreak.maxAdPodDuration)})}},{key:"_mergeLineItems",value:function(apiLineItem,lineItemProto){var newLineItem=Object.assign({},lineItemProto);return this._overwriteLineItem(apiLineItem,newLineItem),Object(TypeUtils.a)(apiLineItem.externalMediaFile)&&(newLineItem.externalMediaFile=apiLineItem.externalMediaFile),Object(TypeUtils.a)(apiLineItem.externalHlsFile)&&(newLineItem.externalHlsFile=apiLineItem.externalHlsFile),newLineItem.customCpm=apiLineItem.cpm,newLineItem}},{key:"_getDefaultLineItem",value:function(){return protos.ProtoLineItem.toObject(protos.ProtoLineItem.fromObject({}),{defaults:!0,arrays:!0,objects:!0})}}]),PlayerModel}());function defaultPlayerInitFromProto(protoResponseObject,protoPlayerObject){var protoDefaultValues=protoResponseObject.toObject({},{defaults:!0,arrays:!0,objects:!0}),defaultPlayerData=function(protoPlayerObject){return protoPlayerObject.toObject({},{defaults:!0,arrays:!0,objects:!0})}(protoPlayerObject);return protoDefaultValues.players.push(defaultPlayerData),protoDefaultValues.browser=protos.Browser.toObject(protos.Browser.fromObject({}),{defaults:!0,arrays:!0,objects:!0}),protoDefaultValues.geoLocation=protos.GeoLocation.toObject(protos.GeoLocation.fromObject({}),{defaults:!0,arrays:!0,objects:!0}),protoDefaultValues}var OmidConfig=__webpack_require__(37);function OmidViewabilityService_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var OmidViewabilityService_OmidViewabilityService=function(_ExternalViewabilityS){inherits_default()(OmidViewabilityService,_ExternalViewabilityS);var _super=OmidViewabilityService_createSuper(OmidViewabilityService);function OmidViewabilityService(_global,_inAppSDK){var _this;classCallCheck_default()(this,OmidViewabilityService),(_this=_super.call(this))._global=_global;try{_this._observer=new Observer_Observer,_this._init()}catch(e){Object(Logging.a)({message:"omid_verification_client_error",exception:e.message,callStack:e.callStack,level:_inAppSDK?protos.ProtoLoggingLevelEnum.FATAL:protos.ProtoLoggingLevelEnum.INFO})}return _this}return createClass_default()(OmidViewabilityService,[{key:"subscribe",value:function(event,callback){return this._observer.on(event,callback)}},{key:"_init",value:function(){var ClientConstructor=this._getClientConstructor();if(this._verificationClient=new ClientConstructor,!this._verificationClient.isSupported())throw new Error("omid_not_implemented");this._registerSessionObserver(),this._subscribeToEvents()}},{key:"_getClientConstructor",value:function(){if(!this._global.OmidVerificationClient)throw new Error("omid_verification_client_not_found");if(!this._global.OmidVerificationClient[OmidConfig.k])throw new Error("omid_verification_client_wrong_version");return this._global.OmidVerificationClient[OmidConfig.k]}},{key:"_registerSessionObserver",value:function(){this._verificationClient.registerSessionObserver(function(omidEvent){omidEvent&&omidEvent.type===OmidConfig.e.sessionError&&Object(Logging.a)({message:"omid_verification_client_session_error",exception:omidEvent.data.message,level:protos.ProtoLoggingLevelEnum.WARNING})})}},{key:"_subscribeToEvents",value:function(){var _this2=this;this._verificationClient.addEventListener(OmidConfig.e.geometryChange,function(omidEvent){try{var _omidEvent$data$adVie=omidEvent.data.adView,percentageInView=_omidEvent$data$adVie.percentageInView,reasons=_omidEvent$data$adVie.reasons,isBackgrounded=[OmidConfig.a.backgrounded,OmidConfig.a.notFound].some(function(backgroundedReason){return reasons.includes(backgroundedReason)});_this2._setIsBackgrounded(isBackgrounded);var threshold=percentageInView/100;_this2.setViewableThreshold(threshold),_this2._observer.trigger(ApiConfig.d.OmidViewabilityThreshold,threshold)}catch(e){Object(Logging.a)({message:"omid_verification_client_geometry_change_error",exception:e.message,callStack:e.callStack,level:protos.ProtoLoggingLevelEnum.FATAL,throttle:1})}})}}]),OmidViewabilityService}(ExternalViewabilityService_ExternalViewabilityService),PLAYSPACE_CSS_ID="cnx-playspace-css-".concat(EnvironmentConfig.a.version);function PlayspaceLoader_createSuper(Derived){return function(){var result,Super=getPrototypeOf_default()(Derived);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var _GLOBAL_NAMESPACE_MAP,BundleDomainsEnum,PlayspaceLoader_PlayspaceLoader=function(_Loader){inherits_default()(PlayspaceLoader,_Loader);var _super=PlayspaceLoader_createSuper(PlayspaceLoader);function PlayspaceLoader(){return classCallCheck_default()(this,PlayspaceLoader),_super.apply(this,arguments)}return createClass_default()(PlayspaceLoader,[{key:"_getCssScriptData",value:function(){return{id:PLAYSPACE_CSS_ID,src:EndPointResolver.a.endPoints.assets.css.playspace}}},{key:"getDelegateHandler",value:function(){var _this=this;return{getCurrentVolume:function(){return _this.renderer.getApiMethods().getVolume()}}}},{key:"getRendererInstance",value:function(playerModel,app,reloadData,appSettings){return new PlayspaceRenderer_PlayspaceRenderer(this,playerModel,app,reloadData,appSettings)}},{key:"getViewabilityService",value:function(playerModel,pageFocusService){var forceFallbackImplementation=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.externalAttributes.settings.useExternalViewabilityService?new ExternalViewabilityService_ExternalViewabilityService:this._isInApp?new OmidViewabilityService_OmidViewabilityService(window,this._isInAppSDK):new ViewabilityService_ViewabilityService(playerModel.global,pageFocusService,forceFallbackImplementation)}},{key:"getPlayerResponse",value:function(requestData,playerId){var _this2=this;return new Promise(function(resolve,reject){XhrUtils.a.sendProtoRequest({ProtoResponse:ProtoModels_Generated_protos.ProtoPlayspaceResponse,ProtoRequest:ProtoModels_Generated_protos.ProtoPlayspaceRequest,requestData:requestData,endpoint:EndPointResolver.a.endPoints.api.story,withCredentials:!0,queryParams:defineProperty_default()({},PlayerConfig.b,EnvironmentConfig.a.version),logError:!0}).then(function(playerResponse){window.parent.connatixDummy&&Object(HrefUtils.b)("connatixDummy",_this2.pageUrl)&&(playerResponse.players[0]=Object.assign(Object.assign({},playerResponse.players[0]),window.parent.connatixDummy)),resolve(playerResponse)}).catch(function(e){_this2.GLOBAL.cnxDummyResponse?resolve(_this2.GLOBAL.cnxDummyResponse):reject(e)})})}},{key:"getPlayerModel",value:function(insertData,playerResponse,suffixerService,index){return new PlayspacePlayerModel_PlayspacePlayerModel(insertData.insertWindow?insertData.insertWindow:this.GLOBAL,insertData.insertContainer,playerResponse.players[index],playerResponse.browser.device,playerResponse.secondLevelDomain,this.externalAttributes,this.isServerlessMode,playerResponse.supplyChain,suffixerService,this.queryParams.cnxVideoPosition,this.queryParams.cnxStoryPosition,playerResponse.isSeoTraffic||this.queryParams.cnxIsSeoTraffic)}},{key:"getApiConfigEnums",value:function(){return PlayspaceConfigEnum}},{key:"getApiConfigEvents",value:function(){return PlayspaceConfigEvents}},{key:"getSpecificRequestData",value:function(){var requestData={};return this.queryParams.cnxStoryId?requestData.forceStoryId=this.queryParams.cnxStoryId:this.externalAttributes.storyId&&(requestData.forceStoryId=this.externalAttributes.storyId),requestData}},{key:"defaultInitFromProto",value:function(){return defaultPlayerInitFromProto(ProtoModels_Generated_protos.ProtoPlayspaceResponse,ProtoModels_Generated_protos.ProtoPlayspace)}},{key:"_stripDownJsApiConfigForGroupScript",value:function(){get_default()(getPrototypeOf_default()(PlayspaceLoader.prototype),"_stripDownJsApiConfigForGroupScript",this).call(this),this.externalAttributes.settings.story=void 0}}]),PlayspaceLoader}(Loader.a),ABService=__webpack_require__(53),CnxTrackingEventsEnum=__webpack_require__(21),EventsStorageService_EventsStorageService=function(){function EventsStorageService(){var _debugLogging=arguments.length>0&&void 0!==arguments[0]&&arguments[0];classCallCheck_default()(this,EventsStorageService),this._debugLogging=_debugLogging,this._eventEmitted="eventEmitted",this._observer=new Observer_Observer}return createClass_default()(EventsStorageService,[{key:"subscribe",value:function(callback){return this._observer.on(this._eventEmitted,callback)}},{key:"unsubscribe",value:function(callback){this._observer.remove(this._eventEmitted,callback)}},{key:"emitSessionStart",value:function(data){var metadata={videoMetadata:data};this._emitEvent({metadata:metadata,name:CnxTrackingEventsEnum.a.SessionStart})}},{key:"emitContentComplete",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.ContentComplete})}},{key:"emitSessionEnd",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.SessionEnd})}},{key:"emitPlay",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.Play})}},{key:"emitPause",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.Pause})}},{key:"emitAdPlay",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdPlay})}},{key:"emitAdPause",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdPause})}},{key:"emitAdPlaying",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdPlaying})}},{key:"emitAdPaused",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdPaused})}},{key:"emitAdImpression",value:function(adMetadata,customAdMetadata){var metadata={adMetadata:adMetadata,customAdMetadata:customAdMetadata};this._emitEvent({metadata:metadata,name:CnxTrackingEventsEnum.a.AdImpression})}},{key:"emitAdComplete",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdComplete})}},{key:"emitAdStopped",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdStopped})}},{key:"emitAdBreakStart",value:function(adBreakMetadata){var metadata={adBreakMetadata:adBreakMetadata};this._emitEvent({metadata:metadata,name:CnxTrackingEventsEnum.a.AdBreakStart})}},{key:"emitAdBreakComplete",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdBreakComplete})}},{key:"emitPlayerResized",value:function(dimensions){var metadata={playerDimensionsMetadata:dimensions};this._emitEvent({metadata:metadata,name:CnxTrackingEventsEnum.a.PlayerResized})}},{key:"emitOnEnterFullscreen",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.OnEnterFullscreen})}},{key:"emitOnExitFullscreen",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.OnExitFullscreen})}},{key:"emitOnPlayerCollapsed",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.PlayerCollapsed})}},{key:"emitOnPlayerExpanded",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.PlayerExpanded})}},{key:"emitAdError",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdError})}},{key:"emitPlayError",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.PlayError})}},{key:"emitRenderError",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.RenderError})}},{key:"emitAdClickThru",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdClickThru})}},{key:"emitAdInteraction",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdInteraction})}},{key:"emitAdVideoStart",value:function(adVideoStartMetadata){var metadata={adVideoStartMetadata:adVideoStartMetadata};this._emitEvent({metadata:metadata,name:CnxTrackingEventsEnum.a.AdVideoStart})}},{key:"emitAdLoaded",value:function(adLoadedMetadata){var metadata={adLoadedMetadata:adLoadedMetadata};this._emitEvent({metadata:metadata,name:CnxTrackingEventsEnum.a.AdLoaded})}},{key:"emitAdStateChange",value:function(adStateChangedMetadata){var metadata={adStateChangedMetadata:adStateChangedMetadata};this._emitEvent({metadata:metadata,name:CnxTrackingEventsEnum.a.AdStateChange})}},{key:"emitAdVideoFirstQuartile",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdVideoFirstQuartile})}},{key:"emitAdVideoMidpoint",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdVideoMidpoint})}},{key:"emitAdVideoThirdQuartile",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdVideoThirdQuartile})}},{key:"emitAdVideoComplete",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdVideoComplete})}},{key:"emitVolumeChange",value:function(volume){this._emitEvent({name:CnxTrackingEventsEnum.a.VolumeChange,metadata:{volume:volume}})}},{key:"emitAdVolumeChange",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdVolumeChange})}},{key:"emitAdSkipped",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.AdSkipped})}},{key:"_emitEvent",value:function(event){this._debugLogging&&console.log("Connatix Player Elements debugging: ",event),this._observer.trigger(this._eventEmitted,event)}},{key:"destroy",value:function(){this._emitEvent({name:CnxTrackingEventsEnum.a.Destroy}),this._observer.removeAll()}}]),EventsStorageService}(),UrlSuffixerService=__webpack_require__(104);!function(BundleDomainsEnum){BundleDomainsEnum.connatix="connatix.com",BundleDomainsEnum.elements="elements.video"}(BundleDomainsEnum||(BundleDomainsEnum={}));_GLOBAL_NAMESPACE_MAP={},defineProperty_default()(_GLOBAL_NAMESPACE_MAP,BundleDomainsEnum.connatix,"cnx"),defineProperty_default()(_GLOBAL_NAMESPACE_MAP,BundleDomainsEnum.elements,"cnxel");var parentWindow=window.parent,playspaceLoaderList=[];window.addEventListener("unload",function(e){playspaceLoaderList.forEach(function(loader){return loader.destroy()})});var main_topWindow=Object(GeneralUtils.f)(parentWindow).topFrame;ABService.a.abServiceType=ABService.b.PlayspaceABService;var main_initConnatixPlayer=function(apiConfig,scriptId,readyCallback){var _a,_b,isInApp=Object(TypeUtils.h)(apiConfig._appSettings.bundleID),isInAppSDK=Object(TypeUtils.h)(apiConfig._appSettings.sdkVersion);if(isInAppSDK){var sdkMajorVersion=parseInt(apiConfig._appSettings.sdkVersion.substr(0,1),10);apiConfig.settings.useExternalViewabilityService=!(sdkMajorVersion>=3)}var _apiConfig$_appSettin=apiConfig._appSettings,cmp=_apiConfig$_appSettin.cmp,tcf=_apiConfig$_appSettin.tcf,usPrivacyString=_apiConfig$_appSettin.usPrivacyString,deviceID=_apiConfig$_appSettin.deviceID,isAmp=function(apiConfig,GLOBAL){return GLOBAL.AMP_CONTEXT_DATA||apiConfig.settings.implementationType===protos.ProtoImplementationType.Amp}(apiConfig,parentWindow),services={UserManagerService:new UserManagerService.b(parentWindow,isInApp,isAmp,{cmp:cmp,tcf:tcf,usPrivacyString:usPrivacyString,deviceID:deviceID}),EventsStorageService:new EventsStorageService_EventsStorageService(apiConfig.settings.plugins._debugLogging),UrlSuffixerService:new UrlSuffixerService.a},loader=new PlayspaceLoader_PlayspaceLoader(services,parentWindow,isInApp,isAmp,isInAppSDK,!1,readyCallback);playspaceLoaderList.push(loader);var addCss=function(){var scriptData={id:PLAYSPACE_CSS_ID,src:EndPointResolver.a.endPoints.assets.css.playspace};Object(GeneralUtils.k)(function(){return function(scriptData){return new Promise(function(resolve,reject){if(Object(DomUtils.m)(scriptData.id,main_topWindow))return resolve();Object(DomUtils.B)(scriptData,main_topWindow.document.head,main_topWindow,function(){return resolve()},function(e){return reject(e)})||reject()})}(scriptData)}).catch(function(e){throw Object(Logging.a)({message:"Prerender_Playspace_Loader_add_css_link",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.INFO,throttle:1e3}),e}).then(function(){try{Object(DomUtils.W)(parentWindow),loader.updateQueryParams(),loader.loadScriptTag(apiConfig,scriptId)?loader.insertRenderer():Object(Logging.a)({message:"Prerender_Playspace_main_no_script_tag",level:protos.ProtoLoggingLevelEnum.INFO,throttle:1e3})}catch(e){Object(Logging.a)({message:"Prerender_Playspace_main_insertRenderer",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.INFO,throttle:1e3})}}).catch(function(){})};isInApp?addCss():loader.findPageUrl(parentWindow,null===(_b=null===(_a=apiConfig)||void 0===_a?void 0:_a.settings)||void 0===_b?void 0:_b.ampUrl).then(function(){return addCss()}).catch(function(e){Object(Logging.a)({message:"Prerender_Playspace_main_init",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.INFO,throttle:1e3}),loader.registerApiError()})},main_sanitizeConfigSettings=function(config){var _a,_b,_c,_d,_e,auxConfig=Object.assign({},config),existingCMP=null===(_a=auxConfig._appSettings)||void 0===_a?void 0:_a.cmp;(Object(TypeUtils.h)(null===(_b=auxConfig._appSettings)||void 0===_b?void 0:_b.gdprConsentString)||Object(TypeUtils.h)(null===(_c=auxConfig._appSettings)||void 0===_c?void 0:_c.gdprParsedVendorString))&&(auxConfig._appSettings.cmp={consentString:Object(TypeUtils.h)(null===(_d=existingCMP)||void 0===_d?void 0:_d.consentString)?existingCMP.consentString:auxConfig._appSettings.gdprConsentString,parsedVendorConsents:Object(TypeUtils.h)(null===(_e=existingCMP)||void 0===_e?void 0:_e.parsedVendorConsents)?existingCMP.parsedVendorConsents:auxConfig._appSettings.gdprParsedVendorString});var cmp=Object.assign({},sanitizeDfpMacros(Object.assign({},auxConfig._appSettings.cmp))),tcf=Object.assign({},sanitizeDfpMacros(Object.assign({},auxConfig._appSettings.tcf))),_sanitizeDfpMacros=sanitizeDfpMacros({usPrivacyString:auxConfig._appSettings.usPrivacyString,deviceID:auxConfig._appSettings.deviceID,appPageURL:auxConfig._appSettings.appPageURL}),usPrivacyString=_sanitizeDfpMacros.usPrivacyString,deviceID=_sanitizeDfpMacros.deviceID,appPageURL=_sanitizeDfpMacros.appPageURL;return auxConfig._appSettings=Object.assign(Object.assign({},auxConfig._appSettings),{cmp:cmp,tcf:tcf,usPrivacyString:usPrivacyString,deviceID:deviceID,appPageURL:appPageURL}),auxConfig};try{!function(){if(-1===navigator.userAgent.toLowerCase().indexOf("msie")){EndPointResolver.a.bundleDomain=BundleDomainsEnum.connatix;var commands=[];parentWindow.cnxps&&(commands=parentWindow.cnxps.cmd),parentWindow.cnxps=function(){function cnxps(config){var _a,_b;config.settings=config.settings||{},config._appSettings=config._appSettings||{},config._appSettings.cmp=config._appSettings.cmp||{},config._appSettings.tcf=config._appSettings.tcf||{},config.settings.customization=config.settings.customization||{},config.settings.rendering=config.settings.rendering||{},config.settings.advertising=config.settings.advertising||{},config.settings._connatixInternals=config.settings._connatixInternals||{},config.settings.plugins=config.settings.plugins||{},config.settings.advertising.skipAdSettings=config.settings.advertising.skipAdSettings||{};return["602660809","com.thomsonreuters.reuters","12345","com.cnx.androidsdkapp"].includes(null===(_b=null===(_a=config)||void 0===_a?void 0:_a._appSettings)||void 0===_b?void 0:_b.bundleID)&&Object(Logging.a)({level:protos.ProtoLoggingLevelEnum.INFO,message:"CNX_REUTERS_APPSETTINGS",exception:JSON.stringify(config._appSettings)}),config=main_sanitizeConfigSettings(config),{render:function(scriptId,onReadyCallback){try{main_initConnatixPlayer(config,scriptId,onReadyCallback)}catch(e){Object(Logging.a)({message:"Prerender_Playspace_main_initPlayer",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.INFO,throttle:1e3})}}}}return cnxps.cmd={push:function(cb){try{cb()}catch(e){Object(Logging.a)({message:"Prerender_Playspace_main_push_callback",level:protos.ProtoLoggingLevelEnum.INFO,exception:e.message,callStack:e.stack,throttle:1e3})}}},cnxps.configEnums=PlayspaceConfigEnum,cnxps.configEvents=PlayspaceConfigEvents,cnxps}(),commands.forEach(function(cb){try{cb()}catch(e){Object(Logging.a)({message:"Prerender_Playspace_main_commands_callback",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.INFO,throttle:1e3})}})}else Object(Logging.a)({message:"Prerender_Playspace_main_IE_check",level:protos.ProtoLoggingLevelEnum.INFO,throttle:1e3})}()}catch(e){Object(Logging.a)({message:"Prerender_Playspace_main",exception:e.message,callStack:e.stack,level:protos.ProtoLoggingLevelEnum.INFO,throttle:1e3})}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return filter});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(31),_Subscriber__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(40);function filter(predicate,thisArg){return function(source){return source.lift(new FilterOperator(predicate,thisArg))}}var FilterOperator=function(){function FilterOperator(predicate,thisArg){this.predicate=predicate,this.thisArg=thisArg}return FilterOperator.prototype.call=function(subscriber,source){return source.subscribe(new FilterSubscriber(subscriber,this.predicate,this.thisArg))},FilterOperator}(),FilterSubscriber=function(_super){function FilterSubscriber(destination,predicate,thisArg){var _this=_super.call(this,destination)||this;return _this.predicate=predicate,_this.thisArg=thisArg,_this.count=0,_this}return tslib__WEBPACK_IMPORTED_MODULE_0__.a(FilterSubscriber,_super),FilterSubscriber.prototype._next=function(value){var result;try{result=this.predicate.call(this.thisArg,value,this.count++)}catch(err){return void this.destination.error(err)}result&&this.destination.next(value)},FilterSubscriber}(_Subscriber__WEBPACK_IMPORTED_MODULE_1__.a)}]);