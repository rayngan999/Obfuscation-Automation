(this.dmpJsonp=this.dmpJsonp||[]).push([["videolist"],{sXAN:function(e,a,t){"use strict";t.r(a),t.d(a,"VideoList",function(){return E});var d=t("znKg"),u=t("2mXy"),o=t("/MKj"),r=t("MOxe"),s=t("peh1"),i=t("GESe"),n=t("idq+"),l=t("Zrx9"),c=t("W1we"),g='    query playerQueueQuery($videoId:String!,$page:Int!,$videoPerPage:Int!){player(videoXid:$videoId){queue{hasAutoPlayNext name videos(page:$page,first:$videoPerPage){edges{node{...fields}}}}}video(xid:$videoId){...fields}}fragment fields on Video{title xid duration thumbnailURL(size:"x240")}',p='query playerQueueQuery($videoId:String!,$page:Int!,$videoPerPage:Int!){player(videoXid:$videoId){queue{hasAutoPlayNext name videos(page:$page,first:$videoPerPage){edges{node{...fields}}}}}}fragment fields on Video{title xid duration thumbnailURL(size:"x240")}',q=' query playerPlaylistQueueQuery($playlistId:String!,$page:Int!,$videoPerPage:Int!){collection(xid:$playlistId){name videos(page:$page,first:$videoPerPage){edges{node{...fields}}}}}fragment fields on Video{title xid duration thumbnailURL(size:"x240")}',y=t("eeF7"),P=t("VfPQ"),v=t("bwe7"),m=l.default.get("Queue"),h=10,I=30,f={},b=!1,x,S={cancel:()=>{b&&x&&(x.cancel(),x=void 0)},toCancelToken:()=>{S.cancel(),b=!0;var e=Object(c.b)();return x=e,e.token},stop:()=>{b=!1,x=void 0}},$=function e(a,t){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.d,u=10,o,r="video_".concat(a),s="".concat(t,"_").concat(u);return f.requested===r&&s in f?o=Promise.resolve(f[s]):(f.requested!==r&&(f={}),o=d({name:"playerQueueQuery",query:1===t?g:p,variables:{videoId:a,page:t,videoPerPage:u},cancelToken:S.toCancelToken()})),o.finally(()=>{S.stop()}).then(e=>{f.requested=r,f[s]=e;var a=e.player.queue.videos.edges.map(e=>{var a=e.node;return a});return{name:e.player.queue.name,hasAutoPlayNext:e.player.queue.hasAutoPlayNext,videos:1===t?[e.video,...a]:a,isLastPage:a.length<u}})},L=function e(a,t,d){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c.d,o=30,r=-1,s,i="playlist_".concat(a),n="".concat(t,"_").concat(o);return f.requested===i&&n in f?s=Promise.resolve(f[n]):(f.requested!==i&&(f={}),s=u({name:"playerPlaylistQueueQuery",query:q,variables:{playlistId:a,page:t,videoPerPage:o},cancelToken:S.toCancelToken()})),s.finally(()=>{S.stop()}).then(e=>{f.requested=i,f[n]=e;var a=e.collection.videos.edges.map((e,a)=>{var t=e.node;return t.xid===d.xid&&(r=a),t});return 1===t&&(-1!==r&&a.splice(r,1),a.unshift(d)),{name:e.collection.name,hasAutoPlayNext:!0,videos:a,isLastPage:a.length<o}})},T=(e,a)=>{var t=a.started,d=a.ended,u=a.canceled,o=a.errored;t(),e.then(d,e=>{e&&e.type===c.a?u():o(e)})},j=Object(v.a)({metadataAccessId:P.b,metadataPosters:P.F,metadataDuration:P.j,metadataTitle:P.U,queuePage:n.n,queueIsLastPage:n.i,queueNextPageRequested:n.m,queueSourceType:n.s,queueSourceXid:n.u,queueHasPlaylistIdNotFoundError:n.h}),O=e=>{var a=a=>{e(Object(y.k)(a))},t=()=>{e(Object(y.h)())},d=a=>{"not_found"===a.type?e(Object(y.l)({error:a.message})):e(Object(y.j)({error:a.message}))},u=a=>{e(Object(y.i)(a))};return{started:a,canceled:t,errored:d,ended:u}},A;class N extends u.Component{load(e){var a=this.props,t=a.queueSourceType,d=1===e?{duration:a.metadataDuration,thumbnailURL:a.metadataPosters[120],title:a.metadataTitle,xid:a.metadataAccessId}:A,u;if(A=d,"playlist"===t){var o=a.queueSourceXid;u=o}else u=A.xid;var r={started:()=>{m.log("queue load started",{accessId:u,page:e,queueSourceType:t}),a.started({page:e})},canceled:()=>{m.log("queue load cancelled",{accessId:u,page:e,queueSourceType:t}),a.canceled()},errored:d=>{m.error("queue load errored",{accessId:u,page:e,queueSourceType:t},d.message),a.errored(d)},ended:d=>{m.log("queue load ended",{accessId:u,page:e,queueSourceType:t},d),a.ended(d)}};T("playlist"===t?L(u,e,A):$(u,e),r)}componentDidMount(){var e=this.props;-1===e.queuePage&&e.metadataAccessId?this.load(1):e.queueNextPageRequested&&!e.queueIsLastPage&&this.load(e.queuePage+1)}componentDidUpdate(e){var a=this.props;if(void 0===e.queuePage&&-1===a.queuePage)m.log("Loading queue page 1 because queuePage becomes defined"),this.load(1);else if(-1===a.queuePage&&!e.metadataAccessId&&a.metadataAccessId)m.log("Loading queue page 1 because metadataAccessId changed"),this.load(1);else if(e.queueNextPageRequested||!a.queueNextPageRequested||a.queueIsLastPage)!e.queueHasPlaylistIdNotFoundError&&a.queueHasPlaylistIdNotFoundError&&"auto"!==a.queueSourceType&&(m.warn("Retrying loading queue with sourceType=".concat(a.queueSourceType)),this.load(1));else{var t=a.queuePage+1;m.log("Loading queue page ".concat(t," because nextPageRequested")),this.load(t)}}componentWillUnmount(){S.cancel()}render(){return null}}var Q=Object(o.connect)(j,O)(N),R=t("4VZR"),V=Object(s.createStructuredSelector)({queueVideos:n.x,pesPlayerState:R.a}),k={dispatchPlayerVideoListChange:e=>Object(i.a)({type:d.a.PLAYER_VIDEOLIST_CHANGE,pesPlayerState:e})},C=e=>{var a=e.queueVideos,t=e.pesPlayerState,d=e.dispatchPlayerVideoListChange;return Object(r.d)(()=>{d(t)},[a]),Object(u.h)(Q,null)},E=Object(o.connect)(V,k)(C)}}]);