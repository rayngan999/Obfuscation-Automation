(function(g,c){"function"===typeof define&&define.amd?define(["jquery"],c):"object"===typeof exports?module.exports=c(require("jquery")):g.jquery_dotdotdot_js=c(g.jQuery)})(this,function(g){!function(c){function g(){k=c(window);f={};m={};h={};c.each([f,m,h],function(a,b){b.add=function(a){a=a.split(" ");for(var d=0,c=a.length;d<c;d++)b[a[d]]=b.ddd(a[d])}});f.ddd=function(a){return"ddd-"+a};f.add("truncated keep");m.ddd=function(a){return"ddd-"+a};h.ddd=function(a){return a+".ddd"};h.add("resize");
g=function(){}}if(!(c.dotdotdot&&"3.2.2"<c.dotdotdot.version)){c.dotdotdot=function(a,b){this.$dot=a;this.api="getInstance truncate restore destroy watch unwatch".split(" ");this.opts=b;a=this.$dot.data("dotdotdot");return a&&a.destroy(),this.init(),this.truncate(),this.opts.watch&&this.watch(),this};c.dotdotdot.version="3.2.2";c.dotdotdot.uniqueId=0;c.dotdotdot.defaults={ellipsis:"â¦ ",callback:function(a){},truncate:"word",tolerance:0,keep:null,watch:"window",height:null};c.dotdotdot.prototype={init:function(){this.watchInterval=
this.watchTimeout=null;this.uniqueId=c.dotdotdot.uniqueId++;this.originalStyle=this.$dot.attr("style")||"";this.originalContent=this._getOriginalContent();"break-word"!==this.$dot.css("word-wrap")&&this.$dot.css("word-wrap","break-word");"nowrap"===this.$dot.css("white-space")&&this.$dot.css("white-space","normal");null===this.opts.height&&(this.opts.height=this._getMaxHeight());"string"==typeof this.opts.ellipsis&&(this.opts.ellipsis=document.createTextNode(this.opts.ellipsis))},getInstance:function(){return this},
truncate:function(){this.$inner=this.$dot.wrapInner("\x3cdiv /\x3e").children().css({display:"block",height:"auto",width:"auto",border:"none",padding:0,margin:0});this.$inner.empty().append(this.originalContent.clone(!0));this.maxHeight=this._getMaxHeight();var a=!1;return this._fits()||(a=!0,this._truncateToNode(this.$inner[0])),this.$dot[a?"addClass":"removeClass"](f.truncated),this.$inner.replaceWith(this.$inner.contents()),this.$inner=null,this.opts.callback.call(this.$dot[0],a),a},restore:function(){this.unwatch();
this.$dot.empty().append(this.originalContent).attr("style",this.originalStyle).removeClass(f.truncated)},destroy:function(){this.restore();this.$dot.data("dotdotdot",null)},watch:function(){var a=this;this.unwatch();var b={};"window"==this.opts.watch?k.on(h.resize+a.uniqueId,function(d){a.watchTimeout&&clearTimeout(a.watchTimeout);a.watchTimeout=setTimeout(function(){b=a._watchSizes(b,k,"width","height")},100)}):this.watchInterval=setInterval(function(){b=a._watchSizes(b,a.$dot,"innerWidth","innerHeight")},
500)},unwatch:function(){k.off(h.resize+this.uniqueId);this.watchInterval&&clearInterval(this.watchInterval);this.watchTimeout&&clearTimeout(this.watchTimeout)},_api:function(){var a=this,b={};return c.each(this.api,function(d){var c=this;b[c]=function(){var d=a[c].apply(a,arguments);return"undefined"==typeof d?b:d}}),b},_truncateToNode:function(a){var b=[],d=[];if(c(a).contents().each(function(){var a=c(this);if(!a.hasClass(f.keep)){var e=document.createComment("");a.replaceWith(e);d.push(this);
b.push(e)}}),d.length){for(a=0;a<d.length;a++){c(b[a]).replaceWith(d[a]);c(d[a]).append(this.opts.ellipsis);var e=this._fits();if(c(this.opts.ellipsis,d[a]).remove(),!e){if("node"==this.opts.truncate&&1<a)return void c(d[a-2]).remove();break}}for(e=a;e<b.length;e++)c(b[e]).remove();e=d[Math.max(0,Math.min(a,d.length-1))];if(1==e.nodeType){var l=c("\x3c"+e.nodeName+" /\x3e");l.append(this.opts.ellipsis);c(e).replaceWith(l);this._fits()?l.replaceWith(e):(l.remove(),e=d[Math.max(0,a-1)])}1==e.nodeType?
this._truncateToNode(e):this._truncateToWord(e)}},_truncateToWord:function(a){for(var b=this.__getTextContent(a),d=-1!==b.indexOf(" ")?" ":"ã",b=b.split(d),c="",f=b.length;0<=f;f--)if(c=b.slice(0,f).join(d),this.__setTextContent(a,this._addEllipsis(c)),this._fits()){"letter"==this.opts.truncate&&(this.__setTextContent(a,b.slice(0,f+1).join(d)),this._truncateToLetter(a));break}},_truncateToLetter:function(a){for(var b=this.__getTextContent(a).split(""),d="",c=b.length;0<=c&&(d=b.slice(0,c).join(""),
!d.length||(this.__setTextContent(a,this._addEllipsis(d)),!this._fits()));c--);},_fits:function(){return this.$inner.innerHeight()<=this.maxHeight+this.opts.tolerance},_addEllipsis:function(a){for(var b=" ã,;.!?".split("");-1<c.inArray(a.slice(-1),b);)a=a.slice(0,-1);return a+this.__getTextContent(this.opts.ellipsis)},_getOriginalContent:function(){var a=this;return this.$dot.find("script, style").addClass(f.keep),this.opts.keep&&this.$dot.find(this.opts.keep).addClass(f.keep),this.$dot.find("*").not("."+
f.keep).add(this.$dot).contents().each(function(){var b=c(this);if(3==this.nodeType){if(""==c.trim(a.__getTextContent(this))&&(b.parent().is("table, thead, tbody, tfoot, tr, dl, ul, ol, video")||b.prev().is("div, p, table, td, td, dt, dd, li")||b.next().is("div, p, table, td, td, dt, dd, li")||!b.prev().length||!b.next().length))return void b.remove()}else 8==this.nodeType&&b.remove()}),this.$dot.contents()},_getMaxHeight:function(){if("number"==typeof this.opts.height)return this.opts.height;for(var a=
["maxHeight","height"],b=0,d=0;d<a.length;d++)if(b=window.getComputedStyle(this.$dot[0])[a[d]],"px"==b.slice(-2)){b=parseFloat(b);break}a=[];switch(this.$dot.css("boxSizing")){case "border-box":a.push("borderTopWidth"),a.push("borderBottomWidth");case "padding-box":a.push("paddingTop"),a.push("paddingBottom")}for(d=0;d<a.length;d++){var c=window.getComputedStyle(this.$dot[0])[a[d]];"px"==c.slice(-2)&&(b-=parseFloat(c))}return Math.max(b,0)},_watchSizes:function(a,b,c,e){return this.$dot.is(":visible")?
(b={width:b[c](),height:b[e]()},a.width==b.width&&a.height==b.height||this.truncate(),b):a},__getTextContent:function(a){for(var b=["nodeValue","textContent","innerText"],c=0;c<b.length;c++)if("string"==typeof a[b[c]])return a[b[c]];return""},__setTextContent:function(a,b){for(var c=["nodeValue","textContent","innerText"],e=0;e<c.length;e++)a[c[e]]=b}};c.fn.dotdotdot=function(a){return g(),a=c.extend(!0,{},c.dotdotdot.defaults,a),this.each(function(){c(this).data("dotdotdot",(new c.dotdotdot(c(this),
a))._api())})};var f,m,h,k}}(g);return!0});