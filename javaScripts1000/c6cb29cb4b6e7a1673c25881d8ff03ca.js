define(["modules/id.core"],function(e){"use strict";e.utils.log("loading id.elClickTr.js");var t=function(){this.conf={ELEMENT_IDENTIFIER_DATA_ATTR:"data-id-elctr"};var t=this;this.init=function(){this.setClickHandler()},this.setClickHandler=function(){e.dom.bind(document.body,"click auxclick",function(e){("click"===e.type||"click"===e.originalEvent.type||"auxclick"===e.originalEvent.type&&2===e.originalEvent.which)&&(e.isTrusted===!0||void 0===e.isTrusted&&void 0===e._lpEvent)&&t.elementClickHandler(e)})},this.elementClickHandler=function(e){for(var t=this.getClosestClickTrackConfElement(e.target);t&&t.length;)this.trackElementClick(t),t=this.getClosestClickTrackConfElement(t.parent())},this.trackElementClick=function(t){var i=this.getClickTrackConf(t);i&&(i=this.transformTrackConfToValidPayload(i),Object.keys(i).length&&(e.utils.log("[id.elClickTr.js] TRACKING elementClick:",t[0],i),e.event.publish(e.event.constants.CUA.TRACK,[{event:"INTERACTION",index:"user-interaction",type:"element-click",payload:i}])))},this.getClosestClickTrackConfElement=function(t){return e.dom.closest(this.conf.ELEMENT_IDENTIFIER_DATA_ATTR,e.dom.$(t))},this.getClickTrackConf=function(t){var i;try{i=JSON.parse(t&&t[0]&&t[0].getAttribute(this.conf.ELEMENT_IDENTIFIER_DATA_ATTR))}catch(n){e.utils.log("[id.elClickTr.js] ElementClickTracking failed! Please make sure to have a valid json config in the dataAttribute")}return i},this.transformTrackConfToValidPayload=function(e){var t={};return e&&(e.experimentId&&(t.experimentId=e.experimentId),e.experimentVariantId&&(t.experimentVariantId=e.experimentVariantId),e.experimentRoundNr&&(t.experimentRoundNr=e.experimentRoundNr)),t}};return t});