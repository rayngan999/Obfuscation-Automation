(function(e){function n(n,r){var i=this;var n=e(n);var s=e('<div class="fg-menu-container ui-widget ui-widget-content ui-corner-all">'+r.content+"</div>");this.menuOpen=false;this.menuExists=false;var r=e.extend({content:null,width:r.width,maxHeight:200,positionOpts:{posX:"left",posY:"bottom",offsetX:0,offsetY:0,directionH:"right",directionV:"down",detectH:true,detectV:true,linkToFront:false},showSpeed:200,callerOnState:"ui-state-active",loadingState:"ui-state-loading",linkHover:"ui-state-hover",linkHoverSecondary:"li-hover",crossSpeed:200,crumbDefaultText:"Choose an option:",backLink:true,backLinkText:"Back",flyOut:false,flyOutOnState:"ui-state-default",nextMenuLink:"ui-icon-triangle-1-e",topLinkText:"All",nextCrumbLink:"ui-icon-carat-1-e"},r);var o=function(){e.each(t,function(e){if(t[e].menuOpen){t[e].kill()}})};this.kill=function(){n.removeClass(r.loadingState).removeClass("fg-menu-open").removeClass(r.callerOnState);s.find("li").removeClass(r.linkHoverSecondary).find("a").removeClass(r.linkHover);if(r.flyOutOnState){s.find("li a").removeClass(r.flyOutOnState)}if(r.callerOnState){n.removeClass(r.callerOnState)}if(s.is(".fg-menu-ipod")){i.resetDrilldownMenu()}if(s.is(".fg-menu-flyout")){i.resetFlyoutMenu()}s.parent().hide();i.menuOpen=false;e(document).unbind("click",o);e(document).unbind("keydown")};this.showLoading=function(){n.addClass(r.loadingState)};this.showMenu=function(){o();if(!i.menuExists){i.create()}n.addClass("fg-menu-open").addClass(r.callerOnState);s.parent().show().click(function(){i.kill();return false});s.hide().slideDown(r.showSpeed).find(".fg-menu:eq(0)");i.menuOpen=true;n.removeClass(r.loadingState);e(document).click(o);e(document).keydown(function(t){var n;if(t.which!=""){n=t.which}else if(t.charCode!=""){n=t.charCode}else if(t.keyCode!=""){n=t.keyCode}var i=e(t.target).parents("div").is(".fg-menu-flyout")?"flyout":"ipod";switch(n){case 37:if(i=="flyout"){e(t.target).trigger("mouseout");if(e("."+r.flyOutOnState).size()>0){e("."+r.flyOutOnState).trigger("mouseover")}}if(i=="ipod"){e(t.target).trigger("mouseout");if(e(".fg-menu-footer").find("a").size()>0){e(".fg-menu-footer").find("a").trigger("click")}if(e(".fg-menu-header").find("a").size()>0){e(".fg-menu-current-crumb").prev().find("a").trigger("click")}if(e(".fg-menu-current").prev().is(".fg-menu-indicator")){e(".fg-menu-current").prev().trigger("mouseover")}}return false;break;case 38:if(e(t.target).is("."+r.linkHover)){var u=e(t.target).parent().prev().find("a:eq(0)");if(u.size()>0){e(t.target).trigger("mouseout");u.trigger("mouseover")}}else{s.find("a:eq(0)").trigger("mouseover")}return false;break;case 39:if(e(t.target).is(".fg-menu-indicator")){if(i=="flyout"){e(t.target).next().find("a:eq(0)").trigger("mouseover")}else if(i=="ipod"){e(t.target).trigger("click");setTimeout(function(){e(t.target).next().find("a:eq(0)").trigger("mouseover")},r.crossSpeed)}}return false;break;case 40:if(e(t.target).is("."+r.linkHover)){var a=e(t.target).parent().next().find("a:eq(0)");if(a.size()>0){e(t.target).trigger("mouseout");a.trigger("mouseover")}}else{s.find("a:eq(0)").trigger("mouseover")}return false;break;case 27:o();break;case 13:if(e(t.target).is(".fg-menu-indicator")&&i=="ipod"){e(t.target).trigger("click");setTimeout(function(){e(t.target).next().find("a:eq(0)").trigger("mouseover")},r.crossSpeed)}break}})};this.create=function(){s.css({width:r.width}).appendTo("body").find("ul:first").not(".fg-menu-breadcrumb").addClass("fg-menu");s.find("ul, li a").addClass("ui-corner-all");s.find("ul").attr("role","menu").eq(0).attr("aria-activedescendant","active-menuitem").attr("aria-labelledby",n.attr("id"));s.find("li").attr("role","menuitem");s.find("li:has(ul)").attr("aria-haspopup","true").find("ul").attr("aria-expanded","false");s.find("a").attr("tabindex","-1");if(s.find("ul").size()>1){if(r.flyOut){i.flyout(s,r)}else{i.drilldown(s,r)}}else{s.find("a").click(function(){i.chooseItem(this);return false})}if(r.linkHover){var t=s.find(".fg-menu li a");t.hover(function(){var t=e(this);e("."+r.linkHover).removeClass(r.linkHover).blur().parent().removeAttr("id");e(this).addClass(r.linkHover).focus().parent().attr("id","active-menuitem")},function(){e(this).removeClass(r.linkHover).blur().parent().removeAttr("id")})}if(r.linkHoverSecondary){s.find(".fg-menu li").hover(function(){e(this).siblings("li").removeClass(r.linkHoverSecondary);if(r.flyOutOnState){e(this).siblings("li").find("a").removeClass(r.flyOutOnState)}e(this).addClass(r.linkHoverSecondary)},function(){e(this).removeClass(r.linkHoverSecondary)})}i.setPosition(s,n,r);i.menuExists=true};this.chooseItem=function(t){i.kill();e("#menuSelection").text(e(t).text());location.href=e(t).attr("href")}}function r(e,t){return t-e}function i(){return self.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop}function s(){return self.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft}function o(){var e=document.documentElement;return self.innerHeight||e&&e.clientHeight||document.body.clientHeight}function u(){var e=document.documentElement;return self.innerWidth||e&&e.clientWidth||document.body.clientWidth}function a(t,n){var r=parseInt(n)||e(t).offset().left;return r+e(t).width()<=u()+s()&&r-s()>=0}function f(t,n){var r=parseInt(n)||e(t).offset().top;return r+e(t).height()<=o()+i()&&r-i()>=0}var t=[];e.fn.menunavega=function(r){var i=this;var r=r;var s=new n(i,r);t.push(s);e(this).mousedown(function(){if(!s.menuOpen){s.showLoading()}}).click(function(){if(s.menuOpen==false){s.showMenu()}else{s.kill()}return false})};n.prototype.flyout=function(t,n){var r=this;this.resetFlyoutMenu=function(){var e=t.find("ul ul");e.removeClass("ui-widget-content").hide()};t.addClass("fg-menu-flyout").find("li:has(ul)").each(function(){var r=t.width();var i,s;var o=e(this).find("ul");o.css({left:r,width:r}).hide();e(this).find("a:eq(0)").addClass("fg-menu-indicator").html("<span>"+e(this).find("a:eq(0)").text()+'</span><span class="ui-icon '+n.nextMenuLink+'"></span>').hover(function(){clearTimeout(s);var t=e(this).next();if(!f(t,e(this).offset().top)){t.css({top:"auto",bottom:0})}if(!a(t,e(this).offset().left+100)){t.css({left:"auto",right:r,"z-index":999})}i=setTimeout(function(){t.addClass("ui-widget-content").show(n.showSpeed).attr("aria-expanded","true")},300)},function(){clearTimeout(i);var t=e(this).next();s=setTimeout(function(){t.removeClass("ui-widget-content").hide(n.showSpeed).attr("aria-expanded","false")},400)});e(this).find("ul a").hover(function(){clearTimeout(s);if(e(this).parents("ul").prev().is("a.fg-menu-indicator")){e(this).parents("ul").prev().addClass(n.flyOutOnState)}},function(){s=setTimeout(function(){o.hide(n.showSpeed);t.find(n.flyOutOnState).removeClass(n.flyOutOnState)},500)})});t.find("a").click(function(){r.chooseItem(this);return false})};n.prototype.drilldown=function(t,n){var r=this;var i=t.find(".fg-menu");var s=e('<ul class="fg-menu-breadcrumb ui-widget-header ui-corner-all ui-helper-clearfix"></ul>');var o=e('<li class="fg-menu-breadcrumb-text">'+n.crumbDefaultText+"</li>");var u=n.backLink?n.backLinkText:n.topLinkText;var a=n.backLink?"fg-menu-prev-list":"fg-menu-all-lists";var f=n.backLink?"ui-state-default ui-corner-all":"";var l=n.backLink?'<span class="ui-icon ui-icon-triangle-1-w"></span>':"";var c=e('<li class="'+a+'"><a href="#" class="'+f+'">'+l+u+"</a></li>");t.addClass("fg-menu-ipod");if(n.backLink){s.addClass("fg-menu-footer").appendTo(t).hide()}else{s.addClass("fg-menu-header").prependTo(t)}s.append(o);var h=function(e){e.css({height:n.maxHeight})};var p=function(e){e.removeClass("fg-menu-scroll").removeClass("fg-menu-current").height("300px")};this.resetDrilldownMenu=function(){e(".fg-menu-current").removeClass("fg-menu-current");i.animate({left:0},n.crossSpeed,function(){e(this).find("ul").each(function(){e(this).hide();p(e(this))});i.addClass("fg-menu-current")});e(".fg-menu-all-lists").find("span").remove();s.empty().append(o);e(".fg-menu-footer").empty().hide();h(i)};i.addClass("fg-menu-content fg-menu-current ui-widget-content ui-helper-clearfix").css({width:t.width()}).find("ul").css({width:t.width(),left:t.width()}).addClass("ui-widget-content").hide();h(i);i.find("a").each(function(){if(e(this).next().is("ul")){e(this).addClass("fg-menu-indicator").each(function(){e(this).html("<span>"+e(this).text()+'</span><span class="ui-icon '+n.nextMenuLink+'"></span>')}).click(function(){var o=e(this).next();var u=e(this).parents("ul:eq(0)");var a=u.is(".fg-menu-content")?0:parseFloat(i.css("left"));var f=Math.round(a-parseFloat(t.width()));var l=e(".fg-menu-footer");p(u);h(o);i.animate({left:f},n.crossSpeed);o.show().addClass("fg-menu-current").attr("aria-expanded","true");var d=function(t){var n=t;var r=e(".fg-menu-current");var i=r.parents("ul:eq(0)");r.hide().attr("aria-expanded","false");p(r);h(i);i.addClass("fg-menu-current").attr("aria-expanded","true");if(i.hasClass("fg-menu-content")){n.remove();l.hide()}};if(n.backLink){if(l.find("a").size()==0){l.show();e('<a href="#"><span class="ui-icon ui-icon-triangle-1-w"></span> <span>Atr√°s</span></a>').appendTo(l).click(function(){var r=e(this);var s=parseFloat(i.css("left"))+t.width();i.animate({left:s},n.crossSpeed,function(){d(r);h(e(this))});return false})}}else{if(s.find("li").size()==1){s.empty().append(c);c.find("a").click(function(){r.resetDrilldownMenu();return false})}e(".fg-menu-current-crumb").removeClass("fg-menu-current-crumb");var v=e(this).find("span:eq(0)").text();var m=e('<li class="fg-menu-current-crumb"><a href="javascript://" class="fg-menu-crumb">'+v+"</a></li>");m.appendTo(s).find("a").click(function(){if(e(this).parent().is(".fg-menu-current-crumb")){r.chooseItem(this)}else{var t=-(e(".fg-menu-current").parents("ul").size()-1)*180;i.animate({left:t},n.crossSpeed,function(){d()});e(this).parent().addClass("fg-menu-current-crumb").find("span").remove();e(this).parent().nextAll().remove()}return false});m.prev().append(' <span class="ui-icon '+n.nextCrumbLink+'"></span>')}return false})}else{e(this).click(function(){r.chooseItem(this);return false})}})};n.prototype.setPosition=function(t,n,r){var i=t;var s=n;var o={refX:s.offset().left,refY:s.offset().top,refW:s.getTotalWidth(),refH:s.getTotalHeight()};var r=r;var u,l;var c=e('<div class="positionHelper"></div>');c.css({position:"absolute",left:o.refX,top:o.refY,width:o.refW,height:o.refH});i.wrap(c);switch(r.positionOpts.posX){case"left":u=0;break;case"center":u=o.refW/2;break;case"right":u=o.refW;break}switch(r.positionOpts.posY){case"top":l=0;break;case"center":l=o.refH/2;break;case"bottom":l=o.refH;break}u+=r.positionOpts.offsetX;l+=r.positionOpts.offsetY;if(r.positionOpts.directionV=="up"){i.css({top:"auto",bottom:l});if(r.positionOpts.detectV&&!f(i)){i.css({bottom:"auto",top:l})}}else{i.css({bottom:"auto",top:l});if(r.positionOpts.detectV&&!f(i)){i.css({top:"auto",bottom:l})}}if(r.positionOpts.directionH=="left"){i.css({left:"auto",right:u});if(r.positionOpts.detectH&&!a(i)){i.css({right:"auto",left:u})}}else{i.css({right:"auto",left:u});if(r.positionOpts.detectH&&!a(i)){i.css({left:"auto",right:u})}}if(r.positionOpts.linkToFront){s.clone().addClass("linkClone").css({position:"absolute",top:0,right:"auto",bottom:"auto",left:0,width:s.width(),height:s.height()}).insertAfter(i)}};e.fn.getTotalWidth=function(){return e(this).width()+parseInt(e(this).css("paddingRight"))+parseInt(e(this).css("paddingLeft"))+parseInt(e(this).css("borderRightWidth"))+parseInt(e(this).css("borderLeftWidth"))};e.fn.getTotalHeight=function(){return e(this).height()+parseInt(e(this).css("paddingTop"))+parseInt(e(this).css("paddingBottom"))+parseInt(e(this).css("borderTopWidth"))+parseInt(e(this).css("borderBottomWidth"))};Number.prototype.pxToEm=String.prototype.pxToEm=function(t){t=e.extend({scope:"body",reverse:false},t);var n=this==""?0:parseFloat(this);var r;var i=function(){var e=document.documentElement;return self.innerWidth||e&&e.clientWidth||document.body.clientWidth};if(t.scope=="body"&&e.browser.msie&&(parseFloat(e("body").css("font-size"))/i()).toFixed(1)>0){var s=function(){return(parseFloat(e("body").css("font-size"))/i()).toFixed(3)*16};r=s()}else{r=parseFloat(e(t.scope).css("font-size"))}var o=t.reverse==true?(n*r).toFixed(2)+"px":(n/r).toFixed(2)+"em";return o}})(jQuery)