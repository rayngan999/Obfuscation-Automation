/*! v: 1.1.12_187_prod Wed Jul 21 2021 10:43:38 GMT+0000 (UTC) */!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}i.r(e);var o={isIframe:function(){try{return window.self!==window.top}catch(t){return!0}},getWindow:function(){return window},getTopWindow:function(){return this.isIframe()&&this.isTopWindowAccessable()?window.top:window},isTopWindowAccessable:function(){var t;try{t=window.top.document}catch(t){return!1}return null!==t},getTopDocument:function(){return this.getTopWindow().document},getDocument:function(){return this.getWindow().document},getPageUrl:function(){return this.getTopDocument().location.href},getNavigator:function(){return this.getTopWindow().navigator},createElement:function(t,e,i,o){var a=o||this.getDocument(),s=a.createElement(t),r=a.getElementsByTagName(e)[0];return function t(e,i){for(var o in i){var a=i[o];"object"==n(a)?t(e[o],a):e[o]=a}}(s,i),r.appendChild(s),s},findElement:function(t,e,i,n){for(var o=(n||this.getDocument()).getElementsByTagName(t),a=0;a<o.length;a++){var s=o[a],r=s[e];if(i.test(r))return s}},findScript:function(t,e){return this.findElement("script","src",t,e)},getIframeDocument:function(t){return t.contentDocument||t.contentWindow.document},acirNotExist:function(){return!this.getTopDocument().querySelector('script[src*="ACIR-core"]')},getBrowserName:function(){var t,e=this.getNavigator().userAgent,i=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(i[1])?{name:"IE ",version:(t=/\brv[ :]+(\d+)/g.exec(e)||[])[1]||""}:"Chrome"===i[1]&&null!=(t=e.match(/\bOPR\/(\d+)/))?{name:"Opera",version:t[1]}:(i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(t=e.match(/version\/(\d+)/i))&&i.splice(1,1,t[1]),{name:i[0],version:i[1]})}},a={},s={},r={},d=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return a.get(t)||e},l=function(t,e){t&&(s[t]=e)},u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return t in s?s[t]:e},h=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return t in r?r[t]:e},c=function(t){try{var e=JSON.parse(t);"adm"in e&&function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r=t}(e.adm)}catch(t){}};function A(t){var e;return window.DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t)),e}function p(t,e){var i=A(t).querySelector(e);if(0===i.length)throw"Not found XML node:"+e;var n=i.textContent.replace("<![CDATA[","").replace("]]>","");if(!n)throw"no content in XML node "+e;return n}var g=function(){},_=function(t,e){!function(t,e){var i=d("sid",!1),n={event:t,message:e,timestamp:(new Date).getTime()},o="lreprx:"+(i?i+":":"")+"//"+JSON.stringify(n);window.parent.postMessage(o,"*"),window.parent!==window&&window.postMessage(o,"*");try{if(window.parent!==window.top){window.top.postMessage(o,"*");for(var a=0;a<window.top.frames.length;a++)try{window.top.frames[a].postMessage(o,"*")}catch(t){}}}catch(t){}}(t,e)},E=function(t){_("err","prx: "+t)};function m(t,e){if(!Array.isArray(t))throw new Error("Input is not an array.");return 0===t.length?null:null==t._rr?(t._rr=0,t[0]):1===t.length?t[0]:("number"==typeof e&&(t._rr=e),t._rr>=t.length-1||t._rr<0?(t._rr=0,t[0]):(t._rr+=1,t[t._rr]))}function f(t){for(var e,i,n=t.length;0!==n;)i=Math.floor(Math.random()*n),e=t[n-=1],t[n]=t[i],t[i]=e;return t}function v(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,n=null;try{n=new URL(t).searchParams.get(e)}catch(t){}return n||i}var y=function(t){return t.replace(/([h|w])\=(\d+\.\d+)/g,function(t,e,i){return"".concat(e,"=").concat(Math.round(i))})};function b(t){return document.cookie.split(new RegExp(/;[ ]?/g)).map(function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],n=!0,o=!1,a=void 0;try{for(var s,r=t[Symbol.iterator]();!(n=(s=r.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==r.return||r.return()}finally{if(o)throw a}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t.split("="),2);return{name:e[0],value:e[1]}}).find(function(e){return e.name===t})}var C,V=function(){var t,e,i,n=!1;this.init=function(t,o){e=!t||isNaN(t)||t<1?6e4:t/4*2*1e3,i=o,n=!0},this.run=function(){n&&(t=setTimeout(function(){return i()},e))},this.stop=function(){n&&clearTimeout(t)},this.refresh=function(){n&&(clearTimeout(t),t=setTimeout(function(){return i()},e))}},I="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTIxNiAxMDI0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxMjE2IDEwMjQ7IiB4bWw6c3BhY2U9InByZXNlcnZlIj48c3R5bGUgdHlwZT0idGV4dC9jc3MiPi5zdDB7ZmlsbDojRkZGRkZGO308L3N0eWxlPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0wLDcxMS45aDI2My4zTDY3Ny44LDEwMjRWMEwyNjMuMywzMTIuMUgwVjcxMS45eiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik04NzcuNywzNDEuM2wtNjguMyw2OC4zYzUzLjYsNTguNSw1My42LDE0Ni4zLDAsMjA0LjhsNjguMyw2OC4zQzk3MC40LDU5MCw5NzAuNCw0MzQsODc3LjcsMzQxLjNMODc3LjcsMzQxLjN6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwODcuNCwyMDQuOGwtNzMuMSw3OGM2OC4zLDczLjEsMTAyLjQsMTY1LjgsMTAyLjQsMjYzLjNjMCwxMDIuNC0zNC4xLDE5NS0xMDIuNCwyNjMuM2w3My4xLDc4YzgyLjktOTIuNiwxMzEuNy0yMTQuNiwxMzEuNy0zNDEuM1MxMTcwLjMsMjk3LjQsMTA4Ny40LDIwNC44TDEwODcuNCwyMDQuOHoiLz48L3N2Zz4=)",S=function(){var t=document.createElement("div");t.style.width="25px",t.style.height="25px",t.style.display="block",t.style.position="absolute",t.style.right="20px",t.style.bottom="12px",t.style.zIndex="10000",t.style.cursor="pointer",t.style.backgroundImage=I,t.style.backgroundRepeat="no-repeat",t.style.backgroundPosition="center",t.style.visibility="hidden",t.classList.add("lre-vlm-btn"),t.onclick=function(t){t.preventDefault(),t.stopPropagation()},this.show=function(){t.style.visibility="visible"},this.hide=function(){t.style.visibility="hidden"},this.render=function(){return t},this.volume=function(e){t.style.backgroundImage=e?I:"url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTIxNiAxMDI0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxMjE2IDEwMjQ7IiB4bWw6c3BhY2U9InByZXNlcnZlIj48c3R5bGUgdHlwZT0idGV4dC9jc3MiPi5zdDB7ZmlsbDojRkZGRkZGO308L3N0eWxlPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0wLDcxMS45aDI2My4zTDY3Ny44LDEwMjRWMEwyNjMuMywzMTIuMUgwVjcxMS45eiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMTg3LjEsNjg0LjJsLTM4LjEsMzUuN2MtOS4zLDguNy0yMy44LDguMi0zMi41LTEuMUw3NzMuMSwzNTIuMmMtOC43LTkuMy04LjItMjMuOCwxLjEtMzIuNWwzOC4xLTM1LjdjOS4zLTguNywyMy44LTguMiwzMi41LDEuMWwzNDMuNSwzNjYuNkMxMTk2LjgsNjYxLDExOTYuMyw2NzUuNiwxMTg3LjEsNjg0LjJ6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTc3NC4xLDY4NC4ybDM4LjEsMzUuN2M5LjMsOC43LDIzLjgsOC4yLDMyLjUtMS4xbDM0My41LTM2Ni42YzguNy05LjMsOC4yLTIzLjgtMS4xLTMyLjVsLTM4LjEtMzUuN2MtOS4zLTguNy0yMy44LTguMi0zMi41LDEuMUw3NzMuMSw2NTEuOEM3NjQuNCw2NjEsNzY0LjksNjc1LjYsNzc0LjEsNjg0LjJ6Ii8+PC9zdmc+)"},this.onClick=function(e){t.onclick=function(t){t.preventDefault(),t.stopPropagation(),e()}}};function M(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}(C=window).ACeventBus=function(){var t={};this.subscribe=function(e,i,n){t[i]||(t[i]=[]),t[i].push({callback:e,context:n})},this.unsubscribe=function(e,i){if(t[i])for(var n=0;n<t[i].length;n++)if(t[i][n].callback===e){t[i].splice(n,1);break}},this.dispatch=function(e,i,n,o){if(t[e])for(var a=0;a<t[e].length;a++)if(t[e][a]&&"function"==typeof t[e][a].callback)try{t[e][a].callback.call(t[e][a].context,i,n,o)}catch(t){}}},C.lreAdSlot=function(){return""+'<div class="lre-ad-slot" style="width: 100%; height: 100%" ><video class="lre-ad-vs" webkit-playsinline playsinline '+(1==parseInt(h("mavs",0))?"muted":"")+' style="width: 100%; height: 100%"></video></div>'};var T=null,D=function(){var t,e,i,n,o,a,s=this;function r(){T={},e={}}function m(){var t;(t=0,n||(n=new Promise(function(t,e){o=t,a=e}),function e(){u("mutingEnabled")&&s.getAdVolume&&0!==s.getAdVolume()?t<3?(t+=1,T.setAdVolume(0),setTimeout(e,10)):a("set ad volume faild"):o(s.getAdVolume())}()),n).then(function(t){n=!1},function(t){n=!1,_("mf2")})}function f(t){r(),g("_adVideoPlayer.onAdError",t),I.dispatch("AdError","Error in ad manager occurred:"+t)}function v(n){return new Promise(function(o,a){var r=y(d("ad_tag")),c={method:"GET",mode:"cors",cache:"no-store",credentials:1!==parseInt(h("rqcm",0))?"omit":"include",redirect:"follow",referrer:"client"},g=function(r){try{try{!function(t,e){if(!A(r).querySelector(e))throw"Not found XML node:"+e}(0,'MediaFile[type="application/javascript"]')}catch(t){return void f("Response from demand does not contain JS AdManager.")}var d=p(r,'MediaFile[type="application/javascript"]');if(!d)return void f("Couldn't find ad-manager url in VPAID");try{var c=p(r,"AdParameters");n.creativeData.AdParameters=c}catch(t){n.creativeData.AdParameters=""}n.environmentVars.videoSlotCanAutoPlay=!0;var g=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){M(t,e,i[e])})}return t}({},n,{playerWidth:n.width,playerHeight:n.height,bitrate:600});if(1!==parseInt(h("exvs",0))){t=document.createElement("div");var m=window.lreAdSlot();t.style.width="".concat(n.width,"px"),t.style.height="".concat(n.height,"px"),t.style.position="initial",t.style.pointerEvents="none",g.environmentVars.slot.appendChild(t),t.innerHTML=m,t.id=g.environmentVars.slot.id+"lre-prx",g.environmentVars.videoSlot=t.querySelector(".lre-ad-vs")}u("showMuteButton")&&((i=new S).volume(u("mutingEnabled")?0:1),g.environmentVars.slot.appendChild(i.render()),i.onClick(function(){l("mutingEnabled",!u("mutingEnabled"));var t=u("mutingEnabled")?0:1;g.environmentVars.videoSlot.muted=0==t,s.setAdVolume(t),i.volume(t),_("amu",t?0:1)}),g.environmentVars.slot.onmouseover=i.show,g.environmentVars.slot.onmouseleave=i.hide),g.environmentVars.videoSlot.addEventListener("volumechange",function(){u("mutingEnabled",!0)&&(this.volume=0,T&&T.setAdVolume(0))}),g.environmentVars.videoSlot.addEventListener("play",function(){u("mutingEnabled",!0)&&(this.volume=0,T&&T.setAdVolume(0))}),g.environmentVars.videoSlot.onplay=function(){u("mutingEnabled",!0)&&(this.volume=0)},g.environmentVars.autoplay=!0,g.environmentVars.ad_mute=!0,g.environmentVars.imaAutoplay=!0,g.environmentVars.imaMuted=!0;var v=document.createElement("script");v.type="text/javascript",v.async=!0,v.addEventListener("load",function(t){return function(t,i){try{var n=t.target.ownerDocument.defaultView||t.target.ownerDocument.parentWindow;(e=n.getVPAIDAd()).handshakeVersion("2.0"),o({ad:e,params:i})}catch(t){f(t.message),a()}}(t,g)}),v.onunload=function(){t.remove()},document.body.appendChild(v),v.src=d}catch(t){E("vast response error"),f(t.message)}};!function(t){fetch(t).then(function(t){return t.text()}).then(function(t){return g(t)}).catch(function(t){f(t)})}(new Request(r,c))})}var b=0,C=0,I=new window.ACeventBus;this.handshakeVersion=function(t){return"2.0"},this.initAd=function(e,n,o,a,s,d){function A(t){if("VIDEO"==t.tagName||"LIMA-VIDEO"==t.tagName){if("LIMA-VIDEO"==t.tagName){var e=t.load;t.load=function(){return this.muted=!0,e.apply(this,[].slice.call(arguments))}}var n=t.play;t.play=function(){var t=this;this.muted=!0,u("adMediaData")&&l("mediaUrl",""!=this.src?this.src:null);var e=u("mutingEnabled")?0:1;e&&(l("mutingEnabled",e),i&&i.volume(e?0:1));var o=n.apply(this,[].slice.call(arguments));return o instanceof Promise&&o.then(function(t){}).catch(function(e){t.muted=!0,t.play()}),o}}}if(c(s.AdParameters),l("showMuteButton",!!parseInt(h("smb",1))),l("mutingEnabled",parseInt(h("m",1))),l("adMediaData",!!parseInt(h("amd",1))),u("mutingEnabled",!0)){var p=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;void 0!==p&&new p(function(t){t.forEach(function(t){t.addedNodes.forEach(function(t){A(t),t.querySelectorAll&&t.querySelectorAll("video, lima-video").forEach(A)})})}).observe(d.slot.parentNode,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}var g,E,f,y;y={width:g=e,height:E=n,viewMode:o,desiredBitrate:a,creativeData:s,environmentVars:d},b=g,C=E,function(){var e=this;f=new V,v(y).then(function(i){T=i.ad,I.dispatch("AdManagerLoaded"),T.subscribe(function(t){},"AdLog",e),T.subscribe(function(){I.dispatch("AdLoaded"),m()},"AdLoaded",e),T.subscribe(function(){I.dispatch("AdStarted"),m()},"AdStarted",e),T.subscribe(function(t,e){e?I.dispatch("AdError","No Ad"):I.dispatch("AdError",t)},"AdError"),T.subscribe(function(e,i){I.dispatch("AdImpression",e,i),m();var n=T.getAdDuration(),o=u("mediaUrl",null);if(u("adMediaData")&&null!=o&&fetch(new Request(o,{method:"HEAD"})).then(function(t){_("amd",o+"|"+t.headers.get("content-type"))}),_("xap"),f.init(n,function(){r(),I.dispatch("AdError","ADABORTEDTIMEOUT")}),setTimeout(function(){u("videoElemFound")||_("mf1")},1e3),setInterval(function(t){(T||{}).getAdVolume&&0!==T.getAdVolume()&&u("mutingEnabled")&&m()},10),t){var a=t.querySelector(".lre-ad-vs");0===a.src.length&&(t.style.display="none",a.addEventListener("play",function(){0!==a.src.length&&(t.style.display="block")}))}f.run()},"AdImpression"),T.subscribe(function(){r(),I.dispatch("AdVideoComplete")},"AdVideoComplete"),T.subscribe(function(){f.stop(),I.dispatch("AdSkipped")},"AdSkipped"),T.subscribe(function(){I.dispatch("AdSkippableStateChange")},"AdSkippableStateChange"),T.subscribe(function(){f.stop(),I.dispatch("AdStopped")},"AdStopped"),T.subscribe(function(t){f.stop(),I.dispatch("AdClosed",t)},"AdClosed"),T.subscribe(function(){I.dispatch("AdVideoStart"),m()},"AdVideoStart"),T.subscribe(function(){I.dispatch("AdVideoFirstQuartile"),m(),f.refresh()},"AdVideoFirstQuartile",e),T.subscribe(function(){I.dispatch("AdVideoMidpoint"),m(),f.refresh()},"AdVideoMidpoint",e),T.subscribe(function(){I.dispatch("AdVideoThirdQuartile"),(T||{}).getAdVolume&&m(),f.refresh()},"AdVideoThirdQuartile"),T.subscribe(function(){I.dispatch("AdClickThru")},"AdClickThru"),T.subscribe(function(){I.dispatch("AdVolumeChange"),m()},"AdVolumeChange"),T.subscribe(function(){I.dispatch("AdPaused"),f.stop()},"AdPaused"),T.subscribe(function(){I.dispatch("AdPlaying")},"AdPlaying"),T.subscribe(function(){I.dispatch("AdDurationChange")},"AdDurationChange"),T.subscribe(function(){I.dispatch("allAdsCompleted")},"allAdsCompleted"),T.subscribe(function(t){I.dispatch("ContentImpression",t)},"ContentImpression"),T.subscribe(function(){I.dispatch("ContentComplete")},"ContentComplete"),T.subscribe(function(){I.dispatch("ContentPaused")},"ContentPaused"),T.subscribe(function(){I.dispatch("ContentPlaying")},"ContentPlaying"),T.subscribe(function(){I.dispatch("ContentClick")},"ContentClick"),T.subscribe(function(t,e,i){I.dispatch("AdEvent",t,e,i)},"AdEvent"),T.subscribe(function(){I.dispatch("Inventory")},"Inventory"),T.subscribe(function(t){I.dispatch("InventoryRequest",t)},"InventoryRequest"),T.subscribe(function(t){I.dispatch("FullScreenRequest",t)},"FullScreenRequest"),T.initAd(i.params.playerWidth,i.params.playerHeight,i.params.viewMode,600,i.params.creativeData,i.params.environmentVars)}).catch(function(t){})}()},this.startAd=function(){T&&T.startAd()},this.setWaterfallState=function(t,e,i){T&&T.setWaterfallState(t,e,i)},this.getAdLinear=function(){return!0},this.stopAd=function(t,e){T&&T.stopAd()},this.getAdVolume=function(){return T?T.getAdVolume():0},this.setAdVolume=function(t){T&&T.setAdVolume(t)},this.resizeAd=function(e,i,n){T&&(T.resizeAd(e,i,n),b=e,C=i),t&&(t.style.width="".concat(e,"px"),t.style.height="".concat(i,"px"))},this.pauseAd=function(){T&&T.pauseAd()},this.resumeAd=function(){T&&T.resumeAd()},this.expandAd=function(){},this.getAdExpanded=function(t){return!1},this.getAdSkippableState=function(t){return!0},this.collapseAd=function(){},this.skipAd=function(){T&&(T.getAdSkippableState&&T.getAdSkippableState()&&T.skipAd&&T.skipAd(),T.onAdSkipped?T.onAdSkipped():I.dispatch("AdSkipped"))},this.getAdWidth=function(){return b},this.getAdHeight=function(){return C},this.getSkippableRemainingTime=function(){return-1},this.getAdRemainingTime=function(){return T?T.getAdRemainingTime():0},this.getAdDuration=function(){return T?T.getAdDuration():0},this.getAdCompanions=function(){return""},this.getIcons=function(){return""},this.getAdIcons=function(){return""},this.seekAd=function(t){T&&(void 0).seekAd(t)},this.getContentPaused=function(){if(T)return T.getContentPaused()},this.pauseContent=function(){if(T)return T.pauseContent()},this.resumeContent=function(){if(T)return T.resumeContent()},this.setContentVolume=function(t){if(T)return T.setContentVolume(t)},this.subscribe=function(t,e,i){I.subscribe(t,e,i)},this.unsubscribe=function(t,e){I.unsubscribe(t,e)}},L=function(){this._slot=null,this._videoSlot=null,this.VPAID_EVENTS={AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdLoaded:"AdLoaded",AdLinearChange:"AdLinearChange",AdSizeChange:"AdSizeChange",AdExpandedChange:"AdExpandedChange",AdSkippableStateChange:"AdSkippableStateChange",AdDurationChange:"AdDurationChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdError:"AdError",AdLog:"AdLog"},this._eventCallbacks={},this._attributes={companions:"",desiredBitrate:256,duration:30,expanded:!1,width:0,height:0,nonLinearSlotHeight:150,viewMode:"normal",icons:"",linear:!0,remainingTime:10,skippableState:!1,showMuteButton:!0,volume:0,muted:!0,vastLoadTimeout:2e4,adWillAutoPlay:!0,adWillPlayMuted:!1,useSecureIframe:!1,adMediaData:!0},this.IMA_SDK_URL="https://imasdk.googleapis.com/js/sdkloader/ima3.js",this._adsLoader=null,this._adDisplayContainer=null,this._adDisplayContainerInitialized=!1,this._adsManager=null,this._currentAd=null,this._lifecycleController=null,this._volumeButton=null,this._pageUrl=null,this._mediaUrl=null};function N(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],n=!0,o=!1,a=void 0;try{for(var s,r=t[Symbol.iterator]();!(n=(s=r.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==r.return||r.return()}finally{if(o)throw a}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}L.prototype.loadIMA=function(t){var e=document.getElementsByTagName("head")[0]||document.documentElement,i=document.createElement("script");i.type="text/javascript",i.src=this.IMA_SDK_URL,t&&(i.attachEvent&&!window.opera?i.onreadystatechange=function(){"loaded"!==i.readyState&&"complete"!==i.readyState||(e.removeChild(i),i.onreadystatechange=null,t())}:i.addEventListener("load",function(){e.removeChild(i),t()},!1)),e.insertBefore(i,e.firstChild)},L.prototype.doContentComplete=function(){this._adsLoader&&this._adsLoader.contentComplete()},L.prototype.destroyAd=function(){this.log("destroyAd"),this._adsManager&&(this._adsManager.destroy(),this._adsManager=null),this.doContentComplete()},L.prototype.onIMAAdError=function(t){this.destroyAd(),this.onAdError(t.getError().getErrorCode()+" "+t.getError().getMessage())},L.prototype.onAllAdsCompleted=function(){this._lifecycleController.stop(),this.destroyAd(),this.onAdVideoComplete(),this.onAdStopped()},L.prototype.onIMAClick=function(t){this.onAdClickThru("",t.getAd().getAdId(),!1)},L.prototype.onIMADurationChange=function(){this.onAdDurationChange()},L.prototype.onIMAFirstQuartile=function(){this._lifecycleController.refresh(),this.onAdVideoFirstQuartile()},L.prototype.onIMAImpression=function(){var t=this;if(this._currentAd){var e=this._currentAd.getDuration();this._lifecycleController.init(e,function(){t.destroyAd(),t.onAdError("lifecycle timeout")}),this._lifecycleController.run()}this._attributes.adMediaData&&null!=this._mediaUrl&&fetch(new Request(this._mediaUrl,{method:"HEAD"})).then(function(e){_("amd",t._mediaUrl+"|"+e.headers.get("content-type"))}),_("xap"),this.onAdImpression()},L.prototype.onIMAInteraction=function(){this.onAdInteraction()},L.prototype.onIMALinearChanged=function(){this.onAdLinearChange()},L.prototype.onIMALoaded=function(t){this._currentAd=t.getAd(),this._currentAd.isLinear()||(this.destroyAd(),this.onAdError("ad is not linear")),this._lifecycleController&&this._lifecycleController.stop()},L.prototype.onIMALog=function(t){(t=t.getAdData()).hasOwnProperty("adError")?this.onAdLog(t.adError.getMessage()):this.onAdLog("IMA Ad Log")},L.prototype.onIMAMidpoint=function(){this._lifecycleController.refresh(),this.onAdVideoMidpoint()},L.prototype.onIMAPaused=function(){this._lifecycleController.stop(),this.onAdPaused()},L.prototype.onIMAResumed=function(){this.onAdPlaying()},L.prototype.onIMASkippableStateChanged=function(){this.onAdSkippableStateChange()},L.prototype.onIMASkipped=function(){this._lifecycleController.stop(),this.destroyAd(),this.onAdSkipped(),this.onAdStopped()},L.prototype.onIMAStarted=function(){var t=this;this._attributes.showMuteButton&&(this._volumeButton=new S,this._volumeButton.volume(this._attributes.volume),this._slot.appendChild(this._volumeButton.render()),this._volumeButton.onClick(function(){var e=t._attributes.volume?0:1;t.setAdVolume(e),t._volumeButton.volume(e),t._attributes.volume=e,_("amu",e?0:1)}),this._slot.onmouseover=this._volumeButton.show,this._slot.onmouseleave=this._volumeButton.hide),this.onAdStarted(),this.onAdVideoStart()},L.prototype.onIMAThirdQuartile=function(){this._lifecycleController.refresh(),this.onAdVideoThirdQuartile()},L.prototype.onIMAUserClose=function(){this.onAdUserClose()},L.prototype.onIMAVolumeChanged=function(){this.onAdVolumeChange()},L.prototype.onIMAVolumeMuted=function(){this.onAdVolumeChange()},L.prototype.onAdsManagerLoaded=function(t){var e=new google.ima.AdsRenderingSettings;e.restoreCustomPlaybackStateOnAdBreakComplete=!0,this._adsManager=t.getAdsManager(this._videoSlot,e),this._adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onIMAAdError.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.AD_BREAK_READY,function(){}),this._adsManager.addEventListener(google.ima.AdEvent.Type.AD_METADATA,function(){}),this._adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,this.onAllAdsCompleted.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.CLICK,this.onIMAClick.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,function(){}),this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,function(){}),this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(){}),this._adsManager.addEventListener(google.ima.AdEvent.Type.DURATION_CHANGE,this.onIMADurationChange.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.FIRST_QUARTILE,this.onIMAFirstQuartile.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.IMPRESSION,this.onIMAImpression.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.INTERACTION,this.onIMAInteraction.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.LINEAR_CHANGED,this.onIMALinearChanged.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,this.onIMALoaded.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.LOG,this.onIMALog.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.MIDPOINT,this.onIMAMidpoint.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.PAUSED,this.onIMAPaused.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.RESUMED,this.onIMAResumed.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,this.onIMASkippableStateChanged.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,this.onIMASkipped.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,this.onIMAStarted.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.THIRD_QUARTILE,this.onIMAThirdQuartile.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.USER_CLOSE,this.onIMAUserClose.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.VOLUME_CHANGED,this.onIMAVolumeChanged.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.VOLUME_MUTED,this.onIMAVolumeMuted.bind(this)),this.onAdLoaded()},L.prototype.onAdsManagerAdError=function(t){this.onAdError(t.getError().getErrorCode()+" "+t.getError().getMessage())},L.prototype.onAdLoaded=function(){this.VPAID_EVENTS.AdLoaded in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdLoaded]()},L.prototype.onAdStarted=function(){this.VPAID_EVENTS.AdStarted in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdStarted]()},L.prototype.onAdVideoStart=function(){this.VPAID_EVENTS.AdVideoStart in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoStart]()},L.prototype.onAdImpression=function(){this.VPAID_EVENTS.AdImpression in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdImpression]()},L.prototype.onAdClickThru=function(t,e,i){this.VPAID_EVENTS.AdClickThru in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdClickThru](t,e,i)},L.prototype.onAdVideoFirstQuartile=function(){this.VPAID_EVENTS.AdVideoFirstQuartile in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoFirstQuartile]()},L.prototype.onAdVideoMidpoint=function(){this.VPAID_EVENTS.AdVideoMidpoint in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoMidpoint]()},L.prototype.onAdVideoThirdQuartile=function(){this.VPAID_EVENTS.AdVideoThirdQuartile in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoThirdQuartile]()},L.prototype.onAdVideoComplete=function(){this.VPAID_EVENTS.AdVideoComplete in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoComplete]()},L.prototype.onAdPaused=function(){this.VPAID_EVENTS.AdPaused in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdPaused]()},L.prototype.onAdPlaying=function(){this.VPAID_EVENTS.AdPlaying in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdPlaying]()},L.prototype.onAdVolumeChange=function(){this.VPAID_EVENTS.AdVolumeChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVolumeChange]()},L.prototype.onAdStopped=function(){this.VPAID_EVENTS.AdStopped in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdStopped]()},L.prototype.onAdSkipped=function(){this.VPAID_EVENTS.AdSkipped in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdSkipped]()},L.prototype.onAdDurationChange=function(){this.VPAID_EVENTS.AdDurationChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdDurationChange]()},L.prototype.onAdInteraction=function(){this.VPAID_EVENTS.AdInteraction in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdInteraction]()},L.prototype.onAdLinearChange=function(){this.VPAID_EVENTS.AdLinearChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdLinearChange]()},L.prototype.onAdSkippableStateChange=function(){this.VPAID_EVENTS.AdSkippableStateChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdSkippableStateChange]()},L.prototype.onAdUserClose=function(){this.VPAID_EVENTS.AdUserClose in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdUserClose]()},L.prototype.onAdLog=function(t){this.VPAID_EVENTS.AdLog in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdLog](t)},L.prototype.onAdSizeChange=function(){this.VPAID_EVENTS.AdSizeChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdSizeChange]()},L.prototype.onAdExpandedChange=function(){this.VPAID_EVENTS.AdExpandedChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdExpandedChange]()},L.prototype.onAdError=function(t){this.VPAID_EVENTS.AdError in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdError](t)},L.prototype.maybeInitializeAdDisplayContainer=function(){this._adDisplayContainerInitialized||(this._adDisplayContainer.initialize(),this._adDisplayContainerInitialized=!0)},L.prototype.setUpIMA=function(){this.log("IMA LOADED"),this.log("setUpIMA"),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this._adDisplayContainer=new google.ima.AdDisplayContainer(this._slot,this._videoSlot),this._adsLoader=new google.ima.AdsLoader(this._adDisplayContainer),this._adsLoader.getSettings().setVpaidMode(this._attributes.useSecureIframe?google.ima.ImaSdkSettings.VpaidMode.ENABLED:google.ima.ImaSdkSettings.VpaidMode.INSECURE),this._adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded.bind(this),!1),this._adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdsManagerAdError.bind(this),!1),this._videoSlot.onended=this.doContentComplete;var t=y(d("ad_tag")),e=new google.ima.AdsRequest;e.adTagUrl=t,this._pageUrl&&(e.pageUrl=this._pageUrl),e.linearAdSlotWidth=this._attributes.width,e.linearAdSlotHeight=this._attributes.height,e.nonLinearAdSlotWidth=this._attributes.width,e.nonLinearAdSlotHeight=this._attributes.nonLinearSlotHeight,e.vastLoadTimeout=this._attributes.vastLoadTimeout,e.setAdWillAutoPlay(this._attributes.adWillAutoPlay),e.setAdWillPlayMuted(this._attributes.adWillPlayMuted),this._adsLoader.requestAds(e)},L.prototype.initAd=function(t,e,i,n,o,a){this._slot=a.slot,this._videoSlot=a.videoSlot,c(o.AdParameters),this._pageUrl=h("page_url",null),this._attributes.showMuteButton=!!parseInt(h("smb",1)),this._attributes.volume=parseInt(h("m",1))?0:1,this._attributes.muted=!!parseInt(h("m",1)),this._attributes.useSecureIframe=!!parseInt(h("sf",0)),this._attributes.adMediaData=!!parseInt(h("amd",1)),this._attributes.width=t,this._attributes.height=e,this._attributes.viewMode=i,this._attributes.desiredBitrate=n,this.log("initAd "+t+"x"+e+" "+i+" "+n),this._lifecycleController=new V;var s=this;function r(t){if("VIDEO"==t.tagName||"LIMA-VIDEO"==t.tagName){if("LIMA-VIDEO"==t.tagName){var e=t.load;t.load=function(){return this.muted=!0,e.apply(this,[].slice.call(arguments))}}var i=t.play;t.play=function(){var t=this;this.muted=!0,s._attributes.adMediaData&&(s._mediaUrl=""!=this.src?this.src:null),s._attributes.volume&&(s._attributes.volume=0,s._volumeButton&&s._volumeButton.volume(0));var e=i.apply(this,[].slice.call(arguments));return e instanceof Promise&&e.then(function(t){}).catch(function(e){t.muted=!0,t.play()}),e}}}if(this._attributes.muted){var d=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;void 0!==d&&new d(function(t){t.forEach(function(t){t.addedNodes.forEach(function(t){r(t),t.querySelectorAll&&t.querySelectorAll("video, lima-video").forEach(r)})})}).observe(this._slot.parentNode,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}this.log("loadIma and setUpIMA"),this.loadIMA(this.setUpIMA.bind(this))},L.prototype.handshakeVersion=function(t){return"2.0"},L.prototype.startAd=function(){this.playAd()},L.prototype.playAd=function(){this.maybeInitializeAdDisplayContainer();try{this._adsManager.init(this._attributes.width,this._attributes.height,this._attributes.viewMode),this._adsManager.start()}catch(t){this.destroyAd(),this.onAdError("IMA _adsManager INIT ERROR")}},L.prototype.getAdVolume=function(){return this.log("getAdVolume"),this._adsManager&&(this._attributes.volume=this._adsManager.getVolume()),this._attributes.volume},L.prototype.setAdVolume=function(t){this.log("setAdVolume "+t);var e=t!==this._attributes.volume;this._adsManager?this._adsManager.setVolume(t):e&&this.onAdVolumeChange(),this._attributes.volume=t},L.prototype.resumeAd=function(){this.log("resumeAd"),this._adsManager&&this._adsManager.resume()},L.prototype.pauseAd=function(){this.log("pauseAd"),this._adsManager&&this._adsManager.pause()},L.prototype.resizeAd=function(t,e,i){this.log("resizeAd "+t+"x"+e+" "+i),this._attributes.width=t,this._attributes.height=e,this._attributes.viewMode=i,this._adsManager&&this._adsManager.resize(t,e,i),this.onAdSizeChange()},L.prototype.stopAd=function(){this.log("Stopping ad"),this._adsManager&&this._adsManager.stop()},L.prototype.getAdExpanded=function(){return this.log("getAdExpanded"),this._attributes.expanded},L.prototype.collapseAd=function(){this.log("collapseAd"),this._attributes.expanded=!1,this._adsManager&&this._adsManager.collapse(),this.onAdExpandedChange()},L.prototype.expandAd=function(){this.log("expandAd"),this._attributes.expanded=!0,this._adsManager&&this._adsManager.expand(),this.onAdExpandedChange()},L.prototype.getAdSkippableState=function(){return!0},L.prototype.skipAd=function(){this._adsManager&&(this._adsManager.getAdSkippableState()&&this._adsManager.skip(),this.onIMASkipped())},L.prototype.subscribe=function(t,e,i){this.log("subscribe "+t);var n=t.bind(i);this._eventCallbacks[e]=n},L.prototype.unsubscribe=function(t){this.log("unsubscribe "+t),this._eventCallbacks[t]=null},L.prototype.getAdWidth=function(){return this._attributes.width},L.prototype.getAdHeight=function(){return this._attributes.height},L.prototype.getAdRemainingTime=function(){return this._adsManager?this._adsManager.getRemainingTime():-2},L.prototype.getAdDuration=function(){return this._currentAd?this._currentAd.getDuration():-2},L.prototype.getAdCompanions=function(){return this._currentAd?this._currentAd.getCompanionAds(this._attributes.width,this._attributes.height):[]},L.prototype.getAdIcons=function(){return this._attributes.icons},L.prototype.getAdLinear=function(){return!this._currentAd||this._currentAd.isLinear()},L.prototype.log=function(t){};var k={MIN:6e4,HOUR:36e5,DAY:864e5},P="ac_waterfall_frequency_";function w(t){return b(P+t)||{}}function R(t,e){try{return function(t){var e=t.name,i=t.value||"",n=t.path,o=t.maxAge,a=t.doNotTrack||!1;if(navigator.doNotTrack===a)return!1;try{document.cookie="".concat(e,"=").concat(i,";").concat(void 0!==n?";path=".concat(n):"").concat(void 0!==o?";max-age=".concat(o):"")}catch(t){throw new Error("Cookie set failed: ".concat(t))}}({name:P+t,value:e,path:"/",maxAge:86400,doNotTrack:!0}),!0}catch(t){return!1}}var x=function(t){!(arguments.length>1&&void 0!==arguments[1])||arguments[1],this._tags=t,this.sortTagsByTierAndPriority(this._tags),this._cycle=[],this._lastIndexInCycle=0,this._roundRobinResults={}};x.prototype.sortTagsByTierAndPriority=function(t){return t.sort(function(t,e){var i=t.tier,n=e.tier,o=t.priority,a=e.priority;return i==n?o<a?-1:o>a?1:0:i<n?-1:1}),t},x.prototype.setGetRoundRobinResult=function(t,e){return null!=this._roundRobinResults[t]?m(this._roundRobinResults[t]):(this._roundRobinResults[t]=e,m(this._roundRobinResults[t]))},x.prototype.getTagsByPriority=function(t,e){for(var i=[],n=0;n<t.length;n++)t[n].priority==e&&i.push(t[n]);return i},x.prototype.getCycle=function(){for(var t=[],e=[],i=0;i<this._tags.length;i++)e.push(this._tags[i].priority);for(var n=e.filter(function(t,e,i){return i.indexOf(t)===e}),o=0;o<n.length;o++){var a=this.getTagsByPriority(this._tags,n[o]);t.push(a.length>1?f(a)[0]:a[0])}return this.sortTagsByTierAndPriority(t),t},x.prototype.nextCycle=function(){this._cycle=this.getCycle()},x.prototype.nextTag=function(){var t=this;return new Promise(function(e,i){var n=null;t._lastIndexInCycle>=t._cycle.length&&(0==t._lastIndexInCycle&&0==t._cycle.length?(t.nextCycle(),t._lastIndexInCycle=0):i({error:"END_OF_CYCLE"}));for(var o=0;o<t._cycle.length;o++)if(o==t._lastIndexInCycle){n=t._cycle[o],t._lastIndexInCycle++;break}n?null!=n.bidder||(function(t){var e=t.frequency,i=t.id;if(null!=e){if("REQUEST"===e.type)return function(t,e,i,n){var o=w(n).value,a=Date.now(),s=("number"==typeof i?6e4*i:0)||(k.hasOwnProperty(e)?k[e]:null);if(!s)return!0;if(!o)return R(n,JSON.stringify([a,1])),!0;var r=N(JSON.parse(o||"[]"),2),d=r[0],l=r[1];return d&&l?a>d+s?(R(n,JSON.stringify([a,1])),!0):a<d+s&&l<t&&(R(n,JSON.stringify([d,l+1])),!0):(l=0,R(n,JSON.stringify([a,l+1])),!0)}(e.value,e.timePeriod,e.minutes,i);if("IMPRESSION"===e.type)return function(t,e,i,n){var o=w(n).value,a=Date.now(),s=("number"==typeof i?6e4*i:0)||(k.hasOwnProperty(e)?k[e]:null);if(!s)return!0;if(!o)return R(n,JSON.stringify([a,0])),!0;var r=N(JSON.parse(o||"[]"),2),d=r[0],l=r[1];return d&&l?a>d+s?(R(n,JSON.stringify([a,0])),!0):a<d+s&&l<t&&(R(n,JSON.stringify([d,l])),!0):(R(n,JSON.stringify([a,l])),!0)}(e.value,e.timePeriod,e.minutes,i)}return!0}(n)?e(n):i({error:"no tag for current time frame"})):i({error:"CYCLE_IS_EMPTY"})})};var U={},O=function(){this._slot=null,this._videoSlot=null,this.VPAID_EVENTS={AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdLoaded:"AdLoaded",AdLinearChange:"AdLinearChange",AdSizeChange:"AdSizeChange",AdExpandedChange:"AdExpandedChange",AdSkippableStateChange:"AdSkippableStateChange",AdDurationChange:"AdDurationChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdError:"AdError",AdLog:"AdLog"},this._eventCallbacks={},this._attributes={companions:"",desiredBitrate:256,duration:30,expanded:!1,width:0,height:0,nonLinearSlotHeight:150,viewMode:"normal",icons:"",linear:!0,remainingTime:10,skippableState:!1,volume:0,muted:!0,loadVideoTimeout:18e3,vastLoadTimeout:2e4,adWillAutoPlay:!0,adWillPlayMuted:!1,useSecureIframe:!1},this.IMA_SDK_URL="https://imasdk.googleapis.com/js/sdkloader/ima3.js",this._adsLoader=null,this._adDisplayContainer=null,this._adDisplayContainerInitialized=!1,this._adsManager=null,this._currentAd=null,this._lifecycleController=null,this._pageUrl=null};O.prototype.onIMAAdError=function(t){this.destroyAd(),this.onAdError(t.getError().getErrorCode()+" "+t.getError().getMessage()+" "+t.getError().getInnerError())},O.prototype.onIMAClick=function(t){this.onAdClickThru("",t.getAd().getAdId(),!1)},O.prototype.onIMADurationChange=function(){this.onAdDurationChange()},O.prototype.onIMAFirstQuartile=function(){this._lifecycleController.refresh(),this.onAdVideoFirstQuartile()},O.prototype.onIMAImpression=function(){this.stopAdRequestTimeout();var t=this;if(this._currentAd){var e=this._currentAd.getDuration();this._lifecycleController.init(e,function(){t.destroyAd(),t.onAdError("lifecycle timeout")}),this._lifecycleController.run()}this.onAdImpression()},O.prototype.onIMAInteraction=function(){this.onAdInteraction()},O.prototype.onIMALinearChanged=function(){this.onAdLinearChange()},O.prototype.onIMALoaded=function(t){this._currentAd=t.getAd(),this._currentAd.isLinear()||(this.destroyAd(),this.onAdError("ad is not linear")),this._lifecycleController&&this._lifecycleController.stop()},O.prototype.onIMALog=function(t){(t=t.getAdData()).hasOwnProperty("adError")?this.onAdLog(t.adError.getMessage()):this.onAdLog("IMA Ad Log")},O.prototype.onIMAMidpoint=function(){this._lifecycleController.refresh(),this.onAdVideoMidpoint()},O.prototype.onIMAPaused=function(){this._lifecycleController.stop(),this.onAdPaused()},O.prototype.onIMAResumed=function(){this.onAdPlaying()},O.prototype.onIMASkippableStateChanged=function(){this.onAdSkippableStateChange()},O.prototype.onIMASkipped=function(){this.destroyAd(),this.onAdSkipped(),this.onAdStopped()},O.prototype.onIMAStarted=function(){this.stopAdRequestTimeout(),this.onAdVideoStart()},O.prototype.onIMAThirdQuartile=function(){this._lifecycleController.refresh(),this.onAdVideoThirdQuartile()},O.prototype.onIMAUserClose=function(){this.onAdUserClose()},O.prototype.onIMAVolumeChanged=function(){this.onAdVolumeChange()},O.prototype.onIMAVolumeMuted=function(){this.onAdVolumeChange()},O.prototype.onAdsManagerLoaded=function(t){var e=new google.ima.AdsRenderingSettings;e.restoreCustomPlaybackStateOnAdBreakComplete=!0,e.loadVideoTimeout=this._attributes.loadVideoTimeout,this._adsManager=t.getAdsManager(this._videoSlot,e),this._adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onIMAAdError.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.AD_BREAK_READY,function(){}),this._adsManager.addEventListener(google.ima.AdEvent.Type.AD_METADATA,function(){}),this._adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,this.onAllAdsCompleted.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.CLICK,this.onIMAClick.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,function(){}),this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this.onAdStarted.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,function(){}),this._adsManager.addEventListener(google.ima.AdEvent.Type.DURATION_CHANGE,this.onIMADurationChange.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.FIRST_QUARTILE,this.onIMAFirstQuartile.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.IMPRESSION,this.onIMAImpression.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.INTERACTION,this.onIMAInteraction.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.LINEAR_CHANGED,this.onIMALinearChanged.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,this.onIMALoaded.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.LOG,this.onIMALog.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.MIDPOINT,this.onIMAMidpoint.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.PAUSED,this.onIMAPaused.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.RESUMED,this.onIMAResumed.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,this.onIMASkippableStateChanged.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,this.onIMASkipped.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,this.onIMAStarted.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.THIRD_QUARTILE,this.onIMAThirdQuartile.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.USER_CLOSE,this.onIMAUserClose.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.VOLUME_CHANGED,this.onIMAVolumeChanged.bind(this)),this._adsManager.addEventListener(google.ima.AdEvent.Type.VOLUME_MUTED,this.onIMAVolumeMuted.bind(this)),this.onAdLoaded()},O.prototype.onAdsManagerAdError=function(t){this.destroyAd(),this.onAdError(t.getError().getErrorCode()+" "+t.getError().getMessage())},O.prototype.onAllAdsCompleted=function(){this.destroyAd(),this.onAdVideoComplete(),this.onAdStopped()},O.prototype.onLoaded=function(){"Loaded"in this._eventCallbacks&&this._eventCallbacks.Loaded()},O.prototype.onError=function(){"Error"in this._eventCallbacks&&this._eventCallbacks.Error()},O.prototype.onAdLoaded=function(){this.VPAID_EVENTS.AdLoaded in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdLoaded]()},O.prototype.onAdStarted=function(){this.VPAID_EVENTS.AdStarted in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdStarted]()},O.prototype.onAdVideoStart=function(){this.VPAID_EVENTS.AdVideoStart in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoStart]()},O.prototype.onAdImpression=function(){this.VPAID_EVENTS.AdImpression in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdImpression]()},O.prototype.onAdClickThru=function(t,e,i){this.VPAID_EVENTS.AdClickThru in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdClickThru](t,e,i)},O.prototype.onAdVideoFirstQuartile=function(){this.VPAID_EVENTS.AdVideoFirstQuartile in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoFirstQuartile]()},O.prototype.onAdVideoMidpoint=function(){this.VPAID_EVENTS.AdVideoMidpoint in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoMidpoint]()},O.prototype.onAdVideoThirdQuartile=function(){this.VPAID_EVENTS.AdVideoThirdQuartile in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoThirdQuartile]()},O.prototype.onAdVideoComplete=function(){this.VPAID_EVENTS.AdVideoComplete in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoComplete]()},O.prototype.onAdPaused=function(){this.VPAID_EVENTS.AdPaused in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdPaused]()},O.prototype.onAdPlaying=function(){this.VPAID_EVENTS.AdPlaying in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdPlaying]()},O.prototype.onAdVolumeChange=function(){this.VPAID_EVENTS.AdVolumeChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVolumeChange]()},O.prototype.onAdStopped=function(){this.VPAID_EVENTS.AdStopped in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdStopped]()},O.prototype.onAdSkipped=function(){this.VPAID_EVENTS.AdSkipped in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdSkipped]()},O.prototype.onAdDurationChange=function(){this.VPAID_EVENTS.AdDurationChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdDurationChange]()},O.prototype.onAdInteraction=function(){this.VPAID_EVENTS.AdInteraction in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdInteraction]()},O.prototype.onAdLinearChange=function(){this.VPAID_EVENTS.AdLinearChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdLinearChange]()},O.prototype.onAdSkippableStateChange=function(){this.VPAID_EVENTS.AdSkippableStateChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdSkippableStateChange]()},O.prototype.onAdUserClose=function(){this.VPAID_EVENTS.AdUserClose in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdUserClose]()},O.prototype.onAdLog=function(t){this.VPAID_EVENTS.AdLog in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdLog](t)},O.prototype.onAdSizeChange=function(){this.VPAID_EVENTS.AdSizeChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdSizeChange]()},O.prototype.onAdExpandedChange=function(){this.VPAID_EVENTS.AdExpandedChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdExpandedChange]()},O.prototype.onAdError=function(t){this.VPAID_EVENTS.AdError in this._eventCallbacks&&"function"==typeof this._eventCallbacks[this.VPAID_EVENTS.AdError]&&this._eventCallbacks[this.VPAID_EVENTS.AdError](t)},O.prototype.doContentComplete=function(){this._adsLoader&&this._adsLoader.contentComplete()},O.prototype.destroyAd=function(){this._lifecycleController&&this._lifecycleController.stop(),this.stopAdRequestTimeout(),this._adsManager&&(this._adsManager.destroy(),this._adsManager=null),this.doContentComplete()},O.prototype.maybeInitializeAdDisplayContainer=function(){this._adDisplayContainerInitialized||(this._adDisplayContainer.initialize(),this._adDisplayContainerInitialized=!0)},O.prototype.setUpIMA=function(){google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),this._adDisplayContainer=new google.ima.AdDisplayContainer(this._slot,this._videoSlot),this._adsLoader=new google.ima.AdsLoader(this._adDisplayContainer),this._adsLoader.getSettings().setVpaidMode(this._attributes.useSecureIframe?google.ima.ImaSdkSettings.VpaidMode.ENABLED:google.ima.ImaSdkSettings.VpaidMode.INSECURE),this._adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded.bind(this),!1),this._adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdsManagerAdError.bind(this),!1),this._videoSlot.onended=this.doContentComplete,this.onLoaded()},O.prototype.loadIMA=function(t){var e=document.getElementsByTagName("head")[0]||document.documentElement,i=document.createElement("script");i.type="text/javascript",i.src=this.IMA_SDK_URL,i.async=!0,i.addEventListener("load",function(){t(!0)},!1),i.addEventListener("error",function(){e.removeChild(i),t(!1)},!1),e.insertBefore(i,e.firstChild)},O.prototype.initAd=function(t,e,i,n,o,a){this._slot=a.slot,this._videoSlot=a.videoSlot,c(o.AdParameters),this._pageUrl=h("page_url",null),this._attributes.useSecureIframe=!!parseInt(h("sf",0)),this._attributes.width=t,this._attributes.height=e,this._attributes.viewMode=i,this._attributes.desiredBitrate=n;var s=this;this._lifecycleController=new V,this.loadIMA(function(t){t?s.setUpIMA():s.onError("ima sdk not loaded")})},O.prototype.startAd=function(){this.maybeInitializeAdDisplayContainer();try{this._adsManager.init(this._attributes.width,this._attributes.height,this._attributes.viewMode),this._adsManager.start()}catch(t){this.destroyAd(),this.onAdError("IMA _adsManager INIT ERROR")}},O.prototype.stopAdRequestTimeout=function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=void 0)},O.prototype.startAdRequestTimeout=function(t){this.stopAdRequestTimeout();var e=t||this._attributes.vastLoadTimeout,i=this;this._timeout=setTimeout(function(){i.destroyAd(),i.onAdError("ad rejected by timeout ("+e/1e3+" seconds)")},e)},O.prototype.requestAd=function(t,e){var i=new google.ima.AdsRequest;i.adTagUrl=t,this._pageUrl&&(i.pageUrl=this._pageUrl),i.linearAdSlotWidth=this._attributes.width,i.linearAdSlotHeight=this._attributes.height,i.nonLinearAdSlotWidth=this._attributes.width,i.nonLinearAdSlotHeight=this._attributes.nonLinearSlotHeight,i.vastLoadTimeout=this._attributes.vastLoadTimeout,i.setAdWillAutoPlay(this._attributes.adWillAutoPlay),i.setAdWillPlayMuted(this._attributes.adWillPlayMuted),this._adsLoader.requestAds(i),this.startAdRequestTimeout(e)},O.prototype.resumeAd=function(){this._adsManager&&this._adsManager.resume()},O.prototype.pauseAd=function(){this._adsManager&&this._adsManager.pause()},O.prototype.stopAd=function(){this._adsManager&&this._adsManager.stop()},O.prototype.getAdSkippableState=function(){return!0},O.prototype.skipAd=function(){this._adsManager&&(this._adsManager.getAdSkippableState()&&this._adsManager.skip(),this.onIMASkipped())},O.prototype.getAdRemainingTime=function(){return this._adsManager?this._adsManager.getRemainingTime():-2},O.prototype.getAdDuration=function(){return this._currentAd?this._currentAd.getDuration():-2},O.prototype.getAdVolume=function(){return this._adsManager&&(this._attributes.volume=this._adsManager.getVolume()),this._attributes.volume},O.prototype.setAdVolume=function(t){var e=t!==this._attributes.volume;this._adsManager?this._adsManager.setVolume(t):e&&this.onAdVolumeChange(),this._attributes.volume=t},O.prototype.resizeAd=function(t,e,i){this._attributes.width=t,this._attributes.height=e,this._attributes.viewMode=i,this._adsManager&&this._adsManager.resize(t,e,i),this.onAdSizeChange()},O.prototype.getAdExpanded=function(){return this._attributes.expanded},O.prototype.collapseAd=function(){this._attributes.expanded=!1,this._adsManager&&this._adsManager.collapse(),this.onAdExpandedChange()},O.prototype.expandAd=function(){this._attributes.expanded=!0,this._adsManager&&this._adsManager.expand(),this.onAdExpandedChange()},O.prototype.subscribe=function(t,e,i){var n=t.bind(i);this._eventCallbacks[e]=n},O.prototype.unsubscribe=function(t){this._eventCallbacks[t]=null};var z,j=O,Q=function(){this._slot=null,this._videoSlot=null,this.VPAID_EVENTS={AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdLoaded:"AdLoaded",AdLinearChange:"AdLinearChange",AdSizeChange:"AdSizeChange",AdExpandedChange:"AdExpandedChange",AdSkippableStateChange:"AdSkippableStateChange",AdDurationChange:"AdDurationChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AllAdsCompleted:"AllAdsCompleted",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdError:"AdError",AdLog:"AdLog"},this._eventCallbacks={},this._attributes={companions:"",desiredBitrate:256,duration:30,expanded:!1,width:0,height:0,nonLinearSlotHeight:150,viewMode:"normal",icons:"",linear:!0,remainingTime:10,skippableState:!1,showMuteButton:!0,volume:0,muted:!0,loadVideoTimeout:18e3,vastLoadTimeout:2e4,adWillAutoPlay:!0,adWillPlayMuted:!1,useSecureIframe:!1,adMediaData:!0},this.AD_SERVER_URL="",this.AD_EVENTS_SERVER_URL="https://marketplace.anyclip.com/v1/events",this.TRACKING_EVENTS={AdRequest:"arq",AdLoaded:"alo",AdClickThru:"acl",AdImpression:"imp",AdComplete:"acp",AdError:"aer"},this._params={sessionId:null,publisherId:null,widgetId:null,viewable:!0,supplyTagId:null,clipId:null,abVariant:null,device:null,domain:null,browser:null,os:null,gdpr:null,usp:null,schain:null},this._waterfall=null,this._imaManager=null,this._volumeButton=null,this._pageUrl=null,this._mediaUrl=null};Q.prototype.onAdLoaded=function(){this.VPAID_EVENTS.AdLoaded in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdLoaded]()},Q.prototype.onAdStarted=function(){var t=this;this._attributes.showMuteButton&&(this._volumeButton=new S,this._volumeButton.volume(this._attributes.volume),this._slot.appendChild(this._volumeButton.render()),this._volumeButton.onClick(function(){var e=t._attributes.volume?0:1;t.setAdVolume(e),t._volumeButton.volume(e),t._attributes.volume=e,_("amu",e?0:1)}),this._slot.onmouseover=this._volumeButton.show,this._slot.onmouseleave=this._volumeButton.hide),this.VPAID_EVENTS.AdStarted in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdStarted]()},Q.prototype.onAdVideoStart=function(){this.VPAID_EVENTS.AdVideoStart in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoStart]()},Q.prototype.onAdImpression=function(){var t=this;this._attributes.adMediaData&&null!=this._mediaUrl&&fetch(new Request(this._mediaUrl,{method:"HEAD"})).then(function(e){_("amd",t._mediaUrl+"|"+e.headers.get("content-type"))}),_("xap"),this.VPAID_EVENTS.AdImpression in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdImpression]()},Q.prototype.onAdClickThru=function(t,e,i){this.VPAID_EVENTS.AdClickThru in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdClickThru](t,e,i)},Q.prototype.onAdVideoFirstQuartile=function(){this.VPAID_EVENTS.AdVideoFirstQuartile in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoFirstQuartile]()},Q.prototype.onAdVideoMidpoint=function(){this.VPAID_EVENTS.AdVideoMidpoint in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoMidpoint]()},Q.prototype.onAdVideoThirdQuartile=function(){this.VPAID_EVENTS.AdVideoThirdQuartile in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoThirdQuartile]()},Q.prototype.onAdVideoComplete=function(){this.VPAID_EVENTS.AdVideoComplete in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVideoComplete]()},Q.prototype.onAdPaused=function(){this.VPAID_EVENTS.AdPaused in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdPaused]()},Q.prototype.onAdPlaying=function(){this.VPAID_EVENTS.AdPlaying in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdPlaying]()},Q.prototype.onAdVolumeChange=function(){this.VPAID_EVENTS.AdVolumeChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdVolumeChange]()},Q.prototype.onAdStopped=function(){this.VPAID_EVENTS.AdStopped in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdStopped]()},Q.prototype.onAdSkipped=function(){this.VPAID_EVENTS.AdSkipped in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdSkipped]()},Q.prototype.onAdDurationChange=function(){this.VPAID_EVENTS.AdDurationChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdDurationChange]()},Q.prototype.onAdInteraction=function(){this.VPAID_EVENTS.AdInteraction in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdInteraction]()},Q.prototype.onAdLinearChange=function(){this.VPAID_EVENTS.AdLinearChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdLinearChange]()},Q.prototype.onAdSkippableStateChange=function(){this.VPAID_EVENTS.AdSkippableStateChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdSkippableStateChange]()},Q.prototype.onAdUserClose=function(){this.VPAID_EVENTS.AdUserClose in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdUserClose]()},Q.prototype.onAdLog=function(t){this.VPAID_EVENTS.AdLog in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdLog](t)},Q.prototype.onAdSizeChange=function(){this.VPAID_EVENTS.AdSizeChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdSizeChange]()},Q.prototype.onAdExpandedChange=function(){this.VPAID_EVENTS.AdExpandedChange in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdExpandedChange]()},Q.prototype.onAdError=function(t){this.VPAID_EVENTS.AdError in this._eventCallbacks&&this._eventCallbacks[this.VPAID_EVENTS.AdError](t)},Q.prototype.handshakeVersion=function(t){return"2.0"},Q.prototype.initAd=function(t,e,i,n,o,a){this._slot=a.slot,this._videoSlot=a.videoSlot,c(o.AdParameters),this.AD_SERVER_URL=y(d("ad_tag")),this._pageUrl=h("page_url",null),this._params.supplyTagId=v(this.AD_SERVER_URL,"sti"),this._params.sessionId=v(this.AD_SERVER_URL,"sid"),this._params.publisherId=v(this.AD_SERVER_URL,"pid"),this._params.widgetId=v(this.AD_SERVER_URL,"wid"),this._params.viewable=!!parseInt(v(this.AD_SERVER_URL,"v",1)),this._params.clipId=v(this.AD_SERVER_URL,"cid"),this._params.abVariant=v(this.AD_SERVER_URL,"abc",""),this._params.device=v(this.AD_SERVER_URL,"dev"),this._params.domain=v(this.AD_SERVER_URL,"dom"),this._params.browser=v(this.AD_SERVER_URL,"bw"),this._params.os=v(this.AD_SERVER_URL,"os"),this._attributes.showMuteButton=!!parseInt(h("smb",1)),this._attributes.volume=parseInt(h("m",1))?0:1,this._attributes.muted=!!parseInt(h("m",1)),this._attributes.useSecureIframe=!!parseInt(h("sf",0)),this._attributes.adMediaData=!!parseInt(h("amd",1)),this._attributes.width=t,this._attributes.height=e,this._attributes.viewMode=i,this._attributes.desiredBitrate=n;var s=this;function r(t){if("VIDEO"==t.tagName||"LIMA-VIDEO"==t.tagName){if("LIMA-VIDEO"==t.tagName){var e=t.load;t.load=function(){return this.muted=!0,e.apply(this,[].slice.call(arguments))}}var i=t.play;t.play=function(){var t=this;this.muted=!0,s._attributes.adMediaData&&(s._mediaUrl=""!=this.src?this.src:null),s._attributes.volume&&(s._attributes.volume=0,s._volumeButton&&s._volumeButton.volume(0));var e=i.apply(this,[].slice.call(arguments));return e instanceof Promise&&e.then(function(t){}).catch(function(e){t.muted=!0,t.play()}),e}}}if(this._attributes.muted){var l=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;void 0!==l&&new l(function(t){t.forEach(function(t){t.addedNodes.forEach(function(t){r(t),t.querySelectorAll&&t.querySelectorAll("video, lima-video").forEach(r)})})}).observe(this._slot.parentNode,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}(function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise(function(i,n){U[t]?i(U[t].waterfall):(U[t]={url:t,waterfall:null},fetch(t).then(function(t){return t.json()}).then(function(o){o.data&&0!=o.data.length?(U[t].waterfall=new x(o.data,e),i(U[t].waterfall)):(U[t]=void 0,n({error:"fetch response empty, no tags"}))}).catch(function(e){U[t]=void 0,n({error:"fetch error "+e})}))})})(this.AD_SERVER_URL,this._params.viewable).then(function(r){s._waterfall=r,s._imaManager=new j,s._imaManager.subscribe(function(t){s.onAdError(t)},"Error"),s._imaManager.subscribe(function(){s.requestAd()},"Loaded"),s._imaManager.initAd(t,e,i,n,o,a)}).catch(function(t){s.onAdError(t.error)})},Q.prototype.requestAd=function(){var t=this,e=!1;t._waterfall&&t._imaManager&&function i(){t._waterfall.nextTag().then(function(n){var o=function(t,e){try{new URL(t).searchParams.forEach(function(t,i){e=e.replace(new RegExp("\\$\\["+i+"]","g"),t)})}catch(t){}return e}(t.AD_SERVER_URL,n.adServer.url);t._imaManager.subscribe(function(){e?t._imaManager.startAd():(e=!0,t.onAdLoaded()),t.trackEvent(t.TRACKING_EVENTS.AdLoaded,n.id,n.cpm)},t.VPAID_EVENTS.AdLoaded),t._imaManager.subscribe(function(){t.onAdLinearChange()},t.VPAID_EVENTS.AdLinearChange),t._imaManager.subscribe(function(){t.onAdSizeChange()},t.VPAID_EVENTS.AdSizeChange),t._imaManager.subscribe(function(){t.onAdDurationChange()},t.VPAID_EVENTS.AdDurationChange),t._imaManager.subscribe(function(){!function(t){var e=t.frequency,i=t.id;if(void 0!==e&&(null==e||"IMPRESSION"==e.type)){var n=w(i).value,o=Date.now(),a=N(JSON.parse(n||"[]"),2),s=(a[0],a[1]);R(i,JSON.stringify([o,s+1]))}}(n),t.trackEvent(t.TRACKING_EVENTS.AdImpression,n.id,n.cpm),t.trackExternalEvents(t.TRACKING_EVENTS.AdImpression,n.events),t.onAdImpression()},t.VPAID_EVENTS.AdImpression),t._imaManager.subscribe(function(e,i,o){t.trackExternalEvents(t.TRACKING_EVENTS.AdClickThru,n.events),t.onAdClickThru(e,i,o)},t.VPAID_EVENTS.AdClickThru),t._imaManager.subscribe(function(){t.onAdStarted()},t.VPAID_EVENTS.AdStarted),t._imaManager.subscribe(function(){t.onAdVideoStart()},t.VPAID_EVENTS.AdVideoStart),t._imaManager.subscribe(function(){t.onAdPaused()},t.VPAID_EVENTS.AdPaused),t._imaManager.subscribe(function(){t.onAdPlaying()},t.VPAID_EVENTS.AdPlaying),t._imaManager.subscribe(function(){t.onAdVolumeChange()},t.VPAID_EVENTS.AdVolumeChange),t._imaManager.subscribe(function(){t.onAdInteraction()},t.VPAID_EVENTS.AdInteraction),t._imaManager.subscribe(function(){t.onAdVideoFirstQuartile()},t.VPAID_EVENTS.AdVideoFirstQuartile),t._imaManager.subscribe(function(){t.onAdVideoMidpoint()},t.VPAID_EVENTS.AdVideoMidpoint),t._imaManager.subscribe(function(){t.onAdVideoThirdQuartile()},t.VPAID_EVENTS.AdVideoThirdQuartile),t._imaManager.subscribe(function(){t.trackExternalEvents(t.TRACKING_EVENTS.AdComplete,n.events),t.onAdVideoComplete(),t.onAdStopped()},t.VPAID_EVENTS.AdVideoComplete),t._imaManager.subscribe(function(){t.onAdSkipped(),t.onAdStopped()},t.VPAID_EVENTS.AdSkipped),t._imaManager.subscribe(function(e){t.trackEvent(t.TRACKING_EVENTS.AdError,n.id,n.cpm),i()},t.VPAID_EVENTS.AdError),t._mediaUrl=null,t._imaManager.requestAd(o,n.timeout),t.trackEvent(t.TRACKING_EVENTS.AdRequest,n.id,n.cpm),t.trackExternalEvents(t.TRACKING_EVENTS.AdRequest,n.events)}).catch(function(e){"END_OF_CYCLE"===e.error||"CYCLE_IS_EMPTY"===e.error?t.onAdError(e.error):i()})}()},Q.prototype.startAd=function(){this._imaManager&&this._imaManager.startAd()},Q.prototype.getAdVolume=function(){return this._imaManager&&(this._attributes.volume=this._imaManager.getAdVolume()),this._attributes.volume},Q.prototype.setAdVolume=function(t){var e=t!==this._attributes.volume;this._imaManager?this._imaManager.setAdVolume(t):e&&this.onAdVolumeChange(),this._attributes.volume=t},Q.prototype.resumeAd=function(){this._imaManager&&this._imaManager.resumeAd()},Q.prototype.pauseAd=function(){this._imaManager&&this._imaManager.pauseAd()},Q.prototype.stopAd=function(){this._imaManager&&this._imaManager.stopAd()},Q.prototype.resizeAd=function(t,e,i){this._attributes.width=t,this._attributes.height=e,this._attributes.viewMode=i,this._imaManager&&this._imaManager.resizeAd(t,e,i)},Q.prototype.getAdExpanded=function(){return this._attributes.expanded},Q.prototype.collapseAd=function(){this._attributes.expanded=!1,this._imaManager&&this._imaManager.collapseAd()},Q.prototype.expandAd=function(){this._attributes.expanded=!0,this._imaManager&&this._imaManager.expandAd()},Q.prototype.getAdSkippableState=function(){return!0},Q.prototype.skipAd=function(){this._imaManager&&this._imaManager.skipAd()},Q.prototype.getAdWidth=function(){return this._attributes.width},Q.prototype.getAdHeight=function(){return this._attributes.height},Q.prototype.getAdRemainingTime=function(){return this._imaManager?this._imaManager.getAdRemainingTime():-2},Q.prototype.getAdDuration=function(){return this._imaManager?this._imaManager.getAdDuration():-2},Q.prototype.getAdCompanions=function(){return[]},Q.prototype.getAdIcons=function(){return this._attributes.icons},Q.prototype.getAdLinear=function(){return!this._imaManager._currentAd||this._imaManager._currentAd.isLinear()},Q.prototype.doContentComplete=function(){},Q.prototype.destroyAd=function(){this.doContentComplete()},Q.prototype.subscribe=function(t,e,i){var n=t.bind(i);this._eventCallbacks[e]=n},Q.prototype.unsubscribe=function(t){this._eventCallbacks[t]=null},Q.prototype.log=function(t){},Q.prototype.trackEvent=function(t,e,i){var n,o=(n={ty:t,sti:this._params.supplyTagId,dti:e,cpm:i,sid:this._params.sessionId,pid:this._params.publisherId,wid:this._params.widgetId,v:this._params.viewable?1:0,cid:this._params.clipId,abc:this._params.abVariant,dev:this._params.device,dom:this._params.domain,bw:this._params.browser,os:this._params.os},new URLSearchParams(n).toString());(new Image).src=this.AD_EVENTS_SERVER_URL+"?"+o},Q.prototype.executeExternalTracking=function(t,e){if(t&&e)switch(t){case"img":(new Image).src=e;break;case"script":var i=document.createElement("script");i.src=e,this._slot.appendChild(i)}},Q.prototype.trackExternalEvents=function(t,e){var i=this;e&&e[t]&&e[t].forEach(function(t){try{i.executeExternalTracking(t.type,t.value)}catch(t){}})};try{z=o.findScript(new RegExp("lreprx.js")).src,a=new URL(z).searchParams,g("2-2"),d("ad_tag")}catch(t){}_("xlo","1.1.12_187_prod"),window.getVPAIDAd=function(){return null!=d("wf")&&0!=parseInt(d("wf"))?new Q:null!=d("imaw")&&0!=parseInt(d("imaw"))?new L:new D}}]);