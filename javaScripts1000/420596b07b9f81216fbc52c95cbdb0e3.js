function SetRegionLangugeFormEvents(){function i(){function t(){var n=$("#header")[0];return n==null?0:n.clientHeight+n.offsetTop}$(".map-flag-link").click(function(){n.css("top",parseInt(t())-1);n.toggle();var i=$(".flaglazyload");i.each(function(){$(this).attr("src")!=$(this).attr("data-original")&&$(this).attr("src",$(this).attr("data-original"))})});$(".mobile-map-flag-old").click(function(){showMap()});var r=$($(".sell-pad-mobile")[0]),i=r.find("div.close-exp-mobile")[0];i&&$(i).click(function(){n.css("top",parseInt(t())-1)});$(window).resize(function(){n.css("top",parseInt(t())-1)})}function r(){var s=n.find("#RegionTLD_child").find("a.selected")[0],h=n.find("#LanguageTLD_child").find("a.selected")[0],c=n.find("#LanguageTLD_child").find("a.DefaultItem")[0],i=null,r=null,e=null,f,o;s&&(i=JSON.parse(s.getAttribute("value")));h&&(r=JSON.parse(h.getAttribute("value")));c&&(e=JSON.parse(c.getAttribute("value")));(i||r)&&(f="",n.toggle(),i&&!i.isUserSelected?i.dotComDomain?SetCookieAndRedirect(i.tld,i.dotComDomain,i.data):(o=null,f=i.data,(r&&!r.isTldDefault&&r.languageForTld.trim().toLowerCase()!==i.tld.trim().toLowerCase()&&SiteSupportsTranslation(i.site)||e&&e.languageForTld.trim().toLowerCase()!==i.tld.trim().toLowerCase()&&!e.isTldDefault)&&(o=r?r.cultureCode:e.cultureCode,f=SetQueryString(f,"Lang",o)),SetLowerPubsPreferredTLDCookieAndRedirect(i.tld,f)):r&&!r.isUserSelected&&(f=RemoveQueryString(window.location.href,"Lang"),r.isTldDefault?r.isTldDefault&&u(r):f=SetQueryString(f,"Lang",r.cultureCode),f=t(f),window.location.replace(f)))}function u(t){var r="UserSettingsSession",i=getCookie(r),u=n.find("#LanguageTLD_child").find("a.DefaultItem")[0],f=JSON.parse(u.getAttribute("value"));i&&(i=i.replace("Lang="+f.cultureCode,"Lang="+t.cultureCode),document.cookie=r+"="+i+"; path=/")}var n=$(".region-language-drop.cf"),t;SetRegionLanguageDLLEvents(n,"Region");SetRegionLanguageDLLEvents(n,"Language");i();n.submit(function(n){n.preventDefault();r()});t=function(n){var t=n;return["TLDPrefSet","keeponsite","keeponsitesc","gtmlt","_ga"].forEach(function(n){t=RemoveQueryString(t,n)}),t}}function SiteSupportsTranslation(n){return/machinerytrader|truckpaper|tractorhouse/i.test(n)}function SetRegionLanguageDLLEvents(n,t){var f="#"+t+"TLD_title",o=n.find(f),u=n.find("#"+t+"TLD_title"),i=n.find("#"+t+"TLD_child"),e=i.find("a"),r;u.click(function(){t=="Region"&&n.find("#LanguageTLD_child").hide();i.toggle()});r=u.find(".ddTitleText")[0];$.each(e,function(){var u=JSON.parse(this.getAttribute("value"));u&&u.isUserSelected==!0&&(this.style.backgroundColor="#66CCFF");$(this).click(function(){var u=$(this),e=JSON.parse(u.attr("value")),f;t=="Region"&&(n.find("div.column12")[1].style.display=SiteSupportsTranslation(e.site)?"block":"none");$(r.children[0]).attr("src",u.find("img").attr("src"));$(r.children[1]).text(u.find("span").text());f=$(i.find("a.selected"));f.removeClass("selected");u.addClass("selected");u.siblings(".DefaultItem").css("background-color","");i.toggle()})})}function showMap(){$(".language-map").toggle();$(".language-map-mobile").toggle();$(".language-map-overlay").toggle();$(window).width()<=785&&$("#main").toggle()}function CloseMap(n){$(".language-map").hide();$(".language-map-mobile").hide();$(".language-map-overlay").hide();var t=$("#main");t&&t.show();(n===undefined||n==!1)&&SetCloseMapCookie()}function SetCloseMapCookie(){if(document.cookie.indexOf("KeepUserOnSite")==-1)document.cookie="KeepUserOnSite=True; path=/"}function ShowLinkOptions(n,t,i){ShowLinkOptionsWithTld(n,t,"USA",".com","True",i)}function ShowLinkOptionsWithTld(n,t,i,r,u,f){function c(){var t=window.location.pathname,n,i;return(t&&t!==""&&(n=t.replace(/^\/+/g,"").split("/")),n.length>2&&(n[0].toLowerCase()=="listings"||n[0].toLowerCase()=="parts")&&(i=n[1],i))?i.toLocaleLowerCase():null}function l(n,t){if(t){if(["construction-equipment","plant-equipment","construction-attachment","plant-attachment"].indexOf(t)>-1)return n==".nl"?"machinery-trader":"machinerytrader";if(["farm-equipment","farm-machinery","farm-attachment","farm-machinery-attachment"].indexOf(t)>-1)return n==".ie"?"farmandplant":n==".co.uk"?"farmmachinerylocator":n==".es"?"moma":n==".fr"?"agri-business":n==".de"?"tractor-house":"tractorhouse";if(["trucks","trailers","truck-trailer-attachment","truck-components"].indexOf(t)>-1)return n==".co.uk"||n==".ie"?"trucklocator":"truckpaper"}return null}function e(n,t){return url=n.scheme+"://"+n.subdomain+"."+n.siteName+n.tld+t,url=SetQueryString(url,"keeponsite","true"),url=SetQueryString(url,"gtmlt","1")}function s(n){var i=n.tld,t=n.siteName;switch(i){case".ie":return t=="truckpaper"||t=="tractorhouse";case".co.uk":return!0;case".com.au":return t=="truckpaper";case".it":return t=="machinerytrader"}return!1}function o(n,t,i,r){var u,o,f,a;return(n=n.replace(t,i),u=h(n,r),typeof r!="undefined"&&r!==null&&r!==""&&(f=c(),f&&f!=="other-items"?(o=u.isCTCat?"cranetrader":l(i,f),o&&(n=n.indexOf(o)>-1||(o=="machinerytrader"||"machinery-trader")&&n.indexOf("cranetrader")>-1&&u.isDetails?!s(u)||u.isDetails?e(u,r):e(u,"/"):e(u,"/"))):n=f&&f=="other-items"&&!s(u)?e(u,r):e(u,"/")),n.indexOf("gtmlt=1")>-1&&(n=RemoveQueryString(n,"_ga"),a=GetLinkTrackerParam(),a&&(n+="&"+a)),u.isDetails&&(n=RemoveQueryString(n,"isdetails")),u.isCTCat&&(n=RemoveQueryString(n,"isctcat")),u.siteName=="machinerytrader"&&(u.tld==".it"||u.tld==".de"))?"https://www.machinerytrader"+u.tld:n}function h(n,t){var r,u,i,f,e,o;if(n.indexOf("http")>-1&&(r=n.split("://"),r.length>1&&(u=r[0],i=r[1].split("/")[0],i=i.split("."),i.length>1))){var s=i[0],h=i[1],f=!1,e=!1;return t&&(f=t.indexOf("isdetails=1")>-1,e=t.indexOf("isctcat=1")>-1),o=i.length==3?"."+i[2]:"."+i[2]+"."+i[3],{scheme:u,subdomain:s,siteName:h.toLowerCase(),tld:o,isDetails:f,isCTCat:e}}return null}t=="False"&&$(".map-country-list").hide();n.toUpperCase()=="USA"&&$(".map-country-list.usa a").each(function(){var i=$(this),t=i.attr("href"),n=h(t),s,e;n&&(this.id!="crane-tab"&&this.id!="TPBusiness-tab"?n.siteName==="auctiontime"?(s=[".co.uk",".com",".de",".es",".fr",".it"].indexOf(r)>-1,s?i.attr("href",o(t,n.tld,r,null)):i.attr("href",o(t,n.tld,".com",null))):(n.siteName==="machinerytrader"&&r===".nl"?t=t.replace(n.siteName,"machinery-trader"):n.siteName==="tractorhouse"&&r===".de"?t=t.replace(n.siteName,"tractor-house"):n.siteName.indexOf("-")>-1&&!(n.siteName=="agri-business")&&(t=t.replace(n.siteName,n.siteName.replace("-",""))),i.attr("href",o(t,n.tld,r,f))):this.id=="crane-tab"&&(u=="True"?(e=r,r===".co.uk"&&(e=".uk"),i.attr("href",o(t,n.tld,e,f)),$(this).show()):$(this).hide()))});i.toUpperCase()=="UNITED KINGDOM"?($("#tractorhouse-tab, #truck-tab").hide(),$("#trucklocator-tab, #farmmachinerylocator-tab").show()):i.toUpperCase()=="IRELAND"?($("#tractorhouse-tab, #truck-tab").hide(),$("#trucklocator-tab, #farmandplant-tab").show()):i.toUpperCase()=="AUSTRALIA"?($("#truck-tab").hide(),$("#truckworld-tab").show()):[".fr",".es"].indexOf(r)>-1?($("#tractorhouse-tab").hide(),$("#"+(r.toLowerCase()==".fr"?"agribusiness-tab, #tpbusiness-tab":"moma-tab")).show()):($("#tractorhouse-tab, #truck-tab").show(),$("#trucklocator-tab, #farmmachinerylocator-tab, #farmandplant-tab, #agribusiness-tab, #moma-tab, #tpbusiness-tab, #truckworld-tab").hide());$(".map-country-list."+n.toLowerCase()+" .map-country-list-title").html(i);$(".map-country-list."+n.toLowerCase()).fadeIn(300)}function CloseSelection(n){$(".map-country-list."+n.toLowerCase()).fadeOut(300)}function SetCookieAndRedirect(n,t,i){var r="",f="",e=String(document.location),o,u;i!=""&&(i.indexOf("isdetails")>-1&&(i=RemoveQueryString(i,"isdetails")),f="&to="+escape(i));o=/machinerytrader|tractorhouse|truckpaper/i.test(e)&&!/\/map/i.test(e);r="http://"+t+"/map/SetLocalePreference.aspx?tld="+n+f;FlagUserSelectedTLDCookie();i.indexOf("gtmlt=1")>-1&&(u=GetLinkTrackerParam(),u&&(r+=encodeURIComponent("&"+u)));o==!0?(window.open(r,"_blank"),CloseMap(!0)):window.location=r}function GetLinkTrackerParam(){var n=window[window.GoogleAnalyticsObject];return n?n.getAll()[0].get("linkerParam"):null}function SetLowerPubsPreferredTLDCookieAndRedirect(n,t){if(t.indexOf("gtmlt=1")>-1){var i=GetLinkTrackerParam();i&&(t+="&"+i)}t.toLowerCase().indexOf("machinerytrader.it")>-1||t.toLowerCase().indexOf("machinerytrader.de")>-1?window.location="https://www.machinerytrader."+(n.charAt(0)==="."?n.substring(1):n):window.location.href=t}function FlagUserSelectedTLDCookie(){var n=new Date,t;n.setTime(n.getTime()+31536e6);t="expires="+n.toUTCString();document.cookie="UserSelectedTLD=True; "+t+"; path=/"}function LowerPubUserSelectedTLDCookie(n){var r=n,t=new Date,i;t.setTime(t.getTime()+31536e6);i="expires="+t.toUTCString();document.cookie="LowerPubPreferredTLD="+r+"; "+i+"; path=/"}function SetRegionSortCookie(n){AddAntiForgeryToken=function(n){return n.__RequestVerificationToken=$("#__AjaxAntiForgeryForm_RegionMap input[name=__RequestVerificationToken]").val(),n};$.ajax({url:"/UserSettings/DefaultMap",type:"post",dataType:"json",data:AddAntiForgeryToken({region:n}),success:function(){location.reload()}})}function RemoveQueryString(n,t){var u=n.split("?"),f,i,r;if(u.length>=2){for(f=encodeURIComponent(t)+"=",i=u[1].split(/[&;]/g),r=i.length;r-->0;)i[r].toLowerCase().lastIndexOf(f.toLowerCase(),0)!==-1&&i.splice(r,1);return u[0]+(i.length>0?"?"+i.join("&"):"")}return n}function SetQueryString(n,t,i){var u=new RegExp("([?&])"+t+"=.*?(&|$)","i"),r=n.indexOf("?"),f="";return r!==n.length-1&&(f=r!==-1&&r!==n.length-1?"&":"?"),n.match(u)?n.replace(u,"$1"+t+"="+i+"$2"):n+f+t+"="+i}function InitCountrySelector(n){function r(){$.each(t,function(n,t){t=$(t);t.attr("class")=="continent-overlay"?(t.show(),parseInt(window.innerWidth)<815&&scroll(0,0)):t.hide()})}n=$(n);var i=$(".country-selector"),t=n.find("div[class*='-overlay']");i&&i.click(function(){var n=$("div #europe");n.toggle();$.each(t,function(n,t){$(t).attr("id")!=="europe"&&$(t).hide()})});$.each(t,function(n,t){var i,u;t=$(t);i=t.find(".close-country-select");i&&i.click(function(){t.toggle()});u=t.find(".continent-select");u&&u.click(function(){r()})})}function OpenRegion(n,t){var i=$("#"+t),r;i.find(".continent-overlay").hide();r=i.find("div#"+n);$(r).show()}(function(n){n(".canada").hover(function(){n(".map-container").css("background-position","center -510px")});n(".us-canada-region").hover(function(){n(".map-container").css("background-position","center -510px")});n(".us").hover(function(){n(".map-container").css("background-position","center -1020px")});n(".central-south-america-region").hover(function(){n(".map-container").css("background-position","center -1020px")});n(".central-america").hover(function(){n(".map-container").css("background-position","center -1530px")});n(".europe-africa-middle-east-region").hover(function(){n(".map-container").css("background-position","center -1530px")});n(".south-america").hover(function(){n(".map-container").css("background-position","center -2040px")});n(".asia-pacific-region").hover(function(){n(".map-container").css("background-position","center -2040px")});n(".europe").hover(function(){n(".map-container").css("background-position","center -2550px")});n(".africa").hover(function(){n(".map-container").css("background-position","center -3060px")});n(".asia-pacific").hover(function(){n(".map-container").css("background-position","center -3570px")});n(".map-container area").mouseout(function(){n(".map-container").css("background-position","center top")});n("#region-map map area").click(function(){SetRegionSortCookie(n(this).attr("regionid"))});n("#region-map-mobile li").click(function(){SetRegionSortCookie(n(this).attr("regionid"))});n(".map-region-accordion").accordion({collapsible:!0,active:"false",header:"li.map-region",icons:!1,heightStyle:"content"});SetRegionLangugeFormEvents();var t=n("#country-selector-container");t&&t[0]&&InitCountrySelector(t[0]);n.fn.GetQSParam=function(n,t){t==null&&(t="");n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+n+"=([^&#]*)"),i=r.exec(window.location.href);return i==null?t:i[1]}})(jQuery);$(window).resize(function(){$(window).width()>785?$("#main").show():$(".language-map-mobile").is(":visible")&&$("#main").hide()})