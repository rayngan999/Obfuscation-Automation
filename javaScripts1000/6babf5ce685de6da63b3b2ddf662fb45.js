var uspapi=function(){"use strict";function t(t){var a=document.cookie.match("(^|;) ?"+t+"=([^;]*)(;|$)");return a?a[2]:null}var a="1NYY";window.wpAd=window.wpAd||{},wpAd.params=wpAd.params||{},wpAd.params.uspString=wpAd.params.uspString||a;function n(t){console.log("--USP DEBUG-- Auth consumer triggered");try{navigator.globalPrivacyControl&&"CA"===t.geoState?p.setUSPString("1YYY"):t.privacySetting&&t.privacySetting.ccpa?(clearInterval(r),console.log("--USP DEBUG-- Auth Consumer found ccpa"),i=!0,wpAd.params.uspString=p.getUSPString(t.privacySetting.ccpa)):t.geoState&&"CA"!=t.geoState&&(clearInterval(r),console.log("--USP DEBUG-- Auth Consumer found no CCPA, but not in CA"),i=!0,wpAd.params.uspString="1---")}catch(t){console.log("--USP DEBUG-- Auth Processing Failed",t)}}var r,i=!0,s=a,p={getUSPString:function(t){return"".concat(t.iabSpec,t.explicitNotice,t.optOut,t.lspa)},setUSPString:function(t){wpAd.params.uspString=t},getUSPFromLS:function(a){var n="";if(4<=wpAd.params.uspString.length)a(wpAd.params.uspString);else try{if(localStorage.getItem("wapo_identity")){var e=JSON.parse(localStorage.getItem("wapo_identity"));n=p.getUSPString(e.privacySetting.ccpa)}else{if(!t("wp_usp"))throw new Error("no usp data in ls or cookie");n=t("wp_usp")}p.setUSPString(n),i=!0,a(n)}catch(t){var o=0;r=setInterval(function(){o++;try{return 4<=wpAd.params.uspString.length?(a(wpAd.params.uspString),void clearInterval(r)):(e=JSON.parse(localStorage.getItem("wapo_identity")),n=p.getUSPString(e.privacySetting.ccpa),clearInterval(r),p.setUSPString(n),a(n),void(i=!0))}catch(t){if(5===o)return clearInterval(r),console.log("--USP DEBUG-- : no ccpa signal found after ms ",200*o),i=!1,wpAd.params.uspString=s,void a(s)}},200)}},getUSPData:function(a,n){p.getUSPFromLS(function(t){t?n({version:a,uspString:t},i):n({version:a,uspString:s},!1)})},v1:{getUSPData:function(t){t?(console.log("Execute getUSPData"),p.getUSPData(1,t)):console.log("No callback received",t)}}};try{window.registerAuthConsumer?window.registerAuthConsumer(n):(window.authConsumers=window.authConsumers||[],window.authConsumers.push(n))}catch(t){console.log("--USP DEBUG-- Can not register AuthConsumer.",t)}function e(t){console.log("add event listener for messages from iframes requesting usp data"),window.addEventListener("message",function(e){if(e.data.hasOwnProperty("__uspapiCall")){e.stopImmediatePropagation&&e.stopImmediatePropagation();var t=e.data.__uspapiCall.command,a=e.data.__uspapiCall.version;t&&a&&window.__uspapi(t,a,function(t,a){var n={__uspapiReturn:{returnValue:t,callId:e.data.__uspapiCall.callId,success:a}};e.source.postMessage(n,e.origin)})}return null},!1),window.__uspapi=function(t,a,n){return p["v"+a]&&"[object Function]"==={}.toString.call(p["v"+a][t])?n?void p["v"+a][t].apply(null,[n]):(console.log("No callback"),p["v"+a][t]):(console.log("Malformed uspapi call"),!1)},t&&t()}function o(){!function(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this,o),window.__uspapi||e()}return new o,o}();
