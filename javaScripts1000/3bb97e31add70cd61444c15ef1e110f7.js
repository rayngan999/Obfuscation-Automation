define("components/sharedUI/globalModal",["FR","jquery","underscore","react-dom"],function(o,l,e,a){var n,t={container:l(".global_modal__container")},i=function(o){o=o.trim();var a=new RegExp("^"+o+"[ ]+"),n=new RegExp("[ ]+"+o+"$");return function(t){var i=l(this).attr("data-track");if(i===o)return!0;if(i.match(a))return!0;if(i.match(n))return!0;var d=i.split(" ");return e.contains(d,o)}},d=i("shown"),s=i("closed"),r=!0,c={lastFocused:null,closeModal:function(l){r&&o.$el.globalModal.hasClass("global_modal--visible")&&(o.$el.globalModal.removeAttr("tabindex").removeAttr("aria-describedby").removeAttr("aria-labelledby").blur(),o.$el.body.removeClass("body--modal_scroll_disabled"),o.$el.globalModal.removeClass("global_modal--visible"),o.$el.globalModal.removeClass("global_modal__overlay--visible"),t.container.removeClass("global_modal__container--position_top"),c.setFocus(c.lastFocused),"string"==typeof n&&""!==n&&(o.$el.window.trigger(n),n=null),o.$el.window.trigger("ApplicationDOM_Changed"),c.fireClosedEvent(l),o.$el.globalModal.removeClass("global_modal--passes"),o.$el.window.trigger("global-modal-closed"))},openModalJSX:function(l,e){t.content.children().length>0&&(t.content.replaceWith(t.content.clone().empty()),t.content=o.$el.globalModal.find(".global_modal__content")),a.render(l,t.content[0],function(){return c.postRender(e)})},openModal:function(o,l){c.appendTemplate(o),c.postRender(l)},postRender:function(e){c.repositionContainer(),l("#modalDescription").length&&o.$el.globalModal.attr("aria-describedby","modalDescription"),l("#modalTitle").length&&o.$el.globalModal.attr("aria-labelledby","modalTitle"),r?o.$el.globalModal.removeClass("global_modal--noclose"):o.$el.globalModal.addClass("global_modal--noclose"),t.overlay.addClass("global_modal__overlay--visible"),o.$el.globalModal.addClass("global_modal--visible"),o.$el.body.addClass("body--modal_scroll_disabled"),c.lastFocused=document.activeElement,c.setFocus(o.$el.globalModal.attr("tabindex",-1)),t.content.scrollTop(0),o.$el.window.trigger("ApplicationDOM_Changed"),o.$el.globalModal.find('[data-track*="shown"]').filter(d).trigger("shown"),"string"==typeof e&&""!==e&&o.$el.window.trigger(e)},setFocus:function(o){null!=o&&setTimeout(function(){o.focus()},100)},appendTemplate:function(o){t.content.html(o)},repositionContainer:function(){var l=t.container.outerHeight(!0),e=t.container.position(),a=o.$el.window.height();l+e.top>=a||0===e.top?t.container.addClass("global_modal__container--position_top"):t.container.removeClass("global_modal__container--position_top")},fireClosedEvent:e.debounce(function(l){(void 0===l||void 0===l.isTracked||l.isTracked)&&o.$el.globalModal.find('[data-track*="closed"]').filter(s).trigger("closed",l)},100,!0)},g={init:function(){g.setSelectors(),g.bindEvents(),g.setWatches()},setSelectors:function(){t.close=o.$el.globalModal.find(".global_modal__close"),t.overlay=o.$el.globalModal.find(".global_modal__overlay"),t.content=o.$el.globalModal.find(".global_modal__content")},bindEvents:function(){t.close.on("click",function(o){o.preventDefault(),c.closeModal({reason:"closeButton"})}),t.overlay.on("click",function(o){o.preventDefault(),c.closeModal({reason:"overlayClick"})}),o.$el.globalModal.keyup(function(o){27==o.which&&c.closeModal({reason:"escapeKey"})}),o.$el.window.on("pageshow unload",function(){c.closeModal({reason:"pageUnload"})})},setWatches:function(){o.$el.window.on("global-modal-open",function(o,l,e,a){void 0!==l&&(r=!0,n=a,c.openModal(l,e))}),o.$el.window.on("global-modal-open-jsx",function(l,e,a){void 0!==e&&(r=!0,c.openModalJSX(e),a&&a.className&&o.$el.globalModal.addClass(a.className))}),o.$el.window.on("global-modal-open--passes",function(l,e,a,n){o.$el.window.trigger("global-modal-open",e,a,n),o.$el.globalModal.addClass("global_modal--passes")}),o.$el.window.on("global-modal-open-jsx--passes",function(l,e,a,n){o.$el.window.trigger("global-modal-open-jsx",e,a,n),o.$el.globalModal.addClass("global_modal--passes")}),o.$el.window.on("global-modal-open-noclose",function(o,l,e,a){void 0!==l&&(r=!1,n=a,c.openModal(l,e))}),o.$el.window.on("global-modal-close",function(o,l){c.closeModal(l)}),o.$el.window.on("global-modal-close-force",function(o,l){r=!0,c.closeModal(l)});var l=e.debounce(function(){c.repositionContainer()},100);o.$el.window.on("resize orientationchange ApplicationDOM_Changed",l),o.$el.window.on("global-modal-reposition",function(o){c.repositionContainer()})}};l(function(){return g.init()})});
//# sourceMappingURL=globalModal.js.map
