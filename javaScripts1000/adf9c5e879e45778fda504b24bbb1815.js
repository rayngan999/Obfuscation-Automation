!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=209)}([function(e,t,i){i.d(t,"e",(function(){return s})),i.d(t,"d",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return d}));var n=i(1);function s(e){return Object(n.reduce)(e,(e,t)=>t.match({some:t=>e.concat(t),none:()=>e}),[])}const r={filter:e=>t=>t.filter(e),map:e=>t=>t.map(e),flatMap:e=>t=>t.flatMap(e),forEach:e=>t=>t.forEach(e),getOrValue:e=>t=>t.getOrValue(e),orElse:e=>t=>t.orElse(e),fold:(e,t)=>i=>i.match({none:e,some:t})};class a{constructor(e,t){this.value=e,this._isEmpty=t}static of(e){return o(e)}static fromNullable(e){return null==e?d:a.of(e)}static fromPredicate(e,t){return t(e)?a.of(e):d}static empty(){return d}isEmpty(){return this._isEmpty}nonEmpty(){return!this._isEmpty}getOrElse(e){return this._isEmpty?e():this.value}getOrNull(){return this._isEmpty?null:this.value}getOrValue(e){return this._isEmpty?e:this.value}orElse(e){return this._isEmpty?e():this}map(e){return this._isEmpty?d:a.of(e(this.value))}flatMap(e){return this._isEmpty?d:e(this.value)||d}filter(e){return this._isEmpty||!e(this.value)?d:a.of(this.value)}existsIf(e){return!this._isEmpty&&e(this.value)}forEach(e){this._isEmpty||e(this.value)}match(e){return this._isEmpty?e.none():e.some(this.value)}}function o(e){return new a(e,!1)}const d=new a(null,!0)},function(e,t,i){i.r(t),i.d(t,"head",(function(){return a})),i.d(t,"last",(function(){return o})),i.d(t,"tail",(function(){return d})),i.d(t,"join",(function(){return c})),i.d(t,"append",(function(){return l})),i.d(t,"appendIf",(function(){return h})),i.d(t,"find",(function(){return u})),i.d(t,"forEach",(function(){return p})),i.d(t,"difference",(function(){return g})),i.d(t,"filter",(function(){return m})),i.d(t,"some",(function(){return b})),i.d(t,"indexOf",(function(){return f})),i.d(t,"includes",(function(){return v})),i.d(t,"isMemberOf",(function(){return A})),i.d(t,"exclude",(function(){return y})),i.d(t,"fromNodeList",(function(){return w})),i.d(t,"fromArrayLike",(function(){return E})),i.d(t,"fromStringToNumber",(function(){return O})),i.d(t,"map",(function(){return C})),i.d(t,"unique",(function(){return I})),i.d(t,"reduce",(function(){return S})),i.d(t,"isEmpty",(function(){return T})),i.d(t,"isNotEmpty",(function(){return k})),i.d(t,"flatten",(function(){return j})),i.d(t,"partition",(function(){return P})),i.d(t,"groupByMap",(function(){return L})),i.d(t,"groupBy",(function(){return x})),i.d(t,"cArray",(function(){return V}));var n=i(0),s=i(8),r=i(2);function a(e){return e[0]}function o(e){return e[e.length-1]}function d(e){return e.slice(1)}const c=e=>t=>t.join(e),l=e=>t=>t.concat([e]),h=(e,t)=>i=>t()?l(e)(i):i;function u(e,t,i){if(null===e)throw new TypeError("array is null or undefined");const n=Object(e),s=n.length>>>0;let r;for(let e=0;e<s;e++)if(r=n[e],t.call(i,r,e,n))return r}function p(e,t,i){if(null===e)throw new TypeError("array is null or undefined");const n=Object(e),s=n.length>>>0;let r,a=0;for(;a<s;)a in n&&(r=n[a],t.call(i,r,a,n)),a++}const g=(e,t=r.equals)=>V.filter(Object(r.not)(A(e,t)));function m(e,t,i){if(null===e)throw new TypeError("array is null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");const n=Object(e),s=n.length>>>0;if(s>n.length)throw new TypeError("negative length");const r=[];for(let e=0;e<s;e++)if(e in n){const s=n[e];t.call(i,s,e,n)&&r.push(s)}return r}function b(e,t,i){if(null===e)throw new TypeError("array is null or undefined");const n=Object(e),s=n.length>>>0;if(s>n.length)throw new TypeError("negative length");for(let e=0;e<s;e++)if(e in n&&t.call(i,n[e],e,n))return!0;return!1}function f(e,t,i=r.equals,n){if(null===e)throw new TypeError("array is null or undefined");const s=Object(e),a=s.length>>>0;if(0===a)return-1;let o=n||0;if(Math.abs(o)===1/0&&(o=0),o>=a)return-1;let d=Math.max(o>=0?o:a-Math.abs(o),0);try{for(;d<a;){if(d in s&&i(s[d])(t))return d;d++}}catch(e){}return-1}function v(e,t,i=r.equals){return f(e,t,i)>-1}function A(e,t=r.equals){return i=>v(e,i,t)}const y=e=>t=>m(t,Object(r.not)(A(e)));function w(e){return E(e)}function E(e){return Array.prototype.slice.call(e)}function O(e,t=10){return C(e,e=>Object(r.isString)(e)?parseInt(e,t):NaN)}function C(e,t,i){if(null===e)throw new TypeError("array is null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");const n=Object(e),s=n.length>>>0,r=new Array(s);let a,o,d=0;for(;d<s;)d in n&&(a=n[d],o=t.call(i,a,d,n),r[d]=o),d++;return r}function I(e){if(null===e)throw new TypeError("array is null or undefined");const t=[];for(let i of e)v(t,i)||t.push(i);return t}function S(e,t,i){if(null===e)throw new TypeError("array is null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");let n=e.length>>>0;if(0===n&&void 0===i)throw new TypeError("reduce of empty array with no initial value");let s,r=0;if(void 0!==i)s=i;else for(;;){if(r in e){s=e[r++];break}if(++r>=n)throw new TypeError("reduce of empty array with no initial value")}for(;r<n;r++)r in e&&(s=t(s,e[r],r,e));return s}function T(e){return!e.length}function k(e){return!T(e)}function j(e){return T(e)?[]:S(e,(e,t)=>[...e,...t])}function P(e){return t=>S(t,([t,i],n)=>e(n)?[[...t,n],i]:[t,[...i,n]],[[],[]])}const L=(e,t)=>i=>S(i,(i,r)=>Object.assign(Object.assign({},i),{[e(r)]:[...Object(s.b)(i[e(r)],n.b.fromNullable,n.d.getOrValue([])),t(r)]}),{}),x=e=>t=>L(e,r.identity)(t),V={map:e=>t=>C(t,e),mapWithIndex:e=>t=>C(t,e),flatMap:e=>t=>j(C(t,e)),filter:e=>t=>m(t,e),foldLeft:(e,t)=>i=>T(i)?e:S(i,t,e),forEach:e=>t=>p(t,e)}},function(e,t,i){i.r(t),i.d(t,"seconds",(function(){return l})),i.d(t,"offset",(function(){return h})),i.d(t,"getAudioContext",(function(){return u})),i.d(t,"throttle",(function(){return p})),i.d(t,"safeUrl",(function(){return g})),i.d(t,"getProtocol",(function(){return m})),i.d(t,"getExtensionFromMimeType",(function(){return b})),i.d(t,"containsKeys",(function(){return f})),i.d(t,"matchesCheckers",(function(){return v})),i.d(t,"isBoolean",(function(){return A})),i.d(t,"isNumber",(function(){return y})),i.d(t,"isArray",(function(){return w})),i.d(t,"isString",(function(){return E})),i.d(t,"isUndefined",(function(){return O})),i.d(t,"isNull",(function(){return C})),i.d(t,"isObject",(function(){return I})),i.d(t,"not",(function(){return S})),i.d(t,"hasValidProperty",(function(){return T})),i.d(t,"hasOwnProperty",(function(){return k})),i.d(t,"hasOwnProperties",(function(){return j})),i.d(t,"isFunction",(function(){return P})),i.d(t,"isStudioCreative",(function(){return L})),i.d(t,"isSizeInPx",(function(){return x})),i.d(t,"isNative",(function(){return D})),i.d(t,"noop",(function(){return _})),i.d(t,"identity",(function(){return R})),i.d(t,"prop",(function(){return M})),i.d(t,"safeProp",(function(){return F})),i.d(t,"tap",(function(){return U})),i.d(t,"equals",(function(){return B})),i.d(t,"exhaustive",(function(){return W}));var n=i(0),s=i(16),r=i(12),a=i(5);const o=Object.prototype.toString,d=Function.prototype.toString,c=Object.prototype.hasOwnProperty;function l(e){if(!e)return NaN;const t=e.split("."),i=t[0].split(":");let n=3600*Number(i[0])+60*Number(i[1])+Number(i[2]);return 2===t.length&&(n=Number(n+"."+t[1])),n}function h(e=0){const t=e?Math.floor(e/3600):0,i=(e-=3600*t)?Math.floor(e/60):0,n=((e-=60*i)%1).toFixed(3).substr(1);return e=Math.floor(e),r.pad(t)+":"+r.pad(i)+":"+r.pad(e)+n}function u(){return window.AudioContext||window.webkitAudioContext}function p(e,t=250,i=this){let n=!1;return(...s)=>{n||(e.apply(i,s),window.setTimeout(()=>{n=!1},t),n=!0)}}function g(e){const t=document.createElement("a");return t.href=e,window.swInstalled&&/(teads|ebu?z)/.test(t.hostname)?"/"+btoa(e).replace(/=/g,"_"):e}function m(){return location&&location.protocol&&0===location.protocol.indexOf("http:")?location.protocol:"https:"}function b(e){if(!e)return"";let t=e.split("/")[1]||e;switch(t){case"javascript":case"x-javascript":t="js";break;case"mpeg":t="mpg"}return t}function f(e,t){let i=!1;if(!t)return!1;for(let n in e)if(k(e,n)){if(void 0===typeof t[n])return!1;i=!0}return i}function v(e){return t=>{let i=!0;for(const n in e)if(e.hasOwnProperty(n)&&(O(t[n])||!e[n](t[n]))){i=!1;break}return i}}function A(e){return"boolean"==typeof e}function y(e){return"number"==typeof e&&!isNaN(e)}function w(e){return"[object Array]"===o.call(e)}function E(e){return"string"==typeof e}function O(e){return void 0===e}function C(e){return null===e}function I(e){return!!e&&"object"==typeof e}function S(e){return t=>!e(t)}const T=(e,t,i)=>k(e,t)&&i(e[t]);function k(e,t){return c.call(e,t)}function j(e,t){return t.every(t=>k(e,t))}function P(e){return!!e&&"function"==typeof e&&"[object Function]"===o.call(e)}function L(){var e;return n.b.fromNullable(null===(e=window.teads)||void 0===e?void 0:e.api).map(e=>Object(s.a)(e.getStudioData,e)).filter(P).map(e=>e()).existsIf(I)}function x(e){return!!e.match(/px$/)&&y(parseFloat(e))}const V=/^\[object .+?Constructor\]$/,N=RegExp("^"+String(toString).replace(/[.*+?^${}()|[\]\/\\]/g,"\\$&").replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function D(e){const t=typeof e;return a.a.tryCatch(()=>"function"===t?N.test(d.call(e)):!(!e||"object"!==t||!V.test(o.call(e)))).getOrElse(()=>!1)}function _(){}const R=e=>e,M=e=>t=>t[e],F=e=>t=>n.b.fromNullable(t[e]),U=e=>t=>(e(t),t);function B(e){return t=>t===e}const W=e=>e},function(e,t,i){i.r(t),i.d(t,"UABrowser",(function(){return w})),i.d(t,"UAOs",(function(){return E})),i.d(t,"UADevice",(function(){return O})),i.d(t,"getContextSummary",(function(){return _})),i.d(t,"getClientSideDeviceProperties",(function(){return M})),i.d(t,"getFullContext",(function(){return F})),i.d(t,"init",(function(){return U})),i.d(t,"setDeviceModel",(function(){return B})),i.d(t,"setSDKVersion",(function(){return W})),i.d(t,"setAppId",(function(){return H})),i.d(t,"setAppVersion",(function(){return z})),i.d(t,"setIsSDK",(function(){return G})),i.d(t,"isDesktop",(function(){return q})),i.d(t,"isIpad",(function(){return K})),i.d(t,"isTablet",(function(){return $})),i.d(t,"isMobile",(function(){return Y})),i.d(t,"isChromeIos",(function(){return X})),i.d(t,"isFacebookWebview",(function(){return Q})),i.d(t,"isAndroidNative",(function(){return J})),i.d(t,"isSamsungBrowser",(function(){return Z})),i.d(t,"isAndroid",(function(){return ee})),i.d(t,"isIos",(function(){return te})),i.d(t,"isIphone",(function(){return ie})),i.d(t,"isAndroidMobile",(function(){return ne})),i.d(t,"isIE",(function(){return se})),i.d(t,"isChrome",(function(){return re})),i.d(t,"isChromeWebView",(function(){return ae})),i.d(t,"isFirefox",(function(){return oe})),i.d(t,"isEdge",(function(){return de})),i.d(t,"isAmp",(function(){return ce})),i.d(t,"isAmpInABox",(function(){return le})),i.d(t,"isAmpSF",(function(){return he})),i.d(t,"isAmpObserveIntersection",(function(){return ue})),i.d(t,"isIABSafeFrame",(function(){return pe})),i.d(t,"getIABSafeFrameWindow",(function(){return ge})),i.d(t,"isEdgeTouchScreen",(function(){return me})),i.d(t,"isSDK",(function(){return be})),i.d(t,"getIEVersion",(function(){return fe})),i.d(t,"getAndroidVersion",(function(){return ve})),i.d(t,"getChromeVersion",(function(){return Ae})),i.d(t,"getIosVersion",(function(){return ye})),i.d(t,"getFacebookWebviewVersion",(function(){return we})),i.d(t,"getSafariVersion",(function(){return Ee})),i.d(t,"isUIWebview",(function(){return Oe})),i.d(t,"isSafari",(function(){return Ce})),i.d(t,"isSafari11Plus",(function(){return Ie})),i.d(t,"isChrome66Plus",(function(){return Se})),i.d(t,"isGoogleSearchApp",(function(){return Te})),i.d(t,"isIos10Safari",(function(){return ke})),i.d(t,"isIos10OtherBrowser",(function(){return je})),i.d(t,"isFacebookWebviewIOS10",(function(){return Pe})),i.d(t,"isCanvasUsed",(function(){return Le})),i.d(t,"videoSupport",(function(){return xe})),i.d(t,"getLanguage",(function(){return Ve})),i.d(t,"getUA",(function(){return Ne})),i.d(t,"setUA",(function(){return De})),i.d(t,"getDevice",(function(){return _e})),i.d(t,"getOS",(function(){return Re})),i.d(t,"getBrowser",(function(){return Me})),i.d(t,"canAutoplay",(function(){return Fe})),i.d(t,"isCanvasNeeded",(function(){return Ue})),i.d(t,"getShortContext",(function(){return Be})),i.d(t,"getEnv",(function(){return We})),i.d(t,"getNetworkBandwidthInMbps",(function(){return He})),i.d(t,"activateConversionMeasurementFeature",(function(){return ze})),i.d(t,"getCohort",(function(){return Ge})),i.d(t,"cacheCanvasUsed",(function(){return qe})),i.d(t,"checkUserAgent",(function(){return Ke})),i.d(t,"startAutoplayTest",(function(){return $e}));i(60);var n=i(39),s=i(5),r=i(0),a=i(9),o=i(21),d=i(12);const c="model",l="name",h="type",u="vendor",p="version",g="mobile",m="tablet",b={extend:function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2==0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},f={rgx:function(){for(var e,t,i,n,s,r,a,o=0,d=arguments;o<d.length&&!r;){var c=d[o],l=d[o+1];if(void 0===e)for(n in e={},l)"object"==typeof(s=l[n])?e[s[0]]=void 0:e[s]=void 0;for(t=i=0;t<c.length&&!r;)if(r=c[t++].exec(Ne()))for(n=0;n<l.length;n++)a=r[++i],"object"==typeof(s=l[n])&&s.length>0?2===s.length?"function"==typeof s[1]?e[s[0]]=s[1].call(this,a):e[s[0]]=s[1]:3===s.length?"function"!=typeof s[1]||s[1].exec&&s[1].test?e[s[0]]=a?a.replace(s[1],s[2]):void 0:e[s[0]]=a?s[1].call(this,a,s[2]):void 0:4===s.length&&(e[s[0]]=a?s[3].call(this,a.replace(s[1],s[2])):void 0):e[s]=a||void 0;o+=2}return e},str:function(e,t){for(var i in t)if("object"==typeof t[i]&&t[i].length>0){for(var n=0;n<t[i].length;n++)if(b.has(t[i][n],e))return"?"===i?void 0:i}else if(b.has(t[i],e))return"?"===i?void 0:i;return e}},v={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},A={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[l,p],[/(opios)[\/\s]+([\w\.]+)/i],[[l,"Opera Mini"],p],[/\s(opr)\/([\w\.]+)/i],[[l,"Opera"],p],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],[l,p],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[l,"IE"],p],[/(edge)\/((\d+)?[\w\.]+)/i],[l,p],[/(yabrowser)\/([\w\.]+)/i],[[l,"Yandex"],p],[/(comodo_dragon)\/([\w\.]+)/i],[[l,/_/g," "],p],[/(micromessenger)\/([\w\.]+)/i],[[l,"WeChat"],p],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[p,[l,"MIUI Browser"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[l,/(.+)/,"$1 WebView"],p],[/android.+samsungbrowser\/([\w\.]+)/i,/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[p,[l,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(qqbrowser)[\/\s]?([\w\.]+)/i],[l,p],[/(dolfin)\/([\w\.]+)/i],[[l,"Dolphin"],p],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[l,"Chrome"],p],[/;fbav\/([\w\.]+);/i],[p,[l,"Facebook"]],[/fxios\/([\w\.-]+)/i],[p,[l,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[p,[l,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[p,l],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[l,[p,f.str,v.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[l,p],[/(navigator|netscape)\/([\w\.-]+)/i],[[l,"Netscape"],p],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[l,p]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[c,u,[h,m]],[/applecoremedia\/[\w\.]+ \((ipad)/],[c,[u,"Apple"],[h,m]],[/(apple\s{0,1}tv)/i],[[c,"Apple TV"],[u,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[u,c,[h,m]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[c,[u,"Amazon"],[h,m]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[c,f.str,v.device.amazon.model],[u,"Amazon"],[h,g]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[c,u,[h,g]],[/\((ip[honed|\s\w*]+);/i],[c,[u,"Apple"],[h,g]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[u,c,[h,g]],[/\(bb10;\s(\w+)/i],[c,[u,"BlackBerry"],[h,g]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[c,[u,"Asus"],[h,m]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[u,"Sony"],[c,"Xperia Tablet"],[h,m]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[u,"Sony"],[c,"Xperia Phone"],[h,g]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[u,c,[h,"console"]],[/android.+;\s(shield)\sbuild/i],[c,[u,"Nvidia"],[h,"console"]],[/(playstation\s[3portablevi]+)/i],[c,[u,"Sony"],[h,"console"]],[/(sprint\s(\w+))/i],[[u,f.str,v.device.sprint.vendor],[c,f.str,v.device.sprint.model],[h,g]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[u,c,[h,m]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[u,[c,/_/g," "],[h,g]],[/(nexus\s9)/i],[c,[u,"HTC"],[h,m]],[/(nexus\s6p)/i],[c,[u,"Huawei"],[h,g]],[/(microsoft);\s(lumia[\s\w]+)/i],[u,c,[h,g]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[c,[u,"Microsoft"],[h,"console"]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[u,"Microsoft"],[h,g]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[c,[u,"Motorola"],[h,g]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[c,[u,"Motorola"],[h,m]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[u,b.trim],[c,b.trim],[h,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[u,"Samsung"],[h,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[c,[u,"Sharp"],[h,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[u,"Samsung"],c,[h,m]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[u,"Samsung"],c,[h,g]],[/smart-tv.+(samsung)/i],[u,c,[h,"smarttv"]],[/sie-(\w+)*/i],[c,[u,"Siemens"],[h,g]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[u,"Nokia"],c,[h,g]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[c,[u,"Acer"],[h,m]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[u,"LG"],c,[h,m]],[/(lg) netcast\.tv/i],[u,c,[h,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[c,[u,"LG"],[h,g]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[c,[u,"Lenovo"],[h,m]],[/linux;.+((jolla));/i],[u,c,[h,g]],[/((pebble))app\/[\d\.]+\s/i],[u,c,[h,"wearable"]],[/android.+;\s(glass)\s\d/i],[c,[u,"Google"],[h,"wearable"]],[/android.+;\s(pixel c)\s/i],[c,[u,"Google"],[h,m]],[/android.+;\s(pixel xl|pixel)\s/i],[c,[u,"Google"],[h,g]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[c,/_/g," "],[u,"Xiaomi"],[h,g]],[/android.+a000(1)\s+build/i],[c,[u,"OnePlus"],[h,g]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[h,b.lowerize],u,c]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[l,p],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[l,[p,f.str,v.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[l,"Windows"],[p,f.str,v.os.windows.version]],[/\((bb)(10);/i],[[l,"BlackBerry"],p],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[l,p],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[l,"Symbian"],p],[/\((series40);/i],[l],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[l,"Firefox OS"],p],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[l,p],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[l,"Chromium OS"],p],[/(sunos)\s?([\w\.]+\d)*/i],[[l,"Solaris"],p],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[l,p],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[l,"iOS"],[p,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[l,"Mac OS"],[p,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[l,p]]};var y=i(2);class w{constructor(e){this.name=e.name||"",this.version=e.version||""}toString(){return d.separate("|",this.name,this.version).toLowerCase()}}class E{constructor(e){this.name=e.name||"",this.version=e.version||""}toString(){return d.separate("|",this.name,this.version).toLowerCase()}}class O{constructor(e){this.model=e.model||"",this.type=e.type||(O.typeRegExp.test(Re().name)?"desktop":""),this.vendor=e.vendor||""}toString(){return d.separate("|",this.model,this.type,this.vendor).toLowerCase()}}O.typeRegExp=/^windows|mac\s+os|linux|bsd|dragonfly|chromium\s+os|haiku|ubuntu|slackware|gentoo|solaris|debian|fedora|arch|beos|mint|gnu|os|suse\/2$/i;const C=new a.a("Context");let I,S,T,k,j,P=r.a,L="",x="",V="";const N={};let D=null;function _(){return[Y()&&!$()?"mob":$()?"tab":"desk",ee()?"android":te()?"ios":se()?"ie":re()?"ch":oe()?"ff":"ot"].join(" ")}const R={deviceType:{mobile:"m",desktop:"d",tablet:"t"},browserName:{"Mobile Safari":"Safari M","Chrome WebView":"Chrome WV"}};function M(){return P.map(e=>e.getPropertiesAsString())}function F(e=!0){var t,i,n;return be()?[_e().model,Re().name,Re().version,L,V,Be(),x].join("|"):[e&&null!==(t=R.deviceType[_e().type])&&void 0!==t?t:_e().type,Re().name,e?(n=Re().version,n.replace(/(\d+)\.(\d+)\.\d+/,"$1.$2")):Re().version,e&&null!==(i=R.browserName[Me().name])&&void 0!==i?i:Me().name,Me().version.split(".")[0],Be()].join("|")}function U(e=!0){var t,i,n,s,a,d,c,l,h;window.teads.CONTEXT_IS_INITIALIZED||(e&&Ke(),function(){try{S=window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage||"en"}catch(e){C.error("Could not get navigator language",e),S="en"}}(),k=new E(f.rgx.apply(this,A.os)),j=new w(f.rgx.apply(this,A.browser)),T=new O(f.rgx.apply(this,A.device)),function(){try{N.isAmp=!!window._teads_amp}catch(e){C.error("Could not check if `!!window._teads_amp`",e),N.isAmp=!1}}(),function(){try{N.isAmpInABox=Object(y.isArray)(window.top.ampInaboxIframes)&&Object(y.isBoolean)(window.top.ampInaboxInitialized)&&Object(y.isArray)(window.top.ampInaboxPendingMessages)}catch(e){C.error("Could not check if AMP-inabox is used",e),N.isAmpInABox=!1}}(),function e(t=window){try{t.$sf&&t.$sf.ext?(N.isIabsf=!0,N.iabsfWindow=t):t.parent!==t&&e(t.parent)}catch(e){C.error("Could not check if `!!window.$sf.ext`",e),N.isIabsf=!1}}(),function(){try{if(pe()){const e=ge();N.isAmpSF=!Object(y.isUndefined)(e)&&!!e.AMP_CONTEXT_DATA}else N.isAmpSF=!1}catch(e){C.error("Could not check if `!!window.AMP_CONTEXT_DATA`",e),N.isAmpSF=!1}}(),function(){try{N.hasTouchPoints=!!(navigator.maxTouchPoints&&navigator.maxTouchPoints>0)}catch(e){C.error("Could not check if `navigator.maxTouchPoints > 0`",e),N.hasTouchPoints=!1}}(),function(){try{N.isNavigatorStandalone=window.navigator.standalone}catch(e){C.error("Could not check navigator.standalone",e),N.isNavigatorStandalone=!1}}(),function(){try{N.observeIntersection=!(!window.context||!window.context.observeIntersection)}catch(e){C.error("Could not check if `!!window.context.observeIntersection`",e),N.observeIntersection=!1}}(),N.isIE="IE"===j.name||/MSIE|Trident/.test(I),N.isFirefox="Firefox"===j.name||/Firefox/i.test(I),N.isEdge="Edge"===j.name||/Edge/i.test(I),N.isGoogleSearchApp=/GSA\//i.test(I),N.isSafari=("Safari"===j.name||"Mobile Safari"===j.name)&&!Te(),N.isChromeWebView="Chrome WebView"===j.name,N.isChrome="Chrome"===j.name||ae(),N.isEdgeTouchScreen=de()&&N.hasTouchPoints,N.isChromeIos=/CriOS/i.test(I),N.isAndroidNative="Android Browser"===j.name,N.isFacebookWebview="Facebook"===j.name||/FBAN|FBIOS|FBAV|FBBV|FBDV|FBMD|FBSN|FBSV|FBSS|FBCR|FBID|FBLC|FBOP/i.test(I),N.isSamsungBrowser=/SamsungBrowser/i.test(I),N.isIpad="iPad"===T.model||/iPad/i.test(I)||/mac\s+os/i.test(k.name)&&N.hasTouchPoints,N.isIphone="iPhone"===T.model||/iPhone/i.test(I),N.isIos="iOS"===k.name||K()||ie(),N.isAndroid="Android"===k.name||/Android/i.test(I),function(){let e=/(m|M)obile/.test(I);N.isTablet="tablet"===T.type||K()||ee()&&!e,N.isMobile="mobile"===T.type||te()&&!K()||ee()&&e,N.isDesktop=!Y()&&!$()}(),N.ieVersion=se()?j.version:"",N.iOsVersion=te()?k.version:"",N.androidVersion=ee()?k.version:"",N.chromeVersion=re()?j.version:"",N.FacebookWebviewVersion=Q()?j.version:"",N.safariVersion=Ce()?j.version:"",N.isAndroidMobile=ee()&&Y(),N.isAmpObserveIntersection=N.isAmp&&N.observeIntersection,N.isUIWebview=(ie()||K())&&!Ce()&&!re()&&!N.isNavigatorStandalone,N.isIos10Safari=o.a(ye(),"10")&&!Oe()&&!X(),N.isIos10OtherBrowser=o.a(ye(),"10")&&o.d(ye(),"11")&&Oe()&&X(),te()&&(P=r.b.fromNullable((t=window,i=document,n={apiVersion:"1.9.1",propsCache:"",divStyle:null,ns:{svg:"http://www.w3.org/2000/svg"},cssPrfxs:["Webkit","Moz","O","ms","Khtml"],fncPrfxs:["webkit","moz","o","ms","khtml"],getPropertiesAsString:function(){return this.propsCache}},s={},a={"js.webGlRenderer":function(){if(!t.CanvasRenderingContext2D)return null;var e=i.createElement("canvas");if(!(e=e.getContext("webgl")||e.getContext("experimental-webgl")))return null;var n=e.getExtension("WEBGL_debug_renderer_info");return n&&(e=e.getParameter(n.UNMASKED_RENDERER_WEBGL))?e:null},deviceAspectRatio:function(){var e="2/3 40/71 3/4 16/9 16/10 375/667 9/16 10/16 375/812 207/448".split(" ");e:{try{var i=t.screen.width+"/"+t.screen.height;break e}catch(e){}i=""}return i&&e.push(i),d("device-aspect-ratio",e)},screenWidthHeight:function(){try{return t.screen.width+"/"+t.screen.height}catch(e){}return!1},devicePixelRatio:function(){var e=1;try{e=t.devicePixelRatio}catch(e){}return e+""},"js.deviceOrientation":function(){return"js.deviceOrientation"in s&&s["js.deviceOrientation"]},rendererRef:function(){if(!t.CanvasRenderingContext2D)return null;var e=i.createElement("canvas"),n=e.getContext("2d");return n.textBaseline="top",n.font="16px 'Arial'",n.textBaseline="alphabetic",n.rotate(.05),n.fillStyle="#f60",n.fillRect(125,1,62,20),n.fillStyle="#069",n.fillText("DeviceAtlas",2,15),n.fillStyle="rgba(102, 200, 0, 0.7)",n.fillText("DeviceAtlas",4,17),n.shadowBlur=10,n.shadowColor="blue",n.rotate(-.15),n.fillRect(-20,25,234,5),("p3"===d("color-gamut",["p3"])?"1":"0")+c(e.toDataURL())}},d=function(e,i){if(void 0===t.matchMedia)return null;for(var n in i)if(t.matchMedia("("+e+":"+i[n]+")").matches)return i[n]+"";return null},c=function(e){for(var t=e.length,i=5381,n=0;n<t;n++)i=33*i^e.charCodeAt(n);return String(i>>>0)},l=function(e){try{var t=a[e]()}catch(e){}(null!=t&&void 0!==t||null!=(t=s[e])&&void 0!==t)&&h(e,t)},h=function(e,t){if(-1!=e.indexOf(".")){var i=e.split(".");void 0===n[i[0]]&&(n[i[0]]={}),n[i[0]][i[1]]=t}else n[e]=t;s[e]=t},function(){if(t.addEventListener&&t.removeEventListener){var e=function(i){null!=i&&null!=i.alpha&&h("js.deviceOrientation",!0),t.removeEventListener("deviceorientation",e,!1)};t.addEventListener("deviceorientation",e,!1)}}(),function(){for(var e in a)l(e)}(),n.propsCache=function(e){var t,i="";for(t in e){var s=e[t];i+=(s="boolean"==typeof s?"b":"number"==typeof s?"i":"s")+t+":"+("b"==s?e[t]+0:e[t])+"|"}return i+"sversion:"+n.apiVersion+"|bE:0"}(s),n))),window.teads.CONTEXT_IS_INITIALIZED=!0)}function B(e){T.model=e}function W(e){V=e,D=!0}function H(e){L=e}function z(e){x=e}function G(e){N.isSDK=e}function q(){return!!N.isDesktop}function K(){return!!N.isIpad}function $(){return!!N.isTablet}function Y(){return!!N.isMobile}function X(){return!!N.isChromeIos}function Q(){return!!N.isFacebookWebview}function J(){return!!N.isAndroidNative}function Z(){return!!N.isSamsungBrowser}function ee(){return!!N.isAndroid}function te(){return!!N.isIos}function ie(){return!!N.isIphone}function ne(){return!!N.isAndroidMobile}function se(){return!!N.isIE}function re(){return!!N.isChrome}function ae(){return!!N.isChromeWebView}function oe(){return!!N.isFirefox}function de(){return!!N.isEdge}function ce(){return!!N.isAmp}function le(){return!!N.isAmpInABox}function he(){return!!N.isAmpSF}function ue(){return!!N.isAmpObserveIntersection}function pe(){return!!N.isIabsf}function ge(){return N.iabsfWindow}function me(){return!!N.isEdgeTouchScreen}function be(){return!!N.isSDK}function fe(){return N.ieVersion?N.ieVersion:""}function ve(){return N.androidVersion?N.androidVersion:""}function Ae(){return N.chromeVersion?N.chromeVersion:""}function ye(){return N.iOsVersion?N.iOsVersion:""}function we(){return N.FacebookWebviewVersion?N.FacebookWebviewVersion:""}function Ee(){return N.safariVersion?N.safariVersion:""}function Oe(){return!!N.isUIWebview}function Ce(){return!!N.isSafari}function Ie(){return o.a(Ee(),"11")}function Se(){return o.a(Ae(),"66")}function Te(){return!!N.isGoogleSearchApp}function ke(){return!!N.isIos10Safari}function je(){return!!N.isIos10OtherBrowser}function Pe(){return o.a(we(),"87")&&o.a(ye(),"10.2")}function Le(){return!!N.isCanvasUsed}function xe(e){return!!e.createElement("video").canPlayType}function Ve(){return S}function Ne(){return I}function De(e){I=e}function _e(){return T}function Re(){return k}function Me(){return j}function Fe(){return!1!==D}function Ue(){return!Fe()}function Be(){let e;return e=be()?"sdk":ce()?"amp":he()?"ampsf":pe()?"sf":Q()?"fbwv":ae()||Oe()?"wv":"web",Le()?e+"-canvas":e}function We(){return be()?"sdk-inapp":"js-"+Be()}function He(){return s.a.tryCatch(()=>window.navigator.connection.downlink).toOption()}function ze(){const e=document.createElement("meta");e.httpEquiv="origin-trial",e.content="AzTuVo+9bDhP/SV2p62tu1vYU8B9NU0J4A6+P2YzM59LlLVIvTljSKPaa3V0+4EejDULlOLmBVA2zQq+XUDoWQ4AAAB+eyJvcmlnaW4iOiJodHRwczovL3RlYWRzLnR2OjQ0MyIsImZlYXR1cmUiOiJDb252ZXJzaW9uTWVhc3VyZW1lbnQiLCJleHBpcnkiOjE2MzE2NjM5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9",document.head.appendChild(e)}function Ge(){if(re()&&(function(){const e=document.createElement("meta");e.httpEquiv="origin-trial",e.content="A/j6QtZ5QtlZcLGHuYBce5i3WFMXVvc89MjxJazvAJx/Vk5s4X8XcCtbAFmv8NFM084EjqJGNfn99gg0FUhvIgYAAAB6eyJvcmlnaW4iOiJodHRwczovL3RlYWRzLnR2OjQ0MyIsImZlYXR1cmUiOiJJbnRlcmVzdENvaG9ydEFQSSIsImV4cGlyeSI6MTYyNjIyMDc5OSwiaXNTdWJkb21haW4iOnRydWUsImlzVGhpcmRQYXJ0eSI6dHJ1ZX0=",document.head.appendChild(e)}(),Object(y.isFunction)(document.interestCohort)))try{return document.interestCohort().then(e=>Object(y.isString)(e.id)?Object(r.c)({cohortId:e.id,cohortVersion:Object(y.isString)(e.version)?Object(r.c)(e.version):r.a}):r.a).catch(e=>r.a)}catch(e){return Promise.resolve(r.a)}return Promise.resolve(r.a)}function qe(e){N.isCanvasUsed=e}function Ke(){try{I=navigator.userAgent}catch(e){C.error("Could not get `navigator.userAgent`",e),I=""}}function $e(){if(null!==D)return void C.error("Context.startAutoplayTest has already been called and autoplay is "+D);if(!(te()||ee()))return void C.debug("Not on iOS/Android, no need to start autoplay test");n.c(()=>{const e=document.createElement("video");e.src="https://s8t.teads.tv/media/format/v3/assets/default/autoplay.mp4",e.style.setProperty("display","none"),e.setAttribute("webkit-playsinline","true"),e.setAttribute("playsinline","true"),e.muted=!0,document.body.appendChild(e);const t=e.play();t&&t.catch(e=>{"NotAllowedError"===e.name||"AbortError"===e.name?(C.debug("Not allowed to play video without user interaction, disable autoplay"),D=!1):C.error("Error when trying to play the autoplay video:",e)}).then(()=>{C.debug("Autoplay test done");try{e.pause(),document.body.removeChild(e)}catch(e){}})},window)}},function(e,t,i){i.d(t,"a",(function(){return n}));class n{constructor(e,t=null){this.type=e,this.data=t}}n.AdLoaded="AdLoaded",n.AdStarted="AdStarted",n.AdStopped="AdStopped",n.AdSkipped="AdSkipped",n.AdLinearChange="AdLinearChange",n.AdSizeChange="AdSizeChange",n.AdExpandedChange="AdExpandedChange",n.AdSkippableStateChange="AdSkippableStateChange",n.AdRemainingTimeChange="AdRemainingTimeChange",n.AdDurationChange="AdDurationChange",n.AdVolumeChange="AdVolumeChange",n.AdImpression="AdImpression",n.AdVideoStart="AdVideoStart",n.AdVideoFirstQuartile="AdVideoFirstQuartile",n.AdVideoMidpoint="AdVideoMidpoint",n.AdVideoThirdQuartile="AdVideoThirdQuartile",n.AdVideoComplete="AdVideoComplete",n.AdClickThru="AdClickThru",n.AdInteraction="AdInteraction",n.AdUserAcceptInvitation="AdUserAcceptInvitation",n.AdUserMinimize="AdUserMinimize",n.AdUserClose="AdUserClose",n.AdPaused="AdPaused",n.AdPlaying="AdPlaying",n.AdLog="AdLog",n.AdError="AdError"},function(e,t,i){i.d(t,"f",(function(){return s})),i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return c})),i.d(t,"b",(function(){return l})),i.d(t,"e",(function(){return h}));var n=i(0);const s={filterOrElse:(e,t)=>i=>i.filterOrElse(e,t),fold:(e,t)=>i=>i.fold(e,t)};class r{constructor(e,t){this._isRight="right"===t,this.value=e}static tryCatch(e){try{return c(e())}catch(e){return o(e)}}static of(e){return c(e)}isLeft(){return!this._isRight}isRight(){return this._isRight}contains(e){return this._isRight&&this.value===e}exists(e){return this._isRight&&e(this.value)}filterOrElse(e,t){return this._isRight?e(this.value)?this:o(t(this.value)):this}flatMap(e){return this._isRight?e(this.value):this}fold(e,t){return this._isRight?t(this.value):e(this.value)}getOrElse(e){return this._isRight?this.value:e()}getOrValue(e){return this._isRight?this.value:e}orElse(e){return this._isRight?this:e(this.value)}map(e){return this._isRight?c(e(this.value)):this}forEach(e){this._isRight&&e(this.value)}tap(e){return this._isRight&&e(this.value),this}tapLeft(e){return this._isRight||e(this.value),this}toOption(){return this._isRight?n.b.fromNullable(this.value):n.a}}class a extends r{constructor(e){super(e,"left")}}function o(e){return new a(e)}class d extends r{constructor(e){super(e,"right")}}function c(e){return new d(e)}const l=o,h=c},function(e,t,i){i.r(t),i.d(t,"getBoundingClientRect",(function(){return p})),i.d(t,"copyBoundingClientRect",(function(){return g})),i.d(t,"isEmptyBoundingClientRect",(function(){return m})),i.d(t,"getClientRectRelativeToDocument",(function(){return b})),i.d(t,"getClientRectFromClientRectRelativeToDocument",(function(){return f})),i.d(t,"getSize",(function(){return v})),i.d(t,"getTextContent",(function(){return A})),i.d(t,"isEmpty",(function(){return y})),i.d(t,"querySelectorAll",(function(){return w})),i.d(t,"findMatchingElement",(function(){return E})),i.d(t,"getAttributeValue",(function(){return O})),i.d(t,"getAndRemoveAttributeValue",(function(){return C})),i.d(t,"getWindowSize",(function(){return S})),i.d(t,"inject",(function(){return T})),i.d(t,"addEventListener",(function(){return k})),i.d(t,"removeEventListener",(function(){return j})),i.d(t,"onDomReady",(function(){return P})),i.d(t,"onDomComplete",(function(){return L})),i.d(t,"getScrollLeft",(function(){return x})),i.d(t,"getScrollTop",(function(){return V})),i.d(t,"getElementsByClassName",(function(){return N})),i.d(t,"isHTMLElement",(function(){return D})),i.d(t,"removeElementFromDOM",(function(){return _})),i.d(t,"isNodeList",(function(){return R})),i.d(t,"isSelfClosingTag",(function(){return M})),i.d(t,"isISlotSelector",(function(){return F})),i.d(t,"htmlDecode",(function(){return U})),i.d(t,"htmlEncode",(function(){return B})),i.d(t,"getOuterHTML",(function(){return W}));var n=i(43),s=i(0),r=i(1),a=i(10),o=i(3),d=i(2),c=i(39);const l={IMG:" ",BR:"\n"},h=["SCRIPT","STYLE","HEAD","IFRAME","OBJECT"],u=3;function p(e,t=!0){try{const i=e.getBoundingClientRect(),n=g(i);if(t&&!o.isAmp()&&!o.isIABSafeFrame()&&Object(a.getWindow)(e)!==window.top){const t=Object(a.findFirstParentFrameNode)(e);if(t!==e){const e=p(t);e.top&&(n.top=e.top+i.top,n.bottom=e.top+i.bottom),e.left&&(n.left=e.left+i.left,n.right=e.left+i.right)}}return n}catch(e){return{left:0,top:0,right:0,bottom:0,width:0,height:0}}}function g(e){return{top:e.top||0,right:e.right||0,bottom:e.bottom||0,left:e.left||0,width:e.width||0,height:e.height||0}}function m(e){return!(0!==e.top||0!==e.right||0!==e.bottom||0!==e.left||0!==e.width||0!==e.height)}function b(e,t){return{left:e.left+t.x,top:e.top+t.y,right:e.right+t.x,bottom:e.bottom+t.y,width:e.width,height:e.height}}function f(e,t){return{left:e.left-t.x,top:e.top-t.y,right:e.right-t.x,bottom:e.bottom-t.y,width:e.width,height:e.height}}function v(e){const t=e.offsetWidth,i=e.offsetHeight,n=o.getUA().indexOf("WebKit")>-1&&!t&&!i;if((!t||n)&&e.getBoundingClientRect){const t=p(e);return{width:t.right-t.left,height:t.bottom-t.top}}return{width:t,height:i}}function A(e,t){if(r.indexOf(h,e.nodeName)>=0);else if(e.nodeType===u&&e.nodeValue)t.push(e.nodeValue);else if(e.nodeName in l)t.push(l[e.nodeName]);else{let i=e.firstChild;for(;i;)A(i,t),i=i.nextSibling}}function y(e,t=window){const i=e.tagName.toLowerCase(),n=["iframe","object","img"];return!(r.includes(n,i)||w(n.join(","),t,e).length>0||!e.textContent||""!==e.textContent.trim())}function w(e,t,i){return Object(r.fromArrayLike)((i||t.document).querySelectorAll(e))}function E(e,t){const i=e[0];if(i){const n=i.querySelector(t);return s.b.fromNullable(n).orElse(()=>E(e.slice(1),t))}return s.b.empty()}function O(e,t){return s.b.fromNullable(e.getAttribute(t)).filter(e=>""!==e)}function C(e,t){return O(e,t).map(i=>(e.removeAttribute(t),i))}const I={};function S(e=window,t=!1){var i,r;if(o.isAmp())return s.b.fromNullable(null===(i=window.context)||void 0===i?void 0:i.initialIntersection.rootBounds).map(({width:e,height:t})=>({width:e,height:t})).getOrValue({width:window.innerWidth,height:window.innerHeight});if(o.isIABSafeFrame())return s.b.fromNullable(null===(r=o.getIABSafeFrameWindow())||void 0===r?void 0:r.$sf.ext.geom()).map(e=>({width:e.win.w,height:e.win.h})).getOrValue({width:0,height:0});if(!t&&!o.isAmp()&&o.isIos()&&o.isSafari()){const t=e.innerWidth>e.innerHeight?"landscape":"portrait";return Object(d.isUndefined)(I[t])&&(Object(n.a)(e),Object(n.d)(e),I[t]=Object(n.c)(e),Object(n.e)()),{width:e.innerWidth,height:I[t]}}return"number"==typeof e.innerWidth?{width:e.innerWidth,height:e.innerHeight}:e.document.documentElement&&(e.document.documentElement.clientWidth||e.document.documentElement.clientHeight)?{width:e.document.documentElement.clientWidth,height:e.document.documentElement.clientHeight}:e.document.body&&(e.document.body.clientWidth||e.document.body.clientHeight)?{width:e.document.body.clientWidth,height:e.document.body.clientHeight}:{width:1e3,height:600}}function T(e,t=window){s.b.fromNullable(t.document.getElementsByTagName("head")[0]).orElse(()=>s.b.fromNullable(t.document.body)).forEach(t=>t.appendChild(e))}function k(e,t,i){c.a(e,t,i)}function j(e,t,i){c.d(e,t,i)}function P(e,t=window){c.c(e,t)}function L(e,t=window,i=this){c.b(e,t,i)}function x(e){return e.pageXOffset?e.pageXOffset:"CSS1Compat"===(e.document.compatMode||"")?e.document.documentElement.scrollLeft:e.document.body.scrollLeft}function V(e){return e.pageYOffset?e.pageYOffset:"CSS1Compat"===(e.document.compatMode||"")?e.document.documentElement.scrollTop:e.document.body.scrollTop}function N(e,t,i=window){if((t=t||i.document).getElementsByClassName)return Object(r.fromArrayLike)(t.getElementsByClassName(e));const n=e.split(" ");let s="";for(let e=0,t=n.length;e<t;e++)s+="."+n[e];return w(s,i,t)}function D(e,t){return!(!e||"object"!=typeof e||R(e))&&(t||(t=Object(a.getWindow)(e)||window),"object"==typeof t.HTMLElement?e instanceof t.HTMLElement:e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName)}function _(e){return s.b.fromNullable(e.parentElement).forEach(t=>t.removeChild(e))}function R(e){return!(!e||"object"!=typeof e)&&e instanceof NodeList}function M(e){if(D(e))return/^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i.test(e.nodeName)}function F(e,t){let i=!1;const n=Object.keys(t);for(const t in e)if(i=Object(r.includes)(n,t)&&(Object(d.isString)(e[t])||R(e[t])||D(e[t])),!i)break;return i}function U(e){const t=document.createElement("textarea");return t.innerHTML=e,t.value}function B(e){const t=document.createElement("textarea");return t.innerText=e,t.innerHTML}function W(e){return D(e)?U(e.outerHTML):""}},function(e,t,i){i.d(t,"a",(function(){return n}));const n={ABORT:"abort",CAN_PLAY:"canplay",DURATION_CHANGE:"durationchange",ENDED:"ended",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",LOADED:"loaded",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",RESUME_AFTER_STALLED:"resumeafterstalled",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",AUDIO_SYNC:"audiosync",BENCH_FPS:"benchFps",RESIZE:"resize"}},function(e,t,i){function n(e,t,i,n,s,r,a,o,d,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return i(t(e));case 4:return n(i(t(e)));case 5:return s(n(i(t(e))));case 6:return r(s(n(i(t(e)))));case 7:return a(r(s(n(i(t(e))))));case 8:return o(a(r(s(n(i(t(e)))))));case 9:return d(o(a(r(s(n(i(t(e))))))));case 10:return c(d(o(a(r(s(n(i(t(e)))))))))}}i.d(t,"b",(function(){return n})),t.a=function(e,t,i,n,s,r,a,o,d){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return i(t(e.apply(this,arguments)))};case 4:return function(){return n(i(t(e.apply(this,arguments))))};case 5:return function(){return s(n(i(t(e.apply(this,arguments)))))};case 6:return function(){return r(s(n(i(t(e.apply(this,arguments))))))};case 7:return function(){return a(r(s(n(i(t(e.apply(this,arguments)))))))};case 8:return function(){return o(a(r(s(n(i(t(e.apply(this,arguments))))))))};case 9:return function(){return d(o(a(r(s(n(i(t(e.apply(this,arguments)))))))))}}}},function(e,t,i){i.d(t,"a",(function(){return g}));i(60),i(16);var n=i(22),s=i(1),r=i(54),a=i(37),o=!1;try{let e=navigator.userAgent;o=/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i.test(e)||/(?:ms|\()(ie)\s([\w\.]+)/i.test(e)||/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i.test(e)}catch(e){}var d,c=[],l=[],h=!1;class u{log(...e){}}d=window.console&&console.log?window.console:new u;let p=!1;class g{constructor(e){this.namespace=e}static clear(){g.logs=[],window.teads.FULL_LOGS=[]}static getFullLogs(){return window.teads.FULL_LOGS}debug(...e){this._log("debug",e)}info(...e){this._log("info",e)}warn(...e){this._log("warn",e)}error(...e){this._log("error",e)}table(e,...t){d.table&&d.table(e,t.length>0?t:null)}_log(e,t){if(t.length){var i=((Object(n.a)()-window.teads.START_TIME)/1e3).toFixed(3)+"s",r="";for(let e=0;e<t.length;e++)if(e>0&&(r+=" + "),"object"==typeof t[e])try{r+=a.b(t[e])}catch(i){r+=t[e]}else r+=t[e];if(window.teads.FULL_LOGS.push({level:e,message:i+" ["+this.namespace+"] "+r}),!(Object(s.indexOf)(c,e)<0)){if(!h&&l.length)if(!Object(s.some)(l,e=>0===this.namespace.indexOf(e)))return;g.logs.push({level:e,message:i+" ["+this.namespace+"] "+t.join(" ")}),o?t=["Teads "+i+" ["+this.namespace+"] "+t.join(" ")]:t.unshift("Teads %c"+i+" "+this.namespace,"color:#7ebde5;");var u=d[e]||d.log;try{u.apply(d,t)}catch(e){Function.prototype.apply.apply(u,[d,t])}}}}}g.logs=[],p||(p=!0,Object(r.a)("teadsDebugLevel").toOption().filter(e=>!!e).map(e=>e.split(",")).forEach(e=>{c=Object(s.indexOf)(e,"all")>=0?["debug","info","warn","error"]:e}),Object(r.a)("teadsDebugNamespace").toOption().filter(e=>!!e).forEach(e=>{l=e.split(","),h="all"===String(e).toLocaleLowerCase()}),c.length&&!window.teads.Logger&&(o?(d.log("Teads Media Framework > Debug mode"),d.log("v2.22.61 (production version: v822) %>")):(d.log("%cTeads Media Framework %c> Debug mode","color:#7ebde5;font-family:Helvetica,sans-serif;font-size:2em;","color:#585858;font-family:Helvetica,sans-serif;font-size:2em;"),d.log("%cv2.22.61 (production version: v822)', 'color:#7ebde5;font-style:italic;"))),window.teads.HAS_DEBUG_LOGS=!!c.length)},function(e,t,i){i.r(t),i.d(t,"curriedAddClass",(function(){return f})),i.d(t,"createIframe",(function(){return v})),i.d(t,"makeIframeIABFriendly",(function(){return A})),i.d(t,"resetIframeBodyCSS",(function(){return y})),i.d(t,"appendIframeToElement",(function(){return w})),i.d(t,"isFullscreen",(function(){return E})),i.d(t,"getWindow",(function(){return O})),i.d(t,"getDocument",(function(){return C})),i.d(t,"toggleFullscreen",(function(){return I})),i.d(t,"openFullscreen",(function(){return S})),i.d(t,"closeFullscreen",(function(){return T})),i.d(t,"addClass",(function(){return k})),i.d(t,"removeClass",(function(){return j})),i.d(t,"hasClass",(function(){return P})),i.d(t,"toggleClass",(function(){return L})),i.d(t,"replaceClass",(function(){return x})),i.d(t,"isInCrossDomainIframe",(function(){return V})),i.d(t,"isChildWindow",(function(){return N})),i.d(t,"isRectZeroFilled",(function(){return D})),i.d(t,"findParentWindows",(function(){return _})),i.d(t,"findTopWindow",(function(){return R})),i.d(t,"findChildWindows",(function(){return M})),i.d(t,"findAllWindows",(function(){return F})),i.d(t,"findParentFrameNode",(function(){return U})),i.d(t,"findFirstParentFrameNode",(function(){return B})),i.d(t,"isKarmaFrame",(function(){return W})),i.d(t,"findParentElements",(function(){return H})),i.d(t,"isInView",(function(){return z})),i.d(t,"getPercentageInView",(function(){return G})),i.d(t,"isChildOf",(function(){return q})),i.d(t,"isChildBoundsInParentBounds",(function(){return K})),i.d(t,"findFloatingHeaders",(function(){return $})),i.d(t,"getTop",(function(){return Y})),i.d(t,"checkIsHtmlElement",(function(){return X})),i.d(t,"checkForDisplayNone",(function(){return Q})),i.d(t,"checkForTiny",(function(){return J})),i.d(t,"visibilityChecksOnParents",(function(){return Z})),i.d(t,"isDisplayNoneOverParents",(function(){return ee})),i.d(t,"checkForOverflow",(function(){return te})),i.d(t,"checkElementVisibility",(function(){return ie})),i.d(t,"getCSSRules",(function(){return ne})),i.d(t,"copyCSSRules",(function(){return se}));var n=i(1),s=i(0),r=i(2);var a=i(5),o=i(35);const d=new class{constructor(e){this.length=0,this.keys=[],this.values=[],Object(r.isUndefined)(e)||Object(n.forEach)(e,e=>this.put(e[0],e[1]))}contains(e){return Object(n.indexOf)(this.keys,e)>-1}get(e){const t=Object(n.indexOf)(this.keys,e);return t>-1?Object(s.c)(this.values[t]):s.a}put(e,t){const i=Object(n.indexOf)(this.keys,e);if(i>-1){const e=this.values[i];return this.values[i]=t,Object(s.c)(e)}return this.keys.push(e),this.values.push(t),this.length=this.values.length,s.a}remove(e){const t=Object(n.indexOf)(this.keys,e);if(t>-1){const e=this.values[t];return this.keys.splice(t,1),this.values.splice(t,1),this.length=this.values.length,Object(s.c)(e)}return s.a}clear(){this.keys.splice(0,this.length),this.values.splice(0,this.length),this.length=0}size(){return this.length}};let c=!1;function l(e,t){const{windowHeight:i,viewabilityThreshold:s,offset:r=0,withClearCache:u=!0,getClientRect:p,getElementFromPoint:g,findParentElements:m,findFirstParentFrameNode:b}=e,f=p(t),v=function(e,t,i){return(e+t)/2>i/2}(f.top,f.bottom,i),A=function(e,t){return e/100*t}(s,f.height),y=(w=f.left,E=f.right,Math.round((w+E)/2));var w,E;const O=function(e,t,i,n,s){return e?Math.round(t+Math.max(1,i+1)):Math.round(Math.min(s-1,n-1)-t)}(v,r,f.top,f.bottom,i),C=(I=O,S=A,T=v,Math.round(I+(T?S-1:1-S)));var I,S,T;const k=function(e,t,i,n,s){return`${e}-${t}-${i}-${n}-${s}`}(v,r,y,O,C);return u&&(c||(c=!0,Object(o.d)(()=>{d.clear(),c=!1},1e3))),d.get(k).getOrElse(()=>g(y,O).match({none:()=>h(k,Object(a.c)("hidden-overflow")),some:i=>{const s=function(e,{top:t,bottom:i},{top:n,bottom:s}){return e?i-n:s-t}(v,p(i),f);return r===s?h(k,Object(a.c)("hidden-overflow")):g(y,C).match({none:()=>h(k,l(Object.assign(Object.assign({},e),{offset:s}),t)),some:r=>{const o=(d=[i,...m(i)],c=[r,...m(r)],u=b(t),n.includes(d,u)&&n.includes(c,u));var d,c,u;return h(k,o?a.a.of(t):l(Object.assign(Object.assign({},e),{offset:s}),t))}})}}))}function h(e,t){return d.contains(e)||d.put(e,t),t}var u=i(6),p=i(12),g=i(3),m=i(31);const b=g.isDesktop()?.1:.15,f=Object(m.a)((e,t)=>{k(t,e)});function v(e){const t=document.createElement("iframe");return t.style.setProperty("margin","0","important"),t.style.setProperty("padding","0","important"),t.style.setProperty("width","0","important"),t.style.setProperty("height","0","important"),t.style.setProperty("border","0","important"),t.style.setProperty("overflow","hidden","important"),t.style.setProperty("float","none","important"),t.setAttribute("allow","autoplay; conversion-measurement; attribution-reporting 'src' https://cm.teads.tv"),t.setAttribute("scrolling","no"),t.setAttribute("title",e),t.frameBorder="0",t}function A(e){s.b.fromNullable(e.contentWindow).forEach(e=>e.inDapIF=!0)}function y(e){var t;s.b.fromNullable(null===(t=null==e?void 0:e.document)||void 0===t?void 0:t.body).forEach(e=>{e.style.overflow="hidden",e.style.padding="0",e.style.margin="0"})}function w(e,t){return Object(u.isHTMLElement)(e)&&e.appendChild(t),t}function E(e){return e||(e=document),!!(e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement)}function O(e){if(!e||Object(u.isNodeList)(e))return null;var t=C(e);return t?t.defaultView||t.parentWindow:null}function C(e){return!e||Object(u.isNodeList)(e)?null:e.ownerDocument}function I(e){E()?T(e):S(e)}function S(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}function T(e){const t=C(e);t&&(t.exitFullscreen?t.exitFullscreen():t.msExitFullscreen?t.msExitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen())}function k(e,t){(t=p.trim(t))&&!P(e,t)&&e.classList.add(t)}function j(e,t){(t=p.trim(t))&&P(e,t)&&e.classList.remove(t)}function P(e,t){return e.classList.contains(p.trim(t))}function L(e,t){e.classList.toggle(p.trim(t))}function x(e,t,i){t=p.trim(t),!P(e,i=p.trim(i))&&P(e,t)&&(r.isFunction(e.classList.replace)?e.classList.replace(t,i):(j(e,t),k(e,i)))}function V(e){return _(e).pop()!==window.top}function N(e){return e!==window.top}function D(e){return!n.some(Object.keys(e),t=>0!==e[t])}function _(e,t=!0){const i=[];if(Object(u.isHTMLElement)(e)){let n;n=e=>{if(e.parent!==e&&e.parent.location&&e.parent.window){if(t){e.parent.document}i.push(e.parent),n(e.parent)}};const s=O(e);s&&i.push(s);try{n(s)}catch(e){}}return i}function R(e){return _(e).pop()||window}function M(e,t=!1){let i=[];if(Object(u.isHTMLElement)(e)){const r=e.getElementsByTagName("iframe");for(let e=0;e<r.length;e++)try{s.b.fromNullable(r[e].contentWindow).flatMap(e=>{var t;return s.b.fromNullable(null===(t=e.document)||void 0===t?void 0:t.body).map(t=>({win:e,body:t}))}).forEach(({win:e,body:s})=>{i.push(e),t&&n.forEach(M(s,!0),e=>{i=i.concat(e)})})}catch(e){}}return i}function F(e,t=!1){return _(e).concat(M(e,t))}function U(e){const t=O(e);try{if(t&&t.parent!==t&&void 0!==t.parent.Window&&t.parent instanceof t.parent.Window){const e=t.parent.document.getElementsByTagName("iframe");if(e)for(let i=0;i<e.length;i++)if(e[i].contentWindow===t)return U(e[i])}}catch(e){}return e}function B(e){const t=O(e);try{if(t&&t.parent!==t&&void 0!==t.parent.Window&&t.parent instanceof t.parent.Window){const e=t.parent.document.getElementsByTagName("iframe");if(e)for(let i=0;i<e.length;i++)if(e[i].contentWindow===t&&!W(e[i]))return e[i]}}catch(e){}return e}function W(e){return"context"===e.id&&"http://localhost:5555/context.html"===e.src&&"100%"===e.width&&"100%"===e.height}function H(e,t=!0){const i=[];if(Object(u.isHTMLElement)(e)){const n=C(e);let s=e;const r=!(!s.tagName||!s.tagName.toUpperCase||"HTML"!==s.tagName.toUpperCase());for(;!r&&(t||n&&s!==n.body)&&Object(u.isHTMLElement)(s);)s=s.parentElement,s&&i.push(s)}return i}function z({element:e,elementAncestors:t,elementClientRect:i,mainWindow:n,thresholdCoefficient:s,elementHeight:r,getPercentage:a=G,envIsAmp:o=g.isAmp(),envIsIABSafeFrame:d=g.isIABSafeFrame()}){const c=a({element:e,elementAncestors:t,elementClientRect:i,mainWindow:n,elementHeight:r});return(!o&&!d||0!==c)&&c>=s}function G({element:e,elementAncestors:t,elementClientRect:i,mainWindow:n,elementHeight:s,allowNegative:a=!1,detectFloatingHeaders:o=!g.isAndroid(),getWindowSize:d=u.getWindowSize,envIsAmp:c=g.isAmp(),envIsIABSafeFrame:l=g.isIABSafeFrame(),envIabSFWindow:h=g.getIABSafeFrameWindow()}){if(c&&n._teads_amp)return n._teads_amp.change?n._teads_amp.change.intersectionRect.height/n._teads_amp.change.boundingClientRect.height:0;if(l){const e=h;if(r.isUndefined(e))return 0;const t=e.$sf.ext.geom();return t&&t.self?t.self.yiv:0}const p=d(n,!0),m=o?Y(n,$(n,e,t,i),p.height):0,b=i.top-m;let f=(b>0?p.height-i.top:b+s)/s;return a||(f=f>0?f:0,f=f<1?f:1),f}function q(e,t){return n.includes(H(e),t)}function K(e,t,i,n){const s=("bottom"===i?e.height:e.width)*n;return e[i]-s>t[i]}function $(e=window,t,i=[document.body],s,r=u.getWindowSize){let a=[];const o=r(e),d=o.width/2,c=o.height*b,l=c*b;let h,p;const g=r=>{const a=Object(u.getBoundingClientRect)(r);return"fixed"===e.getComputedStyle(r).position&&(!s||a.right>s.left&&a.left<s.right)&&!n.includes(i,r)&&!r.className.match(/teads/)&&!q(r,t)};for(let t=1;t<c;t+=l)h=e.document.elementFromPoint(d,t),h&&p!==h&&(p=h,g(h)&&a.push(h),n.forEach(H(h),e=>{g(e)&&a.push(e)}));return n.unique(a)}function Y(e,t,i){var s;let r=0;const a=null!==(s=window.FORCE_DEMO)&&void 0!==s&&s;n.forEach(t,e=>r=Math.max(r,Object(u.getBoundingClientRect)(e,!a).bottom));const o=Object(u.getScrollTop)(e),d=o>0?r:o+r;return Math.max(0,Math.min(i,d))}function X(e){return Object(u.isHTMLElement)(e)?a.a.of(e):Object(a.c)("invalid-dom")}function Q(e){return"none"===window.getComputedStyle(e).display?Object(a.c)("hidden-display"):a.a.of(e)}function J(e){const t=Object(u.getBoundingClientRect)(e),i=window.getComputedStyle(e);return(g.isCanvasUsed()?(t.height<50||t.width<50)&&("hidden"===i.overflowX||"hidden"===i.overflowY):t.height<50||t.width<50)?Object(a.c)("tiny"):a.a.of(e)}function Z(e){const t=e=>e.flatMap(Q).flatMap(e=>e.parentElement?Z(e.parentElement):Object(a.d)(e));return g.isCanvasUsed()?t(X(e).flatMap(J)):t(X(e))}function ee(e){return e.map(e=>"none"===window.getComputedStyle(e).display||ee(s.b.fromNullable(e.parentElement))).getOrValue(!1)}function te(e,t){const i=(100-t)/100,n=Object(u.getBoundingClientRect)(e);let s=a.a.of(e);const r=e=>{const t=!P(e,"teads-inread"),o=window.getComputedStyle(e);let d;return t&&"hidden"===o.overflowY&&(d=Object(u.getBoundingClientRect)(e),K(n,d,"bottom",i)||(s=Object(a.c)("hidden-overflow"))),s.isRight()&&t&&"hidden"===o.overflowX&&(d=d||Object(u.getBoundingClientRect)(e),K(n,d,"right",i)||(s=Object(a.c)("hidden-overflow"))),s.isRight()&&e.parentElement?r(e.parentElement):s};return e.parentElement?r(e.parentElement):s}function ie(e,t,i=u.getWindowSize){return J(e).flatMap(()=>Z(e).flatMap(()=>te(e,t).orElse(()=>{const n=R(e);return l({windowHeight:i(n).height,viewabilityThreshold:t,getClientRect:u.getBoundingClientRect,getElementFromPoint:(e,t)=>s.b.fromNullable(n.document.elementFromPoint(e,t)),findParentElements:H,findFirstParentFrameNode:B},e)})))}function ne(e){const t=O(e),i=[];if(t){const n=t.document.styleSheets;if(e.matches=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector,r.isFunction(e.matches))for(let t in n){let s=n[t],r=a.a.tryCatch(()=>s.rules||s.cssRules).getOrElse(()=>({}));for(let t in r){let n=r[t];e.matches(n.selectorText)&&i.push(n)}}}return i}function se(e,t,i){const s=ne(e);n.forEach(s,e=>{n.forEach(i,i=>{let n=e.style.getPropertyValue(i);!n||t.style[i]||t.getAttribute(i)||(t.style[i]=n)})})}},function(e,t,i){var n;i.d(t,"a",(function(){return n})),function(e){e[e.INIT=0]="INIT",e[e.INIT_VIDEO=1]="INIT_VIDEO",e[e.INIT_AUDIO=2]="INIT_AUDIO",e[e.CAN_PLAY=3]="CAN_PLAY",e[e.PLAYING=4]="PLAYING",e[e.PAUSED=5]="PAUSED",e[e.LOADED=6]="LOADED",e[e.STALLED=7]="STALLED",e[e.ENDED=8]="ENDED"}(n||(n={}))},function(e,t,i){i.r(t),i.d(t,"isURL",(function(){return s})),i.d(t,"pad",(function(){return r})),i.d(t,"ucfirst",(function(){return a})),i.d(t,"rand",(function(){return o})),i.d(t,"trim",(function(){return d})),i.d(t,"separate",(function(){return c})),i.d(t,"endsWith",(function(){return l})),i.d(t,"match",(function(){return h})),i.d(t,"replaceStringsWithValue",(function(){return u})),i.d(t,"includesSubString",(function(){return p})),i.d(t,"isEmpty",(function(){return g})),i.d(t,"isNotEmpty",(function(){return m}));var n=i(1);function s(e){return"string"==typeof e&&!e.match(/\s/)&&/(((((http|ftp|https):)?(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\-]+\.|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/.test(e)}function r(e,t="00"){var i=String(e);return t.substring(0,t.length-i.length)+i}function a(e){return e.charAt(0).toUpperCase()+e.substr(1)}function o(e,t=!0){for(var i=t?"0123456789":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",s=0;s<e;s++)n+=i.charAt(Math.floor(Math.random()*i.length));return n}function d(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function c(e="|",...t){let i=!0,n=0;for(;i&&n<t.length;)i=i&&!t[n],n++;return i?"":t.join(e)}function l(e,t){return e.slice(-t.length)===t}function h(e,t){return e.match(t)||[]}function u(e,t){return i=>n.reduce(e,(e,i)=>e.replace(i,""+t),i)}function p(e,t){return-1!==e.indexOf(t)}function g(e){return""===e}function m(e){return!g(e)}},function(e,t,i){var n;!function(e){e[e.REMOVED=-6]="REMOVED",e[e.REMOVING=-5]="REMOVING",e[e.ERROR=-4]="ERROR",e[e.STOPPED=-3]="STOPPED",e[e.STOPPING=-2]="STOPPING",e[e.SKIPPED=-1]="SKIPPED",e[e.SKIPPING=0]="SKIPPING",e[e.READY=1]="READY",e[e.LOADING=2]="LOADING",e[e.LOADED=3]="LOADED",e[e.STARTING=5]="STARTING",e[e.STARTED=6]="STARTED",e[e.PAUSING=7]="PAUSING",e[e.PAUSED=8]="PAUSED",e[e.RESUMING=9]="RESUMING",e[e.PLAYING=10]="PLAYING",e[e.COMPLETE=11]="COMPLETE"}(n||(n={})),t.a=n},function(e,t,i){i.d(t,"h",(function(){return d})),i.d(t,"g",(function(){return c})),i.d(t,"a",(function(){return p})),i.d(t,"c",(function(){return g})),i.d(t,"b",(function(){return m})),i.d(t,"f",(function(){return b})),i.d(t,"e",(function(){return f})),i.d(t,"d",(function(){return v})),i.d(t,"i",(function(){return A})),i.d(t,"k",(function(){return y})),i.d(t,"j",(function(){return w})),i.d(t,"n",(function(){return E})),i.d(t,"m",(function(){return O})),i.d(t,"l",(function(){return C}));var n=i(0),s=i(2);const r={type:"ClassicFormatTrackingStore",trackedEvents:[],customTrackings:[]},a={type:"HeaderBiddingFormatTrackingStore",trackedEvents:[]},o={type:"DebugTrackingStore",trackedEvents:[]},d={type:"VastTrackingStore",trackings:[],progressTrackings:[],trackedEvents:[],trackedProgressOffsets:[],alreadyBilledAdvertiser:!1,studioCreativeId:n.a,customTrackings:[],customProgressTrackings:[],trackBillable:!1},c={type:"ThirdPartyVastTrackingStore",trackings:[],progressTrackings:[],trackedEvents:[],trackedProgressOffsets:[],customTrackings:[],customProgressTrackings:[]},l={type:"ThirdPartyTrackingStore",trackedEvents:[]},h={},u=e=>(Object(s.isUndefined)(h[e])&&(h[e]={classicFormatStore:r,headerBiddingFormatStore:a,debugStore:o,vastStore:d,thirdPartyVastStore:c,thirdPartyStore:l}),h[e]),p=e=>u(e).classicFormatStore,g=e=>u(e).headerBiddingFormatStore,m=e=>u(e).debugStore,b=e=>u(e).vastStore,f=e=>u(e).thirdPartyVastStore,v=e=>u(e).thirdPartyStore,A=e=>t=>(u(e).classicFormatStore=t,t),y=e=>t=>(u(e).headerBiddingFormatStore=t,t),w=e=>t=>(u(e).debugStore=t,t),E=e=>t=>(u(e).vastStore=t,t),O=e=>t=>(u(e).thirdPartyVastStore=t,t),C=e=>t=>(u(e).thirdPartyStore=t,t)},function(e,t,i){i.d(t,"p",(function(){return p})),i.d(t,"q",(function(){return g})),i.d(t,"l",(function(){return m})),i.d(t,"j",(function(){return b})),i.d(t,"o",(function(){return f})),i.d(t,"k",(function(){return v})),i.d(t,"i",(function(){return A})),i.d(t,"n",(function(){return y})),i.d(t,"g",(function(){return w})),i.d(t,"r",(function(){return E})),i.d(t,"c",(function(){return O})),i.d(t,"e",(function(){return C})),i.d(t,"s",(function(){return I})),i.d(t,"a",(function(){return S})),i.d(t,"b",(function(){return T})),i.d(t,"m",(function(){return k})),i.d(t,"d",(function(){return j})),i.d(t,"h",(function(){return P})),i.d(t,"f",(function(){return L}));var n=i(1),s=i(3),r=i(71),a=i(12),o=i(9),d=i(2),c=i(0),l=i(5),h=i(10);const u=new o.a("URIHelper");function p(e){const t=document.createElement("a");return t.href=e,{href:t.href,protocol:t.protocol,hostname:t.hostname,port:t.port,pathname:t.pathname,search:t.search,hash:t.hash,host:t.host}}function g(e){const t={};return"string"!=typeof e?t:(e=Object(a.trim)(e).replace(/^(\?|&)/,""))?(n.forEach(e.split("&"),e=>{const i=e.split("="),n=i.shift();n&&(t[n]=i.length>0?i.join("="):void 0)}),t):t}function m(e){return/^http(s)*:\/\/localhost/i.test(e)||/^\/track\?action=/.test(e)||/^\/dist\/.*teads/.test(e)||/^\.\/teads/.test(e)}function b(e){return/teads\.(tv|net|tech|com)$/.test(p(e).hostname)||m(e)}function f(e){return/^http(s)*:\/\/t\.teads\.tv/i.test(e)||m(e)}function v(e){return/itunes\.apple\.com/.test(p(e).hostname)}function A(e){const t=p(e).hostname;return"sb.scorecardresearch.com"===t||"b.scorecardresearch.com"===t}const y=e=>/^(\w+\.sandbox\.teads\.net|(\w+\.)+teads\.tech)|(\d+\.\d+\.\d+\.\d+)$/.test(e);function w(e){const t=e.split(".");let i=t.length>1?t[t.length-2]:e;return n.includes(["uk"],t[t.length-1])&&(i=t[t.length-3]),i}function E(e,t,i){var n,s;if(e.indexOf(t)<0)return e;{const r=new RegExp("[\\?&]"+t+"=([^&#]*)");return c.b.fromNullable(null===(s=null===(n=r.exec(e))||void 0===n?void 0:n[0])||void 0===s?void 0:s.charAt(0)).match({some:n=>e.replace(r,n+t+"="+i),none:()=>(u.warn(`Tried to replace parameter "${t}" value with "${i}" on URL ${e} and failed.`),e)})}}function O(e,t){const i=n.map(Object.keys(t),e=>e+"="+t[e]).join("&"),s=-1===e.indexOf("?")?"?":"&";return e+(""===i?"":s+i)}function C(e){return Object(r.b)(r.a,Object(r.e)(e))}function I(e){return e.replace(/^http:/,Object(d.getProtocol)())}function S(e,t,i){return k(e,t)?e:O(e,{[t]:i})}function T(e,t,i){return i.map(i=>S(e,t,i)).getOrValue(e)}function k(e,t){return e.indexOf(`?${t}=`)>-1||e.indexOf(`&${t}=`)>-1}function j(e,t,i){return k(e,t)?E(e,t,i):S(e,t,i)}function P(){return l.a.tryCatch(()=>window.top.location.search).getOrElse(()=>p(document.referrer).search)}function L(e){var t,i;try{let e,n,r=Object(h.findParentWindows)(window.document.body);return window.top!==window?Object(s.isAmp)()&&c.b.fromNullable(window.context).map(e=>e.sourceUrl).nonEmpty()?(e=window.context.sourceUrl,n=window.context.canonicalUrl):Object(s.isAmpSF)()&&c.b.fromNullable(window.AMP_CONTEXT_DATA).map(e=>e.sourceUrl).nonEmpty()?(e=window.AMP_CONTEXT_DATA.sourceUrl,n=window.AMP_CONTEXT_DATA.canonicalUrl):e=document.referrer?Object(s.isIABSafeFrame)()&&(Object(s.isIos)()||Object(s.isSafari)())?c.b.fromNullable(null===(t=null===window||void 0===window?void 0:window.teads)||void 0===t?void 0:t.pageURL).getOrElse(()=>document.referrer):document.referrer:l.a.tryCatch(()=>window.top.location.href).getOrElse(()=>window.location.href):e=window._teads_canonical_url?window._teads_canonical_url:null===(i=window.location)||void 0===i?void 0:i.href,e.match("ampproject.org")&&n&&!n.match("amproject.org")&&(e=n),c.b.fromNullable({windowDepth:r.length,windowReferrerUrl:e})}catch(t){e.warning("get-current-page-referrer error retrieving top win")}return c.b.empty()}},function(e,t,i){i.d(t,"a",(function(){return s}));var n=i(2);Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});const s=function(e,t,...i){if(Object(n.isNative)(e.bind))return e.bind(t,...i);const s=n.noop,r=function(...n){return e.apply(this instanceof s?this:t,i.concat(n))};return s.prototype=e.prototype,r.prototype=new s,r}},function(e,t,i){i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return s}));class n{constructor(e,t){this.code=e,this.error=t}static get(e,t,i){return new n({id:e,message:t},i)}getFullMessage(){return"Error #"+this.code.id+": "+this.code.message}getId(){return this.code.id}getMessage(){return this.code.message}getStackTrace(){return this.error&&this.error.stack?this.error.stack:""}toString(){return this.getFullMessage()}}class s extends n{}s.XML_PARSE={id:100,message:"XML parsing error"},s.XML_INVALID_SCHEMA={id:101,message:'VAST schema validation error: expected "%s" but found "%s"'},s.UNSUPPORTED_VERSION={id:102,message:"VAST version of response not supported. Expected VAST2 or VAST3 but VAST1 found"},s.TRAFFICKING={id:200,message:"Trafficking error. Video player received an Ad type that it was not expecting and/or cannot display"},s.LINEARITY={id:201,message:"Video player expecting different linearity"},s.DURATION={id:202,message:"Video player expecting different duration"},s.SIZE={id:203,message:"Video player expecting different size"},s.WRAPPER={id:300,message:"General Wrapper error"},s.WRAPPER_TIMEOUT={id:301,message:"Timeout of VAST URI provided in Wrapper element, or of VAST URI provided in a subsequent Wrapper element (URI was either unavailable or reached a timeout as defined by the video player)"},s.WRAPPER_LIMIT={id:302,message:"Wrapper limit reached, as defined by the video player. Too many Wrapper responses have been received with no InLine response"},s.NO_ADS={id:303,message:"No Ads VAST response after one or more Wrappers"},s.GENERAL_LINEAR={id:400,message:"General Linear error. Video player is unable to display the Linear Ad."},s.FILE_NOT_FOUND={id:401,message:"File not found. Unable to find Linear/MediaFile from URI."},s.MEDIAFILE_TIMEOUT={id:402,message:"Timeout of MediaFile URI."},s.UNSUPPORTED_MEDIAFILE={id:403,message:"Could not find MediaFile that is supported by this video player, based on the attributes of the MediaFile element."},s.MEDIAFILE_DISPLAY={id:405,message:"Problem displaying MediaFile. Video player found a MediaFile with supported type but could not display it. MediaFile may include: unsupported codecs, different MIME type than MediaFile@type, unsupported delivery method, etc."},s.GENERAL_NONLINEAR={id:500,message:"General NonLinearAds error."},s.CREATIVE_DIMENSIONS={id:501,message:"Unable to display NonLinear Ad because creative dimensions do not align with creative display area (i.e. creative dimension too large)."},s.NONLINEAR_FETCH={id:502,message:"Unable to fetch NonLinearAds/NonLinear resource."},s.SUPPORTED_NONLINEAR_NOT_FOUND={id:503,message:"Could not find NonLinear resource with supported type."},s.GENERAL_COMPANION={id:600,message:"General CompanionAds error."},s.COMPANION_DIMENSIONS={id:601,message:"Unable to display Companion because creative dimensions do not fit within Companion display area (i.e., no available space)."},s.COMPANION_DISPLAY={id:602,message:"Unable to display Required Companion."},s.COMPANION_FETCH={id:603,message:"Unable to fetch CompanionAds/Companion resource."},s.SUPPORTED_COMPANION_NOT_FOUND={id:604,message:"Could not find Companion resource with supported type."},s.UNDEFINED={id:900,message:"Undefined Error"},s.GENERAL={id:901,message:"General VPAID error"}},function(e,t,i){i.d(t,"a",(function(){return r}));var n=i(9),s=i(46);class r{constructor(e){if(this.logger=new n.a("option."+e),!e)throw new s.a(s.a.OPTION_NAME_REQUIRED)}}},function(e,t,i){i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var n,s=i(1),r=i(8);!function(e){e.Error="error",e.Click="click",e.Pause="pause",e.Resume="resume",e.Skip="skip",e.CreativeView="creativeView",e.Start="start",e.FirstQuartile="firstQuartile",e.Midpoint="midpoint",e.ThirdQuartile="thirdQuartile",e.Complete="complete",e.Impression="impression",e.Close="close",e.Progress="progress",e.Mute="mute",e.Unmute="unmute",e.Rewind="rewind",e.Fullscreen="fullscreen",e.ExitFullscreen="exitFullscreen",e.Expand="expand",e.Collapse="collapse",e.AcceptInvitationLinear="acceptInvitationLinear",e.AcceptInvitation="acceptInvitation",e.CloseLinear="closeLinear",e.NoAd="noAd",e.NoLinearAd="noLinearAd",e.CustomClicks="customClicks",e.Billable="billable",e.OtherAdInteraction="otherAdInteraction",e.ClickIcon="clickIcon"}(n||(n={}));const a=Object(r.b)(Object.keys(n),s.cArray.map(e=>n[e]))},function(e,t,i){i.d(t,"a",(function(){return l}));var n=i(22),s=i(0),r=i(8),a=i(1);function o(e){(new Image).src=e}const d=a.cArray.forEach(o),c=a.cArray.forEach(o),l=(e,t,i)=>`${e}-${t}-${i}`;var h=i(14),u=i(19),p=i(49),g=i(36),m=i(44),b=i(9),f=i(2),v=i(25),A=i(51);const y=new b.a("tracker-v2 formatTracker"),w=(e,{trackedEvents:t})=>!Object(a.some)(t,t=>t.event===e),E=(e,t)=>i=>{const n=(i,n)=>Object(r.b)(p.formatEventToMirroredEvent[n],n=>O(n,n,t,e,i,T(n,e))),s=Object(r.b)(i.trackedEvents,a.cArray.map(Object(f.prop)("event")));return Object(r.b)(s,Object(r.a)(a.cArray.filter(p.matchesAdAvailableErrorVast),a.cArray.foldLeft(i,(i,n)=>Object(r.b)(n,p.parseFormatErrorAction,v.a.fstMap(e=>p.formatEventToMirroredEvent[e]),p.createFormatErrorAction,n=>O(n,p.FormatEvent.NoAdVastError,t,e,i,T(n,e))))),e=>Object(r.b)(s,a.cArray.filter(Object(a.isMemberOf)(p.nonErrorFormatEventsWithMirroringEvent)),a.cArray.foldLeft(e,n)))},O=(e,t,i,o,d,c,l=f.identity)=>{const{trackStrategy:h,baseUrl:u,formatVersion:m,referer:b,timestamp:v=Object(n.a)()}=o;if(!i(e,d))return e!==p.FormatEvent.SlotVisibilityTiny&&e!==p.FormatEvent.SlotVisibilityInvalidDom&&e!==p.FormatEvent.SlotVisibilityHiddenDisplay&&e!==p.FormatEvent.SlotVisibilityHiddenOverflow&&y.debug(`Could not track format event ${e}, tracked events: `,d.trackedEvents),d;const w=["gdpr_status","gdpr_consent","gdpr_reason","gdpr_api_version","gdpr_cmp_id","rpm_reason"],O=({queryParameters:e,businessIds:{insertionId:t,connectionId:i}})=>Object.assign(Object.assign({},Object(A.b)(e,e=>Object(a.includes)(g.c,e)&&!Object(a.includes)(w,e))),{gid:t,sid:i});return h([c]),Object(r.b)(Object.assign(Object.assign({},d),{trackedEvents:[...d.trackedEvents,{event:e,time:v,trackingUrl:c}]}),l,e=>t===p.FormatEvent.AdCall?E({trackStrategy:h,baseUrl:u,formatVersion:m,referer:b,timestamp:v,queryParameters:O(o),trackingUrl:s.a},i)(e):t===p.FormatEvent.AdAvailableSuccess?E(o,i)(e):e)},C=(e,{trackStrategy:t,timestamp:i=Object(n.a)()})=>n=>Object(a.isEmpty)(n.customTrackings)?n:Object(r.b)(n.customTrackings,a.cArray.filter(Object(r.a)(Object(f.prop)("event"),Object(f.equals)(e))),a.cArray.flatMap(Object(f.prop)("trackingUrls")),Object(f.tap)(t),t=>Object.assign(Object.assign({},n),{trackedEvents:[...n.trackedEvents,...Object(a.map)(t,t=>({event:e,time:i,trackingUrl:t}))]})),I=(e,t)=>()=>{const{baseUrl:i,formatVersion:s,referer:r,timestamp:a=Object(n.a)(),queryParameters:o}=t;return Object(m.e)(Object(m.b)(i,Object.assign(Object.assign({},o),{action:e,fv:s,ts:a.toString(),referer:r})))},S=e=>t=>{const{formatVersion:i,referer:s,timestamp:r=Object(n.a)()}=e;return Object(m.e)({baseUrl:t,queryParameters:{fv:i,ts:r.toString(),referer:s}})},T=(e,t)=>t.trackingUrl.match({some:S(t),none:I(e,t)}),k={track:(e,t,i)=>O(e,e,k.canTrack,t,i,T(e,t),C(e,t)),trackFormatError:(e,t,i)=>Object(r.b)(Object(p.createFormatErrorAction)([p.FormatEvent.AdAvailableErrorVast,e]),e=>O(e,p.FormatEvent.AdAvailableErrorVast,k.canTrack,t,i,T(e,t),C(e,t))),canTrack:w};var j=k;const P={track:(e,t,i)=>O(e,e,P.canTrack,t,i,T(e,t)),trackFormatError:(e,t,i)=>Object(r.b)(Object(p.createFormatErrorAction)([p.FormatEvent.AdAvailableErrorVast,e]),e=>O(e,p.FormatEvent.AdAvailableErrorVast,P.canTrack,t,i,T(e,t))),canTrack:w};var L=P,x=i(33);const V=[u.a.Progress,u.a.Click,u.a.Resume,u.a.Pause,u.a.Mute,u.a.Unmute,u.a.Expand,u.a.Collapse],N=(e,t,i)=>n=>0===n.customTrackings.length?n:Object(r.b)(n.customTrackings,a.cArray.filter(Object(r.a)(Object(f.prop)("event"),Object(f.equals)(e))),a.cArray.flatMap(Object(f.prop)("trackingUrls")),s=>s.length>0?i(e,()=>!0,s,t,n):n),D=(e,t,i)=>n=>0===n.customTrackings.length?n:Object(r.b)(n.customProgressTrackings,a.cArray.filter(Object(r.a)(Object(f.prop)("offset"),Object(f.equals)(e))),a.cArray.flatMap(Object(f.prop)("trackingUrls")),e=>e.length>0?i(u.a.Progress,()=>!0,e,t,n):n),_=(e,t,i,n)=>s=>1===e?s:Object(r.b)(Object(r.b)([...Array(e-1)],a.cArray.mapWithIndex((e,t)=>t+1)),Object(a.difference)(s.trackedProgressOffsets),a.cArray.map(e=>{var t,i;return[e,null!==(i=null===(t=Object(a.find)(s.progressTrackings,t=>t.offset===e))||void 0===t?void 0:t.trackingUrls)&&void 0!==i?i:[]]}),a.cArray.filter(([,e])=>e.length>0),a.cArray.foldLeft(s,(e,[s,r])=>n(u.a.Progress,(e,t)=>i(e,t)&&!Object(a.includes)(t.trackedProgressOffsets,s),r,t,e,e=>Object.assign(Object.assign({},e),{trackedProgressOffsets:[...e.trackedProgressOffsets,s]})))),R=new b.a("tracker-v2 thirdPartyVastTracker"),M=(e,t,i,s,r,o=f.identity)=>{const{trackStrategy:d,macros:c,timestamp:l=Object(n.a)()}=s;return t(e,r)?o(Object(a.reduce)(i,(t,i)=>{const n=Object(x.a)(c)(i);return d([n]),Object.assign(Object.assign({},t),{trackedEvents:[...t.trackedEvents,{event:e,time:l,trackingUrl:n}]})},r)):(R.debug(`Could not track third-party VAST event ${e}, tracked events: `,r.trackedEvents,"multiple-allowed events: ",V),r)},F={track:(e,t,i)=>{var n,s;return Object(r.b)(M(e,F.canTrack,null!==(s=null===(n=Object(a.find)(i.trackings,t=>t.event===e))||void 0===n?void 0:n.trackingUrls)&&void 0!==s?s:[],t,i),N(e,t,M))},trackProgress:(e,t,i)=>Object(r.b)(i,_(e,t,F.canTrack,M),i=>{var n,s;return M(u.a.Progress,(t,i)=>F.canTrack(t,i)&&!Object(a.includes)(i.trackedProgressOffsets,e),null!==(s=null===(n=Object(a.find)(i.progressTrackings,t=>t.offset===e))||void 0===n?void 0:n.trackingUrls)&&void 0!==s?s:[],t,i,t=>Object.assign(Object.assign({},t),{trackedProgressOffsets:[...t.trackedProgressOffsets,e]}))},D(e,t,M)),trackVastError:(e,t,i)=>{var n,s;const o=Object.assign(Object.assign({},t),{macros:[...t.macros,Object(x.k)("ErrorCode",e.toString())]});return Object(r.b)(M(u.a.Error,F.canTrack,null!==(s=null===(n=Object(a.find)(i.trackings,e=>e.event===u.a.Error))||void 0===n?void 0:n.trackingUrls)&&void 0!==s?s:[],o,i),N(u.a.Error,o,M))},canTrack:(e,{trackedEvents:t})=>!Object(a.some)(t,t=>t.event===e)||Object(a.isMemberOf)(V)(e)};var U=F,B=i(3),W=i(15);const H=new b.a("tracker-v2 teadsVastTracker"),z=e=>Object.assign(Object.assign({},e),{alreadyBilledAdvertiser:!0,trackBillable:!0}),G=[u.a.Impression,u.a.Start,u.a.Complete,u.a.Click,u.a.Error],q=(e,t,i,o,d,c=f.identity)=>{const{trackStrategy:l,formatVersion:h,referer:p,timestamp:g=Object(n.a)(),macros:b,slotType:v,cohort:A}=o;return t(e,d)?Object(r.b)(i,a.cArray.foldLeft(d,(t,i)=>{const[n,o]=(d=t,c=i,Object(W.m)(c,"revenue")&&Object(W.m)(c,"gid")?d.alreadyBilledAdvertiser&&c.indexOf("?dr=0")<0&&c.indexOf("&dr=0")<0?[d,Object(m.h)(c+"&dr=1")]:[z(d),c]:[d,c]);var d,c;const f=Object(r.a)(Object(x.a)(b),(e=>t=>Object(m.h)(Object(W.a)(t,"slot",encodeURIComponent(e))))(v),(e=>t=>Object(m.h)(Object(W.a)(t,"fv",encodeURIComponent(e))))(h),(y=t.studioCreativeId,e=>Object(r.b)(y,s.d.fold(()=>e,t=>Object(m.h)(Object(W.a)(e,"studio_cid",encodeURIComponent(t)))))),(e=>t=>Object(a.includes)(G,e)&&B.isCanvasUsed()?Object(m.h)(Object(W.a)(t,"debug_metadata",B.getEnv())):t)(e),(e=>t=>Object(m.h)(Object(W.a)(t,"referer",encodeURIComponent(e))))(p))(o);var y;const w=A&&(e=>e===u.a.Impression||e===u.a.Click)(e)?((e,t)=>{const i=Object(W.a)(t,"cohort_id",e.cohortId),n=Object(W.b)(i,"cohort_version",e.cohortVersion);return Object(m.h)(n)})(A,f):f;return l([w]),Object.assign(Object.assign({},n),{trackedEvents:[...n.trackedEvents,{event:e,time:g,trackingUrl:w}]})}),c):(H.debug(`Could not track VAST event ${e}, tracked events: `,d.trackedEvents,"multiple-allowed events: ",V),d)},K={track:(e,t,i)=>{var n,s;return Object(r.b)(q(e,K.canTrack,null!==(s=null===(n=Object(a.find)(i.trackings,t=>t.event===e))||void 0===n?void 0:n.trackingUrls)&&void 0!==s?s:[],t,i),N(e,t,q))},trackProgress:(e,t,i)=>Object(r.b)(i,_(e,t,K.canTrack,q),i=>{var n,s;return q(u.a.Progress,(t,i)=>K.canTrack(t,i)&&!Object(a.includes)(i.trackedProgressOffsets,e),null!==(s=null===(n=Object(a.find)(i.progressTrackings,t=>t.offset===e))||void 0===n?void 0:n.trackingUrls)&&void 0!==s?s:[],t,i,t=>Object.assign(Object.assign({},t),{trackedProgressOffsets:[...t.trackedProgressOffsets,e]}))},D(e,t,q)),trackVastError:(e,t,i)=>{var n,s;const o=Object.assign(Object.assign({},t),{macros:[...t.macros,Object(x.k)("ErrorCode",e.toString())]});return Object(r.b)(q(u.a.Error,K.canTrack,Object(r.b)(null!==(s=null===(n=Object(a.find)(i.trackings,e=>e.event===u.a.Error))||void 0===n?void 0:n.trackingUrls)&&void 0!==s?s:[],a.cArray.map((d=t.errorCause,e=>d.match({some:t=>Object(m.h)(Object(W.a)(e,"error_cause",encodeURIComponent(t))),none:()=>e})))),o,i),N(u.a.Error,o,q));var d},canTrack:(e,{trackedEvents:t})=>(e===u.a.Pause?Object(a.some)(t,e=>e.event===u.a.Start):e!==u.a.Resume||Object(a.some)(t,e=>e.event===u.a.Pause))&&(!Object(a.some)(t,t=>t.event===e)||Object(a.isMemberOf)(V)(e))};var $=K;$.track,$.trackProgress,$.trackVastError,U.track,U.trackProgress,U.trackVastError;const Y=e=>([t,i])=>[Object.assign(Object.assign({},t),{trackBillable:!1}),t.trackBillable?U.track(u.a.Billable,e,i):i],X=(e,t)=>(i,n)=>Object(r.b)([$.track(e,t,i),U.track(e,t,n)],Y(t)),Q=(e,t)=>(i,n)=>Object(r.b)([$.trackProgress(e,t,i),U.trackProgress(e,t,n)],Y(t)),J=(e,t,i)=>(n,a)=>Object(r.b)([$.trackVastError(e,Object.assign(Object.assign({},i),{errorCause:s.b.of(t)}),n),U.trackVastError(e,i,a)],Y(i)),Z=e=>Object(a.filter)(Object.keys(e),e=>!Object(a.includes)(["cs","revenue_advertising","revenue_fee","hb_bid_response_price_usd"],e)&&!/(e|s|c|_|rpm_)?(cost|revenue|hb_bid_response_price)(_fp)?(_curr)?/.test(e)&&!/publisher_platform_fee(_curr|_waived)?/.test(e)),ee={track:(e,t,i)=>{const{trackStrategy:s,trackingUrl:r,timestamp:a=Object(n.a)()}=t,o=(e=>Object(m.e)(Object(m.d)(e),Z))(r);return s([o]),Object.assign(Object.assign({},i),{trackedEvents:[...i.trackedEvents,{event:e,time:a,trackingUrl:o}]})}},te=(e,t,i,n,r)=>s.b.fromNullable(Object(a.last)(Object(a.filter)(e,t))).match({none:()=>i,some:({event:e,trackingUrl:t})=>ee.track(e,Object.assign(Object.assign({},n),{trackingUrl:Object(m.g)(t,r)}),i)}),ie=(e,t,i,n)=>Object(r.b)(e,a.cArray.foldLeft(t,(e,{event:t,trackingUrl:s})=>ee.track(t,Object.assign(Object.assign({},i),{trackingUrl:Object(m.g)(s,n)}),e))),ne=(e,t,{timestamp:i},n=s.a)=>(s,r,a)=>{const[o,d]=e(s,r);return[o,d,te(o.trackedEvents,({event:e})=>e===u.a.Error,a,Object.assign(Object.assign({},t),{timestamp:i}),n)]},se=(e,t,i,n=s.a)=>ne(((e,t)=>(i,n)=>Object(r.b)([$.trackVastError(e,Object.assign(Object.assign({},t),{errorCause:s.a}),i),U.trackVastError(e,t,n)],Y(t)))(e,i),t,i,n);var re=ee;const ae=new b.a("tracker-v2 thirdPartyTracker"),oe={track:(e,t,i)=>{const{trackStrategy:s,timestamp:a=Object(n.a)(),trackingUrl:o,macros:d}=t;if(!oe.canTrack(e,i))return ae.debug(`Could not track third-party format event ${e}, tracked events: `,i.trackedEvents),i;const c=Object(r.b)(o,Object(x.a)(d),i=>"comscore"===e?(({gdprStatus:e,gdprConsent:t},i)=>{switch(e){case 0:return Object(r.b)(Object(W.a)(i,"gdpr","0"),p.thirdPartyFormatUrl);case 11:case 12:return Object(r.b)(Object(W.a)(i,"gdpr","1"),e=>""!==t?Object(W.a)(e,"gdpr_consent",t):e,p.thirdPartyFormatUrl);default:return i}})(t,i):i);return s([c]),Object.assign(Object.assign({},i),{trackedEvents:[...i.trackedEvents,{event:e,time:a,trackingUrl:c}]})},canTrack:(e,t)=>!0};var de=oe;const ce=e=>Object.assign({formatVersion:"822",trackStrategy:d},e);const le=Object(r.a)(Object(f.prop)("trackedEvents"),a.cArray.map(Object(f.prop)("event"))),he=([e,t])=>Object(a.difference)(le(e))(le(t)),ue=v.a.bimap(he,he),pe=e=>Object(W.o)(e)||Object(W.n)(Object(W.p)(e).hostname),ge=e=>!pe(e),me=(e,t)=>i=>Object(r.b)(Object.keys(e),a.cArray.filter(t=>Object(a.isNotEmpty)(e[t])),a.cArray.filter(Object(a.isMemberOf)(u.b)),a.cArray.foldLeft(i,(i,n)=>n===u.a.Progress?(e=>(t,i)=>Object(r.b)(t,a.cArray.map(({url:e,data:t})=>Object(r.b)(e,s.b.fromNullable,s.d.filter(i),s.d.map(e=>({url:e,offset:t})))),s.e,Object(a.groupByMap)(Object(f.prop)("offset"),Object(f.prop)("url")),t=>Object(r.b)(Object.keys(t),a.cArray.map(e=>parseInt(e,10)),a.cArray.foldLeft(e,(e,i)=>Object(r.b)(t[i],e=>({offset:i,trackingUrls:e}),ve(e))))))(i)(e[n],t):(e=>(t,i,n)=>Object(r.b)(t,a.cArray.map(Object(r.a)(Object(f.prop)("url"),s.b.fromNullable,s.d.filter(e=>""!==e),s.d.filter(i))),s.e,e=>({event:n,trackingUrls:e}),fe(e)))(i)(e[n],t,n))),be=e=>t=>Object(r.b)(t,v.a.bimap(me(e,pe),me(e,ge))),fe=e=>t=>Object.assign(Object.assign({},e),{trackings:[...e.trackings,t]}),ve=e=>t=>Object.assign(Object.assign({},e),{progressTrackings:[...e.progressTrackings,t]}),Ae=([e,t])=>t.trackedEvents.slice(e.trackedEvents.length),ye=v.a.bimap(Ae,Ae);t.b={format:{getNewTrackedEvents:he,getNewTrackedEventsWithDebug:ue,addFormatCustomTrackings:e=>({event:t,trackingUrl:i})=>Object(r.b)(Object(h.a)(e),e=>Object.assign(Object.assign({},e),{customTrackings:[...e.customTrackings,{event:t,trackingUrls:[i]}]}),Object(h.i)(e)),classic:{track:function(e){return(t,i)=>Object(r.b)([Object(h.a)(e),Object(h.a)(e)],v.a.sndMap(n=>Object(r.b)(j.track(t,ce(i),n),Object(h.i)(e))))},trackWithDebug:function(e){return(t,i,n=s.a)=>Object(r.b)([[Object(h.a)(e),Object(h.b)(e)],[Object(h.a)(e),Object(h.b)(e)]],v.a.sndMap(([o,d])=>Object(r.b)(((e,t,i,n=s.a)=>(s,r)=>{const o=j.track(e,i,s);return[o,ie(Object(a.difference)(s.trackedEvents)(o.trackedEvents),r,Object.assign(Object.assign({},t),{timestamp:i.timestamp}),n)]})(t,{trackStrategy:c},ce(i),n)(o,d),v.a.bimap(Object(h.i)(e),Object(h.j)(e)))),v.a.zip)},trackError:e=>(t,i)=>Object(r.b)([Object(h.a)(e),Object(h.a)(e)],v.a.sndMap(n=>Object(r.b)(j.trackFormatError(t,ce(i),n),Object(h.i)(e)))),trackErrorWithDebug:e=>(t,i,n)=>Object(r.b)([[Object(h.a)(e),Object(h.b)(e)],[Object(h.a)(e),Object(h.b)(e)]],v.a.sndMap(([o,d])=>Object(r.b)(((e,t,i,n=s.a)=>(s,r)=>{const o=j.trackFormatError(e,i,s);return[o,ie(Object(a.difference)(s.trackedEvents)(o.trackedEvents),r,Object.assign(Object.assign({},t),{timestamp:i.timestamp}),n)]})(t,{trackStrategy:c},ce(i),n)(o,d),v.a.bimap(Object(h.i)(e),Object(h.j)(e)))),v.a.zip)},headerBidding:{track:function(e){return(t,i)=>Object(r.b)([Object(h.c)(e),Object(h.c)(e)],v.a.sndMap(n=>Object(r.b)(L.track(t,ce(i),n),Object(h.k)(e))))},trackWithDebug:function(e){return(t,i,n=s.a)=>Object(r.b)([[Object(h.c)(e),Object(h.b)(e)],[Object(h.c)(e),Object(h.b)(e)]],v.a.sndMap(([o,d])=>Object(r.b)(((e,t,i,n=s.a)=>(s,r)=>{const o=L.track(e,i,s);return[o,ie(Object(a.difference)(s.trackedEvents)(o.trackedEvents),r,Object.assign(Object.assign({},t),{timestamp:i.timestamp}),n)]})(t,{trackStrategy:c},ce(i),n)(o,d),v.a.bimap(Object(h.k)(e),Object(h.j)(e)))),v.a.zip)},trackError:e=>(t,i)=>Object(r.b)([Object(h.c)(e),Object(h.c)(e)],v.a.sndMap(n=>Object(r.b)(L.trackFormatError(t,ce(i),n),Object(h.k)(e)))),trackErrorWithDebug:e=>(t,i,n,o)=>Object(r.b)([[Object(h.c)(e),Object(h.b)(e)],[Object(h.c)(e),Object(h.b)(e)]],v.a.sndMap(([t,d])=>Object(r.b)(((e,t,i,n=s.a)=>(s,r)=>{const o=L.trackFormatError(e,i,s);return[o,ie(Object(a.difference)(s.trackedEvents)(o.trackedEvents),r,Object.assign(Object.assign({},t),{timestamp:i.timestamp}),n)]})(i,{trackStrategy:c},ce(n),o)(t,d),v.a.bimap(Object(h.k)(e),Object(h.j)(e)))),v.a.zip)},thirdParty:e=>(t,i)=>Object(r.b)(Object(h.d)(e),e=>de.track(t,Object.assign(Object.assign({},i),{trackStrategy:d}),e),Object(h.l)(e))},vast:{getNewTrackedVastEvents:Ae,getNewTrackedVastEventsWithDebug:ye,addVastCustomTrackings:e=>({event:t,trackingUrl:i})=>Object(r.b)([Object(h.f)(e),Object(h.e)(e)],v.a.bimap(e=>pe(i)?Object.assign(Object.assign({},e),{customTrackings:[...e.customTrackings,{event:t,trackingUrls:[i]}]}):e,e=>ge(i)?Object.assign(Object.assign({},e),{customTrackings:[...e.customTrackings,{event:t,trackingUrls:[i]}]}):e),v.a.bimap(Object(h.n)(e),Object(h.m)(e))),addVastCustomProgressTrackings:e=>({offset:t,trackingUrl:i})=>Object(r.b)([Object(h.f)(e),Object(h.e)(e)],v.a.bimap(e=>pe(i)?Object.assign(Object.assign({},e),{customProgressTrackings:[...e.customProgressTrackings,{offset:t,trackingUrls:[i]}]}):e,e=>ge(i)?Object.assign(Object.assign({},e),{customProgressTrackings:[...e.customProgressTrackings,{offset:t,trackingUrls:[i]}]}):e),v.a.bimap(Object(h.n)(e),Object(h.m)(e))),registerVastTrackings:e=>t=>Object(r.b)([Object(h.f)(e),Object(h.e)(e)],be(t),v.a.bimap(Object(h.n)(e),Object(h.m)(e))),trackedEventsToEventsWithTrackingUrls:e=>Object(r.b)(e,Object(a.groupBy)(Object(f.prop)("event")),e=>Object(r.b)(Object.keys(e),a.cArray.foldLeft([],(t,i)=>[...t,{event:i,trackingUrls:Object(r.b)(e[i],a.cArray.map(Object(f.prop)("trackingUrl")))}]))),setStudioCreativeId:e=>t=>Object(r.b)(Object(h.f)(e),e=>Object.assign(Object.assign({},e),{studioCreativeId:s.b.fromPredicate(t,f.isString)}),Object(h.n)(e)),resetTrackedEvents:e=>Object(r.b)([[Object(h.f)(e),Object(h.f)(e)],[Object(h.e)(e),Object(h.e)(e)]],v.a.bimap(v.a.sndMap(t=>Object(r.b)(Object.assign(Object.assign({},t),{trackedEvents:h.h.trackedEvents,trackedProgressOffsets:h.h.trackedProgressOffsets,alreadyBilledAdvertiser:h.h.alreadyBilledAdvertiser}),Object(h.n)(e))),v.a.sndMap(t=>Object(r.b)(Object.assign(Object.assign({},t),{trackedEvents:h.g.trackedEvents,trackedProgressOffsets:h.g.trackedProgressOffsets}),Object(h.m)(e))))),track:e=>(t,i)=>Object(r.b)([Object(h.f)(e),Object(h.e)(e)],([n,s])=>Object(r.b)(X(t,Object.assign(Object.assign({},i),{trackStrategy:d,formatVersion:"822"}))(n,s),([e,t])=>[[n,e],[s,t]],v.a.bimap(v.a.sndMap(Object(h.n)(e)),v.a.sndMap(Object(h.m)(e))))),trackWithDebug:e=>(t,i,n=s.a)=>Object(r.b)([Object(h.f)(e),Object(h.e)(e),Object(h.b)(e)],([a,o,l])=>Object(r.b)(((e,t,i,n=s.a)=>(s,r,a)=>{const[o,d]=X(e,i)(s,r);return[o,d,te(o.trackedEvents,t=>t.event===e,a,Object.assign(Object.assign({},t),{timestamp:i.timestamp}),n)]})(t,{trackStrategy:c},Object.assign(Object.assign({},i),{trackStrategy:d,formatVersion:"822"}),n)(a,o,l),([e,t,i])=>[[[a,e],[l,i]],[o,t]],v.a.bimap(Object(r.a)(v.a.fstMap(v.a.sndMap(Object(h.n)(e))),v.a.sndMap(v.a.sndMap(Object(h.j)(e)))),v.a.sndMap(Object(h.m)(e))))),trackProgress:e=>(t,i)=>Object(r.b)([Object(h.f)(e),Object(h.e)(e)],([n,s])=>Object(r.b)(Q(t,Object.assign(Object.assign({},i),{trackStrategy:d,formatVersion:"822"}))(n,s),([e,t])=>[[n,e],[s,t]],v.a.bimap(v.a.sndMap(Object(h.n)(e)),v.a.sndMap(Object(h.m)(e))))),trackProgressWithDebug:e=>(t,i,n=s.a)=>Object(r.b)([Object(h.f)(e),Object(h.e)(e),Object(h.b)(e)],([a,o,l])=>Object(r.b)(((e,t,i,n=s.a)=>(s,r,a)=>{const[o,d]=Q(e,i)(s,r);return[o,d,te(o.trackedEvents,({event:t,trackingUrl:i})=>t===u.a.Progress&&new RegExp("action=progress-"+e).test(i),a,Object.assign(Object.assign({},t),{timestamp:i.timestamp}),n)]})(t,{trackStrategy:c},Object.assign(Object.assign({},i),{trackStrategy:d,formatVersion:"822"}),n)(a,o,l),([e,t,i])=>[[[a,e],[l,i]],[o,t]],v.a.bimap(Object(r.a)(v.a.fstMap(v.a.sndMap(Object(h.n)(e))),v.a.sndMap(v.a.sndMap(Object(h.j)(e)))),v.a.sndMap(Object(h.m)(e))))),trackErrorWithDebug:e=>(t,i,n=s.a)=>Object(r.b)([Object(h.f)(e),Object(h.e)(e),Object(h.b)(e)],([s,a,o])=>Object(r.b)(se(t,{trackStrategy:c},Object.assign(Object.assign({},i),{trackStrategy:d,formatVersion:"822"}),n)(s,a,o),([e,t,i])=>[[[s,e],[o,i]],[a,t]],v.a.bimap(Object(r.a)(v.a.fstMap(v.a.sndMap(Object(h.n)(e))),v.a.sndMap(v.a.sndMap(Object(h.j)(e)))),v.a.sndMap(Object(h.m)(e))))),trackErrorWithCause:e=>(t,i,n)=>{const s=i.slice(0,128),r=Object(h.f)(e),a=Object(h.e)(e),[o,c]=J(t,s,Object.assign(Object.assign({},n),{trackStrategy:d,formatVersion:"822"}))(r,a);return Object(h.n)(e)(o),Object(h.m)(e)(c),[[r,o],[a,c]]},trackErrorWithCauseWithDebug:e=>(t,i,n,a=s.a)=>Object(r.b)([Object(h.f)(e),Object(h.e)(e),Object(h.b)(e)],([o,l,u])=>Object(r.b)(((e,t,i,n,r=s.a)=>ne(J(e,t,n),i,n,r))(t,i,{trackStrategy:c},Object.assign(Object.assign({},n),{trackStrategy:d,formatVersion:"822"}),a)(o,l,u),([e,t,i])=>[[[o,e],[u,i]],[l,t]],v.a.bimap(Object(r.a)(v.a.fstMap(v.a.sndMap(Object(h.n)(e))),v.a.sndMap(v.a.sndMap(Object(h.j)(e)))),v.a.sndMap(Object(h.m)(e)))))},debug:{track:e=>(t,{baseUrl:i,referer:a,queryParameters:o},d=s.a)=>Object(r.b)(Object(m.a)({baseUrl:i,queryParameters:Object.assign({referer:a,action:t,fv:"822",ts:Object(n.a)().toString()},o)},d),i=>re.track(t,{trackStrategy:c,trackingUrl:i},Object(h.b)(e)),Object(h.j)(e))}}},function(e,t,i){i.d(t,"b",(function(){return o})),i.d(t,"d",(function(){return d})),i.d(t,"a",(function(){return c})),i.d(t,"c",(function(){return l}));class n{constructor(e){if(this.isValid=!0,"string"!=typeof e&&(e=""+e),e.length>s)return void(this.isValid=!1);const t=e.trim().match(a);if(!t){return e.split(".").length<3?new n(e+".0"):void(this.isValid=!1)}this.raw=e,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>r||this.major<0||this.minor>r||this.minor<0||this.patch>r||this.patch<0?this.isValid=!1:this.version=this.major+"."+this.minor+"."+this.patch}toString(){return this.version}}const s=256,r=9007199254740991,a=new RegExp("^v?(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*).*?$");function o(e,t){let i=u(e,t);return null!==i&&i>0}function d(e,t){let i=u(e,t);return null!==i&&i<0}function c(e,t){let i=u(e,t);return null!==i&&i>=0}function l(e,t){let i=u(e,t);return null!==i&&i<=0}function h(e,t){return e<t?-1:e>t?1:0}function u(e,t){let i=new n(e),s=new n(t);return i.isValid&&s.isValid?function(e,t){return h(e.major,t.major)||h(e.minor,t.minor)||h(e.patch,t.patch)}(i,s):null}},function(e,t,i){i.d(t,"a",(function(){return a}));var n=i(2);const s=window.Date,r=s.prototype.getTime,a=Object(n.isNative)(s.now)?s.now:Object(n.isNative)(r)?()=>r.call(new s):()=>+new s;s.now||(s.now=a)},function(e,t,i){i.d(t,"m",(function(){return p})),i.d(t,"b",(function(){return v})),i.d(t,"l",(function(){return O})),i.d(t,"i",(function(){return C})),i.d(t,"j",(function(){return I})),i.d(t,"k",(function(){return S})),i.d(t,"d",(function(){return j})),i.d(t,"h",(function(){return P})),i.d(t,"g",(function(){return x})),i.d(t,"a",(function(){return V})),i.d(t,"e",(function(){return F})),i.d(t,"f",(function(){return U})),i.d(t,"c",(function(){return B}));var n=i(8),s=i(9),r=i(22),a=i(0),o=i(1),d=i(12),c=i(5),l=i(2),h=i(28);const u=e=>c.a.tryCatch(()=>e.performance||e.webkitPerformance||e.msPerformance||e.mozPerformance).toOption(),p=u(window),g={},m=e=>a.b.fromNullable(g[e]),b=e=>m(e).flatMap(Object(n.a)(Object(l.prop)("startTime"),a.b.fromNullable)).getOrValue(A),f=e=>"teads-mark-"+e.name+(e.id?"-"+e.id:""),v=(...e)=>e.join("-"),A=-1,y={ttp:[{name:"a"},{name:"d"},{name:"b"}],tm:[{name:"a"},{name:"b",isId:!0},{name:"d",isId:!0}],tm_is:[{name:"b",isId:!0},{name:"d",isId:!0}],common:[{name:"c",isId:!0},{name:"e",isId:!0},{name:"f",isId:!0},{name:"g",isId:!0},{name:"h",isId:!0},{name:"i",isId:!0},{name:"k",isId:!0}],ac:[{name:"b",isId:!0},{name:"l",isId:!0}],al:[{name:"b",isId:!0},{name:"m",isId:!0},{name:"n",isId:!0}],as:[{name:"n",isId:!0},{name:"o",isId:!0},{name:"p",isId:!0}],tpb:[{name:"b",isId:!0},{name:"q",isId:!0}],ar2al:[{name:"k",isId:!0},{name:"r",isId:!0},{name:"s",isId:!0},{name:"m",isId:!0},{name:"n",isId:!0}]},w={tag:{name:/(^http(s)*:\/\/a\.teads\.tv\/page\/\d+\/tag|\/dist\/quality\/v3\/ms\/tag\/.+\.js)/,value:a.a,win:a.a},format:{name:/(^(http(s)?:)?\/\/s8t\.teads\.tv\/media\/format\/v3|\/dist\/format)\/teads-format(\.min)?\.js/,value:a.a,win:a.a}},E=new s.a("Timing");function O(){return p.map(e=>e.now()).getOrElse(r.a)}function C(e){const t=f(e);p.filter(e=>Object(l.isFunction)(e.mark)).match({some:e=>e.mark(t),none:()=>{g[t]={name:t,entryType:"mark",startTime:O(),duration:0}}})}function I(e){T(e).isEmpty()&&C(e)}function S(e,t,i={name:"measure",id:Object(d.rand)(10)}){const n=f(i),s=f(e),r=f(t);return p.filter(e=>Object(l.isFunction)(e.measure)).match({some:i=>c.a.tryCatch(()=>i.measure(n,s,r)).tapLeft(i=>E.warn("measure not available between",e,"and",t)),none:()=>{g[n]={name:n,entryType:"measure",startTime:b(s),duration:b(r)-b(s)}}}),T(i)}function T(e,t=!0){const i=f(e);return p.filter(e=>Object(l.isFunction)(e.getEntriesByName)).match({some:e=>a.b.fromNullable(e.getEntriesByName(i).pop()),none:()=>t?m(i):a.a})}function k(e,t=window){return u(t).filter(e=>Object(l.isFunction)(e.getEntriesByType)).map(t=>t.getEntriesByType(e)).filter(o.isNotEmpty)}function j(e=window){return k("resource",e)}function P(e,t=window){return j(t).flatMap(t=>a.b.fromNullable(Object(o.find)(t,t=>e.test(t.name))))}function L(e=window){return u(e).flatMap(e=>{var t;return a.b.fromNullable(null===(t=e.timing)||void 0===t?void 0:t.navigationStart)})}function x(e=window){return function(e=window){return k("navigation",e)}(e).match({some:e=>a.b.fromNullable(e[0].responseStart-e[0].requestStart).map(Math.round),none:()=>u(e).flatMap(Object(n.a)(Object(l.prop)("timing"),a.b.fromNullable)).map(e=>e.responseStart-e.requestStart)})}function V(e,t){Object(o.forEach)(t,t=>Object(o.forEach)(e,e=>w[e].value=w[e].value.orElse(()=>(w[e].win=a.b.fromNullable(t),P(w[e].name,t)))))}function N(e,t,i){return t.match({some:t=>({load:t.duration,eval:i.match({some:e=>e.startTime-t.responseEnd,none:()=>A}),key:e}),none:()=>({load:A,eval:A,key:e})})}function D(){const e=N("tr",w.tag.value,w.format.value),t=w.tag.win.getOrValue(window),i=w.format.win.getOrValue(window);return e.eval!==A&&t!==i&&(e.eval-=L(t).map(e=>L(i).map(t=>e-t).getOrValue(0)).getOrValue(0)),e}function _(e){return"fu="+e+(h.b.isQA?"_qa ":" ")}function R(e){let t="";return Object(o.forEach)(e,e=>{t+=`${e.key}l=${Math.round(e.load)} `,t+=`${e.key}e=${Math.round(e.eval)} `}),t}function M(e,t,i="first"){let n,s="",r=[];return Object(o.forEach)(e,e=>{r=r.concat(y[e])}),Object(o.forEach)(r,e=>{if(n){const r=S({name:n.name,id:n.isId?t:""},{name:e.name,id:e.isId?t:""}).map(e=>Math.round(e.duration)).getOrValue(A),a="first"===i?n.name:e.name;s+=`${a}=${r} `}n=e}),s}function F(e,t){return[_(e),R([D(),N("fr",w.format.value,T({name:"a"},!1))]),M([e,"common"],t)].join("")}function U(e,t){return[_(e),M([e],t,"last")].join("")}function B(e){let t=e.length;const i=Object(o.reduce)(e,(e,{transferSize:i,responseEnd:n,responseStart:s})=>i>0&&n>0&&s>=0&&n-s>0?e+8*i/1024/((n-s)/1e3):(t--,e),0);return t>0?i/t:0}},function(e,t,i){i.d(t,"a",(function(){return n})),i.d(t,"l",(function(){return d})),i.d(t,"e",(function(){return c})),i.d(t,"c",(function(){return l})),i.d(t,"d",(function(){return h})),i.d(t,"i",(function(){return u})),i.d(t,"h",(function(){return p})),i.d(t,"j",(function(){return g})),i.d(t,"b",(function(){return m})),i.d(t,"k",(function(){return b})),i.d(t,"f",(function(){return f})),i.d(t,"g",(function(){return v}));var n,s=i(1),r=i(5),a=i(8),o=i(2);!function(e){e.LimitedCapabilities="limitedCapabilities",e.PlacementCall="placementCall",e.FallbackIntegration="passback-integration",e.FallbackNoAd="passback-noAd",e.NoSlotSelector="noSlot-selector",e.HbNoSlotSelector="hbNoSlot-selector",e.NoSlotFilter="noSlot-filter",e.NoSlotAvoid="noSlot-avoid",e.NoSlotSize="noSlot-size",e.NoSlotBtf="noSlot-BTF",e.NoSlotMinimum="noSlot-minimum",e.NoSlotMinimumBelow="noSlot-minimumBelow",e.NoSlotContent="noSlot-content",e.NoSlotPosition="noSlot-position",e.NoSlotVideoArticle="noSlot-videoArticle",e.NoSlotVideoSlot="noSlot-videoSlot",e.NoSlotImageSlot="noSlot-imageSlot",e.NoSlotSafeFrame="noSlot-safeFrame",e.IncompatibilityBrowser="incompatibility-browser",e.IncompatibilityContext="incompatibility-context",e.IncompatibilityFormat="incompatibility-format",e.IncompatibilityVideo="incompatibility-video",e.SlotAvailable="slotAvailable",e.HbSlotAvailable="hbSlotAvailable",e.AdReceived="adReceived",e.AdNotAvailableNetworkError="adNotAvailable-networkError",e.AdNotAvailableServerError="adNotAvailable-serverError",e.AdAvailableErrorParseTimeout="adAvailable-error-parseTimeout",e.AdAvailableErrorBadResponse="adAvailable-error-badResponse",e.AdAvailableErrorVast="adAvailable-error-vast-{code}",e.AdAvailableErrorSettings="adAvailable-error-settings",e.AdAvailableErrorSameAd="adAvailable-error-sameAd",e.AdAvailableSuccess="adAvailable-success",e.AdCall="adCall",e.ErrorBeforeAdReached="errorBeforeAdReached",e.AdReached="adReached",e.NoAdServerError="noAd-serverError",e.NoAdNetworkError="noAd-networkError",e.NoAdVastError="noAd-vastError-{code}",e.NoAdParseTimeout="noAd-parseTimeout",e.NoAdSettingsError="noAd-settingsError",e.NoAdBadResponse="noAd-badResponse",e.NoAdSameAd="noAd-sameAd",e.NoAdIvtDoubleVerify="noAd-ivt-doubleVerify",e.NoAdIvtTag="noAd-ivt-tag",e.NoAdBlockedSiteDoubleVerify="noAd-blockedSite-doubleVerify",e.NoAdBlockedSiteTeads="noAd-blockedSite-teads",e.EarlyClick="early-click",e.ClickReplay="click-replay",e.Bts="bts",e.SlotVisibilityTiny="slotVisibility-tiny",e.SlotVisibilityInvalidDom="slotVisibility-invalid-dom",e.SlotVisibilityHiddenDisplay="slotVisibility-hidden-display",e.SlotVisibilityHiddenOverflow="slotVisibility-hidden-overflow",e.Warning="warning"}(n||(n={}));const d=Object(a.a)(r.a.of,r.f.filterOrElse(Object(s.isMemberOf)(["IVT DoubleVerify","IVT Tag","BlockedSite DoubleVerify","Teads Blacklist"]),e=>"Got an unknown fraud reason: "+e)),c=e=>{switch(e){case"tiny":return n.SlotVisibilityTiny;case"invalid-dom":return n.SlotVisibilityInvalidDom;case"hidden-display":return n.SlotVisibilityHiddenDisplay;case"hidden-overflow":return n.SlotVisibilityHiddenOverflow;default:return Object(o.exhaustive)(e)}},l={[n.AdNotAvailableServerError]:n.NoAdServerError,[n.AdNotAvailableNetworkError]:n.NoAdNetworkError,[n.AdAvailableErrorVast]:n.NoAdVastError,[n.AdAvailableErrorParseTimeout]:n.NoAdParseTimeout,[n.AdAvailableErrorSettings]:n.NoAdSettingsError,[n.AdAvailableErrorBadResponse]:n.NoAdBadResponse,[n.AdAvailableErrorSameAd]:n.NoAdSameAd},h=Object.keys(l),u=Object(a.b)(h,s.cArray.filter(Object(o.not)(Object(o.equals)(n.AdAvailableErrorVast)))),p=Object(a.b)(h,s.cArray.map(e=>l[e])),g=Object(a.b)(p,s.cArray.filter(Object(o.not)(Object(o.equals)(n.NoAdVastError)))),m=([e,t])=>e.replace("{code}",t.toString()),b=e=>Object(a.b)(e.split("-"),s.last,e=>parseInt(e,10),t=>[f(e)?n.AdAvailableErrorVast:n.NoAdVastError,t]),f=e=>new RegExp(n.AdAvailableErrorVast.replace("{code}","\\d{3}")).test(e),v=e=>new RegExp(n.NoAdVastError.replace("{code}","\\d{3}")).test(e)},function(e,t,i){i.d(t,"a",(function(){return n}));const n={bimap:(e,t)=>([i,n])=>[e(i),t(n)],fstMap:e=>([t,i])=>[e(t),i],sndMap:e=>([t,i])=>[t,e(i)],biforeach:(e,t)=>([i,n])=>{e(i),t(n)},fstForeach:e=>([t])=>e(t),sndForeach:e=>([,t])=>e(t),zip:([[e,t],[i,n]])=>[[e,i],[t,n]]}},function(e,t,i){i.d(t,"b",(function(){return n})),i.d(t,"d",(function(){return s})),i.d(t,"e",(function(){return r})),i.d(t,"a",(function(){return a})),i.d(t,"c",(function(){return o}));i(136);const n={inread:"inread",inboard:"inboard"},s={limitedCapabilities:"limitedCapabilities",placementCall:"placementCall",comscore:"comscore",fallback:{integration:"passback-integration",noAd:"passback-noAd"},noSlot:{selector:"noSlot-selector",hbSelector:"hbNoSlot-selector",filter:"noSlot-filter",avoid:"noSlot-avoid",size:"noSlot-size",btf:"noSlot-BTF",minimum:"noSlot-minimum",minimumBelow:"noSlot-minimumBelow",content:"noSlot-content",position:"noSlot-position",videoArticle:"noSlot-videoArticle",videoSlot:"noSlot-videoSlot",imageSlot:"noSlot-imageSlot",safeFrame:"noSlot-safeFrame"},incompatibility:{browser:"incompatibility-browser",context:"incompatibility-context",format:"incompatibility-format",video:"incompatibility-video"},slotAvailable:"slotAvailable",hbSlotAvailable:"hbSlotAvailable",adReceived:"adReceived",adNotAvailable:{networkError:"adNotAvailable-networkError",serverError:"adNotAvailable-serverError"},adAvailable:{error:{parseTimeout:"adAvailable-error-parseTimeout",badResponse:"adAvailable-error-badResponse",vast:"adAvailable-error-vast-{code}",settings:"adAvailable-error-settings",sameAd:"adAvailable-error-sameAd"},success:"adAvailable-success"},adCall:"adCall",errorBeforeAdReached:"errorBeforeAdReached",adReached:"adReached",noAd:{serverError:"noAd-serverError",networkError:"noAd-networkError",vastError:"noAd-vastError-{code}",parseTimeout:"noAd-parseTimeout",settingsError:"noAd-settingsError",badResponse:"noAd-badResponse",sameAd:"noAd-sameAd",ivt:{doubleVerify:"noAd-ivt-doubleVerify",tag:"noAd-ivt-tag"},blockedSite:{doubleVerify:"noAd-blockedSite-doubleVerify",teads:"noAd-blockedSite-teads"}},impression:"impression",openExpand:"open-expand",open:"open",visible:"visible",click:"click",clickReplay:"click-replay",ivt:{doubleVerify:"IVT DoubleVerify",tag:"IVT Tag"},blockedSite:{doubleVerify:"BlockedSite DoubleVerify",teads:"Teads Blacklist"},debugBts:"debug-bts",warning:"warning"},r={placementCall:"f11",noSlot:"f21",incompatibility:"f22",slotAvailable:"f24",adReceived:"f30",adNotAvailable:"f31","adAvailable-error":"f32","adAvailable-success":"f33",adCall:"f41",errorBeforeAdReached:"f42",adReached:"f43",noAd:"f51"},a={V2:{"http:":"http://b.scorecardresearch.com/p?c1=2&c2=17198971&ns_ap_sv=2.1511.10&ns_type=hidden&ns_st_it=a&ns_st_sv=4.0.0&ns_st_ad=1&ns_st_sq=1&ns_st_id=[impressionId]&ns_st_ec=1&ns_st_cn=1&ns_st_ev=play&ns_st_ct=va00&ns_st_cl=0&ns_st_pt=0&c3=*null&c4=*null&c6=*null&ns_ts=[CACHEBUSTING]&cs_ucfr=","https:":"https://sb.scorecardresearch.com/p?c1=2&c2=17198971&ns_ap_sv=2.1511.10&ns_type=hidden&ns_st_it=a&ns_st_sv=4.0.0&ns_st_ad=1&ns_st_sq=1&ns_st_id=[impressionId]&ns_st_ec=1&ns_st_cn=1&ns_st_ev=play&ns_st_ct=va00&ns_st_cl=0&ns_st_pt=0&c3=*null&c4=*null&c6=*null&ns_ts=[CACHEBUSTING]&cs_ucfr="},V2SDK:"https://sb.scorecardresearch.com/p?c1=19&c2=17198971&c12=[userId]&ns_ap_pn=[os]&ns_ap_device=[device]&ns_ap_sv=2.1602.11&ns_type=hidden&ns_st_it=a&ns_st_sv=4.0.0&ns_st_ad=1&ns_st_sq=1&ns_st_id=[impressionId]&ns_st_ec=1&ns_st_cn=1&ns_st_ev=play&ns_st_ct=va00&ns_st_cl=0&ns_st_pt=0&c3=*null&c4=*null&c6=*null&ns_ts=[CACHEBUSTING]&cs_ucfr="},o="teads_internal_passback_no_passback"},function(e,t,i){function n(e,t,i){e.style[t]=i,t=s(t),e.style["Moz"+t]=i,e.style["webkit"+t]=i,e.style["O"+t]=i,e.style["ms"+t]=i}function s(e){return e.charAt(0).toUpperCase()+e.slice(1)}function r(){return window.performance?window.performance.now():Date.now()}function a(e,t){for(var i=0,n=e.length;i<n;i++)e[i]=t}function o(e){return e<1?parseFloat(e.toString().substr(0,4)):Math.round(e)}i.r(t),i.d(t,"applyVendorProperties",(function(){return n})),i.d(t,"capitalize",(function(){return s})),i.d(t,"now",(function(){return r})),i.d(t,"fillArray",(function(){return a})),i.d(t,"formatBenchTime",(function(){return o}))},function(e,t,i){i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return r}));var n=i(0);class s{constructor(e={}){this.protocol="https:",this.basePathUrl=this.protocol+"//s8t.teads.tv/media/format/v3",this.assetsUrl=this.basePathUrl+"/assets",this.formatPlayerAssetUrl=this.basePathUrl+"/teads-format-with-player.js",this.richAdServerUrl=this.protocol+"//a.teads.tv/page/{id}/ad",this.buyingEngineUrl=this.protocol+"//a.teads.tv/vast/get",this.trackingUrl=this.protocol+"//t.teads.tv/track",this.userSyncUrl=this.protocol+"//sync.teads.tv/iframe",this.wigoIframeUrl=this.protocol+"//sync.teads.tv/wigo-no-slot",this.consensuIframeUrl=this.protocol+"//cmp.teads.mgr.consensu.org/index.html",this.isSumologicLogsEnabled=!0,this.isRichAdServerRequestEnabled=!0,this.isQA=!1,this.richAdServerRequestTimeout=5e3,this.timestampMacroNames=["[RANDOM]","[RANDOMNUM]","[TIMESTAMP]","[CACHE_BREAKER]","[CACHEBREAKER]","[CACHEBUSTING]","[CACHE_BUSTING]","[CACHEBUSTER]","[CACHE_BUSTER]"],this.refresh(e)}refresh(e={}){n.b.fromNullable(e.ASSETS_URL).forEach(e=>{this.basePathUrl=e,this.assetsUrl=e+"/assets"}),n.b.fromNullable(e.FORMAT_WITH_PLAYER_URL).forEach(e=>this.formatPlayerAssetUrl=e),n.b.fromNullable(e.RAS_URL).forEach(e=>this.richAdServerUrl=e),n.b.fromNullable(e.BE_URL).forEach(e=>this.buyingEngineUrl=e),n.b.fromNullable(e.TRACKING_URL).forEach(e=>this.trackingUrl=e),n.b.fromNullable(e.USER_SYNC_URL).forEach(e=>this.userSyncUrl=e),n.b.fromNullable(e.WIGO_IFRAME_URL).forEach(e=>this.wigoIframeUrl=e),n.b.fromNullable(e.SUMOLOGIC_ENABLED).forEach(e=>this.isSumologicLogsEnabled=e),n.b.fromNullable(e.WITH_RAS_REQUEST).forEach(e=>this.isRichAdServerRequestEnabled=e),n.b.fromNullable(e.IS_QA).forEach(e=>this.isQA=e),n.b.fromNullable(e.TEADS_CONSENSU_URL).forEach(e=>this.consensuIframeUrl=e)}}const r=new s(window.teads)},function(e,t,i){i.d(t,"a",(function(){return s}));var n=i(4);class s extends n.a{}s.FullscreenRequest="FullscreenRequest",s.PlayPauseRequest="PlayPauseRequest",s.SkipRequest="SkipRequest",s.UIButtonRequest="UIButtonRequest",s.ClickToPlayRequest="ClickToPlayRequest",s.ClickRequest="ClickRequest",s.CallRequest="CallRequest",s.SoundToggleRequest="SoundToggleRequest",s.ReplayRequest="ReplayRequest",s.EndscreenInit="EndscreenInit",s.CollapseRequest="CollapseRequest",s.AdChoicesClickRequest="AdChoicesClickRequest",s.EarlyClickRequest="EarlyClickRequest"},function(e,t,i){i.d(t,"a",(function(){return s}));var n=i(9);class s{constructor(){this.loggerED=new n.a("canvas.player.components.EventDispatcher"),this.cb={},this.addEventListener=this.listen,this.removeEventListener=this.muteEvent}listen(e,t,i=!1){this.cb[e]||(this.cb[e]=new Array),this.cb[e].push(t)}muteEvent(e,t){this.cb[e]?t&&-1!==this.cb[e].indexOf(t)?this.cb[e].splice(this.cb[e].indexOf(t),1):t?this.loggerED.error("call muteEvent for",e,"but handler ",t," does not exist for this event"):this.cb[e]=new Array:this.loggerED.error("call muteEvent for",e,"but handlers for this event are empty")}dispatch(e,t){this.cb[e]&&(t?t.type=e:t={type:e},this.cb[e].forEach((function(e,i){e(t)})))}dispatchEvent(e){return this.loggerED.debug("dispatchEvent method is not implemented",e),!0}}},function(e,t,i){var n=i(16);t.a=function(e){const t=e.length;return function i(...s){return s.length<t?Object(n.a)(i,null,...s):e.call(null,...s)}}},function(e,t,i){i.d(t,"a",(function(){return n}));class n{}n.AdVideoMetadata="AdVideoMetadata",n.AdRemovedHeavyAdIntervention="AdRemovedHeavyAdIntervention",n.AdWarningHeavyAdIntervention="AdWarningHeavyAdIntervention"},function(e,t,i){i.d(t,"k",(function(){return f})),i.d(t,"a",(function(){return A})),i.d(t,"f",(function(){return y})),i.d(t,"d",(function(){return w})),i.d(t,"j",(function(){return E})),i.d(t,"b",(function(){return O})),i.d(t,"i",(function(){return C})),i.d(t,"c",(function(){return I})),i.d(t,"h",(function(){return S})),i.d(t,"g",(function(){return T})),i.d(t,"e",(function(){return k}));var n=i(1),s=i(0),r=i(8),a=i(12),o=i(2),d=i(67);const c=["[","]"],l=["${","}"],h=e=>({type:"StaticPatternBit",pattern:e}),u=e=>({ignoreCase:!1,supportMultipleOccurrences:!1,supportUriEncoded:!1,patternBits:[h(e)],delimiters:[c]}),p={CacheBusting:u("CACHEBUSTING"),ImpressionId:u("impressionId"),ContentPlayHead:u("CONTENTPLAYHEAD"),ErrorCode:u("ERRORCODE"),AssetUri:u("ASSETURI"),MediaFileType:u("MEDIAFILETYPE"),Viewability:u("VIEWABILITY"),BundleId:u("BUNDLEID"),DeviceId:u("DEVICEID"),LimitTracking:u("LIMIT_TRACKING"),StudioCid:u("STUDIO_CID"),SlotType:u("slotType"),DebugFormat:u("DEBUG_FORMAT"),Gdpr:{ignoreCase:!0,supportMultipleOccurrences:!0,supportUriEncoded:!0,patternBits:[h("GDPR")],delimiters:[c,l]},GdprConsent:{ignoreCase:!0,supportMultipleOccurrences:!0,supportUriEncoded:!0,patternBits:[h("GDPR_CONSENT")],delimiters:[c,l]},GdprConsentWithVendorId:{ignoreCase:!0,supportMultipleOccurrences:!0,supportUriEncoded:!0,patternBits:[h("GDPR_CONSENT_"),(g="\\d+",{type:"DynamicPatternBit",pattern:g})],delimiters:[l]}};var g;const m=e=>t=>Object(r.b)(t,n.cArray.map(({type:t,pattern:i})=>{switch(t){case"StaticPatternBit":return e(i);default:return i}}),e=>e.join("")),b=e=>e.replace(/[[\]{}$]/g,"\\$&"),f=(e,t)=>[e,t],v=(e,[t,i])=>e.replace((({ignoreCase:e,supportMultipleOccurrences:t,delimiters:i,supportUriEncoded:s,patternBits:a})=>{const d=`${e?"i":""}${t?"g":""}`,c=Object(r.b)(i,n.cArray.foldLeft([],(e,[t,i])=>{const n=[h(t),...a,h(i)];return[...e,m(o.identity)(n)].concat(s?[m(encodeURIComponent)(n)]:[])}),n.cArray.map(e=>`(${e})`),e=>e.join("|"),b);return new RegExp(c,d)})(p[t]),i),A=e=>t=>Object(r.b)(e,n.cArray.foldLeft(t,v)),y=()=>[w(0),I(),O(s.a),C(s.a),E(0)],w=e=>{const t=e>0?Object(o.offset)(e):"0";return f("ContentPlayHead",t)},E=e=>f("Viewability",String(e)),O=e=>Object(r.b)(e,s.d.map(e=>e.url.toString()),s.d.fold(()=>"",encodeURIComponent),e=>f("AssetUri",e)),C=e=>Object(r.b)(e,s.d.map(e=>e.type),s.d.fold(()=>"unknown",o.getExtensionFromMimeType),e=>f("MediaFileType",e)),I=(e=Object(a.rand)(8))=>f("CacheBusting",e),S=e=>{const t=Object(d.a)(e);return f("Gdpr",Object(d.b)(t))},T=e=>[f("GdprConsent",e),f("GdprConsentWithVendorId",e)],k=e=>f("DebugFormat","[new|"+e.options.getFullContext()+"]")},function(e,t,i){i.d(t,"x",(function(){return S})),i.d(t,"n",(function(){return T})),i.d(t,"a",(function(){return k})),i.d(t,"l",(function(){return x})),i.d(t,"t",(function(){return V})),i.d(t,"q",(function(){return N})),i.d(t,"u",(function(){return D})),i.d(t,"o",(function(){return _})),i.d(t,"r",(function(){return R})),i.d(t,"y",(function(){return M})),i.d(t,"v",(function(){return F})),i.d(t,"s",(function(){return U})),i.d(t,"i",(function(){return B})),i.d(t,"b",(function(){return W})),i.d(t,"j",(function(){return H})),i.d(t,"d",(function(){return z})),i.d(t,"f",(function(){return G})),i.d(t,"p",(function(){return q})),i.d(t,"h",(function(){return K})),i.d(t,"e",(function(){return $})),i.d(t,"g",(function(){return Y})),i.d(t,"c",(function(){return X})),i.d(t,"m",(function(){return Q})),i.d(t,"w",(function(){return J})),i.d(t,"k",(function(){return Z}));var n=i(1),s=i(3),r=i(22),a=i(85),o=i(66),d=i(0),c=i(8),l=(i(25),i(12)),h=i(15),u=i(2),p=i(76),g=i(28),m=i(26),b=i(33),f=i(24),v=i(19),A=i(36),y=i(44),w=i(20),E=i(5);const O=({pageId:e,placementId:t,auctionId:i,sumologicLogger:n},r,o)=>{const c={baseUrl:g.b.trackingUrl,referer:k(n),queryParameters:{env:s.getEnv(),auctid:i.getOrValue(Object(a.b)("")),pageId:e.toString(),pid:t.toString()}};return Object.assign(Object.assign({},c),{queryParameters:Object.assign(Object.assign({},c.queryParameters),r),trackingUrl:d.a})},C=({pageId:e,placementId:t,auctionId:i,viewerId:n,hbProvider:r,sumologicLogger:c},l,h)=>{const u={baseUrl:g.b.trackingUrl,referer:k(c),queryParameters:{env:s.getEnv(),auctid:i.getOrValue(Object(a.b)("")),pageId:e.toString(),pid:t.toString(),hb_provider:r,vid:n.getOrValue(Object(o.b)(""))}};return Object.assign(Object.assign({},u),{queryParameters:Object.assign(Object.assign({},u.queryParameters),l),trackingUrl:d.a})},I=({sumologicLogger:e,wigo:t,logger:i,placementKey:s})=>(r,a,o)=>Object(c.b)(o(r),Object(u.tap)(r=>Object(c.b)(w.b.format.getNewTrackedEvents(r),n.cArray.forEach(Object(c.a)(Object(u.tap)(e=>i.info(`[${s}][${a}] ${e}`,r[1])),Object(u.tap)(P(e)),j(t)))))),S=({placementKey:e,sumologicLogger:t,wigo:i,logger:s,durationPlayed:r,totalDuration:a})=>(o,d)=>Object(c.b)(d(o),([o,d])=>{const l=w.b.vast.getNewTrackedVastEvents(o),g=w.b.vast.getNewTrackedVastEvents(d);return Object(n.forEach)(w.b.vast.trackedEventsToEventsWithTrackingUrls(g),({event:e,trackingUrls:i})=>{Object(n.forEach)(i,i=>{const n=E.a.tryCatch(()=>Object(h.p)(i).hostname).getOrValue("<invalid>");e===v.a.Billable?t.info(`3p-billable-track ${e} ${n}`,5):t.info(`3p-vast-track ${e} ${n}`,1e3)})}),Object(c.b)([...l,...g],w.b.vast.trackedEventsToEventsWithTrackingUrls,n.cArray.forEach(Object(c.a)(Object(u.tap)(({event:t,trackingUrls:i})=>s.info(`[${e}][vast] ${t}`,i)),Object(p.c)({wigo:i,durationPlayed:r,totalDuration:a}))))}),T=({placementKey:e,sumologicLogger:t,wigo:i,logger:s,durationPlayed:r,totalDuration:a})=>(o,d)=>Object(c.b)(d(),([d,l])=>{t.error("vast-error "+o),Object(c.b)([...w.b.vast.getNewTrackedVastEvents(d),...w.b.vast.getNewTrackedVastEvents(l)],w.b.vast.trackedEventsToEventsWithTrackingUrls,n.cArray.forEach(Object(c.a)(Object(u.tap)(({event:t,trackingUrls:i})=>s.info(`[${e}][vast] ${t} ${o}`,i)),Object(p.c)({wigo:i,durationPlayed:r,totalDuration:a}))))}),k=Object(c.a)(h.f,d.d.flatMap(Object(c.a)(Object(u.prop)("windowReferrerUrl"),d.b.fromNullable)),d.d.getOrValue("")),j=e=>t=>{(Object(n.isMemberOf)([f.a.AdNotAvailableNetworkError,f.a.AdNotAvailableServerError,f.a.AdAvailableErrorParseTimeout,f.a.AdAvailableErrorSettings,f.a.AdAvailableErrorBadResponse,f.a.AdAvailableErrorSameAd,f.a.NoAdIvtDoubleVerify,f.a.NoAdIvtTag,f.a.NoAdBlockedSiteDoubleVerify,f.a.NoAdBlockedSiteTeads])(t)||Object(f.f)(t)||Object(f.g)(t))&&(e.valid(1,2,t,"error"),e.valid(1,1,t,"error"))},P=e=>Object(c.a)(L,d.d.map(e=>m.e[e]),d.d.forEach(t=>e.info(t,40))),L=e=>Object(c.b)(d.b.fromPredicate(e,Object(n.isMemberOf)([f.a.PlacementCall,f.a.SlotAvailable,f.a.AdReceived,f.a.AdAvailableSuccess,f.a.AdCall,f.a.ErrorBeforeAdReached,f.a.AdReached])),d.d.orElse(()=>/^noSlot-/.test(e)?d.b.of("noSlot"):d.a),d.d.orElse(()=>/^incompatibility-/.test(e)?d.b.of("incompatibility"):d.a),d.d.orElse(()=>/^adNotAvailable-/.test(e)?d.b.of("adNotAvailable"):d.a),d.d.orElse(()=>/^adAvailable-error-/.test(e)?d.b.of("adAvailable-error"):d.a),d.d.orElse(()=>/^noAd-/.test(e)?d.b.of("noAd"):d.a)),x=({placementKey:e,gdprStatus:t,gdprConsent:i})=>{w.b.format.thirdParty(e)("comscore",{trackingUrl:Object(y.i)(d.b.fromNullable(m.a.V2[window.location.protocol]).getOrElse(()=>m.a.V2["https:"])),macros:[Object(b.k)("ImpressionId",Object(r.a)().toString()),Object(b.k)("CacheBusting",Object(l.rand)(8))],gdprStatus:t,gdprConsent:i})},V=({pageId:e,placementId:t,placementKey:i,sumologicLogger:n,logger:s,wigo:r,auctionId:a,randomString:o})=>I({sumologicLogger:n,wigo:r,logger:s,placementKey:i})(f.a.PlacementCall,"classic",s=>w.b.format.classic.track(i)(s,O({pageId:e,placementId:t,auctionId:a,sumologicLogger:n},{debug_metadata:o}))),N=({pageId:e,placementId:t,placementKey:i,sumologicLogger:n,logger:s,wigo:r,auctionId:a,viewerId:o,headerBiddingProvider:l})=>Object(c.b)(l,d.d.fold(()=>I({sumologicLogger:n,wigo:r,logger:s,placementKey:i})(f.a.IncompatibilityFormat,"classic",s=>w.b.format.classic.track(i)(s,O({pageId:e,placementId:t,auctionId:a,sumologicLogger:n},{slot:"native"}))),d=>I({sumologicLogger:n,wigo:r,logger:s,placementKey:i})(f.a.IncompatibilityFormat,"header-bidding",s=>w.b.format.headerBidding.track(i)(s,C({pageId:e,placementId:t,auctionId:a,sumologicLogger:n,hbProvider:d,viewerId:o},{slot:"native",pfid:""}))))),D=({pageId:e,placementId:t,placementKey:i,sumologicLogger:n,logger:s,wigo:r,auctionId:a,viewerId:o,headerBiddingProvider:l},h)=>Object(c.b)(l,d.d.fold(()=>I({sumologicLogger:n,wigo:r,logger:s,placementKey:i})(h,"classic",s=>w.b.format.classic.track(i)(s,O({pageId:e,placementId:t,auctionId:a,sumologicLogger:n},{slot:"native"}))),d=>I({sumologicLogger:n,wigo:r,logger:s,placementKey:i})(h,"header-bidding",s=>w.b.format.headerBidding.track(i)(s,C({pageId:e,placementId:t,auctionId:a,sumologicLogger:n,hbProvider:d,viewerId:o},{slot:"native",pfid:""}))))),_=({pageId:e,placementId:t,placementKey:i,sumologicLogger:n,logger:s,wigo:r,auctionId:a,viewerId:o,headerBiddingProvider:l})=>Object(c.b)(l,d.d.fold(()=>I({sumologicLogger:n,wigo:r,logger:s,placementKey:i})(f.a.FallbackIntegration,"classic",s=>w.b.format.classic.track(i)(s,O({pageId:e,placementId:t,auctionId:a,sumologicLogger:n},{slot:"native"}))),d=>I({sumologicLogger:n,wigo:r,logger:s,placementKey:i})(f.a.FallbackIntegration,"header-bidding",s=>w.b.format.headerBidding.track(i)(s,C({pageId:e,placementId:t,auctionId:a,sumologicLogger:n,hbProvider:d,viewerId:o},{slot:"native",pfid:""}))))),R=({placementKey:e,sumologicLogger:t,wigo:i,logger:n,headerBiddingProvider:s,viewerId:r,pageId:a,placementId:l,auctionId:h})=>{const u={sumologicLogger:t,wigo:i,logger:n,placementKey:e};Object(c.b)(s,d.d.fold(()=>I(u)(f.a.LimitedCapabilities,"classic",e=>w.b.format.classic.track(u.placementKey)(e,O({pageId:a,placementId:l,auctionId:h,sumologicLogger:t},{vid:r.getOrValue(Object(o.b)(""))}))),e=>I(u)(f.a.LimitedCapabilities,"header-bidding",i=>w.b.format.headerBidding.track(u.placementKey)(i,C({pageId:a,placementId:l,auctionId:h,sumologicLogger:t,hbProvider:e,viewerId:r},{pfid:""})))))},M=e=>({headerBiddingProvider:t,pageId:i,placementId:n,slotType:s,auctionId:r,viewerId:a,insertionId:l,connectionId:h,portfolioItemId:u,scenarioId:p,adSourceId:g,errorCause:m,creativeId:b,dspCampaignId:v,dspCreativeId:y,studioCreativeId:E})=>{const S={slot:s,gid:Object(A.a)(l),sid:Object(A.a)(h),pfid:Object(A.a)(u),scid:Object(A.a)(p),ad_source_id:Object(A.a)(g),error_cause:m,cid:b,dsp_campaign_id:null!=v?v:"",dsp_creative_id:null!=y?y:"",studio_cid:E.getOrValue("")};Object(c.b)(t,d.d.fold(()=>I(e)(f.a.Warning,"classic",t=>w.b.format.classic.track(e.placementKey)(t,O({pageId:i,placementId:n,auctionId:r,sumologicLogger:e.sumologicLogger},Object.assign(Object.assign({},S),{vid:a.getOrValue(Object(o.b)(""))})))),t=>I(e)(f.a.Warning,"header-bidding",s=>w.b.format.headerBidding.track(e.placementKey)(s,C({pageId:i,placementId:n,auctionId:r,sumologicLogger:e.sumologicLogger,hbProvider:t,viewerId:a},S)))))},F=({pageId:e,placementId:t,placementKey:i,sumologicLogger:n,logger:s,wigo:r,auctionId:a,viewerId:o,slotType:l,headerBiddingProvider:h,hbSlotAvailableUrl:p})=>Object(c.b)(h,d.d.fold(()=>I({sumologicLogger:n,wigo:r,logger:s,placementKey:i})(f.a.SlotAvailable,"classic",s=>w.b.format.classic.track(i)(s,O({pageId:e,placementId:t,auctionId:a,sumologicLogger:n},{slot:l}))),h=>{const g=p.map(e=>Object(y.d)(e)),m=C({pageId:e,placementId:t,auctionId:a,sumologicLogger:n,hbProvider:h,viewerId:o},Object.assign({slot:l,pfid:""},Object(c.b)(g,d.d.map(Object(u.prop)("queryParameters")),d.d.getOrValue({}))),f.a.HbSlotAvailable),b=Object.assign(Object.assign({},m),{baseUrl:Object(c.b)(g,d.d.map(Object(u.prop)("baseUrl")),d.d.getOrValue(m.baseUrl))});I({sumologicLogger:n,wigo:r,logger:s,placementKey:i})(f.a.HbSlotAvailable,"header-bidding",e=>w.b.format.headerBidding.track(i)(e,b))})),U=({pageId:e,placementId:t,placementKey:i,sumologicLogger:n,logger:s,wigo:r,auctionId:a,viewerId:o,headerBiddingProvider:l},h)=>Object(c.b)(l,d.d.fold(()=>I({sumologicLogger:n,wigo:r,logger:s,placementKey:i})(h,"classic",s=>w.b.format.classic.track(i)(s,O({pageId:e,placementId:t,auctionId:a,sumologicLogger:n},{}))),d=>I({sumologicLogger:n,wigo:r,logger:s,placementKey:i})(h,"header-bidding",s=>w.b.format.headerBidding.track(i)(s===f.a.NoSlotSelector?f.a.HbNoSlotSelector:s,C({pageId:e,placementId:t,auctionId:a,sumologicLogger:n,hbProvider:d,viewerId:o},{pfid:""}))))),B=e=>({placementKey:t,sumologicLogger:i,wigo:n,logger:s,queryParameters:r})=>I({sumologicLogger:i,wigo:n,logger:s,placementKey:t})(e,"classic",e=>w.b.format.classic.track(t)(e,{baseUrl:g.b.trackingUrl,referer:k(i),queryParameters:r,trackingUrl:d.a})),W=({placementKey:e,sumologicLogger:t,wigo:i,logger:n,queryParameters:s})=>I({sumologicLogger:t,wigo:i,logger:n,placementKey:e})(f.a.AdAvailableErrorBadResponse,"classic",i=>w.b.format.classic.track(e)(i,{baseUrl:g.b.trackingUrl,referer:k(t),queryParameters:s,trackingUrl:d.a})),H=({placement:{key:e,pageId:t,pid:i,slotType:n,wigo:s},sumologicLogger:r,logger:a,auctionId:l,viewerId:h,headerBiddingProvider:u,portfolioItemId:p})=>{const g={sumologicLogger:r,wigo:s,logger:a,placementKey:e},m=Object(A.b)(p);Object(c.b)(u,d.d.fold(()=>I(g)(f.a.AdReceived,"classic",s=>w.b.format.classic.track(e)(s,O({pageId:t,placementId:i,auctionId:l,sumologicLogger:r},{slot:n,vid:h.getOrValue(Object(o.b)("")),pfid:m}))),s=>I(g)(f.a.AdReceived,"header-bidding",a=>w.b.format.headerBidding.track(e)(a,C({pageId:t,placementId:i,auctionId:l,sumologicLogger:r,hbProvider:s,viewerId:h},{slot:n,pfid:m})))))},z=({placement:{key:e,pageId:t,pid:i,slotType:n,wigo:s},sumologicLogger:r,logger:a,auctionId:l,viewerId:h,headerBiddingProvider:u,portfolioItemId:p,insertionId:g,connectionId:m})=>{const b={sumologicLogger:r,wigo:s,logger:a,placementKey:e},v=Object(A.b)(p),y=Object(A.b)(g),E=Object(A.b)(m);Object(c.b)(u,d.d.fold(()=>I(b)(f.a.AdAvailableErrorSettings,"classic",s=>w.b.format.classic.track(e)(s,O({pageId:t,placementId:i,auctionId:l,sumologicLogger:r},{slot:n,vid:h.getOrValue(Object(o.b)("")),pfid:v,gid:y,sid:E}))),s=>I(b)(f.a.AdAvailableErrorSettings,"header-bidding",a=>w.b.format.headerBidding.track(e)(a,C({pageId:t,placementId:i,auctionId:l,sumologicLogger:r,hbProvider:s,viewerId:h},{slot:n,pfid:v,gid:y,sid:E})))))},G=({placementKey:e,sumologicLogger:t,wigo:i,logger:n,headerBiddingProvider:s,pageId:r,placementId:a,slotType:l,auctionId:h,viewerId:u,insertionId:p,connectionId:g,portfolioItemId:m})=>{const b={sumologicLogger:t,wigo:i,logger:n,placementKey:e},v="0"===p?"":p;Object(c.b)(s,d.d.fold(()=>I(b)(f.a.AdAvailableErrorParseTimeout,"classic",e=>w.b.format.classic.track(b.placementKey)(e,O({pageId:r,placementId:a,auctionId:h,sumologicLogger:t},{slot:l,vid:u.getOrValue(Object(o.b)("")),gid:v,sid:g,pfid:m}))),e=>I(b)(f.a.AdAvailableErrorParseTimeout,"header-bidding",i=>w.b.format.headerBidding.track(b.placementKey)(i,C({pageId:r,placementId:a,auctionId:h,sumologicLogger:t,hbProvider:e,viewerId:u},{slot:l,pfid:m,gid:v,sid:g})))))},q=({placementKey:e,sumologicLogger:t,wigo:i,logger:n,headerBiddingProvider:s,pageId:r,placementId:a,slotType:l,portfolioItemId:h,auctionId:u,viewerId:p})=>{Object(c.b)(s,d.d.fold(()=>I({sumologicLogger:t,wigo:i,logger:n,placementKey:e})(f.a.FallbackNoAd,"classic",i=>w.b.format.classic.track(e)(i,O({pageId:r,placementId:a,auctionId:u,sumologicLogger:t},{slot:l,vid:p.getOrValue(Object(o.b)("")),pfid:Object(A.b)(h)}))),s=>I({sumologicLogger:t,wigo:i,logger:n,placementKey:e})(f.a.FallbackNoAd,"header-bidding",i=>w.b.format.headerBidding.track(e)(i,C({pageId:r,placementId:a,auctionId:u,sumologicLogger:t,hbProvider:s,viewerId:p},{slot:l,pfid:Object(A.b)(h)})))))},K=({placementKey:e,sumologicLogger:t,wigo:i,logger:n,headerBiddingProvider:s,baseUrlWithQueryParameters:r})=>{const a={sumologicLogger:t,wigo:i,logger:n,placementKey:e},o=Object.assign(Object.assign({},r),{referer:k(a.sumologicLogger)});Object(c.b)(s,d.d.fold(()=>I(a)(f.a.AdCall,"classic",e=>w.b.format.classic.track(a.placementKey)(e,o)),e=>I(a)(f.a.AdCall,"header-bidding",t=>w.b.format.headerBidding.track(a.placementKey)(t,Object.assign(Object.assign({},o),{queryParameters:Object.assign(Object.assign({},o.queryParameters),{hb_provider:e})})))))},$=({placementKey:e,sumologicLogger:t,wigo:i,logger:n,headerBiddingProvider:s,code:r,pageId:a,placementId:l,slotType:h,auctionId:u,viewerId:p,insertionId:g,connectionId:m,portfolioItemId:b})=>{const v={sumologicLogger:t,wigo:i,logger:n,placementKey:e},A="0"===g?"":g;Object(c.b)(s,d.d.fold(()=>I(v)(f.a.AdAvailableErrorVast,"classic",e=>w.b.format.classic.trackError(v.placementKey)(r,O({pageId:a,placementId:l,auctionId:u,sumologicLogger:t},{slot:h,vid:p.getOrValue(Object(o.b)("")),gid:A,sid:m,pfid:b}))),e=>I(v)(f.a.AdAvailableErrorVast,"header-bidding",i=>w.b.format.headerBidding.trackError(v.placementKey)(r,C({pageId:a,placementId:l,auctionId:u,sumologicLogger:t,hbProvider:e,viewerId:p},{slot:h,pfid:b,gid:A,sid:m})))))},Y=({sumologicLogger:e,logger:t,wigo:i,placementKey:n})=>({pageId:s,placementId:r,auctionId:a,viewerId:l,portfolioItemId:h,slotType:u,insertionId:p,connectionId:g,headerBiddingProvider:m})=>{const b=Object(A.b)(h),v=Object(A.b)(p),y=Object(A.b)(g);Object(c.b)(m,d.d.fold(()=>I({sumologicLogger:e,wigo:i,logger:t,placementKey:n})(f.a.AdAvailableSuccess,"classic",t=>w.b.format.classic.track(n)(t,O({pageId:s,placementId:r,auctionId:a,sumologicLogger:e},{slot:u,vid:l.getOrValue(Object(o.b)("")),pfid:b,gid:v,sid:y}))),o=>I({sumologicLogger:e,wigo:i,logger:t,placementKey:n})(f.a.AdAvailableSuccess,"header-bidding",t=>w.b.format.headerBidding.track(n)(t,C({pageId:s,placementId:r,auctionId:a,sumologicLogger:e,hbProvider:o,viewerId:l},{slot:u,pfid:b,gid:v,sid:y})))))},X=({sumologicLogger:e,logger:t,wigo:i,placementKey:n})=>({pageId:s,placementId:r,auctionId:a,viewerId:l,portfolioItemId:h,slotType:u,insertionId:p,connectionId:g,headerBiddingProvider:m})=>{const b=Object(A.b)(h),v=Object(A.b)(p),y=Object(A.b)(g);Object(c.b)(m,d.d.fold(()=>I({sumologicLogger:e,wigo:i,logger:t,placementKey:n})(f.a.AdAvailableErrorSameAd,"classic",t=>w.b.format.classic.track(n)(t,O({pageId:s,placementId:r,auctionId:a,sumologicLogger:e},{slot:u,vid:l.getOrValue(Object(o.b)("")),pfid:b,gid:v,sid:y}))),i=>{t.warn("Could not track adAvailable-error-sameAd, it should not be possible on Header-Bidding context",i),e.error("hb-samead "+i)}))},Q=e=>({headerBiddingProvider:t,pageId:i,placementId:n,slotType:s,auctionId:r,viewerId:a,insertionId:l,connectionId:h,portfolioItemId:u})=>{const p=a.getOrValue(Object(o.b)("")),g=Object(A.a)(u),m=Object(A.a)(l),b=Object(A.a)(h);Object(c.b)(t,d.d.fold(()=>I(e)(f.a.EarlyClick,"classic",t=>w.b.format.classic.track(e.placementKey)(t,O({auctionId:r,sumologicLogger:e.sumologicLogger,pageId:i,placementId:n},{slot:s,vid:p,pfid:g,gid:m,sid:b},f.a.EarlyClick))),t=>I(e)(f.a.EarlyClick,"header-bidding",o=>w.b.format.headerBidding.track(e.placementKey)(o,C({pageId:i,placementId:n,auctionId:r,sumologicLogger:e.sumologicLogger,hbProvider:t,viewerId:a},{slot:s,pfid:g,gid:m,sid:b})))))},J=e=>({headerBiddingProvider:t,pageId:i,placementId:n,slotType:s,auctionId:r,viewerId:a,insertionId:l,connectionId:h,portfolioItemId:u,notVisibleReason:p})=>{const g=Object(f.e)(p),m=a.getOrValue(Object(o.b)("")),b=Object(A.a)(u),v=Object(A.a)(l),y=Object(A.a)(h);Object(c.b)(t,d.d.fold(()=>I(e)(g,"classic",t=>w.b.format.classic.track(e.placementKey)(t,O({pageId:i,placementId:n,auctionId:r,sumologicLogger:e.sumologicLogger},{slot:s,vid:m,pfid:b,gid:v,sid:y}))),t=>I(e)(g,"header-bidding",o=>w.b.format.headerBidding.track(e.placementKey)(o,C({pageId:i,placementId:n,auctionId:r,sumologicLogger:e.sumologicLogger,hbProvider:t,viewerId:a},{slot:s,pfid:b,gid:v,sid:y})))))},Z=e=>({headerBiddingProvider:t,pageId:i,placementId:n,slotType:s,auctionId:r,viewerId:a,insertionId:l,connectionId:h,portfolioItemId:u})=>{const p=a.getOrValue(Object(o.b)("")),g=Object(A.a)(u),m=Object(A.a)(l),b=Object(A.a)(h);Object(c.b)(t,d.d.fold(()=>I(e)(f.a.ClickReplay,"classic",t=>w.b.format.classic.track(e.placementKey)(t,O({pageId:i,placementId:n,auctionId:r,sumologicLogger:e.sumologicLogger},{slot:s,vid:p,pfid:g,gid:m,sid:b}))),t=>I(e)(f.a.ClickReplay,"header-bidding",o=>w.b.format.headerBidding.track(e.placementKey)(o,C({pageId:i,placementId:n,auctionId:r,sumologicLogger:e.sumologicLogger,hbProvider:t,viewerId:a},{slot:s,pfid:g,gid:m,sid:b})))))}},function(e,t,i){i.d(t,"a",(function(){return n})),i.d(t,"d",(function(){return d})),i.d(t,"c",(function(){return c})),i.d(t,"b",(function(){return l}));var n,s=i(23),r=i(38),a=i(0),o=i(5);!function(e){e[e.Standard=0]="Standard",e[e.Worker=1]="Worker",e[e.Precise=2]="Precise"}(n||(n={}));function d(e,t,i=n.Standard,r=a.a){return o.a.tryCatch(()=>{if(i===n.Worker&&u()){const i=h(e,'self.setTimeout(function(){self.postMessage("tick")}, '+t+")");return{clear:()=>{i.terminate()}}}if(i===n.Precise){const i=s.l();let n,a=0;var r=()=>{const o=s.l()-i;o<t-(0===a?a:o/a)?(a+=1,n=l(r)):e()};return r(),{clear:()=>{var e;e=n,(window.cancelAnimationFrame||window.mozCancelAnimationFrame||clearTimeout)(e)}}}{const i=window.setTimeout(()=>{e()},t);return{clear:()=>{clearTimeout(i)}}}}).fold(e=>(r.forEach(t=>t.error("ccpa-error 3 "+e,1)),{clear:()=>{}}),e=>e)}function c(e,t,i=!1){if(i&&u()){const i=h(e,'self.setInterval(function(){self.postMessage("tick")}, '+t+")");return{clear:()=>{i.terminate()}}}{const i=window.setInterval(()=>{e()},t);return{clear:()=>{clearInterval(i)}}}}function l(e,t=1e3/60){const i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame;return i?i(e):window.setTimeout(e,t)}function h(e,t){const i=r.b(t),n=new Worker(r.c().map(e=>e.createObjectURL(i)).getOrValue(""));return n.onmessage=t=>e(),n}function u(){return!!window.Worker&&r.c().nonEmpty()}},function(e,t,i){i.d(t,"c",(function(){return l})),i.d(t,"d",(function(){return h})),i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return p})),i.d(t,"e",(function(){return g}));var n=i(1),s=i(0),r=i(8),a=i(15),o=i(55),d=i(44),c=i(24);const l=["f","ts","fv","action","referer","pageId","pid","auctid","env","pfid","gid","sid","vid","slot","gdpr_status","gdpr_consent","gdpr_reason","gdpr_api_version","gdpr_cmp_id","hb_provider","ad_source_id","error_cause","cid","dsp_campaign_id","dsp_creative_id","scid","studio_cid"],h=Object(r.b)(Object.keys(c.a),n.cArray.map(e=>c.a[e]),Object(n.exclude)(c.h),n.cArray.foldLeft([],(e,t)=>t===c.a.AdAvailableErrorVast?[...e,...Object(r.b)(o.b,n.cArray.map(e=>Object(c.b)([t,e])))]:[...e,t])),u=Object(r.a)(s.d.map(String),s.d.getOrValue("")),p=Object(r.a)(s.b.fromNullable,u),g=e=>t=>Object(s.c)(e).map(Object.keys).map(n.cArray.filter(e=>!t.match(new RegExp(e+"=[^&]")))).filter(n.isNotEmpty).match({none:()=>t,some:Object(r.a)(n.cArray.foldLeft(Object(d.d)(t),(t,i)=>Object.assign(Object.assign({},t),{queryParameters:Object.assign(Object.assign({},t.queryParameters),{[i]:e[i]})})),({baseUrl:e,queryParameters:t})=>Object(a.c)(e,t))})},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,"b",(function(){return stringify})),__webpack_require__.d(__webpack_exports__,"a",(function(){return parse}));var _ArrayHelper__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);const escMap={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"},escRE=/[\\"\u0000-\u001F\u2028\u2029]/g;function stringify(e,t=!1){const i=Array.prototype.toJSON;delete Array.prototype.toJSON;const n=jsonStringify(t?decycle(e):e);return i&&(Array.prototype.toJSON=i),n}function parse(sJSON){return window.JSON.parse?window.JSON.parse(sJSON):eval("("+sJSON+")")}function decycle(e,t){var i=[],n=[];return function e(s,r){var a,o;return void 0!==t&&(s=t(s)),"object"!=typeof s||null===s||s instanceof Boolean||s instanceof Date||s instanceof Number||s instanceof RegExp||s instanceof String?s:(a=Object(_ArrayHelper__WEBPACK_IMPORTED_MODULE_0__.indexOf)(i,s))>=0?{$ref:n[a]}:(i.push(s),n.push(r),Array.isArray(s)?(o=[],Object(_ArrayHelper__WEBPACK_IMPORTED_MODULE_0__.forEach)(s,(function(t,i){o[i]=e(t,r+"["+i+"]")}))):(o={},Object(_ArrayHelper__WEBPACK_IMPORTED_MODULE_0__.forEach)(Object.keys(s),(function(t){o[t]=e(s[t],r+"["+JSON.stringify(t)+"]")}))),o)}(e,"$")}function jsonStringify(e){return window.JSON.stringify&&'{"a":"b"}'===window.JSON.stringify({a:"b"})?window.JSON.stringify(e):polyfillStringify(e)}function polyfillStringify(e){if(null===e)return"null";if("number"==typeof e)return isFinite(Number(e))?e.toString():"null";if("boolean"==typeof e)return e.toString();if("object"==typeof e){if(Array.isArray(e)){let t="[";for(let i=0;i<e.length;i++)t+=(i?", ":"")+polyfillStringify(e[i]);return t+"]"}if("[object Object]"===Object.prototype.toString.call(e)){const t=[];for(const i in e)e.hasOwnProperty(i)&&t.push(polyfillStringify(i)+": "+polyfillStringify(e[i]));return"{"+t.join(", ")+"}"}}return'"'+e.toString().replace(escRE,escFunc)+'"'}const escFunc=e=>escMap[e]||"\\u"+(e.charCodeAt(0)+65536).toString(16).substr(1)},function(e,t,i){i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return a})),i.d(t,"c",(function(){return o}));var n=i(0),s=i(2);function r(e,t="application/javascript"){if(window.Blob)try{return new Blob([e],{type:t})}catch(e){}window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;let i=new window.BlobBuilder;return i.append(e),i.getBlob()}function a(){return Object(s.isFunction)(window.Blob)&&Object(s.isNative)(window.Blob)}function o(){return d(window.URL).orElse(()=>d(window.webkitURL))}function d(e){return n.b.fromNullable(e).filter(e=>Object(s.hasOwnProperty)(e,"createObjectURL")&&Object(s.isNative)(e.createObjectURL))}},function(e,t,i){i.d(t,"a",(function(){return o})),i.d(t,"d",(function(){return d})),i.d(t,"c",(function(){return c})),i.d(t,"b",(function(){return l}));var n=i(1);const s=new(i(9).a)("Dom"),r=["scroll","touchstart","touchmove"];function a(e){return Object(n.includes)(r,e)}function o(e,t,i){try{t.addEventListener(e,i,{passive:a(e),capture:!0})}catch(n){s.warn(`Failed to add listener for event ${e}, fallback to Boolean form`,t,n),t.addEventListener(e,i,!0)}}function d(e,t,i){try{t.removeEventListener(e,i,!0)}catch(i){s.warn("Failed to remove listener for event "+e,t,i)}}function c(e,t){const i=t.document,n=()=>{"interactive"!==i.readyState&&"complete"!==i.readyState||(d("readystatechange",i,n),e())};"interactive"===i.readyState||"complete"===i.readyState?e():o("readystatechange",i,n)}function l(e,t,i){"complete"===t.document.readyState?e.call(i):o("load",t,e.bind(i))}},function(e,t,i){let n,s;function r(){if(n)return n();let e=null;if(window.XMLHttpRequest&&(e=new XMLHttpRequest),e&&!("withCredentials"in e)&&(e=window.XDomainRequest?new window.XDomainRequest:null),!e){try{e=new window.ActiveXObject("MSXML2.XMLHTTP.6.0")}catch(t){try{e=new window.ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){throw new Error("could not create XMLHttpRequest nor ActiveXObject")}}e.responseType="msxml-document"}return e}function a(e){return s?s(e):e instanceof XMLHttpRequest}function o(e,t){n=e,s=t}i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return o}))},function(e,t,i){i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return o}));var n=i(103);const s=Object&&Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window||!!window.ActiveXObject;function r(e,t){var i;if(s){try{i=new ActiveXObject("Msxml2.DOMDocument.6.0"),n.a.debug("XML Parser - ActiveXObject - Msxml2.DOMDocument.6.0")}catch(e){try{i=new ActiveXObject("Msxml2.DOMDocument.3.0"),n.a.debug("XML Parser - ActiveXObject - Msxml2.DOMDocument.3.0")}catch(e){i=new ActiveXObject("Microsoft.XMLDOM"),n.a.debug("XML Parser - ActiveXObject - Microsoft.XMLDOM")}}i.async=!1,i.loadXML(e)}else if(window.DOMParser){i=(new DOMParser).parseFromString(e,"text/xml")}else t.error("vast-parser no-xml-found");return i}function a(e){if(e)try{var t=function(e){let t=e.firstChild;for(;t;){if(!d(t))return t;t=t.nextSibling}return null}(e);return t?function(e){let t=(e.textContent?e.textContent:e.text).replace(/[\t\n\r ]+/g," ");" "===t.charAt(0)&&(t=t.substring(1,t.length));" "===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1));return t}(t):""}catch(t){n.a.error(`Couldn't get content for node ${e.nodeName}: "${t}"`)}}function o(e,t){try{if(e.attributes[t])return String(e.attributes[t].value);for(var i=0;i<e.attributes.length;i++)if(e.attributes[i].name===t)return String(e.attributes[i].value)}catch(e){n.a.error(`Couldn't get attribute value: "${e}"`)}}function d(e){return 8===e.nodeType||3===e.nodeType&&function(e){return!/[^\t\n\r ]/.test(e.textContent?e.textContent:e.text)}(e)}},function(e,t,i){i.d(t,"a",(function(){return m})),i.d(t,"b",(function(){return b}));var n=i(3),s=i(50),r=i(10),a=i(21),o=i(0),d=i(2),c=i(7),l=i(30),h=i(97),u=i(98),p=i(99),g=i(100),m=m||{};class b extends l.a{constructor(e,t,i,l){super(),this.meta=t,this.player=l;const m=Object(r.findTopWindow)(document.body),b=m===window.top,f=(Object(n.isSafari)()||Object(n.isFacebookWebview)())&&a.a(Object(n.getIosVersion)(),"10");this.sumologic=s.a.copy({collectorUrl:"https://s8t.teads.tv/logs/player/http-source",placementId:o.b.fromNullable(this.player.parameters.pid).map(e=>parseInt(e,10)).filter(d.isNumber)}),b&&this.meta.mp4&&("HTML5"===this.player.parameters.type||Object(n.isIpad)()&&a.a(Object(n.getIosVersion)(),"9.2")&&"CANVAS"!==this.player.parameters.type)?(this.api=new p.a(e,t,l,m),this.sumologic.info("canvas video mp4")):b&&this.meta.mp4&&"CANVAS"!==this.player.parameters.type&&(a.b(Object(n.getIosVersion)(),"9.1")&&a.d(Object(n.getIosVersion)(),"10")||f)?(this.api=new u.a(e,t,l,m),this.sumologic.info("canvas video mp4CT")):this.meta.tv?(this.api=new h.a(e,t,i,l),this.sumologic.info("canvas video tv")):(this.api=new g.a(e,t,i,l),this.sumologic.info("canvas video mpeg")),this.api.listen(c.a.CAN_PLAY,()=>this.dispatch(c.a.CAN_PLAY)),this.api.listen(c.a.LOADED,()=>this.dispatch(c.a.LOADED)),this.api.listen(c.a.STALLED,()=>this.dispatch(c.a.STALLED)),this.api.listen(c.a.RESUME_AFTER_STALLED,()=>this.dispatch(c.a.RESUME_AFTER_STALLED)),this.api.listen(c.a.TIME_UPDATE,()=>this.dispatch(c.a.TIME_UPDATE)),this.api.listen(c.a.ENDED,()=>this.dispatch(c.a.ENDED)),this.api.listen(c.a.BENCH_FPS,e=>this.dispatch(c.a.BENCH_FPS,e))}canplay(){return this.api.canplay()}play(){this.api.play()}pause(){this.api.pause()}getCurrentTime(){return this.api.getCurrentTime()}setCurrentTime(e){return this.api.setCurrentTime(e)}get duration(){return this.api.duration}get state(){return this.api.state}get videoFrames(){return this.api.videoFrames}get averageDecodingTime(){return this.api.averageDecodingTime}cleanStallTimeout(){this.api.cleanStallTimeout()}}},function(e,t,i){i.d(t,"a",(function(){return d})),i.d(t,"d",(function(){return c})),i.d(t,"e",(function(){return l})),i.d(t,"c",(function(){return h})),i.d(t,"b",(function(){return u}));var n=i(9),s=i(2),r=i(0);let a;const o=new n.a("IOSWindowHeight");function d(e){return Object(s.isUndefined)(a)&&(a=e.document.createElement("div"),a.style.setProperty("position","fixed"),a.style.setProperty("height","100vh"),a.style.setProperty("width","0"),a.style.setProperty("top","0")),a}function c(e){r.b.fromNullable(a).match({some:t=>e.document.documentElement.appendChild(t),none:()=>o.warn("Could not insert ruler to DOM as it was not created yet")})}function l(){r.b.fromNullable(a).match({some:e=>r.b.fromNullable(e.parentElement).forEach(t=>t.removeChild(e)),none:()=>o.warn("Could not remove ruler from DOM as it was not created yet")})}function h(e){return r.b.fromNullable(a).match({some:e=>e.offsetHeight,none:()=>(o.warn("Could not get ruler height value as it was not created yet, fallback to innerHeight"),e.innerHeight)})}function u(e){return Math.max(h(e)-e.innerHeight,0)}},function(e,t,i){i.d(t,"h",(function(){return c})),i.d(t,"j",(function(){return l})),i.d(t,"f",(function(){return h})),i.d(t,"i",(function(){return u})),i.d(t,"c",(function(){return p})),i.d(t,"g",(function(){return g})),i.d(t,"b",(function(){return m})),i.d(t,"a",(function(){return b})),i.d(t,"d",(function(){return f})),i.d(t,"e",(function(){return E}));var n=i(1),s=i(51),r=i(0),a=i(8),o=i(15),d=i(12);const c=e=>e,l=e=>e,h=e=>e,u=e=>e,p=e=>e,g=(e,t=r.a)=>{const i=f(p(e));return E(Object.assign(Object.assign({},i),{queryParameters:Object.assign(Object.assign(Object.assign({},i.queryParameters),{action:"debug-"+i.queryParameters.action}),t.map(e=>({debug_metadata:encodeURIComponent(e)})).getOrValue({}))}))},m=(e,t)=>({baseUrl:e,queryParameters:Object.assign(Object.assign({},t),{f:"1"})}),b=(e,t=r.a)=>E(Object.assign(Object.assign({},e),{queryParameters:Object.assign(Object.assign(Object.assign({},e.queryParameters),{action:"debug-"+e.queryParameters.action,f:"1"}),t.map(e=>({debug_metadata:e})).getOrValue({}))})),f=e=>{const t=o.p(e),i=Object(a.b)(t.search.substring(1).split("&"),n.cArray.filter(d.isNotEmpty),n.cArray.map(e=>e.split("=")),e=>Object(n.reduce)(e,(e,[t,i])=>Object.assign(Object.assign({},e),{[t]:decodeURIComponent(i)}),{}));return{baseUrl:`${t.protocol}//${t.host}${/^\//.test(t.pathname)?t.pathname:"/"+t.pathname}`,queryParameters:i}},v=["gdpr_api_version","gdpr_cmp_id","gdpr_consent"],A=e=>Object(n.filter)(Object.keys(e),t=>""!==e[t]||Object(n.isMemberOf)(v)(t)),y=e=>Object.keys(e),w=e=>e.sort((e,t)=>"action"===t?1:"action"===e||"referer"===t?-1:0);function E({baseUrl:e,queryParameters:t},i=y){return Object(a.a)(A,e=>s.b(t,t=>Object(n.includes)(e,t)),i,w,i=>{return`${s=e,/\?/.test(s)?s+"&":s+"?"}${Object(n.map)(i,e=>`${e}=${encodeURIComponent(t[e])}`).join("&")}`;var s})(t)}},function(e,t,i){i.r(t),i.d(t,"abort",(function(){return n})),i.d(t,"canplay",(function(){return s})),i.d(t,"canplaythrough",(function(){return r})),i.d(t,"durationchange",(function(){return a})),i.d(t,"emptied",(function(){return o})),i.d(t,"encrypted",(function(){return d})),i.d(t,"ended",(function(){return c})),i.d(t,"error",(function(){return l})),i.d(t,"interruptbegin",(function(){return h})),i.d(t,"interruptend",(function(){return u})),i.d(t,"loadeddata",(function(){return p})),i.d(t,"loadedmetadata",(function(){return g})),i.d(t,"loadstart",(function(){return m})),i.d(t,"pause",(function(){return b})),i.d(t,"play",(function(){return f})),i.d(t,"playing",(function(){return v})),i.d(t,"progress",(function(){return A})),i.d(t,"ratechange",(function(){return y})),i.d(t,"seeked",(function(){return w})),i.d(t,"seeking",(function(){return E})),i.d(t,"stalled",(function(){return O})),i.d(t,"suspend",(function(){return C})),i.d(t,"timeupdate",(function(){return I})),i.d(t,"volumechange",(function(){return S})),i.d(t,"waiting",(function(){return T}));const n="abort",s="canplay",r="canplaythrough",a="durationchange",o="emptied",d="encrypted",c="ended",l="error",h="interruptbegin",u="interruptend",p="loadeddata",g="loadedmetadata",m="loadstart",b="pause",f="play",v="playing",A="progress",y="ratechange",w="seeked",E="seeking",O="stalled",C="suspend",I="timeupdate",S="volumechange",T="waiting"},function(e,t,i){i.d(t,"a",(function(){return s}));var n=i(17);class s extends n.a{}s.INCOMPLETE_OBJECT={id:1,message:"Ad configuration is missing settings or placement"},s.OPTION_CHECKVALUE_MISSING={id:2,message:"checkValue function is missing"},s.OPTION_THRESHOLD_MISSING={id:3,message:"Option threshold is required"},s.OPTION_PARENTWINDOW_INVALID={id:4,message:"Option parentWindow is required"},s.OPTION_VAST_INVALID={id:5,message:"Option vast has to contain type and content"},s.MULTIPLE_PAGE_PROCESS={id:6,message:"Cannot process more than 1 page"},s.OPTION_PID_INVALID={id:7,message:"Option Pid must be a positive number"},s.OPTION_FORMAT_INVALID={id:8,message:"Option Format must be a known string"},s.LOADING_MEDIAFILE={id:9,message:"Error when loading mediafile"},s.RAS_REQUEST={id:10,message:"RAS request error"},s.RAS_TIMEOUT={id:11,message:"RAS request timeout"},s.RAS_CUSTOM_TIMEOUT={id:12,message:"RAS request custom timeout"},s.RAS_RESPONSE={id:13,message:"RAS response error"},s.RAS_RESPONSE_ADS_NOT_ARRAY={id:14,message:"RAS response ads is not an array"},s.EVENT_CALLBACK={id:15,message:"Callback threw an error"},s.FILTER_FUNCTION={id:16,message:"The filter function threw an error"},s.OPTION_NAME_REQUIRED={id:17,message:"Name must be a valid string"}},function(e,t,i){i.d(t,"a",(function(){return c}));var n=i(1),s=i(6),r=i(0),a=i(9),o=i(2);const d={addEventListener:s.addEventListener,removeEventListener:s.removeEventListener};class c extends class{constructor(e="EventListenerManager",t){this.adRemoveListenerStrategy=t,this.listeners={},this.logger=new a.a(e)}add(e,t,i){o.isString(e)||this.logger.warn("First argument of EventListenerManager.add must be a string",e),this.logger.debug("Add listener to event",e),r.b.fromNullable(this.listeners[e]).orElse(()=>r.b.fromNullable([])).map(e=>e.concat([{context:t,callback:i}])).forEach(t=>{this.listeners[e]=t}),this.addEventListener(e,t,i)}addMultiple(e,t,i){o.isArray(e)||this.logger.warn("First argument of EventListenerManager.addMultiple must be an array of strings",e),n.forEach(e,e=>this.add(e,t,i))}remove(e){o.isString(e)||this.logger.warn("First argument of EventListenerManager.add must be a string",e),this.logger.debug("Remove listener from event",e),n.forEach(this.listeners[e],t=>this.removeEventListener(e,t.context,t.callback)),this.listeners[e]=[]}removeMultiple(e){o.isArray(e)||this.logger.warn("First argument of EventListenerManager.addMultiple must be an array of strings",e),n.forEach(e,e=>this.remove(e))}removeAll(){for(const e in this.listeners)this.listeners.hasOwnProperty(e)&&n.forEach(this.listeners[e],t=>this.removeEventListener(e,t.context,t.callback))}addEventListener(e,t,i){this.adRemoveListenerStrategy.addEventListener(e,t,i)}removeEventListener(e,t,i){this.adRemoveListenerStrategy.removeEventListener(e,t,i)}}{constructor(e=d){super("DOMEventListenerManager",e)}}},function(e,t,i){i.d(t,"b",(function(){return b})),i.d(t,"e",(function(){return f})),i.d(t,"d",(function(){return v})),i.d(t,"c",(function(){return A})),i.d(t,"a",(function(){return y}));var n=i(74),s=i(31),r=i(0),a=i(8),o=i(5),d=i(9);const c=Math.random(),l="[context][businessIds][logLevel] message",h=new d.a("Sumologic"),u=Object(s.a)(({formatVersion:e,fullContext:t,bidType:i,headerBidding:n},s)=>s.replace("context",`${e}|${t}|${i}|${n?"hb":""}`)),p=Object(s.a)((e,t,i,n)=>{const s=e=>e.map(String).getOrValue("");return n.replace("businessIds",`${s(e)}|${s(i)}|${s(t)}`)}),g=Object(s.a)((e,t)=>t.replace("logLevel",e)),m=Object(s.a)((e,t)=>t.replace("message",e));function b(e,t){return e>0&&t<=1/e}function f(e,t){o.a.tryCatch(()=>{(new Image).src=`${e}?${encodeURIComponent(t)}`}).tapLeft(i=>{h.warn("An error occurred while sending log message to Sumologic collector",e,t,i)})}function v(){return c}class A{constructor(e,t,i,n,s){this.collectorUrl=e,this.samplingFactor=t,this.formatVersion=i,this.placementId=n,this.options=s}log(e,t=this.samplingFactor){b(t,this.options.getSamplingThreshold())?this.options.sendLog(this.collectorUrl,e):h.debug(`Did not send log to Sumologic collector (sampling too low, threshold: ${this.options.getSamplingThreshold().toFixed(2)})`,e)}metadata(e,t=this.samplingFactor){this.logBasedOnTemplate("metadata",e,t)}info(e,t=this.samplingFactor){this.logBasedOnTemplate("info",e,t)}warning(e,t=this.samplingFactor){this.logBasedOnTemplate("warning",e,t)}error(e,t=this.samplingFactor){this.logBasedOnTemplate("error",e,t)}generateLogFromTemplate(e,{fullContext:t,bidType:i,headerBidding:n},s){return Object(a.a)(u({fullContext:t,bidType:i,headerBidding:n,formatVersion:this.formatVersion}),p(this.placementId,r.a,r.a),g(e),m(s))(l)}logBasedOnTemplate(e,t,i=this.samplingFactor){this.log(this.generateLogFromTemplate(e,{fullContext:this.options.getFullContext(),bidType:"",headerBidding:this.options.isHeaderBiddingTag()},t),i)}copy(e={}){const{collectorUrl:t=this.collectorUrl,samplingFactor:i=this.samplingFactor,formatVersion:n=this.formatVersion,placementId:s=this.placementId,options:r=this.options}=e;return new A(t,i,n,s,r)}}class y extends A{constructor(e="",t,i,n){super(n.collectorUrl,n.samplingFactor,n.formatVersion,n.placementId,n.options),this.bidType=e,this.insertionId=t,this.connectionId=i}generateLogFromTemplate(e,{fullContext:t,bidType:i,headerBidding:n},s){return Object(a.a)(u({fullContext:t,bidType:i,headerBidding:n,formatVersion:this.formatVersion}),p(this.placementId,this.insertionId,this.connectionId),g(e),m(s))(l)}logBasedOnTemplate(e,t,i=this.samplingFactor){this.log(this.generateLogFromTemplate(e,{fullContext:this.options.getFullContext(),bidType:this.bidType,headerBidding:this.options.isHeaderBiddingTag()},t),i)}copy(e={}){const{bidType:t=this.bidType,insertionId:i=this.insertionId,connectionId:s=this.connectionId}=e,r=Object(n.b)(e,["bidType","insertionId","connectionId"]);return new y(t,i,s,super.copy(r))}}},function(e,t,i){i.r(t),i.d(t,"FormatEvent",(function(){return n.a})),i.d(t,"parseFraudReason",(function(){return n.l})),i.d(t,"getFormatEventFromSlotVisibilityReason",(function(){return n.e})),i.d(t,"formatEventToMirroredEvent",(function(){return n.c})),i.d(t,"formatEventsWithMirroringEvent",(function(){return n.d})),i.d(t,"nonErrorFormatEventsWithMirroringEvent",(function(){return n.i})),i.d(t,"mirroredFormatEvents",(function(){return n.h})),i.d(t,"nonErrorMirroredFormatEvents",(function(){return n.j})),i.d(t,"createFormatErrorAction",(function(){return n.b})),i.d(t,"parseFormatErrorAction",(function(){return n.k})),i.d(t,"matchesAdAvailableErrorVast",(function(){return n.f})),i.d(t,"matchesNoAdVastError",(function(){return n.g})),i.d(t,"VastEvent",(function(){return s.a})),i.d(t,"vastEvents",(function(){return s.b})),i.d(t,"VastErrorCode",(function(){return r.a})),i.d(t,"vastErrorCodes",(function(){return r.b})),i.d(t,"teadsVastUrl",(function(){return a.h})),i.d(t,"thirdPartyVastUrl",(function(){return a.j})),i.d(t,"teadsFormatUrl",(function(){return a.f})),i.d(t,"thirdPartyFormatUrl",(function(){return a.i})),i.d(t,"debugUrl",(function(){return a.c})),i.d(t,"teadsUrlToDebugUrl",(function(){return a.g})),i.d(t,"createTeadsParsedUrl",(function(){return a.b})),i.d(t,"createDebugTrackingUrl",(function(){return a.a})),i.d(t,"parseUrl",(function(){return a.d})),i.d(t,"stringifyParsedUrl",(function(){return a.e})),i.d(t,"supportedQueryParameterNames",(function(){return o.c})),i.d(t,"trackableFormatActions",(function(){return o.d})),i.d(t,"optNumberToString",(function(){return o.b})),i.d(t,"nullableNumberToString",(function(){return o.a})),i.d(t,"updateUrlWithQueryParametersIfMissing",(function(){return o.e}));var n=i(24),s=i(19),r=i(55),a=i(44),o=i(36)},function(e,t,i){var n=i(3),s=i(0),r=i(48),a=i(28);const o=new r.c("https://s8t.teads.tv/logs/format/http-source",a.b.isSumologicLogsEnabled?20:0,a.b.isQA?"HEAD#42bf10e66":"822",s.a,{getSamplingThreshold:r.d,sendLog:r.e,getFullContext:n.getFullContext,isHeaderBiddingTag:()=>!1});t.a=o},function(e,t,i){i.d(t,"c",(function(){return o})),i.d(t,"b",(function(){return d})),i.d(t,"a",(function(){return c}));var n=i(31),s=i(2),r=i(1),a=i(8);const o=Object(n.a)((e,t)=>{for(const i in t)t.hasOwnProperty(i)&&e(i,t[i])});function d(e,t){return Object(s.isObject)(e)?Object(a.b)(Object.keys(e),r.cArray.foldLeft({},(i,n)=>t(n,e[n])?Object.assign(Object.assign({},i),{[n]:e[n]}):i)):e}function c(e,t){return d(e,(e,i)=>t(i))}},function(e,t,i){i.d(t,"b",(function(){return n})),i.d(t,"d",(function(){return s})),i.d(t,"g",(function(){return r})),i.d(t,"h",(function(){return a})),i.d(t,"f",(function(){return o})),i.d(t,"c",(function(){return d})),i.d(t,"e",(function(){return c})),i.d(t,"a",(function(){return l}));let n=8e3;function s(e){n=e}const r=8e3,a=1e3,o=1e3;let d=1e4;function c(e){d=e}const l=500},function(e,t,i){var n;i.d(t,"a",(function(){return n})),function(e){e[e.CANVAS=0]="CANVAS",e[e.HTML5=1]="HTML5",e[e.ANY=2]="ANY"}(n||(n={}))},function(e,t,i){i.d(t,"a",(function(){return s}));i(22);var n=i(5);const s=e=>n.a.tryCatch(()=>document.cookie).map(t=>decodeURIComponent(t.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")))},function(e,t,i){i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return o}));var n,s=i(1),r=i(8),a=i(2);!function(e){e[e.XmlParsingError=100]="XmlParsingError",e[e.XmlInvalidSchema=101]="XmlInvalidSchema",e[e.UnsupportedVastVersion=102]="UnsupportedVastVersion",e[e.Trafficking=200]="Trafficking",e[e.PlayerExpectingDifferentLinearity=201]="PlayerExpectingDifferentLinearity",e[e.PlayerExpectingDifferentDuration=202]="PlayerExpectingDifferentDuration",e[e.PlayerExpectingDifferentSize=203]="PlayerExpectingDifferentSize",e[e.GeneralWrapper=300]="GeneralWrapper",e[e.WrapperTimeout=301]="WrapperTimeout",e[e.WrapperLimitReached=302]="WrapperLimitReached",e[e.NoAdsAfterWrappers=303]="NoAdsAfterWrappers",e[e.GeneralLinear=400]="GeneralLinear",e[e.MediaFileNotFound=401]="MediaFileNotFound",e[e.MediaFileTimeout=402]="MediaFileTimeout",e[e.UnsupportedMediaFile=403]="UnsupportedMediaFile",e[e.MediaFileDisplayProblem=405]="MediaFileDisplayProblem",e[e.GeneralNonLinear=500]="GeneralNonLinear",e[e.NonLinearCreativeDimensions=501]="NonLinearCreativeDimensions",e[e.NonLinearUnableFetch=502]="NonLinearUnableFetch",e[e.SupportedNonLinearNotFound=503]="SupportedNonLinearNotFound",e[e.GeneralCompanion=600]="GeneralCompanion",e[e.CompanionDimensions=601]="CompanionDimensions",e[e.CompanionDisplayProblem=602]="CompanionDisplayProblem",e[e.CompanionUnableFetch=603]="CompanionUnableFetch",e[e.SupportedCompanionNotFound=604]="SupportedCompanionNotFound",e[e.Undefined=900]="Undefined",e[e.GeneralVpaid=901]="GeneralVpaid"}(n||(n={}));const o=Object(r.b)(Object.keys(n),s.cArray.filter(Object(r.a)(e=>parseInt(e,10),Object(a.not)(a.isNumber))),s.cArray.map(e=>n[e]))},function(e,t,i){var n;i.d(t,"a",(function(){return n})),function(e){e[e.UNSUPPORTED=0]="UNSUPPORTED",e[e.JS=1]="JS",e[e.VPAID=2]="VPAID",e[e.CANVAS=3]="CANVAS"}(n||(n={}))},function(e,t,i){i.d(t,"b",(function(){return c})),i.d(t,"e",(function(){return l})),i.d(t,"g",(function(){return h})),i.d(t,"h",(function(){return u})),i.d(t,"a",(function(){return p})),i.d(t,"d",(function(){return g})),i.d(t,"c",(function(){return m})),i.d(t,"f",(function(){return b}));var n=i(0),s=i(12),r=i(10);var a=i(2),o=i(6),d=i(67);const c=({auctionId:e=n.b.empty(),pageId:t=n.b.empty(),pid:i=n.b.empty(),insertionId:s=n.b.empty(),connectionId:r=n.b.empty(),slotType:a=n.b.empty(),env:o=n.b.empty(),impressionId:c=n.b.empty(),cachebusting:l=n.b.empty(),headerBiddingProvider:h=n.b.empty(),gdprIab:u=n.b.empty(),userStore:p=n.b.empty(),portfolioItemId:g=n.b.empty(),viewerId:m=n.b.empty(),debugMetadata:b=n.b.empty()}={})=>{const f={"[auctid]":e.getOrValue(""),"[pageId]":t.map(String).getOrValue(""),"[pid]":i.map(String).getOrValue(""),"[insertionId]":s.map(String).getOrValue(""),"[connectionId]":r.map(String).getOrValue(""),"[slotType]":a.getOrValue(""),"[env]":h.match({some:()=>"js-web",none:()=>o.getOrValue("")}),"[impressionId]":c.map(String).getOrValue(""),"[CACHEBUSTING]":l.map(String).getOrValue(""),"[headerBiddingProvider]":h.getOrValue(""),"[pfid]":g.map(String).getOrValue(""),"[viewerId]":m.getOrValue(""),"[debugMetadata]":b.getOrValue("")};return u.forEach(({status:e,consent:t,reason:i,apiVersion:n,cmpId:s})=>{f["[gdpr_status]"]=String(e),f["[gdpr_consent]"]=t,f["[gdpr_reason]"]=String(i),f["[gdpr_cmp_id]"]=s.map(String).getOrValue(""),f["[gdpr_api_version]"]=n.map(String).getOrValue(""),f["[gdpr_apply]"]=Object(d.b)(Object(d.a)(e))}),p.forEach(e=>{f["[userId]"]=e.userId,f["[os]"]=e.userDevice.os.toLowerCase(),f["[DEVICEID]"]=e.userDevice.device,f["[LIMIT_TRACKING]"]=String(e.userOptOut)}),f},l=({currentTime:e=n.b.empty(),errorCode:t=n.b.empty(),assetUrl:i=n.b.empty(),mediaFileType:r=n.b.empty(),viewability:o=n.b.empty(),userStore:d=n.b.empty(),debugMetadata:c=n.b.empty(),errorCause:l=n.b.empty(),gdprApplies:h=n.b.empty(),gdprConsent:u=n.b.empty()}={},p=s.rand)=>{const g=h.map(e=>e?"1":"0").getOrValue(""),m=u.getOrValue(""),b={"[CONTENTPLAYHEAD]":e.filter(e=>e>=0).match({some:a.offset,none:()=>"0"}),"[CACHEBUSTING]":p(8),"[ERRORCODE]":t.map(String).getOrValue(""),"[ASSETURI]":encodeURIComponent(i.getOrValue("")),"[MEDIAFILETYPE]":r.getOrValue("unknown"),"[VIEWABILITY]":o.map(String).getOrValue("0"),"[debugMetadata]":c.getOrValue(""),"[errorCause]":l.getOrValue(""),"[GDPR]":g,"%5BGDPR%5D":g,"${GDPR}":g,"%24%7BGDPR%7D":g,"${GDPR_CONSENT_\\d+}":m,"%24%7BGDPR_CONSENT_\\d+%7D":m,"[GDPR_CONSENT]":m,"%5BGDPR_CONSENT%5D":m,"${GDPR_CONSENT}":m,"%24%7BGDPR_CONSENT%7D":m};return d.forEach(e=>{b["[BUNDLEID]"]=e.userDevice.appId,b["[DEVICEID]"]=e.userDevice.device,b["[LIMIT_TRACKING]"]=String(e.userOptOut)}),b},h=e=>([t,i])=>e.replace(new RegExp(t.replace("[","\\[").replace("]","\\]").replace("{","\\{").replace("}","\\}").replace("$","\\$"),"gi"),i),u=(e,t=!1)=>i=>((e,t,i)=>{let n,s=i;for(;!(n=e.next()).done;)s=t(s,n.value);return s})(function*(e,t=!1){for(const i in e)e.hasOwnProperty(i)&&(t||""!==e[i])&&(yield[i,e[i]])}(e,t),(e,t)=>h(e)(t),i),p=(e,t)=>Object(a.isNumber)(e)&&Object(a.isNumber)(t)?e-t:0,g=(e=n.a)=>e.map(e=>e.url.toString()),m=(e=n.a)=>e.map(e=>Object(a.getExtensionFromMimeType)(e.type)),b=(e,t,i)=>{const s=Math.ceil(100*Object(r.getPercentageInView)({element:e,elementAncestors:Object(r.findParentElements)(e),elementClientRect:Object(o.getBoundingClientRect)(e),mainWindow:n.b.fromNullable(Object(r.getWindow)(e)).getOrValue(window),elementHeight:t}));return s<0||Object(r.checkElementVisibility)(e,i).isLeft()?0:s}},function(e,t,i){i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));const n="data:image/gif;base64,R0lGODlhAQABAAAAACwAAAAAAQABAAA=",s=16/9},function(e,t,i){var n;i.d(t,"a",(function(){return n})),function(e){e.AD_VERIFICATIONS="AdVerifications",e.MOAT_JS="MoatJs",e.VISIBILITY="Visibility",e.HTML="Html",e.IFRAME="Iframe",e.SCRIPT="Script",e.ALENTY="Alenty",e.TEADS_IAS="teads-IAS",e.TEADS_CONTEXT="teads-context"}(n||(n={}))},function(e,t,i){var n=i(22);const s=window.teads||{};s.START_TIME=s.START_TIME||Object(n.a)(),s.FULL_LOGS=s.FULL_LOGS||[],s.HAS_DEBUG_LOGS=s.HAS_DEBUG_LOGS||!1,s.CONTEXT_IS_INITIALIZED=!1,s.WIGO_DEBUG_KEY=s.WIGO_DEBUG_KEY||null,window.teads=s},function(e,t,i){i.d(t,"b",(function(){return d})),i.d(t,"a",(function(){return c})),i.d(t,"c",(function(){return m}));var n=i(0),s=i(5),r=i(2),a=i(63),o=i(37);const d=e=>a.b(o.b(e)),c=e=>n.b.fromNullable(e).filter(r.isObject).match({some:l,none:h(e)}),l=e=>r.isString(e.AdParameters)?u(e.AdParameters):Object(s.e)(e),h=e=>()=>n.b.fromNullable(e).filter(r.isString).match({some:u,none:()=>Object(s.b)(new Error("adParameters is neither an object or string: "+e))}),u=e=>g(p(e,a.c,a.a,decodeURIComponent),o.a),p=(e,t,i,n)=>t(e)?i(e):0===e.indexOf("%7B")?n(e):e,g=(e,t)=>s.a.tryCatch(()=>t(e)).orElse(()=>Object(s.b)(new Error("Unable to JSON.parse adParameters string: "+e))),m=(e,t)=>c(e).toOption().filter(e=>/teads-vpaid-display/.test(t)).map(e=>!0===e.viewable).getOrValue(!0)},function(e,t,i){i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a}));var n=i(0),s=i(37);function r(e){return n.b.fromNullable(e.message).getOrElse(()=>s.b(e)).substr(0,120)}function a(e){return n.b.fromNullable(e.getFullMessage()).getOrElse(()=>s.b(e)).substr(0,120)}},function(e,t,i){i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return o}));var n=i(0);const s=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,r=e=>n.b.fromNullable(s.exec(e)).existsIf(e=>e.length>0),a=e=>n.b.fromNullable(window.btoa).map(t=>t(e)).getOrValue(e),o=e=>n.b.fromNullable(window.atob).map(t=>t(e)).getOrValue(e)},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",n=e[3];if(!n)return i;if(t&&"function"==typeof btoa){var s=(a=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),r=n.sources.map((function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"}));return[i].concat(r).concat([s]).join("\n")}var a;return[i].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i})).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},s=0;s<this.length;s++){var r=this[s][0];"number"==typeof r&&(n[r]=!0)}for(s=0;s<e.length;s++){var a=e[s];"number"==typeof a[0]&&n[a[0]]||(i&&!a[2]?a[2]=i:i&&(a[2]="("+a[2]+") and ("+i+")"),t.push(a))}},t}},function(e,t,i){i.d(t,"a",(function(){return A}));var n,s,r=i(53),a=i(56),o=i(112),d="teads-vpaid-video.min.js",c="teads-vpaid-canvas.min.js",l=i(9),h=i(0),u=i(21),p=i(3),g=i(40),m=i(1),b=i(23),f=i(15),v=i(58);!function(e){e[e.VIDEO=0]="VIDEO",e[e.MPEG=1]="MPEG",e[e.TV=2]="TV",e[e.VPAIDJS=3]="VPAIDJS"}(n||(n={})),function(e){e.landscape="l",e.square="s",e.vertical="v"}(s||(s={}));class A{static getPreferredMediafileTypes(e){let t=[n.VIDEO,n.VPAIDJS,n.TV,n.MPEG];return p.isDesktop()||(t=Object(m.filter)(t,e=>e!==n.VPAIDJS).concat([n.VPAIDJS])),p.isIE()?t=Object(m.filter)(t,e=>e!==n.TV&&e!==n.MPEG):p.isSDK()?t=[n.VIDEO,n.VPAIDJS]:p.isIos()&&u.d(p.getIosVersion(),"8")?t=e===r.a.HTML5?[n.VIDEO]:p.isIpad()?[n.MPEG,n.TV]:[]:(e===r.a.CANVAS||p.isIos()&&(u.d(p.getIosVersion(),"10")||!p.isIos10Safari()&&!p.isFacebookWebviewIOS10())&&e!==r.a.HTML5)&&(t=Object(m.filter)(t,e=>e!==n.VIDEO)),t}static getElectedMediafiles(e,t){const i=A.getPreferredMediafileTypes(t);let s=[];Object(m.map)(e,e=>{e.api&&e.api.toLowerCase&&(e.api=e.api.toLowerCase()),e.type&&e.type.toLowerCase&&(e.type=e.type.toLowerCase())});let r=0;const a=i.length;for(;r<a&&0===s.length;){switch(i[r]){case n.VIDEO:s=Object(m.filter)(e,A.isPlayableVideo);break;case n.TV:s=Object(m.filter)(e,A.isTv);break;case n.MPEG:s=Object(m.filter)(e,A.isMpeg);break;case n.VPAIDJS:s=Object(m.filter)(e,A.isVpaidJS)}r++}return s}static getTargetedBitrate(e){return e>0?e/2:0}static extractMediafileFromBitrate(e,t){if(t){const i=(e,t,n)=>n.length>0?e.bitrate<t?e:i(Object(m.head)(n),t,Object(m.tail)(n)):e;return i(Object(m.head)(e),t,Object(m.tail)(e))}return e[Math.floor(e.length/2)]}static sortMediafilesByBitrate(e,t){const i=Object(m.map)(e,e=>(e.bitrate=e.bitrate||2*t.max,e));let n=Object(m.filter)(i,e=>e.bitrate<=t.max&&e.bitrate>=t.min);return n=n.length?n:i,n.sort((e,t)=>t.bitrate-e.bitrate)}static getMaxBitrateForContext(){return p.isMobile()?A.bitrates.mobile:A.bitrates.default}static getMediaProvider(e){switch(e.type){case"application/x-javascript":case"application/javascript":case"text/javascript":return a.a.VPAID;case"video/mpg":case"video/mpeg":case"video/tv":return p.cacheCanvasUsed(!0),a.a.CANVAS;default:return A.isPlayableVideo(e)?a.a.JS:a.a.UNSUPPORTED}}static getOptimalMediaFiles(e,t,i,n,s){if(0===t.length)return null;const a=A.getEncodingCandidate(t.slice()),o=A.getElectedMediafiles(t,s),d=A.getDownloadSpeed();if(s!==r.a.CANVAS&&!u.a(p.getIosVersion(),"8")||0!==o.length&&!A.isVpaidJS(o[0])||!a)if(o.length>1){const t=A.getTargetedBitrate(d),n=p.isChrome()||p.isEdge()?A.limitBitrateForHAI(e,t):t,s=A.extractMediafileFromBitrate(A.sortMediafilesByBitrate(o,A.getMaxBitrateForContext()),n);this.logger.debug(`Picked mediafile ${s.url} with bitrate ${s.bitrate}`),i(s,d)}else if(1===o.length)i(o[0],null);else{const e="No Mediafile for this context";i(null,null,e),A.logger.info("getOptimalMediaFiles",e)}else A.waitForProxy(a.url,A.getMediaProxyBitrate(A.getTargetedBitrate(d)),(e,t)=>{a.url=e,a.type="video/tv",i(e?a:null,d,t)},n)}static limitBitrateForHAI(e,t){this.logger.debug(`limitBitrateForHAI called with duration ${e} and target bitrate ${t}`);const i=Math.max(30,Math.min(0|e,60)),n=Math.floor(30720/i);return this.logger.debug(`Maximum allowed bitrate ${n} for ${i} seconds`),Math.min(n,t)}static waitForProxy(e,t,i,n){const s=location.hostname.match(/.+\.sandbox\.teads\.net|localdocker/),r="https://[HOST]/transcode?url=[URL]&bitrate=[BITRATE]".replace(/\[HOST\]/,s?s[0]+":18088":"mp.teads.tv").replace(/\[URL\]/,encodeURIComponent(e)).replace(/\[BITRATE\]/,t.toString()),a=g.a();let o=!1;a.open("GET",r,!0),a.onreadystatechange=()=>{let e;if(4===a.readyState&&!o){switch(o=!0,a.status){case 200:i(a.responseText);break;case 202:e="Mediaproxy - encoding ongoing - need wait",i(null,e);break;case 201:e="Mediaproxy - encoding init - need one more call to encode",i(null,e);break;case 410:e="Mediaproxy - encoding failed",i(null,e);break;case 400:e="Mediaproxy - bad request",i(null,e);break;default:e="Mediaproxy - other error - "+a.status,i(null,e)}A.logger.debug("proxy resp",a.status),n.info(["proxy","resp",a.status].join(" "))}},a.send(),n.info("proxy call")}static getOptimalMediaFile(e,t,i,n,s){var a,o;p.isCanvasNeeded()&&(n.type=r.a.CANVAS,null===(o=null===(a=n.formatConfig)||void 0===a?void 0:a.allowedPlayer)||void 0===o||o.setValue(r.a.CANVAS)),A.getOptimalMediaFiles(e,t,(e,t,n)=>{if(e){const n=0;s.info("media "+e.type,n),i(e,t?` -> dlSpeed: ${t}kbit/s`:"")}else i(null,n)},s,n.type)}static getOptimalHeight(e,t,i){return t?Math.ceil(t/A.getRatio(e,i)):0}static getRatio(e,t){const i=!Object(f.j)(e.url);return!e.height||!e.width||!t&&i&&e.api&&"vpaid"===e.api.toLowerCase()&&e.width>e.height?v.a:e.width/e.height}static getAssetFromMediaProvider(e){let t;switch(e){case a.a.JS:t=d;break;case a.a.CANVAS:t=c;break;default:t=""}return t}static getEncodingCandidate(e){let t;return Object(m.forEach)(e,e=>{let i=e.type||"";switch(e.weight=0,i.split("/").pop()){case"mov":e.weight=150;break;case"mp4":e.weight=100;break;case"webm":case"ogg":case"ogv":e.weight=50}(!t||t.weight<=e.weight)&&(t=t||e,(t.weight<e.weight||t.bitrate<e.bitrate)&&(t=e))}),t.weight?t:null}static getMediaProxyBitrate(e){return e>=1e3?1e3:e>=700?700:e>=500?500:300}static sendMediasToSumologic(e,t,i){try{let n={},s=Object(m.map)(Object(m.filter)(e.mediaFiles,e=>!n[e.type]&&(n[e.type]=!0,!0)),e=>e.type);const r=Object(m.map)(e.wrappers,e=>Object(f.p)(e).hostname),a=0;i.info(`[mf-${t}] ${s.join(" | ")}||${r.join(" > ")}`,a)}catch(e){A.logger.error("sendMediasToSumologic error",e)}}static getRatioCategory(e){return e.width>e.height?s.landscape:e.width===e.height?s.square:s.vertical}static getMediaFileRatioLog(e,t,i){return"mediafile-ratio "+[A.getRatioCategory(e),""+t,i.map(String).getOrValue("n")].join("|")}static isMpeg(e){return/^video\/mpe?g$/.test(e.type)}static isTv(e){return"video/tv"===e.type}static isVideo(e){return!A.isMpeg(e)&&!A.isTv(e)&&/^video\/*/.test(e.type)}static isPlayableVideo(e){return A.isVideo(e)&&o.a(e.type)}static isVpaidJS(e){return"vpaid"===e.api&&e.type.indexOf("javascript")>-1}static getDownloadSpeed(e=window.navigator){var t;return h.b.fromNullable(null===(t=null==e?void 0:e.connection)||void 0===t?void 0:t.downlink).match({some:e=>1024*e,none:()=>Object(b.d)().map(e=>e.sort((e,t)=>t.transferSize-e.transferSize)).map(e=>Object(b.c)(e.slice(0,Math.round(e.length*A.percentResourcesAmount)))).getOrValue(0)})}}A.logger=new l.a("player.MediaFileHelper"),A.bitrates={mobile:{min:200,max:5e3},default:{min:200,max:1e4}},A.percentResourcesAmount=.1},function(e,t,i){i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return r}));var n=i(2);const s=e=>e,r=e=>Object(n.isString)(e)},function(e,t,i){i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return r}));var n=i(0);const s=e=>{switch(e){case 0:return Object(n.c)(!1);case 11:case 12:return Object(n.c)(!0);default:return n.a}},r=e=>e.map(e=>e?"1":"0").getOrValue("")},function(e,t,i){i.r(t),i.d(t,"SHADER_FRAGMENT_YCBCRTORGBA",(function(){return n})),i.d(t,"SHADER_FRAGMENT_LOADING",(function(){return s})),i.d(t,"SHADER_VERTEX_IDENTITY",(function(){return r}));const n=["precision mediump float;","uniform sampler2D YTexture;","uniform sampler2D CBTexture;","uniform sampler2D CRTexture;","varying vec2 texCoord;","void main() {","float y = texture2D(YTexture, texCoord).r;","float cr = texture2D(CBTexture, texCoord).r - 0.5;","float cb = texture2D(CRTexture, texCoord).r - 0.5;","gl_FragColor = vec4(","y + 1.4 * cr,","y + -0.343 * cb - 0.711 * cr,","y + 1.765 * cb,","1.0",");","}"].join("\n"),s=["precision mediump float;","uniform float loaded;","varying vec2 texCoord;","void main() {","float c = ceil(loaded-(1.0-texCoord.y));","gl_FragColor = vec4(c,c,c,1);","}"].join("\n"),r=["attribute vec2 vertex;","varying vec2 texCoord;","void main() {","texCoord = vertex;","gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);","}"].join("\n")},function(e,t,i){i.r(t),i.d(t,"getRandomValue",(function(){return a})),i.d(t,"getNativeCrypto",(function(){return o})),i.d(t,"generateUuidWithRandom",(function(){return d})),i.d(t,"getRandomBytes",(function(){return c}));var n=i(0),s=i(5),r=i(2);function a(e=window){return Object(r.isNative)(Math.random)?Math.random():n.b.fromNullable(e.crypto).filter(e=>Object(r.isNative)(e.getRandomValues)).flatMap(e=>s.a.tryCatch(()=>e.getRandomValues(new Uint32Array(1))[0]).toOption()).map(e=>e/4294967295).getOrValue(0)}function o(e){return Object(r.isObject)(e)&&Object(r.isFunction)(e.getRandomValues)&&Object(r.isNative)(e.getRandomValues)?Object(n.c)(e):n.a}function d(e,t=Math.random){const i=new Array(e);for(let n=0,s=0;n<e;n++)0==(3&n)&&(s=4294967296*t()),i[n]=s>>>((3&n)<<3)&255;return i}function c(e,t=window,i=(()=>d(e))){return o(t.crypto).orElse(()=>o(t.msCrypto)).flatMap(t=>{const i=new Uint8Array(e);return t.getRandomValues(i),void 0!==i[e-1]?Object(n.c)(i):n.a}).getOrElse(i)}},function(e,t,i){i.d(t,"e",(function(){return n})),i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"d",(function(){return o}));const n={id:100,message:"callback success function throw an exception "},s={id:200,message:"You must specify the bundle asset you want to use with teads.vpaid.BundledContainer.(CANVAS|VIDEO)"},r={id:400,message:"VPAIDJS getVPAIDAd throw an exception"},a={id:500,message:"Unable to load VPAID ad, file doesn't exists"},o={id:501,message:"Unable to load VPAID ad, timeout error"}},function(e,t,i){i.d(t,"a",(function(){return l})),i.d(t,"d",(function(){return h})),i.d(t,"c",(function(){return u})),i.d(t,"e",(function(){return p})),i.d(t,"b",(function(){return b}));var n=i(1),s=i(5),r=i(0),a=i(9),o=i(15),d=i(2);const c=new a.a("BusinessIds"),l=Object(s.c)({placementId:r.a,insertionId:r.a,connectionId:r.a});function h(e){return e.fold(e=>e.insertionId,e=>0===e.type||2===e.type?Object(r.c)(e.insertionId):r.a)}function u(e){return e.fold(e=>e.connectionId,e=>1===e.type||2===e.type?Object(r.c)(e.connectionId):r.a)}function p(e){return Object(n.filter)(Object(n.map)(e,e=>e.url),o.o)}function g(e){const{pid:t,gid:i,sid:n}=Object(o.q)(e);return{placementId:r.b.fromNullable(t).map(parseInt).filter(d.isNumber),insertionId:r.b.fromNullable(i).map(parseInt).filter(d.isNumber),connectionId:r.b.fromNullable(n).map(parseInt).filter(d.isNumber)}}function m(e,{insertionId:t,connectionId:i}){return t.match({some:t=>i.map(i=>function(e,t,i){return Object(s.d)({type:2,placementId:e,insertionId:t,connectionId:i})}(e,t,i)).getOrElse(()=>function(e,t){return Object(s.d)({type:0,placementId:e,insertionId:t})}(e,t)),none:()=>i.map(t=>function(e,t){return Object(s.d)({type:1,placementId:e,connectionId:t})}(e,t)).getOrElse(()=>Object(s.c)({placementId:Object(r.c)(e),insertionId:t,connectionId:i}))})}function b(e,t){return e.orElse(e=>r.b.fromNullable(Object(n.head)(t)).map(g).match({none:()=>(c.warn("Could not extract all the business IDs from the Teads URLs, and there is no more URL to check"),Object(s.c)(e)),some:i=>{const r={placementId:i.placementId.orElse(()=>e.placementId),insertionId:i.insertionId.orElse(()=>e.insertionId),connectionId:i.connectionId.orElse(()=>e.connectionId)};return r.placementId.match({none:()=>b(Object(s.c)(r),Object(n.tail)(t)||[]),some:e=>{const i=Object(n.tail)(t)||[];return 0===i.length||function({placementId:e,insertionId:t,connectionId:i}){return e.nonEmpty()&&t.nonEmpty()&&i.nonEmpty()}(r)?m(e,r):b(Object(s.c)(r),i)}})}}))}},function(e,t,i){i.d(t,"a",(function(){return d}));var n=i(70),s=i(114),r=i(0),a=i(122),o=i.n(a);class d extends s.a{loadVpaid(e,t,i){e===d.CANVAS?this.loadBundled(d.CANVAS,t,i):e===d.VIDEO?this.loadBundled(d.VIDEO,t,i):super.loadVpaid(e,t,i)}loadBundled(e,t,i){this.setUpCreativeContainers(this.container,e),r.b.fromNullable(this.getCreativeWindow(this.creativeContainer)).forEach(t=>{switch(e){case d.VIDEO:this.vpaid=new t.teads.video.VPAIDVideo;break;case d.CANVAS:this.vpaid=new t.teads.video.VPAIDCanvas;break;default:return i(n.a)}}),r.b.fromNullable(this.vpaid).forEach(e=>t(e))}getCreativeTemplate(e,t,i){return`\n      <!DOCTYPE html>\n      <html>\n        <head>\n            ${o.a}\n        </head>\n        <body style="margin:0px;padding:0px;overflow:hidden">\n          <div id="video-container" style="position:absolute;top:0px;left:0px;z-index:1;background-color:${i}"></div>\n          <div id="vpaid-container" style="position:absolute;top:0px;left:0px;z-index:2"></div>\n        </body>\n      </html>\n    `}}d.CANVAS="canvas",d.VIDEO="video"},function(e,t,i){i.d(t,"d",(function(){return f})),i.d(t,"a",(function(){return v})),i.d(t,"b",(function(){return A})),i.d(t,"f",(function(){return y})),i.d(t,"e",(function(){return E})),i.d(t,"i",(function(){return O})),i.d(t,"g",(function(){return C})),i.d(t,"h",(function(){return I})),i.d(t,"c",(function(){return P}));var n=i(9),s=i(3),r=i(1),a=i(50),o=i(2),d=i(0);let c,l,h,u,p,g=[];const m=new n.a("helper.Amp");let b={noContentAvailable:!1,renderStart:!1,reportRenderedEntityIdentifier:!1};function f(){!s.isAmp()||!S()||p&&c&&window._teads_amp.change.rootBounds.width===p.width||(p=S().rootBounds,l=s.isDesktop()?window.innerWidth:Math.min(Math.min(p.width,p.height),window.innerWidth),l!==window.innerWidth&&(l-=2*window.context.initialIntersection.boundingClientRect.left),c||(window.context.onResizeDenied((e,t)=>j(e,t,!1)),window.context.onResizeSuccess((e,t)=>j(e,t,!0)),S().boundingClientRect.height>10&&(A(),a.a.error("AMP tag malformed "+window.context.location.href)),c=!0),2!==u&&2!==h||y())}function v(e=(()=>{}),t=!1){h=0,c&&T(0,e,h,t)}function A(e=(()=>{}),t=!1){h=1,c&&T(1,e,h,t)}function y(e=null,t=(()=>{}),i=!1){h=2,c&&T(e||w(),t,h,i)}function w(){return Math.ceil(l/(4/3))}function E(){return 2===u}function O(e){let t="teads-";e?(t+=e.id?e.id:"0",t+="-",t+=e.creativeId?e.creativeId:"0"):t+="0",t=t}function C(){if(window.context&&Object(o.isFunction)(window.context.renderStart)&&!b.renderStart){b.renderStart=!0;let e={height:w(),width:l};m.debug("renderStart",e),window.context.renderStart(e)}}function I(){void 0}function S(){return window._teads_amp.change&&window.context.initialIntersection?(window._teads_amp.change||(window._teads_amp.change=window.context.initialIntersection),window._teads_amp.change):null}function T(e,t,i,n){!function(e,t){if(!s.isAmp()||!window.context.requestResize||!c)return;g.push({width:l,height:e,done:!1,callback:t}),window.context.requestResize(l,e),m.warn("amp request resize",l,e)}(e,s=>{let r="function"==typeof n?n():n;s||r?(h=null,u=s?i:null,t(s),E()&&I()):h===i&&setTimeout(()=>T(e,t,i,r),100)})}function k(e,t,i){return e>=t-i&&e<=t+i}function j(e,t,i){r.forEach(g,n=>{k(e,n.height,2)&&k(t,n.width,2)&&!n.done&&(n.done=!0,n.callback(i))}),i?m.warn("amp request resize success",t,e):m.error("amp request resize denied",t,e)}const P=()=>{var e;return d.b.fromNullable(null===(e=window.context)||void 0===e?void 0:e.initialConsentValue).orElse(()=>{var e,t;return t=null===(e=window.context)||void 0===e?void 0:e.consentSharedData,Object(o.isObject)(t)&&function(e){return"accepted"===e.consentStateValue||"rejected"===e.consentStateValue}(t)&&Object(o.isString)(t.consentString)?Object(d.c)(t.consentString):d.a}).map(e=>{var t,i;return{status:12,reason:127,consent:e,apiVersion:d.b.fromNullable(null===(i=null===(t=window.context)||void 0===t?void 0:t.initialConsentMetadata)||void 0===i?void 0:i.consentStringType).flatMap(e=>2===e?Object(d.c)(2):1===e?Object(d.c)(1):d.a),cmpId:d.a}}).getOrValue({status:25,reason:250,consent:"",apiVersion:d.a,cmpId:d.a})}},function(e,t,i){i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));function n(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}function s(e,t,i,n){return new(i||(i=Promise))((function(s,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function o(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,o)}d((n=n.apply(e,t||[])).next())}))}},function(e,t,i){i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return o}));var n=i(4),s=i(13);function r(e){return Number(e.handshakeVersion("2.0"))>=2}function a(e,t){return function(...i){var s=i[0];switch(t){case n.a.AdClickThru:s={url:i[0],id:i[1],playerHandles:i[2]};break;case n.a.AdError:s={message:i[0],id:i[1]}}e({type:t,data:s})}}function o(e,t){switch(e){case"initAd":if(t>=s.a.LOADING)throw"VPAID already initalized, cannot call initAd twice";break;case"startAd":if(t<s.a.LOADED)throw"VPAID not started, use initAd, and wait for AdLoaded event before call startAd method";if(t>=s.a.STARTING)throw"Ad already started, cannot call startAd twice"}}},function(e,t,i){i.d(t,"a",(function(){return v})),i.d(t,"b",(function(){return A})),i.d(t,"c",(function(){return y}));i(60);var n=i(3),s=i(22),r=i(6),a=i(10),o=i(37),d=i(9),c=i(40),l=i(2),h=i(5),u=i(15),p=i(12),g=i(1),m=i(0),b=i(132),f=i.n(b);const v="wigo.teads.tv";class A{constructor(){if(this.settings=m.a,this.color="blue",this.statusDetails="",this.bottomPxPosition=10,this.position=1,this.buttonHeight=0,window.teads.WIGO_DEBUG_KEY=!window.teads.WIGO_DEBUG_KEY&&window.teads.HAS_DEBUG_LOGS?"debug":window.teads.WIGO_DEBUG_KEY,this.elapsedTime=0,this.logfile={context:(Object(n.getDevice)().toString()+"-"+Object(n.getOS)().toString()+"-"+Object(n.getBrowser)().toString()).replace(/\|/g," "),url:location.href,steps:[],logs:[],timeline:[],vasts:[]},m.b.fromNullable(A.reportPromise).forEach(e=>e.then(e=>this.report=e)),this.topWindow=Object(a.findTopWindow)(document.body),window.teads.WIGO_DEBUG_KEY)this.createDebugButton(this.color),this.recordUserActions();else{const e=e=>{const t=e.data.wigoLiveDebug;t&&t.length&&t.length>1&&this.enableWigo(t[1])};try{this.topWindow.addEventListener("message",e)}catch(t){this.topWindow=window,this.topWindow.addEventListener("message",e)}}A.storeInstance(this)}static getInstances(){return A.instances}static loadAndStoreReportIfNeeded(e){const t=Object(u.h)(),i=Object(u.q)(t),n=i.teadsWigoDebug||i.teadswigodebug;n&&(e.info(`wigo debug ${n} on ${location.href}`,1),A.reportPromise=A.loadReport(n))}static isCeltraParameterSet(e){return"true"===Object(u.q)(e).celtra}static storeInstance(e){A.instances.push(e)}static loadReport(e){return new Promise((t,i)=>{const n=Object(c.a)();n.open("GET",`${Object(l.getProtocol)()}//wigo.teads.tv/livedebug/upload/${e}.json`),n.onload=()=>{h.a.tryCatch(()=>JSON.parse(n.response)).orElse(()=>h.a.tryCatch(()=>JSON.parse(n.responseText))).tapLeft(e=>{new d.a("WIGO").error(e)}).orElse(()=>Object(h.b)(new Error("report is not available from xhr response"))).fold(i,t)},n.onerror=i,n.send()})}enableWigo(e="enableFromAdSettings"){window.teads.WIGO_DEBUG_KEY=e,this.createDebugButton(this.color),this.recordUserActions()}setPlayerContainer(e){this.playerContainer=e,this.setElementToFollow(this.playerContainer)}setElementToFollow(e){this.elementToFollow=e,this.elementToFollowRelativeRect=Object(r.getClientRectRelativeToDocument)(Object(r.getBoundingClientRect)(e),{x:Object(r.getScrollLeft)(this.topWindow),y:Object(r.getScrollTop)(this.topWindow)})}valid(e,t,i,n){if(this.addValidEvent(e,t,{store:i,type:n}),"error"===n){const e=m.b.fromNullable(i),t=e.filter(l.isString).orElse(()=>e.filter(e=>!!e.message).map(e=>m.b.fromNullable(e.id).filter(e=>!!e).map(t=>`${t} - ${e.message}`).getOrValue(""+e.message))).orElse(()=>e.filter(e=>e.length>0).map(String)).getOrElse(()=>JSON.stringify(i));this.setStatus(!1,t)}else 3===e&&2===t?this.setStatus(!0,"AdLoaded"):3===e&&3===t&&this.setStatus(!0,"AdStarted")}vastEvent(e,t,i,n){if(this.addValidEvent(0,0,{store:{name:e,time:t,percent:i,pixels:n},type:"vastEvent"}),"complete"===e)this.setStatus(!0,"AdComplete");else if("pause"===e)this.setStatus(!0,"AdPaused"),this.lastTracking="pause";else if("pause"===this.lastTracking)this.lastTracking=null;else if("progress"===e){const e=t?t.split(".")[0]+"s":"";this.setStatus(!0,"AdPlaying: "+e)}}setStatus(e,t=""){const i=e?"green":"red";this.button?(this.status.style.setProperty("background-color",i),this.status.style.setProperty("display","block"),this.loader.style.setProperty("display","none"),this.status.innerHTML=t):(this.color=i,this.statusDetails=t)}moveButton(e){this.bottomPxPosition=A.initialBottomPosition+(e-1)*A.bottomPxInterval,this.position=e,this.button&&this.button.style.setProperty("bottom",this.bottomPxPosition+"px")}followElement(){if(this.isActivated()){const e=Object(r.getBoundingClientRect)(this.elementToFollow);this.elementToFollowRelativeRect=Object(r.isEmptyBoundingClientRect)(e)?this.elementToFollowRelativeRect:Object(r.getClientRectRelativeToDocument)(e,{x:Object(r.getScrollLeft)(this.topWindow),y:Object(r.getScrollTop)(this.topWindow)});const t=Object(r.getClientRectFromClientRectRelativeToDocument)(this.elementToFollowRelativeRect,{x:Object(r.getScrollLeft)(this.topWindow),y:Object(r.getScrollTop)(this.topWindow)}),i=this.topWindow.innerHeight-this.buttonHeight-(A.initialBottomPosition+(A.instances.length-this.position)*A.bottomPxInterval);let n=this.topWindow.innerHeight-t.bottom+t.height/2-this.buttonHeight/2,s=10;n<this.bottomPxPosition?n=this.bottomPxPosition:n>i?n=i:s=50,this.button.style.setProperty("bottom",n+"px"),this.button.style.setProperty("right",s+"px")}}forceReportWithKey(e){window.teads.WIGO_DEBUG_KEY=e,this.sendLogsToWigo(()=>{})}isActivated(){return!(!window.teads.WIGO_DEBUG_KEY||!this.button)}setVast(e,t,i=""){this.logfile.vasts.push({url:e,content:t,uploadedUrl:i})}getVastUrl(e){var t;return m.b.fromNullable(null===(t=this.report)||void 0===t?void 0:t.vasts).map(t=>Object(g.filter)(t,t=>t.url===e)).filter(g.isNotEmpty).map(e=>e[0].uploadedUrl).getOrValue(e)}saveVast(e){this.sendLogsToWigo(()=>{},e)}recordUserActions(){this.elapsedTime<3e5&&setTimeout(()=>{const e=this.logfile.timeline[this.logfile.timeline.length-1],t=Object(r.getWindowSize)(this.topWindow),i=Object(r.getScrollLeft)(this.topWindow),n=Object(r.getScrollTop)(this.topWindow);if(!e||this.hasInteracted(e,t,i,n)){const e={time:this.elapsedTime,scrollX:i,scrollY:n,screenWidth:t.width,screenHeight:t.height,player:{top:0,height:0,left:0,width:0}};if(this.playerContainer){const t=Object(r.getBoundingClientRect)(this.playerContainer);e.player={top:t.top,height:t.height,left:t.left,width:t.width}}this.logfile.timeline.push(e)}this.elapsedTime+=A.recordUserActionsTiming,this.recordUserActions()},A.recordUserActionsTiming)}addValidEvent(e,t,i){this.logfile.steps.push({step:e,substep:t,info:i})}createDebugButton(e){if(window.teads.WIGO_DEBUG_KEY&&!this.button){const t=this.topWindow.document.createElement("div");t.innerHTML=A.TEMPLATE,this.button=t.firstChild,this.button.onclick=e=>{this.openWigoReport(),e.stopPropagation()},this.button.style.setProperty("bottom",this.bottomPxPosition+"px"),this.topWindow.document.body.appendChild(this.button),this.status=this.button.firstChild,this.status.style.setProperty("background-color",e),this.status.innerHTML=this.statusDetails,this.loader=this.status.nextSibling,"blue"!==this.color?(this.status.style.setProperty("display","block"),this.loader.style.setProperty("display","none")):(this.status.style.setProperty("display","none"),this.loader.style.setProperty("display","block")),this.buttonHeight=Object(r.getBoundingClientRect)(this.button).height,Object(n.isAmp)()&&teads.helper.AmpResize&&("red"===e&&(teads.helper.AmpResize.ratio=4),setTimeout(()=>this.forceAmpOpen(),1e3))}}forceAmpOpen(){if(!teads.helper.AmpResize.isVisible()){const e=setTimeout(()=>this.forceAmpOpen(),1e3);teads.helper.AmpResize.open(()=>{this.button.style.setProperty("display","none"),setTimeout(()=>this.button.style.setProperty("display","block"),100),clearTimeout(e)})}}openWigoReport(){if(window.teads.WIGO_DEBUG_KEY){this.button.onclick=e=>{e.stopPropagation()};const e=e=>{setTimeout(()=>{this.button.onclick=e=>{this.openWigoReport(),e.stopPropagation()}},500)};window.open(this.sendLogsToWigo(e))}}sendLogsToWigo(e,t=`${window.teads.WIGO_DEBUG_KEY}_${Object(s.a)()}.json`){this.logfile.logs=d.a.getFullLogs(),this.sendVastsToWigo(this.logfile.vasts);const i=Object(c.a)();return i.open("PUT",A.serviceUrl+"/livedebug/upload/"+t,!0),i.setRequestHeader("Content-Type","application/json; charset=utf-8"),i.onload=e,i.onerror=e,i.send(o.b(this.logfile,!0)),A.serviceUrl+"/livedebug?file="+t}sendVastsToWigo(e){Object(g.forEach)(Object(g.filter)(e,e=>!e.uploadedUrl),e=>{const t=`${A.serviceUrl}/livedebug/upload/${Object(p.rand)(20,!1)}.xml`,i=Object(c.a)();i.open("PUT",t,!0),i.setRequestHeader("Content-Type","application/xml; charset=UTF-8"),i.send(e.content),e.uploadedUrl=t,delete e.content})}hasInteracted(e,t,i,n){return e.scrollY!==n||e.scrollX!==i||e.screenHeight!==t.height||e.screenWidth!==t.width}}A.bottomPxInterval=80,A.recordUserActionsTiming=1e3,A.serviceUrl=location.hostname.match(/(sandbox\.teads\.net|par2\.teads\.tech|wigo|localhost)$/)?Object(l.getProtocol)()+"//"+location.hostname+":18091":"https://"+v,A.instances=[],A.initialBottomPosition=10,A.TEMPLATE=f.a;const y=({wigo:e,durationPlayed:t,totalDuration:i})=>({event:n,trackingUrls:s})=>{const r=((e,t)=>t>0?Math.floor(100*e/t):0)(t.getOrValue(0),i.getOrValue(0));e.vastEvent(n,(e=>e.map(e=>e.toFixed(2)).getOrValue(""))(t),r,Object(g.map)(s,e=>({url:e})))}},function(e,t,i){i.d(t,"a",(function(){return r}));var n=i(28),s=i(87);class r{constructor(e,t){this.className=e,this.css=t}initElement(){this.element=document.createElement("div"),this.element.className=this.className,this.element.style.setProperty("margin-bottom","0","important"),this.element.innerHTML=this.getInnerHtml()}getElement(){return this.element}getHTML(){let e=this.getInnerHtml();if(e)return`<div class="${this.className}">${e}</div>`}getCSS(){return s.a(this.css,{assetsPath:n.b.assetsUrl})}getInnerHtml(){return this.isEnabled()?this.innerHTML:""}hide(){this.element&&this.element.style.setProperty("display","none")}show(){this.element&&this.element.style.setProperty("display","block")}}},function(e,t,i){i.d(t,"a",(function(){return n}));class n{}n.READY="ready",n.ERROR="error",n.WAITING="waiting"},function(e,t,i){var n;!function(e){e[e.ERROR=-1]="ERROR",e[e.UNSTARTED=0]="UNSTARTED",e[e.WAITING=1]="WAITING",e[e.READY=2]="READY"}(n||(n={})),t.a=n},function(e,t,i){i.d(t,"a",(function(){return a}));var n=i(1),s=i(4),r=i(32);class a{constructor(){this.listeners={},this.listenersScope={}}subscribe(e,t,i){this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),this.listenersScope[t]=this.listenersScope[t]||[],this.listenersScope[t].push(i||null)}unsubscribe(e,t){if(this.listeners[t]){var i=Object(n.indexOf)(this.listeners[t],e);i>=0&&(this.listeners[t][i]=function(){})}}clearListeners(){this.listeners={},this.listenersScope={}}handleEvent(e,t){for(var i=this.listeners[e.type]||[],n=0,a=i.length;n<a;n++)try{var o=[];if(e.data)switch(e.type){case s.a.AdClickThru:o=[e.data.url,e.data.id,!!e.data.playerHandles];break;case s.a.AdLog:case s.a.AdError:case r.a.AdRemovedHeavyAdIntervention:case r.a.AdWarningHeavyAdIntervention:o="string"==typeof e.data?[e.data,null]:"object"==typeof e.data&&e.data.message?[e.data.message,e.data.id]:[String(e.data),null];break;case s.a.AdInteraction:o=[e.data.id];break;case r.a.AdVideoMetadata:o=[e.data]}i[n].apply(this.listenersScope[e.type][n],o)}catch(i){if(t)throw"failed to log error on callback: "+e.data;this.handleEvent({type:s.a.AdLog,data:"Callback #"+n+" on event "+e.type+" throws an exception: "+i},!0)}}}},function(e,t,i){var n;!function(e){e[e.JS=2]="JS",e[e.POSTMESSAGE=3]="POSTMESSAGE"}(n||(n={})),t.a=n},function(e,t,i){i.d(t,"b",(function(){return n})),i.d(t,"f",(function(){return s})),i.d(t,"e",(function(){return r})),i.d(t,"d",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return d}));const n=new RegExp("/videoplayback/id/(\\w+)/itag/"),s={xs:{className:"xs-screen",size:480},sm:{className:"sm-screen",size:640}},r=0,a=2147483647,o=[16,125,128],d=[125,128]},function(e,t,i){i.d(t,"a",(function(){return s})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a}));var n=i(1);const s=e=>Object(n.includes)([36,37,38,39],e),r=e=>Object(n.includes)([25],e),a=e=>Object(n.includes)([22,23],e)},function(e,t,i){var n;i.d(t,"a",(function(){return n})),function(e){e[e.FULL=0]="FULL",e[e.SMART=1]="SMART",e[e.NO_STREAM=2]="NO_STREAM"}(n||(n={}))},function(e,t,i){i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return r}));var n=i(2);const s=e=>e,r=e=>Object(n.isString)(e)},function(e,t,i){i.r(t),i.d(t,"toUuid",(function(){return o})),i.d(t,"bytesToUuid",(function(){return c})),i.d(t,"getUuidFromBlobUrl",(function(){return l})),i.d(t,"generateUuid",(function(){return h})),i.d(t,"getUuid",(function(){return u}));var n=i(38),s=i(0),r=i(5),a=i(69);const o=e=>e,d=[];for(let e=0;e<256;++e)d[e]=(e+256).toString(16).slice(1);function c(e,t=0){let i=t;return o([d[e[i++]],d[e[i++]],d[e[i++]],d[e[i++]],"-",d[e[i++]],d[e[i++]],"-",d[e[i++]],d[e[i++]],"-",d[e[i++]],d[e[i++]],"-",d[e[i++]],d[e[i++]],d[e[i++]],d[e[i++]],d[e[i++]],d[e[i++]]].join(""))}function l(e){const t=e.match(/blob:(.*)/),i=t?t[1]:e;return o(i.substring(i.lastIndexOf("/")+1).toLowerCase())}function h(e,t=window){return e.flatMap(e=>{const i=new t.Blob,n=e.createObjectURL(i);return e.revokeObjectURL(n),s.b.fromNullable(n)}).map(l).getOrElse(()=>c(Object(a.getRandomBytes)(16,t)))}function u(){return r.a.tryCatch(()=>{const e=Object(n.a)()?Object(n.c)():s.a;return[h(e),h(e)]}).flatMap(([e,t])=>e!==t?Object(r.e)(e):Object(r.b)(new Error("Same auctid generated twice")))}},function(e,t,i){i.d(t,"a",(function(){return n}));i(1);function n(e,t){if(t)for(var i in t)e=e.replace(new RegExp("{{"+i+"}}","g"),t[i]);return e}},function(e,t,i){i.d(t,"b",(function(){return y})),i.d(t,"e",(function(){return w})),i.d(t,"d",(function(){return E})),i.d(t,"c",(function(){return O})),i.d(t,"f",(function(){return C})),i.d(t,"a",(function(){return I}));var n=i(9),s=i(47),r=i(3),a=i(2),o=i(1),d=i(50);let c,l=0;const h=new n.a("helper.IABSafeFrame");let u,p=[];const g=[],m=[],b=[];let f,v,A;function y(){let e=function(){if(!Object(r.isIABSafeFrame)())return"not in IABSafeFrame context";if(A=Object(r.getIABSafeFrameWindow)(),Object(a.isUndefined)(A))return"IABSafeFrame window not found";if(!A.$sf.ext.geom)return"window.$sf.ext.geom not present";if(!(c=A.$sf.ext.geom()))return"window.$sf.ext.geom() return falsy value";if(!A.$sf.ext.supports)return"window.$sf.ext.supports not present"}();if(e)return h.error("init","failed",e),d.a.error("SF "+e),e;f=new s.a;const t=c.self.w;return A.$sf.ext.register(t||A.innerWidth,1,(e,t)=>function(e,t){switch(h.debug("event received",e,t),e){case"expanded":case"collapsed":case"failed":u&&u.callback&&u.callback(e),u=null,S();break;case"geom-update":"focus-update"===(null==t?void 0:t.cmd)?Object(o.forEach)(m,e=>e(t)):Object(o.forEach)(g,e=>e(t));break;case"focus-change":Object(o.forEach)(m,e=>e(t));break;case"cmpReturn":Object(o.forEach)(b,e=>e(t))}}(e,t)),h.debug("init - register (width-innerWidth-geom)",t,A.innerWidth,c),w(()=>c=A.$sf.ext.geom()),e}function w(e){const t=g.push(e);return()=>g[t-1]=()=>{}}function E(e){const t=b.push(e);return()=>b[t-1]=()=>{}}function O(e=(()=>{})){h.debug("initSlot"),0===A.innerWidth?(h.debug("initSlot - window.innerWidth=0 so wait for resize"),k(e)):1===c.self.w&&1===c.self.h?function(e){if(A.$sf.ext.supports()["exp-push"]){h.debug("initSlot - 1x1 detected - need to wait to get the slot width available");const t=()=>{h.debug("initSlot - 1x1 detected - expand available - get width"),S({name:"initial expand",action:()=>A.$sf.ext.expand({r:c.exp.r,push:!0}),callback:t=>{const i="expanded"===t;l=i?1:0,i?(v=c.exp.r,h.debug("initSlot - 1x1 detected - initial expand done - width",v),e()):(h.error("initSlot - 1x1 detected - initial expand refused"),k(e))}})};if(c.exp.r)t();else{const e=w(()=>{c.exp.r&&(e(),t())})}}else h.error("initSlot - 1x1 detected - but exp-push not supported"),k(e)}(e):e()}function C(e,t=(()=>{})){let i=e=>S({name:"open "+e,action:()=>A.$sf.ext.expand({b:e,r:v,push:!0}),callback:e=>{let i="expanded"===e;l=i?2:0,t(i)}}),n=c.self.h,s=e-n;2!==l&&s>0?A.$sf.ext.supports()["exp-push"]?s<=c.exp.b?(h.debug("open (askedHeight - currentHeight - allowed - requiredHeight)",e,n,c.exp.b,s),1===l?(h.debug("open - slot already open by init - close it before"),I(()=>{let e=Math.min(Math.floor(A.$sf.ext.geom().exp.b),s);i(e)})):i(s)):(h.debug("open not allowed (askedHeight - currentHeight - allowed - requiredHeight)",e,n,c.exp.b,s),t(!1)):(h.error("open failed - exp-push not supported"),k(()=>t(!0)),t(!1)):(h.debug("already open (askedHeight - currentHeight - requiredHeight)",e,n,s),t(!0))}function I(e=(()=>{})){0!==l?(h.debug("close"),S({name:"close",action:()=>A.$sf.ext.collapse(),callback:()=>e(!0)}),l=0):e(!0)}function S(e){e&&(h.debug("processRequest add to list",e.name),p.push(e)),!u&&p.length&&(u=p.shift(),h.debug("processRequest - process",u.name),u.action())}function T(e,t){return e>=10&&t>=10}function k(e){h.debug("wait for auto expand");const t=e=>Object(o.forEach)(e,e=>e()),i=(t,i)=>{h.debug(`slot has auto expanded with w: ${t}, h: ${i}`),l=2,e()};if(T(window.innerWidth,window.innerHeight))i(window.innerWidth,window.innerHeight);else{const e=w(()=>{T(c.self.w,c.self.h)&&(t([e,n]),i(c.self.w,c.self.h))}),n=()=>f.remove("resize");f.add("resize",A,()=>{T(window.innerWidth,window.innerHeight)&&(t([e,n]),i(window.innerWidth,window.innerHeight))})}}},function(e,t,i){i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return d}));var n=i(0),s=i(3),r=i(88),a=i(47);const o=(e,t,i)=>{const o={eventListenerManager:n.a,unlistenAmp:n.a};return Object(s.isIABSafeFrame)()?r.e(()=>e(new Event("touchmove"))):Object(s.isAmp)()?o.unlistenAmp=n.b.fromNullable(i.observeIntersection(t=>e(new Event("touchmove")))):(o.eventListenerManager=n.b.fromNullable(new a.a),o.eventListenerManager.forEach(i=>i.add("scroll",t,t=>e(t))),o.eventListenerManager.forEach(i=>i.addMultiple(["touchstart","touchmove","touchend"],t,t=>e(t)))),o},d=e=>{e.unlistenAmp.forEach(e=>e()),e.eventListenerManager.forEach(e=>e.removeAll())}},function(e,t,i){i.d(t,"a",(function(){return m}));var n=i(91),s=i(92),r=i(96),a=i(42),o=i(9),d=i(16),c=i(7),l=i(3),h=i(40),u=i(84),p=i(11),g=i(15);class m extends n.a{constructor(e,t,i,n={}){super(e,t,i),this.parameters=n,this.defaultVolume=0,this.logger=new o.a("canvas.player.CanvasPlayer"),this.audioSyncDiff=.5,this.waitForPlay=!1,this.logger.debug("constructor()",e,t,i,n.assetsPath),this.parameters.assetsPath&&this.parameters.assetsPath.match(/http:|https:/)||(this.logger.warn("assetsPath replace with default (relative path not allow)"),this.parameters.assetsPath=window.location.protocol+"//s8t.teads.tv/media/player")}load(e,t=!1,i=u.a.NO_STREAM){this.logger.debug("load()",e,t,i),e?(this.url=Object(g.s)(e),this.dispatch(c.a.LOAD_START),this.getMeta(this.url,e=>{var n=this.url.split("/");n.pop(),this.video=new a.b(n.join("/"),e,i,this),this.audio=new s.a(n.join("/"),e,i,this),this.buffer=new r.a(this),t&&this.listen(c.a.CAN_PLAY,()=>this.play()),this.buffer.show(),this.listen(c.a.CAN_PLAY,()=>this.buffer.hide()),this.listen(c.a.ENDED,()=>this.audio.release()),this.video.listen(c.a.STALLED,()=>this.dispatch(c.a.STALLED)),this.video.listen(c.a.STALLED,()=>this.pause(!0)),this.video.listen(c.a.RESUME_AFTER_STALLED,()=>this.dispatch(c.a.RESUME_AFTER_STALLED)),this.video.listen(c.a.RESUME_AFTER_STALLED,()=>this.play()),this.video.listen(c.a.TIME_UPDATE,()=>this.onVideoProgress()),this.video.listen(c.a.CAN_PLAY,()=>this.canPlayAll()),this.audio.listen(c.a.CAN_PLAY,()=>this.canPlayAll()),this.video.listen(c.a.ENDED,()=>this.dispatch(c.a.ENDED)),this.video.listen(c.a.LOADED,()=>this.dispatch(c.a.LOADED)),this.video.listen(c.a.ERROR,()=>this.dispatch(c.a.ERROR,{error:"An error occured with the video."}))})):this.video.state===p.a.PLAYING&&this.pause()}play(){this.logger.info("play()"),this.canplay()?(this.waitForPlay=!1,this.video.play(),this.audio.play(),this.dispatch(c.a.PLAY),this.dispatch(c.a.PLAYING)):this.waitForPlay||(this.waitForPlay=!0,this.dispatch(c.a.STALLED),this.dispatch(c.a.PAUSE),this.listen(c.a.CAN_PLAY,()=>{this.dispatch(c.a.RESUME_AFTER_STALLED),this.play()}))}pause(e=!1){this.video&&this.audio&&this.video.state!==p.a.ENDED?(this.video.pause(),this.audio.pause(),this.dispatch(c.a.PAUSE),this.logger.info("pause()"),e||this.video.state!==p.a.STALLED||(this.video.cleanStallTimeout(),this.buffer.hide())):(this.muteEvent(c.a.CAN_PLAY),this.waitForPlay=!1)}canplay(){return!(!this.video||!this.audio)&&(this.video.canplay()&&this.audio.canplay())}get src(){return this.url}set src(e){this.load(e,!1,u.a.FULL)}get currentTime(){return this.video?this.video.getCurrentTime():0}set currentTime(e){this.video&&(this.logger.info("set currentTime",e),this.dispatch(c.a.SEEKING),this.video.setCurrentTime(e)&&(this.audio.currentTime=e),this.dispatch(c.a.SEEKED))}get duration(){return this.video&&this.audio?this.video.duration||this.audio.duration:0}get volume(){return this.audio?this.audio.volume:0}set volume(e){if(this.logger.debug("set volume",e),this.audio){this.audio.volume=e;this.audio.canplay()&&this.video.state===p.a.PLAYING&&(()=>{this.audio.play(this.currentTime)})(),this.dispatch(c.a.VOLUME_CHANGE,{value:e})}else this.defaultVolume=e}onVideoProgress(){if(this.audio.api&&this.audio.playing()){var e=this.audio.currentTime-this.currentTime,t=Math.abs(e);t>=this.audioSyncDiff&&(e>0||this.video.meta.tv?this.video.setCurrentTime(this.audio.currentTime)||this.video.setCurrentTime(this.currentTime+this.audioSyncDiff):this.audio.currentTime=this.currentTime,this.logger.debug("sync audio (diff/audioTime)",t,this.audio.currentTime),this.dispatch(c.a.AUDIO_SYNC,{value:t}))}this.dispatch(c.a.TIME_UPDATE)}canPlayAll(){this.canplay()&&(this.dispatch(c.a.CAN_PLAY),this.dispatch(c.a.LOADED_METADATA))}getMeta(e,t){var i=Object(h.a)();i.open("GET",e.replace(/(\.mpg|\.mpeg|\.tv)(?!\/)/gi,".meta?v2"),!0),i.responseType="json",i.addEventListener("load",e=>{if(i.response){var n="string"==typeof i.response?JSON.parse(i.response):i.response;!n.tv&&(Object(l.isChromeIos)()||Object(l.isUIWebview)()||Object(l.isFacebookWebview)()||Object(l.isIpad)())?this.dispatch(c.a.ERROR,{error:"The metadata are missing."}):t(n)}else this.dispatch(c.a.ERROR,{error:"No response from the HTTPRequest, did the file exist?"})}),i.addEventListener("error",e=>{this.dispatch(c.a.ERROR,{error:"An error occured with the HTTPRequest."}),Object(d.a)(this.logger.error,this.logger)}),i.send()}}},function(e,t,i){i.d(t,"a",(function(){return l}));var n=i(68),s=i(30),r=i(7),a=i(27),o=i(9),d=i(0);const c=new o.a("Canvas");class l extends s.a{constructor(e,t,i){super(),this.container=e,this.cWidth=t,this.cHeight=i,this.totalPrintingTime=0,this.totalPrintedFrame=0,this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=i,this.canvas.style.setProperty("background","#000"),this.canvasContext=this.canvas.getContext("2d"),e.appendChild(this.canvas),this.initWebGL()}get width(){return this.cWidth}set width(e){this.cWidth=e,this.resize()}get height(){return this.cHeight}set height(e){this.cHeight=e,this.resize()}get videoHeight(){return this._videoHeight}set videoHeight(e){this._videoHeight=e}get videoWidth(){return this._videoWidth}set videoWidth(e){this._videoWidth=e}get parentNode(){return this.html5video?this.html5video.parentNode:this.canvas.parentNode}get style(){return this.html5video?this.html5video.style:this.canvas.style}useCustomDisplay(e){this.html5video=e,d.b.fromNullable(this.canvas.parentNode).forEach(t=>t.replaceChild(e,this.canvas)),this.resize()}resize(e,t){d.b.fromNullable(this.html5video).match({some:()=>this.resizeHtml5(e,t),none:()=>this.resizeCanvas(e,t)}),this.dispatch(r.a.RESIZE,{width:this.width,height:this.height})}resizeCanvas(e,t){e&&(this.canvas.width=this.decoderWidth=e),t&&(this.canvas.height=this.decoderHeight=t);let i=this.cWidth/this.canvas.width,n=this.cHeight/this.canvas.height,s=parseInt(Math.max((this.cHeight-this.canvas.height*i)/2,0).toFixed(2),10),r=parseInt(Math.max((this.cWidth-this.canvas.width*n)/2,0).toFixed(2),10),o=Math.min(i,n);Object(a.applyVendorProperties)(this.canvas,"transformOrigin","0 0"),Object(a.applyVendorProperties)(this.canvas,"transform","translateX("+r+"px) translateY("+s+"px) scale("+o+")"),e&&t&&(this.gl?(this.gl.useProgram(this.program),this.gl.viewport(0,0,e,t)):this.canvasContext&&(this.currentRGBA=this.canvasContext.getImageData(0,0,e,t),Object(a.fillArray)(this.currentRGBA.data,255)))}resizeHtml5(e,t){this.html5video.style.setProperty("width",this.width+"px"),this.html5video.style.setProperty("height",this.height+"px")}renderFrame(e){var t=Object(a.now)();this.gl?this.renderFrameGL(e):this.renderFrame2D(e),this.totalPrintingTime+=Object(a.now)()-t,this.totalPrintedFrame++}renderHtmlImageElement(e){var t=Object(a.now)();this.canvasContext&&this.canvasContext.drawImage(e,0,0),this.totalPrintingTime+=Object(a.now)()-t,this.totalPrintedFrame++}averagePrintingTime(){return this.totalPrintingTime/this.totalPrintedFrame}initWebGL(){try{this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl")}catch(e){return c.error(`Unable to get a WebGL context: "${e}"`),!1}if(!this.gl)return!1;var e=this.gl.createBuffer();if(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),this.gl.STATIC_DRAW),this.program=this.gl.createProgram(),this.gl.attachShader(this.program,this.compileShader(this.gl.VERTEX_SHADER,n.SHADER_VERTEX_IDENTITY)),this.gl.attachShader(this.program,this.compileShader(this.gl.FRAGMENT_SHADER,n.SHADER_FRAGMENT_YCBCRTORGBA)),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))throw new Error(this.gl.getProgramInfoLog(this.program));this.gl.useProgram(this.program),this.YTexture=this.createTexture(0,"YTexture"),this.CBTexture=this.createTexture(1,"CBTexture"),this.CRTexture=this.createTexture(2,"CRTexture");var t=this.gl.getAttribLocation(this.program,"vertex");return this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(t,2,this.gl.FLOAT,!1,0,0),this.loadingProgram=this.gl.createProgram(),this.gl.attachShader(this.loadingProgram,this.compileShader(this.gl.VERTEX_SHADER,n.SHADER_VERTEX_IDENTITY)),this.gl.attachShader(this.loadingProgram,this.compileShader(this.gl.FRAGMENT_SHADER,n.SHADER_FRAGMENT_LOADING)),this.gl.linkProgram(this.loadingProgram),this.gl.useProgram(this.loadingProgram),t=this.gl.getAttribLocation(this.loadingProgram,"vertex"),this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(t,2,this.gl.FLOAT,!1,0,0),!0}renderFrameGL(e){this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.YTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,e.codedWidth,this.canvas.height,0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,e.currentY),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.CBTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,e.halfWidth,this.canvas.height/2,0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,e.currentCr),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.CRTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,e.halfWidth,this.canvas.height/2,0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,e.currentCb),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}compileShader(e,t){var i=this.gl.createShader(e);if(this.gl.shaderSource(i,t),this.gl.compileShader(i),!this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS))throw new Error(this.gl.getShaderInfoLog(i));return i}createTexture(e,t){var i=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.uniform1i(this.gl.getUniformLocation(this.program,t),e),i}YCbCrToRGBA(e){for(var t,i,n,s,r,a=e.currentY,o=e.currentCb,d=e.currentCr,c=this.currentRGBA.data,l=0,h=e.codedWidth,u=e.codedWidth+(e.codedWidth-this.decoderWidth),p=0,g=e.halfWidth-(this.decoderWidth>>1),m=0,b=4*this.decoderWidth,f=4*this.decoderWidth,v=this.decoderWidth>>1,A=this.decoderHeight>>1,y=0;y<A;y++){for(var w=0;w<v;w++){t=o[p],i=d[p],p++,n=i+(103*i>>8)-179,s=(88*t>>8)-44+(183*i>>8)-91,r=t+(198*t>>8)-227;var E=a[l++],O=a[l++];c[m]=E+n,c[m+1]=E-s,c[m+2]=E+r,c[m+4]=O+n,c[m+5]=O-s,c[m+6]=O+r,m+=8;var C=a[h++],I=a[h++];c[b]=C+n,c[b+1]=C-s,c[b+2]=C+r,c[b+4]=I+n,c[b+5]=I-s,c[b+6]=I+r,b+=8}l+=u,h+=u,m+=f,b+=f,p+=g}}renderFrame2D(e){this.YCbCrToRGBA(e),this.canvasContext&&this.canvasContext.putImageData(this.currentRGBA,0,0)}}},function(e,t,i){i.d(t,"a",(function(){return l}));var n=i(30),s=i(93),r=i(95),a=i(7),o=i(3),d=i(2),c=i(21);class l extends n.a{constructor(e,t,i,n){super(),this.baseUrl=e,this.meta=t,this.stream=i,this.player=n,t.audio.length&&this.init()}authorizeAudio(e){this.api?this.api.authorizeAudio(e):e()}play(e=0){this.api&&this.api.play(e)}pause(){this.api&&this.api.pause()}get duration(){return this.api?this.api.duration:0}set currentTime(e){this.api&&(this.api.currentTime=e)}get currentTime(){return this.api?this.api.currentTime:0}get volume(){return this.api?this.api.volume:0}set volume(e){this.api&&(this.api.volume=e)}get authorized(){return!this.api||this.api.authorized}canplay(){return!this.api||this.api.canplay()}playing(){return!!this.api&&this.api.playing()}release(){this.api&&this.api.release()}init(){(Object(o.isAndroid)()||Object(c.a)(Object(o.getIosVersion)(),"9.1")&&this.meta.infos.audio_size<4e5)&&Object(d.getAudioContext)()?this.api=new s.a(this.baseUrl,this.meta,this.stream,this.player.defaultVolume):this.api=new r.a(this.baseUrl,this.meta,this.player.defaultVolume),this.api.listen(a.a.CAN_PLAY,()=>this.dispatch(a.a.CAN_PLAY))}}},function(e,t,i){i.d(t,"a",(function(){return h}));var n=i(3),s=i(16),r=i(9),a=i(2),o=i(30),d=i(7),c=i(94),l=i(11);class h extends o.a{constructor(e,t,i,o=0){super(),this.baseUrl=e,this.meta=t,this.stream=i,this.aVolume=o,this.estimatedDuration=0,this.iosReady=!1,this.logger=new r.a("canvas.player.components.Audio"),this.file=new c.a(this.baseUrl,this.meta.audio,this.stream);const h=Object(a.getAudioContext)();this.context=new h,this.file.listen(d.a.LOADED_DATA,Object(s.a)(this.oninit,this)),this.file.listen(d.a.PROGRESS,Object(s.a)(this.onloadprogress,this)),this.file.listen(d.a.LOADED,Object(s.a)(this.onload,this)),this.file.listen(d.a.CAN_PLAY,Object(s.a)(this.oncanplay,this)),this.file.state=l.a.INIT,Object(n.isIos)()&&(this.aVolume=0),this.iosReady=!Object(n.getIosVersion)()}static decodeAudioData(e,t,i,n){e.decodeAudioData(t.slice(0,t.byteLength),i,n)}authorizeAudio(e=(()=>{})){if(!this.iosReady){const t=Object(a.getAudioContext)(),i=this.context.createBuffer(1,1,44100),n=this.context.createBufferSource();n.buffer=i,n.connect(this.context.destination),n.start(0),n.disconnect(),this.context.close&&this.context.close(),this.context=new t,this.iosReady=!0,e()}}play(e=0){if(this.file.state!==l.a.PLAYING&&this.volume&&this.iosReady){if(!this.buffer)return void setTimeout(()=>this.play(e+.05),50);this.resetAudio(),this.source&&(this.noteOnAt&&!e?(this.source.start(0,this.noteOnAt/1e3),this.noteOnAt=Date.now()-this.noteOnAt):(this.noteOnAt=Date.now()-1e3*e,this.source.start(0,e))),this.file.state=l.a.PLAYING}}pause(){this.file.state!==l.a.PAUSED&&this.source&&(this.noteOnAt=Date.now()-this.noteOnAt,this.source.stop(0),this.file.state!==l.a.STALLED&&(this.file.state=l.a.PAUSED))}canplay(){return this.file.canplay()}playing(){return this.file.state===l.a.PLAYING}release(){this.context.close&&this.context.close().then(()=>{this.buffer=null,this.gainNode&&this.gainNode.disconnect&&(this.gainNode.disconnect(),this.gainNode=null),this.source&&this.source.disconnect&&(this.source.disconnect(),this.source=null)}),this.file.state=l.a.ENDED}get duration(){return this.estimatedDuration}set currentTime(e){this.file.state===l.a.PLAYING&&(this.pause(),this.noteOnAt=1e3*e,this.play())}get currentTime(){return(this.file.state===l.a.PLAYING?Date.now()-this.noteOnAt:this.noteOnAt)/1e3}get volume(){return this.aVolume}set volume(e){this.aVolume=e,this.gainNode&&(this.gainNode.gain.value=e)}get authorized(){return this.iosReady}oninit(e){this.data=e,h.decodeAudioData(this.context,e,e=>{const t=Math.ceil(this.meta.infos.audio_size/this.meta.infos.chunk_size)*e.length;this.estimatedDuration=t/e.sampleRate,this.buffer=this.context.createBuffer(e.numberOfChannels,t,e.sampleRate),this.setToMainBuffer(e)},Object(s.a)(this.logger.error,this.logger))}onloadprogress(e){e&&(this.appendFileToData(e),this.decodeData())}onload(){this.source&&this.source.buffer?this.estimatedDuration=this.source.buffer.duration:setTimeout(()=>this.onload(),50)}appendFileToData(e){const t=new Uint8Array(this.data.byteLength+e.byteLength);t.set(new Uint8Array(this.data),0),t.set(new Uint8Array(e),this.data.byteLength),this.data=t.buffer.slice(0,t.buffer.byteLength)}decodeData(){h.decodeAudioData(this.context,this.data,e=>{this.setToMainBuffer(e)},Object(s.a)(this.logger.error,this.logger))}setToMainBuffer(e){if(this.buffer)for(let t=0;t<e.numberOfChannels;t++){this.buffer.getChannelData(t).set(e.getChannelData(t),0)}}oncanplay(){this.file.state=l.a.CAN_PLAY,this.dispatch(d.a.CAN_PLAY)}resetAudio(){if(this.source)try{this.source.stop(0)}catch(e){this.logger.debug("Error when resetting audio",e)}this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.source&&(this.source.buffer=this.buffer,this.gainNode&&this.source.connect(this.gainNode)),this.gainNode&&this.gainNode.connect(this.context.destination),this.volume=this.aVolume}}},function(e,t,i){i.d(t,"a",(function(){return c}));var n=i(30),s=i(11),r=i(9),a=i(16),o=i(7),d=i(40);class c extends n.a{constructor(e,t,i){super(),this.baseUrl=e,this.chunkUrls=t,this.streamType=i,this.chunkLoaded=0,this.chunkLength=0,this.loggerF=new r.a("canvas.player.components.File"),this.chunkNumStart=1,this.chunkNumCanPlay=3,this.chunkLength=this.chunkUrls.length,this.streamLoad()}canplay(){return this.state===s.a.CAN_PLAY||this.state===s.a.PLAYING||this.state===s.a.PAUSED||this.state===s.a.LOADED||this.state===s.a.ENDED}streamLoad(){const e=this.baseUrl+"/"+this.chunkUrls.shift(),t=Object(d.a)();t.open("GET",e,!0),t.responseType="arraybuffer",t.addEventListener("load",e=>{this.chunkLoaded++,this.chunkLoaded===this.chunkNumStart?this.dispatch(o.a.LOADED_DATA,t.response):this.dispatch(o.a.PROGRESS,t.response),(this.chunkLoaded===this.chunkNumCanPlay||this.chunkLength<this.chunkNumCanPlay)&&this.dispatch(o.a.CAN_PLAY),this.chunkLoaded===this.chunkLength&&this.dispatch(o.a.LOADED),this.chunkUrls.length&&this.streamLoad()}),t.addEventListener("error",Object(a.a)(this.loggerF.error,this.loggerF)),t.send()}}},function(e,t,i){i.d(t,"a",(function(){return o}));var n=i(3),s=i(30),r=i(11),a=i(7);class o extends s.a{constructor(e,t,i=0){super(),this.baseUrl=e,this.meta=t,this.fakeVolume=i,this.touchOk=!1,this.node=document.createElement("audio"),this.node.src=this.baseUrl+"/"+this.meta.audio[0].replace(/\.mp3\.\w\w\w/gi,".mp3"),this.node.preload="auto",this.dispatch(a.a.CAN_PLAY),n.isIos()&&(this.fakeVolume=0)}authorizeAudio(e=(()=>{})){(!this.touchOk||this.node.readyState<=2)&&(this.touchOk=!0,this.node.play(),this.node.pause(),e())}play(e=0){0!==this.fakeVolume&&this.state!==r.a.PLAYING&&(this.node.readyState<=2?setTimeout(()=>this.play(e+.1),100):(e&&(this.currentTime=e),this.node.play(),this.state=r.a.PLAYING))}pause(){this.node.pause(),this.state=r.a.PAUSED}get duration(){return this.node.duration}set currentTime(e){this.node.currentTime=e}get currentTime(){return this.node.currentTime}get volume(){return this.fakeVolume}set volume(e){0===e&&this.pause(),this.fakeVolume=e,this.node.volume=e}get authorized(){return this.touchOk&&this.node.readyState>=3}canplay(){return!0}playing(){return this.state===r.a.PLAYING}release(){}}},function(e,t,i){i.d(t,"a",(function(){return a}));var n=i(7),s=i(110),r=i.n(s);class a{constructor(e){this.player=e,this.initBufferDiv(),this.player.video.listen(n.a.STALLED,()=>this.show()),this.player.video.listen(n.a.RESUME_AFTER_STALLED,()=>this.hide()),this.player.video.listen(n.a.TIME_UPDATE,()=>this.hide()),this.player.listen(n.a.RESIZE,e=>this.resize(e))}show(){this.player.container.insertBefore(this.container,this.player.html5video||this.player.canvas||null)}hide(){this.container.parentNode&&this.player.container.removeChild(this.container)}resize(e){this.container.style.setProperty("top",e.height/2-this.container.offsetHeight+"px"),this.container.style.setProperty("left",e.width/2-this.container.offsetWidth/2+"px")}initBufferDiv(){var e=document.createElement("div");e.innerHTML=a.TEMPLATE,this.container=e.firstChild}}a.TEMPLATE=r.a},function(e,t,i){i.d(t,"a",(function(){return g}));var n=i(30),s=i(11),r=i(40),a=i(27),o=i(7),d=i(3),c=i(0),l=i(35),h=i(16),u=i(2);const p=2*"frame[xxxxxx]".length;class g extends n.a{constructor(e,t,i,n){super(),this.meta=t,this.player=n,this.videoFrames=[],this.headBuffer=0,this.head=0,this.frameWait=1e3/24,this.frameRate=24,this.frameCachedLimit=24,this.reading=!1,this.decodingTime=0,this.extractTime=0,this.extractCount=0,this.load(e+"/"+t.tv)}canplay(){return this.head+this.frameCachedLimit<=this.videoFrames.length}play(){this.state!==s.a.PLAYING&&(this.state=s.a.PLAYING,this.isTickTimerStarted()||this.initTickTimer())}pause(){this.state!==s.a.STALLED&&(this.state=s.a.PAUSED)}getCurrentTime(){return this.state===s.a.INIT?0:this.head/this.frameRate}setCurrentTime(e){const t=Math.ceil(e*this.frameRate);return!!this.videoFrames[t]&&(this.head=t,this.player.renderHtmlImageElement(this.videoFrames[this.head]),!0)}get duration(){return parseFloat(this.meta.infos.duration)}get averageDecodingTime(){return this.decodingTime/this.videoFrames.length}get averageExtractTime(){return this.extractTime/this.extractCount}cleanStallTimeout(){}load(e){this.xhr=Object(r.a)(),this.xhr.open("GET",e,!0),this.xhr.responseType="text",this.xhr.onreadystatechange=Object(h.a)(this.onStateChange,this),this.xhr.onload=Object(h.a)(this.onload,this),this.xhr.send()}onStateChange(){this.xhr.responseText&&this.xhr.readyState>=3&&!this.reading&&(this.slidingWindowSize=c.b.fromNullable(this.meta.infos.maxFrameSize).filter(u.isNumber).map(e=>e+p).getOrValue(10*this.meta.infos.averageFrameSize),this.readResponseRecursive())}readResponseRecursive(){if(this.reading){const e=Object(a.now)(),t=this.xhr.responseText.substr(this.headBuffer,this.slidingWindowSize),i=new RegExp("frame\\[("+this.videoFrames.length+")\\](.*)frame\\["+(this.videoFrames.length+1)+"\\]").exec(t);if(this.extractTime+=Object(a.now)()-e,this.extractCount++,i)this.headBuffer+=7+this.videoFrames.length.toString().length+i[2].length,this.extractFrame(i);else{if(this.loaded){const e=new RegExp("frame\\[("+this.videoFrames.length+")\\](.*)").exec(t);e&&(this.headBuffer+=7+this.videoFrames.length.toString().length+e[2].length,this.extractFrame(e))}this.headBuffer>=this.xhr.responseText.length&&(this.reading=!1,this.frameCachedLimit=0)}}else this.reading=!0,this.initTickTimer()}initTickTimer(){const e=()=>{this.reading&&this.readResponseRecursive(),this.state===s.a.PLAYING&&this.loopPlay()};try{this.timer=l.c(e,1,Object(d.isAmpInABox)()||Object(d.isAmp)()||Object(d.isFacebookWebview)())}catch(t){this.tickInterval=setInterval(e,1)}}stopTickTimer(){this.timer?(this.timer.clear(),this.timer=null):this.tickInterval&&(clearInterval(this.tickInterval),this.tickInterval=null)}onload(){this.loaded=!0,this.dispatch(o.a.LOADED)}oninit(){this.state=s.a.INIT_VIDEO,this.player.resize(this.videoFrames[0].width,this.videoFrames[0].height),this.player.videoWidth=this.videoFrames[0].width,this.player.videoHeight=this.videoFrames[0].height,this.player.dispatch(o.a.LOADED_METADATA),this.player.dispatch(o.a.DURATION_CHANGE),this.player.dispatch(o.a.LOADED_DATA),this.player.renderHtmlImageElement(this.videoFrames[0])}oncanplay(){this.state===s.a.INIT_VIDEO&&(this.state=s.a.CAN_PLAY,this.dispatch(o.a.CAN_PLAY))}onstalled(){this.state=s.a.STALLED,this.dispatch(o.a.STALLED),this.listen(o.a.LOADED,()=>this.onresumestalled())}onresumestalled(){this.state===s.a.STALLED&&this.dispatch(o.a.RESUME_AFTER_STALLED)}ondecodeframe(){this.state!==s.a.ENDED&&this.dispatch(o.a.TIME_UPDATE)}onfinish(){this.state=s.a.ENDED,this.dispatch(o.a.ENDED)}extractFrame(e){const t=Object(a.now)(),i=this.videoFrames[e[1]]=new Image;i.src="data:image/jpeg;base64,"+e[2],i.onload=()=>this.decodingTime+=Object(a.now)()-t,1===this.videoFrames.length?i.onload=()=>this.oninit():this.videoFrames.length>=this.frameCachedLimit&&this.oncanplay(),this.head+this.frameCachedLimit<=this.videoFrames.length&&this.onresumestalled()}loopPlay(){if(Object(a.now)()<this.targetTime)return;this.head++;const e=this.targetTime?Math.max(-this.frameWait/2,this.targetTime-Object(a.now)()):0;this.head>=this.videoFrames.length-1?(this.loaded&&!this.reading?(this.stopTickTimer(),this.onfinish()):this.onstalled(),this.targetTime=0):this.state===s.a.PLAYING&&(this.targetTime=Object(a.now)()+this.frameWait+e),this.head&&this.videoFrames&&this.videoFrames[this.head]&&this.player.renderHtmlImageElement(this.videoFrames[this.head]),this.head%this.frameRate==0&&this.ondecodeframe()}isTickTimerStarted(){return!this.timer&&!this.tickInterval}}},function(e,t,i){i.d(t,"a",(function(){return p}));var n=i(30),s=i(11),r=i(7),a=i(3),o=i(27),d=i(6),c=i(16),l=i(42),h=i(111),u=i.n(h);class p extends n.a{constructor(e,t,i,n){super(),this.meta=t,this.player=i,this.targetTime=0,this.frameWait=1e3/24,this.frameWaitS=1/24;let r=e+"/"+t.mp4;this.authorized=!!l.a[r]||!Object(a.isMobile)()&&!Object(a.isTablet)(),this.state=s.a.INIT_VIDEO,this.load(r),this.authorized||Object(d.addEventListener)("touchstart",n,Object(c.a)(this.authorize,this));var o=document.createElement("div");o.innerHTML=p.TEMPLATE,this.player.container.appendChild(o.firstChild)}canplay(){return!0}play(){this.state!==s.a.PLAYING&&this.authorized?(this.state=s.a.PLAYING,this.loopPlay()):this.authorized||this.listen(r.a.CAN_PLAY,()=>this.play())}pause(){this.state!==s.a.STALLED&&(this.state=s.a.PAUSED,this.timer&&(clearTimeout(this.timer),this.timer=null))}getCurrentTime(){return this.video.currentTime}setCurrentTime(e){return!!(this.video.currentTime=e)}get duration(){return parseFloat(this.meta.infos.duration)}get averageDecodingTime(){return 0}get averageExtractTime(){return 0}cleanStallTimeout(){}authorize(){this.authorized||(this.video.play(),this.video.pause(),this.authorized=!0,this.oncanplay())}load(e){let t=!!l.a[e];this.video=l.a[e]=l.a[e]||document.createElement("video"),this.video.muted=!0,t||(this.video.src=e),this.player.useCustomDisplay(this.video),this.video.onload=()=>this.onload(),this.video.ontimeupdate=()=>this.ondecodeframe(),this.video.onloadedmetadata=()=>{this.player.videoWidth=this.video.videoWidth,this.player.videoHeight=this.video.videoHeight,this.player.dispatch(r.a.LOADED_METADATA),this.player.dispatch(r.a.DURATION_CHANGE),this.player.dispatch(r.a.LOADED_DATA),this.oncanplay()}}onload(){this.dispatch(r.a.LOADED)}oncanplay(){this.state===s.a.INIT_VIDEO&&this.authorized&&(this.state=s.a.CAN_PLAY,this.dispatch(r.a.CAN_PLAY))}ondecodeframe(){this.state!==s.a.ENDED&&this.dispatch(r.a.TIME_UPDATE)}onfinish(){this.pause(),this.video.currentTime=0,this.state=s.a.ENDED,this.dispatch(r.a.ENDED)}loopPlay(){if(this.video.currentTime+this.frameWaitS>this.video.duration)return this.video.currentTime=this.video.duration,this.onfinish();this.video.currentTime+=this.frameWaitS;var e=this.targetTime?Math.max(-this.frameWait/2,this.targetTime-Object(o.now)()):0;this.state===s.a.PLAYING&&(this.targetTime=Object(o.now)()+this.frameWait+e,this.timer=window.setTimeout(()=>this.loopPlay(),this.frameWait+e))}}p.TEMPLATE=u.a},function(e,t,i){i.d(t,"a",(function(){return c}));var n=i(30),s=i(11),r=i(7),a=i(6),o=i(16),d=i(42);class c extends n.a{constructor(e,t,i,n){super(),this.meta=t,this.player=i;let r=e+"/"+t.mp4;this.authorized=!!d.a[r],this.state=s.a.INIT_VIDEO,this.load(r),this.authorized||Object(a.addEventListener)("touchstart",n,Object(o.a)(this.authorize,this))}canplay(){return!0}play(){this.state!==s.a.PLAYING&&(this.state=s.a.PLAYING,this.video.play())}pause(){this.state!==s.a.STALLED&&(this.state=s.a.PAUSED,this.video.pause())}getCurrentTime(){return this.video.currentTime}setCurrentTime(e){return!!(this.video.currentTime=e)}get duration(){return parseFloat(this.meta.infos.duration)}get averageDecodingTime(){return 0}get averageExtractTime(){return 0}cleanStallTimeout(){}authorize(){this.authorized||(this.authorized=!0,this.video.play(),this.state!==s.a.PLAYING&&this.video.pause(),this.oncanplay())}load(e){this.video=d.a[e]=d.a[e]||document.createElement("video"),this.video.setAttribute("webkit-playsinline","true"),this.video.src=e,this.video.onload=()=>this.onload(),this.video.onended=()=>this.onfinish(),this.video.ontimeupdate=()=>this.ondecodeframe(),this.video.onloadedmetadata=()=>{this.player.videoWidth=this.video.videoWidth,this.player.videoHeight=this.video.videoHeight,this.player.dispatch(r.a.LOADED_METADATA),this.player.dispatch(r.a.DURATION_CHANGE),this.player.dispatch(r.a.LOADED_DATA),this.oncanplay()},this.player.useCustomDisplay(this.video)}onload(){this.dispatch(r.a.LOADED)}oncanplay(){this.state===s.a.INIT_VIDEO&&this.authorized&&(this.state=s.a.CAN_PLAY,this.dispatch(r.a.CAN_PLAY))}ondecodeframe(){this.state!==s.a.ENDED&&this.dispatch(r.a.TIME_UPDATE)}onfinish(){this.state=s.a.ENDED,this.dispatch(r.a.ENDED)}}},function(e,t,i){i.d(t,"a",(function(){return h}));var n=i(30),s=i(11),r=i(9),a=i(7),o=i(27),d=i(38),c=i(16),l=i(0);class h extends n.a{constructor(e,t,i,n){super(),this.meta=t,this.player=n,this.logger=new r.a("canvas.player.components.Video"),this.head=0,this.targetTime=0,this.decodeFinish=!1,this.benchFps=0,this.benchFpsRetained=0,this.benchFpsCount=0,this.fpsLimit=0,this.frameRate=24,this.frameStart=1,this.frameCachedLimit=24,this.videoFrames=[],this.frameWait=Math.floor(1e3/this.frameRate);const a=Object(d.b)('importScripts("'+this.player.parameters.assetsPath+'/teads-mpeg-decoder.min.js")');this.worker=Object(d.c)().map(i=>{const n=new Worker(i.createObjectURL(a));return n.onmessage=Object(c.a)(this.onmessage,this),n.postMessage(["init",e,t]),n}),this.state=s.a.INIT}canplay(){return this.state===s.a.CAN_PLAY||this.state===s.a.PLAYING||this.state===s.a.PAUSED||this.state===s.a.LOADED||this.state===s.a.ENDED}play(){this.state!==s.a.PLAYING&&(this.state=s.a.PLAYING,this.loopPlay())}pause(){this.state!==s.a.STALLED&&(this.state=s.a.PAUSED)}getCurrentTime(){return this.state===s.a.INIT?0:this.head/this.frameRate}setCurrentTime(e){var t=Math.ceil(e*this.frameRate);return!!this.videoFrames[t]&&(this.cleanFrame(this.head,t),this.head=t,!0)}get duration(){return this.decodeFinish?this.videoFrames.length/this.frameRate:parseFloat(this.meta.infos.duration)}cleanStallTimeout(){l.b.fromNullable(this.timeoutStalled).forEach(e=>{clearTimeout(e),this.timeoutStalled=null,this.state=s.a.PAUSED})}onload(){this.dispatch(a.a.LOADED),this.decodeFinish=!0}oninit(){this.benchFps=Object(o.now)(),this.state=s.a.INIT_VIDEO,this.renderFrame()}oncanplay(){this.state=s.a.CAN_PLAY,this.dispatch(a.a.CAN_PLAY)}onstalled(){this.state=s.a.STALLED,this.dispatch(a.a.STALLED),this.listen(a.a.LOADED,()=>this.onresumestalled())}onresumestalled(){this.state===s.a.STALLED&&(this.cleanStallTimeout(),this.dispatch(a.a.RESUME_AFTER_STALLED))}ondecodeframe(){this.state!==s.a.ENDED&&this.dispatch(a.a.TIME_UPDATE)}onfinish(){this.state=s.a.ENDED,this.dispatch(a.a.ENDED)}onmessage(e){switch(e.data[0]){case"frame":this.appendFrames(e.data),this.videoFrames.length===this.frameStart?this.oninit():this.videoFrames.length===this.frameCachedLimit&&this.oncanplay();break;case"initCanvas":this.player.resize(e.data[1],e.data[2]);break;case"finish":this.averageDecodingTime=e.data[1],this.onload();break;default:this.logger.debug(e.data)}}appendFrames(e){if(this.videoFrames.push({codedWidth:e[1],halfWidth:e[2],currentY:new Uint8Array(e[3]),currentCr:new Uint8Array(e[4]),currentCb:new Uint8Array(e[5])}),this.averageDecodingTime=e[6],this.benchFpsCount++,this.benchFpsCount===this.frameCachedLimit){this.benchFpsRetained=Object(o.now)()-this.benchFps;var t=Math.ceil(this.frameRate*this.benchFpsRetained/1e3);this.fpsLimit=Math.max(3,Math.min(this.frameCachedLimit,t+1))}this.state===s.a.STALLED&&this.head+this.frameCachedLimit<=this.videoFrames.length&&(this.averageDecodingTime<=1e3/this.frameRate?this.timeoutStalled||(this.logger.warn("We are stalled and have",this.frameCachedLimit,"in memory, but stalled for download, so wait",2*this.benchFpsRetained,"ms"),this.timeoutStalled=setTimeout(()=>this.onresumestalled(),2*this.benchFpsRetained),this.dispatch(a.a.BENCH_FPS,2*this.benchFpsRetained)):this.onresumestalled())}loopPlay(){this.head++;var e=this.targetTime?Math.max(-this.frameWait/2,Math.min(0,this.targetTime-Object(o.now)())):0;this.head>=this.videoFrames.length-1?(this.decodeFinish?this.onfinish():this.onstalled(),this.targetTime=0):this.state===s.a.PLAYING&&(this.targetTime=Object(o.now)()+this.frameWait,window.setTimeout(()=>this.loopPlay(),this.frameWait+e)),this.renderFrame(),this.head%this.frameRate==0&&this.ondecodeframe()}renderFrame(){this.videoFrames[this.head]&&(this.player.renderFrame(this.videoFrames[this.head]),this.videoFrames[this.head]=null,this.videoFrames.length<this.head+this.fpsLimit&&(this.benchFps=Object(o.now)(),this.benchFpsCount=0,this.worker.forEach(e=>e.postMessage(["resume"]))))}cleanFrame(e,t){for(var i=e;i<t;i++)this.videoFrames[i]=null}}},function(e,t,i){i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return r}));var n=i(58);const s=e=>Math.round(e/n.a),r=e=>e.height-s(e.width)},function(e,t,i){i.d(t,"e",(function(){return h})),i.d(t,"c",(function(){return u})),i.d(t,"d",(function(){return p})),i.d(t,"b",(function(){return g})),i.d(t,"a",(function(){return m}));var n=i(0),s=i(35),r=i(26),a=i(1),o=i(9),d=i(6),c=i(5);const l=new o.a("Format main");let h={};function u(){window.teads.instances=h={}}function p(){n.b.fromNullable(window.teads.instances).forEach(e=>h=e)}function g(){for(let e in r.b)if(r.b.hasOwnProperty(e)&&h[e]&&h[e].length)for(;h&&h[e]&&h[e].length;){const t=h[e].pop();n.b.fromNullable(t.getWigo()).forEach(e=>e.setStatus(!0,"Cleaned up")),t.close(4)}}function m(){l.warn("teads.cleanup()"),c.a.tryCatch(()=>{const e=Object(a.flatten)(Object(a.map)([".teads-inline-style","script.teads","iframe#teadsConsensu","#teadsusersync","#teads-format-css"],e=>Object(a.fromArrayLike)(document.querySelectorAll(e))));Object(a.forEach)(e,d.removeElementFromDOM),g(),delete window.teadsscript;Object(s.d)(()=>{for(const e in window.teads)window.teads.hasOwnProperty(e)&&!Object(a.includes)(["WIGO_DEBUG_KEY","FULL_LOGS"],e)&&delete window.teads[e]},3e3)}).tapLeft(e=>l.error("Error when using cleanup()",e))}},function(e,t,i){i.d(t,"a",(function(){return g})),i.d(t,"b",(function(){return b}));var n=i(0),s=i(9),r=i(2),a=i(1),o=i(17),d=i(12),c=i(108),l=i(41),h=i(33);const u=e=>e;var p=i(124);const g=new s.a("vast.VASTParser"),m=["acceptInvitation","acceptInvitationLinear","billable","click","clickIcon","close","closeLinear","collapse","complete","creativeView","customClicks","error","exitFullscreen","expand","firstQuartile","fullscreen","impression","midpoint","mute","noAd","noLinearAd","otherAdInteraction","pause","progress","resume","rewind","skip","start","thirdQuartile","unmute"];function b(e,t,i,s,m){const b=new c.a;try{const c=l.c(e,m).documentElement;if("VAST"!==c.tagName)return i(new o.b(o.b.XML_PARSE),b);b.tracking.error=b.tracking.error.concat(function(e){const t=a.map(a.fromArrayLike(e.getElementsByTagName("Error")),e=>({url:l.b(e),data:null}));return a.filter(t,e=>!!e.url)}(c)),function(e){return n.b.fromNullable(e.getElementsByTagName("Ad")[0])}(c).match({none:()=>{i(new o.b(o.b.NO_ADS),b)},some:e=>{if(b.version=function(e){return parseInt(l.a(e,"version"),10)}(c),b.version<2)return i(new o.b(o.b.UNSUPPORTED_VERSION),b);b.creativeId=function(e){return n.b.fromNullable(e.getElementsByTagName("Creative")[0]).flatMap(e=>n.b.fromNullable(l.a(e,"id")).orElse(()=>n.b.fromNullable(l.a(e,"adID"))))}(e).getOrValue("");const m=function(e){return n.b.fromNullable(e.getElementsByTagName("Linear")[0])}(e);if(!function(e){return!!e.getElementsByTagName("Wrapper").length}(e)&&m.isEmpty())return i(new o.b(o.b.LINEARITY),b);b.id=function(e){return l.a(e,"id")}(e),b.adTagUri=function(e){return n.b.fromNullable(e.getElementsByTagName("VASTAdTagURI")[0]).flatMap(e=>n.b.fromNullable(l.b(e)).map(u))}(e).map(e=>s.map(t=>(({status:e,consent:t})=>{const i=[Object(h.h)(e),...Object(h.g)(t)];return Object(h.a)(i)})(t)(e)).getOrValue(e)).getOrValue(void 0),b.title=function(e){return l.b(e.getElementsByTagName("AdTitle")[0])}(e),b.adSystem=function(e){return l.b(e.getElementsByTagName("AdSystem")[0])}(e);const A=a.map(f("ClickThrough",e),e=>Object(p.a)(e.url));b.clickThrough=b.clickThrough.concat(A),b.tracking.impression=b.tracking.impression.concat(f("Impression",e)),b.tracking.click=b.tracking.click.concat(f("ClickTracking",e)),m.forEach(e=>{const t=function(e){return n.b.fromNullable(e.getElementsByTagName("Icon")[0]).flatMap(e=>n.b.fromNullable(e.getElementsByTagName("IconClicks")[0])).map(e=>({iconClick:e,iconClickThrough:e.getElementsByTagName("IconClickThrough")[0]})).map(({iconClick:e,iconClickThrough:t})=>({clickThrough:n.b.fromNullable(l.b(t)),trackings:a.map(a.fromArrayLike(e.getElementsByTagName("IconClickTracking")),e=>({url:l.b(e),data:null}))})).getOrValue({clickThrough:n.a,trackings:[]})}(e);b.adChoicesIconClickThrough=t.clickThrough,b.tracking.clickIcon=b.tracking.clickIcon.concat(t.trackings);const i=function(e){return r.seconds(l.a(e,"skipoffset"))}(e);b.skippable=function(e){return!isNaN(e)}(i),b.skipDelay=function(e){return e||0}(i),b.duration=function(e){return r.seconds(l.b(e.getElementsByTagName("Duration")[0]))}(e),b.adParameters=function(e){return l.b(e.getElementsByTagName("AdParameters")[0])}(e);const s=function(e,t){const i=a.fromArrayLike(e.getElementsByTagName("Tracking")),s=a.filter(a.map(i,e=>{const i=l.a(e,"event");return"progress"===i?function(e,t){const i=l.a(e,"offset");return function(e,t){return Object(r.isString)(e)?e.indexOf(":")>0?n.b.fromNullable(r.seconds(e)):n.b.fromNullable(d.trim(e).match(/^([0-9\.]+)%$/)).map(e=>t*parseInt(e[1],10)/100):n.a}(i,t).map(t=>({event:"progress",tracking:{url:l.b(e),data:t}})).orElse(()=>(g.error("Wrong offset for progress tracking: "+i),n.a))}(e,t):Object(n.c)({event:i,tracking:{url:l.b(e),data:null}})}),e=>e.nonEmpty());return a.reduce(s,(e,t)=>(t.forEach(t=>{e[t.event]||(e[t.event]=[]),e[t.event].push(t.tracking)}),e),{})}(e,b.duration);for(const e in s)s.hasOwnProperty(e)&&(v(e)&&b.tracking.hasOwnProperty(e)?b.tracking[e]=b.tracking[e].concat(s[e]):g.warn(`Could not add tracking resource as the VAST event "${e}" is not supported.`));b.mediaFiles=function(e,t){const i=a.fromArrayLike(e.getElementsByTagName("MediaFile"));return a.map(i,e=>{const i=l.a(e,"type");return{type:i,url:l.b(e),width:parseInt(l.a(e,"width"),10),height:parseInt(l.a(e,"height"),10),delivery:l.a(e,"delivery"),bitrate:parseInt(l.a(e,"bitrate"),10),api:l.a(e,"apiFramework"),scalable:!!l.a(e,"scalable"),minBitrate:parseInt(l.a(e,"minBitrate"),10),maxBitrate:parseInt(l.a(e,"maxBitrate"),10),maintainAspectRatio:!!l.a(e,"maintainAspectRatio"),codec:l.a(e,"codec"),adParameters:/javascript/g.test(i)?t:null}})}(e,b.adParameters)}),b.extensions=function(e,t){const i=JSON.parse(JSON.stringify(t)),n=a.fromArrayLike(e.getElementsByTagName("Extension"));return a.map(n,e=>({type:l.a(e,"type"),content:l.b(e),xml:e,definition:i}))}(e,b),t(b)}})}catch(e){const t=o.a.get(o.b.UNDEFINED.id,"VASTParser.parse error",e);i(t,b)}}function f(e,t){const i=a.fromArrayLike(t.getElementsByTagName(e));return a.map(i,e=>({url:l.b(e),data:null}))}function v(e){return a.includes(m,e)}},function(e,t,i){i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return d}));var n=i(9),s=i(1);const r="teads-studio";function a(e){let t;return e&&e.extensions&&e.extensions.length>0&&s.forEach(e.extensions,e=>{e.type===r&&(t=d(e.content))}),t}function o(e){return!!a(e)}function d(e){try{return JSON.parse(e)}catch(e){new n.a("TeadsStudioExtension").error(r+" extension throw an exception",e)}}},function(e,t,i){i.d(t,"e",(function(){return si})),i.d(t,"a",(function(){return ri})),i.d(t,"b",(function(){return ai})),i.d(t,"c",(function(){return oi})),i.d(t,"d",(function(){return di}));var n={};i.r(n),i.d(n,"TEMPLATE",(function(){return Ct})),i.d(n,"expandTemplate",(function(){return It})),i.d(n,"inread",(function(){return St}));var s={};i.r(s),i.d(s,"Bench",(function(){return zt})),i.d(s,"ClickThrough",(function(){return qt})),i.d(s,"Extensions",(function(){return $t})),i.d(s,"Responsive",(function(){return Yt})),i.d(s,"Tracker",(function(){return Jt})),i.d(s,"AdChoices",(function(){return ei}));var r=i(61),a=i(1),o=i(0),d=i(8),c=i(9),l=i(23),h=i(2),u=i(28),p=i(3),g=i(6),m=i(85),b=i(47),f=i(10),v=i(21),A=i(12),y=i(35),w=i(15);class E{constructor(e,t,i){if(this.win=e,this.onVisible=t,this.onHidden=i,this.prefixes=["","webkit","ms","moz"],this.props=["VisibilityState","visibilitychange","Hidden"],this.isInitialState=!0,this.enabled=!0,this.isAmpVisible=!0,this.windows=[],E.logger.debug("init"),this.eventListenerManager=new b.a,p.isAmp()){E.logger.debug("Init AMP visibility plugin");let e=e=>{window.context&&(window.context.hidden&&this.isAmpVisible?(E.logger.debug("AMP visibility, window is hidden, call hidden callback"),this.isAmpVisible=!1,this.onHiddenCallback()):window.context.hidden||this.isAmpVisible||(E.logger.debug("AMP visibility, window is visible, call visibile callback"),this.isAmpVisible=!0,this.onVisibleCallback()))};this.eventListenerManager.add("amp:visibilitychange",window,e)}else if(p.isIABSafeFrame()){let e,t=!0;this.intervalIABSafeFrame=setInterval(()=>{e=this.isVisible(),e&&!t?(t=!0,this.onVisibleCallback()):!e&&t&&(t=!1,this.onHiddenCallback())},500)}else this.prefix=this.getPrefix(),this.addWindow(this.win),this.visibleWindow=this.win}static listenWindow(e,t,i){return new E(e,t,i)}destroy(){try{if(p.isAmp())return void this.eventListenerManager.remove("amp:visibilitychange");p.isIABSafeFrame()&&clearInterval(this.intervalIABSafeFrame),clearInterval(this.intervalFocus),this.eventListenerManager.removeAll(),a.forEach(this.windows,e=>{e.focus(),this.removeWindow(e,!1)}),E.logger.debug("destroy")}catch(e){E.logger.error("Visibility could not be fully destroyed.",e)}finally{this.disable(),this.windows=[]}}enable(){this.enabled=!0}disable(){this.enabled=!1}isEnabled(){return this.enabled}isVisible(){let e;if(p.isAmp())e=this.isAmpVisible;else if(p.isIABSafeFrame()){const t=p.getIABSafeFrameWindow();e=!Object(h.isUndefined)(t)&&t.$sf.ext.winHasFocus?t.$sf.ext.winHasFocus():!document.hidden}else e=!!this.visibleWindow;return e}addWindow(e){-1===a.indexOf(this.windows,e)&&(this.windows.push(e),this.addListener(e,()=>this.setWindowVisible(e),()=>this.setWindowHidden(e)))}removeWindow(e,t=!0,i=!0){if(a.indexOf(this.windows,e)>-1){var n=this.isVisible();i&&this.windows.splice(a.indexOf(this.windows,e),1),t&&n&&!this.isVisible()&&this.onHiddenCallback()}}getWindows(){return this.windows}addListener(e,t,i){try{const r=e.document;if(this.prefixesSupported(r)){const e=()=>{r[this.getPrefixedMethodName(this.props[2])]?i():t()};this.eventListenerManager.add(this.getPrefixedMethodName(this.props[1]),r,e)}else if(r.hasFocus)E.logger.debug("Add listener on hasFocus method with an interval of 100ms"),clearInterval(this.intervalFocus),this.intervalFocus=setInterval(()=>{r.hasFocus()?t():i()},100);else{const r=f.findAllWindows(this.win.document.body,!0);a.forEach(r,e=>{this.addWindow(e)}),E.logger.debug("Add listener on focus and blur events");var n=e=>{E.logger.debug("Exec callback visible"),t()},s=t=>{E.logger.debug("Exec callback hidden"),e===t.target&&i()};e.tt_visibility_visible=n,e.tt_visibility_hidden=s,e.hasOwnProperty("onpageshow")&&(this.eventListenerManager.add("pageshow",e,e=>{E.logger.debug("pageshow event received"),n()}),this.eventListenerManager.add("pagehide",e,e=>{E.logger.debug("pagehide event received"),s(e)})),this.eventListenerManager.add("focus",e,e=>{E.logger.debug("focus event received"),clearTimeout(this.eventTimeout),n()}),this.eventListenerManager.add("blur",e,e=>{E.logger.debug("blur event received"),this.eventTimeout=setTimeout(()=>{s(e)},10)})}}catch(e){}}setWindowVisible(e){this.isInitialState||this.isVisible()||(this.visibleWindow=e,E.logger.debug("onVisible callback exec"),this.onVisibleCallback())}setWindowHidden(e){this.isInitialState=!1,p.isIABSafeFrame()&&this.isVisible()||this.isVisible()&&(this.visibleWindow=null,E.logger.debug("onHidden callback exec"),this.onHiddenCallback())}onVisibleCallback(){this.enabled&&this.onVisible()}onHiddenCallback(){this.enabled&&this.onHidden()}getPrefixedMethodName(e,t){return o.b.fromNullable(t).orElse(()=>o.b.fromNullable(this.prefix)).match({some:t=>t+e,none:()=>e.toLowerCase()})}getPrefix(e){e||(e=window.document);for(let t=0,i=this.prefixes.length;t<i;t++){const i=this.getPrefixedMethodName(this.props[2],this.prefixes[t]);if(null!==e[i]&&void 0!==e[i])return this.prefixes[t]}}prefixesSupported(e){if(p.isDesktop())return!1;let t=!1;return a.forEach(this.props,i=>{t=t||this.getPrefixedMethodName(i,this.prefix)in e}),t}}E.logger=new c.a("Visibility");var O=i(76),C=i(83),I=i(77),S=i(16),T=i(137),k=i.n(T),j=i(138),P=i.n(j),L=i(143),x=i.n(L),V=(i(144),i(145)),N=i.n(V),D=i(146),_=i.n(D),R=(i(147),i(148),i(149),i(150)),M=i.n(R),F=i(151),U=i.n(F),B=i(29);class W extends I.a{constructor(e){super("teads-ui-components-adchoices",x.a),this.getVpaidAd=e,this.innerHTML="<span>AdChoices</span>",this.initElement(),p.isMobile()||(g.addEventListener("mouseover",this.getElement(),Object(S.a)(this.onMouseOver,this)),g.addEventListener("mouseout",this.getElement(),Object(S.a)(this.onMouseOut,this))),g.addEventListener("click",this.getElement(),Object(S.a)(this.onClick,this))}onMouseOver(){f.addClass(this.getElement(),"expanded")}onMouseOut(){f.removeClass(this.getElement(),"expanded")}onClick(){this.getVpaidAd().forEach(e=>e.dispatchCustomEvent(B.a.AdChoicesClickRequest))}isEnabled(){return!0}}class H extends I.a{constructor(e){super("teads-ui-components-hpl",N.a);const t=e.match({some:e=>"&auctid="+e,none:()=>""});this.innerHTML=`<a href="https://t.teads.tv/track?action=hpl-register${t}"></a>`,this.initElement()}isEnabled(){return!0}}class z extends I.a{constructor(e){super("teads-ui-components-credits",k.a),this.config=e;let t=this.config.getText().replace(/\[([^\]]*)\]/g,'<span class="teads-ui-components-credits-colored">$1</span>'),i=this.config.getLink()||"https://hp.teads.com/?utm_source=inread&utm_medium=credits&utm_campaign=invented%20by%20teads";this.innerHTML=`<a href="${i}" rel="nofollow" target="_blank">${t}</a>`,this.initElement()}isEnabled(){return this.config.isEnabled()}}class G extends I.a{constructor(e){super("teads-ui-components-label",P.a),this.label=e,this.innerHTML=this.label.getText(),this.initElement()}isEnabled(){return this.label.isEnabled()}}class q extends I.a{constructor(){super("close-button icon-close",""),this.WIDTH_WHEN_VISIBLE=11,this.eventListenerManager=new b.a,this.innerHTML="",this.initElement(),this.eventListenerManager.add("click",this.getElement(),e=>this.onClick(e))}isEnabled(){return!0}hide(){this.element&&this.element.style.setProperty("width","0")}show(){this.element&&this.element.style.setProperty("width",this.WIDTH_WHEN_VISIBLE+"px")}onClick(e){Object(h.isFunction)(this.onClickAction)&&this.onClickAction()}}var K=i(4);function $(e){const t=Number(e.getAdDuration()),i=e.getAdRemainingTime()>0?e.getAdRemainingTime():t;return t>0?t-i:0}function Y(e){return!(e.getAdVolume()>0)}var X=i(80);class Q{constructor(e,t,i,n,s){if(this.ui=e,this.element=t,this.vpaid=i,this.config=n,this.globalVpaidEventHandler=s,this.eventHandler=new X.a,this.showOnVideoStart=!0,this.isCountdownEnded=!1,n.style){var r=t.getAttribute("style");t.setAttribute("style",(r?r+";":"")+n.style)}let a=new RegExp("teads-ui-component-([a-z]*)"),o=t.className.match(a);this.id=o&&o[1]?o[1]:"",this.logger=new c.a("teads.ui.Component"+(this.id?"."+this.id:"")),t.style.zIndex||t.style.setProperty("z-index","2"),this.hide(),this.vpaid.subscribe(()=>{this.onVideoStart()},K.a.AdVideoStart);const d=n.startOffset;if(!Object(h.isUndefined)(d)&&d>0){this.showOnVideoStart=!1;const e=()=>{$(this.vpaid)>=d&&(this.vpaid.unsubscribe(e,K.a.AdRemainingTimeChange),this.isCountdownEnded=!0,this.isEnabled()&&this.show())};this.vpaid.subscribe(e,K.a.AdRemainingTimeChange)}else this.isCountdownEnded=!0;this.bindClick()}init(){}setShowOnVideoStart(e){this.showOnVideoStart=e}getShowOnVideoStart(){return this.showOnVideoStart}getConfig(){return this.config}isEnabled(){return!this.config.disable}getElement(){return this.element}show(){this.isCountdownEnded&&(f.removeClass(this.getElement(),"hide"),f.addClass(this.getElement(),"show"))}hide(){f.removeClass(this.getElement(),"show"),f.addClass(this.getElement(),"hide")}isVisible(){return this.getElement().className.indexOf("show")>-1}getVpaid(){return this.vpaid}subscribe(e,t,i){this.eventHandler.subscribe(e,t,i)}unsubscribe(e,t){this.eventHandler.unsubscribe(e,t)}getOverridenEvents(){return[]}getOverridenMethods(){return[]}restoreOnClickAction(){}onMethod(e,t=[]){}onOverridenMethod(e,t=[]){}remove(){o.b.fromNullable(this.getElement().parentNode).forEach(e=>e.removeChild(this.getElement()))}onVideoStart(){this.showOnVideoStart&&this.show()}dispatchVpaidEvent(e,t){if(this.globalVpaidEventHandler)try{this.globalVpaidEventHandler({type:e,data:t})}catch(i){this.logger.error("error calling dispatchVpaidEvent "+e,t)}else this.logger.error("no globalVpaidEventHandler given. Dispatch "+e+" failed",t)}bindClick(){g.addEventListener("click",this.getElement(),e=>{this.onClick(e)})}onClick(e){this.dispatchUiEvent(this.eventName)}dispatchUiEvent(e){e&&(this.logger.info("dispatch UI event "+e),this.dispatchVpaidEvent(e))}}class J extends Q{constructor(){super(...arguments),this.lastVolume=1}init(){this.isMuted=Y(this.vpaid),this.eventName=B.a.SoundToggleRequest,this.vpaid.subscribe(()=>{this.isMuted=Y(this.vpaid),this.onMuteChange()},K.a.AdStarted),this.vpaid.subscribe(()=>{this.isMuted=Y(this.vpaid)},K.a.AdVideoStart),this.vpaid.subscribe(()=>{this.hide()},K.a.AdStopped),this.ui.subscribe(()=>{this.hide()},B.a.EndscreenInit),this.vpaid.subscribe(()=>{(!this.isMuted&&Y(this.vpaid)||this.isMuted&&!Y(this.vpaid))&&(this.lastVolume=Y(this.vpaid)?this.lastVolume:this.vpaid.getAdVolume(),this.isMuted=Y(this.vpaid),this.onMuteChange())},K.a.AdVolumeChange),this.onMuteChange(),super.init()}onMuteChange(){f[Y(this.vpaid)?"addClass":"removeClass"](this.getElement(),"muted")}setAdVolume(){this.vpaid.setAdVolume(this.isMuted?this.lastVolume:0)}onClick(e){super.onClick(e),this.setAdVolume(),this.isMuted=!this.isMuted,this.onMuteChange()}}class Z{}Z.OFF="icon-muteoff",Z.ON="icon-muteon";class ee extends I.a{constructor(){super("teads-ui-components-smart-header",M.a),this.isMuted=!0,this.eventListenerManagerAdChoices=new b.a,this.eventListenerManagerSound=new b.a,this.innerHTML=U.a}init(e,t){this.vpaidAd=e,this.volumeController=t,this.initElement(),this.hide(),this.smartCloseButton=new q,this.closeButtonContainer=this.element.getElementsByClassName("close-button-smart")[0],this.closeButtonContainer.appendChild(this.smartCloseButton.getElement()),this.hideCloseButton();const i=this.element.getElementsByClassName("adChoices-button-smart")[0];this.eventListenerManagerAdChoices.add("click",i,()=>this.onClickAdChoicesButton()),this.smartSoundButton=this.element.getElementsByClassName("sound-button-smart")[0],this.eventListenerManagerSound.add("click",this.smartSoundButton,()=>this.onClickSoundButton()),this.vpaidAd.subscribe(()=>this.onVolumeChange(),K.a.AdVolumeChange)}showCloseButton(){this.closeButtonContainer.style.setProperty("display","inline-block"),y.b(()=>this.smartCloseButton.show())}hideCloseButton(){this.closeButtonContainer.style.setProperty("display","none"),this.smartCloseButton.hide()}isEnabled(){return!0}toggleSoundButtonIcon(){const e=this.smartSoundButton.firstElementChild,t=this.isMuted?Z.OFF:Z.ON,i=this.isMuted?Z.ON:Z.OFF;Object(f.replaceClass)(e,t,i)}onClickSoundButton(){this.volumeController.toggleVolume()}onClickAdChoicesButton(){this.vpaidAd.dispatchCustomEvent(B.a.AdChoicesClickRequest)}onVolumeChange(){this.isMuted=Y(this.vpaidAd),this.toggleSoundButtonIcon()}}class te{constructor(e){this.components=e}getComponent(e){return this.components.hasOwnProperty(e)?this.components[e]:null}getComponents(){return this.components}showComponent(e){this.components.hasOwnProperty(e)&&this.components[e].show()}hideComponent(e){this.components.hasOwnProperty(e)&&this.components[e].hide()}showAllComponents(){for(let e in this.components)this.components.hasOwnProperty(e)&&this.components[e].show()}hideAllComponents(){for(let e in this.components)this.components.hasOwnProperty(e)&&this.components[e].hide()}}var ie=i(87),ne=i(153),se=i.n(ne),re=i(154),ae=i.n(re);function oe(e,t,i){o.b.fromNullable(null==t?void 0:t.document).forEach(t=>{if(!t.getElementById(i)){const n=ie.a(e,{assetsPath:u.b.assetsUrl}),s=t.createElement("style");s.setAttribute("id",i),s.setAttribute("class","teads-inline-style"),s.appendChild(t.createTextNode(n)),t.head.appendChild(s)}})}var de=i(140),ce=i(135);class le{constructor(){this.lastUserInteractionSound=0,this.cursorCoords={x:0,y:0},this.currentVolume=0,this.muteCallbacks=[],this.unmuteCallbacks=[],this.eventListenerManager=new b.a}init(e){this.abstractFormat=e,this.vpaidAd=e.getVpaidAd(),this.formatConfig=e.formatConfig,this.formatConfig.soundStart.isMute()?this.hasStarted=!1:this.formatConfig.soundStart.isUnmute()?this.hasStarted=!0:this.formatConfig.soundStart.isCountdown()&&(this.hasStarted=!1)}getVolume(){return-1===this.vpaidAd.getAdVolume()?this.currentVolume:this.vpaidAd.getAdVolume()}setVolume(e){this.getVolume()!==e&&(this.currentVolume=e,this.vpaidAd.setAdVolume(e))}toggleVolume(){if(this.getVolume()>0)this.mute(),this.lastUserInteractionSound=1,a.forEach(this.muteCallbacks,e=>e());else{let e=this.formatConfig.volume.getMain();this.setVolume(e),this.lastUserInteractionSound=2,a.forEach(this.unmuteCallbacks,e=>e())}}userAlreadyInteracted(){return 0!==this.lastUserInteractionSound}startAt(e){let t=()=>{this.vpaidAd.getAdDuration()-this.vpaidAd.getAdRemainingTime()>=e&&(this.vpaidAd.unsubscribe(t,K.a.AdRemainingTimeChange),this.hasStarted||(this.hasStarted=!0,this.setVolume(this.formatConfig.volume.getMain())))};this.vpaidAd.subscribe(t,K.a.AdRemainingTimeChange)}mute(){this.setVolume(0)}isMuted(){return 0===this.getVolume()}onAdVideoStart(){this.formatConfig.soundStart.isUnmute()?this.setVolume(this.formatConfig.volume.getMain()):this.formatConfig.soundStart.isCountdown()?this.startAt(this.formatConfig.soundStart.getCountdown()):this.setVolume(0)}replay(){let e=Object(g.getBoundingClientRect)(this.abstractFormat.parentContainer);Object(p.isDesktop)()&&(this.cursorCoords={x:Math.floor(e.left+e.width/2),y:Math.floor(e.top+e.height/2)},this.eventListenerManager.add("mousemove",this.abstractFormat.placement.placementConfig.parentWindow.getWindow().document.body,e=>{this.cursorCoords={x:e.clientX,y:e.clientY}}))}startInView(){if(!this.userAlreadyInteracted()){this.formatConfig.soundMute.isThreshold()&&this.hasStarted&&(this.formatConfig.soundStart.isCountdown()||this.formatConfig.soundStart.isUnmute())&&this.setVolume(this.formatConfig.volume.getMain())}}endInView(){!this.userAlreadyInteracted()&&this.formatConfig.soundMute.isThreshold()&&this.hasStarted&&this.setVolume(0)}addMuteCallback(e){a.indexOf(this.muteCallbacks,e)<0&&this.muteCallbacks.push(e)}addUnmuteCallback(e){a.indexOf(this.unmuteCallbacks,e)<0&&this.unmuteCallbacks.push(e)}}var he=i(102),ue=i(117),pe=i(73),ge=i(62),me=i(88),be=i(89),fe=i(119),ve=i(20),Ae=i(34),ye=i(65),we=i(59),Ee=i(106),Oe=i(32),Ce=i(14),Ie=i(5);const Se=e=>({height:t})=>Object(d.a)(e=>Object(a.map)(e,e=>g.getBoundingClientRect(e.getElement()).height),e=>Object(a.reduce)(e,(e,t)=>e+t,t))(e);class Te{constructor(e,t,i,n,s,r,a){this.placement=e,this.formatConfig=t,this.player=i,this.markId=n,this.auctionId=s,this.viewerId=r,this.sumologicLogger=a,this.states={hasOpened:!1,isReady:!1,hasRequestedStartAd:!1,hasStarted:!1,hasStopped:!1,hasCompleted:!1,isReplay:!1,isPlaying:!1,isCollapsed:!1,shouldBePaused:!1,hasFiredViewabilityEvent:!1},this.hasMoatExtension=!1,this.adWidth=0,this.adHeight=0,this.adDuration=-2,this.adRemainingTime=NaN,this.isVertical=!1,this.realVisibilityInterval=o.b.empty(),this.wigo=o.b.empty(),this.initAdTimingMark=o.b.empty(),this.customTrackingsFromTtcAdded=!1,this.trackHeavyAdInterventionWarning=e=>{const{sumologicLogger:t,logger:i,auctionId:n,viewerId:s,slotType:r,placement:{key:a,wigo:o,pageId:d,pid:c,placementConfig:{headerBiddingProvider:l}},formatConfig:{portfolioItemId:h,insertionId:u,connectionId:p,adSourceId:g,dspCampaignId:m,dspCreativeId:b,scenarioId:f}}=this,{studioCreativeId:v}=Object(Ce.f)(a);Object(Ae.y)({sumologicLogger:t,wigo:o,logger:i,placementKey:a})({headerBiddingProvider:l,pageId:d,placementId:c,slotType:r,auctionId:n,viewerId:s,insertionId:u,connectionId:p,portfolioItemId:h,adSourceId:g,creativeId:String(this.linearAd.creativeId),dspCampaignId:m,dspCreativeId:b,scenarioId:f,studioCreativeId:v,errorCause:"HeavyAdIntervention "+e})},this.logger=new c.a("format"),this.logger.debug("new",t.formatName.get()),this.linearAd=this.player?this.player.getLinearAd():null,this.hasMoatExtension=!!this.player&&this.player.hasMoatExtension(this.linearAd),pe.i(this.linearAd),this.slotType=this.placement.slotType,this.parentContainer=this.placement.getParentContainer(),this.playerContainer=this.placement.getPlayerContainer(),this.win=e.placementConfig.parentWindow.getWindow(),this.eventListenerManager=new b.a,this.volumeController=new le,this.viewabilityTagsHelper=new ce.a(this.sumologicLogger,this.formatConfig.adType,this.win,Object(o.c)({parentContainer:this.parentContainer,playerContainer:this.playerContainer})),this.initComponents(),this.vpaidApi=this.player.getConfig().vpaidApi}setWigo(e){this.wigo=o.b.fromNullable(e)}getWigo(){return this.wigo.getOrNull()}initComponents(){if(!this.placement.getElectedSlot())return void this.logger.debug("Could not init components because no elected slot");const e=new G(this.formatConfig.label),t=new z(this.formatConfig.credits),i=new H(this.auctionId),n={label:e,credits:t,honeyPotLink:i};if(this.shouldInstanciateSmartHeader()&&(n.smartHeader=new ee),!this.placement.isSliderEnabled()){n.adChoices=new W(()=>o.b.fromNullable(this.getVpaidAd()));const e=this.formatConfig.formatName.isInBoard()||this.formatConfig.smartPosition.isTop()||this.formatConfig.smart6Behavior.isTop()||!this.formatConfig.label.isEnabled()?0:1;1===e&&this.playerContainer.parentNode.insertBefore(n.adChoices.getElement(),this.playerContainer),o.b.fromNullable(this.player).forEach(t=>t.getConfig().adChoicesIconLocation=e)}this.components=new te(n),(e=>{for(const t in e)o.b.fromNullable(e[t]).filter(e=>!!e.getHTML()).filter(e=>!!e.getCSS()).forEach(e=>oe(e.getCSS(),Object(f.getWindow)(this.parentContainer),"teads-inline-"+Object(A.rand)(5)))})(n),e.getHTML()&&!this.placement.isSliderEnabled()&&this.playerContainer.parentNode.insertBefore(e.getElement(),this.playerContainer),t.getHTML()&&!this.placement.isSliderEnabled()&&this.playerContainer.parentNode.appendChild(t.getElement()),this.playerContainer.parentNode.appendChild(i.getElement()),this.placement.placementConfig.css.applyRulesOn(this.parentContainer)}getBrandingMode(){return this.brandingMode}getTemplateName(){throw new Error("getTemplateName must be implemented in child class")}getVpaidAd(){return this.vpaidAd}getVolumeController(){return this.volumeController}getFullscreenHelper(){return this.fullscreenHelper}exit(e){switch(this.vpaidAd&&this.vpaidAd.stopAd(),this.smartPositionHelper&&this.smartPositionHelper.disableBehavior(),this.eventListenerManager.removeAll(),this.scrollListener&&Object(be.b)(this.scrollListener),this.vpaidApi&&this.vpaidApi.close(),this.responsive&&this.responsive.unsetResponsive(),this.parentContainer&&this.parentContainer.parentNode&&y.d(()=>{this.parentContainer&&this.parentContainer.parentNode&&(this.parentContainer.parentNode.removeChild(this.parentContainer),this.unsetVisibility())},2e3),e){case 4:this.logger.info("Format successfully exited after displaying an ad");break;case 5:this.logger.info("Format successfully exited without displaying an ad");break;case 6:this.logger.info("Format successfully exited because the VAST contains a MOAT extension while the player is hidden by CSS");break;case 1:this.logger.error("Format exited with an ad error");break;case 2:this.logger.error("Format exited due to resize denied on opening by AMP framework");break;case 3:this.logger.error("Format exited due to an exception thrown during replay");break;default:this.logger.warn("Format exited with unknown status")}if(window.location.hostname!==O.a){let e=he.e[this.formatConfig.formatName.get()];for(let t=0,i=e.length;t<i;t++)if(e[t]===this){e.splice(t,1);break}}p.isAmp()&&(5!==e?pe.a():this.placement.placementConfig.fallback.hasValue()||(pe.a(),pe.h())),p.isIABSafeFrame()&&me.a()}getCurrentTime(){return this.adDuration>0&&this.adRemainingTime>=0?this.adDuration-this.adRemainingTime:0}getEnvironmentVars(){return o.b.fromNullable(this.vpaidAd).flatMap(e=>e.getTeadsEnvironmentVars()).getOrValue({})}load(e,t){const i=e=>{this.logger.error("VPAID play:",e);const{cid:i,studioCid:n}=this.getCidAndStudioCid();this.sumologicLogger.error(`loading-mediafile cid=${i} scid=${n} ${Object(ge.b)(e)}`),t&&t(e)},n=(t,i)=>{this.vpaidAd=t,this.initAdConfig=i,e&&(this.formatConfig.callbacks.trigger("adAvailable"),e()),this.sumologicLogger.info(ye.a.getMediaFileRatioLog(this.player.getMediafile(),this.placement.pid,o.b.fromNullable(this.formatConfig.adSourceId)))},s=Object(C.c)(this.formatConfig.portfolioItemId)?()=>!0:e=>this.placement.placementConfig.allowedRatio.mediafileRatioIsValid(e,ye.a.getRatio);!this.player&&e?e():this.mediafile?this.player.loadMediaFile(this.mediafile,n,i):this.player.loadOptimalMediaFile(n,i,s)}close(e){this.states.hasStopped||(this.states.hasStopped=!0,!this.states.hasOpened||v.c(p.getIEVersion(),"9")||p.isAmp()||this.states.isCollapsed?(this.collapse(),this.exit(e)):(this.eventListenerManager.addMultiple(["transitionend","otransitionend","oTransitionEnd","webkitTransitionEnd"],this.parentContainer,()=>this.exit(e)),this.collapse()))}collapse(){this.states.isCollapsed||(this.states.isCollapsed=!0,this.components.hideAllComponents(),this.formatConfig.animations.setCollapseDuration(this.parentContainer),this.parentContainer.style.setProperty("height","0"))}start(){this.customTrackingsFromTtcAdded||(this.customTrackingsFromTtcAdded=!0,this.addCustomTracking(window._ttc)),this.logger.debug("VPAID started",this.vpaidAd,this.initAdConfig),this.mediafile=this.player.getMediafile(),this.onVpaidReady(),(Object(C.a)(this.formatConfig.portfolioItemId)||this.formatConfig.friendly)&&(Object(f.makeIframeIABFriendly)(this.vpaidAd.getContainer()),Object(f.makeIframeIABFriendly)(this.vpaidAd.getCreativeContainer())),this.initAdTimingMark=o.b.of(Object(l.l)()),Object(l.i)({name:"m",id:this.markId}),this.vpaidAd.initAd(this.initAdConfig.width,this.initAdConfig.height,this.initAdConfig.mode,this.initAdConfig.bitrate,this.initAdConfig.parameters)}onAdLoaded(){this.states.isReady=!0;!function(e){const t=[];for(const i in e)e.hasOwnProperty(i)&&t.push(Object.assign({hostname:i},e[i]));window.teads.vastDomains=t}(function(e,t){const i={},n=(e,t)=>{i[e]||(i[e]={origins:[t],count:0}),i[e].count++,a.includes(i[e].origins,t)||i[e].origins.push(t)};a.forEach(e.mediaFiles,e=>n(Object(w.p)(e.url).hostname,"mediafile")),a.forEach(e.wrappers,e=>n(Object(w.p)(e).hostname,"wrapperurl")),e.url&&n(Object(w.p)(e.url).hostname,"vasturl");for(const t in e.tracking)e.tracking.hasOwnProperty(t)&&a.forEach(e.tracking[t],e=>n(Object(w.p)(e.url).hostname,"tracking"));return a.forEach(e.extensions,e=>{switch(e.type){case we.a.MOAT_JS:n(("https:"===Object(h.getProtocol)()?"z":"js")+".moatads.com","extension");break;case we.a.AD_VERIFICATIONS:const i=t.getPlugin("Extensions").retrieveCreativePrefetchAdVerificationScriptUrls(e);a.forEach(i,({url:e})=>n(Object(w.p)(e).hostname,"extension"))}}),i}(this.linearAd,this.player)),p.isAmp()&&!pe.e()&&(this.sumologicLogger.info("AMP resize open request"),pe.g(),pe.f(this.vpaidApi.adMetadata.map(Se([this.components.getComponent("label"),this.components.getComponent("credits")])).getOrElse(()=>this.fitContainerToContent(!0)),e=>{if(e)this.initInternalResponsive();else{this.close(2),Object(be.b)(this.scrollListener);const e="AMP resize open request denied";this.sumologicLogger.info(e),this.logger.info("AdLoaded",e),this.wigo.forEach(t=>t.valid(3,4,e,"error"))}},()=>{let e=window._teads_amp.change;return!(e.boundingClientRect.top>=e.rootBounds.height)})),this.volumeController.mute(),this.updateAdSize(),this.vpaidAd.render(this.vpaidAd.getVPAID()),Object(l.i)({name:"n",id:this.markId}),this.sumologicLogger.info(Object(l.f)("al",this.markId)),this.sumologicLogger.info(Object(l.f)("ar2al",this.markId))}onAdVideoStart(){this.states.hasCompleted=!1,this.states.isPlaying=!0,this.volumeController.onAdVideoStart()}onAdStarted(){this.states.hasStarted=!0,this.vpaidApi.getStudioData()?this.brandingMode.deinit():this.brandingMode.init(),this.volumeController.mute(),this.updateAdSize(),this.states.shouldBePaused&&this.requestPauseAd(),Object(l.i)({name:"p",id:this.markId}),this.sumologicLogger.info(Object(l.f)("as",this.markId))}onAdPaused(){this.states.isPlaying=!1}onAdPlaying(){this.states.isPlaying=!0}onAdStopped(){this.states.isPlaying=!1,this.close(4)}onAdSkipped(){this.collapse()}onAdVideoComplete(){this.states.hasCompleted=!0}onAdError(e){var t,i;const n=Object(h.isString)(e)?e:Object(ge.a)(e),s=null!==(i=null===(t=this.player.getLinearAd())||void 0===t?void 0:t.id)&&void 0!==i?i:-1,{cid:r,studioCid:a}=this.getCidAndStudioCid();this.sumologicLogger.error(`aderror aid=${s} cid=${r} scid=${a} ${n}`),this.logger.error("AdError: ",n),this.close(1)}onAdSizeChange(){this.updateAdSize()}onAdRemainingTimeChange(){this.adRemainingTime=this.vpaidAd.getAdRemainingTime()}onAdDurationChange(){this.adDuration=this.vpaidAd.getAdDuration(),this.onAdRemainingTimeChange()}onCollapseRequest(){this.formatConfig.callbacks.trigger("CollapseRequest"),this.collapse()}onSoundToggleRequest(){const e=this.getEnvironmentVars();e.videoSlot&&e.videoSlot.audio&&!e.videoSlot.audio.authorized?e.videoSlot.audio.authorizeAudio(()=>this.volumeController.toggleVolume()):this.volumeController.toggleVolume()}onReplayRequest(){this.replay()}onEndscreenInit(){this.getInViewState()||(this.logger.debug("The video completed but it's not in view, pause it."),this.requestPauseAd()),this.visibility&&!this.visibility.isEnabled()&&(this.visibility.enable(),this.visibility.isVisible()||this.onHidden())}onEarlyClick(){const{sumologicLogger:e,logger:t,auctionId:i,viewerId:n,slotType:s,placement:{key:r,wigo:a,pageId:o,pid:d,placementConfig:{headerBiddingProvider:c}},formatConfig:{portfolioItemId:l,insertionId:h,connectionId:u}}=this;Object(Ae.m)({sumologicLogger:e,wigo:a,logger:t,placementKey:r})({headerBiddingProvider:c,pageId:o,placementId:d,slotType:s,auctionId:i,viewerId:n,insertionId:h,connectionId:u,portfolioItemId:l})}onVisible(){if(this.logger.debug("Format is visible",this.playerContainer.id),!this.states.hasStopped&&this.states.hasOpened&&this.states.hasStarted){let e;e=this.formatConfig.videoPause.isThreshold()||this.states.hasCompleted?!this.getInViewState():!this.formatConfig.videoPause.isNo(),e||this.requestResumeAd(),this.logger.debug("onVisible mustPause",e)}}onHidden(){this.logger.debug("Format is hidden",this.playerContainer.id),this.states.hasStarted&&this.states.isPlaying&&(!this.formatConfig.videoPause.isNo()||this.states.hasCompleted?this.requestPauseAd():!this.formatConfig.soundMute.isNo()&&this.volumeController.getVolume()>0&&this.volumeController.mute())}onCreateWigoReport(e){Ie.a.tryCatch(()=>{const t=`${e}_${this.auctionId.getOrNull()}.json`;this.wigo.forEach(e=>e.saveVast(t)),ve.b.debug.track(this.placement.key)("wigo-report-collector",{baseUrl:u.b.trackingUrl,referer:Object(Ae.a)(this.sumologicLogger),queryParameters:{env:p.getEnv(),pageId:this.placement.pageId.toString(),pid:this.placement.pid.toString(),hb_provider:this.placement.placementConfig.headerBiddingProvider.getOrValue(""),auctid:this.auctionId.getOrValue(Object(m.b)(""))},trackingUrl:o.a},o.b.of(""+t))}).tapLeft(e=>{this.sumologicLogger.info("wigo report collector error  "+e,1)})}initInternalResponsive(e=!0){this.player&&this.vpaidAd&&(this.player.getPlugin("Responsive").deinit(),this.responsive=new de.a(this),e&&this.responsive.resizeOnStart())}onVpaidReady(){p.isAmp()||this.initInternalResponsive(),this.isVertical=this.player.getMediafile().height>Te.VERTICAL_MARGIN*this.player.getMediafile().width,this.volumeController.init(this);const e=Object(f.findTopWindow)(this.playerContainer);this.visibility=E.listenWindow(e,()=>this.onVisible(),()=>this.onHidden()),this.vpaidAd.subscribe(()=>this.onAdLoaded(),K.a.AdLoaded),this.vpaidAd.subscribe(()=>this.onAdVideoStart(),K.a.AdVideoStart),this.vpaidAd.subscribe(()=>this.onAdStarted(),K.a.AdStarted),this.vpaidAd.subscribe(()=>this.onAdPaused(),K.a.AdPaused),this.vpaidAd.subscribe(()=>this.onAdPlaying(),K.a.AdPlaying),this.vpaidAd.subscribe(()=>this.onAdSizeChange(),K.a.AdSizeChange),this.vpaidAd.subscribe(()=>this.onAdDurationChange(),K.a.AdDurationChange),this.vpaidAd.subscribe(()=>this.onAdRemainingTimeChange(),K.a.AdRemainingTimeChange),this.vpaidAd.subscribe(()=>this.onAdVideoComplete(),K.a.AdVideoComplete),this.vpaidAd.subscribe(()=>this.onAdStopped(),K.a.AdStopped),this.vpaidAd.subscribe(()=>this.onAdSkipped(),K.a.AdSkipped),this.vpaidAd.subscribe(e=>this.onAdError(e),K.a.AdError),this.wigo.forEach(e=>e.settings.forEach(({reportEvent:e,reportName:t})=>this.vpaidAd.subscribe(()=>this.onCreateWigoReport(t),e))),this.vpaidAd.subscribe(this.trackHeavyAdInterventionWarning,Oe.a.AdWarningHeavyAdIntervention),this.vpaidAd.subscribe(t=>{const i="HeavyAdIntervention "+t;this.wigo.forEach(e=>e.valid(3,4,i,"error"));Object(w.j)(e.location.href)?(this.scrollListener&&Object(be.b)(this.scrollListener),this.clearRealVisibilityInterval(),this.unsetVisibility()):this.close(1)},Oe.a.AdRemovedHeavyAdIntervention);for(const e in K.a)K.a.hasOwnProperty(e)&&this.vpaidAd.subscribe(()=>{this.formatConfig.callbacks.trigger(e,this.volumeController,this.fullscreenHelper)},e);this.linearAd.clickThrough&&this.linearAd.clickThrough.length&&this.vpaidAd.subscribe(()=>{this.onHidden()},K.a.AdClickThru),this.vpaidAd.subscribe(()=>this.onCollapseRequest(),B.a.CollapseRequest),this.vpaidAd.subscribe(()=>this.onSoundToggleRequest(),B.a.SoundToggleRequest),this.vpaidAd.subscribe(()=>this.onReplayRequest(),B.a.ReplayRequest),this.vpaidAd.subscribe(()=>this.onEndscreenInit(),B.a.EndscreenInit),this.vpaidAd.subscribe(()=>this.onEarlyClick(),B.a.EarlyClickRequest),this.formatConfig.vtpEvent.getEvent()&&this.vpaidAd.subscribe(()=>this.onVtpEvent(),this.formatConfig.vtpEvent.getEvent())}triggerOnVtpEvent(){this.formatConfig.videoPause.setToNo(),this.states.isPlaying||this.requestResumeAd()}onVtpEvent(){if(!this.formatConfig.videoPause.isNo())if(this.formatConfig.vtpEvent.getEvent()===K.a.AdRemainingTimeChange){const e=this.vpaidAd.getAdDuration(),t=this.vpaidAd.getAdRemainingTime(),i=Math.floor(e-t);!isNaN(i)&&i>0&&i>=this.formatConfig.vtpEvent.getOffset()&&this.triggerOnVtpEvent()}else this.triggerOnVtpEvent()}updateAdSize(){this.adWidth=this.vpaidAd.getAdWidth(),this.adHeight=this.vpaidAd.getAdHeight()}replay(){this.logger.debug("replay called");const{sumologicLogger:e,logger:t,auctionId:i,viewerId:n,slotType:s,placement:{key:r,wigo:a,pageId:o,pid:d,placementConfig:{headerBiddingProvider:c}},formatConfig:{portfolioItemId:l,insertionId:h,connectionId:u}}=this;Object(Ae.k)({sumologicLogger:e,wigo:a,logger:t,placementKey:r})({headerBiddingProvider:c,pageId:o,placementId:d,slotType:s,auctionId:i,viewerId:n,insertionId:h,connectionId:u,portfolioItemId:l}),this.sumologicLogger.info("click-replay "+p.getContextSummary(),1),this.volumeController.replay();try{this.player.getPlugin("Responsive").unsetResponsive(),ve.b.vast.resetTrackedEvents(this.placement.key),this.player.setLinearAd(this.linearAd),this.responsive&&this.responsive.unsetResponsive(),this.unsetVisibility(),this.states.isReady=!1,this.states.hasOpened=!0,this.states.hasRequestedStartAd=!1,this.states.hasStarted=!1,this.states.hasStopped=!1,this.states.hasCompleted=!1,this.states.isReplay=!0,this.vpaidAd=null,Ee.a.hasLogged=[],p.isDesktop()&&this.formatConfig.videoStart.isClick()&&(this.formatConfig.videoStart=new ue.a(ue.a.DEFAULT,this.formatConfig.formatName)),this.load(()=>this.start())}catch(e){this.logger.error("Replay callback threw an exception",e),this.close(3)}}unsetVisibility(){this.visibility&&(this.visibility.destroy(),this.visibility=null)}isWindowVisible(){return p.isAmp()?!!this.visibility&&(this.visibility.isVisible()&&pe.e()):!this.visibility||!this.visibility.isEnabled()||this.visibility.isVisible()}isElementVisibleForMoat(){return!(!p.isAmp()&&!p.isIABSafeFrame())||Object(f.checkElementVisibility)(this.playerContainer,this.formatConfig.threshold.get()).fold(e=>{const{sumologicLogger:t,logger:i,auctionId:n,viewerId:s,slotType:r,placement:{key:a,wigo:o,pageId:d,pid:c,placementConfig:{headerBiddingProvider:l}},formatConfig:{portfolioItemId:h,insertionId:u,connectionId:p}}=this;return Object(Ae.w)({sumologicLogger:t,wigo:o,logger:i,placementKey:a})({headerBiddingProvider:l,pageId:d,placementId:c,slotType:r,auctionId:n,viewerId:s,insertionId:u,connectionId:p,portfolioItemId:h,notVisibleReason:e}),!1},()=>this.isWindowVisible())}getInViewState(){return this.getViewportInViewState()&&(!this.states.hasOpened||this.getFullscreenHelper().isActive()||this.isElementVisibleForMoat())}clearRealVisibilityInterval(){this.realVisibilityInterval.forEach(e=>e.clear()),this.realVisibilityInterval=o.b.empty()}requestPauseAd(){this.states.hasStarted?this.vpaidAd.pauseAd():this.states.shouldBePaused=!0}requestResumeAd(){this.states.hasStarted?this.vpaidAd.resumeAd():this.states.shouldBePaused=!1}onScroll(e){this.wigo.forEach(e=>e.followElement())}startAd(){this.states.hasRequestedStartAd||(this.states.hasRequestedStartAd=!0,Object(l.i)({name:"o",id:this.markId}),this.vpaidAd.startAd())}getCidAndStudioCid(){var e;const t=o.b.fromNullable(null===(e=this.vpaidApi.getContextData())||void 0===e?void 0:e.tracking);return{cid:t.map(e=>""+e.cid).getOrValue(""),studioCid:t.map(e=>""+e.studio_cid).getOrValue("")}}addCustomTracking(e={}){var t;Object(h.hasOwnProperty)(e,this.placement.pageId)&&Object(d.b)(null!==(t=e[this.placement.pageId].trackings)&&void 0!==t?t:[],fe.c,Object(h.tap)(e=>this.logger.debug("Custom trackings from _ttc handled",e)),a.cArray.forEach(ve.b.vast.addVastCustomTrackings(this.placement.key)))}shouldInstanciateSmartHeader(){return this.formatConfig.smartPosition.isEnabled()||this.formatConfig.sliderBehavior.isEnabled()||this.formatConfig.smart6Behavior.isEnabled()}}Te.VERTICAL_MARGIN=1.05;var ke=i(82);const je=(e,t,i,n)=>{a.forEach(t,e=>{i.properties.push(Pe.getPropertyToSave(n,e))}),a.forEach(t,t=>{n.style.setProperty(t,e,"important")})};class Pe{constructor(e,t,i,n,s,r){if(this.formatContainer=e,this.vpaidAd=t,this.components=i,this.responsive=n,this.win=s,this.fullscreenElement=r,this.originalVpaidSize={width:0,height:0},this.fullscreenFormatStyle={width:"100%",height:"100%",top:"0",left:"0",position:"fixed","z-index":String(ke.d),"background-color":"#000000",margin:"0","max-width":"none",padding:"0"},this.originalFormatStyle={width:"",height:"",top:"",left:"",position:"","z-index":"","background-color":"",margin:"","max-width":"",padding:""},this.canvasTag=null,this.active=!1,this.isVideoPaused=!1,this.wasVideoPaused=!1,this.eventListenerManager=new b.a,this.beforeOpenEventListeners=[],this.closeEventListeners=[],this.logger=new c.a("FullscreenHelper"),this.parentsPropertiesList=[],this.logger.debug("new"),this.vpaidAd.subscribe(()=>this.isVideoPaused=!0,K.a.AdPaused),this.vpaidAd.subscribe(()=>this.isVideoPaused=!1,K.a.AdPlaying),!p.isIos()){const e=["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"];this.eventListenerManager.addMultiple(e,this.win,e=>{f.isFullscreen(this.win.document)?this.vpaidAd.resizeAd(this.win.screen.width,this.win.screen.height,"fullscreen"):(a.forEach(this.closeEventListeners,e=>{e()}),this.close())}),this.vpaidAd.subscribe(()=>this.eventListenerManager.removeMultiple(e),K.a.AdStopped)}this.responsive&&this.responsive.addOrientationChangeListener(()=>this.handleOrientationChange()),p.isIos()&&Ie.a.tryCatch(()=>{var e;o.b.fromNullable(null===(e=this.vpaidAd.getCreativeContainer())||void 0===e?void 0:e.contentWindow).forEach(e=>{this.eventListenerManager.add("touchmove",e,e=>{this.isActive()&&e.preventDefault()})})}).tapLeft(e=>this.logger.debug("Error when trying to access creative window to prevent touchmove on iOS",e))}static getPropertyToSave(e,t){return{name:t,value:e.style.getPropertyValue(t),priority:e.style.getPropertyPriority(t)}}handleOrientationChange(){this.active&&(this.logger.debug("orientation change, resizeAd"),this.responsive.resize(!0))}isActive(){return this.active}init(e){this.vpaidEnvironmentVars=e,this.vpaidEnvironmentVars.videoSlot&&(this.canvasTag=this.vpaidEnvironmentVars.videoSlot.canvas)}addBeforeOpenEventListener(e){a.indexOf(this.beforeOpenEventListeners,e)<0&&this.beforeOpenEventListeners.push(e)}addCloseEventListener(e){a.indexOf(this.closeEventListeners,e)<0&&this.closeEventListeners.push(e)}open(){this.active||(this.active=!0,a.forEach(this.beforeOpenEventListeners,e=>{e()}),f.addClass(this.vpaidAd.getMainComponentsContainer(),"fullscreen"),p.isIos()?(this.overrideParentsProperties(),this.originalVpaidSize.width=Object(g.getBoundingClientRect)(this.formatContainer).width,this.originalVpaidSize.height=this.vpaidAd.getAdHeight(),f.addClass(this.formatContainer,"no-transition"),this.applyStyleRules(),this.components.hideAllComponents()):f.openFullscreen(this.fullscreenElement),this.responsive.resize(!0),this.isVideoPaused?(this.vpaidAd.resumeAd(),this.wasVideoPaused=!0):this.wasVideoPaused=!1)}close(){this.active&&(f.removeClass(this.vpaidAd.getMainComponentsContainer(),"fullscreen"),p.isIos()?(this.restoreParentsProperties(),f.removeClass(this.formatContainer,"no-transition"),this.components.showAllComponents(),this.restoreStyleRules()):p.isAndroid()?setTimeout(()=>f.closeFullscreen(this.vpaidAd.getContainer()),100):f.closeFullscreen(this.fullscreenElement),this.wasVideoPaused&&this.vpaidAd.pauseAd(),this.active=!1,this.responsive.resize(!0),this.canvasTag&&this.resetCanvas(),a.forEach(this.closeEventListeners,e=>{e()}))}applyStyleRules(){for(let e in this.originalFormatStyle)this.originalFormatStyle.hasOwnProperty(e)&&(this.originalFormatStyle[e]=this.formatContainer.style.getPropertyValue(e));for(let e in this.fullscreenFormatStyle)this.fullscreenFormatStyle.hasOwnProperty(e)&&this.formatContainer.style.setProperty(e,this.fullscreenFormatStyle[e])}restoreStyleRules(){for(let e in this.originalFormatStyle)this.originalFormatStyle.hasOwnProperty(e)&&this.formatContainer.style.setProperty(e,this.originalFormatStyle[e])}resetCanvas(){this.logger.debug("reset canvas"),this.canvasTag.style.setProperty("position","relative"),this.canvasTag.style.setProperty("top","0"),this.canvasTag.style.setProperty("left","0")}overrideParentsProperties(){this.parentsPropertiesList=[];let e=f.findParentElements(this.formatContainer);a.forEach(e,e=>{let t={element:e,properties:[]};const i=this.win.getComputedStyle(e);i.zIndex&&"auto"!==i.zIndex&&(t.properties.push(Pe.getPropertyToSave(e,"z-index")),e.style.setProperty("z-index","auto","important"));je("none",["transform","-webkit-transform","transition","-webkit-transition"],t,e);je("auto",["will-change"],t,e),this.parentsPropertiesList.push(t)}),this.parentsPropertiesList.push({element:this.win.document.body,properties:[Pe.getPropertyToSave(this.win.document.body,"overflow")]}),this.win.document.body.style.setProperty("overflow","hidden")}restoreParentsProperties(){a.forEach(this.parentsPropertiesList,e=>{a.forEach(e.properties,t=>{e.element.style.removeProperty(t.name),e.element.style.setProperty(t.name,t.value,t.priority)})})}}var Le=i(53),xe=i(43);const Ve=({sliderIsEnabled:e,orientationIsLandscape:t,parentContainerIsInView:i})=>!!e||t&&!i,Ne=(e,t)=>e>t,De=["transitionend","otransitionend","oTransitionEnd","webkitTransitionEnd"],_e=["","-webkit-","-moz-","-o-","-ms-"],Re=e=>{a.forEach(_e,t=>{e.element.style.setProperty(t+"transition",`${e.property} ${e.duration}s ${e.effect}`)})},Me=e=>{a.forEach(_e,t=>e.style.removeProperty(t+"transition"))},Fe=e=>{e.style.removeProperty("transform-origin"),e.style.removeProperty("transform")},Ue=e=>{e.style.removeProperty("bottom"),e.style.removeProperty("right")},Be=e=>{e.style.setProperty("z-index",String(ke.d)),e.style.setProperty("position","fixed")};class We{constructor(e){this.format=e,this.originalPlayerZIndex=String(ke.e),this.behaviorIsEnabled=!1,this.transitionEndListenerManager=new b.a,this.transitionInProgress=!1,this.midpointIsReached=!1,this.timeoutSlotIsReached=!1,this.remainingTimeLastSmartInSec=0,this.timerOutOfSlot=null,this.timerSmart6=null,this.smartElapsedTimeInSec=0,this.detachedSlotState=o.b.empty(),this.currentTop=0,this.iOSRuler=o.b.empty(),this.window=e.placement.placementConfig.parentWindow.getWindow(),this.originalPlayerZIndex=this.format.playerContainer.style.getPropertyValue("z-index")}get isInDetachedSlot(){return this.detachedSlotState.nonEmpty()}toggleSmartPositionIfNeeded(){this.behaviorIsEnabled&&this.orientationIsLandscape===this.isOrientationLandscape()&&!this.transitionInProgress?(this.windowTopLimit=this.getWindowTopLimit(),this.detachedSlotState.match({some:e=>{switch(e){case"top":t=this.windowTopLimit,i=this.creativeTopLimit,t<=i&&this.transitionFromTopToNativeSlot();break;case"corner":this.isParentContainerInView()&&this.transitionFromCornerToNativeSlot()}var t,i},none:()=>{switch((({deviceIsDesktop:e,sliderIsEnabled:t,placementIsSticky:i,orientationIsLandscape:n})=>e||t||!i&&n?e||!e&&n||t?"corner":void 0:"top")({deviceIsDesktop:Object(p.isDesktop)(),sliderIsEnabled:this.format.formatConfig.sliderBehavior.isEnabled(),placementIsSticky:this.format.formatConfig.sticky.isEnabled(),orientationIsLandscape:this.isOrientationLandscape()})){case"corner":Ve({sliderIsEnabled:this.format.formatConfig.sliderBehavior.isEnabled(),orientationIsLandscape:this.isOrientationLandscape(),parentContainerIsInView:this.isParentContainerInView()})&&this.transitionFromNativeSlotToCorner();break;case"top":this.updateCreativeTopLimit(),this.format.formatConfig.smart6Behavior.isTop()&&(this.updateSmart6Timer(),this.format.player.smartPosition.hideCloseButton()),Ne(this.windowTopLimit,this.creativeTopLimit)&&this.transitionFromNativeSlotToTop()}}})):this.orientationIsLandscape=this.isOrientationLandscape()}enableBehavior(){this.nativeSlotPlaceholder=this.initNativeSlotPlaceholder(),this.format.getFullscreenHelper().addBeforeOpenEventListener(()=>this.onFullScreenOpen()),this.format.getFullscreenHelper().addCloseEventListener(()=>this.onFullScreenClose()),this.format.responsive.addOrientationChangeListener(()=>this.onOrientationChange()),this.orientationIsLandscape=this.isOrientationLandscape(),this.format.player.smartPosition.init(this.format.formatConfig.sliderBehavior.isEnabled(),()=>{this.format.formatConfig.smart6Behavior.isEnabled()||this.showCloseButtonAtMidPoint()}),this.updateCreativeTopLimit(),this.behaviorIsEnabled=!0}disableBehavior(){this.behaviorIsEnabled&&(this.behaviorIsEnabled=!1,this.detachedSlotState.forEach(e=>{switch(e){case"top":this.transitionFromTopToNativeSlot();break;case"corner":this.transitionFromCornerToNativeSlot()}}),this.format.formatConfig.sliderBehavior.isEnabled()||this.nativeSlotPlaceholder.parentNode.removeChild(this.nativeSlotPlaceholder),Object(xe.e)(),this.iOSRuler=o.a)}moveToCornerPosition(){this.detachedSlotState=Object(o.c)("corner"),this.header||this.createSmartHeader();const e=this.format.formatConfig.sliderBehavior.isEnabled()&&this.format.formatConfig.slider.closeButtonEnabled();this.format.player.smartPosition.setCornerPositionPlayerComponents({shouldShowCloseButton:e||this.timeoutSlotIsReached||this.midpointIsReached,showHeaderCloseButton:()=>this.header.showCloseButton()}),this.updateCloseButtonTimers(),Be(this.format.playerContainer),this.format.responsive.unsetResponsive(),this.format.responsive.setResponsive(()=>this.handleDetachedSlotResize("corner")),Object(f.addClass)(this.format.playerContainer,We.CUSTOMIZATION_CSS_CLASS.CORNER),this.executeNativeSlotPlaceholderFadeAnimation("#000000","#ffffff"),this.executeOncePlayerTransitionEnded().then(()=>{this.listenIOSNativeHeaderBarMovements(),this.setPlayerCornerPosition({withMarginFromEdge:!0}),Me(this.format.playerContainer),Fe(this.format.playerContainer),this.transitionInProgress=!1}),this.slideInUpCornerPosition()}getOptimalDimension(e,t){return"corner"===t?this.format.responsive.getOptimalDimensionBasedOnSurface():this.format.responsive.getOptimalDimension(e)}slideOutDownCornerPosition(){const e=g.getBoundingClientRect(this.format.playerContainer).height;this.format.playerContainer.style.setProperty("transform-origin","bottom"),this.format.playerContainer.style.setProperty("transform",`translateY(${e+We.MARGIN_FROM_EDGES_IN_PX}px)`),Re({element:this.format.playerContainer,property:"transform",duration:We.TRANSITION_DURATION_IN_SECONDS,effect:"ease-in"})}transitionFromNativeSlotToCorner(){this.transitionInProgress=!0,this.showCompensationDiv(),this.moveToCornerPosition()}transitionFromNativeSlotToTop(){this.transitionInProgress=!0,this.showCompensationDiv(),this.updateCloseButtonTimers(),this.moveToTopPosition(),this.transitionInProgress=!1}createSmartHeader(){this.header=new ee,this.header.init(this.format.getVpaidAd(),this.format.getVolumeController()),this.header.smartCloseButton.onClickAction=()=>{this.disableBehavior(),this.format.formatConfig.sliderBehavior.isEnabled()&&this.format.getVpaidAd().skipAd()},this.format.playerContainer.insertBefore(this.header.getElement(),this.format.playerContainer.firstChild)}shouldUpdateCloseButtonTimer(){return!(this.timeoutSlotIsReached||this.midpointIsReached||this.format.player.smartPosition.isCloseButtonMode(2)||this.format.formatConfig.smart6Behavior.isEnabled())}updateCloseButtonTimers(){this.shouldUpdateCloseButtonTimer()&&(this.remainingTimeLastSmartInSec=this.format.getVpaidAd().getAdRemainingTime(),this.timerOutOfSlot=this.showCloseButtonHandler())}updateSmart6Timer(){this.timerSmart6=this.setSmart6TimerToDisableSmartBehavior()}moveToTopPosition(){this.detachedSlotState=Object(o.c)("top"),Object(f.addClass)(this.format.playerContainer,We.CUSTOMIZATION_CSS_CLASS.TOP),this.format.player.smartPosition.setTopPositionPlayerComponents({shouldShowCloseButton:this.timeoutSlotIsReached||this.midpointIsReached,onCloseButtonClick:()=>this.disableBehavior()}),Be(this.format.playerContainer),this.handleFloatingHeaders(),this.format.playerContainer.style.setProperty("top",this.currentTop+"px"),this.format.responsive.unsetResponsive(),this.format.responsive.setResponsive(()=>this.handleDetachedSlotResize("top"))}slideInUpCornerPosition(){const e=g.getBoundingClientRect(this.format.playerContainer).height;this.header.show(),this.format.playerContainer.style.setProperty("bottom",`-${e}px`),this.format.playerContainer.style.setProperty("right",We.MARGIN_FROM_EDGES_IN_PX+"px"),this.format.playerContainer.style.setProperty("transform-origin","bottom"),this.format.playerContainer.style.setProperty("transform",`translateY(-${e+We.MARGIN_FROM_EDGES_IN_PX}px)`),Re({element:this.format.playerContainer,property:"transform",duration:We.TRANSITION_DURATION_IN_SECONDS,effect:"ease-out"})}executeNativeSlotPlaceholderFadeAnimation(e,t){this.nativeSlotPlaceholder.style.setProperty("background-color",e),Re({element:this.nativeSlotPlaceholder,property:"background-color",duration:We.TRANSITION_DURATION_IN_SECONDS,effect:"linear"}),this.nativeSlotPlaceholder.style.setProperty("background-color",t)}updateCreativeTopLimit(){var e;const t=this.detachedSlotState.isEmpty()?this.format.playerContainer:this.nativeSlotPlaceholder,i=null!==(e=window.FORCE_DEMO)&&void 0!==e&&e,{top:n,bottom:s}=g.getBoundingClientRect(t,!i),r=i?Object(f.getTop)(this.window,Object(f.findFloatingHeaders)(this.window,this.format.playerContainer,[this.format.playerContainer]),g.getWindowSize(this.window).height*We.MAX_FLOATING_TOP):0,a=g.getScrollTop(this.window);this.creativeTopLimit=n===s?a:a+n-r}getWindowTopLimit(){return g.getScrollTop(this.window)+this.currentTop}transitionFromCornerToNativeSlot(){this.transitionInProgress=!0,Object(f.removeClass)(this.format.playerContainer,We.CUSTOMIZATION_CSS_CLASS.CORNER),this.executeNativeSlotPlaceholderFadeAnimation("#ffffff","#000000"),this.executeOncePlayerTransitionEnded().then(()=>{this.format.player.smartPosition.cleanupCornerPositionSpecificUI(()=>this.header.showCloseButton()),this.header.hide(),Ue(this.format.playerContainer),this.moveToNativeSlotPosition(),Me(this.format.playerContainer),this.format.formatConfig.sliderBehavior.isEnabled()||Fe(this.format.playerContainer),this.stopScrollListener(),this.transitionInProgress=!1}),this.slideOutDownCornerPosition()}transitionFromTopToNativeSlot(){Object(f.removeClass)(this.format.playerContainer,We.CUSTOMIZATION_CSS_CLASS.TOP),this.transitionInProgress=!0,this.format.playerContainer.style.removeProperty("top"),this.format.player.smartPosition.cleanupTopPositionSpecificUI(),this.moveToNativeSlotPosition(),this.transitionInProgress=!1}moveToNativeSlotPosition(){this.detachedSlotState=o.a,(this.timerOutOfSlot||this.timerSmart6)&&(this.smartElapsedTimeInSec+=this.remainingTimeLastSmartInSec-this.format.getVpaidAd().getAdRemainingTime(),this.clearTimerOutOfSlot()),this.format.playerContainer.style.setProperty("position","relative"),this.format.playerContainer.style.setProperty("z-index",this.originalPlayerZIndex),this.nativeSlotPlaceholder.style.setProperty("display","none"),this.format.responsive.unsetResponsive(),this.format.responsive.setResponsive()}isParentContainerInView(){return Object(f.getPercentageInView)({element:this.format.parentContainer,elementAncestors:Object(f.findParentElements)(this.format.parentContainer),elementClientRect:Object(g.getBoundingClientRect)(this.format.parentContainer),mainWindow:this.window,elementHeight:this.format.parentContainer.offsetHeight})>=this.format.formatConfig.threshold.percentage()}showCompensationDiv(){const e=this.format.responsive.getOptimalDimension(this.format.parentContainer).height;this.nativeSlotPlaceholder.style.setProperty("display","block"),this.nativeSlotPlaceholder.style.setProperty("height",e+"px")}handleFloatingHeaders(){if(this.detachedSlotState.existsIf(e=>"top"===e)){const e=Object(f.getTop)(this.window,Object(f.findFloatingHeaders)(this.window,this.format.playerContainer,[this.format.playerContainer]),g.getWindowSize(this.window).height*We.MAX_FLOATING_TOP);this.currentTop!==e&&(this.currentTop=e,this.format.playerContainer.style.setProperty("top",this.currentTop+"px"))}}handleDetachedSlotResize(e){const{width:t,height:i}=this.getOptimalDimension(this.format.parentContainer,e);this.format.getVpaidAd().resizeAd(t,i),this.handleFloatingHeaders()}initNativeSlotPlaceholder(){const e=this.window.document.createElement("div");return e.className="teads-player teads-compensation-div",e.style.setProperty("-webkit-box-shadow","inset 0px 0px 85px rgba(0, 0, 0, 0.1)"),e.style.setProperty("-moz-box-shadow","inset 0px 0px 85px rgba(0, 0, 0, 0.1)"),e.style.setProperty("box-shadow","inset 0px 0px 85px rgba(0, 0, 0, 0.1)"),e.style.setProperty("background-color","#000000"),this.format.formatConfig.sliderBehavior.isEnabled()||(this.format.playerContainer.nextSibling?this.format.playerContainer.parentNode.insertBefore(e,this.format.playerContainer.nextSibling):this.format.playerContainer.parentNode.appendChild(e)),e}isOrientationLandscape(){if(Object(p.isDesktop)())return!0;const e=g.getWindowSize(this.window);return e.width>e.height}setPlayerCornerPosition(e){const t=e.withMarginFromEdge?We.MARGIN_FROM_EDGES_IN_PX:0;this.format.playerContainer.style.setProperty("bottom",t+"px"),this.format.playerContainer.style.setProperty("right",t+"px"),this.handleIOSNativeHeaderBar(!0)}onFullScreenOpen(){this.detachedSlotState.existsIf(e=>"corner"===e)&&this.setPlayerCornerPosition({withMarginFromEdge:!1})}onFullScreenClose(){this.detachedSlotState.forEach(e=>{"corner"===e&&this.setPlayerCornerPosition({withMarginFromEdge:!0}),this.handleDetachedSlotResize(e)})}clearTimerOutOfSlot(){this.timerOutOfSlot&&(this.timerOutOfSlot.clear(),this.timerOutOfSlot=null)}showCloseButtonAtMidPoint(){if(this.timeoutSlotIsReached)return;this.midpointIsReached=!0;const e=this.format.getVpaidAd().getAdRemainingTime()-1,t=()=>this.format.getVpaidAd().unsubscribe(i,K.a.AdRemainingTimeChange),i=()=>{this.format.getVpaidAd().getAdRemainingTime()<e&&(this.showCloseButton(),t())};this.format.getVpaidAd().subscribe(i,K.a.AdRemainingTimeChange)}showCloseButtonHandler(){return y.c(()=>{if(!this.midpointIsReached){(this.format.formatConfig.sliderBehavior.isEnabled()?this.format.getVpaidAd().getAdDuration()-this.format.getVpaidAd().getAdRemainingTime():this.remainingTimeLastSmartInSec+this.smartElapsedTimeInSec-this.format.getVpaidAd().getAdRemainingTime())>=We.TIME_IN_SEC_BEFORE_CLOSE_BUTTON&&(this.showCloseButton(),this.clearTimerOutOfSlot(),this.timeoutSlotIsReached=!0)}},We.SHOW_CLOSE_BUTTON_INTERVAL_DELAY_IN_MS)}setSmart6TimerToDisableSmartBehavior(){return y.c(()=>{this.format.getVpaidAd().getAdDuration()-this.format.getVpaidAd().getAdRemainingTime()>6.5&&this.disableBehavior()},300)}showCloseButton(){this.detachedSlotState.forEach(e=>{"top"===e&&this.format.player.smartPosition.showCloseButton(),"corner"===e&&this.header.showCloseButton()})}executeOncePlayerTransitionEnded(){return new Promise(e=>{this.transitionEndListenerManager.addMultiple(De,this.format.playerContainer,()=>{this.transitionEndListenerManager.removeAll(),e()})})}onOrientationChange(){this.detachedSlotState.filter(e=>!this.format.getFullscreenHelper().isActive()).match({some:e=>{const t=Ve({sliderIsEnabled:this.format.formatConfig.sliderBehavior.isEnabled(),orientationIsLandscape:this.isOrientationLandscape(),parentContainerIsInView:this.isParentContainerInView()});switch(e){case"top":t&&this.transitionFromTopToCorner();break;case"corner":Ne(this.windowTopLimit,this.creativeTopLimit)&&!t?(this.updateCreativeTopLimit(),this.transitionFromCornerToTop()):Ne(this.windowTopLimit,this.creativeTopLimit)||t?this.format.formatConfig.sliderBehavior.isEnabled()&&this.isOrientationLandscape()?(this.handleIOSNativeHeaderBar(),this.listenIOSNativeHeaderBarMovements()):this.format.formatConfig.sliderBehavior.isEnabled()&&!this.isOrientationLandscape()&&(this.handleIOSNativeHeaderBar(),this.stopScrollListener()):this.transitionFromCornerToNativeSlot()}},none:()=>{this.format.responsive.resize(),this.isOrientationLandscape()||this.updateCreativeTopLimit()}})}transitionFromTopToCorner(){this.format.playerContainer.style.removeProperty("top"),this.showCompensationDiv(),this.moveToCornerPosition()}transitionFromCornerToTop(){this.stopScrollListener(),this.header.hide(),Ue(this.format.playerContainer),this.showCompensationDiv(),this.moveToTopPosition()}listenIOSNativeHeaderBarMovements(){if(Object(p.isIos)()&&this.isOrientationLandscape()&&!this.scrollListener){const e=this.format.placement.placementConfig.scrollSelector.getSlot();this.scrollListener=Object(be.a)(()=>this.handleIOSNativeHeaderBar(),e,this.window.context),this.iOSRuler=Object(o.c)(Object(xe.a)(window)),Object(xe.d)(window)}}stopScrollListener(){this.scrollListener&&(Object(be.b)(this.scrollListener),this.scrollListener=null)}handleIOSNativeHeaderBar(e=!1){if(this.behaviorIsEnabled&&this.iOSRuler.nonEmpty()){const t=!this.isOrientationLandscape()||e&&this.getWindowTopLimit()>0?We.MARGIN_FROM_EDGES_IN_PX:Object(xe.b)(window)+We.MARGIN_FROM_EDGES_IN_PX;this.format.formatConfig.sliderBehavior.isEnabled()&&this.format.parentContainer.style.setProperty("bottom",t+"px"),this.format.playerContainer.style.setProperty("bottom",t+"px")}}}We.MARGIN_FROM_EDGES_IN_PX=5,We.TRANSITION_DURATION_IN_SECONDS=.4,We.MAX_FLOATING_TOP=Object(p.isDesktop)()?.25:.2,We.TIME_IN_SEC_BEFORE_CLOSE_BUTTON=5,We.SHOW_CLOSE_BUTTON_INTERVAL_DELAY_IN_MS=300,We.CUSTOMIZATION_CSS_CLASS={TOP:"smart-position-top",CORNER:"smart-position-corner"};var He=i(57);class ze{constructor(e){this.format=e,this.initialized=!1,this.active=!1,this.logger=new c.a("BrandingMode")}isActive(){return this.active}isInitialized(){return this.initialized}init(){if(this.logger.debug("init called"),this.initialized)return void this.logger.warn("Branding mode helper has already been initialized");this.initialized=!0,this.vpaidEnvironmentVars=this.format.getEnvironmentVars();let e=this.format.getVpaidAd();e.showComponent("fullscreenbutton"),this.format.getFullscreenHelper().init(this.vpaidEnvironmentVars);let t=()=>{this.isFullscreenSupported()&&this.stop()};e.subscribe(t,K.a.AdClickThru,this),e.subscribe(()=>e.unsubscribe(t,K.a.AdClickThru),K.a.AdStopped),e.subscribe(this.toggle,B.a.FullscreenRequest,this),e.subscribe(()=>e.unsubscribe(this.toggle,B.a.FullscreenRequest),K.a.AdStopped),this.format.vpaidApi.getStudioData()||e.subscribe(this.stop,B.a.AdVideoComplete,this),e.subscribe(this.stop,B.a.EndscreenInit,this),e.subscribe(this.stop,B.a.AdStopped,this),this.format.getVolumeController().addUnmuteCallback(()=>this.onUnmute()),this.format.getVolumeController().addMuteCallback(()=>this.onMute())}deinit(){this.logger.debug("deinit called"),this.initialized=!1;let e=this.format.getVpaidAd(),t=()=>{this.isFullscreenSupported()&&this.stop()};e.subscribe(t,K.a.AdClickThru,this),e.subscribe(()=>e.unsubscribe(t,K.a.AdClickThru),K.a.AdStopped),e.unsubscribe(this.toggle,B.a.FullscreenRequest),e.unsubscribe(this.stop,B.a.AdVideoComplete),e.unsubscribe(this.stop,B.a.EndscreenInit),e.unsubscribe(this.stop,B.a.AdStopped),e.hideComponent("fullscreenbutton")}toggle(){this.initialized?this.active?this.stop():this.start():this.logger.warn("Cannot toggle branding mode helper before its initialization")}start(){this.active||(this.logger.debug("start"),this.initialVolume=this.format.getVolumeController().getVolume(),this.setVolume(this.format.formatConfig.volume.getMain()),this.isFullscreenSupported()?(this.format.getFullscreenHelper().open(),this.format.getVpaidAd().showComponent("fullscreenbutton")):this.format.getVpaidAd().hideComponent("fullscreenbutton"),this.active=!0)}stop(){this.active&&(this.logger.debug("stop"),this.format.getVolumeController().isMuted()&&(this.initialVolume=0),this.setVolume(this.initialVolume),this.isFullscreenSupported()?this.format.getFullscreenHelper().close():this.format.getVpaidAd().showComponent("fullscreenbutton"),this.format.getVpaidAd().hideComponent("fullscreenbutton"),this.active=!1)}setVolume(e){const t=()=>this.format.getVolumeController().setVolume(e);this.vpaidEnvironmentVars.videoSlot&&this.vpaidEnvironmentVars.videoSlot.audio&&!this.vpaidEnvironmentVars.videoSlot.audio.authorized?this.vpaidEnvironmentVars.videoSlot.audio.authorizeAudio(Object(S.a)(t,this)):t()}isFullscreenSupported(){let e=this.format.getVpaidAd(),t=this.format.getFullscreenHelper().isActive()||e.getAdWidth()>e.getAdHeight();return!p.isDesktop()&&!p.isAmp()&&!p.isIABSafeFrame()&&t}onUnmute(){this.isFullscreenSupported()||this.start()}onMute(){this.isFullscreenSupported()||this.stop()}}var Ge=i(78),qe=i(79),Ke=i(123);const $e=new c.a("format.helper.ViewabilityMeasurement"),Ye=(e,t,i,n)=>{Ie.a.tryCatch(()=>Xe(e,t,i,n)).tapLeft(n=>{var s;ve.b.debug.track(e)("warning",{baseUrl:u.b.trackingUrl,referer:Object(Ae.a)(t),queryParameters:{env:p.getEnv(),auctid:null!==(s=i.auctionId)&&void 0!==s?s:""},trackingUrl:o.a},o.b.of("Error when logging viewability info: "+Object(ge.a)(n)))})},Xe=(e,t,i,n)=>{const{advertiserEntityId:s,auctionId:r}=i;Qe(s).forEach(i=>{const s=w.p(i.name);ve.b.debug.track(e)(n,{baseUrl:u.b.trackingUrl,referer:Object(Ae.a)(t),queryParameters:{env:p.getEnv(),auctid:null!=r?r:""},trackingUrl:o.a},o.b.of(s.search))})},Qe=e=>l.m.flatMap(t=>{if(!Object(h.isFunction)(t.getEntriesByType))return o.a;if(!e)return o.a;const i=t.getEntriesByType("resource");$e.debug("Looking for IAS tracking URLs for advEntityId = ",e);const n=a.filter(i,t=>0===t.name.indexOf("https://dt.adsafeprotected.com/dt?advEntityId="+e)&&t.name.indexOf("type:s")<0);return n.length>0?Object(o.c)(a.last(n)):o.a});class Je extends Te{constructor(e,t,i,n,s,r,d,c){super(e,t,i,n,r,d,c),this.placement=e,this.config=t,this.player=i,this.markId=n,this.adCallTrackOpts=s,this.hasLoggedPlayProblem=!1,this.adCallTracked=!1,this.getFunnelMacros=()=>{const e=o.b.fromNullable(this.slotType);return He.b({slotType:e})},this.config.adType.isDisplay()&&Object(f.addClass)(this.parentContainer,"teads-display"),Object(C.a)(this.config.portfolioItemId)&&(Object(f.addClass)(this.parentContainer,"teads-third-party-display"),a.includes([37,39],this.config.portfolioItemId)&&p.isIos()&&this.parentContainer.style.setProperty("-webkit-clip-path","inset(0)")),this.windowReferenceForViewability=this.getReferenceWindowForViewability(this.playerContainer)}load(e,t){p.isIABSafeFrame()&&!Object(Ke.a)(this.formatConfig.portfolioItemId,this.placement.placementConfig.headerBiddingProvider.nonEmpty())?me.c(()=>super.load(e,t)):super.load(e,t)}getTemplateName(){return"inread"}start(){const e=this.placement.placementConfig.scrollSelector.getSlot();this.scrollListener=Object(be.a)(e=>this.onScroll(e),e,this.win.context),p.isDesktop()&&this.setRealVisibilityInterval(),this.isInView=this.getInViewState(),this.formatConfig.vast.getContent()&&this.player.getMediafile()?super.start():this.onScroll()}onAdLoaded(){if(super.onAdLoaded(),this.extensions=o.b.fromNullable(this.player).map(e=>e.getPlugin("Extensions")),this.extensions.forEach(e=>this.loadAdVerificationScripts(e)),this.fullscreenHelper.addCloseEventListener(()=>{this.isSmartPositioned()||this.responsive&&this.responsive.resize(!0)}),this.isVertical){let e=()=>{this.responsive.unsetResponsive(),this.parentContainer.style.setProperty("display","none"),this.isInView=!1,this.requestPauseAd()};this.responsive.addOrientationChangeListener(t=>{this.isFullscreen()||(this.responsive.isLandscape?e():(this.parentContainer.style.setProperty("display","block"),this.responsive.setResponsive(),this.onScroll(t)))}),this.fullscreenHelper.addCloseEventListener(()=>{this.responsive&&this.responsive.isLandscape&&e()})}p.isDesktop()||this.vpaidAd.render(this.vpaidAd.getVPAID()),p.isIABSafeFrame()&&!this.states.hasOpened&&this.openFormat(),this.onScroll(),this.isInView=this.getInViewState()}onAdVideoStart(){super.onAdVideoStart(),this.smartPositionHelper&&this.smartPositionHelper.enableBehavior(),this.states.hasStarted&&this.states.hasOpened&&this.fitContainerToContent()}onAdSizeChange(){if(super.onAdSizeChange(),this.states.hasOpened){const e=this.fitContainerToContent();p.isAmp()&&pe.f(e)}}onAdVideoComplete(){super.onAdVideoComplete(),this.smartPositionHelper&&this.smartPositionHelper.disableBehavior()}onVpaidReady(){super.onVpaidReady(),this.fullscreenHelper=new Pe(this.parentContainer,this.vpaidAd,this.components,this.responsive,this.win,this.playerContainer),this.brandingMode=new ze(this),this.shouldInstanciateSmart()&&(this.smartPositionHelper=new We(this)),this.vpaidAd.subscribe(()=>this.pauseAdIfShouldNotBePlaying(),K.a.AdStarted),this.vpaidAd.subscribe(()=>this.pauseAdIfShouldNotBePlaying(),K.a.AdRemainingTimeChange),this.vpaidAd.subscribe(()=>this.clearRealVisibilityInterval(),K.a.AdError),this.vpaidAd.subscribe(()=>this.clearRealVisibilityInterval(),K.a.AdStopped),this.vpaidAd.subscribe(()=>this.clearRealVisibilityInterval(),K.a.AdSkipped),this.vpaidAd.subscribe(()=>this.clearRealVisibilityInterval(),K.a.AdVideoComplete)}close(e){super.close(e),this.clearRealVisibilityInterval()}startInView(){this.states.hasStarted&&(this.formatConfig.videoPause.isThreshold()||this.isVertical||this.states.hasCompleted)&&this.requestResumeAd(),this.volumeController.startInView()}endInView(){this.states.hasFiredViewabilityEvent||(Ye(this.placement.key,this.sumologicLogger,this.player.getConfig(),"piv-out"),this.states.hasFiredViewabilityEvent=!0),this.formatConfig.videoPause.isThreshold()||this.states.hasCompleted?this.requestPauseAd():this.volumeController.endInView()}fitContainerToContent(e=!1){var t;const i=this.getEnvironmentVars();if(this.vpaidApi.isStudioDisplay());else if(p.isIos()&&!o.b.fromNullable(null===(t=i.videoSlot)||void 0===t?void 0:t.mediaProxy).isEmpty()){if(i.videoSlot.mediaProxy.getStatus()!==qe.a.READY)return}if((this.states.hasOpened||e)&&!this.isFullscreen()){let e=g.getBoundingClientRect(this.placement.getInnerContainer()).height;return this.parentContainer.style.setProperty("height",e+"px"),e}}manageInView(e){e!==this.isInView&&(e?this.startInView():this.endInView()),this.isInView=e}openFormat(){var e;p.isIABSafeFrame()||(this.states.hasOpened=!0),this.formatConfig.animations.setExpandDuration(this.parentContainer);const t=this.getEnvironmentVars();if(this.vpaidApi.isStudioDisplay()||!this.formatConfig.adType.isVideo());else if(p.isIos()&&!o.b.fromNullable(null===(e=t.videoSlot)||void 0===e?void 0:e.mediaProxy).isEmpty()){let e=t.videoSlot.mediaProxy,i=e.getStatus();if(i===qe.a.READY)this.logger.debug("mediaProxy is ready !",t.videoSlot.src);else{if(i===qe.a.ERROR)return void this.logger.error("mediaProxy error, video is not available for the moment",t.videoSlot.src);if(!t.videoSlot.src||i<qe.a.READY)return this.logger.debug("mediaProxy not ready or video.src not setted, delay inread opening",t.videoSlot.src),void e.listen(Ge.a.READY,()=>{this.openFormat()},!1)}}const i=this.fitContainerToContent(!0);this.logger.debug(`Format (pageId = ${this.formatConfig.pageId}, placementId = ${this.formatConfig.placementId}) has been opened`),this.responsive&&!this.isSmartPositioned()&&this.responsive.setResponsive(),p.isIABSafeFrame()&&me.f(this.vpaidApi.adMetadata.map(Se([this.components.getComponent("label"),this.components.getComponent("credits")])).getOrValue(i),e=>{this.states.hasOpened=e,this.vpaidApi.adMetadata.forEach(e=>this.responsive.updateAndResizeWithAdVideoMetadata(e))})}trackAdCall(e){!e||this.states.hasStopped||this.adCallTracked||(this.adCallTracked=!0,Object(Ae.h)({placementKey:this.placement.key,sumologicLogger:this.sumologicLogger,wigo:this.placement.wigo,logger:this.logger,headerBiddingProvider:this.placement.placementConfig.headerBiddingProvider,baseUrlWithQueryParameters:this.adCallTrackOpts}),this.initAdTimingMark.forEach(e=>{const t=Math.round(Object(l.l)()-e);Object(h.isFunction)(this.vpaidAd.getVPAID().handleAdCallTimeout)&&this.vpaidAd.getVPAID().handleAdCallTimeout(t),this.logger.info("Duration between initAd and adCall",t)}),Object(l.i)({name:"l",id:this.markId}),this.sumologicLogger.info(Object(l.f)("ac",this.markId),40))}isUserInteraction(e){return!!(!p.isMobile()&&!p.isTablet()||this.formatConfig.allowedPlayer.getValue()===Le.a.CANVAS||p.isIos10Safari()||p.isFacebookWebviewIOS10()||p.canAutoplay())||!!e&&"scroll"!==e.type}onScroll(e){if(super.onScroll(e),!this.isFullscreen()&&!this.isVerticalLandscape()){this.smartPositionHelper&&this.smartPositionHelper.toggleSmartPositionIfNeeded();const t=this.getInViewState();this.trackAdCall(t),!this.isSmartPositioned()&&this.states.isReady&&(this.states.hasOpened||this.isUserInteraction(e)&&this.isWindowVisible()&&(this.formatConfig.launch.isAuto()||this.formatConfig.launch.isThreshold()&&t)&&this.openFormat(),this.states.hasOpened&&!this.states.hasStopped&&(this.states.hasStarted?this.manageInView(t):(this.viewabilityTagsHelper.onScroll(),(this.isUserInteraction(e)||this.states.isReplay)&&this.canStart(t)&&(this.startAd(),p.isDesktop()||this.setRealVisibilityInterval()))))}}canStart(e){return!this.formatConfig.videoStart.isThreshold()||e||this.states.isReplay||this.shouldBypassDeepVisibilityCheck()}canPlay(e){return this.formatConfig.videoPause.isNo()||e}isFullscreen(){return!!this.fullscreenHelper&&this.fullscreenHelper.isActive()}isSmartPositioned(){return this.smartPositionHelper&&this.smartPositionHelper.isInDetachedSlot}getReferenceWindowForViewability(e){var t;return null!==(t=this.win.FORCE_DEMO)&&void 0!==t&&t?Object(f.getWindow)(e):Object(f.findTopWindow)(e)}getViewportInViewState(){var e;const t=this.vpaidAd?this.vpaidAd.getAdHeight():Je.DEFAULT_AD_HEIGHT,i=null!==(e=this.win.FORCE_DEMO)&&void 0!==e&&e;return!!this.isSmartPositioned()||Object(f.isInView)({element:this.playerContainer,elementAncestors:Object(f.findParentElements)(this.playerContainer),elementClientRect:g.getBoundingClientRect(this.playerContainer,!i),mainWindow:this.windowReferenceForViewability,thresholdCoefficient:this.formatConfig.threshold.get()/100,elementHeight:t})}setRealVisibilityInterval(){this.realVisibilityInterval=this.realVisibilityInterval.orElse(()=>o.b.fromNullable(y.c(()=>this.checkRealVisibility(),250)))}checkRealVisibility(){if(!this.isFullscreen()&&!this.isVerticalLandscape()){this.smartPositionHelper&&this.smartPositionHelper.toggleSmartPositionIfNeeded();const e=this.getInViewState();this.trackAdCall(e),this.states.isReady&&(this.states.hasOpened?this.states.hasOpened&&!this.states.hasStopped&&(this.states.hasStarted?(this.manageInView(e),Object(C.b)(this.config.portfolioItemId)&&this.fitContainerToContent()):(this.viewabilityTagsHelper.onScroll(),this.canStart(e)&&this.startAd())):this.isWindowVisible()&&(this.formatConfig.launch.isAuto()||this.formatConfig.launch.isThreshold()&&e)&&this.openFormat())}}pauseAdIfShouldNotBePlaying(){if(this.states.isPlaying){const e=this.getInViewState();if(!(this.states.hasStarted?this.canPlay(e):this.canStart(e))&&(this.isInView=!1,this.requestPauseAd(),!this.hasLoggedPlayProblem)){this.hasLoggedPlayProblem=!0;const e=this.linearAd&&this.linearAd.id?this.linearAd.id:"0",t=this.linearAd&&this.linearAd.creativeId?this.linearAd.creativeId:"0";this.sumologicLogger.info(`shouldnt-be-playing ${this.placement.pid} ${t} ${e}`)}}}shouldBypassDeepVisibilityCheck(){var e;const t=this.getEnvironmentVars();return p.isIos()&&p.isCanvasUsed()&&!o.b.fromNullable(null===(e=t.videoSlot)||void 0===e?void 0:e.mediaProxy).isEmpty()&&this.getViewportInViewState()}isVerticalLandscape(){return this.isVertical&&this.responsive&&this.responsive.isLandscape}shouldInstanciateSmart(){return!this.isVertical&&(this.formatConfig.sticky.isEnabled()||this.formatConfig.smartPosition.isEnabled()||this.formatConfig.smart6Behavior.isEnabled())}insertViewabilityScripts(e,t){a.forEach(e,({vendor:e,url:i})=>{const n="IAS"===e;if(n){const e=i.match(/^https:\/\/pixel.adsafeprotected.com\/rjss\/st\/(\d+)\//);null!==e&&(this.player.getConfig().advertiserEntityId=Number(e[1]),this.auctionId.forEach(e=>{this.player.getConfig().auctionId=e}))}const s=document.createElement("script");s.type="text/javascript",s.src=i,s.async=!0,n?this.parentContainer.insertBefore(s,this.parentContainer.firstChild):"DoubleVerify"===e?t.parentElement.appendChild(s):t.insertBefore(s,this.playerContainer.firstChild)})}loadAdVerificationScripts(e){e.getExtension(we.a.AD_VERIFICATIONS).map(t=>e.retrieveCreativePrefetchAdVerificationScriptUrls(t)).map(e=>{const t=this.getFunnelMacros();return a.map(e,({vendor:e,url:i})=>({vendor:e,url:He.h(t)(i)}))}).forEach(e=>{const t=()=>{this.insertViewabilityScripts(e,this.playerContainer)};Object(r.c)(this.player.getLinearAd().adParameters,this.player.getMediafile().url)?this.viewabilityTagsHelper.onceThresholdReached(t):t()})}}Je.DEFAULT_AD_HEIGHT=1;class Ze extends Te{constructor(e,t,i,n,s,r,a){super(e,t,i,n,s,r,a),this.placement=e,this.config=t,this.player=i,this.markId=n}load(e,t){super.load(e,t)}getTemplateName(){return"inread"}onAdLoaded(){super.onAdLoaded(),this.smartPositionHelper.enableBehavior(),this.smartPositionHelper.moveToCornerPosition();const e=this.smartPositionHelper.getOptimalDimension(this.parentContainer,"corner");this.parentContainer.style.setProperty("position","fixed"),this.parentContainer.style.setProperty("overflow","visible"),this.parentContainer.style.setProperty("width",e.width+"px"),this.parentContainer.style.setProperty("height",e.height+"px"),this.parentContainer.style.setProperty("right",We.MARGIN_FROM_EDGES_IN_PX+"px"),this.parentContainer.style.setProperty("bottom",We.MARGIN_FROM_EDGES_IN_PX+"px"),this.startAd()}onAdVideoStart(){super.onAdVideoStart(),this.openFormat()}fitContainerToContent(e){return null}getViewportInViewState(){return!0}initInternalResponsive(){super.initInternalResponsive(!1)}onVpaidReady(){super.onVpaidReady(),this.fullscreenHelper=new Pe(this.parentContainer,this.vpaidAd,this.components,this.responsive,this.win,this.playerContainer),this.brandingMode=new ze(this),this.formatConfig.smartPosition.setValue({corner:!0,top:!1,mustBypassWhitelist:!1}),this.smartPositionHelper=new We(this)}openFormat(){this.states.hasOpened=!0,this.placement.placementConfig.css.applyRulesOn(this.parentContainer)}}const et=e=>Object(a.includes)([70],e);function tt(e,t,i=null,n){const s=n&&n.display||e.adType.isDisplay()||e.adType.isNative(),r=function(e,t,i){let n={disable:!e.closeButton.isEnabled(),countdown:e.closeButton.getCountdown(),listenSkippableState:!1};(e.closeButton.hasToGetValueFromVast()||n.disable&&e.smartPosition.isTop())&&(n.disable=!1,t&&t.skipDelay?n.countdown=t.skipDelay:n.listenSkippableState=!0);i.isSliderEnabled()&&(n.disable=!0,n.listenSkippableState=!1);return n}(e,i,t),o=function(e,t){let i={disable:e.disable,listenSkippableState:e.listenSkippableState};t.isSliderEnabled()&&(i.disable=!0,i.listenSkippableState=!1);return i}(r,t);return{clicktoplay:{disable:!e.videoStart.isClick()},closebutton:{disable:r.disable,countdown:r.countdown,listenSkippableState:r.listenSkippableState},soundbutton:{disable:!!(s||e.sliderBehavior.isEnabled()||t.isSliderEnabled())||!e.soundButton.isEnabled,startOffset:e.soundButton.countdown,type:e.soundButton.type},progressbar:{disable:s||et(e.portfolioItemId)||!e.progressBar.isEnabled()},clickbutton:{disable:!!n||et(e.portfolioItemId)||!e.callButton.isEnabled(),startOffset:e.callButton.getCountdown(),text:e.callButton.getText()},label:{disable:!0,html:e.label.getHTML()},credits:{formatName:e.formatName.get(),disable:!0,text:e.credits.getText(),url:e.credits.getLink()},endscreen:{disable:!!(s||e.sliderBehavior.isEnabled()||t.isSliderEnabled())||(e.end.isCollapse()||e.end.isEndScreen()&&!e.endScreen.isEnabled()),countdown:e.endScreen.getCountdown(),callButton:e.endScreen.getCallButton(),closeButton:{disable:o.disable,listenSkippableState:o.listenSkippableState},replayButton:e.endScreen.getReplayButton(),autoClose:e.endScreen.getAutoClose()},fullscreenbutton:{disable:s||!e.playerClick.isFullscreen(),preventDefault:!0},brandlogo:{disable:!e.brandLogo.isEnabled(),url:e.brandLogo.getUrl()},startscreen:{disable:!e.adType.isVideo()},earlyclickoverlay:{disable:!a.includes(ke.c,e.adSourceId)},bannervideobottom:{disable:!(e.adType.isVideo()&&et(e.portfolioItemId)),text:e.bannerVideoBottom.getText()}}}var it=i(126),nt=i(104);function st({instancesStore:e,placement:t,formatConfig:i,vastPlayer:n,markId:s,sumologicLogger:r,adCallTrackOpts:a,auctionId:o,viewerId:d}){i.sliderBehavior.isEnabled()?t.enableSlider():t.isSliderEnabled()&&i.sliderBehavior.setValue({enable:!0});const c=i.sliderBehavior.isEnabled()?new Ze(t,i,n,s,o,d,r):new Je(t,i,n,s,a,o,d,r);return function(e,t,i){const n=i.formatConfig.formatName.get();e[n]||(e[n]=[]);e[n].push(i),i.setWigo(t)}(e,t.wigo,c),it.b(),c}var rt=i(13),at=i(113),ot=i(7);function dt(){return p.isDesktop()||p.isFirefox()&&p.isAndroid()}class ct{constructor(e,t,i){this.container=e,this.resize=h.noop,this.logger=new c.a("FixedBackground"),this.resizeContainer=e=>{e&&"orientationchange"===e.type&&(this.center=null);const t=g.getBoundingClientRect(this.container,!1),i=g.getWindowSize(this.win),n=Math.round(t.width),s=this.image.height*n/this.image.width;if(this.baseContainer.style.setProperty("width",n+"px"),this.baseContainer.style.setProperty("height",Math.round(t.height)+"px"),dt())this.center=this.center||(i.height-s)/2,this.baseContainer.style.setProperty("background-size",`${Math.round(n)}px ${Math.round(s)}px`),this.baseContainer.style.setProperty("background-position",`${Math.round(t.left)}px ${this.center}px`);else{this.fixedContainer.style.setProperty("width",Math.round(n)+"px"),this.fixedContainer.style.setProperty("height",Math.round(1.2*(i.height+s))+"px"),this.fixedContainer.style.setProperty("background-size",`${Math.round(n)}px ${Math.round(s)}px`),this.fixedContainer.style.setProperty("left",Math.round(t.left)+"px"),this.center=this.center||(i.height-s)/2%s;const e=this.center>0?this.center-s:this.center;this.fixedContainer.style.setProperty("top",e+"px")}},this.resizeVideoContainer=e=>{const t=g.getBoundingClientRect(this.container,!1),i=Math.round(t.width),n=Math.round(this.video.videoHeight*i/this.video.videoWidth);this.baseContainer.style.setProperty("width",i+"px"),this.baseContainer.style.setProperty("height",Math.round(t.height)+"px"),this.video.style.setProperty("width",i+"px"),this.video.width=i,this.video.style.setProperty("height",n+"px"),this.video.height=n,this.video.style.setProperty("left",Math.round(t.left)+"px")},this.win=f.getWindow(this.container),f.addClass(t,"teads-display-format"),this.resize=Object(h.isFunction)(i)?i:this.resize,this.eventListenerManager=new b.a,this.eventListenerManager.addMultiple(["resize","orientationchange"],this.win,()=>this.resize()),this.eventListenerManager.addMultiple(["transitionend","otransitionend","oTransitionEnd","webkitTransitionEnd"],this.container,()=>this.resize())}loadImage(e,t){this.image=new Image,this.image.onerror=e=>t(!1,o.b.empty()),this.image.onload=e=>{this.image.naturalWidth&&this.image.naturalHeight?t(!0,o.b.fromNullable(this.image)):(this.logger.error("setFixedBackgroundImage: Asset size error: cannot retrieve image dimensions"),t(!1,o.b.fromNullable(this.image)))},this.image.src=e}loadVideo(e,t,i){this.video&&this.destroy(),this.video=t.videoSlot,this.video.addEventListener(ot.a.ERROR,()=>{i(!1,o.b.empty())}),this.video.addEventListener(ot.a.LOADED_METADATA,()=>{this.video.videoWidth&&this.video.videoHeight?i(!0,o.b.fromNullable(this.video)):(this.logger.error("setFixedBackgroundVideo: Asset size error: cannot retrieve video dimensions"),i(!1,o.b.fromNullable(this.video)))}),this.video.src===e?(this.video.currentTime=0,i(!0,o.b.fromNullable(this.video))):(this.video.setAttribute("preload","auto"),this.video.src=e)}initContainer(){this.resize=this.resizeContainer,oe(ct.CSS,this.win,ct.STYLE_NODE_ID),this.baseContainer=this.win.document.createElement("div"),this.baseContainer.className=ct.CSSCLASSES.absolute,dt()?this.baseContainer.style.setProperty("background-image",`url(${this.image.src})`):(this.fixedContainer=this.win.document.createElement("div"),this.fixedContainer.style.setProperty("background-image",`url(${this.image.src})`),this.fixedContainer.className=ct.CSSCLASSES.fixed,this.baseContainer.style.setProperty("-webkit-clip-path","inset(1px 0px)","important"),this.baseContainer.style.setProperty("clip-path","inset(1px 0px)","important"),this.baseContainer.appendChild(this.fixedContainer)),this.resize()}initVideoContainer(e){this.resize=this.resizeVideoContainer,oe(ct.CSS,this.win,ct.STYLE_NODE_ID),this.baseContainer=this.baseContainer||this.win.document.createElement("div"),this.baseContainer.className=ct.CSSCLASSES.absolute,this.baseContainer.style.setProperty("-webkit-clip-path","inset(1px 0px)","important"),this.baseContainer.style.setProperty("clip-path","inset(1px 0px)","important"),(this.baseContainer.style.getPropertyValue("-webkit-clip-path")||this.baseContainer.style.getPropertyValue("clip-path"))&&f.addClass(this.video,ct.CSSCLASSES.videoScroller),e.subscribe(()=>{requestAnimationFrame(()=>{this.baseContainer.style.setProperty("display","none"),requestAnimationFrame(()=>{this.baseContainer.style.setProperty("display","block"),this.video.play()})})},K.a.AdVideoStart),e.subscribe(()=>this.video.play(),K.a.AdPlaying),e.subscribe(()=>this.video.pause(),K.a.AdPaused),this.eventListenerManager.add("scroll",this.win,()=>{const t=this.isInView(this.container,e)?1:0;this.video.style.setProperty("opacity",""+t,"important")}),this.baseContainer.appendChild(this.video),this.resize()}append(){this.container.style.setProperty("position","relative"),this.container.style.setProperty("z-index","100"),this.container.parentNode.insertBefore(this.baseContainer,this.container)}destroy(){this.baseContainer.parentNode.removeChild(this.baseContainer),this.eventListenerManager.removeAll()}getBaseContainer(){return this.baseContainer}isInView(e,t){return f.isInView({element:e,elementAncestors:f.findParentElements(e),elementClientRect:g.getBoundingClientRect(e),mainWindow:this.win,thresholdCoefficient:.001,elementHeight:t.getAdHeight()})}}ct.CSS=_.a,ct.CSSCLASSES={absolute:"teads-display-absolute",fixed:"teads-display-fixed",clickZone:"teads-display-clickzone",videoScroller:"teads-video-scroller"},ct.STYLE_NODE_ID="teads-inread-display";var lt=i(134),ht=i(107),ut=i(67);class pt{constructor(e,t,i){this.placement=e,this.format=t,this.gdprIab=i,this.adMetadata=o.a,this.logger=new c.a("VPAIDApi");const n=this.placement.getPlayerContainer(),s=f.getWindow(n);this.communicationBridge=new at.a(this,s),this.communicationBridge.startListening()}close(){this.communicationBridge&&this.communicationBridge.stopListening()}setStudioData(e){const t=this.format.getVpaidAd();this.studioData=e,t.status>=rt.a.STARTED?this.applyStudioDataOnUI():t.subscribe(Object(S.a)(this.applyStudioDataOnUI,this),K.a.AdStarted)}applyStudioDataOnUI(){if(this.studioData)try{ve.b.vast.setStudioCreativeId(this.format.placement.key)(this.studioData.studio_cid);const e=this.format.getVpaidAd(),t=e.getComponent("soundbutton");t&&t.setShowOnVideoStart(!this.studioData.display);const i=e.getComponent("progressbar");i&&(i.setShowOnVideoProgress(!this.studioData.display),i.setShowOnVideoStart(!this.studioData.display)),this.setSoundControlVisibility(!this.studioData.display),this.setProgressControlVisibility(!this.studioData.display)}catch(e){this.logger.error("setStudioData error "+e.message)}else this.logger.error("applyStudioDataOnUI error","studioData needed to apply them on UI")}getSumologicOption(){return{enabled:u.b.isSumologicLogsEnabled,pid:this.placement.pid,formatVersion:"822"}}isStudioDisplay(){return this.studioData&&this.studioData.display}getStudioData(){try{this.studioData=this.studioData||nt.b(this.format.linearAd)}catch(e){this.logger.error("getStudioData error","format has not been instantiated yet",e)}return this.studioData}getContextData(){return e=this.format.linearAd,t=this.gdprIab,Object.assign(Object.assign({},lt.a(e)),{gdpr:{applies:Object(ut.b)(Object(ut.a)(t.status)),consent:t.consent}});var e,t}isReplay(){return this.format.states.isReplay}activateTapMode(e=!0){}performTapMode(e){let t=this.format.getBrandingMode();t&&(void 0===e&&(e=!t.isActive()),e?t.isInitialized()?t.isActive()||t.start():(t.init(),t.start()):t.isActive()?(t.stop(),t.deinit()):t.isInitialized()&&t.deinit())}isFullscreen(){return this.format.getFullscreenHelper().isActive()}requestFullscreen(){try{this.format.getVpaidAd().dispatchCustomEvent("FullscreenRequest")}catch(e){this.logger.error("requestFullscreen error "+e.message)}}setSoundControlVisibility(e){try{const t=this.format.getVpaidAd();e?t.showComponent("soundbutton"):t.hideComponent("soundbutton")}catch(e){this.logger.error("setSoundControlVisibility error "+e.message)}}setFullscreenButtonVisibility(e){try{const t=this.format.getVpaidAd();e?t.showComponent("fullscreenbutton"):t.hideComponent("fullscreenbutton")}catch(e){this.logger.error("setFullscreenButtonVisibility error "+e.message)}}setProgressControlVisibility(e){try{const t=this.format.getVpaidAd();e?t.showComponent("progressbar"):t.hideComponent("progressbar")}catch(e){this.logger.error("setProgressControlVisibility error "+e.message)}}setStartScreenVisibility(e){try{const t=this.format.getVpaidAd();e?t.showComponent("startscreen"):t.hideComponent("startscreen")}catch(e){this.logger.error("setStartScreenVisibility error "+e.message)}}isVideoBanner(){return e=this.format.formatConfig.portfolioItemId,Object(a.includes)([70],e);var e}getCreativeSize(){return this.format.formatConfig.creativeSize}getSlotBounds(){var e;const t=!(null!==(e=window.FORCE_DEMO)&&void 0!==e&&e);return Ie.a.tryCatch(()=>{var e,i;const n=this.placement.getPlayerContainer(),s=f.getWindow(n),r=g.getBoundingClientRect(n,t),a=null!==(i=null===(e=this.format.responsive)||void 0===e?void 0:e.getContainerWidth())&&void 0!==i?i:r.width;return Object.assign(Object.assign({},r),{viewportHeight:s.innerHeight,viewportWidth:s.innerWidth,maxWidth:a})}).orElse(e=>(this.logger.error("getSlotBounds error "+e.message),Object(Ie.b)(e))).toOption().getOrNull()}sendAdClickThru(e){Ie.a.tryCatch(()=>{this.format.getVpaidAd().dispatchCustomEvent(K.a.AdClickThru,e)}).tapLeft(e=>this.logger.error("sendAdClickThru error "+e.message))}sendVideoMetadata(e){var t;t=this.format.formatConfig.portfolioItemId,Object(a.includes)([15,16,43,50,51],t)&&(this.adMetadata=o.b.fromNullable(e)),Ie.a.tryCatch(()=>{this.format.getVpaidAd().dispatchCustomEvent(Oe.a.AdVideoMetadata,e)}).tapLeft(e=>this.logger.error("sendVideoMetadata error "+e.message))}hideCredits(){Ie.a.tryCatch(()=>{var e;return o.b.fromNullable(null===(e=this.format.components.getComponent("credits"))||void 0===e?void 0:e.getElement()).forEach(e=>{e.style.display="none"})}).tapLeft(e=>this.logger.error("Something went wrong when trying to hide the credits",e))}sendReplayRequest(){Ie.a.tryCatch(()=>{this.format.getVpaidAd().dispatchCustomEvent(B.a.ReplayRequest)}).tapLeft(e=>this.logger.error("sendReplayRequest error "+e.message))}setFixedBackgroundImage(e,t=h.noop){this.fixedBackgroundImage=this.fixedBackgroundImage||new ct(this.placement.getPlayerContainer(),this.placement.getParentContainer());const i=this.format.getVpaidAd();this.setBackgroundColor("transparent"),this.hideVideoContainer(),p.isUIWebview()||i.subscribe(()=>this.fixedBackgroundImage.resize(),K.a.AdSizeChange),i.subscribe(()=>this.fixedBackgroundImage.resize(),K.a.AdStarted),i.subscribe(()=>this.fixedBackgroundImage.destroy(),K.a.AdStopped),i.subscribe(()=>this.fixedBackgroundImage.destroy(),K.a.AdError),this.fixedBackgroundImage.loadImage(e,()=>{this.fixedBackgroundImage.initContainer(),this.logger.debug("background image ready !"),i.status>=rt.a.LOADED?(this.fixedBackgroundImage.append(),this.checkTouchOverflow(this.fixedBackgroundImage)):i.subscribe(()=>{this.fixedBackgroundImage.append(),this.checkTouchOverflow(this.fixedBackgroundImage)},K.a.AdLoaded),t()})}setFixedBackgroundVideo(e,t=h.noop){this.fixedBackgroundVideo=this.fixedBackgroundVideo||new ct(this.placement.getPlayerContainer(),this.placement.getParentContainer());const i=this.format.getVpaidAd();this.setBackgroundColor("transparent"),this.hideVideoContainer(),p.isUIWebview()||i.subscribe(()=>this.fixedBackgroundVideo.resize(),K.a.AdSizeChange),i.subscribe(()=>this.fixedBackgroundVideo.resize(),K.a.AdStarted),i.subscribe(()=>this.fixedBackgroundVideo.destroy(),K.a.AdStopped),i.subscribe(()=>this.fixedBackgroundVideo.destroy(),K.a.AdError),this.fixedBackgroundVideo.loadVideo(e,this.format.getEnvironmentVars(),e=>{e&&(this.fixedBackgroundVideo.initVideoContainer(i),this.logger.debug("background video ready !"),i.status>=rt.a.LOADED?(this.fixedBackgroundVideo.append(),this.checkTouchOverflow(this.fixedBackgroundVideo)):i.subscribe(()=>{this.fixedBackgroundVideo.append(),this.checkTouchOverflow(this.fixedBackgroundVideo)},K.a.AdLoaded)),t()})}hideVideoContainer(){(e=>(Object(p.isAmp)()||Object(p.isIABSafeFrame)())&&"IFRAME"!==e.tagName?e.ownerDocument:e.contentDocument)(this.format.getVpaidAd().getCreativeContainer()).getElementById("video-container").style.setProperty("display","none")}setBackgroundColor(e){try{this.format.getVpaidAd().getVPAIDContainer().style.setProperty("background-color",e)}catch(e){this.logger.error("setBackgroundColor error "+e.message)}}addDeviceOrientationListener(){ht.a(this,this.communicationBridge,f.getWindow(this.placement.getPlayerContainer()))}getUserLocation(e,t){ht.c(f.getWindow(this.placement.getPlayerContainer()),e,t)}customizeUI(e){o.b.fromNullable(this.placement).match({some:t=>o.b.fromNullable(this.format).match({some:t=>o.b.fromNullable(t.getVpaidAd()).match({some:t=>{const i=f.getWindow(t.getMainComponentsContainer());var n,s;n="vpaid-ui-custom-css",s=i,o.b.fromNullable(null==s?void 0:s.document).flatMap(e=>o.b.fromNullable(e.getElementById(n))).forEach(e=>o.b.fromNullable(e.parentNode).forEach(t=>t.removeChild(e))),oe(e,i,"vpaid-ui-custom-css")},none:()=>this.logger.error("customizeUI: getVpaidAd() returned undefined or null")}),none:()=>this.logger.error("customizeUI: getFormat() returned undefined or null")}),none:()=>this.logger.error("customizeUI: this.placement is undefined or null")})}getTeadsInfo(){return{placementId:this.format.formatConfig.placementId||null,connectionId:this.format.formatConfig.connectionId||null,insertionId:this.format.formatConfig.insertionId||null,creativeId:parseInt(this.format.linearAd.creativeId,10)||null,clickPixels:Object(a.map)(this.format.linearAd.tracking.click,({url:e})=>e),slotType:this.format.slotType,environment:p.getEnv()}}triggerViewabilityTag(e){try{this.format.viewabilityTagsHelper.onceThresholdReached(e)}catch(e){this.logger.error("triggerViewabilityTag error "+e.message)}}isMobile(){return p.isMobile()||p.isTablet()}isSDK(){return Object(p.isSDK)()}getCreativeTag(e){var t,i;try{return this.format.viewabilityTagsHelper.getCreativeTag(e,o.b.fromNullable(null===(i=null===(t=this.format)||void 0===t?void 0:t.formatConfig)||void 0===i?void 0:i.portfolioItemId))}catch(t){return this.logger.error(`"Unable to get creative tag: "${t}"`),e}}checkTouchOverflow(e){const t=(e,i)=>e===i||!(!i||!i.parentElement)&&t(e,i.parentElement);try{const i=this.placement.getParentContainer(),n=e.getBaseContainer();((e,i)=>{const n=g.getBoundingClientRect(e),s=f.getDocument(e).elementFromPoint(n.left+n.width/2,n.top+i);return s===e||t(e,s)})(i,-10)&&n.style.setProperty("z-index","-1")}catch(e){}}}pt.STUDIO_CID_MACRO_METADATA="[STUDIO_CID]";var gt=i(121),mt=i(17),bt=i(37);class ft{constructor(e){this.ui=e}init(e,t){this.closeButton=o.b.fromNullable(this.ui.getComponent("closebutton")),this.soundButton=o.b.fromNullable(this.ui.getComponent("soundbutton")),this.clickButton=o.b.fromNullable(this.ui.getComponent("clickbutton")),this.adChoicesButton=o.b.fromNullable(this.ui.getComponent("adchoices")),this.closeButtonMode=this.closeButton.map(e=>e.mode).getOrNull(),this.closeButton&&2!==this.closeButtonMode&&!e&&this.ui.subscribe(t,K.a.AdVideoMidpoint)}setCornerPositionPlayerComponents(e){this.clickButton.forEach(e=>{e.hide(),e.getConfig().disable=!0}),this.soundButton.forEach(e=>e.hide()),this.closeButton.forEach(e=>e.hide()),this.adChoicesButton.forEach(e=>e.hide()),2===this.closeButtonMode&&this.closeButton.forEach(t=>t.changeOnCountdownEnded(()=>{t.show(),e.showHeaderCloseButton()})),e.shouldShowCloseButton&&e.showHeaderCloseButton()}setTopPositionPlayerComponents(e){this.clickButton.forEach(e=>{e.hide(),e.getConfig().disable=!0}),this.closeButton.forEach(t=>t.onClickAction=Object(o.c)(e.onCloseButtonClick)),this.adChoicesButton.forEach(e=>e.show()),1===this.closeButtonMode&&e.shouldShowCloseButton&&this.closeButton.forEach(e=>e.show())}cleanupCornerPositionSpecificUI(e){this.clickButton.forEach(e=>{e.show(),e.getConfig().disable=!1}),this.adChoicesButton.forEach(e=>e.show()),this.soundButton.forEach(e=>e.show()),1!==this.closeButtonMode&&this.closeButton.forEach(e=>e.show()),2===this.closeButtonMode&&this.closeButton.forEach(t=>t.changeOnCountdownEnded(()=>{t.show(),e()}))}cleanupTopPositionSpecificUI(){this.clickButton.forEach(e=>{e.show(),e.getConfig().disable=!1}),this.closeButton.forEach(e=>e.restoreOnClickAction()),1===this.closeButtonMode&&this.closeButton.forEach(e=>e.hide())}isCloseButtonMode(e){return e===this.closeButtonMode}showCloseButton(){this.closeButton.forEach(e=>e.show())}hideCloseButton(){this.closeButton.forEach(e=>e.hide())}}var vt=i(70),At=i(52),yt=i(72),wt=i(130),Et=i(141),Ot=i.n(Et);const Ct=Ot.a;function It(e){var t=[];return t.length>0&&(e=e.replace('id="main-container"','id="main-container" class="'+t.join(" ")+'"')),e}const St=It(Ot.a);var Tt=i(75);function kt(e,t,i=!0){const n=e[t];n&&n.isEnabled()&&(i?n.show():n.hide())}function jt(e,t=!0){a.forEach(e,(function(e){e.isEnabled()&&(t?e.show():e.hide())}))}var Pt=i(155),Lt=i.n(Pt);class xt extends Q{constructor(){super(...arguments),this.timerClass="countdown-timer"}init(){if(this.countdown=Number(this.config.countdown),this.countdown<=0||isNaN(this.countdown))this.onEnded();else{var e=ie.a(xt.TEMPLATE,{"countdown-duration":this.countdown,"countdown-id":"countdown-"+A.rand(10)});this.getElement().innerHTML=e,this.countdownTextElement=this.getElement().querySelector("."+this.timerClass)}}initTimer(){this.timerInterval=setInterval(()=>{this.isPaused()||this.countdown--,this.countdown<=0?(this.hide(),this.onEnded()):this.updateDisplay()},1e3),this.updateDisplay()}stopTimer(){clearInterval(this.timerInterval)}setCountdown(e){this.countdown=e,this.updateDisplay()}resume(){this.paused=!1}pause(){this.paused=!0}isPaused(){return this.paused}isEnded(){return this.ended}setEndedCallback(e){this.callback=e}removeEndedCallback(){this.callback=null}onEnded(){if(clearInterval(this.timerInterval),this.ended=!0,this.hide(),this.callback&&"function"==typeof this.callback)try{this.callback()}catch(e){this.logger.error("countdown ended callback failled",e)}}updateDisplay(){this.countdownTextElement&&this.countdownTextElement.setAttribute&&this.countdownTextElement.setAttribute("data-countdown",String(this.countdown))}}xt.TEMPLATE=Lt.a;function Vt(e){var t="00";e>60&&(t=Math.floor(e/60)<10?"0":"");return t+=":"+(e<10?"0":"")+e}class Nt extends Q{constructor(){super(...arguments),this.placeholders=["currentTime","totalTime","remainingTime","countdown"]}init(){this.setText(this.config.text)}setText(e=""){this.renderText(e),this.havePlaceholder(e)&&!this.haveProgressCallback&&(this.haveProgressCallback=!0,this.vpaid.subscribe(()=>{this.renderText(e)},K.a.AdRemainingTimeChange))}renderText(e){this.textNode&&this.getElement().removeChild(this.textNode),this.textNode=document.createElement("span"),this.textNode.innerHTML=this.havePlaceholder(e)?this.replacePlaceholders(e):e,this.getElement().appendChild(this.textNode)}replacePlaceholders(e){const t={};return Object(a.forEach)(this.placeholders,e=>{t[e]=this.getPlaceholderValue(e)}),ie.a(e,t)}havePlaceholder(e){const t=new RegExp("({{"+this.placeholders.join("}}|{{")+"}})","g");return!!e.match(t)}getPlaceholderValue(e){let t=$(this.vpaid);t=t<0||isNaN(t)?0:Math.floor(t);const i=Math.floor(this.vpaid.getAdRemainingTime());switch(e){case"currentTime":return Vt(t);case"totalTime":return Vt(Math.floor(this.vpaid.getAdDuration()));case"remainingTime":return Vt(i);case"countdown":return String((this.config.countdown||0)-t)}}}var Dt=i(156),_t=i.n(Dt);class Rt extends Q{init(){this.logger.debug("init endscreen"),this.showOnVideoStart=!1;var e=this.element.getAttribute("style");this.element.setAttribute("style",(e?e+";":"")+" opacity: 0.8!important; background-color: #ffffff;"),this.getElement().innerHTML=Rt.TEMPLATE,this.vpaid.subscribe(()=>{if(this.logger.debug("video complete"),this.videoComplete=!0,this.dispatchVpaidEvent(K.a.AdVideoComplete),this.ui.getConfig().noAutoStop){this.show(),this.initLayout();let e=this.ui.getVPAIDContainer();e.style.setProperty("filter","blur(3px)"),e.style.setProperty("webkit-filter","blur(3px)"),this.dispatchVpaidEvent(B.a.EndscreenInit)}},K.a.AdVideoComplete),this.vpaid.subscribe(()=>{this.videoComplete&&!this.ui.getConfig().noAutoStop&&(this.show(),this.initLayout(),this.dispatchVpaidEvent(B.a.EndscreenInit))},K.a.AdStopped),this.hide()}getOverridenEvents(){return this.videoComplete?[K.a.AdStopped]:[K.a.AdVideoComplete]}getOverridenMethods(){return this.isVisible()?["pauseAd","resumeAd"]:[]}onOverridenMethod(e,t){this.countdown&&("pauseAd"===e?this.countdown.pause():"resumeAd"===e&&this.countdown.resume())}onMethod(e,t=[]){"resizeAd"===e&&this.videoComplete&&(this.logger.debug("resizeAd from endscreen",t),this.resize(t[0],t[1]),this.dispatchVpaidEvent(K.a.AdSizeChange))}initLayout(){var e;if(this.replayButton=g.getElementsByClassName("replay-button",this.getElement(),this.ui.getContentWindow())[0],this.replayButton){g.addEventListener("click",this.replayButton,()=>{this.onReplayClick()});try{o.b.fromNullable(null===(e=this.config.replayButton)||void 0===e?void 0:e.text).forEach(e=>{g.getElementsByClassName("text",this.replayButton,this.ui.getContentWindow())[0].innerHTML=e})}catch(e){this.logger.error("No text on replay button")}p.isEdgeTouchScreen()&&(this.replayButton.className="button edge-touch-screen replay-button")}else this.logger.debug("No replayButton on endscreen !");if(this.callButton=g.getElementsByClassName("call-button",this.getElement(),this.ui.getContentWindow())[0],this.callButton&&this.config.callButton&&this.ui.getConfig().clickthrough){if(g.addEventListener("click",this.callButton,()=>{this.dispatchUiEvent(B.a.ClickRequest),this.onActionClick()}),this.config.callButton.text){var t=this.callButton.querySelector(".icon span");if(t){let e=Rt.CSSClassMapping[this.config.callButton.type]||(()=>{for(let e in Rt.CSSClassMapping)return Rt.CSSClassMapping[e]})();f.addClass(t,e)}try{g.getElementsByClassName("text",this.callButton,this.ui.getContentWindow())[0].innerHTML=this.config.callButton.text}catch(e){this.logger.error("No text on callButton")}p.isEdgeTouchScreen()&&(this.callButton.className="button edge-touch-screen call-button")}}else this.callButton&&this.callButton.parentNode&&this.callButton.parentNode.removeChild(this.callButton),this.logger.debug("No callButton on endscreen !");this.adChoicesButton=g.getElementsByClassName("adchoices",this.getElement(),this.ui.getContentWindow())[0],this.adChoicesButton?this.ui.getConfig().showAdChoicesIcon?(p.isMobile()||(g.addEventListener("mouseover",this.adChoicesButton,()=>{f.addClass(this.adChoicesButton,"expanded"),this.adChoicesButton.style.setProperty("width","auto"),this.adChoicesButton.style.setProperty("height","15px"),this.adChoicesButton.style.setProperty("padding","0px 17px 1px 4px")}),g.addEventListener("mouseout",this.adChoicesButton,()=>{f.removeClass(this.adChoicesButton,"expanded")})),g.addEventListener("click",this.adChoicesButton,()=>{this.dispatchUiEvent(B.a.AdChoicesClickRequest)})):(f.removeClass(this.adChoicesButton,"show"),f.addClass(this.adChoicesButton,"hide")):this.logger.debug("No adChoicesButton on endscreen !"),this.closeButton=g.getElementsByClassName("close-button",this.getElement(),this.ui.getContentWindow())[0],this.closeButton?!this.config.closeButton||this.config.closeButton.disable||this.config.closeButton.listenSkippableState&&!this.vpaid.getAdSkippableState()?(f.removeClass(this.closeButton,"show"),f.addClass(this.closeButton,"hide")):g.addEventListener("click",this.closeButton,()=>{this.dispatchVpaidEvent(K.a.AdUserClose),this.closeAd()}):this.logger.debug("No closeButton on endscreen !");var i=g.getElementsByClassName("countdown",this.getElement(),this.ui.getContentWindow())[0];i?(this.countdown=new xt(this.ui,i,this.vpaid,{countdown:this.config.countdown}),this.config.autoClose&&this.countdown.setEndedCallback(()=>{this.logger.debug("Countdown ended and autoClose on, close ad"),this.closeAd()}),this.countdown.init(),this.countdown.initTimer(),this.countdown.show()):this.logger.debug("No countdown on endscreen"),this.resize(this.ui.getAdWidth(),this.ui.getAdHeight())}resize(e,t){}onClick(e){}onReplayClick(){this.clearCloseInterval(),this.ui.getConfig().noAutoStop&&this.vpaid.stopAd(),this.videoComplete=!1,this.dispatchUiEvent(B.a.ReplayRequest)}onActionClick(){var e=this.ui.getConfig().clickthrough||null;this.dispatchVpaidEvent(K.a.AdClickThru,{url:e,id:null,playerHandles:!0})}clearCloseInterval(){this.countdown&&(this.countdown.removeEndedCallback(),this.countdown.stopTimer())}closeAd(){this.clearCloseInterval(),this.ui.stopAd()}}Rt.CSSClassMapping={learnMore:"icon-learnmore",shopNow:"icon-shop",contactUs:"icon-contact",signUp:"icon-signup"},Rt.TEMPLATE=_t.a;const Mt={fullscreenbutton:class extends Q{init(){this.eventName=B.a.FullscreenRequest,this.showOnVideoStart=!1,super.init(),this.show()}bindClick(){g.addEventListener("mousedown",this.getElement(),e=>{this.onClick(e)})}},earlyclickoverlay:class extends Q{constructor(){super(...arguments),this.startTimer=()=>{setTimeout(()=>this.hide(),750),this.vpaid.unsubscribe(this.startTimer,K.a.AdStarted)}}init(){this.eventName=B.a.EarlyClickRequest,this.vpaid.subscribe(this.startTimer,K.a.AdStarted),super.init(),this.show()}onVideoStart(){}},mutebutton:J,progressbar:class extends Q{constructor(){super(...arguments),this.showOnVideoProgress=!0}init(){if(this.progressbar=g.getElementsByClassName("progress",this.getElement(),this.ui.getContentWindow())[0],this.progressBarContainer=this.getElement(),this.progressBarContainer.style.setProperty("width","100%"),!this.progressbar)return this.hide();this.vpaid.subscribe(()=>{this.onProgress()},K.a.AdRemainingTimeChange),this.vpaid.subscribe(()=>{this.hide()},K.a.AdVideoComplete),super.init()}setShowOnVideoProgress(e){this.showOnVideoProgress=e}getShowOnVideoProgress(){return this.showOnVideoProgress}onProgress(){var e=$(this.vpaid);this.vpaid.getAdDuration()>0&&e>0?(!this.isVisible()&&this.showOnVideoProgress&&this.show(),this.progressbar.style.setProperty("width",e/this.vpaid.getAdDuration()*100+"%")):this.hide()}},playpausebutton:class extends Q{init(){this.eventName=B.a.PlayPauseRequest,this.vpaid.subscribe(()=>{this.onPause()},K.a.AdPaused),this.vpaid.subscribe(()=>{this.onPause()},K.a.AdVideoComplete),this.vpaid.subscribe(()=>{this.onPlay()},K.a.AdPlaying),this.vpaid.subscribe(()=>{this.onPlay()},K.a.AdVideoStart),super.init()}onClick(e){super.onClick(e),this.isPlaying?this.vpaid.pauseAd():this.vpaid.resumeAd()}onPlay(){this.isPlaying=!0,f.addClass(this.getElement(),"playing")}onPause(){this.isPlaying=!1,f.removeClass(this.getElement(),"playing")}},progresstext:class extends Q{init(){this.vpaid.subscribe(()=>{var e=this.vpaid.getAdRemainingTime();isNaN(e)&&(e=this.vpaid.getAdDuration()),this.getElement().innerHTML="Your video in "+Math.ceil(e)+" sec"},K.a.AdRemainingTimeChange)}},skipbutton:class extends Q{init(){const e=o.b.fromNullable(this.ui.getConfig().skipoffset);if(this.eventName=B.a.SkipRequest,this.config.listenSkippableState)return void this.hide();const t=setInterval(()=>{this.vpaid.getAdSkippableState()?this.vpaid.getAdSkippableState()&&(clearInterval(t),this.getElement().style.setProperty("cursor","pointer"),this.getElement().innerHTML="Skip Ad >>",this.show()):e.filter(e=>e>0).forEach(e=>{const t=Math.floor(e-$(this.vpaid));this.getElement().innerHTML="Skip in "+(isNaN(t)?e:t<0?0:t)+" sec",this.show()})},1e3);super.init()}onClick(e){super.onClick(e),this.vpaid.getAdSkippableState()&&this.vpaid.skipAd()}},closebutton:class extends Q{constructor(){super(...arguments),this.onClickAction=o.a}init(){const e=o.b.fromNullable(this.config.countdown).filter(e=>e>=0).getOrElse(()=>this.ui.getConfig().skipoffset);if(this.eventName=B.a.CollapseRequest,this.vpaid.subscribe(()=>{this.videoEnded=!0},K.a.AdVideoComplete),this.config.listenSkippableState)this.mode=1,this.vpaid.subscribe(()=>{this.vpaid.getAdSkippableState()?this.show():this.hide()},K.a.AdSkippableStateChange);else if(Object(h.isNumber)(e)&&e>0){this.mode=2;const t=this.insertCountDownElement();this.countdown=new xt(this.ui,t,this.vpaid,{countdown:e}),this.countdown.setEndedCallback(()=>this.onCountdownEnded())}else 0===e&&(this.mode=3,this.countdownEnded=!0,this.show())}onMethod(e,t){this.countdown&&this.countdownInitiated&&!this.countdownEnded&&o.b.fromNullable({pauseAd:()=>this.countdown.pause(),resumeAd:()=>this.countdown.resume()}[e]).forEach(e=>e())}show(){super.show();const e=this.getElement().getElementsByClassName("close-button icon-close")[0];this.countdown&&!this.countdownEnded||f.removeClass(e,"hide")}restoreOnClickAction(){this.onClickAction=o.a}changeOnCountdownEnded(e){this.countdown.setEndedCallback(()=>{this.countdown.hide(),this.countdownEnded=!0,e()})}onVideoStart(){this.countdownInitiated||this.config.listenSkippableState||(super.onVideoStart(),this.countdown.init(),this.countdown.show(),this.countdownInitiated=!0,this.countdown.initTimer())}onClick(e){this.onClickAction.match({some:e=>{e()},none:()=>{this.countdownEnded&&(this.videoEnded?super.onClick(e):(this.dispatchUiEvent(B.a.CollapseRequest),this.vpaid.skipAd()))}})}insertCountDownElement(){const e=document.createElement("div");return e.className="countdown",this.getElement().appendChild(e),e}onCountdownEnded(){this.countdown.hide(),this.countdownEnded=!0,this.show()}},uibutton:class extends Q{init(){var e=!0;this.eventName=B.a.UIButtonRequest,g.addEventListener("click",this.getElement(),t=>{this.onClick(t),e?this.ui.hideAllComponents():this.ui.showAllComponents(),this.ui.showComponent("uibutton"),e=!e,f.toggleClass(this.getElement(),"ui-invisible")})}},textfield:Nt,clicktoplay:class extends Q{init(){this.showOnVideoStart=!1,this.eventName=B.a.ClickToPlayRequest}onMethod(e,t=[]){"startAd"===e&&(this.show(),this.dispatchVpaidEvent(K.a.AdStarted))}getOverridenEvents(){return[K.a.AdStarted]}getOverridenMethods(){return["startAd"]}onClick(e){super.onClick(e),f.addClass(this.getElement(),"loading"),this.vpaid.subscribe(()=>{this.remove()},K.a.AdStarted),this.remove(),this.vpaid.startAd()}},clickbutton:class extends Nt{init(){if(this.clickthrough=this.ui.getConfig().clickthrough,this.eventName=B.a.ClickRequest,this.config.text&&this.clickthrough){const e=document.createElement("div");e.className="text",e.innerHTML=this.config.text,this.getElement().appendChild(e)}else this.hide();this.vpaid.subscribe(()=>{this.hide()},K.a.AdVideoComplete)}onVideoStart(){this.showOnVideoStart&&this.config.text&&this.clickthrough&&this.show()}onClick(e){super.onClick(e),this.dispatchVpaidEvent(K.a.AdClickThru,{url:this.clickthrough,id:this.config.id,playerHandles:!0})}},soundbutton:class extends J{init(){super.init(),this.eventName=B.a.SoundToggleRequest;const e=document.createElement("div");e.className=Z.OFF,this.getElement().appendChild(e);const t=()=>{Object(f.replaceClass)(e,this.vpaid.getAdVolume()>0?Z.ON:Z.OFF,this.vpaid.getAdVolume()>0?Z.OFF:Z.ON)};this.vpaid.subscribe(t,K.a.AdVolumeChange),this.vpaid.subscribe(t,K.a.AdStarted)}setAdVolume(){}onClick(e){super.onClick(e)}},label:class extends Q{constructor(){super(...arguments),this.defaultText="Advertising"}init(){let e=this.config.html&&""!==this.config.html?this.config.html:this.config.text||this.defaultText;this.getElement().innerHTML=e,this.getElement().setAttribute("style",this.config.style||""),this.show()}},credits:class extends Q{constructor(){super(...arguments),this.defaultLink={inRead:"https://hp.teads.com/?utm_source=inread&utm_medium=credits&utm_campaign=invented%20by%20teads",inBoard:"https://hp.teads.com/?utm_source=inboard&utm_medium=credits&utm_campaign=invented%20by%20teads"}}init(){const e="inboard"===this.config.formatName?"inBoard":"inRead";this.config.text=this.config.text||"Ads by [Teads]";const t=this.config.text.replace(/\[([^\]]*)\]/g,'<span class="teads-ui-component-credits-blue">$1</span>'),i=this.config.url||this.defaultLink[e];this.getElement().innerHTML='<a href="'+i+'" target="_blank">'+t+"</a>",this.show()}},endscreen:Rt,brandlogo:class extends Q{init(){this.clickthrough=o.b.fromNullable(this.ui.getConfig().clickthrough),this.eventName=B.a.ClickRequest;this.load(()=>{this.getElement().style.setProperty("background-image","url("+this.config.url+")")})}load(e){o.b.fromNullable(this.config.url).forEach(t=>{const i=new Image;i.onload=()=>e(),i.onerror=e=>this.hide(),i.src=t})}onVideoStart(){this.showOnVideoStart&&this.show()}onClick(e){super.onClick(e),this.clickthrough.forEach(e=>{this.dispatchVpaidEvent(K.a.AdClickThru,{url:e,id:this.config.id,playerHandles:!0})})}},countdown:xt,startscreen:class extends Q{init(){this.showOnVideoStart=!1,this.element.style.setProperty("z-index","2"),this.show(),this.vpaid.subscribe(()=>this.hide(),K.a.AdStarted)}},adchoices:class extends Q{init(){if(this.ui.getConfig().showAdChoicesIcon){this.eventName=B.a.AdChoicesClickRequest,p.isMobile()||(g.addEventListener("mouseover",this.getElement(),Object(S.a)(this.onMouseOver,this)),g.addEventListener("mouseout",this.getElement(),Object(S.a)(this.onMouseOut,this)));const e=this.getElement().style;e.setProperty("width","auto"),e.setProperty("height","15px"),e.setProperty("padding","1px 17px 1px 4px"),this.vpaid.subscribe(()=>{this.hide()},K.a.AdVideoComplete)}else this.remove()}onMouseOver(){f.addClass(this.getElement(),"expanded")}onMouseOut(){f.removeClass(this.getElement(),"expanded")}},bannervideobottom:class extends Nt{init(){if(this.clickthrough=this.ui.getConfig().clickthrough,this.config.text&&this.clickthrough){const e=document.createElement("div");e.className="container";const t=document.createElement("a");t.className="cta",t.innerHTML=this.config.text,e.appendChild(t),this.getElement().appendChild(e),this.show()}else this.hide()}onClick(e){super.onClick(e),this.dispatchVpaidEvent(K.a.AdClickThru,{url:this.clickthrough,id:this.config.id,playerHandles:!0})}}};var Ft=i(101);class Ut extends Ee.a{constructor(e,t,i,n){if(super(),this.mainContainer=e,this.config=i,this.loaderConfig=n,this.isFullscreen=!1,this.components=[],this.componentsByName={},this.logger=new c.a("ui.VPAIDUI"),this.initAdStartTime=0,this.logger.debug("Init Layout",e,i),this.config.container){this.container=this.config.container;let e=this.mainContainer.firstElementChild;e&&"main-container"===e.id&&this.mainContainer.removeChild(e)}else this.container=f.createIframe("vpaid-ui");this.container.parentNode||this.mainContainer.appendChild(this.container),o.b.fromNullable(this.container.contentWindow).forEach(e=>{e.document.write(t),e.document.close(),this.initHeavyAdInterventionListener(e),p.isAmp()||p.isIABSafeFrame()||g.addEventListener("resize",e,()=>{this.logger.debug("resize on player Iframe detected, trigger an AdSizeChange VPAID event"),this.dispatchEvent(K.a.AdSizeChange)}),this.mainComponentsContainer=e.document.getElementById("main-container")}),(p.isAmp()||p.isIABSafeFrame())&&(this.mainContainer.appendChild(this.mainComponentsContainer),this.mainContainer.removeChild(this.container)),o.b.fromNullable(this.mainComponentsContainer.ownerDocument).forEach(e=>{this.videoComponentsContainer=e.getElementById("layout-video-component")})}initAd(e,t,i,n,s="",r={}){if(this.vpaid)return this.resize(e,t,i),this.initAdStartTime=Object(l.l)(),this.logger.debug("initAd"),super.initAd(e,t,i,n,s,r);this.logger.error("You must register vpaid creative to be wrapped using setVPAID() method")}startAd(){this.status<rt.a.LOADED?this.dispatchEvent(K.a.AdLog,"VPAID not started, use initAd(), and wait for AdLoaded event before call startAd() method"):this.status>=rt.a.STARTING?this.dispatchEvent(K.a.AdLog,"cannot call startAd() twice, already started"):(this.render(this.getVPAID()),this.logger.debug("startAd"),super.startAd())}resizeAd(e,t,i="normal"){e<=0||t<=0||(this.resize(e,t,i),super.resizeAd(e,t,i))}stopAd(){const e=()=>{y.d(()=>{this.container.parentNode&&this.container.parentNode.removeChild(this.container)},2e3),this.dispatchedEvents[K.a.AdStopped]||this.dispatchEvent(K.a.AdStopped)};this.isStopped?(this.logger.debug("Wrapped vpaid already stopped, remove UI"),e()):(this.logger.debug("Wrapped vpaid not stopped, try to stop it"),this.vpaid.subscribe(e,K.a.AdStopped),super.stopAd())}pauseAd(){this.callVPAIDMethod("pauseAd")}resumeAd(){this.callVPAIDMethod("resumeAd")}getAdWidth(){return this.isRendered&&!this.isStopped&&super.getAdWidth()?super.getAdWidth():g.getBoundingClientRect(this.getMainComponentsContainer()).width}getAdHeight(){return this.isRendered&&!this.isStopped&&super.getAdHeight()?super.getAdHeight():g.getBoundingClientRect(this.getMainComponentsContainer()).height}setAdVolume(e){return isNaN(e)?(this.logger.warn("setAdVolume: volume argument is NaN"),this.getAdVolume()):super.setAdVolume(e)}getAdExpanded(){return this.isFullscreen}setVPAID(e){if(this.vpaid)this.logger.warn("setVPAID() : vpaid ad already register, can't use twice");else{this.logger.debug("setVPAID() : Register vpaid ad"),super.setVPAID(e),e.subscribe(()=>{this.isStopped=!0},K.a.AdStopped);var t=e=>{0===function(e,t){return a.filter(e,(function(e){return e.isEnabled()&&-1!==a.indexOf(e.getOverridenEvents(),t)}))}(this.components,e.type).length&&this.handleVpaidEvent(e)};for(var i in K.a)if(K.a.hasOwnProperty(i)){var n=K.a[i];e.subscribe(Tt.b(t,n),n)}for(var i in Oe.a)if(Oe.a.hasOwnProperty(i)){n=Oe.a[i];e.subscribe(Tt.b(t,n),n)}}}getVPAID(){return this.vpaid}getVPAIDContainer(){return this.mainComponentsContainer.ownerDocument.getElementById("vpaid-container")}getMainContainer(){return this.mainContainer}getMainComponentsContainer(){return this.mainComponentsContainer.ownerDocument.getElementById("main-container")}getCreativeContainer(){return this.getVPAID().container.getCreativeContainer()}getVideoComponentsContainer(){return this.videoComponentsContainer=this.videoComponentsContainer||this.mainComponentsContainer.ownerDocument.getElementById("layout-video-component")}getComponent(e){return this.componentsByName[e]}getConfig(){return this.config}getContainer(){return this.container}getContentWindow(){return this.getContainer().contentWindow||window}render(e){var t,i,n,s;if(!this.isRendered){this.isRendered=!0,this.show(),this.resize(e.getAdWidth(),e.getAdHeight());var r=e=>{this.handleVpaidEvent(e)};for(var a in this.logger.debug("init components:",this.config.components),Mt)if(Mt.hasOwnProperty(a)&&Mt[a])for(var d="teads-ui-component-"+a,c=g.getElementsByClassName(d,this.getMainComponentsContainer(),this.getContentWindow()),l=0,h=c.length;l<h;l++)if(this.config.components&&this.config.components[a]&&this.config.components[a].disable||this.config.disableAllComponents&&this.config.components&&!1!==this.config.components[a].disable)o.b.fromNullable(c[l]).forEach(e=>o.b.fromNullable(e.parentNode).forEach(t=>t.removeChild(e))),this.logger.debug("disable component "+a);else{var u=new Mt[a](this,c[l],e,this.config.components&&this.config.components[a]?this.config.components[a]:{},r);if(this.components.push(u),this.componentsByName[a]=u,null===(i=null===(t=this.loaderConfig)||void 0===t?void 0:t.api)||void 0===i?void 0:i.isVideoBanner()){const e=null===(s=null===(n=this.loaderConfig)||void 0===n?void 0:n.api)||void 0===s?void 0:s.getCreativeSize();this.config.clickthrough||this.getVPAIDContainer().style.setProperty("background-color","transparent"),"soundbutton"===a&&u.getElement().style.setProperty("bottom",Ft.b(e)+"px"),"endscreen"===a&&u.getElement().style.setProperty("height",Ft.a(e.width)+"px")}try{u.init(),this.logger.debug("init component "+a,this.config.components&&this.config.components[a]?this.config.components[a]:null)}catch(e){this.logger.error('error init component "'+a+'"',e.toString())}}}}showAllComponents(){jt(this.components,!0)}hideAllComponents(){jt(this.components,!1)}showComponent(e){kt(this.componentsByName,e,!0)}hideComponent(e){kt(this.componentsByName,e,!1)}dispatchCustomEvent(e,t){this.dispatchEvent(e,t)}getProperties(){return{adLinear:this.getAdLinear(),adWidth:this.getAdWidth(),adHeight:this.getAdHeight(),adExpanded:this.getAdExpanded(),adSkippableState:this.getAdSkippableState(),adRemainingTime:this.getAdRemainingTime(),adDuration:this.getAdDuration(),adVolume:this.getAdVolume()}}toJSON(){return bt.b(this.getProperties())}handleVpaidEvent(e){switch(e.type){case K.a.AdSizeChange:this.getAdWidth()&&this.getAdHeight()&&this.isStopped&&(this.logger.debug("resize with AdSizeChange event"),this.resize(this.getAdWidth(),this.getAdHeight(),this.isFullscreen?"fullscreen":"normal"));break;case K.a.AdLoaded:if(this.initAdStartTime>0)try{const e=o.b.fromNullable(this.config.vpaidUrl).map(e=>w.p(e).hostname).getOrNull(),t=Object(l.l)()-this.initAdStartTime,i=Object(l.h)(/t.teads.tv\/track\?action=adCall/).map(e=>e.startTime).map(Math.round).getOrValue(0);this.logger.info("initAd response time",t,e,i)}catch(e){}}super.handleVpaidEvent(e)}callVPAIDMethod(e,t=[]){a.forEach(this.components,i=>{i.onMethod(e,t)});var i,n=function(e,t){return a.filter(e,(function(e){return e.isEnabled()&&-1!==a.indexOf(e.getOverridenMethods(),t)}))}(this.components,e);return 0===n.length?super.callVPAIDMethod(e,t):(a.forEach(n,n=>{i=n.onOverridenMethod(e,t)}),i)}resize(e,t,i="normal"){if(e<=0||t<=0)return;let n=e+"px",s=t+"px";this.getVideoComponentsContainer().style.getPropertyValue("width")===n&&this.getVideoComponentsContainer().style.getPropertyValue("height")===s&&this.container.style.getPropertyValue("width")===n&&this.container.style.getPropertyValue("height")===s||(this.getVideoComponentsContainer().style.setProperty("width",n),this.getVideoComponentsContainer().style.setProperty("height",s),this.container.style.setProperty("width",n,"important"),this.container.style.setProperty("height",s,"important"),this.container.style.setProperty("max-height",s,"important"),this.logger.debug("vpaidui resize",e,t,i),!this.isFullscreen&&"fullscreen"===i||this.isFullscreen&&"normal"===i?(this.isFullscreen="fullscreen"===i,this.dispatchEvent(K.a.AdExpandedChange)):this.logger.debug("no fullscreen exit or enter"));let r=this.getVPAIDContainer();r.style.setProperty("width",n),r.style.setProperty("height",s);let o="l-screen";e<=480?o="xs-screen":e<=640&&(o="sm-screen"),a.forEach(["l-screen","xs-screen","sm-screen"],e=>{e!==o&&f.removeClass(this.mainComponentsContainer,e)}),f.addClass(this.mainComponentsContainer,o)}show(){this.container.style.setProperty("display","block")}hide(){this.container.style.setProperty("display","none")}initHeavyAdInterventionListener(e){window.addEventListener("message",e=>{o.b.of(e).map(({data:e})=>e).filter(({event:e})=>"heavyAdIntervention"===e).forEach(({report:e})=>{this.logger.error("Fetched a heavy ad intervention event",e),Ie.a.tryCatch(()=>o.b.of(JSON.parse(e)).map(({body:e})=>e).filter(({id:e})=>"HeavyAdIntervention"===e).map(({message:e})=>e)).fold(e=>this.logger.error("Something went wrong during the parsing of the intervention report:",e),e=>e.forEach(e=>{const t=e.indexOf("Ad was removed")>-1?Oe.a.AdRemovedHeavyAdIntervention:Oe.a.AdWarningHeavyAdIntervention,i=e.indexOf("CPU")>-1?"CPU":"Network";this.dispatchCustomEvent(t,{id:mt.b.GENERAL_LINEAR.id,message:"HeavyAdIntervention "+i})}))})},!0),e.postMessage({event:"reportingObserverSource"},"*")}}var Bt=i(55),Wt=i(33),Ht=i(56);class zt{constructor(e,t,i,n,s,r){this.container=e,this.config=t,this.vpaidAd=i,this.bufferingTimer=null,this.bufferingDone=!1,this.elapseTime=0,this.logger=new c.a("player.plugin.Bench");try{let e=f.findTopWindow(this.container);this.visibility=E.listenWindow(e,()=>{this.elapseTime>1e3&&0===this.getCurrentTime()&&(this.clearBufferingTimer(!0),this.visibility.destroy())},()=>{})}catch(e){this.logger.error("Error with visibility init",e)}Object(a.forEach)([K.a.AdStopped,K.a.AdSkipped,K.a.AdError],e=>{this.vpaidAd.subscribe(()=>this.visibility.destroy(),e)}),this.vpaidAd.subscribe(()=>{this.getBuffering()},K.a.AdStarted),this.vpaidAd.subscribe(()=>{this.clearBufferingTimer()},K.a.AdPaused),this.vpaidAd.subscribe(()=>{this.getBuffering()},K.a.AdPlaying)}init(){}deinit(){}getBuffering(e=500){this.bufferingDone||(this.bufferingTimer=setTimeout(()=>{try{this.elapseTime=e;let t=this.getCurrentTime();if(t>0){let i=e-1e3*t>0?e-1e3*t:0;"number"==typeof i&&i>=0&&this.logger.debug("Buffering: "+i+"ms"),this.bufferingDone=!0,this.visibility.destroy()}else this.getBuffering(e+=500)}catch(e){this.logger.error("Error with buffering method",e)}},500))}clearBufferingTimer(e=!1){try{this.bufferingTimer&&(clearTimeout(this.bufferingTimer),this.bufferingTimer=null,e&&(this.logger.warn("Stop buffering calculation"),this.bufferingDone=!0))}catch(e){this.logger.error("An error occured while cleaning the buffering timer",e)}}getCurrentTime(){return this.vpaidAd.getAdDuration()-this.vpaidAd.getAdRemainingTime()?this.vpaidAd.getAdDuration()-this.vpaidAd.getAdRemainingTime():0}}var Gt=i(124);class qt{constructor(e,t,i,n,s,r){this.container=e,this.config=t,this.vpaidAd=i,this.linearAd=s,this.dependenciesFromPlayer=r}init(){this.vpaidAd.subscribe(this.onClickThrough,K.a.AdClickThru,this)}deinit(){this.vpaidAd.unsubscribe(this.onClickThrough,K.a.AdClickThru)}generateAttributionEventSourceIdFromAuctionId(e){let t=e.substring(0,14)+e.substring(15,19)+e.substring(20);return t=t.replace(/-/g,""),parseInt(t.substring(0,16),16)}onClickThrough(e,t,i){const n=Object(Gt.a)(e)||this.linearAd.clickThrough[0];i&&n&&Ie.a.tryCatch(()=>{const e=Object(Wt.a)([Object(Wt.h)(this.dependenciesFromPlayer.gdprIab.status),...Object(Wt.g)(this.dependenciesFromPlayer.gdprIab.consent)])(n),t=Object(p.isChromeIos)()&&Object(w.k)(e)?"_parent":"_blank",i=this.config.formatConfig.attributeOn,s=this.config.auctionId,r=this.config.formatConfig.attributionExpiry;if(Object(p.isChrome)()&&a.includes(ke.a,this.config.formatConfig.adSourceId)&&i&&s&&r){const n=this.generateAttributionEventSourceIdFromAuctionId(s),a="conversion-measurement",o=document.getElementById(a);if(o)o.click();else{this.createConversionMeasurementAnchorElement(a,e,t,i,n,r).click()}}else window.open(e,t)}).tapLeft(e=>{this.dependenciesFromPlayer.sumologicLogger.error("plugin-onclickthrough "+Object(ge.a)(e))})}createConversionMeasurementAnchorElement(e,t,i,n,s,r){const a=document.createElement("a");a.id=e;const o={href:t,target:i,rel:"opener",attributionreportto:"https://cm.teads.tv",attributiondestination:n,attributionsourceeventid:s.toString(),attributionexpiry:r,reportingorigin:"https://cm.teads.tv",conversiondestination:n,impressiondata:s.toString(),impressionexpiry:r};for(const e in o)a.setAttribute(e,o[e]);return this.container.appendChild(a),a}}var Kt=i(31);class $t{constructor(e,t,i,n,s){this.container=e,this.config=t,this.vpaidAd=i,this.mediaFile=n,this.linearAd=s,this.logger=new c.a("player.plugin.Extensions"),this.getVastMacros=()=>{var e;const t=o.b.fromNullable(He.a(this.linearAd.duration,this.vpaidAd.getAdRemainingTime())),i=He.d(o.b.fromNullable(this.mediaFile)),n=He.c(o.b.fromNullable(this.mediaFile)),s=Object(g.getBoundingClientRect)(this.container).height,r=o.b.fromNullable(null===(e=this.config.formatConfig)||void 0===e?void 0:e.threshold).map(e=>e.get()).getOrValue(100),a=o.b.fromNullable(He.f(this.container,s,r));return He.e({currentTime:t,assetUrl:i,mediaFileType:n,viewability:a})},this.getFunnelMacros=()=>{var e;return o.b.fromNullable(null===(e=this.config)||void 0===e?void 0:e.formatConfig).match({some:e=>{const t=o.b.fromNullable(e.pageId),i=o.b.fromNullable(e.placementId),n=o.b.fromNullable(e.insertionId),s=o.b.fromNullable(p.getEnv());return He.b({pageId:t,pid:i,insertionId:n,env:s})},none:()=>He.b()})}}init(){a.forEach(this.linearAd.extensions,e=>{switch(e.type){case nt.a:const t=nt.d(e.content);t&&t.width&&t.height&&(this.mediaFile.width=t.width,this.mediaFile.height=t.height);break;case we.a.AD_VERIFICATIONS:if(Object(r.c)(this.linearAd.adParameters,this.mediaFile.url)){const t=a.map(this.retrieveCreativePrefetchAdVerificationScriptUrls(e),({url:e})=>e);this.prefetchAdVerificationScripts(t)}break;case we.a.MOAT_JS:this.initMoatTracking(e);break;case we.a.VISIBILITY:case we.a.HTML:case we.a.IFRAME:this.injectIframe(e.content);break;case we.a.SCRIPT:case we.a.ALENTY:this.injectJs(e.content);break;default:this.logger.warn("Unhandled extension type",e)}})}deinit(){}getExtension(e){return o.b.fromNullable(a.find(this.linearAd.extensions,t=>t.type===e))}retrieveCreativePrefetchAdVerificationScriptUrls(e){const t=a.fromNodeList(e.xml.querySelectorAll("Verification")),i=a.map(t,e=>[e.getAttribute("vendor"),e.querySelector("JavaScriptResource")]),n=a.filter(i,([,e])=>"creative-prefetch"===e.getAttribute("apiFramework")),s=/src="([^"]+)/gi,r=Object(Kt.a)((e,t)=>a.map(t,({vendor:t,url:i})=>({vendor:t,url:He.h(e)(i)}))),d=e=>r(this.getVastMacros())(r(this.getFunnelMacros())(e)),c=a.map(n,([e,t])=>o.b.fromNullable(t.textContent).map(A.trim).map(t=>{let i;const n=[];for(;null!==(i=s.exec(t));)n.push(i[1]);const r="DoubleVerify"===e?a.map(n,e=>w.r(e,"btreg",this.container.getAttribute("id"))):n;return a.map(r,t=>({vendor:e,url:t}))}).map(d));return a.reduce(c,(e,t)=>t.map(t=>e.concat(t)).getOrValue(e),[])}prefetchAdVerificationScripts(e){a.forEach(e,e=>(new Image).src=e)}initMoatTracking(e){let t=this.vpaidAd.getAdDuration();t<=0&&(t=this.linearAd.duration);const i=bt.a(e.content);let n=[];const s={adData:{ids:i,duration:t,url:this.mediaFile.url},dispatchEvent:function(e){if(this.sendEvent){let t=e;n&&(n.push(e),t=n,n=null),this.sendEvent(t)}else n.push(e)}};this.logger.debug("intialized MOAT with",s.adData);a.forEach(["AdStarted","AdImpression","AdStopped","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdPaused","AdPlaying","AdVolumeChange"],e=>{this.vpaidAd.subscribe(()=>{let t={type:e,adVolume:this.vpaidAd.getAdVolume()};this.logger.debug("sending MOAT event",t),s.dispatchEvent(t)},e)});let r="_moatApi"+A.rand(8);f.getWindow(this.container)[r]=s;let o=f.getDocument(this.container).createElement("script");const d=Object(h.getProtocol)();let c="https:"===d?"z":"js";o.src=d+"//"+c+".moatads.com/"+$t.MOAT_PARTNER_CODE+"/moatvideo.js#"+r,this.container.insertBefore(o,this.container.childNodes[0])}injectJs(e){let t=document.createElement("script");t.async=!0,t.src=e,document.body.appendChild(t)}injectIframe(e){let t=document.createElement("iframe");t.setAttribute("title","extension"),t.style.setProperty("width","10px"),t.style.setProperty("height","10px"),t.style.setProperty("position","absolute"),t.style.setProperty("left","-999em"),t.style.setProperty("top","0"),document.body.appendChild(t);let i=t.contentWindow.document;i.open(),i.write(-1===e.indexOf("<html")?"<!doctype html><html><head></head><body>"+e+"</body></html>":e),i.close()}}$t.MOAT_PARTNER_CODE="teads245638586802";class Yt{constructor(e,t,i,n){this.container=e,this.config=t,this.vpaidAd=i,this.mediaFile=n,this.logger=new c.a("player.plugin.Responsive")}init(){this.logger.debug("init plugin"),this.vpaidAd.subscribe(this.onVideoMetadata,Oe.a.AdVideoMetadata,this),this.vpaidAd.subscribe(this.onVpaidStart,K.a.AdStarted,this)}deinit(){this.logger.debug("deinit plugin"),this.vpaidAd.unsubscribe(this.onVpaidStart,K.a.AdStarted),this.vpaidAd.unsubscribe(this.onVideoMetadata,Oe.a.AdVideoMetadata),this.unsetResponsive()}resize(e){if(!f.isFullscreen())try{let s=g.getBoundingClientRect(this.container).width;if(s!==this.vpaidAd.getAdWidth()||e){let e=this.config.vpaidApi&&this.config.vpaidApi.getStudioData();var t=ye.a.getOptimalHeight(this.mediaFile,s,!!this.metadata||!!e),i=this.vpaidAd.getAdWidth(),n=this.vpaidAd.getAdHeight();i===s&&n===t||(this.vpaidAd.resizeAd(s,t,"normal"),this.logger.debug("container width change, resize from "+i+"x"+n+" to "+s+"x"+t))}}catch(e){this.logger.error("resize throw an Exception",e),this.unsetResponsive()}}setResponsive(){return!this.iframe&&(this.vpaidAd.subscribe(()=>{this.unsetResponsive()},K.a.AdError),this.vpaidAd.subscribe(()=>{this.unsetResponsive()},K.a.AdStopped),this.resize(),this.iframe=document.createElement("iframe"),this.iframe.setAttribute("title","responsive plugin"),this.iframe.style.setProperty("height","0"),this.iframe.style.setProperty("width","100%"),this.iframe.style.setProperty("border","none"),this.iframe.style.setProperty("margin","0"),this.iframe.style.setProperty("padding","0"),this.container.appendChild(this.iframe),this.iframe.contentWindow.document.write("<html><body></body></html>"),this.iframe.contentWindow.document.close(),this.resizeCallback=()=>this.resize(),g.addEventListener("resize",this.iframe.contentWindow,this.resizeCallback),!0)}unsetResponsive(){try{return!!this.iframe&&(g.removeEventListener("resize",this.iframe.contentWindow,this.resizeCallback),this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,!0)}catch(e){return!1}}onVideoMetadata(e){this.logger.debug("Receive metadata from video",e),e.width&&e.height&&(this.metadata=e,this.mediaFile.width=e.width,this.mediaFile.height=e.height,Math.ceil(this.vpaidAd.getAdWidth()/this.vpaidAd.getAdHeight())!==Math.ceil(e.width/e.height)&&(this.logger.debug("vpaid ratio differ from mediafile ratio, force resize !"),this.resize(!0)))}onVpaidStart(){if(!this.config.width)try{this.logger.debug("set player responsive !"),this.setResponsive()}catch(e){this.logger.error("Exception raised while trying to initialize",e)}}}var Xt=i(19),Qt=i(115);class Jt{constructor(e,t,i,n,s,r){this.container=e,this.config=t,this.vpaidAd=i,this.mediaFile=n,this.linearAd=s,this.trackVastEventDependencies=r,this.logger=new c.a("player.plugin.Tracker"),this.tracked={},this.trackedProgress=[],this.trackOnce=[Xt.a.Skip,Xt.a.CreativeView,Xt.a.Start,Xt.a.Impression,Xt.a.FirstQuartile,Xt.a.Midpoint,Xt.a.ThirdQuartile,Xt.a.Complete,Xt.a.Error],this.isMuted=!1;const d=[K.a.AdLoaded,K.a.AdStarted,K.a.AdSkipped,K.a.AdImpression,K.a.AdVideoStart,K.a.AdVideoFirstQuartile,K.a.AdVideoMidpoint,K.a.AdVideoThirdQuartile,K.a.AdVideoComplete,K.a.AdClickThru,K.a.AdUserClose],l=[K.a.AdDurationChange,K.a.AdRemainingTimeChange],u=Object.keys(K.a);for(const e in Oe.a)u.push(e);this.vpaidAd.subscribe((...e)=>{this.trackError(e)},Oe.a.AdRemovedHeavyAdIntervention);a.forEach(u,e=>{a.indexOf(d,e)>-1&&this.vpaidAd.subscribe(t=>{e===K.a.AdImpression?this.trackVastEventDependencies.sumologicLogger.info(e+"|classic",40):this.trackVastEventDependencies.sumologicLogger.info(`${e}|${o.b.fromNullable(t).filter(h.isString).getOrValue("")}`,40)},e),-1===a.indexOf(l,e)&&this.vpaidAd.subscribe((t="")=>{this.logger.info(`${e} ${t}`)},e)})}init(){this.logger.debug("init");try{this.previousRemainingTime=this.vpaidAd.getAdRemainingTime(),this.vpaidAd.subscribe(()=>this.onTimeChange(),K.a.AdDurationChange),this.vpaidAd.subscribe(()=>this.onTimeChange(),K.a.AdRemainingTimeChange);for(let e in this.linearAd.tracking)this.addTrackingCallback(e);let e;this.vpaidAd.subscribe(()=>this.onAdStarted(),K.a.AdStarted),this.vpaidAd.subscribe(()=>this.onVolumeChange(),K.a.AdVolumeChange),this.vpaidAd.subscribe(()=>{const t=this.vpaidAd.getAdExpanded();!e&&t?(this.trackVastEvent(Xt.a.Fullscreen),this.trackVastEvent(Xt.a.Expand)):e&&!t&&(this.trackVastEvent(Xt.a.ExitFullscreen),this.trackVastEvent(Xt.a.Collapse)),e=t},K.a.AdExpandedChange)}catch(e){const{placementKey:t,sumologicLogger:i,wigo:n,logger:s,slotType:r}=this.trackVastEventDependencies,a=o.b.fromNullable(this.adDuration),d=a.flatMap(e=>o.b.fromNullable(this.adRemainingTime).map(t=>e-t));Object(Ae.n)({placementKey:t,wigo:n,sumologicLogger:i,logger:s,durationPlayed:d,totalDuration:a})(Bt.a.Undefined,()=>ve.b.vast.trackErrorWithCause(t)(Bt.a.Undefined,"plugin tracker exception init",{referer:Object(Ae.a)(i),slotType:r,macros:[Object(Wt.d)(d.getOrValue(0)),Object(Wt.c)(),Object(Wt.b)(o.b.fromNullable(this.mediaFile)),Object(Wt.i)(o.b.fromNullable(this.mediaFile)),Object(Wt.j)(0),Object(Wt.h)(this.trackVastEventDependencies.gdprIab.status),...Object(Wt.g)(this.trackVastEventDependencies.gdprIab.consent)]}))}}deinit(){this.logger.debug("deinit")}onTimeChange(){this.adDuration=this.vpaidAd.getAdDuration(),this.adRemainingTime=this.vpaidAd.getAdRemainingTime(),this.previousRemainingTime<0&&(this.previousRemainingTime=this.adRemainingTime)}onVolumeChange(){this.isMuted&&this.vpaidAd.getAdVolume()>0?this.trackVpaidEvent(Xt.a.Unmute):this.isMuted||0!==this.vpaidAd.getAdVolume()||this.trackVpaidEvent(Xt.a.Mute),this.isMuted=!this.vpaidAd.getAdVolume()}onAdStarted(){this.isMuted=!this.vpaidAd.getAdVolume()}addTrackingCallback(e){const t=Qt.a[e]||Qt.b[e];this.vpaidAd.subscribe((...t)=>{e===Xt.a.Error?this.trackError(t):this.trackVpaidEvent(e)},t)}buildTrackingDependencies(e){var t;const i=Object(g.getBoundingClientRect)(this.container).height,n=o.b.fromNullable(null===(t=this.config.formatConfig)||void 0===t?void 0:t.threshold).map(e=>e.get()).getOrValue(100),s=Object(He.f)(this.container,i,n),{placementKey:r,wigo:a,logger:d}=this.trackVastEventDependencies,c=[Object(Wt.d)(e),Object(Wt.c)(),Object(Wt.b)(o.b.fromNullable(this.mediaFile)),Object(Wt.i)(o.b.fromNullable(this.mediaFile)),Object(Wt.j)(s),Object(Wt.e)(this.trackVastEventDependencies.sumologicLogger),Object(Wt.h)(this.trackVastEventDependencies.gdprIab.status),...Object(Wt.g)(this.trackVastEventDependencies.gdprIab.consent)];return{trackOpts:{referer:Object(Ae.a)(this.trackVastEventDependencies.sumologicLogger),slotType:this.trackVastEventDependencies.slotType,macros:c},trackingsDependencies:{placementKey:r,wigo:a,logger:d,durationPlayed:Object(o.c)(e),totalDuration:o.b.fromNullable(this.adDuration),sumologicLogger:this.trackVastEventDependencies.sumologicLogger}}}trackEvent(e,t){const i=t.filter(e=>!isNaN(e)).getOrValue(this.adDuration-this.adRemainingTime||0),n=Math.floor(i);if(e===Xt.a.Progress){if(this.trackedProgress[n])return;if(this.previousRemainingTime===this.adRemainingTime)return;this.previousRemainingTime=this.adRemainingTime}switch(e){case Xt.a.Start:this.tracked[Xt.a.Impression]||this.trackVastEvent(Xt.a.Impression);break;case Xt.a.Complete:this.trackProgress(n+1);case Xt.a.FirstQuartile:case Xt.a.Midpoint:case Xt.a.ThirdQuartile:this.tracked[Xt.a.Start]||this.trackVastEvent(Xt.a.Start);break;case Xt.a.Progress:this.trackedProgress[n]=!0;const e=n-1;e>0&&!this.trackedProgress[e]&&(this.logger.debug("track missing previous progress "+e),this.trackProgress(e));break;case Xt.a.Mute:if(!this.tracked[Xt.a.Impression])return}if(!a.includes(this.trackOnce,e)||!this.tracked[e]){if(Object(a.isMemberOf)(Xt.b)(e)&&e!==Xt.a.Billable){const{placementKey:t}=this.trackVastEventDependencies,{trackOpts:s,trackingsDependencies:r}=this.buildTrackingDependencies(i);if(e===Xt.a.Progress)n>0&&Object(Ae.x)(r)(e,()=>(3===n&&Ye(t,this.trackVastEventDependencies.sumologicLogger,this.config,"piv"),ve.b.vast.trackProgress(t)(n,s)));else{const i=e;p.getCohort().then(e=>{const n=Object.assign({},s);e.forEach(e=>{n.cohort=e}),Object(Ae.x)(r)(i,()=>ve.b.vast.track(t)(i,n))})}}else this.logger.error(`Could not track unsupported VAST event: ${e}. Supported names: ${Xt.b.join(", ")}.`),this.trackVastEventDependencies.sumologicLogger.error("cant-track-vast-event "+e);this.tracked[e]=!0}}trackVastEvent(e){this.trackEvent(e,o.b.empty())}trackVpaidEvent(e){this.trackEvent(e,o.b.empty())}trackProgress(e){this.trackEvent(Xt.a.Progress,o.b.fromNullable(e))}trackError(e){if(this.tracked[Xt.a.Error])return;const t=e&&e[1]&&"number"==typeof e[1]&&!isNaN(e[1])?e[1]:mt.b.GENERAL.id,i=Object(a.isMemberOf)(Bt.b)(t)?t:Bt.a.Undefined,n=e[0],s=this.adDuration-this.adRemainingTime||0,{trackOpts:r,trackingsDependencies:o}=this.buildTrackingDependencies(s),{placementKey:d}=this.trackVastEventDependencies;Object(Ae.n)(o)(i,()=>ve.b.vast.trackErrorWithCause(d)(i,n,r))}}var Zt=i(133);class ei{constructor(e,t,i,n,s,r){this.config=t,this.vpaidAd=i,this.linearAd=s,this.trackVastEventDependencies=r}init(){this.vpaidAd.subscribe(this.onClickAdChoices,B.a.AdChoicesClickRequest,this)}deinit(){this.vpaidAd.unsubscribe(this.onClickAdChoices,B.a.AdChoicesClickRequest)}onClickAdChoices(){Object(Ae.x)({placementKey:this.trackVastEventDependencies.placementKey,sumologicLogger:this.trackVastEventDependencies.sumologicLogger,wigo:this.trackVastEventDependencies.wigo,logger:this.trackVastEventDependencies.logger,durationPlayed:o.a,totalDuration:o.a})(Xt.a.ClickIcon,()=>ve.b.vast.track(this.trackVastEventDependencies.placementKey)(Xt.a.ClickIcon,{referer:Object(Ae.a)(this.trackVastEventDependencies.sumologicLogger),slotType:this.trackVastEventDependencies.slotType,macros:Object(Wt.f)()})),window.open(Object(Zt.b)(this.linearAd),"_blank")}}class ti{constructor(e,t,i,n,s,r,a){this.container=e,this.config=t,this.slotType=i,this.wigo=n,this.gdprIab=s,this.placementKey=r,this.logger=new c.a("player.VASTPlayer"),this.plugins={},this.logger.info("new VASTPlayer",this.container,this.config),this.sumologicLogger=a.copy({collectorUrl:"https://s8t.teads.tv/logs/player/http-source"}),this.wigo.valid(2,0),this.wigo.setPlayerContainer(this.container),this.wigo.elementToFollow=this.container}setLinearAd(e){this.linearAd=e,this.logger.info("setLinearAd",e),this.wigo.valid(2,1,e,"modal")}setVpaidApi(e){this.config.vpaidApi=e}getLinearAd(){return this.linearAd}getMediafile(){return this.mediafile}getConfig(){return this.config}showCloseButton(){this.ui.showComponent("closebutton")}setConfigUI(e){this.config.ui=e}getOptimalMediaFile(e,t,i=(e=>!0)){return ye.a.getOptimalMediaFile(this.linearAd.duration,this.linearAd.mediaFiles,(n,s)=>{const r=o.b.fromNullable(n);r.match({some:n=>{r.filter(i).match({some:t=>{e(t),this.wigo.valid(2,2,t.url+s,"string")},none:()=>{this.onVastError(t,mt.a.get(mt.b.MEDIAFILE_DISPLAY.id,"Mediafile filtered by the custom filter"),this.linearAd),this.wigo.valid(2,2,"405 - Mediafile filtered by the custom filter","error")}})},none:()=>{const e=mt.a.get(mt.b.UNSUPPORTED_MEDIAFILE.id,"VASTPlayer.getOptimalMediaFile didn't find mediafile");this.wigo.valid(2,2,s,"error"),this.onVastError(t,e,this.linearAd)}}),ye.a.sendMediasToSumologic(this.linearAd,n?1:0,this.sumologicLogger)},this.config,this.sumologicLogger)}playOptimalMediaFile(e,t,i){this.getOptimalMediaFile(i=>{this.playMediaFile(i,e,t)},t,i)}loadOptimalMediaFile(e,t,i){this.getOptimalMediaFile(i=>{this.loadMediaFile(i,e,t)},t,i)}playMediaFile(e,t,i){if(!e){let e=mt.a.get(mt.b.UNSUPPORTED_MEDIAFILE.id,"no mediafile provided in VASTPlayer.playMediaFile");return this.onVastError(i,e,this.linearAd)}this.loadMediaFile(e,(function(e,i){t(e,i),e.subscribe((function(){e.startAd()}),K.a.AdLoaded),e.initAd(i.width,i.height,i.mode,i.bitrate,i.parameters)}),i)}loadMediaFile(e,t,i){let r=e=>{this.onVastError(i,e,this.linearAd)};if(!e)return r(mt.a.get(mt.b.UNSUPPORTED_MEDIAFILE.id,"no mediafile provided in VASTPlayer.loadMediaFile"));this.mediafile=e;const a=ye.a.getMediaProvider(e);let o=e.url;const d=this.config.width?this.config.width:this.container.offsetWidth;var c={width:d,height:this.config.height?this.config.height:ye.a.getOptimalHeight(e,d),mode:"normal",bitrate:e.bitrate||512,parameters:this.linearAd.adParameters},l=this.linearAd.clickThrough.length?this.linearAd.clickThrough[0]:null;let h=this.config.useCustomVideo||!1;var u,g=!1;switch(a){case Ht.a.VPAID:if(l=null,"display"===this.config.adType||"native"===this.config.adType)break;"vpaid"===e.api&&e.type.indexOf("javascript")>-1&&((p.isIos()&&!p.isIos10Safari()||this.config.type===Le.a.CANVAS)&&(h=!0),p.cacheCanvasUsed(h));break;case Ht.a.JS:case Ht.a.CANVAS:o=this.config.path+"/"+ye.a.getAssetFromMediaProvider(a),a===Ht.a.JS?o=yt.a.VIDEO:a===Ht.a.CANVAS&&(o=yt.a.CANVAS);var m=this.config.path.match("/dist")||0===this.config.path.indexOf("http")?this.config.path.match("/dist")&&0!==this.config.path.indexOf("http")?window.location.protocol+window.location.host+this.config.path:this.config.path:window.location.protocol+this.config.path;g=(()=>{try{return!this.config.ui.config.components.endscreen.disable}catch(e){return this.logger.error(`Couldn't autostop: "${e}"`),!1}})(),c.parameters={url:e.url,debug:this.config.debug,clickThrough:l,skippable:this.linearAd.skippable,skipoffset:this.linearAd.skipDelay,assetsPath:m,type:Le.a[this.config.type],pid:this.sumologicLogger.placementId.getOrNull(),noAutoStop:g,timeout:ti.MEDIAFILE_TIMEOUT_DELAY},c.parameters={AdParameters:bt.b(c.parameters)},At.d(ti.MEDIAFILE_TIMEOUT_DELAY+2e3);break;case Ht.a.UNSUPPORTED:default:return u="media not supported "+e.type,void r(mt.a.get(mt.b.UNSUPPORTED_MEDIAFILE.id,u))}var b={path:this.config.path,useCustomVideo:h,api:this.config.vpaidApi};At.e(ti.MEDIAFILE_TIMEOUT_DELAY),this.config.background&&(b.background=this.config.background);var f=this.container;if(this.config.ui){var v;if(this.config.ui.template)v=this.config.ui.template;else{if(!n[this.config.ui.name]){let e=mt.a.get(mt.b.UNDEFINED.id,"VASTPlayer: cannot find template for VPAID-UI");return r(e)}v=ie.a(n[this.config.ui.name],{assetsPath:this.config.path+"/assets"})}this.config.ui.config.showAdChoicesIcon=0===this.config.adChoicesIconLocation,this.config.ui.config=this.config.ui.config||{},this.config.ui.config.clickthrough=l,a===Ht.a.VPAID&&(this.config.ui.config.vpaidUrl=e.url),this.config.ui.config.noAutoStop=g,this.ui&&this.ui.getContainer()&&(this.config.ui.config.container=this.ui.getContainer()),this.ui=new Ut(this.container,v,this.config.ui.config,b),f=this.ui.getVPAIDContainer(),this.smartPosition=new ft(this.ui)}var A=new wt.a(f,b);A.setWigo(this.wigo);A.load(o,i=>{for(var n in this.wigo.valid(3,0),this.config.ui?(this.ui.setVPAID(i),this.vpaidAd=this.ui):this.vpaidAd=i,this.vpaidAd.setWigo(this.wigo),s)try{var o=s[n];this.plugins[n]&&this.plugins[n].deinit(),this.plugins[n]=new o(this.container,this.config,this.vpaidAd,e,this.linearAd,{placementKey:this.placementKey,sumologicLogger:this.sumologicLogger,wigo:this.wigo,slotType:this.slotType,logger:this.logger,gdprIab:this.gdprIab}),this.plugins[n].init()}catch(e){this.logger.error("Could not initialize plugin "+n,e)}try{t(this.vpaidAd,c)}catch(e){let t=mt.a.get(mt.b.UNDEFINED.id,"loadMediaFile success callback failled "+e,e);r(t)}this.logger.info("loadMediaFile",Ht.a[a]),this.wigo.valid(2,3,Ht.a[a],"string")},e=>{let t=mt.b.UNDEFINED.id;switch(e.id){case vt.b.id:t=mt.b.GENERAL.id;break;case vt.c.id:t=mt.b.FILE_NOT_FOUND.id;break;case vt.d.id:t=mt.b.MEDIAFILE_TIMEOUT.id}let i=e.message||"vpaidloader error";r(mt.a.get(t,i))})}getPlugin(e){return this.plugins[e]}getPlugins(){return this.plugins}hasMoatExtension(e=this.linearAd){return!!e&&a.filter(e.extensions||[],e=>"MoatJs"===e.type).length>0}onVastError(e,t,i){const n=t.getId(),s=Object(a.isMemberOf)(Bt.b)(n)?n:Bt.a.Undefined;Object(Ae.n)({placementKey:this.placementKey,sumologicLogger:this.sumologicLogger,wigo:this.wigo,logger:this.logger,durationPlayed:o.a,totalDuration:o.a})(s,()=>ve.b.vast.trackErrorWithCause(this.placementKey)(s,t.getMessage(),{referer:Object(Ae.a)(this.sumologicLogger),slotType:this.slotType,macros:[Object(Wt.d)(0),Object(Wt.c)(),Object(Wt.b)(o.b.fromNullable(this.mediafile)),Object(Wt.i)(o.b.fromNullable(this.mediafile)),Object(Wt.j)(0)]})),e(t,i)}}ti.MEDIAFILE_TIMEOUT_DELAY=15e3;var ii=i(36);const ni=new c.a("FunnelFormatSync"),si=window.teads.tagManagerResourcesList||[];function ri(e,t){return o.b.fromNullable(Object(a.find)(t,t=>t.tagManager===e))}function ai(e){return ri(e,si).flatMap(({vastPlayer:e})=>e.flatMap(e=>o.b.fromNullable(e.getMediafile()))).map(()=>oi(e)).getOrValue(!0)}function oi(e){return Object(gt.b)(e,si)}function di({sumologicLogger:e,placementAd:t,linearAdWithFormatConfig:{linearAd:i,formatConfig:n},tagIsCampaignTag:s,tagManagerPackage:a,adCallTrackOpts:c,auctionId:p,viewerId:m,gdprIab:b}){const{placement:v}=t;if(v){v.getElectedSlot()&&function(e){if(!f.getDocument(e).getElementById("teads-format-css")){const t=document.createElement("style");t.setAttribute("type","text/css"),t.setAttribute("id","teads-format-css"),t.innerText=se.a+ae.a,g.inject(t,f.getWindow(e))}}(v.getElectedSlot().getElement());const A=a.flatMap(e=>{var t;return o.b.fromNullable(null===(t=e.tagManagerInstance)||void 0===t?void 0:t.markId)}).getOrElse(()=>Object(l.b)(v.pageId,v.pid)),y=new ti(v.getPlayerContainer(),function(e,t){const i=o.b.fromNullable(e).filter(e=>!e.adType.isVideo()).flatMap(Object(d.a)(Object(h.prop)("creativeSize"),o.b.fromNullable));return{path:u.b.basePathUrl,type:e.allowedPlayer.getValue(),formatConfig:e,background:"transparent",vpaidApi:null,pageId:e.pageId,adType:e.adType.get(),auctionId:t,width:i.map(e=>e.width).getOrNull(),height:i.map(e=>e.height).getOrNull()}}(n,p.getOrNull()),v.slotType,v.wigo,b,v.key,e);y.setLinearAd(i),y.setConfigUI(function(e,t,i){return{name:"inread",config:{components:tt(e,i,t,nt.b(t))}}}(n,i,v));const{portfolioItemId:w,adType:E}=n;if(w&&(Object(C.a)(w)||E.isDisplay())){const e=y.getLinearAd();e.adParameters=r.a(e.adParameters).map(e=>r.b(Object.assign(Object.assign({},e),{portfolioItemId:w}))).getOrElse(()=>e.adParameters)}a.match({some:i=>function({sumologicLogger:e,placementAd:t,formatConfig:i,vastPlayer:n,markId:s,tagIsCampaignTag:r,tagManagerPackage:a,adCallTrackOpts:d,auctionId:c,viewerId:h,gdprIab:u}){const{tagManagerInstance:p,onFormatLoaded:g,done:m}=a;(function(e,t,i,n){si.push({tagManager:e,placementAd:t,vastPlayer:Object(o.c)(i),tagIsCampaignTag:n})})(p,t,n,r),p.logger.debug("load -> loadAd","ok"),p.wigo.setStatus(!0,"Ready to serve"),t.placement.initDom(t.placement.electedSlot),p.formatInstance=Object(o.c)(st({instancesStore:window.teads.instances,placement:t.placement,formatConfig:i,vastPlayer:n,markId:s,sumologicLogger:e,adCallTrackOpts:d,auctionId:c,viewerId:h})),p.formatInstance.forEach(r=>{const a=new pt(t.placement,r,u);n.setVpaidApi(a),r.vpaidApi=a,r.load(()=>{Object(l.i)({name:"s",id:s}),oi(p)?(p.logger.error("same ad detected"),Object(Ae.c)({placementKey:t.placement.key,sumologicLogger:e,logger:ni,wigo:t.placement.wigo})({headerBiddingProvider:t.placement.placementConfig.headerBiddingProvider,pageId:t.placement.pageId,placementId:t.placement.pid,auctionId:c,viewerId:h,slotType:t.placement.slotType,portfolioItemId:o.b.fromNullable(i.portfolioItemId),insertionId:o.b.fromNullable(i.insertionId),connectionId:o.b.fromNullable(i.connectionId)}),r.close(5),t.placement.handleNoAd({markId:s,sumologicLogger:e,headerBiddingProvider:t.placement.placementConfig.headerBiddingProvider,portfolioItemId:o.b.fromNullable(i.portfolioItemId),adCallTrackOpts:d,auctionId:c,viewerId:h})):Object(Ae.g)({placementKey:t.placement.key,sumologicLogger:e,logger:ni,wigo:t.placement.wigo})({headerBiddingProvider:t.placement.placementConfig.headerBiddingProvider,pageId:t.placement.pageId,placementId:t.placement.pid,auctionId:c,viewerId:h,slotType:t.placement.slotType,portfolioItemId:o.b.fromNullable(i.portfolioItemId),insertionId:o.b.fromNullable(i.insertionId),connectionId:o.b.fromNullable(i.connectionId)}),g(!0),m()},n=>{g(!1),ci({sumologicLogger:e,formatConfig:i,placement:t.placement,auctionId:c,viewerId:h,vastExceptionId:n.getId()}),t.placement.handleNoAd({markId:s,sumologicLogger:e,headerBiddingProvider:t.placement.placementConfig.headerBiddingProvider,portfolioItemId:o.b.fromNullable(i.portfolioItemId),adCallTrackOpts:d,auctionId:c,viewerId:h}),m()})})}({sumologicLogger:e,placementAd:t,formatConfig:n,vastPlayer:y,markId:A,tagIsCampaignTag:s,tagManagerPackage:i,adCallTrackOpts:c,auctionId:p,viewerId:m,gdprIab:b}),none:()=>function({sumologicLogger:e,placementAd:t,formatConfig:i,vastPlayer:n,markId:s,adCallTrackOpts:r,auctionId:a,viewerId:d,gdprIab:c}){t.placement.initDom(t.placement.electedSlot);const h=st({instancesStore:window.teads.instances,placement:t.placement,formatConfig:i,vastPlayer:n,markId:s,sumologicLogger:e,adCallTrackOpts:r,auctionId:a,viewerId:d}),u=new pt(t.placement,h,c);n.setVpaidApi(u),h.vpaidApi=u,h.load(()=>{Object(l.i)({name:"s",id:s}),Object(Ae.g)({placementKey:t.placement.key,sumologicLogger:e,logger:ni,wigo:t.placement.wigo})({headerBiddingProvider:t.placement.placementConfig.headerBiddingProvider,pageId:t.placement.pageId,placementId:t.placement.pid,auctionId:a,viewerId:d,slotType:t.placement.slotType,portfolioItemId:o.b.fromNullable(i.portfolioItemId),insertionId:o.b.fromNullable(i.insertionId),connectionId:o.b.fromNullable(i.connectionId)}),h.start()},n=>{ci({sumologicLogger:e,formatConfig:i,placement:t.placement,auctionId:a,viewerId:d,vastExceptionId:n.getId()}),t.placement.handleNoAd({markId:s,sumologicLogger:e,headerBiddingProvider:t.placement.placementConfig.headerBiddingProvider,portfolioItemId:o.b.fromNullable(i.portfolioItemId),adCallTrackOpts:r,auctionId:a,viewerId:d})})}({sumologicLogger:e,placementAd:t,formatConfig:n,vastPlayer:y,markId:A,adCallTrackOpts:c,auctionId:p,viewerId:m,gdprIab:b})})}else ni.warn("Placement object is empty in placementAd, cannot loadAd",t)}const ci=({sumologicLogger:e,formatConfig:t,placement:i,auctionId:n,viewerId:s,vastExceptionId:r})=>{const{pageId:o,pid:c,key:l,slotType:u,wigo:p,placementConfig:{headerBiddingProvider:g}}=i;Object(Ae.e)({placementKey:l,sumologicLogger:e,wigo:p,logger:ni,headerBiddingProvider:g,code:Object(a.isMemberOf)(Bt.b)(r)?r:Bt.a.Undefined,pageId:o,placementId:c,auctionId:n,viewerId:s,slotType:u,portfolioItemId:Object(d.b)(t,Object(h.prop)("portfolioItemId"),ii.a),insertionId:Object(d.b)(t,Object(h.prop)("insertionId"),ii.a),connectionId:Object(d.b)(t,Object(h.prop)("connectionId"),ii.a)})}},function(e,t,i){i.d(t,"a",(function(){return g}));var n=i(1),s=i(17),r=i(0),a=i(9),o=i(81),d=i(52),c=i(13),l=i(80),h=i(4),u=i(75);const p=new a.a("VPAIDJSGuard");class g extends class{getVPAID(){return this.vpaid}initAd(e,t,i,n,s,r){this.vpaidguard("initAd",[e,t,i,n,s,r])}skipAd(){this.vpaidguard("skipAd")}resizeAd(e,t,i="normal"){this.vpaidguard("resizeAd",[e,t,i])}handshakeVersion(e){return this.vpaidguard("handshakeVersion",[e])}startAd(){this.vpaidguard("startAd",[])}stopAd(){this.vpaidguard("stopAd",[])}pauseAd(){this.vpaidguard("pauseAd",[])}resumeAd(){this.vpaidguard("resumeAd",[])}expandAd(){this.vpaidguard("expandAd",[])}collapseAd(){this.vpaidguard("collapseAd",[])}getAdLinear(){return this.vpaidguard("getAdLinear",[])}getAdWidth(){return this.vpaidguard("getAdWidth",[])}getAdHeight(){return this.vpaidguard("getAdHeight",[])}getAdExpanded(){return this.vpaidguard("getAdExpanded",[])}getAdSkippableState(){return this.vpaidguard("getAdSkippableState",[])}getAdRemainingTime(){return this.vpaidguard("getAdRemainingTime",[])}getAdDuration(){return this.vpaidguard("getAdDuration",[])}getAdVolume(){return this.vpaidguard("getAdVolume",[])}getAdCompanions(){return this.vpaidguard("getAdCompanions",[])}getAdIcons(){return this.vpaidguard("getAdIcons",[])}setAdVolume(e){return this.vpaidguard("setAdVolume",[e])}subscribe(e,t,i){this.vpaidguard("subscribe",[e,t,i])}unsubscribe(e,t){this.vpaidguard("unsubscribe",[e,t])}setVPAID(e){this.vpaid=e}vpaidguard(e,t=[]){try{return this.callVPAIDMethod(e,t)}catch(e){p.error(`VPAID method guard error: "${e}"`)}}callVPAIDMethod(e,t=[]){return this.vpaid[e].apply(this.vpaid,t)}}{constructor(){super(...arguments),this.status=c.a.READY,this.type=o.a.JS,this.environmentVars=r.b.empty(),this.timeoutId={},this.dispatchedEvents={},this.wigo=r.b.empty(),this.eventHandler=new l.a}static log(e){n.indexOf(g.hasLogged,e)<0&&(g.logger.info(e),g.hasLogged.push(e))}initAd(e,t,i,n,s="",a){try{Object(u.a)("initAd",this.status)}catch(e){return this.dispatchEvent(h.a.AdLog,e)}this.status=c.a.LOADING,this.environmentVars=r.b.fromNullable(a),super.initAd(e,t,i,n,s,a)}handleAdCallTimeout(e){const t=d.b-e,i=()=>{this.dispatchedEvents[h.a.AdLoaded]||this.dispatchEvent(h.a.AdError,{message:"Creative did not initiated after "+d.b+"ms (current status "+this.status+")",id:s.b.GENERAL.id})};!this.timeoutId.initAd&&t>0?this.timeoutId.initAd=setTimeout(i,t):t<0&&i()}startAd(){try{Object(u.a)("startAd",this.status)}catch(e){return this.dispatchEvent(h.a.AdLog,e)}this.status=c.a.STARTING,this.timeoutId.startAd=setTimeout(()=>{this.dispatchedEvents[h.a.AdStarted]||this.dispatchEvent(h.a.AdError,{message:"Creative did not start after "+d.g+"ms",id:s.b.GENERAL.id})},d.g),super.startAd()}stopAd(){this.status>c.a.STOPPING&&(this.status=c.a.STOPPING,this.clearAllTimeout(),this.timeoutId.stopAd=setTimeout(()=>{this.dispatchedEvents[h.a.AdStopped]||(this.dispatchEvent(h.a.AdLog,"Creative did not stop after "+d.h+"ms, force stop !"),this.dispatchEvent(h.a.AdStopped))},d.h),this.environmentVars.forEach(e=>r.b.fromNullable(e.videoSlot).forEach(e=>e.volume=0)),super.stopAd())}skipAd(){if(this.status>c.a.SKIPPING){this.status=c.a.SKIPPING,this.timeoutId.skipAd=setTimeout(()=>{this.status>=c.a.SKIPPING&&(this.dispatchEvent(h.a.AdLog,"Creative did not skip after "+d.f+"ms, force skip !"),this.dispatchEvent(h.a.AdSkipped),this.stopAd())},d.f);try{super.skipAd()}catch(e){this.dispatchEvent(h.a.AdLog,"SkipAd throw an exception "+e)}}}subscribe(e,t,i){this.eventHandler.subscribe(e,t,i)}unsubscribe(e,t){this.eventHandler.unsubscribe(e,t)}getAdWidth(){const e=this.vpaid.getAdWidth(),t=this.environmentVars.flatMap(e=>r.b.fromNullable(e.slot).map(e=>e.offsetWidth));return String(e).indexOf("%")>-1&&t.nonEmpty()?t.getOrValue(0):String(e).indexOf("px")?parseInt(String(e).replace("px",""),10):e}getAdHeight(){const e=this.vpaid.getAdHeight(),t=this.environmentVars.flatMap(e=>r.b.fromNullable(e.slot).map(e=>e.offsetHeight));return(String(e).indexOf("%")>-1||parseInt(String(e),10)<=0)&&t.nonEmpty()?t.getOrValue(0):String(e).indexOf("px")?parseInt(String(e).replace("px",""),10):e}setWigo(e){this.wigo=r.b.fromNullable(e)}getTeadsEnvironmentVars(){return this.vpaid.getTeadsEnvironmentVars?this.vpaid.getTeadsEnvironmentVars():this.environmentVars}vpaidguard(e,t=[]){try{if(this.status!==c.a.REMOVED)return this.callVPAIDMethod(e,t)}catch(t){switch(e){case"initAd":case"startAd":this.dispatchEvent(h.a.AdError,{message:"error call "+e+": "+t,id:s.b.GENERAL.id});break;default:this.dispatchEvent(h.a.AdLog,"error call "+e+": "+t)}g.logger.error("vpaidguard -> vpaid creative threw an error for "+e,t)}}dispatchEvent(e,t){return this.handleVpaidEvent(new h.a(e,t))}handleVpaidEvent(e){if(this.status===c.a.REMOVED)return;let t=[h.a.AdLoaded,h.a.AdStarted,h.a.AdVideoStart,h.a.AdVideoComplete,h.a.AdSkipped,h.a.AdStopped,h.a.AdError];if(!(n.indexOf(t,e.type)>-1&&this.dispatchedEvents[e.type])){if(this.status>c.a.STOPPED)switch(e.type){case h.a.AdLoaded:this.status=c.a.LOADED,this.clearTimeout("initAd"),g.log("AdLoaded - Response from initAd"),this.wigo.forEach(e=>e.valid(3,2));break;case h.a.AdStarted:this.status=this.status<c.a.STARTED?c.a.STARTED:this.status,this.clearTimeout("startAd"),g.log("AdStarted - Response from startAd"),this.wigo.forEach(e=>e.valid(3,3));break;case h.a.AdVideoStart:case h.a.AdPlaying:this.status=c.a.PLAYING;break;case h.a.AdPaused:this.status=c.a.PAUSED;break;case h.a.AdVideoComplete:this.status=c.a.COMPLETE;break;case h.a.AdSkipped:this.status=c.a.SKIPPED,this.clearAllTimeout();break;case h.a.AdStopped:this.status=c.a.STOPPED,this.clearAllTimeout();break;case h.a.AdError:g.logger.info("AdError - ",e.data),this.wigo.forEach(t=>t.valid(3,4,e.data,"error"))}this.dispatchedEvents[e.type]||(this.dispatchedEvents[e.type]=0),this.dispatchedEvents[e.type]++,this.eventHandler.handleEvent(e),e.type===h.a.AdError&&this.stopAd()}}clearTimeout(e){this.timeoutId[e]&&clearTimeout(this.timeoutId[e])}clearAllTimeout(){for(let e in this.timeoutId)this.timeoutId.hasOwnProperty(this.timeoutId[e])&&this.clearTimeout(this.timeoutId[e])}}g.logger=new a.a("vpaid.BaseVPAIDJSWrapper"),g.hasLogged=[]},function(e,t,i){i.d(t,"c",(function(){return o})),i.d(t,"b",(function(){return d})),i.d(t,"a",(function(){return c}));var n=i(5),s=i(6),r=i(113);let a=!1;function o(e,t,i){return n.a.tryCatch(()=>{e.navigator.geolocation.getCurrentPosition(t,i)}).orElse(e=>(i({code:1,message:e.message,PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2,TIMEOUT:3}),Object(n.b)(e)))}function d({coords:{accuracy:e,latitude:t,longitude:i}}){return{accuracy:e,latitude:t,longitude:i}}function c(e,t,i){i&&i.DeviceOrientationEvent&&!a&&(a=!0,s.addEventListener("deviceorientation",i,e=>{t.sendMessage({method:r.a.SENSOR_UPDATE,methodReturn:{alpha:e.alpha,beta:e.beta,gamma:e.gamma,absolute:e.absolute}})}))}},function(e,t,i){i.d(t,"a",(function(){return r}));var n=i(0),s=i(139);class r{constructor(){this.version=2,this.tracking=new s.a,this.clickThrough=[],this.adChoicesIconClickThrough=n.a,this.mediaFiles=[],this.title="",this.wrappers=[],this.skippable=!1,this.skipDelay=0,this.extensions=[]}merge(e){var t,i;for(var n in e.version&&this.version<e.version&&(this.version=e.version),!this.url&&e.url&&(this.url=e.url),!this.title&&e.title&&(this.title=e.title),!this.adSystem&&e.adSystem&&(this.adSystem=e.adSystem),!this.id&&e.id&&(this.id=e.id),!this.creativeId&&e.creativeId&&(this.creativeId=e.creativeId),!this.duration&&e.duration&&(this.duration=e.duration),!this.adParameters&&e.adParameters&&(this.adParameters=e.adParameters),e.adTagUri&&this.wrappers.push(e.adTagUri),e.tracking)for(t=0,i=e.tracking[n].length;t<i;t++)"clickIcon"!==n&&this.tracking[n].push(e.tracking[n][t]);for(this.adChoicesIconClickThrough.isEmpty()&&!e.adChoicesIconClickThrough.isEmpty()&&(this.adChoicesIconClickThrough=e.adChoicesIconClickThrough,this.tracking.clickIcon=e.tracking.clickIcon),t=0,i=e.mediaFiles.length;t<i;t++)this.mediaFiles.push(e.mediaFiles[t]);for(t=0,i=e.clickThrough.length;t<i;t++)this.clickThrough.push(e.clickThrough[t]);for(t=0,i=e.extensions.length;t<i;t++)this.extensions.push(e.extensions[t]);!this.skippable&&e.skippable&&(this.skippable=!0,this.skipDelay=e.skipDelay)}}},function(e,t,i){i(60);var n=i(1),s=i(3),r=i(6),a=i(10),o=i(69),d=i(12),c=i(2),l=i(86);s.init();const h=window.teads||{};h.ArrayHelper=n,h.Context=s,h.Dom=r,h.HTMLHelper=a,h.Random=o,h.StringHelper=d,h.Utils=c,h.Uuid=l,window.teads=h},function(e,t){e.exports="<div class=\"loader\"> <style> .loader:before, .loader:after, .loader { border-radius: 50%; width: 1.5em; height: 1.5em; -webkit-animation-fill-mode: both; animation-fill-mode: both; -webkit-animation: load7 1.8s infinite ease-in-out; animation: load7 1.8s infinite ease-in-out; } .loader { font-size: 8px; margin-left: -8px; position: absolute; left: 50%; top: 30%; z-index: 10; text-indent: -9999em; -webkit-transform: translateZ(0); -ms-transform: translateZ(0); transform: translateZ(0); -webkit-animation-delay: -0.16s; animation-delay: -0.16s; } .loader:before { left: -2em; -webkit-animation-delay: -0.32s; animation-delay: -0.32s; } .loader:after { left: 2em; } .loader:before, .loader:after { content: ''; position: absolute; top: 0; } @-webkit-keyframes load7 { 0%, 80%, 100% { box-shadow: 0 2.5em 0 -1.3em #ffffff; } 40% { box-shadow: 0 2.5em 0 0 #ffffff; } } @keyframes load7 { 0%, 80%, 100% { box-shadow: 0 2.5em 0 -1.3em #ffffff; } 40% { box-shadow: 0 2.5em 0 0 #ffffff; } } </style> loading...</div> "},function(e,t){e.exports="<style> /* This used to work for parent element of button divs */ /* But it is not enough now, below dont hide play button parent div */ *::-webkit-media-controls-panel { display: none!important; -webkit-appearance: none; } /* Old shadow dom for play button */ *::--webkit-media-controls-play-button { display: none!important; -webkit-appearance: none; } /* New shadow dom for play button */ /* This one works */ *::-webkit-media-controls-start-playback-button { display: none!important; -webkit-appearance: none } </style> "},function(e,t,i){i.d(t,"a",(function(){return a}));var n=i(3),s=i(5);function r(e){return"video/mp4"===e}function a(e){return Object(n.isSDK)()?Object(n.isIos)()?r(e):!!Object(n.isAndroid)()&&(r(e)||function(e){return"video/webm"===e}(e)):function(e){return s.a.tryCatch(()=>!!document.createElement("video").canPlayType(e)).getOrElse(()=>!1)}(e)}},function(e,t,i){i.d(t,"a",(function(){return a}));var n=i(107),s=i(47),r=i(2);class a{constructor(e,t){this.api=e,this.playerWindow=t,this.eventListenerManager=new s.a}startListening(){this.eventListenerManager.add("message",this.playerWindow,e=>{if(Object(r.isObject)(e.data)){const t=e.data;if(!t.method)return;switch(t.method){case a.INIT_MESSAGE:this.pairedAdWindow=e.source,this.sendMessage({method:a.INIT_MESSAGE});break;default:try{if(Object(r.isFunction)(this.api[t.method]))if("getUserLocation"===t.method)this.handleGetUserLocationRequest(t);else{const e=this.api[t.method](...t.methodArgs);this.sendMessage({method:t.method,methodReturn:e})}else this.sendMessage({method:t.method,error:`Method ${t.method} does not exist on api`})}catch(e){this.sendMessage({method:t.method,error:e.toString()})}}}})}stopListening(){this.eventListenerManager.remove("message")}sendMessage(e){this.pairedAdWindow&&this.pairedAdWindow.postMessage(e,"*")}handleGetUserLocationRequest(e){this.api[e.method](t=>{this.sendMessage({method:e.method,methodReturn:n.b(t)})},t=>{this.sendMessage({method:e.method,methodReturn:t.message||t.toString()})})}}a.INIT_MESSAGE="studio-ad--format-RPC",a.SENSOR_UPDATE="-studio-ad--sensors-update"},function(e,t,i){i.d(t,"a",(function(){return H}));var n=i(3),s=i(9),r=i(2),a=i(30),o=i(1),d=i(50),c=i(40),l=i(15),h=i(78),u=i(79);class p extends a.a{constructor(){super(...arguments),this.status=u.a.UNSTARTED}static getFileExtension(e){return l.p(e).pathname.split(".").pop()}getStatus(){return this.status}getVideoUrl(){return this.videoUrl}load(e,t){if(o.indexOf(p.alreadyEncoded,p.getFileExtension(e))>-1)return this.videoUrl=e,this.status=u.a.READY,void this.dispatch(h.a.READY,{errorCode:200});this.status=u.a.WAITING,this.dispatch(h.a.WAITING);const i=location.hostname.match(/.+\.sandbox\.teads\.net|localdocker/),n="https://[HOST]/transcode?url=[URL]&bitrate=[BITRATE]".replace(/\[HOST\]/,i?i[0]+":18088":"mp.teads.tv").replace(/\[URL\]/,encodeURIComponent(e)).replace(/\[BITRATE\]/,t.toString()),s=c.a();let r=!1;s.open("GET",n,!0),s.onreadystatechange=()=>{if(4===s.readyState&&!r){switch(s.status){case 200:this.videoUrl=s.responseText,this.status=u.a.READY,this.dispatch(h.a.READY,{errorCode:s.status}),r=!0;break;case 416:case 202:case 201:default:this.status=u.a.ERROR,this.dispatch(h.a.ERROR,{errorCode:s.status}),r=!0}d.a.info("proxy resp "+s.status)}},s.send(),d.a.info("proxy call")}}p.alreadyEncoded=["tv","mpg","mpeg"];var g,m=i(90);!function(e){e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED",e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK",e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE",e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED"}(g||(g={}));var b=g,f=i(12),v=i(10);function A(e,t,i,n){Object.defineProperty(e,t,function(){let e={enumerable:!0,configurable:!0,get:function(){return i.call(this)},set:function(e){}};return n&&(e.set=function(e){n.call(this,e)}),e}())}function y(e,t){const i=e.getAttribute(t);switch(t){case"width":case"height":e.style[t]=i+(function(e){return String(e).indexOf("%")>-1}(i)||function(e){return String(e).indexOf("px")>-1}(i)?"":"px");break;case"src":case"preload":e[t]=i;break;case"autoplay":case"loop":e[t]=function(e){return"true"===e||"false"!==e&&!!e}(i)}}var w=i(45);const E={poster:!0,width:!0,height:!0,videoHeight:!1,videoWidth:!1,buffered:!1,duration:!1,ended:!1,error:!1,networkState:!1,paused:!1,played:!1,readyState:!1,seekable:!1,seeking:!1,currentSrc:!1,autoplay:!0,controls:!0,currentTime:!0,loop:!0,muted:!1,defaultMuted:!0,playbackRate:!1,defaultPlaybackRate:!1,preload:!1,src:!0,volume:!0,audioTracks:!1,textTracks:!1,videoTracks:!1},O=function(e){this._wrappedVideo=e};O.prototype=Object.create(HTMLElement.prototype);let C=function(e,t){A(O.prototype,e,(function(){return this._wrappedVideo[e]}),(function(i){t&&(this._wrappedVideo[e]=i)}))};for(var I in E)E.hasOwnProperty(I)&&C(I,E[I]);O.prototype.addEventListener=function(e,t,i=!1){this._wrappedVideo.addEventListener(e,t,i)},O.prototype.canPlayType=function(e){return this._wrappedVideo.canPlayType()},O.prototype.load=function(){this._wrappedVideo.load()},O.prototype.pause=function(){this._wrappedVideo.pause()},O.prototype.play=function(){this._wrappedVideo.play()},O.prototype.getVideoPlaybackQuality=function(){return this._wrappedVideo.getVideoPlaybackQuality()},O.prototype.webkitEnterFullscreen=function(){return this._wrappedVideo.webkitEnterFullscreen()},O.prototype.webkitExitFullscreen=function(){this._wrappedVideo.webkitExitFullscreen()},O.prototype.webkitEnterFullScreen=function(){this.webkitEnterFullscreen()},O.prototype.webkitExitFullScreen=function(){this.webkitExitFullscreen()};class S{constructor(){this.ranges=[]}get length(){return this.ranges.length}addRange(e,t){this.ranges.push({start:e,end:t})}start(e){return this.ranges[e].start}end(e){return this.ranges[e].end}}var T=i(112);function k(){this.logger=new s.a("HTMLVideoCanvas"),this._mainContainer=document.createElement("div"),this._mainContainer.style.backgroundColor="black",this._mainContainer.style.position="relative",this._mainContainer.style.width="100%",this._mainContainer.style.height="100%",this._mainContainer.style.zIndex=1,this.appendChild(this._mainContainer),this._videoContainer=document.createElement("div"),this._videoContainer.style.position="absolute",this._videoContainer.style.top=0,this._videoContainer.style.left=0,this._videoContainer.style.zIndex=2,this._videoContainer.style.width="100%",this._videoContainer.style.height="100%",this._mainContainer.appendChild(this._videoContainer),this.canvasPlayer=new m.a(this._videoContainer,1,1,{type:"CANVAS"}),this.mediaProxy=new p,this.mediaProxy.listen(h.a.READY,()=>{this.logger.debug("MediaProxy return video url",this.mediaProxy.getVideoUrl()),this.canvasPlayer.src=this.mediaProxy.getVideoUrl(),this.autoplay&&this.canvasPlayer.play(),this.volume=this._volume}),this.mediaProxy.listen(h.a.ERROR,()=>{this.logger.debug("MediaProxy didn't return video url"),this._error={code:b.MEDIA_ERR_NETWORK},this.canvasPlayer.dispatch(w.error)}),this.canvasPlayer.canvas.style.position="absolute",this.canvasPlayer.canvas.style.maxHeight="none",this.canvasPlayer.canvas.style.maxWidth="none",this.canvasPlayer.canvas.style.top="0",this.canvasPlayer.canvas.style.left="0",O.call(this,this.canvasPlayer),this.listeners={};let e=t=>{if(this.listeners[t.type]&&this.listeners[t.type].length){for(let e=0,i=this.listeners[t.type].length;e<i;e++)try{this.listeners[t.type][e].call(this,t)}catch(e){this.logger.error(`Error in Canvas event handler: "${e}"`)}"loadedmetadata"===t.type&&e(new CustomEvent("durationchange")),"playing"!==t.type||this.attachedCallbackCalled||this.attachedCallback()}};for(var t in w){let i=w[t];this.canvasPlayer.addEventListener(i,t=>{e(t)})}this.canvasPlayer.addEventListener(w.loadedmetadata,e=>{this._handleResize()}),this.canvasPlayer.addEventListener(w.durationchange,e=>{void 0!==this._volume&&(this.canvasPlayer.volume=this._volume)}),this.canvasPlayer.addEventListener(w.playing,t=>{let i=()=>{this._width&&this._height||(this.logger.debug("component got no width/height, try to adapt to container"),this._width=this._mainContainer.offsetWidth,this._height=this._mainContainer.offsetHeight),this._width&&this._height?(this.logger.debug("component have dimensions, force resize",this._width,this._height),this._handleResize()):setTimeout(i,100)};i(),e(new CustomEvent("timeupdate"))}),this._ended=!1,this.canvasPlayer.addEventListener(w.ended,t=>{this._ended=!0,this._paused=!0,e(new CustomEvent("timeupdate")),e(new CustomEvent("ended")),this.loop&&(this.currentTime=0,this.play())}),this._paused=!0,this.canvasPlayer.addEventListener(w.pause,e=>{this._paused=!0}),this.canvasPlayer.addEventListener(w.timeupdate,e=>{this._paused=!1}),this._seeking=!1,this.canvasPlayer.addEventListener(w.seeking,e=>{this._seeking=!0}),this.canvasPlayer.addEventListener(w.seeked,e=>{this._seeking=!1}),this.canvasPlayer.addEventListener(w.error,e=>{this._error=e.error})}k.prototype=Object.create(O.prototype),A(k.prototype,"src",(function(){return this._src}),(function(e){if(this.logger.debug("set src",e),(this.src||e)&&e!==this.src&&""!==e){if(Object(f.isURL)(e)){let l=o.indexOf(p.alreadyEncoded,p.getFileExtension(e))>-1;if(!T.a("video/mp4")&&"mp4"!==p.getFileExtension(e)&&!l&&(this.error=4,this.logger.error("only mp4,"+p.alreadyEncoded.join(",")+" files are supported, try to set "+e+" as src"),this.listeners.error))return void o.forEach(this.listeners.error,e=>e());l?this.mediaProxy.load(e,512):(t=e,i=(t,i)=>{this.mediaProxy.load(e,i)},r=c.a(),a=Date.now(),d=e=>{n||(clearTimeout(s),n=Date.now()-a,i(n,n<=100?1e3:n<200?700:n<400?500:300))},s=setTimeout(()=>d(),500),r.open("HEAD",t+(t.indexOf("?")>-1?"&":"?")+a,!0),r.addEventListener("load",()=>d()),r.addEventListener("error",()=>d()),r.send())}var t,i,n,s,r,a,d;this._src=e,this.setAttribute("src",String(e))}})),o.forEach(["width","height"],(function(e){A(k.prototype,e,(function(){return this["_"+e]||0}),(function(t){this.logger.debug("set property "+e,t),isNaN(t)||this["_"+e]===t||(this["_"+e]=t,"width"===e&&!this.height&&this.videoWidth&&this.videoHeight?this._height=t*(this.videoHeight/this.videoWidth):"height"===e&&!this.width&&this.videoWidth&&this.videoHeight&&(this._width=t*(this.videoWidth/this.videoHeight))),this._handleResize()}))})),A(k.prototype,"volume",(function(){return void 0!==this._volume?this._volume:0}),(function(e){this._volume=e,this.canvasPlayer.audio&&this.canvasPlayer.audio.authorizeAudio(()=>{this.canvasPlayer.volume=this._volume}),this.canvasPlayer.volume=this._volume})),A(k.prototype,"currentTime",(function(){return this._ended?this.canvasPlayer.duration:isNaN(this.canvasPlayer.currentTime)?0:this.canvasPlayer.currentTime}),(function(e){this.canvasPlayer.currentTime=e})),A(k.prototype,"seekable",(function(){return!0})),A(k.prototype,"readyState",(function(){return 4})),A(k.prototype,"networkState",(function(){return 1})),A(k.prototype,"autoplay",(function(){return void 0!==this._autoplay&&this._autoplay}),(function(e){this._autoplay=e})),A(k.prototype,"videoWidth",(function(){return this.canvasPlayer.videoWidth||0})),A(k.prototype,"videoHeight",(function(){return this.canvasPlayer.videoHeight||0})),A(k.prototype,"preload",(function(){return!0}),(function(e){})),A(k.prototype,"seeking",(function(){return this._seeking})),A(k.prototype,"muted",(function(){return 0===this._volume})),A(k.prototype,"ended",(function(){return this._ended})),A(k.prototype,"error",(function(){return this._error})),A(k.prototype,"paused",(function(){return this._paused})),A(k.prototype,"currentSrc",(function(){return this._src})),A(k.prototype,"played",(function(){let e=new S;return e.addRange(0,this.currentTime),e})),A(k.prototype,"buffered",(function(){let e=new S;return e.addRange(0,this.currentTime),e})),A(k.prototype,"loop",(function(){return void 0!==this._loop&&this._loop}),(function(e){this._loop=e,this.setAttribute("loop",String(e))})),A(k.prototype,"controls",(function(){return!1}),(function(e){})),k.prototype.load=r.noop,k.prototype.canPlayType=function(e){return"video/mp4"===e?"probably":""},k.prototype.addEventListener=function(e,t,i=!1){w[e]&&r.isObject(this.listeners)?(this.listeners[e]=this.listeners[e]||[],this.listeners[e].push(t)):HTMLElement.prototype.addEventListener.call(this,e,t,i)},k.prototype.removeEventListener=function(e,t,i){if(w[e]){let i=this.listeners[e].indexOf(t);i>=0&&(this.listeners[e][i]=()=>{})}else HTMLElement.prototype.removeEventListener.call(this,e,t,i)},k.prototype._handleResize=function(){this.canvasPlayer.width=this.width,this.canvasPlayer.height=this.height,this.style.backgroundColor="black"},k.prototype.createdCallback=function(){k.call(this)},k.prototype.attributeChangedCallback=function(e,t,i){this.logger.debug("attributeChangedCallback",e,t,i),y(this,e)},k.prototype.detachedCallback=function(){this.logger.debug("detached callback called"),this.canvasPlayer.pause()},k.prototype.attachedCallback=function(){this.logger.debug("attachedCallback called"),this.attachedCallbackCalled=!0;try{this.style.display="block",this.style.overflow="hidden",this.style.objectFit="contain";let e=["width","height","position","top","left"],t=window.originalCreateElement?window.originalCreateElement.call(this.ownerDocument,"video"):this.ownerDocument.createElement("video");this.parentNode.appendChild(t),v.copyCSSRules(t,this,e),t.parentNode.removeChild(t),this.style.width&&"auto"!==this.style.width||(this.style.width="100%"),this.style.height&&"auto"!==this.style.height||(this.style.height="100%"),this._handleResize(),this._iframeResizer=document.createElement("iframe"),this._iframeResizer.style.zIndex=0,this._iframeResizer.style.width="100%",this._iframeResizer.style.height="100%",this._iframeResizer.style.border="none",this._iframeResizer.style.margin="0",this._iframeResizer.style.padding="0",this._mainContainer.appendChild(this._iframeResizer),this._iframeResizer.contentWindow.document.write("<html><body></body></html>"),this._iframeResizer.contentWindow.document.close();let i=()=>{this._width=this._iframeResizer.contentWindow.innerWidth,this._height=this._iframeResizer.contentWindow.innerHeight,this.logger.debug("component resized",this.width,this.height),this._handleResize()};this._iframeResizer.contentWindow.addEventListener("resize",i,!1),this._handleResize(),this.style.backgroundColor="black"}catch(e){this.logger.debug("attachedCallback throw an exception",e)}};i(142);const j=window.teads||{},P=window.teads.video||{};P.HTMLVideoCanvas=(()=>{if(!Object(n.isDesktop)())try{const e=P.HTMLVideoCanvas;return new e,e}catch(e){try{return document.registerElement("video-canvas",{prototype:k.prototype})}catch(e){new s.a("Video globals").warn(e)}}})(),P.HTMLVideoCanvas&&P.HTMLVideoCanvas.prototype&&(P.HTMLVideoCanvas.prototype.addEventListener=k.prototype.addEventListener),j.video=P,window.teads=j;const L=window.teads||{};window.teads=L;var x=i(17),V=i(0),N=i(58),D=i(51),_=i(70);var R=i(52),M=i(81),F=i(4),U=i(75),B=i(32),W=i(101);class H extends class{constructor(e,t){this.container=e,this.config=t,this.logger=new s.a("vpaid.BaseVPAIDContainer"),this.backgroundColor="#000000",this.id=t.id||Object(f.rand)(20,!1)}setBackground(e){this.backgroundColor=e}destroy(){try{!this.isDetroyed&&this.creativeContainer?(this.isDetroyed=!0,V.b.fromNullable(this.creativeContainer.parentNode).forEach(e=>e.removeChild(this.creativeContainer)),this.creativeContainer=null,this.vpaid=null):this.isDetroyed&&this.logger.error("Cannot call destroy twice !")}catch(e){this.logger.error("unable to remove VPAID creative container: "+e)}}getVPAID(){return this.logger.info("getVPAIDAd - Retrieve ad from creative"),this.vpaid}getCreativeContainer(){return this.creativeContainer}}{constructor(){super(...arguments),this.getCreativeWindow=e=>e.contentWindow||v.getWindow(e)}loadVpaid(e,t,i){this.url=e;const n=V.b.fromNullable(v.getWindow(this.container));let s=!1;const a=e=>{n.forEach(e=>e[this.callbackName]=r.noop),i(e),this.destroy()};this.callbackName="vpaidjsload_"+this.id,n.forEach(e=>e[this.callbackName]=i=>{if(s=!0,clearTimeout(this.loadTimeoutId),e[this.callbackName]=r.noop,i){const e=this.getCreativeWindow(this.creativeContainer);try{this.vpaid=e.getVPAIDAd()}catch(e){let t=_.b;return t.message+=" "+e,a(t)}this.logger.info("getVPAIDAd - Retrieve ad from creative"),t(this.vpaid)}else a(_.c)}),this.setUpCreativeContainers(this.container,e),this.loadTimeoutId=setTimeout(()=>{s||a(_.d)},R.c)}setUpCreativeContainers(e,t){this.mainContainer=document.createElement("div"),this.mainContainer.style.setProperty("position","relative"),e.appendChild(this.mainContainer),this.creativeContainer=v.createIframe("vpaid-container-"+this.id),this.creativeContainer.id="vpaid-"+this.id,this.mainContainer.appendChild(this.creativeContainer),V.b.fromNullable(this.getCreativeWindow(this.creativeContainer)).forEach(e=>{e.teads=Object.assign(Object.assign({},window.teads),{api:this.config.api}),e.document.write(this.getCreativeTemplate(t,this.callbackName,this.backgroundColor)),e.document.close(),this.vpaidContainer=e.document.getElementById("vpaid-container"),this.videoContainer=e.document.getElementById("video-container")})}getCreativeTemplate(e,t,i){return`\n      <!DOCTYPE html>\n      <html>\n        <body style="margin:0px;padding:0px;overflow:hidden">\n          <script type="text/javascript">\n            var target = window.parent;\n            var script = document.createElement("script");\n            script.onload = function() {\n              target["${t}"](true)\n            };\n            script.onerror = function() {\n              target["${t}"](false)\n            };\n            script.async = true;\n            script.src = "${e}";\n            document.body.appendChild(script);\n          <\/script>\n          <div id="video-container"\n            style="position:absolute;top:0px;left:0px;z-index:1;background-color:${i}">\n          </div>\n          <div id="vpaid-container" style="position:absolute;top:0px;left:0px;z-index:2"></div>\n        </body>\n      </html>\n    `}getEnvironmentVars(e={}){return V.b.fromNullable(this.environmentVars).getOrElse(()=>(this.environmentVars=Object.assign(Object.assign({},Object(D.a)({slot:this.vpaidContainer,videoSlot:this.initVideo(this.getCreativeWindow(this.creativeContainer)||window,this.config.useCustomVideo&&window.teads.video.HTMLVideoCanvas),videoSlotCanAutoPlay:!0},Object(r.not)(r.isNull))),e),this.environmentVars))}destroy(){super.destroy(),this.mainContainer&&this.mainContainer.parentNode&&(this.mainContainer.parentNode.removeChild(this.mainContainer),this.mainContainer=null,this.videoContainer=null)}resize(e,t){var i,n;this.currentWidth=e,this.currentHeight=t;const s=(null===(n=null===(i=this.config)||void 0===i?void 0:i.api)||void 0===n?void 0:n.isVideoBanner())?W.a(e):t;if(this.mainContainer&&(this.mainContainer.style.setProperty("width",e+"px"),this.mainContainer.style.setProperty("height",t+"px")),this.creativeContainer&&(this.creativeContainer.style.setProperty("width",e+"px","important"),this.creativeContainer.style.setProperty("height",t+"px","important")),this.videoContainer){this.videoContainer.style.setProperty("width",e+"px"),this.videoContainer.style.setProperty("height",s+"px");var r=this.videoContainer.getElementsByTagName("video")[0];r&&(r.width=e,r.height=t,r.style.setProperty("width",e+"px"),r.style.setProperty("height",s+"px"))}this.vpaidContainer&&(this.vpaidContainer.style.setProperty("width",e+"px"),this.vpaidContainer.style.setProperty("height",s+"px"))}setBackground(e){var t;super.setBackground(e),null===(t=this.videoContainer)||void 0===t||t.style.setProperty("background-color",this.backgroundColor)}getType(){return M.a.JS}registerVPAIDEventHandler(e){this.callback=e;const t=D.c(t=>V.b.fromNullable(this.vpaid).forEach(i=>i.subscribe(Object(U.b)(e,t),t,this)));t(F.a),t(B.a)}overrideCreateElement(e){const t=V.b.fromNullable(this.creativeContainer.contentDocument||this.creativeContainer.ownerDocument);window.originalCreateElement=window.originalCreateElement||t.map(e=>e.createElement).getOrNull();const i=this;t.forEach(t=>{t.createElement=function(n){return"video"===n.toLowerCase()?(i.logger.debug("createElement overriden for",n),e):window.originalCreateElement.call(t,n)}})}initVideo(e,t){const i=t?this.initCustomVideo(e):this.initClassicVideo(e);return(t||n.isIos10Safari())&&this.overrideCreateElement(i),V.b.fromNullable(this.videoContainer).forEach(e=>e.appendChild(i)),this.resize(this.currentWidth,this.currentHeight),i}initCustomVideo(e){e.document.registerElement=e.document.registerElement||document.registerElement,e.teads=e.teads||window.teads,e.teads.video=window.teads.video;const t=new e.teads.video.HTMLVideoCanvas;return t.addEventListener(w.error,e=>{if(this.logger.error("receive video error event",e,t.error),this.callback){this.logger.debug("callback ready to handle video error");const e=t.error&&t.error.code===b.MEDIA_ERR_NETWORK?"MediaProxy not ready":"unknow video error";this.logger.error(e),this.callback(new F.a(F.a.AdError,{message:e,id:x.b.UNSUPPORTED_MEDIAFILE.id}))}else this.logger.error("callback not ready to handle video error")},!1),t}initClassicVideo(e){const t=e.document.createElement("video");return t.setAttribute("webkit-playsinline","true"),t.setAttribute("playsinline","true"),t.setAttribute("muted","true"),n.isAndroid()&&n.isChromeWebView()&&t.setAttribute("poster",N.b),t}}},function(e,t,i){i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a}));var n=i(4),s=i(29);const r={error:n.a.AdError,click:n.a.AdClickThru,pause:n.a.AdPaused,resume:n.a.AdPlaying,skip:n.a.AdSkipped,creativeView:n.a.AdStarted,start:n.a.AdVideoStart,firstQuartile:n.a.AdVideoFirstQuartile,midpoint:n.a.AdVideoMidpoint,thirdQuartile:n.a.AdVideoThirdQuartile,complete:n.a.AdVideoComplete,impression:n.a.AdImpression,close:n.a.AdUserClose,closeLinear:n.a.AdUserClose,progress:n.a.AdRemainingTimeChange,otherAdInteraction:n.a.AdInteraction},a={adChoices:s.a.AdChoicesClickRequest}},function(e,t,i){i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return r}));var n=i(2);const s=e=>e,r=e=>Object(n.isNumber)(e)&&e>=0},function(e,t,i){i.d(t,"a",(function(){return a}));var n=i(3),s=i(18),r=i(2);class a extends s.a{constructor(e=a.DEFAULT,t=null){super("VideoStart"),this.value=e,t&&t.isInBoard()&&Object(n.isTablet)()&&(this.value=a.VALUES.CLICK),this.checkValue()}checkValue(){Object(r.isString)(this.value)&&a.VALUES[this.value.toUpperCase()]||(this.value=a.DEFAULT)}isThreshold(){return this.value===a.VALUES.THRESHOLD}isClick(){return this.value===a.VALUES.CLICK}getValue(){return this.value}}a.VALUES={THRESHOLD:"threshold",CLICK:"click"},a.DEFAULT=a.VALUES.THRESHOLD},function(e,t,i){i.d(t,"a",(function(){return A}));i(136);var n=i(3),s=i(54),r=i(0),a=i(47),o=i(5),d=i(12),c=i(10),l=i(9),h=i(1),u=i(22),p=i(35),g=i(23),m=i(2),b=i(88),f=i(6);const v=e=>new Promise((t,i)=>{e((e,i)=>{t(!!e&&e.cmpLoaded)}),p.d(i,A.PING_REQUEST_TIMEOUT)});class A{constructor(e,t){this.win=e,this.pageId=t,this.cmpHandler=Object(c.isInCrossDomainIframe)(document.body)?(()=>{if(Object(n.isIABSafeFrame)()){const e=Object(n.getIABSafeFrameWindow)();return!Object(m.isUndefined)(e)&&Object(m.isFunction)(e.$sf.ext.cmp)}return!1})()?new E:new w(this.win):new y(this.win)}static isConsentDataValid(e){return Object(m.isBoolean)(e.gdprApplies)&&(Object(m.isUndefined)(e.hasGlobalScope)?Object(m.isBoolean)(e.hasGlobalConsent):Object(m.isBoolean)(e.hasGlobalScope))}static getGlobalConsent(e){return Object(m.isUndefined)(e.hasGlobalScope)?!!e.hasGlobalConsent:e.hasGlobalScope}static transformCmpResponse(e,t){const i={status:null,consent:"",reason:null,apiVersion:Object(r.c)(1),cmpId:r.a},n=r.b.fromNullable(e);let s=n.map(e=>e.consentData||e.consentObject).getOrValue("");return!1===t?(i.status=21,i.reason=210):Object(m.isString)(s)?(i.consent=s,A.isConsentDataValid(e)?e.gdprApplies?A.getGlobalConsent(e)?(i.status=11,i.reason=A.isTimeoutNeeded?110:111):(i.status=12,i.reason=A.isTimeoutNeeded?120:121):(i.status=0,i.reason=0):(i.status=24,i.reason=240)):(A.logWrongConsentData(n),i.status=24,i.reason=240),A.updateTeadsGDPRPayload(i),i}static updateTeadsGDPRPayload(e){A.payload=e,window.teads.gdprPayload.status=e.status,window.teads.gdprPayload.consent=e.consent,window.teads.gdprPayload.reason=e.reason,window.teads.gdprPayload.apiVersion=e.apiVersion.getOrValue(""),window.teads.gdprPayload.cmpId=e.cmpId.getOrValue(""),A.logger.info(`payload: { status: ${e.status}, consent: ${e.consent}, reason: ${e.reason}}, apiVersion: ${e.apiVersion}, cmpId: ${e.cmpId}`)}static logWrongConsentData(e){e.match({some:e=>{const t=h.filter(Object.keys(e),e=>!h.includes(["gdprApplies","hasGlobalScope","hasGlobalConsent","vendorListVersion"],e)),i=h.map(t,t=>`${t}(${null===e[t]?"null":typeof e[t]})`);A.logger.info("gdpr-wrong-consent "+i.join(",").substr(0,120))},none:()=>A.logger.info("gdpr-wrong-consent null")})}requestConsentString(){return window.teads.gdprPayload.tsCmpCall=Object(u.a)(),(()=>this.retrievePayloadFromPublisherCmp().catch(e=>{let t;switch(e.status){case 22:t=122;break;case 21:t=124;break;case 23:default:t=123}return this.retrievePayloadFromPublisherCookie(123).map(e=>Object.assign(Object.assign({},e),{reason:t})).getOrValue(e)}))()}retrievePayloadFromPublisherCmp(){return A.logger.info("Trying to get consent from publisher CMP"),new Promise((e,t)=>{if(this.cmpHandler.isIntegrated()){A.isTimeoutNeeded?(A.logger.info("No overlay detected, putting a timeout on requestConsentString"),this.cmpTimeout=p.d(()=>{A.logger.warn(`No response from getConsentData after ${A.GET_CONSENT_DATA_FOR_PUBLISHER_CMP_REQUEST_TIMEOUT}ms`),A.logger.info("gdpr-cmp-consent-timeout 0"),Promise.reject({status:23,consent:"",reason:232,apiVersion:Object(r.c)(1),cmpId:r.a}).catch(e=>{this.cmpHandler.ping().then(i=>{const n=i?230:231;A.logger.warn("Timeout when retrieving publisher consent: Reason "+n),t(Object.assign(Object.assign({},e),{reason:n}))}).catch(i=>{A.logger.warn("Timeout on CMP ping command",i),t(e)})})},A.GET_CONSENT_DATA_FOR_PUBLISHER_CMP_REQUEST_TIMEOUT)):A.logger.info("Overlay detected, not putting a timeout on requestConsentString");const i=Object(g.b)(this.pageId,Object(u.a)());Object(g.i)({name:0,id:i}),o.a.tryCatch(()=>{this.cmpHandler.onIntegrationSuccess((t,n)=>{Object(g.i)({name:1,id:i}),Object(g.k)({name:0,id:i},{name:1,id:i}).forEach(e=>{const t=A.isTimeoutNeeded?"gdpr-cmp-response "+e.duration.toFixed(2):`gdpr-cmp-response ${e.duration.toFixed(2)} overlay-detected`;A.logger.info(t)}),this.cmpTimeout&&this.cmpTimeout.clear(),A.logger.info("gdpr-cmp-consent-timeout 1"),e(A.transformCmpResponse(t,n))})}).tapLeft(e=>{A.logger.error("Error on get ConsentData: "+e),A.logger.warn("GPDR getConsenData error"),this.cmpTimeout&&this.cmpTimeout.clear(),t({status:21,consent:"",reason:211,apiVersion:Object(r.c)(1),cmpId:r.a})})}else A.logger.warn("Could not detect any CMP integration"),t({status:22,consent:"",reason:220,apiVersion:Object(r.c)(1),cmpId:r.a})})}retrievePayloadFromPublisherCookie(e){return A.logger.info("Trying to get publisher consent from cookies"),Object(s.a)(A.CONSENT_COOKIE_NAME).toOption().filter(e=>!!e).map(t=>(A.logger.info("Consent retrieved from publisher cookies"),{status:12,consent:t,reason:e,apiVersion:Object(r.c)(1),cmpId:r.a}))}}A.GET_CONSENT_DATA_FOR_PUBLISHER_CMP_REQUEST_TIMEOUT=250,A.GET_CONSENT_DATA_FOR_TEADSEUCONSENT_REQUEST_TIMEOUT=250,A.PING_REQUEST_TIMEOUT=10,A.CMP_IFRAME_NAME="__cmpLocator",A.CONSENT_COOKIE_NAME="euconsent",A.QUANTCAST_OVERLAY_CLASSNAME="qc-cmp-ui qc-cmp-showing",A.isTimeoutNeeded=!0,A.logger=new l.a("GDPR");class y{constructor(e){this.win=e,this.logger=new l.a("GDPR - RegularCmpHandler"),this.childWindows=[],A.isTimeoutNeeded=!this.hasQuantcastOverlay(),A.isTimeoutNeeded&&this.detectAndLogQuantcastOverlay()}isIntegrated(e=!0,t=(()=>{}),i=this.win){return Object(m.isFunction)(i.__cmp)?(i!==this.win?(this.win=i,this.logger.info("Regular CMP integration detected on a child window"),t("on a child window")):(this.logger.info("Regular CMP integration detected on top window"),t("on top window")),!0):(e&&(this.childWindows=this.childWindows.concat(Object(c.findChildWindows)(i.document.body))),this.childWindows.length>0&&this.isIntegrated(!1,t,this.childWindows.shift()))}onIntegrationSuccess(e){this.win.__cmp("getConsentData",null,e)}ping(){return v(e=>this.win.__cmp("ping",null,e))}hasQuantcastOverlay(){const e=Object(f.getElementsByClassName)(A.QUANTCAST_OVERLAY_CLASSNAME,this.win.document,this.win);return e.length>0&&"relative"===this.win.getComputedStyle(e[0]).position}detectAndLogQuantcastOverlay(){const e=Object(u.a)();let t=0;const i=()=>new Promise(i=>{this.hasQuantcastOverlay()&&(this.logger.warn(`gdpr-overlay-detected ${Object(u.a)()-e}ms`),i()),t++,t>10&&i()}),n=p.c(()=>i().then(n.clear),100)}}class w{constructor(e){this.win=e,this.cmpWindow=r.a,this.eventListenerManager=new a.a,this.callId=Object(d.rand)(16,!1),this.logger=new l.a("GDPR - CrossDomainIframeCmpHandler"),this.cmpWindow=this.findCmpWindow()}isIntegrated(){const e=Object(c.isInCrossDomainIframe)(document.body)&&this.cmpWindow.nonEmpty();return e&&this.logger.info("Iframe cross-domain (non-SafeFrame) CMP integration detected"),e}onIntegrationSuccess(e){this.cmpWindow.match({some:t=>{this.eventListenerManager.add("message",this.win,t=>this.messageHandler(t,e)),t.postMessage({__cmpCall:{command:"getConsentData",parameter:null,callId:this.callId}},"*")},none:()=>{this.logger.warn("Could not get CMP locator iframe from parent window(s).")}})}ping(){return v(e=>{this.cmpWindow.match({some:t=>{this.eventListenerManager.add("message",this.win,t=>this.messageHandler(t,e)),t.postMessage({__cmpCall:{command:"ping",parameter:null,callId:this.callId}},"*")},none:()=>{this.logger.warn("Could not get CMP locator iframe from parent window(s).")}})})}findCmpWindow(){return o.a.tryCatch(()=>{const e=Object(c.findParentWindows)(this.win.document.body,!1);return h.find(e,e=>!!(e=>e.frames[A.CMP_IFRAME_NAME])(e))}).tapLeft(e=>this.logger.debug("CrossDomainIframeCmpHandler.findCmpWindow",e)).toOption()}messageHandler(e,t){o.a.tryCatch(()=>{var t,i;return Object(m.isString)(e.data)?null===(t=JSON.parse(e.data))||void 0===t?void 0:t.__cmpReturn:null===(i=e.data)||void 0===i?void 0:i.__cmpReturn}).orElse(t=>(this.logger.warn("Message parsing failed",e.data),Object(o.b)(t))).toOption().forEach(e=>{e.callId===this.callId&&(t(e.returnValue,e.success),this.eventListenerManager.remove("message"))})}}class E{constructor(){this.logger=new l.a("GDPR - SafeFrameCmpHandler"),this.win=Object(n.getIABSafeFrameWindow)()}isIntegrated(){const e=Object(n.isIABSafeFrame)()&&Object(m.isFunction)(this.win.$sf.ext.cmp);return e&&this.logger.info("SafeFrame CMP integration detected"),e}onIntegrationSuccess(e){b.d(t=>{"getConsentData"===t.cmpCommand&&e(t.VendorConsentData,t.success)}),this.win.$sf.ext.cmp("getConsentData",null)}ping(){return v(e=>{b.d(t=>{"ping"===t.cmpCommand&&e(t.PingReturn,t.success)}),this.win.$sf.ext.cmp("ping",null)})}}},function(e,t,i){i.d(t,"d",(function(){return b})),i.d(t,"a",(function(){return f})),i.d(t,"e",(function(){return w})),i.d(t,"b",(function(){return E})),i.d(t,"c",(function(){return O}));var n=i(1),s=i(8),r=i(2),a=i(19),o=i(36),d=i(22),c=i(12),l=i(44),h=i(0),u=i(25),p=i(28);const g=(e,t=d.a)=>Object(s.b)(e,Object(c.replaceStringsWithValue)(p.b.timestampMacroNames,t())),m=Object(n.reduce)(o.d,(e,t)=>Object.assign(Object.assign({},e),{[t.toLowerCase()]:t}),{}),b=Object(s.a)(Object(r.prop)("event"),Object(n.isMemberOf)(Object.keys(m))),f=n.cArray.map(({event:e,url:t})=>({event:m[e],trackingUrl:Object(l.i)(g(t))})),v=Object(n.reduce)(Object(s.b)(a.b,n.cArray.filter(Object(r.not)(Object(r.equals)(a.a.Progress)))),(e,t)=>Object.assign(Object.assign({},e),{[t.toLowerCase()]:t}),{}),A=/progress-(\d+)/i,y=e=>A.test(e),w=Object(s.a)(Object(r.prop)("event"),e=>y(e)||Object(n.isMemberOf)(Object.keys(v))(e)),E=Object(s.a)(Object(n.partition)(Object(s.a)(Object(r.prop)("event"),y)),u.a.bimap(Object(s.a)(n.cArray.map(({event:e,url:t})=>Object(s.b)(e,e=>e.match(A),h.b.fromNullable,h.d.map(([,e])=>parseInt(e,10)),h.d.filter(r.isNumber),h.d.map(e=>({offset:e,trackingUrl:g(t)})))),h.e),n.cArray.map(({url:e,event:t})=>({event:v[t],trackingUrl:g(e)})))),O=Object(s.a)(n.cArray.filter(e=>Object(n.isMemberOf)(a.b)(e.event)&&Object(r.not)(y)(e.event)),n.cArray.map(({event:e,url:t})=>({event:e,trackingUrl:g(t)})))},function(e,t,i){i.d(t,"a",(function(){return a}));var n=i(6),s=i(58),r=i(161);class a{constructor(e,t=0){this.isSizeResolved=!1,this.scoreValues={WIDTH:20,HEIGTH:20,LENGTH:20,HIGH_MIN_SLOT:-5,LOW_MIN_SLOT:500,EQUAL_MIN_SLOT:1e3},this.element=e,this.index=t;const i=n.getSize(e);this.width=i.width,this.height=i.height}resolveSize(){if(!this.isSizeResolved){let e=this.element.style.overflow;this.element.style.setProperty("overflow","hidden");const t=n.getSize(this.element);this.element.style.setProperty("overflow",e),this.width=t.width,this.height=t.width/s.a,this.isSizeResolved=!0}}getElement(){return this.element}getElementRect(){return this.elementRect||(this.elementRect=n.getBoundingClientRect(this.element)),this.elementRect}getWidth(){return this.width}getHeight(){return this.height}getScore(){return this.score}getIndex(){return this.index}computeScore(e){let t=r.c,i=0,s=e.minimum.get(),a=e.parentWindow.getWindow();this.width>e.minimumWidth.get()+t.WIDTH_MARGIN&&(i+=this.scoreValues.WIDTH),this.height>t.MIN_LONG_HEIGHT+t.HEIGHT_MARGIN&&(i+=this.scoreValues.HEIGTH),this.height>e.minimumTextLength.get()+t.LENGTH_MARGIN&&(i+=this.scoreValues.LENGTH),this.index>s+t.LENGTH_MARGIN?i+=this.scoreValues.EQUAL_MIN_SLOT:this.index>=0&&s?i+=this.scoreValues.HIGH_MIN_SLOT:i+=this.scoreValues.LOW_MIN_SLOT;let o=n.getBoundingClientRect(this.getElement()),d=a.document.body||a.document.documentElement;i-=(o.top+(a.pageYOffset||d.scrollTop))/20,this.score=i}}},function(e,t,i){i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return h}));var n=i(0),s=i(1),r=i(9),a=i(105),o=i(82);const d=new r.a("SameAd"),c={playedMediaFileUIDs:[]};function l(e,t){c.playedMediaFileUIDs=c.playedMediaFileUIDs.concat({tagManager:e,uid:p(t)})}function h(e,t){return Object(a.a)(e,t).match({some:u,none:()=>(d.warn("Could not find a matching TagManagerResources for this TagManager",e),!1)})}function u({tagIsCampaignTag:e,vastPlayer:t,tagManager:i}){const r=Object(s.map)(Object(s.filter)(c.playedMediaFileUIDs,(a=i,e=>e.tagManager!==a&&a.pageId===e.tagManager.pageId)),e=>e.uid);var a;return t.flatMap(e=>{var t;return n.b.fromNullable(null===(t=e.getLinearAd())||void 0===t?void 0:t.mediaFiles)}).match({some:t=>!e&&Object(s.some)(t,e=>function(e,t){return Object(s.some)(t,t=>t===p(e))}(e,r)),none:()=>(d.debug("No player, or if any, no elected media file was found for this TagManager",i),!1)})}function p(e){var t;return function(e){var t,i;return null!==(i=null===(t=e.match(o.b))||void 0===t?void 0:t[1])&&void 0!==i?i:e}(e.url)+(null!==(t=e.adParameters)&&void 0!==t?t:"")}},function(e,t){e.exports="<script type='text/javascript'> var source; window.addEventListener('message', function(event) { if (event.data && event.data.event === 'reportingObserverSource') { source = event.source; } }, true); if (\"ReportingObserver\" in window) { try { const observer = new ReportingObserver(function (reports) { reports.forEach(function (report) { if (source) { source.postMessage({ event: 'heavyAdIntervention', report: JSON.stringify(report) }, '*'); } }) }, {buffered: true}); observer.observe(); } catch (e) { } } <\/script> "},function(e,t,i){i.d(t,"a",(function(){return s}));var n=i(1);const s=(e,t)=>t&&Object(n.includes)([42,6],e)},function(e,t,i){i.d(t,"a",(function(){return n}));const n=e=>e},function(e,t,i){i.d(t,"a",(function(){return d}));var n=i(3),s=i(0),r=i(48);const a=window.teads||{},o=a.router=a.router||{};o.V2_PATH=o.V2_PATH||void 0,o.V3_PATH=o.V3_PATH||void 0;const d=new r.c("https://s8t.teads.tv/logs/format/router-http-source",20,"822",s.a,{getSamplingThreshold:r.d,sendLog:r.e,getFullContext:n.getFullContext,isHeaderBiddingTag:()=>!1})},function(e,t,i){i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return p}));var n=i(76),s=i(1),r=i(6),a=i(9),o=i(10),d=i(28),c=i(5);const l=new a.a("helper.WigoIframe");let h;function u(){return c.a.tryCatch(()=>Object(o.findTopWindow)(window.document.body)).orElse(e=>(l.warn("Cannot get top window",e),Object(c.e)(window))).forEach(e=>{h=Object(o.createIframe)("wigo-helper"),h.id="wigoiframe",h.src=d.b.wigoIframeUrl,h.style.setProperty("display","none","important"),e.document.body.appendChild(h)}),h}function p(){const e=n.b.getInstances();e.sort((e,t)=>r.getBoundingClientRect(e.elementToFollow).top-r.getBoundingClientRect(t.elementToFollow).top);let t=e.length;s.forEach(e,e=>{e.moveButton(t),t--})}},function(e,t,i){i.d(t,"a",(function(){return o}));var n=i(46),s=i(18),r=i(2),a=i(3);class o extends s.a{constructor(e=o.DEFAULT){super("Format"),this.value=e,this.checkValue()}checkValue(){if(!Object(r.isString)(this.value)||!o.VALUES[this.value.toUpperCase()]||Object(a.isAmp)()&&!this.isInRead())throw new n.a(n.a.OPTION_FORMAT_INVALID)}get(){return this.value}isInRead(){return this.value===o.VALUES.INREAD}isInBoard(){return this.value===o.VALUES.INBOARD}isInterstitial(){return this.value===o.VALUES.INTERSTITIAL}isRewarded(){return this.value===o.VALUES.REWARDED}}o.VALUES={INREAD:"inread",INBOARD:"inboard",INTERSTITIAL:"interstitial",REWARDED:"rewarded"},o.DEFAULT=null},function(e,t,i){i.d(t,"a",(function(){return n}));const n="Teadstv"},function(e,t,i){i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a}));var n=i(0),s=i(2);function r({gdprIab:e}){return n.b.fromNullable(e).filter(e=>Object(s.isObject)(e)&&Object(s.hasOwnProperties)(e,["status","consent"])&&Object(s.isNumber)(e.status)&&Object(s.isString)(e.consent)).map(({status:e,consent:t,reason:i,apiVersion:s,cmpId:r})=>({status:e,consent:t,reason:n.b.fromNullable(i),apiVersion:n.b.fromNullable(s),cmpId:n.b.fromNullable(r)}))}const a=({reason:e,status:t,consent:i,apiVersion:n,cmpId:s})=>({reason:e,status:t,consent:i,apiVersion:n.getOrNull(),cmpId:s.getOrNull()})},function(e,t,i){i.d(t,"a",(function(){return S}));var n,s=i(3),r=i(0),a=i(9),o=i(15),d=i(13),c=i(81),l=i(70);!function(e){e[e.UNLOADED=-1]="UNLOADED",e[e.READY=0]="READY",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED"}(n||(n={}));var h=n,u=i(72),p=i(1),g=i(10);class m extends u.a{setUpCreativeContainers(e,t){if(window.teads.api=this.config.api,this.mainContainer=document.createElement("div"),this.mainContainer.style.setProperty("position","relative"),e.appendChild(this.mainContainer),this.creativeContainer=document.createElement("div"),this.creativeContainer.id="vpaid-"+this.id,this.mainContainer.appendChild(this.creativeContainer),this.creativeContainer.innerHTML=this.getCreativeTemplate(t,this.callbackName,this.backgroundColor),this.vpaidContainer=r.b.fromNullable(Object(g.getDocument)(this.creativeContainer)).flatMap(e=>r.b.fromNullable(e.getElementById("vpaidjs-container"))).getOrNull(),this.videoContainer=r.b.fromNullable(Object(g.getDocument)(this.creativeContainer)).flatMap(e=>r.b.fromNullable(e.getElementById("video-container"))).getOrNull(),!Object(p.includes)([u.a.CANVAS,u.a.VIDEO],t)){const e=document.createElement("script");r.b.fromNullable(Object(g.getWindow)(this.container)).forEach(t=>{e.onload=()=>t[this.callbackName](!0),e.onerror=()=>t[this.callbackName](!1)}),e.src=t,this.creativeContainer.appendChild(e)}}getCreativeTemplate(e,t,i){return`\n      <div id="video-container" style="position:absolute;top:0px;left:0px;z-index:1;background-color:${i}"></div>\n      <div id="vpaidjs-container" style="position:absolute;top:0px;left:0px;z-index:2"></div>\n    `}}var b=i(114),f=i(75),v=i(6),A=i(45),y=i(4),w=i(106),E=i(52),O=i(2),C=i(101);class I extends w.a{constructor(e,t){super(),this.config=t,this.lastAdRemainingTime=-1,r.b.fromNullable(e.getVPAID()).forEach(e=>this.setVPAID(e)),this.type=e.getType(),this.container=e,this.container.registerVPAIDEventHandler(e=>{switch(e.type){case y.a.AdRemainingTimeChange:case y.a.AdDurationChange:return}this.handleVpaidEvent(e)})}initAd(e,t,i,n,s,r){this.container.resize(e,t),this.type===c.a.JS&&"string"==typeof s&&(s={AdParameters:s}),super.initAd(e,t,i,n,s,this.type===c.a.JS?this.getEnvironmentVars(r):null)}setAdVolume(e){return this.environmentVars.forEach(t=>{r.b.fromNullable(t.videoSlot).forEach(t=>{let i=e=>{e.type===A.volumechange&&this.dispatchEvent(y.a.AdVolumeChange),v.removeEventListener(A.volumechange,t,i)};v.addEventListener(A.volumechange,t,i),t.volume=e,t.muted=!e})}),super.setAdVolume(e),this.dispatchEvent(y.a.AdVolumeChange),e}getAdVolume(){return this.environmentVars.flatMap(e=>r.b.fromNullable(e.videoSlot)).filter(e=>!Object(O.isUndefined)(e.volume)).match({some:e=>e.muted?0:e.volume,none:()=>super.getAdVolume()})}resizeAd(e,t,i){var n,s;const r=(null===(s=null===(n=this.config)||void 0===n?void 0:n.api)||void 0===s?void 0:s.isVideoBanner())?C.a(e):t;this.isResizing=!0,this.container.resize(e,t),super.resizeAd(e,r,i)}getEnvironmentVars(e){return this.container.getEnvironmentVars(e)}handleVpaidEvent(e){switch(e.type){case y.a.AdSizeChange:this.isResizing||this.container.resize(this.getAdWidth(),this.getAdHeight()),this.isResizing=!1;break;case y.a.AdStarted:this.startTimer();break;case y.a.AdStopped:this.stopTimer()}super.handleVpaidEvent(e),this.status===d.a.STOPPED&&(this.status=d.a.REMOVING,setTimeout(()=>{this.status=d.a.REMOVED,this.container.destroy()},E.a))}startTimer(){this.timerId||(this.timerId=setInterval(()=>{let e=this.getAdRemainingTime();this.status<d.a.COMPLETE&&e>=0&&this.lastAdRemainingTime!==e&&(this.lastAdRemainingTime=e,this.dispatchEvent(y.a.AdRemainingTimeChange),this.dispatchEvent(y.a.AdDurationChange))},250))}stopTimer(){this.timerId&&clearInterval(this.timerId)}}class S{constructor(e,t){this.container=e,this.config=t,this.status=h.READY,this.wigo=r.b.empty()}load(e,t,i){if(!(this.status>h.READY)){var n,s;e=Object(o.s)(e),s=this.findContainerConstructor(e),this.creativeType=c.a.JS,this.container.innerHTML="",this.status=h.LOADING;n=new s(this.container,this.config),this.config.background&&n.setBackground(this.config.background),n.loadVpaid(e,e=>{this.status=d.a.LOADED,this.wrapperClass||(this.wrapperClass=I);const s=new this.wrapperClass(n,this.config);try{t(s)}catch(e){let t=l.e;t.message+=e,i(t)}let r=Object(f.c)(e)?"2.0":"1.0";S.logger.info("handshakeVersion - Creative vpaid version "+r),this.wigo.forEach(e=>e.valid(3,1,r,"string"))},i)}}findContainerConstructor(e){return Object(s.isAmp)()||Object(s.isIABSafeFrame)()?m:e===u.a.VIDEO||e===u.a.CANVAS?u.a:b.a}setWigo(e){this.wigo=r.b.fromNullable(e)}}S.logger=new a.a("vpaid.VPAIDLoader")},function(e,t,i){i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return o}));var n=i(2),s=i(18),r=i(28);class a extends s.a{constructor(e,t,i=null,n=null){super("Credits");let s=i&&i.isInBoard();this.value=Object.assign(Object.assign({},s?a.DEFAULT_INBOARD:a.DEFAULT_INREAD),e),t.isEnabled()&&(this.value.display=!1),this.checkValue(),this.value.display=o(this.value.display)}checkValue(){Object(n.containsKeys)(a.VALUES,this.value)||(this.value=a.DEFAULT_INREAD)}isEnabled(){return this.value.display}getText(){return this.value.text}getLink(){return this.value.link}}function o(e){return!!r.b.isQA&&e}a.VALUES={DISPLAY:"display",TEXT:"text",LINK:"link"},a.DEFAULT_INREAD={display:!0,text:"Ads by [Teads]",link:"https://hp.teads.com/?utm_source=inread&utm_medium=credits&utm_campaign=invented%20by%20teads"},a.DEFAULT_INBOARD={display:!0,text:"Ads by [Teads]",link:"https://hp.teads.com/?utm_source=inboard&utm_medium=credits&utm_campaign=invented%20by%20teads"}},function(e,t){e.exports='<div class="teads-wigo-btn"><div style="position: absolute; left:0;top:0;padding: 0 4%; border: 1px solid white; color: white; font-size: 10px; text-align: center; font-family: Arial; line-height:16px;"></div><div style="border: 6px solid #f3f3f3; border-top: 6px solid #3498db; border-radius: 50%; position: absolute; left: 60%; width: 32%; height: 32%; -webkit-animation: wigospin 2s linear infinite; animation: wigospin 2s linear infinite"></div> <style type="text/css"> .teads-wigo-btn { position: fixed; bottom: 10px; right: 10px; z-index: 2147483647; width: 75px; height: 75px; cursor: pointer; background-image: url(\'https://s8t.teads.tv/media/format/v3/assets/default/img/wigo.png?v2\'); transition: right ease 0.2s; } @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) { /* Retina */ .teads-wigo-btn { background-size: 75px 75px; background-image: url(\'https://s8t.teads.tv/media/format/v3/assets/default/img/wigo-2x.png\'); } } @-webkit-keyframes wigospin { 0% { -webkit-transform: rotate(0deg);} 100% { -webkit-transform: rotate(360deg);} } @keyframes wigospin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } } </style> </div> '},function(e,t,i){i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return r}));var n=i(0);const s="https://privacy-policy.teads.tv?utm_source=inread&utm_medium=icon&utm_campaign=adchoices";function r(e){return n.b.fromNullable(e).flatMap(e=>e.adChoicesIconClickThrough).getOrValue(s)}},function(e,t,i){i.d(t,"a",(function(){return a}));var n=i(9),s=i(1),r=i(59);function a(e){let t;return e&&e.extensions&&e.extensions.length>0&&s.forEach(e.extensions,e=>{e.type===r.a.TEADS_CONTEXT&&(t=function(e){try{return JSON.parse(e)}catch(e){new n.a("ITeadsContextExtension").error(r.a.TEADS_CONTEXT+" extension throw an exception",e)}}(e.content))}),t}},function(e,t,i){i.d(t,"a",(function(){return m}));var n=i(6),s=i(1),r=i(10),a=i(0);const o=[{name:"DoubleVerify",domain:/cdn\.doubleverify\.com/,appendRule:(e,{playerContainer:t})=>{t.parentElement.appendChild(e)}},{name:"ComScore",domain:/sb\.voicefive\.com/,appendRule:(e,{playerContainer:t})=>{t.insertBefore(e,t.firstChild)}},{name:"IAS",domain:/pixel\.adsafeprotected\.com/,appendRule:(e,{parentContainer:t})=>{t.insertBefore(e,t.firstChild)}},{name:"MOAT",domain:/\.moatads\.com/,appendRule:(e,{playerContainer:t})=>{t.insertBefore(e,t.firstChild)}},{name:"TeadsQA",domain:/(amp\.localhost|localhost):18100\/track\?action=prefetch/,appendRule:(e,{playerContainer:t})=>{t.insertBefore(e,t.firstChild)}}];let d;const c=()=>{if(void 0!==d)return d;if("undefined"==typeof DOMParser||"function"!=typeof DOMParser)d=!1;else{const e=new DOMParser;try{const t=e.parseFromString("<div>Hello</div>","text/html");d="DIV"===t.body.firstElementChild.nodeName&&"Hello"===t.body.firstElementChild.innerHTML}catch(e){d=!1}}return d},l=(e,{onEnterElement:t})=>{if(!0!==t(e))for(let i=e.firstElementChild;i;i=i.nextElementSibling)l(i,{onEnterElement:t})},h=e=>{const t=e.getAttribute("src");return!("SCRIPT"!==e.nodeName||!t||!s.some(o,e=>e.domain.test(t)))},u=e=>{const t=new DOMParser,i=g(t)(e),n=s.map(((e,t)=>{const i=[];return l(e,{onEnterElement:e=>{if(t(e))return i.push(e),!0}}),s.forEach(i,e=>{e.parentElement&&e.parentElement.removeChild(e)}),i})(i,h),e=>{const t=e.getAttribute("src");return{provider:(e=>s.find(o,t=>t.domain.test(e)))(t).name,source:t,script:e}});return{creative:i.innerHTML,viewabilityTags:n}},p=e=>{const t=new DOMParser,i=g(t)(e);s.forEach(((e,t)=>{const i=[];return l(e,{onEnterElement:e=>{if(t(e))return i.push(e),!0}}),i})(i,h),e=>{(new Image).src=e.getAttribute("src")})},g=e=>t=>e.parseFromString((e=>`<div>${e}</div>`)(t),"text/html").body.firstElementChild;class m{constructor(e,t,i,n=a.a){this.sumologicLogger=e,this.connectionType=t,this.win=i,this.containers=n,this.thresholdReached=!1,this.thresholdReachedCallbacks=[],c()}appendViewabilityTags(e,t){s.forEach(e,e=>{this.containers.match({some:t=>{var i;(i=e.provider,s.find(o,e=>e.name===i)).appendRule((e=>{const t=document.createElement("script");for(let i=0;i<e.attributes.length;i++){const{name:n,value:s}=e.attributes[i];t.setAttribute(n,s)}return t})(e.script),t)},none:()=>this.sumologicLogger.error("ViewabilityTags.appendViewabilityTags called with no containers")})})}getCreativeTag(e,t=a.a){if(c()&&this.connectionType.isDisplay()){p(e);const{creative:i,viewabilityTags:n}=u(e);return this.onceThresholdReached(()=>this.appendViewabilityTags(n,t)),i}return e}onceThresholdReached(e){this.thresholdReached?e():this.thresholdReachedCallbacks.push(e)}onPercentageVisibilityChange(e){this.thresholdReached||.25<=e&&this.resolveThresholdReach()}onScroll(){this.thresholdReached||this.containers.match({some:({playerContainer:e})=>{const t=Object(r.getPercentageInView)({element:e,elementAncestors:Object(r.findParentElements)(e),elementClientRect:Object(n.getBoundingClientRect)(e),mainWindow:this.win,elementHeight:Object(n.getSize)(e).height,allowNegative:!0});this.onPercentageVisibilityChange(t)},none:()=>this.sumologicLogger.error("ViewabilityTags.onScroll called with no containers")})}resolveThresholdReach(){!0!==this.thresholdReached&&(this.thresholdReached=!0,s.forEach(this.thresholdReachedCallbacks,e=>e()),this.thresholdReachedCallbacks=[])}}},function(e,t,i){},function(e,t,i){var n=i(162);e.exports="string"==typeof n?n:n.toString()},function(e,t,i){var n=i(163);e.exports="string"==typeof n?n:n.toString()},function(e,t,i){i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return s}));class n{constructor(){this.error=[],this.click=[],this.pause=[],this.resume=[],this.skip=[],this.creativeView=[],this.start=[],this.firstQuartile=[],this.midpoint=[],this.thirdQuartile=[],this.complete=[],this.impression=[],this.close=[],this.progress=[],this.mute=[],this.unmute=[],this.rewind=[],this.fullscreen=[],this.exitFullscreen=[],this.expand=[],this.collapse=[],this.acceptInvitationLinear=[],this.acceptInvitation=[],this.closeLinear=[],this.noAd=[],this.noLinearAd=[],this.customClicks=[],this.billable=[],this.otherAdInteraction=[],this.clickIcon=[]}}class s{}s.error="error",s.click="click",s.pause="pause",s.resume="resume",s.skip="skip",s.creativeView="creativeView",s.start="start",s.firstQuartile="firstQuartile",s.midpoint="midpoint",s.thirdQuartile="thirdQuartile",s.complete="complete",s.impression="impression",s.close="close",s.progress="progress",s.mute="mute",s.unmute="unmute",s.rewind="rewind",s.fullscreen="fullscreen",s.exitFullscreen="exitFullscreen",s.expand="expand",s.collapse="collapse",s.acceptInvitationLinear="acceptInvitationLinear",s.acceptInvitation="acceptInvitation",s.closeLinear="closeLinear",s.noAd="noAd",s.noLinearAd="noLinearAd",s.customClicks="customClicks",s.billable="billable",s.otherAdInteraction="otherAdInteraction",s.clickIcon="clickIcon"},function(e,t,i){i.d(t,"a",(function(){return y}));var n=i(8),s=i(10),r=i(58),a=i(51),o=i(83),d=i(3),c=i(2),l=i(9),h=i(82),u=i(0),p=i(1),g=i(6),m=i(32),b=i(65),f=i(4);const v=Object(d.isDesktop)()?.08:.15,A=(e,t,i,n,s,r)=>{const a=e.orElse(()=>((e,t,i)=>{if(!t||e<=t)return u.a;const n=t/e;return Object(u.c)({width:n*i,height:t})})(i,n.height,s)).orElse(()=>((e,t,i,n,s)=>u.b.fromNullable(n).filter(t=>t.width!==i||t.height!==e).map(n=>({width:i,height:s?t.height:e})))(i,n,s,t,r)).getOrValue(t);return Object.assign(Object.assign({},a),{width:Math.round(a.width),height:Math.round(a.height)})};class y{constructor(e){if(this.abstractFormat=e,this.isLandscape=!1,this.logger=new l.a("Format.Responsive"),this.orientationChangeListeners=[],this.manualMaxWidth=!1,this.vpaidAd=e.getVpaidAd(),this.mainContainer=e.parentContainer,this.formatContainer=e.placement.getInnerContainer(),this.mediafile=e.player.getMediafile(),this.win=e.placement.placementConfig.parentWindow.getWindow(),this.linearAd=e.linearAd,this.portfolioItemId=e.formatConfig.portfolioItemId,this.resizeCallback=()=>{this.resize(),this.setResponsiveCssClass(this.mainContainer)},this.vpaidAd.subscribe(()=>{this.unsetResponsive()},f.a.AdError),this.vpaidAd.subscribe(()=>{this.unsetResponsive()},f.a.AdStopped),Object(d.isMobile)()||Object(d.isTablet)()){const e=e=>{const t=g.getWindowSize(this.win);this.isLandscape=t.width>t.height};e(),this.addOrientationChangeListener(e),this.setResponsiveCssClass(this.mainContainer),this.addOrientationChangeListener(()=>{this.isNativeFullscreen()&&this.resize()});const t=e=>{this.win.setTimeout(()=>{this.onOrientationChange(e)},200)};g.addEventListener("orientationchange",this.win,t),this.vpaidAd.subscribe(()=>{g.removeEventListener("orientationchange",this.win,t)},f.a.AdStopped)}}static findOptimalCreativeSizeBasedOnWindowSurface(e,t){const i=t.width*t.height*v,n=e.map(b.a.getRatio).getOrValue(r.a),s=Math.sqrt(i/n);return{width:n*s,height:s}}updateAndResizeWithAdVideoMetadata(e){e.width&&e.height&&(this.mediafile.width!==e.width||this.mediafile.height!==e.height)&&(this.logger.debug("video size is different from VAST mediafile, force resize to good dimensions"),this.mediafile.width=e.width,this.mediafile.height=e.height,this.resize(!0))}resizeOnStart(){this.vpaidAd.subscribe(e=>{this.logger.debug("Receive metadata from video",e),this.updateAndResizeWithAdVideoMetadata(e)},m.a.AdVideoMetadata),this.vpaidAd.subscribe(()=>this.resize(!0),f.a.AdVideoStart),this.vpaidAd.subscribe(()=>this.resize(!0),f.a.AdStarted)}setResponsive(e=this.resizeCallback){if(!this.iframeForSlotWidth&&(this.iframeForSlotWidth=document.createElement("iframe"),this.iframeForSlotWidth.className="teads-resize",this.iframeForSlotWidth.setAttribute("title","teads-resize"),this.iframeForSlotWidth.style.setProperty("height","0","important"),this.iframeForSlotWidth.style.setProperty("min-height","0","important"),this.iframeForSlotWidth.style.setProperty("width","100%","important"),this.iframeForSlotWidth.style.setProperty("border","none","important"),this.iframeForSlotWidth.style.setProperty("margin","0","important"),this.iframeForSlotWidth.style.setProperty("padding","0","important"),this.iframeForSlotWidth.style.setProperty("display","block","important"),Object(o.a)(this.portfolioItemId))){this.logger.debug("Third party display detected, adding iframe for height detection"),this.iframeForCreativeHeight=Object(s.createIframe)("teads-resize"),this.iframeForCreativeHeight.className="teads-resize-for-height",this.iframeForCreativeHeight.style.setProperty("position","absolute","important"),this.iframeForCreativeHeight.style.setProperty("top","0","important"),this.iframeForCreativeHeight.style.setProperty("bottom","0","important"),this.iframeForCreativeHeight.style.setProperty("left","0","important"),this.iframeForCreativeHeight.style.setProperty("right","0","important"),this.iframeForCreativeHeight.style.setProperty("background-color","transparent","important"),this.iframeForCreativeHeight.style.setProperty("z-index","-1","important"),this.iframeForCreativeHeight.style.setProperty("opacity","0","important"),this.iframeForCreativeHeight.style.setProperty("height","100%","important"),this.iframeForCreativeHeight.style.setProperty("width","100%","important"),this.iframeForCreativeHeight.style.setProperty("border","none","important"),this.iframeForCreativeHeight.style.setProperty("margin","0","important"),this.iframeForCreativeHeight.style.setProperty("padding","0","important"),this.iframeForCreativeHeight.style.setProperty("display","block","important");this.abstractFormat.placement.getPlayerContainer().appendChild(this.iframeForCreativeHeight),g.addEventListener("resize",this.iframeForCreativeHeight.contentWindow,()=>e())}this.abstractFormat.placement.getElectedSlot().getElement().appendChild(this.iframeForSlotWidth),g.addEventListener("resize",this.iframeForSlotWidth.contentWindow,()=>e()),e()}unsetResponsive(){return!(!this.iframeForSlotWidth||!this.iframeForSlotWidth.parentNode)&&(g.removeEventListener("resize",this.iframeForSlotWidth.contentWindow,this.resizeCallback),this.iframeForSlotWidth.parentNode.removeChild(this.iframeForSlotWidth),!0)}addOrientationChangeListener(e){p.indexOf(this.orientationChangeListeners,e)<0&&this.orientationChangeListeners.push(e)}getOptimalDimension(e=this.mainContainer){const t=!!this.abstractFormat.vpaidApi.getStudioData(),i={width:this.vpaidAd.getAdWidth(),height:this.vpaidAd.getAdHeight()},s=g.getWindowSize(this.win),r=this.getContainerWidth(e),a=p.includes([25],this.portfolioItemId),o=t||a,d=b.a.getOptimalHeight(this.mediafile,r,o),l=u.b.fromNullable(this.abstractFormat.formatConfig).flatMap(Object(n.a)(Object(c.prop)("creativeSize"),u.b.fromNullable));return A(l,i,d,s,r,this.isFullscreen())}getOptimalDimensionBasedOnSurface(){const e=g.getWindowSize(this.win),t=y.findOptimalCreativeSizeBasedOnWindowSurface(u.b.fromNullable(this.mediafile),e),i={width:this.vpaidAd.getAdWidth(),height:this.vpaidAd.getAdHeight()};return i.width===t.width&&i.height===t.height||(i.width=t.width,i.height=this.isFullscreen()?e.height:t.height),{width:Math.round(i.width),height:Math.round(i.height)}}resize(e=!1,t=this.mainContainer){const i=this.vpaidAd.getAdWidth(),n=this.vpaidAd.getAdHeight();this.setMaxWidth(t);const s=this.getOptimalDimension(t);if(p.includes([37,39],this.portfolioItemId)&&this.handleMaxHeight(t,this.formatContainer,s),this.isNativeFullscreen()||this.isFullscreen()&&e){const t=g.getWindowSize(this.win);n===t.height&&i===t.width||(this.logger.debug(`fullscreen resize from ${i}x${n} to ${t.width}x${t.height}  (forced: ${e})`),this.vpaidAd.resizeAd(t.width,t.height,"fullscreen"))}else(e||n!==s.height||i!==s.width)&&(this.repositionFormatContainer(s,t),this.logger.debug(`resize from ${i}x${n} to ${s.width}x${s.height} (forced: ${e})`),this.vpaidAd.resizeAd(s.width,s.height,this.isFullscreen()?"fullscreen":"normal"))}repositionFormatContainer(e,t=this.mainContainer){const i=this.getContainerWidth(t),n=e.width>=i?0:(i-e.width)/2;this.formatContainer.style.marginLeft=n+"px",this.formatContainer.style.marginRight=n+"px"}isFullscreen(){return Object(s.hasClass)(this.vpaidAd.getMainComponentsContainer(),"fullscreen")}isNativeFullscreen(){return Object(s.isFullscreen)(this.win.document)}handleMaxHeight(e,t,i){const n=g.getBoundingClientRect(t).height;if(this.isFullscreen())e.style.setProperty("max-height","none");else{const t=n>=i.width?i.height:n;this.logger.debug(`Celtra miniscroller detected, setting max-height property on teads-inread to ${t}px`),e.style.setProperty("max-height",Math.round(t)+"px"),e.style.setProperty("clip-path","inset(0)")}}getContainerWidth(e=this.mainContainer){if(this.isFullscreen())return g.getWindowSize(this.win).width;{const t=this.win.getComputedStyle(e),i=t.getPropertyValue("width");if(Object(c.isSizeInPx)(i))return Math.round(parseFloat(i));{const i=parseFloat(t.getPropertyValue("padding-left"))||0,n=parseFloat(t.getPropertyValue("padding-right"))||0;return Math.round(g.getBoundingClientRect(e).width-(i+n))}}}onOrientationChange(e){p.forEach(this.orientationChangeListeners,t=>{t(e)})}setMaxWidth(e=this.mainContainer){var t;if(this.isFullscreen())e.style.setProperty("max-width","none");else if(!e.style.getPropertyValue("max-width")||this.manualMaxWidth){const i=g.getBoundingClientRect(e),n=g.getBoundingClientRect(null===(t=this.iframeForSlotWidth)||void 0===t?void 0:t.parentElement);e.style.setProperty("max-width",Math.round(n.width-Math.max(i.left-n.left,i.right-n.right))+"px"),this.manualMaxWidth=!0}}setResponsiveCssClass(e){const t=g.getBoundingClientRect(e).width;let i;Object(a.c)((n,r)=>{var a,o;Object(s.removeClass)(e,r.className),t<=r.size&&(a=i,o=r.size,!a||a.size>o)&&(i=r)})(h.f),i&&Object(s.addClass)(e,i.className)}}},function(e,t,i){e.exports="<!DOCTYPE html> <html> <head> "+i(122)+' </head> <body> <div id="main-container"> <style> '+i(171)+' </style> <div id="layout-video-component"> <div class="teads-ui-component-startscreen"></div> <div id="vpaid-container"></div> <div class="teads-ui-component-fullscreenbutton"> <div class="icon-collapse"></div> </div> <div class="teads-ui-component-earlyclickoverlay"></div> <div class="teads-ui-component-progressbar"> <div class="progress"></div> </div> <div class="teads-ui-component-soundbutton"></div> <div class="teads-ui-component-closebutton"> <div class="close-button icon-close hide"></div> </div> <div class="teads-ui-component-adchoices adchoices-icon"> <span>AdChoices</span> </div> <div class="teads-ui-component-clickbutton"></div> <div class="teads-ui-component-brandlogo"></div> <div class="teads-ui-component-clicktoplay gradient"> <div class="icon-watchmore"></div> </div> <div class="teads-ui-component-bannervideobottom"></div> <div class="teads-ui-component-endscreen"></div> </div> </div> </body> </html> '},function(e,t){!function(e,t,i,n){if(!("registerElement"in t)){var s,r,a,o,d,c,l,h="__registerElement"+(1e5*Math.random()>>0),u=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,p=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],g=[],m=[],b="",f=t.documentElement,v=g.indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},A=i.prototype,y=A.hasOwnProperty,w=A.isPrototypeOf,E=i.defineProperty,O=i.getOwnPropertyDescriptor,C=i.getOwnPropertyNames,I=i.getPrototypeOf,S=i.setPrototypeOf,T=!!i.__proto__,k=i.create||function e(t){return t?(e.prototype=t,new e):this},j=S||(T?function(e,t){return e.__proto__=t,e}:C&&O?function(){function e(e,t){for(var i,n=C(t),s=0,r=n.length;s<r;s++)i=n[s],y.call(e,i)||E(e,i,O(t,i))}return function(t,i){do{e(t,i)}while((i=I(i))&&!w.call(i,t));return t}}():function(e,t){for(var i in t)e[i]=t[i];return e}),P=e.MutationObserver||e.WebKitMutationObserver,L=(e.HTMLElement||e.Element||e.Node).prototype,x=function(e){return w.call(L,e)},V=L.cloneNode,N=L.setAttribute,D=(L.removeAttribute,t.createElement),_=P&&{attributes:!0,characterData:!0,attributeOldValue:!0},R=P||function(e){U=!1,f.removeEventListener("DOMAttrModified",R)},M=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,10)},F=!1,U=!0,B=!0,W=!0;S||T?(c=function(e,t){w.call(t,e)||Q(e,t)},l=Q):l=c=function(e,t){e[h]||(e[h]=i(!0),Q(e,t))},P||(f.addEventListener("DOMAttrModified",R),f.setAttribute(h,1),f.removeAttribute(h),U&&(r=function(e){var t,i,n;if(this===e.target){for(n in t=this[h],this[h]=i=o(this),i){if(!(n in t))return a(0,this,n,t[n],i[n],"ADDITION");if(i[n]!==t[n])return a(1,this,n,t[n],i[n],"MODIFICATION")}for(n in t)if(!(n in i))return a(2,this,n,t[n],i[n],"REMOVAL")}},a=function(e,t,i,n,s,r){var a={attrChange:e,currentTarget:t,attrName:i,prevValue:n,newValue:s};a[r]=e,K(a)},o=function(e){for(var t,i,n={},s=e.attributes,r=0,a=s.length;r<a;r++)"setAttribute"!==(i=(t=s[r]).name)&&(n[i]=t.value);return n})),t.registerElement=function(e,i){if(n=e.toUpperCase(),F||(F=!0,P?(d=function(e,t){function i(e,t){for(var i=0,n=e.length;i<n;t(e[i++]));}return new P((function(n){for(var s,r,a,o=0,d=n.length;o<d;o++)"childList"===(s=n[o]).type?(i(s.addedNodes,e),i(s.removedNodes,t)):(r=s.target,W&&r.attributeChangedCallback&&"style"!==s.attributeName&&(a=r.getAttribute(s.attributeName))!==s.oldValue&&r.attributeChangedCallback(s.attributeName,s.oldValue,a))}))}(z("attached"),z("detached"))).observe(t,{childList:!0,subtree:!0}):(s=[],M((function e(){for(;s.length;)s.shift().call(null,s.shift());M(e)})),t.addEventListener("DOMNodeInserted",$("attached")),t.addEventListener("DOMNodeRemoved",$("detached"))),t.addEventListener("DOMContentLoaded",Y),t.addEventListener("readystatechange",Y),t.createElement=function(e,i){var n=D.apply(t,arguments),s=""+e,r=v.call(g,(i?"=":"<")+(i||s).toUpperCase()),a=-1<r;return i&&(n.setAttribute("is",i=i.toLowerCase()),a&&(a=q(s.toUpperCase(),i))),W=!t.createElement.innerHTMLHelper,a&&l(n,m[r]),n},L.cloneNode=function(e){var t=V.call(this,!!e),i=G(t);return-1<i&&l(t,m[i]),e&&function(e){for(var t,i=0,n=e.length;i<n;i++)t=e[i],l(t,m[G(t)])}(t.querySelectorAll(b)),t}),-2<v.call(g,"="+n)+v.call(g,"<"+n)&&J(e),!u.test(n)||-1<v.call(p,n))throw new Error("The type "+e+" is invalid");var n,r,a=function(){return c?t.createElement(h,n):t.createElement(h)},o=i||A,c=y.call(o,"extends"),h=c?i.extends.toUpperCase():n;return c&&-1<v.call(g,"<"+h)&&J(h),r=g.push((c?"=":"<")+n)-1,b=b.concat(b.length?",":"",c?h+'[is="'+e.toLowerCase()+'"]':h),a.prototype=m[r]=y.call(o,"prototype")?o.prototype:k(L),H(t.querySelectorAll(b),"attached"),a}}function H(e,t){for(var i=0,n=e.length;i<n;i++)Z(e[i],t)}function z(e){return function(t){x(t)&&(Z(t,e),H(t.querySelectorAll(b),e))}}function G(e){var t=e.getAttribute("is"),i=e.nodeName.toUpperCase(),n=v.call(g,t?"="+t.toUpperCase():"<"+i);return t&&-1<n&&!q(i,t)?-1:n}function q(e,t){return-1<b.indexOf(e+'[is="'+t+'"]')}function K(e){var t=e.currentTarget,i=e.attrChange,n=e.attrName,s=e.target;!W||s&&s!==t||!t.attributeChangedCallback||"style"===n||e.prevValue===e.newValue||t.attributeChangedCallback(n,i===e.ADDITION?null:e.prevValue,i===e.REMOVAL?null:e.newValue)}function $(e){var t=z(e);return function(e){s.push(t,e.target)}}function Y(e){B&&(B=!1,e.currentTarget.removeEventListener("DOMContentLoaded",Y)),H((e.target||t).querySelectorAll(b),"detached"===e.detail?"detached":"attached")}function X(e,t){N.call(this,e,t),r.call(this,{target:this})}function Q(e,t){j(e,t),d?d.observe(e,_):(U&&(e.setAttribute=X,e[h]=o(e),e.addEventListener("DOMSubtreeModified",r)),e.addEventListener("DOMAttrModified",K)),e.createdCallback&&W&&(e.created=!0,e.createdCallback(),e.created=!1)}function J(e){throw new Error("A "+e+" type is already registered")}function Z(e,t){var i,n=G(e);-1<n&&(c(e,m[n]),n=0,"attached"!==t||e.attached?"detached"!==t||e.detached||(e.attached=!1,e.detached=!0,n=1):(e.detached=!1,e.attached=!0,n=1),n&&(i=e[t+"Callback"])&&i.call(e))}}(window,document,Object)},function(e,t,i){var n=i(164);e.exports="string"==typeof n?n:n.toString()},function(e,t,i){e.exports="/** This will include vpaid-ui assets */ "+i(138)+" "+i(137)+" .teads-expand { position: relative; } .teads-expand-closebutton { padding: 5px; text-align:center; color:white; cursor:pointer; position:absolute; z-index: 2147483646; top:5px; right:5px; width: 15px; height: 15px; padding: 0px; } .teads-expand-iframe { width: 100%; height: 100%; } .teads-expand-iframe iframe { border: 0px; width: 100%; height: 100%; background: #FFFFFF url({{assetsPath}}/default/img/loading.gif) no-repeat center center } .teads-expand-overlay { position: fixed; opacity: 0; background: #000000; border: 0; top: 0; left: 0; z-index: 2147483646; overflow: hidden; width: 100%; height: 100%; transition-property: opacity; -webkit-transition-property: opacity; -moz-transition-property: opacity; -o-transition-property: opacity; -ms-transition-property: opacity; transition-duration: {{transitionDuration}}ms; -webkit-transition-duration: {{transitionDuration}}ms; -moz-transition-duration: {{transitionDuration}}ms; -o-transition-duration: {{transitionDuration}}ms; -ms-transition-duration: {{transitionDuration}}ms; } .teads-expand-overlay.opened { opacity: 0.6 } .teads-expand-container.opened { opacity: 1 } .teads-expand-container { opacity: 0; position: fixed; background: #FFFFFF; border: 0; left: 0px; top: 0px; z-index: 2147483647; transition-property: opacity width height left top; -webkit-transition-property: opacity width height left top; -moz-transition-property: opacity width height left top; -o-transition-property: opacity width height left top; -ms-transition-property: opacity width height left top; transition-duration: {{transitionDuration}}ms; -webkit-transition-duration: {{transitionDuration}}ms; -moz-transition-duration: {{transitionDuration}}ms; -o-transition-duration: {{transitionDuration}}ms; -ms-transition-duration: {{transitionDuration}}ms; } body.noscroll { overflow:hidden; } "},function(e,t,i){var n=i(165);e.exports="string"==typeof n?n:n.toString()},function(e,t,i){var n=i(166);e.exports="string"==typeof n?n:n.toString()},function(e,t){e.exports='<div class="teads-expand"> <div class="teads-expand-label"></div> <div class="teads-expand-iframe"> <iframe src="{{iframeurl}}"></iframe> </div> <div class="teads-expand-closebutton"> <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 15 15" style="enable-background:new 0 0 15 15;" xml:space="preserve"> <g> <path style="fill:#000000;" d="M8.883,7.5l5.83-5.83c0.382-0.382,0.382-1.001,0-1.383c-0.382-0.382-1.002-0.382-1.383,0L7.5,6.117 l-5.83-5.83c-0.382-0.382-1.002-0.382-1.383,0c-0.382,0.382-0.382,1.001,0,1.383l5.83,5.83l-5.83,5.83 c-0.382,0.382-0.382,1.001,0,1.383C0.478,14.904,0.728,15,0.978,15c0.25,0,0.501-0.096,0.692-0.287l5.83-5.83l5.83,5.83 C13.521,14.904,13.771,15,14.022,15c0.25,0,0.501-0.096,0.692-0.287c0.382-0.382,0.382-1.001,0-1.383L8.883,7.5z"/> </g> </svg> </div> </div> '},function(e,t,i){var n=i(167);e.exports="string"==typeof n?n:n.toString()},function(e,t){e.exports='<div class="teads-countdown"> <div class="teads-countdown-background"></div> <div class="teads-countdown-circle" style="width:100px;height:100px"> <svg viewbox="0 0 100 100" shape-rendering="optimizeQuality"> <path class="teads-countdown-circle-background" fill="none" stroke-linecap="round" stroke-width="2" stroke="#CCC" stroke-dasharray="250" d="M50 10 a 40 40 0 0 1 0 80 a 40 40 0 0 1 0 -80"> </path> <path class="teads-countdown-circle-main" fill="none" stroke-linecap="round" stroke-width="2" stroke="#fff" stroke-dasharray="250" d="M50 10 a 40 40 0 0 1 0 80 a 40 40 0 0 1 0 -80"></path> <text class="teads-countdown-number" x="50" y="53" text-anchor="middle" dy="7" font-size="20" fill="#FFFFFF">3</text> </svg> </div> <div class="teads-countdown-fsicon"> <svg width="15" height="15" xmlns="http://www.w3.org/2000/svg"> <path fill="#FFFFFF" d="m1.09374,7.62501c-0.32761,0 -0.59374,0.26613 -0.59374,0.59374l0,5.93753c0,0.00114 0,0.00114 0,0.00231c0,0.07712 0.01536,0.15308 0.04523,0.22438c0.02842,0.07016 0.07103,0.13279 0.12352,0.18614c0.00231,0.0029 0.00231,0.00523 0.00465,0.00754c0.00117,0.00117 0.00348,0.00117 0.00465,0.00348c0.05363,0.05218 0.1177,0.09627 0.18787,0.12466c0.07364,0.03014 0.15077,0.04523 0.22786,0.04523l5.93753,0c0.32761,0 0.59374,-0.26613 0.59374,-0.59374c0,-0.32761 -0.26613,-0.59377 -0.59374,-0.59377l-4.5042,0l11.03542,-11.03542l0,4.50418c0,0.32761 0.26613,0.59374 0.59377,0.59374c0.32761,0 0.59374,-0.26613 0.59374,-0.59374l0,-5.93753l0,0c0,-0.07712 -0.01508,-0.15425 -0.0464,-0.22672c-0.06028,-0.14495 -0.17567,-0.26151 -0.32065,-0.32065c-0.07248,-0.031 -0.14957,-0.04637 -0.22669,-0.04637l-5.93753,0c-0.32761,0 -0.59374,0.26613 -0.59374,0.59374c0,0.32761 0.26613,0.59377 0.59374,0.59377l4.50418,0l-11.03542,11.03542l0,-4.50418c0,-0.32761 -0.26616,-0.59374 -0.59377,-0.59374z"/> </svg> </div> </div> '},function(e,t,i){var n=i(168);e.exports="string"==typeof n?n:n.toString()},function(e,t){e.exports='<div class="smart-header-content"> <div class="close-button-smart"></div> <div class="adChoices-button-smart"></div> <div class="sound-button-smart"> <div class="icon-muteon"></div> </div> </div> '},function(e,t,i){i.r(t);i(109);var n=i(90),s=i(92),r=i(96),a=i(91),o=i(30),d=i(94),c=i(95),l=i(97),h=i(98),u=i(99),p=i(100),g=i(42),m=i(93),b=i(27),f=i(11),v=i(68),A=i(84),y=i(7);const w=window.teads||{};w.canvas=w.canvas||{},w.canvas.player={CanvasPlayer:n.a,components:{Audio:s.a,Buffering:r.a,Canvas:a.a,EventDispatcher:o.a,File:d.a,HtmlAudioElement:c.a,JpegVideo:l.a,Mp4CTVideo:h.a,Mp4Video:u.a,MpegVideo:p.a,Video:g.b,WebAudioApi:m.a,PLAYERS:g.a},helper:{Utils:b},model:{MediaState:f.a,Shader:v,StreamType:A.a,mediaEvents:y.a}},window.teads=w;var E,O,C=i(61),I=i(13),S=i(4),T=i(6),k=i(1),j=i(17),P=i(32);!function(e){e[e.HAVE_NOTHING=0]="HAVE_NOTHING",e[e.HAVE_METADATA=1]="HAVE_METADATA",e[e.HAVE_CURRENT_DATA=2]="HAVE_CURRENT_DATA",e[e.HAVE_FUTURE_DATA=3]="HAVE_FUTURE_DATA",e[e.HAVE_ENOUGH_DATA=4]="HAVE_ENOUGH_DATA"}(E||(E={})),function(e){e[e.NETWORK_EMPTY=0]="NETWORK_EMPTY",e[e.NETWORK_IDLE=1]="NETWORK_IDLE",e[e.NETWORK_LOADING=2]="NETWORK_LOADING",e[e.NETWORK_NO_SOURCE=3]="NETWORK_NO_SOURCE"}(O||(O={}));var L=i(3),x=i(58),V=i(10),N=i(80);let D;class _{constructor(e,t,i){this.id=i,this.layer=document.createElement("div"),this.layer.className+="vpaid-clickthrough",this.layer.style.setProperty("cursor","pointer"),this.layer.style.setProperty("opacity","0"),this.layer.style.setProperty("background-color","#FFFFFF"),this.layer.style.setProperty("position","absolute"),this.layer.style.setProperty("z-index","65000"),this.layer.addEventListener("click",(function(n){e(t,i,!0)}),!1)}resize(e,t){this.layer.style.setProperty("width",e+"px"),this.layer.style.setProperty("height",t+"px")}remove(){this.layer.parentNode&&this.layer.parentNode.removeChild(this.layer)}append(e){e.firstChild?e.insertBefore(this.layer,e.firstChild):e.appendChild(this.layer)}}var R=i(15);class M extends class{constructor(){this.status=I.a.READY,this.eventHandler=new N.a,this.trackingRaised={AdVideoFirstQuartile:!1,AdVideoMidpoint:!1,AdVideoThirdQuartile:!1},this.parameters={},this.skippable=!1,this.expanded=!1}getVPAID(){return this}handshakeVersion(e){return"2.0"}subscribe(e,t,i){this.eventHandler.subscribe(e,t,i)}unsubscribe(e,t){this.eventHandler.unsubscribe(e,t)}initAd(e,t,i,n,s,r){this.status=I.a.LOADING,this.width=e,this.height=t,this.viewMode=i,C.a(s).fold(e=>{this.dispatchVpaidEvent(S.a.AdError,"invalid creative data: "+s)},e=>{for(let t in e)e.hasOwnProperty(t)&&(this.parameters[t]=e[t]);this.environmentVars=r,this.environmentVars.videoSlot||(this.environmentVars.videoSlot=D=D||document.createElement("video")),this.environmentVars.videoSlot.setAttribute&&(this.environmentVars.videoSlot.setAttribute("webkit-playsinline","true"),this.environmentVars.videoSlot.setAttribute("playsinline","true"),L.isAndroid()&&L.isChromeWebView()&&this.environmentVars.videoSlot.getAttribute&&null===this.environmentVars.videoSlot.getAttribute("poster")&&this.environmentVars.videoSlot.setAttribute("poster",x.b),this.environmentVars.videoSlot.getAttribute&&null===this.environmentVars.videoSlot.getAttribute("muted")&&this.environmentVars.videoSlot.setAttribute("muted","true")),this.environmentVars.slot?(this.video=this.environmentVars.videoSlot,this.createContainer(this.environmentVars.slot)):this.dispatchVpaidEvent(S.a.AdError,"no slot provided in environmentVars")})}startAd(){this.status=I.a.STARTING}skipAd(){this.status=I.a.SKIPPING}stopAd(){this.status=I.a.STOPPING}resizeAd(e,t,i){this.width=e,this.height=t,this.viewMode=i}expandAd(){return!1}collapseAd(){return!1}getAdLinear(){return!0}getAdWidth(){return this.width}getAdHeight(){return this.height}getAdExpanded(){return V.isFullscreen()||this.expanded}getAdSkippableState(){return this.skippable}getAdCompanions(){return""}getAdIcons(){return!1}getAdDuration(){throw"not implemented"}getAdRemainingTime(){throw"not implemented"}getStatus(){return this.status}createContainer(e){this.container||(this.container=document.createElement("div"),this.container.style.setProperty("position","relative"),e.appendChild(this.container))}onAdVideoCompleteDispatched(){this.parameters.noAutoStop?(this.video.addEventListener("seeked",()=>{this.video.pause()},!1),this.video.currentTime=1):this.stopAd()}dispatchVpaidEvent(e,t){this.handleVPAIDEvent(new S.a(e,t))}handleVPAIDEvent(e){if(!(this.status===I.a.SKIPPING&&e.type!==S.a.AdSkipped||this.status===I.a.STOPPING&&e.type!==S.a.AdStopped||this.status<=I.a.STOPPED||this.status===I.a.STOPPING&&e.type!==S.a.AdStopped)){switch(e.type){case S.a.AdLoaded:this.status=I.a.LOADED;break;case S.a.AdStarted:this.status=I.a.STARTED;break;case S.a.AdVideoStart:case S.a.AdPlaying:this.status=I.a.PLAYING;break;case S.a.AdPaused:this.status=I.a.PAUSED;break;case S.a.AdVideoComplete:this.status=I.a.COMPLETE;break;case S.a.AdSkipped:this.status=I.a.SKIPPED;break;case S.a.AdStopped:this.status=I.a.STOPPED;break;case S.a.AdDurationChange:case S.a.AdRemainingTimeChange:var t=this.getAdDuration(),i=t-this.getAdRemainingTime();t>0&&i>=.25*t&&!this.trackingRaised.AdVideoFirstQuartile?this.dispatchVpaidEvent(S.a.AdVideoFirstQuartile):t>0&&i>=.5*t&&!this.trackingRaised.AdVideoMidpoint?this.dispatchVpaidEvent(S.a.AdVideoMidpoint):t>0&&i>=.75*t&&!this.trackingRaised.AdVideoThirdQuartile&&this.dispatchVpaidEvent(S.a.AdVideoThirdQuartile);break;case S.a.AdVideoFirstQuartile:case S.a.AdVideoMidpoint:case S.a.AdVideoThirdQuartile:if(this.trackingRaised[e.type])return;this.trackingRaised[e.type]=!0;break;case S.a.AdVideoComplete:this.status=I.a.COMPLETE;break;case S.a.AdError:if(this.trackingRaised[e.type])return;this.trackingRaised[e.type]=!0}this.eventHandler.handleEvent(e),this.status===I.a.SKIPPED&&this.stopAd(),e.type===S.a.AdVideoComplete&&this.onAdVideoCompleteDispatched()}}handleException(e,t){var i='method "'+t+'" threw an exception: '+e.toString();this.dispatchVpaidEvent(S.a.AdLog,i),this.dispatchVpaidEvent(S.a.AdError,i)}}{constructor(){super(...arguments),this.config={url:"",skippable:!0,skipoffset:0,gradients:!0},this.eventMap={durationchange:"AdDurationChange",resize:"AdSizeChange",volumechange:"AdVolumeChange",ended:"AdVideoComplete",play:"AdPlaying",playing:"AdPlaying",pause:"AdPaused",timeupdate:"AdRemainingTimeChange",error:"AdError"}}initAd(e,t,i,n,s,r){if(this.status===I.a.READY)try{this.parameters=this.config,super.initAd(e,t,i,n,s,r),T.addEventListener("error",this.video,e=>{this.handleVideoError(e)}),T.addEventListener("loadedmetadata",this.video,e=>this.dispatchVpaidEvent(P.a.AdVideoMetadata,{width:this.video.videoWidth,height:this.video.videoHeight})),this.beginingTimestamp=Date.now(),this.video.preload="metadata",this.video.src=Object(R.s)(this.parameters.url),this.appendVideo(),this.dispatchVpaidEvent(S.a.AdLoaded)}catch(e){this.handleException(e,"initAd")}else this.dispatchVpaidEvent(S.a.AdLog,"creative is not in ready state, cannot call initAd")}startAd(){if(this.status>I.a.LOADED)this.dispatchVpaidEvent(S.a.AdLog,"try to call startAd but ad is starting or is already started");else if(this.status<I.a.LOADED)this.dispatchVpaidEvent(S.a.AdLog,"Ad is not loaded, use initAd first");else try{super.startAd(),this.parameters.gradients&&this.appendGradients(),this.clickThrough=new _((e,t,i)=>{this.dispatchVpaidEvent(S.a.AdClickThru,{url:e,id:t,playerHandles:i})},this.parameters.clickThrough),this.clickThrough.append(this.container),this.clickThrough.resize(this.width,this.height),this.setSize(this.width,this.height),this.initListeners(),this.video.play(),this.dispatchVpaidEvent(S.a.AdStarted),this.dispatchVpaidEvent(S.a.AdImpression)}catch(e){this.handleException(e,"startAd")}}skipAd(){if(this.status<=I.a.SKIPPING)this.dispatchVpaidEvent(S.a.AdLog,"Ad is already stopped or is skipping");else try{this.skippable?(super.skipAd(),this.video.pause(),this.video.style.setProperty("display","none"),this.dispatchVpaidEvent(S.a.AdSkipped)):this.dispatchVpaidEvent(S.a.AdLog,"skipAd() called, but creative is not skippable")}catch(e){this.handleException(e,"skipAd")}}resizeAd(e,t,i){try{this.setSize(e,t),this.dispatchVpaidEvent(S.a.AdSizeChange)}catch(e){this.handleException(e,"resizeAd")}}stopAd(){if(this.status<=I.a.STOPPING)this.dispatchVpaidEvent(S.a.AdLog,"Ad is already stopped");else try{super.stopAd(),this.removeVideo(),this.clickThrough.remove(),this.dispatchVpaidEvent(S.a.AdStopped),this.eventHandler.clearListeners()}catch(e){this.handleException(e,"stopAd")}}pauseAd(){try{this.video.pause()}catch(e){this.handleException(e,"pauseAd")}}resumeAd(){try{this.video.play()}catch(e){this.handleException(e,"resumeAd")}}getAdRemainingTime(){return this.video?this.video.duration-this.video.currentTime:0}getAdDuration(){return this.video?this.video.duration:0}getAdVolume(){return this.video?this.video.muted?0:this.video.volume:0}setAdVolume(e){return this.video?(this.video.muted=0===e,this.video.volume=e,this.video.muted?0:this.video.volume):0}appendGradients(){k.forEach(["top","bottom"],e=>{let t=document.createElement("div");t.style.setProperty("background","transparent url(data:image/png;base64,"+M["GRADIENT_"+e.toUpperCase()]+")"),t.style.setProperty("position","absolute"),t.style.setProperty("left","0"),t.style[e]="0",t.style.setProperty("z-index","2"),t.style.setProperty("height","30px"),t.style.setProperty("width","100%"),this.container.appendChild(t)})}appendVideo(){this.video.parentNode||(this.dispatchVpaidEvent(S.a.AdLog,"Video slot got no parent node, appending to container"),this.container.appendChild(this.video))}removeVideo(){try{this.video.parentNode.removeChild(this.video)}catch(e){this.dispatchVpaidEvent(S.a.AdLog,"teads-vpaid-video, cannot remove video from DOM")}}sendAdVideoStartEvent(){this.videoHasStarted||(this.videoHasStarted=!0,this.dispatchVpaidEvent(S.a.AdVideoStart))}setSize(e,t){this.width=e,this.height=t,this.video&&(this.video.width=this.width,this.video.height=this.height),this.clickThrough&&this.clickThrough.resize(e,t),this.container.style.setProperty("width",e+"px"),this.container.style.setProperty("height",t+"px")}initListeners(){for(var e in this.eventMap)this.video.addEventListener(e,e=>{this.handleVideoEvent(e)},!1)}handleVideoError(e){if("error"===e.type){let e=this.video.error;if(e)switch(e.code){case 1:break;case 2:this.dispatchVpaidEvent(S.a.AdError,{message:"video error : A network error caused the ressource to stop being fetched",id:j.b.MEDIAFILE_TIMEOUT.id});break;case 3:this.dispatchVpaidEvent(S.a.AdError,{message:"video error : A decoding error caused the ressource to stop being fetched",id:j.b.MEDIAFILE_DISPLAY.id});break;case 4:let e={message:"video error : The associated ressource has been detected to be not suitable",id:j.b.GENERAL_LINEAR.id};this.video.readyState===E.HAVE_NOTHING&&(e.id=j.b.FILE_NOT_FOUND.id),this.dispatchVpaidEvent(S.a.AdError,e)}else this.dispatchVpaidEvent(S.a.AdError,{message:"video error : unkown error",id:j.b.GENERAL.id})}}handleVideoEvent(e){try{var t=this.eventMap[e.type];switch(e.type){case"pause":if(this.video.currentTime===this.video.duration||this.status<=I.a.SKIPPING||this.status===I.a.COMPLETE)return;break;case"play":case"playing":if(this.status===I.a.STARTED)return this.sendAdVideoStartEvent();if(this.status!==I.a.PAUSED)return;break;case"timeupdate":this.parameters.skippable&&!this.skippable&&this.video.currentTime>=Number(this.parameters.skipoffset)&&(this.skippable=!0,this.dispatchVpaidEvent(S.a.AdSkippableStateChange)),(this.status===I.a.STARTED||this.video.currentTime>0)&&this.sendAdVideoStartEvent()}this.dispatchVpaidEvent(t)}catch(t){var i='Creative threw an exception when handling "'+e.type+'" HTML5 video event: '+t.toString();this.dispatchVpaidEvent(S.a.AdLog,i),this.dispatchVpaidEvent(S.a.AdError,{message:i,id:j.b.GENERAL.id})}}}M.GRADIENT="iVBORw0KGgoAAAANSUhEUgAAAAEAAAAeCAYAAADtlXTHAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjM0ODU0RjM1QkFEMTFFNUE5RDI5OTE4QkFCM0I3NzciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjM0ODU0RjQ1QkFEMTFFNUE5RDI5OTE4QkFCM0I3NzciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMzQ4NTRGMTVCQUQxMUU1QTlEMjk5MThCQUIzQjc3NyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCMzQ4NTRGMjVCQUQxMUU1QTlEMjk5MThCQUIzQjc3NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/",M.GRADIENT_TOP=M.GRADIENT+"Psk0S98AAAAgSURBVHjaYmBgYJBiAhIMIOI/nEDj0oNgYGaAAYAAAwAH4xg8FtOkrgAAAABJRU5ErkJggg==",M.GRADIENT_BOTTOM=M.GRADIENT+"PkIta+gAAAAaSURBVHjaYmBABoxMMIKBCYVLDwLJSoAAAwAWTwBRQ43+sgAAAABJRU5ErkJggg==";const F=window.teads||{};F.video=F.video||{},F.video.VPAIDCanvas=class extends M{initAd(e,t,i,s,r,a){a.videoSlot&&a.videoSlot.parentNode&&a.videoSlot.parentNode.removeChild(a.videoSlot),a.slot&&this.createContainer(a.slot),C.a(r).fold(e=>this.handleException(e,"initAd"),r=>{a.videoSlot=new n.a(this.container,e,t,r),a.videoSlot.addEventListener(y.a.ERROR,e=>this.dispatchVpaidEvent(this.eventMap[e.type])),super.initAd(e,t,i,s,r,a)})}startAd(){if(this.status>I.a.LOADED)this.dispatchVpaidEvent(S.a.AdLog,"try to call startAd but ad is starting or is already started");else if(this.status<I.a.LOADED)this.dispatchVpaidEvent(S.a.AdLog,"Ad is not loaded, use initAd first");else try{super.startAd(),this.dispatchVpaidEvent(S.a.AdDurationChange)}catch(e){this.handleException(e,"startAd")}}appendVideo(){}removeVideo(){this.video.pause(),this.video.html5video&&this.container.removeChild(this.video.html5video),this.video.canvas&&this.container.removeChild(this.video.canvas)}},F.video.VPAIDVideo=M,window.teads=F},function(e,t,i){var n=i(169);e.exports="string"==typeof n?n:n.toString()},function(e,t,i){var n=i(170);e.exports="string"==typeof n?n:n.toString()},function(e,t){e.exports='<style> #{{countdown-id}} svg:nth-child(2) path { -webkit-animation: load {{countdown-duration}}s linear; -moz-animation: load {{countdown-duration}}s linear; -o-animation: load {{countdown-duration}}s linear; animation: load {{countdown-duration}}s linear; } </style> \x3c!-- Container --\x3e <ul class="countdown-circle" id="{{countdown-id}}"> \x3c!-- Item --\x3e <li data-countdown="{{countdown-duration}}" class="countdown-timer"> <svg viewBox="-10 -10 220 220"> <g fill="none" stroke-width="20" transform="translate(100,100)"> <path d="M 0,-100 A 100,100 0 0,1 86.6,-50" stroke="url(#cl1)"/> <path d="M 86.6,-50 A 100,100 0 0,1 86.6,50" stroke="url(#cl1)"/> <path d="M 86.6,50 A 100,100 0 0,1 0,100" stroke="url(#cl1)"/> <path d="M 0,100 A 100,100 0 0,1 -86.6,50" stroke="url(#cl1)"/> <path d="M -86.6,50 A 100,100 0 0,1 -86.6,-50" stroke="url(#cl1)"/> <path d="M -86.6,-50 A 100,100 0 0,1 0,-100" stroke="url(#cl1)"/> </g> </svg> <svg viewBox="-10 -10 220 220"> <path d="M200,100 C200,44.771525 155.228475,0 100,0 C44.771525,0 0,44.771525 0,100 C0,155.228475 44.771525,200 100,200 C155.228475,200 200,155.228475 200,100 Z" stroke-dashoffset="629"></path> </svg> </li> </ul> \x3c!-- Defining Angle Gradient Colors --\x3e <svg width="0" height="0"> <defs> <linearGradient id="cl1" gradientUnits="objectBoundingBox" x1="0" y1="0" x2="1" y2="1"> <stop stop-color="#FFFFFF"/> <stop offset="100%" stop-color="#FFFFFF"/> </linearGradient> </defs> </svg> '},function(e,t){e.exports='<div class="button-container"> <div class="button replay-button"> <div class="icon"> <span class="icon-replay"></span> </div> <div class="text"></div> </div> <div class="button call-button"> <div class="icon"> <span></span> </div> <div class="text"></div> </div> </div> <div class="close-button"> <div class="icon-closeendscreen"></div> </div> <div class="adchoices adchoices-icon"> <span>AdChoices</span> </div> <div class="countdown"></div> '},function(e,t,i){i.d(t,"a",(function(){return X}));var n=i(116),s=i(127),r=i(46),a=i(0),o=i(18),d=i(15),c=i(2);class l extends o.a{constructor(e,t){super("Vast"),this.type=e.type,this.content=e.content,this.pid=t,this.appendPID(),this.checkValue()}checkValue(){if(!Object(c.isString)(this.type)||!l.VALUES[this.type.toUpperCase()])throw new r.a(r.a.OPTION_VAST_INVALID);if(!Object(c.isString)(this.content))throw new r.a(r.a.OPTION_VAST_INVALID)}isVastUrl(){return this.type===l.VALUES.VASTURL}isVastXml(){return this.type===l.VALUES.VASTXML}getContent(){return this.content}appendPID(){var e=Object(d.p)(this.content);this.isVastUrl()&&"a.teads.tv"===e.hostname&&this.pid&&(this.content+=-1===this.content.indexOf("?")?"?":"&",this.content+="pid="+this.pid)}}l.VALUES={VASTURL:"VastUrl",VASTXML:"VastXml"};class h extends o.a{constructor(e=h.DEFAULT){super("Threshold"),this.value=e,this.checkValue()}checkValue(){if(!Object(c.isNumber)(this.value)||this.value<=0||this.value>100)throw new r.a(r.a.OPTION_THRESHOLD_MISSING)}get(){return this.value}percentage(){return this.value/100}}h.DEFAULT=null;var u=i(3),p=i(21);class g extends o.a{constructor(e=g.DEFAULT){super("Volume"),p.a(Object(u.getIosVersion)(),"10")?this.value=g.DEFAULT_IOS10:this.value=Object.assign(Object.assign({},g.DEFAULT),e),this.checkValue()}checkValue(){Object(c.containsKeys)(g.VALUES,this.value)||(this.value=g.DEFAULT)}getMain(){return this.value.main}}g.VALUES={MAIN:"main"},g.DEFAULT={main:.35},g.DEFAULT_IOS10={main:1};var m=i(1);class b extends o.a{constructor(e=b.DEFAULT,t=null){super("Animations"),this.value=Object.assign(Object.assign({},b.DEFAULT),e),t&&t.isInBoard()&&(this.value=b.DEFAULT_INBOARD),this.checkValue()}checkValue(){Object(c.containsKeys)(b.VALUES,this.value)||(this.value=b.DEFAULT)}setExpandDuration(e){m.forEach(b.PROPERTIES,t=>{e.style.setProperty(t,this.value.expand+"s")})}setCollapseDuration(e){m.forEach(b.PROPERTIES,t=>{e.style.setProperty(t,this.value.collapse+"s")})}getExpandDuration(){return this.value.expand}getCollapseDuration(){return this.value.collapse}}b.PROPERTIES=["-webkit-transition-duration","-o-transition-duration","-moz-transition-duration","transition-duration"],b.VALUES={EXPAND:"expand",COLLAPSE:"collapse"},b.DEFAULT={expand:0,collapse:.5},b.DEFAULT_INBOARD={expand:.5,collapse:.5};class f extends o.a{constructor(e=f.DEFAULT){super("AdType"),this.value=e,this.checkValue()}checkValue(){Object(c.isString)(this.value)&&f.VALUES[this.value]||(this.value=f.DEFAULT)}get(){return this.value}isVideo(){return this.value===f.VALUES.video}isDisplay(){return this.value===f.VALUES.display}isNative(){return this.value===f.VALUES.native}}f.VALUES={video:"video",display:"display",native:"native"},f.DEFAULT=f.VALUES.video;var v=i(4),A=i(115);class y extends o.a{constructor(e=""){if(super("VtpEvent"),this.event=y.DEFAULT_EVENT,this.offset=y.DEFAULT_OFFSET,Object(c.isString)(e)){const[t,i]=e.split("-");t&&A.a[t]&&(this.event=A.a[t]),this.event===v.a.AdRemainingTimeChange&&(this.offset=parseInt(i,10))}this.checkValue()}checkValue(){Object(c.isString)(this.event)&&Object(c.isNumber)(this.offset)&&!isNaN(this.offset)||(this.event=y.DEFAULT_EVENT,this.offset=y.DEFAULT_OFFSET)}getEvent(){return this.event}getOffset(){return this.offset}}y.DEFAULT_EVENT=null,y.DEFAULT_OFFSET=0;class w extends o.a{constructor(e,t=null){super("SmartPosition"),this.formatName=t,this.value=Object.assign(Object.assign({},w.DEFAULT),e),(p.c(u.getIosVersion(),w.MIN_IOS_VERSION)||u.isAmp()||u.isIABSafeFrame())&&(this.value.top=!1,this.value.corner=!1),this.checkValue()}checkValue(){Object(c.containsKeys)(w.VALUES,this.value)||(this.value=w.DEFAULT)}isEnabled(){var e;return window.DO_BYPASS_DO_FORCE_SMART&&(null===(e=this.formatName)||void 0===e?void 0:e.isInRead())||this.value.mustBypassWhitelist&&(this.value.corner||this.value.top)}isCorner(){return this.value.corner&&this.isEnabled()}isTop(){return this.value.top&&this.isEnabled()&&!u.isDesktop()}getValue(){return this.value}setValue(e){this.value=e,this.checkValue()}}w.MIN_IOS_VERSION="7",w.VALUES={top:"top",corner:"corner"},w.DEFAULT={top:!1,corner:!1,mustBypassWhitelist:!1};class E extends o.a{constructor(e){super("SliderBehavior"),this.value=Object.assign(Object.assign({},E.DEFAULT),e),this.checkValue()}checkValue(){Object(c.containsKeys)(E.VALUES,this.value)||(this.value=E.DEFAULT)}isEnabled(){return this.value.enable}getValue(){return this.value}setValue(e){this.value=e,this.checkValue()}}E.VALUES={enable:"enable"},E.DEFAULT={enable:!1};class O extends o.a{constructor(e){super("Smart6Behavior"),this.value=Object.assign(Object.assign({},O.DEFAULT),e),this.checkValue()}checkValue(){Object(c.containsKeys)(O,this.value)||(this.value=O.DEFAULT)}isEnabled(){return this.value.corner||this.value.top}isTop(){return this.value.top&&this.isEnabled()&&!u.isDesktop()}getValue(){return this.value}setValue(e){this.value=e,this.checkValue()}}O.VALUES={top:"top",corner:"corner"},O.DEFAULT={top:!1,corner:!1};class C extends o.a{constructor(e,t=null){super("Sticky"),this.value=e,this.formatName=t,this.checkValue()}static isCompatibleWithContext(){return(u.isMobile()||u.isTablet())&&(!u.isIos()||p.b(u.getIosVersion(),C.MIN_IOS_VERSION))&&!u.isAmp()&&!u.isIABSafeFrame()}getValue(){return this.value}setValue(e){this.value=e,this.checkValue()}isEnabled(){return!0===this.value}checkValue(){this.value=!!(this.formatName&&this.formatName.isInBoard()&&C.isCompatibleWithContext()&&!1!==this.value)}}C.MIN_IOS_VERSION="7";var I=i(51);class S extends o.a{constructor(e){super("CloseButton"),this.getValueFromVast=!e||Object(c.isUndefined)(e.display),this.value=Object.assign(Object.assign({},S.DEFAULT),Object(I.a)(e,Object(c.not)(c.isUndefined))),this.checkValue()}checkValue(){Object(c.containsKeys)(S.VALUES,this.value)?(this.value.countdown=+this.value.countdown,Object(c.isNumber)(this.value.countdown)||(this.value.countdown=0)):this.value=S.DEFAULT}isEnabled(){return this.value.display}getCountdown(){return this.value.countdown}hasToGetValueFromVast(){return this.getValueFromVast}}S.VALUES={DISPLAY:"display",COUNTDOWN:"countdown"},S.DEFAULT={display:!0,countdown:0};class T extends o.a{constructor(e){super("SoundButton");const{display:t,countdown:i,type:n}=T.sanitize(e);this.isEnabled=t,this.countdown=i,this.type=n}static sanitize(e){return a.b.fromNullable(e).map(e=>Object.assign(Object.assign({},T.defaultValues),Object(I.a)(e,Object(c.not)(c.isNull)))).filter(c.matchesCheckers(T.checkers)).getOrValue(T.defaultValues)}checkValue(){}toString(){return`SoundButton(${this.isEnabled}, ${this.countdown}, ${this.type})`}}T.defaultValues={display:!0,countdown:0,type:"mute"},T.checkers={display:c.isBoolean,countdown:c.isNumber,type:e=>"mute"===e};class k extends o.a{constructor(e=k.DEFAULT){super("CallButton"),this.value=Object.assign(Object.assign({},k.DEFAULT),e),this.checkValue()}checkValue(){Object(c.containsKeys)(k.VALUES,this.value)||(this.value=k.DEFAULT)}isEnabled(){return this.value.display}getCountdown(){return this.value.countdown}getText(){return this.value.text}}k.VALUES={DISPLAY:"display",COUNTDOWN:"countdown",TEXT:"text"},k.DEFAULT={display:!0,countdown:3,text:"Learn More"};class j extends o.a{constructor(e=j.DEFAULT){super("Timer"),this.value=e,this.checkValue()}checkValue(){Object(c.isBoolean)(this.value)||(this.value=j.DEFAULT)}isEnabled(){return this.value}}j.DEFAULT=!1;class P extends o.a{constructor(e=P.DEFAULT){super("ProgressBar"),this.value=e,this.checkValue()}checkValue(){Object(c.isBoolean)(this.value)||(this.value=P.DEFAULT)}isEnabled(){return this.value}}P.DEFAULT=!0;class L{constructor(e){this.lang=e,this.translations={ar:{label:""},cs:{label:"REKLAMA"},de:{label:"WERBUNG"},da:{label:"ANNONCE"},en:{label:"ADVERTISING"},es:{label:"PUBLICIDAD"},fr:{label:"PUBLICIT"},fi:{label:"MAINONTA"},hr:{label:"OGLAS"},hu:{label:"HIRDETS"},id:{label:"Iklan"},it:{label:"PUBBLICIT"},ja:{label:""},jamobile:{label:""},jamobilePR:{label:"[PR]"},ko:{label:""},kr:{label:""},mo:{label:"ADVERTISING"},nl:{label:"ADVERTENTIE"},no:{label:"ANNONSERING"},pl:{label:"REKLAMA"},pt:{label:"PUBLICIDADE"},ro:{label:"PUBLICITATE"},ru:{label:""},sr:{label:""},sk:{label:"REKLAMA"},sl:{label:"OGLAAVANJE"},sv:{label:"ANNONS"},sw:{label:"REKLAM"},tr:{label:"ILAN"},zh:{label:""},"zh-hk":{label:""},"zh-tw":{label:""},vi:{label:"ADVERTISING"},"fil-ph":{label:"ADVERTISING"},ms:{label:"ADVERTISING"},"hi-in":{label:""}}}translate(e){return(this.translations[this.lang]||{})[e]}}class x extends o.a{constructor(e=x.DEFAULT){super("Label"),this.value=Object.assign(Object.assign({},x.DEFAULT),e),this.checkValue()}static getTranslation(){const e=u.getLanguage().toLowerCase();let t=new L(e).translate("label");return t||5!==e.length||(t=new L(e.substr(0,2)).translate("label")),t||(t=new L("en").translate("label")),t}checkValue(){Object(c.containsKeys)(x.VALUES,this.value)||(this.value=x.DEFAULT)}getHTML(){return this.value.html}getText(){return this.value.text}isEnabled(){return this.value.display}}x.VALUES={DISPLAY:"display",TEXT:"text",HTML:"html"},x.TEXT=x.getTranslation(),x.DEFAULT={display:!0,text:x.TEXT,html:x.TEXT};var V=i(131);class N extends o.a{constructor(e=N.DEFAULT){super("EndScreen"),this.value=Object.assign(Object.assign(Object.assign({},N.DEFAULT),Object(I.a)(e,Object(c.not)(c.isUndefined))),{callButton:Object.assign(Object.assign({},N.DEFAULT.callButton),Object(I.a)(null==e?void 0:e.callButton,Object(c.not)(c.isUndefined))),replayButton:Object.assign(Object.assign({},N.DEFAULT.replayButton),Object(I.a)(null==e?void 0:e.replayButton,Object(c.not)(c.isUndefined)))}),Object(u.isAmp)()&&(this.value.display=!0,this.value.autoClose=!1),!1===this.value.autoClose&&(this.value.countdown=0),this.checkValue()}checkValue(){Object(c.containsKeys)(N.VALUES,this.value)||(this.value=N.DEFAULT)}isEnabled(){return this.value.display}getCountdown(){return this.value.countdown}getCallButton(){return this.value.callButton}getReplayButton(){return this.value.replayButton}getAutoClose(){return this.value.autoClose}}N.VALUES={DISPLAY:"display",CALLBUTTON:"callButton",REPLAYBUTTON:"replayButton",AUTOCLOSE:"autoClose",COUNTDOWN:"countdown",TYPE:"type"},N.DEFAULT={display:!0,callButton:{text:"Learn More",type:"learnMore"},replayButton:{text:"Replay"},autoClose:!1,countdown:0,type:"simple"};class D extends o.a{constructor(e=null,t=""){super("BrandLogo");let i={display:!!e&&e.display,url:t};this.value=Object.assign(Object.assign({},D.DEFAULT),i),this.checkValue()}checkValue(){Object(c.containsKeys)(D.VALUES,this.value)||(this.value=D.DEFAULT)}getUrl(){return this.value.url}isEnabled(){return this.value.display}}D.VALUES={DISPLAY:"display",URL:"url"},D.DEFAULT={display:!1,url:""};class _ extends o.a{constructor(e){super("SmartPosition"),this.value=e,this.checkValue()}checkValue(){c.containsKeys(_.VALUES,this.value)||(this.value=_.DEFAULT)}closeButtonEnabled(){return this.value.closeButtonDisplay}}_.VALUES={closeButtonDisplay:"closeButtonDisplay"},_.DEFAULT={closeButtonDisplay:!1};class R extends o.a{constructor(e=R.DEFAULT){super("Launch"),Object(u.isAmp)()?this.value=R.VALUES.AUTO:this.value=e,this.checkValue()}checkValue(){Object(c.isString)(this.value)&&R.VALUES[this.value.toUpperCase()]||(this.value=R.DEFAULT)}isAuto(){return this.value===R.VALUES.AUTO}isThreshold(){return this.value===R.VALUES.THRESHOLD}}R.VALUES={AUTO:"auto",THRESHOLD:"threshold"},R.DEFAULT=R.VALUES.AUTO;var M=i(117);class F extends o.a{constructor(e=F.DEFAULT){super("SoundStart"),this.value=Object.assign(Object.assign({},F.DEFAULT),e),!Object(u.isMobile)()&&!Object(u.isTablet)()||Object(u.isSDK)()||(this.value.type="mute"),this.checkValue()}checkValue(){Object(c.containsKeys)(F.VALUES,this.value)||(this.value=F.DEFAULT)}isMute(){return this.value.type===F.VALUES_TYPE.MUTE}isUnmute(){return this.value.type===F.VALUES_TYPE.UNMUTE}isCountdown(){return this.value.type===F.VALUES_TYPE.COUNTDOWN}getCountdown(){return this.value.countdown}getType(){return this.value.type}}F.VALUES={TYPE:"type",COUNTDOWN:"countdown"},F.VALUES_TYPE={MUTE:"mute",UNMUTE:"unmute",COUNTDOWN:"countdown"},F.DEFAULT={type:"mute",countdown:0};class U extends o.a{constructor(e=U.VALUES.THRESHOLD){super("VideoPause"),this.value=e,this.checkValue()}checkValue(){Object(c.isString)(this.value)&&U.VALUES[this.value.toUpperCase()]||(this.value=U.DEFAULT)}isNo(){return this.value===U.VALUES.NO}isThreshold(){return this.value===U.VALUES.THRESHOLD}getValue(){return this.value}setToNo(){return this.value=U.VALUES.NO}}U.VALUES={NO:"no",THRESHOLD:"threshold"},U.DEFAULT=U.VALUES.THRESHOLD;class B extends o.a{constructor(e=B.DEFAULT){super("SoundMute"),this.value=e,this.checkValue()}checkValue(){Object(c.isString)(this.value)&&B.VALUES[this.value.toUpperCase()]||(this.value=B.DEFAULT)}isNo(){return this.value===B.VALUES.NO}isThreshold(){return this.value===B.VALUES.THRESHOLD}}B.VALUES={NO:"no",THRESHOLD:"threshold"},B.DEFAULT=B.VALUES.THRESHOLD;class W extends o.a{constructor(e=W.DEFAULT){super("PlayerClick"),this.value=e,Object(u.isDesktop)()&&(this.value=W.VALUES.CLICK),this.checkValue()}checkValue(){Object(c.isString)(this.value)&&W.VALUES[this.value.toUpperCase()]||(this.value=W.DEFAULT)}isClick(){return this.value===W.VALUES.CLICK}isFullscreen(){return this.value===W.VALUES.FULLSCREEN}}W.VALUES={CLICK:"click",FULLSCREEN:"fullscreen"},W.DEFAULT=Object(u.isDesktop)()?W.VALUES.CLICK:W.VALUES.FULLSCREEN;class H extends o.a{constructor(e=H.DEFAULT){super("End"),this.value=Object(u.isAmp)()?H.VALUES.ENDSCREEN:e,this.checkValue()}checkValue(){Object(c.isString)(this.value)&&H.VALUES[this.value.toUpperCase()]||(this.value=H.DEFAULT)}isCollapse(){return this.value===H.VALUES.COLLAPSE}isEndScreen(){return this.value===H.VALUES.ENDSCREEN}}H.VALUES={COLLAPSE:"collapse",ENDSCREEN:"endscreen"},H.DEFAULT=H.VALUES.ENDSCREEN;var z=i(50),G=i(62);class q extends o.a{constructor(e=q.DEFAULT,t){super("Callbacks"),this.callbacks=e,this.volume=t,this.checkValue()}checkValue(){c.isObject(this.callbacks)||(this.callbacks=q.DEFAULT)}trigger(e,t,i){if(this.last===e)return this.logger.debug("Callbacks already triggered",e),!1;if(e===v.a.AdVolumeChange&&t&&(t.getVolume()===this.volume.getMain()?this.trigger("unmute"):t.isMuted()&&this.trigger("mute")),e===v.a.AdExpandedChange&&i&&(i.isActive()?this.trigger("enterFullscreen"):this.trigger("exitFullscreen")),c.isFunction(this.callbacks[e]))try{return this.callbacks[e](),this.last=e,!0}catch(t){z.a.error(`cb-threw-err ${e} ${Object(G.a)(t)}`),this.logger.error('the "'+e+'" callback threw an error:',t)}else this.callbacks[e]&&this.logger.error('the "'+e+'" callback is not a function:',this.callbacks[e]);return!1}}q.DEFAULT={};var K=i(53);class $ extends o.a{constructor(e){super("AllowedPlayer"),this.setValue($.VALUES[e]),this.checkValue()}checkValue(){let e=!1;for(let t in $.VALUES)$.VALUES.hasOwnProperty(t)&&(e=e||this.value===$.VALUES[t]);e||(this.value=$.DEFAULT)}getValue(){return this.value}setValue(e){this.value=e,u.cacheCanvasUsed(this.value===K.a.CANVAS)}}$.VALUES={html5:K.a.HTML5,canvas:K.a.CANVAS,any:K.a.ANY},$.DEFAULT=K.a.ANY;class Y extends o.a{constructor(e=Y.DEFAULT_VALUE){super("BannerVideoBottom"),this.value=Object.assign(Object.assign({},Y.DEFAULT_VALUE),e)}checkValue(){}isEnabled(){return this.value.display}getText(){return this.value.text}}Y.DEFAULT_VALUE={display:!1,text:"Learn more"};class X{constructor(e){if(!e.settings)throw new r.a(r.a.INCOMPLETE_OBJECT);const t={type:e.type,content:e.content};this.vast=new l(t,e.settings.values.placementId),e.settings.values=e.settings.values||{placementFormat:null,pageId:null,placementId:null,threshold:null},e.settings.components=e.settings.components||{},e.settings.behaviors=e.settings.behaviors||{},this.adSourceId=e.ad_source_id,this.connectionId=e.connection_id,this.insertionId=e.insertion_id,this.dspCampaignId=e.dsp_campaign_id,this.dspCreativeId=e.dsp_creative_id,this.scenarioId=e.scenario_id,this.portfolioItemId=e.portfolio_item_id,this.creativeSize=e.creativeSize,this.formatName=new s.a(e.settings.values.placementFormat),this.pageId=Object(n.b)(e.settings.values.pageId),this.placementId=e.settings.values.placementId,this.threshold=new h(e.settings.values.threshold),this.volume=new g(e.settings.values.volume),this.animations=new b(e.settings.values.animations,this.formatName),this.adType=new f(e.settings.values.adType),this.vtpEvent=new y(e.settings.values.vtpEvent),this.smartPosition=new w(e.settings.behaviors.smartPosition,this.formatName),this.sliderBehavior=new E(e.settings.behaviors.slider),this.smart6Behavior=new O(e.settings.behaviors.smart6Position),this.sticky=new C(e.settings.behaviors.sticky,this.formatName),this.friendly=a.b.fromNullable(e.settings.behaviors.friendly).getOrValue(!1),this.closeButton=new S(e.settings.components.closeButton),this.soundButton=new T(e.settings.components.soundButton),this.callButton=new k(e.settings.components.callButton),this.timer=new j(e.settings.components.timer),this.progressBar=new P(e.settings.components.progressBar),this.label=new x(e.settings.components.label),this.credits=new V.b(e.settings.components.credits,this.smartPosition,this.formatName),this.endScreen=new N(e.settings.components.endScreen),this.brandLogo=new D(e.settings.components.brandLogo,e.settings.values.brandLogoUrl),this.slider=new _(e.settings.components.slider),this.bannerVideoBottom=new Y(e.settings.components.bannerVideoBottom),this.launch=new R(e.settings.behaviors.launch),this.videoStart=new M.a(e.settings.behaviors.videoStart,this.formatName),this.soundStart=new F(e.settings.behaviors.soundStart),this.videoPause=new U(e.settings.behaviors.videoPause),this.soundMute=new B(e.settings.behaviors.soundMute),this.playerClick=new W(e.settings.behaviors.playerClick),this.end=new H(e.settings.behaviors.end),this.attributeOn=e.conversion_measurement_attribute_on,this.attributionExpiry=e.conversion_measurement_attribution_expiry,this.callbacks=new q(e.callbacks,this.volume),this.allowedPlayer=new $(e.settings.values.allowedPlayer)}}},function(e,t,i){i.d(t,"a",(function(){return m}));var n=i(9),s=i(108),r=i(17),a=i(5),o=i(2),d=i(12),c=i(40);const l=[1,2];var h=i(128);const u=new n.a("vast.VASTLoader");function p(e,t,i,n,g=!0){const b=(e=function(e){return a.a.tryCatch(()=>decodeURIComponent(e)).fold(()=>function(e){return e.replace(/%/g,"")}(e),()=>e)}(e=function(e,t=l,i=h.a){try{let n=d.rand(8);return e.replace(/\[timestamp\]/gi,String(Date.now())).replace(/\[(random|cachebusting|random_number|TTD_CACHEBUSTER)\]/gi,n).replace(/ord=(%n|\{RANDOMNUM\}|%25%25TTD_CACHEBUSTER%25%25)/gi,"ord="+n).replace(/\[APIFRAMEWORKS\]/gi,t.join(",")).replace(/%APIFRAMEWORKS%/gi,t.join(",")).replace(/\[OMIDPARTNER\]/gi,i).replace(/%OMIDPARTNER%/gi,i)}catch(e){u.warn("updateUrlPlaceholder threw an exception: "+e)}return e}(e,t.apiFrameworkList))).match(/\/\/.*/);b&&(e=t.forceHTTPS?"https:"+b[0]:o.getProtocol()+b[0]),u.debug("Loading VAST file URL:",e," - credentials:",g);let f,v=!1;var A=r=>{if(clearTimeout(f),!v&&g)return u.warn("load file with credentials failed, try without credentials"),void p(e,t,i,n,!1);u.warn("load file with javascript failed",e),n(r,new s.a)};try{const n=c.a();n.open("GET",e,!0),n.withCredentials=g;var y=()=>{if(clearTimeout(f),!v){var e;if(y=o.noop,"string"==typeof n.responseXML)e=n.responseXML;else if("string"==typeof n.responseText)e=n.responseText;else{if("string"!=typeof n.response)return void A(r.a.get(r.b.WRAPPER_TIMEOUT.id,"empty xhr response"));e=n.response}i(d.trim(e))}};c.b(n)?n.onreadystatechange=()=>{if(4===n.readyState){if(n.status<200||n.status>=400){let e=r.a.get(r.b.WRAPPER_TIMEOUT.id,"invalid XHR status code "+n.status);return u.warn("server return an invalid status code : "+e.toString()),404===n.status&&(v=!0),A(e)}y()}}:(n.onerror=()=>A(r.a.get(r.b.WRAPPER_TIMEOUT.id,"XHR onerror")),n.onprogress=()=>{},n.onload=()=>y()),a.a.tryCatch(()=>n.send()).fold(e=>{A(r.a.get(r.b.WRAPPER.id,"Error on XHR send method",e))},()=>{const e=t.timeout||m.TIMEOUT;f=setTimeout(()=>{v=!0,A(r.a.get(r.b.WRAPPER_TIMEOUT.id,"no response after "+e+"ms"))},e)})}catch(e){u.warn("Could not load XML file directly",e),v=!0,A(r.a.get(r.b.UNDEFINED.id,"VASTLoader.load error "+e,e))}}var g=i(103);class m{constructor(e,t,i,s){this.config=e,this.gdprIab=t,this.sumologicLogger=i,this.wigo=s,this.logger=new n.a("vast.VASTLib"),this.logger.debug("new",this),this.wrappersLimit=this.config.wrappersLimit||m.WRAPPERS_LIMIT}load(e,t,i){this.processVast(!0,e,t,i)}parse(e,t,i){this.processVast(!1,e,t,i)}processVast(e,t,i,n){let r=Date.now(),a=e=>{let t=Date.now()-r;this.sumologicLogger.info(`parse ${e.wrappers.length} ${t}`),i(e)},o=(e,t)=>{n(e,t)};e?this.loadXml(new s.a,t,a,o):this.parseXml(new s.a,t,a,o)}loadXml(e,t,i,n){e.url||(e.url=t),this.wigo.filter(e=>!!e.report).forEach(e=>t=e.getVastUrl(t)),p(t,this.config,s=>{this.wigo.forEach(e=>e.setVast(t,s)),this.parseXml(e,s,i,n)},n)}parseXml(e,t,i,n){Object(g.b)(t,t=>{if(e.merge(t),t.adTagUri)e.wrappers.length>this.wrappersLimit?n(new r.b(r.b.WRAPPER_LIMIT),e):(this.logger.info("load wrapper",t.adTagUri),this.loadXml(e,t.adTagUri,i,(t,i)=>{n(t,e)}));else if(0===e.mediaFiles.length){let t=r.a.get(r.b.WRAPPER.id,"empty mediafiles in VAST definition");this.logger.error(t.getFullMessage()),n(t,e)}else i(e)},(t,i)=>{e.merge(i),n(t,e)},this.gdprIab,this.sumologicLogger)}}m.TIMEOUT=7e3,m.WRAPPERS_LIMIT=10},function(e,t,i){i.d(t,"a",(function(){return r}));var n=i(18),s=i(2);class r extends n.a{constructor(e=r.DEFAULT){super("VideoFilter"),this.value=e,this.checkValue()}checkValue(){Object(s.isString)(this.value)||(this.value=r.DEFAULT)}get(){return this.value}}r.VALUES={DISABLED:"disabled",ARTICLE:"article",SLOT:"slot"},r.DEFAULT=r.VALUES.DISABLED},function(e,t,i){i.d(t,"a",(function(){return r}));var n=i(18),s=i(2);class r extends n.a{constructor(e=r.DEFAULT){super("ImageFilter"),this.value=e,this.checkValue()}checkValue(){Object(s.isString)(this.value)||(this.value=r.DEFAULT)}get(){return this.value}}r.VALUES={DISABLED:"disabled",SLOT:"slot"},r.DEFAULT=r.VALUES.DISABLED},function(e,t,i){i.d(t,"b",(function(){return W})),i.d(t,"a",(function(){return H})),i.d(t,"c",(function(){return q})),i.d(t,"d",(function(){return Y}));var n=i(1),s=i(6),r=i(31),a=i(5),o=i(9),d=i(26);class c{constructor(e){this.win=e,this.logger=new o.a("helper.SmartSlot")}static findArticle(e,t,i,n){i.length=0,i.currentScore=0,i.childrenScore=0,i.isOverMinimumWidth=!1;const r=e.innerText||e.textContent||e.nodeValue,a=e.nodeName.toUpperCase();if(r&&(3===e.nodeType||c.textNodes[a]))i.length=r.replace(/\s+/g," ").length;else if(e===t.document.body||1===e.nodeType&&c.nodeScores[a]){let n=0,r=0;for(let a=0,o=e.childNodes.length;a<o;a++){const o=c.findArticle(e.childNodes[a],t,i);n+=o.length,r+=o.currentScore,(o.isOverMinimumWidth||s.getSize(e).width>=c.MINIMUM_WIDTH)&&(i.isOverMinimumWidth=!0)}i.currentScore=n,i.childrenScore=r}if(i.childrenScore&&i.isOverMinimumWidth&&i.childrenScore>c.MINIMUM_CHARS){const t=c.nodeScores[a]||0,s=e.className.split(" ");let r,o=1;for(let e=0,t=s.length;e<t;e++)r=s[e].replace(/^\s+|\s+$/g,""),o+=c.classBonuses[r]||0;let d=1;for(let t in c.attributeBonuses)if(c.attributeBonuses.hasOwnProperty(t)){const i=c.attributeBonuses[t],n=void 0===i.value&&void 0!==e.getAttribute(t),s=i.value===e.getAttribute(t);(n||s)&&(d+=i.bonus||0)}const l=i.childrenScore*t*o*d;l>i.article.score&&(i.article.score=l,i.article.node=e,n&&n.debug("found a better node scoring ",i.article.score,i.article.node))}return i}find(){this.logger.info("Auto slot is finding a slot");const e=c.findArticle(this.win.document.body,this.win,{length:0,currentScore:0,childrenScore:0,isOverMinimumWidth:!1,article:{score:0,node:null}},this.logger);return e.article&&e.article.node?this.findParagraph(e.article.node):null}findParagraph(e){let t;const i=["P","DIV"];for(let n=0;n<i.length&&(t=e.getElementsByTagName(i[n]),!t.length);n++);return t}}c.MINIMUM_SCORE=5e3,c.MINIMUM_CHARS=500,c.MINIMUM_WIDTH=200,c.nodeScores={DIV:10,P:4,ARTICLE:20,SECTION:5,SPAN:2,FORM:4,STRONG:2,EM:3,B:1,I:1,U:1,MAIN:2},c.textNodes={SPAN:!0,STRONG:!0,EM:!0,B:!0,I:!0,U:!0},c.classBonuses={article:4,"ob-text":6,"ob-section-html":4,contenuArticle:6},c.attributeBonuses={itemprop:{value:"articleBody",bonus:1e3}};var l=i(120),h=i(54);function u(e,t,i){if(h.a("teadsDebugInPage").toOption().existsIf(e=>"true"===e)){var n=document.createElement("div");n.setAttribute("id","teadsGhostAvoid"),n.style.position="absolute",n.style.top=t.top+"px",n.style.bottom=t.bottom+"px",n.style.left=t.left+"px",n.style.right=t.right+"px",n.style.width=t.width+"px",n.style.height=t.height+"px",n.style.background="rgba(255, 0, 0, 0.10)",n.style.pointerEvents="none",n.style.color="#F79C9C",n.style.zIndex="9999",n.style.padding="10px",n.innerText="avoidSlot",i.document.body.appendChild(n),e.style.backgroundColor="rgba(255, 0, 0, 0.20)"}}const p=e=>H(d.d.noSlot.avoid,e);var g=Object(r.a)((e,t,i)=>{const n=e.avoid.getSlots();if(n){const t=i.getElementRect();let s=0;for(const r of n){if(i.getElement()===r.getElement())return p("AvoidSlot === Slot");const n=r.getElementRect(),a=e.avoid.getDistance(),o={top:n.top-a,left:n.left-a,bottom:n.bottom+a,right:n.right+a,height:n.height+2*a,width:n.width+2*a};if(u(r.getElement(),o,e.parentWindow.getWindow()),t.top!==t.bottom){const e={x:Math.max(0,Math.min(t.right,o.right)-Math.max(t.left,o.left)),y:Math.max(0,Math.min(t.bottom,o.bottom)-Math.max(t.top,o.top))};if(s=e.x*e.y,s)return p(`Avoid - ${Math.ceil(s)}px2`)}else if(t.top>o.top&&t.top<o.bottom)return p("Avoid - slot inside avoid area")}}return W(i)});var m=Object(r.a)((e,{scrollTop:t,waterline:i},n)=>{if(!e.btf.isEnabled())return W(n);const s=n.getElementRect();if(e.belowSelector.get()){e.belowSelector.getFirstElement()&&(i=Math.max(i,e.belowSelector.getFirstElementRect().bottom))}const r=t+(e.insertBefore.isEnabled()?s.top:s.bottom);return r>=i?W(n):H(d.d.noSlot.btf,`lineToCheck: ${Math.round(r)}px >= waterline: ${i}px`)}),b=i(0);const f=["P","DIV","BR"];var v=Object(r.a)((e,t,i)=>{const s=i.getElement();return b.b.fromNullable(s.children).orElse(()=>b.b.fromNullable(s.childNodes)).map(n.fromArrayLike).filter(n.isNotEmpty).match({some:e=>{const t=n.find(e,e=>n.includes(f,e.nodeName));return t?H(d.d.noSlot.content,t.nodeName):W(i)},none:()=>W(i)})});var A=Object(r.a)((e,{elements:t},i)=>{i.resolveSize();const s={i:i.getIndex(),elt:i.getElement(),elts:Object(n.map)(t,e=>e.getElement()),wrappedSizes:{width:i.getWidth(),height:i.getWidth()/16*9}};return e.filter.trigger(s)?W(i):H(d.d.noSlot.filter)}),y=i(58);var w=Object(r.a)((e,{beforeHeightCheck:t,afterHeightCheck:i},n)=>{const r=650/y.a,a=t(n);if(!s.isHTMLElement(a))return H(d.d.noSlot.position);a.style.setProperty("height","0"),a.style.setProperty("text-align","center"),""===a.style.getPropertyValue("max-width")&&a.style.setProperty("max-width","100%");a.offsetLeft;const o=a.offsetTop;a.style.setProperty("overflow","hidden");a.offsetLeft;const c=a.offsetTop;a.style.setProperty("margin-top",.33*r+"px");a.offsetLeft;const l=a.offsetTop;a.style.setProperty("margin-top","0");const h=Math.abs(o-c)<8&&Math.abs(o-l)<.33*r+8;return i(a),h?W(n):H(d.d.noSlot.position,"Check height failed")});function E(e,t=window){let i=n.includes(["video","embed"],e.tagName.toLowerCase());if(!i){const t=e.getAttribute("src");i=t&&C(t)}if(i||(i=s.querySelectorAll("video",t,e).length>0),!i){const r=s.querySelectorAll("[src]",t,e),a=n.map(r,e=>e.getAttribute("src")),o=e=>C(e);i=n.filter(a,o).length>0}return i}function O(e,t=window){let i=null;const n=c.findArticle(t.document.body,t,{length:0,currentScore:0,childrenScore:0,isOverMinimumWidth:!1,article:{score:0,node:null}});return n&&n.article&&n.article.node&&(i=function e(t,i,n){if(!t||10===n)return;const s=t.parentElement;return s===i?s:e(s,i,n+1)}(e,n.article.node,0)),i||(i=e.parentElement),E(i,t)}function C(e){return/youtube|youtu\.be|dailymotion|day\.ly|vimeo|instagram|vine-videos/i.test(e)}function I(e=[]){const t=n.map(e,e=>s.getSize(e).width);return n.filter(t,e=>e>75).length>0}function S(e,t=0){if(!e||3===t)return e;const i=e.previousElementSibling;return i&&!s.isEmpty(i)?i:S(i,t+1)}function T(e,t=0){if(!e||3===t)return e;const i=e.nextElementSibling;return i&&!s.isEmpty(i)?i:T(i,t+1)}var k=i(160);var j=Object(r.a)((e,t,i)=>{const n=e.parentWindow.getWindow();return e.imageFilter.get()===k.a.VALUES.SLOT&&function(e,t=window){if(!e)return!1;let i,n=!1;if("img"===e.tagName.toLowerCase()?n=I([e]):(i=s.querySelectorAll("img",t,e),n=I(i)),!n){const r=S(e);r&&("img"===r.tagName.toLowerCase()?n=I([r]):(i=s.querySelectorAll("img",t,r),n=i.length>0&&I(i)))}if(!n){const r=T(e);r&&("img"===r.tagName.toLowerCase()?n=I([r]):(i=s.querySelectorAll("img",t,r),n=i.length>0&&I(i)))}return n}(i.getElement(),n)?H(d.d.noSlot.imageSlot,"slot is too close to an image"):W(i)});var P=Object(r.a)((e,t,i)=>{const n=i.getIndex()+1,s=e.minimum.get();return n>=s?W(i):H(d.d.noSlot.minimum,`slot: ${n} < config: ${s}`)});var L=Object(r.a)((e,{elements:t},i)=>{if(!e.belowSelector.get()||null===e.minimumBelow.get())return W(i);const n=e.belowSelector.getFirstNodeBelowIndex(t),s=i.getIndex();return s>=e.minimumBelow.get()+n-1?W(i):H(d.d.noSlot.minimumBelow,`slot: ${s} < config: ${e.minimumBelow.get()}`)});var x=Object(r.a)((e,{scrollTop:t},i)=>{if(!e.selector.get())return W(i);const n=i.getElementRect().top;return n+t>=q.MIN_POSITION_TOP&&n+t<=q.MAX_POSITION_TOP?W(i):H(d.d.noSlot.position,`positionTop: ${q.MIN_POSITION_TOP} <= ${n+t} <= ${q.MAX_POSITION_TOP}`)}),V=i(3),N=i(88);var D=Object(r.a)((e,t,i)=>{if(Object(V.isIABSafeFrame)()){const e=N.b();return e?H(d.d.noSlot.safeFrame,e):W(i)}return W(i)});var _=Object(r.a)((e,t,i)=>{if(i.resolveSize(),s.isSelfClosingTag(i.getElement()))return W(i);const r={">=":(e,t)=>e>=t,"<=":(e,t)=>e<=t},a=[{name:"minimumHeight",property:i.getHeight(),score:q.MIN_LONG_HEIGHT,operator:">="},{name:"minimumWidth",property:i.getWidth(),score:e.minimumWidth.get(),operator:">="},{name:"maximumHeight",property:i.getHeight(),score:q.MAX_LONG_HEIGHT,operator:"<="},{name:"maximumWidth",property:i.getWidth(),score:e.maximumWidth.get(),operator:"<="}],o=({name:e,property:t,score:n,operator:s})=>r[s](t,n)?W(i):H(d.d.noSlot.size,`${e}: ${t} ${s} ${n}`),c=(e,t)=>e.flatMap(()=>t.length>0?c(o(Object(n.head)(t)),Object(n.tail)(t)):e);return c(o(Object(n.head)(a)),Object(n.tail)(a))});var R=Object(r.a)((e,t,i)=>{const n=i.getElement(),r=[];s.getTextContent(n,r);const a=r.join("");if(!s.isSelfClosingTag(n)){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").length>=e.minimumTextLength.get()?W(i):H(d.d.noSlot.content)}return W(i)}),M=i(159);var F=Object(r.a)((e,t,i)=>{const n=e.parentWindow.getWindow();if(e.videoFilter.get()===M.a.VALUES.SLOT){if(function(e,t=window){if(!e)return!1;let i=E(e,t);if(!i){const n=S(e);n&&(i=E(n,t))}if(!i){const n=T(e);n&&(i=E(n,t))}return i}(i.getElement(),n))return H(d.d.noSlot.videoSlot,"slot is too close to a video")}else if(e.videoFilter.get()===M.a.VALUES.ARTICLE&&O(i.getElement(),n))return H(d.d.noSlot.videoSlot,"slot container (article) has a video");return W(i)});class U extends a.a{constructor(e){super(e,"right")}}class B extends a.a{constructor(e){super(e,"left")}}function W(e){return new U({slot:e})}function H(e,t){return new B({reason:e,information:t})}const z=new o.a("SlotChecker"),G={btf:m,minimum:P,minimumBelow:L,height:w,avoid:g,size:_,filter:A,positionTop:x,textLength:R,children:v,video:F,image:j,safeFrame:D},q={MIN_POSITION_TOP:100,MAX_POSITION_TOP:18e3,MIN_LONG_HEIGHT:30,MAX_LONG_HEIGHT:2e3,WIDTH_MARGIN:40,HEIGHT_MARGIN:20,LENGTH_MARGIN:150,LEVEL_POSITION:200};function K(e,t,i){return"inread"===e&&t?[i.safeFrame,i.image,i.video,i.minimum,i.btf,i.positionTop,i.height,i.avoid,i.textLength,i.children,i.size,i.filter]:[i.safeFrame,i.image,i.video,i.minimum,i.btf,i.avoid,i.filter]}function $(e,t,i){const s=(s,r)=>function(e,t){const i=(t,s)=>t.flatMap(()=>s.length>0?i(Object(n.head)(s)(e),Object(n.tail)(s)):t);return i(Object(n.head)(t)(e),Object(n.tail)(t))}(s,t).fold(((t,i)=>({reason:n,information:s})=>(z.info(`Invalid slot [${i} / ${e.length}] ${n} => ${s}`,t),H(n,s)))(s,r),((t,n)=>({slot:t})=>(z.info(`Elected slot [${n} / ${e.length}]`,t),i.valid(1,1),W(t)))(0,r)),r=(e,t,i)=>e.orElse(()=>t.length>0?r(s(Object(n.head)(t),i),Object(n.tail)(t),i+1):e);return e.length>0?r(s(Object(n.head)(e),0),Object(n.tail)(e),1):H(d.d.noSlot.selector)}function Y(e,t,i=$,s=$){const{placementConfig:r}=e,a=function(e,t,i=G){const n={};for(const s in i)i.hasOwnProperty(s)&&(n[s]=t(s,i[s](e)));return n}(r,X(e)),o=r.selector.getSlots();return i(o,K(e.name,!1,a),t).orElse(i=>(({reason:i,information:o})=>{if("inread"===e.name&&r.auto.isEnabled()){const i=new c(r.parentWindow.getWindow()).find(),o=Object(n.map)(i?Object(n.fromArrayLike)(i):[],(e,t)=>{const i=new l.a(e,t);return i.computeScore(r),i});return o.sort((e,t)=>t.getScore()-e.getScore()),s(o,K(e.name,!0,a),t)}return H(i,o)})(i)).fold(({reason:e,information:i})=>(z.info("No slot available"),Object(n.isEmpty)(o)&&!r.auto.isEnabled()?(t.valid(1,1,d.d.noSlot.selector,"error"),H(r.headerBiddingProvider.nonEmpty()?d.d.noSlot.hbSelector:d.d.noSlot.selector)):(t.valid(1,1,e,"error"),H(e,i))),({slot:e})=>(z.info("Slot available",e),W(e)))}const X=Object(r.a)((e,t,i)=>{const{placementConfig:n}=e,r=s.getScrollTop(n.parentWindow.getWindow());switch(t){case"btf":return i({scrollTop:r,waterline:s.getWindowSize(n.parentWindow.getWindow()).height});case"height":return i({beforeHeightCheck:t=>e.initDom(t),afterHeightCheck:e=>{e&&e.parentNode&&e.parentNode.removeChild(e)}});case"positionTop":return i({scrollTop:r});case"minimumBelow":case"filter":return i({elements:n.selector.getSlots()});default:return i({})}})},function(e,t,i){(e.exports=i(64)(void 0)).push([e.i,"div.teads-expand div.teads-ui-components-credits,div.teads-inboard div.teads-ui-components-credits,div.teads-inread div.teads-ui-components-credits{font-family:Helvetica,Arial,sans-serif!important;font-size:11.5px!important;color:#585858!important;text-align:right!important;padding:1px 0!important;height:26px!important;line-height:26px!important;padding-right:4px!important;letter-spacing:.3px!important}div.teads-expand div.teads-ui-components-credits a span,div.teads-inboard div.teads-ui-components-credits a span,div.teads-inread div.teads-ui-components-credits a span{display:inline!important}div.teads-expand div.teads-ui-components-credits a,div.teads-expand div.teads-ui-components-credits a span,div.teads-inboard div.teads-ui-components-credits a,div.teads-inboard div.teads-ui-components-credits a span,div.teads-inread div.teads-ui-components-credits a,div.teads-inread div.teads-ui-components-credits a span{font-family:Helvetica,Arial,sans-serif!important;font-size:11.5px!important;box-shadow:none!important;letter-spacing:.3px!important}div.teads-expand.sm-screen div.teads-ui-components-credits a,div.teads-expand.sm-screen div.teads-ui-components-credits a span,div.teads-expand.xs-screen div.teads-ui-components-credits a,div.teads-expand.xs-screen div.teads-ui-components-credits a span,div.teads-inboard.sm-screen div.teads-ui-components-credits a,div.teads-inboard.sm-screen div.teads-ui-components-credits a span,div.teads-inboard.xs-screen div.teads-ui-components-credits a,div.teads-inboard.xs-screen div.teads-ui-components-credits a span,div.teads-inread.sm-screen div.teads-ui-components-credits a,div.teads-inread.sm-screen div.teads-ui-components-credits a span,div.teads-inread.xs-screen div.teads-ui-components-credits a,div.teads-inread.xs-screen div.teads-ui-components-credits a span{font-family:Helvetica,Arial,sans-serif!important;font-size:9px!important;box-shadow:none!important;letter-spacing:.3px!important}div.teads-inboard.xs-screen div.teads-ui-components-credits,div.teads-inread.sm-screen div.teads-ui-components-credits{font-size:9px!important;letter-spacing:.3px!important}div.teads-expand .teads-ui-components-credits a,div.teads-inboard .teads-ui-components-credits a,div.teads-inread .teads-ui-components-credits a{color:#585858!important;text-decoration:none!important;font-weight:300!important;border:none!important;letter-spacing:.3px!important;background:none!important;padding:0!important}div.teads-expand.sm-screen .teads-ui-components-credits a,div.teads-expand.xs-screen .teads-ui-components-credits a,div.teads-inboard.sm-screen .teads-ui-components-credits a,div.teads-inboard.xs-screen .teads-ui-components-credits a,div.teads-inread.sm-screen .teads-ui-components-credits a,div.teads-inread.xs-screen .teads-ui-components-credits a{font-size:9px!important;letter-spacing:.3px!important}div.teads-expand div.teads-ui-components-credits span.teads-ui-components-credits-colored,div.teads-inboard div.teads-ui-components-credits span.teads-ui-components-credits-colored,div.teads-inread div.teads-ui-components-credits span.teads-ui-components-credits-colored{color:#025c9a!important}div.teads-inboard div.teads-ui-components-credits a:after,div.teads-inboard div.teads-ui-components-credits a:before,div.teads-inboard div.teads-ui-components-credits span:after,div.teads-inboard div.teads-ui-components-credits span:before,div.teads-inread div.teads-ui-components-credits a:after,div.teads-inread div.teads-ui-components-credits a:before,div.teads-inread div.teads-ui-components-credits span:after,div.teads-inread div.teads-ui-components-credits span:before{display:none!important}",""])},function(e,t,i){(e.exports=i(64)(void 0)).push([e.i,"div.teads-expand div.teads-ui-components-label,div.teads-inboard div.teads-ui-components-label,div.teads-inread div.teads-ui-components-label{font-family:Helvetica,Arial,sans-serif!important;font-size:11.5px!important;color:#585858;text-align:center!important;text-transform:uppercase!important;height:21px!important;line-height:21px!important;letter-spacing:.3px!important;font-weight:300!important}div.teads-inboard div.teads-ui-components-label:after,div.teads-inboard div.teads-ui-components-label:before,div.teads-inread div.teads-ui-components-label:after,div.teads-inread div.teads-ui-components-label:before{display:none!important}div.teads-inboard.sm-screen div.teads-ui-components-label,div.teads-inboard.xs-screen div.teads-ui-components-label,div.teads-inread.sm-screen div.teads-ui-components-label,div.teads-inread.xs-screen div.teads-ui-components-label{font-size:10px!important}",""])},function(e,t,i){(e.exports=i(64)(void 0)).push([e.i,'.teads-expand .teads-ui-components-adchoices,.teads-inread .teads-ui-components-adchoices{color:#000;font-family:arial;font-size:11px;cursor:pointer;position:absolute;top:3px;right:5px;width:15px;height:15px;line-height:15px;padding:1px;background:url("data:image/svg+xml;base64,PHN2Zw0KICB2ZXJzaW9uPSIxLjEiDQogIGJhc2VQcm9maWxlPSJmdWxsIg0KICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KICA8c3R5bGU+DQogICAgLyogPCFbQ0RBVEFbICovDQogICAgLmFkY2hvaWNlcyB7DQogICAgICB0ZXh0LXJlbmRlcmluZzogZ2VvbWV0cmljUHJlY2lzaW9uOw0KICAgICAgZmlsbC1vcGFjaXR5OiAxLjA7DQogICAgICBmaWxsOiAjMDBhZWNkOw0KICAgICAgc3Ryb2tlOiBub25lOw0KICAgIH0NCiAgICAvKiBdXT4gKi8NCiAgPC9zdHlsZT4NCiAgPHN2ZyBjbGFzcz0iYWRjaG9pY2VzIiB4PSIwcHgiPg0KICAgIDxjaXJjbGUgY3g9IjYiIGN5PSI2IiByPSIwLjY3Ij48L2NpcmNsZT4NCiAgICA8cGF0aCBkPSJNNC4yLDExLjNRMy4zLDExLjgsMy4zLDEwLjc1TDMuMyw0LjFRMy4zLDMuMSw0LjMsMy41TDEwLjQsNy4wUTEyLjAsNy41LDEwLjQsOC4wTDYuNjUsMTAuMEw2LjY1LDcuNzVhMC42NSwwLjY1LDAsMSwwLC0xLjMsMEw1LjM1LDEwLjc1YTAuOSwwLjksMCwwLDAsMS4zLDAuOEwxMi43LDguMlExMy43LDcuNSwxMi43LDYuN0wzLjMsMS42UTIuMiwxLjMsMS44LDIuNUwxLjgsMTIuNVEyLjIsMTMuOSwzLjMsMTMuM0w0LjgsMTIuNUEwLjMsMC4zLDAsMSwwLDQuMiwxMS4zWiI+PC9wYXRoPg0KICA8L3N2Zz4NCjwvc3ZnPg0K");background-size:15px 15px;background-repeat:no-repeat;background-position:100%;z-index:1}.teads-expand .teads-ui-components-adchoices.expanded:first-child,.teads-inread .teads-ui-components-adchoices.expanded:first-child{border-bottom-left-radius:8px;padding:1px 17px 1px 4px;background-color:hsla(0,0%,100%,.8)}.teads-expand .teads-ui-components-adchoices.expanded,.teads-inread .teads-ui-components-adchoices.expanded{width:auto;padding-right:19px}.teads-inread .teads-ui-components-adchoices span{display:none}.teads-expand .teads-ui-components-adchoices.expanded span,.teads-inread .teads-ui-components-adchoices.expanded span{display:inline}',""])},function(e,t,i){(e.exports=i(64)(void 0)).push([e.i,".teads-inread .teads-ui-components-hpl{position:absolute;left:-1000px;display:none;z-index:-100}",""])},function(e,t,i){(e.exports=i(64)(void 0)).push([e.i,'div.teads-display-absolute{position:absolute!important;overflow:hidden!important;z-index:99!important;pointer-events:none!important;background-repeat:repeat-y;background-attachment:fixed}.teads-display-fixed{position:fixed!important;background-repeat:repeat-y!important}.teads-display-clickzone{display:block!important;position:absolute!important;top:0!important;width:100%!important;height:100%!important}.teads-video-scroller{position:fixed;top:50%;transform:translateY(-50%)}div.teads-display-format{position:sticky;-webkit-position:sticky}div.teads-display-format .icon-close{background-size:650px 40px!important;background-image:url("{{assetsPath}}/default/player-sprite.svg")!important}div.teads-display-format .icon-close,div.teads-display-format .sm-screen .icon-close,div.teads-display-format .xs-screen .icon-close{width:11px!important;height:11px!important;background-position:-80px 0!important}div.teads-display-format .teads-ui-component-closebutton svg{display:none!important}div.teads-ui-component-closebutton .components-countdown{display:none!important;position:absolute!important;left:2px!important;bottom:20px!important}div.teads-display-format .teads-ui-component-closebutton .components-countdown .countdown-circle>li{color:#fff!important}div.teads-display-format .teads-ui-component-closebutton .components-countdown .show,div.teads-display-format .teads-ui-component-closebutton .show{display:block!important}div.teads-display-format .teads-ui-component-closebutton .show .close-button{opacity:.8!important}div.teads-display-format .teads-ui-component-closebutton .show:hover .close-button.show{opacity:1!important}div.teads-display-format .sm-screen .teads-ui-component-closebutton .closebutton,div.teads-display-format .xs-screen .teads-ui-component-closebutton .closebutton{padding:10px 10px 15px 15px!important}',""])},function(e,t,i){(e.exports=i(64)(void 0)).push([e.i,".teads-countdown,.teads-countdown-container{width:100%;height:100%}.teads-countdown-number{font-family:Helvetica,Arial,sans-serif!important;font-weight:300;font-size:30px}.teads-countdown-circle-background{opacity:.8;stroke-width:1px}.teads-countdown-circle{position:absolute;width:100px;height:100px}.teads-countdown-fsicon{width:20px;height:20px;position:absolute;top:10px;right:10px}.teads-countdown-background{background-color:#000;opacity:.6;width:100%;height:100%}.teads-countdown-clickzone{position:absolute;top:0;left:0;width:100%;height:100%}",""])},function(e,t,i){(e.exports=i(64)(void 0)).push([e.i,'.teads-inread .teads-ui-components-smart-header{margin-bottom:2px!important;height:21px}.teads-inread .teads-ui-components-smart-header .smart-header-content{position:absolute!important;right:0!important;background-color:#434343!important;padding:1px 6px 0}.smart-header-content .close-button-smart .icon-close{transition:.1s;-webkit-transition:.1s;-moz-transition:.1s;-o-transition:.1s;-ms-transition:.1s}.smart-header-content .adChoices-button-smart,.smart-header-content .close-button-smart,.smart-header-content .sound-button-smart{display:inline-block;cursor:pointer}.smart-header-content .adChoices-button-smart,.smart-header-content .close-button-smart{margin-right:5px}.smart-header-content .close-button-smart .icon-close{width:11px;height:11px;background-position:-80px 0;background-image:url("{{assetsPath}}/default/player-sprite.svg")}.smart-header-content .adChoices-button-smart{width:13px;height:13px;background:url("data:image/svg+xml;base64,PHN2Zw0KICB2ZXJzaW9uPSIxLjEiDQogIGJhc2VQcm9maWxlPSJmdWxsIg0KICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KICA8c3R5bGU+DQogICAgLyogPCFbQ0RBVEFbICovDQogICAgLmFkY2hvaWNlcyB7DQogICAgICB0ZXh0LXJlbmRlcmluZzogZ2VvbWV0cmljUHJlY2lzaW9uOw0KICAgICAgZmlsbC1vcGFjaXR5OiAxLjA7DQogICAgICBmaWxsOiAjRkZGOw0KICAgICAgc3Ryb2tlOiBub25lOw0KICAgIH0NCiAgICAvKiBdXT4gKi8NCiAgPC9zdHlsZT4NCiAgPHN2ZyBjbGFzcz0iYWRjaG9pY2VzIiB4PSIwcHgiPg0KICAgIDxjaXJjbGUgY3g9IjYiIGN5PSI2IiByPSIwLjY3Ij48L2NpcmNsZT4NCiAgICA8cGF0aCBkPSJNNC4yLDExLjNRMy4zLDExLjgsMy4zLDEwLjc1TDMuMyw0LjFRMy4zLDMuMSw0LjMsMy41TDEwLjQsNy4wUTEyLjAsNy41LDEwLjQsOC4wTDYuNjUsMTAuMEw2LjY1LDcuNzVhMC42NSwwLjY1LDAsMSwwLC0xLjMsMEw1LjM1LDEwLjc1YTAuOSwwLjksMCwwLDAsMS4zLDAuOEwxMi43LDguMlExMy43LDcuNSwxMi43LDYuN0wzLjMsMS42UTIuMiwxLjMsMS44LDIuNUwxLjgsMTIuNVEyLjIsMTMuOSwzLjMsMTMuM0w0LjgsMTIuNUEwLjMsMC4zLDAsMSwwLDQuMiwxMS4zWiI+PC9wYXRoPg0KICA8L3N2Zz4NCjwvc3ZnPg==")}.icon-muteoff{background-position:-390px 0}.icon-muteon{background-position:-445px 0}.icon-muteoff,.icon-muteon{width:16px;height:11px;background-image:url("{{assetsPath}}/default/player-sprite.svg")}',""])},function(e,t,i){(e.exports=i(64)(void 0)).push([e.i,".teads-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#000;opacity:0;cursor:pointer}",""])},function(e,t,i){(e.exports=i(64)(void 0)).push([e.i,".teads-inboard,.teads-inread{overflow:hidden;height:0;-webkit-transition:height .5s;-moz-transition:height .5s;-o-transition:height .5s;-ms-transition:height .5s;transition:height .5s;box-sizing:content-box}.teads-inboard.no-transition,.teads-inread.no-transition{-webkit-transition:none;-moz-transition:none;-o-transition:none;-ms-transition:none;transition:none}div.teads-inboard div:after,div.teads-inboard div:before,div.teads-inread div:after,div.teads-inread div:before{display:none!important}div.teads-inread.teads-display{margin-bottom:10px!important}div.teads-inread.teads-third-party-display{height:auto!important}",""])},function(e,t,i){var n=i(172);e.exports="string"==typeof n?n:n.toString()},function(e,t,i){(t=e.exports=i(64)(void 0)).i(i(173),""),t.i(i(174),""),t.push([e.i,".teads-ui-component-earlyclickoverlay,.teads-ui-component-fullscreenbutton{position:absolute;top:0;right:0;width:100%;height:100%;background:none}.fullscreen .teads-ui-component-fullscreenbutton,.fullscreen .teads-ui-component-fullscreenbutton .show{width:45px;height:45px;z-index:10!important}.teads-ui-component-fullscreenbutton .icon-collapse{display:none;margin-top:10px;margin-left:20px}.fullscreen .teads-ui-component-fullscreenbutton .icon-collapse{display:block}.fullscreen .teads-ui-component-closebutton .icon-close{display:none}",""])},function(e,t,i){(e.exports=i(64)(void 0)).push([e.i,'body{margin:0;padding:0;border:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-family:Helvetica,Arial,sans-serif!important;font-weight:300}#layout-video-component{width:100%;height:100%;position:relative}#vpaid-container{z-index:1;background-color:#000;position:relative}.teads-ui-component-progressbar{position:absolute;bottom:0;left:0}.teads-ui-component-progressbar .progress{height:3px;width:0;background-color:#86c3f7;transition:all .4s linear}.teads-ui-component-playpausebutton{position:absolute;bottom:10px;left:10px;width:20px;height:20px;background-image:url("{{assetsPath}}/default/img/play.png");background-position:0 0;background-repeat:no-repeat;background-size:contain;cursor:pointer}.teads-ui-component-playpausebutton.playing{background-image:url("{{assetsPath}}/default/img/pause.png")}.teads-ui-component-fullscreenbutton{position:absolute;bottom:5px;right:30px;width:16px;height:16px;background-image:url("{{assetsPath}}/default/img/fullscreen.png");background-position:0 0;background-repeat:no-repeat;background-size:contain;cursor:pointer}.teads-ui-component-progresstext{height:30px;margin:0 40px 0 60px;text-align:center;padding:4px}.teads-ui-component-skipbutton{position:absolute;bottom:40px;right:4px;width:100px;height:20px;font-family:Helvetica,Arial,sans-serif!important;background-color:#ccc;text-align:center;padding:4px;border:1px solid #000}.adchoices-icon{background:url("data:image/svg+xml;base64,PHN2Zw0KICB2ZXJzaW9uPSIxLjEiDQogIGJhc2VQcm9maWxlPSJmdWxsIg0KICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPg0KICA8c3R5bGU+DQogICAgLyogPCFbQ0RBVEFbICovDQogICAgLmFkY2hvaWNlcyB7DQogICAgICB0ZXh0LXJlbmRlcmluZzogZ2VvbWV0cmljUHJlY2lzaW9uOw0KICAgICAgZmlsbC1vcGFjaXR5OiAxLjA7DQogICAgICBmaWxsOiAjMDBhZWNkOw0KICAgICAgc3Ryb2tlOiBub25lOw0KICAgIH0NCiAgICAvKiBdXT4gKi8NCiAgPC9zdHlsZT4NCiAgPHN2ZyBjbGFzcz0iYWRjaG9pY2VzIiB4PSIwcHgiPg0KICAgIDxjaXJjbGUgY3g9IjYiIGN5PSI2IiByPSIwLjY3Ij48L2NpcmNsZT4NCiAgICA8cGF0aCBkPSJNNC4yLDExLjNRMy4zLDExLjgsMy4zLDEwLjc1TDMuMyw0LjFRMy4zLDMuMSw0LjMsMy41TDEwLjQsNy4wUTEyLjAsNy41LDEwLjQsOC4wTDYuNjUsMTAuMEw2LjY1LDcuNzVhMC42NSwwLjY1LDAsMSwwLC0xLjMsMEw1LjM1LDEwLjc1YTAuOSwwLjksMCwwLDAsMS4zLDAuOEwxMi43LDguMlExMy43LDcuNSwxMi43LDYuN0wzLjMsMS42UTIuMiwxLjMsMS44LDIuNUwxLjgsMTIuNVEyLjIsMTMuOSwzLjMsMTMuM0w0LjgsMTIuNUEwLjMsMC4zLDAsMSwwLDQuMiwxMS4zWiI+PC9wYXRoPg0KICA8L3N2Zz4NCjwvc3ZnPg0K")}.teads-ui-component-label{font-family:Helvetica,Arial,sans-serif!important;font-size:12px;color:#999;text-align:center;padding:3px 0;text-transform:uppercase;height:21px;line-height:21px;display:none}.fullscreen .teads-ui-component-label,.fullscreen .teads-ui-component-label.show{display:none!important}.teads-ui-component-credits{font-size:12px;color:#999;text-align:right;padding:3px 0;height:26px;line-height:26px;display:none}.fullscreen .teads-ui-component-credits,.fullscreen .teads-ui-component-credits.show{display:none!important}.sm-screen .teads-ui-component-label,.xs-screen .teads-ui-component-label{font-size:10px}.teads-ui-component-credits a{color:#999;text-decoration:none}.teads-ui-component-credits-blue{color:#79bbe9}.teads-ui-component-soundbutton{position:absolute;bottom:0;right:0;padding:13px 18px 18px 6px;cursor:pointer;display:none;opacity:0;transition:opacity 175ms linear}.teads-ui-component-soundbutton.show{display:block;opacity:.8}.teads-ui-component-soundbutton:hover{opacity:1}.teads-ui-component-closebutton{position:absolute;top:0;right:0;padding:15px;cursor:pointer;display:none;transition:opacity 175ms linear}.teads-ui-component-closebutton svg{display:none}.teads-ui-component-closebutton .countdown{display:none;position:absolute;left:2px;bottom:20px}.teads-ui-component-closebutton .countdown .countdown-circle>li{color:#fff}.teads-ui-component-closebutton .countdown.show{display:block}.fullscreen .teads-ui-component-closebutton .countdown.show{display:none!important}.teads-ui-component-closebutton.show{display:block}.teads-ui-component-closebutton.show .close-button{opacity:.8}.teads-ui-component-closebutton.show:hover .close-button.show{opacity:1}.sm-screen .teads-ui-component-closebutton .closebutton,.xs-screen .teads-ui-component-closebutton .closebutton{padding:10px 10px 15px 15px}.teads-ui-component-clickbutton{display:none;position:absolute;top:0;left:0;cursor:pointer;-webkit-transition:background-color .25s;transition:background-color .25s}.teads-ui-component-clickbutton .text{font-size:12px;white-space:nowrap;max-height:30px;text-align:center;background-color:rgba(0,0,0,.1);border:1px solid #fff;color:#fff;margin:10px;padding:6px 10px}.teads-ui-component-clickbutton .text:hover{background-color:rgba(0,0,0,.25)}.sm-screen .teads-ui-component-clickbutton .text,.xs-screen .teads-ui-component-clickbutton .text{margin:5px;padding:5px}.teads-ui-component-clicktoplay{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#000;cursor:pointer;display:none;z-index:10!important}.teads-ui-component-clicktoplay .icon-watchmore{position:absolute;top:50%;left:50%;margin-left:-8px;margin-right:-10px;opacity:.8;transition:opacity 175ms linear}.sm-screen .teads-ui-component-clicktoplay .icon-watchmore,.xs-screen .teads-ui-component-clicktoplay .icon-watchmore{margin-left:-5px;margin-right:-7px}.teads-ui-component-clicktoplay:hover .icon-watchmore{opacity:1}.teads-ui-component-endscreen{position:absolute;width:100%;height:100%;top:0;left:0;z-index:10!important;background-color:#000;text-align:center;word-spacing:nowrap;opacity:0;display:none;justify-content:center;align-items:center;transition:opacity 175ms ease}.teads-ui-component-endscreen.show{display:flex!important;opacity:1!important}.teads-ui-component-endscreen .adchoices{font-family:arial;font-size:11px;cursor:pointer;position:absolute;top:0;right:0;width:15px;height:15px;line-height:15px;padding:1px;border-bottom-left-radius:8px;background-size:15px 15px;background-repeat:no-repeat;background-position:100%}.teads-ui-component-endscreen .close-button:not(.hide)~.sm-screen .teads-ui-component-endscreen .adchoices,.teads-ui-component-endscreen .close-button:not(.hide)~.xs-screen .teads-ui-component-endscreen .adchoices{top:12px;right:30px}.teads-ui-component-endscreen .close-button:not(.hide)~.adchoices{top:14px;right:35px}.teads-ui-component-endscreen .adchoices.expanded{background-color:hsla(0,0%,100%,.8)!important}.teads-ui-component-endscreen .adchoices span{display:none}.teads-ui-component-endscreen .adchoices.expanded span{display:inline}.tea .teads-ui-component-endscreen .countdown .countdown-timer svg{opacity:0}.teads-ui-component-endscreen .countdown{position:absolute;bottom:18px;left:18px;color:#fff}.sm-screen .teads-ui-component-endscreen .countdown,.xs-screen .teads-ui-component-endscreen .countdown{bottom:5px;left:5px}.teads-ui-component-endscreen .close-button{position:absolute;top:0;right:0;padding:15px;cursor:pointer}.teads-ui-component-endscreen .button-container{position:absolute}.teads-ui-component-endscreen .button{display:block;width:100%;height:70px;margin-bottom:40px;cursor:pointer;transition:opacity 175ms ease}.sm-screen .teads-ui-component-endscreen .button{margin-bottom:15px!important;height:40px}.xs-screen .teads-ui-component-endscreen .button{margin-bottom:15px!important;height:32px}.xs-screen .teads-ui-component-endscreen .button.replay-button{margin-bottom:15px!important}.teads-ui-component-endscreen .button:last-child{margin-bottom:0!important}.teads-ui-component-endscreen.show .button{opacity:.8!important}.teads-ui-component-endscreen.show .button:hover{opacity:1!important}.teads-ui-component-endscreen.show .button.edge-touch-screen,.teads-ui-component-endscreen.show .button.edge-touch-screen:hover{opacity:.8!important}.teads-ui-component-endscreen .button .icon{float:left;border-radius:35px;border:2px solid #fff;border-color:#294355;height:66px;width:66px}.sm-screen .teads-ui-component-endscreen .button .icon{height:36px;width:36px}.xs-screen .teads-ui-component-endscreen .button .icon{display:flex;justify-content:center;align-items:center;border-width:1px;height:30px;width:30px}.teads-ui-component-endscreen .button .icon span{display:block;margin:18px 22px;height:30px;width:30px}.sm-screen .teads-ui-component-endscreen .button .icon span{margin:7px 10px;height:20px;width:16px}.xs-screen .teads-ui-component-endscreen .button .icon span{margin:0;height:20px;width:16px}.teads-ui-component-endscreen .button .text{float:left;line-height:70px;height:70px;font-size:23px;color:#294355;padding-left:25px}.sm-screen .teads-ui-component-endscreen .button .text{line-height:40px;height:40px;padding-left:20px;font-size:17px}.xs-screen .teads-ui-component-endscreen .button .text{line-height:30px;height:30px;font-size:14px;padding-left:15px}.teads-ui-component-endscreen .countdown{display:none;color:#294355}.teads-ui-component-uibutton.ui-invisible{text-decoration:line-through}.teads-ui-component-uibutton{position:absolute;bottom:5px;right:5px;width:16px;height:16px;text-align:center;vertical-align:middle;border:1px solid #000;color:#000;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:pointer;text-decoration:none;background-color:#fff;font-size:12px}@-webkit-keyframes load{0%{stroke-dashoffset:0}}@keyframes load{0%{stroke-dashoffset:0}}.countdown-circle{position:relative;display:inline-block;padding:0;margin:0;text-align:center}.countdown-circle>li:after{content:attr(data-countdown);position:absolute;width:100%;top:.3rem;left:0;font-size:1rem;text-align:center}.countdown-circle>li{display:inline-block;position:relative;text-align:center;color:#93a2ac;font-family:Helvetica,Arial,sans-serif!important;font-weight:100}.countdown-circle svg{width:30px;height:30px}.countdown-circle svg:nth-child(2){position:absolute;left:0;top:0;transform:rotate(-90deg);-webkit-transform:rotate(-90deg);-moz-transform:rotate(-90deg);-ms-transform:rotate(-90deg)}.countdown-circle svg:nth-child(2) path{fill:none;stroke-width:20;stroke-dasharray:629;stroke:#999;opacity:.9}.teads-ui-component-brandlogo{display:none;opacity:.8;cursor:pointer;position:absolute;bottom:0;left:0;margin-left:10px;margin-bottom:18px;webkit-transition:background-color .25s;transition:background-color .25s;width:20%;height:10%;max-height:50px;background-repeat:no-repeat;background-position-x:left;background-position-y:bottom;background-size:contain}.sm-screen .teads-ui-component-brandlogo,.xs-screen .teads-ui-component-brandlogo{margin-left:5px;width:30%;height:15%}.teads-ui-component-adchoices{font-family:arial;font-size:11px;cursor:pointer;position:absolute;top:0;right:0;line-height:15px;border-bottom-left-radius:8px;background-size:15px 15px;background-repeat:no-repeat;background-position:100%}.teads-ui-component-adchoices.expanded{width:auto;padding:1px 17px 1px 4px;background-color:hsla(0,0%,100%,.8)}.teads-ui-component-adchoices span{display:none}.teads-ui-component-adchoices.expanded span{display:inline}.teads-ui-component-closebutton:not(.hide)~.teads-ui-component-adchoices{top:14px;right:35px}.sm-screen .teads-ui-component-closebutton:not(.hide)~.teads-ui-component-adchoices,.xs-screen .teads-ui-component-closebutton:not(.hide)~.teads-ui-component-adchoices{top:12px;right:30px}.fullscreen .teads-ui-component-adchoices,.fullscreen .teads-ui-component-adchoices.show{display:none!important}.teads-ui-component-startscreen{width:100%;height:100%;position:absolute;-webkit-box-shadow:inset 0 0 85px rgba(0,0,0,.1);-moz-box-shadow:inset 0 0 85px rgba(0,0,0,.1);box-shadow:inset 0 0 85px rgba(0,0,0,.1);background-color:#fff}.teads-ui-component-bannervideobottom .container{z-index:1000;position:absolute;bottom:0;width:100%;height:81px;display:flex;justify-content:center;align-items:center;box-sizing:border-box;border:1px solid #dfe6e9;border-width:0 1px 1px;background-color:#fff;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;cursor:pointer}.teads-ui-component-bannervideobottom .cta{overflow:hidden;text-decoration:none;display:block;background-color:#03a9f4;white-space:nowrap;text-align:center;color:#fff;padding:12px;border-radius:4px;transition:.4s}.teads-ui-component-bannervideobottom .cta:hover{background-color:#027fb7}.show{display:block!important}.show:hover{opacity:1!important}.hide{display:none;opacity:0}',""])},function(e,t,i){(e.exports=i(64)(void 0)).push([e.i,'.icon-book{width:26px;height:29px;background-position:0 0}.sm-screen .icon-book,.xs-screen .icon-book{width:18px;height:20px;background-position:-35px 0}.icon-close{width:15px;height:15px;background-position:-60px 0}.sm-screen .icon-close,.xs-screen .icon-close{width:11px;height:11px;background-position:-80px 0}.icon-closeendscreen{width:15px;height:15px;background-position:-100px 0}.sm-screen .icon-closeendscreen,.xs-screen .icon-closeendscreen{width:11px;height:11px;background-position:-120px 0}.icon-collapse{width:15px;height:15px;background-position:-140px 0}.icon-contact{width:28px;height:23px;background-position:-160px 0}.sm-screen .icon-contact,.xs-screen .icon-contact{width:20px;height:16px;background-position:-195px 0}.icon-download{width:20px;height:25px;background-position:-220px 0}.sm-screen .icon-download,.xs-screen .icon-download{width:14px;height:17px;background-position:-245px 0}.icon-learnmore{width:23px;height:28px;background-position:-305px 0}.sm-screen .icon-learnmore,.xs-screen .icon-learnmore{width:17px;height:20px;background-position:-335px 0}.icon-muteoff{width:22px;height:15px;background-position:-360px 0}.sm-screen .icon-muteoff,.xs-screen .icon-muteoff{width:16px;height:11px;background-position:-390px 0}.icon-muteon{width:22px;height:15px;background-position:-415px 0}.sm-screen .icon-muteon,.xs-screen .icon-muteon{width:16px;height:11px;background-position:-445px 0}.icon-replay{width:23px;height:29px;background-position:-470px 0}.sm-screen .icon-replay,.xs-screen .icon-replay{width:16px;height:20px;background-position:-500px 0}.icon-shop{width:29px;height:29px;background-position:-525px 0}.sm-screen .icon-shop,.xs-screen .icon-shop{width:20px;height:20px;background-position:-560px 0}.icon-signup{width:26px;height:31px;background-position:-585px 0}.sm-screen .icon-signup,.xs-screen .icon-signup{width:18px;height:22px;background-position:-620px 0}.icon-watchmore{width:16px;height:20px;background-position:-645px 0}.sm-screen .icon-watchmore,.xs-screen .icon-watchmore{width:11px;height:14px;background-position:-670px 0}.icon-book,.icon-close,.icon-closeendscreen,.icon-collapse,.icon-contact,.icon-download,.icon-learnmore,.icon-muteoff,.icon-muteon,.icon-replay,.icon-shop,.icon-signup,.icon-watchmore{background-size:690px 40px}.no-svg .icon-book,.no-svg .icon-close,.no-svg .icon-closeendscreen,.no-svg .icon-collapse,.no-svg .icon-contact,.no-svg .icon-download,.no-svg .icon-learnmore,.no-svg .icon-muteoff,.no-svg .icon-muteon,.no-svg .icon-replay,.no-svg .icon-shop,.no-svg .icon-signup,.no-svg .icon-watchmore{background-image:url("{{assetsPath}}/default/player-sprite.png")}.icon-book,.icon-close,.icon-closeendscreen,.icon-collapse,.icon-contact,.icon-download,.icon-learnmore,.icon-muteoff,.icon-muteon,.icon-replay,.icon-shop,.icon-signup,.icon-watchmore{background-image:url("{{assetsPath}}/default/player-sprite.svg")}',""])},function(e,t,i){i.r(t);i(152);const n=window.teads||{};n.vpaid=n.vpaid||{},window.teads=n},function(e,t,i){i.r(t);var n=i(105),s=i(121),r=i(102);const a=window.teads||{};a.instances=a.instances||r.e,a.tagManagerResourcesList=n.e,a.clearInstances=r.b,a.destroyPageRelatedVariables=r.c,a.loadAd=n.d,a.isNoAd=n.b,a.isSameAd=s.b,a.cleanup=r.a;const o=window.teads||{};o.helper=o.helper||{},window.teads=o,Object(r.d)()},,,,,,,,,,,,,,,function(module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,"a",(function(){return Selector}));var funnel_option_AbstractOption__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(18),common_FormatException__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(46),common_Context__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3),common_Dom__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(6),common_ArrayHelper__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1),common_HTMLHelper__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(10),common_Utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(2),funnel_placement_Slot__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(120);class Selector extends funnel_option_AbstractOption__WEBPACK_IMPORTED_MODULE_0__.a{constructor(e,t){if(super("Selector"),this.value=e,this.win=t,this.default=null,this.screenSizes={mobile:"[WIDTH]<768",tablet:"[WIDTH]>=768 && [WIDTH]<992",desktop:"[WIDTH]>=992 && [WIDTH]<1200",large:"[WIDTH]>=1200"},!t)throw new common_FormatException__WEBPACK_IMPORTED_MODULE_1__.a(common_FormatException__WEBPACK_IMPORTED_MODULE_1__.a.OPTION_PARENTWINDOW_INVALID);this.checkValue()}checkValue(){Object(common_Utils__WEBPACK_IMPORTED_MODULE_6__.isString)(this.value)||common_Dom__WEBPACK_IMPORTED_MODULE_3__.isHTMLElement(this.value)||common_Dom__WEBPACK_IMPORTED_MODULE_3__.isNodeList(this.value)||common_Dom__WEBPACK_IMPORTED_MODULE_3__.isISlotSelector(this.value,this.screenSizes)||(this.value=this.default)}get(){return this.value}getSlots(){const e=[];let t=this.value;if(common_Dom__WEBPACK_IMPORTED_MODULE_3__.isISlotSelector(this.value,this.screenSizes)){let e;for(const i in this.value)if(this.value.hasOwnProperty(i)&&(e=this.checkScreenSelector(i,this.win),e)){t=this.value[i];break}e?this.logger.debug("Slot",e,"selected:",t):this.logger.warn("Slots by device not found: ",this.value)}if(Object(common_Utils__WEBPACK_IMPORTED_MODULE_6__.isString)(t)&&t){let i=[];const n=common_HTMLHelper__WEBPACK_IMPORTED_MODULE_5__.findAllWindows(document.body);common_ArrayHelper__WEBPACK_IMPORTED_MODULE_4__.forEach(n,e=>{Object(common_Utils__WEBPACK_IMPORTED_MODULE_6__.isString)(t)&&(i=i.concat(common_Dom__WEBPACK_IMPORTED_MODULE_3__.querySelectorAll(t,e)))});for(let t=0;t<i.length;t++)e.push(new funnel_placement_Slot__WEBPACK_IMPORTED_MODULE_7__.a(i[t],t))}else if(common_Dom__WEBPACK_IMPORTED_MODULE_3__.isHTMLElement(t))e.push(new funnel_placement_Slot__WEBPACK_IMPORTED_MODULE_7__.a(t));else if(common_Dom__WEBPACK_IMPORTED_MODULE_3__.isNodeList(t))for(let i=0;i<t.length;i++)e.push(new funnel_placement_Slot__WEBPACK_IMPORTED_MODULE_7__.a(t[i],i));return e.length||!Object(common_Context__WEBPACK_IMPORTED_MODULE_2__.isAmp)()&&!Object(common_Context__WEBPACK_IMPORTED_MODULE_2__.isIABSafeFrame)()||e.push(new funnel_placement_Slot__WEBPACK_IMPORTED_MODULE_7__.a(this.win.document.body)),e}checkScreenSelector(screen,win){let selectedScreenSelector=null;const currentWidth=Math.max(win.document.documentElement.clientWidth,win.innerWidth||0);return common_ArrayHelper__WEBPACK_IMPORTED_MODULE_4__.forEach(screen.split("+"),screenSelector=>{if(this.screenSizes[screenSelector])try{const screenSelectorPattern=this.screenSizes[screenSelector].replace(/\[WIDTH\]/g,currentWidth);if(eval(screenSelectorPattern))return void(selectedScreenSelector=screenSelector)}catch(e){this.logger.warn("screenSelector eval has failed")}}),selectedScreenSelector}}},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,"a",(function(){return AbstractSelector}));var funnel_option_AbstractOption__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(18),common_ArrayHelper__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1);class AbstractSelector extends funnel_option_AbstractOption__WEBPACK_IMPORTED_MODULE_0__.a{constructor(e){super(e),this.screenSizes={mobile:"[WIDTH]<768",tablet:"[WIDTH]>=768 && [WIDTH]<992",desktop:"[WIDTH]>=992 && [WIDTH]<1200",large:"[WIDTH]>=1200"}}checkScreenSelector(screen,win){var selectedScreenSelector=null,currentWidth=Math.max(win.document.documentElement.clientWidth,win.innerWidth||0);return common_ArrayHelper__WEBPACK_IMPORTED_MODULE_1__.forEach(screen.split("+"),screenSelector=>{if(this.screenSizes[screenSelector])try{var screenSelectorPattern=this.screenSizes[screenSelector].replace(/\[WIDTH\]/g,""+currentWidth);if(eval(screenSelectorPattern))return void(selectedScreenSelector=screenSelector)}catch(e){this.logger.warn("screenSelector eval has failed")}}),selectedScreenSelector}}},,,,,,,,,,,,,,,,,function(e,t,i){e.exports=i(217)},function(e,t){const i=window.teads||{};i.vastDomains=[],i.gdprPayload={},window.teads=i},,,,,,,function(e,t,i){i.r(t);i(210),i(109),i(176),i(175);const n=window.teads||{};n.player=n.player||{},window.teads=n;var s=i(50),r=i(116),a=i(1),o=i(58),d=i(3),c=i(6),l=i(85),h=i(66),u=i(46),p=i(5),g=i(0),m=i(8),b=i(25),f=i(9),v=i(12),A=i(48),y=i(23),w=i(15),E=i(2),O=i(105),C=i(140),I=i(28),S=i(26);function T({ccpaIab:e}){return g.b.fromNullable(e).filter(e=>Object(E.isObject)(e)&&Object(E.hasOwnProperty)(e,"consent")&&Object(E.isString)(e.consent))}var k=i(129),j=i(21);var P=i(62),L=i(118),x=i(10),V=i(37),N=i(40),D=i(76);function _(e){return g.b.fromNullable(null==e?void 0:e.headerBiddingProvider).filter(E.isString)}const R=()=>({type:"Timeout",reason:230,status:23,consent:"",apiVersion:Object(g.c)(2),cmpId:g.a}),M=(e,t,i,n=Object(g.c)(2))=>({type:"Error",message:e,reason:t,status:i,consent:"",apiVersion:n,cmpId:g.a}),F=e=>e.map(e=>{switch(e){case"cmpuishown":return 121;case"tcloaded":return 126;case"useractioncomplete":return 125;default:return 120}}).getOrValue(120),U=new f.a("IAB TCF v2");function B(e,t,i,n,s){p.a.tryCatch(()=>e.call(null,t,i,n,s)).fold(e=>U.error("Calling __tcfapi function threw an exception",e),()=>U.debug("Successfully called __tcfapi function"))}const W=e=>Object(E.hasOwnProperty)(e,"cmpLoaded")&&Object(E.isBoolean)(e.cmpLoaded),H=e=>Object(E.hasOwnProperty)(e,"gdprApplies")&&(Object(E.isUndefined)(e.gdprApplies)||Object(E.isBoolean)(e.gdprApplies)),z=e=>Object(E.hasOwnProperty)(e,"cmpStatus")&&Object(E.isString)(e.cmpStatus)&&Object(a.includes)(["loading","error","loaded","stub"],e.cmpStatus.toLowerCase());var G=e=>g.b.fromNullable(e).match({none:()=>Object(p.c)("Expected pingReturn to be an object but got null or undefined"),some:e=>Object(p.d)(e)}).filterOrElse(E.isObject,e=>"Expected pingReturn to be an object but got "+typeof e).filterOrElse(W,e=>"Expected pingReturn to have a valid cmpLoaded but got "+e.cmpLoaded).filterOrElse(H,e=>"Expected pingReturn to have a valid gpdrApplies but got "+e.gdprApplies).filterOrElse(z,()=>"Expected pingReturn to have a valid cmpStatus but got "+e.cmpStatus);const q=e=>Object(E.hasOwnProperty)(e,"gdprApplies")&&(Object(E.isUndefined)(e.gdprApplies)||Object(E.isBoolean)(e.gdprApplies)),K=e=>Object(E.hasOwnProperty)(e,"tcString")&&Object(E.isString)(e.tcString);var $=e=>g.b.fromNullable(e).match({none:()=>Object(p.c)("Expected tcData to be an object but got null or undefined"),some:e=>Object(p.d)(e)}).filterOrElse(E.isObject,e=>"Expected tcData to be an object but got "+typeof e).filterOrElse(q,e=>"Expected tcData to contain gdprApplies but got "+e.gdprApplies).flatMap(e=>e.gdprApplies?Object(p.d)(e).filterOrElse(K,e=>"Expected tcData to contain a valid tcString but got "+e.tcString):Object(p.d)(e));var Y=i(35);const X=(e,t)=>new Promise(i=>{var n;(n=e,n()?Object(p.d)(n()):Object(p.c)("Couldn't find tcfApi in given context")).fold(e=>i(M(e,220,22,g.a)),n=>(e=>Object(E.isFunction)(e)?Object(p.d)(e):Object(p.c)("Expected __tcfapi to be a valid function but got "+typeof e))(e()).fold(e=>i(M(e,240,21)),n=>{const s=Object(Y.d)(()=>i(R()),t+10);B(e(),"ping",2,n=>{G(n).fold(n=>{s.clear(),t-10<=0?i(M(n,240,21)):Object(Y.d)(()=>{i(X(e,t-50))},50)},n=>{s.clear(),"stub"===n.cmpStatus?Q(e,i,t):J(e,i,t)})})}))}),Q=(e,t,i)=>{const n=Object(Y.d)(()=>t(R()),i);B(e(),"addEventListener",2,s=>$(s).flatMap(n=>(Object(Y.d)(()=>{B(e(),"removeEventListener",2,E.noop,n.listenerId),t(R())},i),Object(p.d)(n))).fold(e=>{n.clear(),t(M(e,240,21))},e=>{switch(n.clear(),e.gdprApplies){case!0:return t((i=e.tcString,s=e.cmpId,r=e.eventStatus,{type:"AddEventListener",consent:i,reason:F(g.b.fromNullable(r)),status:12,apiVersion:Object(g.c)(2),cmpId:Object(g.c)(s)}));case!1:return t((e=>({type:"AddEventListenerDoesNotApply",reason:0,status:0,consent:"",apiVersion:Object(g.c)(2),cmpId:Object(g.c)(e)}))(e.cmpId));default:return t({type:"AddEventListenerUnknown",reason:250,status:25,consent:"",apiVersion:Object(g.c)(2),cmpId:g.a})}var i,s,r}))},J=(e,t,i)=>B(e(),"getTCData",2,n=>$(n).fold(e=>t(M(e,240,21)),n=>{switch(n.gdprApplies){case!0:return t((s=n.tcString,r=n.cmpId,a=n.eventStatus,{type:"GetTCData",consent:s,reason:F(g.b.fromNullable(a)),status:12,apiVersion:Object(g.c)(2),cmpId:Object(g.c)(r)}));case!1:return t((e=>({type:"GetTCDataDoesNotApply",reason:0,status:0,consent:"",apiVersion:Object(g.c)(2),cmpId:Object(g.c)(e)}))(n.cmpId));default:return Q(e,t,i)}var s,r,a})),Z=(e,t)=>p.a.tryCatch(()=>e(t)).fold(e=>Object(p.c)("Error while trying to evaluate the predicate."),i=>i?Object(p.d)(t):Object(x.isChildWindow)(t)?Z(e,t.parent):Object(p.c)("Could not find any window matching the predicate.")),ee=e=>Object(E.isObject)(e)&&Object(E.hasOwnProperty)(e,"__tcfapiReturn")&&Object(E.isObject)(e.__tcfapiReturn)&&Object(E.hasOwnProperty)(e.__tcfapiReturn,"returnValue")&&Object(E.hasOwnProperty)(e.__tcfapiReturn,"success")&&Object(E.hasOwnProperty)(e.__tcfapiReturn,"callId"),te=(e,t,i)=>g.b.fromNullable(i).filter(t=>t.source===e).map(({data:e})=>e).filter(ee).map(({__tcfapiReturn:e})=>e).filter(({callId:e})=>e===t),ie=(e,t,i,n)=>s=>te(t,i,s).forEach(({success:s,returnValue:r})=>{n(s?r:void 0,s),Object(c.removeEventListener)("message",e,ie(e,t,i,n))}),ne=(e,t,i,n)=>s=>te(t,i,s).forEach(({success:s,returnValue:r})=>{n(s?r:void 0),Object(c.removeEventListener)("message",e,ne(e,t,i,n))}),se=(e,t,i,n)=>s=>te(t,i,s).forEach(({success:s,returnValue:r})=>{n(s?r:void 0,s),Object(c.removeEventListener)("message",e,se(e,t,i,n))}),re=(e,t,i,n)=>s=>te(t,i,s).forEach(({success:s})=>{n(s),Object(c.removeEventListener)("message",e,re(e,t,i,n))});const ae=({success:e,returnValue:t})=>{return{success:e,usPrivacyString:(i=t,Object(E.isObject)(i)&&i.hasOwnProperty("version")&&i.hasOwnProperty("uspString")&&Object(E.isString)(i.uspString)?g.b.of(t.uspString):Object(E.isString)(t)?g.b.of(t):g.a)};var i},oe=e=>g.b.fromNullable(e.frames.__uspapiLocator).nonEmpty(),de=(e,t)=>p.a.tryCatch(()=>e(t)).fold(e=>Object(p.c)("Error while trying to evaluate the predicate."),i=>i?Object(p.d)(t):Object(x.isChildWindow)(t)?de(e,t.parent):Object(p.c)("Could not find any window matching the predicate.")),ce=e=>Object(E.isObject)(e)&&Object(E.isObject)(e.__uspapiReturn)&&e.__uspapiReturn.hasOwnProperty("returnValue")&&e.__uspapiReturn.hasOwnProperty("success")&&e.__uspapiReturn.hasOwnProperty("callId"),le=(e,t)=>new Promise(i=>{const n=Object(Y.d)(()=>i({_tag:"timeout"}),t,Y.a.Standard);g.b.fromNullable(e).filter(E.isFunction).match({none:()=>(n.clear(),i({_tag:"not-found"})),some:e=>e("getUSPData",1,(e,t)=>{n.clear(),i(t?{_tag:"successful",usPrivacyString:e.uspString}:{_tag:"unsuccessful"})})})}),he=({onLocatorNotFound:e,onUnsuccessful:t,onSuccessful:i,onTimeout:n})=>s=>{switch(s._tag){case"not-found":return e();case"timeout":return n();case"unsuccessful":return t();case"successful":return i(s.usPrivacyString);default:Object(E.noop)()}},ue=(e,t,i)=>p.a.tryCatch(()=>new Promise(n=>{de(oe,e).fold(e=>n({_tag:"not-found"}),s=>{const r=Object(v.rand)(10),a=({data:t,source:i})=>{i===s&&g.b.of(t).filter(ce).map(({__uspapiReturn:e})=>e).filter(({callId:e})=>e===r).map(ae).forEach(({success:t,usPrivacyString:i})=>{Object(c.removeEventListener)("message",e,a),t?i.match({some:e=>n({_tag:"successful",usPrivacyString:e}),none:()=>n({_tag:"malformed-response"})}):n({_tag:"unsuccessful"})})};Object(Y.d)(()=>{p.a.tryCatch(()=>{Object(c.removeEventListener)("message",e,a),n({_tag:"timeout"})}).tapLeft(e=>i.forEach(t=>t.error("ccpa-error 1 "+e,1)))},t,Y.a.Standard,i),Object(c.addEventListener)("message",e,a),s.postMessage({__uspapiCall:{command:"getUSPData",parameter:void 0,version:1,callId:r}},"*")})})).fold(e=>(i.forEach(t=>t.error("ccpa-error 2 "+e,1)),Promise.resolve({_tag:"unsuccessful"})),e=>e),pe=({onLocatorNotFound:e,onTimeout:t,onUnsuccessful:i,onMalformedResponse:n,onSuccessful:s})=>r=>{switch(r._tag){case"not-found":return e();case"timeout":return t();case"unsuccessful":return i();case"malformed-response":return n();case"successful":return s(r.usPrivacyString);default:Object(E.noop)()}};var ge=i(31);const me=Object(ge.a)((e,t)=>{if(Object(E.hasOwnProperty)(t,"placementMetadata")){const i=t.placementMetadata;if(Object(E.isObject)(i)&&Object(E.isObject)(i[e])){const{adCallTrackingUrl:t,auctionId:n}=i[e];return Object(g.c)({adCallTrackingUrl:g.b.fromNullable(t).filter(E.isString),auctionId:g.b.fromNullable(n).filter(l.a)})}}return g.a}),be=e=>{if(Object(E.hasOwnProperty)(e,"wigo")){const t=e.wigo;if(Object(E.isObject)(t)&&Object(E.hasOwnProperty)(t,"reportEvent")&&Object(E.hasOwnProperty)(t,"reportName")){const{reportEvent:e,reportName:i}=t;if(Object(E.isString)(e)&&Object(E.isString)(i))return Object(g.c)({reportEvent:e,reportName:i})}}return g.a};var fe=i(34),ve=i(125),Ae=i(24),ye=i(73);const we=e=>Object(E.isArray)(e)&&e.every(e=>Object(E.isString)(e)&&Object(E.isNumber)(parseInt(e,10))),Ee=e=>p.a.tryCatch(()=>e.localStorage.getItem("_pdfps")).toOption().flatMap(e=>p.a.tryCatch(()=>V.a(e)).toOption()).filter(we),Oe=(e,t,i,n,s)=>((e,t)=>g.b.fromNullable(t.teadsPermutive).existsIf(t=>t[e]))(e,t)?Object(m.b)(n?Ee(t.top).orElse(()=>Ee(t)):Ee(t),g.d.fold(()=>(i.info(`permutive ${s} N/A`),g.a),e=>(i.info(`permutive ${s} ${e.length}`),Object(g.c)(e)))):g.a,Ce=e=>e.match({some:e=>({us_privacy:e}),none:()=>({})}),Ie=e=>{var t,i;return g.b.fromPredicate(null===(i=null===(t=null==e?void 0:e.settings)||void 0===t?void 0:t.values)||void 0===i?void 0:i.placementId,E.isNumber)};class Se{constructor(e,t,i,n,s,r,a,o,d){this.placementAd=e,this.pageId=t,this.initialAuctionId=i,this.initialViewerId=n,this.markId=r,this.sumologicLogger=a,this.done=d,this.logger=new f.a("helper.RASRequest"),this.timeoutFired=!1,this.requestIsSent=!1,this.rasRequestIsInitialized=!1,this.sendAfterInit=!1,this.gdprIabObject=g.a,this.uspString=g.a,this.fraudReason=g.b.empty(),this.adCallTrackingUrl=g.b.empty(),this.rasAuctionId=g.a,this.viewerId=g.a,this.mrgReason=g.a,_(e.ad).filter(e=>"debugFormat"!==e).match({some:()=>this.onHeaderBidding(r),none:()=>this.onNonHeaderBidding(o,r,s,e.placement.pid)})}initRequest(e,t,i,n){if(this.rasRequestIsInitialized)this.logger.warn("Could not initialize RASRequest instance as it is already initialized.");else{if(Object(y.i)({name:"g",id:this.markId}),!this.placementAd.ad&&I.b.isRichAdServerRequestEnabled){const s=Object.assign(Object.assign({},t),{gdpr_iab:Object(k.b)(t.gdpr_iab)}),r=d.getClientSideDeviceProperties(),a=Object.assign(Object.assign(Object.assign(Object.assign({page:encodeURIComponent(V.b(s))},this.initialAuctionId.map(e=>({auctid:e})).getOrValue({})),n?{hdlsb:""}:{}),{formatVersion:encodeURIComponent("822"),env:d.getEnv()}),r.map(encodeURIComponent).map(e=>({clientSideDeviceProperties:e})).getOrValue({}));d.getNetworkBandwidthInMbps().forEach(e=>a.netBw=e),Object(y.g)().forEach(e=>a.ttfb=e),i.forEach(e=>{a.cohortId=encodeURIComponent(e.cohortId),e.cohortVersion.forEach(e=>{a.cohortVersion=encodeURIComponent(e)})}),this.rasUrl=Object(w.c)(e,a),this.request=N.a(),this.request.open("GET",this.rasUrl,!0),this.request.withCredentials=!0,this.request.timeout=I.b.richAdServerRequestTimeout,this.request.setRequestHeader&&this.request.setRequestHeader("Accept","application/json; charset=UTF-8"),this.request.onload=()=>{this.onload()},this.request.onerror=(e={})=>{this.onerror(e)},this.request.ontimeout=()=>this.ontimeout(),this.timeoutLatencyRAS=setTimeout(()=>this.ontimeout(),I.b.richAdServerRequestTimeout+10)}this.rasRequestIsInitialized=!0}}send(){if(!this.rasRequestIsInitialized)return this.sendAfterInit=!0,void this.logger.debug("Could not send ad request as RASRequest instance is not initialized yet.");const e=()=>{if(this.placementAd.ad)Object(y.i)({name:"j",id:this.markId}),this.next();else if(I.b.isRichAdServerRequestEnabled)this.requestIsSent||(Object(y.i)({name:"h",id:this.markId}),this.request.send()),this.requestIsSent=!0;else{let e;Object(y.i)({name:"j",id:this.markId}),a.forEach(window._tta[this.pageId],t=>{Ie(t).match({some:e=>{this.placementAd.placement.pid===e&&(this.placementAd.ad=t)},none:()=>{this.logger.warn(`Trying to process _tta object but could not find the related _ttp object (PID: ${e})`,this.placementAd.placement,t)}})}),this.next()}};this.getAdPromiseFromWigo().match({some:t=>t.then(e=>{this.logger.warn("ad has been successfully loaded from a WIGO report",e),this.placementAd.ad=e,D.b.isCeltraParameterSet(Object(w.h)())&&(this.placementAd.ad.portfolio_item_id=36),this.placementAd.placement.wigo.enableWigo("enableFromReport"),this.next()}).catch(t=>{this.logger.error("ad Promise from WIGO failed",t),e()}),none:e})}onHeaderBidding(e){var t,i;this.logger.debug("Header Bidding detected: did not try to retrieve CCPA US Privacy string and GDPR consent string as it's been done in the Prebid adapter."),this.sumologicLogger.info("ccpa-iab-consent "+g.b.fromNullable(null===(t=this.placementAd.ad)||void 0===t?void 0:t.ccpaIab).match({some:()=>"1",none:()=>"0"}),40),this.sumologicLogger.info("gdpr-iab-consent "+g.b.fromNullable(null===(i=this.placementAd.ad)||void 0===i?void 0:i.gdprIab).match({some:()=>"1",none:()=>"0"}),40),Object(y.i)({name:"f",id:e}),Object(y.i)({name:"g",id:e}),this.rasRequestIsInitialized=!0,this.send()}onNonHeaderBidding(e,t,i,n){const s=this.fetchUSPrivacyString(50),r=this.fetchGdprConsent(),a=this.getPermutiveSegments(n);r.then(t=>{s.then(n=>this.makeAdRequest(e,i)(t,n,a))})}getPermutiveSegments(e){const t=this.sumologicLogger;return Oe(e,window,t,Object(x.isChildWindow)(window)&&!Object(x.isInCrossDomainIframe)(window.document.body),(e=>Object(m.b)(Object(w.f)(e),g.d.flatMap(e=>g.b.fromNullable(e.windowReferrerUrl)),g.d.map(w.p),g.d.map(e=>e.hostname),g.d.getOrValue("N/A")))(t))}fetchUSPrivacyString(e){return p.a.tryCatch(()=>{const t=this.sumologicLogger,i=pe({onLocatorNotFound:()=>(this.logger.debug("No parent window with a child iframe named __uspapiLocator was found"),t.info("ccpa-iab-consent 0 2",10),g.a),onTimeout:()=>(this.logger.debug("Timeout reached when trying to retrieve US Privacy string via iframes"),t.info("ccpa-iab-consent 0 3",10),g.a),onUnsuccessful:()=>(this.logger.debug("Could not successfully retrieve US Privacy string via iframes"),t.info("ccpa-iab-consent 0 4",10),g.a),onMalformedResponse:()=>(this.logger.debug("Got a malformed response for US Privacy string via iframes"),t.info("ccpa-iab-consent 0 5",10),g.a),onSuccessful:e=>(this.logger.debug("Got a US Privacy string via iframes: "+e),t.info("ccpa-iab-consent 1 1",10),Object(g.c)(e))}),n=he({onTimeout:()=>(this.logger.debug("Timeout reached when trying to retrieve US Privacy string via iframes"),t.info("ccpa-iab-consent 0 3",10),g.a),onLocatorNotFound:()=>(this.logger.debug("__uspapi value provided is not a function, fallback to iframe mechanism",window.__uspapi),t.info("ccpa-iab-consent 0 2",10),g.a),onUnsuccessful:()=>(this.logger.warn("Calling __uspapi with getUSPData command was unsuccessful"),t.info("ccpa-iab-consent 0 0",10),g.a),onSuccessful:e=>(this.logger.debug("Got a US Privacy string by calling __upsapi: "+e),t.info("ccpa-iab-consent 1 0",10),Object(g.c)(e))});return Object(x.isInCrossDomainIframe)(document.body)||Object(x.isChildWindow)(window)?ue(window,e,Object(g.c)(t)).then(i):le(window.__uspapi,e).then(n)}).fold(e=>(ve.a.error("ccpa-error 0 "+e,1),Promise.resolve(g.a)),e=>e)}fetchGdprConsent(){if(d.isAmp())return Promise.resolve(Object(ye.c)());const e=new L.a(Object(x.findTopWindow)(window.document.body),this.pageId),t=Object(x.isInCrossDomainIframe)(document.body)||Object(x.isChildWindow)(window),i=e.requestConsentString();return(()=>{const e=({consent:e,status:t,reason:i,apiVersion:n,cmpId:s})=>({status:t,consent:e,reason:i,apiVersion:n,cmpId:s});return Z(t?e=>g.b.fromNullable(e.frames.__tcfapiLocator).nonEmpty():e=>g.b.fromNullable(e.__tcfapi).nonEmpty(),window).fold(t=>new Promise(e=>e(M(t,220,22,g.a))).then(e),i=>{if(t){const t=(n=i,s=window,(e,t,i,r)=>{const a=Object(v.rand)(10),o={__tcfapiCall:{command:e,parameter:r,version:t,callId:a}};let d;switch(e){case"removeEventListener":d=re(s,n,a,i);break;case"ping":d=ne(s,n,a,i);break;case"getTCData":d=ie(s,n,a,i);break;case"addEventListener":d=se(s,n,a,i)}Object(c.addEventListener)("message",s,d),n.postMessage(o,"*")});return X(()=>t,250).then(e)}return X(()=>window.__tcfapi,250).then(e);var n,s})})().then(e=>22===e.status?Promise.reject():(L.a.updateTeadsGDPRPayload(e),e)).catch(e=>i.then(e=>(22===e.status&&(e.apiVersion=g.a),L.a.updateTeadsGDPRPayload(e),e)))}makeAdRequest(e,t){return(i,n,s)=>{const{status:r,consent:a}=i;Object(fe.l)({placementKey:this.placementAd.placement.key,gdprStatus:r,gdprConsent:a}),this.gdprIabObject=g.b.fromNullable(i),this.uspString=n;const o=Object.assign(Object.assign({id:this.pageId,placements:[this.placementAd.report],gdpr_iab:i},Ce(n)),{segments:{permutive:s.getOrNull()}});d.getCohort().then(i=>{this.initRequest(e,o,i,t),this.sendAfterInit&&!this.requestIsSent&&this.send()}),this.sumologicLogger.info("gdpr-iab-consent "+(i.consent?"1":"0"),40)}}getAdPromiseFromWigo(){return g.b.fromNullable(D.b.reportPromise).map(e=>e.then(e=>this.getAdFromWigoReport(e).match({some:e=>Promise.resolve(e),none:()=>Promise.reject("ad not available in the report")})))}getAdFromWigoReport(e){return g.b.fromNullable(e.steps).map(e=>a.filter(e,e=>0===e.step&&1===e.substep)).filter(a.isNotEmpty).map(e=>e.pop()).flatMap(e=>p.a.tryCatch(()=>Object(E.isString)(e.info.store)?V.a(e.info.store):e.info.store).toOption()).flatMap(e=>g.b.fromNullable(e.tta)).map(e=>(e[this.pageId]&&Object(E.isArray)(e[this.pageId])&&(e=e[this.pageId].shift()),e.handled=!1,e))}next(){this.timeoutLatencyRAS&&clearTimeout(this.timeoutLatencyRAS);const e={adCallTrackingUrl:this.adCallTrackingUrl,auctionId:this.rasAuctionId.orElse(()=>this.initialAuctionId),viewerId:this.viewerId.orElse(()=>this.initialViewerId),response:Object(m.b)(this.fraudReason,g.d.fold(()=>p.a.of(this.placementAd),p.c))};this.done(e,this.gdprIabObject,this.uspString,this.mrgReason)}ontimeout(){this.timeoutFired||(this.timeoutFired=!0,this.logger.warn("RAS request: timeout"),this.placementAd.placement&&this.placementAd.report.validity.status&&Object(fe.i)(Ae.a.AdNotAvailableNetworkError)({placementKey:this.placementAd.placement.key,sumologicLogger:this.sumologicLogger,wigo:this.placementAd.placement.wigo,logger:this.logger,queryParameters:{env:d.getEnv(),pageId:this.placementAd.placement.pageId.toString(),pid:this.placementAd.placement.pid.toString(),auctid:this.rasAuctionId.getOrValue(Object(l.b)("")),vid:this.viewerId.getOrValue(Object(h.b)("")),slot:this.placementAd.placement.slotType}}),this.mrgReason=Object(g.c)("18"),this.next())}onload(){Object(y.i)({name:"i",id:this.markId}),this.logger.info("Successful request",this.rasUrl);const e={placementKey:this.placementAd.placement.key,sumologicLogger:this.sumologicLogger,wigo:this.placementAd.placement.wigo,logger:this.logger},t={env:d.getEnv(),pageId:this.placementAd.placement.pageId.toString(),pid:this.placementAd.placement.pid.toString(),auctid:this.rasAuctionId.getOrValue(Object(l.b)("")),vid:this.viewerId.getOrValue(Object(h.b)("")),slot:this.placementAd.placement.slotType};let i;try{i=j.c(d.getIEVersion(),"9")?this.request.responseText:this.request.response,Object(E.isString)(i)&&(i=JSON.parse(i)),this.logger.info("RAS response",i),Array.isArray(i.ads)||(this.sumologicLogger.error("ras-request-ads-not-array"),this.placementAd.placement&&this.placementAd.report.validity.status&&Object(fe.b)(Object.assign(Object.assign({},e),{queryParameters:t})),i.ads=[],this.mrgReason=Object(g.c)("18"),this.logger.debug("Ads property from ad response is not an array",i)),i.ads.length>1&&(this.logger.warn("Received more than one ad, WTF?"),i.ads=[i.ads[0]]),!0===i.wigoEnabled&&this.placementAd.placement.wigo.enableWigo(),this.placementAd.placement.wigo.settings=be(i);me(this.placementAd.placement.pid,i).forEach(({auctionId:e,adCallTrackingUrl:t})=>{this.logger.debug(`PID ${this.placementAd.placement.pid} has auction id `,e),this.rasAuctionId=e,this.adCallTrackingUrl=t}),n=i,Object(E.hasOwnProperty)(n,"viewerId")&&Object(h.a)(n.viewerId)&&(this.logger.debug(`Setting viewerId for PID ${this.placementAd.placement.pid} to `,i.viewerId),this.viewerId=g.b.of(i.viewerId)),Object(a.isEmpty)(i.ads)?this.placementAd.placement&&this.placementAd.report.validity.status?Object(m.b)(g.b.fromNullable(i.noAdReason),g.d.fold(()=>{this.placementAd.placement.wigo.valid(1,2,"noAd-notFilled","error"),this.logger.debug("Ads list is empty and noAdReason is missing in ad response",i)},Object(m.a)(Ae.l,p.f.fold(e=>this.logger.warn("Error while parsing noAdReason from ad response",e),e=>{this.fraudReason=g.b.of(e),this.logger.debug("Ads list is empty and valid noAdReason was provided in ad response",i)})))):this.logger.debug("Ads list is empty and placement validity status is falsy",i.ads,this.placementAd.report.validity):Ie(i.ads[0]).match({some:e=>{this.placementAd.placement.pid===e?(this.placementAd.ad?this.logger.debug(`The ad for the PID ${e} has already been loaded`,i.ads[0]):this.placementAd.ad=i.ads[0],this.logger.debug(`Found an ad for placement ${e} in response.ads`,i.ads)):(this.mrgReason=Object(g.c)("18"),this.logger.debug(`Could not find an ad for placement ${e} in response.ads`,i.ads))},none:()=>{this.mrgReason=Object(g.c)("18"),this.logger.warn("Placement from ad response does not exist in the tag",this.placementAd.placement,i.ads[0])}}),window._tta&&window._tta[this.pageId]&&a.forEach(window._tta[this.pageId],e=>{Ie(e).match({some:t=>{this.placementAd.placement.pid===t&&(this.placementAd.ad?this.placementAd.ad=function(e,t){let i={settings:{}};return!(!t.type||!t.content)?(i.type=t.type,i.content=t.content):(i.type=e.type,i.content=e.content),i.settings=e.settings,i.insertion_id=e.insertion_id,i.connection_id=e.connection_id,i}(this.placementAd.ad,e):this.placementAd.ad=e)},none:()=>{this.logger.warn(`Trying to process _tta object but could not find the related _ttp object (PID: ${this.placementAd.placement.pid})`,this.placementAd.placement,e)}})})}catch(n){return this.sumologicLogger.error(`ras-request-invalid-response ${this.pageId} ${Object(P.a)(n)}`),this.placementAd.placement&&this.placementAd.report.validity.status&&Object(fe.b)(Object.assign(Object.assign({},e),{queryParameters:t})),this.logger.error("Invalid response",n,i),void(this.mrgReason=Object(g.c)("18"))}var n;this.next()}onerror(e){clearTimeout(this.timeoutLatencyRAS),this.sumologicLogger.error(`ras-request-error ${this.pageId} ${Object(P.a)(e)}`),this.logger.error("Request error - Status:",e.target.status);const t=0===(this.request.status||0)?Ae.a.AdNotAvailableNetworkError:Ae.a.AdNotAvailableServerError;this.placementAd.placement&&this.placementAd.report.validity.status&&Object(fe.i)(t)({placementKey:this.placementAd.placement.key,sumologicLogger:this.sumologicLogger,wigo:this.placementAd.placement.wigo,logger:this.logger,queryParameters:{env:d.getEnv(),pageId:this.placementAd.placement.pageId.toString(),pid:this.placementAd.placement.pid.toString(),auctid:this.rasAuctionId.getOrValue(Object(l.b)("")),vid:this.viewerId.getOrValue(Object(h.b)("")),slot:this.placementAd.placement.slotType}}),this.mrgReason=Object(g.c)("18"),this.next()}}var Te=i(22);const ke=new f.a("helper.UserSync");let je;function Pe(e,t,i,n,s,r){let a;const o=i.match({some:e=>({env:"js-web",hb_provider:e}),none:()=>({env:d.getEnv()})});if(!je){try{a=Object(x.findTopWindow)(window.document.body)}catch(e){ke.warn("Cannot get top window"),a=window}(i=>{const a={pid:e,gdprIab:V.b(Object(k.b)(t)),fromFormat:!0},d=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},a),o),s.match({some:e=>({auctid:e}),none:()=>({})})),r.match({some:e=>({vid:e}),none:()=>({})})),Ce(n));je=Object(x.createIframe)("user-sync"),je.id="teadsusersync",je.src=Object(w.c)(I.b.userSyncUrl,d)+"&"+Object(Te.a)(),je.style.setProperty("display","none"),i.document.body.appendChild(je)})(a)}return je}var Le=i(126),xe=i(89);const Ve=(e,t,i,n)=>{i?n&&e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t):n&&e.parentNode?e.parentNode.insertBefore(t,e):e.parentNode&&e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.appendChild(t)},Ne=(e,t,i,n)=>{const s=((e,t,i)=>{const n=t.document.createElement("div");return n.className="teads-adCall",n.style.setProperty("height","Opx","important"),Ve(e,n,i.insertInside.isEnabled(),i.insertBefore.isEnabled()),n})(e,t,n);return i.setElementToFollow(s),Object(xe.a)(()=>i.followElement(),n.scrollSelector.getSlot(),t.context),new Promise(r=>{let a=Object(c.getClientRectRelativeToDocument)(Object(c.getBoundingClientRect)(s),{x:Object(c.getScrollLeft)(t),y:Object(c.getScrollTop)(t)});if(!Object(x.isDisplayNoneOverParents)(g.b.fromNullable(s)))if(Object(x.isInView)({element:s,elementAncestors:Object(x.findParentElements)(s),elementClientRect:Object(c.getClientRectFromClientRectRelativeToDocument)(a,{x:Object(c.getScrollLeft)(t),y:Object(c.getScrollTop)(t)}),mainWindow:Object(x.findTopWindow)(e),thresholdCoefficient:1,elementHeight:1})&&!Object(x.isRectZeroFilled)(a))r();else{const o=Object(xe.a)(()=>{const n=Object(c.getBoundingClientRect)(s);a=Object(c.isEmptyBoundingClientRect)(n)?a:Object(c.getClientRectRelativeToDocument)(n,{x:Object(c.getScrollLeft)(t),y:Object(c.getScrollTop)(t)}),Object(x.isInView)({element:s,elementAncestors:Object(x.findParentElements)(s),elementClientRect:Object(c.getClientRectFromClientRectRelativeToDocument)(a,{x:Object(c.getScrollLeft)(t),y:Object(c.getScrollTop)(t)}),mainWindow:Object(x.findTopWindow)(e),thresholdCoefficient:1,elementHeight:1})&&!Object(x.isRectZeroFilled)(a)&&(Object(xe.b)(o),i.isActivated()||(e=>{g.b.fromNullable(e.parentElement).forEach(t=>t.removeChild(e))})(s),r())},n.scrollSelector.getSlot(),t.context)}})};var De=i(120);var _e=i(161);class Re extends class{constructor(e,t,i,n,s){var r;this.pageId=e,this.key=t,this.placementConfig=i,this.placementSetting=n,this.wigo=s,this.slotType="native",this.logger=new f.a("placement"),this.sliderEnabled=!1,this.pid=i.pid.get(),this.win=i.parentWindow.getWindow(),this.initContainer(),g.b.fromNullable(null===(r=window.teads)||void 0===r?void 0:r.router).forEach(()=>{this.wigo.valid(0,0)}),g.b.fromNullable(window._ttp).forEach(t=>{var i,n,s,r,a,o,d,c;this.wigo.valid(0,1,{ttp:null!==(n=null===(i=t[e])||void 0===i?void 0:i[0])&&void 0!==n?n:null,tta:null!==(a=null===(r=null===(s=window._tta)||void 0===s?void 0:s[e])||void 0===r?void 0:r[0])&&void 0!==a?a:null,tts:null!==(c=null===(d=null===(o=window._tts)||void 0===o?void 0:o[e])||void 0===d?void 0:d[0])&&void 0!==c?c:null},"modal")}),this.wigo.valid(1,0)}canEnableSlider(){var e,t;return!!this.placementConfig.formatName.isInRead()&&(null===(t=null===(e=this.placementSetting)||void 0===e?void 0:e.slider)||void 0===t?void 0:t.allowCorner())}enableSlider(){this.sliderEnabled=!0,this.electedSlot=new De.a(this.placementConfig.parentWindow.getWindow().document.body),this.placementConfig.btf.set(!1),this.placementConfig.minimum.set(0),this.placementConfig.auto.set(!1),this.placementConfig.insertBefore.set(!1),this.placementConfig.insertInside.set(!0)}handleNoAd({markId:e,sumologicLogger:t,headerBiddingProvider:i,portfolioItemId:n,adCallTrackOpts:s,auctionId:r,viewerId:a}){if(this.placementConfig.fallback.trigger()){const{key:e,logger:s,wigo:o,slotType:d,pageId:c,pid:l}=this;Object(fe.p)({placementKey:e,sumologicLogger:t,wigo:o,logger:s,headerBiddingProvider:i,pageId:c,placementId:l,slotType:d,portfolioItemId:n,auctionId:r,viewerId:a}),this.logger.info(S.d.fallback.noAd),this.wigo.valid(1,2,S.d.fallback.noAd,"error")}else d.isAmp()&&ye.b();this.sliderEnabled||Ne(this.electedSlot.getElement(),this.win,this.wigo,this.placementConfig).then(()=>{Object(fe.h)({placementKey:this.key,sumologicLogger:t,wigo:this.wigo,logger:this.logger,headerBiddingProvider:i,baseUrlWithQueryParameters:s}),Object(y.i)({name:"l",id:e}),t.info(Object(y.f)("ac",e),40)})}getParentContainer(){return this.parentContainer}getPlayerContainer(){return this.playerContainer}getInnerContainer(){return this.innerContainer}isSliderEnabled(){return this.sliderEnabled}initContainer(){this.parentContainer=this.win.document.createElement("div"),this.parentContainer.className="teads-"+this.placementConfig.formatName.get(),this.placementConfig.formatName.isInBoard()&&this.parentContainer.style.setProperty("width","100%"),this.innerContainer=this.win.document.createElement("div"),this.innerContainer.style.setProperty("position","relative"),this.innerContainer.style.setProperty("margin-bottom","0","important"),this.parentContainer.appendChild(this.innerContainer),this.playerContainer=this.win.document.createElement("div"),this.playerContainer.className="teads-player",this.playerContainer.style.setProperty("display","block","important"),this.playerContainer.style.setProperty("margin-bottom","0","important"),this.playerContainer.id="teads"+Wt++,this.innerContainer.appendChild(this.playerContainer)}}{constructor(){super(...arguments),this.name="inread"}checkSlot(){return Object(_e.d)(this,this.wigo).fold(({reason:e})=>({status:!1,reasons:[e]}),({slot:e})=>(this.electedSlot=e,{status:!0,reasons:[]}))}getElectedSlot(){return this.electedSlot}initDom(e){const t=e.getElement(),i=this.parentContainer;return"PR"!==t.nodeName&&"BR"!==t.nodeName||i.style.setProperty("margin","10px 0"),Ve(t,this.parentContainer,this.placementConfig.insertInside.isEnabled(),this.placementConfig.insertBefore.isEnabled()),i}}class Me extends Re{constructor(e,t,i,n,s){super(e,t,i,n,s),this.name="inboard",this.placementConfig.btf.set(!1),this.placementConfig.minimum.set(0),this.placementConfig.auto.set(!1)}}var Fe=i(18);class Ue extends Fe.a{constructor(e=Ue.DEFAULT){super("Pid"),this.value=e,this.checkValue()}checkValue(){if(!Object(E.isNumber)(this.value)||this.value<=0)throw new u.a(u.a.OPTION_PID_INVALID)}get(){return this.value}}Ue.DEFAULT=null;class Be extends Fe.a{constructor(e=Be.DEFAULT){super("AllowedRatio"),this.value=e,this.checkValue()}static isInternalHostname(e){return/(teads\.(tv|net|com))|(ebuzzing\.(com|github\.io)|(localhost)|(\.pantheonsite\.io))$/i.test(e)}static forceValueIfNeeded(e){const t=p.a.tryCatch(()=>top.location.hostname).getOrValue(location.hostname);return Object(d.isDesktop)()&&!Be.isInternalHostname(t)?["LANDSCAPE"]:e}static filterInvalidValues(e){return a.filter(e,e=>e in Be.AvailableRatio)}checkValue(){this.value=g.b.fromNullable(this.value).map(Be.forceValueIfNeeded).filter(E.isArray).map(Be.filterInvalidValues).filter(a.isNotEmpty).getOrValue(Be.DEFAULT)}get(){return this.value}getRatioFilters(){return a.map(this.value,e=>Be.AvailableRatio[e])}mediafileRatioIsValid(e,t){return a.isNotEmpty(a.filter(this.getRatioFilters(),i=>i(t(e))))}}Be.AvailableRatio={LANDSCAPE:e=>e>1,SQUARE:e=>1===e,VERTICAL:e=>e<1,ALL:e=>!0},Be.DEFAULT=["ALL"];var We=i(191);class He extends Fe.a{constructor(e=He.DEFAULT){super("Desktop"),this.value=e,this.checkValue()}checkValue(){Object(E.isBoolean)(this.value)||(this.value=He.DEFAULT)}isEnabled(){return this.value}}He.DEFAULT=!0;class ze extends Fe.a{constructor(e=ze.DEFAULT){super("Mobile"),this.value=e,this.checkValue()}checkValue(){Object(E.isBoolean)(this.value)||(this.value=ze.DEFAULT)}isEnabled(){return this.value}}ze.DEFAULT=!0;class Ge extends Fe.a{constructor(e=Ge.DEFAULT){super("Tablet"),this.value=e,this.checkValue()}checkValue(){Object(E.isBoolean)(this.value)||(this.value=Ge.DEFAULT)}isEnabled(){return this.value}}Ge.DEFAULT=!0;var qe=i(127);class Ke extends Fe.a{constructor(e=Ke.DEFAULT){super("Btf"),this.value=e,(Object(d.isAmp)()||Object(d.isIABSafeFrame)())&&(this.value=!1),this.checkValue()}checkValue(){Object(E.isBoolean)(this.value)||(this.value=Ke.DEFAULT)}set(e){this.value=e}isEnabled(){return this.value}}Ke.DEFAULT=!0;class $e extends Fe.a{constructor(e=$e.DEFAULT){super("Css"),this.originalRules=e,this.checkValue(),this.originalRules&&(this.rules=$e.transformStringToObject(this.originalRules))}static transformStringToObject(e){let t={};if(!e)return t;let i=e.split(";");return a.forEach(i,e=>{let[i,n]=e.split(":");i&&n&&(i=v.trim(i),n=v.trim(n),t[i]=n,"float"===i&&(t.cssFloat=n,t.styleFloat=n))}),t}checkValue(){Object(E.isString)(this.originalRules)||(this.originalRules=$e.DEFAULT)}getOriginal(){return this.originalRules}applyRulesOn(e){this.applyCssRulesOn(e,this.rules)}applyCssRulesOn(e,t){let i,n=!1;for(let s in t)t.hasOwnProperty(s)&&(n=$e.IMPORTANT_REGEX.test(t[s]),i=t[s].replace($e.IMPORTANT_REGEX,"").trim(),e.style.setProperty(s,i,n?"important":null))}}$e.DEFAULT=null,$e.IMPORTANT_REGEX=/!\s*important/i;class Ye extends Fe.a{constructor(e){super("Filter"),this.placement=e,this.func=e&&e.slot?e.slot.filter:null,this.checkValue()}checkValue(){Object(E.isFunction)(this.func)||(this.func=Ye.DEFAULT)}trigger(e){var t=!0;if("function"==typeof this.func){try{t=this.func.call(this.placement,e)}catch(e){s.a.error("filter-threw-err "+Object(P.a)(e)),this.logger.error("the filter function threw an error:",e,this.func)}"boolean"!=typeof t&&(t=!0)}return t}}Ye.DEFAULT=null;class Xe extends Fe.a{constructor(e=Xe.DEFAULT){super("InsertBefore"),this.value=e,this.checkValue()}checkValue(){Object(E.isBoolean)(this.value)||(this.value=Xe.DEFAULT)}isEnabled(){return this.value}set(e){this.value=e}}Xe.DEFAULT=!1;class Qe extends Fe.a{constructor(e=Qe.DEFAULT){super("InsertInside"),this.value=e,this.checkValue()}checkValue(){Object(d.isAmp)()?this.value=Qe.DEFAULT_AMP:Object(E.isBoolean)(this.value)||(this.value=Qe.DEFAULT)}isEnabled(){return this.value}set(e){this.value=e}}Qe.DEFAULT=!1,Qe.DEFAULT_AMP=!0;class Je extends Fe.a{constructor(e=Je.DEFAULT){super("Minimum"),this.value=e,(Object(d.isAmp)()||Object(d.isIABSafeFrame)())&&(this.value=1),this.checkValue()}checkValue(){Object(E.isNumber)(this.value)||(this.value=Je.DEFAULT)}set(e){this.value=e}get(){return this.value}}Je.DEFAULT=1;class Ze extends Fe.a{constructor(e=Ze.DEFAULT){super("MinimumBelow"),this.value=e,this.checkValue()}checkValue(){Object(E.isNumber)(this.value)||(this.value=Ze.DEFAULT)}get(){return this.value}}Ze.DEFAULT=null;class et extends Fe.a{constructor(e=et.DEFAULT){if(super("ParentWindow"),this.value=e,this.win=window,this.checkValue(),this.value)try{window.top.document&&(this.win=window.top)}catch(e){this.logger.warn("parentWindow option is enabled but parent window is not accessible",e)}}checkValue(){Object(E.isBoolean)(this.value)||(this.value=et.DEFAULT)}getWindow(){return this.win}getValue(){return this.value}}et.DEFAULT=!0;class tt extends Fe.a{constructor(e=tt.DEFAULT){super("Fallback"),this.value=e,this.called=!1,this.checkValue()}checkValue(){Object(E.isFunction)(this.value)||(this.value=tt.DEFAULT)}trigger(e){if(!this.value||this.called)return!1;try{let t=this.value.call(e);if(this.called=!0,t===S.c)return this.value=null,!1}catch(e){d.isAmp()&&ye.a(),this.logger.error("the fallback threw an error:",e)}return!0}hasValue(){return!!this.value}}tt.DEFAULT=null;class it extends Fe.a{constructor(e=it.DEFAULT){super("RpmFallback"),this.value=e,this.called=!1,this.checkValue()}checkValue(){Object(E.isFunction)(this.value)||(this.value=it.DEFAULT)}trigger(e){if(!this.value||this.called)return!1;try{this.value.call(e),this.called=!0}catch(e){this.logger.error("the rpmFallback threw an error:",e)}return!0}}it.DEFAULT=null;var nt=i(159),st=i(160);class rt extends Fe.a{constructor(e=rt.DEFAULT){super("MinimumTextLength"),this.value=e,this.checkValue()}checkValue(){Object(E.isNumber)(this.value)||(this.value=rt.DEFAULT)}get(){return this.value}}rt.DEFAULT=100;class at extends Fe.a{constructor(e=at.DEFAULT){super("MinimumWidth"),this.value=e,this.checkValue()}checkValue(){Object(E.isNumber)(this.value)||(this.value=at.DEFAULT)}get(){return this.value}}at.DEFAULT=100;class ot extends Fe.a{constructor(e=ot.DEFAULT){super("MaximumWidth"),this.value=e,this.checkValue()}checkValue(){Object(E.isNumber)(this.value)||(this.value=ot.DEFAULT)}get(){return this.value}}ot.DEFAULT=2e3;var dt=i(192);class ct extends dt.a{constructor(e,t){if(super("BelowSelector"),void 0===t)throw new u.a(u.a.OPTION_PARENTWINDOW_INVALID);this.win=t,e||(e=ct.DEFAULT),this.value=e,this.checkValue()}checkValue(){this.value===ct.DEFAULT||Object(E.isString)(this.value)||c.isHTMLElement(this.value)||c.isNodeList(this.value)||(this.value=ct.DEFAULT)}get(){return this.value}getFirstElement(){if(!this.hasCachedElement){var e,t=this.value;if("object"==typeof this.value){var i;for(var n in this.value)if(this.value.hasOwnProperty(n)&&(i=this.checkScreenSelector(n,this.win),t=this.value[n],i))break;i?this.logger.debug("Below Selector",i,"selected:",t):this.logger.warn("Below Selector by device not found: ",this.value)}Object(E.isString)(t)&&t.length>0?e=c.querySelectorAll(t,this.win)[0]:c.isHTMLElement(t)?e=t:c.isNodeList(t)&&(e=t[0]),this.cacheElement(e)}return this.firstElement}getFirstElementRect(){return this.firstElementRect||(this.firstElementRect=c.getBoundingClientRect(this.getFirstElement())),this.firstElementRect}getFirstNodeBelowIndex(e){if(!this.firstNodeBelowIndex&&0!==this.firstNodeBelowIndex){for(var t=!1,i=0;!t&&e[i];)e[i++].getElementRect().top>=this.getFirstElementRect().bottom&&(t=!0);this.firstNodeBelowIndex=i-1}return this.firstNodeBelowIndex}cacheElement(e){this.firstElement=e,this.hasCachedElement=!0}}ct.DEFAULT=null;class lt extends Fe.a{constructor(e=lt.DEFAULT,t=null){super("Auto"),this.value=e,t&&null!==t.get()&&(this.value=!1),this.checkValue()}checkValue(){Object(E.isBoolean)(this.value)||(this.value=lt.DEFAULT)}isEnabled(){return this.value}set(e){this.value=e}}lt.DEFAULT=!0;class ht extends Fe.a{constructor(e=ht.DEFAULT,t=window){super("Avoid"),this.value=e,this.win=t,this.checkValue()}checkValue(){Object(E.containsKeys)(ht.VALUES,this.value)||(this.value=ht.DEFAULT)}get(){return this.value}getSlots(){if(!this.value)return;const e=[],t=this.value.selector;if("string"==typeof t&&t.length>0){const n=c.querySelectorAll(t,this.win);for(var i=0;i<n.length;i++)e.push(new De.a(n[i],i))}else c.isHTMLElement(t)&&e.push(new De.a(t));return e}getDistance(){return this.value.distance}}ht.VALUES={SELECTOR:"selector",DISTANCE:"distance"},ht.DEFAULT=null;class ut extends Fe.a{constructor(e,t){var i;super("ScrollSelector");const n=null!==(i=t.FORCE_DEMO)&&void 0!==i&&i;this.win=n?window:t,this.value=void 0===e?ut.DEFAULT:e,this.checkValue()}checkValue(){Object(E.isString)(this.value)||c.isHTMLElement(this.value)||(this.value=ut.DEFAULT)}getSlot(){let e=this.win;const t=this.value;if("string"==typeof t&&t.length>0){const i=c.querySelectorAll(t,this.win);i&&1===i.length?e=i[0]:this.logger.warn("Parameter must be a string (CSS Selector) or a DOM Element")}else c.isHTMLElement(t)&&(e=t);return e}}ut.DEFAULT=null;class pt{constructor(e,t=g.a){this.raw=e,this.headerBiddingProvider=t,e.slot||(e.slot={}),this.pid=new Ue(e.pid),this.formatName=new qe.a(e.format),this.btf=new Ke(e.slot.btf),this.css=new $e(e.css),this.filter=new Ye(e),this.insertBefore=new Xe(e.slot.insertBefore),this.insertInside=new Qe(e.slot.insertInside),this.minimum=new Je(e.slot.minimum),this.minimumBelow=new Ze(e.slot.minimumBelow),this.parentWindow=new et(e.parentWindow),this.fallback=new tt(e.fallback),this.rpmFallback=new it(e.rpmFallback),this.videoFilter=new nt.a(e.slot.videoFilter),this.imageFilter=new st.a(e.slot.imageFilter),this.minimumTextLength=new rt(e.slot.minimumTextLength),this.minimumWidth=new at(e.slot.minimumWidth),this.maximumWidth=new ot(e.slot.maximumWidth),this.belowSelector=new ct(e.slot.belowSelector,this.parentWindow.getWindow()),this.selector=new We.a(e.slot.selector,this.parentWindow.getWindow()),this.auto=new lt(e.slot.auto,this.selector),this.avoid=new ht(e.slot.avoid,this.parentWindow.getWindow()),this.scrollSelector=new ut(e.slot.scrollSelector,this.parentWindow.getWindow()),this.callbacks=e.callbacks,this.mobile=new ze(e.mobile),this.tablet=new Ge(e.tablet),this.desktop=new He(e.desktop),this.allowedRatio=new Be}isMobile(){return this.mobile.isEnabled()}isTablet(){return this.tablet.isEnabled()}isDesktop(){return this.desktop.isEnabled()}}class gt extends Fe.a{constructor(e){super("Slider"),this.value=Object.assign(Object.assign({},gt.DEFAULT),e),this.checkValue()}checkValue(){Object(E.containsKeys)(gt.VALUES,this.value)||(this.value=gt.DEFAULT)}allowCorner(){return this.value.allow_corner_position}}gt.VALUES={allow_top_position:"top",allow_corner_position:"corner"},gt.DEFAULT={allow_top_position:!1,allow_corner_position:!1};class mt{constructor(e){this.rawConfig=e,e&&(this.slider=new gt(e.slider))}static getPlacementSetting(e){if(window._tts&&window._tts[e.get()])return window._tts[e.get()]}}var bt=i(20),ft=i(51),vt=i(86);const At=({pageId:e,placementId:t,pageIndex:i,auctionId:n,headerBiddingProvider:s,sumologicLogger:r})=>{const a=Object(x.findTopWindow)(document.body);return!Object(w.n)(a.location.hostname)&&!Object(w.j)(a.location.href)&&yt().match({none:()=>!1,some:a=>(bt.b.debug.track(Object(bt.a)(e,t,i))(Ae.a.Bts,{baseUrl:I.b.trackingUrl,referer:Object(fe.a)(r),queryParameters:{env:d.getEnv(),pageId:e.toString(),pid:t.toString(),hb_provider:s.getOrValue(""),auctid:n.getOrValue(Object(l.b)(""))},trackingUrl:g.a},g.b.of(a)),!1)})},yt=()=>{if(document.$cdc_asdjflasutopfhvcZLmcfl_)return Object(g.c)("se");if(window.__nightmare)return Object(g.c)("ni");if(window.callPhantom||window._phantom||window.phantom)return Object(g.c)("ph");try{null[0]}catch(e){if(e.stack.match("e[ualv]{5}te[panh@]{5}t[josm]{4}"))return Object(g.c)("ph")}return navigator.webdriver?Object(g.c)("wb"):navigator.userAgent.match("PhantomJS")?Object(g.c)("ph"):navigator.userAgent.match("Headless")?Object(g.c)("wb"):g.a},wt=new f.a("TtpHandler");function Et({ttpObject:e,pageInstance:t}){return Object(y.i)({name:"b"}),p.a.tryCatch(()=>e.filter(Ot).match({some:e=>ft.c(Ct(t),e),none:()=>wt.warn("The provided ttp object is not valid",e)}))}function Ot(e){return Object(E.isObject)(e)}const Ct=Object(ge.a)((e,t,i)=>{const n=function(e){return Object(r.b)(Object(E.isString)(e)?parseInt(e,10):e)}(t);if(!function(e){return Ut===e||0===Ut||0===e}(n))throw s.a.error(`multi-page ${Ut} ${n} ${Object(a.map)(i,e=>e.pid).join(";")}`),new u.a(u.a.MULTIPLE_PAGE_PROCESS);a.forEach(i,It(e,n)),Ut=Ut||n}),It=Object(ge.a)((e,t,i)=>{p.a.tryCatch(()=>new Ue(i.pid)).map(e=>e.get()).fold(e=>{wt.warn("Invalid placement ID value provided",i.pid,i,e)},n=>{const r=Object(y.b)(t,n);Object(y.i)({name:"c",id:r});const a=s.a.copy({collectorUrl:"https://s8t.teads.tv/logs/format/http-source",placementId:Object(g.c)(n)}),o=Object(vt.getUuid)(),d=o.toOption().map(l.b),c=new D.b,h=At({pageId:t,placementId:i.pid,pageIndex:0,auctionId:d,headerBiddingProvider:g.a,sumologicLogger:a});o.tapLeft(e=>{a.error("limitedCapabilities "+Object(P.a)(e)),Object(fe.r)({placementKey:Object(bt.a)(t,n,0),sumologicLogger:a,wigo:c,logger:wt,headerBiddingProvider:g.a,viewerId:g.a,pageId:t,placementId:n,auctionId:d})}),e.placementAd=e.checkPlacement({rawPlacement:i,pageId:t,placementId:n,pageIndex:0,auctionId:d,wigo:c,sumologicLogger:a,headerBiddingProvider:g.a,adSettings:g.a}),e.placementAd&&(Object(y.i)({name:"e",id:r}),e.placementAd=e.checkSlot({placementAd:e.placementAd,wigo:c,auctionId:d,sumologicLogger:a,hbSlotAvailableTrackUrl:g.a,placementIsFirst:!0,adSettings:g.a}),e.placementAd&&e.callRAS({placementAd:e.placementAd,auctionId:d,viewerId:g.a,sumologicLogger:a,browserIsHeadless:h,onRASResponse:e=>{Object(y.i)({name:"k",id:r}),a.info(Object(y.e)("ttp",r),I.b.isQA?1:0)},markId:r,tagManagerPackage:g.a}))})});var St=i(74),Tt=i(17),kt=i(157),jt=i(55),Pt=i(36),Lt=i(158);const xt=new f.a("VastHandler"),Vt=e=>Object(E.isString)(e.type)&&Object(E.isString)(e.content);function Nt(e){var t=e.adSettings,{vast:i}=t,n=Object(St.b)(t,["vast"]),{placement:s,gdprIab:r,sumologicLogger:o,auctionId:d,viewerId:c,regularVastHandler:l=Dt}=e;const{pageId:h,wigo:u,slotType:p}=s;return l(i,h,r,u,o,p).catch(([e,t])=>{throw function(e,{insertionId:t,connectionId:i,portfolioItemId:n},s,r,o,d){const c="VASTParser.parse error"===d.getMessage()?Object(P.b)(d)+g.b.fromNullable(d.error).map(e=>"|"+e.message).getOrValue(""):Object(P.b)(d);s.error("loading-vast "+c.substr(0,120));const{key:l,pageId:h,pid:u,slotType:p,wigo:m,placementConfig:{headerBiddingProvider:b}}=e,f=d.getId()||0,v={placementKey:l,sumologicLogger:s,wigo:m,logger:xt,headerBiddingProvider:b,pageId:h,placementId:u,auctionId:r,viewerId:o,slotType:p,portfolioItemId:Object(Pt.a)(n),insertionId:Object(Pt.a)(t),connectionId:Object(Pt.a)(i)};f===Tt.b.WRAPPER_TIMEOUT.id?Object(fe.f)(v):Object(fe.e)(Object.assign(Object.assign({},v),{code:Object(a.isMemberOf)(jt.b)(f)?f:jt.a.Undefined}));xt.error("VAST loading",d)}(s,n,o,d,c,e),[e,t]})}function Dt(e,t,i,n,s,r){return new Promise((t,r)=>{const a=new Lt.a({assetsUrl:I.b.basePathUrl},Object(g.c)(i),s,g.b.fromNullable(n)),o=e=>{!function(e,t){xt.info("Ad is ready"),t.valid(1,2)}(0,n),t(e)},d=(e,t)=>r([e,t]),c=e.getContent();e.isVastUrl()?a.load(c,o,d):e.isVastXml()&&a.parse(c,o,d)})}var _t=i(33),Rt=i(44);const Mt=(e,t)=>{const i=((e,t)=>e.flatMap(k.a).match({some:({status:e,consent:t,reason:i,apiVersion:n,cmpId:s})=>({status:e,consent:t,reason:i.getOrValue(240),apiVersion:n,cmpId:s}),none:()=>(t.warning("gdpr-hb-rasreq-both-empty"),{status:24,consent:"",reason:240,apiVersion:g.a,cmpId:g.a})}))(e,t);return L.a.updateTeadsGDPRPayload(i),i};class Ft{constructor(){this.logger=new f.a("Page"),this.hasSlider=!1}static getPlayerSize(e,t){let i={width:0,height:0};if(e){if(t.insertInside.isEnabled())i.width=e.getWidth();else if(e.getElement().parentNode){const t=c.getSize(e.getElement().parentNode);i.width=t.width}i.height=i.width/o.a}else{const e=C.a.findOptimalCreativeSizeBasedOnWindowSurface(g.a,c.getWindowSize(t.parentWindow.getWindow()));i.height=e.height,i.width=e.width}return i.width=Math.round(i.width),i.height=Math.round(i.height),i}checkPlacement({rawPlacement:e,pageId:t,placementId:i,pageIndex:n,auctionId:s,wigo:r,sumologicLogger:a,headerBiddingProvider:o,adSettings:c}){const l=Object(bt.a)(t,i,n);let h,p;if(e.launched)return void this.logger.warn("This format has already been launched");e.launched=!0;const m=Object(v.rand)(10,!1),b={pageId:t,placementId:i,placementKey:l,sumologicLogger:a,logger:this.logger,wigo:r,auctionId:s,randomString:m},f=c.map(Object(E.prop)("viewerId"));o.filter(e=>"debugFormat"!==e).match({none:()=>{Object(fe.t)(b)},some:e=>{const{status:t,consent:i}=Mt(c,a);Object(fe.l)({placementKey:l,gdprStatus:t,gdprConsent:i})}});const A=window._ttf&&0===t?"2":"3";a.info("tagtype "+A,40);try{var y,w=new pt(e,o),O=e.slider?{slider:e.slider}:mt.getPlacementSetting(w.pid);O&&(y=new mt(O))}catch(e){return this.logger.error(e.getMessage()),e.getId()===u.a.OPTION_FORMAT_INVALID.id&&Object(fe.q)(Object.assign(Object.assign({},b),{headerBiddingProvider:o,viewerId:f})),void a.error(`placement-config ${t} ${g.b.fromNullable(i).getOrNull()} ${Object(P.a)(e)}`)}switch(w.formatName.get()){case S.b.inread:p=new Re(t,l,w,y,r);break;case S.b.inboard:p=new Me(t,l,w,y,r)}if(window._ttc&&window._ttc[t]&&window._ttc[t].rpm)return a.info("ttc-rpm"),void p.placementConfig.rpmFallback.trigger();h={status:!0,reasons:[]};const C=function(e){const t={status:!0,reasons:[]},i=e.parentWindow.getWindow();d.videoSupport(i.document)||(t.status=!1,t.reasons.push(S.d.incompatibility.video));const n=d.isMobile()&&e.isMobile(),s=d.isTablet()&&e.isTablet(),r=d.isDesktop()&&e.isDesktop();return n||s||r||(t.status=!1,t.reasons.push(S.d.incompatibility.context)),j.c(d.getIEVersion(),"8")&&(t.status=!1,t.reasons.push(S.d.incompatibility.browser)),t}(p.placementConfig);if(this.logger.debug("Check environment",C),!C.status&&(h.status=!1,!d.isAmp()||d.isAmp()&&w.formatName.get()===S.b.inread)){const e=C.reasons[0];e&&Object(fe.u)(Object.assign(Object.assign({},b),{headerBiddingProvider:o,viewerId:f}),e),p.placementConfig.fallback.trigger()&&Object(fe.o)(Object.assign(Object.assign({},b),{headerBiddingProvider:o,viewerId:f}))}return{placement:p,report:{id:i,validity:h,player:null,slotType:"native"},ad:null}}checkSlot({placementAd:e,wigo:t,sumologicLogger:i,auctionId:n,hbSlotAvailableTrackUrl:s,placementIsFirst:r,adSettings:a}){if(e.report.validity.status){e.report.validity=e.placement.checkSlot(),this.logger.debug("Slot availability",e.report.validity);const t=e.placement.getElectedSlot();e.report.player=Ft.getPlayerSize(t,e.placement.placementConfig)}const o={pageId:e.placement.pageId,placementId:e.placement.pid,placementKey:e.placement.key,sumologicLogger:i,logger:this.logger,wigo:t,auctionId:n,headerBiddingProvider:e.placement.placementConfig.headerBiddingProvider,hbSlotAvailableUrl:s},c=a.map(Object(E.prop)("viewerId"));return(e=>{const{adSettings:t,slotIsFound:i,cornerPositionIsAllowed:n,placementIsFirst:s}=e;return t.filter(()=>i||n).flatMap(e=>g.b.fromNullable(e.slotType)).orElse(()=>d.isAmp()||d.isIABSafeFrame()||d.isAmpSF()||i&&!n&&s?Object(g.c)("native"):i&&n&&s?Object(g.c)("polymorph"):!i&&n&&s?Object(g.c)("corner"):i&&!s?Object(g.c)("multislot"):g.a)})({adSettings:a,slotIsFound:(l=e.report.validity,!(!l.status&&l.reasons.length>0)),cornerPositionIsAllowed:e.placement.canEnableSlider(),placementIsFirst:r}).match({some:t=>("corner"===t&&(this.hasSlider=!0,e.placement.enableSlider(),e.report.validity.reasons=[],e.report.validity.status=!0),e.placement.slotType=t,e.report.slotType=t,Object(fe.v)(Object.assign(Object.assign({},o),{slotType:t,viewerId:c})),e),none:()=>{Object(fe.s)(Object.assign(Object.assign({},o),{viewerId:c}),e.report.validity.reasons[0]),Le.a()}});var l}callRAS({placementAd:e,auctionId:t,viewerId:i,sumologicLogger:n,browserIsHeadless:s,onRASResponse:r,markId:o,tagManagerPackage:c}){const u=c.map(e=>e.tagManagerInstance).flatMap(e=>g.b.fromNullable(e.getAd)).match({some:e=>!e.headerBiddingProvider||""===e.headerBiddingProvider,none:()=>!1});const{pageId:f}=e.placement;new Se(e,f,t,i,s,o,n,this.getAdRequestUrl(f,n),({adCallTrackingUrl:t,auctionId:i,viewerId:s,response:f},v,w,C)=>{const S=(t,r,a)=>{e.placement.handleNoAd({markId:o,sumologicLogger:n,headerBiddingProvider:t,portfolioItemId:r,adCallTrackOpts:a,auctionId:i,viewerId:s}),c.forEach(({tagManagerInstance:t,onFormatLoaded:i,done:n})=>{g.b.fromNullable(window.teads.tagManagerResourcesList).filter(E.isArray).forEach(i=>{i.push({tagManager:t,placementAd:e,vastPlayer:g.a,tagIsCampaignTag:u})}),i(!1),n()})},k=v.getOrElse(()=>L.a.payload),j=n=>{const r=u?"17":C.getOrValue("19"),a=t.map(e=>Object(Rt.d)(e));return{baseUrl:Object(m.b)(a,g.d.map(Object(E.prop)("baseUrl")),g.d.getOrValue(I.b.trackingUrl)),businessIds:{insertionId:Object(m.b)(n,g.d.map(Object(E.prop)("insertionId")),g.d.filter(e=>e>0),Pt.b),connectionId:Object(m.b)(n,g.d.map(Object(E.prop)("connectionId")),Pt.b)},queryParameters:Object.assign({env:d.getEnv(),pageId:e.placement.pageId.toString(),pid:e.placement.pid.toString(),auctid:i.getOrValue(Object(l.b)("")),vid:s.getOrValue(Object(h.b)("")),slot:e.placement.slotType,pfid:Object(m.b)(n,g.d.map(Object(E.prop)("portfolioItemId")),Pt.b),gdpr_api_version:Object(Pt.b)(k.apiVersion),gdpr_cmp_id:Object(Pt.b)(k.cmpId),gdpr_consent:k.consent,gdpr_status:k.status.toString(),gdpr_reason:k.reason.toString(),rpm_reason:r},Object(m.b)(a,g.d.map(Object(E.prop)("queryParameters")),g.d.getOrValue({}))),trackingUrl:t.map(Object(Pt.e)({rpm_reason:"19"}))}},x={placementKey:e.placement.key,sumologicLogger:n,wigo:e.placement.wigo,logger:this.logger,headerBiddingProvider:e.placement.placementConfig.headerBiddingProvider};f.fold(()=>{const{headerBiddingProvider:t}=e.placement.placementConfig;this.hasSlider&&(Object(fe.h)(Object.assign(Object.assign({},x),{headerBiddingProvider:t,baseUrlWithQueryParameters:j(g.a)})),Object(y.i)({name:"l",id:o}),n.info(Object(y.f)("ac",o),40)),S(t,g.a,j(g.a))},e=>{r(e);const t=g.b.fromNullable(e.ad),l=w.orElse(()=>t.flatMap(T).map(({consent:e})=>e));if(this.userSync(e.placement,i,s,k,l),this.hasSlider&&(Object(fe.h)(Object.assign(Object.assign({},x),{headerBiddingProvider:e.placement.placementConfig.headerBiddingProvider,baseUrlWithQueryParameters:j(g.a)})),Object(y.i)({name:"l",id:o}),n.info(Object(y.f)("ac",o),40)),e.ad){if(e.ad.handled)return void this.logger.debug("Ad already handled for this placement");if(e.ad.handled=!0,e.ad.callbacks=e.placement.placementConfig.raw.callbacks,!e.placement.getElectedSlot())return void this.logger.debug("No elected slot -> not placing format");g.b.fromNullable(e.ad).filter(Vt).match({none:()=>{this.logger.warn("Will not be able to create a FormatConfig, invalid ad object",e),S(e.placement.placementConfig.headerBiddingProvider,g.d.map(Object(E.prop)("portfolio_item_id"))(t),j(g.a))},some:r=>{Object(fe.j)({placement:e.placement,sumologicLogger:n,logger:this.logger,auctionId:i,viewerId:s,headerBiddingProvider:e.placement.placementConfig.headerBiddingProvider,portfolioItemId:g.b.fromNullable(r.portfolio_item_id)}),function(e,t,i){return p.a.tryCatch(()=>{const e=new kt.a(i);return xt.debug("FormatConfig instance",e),e})}(0,0,r).fold(a=>{this.logger.warn("Could not instantiate FormatConfig",a,e.ad),Object(fe.d)({placement:e.placement,sumologicLogger:n,logger:this.logger,auctionId:i,viewerId:s,headerBiddingProvider:e.placement.placementConfig.headerBiddingProvider,portfolioItemId:g.b.fromNullable(r.portfolio_item_id),insertionId:g.b.fromNullable(r.insertion_id),connectionId:g.b.fromNullable(r.connection_id)}),n.error(`formatconfig ${Ae.a.AdAvailableErrorSettings}|${Object(P.a)(a)}`),S(e.placement.placementConfig.headerBiddingProvider,g.d.map(Object(E.prop)("portfolio_item_id"))(t),j(g.a))},t=>{d.activateConversionMeasurementFeature();const r=new A.a(t.adType.isDisplay()?"display":t.adType.isNative()?"native":"video",g.b.fromNullable(t.insertionId),g.b.fromNullable(t.connectionId),n);Nt({adSettings:t,placement:e.placement,gdprIab:k,sumologicLogger:r,auctionId:i,viewerId:s}).then(n=>{Object(y.i)({name:"r",id:o}),Object(m.b)(n.tracking,bt.b.vast.registerVastTrackings(x.placementKey),b.a.biforeach(({trackings:e,progressTrackings:t})=>{this.logger.debug("Trackings registered to Teads VAST trackings store",e),this.logger.debug("Progress trackings registered to Teads VAST trackings store",t)},({trackings:e,progressTrackings:t})=>{this.logger.debug("Trackings registered to Third-Party VAST trackings store",e),this.logger.debug("Progress trackings registered to Third-Party VAST trackings store",t)})),p.a.tryCatch(()=>{Object(O.d)({sumologicLogger:r,placementAd:e,linearAdWithFormatConfig:{linearAd:n,formatConfig:t},tagIsCampaignTag:u,tagManagerPackage:c,adCallTrackOpts:j(g.b.of(t)),auctionId:i,viewerId:s,gdprIab:k})}).tapLeft(n=>{this.logger.error("Succesfully parsed/loaded the VAST, but an uncaught error was thrown when loading the ad.",n),r.error("uncaught-error-loadvast "+Object(P.a)(n));const{pageId:a,pid:o,slotType:d}=e.placement;Object(fe.e)(Object.assign(Object.assign({},x),{code:jt.a.Undefined,pageId:a,placementId:o,auctionId:i,viewerId:s,slotType:d,portfolioItemId:Object(Pt.a)(t.portfolioItemId),insertionId:Object(Pt.a)(t.insertionId),connectionId:Object(Pt.a)(t.connectionId)})),Object(fe.n)({placementKey:x.placementKey,sumologicLogger:r,wigo:e.placement.wigo,logger:x.logger,durationPlayed:g.a,totalDuration:g.a})(jt.a.Undefined,()=>bt.b.vast.trackErrorWithCause(x.placementKey)(jt.a.Undefined,"load-ad-exception",{referer:Object(fe.a)(x.sumologicLogger),slotType:e.placement.slotType,macros:Object(_t.f)()})),c.forEach(({tagManagerInstance:e})=>{e.logger.debug("load -> loadAd","noAd")}),S(e.placement.placementConfig.headerBiddingProvider,g.b.fromNullable(t.portfolioItemId),j(g.b.of(t)))})}).catch(([i,n])=>{this.logger.error("Error when loading the VAST",i,e);const s=i.getId(),o=Object(a.isMemberOf)(jt.b)(s)?s:jt.a.Undefined;bt.b.vast.registerVastTrackings(x.placementKey)(n.tracking),Object(fe.n)({placementKey:x.placementKey,sumologicLogger:r,wigo:e.placement.wigo,logger:x.logger,durationPlayed:g.a,totalDuration:g.a})(o,()=>bt.b.vast.trackErrorWithCause(x.placementKey)(o,"load-vast-exception",{referer:Object(fe.a)(x.sumologicLogger),slotType:e.placement.slotType,macros:Object(_t.f)()})),c.forEach(({tagManagerInstance:e})=>{e.logger.debug("load -> loadAd","noAd")}),S(e.placement.placementConfig.headerBiddingProvider,g.b.fromNullable(t.portfolioItemId),j(g.b.of(t)))})})}})}else e.report.validity.status&&(Object(y.i)({name:"q",id:o}),n.info(Object(y.f)("tpb",o),I.b.isQA?1:0),S(g.a,g.a,j(g.a)))}),Le.b()}).send()}reload(){g.b.fromNullable(window.teads.clearInstances).forEach(e=>e());const e=g.b.fromNullable(window._ttp);!function(e){e.forEach(e=>{for(const t in e)e.hasOwnProperty(t)&&Object(a.forEach)(e[t],e=>e.launched=!1)})}(e),g.b.fromNullable(window.teads.destroyPageRelatedVariables).forEach(e=>e()),Et({ttpObject:e,pageInstance:this}).tapLeft(e=>this.logger.error(e))}userSync(e,t,i,n,s){if(e&&e.pid&&!this.isUserSyncIframeLoaded){const r=g.b.fromNullable(e.placementConfig).flatMap(e=>e.headerBiddingProvider);let a=Pe(e.pid,n,r,s,t,i);c.addEventListener("load",a,e=>{this.isUserSyncIframeLoaded=!0})}}getAdRequestUrl(e,t){const i=I.b.richAdServerUrl.replace("{id}",String(e));return this.getAdRequestMetadata(t).map(e=>Object(w.c)(i,e)).getOrValue(i)}getAdRequestMetadata(e){return Object(w.f)(e).map(({windowDepth:e,windowReferrerUrl:t})=>{const i=g.b.fromNullable(t).map(e=>({windowReferrerUrl:encodeURIComponent(e)})).getOrValue({});return Object.assign(Object.assign({windowWidth:window.innerWidth,windowHeight:window.innerHeight,windowDepth:e},function(e){const t=d.isAmp()||d.isAmpSF();return p.a.tryCatch(()=>{const e=t?window.context.referrer:window.top.document.referrer;return new URL(e).origin}).fold(t=>(e.warn("Cannot get referrer",t),{}),e=>({pageReferrerUrl:encodeURIComponent(e)}))}(this.logger)),i)})}}let Ut=Object(r.b)(0);let Bt,Wt=0;const Ht=new f.a("Main");var zt=i(16),Gt=i(121),qt=i(119);const Kt=new f.a("TagManager"),$t={},Yt=(e,t)=>{const i=Object(a.fromStringToNumber)(Object.keys($t));return 1===Object(a.flatten)(Object(a.map)(i,e=>{const t=Object.keys($t[e]),i=Object(a.fromStringToNumber)(Object(a.filter)(t,e=>"placement"!==e)),n=Object(a.map)(i,t=>$t[e][t]);return Object(a.filter)(n,e=>Object(a.last)(e).state!==Qt.PASSBACKED)})).length&&0===t},Xt={};var Qt;!function(e){e[e.INIT=0]="INIT",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.SERVED=3]="SERVED",e[e.ERRORED=4]="ERRORED",e[e.PASSBACKED=5]="PASSBACKED"}(Qt||(Qt={}));class Jt{constructor(e,t,i,n=!1,r=0){this.pageId=e,this.pid=t,this.rawSettings=i,this.defer=n,this.pageIndex=r,this.doServe=!1,this.wigo=new D.b,this.formatInstance=g.a,this.doPassback=!1,this.passbacks={beforeServe:[],afterServe:[]},this.scripts=[],this.headerBiddingContext=g.a,this.logger=new f.a(`TagManager (pageId: ${e}, placementId: ${t})`),this.logger.debug("new placement",i),this.headerBiddingContext=_(Xt[this.pid]),this.sumologicLogger=s.a.copy({collectorUrl:"https://s8t.teads.tv/logs/format/http-source",placementId:Object(g.c)(t),options:Object.assign(Object.assign({},s.a.options),{isHeaderBiddingTag:()=>this.headerBiddingContext.nonEmpty()})}),this.settings=Object.assign({},i||Jt.defaultRawPlacement),this.settings.pid=t,this.settings.format=this.settings.format||"inread",this.settings.fallback=()=>(this.logger.debug("no ad to serve so exec passback"),this.execPassback()),this.state=Qt.INIT,this.headerBiddingContext.nonEmpty()&&this.handleHeaderBiddingAd(),I.b.refresh(window.teads),this.handleDataInsertion(t).forEach(e=>{Le.a(),this.getAd=e}),this.markId=Object(y.b)(e,r,t)}static getRawAdFromScript(e,t,i,n){return e.match({some:e=>c.getAndRemoveAttributeValue(e,t).match({some:e=>{const t=n(Object(g.c)({type:"VastUrl",content:`${I.b.buyingEngineUrl}/${e}`,insertion_id:parseInt(e,10)}));return i.debug("data-insertion handled",t),Object(g.c)(t)},none:()=>(i.error(t+" detected but the value is empty"),g.b.empty())}),none:()=>g.b.empty()})}static page(e){if(Object(r.a)(e))return $t[e]||($t[e]={placement:(t,i,n,s)=>(Object(y.j)({name:"b",id:Object(y.b)(e,s||0,t)}),Jt.placement(e,t,i,n,s))});throw s.a.error("teads-page-invalid-pageid "+e),new Error("teads.page function called with invalid page ID: "+e)}static ad(e,t){return Xt[e]&&new f.a("TagManager placementId: "+e).warn("ad settings already exist and will be overwritten",Xt[e],t),Xt[e]=t,{page:Jt.page}}static placement(e,t,i,n,s){const r=$t[e],a=r[t]||(r[t]=[]);s=g.b.fromNullable(s).getOrValue(a.length?a.length-1:0),a[s]?i&&i!==a[s].rawSettings&&(a[s].rawSettings=i):p.a.tryCatch(()=>new Ue(t)).map(e=>e.get()).fold(e=>{Kt.warn("Invalid placement ID value provided",t,i,e)},t=>{a[s]=new Jt(e,t,i,n,s)});const o=a[s];return o.findMatchingScript()?(o.logger.debug("found script with serve attribute -> serve it"),o.serve()):n?o.logger.debug("tag deferred"):o.load(),o}load(){var e;const t=g.b.fromNullable(null===(e=Xt[this.pid])||void 0===e?void 0:e.headerBiddingSlotAvailableTrackUrl);return this.state!==Qt.INIT?(this.logger.warn("tag already loaded, loading or served",this.state),this):(this.state=Qt.LOADING,this.logger.debug("load: checkPlacement > checkSlot > callRAS > loadAd"),Object(y.i)({name:"d",id:this.markId}),this.onReadyState(()=>{Object(y.i)({name:"c",id:this.markId});const e=g.b.fromNullable(Xt[this.pid]),i=e.flatMap(me(this.pid)).flatMap(({auctionId:e})=>e.map(p.d)).getOrElse(()=>Object(vt.getUuid)().map(l.b)),n=i.toOption(),s=e.flatMap(Object(E.safeProp)("viewerId"));this.wigo.settings=e.flatMap(be);const r=At({pageId:this.pageId,placementId:this.pid,pageIndex:this.pageIndex,auctionId:n,headerBiddingProvider:this.headerBiddingContext,sumologicLogger:this.sumologicLogger});i.tapLeft(e=>{this.sumologicLogger.error("limitedCapabilities "+Object(P.a)(e)),Object(fe.r)({placementKey:Object(bt.a)(this.pageId,this.pid,this.pageIndex),sumologicLogger:this.sumologicLogger,wigo:this.wigo,logger:this.logger,headerBiddingProvider:this.headerBiddingContext,viewerId:s,pageId:this.pageId,placementId:this.pid,auctionId:n})}),this.fillCustomTracking(this.findCustomTracking(this.scripts)),this.adInfos=Bt.checkPlacement({rawPlacement:this.settings,pageId:this.pageId,placementId:this.pid,pageIndex:this.pageIndex,auctionId:n,wigo:this.wigo,sumologicLogger:this.sumologicLogger,headerBiddingProvider:this.headerBiddingContext,adSettings:e}),this.adInfos?(e.filter(e=>!0===e.wigoEnabled).forEach(()=>this.wigo.enableWigo()),this.logger.debug("load -> checkPlacement ok"),Object(y.i)({name:"e",id:this.markId}),this.adInfos=Bt.checkSlot({placementAd:this.adInfos,wigo:this.wigo,sumologicLogger:this.sumologicLogger,auctionId:n,hbSlotAvailableTrackUrl:t,placementIsFirst:Yt(this.pid,this.pageIndex),adSettings:e}),this.adInfos?(this.logger.debug("load -> checkSlot ok"),this.adInfos.ad=this.getAd,Bt.callRAS({placementAd:this.adInfos,auctionId:n,viewerId:s,sumologicLogger:this.sumologicLogger,browserIsHeadless:r,onRASResponse:e=>{this.logger.debug("load -> callRAS",this.getAd?"bypassed by data-insertion":"ok"),this.adInfos=e,this.sendTagToWigo(),Object(y.i)({name:"k",id:this.markId}),this.sumologicLogger.info(Object(y.e)(this.pageIndex?"tm_is":"tm",this.markId),I.b.isQA?1:0)},markId:this.markId,tagManagerPackage:Object(g.c)({tagManagerInstance:this,onFormatLoaded:()=>{this.state!==Qt.PASSBACKED&&(this.state=Qt.LOADED)},done:()=>{this.doServe?this.serve():this.logger.debug("waiting for serve")}})})):(this.logger.debug("load - checkSlot failure"),this.state=Qt.ERRORED)):(this.logger.debug("load - placement failure"),this.state=Qt.ERRORED)}),this)}serve(){let e=this;switch(this.state){case Qt.ERRORED:this.state=Qt.SERVED,this.logger.warn("serve - this placement cannot be served - state = ERROR");break;case Qt.SERVED:this.logger.warn("already served - reload and serve it again"),e=this.reload().serve();break;case Qt.INIT:this.doServe=!0,this.logger.debug("load before serve (defer)",this.adInfos),this.load();break;case Qt.LOADING:this.logger.warn("serve - the tag is currently loading"),this.doServe=!0;break;case Qt.LOADED:this.state=Qt.SERVED,this.logger.debug("serve",this.adInfos),this.formatInstance.filter(()=>!Object(O.c)(this)).forEach(e=>{e.start(),Object(Gt.a)(this,e.player.getMediafile())}),this.logger.debug("ad successfully served"),this.adInfos.ad&&!Object(O.b)(this)||(this.logger.debug("serve - no ad to serve so exec passback"),this.execPassback())}return e}reload(){return Jt.page(this.pageId).placement(this.pid,this.rawSettings,this.defer,this.pageIndex+1)}passback(e,t=!1){return Object(a.includes)([Qt.SERVED,Qt.PASSBACKED],this.state)&&!t?this.reload().passback(e):(Object(a.includes)(this.passbacks.afterServe,e)?this.logger.warn("passback - signature was already appended to the passback list",e,this.passbacks.afterServe):"function"==typeof e?(this.passbacks.afterServe.push(e),this.logger.debug("passback - pushed to the list",e),t&&(this.passbacks.beforeServe.push(e),this.logger.debug("passback - pushed to the *before serve* list too")),this.doPassback&&(this.logger.debug("passback - execPassback already called with no passback to exec, call it again"),this.doPassback=!1,this.execPassback())):this.logger.warn("passback - must be a function"),this)}fillCustomTracking(e){const t=Object(bt.a)(this.pageId,this.pid,this.pageIndex),i=Object(m.a)(qt.a,a.cArray.forEach(Object(m.a)(Object(E.tap)(bt.b.format.addFormatCustomTrackings(t)),e=>this.logger.debug(`[${t}][classic] Add custom tracking`,e)))),n=Object(m.a)(qt.b,b.a.biforeach(a.cArray.forEach(bt.b.vast.addVastCustomProgressTrackings(t)),a.cArray.forEach(bt.b.vast.addVastCustomTrackings(t))));Object(m.b)(e,Object(E.tap)(Object(m.a)(a.cArray.filter(qt.d),i)),Object(E.tap)(Object(m.a)(a.cArray.filter(qt.e),n)),Object(m.a)(a.cArray.filter(e=>!Object(qt.d)(e)&&!Object(qt.e)(e)),e=>{e.length>0&&this.logger.warn("Could not add unsupported custom trackings",e)}))}execPassback(){let e;switch(this.state){case Qt.SERVED:case Qt.PASSBACKED:e=this.passbacks.afterServe,this.logger.debug("exec passback - after serve");break;default:e=this.passbacks.beforeServe,this.logger.debug("exec passback - before serve")}if(e.length){let t=e.shift();return this.logger.debug("exec passback -",t),this.state=Qt.PASSBACKED,t(()=>this.execPassback()),this.doPassback=!1,null}return this.logger.debug("exec passback - no passback to exec"),this.doPassback=!0,this.passbacks.afterServe.length?null:S.c}findMatchingScript(){let e=!1;const t=x.findAllWindows(document.body);for(const i of t){const t=c.querySelectorAll("script.teads",i);for(let i=0;i<t.length;i++){this.scripts.push(t[i]);const n=t[i]?t[i].getAttribute("data-serve"):"";n&&n.match(this.pid.toString())&&(t[i].setAttribute("data-serve",n.replace(this.pid.toString(),"")),e=!0)}}return e}constructAdSettings(e=g.b.empty()){var t,i;const n=Jt.defaultAdsSettings,s=e.getOrValue({}),r=null!==(t=Xt[this.pid])&&void 0!==t?t:{};return Object.assign(Object.assign(Object.assign(Object.assign({},n),s),r),{settings:Object.assign(Object.assign(Object.assign({},n.settings),r.settings),{values:Object.assign(Object.assign(Object.assign({},n.settings.values),{pageId:this.pageId,placementId:this.pid,placementFormat:this.settings.format}),null===(i=r.settings)||void 0===i?void 0:i.values)})})}handleHeaderBiddingAd(){this.getAd=this.constructAdSettings()}handleDataInsertion(e){const t="data-insertion-"+e,i=x.findAllWindows(document.body),n=c.findMatchingElement(Object(a.map)(i,e=>e.document),`script.teads[${t}]`);return Jt.getRawAdFromScript(n,t,this.logger,Object(zt.a)(this.constructAdSettings,this))}findCustomTracking(e){let t=[];for(let i of e){let e='data-tracking(?:-(\\d+))?-([^=]+)="([^"]+)"';let n=(c.getOuterHTML(i)||"").match(new RegExp(e,"g"))||[];for(let s of n){let n=s.match(new RegExp(e));if(4===n.length){const[,e,s,r]=n;(e&&Number(e)===this.pid||!e)&&(this.logger.debug("find custom tracking (event, url, pid)",s,r,e),t.push({event:s,url:r}),e&&i.removeAttribute(`data-tracking-${e}-${s}`))}else this.logger.debug('error on data-tracking extraction, 3 args expected (["all", "key", "value"])',n)}}return t}sendTagToWigo(){this.wigo.valid(0,1,{ttp:this.settings,tta:this.adInfos.ad,tts:this.adInfos.placement.placementSetting},"modal")}onReadyState(e){let t;const i=x.findAllWindows(document.body);for(const e of i)t=t||e.document.querySelector("script.teads[data-readystate]");t&&"domcomplete"===t.getAttribute("data-readystate")?(this.logger.debug("waiting dom complete"),c.onDomComplete(e)):(this.logger.debug("waiting dom ready"),c.onDomReady(e))}}Jt.defaultRawPlacement={pid:null,format:null,slot:null},Jt.defaultAdsSettings={settings:{values:{pageId:0,placementFormat:"inread",placementId:1,threshold:50}}};const Zt=window.teads||{};Zt.ad=Jt.ad,Zt.page=Jt.page,Zt.TAG=$t,Zt.TAG_STATUS=Qt,Zt.TagManager=Jt,Zt.helper=Zt.helper||{},Zt.placement=Zt.placement||{},Zt.pageInstance=Zt.pageInstance||Bt,window.teads=Zt,Object(y.i)({name:"a"}),Ht.info("Init - Format initialization success"),d.startAutoplayTest(),Object(y.a)(["tag","format"],Object(x.findChildWindows)(document.body).concat(window)),g.b.fromNullable(window.teads.PAGE_PROCESSED).forEach(e=>Ut=e),g.b.fromNullable(window.teads.currentPlayerId).forEach(e=>Wt=e),d.isAmp()&&(window.context.observeIntersection(e=>{window._teads_amp.change=e.pop(),ye.d()}),ye.d()),D.b.loadAndStoreReportIfNeeded(s.a),Bt=new Ft,Object(y.i)({name:"d"}),c.onDomReady(()=>Et({ttpObject:g.b.fromNullable(window._ttp),pageInstance:Bt}).tapLeft(e=>Ht.error(e)))}]);