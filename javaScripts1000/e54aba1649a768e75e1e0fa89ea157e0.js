Cube("datav:/npm/dchart-line-with-point/0.4.30",["datav:/npm/dchart-core/2.6.52/line/line","datav:/npm/dchart-core/2.6.52/util","datav:/npm/d3/3.5.12"],function(a,b,c){function d(a,b){var c={margin:{right:20,left:10,top:10,bottom:10,containLabel:!0},xaxis:{type:"category",padding:0.2,dy:10},yaxis:{},point:{radius:5},tooltip:{axisPointer:"line"},legend:{show:!0,margin:{top:10,bottom:20,left:0,right:0},legendLabels:[],customRender:function(a,b){this.attr({transform:"translate("+b.x+", "+(b.y+b.height/2)+")"});var c,d,e;c=this.select("line")[0][0]?this.select("line"):this.append("line"),d=this.select("circle")[0][0]?this.select("circle"):this.append("circle"),e=this.select("text")[0][0]?this.select("text"):this.append("text"),c.attr({x1:5,y1:5,x2:25,y2:5}),d.attr({cx:15,cy:5,r:5}),e.html(a).attr({x:30,y:5,dy:".35em"})}},beforeLayout:{legend:{position:"bottom",height:"50",width:"500"}},series:[{color:null,colorWidth:null,point:{color:null,frameColor:null,frameColorWidth:null,hide:null,radius:4},style:"solid",dashed:"4 4"}]};c=f.deepMerge(c,b),e.call(this,a,c)}var e=c("datav:/npm/dchart-core/2.6.52/line/line"),f=c("datav:/npm/dchart-core/2.6.52/util"),g=c("datav:/npm/d3/3.5.12"),h=f.SERIES_INDEX,j=f.interactionHandlerSelector;return d=e.extend(d,{beforeRender:function(){e.prototype.beforeRender.call(this);var a=this,b=this.options,c=b.xaxis.key,d=b.yaxis.key;if(b.legend&&b.legend.show){var f=this.legend=this.renderLegend("legend",this.el[0][0],this.options.legend);f.el.selectAll(".legend-label").on("click",function(b,c){a.emit("legend-click",{index:c+1,dom:this})})}},updateBeforeRender:function(){var a=this.options,b=this.data(),c=this,d=a.xaxis.key,e=a.yaxis.key;if(this.legend)this.legend.update(b,a.legend),this.legend.el.selectAll(".legend-label").on("click",function(a,b){c.emit("legend-click",{index:b+1,dom:this})});else if(a.legend&&a.legend.show){var f=this.legend=this.renderLegend("legend",this.el[0][0],this.options.legend);f.update(b,a.legend),f.el.selectAll(".legend-label").on("click",function(a,b){c.emit("legend-click",{index:b+1,dom:this})})}},afterRender:function(){var a=this.options,b=this.data(),c=this.getComs("axis","xaxis"),k=c.getX(),l=this.getComs("axis","yaxis"),m=l.getX(),n=a.xaxis.key,o=a.yaxis.key,d=a.isFirst?this.svg.append("g").attr({class:"scatterplot-g series interaction-g",transform:this.svg.select(".series:not(.area-g)").attr("transform")}):this.svg.select(".scatterplot-g").attr("transform",this.svg.select(".series:not(.area-g)").attr("transform")),p=f.maxBy(b,function(a){return a[o].length})[o].length,q=function(b,d,e){var h=b[o].value,i=g.select(this);a.animation&&(a.isFirst&&i.attr({cx:function(b){return a.hiddenEmptyData&&b[o][e].__isNull?void 0:k("time"===a.xaxis.type?g.time.format(c.options.format).parse(b[n]):b[n])+("category"===a.xaxis.type?k.rangeBand()/2:0)},cy:function(b){return a.hiddenEmptyData&&b[o][e].__isNull?void 0:m(f.isNumber(b[o][e].value)?+b[o][e].value:l.getMin())},r:0}),i.transition().duration(a.animationDuration).ease(a.animationEasing));var j=a.series[e]&&a.series[e].point||a.point,p=b[o][e].value;f.isNumber(+p)&&i.attr({cx:function(){return b[o][e].__isNull&&a.hiddenEmptyData?void 0:k("time"===a.xaxis.type?g.time.format(c.options.format).parse(b[n]):b[n])+("category"===a.xaxis.type?k.rangeBand()/2:0)},cy:function(){return b[o][e].__isNull&&a.hiddenEmptyData?void 0:!+p&&b.isNull&&a.hiddenEmptyData?m(l.getMin()):m(+p)},r:j.radius||4})||i.attr({cx:function(){return b[o][e].__isNull&&a.hiddenEmptyData?void 0:k("time"===a.xaxis.type?g.time.format(c.options.format).parse(b[n]):b[n])+("category"===a.xaxis.type?k.rangeBand()/2:0)},cy:function(){return b[o][e].__isNull&&a.hiddenEmptyData?void 0:m(l.getMin())},r:a.hiddenEmptyData?0:j.radius||4}),j&&f.isObject(j)&&i.style({fill:function(){return j.color},stroke:function(){return j.frameColor},"stroke-width":function(){return j.frameColorWidth},display:(a.hiddenEmptyData&&b[o][e].__isNull||j.hide)&&"none"||"block"})};d=d.selectAll(".series-group").data(b),this.enterSeries=d.enter().append("g").attr("class","series-group");for(var r=0;r<p;r++)this.enterSeries.append("circle").attr("class",j+" serie serie"+(r+1)).attr(h,r).each(function(a,b){q.call(this,a,b,r)}),d.each(function(a,b){var c=g.select(this),d=c.select(".serie"+(r+1))[0][0]||c.append("circle").attr("class",j+" serie serie"+(r+1)).attr(h,r)[0][0];d&&q.call(d,a,b,r)});if(d.selectAll(".serie.serie"+p+" ~ .serie").remove(),d.exit().remove(),this.legend){var i=this.legend.select(".legend-label").node().getBBox(),s=i.width,t=i.height,u=b.length,v=a.beforeLayout.legend.width,w=a.beforeLayout.legend.height;if(u*s>v){var x=Math.floor(v/s);Math.floor(u/x)*t>w&&console.warn("\u8BF7\u7533\u8BF7\u66F4\u5927\u7684\u7A7A\u95F4\u653E\u56FE\u4F8B"),this.legend.selectAll(".legend-label").attr({transform:function(a,b){return"translate("+b%x*s+", "+(parseInt(b/x)*t+t/2)+")"}})}}this.svg[0][0].appendChild(this.labels[0][0]),e.prototype.afterRender.call(this)},updateAfterRender:function(){d.prototype.afterRender.call(this)},hidden:function(a){return a?(this.svg.selectAll(".serie"+a).classed("hidden",!0),this.legend&&this.legend.selectAll(".legend"+a).classed("disable",!0)):(this.svg.selectAll(".serie").classed("hidden",!0),this.legend&&this.legend.selectAll(".legend-label").classed("disable",!0)),this},show:function(a){return a?(this.svg.selectAll(".serie"+a).classed("hidden",!1),this.legend&&this.legend.selectAll(".legend"+a).classed("disable",!1)):(this.svg.selectAll(".serie").classed("hidden",!1),this.legend&&this.legend.selectAll(".legend-label").classed("disable",!1)),this},getShowIndex:function(){var a=[];return this.legend&&this.legend.selectAll(".legend-label").each(function(b,c){g.select(this).classed("disable")||a.push(c+1)}),a}}),a.exports=d,a.exports});