(function(Backbone,bowser){'use strict';function shouldDisableBodyScrolling(){return!Backbone.Webshop.mixins.isBetaFeatureEnabled('RWD_SHOW_SCROLLBAR_ON_DESKTOP')||!Backbone.Webshop.Device.getBodyScrollbarWidth();}
Backbone.Webshop.scroll.disableBodyScroll=function(supportiOSBlockScroll){if(bowser.ios&&supportiOSBlockScroll){Backbone.$(document.body).addClass('disable-ios-scroll');}else if(shouldDisableBodyScrolling()){Backbone.$(document.body).addClass('disable-scroll');}};})(Backbone,bowser,document.body);(function(Backbone,bowser){'use strict';Backbone.Webshop.scroll.restoreBodyScroll=function(supportIOS){if(bowser.ios&&supportIOS){Backbone.$(document.body).removeClass('disable-ios-scroll');}else{Backbone.$(document.body).removeClass('disable-scroll');}};})(Backbone,bowser);(function(Backbone,_){'use strict';Backbone.Webshop.scroll.preventOverScrollOnElement=function(element){if(!bowser.ios){return;}
if(element.getAttribute('data-overscroll')){return;}
element.setAttribute('data-overscroll','enabled');var allowScrollUp=true,allowScrollDown=true,lastY=0;element.addEventListener('touchstart',function(e){allowScrollUp=(this.scrollTop>0);allowScrollDown=(this.scrollTop<this.scrollHeight-this.clientHeight);lastY=e.pageY;},true);element.addEventListener('touchmove',function(e){var scrollingUp=(e.pageY>lastY),scrollingDown=(e.pageY<lastY);lastY=event.pageY;if((scrollingUp&&allowScrollUp)||(scrollingDown&&allowScrollDown)){e.stopPropagation();}else{e.preventDefault();}},true);};})(Backbone,_);(function(Backbone){'use strict';Backbone.Webshop.modal.ModalViewBehavior=Backbone.Marionette.Behavior.extend({defaults:{overlayParent:Backbone.$('body'),overlayClass:'overlay-modal',supportiOSBlockScroll:true},initialize:function(){this.view.open=this.open.bind(this);this.view.close=this.close.bind(this);},open:function(){this.view.triggerMethod('before:open');this.view.$el.addClass('open');Backbone.$('<div class="overlay '+this.options.overlayClass+'"></div>').on('click touchstart',handleOverlayClick.bind(this)).appendTo(this.options.overlayParent);Backbone.Webshop.scroll.disableBodyScroll(this.getOption('supportiOSBlockScroll'));var el=this.view.el;if(!Backbone.Webshop.mixins.isBetaFeatureEnabled('RWD_ALTERNATIVE_HEADER')||!el.className||el.className.indexOf('trolley-menu')===-1){Backbone.Webshop.scroll.preventOverScrollOnElement(el);}
this.view.triggerMethod('open');},close:function(){this.view.triggerMethod('before:close');this.view.$el.removeClass('open');this.options.overlayParent.find('div.overlay.'+this.options.overlayClass).remove();Backbone.Webshop.scroll.restoreBodyScroll(this.getOption('supportiOSBlockScroll'));this.view.triggerMethod('close');}});function handleOverlayClick(e){e.preventDefault();this.close();}})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.modal.ModalDrawerBehavior=Backbone.Webshop.modal.ModalViewBehavior.extend({defaults:{overlayParent:Backbone.$('body'),overlayClass:'overlay-menu',supportiOSBlockScroll:false}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.modal.closeAllModals=function(){Backbone.$('.overlay').trigger('click');};})(Backbone);webshop=webshop||{};webshop.popup=webshop.popup||{};webshop.popup.utils={tryParseJSON:function(jsonString){if(Object.prototype.toString.call(jsonString)==='[object Object]'){return jsonString;}
try{var o=JSON.parse(jsonString);if(o&&typeof o==="object"&&o!==null){return o;}}catch(e){}
return false;},getRedirectPath:function(ajaxResponse){redirectUrl=ajaxResponse.redirectURL||ajaxResponse.redirectionWarning;if(redirectUrl){return(redirectUrl.match(/^https?:\/\//i))?redirectUrl:'/webshop'+redirectUrl;}
return null;},redirectTo:function(path){window.location.href=path;},redirect:function(response,model){var json=this.tryParseJSON(response);if(json){var redirectPath=this.getRedirectPath(json);if(redirectPath){this.redirectTo(redirectPath);return;}}else{model.setContent(response);}},giveSubmitFeedback:function(selector){var submitBtn=jQ(selector);submitBtn.width(submitBtn.width());submitBtn.addClass('submitting').text("Submitting...");},isIphoneNavigator:function(){return Boolean(navigator.userAgent.match(/iPhone/i));},addNewParametersFromJsonObject:function(url,parameters){if(parameters){var newUrl=url+(url.indexOf('?')>-1?'&':'?');var i=0;var param;for(var parameterName in parameters){param=encodeURIComponent(parameterName)+'='+encodeURIComponent(parameters[parameterName]);newUrl=(i===0)?newUrl+param:newUrl+'&'+param;i++;}
return newUrl;}
else{return url;}}};ocBackbone=ocBackbone||{};ocBackbone.popup=ocBackbone.popup||{};ocBackbone.popup.PopupModel=Backbone.Model.extend({defaults:{display:true,content:'<p>Default content.</p><p><strong>Please change me.</strong></p>',classNames:[],isContentFetched:true,modalTitle:''},hide:function(){this.set('display',false);},show:function(){this.set('display',true);},isDisplayed:function(){return this.get('display');},clearContent:function(){this.set('content',null);},setContent:function(content){this.set('content',content);},setTitle:function(title){this.set('headerTitle',title);},setModalTitle:function(title){this.set('modalTitle',title);},setSuccessRedirectUrl:function(url){this.set('successRedirectUrl',url);},getSuccessRedirectUrl:function(){return this.get('successRedirectUrl');},addClass:function(className){var newNames=className.split(' ');var oldNames=this.get('classNames');this.set('classNames',_.union(oldNames,newNames));},removeClass:function(className){var newNames=className.split(' ');var oldNames=this.get('classNames');this.set('classNames',_.difference(oldNames,newNames));}},{extend:function(child){var model=Backbone.Model.extend.apply(this,arguments);model.prototype.defaults=_.extend({},this.prototype.defaults,child.defaults);return model;}});ocBackbone=ocBackbone||{};ocBackbone.popup=ocBackbone.popup||{};ocBackbone.popup.AjaxPopupModel=ocBackbone.popup.PopupModel.extend({defaults:{display:false,content:'Loading...',classNames:[],isContentFetched:false},url:function(){return this.get('url');},parse:function(response,options){var json=webshop.popup.utils.tryParseJSON(response);if(json){var redirectPath=webshop.popup.utils.getRedirectPath(json);if(redirectPath){return this.redirectionHandler(redirectPath);}}
return{'isContentFetched':true,content:response};},redirectionHandler:function(location){window.location.href=location;},defaultDataType:'html',fetch:function(options){options=jQ.extend(options,{dataType:this.defaultDataType});return ocBackbone.popup.PopupModel.prototype.fetch.call(this,options);},fetchAndDisplay:function(options){if(!this.get('isContentFetched')){this.fetch(options);}
this.show();}});ocBackbone=ocBackbone||{};ocBackbone.popup=ocBackbone.popup||{};ocBackbone.popup.AjaxPopupModelRedir=ocBackbone.popup.AjaxPopupModel.extend({parse:function(response,options){this.set('isContentFetched',true);var json=webshop.popup.utils.tryParseJSON(response),redirectUrl,content;if(json){redirectUrl=webshop.popup.utils.getRedirectPath(json);if(!redirectUrl){window.location.href='/webshop/error.do';}else{window.location.href=redirectUrl;content='<h1>Redirecting...</h1>';}}else{content=response;}
return{content:content};}});ocBackbone=ocBackbone||{};ocBackbone.popup=ocBackbone.popup||{};ocBackbone.popup.PopupView=(function(){function renderPopup(){this.$el.html(this.template(this.model.toJSON()));jQ('body').append(this.$el);this.$('.modal').position('center');}
function removePopup(){this.$el.html('');}
return Backbone.View.extend({className:'modal-wrapper',events:{'click .overlay,.close':'closePopup'},getOption:Backbone.Marionette.proxyGetOption,template:_.template('<div class="overlay overlay-modal"></div><div class="modal <%= classNames.join(\' \') %>"><a href="#" class="close"></a><%= content %></div>'),initialize:function(attrs){this.options=attrs;this.listenTo(this.model,'change',this.render);},closePopup:function(){this.onClose();this.model.hide();},render:function(){if(this.model.isDisplayed()){renderPopup.call(this);if(typeof this.onShow==='function'){this.onShow();}}else{removePopup.call(this);}
return this;},onClose:function(){}},{extend:function(child){var view=Backbone.View.extend.apply(this,arguments);view.prototype.events=_.extend({},this.prototype.events,child.events);return view;}});})();(function(Backbone,ocBackbone,window,_){'use strict';Backbone.Webshop.popup.MobilePopupView=Backbone.Marionette.ItemView.extend({isAnimated:true,blockBodyScroll:true,blockOverScroll:false,className:'modal-wrapper',disableScrollableContent:false,scrolledY:null,supportiOSBlockScroll:true,events:{"click @ui.close":'closePopup'},modelEvents:{'change':'render'},ui:{modal:'.mobileModal',close:'.closeButton, .overlay',overlayModal:'.overlay-modal'},template:_.template('<div class="overlay overlay-modal"></div>'+'<div class="mobileModal <%= data.classNames.join(\' \') %>">'+'<div class="modalHeader">'+'<% if (data.modalTitle) {%><span class="modalTitle"><%=data.modalTitle%></span><%}%>'+'<a href="javascript:void(0);" class="closeButton"></a></div>'+'<div id="js-popup-content" class="modalContent<% if (!data.disableScrollableContent) {%> scrollable<%}%>">'+'<% if (data.headerTitle) {%><span class="headerTitle"><h1 class="title"><%=data.headerTitle%></h1></span><%}%>'+'<%= data.content %></div>'+'</div>',{variable:'data'}),templateHelpers:function(){return{classNames:_.union(this.model.get('classNames'),(this.isAnimated?['modalAnim']:[])),headerTitle:this.model.get('headerTitle'),modalTitle:this.model.get('modalTitle'),disableScrollableContent:this.disableScrollableContent};},initialize:function(){if(this.getOption('blockOverScroll')===false){this.blockOverScroll=false;}},attachElContent:function(html){this.$el.html(html);Backbone.$('body').append(this.$el);return this;},render:function(){if(this.model.isDisplayed()){if(this.model.get('isContentFetched')){Backbone.Marionette.ItemView.prototype.render.call(this);this.delegateEvents(this.events);this.openPopup();}}else{this.$el.remove();}},openPopup:function(callback){if(this.blockBodyScroll){this.scrolledY=windowScrollY();Backbone.Webshop.scroll.disableBodyScroll(this.supportiOSBlockScroll);if(this.blockOverScroll){Backbone.Webshop.scroll.preventOverScrollOnElement(this.ui.modal.get(0));}}
this.onShow();openPopup.call(this,callback);},closePopup:function(callback){this.onClose(callback);if(this.blockBodyScroll){window.scrollTo(0,this.scrolledY);Backbone.Webshop.scroll.restoreBodyScroll(this.supportiOSBlockScroll);}
closePopup.call(this,callback);},onClose:function(){},onShow:function(){},triggerOpenedEvent:function(){this.trigger('popup:mobile:opened');}},{extend:function(child){var view=Backbone.Marionette.ItemView.extend.apply(this,arguments);view.prototype.events=_.extend({},this.prototype.events,child.events);view.prototype.ui=_.extend({},this.prototype.ui,child.ui);view.prototype._parentRender=this.prototype.render;view.prototype.closePopup=child.onClose||this.prototype.closePopup;return view;}});function openPopup(callback){var _this=this;window.requestAnimationFrame(function(){_this.ui.modal.addClass('modalOpen');_this.ui.overlayModal.addClass('modalOpen');});runCallbacks.call(this,composeCallbacks(this.triggerOpenedEvent.bind(this),callback));}
function closePopup(callback){this.ui.modal.removeClass('modalOpen');this.ui.overlayModal.removeClass('modalOpen');var _this=this;window.requestAnimationFrame(function(){runCallbacks.call(_this,composeCallbacks(_this.model.hide.bind(_this.model),callback));});}
function runCallbacks(callbacks){if(this.isAnimated){setTimeout(callbacks,400);}else{callbacks();}}
function composeCallbacks(){var callbacks=_.filter(arguments,_.isFunction);return function(){callbacks.forEach(function(callback){callback();});};}
function windowScrollY(){return(window.pageYOffset!==undefined)?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;}})(Backbone,ocBackbone,window,_);(function(Backbone,ocBackbone){'use strict';Backbone.Webshop.popup.AjaxConfirmationPopupModel=ocBackbone.popup.AjaxPopupModel.extend({defaults:{content:'<h1>Loading...</h1>',confirmText:'Yes',cancelText:'No'}});})(Backbone,ocBackbone);(function(Backbone,ocBackbone){'use strict';Backbone.Webshop.popup.AjaxConfirmationPopupModelRedir=ocBackbone.popup.AjaxPopupModelRedir.extend({defaults:{content:'<h1>Loading...</h1>',confirmText:'Yes',cancelText:'No'}});})(Backbone,ocBackbone);(function(Backbone,_){'use strict';Backbone.Webshop.popup.ConfirmationPopupView=Backbone.Webshop.popup.MobilePopupView.extend({id:'confirmationPopup',events:{'click .confirmLink':'confirm','click .cancelLink':'closePopup','click .overlay':'closePopup'},template:_.template('<div class="overlay overlay-modal"></div>'+'<div class="mobileModal <%= classNames.join(\' \') %>">'+'<div class="modalHeader"><%= modalTitle %><a class="closeButton"></a></div>'+'<div class="modalContent cancel-confirmation-popup"><%= content %>'+'<% if (isContentFetched) { %>'+'<div class="popupButtons btn-wrapper">'+'<a class="btn-secondary cancelLink"><%= cancelText %></a>'+'<a class="btn-primary confirmLink"><%= confirmText %></a>'+'</div>'+'<% } %>'+'</div>'+'</div>')});})(Backbone,_);(function(Backbone){"use strict";Backbone.Webshop.IntroducingCouponPopupView=Backbone.Webshop.popup.MobilePopupView.extend({events:{'click .js-close':'closePopup'},model:new ocBackbone.popup.PopupModel({display:false,content:Handlebars.templates['coupons/introducingCouponsPopup']()}),onShow:function(){Backbone.Webshop.popup.MobilePopupView.prototype.onShow.apply(this);this.logAnalyticsEvent();},logAnalyticsEvent:function(){Backbone.$.ajax({type:'POST',url:'/webshop/coupons/notification/',data:{event:'introPopup'}});},});if(Backbone.$('#js-showPersonalisedCouponsPopup').length){var personalisedCouponsPopup=new Backbone.Webshop.IntroducingCouponPopupView();personalisedCouponsPopup.model.show();}})(Backbone);(function(window,Backbone){"use strict";Backbone.Webshop.FreeSmartPassPopupView=Backbone.Webshop.popup.MobilePopupView.extend({events:{'click .js-close':'closePopup'},model:new ocBackbone.popup.PopupModel({display:false,content:''})});var freeSmartPassData=JSON.parse(Backbone.$('#js-freeSmartPassData').html()||"null");if(freeSmartPassData&&typeof window.freeSmartPassPopupView=='undefined'){var freeSmartPassPopupView=window.freeSmartPassPopupView=new Backbone.Webshop.FreeSmartPassPopupView();var smartPassInfo=freeSmartPassData.freeDiscountClubData;var data={faqLink:freeSmartPassData.faqLink,actionLink:freeSmartPassData.actionLink,discountClubTermsLink:freeSmartPassData.discountClubTermsLink,freeDiscountClubData:smartPassInfo,isAnytime:smartPassInfo.popupType==="ANYTIME",isMidweek:smartPassInfo.popupType==="MIDWEEK",contractLength:smartPassInfo.contractLength,schemeName:smartPassInfo.schemeName,endDateFriendly:smartPassInfo.endDateFriendly};freeSmartPassPopupView.model.set({content:Handlebars.templates['discountClub/freeSmartPassPopup'](data)});freeSmartPassPopupView.model.show();}})(window,Backbone);(function(Backbone){"use strict";Backbone.Webshop.AddressOutOfZonePopupView=Backbone.Webshop.popup.MobilePopupView.extend({events:{'click .js-close':'closePopup'},model:new ocBackbone.popup.PopupModel({display:false,content:Handlebars.templates['homepage/addressOutOfZonePopup']()})});if(Backbone.$('#js-showAddressOutOfZonePopup').length){var addressOutOfZonePopupView=new Backbone.Webshop.AddressOutOfZonePopupView();addressOutOfZonePopupView.model.show();}})(Backbone);(function(Backbone,_){'use strict';Backbone.Webshop.popup.LoginAndRegistrationBehavior=Backbone.Marionette.Behavior.extend({default:{isRegistration:false,parameters:{"popup":true,"isResponsive":true,"trackAjax":true,"_csrf":jQ("meta[name='_csrf']").attr("content")}},ui:{btnDisconnectFacebook:'#changeFacebookAccount',btnDisconnectPaypal:'#changePaypalAccount',btnFacebookLinked:'#btnFbLinked',btnLinkRegister:'#registerButton',btnLogin:'.btn-wrapper .login',btnLoginFacebook:'.fb-login-button',btnLoginFacebookElevate:'#js-popup-content .fb-elevate-login-button',btnLoginHeader:'#loginButton',btnLoginNavHeader:'.btn-login',btnRegister:'.btn-wrapper .btn-register,[data-requireslogin=newCustomer]',btnRegisterHeader:'#quickReg',btnRegisterNavHeader:'.btn-signup',btnRegisterSubmit:'#buttonRegisterSubmit',btnSmartPassLogin:'.login-button>.btn-primary',linkLogin:'#js-open-login',linkRequiresElevation:'[data-requireselevatedlogin=true]',linkRequiresLogin:'[data-requireslogin=true]',formFacebook:'#js-popup-content #facebookForm',formLinkFacebook:'#linkAccountForm.facebook-login',formLinkPaypal:'#linkAccountForm.paypal-login',formLogin:'.popup-wrapper #simpleLoginForm.regular',formLoginMobile:'#js-popup-content #simpleLoginForm.regular',formLoginElevated:'#simpleLoginForm.elevated',formRegister:'#quickRegAcceptForm',formRegisterLinkedAccount:'#registerForm',formSocialLogin:"#socialLogin"},events:{'click @ui.btnDisconnectFacebook':'disconnectFacebook','click @ui.btnDisconnectPaypal':'disconnectPaypal','click @ui.btnLinkRegister':'registerButtonAction','click @ui.btnLogin':'openLoginPopup','click @ui.btnLoginFacebook':'loginWithFacebook','click @ui.btnLoginFacebookElevate':'reauthenticateWithFacebook','click @ui.btnLoginHeader':'openLoginPopup','click @ui.btnLoginNavHeader':'openLoginPopup','click @ui.linkRequiresElevation':'openElevatedLoginPopup','click @ui.linkRequiresLogin':'openLoginPopup','click @ui.btnRegister':'openRegistrationPopup','click @ui.btnRegisterHeader':'openRegistrationPopup','click @ui.btnRegisterNavHeader':'openRegistrationPopup','click @ui.btnFacebookLinked':'redirectToRegistrationPage','click @ui.btnSmartPassLogin':'openLoginPopup','click @ui.linkLogin':'redirectToLoginPage','submit @ui.formFacebook':'submitFacebookForm','submit @ui.formLinkFacebook':'linkFacebookAccount','submit @ui.formLinkPaypal':'linkPaypalAccount','submit @ui.formLogin':'login','submit @ui.formLoginMobile':'login','submit @ui.formLoginElevated':'loginElevated','submit @ui.formRegister':'register','submit @ui.formRegisterLinkedAccount':'registerLinkedAccount','paypal:redirect':'submitPaypalForm'},facebookServiceEvents:{"identifyUser:dataValid":'redirectToTargetPage',"identifyUser:dataInvalid:emailPresent":'loadLinkAccountOverlay',"identifyUser:dataInvalid:emailAbsent":'goToRegisterForm',"facebookFallback":'facebookFallback'},initialize:function(){var _this=this;if(Backbone.Facebook.getInstance){this.facebookService=Backbone.Facebook.getInstance();this.bindEntityEvents(this.facebookService,this.facebookServiceEvents);}
webshop.gtm.registerEventSource(this);var classNames=['login-modal'];if(Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_INTEGRATION')){classNames.push('sso-full-content-modal');}
this.popupModel=new ocBackbone.popup.AjaxPopupModel({display:false,classNames:classNames});var PopupViewClass=webshop.jsConfig.popupViewClass();new PopupViewClass({model:this.popupModel,className:'rwd-site modal-wrapper',id:'loginPopup'});},updateModel:function(url){var popupModel=this.popupModel;popupModel.removeClass("registrationModal full-sso-registration-modal");popupModel.fetch({url:url,complete:popupModel.show()});},openLoginPopup:function(event){event.preventDefault();var href=event.currentTarget.href;var successRedirect;var targetUri;if(event.currentTarget.getAttribute('data-requireslogin')==="true"){targetUri="/webshop/login.go?from="+this.getPageDestinationFromUrl(href);successRedirect=href;}else{targetUri=href.replace(window.location.origin,'');successRedirect=this.getSuccessRedirectForCurrentLocation();}
if(this.isSsoFullRedirectEnabled()&&targetUri.startsWith('/webshop/login.go')){window.location.href=webshop.popup.utils.addNewParametersFromJsonObject(targetUri,{success_redirect:successRedirect});}else{this.popupModel.setSuccessRedirectUrl(successRedirect);this.updateLogInPopUp(this.getParameterisedUrl(targetUri,successRedirect));this.isRegistration=false;}},isSsoFullRedirectEnabled:function(){return Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_INTEGRATION')&&Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_FULL_REDIRECT');},isSsoElevatedLoginEnabled:function(){return Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_INTEGRATION')&&Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_ELEVATED_LOGIN');},isContextKeepingEnabled:function(){return Backbone.Webshop.mixins.isBetaFeatureEnabled('ACQUISITION_23586_CONTEXT_KEEPING');},getSuccessRedirectForCurrentLocation:function(){return webshop.common.jsTopBodyVariables.doNotRedirectAfterLogin?'':window.location.href;},getPageDestinationFromUrl:function(href){var parts=href.split("/webshop/");var actionComponent=parts[1];return actionComponent.substring(0,actionComponent.indexOf("."));},openElevatedLoginPopup:function(event){event.preventDefault();var targetUri="/webshop/loginElevated.go";var successRedirect=event.currentTarget.href;if(this.isSsoElevatedLoginEnabled()){window.location.href=webshop.popup.utils.addNewParametersFromJsonObject(targetUri,{success_redirect:successRedirect});}else{this.updateModel(this.getParameterisedUrl(targetUri,successRedirect));this.popupModel.setSuccessRedirectUrl(successRedirect);this.popupModel.setTitle(getMessage('login.login.logIn'));}},login:function(event){event.preventDefault();this.loginDebounce(event);},loginDebounce:_.debounce(function(event){webshop.popup.utils.giveSubmitFeedback(".btn-primary");var form=event.target;this.ajaxCall(this.getParameterisedUrl("/webshop/login.go"),form);},2000,true),loginElevated:function(event){event.preventDefault();var form=event.target;this.ajaxCall(this.getParameterisedUrl("/webshop/loginElevated.go"),form);},setRegistrationPopUpClassAndTitle:function(){this.popupModel.addClass('registrationModal');if(Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_INTEGRATION')){this.popupModel.setTitle(null);this.popupModel.addClass('full-sso-registration-modal');}else{this.popupModel.setTitle(getMessage('register.quickReg.header'));}},redirectToRegistrationPage:function(event){event.preventDefault();var _this=this;this.ajaxCall(this.getParameterisedUrl(event.currentTarget.href)).done(function(){_this.setRegistrationPopUpClassAndTitle();});},redirectToLoginPage:function(event){event.preventDefault();this.updateLogInPopUp();},registerButtonAction:function(event){if(Backbone.$(event.target).closest('#js-popup-content').length){this.redirectToRegistrationPage(event);}else{this.openRegistrationPopup(event);}},openRegistrationPopup:function(event){event.preventDefault();if(this.isSsoFullRedirectEnabled()){if(this.isContextKeepingEnabled()){window.location.href=event.currentTarget.href;}else{var successRedirect=this.getSuccessRedirectForCurrentLocation();window.location.href=webshop.popup.utils.addNewParametersFromJsonObject(event.currentTarget.href,{success_redirect:successRedirect});}}else{this.updateModel(this.getParameterisedUrl(event.currentTarget.href));this.setRegistrationPopUpClassAndTitle();this.isRegistration=true;}},register:function(event){event.preventDefault();this.registerDebounce(event);},registerDebounce:_.debounce(function(event){webshop.popup.utils.giveSubmitFeedback(this.ui.btnRegisterSubmit);var form=event.target;this.ajaxCall('/webshop/ajaxQuickRegAcceptForm.do',form).done(function(response){var json=webshop.popup.utils.tryParseJSON(response);if(json){var redirectPath=webshop.popup.utils.getRedirectPath(json);if(redirectPath){webshop.popup.utils.redirectTo(redirectPath);}}});},2000,true),submitFacebookForm:function(event){event.preventDefault();this.isFacebook=true;var successRedirectUrl=jQ('.js-facebook-login-success-redirect').val();if(successRedirectUrl){this.popupModel.setSuccessRedirectUrl(successRedirectUrl);}
var form=Backbone.$(event.target);var _this=this,formData=form.serialize(),authResponse=_.object(_.map(form.serializeArray(),_.values));Backbone.$.ajax({url:'/webshop/isFacebookUserRegistered.go',data:formData,dataType:'json',type:'GET',complete:function(response){if(response.responseText.indexOf('"valid":true')!=-1){if(_this.isRegistration){_this.displayStartShoppingForm(authResponse);}
else{_this.login(event);}}else{if(_this.isRegistration){_this.ajaxCall('/webshop/ajaxFacebookRegistration.do',event.target);}
else{_this.ajaxCall('/webshop/ajaxLinkAccountDisplay.go',event.target);}}}});},displayStartShoppingForm:function(authResponse){var redirectUrl=window.location.href;var startShoppingLoginForm=Handlebars.templates['registration/facebook/startShoppingLoginForm']({loginUrl:'/webshop/login.go?success_redirect='+encodeURIComponent(redirectUrl),authResponse:authResponse,loginToken:Backbone.$('#loginToken').val(),_csrf:jQ("meta[name='_csrf']").attr("content")});Backbone.$(this.ui.formSocialLogin).html(startShoppingLoginForm);},handlePayPalElevatedLogin:function(paypalReturnRedirect){var successRedirectUrl=this.popupModel.getSuccessRedirectUrl();if(successRedirectUrl&&paypalReturnRedirect.indexOf('/webshop/login.go')!==-1&&paypalReturnRedirect.indexOf('success_redirect=')===-1){paypalReturnRedirect=webshop.popup.utils.addNewParametersFromJsonObject(paypalReturnRedirect,{"success_redirect":successRedirectUrl});}
return paypalReturnRedirect;},submitPaypalForm:function(event,paypalReturnRedirect){event.preventDefault();paypalReturnRedirect=paypalReturnRedirect||'/webshop/paypalsignup.do';paypalReturnRedirect=webshop.popup.utils.addNewParametersFromJsonObject(paypalReturnRedirect,this.default.parameters);paypalReturnRedirect=this.handlePayPalElevatedLogin(paypalReturnRedirect);var form=event.target;this.ajaxCall(paypalReturnRedirect,form);this.isFacebook=false;},linkFacebookAccount:function(event){event.preventDefault();var form=event.target;this.ajaxCall('/webshop/linkFacebookAccount.go?ajax=true',form);},linkPaypalAccount:function(event){event.preventDefault();var form=event.target;this.ajaxCall('/webshop/paypalLinkAccountAcceptForm.do?ajax=true',form);},registerLinkedAccount:function(event){event.preventDefault();var url=this.isFacebook?'/webshop/ajaxFacebookRegistration.do':'/webshop/ajaxPaypalRegister.do',_this=this;this.ajaxCall(url).done(function(){_this.setRegistrationPopUpClassAndTitle();});},disconnectFacebook:function(event){event.preventDefault();FB.logout();if(this.isRegistration){this.updateModel('/webshop/ajaxQuickReg.do?from=alreadyLinkedFacebookAccount');this.popupModel.addClass('registrationModal');this.popupModel.addClass('full-sso-registration-modal');}
else{this.updateLogInPopUp(this.getParameterisedUrl("/webshop/login.go"));}},disconnectPaypal:function(event){event.preventDefault();this.updateLogInPopUp(this.getParameterisedUrl("/webshop/login.go"));},updateLogInPopUp:function(href){this.updateModel(href);if(Backbone.Webshop.mixins.isBetaFeatureEnabled('SSO_INTEGRATION')){this.popupModel.setTitle(null);}else{this.popupModel.setTitle(getMessage('login.login.logIn'));}},getParameterisedUrl:function(href,successRedirect){var parameters=successRedirect?_.extend({},this.default.parameters,{success_redirect:successRedirect.replace(window.location.origin,'')}):this.default.parameters;var paramUrl=webshop.popup.utils.addNewParametersFromJsonObject(href,parameters);paramUrl=paramUrl.replace("quickReg","ajaxQuickReg");return paramUrl;},ajaxCall:function(url,data){var formData=Backbone.$(data).serialize(),popupModel=this.popupModel,type=data?'POST':'GET';return Backbone.$.ajax({url:url,data:formData,type:type,success:function(response){var json=webshop.popup.utils.tryParseJSON(response);if(json){var redirectPath=webshop.popup.utils.getRedirectPath(json)||popupModel.getSuccessRedirectUrl();if(redirectPath){webshop.popup.utils.redirectTo(redirectPath);}}else{if(response.length>0){popupModel.clearContent();popupModel.setContent(response);}
if(Backbone.$('#recaptcha-ajax-wrapper').length>0){Backbone.$('.login-modal').addClass('popupLoginWithCaptchaContainer');}}}});},loginWithFacebook:function(event){event.preventDefault();this.facebookService.authenticate();this.trigger('gtm:uaEvent',{category:'Login',action:'fb-loginbutton-click'});},reauthenticateWithFacebook:function(event){event.preventDefault();this.facebookService.options.loginToken=Backbone.$('#loginToken').val();this.facebookService.elevateLogin();this.trigger('gtm:uaEvent',{category:'Login',action:'fb-login-reauth'});},redirectToTargetPage:function(loginUrl,response,loginToken){webshop.social.FacebookRedirects.redirectToTargetPage(loginUrl,response,loginToken);},goToRegisterForm:function(fbuid,accessToken,signedRequest){webshop.social.FacebookRedirects.goToRegisterForm(fbuid,accessToken,signedRequest);},loadLinkAccountOverlay:function(emailExists,email,fbuid,accessToken,signedRequest){this.isRegistration=false;webshop.social.FacebookRedirects.loadLinkAccountOverlay(emailExists,email,fbuid,accessToken,signedRequest);},facebookFallback:function(){webshop.social.FacebookRedirects.facebookFallback();}});})(Backbone,_);(function(Backbone){'use strict';Backbone.Webshop.popup.LoginAndRegistrationButtonView=Backbone.Marionette.ItemView.extend({template:false,behaviors:{LoginAndRegistrationBehavior:{},SSOLoginFormBehavior:{},SSORegistrationBehavior:{},}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.RemovedNonSeasonalPromotionsPopupView=Backbone.Webshop.popup.MobilePopupView.extend({initialize:function(){this.model=new ocBackbone.popup.PopupModel({content:Handlebars.templates['promotions/removedPromotionsFromBasketPopup']()});this.render();}});})(Backbone);(function(ocBackbone){'use strict';ocBackbone.popup.OneUsePopupModel=ocBackbone.popup.PopupModel.extend({show:function(){var self=this;Backbone.ajax({url:"/webshop/webservices/account/preferences?preference="+self.get('preferenceName'),contentType:"application/json",success:function(response){if(!(response[self.get('preferenceName')]=='true')){ocBackbone.popup.PopupModel.prototype.show.call(self);}}})},hide:function(){ocBackbone.popup.PopupModel.prototype.hide.call(this);var data={};data[this.get('preferenceName')]='true';Backbone.ajax({url:"/webshop/webservices/account/preferences",type:'PUT',contentType:"application/json",data:JSON.stringify(data)});}});})(ocBackbone);(function(Backbone){'use strict';Backbone.Webshop.basket.BasketBehavior=Backbone.Marionette.Behavior.extend({events:{'click @ui.addToBasketBtn':'addItemToBasket','click @ui.removeFromBasketBtn':'removeItemFromBasket','click @ui.removeAtAllFromBasketBtn':'removeAtAllFromBasket'},addItemToBasket:function(e){e.preventDefault();this.view.model.addToBasket();},removeItemFromBasket:function(e){e.preventDefault();this.view.model.removeFromBasket();},removeAtAllFromBasket:function(e){e.preventDefault();this.view.model.removeAtAllFromBasket();}});})(Backbone);(function(Backbone,bowser){'use strict';var ENTER_KEY=13;function isQuantitySubmitted(event){return event.type==='focusout'&&!this.afterSubmit||event.type==='keypress'&&event.which===ENTER_KEY;}
function isNotNegativeInteger(value){return typeof value==='number'&&isFinite(value)&&Math.floor(value)===value&&value>=0;}
function hideInput(){this.ui.fopQuantityInfo.css({'display':'inline-block'});this.ui.fopQuantityInput.hide();}
Backbone.Webshop.basket.QuantityInputBehavior=Backbone.Marionette.Behavior.extend({ui:{fopQuantityInfo:'span.fop-in-trolley',fopQuantityInput:'input.fop-in-trolley'},events:{'click @ui.fopQuantityInfo':'showQuantityInput','focusout @ui.fopQuantityInput':'submitQuantity','keypress @ui.fopQuantityInput':'submitQuantity','input @ui.fopQuantityInput':'validateQuantity'},showQuantityInput:function(){var _this=this;this.ui.fopQuantityInfo.hide();this.ui.fopQuantityInput.css({'display':'inline-block'});this.oldQuantity=+this.ui.fopQuantityInput.val();if(bowser.ios){this.ui.fopQuantityInput.focus();this.ui.fopQuantityInput.get(0).selectionStart=0;this.ui.fopQuantityInput.get(0).selectionEnd=this.ui.fopQuantityInput.val().length;}else if(bowser.android){this.ui.fopQuantityInput.focus();this.ui.fopQuantityInput.select();}else{setTimeout(function(){_this.ui.fopQuantityInput.focus();_this.ui.fopQuantityInput.select();},10);}
this.afterSubmit=false;},validateQuantity:function(){if(this.ui.fopQuantityInput.val().length>2){this.ui.fopQuantityInput.val(this.ui.fopQuantityInput.val().substring(0,2));}},submitQuantity:function(event){if(isQuantitySubmitted.call(this,event)){event.preventDefault();if(event.type==='keypress'){this.afterSubmit=true;}
var quantity=+this.ui.fopQuantityInput.val();if(isNotNegativeInteger(quantity)){var diff=quantity-this.oldQuantity;var _this=this;if(diff>0){this.ui.fopQuantityInput.attr('disabled','disabled');this.view.model.addToBasket(diff).done(function(){if(!_this.view.isDestroyed){_this.view.render();}});}else if(diff<0){this.ui.fopQuantityInput.attr('disabled','disabled');this.view.model.removeFromBasket(-diff).done(function(){if(!_this.view.isDestroyed){_this.view.render();}});}else{hideInput.call(this);}}else{this.ui.fopQuantityInput.val(this.oldQuantity);hideInput.call(this);}}}});})(Backbone,bowser);(function(Backbone){"use strict";Backbone.Webshop.basket.mixin.addToBasket=function(fopData,quantity){fopData=updateFopDataWithQuantity(fopData,quantity||1);var url=buildStandardUrl.call(this,fopData);return invokeSave.call(this,'add',fopData,url);};Backbone.Webshop.basket.mixin.addToBasketWithUrl=function(fopData,urls,quantity){fopData=updateFopDataWithQuantity(fopData,quantity||1);var url=buildCustomUrl.call(this,fopData,urls);return invokeSave.call(this,'add',fopData,url);};Backbone.Webshop.basket.mixin.removeFromBasket=function(fopData,quantity){fopData=updateFopDataWithQuantity(fopData,-(quantity||1));var url=buildStandardUrl.call(this,fopData);return invokeSave.call(this,'remove',fopData,url);};Backbone.Webshop.basket.mixin.removeFromBasketWithUrl=function(fopData,urls,quantity){fopData=updateFopDataWithQuantity(fopData,-(quantity||1));var url=buildCustomUrl.call(this,fopData,urls);return invokeSave.call(this,'remove',fopData,url);};function invokeSave(action,fopData,url){return this._save({action:action,ajaxParams:buildAjaxParams.call(this,fopData,url),data:fopData});}
function buildStandardUrl(fopData){var updateBasketUrlPart=this.findItem(fopData.sku)?this.get('updateBasketUrl'):this.get('addToBasketUrl');return'/webshop'+updateBasketUrlPart;}
function buildCustomUrl(fopData,urls){var updateBasketUrlPart=this.findItem(fopData.sku)?urls.updateBasketUrl:urls.addToBasketUrl;return'/webshop'+updateBasketUrlPart;}
function buildAjaxParams(fopData,url){return{url:url,data:buildData(fopData)};}
function buildData(skuData){var params=_.pick(skuData,'pageComponentIdForBQU','analyticsPageType','pageViewId','quantityUpdateSearchTerm','quantityUpdateSearchInputMechanism','quantityUpdateTotalNumberOfPages','quantityUpdateAddedFromSection','sku','parentContainer','quantity','isCowGift');return _.assign(params,{ajax:true});}
function updateFopDataWithQuantity(fopData,quantity){return _.defaults(fopData,{quantity:quantity});}})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.basket.mixin.getItemQuantity=function(sku){var item=this.findItemOrChild(sku);if(!item.get()){return 0;}
if(item.type()=='self'){return item.get().get('itemQuantity');}
return+item.get().get('scTotalDerivativesInBasket');};})(Backbone);(function(Backbone,_){"use strict";Backbone.Webshop.basket.mixin.getCategorizedItems=function(){return _.chain(this.toJSON()).groupBy('section').transform(transformIteratee).values().value();};function transformIteratee(result,items,category){result[category]={name:getSectionExternalizedName(category),className:category.replace(/\s+/g,'-').toLowerCase(),items:new Backbone.Webshop.trolley.TrolleyItemCollection(items)};}
function getSectionExternalizedName(category){var cat=category.toUpperCase();switch(cat){case'SUBSCRIPTIONS':return getMessage('subscriptions.trolley.sectionLabel');default:return category;}}})(Backbone,_);(function(Backbone){"use strict";var undefined;Backbone.Webshop.basket.mixin.findItemOrChild=function(sku){var result=findItemWithSku.call(this,sku)||findChildItemWithSku.call(this,sku)||{};return{get:function(){return result.item;},type:function(){return result.type;}};};function findItemWithSku(sku){var item=this.findWhere({sku:sku});return item?{item:item,type:'self'}:undefined;}
function findChildItemWithSku(sku){var item=this.findWhere({scSellingGrp:sku});return item?{item:item,type:'child'}:undefined;}})(Backbone);(function(Backbone){"use strict";var ajaxQueue=Backbone.$.when();Backbone.Webshop.basket.mixin.save=function(attrs){var basket=this;return ajaxQueue=ajaxQueue.then(function(){var deferred=new Backbone.$.Deferred();attrs=_.merge({action:'ajax',ajaxParams:{emulateJSON:true,data:{responsiveBasket:true,pageViewId:webshop.common.jsVariables.get('pageViewId'),_csrf:jQ("meta[name='_csrf']").attr("content")}},data:{}},attrs);if(isRemovingForbidden(attrs,basket)){deferred.resolve();}else{basket.trigger(attrs.action+':started',attrs.data);basket.save({},attrs.ajaxParams).always(resolveDeferred.bind({deferred:deferred})).always(triggerActionFinished.bind({basket:basket,attrs:attrs}));}
return deferred.promise();});};function isRemovingForbidden(attrs,basket){return attrs.ajaxParams.data.quantity<0&&basket.getItemQuantity(attrs.data.sku)===0;}
function resolveDeferred(data){if(data.redirectionWarning){this.deferred.reject();var redirectUrl=data.redirectionWarning;window.location.href=(redirectUrl.match(/^https?:\/\//i))?redirectUrl:'/webshop'+redirectUrl;}else{this.deferred.resolve.apply(this.deferred,arguments);}}
function triggerActionFinished(){this.basket.trigger(this.attrs.action+':finished',this.attrs,this.basket);}})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.basket.mixin.addFromTrolley=function(itemData,status,quantity){itemData=updateFopDataWithQuantity(itemData,quantity||1);var ajaxParams=buildAjaxParams(itemData,status);return this._save({action:'add',ajaxParams:ajaxParams,data:itemData});};Backbone.Webshop.basket.mixin.removeFromTrolley=function(itemData,quantity){return removeFromTrolley.call(this,itemData,-(quantity||1));};Backbone.Webshop.basket.mixin.removeAtAllFromTrolley=function(itemData){return removeFromTrolley.call(this,itemData,-itemData.itemQuantity);};function removeFromTrolley(itemData,removeQuantity){itemData=updateFopDataWithQuantity(itemData,removeQuantity);var ajaxParams=buildAjaxParams(itemData,'REMOVED');return this._save({action:'remove',ajaxParams:ajaxParams,data:itemData});}
function buildAjaxParams(itemData,status){return{url:buildUrl(itemData,status),data:itemData};}
function buildUrl(itemData,status){switch(status){case'ADDED':return itemData.urlAdd;case'EMPTY_BUT_ADDED':return itemData.urlAddSmartBasket;case'REMOVED':return itemData.urlRemove;}}
function updateFopDataWithQuantity(fopData,quantity){return _.defaults(fopData,{quantity:quantity});}})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.basket.mixin.BasketItemModel=Backbone.Model.extend({idAttribute:'sku',defaults:{sku:null,brand:null,}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.basket.BasketItemsCollection=Backbone.Collection.extend({model:Backbone.Webshop.basket.mixin.BasketItemModel,getCategorizedItems:Backbone.Webshop.basket.mixin.getCategorizedItems,findItemOrChild:Backbone.Webshop.basket.mixin.findItemOrChild,getItemQuantity:Backbone.Webshop.basket.mixin.getItemQuantity,getProductWarning:Backbone.Webshop.basket.mixin.getProductWarning});})(Backbone);(function(Backbone,webshop,_){"use strict";var undefined,basketInstance,_super=Backbone.Model.prototype;var Basket=Backbone.Model.extend({defaults:{totalInteger:'&pound;0',totalFraction:'00',multiBuySaving:0,minimumOrderValue:0,totalSkus:0,mobileCheckoutAllowed:false,temporaryBasket:false,errorMessages:{}},bindEntityEvents:Backbone.Marionette.proxyBindEntityEvents,url:'/webshop/trolley',basketEvents:{'change:errorMessages':translateErrorMessageEvent,'sync':translateSyncEvent},basketItemsEvents:{change:translateChangeEvent,add:translateAddEvent,remove:translateRemoveEvent},initialize:function(attr){this.set({items:new Backbone.Webshop.basket.BasketItemsCollection(attr.items)},{silent:true});this.bindEntityEvents(this.get('items'),this.basketItemsEvents);this.bindEntityEvents(this,this.basketEvents);},parse:function(response){this.get('items').set(response.items);return _.omit(response,'items');},addToBasket:Backbone.Webshop.basket.mixin.addToBasket,removeFromBasket:Backbone.Webshop.basket.mixin.removeFromBasket,addToBasketWithUrl:Backbone.Webshop.basket.mixin.addToBasketWithUrl,removeFromBasketWithUrl:Backbone.Webshop.basket.mixin.removeFromBasketWithUrl,addFromTrolley:Backbone.Webshop.basket.mixin.addFromTrolley,removeFromTrolley:Backbone.Webshop.basket.mixin.removeFromTrolley,removeAtAllFromTrolley:Backbone.Webshop.basket.mixin.removeAtAllFromTrolley,addSuggestedItems:function(options){return this._save({action:'suggested:items:add:all',ajaxParams:options});},addWithDirectUrl:function(url,ajaxParams,attrs){return this._save(_.merge({action:'add:withDirect:url',ajaxParams:{url:url,data:ajaxParams||{}}},attrs));},removeAll:function(){var getParams={temporaryBasket:this.get('temporaryBasket')};return this._save({action:'remove:all',data:{items:this.get('items').models,pageType:webshop.common.jsVariables.get('pageType'),sectionTitle:'Trolley sidebar',listName:'Trolley sidebar'},ajaxParams:{url:'/webshop/emptyResponsiveBasket.do?'+Backbone.$.param(getParams)}});},swap:function(baseFopData,switchFopData){var _that=this,baseQuantity=this.getItemQuantity(baseFopData.sku);return this.addToBasket(switchFopData,baseQuantity).then(function(){var deferred;if(!_that.getProductWarning(switchFopData.sku)){return _that.removeFromBasket(baseFopData,baseQuantity);}else{deferred=new Backbone.$.Deferred();return deferred.reject().promise();}}).then(function(){_that.trigger('swap:'+baseFopData.sku);});},swapWithUrl:function(baseSku,switchFopData,url){return this._save({ajaxParams:{url:url,data:{basketItem:baseSku,switchItem:switchFopData.sku}}}).done(function(){var message=this.get('message');if(!message||message.type!='error'){this.trigger('swap:'+baseSku,switchFopData);}}.bind(this));},_save:Backbone.Webshop.basket.mixin.save,findItem:function(sku){return this.get('items').findWhere({sku:sku});},getItemQuantity:function(sku){return this.get('items').getItemQuantity(sku);},getProductWarning:function(sku){return this.get('errorMessages')[sku];},getCategorizedItems:function(){return this.get('items').getCategorizedItems();},getCouponRedeemer:function(couponId){return this.get('items').find(function(item){var couponData=item.get('personalisedCoupon');if(couponData){return couponData.id===couponId;}
return false;});},getCouponsCount:function(){return this.get('items').reduce(function(memo,item){return!!item.get('personalisedCoupon')?memo+1:memo;},0);},getGiftSku:function(){return this.get('giftSku');},isLoggedIn:function(){return this.get('login');},fetch:function(options){return _super.fetch.call(this,_.defaults({data:{temporaryBasket:this.get('temporaryBasket')}},options));}});function translateAddEvent(basketItem){translateEvent.call(this,basketItem);var couponData=basketItem.get('personalisedCoupon');if(couponData){Backbone.Webshop.analytics.WebshopAnalytics.reportPageEventOfType('COUPON_APPLIED',{PER_COUPON_ID:couponData.id})
this.trigger('add:coupon',basketItem);}}
function translateChangeEvent(basketItem){translateEvent.call(this,basketItem);var changes=basketItem.changed,couponData=changes&&changes.personalisedCoupon;if(couponData){Backbone.Webshop.analytics.WebshopAnalytics.reportPageEventOfType('COUPON_APPLIED',{PER_COUPON_ID:couponData.id})
this.trigger('add:coupon',basketItem);}}
function translateRemoveEvent(basketItem){translateEvent.call(this,basketItem);var couponData=basketItem.get('personalisedCoupon');if(couponData){Backbone.Webshop.analytics.WebshopAnalytics.reportPageEventOfType('COUPON_CANCELLED',{PER_COUPON_ID:couponData.id})}}
function translateEvent(basketItem){var couponData=basketItem.get('personalisedCoupon');this.trigger('change:item');this.trigger('change:item:'+basketItem.get('sku'));if(basketItem.get('scSellingGrp')){this.trigger('change:item:'+basketItem.get('scSellingGrp'));}
if(couponData){this.trigger('change:coupon:'+couponData.id);this.trigger('change:coupon',couponData);}}
function translateErrorMessageEvent(basket){var skuToTrigger=_.defaults({},basket.changed.errorMessages,this.previousAttributes().errorMessages);var that=this;Backbone.$.each(skuToTrigger,function(sku){that.trigger('change:item:'+sku);});this.trigger('change:item');}
function translateSyncEvent(basket){var message=basket.get('message');if(message){this.trigger('message',message);}}
Backbone.Webshop.Basket={getInstance:function(){if(basketInstance===undefined){basketInstance=new Basket(webshop.basketSummaryData);}
return basketInstance;}};})(Backbone,webshop,_);(function(Backbone){"use strict";Backbone.Webshop.mixins.getBulkAddsSourceName=function(source){var sourceName;switch(source){case'LIST':sourceName='Shopping list';break;case'PROMO':sourceName='Bundle items';break;case'ORDER':sourceName='Previous order';break;case'RECIPE':sourceName='Recipes';break;case'SUGGESTEDORDER':sourceName='Instant shop';break;}
return sourceName;}})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.mixins.parseFormattedPrice=function(priceObject){function extractPriceFromPoundSymbol(priceWithCurrencySymbol){var priceWithPoundMatch=priceWithCurrencySymbol.match(/&pound;(.*)/);return priceWithPoundMatch!=null&&priceWithPoundMatch.length>1?priceWithPoundMatch[1]:null;}
function extractPriceFromPenceSymbol(priceWithCurrencySymbol){var priceWithPenceMatch=priceWithCurrencySymbol.match(/([0-9]+)p$/);if(priceWithPenceMatch!=null&&priceWithPenceMatch.length>1){if(priceWithPenceMatch[1].length==1){return'0.0'+priceWithPenceMatch[1];}else{return'0.'+priceWithPenceMatch[1];}}else{return null;}}
var priceWithCurrencySymbol=priceObject.currentPrice;if(!priceWithCurrencySymbol){return undefined;}
var priceWithoutPoundSymbol=extractPriceFromPoundSymbol(priceWithCurrencySymbol);if(priceWithoutPoundSymbol!=null){return stringToNumber(priceWithoutPoundSymbol);}else{var priceWithoutPenceSymbol=extractPriceFromPenceSymbol(priceWithCurrencySymbol);if(priceWithoutPenceSymbol!=null){return stringToNumber(priceWithoutPenceSymbol);}else{return stringToNumber(priceWithCurrencySymbol);}}};function stringToNumber(str){if(str==null||str.length==0||isNaN(str)){return null;}else{return Number(str);}}})(Backbone);(function(Backbone,ocBackbone,webshop,_){'use strict';var basketFillingEventSenderInstance;var BasketFillingEventSender=Backbone.Marionette.Object.extend({_thresholds:[10.00,40.00],_lastReportBasketValue:0,initialize:function(){webshop.gtm.registerEventSource(this);},resetBasketValue:function(basketValue){this._lastReportBasketValue=basketValue;},reportBasketUpdate:function(newBasketValue){_.each(this._thresholds,function(threshold){if(this._lastReportBasketValue<threshold&&newBasketValue>=threshold){this._sendBasketFillingEvent(threshold,newBasketValue);}},this);this._lastReportBasketValue=newBasketValue;},_sendBasketFillingEvent:function(threshold,basketValue){this.trigger('gtm:uaEvent',{category:'Basket Filling',action:'Threshold Reached',label:threshold,value:basketValue});}});ocBackbone.gtm=ocBackbone.gtm||{};ocBackbone.gtm.BasketFillingEventSender={getInstance:function(){if(_.isUndefined(basketFillingEventSenderInstance)){basketFillingEventSenderInstance=new BasketFillingEventSender();}
return basketFillingEventSenderInstance;}};})(Backbone,ocBackbone,webshop,_);(function(Backbone,gtm,_,webshop){'use strict';Backbone.Webshop.basket.GoogleTagMangerSvc=Backbone.Marionette.Object.extend({initialize:function(){var basket=Backbone.Webshop.Basket.getInstance();gtm.registerEventSource(this);this.bindEntityEvents(basket,this.basketEvents);ocBackbone.gtm.BasketFillingEventSender.getInstance().resetBasketValue(Backbone.Webshop.mixins.parseFormattedPrice({currentPrice:basket.get('total')}));},basketEvents:{'add:started':'sendProductAddedEvent','remove:started':'sendProductRemovedEvent','remove:all:started':'sendAllProductsRemovedEvent','suggested:items:add:all:finished':'sendBulkItemsAddedEvent','add:withDirect:url:finished':'sendBulkItemsAddedEvent','change':'sendBasketChangedEvents'},sendProductAddedEvent:function(fopData){sendBasketInteractionEvent('add').call(this,fopData);sendAddToBasketEvent.call(this,fopData);},sendProductRemovedEvent:function(fopData){sendBasketInteractionEvent('remove').call(this,fopData);},sendBulkItemsAddedEvent:function(attrs,basket){if(Backbone.Webshop.mixins.isBetaFeatureEnabled('GOOGLE_ANALYTICS_BATCH_ACTIONS')&&basket.get('bulkAddsSource')){var sourceName=Backbone.Webshop.mixins.getBulkAddsSourceName(basket.get('bulkAddsSource'));sendBatchBasketInteractionEvent('add').call(this,{items:_.map(basket.get('bulkAddsSkusWithQuantity'),function(quantity,sku){var item=basket.get('items').findWhere({sku:sku}).clone();item.set('itemQuantity',quantity);return item;}),sectionTitle:sourceName,pageType:webshop.common.jsVariables.get('pageType')||attrs['pageType'],listName:sourceName,});}
basket.unset('bulkAddsSource',{silent:true});basket.unset('bulkAddsSkusWithQuantity',{silent:true});},sendAllProductsRemovedEvent:function(eventData){sendBatchBasketInteractionEvent('remove').call(this,eventData);},sendBasketChangedEvents:function(basket){var basketValue=Backbone.Webshop.mixins.parseFormattedPrice({currentPrice:basket.get('total')});var emptyBasket=basket.get('totalItems')==0;this.trigger('gtm:basketChangedEvent',basketValue,emptyBasket);ocBackbone.gtm.BasketFillingEventSender.getInstance().reportBasketUpdate(basketValue);}});function sendAddToBasketEvent(fopData){this.trigger('gtm:basketAddEvent',fopData.sku);}
function sendBasketInteractionEvent(action){return function(fopData){var basketEventData=buildBasketEventData(fopData);this.trigger('gtm:trolleyEvent',action,[basketEventData.fop],basketEventData.sectionTitle,basketEventData.pageType,basketEventData.listName);}}
function sendBatchBasketInteractionEvent(action){return function(eventData){var productsData=_.map(eventData.items,function(item){return buildBasketEventProductData(_.extend(item.attributes,{price:Backbone.Webshop.mixins.parseFormattedPrice({currentPrice:item.get('itemCataloguePrice')}),quantity:item.get('itemQuantity')}));});this.trigger('gtm:trolleyEvent',action,productsData,eventData.sectionTitle,eventData.pageType,eventData.listName);}}
function buildBasketEventData(fopData){var fopAnalyticsAttributes=Backbone.Webshop.mixins.getAnalyticsAttributesForProduct(fopData);return _.extend({fop:buildBasketEventProductData(fopData)},{pageType:fopAnalyticsAttributes.pageType||fopData.pageType,listName:fopData.listName||fopAnalyticsAttributes.listName,sectionTitle:fopData.sectionTitle||fopAnalyticsAttributes.sectionTitle});}
function buildBasketEventProductData(fopData){return{id:fopData.sku,quantity:Math.abs(fopData.quantity),name:fopData.encodedName,brand:fopData.brand,price:fopData.price,category:fopData.category};}
new Backbone.Webshop.basket.GoogleTagMangerSvc();})(Backbone,webshop.gtm,_,webshop);var scrolltotop={setting:{startline:100,scrollto:0,scrollduration:1000,fadeduration:[500,100]},controlHTML:'<img src="/webshop/static/rwd/images/core/header/chevro-BackToTop.svg"/>',controlattrs:{offsetx:10,offsety:10},anchorkeyword:'#top',state:{isvisible:false,shouldvisible:false},scrollup:function(){if(!this.cssfixedsupport)
this.$control.css({opacity:0})
var dest=isNaN(this.setting.scrollto)?this.setting.scrollto:parseInt(this.setting.scrollto)
if(typeof dest=="string"&&jQuery('#'+dest).length==1)
dest=jQuery('#'+dest).offset().top
else
dest=0
this.$body.animate({scrollTop:dest},this.setting.scrollduration);},togglecontrol:function(){var scrolltop=jQuery(window).scrollTop()
this.state.shouldvisible=(scrolltop>=this.setting.startline)?true:false
if(this.state.shouldvisible&&!this.state.isvisible){this.$control.stop().animate({opacity:1},this.setting.fadeduration[0])
this.state.isvisible=true}
else if(this.state.shouldvisible==false&&this.state.isvisible){this.$control.stop().animate({opacity:0},this.setting.fadeduration[1])
this.state.isvisible=false}},init:function(){jQuery(document).ready(function($){var isWindowsPhone=navigator.userAgent.match(/Windows Phone/i)==null?false:true;var mainobj=scrolltotop
var iebrws=document.all
mainobj.cssfixedsupport=!iebrws||iebrws&&document.compatMode=="CSS1Compat"&&window.XMLHttpRequest
mainobj.$body=(window.opera)?(document.compatMode=="CSS1Compat"?$('html'):$('body')):$('html,body')
mainobj.$control=$('<div id="topcontrol">'+mainobj.controlHTML+'Top</div>').attr({title:'Scroll Back to Top'}).on('click',function(){mainobj.scrollup();return false});if(isWindowsPhone){mainobj.$control.css({position:mainobj.cssfixedsupport?'fixed':'absolute',top:''+($(window).height()-40)+'px',right:mainobj.controlattrs.offsetx,opacity:0,cursor:'pointer'}).appendTo('.search-layout');}else{mainobj.$control.css({position:mainobj.cssfixedsupport?'fixed':'absolute',bottom:mainobj.controlattrs.offsety,right:mainobj.controlattrs.offsetx,opacity:0,cursor:'pointer'}).appendTo('body');}
if(document.all&&!window.XMLHttpRequest&&mainobj.$control.text()!='')
mainobj.$control.css({width:mainobj.$control.width()})
mainobj.togglecontrol()
$('a[href="'+mainobj.anchorkeyword+'"]').on('click',function(){mainobj.scrollup()
return false})
$(window).on('scroll resize',function(e){mainobj.togglecontrol()});if(isWindowsPhone){$(window).on('resize',function(e){var scrollTopButton=$('#topcontrol');scrollTopButton.css('top',$(window).height()-scrollTopButton.height()-15);});}})}}
scrolltotop.init();(function(Backbone,ocBackbone,_){'use strict';Backbone.Webshop.order.EditOrderConfirmationPopup=Backbone.Webshop.popup.MobilePopupView.extend({events:{"click .closeButton, .cancel, .overlay":"unblockPopup"},initialize:function(options){this.editOrderPopupTemplate=Handlebars.templates['order/editOrderPopup'];this.editOrderPopupContent=this.editOrderPopupTemplate({orderNumber:options.orderNumber||0,_csrf:jQ("meta[name='_csrf']").attr("content")});this.model=new ocBackbone.popup.PopupModel({classNames:["fixed-modal"],content:this.editOrderPopupContent});this.listenTo(this.model,'change',this.render);},unblockPopup:function(){Backbone.$(".edit-order").removeClass("unclickable");this.closePopup();},});})(Backbone,ocBackbone,_);(function(Backbone){'use strict';Backbone.Webshop.order.CancelOrderChangesConfirmationPopupBehavior=Backbone.Marionette.Behavior.extend({ui:{'cancelOrderChangesButton':'.js-cancelOrderChanges'},events:{'click @ui.cancelOrderChangesButton':'openCancelOrderChangesConfirmationPopup'},openCancelOrderChangesConfirmationPopup:function(e){e.preventDefault();var cancelOrderChangesConfirmationPopupModel=new Backbone.Webshop.popup.AjaxConfirmationPopupModelRedir({url:'/webshop/cancelChangesConfirm.do'});new Backbone.Webshop.order.CancelOrderChangesConfirmationPopupView({model:cancelOrderChangesConfirmationPopupModel});cancelOrderChangesConfirmationPopupModel.fetchAndDisplay();}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.order.CancelOrderChangesConfirmationPopupView=Backbone.Webshop.popup.ConfirmationPopupView.extend({confirm:function(){window.location.href="/webshop/cancelChanges.do";}});})(Backbone);(function(Backbone,ocBackbone){'use strict';Backbone.Webshop.order.CancelOrderConfirmationPopupBehavior=Backbone.Marionette.Behavior.extend({ui:{'cancelOrderButton':'.js-cancelOrder'},events:{'click @ui.cancelOrderButton':'openCancelOrderConfirmationPopup'},openCancelOrderConfirmationPopup:function(event){event.preventDefault();var cancelOrderConfirmationPopupModel=new ocBackbone.popup.AjaxPopupModelRedir();cancelOrderConfirmationPopupModel.set('url',this.$(event.currentTarget).data("url"));new Backbone.Webshop.order.CancelOrderConfirmationPopupView({model:cancelOrderConfirmationPopupModel});cancelOrderConfirmationPopupModel.fetchAndDisplay();}});})(Backbone,ocBackbone);(function(Backbone){'use strict';Backbone.Webshop.order.CancelOrderConfirmationPopupView=Backbone.Webshop.popup.MobilePopupView.extend({events:{'click .confirmLink':'confirm','click #js-cancelLink':'closePopup'}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.order.ChangeDeliveryConfirmationPopupBehavior=Backbone.Marionette.Behavior.extend({ui:{'changeDeliveryButton':'#js-changeDelivery'},events:{'click @ui.changeDeliveryButton':'openChangeDeliveryConfirmationPopup'},openChangeDeliveryConfirmationPopup:function(event){event.preventDefault();var orderNumber=Backbone.$(this.ui.changeDeliveryButton).data('orderNumber');new Backbone.Webshop.order.ChangeDeliveryConfirmationPopupView({orderNumber:orderNumber});}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.order.ChangeDeliveryConfirmationPopupView=Backbone.Webshop.popup.MobilePopupView.extend({events:{'click .js-cancel':'closePopup'},initialize:function(options){var orderNumber=options.orderNumber||0;this.model=new ocBackbone.popup.PopupModel({content:Handlebars.templates['order/changeDeliveryPopup']({orderNumber:orderNumber})});this.render();}});})(Backbone);(function(Backbone,ocBackbone){'use strict';Backbone.Webshop.order.RequestRefundPopupBehavior=Backbone.Marionette.Behavior.extend({ui:{'requestRefundButton':'.js-request-refund'},events:{'click @ui.requestRefundButton':'handleClickingRequestRefund'},handleClickingRequestRefund:function(event){if(Backbone.Webshop.ViewType.isDesktop()){return true;}
event.preventDefault();var requestRefundConfirmationPopupModel=new ocBackbone.popup.AjaxPopupModelRedir({url:'/webshop/orders/'+this.$(event.currentTarget).data('orderNumber')+'/refundPopup'});new Backbone.Webshop.popup.MobilePopupView({model:requestRefundConfirmationPopupModel});requestRefundConfirmationPopupModel.fetchAndDisplay();}});})(Backbone,ocBackbone);(function(Backbone){'use strict';Backbone.Webshop.navigation.NavigationStack=Backbone.Marionette.Object.extend({stack:[],dummyModel:new Backbone.Model(),initialize:function(){this.resetNavigationState();},pushModel:function(model){this.stack.push(model)},resetNavigationState:function(){this.stack=[];this.stack.push(this.getOption('model'));this.stack.push(this.dummyModel);},headerModel:function(){return this.stack[this.stack.length-2];},collectionModel:function(){var collectionStackItem=this.stack[this.stack.length-1];if(collectionStackItem==this.dummyModel){collectionStackItem=this.getOption('model');}
return collectionStackItem;},hasParentState:function(){return this.stack.length>2;},popModel:function(){this.stack.pop();},prepareStackFromTags:function(tags){var section,stack;var productsSections=this.getOption('model').getProductSections();var normalizedTags=tags.replace("%7C20000","");for(var i=0;i<productsSections.length&&_.isUndefined(stack);i++){stack=findNodeByUrlPart(productsSections[i],normalizedTags,[]);if(_.isArray(stack)){section=productsSections[i].sectionId;}}
if(_.isArray(stack)&&stack.length>0){this.resetNavigationState();stack.shift();$.each(stack,function(i,element){this.stack.push(new Backbone.Model({name:element.name,url:element.url,children:element.children}));}.bind(this));return section;}}});function findNodeByUrlPart(root,urlPart,stack){if(!_.isUndefined(root.url)&&root.url.indexOf(urlPart)>0){if(_.isArray(root.children)){return stack.concat(root);}else{return stack;}}else{if(_.isArray(root.children)){for(var i=0;i<root.children.length;i++){var search=findNodeByUrlPart(root.children[i],urlPart,stack.concat(root));if(!_.isUndefined(search)){return search;}}}}
return undefined;}})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.navigation.NavigationCollection=Backbone.Collection.extend({});})(Backbone);(function(Backbone,_){'use strict';Backbone.Webshop.navigation.NavItem=Backbone.Model.extend({defaults:{children:[]},initialize:function(){var subItems=this.get('children');if(_.isArray(subItems)){this.set({children:new Backbone.Webshop.navigation.NavItemCollection(subItems)});}}});})(Backbone,_);(function(Backbone){'use strict';Backbone.Webshop.navigation.NavItemCollection=Backbone.Collection.extend({model:Backbone.Webshop.navigation.NavItem});})(Backbone);(function(Backbone,_){'use strict';Backbone.Webshop.navigation.Section=Backbone.Model.extend({defaults:{children:[]},initialize:function(){var children=this.get('children');if(_.isArray(children)){this.set({children:new Backbone.Webshop.navigation.NavItemCollection(children)});}}});})(Backbone,_);(function(Backbone){'use strict';Backbone.Webshop.navigation.SectionCollection=Backbone.Collection.extend({model:Backbone.Webshop.navigation.Section});})(Backbone);(function(Backbone,webshop){'use strict';Backbone.Webshop.navigation.NavigationModel=Backbone.Webshop.LocalStorageModel.extend({id:'navigationModel',cookieAvailable:false,url:'/webshop/navigation/',productSectionsIds:['SectionCategory','SectionInspiration'],defaults:{versionId:'',login:false},getProductSections:function(){return _.filter(this.get('sections'),function(section){return _.contains(this.productSectionsIds,section.sectionId)}.bind(this));},shouldFetchData:function(){return webshop.navigationMobileData.versionId!==this.get('versionId');}});})(Backbone,webshop);(function(Backbone,Handlebars){'use strict';Backbone.Webshop.navigation.NavigationItemView=Backbone.Marionette.ItemView.extend({tagName:'li',className:'section-item',template:Handlebars.templates['navigation/partials/item'],triggers:function(){if(this.model.has('children')&&this.model.get('children').length){return{click:'item:click'};}
return{};}});})(Backbone,Handlebars);(function(Backbone,Handlebars){'use strict';Backbone.Webshop.navigation.NavigationSectionsView=Backbone.Marionette.CompositeView.extend({tagName:'li',className:'section',template:Handlebars.templates['navigation/partials/section'],childView:Backbone.Webshop.navigation.NavigationItemView,childViewContainer:'@ui.sectionItems',childViewEventPrefix:'section',ui:{sectionItems:'.section-items'},initialize:function(){this.collection=new Backbone.Collection(this.model.get('children'));}});})(Backbone,Handlebars);(function(Backbone){'use strict';Backbone.Webshop.navigation.NavigationContentView=Backbone.Marionette.CollectionView.extend({initialize:function(){this.collection=new Backbone.Webshop.navigation.NavigationCollection();},events:{"click a[href^='/webshop/navigation/']":'openNavigationPage'},tagName:'ul',childViewEventPrefix:'navigation',openNavigationPage:function(event){event.preventDefault();this.trigger("go:to:navigation:page",event.target.pathname);},getChildView:function(model){if(model.has('sectionId')){return Backbone.Webshop.navigation.NavigationSectionsView;}else{return Backbone.Webshop.navigation.NavigationItemView;}}});})(Backbone);(function(Backbone,Handlebars,_){'use strict';Backbone.Webshop.navigation.NavigationHeaderView=Backbone.Marionette.ItemView.extend({template:Handlebars.templates['navigation/partials/header'],modelEvents:{change:'render'},ui:{btnLogin:'.btn-login',btnSignup:'.btn-signup',btnBack:'.menu-back'},triggers:{'click @ui.btnBack':'navigation:back','touchstart @ui.btnBack':'navigation:back'},events:{'click @ui.btnLogin':navigateToLogin,'touchstart @ui.btnLogin':navigateToLogin,'click @ui.btnSignup':navigateToSignup,'touchstart @ui.btnSignup':navigateToSignup}});function navigateToLogin(event){if(Backbone.Webshop.mixins.isBetaFeatureEnabled("RESPONSIVE_LOG_REG_POPUPS")&&!webshop.popup.utils.isIphoneNavigator()){return;}
event.preventDefault();location.href='/webshop/login.go?from=header';}
function navigateToSignup(event){if(Backbone.Webshop.mixins.isBetaFeatureEnabled("RESPONSIVE_LOG_REG_POPUPS")&&!webshop.popup.utils.isIphoneNavigator()){return;}
event.preventDefault();location.href='/webshop/quickReg.do?from=header';}})(Backbone,Handlebars,_);(function(Backbone,Handlebars,_){'use strict';Backbone.Webshop.navigation.CatalogueNavigationHeaderView=Backbone.Marionette.ItemView.extend({template:Handlebars.templates['navigation/partials/catalogueHeader'],modelEvents:{change:'render'},ui:{btnBack:'.menu-back'},triggers:{'click @ui.btnBack':'navigation:back','touchstart @ui.btnBack':'navigation:back'}});})(Backbone,Handlebars,_);(function(Backbone,Handlebars){'use strict';Backbone.Webshop.navigation.NavigationView=Backbone.Marionette.LayoutView.extend({template:Handlebars.templates['navigation/navigation'],navigationContentViewEvents:{'navigation:section:item:click':'renderWholeSection','navigation:item:click':'renderChildSection','go:to:navigation:page':'openNavigationPage'},regions:{header:'.navigation-header',content:'.navigation-content',bottom:'.navigation-bottom'},navigationHeaderViewEvents:{'navigation:back':'renderParentSection'},initialize:function(){this.navigationStack=new Backbone.Webshop.navigation.NavigationStack({model:this.model});this.navigationContentView=new Backbone.Webshop.navigation.NavigationContentView();},onRender:function(){this.header.show(this.navigationHeaderView);this.content.show(this.navigationContentView);this.bottom.show(this.navigationBottomView);this.bindEntityEvents(this.navigationHeaderView,this.navigationHeaderViewEvents);this.bindEntityEvents(this.navigationContentView,this.navigationContentViewEvents);},renderWholeSection:function(sectionView,itemView,attrs){this.navigationStack.pushModel(attrs.model);this.renderRegionsFromStack(true);this.trigger('whole:section:rendered',{'collectionModel':attrs.model});},renderChildSection:function(itemView,attrs){this.navigationStack.pushModel(attrs.model);this.renderRegionsFromStack();this.trigger('child:section:rendered',{'collectionModel':attrs.model});},renderRegionsFromStack:function(){var headerModel=this.navigationStack.headerModel();var collectionModel=this.navigationStack.collectionModel();this.renderRegions(headerModel,collectionModel.has('children')?collectionModel.get('children'):this.getSections(collectionModel.get('sections')));this.triggerMethod('regions:rendered');},renderRegions:function(model,collection){if(this._firstRender){this.render();}
this.navigationContentView.collection.reset(collection);this.navigationContentView.el.scrollIntoView(true);this.navigationHeaderView.model=model;this.navigationHeaderView.render();this.navigationHeaderView.el.scrollIntoView(true);},getSections:function(source){return _.filter(source,function(section){return _.contains(this.getOption('visibleSections'),section.sectionId);}.bind(this));}});})(Backbone,Handlebars);(function(Backbone){'use strict';Backbone.Webshop.navigation.UserNavigationView=Backbone.Webshop.navigation.NavigationView.extend({el:'.navigation-menu',visibleSections:['SectionHome','SectionStartShopping','SectionAccount','SectionFromScribe','Corporate'],behaviors:{ModalDrawerBehavior:{}},initialize:function(options){Backbone.Webshop.navigation.NavigationView.prototype.initialize.call(this,options);this.navigationHeaderView=new Backbone.Webshop.navigation.NavigationHeaderView();this.navigationBottomView=new Backbone.Webshop.navigation.NavigationBottomView();},onBeforeOpen:function(){this.renderRegionsFromStack();},renderParentSection:function(){if(this.navigationStack.hasParentState()){this.navigationStack.popModel();this.renderRegionsFromStack();}else{this.close();}},onRegionsRendered:function(){if(this.navigationStack.hasParentState()){this.navigationBottomView.hide();}else{this.navigationBottomView.show();}},openNavigationPage:function(path){location.href=path;}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.navigation.NavigationBottomView=Backbone.View.extend({el:'.js-navigation-footer',show:function(){this.$el.toggleClass('hidden',false);},hide:function(){this.$el.toggleClass('hidden',true);}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.navigation.CatalogueNavigationView=Backbone.Webshop.navigation.NavigationView.extend({el:'.navigation-page',visibleSections:[],initialize:function(options){Backbone.Webshop.navigation.NavigationView.prototype.initialize.call(this,options);this.navigationHeaderView=new Backbone.Webshop.navigation.CatalogueNavigationHeaderView();this.navigationBottomView=new Backbone.View();},onRender:function(){Backbone.$('body').addClass('navigation-background');Backbone.$('.ulp').remove();Backbone.Webshop.navigation.NavigationView.prototype.onRender.call(this);},openNavigationWithTags:function(tags){var section=this.navigationStack.prepareStackFromTags(tags);if(section){this.visibleSections=[section];this.renderRegionsFromStack();}},openCategorySection:function(){this.visibleSections=['SectionCategory'];openVisibleSection.call(this);},openInspirationSection:function(){this.visibleSections=['SectionInspiration'];openVisibleSection.call(this);},openStartShoppingSection:function(){this.visibleSections=['SectionStartShoppingFromHome'];openVisibleSection.call(this);},openNavigationPage:function(path){Backbone.history.navigate(path,{trigger:true});},renderParentSection:function(){this.trigger("navigation:back");},onRegionsRendered:function(){window.scrollTo(0,0);}});function openVisibleSection(){this.navigationStack.resetNavigationState();this.renderRegionsFromStack();}})(Backbone);(function(Backbone){Backbone.Webshop.navigation.BackToCatalogueView=Backbone.Marionette.ItemView.extend({template:false,events:{'click':'handleClick'},handleClick:function(){Backbone.Webshop.analytics.WebshopAnalytics.reportPageEvent("Mobile CrumbTrail arrow clicked");this.trigger('navigation:back');}});})(Backbone);var webshop=webshop||{};webshop.rwd=webshop.rwd||{};webshop.rwd.EditOrder=(function(){var $target=null;function confirmationPopup(evt){$target=jQ(evt.currentTarget);if($target.hasClass("unclickable")){evt.preventDefault();}else{$target.addClass("unclickable");var href=$target.attr("href"),orderNumber=href.match(/orderNo=(.*)/i)[1];shouldShowEditDialogue(orderNumber);}
return false;}
function shouldShowEditDialogue(orderNumber){jQ.ajax({url:'/webshop/checkIfShouldAllowMerge.do',dataType:"xml",data:{overrideRedirectUrlAfterLogin:'/webshop/displayOrder.do?orderNo='+orderNumber,orderNo:orderNumber}}).done(function(response){showEditDialogue(response,orderNumber);}).fail(function(jqXHR){var json=webshop.popup.utils.tryParseJSON(jqXHR.responseText);if(json){var redirectUrl=webshop.popup.utils.getRedirectPath(json);if(!redirectUrl){window.location.href='/webshop/error.do';}else{window.location.href=redirectUrl;}}});}
function showEditDialogue(response,orderNumber){var shouldAllowMerge=jQ(response).find('shouldAllowMerge').text()==="true";if(shouldAllowMerge){new Backbone.Webshop.order.EditOrderConfirmationPopup({orderNumber:orderNumber}).render();}else{var csrfToken=jQ("meta[name='_csrf']").attr("content");window.location="/webshop/editOrder.do?orderNo="+orderNumber+"&_csrf="+csrfToken;}}
return{confirmationPopup:confirmationPopup,shouldShowEditDialogue:shouldShowEditDialogue};})();jQuery(document).ready(function(){jQ(".edit-order").on("click",webshop.rwd.EditOrder.confirmationPopup);});(function(Backbone){'use strict';Backbone.Webshop.ulp.UlpBannerView=Backbone.Marionette.ItemView.extend({template:false,ui:{closeButton:'.close'},events:{'click @ui.closeButton':'closeBanner'},initialize:function(){this.bindUIElements();this.model=new Backbone.Webshop.ulp.UlpBannerModel();},closeBanner:function(event){event.preventDefault();$(window).trigger('recalculateAllStickyElements');hideBanner.call(this);}});function hideBanner(){return this.model.hideBanner().always(function(){this.$el.remove();}.bind(this));}})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.ulp.UlpBannerModel=Backbone.Model.extend({url:'/webshop/hideULPBanner.do',hideBanner:function(){return this.sync('create',this,{data:{ajax:true},processData:true});}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.pers.PersBannerView=Backbone.Marionette.ItemView.extend({template:false,ui:{closeButton:'.close',linkLayer:'a:not(.close)'},events:{'click @ui.closeButton':'closeBanner','click @ui.linkLayer':'logClick'},initialize:function(){this.bindUIElements();this.model=new Backbone.Webshop.pers.PersBannerModel();},closeBanner:function(event){event.preventDefault();closeBanner.call(this);},logClick:function(event){event.preventDefault();clickBanner.call(this,event);}});function closeBanner(){return this.model.closeBanner().always(function(){this.$el.remove();}.bind(this));}
function clickBanner(e){return this.model.clickBanner().always(function(){window.location.href=e.target.getAttribute('href');}.bind(this));}})(Backbone);(function(Backbone){'use strict';var ACTION_CLICK='click',ACTION_CLOSE='close';Backbone.Webshop.pers.PersBannerModel=Backbone.Model.extend({url:function(){var action=this.get('action');return'/webshop/personalisation/banner/'+action},closeBanner:function(){this.set('action',ACTION_CLOSE);return this.sync('create',this);},clickBanner:function(){this.set('action',ACTION_CLICK);return this.sync('create',this);}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.appBanner.AppBannerView=Backbone.Marionette.ItemView.extend({template:false,ui:{closeButton:'.js-close',viewButton:'.js-view'},events:{'click @ui.closeButton':'closeBanner','click @ui.viewButton':'closeBannerAndGoToStore'},initialize:function(){this.bindUIElements();this.model=new Backbone.Webshop.appBanner.AppBannerModel();},closeBanner:function(event){event.preventDefault();this.model.reportBannerCloseAndSetCookie();hideBanner(this.$el);},closeBannerAndGoToStore:function(event){event.preventDefault();this.model.reportRedirectToStoreAndSetCookie();hideBanner(this.$el);this.trigger('go:to:store',this.ui.viewButton.attr('href'));}});function hideBanner(appBanner){appBanner.remove();Backbone.$(window).trigger("infoClosed");}})(Backbone);(function(Backbone){'use strict';var BANNER_CLOSED='Mobile app banner closed',REDIRECT_TO_STORE='Redirect to store from mobile app banner';Backbone.Webshop.appBanner.AppBannerModel=Backbone.Model.extend({setMobileAppBannerLastSeenPOCCookie:function(){Cookies.set('MAB_LSPOC',webshop.info.POC,{expires:365,httpOnly:false,secure:true});},reportBannerCloseAndSetCookie:function(){this.setMobileAppBannerLastSeenPOCCookie();sendAnalytics(BANNER_CLOSED);},reportRedirectToStoreAndSetCookie:function(){this.setMobileAppBannerLastSeenPOCCookie();sendAnalytics(REDIRECT_TO_STORE);}})
function sendAnalytics(pageEventType){Backbone.Webshop.analytics.WebshopAnalytics.reportPageEvent(pageEventType,{DEVICE:Backbone.Webshop.Device.deviceName()})}})(Backbone);(function(Backbone,bowser,jQuery){'use strict';Backbone.Webshop.mixins.showUnsupportedBrowserAlert=function(){function compareVersions(version1,version2){var v1Array=version1.split('.');var v2Array=version2.split('.');var minLength=v1Array.length>v2Array.length?v2Array.length:v1Array.length;for(var i=0;i<minLength;i++){var subV1=parseInt(v1Array[i]);var subV2=parseInt(v2Array[i]);if(subV1>subV2){return 1;}else if(subV1<subV2){return-1;}}
if(v1Array.length>v2Array.length){return 1;}else if(v1Array.length<v2Array.length){return-1;}
return 0;}
if((bowser.msie===true&&bowser.version&&compareVersions(bowser.version,'11'))<0||(bowser.android===true&&bowser.osversion&&compareVersions(bowser.osversion,'4.4')<0)){jQuery('#unsupportedBrowserAlert').css('display','block').append('<img class="invisible-dummy-button" src="/webshop/wa/browser/notSupported" alt="Reporting not supported browser" />');jQuery(window).trigger('oldBrowserDetected');}};})(Backbone,bowser,jQuery);(function(Backbone){'use strict';Backbone.Webshop.mixins.getAnalyticsAttributesForProduct=function(fopData){var fopContext=Backbone.Wreqr.radio.channel('gtm').reqres.request('fopContext')||{};var listName=fopContext.pageType;var sectionTitle=fopData.section||listName;if(fopContext.useSectionTitleAsListName){listName=sectionTitle;}
return{sectionTitle:sectionTitle,pageType:fopContext.pageType,listName:listName};}})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.mixins.sendOOSEventIfPresent=function(){if(webshop.common.jsVariables.get('oosStatisticsPerCluster')){new Backbone.Webshop.oos.GTMOosEventSender().sendOosGAEvents();}};})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.homepage.HomepageTileController=Backbone.Marionette.Controller.extend({initTiles:function(){initBookDeliveryTile();initOrderStatusTile.call(this);initCustomerMessages();initOrderTabs();}});function initBookDeliveryTile(){if(Backbone.$('.tile.book-delivery').length){var bookDeliveryHomepageTileDateModel=new Backbone.Webshop.homepage.BookDeliveryHomepageTileDateModel({},{tileName:'bookDelivery'});bookDeliveryHomepageTileDateModel.fetch();new Backbone.Webshop.homepage.BookDeliveryHomepageTileView({el:'.tile.book-delivery',model:bookDeliveryHomepageTileDateModel,tileDateModel:bookDeliveryHomepageTileDateModel}).render();new Backbone.Webshop.homepage.DesktopBookDeliveryHomepageView({el:'.js-slot-info',model:bookDeliveryHomepageTileDateModel}).render();}}
function initOrderStatusTile(){if(Backbone.$('.tile.order-status').length){var orderStatusHomepageTileDateModel=new Backbone.Webshop.homepage.HomepageTileDateModel({},{tileName:'orderStatusDate'});var orderStatusHomepageTileModel=new Backbone.Webshop.homepage.OrderStatusHomepageTileModel();var orderStatusHomepageTileView=new Backbone.Webshop.homepage.OrderStatusHomepageTileView({el:'.tile.order-status',model:orderStatusHomepageTileModel,tileDateModel:orderStatusHomepageTileDateModel});new Backbone.Webshop.homepage.DesktopOrderStatusHomepageView({el:'.js-next-delivery',model:orderStatusHomepageTileModel});this.listenTo(orderStatusHomepageTileView,'move:to:edit:order',function(url){this.trigger('move:to:edit:order',url);});this.listenTo(orderStatusHomepageTileView,'move:to:rebook:order',function(url){this.trigger('move:to:rebook:order',url);});orderStatusHomepageTileView.render();orderStatusHomepageTileDateModel.fetch();orderStatusHomepageTileModel.fetch();}}
function initCustomerMessages(){var customerMessagesContainer=Backbone.$('.js-customer-messages-container');if(customerMessagesContainer.length){var customerMessagesContainerView=new Backbone.Webshop.homepage.CustomerMessagesContainerView({el:customerMessagesContainer});Backbone.$('.js-customer-message').each(function(index,customerMessage){var customerMessageView=new Backbone.Webshop.homepage.CustomerMessageTileView({el:customerMessage});customerMessagesContainerView.listenToMessage(customerMessageView);});}}
function initOrderTabs(){if(Backbone.$('.js-order-tabs').length){new Backbone.Webshop.tabbedContent.TabsContainerView({el:'.js-order-tabs'});}}})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.slotBooking.RegularSlotsController=Backbone.Marionette.Controller.extend({initSlotBooking:function(){var $slotsTable=Backbone.$('#slotsTableWrapper');if($slotsTable.length==0){return;}
var $slotsJsonData=Backbone.$("#slotsJsonData");if(!$slotsJsonData||!$slotsJsonData.length){return;}
var $partnerOrdersJsonData=Backbone.$("#partnerOrdersJsonData");if($partnerOrdersJsonData&&$partnerOrdersJsonData.length){var $partnerOrdersObj=JSON.parse($partnerOrdersJsonData.html());var combinePopupModel=new Backbone.Webshop.delivery.CombineOrdersPopupModel($partnerOrdersObj);var combinePopupView=new Backbone.Webshop.delivery.CombineOrdersPopupView({model:combinePopupModel});combinePopupModel.show();}
var $changingSlotData=Backbone.$("#changingSlotData");var isChangingSlot=false;if($changingSlotData&&$changingSlotData.length){isChangingSlot=JSON.parse($changingSlotData.html()).changingSlot;}
else if(window.location.search&&window.location.search.indexOf('from=alternatives')>-1){isChangingSlot=true;}
var modelData=Backbone.Webshop.slotBooking.SlotsSelectorModelTransformer.transform(JSON.parse($slotsJsonData.html()),null,isChangingSlot);var slotsSelectorModel=new Backbone.Webshop.slotBooking.SlotsSelectorModel(modelData);var slotsSelectorView=new Backbone.Webshop.slotBooking.SlotsSelectorView({model:slotsSelectorModel,el:$slotsTable});slotsSelectorView.render();}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.delivery.SlotDetailsController=Backbone.Marionette.Controller.extend({initSlotDetails:function(){var cancelDeliveryPopupModel=new Backbone.Webshop.delivery.CancelDeliveryPopupModel();new Backbone.Webshop.delivery.CancelDeliveryPopupView({model:cancelDeliveryPopupModel});new Backbone.Webshop.delivery.SlotDetailsView({el:'.currentDeliveryDetails',cancelDeliveryPopupModel:cancelDeliveryPopupModel});new Backbone.Webshop.delivery.SlotDetailsCheckoutButton({model:Backbone.Webshop.Basket.getInstance(),el:'#deliveryDetailsCheckoutButton'});if($('#deliveryDetailsCheckoutButtonNewDesign').length){new Backbone.Webshop.delivery.newdesign.SlotDetailsCheckoutButton({model:Backbone.Webshop.Basket.getInstance(),el:'#deliveryDetailsCheckoutButtonNewDesign'});}}});})(Backbone);Backbone.Webshop.router.mixin.hideOverlappingElements=function(PromotionBoxElem){var allPromotedElements=Backbone.$(PromotionBoxElem).find('li:not(.more-products)'),numberOfVisibleItems=findElementsToShow();Backbone.$(allPromotedElements).show().slice(numberOfVisibleItems).hide();showMoreIfNeeded(allPromotedElements.length-numberOfVisibleItems);function findElementsToShow(){Backbone.$(PromotionBoxElem).removeClass('more-space');var maxWidth=allPromotedElements.first().width(),minWidth=allPromotedElements.first().find('img').width()+10,containerWidth=Backbone.$(PromotionBoxElem).width(),containerCapacity=Math.floor((containerWidth-minWidth)/maxWidth)+1;if(allPromotedElements.length>containerCapacity){return containerCapacity-1;}
else{return containerCapacity;}}
function showMoreIfNeeded(numberOfHiddenElements){Backbone.$(PromotionBoxElem).find('.more-products').remove();if(numberOfHiddenElements>0){Backbone.$(PromotionBoxElem).append(Handlebars.templates['deals/more']({number:numberOfHiddenElements}));if(numberOfVisibleItems===1){Backbone.$(PromotionBoxElem).addClass('more-space');}}}};(function(Backbone){"use strict";Backbone.Webshop.router.mixin.initializeAddEverythingButtons=function(){_.each(Backbone.$(".js-addEverything"),function(addEverythingButton){var $button=$(addEverythingButton);new Backbone.Webshop.AddEverythingButton({el:$button,model:new Backbone.Model({url:$button.data('add-everything-url')})});});};})(Backbone);(function(Backbone,webshop){"use strict";Backbone.Webshop.router.mixin.initializeAsyncFopContainer=function(collectionId){initializeAsyncFopContainer(collectionId,false);};Backbone.Webshop.router.mixin.initializeDesktopOnlyAsyncFopContainer=function(collectionId){initializeAsyncFopContainer(collectionId,true);};function initializeAsyncFopContainer(collectionId,desktopBreakpointOnly){var $fopsContainer=Backbone.$(collectionId?'#js-productPageFops-'+collectionId:'#js-productPageFops');var $ajaxParams=$fopsContainer.children('.js-ajaxParams');var uri=$ajaxParams.data('ajax-uri');if(!$fopsContainer.length){return;}
if(!desktopBreakpointOnly||Backbone.Webshop.ViewType.isDesktop()){initializeContainer($fopsContainer,uri,$ajaxParams);}else{Backbone.$(window).one('afterResizeToDesktop',function(){initializeContainer($fopsContainer,uri,$ajaxParams);});}}
function initializeContainer($fopsContainer,uri,$ajaxParams){Backbone.$.ajax({type:'GET',url:uri,data:JSON.parse($ajaxParams.text())}).done(function(data){if(Backbone.$.isEmptyObject(data)){return false;}
var fopContainerModel=new Backbone.Webshop.fop.FopContainerModel({},{fopJsonData:data});fopContainerModel.fetch();$fopsContainer.parents('.you-might-like').show();new Backbone.Webshop.fop.FopContainerView({el:$fopsContainer,model:fopContainerModel}).render().renderAllFops();});}})(Backbone,webshop);(function(Backbone){"use strict";Backbone.Webshop.router.mixin.initializeBannerCarousels=function(){Backbone.$('.js-banner-carousel').each(function(){new Backbone.Webshop.banners.BannerCarouselView({el:this});});};})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.router.mixin.initializeComboDealsFop=function(viewConstructor,modelConstructor){Backbone.Webshop.router.mixin.saveFopContext();var $fopContainersInGroup=Backbone.$(".js-productCarouselFops");initializeContainers(viewConstructor,modelConstructor,$fopContainersInGroup);};function initializeContainers(viewConstructor,modelConstructor,$fopContainersInGroup){initializeContainerFromIndex(viewConstructor,modelConstructor,$fopContainersInGroup,0)();}
function initializeContainerFromIndex(viewConstructor,modelConstructor,$fopContainersInGroup,containerIndex){return function(){if(containerIndex<$fopContainersInGroup.length){var $fopContainer=$fopContainersInGroup.get(containerIndex);var $fopData=Backbone.$($fopContainer).children(".js-productCarouselData");var fopContainerModel=new modelConstructor({},{fopJsonElement:$fopData});fopContainerModel.fetch();new viewConstructor({el:$fopContainer,model:fopContainerModel}).render();_.defer(initializeContainerFromIndex(viewConstructor,modelConstructor,$fopContainersInGroup,containerIndex+1));}}}})(Backbone);(function(Backbone,Handlebars){"use strict";Backbone.Webshop.router.mixin.initializeComboDealLandingPage=function(){Backbone.$('.deal-components-show-more').each(function(){Backbone.Webshop.router.mixin.hideOverlappingElements(this);Backbone.$(window).on('resize',function(){Backbone.Webshop.router.mixin.hideOverlappingElements(this);}.bind(this));});};})(Backbone,Handlebars);(function(Backbone){Backbone.Webshop.router.mixin.initializeDeliveryPassDetails=function(){Backbone.$('select[name=storedCardId]').each(function(index,select){new Backbone.Webshop.payment.CreditCardSelectView({el:select});});}})(Backbone);(function(Backbone){Backbone.Webshop.router.mixin.initializeDisplayDeliveryPass=function(){Backbone.Webshop.router.mixin.initializeFopContainer();initSelectDiscountClubPlanButtonViews();trackSignedUpInDiscountClub();new Backbone.Webshop.discountclub.DiscountClubHeaderView({el:Backbone.$('.discount-club')}).render();};function initSelectDiscountClubPlanButtonViews(){Backbone.$('.btn-wrapper.sign-up').each(function(index,select){new Backbone.Webshop.discountclub.SelectDiscountClubPlanButtonView({el:select});});}
function trackSignedUpInDiscountClub(){var selectedDiscountClubSchemeDTO=webshop.common.jsVariables.get("selectedDiscountClubSchemeDTO");if(!_.isUndefined(selectedDiscountClubSchemeDTO)){new Backbone.Webshop.discountclub.GTMDiscountClubSigningUpEventSender().sendSignedUpEvent(selectedDiscountClubSchemeDTO);}}})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.router.mixin.initializeFopCarousel=function(viewConstructor,modelConstructor){Backbone.Webshop.router.mixin.saveFopContext();var $fopContainersInGroup=Backbone.$(".js-productCarouselFops");enableScrollStopEvent();initializeContainers(viewConstructor,modelConstructor,$fopContainersInGroup);};function enableScrollStopEvent(){$.fn.scrollStopped=function(callback){var that=this,$this=$(that),isScrolling=false,scrollStarted=false;$this.on('scroll',function(ev){function checkIfStopped(){if(!isScrolling){clearInterval(interval);$this.data('scrollTimeout',setTimeout(callback.bind(that),1,ev));scrollStarted=false;isScrolling=false;}
isScrolling=false;}
if(!scrollStarted){var interval=setInterval(checkIfStopped,100);scrollStarted=true;}
isScrolling=true});};}
function initializeContainers(viewConstructor,modelConstructor,$fopContainersInGroup){initializeContainerFromIndex(viewConstructor,modelConstructor,$fopContainersInGroup,0)();}
function initializeContainerFromIndex(viewConstructor,modelConstructor,$fopContainersInGroup,containerIndex){return function(){if(containerIndex<$fopContainersInGroup.length){var $fopContainer=$fopContainersInGroup.get(containerIndex);var $fopData=Backbone.$($fopContainer).children(".js-productCarouselData");var fopContainerModel=new modelConstructor({},{fopJsonElement:$fopData});fopContainerModel.fetch();new viewConstructor({el:$fopContainer,model:fopContainerModel}).render();_.defer(initializeContainerFromIndex(viewConstructor,modelConstructor,$fopContainersInGroup,containerIndex+1));}}}})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.router.mixin.initializeFopContainer=function(viewConstructor,collectionId,fopContext,skipSortByView){if(viewConstructor===undefined){viewConstructor=Backbone.Webshop.fop.FopContainerView;}
Backbone.Webshop.router.mixin.saveFopContext(fopContext);var $fopsContainer=Backbone.$(collectionId?"#js-productPageFops-"+collectionId:"#js-productPageFops");var $fopData=$fopsContainer.children(".js-productPageJson");if($fopsContainer.length){var fopContainerModel=new Backbone.Webshop.fop.FopContainerModel({},{fopJsonElement:$fopData});fopContainerModel.fetch().always(function(){new viewConstructor({el:$fopsContainer,model:fopContainerModel}).render();if(!skipSortByView){new Backbone.Webshop.sortby.SortByView();}
Backbone.Webshop.mixins.sendOOSEventIfPresent();});}};})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.router.mixin.initializeImportFavouritesButton=function(){Backbone.$('.js-importFavourites').each(function(){new Backbone.Webshop.favourites.ImportButtonView({el:this});});}})(Backbone);(function(Backbone,_){"use strict";Backbone.Webshop.router.mixin.initializeOffersContainer=function(scroll,indexOfClicked,wasComplete){if(Modernizr.csspositionsticky){setTopAttributeForComboPromoBanner();}
if(Backbone.$('.combo-deal-summary-wrapper').length===0){return;}
var fopsGroups=Backbone.$('.combo-deal-category'),numberOfElementsInSlot=Backbone.$('.combo-promotions-slot > li').length,elementWidth=getPromotionSummaryElementWidth(),comboDealSummaryWrapperElement=Backbone.$('.combo-deal-summary-wrapper'),comboDealSummaryElement=Backbone.$('.combo-deal-summary'),comboDealSummaryWrapperHeight=Backbone.$('.combo-promotions-slot').height(),animationTime=600,elemOffset=10,waypoint,scrollWatchActive=true;setPromotionSummaryWidth(numberOfElementsInSlot,elementWidth);addClassesToRelevantElements(indexOfClicked,wasComplete);bindElementsInComboSummaryToProductCategories();if(!Modernizr.csspositionsticky){makePromotionsSummarySticky();}
enableVerticalScrollEventsAffectPromotionSummary();emphasizeBorderPromotionSummaryElementWhileScrolledToPageBounduaries();function recalculatePromotionSummary(){waypoint.destroy();if(!Modernizr.csspositionsticky){makePromotionsSummarySticky();}
setTimeout(function(){elementWidth=getPromotionSummaryElementWidth();comboDealSummaryWrapperHeight=Backbone.$('.combo-promotions-slot').height();Backbone.$('.combo-deal-summary, .carousel-wrapper, .combo-promotions-slot').attr('style','');setPromotionSummaryWidth(numberOfElementsInSlot,elementWidth);},animationTime);};$(window).on('resizedToMobile resizedToDesktop',function(){Backbone.$('body, html').animate({scrollTop:0},animationTime);});function makePromotionsSummarySticky(){var headerElement=Backbone.$('#header'),offset=headerElement.height()+parseInt(headerElement.css('top'),10);waypoint=new Waypoint({element:Backbone.$('.waypointsTrace')[0],offset:(offset+10)+'px',handler:function(direction){if(direction=='down'&&!Backbone.Webshop.ViewType.isShortDesktop()){comboDealSummaryWrapperElement.addClass('sticky');Backbone.$('.waypointsTrace').css('padding-bottom',parseInt(comboDealSummaryWrapperElement.height())-elemOffset+'px');if(!Modernizr.csspositionsticky){comboDealSummaryWrapperElement.css('top',offset+'px');}}
if(direction=='up'&&!Backbone.Webshop.ViewType.isShortDesktop()){comboDealSummaryWrapperElement.removeClass('sticky');Backbone.$('.waypointsTrace').css('padding-bottom','0');comboDealSummaryWrapperElement.css('top','');}}});}
Backbone.$(window).on('resize',recalculatePromotionSummary);Backbone.$(window).on('recalculateAllStickyElements',recalculatePromotionSummary);function enableVerticalScrollEventsAffectPromotionSummary(){for(var i=0,length=fopsGroups.length;i<length;i++){new Waypoint({element:fopsGroups[i],group:i,offset:Backbone.$('#header').height()+parseInt(comboDealSummaryWrapperElement.height())+70+'px',handler:function(direction){if(direction=='down'&&scrollWatchActive==true){emphasizeActiveCategory(this.group.name);}}});new Waypoint({element:fopsGroups[i],group:i,offset:'60%',handler:function(direction){if(direction=='up'&&scrollWatchActive==true){emphasizeActiveCategory(this.group.name-1);}}});}
function currentIndex(){return Backbone.$('.combo-promotions-slot li').index(Backbone.$('.activeCategory'));}}
function emphasizeBorderPromotionSummaryElementWhileScrolledToPageBounduaries(){window.onscroll=function(ev){if((window.innerHeight+window.scrollY)>=$("html").prop("scrollHeight")){moveBackgroundElementInComboSummary(parseInt(numberOfElementsInSlot-1));}
if((window.scrollY)==0){moveBackgroundElementInComboSummary(0);}};}
function emphasizeActiveCategory(categoryIndex){function inSlotIndex(categoryIndex){var selector="[data-id='"+Backbone.$(Backbone.$('.combo-deal-category')[categoryIndex]).attr('data-group-id')+"']";return Backbone.$('.combo-promotions-slot li').index($(selector).parent());}
Backbone.$(fopsGroups[categoryIndex-1]).addClass('showMe').siblings().removeClass('showMe');moveBackgroundElementInComboSummary(inSlotIndex(categoryIndex));}
function getPromotionSummaryElementWidth(){Backbone.$('.combo-promotions-slot').width(500);return Backbone.$('.combo-promotions-slot > li:eq(1)').position().left;}
function setPromotionSummaryWidth(numberOfElementsInSlot,elementWidth){var carouselsOffset=20,marginWidth=10,comboSummaryPadding=15;Backbone.$('.combo-promotions-slot').width(numberOfElementsInSlot*(elementWidth+marginWidth)-carouselsOffset);if(numberOfElementsInSlot*elementWidth<window.innerWidth){comboDealSummaryElement.width(numberOfElementsInSlot*(elementWidth+marginWidth)-carouselsOffset+comboSummaryPadding);Backbone.$('.validTill').removeClass('fullWidth');}else{comboDealSummaryElement.width(window.innerWidth-marginWidth);Backbone.$('.validTill').addClass('fullWidth');}}
function bindElementsInComboSummaryToProductCategories(){var uniqueIndex=0;Backbone.$('.combo-promotions-slot figure').map(function(){if(typeof(fopsGroups[$(this).attr('data-id')])==='undefined')
uniqueIndex++;fopsGroups[$(this).attr('data-id')]=uniqueIndex;(function(index,el){Backbone.$(el).parents('li').on('click',function(){Backbone.$(fopsGroups[index-1]).addClass('showMe').siblings().removeClass('showMe');moveBackgroundElementInComboSummary(Backbone.$('.combo-promotions-slot > li').index(this));scrollVerticallyToProductGroup();});})(uniqueIndex,this);});function scrollVerticallyToProductGroup(){var offset=20,scrollPosition=Backbone.$('.showMe').offset().top-parseInt(Backbone.$('.main').css('margin-top'))-parseInt(Backbone.$('.main').css('padding-top'))-comboDealSummaryWrapperHeight-parseInt(comboDealSummaryElement.css('margin-bottom'));Waypoint.disableAll();waypoint.enable();Backbone.$('body, html').animate({scrollTop:scrollPosition-offset},animationTime,function(){Waypoint.enableAll();});}}
function addClassesToRelevantElements(indexOfClicked,wasComplete){if(wasComplete)
comboDealSummaryElement.addClass('no-animation');else
comboDealSummaryElement.removeClass('no-animation');scrollWatchActive=false;if(indexOfClicked){Backbone.$('.combo-deal-category').eq(indexOfClicked).addClass('showMe');moveBackgroundElementInComboSummary(indexOfClicked);}else{Backbone.$('.combo-deal-category:first').addClass('showMe');moveBackgroundElementInComboSummary(0)}
setTimeout(function(){scrollWatchActive=true;},1000);}
function moveBackgroundElementInComboSummary(inSlotIndex){var catId=Backbone.$('.combo-promotions-slot li').eq(inSlotIndex).find('figure').attr('data-id'),elementsOfCategory=Backbone.$('figure[data-id='+catId+']'),categoryFirstIngroupPosition=elementsOfCategory.first().parent().position().left,elementOffset=20,easingTime=animationTime,leftAdjust;if(!scrollWatchActive){easingTime=0;}
comboDealSummaryElement.find('.carousel-wrapper').css('overflow','hidden');comboDealSummaryElement.find('.carousel-wrapper').animate({scrollLeft:inSlotIndex*(elementWidth+10)},easingTime,function(){setTimeout(function(){comboDealSummaryElement.find('.carousel-wrapper').css('overflow','')},700);});if(categoryFirstIngroupPosition<30){elementOffset=0;leftAdjust=10;}else{leftAdjust=0;}
elementsOfCategory.first().parent().removeClass('activeCategory').siblings().removeClass('activeCategory');elementsOfCategory.each(function(){Backbone.$(this).parent().addClass('activeCategory');});}
function setTopAttributeForComboPromoBanner(){if(!Modernizr.csspositionsticky){var promoWrapperElement=Backbone.$('#content > .promo-wrapper');var positionOfDealSection=promoWrapperElement.find('.combo-deal-summary-wrapper').position().top+Backbone.$('.crumb-trail-desktop').height();var menuBottom=Backbone.$('#header').offset().top+Backbone.$('#header').height();promoWrapperElement.css('top',menuBottom-positionOfDealSection);}}};})(Backbone,_);(function(Backbone){"use strict";Backbone.Webshop.router.mixin.initializePromotedBoxCarousel=function(){var $promoBoxesContainer=Backbone.$('.js-productCarouselBoxes');initializeContainer($promoBoxesContainer);};function initializeContainer($promoBoxesContainer){new Backbone.Webshop.promobox.PromotedBoxContainerView({el:$promoBoxesContainer}).render();}})(Backbone);(function(Backbone,_){"use strict";Backbone.Webshop.router.mixin.initializePromotedBoxes=function(){Backbone.$('.js-promoted-box').each(function(index,$promotedBox){initializePromotedBox($promotedBox);})};function initializePromotedBox($promotedBox){new Backbone.Webshop.promobox.PromotedBoxView({el:$promotedBox});}})(Backbone,_);(function(Backbone){'use strict';Backbone.Webshop.router.mixin.initializeRecipeImageAndVideoPopup=function(){var $enlargeImageButton=Backbone.$('.js-carousel-wrapper');if($enlargeImageButton.length>0){new Backbone.Webshop.recipes.EnlargeImageView({el:$enlargeImageButton});}}})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.router.mixin.initializeReviews=function(){var reviews=Backbone.$('.js-reviews');if(!reviews.length){return;}
var recipeId=reviews.data('recipe-id');initializeReviewCollection(recipeId);initializeSummary(recipeId);};function initializeReviewCollection(recipeId){var reviewCollection=new Backbone.Webshop.reviews.ReviewCollection({id:recipeId});reviewCollection.fetch();new Backbone.Webshop.reviews.ReviewCollectionView({el:'.js-reviewsDetails',collection:reviewCollection}).render();}
function initializeSummary(recipeId){var summaryModel=new Backbone.Webshop.reviews.ReviewSummaryModel({id:recipeId});summaryModel.fetch().then(function(data){if(_.isEmpty(data)){new Backbone.Webshop.reviews.FirstTimeReviewButtonView({el:'.js-reviewSummary',model:summaryModel}).render();}else{new Backbone.Webshop.reviews.ReviewSummaryView({el:'.js-reviewSummary',model:summaryModel}).render();}
var $writeReviewButton=Backbone.$(".js-writeReview");if($writeReviewButton.length>0){new Backbone.Webshop.reviews.ReviewButtonView({el:$writeReviewButton,uri:$writeReviewButton.data('href')});}});}})(Backbone);(function(Backbone){Backbone.Webshop.router.mixin.initializeSwitchAndSave=function(){if(Backbone.$('#js-productPageFops-switchAndSaveItems').length>0){var itemsToHideCollection=new Backbone.Webshop.SwitchAndSaveItemsToHideCollection();var fopContainerView=Backbone.Webshop.fop.FopContainerView.extend({childEvents:{'toggleHide:swap':function(childView,swapProposal){itemsToHideCollection.update(swapProposal);}}});Backbone.Webshop.router.mixin.initializeFopContainer(fopContainerView,"switchAndSaveItems");new Backbone.Webshop.cow.CheckoutWalkSwitchAndSaveContinueButtonView({el:'.js-continue-button',model:new Backbone.Webshop.cow.CheckoutWalkContinueButtonModel(),itemsToHideCollection:itemsToHideCollection});return true;}
return false;}})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.router.mixin.initializeWineFinder=function(){var $wineFinderContainer=Backbone.$('#js-wineFinder');var $wineFinderData=$wineFinderContainer.children('.js-wineFinderJson');if($wineFinderContainer.length){var wineFinderDto=JSON.parse($wineFinderData.text());var wineFinderModel=new Backbone.Webshop.wineFinder.WineFinderModel(wineFinderDto);new Backbone.Webshop.wineFinder.WineFinderView({el:$wineFinderContainer,model:wineFinderModel}).render();}};})(Backbone);(function(Backbone,_){"use strict";var dealWrapperElement=Backbone.$('.bundle-deal-wrapper'),elementWidth=minElementWidth(dealWrapperElement.find('ul > li:eq(1)')),marginRight=10,dealWrapperElements=dealWrapperElement.find('ul > li'),comboPromotionSlot=Backbone.$('.combo-promotions-slot'),summary=Backbone.$('.combo-deal-summary');Backbone.Webshop.router.mixin.makeComboDetailsSticky=function(){if(Modernizr.csspositionsticky){setTopAttributeForPromoBanner();}
if(dealWrapperElement.length===0){return;}
setPromoSlotWidth(dealWrapperElements,comboPromotionSlot,summary);if(!Modernizr.csspositionsticky){setWaypoint();}
$(window).on('resize recalculateAllStickyElements',function(){setPromoSlotWidth(dealWrapperElements,comboPromotionSlot,summary);Waypoint.destroyAll();if(!Modernizr.csspositionsticky){resetStickiness();setWaypoint();}else{setTopAttributeForPromoBanner();}});};function minElementWidth(bundleDealWrapperEl){if(bundleDealWrapperEl.length)
return bundleDealWrapperEl.position().left-bundleDealWrapperEl.prev().position().left;else
return 0;}
function setTopAttributeForPromoBanner(){if(Backbone.$('.bundle-deal-wrapper').length){var positionOfDealSection=Backbone.$('.bundle-deal-wrapper').position().top;var menuBottom=Backbone.$('#header').offset().top+Backbone.$('#header').height();if(!Modernizr.csspositionsticky){Backbone.$('.promo-wrapper').css('top',menuBottom-positionOfDealSection);}}}
function setPromoSlotWidth(elementsInWrapper,comboPromotionSlotElement,comboDealSummaryElement){var numberOfSlots=elementsInWrapper.length,elementMargin=elementWidth-elementsInWrapper.first().width();function setPromotionSlotWidth(numberOfElementsInSlot,elementWidth){if(numberOfElementsInSlot*(elementWidth+marginRight)<window.innerWidth){dealWrapperElement.width(numberOfElementsInSlot*(elementWidth+elementMargin));comboPromotionSlotElement.parent().width(numberOfElementsInSlot*(elementWidth+elementMargin));comboDealSummaryElement.width(numberOfElementsInSlot*(elementWidth+marginRight));}else{dealWrapperElement.width('');comboPromotionSlotElement.parent().width('');comboDealSummaryElement.width('');}
Backbone.Webshop.router.mixin.hideOverlappingElements('.deal-components-show-more');}
if(dealWrapperElement.length>0&&elementWidth>0){setPromotionSlotWidth(numberOfSlots,elementWidth);}}
function resetStickiness(){dealWrapperElement.css('padding-bottom','');dealWrapperElement.find('.deal').removeClass('sticky').css('width','');dealWrapperElement.removeClass('slide-in');if(!Modernizr.csspositionsticky){dealWrapperElement.find('.deal').css('top','');}
Backbone.$('.main').css('height','');}
function setWaypoint(){var headerElement=Backbone.$('#header'),offset=headerElement.height()+13+parseInt(headerElement.css('top'),10)+'px';if(Backbone.$('.bundle-deal-wrapper').length>0&&!Backbone.Webshop.ViewType.isShortDesktop()){new Waypoint({element:Backbone.$('.bundle-deal-wrapper')[0],offset:offset,handler:function(direction){if(direction=='down'){Backbone.$('.main').css('height',$('.main').height());dealWrapperElement.css('padding-bottom',parseInt(dealWrapperElement.height()-dealWrapperElement.find('.deal-link').height()-30)+'px');dealWrapperElement.find('.deal').addClass('sticky');dealWrapperElement.find('.deal').css('top',offset);dealWrapperElement.addClass('slide-in');}
if(direction=='up'){resetStickiness();}}});}}})(Backbone,_);(function(Backbone,_){"use strict";Backbone.Webshop.router.mixin.saveFopContext=function(fopContext){var fullFopContext=fopContext||{};if(!fullFopContext.pageType){fullFopContext.pageType=webshop.common.jsVariables.get('pageType');}
Backbone.Wreqr.radio.channel('gtm').reqres.setHandler("fopContext",_.constant(fullFopContext));}})(Backbone,_);(function(Backbone){'use strict';Backbone.Webshop.AnalyticsRouter=Backbone.Marionette.AppRouter.extend({initialize:function(){Backbone.Webshop.analytics.mixin.reportResolution();Backbone.Webshop.analytics.mixin.attachResizeHandler();}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.AppBannerRouter=Backbone.Marionette.AppRouter.extend({bannerEvents:{'go:to:store':'goToStore'},initialize:function(){if(Backbone.$('#jsMobileAppBanner').length){var appBannerView=new Backbone.Webshop.appBanner.AppBannerView({el:'#jsMobileAppBanner'});this.bindEntityEvents(appBannerView,this.bannerEvents);}},goToStore:function(storeUrl){window.location.replace(storeUrl)}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.BopRouter=Backbone.Marionette.AppRouter.extend({routes:{'webshop/product/:name/:sku':'initializeBop'},initializeBop:function(){Backbone.Webshop.router.mixin.saveFopContext();var model=new Backbone.Webshop.bop.BopModel();model.fetch({tagSelector:'#bop'});var $writeReviewButton=Backbone.$(".js-writeReview");if($writeReviewButton.length>0){new Backbone.Webshop.reviews.ReviewButtonView({el:$writeReviewButton,uri:$writeReviewButton.data('href'),reviewType:$writeReviewButton.data('reviewtype')});}
if(Backbone.$('.typical-price').length){new Backbone.Webshop.bop.BopView({model:model,el:'.bop'}).render();}
if(Backbone.$('.bop-derivatives').length){new Backbone.Webshop.fop.FopContainerModel({},{fopJsonElement:Backbone.$('#jsDerivativesJson')}).fetch();var derivativeSelectionModel=new Backbone.Webshop.bop.DerivativeSelectionModel();derivativeSelectionModel.fetch({tagSelector:'#jsDerivativeSelectionView'});var bopDerivativeModel=new Backbone.Webshop.bop.BopDerivativeModel({derivativeSelectionModel:derivativeSelectionModel});bopDerivativeModel.fetch({tagSelector:'#jsDerivativeFopsView'});var derivativeView=new Backbone.Webshop.bop.BopDerivativeView({model:bopDerivativeModel,el:'.bop'});derivativeView.render();}
Backbone.Webshop.bop.analytics.BopImpressionsNotifier.reportBopImpression(model.attributes);webshop.analytics.criteo.init();}});})(Backbone);(function(Backbone,ocBackbone){'use strict';Backbone.Webshop.CookieDisclaimerRouter=Backbone.Marionette.AppRouter.extend({initialize:function(){if(Backbone.Webshop.mixins.makeCookieDisclaimerCloseable){Backbone.Webshop.mixins.makeCookieDisclaimerCloseable.call(this);}}});})(Backbone,ocBackbone);(function(Backbone){'use strict';Backbone.Webshop.CowGiftRouter=Backbone.Marionette.AppRouter.extend({routes:{"webshop/checkoutAddFreeGift.do":"init"},init:function(){Backbone.Webshop.router.mixin.initializeFopContainer();new Backbone.Webshop.cow.gift.ContinueWithoutCowGiftButtonView({el:'.js-no-cow-gift-continue-button',model:new Backbone.Webshop.cow.gift.ContinueWithoutCowGiftButtonModel()}).render();new Backbone.Webshop.cow.gift.ContinueWithCowGiftButtonView({el:'.js-cow-gift-continue-button',model:new Backbone.Webshop.cow.gift.ContinueWithCowGiftButtonModel()}).render();new Backbone.Webshop.cow.gift.ContinueWithoutCowGiftButtonView({el:'.js-no-cow-gift-continue-button-top',model:new Backbone.Webshop.cow.gift.ContinueWithoutCowGiftButtonModel()}).render();new Backbone.Webshop.cow.gift.ContinueWithCowGiftButtonView({position:'top',el:'.js-cow-gift-continue-button-top',model:new Backbone.Webshop.cow.gift.ContinueWithCowGiftButtonModel()}).render();}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.DeliveryRouter=Backbone.Router.extend({routes:{'webshop/displaySlotDetails.do':'initSlotDetails'},initSlotDetails:function(){var slotDetailsCtrl=new Backbone.Webshop.delivery.SlotDetailsController();slotDetailsCtrl.initSlotDetails();}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.DisplayOrdersRouter=Backbone.Router.extend({initialize:function(){this.route(/^webshop\/orders\/(\d+)\/cancel.go/,'sendOrderCancellationEvent');},sendOrderCancellationEvent:function(){new Backbone.Webshop.catalogue.OrderCancellation().sendGoogleAnalyticsEvents();}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.EnhancedLandingPageRouter=Backbone.Marionette.AppRouter.extend({routes:{"webshop/showEnhancedLandingPage.do":"init"},init:function(){Backbone.Webshop.router.mixin.initializeBannerCarousels();}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.FavouritesImportRouter=Backbone.Marionette.AppRouter.extend({routes:{'webshop/selectStoreForImport.go':'init'},init:function(){new Backbone.Webshop.favourites.ImportView({el:'#js-selectImportStore'});}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.FeedbackPopupRouter=Backbone.Marionette.AppRouter.extend({initialize:function(){if(Backbone.Webshop.feedbackPopup){new Backbone.Webshop.feedbackPopup.FeedbackPopupTabView();}}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.FoodProfilePopupRouter=Backbone.Marionette.AppRouter.extend({initialize:function(){if(Backbone.Webshop.foodProfile&&Backbone.Webshop.foodProfile.FoodProfileSidebarWidget){new Backbone.Webshop.foodProfile.FoodProfileSidebarWidget();}}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.HomepageRouter=Backbone.Marionette.AppRouter.extend({homepageTileController:new Backbone.Webshop.homepage.HomepageTileController(),routes:{'webshop/startWebshop.do':'initHomepage','webshop/displayWelcome.do':'initHomepage','webshop/finaliseLogin.go':'initHomepage','webshop/admin/compositeLohpPreview.do':'initHomepage','webshop/admin/compositeLohpSectionPreview.do':'initHomepage'},homepageTileControllerEvents:{'move:to:edit:order':'moveToEditOrder','move:to:rebook:order':'moveToRebookOrder'},moveToEditOrder:function(url){location.href=url;},moveToRebookOrder:function(url){location.href=url;},initHomepage:function(){this.homepageTileController.initTiles();this.bindEntityEvents(this.homepageTileController,this.homepageTileControllerEvents);if(Backbone.$('#js-productPageFops').length){Backbone.Webshop.router.mixin.initializeFopContainer();}
Backbone.Webshop.router.mixin.initializeImportFavouritesButton();Backbone.$('.clohp-carousel').each(function(){new Backbone.Webshop.homepage.LohpCarouselView({el:$(this)});});var $postcodeBannerContainer=Backbone.$('.js-postcodeBanner');if($postcodeBannerContainer.length){new Backbone.Webshop.PostcodeBannerView({el:$postcodeBannerContainer});}}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.InviteAFriendRouter=Backbone.Marionette.AppRouter.extend({routes:{'webshop/recommendFriends.go(?type=:type)':'init'},init:function(type){if(!type&&Backbone.Webshop.mixins.isBetaFeatureEnabled("RESPONSIVE_IAF")){new Backbone.Webshop.iaf.InviteAFriendButtonView({el:'.invite-friends'});}}})})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.LoginRouter=Backbone.Router.extend({routes:{'webshop/login.go':'initializeLogin','webshop/paypalsignup.do':'initializeLogin','webshop/loginElevated.go':'initializeElevatedLogin'},initialize:function(){this.initializeLoginPopup();},initializeLogin:function(){if(Backbone.$('#simpleLoginForm').length>0){new Backbone.Webshop.login.LoginFormView({el:'#simpleLoginForm'});}
if(Backbone.$('#sso-login-form').length>0){new Backbone.Webshop.login.SSOLoginFormView({el:'#sso-login-form'});}
new Backbone.Webshop.login.SocialLoginView({el:'#socialLogin'});},initializeElevatedLogin:function(){new Backbone.Webshop.login.ElevatedLoginView({el:'#loginElevated'});},initializeLoginPopup:function(){if(Backbone.Webshop.mixins.isBetaFeatureEnabled("RESPONSIVE_LOG_REG_POPUPS")&&!webshop.popup.utils.isIphoneNavigator()){Backbone.Webshop.popup.LoginAndRegistrationButtonView&&new Backbone.Webshop.popup.LoginAndRegistrationButtonView({el:'body'});}}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.MicrositesRouter=Backbone.Marionette.AppRouter.extend({routes:{'webshop/getStaticContent.do':Backbone.Facebook.getInstance}})})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.NavigationRouter=Backbone.Marionette.AppRouter.extend({routes:{'webshop/navigation/start':'startShopping','webshop/navigation/categories':'openCategoriesNavigation','webshop/navigation/inspirations':'openInspirationsNavigation','webshop/navigation/(:category)/(:tags)':'openNavigationFromTags'},initialize:function(){prepareNavigation.call(this);},initializeNavigationComponents:function(){this.initializeCatalogueNavigation();this.initializeUserNavigation();this.initializeBackToCatalogueNavigationView();this.navigationReady.resolve();},catalogueNavigationViewEvents:{"whole:section:rendered":'navigateToCategoriesPage',"child:section:rendered":'navigateToCategoriesPage',"navigation:back":'goBackInHistory'},backToCatalogueViewEvents:{"navigation:back":'goBackInHistory'},initializeCatalogueNavigation:function(){this.catalogueNavigationView=new Backbone.Webshop.navigation.CatalogueNavigationView({model:this.model});this.bindEntityEvents(this.catalogueNavigationView,this.catalogueNavigationViewEvents);},initializeUserNavigation:function(){var navigationView=new Backbone.Webshop.navigation.UserNavigationView({model:this.model});Backbone.Webshop.navigation.openNavigation=function(){navigationView.open();}},initializeBackToCatalogueNavigationView:function(){if(Backbone.$(".js-back-to-catalogue").length){var btcv=new Backbone.Webshop.navigation.BackToCatalogueView({el:'.js-back-to-catalogue'});this.bindEntityEvents(btcv,this.backToCatalogueViewEvents);}},startShopping:function(){this.navigationReady.done(function(){this.catalogueNavigationView.openStartShoppingSection();}.bind(this));},openCategoriesNavigation:function(){this.navigationReady.done(function(){this.catalogueNavigationView.openCategorySection();}.bind(this));},openInspirationsNavigation:function(){this.navigationReady.done(function(){this.catalogueNavigationView.openInspirationSection();}.bind(this));},openNavigationFromTags:function(category,tags){this.navigationReady.done(function(){this.catalogueNavigationView.openNavigationWithTags(encodeURIComponent(tags));}.bind(this));},navigateToCategoriesPage:function(options){var model=options.collectionModel;if(model.has("url")&&model.has("name")){this.navigate("/webshop/navigation/"+encodeURIComponent(model.get("name"))+"/"+getParam(options.collectionModel.get("url"),"tags"));}},goBackInHistory:function(){window.history.back();}});function prepareNavigation(){this.model=new Backbone.Webshop.navigation.NavigationModel();this.navigationReady=new $.Deferred();if(this.model.shouldFetchData()){this.listenToOnce(this.model,'sync',this.initializeNavigationComponents);this.model.fetch();}else{this.initializeNavigationComponents();}}
function getParam(source,name){var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(source);return results===null?"":results[1];}})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.PersBannerRouter=Backbone.Marionette.AppRouter.extend({initialize:function(){var $persBannerElement=Backbone.$('#persBannerSection');if($persBannerElement.length){new Backbone.Webshop.pers.PersBannerView({el:$persBannerElement});}}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.QuickRegRouter=Backbone.Router.extend({routes:{'webshop/quickReg.do':'initQuickReg','webshop/quickRegAcceptForm.do':'initQuickReg','webshop/quickRegComplete.do':'initQuickRegComplete','webshop/registrationWithAquiVoucher.do':'initQuickReg'},initQuickReg:function(){if(Backbone.Webshop.mixins.isBetaFeatureEnabled("RESPONSIVE_LOG_REG_POPUPS")&&!webshop.popup.utils.isIphoneNavigator()){if(Backbone.$('#quickRegAcceptForm').length>0){new Backbone.Webshop.registration.RegistrationView({el:'#quickRegAcceptForm'});}}
else{this.initializeSocialLogin();}
this.initializeSSORegistrationView();},initQuickRegComplete:function(){Backbone.Webshop.router.mixin.initializeImportFavouritesButton();},initializeSocialLogin:function(){if($('#socialLogin').length>0){new Backbone.Webshop.quickreg.QuickRegView({el:'#socialLogin'});}},initializeSSORegistrationView:function(){if(Backbone.$('#sso-registration-form').length>0){new Backbone.Webshop.registration.SSORegistrationView({el:'#sso-registration-form'});}}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.RegistrationRouter=Backbone.Router.extend({routes:{'webshop/quickRegSaveMissingDetails.do':'initMissingDetails','webshop/quickRegMissingDetails.do':'initMissingDetails'},initMissingDetails:function(){var modelData=JSON.parse(Backbone.$("#missingDetailsData").html());var missingDetailsModel=new Backbone.Webshop.registration.MissingDetailsModel(modelData);var missingDetailsView=new Backbone.Webshop.registration.MissingDetailsView({model:missingDetailsModel,el:'#js-missingDetailsTemplate'});}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.SettingsRouter=Backbone.Router.extend({routes:{'webshop/facebookActions.go':'initializeFacebookSettings'},initializeFacebookSettings:function(){new Backbone.Webshop.settings.FacebookSettingsView({el:'#jsFacebookSettings'});}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.SlotBookingRouter=Backbone.Marionette.AppRouter.extend({regularSlotsController:new Backbone.Webshop.slotBooking.RegularSlotsController(),routes:{'webshop/getAddressesForDelivery.do':'initSlotBooking','webshop/getAddressesForDeliveryCheckout.do':'initSlotBooking','webshop/getUpdatedSlotBooking.do':'initSlotBooking','webshop/getUpdatedSlotBookingCheckout.do':'initSlotBooking','webshop/getAddressesForRebook.do':'initSlotBooking','webshop/changeAddressesForDelivery.do':'initSlotBooking','webshop/changeAddressesForDeliveryCheckout.do':'initSlotBooking','webshop/editOrderDelivery.do':'initSlotBooking'},initSlotBooking:function(){this.getOption('regularSlotsController').initSlotBooking();this.initDiscountClubBanner();var $postcodeBannerContainer=Backbone.$('.js-postcodeBanner');if($postcodeBannerContainer.length){new Backbone.Webshop.PostcodeBannerView({el:$postcodeBannerContainer});}},initDiscountClubBanner:function(){if(Backbone.$(".discount-club-banner").length>0){new Backbone.Webshop.slotBooking.DiscountClubBannerView({el:'.discount-club-banner'});}}});})(Backbone);(function(Backbone){'use strict';var content='<a href="/webshop/getAddressesForDelivery.do?fromBookSlotPrompt=true">Book a delivery</a> to see up-to-date stock information.';var displayBookSlotPromptPopup=false;Backbone.Webshop.TrolleyRouter=Backbone.Router.extend({initialize:function(){this.initTrolley();this.initBookSlotPrompt();displayBookSlotPromptPopup=getConfigProperty('DISPLAY_BOOK_SLOT_PROMPT_POPUP')==='true';},initTrolley:function(){var trolleyView=new Backbone.Webshop.trolley.TrolleyView();Backbone.Webshop.trolley.openTrolley=function(){trolleyView.open();};},initBookSlotPrompt:function(){if(!Backbone.Webshop.mixins.isFeatureEnabled('CUSTOMER_ACQUISITION_2018')){return;}
var basket=Backbone.Webshop.Basket.getInstance();var BookSlotPromptView=null;basket.on('add:started '+'add:withDirect:url:started '+'suggested:items:add:all:started',function(){if(!basket.get('slotBooking').hasConfirmedSlotBooking&&!Number(basket.get('totalItems'))){showBookSlotPrompt();}});function showBookSlotPrompt(){if(displayBookSlotPromptPopup){if(BookSlotPromptView==null)BookSlotPromptView=new Backbone.Webshop.popup.BookSlotPromptView();BookSlotPromptView.model.show();}else{new Backbone.Webshop.notifications.NotificationView({content:content});}}}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.UlpBannerRouter=Backbone.Marionette.AppRouter.extend({initialize:function(){var $ulpBannerElement=Backbone.$('#ulpBannerSection');if($ulpBannerElement.length){new Backbone.Webshop.ulp.UlpBannerView({el:$ulpBannerElement});}}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.UnavailableItemsRouter=Backbone.Marionette.AppRouter.extend({routes:{"webshop/editOrder.do":"init","webshop/validateSlotChange.do":"init","webshop/validateSlotChangeCheckout.do":"init","webshop/displaySlotDetails.do":"init","webshop/deliveryChargeChangeConfirm.do":"init","webshop/deliveryChargeChangeConfirmCheckout.do":"init"},init:function(){if(Backbone.$('#js-productPageFops-unavailableItems').length){Backbone.Webshop.router.mixin.initializeFopContainer(Backbone.Webshop.fop.FopContainerView,'unavailableItems');var view,buttonsView;if(Backbone.$('.js-alternativesPage--inCheckout').length){view=new Backbone.Webshop.unavailableItems.UnavailableItemsInCheckoutView({el:'.chk-alternativesPage',model:Backbone.Webshop.Basket.getInstance()});}
if(Backbone.$('.js-alternativesPage--inMerge').length){view=new Backbone.Webshop.unavailableItems.UnavailableItemsInOrderEditView({el:'.chk-alternativesPage',model:Backbone.Webshop.Basket.getInstance()});}
if(Backbone.$('.js-alternativesPage--inSlotChange').length){var isInEditOrderSlotChange=!!Backbone.$('.js-fixedAlternatives__buttons--placedOrderSlotChange').length;view=new Backbone.Webshop.unavailableItems.UnavailableItemsInSlotChangeView({el:'.chk-alternativesPage',model:Backbone.Webshop.Basket.getInstance(),isInEditOrderSlotChange:isInEditOrderSlotChange});if(isInEditOrderSlotChange){buttonsView=new Backbone.Webshop.unavailableItems.UnavailableItemsButtonsInOrderEditView({scrollToTopPosition:'84px',isInEditOrderSlotChange:isInEditOrderSlotChange,model:Backbone.Webshop.Basket.getInstance()});view.getRegion('bottomButtons').attachView(buttonsView);}else{buttonsView=new Backbone.Webshop.unavailableItems.UnavailableItemsButtonsInSlotChangeView({scrollToTopPosition:'84px',model:Backbone.Webshop.Basket.getInstance()});view.getRegion('bottomButtons').attachView(buttonsView);}}
if(!Backbone.$('.js-alternativesPage').length){new Backbone.Webshop.unavailableItems.UnavailableItemsContinueCheckoutView({el:'#js-continue-button-region'});new Backbone.Webshop.unavailableItems.UnavailableItemsContinueCheckoutView({el:'#js-continue-button-region-top'});}}
if(Backbone.$('.js-unavailable-items-continue-ocsc').length){new Backbone.Webshop.unavailableItems.UnavailableItemsContinueOcscView({el:'.js-unavailable-items-continue-ocsc'}).render();}
if(Backbone.$(".currentDeliveryDetails").length){var slotDetailsCtrl=new Backbone.Webshop.delivery.SlotDetailsController();slotDetailsCtrl.initSlotDetails();}}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.UnsupportedBrowserRouter=Backbone.Marionette.AppRouter.extend({initialize:function(){Backbone.Webshop.mixins.showUnsupportedBrowserAlert.call(this);}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.VouchersRouter=Backbone.Router.extend({routes:{'webshop/addDiscountFromCheckout.do':'initContinueButtonView','webshop/checkoutAddVouchers.do':'initContinueButtonView','webshop/checkoutRemoveVoucher.do':'initContinueButtonView'},initialize:function(){if(!Backbone.Webshop.mixins.isBetaFeatureEnabled('COW_RWD_QUICK_CHECKOUT')){this.route('webshop/checkoutValidateOrder.do','initContinueButtonView');}},initContinueButtonView:function(){new Backbone.Webshop.cow.CheckoutWalkContinueButtonView({el:'.js-continue-button',model:new Backbone.Webshop.cow.VoucherConfirmationButtonModel()});}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.homepage.HomepageTileController=Backbone.Marionette.Controller.extend({initTiles:function(){initBookDeliveryTile();initOrderStatusTile.call(this);initCustomerMessages();initOrderTabs();}});function initBookDeliveryTile(){if(Backbone.$('.tile.book-delivery').length){var bookDeliveryHomepageTileDateModel=new Backbone.Webshop.homepage.BookDeliveryHomepageTileDateModel({},{tileName:'bookDelivery'});bookDeliveryHomepageTileDateModel.fetch();new Backbone.Webshop.homepage.BookDeliveryHomepageTileView({el:'.tile.book-delivery',model:bookDeliveryHomepageTileDateModel,tileDateModel:bookDeliveryHomepageTileDateModel}).render();new Backbone.Webshop.homepage.DesktopBookDeliveryHomepageView({el:'.js-slot-info',model:bookDeliveryHomepageTileDateModel}).render();}}
function initOrderStatusTile(){if(Backbone.$('.tile.order-status').length){var orderStatusHomepageTileDateModel=new Backbone.Webshop.homepage.HomepageTileDateModel({},{tileName:'orderStatusDate'});var orderStatusHomepageTileModel=new Backbone.Webshop.homepage.OrderStatusHomepageTileModel();var orderStatusHomepageTileView=new Backbone.Webshop.homepage.OrderStatusHomepageTileView({el:'.tile.order-status',model:orderStatusHomepageTileModel,tileDateModel:orderStatusHomepageTileDateModel});new Backbone.Webshop.homepage.DesktopOrderStatusHomepageView({el:'.js-next-delivery',model:orderStatusHomepageTileModel});this.listenTo(orderStatusHomepageTileView,'move:to:edit:order',function(url){this.trigger('move:to:edit:order',url);});this.listenTo(orderStatusHomepageTileView,'move:to:rebook:order',function(url){this.trigger('move:to:rebook:order',url);});orderStatusHomepageTileView.render();orderStatusHomepageTileDateModel.fetch();orderStatusHomepageTileModel.fetch();}}
function initCustomerMessages(){var customerMessagesContainer=Backbone.$('.js-customer-messages-container');if(customerMessagesContainer.length){var customerMessagesContainerView=new Backbone.Webshop.homepage.CustomerMessagesContainerView({el:customerMessagesContainer});Backbone.$('.js-customer-message').each(function(index,customerMessage){var customerMessageView=new Backbone.Webshop.homepage.CustomerMessageTileView({el:customerMessage});customerMessagesContainerView.listenToMessage(customerMessageView);});}}
function initOrderTabs(){if(Backbone.$('.js-order-tabs').length){new Backbone.Webshop.tabbedContent.TabsContainerView({el:'.js-order-tabs'});}}})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.slotBooking.RegularSlotsController=Backbone.Marionette.Controller.extend({initSlotBooking:function(){var $slotsTable=Backbone.$('#slotsTableWrapper');if($slotsTable.length==0){return;}
var $slotsJsonData=Backbone.$("#slotsJsonData");if(!$slotsJsonData||!$slotsJsonData.length){return;}
var $partnerOrdersJsonData=Backbone.$("#partnerOrdersJsonData");if($partnerOrdersJsonData&&$partnerOrdersJsonData.length){var $partnerOrdersObj=JSON.parse($partnerOrdersJsonData.html());var combinePopupModel=new Backbone.Webshop.delivery.CombineOrdersPopupModel($partnerOrdersObj);var combinePopupView=new Backbone.Webshop.delivery.CombineOrdersPopupView({model:combinePopupModel});combinePopupModel.show();}
var $changingSlotData=Backbone.$("#changingSlotData");var isChangingSlot=false;if($changingSlotData&&$changingSlotData.length){isChangingSlot=JSON.parse($changingSlotData.html()).changingSlot;}
else if(window.location.search&&window.location.search.indexOf('from=alternatives')>-1){isChangingSlot=true;}
var modelData=Backbone.Webshop.slotBooking.SlotsSelectorModelTransformer.transform(JSON.parse($slotsJsonData.html()),null,isChangingSlot);var slotsSelectorModel=new Backbone.Webshop.slotBooking.SlotsSelectorModel(modelData);var slotsSelectorView=new Backbone.Webshop.slotBooking.SlotsSelectorView({model:slotsSelectorModel,el:$slotsTable});slotsSelectorView.render();}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.delivery.SlotDetailsController=Backbone.Marionette.Controller.extend({initSlotDetails:function(){var cancelDeliveryPopupModel=new Backbone.Webshop.delivery.CancelDeliveryPopupModel();new Backbone.Webshop.delivery.CancelDeliveryPopupView({model:cancelDeliveryPopupModel});new Backbone.Webshop.delivery.SlotDetailsView({el:'.currentDeliveryDetails',cancelDeliveryPopupModel:cancelDeliveryPopupModel});new Backbone.Webshop.delivery.SlotDetailsCheckoutButton({model:Backbone.Webshop.Basket.getInstance(),el:'#deliveryDetailsCheckoutButton'});if($('#deliveryDetailsCheckoutButtonNewDesign').length){new Backbone.Webshop.delivery.newdesign.SlotDetailsCheckoutButton({model:Backbone.Webshop.Basket.getInstance(),el:'#deliveryDetailsCheckoutButtonNewDesign'});}}});})(Backbone);Backbone.Webshop.router.mixin.hideOverlappingElements=function(PromotionBoxElem){var allPromotedElements=Backbone.$(PromotionBoxElem).find('li:not(.more-products)'),numberOfVisibleItems=findElementsToShow();Backbone.$(allPromotedElements).show().slice(numberOfVisibleItems).hide();showMoreIfNeeded(allPromotedElements.length-numberOfVisibleItems);function findElementsToShow(){Backbone.$(PromotionBoxElem).removeClass('more-space');var maxWidth=allPromotedElements.first().width(),minWidth=allPromotedElements.first().find('img').width()+10,containerWidth=Backbone.$(PromotionBoxElem).width(),containerCapacity=Math.floor((containerWidth-minWidth)/maxWidth)+1;if(allPromotedElements.length>containerCapacity){return containerCapacity-1;}
else{return containerCapacity;}}
function showMoreIfNeeded(numberOfHiddenElements){Backbone.$(PromotionBoxElem).find('.more-products').remove();if(numberOfHiddenElements>0){Backbone.$(PromotionBoxElem).append(Handlebars.templates['deals/more']({number:numberOfHiddenElements}));if(numberOfVisibleItems===1){Backbone.$(PromotionBoxElem).addClass('more-space');}}}};(function(Backbone){"use strict";Backbone.Webshop.router.mixin.initializeAddEverythingButtons=function(){_.each(Backbone.$(".js-addEverything"),function(addEverythingButton){var $button=$(addEverythingButton);new Backbone.Webshop.AddEverythingButton({el:$button,model:new Backbone.Model({url:$button.data('add-everything-url')})});});};})(Backbone);(function(Backbone,webshop){"use strict";Backbone.Webshop.router.mixin.initializeAsyncFopContainer=function(collectionId){initializeAsyncFopContainer(collectionId,false);};Backbone.Webshop.router.mixin.initializeDesktopOnlyAsyncFopContainer=function(collectionId){initializeAsyncFopContainer(collectionId,true);};function initializeAsyncFopContainer(collectionId,desktopBreakpointOnly){var $fopsContainer=Backbone.$(collectionId?'#js-productPageFops-'+collectionId:'#js-productPageFops');var $ajaxParams=$fopsContainer.children('.js-ajaxParams');var uri=$ajaxParams.data('ajax-uri');if(!$fopsContainer.length){return;}
if(!desktopBreakpointOnly||Backbone.Webshop.ViewType.isDesktop()){initializeContainer($fopsContainer,uri,$ajaxParams);}else{Backbone.$(window).one('afterResizeToDesktop',function(){initializeContainer($fopsContainer,uri,$ajaxParams);});}}
function initializeContainer($fopsContainer,uri,$ajaxParams){Backbone.$.ajax({type:'GET',url:uri,data:JSON.parse($ajaxParams.text())}).done(function(data){if(Backbone.$.isEmptyObject(data)){return false;}
var fopContainerModel=new Backbone.Webshop.fop.FopContainerModel({},{fopJsonData:data});fopContainerModel.fetch();$fopsContainer.parents('.you-might-like').show();new Backbone.Webshop.fop.FopContainerView({el:$fopsContainer,model:fopContainerModel}).render().renderAllFops();});}})(Backbone,webshop);(function(Backbone){"use strict";Backbone.Webshop.router.mixin.initializeBannerCarousels=function(){Backbone.$('.js-banner-carousel').each(function(){new Backbone.Webshop.banners.BannerCarouselView({el:this});});};})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.router.mixin.initializeComboDealsFop=function(viewConstructor,modelConstructor){Backbone.Webshop.router.mixin.saveFopContext();var $fopContainersInGroup=Backbone.$(".js-productCarouselFops");initializeContainers(viewConstructor,modelConstructor,$fopContainersInGroup);};function initializeContainers(viewConstructor,modelConstructor,$fopContainersInGroup){initializeContainerFromIndex(viewConstructor,modelConstructor,$fopContainersInGroup,0)();}
function initializeContainerFromIndex(viewConstructor,modelConstructor,$fopContainersInGroup,containerIndex){return function(){if(containerIndex<$fopContainersInGroup.length){var $fopContainer=$fopContainersInGroup.get(containerIndex);var $fopData=Backbone.$($fopContainer).children(".js-productCarouselData");var fopContainerModel=new modelConstructor({},{fopJsonElement:$fopData});fopContainerModel.fetch();new viewConstructor({el:$fopContainer,model:fopContainerModel}).render();_.defer(initializeContainerFromIndex(viewConstructor,modelConstructor,$fopContainersInGroup,containerIndex+1));}}}})(Backbone);(function(Backbone,Handlebars){"use strict";Backbone.Webshop.router.mixin.initializeComboDealLandingPage=function(){Backbone.$('.deal-components-show-more').each(function(){Backbone.Webshop.router.mixin.hideOverlappingElements(this);Backbone.$(window).on('resize',function(){Backbone.Webshop.router.mixin.hideOverlappingElements(this);}.bind(this));});};})(Backbone,Handlebars);(function(Backbone){Backbone.Webshop.router.mixin.initializeDeliveryPassDetails=function(){Backbone.$('select[name=storedCardId]').each(function(index,select){new Backbone.Webshop.payment.CreditCardSelectView({el:select});});}})(Backbone);(function(Backbone){Backbone.Webshop.router.mixin.initializeDisplayDeliveryPass=function(){Backbone.Webshop.router.mixin.initializeFopContainer();initSelectDiscountClubPlanButtonViews();trackSignedUpInDiscountClub();new Backbone.Webshop.discountclub.DiscountClubHeaderView({el:Backbone.$('.discount-club')}).render();};function initSelectDiscountClubPlanButtonViews(){Backbone.$('.btn-wrapper.sign-up').each(function(index,select){new Backbone.Webshop.discountclub.SelectDiscountClubPlanButtonView({el:select});});}
function trackSignedUpInDiscountClub(){var selectedDiscountClubSchemeDTO=webshop.common.jsVariables.get("selectedDiscountClubSchemeDTO");if(!_.isUndefined(selectedDiscountClubSchemeDTO)){new Backbone.Webshop.discountclub.GTMDiscountClubSigningUpEventSender().sendSignedUpEvent(selectedDiscountClubSchemeDTO);}}})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.router.mixin.initializeFopCarousel=function(viewConstructor,modelConstructor){Backbone.Webshop.router.mixin.saveFopContext();var $fopContainersInGroup=Backbone.$(".js-productCarouselFops");enableScrollStopEvent();initializeContainers(viewConstructor,modelConstructor,$fopContainersInGroup);};function enableScrollStopEvent(){$.fn.scrollStopped=function(callback){var that=this,$this=$(that),isScrolling=false,scrollStarted=false;$this.on('scroll',function(ev){function checkIfStopped(){if(!isScrolling){clearInterval(interval);$this.data('scrollTimeout',setTimeout(callback.bind(that),1,ev));scrollStarted=false;isScrolling=false;}
isScrolling=false;}
if(!scrollStarted){var interval=setInterval(checkIfStopped,100);scrollStarted=true;}
isScrolling=true});};}
function initializeContainers(viewConstructor,modelConstructor,$fopContainersInGroup){initializeContainerFromIndex(viewConstructor,modelConstructor,$fopContainersInGroup,0)();}
function initializeContainerFromIndex(viewConstructor,modelConstructor,$fopContainersInGroup,containerIndex){return function(){if(containerIndex<$fopContainersInGroup.length){var $fopContainer=$fopContainersInGroup.get(containerIndex);var $fopData=Backbone.$($fopContainer).children(".js-productCarouselData");var fopContainerModel=new modelConstructor({},{fopJsonElement:$fopData});fopContainerModel.fetch();new viewConstructor({el:$fopContainer,model:fopContainerModel}).render();_.defer(initializeContainerFromIndex(viewConstructor,modelConstructor,$fopContainersInGroup,containerIndex+1));}}}})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.router.mixin.initializeFopContainer=function(viewConstructor,collectionId,fopContext,skipSortByView){if(viewConstructor===undefined){viewConstructor=Backbone.Webshop.fop.FopContainerView;}
Backbone.Webshop.router.mixin.saveFopContext(fopContext);var $fopsContainer=Backbone.$(collectionId?"#js-productPageFops-"+collectionId:"#js-productPageFops");var $fopData=$fopsContainer.children(".js-productPageJson");if($fopsContainer.length){var fopContainerModel=new Backbone.Webshop.fop.FopContainerModel({},{fopJsonElement:$fopData});fopContainerModel.fetch().always(function(){new viewConstructor({el:$fopsContainer,model:fopContainerModel}).render();if(!skipSortByView){new Backbone.Webshop.sortby.SortByView();}
Backbone.Webshop.mixins.sendOOSEventIfPresent();});}};})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.router.mixin.initializeImportFavouritesButton=function(){Backbone.$('.js-importFavourites').each(function(){new Backbone.Webshop.favourites.ImportButtonView({el:this});});}})(Backbone);(function(Backbone,_){"use strict";Backbone.Webshop.router.mixin.initializeOffersContainer=function(scroll,indexOfClicked,wasComplete){if(Modernizr.csspositionsticky){setTopAttributeForComboPromoBanner();}
if(Backbone.$('.combo-deal-summary-wrapper').length===0){return;}
var fopsGroups=Backbone.$('.combo-deal-category'),numberOfElementsInSlot=Backbone.$('.combo-promotions-slot > li').length,elementWidth=getPromotionSummaryElementWidth(),comboDealSummaryWrapperElement=Backbone.$('.combo-deal-summary-wrapper'),comboDealSummaryElement=Backbone.$('.combo-deal-summary'),comboDealSummaryWrapperHeight=Backbone.$('.combo-promotions-slot').height(),animationTime=600,elemOffset=10,waypoint,scrollWatchActive=true;setPromotionSummaryWidth(numberOfElementsInSlot,elementWidth);addClassesToRelevantElements(indexOfClicked,wasComplete);bindElementsInComboSummaryToProductCategories();if(!Modernizr.csspositionsticky){makePromotionsSummarySticky();}
enableVerticalScrollEventsAffectPromotionSummary();emphasizeBorderPromotionSummaryElementWhileScrolledToPageBounduaries();function recalculatePromotionSummary(){waypoint.destroy();if(!Modernizr.csspositionsticky){makePromotionsSummarySticky();}
setTimeout(function(){elementWidth=getPromotionSummaryElementWidth();comboDealSummaryWrapperHeight=Backbone.$('.combo-promotions-slot').height();Backbone.$('.combo-deal-summary, .carousel-wrapper, .combo-promotions-slot').attr('style','');setPromotionSummaryWidth(numberOfElementsInSlot,elementWidth);},animationTime);};$(window).on('resizedToMobile resizedToDesktop',function(){Backbone.$('body, html').animate({scrollTop:0},animationTime);});function makePromotionsSummarySticky(){var headerElement=Backbone.$('#header'),offset=headerElement.height()+parseInt(headerElement.css('top'),10);waypoint=new Waypoint({element:Backbone.$('.waypointsTrace')[0],offset:(offset+10)+'px',handler:function(direction){if(direction=='down'&&!Backbone.Webshop.ViewType.isShortDesktop()){comboDealSummaryWrapperElement.addClass('sticky');Backbone.$('.waypointsTrace').css('padding-bottom',parseInt(comboDealSummaryWrapperElement.height())-elemOffset+'px');if(!Modernizr.csspositionsticky){comboDealSummaryWrapperElement.css('top',offset+'px');}}
if(direction=='up'&&!Backbone.Webshop.ViewType.isShortDesktop()){comboDealSummaryWrapperElement.removeClass('sticky');Backbone.$('.waypointsTrace').css('padding-bottom','0');comboDealSummaryWrapperElement.css('top','');}}});}
Backbone.$(window).on('resize',recalculatePromotionSummary);Backbone.$(window).on('recalculateAllStickyElements',recalculatePromotionSummary);function enableVerticalScrollEventsAffectPromotionSummary(){for(var i=0,length=fopsGroups.length;i<length;i++){new Waypoint({element:fopsGroups[i],group:i,offset:Backbone.$('#header').height()+parseInt(comboDealSummaryWrapperElement.height())+70+'px',handler:function(direction){if(direction=='down'&&scrollWatchActive==true){emphasizeActiveCategory(this.group.name);}}});new Waypoint({element:fopsGroups[i],group:i,offset:'60%',handler:function(direction){if(direction=='up'&&scrollWatchActive==true){emphasizeActiveCategory(this.group.name-1);}}});}
function currentIndex(){return Backbone.$('.combo-promotions-slot li').index(Backbone.$('.activeCategory'));}}
function emphasizeBorderPromotionSummaryElementWhileScrolledToPageBounduaries(){window.onscroll=function(ev){if((window.innerHeight+window.scrollY)>=$("html").prop("scrollHeight")){moveBackgroundElementInComboSummary(parseInt(numberOfElementsInSlot-1));}
if((window.scrollY)==0){moveBackgroundElementInComboSummary(0);}};}
function emphasizeActiveCategory(categoryIndex){function inSlotIndex(categoryIndex){var selector="[data-id='"+Backbone.$(Backbone.$('.combo-deal-category')[categoryIndex]).attr('data-group-id')+"']";return Backbone.$('.combo-promotions-slot li').index($(selector).parent());}
Backbone.$(fopsGroups[categoryIndex-1]).addClass('showMe').siblings().removeClass('showMe');moveBackgroundElementInComboSummary(inSlotIndex(categoryIndex));}
function getPromotionSummaryElementWidth(){Backbone.$('.combo-promotions-slot').width(500);return Backbone.$('.combo-promotions-slot > li:eq(1)').position().left;}
function setPromotionSummaryWidth(numberOfElementsInSlot,elementWidth){var carouselsOffset=20,marginWidth=10,comboSummaryPadding=15;Backbone.$('.combo-promotions-slot').width(numberOfElementsInSlot*(elementWidth+marginWidth)-carouselsOffset);if(numberOfElementsInSlot*elementWidth<window.innerWidth){comboDealSummaryElement.width(numberOfElementsInSlot*(elementWidth+marginWidth)-carouselsOffset+comboSummaryPadding);Backbone.$('.validTill').removeClass('fullWidth');}else{comboDealSummaryElement.width(window.innerWidth-marginWidth);Backbone.$('.validTill').addClass('fullWidth');}}
function bindElementsInComboSummaryToProductCategories(){var uniqueIndex=0;Backbone.$('.combo-promotions-slot figure').map(function(){if(typeof(fopsGroups[$(this).attr('data-id')])==='undefined')
uniqueIndex++;fopsGroups[$(this).attr('data-id')]=uniqueIndex;(function(index,el){Backbone.$(el).parents('li').on('click',function(){Backbone.$(fopsGroups[index-1]).addClass('showMe').siblings().removeClass('showMe');moveBackgroundElementInComboSummary(Backbone.$('.combo-promotions-slot > li').index(this));scrollVerticallyToProductGroup();});})(uniqueIndex,this);});function scrollVerticallyToProductGroup(){var offset=20,scrollPosition=Backbone.$('.showMe').offset().top-parseInt(Backbone.$('.main').css('margin-top'))-parseInt(Backbone.$('.main').css('padding-top'))-comboDealSummaryWrapperHeight-parseInt(comboDealSummaryElement.css('margin-bottom'));Waypoint.disableAll();waypoint.enable();Backbone.$('body, html').animate({scrollTop:scrollPosition-offset},animationTime,function(){Waypoint.enableAll();});}}
function addClassesToRelevantElements(indexOfClicked,wasComplete){if(wasComplete)
comboDealSummaryElement.addClass('no-animation');else
comboDealSummaryElement.removeClass('no-animation');scrollWatchActive=false;if(indexOfClicked){Backbone.$('.combo-deal-category').eq(indexOfClicked).addClass('showMe');moveBackgroundElementInComboSummary(indexOfClicked);}else{Backbone.$('.combo-deal-category:first').addClass('showMe');moveBackgroundElementInComboSummary(0)}
setTimeout(function(){scrollWatchActive=true;},1000);}
function moveBackgroundElementInComboSummary(inSlotIndex){var catId=Backbone.$('.combo-promotions-slot li').eq(inSlotIndex).find('figure').attr('data-id'),elementsOfCategory=Backbone.$('figure[data-id='+catId+']'),categoryFirstIngroupPosition=elementsOfCategory.first().parent().position().left,elementOffset=20,easingTime=animationTime,leftAdjust;if(!scrollWatchActive){easingTime=0;}
comboDealSummaryElement.find('.carousel-wrapper').css('overflow','hidden');comboDealSummaryElement.find('.carousel-wrapper').animate({scrollLeft:inSlotIndex*(elementWidth+10)},easingTime,function(){setTimeout(function(){comboDealSummaryElement.find('.carousel-wrapper').css('overflow','')},700);});if(categoryFirstIngroupPosition<30){elementOffset=0;leftAdjust=10;}else{leftAdjust=0;}
elementsOfCategory.first().parent().removeClass('activeCategory').siblings().removeClass('activeCategory');elementsOfCategory.each(function(){Backbone.$(this).parent().addClass('activeCategory');});}
function setTopAttributeForComboPromoBanner(){if(!Modernizr.csspositionsticky){var promoWrapperElement=Backbone.$('#content > .promo-wrapper');var positionOfDealSection=promoWrapperElement.find('.combo-deal-summary-wrapper').position().top+Backbone.$('.crumb-trail-desktop').height();var menuBottom=Backbone.$('#header').offset().top+Backbone.$('#header').height();promoWrapperElement.css('top',menuBottom-positionOfDealSection);}}};})(Backbone,_);(function(Backbone){"use strict";Backbone.Webshop.router.mixin.initializePromotedBoxCarousel=function(){var $promoBoxesContainer=Backbone.$('.js-productCarouselBoxes');initializeContainer($promoBoxesContainer);};function initializeContainer($promoBoxesContainer){new Backbone.Webshop.promobox.PromotedBoxContainerView({el:$promoBoxesContainer}).render();}})(Backbone);(function(Backbone,_){"use strict";Backbone.Webshop.router.mixin.initializePromotedBoxes=function(){Backbone.$('.js-promoted-box').each(function(index,$promotedBox){initializePromotedBox($promotedBox);})};function initializePromotedBox($promotedBox){new Backbone.Webshop.promobox.PromotedBoxView({el:$promotedBox});}})(Backbone,_);(function(Backbone){'use strict';Backbone.Webshop.router.mixin.initializeRecipeImageAndVideoPopup=function(){var $enlargeImageButton=Backbone.$('.js-carousel-wrapper');if($enlargeImageButton.length>0){new Backbone.Webshop.recipes.EnlargeImageView({el:$enlargeImageButton});}}})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.router.mixin.initializeReviews=function(){var reviews=Backbone.$('.js-reviews');if(!reviews.length){return;}
var recipeId=reviews.data('recipe-id');initializeReviewCollection(recipeId);initializeSummary(recipeId);};function initializeReviewCollection(recipeId){var reviewCollection=new Backbone.Webshop.reviews.ReviewCollection({id:recipeId});reviewCollection.fetch();new Backbone.Webshop.reviews.ReviewCollectionView({el:'.js-reviewsDetails',collection:reviewCollection}).render();}
function initializeSummary(recipeId){var summaryModel=new Backbone.Webshop.reviews.ReviewSummaryModel({id:recipeId});summaryModel.fetch().then(function(data){if(_.isEmpty(data)){new Backbone.Webshop.reviews.FirstTimeReviewButtonView({el:'.js-reviewSummary',model:summaryModel}).render();}else{new Backbone.Webshop.reviews.ReviewSummaryView({el:'.js-reviewSummary',model:summaryModel}).render();}
var $writeReviewButton=Backbone.$(".js-writeReview");if($writeReviewButton.length>0){new Backbone.Webshop.reviews.ReviewButtonView({el:$writeReviewButton,uri:$writeReviewButton.data('href')});}});}})(Backbone);(function(Backbone){Backbone.Webshop.router.mixin.initializeSwitchAndSave=function(){if(Backbone.$('#js-productPageFops-switchAndSaveItems').length>0){var itemsToHideCollection=new Backbone.Webshop.SwitchAndSaveItemsToHideCollection();var fopContainerView=Backbone.Webshop.fop.FopContainerView.extend({childEvents:{'toggleHide:swap':function(childView,swapProposal){itemsToHideCollection.update(swapProposal);}}});Backbone.Webshop.router.mixin.initializeFopContainer(fopContainerView,"switchAndSaveItems");new Backbone.Webshop.cow.CheckoutWalkSwitchAndSaveContinueButtonView({el:'.js-continue-button',model:new Backbone.Webshop.cow.CheckoutWalkContinueButtonModel(),itemsToHideCollection:itemsToHideCollection});return true;}
return false;}})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.router.mixin.initializeWineFinder=function(){var $wineFinderContainer=Backbone.$('#js-wineFinder');var $wineFinderData=$wineFinderContainer.children('.js-wineFinderJson');if($wineFinderContainer.length){var wineFinderDto=JSON.parse($wineFinderData.text());var wineFinderModel=new Backbone.Webshop.wineFinder.WineFinderModel(wineFinderDto);new Backbone.Webshop.wineFinder.WineFinderView({el:$wineFinderContainer,model:wineFinderModel}).render();}};})(Backbone);(function(Backbone,_){"use strict";var dealWrapperElement=Backbone.$('.bundle-deal-wrapper'),elementWidth=minElementWidth(dealWrapperElement.find('ul > li:eq(1)')),marginRight=10,dealWrapperElements=dealWrapperElement.find('ul > li'),comboPromotionSlot=Backbone.$('.combo-promotions-slot'),summary=Backbone.$('.combo-deal-summary');Backbone.Webshop.router.mixin.makeComboDetailsSticky=function(){if(Modernizr.csspositionsticky){setTopAttributeForPromoBanner();}
if(dealWrapperElement.length===0){return;}
setPromoSlotWidth(dealWrapperElements,comboPromotionSlot,summary);if(!Modernizr.csspositionsticky){setWaypoint();}
$(window).on('resize recalculateAllStickyElements',function(){setPromoSlotWidth(dealWrapperElements,comboPromotionSlot,summary);Waypoint.destroyAll();if(!Modernizr.csspositionsticky){resetStickiness();setWaypoint();}else{setTopAttributeForPromoBanner();}});};function minElementWidth(bundleDealWrapperEl){if(bundleDealWrapperEl.length)
return bundleDealWrapperEl.position().left-bundleDealWrapperEl.prev().position().left;else
return 0;}
function setTopAttributeForPromoBanner(){if(Backbone.$('.bundle-deal-wrapper').length){var positionOfDealSection=Backbone.$('.bundle-deal-wrapper').position().top;var menuBottom=Backbone.$('#header').offset().top+Backbone.$('#header').height();if(!Modernizr.csspositionsticky){Backbone.$('.promo-wrapper').css('top',menuBottom-positionOfDealSection);}}}
function setPromoSlotWidth(elementsInWrapper,comboPromotionSlotElement,comboDealSummaryElement){var numberOfSlots=elementsInWrapper.length,elementMargin=elementWidth-elementsInWrapper.first().width();function setPromotionSlotWidth(numberOfElementsInSlot,elementWidth){if(numberOfElementsInSlot*(elementWidth+marginRight)<window.innerWidth){dealWrapperElement.width(numberOfElementsInSlot*(elementWidth+elementMargin));comboPromotionSlotElement.parent().width(numberOfElementsInSlot*(elementWidth+elementMargin));comboDealSummaryElement.width(numberOfElementsInSlot*(elementWidth+marginRight));}else{dealWrapperElement.width('');comboPromotionSlotElement.parent().width('');comboDealSummaryElement.width('');}
Backbone.Webshop.router.mixin.hideOverlappingElements('.deal-components-show-more');}
if(dealWrapperElement.length>0&&elementWidth>0){setPromotionSlotWidth(numberOfSlots,elementWidth);}}
function resetStickiness(){dealWrapperElement.css('padding-bottom','');dealWrapperElement.find('.deal').removeClass('sticky').css('width','');dealWrapperElement.removeClass('slide-in');if(!Modernizr.csspositionsticky){dealWrapperElement.find('.deal').css('top','');}
Backbone.$('.main').css('height','');}
function setWaypoint(){var headerElement=Backbone.$('#header'),offset=headerElement.height()+13+parseInt(headerElement.css('top'),10)+'px';if(Backbone.$('.bundle-deal-wrapper').length>0&&!Backbone.Webshop.ViewType.isShortDesktop()){new Waypoint({element:Backbone.$('.bundle-deal-wrapper')[0],offset:offset,handler:function(direction){if(direction=='down'){Backbone.$('.main').css('height',$('.main').height());dealWrapperElement.css('padding-bottom',parseInt(dealWrapperElement.height()-dealWrapperElement.find('.deal-link').height()-30)+'px');dealWrapperElement.find('.deal').addClass('sticky');dealWrapperElement.find('.deal').css('top',offset);dealWrapperElement.addClass('slide-in');}
if(direction=='up'){resetStickiness();}}});}}})(Backbone,_);(function(Backbone,_){"use strict";Backbone.Webshop.router.mixin.saveFopContext=function(fopContext){var fullFopContext=fopContext||{};if(!fullFopContext.pageType){fullFopContext.pageType=webshop.common.jsVariables.get('pageType');}
Backbone.Wreqr.radio.channel('gtm').reqres.setHandler("fopContext",_.constant(fullFopContext));}})(Backbone,_);webshop.analytics=webshop.analytics||{};webshop.analytics.resolution={init:function(){Backbone.Webshop.analytics.mixin.reportResolution();Backbone.Webshop.analytics.mixin.attachResizeHandler();}};(function(webshop){webshop.analytics=webshop.analytics||{};webshop.analytics.header={ui:{topTabItem:'#siteTabs a.hd-topTabs__link',browseMenu:{dropdown:'.browseShop',item:'li > a',},tileDropdown:{container:'.tilesDropdown',navItem:'a.section-link',banner:'a.imgLink',button:'a.button'},seasonalDropdown:{container:'.eventsOverlay',banner:'a.imgLink',button:'a.button'},checkoutBtn:'#basketCheckoutLinkEnabled > a',},init:function(){this._registerEventHandlers();},_trackClickEvent:function(event,url,description,fields){var shouldNavigate=false;var timeoutId=null;if(!event.isDefaultPrevented()){event.preventDefault();shouldNavigate=true;timeoutId=window.setTimeout(function(){window.location=url;},1000);}
Backbone.Webshop.analytics.WebshopAnalytics.reportPageEvent(description,fields).always(function(){if(shouldNavigate){window.clearTimeout(timeoutId);window.location=url;}});},_registerEventHandlers:function(){this._reportBrowseAnalytics();this._reportTopTabsAnalytics();this._reportEventsDropdownAnalytics();this._reportTileDropdownAnalytics();this._reportCheckoutClick();},_reportTopTabsAnalytics:function(){var self=this;jQ(this.ui.topTabItem).on('click',function(event){var currentElement=event.currentTarget;var fields={LINK:jQ(currentElement).attr('href'),TAG:jQ(currentElement).parent().data('name')};if(_.isEmpty(fields.LINK)){return;}
self._trackClickEvent(event,fields.LINK,'Top tab clicked',fields);});},_reportBrowseAnalytics:function(){var self=this;jQ(this.ui.browseMenu.dropdown).on('click',this.ui.browseMenu.item,function(event){var currentElement=event.currentTarget;var url=jQ(currentElement).attr('href');var parentNav=jQ(currentElement).parents('.nav');var level=['baseLevel','levelOne','levelTwo'].findIndex(function(cls){return parentNav.hasClass(cls);});if(_.isEmpty(url)){return;}
self._trackClickEvent(event,url,'Browse shop dropdown clicked',{LEVEL:level,TAG:jQ(currentElement).parent().data('option')||jQ(currentElement).text()});});},_reportTileDropdownAnalytics:function(){var self=this;var clickHandler=function(description){return function(event){var target=jQ(event.currentTarget);var url=target.attr('href');var img=target.find('img');var container=jQ(target).parents(self.ui.tileDropdown.container);self._trackClickEvent(event,url,description,{DROPDOWN_LABEL:container.data('title'),TEXT:img.length>0?img.attr('alt'):target.text(),LINK:url,});};};jQ(this.ui.tileDropdown.container).on('click',this.ui.tileDropdown.navItem,clickHandler('Tiles dropdown navigation item clicked'));jQ(this.ui.tileDropdown.container).on('click',this.ui.tileDropdown.banner,clickHandler('Tiles dropdown banner clicked'));jQ(this.ui.tileDropdown.container).on('click',this.ui.tileDropdown.button,clickHandler('Tiles dropdown bottom button clicked'));},_reportEventsDropdownAnalytics:function(){var self=this;var container=jQ(this.ui.seasonalDropdown.container);var clickHandler=function(event){var url=jQ(event.currentTarget).attr('href');self._trackClickEvent(event,url,'Seasonal banner clicked',{LINK:url});};container.get().forEach(function(element){if(!element.classList.contains('tilesDropdown')){jQ(element).on('click',self.ui.seasonalDropdown.button,clickHandler);jQ(element).on('click',self.ui.seasonalDropdown.banner,clickHandler);}});},_reportCheckoutClick:function(){var self=this;jQ(this.ui.checkoutBtn).on('click',function(event){var currentElement=event.currentTarget;var url=jQ(currentElement).attr('href');var fields={BUTTON_LOC:'DESKTOP_HEADER',};if(_.isEmpty(url)){return;}
self._trackClickEvent(event,url,'Checkout button clicked',fields);});}};}(webshop,jQ));(function(Backbone,_){'use strict';Backbone.Webshop.analytics.resource.PageViewEmbeddedResource=Backbone.Marionette.Object.extend({url:function(){var resourceUrl=_.result(this,'resourceUrl')||noResourceUrlDefined();return'/webshop/wa'+resourceUrl;},initialize:function(){this.pageViewHolder=Backbone.Webshop.analytics.resource.PageViewHolder.getInstance();},saveIfTrackingEnabled:function(dataOrDataSupplier){if(!isTrackingEnabled.call(this)){return;}
var data=_.isFunction(dataOrDataSupplier)?dataOrDataSupplier():dataOrDataSupplier;return Backbone.$.ajax({ajax:true,type:'POST',contentType:'application/json',url:this.url(),data:JSON.stringify(_.assign(data,{pageViewId:this.pageViewHolder.getPageViewId()}))});}});function isTrackingEnabled(){return!_.isUndefined(this.pageViewHolder.getPageViewId());}
function noResourceUrlDefined(){throw new Error('A "resourceUrl" property must be specified.');}})(Backbone,_);(function(Backbone){'use strict';var instance;var PageComponentsResource=Backbone.Webshop.analytics.resource.PageViewEmbeddedResource.extend({resourceUrl:'/pc/'});Backbone.Webshop.analytics.resource.PageComponentsResource={getInstance:function(){if(instance===undefined){instance=new PageComponentsResource();}
return instance;}};})(Backbone);(function(Backbone){'use strict';var instance;var PageEventsResource=Backbone.Webshop.analytics.resource.PageViewEmbeddedResource.extend({resourceUrl:'/pe/'});Backbone.Webshop.analytics.resource.PageEventsResource={getInstance:function(){if(instance===undefined){instance=new PageEventsResource();}
return instance;}};})(Backbone);(function(Backbone){'use strict';var instance;var PageStatisticsResource=Backbone.Webshop.analytics.resource.PageViewEmbeddedResource.extend({resourceUrl:'/ps/'});Backbone.Webshop.analytics.resource.PageStatisticsResource={getInstance:function(){if(instance===undefined){instance=new PageStatisticsResource();}
return instance;}};})(Backbone);(function(Backbone){'use strict';var PageViewHolder=Backbone.Marionette.Object.extend({initialize:function(){this.pageViewId=webshop.common.jsTopBodyVariables.pageViewId;},setPageViewId:function(pageViewId){this.pageViewId=pageViewId;},getPageViewId:function(){return this.pageViewId;}});Backbone.Webshop.analytics.resource.PageViewHolder={getInstance:_.once(function(){return new PageViewHolder();})};})(Backbone);(function(Backbone){'use strict';var PageViewResource=Backbone.Marionette.Object.extend({requestNewPageView:function(pageType,previousPath){if(!Backbone.Webshop.mixins.isBetaFeatureEnabled("ANALYTICS")){return Backbone.$.Deferred().reject();}
return Backbone.$.ajax({ajax:true,type:'POST',contentType:'application/json',url:"/webshop/wa/pv/",data:JSON.stringify({pageType:pageType,previousPath:_.isEmpty(previousPath)?undefined:previousPath})});}});Backbone.Webshop.analytics.resource.PageViewResource={getInstance:_.once(function(){return new PageViewResource();})};})(Backbone);(function(Backbone,_){'use strict';Backbone.Webshop.analytics.WebshopAnalytics={generateNewPageView:function(pageType,previousPath){var pageViewHolder=Backbone.Webshop.analytics.resource.PageViewHolder.getInstance();return Backbone.Webshop.analytics.resource.PageViewResource.getInstance().requestNewPageView(pageType,previousPath).done(function(generatedPageView){pageViewHolder.setPageViewId(generatedPageView.id);Backbone.Webshop.analytics.mixin.reportResolution();}).fail(function(){pageViewHolder.setPageViewId(undefined);});},reportPageComponents:function(pageComponentsDataOrSupplier){return Backbone.Webshop.analytics.resource.PageComponentsResource.getInstance().saveIfTrackingEnabled(pageComponentsDataOrSupplier);},reportPageStatistics:function(pageStatistics){var pageStatisticsDto={fields:pageStatistics};return Backbone.Webshop.analytics.resource.PageStatisticsResource.getInstance().saveIfTrackingEnabled(pageStatisticsDto);},reportPageEvent:function(description,fields){var pageEventDto={description:description,fields:fields};return Backbone.Webshop.analytics.resource.PageEventsResource.getInstance().saveIfTrackingEnabled({pageEvents:[pageEventDto]});},reportPageEventOfType:function(eventType,fields){var pageEventDto={type:eventType,fields:fields};return Backbone.Webshop.analytics.resource.PageEventsResource.getInstance().saveIfTrackingEnabled({pageEvents:[pageEventDto]});},reportFormValidationErrors:function(errors,type){if(Object.keys(errors).length==0){return;}
return Backbone.Webshop.analytics.resource.PageEventsResource.getInstance().saveIfTrackingEnabled({type:type,description:"",fields:errors});},reportLinkClick:function(event,pageEventParams){var peParams=pageEventParams||event.data||{};var peFields=peParams.fields||[];var url=event.currentTarget.getAttribute('href');if(_.isEmpty(url)){return;}
var shouldNavigate=false;var timeoutId=null;if(!event.isDefaultPrevented()){event.preventDefault();shouldNavigate=true;timeoutId=window.setTimeout(function(){window.location=url;},1000);}
var fields={URL:url};if(peParams.length){for(var i=0,len=peFields.length;i<len;i++){fields[peFields[i].name]=peFields[i].value;}}
Backbone.Webshop.analytics.WebshopAnalytics.reportPageEvent(peParams.description||'Link clicked',fields).always(function(){if(shouldNavigate){window.clearTimeout(timeoutId);window.location=url;}});},};Backbone.$(function(){Backbone.$(document).off('click','a.click-tracking',Backbone.Webshop.analytics.WebshopAnalytics.reportLinkClick);Backbone.$(document).on('click','a.click-tracking',Backbone.Webshop.analytics.WebshopAnalytics.reportLinkClick);});})(Backbone,_);(function(Backbone){"use strict";Backbone.Webshop.analytics.mixin.attachResizeHandler=function(){var windowWidth=window.innerWidth;Backbone.$(window).on('resize',_.debounce(function(){if(window.innerWidth==windowWidth){return;}
windowWidth=window.innerWidth;var windowSize={VIEWPORT_HEIGHT:window.innerHeight,VIEWPORT_WIDTH:window.innerWidth};Backbone.Webshop.analytics.WebshopAnalytics.reportPageEvent("Window resize",windowSize);},1000));};})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.analytics.mixin.getPageViewId=function(){return webshop.common.jsTopBodyVariables.pageViewId||webshop.common.jsVariables.get('pageViewId')||'';}})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.analytics.mixin.reportResolution=function(){var devicePixelRatio=window.devicePixelRatio||1;var pageStatistics={DEVICE_PIXEL_RATIO:devicePixelRatio,SCREEN_HEIGHT:screen.height,SCREEN_WIDTH:screen.width,VIEWPORT_HEIGHT:window.innerHeight,VIEWPORT_WIDTH:window.innerWidth};Backbone.Webshop.analytics.WebshopAnalytics.reportPageStatistics(pageStatistics);};})(Backbone);(function(Modernizr){'use strict';Backbone.Webshop.ViewType={isDesktop:function(){return Modernizr.mq('(min-width: 1024px)');},isMobile:function(){return!Modernizr.mq('(min-width: 1024px)');},isMobileVertical:function(){return Modernizr.mq('(max-width: 479px)');},isShortDesktop:function(){return Modernizr.mq('(max-height: 650px)')&&this.isDesktop();}}})(Modernizr);(function(Backbone){'use strict';var PageViewHolder=Backbone.Marionette.Object.extend({initialize:function(){this.pageViewId=webshop.common.jsTopBodyVariables.pageViewId;},setPageViewId:function(pageViewId){this.pageViewId=pageViewId;},getPageViewId:function(){return this.pageViewId;}});Backbone.Webshop.analytics.resource.PageViewHolder={getInstance:_.once(function(){return new PageViewHolder();})};})(Backbone);(function(Backbone){'use strict';var PageViewResource=Backbone.Marionette.Object.extend({requestNewPageView:function(pageType,previousPath){if(!Backbone.Webshop.mixins.isBetaFeatureEnabled("ANALYTICS")){return Backbone.$.Deferred().reject();}
return Backbone.$.ajax({ajax:true,type:'POST',contentType:'application/json',url:"/webshop/wa/pv/",data:JSON.stringify({pageType:pageType,previousPath:_.isEmpty(previousPath)?undefined:previousPath})});}});Backbone.Webshop.analytics.resource.PageViewResource={getInstance:_.once(function(){return new PageViewResource();})};})(Backbone);(function(Backbone,_){'use strict';Backbone.Webshop.analytics.resource.PageViewEmbeddedResource=Backbone.Marionette.Object.extend({url:function(){var resourceUrl=_.result(this,'resourceUrl')||noResourceUrlDefined();return'/webshop/wa'+resourceUrl;},initialize:function(){this.pageViewHolder=Backbone.Webshop.analytics.resource.PageViewHolder.getInstance();},saveIfTrackingEnabled:function(dataOrDataSupplier){if(!isTrackingEnabled.call(this)){return;}
var data=_.isFunction(dataOrDataSupplier)?dataOrDataSupplier():dataOrDataSupplier;return Backbone.$.ajax({ajax:true,type:'POST',contentType:'application/json',url:this.url(),data:JSON.stringify(_.assign(data,{pageViewId:this.pageViewHolder.getPageViewId()}))});}});function isTrackingEnabled(){return!_.isUndefined(this.pageViewHolder.getPageViewId());}
function noResourceUrlDefined(){throw new Error('A "resourceUrl" property must be specified.');}})(Backbone,_);(function(Backbone){'use strict';var instance;var PageComponentsResource=Backbone.Webshop.analytics.resource.PageViewEmbeddedResource.extend({resourceUrl:'/pc/'});Backbone.Webshop.analytics.resource.PageComponentsResource={getInstance:function(){if(instance===undefined){instance=new PageComponentsResource();}
return instance;}};})(Backbone);(function(Backbone){'use strict';var instance;var PageEventsResource=Backbone.Webshop.analytics.resource.PageViewEmbeddedResource.extend({resourceUrl:'/pe/'});Backbone.Webshop.analytics.resource.PageEventsResource={getInstance:function(){if(instance===undefined){instance=new PageEventsResource();}
return instance;}};})(Backbone);(function(Backbone){'use strict';var instance;var PageStatisticsResource=Backbone.Webshop.analytics.resource.PageViewEmbeddedResource.extend({resourceUrl:'/ps/'});Backbone.Webshop.analytics.resource.PageStatisticsResource={getInstance:function(){if(instance===undefined){instance=new PageStatisticsResource();}
return instance;}};})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.analytics.mixin.attachResizeHandler=function(){var windowWidth=window.innerWidth;Backbone.$(window).on('resize',_.debounce(function(){if(window.innerWidth==windowWidth){return;}
windowWidth=window.innerWidth;var windowSize={VIEWPORT_HEIGHT:window.innerHeight,VIEWPORT_WIDTH:window.innerWidth};Backbone.Webshop.analytics.WebshopAnalytics.reportPageEvent("Window resize",windowSize);},1000));};})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.analytics.mixin.reportResolution=function(){var devicePixelRatio=window.devicePixelRatio||1;var pageStatistics={DEVICE_PIXEL_RATIO:devicePixelRatio,SCREEN_HEIGHT:screen.height,SCREEN_WIDTH:screen.width,VIEWPORT_HEIGHT:window.innerHeight,VIEWPORT_WIDTH:window.innerWidth};Backbone.Webshop.analytics.WebshopAnalytics.reportPageStatistics(pageStatistics);};})(Backbone);(function(Backbone,_){'use strict';Backbone.Webshop.analytics.WebshopAnalytics={generateNewPageView:function(pageType,previousPath){var pageViewHolder=Backbone.Webshop.analytics.resource.PageViewHolder.getInstance();return Backbone.Webshop.analytics.resource.PageViewResource.getInstance().requestNewPageView(pageType,previousPath).done(function(generatedPageView){pageViewHolder.setPageViewId(generatedPageView.id);Backbone.Webshop.analytics.mixin.reportResolution();}).fail(function(){pageViewHolder.setPageViewId(undefined);});},reportPageComponents:function(pageComponentsDataOrSupplier){return Backbone.Webshop.analytics.resource.PageComponentsResource.getInstance().saveIfTrackingEnabled(pageComponentsDataOrSupplier);},reportPageStatistics:function(pageStatistics){var pageStatisticsDto={fields:pageStatistics};return Backbone.Webshop.analytics.resource.PageStatisticsResource.getInstance().saveIfTrackingEnabled(pageStatisticsDto);},reportPageEvent:function(description,fields){var pageEventDto={description:description,fields:fields};return Backbone.Webshop.analytics.resource.PageEventsResource.getInstance().saveIfTrackingEnabled({pageEvents:[pageEventDto]});},reportPageEventOfType:function(eventType,fields){var pageEventDto={type:eventType,fields:fields};return Backbone.Webshop.analytics.resource.PageEventsResource.getInstance().saveIfTrackingEnabled({pageEvents:[pageEventDto]});},reportFormValidationErrors:function(errors,type){if(Object.keys(errors).length==0){return;}
return Backbone.Webshop.analytics.resource.PageEventsResource.getInstance().saveIfTrackingEnabled({type:type,description:"",fields:errors});},reportLinkClick:function(event,pageEventParams){var peParams=pageEventParams||event.data||{};var peFields=peParams.fields||[];var url=event.currentTarget.getAttribute('href');if(_.isEmpty(url)){return;}
var shouldNavigate=false;var timeoutId=null;if(!event.isDefaultPrevented()){event.preventDefault();shouldNavigate=true;timeoutId=window.setTimeout(function(){window.location=url;},1000);}
var fields={URL:url};if(peParams.length){for(var i=0,len=peFields.length;i<len;i++){fields[peFields[i].name]=peFields[i].value;}}
Backbone.Webshop.analytics.WebshopAnalytics.reportPageEvent(peParams.description||'Link clicked',fields).always(function(){if(shouldNavigate){window.clearTimeout(timeoutId);window.location=url;}});},};Backbone.$(function(){Backbone.$(document).off('click','a.click-tracking',Backbone.Webshop.analytics.WebshopAnalytics.reportLinkClick);Backbone.$(document).on('click','a.click-tracking',Backbone.Webshop.analytics.WebshopAnalytics.reportLinkClick);});})(Backbone,_);(function(Backbone,webshop,$){"use strict";Backbone.Webshop=Backbone.Webshop||{};Backbone.Webshop.analytics=Backbone.Webshop.analytics||{};Backbone.Webshop.analytics.ScribeBannerView=Backbone.Marionette.ItemView.extend({template:false,alreadyClicked:false,events:{'click':'triggerGtmEvent'},triggerGtmEvent:function(event){var data=this.$el.data();var url=this.$el.attr('href');if(!data.advDocNo){return;}
var shouldNavigate=false;var timeoutId=null;if(!event.isDefaultPrevented()){event.preventDefault();shouldNavigate=true;timeoutId=window.setTimeout(function(){window.location=url;},1000);}
Backbone.Webshop.analytics.WebshopAnalytics.reportPageEventOfType('AD_CLICK',{FROM_ADVERT_DOC_NO:data.advDocNo,FROM_ADVERT_DOC_VERSION_NO:data.advDocVerNo,FROM_ADVERT_PARENT_DOC_NO:data.advParentDocNo,FROM_ADVERT_PARENT_DOC_VERSION_NO:data.advParentDocVerNo,PAGE_COMPONENT_ID:this.$el.find('.analyticsPageComponent').attr('id'),}).always(function(){if(shouldNavigate){window.clearTimeout(timeoutId);window.location=url;}});},});$(document).ready(function(){$('.js-rhs-banner-tracking, .js-graphic-banner-tracking').each(function(index,banner){new Backbone.Webshop.analytics.ScribeBannerView({el:banner});});});})(Backbone,webshop,jQuery);(function(Backbone,$){'use strict';Backbone.Webshop.notifications.NotificationView=Backbone.Marionette.ItemView.extend({events:{'click .js-icon-close':'closeNotification','touchstart .js-icon-close':'closeNotification'},className:'notification-animation',delayAnimation:601,wrapper:getWrapper(),initialize:function(options){this.template=Handlebars.templates['notifications/notifications']({content:options.content,type:options.type||'info'});this.model=new Backbone.Model({displayTimeMillis:options.displayTimeMillis||3000});this.render();this.wrapper.append(this.$el);var actualNotificationsCount=this.wrapper.children().length*this.delayAnimation;this.animateNotification(actualNotificationsCount);var that=this;jQ(document).ready(function(){window.ocBackbone.pubsub.on('notification:force:close',that.closeNotification.bind(that),that);});},closeNotification:function(){var _this=this;this.$el.animate({opacity:0,height:0},300,function(){_this.$el.remove();});},animateNotification:function(actualNotificationsCount){var _this=this;this.$el.delay(actualNotificationsCount).animate({right:'0'},550,function(){setTimeout(_this.closeNotification.bind(_this),_this.model.get('displayTimeMillis'));});}});function getWrapper(){var wrapper=$('#notifications');if(wrapper.length==0){wrapper=$('<div id="notifications" class="notification-wrapper"></div>');if($('#content > .rwd-site').length){$('#content > .rwd-site').append(wrapper);}else{$('#content').append(wrapper);}}
return wrapper;}})(Backbone,jQ);(function(Backbone,_){'use strict';Backbone.Webshop.notifications.debouncedNotification=_.debounce(function(text,isError){new Backbone.Webshop.notifications.NotificationView({content:text,type:isError?'error':'success'});},1000,{'leading':true,'trailing':false});})(Backbone,_);(function(Backbone){'use strict';var TIMEOUT_LENGTH=5500;Backbone.Webshop.mixins.ResponseHandler={isRedirectionWarning:function(response){return response&&(response.redirectionWarning||response.attributes&&response.attributes.redirectionWarning);},buildCollection:function(response){if(response.length>1){this.setCollection(response);}else{this.view.model.set('orderId',response[0].orderId);this.saveOrder(response);}},redirectionHandler:function(response){var text=getMessage('oneclick.responsive.redirectionWarning');new Backbone.Webshop.notifications.NotificationView({content:text,type:'error'});setTimeout(function(){var redirectUrl=response.redirectionWarning||response.attributes.redirectionWarning;return window.location.href=(redirectUrl.match(/^https?:\/\//i))?redirectUrl:'/webshop'+redirectUrl;},TIMEOUT_LENGTH);},errorHandler:function(response){switch(response.status){case 401:case 403:var text=getMessage('oneclick.responsive.errorGeneric');new Backbone.Webshop.notifications.NotificationView({content:text,type:'error'});setTimeout(function(){return window.location="/webshop/login.go";},TIMEOUT_LENGTH);break;default:return window.location="/webshop/error.do";}},successHandler:function(name,dateStart,dateEnd){var text=_.template('${name} ${message} ${dayOfWeek} ${dayDate} ${slotTimeStart} - ${slotTimeEnd}')({name:name,message:getMessage('oneclick.responsive.notificationAddedToOrder'),dayOfWeek:moment(dateStart).format('ddd'),dayDate:moment(dateStart).format('DD/MM/YY'),slotTimeStart:moment(dateStart).format('h:mm A'),slotTimeEnd:moment(dateEnd).format('h:mm A')});new Backbone.Webshop.notifications.NotificationView({content:text,type:'success'});}}})(Backbone);(function(Backbone,_){'use strict';Backbone.Webshop.shoppingLists.AddFromBopModel=ocBackbone.popup.PopupModel.extend({url:'/webshop/webservices/shoppingLists/withoutItems/',defaults:{sku:null,lists:[],display:false},getLists:function(){return this.fetch({data:{checkSku:this.get('sku')}});},parse:function(response){return{lists:Backbone.Webshop.shoppingLists.responseRedirectionHandler(response)};},addItemToList:function(listId){var that=this;var sku=this.get('sku');if(this._listContainsSku(listId)){return new Backbone.$.Deferred().reject('List already contains sku '+sku).promise();}
return Backbone.Webshop.ShoppingListsCollection.getInstance().updateShoppingListItem(listId,sku,{quantity:1,silent:true}).then(Backbone.Webshop.shoppingLists.responseRedirectionHandler).then(function(){var lists=_.cloneDeep(that.get('lists'));var updatedList=lists.find(function(list){return+list.listId===+listId;});if(!updatedList){return new Backbone.$.Deferred().reject('List does not exist').promise();}
updatedList.containsSku=true;that.set('lists',lists);}).done(function(){Backbone.Webshop.notifications.debouncedNotification(getMessage('shoppingLists.success.itemAdded'));}).fail(function(error){console.error(error);Backbone.Webshop.notifications.debouncedNotification(getMessage('shoppingLists.error.general'),true);});},addItemToNewList:function(listName){var that=this;var sku=this.get('sku');Backbone.Webshop.ShoppingListsCollection.getInstance().addNewList(listName,[{sku:sku}]).then(Backbone.Webshop.shoppingLists.responseRedirectionHandler).then(function(response){var lists=_.cloneDeep(that.get('lists'));lists.push({"containsSku":true,"listId":response.id,"listName":listName});that.set('lists',lists);}).done(function(){Backbone.Webshop.notifications.debouncedNotification(getMessage('shoppingLists.success.itemAdded'));}).fail(function(error){console.error(error);});},_listContainsSku:function(listId){var listData=this.get('lists').find(function(list){return+list.listId===+listId;});return listData.containsSku;}});})(Backbone,_);(function(Backbone,webshop){'use strict';Backbone.Webshop.shoppingLists.AddFromBopView=Backbone.Marionette.ItemView.extend({template:Handlebars.templates['shoppinglists/addToListView'],ui:{'showNewListFormBtn':'.js-new-list-btn','listBtn':'.js-sl-list','createNewListForm':'.js-new-list-form','newListNameInput':'.js-new-list-name'},events:{"click @ui.showNewListFormBtn":"showNewListForm","click @ui.listBtn":"addItemToList","submit @ui.createNewListForm":"addItemToNewList"},modelEvents:{"change":"render"},initialize:function(){this.eventTracker=Backbone.Webshop.ShoppingListEventTracker.getInstance();},showNewListForm:function(){this.ui.createNewListForm.toggleClass('hidden');this.ui.showNewListFormBtn.toggleClass('hidden');this.ui.newListNameInput.focus();},addItemToList:function(e){this.model.addItemToList(Backbone.$(e.currentTarget).data('slId'));this.onItemAddedToList();},addItemToNewList:function(e){e.preventDefault();var listName=this.ui.newListNameInput.val().trim();this.model.addItemToNewList(listName);this.onListCreated();this.onItemAddedToNewList();},onListCreated:function(){this.eventTracker.triggerNewListCreated();},onItemAddedToList:function(){this.eventTracker.triggerBopItemAddedToList(this.model.get('sku'));},onItemAddedToNewList:function(){this.eventTracker.triggerBopItemAddedToNewList(this.model.get('sku'));}});})(Backbone,webshop);(function(Backbone,_){'use strict';Backbone.Webshop.shoppingLists.AddFromFopModel=Backbone.Webshop.shoppingLists.AddFromBopModel.extend({});})(Backbone,_);(function(Backbone,webshop){'use strict';Backbone.Webshop.shoppingLists.AddFromFopView=Backbone.Webshop.shoppingLists.AddFromBopView.extend({onItemAddedToList:function(){this.eventTracker.triggerFopItemAddedToList(this.model.get('sku'));},onItemAddedToNewList:function(){this.eventTracker.triggerFopItemAddedToNewList(this.model.get('sku'));}});})(Backbone,webshop);(function(Backbone,_){'use strict';var defaultEventContext={source:'Trolley'};Backbone.Webshop.shoppingLists.AddFromTrolleyModel=ocBackbone.popup.PopupModel.extend({url:'/webshop/webservices/shoppingLists/withoutItems/',defaults:{fromTrolley:true,totalItems:0,skus:[],lists:[],display:false},getLists:function(){return this.fetch();},parse:function(response){return{lists:Backbone.Webshop.shoppingLists.responseRedirectionHandler(response)};},addTrolleyToList:function(listId){if(this._alreadyAddedToList(listId)){return new Backbone.$.Deferred().reject('Trolley already added to this list.').promise();}
var that=this;var skus=this.get('skus');return Backbone.Webshop.ShoppingListsCollection.getInstance().mergeBasketIntoList(listId,{silentAddNotification:true}).then(Backbone.Webshop.shoppingLists.responseRedirectionHandler).then(function(){var lists=_.cloneDeep(that.get('lists'));var updatedList=lists.find(function(list){return+list.listId===+listId;});if(!updatedList){return new Backbone.$.Deferred().reject('List does not exist').promise();}
updatedList.containsSku=true;that.set('lists',lists);}).done(function(){Backbone.Webshop.notifications.debouncedNotification(getMessage('shoppingLists.success.trolleyAdded'));}).fail(function(error){console.error(error);Backbone.Webshop.notifications.debouncedNotification(getMessage('shoppingLists.error.general'),true);});},addTrolleyToNewList:function(listName){var that=this;var skus=this.get('skus');Backbone.Webshop.ShoppingListsCollection.getInstance().createListFromBasket(listName).then(Backbone.Webshop.shoppingLists.responseRedirectionHandler).then(function(response){var lists=_.cloneDeep(that.get('lists'));lists.push({"containsSku":true,"listId":response.id,"listName":listName});that.set('lists',lists);}).done(function(){Backbone.Webshop.notifications.debouncedNotification(getMessage('shoppingLists.success.trolleyAdded'));}).fail(function(error){console.error(error);});},_alreadyAddedToList:function(listId){var listData=this.get('lists').find(function(list){return parseInt(list.listId)===parseInt(listId);});return listData.containsSku;}});})(Backbone,_);(function(Backbone){'use strict';Backbone.Webshop.shoppingLists.AddFromTrolleyView=Backbone.Marionette.ItemView.extend({template:Handlebars.templates['shoppinglists/addToListView'],ui:{'showNewListFormBtn':'.js-new-list-btn','listBtn':'.js-sl-list','createNewListForm':'.js-new-list-form','newListNameInput':'.js-new-list-name'},events:{"click @ui.showNewListFormBtn":"showNewListForm","click @ui.listBtn":"addTrolleyToList","submit @ui.createNewListForm":"addTrolleyToNewList"},modelEvents:{"change":"render"},initialize:function(){this.eventTracker=Backbone.Webshop.ShoppingListEventTracker.getInstance();},showNewListForm:function(){this.ui.createNewListForm.toggleClass('hidden');this.ui.showNewListFormBtn.toggleClass('hidden');this.ui.newListNameInput.focus();},addTrolleyToList:function(e){this.model.addTrolleyToList(Backbone.$(e.currentTarget).data('slId'));var skus=this.model.get('skus');sendSkusAddedToListEvent(this.model.get('skus'));},addTrolleyToNewList:function(e){e.preventDefault();var listName=this.ui.newListNameInput.val().trim();this.model.addTrolleyToNewList(listName);sendSkusAddedToNewListEvent(this.model.get('skus'));}});function sendSkusAddedToListEvent(skus){var eventTracker=Backbone.Webshop.ShoppingListEventTracker.getInstance();_.each(skus,function(sku){eventTracker.triggerTrolleyItemAddedToList(sku);});}
function sendSkusAddedToNewListEvent(skus){var eventTracker=Backbone.Webshop.ShoppingListEventTracker.getInstance();_.each(skus,function(sku){eventTracker.triggerTrolleyItemAddedToNewList(sku);});}})(Backbone);(function(Backbone,_){'use strict';var PopupViewClass=webshop.jsConfig.popupViewClass();Backbone.Webshop.shoppingLists.AddToShoppingListPopup=PopupViewClass.extend({blockOverScroll:false,initialize:function(){this.model=new ocBackbone.popup.PopupModel({display:false,classNames:['sl-popup'],modalTitle:getMessage('shoppingLists.addToList.header')});PopupViewClass.prototype.initialize.apply(this,arguments);this.eventTracker=Backbone.Webshop.ShoppingListEventTracker.getInstance();},show:function(addToShoppingListModel,addToShoppingListView){addToShoppingListModel.getLists().done(function(){this.model.show();this.addToListView=new addToShoppingListView({el:'#js-popup-content',model:addToShoppingListModel});this.addToListView.render();}.bind(this)).fail(function(error){console.error(error);Backbone.Webshop.notifications.debouncedNotification(getMessage('shoppingLists.error.general'),true);});},closePopup:function(callback){PopupViewClass.prototype.closePopup.call(this,function(){if(_.isFunction(callback)){callback();}
this.addToListView.remove();this.eventTracker.triggerShoppingListPopupClosed();}.bind(this));}});})(Backbone,_);(function(Backbone,_){'use strict';Backbone.Webshop.shoppingLists.responseRedirectionHandler=function responseRedirectionHandler(response){if(Backbone.Webshop.mixins.ResponseHandler.isRedirectionWarning(response)){var redirectUrl=response.redirectionWarning||response.attributes.redirectionWarning;window.location.href=(redirectUrl.match(/^https?:\/\//i))?redirectUrl:'/webshop'+redirectUrl;return null;}
return response;}})(Backbone,_);(function(Backbone){'use strict';Backbone.Webshop.mixins.parseFormattedPrice=function(priceObject){function extractPriceFromPoundSymbol(priceWithCurrencySymbol){var priceWithPoundMatch=priceWithCurrencySymbol.match(/&pound;(.*)/);return priceWithPoundMatch!=null&&priceWithPoundMatch.length>1?priceWithPoundMatch[1]:null;}
function extractPriceFromPenceSymbol(priceWithCurrencySymbol){var priceWithPenceMatch=priceWithCurrencySymbol.match(/([0-9]+)p$/);if(priceWithPenceMatch!=null&&priceWithPenceMatch.length>1){if(priceWithPenceMatch[1].length==1){return'0.0'+priceWithPenceMatch[1];}else{return'0.'+priceWithPenceMatch[1];}}else{return null;}}
var priceWithCurrencySymbol=priceObject.currentPrice;if(!priceWithCurrencySymbol){return undefined;}
var priceWithoutPoundSymbol=extractPriceFromPoundSymbol(priceWithCurrencySymbol);if(priceWithoutPoundSymbol!=null){return stringToNumber(priceWithoutPoundSymbol);}else{var priceWithoutPenceSymbol=extractPriceFromPenceSymbol(priceWithCurrencySymbol);if(priceWithoutPenceSymbol!=null){return stringToNumber(priceWithoutPenceSymbol);}else{return stringToNumber(priceWithCurrencySymbol);}}};function stringToNumber(str){if(str==null||str.length==0||isNaN(str)){return null;}else{return Number(str);}}})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.trolley.mixin.addItem=function(basketItem){itemExistsInTrolley.call(this,basketItem).done(updateTrolleyItem).fail(this.refresh);};function updateTrolleyItem(trolleyItem){trolleyItem.set(this.basketItem.toJSON()).bindBasketEvents();}
function itemExistsInTrolley(basketItem){var deferred=Backbone.$.Deferred();var itemSection=this.findWhere({name:basketItem.get('section')});if(!itemSection){return deferred.rejectWith(this);}
var trolleyItem=itemSection.get('items').get(basketItem.get('sku'));if(!trolleyItem){return deferred.rejectWith(this);}
return deferred.resolveWith({basketItem:basketItem},[trolleyItem]);}})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.trolley.analytics.mixin.PageComponentId=function(sku){return Backbone.Webshop.analytics.mixin.getPageViewId()+'.TrolleyItem.'+sku;};})(Backbone);(function(Backbone,_){'use strict';Backbone.Webshop.trolley.analytics.converter.TrolleyItemToPageComponentConversion={perform:function(trolleyItem){var pageComponent={id:Backbone.Webshop.trolley.analytics.mixin.PageComponentId(trolleyItem.attributes.sku),type:'FOP_BASKET',fields:_getTrolleyItemPageComponentFields(trolleyItem.attributes)};return pageComponent;}};function _getTrolleyItemPageComponentFields(trolleyItemAttributes){return{SKU:trolleyItemAttributes.sku}}})(Backbone,_);(function(Backbone,_){'use strict';Backbone.Webshop.trolley.analytics.TrolleyImpressionsNotifier={_skusSavedComponent:[],reportProductImpressions:function(trolleyItems){var itemsToSaveComponent=_.reject(trolleyItems,function(item){return _.includes(this._skusSavedComponent,item.attributes.sku);}.bind(this));this._reportPageComponents(itemsToSaveComponent);this._skusSavedComponent=_.union(this._skusSavedComponent,_.map(itemsToSaveComponent,'attributes.sku'));},_reportPageComponents:function(trolleyItems){var pageComponents;if(trolleyItems.length==0){return;}
pageComponents=_.map(trolleyItems,Backbone.Webshop.trolley.analytics.converter.TrolleyItemToPageComponentConversion.perform);Backbone.Webshop.analytics.WebshopAnalytics.reportPageComponents({pageComponents:pageComponents});}};})(Backbone,_);(function(Backbone,_){'use strict';Backbone.Webshop.trolley.TrolleyItemModel=Backbone.Model.extend({idAttribute:'sku',defaults:{sku:''},basketItemEvents:{change:function(basketItem){this.set(basketItem.toJSON());},remove:function(){this.set({itemQuantity:0,error:'',itemPrice:''});}},bindEntityEvents:Backbone.Marionette.proxyBindEntityEvents,initialize:function(){this.basket=Backbone.Webshop.Basket.getInstance();this.bindBasketEvents();},bindBasketEvents:function(){this.bindEntityEvents(this.basket.findItem(this.get('sku')),this.basketItemEvents);},addToBasket:function(quantity){var trolleyData=this._buildTrolleyItemData();return this.basket.addFromTrolley(trolleyData,getAddStatus.call(this),quantity);},removeFromBasket:function(quantity){var trolleyData=this._buildTrolleyItemData();return this.basket.removeFromTrolley(trolleyData,quantity);},isEmpty:function(){return this.get('itemQuantity')===0;},_buildTrolleyItemData:function(){return _.extend(this.toJSON(),{listName:'Trolley sidebar',sectionTitle:'Trolley sidebar',pageType:'Trolley sidebar',price:this.parseFormattedPrice({currentPrice:this.get('itemCataloguePrice')}),pageComponentIdForBQU:Backbone.Webshop.trolley.analytics.mixin.PageComponentId(this.get('sku')),pageViewId:webshop.common.jsTopBodyVariables.pageViewId,analyticsPageType:'Trolley sidebar'});},parseFormattedPrice:Backbone.Webshop.mixins.parseFormattedPrice});function getAddStatus(){if(this.isEmpty()){return'EMPTY_BUT_ADDED';}
return'ADDED';}})(Backbone,_);(function(Backbone){'use strict';Backbone.Webshop.trolley.TrolleyItemCollection=Backbone.Collection.extend({model:Backbone.Webshop.trolley.TrolleyItemModel,_reset:function(){this.forEach(function(item){item.stopListening();});return Backbone.Collection.prototype._reset.apply(this,arguments);}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.trolley.TrolleyCategoriesCollection=Backbone.Collection.extend({bindEntityEvents:Backbone.Marionette.proxyBindEntityEvents,basketItemsEvents:{add:Backbone.Webshop.trolley.mixin.addItem},initialize:function(){this.basket=Backbone.Webshop.Basket.getInstance();this.bindEntityEvents(this.basket.get('items'),this.basketItemsEvents);},refresh:function(){this.reset(this.basket.getCategorizedItems());},_reset:function(){this.forEach(function(category){category.get('items').reset();});return Backbone.Collection.prototype._reset.apply(this,arguments);}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.trolley.CheckoutBehavior=Backbone.Marionette.Behavior.extend({ui:{checkoutButton:'.btn-checkout.active'},events:{'click @ui.checkoutButton':'checkout'},initialize:function(){webshop.gtm.registerEventSource(this.view);},checkout:function(){sendCheckoutButtonClickedEvent.call(this);navigateToPage.call(this,this.view.model.get('checkoutURL'));}});function sendCheckoutButtonClickedEvent(){this.view.trigger('gtm:uaEvent',{category:'Checkout button',action:'click',label:'trolley'});}
function navigateToPage(url){location.href=url;}})(Backbone);(function(Backbone,Handlebars,_,gtm){'use strict';Backbone.Webshop.trolley.TrolleyItemView=Backbone.Marionette.ItemView.extend({className:'item',template:Handlebars.templates['trolley/partials/item'],ui:{addToBasketBtn:'.js-fop-btn-plus',removeFromBasketBtn:'.js-fop-btn-minus'},events:{'click':'sendGTMTrolleyProductClickEvent',},initialize:function(){gtm.registerEventSource(this);},modelEvents:{change:'render'},behaviors:{BasketBehavior:{},QuantityInputBehavior:{}},templateHelpers:function(){return{empty:this.model.isEmpty(),error:Backbone.Webshop.Basket.getInstance().getProductWarning(this.model.get('sku')),};},sendGTMTrolleyProductClickEvent:function(event){var productData=this.model.attributes;productData=_.extend(productData,Backbone.Webshop.mixins.getAnalyticsAttributesForProduct(productData));this.trigger('gtm:productClick',{product:{sku:productData.sku,name:productData.encodedName,brand:productData.brand,category:productData.category,price:Backbone.Webshop.mixins.parseFormattedPrice({currentPrice:productData.itemCataloguePrice}),},pageType:'Trolley sidebar',sectionTitle:'Trolley sidebar',position:this.model.collection.models.indexOf(this.model),});},});})(Backbone,Handlebars,_,webshop.gtm);(function(Backbone,Handlebars){'use strict';Backbone.Webshop.trolley.TrolleyHeaderView=Backbone.Marionette.ItemView.extend({template:Handlebars.templates['trolley/partials/header'],modelEvents:{change:'render'},behaviors:{CheckoutBehavior:{behaviorClass:Backbone.Webshop.trolley.CheckoutBehavior}},templateHelpers:function(){return{isBasketEmpty:!parseInt(this.model.get('totalSkus'),10)}},initialize:function(){this.model=Backbone.Webshop.Basket.getInstance();}});})(Backbone,Handlebars);(function(Backbone,Handlebars,_){'use strict';Backbone.Webshop.trolley.TrolleyFooterView=Backbone.Marionette.ItemView.extend({template:Handlebars.templates['trolley/partials/footer'],modelEvents:{change:'render'},behaviors:{CheckoutBehavior:{behaviorClass:Backbone.Webshop.trolley.CheckoutBehavior}},events:{'click .js-add-trolley-to-list':'showAddToListPopup'},templateHelpers:function(){return{shouldDisplayCheckoutBtn:Backbone.Webshop.mixins.isFeatureEnabled('CUSTOMER_ACQUISITION_2018'),shouldDisplayAddToList:Backbone.Webshop.mixins.isBetaFeatureEnabled('RESPONSIVE_SHOPPING_LISTS')&&this.model.get('totalItems')>0};},initialize:function(){this.model=Backbone.Webshop.Basket.getInstance();this.addToShoppingListPopup=new Backbone.Webshop.shoppingLists.AddToShoppingListPopup();this.eventTracker=Backbone.Webshop.ShoppingListEventTracker.getInstance();},showAddToListPopup:function(){var skus=getSkusFromItems(this.model.get('items'));this.addToShoppingListPopup.show(new Backbone.Webshop.shoppingLists.AddFromTrolleyModel({totalItems:this.model.get('totalItems'),skus:skus}),Backbone.Webshop.shoppingLists.AddFromTrolleyView);this.eventTracker.triggerShoppingListPopupOpened();}});function getSkusFromItems(items){return items.map(function(item){return item.get('sku');});}})(Backbone,Handlebars,_);(function(Backbone,Handlebars){'use strict';Backbone.Webshop.trolley.TrolleyEmptyView=Backbone.Marionette.ItemView.extend({className:'trolley-empty',template:Handlebars.templates['trolley/partials/emptyTrolley'],events:{'click .btn-add-all':'addAllSuggestedItems'},templateHelpers:function(){return{shouldShowInstantShop:!Backbone.Webshop.mixins.isBetaFeatureEnabled('RWD_ALTERNATIVE_HEADER')||!Backbone.Webshop.Basket.getInstance().get('editingOrder')};},addAllSuggestedItems:function(event){event.preventDefault();var basket=Backbone.Webshop.Basket.getInstance();basket.addSuggestedItems({url:event.target.href});}});})(Backbone,Handlebars);(function(Backbone,Handlebars){'use strict';var RIBBON_CATEGORIES=['cupboard','freezer','fridge','subscriptions'];Backbone.Webshop.trolley.TrolleyCategoryCompositeView=Backbone.Marionette.CompositeView.extend({childView:Backbone.Webshop.trolley.TrolleyItemView,template:Handlebars.templates['trolley/partials/category'],childViewContainer:'.category-items-list',templateHelpers:function(){var cookieValue=Cookies.get('subscriptions-show-trolley-infobox');var isVisible=cookieValue?!!JSON.parse(cookieValue):true;return{className:this.model.get('className'),isVisible:isVisible}},ui:{close:'.infobox-close',dismissInfoBox:'.subscriptions-infobox',},events:{'click @ui.close':'dismissInfoBox'},className:function(){var category=this.model.get("className");if(RIBBON_CATEGORIES.indexOf(category)===-1){category='default'}
return'category category-'+category;},initialize:function(){this.collection=this.model.get('items');},dismissInfoBox:function(evt){this.ui.dismissInfoBox.hide();Cookies.set('subscriptions-show-trolley-infobox',false,{httpOnly:false,secure:true});}});})(Backbone,Handlebars);(function(Backbone){'use strict';Backbone.Webshop.trolley.TrolleyCategoriesCompositeView=Backbone.Marionette.CompositeView.extend({template:Handlebars.templates['trolley/partials/categories'],childViewContainer:".categories",childView:Backbone.Webshop.trolley.TrolleyCategoryCompositeView,emptyView:Backbone.Webshop.trolley.TrolleyEmptyView,ui:{removeAllItemsBtn:'.remove-all'},modelEvents:{sync:'render'},events:{'click @ui.removeAllItemsBtn':'removeAllItems'},initialize:function(){this.model=Backbone.Webshop.Basket.getInstance();this.collection=new Backbone.Webshop.trolley.TrolleyCategoriesCollection(this.model.getCategorizedItems());},templateHelpers:function(){return{sizeOfTrolley:this.collection.length}},emptyViewOptions:function(){return{model:new Backbone.Model(this.model.get('instantShop'))};},removeSkuWithZeroQuantity:function(){this.collection.refresh();this.render();},removeAllItems:function(evt){evt.preventDefault();new Backbone.Webshop.trolley.TrolleyRemoveAllPopupView();}});})(Backbone);(function(Backbone,Handlebars){'use strict';Backbone.Webshop.trolley.TrolleyView=Backbone.Marionette.LayoutView.extend({el:'.trolley-menu',template:Handlebars.templates['trolley/trolley'],regions:{header:'.trolley-header',categories:'.trolley-items',footer:'.trolley-footer'},behaviors:{ModalDrawerBehavior:{},CancelOrderChangesConfirmationPopupBehavior:{}},onOpen:function(){var isAlternativeHeaderEnabled=Backbone.Webshop.mixins.isBetaFeatureEnabled('RWD_ALTERNATIVE_HEADER')||Backbone.Webshop.mixins.isBetaFeatureEnabled('ALTERNATIVE_HEADER');if(this.$el.is(':empty')){this.render();if(isAlternativeHeaderEnabled){Backbone.Webshop.scroll.preventOverScrollOnElement(this.el.querySelector('.trolley-content'));}}else if(isAlternativeHeaderEnabled){this.el.querySelector('.trolley-content').scrollTop=0;}
this.categories.currentView.removeSkuWithZeroQuantity();this.header.currentView.el.scrollIntoView(true);Backbone.Webshop.trolley.analytics.TrolleyImpressionsNotifier.reportProductImpressions(this.categories.currentView.collection.basket.get('items').models);},onClose:function(){Backbone.Webshop.IosAdapter.onCloseTrolley();},onRender:function(){this.header.show(new Backbone.Webshop.trolley.TrolleyHeaderView());this.categories.show(new Backbone.Webshop.trolley.TrolleyCategoriesCompositeView());this.footer.show(new Backbone.Webshop.trolley.TrolleyFooterView());}});})(Backbone,Handlebars);(function(Backbone){'use strict';Backbone.Webshop.trolley.TrolleyRemoveAllPopupView=Backbone.Webshop.popup.MobilePopupView.extend({events:{"click .remove":"removeAllItems","click .cancel":"closePopup"},initialize:function(){this.model=new ocBackbone.popup.PopupModel({content:Handlebars.templates['trolley/partials/removeAll']()});this.render();},removeAllItems:function(evt){evt.preventDefault();Backbone.Webshop.Basket.getInstance().removeAll();this.closePopup();}});})(Backbone);(function(Backbone){"use strict";Backbone.Webshop.popup.BookSlotPromptView=Backbone.Webshop.popup.ConfirmationPopupView.extend({model:new ocBackbone.popup.PopupModel({display:false,content:'<p class="main-content">We have a limited slot availability. Book your slot before '+'you start shopping, to avoid missing out on your preferred time.</p>'+'<p class="divider"></p>',modalTitle:'Have you booked a delivery slot?',cancelText:'Ok, I understand',confirmText:'Book a slot',classNames:['bookSlotPrompt-popup'],isContentFetched:true}),confirm:function(){window.location.href="/webshop/getAddressesForDelivery.do?fromBookSlotPrompt=true";}});})(Backbone);(function(Backbone,bowser){'use strict';var SEARCH_SUGGESTIONS_INPUT='#searchWrapper';var SUGGESTION_LIST_HEIGHT_WITH_KEYBOARD=152;var SUGGESTION_LIST_HEIGHT_WITHOUT_KEYBOARD=367;Backbone.Webshop.IosAdapter={scrolledY:null,disableBodyScroll:function(event){if(bowser.ios&&isTargetEventFromSearchSuggestions(event)){Backbone.$('.disable-ios-scroll').on('touchmove',false);}},restoreBodyScroll:function(event){if(bowser.ios&&isTargetEventFromSearchSuggestions(event)){Backbone.$('.disable-ios-scroll').off('touchmove');}},onCloseTrolley:function(){if(bowser.ios){document.activeElement.blur();}},setSuggestionListHeightWithKeyboard:function(suggestionsList){if(bowser.iphone){suggestionsList.css({'max-height':screen.height-SUGGESTION_LIST_HEIGHT_WITH_KEYBOARD});}},setSuggestionListHeightWithoutKeyboard:function(suggestionsList){if(bowser.iphone){suggestionsList.css({'max-height':screen.height-SUGGESTION_LIST_HEIGHT_WITHOUT_KEYBOARD});}}}
function isTargetEventFromSearchSuggestions(event){return Backbone.$(event.target).parents(SEARCH_SUGGESTIONS_INPUT).length>0}
function windowScrollY(){return(window.pageYOffset!==undefined)?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;}})(Backbone,bowser);(function(Backbone,webshop){'use strict';Backbone.Webshop.login.ElevatedLoginView=Backbone.Marionette.ItemView.extend({events:{"click .fb-elevate-login-button":'elevateLoginWithFacebook'},template:false,facebookServiceEvents:{"identifyUser:dataValid":'redirectToTargetPage',"identifyUser:dataInvalid:emailPresent":'loadLinkAccountOverlay'},initialize:function(){this.facebookService=Backbone.Facebook.getInstance();this.bindEntityEvents(this.facebookService,this.facebookServiceEvents);webshop.gtm.registerEventSource(this);},elevateLoginWithFacebook:function(){this.facebookService.elevateLogin();this.trigger('gtm:uaEvent',{category:'Login',action:'fb-login-reauth'});},redirectToTargetPage:function(loginUrl,response,loginToken){webshop.social.FacebookRedirects.redirectToTargetPage(loginUrl,response,loginToken);},loadLinkAccountOverlay:function(emailExists,email,fbuid,accessToken,signedRequest){webshop.social.FacebookRedirects.loadLinkAccountOverlay(emailExists,email,fbuid,accessToken,signedRequest)}});})(Backbone,webshop);(function(Backbone,webshop){'use strict';Backbone.Webshop.login.LoginFormView=Backbone.Marionette.ItemView.extend({events:{"click .btn-primary":'login'},template:false,login:function(event){webshop.popup.utils.giveSubmitFeedback(".btn-primary");}});})(Backbone,webshop);(function(Backbone){'use strict';Backbone.Webshop.login.SSOLoginFormBehavior=Backbone.Marionette.Behavior.extend({initialize:function(){window.addEventListener('message',this.resizeIframeHandler.bind(this),false);},resizeIframeHandler:function(event){if(!this.isValidTargetOrigin(event.origin)||(isNaN(event.data.height))){return;}
jQ('.sso-iframe-login').css('height',event.data.height+'px');},isValidTargetOrigin:function(origin){var ssoTargetOrigin=webshop.common.jsVariables.get('ssoTargetOrigin');var windowOrigin=window.location.origin;if(!windowOrigin){windowOrigin=window.location.protocol+"//"+window.location.hostname+(window.location.port?':'+window.location.port:'');}
return origin===ssoTargetOrigin||origin===windowOrigin;}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.login.SSOLoginFormView=Backbone.Marionette.ItemView.extend({template:false,behaviors:{SSOLoginFormBehavior:{}}});})(Backbone);(function(Backbone,webshop){'use strict';Backbone.Webshop.login.SocialLoginView=Backbone.Marionette.ItemView.extend({events:{"click .fb-login-button":'loginWithFacebook'},facebookServiceEvents:{"identifyUser:dataValid":'redirectToTargetPage',"identifyUser:dataInvalid:emailPresent":'loadLinkAccountOverlay',"identifyUser:dataInvalid:emailAbsent":'goToRegisterForm',"facebookFallback":'facebookFallback'},template:false,initialize:function(){this.facebookService=Backbone.Facebook.getInstance();this.bindEntityEvents(this.facebookService,this.facebookServiceEvents);webshop.gtm.registerEventSource(this);},loginWithFacebook:function(evt){evt.preventDefault();this.facebookService.authenticate();this.trigger('gtm:uaEvent',{category:'Login',action:'fb-loginbutton-click'});},redirectToTargetPage:function(loginUrl,response,loginToken){webshop.social.FacebookRedirects.redirectToTargetPage(loginUrl,response,loginToken);},goToRegisterForm:function(fbuid,accessToken,signedRequest){webshop.social.FacebookRedirects.goToRegisterForm(fbuid,accessToken,signedRequest);},loadLinkAccountOverlay:function(emailExists,email,fbuid,accessToken,signedRequest){webshop.social.FacebookRedirects.loadLinkAccountOverlay(emailExists,email,fbuid,accessToken,signedRequest)},facebookFallback:function(){webshop.social.FacebookRedirects.facebookFallback();}});})(Backbone,webshop);var RecaptchaTemplates={};RecaptchaTemplates.VertHtml='<table id="recaptcha_table" class="recaptchatable" > <tr> <td colspan="6" class=\'recaptcha_r1_c1\'></td> </tr> <tr> <td class=\'recaptcha_r2_c1\'></td> <td colspan="4" class=\'recaptcha_image_cell\'><div id="recaptcha_image"></div></td> <td class=\'recaptcha_r2_c2\'></td> </tr> <tr> <td rowspan="6" class=\'recaptcha_r3_c1\'></td> <td colspan="4" class=\'recaptcha_r3_c2\'></td> <td rowspan="6" class=\'recaptcha_r3_c3\'></td> </tr> <tr> <td rowspan="3" class=\'recaptcha_r4_c1\' height="49"> <div class="recaptcha_input_area"> <label for="recaptcha_response_field" class="recaptcha_input_area_text"><span id="recaptcha_instructions_image" class="recaptcha_only_if_image recaptcha_only_if_no_incorrect_sol"></span><span id="recaptcha_instructions_audio" class="recaptcha_only_if_no_incorrect_sol recaptcha_only_if_audio"></span><span id="recaptcha_instructions_error" class="recaptcha_only_if_incorrect_sol"></span></label><br/> <input name="recaptcha_response_field" id="recaptcha_response_field" type="text" autocorrect="off" autocapitalize="off" /> </div> </td> <td rowspan="4" class=\'recaptcha_r4_c2\'></td> <td><a id=\'recaptcha_reload_btn\'><img id=\'recaptcha_reload\' width="25" height="17" /></a></td> <td rowspan="4" class=\'recaptcha_r4_c4\'></td> </tr> <tr> <td><a id=\'recaptcha_switch_audio_btn\' class="recaptcha_only_if_image"><img id=\'recaptcha_switch_audio\' width="25" height="16" alt="" /></a><a id=\'recaptcha_switch_img_btn\' class="recaptcha_only_if_audio"><img id=\'recaptcha_switch_img\' width="25" height="16" alt=""/></a></td> </tr> <tr> <td><a id=\'recaptcha_whatsthis_btn\'><img id=\'recaptcha_whatsthis\' width="25" height="16" /></a></td> </tr> <tr> <td class=\'recaptcha_r7_c1\'></td> <td class=\'recaptcha_r8_c1\'></td> </tr> </table> ';RecaptchaTemplates.CleanCss=".recaptchatable td img{display:block}.recaptchatable .recaptcha_image_cell center img{height:57px}.recaptchatable .recaptcha_image_cell center{height:57px}.recaptchatable .recaptcha_image_cell{background-color:white;height:57px;padding:7px!important}.recaptchatable,#recaptcha_area tr,#recaptcha_area td,#recaptcha_area th{margin:0!important;border:0!important;border-collapse:collapse!important;vertical-align:middle!important}.recaptchatable *{margin:0;padding:0;border:0;color:black;position:static;top:auto;left:auto;right:auto;bottom:auto;text-align:left!important}.recaptchatable #recaptcha_image{margin:auto;border:1px solid #dfdfdf!important}.recaptchatable a img{border:0}.recaptchatable a,.recaptchatable a:hover{outline:none;border:0!important;padding:0!important;text-decoration:none;color:blue;background:none!important;font-weight:normal}.recaptcha_input_area{position:relative!important;background:none!important}.recaptchatable label.recaptcha_input_area_text{border:1px solid #dfdfdf!important;margin:0!important;padding:0!important;position:static!important;top:auto!important;left:auto!important;right:auto!important;bottom:auto!important}.recaptcha_theme_red label.recaptcha_input_area_text,.recaptcha_theme_white label.recaptcha_input_area_text{color:black!important}.recaptcha_theme_blackglass label.recaptcha_input_area_text{color:white!important}.recaptchatable #recaptcha_response_field{font-size:11pt}.recaptcha_theme_blackglass #recaptcha_response_field,.recaptcha_theme_white #recaptcha_response_field{border:1px solid gray}.recaptcha_theme_red #recaptcha_response_field{border:1px solid #cca940}.recaptcha_audio_cant_hear_link{font-size:7pt;color:black}.recaptchatable{line-height:1em;border:1px solid #dfdfdf!important}.recaptcha_error_text{color:red}";RecaptchaTemplates.CleanHtml='<table id="recaptcha_table" class="recaptchatable"> <tr height="73"> <td class=\'recaptcha_image_cell\' width="302"><center><div id="recaptcha_image"></div></center></td> <td style="padding: 10px 7px 7px 7px;"> <a id=\'recaptcha_reload_btn\'><img id=\'recaptcha_reload\' width="25" height="18" alt="" /></a> <a id=\'recaptcha_switch_audio_btn\' class="recaptcha_only_if_image"><img id=\'recaptcha_switch_audio\' width="25" height="15" alt="" /></a><a id=\'recaptcha_switch_img_btn\' class="recaptcha_only_if_audio"><img id=\'recaptcha_switch_img\' width="25" height="15" alt=""/></a> <a id=\'recaptcha_whatsthis_btn\'><img id=\'recaptcha_whatsthis\' width="25" height="16" /></a> </td> <td style="padding: 18px 7px 18px 7px;"> <img id=\'recaptcha_logo\' alt="" width="71" height="36" /> </td> </tr> <tr> <td style="padding-left: 7px;"> <div class="recaptcha_input_area" style="padding-top: 2px; padding-bottom: 7px;"> <input style="border: 1px solid #3c3c3c; width: 302px;" name="recaptcha_response_field" id="recaptcha_response_field" type="text" /> </div> </td> <td></td> <td style="padding: 4px 7px 12px 7px;"> <img id="recaptcha_tagline" width="71" height="17" /> </td> </tr> </table> ';RecaptchaTemplates.ContextHtml='<table id="recaptcha_table" class="recaptchatable"> <tr> <td colspan="6" class=\'recaptcha_r1_c1\'></td> </tr> <tr> <td class=\'recaptcha_r2_c1\'></td> <td colspan="4" class=\'recaptcha_image_cell\'><div id="recaptcha_image"></div></td> <td class=\'recaptcha_r2_c2\'></td> </tr> <tr> <td rowspan="6" class=\'recaptcha_r3_c1\'></td> <td colspan="4" class=\'recaptcha_r3_c2\'></td> <td rowspan="6" class=\'recaptcha_r3_c3\'></td> </tr> <tr> <td rowspan="3" class=\'recaptcha_r4_c1\' height="49"> <div class="recaptcha_input_area"> <label for="recaptcha_response_field" class="recaptcha_input_area_text"><span id="recaptcha_instructions_context" class="recaptcha_only_if_image recaptcha_only_if_no_incorrect_sol"></span><span id="recaptcha_instructions_audio" class="recaptcha_only_if_no_incorrect_sol recaptcha_only_if_audio"></span><span id="recaptcha_instructions_error" class="recaptcha_only_if_incorrect_sol"></span></label><br/> <input name="recaptcha_response_field" id="recaptcha_response_field" type="text" /> </div> </td> <td rowspan="4" class=\'recaptcha_r4_c2\'></td> <td><a id=\'recaptcha_reload_btn\'><img id=\'recaptcha_reload\' width="25" height="17" /></a></td> <td rowspan="4" class=\'recaptcha_r4_c4\'></td> </tr> <tr> <td><a id=\'recaptcha_switch_audio_btn\' class="recaptcha_only_if_image"><img id=\'recaptcha_switch_audio\' width="25" height="16" alt="" /></a><a id=\'recaptcha_switch_img_btn\' class="recaptcha_only_if_audio"><img id=\'recaptcha_switch_img\' width="25" height="16" alt=""/></a></td> </tr> <tr> <td><a id=\'recaptcha_whatsthis_btn\'><img id=\'recaptcha_whatsthis\' width="25" height="16" /></a></td> </tr> <tr> <td class=\'recaptcha_r7_c1\'></td> <td class=\'recaptcha_r8_c1\'></td> </tr> </table> ';RecaptchaTemplates.VertCss=".recaptchatable td img{display:block}.recaptchatable .recaptcha_r1_c1{background:url('IMGROOT/sprite.png') 0 -63px no-repeat;width:318px;height:9px}.recaptchatable .recaptcha_r2_c1{background:url('IMGROOT/sprite.png') -18px 0 no-repeat;width:9px;height:57px}.recaptchatable .recaptcha_r2_c2{background:url('IMGROOT/sprite.png') -27px 0 no-repeat;width:9px;height:57px}.recaptchatable .recaptcha_r3_c1{background:url('IMGROOT/sprite.png') 0 0 no-repeat;width:9px;height:63px}.recaptchatable .recaptcha_r3_c2{background:url('IMGROOT/sprite.png') -18px -57px no-repeat;width:300px;height:6px}.recaptchatable .recaptcha_r3_c3{background:url('IMGROOT/sprite.png') -9px 0 no-repeat;width:9px;height:63px}.recaptchatable .recaptcha_r4_c1{background:url('IMGROOT/sprite.png') -43px 0 no-repeat;width:171px;height:49px}.recaptchatable .recaptcha_r4_c2{background:url('IMGROOT/sprite.png') -36px 0 no-repeat;width:7px;height:57px}.recaptchatable .recaptcha_r4_c4{background:url('IMGROOT/sprite.png') -214px 0 no-repeat;width:97px;height:57px}.recaptchatable .recaptcha_r7_c1{background:url('IMGROOT/sprite.png') -43px -49px no-repeat;width:171px;height:8px}.recaptchatable .recaptcha_r8_c1{background:url('IMGROOT/sprite.png') -43px -49px no-repeat;width:25px;height:8px}.recaptchatable .recaptcha_image_cell center img{height:57px}.recaptchatable .recaptcha_image_cell center{height:57px}.recaptchatable .recaptcha_image_cell{background-color:white;height:57px}#recaptcha_area,#recaptcha_table{width:318px!important}.recaptchatable,#recaptcha_area tr,#recaptcha_area td,#recaptcha_area th{margin:0!important;border:0!important;padding:0!important;border-collapse:collapse!important;vertical-align:middle!important}.recaptchatable *{margin:0;padding:0;border:0;font-family:helvetica,sans-serif;font-size:8pt;color:black;position:static;top:auto;left:auto;right:auto;bottom:auto;text-align:left!important}.recaptchatable #recaptcha_image{margin:auto}.recaptchatable img{border:0!important;margin:0!important;padding:0!important}.recaptchatable a,.recaptchatable a:hover{outline:none;border:0!important;padding:0!important;text-decoration:none;color:blue;background:none!important;font-weight:normal}.recaptcha_input_area{position:relative!important;width:146px!important;height:45px!important;margin-left:20px!important;margin-right:5px!important;margin-top:4px!important;background:none!important}.recaptchatable label.recaptcha_input_area_text{margin:0!important;padding:0!important;position:static!important;top:auto!important;left:auto!important;right:auto!important;bottom:auto!important;background:none!important;height:auto!important;width:auto!important}.recaptcha_theme_red label.recaptcha_input_area_text,.recaptcha_theme_white label.recaptcha_input_area_text{color:black!important}.recaptcha_theme_blackglass label.recaptcha_input_area_text{color:white!important}.recaptchatable #recaptcha_response_field{width:145px!important;position:absolute!important;bottom:7px!important;padding:0!important;margin:0!important;font-size:10pt}.recaptcha_theme_blackglass #recaptcha_response_field,.recaptcha_theme_white #recaptcha_response_field{border:1px solid gray}.recaptcha_theme_red #recaptcha_response_field{border:1px solid #cca940}.recaptcha_audio_cant_hear_link{font-size:7pt;color:black}.recaptchatable{line-height:1em}#recaptcha_instructions_error{color:red!important}";var RecaptchaStr_en={visual_challenge:"Get a visual challenge",audio_challenge:"Get an audio challenge",refresh_btn:"Get a new challenge",instructions_visual:"Type the two words:",instructions_context:"Type the words in the boxes:",instructions_audio:"Type what you hear:",help_btn:"Help",play_again:"Play sound again",cant_hear_this:"Download sound as MP3",incorrect_try_again:"Incorrect. Try again.",image_alt_text:"reCAPTCHA challenge image"},RecaptchaStr_af={visual_challenge:"Kry 'n visuele verifi\u00ebring",audio_challenge:"Kry 'n klankverifi\u00ebring",refresh_btn:"Kry 'n nuwe verifi\u00ebring",instructions_visual:"Tik die twee woorde:",instructions_context:"Tik die woorde in die kassies:",instructions_audio:"Tik wat jy hoor:",help_btn:"Hulp",play_again:"Speel geluid weer",cant_hear_this:"Laai die klank af as MP3",incorrect_try_again:"Verkeerd. Probeer weer.",image_alt_text:"reCAPTCHA-verifieerprent"},RecaptchaStr_am={visual_challenge:"\u12e8\u12a5\u12ed\u1273 \u1270\u130b\u1323\u121a \u12a0\u130d\u129d",audio_challenge:"\u120c\u120b \u12a0\u12f2\u1235 \u12e8\u12f5\u121d\u133d \u1325\u12eb\u1244 \u12ed\u1245\u1228\u1265",refresh_btn:"\u120c\u120b \u12a0\u12f2\u1235 \u1325\u12eb\u1244 \u12ed\u1245\u1228\u1265",instructions_visual:"\u12a5\u1295\u12da\u1205\u1295 \u1201\u1208\u1275 \u1243\u120b\u1275 \u1270\u12ed\u1265 \u1366",instructions_context:"\u1260\u1233\u1325\u1296\u1279 \u12cd\u1235\u1325 \u1243\u120b\u1276\u1279\u1295 \u1270\u12ed\u1265\u1366",instructions_audio:"\u12e8\u121d\u1275\u1230\u121b\u12cd\u1295 \u1270\u12ed\u1265\u1361-",help_btn:"\u12a5\u1308\u12db",play_again:"\u12f5\u121d\u1339\u1295 \u12a5\u1295\u12f0\u1308\u1293 \u12a0\u132b\u12cd\u1275",cant_hear_this:"\u12f5\u121d\u1339\u1295 \u1260MP3 \u1245\u122d\u133d \u12a0\u12cd\u122d\u12f5",incorrect_try_again:"\u1275\u12ad\u12ad\u120d \u12a0\u12ed\u12f0\u1208\u121d\u1362 \u12a5\u1295\u12f0\u1308\u1293 \u121e\u12ad\u122d\u1362",image_alt_text:"reCAPTCHA \u121d\u1235\u120d \u130d\u1320\u121d"},RecaptchaStr_ar={visual_challenge:"\u0627\u0644\u062d\u0635\u0648\u0644 \u0639\u0644\u0649 \u062a\u062d\u062f\u064d \u0645\u0631\u0626\u064a",audio_challenge:"\u0627\u0644\u062d\u0635\u0648\u0644 \u0639\u0644\u0649 \u062a\u062d\u062f\u064d \u0635\u0648\u062a\u064a",refresh_btn:"\u0627\u0644\u062d\u0635\u0648\u0644 \u0639\u0644\u0649 \u062a\u062d\u062f\u064d \u062c\u062f\u064a\u062f",instructions_visual:"\u0627\u0643\u062a\u0628 \u0627\u0644\u0643\u0644\u0645\u062a\u064a\u0646:",instructions_context:"\u0627\u0643\u062a\u0628 \u0627\u0644\u0643\u0644\u0645\u0627\u062a \u0641\u064a \u0627\u0644\u0645\u0631\u0628\u0639\u0627\u062a:",instructions_audio:"\u0627\u0643\u062a\u0628 \u0645\u0627 \u062a\u0633\u0645\u0639\u0647:",help_btn:"\u0645\u0633\u0627\u0639\u062f\u0629",play_again:"\u062a\u0634\u063a\u064a\u0644 \u0627\u0644\u0635\u0648\u062a \u0645\u0631\u0629 \u0623\u062e\u0631\u0649",cant_hear_this:"\u062a\u0646\u0632\u064a\u0644 \u0627\u0644\u0635\u0648\u062a \u0628\u062a\u0646\u0633\u064a\u0642 MP3",incorrect_try_again:"\u063a\u064a\u0631 \u0635\u062d\u064a\u062d. \u0623\u0639\u062f \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629.",image_alt_text:"\u0635\u0648\u0631\u0629 \u0627\u0644\u062a\u062d\u062f\u064a \u0645\u0646 reCAPTCHA"},RecaptchaStr_bg={visual_challenge:"\u041f\u043e\u043b\u0443\u0447\u0430\u0432\u0430\u043d\u0435 \u043d\u0430 \u0432\u0438\u0437\u0443\u0430\u043b\u043d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430",audio_challenge:"\u0417\u0430\u0440\u0435\u0436\u0434\u0430\u043d\u0435 \u043d\u0430 \u0430\u0443\u0434\u0438\u043e\u0442\u0435\u0441\u0442",refresh_btn:"\u0417\u0430\u0440\u0435\u0436\u0434\u0430\u043d\u0435 \u043d\u0430 \u043d\u043e\u0432 \u0442\u0435\u0441\u0442",instructions_visual:"\u0412\u044a\u0432\u0435\u0434\u0435\u0442\u0435 \u0434\u0432\u0435\u0442\u0435 \u0434\u0443\u043c\u0438:",instructions_context:"\u0412\u044a\u0432\u0435\u0434\u0435\u0442\u0435 \u0434\u0443\u043c\u0438\u0442\u0435:",instructions_audio:"\u0412\u044a\u0432\u0435\u0434\u0435\u0442\u0435 \u0447\u0443\u0442\u043e\u0442\u043e:",help_btn:"\u041f\u043e\u043c\u043e\u0449",play_again:"\u041f\u043e\u0432\u0442\u043e\u0440\u043d\u043e \u043f\u0443\u0441\u043a\u0430\u043d\u0435 \u043d\u0430 \u0437\u0432\u0443\u043a\u0430",cant_hear_this:"\u0418\u0437\u0442\u0435\u0433\u043b\u044f\u043d\u0435 \u043d\u0430 \u0437\u0432\u0443\u043a\u0430 \u0432\u044a\u0432 \u0444\u043e\u0440\u043c\u0430\u0442 MP3",incorrect_try_again:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u043d\u043e. \u041e\u043f\u0438\u0442\u0430\u0439\u0442\u0435 \u043e\u0442\u043d\u043e\u0432\u043e.",image_alt_text:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430\u0442\u0430 \u0441 reCAPTCHA"},RecaptchaStr_bn={visual_challenge:"\u098f\u0995\u099f\u09bf \u09a6\u09c3\u09b6\u09cd\u09af\u09ae\u09be\u09a8 \u09aa\u09cd\u09b0\u09a4\u09bf\u09a6\u09cd\u09ac\u09a8\u09cd\u09a6\u09cd\u09ac\u09bf\u09a4\u09be \u09aa\u09be\u09a8",audio_challenge:"\u098f\u0995\u099f\u09bf \u0985\u09a1\u09bf\u0993 \u09aa\u09cd\u09b0\u09a4\u09bf\u09a6\u09cd\u09ac\u09a8\u09cd\u09a6\u09cd\u09ac\u09bf\u09a4\u09be  \u09aa\u09be\u09a8",refresh_btn:"\u098f\u0995\u099f\u09bf \u09a8\u09a4\u09c1\u09a8 \u09aa\u09cd\u09b0\u09a4\u09bf\u09a6\u09cd\u09ac\u09a8\u09cd\u09a6\u09cd\u09ac\u09bf\u09a4\u09be  \u09aa\u09be\u09a8",instructions_visual:"\u09b6\u09ac\u09cd\u09a6 \u09a6\u09c1\u099f\u09bf \u09b2\u09bf\u0996\u09c1\u09a8:",instructions_context:"\u09ac\u09be\u0995\u09cd\u09b8\u09c7 \u09b6\u09ac\u09cd\u09a6\u0997\u09c1\u09b2\u09bf \u099f\u09be\u0987\u09aa \u0995\u09b0\u09c1\u09a8:",instructions_audio:"\u0986\u09aa\u09a8\u09bf \u09af\u09be \u09b6\u09c1\u09a8\u099b\u09c7\u09a8 \u09a4\u09be \u09b2\u09bf\u0996\u09c1\u09a8:",help_btn:"\u09b8\u09b9\u09be\u09df\u09a4\u09be",play_again:"\u0986\u09ac\u09be\u09b0 \u09b8\u09be\u0989\u09a8\u09cd\u09a1 \u09aa\u09cd\u09b2\u09c7 \u0995\u09b0\u09c1\u09a8",cant_hear_this:"MP3 \u09b0\u09c2\u09aa\u09c7 \u09b6\u09ac\u09cd\u09a6 \u09a1\u09be\u0989\u09a8\u09b2\u09cb\u09a1 \u0995\u09b0\u09c1\u09a8",incorrect_try_again:"\u09ac\u09c7\u09a0\u09bf\u0995\u09f7 \u0986\u09ac\u09be\u09b0 \u099a\u09c7\u09b7\u09cd\u099f\u09be \u0995\u09b0\u09c1\u09a8\u09f7",image_alt_text:"reCAPTCHA \u099a\u09cd\u09af\u09be\u09b2\u09c7\u099e\u09cd\u099c \u099a\u09bf\u09a4\u09cd\u09b0"},RecaptchaStr_ca={visual_challenge:"Obt\u00e9n un repte visual",audio_challenge:"Obteniu una prova d'\u00e0udio",refresh_btn:"Obteniu una prova nova",instructions_visual:"Escriviu les dues paraules:",instructions_context:"Escriviu les paraules dels quadres:",instructions_audio:"Escriviu el que escolteu:",help_btn:"Ajuda",play_again:"Torna a reproduir el so",cant_hear_this:"Baixa el so com a MP3",incorrect_try_again:"No \u00e9s correcte. Torna-ho a provar.",image_alt_text:"Imatge del repte de reCAPTCHA"},RecaptchaStr_cs={visual_challenge:"Zobrazit vizu\u00e1ln\u00ed podobu v\u00fdrazu",audio_challenge:"P\u0159ehr\u00e1t zvukovou podobu v\u00fdrazu",refresh_btn:"Zobrazit nov\u00fd v\u00fdraz",instructions_visual:"Zadejte dv\u011b slova:",instructions_context:"Zadejte slova uveden\u00e1 v pol\u00edch:",instructions_audio:"Napi\u0161te, co jste sly\u0161eli:",help_btn:"N\u00e1pov\u011bda",play_again:"Znovu p\u0159ehr\u00e1t zvuk",cant_hear_this:"St\u00e1hnout zvuk ve form\u00e1tu MP3",incorrect_try_again:"\u0160patn\u011b. Zkuste to znovu.",image_alt_text:"Obr\u00e1zek reCAPTCHA"},RecaptchaStr_da={visual_challenge:"Hent en visuel udfordring",audio_challenge:"Hent en lydudfordring",refresh_btn:"Hent en ny udfordring",instructions_visual:"Indtast de to ord:",instructions_context:"Indtast ordene i felterne:",instructions_audio:"Indtast det, du h\u00f8rer:",help_btn:"Hj\u00e6lp",play_again:"Afspil lyden igen",cant_hear_this:"Download lyd som MP3",incorrect_try_again:"Forkert. Pr\u00f8v igen.",image_alt_text:"reCAPTCHA-udfordringsbillede"},RecaptchaStr_de={visual_challenge:"Captcha abrufen",audio_challenge:"Audio-Captcha abrufen",refresh_btn:"Neues Captcha abrufen",instructions_visual:"Geben Sie die 2 W\u00f6rter ein:",instructions_context:"Worte aus den Feldern eingeben:",instructions_audio:"Geben Sie das Geh\u00f6rte ein:",help_btn:"Hilfe",play_again:"Wort erneut abspielen",cant_hear_this:"Wort als MP3 herunterladen",incorrect_try_again:"Falsch. Bitte versuchen Sie es erneut.",image_alt_text:"reCAPTCHA-Bild"},RecaptchaStr_el={visual_challenge:"\u039f\u03c0\u03c4\u03b9\u03ba\u03ae \u03c0\u03c1\u03cc\u03ba\u03bb\u03b7\u03c3\u03b7",audio_challenge:"\u0397\u03c7\u03b7\u03c4\u03b9\u03ba\u03ae \u03c0\u03c1\u03cc\u03ba\u03bb\u03b7\u03c3\u03b7",refresh_btn:"\u039d\u03ad\u03b1 \u03c0\u03c1\u03cc\u03ba\u03bb\u03b7\u03c3\u03b7",instructions_visual:"\u03a0\u03bb\u03b7\u03ba\u03c4\u03c1\u03bf\u03bb\u03bf\u03b3\u03ae\u03c3\u03c4\u03b5 \u03c4\u03b9\u03c2 \u03bb\u03ad\u03be\u03b5\u03b9\u03c2:",instructions_context:"\u03a0\u03bb\u03b7\u03ba\u03c4\u03c1\u03bf\u03bb\u03bf\u03b3\u03ae\u03c3\u03c4\u03b5 \u03c4\u03b9\u03c2 \u03bb\u03ad\u03be\u03b5\u03b9\u03c2:",instructions_audio:"\u03a0\u03bb\u03b7\u03ba\u03c4\u03c1\u03bf\u03bb\u03bf\u03b3\u03ae\u03c3\u03c4\u03b5 \u03cc\u03c4\u03b9 \u03b1\u03ba\u03bf\u03cd\u03c4\u03b5:",help_btn:"\u0392\u03bf\u03ae\u03b8\u03b5\u03b9\u03b1",play_again:"\u0391\u03bd\u03b1\u03c0\u03b1\u03c1\u03b1\u03b3\u03c9\u03b3\u03ae \u03ae\u03c7\u03bf\u03c5 \u03be\u03b1\u03bd\u03ac",cant_hear_this:"\u039b\u03ae\u03c8\u03b7 \u03ae\u03c7\u03bf\u03c5 \u03c9\u03c2 \u039c\u03a13",incorrect_try_again:"\u039b\u03ac\u03b8\u03bf\u03c2. \u0394\u03bf\u03ba\u03b9\u03bc\u03ac\u03c3\u03c4\u03b5 \u03be\u03b1\u03bd\u03ac.",image_alt_text:"\u0395\u03b9\u03ba\u03cc\u03bd\u03b1 \u03c0\u03c1\u03cc\u03ba\u03bb\u03b7\u03c3\u03b7\u03c2 reCAPTCHA"},RecaptchaStr_es={visual_challenge:"Obtener una pista visual",audio_challenge:"Obtener una pista sonora",refresh_btn:"Obtener una pista nueva",instructions_visual:"Escribe las dos palabras:",instructions_context:"Escribe las palabras de los cuadros:",instructions_audio:"Escribe lo que oigas:",help_btn:"Ayuda",play_again:"Volver a reproducir el sonido",cant_hear_this:"Descargar el sonido en MP3",incorrect_try_again:"Incorrecto. Vu\u00e9lvelo a intentar.",image_alt_text:"Pista de imagen reCAPTCHA"},RecaptchaStr_es_419={visual_challenge:"Enfrentar un desaf\u00edo visual",audio_challenge:"Enfrentar un desaf\u00edo de audio",refresh_btn:"Enfrentar un nuevo desaf\u00edo",instructions_visual:"Tipea las dos palabras.",instructions_context:"Tipea las palabras en los cuadros",instructions_audio:"Tipea lo que escuchas:",help_btn:"Ayuda",play_again:"Reproducir sonido de nuevo",cant_hear_this:"Descargar sonido en formato MP3",incorrect_try_again:"Incorrecto. Vuelve a intentarlo.",image_alt_text:"Imagen del desaf\u00edo de la reCAPTCHA"},RecaptchaStr_et={visual_challenge:"Kuva kuvap\u00f5hine robotil\u00f5ks",audio_challenge:"Kuva helip\u00f5hine robotil\u00f5ks",refresh_btn:"Kuva uus robotil\u00f5ks",instructions_visual:"Tippige kaks s\u00f5na.",instructions_context:"Tippige kastides olevad s\u00f5nad.",instructions_audio:"Tippige, mida kuulete.",help_btn:"Abi",play_again:"Esita heli uuesti",cant_hear_this:"Laadi heli alla MP3-vormingus",incorrect_try_again:"Vale. Proovige uuesti.",image_alt_text:"reCAPTCHA robotil\u00f5ksu kujutis"},RecaptchaStr_eu={visual_challenge:"Eskuratu ikusizko erronka",audio_challenge:"Eskuratu audio-erronka",refresh_btn:"Eskuratu erronka berria",instructions_visual:"Idatzi bi hitzak:",instructions_context:"Idatzi koadroetako hitzak:",instructions_audio:"Idatzi entzuten duzuna:",help_btn:"Laguntza",play_again:"Erreproduzitu soinua berriro",cant_hear_this:"Deskargatu soinua MP3 gisa",incorrect_try_again:"Ez da zuzena. Saiatu berriro.",image_alt_text:"reCAPTCHA erronkaren irudia"},RecaptchaStr_fa={visual_challenge:"\u062f\u0631\u06cc\u0627\u0641\u062a \u06cc\u06a9 \u0645\u0639\u0645\u0627\u06cc \u062f\u06cc\u062f\u0627\u0631\u06cc",audio_challenge:"\u062f\u0631\u06cc\u0627\u0641\u062a \u06cc\u06a9 \u0645\u0639\u0645\u0627\u06cc \u0635\u0648\u062a\u06cc",refresh_btn:"\u062f\u0631\u06cc\u0627\u0641\u062a \u06cc\u06a9 \u0645\u0639\u0645\u0627\u06cc \u062c\u062f\u06cc\u062f",instructions_visual:"\u0627\u06cc\u0646 \u062f\u0648 \u06a9\u0644\u0645\u0647 \u0631\u0627 \u062a\u0627\u06cc\u067e \u06a9\u0646\u06cc\u062f:",instructions_context:"\u0648\u0627\u0698\u0647 \u0647\u0627\u06cc \u0645\u0648\u062c\u0648\u062f \u062f\u0631 \u06a9\u0627\u062f\u0631\u0647\u0627 \u0631\u0627 \u062a\u0627\u06cc\u067e \u06a9\u0646\u06cc\u062f:",instructions_audio:"\u0622\u0646\u0686\u0647 \u0631\u0627 \u06a9\u0647 \u0645\u06cc \u0634\u0646\u0648\u06cc\u062f \u062a\u0627\u06cc\u067e \u06a9\u0646\u06cc\u062f:",help_btn:"\u0631\u0627\u0647\u0646\u0645\u0627\u06cc\u06cc",play_again:"\u067e\u062e\u0634 \u0645\u062c\u062f\u062f \u0635\u062f\u0627",cant_hear_this:"\u062f\u0627\u0646\u0644\u0648\u062f \u0635\u062f\u0627 \u0628\u0647 \u0635\u0648\u0631\u062a MP3",incorrect_try_again:"\u0646\u0627\u062f\u0631\u0633\u062a. \u062f\u0648\u0628\u0627\u0631\u0647 \u0627\u0645\u062a\u062d\u0627\u0646 \u06a9\u0646\u06cc\u062f.",image_alt_text:""},RecaptchaStr_fi={visual_challenge:"Kuvavahvistus",audio_challenge:"\u00c4\u00e4nivahvistus",refresh_btn:"Uusi kuva",instructions_visual:"Kirjoita n\u00e4kem\u00e4si kaksi sanaa:",instructions_context:"Kirjoita n\u00e4kem\u00e4si sanat:",instructions_audio:"Kirjoita kuulemasi:",help_btn:"Ohje",play_again:"Toista \u00e4\u00e4ni uudelleen",cant_hear_this:"Lataa \u00e4\u00e4ni MP3-tiedostona",incorrect_try_again:"V\u00e4\u00e4rin. Yrit\u00e4 uudelleen.",image_alt_text:"reCAPTCHA-kuva"},RecaptchaStr_fil={visual_challenge:"Kumuha ng pagsubok na visual",audio_challenge:"Kumuha ng pagsubok na audio",refresh_btn:"Kumuha ng bagong pagsubok",instructions_visual:"I-type ang dalawang mga salita:",instructions_context:"I-type ang mga salita sa mga kahon:",instructions_audio:"I-type ang iyong narinig",help_btn:"Tulong",play_again:"I-play muli ang tunog",cant_hear_this:"I-download ang tunog bilang MP3",incorrect_try_again:"Hindi wasto. Muling subukan.",image_alt_text:"larawang panghamon ng reCAPTCHA"},RecaptchaStr_fr={visual_challenge:"Test visuel",audio_challenge:"Test audio",refresh_btn:"Nouveau test",instructions_visual:"Saisissez les deux mots :",instructions_context:"Saisissez les mots ci-dessus :",instructions_audio:"Qu'entendez-vous ?",help_btn:"Aide",play_again:"R\u00e9\u00e9couter",cant_hear_this:"T\u00e9l\u00e9charger l'audio au format MP3",incorrect_try_again:"Incorrect. Veuillez r\u00e9essayer.",image_alt_text:"Image reCAPTCHA"},RecaptchaStr_fr_ca={visual_challenge:"Obtenir un test visuel",audio_challenge:"Obtenir un test audio",refresh_btn:"Obtenir un nouveau test",instructions_visual:"Saisissez les deux mots :",instructions_context:"Tapez les mots dans les bo\u00eetes de texte\u00a0:",instructions_audio:"Qu'entendez-vous?",help_btn:"Aide",play_again:"Jouer le son de nouveau",cant_hear_this:"T\u00e9l\u00e9charger le son en format MP3",incorrect_try_again:"Erreur, essayez \u00e0 nouveau",image_alt_text:"Image reCAPTCHA"},RecaptchaStr_gl={visual_challenge:"Obter unha proba visual",audio_challenge:"Obter unha proba de audio",refresh_btn:"Obter unha proba nova",instructions_visual:"Escribe as d\u00faas palabras:",instructions_context:"Escribe as palabras nas caixas:",instructions_audio:"Escribe o que escoitas:",help_btn:"Axuda",play_again:"Reproducir o son de novo",cant_hear_this:"Descargar son como MP3",incorrect_try_again:"Incorrecto. T\u00e9ntao de novo.",image_alt_text:"Imaxe de proba de reCAPTCHA"},RecaptchaStr_gu={visual_challenge:"\u0a8f\u0a95 \u0aa6\u0ac3\u0ab6\u0acd\u0aaf\u0abe\u0aa4\u0acd\u0aae\u0a95 \u0aaa\u0aa1\u0a95\u0abe\u0ab0 \u0aae\u0ac7\u0ab3\u0ab5\u0acb",audio_challenge:"\u0a8f\u0a95 \u0a91\u0aa1\u0abf\u0a93 \u0aaa\u0aa1\u0a95\u0abe\u0ab0 \u0aae\u0ac7\u0ab3\u0ab5\u0acb",refresh_btn:"\u0a8f\u0a95 \u0aa8\u0ab5\u0acb \u0aaa\u0aa1\u0a95\u0abe\u0ab0 \u0aae\u0ac7\u0ab3\u0ab5\u0acb",instructions_visual:"\u0aac\u0ac7 \u0ab6\u0aac\u0acd\u0aa6 \u0ab2\u0a96\u0acb:",instructions_context:"\u0aac\u0ac9\u0a95\u0acd\u0ab8\u0aae\u0abe\u0a82 \u0ab6\u0aac\u0acd\u0aa6\u0acb \u0ab2\u0a96\u0acb:",instructions_audio:"\u0aa4\u0aae\u0ac7 \u0a9c\u0ac7 \u0ab8\u0abe\u0a82\u0aad\u0ab3\u0acb \u0a9b\u0acb \u0aa4\u0ac7 \u0ab2\u0a96\u0acb:",help_btn:"\u0ab8\u0ab9\u0abe\u0aaf",play_again:"\u0aa7\u0acd\u0ab5\u0aa8\u0abf \u0aab\u0ab0\u0ac0\u0aa5\u0ac0 \u0a9a\u0ab2\u0abe\u0ab5\u0acb",cant_hear_this:"MP3 \u0aa4\u0ab0\u0ac0\u0a95\u0ac7 \u0aa7\u0acd\u0ab5\u0aa8\u0abf\u0aa8\u0ac7 \u0aa1\u0abe\u0a89\u0aa8\u0ab2\u0acb\u0aa1 \u0a95\u0ab0\u0acb",incorrect_try_again:"\u0a96\u0acb\u0a9f\u0ac1\u0a82. \u0aab\u0ab0\u0ac0 \u0aaa\u0acd\u0ab0\u0aaf\u0abe\u0ab8 \u0a95\u0ab0\u0acb.",image_alt_text:"reCAPTCHA \u0aaa\u0aa1\u0a95\u0abe\u0ab0 \u0a9b\u0aac\u0ac0"},RecaptchaStr_hi={visual_challenge:"\u0915\u094b\u0908 \u0935\u093f\u091c\u0941\u0905\u0932 \u091a\u0941\u0928\u094c\u0924\u0940 \u0932\u0947\u0902",audio_challenge:"\u0915\u094b\u0908 \u0911\u0921\u093f\u092f\u094b \u091a\u0941\u0928\u094c\u0924\u0940 \u0932\u0947\u0902",refresh_btn:"\u0915\u094b\u0908 \u0928\u0908 \u091a\u0941\u0928\u094c\u0924\u0940 \u0932\u0947\u0902",instructions_visual:"\u0926\u094b \u0936\u092c\u094d\u200d\u0926 \u0932\u093f\u0916\u0947\u0902:",instructions_context:"\u0936\u092c\u094d\u200d\u0926\u094b\u0902 \u0915\u094b \u092c\u0949\u0915\u094d\u200d\u0938 \u092e\u0947\u0902 \u0932\u093f\u0916\u0947\u0902:",instructions_audio:"\u091c\u094b \u0906\u092a \u0938\u0941\u0928 \u0930\u0939\u0947 \u0939\u0948\u0902 \u0909\u0938\u0947 \u0932\u093f\u0916\u0947\u0902:",help_btn:"\u0938\u0939\u093e\u092f\u0924\u093e",play_again:"\u0927\u094d\u200d\u0935\u0928\u093f \u092a\u0941\u0928: \u091a\u0932\u093e\u090f\u0902",cant_hear_this:"\u0927\u094d\u200d\u0935\u0928\u093f \u0915\u094b MP3 \u0915\u0947 \u0930\u0942\u092a \u092e\u0947\u0902 \u0921\u093e\u0909\u0928\u0932\u094b\u0921 \u0915\u0930\u0947\u0902",incorrect_try_again:"\u0917\u0932\u0924. \u092a\u0941\u0928: \u092a\u094d\u0930\u092f\u093e\u0938 \u0915\u0930\u0947\u0902.",image_alt_text:"reCAPTCHA \u091a\u0941\u0928\u094c\u0924\u0940 \u091b\u0935\u093f"},RecaptchaStr_hr={visual_challenge:"Dohvati vizualni upit",audio_challenge:"Dohvati zvu\u010dni upit",refresh_btn:"Dohvati novi upit",instructions_visual:"Upi\u0161ite obje rije\u010di:",instructions_context:"Upi\u0161ite rije\u010di u okvire:",instructions_audio:"Upi\u0161ite \u0161to \u010dujete:",help_btn:"Pomo\u0107",play_again:"Ponovi zvuk",cant_hear_this:"Preuzmi zvuk u MP3 formatu",incorrect_try_again:"Nije to\u010dno. Poku\u0161ajte ponovno.",image_alt_text:"Slikovni izazov reCAPTCHA"},RecaptchaStr_hu={visual_challenge:"Vizu\u00e1lis kih\u00edv\u00e1s k\u00e9r\u00e9se",audio_challenge:"Hangkih\u00edv\u00e1s k\u00e9r\u00e9se",refresh_btn:"\u00daj kih\u00edv\u00e1s k\u00e9r\u00e9se",instructions_visual:"Adja meg a k\u00e9t sz\u00f3t:",instructions_context:"\u00cdrja be a szavakat a mez\u0151kbe:",instructions_audio:"\u00cdrja le, amit hall:",help_btn:"S\u00fag\u00f3",play_again:"Hang ism\u00e9telt lej\u00e1tsz\u00e1sa",cant_hear_this:"Hang let\u00f6lt\u00e9se MP3 form\u00e1tumban",incorrect_try_again:"Hib\u00e1s. Pr\u00f3b\u00e1lkozzon \u00fajra.",image_alt_text:"reCAPTCHA ellen\u0151rz\u0151 k\u00e9p"},RecaptchaStr_hy={visual_challenge:"\u054d\u057f\u0561\u0576\u0561\u056c \u057f\u0565\u057d\u0578\u0572\u0561\u056f\u0561\u0576 \u056d\u0576\u0564\u056b\u0580",audio_challenge:"\u054d\u057f\u0561\u0576\u0561\u056c \u0571\u0561\u0575\u0576\u0561\u0575\u056b\u0576 \u056d\u0576\u0564\u056b\u0580",refresh_btn:"\u054d\u057f\u0561\u0576\u0561\u056c \u0576\u0578\u0580 \u056d\u0576\u0564\u056b\u0580",instructions_visual:"\u0544\u0578\u0582\u057f\u0584\u0561\u0563\u0580\u0565\u0584 \u0561\u0575\u057d \u0565\u0580\u056f\u0578\u0582 \u0562\u0561\u057c\u0565\u0580\u0568\u055d",instructions_context:"\u0544\u0578\u0582\u057f\u0584\u0561\u0563\u0580\u0565\u0584 \u0562\u0561\u057c\u0565\u0580\u0568 \u057f\u0578\u0582\u0583\u0565\u0580\u0578\u0582\u0574\u055d",instructions_audio:"\u0544\u0578\u0582\u057f\u0584\u0561\u0563\u0580\u0565\u0584 \u0561\u0575\u0576, \u056b\u0576\u0579 \u056c\u057d\u0578\u0582\u0574 \u0565\u0584\u055d",help_btn:"\u0555\u0563\u0576\u0578\u0582\u0569\u0575\u0578\u0582\u0576",play_again:"\u0546\u057e\u0561\u0563\u0561\u0580\u056f\u0565\u056c \u0571\u0561\u0575\u0576\u0568 \u056f\u0580\u056f\u056b\u0576",cant_hear_this:"\u0532\u0565\u057c\u0576\u0565\u056c \u0571\u0561\u0575\u0576\u0568 \u0578\u0580\u057a\u0565\u057d MP3",incorrect_try_again:"\u054d\u056d\u0561\u056c \u0567: \u0553\u0578\u0580\u0571\u0565\u0584 \u056f\u0580\u056f\u056b\u0576:",image_alt_text:""},RecaptchaStr_id={visual_challenge:"Dapatkan kata pengujian berbentuk visual",audio_challenge:"Dapatkan kata pengujian berbentuk audio",refresh_btn:"Dapatkan kata pengujian baru",instructions_visual:"Ketik dua kata ini:",instructions_context:"Ketik kata di dalam kotak:",instructions_audio:"Ketik yang Anda dengar:",help_btn:"Bantuan",play_again:"Putar suara sekali lagi",cant_hear_this:"Unduh suara sebagai MP3",incorrect_try_again:"Salah. Coba lagi.",image_alt_text:"Gambar tantangan reCAPTCHA"},RecaptchaStr_is={visual_challenge:"F\u00e1 a\u00f0gangspr\u00f3f sem mynd",audio_challenge:"F\u00e1 hlj\u00f3\u00f0pr\u00f3f",refresh_btn:"F\u00e1 n\u00fdtt a\u00f0gangspr\u00f3f",instructions_visual:"Sl\u00e1\u00f0u inn \u00feessi tv\u00f6 or\u00f0:",instructions_context:"Sl\u00e1\u00f0u or\u00f0in inn \u00ed reitina:",instructions_audio:"Sl\u00e1\u00f0u inn \u00fea\u00f0 sem \u00fe\u00fa heyrir:",help_btn:"Hj\u00e1lp",play_again:"Spila hlj\u00f3\u00f0 aftur",cant_hear_this:"S\u00e6kja hlj\u00f3\u00f0 sem MP3",incorrect_try_again:"Rangt. Reyndu aftur.",image_alt_text:"mynd reCAPTCHA a\u00f0gangspr\u00f3fs"},RecaptchaStr_it={visual_challenge:"Verifica visiva",audio_challenge:"Verifica audio",refresh_btn:"Nuova verifica",instructions_visual:"Digita le due parole:",instructions_context:"Digita le parole nelle caselle:",instructions_audio:"Digita ci\u00f2 che senti:",help_btn:"Guida",play_again:"Riproduci di nuovo audio",cant_hear_this:"Scarica audio in MP3",incorrect_try_again:"Sbagliato. Riprova.",image_alt_text:"Immagine di verifica reCAPTCHA"},RecaptchaStr_iw={visual_challenge:"\u05e7\u05d1\u05dc \u05d0\u05ea\u05d2\u05e8 \u05d7\u05d6\u05d5\u05ea\u05d9",audio_challenge:"\u05e7\u05d1\u05dc \u05d0\u05ea\u05d2\u05e8 \u05e9\u05de\u05e2",refresh_btn:"\u05e7\u05d1\u05dc \u05d0\u05ea\u05d2\u05e8 \u05d7\u05d3\u05e9",instructions_visual:"\u05d4\u05e7\u05dc\u05d3 \u05d0\u05ea \u05e9\u05ea\u05d9 \u05d4\u05de\u05d9\u05dc\u05d9\u05dd:",instructions_context:"\u05d4\u05e7\u05dc\u05d3 \u05d0\u05ea \u05d4\u05de\u05d9\u05dc\u05d9\u05dd \u05d1\u05ea\u05d9\u05d1\u05d5\u05ea:",instructions_audio:"\u05d4\u05e7\u05dc\u05d3 \u05d0\u05ea \u05de\u05d4 \u05e9\u05d0\u05ea\u05d4 \u05e9\u05d5\u05de\u05e2:",help_btn:"\u05e2\u05d6\u05e8\u05d4",play_again:"\u05d4\u05e4\u05e2\u05dc \u05e9\u05d5\u05d1 \u05d0\u05ea \u05d4\u05e9\u05de\u05e2",cant_hear_this:"\u05d4\u05d5\u05e8\u05d3 \u05e9\u05de\u05e2 \u05db-3MP",incorrect_try_again:"\u05e9\u05d2\u05d5\u05d9. \u05e0\u05e1\u05d4 \u05e9\u05d5\u05d1.",image_alt_text:"\u05ea\u05de\u05d5\u05e0\u05ea \u05d0\u05ea\u05d2\u05e8 \u05e9\u05dc reCAPTCHA"},RecaptchaStr_ja={visual_challenge:"\u753b\u50cf\u3067\u78ba\u8a8d\u3057\u307e\u3059",audio_challenge:"\u97f3\u58f0\u3067\u78ba\u8a8d\u3057\u307e\u3059",refresh_btn:"\u5225\u306e\u5358\u8a9e\u3067\u3084\u308a\u76f4\u3057\u307e\u3059",instructions_visual:"2 \u3064\u306e\u5358\u8a9e\u3092\u5165\u529b\u3057\u307e\u3059:",instructions_context:"\u30dc\u30c3\u30af\u30b9\u5185\u306e\u5358\u8a9e\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044:",instructions_audio:"\u805e\u3053\u3048\u305f\u5358\u8a9e\u3092\u5165\u529b\u3057\u307e\u3059:",help_btn:"\u30d8\u30eb\u30d7",play_again:"\u3082\u3046\u4e00\u5ea6\u805e\u304f",cant_hear_this:"MP3 \u3067\u97f3\u58f0\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9",incorrect_try_again:"\u6b63\u3057\u304f\u3042\u308a\u307e\u305b\u3093\u3002\u3082\u3046\u4e00\u5ea6\u3084\u308a\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002",image_alt_text:"reCAPTCHA \u78ba\u8a8d\u7528\u753b\u50cf"},RecaptchaStr_kn={visual_challenge:"\u0ca6\u0cc3\u0cb6\u0ccd\u0caf \u0cb8\u0cb5\u0cbe\u0cb2\u0cca\u0c82\u0ca6\u0ca8\u0ccd\u0ca8\u0cc1 \u0cb8\u0ccd\u0cb5\u0cc0\u0c95\u0cb0\u0cbf\u0cb8\u0cbf",audio_challenge:"\u0c86\u0ca1\u0cbf\u0caf\u0ccb \u0cb8\u0cb5\u0cbe\u0cb2\u0cca\u0c82\u0ca6\u0ca8\u0ccd\u0ca8\u0cc1 \u0cb8\u0ccd\u0cb5\u0cc0\u0c95\u0cb0\u0cbf\u0cb8\u0cbf",refresh_btn:"\u0cb9\u0cca\u0cb8 \u0cb8\u0cb5\u0cbe\u0cb2\u0cca\u0c82\u0ca6\u0ca8\u0ccd\u0ca8\u0cc1 \u0caa\u0ca1\u0cc6\u0caf\u0cbf\u0cb0\u0cbf",instructions_visual:"\u0c8e\u0cb0\u0ca1\u0cc1 \u0caa\u0ca6\u0c97\u0cb3\u0ca8\u0ccd\u0ca8\u0cc1 \u0c9f\u0cc8\u0caa\u0ccd \u0cae\u0cbe\u0ca1\u0cbf:",instructions_context:"\u0cac\u0cbe\u0c95\u0ccd\u0cb8\u0ccd\u200c\u0ca8\u0cb2\u0ccd\u0cb2\u0cbf \u0caa\u0ca6\u0c97\u0cb3\u0ca8\u0ccd\u0ca8\u0cc1 \u0c9f\u0cc8\u0caa\u0ccd\u200c \u0cae\u0cbe\u0ca1\u0cbf:",instructions_audio:"\u0ca8\u0cbf\u0cae\u0c97\u0cc6 \u0c95\u0cc7\u0cb3\u0cbf\u0cb8\u0cc1\u0cb5\u0cc1\u0ca6\u0ca8\u0ccd\u0ca8\u0cc1 \u0c9f\u0cc8\u0caa\u0ccd\u200c \u0cae\u0cbe\u0ca1\u0cbf:",help_btn:"\u0cb8\u0cb9\u0cbe\u0caf",play_again:"\u0ca7\u0ccd\u0cb5\u0ca8\u0cbf\u0caf\u0ca8\u0ccd\u0ca8\u0cc1 \u0cae\u0ca4\u0ccd\u0ca4\u0cc6 \u0caa\u0ccd\u0cb2\u0cc7 \u0cae\u0cbe\u0ca1\u0cbf",cant_hear_this:"\u0ca7\u0ccd\u0cb5\u0ca8\u0cbf\u0caf\u0ca8\u0ccd\u0ca8\u0cc1 MP3 \u0cb0\u0cc2\u0caa\u0ca6\u0cb2\u0ccd\u0cb2\u0cbf \u0ca1\u0ccc\u0ca8\u0ccd\u200c\u0cb2\u0ccb\u0ca1\u0ccd \u0cae\u0cbe\u0ca1\u0cbf",incorrect_try_again:"\u0ca4\u0caa\u0ccd\u0caa\u0cbe\u0c97\u0cbf\u0ca6\u0cc6. \u0cae\u0ca4\u0ccd\u0ca4\u0cca\u0cae\u0ccd\u0cae\u0cc6 \u0caa\u0ccd\u0cb0\u0caf\u0ca4\u0ccd\u0ca8\u0cbf\u0cb8\u0cbf.",image_alt_text:"reCAPTCHA \u0cb8\u0cb5\u0cbe\u0cb2\u0cc1 \u0c9a\u0cbf\u0ca4\u0ccd\u0cb0"},RecaptchaStr_ko={visual_challenge:"\uadf8\ub9bc\uc73c\ub85c \ubcf4\uc548\ubb38\uc790 \ubc1b\uae30",audio_challenge:"\uc74c\uc131\uc73c\ub85c \ubcf4\uc548\ubb38\uc790 \ubc1b\uae30",refresh_btn:"\ubcf4\uc548\ubb38\uc790 \uc0c8\ub85c \ubc1b\uae30",instructions_visual:"\ub450 \ub2e8\uc5b4 \uc785\ub825:",instructions_context:"\uc785\ub825\ub780\uc5d0 \ub2e8\uc5b4 \uc785\ub825:",instructions_audio:"\uc74c\uc131 \ubcf4\uc548\ubb38\uc790 \uc785\ub825:",help_btn:"\ub3c4\uc6c0\ub9d0",play_again:"\uc74c\uc131 \ub2e4\uc2dc \ub4e3\uae30",cant_hear_this:"\uc74c\uc131\uc744 MP3\ub85c \ub2e4\uc6b4\ub85c\ub4dc",incorrect_try_again:"\ud2c0\ub838\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574 \uc8fc\uc138\uc694.",image_alt_text:"reCAPTCHA \uc694\uccad \uc774\ubbf8\uc9c0"},RecaptchaStr_lt={visual_challenge:"Gauti vaizdin\u012f atpa\u017einimo test\u0105",audio_challenge:"Gauti garso atpa\u017einimo test\u0105",refresh_btn:"Gauti nauj\u0105 atpa\u017einimo test\u0105",instructions_visual:"\u012eveskite du \u017eod\u017eius:",instructions_context:"\u012eveskite \u017eod\u017eius laukeliuose:",instructions_audio:"\u012eveskite tai, k\u0105 girdite:",help_btn:"Pagalba",play_again:"Dar kart\u0105 paleisti gars\u0105",cant_hear_this:"Atsisi\u0173sti gars\u0105 kaip MP3",incorrect_try_again:"Neteisingai. Bandykite dar kart\u0105.",image_alt_text:"Testo \u201ereCAPTCHA\u201c vaizdas"},RecaptchaStr_lv={visual_challenge:"Sa\u0146emt vizu\u0101lu izaicin\u0101jumu",audio_challenge:"Sa\u0146emt audio izaicin\u0101jumu",refresh_btn:"Sa\u0146emt jaunu izaicin\u0101jumu",instructions_visual:"Ierakstiet divus v\u0101rdus:",instructions_context:"Ierakstiet v\u0101rdus lodzi\u0146os:",instructions_audio:"Ierakstiet dzirdamo:",help_btn:"Pal\u012bdz\u012bba",play_again:"V\u0113lreiz atska\u0146ot ska\u0146u",cant_hear_this:"Lejupiel\u0101d\u0113t ska\u0146u MP3\u00a0form\u0101t\u0101",incorrect_try_again:"Nepareizi. M\u0113\u0123iniet v\u0113lreiz.",image_alt_text:"reCAPTCHA izaicin\u0101juma att\u0113ls"},RecaptchaStr_ml={visual_challenge:"\u0d12\u0d30\u0d41 \u0d26\u0d43\u0d36\u0d4d\u0d2f \u0d1a\u0d32\u0d1e\u0d4d\u0d1a\u0d4d \u0d28\u0d47\u0d1f\u0d41\u0d15",audio_challenge:"\u0d12\u0d30\u0d41 \u0d13\u0d21\u0d3f\u0d2f\u0d4b \u0d1a\u0d32\u0d1e\u0d4d\u0d1a\u0d4d \u0d28\u0d47\u0d1f\u0d41\u0d15",refresh_btn:"\u0d12\u0d30\u0d41 \u0d2a\u0d41\u0d24\u0d3f\u0d2f \u0d1a\u0d32\u0d1e\u0d4d\u0d1a\u0d4d \u0d28\u0d47\u0d1f\u0d41\u0d15",instructions_visual:"\u0d30\u0d23\u0d4d\u0d1f\u0d4d \u0d2a\u0d26\u0d19\u0d4d\u0d19\u0d7e \u0d1f\u0d48\u0d2a\u0d4d\u0d2a\u0d4d \u0d1a\u0d46\u0d2f\u0d4d\u0d2f\u0d41\u0d15:",instructions_context:"\u0d2c\u0d4b\u0d15\u0d4d\u200c\u0d38\u0d41\u0d15\u0d33\u0d3f\u0d32\u0d46 \u0d2a\u0d26\u0d19\u0d4d\u0d19\u0d7e \u0d1f\u0d48\u0d2a\u0d4d\u0d2a\u0d41\u0d1a\u0d46\u0d2f\u0d4d\u0d2f\u0d41\u0d15:",instructions_audio:"\u0d15\u0d47\u0d7e\u0d15\u0d4d\u0d15\u0d41\u0d28\u0d4d\u0d28\u0d24\u0d4d \u0d1f\u0d48\u0d2a\u0d4d\u0d2a\u0d4d \u0d1a\u0d46\u0d2f\u0d4d\u0d2f\u0d42:",help_btn:"\u0d38\u0d39\u0d3e\u0d2f\u0d02",play_again:"\u0d36\u0d2c\u0d4d\u200c\u0d26\u0d02 \u0d35\u0d40\u0d23\u0d4d\u0d1f\u0d41\u0d02 \u0d2a\u0d4d\u0d32\u0d47 \u0d1a\u0d46\u0d2f\u0d4d\u0d2f\u0d41\u0d15",cant_hear_this:"\u0d36\u0d2c\u0d4d\u200c\u0d26\u0d02 MP3 \u0d06\u0d2f\u0d3f \u0d21\u0d57\u0d7a\u0d32\u0d4b\u0d21\u0d4d \u0d1a\u0d46\u0d2f\u0d4d\u0d2f\u0d41\u0d15",incorrect_try_again:"\u0d24\u0d46\u0d31\u0d4d\u0d31\u0d3e\u0d23\u0d4d. \u0d35\u0d40\u0d23\u0d4d\u0d1f\u0d41\u0d02 \u0d36\u0d4d\u0d30\u0d2e\u0d3f\u0d15\u0d4d\u0d15\u0d41\u0d15.",image_alt_text:"reCAPTCHA \u0d1a\u0d32\u0d1e\u0d4d\u0d1a\u0d4d \u0d07\u0d2e\u0d47\u0d1c\u0d4d"},RecaptchaStr_mr={visual_challenge:"\u0926\u0943\u0936\u094d\u200d\u092f\u092e\u093e\u0928 \u0906\u0935\u094d\u0939\u093e\u0928 \u092a\u094d\u0930\u093e\u092a\u094d\u0924 \u0915\u0930\u093e",audio_challenge:"\u0911\u0921\u0940\u0913 \u0906\u0935\u094d\u0939\u093e\u0928 \u092a\u094d\u0930\u093e\u092a\u094d\u0924 \u0915\u0930\u093e",refresh_btn:"\u090f\u0915 \u0928\u0935\u0940\u0928 \u0906\u0935\u094d\u0939\u093e\u0928 \u092a\u094d\u0930\u093e\u092a\u094d\u0924 \u0915\u0930\u093e",instructions_visual:"\u0926\u094b\u0928 \u0936\u092c\u094d\u0926 \u091f\u093e\u0907\u092a \u0915\u0930\u093e:",instructions_context:"\u092c\u0949\u0915\u094d\u200d\u0938\u0947\u0938\u092e\u0927\u0940\u0932 \u0936\u092c\u094d\u200d\u0926 \u091f\u093e\u0907\u092a \u0915\u0930\u093e:",instructions_audio:"\u0906\u092a\u0932\u094d\u092f\u093e\u0932\u093e \u091c\u0947 \u0910\u0915\u0942 \u092f\u0947\u0908\u0932 \u0924\u0947 \u091f\u093e\u0907\u092a \u0915\u0930\u093e:",help_btn:"\u092e\u0926\u0924",play_again:"\u0927\u094d\u200d\u0935\u0928\u0940 \u092a\u0941\u0928\u094d\u0939\u093e \u092a\u094d\u200d\u0932\u0947 \u0915\u0930\u093e",cant_hear_this:"MP3 \u0930\u0941\u092a\u093e\u0924 \u0927\u094d\u200d\u0935\u0928\u0940 \u0921\u093e\u0909\u0928\u0932\u094b\u0921 \u0915\u0930\u093e",incorrect_try_again:"\u0905\u092f\u094b\u0917\u094d\u200d\u092f. \u092a\u0941\u0928\u094d\u200d\u0939\u093e \u092a\u094d\u0930\u092f\u0924\u094d\u200d\u0928 \u0915\u0930\u093e.",image_alt_text:"reCAPTCHA \u0906\u0935\u094d\u200d\u0939\u093e\u0928 \u092a\u094d\u0930\u0924\u093f\u092e\u093e"},RecaptchaStr_ms={visual_challenge:"Dapatkan cabaran visual",audio_challenge:"Dapatkan cabaran audio",refresh_btn:"Dapatkan cabaran baru",instructions_visual:"Taip kedua-dua perkataan:",instructions_context:"Taip perkataan dalam kotak:",instructions_audio:"Taip apa yang didengari:",help_btn:"Bantuan",play_again:"Mainkan bunyi sekali lagi",cant_hear_this:"Muat turun bunyi sebagai MP3",incorrect_try_again:"Tidak betul. Cuba lagi.",image_alt_text:"Imej cabaran reCAPTCHA"},RecaptchaStr_nl={visual_challenge:"Een visuele uitdaging proberen",audio_challenge:"Een audio-uitdaging proberen",refresh_btn:"Een nieuwe uitdaging proberen",instructions_visual:"Typ de twee woorden:",instructions_context:"Typ de woorden in de vakken:",instructions_audio:"Typ wat u hoort:",help_btn:"Help",play_again:"Geluid opnieuw afspelen",cant_hear_this:"Geluid downloaden als MP3",incorrect_try_again:"Onjuist. Probeer het opnieuw.",image_alt_text:"reCAPTCHA-uitdagingsafbeelding"},RecaptchaStr_no={visual_challenge:"F\u00e5 en bildeutfordring",audio_challenge:"F\u00e5 en lydutfordring",refresh_btn:"F\u00e5 en ny utfordring",instructions_visual:"Skriv inn de to ordene:",instructions_context:"Skriv inn ordene i feltene:",instructions_audio:"Skriv inn det du h\u00f8rer:",help_btn:"Hjelp",play_again:"Spill av lyd p\u00e5 nytt",cant_hear_this:"Last ned lyd som MP3",incorrect_try_again:"Feil. Pr\u00f8v p\u00e5 nytt.",image_alt_text:"reCAPTCHA-utfordringsbilde"},RecaptchaStr_pl={visual_challenge:"Poka\u017c podpowied\u017a wizualn\u0105",audio_challenge:"Odtw\u00f3rz podpowied\u017a d\u017awi\u0119kow\u0105",refresh_btn:"Nowa podpowied\u017a",instructions_visual:"Wpisz oba wyrazy:",instructions_context:"Wpisz s\u0142owa wy\u015bwietlane w polach:",instructions_audio:"Wpisz us\u0142yszane s\u0142owa:",help_btn:"Pomoc",play_again:"Odtw\u00f3rz d\u017awi\u0119k ponownie",cant_hear_this:"Pobierz d\u017awi\u0119k jako plik MP3",incorrect_try_again:"Nieprawid\u0142owo. Spr\u00f3buj ponownie.",image_alt_text:"Zadanie obrazkowe reCAPTCHA"},RecaptchaStr_pt={visual_challenge:"Obter um desafio visual",audio_challenge:"Obter um desafio de \u00e1udio",refresh_btn:"Obter um novo desafio",instructions_visual:"Digite as duas palavras:",instructions_context:"Digite as palavras das caixas:",instructions_audio:"Digite o que voc\u00ea ouve:",help_btn:"Ajuda",play_again:"Reproduzir som novamente",cant_hear_this:"Fazer download do som no formato MP3",incorrect_try_again:"Incorreto. Tente novamente.",image_alt_text:"Imagem de desafio reCAPTCHA"},RecaptchaStr_pt_pt={visual_challenge:"Obter um desafio visual",audio_challenge:"Obter um desafio de \u00e1udio",refresh_btn:"Obter um novo desafio",instructions_visual:"Escreva as duas palavras:",instructions_context:"Escreva as palavras nas caixas:",instructions_audio:"Escreva o que ouvir:",help_btn:"Ajuda",play_again:"Reproduzir som novamente",cant_hear_this:"Transferir som como MP3",incorrect_try_again:"Incorreto. Tente novamente.",image_alt_text:"Imagem de desafio reCAPTCHA"},RecaptchaStr_ro={visual_challenge:"Ob\u0163ine\u0163i un cod captcha vizual",audio_challenge:"Ob\u0163ine\u0163i un cod captcha audio",refresh_btn:"Ob\u0163ine\u0163i un nou cod captcha",instructions_visual:"Introduce\u0163i cele dou\u0103 cuvinte:",instructions_context:"Introduce\u0163i cuvintele \u00een casete:",instructions_audio:"Introduce\u0163i ceea ce auzi\u0163i:",help_btn:"Ajutor",play_again:"Reda\u0163i sunetul din nou",cant_hear_this:"Desc\u0103rca\u0163i fi\u015fierul audio ca MP3",incorrect_try_again:"Incorect. \u00cencerca\u0163i din nou.",image_alt_text:"Imagine de verificare reCAPTCHA"},RecaptchaStr_ru={visual_challenge:"\u0412\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u0430\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430",audio_challenge:"\u0417\u0432\u0443\u043a\u043e\u0432\u0430\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430",refresh_btn:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c",instructions_visual:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u043e, \u0447\u0442\u043e \u0432\u0438\u0434\u0438\u0442\u0435:",instructions_context:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043b\u043e\u0432\u0430:",instructions_audio:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u043e, \u0447\u0442\u043e \u0441\u043b\u044b\u0448\u0438\u0442\u0435:",help_btn:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430",play_again:"\u041f\u0440\u043e\u0441\u043b\u0443\u0448\u0430\u0442\u044c \u0435\u0449\u0435 \u0440\u0430\u0437",cant_hear_this:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c MP3-\u0444\u0430\u0439\u043b",incorrect_try_again:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e. \u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u043e\u043f\u044b\u0442\u043a\u0443.",image_alt_text:"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e \u0441\u043b\u043e\u0432\u0443 reCAPTCHA"},RecaptchaStr_sk={visual_challenge:"Zobrazi\u0165 vizu\u00e1lnu podobu",audio_challenge:"Prehra\u0165 zvukov\u00fa podobu",refresh_btn:"Zobrazi\u0165 nov\u00fd v\u00fdraz",instructions_visual:"Zadajte tieto dve slov\u00e1:",instructions_context:"Zadajte slov\u00e1 v poliach:",instructions_audio:"Zadajte, \u010do po\u010dujete:",help_btn:"Pomocn\u00edk",play_again:"Znova prehra\u0165 zvuk",cant_hear_this:"Prevzia\u0165 zvuk v podobe s\u00faboru MP3",incorrect_try_again:"Nespr\u00e1vne. Sk\u00faste to znova.",image_alt_text:"Obr\u00e1zok zadania reCAPTCHA"},RecaptchaStr_sl={visual_challenge:"Vizualni preskus",audio_challenge:"Zvo\u010dni preskus",refresh_btn:"Nov preskus",instructions_visual:"Vnesite besedi:",instructions_context:"Vnesite besede v okvir\u010dkih:",instructions_audio:"Natipkajte, kaj sli\u0161ite:",help_btn:"Pomo\u010d",play_again:"Znova predvajaj zvok",cant_hear_this:"Prenesi zvok kot MP3",incorrect_try_again:"Napa\u010dno. Poskusite znova.",image_alt_text:"Slika izziva reCAPTCHA"},RecaptchaStr_sr={visual_challenge:"\u041f\u0440\u0438\u043c\u0438\u0442\u0435 \u0432\u0438\u0437\u0443\u0435\u043b\u043d\u0438 \u0443\u043f\u0438\u0442",audio_challenge:"\u041f\u0440\u0438\u043c\u0438\u0442\u0435 \u0430\u0443\u0434\u0438\u043e \u0443\u043f\u0438\u0442",refresh_btn:"\u041f\u0440\u0438\u043c\u0438\u0442\u0435 \u043d\u043e\u0432\u0438 \u0443\u043f\u0438\u0442",instructions_visual:"\u041e\u0442\u043a\u0443\u0446\u0430\u0458\u0442\u0435 \u0434\u0432\u0435 \u0440\u0435\u0447\u0438:",instructions_context:"\u0423\u043a\u0443\u0446\u0430\u0458\u0442\u0435 \u0440\u0435\u0447\u0438 \u0443 \u043f\u043e\u0459\u0430:",instructions_audio:"\u041e\u0442\u043a\u0443\u0446\u0430\u0458\u0442\u0435 \u043e\u043d\u043e \u0448\u0442\u043e \u0447\u0443\u0458\u0435\u0442\u0435:",help_btn:"\u041f\u043e\u043c\u043e\u045b",play_again:"\u041f\u043e\u043d\u043e\u0432\u043e \u043f\u0443\u0441\u0442\u0438 \u0437\u0432\u0443\u043a",cant_hear_this:"\u041f\u0440\u0435\u0443\u0437\u043c\u0438 \u0437\u0432\u0443\u043a \u043a\u0430\u043e MP3 \u0441\u043d\u0438\u043c\u0430\u043a",incorrect_try_again:"\u041d\u0435\u0442\u0430\u0447\u043d\u043e. \u041f\u043e\u043a\u0443\u0448\u0430\u0458\u0442\u0435 \u043f\u043e\u043d\u043e\u0432\u043e.",image_alt_text:"\u0421\u043b\u0438\u043a\u0430 reCAPTCHA \u043f\u0440\u043e\u0432\u0435\u0440\u0435"},RecaptchaStr_sv={visual_challenge:"H\u00e4mta captcha i bildformat",audio_challenge:"H\u00e4mta captcha i ljudformat",refresh_btn:"H\u00e4mta ny captcha",instructions_visual:"Skriv b\u00e5da orden:",instructions_context:"Skriv orden i rutorna:",instructions_audio:"Skriv det du h\u00f6r:",help_btn:"Hj\u00e4lp",play_again:"Spela upp ljudet igen",cant_hear_this:"H\u00e4mta ljud som MP3",incorrect_try_again:"Fel. F\u00f6rs\u00f6k igen.",image_alt_text:"reCAPTCHA-bild"},RecaptchaStr_sw={visual_challenge:"Pata changamoto ya kuona",audio_challenge:"Pata changamoto ya sauti",refresh_btn:"Pata changamoto mpya",instructions_visual:"Charaza maneno mawili:",instructions_context:"Charaza maneno katika masanduku:",instructions_audio:"Charaza unachosikia:",help_btn:"Msaada",play_again:"Cheza sauti tena",cant_hear_this:"Pakua sauti kama MP3",incorrect_try_again:"Sio sahihi. Jaribu tena.",image_alt_text:"picha ya changamoto ya reCAPTCHA"},RecaptchaStr_ta={visual_challenge:"\u0baa\u0bbe\u0bb0\u0bcd\u0bb5\u0bc8 \u0b9a\u0bc7\u0bb2\u0b9e\u0bcd\u0b9a\u0bc8\u0baa\u0bcd \u0baa\u0bc6\u0bb1\u0bc1\u0b95",audio_challenge:"\u0b86\u0b9f\u0bbf\u0baf\u0bcb \u0b9a\u0bc7\u0bb2\u0b9e\u0bcd\u0b9a\u0bc8\u0baa\u0bcd \u0baa\u0bc6\u0bb1\u0bc1\u0b95",refresh_btn:"\u0baa\u0bc1\u0ba4\u0bbf\u0baf \u0b9a\u0bc7\u0bb2\u0b9e\u0bcd\u0b9a\u0bc8\u0baa\u0bcd \u0baa\u0bc6\u0bb1\u0bc1\u0b95",instructions_visual:"\u0b9a\u0bca\u0bb1\u0bcd\u0b95\u0bb3\u0bc8 \u0b9f\u0bc8\u0baa\u0bcd \u0b9a\u0bc6\u0baf\u0bcd\u0b95:",instructions_context:"\u0baa\u0bc6\u0b9f\u0bcd\u0b9f\u0bbf\u0baf\u0bbf\u0bb2\u0bcd \u0b89\u0bb3\u0bcd\u0bb3 \u0b9a\u0bca\u0bb1\u0bcd\u0b95\u0bb3\u0bc8 \u0b89\u0bb3\u0bcd\u0bb3\u0bbf\u0b9f\u0bc1\u0b95:",instructions_audio:"\u0b95\u0bc7\u0b9f\u0bcd\u0baa\u0ba4\u0bc8 \u0b9f\u0bc8\u0baa\u0bcd \u0b9a\u0bc6\u0baf\u0bcd\u0b95:",help_btn:"\u0b89\u0ba4\u0bb5\u0bbf",play_again:"\u0b92\u0bb2\u0bbf\u0baf\u0bc8 \u0bae\u0bc0\u0ba3\u0bcd\u0b9f\u0bc1\u0bae\u0bcd \u0b87\u0baf\u0b95\u0bcd\u0b95\u0bc1",cant_hear_this:"\u0b92\u0bb2\u0bbf\u0baf\u0bc8 MP3 \u0b86\u0b95 \u0baa\u0ba4\u0bbf\u0bb5\u0bbf\u0bb1\u0b95\u0bcd\u0b95\u0bc1\u0b95",incorrect_try_again:"\u0ba4\u0bb5\u0bb1\u0bbe\u0ba9\u0ba4\u0bc1. \u0bae\u0bc0\u0ba3\u0bcd\u0b9f\u0bc1\u0bae\u0bcd \u0bae\u0bc1\u0baf\u0bb2\u0bb5\u0bc1\u0bae\u0bcd.",image_alt_text:"reCAPTCHA \u0b9a\u0bc7\u0bb2\u0b9e\u0bcd\u0b9a\u0bcd \u0baa\u0b9f\u0bae\u0bcd"},RecaptchaStr_te={visual_challenge:"\u0c12\u0c15 \u0c26\u0c43\u0c36\u0c4d\u0c2f\u0c2e\u0c3e\u0c28 \u0c38\u0c35\u0c3e\u0c32\u0c41\u0c28\u0c41 \u0c38\u0c4d\u0c35\u0c40\u0c15\u0c30\u0c3f\u0c02\u0c1a\u0c02\u0c21\u0c3f",audio_challenge:"\u0c12\u0c15 \u0c06\u0c21\u0c3f\u0c2f\u0c4b \u0c38\u0c35\u0c3e\u0c32\u0c41\u0c28\u0c41 \u0c38\u0c4d\u0c35\u0c40\u0c15\u0c30\u0c3f\u0c02\u0c1a\u0c02\u0c21\u0c3f",refresh_btn:"\u0c15\u0c4d\u0c30\u0c4a\u0c24\u0c4d\u0c24 \u0c38\u0c35\u0c3e\u0c32\u0c41\u0c28\u0c41 \u0c38\u0c4d\u0c35\u0c40\u0c15\u0c30\u0c3f\u0c02\u0c1a\u0c02\u0c21\u0c3f",instructions_visual:"\u0c30\u0c46\u0c02\u0c21\u0c41 \u0c2a\u0c26\u0c3e\u0c32\u0c28\u0c41 \u0c1f\u0c48\u0c2a\u0c4d \u0c1a\u0c47\u0c2f\u0c02\u0c21\u0c3f:",instructions_context:"\u0c2a\u0c26\u0c3e\u0c32\u0c28\u0c41 \u0c2a\u0c46\u0c1f\u0c4d\u0c1f\u0c46\u0c32\u0c4d\u0c32\u0c4b \u0c1f\u0c48\u0c2a\u0c4d \u0c1a\u0c47\u0c2f\u0c02\u0c21\u0c3f:",instructions_audio:"\u0c2e\u0c40\u0c30\u0c41 \u0c35\u0c3f\u0c28\u0c4d\u0c28\u0c26\u0c3f \u0c1f\u0c48\u0c2a\u0c4d \u0c1a\u0c47\u0c2f\u0c02\u0c21\u0c3f:",help_btn:"\u0c38\u0c39\u0c3e\u0c2f\u0c02",play_again:"\u0c27\u0c4d\u0c35\u0c28\u0c3f\u0c28\u0c3f \u0c2e\u0c33\u0c4d\u0c32\u0c40 \u0c2a\u0c4d\u0c32\u0c47 \u0c1a\u0c47\u0c2f\u0c3f",cant_hear_this:"\u0c27\u0c4d\u0c35\u0c28\u0c3f\u0c28\u0c3f MP3 \u0c35\u0c32\u0c46 \u0c21\u0c4c\u0c28\u0c4d\u200c\u0c32\u0c4b\u0c21\u0c4d \u0c1a\u0c47\u0c2f\u0c3f",incorrect_try_again:"\u0c24\u0c2a\u0c4d\u0c2a\u0c41. \u0c2e\u0c33\u0c4d\u0c32\u0c40 \u0c2a\u0c4d\u0c30\u0c2f\u0c24\u0c4d\u0c28\u0c3f\u0c02\u0c1a\u0c02\u0c21\u0c3f.",image_alt_text:"reCAPTCHA \u0c38\u0c35\u0c3e\u0c32\u0c41 \u0c1a\u0c3f\u0c24\u0c4d\u0c30\u0c02"},RecaptchaStr_th={visual_challenge:"\u0e23\u0e31\u0e1a\u0e04\u0e27\u0e32\u0e21\u0e17\u0e49\u0e32\u0e17\u0e32\u0e22\u0e14\u0e49\u0e32\u0e19\u0e20\u0e32\u0e1e",audio_challenge:"\u0e23\u0e31\u0e1a\u0e04\u0e27\u0e32\u0e21\u0e17\u0e49\u0e32\u0e17\u0e32\u0e22\u0e14\u0e49\u0e32\u0e19\u0e40\u0e2a\u0e35\u0e22\u0e07",refresh_btn:"\u0e23\u0e31\u0e1a\u0e04\u0e27\u0e32\u0e21\u0e17\u0e49\u0e32\u0e17\u0e32\u0e22\u0e43\u0e2b\u0e21\u0e48",instructions_visual:"\u0e1e\u0e34\u0e21\u0e1e\u0e4c\u0e04\u0e33\u0e2a\u0e2d\u0e07\u0e04\u0e33\u0e19\u0e31\u0e49\u0e19:",instructions_context:"\u0e1e\u0e34\u0e21\u0e1e\u0e4c\u0e04\u0e33\u0e19\u0e31\u0e49\u0e19\u0e43\u0e19\u0e0a\u0e48\u0e2d\u0e07\u0e19\u0e35\u0e49:",instructions_audio:"\u0e1e\u0e34\u0e21\u0e1e\u0e4c\u0e2a\u0e34\u0e48\u0e07\u0e17\u0e35\u0e48\u0e04\u0e38\u0e13\u0e44\u0e14\u0e49\u0e22\u0e34\u0e19:",help_btn:"\u0e04\u0e27\u0e32\u0e21\u0e0a\u0e48\u0e27\u0e22\u0e40\u0e2b\u0e25\u0e37\u0e2d",play_again:"\u0e40\u0e25\u0e48\u0e19\u0e40\u0e2a\u0e35\u0e22\u0e07\u0e2d\u0e35\u0e01\u0e04\u0e23\u0e31\u0e49\u0e07",cant_hear_this:"\u0e14\u0e32\u0e27\u0e42\u0e2b\u0e25\u0e14\u0e40\u0e2a\u0e35\u0e22\u0e07\u0e40\u0e1b\u0e47\u0e19 MP3",incorrect_try_again:"\u0e44\u0e21\u0e48\u0e16\u0e39\u0e01\u0e15\u0e49\u0e2d\u0e07 \u0e25\u0e2d\u0e07\u0e2d\u0e35\u0e01\u0e04\u0e23\u0e31\u0e49\u0e07",image_alt_text:"\u0e23\u0e2b\u0e31\u0e2a\u0e20\u0e32\u0e1e reCAPTCHA"},RecaptchaStr_tr={visual_challenge:"G\u00f6rsel sorgu al",audio_challenge:"Sesli sorgu al",refresh_btn:"Yeniden y\u00fckle",instructions_visual:"\u0130ki kelimeyi yaz\u0131n:",instructions_context:"Kutudaki kelimeleri yaz\u0131n:",instructions_audio:"Duydu\u011funuzu yaz\u0131n:",help_btn:"Yard\u0131m",play_again:"Sesi tekrar \u00e7al",cant_hear_this:"Sesi MP3 olarak indir",incorrect_try_again:"Yanl\u0131\u015f. Tekrar deneyin.",image_alt_text:"reCAPTCHA sorusu resmi"},RecaptchaStr_uk={visual_challenge:"\u041e\u0442\u0440\u0438\u043c\u0430\u0442\u0438 \u0432\u0456\u0437\u0443\u0430\u043b\u044c\u043d\u0438\u0439 \u0442\u0435\u043a\u0441\u0442",audio_challenge:"\u041e\u0442\u0440\u0438\u043c\u0430\u0442\u0438 \u0430\u0443\u0434\u0456\u043e\u0437\u0430\u043f\u0438\u0441",refresh_btn:"\u041e\u043d\u043e\u0432\u0438\u0442\u0438 \u0442\u0435\u043a\u0441\u0442",instructions_visual:"\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u0434\u0432\u0430 \u0441\u043b\u043e\u0432\u0430:",instructions_context:"\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u0441\u043b\u043e\u0432\u0430 \u0432 \u043f\u043e\u043b\u044f:",instructions_audio:"\u0412\u0432\u0435\u0434\u0456\u0442\u044c \u043f\u043e\u0447\u0443\u0442\u0435:",help_btn:"\u0414\u043e\u0432\u0456\u0434\u043a\u0430",play_again:"\u0412\u0456\u0434\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u0437\u0430\u043f\u0438\u0441 \u0449\u0435 \u0440\u0430\u0437",cant_hear_this:"\u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0438\u0442\u0438 \u0437\u0430\u043f\u0438\u0441 \u044f\u043a MP3",incorrect_try_again:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e. \u0421\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0449\u0435 \u0440\u0430\u0437.",image_alt_text:"\u0417\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u043d\u044f \u0437\u0430\u0432\u0434\u0430\u043d\u043d\u044f reCAPTCHA"},RecaptchaStr_ur={visual_challenge:"\u0627\u06cc\u06a9 \u0645\u0631\u0626\u06cc \u0686\u06cc\u0644\u0646\u062c \u062d\u0627\u0635\u0644 \u06a9\u0631\u06cc\u06ba",audio_challenge:"\u0627\u06cc\u06a9 \u0622\u0688\u06cc\u0648 \u0686\u06cc\u0644\u0646\u062c \u062d\u0627\u0635\u0644 \u06a9\u0631\u06cc\u06ba",refresh_btn:"\u0627\u06cc\u06a9 \u0646\u06cc\u0627 \u0686\u06cc\u0644\u0646\u062c \u062d\u0627\u0635\u0644 \u06a9\u0631\u06cc\u06ba",instructions_visual:"\u062f\u0648 \u0627\u0644\u0641\u0627\u0638 \u0679\u0627\u0626\u067e \u06a9\u0631\u06cc\u06ba:",instructions_context:"\u0627\u0644\u0641\u0627\u0638 \u06a9\u0648 \u062e\u0627\u0646\u0648\u06ba \u0645\u06cc\u06ba \u0679\u0627\u0626\u067e \u06a9\u0631\u06cc\u06ba:",instructions_audio:"\u0622\u067e \u06a9\u0648 \u062c\u0648 \u0633\u0646\u0627\u0626\u06cc \u062f\u06cc\u062a\u0627 \u06c1\u06d2 \u0627\u0633\u06d2 \u0679\u0627\u0626\u067e \u06a9\u0631\u06cc\u06ba:",help_btn:"\u0645\u062f\u062f",play_again:"\u0622\u0648\u0627\u0632 \u062f\u0648\u0628\u0627\u0631\u06c1 \u0686\u0644\u0627\u0626\u06cc\u06ba",cant_hear_this:"\u0622\u0648\u0627\u0632 \u06a9\u0648 MP3 \u06a9\u06d2 \u0628\u0637\u0648\u0631 \u0688\u0627\u0624\u0646 \u0644\u0648\u0688 \u06a9\u0631\u06cc\u06ba",incorrect_try_again:"\u063a\u0644\u0637\u06d4 \u062f\u0648\u0628\u0627\u0631\u06c1 \u06a9\u0648\u0634\u0634 \u06a9\u0631\u06cc\u06ba\u06d4",image_alt_text:"reCAPTCHA \u0686\u06cc\u0644\u0646\u062c \u0648\u0627\u0644\u06cc \u0634\u0628\u06cc\u06c1"},RecaptchaStr_vi={visual_challenge:"Nh\u1eadn th\u1eed th\u00e1ch h\u00ecnh \u1ea3nh",audio_challenge:"Nh\u1eadn th\u1eed th\u00e1ch \u00e2m thanh",refresh_btn:"Nh\u1eadn th\u1eed th\u00e1ch m\u1edbi",instructions_visual:"Nh\u1eadp hai t\u1eeb:",instructions_context:"Nh\u1eadp c\u00e1c t\u1eeb trong c\u00e1c \u00f4:",instructions_audio:"Nh\u1eadp n\u1ed9i dung b\u1ea1n nghe th\u1ea5y:",help_btn:"Tr\u1ee3 gi\u00fap",play_again:"Ph\u00e1t l\u1ea1i \u00e2m thanh",cant_hear_this:"T\u1ea3i \u00e2m thanh xu\u1ed1ng d\u01b0\u1edbi d\u1ea1ng MP3",incorrect_try_again:"Kh\u00f4ng ch\u00ednh x\u00e1c. H\u00e3y th\u1eed l\u1ea1i.",image_alt_text:"H\u00ecnh x\u00e1c th\u1ef1c reCAPTCHA"},RecaptchaStr_zh_cn={visual_challenge:"\u6536\u5230\u4e00\u4e2a\u89c6\u9891\u9080\u8bf7",audio_challenge:"\u6362\u4e00\u7ec4\u97f3\u9891\u9a8c\u8bc1\u7801",refresh_btn:"\u6362\u4e00\u7ec4\u9a8c\u8bc1\u7801",instructions_visual:"\u8bf7\u952e\u5165\u8fd9\u4e24\u4e2a\u8bcd\uff1a",instructions_context:"\u952e\u5165\u6846\u4e2d\u663e\u793a\u7684\u5b57\u8bcd\uff1a",instructions_audio:"\u8bf7\u952e\u5165\u60a8\u542c\u5230\u7684\u5185\u5bb9\uff1a",help_btn:"\u5e2e\u52a9",play_again:"\u91cd\u65b0\u64ad\u653e",cant_hear_this:"\u4ee5 MP3 \u683c\u5f0f\u4e0b\u8f7d\u58f0\u97f3",incorrect_try_again:"\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u8bd5\u3002",image_alt_text:"reCAPTCHA \u9a8c\u8bc1\u56fe\u7247"},RecaptchaStr_zh_hk={visual_challenge:"\u56de\u7b54\u5716\u50cf\u9a57\u8b49\u554f\u984c",audio_challenge:"\u53d6\u5f97\u8a9e\u97f3\u9a57\u8b49\u554f\u984c",refresh_btn:"\u63db\u4e00\u500b\u9a57\u8b49\u554f\u984c",instructions_visual:"\u8acb\u8f38\u5165\u9019\u5169\u500b\u5b57\uff1a",instructions_context:"\u5728\u6846\u5167\u8f38\u5165\u5b57\u8a5e\uff1a",instructions_audio:"\u9375\u5165\u60a8\u6240\u807d\u5230\u7684\uff1a",help_btn:"\u8aaa\u660e",play_again:"\u518d\u6b21\u64ad\u653e\u8072\u97f3",cant_hear_this:"\u5c07\u8072\u97f3\u4e0b\u8f09\u70ba MP3",incorrect_try_again:"\u4e0d\u6b63\u78ba\uff0c\u518d\u8a66\u4e00\u6b21\u3002",image_alt_text:"reCAPTCHA \u9a57\u8b49\u6587\u5b57\u5716\u7247"},RecaptchaStr_zh_tw={visual_challenge:"\u53d6\u5f97\u5716\u7247\u9a57\u8b49\u554f\u984c",audio_challenge:"\u53d6\u5f97\u8a9e\u97f3\u9a57\u8b49\u554f\u984c",refresh_btn:"\u53d6\u5f97\u65b0\u7684\u9a57\u8b49\u554f\u984c",instructions_visual:"\u8acb\u8f38\u5165\u4e0b\u5716\u4e2d\u7684\u5169\u500b\u5b57\uff1a",instructions_context:"\u8acb\u8f38\u5165\u65b9\u584a\u4e2d\u7684\u6587\u5b57\uff1a",instructions_audio:"\u8acb\u8f38\u5165\u8a9e\u97f3\u5167\u5bb9\uff1a",help_btn:"\u8aaa\u660e",play_again:"\u518d\u6b21\u64ad\u653e",cant_hear_this:"\u4ee5 MP3 \u683c\u5f0f\u4e0b\u8f09\u8072\u97f3",incorrect_try_again:"\u9a57\u8b49\u78bc\u6709\u8aa4\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\u3002",image_alt_text:"reCAPTCHA \u9a57\u8b49\u6587\u5b57\u5716\u7247"},RecaptchaStr_zu={visual_challenge:"Thola inselelo ebonakalayo",audio_challenge:"Thola inselelo yokulalelwayo",refresh_btn:"Thola inselelo entsha",instructions_visual:"Bhala lawa magama amabili:",instructions_context:"Bhala amagama asemabhokisini:",instructions_audio:"Bhala okuzwayo:",help_btn:"Usizo",play_again:"Phinda udlale okulalelwayo futhi",cant_hear_this:"Layisha umsindo njenge-MP3",incorrect_try_again:"Akulungile. Zama futhi.",image_alt_text:"umfanekiso oyinselelo we-reCAPTCHA"},RecaptchaLangMap={en:RecaptchaStr_en,af:RecaptchaStr_af,am:RecaptchaStr_am,ar:RecaptchaStr_ar,"ar-EG":RecaptchaStr_ar,bg:RecaptchaStr_bg,bn:RecaptchaStr_bn,ca:RecaptchaStr_ca,cs:RecaptchaStr_cs,da:RecaptchaStr_da,de:RecaptchaStr_de,el:RecaptchaStr_el,"en-GB":RecaptchaStr_en,"en-US":RecaptchaStr_en,es:RecaptchaStr_es,"es-419":RecaptchaStr_es_419,"es-ES":RecaptchaStr_es,et:RecaptchaStr_et,eu:RecaptchaStr_eu,fa:RecaptchaStr_fa,fi:RecaptchaStr_fi,fil:RecaptchaStr_fil,fr:RecaptchaStr_fr,"fr-CA":RecaptchaStr_fr_ca,"fr-FR":RecaptchaStr_fr,gl:RecaptchaStr_gl,gu:RecaptchaStr_gu,hi:RecaptchaStr_hi,hr:RecaptchaStr_hr,hu:RecaptchaStr_hu,hy:RecaptchaStr_hy,id:RecaptchaStr_id,is:RecaptchaStr_is,it:RecaptchaStr_it,iw:RecaptchaStr_iw,ja:RecaptchaStr_ja,kn:RecaptchaStr_kn,ko:RecaptchaStr_ko,ln:RecaptchaStr_fr,lt:RecaptchaStr_lt,lv:RecaptchaStr_lv,ml:RecaptchaStr_ml,mr:RecaptchaStr_mr,ms:RecaptchaStr_ms,nl:RecaptchaStr_nl,no:RecaptchaStr_no,pl:RecaptchaStr_pl,pt:RecaptchaStr_pt,"pt-BR":RecaptchaStr_pt,"pt-PT":RecaptchaStr_pt_pt,ro:RecaptchaStr_ro,ru:RecaptchaStr_ru,sk:RecaptchaStr_sk,sl:RecaptchaStr_sl,sr:RecaptchaStr_sr,sv:RecaptchaStr_sv,sw:RecaptchaStr_sw,ta:RecaptchaStr_ta,te:RecaptchaStr_te,th:RecaptchaStr_th,tr:RecaptchaStr_tr,uk:RecaptchaStr_uk,ur:RecaptchaStr_ur,vi:RecaptchaStr_vi,"zh-CN":RecaptchaStr_zh_cn,"zh-HK":RecaptchaStr_zh_hk,"zh-TW":RecaptchaStr_zh_tw,zu:RecaptchaStr_zu,tl:RecaptchaStr_fil,he:RecaptchaStr_iw,"in":RecaptchaStr_id,mo:RecaptchaStr_ro,zh:RecaptchaStr_zh_cn};var RecaptchaStr=RecaptchaStr_en,RecaptchaOptions,RecaptchaDefaultOptions={tabindex:0,theme:"red",callback:null,lang:null,custom_theme_widget:null,custom_translations:null,includeContext:!1},Recaptcha={widget:null,timer_id:-1,style_set:!1,theme:null,type:"image",ajax_verify_cb:null,$:function(a){return"string"==typeof a?document.getElementById(a):a},create:function(a,b,c){Recaptcha.destroy();b&&(Recaptcha.widget=Recaptcha.$(b));Recaptcha._init_options(c);Recaptcha._call_challenge(a)},destroy:function(){var a=Recaptcha.$("recaptcha_challenge_field");a&&a.parentNode.removeChild(a);-1!=Recaptcha.timer_id&&clearInterval(Recaptcha.timer_id);Recaptcha.timer_id=-1;if(a=Recaptcha.$("recaptcha_image"))a.innerHTML="";Recaptcha.widget&&("custom"!=Recaptcha.theme?Recaptcha.widget.innerHTML="":Recaptcha.widget.style.display="none",Recaptcha.widget=null)},focus_response_field:function(){var a=Recaptcha.$("recaptcha_response_field");a.focus()},get_challenge:function(){return"undefined"==typeof RecaptchaState?null:RecaptchaState.challenge},get_response:function(){var a=Recaptcha.$("recaptcha_response_field");return!a?null:a.value},ajax_verify:function(a){Recaptcha.ajax_verify_cb=a;var a=Recaptcha.get_challenge()||"",b=Recaptcha.get_response()||"",a=Recaptcha._get_api_server()+"/ajaxverify?c="+encodeURIComponent(a)+"&response="+encodeURIComponent(b);Recaptcha._add_script(a)},_ajax_verify_callback:function(a){Recaptcha.ajax_verify_cb(a)},_get_api_server:function(){var a=window.location.protocol,b;if("undefined"!=typeof _RecaptchaOverrideApiServer)b=_RecaptchaOverrideApiServer;else{if("undefined"!=typeof RecaptchaState&&"string"==typeof RecaptchaState.server&&0<RecaptchaState.server.length)return RecaptchaState.server.replace(/\/+$/,"");b="www.google.com/recaptcha/api"}return a+"//"+b},_call_challenge:function(a){a=Recaptcha._get_api_server()+"/challenge?k="+a+"&ajax=1&cachestop="+Math.random();Recaptcha.getLang_()&&(a+="&lang="+Recaptcha.getLang_());"undefined"!=typeof RecaptchaOptions.extra_challenge_params&&(a+="&"+RecaptchaOptions.extra_challenge_params);RecaptchaOptions.includeContext&&(a+="&includeContext=1");Recaptcha._add_script(a)},_add_script:function(a){var b=document.createElement("script");b.type="text/javascript";b.src=a;Recaptcha._get_script_area().appendChild(b)},_get_script_area:function(){var a=document.getElementsByTagName("head");return a=!a||1>a.length?document.body:a[0]},_hash_merge:function(a){for(var b={},c=0;c<a.length;c++)for(var d in a[c])b[d]=a[c][d];"context"==b.theme&&(b.includeContext=!0);return b},_init_options:function(a){a=a||{};RecaptchaOptions=Recaptcha._hash_merge([RecaptchaDefaultOptions,a])},challenge_callback:function(){var a=Recaptcha.widget;Recaptcha._reset_timer();RecaptchaStr=Recaptcha._hash_merge([RecaptchaStr_en,RecaptchaLangMap[Recaptcha.getLang_()]||{},RecaptchaOptions.custom_translations||{}]);window.addEventListener&&window.addEventListener("unload",function(a){Recaptcha.destroy()},!1);Recaptcha._is_ie()&&window.attachEvent&&window.attachEvent("onbeforeunload",function(){});if(0<navigator.userAgent.indexOf("KHTML")){a=document.createElement("iframe");a.src="about:blank";a.style.height="0px";a.style.width="0px";a.style.visibility="hidden";a.style.border="none";var b=document.createTextNode("This frame prevents back/forward cache problems in Safari.");a.appendChild(b);document.body.appendChild(a)}Recaptcha._finish_widget()},_add_css:function(a){if(-1!=navigator.appVersion.indexOf("MSIE 5"))document.write('<style type="text/css">'+a+"</style>");else{var b=document.createElement("style");b.type="text/css";b.styleSheet?b.styleSheet.cssText=a:(a=document.createTextNode(a),b.appendChild(a));Recaptcha._get_script_area().appendChild(b)}},_set_style:function(a){Recaptcha.style_set||(Recaptcha.style_set=!0,Recaptcha._add_css(a+"\n\n.recaptcha_is_showing_audio .recaptcha_only_if_image,.recaptcha_isnot_showing_audio .recaptcha_only_if_audio,.recaptcha_had_incorrect_sol .recaptcha_only_if_no_incorrect_sol,.recaptcha_nothad_incorrect_sol .recaptcha_only_if_incorrect_sol{display:none !important}"))},_init_builtin_theme:function(){var a=Recaptcha.$,b=Recaptcha._get_api_server(),c=b.length-1;"/"==b[c]&&(b=b.substring(0,c));var c=RecaptchaTemplates.VertCss,d=RecaptchaTemplates.VertHtml,e=b+"/img/"+Recaptcha.theme,f="gif",b=Recaptcha.theme;"clean"==b&&(c=RecaptchaTemplates.CleanCss,d=RecaptchaTemplates.CleanHtml,f="png");"context"==b&&(d=RecaptchaTemplates.ContextHtml);c=c.replace(/IMGROOT/g,e);Recaptcha._set_style(c);Recaptcha.widget.innerHTML='<div id="recaptcha_area">'+d+"</div>";c=function(b,c,d,h){var g=a(b+"_btn"),b=a(b);b.src=e+"/"+c+"."+f;c=RecaptchaStr[d];b.alt=c;g.title=c;g.href=h};c("recaptcha_reload","refresh","refresh_btn","javascript:Recaptcha.reload();");c("recaptcha_switch_audio","audio","audio_challenge","javascript:Recaptcha.switch_type('audio');");c("recaptcha_switch_img","text","visual_challenge","javascript:Recaptcha.switch_type('image');");c("recaptcha_whatsthis","help","help_btn",Recaptcha._get_help_link());a("recaptcha_whatsthis_btn").target="_blank";a("recaptcha_whatsthis_btn").onclick=function(){Recaptcha.showhelp();return false};"clean"==b&&(a("recaptcha_logo").src=e+"/logo."+f,a("recaptcha_tagline").src=e+"/tagline."+f);a("recaptcha_table").className="recaptchatable recaptcha_theme_"+Recaptcha.theme;b=function(b,c){var d=a(b);if(d){if(RecaptchaState.rtl&&"span"==d.tagName.toLowerCase())d.dir="rtl";d.appendChild(document.createTextNode(RecaptchaStr[c]))}};b("recaptcha_instructions_image","instructions_visual");b("recaptcha_instructions_context","instructions_context");b("recaptcha_instructions_audio","instructions_audio");b("recaptcha_instructions_error","incorrect_try_again")},_finish_widget:function(){var a=Recaptcha.$,b=RecaptchaOptions,c=b.theme,d={blackglass:1,clean:1,context:1,custom:1,red:1,white:1};c in d||(c="red");Recaptcha.theme||(Recaptcha.theme=c);"custom"!=Recaptcha.theme?Recaptcha._init_builtin_theme():Recaptcha._set_style("");c=document.createElement("span");c.id="recaptcha_challenge_field_holder";c.style.display="none";a("recaptcha_response_field").parentNode.insertBefore(c,a("recaptcha_response_field"));a("recaptcha_response_field").setAttribute("autocomplete","off");a("recaptcha_image").style.width="300px";a("recaptcha_image").style.height="57px";Recaptcha.should_focus=!1;Recaptcha._set_challenge(RecaptchaState.challenge,"image");Recaptcha.updateTabIndexes_();Recaptcha.widget&&(Recaptcha.widget.style.display="");b.callback&&b.callback()},updateTabIndexes_:function(){var a=Recaptcha.$,b=RecaptchaOptions;if(b.tabindex&&(b=b.tabindex,a("recaptcha_response_field").tabIndex=b++,"audio"==Recaptcha.type&&a("recaptcha_audio_play_again")&&(a("recaptcha_audio_play_again").tabIndex=b++,a("recaptcha_audio_download"),a("recaptcha_audio_download").tabIndex=b++),"custom"!=Recaptcha.theme))a("recaptcha_reload_btn").tabIndex=b++,a("recaptcha_switch_audio_btn").tabIndex=b++,a("recaptcha_switch_img_btn").tabIndex=b++,a("recaptcha_whatsthis_btn").tabIndex=b},switch_type:function(a){Recaptcha.type=a;Recaptcha.reload("audio"==Recaptcha.type?"a":"v")},reload:function(a){var b=RecaptchaOptions,c=RecaptchaState;"undefined"==typeof a&&(a="r");c=Recaptcha._get_api_server()+"/reload?c="+c.challenge+"&k="+c.site+"&reason="+a+"&type="+Recaptcha.type;b.includeContext&&(c+="&includeContext=1");Recaptcha.getLang_()&&(c+="&lang="+Recaptcha.getLang_());"undefined"!=typeof b.extra_challenge_params&&(c+="&"+b.extra_challenge_params);"audio"==Recaptcha.type&&(c=b.audio_beta_12_08?c+"&audio_beta_12_08=1":c+"&new_audio_default=1");Recaptcha.should_focus="t"!=a;Recaptcha._add_script(c)},finish_reload:function(a,b){RecaptchaState.is_incorrect=!1;Recaptcha._set_challenge(a,b);Recaptcha.updateTabIndexes_()},_set_challenge:function(a,b){var c=Recaptcha.$,d=RecaptchaState;d.challenge=a;Recaptcha.type=b;c("recaptcha_challenge_field_holder").innerHTML='<input type="hidden" name="recaptcha_challenge_field" id="recaptcha_challenge_field" value="'+d.challenge+'"/>';if("audio"==b)c("recaptcha_image").innerHTML=Recaptcha.getAudioCaptchaHtml();else if("image"==b){var e=Recaptcha._get_api_server()+"/image?c="+d.challenge;c("recaptcha_image").innerHTML='<img style="display:block;" alt="'+RecaptchaStr.image_alt_text+'" height="57" width="300" src="'+e+'" />'}Recaptcha._css_toggle("recaptcha_had_incorrect_sol","recaptcha_nothad_incorrect_sol",d.is_incorrect);Recaptcha._css_toggle("recaptcha_is_showing_audio","recaptcha_isnot_showing_audio","audio"==b);Recaptcha._clear_input();Recaptcha.should_focus&&Recaptcha.focus_response_field();Recaptcha._reset_timer()},_reset_timer:function(){clearInterval(Recaptcha.timer_id);var a=Math.max(1E3*(RecaptchaState.timeout-
60),6E4);Recaptcha.timer_id=setInterval('Recaptcha.reload("t");',a);return a},showhelp:function(){window.open(Recaptcha._get_help_link(),"recaptcha_popup","width=460,height=580,location=no,menubar=no,status=no,toolbar=no,scrollbars=yes,resizable=yes")},_clear_input:function(){Recaptcha.$("recaptcha_response_field").value=""},_displayerror:function(a){var b=Recaptcha.$;b("recaptcha_image").innerHTML="";b("recaptcha_image").appendChild(document.createTextNode(a))},reloaderror:function(a){Recaptcha._displayerror(a)},_is_ie:function(){return 0<navigator.userAgent.indexOf("MSIE")&&!window.opera},_css_toggle:function(a,b,c){var d=Recaptcha.widget;d||(d=document.body);var e=d.className,e=e.replace(RegExp("(^|\\s+)"+a+"(\\s+|$)")," "),e=e.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)")," "),e=e+(" "+(c?a:b));d.className=e},_get_help_link:function(){var a=Recaptcha._get_api_server().replace(/\/[a-zA-Z0-9]+\/?$/,"/help"),a=a+("?c="+RecaptchaState.challenge);Recaptcha.getLang_()&&(a+="&hl="+Recaptcha.getLang_());return a},playAgain:function(){Recaptcha.$("recaptcha_image").innerHTML=Recaptcha.getAudioCaptchaHtml()},getAudioCaptchaHtml:function(){var a=Recaptcha._get_api_server()+"/image?c="+RecaptchaState.challenge;0==a.indexOf("https://")&&(a="http://"+a.substring(8));var b=Recaptcha._get_api_server()+"/img/audiocaptcha.swf?v2",b=Recaptcha._is_ie()?'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="audiocaptcha" width="0" height="0" codebase="https://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab"><param name="movie" value="'+b+'" /><param name="quality" value="high" /><param name="bgcolor" value="#869ca7" /><param name="allowScriptAccess" value="always" /></object><br/>':'<embed src="'+b+'" quality="high" bgcolor="#869ca7" width="0" height="0" name="audiocaptcha" align="middle" play="true" loop="false" quality="high" allowScriptAccess="always" type="application/x-shockwave-flash" pluginspage="http://www.adobe.com/go/getflashplayer" /></embed>',c="";Recaptcha.checkFlashVer()&&(c="<br/>"+Recaptcha.getSpan_('<a id="recaptcha_audio_play_again" class="recaptcha_audio_cant_hear_link" href="#" onclick="Recaptcha.playAgain(); return false;">'+RecaptchaStr.play_again+"</a>"));c+="<br/>"+Recaptcha.getSpan_('<a id="recaptcha_audio_download" class="recaptcha_audio_cant_hear_link" target="_blank" href="'+a+'">'+RecaptchaStr.cant_hear_this+"</a>");return b+c},getSpan_:function(a){return"<span"+(RecaptchaState&&RecaptchaState.rtl?' dir="rtl"':"")+">"+a+"</span>"},gethttpwavurl:function(){if("audio"!=Recaptcha.type)return"";var a=Recaptcha._get_api_server()+"/image?c="+RecaptchaState.challenge;0==a.indexOf("https://")&&(a="http://"+a.substring(8));return a},checkFlashVer:function(){var a=-1!=navigator.appVersion.indexOf("MSIE"),b=-1!=navigator.appVersion.toLowerCase().indexOf("win"),c=-1!=navigator.userAgent.indexOf("Opera"),d=-1;if(null!=navigator.plugins&&0<navigator.plugins.length){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"])a=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"",a=navigator.plugins["Shockwave Flash"+a].description,a=a.split(" "),a=a[2].split("."),d=a[0]}else if(a&&b&&!c)try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),f=e.GetVariable("$version"),d=f.split(" ")[1].split(",")[0]}catch(i){}return 9<=d},getLang_:function(){return"undefined"!=typeof RecaptchaState&&RecaptchaState.lang?RecaptchaState.lang:RecaptchaOptions.lang?RecaptchaOptions.lang:null}};(function(Backbone){'use strict';Backbone.Webshop.registration.MissingDetailsModel=Backbone.Model.extend({url:"/webshop/address/getAddressesForPostcode/",defaults:{"form":{}},parse:function(response){response.postcodeAddressList=response.data;response.disableForm=!response.postcodeAddressList.canDeliver||!response.postcodeAddressList.postcodeRecognised;return response;}});})(Backbone);(function(Backbone){'use strict';Backbone.Webshop.registration.MissingDetailsView=Backbone.View.extend({events:{"click .enter-manually":"enterManually","click .back-to-list":"backToList","click .check-postcode":"checkPostcode","change input":'updateModel'},updateModel:function(e){var $target=Backbone.$(e.target);var value=$target.val();this.model.attributes.form[$target.attr('name')]=value;},initialize:function(){this.missingAddressTemplate=Handlebars.templates["registration/missingAddress"];this.listenTo(this.model,"change",this.render);},render:function(){this.$el.html(this.missingAddressTemplate(this.model.attributes));return this;},enterManually:function(){this.model.set({"showAddressList":false,"showManualPrefecture":true,"showPaypalManualPrefecture":false});},backToList:function(){this.model.set({"showAddressList":true,"showManualPrefecture":false,"showPaypalManualPrefecture":false});},checkPostcode:function(){var postcode=Backbone.$(".postcode-input").val();this.model.set({"postcode":postcode,"showAddressList":true,"showManualPrefecture":false,"showPaypalManualPrefecture":false});this.model.fetch({data:{data:postcode}});}});})(Backbone);(function(Backbone,webshop){'use strict';Backbone.Webshop.registration.RegistrationView=Backbone.Marionette.ItemView.extend({events:{"submit #quickRegAcceptForm":'register',"click .btn-secondary":'register'},template:false,register:function(event){event.preventDefault();this.registerDebounce();},registerDebounce:_.debounce(function(){webshop.popup.utils.giveSubmitFeedback(".btn-secondary");var form=jQ("#quickRegAcceptForm");form.submit();},2000,true)});})(Backbone,webshop);(function(Backbone){'use strict';Backbone.Webshop.registration.SSORegistrationBehavior=Backbone.Marionette.Behavior.extend({initialize:function(){window.addEventListener('message',this.resizeIframeHandler.bind(this),false);},resizeIframeHandler:function(event){if(!this.isValidTargetOrigin(event.origin)||(isNaN(event.data.height))){return;}
jQ('.sso-iframe-registration').css('height',event.data.height+'px');},isValidTargetOrigin:function(origin){var ssoTargetOrigin=webshop.common.jsVariables.get('ssoTargetOrigin');var windowOrigin=window.location.origin;if(!windowOrigin){windowOrigin=window.location.protocol+"//"+window.location.hostname+(window.location.port?':'+window.location.port:'');}
return origin===ssoTargetOrigin||origin===windowOrigin;},});})(Backbone);(function(Backbone,webshop){'use strict';Backbone.Webshop.registration.SSORegistrationView=Backbone.Marionette.ItemView.extend({behaviors:{SSORegistrationBehavior:{}}});})(Backbone,webshop);