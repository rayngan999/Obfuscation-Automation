var gptHandler,gpt_topslot_title,gpt_topslot,gpt_strip,gpt_oop,gpt_promobox,gpt_stripmobile,gpt_inread,gpt_native1,gpt_native2,gpt_native3,gpt_native_sidebar1,gpt_native_sidebar2,gpt_native_sidebar3,gpt_oop2;function gptHandler(){var e=this;e.pageaction,e.conf,e.extra_targeting=null,e.slots=[],e.advChannel="",e.init=function(){e.pageaction=document.body.dataset.pageaction,e.setupConf(),e.defineSlots()},e.setupConf=function(){"undefined"!=typeof gpt_conf&&(e.conf=gpt_conf),"undefined"!=typeof gpt_extra_targeting&&(e.extra_targeting=gpt_extra_targeting)},e.defineSlots=function(){if(e.conf&&0!=e.conf.length){var t="index"==e.pageaction||"benessere"==e.pageaction?"home":"listato",a="1",i="1",o=[ApsSetup(),IASSetup()];window.googletag=window.googletag||{},googletag.cmd=googletag.cmd||[],googletag.cmd.push(function(){var g=[];for(var n in e.conf){var s=e.conf[n];if("gpt_topslot"==s){var l=[[300,250],[300,600]],r=sw<=1e3?"gpt_topslot_mobile":"gpt_topslot";"index"==e.pageaction?(l=[[300,250]],r="gpt_topslot"):"benessere"==e.pageaction?r="gpt_topslot":force300x250&&"desktop"==device&&(l=[[300,250]]),gpt_topslot=googletag.defineSlot(advChannel,l,r).setTargeting("pos",i).setTargeting("dvc",device).setTargeting("mtfIFPath","/doubleclick/").setCollapseEmptyDiv(!0).addService(googletag.pubads()),i++,g.push(r)}else if("gpt_topslot_title"==s){l=[[300,250]];gpt_topslot=googletag.defineSlot(advChannel,l,s).setTargeting("pos",i).setTargeting("dvc",device).setTargeting("mtfIFPath","/doubleclick/").setCollapseEmptyDiv(!0).addService(googletag.pubads()),i++,g.push(s)}else if("gpt_strip"==s){var p=googletag.sizeMapping().addSize([0,0],[[3,1],[720,240]]).addSize([950,0],[[980,50],[980,90],[3,1],[970,250],[980,250],[980,323]]).build();l=[[980,50],[980,90],[970,250],[980,250],[980,323],[3,1],[720,240]],r="adv-gpt-masthead-leaderboard-container1";(gpt_strip=googletag.defineSlot(advChannel,l,r).setTargeting("pos","1").setTargeting("test",1).setTargeting("test",2).setTargeting("mtfIFPath","/doubleclick/").setCollapseEmptyDiv(!0).addService(googletag.pubads())).defineSizeMapping(p),g.push(r)}else if("gpt_oop"==s){r="adv-gpt-outofpage";gpt_oop=googletag.defineOutOfPageSlot(advChannel,r).setTargeting("mtfIFPath","/doubleclick/").setCollapseEmptyDiv(!0).addService(googletag.pubads()),g.push(r)}else if("gpt_minimasthead"==s){var d=googletag.sizeMapping().addSize([0,0],[720,240]).addSize([1e3,0],[]).build();l=[[720,240]];gpt_minimasthead=googletag.defineSlot(advChannel,l,s).setTargeting("pos","1").setTargeting("test",1).setTargeting("mtfIFPath","/doubleclick/").setCollapseEmptyDiv(!0).addService(googletag.pubads()),gpt_minimasthead.defineSizeMapping(d),g.push(s)}else if("gpt_inread"==s){var c=googletag.sizeMapping().addSize([0,0],[640,5]).addSize([1e3,0],[]).build();l=[[640,5]];(gpt_inread=googletag.defineSlot("/4758/giallozafferano",l,s).setTargeting("pos","1").setTargeting("mtfIFPath","/doubleclick/").setCollapseEmptyDiv(!0).addService(googletag.pubads())).defineSizeMapping(c),g.push(s)}else if("gpt_promobox"==s){l=[[300,101]];gpt_promobox=googletag.defineSlot(advChannel,l,s).setTargeting("pos","1").setTargeting("mtfIFPath","/doubleclick/").setCollapseEmptyDiv(!0).addService(googletag.pubads()),g.push(s)}else if("gpt_native1"==s){l=[[90,100]];var u="11";"index"!=e.pageaction&&"benessere"!=e.pageaction||(u="9","en"==lang&&sw<1e3&&(r="gpt_native1_mobile")),gpt_native1=googletag.defineSlot(advChannel,l,s).setTargeting("pos",a.toString()).setTargeting("spazio","null").setTargeting("native",t+"1").setTargeting("cssIndex",u).setTargeting("sigla_sito","gz").setTargeting("dvc",device).setCollapseEmptyDiv(!0).addService(googletag.pubads()),a++,g.push(s)}else if("gpt_native2"==s){l=[[90,100]],u="11",r=s;"index"!=e.pageaction&&"benessere"!=e.pageaction||(u="9",sw<1e3&&(r="gpt_native2_mobile")),gpt_native2=googletag.defineSlot(advChannel,l,r).setTargeting("pos",a.toString()).setTargeting("spazio","null").setTargeting("native",t+"2").setTargeting("cssIndex",u).setTargeting("sigla_sito","gz").setTargeting("dvc",device).setCollapseEmptyDiv(!0).addService(googletag.pubads()),a++,g.push(r)}else if("gpt_native3"==s){l=[[90,100]],u="11",r=s;"index"!=e.pageaction&&"benessere"!=e.pageaction||(u="9",sw<1e3&&(r="gpt_native3_mobile")),gpt_native3=googletag.defineSlot(advChannel,l,r).setTargeting("pos",a.toString()).setTargeting("spazio","null").setTargeting("native",t+"3").setTargeting("cssIndex",u).setTargeting("sigla_sito","gz").setTargeting("dvc",device).setCollapseEmptyDiv(!0).addService(googletag.pubads()),a++,g.push(r)}else if("gpt_native_sidebar1"==s){l=[[80,100]],r=s;"ricetta"==e.pageaction&&sw<1e3&&(r="gpt_native_sidebar1_mobile"),gpt_native_sidebar1=googletag.defineSlot(advChannel,l,r).setTargeting("pos",a.toString()).setTargeting("spazio","null").setTargeting("native","sidebar1").setTargeting("cssIndex","10").setTargeting("sigla_sito","gz").setTargeting("dvc",device).setCollapseEmptyDiv(!0).addService(googletag.pubads()),a++,g.push(r)}else if("gpt_native_sidebar2"==s){l=[[80,100]],r=s;"ricetta"==e.pageaction&&sw<1e3&&(r="gpt_native_sidebar2_mobile"),gpt_native_sidebar2=googletag.defineSlot(advChannel,l,r).setTargeting("pos",a.toString()).setTargeting("spazio","null").setTargeting("native","sidebar2").setTargeting("cssIndex","10").setTargeting("sigla_sito","gz").setTargeting("dvc",device).setCollapseEmptyDiv(!0).addService(googletag.pubads()),a++,g.push(r)}else if("gpt_native_sidebar3"==s){l=[[80,100]],r=s;"ricetta"==e.pageaction&&sw<1e3&&(r="gpt_native_sidebar3_mobile"),gpt_native_sidebar3=googletag.defineSlot(advChannel,l,r).setTargeting("pos",a.toString()).setTargeting("spazio","null").setTargeting("native","sidebar3").setTargeting("cssIndex","10").setTargeting("sigla_sito","gz").setTargeting("dvc",device).setCollapseEmptyDiv(!0).addService(googletag.pubads()),a++,g.push(r)}else if("gpt_oop2"==s){l=[[2,2]];gpt_oop2=googletag.defineSlot(advChannel,l,s).setTargeting("mtfIFPath","/doubleclick/").setCollapseEmptyDiv(!0).addService(googletag.pubads()),g.push(s)}}let f=0,m=0,v=0,_=0;if(googletag.pubads().addEventListener("slotRenderEnded",function(e){if(e.slot===gpt_strip){if(window.tmhtest=parseInt(performance.now()),console.log("[MH Fix] slot slotRenderEnded gpt_strip:"+parseInt((performance.now()-window.tmhtest)/1e3)),isAnimationAllowed=isStripAnimationAllowed(e),e.size&&"720"==e.size[0]&&"240"==e.size[1]){var t=document.getElementById(e.slot.getSlotElementId()).querySelector("iframe:not([id*=hidden])");t.width=sw,t.height=Math.ceil(720*sw/240/9)}}else if(e.slot===window.stripmobile)e.size&&"320"==e.size[0]&&"50"==e.size[1]&&0==m&&(m=1,console.log("Init refresh 320x50",f),setInterval(function(){googletag.pubads().refresh([stripmobile]),f+=1,console.log("Refresh 320x50 n:",f)},16e3));else if(e.slot===gpt_topslot&&force300x250&&"desktop"==device&&e.size&&"300"==e.size[0]&&"250"==e.size[1]&&0==_){var a=document.getElementById("gpt_topslot");_=1,console.log("Init refresh 300x250",v),setInterval(function(){isInViewport(a)&&(googletag.pubads().refresh([gpt_topslot]),v+=1,console.log("Refresh 300x250 n:",v))},3e4)}}),googletag.pubads().addEventListener("impressionViewable",function(t){t.slot===gpt_strip&&(window.gptStripViewableTime=performance.now()||null,console.log("[MH Fix] slot impressionViewable gpt_strip: "+parseInt((performance.now()-window.tmhtest)/1e3))),e.slots.push(t.slot)}),googletag.pubads().addEventListener("slotRenderEnded",function(t){t.slot===gpt_strip&&"3,1"!=t.size&&setTimeout(()=>{AmeMh.strip_animation(),console.log("[MH Fix] slot slotOnload gpt_strip: "+parseInt((performance.now()-window.tmhtest)/1e3))},1500),e.slots.push(t.slot)}),e.extra_targeting)for(var n in e.extra_targeting)googletag.pubads().setTargeting(n,e.extra_targeting[n]);for(var n in"undefined"!=typeof ADX_label&&null!==ADX_label||(console.log("Warning: ADX_label is empty!"),ADX_label=""),googletag.pubads().setTargeting("ADX",ADX_label),void 0!==typeof Krux&&null!==Krux||(console.log("Warning: Krux is empty!"),Krux.segments=[],Krux.user=""),googletag.pubads().setTargeting("ksg",Krux.segments),googletag.pubads().setTargeting("kuid",Krux.user),googletag.pubads().enableSingleRequest(),googletag.pubads().enableAsyncRendering(),googletag.pubads().collapseEmptyDivs(),googletag.pubads().disableInitialLoad(),g)googletag.display(g[n]);Promise.all(o.map(function(e){return timeoutPromise(2e3,e).then(e=>{console.log(`[BID] ${e.type} promise resolved:`,e.data)}).catch(function(e){console.log("[BID] promise timeout",e)})})).then(function(){googletag.pubads().refresh(),performance.measure("[BID] refresh slots - everything loaded","GPT start loading"),performance.getEntriesByType("measure").forEach(e=>{console.log(`${e.name}: ${e.duration}`)})})})}}}(gptHandler=new gptHandler).init();let startStripMobile=e=>"undefined"==typeof startStripMobileCheck&&(!(window.innerWidth>480)&&(console.log("[strip mobile 2021] initiator",e),window.startStripMobileCheck=1,void googletag.cmd.push(function(){document.getElementById("gpt_stripmobile")&&(window.stripmobile=googletag.defineSlot(advChannel,[[320,50]],"gpt_stripmobile").setTargeting("pos","1").setTargeting("mtfIFPath","/doubleclick/").setTargeting("test",2).setCollapseEmptyDiv(!0,!0).addService(googletag.pubads()),googletag.display("gpt_stripmobile"),googletag.pubads().refresh([stripmobile]),AmeMh.callbackStripMobile())})));function fetchLibAps(){return new Promise(function(e,t){mmLoader({src:"https://c.amazon-adsystem.com/aax2/apstag.js",async:!0}).then(t=>{window.apstag.init({pubID:"3651",adServer:"googletag",bidTimeout:2e3},function(){performance.measure("[BID] APS loaded end","GPT start loading"),e(window.apstag)})})})}function ApsSetup(){return fetchLibAps().then(e=>new Promise(function(t,a){e.fetchBids({slots:[{slotID:sw<=1e3?"gpt_topslot_mobile":"gpt_topslot",slotName:advChannel,sizes:[[300,250],[300,600]]},{slotID:"adv-gpt-masthead-leaderboard-container1",slotName:advChannel,sizes:[[970,250],[728,90],[300,100]]}]},function(a){performance.measure("[BID] APS fetch end","GPT start loading"),googletag.cmd.push(function(){e.setDisplayBids()}),t({type:"APS",data:a})})}))}function fetchLibIAS(){return new Promise(function(e,t){performance.mark("IAS load start"),mmLoader({src:"https://cdn.adsafeprotected.com/iasPET.1.js",async:!0}).then(t=>{performance.measure("[BID] IAS loaded end","GPT start loading"),e(window.__iasPET)})})}function IASSetup(){return fetchLibIAS().then(e=>new Promise(function(t,a){var i,o=!1;function g(){o||(performance.measure("[BID] IAS fetch end","GPT start loading"),t({type:"IAS",data:window.__iasPET}),clearTimeout(n),o=!0)}var n=2e3;window.__iasPET=e||{},window.__iasPET.queue=e.queue||[],window.__iasPET.pubId="929824";var s=setTimeout(g,n);i=function(e){clearTimeout(s),window.__iasPET.setTargetingForGPT(),g()},googletag.cmd.push(function(){for(var e=googletag.pubads().getSlots(),t=[],a=0;a<e.length;a++){var o=e[a].getSizes().map(function(e){return e.getWidth&&e.getHeight?[e.getWidth(),e.getHeight()]:[1,1]});t.push({adSlotId:e[a].getSlotElementId(),size:o,adUnitPath:e[a].getAdUnitPath()})}window.__iasPET.queue.push({adSlots:t,dataHandler:i})})}))}function timeoutPromise(e,t){var a=new Promise(function(t,a){setTimeout(a,e)});return Promise.race([t,a])}
//# sourceMappingURL=gptHandler.min.js.map