(function(z,E){function K(e,h,r){Object.defineProperty(e,h,{writable:!1,configurable:!1,value:r})}"undefined"===typeof Brid.AdSDK&&(Brid.AdSDK={});var aa=(E.BridIframeBurst?z.top:z).document;Brid.AdSDK.Util={urlParts:function(e){var h=E.createElement("a");h.setAttribute("href",e);return{href:h.href,protocol:h.protocol?h.protocol.replace(/:$/,""):"",host:h.host,search:h.search?h.search.replace(/^\?/,""):"",hash:h.hash?h.hash.replace(/^#/,""):"",hostname:h.hostname,port:h.port?h.port:80,pathname:"/"===
h.pathname.charAt(0)?h.pathname:"/"+h.pathname}},queryStringToObj:function(e,h){h=b.isFunction(h)?h:function(){return!0};e=e.trim().replace(/^\?/,"");e=e.split("&");var r={};e.forEach(function(e){if(""!==e){var a=e.split("=");e=a[0];a=a[1];h(e,a)&&(r[e]=a)}});return r},objToQueryString:function(e){var h=[];e.forEach(function(e,a){h.push(a+"="+e)});return h.join("&")},itemFromQueryString:function(e,h){h||(h=location.href);e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");e=(new RegExp("[\\?&]"+e+"=([^&#]*)")).exec(h);
return null==e?null:e[1]},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isFunction:function(e){return"[object Function]"==Object.prototype.toString.call(e)},decapitalize:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},transformArray:function(e,h){var r=[];e.forEach(function(e,a){(e=h(e,a))&&r.push(e)});return r},timeouts:{},callbackTimeout:function(e,h,r){e=setTimeout(function(){h=function(){};delete b.timeouts[a];r()},e);var a=function(){h.apply(this,arguments)&&
b.clearCallbackTimeout(a)};a.uniqueNum=parseInt(1E4*Math.random());b.timeouts[a.uniqueNum]=e;return a},clearCallbackTimeout:function(e){var h=b.timeouts[e.uniqueNum];h&&(clearTimeout(h),delete b.timeouts[e.uniqueNum])},checkIfURLExists:function(e){try{var h=z.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");h.open("HEAD",e,!1);h.onload=function(){};h.onerror=function(e){};h.send();return 404!==h.status&&403!==h.status}catch(r){return!1}},getOGG:function(e,h,r,a,d){for(var F,
k="",l=0,c=e.length;l<c;l++)if(-1!=e[l].type.indexOf("video")&&("video/mp4"==e[l].type||h)){F=e[l];-1<F.src.indexOf("youtube.com")&&(k=b.itemFromQueryString("video_id",F.src));e="string"==typeof r.adSystem?r.adSystem.toLocaleLowerCase():r.adSystem.toString();h=r.adTitle||"";r=((-1!=e.indexOf("gdfp")||-1!=e.indexOf("google")||-1!=e.indexOf("dcm")||-1!=e.indexOf("dart")||-1!=e.indexOf("freewheel")?e:r.id)+"_"+(r.creativeID||h.replace(/ /g,""))+"_"+k).replace(/\//g,"");d=a?"264":d;a="//cdn.brid.tv/live/partners/"+
d+"/mobile/"+encodeURIComponent(r)+".ogg";b.checkIfURLExists(a)?(F.mp3=a.replace("ogg","mp3").replace("mobile","mp3"),F.src=a,F.type="video/ogg"):(d="//apiunits.brid.tv/oggs/get/"+d+"/"+r+"/"+btoa(F.src)+".json",Brid.Loader.loadText(d,function(c){},function(c){}),F=!0);break}return F},VAST:{track:function(e,h){var a=[];l.parseURLMacros(e,h).forEach(function(e){var h=new Image;h.src=e;a.push(h)});return a},parseURLMacros:function(e,h){var a=[];h=h||{};h.CACHEBUSTING||(h.CACHEBUSTING=Math.round(1E10*
Math.random()));"undefined"!=typeof e&&e.forEach(function(e){a.push(l._parseURLMacro(e,h))});return a},parseURLMacro:function(e,h){h=h||{};h.CACHEBUSTING||(h.CACHEBUSTING=Math.round(1E10*Math.random()));return l._parseURLMacro(e,h)},_parseURLMacro:function(e,h){h=h||{};a.eachProp(h,function(h,a){e=e.replace(new RegExp("\\["+h+"\\]","gm"),a)});return e},parseTimeString:function(e){var h=/(\d):(\d):(\d)(\.(\d\d\d))?/,a=/(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/,b;"string"===typeof e&&(h=e.match(h))&&(b=3600*
parseInt("0"+h[1],10)+60*parseInt("0"+h[2],10)+parseInt("0"+h[3],10));"string"===typeof e&&(h=e.match(a))&&(b=3600*parseInt(h[1],10)+60*parseInt(h[2],10)+parseInt(h[3],10)+parseInt(h[5]||0)/1E3);return isNaN(b)?null:b},parseImpressions:function(e){return e?(e=b.isArray(e)?e:[e],b.transformArray(e,function(e){if(e.keyValue)return e.keyValue})):[]},parseViewableImpressions:function(e){return e?(e=b.isArray(e)?e:[e],b.transformArray(e,function(e){if(e.keyValue)return e.keyValue})):[]},parseCreatives:function(e){var h=
[];e&&e.creative&&(e=b.isArray(e.creative)?e.creative:[e.creative],e.forEach(function(e){h.push(new ea(e))}));return h},parseAdVerifications:function(e){var h=[];e&&e.verification&&(e=b.isArray(e.verification)?e.verification:[e.verification],e.forEach(function(e){h.push(new V(e))}));return h},parseExtensions:function(e){var h=[];e&&e.extension&&(e=b.isArray(e.extension)?e.extension:[e.extension],e.forEach(function(e){"AdVerifications"==e.attr("type")?h=h.concat(b.VAST.parseAdVerifications(e.adVerifications)):
h.push(new fa(e))}));return h},parseTrackingEvents:function(e,h){var a=[];e&&(e=b.isArray(e)?e:[e],e.forEach(function(e){a.push(new ga(e,h))}));return a},formatProgress:function(e){var h=Math.floor(e/36E5);var r=Math.floor(e/6E4%60);var b=Math.floor(e/1E3%60);e%=1E3;return a.round(h,2)+":"+a.round(r,2)+":"+a.round(b,2)+"."+a.round(e,3)},parseOffset:function(e,h){return/^\d+(\.\d+)?%$/g.test(e)?(h?(e=parseFloat(e.replace("%","")),h=h*e/100):h=null,h):l.parseTimeString(e)},VPAID_techs:[],isVPAID:function(e){return!!e&&
"VPAID"===e.apiFramework},findSupportedVPAIDTech:function(e){var h;var a=0;for(h=l.VPAID_techs.length;a<h;a+=1){var b=l.VPAID_techs[a];if(b.supports(e))return b}return null}},async:{setImmediate:function(e){setTimeout(e,0)},iterator:function(e){var h=function(a){var b=function(){e.length&&e[a].apply(null,arguments);return b.next()};b.next=function(){return a<e.length-1?h(a+1):null};return b};return h(0)},waterfall:function(e,h){h=h||function(){};if(!b.isArray(e))return h(Error("First argument to waterfall must be an array of functions"));
if(!e.length)return h();var a=function(e){return function(b){if(b)h.apply(null,arguments),h=function(){};else{var r=Array.prototype.slice.call(arguments,1),d=e.next();d?r.push(a(d)):r.push(h);Q.setImmediate(function(){e.apply(null,r)})}}};a(Q.iterator(e))()}},basync:{setImmediate:function(e){setTimeout(e,0)},iterator:function(e){var h=function(a){var b=function(){e.length&&e[a].apply(null,arguments);return b.next()};b.next=function(){return a<e.length-1?h(a+1):null};return b};return h(0)},waterfall:function(e,
h){h=h||function(){};if(!b.isArray(e))return h(Error("First argument to waterfall must be an array of functions"));if(!e.length)return h();var a=function(e){return function(b){if(b)h.apply(null,arguments),h=function(){};else{var r=Array.prototype.slice.call(arguments,1),d=e.next();d?r.push(a(d)):r.push(h);e.apply(null,r)}}};a(G.iterator(e))()}},checkIframeSound:function(e,h){var a=(e.contentDocument?e.contentDocument:e.contentWindow.document).createElement("video");a.setAttribute("webkit-playsinline",
"");a.setAttribute("playsinline","");a.playing=!1;a.autoplay=!0;a.muted=!1;a.src=Brid.Util.checkVideoSource;a.load();a=a.play();void 0!==a&&a.then(function(){Brid.log(h+" AUTOPLAY IFRAME DESKTOP ALLOWED");e.soundAllowed=!0}).catch(function(){Brid.log(h+" AUTOPLAY IFRAME DESKTOP NOT NOT ALLOWED")})}};var a=Brid.Util,B=Brid.event,b=Brid.AdSDK.Util,l=b.VAST,Q=b.async,G=b.basync,N=a.$f;Brid.AdSDK.XML={strToXMLDoc:function(e){var a=new DOMParser,b=!1;try{b=e.firstChild}catch(P){}if(b)return e;try{var d=
a.parseFromString(e,"application/xml");if(!e)throw Error();}catch(P){throw Error("xml.strToXMLDOC: Error parsing the string: '"+e+"'");}return d},isISO8601:function(e){isNaN(e)||(e+="");return"string"!=typeof e?!1:/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/.test(a.trim(e))},
parseText:function(e){return/^\s*$/.test(e)?null:/^(?:true|false)$/i.test(e)?"true"===e.toLowerCase():isFinite(e)?parseFloat(e):d.isISO8601(e)?new Date(e):a.trim(e)},toJXONTree:function(e){e=d.strToXMLDoc(e);return new d.JXONTree(e)},keyValue:function(e){if(e)return e.keyValue},attr:function(e,a){if(e)return e["@"+b.decapitalize(a)]},encode:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},decode:function(e){return e.replace(/&apos;/g,
"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")}};var d=Brid.AdSDK.XML;d.JXONTree=function(e){if(e.documentElement)return new d.JXONTree(e.documentElement);if(e.hasChildNodes()){for(var h="",r,k,l=0;l<e.childNodes.length;l++)(r=e.childNodes.item(l),3===(r.nodeType-1|1))?h+=3===r.nodeType?a.trim(r.nodeValue):r.nodeValue:1!==r.nodeType||r.prefix?1===r.nodeType&&"vmap"==r.prefix&&(k=b.decapitalize(r.nodeName.replace("vmap:","")),r=new d.JXONTree(r),this.hasOwnProperty(k)?
(b.isArray(this[k])||(this[k]=[this[k]]),this[k].push(r)):this[k]=r):(k=b.decapitalize(r.nodeName),r=new d.JXONTree(r),this.hasOwnProperty(k)?(b.isArray(this[k])||(this[k]=[this[k]]),this[k].push(r)):this[k]=r);h&&(this.keyValue=d.parseText(h))}if("undefined"===typeof e.hasAttributes?0<e.attributes.length:e.hasAttributes())for(k=0;k<e.attributes.length;k++)h=e.attributes.item(k),this["@"+b.decapitalize(h.name)]=d.parseText(h.value.trim())};d.JXONTree.prototype.attr=function(e){return this["@"+b.decapitalize(e)]};
var W=Brid.Button.extend({enabled:!1,default:{title:"Skip Ad"},init:function h(a,b){a.config.translate&&a.config.translate.skip_ad&&(this.default.title=a.config.translate.skip_ad);h.base.call(this,a,b);a.add("timeupdate",this.$f(this.updateSkipButtonState));this.toggleListeners(!1)},createElement:function r(){return r.base.call(this,"div",{className:"brid-iab-skip-button brid-button"})},onClick:function(){this.enabled&&this.trigger("skip")},updateSkipButtonState:function(){var a=Math.ceil(this.config.skipOffset-
this.player.currentTime());this.el.style.display="block";0<a?this.el.innerHTML=(this.player.config.translate&&this.player.config.translate.skip_in||"SKIP IN").toUpperCase()+" "+Math.round(a)+"...":this.enabled||(this.toggleListeners(!0),this.enabled=!0,this.el.innerHTML=this.default.title.toUpperCase())},destroy:function F(){this.player.remove("timeupdate",this.$f(this.updateSkipButtonState));F.base.call(this)}}),X=Brid.Sprite.extend({enabled:!1,init:function P(a,b){P.base.call(this,a,b);this.el.href=
this.generateClickThroughURL(b.clickThrough,b.mediaFile.src);"string"===typeof b.clickThrough&&(this.el.target="_blank");this.add("click",this.$f(this.onClick))},createElement:function ba(){return ba.base.call(this,"a",{className:"brid-iab-blocker"})},onClick:function(){this.player.trigger("adClicked");this.trigger("clickthrough")},generateClickThroughURL:function(a,b){b={ASSETURI:b,CONTENTPLAYHEAD:l.formatProgress(1E3*this.player.currentTime())};return a?l.parseURLMacro(a,b):"#"}}),ha=X.extend({enabled:!1,
init:function ca(a,c){ca.base.call(this,a,c)},createElement:function(){var b=a.createElement("a",{className:"brid-static-container"});-1!=this.config.mediaFile.type.indexOf("image/")&&(this.image=a.createElement("img",{src:this.config.mediaFile.src}),this.image.onload=this.$f(function(){this.trigger("loaded")}),b.appendChild(this.image));return b},resize:function(a,b,c,A){this.el.style.top=a+"px";this.el.style.left=b+"px";this.el.style.width=c+"px";this.el.style.height=A+"px";this.el.style.setProperty("display",
"block","important")}}),R={html5:"text/javascript text/javascript1.0 text/javascript1.2 text/javascript1.4 text/jscript application/javascript application/x-javascript text/ecmascript text/ecmascript1.0 text/ecmascript1.2 text/ecmascript1.4 text/livescript application/ecmascript application/x-ecmascript".split(" ")},H=Brid.PlaybackTech.extend({init:function(a){this.config=a;this.name="AdSDK.VideoSlot";this.el=this.createElement();this.hide();this.triggerReady()},destroy:function(){this.el.parentNode.removeChild(this.el)},
createElement:function(){var b=this.config,d=a.createElement("video",{id:b.id,className:"brid-tech"});d.preload="none";a.autoplaySupported&&b.autoplay&&(d.setAttribute("muted","true"),d.muted=!0);b.muted&&(d.muted=!0,d.volume=0);a.css(d,{"background-color":"#000"});d.setAttribute("webkit-playsinline","");d.setAttribute("playsinline","");return d},hide:function da(){da.base.call(this)},show:function c(){c.base.call(this)},play:function(){this.el.play()},pause:function(){this.el.pause()},paused:function(){return this.el.paused},
currentTime:function(){return this.el.currentTime},setCurrentTime:function(c){try{this.el.currentTime=c}catch(A){Brid.warn("--- BridPlayer --- Video isn't ready. ",A)}},duration:function(){return this.el.duration||0},buffered:function(){return this.el.buffered},volume:function(){return this.el.volume},setVolume:function(c){this.el.volume=c},muted:function(){return this.el.muted},setMuted:function(c){c||this.el.removeAttribute("muted");this.el.muted=c},src:function(c){this.el.src=c},removeSrc:function(){this.el.removeAttribute("src")},
load:function(){this.el.load()},currentSrc:function(){return this.el.src},preload:function(){return this.el.preload},setPreload:function(c){this.el.preload=c},autoplay:function(){return this.el.autoplay},setAutoplay:function(c){this.el.autoplay=c},loop:function(){return this.el.loop},setLoop:function(c){this.el.loop=c},error:function(){switch(this.el.error.code){case 1:return"Fetching process aborted by user";case 2:return"Error occurred when downloading";case 3:return"Error occurred when decoding";
case 4:return"Audio/video not supported"}return!1},networkState:function(){return this.el.networkState},readyState:function(){return this.el.readyState},seeking:function(){return this.el.seeking},ended:function(){return this.el.ended},defaultMuted:function(){return this.el.defaultMuted}});H.isSupported=function(){return!!E.createElement("video").canPlayType};H.canPlaySource=function(c){return(c=a.formatType(c.src,c.type))?E.createElement("video").canPlayType?!!E.createElement("video").canPlayType(c):
!1:!1};H.canPlayURL=function(c){return(c=a.getTypeFromFile(c))?E.createElement("video").canPlayType?!!E.createElement("video").canPlayType(c):!1:!1};H.events="loadstart suspend abort error emptied stalled loadedmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate progress play pause ratechange volumechange webkitbeginfullscreen webkitendfullscreen".split(" ");H.prototype.support={fullscreen:a.ua.match("Chrome")||a.ua.match("Mac OS X 10.5")?!1:!0,
movingElementInDOM:!a.isIOS(),progressEvent:!0,timeupdateEvent:!0,monetizable:!0,adManagement:!1,canResize:!0,hasPoster:!1,qualityManager:!1};a.isAndroid()&&3>a.androidVersion()&&(E.createElement("video").constructor.prototype.canPlayType=function(c){return c&&-1!=c.toLowerCase().indexOf("video/mp4")?"maybe":""});var Y=Brid.Class.extend({init:function(c){this.id=c.attr("id");this.sequence=c.attr("sequence");c.inLine&&(this.inLine=new ia(c.inLine));c.wrapper&&(this.wrapper=new ja(c.wrapper))}}),ea=
Brid.Class.extend({init:function(c){this.id=c.attr("id");this.sequence=c.attr("sequence");this.adId=c.attr("adId")||c.attr("adID");this.apiFramework=c.attr("apiFramework");c.linear?this.linear=new ka(c.linear):c.nonLinearAds&&(this.nonLinearAds=new la(c.nonLinearAds))}}),fa=Brid.Class.extend({init:function(c){this.type=c.attr("type");c.customTracking&&c.customTracking.tracking&&(this.trackingEvents=l.parseTrackingEvents(c.customTracking.tracking))}}),ia=Brid.Class.extend({init:function(c){this.adTitle=
d.keyValue(c.adTitle);this.adSystem=d.keyValue(c.adSystem);this.adServingId=d.keyValue(c.adServingId);this.impressions=l.parseImpressions(c.impression);c.viewableImpression&&(this.viewableImpression=l.parseViewableImpressions(c.viewableImpression.viewable));this.creatives=l.parseCreatives(c.creatives);this.adVerifications=l.parseAdVerifications(c.adVerifications);this.description=d.keyValue(c.description);this.advertiser=d.keyValue(c.advertiser);this.surveys=function(c){return c?b.transformArray(b.isArray(c)?
c:[c],function(c){if(c.keyValue)return{uri:c.keyValue,type:c.attr("type")}}):[]}(c.survey);this.error=d.keyValue(c.error);this.pricing=d.keyValue(c.pricing);c.extensions&&(this.extensions=l.parseExtensions(c.extensions),this.extensions.forEach(function(c){c instanceof V&&this.adVerifications.push(c)},this))}}),ka=Brid.Class.extend({init:function(c){this.duration=l.parseTimeString(d.keyValue(c.duration));this.mediaFiles=function(c){var a=[];c&&(c=b.isArray(c)?c:[c],c.forEach(function(c){c=new na(c);
-1==c.type.indexOf("video/3gp")&&a.push(c)}));return a}(c.mediaFiles&&c.mediaFiles.mediaFile);this.interactiveCreativeFile=function(c){if(!c)return!1;var a=[];c=b.isArray(c)?c:[c];c.forEach(function(c){a.push(new oa(c))});return a}(c.mediaFiles&&c.mediaFiles.interactiveCreativeFile);this.trackingEvents=l.parseTrackingEvents(c.trackingEvents&&c.trackingEvents.tracking,this.duration);this.skipoffset=l.parseOffset(d.attr(c,"skipoffset"),this.duration);c.videoClicks&&(this.videoClicks=new pa(c.videoClicks));
c.adParameters&&(this.adParameters=d.keyValue(c.adParameters),d.attr(c.adParameters,"xmlEncoded")&&(this.adParameters=d.decode(this.adParameters)))}}),la=Brid.Class.extend({init:function(c){this.trackingEvents=l.parseTrackingEvents(c.trackingEvents&&c.trackingEvents.tracking);c.nonLinear&&(this.nonLinear=new qa(c.nonLinear))}}),qa=Brid.Class.extend({init:function(c){c.staticResource&&(this.type=c.staticResource.attr("creativeType"),this.src=d.keyValue(c.staticResource));this.clickThrough=d.keyValue(c.nonLinearClickThrough);
this.clickTrackings=function(c){var a=[];c&&(c=b.isArray(c)?c:[c],c.forEach(function(c){a.push(d.keyValue(c))}));return a}(c.nonLinearClickTracking);this.width=c.attr("width");this.height=c.attr("height");this.minSuggestedDuration=c.attr("minSuggestedDuration");this.apiFramework=c.attr("apiFramework");this.id=c.attr("id");this.scalable=c.attr("scalable");this.maintainAspectRatio=c.attr("maintainAspectRatio")}}),oa=Brid.Class.extend({init:function(c){this.src=d.keyValue(c);this.type="application/javascript";
this.apiFramework="VPAID"}}),na=Brid.Class.extend({init:function(c){this.src=d.keyValue(c);this.delivery=c.attr("delivery");this.type=c.attr("type");this.width=c.attr("width");this.height=c.attr("height");this.codec=c.attr("codec");this.id=c.attr("id");this.bitrate=c.attr("bitrate");this.minBitrate=c.attr("minBitrate");this.maxBitrate=c.attr("maxBitrate");this.scalable=c.attr("scalable");this.maintainAspectRatio=c.attr("maintainAspectRatio");this.apiFramework=c.attr("apiFramework")}}),ga=Brid.Class.extend({init:function(c,
a){this.name=c.attr("event");this.uri=d.keyValue(c);"progress"===this.name&&(this.offset=l.parseOffset(c.attr("offset"),a))}}),pa=Brid.Class.extend({init:function(c){function a(c){var a=[];c&&(c=b.isArray(c)?c:[c],c.forEach(function(c){void 0!==d.keyValue(c)&&a.push(d.keyValue(c))}));return a}this.clickThrough=d.keyValue(c.clickThrough);this.clickTrackings=a(c.clickTracking);this.customClicks=a(c.customClick)}}),ja=Brid.Class.extend({init:function(c){this.adSystem=d.keyValue(c.adSystem);this.impressions=
l.parseImpressions(c.impression);this.VASTAdTagURI=d.keyValue(c.vASTAdTagURI);this.creatives=l.parseCreatives(c.creatives);this.error=d.keyValue(c.error);this.extensions=c.extensions;this.followAdditionalWrappers="undefined"!=typeof d.attr(c,"followAdditionalWrappers")?d.attr(c,"followAdditionalWrappers"):!0;this.allowMultipleAds=d.attr(c,"allowMultipleAds");this.fallbackOnNoAd=d.attr(c,"fallbackOnNoAd")}}),V=Brid.Class.extend({init:function(c){this.vendor=c.attr("vendor");c.javaScriptResource&&(this.apiFramework=
c.javaScriptResource.attr("apiFramework"),this.browserOptional=c.javaScriptResource.attr("browserOptional")||!1,this.javaScriptResource=d.keyValue(c.javaScriptResource));c.trackingEvents&&(this.trackingEvents=l.parseTrackingEvents(c.trackingEvents));if(c.verificationParameters)try{this.verificationParameters=JSON.parse(d.keyValue(c.verificationParameters))}catch(A){this.verificationParameters=a.queryStringToObj(d.keyValue(c.verificationParameters))}}}),Z=Brid.Class.extend({init:function(c){this.breakId=
c.attr("breakId");this.breakType=c.attr("breakType");this.timeOffset=c.attr("timeOffset");-1!=this.timeOffset.indexOf(":")&&(this.timeOffset=b.VAST.parseTimeString(this.timeOffset));this.played=!1;if(c.adSource||c.ad)this.adSource=new ra(c.adSource||c.ad);c.trackingEvents&&(this.trackingEvents=l.parseTrackingEvents(c.trackingEvents))}}),ra=Brid.Class.extend({init:function(c){c.adTagURI||c.vastAdData||c.customData?(this.id=c.attr("id"),this.allowMultipleAds=c.attr("allowMultipleAds"),this.followRedirects=
c.attr("followRedirects"),c.adTagURI&&(this.adTagURI=d.keyValue(c.adTagURI),this.templateType=c.adTagURI.attr("templateType")),c.vastAdData&&(this.vastAdData=d.keyValue(c.vastAdData),this.templateType="vast3"),c.customData&&(this.customData=d.keyValue(c.customData),this.templateType=c.adTagURI.attr("templateType"))):this.adTagURI=d.keyValue(c)}}),k=function(c,a,b){this.message="Brid AdSDK VAST Error: "+(c||"")+" "+(a||"");b&&(this.data=b);a&&(this.code=a)};k.prototype=Error();k.prototype.name="VAST Error";
var L=Brid.Class.extend({events:[],init:function(c,a){this.response=a;this.assetURI=c;this.progress=0;this.quartiles={firstQuartile:{tracked:!1,time:Math.round(25*a.duration)/100*1E3},midpoint:{tracked:!1,time:Math.round(50*a.duration)/100*1E3},thirdQuartile:{tracked:!1,time:Math.round(75*a.duration)/100*1E3}}},trackURLs:function(c,A){b.isArray(c)&&0<c.length&&(A=a.merge({ASSETURI:this.assetURI,CONTENTPLAYHEAD:l.formatProgress(this.progress)},A||{}),l.track(c,A))},trackEvent:function(c,a,b){b=b||
this.response;var A=function(c){if(c){var a=[];c.forEach(function(c){a.push(c.uri)})}return a}(b.trackingEvents[c]);this.trackURLs(A);a&&delete b.trackingEvents[c]},addTrackEvent:function(c,a,b){this.response.trackingEvents[c]&&b&&this.events.push({name:c,trackOnce:!!a})},addQuartileEvents:function(c){var a=this.quartiles.midpoint,b=this.quartiles.thirdQuartile;this.quartiles.firstQuartile.tracked?a.tracked?b.tracked||this.trackQuartile("thirdQuartile",c):this.trackQuartile("midpoint",c):this.trackQuartile("firstQuartile",
c)},trackQuartile:function(c,a){var b=this.quartiles[c],A=b.time;a>=A&&a<=A+5E3&&(B.trigger(this,c),b.tracked=!0,this.addTrackEvent(c,!0,!0))},directTrackQuartile:function(c,a){if(a=this.quartiles[c])a.tracked=!0,this.trackEvent(c,!0)},trackProgressEvents:function(c){var a=this.response.trackingEvents;if(b.isArray(a.progress)){var d=[];a.progress.forEach(N(this,function(a){1E3*a.offset<=c?this.trackURLs([a.uri]):d.push(a)}));a.progress=d}},trackEvents:function(){this.events.forEach(function(c){this.trackEvent(c.name,
c.trackOnce)},this)},trackStart:function(){this.trackEvent("start",!0)},trackPause:function(){this.trackEvent("pause")},trackResume:function(){this.trackEvent("resume")},trackSkip:function(){this.trackEvent("skip",!0)},trackFullscreen:function(){this.trackEvent("fullscreen",!0)},trackExitFullscreen:function(){this.trackEvent("exitFullscreen",!0)},trackProgress:function(c,a){function b(a,b){return a>c&&3E3<Math.abs(b-a)}this.events=[];isNaN(c)||(this.addTrackEvent("start",!0,0<c),this.addTrackEvent("rewind",
!1,b(this.progress,c)),a||this.addQuartileEvents(c),this.trackProgressEvents(c),this.trackEvents(),this.progress=c)},trackComplete:function(){this.quartiles.thirdQuartile.tracked&&this.trackEvent("complete",!0)},trackErrorWithCode:function(c){isNaN(c)||this.trackURLs(this.response.errorURLMacros,{ERRORCODE:c})},trackImpressions:function(){this.trackURLs(this.response.impressions)},trackViewableImpressions:function(){this.trackURLs(this.response.viewableImpressions)},trackCreativeView:function(){this.trackEvent("creativeView")},
trackClick:function(){this.trackURLs(this.response.clickTrackings)}});"rewind fullscreen exitFullscreen pause resume mute unmute acceptInvitation acceptInvitationLinear collapse expand".split(" ").forEach(function(c){L.prototype["track"+a.uc(c)]=function(){this.trackEvent(c)}});["start","skip","close","closeLinear"].forEach(function(c){L.prototype["track"+a.uc(c)]=function(){this.trackEvent(c,!0)}});["firstQuartile","midpoint","thirdQuartile"].forEach(function(c){L.prototype["track"+a.uc(c)]=function(){this.quartiles[c].tracked=
!0;this.trackEvent(c,!0)}});var sa=Brid.Class.extend({init:function(){this.nonLinearAdded=this.linearAdded=!1;this.nonLinear=void 0;this.ads=[];this.errorURLMacros=[];this.impressions=[];this.viewableImpressions=[];this.clickTrackings=[];this.customClicks=[];this.trackingEvents={};this.mediaFiles=[];this.interactiveCreativeFile=[];this.extensions=[];this.adVerifications=[];this.clickThrough=void 0;this.adSystem=this.creativeID=this.id=this.adServingId=this.adTitle="";this.skipoffset=this.duration=
void 0},addAd:function(c){if(c instanceof Y){var a=c.inLine;var b=c.wrapper;this.ads.push(c);a&&this._addInLine(a);b&&this._addWrapper(b);this._addID(c.id)}},_addErrorTrackUrl:function(c){(c=c instanceof d.JXONTree?d.keyValue(c):c)&&this.errorURLMacros.push(c)},_addImpressions:function(c){b.isArray(c)&&a.appendToArray(this.impressions,c)},_addViewableImpressions:function(c){b.isArray(c)&&a.appendToArray(this.viewableImpressions,c)},_addClickThrough:function(c){c&&(this.clickThrough=c)},_addClickTrackings:function(c){b.isArray(c)&&
a.appendToArray(this.clickTrackings,c)},_addCustomClicks:function(c){b.isArray(c)&&a.appendToArray(this.customClicks,c)},_addTrackingEvents:function(c){var a=this.trackingEvents;c&&(c=b.isArray(c)?c:[c],c.forEach(function(c){a[c.name]||(a[c.name]=[]);a[c.name].push(c)}))},_addTitle:function(c){c&&(this.adTitle=c)},_addID:function(c){c&&(this.id=c)},_addServingId:function(c){c&&(this.adServingId=c)},_addAdSystem:function(c){this.adSystem=c},_addCreativeID:function(c){c&&(this.creativeID=c)},_addDuration:function(c){isNaN(c)||
(this.duration=c)},_addVideoClicks:function(c){c&&(this._addClickThrough(c.clickThrough),this._addClickTrackings(c.clickTrackings),this._addCustomClicks(c.customClicks))},_addMediaFiles:function(c){b.isArray(c)&&a.appendToArray(this.mediaFiles,c)},_addInteractiveCreativeFile:function(c){b.isArray(c)&&a.appendToArray(this.interactiveCreativeFile,c)},_addSkipoffset:function(c){c&&(this.skipoffset=c)},_addNonLinear:function(c){c&&(this.nonLinear=c,this._addClickThrough(c.clickThrough),this._addClickTrackings(c.clickTrackings))},
_addAdParameters:function(c){c&&(this.adParameters=c)},_addLinear:function(c){this._addDuration(c.duration);this._addTrackingEvents(c.trackingEvents);this._addVideoClicks(c.videoClicks);this._addMediaFiles(c.mediaFiles);this._addInteractiveCreativeFile(c.interactiveCreativeFile);this._addSkipoffset(c.skipoffset);this._addAdParameters(c.adParameters);this.linearAdded=!0},_addNonLinearAds:function(c){this._addTrackingEvents(c.trackingEvents);this._addNonLinear(c.nonLinear);this.nonLinearAdded=!0},_addExtensions:function(c){c.forEach(N(this,
function(c){"activeview"==c.type&&c.trackingEvents&&this._addTrackingEvents(c.trackingEvents)}))},_addVerifications:function(c){c&&(this.adVerifications=c)},_addInLine:function(c){this._addTitle(c.adTitle);this._addServingId(c.adServingId);this._addErrorTrackUrl(c.error);this._addImpressions(c.impressions);this._addViewableImpressions(c.viewableImpression);this._addVerifications(c.adVerifications);c.adSystem&&this._addAdSystem(c.adSystem);c.extensions&&this._addExtensions(c.extensions);c.creatives.forEach(N(this,
function(c){c.linear?(this._addLinear(c.linear),this._addCreativeID(c.id||c.adId)):c.nonLinearAds&&this._addNonLinearAds(c.nonLinearAds)}))},_addWrapper:function(c){this._addErrorTrackUrl(c.error);this._addImpressions(c.impressions);c.creatives.forEach(N(this,function(c){if(c=c.linear)this._addVideoClicks(c.videoClicks),this.clickThrough=void 0,this._addTrackingEvents(c.trackingEvents)}))},hasLinear:function(){return this.linearAdded}}),ta=Brid.Class.extend({init:function(){this.adBreaks=[]},addAdBreak:function(c){c instanceof
Z&&this.adBreaks.push(c)},prerollAdBreaks:function(){var c=[];this.adBreaks.map(function(a){a.played||0!=a.timeOffset&&"start"!=a.timeOffset&&"0%"!=a.timeOffset||c.push(a)});return 0<c.length?c:null},postrollAdBreaks:function(){var c=[];this.adBreaks.map(function(a){a.played||"end"!=a.timeOffset&&"100%"!=a.timeOffset||c.push(a)});return 0<c.length?c:null},midrollAdBreaks:function(){var c=[];this.adBreaks.map(function(a){var b=a.timeOffset;!a.played&&"end"!=b&&"100%"!=b&&0<b&&"start"!=b&&"0%"!=b&&
c.push(a)});return 0<c.length?c:null},hasLinear:function(){return!0}}),ua=Brid.Sprite.extend({default:{responseTimeout:15E3,adsEnabled:!0},init:function A(a,b,d,k,p){A.base.call(this,a,k,p);this.playbackTech=d;this.viewMode="normal";this.adsManager=b;this.container=p;this.adsCanceled=!1},playAd:function(a){var b;if(!this.adsCanceled){a||this.trackError(new k("On AdsManager, missing required VASTResponse"),a);a.linearAdded?b=[function(b){b(null,a)},this.$f(this._selectAdSource),this.$f(this._createVASTTracker),
this.$f(this._addClickThrough),this.$f(this._addSkipButton),this.$f(this._addEvents),this.$f(this._playSelectedAd)]:a.nonLinearAdded&&(b=[function(b){b(null,a)},this.$f(this._selectAdSource),this.$f(this._createVASTTracker),this.$f(this._addEvents),this.$f(this._playSelectedAd)]);Q.waterfall(b,this.$f(function(a,b){a&&b?this.trackError(a,b):this.adsManager.isLinear()&&(this.adsManager.trigger("vast.adVideoComplete"),this.adsManager.trigger("vast.contentResumeRequested"),this.adsManager.trigger("vast.adEnd"))}));
var d=this;return this._adUnit={_src:null,type:"VAST",pauseAd:function(){d.playbackTech.pause()},resumeAd:function(){d.playbackTech.play()},isPaused:function(){return d.playbackTech.paused()},getSrc:function(){return this._src},getWidth:function(){return this._width},getHeight:function(){return this._height}}}},stopAd:function(){this.adsManager.trigger("vast.adEnd")},reset:function(){this.adsCanceled=!0;this.adsLoader=null},_selectAdSource:function(b,d){var y=this.player.el.offsetWidth;if(b.linearAdded){b.mediaFiles.sort(function(a,
b){return Math.abs(y-a.width)-Math.abs(y-b.width)});for(var l=0,T=b.mediaFiles.length;l<T;l++){var p=b.mediaFiles[l];a.formatType(p.src,p.type);if(H.canPlaySource(p))if(a.isAndroid()&&"application/x-mpegURL"==p.type)p=null;else break;p=null}}else b.nonLinearAdded&&y>=b.nonLinear.width&&(p=b.nonLinear);if(p&&1!=p)return p.duration=b.duration,this._adUnit&&(this._adUnit._src=p.src,this._adUnit._width=p.width,this._adUnit._height=p.height),d(null,p,b);b.linearAdded?d(new k("Could not find Ad mediafile supported by this player",
403),b):b.nonLinearAdded&&d(new k("Player to small for non linear ad to display",403),b)},_createVASTTracker:function(a,b,d){try{this.tracker=new L(a.src,b),d(null,a,this.tracker,b)}catch(S){d(S,b)}},_addEvents:function(b,d,k,l){function y(){.1>Math.abs(n.duration())-n.currentTime()||(d.trackPause(),a.isMobilePlatform()||a.autoplayDesktopSupported||a.isAutoplayDesktopSupported(),this.adsManager.trigger("vast.adPause"),n.addOnce("play",this.$f(function(){d.trackResume();this.adsManager.trigger("vast.adResume")})))}
function p(){var a=1E3*n.currentTime();d.trackProgress(a)}function w(){var a=n.muted();a?d.trackMute():v&&d.trackUnmute();v=a}function q(a){this.adsManager.trigger("vast."+a.type)}var v,n=this.playbackTech;k.linearAdded&&(n.add("pause",this.$f(y)),n.add("volumechange",w),n.add("timeupdate",p),B.add(d,["firstQuartile","midpoint","thirdQuartile"],this.$f(q)));this.adsManager.addOnce("vast.adStart",this.$f(function(){d.trackImpressions();d.trackCreativeView();this.adsManager.trigger("vast.adImpression")}));
this.adsManager.addOnce(["vast.adEnd","vast.adsCancel","vast.adSkip"],this.$f(function(a){n.remove("pause",y);n.remove("timeupdate",p);n.remove("volumechange",w);n!=this.player.tech&&(n.src(""),n.hide());"vast.adEnd"===a.type&&d.trackComplete()}));return l(null,b,k)},_addSkipButton:function(a,b,d,k){function y(){p&&(this.removeChild(p),p.destroy(),p=null)}if((!d.nonLinearAdded||d.linearAdded)&&!isNaN(d.skipoffset)){var p=new W(this.player,{skipOffset:d.skipoffset});p.add("skip",this.$f(function(){b.trackSkip();
this.adsManager.trigger("vast.adSkip")}));this.addChild(p);this.adsManager.addOnce(["vast.adEnd","vast.adsCancel","vast.adSkip"],this.$f(y))}k(null,a,b,d)},_addClickThrough:function(a,b,d,k){var y=this.playbackTech,p=new X(this.player,{clickThrough:d.clickThrough,mediaFile:a});p.add("clickthrough",function(){b.trackClick();if(y.paused())return y.play(),!1;y.pause()});this.addChild(p);this.adsManager.addOnce(["vast.adEnd","vast.adsCancel","vast.adSkip"],this.$f(function(){p&&(this.removeChild(p),p.destroy(),
p=null)}));return k(null,a,b,d)},_playSelectedAd:function(a,b,d){function y(){p.remove(["play","playing"],this.$f(y));w.trigger("vast.adStart")}var l=this.player,p=this.playbackTech,w=this.adsManager;if(b.linearAdded)w.trigger("vast.contentPauseRequested"),p.show(),p.addOnce(["loadedmetadata","error"],this.$f(function(a){if("loadedmetadata"===a.type){var q=this.$f(function(){w.remove("vast.adSkip",q);p.remove("ended",g);d(null,b)});w.add("vast.adSkip",q);var g=this.$f(function(){w.remove("vast.adSkip",
q);p.remove("ended",g);d(null,b)});p.add("ended",g);p.addOnce(["play","playing"],this.$f(y));p.play()}else"error"===a.type&&d(new k("on VASTManager, Player is unable to play the Ad",400),b)})),p.src(a.src),l.canAutoplay()||l.userInteracted?p.load():d(new k("Playback attempted without user interaction on environment that does not support video playback without user interaction"),b);else if(b.nonLinearAdded){var q=this.nonLinear=new ha(l,{clickThrough:b.clickThrough,mediaFile:a});q.add("loaded",this.$f(function(){w.trigger("vast.adStart")}));
this.addChild(q);w.trigger("vast.contentResumeRequested");w.addOnce(["vast.adEnd","vast.adsCancel"],this.$f(function(){q&&(this.removeChild(q),q.destroy(),this.nonLinear=q=null)}))}},getAdDuration:function(){return this.playbackTech.duration()},getAdCurrentTime:function(){return this.playbackTech.currentTime()},setAdVolume:function(b){Brid.log("AdSDK VAST setAdVolume",b,Brid.Util.autoplayDesktopSupported,"player autoplay",this.player.config.autoplay);a.isMobilePlatform()||Brid.Util.autoplayDesktopSupported||
!this.player.config.autoplay||(b=0,Brid.log("AdSDK VAST setAdVolume",b));this.playbackTech.setVolume(b);this.playbackTech.setMuted(!b)},getAdVolume:function(){return this.playbackTech.volume()},stop:function(){this.adsManager.trigger("vast.contentResumeRequested");this.adsManager.trigger("vast.adSkip")},resize:function(a,b,d,k,l){this.nonLinear&&this.nonLinear.resize(a,b,d,k);this.tracker&&this.viewMode!==l&&(this.viewMode=l,"fullscreen"===l?this.tracker.trackFullscreen():this.tracker.trackExitFullscreen())},
trackError:function(a,b){this.tracker?this.tracker.trackErrorWithCode(a.code||900):b&&l.track(b.errorURLMacros,{ERRORCODE:a.code||900});this.adsManager.adError(a,b)},addChild:function ma(a){ma.base.call(this,a);this.container.appendChild(a.el)},removeChild:function y(a){a.el&&this.container.removeChild(a.el);y.base.call(this,a)}}),M="handshakeVersion initAd startAd stopAd skipAd resizeAd pauseAd resumeAd expandAd collapseAd subscribe unsubscribe".split(" "),D=Brid.Class.extend({init:function(a,b,
d){},handshakeVersion:function(a,b){},initAd:function(a,b,d,p,w,q,v){},startAd:function(a){},stopAd:function(a){},skipAd:function(a){},resizeAd:function(a,b,d,p){},pauseAd:function(a){},resumeAd:function(a){},expandAd:function(a){},collapseAd:function(a){},add:function(a,b,d){},remove:function(a,b){},removeAll:function(){B.removeAll(this)},getAdLinear:function(a){},getAdWidth:function(a){},getAdHeight:function(a){},getAdExpanded:function(a){},getAdSkippableState:function(a){},getAdRemainingTime:function(a){},
getAdDuration:function(a){},getAdVolume:function(a){},getAdCompanions:function(a){},getAdIcons:function(a){},setAdVolume:function(a,b){},addClass:function(b){a.addClass(this.el,b)},$f:function(b,d){return a.$f(this,b,d)}});K(D,"METHODS",M);K(D,"GETTERS","getAdLinear getAdWidth getAdHeight getAdExpanded getAdSkippableState getAdRemainingTime getAdDuration getAdVolume getAdCompanions getAdIcons".split(" "));K(D,"SETTERS",["setAdVolume"]);K(D,"EVENTS","AdLoaded AdStarted AdStopped AdSkipped AdSkippableStateChange AdSizeChange AdLinearChange AdDurationChange AdExpandedChange AdRemainingTimeChange AdVolumeChange AdImpression AdVideoStart AdVideoFirstQuartile AdVideoMidpoint AdVideoThirdQuartile AdVideoComplete AdInteraction AdUserAcceptInvitation AdUserMinimize AdUserClose AdPaused AdPlaying AdLog AdError".split(" "));
var va=M.filter(function(a){return-1===["skipAd"].indexOf(a)});K(D,"checkVPAIDInterface",function(a){return va.every(function(b){return"function"===typeof a[b]})});Brid.Sprite.extend({default:{},init:function S(a,b,w){S.base.call(this,a,b);this.response=b.response;this.vpaidManager=w;this.id="fakeVideoElement"},createElement:function T(){var b=T.base.call(this,"div",{src:"#"});b.HAVE_NOTHING=0;b.HAVE_METADATA=1;b.HAVE_CURRENT_DATA=2;b.HAVE_FUTURE_DATA=3;b.HAVE_ENOUGH_DATA=4;b.NETWORK_EMPTY=0;b.NETWORK_IDLE=
1;b.NETWORK_LOADING=2;b.NETWORK_NO_SOURCE=3;b.src="#";b.currentSrc="#";b.currentTime=0;b.buffered=a.createTimeRange(0,0);b.played=a.createTimeRange(0,0,0);b.volume=null;b.muted=null;b.duration=1;b.load=this.$f(this.load);b.play=this.$f(this.play);b.pause=this.$f(this.pause);b.readyState=0;b.ended=!1;b.paused=!1;a.css(b,{width:"100%",height:"100%"});b.canPlayType=function(a){return"video/mp4"==a?"probably":""};b.requestFullscreen=function(){};return b},load:function(){if(!this.videoPlaying){var d=
this.player,p=this.el,w;"undefined"!=typeof p&&p&&(w="#"!=p.src?p.src:p.getAttribute("src"))&&"#"!=w&&(w={src:w,type:-1!=w.indexOf("youtube.com")?"video/mp4":a.getTypeFromFile(w)},(w=b.getOGG([w],!0,this.response,d.adsManager.flagOurAd,d.config.Partner.id))&&1!=w?(d.adsManager.trigger("vast.selected3rdParty"),this.videoPlaying=!0,d.add("play",this.$f(this.onFakeEvent)),d.add("playing",this.$f(this.onFakeEvent)),d.add("pause",this.$f(this.onFakeEvent)),d.add("ended",this.$f(this.onFakeEvent)),d.add("loadedmetadata",
this.$f(this.onFakeEvent)),d.add("timeupdate",this.$f(this.onFakeEvent)),d.add("loadstart",this.$f(this.onFakeEvent)),d.add("waiting",this.$f(this.onFakeEvent)),d.add("progress",this.$f(this.onFakeEvent)),d.add("durationchange",this.$f(this.onFakeEvent)),d.add("volumechange",this.$f(this.onFakeEvent)),d.techCall("src",w),d.techCall("load"),d.techCall("play"),p.ended=!1,p.paused=!1,p.duration=d.techGet("duration"),p.readyState=1):this.vpaidManager._trackError(new k("Could not find Ad mediafile supported by this player",
403),this.response))}},play:function(){var a=this.player;this.videoPlaying?a.techCall("play"):this.load()},pause:function(){this.videoPlaying&&this.player.techCall("pause")},setVolume:function(a){this.player.techCall("setVolume",a)},onFakeEvent:function(a){if(this.el){var b=this.el,d=this.player;switch(a.type){case "progress":b.buffered=d.techGet("buffered");2>b.readyState?b.readyState=2:3>b.readyState&&(b.readyState=3);break;case "loadedmetadata":b.readyState=4;b.duration=d.techGet("duration");break;
case "timeupdate":b.currentTime=d.techGet("currentTime")||1;null!=b.volume&&b.volume!=d.techGet("volume")?this.player.techCall("setVolume",b.volume):null!=b.muted&&b.muted!=d.techGet("muted")&&this.player.techCall("setMuted",b.muted);break;case "play":b.duration=d.techGet("duration");b.paused=!1;break;case "pause":b.paused=!0;break;case "volumechange":b.volume=d.techGet("volume");break;case "ended":b.currentTime=b.duration,b.ended=!0,this.videoPlaying=!1}z.CustomEvent&&(a=new CustomEvent(a.type,{detail:{},
bubbles:!1,cancelable:!0}),b.dispatchEvent(a))}},destroy:function p(){var a=this.player;a.remove("play",this.$f(this.onFakeEvent));a.remove("playing",this.$f(this.onFakeEvent));a.remove("pause",this.$f(this.onFakeEvent));a.remove("ended",this.$f(this.onFakeEvent));a.remove("loadedmetadata",this.$f(this.onFakeEvent));a.remove("timeupdate",this.$f(this.onFakeEvent));a.remove("loadstart",this.$f(this.onFakeEvent));a.remove("waiting",this.$f(this.onFakeEvent));a.remove("progress",this.$f(this.onFakeEvent));
a.remove("durationchange",this.$f(this.onFakeEvent));a.remove("volumechange",this.$f(this.onFakeEvent));this.el&&(this.el.load=function(){},this.el.play=function(){},this.el.pause=function(){});p.base.call(this)}});var O=Brid.Class.extend({default:{},init:function(a,b){if(!a||!O.checkVPAIDInterface(a))throw new k("on VPAIDUnitWrapper, the passed VPAID adUnit does not fully implement the VPAID interface");if("object"!=typeof b)throw new k("on VPAIDUnitWrapper, expected config hash but got '"+b+"'");
if(!("responseTimeout"in b)||"number"!=typeof b.responseTimeout)throw new k("on VPAIDUnitWrapper, expected responseTimeout in options");this.config=b;this._adUnit=a},add:function(a,b){(this._adUnit.addEventListener||this._adUnit.subscribe||this._adUnit.on||this._adUnit.add).call(this._adUnit,a,b)},remove:function(a,b){(this._adUnit.removeEventListener||this._adUnit.unsubscribe||this._adUnit.off||this._adUnit.remove).call(this._adUnit,a,b)},trigger:function(a){this._adUnit.trigger(a)},handshakeVersion:function(a,
b){this._adUnit.handshakeVersion(a,b)},initAd:function(a,b,q,d,n,g,f){this._adUnit.initAd(a,b,q,d,n,g,f)},resizeAd:function(a,b,q,d){this._adUnit.resizeAd(a,b,q,d)},startAd:function(a,b){this._adUnit.startAd(a,b)},stopAd:function(a){this._adUnit.stopAd(a)},pauseAd:function(a){this._adUnit.pauseAd(a)},resumeAd:function(a){this._adUnit.resumeAd(a)},expandAd:function(a){this._adUnit.expandAd(a)},collapseAd:function(a){this._adUnit.collapseAd(a)},skipAd:function(a){this._adUnit.skipAd(a)},setAdVolume:function(a,
b){this._adUnit.setAdVolume(a,b)}});O.checkVPAIDInterface=function(a){function d(a){return b.isFunction(a.unsubscribe)||b.isFunction(a.removeEventListener)||b.isFunction(a.off)||b.isFunction(a.remove)}for(var q="handshakeVersion initAd startAd stopAd resizeAd pauseAd expandAd collapseAd".split(" "),v=0,n=q.length;v<n;v++)if(!a||!b.isFunction(a[q[v]]))return!1;return function(a){return b.isFunction(a.subscribe)||b.isFunction(a.addEventListener)||b.isFunction(a.on)||b.isFunction(a.add)}(a)&&d(a)};"adLinear adWidth adHeight adExpanded adSkippableState adRemainingTime adDuration adVolume adCompanions adIcons".split(" ").forEach(function(b){var d=
"get"+a.uc(b);O.prototype[d]=function(a){this._adUnit[d](a)}});var I=D.extend({init:function w(a,b,d,g,f){w.base.call(this,a,b,d);if(this.isValid=D.checkVPAIDInterface(a))this._creative=a,this.container=b,this.player=f,this._videoEl=d,this._iframe=g,this.addClass("brid-tech"),this._addEvents(),this.isVpaidVideoElementUsed=!1},initAd:function(b,d,v,n,g,f,u){g=g||{};f=a.merge({slot:this.container,videoSlot:this._videoEl,videoSlotCanAutoPlay:!0},f||{});try{this._creative.initAd(b,d,v,n,g,f)}catch(m){var q=
m}u(q)},startAd:function(b,d){d&&a.autoplaySupported&&(d=this.container.getElementsByTagName("video"),Array.prototype.forEach.call(d,function(a){a.setAttribute("muted","");a.muted=!0;a.setAttribute("autoplay","");a.autoplay=!0}));try{this._creative.startAd()}catch(n){var q=n}b(q)},resizeAd:function(b,d,v,n){a.css(this.container,{width:b+"px",height:d+"px"});try{this._creative.resizeAd(b,d,v)}catch(f){var g=f}n(g)},add:function(a,b){B.add(this,a,b)},remove:function(a,b){B.remove(this,a,b)},trigger:function(a,
b,d){return B.trigger(this,a,b,d)},removeAll:function(){B.removeAll(this)},setAdVolume:function(b,d){Brid.log("VPAIDHtml5AdUnit setAdVolume this.isVpaidVideoElementUsed",this.isVpaidVideoElementUsed);Brid.log("VPAIDHtml5AdUnit setAdVolume this._videoEl.src ",this._videoEl.src);Brid.log("VPAIDHtml5AdUnit setAdVolume this._videoEl.muted ",this._videoEl.muted);Brid.log("VPAIDHtml5AdUnit setAdVolume this._videoEl.volume ",this._videoEl.volume);if(""==this._videoEl.src&&!this.isVpaidVideoElementUsed){Brid.log("VPAIDHtml5AdUnit ad video element unknown ABORT");
try{var q=this._creative.getAdVolume();Brid.log("VPAIDHtml5AdUnit ad video element unknown ABORT result",q)}catch(g){console.log(g)}Brid.log("VPAIDHtml5AdUnit ad video element unknown ABORT volume",b);if(0<b){Brid.log("VPAIDHtml5AdUnit ad video element unknown ABORT RETURN");return}}""==this._videoEl.src&&this.isVpaidVideoElementUsed&&(Brid.log("VPAIDHtml5AdUnit setAdVolume iframe.soundAllowed",this._iframe.soundAllowed,this._videoEl.src),a.isMobilePlatform()||this._iframe.soundAllowed||(b=0),a.isAndroid()&&
!this._iframe.soundAllowed&&(Brid.log("VPAIDHtml5AdUnit ANDROID setAdVolume iframe.soundAllowed",this._iframe.soundAllowed,this._videoEl.src),b=0));var n=null;Brid.log("VPAIDHtml5AdUnit setAdVolume",b);try{this._creative.setAdVolume(b),q=this._creative.getAdVolume()}catch(g){n=g}Brid.log("VPAIDHtml5AdUnit setAdVolume result",q);n||q!=b&&(n="failed to apply volume: "+b);d&&d(n,q)},destroy:function(){this.stopAd();this.removeAll();this._removeEvents();this._iframe=this._videoEl=this.container=this._creative=
null},_addEvents:function(){Brid.log("VPAIDHtml5AdUnit _addEvents",this._videoEl,this.player,a.hasTouch());D.EVENTS.forEach(function(a){this._creative.subscribe(this.trigger.bind(this,a),a)}.bind(this));this._creative.subscribe(this.$f(this._clickThruHook),"AdClickThru");if(this._videoEl){var b=this._iframe.contentDocument.documentElement,d=this._videoEl,v=this.player;b.addEventListener("click",function(a){a.target===b&&d.click()});v&&a.hasTouch()&&b.addEventListener("touchstart",function(a){Brid.log("VPAIDHtml5AdUnit touchstart");
v.mouseOver()})}},_removeEvents:function(){D.EVENTS.forEach(function(a){this._creative.unsubscribe(this.trigger.bind(this,a),a)}.bind(this));this._creative.unsubscribe(this.$f(this._clickThruHook),"AdClickThru")},_clickThruHook:function(a,b,d){B.trigger(this,"AdClickThru",{url:a,id:b,playerHandles:d})}});D.METHODS.forEach(function(a){-1==="add remove subscribe unsubscribe initAd startAd resizeAd".split(" ").indexOf(a)&&(I.prototype[a]=function(){var b=D.prototype[a].length,d=Array.prototype.slice.call(arguments),
b=d&&b===d.length?d.pop():void 0,n=null;try{var g=this._creative[a].apply(this._creative,d)}catch(f){n=f}b&&"function"==typeof b&&b(n,g)})});D.GETTERS.forEach(function(a){I.prototype[a]=function(b){var d=null;try{var q=this._creative[a]()}catch(g){d=g}b&&"function"==typeof b&&b(d,q)}});I.prototype.on=I.prototype.add;I.prototype.off=I.prototype.remove;z.MutationObserver=z.MutationObserver||z.WebKitMutationObserver||z.MozMutationObserver;M=Brid.Class.extend({default:{template:'<!DOCTYPE html><html style="padding:0px;height:100%;width:100%;background:transparent;" lang="en"><head><meta charset="UTF-8"></head><body style="overflow:hidden;margin:0px;padding:0px;height:100%;width:100%;max-width:100%;" onload="console.log(\'BODY LOADED\');"></body></html>',
timeout:15E3},init:function(b,d,v){Brid.log("FIRE VPAIDHtml5Tech init",(new Date).getTime());if(!d||"string"!=typeof d.src)throw new k("on VPAIDHtml5Tech, invalid MediaFile");this.config=a.merge(a.deepCopy(this.default)||{},v);this.name="vpaid-html5";this.mediaFile=d;this.container=b;this._videoEl=v.videoEl.el||v.videoEl;this._player=v.player;this._id="vpaid_html5_"+a.nextID++;this._destroyed=!1},_adDestroyed:function(){this._removeAdElements();delete this._adUnit},_removeAdElements:function(){this._frame&&
(this.container.removeChild(this._frame),delete this._frame);if(this._destroyed)for(var a=this.container.childNodes,b=0;b<a.length;b++)"div"!==a[b].nodeName.toLowerCase()||""==a[b].id&&""==a[b].className||this.container.removeChild(a[b]);this._destroyLoadListener()},_unloadPreviousAdUnit:function(){this._removeAdElements();this._destroyAdUnit()},_destroyLoadListener:function(){this._onLoad&&(b.clearCallbackTimeout(this._onLoad),delete this._onLoad)},_destroyAdUnit:function(){this._adUnit&&(this._adUnit.destroy(),
delete this._adUnit)},destroy:function(){this._destroyed||(this._destroyed=!0,this.config.videoEl&&this.config.videoEl.destroy&&(this.config.videoEl.destroy(),this.config.videoEl=null),this._unloadPreviousAdUnit())},loadAdUnit:function(d){Brid.log("FIRE VPAIDHtml5Tech loadAdUnit",(new Date).getTime());if(this._destroyed)Brid.error("VPAIDHTML5Tech already destroyed!");else{this._unloadPreviousAdUnit();this._onLoad=a.$f(this,b.callbackTimeout(this.config.timeout,a.$f(this,function(b){var f;if(v.contentWindow){var g=
v.contentWindow.getVPAIDAd;"function"!=typeof g&&(f="the ad didn't return a function to create an ad")}else f="the iframe is not anymore in the DOM tree";if(!f){b=v.contentWindow.document.getElementById("brid-vpaid-wrapper");a.css(b,{height:"100%"});var q=new I(g(),b,n,v,this._player);q.add("AdStopped",a.$f(this,this._adDestroyed));q.isValid||(f="the add is not fully complaint with VPAID specification")}this._adUnit=q;this._destroyLoadListener();d(f,f?null:q);return!0}),a.$f(this,function(){d(new k("Ad mediafile load timeout",
402),null)})));var q=this.mediaFile.src,v=a.createElement("iframe",{className:"brid-tech",src:"javascript: false",allow:"autoplay",style:"border: 0px; width: 100%; height: 100%; position: absolute; overflow: hidden;"}),n=this._videoEl;this.container.appendChild(v);if(!v||!v.contentWindow)return this._player.destroy(),!1;v.contentWindow.bridVpaidCallback=this._onLoad;n=this._videoEl;v.soundAllowed=!1;b.checkIframeSound(v,"VPAIDHtml5Tech loadAdUnit");v.contentWindow.document.open().write("<body onload=\"var js = document.createElement('script'); js.src = '"+
q+'\'; js.addEventListener(\'load\', function() { window.bridVpaidCallback(); }); document.body.appendChild(js);" style="margin: 0;"><div id="brid-vpaid-wrapper"></div></body>');"undefined"==typeof v.contentWindow.bridVpaidCallback&&(v.contentWindow.bridVpaidCallback=this._onLoad);v.contentWindow.document.close();Brid.log("FIRE write iframe content",(new Date).getTime(),this._iframe);v.setAttribute("SCROLLING","NO");this._frame=v}}});M.supports=function(a){return-1<R.html5.indexOf(a)};l.VPAID_techs.push(M);
var U=Brid.Sprite.extend({default:{responseTimeout:15E3,VPAID_VERSION:"2.0",preferredTech:"html5"},_isAdLoaded:!1,_adUnitEvents:"AdSkipped AdImpression AdDurationChange AdDurationChange AdStarted AdVideoStart AdPlaying AdPaused AdVideoFirstQuartile AdVideoMidpoint AdVideoThirdQuartile AdVideoComplete AdRemainingTimeChange AdClickThru AdUserAcceptInvitation AdUserClose AdUserMinimize AdError AdVolumeChange".split(" "),init:function q(a,b,g,f,d){q.base.call(this,a,f);this.playbackTech=g;this.viewMode=
"normal";this.adsManager=b;this.container=d;this.impressionFired=this._destroyed=!1},playAd:function(a){function b(a,b,g){a||f.impressionFired||(a=new k("Ad is corrupted, impression not fired",402));g.linearAdded&&!a&&f.adsManager.trigger("vast.contentResumeRequested");f.trackTimeInterval&&clearInterval(f.trackTimeInterval);f.mediaTimeout&&clearTimeout(f.mediaTimeout);a&&g&&f._trackError(a,g);d()}function d(){q!=f.player.tech&&(q.currentSrc()&&(q.src(""),q.removeSrc()),q.hide());setTimeout(function(){g.trigger("vast.adEnd")},
0)}var g=this.adsManager,f=this,q=this.playbackTech;Brid.log("VPAIDManager.playAd looking for supported tech...");var t=this.tech=this._findSupportedTech(a,this.config);this._fakeAdUnit=null;this._adFinishCalled=this._adErrored=this._adStarted=!1;g.add("vast.adsCancel",d);g.addOnce(["vast.adEnd","vast.adError"],this.$f(function(){f.trackTimeInterval&&clearInterval(f.trackTimeInterval);f.mediaTimeout&&clearTimeout(f.mediaTimeout);this._adStarted=!1;g.remove("vast.adsCancel",d);try{this.destroy()}catch(J){Brid.error("Brid AdSDK error removing VPAID",
J)}}));if(t)Brid.log("VPAIDManager.playAd found tech: ",t,(new Date).getTime()),this._response=a,G.waterfall([function(b){b(null,t,a)},this.$f(this._loadAdUnit),this.$f(this._playAdUnit),this.$f(this._waitForAdEnd)],this.$f(function(a,g,f){b(a,g,f)}));else{Brid.error("VPAIDManager.playAd could not find suitable tech");var m=new k("on VPAIDManager.playAd, could not find a supported mediaFile",403);b(m,this._fakeAdUnit,a);return null}this._remainingTime=this._duration=this._currentVolume=0;this._validRemainingTime=
!0;return this._fakeAdUnit={_paused:!0,type:"VPAID",pauseAd:function(){f._pauseAdUnit()},resumeAd:function(){f._resumeAdUnit()},isPaused:function(){return f._paused},getSrc:function(){return t.mediaFile},getWidth:function(){return f._width},getHeight:function(){return f._height}}},_findSupportedTech:function(a,b){var d=this.player;if(!a)return null;a=0<a.mediaFiles.length?a.mediaFiles.filter(l.isVPAID):[a.nonLinear];var g=b&&b.preferredTech,f=[],q,t,m;(b=this.videoEl=this.playbackTech.el)&&"fakeVideoElement"===
b.id?this.addChild(b):this.playbackTech.show();var J=0;for(q=a.length;J<q;J+=1){var x=a[J];if(t=l.findSupportedVPAIDTech(x.type)){if(m=g?x.type===g||R[g]&&-1<R[g].indexOf(x.type):!1)return Brid.log("Brid AdSDK call VPAIDTech",t),new t(this.container,x,{videoEl:b,player:d});f.push({mediaFile:x,tech:t})}}return f.length?(d=f[0],new d.tech(this.container,d.mediaFile,{videoEl:b})):null},_createVPAIDAdUnitWrapper:function(a,b,d){return new O(a,{src:b,responseTimeout:d})},_loadAdUnit:function(a,b,d){var g=
this,f=this.config.responseTimeout;Brid.log("VPAIDManager _loadAdUnit",(new Date).getTime());a.loadAdUnit(function(q,t){if(q)return d(q,t,b);try{var m=g._createVPAIDAdUnitWrapper(t,a.mediaFile.src,f);d(null,m,b)}catch(J){d(J,t,b)}})},_playAdUnit:function(a,b,d){this._adUnit=a;b.linearAdded?this.adsManager.trigger("vast.contentPauseRequested"):this.adsManager.trigger("vast.contentResumeRequested");G.waterfall([function(g){g(null,a,b)},this.$f(this._handshake),this.$f(this._initAd),this.$f(this._setupEvents),
this.$f(this._startAd)],d)},_handshake:function(a,b,d){a.handshakeVersion(this.config.VPAID_VERSION,function(g,f){if(g)return d(g,a,b);if(g=f)g=f.split("."),g=parseInt(g[0],10),g=1<=g&&2>=g;return g?d(null,a,b):d(new k('on VPAIDManager._handshake, unsupported version "'+f+'"'),a,b)})},_initAd:function(a,b,d){function g(f){this._adErrored=!0;a.remove("AdError",g);d(new k("on VPAIDManager, Ad unit dispatched an error event ",901,f),a,b)}var f=this.player;a.add("AdLoaded",this.$f(function(){this._isAdLoaded=
!0}));a.add("AdError",this.$f(g));this.adsManager.addOnce("vast.adEnd",this.$f(function(){a.remove("AdError",g)}));a.initAd(f.el.offsetWidth,f.el.offsetHeight,U.VIEW_MODE.NORMAL,-1,{AdParameters:b.adParameters||""},"",function(g){d(g,a,b)})},_createVASTTracker:function(a,b){return new L(a,b)},_setupEvents:function(a,b,d){this.tracker=this._createVASTTracker(a.config.src,b);this._adUnitEvents.forEach(this.$f(function(a){this._adUnit.add(a,this.$f(this._onAdUnitEvent))}));d(null,a,b)},_pauseAdUnit:function(){this._adUnit.pauseAd()},
_resumeAdUnit:function(){this._adUnit.resumeAd()},_removeEvents:function(){this._adUnit&&this._adUnitEvents.forEach(this.$f(function(a){this._adUnit.remove(a,this.$f(this._onAdUnitEvent))}))},_onAdUnitEvent:function(d){function q(a){var b={ASSETURI:u.config.src,CONTENTPLAYHEAD:0};return a?l.parseURLMacro(a,b):null}if(!this._destroyed){var n=this.tracker,g=this.player,f=this.adsManager,u=this._adUnit;switch(d.type){case "AdSkipped":f.trigger("vast.adSkip");n.trackSkip();break;case "AdImpression":Brid.log("AdSDK VPAIDManager on AdImpression");
f.trigger("vast.adImpression");break;case "AdDurationChange":a.throttle(this.$f(function(){u.getAdDuration(this.$f(function(a,b){this._duration=parseInt(a||0>=b?this._response.duration:b);f.trigger("vast.adDurationChange")}))}),2E3,this);break;case "AdStarted":Brid.log("AdSDK VPAIDManager AdStarted");Brid.log("Fire impression on AdStarted");this.impressionFired=!0;n.trackImpressions();u.getAdDuration(this.$f(function(a,b){this._remainingTime=this._duration=parseInt(a||0>=b?this._response.duration:
b);f.trigger("vast.adDurationChange")}));this.mediaTimeout&&clearTimeout(this.mediaTimeout);this.trackTimeInterval&&clearInterval(this.trackTimeInterval);this.trackTimeInterval=setInterval(this.$f(function(){u.getAdRemainingTime(this.$f(function(a,b){a||isNaN(b)?this._validRemainingTime=!1:(this._validRemainingTime=!0,this._remainingTime=parseInt(b||this._duration))}))}),500);u.getAdWidth(this.$f(function(a,b){a||(this._width=b)}));u.getAdHeight(this.$f(function(a,b){a||(this._height=b)}));f.trigger("vast.adStart");
this._paused=!1;this._adStarted=!0;n.trackCreativeView();break;case "AdVideoStart":Brid.log("AdSDK VPAIDManager AdVideoStart isLinear",u._adUnit._creative.getAdLinear());f.trigger("vast.adVideoStart");this._paused=!1;n.trackStart();u.getAdDuration(this.$f(function(a,b){Brid.log("VPAIDManager ad duration",b);-1==b&&(this.vpaidOverlayTimeout=setTimeout(this.$f(this._onVpaidOverlayTimeout),15E3))}));break;case "AdPlaying":Brid.log("AdSDK VPAIDManager AdPlaying");f.trigger("vast.adResume");this._paused=
!1;g.trigger("play");n.trackResume();break;case "AdPaused":a.isMobilePlatform()&&b.checkIframeSound(u._adUnit._iframe,"AdPaused");f.trigger("vast.adPause");this._paused=!0;n.trackPause();break;case "AdVideoFirstQuartile":f.trigger("vast.firstQuartile");n.directTrackQuartile("firstQuartile",1E3*this.getAdCurrentTime());clearTimeout(this.vpaidOverlayTimeout);break;case "AdVideoMidpoint":f.trigger("vast.midpoint");n.directTrackQuartile("midpoint",1E3*this.getAdCurrentTime());break;case "AdVideoThirdQuartile":f.trigger("vast.thirdQuartile");
n.directTrackQuartile("thirdQuartile",1E3*this.getAdCurrentTime());break;case "AdVideoComplete":f.trigger("vast.adVideoComplete");n.trackComplete();this.vpaidNonLinearTimeout=setTimeout(this.$f(this._onVpaidNonLinearTimeout),5E3);break;case "AdRemainingTimeChange":this.trackTimeInterval&&clearInterval(this.trackTimeInterval);u.getAdRemainingTime(this.$f(function(a,b){a||isNaN(b)?this._validRemainingTime=!1:(this._validRemainingTime=!0,this._remainingTime=parseInt(b||this._duration))}));n.trackProgress(1E3*
this.getAdCurrentTime(),!0);break;case "AdClickThru":var t=d.data;!a.isMobilePlatform()&&b.checkIframeSound(u._adUnit._iframe,"AdClickThru");f.trigger("vast.adClickThru");d=t.url;t=t.playerHandles;d=d?d:q(this._response.clickThrough);n.trackClick();t&&d&&z.open(d,"_blank");break;case "AdUserAcceptInvitation":f.trigger("vast.adUserAcceptInvitation");break;case "AdUserMinimize":f.trigger("vast.adUserMinimize");break;case "AdVolumeChange":this._adStarted&&u.getAdVolume(this.$f(function(a,b){this._currentVolume!==
b&&(0===b&&0<this._currentVolume&&n.trackMute(),0<b&&0===this._currentVolume&&n.trackUnmute(),this._currentVolume=b,f.trigger("vast.adVolumeChange"),g.trigger("vast.adVolumeChange"))}))}}},_onVpaidNonLinearTimeout:function(){Brid.log("Stop non Linear VPAID- Banner");this._adUnit._adUnit._creative.stopAd()},_onVpaidOverlayTimeout:function(){Brid.log("Stop non Linear VPAID - Overlay");this._adUnit._adUnit._creative.stopAd()},_addSkipButton:function(a,b,d){function g(b){t=new W(b,{skipOffset:0});t.add("skip",
u.$f(function(){a.skipAd();tracker.trackSkip();u.adsManager.trigger("vast.adSkip")}));u.addChild(t)}function f(){u.removeChild(t);t=null}var u=this,t,m=this.player;a.add("AdSkippableStateChange",function(){u.adsManager.trigger("vast.adSkippableStateChange");a.getAdSkippableState(function(a,b){b?t||g(m):f(m)})});this.addOnce(["vast.adEnd","vast.adsCancel"],f);d(null,a,b)},_startAd:function(b,d,n){this.mediaTimeout&&clearTimeout(this.mediaTimeout);this.mediaTimeout=setTimeout(this.$f(this._onMediaTimeout),
this.config.responseTimeout);if(this._isAdLoaded)this._adLoaded(b,d,n);else{try{a.isMobilePlatform()&&(this._hackVideoMuted(b),this._hackPlayButton(b))}catch(g){Brid.error("AdSDK VPAIDManager hack play button error",g)}b.add("AdLoaded",this.$f(function(){this._adLoaded(b,d,n)}))}},_onMediaTimeout:function(){this._trackError(new k("Ad mediafile load timeout",402),this._response);a.isMobilePlatform()&&a.isIOS()||this.playbackTech.hide()},_adLoaded:function(b,d,n){var g=this.player;Brid.log("\tsetAdVolume _adLoaded");
this.setAdVolume(g.values.muted?0:g.values.volume||0);a.isMobilePlatform()&&(this._hackVideoMuted(b),this._hackPlayButton(b));b.startAd(this.$f(function(a){n(null,b,d)}),g.config.autoplay)},_hackPlayButton:function(a){if(a=a._adUnit._iframe){var b=a.contentDocument?a.contentDocument:a.contentWindow.document,d=new CustomEvent("click",{bubbles:!0,cancelable:!0});b.body&&-1!=b.body.style.background.indexOf('url("data:image')&&b.body.dispatchEvent(d);Array.prototype.map.call(b.getElementsByTagName("svg"),
function(a){a.dispatchEvent(d)});Array.prototype.map.call(b.getElementsByClassName("play_overlay"),function(a){Array.prototype.map.call(b.getElementsByTagName("video"),function(b){!(b.src||b.children&&0!==b.children.length)&&3>b.readyState||a.dispatchEvent(d)})});Array.prototype.map.call(b.getElementsByTagName("video"),function(a){!(a.src||a.children&&0!==a.children.length)&&3>a.readyState||a.play()})}},_hackVideoMuted:function(b){function d(b){var d=b.play;if(b===g.videoEl||b.src||b.children&&0!==
b.children.length)-1===b.className.indexOf(Brid.mainClassName)&&a.css(b,{"-webkit-transform":"translateX(1024px)"}),b.play=function(){function f(d){b.removeEventListener("play",f);a.css(b,{"-webkit-transform":"translateX(0)"})}b.muted=n.values.muted;b.play=d;Brid.log("AdSDK hackVideoMuted _this.videoEl",g.videoEl,n.values.muted);Brid.log("AdSDK hackVideoMuted videoNode",b);Brid.log("AdSDK hackVideoMuted videoNode",b.src);b.addEventListener("error",function(a){});-1===b.className.indexOf(Brid.mainClassName)&&
b.addEventListener("play",f);setTimeout(function(){b.play()},200)}}var n=this.player,g=this;b=b._adUnit._iframe;Array.prototype.map.call((b.contentDocument?b.contentDocument:b.contentWindow.document).getElementsByTagName("video"),d);Array.prototype.map.call(g.container.getElementsByTagName("video"),d)},_waitForAdEnd:function(a,b,d){function g(g){f._adFinishCalled||(Brid.log("VPAIDManager clear timeouts"),clearTimeout(f.vpaidNonLinearTimeout),clearTimeout(f.vpaidOverlayTimeout),this._adFinishCalled=
!0,d(g,a,b))}var f=this;a.add("AdStopped",this.$f(function(){this._adErrored||(this.adsManager.trigger("vast.adStopped"),g(null))}));a.add("AdSkipped",this.$f(function(){this._adErrored||(this.adsManager.trigger("vast.adStopped"),g(null))}));a.add("AdUserClose",this.$f(function(){this._adErrored||(this.adsManager.trigger("vast.adUserClose"),g(null))}))},_trackError:function(a,b){this.trackTimeInterval&&clearInterval(this.trackTimeInterval);l.track(b.errorURLMacros,{ERRORCODE:a.code||901});this.adsManager.adError(a,
b)},stop:function(){this._adUnit.trigger("AdUserClose")},setAdVolume:function(b){var d=this.player;Brid.log("AdSDK VPAIDManager setAdVolume",b);Brid.log("AdSDK VPAIDManager setAdVolume",0===b);if(this._adUnit){Brid.log("this._adUnit._adUnit.isVpaidVideoElementUsed",this._adUnit._adUnit.isVpaidVideoElementUsed);this._adUnit.setAdVolume(b);var n=this._adUnit._adUnit._iframe,g=this._adUnit._adUnit;if(n){var f=n.contentDocument?n.contentDocument:n.contentWindow?n.contentWindow.document:null;f&&Array.prototype.map.call(f.getElementsByTagName("video"),
function(f){g.isVpaidVideoElementUsed=!0;Brid.log("AdSDK VPAIDManager setAdVolume innerDoc iframeNode.soundAllowed",n.soundAllowed);a.isMobilePlatform()&&!a.isAndroid()||n.soundAllowed?f.muted=0===b:(f.muted=!0,a.isAndroid()&&(Brid.log("ANDORID MUTE PLAYER",d,d.tag),d.tag.muted=!0))})}Brid.log("VPAIDManager this.videoEl",this.videoEl);this.videoEl&&this.videoEl.el?(Brid.log("VPAIDManager this.videoEl 1"),this.videoEl.setVolume(b)):this.videoEl&&(Brid.log("VPAIDManager this.videoEl 2"),this.videoEl.muted=
0===b);g.isVpaidVideoElementUsed&&(this.videoEl.muted=!0)}},getAdVolume:function(){return this._currentVolume||0},resize:function(b,d,n,g,f){var u=this;this._response.nonLinear?a.css(this.container,{top:b+"px",left:d+"px"}):a.css(this.container,{top:0,left:0,height:g+"px"});this.tech._adUnit&&!this.tech._adUnit._creative.getAdLinear()&&a.css(this.container,{top:b+"px",left:d+"px",height:g+"px"});u._adUnit.resizeAd(n,g,f,function(a){a||(u._adUnit.getAdWidth(function(a,b){a||(u._width=b)}),u._adUnit.getAdHeight(function(a,
b){a||(u._height=b)}))});u.tracker&&u.viewMode!==f&&(u.viewMode=f,"fullscreen"===f?u.tracker.trackFullscreen():u.tracker.trackExitFullscreen())},getAdDuration:function(){return this._duration},getAdCurrentTime:function(){return this._validRemainingTime&&-.5<this._remainingTime&&this._remainingTime!=this._duration?this._duration-this._remainingTime:this.videoEl&&this.videoEl.currentTime},addChild:function v(a){v.base.call(this,a);this.container.appendChild(a.el)},removeChild:function n(a){this.container.removeChild(a.el);
n.base.call(this,a)},destroy:function g(){this._isAdLoaded=!1;this._destroyed=!0;this.trackTimeInterval&&clearInterval(this.trackTimeInterval);this.mediaTimeout&&clearTimeout(this.mediaTimeout);this._removeEvents();this.tech&&(this.tech.destroy(),this.tech=null);g.base.call(this)}});U.VIEW_MODE={NORMAL:"normal",FULLSCREEN:"fullscreen",THUMBNAIL:"thumbnail"};var xa=Brid.Class.extend({default:{WRAPPER_LIMIT:8},init:function(b,d){var g=a.deepCopy(this.default);this.config=a.merge(g||{},b);this.player=
d;delete this.default;this.waterfallAds=[];this.errorURLMacros=[];this._adChainFork=[]},getVASTResponse:function(a,d){function g(a,b){try{var d=f._buildVASTResponse(a);b(null,d)}catch(C){b(C)}}var f=this;"string"===typeof a||b.isFunction(a)?(f._adChainFork=[],f.waterfallAds=[],G.waterfall([this._getVASTAd.bind(this,a),g],d)):(0<f._adChainFork.length?(f._adChainFork[0].forkLength&&(f._adChainFork[0].forkLength--,0>=f._adChainFork[0].forkLength&&f._adChainFork.shift()),f._adChain=[].concat(f._adChainFork[0]||
[])):f._adChain=[],G.waterfall([this._getAd.bind(this,a,f._adChain),g],d))},_getVASTAd:function(a,f){function g(a,b){var d=[];try{a.forEach(function(a){d.push(new Z(a))}),b(null,d)}catch(C){b(new k("on AdsLoader._buildAd, error parsing VMAP",1002),null)}}var t=this;G.waterfall([this._requestVASTXml.bind(this,a),function(a,f){try{var g=t.vastTree=d.toJXONTree(a);t.player.values.lastVASTXML=(new XMLSerializer).serializeToString(a);if("undefined"!==typeof g.ad)g.ads=b.isArray(g.ad)?g.ad:[g.ad];else if("undefined"!==
typeof g.adBreak)g.adBreaks=b.isArray(g.adBreak)?g.adBreak:[g.adBreak],delete g.adBreak;else if("undefined"!==typeof g.preroll||"undefined"!==typeof g.postroll)g.adBreaks=[],"undefined"!==typeof g.preroll&&(g.preroll["@breakId"]="preroll",g.preroll["@breakType"]="linear",g.preroll["@timeOffset"]="start",g.adBreaks.push(g.preroll),delete g.preroll),"undefined"!==typeof g.postroll&&(g.postroll["@breakId"]="postroll",g.postroll["@breakType"]="linear",g.postroll["@timeOffset"]="end",g.adBreaks.push(g.postroll),
delete g.postroll)}catch(C){f(new k("on AdsLoader._getVASTAd.buildVastWaterfall, error parsing xml",100),null);return}f(t.validateVASTTree(g),g)}],function(a,d){function m(a,b){a?(t._trackError(a,b),0<t.waterfallAds.length?(0<t._adChainFork.length?(t._adChainFork[0].forkLength&&(t._adChainFork[0].forkLength--,0>=t._adChainFork[0].forkLength&&t._adChainFork.shift()),b=[].concat(t._adChainFork[0]||[])):b=[],t._getAd(t.waterfallAds.shift(),b,m)):f(a,b)):f(null,b)}var u=d&&b.isArray(d.ads)?d.ads:null;
d=d&&b.isArray(d.adBreaks)?d.adBreaks:null;if(a)return t._trackError(a,u),f(a,u);u&&0<u.length?(u=t.waterfallAds=t.waterfallAds.concat(u),t._getAd(u.shift(),[],m)):d&&0<d.length?g(d,f):f(new k("on AdsLoader._getVASTAd.validateVASTTree, no Ads in VAST response",303))})},validateVASTTree:function(a){var b=d.attr(a,"version");d.attr(a,"xmlns:vmap");return a.ad||a.adBreaks?b&&3!=b&&2!=b&&a.adBreaks&&1!=b?new k('on AdsLoader._getVASTAd.validateVASTTree, not supported VAST version "'+b+'"',102):b&&a.adBreaks&&
1!=b?new k('on AdsLoader._getVASTAd.validateVASTTree, not supported VMAP version "'+b+'"',1001):null:new k("on AdsLoader._getVASTAd.validateVASTTree, no Ads in VAST response",303)},_getAd:function(a,f,u){function g(a,b){m._requestVASTXml(a,function(a,g){if(a)return b(a);try{m.player.values.lastVASTXML=(new XMLSerializer).serializeToString(g);var f=d.toJXONTree(g);b(m.validateVASTTree(f),f.ad)}catch(ya){b(new k("on AdsLoader._getVASTAd.requestVASTAd, error parsing xml",100))}})}var m=this;this._adChain=
f||[];if(f.length>=m.config.WRAPPER_LIMIT)return u(new k("on AdsLoader._getVASTAd._getAd, players wrapper limit reached (the limit is "+m.config.WRAPPER_LIMIT+")",302),f);G.waterfall([function(b){"string"===typeof a?g(a,b):b(null,a)},function(a,d){b.isArray(a)?d(null,a):m._buildAd(a,d)}],function(a,d){if(b.isArray(d)&&(m.waterfallAds=d.concat(m.waterfallAds),0<m.waterfallAds.length))return a=[].concat(f),a.forkLength=d.length,m._adChainFork.unshift(a),m._getAd(m.waterfallAds.shift(),f,u);d&&f.push(d);
return a?u(a,f):d.wrapper?(d="undefined"!==typeof $BridIq&&$BridIq.isAdBlockEnabled()?"http://lkdasjdsaa98d7sadaslkjds.xyz/?"+btoa(d.wrapper.VASTAdTagURI):d.wrapper.VASTAdTagURI,m._getAd(d,f,u)):u(null,f)})},_buildAd:function(a,b){function d(a){var b=a.wrapper;if((a=a.inLine)&&b)return new k("on AdsLoader._getVASTAd.validateAd, InLine and Wrapper both found on the same Ad",101);if(!a&&!b)return new k("on AdsLoader._getVASTAd.validateAd, nor wrapper nor inline elements found on the Ad",101);if(a&&
0===a.creatives.length)return new k("on AdsLoader._getVASTAd.validateAd, missing creative in InLine element",101);if(b&&!b.VASTAdTagURI)return new k("on AdsLoader._getVASTAd.validateAd, missing 'VASTAdTagURI' in wrapper",101)}try{var g=new Y(a);b(d(g),g)}catch(m){b(new k("on AdsLoader._getVASTAd._buildAd, error parsing xml",100),null)}},_requestVASTXml:function(d,f){function g(a){Brid.log("FIRE XML TAG LOADED",(new Date).getTime());f(null,a)}function t(a){if(0===parseInt(a)&&l)l=!1,Brid.Loader.loadText(b.urlParts(d).href,
g,t,null,l);else return f(new k("undefined"!==typeof a?"on AdsLoader.requestVastXML, HTTP request error with status '"+a+"'":"on AdsLoader.requestVastXML, Error getting the the VAST XML with he passed adTagXML fn",301),null)}function m(a,b,d){return-1!=a.toLowerCase().indexOf(".spotxchange.")?a.replace(new RegExp("="+b.replace(/(\[|])/g,"\\$1"),"gi"),"="+d):a.split(b).join(d).split(b.toUpperCase()).join(d)}var l=!0,x=this.player;try{if(b.isFunction(d))d(requestHandler);else if(a.validateURL(d)){0<
d.indexOf("//googleads")&&10>d.indexOf("//googleads")&&(d="https://ima3vpaid.appspot.com/?adTagUrl="+d+"&type=js");if(-1!=d.toLowerCase().indexOf("[gdpr]")){var C=E.BridIframeBurst?z.top:z;"function"===typeof C.__tcfapi?C.__tcfapi("getTCData",2,function(a,b){d=m(d,"[gdpr]",a.gdprApplies?"1":"0");a.gdprApplies&&-1!=d.toLowerCase().indexOf("[consent]")&&(d=m(d,"[consent]",a.tcString))}):"function"===typeof C.__cmp?C.__cmp("getConsentData",null,function(a){d=m(d,"[gdpr]",a.gdprApplies?"1":"0");a.gdprApplies&&
-1!=d.toLowerCase().indexOf("[consent]")&&(d=m(d,"[consent]",a.consentData))}):d=m(d,"[gdpr]","0")}-1!=d.toLowerCase().indexOf("[us_privacy]")&&(C=E.BridIframeBurst?z.top:z,"function"===typeof C.__uspapi?C.__uspapi("getUSPData",1,function(a,b){d=m(d,"[us_privacy]",b?a.uspString:"")}):d=m(d,"[us_privacy]",""));if(-1!==d.toLowerCase().indexOf("[timestamp]")){var D=(new Date).getTime();d=m(d,"[timestamp]",D)}-1!==d.toLowerCase().indexOf("[referrer_url]")&&(d=m(d,"[referrer_url]",encodeURIComponent(-1!==
d.indexOf("doubleclick")?a.getEmbededUrl():aa.referrer)));-1!==d.toLowerCase().indexOf("[description_url]")&&(d=m(d,"[description_url]",encodeURIComponent(a.getEmbededUrl())));-1!==d.toLowerCase().indexOf("[page_url]")&&(d=m(d,"[page_url]",encodeURIComponent(a.getEmbededUrl())));-1!==d.toLowerCase().indexOf("[video_title]")&&(d=m(d,"[video_title]",encodeURIComponent(x.currentSource.title)));-1!==d.toLowerCase().indexOf("[video_duration]")&&(d=m(d,"[video_duration]",x.duration()||x.currentSource.duration));
-1!==d.toLowerCase().indexOf("[video_id]")&&(d=m(d,"[video_id]",x.currentSource.id));-1!==d.toLowerCase().indexOf("[player_width]")&&x.el&&x.el.clientWidth&&(d=m(d,"[player_width]",x.el.clientWidth));-1!==d.toLowerCase().indexOf("[player_height]")&&x.el&&x.el.clientHeight&&(d=m(d,"[player_height]",x.el.clientHeight));-1!==d.toLowerCase().indexOf("[autoplay]")&&(d=m(d,"[autoplay]",x.config.autoplay?"1":"0"));-1!==d.toLowerCase().indexOf("[description]")&&(d=m(d,"[description]",encodeURIComponent(x.currentSource.description)));
-1!==d.toLowerCase().indexOf("[mediafile_url]")&&(d=m(d,"[mediafile_url]",encodeURIComponent(x.currentSource.src)));-1!==d.toLowerCase().indexOf("[dnt]")&&(d=m(d,"[dnt]",navigator.doNotTrack&&"1"===navigator.doNotTrack?"1":"0"));-1!=d.toLowerCase().indexOf("[uid]")&&(d=m(d,"[uid]",a.getSession()));-1!=d.toLowerCase().indexOf("[video_tags]")&&(d=m(d,"[video_tags]",encodeURIComponent(x.currentSource.tags||"")));if(-1!=d.toLowerCase().indexOf("[brid_")){var B;C=d;for(x=/\[brid_([a-zA-Z0-9_]+)\]/g;B=
x.exec(d);)C=m(C,B[0],encodeURIComponent("undefined"!=typeof bridMacros&&B[1]in bridMacros?bridMacros[B[1]]:""));d=C}if(-1!==d.toLowerCase().indexOf("[user_agent]")){var G=encodeURIComponent(a.ua);d=m(d,"[user_agent]",G)}l=!0;Brid.log("FIRE TAG",d,(new Date).getTime());Brid.Loader.loadText(b.urlParts(d).href,g,t,null,l)}else f(null,d)}catch(wa){f(wa)}},_buildVASTResponse:function(a){a=a.length?a:[a];if("undefined"!==typeof a[0].breakId){var b=new ta;a.forEach(function(a){b.addAdBreak(a)})}else{b=
new sa;a.forEach(function(a){b.addAd(a)});if(b.hasLinear()&&"undefined"===typeof b.duration)throw new k("on AdsLoader._buildVASTResponse, Missing duration field in VAST response",101);(a=b.trackingEvents.progress)&&a.forEach(function(a){if(isNaN(a.offset))throw new k("on AdsLoader._buildVASTResponse, missing or wrong offset attribute on progress tracking event",101);})}return b},_trackError:function(a,d){if(b.isArray(d)&&0!==d.length){var f=[];d.forEach(function(a){a.wrapper&&a.wrapper.error&&f.push(a.wrapper.error);
a.inLine&&a.inLine.error&&f.push(a.inLine.error)});l.track(f,{ERRORCODE:a.code||900})}}});Brid.AdSDK.AdsManager=Brid.Sprite.extend({default:{adCancelTimeout:15E3,adsEnabled:!0},adManager:null,defaultCss:".brid-iab-blocker,.brid-static-container{position:absolute}a.brid-static-container{bottom:50px;left:50%;transform:translateX(-50%);width:fit-content;}.brid-iab-skip-button{display:none;position:absolute;bottom:3em;right:1em;color:#fff;font-size:14px!important;text-align:center;height:3em;padding-left:1em;padding-right:1em;line-height:3em!important;background:#000;background:rgba(0,0,0,.8)}.brid-iab-blocker{top:0;left:0;width:100%;height:100%}.brid-static-container img{display:block;width:100%!important;height:auto!important}",
init:function f(b,d,m){f.base.call(this,b,d);a.createCSS(this.defaultCss,"bridVAST");b.add("error",this.$f(function(){this.adsCanceled=!0}));this.videoSlot=new H({id:b.id+"_video_slot",autoplay:b.config.autoplay,muted:b.values.muted});m.appendChild(this.videoSlot.el);this.videoSlot.el.addEventListener("volumechange",function(a){Brid.log("The volume changed - PLAYER.",b.tag.volume,b.tag.muted);Brid.log("The volume changed - SLOT.",this.videoSlot.el.volume,this.videoSlot.muted());1==this.videoSlot.el.volume&&
!this.videoSlot.muted()&&b.tag.muted&&(Brid.log("Prevent Vpaid volume"),this.videoSlot.el.muted=!0)}.bind(this));this.container=m;this.player.add("newContent",this.$f(this.onNewContent));this.onNewContent();this.adsLoader=new xa({},b)},onNewContent:function(){E.fullscreenEnabled||E.BridIframeBurst&&a.isFF()&&!a.isMobilePlatform()?this.playbackTech=this.videoSlot:this.player.hasHLS&&a.isFacebookApp()&&a.isAndroid()?this.playbackTech=this.videoSlot:this.playbackTech=this.player.tech},requestAd:function(a,
d){this.waitForPlaylistEnd=this.hasAdBreaks=this.adsCanceled=!1;-1!=a.indexOf("correlator=")&&(b.queryStringToObj(a).correlator||(a=a.replace(/correlator=/g,"correlator="+(new Date).getTime())));this.adCancelTimeoutId=setTimeout(this.$f(function(){this.adError(new k("timeout while waiting for the ad to start playing",402))}),this.config.adCancelTimeout);this.adsLoader.getVASTResponse(a,this.$f(function(a,b){this.adsCanceled||(this._clearAdCancelTimeout(),a?this.adError(a,b):(this._response=b,void 0!==
b.adBreaks&&(this.hasAdBreaks=!0,this._playlistResponse=b),d()))}))},_clearAdCancelTimeout:function(){this.adCancelTimeoutId&&(clearTimeout(this.adCancelTimeoutId),this.adCancelTimeoutId=null)},initializePlaybackTech:function(){this.onNewContent();(this.playbackTech!==this.player.tech||this.player.showOnAd())&&this.playbackTech.load()},playAd:function(){var a=this._response||this._playlistResponse;this.adsCanceled||(a||this.adError(new k("On AdsManager, missing required VASTResponse")),this.hasAdBreaks?
this._scheduleAdBreaks():this._doPlayAd(a))},_scheduleAdBreaks:function(){function a(b){(d=this._playlistResponse.prerollAdBreaks())&&0<d.length?this._requestAdBreak(d.shift()):(this.waitForPlaylistEnd=!1,this.remove(["vast.adEnd","vast.adError"],this.$f(a)),this.trigger("vast.contentResumeRequested"))}function b(){(m=this._playlistResponse.postrollAdBreaks())&&0<m.length?this._requestAdBreak(m.shift()):(this.waitForPlaylistEnd=!1,this.remove(["vast.adEnd","vast.adError"],this.$f(b)),this.trigger("vast.contentResumeRequested"))}
var d=[],m=[],k=[],l=this.player;(d=this._playlistResponse.prerollAdBreaks())?d.map(this.$f(function(b,d){0==d&&(l.currentTime()?this._requestAdBreak(b):!l.waitingForAd||l.isPlaying||l.ended()?l.addOnce("beforeStart",this.$f(function(){this.waitForPlaylistEnd=!0;this.add(["vast.adEnd","vast.adError"],this.$f(a));this._requestAdBreak(b)})):(this.waitForPlaylistEnd=!0,this.add(["vast.adEnd","vast.adError"],this.$f(a)),this._requestAdBreak(b)))})):this.trigger("vast.contentResumeRequested");(m=this._playlistResponse.postrollAdBreaks())&&
m.map(this.$f(function(a,d){if(0==d)if(this.player.hasPostroll=!0,l.waitingForAd&&l.ended())this.waitForPlaylistEnd=!0,this.add(["vast.adEnd","vast.adError"],this.$f(b)),this._requestAdBreak(a);else{var f=this.$f(function(){l.getAdInProgress()||(l.remove("ended",f),this.waitForPlaylistEnd=!0,this.add(["vast.adEnd","vast.adError"],this.$f(b)),this._requestAdBreak(a))});l.add("ended",f)}}));if(k=this._playlistResponse.midrollAdBreaks())this._midrollsCheck=this.$f(function(){this.midrollPlaying||l.getAdInProgress()||
this._checkForMidrolls(k)}),l.add("timeupdate",this._midrollsCheck)},_checkForMidrolls:function(a){function b(a,b){return("string"===typeof a.timeOffset?-1==a.timeOffset.indexOf("%")?a.timeOffset:a.timeOffset*d.duration()/100:a.timeOffset)<=b}for(var d=this.player,f=0;f<a.length;){if(b(a[f],d.currentTime())){this.midrollPlaying=!0;this.addOnce(["vast.adEnd","vast.adError"],this.$f(function(){this.midrollPlaying=!1}));this._requestAdBreak(a.shift());break}f++}0==a.length&&d.remove("timeupdate",this._midrollsCheck)},
_requestAdBreak:function(a){function b(a){0<this.adsLoader.vastTree.ads.length?this.adsLoader.getVASTResponse(this.adsLoader.vastTree.ads.shift(),this.$f(d)):this.remove(["vast.adError","vast.adEnd"],this.$f(b))}function d(b,d){if(!this.adsCanceled)if(b)this.currentAdBreak=null,this.adError(b,d);else{this._response=d;this._doPlayAd(d);if(b=a.trackingEvents)b.breakStart&&this.adManager.addOnce("vast.adStart",this.$f(f)),b.breakEnd&&this.adManager.addOnce("vast.adEnd",this.$f(l)),b.error&&this.adManager.addOnce("vast.adError",
this.$f(k));this._clearAdCancelTimeout()}}function f(){this.adManager.tracker.trackEvent("breakStart",!0,a)}function l(){this.adManager.tracker.trackEvent("breakEnd",!0,a)}function k(){this.adManager.tracker.trackEvent("error",!0,a)}a.played||(a.played=!0,this.currentAdBreak=a,this.adsCanceled=!1,a.adSource.allowMultipleAds&&this.add(["vast.adError","vast.adEnd"],this.$f(b)),this.adsLoader.getVASTResponse(a.adSource.adTagURI,this.$f(d)))},_doPlayAd:function(a){if(this.adManager)try{this.adManager.destroy(),
this.adManager=null}catch(m){Brid.error("Brid AdSDK error removing VPAID",m)}this.addOnce("vast.adImpression",this.$f(this._onAdImpressionCheckViewability));var b=a.mediaFiles;a.interactiveCreativeFile&&0<a.interactiveCreativeFile.length&&(b=a.interactiveCreativeFile,a.mediaFilesOriginal=a.mediaFiles,a.mediaFiles=a.interactiveCreativeFile);var d=b.filter(l.isVPAID);0<d.length&&d.length>=b.length?(this.isVPAID=!0,b=new U(this.player,this,this.playbackTech,{responseTimeout:this.config.adCancelTimeout},
this.container)):(this.isVPAID=!1,b=new ua(this.player,this,this.playbackTech,{responseTimeout:this.config.adCancelTimeout},this.container));this.adManager=b;this.adUnit=this.adManager.playAd(a)},_onAdImpressionCheckViewability:function(){function a(){m.player.isPlayerInView()&&!k&&(l=(new Date).getTime(),k=setInterval(b,50))}function b(){if(m.adManager&&m.adManager.tracker){var a=(new Date).getTime(),b=m.isLinear()?2E3:1E3;m.player.isPlayerInView()&&l+b<a?(d(),m.adManager.tracker.trackViewableImpressions(),
m.adManager.tracker.trackEvent("viewable_impression",!0),m.adManager.tracker.trackEvent("measurable_impression",!0)):!m.player.isPlayerInView()&&k&&(clearInterval(k),k=null)}}function d(){B.remove(z,"scroll",a);k&&(clearInterval(k),k=null)}var m=this;if(m.player.isPlayerInView()){var l=(new Date).getTime();var k=setInterval(b,50)}else m.addOnce(["vast.adEnd","vast.adError"],d);B.add(z,"scroll",a)},stopAd:function(){this.adManager&&this.adManager.stop()},reset:function(){this.isVPAID=!1;this.adsCanceled=
!0;this.currentAdBreak=null;if(this.adManager)try{this.adUnit=null,this.adManager.destroy(),this.adManager=null}catch(f){Brid.error("Brid AdSDK error removing VPAID",f)}},destroyAdsLoader:function(){this.adsLoader=null},getAdDuration:function(){return this.isLinear()&&!isNaN(this.adManager.getAdDuration())&&isFinite(this.adManager.getAdDuration())?this.adManager.getAdDuration():"undefined"!=typeof this._response.duration?this._response.duration:0},getAdCurrentTime:function(){return this.isLinear()?
this.adManager.getAdCurrentTime():0},setAdVolume:function(a){0==this.getAdVolume()&&0!=a?this.tracker&&this.tracker.trackUnmute():0!=this.getAdVolume()&&0==a&&this.tracker&&this.tracker.trackMute();this.adManager&&this.adManager.setAdVolume(a)},getAdVolume:function(){return this.adManager?this.adManager.getAdVolume():0},isLinear:function(){var a=!1;this.isVPAID&&this.adManager&&this.adManager.tech&&this.adManager.tech._adUnit&&!this.adManager.tech._adUnit._creative.getAdLinear()&&(a=!0);return this._response&&
!a?this.currentAdBreak&&"linear"==this.currentAdBreak.breakType||this._response.hasLinear():!1},resize:function(b,d,k,m,l){this.playbackTech&&this.isLinear()&&a.css(this.playbackTech,{height:m+"px"},!1,"important");this.adManager&&this.adManager.resize(b,d,k,m,l)},adError:function(a,b){Brid.error(a.message,a,b);this._clearAdCancelTimeout();0<this.adsLoader.waterfallAds.length?(this.adCancelTimeoutId=setTimeout(this.$f(function(){this.adError(new k("timeout while waiting for the ad to start playing",
402))}),this.config.adCancelTimeout),this.adsLoader.getVASTResponse(this.adsLoader.waterfallAds.shift(),this.$f(function(a,b){this.adsCanceled||(a?this.adError(a,b):(this._clearAdCancelTimeout(),this._response=b,void 0!==b.adBreaks&&(this.hasAdBreaks=!0,this._playlistResponse=b),this.playAd()))}))):(this.isVPAID=!1,this.adsCanceled=!0,this.trigger("vast.adError",{error:a}))}});z.$bp.plugin("bridparser",function(a,b){});Brid.event.trigger(E,"bridpluginloaded")})(window,document);
