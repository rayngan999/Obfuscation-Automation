(new R9.logger).time("combined");(function(e){R9.createComponentClass("common.frontdoor.HeroPhotoCover",{options:{backgroundImagePaths:[],lowerQualBackgroundImagePath:"",maskImagePath:"",carouselInterval:8E3},addEventHandlers:function(){this.bindImageLoad.call(this,"img2",this.options.maskImagePath);this.bindImageLoad.call(this,"img1",this.options.lowerQualBackgroundImagePath,"bgSvg");0<this.options.backgroundImagePaths.length&&this.bindImageLoad.call(this,"img3",this.options.backgroundImagePaths[0].imagePath,"circleSvg");1<this.options.backgroundImagePaths.length&&
this.loopCarouselImages()},bindImageLoad:function(a,b,c){0<b.length&&(a=e("#"+a),c?a.one("load",function(){e("."+c).show()}).attr("src",b):a.attr("src",b))},loopCarouselImages:function(){var a=this,b=this.getChildElement("js-images").children(),c=this.getChildElement("js-texts").children(),f=this.options.backgroundImagePaths.length,d=0;setInterval(function(){a.swapClasses(e(b[d]),"CoverWrapper__layout__circleImgLayer__svgWrap__image--active","CoverWrapper__layout__circleImgLayer__svgWrap__image");
a.swapClasses(e(c[d]),"CoverWrapper__layout__circleImgLayer__text__paragraph--active","CoverWrapper__layout__circleImgLayer__text__paragraph");d++;d>=f&&(d=0);a.swapClasses(e(b[d]),"CoverWrapper__layout__circleImgLayer__svgWrap__image","CoverWrapper__layout__circleImgLayer__svgWrap__image--active");a.swapClasses(e(c[d]),"CoverWrapper__layout__circleImgLayer__text__paragraph","CoverWrapper__layout__circleImgLayer__text__paragraph--active")},a.options.carouselInterval)},swapClasses:function(a,b,c){a.removeClass(b);
a.addClass(c)}})})(jQuery);(function(a){a.createComponentClass("common.personalization.SearchHistory",{init:function(){},addEventHandlers:function(){this.subscribe("searchHistory.tileClicked",function(){a.Analytics.api.trackEvent({subPageId:"personalization",category:"searchHistory",action:"itemClicked"})})}})})(R9);(function(){var g=function(a){a=a.split("-");return new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2]))};R9.extend("PredictedPriceSource",{API:function(){}});R9.extend("PredictedPriceSource.API",{searchInfos:{},getPriceDataSetKey:function(a){if(!a)return null;var b=Array.isArray(a.origin)?a.origin[0]:a.origin,c=Array.isArray(a.destination)?a.destination[0]:a.destination;return[b,c,a.dateMode,"Default"].join("|")},getFetchUrl:function(){return R9.config.getString("ui.horizon.common.datepicker.prediction.datasource",
"/a/api/flightPricePrediction/predictCalendar")},updateSearchInfo:function(a,b,c){var e=this.searchInfos[a]||{pendingReqs:[]};c&&(e={pendingReqs:[]});this.searchInfos[a]=$.extend({},e,b);return this.searchInfos[a]},sendFetchRequest:function(a,b){return $.ajax(a,b)},failPendingReqs:function(a,b){if(a&&a.pendingReqs)for(;a.pendingReqs.length;)a.pendingReqs.pop().reject(b)},passPendingReqs:function(a){if(a&&a.pendingReqs)for(;a.pendingReqs.length;)a.pendingReqs.pop().resolve({dataSet:a.dataSet,parameters:a.parameters,
lowestMean:a.lowestMean,highestMean:a.highestMean})},onPriceFetchFail:function(a){var b=this.getPriceDataSetKey(a),b=this.updateSearchInfo(b,{fetched:!0,success:!1});this.failPendingReqs(b,a)},onPriceDataPollSuccess:function(a,b){var c=this.getPriceDataSetKey(a);this.updateSearchInfo(c,{error:b.error,success:b.success,fetched:!0,parameters:b.parameters});if(b.success)this.onPricePredictionFetch(a,b);else this.onPriceFetchFail(a)},dateToStr:function(a){return moment(a).format("YYYY-MM-DD")},getPriceDatum:function(a,
b){if(b)return a=this.dateToStr(a),b[a]},createPriceDatum:function(a,b){a=this.dateToStr(a);b[a]={date:a,returnDates:null,value:null,lastValue:null};return b[a]},onPricePredictionFetch:function(a,b){var c=b.predictions,e=this.getPriceDataSetKey(a),f=this.updateSearchInfo(e,{dataSet:{},expiresOn:moment().add(1,"days").toDate().getTime(),parameters:b.parameters}),d=f.dataSet;d&&(c.forEach(function(a){var b=d[a.startDate];b||(b={date:a.startDate,returnDates:null,value:null,lastValue:null},d[a.startDate]=
b);b.returnDates||(b.returnDates={});b.lOSBucket||(b.lOSBucket=[[],[],[],[]]);var c;c=a.startDate;c=Math.round((g(a.endDate)-g(c))/864E5);b.lOSBucket[3>=c?0:7>=c?1:14>=c?2:3].push(a.minPrice);b.returnDates[a.endDate]={price:a.minPrice,priceDisplay:R9.Common.Utils.formatPrice(a.minPrice,f.parameters.currency),returnDate:a.endDate}}),this.calculateMeanPrices(f)?this.passPendingReqs(f,a):(f.success=!1,this.failPendingReqs(f,a)))},calculateMeanPrices:function(a){var b=a.dataSet,c=Infinity,e=0,f=!1;Object.keys(b).forEach(function(d){b.hasOwnProperty(d)&&
(d=b[d],d.meanPrice=.28*this.calcMean(d.lOSBucket[0])+.33*this.calcMean(d.lOSBucket[1])+.21*this.calcMean(d.lOSBucket[2])+.18*this.calcMean(d.lOSBucket[3]),d.meanPriceDisplay=R9.Common.Utils.formatPrice(d.meanPrice,a.parameters.currency),f=!isNaN(d.meanPrice),c=Math.min(c,d.meanPrice),e=Math.max(e,d.meanPrice))}.bind(this));a.lowestMean={price:c,display:R9.Common.Utils.formatPrice(c,a.parameters.currency)};a.highestMean={price:e,display:R9.Common.Utils.formatPrice(e,a.parameters.currency)};return f},
calcMean:function(a){return a.reduce(function(a,c){return a+c},0)/a.length},fetchData:function(a,b){var c=new $.Deferred;if(!a)return c.reject("Incorrect url parameters"),c;var e=this.getPriceDataSetKey(a),f=this.getFetchUrl(a),d=this.updateSearchInfo(e,{});d.pendingReqs.push(c);d.expiresOn&&d.expiresOn<Date.now()&&(d=this.updateSearchInfo(e,{},!0));if(d.dataSet&&d.success)return this.passPendingReqs(d,a),c;if(d.xhr&&4!==d.xhr.readyState)return c;a=$.extend({},{data:this.createReqBody(a),success:this.onPriceDataPollSuccess.bind(this,
a),error:this.onPriceFetchFail.bind(this,a)},b);d.xhr=this.sendFetchRequest(f,a);return c},createReqBody:function(a){a=$.extend({},a);Array.isArray(a.origin)&&(a.origin=a.origin[0]);Array.isArray(a.destination)&&(a.destination=a.destination[0]);return a}});R9.extend("PredictedPriceSourceColorCoded",{API:function(){},sources:{single:"/a/api/flightPricePrediction/coloredCalendar/oneWay",range:"/a/api/flightPricePrediction/coloredCalendar/roundTrip"}});R9.extend("PredictedPriceSourceColorCoded.API",
R9.PredictedPriceSource.API,{getFetchUrl:function(a){return R9.config.getString("ui.horizon.common.datepicker.colorcoded.datasource."+a.dateMode,R9.PredictedPriceSourceColorCoded.sources[a.dateMode])},onPricePredictionFetch:function(a,b){var c=this.getPriceDataSetKey(a),c=this.updateSearchInfo(c,{dataSet:Object.keys(b.calendar).reduce(function(a,c){var d=b.calendar[c];a[c]={date:c,meanPrice:d.avgPrice,colorFromServer:d.color,meanPriceDisplay:R9.Common.Utils.formatPrice(d.avgPrice,b.parameters.currency)};
return a},{}),expiresOn:moment().add(1,"days").toDate().getTime(),parameters:b.parameters});c.dataSet&&this.passPendingReqs(c,a)},passPendingReqs:function(a){if(a&&a.pendingReqs)for(;a.pendingReqs.length;)a.pendingReqs.pop().resolve({dataSet:a.dataSet,parameters:a.parameters})},createReqBody:function(a){return Object.keys(a).reduce(function(b,c){var e=a[c];Array.isArray(e)?e.forEach(function(a){b.push([c,a])}):b.push([c,e]);return b},[]).map(function(a){return a[0]+"\x3d"+a[1]}).join("\x26")},getPriceDataSetKey:function(a){if(!a)return null;
var b=Array.isArray(a.origin)?a.origin.sort().join():a.origin,c=Array.isArray(a.destination)?a.destination.sort().join():a.destination;return[b,c,a.dateMode,"ColorCoded"].join("|")}});R9.extend("PredictedPriceSourceHistory",{API:function(){}});R9.extend("PredictedPriceSourceHistory.API",R9.PredictedPriceSource.API,{getFetchUrl:function(){return R9.config.getString("ui.horizon.common.datepicker.prediction.datasource","/a/api/flightPricePrediction/predictCalendarHistoric")},getPriceDataSetKey:function(a){if(!a)return null;
var b=Array.isArray(a.origin)?a.origin[0]:a.origin,c=Array.isArray(a.destination)?a.destination[0]:a.destination;return[b,c,a.dateMode,"Historic"].join("|")}})})();(function(d,e){d.createComponentClass("common.widgets.datepicker.PredictionDataProvider",{state:{searchInfos:{}},fdFormQuestion:"flights.fd.searchform",rpFormQuestion:"flights.rp.searchform",options:{formId:"",onFetchSuccess:e.noop(),onFetchFail:e.noop(),origDestListenersOff:!1,origin:null,destination:null,nonStopOnly:!1,dateMode:"range",api:d.PredictedPriceSource.API,loadingDataCallback:e.noop(),doneLoadingCallback:e.noop(),airportMultiSelectEnabled:!1,distinct:!1},swap:{origin:!1,destination:!1},
init:function(){this.origin=this.options.origin;this.destination=this.options.destination;this.setDateMode(this.options.dateMode);this.nonStopOnly=this.options.nonStopOnly;this.distinct=this.options.distinct},addEventHandlers:function(){var a=this;this.subscribe("widgets.datepicker.PredictionDataProvider.fetchPriceInCalendar",function(a){this.fetchPricesInCalendar(a)}.bind(this));!this.options.origDestListenersOff&&this.options.formId&&(this.options.airportMultiSelectEnabled?(this.subscribe(["flights.search.rtow.form.origin.changed",
"flights.search.rtow.form.destination.changed"],{id:this.options.formId},this.populateOriginAndDestinationFromSearchForm.bind(this,this.fdFormQuestion)),this.subscribe(["flights.inline.search.rtow.form.origin","flights.inline.search.rtow.form.destination"],{id:this.options.formId},this.populateOriginAndDestinationFromSearchForm.bind(this,this.rpFormQuestion))):(this.subscribe("flights.search.rtow.form.origin",{id:this.options.formId},function(b){a.setOrigin(b)}),this.subscribe("flights.search.rtow.form.destination",
{id:this.options.formId},function(b){a.setDestination(b)}),this.subscribe("flights.inline.search.rtow.form.origin",{id:this.options.formId},function(b){a.setOrigin(b,!0)}),this.subscribe("flights.inline.search.rtow.form.destination",{id:this.options.formId},function(b){a.setDestination(b,!0)})),this.subscribe("flights.search.rtow.form.displayCat",{id:this.options.formId},function(b){a.setTripType(b.displayCat)}))},populateOriginAndDestinationFromSearchForm:function(a){a=d.question.ask([a,this.options.formId].join("_"));
var b=[],c=[];a&&a.originMultiAirports&&a.originMultiAirports.length&&(b=b.concat(this.processSmartyData(a.originMultiAirports)));a&&a.destinationMultiAirports&&a.destinationMultiAirports.length&&(c=c.concat(this.processSmartyData(a.destinationMultiAirports)));this.origin=b;this.destination=c;this.fetchPricesInCalendar()},swapOD:function(){this.swap.origin&&this.swap.destination&&(this.swap={origin:!1,destination:!1},this.fetchPricesInCalendar())},setOrigin:function(a,b){if(a&&this.options.airportMultiSelectEnabled){b=
d.question.ask([b?this.rpFormQuestion:this.fdFormQuestion,this.options.formId].join("_"));var c=[];a.originCode&&c.push(this.getDataObject(a.originCode.split("/")[0],a.originLocation));null!==b&&b.originMultiAirports&&b.originMultiAirports.length&&(c=c.concat(this.processSmartyData(b.originMultiAirports)));this.origin=c;a.odSwitch?(this.swap.origin=!0,this.swapOD()):this.fetchPricesInCalendar()}else a&&a.originCode?this.origin&&this.origin.originCode===a.originCode||(this.origin=a,a.odSwitch?(this.swap.origin=
!0,this.swapOD()):this.fetchPricesInCalendar()):this.origin=null},setDestination:function(a,b){if(a&&this.options.airportMultiSelectEnabled){b=d.question.ask([b?this.rpFormQuestion:this.fdFormQuestion,this.options.formId].join("_"));var c=[];a.destinationCode&&c.push(this.getDataObject(a.destinationCode.split("/")[0],a.destinationLocation));null!==b&&b.destinationMultiAirports&&b.destinationMultiAirports.length&&(c=c.concat(this.processSmartyData(b.destinationMultiAirports)));this.destination=c;a.odSwitch?
(this.swap.destination=!0,this.swapOD()):this.fetchPricesInCalendar()}else a&&a.destinationCode?this.destination&&this.destination.destinationCode===a.destinationCode||(this.destination=a,a.odSwitch?(this.swap.destination=!0,this.swapOD()):this.fetchPricesInCalendar()):this.destination=null},setTripType:function(a){this._setDateModeFromTripType(a)},_setDateModeFromTripType:function(a){"oneway"===a?this.setDateMode("single"):"roundtrip"===a?this.setDateMode("range"):this.setDateMode(null);this.dateMode&&
this.fetchPricesInCalendar()},setDateMode:function(a){this.dateMode=a},setFilters:function(a){a&&(this.nonStopOnly=!!a.nonstopOnly)},processSmartyData:function(a){var b=this;return a.map(function(a){return b.getDataObject(a.code,a.display)})},getDataObject:function(a,b){return{code:a,display:b}},fetchPricesInCalendar:function(a){(a=a||this.getPostData())&&this.getDataSet(a).then(this.options.onFetchSuccess.bind(this,this.getSearchIdCacheKey(a))).catch(this.options.onFetchFail.bind(this))},getSearchIdCacheKey:function(a){a=
a||this.getPostData();return this.options.api.getPriceDataSetKey(a)},beforeSend:function(){this.options.loadingDataCallback&&this.options.loadingDataCallback()},onComplete:function(){this.options.doneLoadingCallback&&this.options.doneLoadingCallback()},canFetchData:function(){return this.origin&&this.destination&&this.dateMode&&(!this.options.airportMultiSelectEnabled||0!==this.origin.length&&0!==this.destination.length)&&""!==this.origin.originCode&&""!==this.destination.destinationCode?!0:!1},getPostData:function(){if(this.canFetchData()){var a=
{dateMode:this.dateMode,distinct:this.distinct};this.options.airportMultiSelectEnabled?(a.origin=this.origin.map(function(a){return a.code}),a.destination=this.destination.map(function(a){return a.code})):(a.origin=this.origin.originCode.split("/")[0],a.destination=this.destination.destinationCode.split("/")[0],a.nonstopOnly=this.nonStopOnly);return a}},getDataSet:function(a){a=a||this.getPostData();return this.options.api.fetchData(a,{beforeSend:this.beforeSend.bind(this),onComplete:this.onComplete.bind(this)})},
getPriceDatum:function(a,b){return this.options.api.getPriceDatum(a,b)},setOptions:function(a){var b=Object.getOwnPropertyNames(this.options),c=Object.getOwnPropertyNames(a).reduce(function(c,d){0<=b.indexOf(d)&&(c[d]=a[d]);return c},{});this.options=e.extend({},this.options,c)}})})(R9,jQuery);(function(){function D(a){return a&&(a.ownerDocument&&a.ownerDocument.defaultView||a.document&&a||a.defaultView)}function S(a,b){return b>a?-1:a>b?1:a>=b?0:NaN}function O(a){return null===a?NaN:+a}function ua(a){return!isNaN(a)}function f(a){return{left:function(b,c,d,e){3>arguments.length&&(d=0);for(4>arguments.length&&(e=b.length);e>d;){var g=d+e>>>1;0>a(b[g],c)?d=g+1:e=g}return d},right:function(b,c,d,e){3>arguments.length&&(d=0);for(4>arguments.length&&(e=b.length);e>d;){var g=d+e>>>1;0<a(b[g],
c)?e=g:d=g+1}return d}}}function m(a){return a.length}function p(a,b){for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}function v(){this._=Object.create(null)}function z(a){return(a+="")===zg||a[0]===xc?xc+a:a}function P(a){return(a+="")[0]===xc?a.slice(1):a}function J(a){return z(a)in this._}function aa(a){return(a=z(a))in this._&&delete this._[a]}function ja(){var a=[],b;for(b in this._)a.push(P(b));return a}function Sd(){var a=0,b;for(b in this._)++a;return a}function pa(){for(var a in this._)return!1;
return!0}function yc(){this._=Object.create(null)}function Z(a){return a}function Ag(a,b,c){return function(){var d=c.apply(b,arguments);return d===b?a:d}}function zc(a,b){if(b in a)return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(var c=0,d=Td.length;d>c;++c){var e=Td[c]+b;if(e in a)return e}}function X(){}function Ac(){}function Ud(a){function b(){for(var b,d=c,k=-1,h=d.length;++k<h;)(b=d[k].on)&&b.apply(this,arguments);return a}var c=[],d=new v;return b.on=function(b,g){var e,h=d.get(b);return 2>
arguments.length?h&&h.on:(h&&(h.on=null,c=c.slice(0,e=c.indexOf(h)).concat(c.slice(e+1)),d.remove(b)),g&&c.push(d.set(b,{on:g})),a)},b}function Ba(){l.event.preventDefault()}function Bc(){for(var a,b=l.event;a=b.sourceEvent;)b=a;return b}function Cc(a){for(var b=new Ac,c=0,d=arguments.length;++c<d;)b[arguments[c]]=Ud(b);return b.of=function(c,d){return function(g){try{var e=g.sourceEvent=l.event;g.target=a;l.event=g;b[g.type].apply(c,d)}finally{l.event=e}}},b}function Ca(a){return xb(a,Q),a}function Dc(a){return"function"==
typeof a?a:function(){return Ec(a,this)}}function Vd(a){return"function"==typeof a?a:function(){return Fc(a,this)}}function Wd(a,b){function c(){this.removeAttribute(a)}function d(){this.removeAttributeNS(a.space,a.local)}function e(){this.setAttribute(a,b)}function g(){this.setAttributeNS(a.space,a.local,b)}function k(){var c=b.apply(this,arguments);null==c?this.removeAttribute(a):this.setAttribute(a,c)}function h(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,
a.local,c)}return a=l.ns.qualify(a),null==b?a.local?d:c:"function"==typeof b?a.local?h:k:a.local?g:e}function Xd(a){return new RegExp("(?:^|\\s+)"+l.requote(a)+"(?:\\s+|$)","g")}function Yd(a,b){function c(){for(var c=-1;++c<e;)a[c](this,b)}function d(){for(var c=-1,d=b.apply(this,arguments);++c<e;)a[c](this,d)}a=(a+"").trim().split(/^|\s+/).map(Bg);var e=a.length;return"function"==typeof b?d:c}function Bg(a){var b=Xd(a);return function(c,d){if(e=c.classList)return d?e.add(a):e.remove(a);var e=c.getAttribute("class")||
"";d?(b.lastIndex=0,b.test(e)||c.setAttribute("class",(e+" "+a).trim().replace(/\s+/g," "))):c.setAttribute("class",e.replace(b," ").trim().replace(/\s+/g," "))}}function Zd(a,b,c){function d(){this.style.removeProperty(a)}function e(){this.style.setProperty(a,b,c)}function g(){var d=b.apply(this,arguments);null==d?this.style.removeProperty(a):this.style.setProperty(a,d,c)}return null==b?d:"function"==typeof b?g:e}function $d(a,b){function c(){delete this[a]}function d(){this[a]=b}function e(){var c=
b.apply(this,arguments);null==c?delete this[a]:this[a]=c}return null==b?c:"function"==typeof b?e:d}function ae(a){function b(){var b=this.ownerDocument,c=this.namespaceURI;return c===Gc&&b.documentElement.namespaceURI===Gc?b.createElement(a):b.createElementNS(c,a)}function c(){return this.ownerDocument.createElementNS(a.space,a.local)}return"function"==typeof a?a:(a=l.ns.qualify(a)).local?c:b}function Cg(){var a=this.parentNode;a&&a.removeChild(this)}function be(a){return function(){return Hc(this,
a)}}function Dg(a){return arguments.length||(a=S),function(b,c){return b&&c?a(b.__data__,c.__data__):!b-!c}}function va(a,b){for(var c=0,d=a.length;d>c;c++)for(var e,g=a[c],k=0,h=g.length;h>k;k++)(e=g[k])&&b(e,k,c);return a}function ce(a){return xb(a,wa),a}function Eg(a){var b,c;return function(d,e,g){d=a[g].update;var k=d.length;g!=c&&(c=g,b=0);for(e>=b&&(b=e+1);!(e=d[b])&&++b<k;);return e}}function de(a,b,c){function d(){var b=this[k];b&&(this.removeEventListener(a,b,b.$),delete this[k])}function e(){var g=
n(b,qa(arguments));d.call(this);this.addEventListener(a,this[k]=g,g.$=c);g._=b}function g(){var b,c=new RegExp("^__on([^.]+)"+l.requote(a)+"$"),d;for(d in this)if(b=d.match(c)){var g=this[d];this.removeEventListener(b[1],g,g.$);delete this[d]}}var k="__on"+a,h=a.indexOf("."),n=ee;0<h&&(a=a.slice(0,h));var q=Ic.get(a);return q&&(a=q,n=Fg),h?b?e:d:b?X:g}function ee(a,b){return function(c){var d=l.event;l.event=c;b[0]=this.__data__;try{a.apply(this,b)}finally{l.event=d}}}function Fg(a,b){var c=ee(a,
b);return function(a){var b=a.relatedTarget;b&&(b===this||8&b.compareDocumentPosition(this))||c.call(this,a)}}function yb(a){var b=".dragsuppress-"+ ++Gg,c="click"+b,d=l.select(D(a)).on("touchmove"+b,Ba).on("dragstart"+b,Ba).on("selectstart"+b,Ba);if(null==La&&(La="onselectstart"in a?!1:zc(a.style,"userSelect")),La){var e=(a&&(a.ownerDocument||a.document||a).documentElement).style,g=e[La];e[La]="none"}return function(a){if(d.on(b,null),La&&(e[La]=g),a){var h=function(){d.on(c,null)};d.on(c,function(){Ba();
h()},!0);setTimeout(h,0)}}}function Jc(a,b){b.changedTouches&&(b=b.changedTouches[0]);var c=a.ownerSVGElement||a;if(c.createSVGPoint){var d=c.createSVGPoint();if(0>Kc&&(c=D(a),c.scrollX||c.scrollY)){var c=l.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"),e=c[0][0].getScreenCTM();Kc=!(e.f||e.e);c.remove()}return Kc?(d.x=b.pageX,d.y=b.pageY):(d.x=b.clientX,d.y=b.clientY),d=d.matrixTransform(a.getScreenCTM().inverse()),[d.x,d.y]}d=a.getBoundingClientRect();
return[b.clientX-d.left-a.clientLeft,b.clientY-d.top-a.clientTop]}function Hg(){return l.event.changedTouches[0].identifier}function Lc(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function fe(a){return 1<a?0:-1>a?M:Math.acos(a)}function Da(a){return 1<a?V:-1>a?-V:Math.asin(a)}function ge(a){return((a=Math.exp(a))+1/a)/2}function he(a){return(a=Math.sin(a/2))*a}function Ma(){}function ra(a,b,c){return this instanceof ra?(this.h=+a,this.s=+b,void(this.l=+c)):2>arguments.length?a instanceof
ra?new ra(a.h,a.s,a.l):ie(""+a,je,ra):new ra(a,b,c)}function Mc(a,b,c){function d(a){return 360<a?a-=360:0>a&&(a+=360),60>a?e+(g-e)*a/60:180>a?g:240>a?e+(g-e)*(240-a)/60:e}var e,g;return a=isNaN(a)?0:0>(a%=360)?a+360:a,b=isNaN(b)?0:0>b?0:1<b?1:b,c=0>c?0:1<c?1:c,g=.5>=c?c*(1+b):c+b-c*b,e=2*c-g,new da(Math.round(255*d(a+120)),Math.round(255*d(a)),Math.round(255*d(a-120)))}function ka(a,b,c){return this instanceof ka?(this.h=+a,this.c=+b,void(this.l=+c)):2>arguments.length?a instanceof ka?new ka(a.h,
a.c,a.l):a instanceof la?ke(a.l,a.a,a.b):ke((a=le((a=l.rgb(a)).r,a.g,a.b)).l,a.a,a.b):new ka(a,b,c)}function Nc(a,b,c){return isNaN(a)&&(a=0),isNaN(b)&&(b=0),new la(c,Math.cos(a*=K)*b,Math.sin(a)*b)}function la(a,b,c){return this instanceof la?(this.l=+a,this.a=+b,void(this.b=+c)):2>arguments.length?a instanceof la?new la(a.l,a.a,a.b):a instanceof ka?Nc(a.h,a.c,a.l):le((a=da(a)).r,a.g,a.b):new la(a,b,c)}function me(a,b,c){a=(a+16)/116;b=a+b/500;c=a-c/200;return b=Oc(b)*ne,a=Oc(a)*oe,c=Oc(c)*pe,new da(Pc(3.2404542*
b-1.5371385*a-.4985314*c),Pc(-.969266*b+1.8760108*a+.041556*c),Pc(.0556434*b-.2040259*a+1.0572252*c))}function ke(a,b,c){return 0<a?new ka(Math.atan2(c,b)*U,Math.sqrt(b*b+c*c),a):new ka(NaN,NaN,a)}function Oc(a){return.206893034<a?a*a*a:(a-4/29)/7.787037}function Qc(a){return.008856<a?Math.pow(a,1/3):7.787037*a+4/29}function Pc(a){return Math.round(255*(.00304>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055))}function da(a,b,c){return this instanceof da?(this.r=~~a,this.g=~~b,void(this.b=~~c)):2>arguments.length?
a instanceof da?new da(a.r,a.g,a.b):ie(""+a,da,Mc):new da(a,b,c)}function zb(a){return new da(a>>16,a>>8&255,255&a)+""}function Xa(a){return 16>a?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function ie(a,b,c){var d,e,g,k=0,h=0,n=0;if(d=/([a-z]+)\((.*)\)/.exec(a=a.toLowerCase()))switch(e=d[2].split(","),d[1]){case "hsl":return c(parseFloat(e[0]),parseFloat(e[1])/100,parseFloat(e[2])/100);case "rgb":return b(Rc(e[0]),Rc(e[1]),Rc(e[2]))}return(g=Ab.get(a))?b(g.r,g.g,g.b):(null==a||"#"!==
a.charAt(0)||isNaN(g=parseInt(a.slice(1),16))||(4===a.length?(k=(3840&g)>>4,k|=k>>4,h=240&g,h|=h>>4,n=15&g,n|=n<<4):7===a.length&&(k=(16711680&g)>>16,h=(65280&g)>>8,n=255&g)),b(k,h,n))}function je(a,b,c){var d,e,g=Math.min(a/=255,b/=255,c/=255),k=Math.max(a,b,c),h=k-g,n=(k+g)/2;return h?(e=.5>n?h/(k+g):h/(2-k-g),d=a==k?(b-c)/h+(c>b?6:0):b==k?(c-a)/h+2:(a-b)/h+4,d*=60):(d=NaN,e=0<n&&1>n?0:d),new ra(d,e,n)}function le(a,b,c){a=Sc(a);b=Sc(b);c=Sc(c);var d=Qc((.4124564*a+.3575761*b+.1804375*c)/ne),e=
Qc((.2126729*a+.7151522*b+.072175*c)/oe);a=Qc((.0193339*a+.119192*b+.9503041*c)/pe);return la(116*e-16,500*(d-e),200*(e-a))}function Sc(a){return.04045>=(a/=255)?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Rc(a){var b=parseFloat(a);return"%"===a.charAt(a.length-1)?Math.round(2.55*b):b}function R(a){return"function"==typeof a?a:function(){return a}}function Tc(a){return function(b,c,d){return 2===arguments.length&&"function"==typeof c&&(d=c,c=null),Bb(b,c,a,d)}}function Bb(a,b,c,d){function e(){var a,
b=n.status,d;if(d=!b)d=(d=n.responseType)&&"text"!==d?n.response:n.responseText;if(d||200<=b&&300>b||304===b){try{a=c.call(g,n)}catch(E){return void k.error.call(g,E)}k.load.call(g,a)}else k.error.call(g,n)}var g={},k=l.dispatch("beforesend","progress","load","error"),h={},n=new XMLHttpRequest,q=null;return!this.XDomainRequest||"withCredentials"in n||!/^(http(s)?:)?\/\//.test(a)||(n=new XDomainRequest),"onload"in n?n.onload=n.onerror=e:n.onreadystatechange=function(){3<n.readyState&&e()},n.onprogress=
function(a){var b=l.event;l.event=a;try{k.progress.call(g,n)}finally{l.event=b}},g.header=function(a,b){return a=(a+"").toLowerCase(),2>arguments.length?h[a]:(null==b?delete h[a]:h[a]=b+"",g)},g.mimeType=function(a){return arguments.length?(b=null==a?null:a+"",g):b},g.responseType=function(a){return arguments.length?(q=a,g):q},g.response=function(a){return c=a,g},["get","post"].forEach(function(a){g[a]=function(){return g.send.apply(g,[a].concat(qa(arguments)))}}),g.send=function(c,d,e){if(2===arguments.length&&
"function"==typeof d&&(e=d,d=null),n.open(c,a,!0),null==b||"accept"in h||(h.accept=b+",*/*"),n.setRequestHeader)for(var r in h)n.setRequestHeader(r,h[r]);return null!=b&&n.overrideMimeType&&n.overrideMimeType(b),null!=q&&(n.responseType=q),null!=e&&g.on("error",e).on("load",function(a){e(null,a)}),k.beforesend.call(g,n),n.send(null==d?null:d),g},g.abort=function(){return n.abort(),g},l.rebind(g,k,"on"),null==d?g:g.get(Ig(d))}function Ig(a){return 1===a.length?function(b,c){a(null==b?c:null)}:a}function Cb(a,
b,c){var d=arguments.length;2>d&&(b=0);3>d&&(c=Date.now());d={c:a,t:c+b,n:null};return Db?Db.n=d:Eb=d,Db=d,Fb||(Gb=clearTimeout(Gb),Fb=1,qe(Uc)),d}function Uc(){var a=re(),a=se()-a;24<a?(isFinite(a)&&(clearTimeout(Gb),Gb=setTimeout(Uc,a)),Fb=0):(Fb=1,qe(Uc))}function re(){for(var a=Date.now(),b=Eb;b;)a>=b.t&&b.c(a-b.t)&&(b.c=null),b=b.n;return a}function se(){for(var a,b=Eb,c=1/0;b;)b.c?(b.t<c&&(c=b.t),b=(a=b).n):b=a?a.n=b.n:Eb=b.n;return Db=a,c}function Vc(a,b){return b-(a?Math.ceil(Math.log(a)/
Math.LN10):1)}function Jg(a){var b=a.decimal,c=a.thousands,d=a.grouping,e=a.currency,g=d&&c?function(a,b){for(var g=a.length,e=[],h=0,k=d[0],f=0;0<g&&0<k&&(f+k+1>b&&(k=Math.max(1,b-f)),e.push(a.substring(g-=k,g+k)),!((f+=k+1)>b));)k=d[h=(h+1)%d.length];return e.reverse().join(c)}:Z;return function(a){a=te.exec(a);var c=a[1]||" ",d=a[2]||"\x3e",k=a[3]||"-",r=a[4]||"",f=a[5],t=+a[6],E=a[7],A=a[8],L=a[9],m=1,I="",x="",y=!1,C=!0;switch(A&&(A=+A.substring(1)),(f||"0"===c&&"\x3d"===d)&&(f=c="0",d="\x3d"),
L){case "n":E=!0;L="g";break;case "%":m=100;x="%";L="f";break;case "p":m=100;x="%";L="r";break;case "b":case "o":case "x":case "X":"#"===r&&(I="0"+L.toLowerCase());case "c":C=!1;case "d":y=!0;A=0;break;case "s":m=-1,L="r"}"$"===r&&(I=e[0],x=e[1]);"r"!=L||A||(L="g");null!=A&&("g"==L?A=Math.max(1,Math.min(21,A)):"e"!=L&&"f"!=L||(A=Math.max(0,Math.min(20,A))));var L=Kg.get(L)||Lg,N=f&&E;return function(a){var e=x;if(y&&a%1)return"";var h=0>a||0===a&&0>1/a?(a=-a,"-"):"-"===k?"":k;0>m?(e=l.formatPrefix(a,
A),a=e.scale(a),e=e.symbol+x):a*=m;a=L(a,A);var n,q,r=a.lastIndexOf(".");0>r?(r=C?a.lastIndexOf("e"):-1,0>r?(n=a,q=""):(n=a.substring(0,r),q=a.substring(r))):(n=a.substring(0,r),q=b+a.substring(r+1));!f&&E&&(n=g(n,1/0));var r=I.length+n.length+q.length+(N?0:h.length),u=t>r?Array(r=t-r+1).join(c):"";return N&&(n=g(u+n,u.length?t-q.length:1/0)),h+=I,a=n+q,("\x3c"===d?h+a+u:"\x3e"===d?u+h+a:"^"===d?u.substring(0,r>>=1)+h+a+u.substring(r):h+(N?a:u+a))+e}}}function Lg(a){return a+""}function xa(){this._=
new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function Na(a,b,c){function d(b){var c=a(b),d=g(c,1);return d-b>b-c?c:d}function e(c){return b(c=a(new ba(c-1)),1),c}function g(a,c){return b(a=new ba(+a),c),a}function k(a,d,g){a=e(a);var h=[];if(1<g)for(;d>a;)c(a)%g||h.push(new Date(+a)),b(a,1);else for(;d>a;)h.push(new Date(+a)),b(a,1);return h}a.floor=a;a.round=d;a.ceil=e;a.offset=g;a.range=k;var h=a.utc=Hb(a);return h.floor=h,h.round=Hb(d),h.ceil=Hb(e),h.offset=Hb(g),h.range=
function(a,b,c){try{ba=xa;var d=new xa;return d._=a,k(d,b,c)}finally{ba=Date}},a}function Hb(a){return function(b,c){try{ba=xa;var d=new xa;return d._=b,a(d,c)._}finally{ba=Date}}}function Mg(a){function b(a){function b(b){for(var c,g,e,h=[],n=-1,k=0;++n<d;)37===a.charCodeAt(n)&&(h.push(a.slice(k,n)),null!=(g=ue[c=a.charAt(++n)])&&(c=a.charAt(++n)),(e=C[c])&&(c=e(b,null==g?"e"===c?" ":"0":g)),h.push(c),k=n+1);return h.push(a.slice(k,n)),h.join("")}var d=a.length;return b.parse=function(b){var d={y:1900,
m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(c(d,a,b,0)!=b.length)return null;"p"in d&&(d.H=d.H%12+12*d.p);b=null!=d.Z&&ba!==xa;var g=new (b?xa:ba);return"j"in d?g.setFullYear(d.y,0,d.j):"W"in d||"U"in d?("w"in d||(d.w="W"in d?1:0),g.setFullYear(d.y,0,1),g.setFullYear(d.y,0,"W"in d?(d.w+6)%7+7*d.W-(g.getDay()+5)%7:d.w+7*d.U-(g.getDay()+6)%7)):g.setFullYear(d.y,d.m,d.d),g.setHours(d.H+(d.Z/100|0),d.M+d.Z%100,d.S,d.L),b?g._:g},b.toString=function(){return a},b}function c(a,b,c,d){for(var g,e,h,n=0,k=b.length,
q=c.length;k>n;){if(d>=q)return-1;if(g=b.charCodeAt(n++),37===g){if(h=b.charAt(n++),e=N[h in ue?b.charAt(n++):h],!e||0>(d=e(a,c,d)))return-1}else if(g!=c.charCodeAt(d++))return-1}return d}var d=a.dateTime,e=a.date,g=a.time,k=a.periods,h=a.days,n=a.shortDays,q=a.months,r=a.shortMonths;b.utc=function(a){function c(a){try{ba=xa;var b=new ba;return b._=a,d(b)}finally{ba=Date}}var d=b(a);return c.parse=function(a){try{ba=xa;var b=d.parse(a);return b&&b._}finally{ba=Date}},c.toString=d.toString,c};b.multi=
b.utc.multi=Ng;var f=l.map(),t=Ib(h),E=Jb(h),A=Ib(n),m=Jb(n),F=Ib(q),I=Jb(q),x=Ib(r),y=Jb(r);k.forEach(function(a,b){f.set(a.toLowerCase(),b)});var C={a:function(a){return n[a.getDay()]},A:function(a){return h[a.getDay()]},b:function(a){return r[a.getMonth()]},B:function(a){return q[a.getMonth()]},c:b(d),d:function(a,b){return fa(a.getDate(),b,2)},e:function(a,b){return fa(a.getDate(),b,2)},H:function(a,b){return fa(a.getHours(),b,2)},I:function(a,b){return fa(a.getHours()%12||12,b,2)},j:function(a,
b){return fa(1+w.dayOfYear(a),b,3)},L:function(a,b){return fa(a.getMilliseconds(),b,3)},m:function(a,b){return fa(a.getMonth()+1,b,2)},M:function(a,b){return fa(a.getMinutes(),b,2)},p:function(a){return k[+(12<=a.getHours())]},S:function(a,b){return fa(a.getSeconds(),b,2)},U:function(a,b){return fa(w.sundayOfYear(a),b,2)},w:function(a){return a.getDay()},W:function(a,b){return fa(w.mondayOfYear(a),b,2)},x:b(e),X:b(g),y:function(a,b){return fa(a.getFullYear()%100,b,2)},Y:function(a,b){return fa(a.getFullYear()%
1E4,b,4)},Z:Og,"%":function(){return"%"}},N={a:function(a,b,c){A.lastIndex=0;return(b=A.exec(b.slice(c)))?(a.w=m.get(b[0].toLowerCase()),c+b[0].length):-1},A:function(a,b,c){t.lastIndex=0;return(b=t.exec(b.slice(c)))?(a.w=E.get(b[0].toLowerCase()),c+b[0].length):-1},b:function(a,b,c){x.lastIndex=0;return(b=x.exec(b.slice(c)))?(a.m=y.get(b[0].toLowerCase()),c+b[0].length):-1},B:function(a,b,c){F.lastIndex=0;return(b=F.exec(b.slice(c)))?(a.m=I.get(b[0].toLowerCase()),c+b[0].length):-1},c:function(a,
b,d){return c(a,C.c.toString(),b,d)},d:ve,e:ve,H:we,I:we,j:Pg,L:Qg,m:Rg,M:Sg,p:function(a,b,c){b=f.get(b.slice(c,c+=2).toLowerCase());return null==b?-1:(a.p=b,c)},S:Tg,U:Ug,w:Vg,W:Wg,x:function(a,b,d){return c(a,C.x.toString(),b,d)},X:function(a,b,d){return c(a,C.X.toString(),b,d)},y:Xg,Y:Yg,Z:Zg,"%":$g};return b}function fa(a,b,c){var d=0>a?"-":"";a=(d?-a:a)+"";var e=a.length;return d+(c>e?Array(c-e+1).join(b)+a:a)}function Ib(a){return new RegExp("^(?:"+a.map(l.requote).join("|")+")","i")}function Jb(a){for(var b=
new v,c=-1,d=a.length;++c<d;)b.set(a[c].toLowerCase(),c);return b}function Vg(a,b,c){W.lastIndex=0;return(b=W.exec(b.slice(c,c+1)))?(a.w=+b[0],c+b[0].length):-1}function Ug(a,b,c){W.lastIndex=0;return(b=W.exec(b.slice(c)))?(a.U=+b[0],c+b[0].length):-1}function Wg(a,b,c){W.lastIndex=0;return(b=W.exec(b.slice(c)))?(a.W=+b[0],c+b[0].length):-1}function Yg(a,b,c){W.lastIndex=0;return(b=W.exec(b.slice(c,c+4)))?(a.y=+b[0],c+b[0].length):-1}function Xg(a,b,c){W.lastIndex=0;if(b=W.exec(b.slice(c,c+2))){var d=
+b[0];a=(a.y=d+(68<d?1900:2E3),c+b[0].length)}else a=-1;return a}function Zg(a,b,c){return/^[+-]\d{4}$/.test(b=b.slice(c,c+5))?(a.Z=-b,c+5):-1}function Rg(a,b,c){W.lastIndex=0;return(b=W.exec(b.slice(c,c+2)))?(a.m=b[0]-1,c+b[0].length):-1}function ve(a,b,c){W.lastIndex=0;return(b=W.exec(b.slice(c,c+2)))?(a.d=+b[0],c+b[0].length):-1}function Pg(a,b,c){W.lastIndex=0;return(b=W.exec(b.slice(c,c+3)))?(a.j=+b[0],c+b[0].length):-1}function we(a,b,c){W.lastIndex=0;return(b=W.exec(b.slice(c,c+2)))?(a.H=+b[0],
c+b[0].length):-1}function Sg(a,b,c){W.lastIndex=0;return(b=W.exec(b.slice(c,c+2)))?(a.M=+b[0],c+b[0].length):-1}function Tg(a,b,c){W.lastIndex=0;return(b=W.exec(b.slice(c,c+2)))?(a.S=+b[0],c+b[0].length):-1}function Qg(a,b,c){W.lastIndex=0;return(b=W.exec(b.slice(c,c+3)))?(a.L=+b[0],c+b[0].length):-1}function Og(a){var b=a.getTimezoneOffset();a=0<b?"-":"+";var c=G(b)/60|0,b=G(b)%60;return a+fa(c,"0",2)+fa(b,"0",2)}function $g(a,b,c){xe.lastIndex=0;return(a=xe.exec(b.slice(c,c+1)))?c+a[0].length:
-1}function Ng(a){for(var b=a.length,c=-1;++c<b;)a[c][0]=this(a[c][0]);return function(b){for(var c=0,d=a[c];!d[1](b);)d=a[++c];return d[0](b)}}function Wc(){}function ye(a,b,c){var d=c.s=a+b,e=d-a;c.t=a-(d-e)+(b-e)}function Kb(a,b){a&&ze.hasOwnProperty(a.type)&&ze[a.type](a,b)}function Xc(a,b,c){var d=-1,e=a.length-c;for(b.lineStart();++d<e;)c=a[d],b.point(c[0],c[1],c[2]);b.lineEnd()}function Ae(a,b){var c=-1,d=a.length;for(b.polygonStart();++c<d;)Xc(a[c],b,1);b.polygonEnd()}function ah(){function a(a,
b){a*=K;b=b*K/2+M/4;var c=a-d,h=0<=c?1:-1,c=h*c,k=Math.cos(b);b=Math.sin(b);var f=g*b;Oa.add(Math.atan2(f*h*Math.sin(c),e*k+f*Math.cos(c)));d=a;e=k;g=b}var b,c,d,e,g;ga.point=function(k,h){ga.point=a;d=(b=k)*K;e=Math.cos(h=(c=h)*K/2+M/4);g=Math.sin(h)};ga.lineEnd=function(){a(b,c)}}function Pa(a){var b=a[0];a=a[1];var c=Math.cos(a);return[c*Math.cos(b),c*Math.sin(b),Math.sin(a)]}function Lb(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function Ya(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*
b[1]-a[1]*b[0]]}function Yc(a,b){a[0]+=b[0];a[1]+=b[1];a[2]+=b[2]}function Mb(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function Nb(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=b;a[1]/=b;a[2]/=b}function Ob(a){return[Math.atan2(a[1],a[0]),Da(a[2])]}function Pb(a,b){return G(a[0]-b[0])<B&&G(a[1]-b[1])<B}function Zc(a,b){a*=K;var c=Math.cos(b*=K);ib(c*Math.cos(a),c*Math.sin(a),Math.sin(b))}function ib(a,b,c){++jb;Qa+=(a-Qa)/jb;Ra+=(b-Ra)/jb;ya+=(c-ya)/jb}function Be(){function a(a,g){a*=K;var e=
Math.cos(g*=K),h=e*Math.cos(a);a=e*Math.sin(a);g=Math.sin(g);var n=Math.atan2(Math.sqrt((n=c*g-d*a)*n+(n=d*h-b*g)*n+(n=b*a-c*h)*n),b*h+c*a+d*g);Qb+=n;Ea+=n*(b+(b=h));Fa+=n*(c+(c=a));sa+=n*(d+(d=g));ib(b,c,d)}var b,c,d;ma.point=function(e,g){e*=K;var k=Math.cos(g*=K);b=k*Math.cos(e);c=k*Math.sin(e);d=Math.sin(g);ma.point=a;ib(b,c,d)}}function Ce(){ma.point=Zc}function bh(){function a(a,b){a*=K;var c=Math.cos(b*=K),h=c*Math.cos(a);a=c*Math.sin(a);b=Math.sin(b);var c=e*b-g*a,k=g*h-d*b,f=d*a-e*h,t=Math.sqrt(c*
c+k*k+f*f),l=d*h+e*a+g*b,A=t&&-fe(l)/t,t=Math.atan2(t,l);Za+=A*c;$a+=A*k;Ga+=A*f;Qb+=t;Ea+=t*(d+(d=h));Fa+=t*(e+(e=a));sa+=t*(g+(g=b));ib(d,e,g)}var b,c,d,e,g;ma.point=function(k,h){b=k;c=h;ma.point=a;k*=K;var n=Math.cos(h*=K);d=n*Math.cos(k);e=n*Math.sin(k);g=Math.sin(h);ib(d,e,g)};ma.lineEnd=function(){a(b,c);ma.lineEnd=Ce;ma.point=Zc}}function De(a,b){function c(c,e){return c=a(c,e),b(c[0],c[1])}return a.invert&&b.invert&&(c.invert=function(c,e){return c=b.invert(c,e),c&&a.invert(c[0],c[1])}),
c}function kb(){return!0}function Ee(a,b,c,d,e){var g=[],k=[];if(a.forEach(function(a){if(!(0>=(b=a.length-1))){var b,c=a[0],d=a[b];if(Pb(c,d)){e.lineStart();for(d=0;b>d;++d)e.point((c=a[d])[0],c[1]);return void e.lineEnd()}b=new Rb(c,a,null,!0);c=new Rb(c,null,b,!1);b.o=c;g.push(b);k.push(c);b=new Rb(d,a,null,!1);c=new Rb(d,null,b,!0);b.o=c;g.push(b);k.push(c)}}),k.sort(b),Fe(g),Fe(k),g.length){a=0;b=c;for(c=k.length;c>a;++a)k[a].e=b=!b;for(var h,n=g[0];;){for(var q=n,f=!0;q.v;)if((q=q.n)===n)return;
b=q.z;e.lineStart();do{if(q.v=q.o.v=!0,q.e){if(f)for(a=0,c=b.length;c>a;++a)e.point((h=b[a])[0],h[1]);else d(q.x,q.n.x,1,e);q=q.n}else{if(f)for(b=q.p.z,a=b.length-1;0<=a;--a)e.point((h=b[a])[0],h[1]);else d(q.x,q.p.x,-1,e);q=q.p}q=q.o;b=q.z;f=!f}while(!q.v);e.lineEnd()}}}function Fe(a){if(b=a.length){for(var b,c,d=0,e=a[0];++d<b;)e.n=c=a[d],c.p=e,e=c;e.n=c=a[0];c.p=e}}function Rb(a,b,c,d){this.x=a;this.z=b;this.o=c;this.e=d;this.v=!1;this.n=this.p=null}function Ge(a,b,c,d){return function(e,g){function k(b,
c){var d=e(b,c);a(b=d[0],c=d[1])&&g.point(b,c)}function h(a,b){a=e(a,b);F.point(a[0],a[1])}function n(){x.point=h;F.lineStart()}function q(){x.point=k;F.lineEnd()}function f(a,b){m.push([a,b]);a=e(a,b);C.point(a[0],a[1])}function u(){C.lineStart();m=[]}function t(){f(m[0][0],m[0][1]);C.lineEnd();var a;a=C.clean();var b=y.buffer(),c=b.length;if(m.pop(),A.push(m),m=null,c)if(1&a){a=b[0];var d,c=a.length-1,b=-1;if(0<c){N||(g.polygonStart(),N=!0);for(g.lineStart();++b<c;)g.point((d=a[b])[0],d[1]);g.lineEnd()}}else 1<
c&&2&a&&b.push(b.pop().concat(b.shift())),E.push(b.filter(ch))}var E,A,m,F=b(g),I=e.invert(d[0],d[1]),x={point:k,lineStart:n,lineEnd:q,polygonStart:function(){x.point=f;x.lineStart=u;x.lineEnd=t;E=[];A=[]},polygonEnd:function(){x.point=k;x.lineStart=n;x.lineEnd=q;E=l.merge(E);var a,b=I;a=A;var d=b[0],e=b[1],h=[Math.sin(d),-Math.cos(d),0],f=0,r=0;Oa.reset();for(var u=0,t=a.length;t>u;++u){var m=a[u],L=m.length;if(L)for(var F=m[0],y=F[0],b=F[1]/2+M/4,C=Math.sin(b),p=Math.cos(b),v=1;;){v===L&&(v=0);
var b=m[v],w=b[0],z=b[1]/2+M/4,P=Math.sin(z),z=Math.cos(z),K=w-y,G=0<=K?1:-1,D=G*K,J=D>M,C=C*P;if(Oa.add(Math.atan2(C*G*Math.sin(D),p*z+C*Math.cos(D))),f+=J?K+G*ha:K,J^y>=d^w>=d)F=Ya(Pa(F),Pa(b)),Nb(F),y=Ya(h,F),Nb(y),y=(J^0<=K?-1:1)*Da(y[2]),(e>y||e===y&&(F[0]||F[1]))&&(r+=J^0<=K?1:-1);if(!v++)break;y=w;C=P;p=z;F=b}}a=(-B>f||B>f&&-B>Oa)^1&r;E.length?(N||(g.polygonStart(),N=!0),Ee(E,dh,a,c,g)):a&&(N||(g.polygonStart(),N=!0),g.lineStart(),c(null,null,1,g),g.lineEnd());N&&(g.polygonEnd(),N=!1);E=A=
null},sphere:function(){g.polygonStart();g.lineStart();c(null,null,1,g);g.lineEnd();g.polygonEnd()}},y=Ie(),C=b(y),N=!1;return x}}function ch(a){return 1<a.length}function Ie(){var a,b=[];return{lineStart:function(){b.push(a=[])},point:function(b,d){a.push([b,d])},lineEnd:X,buffer:function(){var c=b;return b=[],a=null,c},rejoin:function(){1<b.length&&b.push(b.pop().concat(b.shift()))}}}function dh(a,b){return(0>(a=a.x)[0]?a[1]-V-B:V-a[1])-(0>(b=b.x)[0]?b[1]-V-B:V-b[1])}function eh(a){function b(a,
b){return Math.cos(a)*Math.cos(b)>e}function c(a,b,c){var d=Pa(a),g=Pa(b),h=[1,0,0],g=Ya(d,g),n=Lb(g,g),d=g[0],k=n-d*d;if(!k)return!c&&a;n=e*n/k;k=-e*d/k;d=Ya(h,g);h=Mb(h,n);g=Mb(g,k);Yc(h,g);g=Lb(h,d);n=Lb(d,d);k=g*g-n*(Lb(h,h)-1);if(!(0>k)){var q=Math.sqrt(k),k=Mb(d,(-g-q)/n);if(Yc(k,h),k=Ob(k),!c)return k;var f;c=a[0];var r=b[0];a=a[1];b=b[1];c>r&&(f=c,c=r,r=f);var l=r-c,m=G(l-M)<B,N=m||B>l;if(!m&&a>b&&(f=a,a=b,b=f),N?m?0<a+b^k[1]<(G(k[0]-c)<B?a:b):a<=k[1]&&k[1]<=b:l>M^(c<=k[0]&&k[0]<=r))return f=
Mb(d,(-g+q)/n),Yc(f,h),[k,Ob(f)]}}function d(b,c){var d=g?a:M-a,e=0;return-d>b?e|=1:b>d&&(e|=2),-d>c?e|=4:c>d&&(e|=8),e}var e=Math.cos(a),g=0<e,k=G(e)>B,h=$c(a,6*K);return Ge(b,function(a){var e,h,n,f,l;return{lineStart:function(){f=n=!1;l=1},point:function(q,r){var u,t=[q,r],E=b(q,r);q=g?E?0:d(q,r):E?d(q+(0>q?M:-M),r):0;if(!e&&(f=n=E)&&a.lineStart(),E!==n&&(u=c(e,t),(Pb(e,u)||Pb(t,u))&&(t[0]+=B,t[1]+=B,E=b(t[0],t[1]))),E!==n)l=0,E?(a.lineStart(),u=c(t,e),a.point(u[0],u[1])):(u=c(e,t),a.point(u[0],
u[1]),a.lineEnd()),e=u;else if(k&&e&&g^E){var m;q&h||!(m=c(t,e,!0))||(l=0,g?(a.lineStart(),a.point(m[0][0],m[0][1]),a.point(m[1][0],m[1][1]),a.lineEnd()):(a.point(m[1][0],m[1][1]),a.lineEnd(),a.lineStart(),a.point(m[0][0],m[0][1])))}!E||e&&Pb(e,t)||a.point(t[0],t[1]);e=t;n=E;h=q},lineEnd:function(){n&&a.lineEnd();e=null},clean:function(){return l|(f&&n)<<1}}},h,g?[0,-a]:[-M,a-M])}function Je(a,b,c,d){return function(e){var g,k=e.a,h=e.b,n=k.x,k=k.y,q=0,f=1,u=h.x-n,h=h.y-k;if(g=a-n,u||!(0<g)){if(g/=
u,0>u){if(q>g)return;f>g&&(f=g)}else if(0<u){if(g>f)return;g>q&&(q=g)}if(g=c-n,u||!(0>g)){if(g/=u,0>u){if(g>f)return;g>q&&(q=g)}else if(0<u){if(q>g)return;f>g&&(f=g)}if(g=b-k,h||!(0<g)){if(g/=h,0>h){if(q>g)return;f>g&&(f=g)}else if(0<h){if(g>f)return;g>q&&(q=g)}if(g=d-k,h||!(0>g)){if(g/=h,0>h){if(g>f)return;g>q&&(q=g)}else if(0<h){if(q>g)return;f>g&&(f=g)}return 0<q&&(e.a={x:n+q*u,y:k+q*h}),1>f&&(e.b={x:n+f*u,y:k+f*h}),e}}}}}}function Ke(a,b,c,d){function e(d,g){return G(d[0]-a)<B?0<g?0:3:G(d[0]-
c)<B?0<g?2:1:G(d[1]-b)<B?0<g?1:0:0<g?3:2}function g(a,b){return k(a.x,b.x)}function k(a,b){var c=e(a,1),d=e(b,1);return c!==d?c-d:0===c?b[1]-a[1]:1===c?a[0]-b[0]:2===c?a[1]-b[1]:b[0]-a[0]}return function(h){function n(g,h,n,q){var f=0,r=0;if(null==g||(f=e(g,n))!==(r=e(h,n))||0>k(g,h)^0<n){do q.point(0===f||3===f?a:c,1<f?d:b);while((f=(f+n+4)%4)!==r)}else q.point(h[0],h[1])}function q(g,e){g>=a&&c>=g&&e>=b&&d>=e&&h.point(g,e)}function f(g,e){g=Math.max(-Sb,Math.min(Sb,g));e=Math.max(-Sb,Math.min(Sb,
e));var k=g>=a&&c>=g&&e>=b&&d>=e;if(t&&E.push([g,e]),C)m=g,L=e,F=k,C=!1,k&&(h.lineStart(),h.point(g,e));else if(k&&y)h.point(g,e);else{var n={a:{x:I,y:x},b:{x:g,y:e}};p(n)?(y||(h.lineStart(),h.point(n.a.x,n.a.y)),h.point(n.b.x,n.b.y),k||h.lineEnd(),N=!1):k&&(h.lineStart(),h.point(g,e),N=!1)}I=g;x=e;y=k}var u,t,E,m,L,F,I,x,y,C,N,H=h,T=Ie(),p=Je(a,b,c,d),ea={point:q,lineStart:function(){ea.point=f;t&&t.push(E=[]);C=!0;y=!1;I=x=NaN},lineEnd:function(){u&&(f(m,L),F&&y&&T.rejoin(),u.push(T.buffer()));
ea.point=q;y&&h.lineEnd()},polygonStart:function(){h=T;u=[];t=[];N=!0},polygonEnd:function(){h=H;u=l.merge(u);var b;b=[a,d];for(var c=0,e=t.length,k=b[1],q=0;e>q;++q)for(var f,r=1,m=t[q],A=m.length,x=m[0];A>r;++r)f=m[r],x[1]<=k?f[1]>k&&0<Lc(x,f,b)&&++c:f[1]<=k&&0>Lc(x,f,b)&&--c,x=f;b=0!==c;c=N&&b;e=u.length;(c||e)&&(h.polygonStart(),c&&(h.lineStart(),n(null,null,1,h),h.lineEnd()),e&&Ee(u,g,b,n,h),h.polygonEnd());u=t=E=null}};return ea}}function ad(a){var b=0,c=M/3,d=bd(a);a=d(b,c);return a.parallels=
function(a){return arguments.length?d(b=a[0]*M/180,c=a[1]*M/180):[b/M*180,c/M*180]},a}function Le(a,b){function c(a,b){b=Math.sqrt(e-2*d*Math.sin(b))/d;return[b*Math.sin(a*=d),g-b*Math.cos(a)]}a=Math.sin(a);var d=(a+Math.sin(b))/2,e=1+a*(2*d-a),g=Math.sqrt(e)/d;return c.invert=function(a,b){b=g-b;return[Math.atan2(a,b)/d,Da((e-(a*a+b*b)*d*d)/(2*d))]},c}function fh(){function a(a,b){cd+=e*a-d*b;d=a;e=b}var b,c,d,e;Ha.point=function(g,k){Ha.point=a;b=d=g;c=e=k};Ha.lineEnd=function(){a(b,c)}}function gh(){function a(a,
b){k.push("M",a,",",b,g)}function b(a,b){k.push("M",a,",",b);h.point=c}function c(a,b){k.push("L",a,",",b)}function d(){h.point=a}function e(){k.push("Z")}var g=Me(4.5),k=[],h={point:a,lineStart:function(){h.point=b},lineEnd:d,polygonStart:function(){h.lineEnd=e},polygonEnd:function(){h.lineEnd=d;h.point=a},pointRadius:function(a){return g=Me(a),h},result:function(){if(k.length){var a=k.join("");return k=[],a}}};return h}function Me(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+-2*a+"a"+a+","+a+" 0 1,1 0,"+
2*a+"z"}function Sa(a,b){Qa+=a;Ra+=b;++ya}function Ne(){function a(a,e){var d=a-b,k=e-c,d=Math.sqrt(d*d+k*k);Ea+=d*(b+a)/2;Fa+=d*(c+e)/2;sa+=d;Sa(b=a,c=e)}var b,c;na.point=function(d,e){na.point=a;Sa(b=d,c=e)}}function Oe(){na.point=Sa}function hh(){function a(a,b){var c=a-d,g=b-e,c=Math.sqrt(c*c+g*g);Ea+=c*(d+a)/2;Fa+=c*(e+b)/2;sa+=c;c=e*a-d*b;Za+=c*(d+a);$a+=c*(e+b);Ga+=3*c;Sa(d=a,e=b)}var b,c,d,e;na.point=function(g,k){na.point=a;Sa(b=d=g,c=e=k)};na.lineEnd=function(){a(b,c)}}function ih(a){function b(b,
c){a.moveTo(b+k,c);a.arc(b,c,k,0,ha)}function c(b,c){a.moveTo(b,c);h.point=d}function d(b,c){a.lineTo(b,c)}function e(){h.point=b}function g(){a.closePath()}var k=4.5,h={point:b,lineStart:function(){h.point=c},lineEnd:e,polygonStart:function(){h.lineEnd=g},polygonEnd:function(){h.lineEnd=e;h.point=b},pointRadius:function(a){return k=a,h},result:X};return h}function Pe(a){function b(a){return(h?d:c)(a)}function c(b){return Qe(b,function(c,d){c=a(c,d);b.point(c[0],c[1])})}function d(b){function c(c,
d){c=a(c,d);b.point(c[0],c[1])}function d(){T=NaN;w.point=g;b.lineStart()}function g(c,d){var g=Pa([c,d]);d=a(c,d);e(T,p,H,ea,v,B,T=d[0],p=d[1],H=c,ea=g[0],v=g[1],B=g[2],h,b);b.point(T,p)}function k(){w.point=c;b.lineEnd()}function n(){d();w.point=f;w.lineEnd=l}function f(a,b){g(m=a,b);I=T;x=p;y=ea;C=v;N=B;w.point=g}function l(){e(T,p,H,ea,v,B,I,x,m,y,C,N,h,b);w.lineEnd=k;k()}var m,I,x,y,C,N,H,T,p,ea,v,B,w={point:c,lineStart:d,lineEnd:k,polygonStart:function(){b.polygonStart();w.lineStart=n},polygonEnd:function(){b.polygonEnd();
w.lineStart=d}};return w}function e(b,c,d,h,f,l,m,L,F,I,x,y,C,N){var n=m-b,q=L-c,r=n*n+q*q;if(r>4*g&&C--){var t=h+I,u=f+x,E=l+y,A=Math.sqrt(t*t+u*u+E*E),p=Math.asin(E/=A),v=G(G(E)-1)<B||G(d-F)<B?(d+F)/2:Math.atan2(u,t),w=a(v,p),p=w[0],w=w[1],He=p-b,z=w-c,K=q*He-n*z;(K*K/r>g||.3<G((n*He+q*z)/r-.5)||k>h*I+f*x+l*y)&&(e(b,c,d,h,f,l,p,w,v,t/=A,u/=A,E,C,N),N.point(p,w),e(p,w,v,t,u,E,m,L,F,I,x,y,C,N))}}var g=.5,k=Math.cos(30*K),h=16;return b.precision=function(a){return arguments.length?(h=0<(g=a*a)&&16,
b):Math.sqrt(g)},b}function jh(a){var b=Pe(function(b,d){return a([b*U,d*U])});return function(a){return Re(b(a))}}function Se(a){this.stream=a}function Qe(a,b){return{point:b,sphere:function(){a.sphere()},lineStart:function(){a.lineStart()},lineEnd:function(){a.lineEnd()},polygonStart:function(){a.polygonStart()},polygonEnd:function(){a.polygonEnd()}}}function Ia(a){return bd(function(){return a})()}function bd(a){function b(a){return a=h(a[0]*K,a[1]*K),[a[0]*t+n,q-a[1]*t]}function c(a){return a=
h.invert((a[0]-n)/t,(q-a[1])/t),a&&[a[0]*U,a[1]*U]}function d(){h=De(k=dd(I,x,y),g);var a=g(L,F);return n=E-a[0]*t,q=m+a[1]*t,e()}function e(){return f&&(f.valid=!1,f=null),b}var g,k,h,n,q,f,u=Pe(function(a,b){return a=g(a,b),[a[0]*t+n,q-a[1]*t]}),t=150,E=480,m=250,L=0,F=0,I=0,x=0,y=0,C=Te,N=Z,H=null,T=null;return b.stream=function(a){return f&&(f.valid=!1),f=Re(C(k,u(N(a)))),f.valid=!0,f},b.clipAngle=function(a){return arguments.length?(C=null==a?(H=a,Te):eh((H=+a)*K),e()):H},b.clipExtent=function(a){return arguments.length?
(T=a,N=a?Ke(a[0][0],a[0][1],a[1][0],a[1][1]):Z,e()):T},b.scale=function(a){return arguments.length?(t=+a,d()):t},b.translate=function(a){return arguments.length?(E=+a[0],m=+a[1],d()):[E,m]},b.center=function(a){return arguments.length?(L=a[0]%360*K,F=a[1]%360*K,d()):[L*U,F*U]},b.rotate=function(a){return arguments.length?(I=a[0]%360*K,x=a[1]%360*K,y=2<a.length?a[2]%360*K:0,d()):[I*U,x*U,y*U]},l.rebind(b,u,"precision"),function(){return g=a.apply(this,arguments),b.invert=g.invert&&c,d()}}function Re(a){return Qe(a,
function(b,c){a.point(b*K,c*K)})}function lb(a,b){return[a,b]}function Ue(a,b){return[a>M?a-ha:-M>a?a+ha:a,b]}function dd(a,b,c){return a?b||c?De(Ve(a),We(b,c)):Ve(a):b||c?We(b,c):Ue}function Xe(a){return function(b,c){return b+=a,[b>M?b-ha:-M>b?b+ha:b,c]}}function Ve(a){var b=Xe(a);return b.invert=Xe(-a),b}function We(a,b){function c(a,b){var c=Math.cos(b),h=Math.cos(a)*c;a=Math.sin(a)*c;b=Math.sin(b);c=b*d+h*e;return[Math.atan2(a*g-c*k,h*d-b*e),Da(c*g+a*k)]}var d=Math.cos(a),e=Math.sin(a),g=Math.cos(b),
k=Math.sin(b);return c.invert=function(a,b){var c=Math.cos(b),h=Math.cos(a)*c;a=Math.sin(a)*c;b=Math.sin(b);c=b*g-a*k;return[Math.atan2(a*g+b*k,h*d+c*e),Da(c*d-h*e)]},c}function $c(a,b){var c=Math.cos(a),d=Math.sin(a);return function(e,g,k,h){var n=k*b;null!=e?(e=Ye(c,e),g=Ye(c,g),(0<k?g>e:e>g)&&(e+=k*ha)):(e=a+k*ha,g=a-.5*n);for(var f;0<k?e>g:g>e;e-=n)h.point((f=Ob([c,-d*Math.cos(e),-d*Math.sin(e)]))[0],f[1])}}function Ye(a,b){b=Pa(b);b[0]-=a;Nb(b);a=fe(-b[1]);return((0>-b[2]?-a:a)+2*Math.PI-B)%
(2*Math.PI)}function Ze(a,b,c){var d=l.range(a,b-B,c).concat(b);return function(a){return d.map(function(b){return[a,b]})}}function $e(a,b,c){var d=l.range(a,b-B,c).concat(b);return function(a){return d.map(function(b){return[b,a]})}}function ed(a){return a.source}function fd(a){return a.target}function kh(a,b,c,d){var e=Math.cos(b),g=Math.sin(b),k=Math.cos(d),h=Math.sin(d),n=e*Math.cos(a),f=e*Math.sin(a),r=k*Math.cos(c),u=k*Math.sin(c),t=2*Math.asin(Math.sqrt(he(d-b)+e*k*he(c-a))),l=1/Math.sin(t);
c=t?function(a){var b=Math.sin(a*=t)*l;a=Math.sin(t-a)*l;var c=a*n+b*r,d=a*f+b*u;return[Math.atan2(d,c)*U,Math.atan2(a*g+b*h,Math.sqrt(c*c+d*d))*U]}:function(){return[a*U,b*U]};return c.distance=t,c}function mb(a,b){function c(b,c){var d=Math.cos(c),e=a(Math.cos(b)*d);return[e*d*Math.sin(b),e*Math.sin(c)]}return c.invert=function(a,c){var d=Math.sqrt(a*a+c*c),e=b(d),h=Math.sin(e);return[Math.atan2(a*h,d*Math.cos(e)),Math.asin(d&&c*h/d)]},c}function af(a,b){function c(a,b){0<g?-V+B>b&&(b=-V+B):b>V-
B&&(b=V-B);b=g/Math.pow(Math.tan(M/4+b/2),e);return[b*Math.sin(e*a),g-b*Math.cos(e*a)]}var d=Math.cos(a),e=a===b?Math.sin(a):Math.log(d/Math.cos(b))/Math.log(Math.tan(M/4+b/2)/Math.tan(M/4+a/2)),g=d*Math.pow(Math.tan(M/4+a/2),e)/e;return e?(c.invert=function(a,b){b=g-b;return[Math.atan2(a,b)/e,2*Math.atan(Math.pow(g/((0<e?1:0>e?-1:0)*Math.sqrt(a*a+b*b)),1/e))-V]},c):Tb}function bf(a,b){function c(a,b){b=g-b;return[b*Math.sin(e*a),g-b*Math.cos(e*a)]}var d=Math.cos(a),e=a===b?Math.sin(a):(d-Math.cos(b))/
(b-a),g=d/e+a;return G(e)<B?lb:(c.invert=function(a,b){b=g-b;return[Math.atan2(a,b)/e,g-(0<e?1:0>e?-1:0)*Math.sqrt(a*a+b*b)]},c)}function Tb(a,b){return[a,Math.log(Math.tan(M/4+b/2))]}function cf(a){var b,c=Ia(a),d=c.scale,e=c.translate,g=c.clipExtent;return c.scale=function(){var a=d.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.translate=function(){var a=e.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.clipExtent=function(a){var h=g.apply(c,arguments);if(h===c){if(b=null==
a){var k=M*d(),f=e();g([[f[0]-k,f[1]-k],[f[0]+k,f[1]+k]])}}else b&&(h=null);return h},c.clipExtent(null)}function gd(a,b){return[Math.log(Math.tan(M/4+b/2)),-a]}function ab(a){return a[0]}function nb(a){return a[1]}function df(a){for(var b=a.length,c=[0,1],d=2,e=2;b>e;e++){for(;1<d&&0>=Lc(a[c[d-2]],a[c[d-1]],a[e]);)--d;c[d++]=e}return c.slice(0,d)}function lh(a,b){return a[0]-b[0]||a[1]-b[1]}function hd(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function id(a,b,c,d){var e=a[0],g=
c[0],k=b[0]-e,h=d[0]-g;a=a[1];c=c[1];b=b[1]-a;d=d[1]-c;g=(h*(a-c)-d*(e-g))/(d*k-h*b);return[e+g*k,a+g*b]}function ef(a){var b=a[0];a=a[a.length-1];return!(b[0]-a[0]||b[1]-a[1])}function mh(){Ub(this);this.edge=this.site=this.circle=null}function ff(a){var b=gf.pop()||new mh;return b.site=a,b}function jd(a){bb(a);cb.remove(a);gf.push(a);Ub(a)}function hf(a,b){var c=a.site,d=c.x,e=c.y,g=e-b;if(!g)return d;a=a.P;if(!a)return-(1/0);c=a.site;a=c.x;c=c.y;b=c-b;if(!b)return a;var k=a-d,h=1/g-1/b,n=k/b;return h?
(-n+Math.sqrt(n*n-2*h*(k*k/(-2*b)-c+b/2+e-g/2)))/h+d:(d+a)/2}function jf(a){this.site=a;this.edges=[]}function kf(a,b){return b.angle-a.angle}function nh(){Ub(this);this.x=this.y=this.arc=this.site=this.cy=null}function db(a){var b=a.P,c=a.N;if(b&&c){var d=b.site,b=a.site,e=c.site;if(d!==e){var c=b.x,g=b.y,k=d.x-c,h=d.y-g,d=e.x-c,e=e.y-g,n=2*(k*e-h*d);if(!(n>=-Vb)){var f=k*k+h*h,r=d*d+e*e,h=(e*f-h*r)/n,k=(k*r-d*f)/n,e=k+g,g=lf.pop()||new nh;g.arc=a;g.site=b;g.x=h+c;g.y=e+Math.sqrt(h*h+k*k);g.cy=e;
a.circle=g;a=null;for(b=ob._;b;)if(g.y<b.y||g.y===b.y&&g.x<=b.x){if(!b.L){a=b.P;break}b=b.L}else{if(!b.R){a=b;break}b=b.R}ob.insert(a,g);a||(kd=g)}}}}function bb(a){var b=a.circle;b&&(b.P||(kd=b.N),ob.remove(b),lf.push(b),Ub(b),a.circle=null)}function oh(a,b){var c=a.b;if(c)return!0;var d,e,g=a.a,c=b[0][0],k=b[1][0],h=b[0][1];b=b[1][1];var n=a.l,f=a.r,r=n.x,n=n.y,u=f.x,f=f.y;e=(r+u)/2;if(f===n){if(c>e||e>=k)return;if(r>u){if(g){if(g.y>=b)return}else g={x:e,y:h};c={x:e,y:b}}else{if(g){if(g.y<h)return}else g=
{x:e,y:b};c={x:e,y:h}}}else if(d=(r-u)/(f-n),e=(n+f)/2-d*e,-1>d||1<d)if(r>u){if(g){if(g.y>=b)return}else g={x:(h-e)/d,y:h};c={x:(b-e)/d,y:b}}else{if(g){if(g.y<h)return}else g={x:(b-e)/d,y:b};c={x:(h-e)/d,y:h}}else if(f>n){if(g){if(g.x>=k)return}else g={x:c,y:d*c+e};c={x:k,y:d*k+e}}else{if(g){if(g.x<c)return}else g={x:k,y:d*k+e};c={x:c,y:d*c+e}}return a.a=g,a.b=c,!0}function mf(a,b){this.l=a;this.r=b;this.a=this.b=null}function pb(a,b,c,d){var e=new mf(a,b);return eb.push(e),c&&Wb(e,a,b,c),d&&Wb(e,
b,a,d),Ta[a.i].edges.push(new Xb(e,a,b)),Ta[b.i].edges.push(new Xb(e,b,a)),e}function ph(a,b,c){a=new mf(a,null);return a.a=b,a.b=c,eb.push(a),a}function Wb(a,b,c,d){a.a||a.b?a.l===c?a.b=d:a.a=d:(a.a=d,a.l=b,a.r=c)}function Xb(a,b,c){var d=a.a,e=a.b;this.edge=a;this.site=b;this.angle=c?Math.atan2(c.y-b.y,c.x-b.x):a.l===b?Math.atan2(e.x-d.x,d.y-e.y):Math.atan2(d.x-e.x,e.y-d.y)}function ld(){this._=null}function Ub(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function qb(a,b){var c=b.R,d=b.U;d?d.L===b?d.L=c:d.R=
c:a._=c;c.U=d;b.U=c;b.R=c.L;b.R&&(b.R.U=b);c.L=b}function rb(a,b){var c=b.L,d=b.U;d?d.L===b?d.L=c:d.R=c:a._=c;c.U=d;b.U=c;b.L=c.R;b.L&&(b.L.U=b);c.R=b}function nf(a){for(;a.L;)a=a.L;return a}function md(a,b){var c,d,e,g=a.sort(qh).pop();eb=[];Ta=Array(a.length);cb=new ld;for(ob=new ld;;)if(e=kd,g&&(!e||g.y<e.y||g.y===e.y&&g.x<e.x)){if(g.x!==c||g.y!==d){Ta[g.i]=new jf(g);var k=void 0,h=void 0;d=c=void 0;for(var n=g,f=n.x,r=n.y,u=cb._;u;)if(h=hf(u,r)-f,h>B)u=u.L;else{var t;var l=u;t=r;var m=l.N;m?t=
hf(m,t):(l=l.site,t=l.y===t?l.x:1/0);if(k=f-t,!(k>B)){h>-B?(d=u.P,c=u):k>-B?(d=u,c=u.N):d=c=u;break}if(!u.R){d=u;break}u=u.R}k=ff(n);if(cb.insert(d,k),d||c)if(d===c)bb(d),c=ff(d.site),cb.insert(k,c),k.edge=c.edge=pb(d.site,k.site),db(d),db(c);else if(c){bb(d);bb(c);h=d.site;r=h.x;u=h.y;t=n.x-r;var l=n.y-u,f=c.site,m=f.x-r,L=f.y-u,F=2*(t*L-l*m),I=t*t+l*l,x=m*m+L*L,r={x:(L*I-l*x)/F+r,y:(t*x-m*I)/F+u};Wb(c.edge,h,f,r);k.edge=pb(h,n,null,r);c.edge=pb(n,f,null,r);db(d);db(c)}else k.edge=pb(d.site,k.site);
c=g.x;d=g.y}g=a.pop()}else{if(!e)break;f=e.arc;n=f.circle;h=n.x;r=n.cy;n={x:h,y:r};t=f.P;u=f.N;k=[f];jd(f);for(f=t;f.circle&&G(h-f.circle.x)<B&&G(r-f.circle.cy)<B;)t=f.P,k.unshift(f),jd(f),f=t;k.unshift(f);bb(f);for(t=u;t.circle&&G(h-t.circle.x)<B&&G(r-t.circle.cy)<B;)u=t.N,k.push(t),jd(t),t=u;k.push(t);bb(t);r=k.length;for(h=1;r>h;++h)t=k[h],f=k[h-1],Wb(t.edge,f.site,t.site,n);f=k[0];t=k[r-1];t.edge=pb(f.site,t.site,null,n);db(f);db(t)}if(b){e=eb;g=Je(b[0][0],b[0][1],b[1][0],b[1][1]);for(c=e.length;c--;)a=
e[c],(!oh(a,b)||!g(a)||G(a.a.x-a.b.x)<B&&G(a.a.y-a.b.y)<B)&&(a.a=a.b=null,e.splice(c,1));var y;a=b[0][0];e=b[1][0];g=b[0][1];r=b[1][1];u=Ta;for(t=u.length;t--;)if(y=u[t],y&&y.prepare())for(k=y.edges,h=k.length,n=0;h>n;)f=k[n].end(),c=f.x,d=f.y,l=k[++n%h].start(),b=l.x,l=l.y,(G(c-b)>B||G(d-l)>B)&&(k.splice(n,0,new Xb(ph(y.site,f,G(c-a)<B&&r-d>B?{x:a,y:G(b-a)<B?l:r}:G(d-r)<B&&e-c>B?{x:G(l-r)<B?b:e,y:r}:G(c-e)<B&&d-g>B?{x:e,y:G(b-e)<B?l:g}:G(d-g)<B&&c-a>B?{x:G(l-g)<B?b:a,y:g}:null),y.site,null)),++h)}y=
{cells:Ta,edges:eb};return cb=ob=eb=Ta=null,y}function qh(a,b){return b.y-a.y||b.x-a.x}function rh(a){return a.x}function sh(a){return a.y}function of(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function sb(a,b,c,d,e,g){if(!a(b,c,d,e,g)){var k=.5*(c+e),h=.5*(d+g);b=b.nodes;b[0]&&sb(a,b[0],c,d,k,h);b[1]&&sb(a,b[1],k,d,e,h);b[2]&&sb(a,b[2],c,h,k,g);b[3]&&sb(a,b[3],k,h,e,g)}}function th(a,b,c,d,e,g,k){var h,f=1/0;return function r(a,n,l,m,L){if(!(n>g||l>k||d>m||e>L)){if(t=a.point){var t,u=b-
a.x,E=c-a.y,u=u*u+E*E;f>u&&(u=Math.sqrt(f=u),d=b-u,e=c-u,g=b+u,k=c+u,h=t)}t=a.nodes;for(var u=.5*(n+m),E=.5*(l+L),A=(c>=E)<<1|b>=u,C=A+4;C>A;++A)if(a=t[3&A])switch(3&A){case 0:r(a,n,l,u,E);break;case 1:r(a,u,l,m,E);break;case 2:r(a,n,E,u,L);break;case 3:r(a,u,E,m,L)}}}(a,d,e,g,k),h}function nd(a,b){a=l.rgb(a);b=l.rgb(b);var c=a.r,d=a.g,e=a.b,g=b.r-c,k=b.g-d,h=b.b-e;return function(a){return"#"+Xa(Math.round(c+g*a))+Xa(Math.round(d+k*a))+Xa(Math.round(e+h*a))}}function pf(a,b){var c,d={},e={};for(c in a)c in
b?d[c]=Ua(a[c],b[c]):e[c]=a[c];for(c in b)c in a||(e[c]=b[c]);return function(a){for(c in d)e[c]=d[c](a);return e}}function za(a,b){return a=+a,b=+b,function(c){return a*(1-c)+b*c}}function qf(a,b){var c,d,e,g=od.lastIndex=pd.lastIndex=0,k=-1,h=[],f=[];a+="";for(b+="";(c=od.exec(a))&&(d=pd.exec(b));)(e=d.index)>g&&(e=b.slice(g,e),h[k]?h[k]+=e:h[++k]=e),(c=c[0])===(d=d[0])?h[k]?h[k]+=d:h[++k]=d:(h[++k]=null,f.push({i:k,x:za(c,d)})),g=pd.lastIndex;return g<b.length&&(e=b.slice(g),h[k]?h[k]+=e:h[++k]=
e),2>h.length?f[0]?(b=f[0].x,function(a){return b(a)+""}):function(){return b}:(b=f.length,function(a){for(var c,d=0;b>d;++d)h[(c=f[d]).i]=c.x(a);return h.join("")})}function Ua(a,b){for(var c,d=l.interpolators.length;0<=--d&&!(c=l.interpolators[d](a,b)););return c}function Yb(a,b){var c,d=[],e=[],g=a.length,k=b.length,h=Math.min(a.length,b.length);for(c=0;h>c;++c)d.push(Ua(a[c],b[c]));for(;g>c;++c)e[c]=a[c];for(;k>c;++c)e[c]=b[c];return function(a){for(c=0;h>c;++c)e[c]=d[c](a);return e}}function uh(a){return function(b){return 0>=
b?0:1<=b?1:a(b)}}function rf(a){return function(b){return 1-a(1-b)}}function sf(a){return function(b){return.5*(.5>b?a(2*b):2-a(2-2*b))}}function vh(a){return a*a}function wh(a){return a*a*a}function xh(a){if(0>=a)return 0;if(1<=a)return 1;var b=a*a,c=b*a;return 4*(.5>a?c:3*(a-b)+c-.75)}function yh(a){return 1-Math.cos(a*V)}function zh(a){return Math.pow(2,10*(a-1))}function Ah(a){return 1-Math.sqrt(1-a*a)}function Bh(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*
(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function tf(a,b){return b-=a,function(c){return Math.round(a+b*c)}}function uf(a){var b=[a.a,a.b],c=[a.c,a.d],d=vf(b),e=b[0]*c[0]+b[1]*c[1],g;g=-e;g=(c[0]+=g*b[0],c[1]+=g*b[1],c);g=vf(g)||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,e*=-1);this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*U;this.translate=[a.e,a.f];this.scale=[d,g];this.skew=g?Math.atan2(e,g)*U:0}function vf(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]);return b&&(a[0]/=
b,a[1]/=b),b}function fb(a){return a.length?a.pop()+",":""}function Ch(a,b,c,d){a[0]!==b[0]||a[1]!==b[1]?(c=c.push("translate(",null,",",null,")"),d.push({i:c-4,x:za(a[0],b[0])},{i:c-2,x:za(a[1],b[1])})):(b[0]||b[1])&&c.push("translate("+b+")")}function Dh(a,b,c,d){a!==b?(180<a-b?b+=360:180<b-a&&(a+=360),d.push({i:c.push(fb(c)+"rotate(",null,")")-2,x:za(a,b)})):b&&c.push(fb(c)+"rotate("+b+")")}function Eh(a,b,c,d){a!==b?d.push({i:c.push(fb(c)+"skewX(",null,")")-2,x:za(a,b)}):b&&c.push(fb(c)+"skewX("+
b+")")}function Fh(a,b,c,d){a[0]!==b[0]||a[1]!==b[1]?(c=c.push(fb(c)+"scale(",null,",",null,")"),d.push({i:c-4,x:za(a[0],b[0])},{i:c-2,x:za(a[1],b[1])})):1===b[0]&&1===b[1]||c.push(fb(c)+"scale("+b+")")}function wf(a,b){var c=[],d=[];return a=l.transform(a),b=l.transform(b),Ch(a.translate,b.translate,c,d),Dh(a.rotate,b.rotate,c,d),Eh(a.skew,b.skew,c,d),Fh(a.scale,b.scale,c,d),a=b=null,function(a){for(var b,e=-1,h=d.length;++e<h;)c[(b=d[e]).i]=b.x(a);return c.join("")}}function Gh(a,b){return b=(b-=
a=+a)||1/b,function(c){return(c-a)/b}}function Hh(a,b){return b=(b-=a=+a)||1/b,function(c){return Math.max(0,Math.min(1,(c-a)/b))}}function Ih(a){var b=a.source;a=a.target;var c;var d=a;if(b===d)c=b;else{c=xf(b);for(var d=xf(d),e=c.pop(),g=d.pop(),k=null;e===g;)k=e,e=c.pop(),g=d.pop();c=k}for(d=[b];b!==c;)b=b.parent,d.push(b);for(b=d.length;a!==c;)d.splice(b,0,a),a=a.parent;return d}function xf(a){for(var b=[],c=a.parent;null!=c;)b.push(a),a=c,c=c.parent;return b.push(a),b}function Jh(a){a.fixed|=
2}function Kh(a){a.fixed&=-7}function Lh(a){a.fixed|=4;a.px=a.x;a.py=a.y}function Mh(a){a.fixed&=-5}function yf(a,b,c){var d=0,e=0;if(a.charge=0,!a.leaf)for(var g,k=a.nodes,h=k.length,f=-1;++f<h;)g=k[f],null!=g&&(yf(g,b,c),a.charge+=g.charge,d+=g.charge*g.cx,e+=g.charge*g.cy);a.point&&(a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5),b*=c[a.point.index],a.charge+=a.pointCharge=b,d+=b*a.point.x,e+=b*a.point.y);a.cx=d/a.charge;a.cy=e/a.charge}function tb(a,b){return l.rebind(a,b,"sort",
"children","value"),a.nodes=a,a.links=Nh,a}function ub(a,b){for(var c=[a];null!=(a=c.pop());)if(b(a),(e=a.children)&&(d=e.length))for(var d,e;0<=--d;)c.push(e[d])}function ta(a,b){for(var c=[a],d=[];null!=(a=c.pop());)if(d.push(a),(g=a.children)&&(e=g.length)){var e,g;for(a=-1;++a<e;)c.push(g[a])}for(;null!=(a=d.pop());)b(a)}function Oh(a){return a.children}function Ph(a){return a.value}function Qh(a,b){return b.value-a.value}function Nh(a){return l.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,
target:b}})}))}function Rh(a){return a.x}function Sh(a){return a.y}function Th(a,b,c){a.y0=b;a.y=c}function qd(a){return l.range(a.length)}function rd(a){var b=-1;a=a[0].length;for(var c=[];++b<a;)c[b]=0;return c}function Uh(a){for(var b,c=1,d=0,e=a[0][1],g=a.length;g>c;++c)(b=a[c][1])>e&&(d=c,e=b);return d}function Vh(a){return a.reduce(Wh,0)}function Wh(a,b){return a+b[1]}function Xh(a,b){return zf(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function zf(a,b){var c=-1,d=+a[0];a=(a[1]-d)/b;for(var e=
[];++c<=b;)e[c]=a*c+d;return e}function Yh(a){return[l.min(a),l.max(a)]}function Zh(a,b){return a.value-b.value}function sd(a,b){var c=a._pack_next;a._pack_next=b;b._pack_prev=a;b._pack_next=c;c._pack_prev=b}function Af(a,b){a._pack_next=b;b._pack_prev=a}function Bf(a,b){var c=b.x-a.x,d=b.y-a.y;a=a.r+b.r;return.999*a*a>c*c+d*d}function Cf(a){function b(a){r=Math.min(a.x-a.r,r);u=Math.max(a.x+a.r,u);t=Math.min(a.y-a.r,t);l=Math.max(a.y+a.r,l)}if((c=a.children)&&(q=c.length)){var c,d,e,g,k,h,f,q,r=
1/0,u=-(1/0),t=1/0,l=-(1/0);if(c.forEach($h),d=c[0],d.x=-d.r,d.y=0,b(d),1<q&&(e=c[1],e.x=e.r,e.y=0,b(e),2<q))for(g=c[2],Df(d,e,g),b(g),sd(d,g),d._pack_prev=g,sd(g,e),e=d._pack_next,k=3;q>k;k++){Df(d,e,g=c[k]);var m=0,L=1,F=1;for(h=e._pack_next;h!==e;h=h._pack_next,L++)if(Bf(h,g)){m=1;break}if(1==m)for(f=d._pack_prev;f!==h._pack_prev&&!Bf(f,g);f=f._pack_prev,F++);m?(F>L||L==F&&e.r<d.r?Af(d,e=h):Af(d=f,e),k--):(sd(d,g),e=g,b(g))}d=(r+u)/2;e=(t+l)/2;for(k=h=0;q>k;k++)g=c[k],g.x-=d,g.y-=e,h=Math.max(h,
g.r+Math.sqrt(g.x*g.x+g.y*g.y));a.r=h;c.forEach(ai)}}function $h(a){a._pack_next=a._pack_prev=a}function ai(a){delete a._pack_next;delete a._pack_prev}function Ef(a,b,c,d){var e=a.children;if(a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d,e){a=-1;for(var g=e.length;++a<g;)Ef(e[a],b,c,d)}}function Df(a,b,c){var d=a.r+c.r,e=b.x-a.x,g=b.y-a.y;if(d&&(e||g)){var k=b.r+c.r,h=e*e+g*g,k=k*k,d=d*d;b=.5+(d-k)/(2*h);k=Math.sqrt(Math.max(0,2*k*(d+h)-(d-=h)*d-k*k))/(2*h);c.x=a.x+b*e+k*g;c.y=a.y+b*g-k*e}else c.x=a.x+d,c.y=a.y}
function Ff(a,b){return a.parent==b.parent?1:2}function td(a){var b=a.children;return b.length?b[0]:a.t}function ud(a){var b,c=a.children;return(b=c.length)?c[b-1]:a.t}function bi(a){return 1+l.max(a,function(a){return a.y})}function ci(a){return a.reduce(function(a,c){return a+c.x},0)/a.length}function Gf(a){var b=a.children;return b&&b.length?Gf(b[0]):a}function Hf(a){var b,c=a.children;return c&&(b=c.length)?Hf(c[b-1]):a}function vd(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function If(a,b){var c=
a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3];a=a.dy-b[0]-b[2];return 0>e&&(c+=e/2,e=0),0>a&&(d+=a/2,a=0),{x:c,y:d,dx:e,dy:a}}function gb(a){var b=a[0];a=a[a.length-1];return a>b?[b,a]:[a,b]}function Zb(a){return a.rangeExtent?a.rangeExtent():gb(a.range())}function di(a,b,c,d){var e=c(a[0],a[1]),g=d(b[0],b[1]);return function(a){return g(e(a))}}function $b(a,b){var c,d=0,e=a.length-1,g=a[d],k=a[e];return g>k&&(c=d,d=e,e=c,c=g,g=k,k=c),a[d]=b.floor(g),a[e]=b.ceil(k),a}function Jf(a){return a?{floor:function(b){return Math.floor(b/
a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:ei}function fi(a,b,c,d){var e=[],g=[],k=0,h=Math.min(a.length,b.length)-1;for(a[h]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++k<=h;)e.push(c(a[k-1],a[k])),g.push(d(b[k-1],b[k]));return function(b){var c=l.bisect(a,b,1,h)-1;return g[c](e[c](b))}}function Kf(a,b,c,d){function e(){var e=2<Math.min(a.length,b.length)?fi:di,f=d?Hh:Gh;return k=e(a,b,f,c),h=e(b,a,f,Ua),g}function g(a){return k(a)}var k,h;return g.invert=function(a){return h(a)},
g.domain=function(b){return arguments.length?(a=b.map(Number),e()):a},g.range=function(a){return arguments.length?(b=a,e()):b},g.rangeRound=function(a){return g.range(a).interpolate(tf)},g.clamp=function(a){return arguments.length?(d=a,e()):d},g.interpolate=function(a){return arguments.length?(c=a,e()):c},g.ticks=function(b){return l.range.apply(l,Ja(a,b))},g.tickFormat=function(b,c){return wd(a,b,c)},g.nice=function(b){return Lf(a,b),e()},g.copy=function(){return Kf(a,b,c,d)},e()}function xd(a,b){return l.rebind(a,
b,"range","rangeRound","interpolate","clamp")}function Lf(a,b){return $b(a,Jf(Ja(a,b)[2])),$b(a,Jf(Ja(a,b)[2])),a}function Ja(a,b){null==b&&(b=10);a=gb(a);var c=a[1]-a[0],d=Math.pow(10,Math.floor(Math.log(c/b)/Math.LN10));b=b/c*d;return.15>=b?d*=10:.35>=b?d*=5:.75>=b&&(d*=2),a[0]=Math.ceil(a[0]/d)*d,a[1]=Math.floor(a[1]/d)*d+.5*d,a[2]=d,a}function wd(a,b,c){a=Ja(a,b);if(c){b=te.exec(c);if(b.shift(),"s"===b[8]){var d=l.formatPrefix(Math.max(G(a[0]),G(a[1])));return b[7]||(b[7]="."+ac(d.scale(a[2]))),
b[8]="f",c=l.format(b.join("")),function(a){return c(d.scale(a))+d.symbol}}b[7]||(b[7]="."+gi(b[8],a));c=b.join("")}else c=",."+ac(a[2])+"f";return l.format(c)}function ac(a){return-Math.floor(Math.log(a)/Math.LN10+.01)}function gi(a,b){var c=ac(b[2]);return a in hi?Math.abs(c-ac(Math.max(G(b[0]),G(b[1]))))+ +("e"!==a):c-2*("%"===a)}function Mf(a,b,c,d){function e(a){return(c?Math.log(0>a?0:a):-Math.log(0<a?0:-a))/Math.log(b)}function g(a){return c?Math.pow(b,a):-Math.pow(b,-a)}function k(b){return a(e(b))}
return k.invert=function(b){return g(a.invert(b))},k.domain=function(b){return arguments.length?(c=0<=b[0],a.domain((d=b.map(Number)).map(e)),k):d},k.base=function(c){return arguments.length?(b=+c,a.domain(d.map(e)),k):b},k.nice=function(){var b=$b(d.map(e),c?Math:ii);return a.domain(b),d=b.map(g),k},k.ticks=function(){var a=gb(d),k=[],f=a[0],a=a[1],r=Math.floor(e(f)),u=Math.ceil(e(a)),t=b%1?2:b;if(isFinite(u-r)){if(c){for(;u>r;r++)for(var l=1;t>l;l++)k.push(g(r)*l);k.push(g(r))}else for(k.push(g(r));r++<
u;)for(l=t-1;0<l;l--)k.push(g(r)*l);for(r=0;k[r]<f;r++);for(u=k.length;k[u-1]>a;u--);k=k.slice(r,u)}return k},k.tickFormat=function(a,c){if(!arguments.length)return Nf;2>arguments.length?c=Nf:"function"!=typeof c&&(c=l.format(c));var d=Math.max(1,b*a/k.ticks().length);return function(a){var h=a/g(Math.round(e(a)));return b-.5>h*b&&(h*=b),d>=h?c(a):""}},k.copy=function(){return Mf(a.copy(),b,c,d)},xd(k,a)}function Of(a,b,c){function d(b){return a(e(b))}var e=bc(b),g=bc(1/b);return d.invert=function(b){return g(a.invert(b))},
d.domain=function(b){return arguments.length?(a.domain((c=b.map(Number)).map(e)),d):c},d.ticks=function(a){return l.range.apply(l,Ja(c,a))},d.tickFormat=function(a,b){return wd(c,a,b)},d.nice=function(a){return d.domain(Lf(c,a))},d.exponent=function(k){return arguments.length?(e=bc(b=k),g=bc(1/b),a.domain(c.map(e)),d):b},d.copy=function(){return Of(a.copy(),b,c)},xd(d,a)}function bc(a){return function(b){return 0>b?-Math.pow(-b,a):Math.pow(b,a)}}function Pf(a,b){function c(c){return g[((e.get(c)||
("range"===b.t?e.set(c,a.push(c)):NaN))-1)%g.length]}function d(b,c){return l.range(a.length).map(function(a){return b+c*a})}var e,g,k;return c.domain=function(d){if(!arguments.length)return a;a=[];e=new v;for(var g,h=-1,k=d.length;++h<k;)e.has(g=d[h])||e.set(g,a.push(g));return c[b.t].apply(c,b.a)},c.range=function(a){return arguments.length?(g=a,k=0,b={t:"range",a:arguments},c):g},c.rangePoints=function(e,f){2>arguments.length&&(f=0);var h=e[0],n=e[1],n=2>a.length?(h=(h+n)/2,0):(n-h)/(a.length-
1+f);return g=d(h+n*f/2,n),k=0,b={t:"rangePoints",a:arguments},c},c.rangeRoundPoints=function(e,f){2>arguments.length&&(f=0);var h=e[0],n=e[1],u=2>a.length?(h=n=Math.round((h+n)/2),0):(n-h)/(a.length-1+f)|0;return g=d(h+Math.round(u*f/2+(n-h-(a.length-1+f)*u)/2),u),k=0,b={t:"rangeRoundPoints",a:arguments},c},c.rangeBands=function(e,f,q){2>arguments.length&&(f=0);3>arguments.length&&(q=f);var h=e[1]<e[0],n=e[h-0],t=(e[1-h]-n)/(a.length-f+2*q);return g=d(n+t*q,t),h&&g.reverse(),k=t*(1-f),b={t:"rangeBands",
a:arguments},c},c.rangeRoundBands=function(e,f,q){2>arguments.length&&(f=0);3>arguments.length&&(q=f);var h=e[1]<e[0],n=e[h-0],t=e[1-h],l=Math.floor((t-n)/(a.length-f+2*q));return g=d(n+Math.round((t-n-(a.length-f)*l)/2),l),h&&g.reverse(),k=Math.round(l*(1-f)),b={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return k},c.rangeExtent=function(){return gb(b.a[0])},c.copy=function(){return Pf(a,b)},c.domain(a)}function Qf(a,b){function c(){var c=0,f=b.length;for(e=[];++c<f;)e[c-1]=l.quantile(a,
c/f);return d}function d(a){return isNaN(a=+a)?void 0:b[l.bisect(e,a)]}var e;return d.domain=function(b){return arguments.length?(a=b.map(O).filter(ua).sort(S),c()):a},d.range=function(a){return arguments.length?(b=a,c()):b},d.quantiles=function(){return e},d.invertExtent=function(c){return c=b.indexOf(c),0>c?[NaN,NaN]:[0<c?e[c-1]:a[0],c<e.length?e[c]:a[a.length-1]]},d.copy=function(){return Qf(a,b)},c()}function Rf(a,b,c){function d(b){return c[Math.max(0,Math.min(f,Math.floor(g*(b-a))))]}function e(){return g=
c.length/(b-a),f=c.length-1,d}var g,f;return d.domain=function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],e()):[a,b]},d.range=function(a){return arguments.length?(c=a,e()):c},d.invertExtent=function(b){return b=c.indexOf(b),b=0>b?NaN:b/g+a,[b,b+1/g]},d.copy=function(){return Rf(a,b,c)},e()}function Sf(a,b){function c(c){return c>=c?b[l.bisect(a,c)]:void 0}return c.domain=function(b){return arguments.length?(a=b,c):a},c.range=function(a){return arguments.length?(b=a,c):b},c.invertExtent=
function(c){return c=b.indexOf(c),[a[c-1],a[c]]},c.copy=function(){return Sf(a,b)},c}function Tf(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(c){return arguments.length?(a=c.map(b),b):a},b.ticks=function(b){return l.range.apply(l,Ja(a,b))},b.tickFormat=function(b,d){return wd(a,b,d)},b.copy=function(){return Tf(a)},b}function ji(){return 0}function ki(a){return a.innerRadius}function li(a){return a.outerRadius}function Uf(a){return a.startAngle}function Vf(a){return a.endAngle}
function mi(a){return a&&a.padAngle}function cc(a,b,c,d){return 0<(a-c)*b-(b-d)*a?0:1}function dc(a,b,c,d,e){var g=a[0]-b[0],f=a[1]-b[1];e=(e?d:-d)/Math.sqrt(g*g+f*f);var f=e*f,g=-e*g,h=a[0]+f,n=a[1]+g,q=b[0]+f,r=b[1]+g;a=(h+q)/2;b=(n+r)/2;e=q-h;var l=r-n,t=e*e+l*l;d=c-d;var r=h*r-q*n,m=(0>l?-1:1)*Math.sqrt(Math.max(0,d*d*t-r*r)),h=(r*l-e*m)/t,n=(-r*e-l*m)/t,q=(r*l+e*m)/t;e=(-r*e+l*m)/t;l=h-a;t=n-b;a=q-a;b=e-b;return l*l+t*t>a*a+b*b&&(h=q,n=e),[[h-f,n-g],[h*c/d,n*c/d]]}function Wf(a){function b(b){function f(){n.push("M",
g(a(l),h))}for(var k,n=[],l=[],m=-1,A=b.length,L=R(c),F=R(d);++m<A;)e.call(this,k=b[m],m)?l.push([+L.call(this,k,m),+F.call(this,k,m)]):l.length&&(f(),l=[]);return l.length&&f(),n.length?n.join(""):null}var c=ab,d=nb,e=kb,g=oa,f=g.key,h=.7;return b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b.defined=function(a){return arguments.length?(e=a,b):e},b.interpolate=function(a){return arguments.length?(f="function"==typeof a?g=a:(g=yd.get(a)||oa).key,
b):f},b.tension=function(a){return arguments.length?(h=a,b):h},b}function oa(a){return 1<a.length?a.join("L"):a+"Z"}function Xf(a){return a.join("L")+"Z"}function zd(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("V",(d=a[b])[1],"H",d[0]);return e.join("")}function Ad(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d=a[b])[0],"V",d[1]);return e.join("")}function ec(a,b){if(1>b.length||a.length!=b.length&&a.length!=b.length+2)return oa(a);var c=a.length!=b.length,
d="",e=a[0],g=a[1],f=b[0],h=f,n=1;if(c&&(d+="Q"+(g[0]-2*f[0]/3)+","+(g[1]-2*f[1]/3)+","+g[0]+","+g[1],e=a[1],n=2),1<b.length)for(h=b[1],g=a[n],n++,d+="C"+(e[0]+f[0])+","+(e[1]+f[1])+","+(g[0]-h[0])+","+(g[1]-h[1])+","+g[0]+","+g[1],e=2;e<b.length;e++,n++)g=a[n],h=b[e],d+="S"+(g[0]-h[0])+","+(g[1]-h[1])+","+g[0]+","+g[1];c&&(a=a[n],d+="Q"+(g[0]+2*h[0]/3)+","+(g[1]+2*h[1]/3)+","+a[0]+","+a[1]);return d}function Bd(a,b){for(var c=[],d=(1-b)/2,e=a[0],g=a[1],f=1,h=a.length;++f<h;)b=e,e=g,g=a[f],c.push([d*
(g[0]-b[0]),d*(g[1]-b[1])]);return c}function Yf(a){if(3>a.length)return oa(a);var b=1,c=a.length,d=a[0],e=d[0],g=d[1],f=[e,e,e,(d=a[1])[0]],h=[g,g,g,d[1]],e=[e,",",g,"L",ia(Ka,f),",",ia(Ka,h)];for(a.push(a[c-1]);++b<=c;)d=a[b],f.shift(),f.push(d[0]),h.shift(),h.push(d[1]),Cd(e,f,h);return a.pop(),e.push("L",d),e.join("")}function ia(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function Cd(a,b,c){a.push("C",ia(Zf,b),",",ia(Zf,c),",",ia($f,b),",",ia($f,c),",",ia(Ka,b),",",ia(Ka,c))}function Dd(a,
b){return(b[1]-a[1])/(b[0]-a[0])}function ag(a){for(var b,c,d,e=-1,g=a.length;++e<g;)b=a[e],c=b[0],d=b[1]-V,b[0]=c*Math.cos(d),b[1]=c*Math.sin(d);return a}function bg(a){function b(b){function k(){m.push("M",h(a(y),l),r,q(a(x.reverse()),l),"Z")}for(var n,t,u,m=[],x=[],y=[],C=-1,N=b.length,H=R(c),T=R(e),p=c===d?function(){return t}:R(d),ea=e===g?function(){return u}:R(g);++C<N;)f.call(this,n=b[C],C)?(x.push([t=+H.call(this,n,C),u=+T.call(this,n,C)]),y.push([+p.call(this,n,C),+ea.call(this,n,C)])):
x.length&&(k(),x=[],y=[]);return x.length&&k(),m.length?m.join(""):null}var c=ab,d=ab,e=0,g=nb,f=kb,h=oa,n=h.key,q=h,r="L",l=.7;return b.x=function(a){return arguments.length?(c=d=a,b):d},b.x0=function(a){return arguments.length?(c=a,b):c},b.x1=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(e=g=a,b):g},b.y0=function(a){return arguments.length?(e=a,b):e},b.y1=function(a){return arguments.length?(g=a,b):g},b.defined=function(a){return arguments.length?(f=a,b):
f},b.interpolate=function(a){return arguments.length?(n="function"==typeof a?h=a:(h=yd.get(a)||oa).key,q=h.reverse||h,r=h.closed?"M":"L",b):n},b.tension=function(a){return arguments.length?(l=a,b):l},b}function ni(a){return a.radius}function cg(a){return[a.x,a.y]}function oi(a){return function(){var b=a.apply(this,arguments),c=b[0],b=b[1]-V;return[c*Math.cos(b),c*Math.sin(b)]}}function pi(){return 64}function qi(){return"circle"}function dg(a){a=Math.sqrt(a/M);return"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+
-a+"A"+a+","+a+" 0 1,1 0,"+a+"Z"}function eg(a){return function(){var b,c,d;(b=this[a])&&(d=b[c=b.active])&&(d.timer.c=null,d.timer.t=NaN,--b.count?delete b[c]:delete this[a],b.active+=.5,d.event&&d.event.interrupt.call(this,this.__data__,d.index))}}function vb(a,b,c){return xb(a,Y),a.namespace=b,a.id=c,a}function Ed(a,b,c,d){var e=a.id,g=a.namespace;return va(a,"function"==typeof c?function(a,f,n){a[g][e].tween.set(b,d(c.call(a,a.__data__,f,n)))}:(c=d(c),function(a){a[g][e].tween.set(b,c)}))}function ri(a){return null==
a&&(a=""),function(){this.textContent=a}}function Fd(a){return null==a?"__transition__":"__transition_"+a+"__"}function fc(a,b,c,d,e){function g(a){var b=A.delay;return q.t=b+n,a>=b?f(a-b):void(q.c=f)}function f(c){var g=m.active,e=m[g];e&&(e.timer.c=null,e.timer.t=NaN,--m.count,delete m[g],e.event&&e.event.interrupt.call(a,a.__data__,e.index));for(var f in m)d>+f&&(g=m[f],g.timer.c=null,g.timer.t=NaN,--m.count,delete m[f]);q.c=h;Cb(function(){return q.c&&h(c||1)&&(q.c=null,q.t=NaN),1},0,n);m.active=
d;A.event&&A.event.start.call(a,a.__data__,b);t=[];A.tween.forEach(function(c,d){(d=d.call(a,a.__data__,b))&&t.push(d)});l=A.ease;r=A.duration}function h(g){g/=r;for(var e=l(g),f=t.length;0<f;)t[--f].call(a,e);return 1<=g?(A.event&&A.event.end.call(a,a.__data__,b),--m.count?delete m[d]:delete a[c],1):void 0}var n,q,r,l,t,m=a[c]||(a[c]={active:0,count:0}),A=m[d];A||(n=e.time,q=Cb(g,0,n),A=m[d]={tween:new v,time:n,timer:q,delay:e.delay,duration:e.duration,ease:e.ease,index:b},e=null,++m.count)}function si(a,
b,c){a.attr("transform",function(a){var d=b(a);return"translate("+(isFinite(d)?d:c(a))+",0)"})}function ti(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate(0,"+(isFinite(d)?d:c(a))+")"})}function Gd(a){return a.toISOString()}function Hd(a,b,c){function d(b){return a(b)}function e(a,c){var d=(a[1]-a[0])/c,g=l.bisect(gc,d);return g==gc.length?[b.year,Ja(a.map(function(a){return a/31536E6}),c)[2]]:g?b[d/gc[g-1]<gc[g]/d?g-1:g]:[ui,Ja(a,c)[2]]}return d.invert=function(b){return Va(a.invert(b))},
d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map(Va)},d.nice=function(a,b){function c(c){return!isNaN(c)&&!a.range(c,Va(+c+1),b).length}var g=d.domain(),f=gb(g),f=null==a?e(f,10):"number"==typeof a&&e(f,a);return f&&(a=f[0],b=f[1]),d.domain($b(g,1<b?{floor:function(b){for(;c(b=a.floor(b));)b=Va(b-1);return b},ceil:function(b){for(;c(b=a.ceil(b));)b=Va(+b+1);return b}}:a))},d.ticks=function(a,b){var c=gb(d.domain()),g=null==a?e(c,10):"number"==typeof a?e(c,a):!a.range&&[{range:a},
b];return g&&(a=g[0],b=g[1]),a.range(c[0],Va(+c[1]+1),1>b?1:b)},d.tickFormat=function(){return c},d.copy=function(){return Hd(a.copy(),b,c)},xd(d,a)}function Va(a){return new Date(a)}function vi(a){return JSON.parse(a.responseText)}function wi(a){var b=ca.createRange();return b.selectNode(ca.body),b.createContextualFragment(a.responseText)}var l={version:"3.5.17"},fg=[].slice,qa=function(a){return fg.call(a)},ca=this.document;if(ca)try{qa(ca.documentElement.childNodes)}catch(a){qa=function(a){for(var b=
a.length,d=Array(b);b--;)d[b]=a[b];return d}}if(Date.now||(Date.now=function(){return+new Date}),ca)try{ca.createElement("DIV").style.setProperty("opacity",0,"")}catch(a){var hc=this.Element.prototype,xi=hc.setAttribute,yi=hc.setAttributeNS,gg=this.CSSStyleDeclaration.prototype,zi=gg.setProperty;hc.setAttribute=function(a,c){xi.call(this,a,c+"")};hc.setAttributeNS=function(a,c,d){yi.call(this,a,c,d+"")};gg.setProperty=function(a,c,d){zi.call(this,a,c+"",d)}}l.ascending=S;l.descending=function(a,b){return a>
b?-1:b>a?1:b>=a?0:NaN};l.min=function(a,b){var c,d,e=-1,g=a.length;if(1===arguments.length){for(;++e<g;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<g;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<g;)if(null!=(d=b.call(a,a[e],e))&&d>=d){c=d;break}for(;++e<g;)null!=(d=b.call(a,a[e],e))&&c>d&&(c=d)}return c};l.max=function(a,b){var c,d,e=-1,g=a.length;if(1===arguments.length){for(;++e<g;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<g;)null!=(d=a[e])&&d>c&&(c=d)}else{for(;++e<g;)if(null!=(d=b.call(a,a[e],
e))&&d>=d){c=d;break}for(;++e<g;)null!=(d=b.call(a,a[e],e))&&d>c&&(c=d)}return c};l.extent=function(a,b){var c,d,e,g=-1,f=a.length;if(1===arguments.length){for(;++g<f;)if(null!=(d=a[g])&&d>=d){c=e=d;break}for(;++g<f;)null!=(d=a[g])&&(c>d&&(c=d),d>e&&(e=d))}else{for(;++g<f;)if(null!=(d=b.call(a,a[g],g))&&d>=d){c=e=d;break}for(;++g<f;)null!=(d=b.call(a,a[g],g))&&(c>d&&(c=d),d>e&&(e=d))}return[c,e]};l.sum=function(a,b){var c,d=0,e=a.length,g=-1;if(1===arguments.length)for(;++g<e;)!isNaN(c=+a[g])&&(d+=
c);else for(;++g<e;)!isNaN(c=+b.call(a,a[g],g))&&(d+=c);return d};l.mean=function(a,b){var c,d=0,e=a.length,g=-1,f=e;if(1===arguments.length)for(;++g<e;)isNaN(c=O(a[g]))?--f:d+=c;else for(;++g<e;)isNaN(c=O(b.call(a,a[g],g)))?--f:d+=c;return f?d/f:void 0};l.quantile=function(a,b){var c=(a.length-1)*b+1;b=Math.floor(c);var d=+a[b-1];return(c-=b)?d+c*(a[b]-d):d};l.median=function(a,b){var c,d=[],e=a.length,g=-1;if(1===arguments.length)for(;++g<e;)!isNaN(c=O(a[g]))&&d.push(c);else for(;++g<e;)!isNaN(c=
O(b.call(a,a[g],g)))&&d.push(c);return d.length?l.quantile(d.sort(S),.5):void 0};l.variance=function(a,b){var c,d,e=a.length,g=0,f=0,h=-1,n=0;if(1===arguments.length)for(;++h<e;)!isNaN(c=O(a[h]))&&(d=c-g,g+=d/++n,f+=d*(c-g));else for(;++h<e;)!isNaN(c=O(b.call(a,a[h],h)))&&(d=c-g,g+=d/++n,f+=d*(c-g));return 1<n?f/(n-1):void 0};l.deviation=function(){var a=l.variance.apply(this,arguments);return a?Math.sqrt(a):a};var hg=f(S);l.bisectLeft=hg.left;l.bisect=l.bisectRight=hg.right;l.bisector=function(a){return f(1===
a.length?function(b,c){return S(a(b),c)}:a)};l.shuffle=function(a,b,c){3>(g=arguments.length)&&(c=a.length,2>g&&(b=0));for(var d,e,g=c-b;g;)e=Math.random()*g--|0,d=a[g+b],a[g+b]=a[e+b],a[e+b]=d;return a};l.permute=function(a,b){for(var c=b.length,d=Array(c);c--;)d[c]=a[b[c]];return d};l.pairs=function(a){for(var b=0,c=a.length-1,d=a[0],e=Array(0>c?0:c);c>b;)e[b]=[d,d=a[++b]];return e};l.transpose=function(a){if(!(e=a.length))return[];for(var b=-1,c=l.min(a,m),d=Array(c);++b<c;)for(var e,g=-1,f=d[b]=
Array(e);++g<e;)f[g]=a[g][b];return d};l.zip=function(){return l.transpose(arguments)};l.keys=function(a){var b=[],c;for(c in a)b.push(c);return b};l.values=function(a){var b=[],c;for(c in a)b.push(a[c]);return b};l.entries=function(a){var b=[],c;for(c in a)b.push({key:c,value:a[c]});return b};l.merge=function(a){var b,c,d,e=a.length;b=-1;for(var g=0;++b<e;)g+=a[b].length;for(c=Array(g);0<=--e;)for(d=a[e],b=d.length;0<=--b;)c[--g]=d[b];return c};var G=Math.abs;l.range=function(a,b,c){if(3>arguments.length&&
(c=1,2>arguments.length&&(b=a,a=0)),(b-a)/c===1/0)throw Error("infinite range");var d,e=[],g;d=G(c);for(g=1;d*g%1;)g*=10;var f=-1;if(a*=g,b*=g,c*=g,0>c)for(;(d=a+c*++f)>b;)e.push(d/g);else for(;(d=a+c*++f)<b;)e.push(d/g);return e};l.map=function(a,b){var c=new v;if(a instanceof v)a.forEach(function(a,b){c.set(a,b)});else if(Array.isArray(a)){var d,e=-1,g=a.length;if(1===arguments.length)for(;++e<g;)c.set(e,a[e]);else for(;++e<g;)c.set(b.call(a,d=a[e],e),d)}else for(e in a)c.set(e,a[e]);return c};
var zg="__proto__",xc="\x00";p(v,{has:J,get:function(a){return this._[z(a)]},set:function(a,b){return this._[z(a)]=b},remove:aa,keys:ja,values:function(){var a=[],b;for(b in this._)a.push(this._[b]);return a},entries:function(){var a=[],b;for(b in this._)a.push({key:P(b),value:this._[b]});return a},size:Sd,empty:pa,forEach:function(a){for(var b in this._)a.call(this,P(b),this._[b])}});l.nest=function(){function a(b,f,k){if(k>=g.length)return d?d.call(e,f):c?f.sort(c):f;for(var h,n,q,l,m=-1,L=f.length,
F=g[k++],I=new v;++m<L;)(l=I.get(h=F(n=f[m])))?l.push(n):I.set(h,[n]);return b?(n=b(),q=function(c,d){n.set(c,a(b,d,k))}):(n={},q=function(c,d){n[c]=a(b,d,k)}),I.forEach(q),n}function b(a,c){if(c>=g.length)return a;var d=[],e=f[c++];return a.forEach(function(a,e){d.push({key:a,values:b(e,c)})}),e?d.sort(function(a,b){return e(a.key,b.key)}):d}var c,d,e={},g=[],f=[];return e.map=function(b,c){return a(c,b,0)},e.entries=function(c){return b(a(l.map,c,0),0)},e.key=function(a){return g.push(a),e},e.sortKeys=
function(a){return f[g.length-1]=a,e},e.sortValues=function(a){return c=a,e},e.rollup=function(a){return d=a,e},e};l.set=function(a){var b=new yc;if(a)for(var c=0,d=a.length;d>c;++c)b.add(a[c]);return b};p(yc,{has:J,add:function(a){return this._[z(a+="")]=!0,a},remove:aa,values:ja,size:Sd,empty:pa,forEach:function(a){for(var b in this._)a.call(this,P(b))}});l.behavior={};l.rebind=function(a,b){for(var c,d=1,e=arguments.length;++d<e;)a[c=arguments[d]]=Ag(a,b,b[c]);return a};var Td="webkit ms moz Moz o O".split(" ");
l.dispatch=function(){for(var a=new Ac,b=-1,c=arguments.length;++b<c;)a[arguments[b]]=Ud(a);return a};Ac.prototype.on=function(a,b){var c=a.indexOf("."),d="";if(0<=c&&(d=a.slice(c+1),a=a.slice(0,c)),a)return 2>arguments.length?this[a].on(d):this[a].on(d,b);if(2===arguments.length){if(null==b)for(a in this)this.hasOwnProperty(a)&&this[a].on(d,null);return this}};l.event=null;l.requote=function(a){return a.replace(Ai,"\\$\x26")};var Ai=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,xb={}.__proto__?function(a,b){a.__proto__=
b}:function(a,b){for(var c in b)a[c]=b[c]},Ec=function(a,b){return b.querySelector(a)},Fc=function(a,b){return b.querySelectorAll(a)},Hc=function(a,b){var c=a.matches||a[zc(a,"matchesSelector")];return(Hc=function(a,b){return c.call(a,b)})(a,b)};"function"==typeof Sizzle&&(Ec=function(a,b){return Sizzle(a,b)[0]||null},Fc=Sizzle,Hc=Sizzle.matchesSelector);l.selection=function(){return l.select(ca.documentElement)};var Q=l.selection.prototype=[];Q.select=function(a){var b,c,d,e,g=[];a=Dc(a);for(var f=
-1,h=this.length;++f<h;){g.push(b=[]);b.parentNode=(d=this[f]).parentNode;for(var n=-1,q=d.length;++n<q;)(e=d[n])?(b.push(c=a.call(e,e.__data__,n,f)),c&&"__data__"in e&&(c.__data__=e.__data__)):b.push(null)}return Ca(g)};Q.selectAll=function(a){var b,c,d=[];a=Vd(a);for(var e=-1,g=this.length;++e<g;)for(var f=this[e],h=-1,n=f.length;++h<n;)(c=f[h])&&(d.push(b=qa(a.call(c,c.__data__,h,e))),b.parentNode=c);return Ca(d)};var Gc="http://www.w3.org/1999/xhtml",Id={svg:"http://www.w3.org/2000/svg",xhtml:Gc,
xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};l.ns={prefix:Id,qualify:function(a){var b=a.indexOf(":"),c=a;return 0<=b&&"xmlns"!==(c=a.slice(0,b))&&(a=a.slice(b+1)),Id.hasOwnProperty(c)?{space:Id[c],local:a}:a}};Q.attr=function(a,b){if(2>arguments.length){if("string"==typeof a){var c=this.node();return a=l.ns.qualify(a),a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}for(b in a)this.each(Wd(b,a[b]));return this}return this.each(Wd(a,
b))};Q.classed=function(a,b){if(2>arguments.length){if("string"==typeof a){var c=this.node(),d=(a=(a+"").trim().split(/^|\s+/)).length,e=-1;if(b=c.classList)for(;++e<d;){if(!b.contains(a[e]))return!1}else for(b=c.getAttribute("class");++e<d;)if(!Xd(a[e]).test(b))return!1;return!0}for(b in a)this.each(Yd(b,a[b]));return this}return this.each(Yd(a,b))};Q.style=function(a,b,c){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b="");for(c in a)this.each(Zd(c,a[c],b));return this}if(2>d)return d=
this.node(),D(d).getComputedStyle(d,null).getPropertyValue(a);c=""}return this.each(Zd(a,b,c))};Q.property=function(a,b){if(2>arguments.length){if("string"==typeof a)return this.node()[a];for(b in a)this.each($d(b,a[b]));return this}return this.each($d(a,b))};Q.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent};
Q.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML};Q.append=function(a){return a=ae(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})};Q.insert=function(a,b){return a=ae(a),b=Dc(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})};Q.remove=
function(){return this.each(Cg)};Q.data=function(a,b){function c(a,c){var d,e,g,f=a.length,k=c.length,l=Math.min(f,k),r=Array(k),u=Array(k),m=Array(f);if(b){var N,l=new v,H=Array(f);for(d=-1;++d<f;)(e=a[d])&&(l.has(N=b.call(e,e.__data__,d))?m[d]=e:l.set(N,e),H[d]=N);for(d=-1;++d<k;)(e=l.get(N=b.call(c,g=c[d],d)))?!0!==e&&(r[d]=e,e.__data__=g):u[d]={__data__:g},l.set(N,!0);for(d=-1;++d<f;)d in H&&!0!==l.get(H[d])&&(m[d]=a[d])}else{for(d=-1;++d<l;)e=a[d],g=c[d],e?(e.__data__=g,r[d]=e):u[d]={__data__:g};
for(;k>d;++d)u[d]={__data__:c[d]};for(;f>d;++d)m[d]=a[d]}u.update=r;u.parentNode=r.parentNode=m.parentNode=a.parentNode;h.push(u);n.push(r);q.push(m)}var d,e,g=-1,f=this.length;if(!arguments.length){for(a=Array(f=(d=this[0]).length);++g<f;)(e=d[g])&&(a[g]=e.__data__);return a}var h=ce([]),n=Ca([]),q=Ca([]);if("function"==typeof a)for(;++g<f;)c(d=this[g],a.call(d,d.parentNode.__data__,g));else for(;++g<f;)c(d=this[g],a);return n.enter=function(){return h},n.exit=function(){return q},n};Q.datum=function(a){return arguments.length?
this.property("__data__",a):this.property("__data__")};Q.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=be(a));for(var g=0,f=this.length;f>g;g++){e.push(b=[]);b.parentNode=(c=this[g]).parentNode;for(var h=0,n=c.length;n>h;h++)(d=c[h])&&a.call(d,d.__data__,h,g)&&b.push(d)}return Ca(e)};Q.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c,d=this[a],e=d.length-1,g=d[e];0<=--e;)(c=d[e])&&(g&&g!==c.nextSibling&&g.parentNode.insertBefore(c,g),g=c);return this};Q.sort=function(a){a=
Dg.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()};Q.each=function(a){return va(this,function(b,c,d){a.call(b,b.__data__,c,d)})};Q.call=function(a){var b=qa(arguments);return a.apply(b[0]=this,b),this};Q.empty=function(){return!this.node()};Q.node=function(){for(var a=0,b=this.length;b>a;a++)for(var c=this[a],d=0,e=c.length;e>d;d++){var g=c[d];if(g)return g}return null};Q.size=function(){var a=0;return va(this,function(){++a}),a};var wa=[];l.selection.enter=
ce;l.selection.enter.prototype=wa;wa.append=Q.append;wa.empty=Q.empty;wa.node=Q.node;wa.call=Q.call;wa.size=Q.size;wa.select=function(a){for(var b,c,d,e,g,f=[],h=-1,n=this.length;++h<n;){d=(e=this[h]).update;f.push(b=[]);b.parentNode=e.parentNode;for(var q=-1,l=e.length;++q<l;)(g=e[q])?(b.push(d[q]=c=a.call(e.parentNode,g.__data__,q,h)),c.__data__=g.__data__):b.push(null)}return Ca(f)};wa.insert=function(a,b){return 2>arguments.length&&(b=Eg(this)),Q.insert.call(this,a,b)};l.select=function(a){var b;
return"string"==typeof a?(b=[Ec(a,ca)],b.parentNode=ca.documentElement):(b=[a],b.parentNode=a&&(a.ownerDocument||a.document||a).documentElement),Ca([b])};l.selectAll=function(a){var b;return"string"==typeof a?(b=qa(Fc(a,ca)),b.parentNode=ca.documentElement):(b=qa(a),b.parentNode=null),Ca([b])};Q.on=function(a,b,c){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b=!1);for(c in a)this.each(de(c,a[c],b));return this}if(2>d)return(d=this.node()["__on"+a])&&d._;c=!1}return this.each(de(a,b,
c))};var Ic=l.map({mouseenter:"mouseover",mouseleave:"mouseout"});ca&&Ic.forEach(function(a){"on"+a in ca&&Ic.remove(a)});var La,Gg=0;l.mouse=function(a){return Jc(a,Bc())};var Kc=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;l.touch=function(a,b,c){if(3>arguments.length&&(c=b,b=Bc().changedTouches),b)for(var d,e=0,g=b.length;g>e;++e)if((d=b[e]).identifier===c)return Jc(a,d)};l.behavior.drag=function(){function a(){this.on("mousedown.drag",e).on("touchstart.drag",g)}function b(a,b,
e,g,f){return function(){var h,k=l.event.target.correspondingElement||l.event.target,n=this.parentNode,q=c.of(this,arguments),r=0,m=a(),I=".drag"+(null==m?"":"-"+m),x=l.select(e(k)).on(g+I,function(){var a,c,d=b(n,m);d&&(a=d[0]-C[0],c=d[1]-C[1],r|=a|c,C=d,q({type:"drag",x:d[0]+h[0],y:d[1]+h[1],dx:a,dy:c}))}).on(f+I,function(){b(n,m)&&(x.on(g+I,null).on(f+I,null),y(r),q({type:"dragend"}))}),y=yb(k),C=b(n,m);d?(h=d.apply(this,arguments),h=[h.x-C[0],h.y-C[1]]):h=[0,0];q({type:"dragstart"})}}var c=Cc(a,
"drag","dragstart","dragend"),d=null,e=b(X,l.mouse,D,"mousemove","mouseup"),g=b(Hg,l.touch,Z,"touchmove","touchend");return a.origin=function(b){return arguments.length?(d=b,a):d},l.rebind(a,c,"on")};l.touches=function(a,b){return 2>arguments.length&&(b=Bc().touches),b?qa(b).map(function(b){var c=Jc(a,b);return c.identifier=b.identifier,c}):[]};var B=1E-6,Vb=B*B,M=Math.PI,ha=2*M,Bi=ha-B,V=M/2,K=M/180,U=180/M,wb=Math.SQRT2;l.interpolateZoom=function(a,b){var c,d=a[0],e=a[1],g=a[2];a=b[2];var f=b[0]-
d,h=b[1]-e,n=f*f+h*h;if(Vb>n)c=Math.log(a/g)/wb,a=function(a){return[d+a*f,e+a*h,g*Math.exp(wb*a*c)]};else{var q=Math.sqrt(n);b=(a*a-g*g+4*n)/(4*g*q);a=(a*a-g*g-4*n)/(4*a*q);var l=Math.log(Math.sqrt(b*b+1)-b);c=(Math.log(Math.sqrt(a*a+1)-a)-l)/wb;a=function(a){a*=c;var b=ge(l),k=g/(2*q),n,r=wb*a+l;n=((r=Math.exp(2*r))-1)/(r+1);var m=l,r=((m=Math.exp(m))-1/m)/2,k=k*(b*n-r);return[d+k*f,e+k*h,g*b/ge(wb*a+l)]}}return a.duration=1E3*c,a};l.behavior.zoom=function(){function a(a){a.on(B,q).on(Jd+".zoom",
m).on("dblclick.zoom",t).on(P,r)}function b(a){return[(a[0]-H.x)/H.k,(a[1]-H.y)/H.k]}function c(a){H.k=Math.max(v[0],Math.min(v[1],a))}function d(a,b){b=[b[0]*H.k+H.x,b[1]*H.k+H.y];H.x+=a[0]-b[0];H.y+=a[1]-b[1]}function e(b,e,g,f){b.__chart__={x:H.x,y:H.y,k:H.k};c(Math.pow(2,f));d(A=e,g);b=l.select(b);0<ea&&(b=b.transition().duration(ea));b.call(a.event)}function g(){y&&y.domain(x.range().map(function(a){return(a-H.x)/H.k}).map(x.invert));p&&p.domain(C.range().map(function(a){return(a-H.y)/H.k}).map(C.invert))}
function f(a){w++||a({type:"zoomstart"})}function h(a){g();a({type:"zoom",scale:H.k,translate:[H.x,H.y]})}function n(a){--w||(a({type:"zoomend"}),A=null)}function q(){var a=this,c=G.of(a,arguments),e=0,g=l.select(D(a)).on(z,function(){e=1;d(l.mouse(a),k);h(c)}).on(K,function(){g.on(z,null).on(K,null);q(e);n(c)}),k=b(l.mouse(a)),q=yb(a);ic.call(a);f(c)}function r(){function a(){var a=l.touches(t);return u=H.k,a.forEach(function(a){a.identifier in x&&(x[a.identifier]=b(a))}),a}function g(){var b=l.event.target;
l.select(b).on(y,k).on(L,m);C.push(b);for(var b=l.event.changedTouches,c=0,d=b.length;d>c;++c)x[b[c].identifier]=null;c=a();d=Date.now();1===c.length?(500>d-I&&(b=c[0],e(t,b,x[b.identifier],Math.floor(Math.log(H.k)/Math.LN2)+1),Ba()),I=d):1<c.length&&(b=c[0],d=c[1],c=b[0]-d[0],b=b[1]-d[1],E=c*c+b*b)}function k(){var a,b,e,g,f=l.touches(t);ic.call(t);for(var k=0,n=f.length;n>k;++k,g=null)if(e=f[k],g=x[e.identifier]){if(b)break;a=e;b=g}if(g){var q=(q=e[0]-a[0])*q+(q=e[1]-a[1])*q,f=E&&Math.sqrt(q/E);
a=[(a[0]+e[0])/2,(a[1]+e[1])/2];b=[(b[0]+g[0])/2,(b[1]+g[1])/2];c(f*u)}I=null;d(a,b);h(A)}function m(){if(l.event.touches.length){for(var b=l.event.changedTouches,c=0,d=b.length;d>c;++c)delete x[b[c].identifier];for(var e in x)return void a()}l.selectAll(C).on(F,null);p.on(B,q).on(P,r);N();n(A)}var u,t=this,A=G.of(t,arguments),x={},E=0,F=".zoom-"+l.event.changedTouches[0].identifier,y="touchmove"+F,L="touchend"+F,C=[],p=l.select(t),N=yb(t);g();f(A);p.on(B,null).on(P,g)}function m(){var a=G.of(this,
arguments);F?clearTimeout(F):(ic.call(this),E=b(A=L||l.mouse(this)),f(a));F=setTimeout(function(){F=null;n(a)},50);Ba();c(Math.pow(2,.002*jc())*H.k);d(A,E);h(a)}function t(){var a=l.mouse(this),c=Math.log(H.k)/Math.LN2;e(this,a,b(a),l.event.shiftKey?Math.ceil(c)-1:Math.floor(c)+1)}var E,A,L,F,I,x,y,C,p,H={x:0,y:0,k:1},T=[960,500],v=ig,ea=250,w=0,B="mousedown.zoom",z="mousemove.zoom",K="mouseup.zoom",P="touchstart.zoom",G=Cc(a,"zoomstart","zoom","zoomend");return Jd||(Jd="onwheel"in ca?(jc=function(){return-l.event.deltaY*
(l.event.deltaMode?120:1)},"wheel"):"onmousewheel"in ca?(jc=function(){return l.event.wheelDelta},"mousewheel"):(jc=function(){return-l.event.detail},"MozMousePixelScroll")),a.event=function(a){a.each(function(){var a=G.of(this,arguments),b=H;Wa?l.select(this).transition().each("start.zoom",function(){H=this.__chart__||{x:0,y:0,k:1};f(a)}).tween("zoom:zoom",function(){var c=T[0],d=T[1],e=A?A[0]:c/2,g=A?A[1]:d/2,f=l.interpolateZoom([(e-H.x)/H.k,(g-H.y)/H.k,c/H.k],[(e-b.x)/b.k,(g-b.y)/b.k,c/b.k]);return function(b){b=
f(b);var d=c/b[2];this.__chart__=H={x:e-b[0]*d,y:g-b[1]*d,k:d};h(a)}}).each("interrupt.zoom",function(){n(a)}).each("end.zoom",function(){n(a)}):(this.__chart__=H,f(a),h(a),n(a))})},a.translate=function(b){return arguments.length?(H={x:+b[0],y:+b[1],k:H.k},g(),a):[H.x,H.y]},a.scale=function(b){return arguments.length?(H={x:H.x,y:H.y,k:null},c(+b),g(),a):H.k},a.scaleExtent=function(b){return arguments.length?(v=null==b?ig:[+b[0],+b[1]],a):v},a.center=function(b){return arguments.length?(L=b&&[+b[0],
+b[1]],a):L},a.size=function(b){return arguments.length?(T=b&&[+b[0],+b[1]],a):T},a.duration=function(b){return arguments.length?(ea=+b,a):ea},a.x=function(b){return arguments.length?(y=b,x=b.copy(),H={x:0,y:0,k:1},a):y},a.y=function(b){return arguments.length?(p=b,C=b.copy(),H={x:0,y:0,k:1},a):p},l.rebind(a,G,"on")};var jc,Jd,ig=[0,1/0];l.color=Ma;Ma.prototype.toString=function(){return this.rgb()+""};l.hsl=ra;var Kd=ra.prototype=new Ma;Kd.brighter=function(a){return a=Math.pow(.7,arguments.length?
a:1),new ra(this.h,this.s,this.l/a)};Kd.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new ra(this.h,this.s,a*this.l)};Kd.rgb=function(){return Mc(this.h,this.s,this.l)};l.hcl=ka;var Ld=ka.prototype=new Ma;Ld.brighter=function(a){return new ka(this.h,this.c,Math.min(100,this.l+kc*(arguments.length?a:1)))};Ld.darker=function(a){return new ka(this.h,this.c,Math.max(0,this.l-kc*(arguments.length?a:1)))};Ld.rgb=function(){return Nc(this.h,this.c,this.l).rgb()};l.lab=la;var kc=18,ne=.95047,
oe=1,pe=1.08883,Md=la.prototype=new Ma;Md.brighter=function(a){return new la(Math.min(100,this.l+kc*(arguments.length?a:1)),this.a,this.b)};Md.darker=function(a){return new la(Math.max(0,this.l-kc*(arguments.length?a:1)),this.a,this.b)};Md.rgb=function(){return me(this.l,this.a,this.b)};l.rgb=da;var lc=da.prototype=new Ma;lc.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b;return b||c||d?(b&&30>b&&(b=30),c&&30>c&&(c=30),d&&30>d&&(d=30),new da(Math.min(255,b/
a),Math.min(255,c/a),Math.min(255,d/a))):new da(30,30,30)};lc.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new da(a*this.r,a*this.g,a*this.b)};lc.hsl=function(){return je(this.r,this.g,this.b)};lc.toString=function(){return"#"+Xa(this.r)+Xa(this.g)+Xa(this.b)};var Ab=l.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,
cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,
deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,
lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,
mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,
royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Ab.forEach(function(a,b){Ab.set(a,new da(b>>16,b>>8&255,255&
b))});l.functor=R;l.xhr=Tc(Z);l.dsv=function(a,b){function c(a,c,g){3>arguments.length&&(g=c,c=null);var f=Bb(a,b,null==c?d:e(c),g);return f.row=function(a){return arguments.length?f.response(null==(c=a)?d:e(a)):c},f}function d(a){return c.parse(a.responseText)}function e(a){return function(b){return c.parse(b.responseText,a)}}function g(b){return b.map(f).join(a)}function f(a){return h.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var h=new RegExp('["'+a+"\n]"),n=a.charCodeAt(0);return c.parse=function(a,
b){var d;return c.parseRows(a,function(a,c){if(d)return d(a,c-1);var e=new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+": d["+b+"]"}).join(",")+"}");d=b?function(a,c){return b(e(a),c)}:e})},c.parseRows=function(a,b){function c(){if(q>=k)return f;if(e)return e=!1,g;var b=q;if(34===a.charCodeAt(b)){for(var c=b;c++<k;)if(34===a.charCodeAt(c)){if(34!==a.charCodeAt(c+1))break;++c}q=c+2;var d=a.charCodeAt(c+1);return 13===d?(e=!0,10===a.charCodeAt(c+2)&&++q):10===d&&(e=!0),a.slice(b+
1,c).replace(/""/g,'"')}for(;k>q;){d=a.charCodeAt(q++);c=1;if(10===d)e=!0;else if(13===d)e=!0,10===a.charCodeAt(q)&&(++q,++c);else if(d!==n)continue;return a.slice(b,q-c)}return a.slice(b)}for(var d,e,g={},f={},h=[],k=a.length,q=0,l=0;(d=c())!==f;){for(var r=[];d!==g&&d!==f;)r.push(d),d=c();b&&null==(r=b(r,l++))||h.push(r)}return h},c.format=function(b){if(Array.isArray(b[0]))return c.formatRows(b);var d=new yc,e=[];return b.forEach(function(a){for(var b in a)d.has(b)||e.push(d.add(b))}),[e.map(f).join(a)].concat(b.map(function(b){return e.map(function(a){return f(b[a])}).join(a)})).join("\n")},
c.formatRows=function(a){return a.map(g).join("\n")},c};l.csv=l.dsv(",","text/csv");l.tsv=l.dsv("\t","text/tab-separated-values");var Eb,Db,Fb,Gb,qe=this[zc(this,"requestAnimationFrame")]||function(a){setTimeout(a,17)};l.timer=function(){Cb.apply(this,arguments)};l.timer.flush=function(){re();se()};l.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)};var Ci="y z a f p n \u00b5 m  k M G T P E Z Y".split(" ").map(function(a,b){var c=Math.pow(10,3*G(8-b));return{scale:8<b?
function(a){return a/c}:function(a){return a*c},symbol:a}});l.formatPrefix=function(a,b){var c=0;return(a=+a)&&(0>a&&(a*=-1),b&&(a=l.round(a,Vc(a,b))),c=1+Math.floor(1E-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,3*Math.floor((c-1)/3)))),Ci[8+c/3]};var te=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Kg=l.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},
X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return(a=l.round(a,Vc(a,b))).toFixed(Math.max(0,Math.min(20,Vc(a*(1+1E-15),b))))}}),w=l.time={},ba=Date;xa.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},
getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Aa.setUTCDate.apply(this._,arguments)},setDay:function(){Aa.setUTCDay.apply(this._,arguments)},setFullYear:function(){Aa.setUTCFullYear.apply(this._,
arguments)},setHours:function(){Aa.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Aa.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Aa.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Aa.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Aa.setUTCSeconds.apply(this._,arguments)},setTime:function(){Aa.setTime.apply(this._,arguments)}};var Aa=Date.prototype;w.year=Na(function(a){return a=w.day(a),a.setMonth(0,1),a},function(a,b){a.setFullYear(a.getFullYear()+
b)},function(a){return a.getFullYear()});w.years=w.year.range;w.years.utc=w.year.utc.range;w.day=Na(function(a){var b=new ba(2E3,0);return b.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1});w.days=w.day.range;w.days.utc=w.day.utc.range;w.dayOfYear=function(a){var b=w.year(a);return Math.floor((a-b-6E4*(a.getTimezoneOffset()-b.getTimezoneOffset()))/864E5)};"sunday monday tuesday wednesday thursday friday saturday".split(" ").forEach(function(a,
b){b=7-b;var c=w[a]=Na(function(a){return(a=w.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+7*Math.floor(b))},function(a){var c=w.year(a).getDay();return Math.floor((w.dayOfYear(a)+(c+b)%7)/7)-(c!==b)});w[a+"s"]=c.range;w[a+"s"].utc=c.utc.range;w[a+"OfYear"]=function(a){var c=w.year(a).getDay();return Math.floor((w.dayOfYear(a)+(c+b)%7)/7)}});w.week=w.sunday;w.weeks=w.sunday.range;w.weeks.utc=w.sunday.utc.range;w.weekOfYear=w.sundayOfYear;var ue={"-":"",_:" ",
0:"0"},W=/^\s*\d+/,xe=/^%/;l.locale=function(a){return{numberFormat:Jg(a),timeFormat:Mg(a)}};var jg=l.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),shortDays:"Sun Mon Tue Wed Thu Fri Sat".split(" "),months:"January February March April May June July August September October November December".split(" "),shortMonths:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")});
l.format=jg.numberFormat;l.geo={};Wc.prototype={s:0,t:0,add:function(a){ye(a,this.t,mc);ye(mc.s,this.s,this);this.s?this.t+=mc.t:this.s=mc.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var mc=new Wc;l.geo.stream=function(a,b){a&&kg.hasOwnProperty(a.type)?kg[a.type](a,b):Kb(a,b)};var kg={Feature:function(a,b){Kb(a.geometry,b)},FeatureCollection:function(a,b){a=a.features;for(var c=-1,d=a.length;++c<d;)Kb(a[c].geometry,b)}},ze={Sphere:function(a,b){b.sphere()},Point:function(a,
b){a=a.coordinates;b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)a=c[d],b.point(a[0],a[1],a[2])},LineString:function(a,b){Xc(a.coordinates,b,0)},MultiLineString:function(a,b){a=a.coordinates;for(var c=-1,d=a.length;++c<d;)Xc(a[c],b,0)},Polygon:function(a,b){Ae(a.coordinates,b)},MultiPolygon:function(a,b){a=a.coordinates;for(var c=-1,d=a.length;++c<d;)Ae(a[c],b)},GeometryCollection:function(a,b){a=a.geometries;for(var c=-1,d=a.length;++c<d;)Kb(a[c],
b)}};l.geo.area=function(a){return nc=0,l.geo.stream(a,ga),nc};var nc,Oa=new Wc,ga={sphere:function(){nc+=4*M},point:X,lineStart:X,lineEnd:X,polygonStart:function(){Oa.reset();ga.lineStart=ah},polygonEnd:function(){var a=2*Oa;nc+=0>a?4*M+a:a;ga.lineStart=ga.lineEnd=ga.point=X}};l.geo.bounds=function(){function a(a,b){y.push(C=[r=a,t=a]);m>b&&(m=b);b>E&&(E=b)}function b(b,c){var d=Pa([b*K,c*K]);if(p){var e=Ya(p,d),e=Ya([e[1],-e[0],0],e);Nb(e);var e=Ob(e),g=b-A,f=0<g?1:-1,k=e[0]*U*f,g=180<G(g);g^(k>
f*A&&f*b>k)?(c=e[1]*U,c>E&&(E=c)):(k=(k+360)%360-180,g^(k>f*A&&f*b>k))?(c=-e[1]*U,m>c&&(m=c)):(m>c&&(m=c),c>E&&(E=c));g?A>b?h(r,b)>h(r,t)&&(t=b):h(b,t)>h(r,t)&&(r=b):t>=r?(r>b&&(r=b),b>t&&(t=b)):b>A?h(r,b)>h(r,t)&&(t=b):h(b,t)>h(r,t)&&(r=b)}else a(b,c);p=d;A=b}function c(){N.point=b}function d(){C[0]=r;C[1]=t;N.point=a;p=null}function e(a,c){if(p){var d=a-A;x+=180<G(d)?d+(0<d?360:-360):d}else L=a,F=c;ga.point(a,c);b(a,c)}function g(){ga.lineStart()}function f(){e(L,F);ga.lineEnd();G(x)>B&&(r=-(t=
180));C[0]=r;C[1]=t;p=null}function h(a,b){return 0>(b-=a)?b+360:b}function n(a,b){return a[0]-b[0]}function q(a,b){return b[0]<=b[1]?b[0]<=a&&a<=b[1]:a<b[0]||b[1]<a}var r,m,t,E,A,L,F,p,x,y,C,N={point:a,lineStart:c,lineEnd:d,polygonStart:function(){N.point=e;N.lineStart=g;N.lineEnd=f;x=0;ga.polygonStart()},polygonEnd:function(){ga.polygonEnd();N.point=a;N.lineStart=c;N.lineEnd=d;0>Oa?(r=-(t=180),m=-(E=90)):x>B?E=90:-B>x&&(m=-90);C[0]=r;C[1]=t}};return function(a){E=t=-(r=m=1/0);y=[];l.geo.stream(a,
N);if(a=y.length){y.sort(n);for(var b,c=1,d=y[0],e=[d];a>c;++c)b=y[c],q(b[0],d)||q(b[1],d)?(h(d[0],b[1])>h(d[0],d[1])&&(d[1]=b[1]),h(b[0],d[1])>h(d[0],d[1])&&(d[0]=b[0])):e.push(d=b);var g,f=-(1/0);a=e.length-1;c=0;for(d=e[a];a>=c;d=b,++c)b=e[c],(g=h(d[1],b[0]))>f&&(f=g,r=b[0],t=d[1])}return y=C=null,r===1/0||m===1/0?[[NaN,NaN],[NaN,NaN]]:[[r,m],[t,E]]}}();l.geo.centroid=function(a){jb=Qb=Qa=Ra=ya=Ea=Fa=sa=Za=$a=Ga=0;l.geo.stream(a,ma);a=Za;var b=$a,c=Ga,d=a*a+b*b+c*c;return Vb>d&&(a=Ea,b=Fa,c=sa,
B>Qb&&(a=Qa,b=Ra,c=ya),d=a*a+b*b+c*c,Vb>d)?[NaN,NaN]:[Math.atan2(b,a)*U,Da(c/Math.sqrt(d))*U]};var jb,Qb,Qa,Ra,ya,Ea,Fa,sa,Za,$a,Ga,ma={sphere:X,point:Zc,lineStart:Be,lineEnd:Ce,polygonStart:function(){ma.lineStart=bh},polygonEnd:function(){ma.lineStart=Be}},Te=Ge(kb,function(a){var b,c=NaN,d=NaN,e=NaN;return{lineStart:function(){a.lineStart();b=1},point:function(g,f){var h=0<g?M:-M,k=G(g-c);if(G(k-M)<B)a.point(c,d=0<(d+f)/2?V:-V),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),a.point(g,d),b=
0;else if(e!==h&&k>=M){G(c-e)<B&&(c-=e*B);G(g-h)<B&&(g-=h*B);var k=c,q=d,l=g,m,t,E=Math.sin(k-l);d=G(E)>B?Math.atan((Math.sin(q)*(t=Math.cos(f))*Math.sin(l)-Math.sin(f)*(m=Math.cos(q))*Math.sin(k))/(m*t*E)):(q+f)/2;a.point(e,d);a.lineEnd();a.lineStart();a.point(h,d);b=0}a.point(c=g,d=f);e=h},lineEnd:function(){a.lineEnd();c=d=NaN},clean:function(){return 2-b}}},function(a,b,c,d){null==a?(c*=V,d.point(-M,c),d.point(0,c),d.point(M,c),d.point(M,0),d.point(M,-c),d.point(0,-c),d.point(-M,-c),d.point(-M,
0),d.point(-M,c)):G(a[0]-b[0])>B?(a=a[0]<b[0]?M:-M,c=c*a/2,d.point(-a,c),d.point(0,c),d.point(a,c)):d.point(b[0],b[1])},[-M,-M/2]),Sb=1E9;l.geo.clipExtent=function(){var a,b,c,d,e,g,f={stream:function(a){return e&&(e.valid=!1),e=g(a),e.valid=!0,e},extent:function(h){return arguments.length?(g=Ke(a=+h[0][0],b=+h[0][1],c=+h[1][0],d=+h[1][1]),e&&(e.valid=!1,e=null),f):[[a,b],[c,d]]}};return f.extent([[0,0],[960,500]])};(l.geo.conicEqualArea=function(){return ad(Le)}).raw=Le;l.geo.albers=function(){return l.geo.conicEqualArea().rotate([96,
0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};l.geo.albersUsa=function(){function a(a){var g=a[0];a=a[1];return b=null,c(g,a),b||(d(g,a),b)||e(g,a),b}var b,c,d,e,g=l.geo.albers(),f=l.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),h=l.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),n={point:function(a,c){b=[a,c]}};return a.invert=function(a){var b=g.scale(),c=g.translate(),d=(a[0]-c[0])/b,b=(a[1]-c[1])/b;return(.12<=b&&.234>b&&-.425<=
d&&-.214>d?f:.166<=b&&.234>b&&-.214<=d&&-.115>d?h:g).invert(a)},a.stream=function(a){var b=g.stream(a),c=f.stream(a),d=h.stream(a);return{point:function(a,e){b.point(a,e);c.point(a,e);d.point(a,e)},sphere:function(){b.sphere();c.sphere();d.sphere()},lineStart:function(){b.lineStart();c.lineStart();d.lineStart()},lineEnd:function(){b.lineEnd();c.lineEnd();d.lineEnd()},polygonStart:function(){b.polygonStart();c.polygonStart();d.polygonStart()},polygonEnd:function(){b.polygonEnd();c.polygonEnd();d.polygonEnd()}}},
a.precision=function(b){return arguments.length?(g.precision(b),f.precision(b),h.precision(b),a):g.precision()},a.scale=function(b){return arguments.length?(g.scale(b),f.scale(.35*b),h.scale(b),a.translate(g.translate())):g.scale()},a.translate=function(b){if(!arguments.length)return g.translate();var k=g.scale(),q=+b[0],l=+b[1];return c=g.translate(b).clipExtent([[q-.455*k,l-.238*k],[q+.455*k,l+.238*k]]).stream(n).point,d=f.translate([q-.307*k,l+.201*k]).clipExtent([[q-.425*k+B,l+.12*k+B],[q-.214*
k-B,l+.234*k-B]]).stream(n).point,e=h.translate([q-.205*k,l+.212*k]).clipExtent([[q-.214*k+B,l+.166*k+B],[q-.115*k-B,l+.234*k-B]]).stream(n).point,a},a.scale(1070)};var Nd,cd,oc,pc,qc,rc,Ha={point:X,lineStart:X,lineEnd:X,polygonStart:function(){cd=0;Ha.lineStart=fh},polygonEnd:function(){Ha.lineStart=Ha.lineEnd=Ha.point=X;Nd+=G(cd/2)}},Di={point:function(a,b){oc>a&&(oc=a);a>qc&&(qc=a);pc>b&&(pc=b);b>rc&&(rc=b)},lineStart:X,lineEnd:X,polygonStart:X,polygonEnd:X},na={point:Sa,lineStart:Ne,lineEnd:Oe,
polygonStart:function(){na.lineStart=hh},polygonEnd:function(){na.point=Sa;na.lineStart=Ne;na.lineEnd=Oe}};l.geo.path=function(){function a(a){return a&&("function"==typeof f&&e.pointRadius(+f.apply(this,arguments)),g&&g.valid||(g=d(e)),l.geo.stream(a,g)),e.result()}var b,c,d,e,g,f=4.5;return a.area=function(a){return Nd=0,l.geo.stream(a,d(Ha)),Nd},a.centroid=function(a){return Qa=Ra=ya=Ea=Fa=sa=Za=$a=Ga=0,l.geo.stream(a,d(na)),Ga?[Za/Ga,$a/Ga]:sa?[Ea/sa,Fa/sa]:ya?[Qa/ya,Ra/ya]:[NaN,NaN]},a.bounds=
function(a){return qc=rc=-(oc=pc=1/0),l.geo.stream(a,d(Di)),[[oc,pc],[qc,rc]]},a.projection=function(c){return arguments.length?(d=(b=c)?c.stream||jh(c):Z,g=null,a):b},a.context=function(b){return arguments.length?(e=null==(c=b)?new gh:new ih(b),"function"!=typeof f&&e.pointRadius(f),g=null,a):c},a.pointRadius=function(b){return arguments.length?(f="function"==typeof b?b:(e.pointRadius(+b),+b),a):f},a.projection(l.geo.albersUsa()).context(null)};l.geo.transform=function(a){return{stream:function(b){b=
new Se(b);for(var c in a)b[c]=a[c];return b}}};Se.prototype={point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};l.geo.projection=Ia;l.geo.projectionMutator=bd;(l.geo.equirectangular=function(){return Ia(lb)}).raw=lb.invert=lb;l.geo.rotation=function(a){function b(b){return b=a(b[0]*
K,b[1]*K),b[0]*=U,b[1]*=U,b}return a=dd(a[0]%360*K,a[1]*K,2<a.length?a[2]*K:0),b.invert=function(b){return b=a.invert(b[0]*K,b[1]*K),b[0]*=U,b[1]*=U,b},b};Ue.invert=lb;l.geo.circle=function(){function a(){var a="function"==typeof d?d.apply(this,arguments):d,b=dd(-a[0]*K,-a[1]*K,0).invert,e=[];return c(null,null,1,{point:function(a,c){e.push(a=b(a,c));a[0]*=U;a[1]*=U}}),{type:"Polygon",coordinates:[e]}}var b,c,d=[0,0],e=6;return a.origin=function(b){return arguments.length?(d=b,a):d},a.angle=function(d){return arguments.length?
(c=$c((b=+d)*K,e*K),a):b},a.precision=function(d){return arguments.length?(c=$c(b*K,(e=+d)*K),a):e},a.angle(90)};l.geo.distance=function(a,b){var c,d=(b[0]-a[0])*K,e=a[1]*K,g=b[1]*K;b=Math.cos(d);a=Math.sin(e);var e=Math.cos(e),f=Math.sin(g),g=Math.cos(g);return Math.atan2(Math.sqrt((c=g*Math.sin(d))*c+(c=e*f-a*g*b)*c),a*f+e*g*b)};l.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:b()}}function b(){return l.range(Math.ceil(g/F)*F,e,F).map(t).concat(l.range(Math.ceil(q/
p)*p,n,p).map(E)).concat(l.range(Math.ceil(d/A)*A,c,A).filter(function(a){return G(a%F)>B}).map(m)).concat(l.range(Math.ceil(h/L)*L,f,L).filter(function(a){return G(a%p)>B}).map(u))}var c,d,e,g,f,h,n,q,m,u,t,E,A=10,L=A,F=90,p=360,x=2.5;return a.lines=function(){return b().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[t(g).concat(E(n).slice(1),t(e).reverse().slice(1),E(q).reverse().slice(1))]}},a.extent=function(b){return arguments.length?
a.majorExtent(b).minorExtent(b):a.minorExtent()},a.majorExtent=function(b){return arguments.length?(g=+b[0][0],e=+b[1][0],q=+b[0][1],n=+b[1][1],g>e&&(b=g,g=e,e=b),q>n&&(b=q,q=n,n=b),a.precision(x)):[[g,q],[e,n]]},a.minorExtent=function(b){return arguments.length?(d=+b[0][0],c=+b[1][0],h=+b[0][1],f=+b[1][1],d>c&&(b=d,d=c,c=b),h>f&&(b=h,h=f,f=b),a.precision(x)):[[d,h],[c,f]]},a.step=function(b){return arguments.length?a.majorStep(b).minorStep(b):a.minorStep()},a.majorStep=function(b){return arguments.length?
(F=+b[0],p=+b[1],a):[F,p]},a.minorStep=function(b){return arguments.length?(A=+b[0],L=+b[1],a):[A,L]},a.precision=function(b){return arguments.length?(x=+b,m=Ze(h,f,90),u=$e(d,c,x),t=Ze(q,n,90),E=$e(g,e,x),a):x},a.majorExtent([[-180,-90+B],[180,90-B]]).minorExtent([[-180,-80-B],[180,80+B]])};l.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[b||d.apply(this,arguments),c||e.apply(this,arguments)]}}var b,c,d=ed,e=fd;return a.distance=function(){return l.geo.distance(b||d.apply(this,
arguments),c||e.apply(this,arguments))},a.source=function(c){return arguments.length?(d=c,b="function"==typeof c?null:c,a):d},a.target=function(b){return arguments.length?(e=b,c="function"==typeof b?null:b,a):e},a.precision=function(){return arguments.length?a:0},a};l.geo.interpolate=function(a,b){return kh(a[0]*K,a[1]*K,b[0]*K,b[1]*K)};l.geo.length=function(a){return Od=0,l.geo.stream(a,hb),Od};var Od,hb={sphere:X,point:X,lineStart:function(){function a(a,g){var e=Math.sin(g*=K);g=Math.cos(g);var f=
G((a*=K)-b),n=Math.cos(f);Od+=Math.atan2(Math.sqrt((f=g*Math.sin(f))*f+(f=d*e-c*g*n)*f),c*e+d*g*n);b=a;c=e;d=g}var b,c,d;hb.point=function(e,g){b=e*K;c=Math.sin(g*=K);d=Math.cos(g);hb.point=a};hb.lineEnd=function(){hb.point=hb.lineEnd=X}},lineEnd:X,polygonStart:X,polygonEnd:X},lg=mb(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(l.geo.azimuthalEqualArea=function(){return Ia(lg)}).raw=lg;var mg=mb(function(a){return(a=Math.acos(a))&&a/Math.sin(a)},Z);(l.geo.azimuthalEquidistant=
function(){return Ia(mg)}).raw=mg;(l.geo.conicConformal=function(){return ad(af)}).raw=af;(l.geo.conicEquidistant=function(){return ad(bf)}).raw=bf;var ng=mb(function(a){return 1/a},Math.atan);(l.geo.gnomonic=function(){return Ia(ng)}).raw=ng;Tb.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-V]};(l.geo.mercator=function(){return cf(Tb)}).raw=Tb;var og=mb(function(){return 1},Math.asin);(l.geo.orthographic=function(){return Ia(og)}).raw=og;var pg=mb(function(a){return 1/(1+a)},function(a){return 2*
Math.atan(a)});(l.geo.stereographic=function(){return Ia(pg)}).raw=pg;gd.invert=function(a,b){return[-b,2*Math.atan(Math.exp(a))-V]};(l.geo.transverseMercator=function(){var a=cf(gd),b=a.center,c=a.rotate;return a.center=function(a){return a?b([-a[1],a[0]]):(a=b(),[a[1],-a[0]])},a.rotate=function(a){return a?c([a[0],a[1],2<a.length?a[2]+90:90]):(a=c(),[a[0],a[1],a[2]-90])},c([0,0,90])}).raw=gd;l.geom={};l.geom.hull=function(a){function b(a){if(3>a.length)return[];var b,e=R(c),f=R(d),n=a.length,l=
[],m=[];for(b=0;n>b;b++)l.push([+e.call(this,a[b],b),+f.call(this,a[b],b),b]);l.sort(lh);for(b=0;n>b;b++)m.push([l[b][0],-l[b][1]]);var e=df(l),m=df(m),f=m[0]===e[0],n=m[m.length-1]===e[e.length-1],u=[];for(b=e.length-1;0<=b;--b)u.push(a[l[e[b]][2]]);for(b=+f;b<m.length-n;++b)u.push(a[l[m[b]][2]]);return u}var c=ab,d=nb;return arguments.length?b(a):(b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b)};l.geom.polygon=function(a){return xb(a,sc),
a};var sc=l.geom.polygon.prototype=[];sc.area=function(){for(var a,b=-1,c=this.length,d=this[c-1],e=0;++b<c;)a=d,d=this[b],e+=a[1]*d[0]-a[0]*d[1];return.5*e};sc.centroid=function(a){var b,c,d=-1,e=this.length,g=0,f=0,h=this[e-1];for(arguments.length||(a=-1/(6*this.area()));++d<e;)b=h,h=this[d],c=b[0]*h[1]-h[0]*b[1],g+=(b[0]+h[0])*c,f+=(b[1]+h[1])*c;return[g*a,f*a]};sc.clip=function(a){for(var b,c,d,e,g,f,h=ef(a),n=-1,l=this.length-ef(this),m=this[l-1];++n<l;){b=a.slice();a.length=0;e=this[n];g=b[(d=
b.length-h)-1];for(c=-1;++c<d;)f=b[c],hd(f,m,e)?(hd(g,m,e)||a.push(id(g,f,m,e)),a.push(f)):hd(g,m,e)&&a.push(id(g,f,m,e)),g=f;h&&a.push(a[0]);m=e}return a};var eb,Ta,cb,kd,ob,gf=[],lf=[];jf.prototype.prepare=function(){for(var a,b=this.edges,c=b.length;c--;)a=b[c].edge,a.b&&a.a||b.splice(c,1);return b.sort(kf),b.length};Xb.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};ld.prototype={insert:function(a,
b){var c,d;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;c=a}else this._?(a=nf(this._),b.P=null,b.N=a,a.P=a.L=b,c=a):(b.P=b.N=null,this._=b,c=null);b.L=b.R=null;b.U=c;b.C=!0;for(a=b;c&&c.C;)b=c.U,c===b.L?(d=b.R,d&&d.C?(c.C=d.C=!1,b.C=!0,a=b):(a===c.R&&(qb(this,c),a=c,c=a.U),c.C=!1,b.C=!0,rb(this,b))):(d=b.L,d&&d.C?(c.C=d.C=!1,b.C=!0,a=b):(a===c.L&&(rb(this,c),a=c,c=a.U),c.C=!1,b.C=!0,qb(this,b))),c=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P);a.P&&
(a.P.N=a.N);a.N=a.P=null;var b,c,d,e=a.U,g=a.L,f=a.R;if(c=g?f?nf(f):g:f,e?e.L===a?e.L=c:e.R=c:this._=c,g&&f?(d=c.C,c.C=a.C,c.L=g,g.U=c,c!==f?(e=c.U,c.U=a.U,a=c.R,e.L=a,c.R=f,f.U=c):(c.U=e,e=c,a=c.R)):(d=a.C,a=c),a&&(a.U=e),!d){if(a&&a.C)return void(a.C=!1);do{if(a===this._)break;if(a===e.L){if(b=e.R,b.C&&(b.C=!1,e.C=!0,qb(this,e),b=e.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,rb(this,b),b=e.R);b.C=e.C;e.C=b.R.C=!1;qb(this,e);a=this._;break}}else if(b=e.L,b.C&&(b.C=!1,e.C=!0,rb(this,e),
b=e.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,qb(this,b),b=e.L);b.C=e.C;e.C=b.L.C=!1;rb(this,e);a=this._;break}b.C=!0;a=e;e=e.U}while(!a.C);a&&(a.C=!1)}}};l.geom.voronoi=function(a){function b(a){var b=Array(a.length),d=h[0][0],e=h[0][1],g=h[1][0],f=h[1][1];return md(c(a),h).cells.forEach(function(c,h){var k=c.edges;c=c.site;(b[h]=k.length?k.map(function(a){a=a.start();return[a.x,a.y]}):c.x>=d&&c.x<=g&&c.y>=e&&c.y<=f?[[d,f],[g,f],[g,e],[d,e]]:[]).point=a[h]}),b}function c(a){return a.map(function(a,
b){return{x:Math.round(g(a,b)/B)*B,y:Math.round(f(a,b)/B)*B,i:b}})}var d=ab,e=nb,g=d,f=e,h=tc;return a?b(a):(b.links=function(a){return md(c(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return md(c(a)).cells.forEach(function(c,d){for(var e=c.site,g=c.edges.sort(kf),f=-1,h=g.length,k=g[h-1].edge,k=k.l===e?k.r:k.l;++f<h;)c=k,k=g[f].edge,k=k.l===e?k.r:k.l,d<c.i&&d<k.i&&0>(e.x-k.x)*(c.y-e.y)-(e.x-c.x)*(k.y-e.y)&&
b.push([a[d],a[c.i],a[k.i]])}),b},b.x=function(a){return arguments.length?(g=R(d=a),b):d},b.y=function(a){return arguments.length?(f=R(e=a),b):e},b.clipExtent=function(a){return arguments.length?(h=null==a?tc:a,b):h===tc?null:h},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):h===tc?null:h&&h[1]},b)};var tc=[[-1E6,-1E6],[1E6,1E6]];l.geom.delaunay=function(a){return l.geom.voronoi().triangles(a)};l.geom.quadtree=function(a,b,c,d,e){function g(a){function g(a,b,c,d,e,g,f,h){if(!isNaN(c)&&
!isNaN(d))if(a.leaf){var n=a.x,l=a.y;if(null!=n){if(!(.01>G(n-c)+G(l-d))){var q=a.point;a.x=a.y=a.point=null;k(a,q,n,l,e,g,f,h)}k(a,b,c,d,e,g,f,h)}else a.x=c,a.y=d,a.point=b}else k(a,b,c,d,e,g,f,h)}function k(a,b,c,d,e,f,h,k){var n=.5*(e+h),l=.5*(f+k),q=c>=n,m=d>=l,r=m<<1|q;a.leaf=!1;a=a.nodes[r]||(a.nodes[r]=of());q?e=n:h=n;m?f=l:k=l;g(a,b,c,d,e,f,h,k)}var l,q,m,p,F,I,x,y,C,N=R(h),H=R(n);if(null!=b)I=b,x=c,y=d,C=e;else if(y=C=-(I=x=1/0),q=[],m=[],F=a.length,f)for(p=0;F>p;++p)l=a[p],l.x<I&&(I=l.x),
l.y<x&&(x=l.y),l.x>y&&(y=l.x),l.y>C&&(C=l.y),q.push(l.x),m.push(l.y);else for(p=0;F>p;++p){var T=+N(l=a[p],p);l=+H(l,p);I>T&&(I=T);x>l&&(x=l);T>y&&(y=T);l>C&&(C=l);q.push(T);m.push(l)}T=y-I;l=C-x;T>l?C=x+T:y=I+l;var v=of();if(v.add=function(a){g(v,a,+N(a,++p),+H(a,p),I,x,y,C)},v.visit=function(a){sb(a,v,I,x,y,C)},v.find=function(a){return th(v,a[0],a[1],I,x,y,C)},p=-1,null==b){for(;++p<F;)g(v,a[p],q[p],m[p],I,x,y,C);--p}else a.forEach(v.add);return q=m=a=l=null,v}var f,h=ab,n=nb;return(f=arguments.length)?
(h=rh,n=sh,3===f&&(e=c,d=b,c=b=0),g(a)):(g.x=function(a){return arguments.length?(h=a,g):h},g.y=function(a){return arguments.length?(n=a,g):n},g.extent=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=+a[0][0],c=+a[0][1],d=+a[1][0],e=+a[1][1]),g):null==b?null:[[b,c],[d,e]]},g.size=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=c=0,d=+a[0],e=+a[1]),g):null==b?null:[d-b,e-c]},g)};l.interpolateRgb=nd;l.interpolateObject=pf;l.interpolateNumber=za;l.interpolateString=qf;var od=
/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pd=new RegExp(od.source,"g");l.interpolate=Ua;l.interpolators=[function(a,b){var c=typeof b;return("string"===c?Ab.has(b.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(b)?nd:qf:b instanceof Ma?nd:Array.isArray(b)?Yb:"object"===c&&isNaN(b)?pf:za)(a,b)}];l.interpolateArray=Yb;var qg=function(){return Z},Ei=l.map({linear:qg,poly:function(a){return function(b){return Math.pow(b,a)}},quad:function(){return vh},cubic:function(){return wh},sin:function(){return yh},
exp:function(){return zh},circle:function(){return Ah},elastic:function(a,b){var c;return 2>arguments.length&&(b=.45),arguments.length?c=b/ha*Math.asin(1/a):(a=1,c=b/4),function(d){return 1+a*Math.pow(2,-10*d)*Math.sin((d-c)*ha/b)}},back:function(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}},bounce:function(){return Bh}}),Fi=l.map({"in":Z,out:rf,"in-out":sf,"out-in":function(a){return sf(rf(a))}});l.ease=function(a){var b=a.indexOf("-"),c=0<=b?a.slice(0,b):a,b=0<=b?a.slice(b+1):"in";
return c=Ei.get(c)||qg,b=Fi.get(b)||Z,uh(b(c.apply(null,fg.call(arguments,1))))};l.interpolateHcl=function(a,b){a=l.hcl(a);b=l.hcl(b);var c=a.h,d=a.c,e=a.l,g=b.h-c,f=b.c-d,h=b.l-e;return isNaN(f)&&(f=0,d=isNaN(d)?b.c:d),isNaN(g)?(g=0,c=isNaN(c)?b.h:c):180<g?g-=360:-180>g&&(g+=360),function(a){return Nc(c+g*a,d+f*a,e+h*a)+""}};l.interpolateHsl=function(a,b){a=l.hsl(a);b=l.hsl(b);var c=a.h,d=a.s,e=a.l,g=b.h-c,f=b.s-d,h=b.l-e;return isNaN(f)&&(f=0,d=isNaN(d)?b.s:d),isNaN(g)?(g=0,c=isNaN(c)?b.h:c):180<
g?g-=360:-180>g&&(g+=360),function(a){return Mc(c+g*a,d+f*a,e+h*a)+""}};l.interpolateLab=function(a,b){a=l.lab(a);b=l.lab(b);var c=a.l,d=a.a,e=a.b,g=b.l-c,f=b.a-d,h=b.b-e;return function(a){return me(c+g*a,d+f*a,e+h*a)+""}};l.interpolateRound=tf;l.transform=function(a){var b=ca.createElementNS(l.ns.prefix.svg,"g");return(l.transform=function(a){if(null!=a){b.setAttribute("transform",a);var c=b.transform.baseVal.consolidate()}return new uf(c?c.matrix:Gi)})(a)};uf.prototype.toString=function(){return"translate("+
this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Gi={a:1,b:0,c:0,d:1,e:0,f:0};l.interpolateTransform=wf;l.layout={};l.layout.bundle=function(){return function(a){for(var b=[],c=-1,d=a.length;++c<d;)b.push(Ih(a[c]));return b}};l.layout.chord=function(){function a(){var a,k,q,r,p,F={},I=[],x=l.range(g),y=[];c=[];d=[];a=0;for(r=-1;++r<g;){k=0;for(p=-1;++p<g;)k+=e[r][p];I.push(k);y.push(l.range(g));a+=k}f&&x.sort(function(a,b){return f(I[a],I[b])});h&&y.forEach(function(a,
b){a.sort(function(a,c){return h(e[b][a],e[b][c])})});a=(ha-m*g)/a;k=0;for(r=-1;++r<g;){q=k;for(p=-1;++p<g;){var C=x[r],N=y[C][p],H=e[C][N],v=k,w=k+=H*a;F[C+"-"+N]={index:C,subindex:N,startAngle:v,endAngle:w,value:H}}d[C]={index:C,startAngle:q,endAngle:k,value:I[C]};k+=m}for(r=-1;++r<g;)for(p=r-1;++p<g;)a=F[r+"-"+p],k=F[p+"-"+r],(a.value||k.value)&&c.push(a.value<k.value?{source:k,target:a}:{source:a,target:k});n&&b()}function b(){c.sort(function(a,b){return n((a.source.value+a.target.value)/2,(b.source.value+
b.target.value)/2)})}var c,d,e,g,f,h,n,q={},m=0;return q.matrix=function(a){return arguments.length?(g=(e=a)&&e.length,c=d=null,q):e},q.padding=function(a){return arguments.length?(m=a,c=d=null,q):m},q.sortGroups=function(a){return arguments.length?(f=a,c=d=null,q):f},q.sortSubgroups=function(a){return arguments.length?(h=a,c=null,q):h},q.sortChords=function(a){return arguments.length?(n=a,c&&b(),q):n},q.chords=function(){return c||a(),c},q.groups=function(){return d||a(),d},q};l.layout.force=function(){function a(a){return function(b,
c,d,e){if(b.point!==a){d=b.cx-a.x;var g=b.cy-a.y;c=e-c;e=d*d+g*g;if(e>c*c/I)return L>e&&(c=b.charge/e,a.px-=d*c,a.py-=g*c),!0;b.point&&e&&L>e&&(c=b.pointCharge/e,a.px-=d*c,a.py-=g*c)}return!b.charge}}function b(a){a.px=l.event.x;a.py=l.event.y;n.resume()}var c,d,e,g,f,h,n={},q=l.dispatch("start","tick","end"),m=[1,1],u=.9,t=Hi,p=Ii,A=-30,L=Ji,F=.1,I=.64,x=[],y=[];return n.tick=function(){if(.005>(e*=.99))return c=null,q.end({type:"end",alpha:e=0}),!0;var b,d,k,n,r,t,p,E,I=x.length,L=y.length;for(d=
0;L>d;++d)k=y[d],b=k.source,n=k.target,p=n.x-b.x,E=n.y-b.y,(r=p*p+E*E)&&(r=e*f[d]*((r=Math.sqrt(r))-g[d])/r,p*=r,E*=r,n.x-=p*(t=b.weight+n.weight?b.weight/(b.weight+n.weight):.5),n.y-=E*t,b.x+=p*(t=1-t),b.y+=E*t);if((t=e*F)&&(p=m[0]/2,E=m[1]/2,d=-1,t))for(;++d<I;)k=x[d],k.x+=(p-k.x)*t,k.y+=(E-k.y)*t;if(A)for(yf(b=l.geom.quadtree(x),e,h),d=-1;++d<I;)(k=x[d]).fixed||b.visit(a(k));for(d=-1;++d<I;)k=x[d],k.fixed?(k.x=k.px,k.y=k.py):(k.x-=(k.px-(k.px=k.x))*u,k.y-=(k.py-(k.py=k.y))*u);q.tick({type:"tick",
alpha:e})},n.nodes=function(a){return arguments.length?(x=a,n):x},n.links=function(a){return arguments.length?(y=a,n):y},n.size=function(a){return arguments.length?(m=a,n):m},n.linkDistance=function(a){return arguments.length?(t="function"==typeof a?a:+a,n):t},n.distance=n.linkDistance,n.linkStrength=function(a){return arguments.length?(p="function"==typeof a?a:+a,n):p},n.friction=function(a){return arguments.length?(u=+a,n):u},n.charge=function(a){return arguments.length?(A="function"==typeof a?
a:+a,n):A},n.chargeDistance=function(a){return arguments.length?(L=a*a,n):Math.sqrt(L)},n.gravity=function(a){return arguments.length?(F=+a,n):F},n.theta=function(a){return arguments.length?(I=a*a,n):Math.sqrt(I)},n.alpha=function(a){return arguments.length?(a=+a,e?0<a?e=a:(c.c=null,c.t=NaN,c=null,q.end({type:"end",alpha:e=0})):0<a&&(q.start({type:"start",alpha:e=a}),c=Cb(n.tick)),n):e},n.start=function(){function a(a,d){if(!c){c=Array(e);for(h=0;e>h;++h)c[h]=[];for(h=0;k>h;++h){var g=y[h];c[g.source.index].push(g.target);
c[g.target.index].push(g.source)}}for(var f=c[b],h=-1,n=f.length;++h<n;)if(!isNaN(g=f[h][a]))return g;return Math.random()*d}var b,c,d,e=x.length,k=y.length,l=m[0],q=m[1];for(b=0;e>b;++b)(d=x[b]).index=b,d.weight=0;for(b=0;k>b;++b)d=y[b],"number"==typeof d.source&&(d.source=x[d.source]),"number"==typeof d.target&&(d.target=x[d.target]),++d.source.weight,++d.target.weight;for(b=0;e>b;++b)d=x[b],isNaN(d.x)&&(d.x=a("x",l)),isNaN(d.y)&&(d.y=a("y",q)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);if(g=
[],"function"==typeof t)for(b=0;k>b;++b)g[b]=+t.call(this,y[b],b);else for(b=0;k>b;++b)g[b]=t;if(f=[],"function"==typeof p)for(b=0;k>b;++b)f[b]=+p.call(this,y[b],b);else for(b=0;k>b;++b)f[b]=p;if(h=[],"function"==typeof A)for(b=0;e>b;++b)h[b]=+A.call(this,x[b],b);else for(b=0;e>b;++b)h[b]=A;return n.resume()},n.resume=function(){return n.alpha(.1)},n.stop=function(){return n.alpha(0)},n.drag=function(){return d||(d=l.behavior.drag().origin(Z).on("dragstart.force",Jh).on("drag.force",b).on("dragend.force",
Kh)),arguments.length?void this.on("mouseover.force",Lh).on("mouseout.force",Mh).call(d):d},l.rebind(n,q,"on")};var Hi=20,Ii=1,Ji=1/0;l.layout.hierarchy=function(){function a(e){var g,f=[e],h=[];for(e.depth=0;null!=(g=f.pop());)if(h.push(g),(l=c.call(a,g,g.depth))&&(n=l.length)){for(var n,l,m;0<=--n;)f.push(m=l[n]),m.parent=g,m.depth=g.depth+1;d&&(g.value=0);g.children=l}else d&&(g.value=+d.call(a,g,g.depth)||0),delete g.children;return ta(e,function(a){var c,e;b&&(c=a.children)&&c.sort(b);d&&(e=
a.parent)&&(e.value+=a.value)}),h}var b=Qh,c=Oh,d=Ph;return a.sort=function(c){return arguments.length?(b=c,a):b},a.children=function(b){return arguments.length?(c=b,a):c},a.value=function(b){return arguments.length?(d=b,a):d},a.revalue=function(b){return d&&(ub(b,function(a){a.children&&(a.value=0)}),ta(b,function(b){var c;b.children||(b.value=+d.call(a,b,b.depth)||0);(c=b.parent)&&(c.value+=b.value)})),b},a};l.layout.partition=function(){function a(b,c,d,e){var g=b.children;if(b.x=c,b.y=b.depth*
e,b.dx=d,b.dy=e,g&&(f=g.length)){var f,h,k=-1;for(d=b.value?d/b.value:0;++k<f;)a(h=g[k],c,b=h.value*d,e),c+=b}}function b(a){a=a.children;var c=0;if(a&&(d=a.length))for(var d,e=-1;++e<d;)c=Math.max(c,b(a[e]));return 1+c}function c(c,f){c=d.call(this,c,f);return a(c[0],0,e[0],e[1]/b(c[0])),c}var d=l.layout.hierarchy(),e=[1,1];return c.size=function(a){return arguments.length?(e=a,c):e},tb(c,d)};l.layout.pie=function(){function a(f){var h,k=f.length,m=f.map(function(c,d){return+b.call(a,c,d)}),r=+("function"==
typeof d?d.apply(this,arguments):d),u=("function"==typeof e?e.apply(this,arguments):e)-r,t=Math.min(Math.abs(u)/k,+("function"==typeof g?g.apply(this,arguments):g)),p=t*(0>u?-1:1),A=l.sum(m),L=A?(u-k*p)/A:0,k=l.range(k),F=[];return null!=c&&k.sort(c===rg?function(a,b){return m[b]-m[a]}:function(a,b){return c(f[a],f[b])}),k.forEach(function(a){F[a]={data:f[a],value:h=m[a],startAngle:r,endAngle:r+=h*L+p,padAngle:t}}),F}var b=Number,c=rg,d=0,e=ha,g=0;return a.value=function(c){return arguments.length?
(b=c,a):b},a.sort=function(b){return arguments.length?(c=b,a):c},a.startAngle=function(b){return arguments.length?(d=b,a):d},a.endAngle=function(b){return arguments.length?(e=b,a):e},a.padAngle=function(b){return arguments.length?(g=b,a):g},a};var rg={};l.layout.stack=function(){function a(h,k){if(!(t=h.length))return h;for(var n=h.map(function(c,d){return b.call(a,c,d)}),m=n.map(function(b){return b.map(function(b,c){return[g.call(a,b,c),f.call(a,b,c)]})}),u=c.call(a,m,k),n=l.permute(n,u),m=l.permute(m,
u),t,p,A=d.call(a,m,k),L=n[0].length,u=0;L>u;++u)for(e.call(a,n[0][u],p=A[u],m[0][u][1]),k=1;t>k;++k)e.call(a,n[k][u],p+=m[k-1][u][1],m[k][u][1]);return h}var b=Z,c=qd,d=rd,e=Th,g=Rh,f=Sh;return a.values=function(c){return arguments.length?(b=c,a):b},a.order=function(b){return arguments.length?(c="function"==typeof b?b:Ki.get(b)||qd,a):c},a.offset=function(b){return arguments.length?(d="function"==typeof b?b:Li.get(b)||rd,a):d},a.x=function(b){return arguments.length?(g=b,a):g},a.y=function(b){return arguments.length?
(f=b,a):f},a.out=function(b){return arguments.length?(e=b,a):e},a};var Ki=l.map({"inside-out":function(a){var b,c=a.length,d=a.map(Uh),e=a.map(Vh),g=l.range(c).sort(function(a,b){return d[a]-d[b]}),f=0,h=0,n=[],m=[];for(a=0;c>a;++a)b=g[a],h>f?(f+=e[b],n.push(b)):(h+=e[b],m.push(b));return m.reverse().concat(n)},reverse:function(a){return l.range(a.length).reverse()},"default":qd}),Li=l.map({silhouette:function(a){var b,c,d,e=a.length,g=a[0].length,f=[],h=0,n=[];for(c=0;g>c;++c){for(d=b=0;e>b;b++)d+=
a[b][c][1];d>h&&(h=d);f.push(d)}for(c=0;g>c;++c)n[c]=(h-f[c])/2;return n},wiggle:function(a){var b,c,d,e,g,f,h,n,l,m=a.length,u=a[0],t=u.length,p=[];p[0]=n=l=0;for(c=1;t>c;++c){for(e=b=0;m>b;++b)e+=a[b][c][1];g=b=0;for(h=u[c][0]-u[c-1][0];m>b;++b){d=0;for(f=(a[b][c][1]-a[b][c-1][1])/(2*h);b>d;++d)f+=(a[d][c][1]-a[d][c-1][1])/h;g+=f*a[b][c][1]}p[c]=n-=e?g/e*h:0;l>n&&(l=n)}for(c=0;t>c;++c)p[c]-=l;return p},expand:function(a){var b,c,d,e=a.length,g=a[0].length,f=1/e,h=[];for(c=0;g>c;++c){for(d=b=0;e>
b;b++)d+=a[b][c][1];if(d)for(b=0;e>b;b++)a[b][c][1]/=d;else for(b=0;e>b;b++)a[b][c][1]=f}for(c=0;g>c;++c)h[c]=0;return h},zero:rd});l.layout.histogram=function(){function a(a,f){var g,k,m=[],r=a.map(c,this),u=d.call(this,r,f),t=e.call(this,u,r,f);f=-1;for(var p=r.length,A=t.length-1,L=b?1:1/p;++f<A;)g=m[f]=[],g.dx=t[f+1]-(g.x=t[f]),g.y=0;if(0<A)for(f=-1;++f<p;)k=r[f],k>=u[0]&&k<=u[1]&&(g=m[l.bisect(t,k,1,A)-1],g.y+=L,g.push(a[f]));return m}var b=!0,c=Number,d=Yh,e=Xh;return a.value=function(b){return arguments.length?
(c=b,a):c},a.range=function(b){return arguments.length?(d=R(b),a):d},a.bins=function(b){return arguments.length?(e="number"==typeof b?function(a){return zf(a,b)}:R(b),a):e},a.frequency=function(c){return arguments.length?(b=!!c,a):b},a};l.layout.pack=function(){function a(a,f){a=c.call(this,a,f);f=a[0];var g=e[0],k=e[1],l=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(f.x=f.y=0,ta(f,function(a){a.r=+l(a.value)}),ta(f,Cf),d){var m=d*(b?1:Math.max(2*f.r/g,2*f.r/k))/2;ta(f,function(a){a.r+=
m});ta(f,Cf);ta(f,function(a){a.r-=m})}return Ef(f,g/2,k/2,b?1:1/Math.max(2*f.r/g,2*f.r/k)),a}var b,c=l.layout.hierarchy().sort(Zh),d=0,e=[1,1];return a.size=function(b){return arguments.length?(e=b,a):e},a.radius=function(c){return arguments.length?(b=null==c||"function"==typeof c?c:+c,a):b},a.padding=function(b){return arguments.length?(d=+b,a):d},tb(a,c)};l.layout.tree=function(){function a(a,k){a=g.call(this,a,k);k=a[0];var l=b(k);if(ta(l,c),l.parent.m=-l.z,ub(l,d),n)ub(k,e);else{var m=k,q=k,
r=k;ub(k,function(a){a.x<m.x&&(m=a);a.x>q.x&&(q=a);a.depth>r.depth&&(r=a)});var p=f(m,q)/2-m.x,F=h[0]/(q.x+f(q,m)/2+p),I=h[1]/(r.depth||1);ub(k,function(a){a.x=(a.x+p)*F;a.y=a.depth*I})}return a}function b(a){for(var b={A:null,children:[a]},c=[b];null!=(a=c.pop());)for(var d,e=a.children,g=0,f=e.length;f>g;++g)c.push((e[g]=d={_:e[g],parent:a,children:(d=e[g].children)&&d.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:g}).a=d);return b.children[0]}function c(a){var b=a.children,c=a.parent.children,
d=a.i?c[a.i-1]:null;if(b.length){for(var e,g=0,h=0,k=a.children,l=k.length;0<=--l;)e=k[l],e.z+=g,e.m+=g,g+=e.s+(h+=e.c);b=(b[0].z+b[b.length-1].z)/2;d?(a.z=d.z+f(a._,d._),a.m=a.z-b):a.z=b}else d&&(a.z=d.z+f(a._,d._));b=a.parent;c=a.parent.A||c[0];if(d){for(var g=e=a,h=d,k=e.parent.children[0],l=e.m,n=g.m,m=h.m,q=k.m;h=ud(h),e=td(e),h&&e;){k=td(k);g=ud(g);g.a=a;d=h.z+m-e.z-l+f(h._,e._);if(0<d){var p=h.a.parent===a.parent?h.a:c,v=a,w=d,B=w/(v.i-p.i);v.c-=B;v.s+=w;p.c+=B;v.z+=w;v.m+=w;l+=d;n+=d}m+=h.m;
l+=e.m;q+=k.m;n+=g.m}h&&!ud(g)&&(g.t=h,g.m+=m-n);e&&!td(k)&&(k.t=e,k.m+=l-q,c=a)}b.A=c}function d(a){a._.x=a.z+a.parent.m;a.m+=a.parent.m}function e(a){a.x*=h[0];a.y=a.depth*h[1]}var g=l.layout.hierarchy().sort(null).value(null),f=Ff,h=[1,1],n=null;return a.separation=function(b){return arguments.length?(f=b,a):f},a.size=function(b){return arguments.length?(n=null==(h=b)?e:null,a):n?null:h},a.nodeSize=function(b){return arguments.length?(n=null==(h=b)?null:e,a):n?h:null},tb(a,g)};l.layout.cluster=
function(){function a(a,f){var g;a=b.call(this,a,f);var k=a[0],l=0;ta(k,function(a){var b=a.children;b&&b.length?(a.x=ci(b),a.y=bi(b)):(a.x=g?l+=c(a,g):0,a.y=0,g=a)});f=Gf(k);var m=Hf(k),p=f.x-c(f,m)/2,t=m.x+c(m,f)/2;return ta(k,e?function(a){a.x=(a.x-k.x)*d[0];a.y=(k.y-a.y)*d[1]}:function(a){a.x=(a.x-p)/(t-p)*d[0];a.y=(1-(k.y?a.y/k.y:1))*d[1]}),a}var b=l.layout.hierarchy().sort(null).value(null),c=Ff,d=[1,1],e=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?
(e=null==(d=b),a):e?null:d},a.nodeSize=function(b){return arguments.length?(e=null!=(d=b),a):e?d:null},tb(a,b)};l.layout.treemap=function(){function a(a,b){for(var c,d,e=-1,g=a.length;++e<g;)d=(c=a[e]).value*(0>b?0:b),c.area=isNaN(d)||0>=d?0:d}function b(c){var e=c.children;if(e&&e.length){var g,f=r(c),h=[],k=e.slice(),l=1/0,n="slice"===t?f.dx:"dice"===t?f.dy:"slice-dice"===t?1&c.depth?f.dy:f.dx:Math.min(f.dx,f.dy);a(k,f.dx*f.dy/c.value);for(h.area=0;0<(c=k.length);){h.push(c=k[c-1]);h.area+=c.area;
var m;if(!(m="squarify"!==t)){g=void 0;c=n;var q=h.area;m=0;for(var p=1/0,u=-1,A=h.length;++u<A;)(g=h[u].area)&&(p>g&&(p=g),g>m&&(m=g));m=(g=(q*=q,c*=c,q?Math.max(c*m*v/q,q/(c*p*v)):1/0))<=l}m?(k.pop(),l=g):(h.area-=h.pop().area,d(h,n,f,!1),n=Math.min(f.dx,f.dy),h.length=h.area=0,l=1/0)}h.length&&(d(h,n,f,!0),h.length=h.area=0);e.forEach(b)}}function c(b){var e=b.children;if(e&&e.length){var g=r(b),f=e.slice(),h=[];a(f,g.dx*g.dy/b.value);for(h.area=0;b=f.pop();)h.push(b),h.area+=b.area,null!=b.z&&
(d(h,b.z?g.dx:g.dy,g,!f.length),h.length=h.area=0);e.forEach(c)}}function d(a,b,c,d){var e,g=-1,f=a.length,k=c.x,l=c.y,n=b?h(a.area/b):0;if(b==c.dx){for((d||n>c.dy)&&(n=c.dy);++g<f;)e=a[g],e.x=k,e.y=l,e.dy=n,k+=e.dx=Math.min(c.x+c.dx-k,n?h(e.area/n):0);e.z=!0;e.dx+=c.x+c.dx-k;c.y+=n;c.dy-=n}else{for((d||n>c.dx)&&(n=c.dx);++g<f;)e=a[g],e.x=k,e.y=l,e.dx=n,l+=e.dy=Math.min(c.y+c.dy-l,n?h(e.area/n):0);e.z=!1;e.dy+=c.y+c.dy-l;c.x+=n;c.dx-=n}}function e(d){d=g||f(d);var e=d[0];return e.x=e.y=0,e.value?
(e.dx=n[0],e.dy=n[1]):e.dx=e.dy=0,g&&f.revalue(e),a([e],e.dx*e.dy/e.value),(g?c:b)(e),p&&(g=d),d}var g,f=l.layout.hierarchy(),h=Math.round,n=[1,1],m=null,r=vd,p=!1,t="squarify",v=.5*(1+Math.sqrt(5));return e.size=function(a){return arguments.length?(n=a,e):n},e.padding=function(a){function b(b){var c=a.call(e,b,b.depth);return null==c?vd(b):If(b,"number"==typeof c?[c,c,c,c]:c)}function c(b){return If(b,a)}if(!arguments.length)return m;var d;return r=null==(m=a)?vd:"function"==(d=typeof a)?b:"number"===
d?(a=[a,a,a,a],c):c,e},e.round=function(a){return arguments.length?(h=a?Math.round:Number,e):h!=Number},e.sticky=function(a){return arguments.length?(p=a,g=null,e):p},e.ratio=function(a){return arguments.length?(v=a,e):v},e.mode=function(a){return arguments.length?(t=a+"",e):t},tb(e,f)};l.random={normal:function(a,b){var c=arguments.length;return 2>c&&(b=1),1>c&&(a=0),function(){var c,e;do c=2*Math.random()-1,e=2*Math.random()-1,e=c*c+e*e;while(!e||1<e);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}},
logNormal:function(){var a=l.random.normal.apply(l,arguments);return function(){return Math.exp(a())}},bates:function(a){var b=l.random.irwinHall(a);return function(){return b()/a}},irwinHall:function(a){return function(){for(var b=0,c=0;a>c;c++)b+=Math.random();return b}}};l.scale={};var ei={floor:Z,ceil:Z};l.scale.linear=function(){return Kf([0,1],[0,1],Ua,!1)};var hi={s:1,g:1,p:1,r:1,e:1};l.scale.log=function(){return Mf(l.scale.linear().domain([0,1]),10,!0,[1,10])};var Nf=l.format(".0e"),ii={floor:function(a){return-Math.ceil(-a)},
ceil:function(a){return-Math.floor(-a)}};l.scale.pow=function(){return Of(l.scale.linear(),1,[0,1])};l.scale.sqrt=function(){return l.scale.pow().exponent(.5)};l.scale.ordinal=function(){return Pf([],{t:"range",a:[[]]})};l.scale.category10=function(){return l.scale.ordinal().range(Mi)};l.scale.category20=function(){return l.scale.ordinal().range(Ni)};l.scale.category20b=function(){return l.scale.ordinal().range(Oi)};l.scale.category20c=function(){return l.scale.ordinal().range(Pi)};var Mi=[2062260,
16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(zb),Ni=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(zb),Oi=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(zb),Pi=[3244733,7057110,10406625,13032431,15095053,
16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(zb);l.scale.quantile=function(){return Qf([],[])};l.scale.quantize=function(){return Rf(0,1,[0,1])};l.scale.threshold=function(){return Sf([.5],[0,1])};l.scale.identity=function(){return Tf([0,1])};l.svg={};l.svg.arc=function(){function a(){var a=Math.max(0,+c.apply(this,arguments)),k=Math.max(0,+d.apply(this,arguments)),n=f.apply(this,arguments)-V,m=h.apply(this,
arguments)-V,p=Math.abs(m-n),v=n>m?0:1;if(a>k&&(L=k,k=a,a=L),p>=Bi)return b(k,v)+(a?b(a,1-v):"")+"Z";var L,F,I,x,y,C,w,H,z,K,G=0;w=0;var P=[];((x=(+l.apply(this,arguments)||0)/2)&&(I=g===uc?Math.sqrt(a*a+k*k):+g.apply(this,arguments),v||(w*=-1),k&&(w=Da(I/k*Math.sin(x))),a&&(G=Da(I/a*Math.sin(x)))),k)?(I=k*Math.cos(n+w),x=k*Math.sin(n+w),y=k*Math.cos(m-w),C=k*Math.sin(m-w),F=Math.abs(m-n-2*w)<=M?0:1,w&&cc(I,x,y,C)===v^F&&(y=(n+m)/2,I=k*Math.cos(y),x=k*Math.sin(y),y=C=null)):I=x=0;if(a){w=a*Math.cos(m-
G);H=a*Math.sin(m-G);z=a*Math.cos(n+G);K=a*Math.sin(n+G);var D=Math.abs(n-m+2*G)<=M?0:1;G&&cc(w,H,z,K)===1-v^D&&(z=(n+m)/2,w=a*Math.cos(z),H=a*Math.sin(z),z=K=null)}else w=H=0;p>B&&.001<(L=Math.min(Math.abs(k-a)/2,+e.apply(this,arguments)))?(F=k>a^v?0:1,D=n=L,M>p&&(p=null==z?[w,H]:null==y?[I,x]:id([I,x],[z,K],[y,C],[w,H]),D=I-p[0],n=x-p[1],m=y-p[0],G=C-p[1],n=1/Math.sin(Math.acos((D*m+n*G)/(Math.sqrt(D*D+n*n)*Math.sqrt(m*m+G*G)))/2),p=Math.sqrt(p[0]*p[0]+p[1]*p[1]),D=Math.min(L,(a-p)/(n-1)),n=Math.min(L,
(k-p)/(n+1))),null!=y?(p=dc(null==z?[w,H]:[z,K],[I,x],k,n,v),m=dc([y,C],[w,H],k,n,v),L===n?P.push("M",p[0],"A",n,",",n," 0 0,",F," ",p[1],"A",k,",",k," 0 ",1-v^cc(p[1][0],p[1][1],m[1][0],m[1][1]),",",v," ",m[1],"A",n,",",n," 0 0,",F," ",m[0]):P.push("M",p[0],"A",n,",",n," 0 1,",F," ",m[0])):P.push("M",I,",",x),null!=z?(k=dc([I,x],[z,K],a,-D,v),y=dc([w,H],null==y?[I,x]:[y,C],a,-D,v),L===D?P.push("L",y[0],"A",D,",",D," 0 0,",F," ",y[1],"A",a,",",a," 0 ",v^cc(y[1][0],y[1][1],k[1][0],k[1][1]),",",1-v,
" ",k[1],"A",D,",",D," 0 0,",F," ",k[0]):P.push("L",y[0],"A",D,",",D," 0 0,",F," ",k[0])):P.push("L",w,",",H)):(P.push("M",I,",",x),null!=y&&P.push("A",k,",",k," 0 ",F,",",v," ",y,",",C),P.push("L",w,",",H),null!=z&&P.push("A",a,",",a," 0 ",D,",",1-v," ",z,",",K));return P.push("Z"),P.join("")}function b(a,b){return"M0,"+a+"A"+a+","+a+" 0 1,"+b+" 0,"+-a+"A"+a+","+a+" 0 1,"+b+" 0,"+a}var c=ki,d=li,e=ji,g=uc,f=Uf,h=Vf,l=mi;return a.innerRadius=function(b){return arguments.length?(c=R(b),a):c},a.outerRadius=
function(b){return arguments.length?(d=R(b),a):d},a.cornerRadius=function(b){return arguments.length?(e=R(b),a):e},a.padRadius=function(b){return arguments.length?(g=b==uc?uc:R(b),a):g},a.startAngle=function(b){return arguments.length?(f=R(b),a):f},a.endAngle=function(b){return arguments.length?(h=R(b),a):h},a.padAngle=function(b){return arguments.length?(l=R(b),a):l},a.centroid=function(){var a=(+c.apply(this,arguments)+ +d.apply(this,arguments))/2,b=(+f.apply(this,arguments)+ +h.apply(this,arguments))/
2-V;return[Math.cos(b)*a,Math.sin(b)*a]},a};var uc="auto";l.svg.line=function(){return Wf(Z)};var yd=l.map({linear:oa,"linear-closed":Xf,step:function(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d[0]+(d=a[b])[0])/2,"V",d[1]);return 1<c&&e.push("H",d[0]),e.join("")},"step-before":zd,"step-after":Ad,basis:Yf,"basis-open":function(a){if(4>a.length)return oa(a);for(var b,c=[],d=-1,e=a.length,g=[0],f=[0];3>++d;)b=a[d],g.push(b[0]),f.push(b[1]);c.push(ia(Ka,g)+","+ia(Ka,f));for(--d;++d<
e;)b=a[d],g.shift(),g.push(b[0]),f.shift(),f.push(b[1]),Cd(c,g,f);return c.join("")},"basis-closed":function(a){for(var b,c,d=-1,e=a.length,g=e+4,f=[],h=[];4>++d;)c=a[d%e],f.push(c[0]),h.push(c[1]);b=[ia(Ka,f),",",ia(Ka,h)];for(--d;++d<g;)c=a[d%e],f.shift(),f.push(c[0]),h.shift(),h.push(c[1]),Cd(b,f,h);return b.join("")},bundle:function(a,b){var c=a.length-1;if(c)for(var d,e,g=a[0][0],f=a[0][1],h=a[c][0]-g,n=a[c][1]-f,l=-1;++l<=c;)d=a[l],e=l/c,d[0]=b*d[0]+(1-b)*(g+e*h),d[1]=b*d[1]+(1-b)*(f+e*n);return Yf(a)},
cardinal:function(a,b){return 3>a.length?oa(a):a[0]+ec(a,Bd(a,b))},"cardinal-open":function(a,b){return 4>a.length?oa(a):a[1]+ec(a.slice(1,-1),Bd(a,b))},"cardinal-closed":function(a,b){return 3>a.length?Xf(a):a[0]+ec((a.push(a[0]),a),Bd([a[a.length-2]].concat(a,[a[1]]),b))},monotone:function(a){if(3>a.length)a=oa(a);else{var b=a[0],c,d,e,g,f=[],h;c=0;h=a.length-1;for(var n=[],l=a[1],m=n[0]=Dd(a[0],l);++c<h;)n[c]=(m+(m=Dd(l,l=a[c+1])))/2;h=(n[c]=m,n);n=-1;for(l=a.length-1;++n<l;)c=Dd(a[n],a[n+1]),
G(c)<B?h[n]=h[n+1]=0:(d=h[n]/c,e=h[n+1]/c,g=d*d+e*e,9<g&&(g=3*c/Math.sqrt(g),h[n]=g*d,h[n+1]=g*e));for(n=-1;++n<=l;)g=(a[Math.min(l,n+1)][0]-a[Math.max(0,n-1)][0])/(6*(1+h[n]*h[n])),f.push([g||0,h[n]*g||0]);a=b+ec(a,f)}return a}});yd.forEach(function(a,b){b.key=a;b.closed=/-closed$/.test(a)});var Zf=[0,2/3,1/3,0],$f=[0,1/3,2/3,0],Ka=[0,1/6,2/3,1/6];l.svg.line.radial=function(){var a=Wf(ag);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a};zd.reverse=Ad;Ad.reverse=zd;l.svg.area=function(){return bg(Z)};
l.svg.area.radial=function(){var a=bg(ag);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a};l.svg.chord=function(){function a(a,g){var f=b(this,d,a,g);a=b(this,e,a,g);return"M"+f.p0+c(f.r,f.p1,f.a1-f.a0)+(f.a0==a.a0&&f.a1==a.a1?"Q 0,0 "+f.p0:"Q 0,0 "+a.p0+c(a.r,a.p1,a.a1-a.a0)+("Q 0,0 "+f.p0))+"Z"}function b(a,b,c,d){var e=b.call(a,c,d);b=g.call(a,e,d);c=f.call(a,e,d)-V;a=
h.call(a,e,d)-V;return{r:b,a0:c,a1:a,p0:[b*Math.cos(c),b*Math.sin(c)],p1:[b*Math.cos(a),b*Math.sin(a)]}}function c(a,b,c){return"A"+a+","+a+" 0 "+ +(c>M)+",1 "+b}var d=ed,e=fd,g=ni,f=Uf,h=Vf;return a.radius=function(b){return arguments.length?(g=R(b),a):g},a.source=function(b){return arguments.length?(d=R(b),a):d},a.target=function(b){return arguments.length?(e=R(b),a):e},a.startAngle=function(b){return arguments.length?(f=R(b),a):f},a.endAngle=function(b){return arguments.length?(h=R(b),a):h},a};
l.svg.diagonal=function(){function a(a,f){var e=b.call(this,a,f);a=c.call(this,a,f);f=(e.y+a.y)/2;e=[e,{x:e.x,y:f},{x:a.x,y:f},a];return e=e.map(d),"M"+e[0]+"C"+e[1]+" "+e[2]+" "+e[3]}var b=ed,c=fd,d=cg;return a.source=function(c){return arguments.length?(b=R(c),a):b},a.target=function(b){return arguments.length?(c=R(b),a):c},a.projection=function(b){return arguments.length?(d=b,a):d},a};l.svg.diagonal.radial=function(){var a=l.svg.diagonal(),b=cg,c=a.projection;return a.projection=function(a){return arguments.length?
c(oi(b=a)):b},a};l.svg.symbol=function(){function a(a,e){return(sg.get(b.call(this,a,e))||dg)(c.call(this,a,e))}var b=qi,c=pi;return a.type=function(c){return arguments.length?(b=R(c),a):b},a.size=function(b){return arguments.length?(c=R(b),a):c},a};var sg=l.map({circle:dg,cross:function(a){a=Math.sqrt(a/5)/2;return"M"+-3*a+","+-a+"H"+-a+"V"+-3*a+"H"+a+"V"+-a+"H"+3*a+"V"+a+"H"+a+"V"+3*a+"H"+-a+"V"+a+"H"+-3*a+"Z"},diamond:function(a){a=Math.sqrt(a/(2*tg));var b=a*tg;return"M0,"+-a+"L"+b+",0 0,"+a+
" "+-b+",0Z"},square:function(a){a=Math.sqrt(a)/2;return"M"+-a+","+-a+"L"+a+","+-a+" "+a+","+a+" "+-a+","+a+"Z"},"triangle-down":function(a){a=Math.sqrt(a/vc);var b=a*vc/2;return"M0,"+b+"L"+a+","+-b+" "+-a+","+-b+"Z"},"triangle-up":function(a){a=Math.sqrt(a/vc);var b=a*vc/2;return"M0,"+-b+"L"+a+","+b+" "+-a+","+b+"Z"}});l.svg.symbolTypes=sg.keys();var vc=Math.sqrt(3),tg=Math.tan(30*K);Q.transition=function(a){for(var b,c=Wa||++ug,d=Fd(a),e=[],f=wc||{time:Date.now(),ease:xh,delay:0,duration:250},k=
-1,h=this.length;++k<h;){e.push(a=[]);for(var l=this[k],m=-1,p=l.length;++m<p;)(b=l[m])&&fc(b,m,d,c,f),a.push(b)}return vb(e,d,c)};Q.interrupt=function(a){return this.each(null==a?ic:eg(Fd(a)))};var Wa,wc,ic=eg(Fd()),Y=[],ug=0;Y.call=Q.call;Y.empty=Q.empty;Y.node=Q.node;Y.size=Q.size;l.transition=function(a,b){return a&&a.transition?Wa?a.transition(b):a:l.selection().transition(a)};l.transition.prototype=Y;Y.select=function(a){var b,c,d,e=this.id,f=this.namespace,k=[];a=Dc(a);for(var h=-1,l=this.length;++h<
l;){k.push(b=[]);for(var m=this[h],p=-1,u=m.length;++p<u;)(d=m[p])&&(c=a.call(d,d.__data__,p,h))?("__data__"in d&&(c.__data__=d.__data__),fc(c,p,f,e,d[f][e]),b.push(c)):b.push(null)}return vb(k,f,e)};Y.selectAll=function(a){var b,c,d,e,f=this.id,k=this.namespace,h=[];a=Vd(a);for(var l=-1,m=this.length;++l<m;)for(var p=this[l],u=-1,t=p.length;++u<t;)if(b=p[u]){e=b[k][f];c=a.call(b,b.__data__,u,l);h.push(b=[]);for(var v=-1,w=c.length;++v<w;)(d=c[v])&&fc(d,v,k,f,e),b.push(d)}return vb(h,k,f)};Y.filter=
function(a){var b,c,d,e=[];"function"!=typeof a&&(a=be(a));for(var f=0,k=this.length;k>f;f++){e.push(b=[]);c=this[f];for(var h=0,l=c.length;l>h;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return vb(e,this.namespace,this.id)};Y.tween=function(a,b){var c=this.id,d=this.namespace;return 2>arguments.length?this.node()[d][c].tween.get(a):va(this,null==b?function(b){b[d][c].tween.remove(a)}:function(e){e[d][c].tween.set(a,b)})};Y.attr=function(a,b){function c(){this.removeAttribute(h)}function d(){this.removeAttributeNS(h.space,
h.local)}function e(a){return null==a?c:(a+="",function(){var b,c=this.getAttribute(h);return c!==a&&(b=k(c,a),function(a){this.setAttribute(h,b(a))})})}function f(a){return null==a?d:(a+="",function(){var b,c=this.getAttributeNS(h.space,h.local);return c!==a&&(b=k(c,a),function(a){this.setAttributeNS(h.space,h.local,b(a))})})}if(2>arguments.length){for(b in a)this.attr(b,a[b]);return this}var k="transform"==a?wf:Ua,h=l.ns.qualify(a);return Ed(this,"attr."+a,b,h.local?f:e)};Y.attrTween=function(a,
b){function c(a,c){var d=b.call(this,a,c,this.getAttribute(e));return d&&function(a){this.setAttribute(e,d(a))}}function d(a,c){var d=b.call(this,a,c,this.getAttributeNS(e.space,e.local));return d&&function(a){this.setAttributeNS(e.space,e.local,d(a))}}var e=l.ns.qualify(a);return this.tween("attr."+a,e.local?d:c)};Y.style=function(a,b,c){function d(){this.style.removeProperty(a)}var e=arguments.length;if(3>e){if("string"!=typeof a){2>e&&(b="");for(c in a)this.style(c,a[c],b);return this}c=""}return Ed(this,
"style."+a,b,function(b){return null==b?d:(b+="",function(){var d,e=D(this).getComputedStyle(this,null).getPropertyValue(a);return e!==b&&(d=Ua(e,b),function(b){this.style.setProperty(a,d(b),c)})})})};Y.styleTween=function(a,b,c){return 3>arguments.length&&(c=""),this.tween("style."+a,function(d,e){var f=b.call(this,d,e,D(this).getComputedStyle(this,null).getPropertyValue(a));return f&&function(b){this.style.setProperty(a,f(b),c)}})};Y.text=function(a){return Ed(this,"text",a,ri)};Y.remove=function(){var a=
this.namespace;return this.each("end.transition",function(){var b;2>this[a].count&&(b=this.parentNode)&&b.removeChild(this)})};Y.ease=function(a){var b=this.id,c=this.namespace;return 1>arguments.length?this.node()[c][b].ease:("function"!=typeof a&&(a=l.ease.apply(l,arguments)),va(this,function(d){d[c][b].ease=a}))};Y.delay=function(a){var b=this.id,c=this.namespace;return 1>arguments.length?this.node()[c][b].delay:va(this,"function"==typeof a?function(d,e,f){d[c][b].delay=+a.call(d,d.__data__,e,
f)}:(a=+a,function(d){d[c][b].delay=a}))};Y.duration=function(a){var b=this.id,c=this.namespace;return 1>arguments.length?this.node()[c][b].duration:va(this,"function"==typeof a?function(d,e,f){d[c][b].duration=Math.max(1,a.call(d,d.__data__,e,f))}:(a=Math.max(1,a),function(d){d[c][b].duration=a}))};Y.each=function(a,b){var c=this.id,d=this.namespace;if(2>arguments.length){var e=wc,f=Wa;try{Wa=c,va(this,function(b,e,f){wc=b[d][c];a.call(b,b.__data__,e,f)})}finally{wc=e,Wa=f}}else va(this,function(e){e=
e[d][c];(e.event||(e.event=l.dispatch("start","end","interrupt"))).on(a,b)});return this};Y.transition=function(){for(var a,b,c,d,e=this.id,f=++ug,k=this.namespace,h=[],l=0,m=this.length;m>l;l++){h.push(a=[]);b=this[l];for(var p=0,u=b.length;u>p;p++)(c=b[p])&&(d=c[k][e],fc(c,p,k,f,{time:d.time,ease:d.ease,delay:d.delay+d.duration,duration:d.duration})),a.push(c)}return vb(h,k,f)};l.svg.axis=function(){function a(a){a.each(function(){var a,g=l.select(this),n=this.__chart__||c,p=this.__chart__=c.copy(),
q=null==m?p.ticks?p.ticks.apply(p,h):p.domain():m,v=null==b?p.tickFormat?p.tickFormat.apply(p,h):Z:b,F=g.selectAll(".tick").data(q,p),q=F.enter().insert("g",".domain").attr("class","tick").style("opacity",B),w=l.transition(F.exit()).style("opacity",B).remove(),x=l.transition(F.order()).style("opacity",1),y=Math.max(e,0)+k,C=Zb(p),g=g.selectAll(".domain").data([0]),g=(g.enter().append("path").attr("class","domain"),l.transition(g));q.append("line");q.append("text");var z,H,P,K,G=q.select("line"),D=
x.select("line"),v=F.select("text").text(v),F=q.select("text"),M=x.select("text"),J="top"===d||"left"===d?-1:1;if("bottom"===d||"top"===d?(a=si,z="x",P="y",H="x2",K="y2",v.attr("dy",0>J?"0em":".71em").style("text-anchor","middle"),g.attr("d","M"+C[0]+","+J*f+"V0H"+C[1]+"V"+J*f)):(a=ti,z="y",P="x",H="y2",K="x2",v.attr("dy",".32em").style("text-anchor",0>J?"end":"start"),g.attr("d","M"+J*f+","+C[0]+"H0V"+C[1]+"H"+J*f)),G.attr(K,J*e),F.attr(P,J*y),D.attr(H,0).attr(K,J*e),M.attr(z,0).attr(P,J*y),p.rangeBand)var aa=
p,Q=aa.rangeBand()/2,n=p=function(a){return aa(a)+Q};else n.rangeBand?n=p:w.call(a,p,n);q.call(a,n,p);x.call(a,p,p)})}var b,c=l.scale.linear(),d=vg,e=6,f=6,k=3,h=[10],m=null;return a.scale=function(b){return arguments.length?(c=b,a):c},a.orient=function(b){return arguments.length?(d=b in Qi?b+"":vg,a):d},a.ticks=function(){return arguments.length?(h=qa(arguments),a):h},a.tickValues=function(b){return arguments.length?(m=b,a):m},a.tickFormat=function(c){return arguments.length?(b=c,a):b},a.tickSize=
function(b){var c=arguments.length;return c?(e=+b,f=+arguments[c-1],a):e},a.innerTickSize=function(b){return arguments.length?(e=+b,a):e},a.outerTickSize=function(b){return arguments.length?(f=+b,a):f},a.tickPadding=function(b){return arguments.length?(k=+b,a):k},a.tickSubdivide=function(){return arguments.length&&a},a};var vg="bottom",Qi={top:1,right:1,bottom:1,left:1};l.svg.brush=function(){function a(f){f.each(function(){var f=l.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color",
"rgba(0,0,0,0)").on("mousedown.brush",e).on("touchstart.brush",e),g=f.selectAll(".background").data([0]);g.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");f.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var h=f.selectAll(".resize").data(w,Z);h.exit().remove();h.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Ri[a]}).append("rect").attr("x",
function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");h.style("display",a.empty()?"none":null);var k,f=l.transition(f),g=l.transition(g);m&&(k=Zb(m),g.attr("x",k[0]).attr("width",k[1]-k[0]),c(f));p&&(k=Zb(p),g.attr("y",k[0]).attr("height",k[1]-k[0]),d(f));b(f)})}function b(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+r[+/e$/.test(a)]+","+u[+/^s/.test(a)]+")"})}function c(a){a.select(".extent").attr("x",
r[0]);a.selectAll(".extent,.n\x3erect,.s\x3erect").attr("width",r[1]-r[0])}function d(a){a.select(".extent").attr("y",u[0]);a.selectAll(".extent,.e\x3erect,.w\x3erect").attr("height",u[1]-u[0])}function e(){function e(){var a=l.mouse(w),e=!1;y&&(a[0]+=y[0],a[1]+=y[1]);G||(l.event.altKey?(q||(q=[(r[0]+r[1])/2,(u[0]+u[1])/2]),J[0]=r[+(a[0]<q[0])],J[1]=u[+(a[1]<q[1])]):q=null);P&&g(a,m,0)&&(c(A),e=!0);K&&g(a,p,1)&&(d(A),e=!0);e&&(b(A),B({type:"brush",mode:G?"move":"resize"}))}function g(a,b,c){var d,
e,g=Zb(b);b=g[0];var g=g[1],h=J[c],l=c?u:r,m=l[1]-l[0];return G&&(b-=h,g-=m+h),d=(c?v:t)?Math.max(b,Math.min(g,a[c])):a[c],G?e=(d+=h)+m:(q&&(h=Math.max(b,Math.min(g,2*q[c]-d))),d>h?(e=d,d=h):e=h),l[0]!=d||l[1]!=e?(c?k=null:f=null,l[0]=d,l[1]=e,!0):void 0}function n(){e();A.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null);l.select("body").style("cursor",null);aa.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",
null).on("keydown.brush",null).on("keyup.brush",null);M();B({type:"brushend"})}var q,y,w=this,z=l.select(l.event.target),B=h.of(w,arguments),A=l.select(w),E=z.datum(),P=!/^(n|s)$/.test(E)&&m,K=!/^(e|w)$/.test(E)&&p,G=z.classed("extent"),M=yb(w),J=l.mouse(w),aa=l.select(D(w)).on("keydown.brush",function(){32==l.event.keyCode&&(G||(q=null,J[0]-=r[1],J[1]-=u[1],G=2),Ba())}).on("keyup.brush",function(){32==l.event.keyCode&&2==G&&(J[0]+=r[1],J[1]+=u[1],G=0,Ba())});if(l.event.changedTouches?aa.on("touchmove.brush",
e).on("touchend.brush",n):aa.on("mousemove.brush",e).on("mouseup.brush",n),A.interrupt().selectAll("*").interrupt(),G)J[0]=r[0]-J[0],J[1]=u[0]-J[1];else if(E){var Q=+/w$/.test(E),E=+/^n/.test(E);y=[r[1-Q]-J[0],u[1-E]-J[1]];J[0]=r[Q];J[1]=u[E]}else l.event.altKey&&(q=J.slice());A.style("pointer-events","none").selectAll(".resize").style("display",null);l.select("body").style("cursor",z.style("cursor"));B({type:"brushstart"});e()}var f,k,h=Cc(a,"brushstart","brush","brushend"),m=null,p=null,r=[0,0],
u=[0,0],t=!0,v=!0,w=Pd[0];return a.event=function(a){a.each(function(){var a=h.of(this,arguments),b={x:r,y:u,i:f,j:k},c=this.__chart__||b;this.__chart__=b;Wa?l.select(this).transition().each("start.brush",function(){f=c.i;k=c.j;r=c.x;u=c.y;a({type:"brushstart"})}).tween("brush:brush",function(){var c=Yb(r,b.x),d=Yb(u,b.y);return f=k=null,function(e){r=b.x=c(e);u=b.y=d(e);a({type:"brush",mode:"resize"})}}).each("end.brush",function(){f=b.i;k=b.j;a({type:"brush",mode:"resize"});a({type:"brushend"})}):
(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?(m=b,w=Pd[!m<<1|!p],a):m},a.y=function(b){return arguments.length?(p=b,w=Pd[!m<<1|!p],a):p},a.clamp=function(b){return arguments.length?(m&&p?(t=!!b[0],v=!!b[1]):m?t=!!b:p&&(v=!!b),a):m&&p?[t,v]:m?t:p?v:null},a.extent=function(b){var c,d,e,g,h;return arguments.length?(m&&(c=b[0],d=b[1],p&&(c=c[0],d=d[0]),f=[c,d],m.invert&&(c=m(c),d=m(d)),c>d&&(h=c,c=d,d=h),c==r[0]&&d==r[1]||(r=
[c,d])),p&&(e=b[0],g=b[1],m&&(e=e[1],g=g[1]),k=[e,g],p.invert&&(e=p(e),g=p(g)),e>g&&(h=e,e=g,g=h),e==u[0]&&g==u[1]||(u=[e,g])),a):(m&&(f?(c=f[0],d=f[1]):(c=r[0],d=r[1],m.invert&&(c=m.invert(c),d=m.invert(d)),c>d&&(h=c,c=d,d=h))),p&&(k?(e=k[0],g=k[1]):(e=u[0],g=u[1],p.invert&&(e=p.invert(e),g=p.invert(g)),e>g&&(h=e,e=g,g=h))),m&&p?[[c,e],[d,g]]:m?[c,d]:p&&[e,g])},a.clear=function(){return a.empty()||(r=[0,0],u=[0,0],f=k=null),a},a.empty=function(){return!!m&&r[0]==r[1]||!!p&&u[0]==u[1]},l.rebind(a,
h,"on")};var Ri={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Pd=["n e s w nw ne se sw".split(" "),["e","w"],["n","s"],[]],Qd=w.format=jg.timeFormat,wg=Qd.utc,xg=wg("%Y-%m-%dT%H:%M:%S.%LZ");Qd.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Gd:xg;Gd.parse=function(a){a=new Date(a);return isNaN(a)?null:a};Gd.toString=xg.toString;w.second=Na(function(a){return new ba(1E3*Math.floor(a/1E3))},function(a,
b){a.setTime(a.getTime()+1E3*Math.floor(b))},function(a){return a.getSeconds()});w.seconds=w.second.range;w.seconds.utc=w.second.utc.range;w.minute=Na(function(a){return new ba(6E4*Math.floor(a/6E4))},function(a,b){a.setTime(a.getTime()+6E4*Math.floor(b))},function(a){return a.getMinutes()});w.minutes=w.minute.range;w.minutes.utc=w.minute.utc.range;w.hour=Na(function(a){var b=a.getTimezoneOffset()/60;return new ba(36E5*(Math.floor(a/36E5-b)+b))},function(a,b){a.setTime(a.getTime()+36E5*Math.floor(b))},
function(a){return a.getHours()});w.hours=w.hour.range;w.hours.utc=w.hour.utc.range;w.month=Na(function(a){return a=w.day(a),a.setDate(1),a},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()});w.months=w.month.range;w.months.utc=w.month.utc.range;var gc=[1E3,5E3,15E3,3E4,6E4,3E5,9E5,18E5,36E5,108E5,216E5,432E5,864E5,1728E5,6048E5,2592E6,7776E6,31536E6],Rd=[[w.second,1],[w.second,5],[w.second,15],[w.second,30],[w.minute,1],[w.minute,5],[w.minute,15],[w.minute,30],[w.hour,1],
[w.hour,3],[w.hour,6],[w.hour,12],[w.day,1],[w.day,2],[w.week,1],[w.month,1],[w.month,3],[w.year,1]],Si=Qd.multi([[".%L",function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!=a.getDate()}],["%b %d",function(a){return 1!=a.getDate()}],["%B",function(a){return a.getMonth()}],["%Y",kb]]),ui={range:function(a,b,c){return l.range(Math.ceil(a/c)*
c,+b,c).map(Va)},floor:Z,ceil:Z};Rd.year=w.year;w.scale=function(){return Hd(l.scale.linear(),Rd,Si)};var yg=Rd.map(function(a){return[a[0].utc,a[1]]}),Ti=wg.multi([[".%L",function(a){return a.getUTCMilliseconds()}],[":%S",function(a){return a.getUTCSeconds()}],["%I:%M",function(a){return a.getUTCMinutes()}],["%I %p",function(a){return a.getUTCHours()}],["%a %d",function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],["%b %d",function(a){return 1!=a.getUTCDate()}],["%B",function(a){return a.getUTCMonth()}],
["%Y",kb]]);yg.year=w.year.utc;w.scale.utc=function(){return Hd(l.scale.linear(),yg,Ti)};l.text=Tc(function(a){return a.responseText});l.json=function(a,b){return Bb(a,"application/json",vi,b)};l.html=function(a,b){return Bb(a,"text/html",wi,b)};l.xml=Tc(function(a){return a.responseXML});"function"==typeof define&&define.amd?(this.d3=l,define(l)):"object"==typeof module&&module.exports?module.exports=l:this.d3=l})();
(function(D,S,O,ua){D.createWidgetClass("pricegraph.PriceGraph",{options:{originCode:"",destinationCode:"",departDate:"",toolTipDateFormat:"",dateFormat:"YYYY-MM-DD",submitForm:!1,minTripDuration:1,maxTripDuration:28,airportMultiSelectEnabled:!1,isExplore:!1,distinct:!0,fullPrice:!1,useUtilsFormat:!0,autoScroll:!1,formId:"",view:"area",radius:0,interpolate:"cardinal",question:"flights.fd.searchform",historicalPriceGraphEnabled:!1,messages:{search:"",title:"",zoomIn:"",priceFrom:"",returnText:"",tripDuration:"",
toolTipDepartOn:"",toolTipDateRange:"",toolTipPriceUnavailable:""},bars:{months:1,move:14,unit:"days"},area:{months:6,move:3,unit:"months",range:14}},events:{rtowOrigin:"flights.search.rtow.form.origin",rtowDestination:"flights.search.rtow.form.destination",rtowDateRange:"flights.search.rtow.form.dateRange",displayCat:"flights.search.rtow.form.displayCat"},state:{view:"area",months:6,move:3,unit:"months",created:!1,windowStart:null,windowEnd:null,graphStart:null,graphEnd:null,departDate:null,returnDate:null,
departDateObj:null,returnDateObj:null,tripDuration:4,min:Infinity,max:0,means:[],nav:[],barCount:0,barWidth:0,priceData:[],viewData:[],cabinType:"e",display:"roundtrip"},barState:{SELECTABLE:"selectable",GREYED:"greyed",SELECTED:"selected",PRESELECTED:"preselected"},priceType:{GOOD:0,AVERAGE:50,EXPENSIVE:90},tooltipMinWidth:209,tooltipSmallMinWidth:56,graphHeight:340,maxBarHeight:218,defaultBarHeight:50,zoomHeight:34,originCode:"",multiOriginAirports:[],destinationCode:"",multiDestinationAirports:[],
departDate:"",formId:"",needDataUpdate:!0,lastSearchCacheKey:null,container:null,init:function(){this.originCode=this.options.originCode;this.destinationCode=this.options.destinationCode;this.departDate=this.options.departDate;this.formId=this.options.formId;this.container=this.getChildElement("container");this.title=this.getChildElement("title");this.tooltipSpace=this.graphHeight-this.maxBarHeight;this.back=this.getChildElement("back");this.isBBScreen=this.isAllowedScreen();this.setQuestion();this.setDatesId();
this.createPriceGraphContainer();this.setViewState();this.setInitStateDepartDate();this.getFormId()&&this.initProvider()},addEventHandlers:function(){var f=this;if(this.getFormId())this.addSubscriptions();else if(this.subscribe("searchform.initialized",function(m){if(0<=Object.keys(m.questions).indexOf(f.options.question)){var p=m.serialize();f.formId=m.id();f.setOrigin(p.origin_code,p.originMultiAirports);f.setDestination(p.destination_code,p.destinationMultiAirports);m.activeFormController.startDate?
f.departDate=f.dateToStr(m.activeFormController.startDate()):m.activeFormController.departDate&&(f.departDate=f.dateToStr(m.activeFormController.departDate.getDate()));f.setQuestion();f.setDatesId();f.setInitStateDepartDate();f.initProvider();f.addSubscriptions()}}),this.options.isExplore){var m=D.question.ask("Explore.SearchForm.data");m&&(f.setOrigin(f.originCode||m.airport,[]),f.setDestination(f.destinationCode||m.destination,[]),f.departDate=""===m.exactDates.exactDepartDate?f.dateToStr(new Date):
f.dateToStr(m.exactDates.exactDepartDate),f.returnDate=f.dateToStr(m.exactDates.exactRetunDate),f.setQuestion(),f.setDatesId(),f.setInitStateDepartDate(),f.initProvider(),f.addSubscriptions(),f.visible=!0,f.toggleGraph(f.visible))}S(window).on("resize.priceGraph",D.Common.Utils.debounce(function(){f.isBBScreen=f.isAllowedScreen();f.visible=f.isAllSet();f.toggleGraphView(f.visible)},100));this.registerEvent("click",this.back,this.handleBackClick.bind(this))},addSubscriptions:function(){var f=this;
this.subscribe("flights.search.cabinType.set",{namespace:this.getFormId()},function(m){f.state.cabinType=m&&m.value?m.value:"e";f.visible=f.isAllSet();f.toggleGraph(f.state.created&&f.visible)});this.subscribe(this.events.displayCat,{id:this.getFormId()},function(m){f.state.display=m.displayCat;f.visible=f.isAllSet();f.toggleGraph(f.state.created&&f.visible)});this.options.airportMultiSelectEnabled?this.subscribe([this.events.rtowOrigin,this.events.rtowDestination],{id:this.getFormId()},function(){var m=
D.question.ask(f.question),p=m.destinationMultiAirports||[];(m.originMultiAirports||[]).length&&p.length||(f.visible=!1,f.toggleGraph(f.visible))}):(this.subscribe(this.events.rtowOrigin,{id:this.getFormId()},function(m){m&&m.originCode||(f.visible=!1,f.toggleGraph(f.visible))}),this.subscribe(this.events.rtowDestination,{id:this.getFormId()},function(m){m&&m.destinationCode||(f.visible=!1,f.toggleGraph(f.visible))}));this.subscribe("DateInput."+this.getDatesId()+".startDate.setDate",function(m){var p=
f.state.departDate;m=m&&m.date;!m||p&&p.isSame(m)||!f.isBarsView()||f.setAreaView()})},initProvider:function(){var f={onFetchSuccess:this.updateGraphVisibility.bind(this,!0),onFetchFail:this.updateGraphVisibility.bind(this,!1),formId:this.getFormId(),airportMultiSelectEnabled:this.options.airportMultiSelectEnabled,distinct:this.options.distinct};this.options.airportMultiSelectEnabled?(f.origin=this.multiOriginAirports,f.destination=this.multiDestinationAirports):this.originCode&&this.destinationCode&&
!this.options.isExplore&&S.extend(f,{origin:{originCode:this.originCode},destination:{destinationCode:this.destinationCode}});this.priceDataProvider=new D.common.widgets.datepicker.PredictionDataProvider(this.id("predictionProvider"),f);this.options.historicalPriceGraphEnabled&&(f=JSON.parse(JSON.stringify(f)),f.api=D.PredictedPriceSourceHistory.API,f.onFetchSuccess=this.updateHistory.bind(this,!0),f.onFetchFail=this.updateHistory.bind(this,!1),this.priceHistoryDataProvider=new D.common.widgets.datepicker.PredictionDataProvider(this.id("predictionProvider"),
f));this.options.isExplore&&(this.priceDataProvider.setOrigin({originCode:this.originCode}),this.priceDataProvider.setDestination({destinationCode:this.destinationCode}),this.options.historicalPriceGraphEnabled&&(this.priceHistoryDataProvider.setOrigin({originCode:this.originCode}),this.priceHistoryDataProvider.setDestination({destinationCode:this.destinationCode})))},updateHistory:function(f){var m=this;f&&this.priceHistoryDataProvider.getDataSet().then(this.processHistoryDataSet.bind(this)).fail(function(){m.state.priceHistoryData=
[];m.state.viewHistoryData=[]})},processHistoryDataSet:function(f){var m=this,p=f.dataSet;this.state.priceHistoryData=Object.keys(p).map(function(f){return m.createPriceData(p,f)});f=this.state.windowStart.diff(this.state.graphStart,"days");var v=this.state.windowEnd.diff(this.state.graphStart,"days")+1;f=this.state.priceHistoryData.slice(f,v);f.forEach(this.afterProcess.bind(this));this.state.viewHistoryData=f;this.renderView()},initPriceGraphData:function(){this.state.graphStart=ua().startOf("day");
this.state.windowStart=ua().startOf("day");this.state.windowEnd=this.setWindowEnd();this.state.graphEnd=this.state.graphStart.clone().add(300,"days");this.isDepartInView()||this.setStateDepartDate(this.state.windowStart.clone().add(14,"days"))},activatePriceGraph:function(){this.state.created?(this.updateGraphWidths(),this.createPriceGraph()):(this.setViewState(),this.state.created=!0,this.loader=D.template.renderElement("PriceGraphLoader"),this.priceGraphContainer.find(".wrapper").append(this.loader),
this.updateGraphWidths(),this.initPriceGraphData(),this.createPriceGraph(),this.logImpression("created"))},logImpression:function(f){D.Analytics.api.trackEvent({category:"price-graph",action:"impression",label:f})},changeWindow:function(f,m,p,v,z,P){var J=f.clone();v=v||this.state.move;J.add((v+(z?Math.ceil(this.state.tripDuration/2):0))*m,this.state.unit);if(-1===m?J.isBefore(p):J.isAfter(p))J=p.clone();if(!J.isSame(f)||z)f=this.state.months*m*-1,-1===m?(this.state.windowStart=J,this.state.windowEnd=
J.clone().add(f,"months").endOf("day")):(this.state.windowEnd=J,this.state.windowStart=J.clone().add(f,"months").startOf("day")),this.updateMonthScrollBtns(),P||D.Analytics.api.trackEvent({category:"price-graph",action:"monthScroll",label:-1===m?"scroll-left":"scroll-right"}),this.createOrUpdateView()},cleanView:function(){this.toggleMarker(!1);this.toggleToolTip(!1);this.toggleZoom(!1);this.toggleAreaHighlight(!1);this.graphArea.selectAll(".bar,.emptyBar,.area").remove();this.options.historicalPriceGraphEnabled&&
this.graphArea.selectAll(".bar,.emptyBar,.area, .area-history").remove();this.days.empty()},createPriceGraphContainer:function(){var f=this;this.priceGraphContainer=D.template.renderElement("PriceGraphStructure",{graphContainerId:this.id("price-graph-container")});this.priceGraphContainer.appendTo(this.container);this.daysHolder=this.container.find(".day-labels-wrapper");this.days=this.daysHolder.find(".day-labels");this.navWidth=this.priceGraphContainer.find(".scroll-left").width();this.monthScroll=
this.container.find(".month-slider");this.monthScroll.on("click",".scroll-left, .scroll-right",function(){f.handleMonthScroll(this)});this.updateGraphWidths();this.isBarsView()&&this.toggleDaysHolder(!0)},createPriceGraph:function(){this.graphSVG=O.select(this.priceGraphContainer.find(".wrapper")[0]).select("svg");null===this.graphSVG[0][0]&&(this.graphSVG=O.select(this.priceGraphContainer.find(".wrapper")[0]).append("svg").attr("class",this.getStlBlock("PriceGraph__SVG")).attr("width","100%").attr("height",
"100%"),this.graphView=this.graphSVG.append("g").attr("class","graph-view").on("mouseout",this.handleMouseOut.bind(this)).on("mouseover",this.handleMouseIn.bind(this)),this.defineHorizontalTicks(),this.graphArea=this.graphView.append("svg").attr("class","graph-area"),this.defineToolTip(),this.defineSmallToolTip(),this.defineAreaHighlight(),this.defineMarker(),this.defineZoom(),this.createMonthLabels());this.updateMonthScrollBtns();this.createOrUpdateView()},createMonthLabels:function(){for(var f=
this.monthScroll.find(".month-labels").empty(),m=0;m<=this.state.months;m++)f.append(this.createMonthLabel())},createMonthLabel:function(f){return D.template.render("PriceGraphMonthLabel",{monthLabel:f&&f.format("MMM")})},createDayLabel:function(f,m,p){return D.template.render("PriceGraphDayLabel",{monthDay:f&&f.format("D"),weekDay:f&&f.format("dd"),date:f&&this.dateToStr(f),state:m,index:p})},createOrUpdateView:function(){var f=this;this.isDataProcessNeeded()?this.priceDataProvider.getDataSet().then(this.processDataSet.bind(this)).fail(this.updateGraphVisibility.bind(this,
!1)).always(function(){f.needDataUpdate=!f.state.priceData.length;f.swapClasses(f.loader,"GraphLoaderWrapper--visible","GraphLoaderWrapper--hidden")}):this.updateView()},createPriceData:function(f,m){f=f[m];var p=this.strToDate(m),v=p.clone().add(this.state.tripDuration-1,"days"),z=this.getDatumPrice(f,v.format(this.options.dateFormat));return S.extend({},z,{date:m,startDate:p,returnDate:v,state:z?this.barState.SELECTABLE:this.barState.GREYED,priceType:this.priceType.GOOD,meanPrice:f&&f.meanPrice,
displayPrice:z&&D.Common.Utils.formatOptionalPrice(z.price,!0,!0)})},createNavState:function(f){this.state.nav.push({name:f.startDate.format("MMM"),count:0,hasStart:!1,hasEnd:!1});this.updateNavState(this.state.nav.length-1,f)},resetState:function(){this.state.means=[];this.state.nav=[];this.state.min=Infinity;this.state.max=0},processDataSet:function(f){if(this.needDataUpdate){this.needDataUpdate=!1;this.resetState();var m=this,p=f.dataSet;this.state.priceData=Object.keys(p).map(function(f){return m.createPriceData(p,
f)});this.state.min=O.min(this.state.priceData,this.getPriceFromObject);this.state.max=O.max(this.state.priceData,this.getPriceFromObject);this.state.scale=O.scale.linear().domain([0,this.state.max]).range([0,this.maxBarHeight]);this.updateView()}},afterProcess:function(f){var m=this.getNavMonthId(f.startDate.format("MMM"));-1===m?this.createNavState(f):this.updateNavState(m,f);f.state=this.getBarState(f.price,f.startDate.toDate());f.areaPrice=this.graphHeight-this.getScaledPrice(f.price);f.priceType=
this.getPriceTypeForPrice(f.price)},getBarState:function(f,m){var p=f?this.barState.SELECTABLE:this.barState.GREYED;f&&this.state.departDateObj&&(this.isAfterDate(m,this.state.departDateObj)?p=this.state.returnDateObj?this.isSameDate(m,this.state.returnDateObj)?this.barState.SELECTED:this.isBeforeDate(m,this.state.returnDateObj)?this.barState.PRESELECTED:this.barState.SELECTABLE:this.barState.SELECTABLE:this.isSameDate(m,this.state.departDateObj)&&(p=this.barState.SELECTED));return p},renderView:function(){!this.options.isExplore&&
this.updateTitle();switch(this.state.view){case "area":this.renderArea();this.renderAreaBars();this.updateHighlightPosition();break;default:this.toggleToolTip(this.isDatesSet()&&this.isDepartInView()),this.renderBars(),this.renderDays()}this.renderAxis();this.renderMonths()},renderAxis:function(){var f=this;this.graphSVG.selectAll(".axis").data([0,1,2]).each(function(m){var p;switch(m){case 0:p=0<f.state.max?f.formatPrice(f.formatPriceInSiUnits(f.state.max)):"";break;case 1:f.priceGraphContainer.find(".h-bucket-"+
m).css("height",f.getBucketHeightByPtc(90)+"%");p=0<f.state.max?f.formatPrice(f.formatPriceInSiUnits(2*f.state.max/3)):"";break;case 2:f.priceGraphContainer.find(".h-bucket-"+m).css("height",f.getBucketHeightByPtc(30)+"%"),p=0<f.state.max?f.formatPrice(f.formatPriceInSiUnits(f.state.max/3)):""}f.priceGraphContainer.find(".h-axis-"+m).text(p)})},renderArea:function(){var f=this.state.viewData;if(this.options.historicalPriceGraphEnabled)var m=this.state.viewHistoryData;var p=this.graphArea.selectAll(".area").data([1]);
p.empty()&&(this.options.historicalPriceGraphEnabled&&p.enter().append("g").attr("class","area-history").append("path").attr("class","visible-area "+this.getStlBlock("PriceGraph__Area__History")),p.enter().append("g").attr("class","area").append("path").attr("class","visible-area "+this.getStlBlock("PriceGraph__Area")));p=[f[0]];p=p.concat(f);p.push(f[f.length-1]);if(this.options.historicalPriceGraphEnabled&&m){var v=[m[0]],v=v.concat(m);v.push(m[m.length-1])}this.graphArea.selectAll(".area \x3e path.visible-area").data([p]).transition().duration(50).attr("d",
this.state.lineFunction);this.options.historicalPriceGraphEnabled&&m&&this.graphArea.selectAll(".area-history \x3e path.visible-area").data([v]).transition().duration(50).attr("d",this.state.lineFunction)},renderAreaBars:function(){var f=this;if(this.options.historicalPriceGraphEnabled&&this.state.viewHistoryData)for(var m=this.state.viewHistoryData,p=0;p<m.length;p++)m[p].date&&this._getHistoryKey(m[p].date);m=this.graphArea.selectAll(".emptyBar").data(this.state.viewData);m.exit().remove();m.enter().append(function(m,
p){var v=document.createElementNS("http://www.w3.org/2000/svg","g");v.setAttribute("class","emptyBar "+m.state);v.setAttribute("transform","translate("+p*f.state.barWidth+", 0)");m=document.createElementNS("http://www.w3.org/2000/svg","rect");m.setAttribute("class",f.getStlBlock("PriceGraph__Area__Bar"));m.setAttribute("x","0");m.setAttribute("y",(f.tooltipSpace-4).toString());m.setAttribute("width",f.state.barWidth);m.setAttribute("height",f.maxBarHeight);m.style.fill="transparent";m.style.stroke=
"transparent";v.appendChild(m);return v});m.each(function(m,p){var v=O.select(this);v.attr("transform","translate("+p*f.state.barWidth+", 0)").attr("data-val",m.date).attr("data-idx",p);v.on("mouseover",function(){f.highlightArea(this,m,p)});v.on("click",function(){f.handleAreaClick(this,m)})})},renderBars:function(){var f=this,m=this.graphHeight;if(this.options.historicalPriceGraphEnabled){var p={};if(this.state.viewHistoryData)for(var v=this.state.viewHistoryData,z=0;z<v.length;z++)v[z].date&&(p[this._getHistoryKey(v[z].date)]=
v[z])}v=this.graphArea.selectAll(".bar").data(this.state.viewData);v.exit().remove();v.enter().append(function(p,v){var z=m-f.defaultBarHeight,J=document.createElementNS("http://www.w3.org/2000/svg","g");J.setAttribute("class","bar "+p.state);J.setAttribute("transform","translate("+v*f.state.barWidth+", 0)");p=document.createElementNS("http://www.w3.org/2000/svg","path");p.setAttribute("class","invisible-bar");p.setAttribute("d",f.getPath(z,f.tooltipSpace-4,f.options.radius));v=document.createElementNS("http://www.w3.org/2000/svg",
"path");v.setAttribute("class","visible-bar "+f.getStlBlock("PriceGraph__Bar"));v.setAttribute("d",f.getPath(z,f.graphHeight,f.options.radius));if(f.options.historicalPriceGraphEnabled){var D=document.createElementNS("http://www.w3.org/2000/svg","path");D.setAttribute("class","visible-bar-history "+f.getStlBlock("PriceGraph__Bar__History"));D.setAttribute("d",f.getPath(z,f.graphHeight,f.options.radius))}J.appendChild(p);f.options.historicalPriceGraphEnabled&&J.appendChild(D);J.appendChild(v);return J});
v.each(function(v,z){var J=O.select(this);J.attr("data-val",v.date).attr("data-idx",z).classed(f.getBarClasses(v));J.on("mouseover",function(){f.highlightBar(this,v,z)});J.on("click",function(){f.handleBarClick(v)});J=J.transition().duration(100);J.attr("transform","translate("+z*f.state.barWidth+", 0)");var D=m-(isNaN(v.price)?f.defaultBarHeight:f.state.scale(v.price));J.select(".invisible-bar").attr("d",f.getPath(D,f.tooltipSpace-4,f.options.radius));if(f.options.historicalPriceGraphEnabled&&p.hasOwnProperty(f._getHistoryKey(v.date))){var P=
p[f._getHistoryKey(v.date)].price,P=m-(isNaN(P)?f.defaultBarHeight:f.state.scale(P));J.select(".visible-bar-history").attr("d",f.getPath(P,f.graphHeight,f.options.radius))}J.select(".visible-bar").attr("d",f.getPath(D,f.graphHeight,f.options.radius));f.state.departDateObj&&f.isSameDate(v.startDate.toDate(),f.state.departDateObj)&&v.state===f.barState.SELECTED&&f.updateToolTipData(this,v,z)})},_getHistoryKey:function(f){f=f.split("-");return f[1]+"__"+f[2]},renderDays:function(){var f=this;this.days.empty();
var m=[];this.graphArea.selectAll(".bar").each(function(p,v){m.push(f.createDayLabel(p.startDate,p.state,v))});f.days.append(m)},renderMonths:function(){var f=this,m=!1,p=this.monthScroll.find("li");this.state.nav.length>this.state.months&&(m=!0);p.each(function(v,z){z=S(z);var D=z.children("span"),J=f.state.nav[v-(m?0:1)];f.swapClasses(z,"PriceBarContainer__PriceGraph__MonthLabel--last-visible","");z.removeClass("month-label--last-visible");if(0===v&&!m||!J)f.swapClasses(z,"","PriceBarContainer__PriceGraph__MonthLabel--hidden");
else{f.swapClasses(z,"PriceBarContainer__PriceGraph__MonthLabel--hidden","");var O=f.state.barWidth*J.count,ja=v===p.length-1;(v=m&&0===v||!m&&1===v||ja)&&(O-=f.navWidth);0>O&&(O=0);ja&&(f.swapClasses(z,"","PriceBarContainer__PriceGraph__MonthLabel--last-visible"),z.addClass("month-label--last-visible"));z.css({minWidth:O,maxWidth:O});O?(D.text(J.name),v&&D.width()+10>O&&D.text("")):D.text("")}})},formatPrice:function(f){if(f){var m=D.globals._LEFT_CURCODE+f+D.globals._RIGHT_CURCODE;f=D.globals._LEFT_CURSYMBOL+
f+D.globals._RIGHT_CURSYMBOL;return D.globals._PRICE_USE_CURR_CODE?m:f}return null},formatPriceInSiUnits:function(f){return this.options.fullPrice?O.format()(f):this.options.useUtilsFormat?D.utils.format.siUnits(f):O.format(",.2s")(f)},dateToStr:function(f){return ua(f).format(this.options.dateFormat)},strToDate:function(f){return ua(f,this.options.dateFormat)},highlightArea:function(f,m,p,v){this.lastHighlightedBarIdx=p;var z=this.getHighlightAreaRange(p);this.toggleAreaHighlight(!0);v||this.toggleZoom(!0);
this.updateAreaHighlight(f,m,z,v);this.toggleToolTip(!0);this.handleMouseIn();this.updateToolTipData(f,m,p);this.toggleMarker(!0);this.updateMarker(m,p)},highlightBar:function(f,m,p){this.lastHighlightedBarIdx=p;this.toggleSmallTooltip(!0);this.updateSmallToolTipData(f,m,p);this.removeHighlightsBar();S(f).addClass("highlighted")},removeHighlightsBar:function(){var f=this;this.graphArea.selectAll("g.bar.highlighted").classed({highlighted:!1}).each(function(m){O.select(this).classed(f.isSameAsReturn(m)?
f.barState.PRESELECTED:m.state,!0)})},handleAreaClick:function(f,m){this.setViewState("bars");this.toggleBack(!0);this.toggleDaysHolder(!0);this.cleanView();this.setDates(m);f=this.state.graphEnd;var p=1;m.startDate.diff(this.state.graphStart,this.state.unit)<this.state.move&&(f=this.state.graphStart,p=-1);this.changeWindow(m.startDate,p,f,null,!0,!0);D.Analytics.api.trackEvent({category:"price-graph",action:"area",label:"zoomIn"})},handleBarClick:function(f){this.toggleSmallTooltip(!1);this.setDates(f);
this.moveSelectionToView();this.createOrUpdateView();D.Analytics.api.trackEvent({category:"price-graph",action:"bar",label:"click"})},handleBackClick:function(f){f.preventDefault();this.setAreaView();D.Analytics.api.trackEvent({category:"price-graph",action:"area",label:"zoomOut"})},handleDurationClick:function(f){var m=this.state.tripDuration+f,m=Math.min(Math.max(this.options.minTripDuration,m),this.options.maxTripDuration);this.state.tripDuration!==m&&(this.needDataUpdate=!0,this.setTripDuration(m),
this.setReturnDate(f),this.isBarsView()&&this.publishUpdate(),this.createOrUpdateView(),D.Analytics.api.trackEvent({category:"price-graph",action:"durationChange",label:1===f?"increase":"decrease"}))},handleSubmitClick:function(){var f=D.question.ask(this.question);if(f)if(D.Analytics.api.trackEvent({category:"price-graph",action:"searchButton",label:"click"}),this.options.submitForm)D.events.publish("submit.search.form.force",{id:this.getFormId()});else{var m,p;this.options.airportMultiSelectEnabled?
(m=this.priceDataProvider.origin[0].code,p=this.priceDataProvider.destination[0].code):(m=this.priceDataProvider.origin.originCode,p=this.priceDataProvider.destination.destinationCode);var v=this.state.returnDate||this.state.windowEnd;m={originId:m,destinationId:p,departDate:(this.state.departDate||this.state.windowStart).format(this.options.dateFormat),returnDate:v.format(this.options.dateFormat),includeNearbyOrigin:f.nearby_destination,includeNearbyDestination:f.nearby_origin,cabinClass:f.cabin,
adults:f.adults,seniors:f.seniors,youth:f.youth,child:f.child,seatInfants:f.seatInfant,lapInfants:f.lapInfant};(f=D.flights.search.FlightSearchFormUrls.generateRtowFlightsUrl(m,f.flex_category))&&0===f.indexOf("/")||(f="/"+f);window.open(f)}},handleMonthScroll:function(f){S(f).is(".scroll-left")?this.changeWindow(this.state.windowStart,-1,this.state.graphStart):this.changeWindow(this.state.windowEnd,1,this.state.graphEnd)},handleMouseIn:function(){this.toolTipMouseOutTimer&&(clearTimeout(this.toolTipMouseOutTimer),
this.toolTipMouseOutTimer=null)},handleMouseOut:function(){this.isBarsView()?(this.toggleSmallTooltip(!1),this.removeHighlightsBar()):this.toggleZoom(!1)},publishUpdate:function(){D.events.publish(this.events.rtowDateRange,{id:this.getFormId(),departDate:this.state.departDate,returnDate:this.state.returnDate,startDate:this.state.departDate,endDate:this.state.returnDate})},moveSelectionToView:function(){if(this.isDatesSet()&&this.enabledAutoScroll()&&this.isDepartInView()&&!this.isReturnInView()){var f=
this.state.returnDate.diff(this.state.windowEnd,this.state.unit);this.canMoveWindow(f)&&this.changeWindow(this.state.windowEnd,1,this.state.graphEnd,f,!1,!0)}},updateMonthScrollBtns:function(){this.swapClassesToggle(this.monthScroll.find(".scroll-left"),"PriceBarContainer__PriceGraph__ScrollBtn--inactive","PriceBarContainer__PriceGraph__ScrollBtn--active",this.isSameDate(this.state.windowStart.toDate(),this.state.graphStart.toDate()));this.swapClassesToggle(this.monthScroll.find(".scroll-right"),
"PriceBarContainer__PriceGraph__ScrollBtn--inactive","PriceBarContainer__PriceGraph__ScrollBtn--active",this.isSameDate(this.state.windowEnd.toDate(),this.state.graphEnd.toDate()))},updateGraphWidths:function(f){if(!this.graphWidth||f)this.graphWidth=S(".price-graph",this.container).width()},updateHorizontalTicks:function(){var f=this;this.graphView.selectAll(".graph-axis \x3e line").each(function(){O.select(this).attr("x2",f.graphWidth)})},updateNavState:function(f,m){this.state.nav[f].count+=1;
m=m.startDate.clone();this.isSameDate(m.startOf("month").toDate(),m.startOf("date").toDate())&&(this.state.nav[f].hasStart=!0);this.isSameDate(m.endOf("month").toDate(),m.endOf("date").toDate())&&(this.state.nav[f].hasEnd=!0)},updateView:function(){if(this.state.priceData.length){this.state.nav=[];var f=this.state.windowStart.diff(this.state.graphStart,"days"),m=this.state.windowEnd.diff(this.state.graphStart,"days")+1,f=this.state.priceData.slice(f,m);"rtl"===document.dir&&(f=f.reverse());f.forEach(this.afterProcess.bind(this));
this.updateBarsState(f);this.setLineFunctions();this.renderView()}else this.updateGraphVisibility(!1)},updateBarsState:function(f){this.state.viewData=f;this.state.barCount=f.length;this.state.barWidth=this.graphWidth/this.state.barCount},updateToolTipData:function(f,m,p){var v=this,z=this.state.scale;f=this.state.barWidth;var P=p*f,J=f/2,aa=this.tooltipMinWidth,S=90,ua=isNaN(m.price)?this.defaultBarHeight:z(m.price),pa=this.graphView.select(".tooltip"),z=pa.transition().duration(50);z.attr("transform",
"translate("+P+", 0)").style("display","block");this.isAreaView()?(S=90,pa.select(".dates").attr("visibility","visible"),pa.select(".trip").attr("y",S),pa.select(".submit").attr("visibility","hidden")):(S=52,pa.select(".dates").attr("visibility","hidden"),pa.select(".trip").attr("y",S),pa.select(".submit").attr("visibility","visible"));z.select("line").attr("x1",J).attr("y1",109).attr("x2",J).attr("y2",this.graphHeight-ua);z.select("polygon").attr("points",[J,112,J-6,106,J+6,106].join(" "));z.select(".price-box").selectAll("text").each(function(){var f=
O.select(this),p=v.getHighlightInfo(m);v.hasElementClass(f[0][0],"price")&&f.text(D.Common.Utils.String.formatString(v.options.messages.priceFrom,p.price));v.hasElementClass(f[0][0],"dates")&&f.text(p.dates);v.hasElementClass(f[0][0],"trip")&&f.text(p.trip)});z.select(".price-box \x3e .increase-duration").attr("x","rtl"===document.dir?22:aa-22).attr("y",S-15).attr("visibility","visible");z.select(".price-box \x3e .reduce-duration").attr("x","rtl"===document.dir?50:aa-50).attr("y",S-15).attr("visibility",
"visible");z.select(".price-box \x3e rect").attr("width",aa+20);p*=f;p>this.graphWidth-(aa+20)/2?(p=this.graphWidth-aa-20-p,z.select(".price-box").attr("transform","translate("+p+",0)")):p<(aa+20)/2?z.select(".price-box").attr("transform","translate(-"+p+",0)"):z.select(".price-box").attr("transform","translate(-"+(aa/2+7-f/2)+",0)")},updateSmallToolTipData:function(f,m,p){var v=this.state.scale;f=this.state.barWidth;p*=f;var z=0,D=isNaN(m.price)?this.defaultBarHeight:v(m.price),v=f/2,D=this.graphHeight-
D-10,J=this.getHighlightInfo(m);m=this.graphView.select(".smallTooltip");m.attr("transform","translate("+p+", 0)");var S=m.selectAll(".price-box \x3e .price");S.each(function(){O.select(this).text(J.price);z=Math.max(this.getBBox().width,z)});var z=Math.max(this.tooltipSmallMinWidth,z),ja=z+8;S.attr("x",ja/2);m.select(".price-box \x3e rect").attr("width",ja);m.select("polygon").attr("points",[v,D+6,v-3,D,v+3,D].join(" "));v=-1*(ja/2-f/2);0===p?v=0:p-f<f-ja/2?v=0:p>this.graphWidth-ja&&(v=this.graphWidth-
z-8-p);m.select(".price-box").attr("transform","translate("+v+","+(D-36)+")")},updateHighlightPosition:function(){var f=this,m;this.state.departDate&&"undefined"===typeof this.lastHighlightedBarIdx&&(m=this.priceGraphContainer.find("g.emptyBar[data-val\x3d"+this.dateToStr(this.state.departDate)+"]"));m&&m.length||!this.state.viewData||"undefined"===typeof this.lastHighlightedBarIdx||(m=this.priceGraphContainer.find("g.emptyBar[data-val\x3d"+this.state.viewData[Math.min(this.lastHighlightedBarIdx,
this.state.viewData.length-1)].date+"]"));if(m&&m.length){var p=parseInt(m.attr("data-idx"),10);m.length&&O.select(m[0]).each(function(m){f.highlightArea(this,m,p,!0)})}},updateGraphVisibility:function(f,m){this.setLastSearchCacheKey(m||null,f);this.visible=(this.isAllSet()||this.options.isExplore)&&f;this.toggleGraph(this.visible);this.visible&&this.activatePriceGraph()},updateTitle:function(){this.title.text(D.Common.Utils.String.formatString(this.options.messages.title,this.getLocation(this.priceDataProvider.origin,
!0),this.getLocation(this.priceDataProvider.destination,!1)))},updateAreaHighlight:function(f,m,p,v){m=[];var z=this.state.areaFnc,D=this.state.areaFncRev,J=0;0===p.start?(f=this.state.viewData.slice(p.start,p.end+1),m.push(f[0]),m=m.concat(f),z=this.state.areaFncStart,D=this.state.areaFncRevStart,J=1):p.end>=this.state.barCount?(m=f=this.state.viewData.slice(p.start-1,this.state.barCount),m.push(f[f.length-1]),z=this.state.areaFncEnd,D=this.state.areaFncRevEnd,J=-1):m=f=this.state.viewData.slice(p.start-
1,p.end);p=this.getHighlightShift(p);this.areaHighlight.attr("x",p);this.areaHighlight.selectAll(".below-curve").data([m]).attr("d",z);this.areaHighlight.selectAll(".above-curve").data([m]).attr("d",D);v||this.updateZoom(p,f,J)},updateMarker:function(f,m){var p={};p["marker-"+this.priceType.GOOD+"pct"]=f.priceType===this.priceType.GOOD;p["marker-"+this.priceType.AVERAGE+"pct"]=f.priceType===this.priceType.AVERAGE;p["marker-"+this.priceType.EXPENSIVE+"pct"]=f.priceType===this.priceType.EXPENSIVE;this.marker.classed(p);
this.marker.select("path").transition().duration(50).attr("d",this.getMarkerPosition(m*this.state.barWidth+this.state.barWidth/2,f.areaPrice))},updateZoom:function(f,m,p){var v=m.length-1;p=this.state.barWidth*v+p*this.state.barWidth/2;for(var z=this.graphHeight-this.zoomHeight-2,D=0;D<v;D++)if(m[D].areaPrice>z){z=this.graphHeight+4;break}this.zoom.attr("width",p).attr("x",f).attr("y",z).select("rect").attr("width",p)},toggleAreaHighlight:function(f){this.areaHighlight.attr("visibility",f?"visible":
"hidden")},toggleMarker:function(f){this.marker.attr("visibility",f?"visible":"hidden")},toggleZoom:function(f){this.zoom.attr("visibility",f?"visible":"hidden")},toggleBack:function(f){f?this.swapClasses(this.back,"Section__Header__Back--hidden",""):this.swapClasses(this.back,"","Section__Header__Back--hidden")},toggleToolTip:function(f){f?this.swapClasses(this.priceGraphContainer.find(".tooltip"),"PriceGraph__Highlight--hidden",""):this.swapClasses(this.priceGraphContainer.find(".tooltip"),"","PriceGraph__Highlight--hidden")},
toggleSmallTooltip:function(f){f?this.swapClasses(this.priceGraphContainer.find(".smallTooltip"),"PriceGraph__Highlight--hidden",""):this.swapClasses(this.priceGraphContainer.find(".smallTooltip"),"","PriceGraph__Highlight--hidden")},toggleDaysHolder:function(f){f?this.swapClasses(this.daysHolder,"PriceBarContainer__PriceGraph__DayLabelsWrapper--hidden",""):this.swapClasses(this.daysHolder,"","PriceBarContainer__PriceGraph__DayLabelsWrapper--hidden")},toggleGraphView:function(f){this.state.created&&
f?(this.toggleGraph(!0),this.updateGraphWidths(!0),this.updateHorizontalTicks(),this.createOrUpdateView()):f||this.toggleGraph(!1)},toggleGraph:function(f){f?this.swapClasses(this.element,"PriceGraph--hidden",""):this.swapClasses(this.element,"","PriceGraph--hidden")},defineToolTip:function(){var f=this;this.graphView.selectAll(".tooltip").data([0]).enter().append("g").attr("class","tooltip "+f.getStlBlock("PriceGraph__Highlight")).each(function(){var m=O.select(this);m.append("rect").attr("x",0).attr("y",
0).attr("height",0).attr("width",0).attr("class",f.getStlBlock("PriceGraph__Highlight__Bar")).attr("visibility","hidden");m.append("line").attr("x1",0).attr("y1",f.tooltipSpace).attr("x2",0).attr("y2",f.graphHeight-f.maxBarHeight).attr("class",f.getStlBlock("PriceGraph__Highlight__Connector"));m.append("polygon").attr("class","tri "+f.getStlBlock("PriceGraph__Highlight__Caret")).attr("points","0 112 0 106 0 106");m=m.append("g").attr("class","price-box");m.append("rect").attr("x",0).attr("y",0).attr("rx",
f.options.radius).attr("ry",f.options.radius).attr("height",106).attr("class",f.getStlBlock("PriceGraph__Highlight__PriceBox__Rect"));var p=m.append("text").attr("x","rtl"===document.dir?f.tooltipMinWidth+12:12).attr("y",27).attr("class","price "+f.getStlBlock("PriceGraph__Highlight__PriceBox__Price"));"rtl"===document.dir&&p.attr("unicode-bidi","embed").attr("direction","rtl");p=m.append("text").attr("x","rtl"===document.dir?f.tooltipMinWidth+12:12).attr("y",57).attr("class","dates "+f.getStlBlock("PriceGraph__Highlight__PriceBox__Rest"));
"rtl"===document.dir&&p.attr("unicode-bidi","embed").attr("direction","rtl");p=m.append("text").attr("x","rtl"===document.dir?f.tooltipMinWidth+12:12).attr("y",90).attr("class","trip "+f.getStlBlock("PriceGraph__Highlight__PriceBox__TripLength"));"rtl"===document.dir&&p.attr("unicode-bidi","embed").attr("direction","rtl");f.plus=m.append("svg").attr("x",0).attr("y",0).attr("visibility","hidden").attr("class","increase-duration "+f.getStlBlock("PriceGraph__Highlight__PriceBox__Button")+" "+f.getStlBlock("PriceGraph__Highlight__PriceBox__Button--enabled"));
f.plus.append("rect").attr("x",0).attr("y",0).attr("rx",2).attr("ry",2).attr("width",20).attr("height",20);f.plus.append("path").attr("fill","currentColor").attr("d","m6 11 h3 v3 h2 v-3 h3 v-2 h-3 v-3 h-2 v3 h-3 v2 z");f.plus.on("click",f.handleDurationClick.bind(f,1));f.minus=m.append("svg").attr("x",0).attr("y",0).attr("visibility","hidden").attr("class","reduce-duration "+f.getStlBlock("PriceGraph__Highlight__PriceBox__Button")+" "+f.getStlBlock("PriceGraph__Highlight__PriceBox__Button--enabled"));
f.minus.append("rect").attr("x",0).attr("y",0).attr("rx",2).attr("ry",2).attr("width",20).attr("height",20);f.minus.append("path").attr("fill","currentColor").attr("d","m6 11 h8 v-2 h-8 z");f.minus.on("click",f.handleDurationClick.bind(f,-1));m=m.append("svg").attr("x",40).attr("y",65).attr("visibility","hidden").attr("class","submit "+f.getStlBlock("PriceGraph__Highlight__PriceBox__Submit"));m.append("rect").attr("x",0).attr("y",0).attr("rx",f.options.radius?f.options.radius:2).attr("ry",f.options.radius?
f.options.radius:2).attr("width",150).attr("height",34).attr("class",f.getStlBlock("PriceGraph__Highlight__PriceBox__Submit__Rect"));m.append("text").attr("x",75).attr("y",22).attr("class",f.getStlBlock("PriceGraph__Highlight__PriceBox__Submit__Text")).text(f.options.messages.search);m.on("click",f.handleSubmitClick.bind(f))})},defineSmallToolTip:function(){var f=this;this.graphView.selectAll(".smallTooltip").data([0]).enter().append("g").attr("class","smallTooltip "+f.getStlBlock("PriceGraph__Highlight__Black")).each(function(){var m=
O.select(this),p=m.append("g").attr("class","price-box");p.append("rect").attr("x",0).attr("y",0).attr("rx",f.options.radius).attr("ry",f.options.radius).attr("height",36).attr("class",f.getStlBlock("PriceGraph__Highlight__Black__Rect"));m.append("polygon").attr("class","tri "+f.getStlBlock("PriceGraph__Highlight__Black__Caret")).attr("points","0 42 0 36 0 36");m=p.append("text").attr("x",12).attr("y",22).attr("class","price PriceGraph__Highlight__Black__Price "+f.getStlBlock("PriceGraph__Highlight__Black__Price"));
"rtl"===document.dir&&m.attr("unicode-bidi","embed").attr("direction","rtl")})},defineHorizontalTicks:function(){var f=this;this.graphView.append("g").attr("class","graph-axis").selectAll("line").data([0,1,2]).enter().append("line").each(function(m){var p=O.select(this),v=function(){switch(m){case 0:return f.graphHeight-f.maxBarHeight-4;case 1:return f.graphHeight-2*f.maxBarHeight/3;case 2:return f.graphHeight-f.maxBarHeight/3;default:return 0}}();p.attr("class",function(m){return["axis","axis-"+
m,f.getStlBlock("PriceGraph__Axis")].join(" ")}).attr("x1",0).attr("x2",f.graphWidth).attr("y1",v).attr("y2",v)})},defineAreaHighlight:function(){this.areaHighlight=this.graphView.append("svg").attr("class","highlighted-area "+this.getStlBlock("PriceGraph__Area__Highlight")).attr("x",0).attr("visibility","hidden");this.areaHighlight.append("path").attr("class","above-curve "+this.getStlBlock("PriceGraph__Area__Highlight__Above")).attr("d","");this.areaHighlight.append("path").attr("class","below-curve "+
this.getStlBlock("PriceGraph__Area__Highlight__Below")).attr("d","")},defineMarker:function(){this.marker=this.graphView.append("g").attr("class","graph-marker "+this.getStlBlock("PriceGraph__Marker")).attr("visibility","hidden");this.marker.append("path").attr("d",this.getMarkerPosition(0,0)).attr("class",this.getStlBlock("PriceGraph__Marker__Path")).attr("stroke","currentColor")},defineZoom:function(){this.zoom=this.graphView.append("svg").attr("class","graph-zoom "+this.getStlBlock("PriceGraph__Zoom")).attr("x",
0).attr("y",this.graphHeight-this.zoomHeight).attr("width",150).attr("height",this.zoomHeight).attr("visibility","hidden");this.zoom.append("rect").attr("class",this.getStlBlock("PriceGraph__Zoom__Rect")).attr("x",0).attr("y",0).attr("width",150).attr("height",this.zoomHeight);this.zoom.append("text").text(this.options.messages.zoomIn).attr("x","50%").attr("y","50%").attr("dominant-baseline","middle").attr("text-anchor","middle")},getFormId:function(){return this.formId},getDatesId:function(){return this.datesId},
getHighlightShift:function(f){return this.state.barWidth*f.start-(0===f.start?0:this.state.barWidth/2)},getMarkerPosition:function(f,m){return"M "+(f-8)+","+m+" a8,8 0 1,0 16,0 a 8,8 0 1,0 -16,0"},getPriceTypeForPrice:function(f){var m=this.priceType.GOOD;this.state.min<=this.state.max&&(f=(f-this.state.min)/(this.state.max-this.state.min)*100,90<f?m=this.priceType.EXPENSIVE:30<f&&(m=this.priceType.AVERAGE));return m},getBucketHeightByPtc:function(f){return this.state.min>=this.state.max?0:100*this.state.scale((this.state.max-
this.state.min)*f/100+this.state.min)/this.maxBarHeight},getNavMonthId:function(f){for(var m=0;m<this.state.nav.length;m++)if(this.state.nav[m].name===f)return m;return-1},getDatumPrice:function(f,m){return!f||m&&!f.returnDates[m]?null:f.returnDates[m]},getPoints:function(f,m){return"0 "+f+",0 "+this.graphHeight+","+this.state.barWidth+" "+this.graphHeight+","+this.state.barWidth+" "+m},getPath:function(f,m,p){return"M 0 "+(f+p)+(p?" A "+p+" "+p+" 0 0 1 "+p+" "+f:"")+(" L "+(this.state.barWidth-p)+
" "+f)+(p?" A "+p+" "+p+" 0 0 1 "+this.state.barWidth+" "+(f+p):"")+(" V "+m+" H 0 V "+(f+p))+" z"},getPrice:function(f){return isNaN(f)?this.defaultBarHeight:f},getScaledPrice:function(f){return isNaN(f)?this.defaultBarHeight:this.state.scale(f)},getPriceFromObject:function(f){return f.price},getBarClasses:function(f){var m=f.state,m=this.isSameAsReturn(f)?this.barState.PRESELECTED:m;f={};f[this.barState.GREYED]=this.barState.GREYED===m;f[this.barState.SELECTABLE]=this.barState.SELECTABLE===m;f[this.barState.SELECTED]=
this.barState.SELECTED===m;f[this.barState.PRESELECTED]=this.barState.PRESELECTED===m;return f},getHighlightAreaRange:function(f){var m=this.options.area.range,p=2*m+1,v=this.state.barCount-1;if(v<=p)return{start:0,end:v};var z=f-m;f=f+m+1;return 0>z?{start:0,end:p}:f>=v+1?{start:this.state.barCount-p,end:this.state.barCount}:{start:z,end:f}},getHighlightInfo:function(f){var m={price:f.displayPrice||this.options.messages.toolTipPriceUnavailable,trip:this.getTripDurationLabel()};f=f.startDate;var p=
this.state.departDate,v=this.state.returnDate;this.isDatesSet()&&this.isBarsView()?m.dates=D.Common.Utils.String.formatString(this.options.messages.toolTipDateRange,p.format(this.options.toolTipDateFormat),v.format(this.options.toolTipDateFormat)):m.dates=D.Common.Utils.String.formatString(this.options.messages.toolTipDepartOn,f.format(this.options.toolTipDateFormat));return m},getTripDurationLabel:function(){return D.Common.Utils.String.formatChoice(this.options.messages.tripDuration,this.state.tripDuration,
this.state.tripDuration)},getLocation:function(f,m){return(Array.isArray(f)?f[0].display:m?f.originLocation:f.destinationLocation).replace(/ *\([^)]*\) */g,"")},getX:function(f,m){return m*this.state.barWidth},getXStart:function(f,m){f=2*this.options.area.range;var p=m*this.state.barWidth-this.state.barWidth/2;0===m?p=0:m===f&&(p=m*this.state.barWidth-this.state.barWidth/2);return p},getXEnd:function(f,m){f=2*this.options.area.range+1;var p=m*this.state.barWidth;0===m?p=0:m===f+1&&(p=m*this.state.barWidth-
this.state.barWidth/2);return p},getY:function(f){return f.areaPrice},setOrigin:function(f,m){f||m?this.options.airportMultiSelectEnabled&&m.length?(this.originCode=m[0],this.multiOriginAirports=m):this.originCode=f:this.originCode=""},setDestination:function(f,m){f||m?this.options.airportMultiSelectEnabled&&m.length?(this.destinationCode=m[0],this.multiDestinationAirports=m):this.destinationCode=f:this.destinationCode=""},setQuestion:function(){this.question=this.getFormId()?[this.options.question,
this.getFormId()].join("_"):this.options.question},setDatesId:function(){this.datesId=this.getFormId()+"-travelDates"},setStateDepartDate:function(f){this.state.departDate=f;this.state.departDateObj=f.toDate()},setStateReturnDate:function(f){this.state.returnDate=f;this.state.returnDateObj=f.toDate()},setInitStateDepartDate:function(){this.setStateDepartDate(this.departDate?this.strToDate(this.departDate):ua().startOf("day"))},setLineFunctions:function(){var f=this;this.state.lineFunction=O.svg.area().x(function(m,
p){m=p*f.state.barWidth-f.state.barWidth/2;0===p?m=0:p===f.state.barCount+1&&(m=f.graphWidth);return m}).y0(this.getY.bind(this)).y1(function(){return f.graphHeight}).interpolate(this.options.interpolate);this.state.areaFnc=O.svg.area().x(this.getX.bind(this)).y0(this.getY.bind(this)).y1(function(){return f.graphHeight}).interpolate(this.options.interpolate);this.state.areaFncRev=O.svg.area().x(this.getX.bind(this)).y0(this.getY.bind(this)).y1(function(){return f.tooltipSpace-4}).interpolate(this.options.interpolate);
this.state.areaFncStart=O.svg.area().x(this.getXStart.bind(this)).y0(this.getY.bind(this)).y1(function(){return f.graphHeight}).interpolate(this.options.interpolate);this.state.areaFncRevStart=O.svg.area().x(this.getXStart.bind(this)).y0(this.getY.bind(this)).y1(function(){return f.tooltipSpace-4}).interpolate(this.options.interpolate);this.state.areaFncEnd=O.svg.area().x(this.getXEnd.bind(this)).y0(this.getY.bind(this)).y1(function(){return f.graphHeight}).interpolate(this.options.interpolate);this.state.areaFncRevEnd=
O.svg.area().x(this.getXEnd.bind(this)).y0(this.getY.bind(this)).y1(function(){return f.tooltipSpace-4}).interpolate(this.options.interpolate)},setTripDuration:function(f){var m=this.options.maxTripDuration;f=f>m?m:f;return f>=this.options.minTripDuration&&f<=m?(this.state.tripDuration=f,this.state.tripDuration===m?this.swapClasses(S(this.plus[0]),"PriceGraph__Highlight__PriceBox__Button--enabled","PriceGraph__Highlight__PriceBox__Button--disabled"):this.swapClasses(S(this.plus[0]),"PriceGraph__Highlight__PriceBox__Button--disabled",
"PriceGraph__Highlight__PriceBox__Button--enabled"),this.state.tripDuration===this.options.minTripDuration?this.swapClasses(S(this.minus[0]),"PriceGraph__Highlight__PriceBox__Button--enabled","PriceGraph__Highlight__PriceBox__Button--disabled"):this.swapClasses(S(this.minus[0]),"PriceGraph__Highlight__PriceBox__Button--disabled","PriceGraph__Highlight__PriceBox__Button--enabled"),!0):!1},setReturnDate:function(f){this.state.departDate&&(this.state.returnDate||this.setStateReturnDate(this.state.departDate.clone()),
this.state.returnDate.add(f,"days"),this.state.returnDateObj=this.state.returnDate.toDate())},setDates:function(f){this.state.departDate=null;this.state.returnDate=null;this.state.departDateObj=null;this.state.returnDateObj=null;f&&f.startDate&&(this.setStateDepartDate(f.startDate.clone()),this.setReturnDate(this.state.tripDuration-1),this.publishUpdate())},setViewState:function(f){this.state.view=f||this.options.view;this.state.months=this.options[this.state.view].months;this.state.move=this.options[this.state.view].move;
this.state.unit=this.options[this.state.view].unit;this.lastHighlightedBarIdx=void 0},setAreaView:function(){var f=1,m=this.state.graphEnd;this.setViewState("area");this.toggleBack(!1);this.toggleDaysHolder(!1);this.cleanView();var p=this.state.departDate?this.state.departDate.clone():this.state.graphStart.clone();p.clone().add(-1*this.state.move,this.state.unit).isBefore(this.state.graphStart)?p=this.state.graphStart.clone().add(this.state.move,this.state.unit):p.clone().add(this.state.move,this.state.unit).isAfter(this.state.graphEnd)&&
(f=-1,p=this.state.graphEnd.clone().add(f*this.state.move,this.state.unit),m=this.state.graphStart);this.changeWindow(p,f,m,null,!1,!0)},setWindowEnd:function(){return 20<this.state.windowStart.date()?this.state.windowStart.clone().add(this.state.months,"months").endOf("month"):this.state.windowStart.clone().add(this.state.months-1,"months").endOf("month")},setLastSearchCacheKey:function(f,m){m?(this.needDataUpdate=this.lastSearchCacheKey!==f,this.lastSearchCacheKey=f):(this.needDataUpdate=!0,this.lastSearchCacheKey=
null)},isBarsView:function(){return"bars"===this.state.view},isAreaView:function(){return"area"===this.state.view},isDatesSet:function(){return!!this.state.departDate&&!!this.state.returnDate},isAllSet:function(){return this.options.isExplore&&this.isAllowedScreen()?!0:this.priceDataProvider.origin&&this.priceDataProvider.destination&&this.priceDataProvider.origin.length&&this.priceDataProvider.destination.length&&""!==this.priceDataProvider.origin.originCode&&""!==this.priceDataProvider.destination.destinationCode&&
"range"===this.priceDataProvider.dateMode&&("roundtrip"===this.state.display||"rtow"===this.state.display)&&"e"===this.state.cabinType&&this.isBBScreen},isDepartInView:function(){return this.state.departDate.isBetween(this.state.windowStart,this.state.windowEnd,null,"[]")},isReturnInView:function(){return this.state.returnDate.isBetween(this.state.windowStart,this.state.windowEnd,null,"[]")},isSameAsReturn:function(f){return 1<this.state.tripDuration&&this.state.returnDate&&this.isSameDate(this.state.returnDateObj,
f.startDate.toDate())&&this.barState.SELECTED===f.state},isDataProcessNeeded:function(){return this.needDataUpdate},isAfterDate:function(f,m){return f.getTime()>m.getTime()},isSameDate:function(f,m){return f.getTime()===m.getTime()},isBeforeDate:function(f,m){return f.getTime()<m.getTime()},isAllowedScreen:function(){return 768<=S(window).width()},hasElementClass:function(f,m){return f.classList?f.classList.contains(m):(new RegExp("(^| )"+m+"( |$)")).test(f.className.baseVal)},enabledAutoScroll:function(){return this.options.autoScroll},
canMoveWindow:function(f){return this.state.departDate.diff(this.state.windowStart,this.state.unit)>f}})})(R9,jQuery,d3,moment);(function(b,c){b.createComponentClass("common.seo.LazyImage",{options:{isBackgroundImage:!1},placeholder:void 0,image:void 0,observer:void 0,init:function(){this.placeholder=this.getChildElement("placeholder");this.image=this.getChildElement("image")},addEventHandlers:function(){b.config.getBoolean("ui.horizon.common.momondo.lazyload.pagelevel.enabled",!1)||("IntersectionObserver"in window?this.initIntersectionObserver():this.preloadImage())},initIntersectionObserver:function(){var a=this;this.observer=
new IntersectionObserver(function(b,c){b.forEach(function(b){0<b.intersectionRatio&&(c.unobserve(b.target),a.preloadImage())})});this.observer.observe(c(this.element)[0])},preloadImage:function(){if(this.options.isBackgroundImage)this.element.css("background-image","url("+this.checkWebpFeature(this.element.data("src"))+")"),this.element.fadeTo("slow",1),this.placeholder.remove();else{var a=this;this.image.attr("src",this.checkWebpFeature(this.image.data("src")));this.image.attr("srcset",this.image.data("srcset"));
c(this.image).on("load",function(){a.placeholder.remove();a.image.fadeTo("slow",1)})}},checkWebpFeature:function(a){return"undefined"!==typeof seoR9&&seoR9.webpSupport?(a+=-1!==a.indexOf("?")?"\x26":"?",a+"outputtype\x3dwebp"):a}})})(R9,jQuery);(function(a){a.createComponentClass("common.seo.brands.momondo.CardGrid",{options:{trackingId:void 0},inlineComponentsReady:function(){this.options.trackingId&&a.VestigoActions.log("render",this.options.trackingId)}})})(R9);(function(a,b){a.createComponentClass("common.frontdoor.brands.momondo.brandonly.DestinationsSection",{linksCards:void 0,moduleName:void 0,options:{type:void 0,vertical:void 0},init:function(){this.options.type&&this.options.vertical&&(this.linksCards=this.element.find(".js-link-card-with-image"),this.moduleName="trending-"+this.options.vertical+"-"+this.options.type.toLowerCase())},addEventHandlers:function(){this.linksCards&&this.linksCards.length&&this.linksCards.click(function(){a.VestigoActions.click(this.moduleName+
"-link-click")}.bind(this))},inlineComponentsReady:function(){this.moduleName&&a.VestigoActions.log("render",this.moduleName)}})})(R9,jQuery||window.jQuery);(function(b,c){b.createComponentClass("common.seo.ExpandableContent",{collapsedClassName:"ExpandableContent--collapsed",expandedClassName:"ExpandableContent--expanded",container:void 0,chevronButton:void 0,content:void 0,init:function(){this.container=this.element.find(".js-container");this.chevronButton=this.element.find(".js-chevron");this.content=this.element.find(".js-content")},addEventHandlers:function(){this.chevronButton.click(this.handleExpand.bind(this))},handleExpand:function(){var a=this.container.hasClass(this.expandedClassName);
b.dom.swapClassesToggle(this.container,this.collapsedClassName,this.expandedClassName,a);this.chevronButton.attr("aria-expanded",a?"false":"true");this.content.attr("aria-hidden",a?"true":"false");b.events.publish("ExpandableContent.expanded",{id:this.id(),expanded:!a})}})})(R9,jQuery);(function(d,e){d.createComponentClass("seo.common.destinationtiles.SeoLinksContainer",{collapsedClassName:"ExpandableContent--collapsed",expandedClassName:"ExpandableContent--expanded",init:function(){this.subscribe("ExpandableContent.expanded",function(b){d.Analytics.api.trackEvent({category:"seolinks",subPageId:"destinationTile",action:"toggle"});if(b.expanded){var c=this.element.find("#"+b.id);c.length&&(c=c.parent().parent(".js-column"),c.length&&Array.from(c.find(".js-container")).map(function(a){a=
e(a);a.parent().length&&a.parent()[0].id!==b.id&&a.hasClass(this.expandedClassName)&&(d.dom.swapClassesToggle(a,this.collapsedClassName,this.expandedClassName,!0),a.find(".js-chevron").attr("aria-expanded",!1),a.find(".js-content").attr("aria-hidden",!0))}.bind(this)))}}.bind(this))},addEventHandlers:function(){this.element.on("click",".js-title-link, .js-link",function(b){d.Analytics.api.trackEvent({category:"seocitylink",subPageId:"destinationTile",action:"click",label:e(b.currentTarget).data("type")})})}})})(R9,
jQuery);(function(c,d){c.createComponentClass("seo.common.layout.faqs.FrontDoorFaqs",{addEventHandlers:function(){this.element.find(".js-question").click(this.handleFaqExpand.bind(this))},handleFaqExpand:function(a){a=d(a.currentTarget).find(".js-faqChevron");var b=!a.hasClass("FrontDoorFaqs__chevron-expanded");a.toggleClass("FrontDoorFaqs__chevron-expanded").attr("aria-expanded",b?"true":"false");a.closest(".js-question").siblings(".js-answer").toggleClass("FrontDoorFaqs__answer-collapsed").toggleClass("FrontDoorFaqs__answer-expanded").attr("aria-hidden",
b?"false":"true")}})})(R9,jQuery);(function(c,d){c.createComponentClass("common.frontdoor.FrontDoorContent",{init:function(){this.element.find("img").unveil(500,function(){d(this).on("load",function(){this.style.opacity=1})}).trigger("unveil")},addEventHandlers:function(d){var a=this;c.events.subscribe("frontdoor.vertical.changed",function(b){b.vertical===a.vertical?a.show():a.hide()});c.events.subscribe(["frontdoor.view.changed","fdcontent.view.setview"],function(b){"inline"===b.view||"hidden"===b.view?a.hide():a.show()})},show:function(){this.element.removeClass("hidden")},
hide:function(){this.element.addClass("hidden")}})})(R9,jQuery);(function(a){var c=a.config.getBoolean("ui.horizon.personalization.ajaxLoader.combine",!1);a.createComponentClass("common.personalization.AjaxLoader",{options:{action:"",params:{}},inlineComponentsReady:function(){var b=this;a.ajax.execute(this.options.action,{appendTo:this.element,replaceContainer:!0,combinable:c,data:this.options.params}).then(function(a){a.id||b.element.remove()}).fail(function(){b.element.remove()})}})})(R9);(function(a){a.createComponentClass("common.frontdoor.HarmonizedFrontDoorContent",{options:{outlineParams:{dataTag:""}},init:function(){},addEventHandlers:function(){this.subscribe("authentication.state.changed",this.reload.bind(this))},reload:function(){var b=this.element.find("["+this.options.outlineParams.dataTag+"]");b.length&&a.ajax.execute("common/personalization/OutlineFrontDoorContent",{method:"GET",data:this.options.outlineParams,allowRobots:!1,highPriority:!0,appendTo:b,replaceContainer:!0,
customUpdate:function(){a.ComponentManager.remove(b,!1);return!1}})}})})(R9);(function(a,c){a.createComponentClass("base.frontdoor.FrontDoor",{options:{vertical:null},init:function(a){},addEventHandlers:function(c){var d=this;a.events.subscribe("frontdoor.view.changed",function(b){d.element.toggleClass("InlineView","inline"===b.view);a.events.publish("frontdoor.setview",b.view)})}})})(R9,jq||jQuery);(function(a,b){a.createComponentClass("flights.frontdoor.FlightFrontDoor","base.frontdoor.FrontDoor",{inlineComponentsReady:function(){a.events.publish("flights.frontdoor.init")}})})(R9,jQuery);(function(c,h,g){c.publish("common.kn.Mixin",g.extend({loadGPT:function(){if(!c.common.kn.Mixin.loadedGPT&&c.config&&c.config.getBoolean("ui.gpt.loadOnce",!0)||!window.googletag){c.common.kn.Mixin.loadedGPT=1;window.googletag||(window.googletag={cmd:[]});var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src="//www.googletagservices.com/tag/js/gpt.js";var f=document.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}window.googletag.cmd=window.googletag.cmd||
[]},loadAdsense:function(){window._googCsa||function(a,f,d,b,e,c){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)};a[b].t=1*new Date;e=f.createElement(d);c=f.getElementsByTagName(d)[0];e.async=1;e.src="//www.google.com/adsense/search/async-ads.js";c.parentNode.insertBefore(e,c)}(window,document,"script","_googCsa")},findAdDataForType:function(a,c,d){if(!(d&&a&&c&&d[a]))return null;var b,e;for(e in d[a])if(d[a].hasOwnProperty(e)){b=d[a][e];if("string"===typeof b)try{b=JSON.parse(b)}catch(k){b=
null}if(b&&b.pageLocation&&b.pageLocation===c)return b}return null}}))})(R9,jQuery,window.base2.Base);(function(f,g){f.createComponentClass("common.kn.DisplaySra",{options:{slots:null,slotKeyDelim:"",slotsLoadedTimerMS:400,deferGPTLoad:!1,deferUserInteractMS:3E3,eventsEnable:null,eventsDisable:null,lazyLoad:!1,lazyFetch:-999,lazyRender:-999,renderIfNotEmpty:!1,checkRegisteredSlotMatch:!0,altAdBlockedContent:!1,dataSharingOptOut:!1,useSafeFrameConfig:!1,hasCookieConsent:!1},enabled:1,delayedGptApiCt:0,hasSlots:0,pendingSlotInfo:null,registeredSlots:null,definedSlots:null,allSlotsRegistered:null,allSlotsRegisteredTimerID:null,
forceCheckSlotsRegisteredTimerID:null,allSlotsLoaded:null,boundSlotRenderedListener:null,boundWindowSmartAdResize:null,pageTargetingLast:null,dfpHideData:null,adBlocked:null,useSlotGroups:!1,intersectionObserver:null,observingSlots:null,waitingSlotGroups:null,init:function(){this.pendingSlotInfo=[];this.registeredSlots={};this.definedSlots={};this.hasSlots=g.isArray(this.options.slots)&&this.options.slots.length},addEventHandlers:function(){this.hasSlots&&(this.subscribe("displayad.sra.register",
this.onSraSlotRegisterEvent.bind(this)),this.subscribe("displayad.sra.unregisterAll",this.unregisterAllSlots.bind(this)),this.subscribe("displayad.sra.destroy",this.onSraSlotDestroyEvent.bind(this)),this.subscribe("displayad.sra.slots.broadcast",this.onSraSlotsBroadcast.bind(this)),this.subscribe("resultspage.adinfo.empty",this.publishAllAdsRequests.bind(this)),this.subscribe("resultspage.ads.update",this.onResultsPageAdsUpdate.bind(this)),this.subscribe("resultspage.ads.options",this.onResultsPageAdsPoll.bind(this)),
this.subscribe("adblock.detected",this.onAdBlockDetected.bind(this)),this.options.eventsEnable&&this.options.eventsEnable.pop&&this.options.eventsEnable.length&&(this.enabled=0,this.subscribe(this.options.eventsEnable,this.onSraEnable.bind(this))),this.options.eventsDisable&&this.options.eventsDisable.pop&&this.options.eventsDisable.length&&this.subscribe(this.options.eventsDisable,this.onSraDisable.bind(this)))},inlineComponentsReady:function(){if(this.hasSlots){f.events.publish("displayad.sra.slots.broadcast",
{owner:this,slots:[].concat(this.options.slots)});var a=this,b=f.question.ask("adblock.detected");if(b&&b.adblock)this.onAdBlockDetected();else this.options.deferGPTLoad?f.events.when("ajaxComponent.highPriority.initialized",function(){a.loadGPT()}):this.loadGPT()}},destroy:function(){g(window).off(this.getWindowMessageEventName());this.boundWindowSmartAdResize&&this.boundWindowSmartAdResize===window.resizeIframeToContents&&(window.resizeIframeToContents=null);this.boundWindowSmartAdResize=null;this.base();
this.cleanupSlots()},loadGPT:function(){this.loadedGPT||(this.loadedGPT=1,(new f.common.kn.Mixin).loadGPT())},onSraSlotDestroyEvent:function(a){if(a&&a.adDivId){var b=this;this.pendingSlotInfo=this.pendingSlotInfo.filter(function(b){return b&&b.adDivId!==a.adDivId});Object.keys(this.registeredSlots).forEach(function(c){c&&b.registeredSlots[c]&&b.registeredSlots[c].adDivId===a.adDivId&&delete b.registeredSlots[c]});this.destroyDefinedSlot(a.adDivId)}},destroyDefinedSlot:function(a){if(window.googletag){var b=
this;googletag.cmd.push(function(){b.definedSlots&&b.definedSlots[a]&&(b.intersectionObserver&&b.intersectionObserver.unobserve(document.getElementById(a)),b.observingSlots&&b.observingSlots.hasOwnProperty(a)&&delete b.observingSlots[a],googletag.destroySlots([b.definedSlots[a]]),delete b.definedSlots[a])})}},onSraSlotsBroadcast:function(a){a&&this!==a.owner&&g.isArray(a.slots)&&(this.options.slots=this.options.slots.filter(function(b){return 0>a.slots.indexOf(b)}),1>this.options.slots.length&&(this.hasSlots=
0,this.cleanupSlots(),this.registeredSlots={},this.pendingSlotInfo=[],this.enabled=this.allSlotsRegistered=0))},onSraEnable:function(){this.enabled||(this.enabled=1,this.checkLoadSlots(!1))},onSraDisable:function(){this.enabled&&(this.enabled=0,this.cleanupSlots())},setupPrivacyProcessing:function(){this.options.dataSharingOptOut&&googletag.pubads().setPrivacySettings({restrictDataProcessing:!0})},handleMissingOrigin:function(a){this.loggedMissingParams||(this.loggedMissingParams=1,a&&this.logError("Ad params without origin"))},
onSraSlotRegisterEvent:function(a){a&&a.adDivId?a.adBlockOptions?(this.augmentPageOptions(a),a.adBlockOptions.origin?this.updateSlotDataAndLoad(a):this.handleMissingOrigin(a.gptAdID)):a.isAvoidResults?this.logError("No ad targeting for non-results ad"):(this.pendingSlotInfo.push(a),this.publishOneAdsRequest(a)):this.logError("Missing adOptions ID")},publishAllAdsRequests:function(){var a=[];this.pendingSlotInfo&&this.pendingSlotInfo.length&&(a=this.pendingSlotInfo.filter(function(a){return a&&!a.isAvoidResults}));
a=a.concat(Object.values(this.registeredSlots).map(function(a){return a&&!a.isAvoidResults?a:null}));a.forEach(this.publishOneAdsRequest.bind(this))},publishOneAdsRequest:function(a){a&&!a.isAvoidResults&&f.events.publish("ads.request",{adType:"displayAd",pageLocation:a.pageLocation,now:!a.gptAdID,events:["searchform.submit","resultsHeader.changed","filters.changed","paginator.change"],minRefreshRate:this.options.minRefreshRate})},onResultsPageAdsUpdate:function(a){if(this.enabled){var b=this,c=new f.common.kn.Mixin,
d=function(a,c){Object.keys({gptAdID:null,gptTargetID:null,gptAdWidth:null,gptAdHeight:null,gptAdSizes:null,gptPageURL:null,adBlockOptions:null,pageOptions:null,slotGroup:0}).forEach(function(b){c.hasOwnProperty(b)&&"undefined"!==typeof c[b]&&(a[b]=c[b])});b.augmentPageOptions(a);return a};this.pendingSlotInfo&&this.pendingSlotInfo.length&&this.pendingSlotInfo.forEach(function(h){if(h){var k=c.findAdDataForType("displayAd",h.pageLocation,a);k&&k.adBlockOptions&&k.adBlockOptions.origin&&b.hasSlots&&
0<=b.options.slots.indexOf(b.makeSlotKey(k))&&b.updateSlotDataAndLoad(d(h,k))}});this.pendingSlotInfo.length&&(this.pendingSlotInfo=this.pendingSlotInfo.filter(function(a){return!Object.values(b.registeredSlots).some(function(b){return!b||a.adDivId===b.adDivId})}));this.pendingSlotInfo.length&&g.isEmptyObject(this.registeredSlots)&&this.pendingSlotInfo.some(function(a){return a&&!a.isAvoidResults})&&this.hasSlots?this.publishAllAdsRequests():Object.values(this.registeredSlots).forEach(function(h){var f=
c.findAdDataForType("displayAd",h.pageLocation,a);f&&b.updateSlotDataAndLoad(d(h,f))})}},makeSlotKey:function(a){var b=this.getAdSizes(a);return b[0][0]+"x"+b[0][1]+this.options.slotKeyDelim+a.pageLocation+this.options.slotKeyDelim+a.adBlockOptions.origin},updateSlotDataAndLoad:function(a){var b=this;f.globals.testMode&&f.events.publish("displayads.loading",a.adDivId);if(a&&a.adBlockOptions&&a.adDivId&&(a=g.extend({slotKey:this.makeSlotKey(a),adSize:this.getAdSizes(a),adDivId:a.adDivId,smartAd:null},
a),a.slotKey&&this.hasSlots&&!(0>this.options.slots.indexOf(a.slotKey)))){var c=this.registeredSlots[a.slotKey];c&&c.adDivId!==a.adDivId&&this.definedSlots&&this.definedSlots[c.adDivId]&&this.destroyDefinedSlot(c.adDivId);this.registeredSlots[a.slotKey]=g.extend({},a);!this.allSlotsRegistered&&0<this.options.slotsLoadedTimerMS&&(clearTimeout(this.allSlotsRegisteredTimerID),this.allSlotsRegisteredTimerID=setTimeout(function(){var a=f.question.ask("adblock.detected");a&&a.adblock||b.setAllSlotsRegistered()},
this.options.slotsLoadedTimerMS));this.checkLoadSlots(!1)}},onSlotRenderedEvent:function(a){this.enabled&&(f.events.publish("displayad.loaded",{slotElementId:a.slot.getSlotElementId()}),!0===this.options.renderIfNotEmpty&&!1===a.isEmpty&&(g("#"+a.slot.getSlotElementId()).show(),f.globals.testMode&&f.events.publish("displayads.container.show",a.slot.getSlotElementId())))},checkLoadSlots:function(a){if(this.enabled&&this.hasSlots){if(this.options.checkRegisteredSlotMatch&&!a)for(var b=0;b<this.options.slots.length;b++){if((a=
this.options.slots[b])&&!this.registeredSlots[a]){f.config.getBoolean("ui.ads.forceReloadUnregSlots",!0)&&(window.clearTimeout(this.forceCheckSlotsRegisteredTimerID),this.forceCheckSlotsRegisteredTimerID=window.setTimeout(this.checkLoadSlots.bind(this,!0),100));return}}else if(!this.registeredSlots||g.isEmptyObject(this.registeredSlots))return;this.setAllSlotsRegistered()}},unregisterAllSlots:function(){this.registeredSlots={};this.pendingSlotInfo=[];this.allSlotsRegistered=0;window.clearTimeout(this.allSlotsRegisteredTimerID);
window.clearTimeout(this.forceCheckSlotsRegisteredTimerID)},setAllSlotsRegistered:function(){this.allSlotsRegistered=1;window.clearTimeout(this.allSlotsRegisteredTimerID);window.clearTimeout(this.forceCheckSlotsRegisteredTimerID);this.loadAllSlots()},loadAllSlots:function(a){if(this.enabled){var b=this.adBlocked&&this.options.altAdBlockedContent;this.adBlocked&&!b?this.replaceAllAdBlockedSlots():window.googletag&&window.googletag.apiReady?a?(this.setupAllSlots(),this.allSlotsLoaded=1):this.deferUserInteractID?
this.handleDelayedSlotLoad(!1,!1):this.handleDelayedSlotLoad(!1,!0):this.handleDelayedSlotLoad(!0,!1)}},handleDelayedSlotLoad:function(a,b){var c=this,d=b;this.delayedSlotLoadID&&clearTimeout(this.delayedSlotLoadID);this.delayedSlotLoadID=setTimeout(function(){if(a&&(c.delayedGptApiCt+=1,100<=c.delayedGptApiCt)){var b=f.question.ask("adblock.detected"),k=c.options.altAdBlockedContent;100!==c.delayedGptApiCt||k||b&&b.adblock||f.Analytics.api.trackEvent({category:"sra",action:"error",label:"gptapi"});
if(k)d=!0;else return}c.loadAllSlots(d)},200)},onResultsPageAdsPoll:function(){if(this.options.deferUserInteractMS&&!g.isEmptyObject(this.definedSlots)){var a=this;this.deferUserInteractID&&clearTimeout(this.deferUserInteractID);this.deferUserInteractID=setTimeout(function(){a.deferUserInteractID=null},this.options.deferUserInteractMS)}},compareSlotOrder:function(a,b){a=parseInt(a&&a.adBlockOptions&&a.adBlockOptions.tile);b=parseInt(b&&b.adBlockOptions&&b.adBlockOptions.tile);return isNaN(a)?isNaN(b)?
0:1:isNaN(b)?-1:a-b},setupAllSlots:function(){var a=this,b,c=Object.values(this.registeredSlots),d=this.options.hasCookieConsent;f.config.getBoolean("ui.ads.orderSlots")&&(c=c.sort(this.compareSlotOrder));c.forEach(function(c){!c||a.pageTargetingLast&&a.sameObjectProperties(a.pageTargetingLast,c.pageOptions,["tile"])||(a.pageTargetingLast=g.extend({},c.pageOptions),b=c)});this.pageTargetingLast?"function"!==typeof googletag.pubads?this.logError("Bad googletag pubads"):(this.setWindowEvents(),googletag.cmd.push(function(){b&&
a.setupPageTargeting(b);googletag.pubads().setRequestNonPersonalizedAds(d?0:1);googletag.pubads().refresh();a.boundSlotRenderedListener||(a.boundSlotRenderedListener=a.onSlotRenderedEvent.bind(a),googletag.pubads().addEventListener("slotRenderEnded",a.boundSlotRenderedListener));f.globals.testMode&&googletag.pubads().addEventListener("slotOnload",function(a){f.events.publish("displayads.finishloading",a.slot.getSlotElementId())});c.forEach(function(b){b&&a.setupSlot(b);a.allSlotsLoaded&&(g("#"+b.adDivId).show(),
f.globals.testMode&&f.events.publish("displayads.container.show",e.slot.getSlotElementId()))});a.allSlotsLoaded?a.useSlotGroups?(a.waitingSlotGroups=!0,a.refreshSlotGroups()):googletag.pubads().refresh():(a.useSlotGroups&&googletag.pubads().disableInitialLoad(),googletag.enableServices(),Object.keys(a.definedSlots).forEach(function(a){a&&googletag.display(a)}),a.useSlotGroups&&(a.waitingSlotGroups=!0,a.refreshSlotGroups()))})):this.errPageOptions||(this.errPageOptions=1,this.logError("Missing slot data page options"))},
refreshSlotGroups:function(){var a=this,b=this.observingSlots,c,d,h;this.waitingSlotGroups&&(g.isEmptyObject(b)?this.waitingSlotGroups=this.waitingSlotGroups||!0:(c=Object.values(this.registeredSlots).filter(function(a){return a&&b[a.adDivId]}).map(function(a){return a.slotGroup||-1}).filter(function(b,c,d){return d.indexOf(b)===c&&(!0===a.waitingSlotGroups||0<=a.waitingSlotGroups.indexOf(b))}),c.length&&(d=[],c.forEach(function(b){d=d.concat(Object.values(a.registeredSlots).filter(function(a){return-1===
b?!a.slotGroup:a.slotGroup===b}).map(function(b){return a.definedSlots[b.adDivId]}))}),h=Object.values(this.registeredSlots).filter(function(a){return 0>c.indexOf(a.slotGroup||-1)}).map(function(a){return a.slotGroup||-1}).filter(function(a,b,c){return c.indexOf(a)===b}),h.length?!0===this.waitingSlotGroups?this.waitingSlotGroups=h:(this.waitingSlotGroups=this.waitingSlotGroups.filter(function(a){return 0<=h.indexOf(a)}),this.waitingSlotGroups.length||(this.waitingSlotGroups=!1)):this.waitingSlotGroups=
!1,d.length&&googletag.cmd.push(function(){googletag.pubads().refresh(d)}))))},onObserverEvent:function(a){var b=this;this.observingSlots&&a&&a.forEach(function(a){a&&a.target&&a.target.id&&(b.observingSlots[a.target.id]=a.isIntersecting)});this.refreshSlotGroups()},setupSlotGroupObserver:function(a){if(!(a.slotGroup&&"IntersectionObserver"in window))return!1;var b=document.getElementById(a.adDivId);if(!b)return!1;this.intersectionObserver||(this.intersectionObserver=new IntersectionObserver(this.onObserverEvent.bind(this),
{root:null,threshold:.1}),this.observingSlots={});this.observingSlots.hasOwnProperty(a.adDivId)||(this.observingSlots[a.adDivId]=!1,this.intersectionObserver.observe(b));return!0},augmentPageOptions:function(a){a&&a.pageOptions&&("undefined"===typeof a.pageOptions.xp&&(a.pageOptions.xp=f.globals.experiment),a.isAvoidResults&&"undefined"===typeof a.pageOptions.host&&(a.pageOptions.host="http://"+window.location.hostname))},setupPageTargeting:function(a){var b=window.googletag;b.pubads().clearTargeting();
b.pubads().enableSingleRequest();this.options.gptIframeTitle&&b.setAdIframeTitle(this.options.gptIframeTitle);this.options.isForceSafeFrame&&(this.options.altAdBlockedContent&&this.adBlocked?b.pubads().setForceSafeFrame(!1):(b.pubads().setForceSafeFrame(!0),this.options.useSafeFrameConfig&&b.pubads().setSafeFrameConfig({useUniqueDomain:!1})));this.setupPrivacyProcessing();if(this.options.lazyLoad){var c={};!isNaN(this.options.lazyFetch)&&-1<=this.options.lazyFetch&&(c.fetchMarginPercent=this.options.lazyFetch);
!isNaN(this.options.lazyRender)&&-1<=this.options.lazyRender&&(c.renderMarginPercent=this.options.lazyRender);b.pubads().enableLazyLoad(c)}a.gptPageURL&&b.pubads().set("page_url",a.gptPageURL);b.pubads().collapseEmptyDivs();Object.keys(a.pageOptions).forEach(function(c){c&&b.pubads().setTargeting(c,a.pageOptions[c])})},setupSlot:function(a){if(a&&a.adDivId&&a.adBlockOptions){var b=this.definedSlots[a.adDivId],c;b||(c=1,b=googletag.defineSlot(a.gptTargetID,a.adSize,a.adDivId));b?(this.setupSlotGroupObserver(a)&&
(this.useSlotGroups=!0),b.clearTargeting(),Object.keys(a.adBlockOptions).forEach(function(c){c&&b.setTargeting(c,a.adBlockOptions[c])}),c&&(b.addService(googletag.pubads()),this.definedSlots[a.adDivId]=b)):this.errSlotDefine||(this.errSlotDefine=1,this.logError("defineSlot failed"),f.globals.testMode&&f.events.publish("displayads.error",a.adDivId))}else this.errSlotOptions||(this.errSlotOptions=1,this.logError("Missing slot ID or data ad options"))},cleanupSlots:function(){this.boundSlotRenderedListener=
this.pageTargetingLast=null;this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null,this.useSlotGroups=!1,this.waitingSlotGroups=this.observingSlots=null);if(window.googletag&&googletag.cmd){var a=this;googletag.cmd.push(function(){var b=[];Object.keys(a.definedSlots).forEach(function(c){b.push(a.definedSlots[c]);delete a.definedSlots[c]});b.length&&googletag.destroySlots(b);a.definedSlots={};a.allSlotsLoaded=0})}},onAdBlockDetected:function(){this.adBlocked||
(this.adBlocked=1,this.replaceAllAdBlockedSlots())},replaceAllAdBlockedSlots:function(){if(this.enabled&&!this.options.altAdBlockedContent){var a=this;Object.values(this.registeredSlots).forEach(function(b){a.replaceAdBlockedContent(b)})}},replaceAdBlockedContent:function(a){var b,c=" width\x3d'%s' height\x3d'%s' ",d=a&&a.adDivId?g("#"+a.adDivId):null;a&&a.adBlockedURL&&a.gptAdID&&d?(b=this.getAdSizes(a),c=g.isArray(b)?b[0]&&g.isArray(b[0])?c.format(b[0][0],b[0][1]):c.format(b[0],b[1]):c.format(a.gptAdWidth,
a.gptAdHeight),d.html("\x3ciframe class\x3d'had-frame' frameborder\x3d'0' "+c+" scrolling\x3d'no' src\x3d'"+a.adBlockedURL+"'\x3e\x3c/iframe\x3e")):(d&&d.hide(),f.globals.testMode&&f.events.publish("displayads.container.hide",a.adDivId))},setWindowEvents:function(){var a=this,b=this.getWindowMessageEventName(),c;this.dfpHideData={};Object.values(this.registeredSlots).forEach(function(b){b&&b.adBlockOptions&&b.adBlockOptions.pos&&b.adBlockOptions.origin&&(c=b.adBlockOptions.origin.match(/\w+\.\w*\.(\w+)\./))&&
1<c.length&&c[1]&&(a.dfpHideData[c[1]+"."+b.adBlockOptions.pos+".NoAd"]=g.extend({},b))});g(window).off(b).on(b,this.onWindowMessage.bind(this))},getWindowMessageEventName:function(){return"message.displayad-"+this.id()},onWindowMessage:function(a){var b,c,d;this.enabled&&a&&a.originalEvent&&((c=this.options.smartAdWinMessageHosts||"")&&(c=c.replace(/(http(s)?:)?\/\//g,window.location.protocol+"//")),c+=","+window.location.protocol+"//"+window.location.host,this.dfpHideData&&a.originalEvent.data&&
this.dfpHideData[a.originalEvent.data]?(c=this.dfpHideData[a.originalEvent.data])&&c.adDivId&&(g("#"+c.adDivId).hide(),f.globals.testMode&&f.events.publish("displayads.container.hide",c.adDivId),f.config.getBoolean("ui.horizon.ads.trackCollapse",!0)&&f.Analytics.api.trackEvent({category:"sra",action:"adcollapse",label:c.pageLocation})):a.originalEvent.origin&&0<=c.indexOf(a.originalEvent.origin)&&this.options.smartAdWinMessageID&&a.originalEvent.data[this.options.smartAdWinMessageID]&&((d=a.originalEvent.data[this.options.smartAdWinMessageID].pos)?
(b=this,Object.values(this.registeredSlots).forEach(function(c){c.adBlockOptions&&d===c.adBlockOptions.pos&&b.kickoffSmartAd(a.originalEvent.data[b.options.smartAdWinMessageID],c)})):this.logError("No pos for smartad data: "+d)))},kickoffSmartAd:function(a,b){if(f.config.getBoolean("ui.horizon.ads.loadSmartAd",!0)&&a&&b&&b.adDivId&&(a.searchid||(a.searchid=this.options&&this.options.pageOptions?this.options.pageOptions.searchid:null),a.provider_code&&a.searchid)){var c=this.getSmartAdURL(a);if(c){this.boundWindowSmartAdResize||
(this.boundWindowSmartAdResize=this.onSmartAdGlobalResize.bind(this),window.resizeIframeToContents=this.boundWindowSmartAdResize);window.R9.Ads=window.R9.Ads||{};window.R9.Ads.SmartAd=window.R9.Ads.SmartAd||{slots:{R0:{},R1:{},M0:{}},adjustBannerContainerSize:g.noop()};var d="",h=b.adBlockOptions&&b.adBlockOptions.origin;"string"===typeof a.sz&&(d=(d=a.sz.split("x"))&&2===d.length&&parseInt(d[0])&&parseInt(d[1])?" width\x3d'"+d[0]+"' height\x3d'"+d[1]+"' ":"");b.smartAd=g.extend({rank:b.gptAdID?b.gptAdID.substr(b.gptAdID.length-
1,1):null,origin:h&&1<h.length?h.substr(h.length-2,2):null,reloaded:0,sized:0},a);this.subscriptions&&this.subscriptions["search.poll.response"]||this.subscribe("search.poll.response",this.onSmartAdSearchPoll.bind(this));g("#"+b.adDivId).html("\x3ciframe class\x3d'smartad-frame' frameborder\x3d'0' "+d+" scrolling\x3d'no' src\x3d'"+c+"'\x3e\x3c/iframe\x3e")}else f.Analytics.api.trackEvent({category:"smartad",action:"urlfail",label:b.pageLocation})}},onSmartAdSearchPoll:function(a){if(a&&a.completed){this.unsubscribe("search.poll.response");
var b=this;Object.values(this.registeredSlots).forEach(function(a){a&&a.smartAd&&!a.smartAd.reloaded&&(a.smartAd.reloaded=1,a.smartAd.sized=0,setTimeout(function(){a.smartAd&&g("#"+a.adDivId).find(".smartad-frame").attr("src",b.getSmartAdURL(a.smartAd,"false")+"\x26reload\x3d1")},100))})}},onSmartAdGlobalResize:function(){var a=this;Object.values(this.registeredSlots).forEach(function(b){a.resizeSmartAd(b)})},resizeSmartAd:function(a){if(a&&a.adDivId&&a.smartAd&&!a.smartAd.sized){var b=g("#"+a.adDivId),
c=b.find("iframe.smartad-frame").first(),d,h,k,l;if(c.length){try{d=c.contents().find("body")}catch(m){return}a.smartAd.sized=1;h=c.outerWidth();k=c.outerHeight();l=d.outerWidth();d=d.outerHeight();2>l||2>d?(b.hide(),f.globals.testMode&&f.events.publish("displayads.container.hide",a.adDivId)):(h!==l&&c.attr("width",l),k!==d&&c.attr("height",d),b.outerWidth()!==l&&(b.width("auto"),b.css("max-width","none")),b.outerHeight()!==d&&(b.height("auto"),b.css("max-height","none")))}}},getSmartAdURL:function(a,
b){if(!a)return null;"true"!==b&&"false"!==b&&(b="true");var c=a.rank||0,d=a.origin||"R0",h=a.provider_code?encodeURIComponent(a.provider_code):"",f=a.click_tracking?encodeURIComponent(a.click_tracking):"",g=a.sz?encodeURIComponent(a.sz):"";return"/h/ads/smartad?provider_code\x3d"+h+"\x26searchid\x3d"+a.searchid+"\x26clicktracking\x3d"+f+"\x26sz\x3d"+g+"\x26rank\x3d"+c+"\x26logimpr\x3d"+b+"\x26strm\x3d\x26pageorigin_location\x3d"+d+"\x26isstreaming\x3d"},getAdSizes:function(a){var b;a.gptAdSizes&&
(b=this.validateAdSizes(a.gptAdSizes));return b||this.validateAdSizes([parseInt(a.gptAdWidth),parseInt(a.gptAdHeight)])},validateAdSizes:function(a){var b=function(a){return!isNaN(a)&&0<a&&9999>a&&a===parseInt(a,10)},c=function(a){return a&&a.pop&&2===a.length&&b(a[0])&&b(a[1])};if(!a||!a.pop)return null;if(c(a))return a;for(var d=0;d<a.length;d++)if(!c(a[d]))return null;return a},sameObjectProperties:function(a,b,c){if(!a||!b)return!1;var d;c=c||[];for(d in a)if(a.hasOwnProperty(d)&&!b.hasOwnProperty(d))return!1;
for(d in b)if(b.hasOwnProperty(d)){if(!a.hasOwnProperty(d))return!1;if(!(0<=c.indexOf(d))&&a[d]!==b[d]){var f=a[d];if(f=f!==f)f=b[d],f=f!==f;if(!f)return!1}}return!0},logError:function(a){f.config.getBoolean("ui.ads.sra.log",!0)&&this.log.error(a)}})})(window.R9,window.jQuery);(function(a){a.createComponentClass("common.layout.SiteWideMessage",$.extend({},a.Common.RedirectMessage.prototype,{redirectMessage:void 0,options:{redirectFromTo:void 0,redirectFromToAlt:void 0,upgradeBrowserEnabled:!1},upgradeId:void 0,init:function(){var a=this;this.upgradeId=this.id("upgrade");this.containerId=this.id();this.redirectFromTo=this.options.redirectFromTo;this.redirectFromToAlt=this.options.redirectFromToAlt;this.updateRedirectUrl();this.bindRedirectAdt();this.answer("languageBar.height",
function(){return a.element.outerHeight(!0)})},addEventHandlers:function(){this.subscribe("frontdoor.view.changed",this.updateRedirectUrl.bind(this));null!==document.getElementById(this.upgradeId)&&a.ajax.execute("common/upgrade/UpgradeBrowser",{appendTo:this.upgradeId});this.registerEvent("click",this.element.find(".js-close"),function(){$(this).closest(".js-msgContainer").slideUp("slow");var a=$(this).attr("data-mc");setMetaCookie(a,!0)})}}))})(R9);function ConsentHandler(c){this.consentExpires=c&&0<=c.consentExpires?c.consentExpires:15552E6;this.declinedExpires=6048E5;this.CONSENT_NAME="DATA_CONSENT"}ConsentHandler.prototype.setConsentToCookie=function(c,d){d="undefined"===typeof d?!0:d;var a=new Date;a.setTime(a.getTime()+this.consentExpires);document.cookie=this.CONSENT_NAME+"\x3d"+d+";path\x3d/;expires\x3d"+a;c&&c({dataConsent:d})};
ConsentHandler.prototype.setDeclinedConsentCookie=function(c){var d=new Date;d.setTime(d.getTime()+this.declinedExpires);document.cookie=this.CONSENT_NAME+"\x3dfalse;path\x3d/;expires\x3d"+d;c&&c({dataConsent:!1})};ConsentHandler.prototype.getConsentFromCookie=function(){if(document.cookie){var c=this.CONSENT_NAME+"\x3dtrue";return document.cookie.split(";").some(function(d){return d&&d.trim&&d.trim()===c})}return!1};
ConsentHandler.prototype.getConsentCookieValue=function(){var c=this;if(document.cookie){var d=document.cookie.split(";").filter(function(a){return a&&a.trim&&0===a.trim().indexOf(c.CONSENT_NAME)});if(d.length)return"true"===d[0].trim().split("\x3d")[1]?!0:!1}return null};
(function(c,d){c.createComponentClass("common.tags.DataLayer",{ENDUSER_CONSENT_NAME:"DATA_ENDUSER_CONSENT",SHARING_CONSENT_NAME:"consent",consented:!1,ready:!1,consentHandler:null,consentEvents:null,gtmSourceSetup:!1,gtm:null,queue:null,options:{useStandardizedConsent:!1,oneTrustEnabled:!1,useConsentSetup:!1,consentExpires:0,noConsentDefersLoad:!1,isGtmUrlTrimmerEnabled:!1},affiliateDataLayerSchema:{common:"presentation placement locale vertical screenId eventName event currency dataConsent dataSharingOptOut kmkid".split(" "),
clickOut:["eventName","startDate","endDate","price"],expandDetails:["eventName","screenId","price"],flight:{results:"startDate endDate originAirportCode originCityName originCountryCode destinationAirportCode destinationCityName destinationCountryCode cabinClass roundTrip tripType totalTravelers adultTravelers youthTravelers childTravelers seatInfantTravelers lapInfantTravelers legs".split(" "),clickOut:"originAirportCode originCityName originCountryCode destinationAirportCode destinationCityName destinationCountryCode roundTrip tripType totalTravelers seniorTravelers adultTravelers youthTravelers childTravelers seatInfantTravelers lapInfantTravelers airlineName cabinClass legs".split(" ")},
hotel:{results:"rooms guests cityName countryCode hotelName adultTravelers childTravelers startDate endDate".split(" "),details:"hotelName starRating rooms guests cityName countryCode startDate endDate".split(" "),clickOut:"hotelName starRating rooms guests cityName countryCode startDate endDate".split(" ")},car:{results:"pickupTime dropoffTime sameLocation pickupAirportCode pickupCityName pickupCountryCode dropoffAirportCode dropoffCityName dropoffCountryCode".split(" "),clickOut:["carClass"]},packagetour:{results:"originAirportCode originCityName originCountryCode destinationAirportCode destinationCityName destinationCountryCode totalTravelers seniorTravelers adultTravelers youthTravelers childTravelers infantTravelers".split(" "),
clickOut:"originCityId originRegionName originRegionCode destinationCityId destinationRegionName destinationRegionCode hotelId brandName brandId parentBrandId".split(" ")},unknown:{}},init:function(a){c.globals.analytics.gtmDisabled||(this.queue=[],this.options.useStandardizedConsent||(this.options.useConsentSetup?(this.consentHandler=new ConsentHandler({consentExpires:this.options.consentExpires}),this.consented=this.consentHandler.getConsentFromCookie()):this.consented=!0),this.consentEvents=c.config.getString("ui.horizon.cookie.consent.events",
"").split(","),this.gtm=d(a)[0],d(this.gtm).on("load",d.proxy(this.onLoadIFrame,this)))},inlineComponentsReady:function(){c.globals.analytics.gtmDisabled||(!this.getConsent()&&this.options.noConsentDefersLoad||this.loadGtm(),c.question.ask("tags.dataLayer.hasCustomHandler")||this.updateDataLayer(this.getMainLayerParams()))},addEventHandlers:function(){if("undefined"!==typeof window.R9&&c.globals&&c.globals.analytics&&!0!==c.globals.analytics.gtmDisabled){var a=this;this.options.useStandardizedConsent?
this.subscribe(["gdpr.cookie.declined"].concat(this.consentEvents),this.onConsentChange.bind(this)):this.options.useConsentSetup&&(this.subscribe(this.consentEvents,this.consentSuccess.bind(this)),this.subscribe("gdpr.cookie.declined",this.declinedConsent.bind(this)));this.subscribe("sharing.cookie.update",this.sharingConsentUpdate.bind(this));c.events.subscribe("frontdoor.view.changed",function(){if(a.ready)try{var b=a.gtm.contentWindow,c=a.options.isGtmUrlTrimmerEnabled?"":parentDoc.title;if(b.history&&
b.history.replaceState){var d=location.origin,e=a.trimUrl(location.pathname);b.history.replaceState("",c,d+e+location.search)}b.document.title=c}catch(h){}});this.subscribe("tags.dataLayer.push",function(b){b=b||{};b.attachMainParams&&(b=d.extend(a.getMainLayerParams(),b));b.hasOwnProperty("dataConsent")||(b.dataConsent=a.getConsent());delete b.attachMainParams;b.affiliateGoogleTagManagerId&&""!==b.affiliateGoogleTagManagerId&&(b.dataConsent=a.getEndUserConsentFromCookie(),b=a.getAffiliateDataLayer(b));
c.config.getBoolean("ui.gtm.force.datalayer.presentation",!0)&&(b.presentation=a.options.apPresentation);a.updateDataLayer(b)});this.subscribe("gtm.enduser.consent",function(b){b&&(a.setEndUserConsentCookie(),a.loadGtm())});this.options.useStandardizedConsent||c.question.answer("horizon.cookie.consent.value",function(){return a.consentHandler.getConsentCookieValue()})}},onLoadIFrame:function(){setTimeout(this.processQueue.bind(this),1)},processQueue:function(){this.ready=!0;for(var a=0;a<this.queue.length;a++)this.queue[a]&&
this.updateDataLayer(this.queue[a])},cleanUndefinedVars:function(a){d.each(a,function(b,c){""!==c&&null!==c||delete a[b]})},updateDataLayer:function(a){a&&!a.hasOwnProperty("dataConsent")&&(a.dataConsent=this.getConsent());if(this.ready)try{this.log.console("updating data layer",a);var b=this.gtm.contentWindow;b.unifiedDataLayer||(b.unifiedDataLayer=[]);this.cleanUndefinedVars(a);b.unifiedDataLayer.push(a)}catch(l){}else this.queue.push(a)},onConsentChange:function(){this.updateDataLayer({dataConsent:this.getConsent()});
this.loadGtm()},consentSuccess:function(){var a=this;!this.consented&&this.consentHandler&&this.consentHandler.setConsentToCookie(function(b){a.consented=!0;a.updateDataLayer(b);a.loadGtm()})},declinedConsent:function(){var a=this;this.consentHandler&&this.consentHandler.setDeclinedConsentCookie(function(b){a.consented=!1;a.updateDataLayer(b);a.loadGtm()},!1)},sharingConsentUpdate:function(){this.updateDataLayer({dataSharingOptOut:this.getDataSharingOptOutFromCookieValue()});this.loadGtm()},isIframe:function(){try{return window.self!==
window.top}catch(a){return!0}},getDataSharingOptOutFromCookieValue:function(){if(document.cookie){var a=("; "+document.cookie).split("; "+this.SHARING_CONSENT_NAME+"\x3d");if(2===a.length)return 1===a.pop().split(";").shift()}return!1},getEndUserConsentFromCookie:function(){if(document.cookie){var a=this.ENDUSER_CONSENT_NAME+"\x3dtrue";return document.cookie.split(";").some(function(b){return b&&b.trim&&b.trim()===a})}return!1},setEndUserConsentCookie:function(){var a=new Date,b=0<=this.options.consentExpires?
this.options.consentExpires:15552E6;a.setTime(a.getTime()+b);document.cookie=this.ENDUSER_CONSENT_NAME+"\x3dtrue;path\x3d/;expires\x3d"+a},isEndUserConsent:function(){var a=this.getEndUserConsentFromCookie(),b=window;if(!a){var c=b.setInterval(function(){"parentIFrame"in b&&(b.clearInterval(c),c=null,b.parentIFrame.sendMessage({action:"getGTMEndUserConsent"}))},500);b.setTimeout(function(){c&&b.clearInterval(c)},15E3)}return a},trimUrl:function(a){if(this.options.isGtmUrlTrimmerEnabled){var b=a.indexOf("/"),
b=-1<b?a.substring(b+1).indexOf("/"):-1;if(-1<b)return a.substring(0,b+1)}return a},loadGtm:function(){if(!this.gtmSourceSetup){this.gtmSourceSetup=!0;var a=window.location,b="",c="",d=this.options.affiliateGTMEndUserConsentFeature,e=this.options.affiliateGoogleTagManagerId;if(e&&(b=-1<a.search.indexOf("?")?"\x26":"?",c="gtmid\x3d"+e,d&&this.isIframe()&&!this.isEndUserConsent())){this.gtmSourceSetup=!1;return}d=this.trimUrl(a.pathname);e=this.options.isGtmUrlTrimmerEnabled?"":a.hash;a="/ugtm{pathname}{search}{hash}{sign}{gtmid}".replace("{pathname}",
d).replace("{search}",a.search).replace("{hash}",e).replace("{sign}",b).replace("{gtmid}",c);this.gtm.src=a}},cloneDataLayer:function(a,b){var c={};a.forEach(function(a){b.hasOwnProperty(a)&&(c[a]=b[a])});return c},getAffiliateDataLayer:function(a){var b=c.globals.analytics||{},d=b.screenId||b.pageId||"unknown",f=b.vertical||"unknown",b=a.eventName||"screenView",e=this.affiliateDataLayerSchema,h=e.common||[],k="undefined"!==typeof e[f],d=k?e[f][d]:[],g={};k&&(h=h.concat(d),g=this.cloneDataLayer(h,
a),a.hasOwnProperty("presentation")&&(g.presentation=this.options.apPresentation),"clickOut"===b&&(f=e[b].concat(e[f][b]),g=this.cloneDataLayer(f,a)),"expandDetails"===b&&(g=this.cloneDataLayer(e[b],a)));return g},getMainLayerParams:function(){var a=c.globals.analytics||{},b=d.extend({},this.options,{vertical:a.vertical||"unknown",screenId:a.screenId||a.pageId||"unknown",subScreenId:a.subScreenId||a.subPageId,eventName:this.options.eventName||"screenView",dataConsent:this.getConsent(),placement:c.globals.placement||
"",presentation:this.options.apPresentation});["apPresentation","useConsentSetup","consentExpires","noConsentDefersLoad"].forEach(function(a){delete b[a]});return b},getConsent:function(){if(this.options.useStandardizedConsent)try{return window["@r9/gdpr"].hasConsented()}catch(a){return this.log.error("GDPR not available in DataLayer",a),!1}else if(this.options.useConsentSetup)return this.consentHandler.getConsentFromCookie();return!0}})})(R9,jQuery);(function(a,c){a.createComponentClass("common.privacy.StyleJamHeaderCookiesMessage",{options:{gdprEnabled:!1,ajaxComponent:"common/privacy/AjaxStyleJamHeaderCookiesMessage"},init:function(){var b=this.options.ajaxComponent||"common/privacy/AjaxStyleJamHeaderCookiesMessage",d={type:"GET",replace:!0,combinable:a.config.getBoolean("ui.horizon.common.header.cookieMessage.combinable",!1),cacheable:a.config.getBoolean("ui.horizon.common.header.cookieMessage.cacheable",!1)};if(this.options.gdprEnabled){var e=
window["@r9/gdpr"];e&&e.canShowConsentDialog()&&(b=a.config.getString("ui.horizon.common.gdpr.cookie.consent.dialog.url","common/gdpr/CookieConsentV2"),d={type:"GET",appendTo:c("body")})}this.toggleCookiesMessageLoading(!0);a.ajax.execute(b,d).always(this.toggleCookiesMessageLoading.bind(this,!1))},toggleCookiesMessageLoading:function(b){a.globals.testMode&&(b?c("body").attr("data-test-cookie-message-loading",""):c("body").removeAttr("data-test-cookie-message-loading"))}})})(window.R9,window.jQuery);(function(b,a){b.createComponentClass("common.currency.StyleJamCurrencyMessage",{options:{displayLater:!1,displayImmediately:!1,newMetaCookieActionEnabled:!1,localeCountryCode:"",cookieName:"hideCurrencyMessage"},isVisible:!1,closeBtn:void 0,init:function(b){this.closeBtn=a("#"+this.id("close"));this.options.displayImmediately?this.showMessage():this.options.displayLater&&(this.subscribe("resultspage.view.setvisible",a.proxy(this.showMessage,this)),this.subscribe("header.view.set",{view:"results"},
a.proxy(this.showMessage,this)),this.subscribe("pageContainers.changed",{state:"results"},a.proxy(this.showMessage,this)),this.subscribe("resultspage.routed",a.proxy(this.showMessage,this)))},addEventHandlers:function(){this.closeBtn.bind("click",a.proxy(this.close,this))},showMessage:function(){this.isVisible||(this.element.slideDown("slow"),this.options.newMetaCookieActionEnabled?b.action.execute("common/currency/HideCurrencyMessageAction",{lcc:this.options.localeCountryCode}):window.setMetaCookie(this.options.cookieName,
!0),this.isVisible=!0)},close:function(){this.element.slideUp("slow")}})})(window.R9,window.jQuery);(function(c,d){function h(a,b){if(a)for(var f=0,e=a.childElementCount;f<e;f++)if(a.children){var c=b?a.children[e-f-1]:a.children[f],g=c;if((g&&null!==g.getAttribute("tabindex")&&""!==g.getAttribute("tabindex")&&"-1"!==g.getAttribute("tabindex")||-1<k.indexOf(g.tagName)||"INPUT"===g.tagName&&"hidden"!==g.getAttribute("type"))&&d(g).is(":visible")||(c=h(c,b)))return c}}var k=["SELECT","A","BUTTON","TEXTAREA"];c.createWidgetClass("dialog.Dialog",{content:null,contentBody:null,closeButton:null,modalBackground:null,
focusBoundaries:null,initialFocus:null,lastFocus:null,options:{fullHeight:!1,customWidth:!1,modal:!0,blur:!1,onClose:null,onOpen:null,afterClose:null,afterOpen:null,initialFocusId:null,preventInitialFocus:!1,closeOnModalClick:!0,hasKeyboardControl:!0,openImmediately:!1,preventClose:!1,returnFocus:!0,scrollToTopOnMobile:!1,forceOpen:!1,renderInline:!1,isMobile:!1,isOpenTopZindex:!1,iframeResize:!0,iframeTopGapPercent:.08,preventClosingClickBubble:!1,isFullIframeViewportHeight:!1},topLevelComponent:null,
returnElement:null,init:function(){this.resizeEventName="resize."+this.id();this.content=this.getChildElement("content");this.contentBody=this.getChildElement("body");this.closeButton=this.getChildElement("close");this.modalBackground=this.getChildElement("modal");this.viewport=this.getChildElement("viewport");this.modal=this.getChildElement("modal");this.modalUniqueClass="modal-class-"+this.modal.attr("id")},addEventHandlers:function(){var a=this,b=this.closeOnModalClick.bind(this);this.options.preventClose||
(this.options.hasKeyboardControl&&(this.registerEvent("keydown",d(document),function(b){a.options.preventClose||b.which!==c.globals.keyCodes.ESC||a.close(!0)}),this.registerEvent("keypress",this.closeButton,function(b){if(!a.options.preventClose)switch(b.which){case c.globals.keyCodes.RETURN:a.close(!0)}})),this.registerEvent("click",this.closeButton,function(){a.options.preventClose||a.close(!0)}));this.options.closeOnModalClick&&this.registerEvent("click",this.viewport,b);this.registerEvent("click",
this.content,function(){a.viewport.off("click",b);setTimeout(function(){if(a.options.closeOnModalClick)a.viewport.on("click",b)},50)});this.subscribe("dialogs.close",function(){a.isOpen()&&a.close()});this.options.preventClosingClickBubble&&this.registerEvent("click",this.element,function(a){a.stopPropagation()});this.content.one("transitionend",function(){c.events.publish("dialog.transitionend",a.content.attr("class"))})},inlineComponentsReady:function(){var a=this;this.options.modal||this.modalBackground.hide();
this.topLevelComponent=this.contentBody.children("div").eq("0");this.options.renderInline&&d(c.config.getString("ui.horizon.output.container","body")).append(this.element);this.options.openImmediately?(this.element.addClass("animate"),c.dom.schedule(this.open.bind(this))):setTimeout(function(){a.element.addClass("animate")},100);this.getChildElement("focusStartBoundary").focus(this.resetFocus.bind(this,!1));this.getChildElement("focusEndBoundary").focus(this.resetFocus.bind(this,!0))},closeOnModalClick:function(a){a=
d(a.target).closest(".content");this.content[0]===a[0]||this.options.preventClose||this.close(!0)},calculateDimensions:function(){if(this.topLevelComponent&&this.topLevelComponent.length){var a=this.topLevelComponent[0].getBoundingClientRect(),b=this.content[0].getBoundingClientRect(),f="number"===typeof this.topLevelComponent.outerWidth()?Math.ceil(a.width):null,a="number"===typeof this.topLevelComponent.outerHeight()?Math.ceil(a.height):null;this.options.customWidth||f===Math.ceil(b.width)||this.content.width(f);
this.options.fullHeight||a===Math.ceil(b.height)||this.content.height(a)}},resetFocus:function(a){(a=a?this.closeButton:this.lastFocus?this.lastFocus:this.findFirstFocusableElement(!0))&&"function"===typeof a.focus&&a.focus();return!1},handleKeyPress:function(a){switch(a.which){case c.globals.keyCodes.ESC:this.close(!0)}},setContentDimensions:function(a,b,f){void 0!==a&&this.content.width(a);void 0!==b&&this.content.height(b);f&&this.content.css({maxWidth:f})},setViewPortOverflow:function(a,b){this.viewport&&
this.viewport.length&&(a&&this.viewport.css({overflowX:a}),b&&this.viewport.css({overflowX:b}))},setContent:function(a){this.contentBody.html(a);this.topLevelComponent=this.contentBody.children("div").eq("0")},close:function(a){var b=this;if(this.isOpen()&&!this.options.forceOpen){var f,e=d("body");this.isTouchDevice()&&(f=e.css("top").replace("-","").replace("px",""),e.css({overflow:"",position:"",width:""}));this.options.iframeResize&&window.parentIFrame&&"function"===typeof window.parentIFrame.getPageInfo&&
window.parentIFrame.getPageInfo(!1);e.scrollTop(f);this.element.removeClass("visible");this.element.attr("aria-hidden",!0);c.globals.testMode&&this.element.attr("data-test-popover-open",!1);if("function"===typeof this.options.onClose)this.options.onClose(this.element,a);c.events.publish("dialog.close",{id:b.id()});this.options.blur&&c.events.publish("pageContainer.contentBlur",!1);e.removeClass(this.modalUniqueClass);0>e.attr("class").indexOf("modal-class-")&&e.removeClass("hideOverflow modal-open");
this.returnElement&&this.returnElement.length&&(this.returnElement.focus(),this.returnElement=null);d(window).off(this.resizeEventName);setTimeout(function(){"function"===typeof b.options.afterClose&&b.options.afterClose()},50)}},open:function(a){if(!this.isOpen()){this.topLevelComponent&&0!==this.topLevelComponent.length||(this.topLevelComponent=this.contentBody.children("div").eq("0"));this.options.preventClose&&this.closeButton.hide();this.options.returnFocus&&(this.returnElement=d(document.activeElement));
if(this.options.isOpenTopZindex){var b=0;this.element.siblings("[role\x3ddialog],[role\x3dalertdialog]").each(function(){var a=window.parseInt(d(this).css("z-index"));a&&a>b&&(b=a)});0<b&&this.element.css("z-index",b+1)}c.events.publish(["common.dropdown.closeAll","common.widgets.tooltip.closeAll"]);this.element.addClass("visible");this.element.attr("aria-hidden",!1);c.globals.testMode&&this.element.attr("data-test-popover-open",!0);null===this.initialFocus&&this.setFocusTargets();this.options.preventInitialFocus||
this.focusInitialElement();this.options.iframeResize&&window.parentIFrame&&"function"===typeof window.parentIFrame.getPageInfo&&window.parentIFrame.getPageInfo(this.positionOnIframe.bind(this));if("function"===typeof this.options.onOpen)this.options.onOpen(this.element);"function"===typeof a&&a(this.element);this.modalBackground.length&&(d("body").addClass("hideOverflow modal-open"),d("body").addClass(this.modalUniqueClass));this.options.blur&&c.events.publish("pageContainer.contentBlur",!0);null!==
this.topLevelComponent&&setTimeout(this.calculateDimensions.bind(this),1);this.isTouchDevice()&&this.options.scrollToTopOnMobile&&d("body").css({overflow:"hidden",position:"fixed",width:"100%"});d(window).off(this.resizeEventName).on(this.resizeEventName,this.calculateDimensions.bind(this));"function"===typeof this.options.afterOpen&&this.options.afterOpen()}},positionOnIframe:function(a){if(a&&this.viewport){var b=a.clientHeight*this.options.iframeTopGapPercent,c=a.scrollTop,e=a.offsetTop,d=this.content.height(),
g=this.modal.height();a=a.clientHeight;var h=this.viewport.height();this.content.addClass("no-margin");this.options.isFullIframeViewportHeight&&d>a&&h!==a&&this.viewport.css("height",a);c<e?this.viewport.css("top",0):c-e<b?this.viewport.css("top",2*(c-e)+"px"):c-e+b+d>=g?this.viewport.css("top",g-d+"px"):this.viewport.css("top",c-e+Math.round(b)+"px")}},focusInitialElement:function(){var a=this;setTimeout(function(){var b=a.initialFocus&&a.initialFocus.get(0);b&&"function"===typeof b.focus&&b.focus()},
501)},setFocusTargets:function(){this.focusBoundaries=this.getChildElement("focusStartBoundary").add(this.getChildElement("focusEndBoundary"));this.initialFocus=this.findFirstFocusableElement(!1);this.lastFocus=this.findFirstFocusableElement(!0)},findFirstFocusableElement:function(a){if(this.options.initialFocusId&&!a)return d("#"+this.options.initialFocusId);a=h(this.contentBody[0],a);a||(a=this.closeButton);return d(a)},isOpen:function(){return this.element.hasClass("visible")},isTouchDevice:function(){return"ontouchstart"in
window||navigator&&navigator.maxTouchPoints},destroy:function(){this.base();this.content.off("transitionend");this.element.remove()}})})(R9,jQuery);(function(b,c){b.createComponentClass("common.errors.ErrorDialog",{dialog:null,dialogEl:null,title:null,messages:null,init:function(){this.dialogEl=this.getChildElement("dialog");this.dialog=this.dialogEl.dialog({}).getWidget();this.title=this.getChildElement("title");this.messages=this.getChildElement("messages")},addEventHandlers:function(){var a=this;this.subscribe("error.alert",this.show.bind(this));b.events.when("error.alert",this.show.bind(this));this.subscribe("error.dismiss",this.hide.bind(this));
this.getChildElement("close").on("click keydown",function(c){c.keyCode!==b.globals.keyCodes.TAB&&a.dialog.close()})},show:function(a){var b=this;a.title?(this.title.html(a.title),this.dialogEl.addClass("hasTitle")):(this.title.html(""),this.dialogEl.removeClass("hasTitle"));this.messages.html("");a.messages&&(c.isArray(a.messages)||(a.messages=[a.messages]),c.each(a.messages,function(a,d){a=c("\x3cli\x3e").html(d);b.messages.append(a)}));this.dialog.open()},hide:function(){this.dialog.close()}})})(R9,
jQuery);(function(b,c){b.createComponentClass("common.layout.StandardBody",{pageContentEl:null,allowMove:!1,noMoveClasses:{results:!0},stateClasses:{results:"ResultsPageBody"},options:{useReactHeaderV2:!1,isResponsivePage:!1,allowContentMove:!1},init:function(){this.options.useReactHeaderV2&&(this.pageContentEl=this.getChildElement("pageContent"),this.allowMove=this.options.isResponsivePage)},addEventHandlers:function(){this.options.useReactHeaderV2&&(this.options.allowContentMove||(this.subscribe(["header.view.set",
"pageContainers.changed"],function(a){Object.prototype.hasOwnProperty.call(this.noMoveClasses,a.view)&&(this.allowMove=!this.noMoveClasses[a.view],b.events.publish("page.layout.responsive.changed",{responsive:!1}),this.pageContentEl.removeClass("moved"))}.bind(this)),this.subscribe("resultspage.view.setvisible",function(){this.allowMove=!1;b.events.publish("page.layout.responsive.changed",{responsive:!1});this.pageContentEl.removeClass("moved")}.bind(this))),this.subscribe("navigation.drawer.open",
this.handleMovePageContent.bind(this)))},handleMovePageContent:function(a){this.allowMove&&this.pageContentEl.toggleClass("moved",!!a.open);a.isMobile&&c("body").toggleClass("hideOverflow modal-open",!!a.open)}})})(R9,jQuery);(function(a,d){a.createComponentClass("common.layout.momondo.StandardBody","common.layout.StandardBody",{stateClasses:{results:"ResultsPageBody"},modalOverlay:null,init:function(){this.base();this.modalOverlay=this.getChildElement("modalOverlay")},addEventHandlers:function(){this.base();var b=this;a.events.subscribe("modalOverlay.visible",function(c){b.modalOverlay.toggleClass("OverlayVisible",c.open);c.event&&b.modalOverlay.click(function(){a.events.publish(c.event)})});b.modalOverlay.click(function(){d(this).removeClass("OverlayVisible")})}})})(R9,
jQuery);(function(e,g){g.openTooltipInstances={};var b=!1;R9.extend("Widgets",{Tooltip:function(a,d){this.element=e(a);this.element.data(this.widgetName,this);this.setOptions(d,!0)}});R9.extend("Widgets.Tooltip",{validateElement:function(a){return void 0===e(a).data(this.prototype.widgetName)},getInstance:function(a,d){return this.validateElement(a)?new R9.Widgets.Tooltip(a,d):(a=e(a).data(this.prototype.widgetName),d?a.setOptions(d):a)},removeWidget:function(a){this.validateElement(a)||this.getInstance(a).removeWidget()},
setDebug:function(a){b=a},isDebug:function(){return b}});R9.extend("Widgets.Tooltip.prototype",{element:null,widgetNamespace:"r9-tooltip",widgetBaseClass:"r9-tooltip",widgetName:"tooltip",positionTarget:"data-tooltip-position-target",isOpen:!1,options:{delay:200,fadeIn:200,fadeOut:200,edgeOffset:3,baseClass:null,content:null,positionTarget:null,position:"top",activation:"hover",showImmediately:!1,subNameSpace:"",onOpen:null,fixedPositioning:null,onClose:null,positionUpdate:!1,appendTo:"body",offsetLeft:0,
offsetAgainstEdge:!0,keepOpenOnContentHover:!1,keepOpenOnPositionTargetHover:!1,readContentOnOpen:!1,keepOpenOnRelatedTargetHover:!0,closeDelay:0,fallbackPosition:null,forceDesiredPosition:!1},_timer:null,_closeTimer:null,_originalTitle:null,_positionUpdater:null,init:function(){this._removeAllWidgetBindings();openTooltipInstances.hasOwnProperty(this.options.subNameSpace)||(openTooltipInstances[this.options.subNameSpace]=null);var a=this,d=a._getContainerElement(),c=a._getArrowElement();switch(this.options.activation){case "click":this.element.on("click."+
this.widgetName,function(c){null===openTooltipInstances[a.options.subNameSpace]&&(a.isOpen=!1);a.isOpen?a.close(c):setTimeout(a.open.bind(a,c),0)});this.options.keepOpenOnContentHover||this.bindContainerHoverEvents();this.options.showImmediately&&this.element.trigger("click."+this.widgetName);break;case "focus":this.element.on("focus."+this.widgetName,function(c){a.open(c)});this.element.on("blur."+this.widgetName,function(c){a.close(c)});this.options.showImmediately&&this.element.trigger("focus."+
this.widgetName);break;default:this.element.on("mouseenter."+this.widgetName,function(c){a.triggeredMouseOpen=!0;clearTimeout(a._closeTimer);a.open(c)});var b=this.options.keepOpenOnPositionTargetHover?this._getPositionTarget():this.element;b.on("mouseleave."+this.widgetName,function(b){a.triggeredMouseOpen=!1;a.options.keepOpenOnRelatedTargetHover&&(e(b.relatedTarget).closest(d).length||e(b.relatedTarget).closest(c).length)||(a.options.closeDelay?a._closeTimer=setTimeout(function(){a.close(b)},a.options.closeDelay):
a.close(b))});if(R9.config&&R9.config.getBoolean("ui.common.widgets.tooltip.touchend",!0))b.on("touchend."+this.widgetName,function(){a.triggeredMouseOpen&&(a.triggeredMouseOpen=!1,b.off("click.touchendfix").on("click.touchendfix",function(){b.off("click.touchendfix");a.element.trigger("mouseenter."+a.widgetName)}))});this.options.showImmediately&&this.element.trigger("mouseenter."+this.widgetName);this.options.keepOpenOnContentHover&&this.bindContainerHoverEvents()}return this},bindContainerHoverEvents:function(){var a=
this;this._getContainerElement().on("mouseenter."+this.widgetName,function(){a.isOpen&&clearTimeout(a._closeTimer)}).on("mouseleave."+this.widgetName,function(d){a.isOpen&&!e(d.relatedTarget).closest(a._getArrowElement()).length&&(a._closeTimer=setTimeout(function(){a.close(d)},a.options.closeDelay))})},setOptions:function(a,d){a&&(this.options=e.extend({},this.options,a));(a||d)&&this.init();return this},open:function(a){var d=this.getContent(a);if(!d||this.isOpen)return this;var c=!1;openTooltipInstances[this.options.subNameSpace]&&
openTooltipInstances[this.options.subNameSpace]!==this&&(c=!0,openTooltipInstances[this.options.subNameSpace].close(a,c));var b=this._getWrapperElement(),f=this._getContainerElement(),h=this._getArrowElement();this.renderContent(d,f);this._resetElements(b,f,h);d=this._getPositionMap(b,h);this._updateArrowElement(d,h);this._updateWrapperElement(d,b);this._updateContainerElement(d,f);if(this.options.fixedPositioning){var k=this;Object.keys(this.options.fixedPositioning).forEach(function(a){b.css(a,
k.options.fixedPositioning[a])});b.css("position","fixed")}this._timer&&clearTimeout(this._timer);this._closeTimer&&clearTimeout(this._closeTimer);this.isOpen=!0;openTooltipInstances[this.options.subNameSpace]=this;if(this.options.delay){var m=this;this._timer=setTimeout(function(){m._open(b,a,c)},this.options.delay)}else this._open(b,a,c);this._positionUpdater&&clearInterval(this._positionUpdater);e(g).on("resize",e.proxy(this._updatePosition,this));return this},renderContent:function(a,d){d.html(a)},
close:function(a,d){if(!R9.Widgets.Tooltip.isDebug()){this._timer&&clearTimeout(this._timer);this._closeTimer&&clearTimeout(this._closeTimer);this._positionUpdater&&clearInterval(this._positionUpdater);e(g).off("resize",this._updatePosition);a=this._getWrapperElement();a.stop(!0,!0);this.isOpen=!1;openTooltipInstances[this.options.subNameSpace]=null;var c=this;this.options.fadeOut&&!d?a.fadeOut(this.options.fadeOut,function(){c._close()}):(a.hide(),this._close());return this}},getContent:function(a){var d=
this.element.attr("title");d&&(this._originalTitle=d,this.element.removeAttr("title"));return this.options.content?"function"==typeof this.options.content?this.options.content.call(this,a):this.options.content:this._originalTitle?this._originalTitle:null!=this.element.data("title")?this.element.data("title"):this.element.text()},removeWidget:function(){this._removeAllWidgetBindings();this.element.removeData(this.widgetName);this.close();return this},_updatePosition:function(){var a=this._getWrapperElement(),
d=this._getContainerElement(),c=this._getArrowElement(),b=this._getPositioning(a,c);this._updateArrowElement(b,c);"rtl"!==document.dir&&a.css({top:b.newWrapperTop+"px",left:b.newWrapperLeft+"px"});this._updateContainerElement(b,d)},_getWrapperElement:function(){var a=e("#"+this._getIdValue("-wrapper"));a.length||(a=this._createDOMElement("-wrapper"),this.options.readContentOnOpen?a.attr("role","alert"):a.attr("role","tooltip"),e(this.options.appendTo).append(a));return a},_getContainerElement:function(){var a=
e("#"+this._getIdValue("-container"));a.length||(a=this._createDOMElement("-container"),this._getWrapperElement().append(a));return a},_getArrowElement:function(){var a=e("#"+this._getIdValue("-arrow"));a.length||(a=this._createDOMElement("-arrow"),this._getWrapperElement().append(a));return a},_createDOMElement:function(a){var d=e("\x3cdiv\x3e\x3c/div\x3e").attr("id",this._getIdValue(a));this._setStyleClasses(d,a);return d},_removeAllWidgetBindings:function(){this.element.off("click."+this.widgetName).off("focus."+
this.widgetName).off("blur."+this.widgetName).off("mouseenter."+this.widgetName).off("mouseleave."+this.widgetName).off("touchend."+this.widgetName);return this},_getPositionTarget:function(){var a=this.options.positionTarget||this.element.attr(this.positionTarget);return a&&(a=this.options.positionTarget?e("#"+this.options.positionTarget):e(a,this.element),0<a.length)?a:this.element},_getOffsetInformation:function(a,d,c){var b=this._getPositionTarget();this.options.fixedPositioning&&this._getContainerElement();
var f=b.outerWidth(),h=b.outerHeight();a="width"===a?c.outerWidth():c.outerHeight();return{arrowSize:Math.round(a/2),elementWidth:f,elementHeight:h,wrapperWidth:d.outerWidth(),wrapperHeight:d.outerHeight(),offset:{top:Math.floor(b.offset().top-e(this.options.appendTo).offset().top),left:Math.floor(b.offset().left-e(this.options.appendTo).offset().left)}}},_getPositionMap:function(a,b){a.attr("style","").css({top:"-1000px",left:"-5000px",display:"block"});return this._getPositioning(a,b)},_getPositioning:function(a,
b,c){switch(c||this.options.position){case "bottom":return this._getBottomPositioning(a,b);case "left":return this._getLeftPositioning(a,b);case "right":return this._getRightPositioning(a,b);default:return this._getTopPositioning(a,b)}},_getCommonPositioningMap:function(){return{newArrowTop:0,newArrowLeft:0,newWrapperTop:0,newWrapperLeft:0,wrapperClass:""}},getLeftRightOffsetAgainstEdge:function(a,b,c){if(this.options.offsetAgainstEdge){var d=e(this.options.appendTo).offset(),f=d?d.left+e(this.options.appendTo).width():
e(this.options.appendTo).width(),h,k=null!=d&&a<d.left,g=!isNaN(f)&&a+c.wrapperWidth>f;k?h=Math.floor(d.left+this.options.edgeOffset):g&&(h=Math.floor(f-c.wrapperWidth-this.options.edgeOffset));if(k||g)b=b+a-h,a=h}return{wrapperLeft:a,arrowLeft:b}},_getTopPositioning:function(a,b){var c=this._getOffsetInformation("height",a,b),d=c.elementWidth/2,f="-top",h=c.wrapperHeight,k=c.offset.top-this.options.edgeOffset-c.arrowSize-c.wrapperHeight;if(!this.options.forceDesiredPosition&&0>=k){if(this.options.fallbackPosition&&
"top"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);f="-bottom";k=c.offset.top+c.elementHeight+this.options.edgeOffset+c.arrowSize;h=-1*c.arrowSize}a=this.getLeftRightOffsetAgainstEdge(c.offset.left+d-c.wrapperWidth/2+this.options.offsetLeft,c.wrapperWidth/2-c.arrowSize,c);return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(h),newArrowLeft:Math.round(a.arrowLeft),newWrapperTop:Math.round(k),newWrapperLeft:Math.round(a.wrapperLeft),
wrapperClass:f})},_getBottomPositioning:function(a,b){var c=this._getOffsetInformation("height",a,b),d=c.elementWidth/2,f="-bottom",h=-1*c.arrowSize,k=c.offset.top+c.elementHeight+this.options.edgeOffset+c.arrowSize;if(!this.options.forceDesiredPosition&&k+c.wrapperHeight>=jq(g).scrollTop()+e(g).height()){if(this.options.fallbackPosition&&"bottom"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);f="-top";k=c.offset.top-this.options.edgeOffset-c.arrowSize-
c.wrapperHeight;h=c.wrapperHeight}a=this.getLeftRightOffsetAgainstEdge(c.offset.left+d-c.wrapperWidth/2+this.options.offsetLeft,c.wrapperWidth/2-c.arrowSize,c);return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(h),newArrowLeft:Math.round(a.arrowLeft),newWrapperTop:Math.round(k),newWrapperLeft:Math.round(a.wrapperLeft),wrapperClass:f})},_getLeftPositioning:function(a,b){var c=this._getOffsetInformation("width",a,b),d=c.elementHeight/2,f=c.wrapperHeight/2,h="-left",k="rtl"===document.dir?
-c.arrowSize:c.wrapperWidth,g="rtl"===document.dir?c.offset.left+this.options.edgeOffset+c.arrowSize+c.elementWidth:c.offset.left-this.options.edgeOffset-c.arrowSize-c.wrapperWidth;if(!this.options.forceDesiredPosition&&0>=g){if(this.options.fallbackPosition&&"left"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);h="-right";g=c.offset.left+c.elementWidth+this.options.edgeOffset+c.arrowSize;k=-1*c.arrowSize}return e.extend(this._getCommonPositioningMap(),
{newArrowTop:Math.round(f-c.arrowSize),newArrowLeft:Math.round(k),newWrapperTop:Math.round(c.offset.top+d-f),newWrapperLeft:Math.round(g),wrapperClass:h})},_getRightPositioning:function(a,b){var c=this._getOffsetInformation("border-right-width",a,b),d=c.elementHeight/2,f=c.wrapperHeight/2,h="-right",k="rtl"===document.dir?c.wrapperWidth:-1*c.arrowSize,m="rtl"===document.dir?c.offset.left-c.wrapperWidth-c.arrowSize:c.offset.left+c.elementWidth+this.options.edgeOffset+c.arrowSize;if(!this.options.forceDesiredPosition&&
m+c.wrapperWidth>=e(g).width()){if(this.options.fallbackPosition&&"right"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);a=c.offset.left-this.options.edgeOffset-c.arrowSize-c.wrapperWidth;0<=a&&(h="-left",m=a,k=c.wrapperWidth)}return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(f-c.arrowSize),newArrowLeft:Math.round(k),newWrapperTop:Math.round(c.offset.top+d-f),newWrapperLeft:Math.round(m),wrapperClass:h})},_setStyleClasses:function(a,
b,c){a.attr("class","");this._addStyleClasses(a,b,c);return this},_addStyleClasses:function(a,b,c){b&&(a.addClass(this.widgetBaseClass+b),c&&a.addClass(this.widgetBaseClass+b+c),this.options.baseClass&&(a.addClass(this.options.baseClass+b),c&&a.addClass(this.options.baseClass+b+c)));return this},_updateWrapperElement:function(a,b){this._addStyleClasses(b,"-wrapper",a.wrapperClass);b.attr("style","");"number"===typeof a.newWrapperTop&&b.css("top",a.newWrapperTop+"px");"number"===typeof a.newWrapperLeft&&
b.css({left:a.newWrapperLeft+"px",right:""});return this},_updateArrowElement:function(a,b){this._addStyleClasses(b,"-arrow",a.wrapperClass);b.css({top:a.newArrowTop+"px"});b.css({left:a.newArrowLeft+"px",right:""});return this},_updateContainerElement:function(a,b){this._addStyleClasses(b,"-container",a.wrapperClass);this.options.updateContainerOnResize&&b.css({top:a.newArrowTop+5+"px",left:a.newArrowLeft-b.width()+"px"});return this},_getIdValue:function(a){return this.widgetNamespace+this.options.subNameSpace+
a},_open:function(a,b,c){var d=this;a.stop(!0,!0);var f=function(a){this.options.onOpen&&this.options.onOpen.call(this,a);this.options.positionUpdate&&(this._positionUpdater=setInterval(e.proxy(this._updatePosition,this),1E3/60))};this.options.fadeIn&&!c?a.fadeIn(this.options.fadeIn,function(){f.call(d,b)}):(a.show(),f.call(d,b));return this},_close:function(){this._originalTitle&&(this.element.attr("title",this._originalTitle),this._originalTitle=null);this.options.onClose&&this.options.onClose.call(this,
null);return this},_resetElements:function(a,b,c){this._setStyleClasses(a,"-wrapper");this._setStyleClasses(b,"-container");this._setStyleClasses(c,"-arrow");return this}})})(jq||jQuery,window);
(function(e,g){e.createWidgetClass("tip.ToolTip",g.extend({},e.Widgets.Tooltip.prototype,{contentContainer:null,boundEvents:null,orientationOffset:null,rtlOrientation:void 0,trackEventId:null,options:g.extend({},e.Widgets.Tooltip.prototype.options,{showImmediately:!1,baseClass:"coolTip",extraClass:null,delay:200,position:"top",fallbackPosition:null,forceDesiredPosition:null,orientation:"middle",orientationOffset:null,onDestroy:null,activation:"hover",subNameSpace:"",alwaysRendered:!1,color:"black",
size:"l",closeOnBodyClick:!0,destroyAfterClose:!1,content:"",isComponent:!1,target:null,positionTarget:null,updateContainerOnResize:!1,track:null,testAttributes:null,setAriaContext:!1,autoClose:null}),init:function(){this.base();if(this.options.alwaysRendered){this.contentContainer=this.getChildElement("rendered-content");var b=this.contentContainer.children().eq(0);b.attr({"data-test-popover-content":"","data-test-popover-open":this.options.showImmediately});this.setContent(b)}e.Widgets.Tooltip.prototype.init.call(this);
this.boundEvents={};this.rtlOrientation="rtl"===document.dir&&"middle"!==this.options.orientation?"start"===this.options.orientation?"end":"start":void 0;this.orientationOffset=this._getOrientationOffset()},addEventHandlers:function(){this.subscribe("common.widgets.tooltip.clearCloseTimers",this._clearCloseTimers.bind(this));var b=this;this.subscribe("common.widgets.tooltip.closeAll",function(){b.isOpen&&b.close()});this.subscribe("common.widgets.tooltip.closeSelf",b.options.subNameSpace,function(){b.isOpen&&
b.close()})},destroy:function(){if("function"===typeof this.options.onDestroy)this.options.onDestroy();this.options.fadeOut=!1;var b=this._getContainerElement();Object.keys(this.boundEvents).forEach(function(a){b.off(a,this.boundEvents[a])}.bind(this));this.isOpen&&this.close();this._removeAllWidgetBindings();this.element.removeData(this.widgetName);this.base()},bindComponent:function(){this.element.data("toolTip",this);this.element.data("widget")||this.element.data("widget",this);this._addTestAttributes(this.element,
"trigger");e.globals.testMode&&this.element.attr({"data-test-popover-widget":"","data-test-popover-triggerevent":this.options.activation});this.options.setAriaContext&&this.element.attr("aria-describedby",this._getWrapperElement().attr("id"))},bindEventHandler:function(b,a,d){b=b.replace(/\s|$/g,"."+this.id()+" ");this._getContainerElement().on(b,a,d);this.boundEvents[b]=a},setContent:function(b){this.options.content=b},renderContent:function(b,a){"string"===typeof b?e.Widgets.Tooltip.prototype.renderContent.call(this,
b,a):"object"===typeof b?g.contains(a,b)||(a.html(""),a.append(b)):this.log.errorInternal('Bad parameter passed to renderContent(): "content" param must be a String or a jQuery object');this._addTestAttributes(a,"content")},getOptionalTarget:function(b,a){return"string"===typeof b&&b.length?"#"===b[0]?g(b):g("#"+b):null!==b&&"object"===typeof b?g(b):a},_addTestAttributes:function(b,a){var d=this,c={};e.globals.testMode&&(c["data-test-popover-"+a]="");this.options.testAttributes&&Object.keys(this.options.testAttributes).forEach(function(a){var b=
/^data-/.test(a)?a:"data-"+a;c[b]=d.options.testAttributes[a]});b.attr(c)},_getOrientationOffset:function(){return null!==this.options.orientationOffset?this.options.orientationOffset:this.options.extraClass&&-1!==this.options.extraClass.indexOf("no-arrow")?0:{start:-15,middle:0,end:15}[this.rtlOrientation||this.options.orientation]},_getPositioning:function(b,a,d,c){d=d||this.options.position;var l=e.Widgets.Tooltip.prototype._getPositioning.call(this,b,a,d),f={top:0,left:0},h=this.orientationOffset*
(c?-1:1);if("middle"!==this.options.orientation){var k=this.rtlOrientation||this.options.orientation,m,n;c&&(k="start"===k?"end":"start");"left"===d||"right"===d?(n="top",m="outerHeight"):(n="left",m="outerWidth");var p=this.getOptionalTarget(this.options.positionTarget,this.element),r=p[m](),q=this._getWrapperElement()[m]();if(!c&&!this.options.forceDesiredPosition)if(c=p.offset()[n],p="scroll"+n.charAt(0).toUpperCase()+n.slice(1),"start"===k){if(c+q>g(window)[p]()+g(window)[m]())return this._getPositioning(b,
a,d,!0)}else if("end"===k&&c+r-q<g(window)[p]())return this._getPositioning(b,a,d,!0);b=r/2;q/=2;"start"===k?f[n]=Math.ceil(q-b+h):"end"===k&&(f[n]=Math.ceil(b-q+h))}l.newArrowTop-="rtl"===document.dir?-f.top:f.top;l.newArrowLeft-=f.left;l.newWrapperTop+="rtl"===document.dir?-f.top:f.top;l.newWrapperLeft+=f.left;return l},clearTrackEvent:function(){this.trackEventId&&(clearTimeout(this.trackEventId),this.trackEventId=null)},startTrackEvent:function(b){this.clearTrackEvent();if(b&&b.wait&&b.label){var a=
parseInt(b.wait);isNaN(a)||1>a||(this.trackEventId=setTimeout(this.triggerTrackEvent.bind(this,b),a))}},triggerTrackEvent:function(b){if(this.element&&this.element.hasClass("tooltip-open")&&b&&b.label){var a={category:b.category||"ToolTip",action:b.action||"open",label:b.label};b.hasOwnProperty("value")&&(a.value=b.value);e.Analytics.api.trackEvent(a)}},_open:function(b,a,d){var c=this,l="click."+this.id(),f=this._getContainerElement();e.Widgets.Tooltip.prototype._open.call(this,b,a,d);e.events.publish("common.widgets.tooltip.clearCloseTimers",
this.options.subNameSpace);this.element.addClass("tooltip-open");f.attr("aria-expanded",!0);e.globals.testMode&&this.element.add(f).attr("data-test-popover-open",!0);e.events.publish("common.widgets.tooltip.opened");var h=function(a){b[0].contains(a.target)||"click"===c.options.activation&&c.element[0].contains(a.target)||(g(document).off(l),c.close())};this.options.closeOnBodyClick&&setTimeout(function(){g(document).off(l).on(l,h)},1);this.options.track&&this.startTrackEvent(g.extend({wait:2E3},
this.options.track));this.options.autoClose&&this.closeAfter(this.options.autoClose)},_close:function(b){var a=this.getContent(),d=this._getContainerElement();this.options.alwaysRendered&&"object"===typeof a&&this.contentContainer.append(a);e.Widgets.Tooltip.prototype._close.call(this,b);this.element.removeClass("tooltip-open");d.attr("aria-expanded",!1);e.globals.testMode&&this.element.add(d).attr("data-test-popover-open",!1);this.options.closeOnBodyClick&&e.dom.schedule(function(){g(document).off("click."+
this.id())}.bind(this));this.options.track&&this.clearTrackEvent();this.options.destroyAfterClose&&this.destroy()},closeAfter:function(b){this._forceCloseTimer&&clearTimeout(this._forceCloseTimer);this._forceCloseTimer=window.setTimeout(this.close.bind(this),b)},_clearCloseTimers:function(b){b===this.options.subNameSpace&&clearTimeout(this._closeTimer)},_addStyleClasses:function(b,a,d){a&&(b.addClass(this.widgetBaseClass+a),d&&b.addClass(this.widgetBaseClass+a+d),this.options.baseClass&&(b.addClass(this.options.baseClass+
a),d&&b.addClass(this.options.baseClass+a+d)),this.options.color&&b.addClass("Color-"+this.options.color));this.options.extraClass&&b.addClass(this.options.extraClass);this.options.size&&b.addClass("size-"+this.options.size);e.Common.Utils.Browsers.isIE()?b.addClass("ie"):e.Common.Utils.Browsers.isChrome()&&(b.addClass("chrome"),a=e.Common.Utils.Browsers.getChromeVersion(),65!==a&&66!==a||b.addClass("chrome65"));return this},_getOffsetInformation:function(b,a,d){var c=this.getOptionalTarget(this.options.positionTarget,
this.element),e=c.outerWidth(),f=c.outerHeight(),c={top:Math.floor(c.offset().top-g(this.options.appendTo).offset().top),left:Math.floor(c.offset().left-g(this.options.appendTo).offset().left)};b="width"===b?d.outerWidth():d.outerHeight();return{arrowSize:Math.round(b/2),elementWidth:e,elementHeight:f,wrapperWidth:a.outerWidth(),wrapperHeight:a.outerHeight(),offset:c}},_removeAllWidgetBindings:function(){e.Widgets.Tooltip.prototype._removeAllWidgetBindings.call(this);this.options.setAriaContext&&
this.element.removeAttr("aria-describedby")}}))})(R9,jQuery);(function(g,d){g.createWidgetClass("tip.StyleJamTooltip",{presentations:{wrapper:"Tooltip__Wrapper Tooltip__Wrapper--fixed Tooltip__Wrapper--hidden",visible:"Tooltip__Wrapper--visible",hidden:"Tooltip__Wrapper--hidden",content:"Tooltip__Content",pointer:"Tooltip__Pointer",above:"Tooltip__Pointer Tooltip__Pointer--down",right:"Tooltip__Pointer Tooltip__Pointer--left",below:"Tooltip__Pointer Tooltip__Pointer--up",left:"Tooltip__Pointer Tooltip__Pointer--right"},$targetElem:null,$triggerElem:null,$tooltipElem:null,
$tooltipPointerElem:null,state:null,options:{targetElem:null,triggerElem:null,triggerEvent:"hover",position:"above",fallbackPosition:void 0,positionOffsetX:50,positionOffsetY:50,showDelay:0,hideDelay:1E3,content:null,preRendered:!1},init:function(){this.base();this.state={afID:null,scrolling:!1,scrollTicker:null,visible:!1,showTimeout:0,hideTimeout:0,widthSet:!1};this.$targetElem=d("#"+this.options.targetElem);this.$triggerElem=null!==this.options.triggerElem?d("#"+this.options.triggerElem):this.$targetElem;
this.$targetElem.length&&this.$triggerElem.length?(this.options.preRendered?(this.$tooltipElem=d("#"+this.id()),this.$tooltipPointerElem=this.getChildElement("pointer")):(this.$tooltipElem=d(this.createTooltipElement()),this.$tooltipPointerElem=this.$tooltipElem.children("#"+this.id("pointer"))),this.options.preRendered&&this.$tooltipElem.appendTo(d("body"))):console.warn("StyleJamTooltip: Couldn't locate target element with id: %s",this.options.targetElem)},addEventHandlers:function(){var a=this;
switch(this.options.triggerEvent){case "click":this.options.hideDelay=0;this.$triggerElem.on("click",function(){a.show()});d(document).on("click",function(b){if(a.state.visible){var c=a.$targetElem[0],e=a.$tooltipElem[0],c=b.target===c||a.isDescendant(c,b.target);b=b.target===e||a.isDescendant(e,b.target);c||b||a.hide()}});break;case "hover":this.$triggerElem.on("mouseenter",function(){a.show()}).on("mouseleave",function(){a.hide()}),this.$tooltipElem.on("mouseenter",function(){a.show()}).on("mouseleave",
function(){a.hide()});case "focus":this.$triggerElem.on("focus",function(){a.show()}).on("blur",function(){a.hide()})}this.setupOnScroll();this.subscribe("common.widgets.tooltip.closeAll",this.hide.bind(this))},createTooltipElement:function(){var a=document.createElement("div");a.setAttribute("id",this.id());a.setAttribute("class",this.getStlBlocks(this.presentations.wrapper));var b=document.createElement("div");b.setAttribute("class",this.getStlBlock(this.presentations.content));b.innerHTML=this.options.content;
var c=document.createElement("div");c.setAttribute("id",this.id("pointer"));c.setAttribute("class",this.getStlBlock(this.presentations.pointer));a.appendChild(b);a.appendChild(c);return a},setupOnScroll:function(){var a=this;this.registerEvent("scroll resize",d(window),function(){clearTimeout(a.state.scrollTicker);!a.state.scrolling&&a.state.visible&&(a.state.scrolling=!0,a.position());a.state.scrollTicker=setTimeout(function(){a.state.scrolling=!1;cancelAnimationFrame(a.state.afID)},150)})},show:function(){var a=
this;this.state.visible=!0;this.options.preRendered||this.$tooltipElem.appendTo(d("body"));this.state.widthSet||(this.$tooltipElem.width(this.$tooltipElem.width()),this.state.widthSet=!0);this.position();this.resetTimers();this.state.showTimeout=setTimeout(function(){a.swapClasses(a.$tooltipElem,a.presentations.hidden,a.presentations.visible)},this.options.showDelay)},hide:function(){var a=this;this.resetTimers();this.state.hideTimeout=setTimeout(function(){a.state.visible=!1;a.swapClasses(a.$tooltipElem,
a.presentations.visible,a.presentations.hidden);a.options.preRendered||a.$tooltipElem.remove()},this.options.hideDelay)},resetTimers:function(){clearTimeout(this.state.showTimeout);clearTimeout(this.state.hideTimeout)},position:function(){var a=this;this.state.scrolling&&(this.state.afID=requestAnimationFrame(function(){a.position()}));var b=this.$targetElem[0].getBoundingClientRect(),c=this.$tooltipElem[0].getBoundingClientRect(),e=this.$tooltipElem[0].currentStyle||window.getComputedStyle(this.$tooltipElem[0]);
c.x=c.left-parseFloat(e.marginLeft);c.width=c.width+parseFloat(e.marginLeft)+parseFloat(e.marginRight);c.height=c.height+parseFloat(e.marginTop)+parseFloat(e.marginBottom);b=this.getRenderPosition(this.options.position,b,c);this.$tooltipElem.css({top:b.y+"px",left:b.x+"px"})},getRenderPosition:function(a,b,c){var e=b.left+this.options.positionOffsetX/100*b.width-c.width/2,d=b.top+this.options.positionOffsetY/100*b.height-c.height/2,f={left:[d,b.left-c.width,this.getInnerHeight()-(d+c.height)],below:[e,
this.getInnerHeight()-(b.top+b.height+c.height),this.getInnerWidth()-(e+c.width)],right:[d,this.getInnerWidth()-(b.left+b.width+c.width),this.getInnerHeight()-(d+c.height)],above:[e,b.top-c.height,this.getInnerWidth()-(e+c.width)]};a=f[a].every(function(a){return 0<=a})?a:Object.keys(f).reduce(function(a,b){return f[a].map(function(a){return 0<a?0:a}).reduce(function(a,b){return a+b})>f[b].map(function(a){return 0<a?0:a}).reduce(function(a,b){return a+b})?a:b});a!==this.options.position&&this.options.fallbackPosition&&
(a=this.options.fallbackPosition);this.$tooltipPointerElem.attr("class","").addClass(this.getStlBlocks(this.presentations[a]));switch(a){case "above":return{x:e,y:b.top-c.height};case "right":return{x:b.left+b.width,y:d};case "below":return{x:e,y:b.top+b.height};case "left":return{x:b.left-c.width,y:d}}},isDescendant:function(a,b){for(b=b.parentNode;null!=b;){if(b==a)return!0;b=b.parentNode}return!1},getInnerWidth:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},
getInnerHeight:function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}})})(R9,jQuery);(function(c,d){c.createWidgetClass("tip.RichToolTip",{closeButton:null,subNameSpace:"-richToolTip",initialized:!1,options:{toolTipTarget:"",onHover:!1,lightTheme:!1,showCloseButton:!1,shouldShowImmediately:!0,hoverOpenDelay:200,closeOnBodyClick:!0},init:function(){this.options.showCloseButton&&(this.closeButton=this.getChildElement("closeButton"))},addEventHandlers:function(){var a=this;this.options.showCloseButton&&this.registerEvent("click",this.closeButton,function(){c.events.publish("common.widgets.tooltip.closeSelf",
a.subNameSpace)});this.subscribe("common.widgets.richToolTip.remoteInit",function(){a.initialized||a.remoteInit();a.initialized=!0})},remoteInit:function(){var a=d("#"+this.options.toolTipTarget),b=d("#"+this.options.toolTipTarget+"-rendered-content").children().eq(0);a.length&&b.length&&(a.toolTip({position:"right",orientation:"middle",activation:this.options.onHover?"hover":"click",color:this.options.lightTheme?"white":"black",role:"note",subNameSpace:this.subNameSpace,extraClass:"Common-Widgets-Tip-RichToolTip-tooltip-content",
content:b,showImmediately:this.options.shouldShowImmediately,delay:this.options.hoverOpenDelay,closeOnBodyClick:this.options.closeOnBodyClick,onOpen:this.onOpen}),this.options.shouldShowImmediately&&(a=JSON.stringify("false"),b=moment().add(1,"days").toDate().toUTCString(),document.cookie="day-of-week-new-user\x3d"+a+"; path\x3d/; expires\x3d"+b))},onOpen:function(){var a=d(this.getContent().find("button"));a.length&&this.registerEvent("click",a,function(){c.events.publish("common.widgets.tooltip.closeSelf",
"-richToolTip")})}})})(R9,jQuery);(function(c,e){c.createComponentClass("common.seo.SeoMetaTags",{addEventHandlers:function(){this.checkForAdWordsSearch()},checkForAdWordsSearch:function(){c.globals.isSeo&&this.subscribe("cmp2.rendering.finished",function(a){if(a&&a.items&&a.items.length){if(a=window.location.search.substring(1)){a=a.split("\x26");var b=c.config.getString("ui.cmp2.dynamic.search.ads","");if(b)for(var b=b.split(","),d=0;d<b.length;d++)if(-1<a.indexOf("a\x3d"+b[d])){c.events.publish("cmp2.checkAll");break}}this.destroy()}}.bind(this))}})})(R9,
jQuery);(function(e,d){e.createComponentClass("common.core.FastlyTiming",{options:{runTest:!1,measurementUrl:"/fastly-timer",logUrl:"/s/run/fastlytimerlog"},init:function(){this.options.runTest&&this.runTimingRequest()},runTimingRequest:function(){d.ajax({type:"POST",url:this.options.measurementUrl,success:this.logResult.bind(this)})},logResult:function(c,a,b){b&&c&&c.cluster&&(a=b.getResponseHeader("x-served-by"),b=b.getResponseHeader("x-timer"),a&&b&&(a=a.split(" "),a=a[a.length-1].split("-"),d.ajax({type:"POST",
url:this.options.logUrl,data:{cluster:c.cluster,timer:b,fastlyNode:a[a.length-1]}})))}})})(R9,jQuery);(function(b,e){var f=function(a){if(a){a=a.charAt(0).toUpperCase()+a.slice(1);var b="s"===a.slice(-1)?a.slice(0,-1):a;return"."+a+"-Results-"+b+"ResultsPage"}},g=void 0!==window.history.pushState,h=[b.globals.keyCodes.UP,b.globals.keyCodes.DOWN,b.globals.keyCodes.LEFT,b.globals.keyCodes.RIGHT,b.globals.keyCodes.TAB];b.createComponentClass("base.search.SearchPage",{options:{msg:{resultPageTitle:""},isFD:!0,lazyLoadRP:!1,pageVertical:"",analyticsVertical:"",preloadResourcesForRP:!1,resultsPageComponentsMap:{},
addClassDuringTransition:!0,staticViewportMetaTag:""},rpLoaded:!1,rpRequest:null,init:function(a){this.rpContainer=this.getChildElement("rp");this.options.isFD?this.options.lazyLoadRP&&this.preloadComponents():this.rpLoaded=!0;""!==this.options.msg.resultPageTitle&&(document.title=this.options.msg.resultPageTitle)},addEventHandlers:function(a){var c=this;this.subscribe("pageContainer.contentBlur",function(a){c.element.toggleClass("Blur",a)});a=this.handleSearchSubmit.bind(this);a.priority=1;this.subscribe(["searchform.submit",
"multilocale.search.submit"],a);this.subscribe("omni.vertical.changed",function(a){c.cleanupResultsPage();c.abortActiveResultsPageRequest();b.config.getBoolean("ui.horizon.omni.loadRpOnVerticalChange",!0)&&c.options.resultsPageComponentsMap&&c.options.resultsPageComponentsMap.hasOwnProperty(a)&&c.loadResultsPageComponent(a)});b.question.answer("SearchPage.view",function(){return c.options.isFD?"FD":"RP"});b.config.getBoolean("ui.keyboard.show-focus",!0)&&this.bindAccessibilityHandlers();if(b.config.getBoolean("ui.horizon.modal.no-ad-click",
!0)){var d=this.element;this.subscribe(["InputModal.opened","Select.opened","DatePicker.opened","DropdownDialog.open"],function(){d.addClass("modalOpen")});this.subscribe(["InputModal.closed","Select.closed","DatePicker.closed","DropdownDialog.close"],function(){d.removeClass("modalOpen")})}},abortActiveResultsPageRequest:function(){this.rpTimerId&&clearTimeout(this.rpTimerId);this.rpRequest&&(this.rpRequest.abort(),delete this.rpRequest)},handleSearchSubmit:function(a){a.url&&a.url.startsWith("http")&&
(window.location=a.url);this.abortActiveResultsPageRequest();var b=a.url&&a.url.startsWith("/")?a.url:"/"+a.url;this.useSamePageTransition(a)?(window.history.pushState({view:"rp"},"",b),this.options.isFD&&this.switchToRP()):window.location.href=b},useSamePageTransition:function(a){return!a.navigateToResults&&g&&this.rpLoaded&&this.isCorrectRpLoaded(a.vertical)&&!b.authentication.needsRefresh},getAdditionalRPBodyClass:function(){return"wide"},getRPBodyClass:function(){var a=this.getAdditionalRPBodyClass(),
b=(document.body.getAttribute("class")||"").split(" ");-1!==b.indexOf("react")&&(a+=" react");-1!==b.indexOf("react-st")&&(a+=" react-st");return a},switchToRP:function(a){b.Analytics.api.setVertical(this.options.analyticsVertical);b.Analytics.api.setPageId("results");"requestId"in b.globals&&(b.globals.requestId=b.globals.requestId.replace("frontdoor","results").replace("main",b.globals.vertical||this.options.analyticsVertical));var c=this;window.setTimeout(function(){b.events.publish("frontdoor.view.changed",
{view:"inline"});c.element.removeClass("vm-fd");c.element.addClass("vm-rp");b.events.publish("resultspage.view.setvisible",!0);b.events.publish("header.view.set",{view:"results"});b.events.publish("pageContainers.changed",{state:"results"});c.options.addClassDuringTransition?b.events.publish("body.addClass",c.getAdditionalRPBodyClass()):b.events.publish("body.setClass",c.getRPBodyClass());b.events.publish("HorizontalFilterList.setClass");b.events.publish("resultspage.routed",!0);c.rpContainer.removeClass("hiddenFD");
c.options.isFD=!1;c.options.staticViewportMetaTag&&document.querySelector('meta[name\x3d"viewport"]').setAttribute("content",c.options.staticViewportMetaTag);c.cleanupFrontDoor()},10)},preloadComponents:function(){var a=this;if(this.options.lazyLoadRP){var c=function(){b.globals.vertical===a.options.pageVertical&&a.loadResultsPageComponent(a.options.pageVertical)};"complete"===document.readyState?c():b.events.when("page.initialized",c)}e(document).ready(function(){a.element.hasClass("vm-fd")&&a.options.preloadResourcesForRP&&
b.resources.preload("common.booking","styles")})},loadResultsPageComponent:function(a){var c=this.options.resultsPageComponentsMap[a];if(c&&c.component){this.abortActiveResultsPageRequest();this.cleanupResultsPage();var d=this;this.rpTimerId=setTimeout(function(){d.rpRequest=b.ajax.execute(c.component,{appendTo:d.rpContainer});d.rpRequest.then(function(){d.rpLoaded=!0;b.globals.vertical=a;d.options.analyticsVertical=c.analyticsVertical;delete d.rpRequest})},100)}},cleanupResultsPage:function(){b.ComponentManager.remove(this.rpContainer,
!1);this.rpContainer&&this.rpContainer.empty();this.rpLoaded=!1},cleanupFrontDoor:function(){var a=this;setTimeout(function(){b.ComponentManager.remove(a.id("fd"))},800)},isCorrectRpLoaded:function(a){return 1===this.getChildElement("rp").find(".Base-Results-ResultsPage").length&&1===this.getChildElement("rp").find(f(a)).length},bindAccessibilityHandlers:function(){this.toggleKeyboardFocus(!1);e(document).on("keydown.ada",function(a){!b.globals.keyboardNav&&-1<h.indexOf(a.keyCode)&&this.toggleKeyboardFocus(!0)}.bind(this));
e(document).on("mousemove.ada",this.toggleKeyboardFocus.bind(this,!1))},toggleKeyboardFocus:function(a){b.globals.keyboardNav=a?!0:!1}})})(R9,jq||jQuery);(function(a,b){a.createComponentClass("flights.search.FlightSearchPage","base.search.SearchPage",{options:{preloadResourcesForRP:a.config.getBoolean("ui.horizon.searchpage.flights.preloadStyles",!0)}})})(R9,jQuery);function validateEmail(a){if(!a||!a.match)return!1;a=a.match(/^[A-Z0-9._%+-]{1,63}@(?:[A-Z0-9-]+\.){1,125}[A-Z]{2,63}$/i);return!!(a&&a[0]&&a[0].length)}function replaceArgs(){for(var a=arguments[0],b=1;b<=arguments.length;b++)a=a.replace("{"+(b-1)+"}",arguments[b]);return a}R9.metacookie=R9.metacookie||{};R9.metacookie.saveQueue=R9.metacookie.saveQueue||[];
function saveQueuedMetaCookie(){if(0!=R9.metacookie.saveQueue.length){var a=R9.metacookie.saveQueue[0];jq.ajax({type:"POST",url:"/k/cookie",data:{action:"setmeta",metacookie:a.name,metavalue:a.value,formtoken:R9.globals.formtoken},complete:function(){R9.metacookie.saveQueue.shift();saveQueuedMetaCookie()},success:function(){a.callback()}})}}function setMetaCookie(a,b,c){R9.metacookie.saveQueue.push({name:a,value:b,callback:c||jq.noop});1==R9.metacookie.saveQueue.length&&saveQueuedMetaCookie()}
function deleteMetaCookie(a,b){"function"!==typeof b&&(b=$.noop);jq.ajax({type:"POST",url:"/k/cookie",data:{action:"deletemeta",metacookie:a,formtoken:R9.globals.formtoken},success:b})}jq.ajaxPrefilter("script",function(a){a.cache=!0});(function(c){c.createComponentClass("common.core.RealUserMeasurementsComponent",{options:{fullstoryEnabled:!1},trackedSubmit:!1,addEventHandlers:function(){this.base();this.subscribe("searchform.submit",this.onSearchSubmit.bind(this))},onSearchSubmit:function(a){if(!this.trackedSubmit&&this.options.fullstoryEnabled&&window&&"FS"in window&&a&&a.vertical){this.trackedSubmit=!0;a="did"+this.fixCase(a.vertical)+"Search_bool";var b={};b[a]=!0;FS.setUserVars(b)}},fixCase:function(a){return a.toLowerCase().replace(/(^| )(\w)/g,
function(a){return a.toUpperCase()})}})})(R9);(function(a,c){a.createComponentClass("common.core.MarketingId",{options:{syncUrl:"/s/run/kmkid/sync",setUrl:"/s/run/kmkid/set",suggestedKmkid:null,masterHost:null,runSyncScript:!1},init:function(){this.options.runSyncScript&&this.runSyncAndSet()},runSyncAndSet:function(){c.ajax({type:"POST",url:this.options.masterHost+this.options.syncUrl,data:{suggestedKmkid:this.options.suggestedKmkid},xhrFields:{withCredentials:!0},success:this.onSyncFinished.bind(this)})},onSyncFinished:function(b){b&&(window.R9&&
a.globals&&a.globals.analytics&&a.globals.analytics.pixelContext&&(a.globals.analytics.pixelContext.kmkid=b.kmkid),this.runSet(b.kmkid))},runSet:function(b){c.ajax({type:"POST",headers:{"X-CSRF":a.globals.formtoken},url:this.options.setUrl,data:{kmkid:b}})}})})(R9,jQuery);(function(d,f,e,c){d.createComponentClass("common.core.FullyInvisibleCaptcha",{options:{enabled:!1},init:function(){var a=this;this.options.enabled&&(this.setupCaptchaCallback(),this.initAPI().then(function(){a.fireCaptcha()}))},setupCaptchaCallback:function(){var a=this;c.onReCaptchaSubmit=function(b){a.captchaResult(b)};c.onReCaptchaError=function(a){console.log(a)}},initAPI:function(){var a=f.Deferred();c.recaptchaReady=function(){a.resolve()};var b=e.createElement("script");b.type="text/javascript";
b.async=!0;b.src="https://www.google.com/recaptcha/api.js?onload\x3drecaptchaReady\x26render\x3dexplicit";e.getElementById("recaptcha-root").appendChild(b);return a},fireCaptcha:function(){"undefined"!==typeof grecaptcha&&(grecaptcha.render("captcha",{},!0),grecaptcha.execute())},captchaResult:function(a){d.action.execute("common.core.FullyInvisibleCaptchaAction",{data:a})}})})(R9,jQuery,document,window);(function(e,d){e.createComponentClass("common.core.FastlyTiming",{options:{runTest:!1,measurementUrl:"/fastly-timer",logUrl:"/s/run/fastlytimerlog"},init:function(){this.options.runTest&&this.runTimingRequest()},runTimingRequest:function(){d.ajax({type:"POST",url:this.options.measurementUrl,success:this.logResult.bind(this)})},logResult:function(c,a,b){b&&c&&c.cluster&&(a=b.getResponseHeader("x-served-by"),b=b.getResponseHeader("x-timer"),a&&b&&(a=a.split(" "),a=a[a.length-1].split("-"),d.ajax({type:"POST",
url:this.options.logUrl,data:{cluster:c.cluster,timer:b,fastlyNode:a[a.length-1]}})))}})})(R9,jQuery);(new R9.logger).timeEnd("combined");
//# sourceMappingURL=https://www.kayak.com/s/horizon/source-maps/combined.js.map?v=823563ccf535e79d0679cf633afa2f3a78fefc9f-keel-headings-update
