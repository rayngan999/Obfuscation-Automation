function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,a)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}define("components/rentalsTabbedBookingWidget/store/reducer",["services/utilities","components/rentalsTabbedBookingWidget/store/actions","components/rentals/constants"],function(e,r,t){var a="MM/DD/YYYY",n=r.types,u=t.BookingType,i=t.BikeRentalLength,o=t.deliverySameDayCutoffTime,p={getInitialIsDelivery:function(e){return e.SetDeliveryOptionAsDefault&&!e.IsPickUpOnly},getCalendarDatesGroup:function(e,r,t){return r===i.HALF_DAY_MORNING?e.HalfDayMorningCalendarDatesGroup:r===i.HALF_DAY_AFTERNOON?e.HalfDayAfternoonCalendarDatesGroup:t?e.DeliveryCalendarDatesGroup:e.FullDayCalendarDatesGroup},getInitialPickupDate:function(r,t){if(!r.IsSeasonOpen)return null;if(!(t?r.HasDeliveryDates:r.HasPickupDates))return null;var n=p.getCalendarDatesGroup(r,i.FULL_DAY,t);return e.formatDate(n.StartDate,a,a)},setCalendarDates:function(e,r){if(!(e.bookingType==u.DELIVERY?r.HasDeliveryDates:r.HasPickupDates))return e.pickupDate=null,void(e.returnDate=null);e.pickupDate=e.pickupDate||e.currentCalendarDatesGroup.StartDate;var t=_.contains(e.currentCalendarDatesGroup.BlackoutDates,e.pickupDate),a=moment(e.pickupDate),n=a.isBefore(e.currentCalendarDatesGroup.StartDate)||a.isAfter(e.currentCalendarDatesGroup.EndDate);(t||n)&&(e.pickupDate=e.currentCalendarDatesGroup.StartDate,e.returnDate=null)},getDeliveryReturnDate:function(e,r,t){var a=moment(t,"LT"),n=moment(o,"LT");return(a.isSame(n)||a.isAfter(n))&&moment(e).isSame(r)?null:r}};return{Reducer:function(r,t){var o=t.componentId;if(!o)return r;var l=_objectSpread({},r[o]),s=t.dependencies.viewModels[o];switch(t.type){case n.SET_BOOKING_TYPE:l.bookingType=t.payload,l.currentCalendarDatesGroup=p.getCalendarDatesGroup(s,r.bikeRentalLength,t.payload===u.DELIVERY),p.setCalendarDates(l,s),l.bookingType===u.DELIVERY?l.returnDate=p.getDeliveryReturnDate(l.pickupDate,l.returnDate,l.deliveryTime):l.bookingType===u.PICKUP&&l.pickupAfter3&&moment(l.pickupDate).isSame(l.returnDate)&&(l.returnDate=null);break;case n.SET_PICKUP_DATE:l.pickupDate=e.formatDate(t.payload,a,a),l.pickupErrorMessage=null,moment(l.pickupDate).isSame(l.currentCalendarDatesGroup.EndDate)&&(l.pickupAfter3=!1),(!l.returnDate&&moment(l.pickupDate).isSame(l.currentCalendarDatesGroup.EndDate)||l.returnDate&&moment(l.pickupDate).isAfter(l.returnDate)||l.bikeRentalLength!==i.FULL_DAY)&&(l.returnDate=l.pickupAfter3?moment(l.pickupDate).add(1,"days").format(a):l.pickupDate,l.returnErrorMessage=null),l.returnDate&&l.pickupAfter3&&moment(l.pickupDate).isSame(l.returnDate)&&(l.pickupAfter3=!1,l.returnDate=l.pickupDate,l.returnErrorMessage=null),l.bookingType===u.DELIVERY&&(l.returnDate=p.getDeliveryReturnDate(l.pickupDate,l.returnDate,l.deliveryTime));break;case n.SET_RETURN_DATE:l.returnDate=null===t.payload?null:e.formatDate(t.payload,a,a),l.returnErrorMessage=null;break;case n.SET_ERROR_MESSAGES:l.returnErrorMessage=t.payload.returnErrorMessage,l.pickupErrorMessage=t.payload.pickupErrorMessage,l.deliveryTimeErrorMessage=t.payload.deliveryTimeErrorMessage;break;case n.SET_DELIVERY_TIME:l.deliveryTime=t.payload,l.deliveryTimeErrorMessage=null,l.returnDate=p.getDeliveryReturnDate(l.pickupDate,l.returnDate,l.deliveryTime);break;case n.SET_PICKUP_AFTER_3:l.pickupAfter3=t.payload,l.pickupAfter3&&moment(l.pickupDate).isSame(l.returnDate)&&(l.returnDate=null);break;case n.SET_BIKE_RENTAL_LENGTH:l.bikeRentalLength=t.payload,l.currentCalendarDatesGroup=p.getCalendarDatesGroup(s,t.payload,!1),p.setCalendarDates(l,s),l.bikeRentalLength!==i.FULL_DAY&&(l.returnDate=l.pickupDate);break;default:return r}return _objectSpread(_objectSpread({},r),{},_defineProperty({},o,l))},getInitialState:function(e){var r=e.viewModels;return e.viewModelIds.reduce(function(e,t){return _objectSpread(_objectSpread({},e),{},_defineProperty({},t,(a=r[t],n=p.getInitialIsDelivery(a),o=p.getInitialPickupDate(a,n),{rentalSeason:a.Season,pickupAfter3:!1,bookingType:n?u.DELIVERY:u.PICKUP,pickupDate:o,returnDate:o,pickupErrorMessage:null,returnErrorMessage:null,deliveryTime:"",deliveryTimeErrorMessage:null,bikeRentalLength:i.FULL_DAY,currentCalendarDatesGroup:p.getCalendarDatesGroup(a,i.FULL_DAY,n)})));var a,n,o},{})}}});
//# sourceMappingURL=reducer.js.map
