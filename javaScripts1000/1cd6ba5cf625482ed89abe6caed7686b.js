(function(){this.Blue=this.Blue||{},this.Blue.version=this.Blue.version||{},this.Blue.buildDate=this.Blue.buildDate||{},this.Blue.buildHash=this.Blue.buildHash||{},this.Blue.version["blue-app/main"]="2.30.1",this.Blue.buildDate["blue-app/main"]="2021-06-15T21:26:55.977Z",this.Blue.buildHash["blue-app/main"]="9b312ca"}).call(this),requirejs.config({}),define("blue-app/config",(function(){})),define("blue-app/settings",["require","blue/settings"],(function(e){"use strict";return e("blue/settings")})),define("blue-app/localeSettings",["require","./settings","blue/is","blue/index"],(function(e){"use strict";var t=e("./settings"),n=e("blue/is"),r=e("blue/index");return{addSettingsToModel:function(e){var o,a,i,s,u,c,l,p,d,f,m=t.get("USER_INFO")||{},g=e.spec,h=e.component&&e.component.kind,b=e.component.context.area&&e.component.context.area.areaName,v="LOCALIZED_CONTENT",y=g.name+".DEFAULT",x=h?g.name+"."+h:y;b&&(c="LOCALIZED_CONTENT_"+e.component.context.area.areaName.toString().toLowerCase()),l=t.get(c,t.Type.ENV),p=t.get("LOCALIZED_CONTENT_app",t.Type.ENV),d=t.get(v,t.Type.APP)||{},l&&(l=l[x]||l[y]||l[g.name]||void 0),p&&(p=p[x]||p[y]||p[g.name]||void 0),f=l||p,Object.keys(g.settings).map((function(e){var t,c=g.name&&e,h=c&&m&&m.channel;f&&c&&(o=function(e,t){var r,o;if(e&&t)for(n.array(e)||(e=[e]);r=e.shift()||e.length;)if(r&&r[t])return o=r[t],n.plainObject(o)&&(o=""),o}([l,p],e)),s="_default."+e,u=c?g.name+"."+e:void 0,i=h?u+"."+m.channel:void 0,a=h&&m.segment?i+"."+m.segment:void 0,n.string(t=o)||n.string(t=d[a])||n.string(t=d[i])||n.string(t=d[u])||n.string(t=d[s])||n.string(t=d[e])||(t=r.minified?"":"{"+e+"}"),o||(t+=""),n.plainObject(g.settings[e])?g.settings[e].value=t+"":g.settings[e]={value:t+""}}))}}})),define("blue-app/validate/validator",["require","blue/log","blue/declare"],(function(e){"use strict";var t=e("blue/log")("[app]");return e("blue/declare")({constructor:function(e){this.types=new Map,this.register(e)},register:function(e){Object.keys(e).forEach((function(t){"constructor"!==t&&this.types.set(t,e[t])}),this),t.debug("Registered validation types: ",this.availableTypes())},availableTypes:function(){var e,t=this.types.keys(),n=[];if(this.types instanceof Map)for(;e=t.next().value;)n.push(e);return n},validate:function(e,t,n){if(!this.types.has(t))throw new TypeError('Spec data type "'+t+'", does not exist. Please add it if none of the following suffices: '+this.availableTypes().join(", "));return this.types.get(t).validate(e,n)}})})),define("blue-app/validate/standardTypes",[],(function(){"use strict";return{AccountNumber:{constraints:[{type:"AlphaNumeric"},{type:"Length",params:{min:8,max:16}}]},AccountMaskNumber:{constraints:[{type:"AlphaNumeric"},{type:"Length",params:{min:7}},{type:"Numbers",params:{min:4,max:4}},{type:"Pattern",params:{regex:"/(\\d){4}$/"}}]},AlertsProfileNickname:{constraints:[{type:"Pattern",params:{regex:"/[A-Z a-z 0-9 _]$/"}}]},Category:{constraints:[{type:"Length",params:{min:2}}]},Description:{constraints:[{type:"NotBlank"}]},Date:{constraints:[{type:"Date"}]},Email:{constraints:[{type:"NotPhoneEmail"},{type:"Email"}]},AddressLine:{constraints:[{type:"AddressLine"}]},City:{constraints:[{type:"City"}]},ZipCode:{constraints:[{type:"ZipCode"}]},ZipCodeExtension:{constraints:[{type:"ZipCodeExtension"}]},PostalCode:{constraints:[{type:"PostalCode"}]},IdentificationCode:{constraints:[{type:"Integer"},{type:"Length",params:{max:8}}]},SimpleUserId:{constraints:[{type:"NonRepeatingSequence"}]},TaxpayerIdentification:{constraints:[{type:"Pattern",params:{regex:"^(\\d{3}-\\d{2}-\\d{4}|\\d{9}|\\d{2}-\\d{7}|XXX-XX-XXXX|XX-XXXXXXX)$"}}]},UserSecurityCode:{constraints:[{type:"AlphaNumeric"},{type:"Length",params:{min:8,max:32}},{type:"Characters",params:{min:1}},{type:"Numbers",params:{min:1}}]},Frequency:{constraints:[{type:"Enum",params:{value:"Daily Weekly Monthly"}}]},Id:{constraints:[{type:"AlphaNumeric"},{type:"Min",params:{value:6}},{type:"Numbers",params:{min:1}}]},Money:{constraints:[{type:"Money"}]},OnOff:{constraints:[{type:"Boolean"}]},Password:{constraints:[{type:"NotBlank"},{type:"PasswordCharacters"},{type:"ConstraintSet",params:{constraints:[{type:"Characters",params:{min:1}},{type:"Numbers",params:{min:1}},{type:"PasswordSymbols",params:{min:1}}],min:2}},{type:"Length",params:{min:8,max:32}},{type:"NonConsecutiveAlphaNumerics",params:{maxSeqential:3}},{type:"NonRepeatingCharacters",params:{maxRepeating:2}}]},Payee:{constraints:[{type:"Length",params:{max:30}}]},Phone:{constraints:[{type:"PhoneNorthAmerica"},{type:"Length",params:{min:10,max:12}}]},Rate:{constraints:[{type:"Digits",params:{integer:0,fraction:2}},{type:"Range",params:{min:0,max:.99}}]},RoutingNumber:{constraints:[{type:"RoutingNumber"}]},UserId:{constraints:[{type:"AlphaNumeric"},{type:"Length",params:{min:8,max:32}},{type:"Characters",params:{min:1}},{type:"Numbers",params:{min:1}}]},RSAToken:{constraints:[{type:"Numeric"},{type:"Length",params:{min:6,max:35}}]},ProspectApplicantId:{constraints:[{type:"AlphaNumeric"},{type:"Length",params:{min:6}}]},List:{constraints:[]},Noop:{constraints:[]}}})),define("blue-app/validate/types",["require","exports","module","blue/object/extend","./standardTypes"],(function(e,t,n){"use strict";var r=e("blue/object/extend"),o=n.config().types;return r(e("./standardTypes"),o)})),define("blue-app/validate/var/ALPHA_REGEX",[],(function(){"use strict";return/^[A-Za-z]*$/})),define("blue-app/validate/var/ALPHA_NUMERIC_REGEX",[],(function(){"use strict";return/^[0-9A-Za-z]*$/})),define("blue-app/validate/var/ALPHA_NUMERIC_PLUS_REGEX",[],(function(){"use strict";return/^[a-zA-Z0-9.#&$/,:'\- ]*$/})),define("blue-app/validate/var/ADDRESS_LINE_REGEX",[],(function(){"use strict";return/^[a-zA-Z0-9.#&$/,:'\- ]{0,40}$/})),define("blue-app/validate/var/ZIP_CODE_REGEX",[],(function(){"use strict";return/^[0-9]{5}$/})),define("blue-app/validate/var/POSTAL_CODE_REGEX",[],(function(){"use strict";return/^[a-zA-Z0-9]{0,9}$/})),define("blue-app/validate/var/ZIP_CODE_EXTENSION_REGEX",[],(function(){"use strict";return/^([0-9]{4})?$/})),define("blue-app/validate/var/CITY_REGEX",[],(function(){"use strict";return/^[a-zA-Z0-9. ',-]{0,32}$/})),define("blue-app/validate/var/ANY_ALPHA_NUMERIC_REGEX",[],(function(){"use strict";return/[0-9A-Za-z]/g})),define("blue-app/validate/var/BOOLEAN_REGEX",[],(function(){"use strict";return/^(true|false)$/i})),define("blue-app/validate/var/EMAIL_REGEX",[],(function(){"use strict";return/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9]){1,}?$/i})),define("blue-app/validate/var/INTEGER_REGEX",[],(function(){"use strict";return/^-?[0-9]*$/})),define("blue-app/validate/var/NAME_REGEX",[],(function(){"use strict";return/^[a-zA-Z\. '-]*$/})),define("blue-app/validate/var/NOT_AN_ALPHA_REGEX",[],(function(){"use strict";return/[^a-zA-Z]/g})),define("blue-app/validate/var/NOT_A_CAPITAL_REGEX",[],(function(){"use strict";return/[^A-Z]/g})),define("blue-app/validate/var/NOT_A_NUMBER_REGEX",[],(function(){"use strict";return/[^0-9]/g})),define("blue-app/validate/var/NOT_A_PASSWORD_SYMBOL",[],(function(){"use strict";return/[^!#$%+\/=@~]/g})),define("blue-app/validate/var/NOT_PHONE_EMAIL_REGEX",[],(function(){"use strict";return/^\d{10}@/})),define("blue-app/validate/var/NUMERIC_REGEX",[],(function(){"use strict";return/^[0-9]*$/})),define("blue-app/validate/var/REAL_REGEX",[],(function(){"use strict";return/^-?([0-9]+(\.[0-9]+)?|\.[0-9]+)$/})),define("blue-app/validate/var/REPEATING_SEQUENCE_REGEX",[],(function(){"use strict";return/(.)\1/})),define("blue-app/validate/var/URL_REGEX",[],(function(){"use strict";return/^([a-z]([a-z]|\d|\+|-|\.)*):(\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:)*@)?((\[(|(v[\da-f]{1,}\.(([a-z]|\d|-|\.|_|~)|[!$&'()*+,;=]|:)+))\])|((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=])*)(:\d*)?)(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:|@)*)*|(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:|@)*)*)?)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:|@)*)*)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:|@)){0})(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:|@)|\/|\?)*)?$/i})),define("blue-app/validate/var/WHITESPACE_REGEX",["blue/util"],(function(e){"use strict";return new RegExp("["+e.string.WHITE_SPACES.join("")+"]","g")})),define("blue-app/validate/var/DEFAULT_DATE_FORMAT",[],(function(){"use strict";return"MM/DD/YYYY"})),define("blue-app/validate/var/PASSWORD_FORMAT",[],(function(){"use strict";return/^[A-Za-z0-9!#$%+/=@~]*$/})),define("blue-app/validate/var/PHONE_NORTH_AMERICA",[],(function(){"use strict";return/^\d{10}$|^\d{3}-\d{3}-\d{4}$/})),define("blue-app/validate/var/PHONE_OAO_FORMAT",[],(function(){"use strict";return/^(?!(?:012-?345-?6789|987-?654-?3210))(?:\d{3}(-?)\d{3}\1\d{4})$/})),define("blue-app/validate/var/SSN_FORMAT",[],(function(){"use strict";return/^\d{9}$|^\d{3}-\d{2}-\d{4}$/})),define("blue-app/validate/var/SSN_OAO_FORMAT",[],(function(){"use strict";return/^(?!9|000|666|123(-?)45\1{1}6789|([1-578])\2{2}(-?)\2{2}\3\2{4})\d{3}(-?)(?!00)\d{2}\4(?!0000)\d{4}$/})),define("blue-app/validate/var/SSN_VALID_GROUPS_FORMAT",[],(function(){"use strict";return/^(?!000|666|9|\d{3}(?:-?)00|\d{3}(-?)\d{2}\1(?:0000)).*$/})),define("blue-app/validate/var/SSN_EXCLUDE_FORMAT",[],(function(){"use strict";return/^(?!123(-?)45\1{1}6789|987(-?)65\2{1}4321).*$/})),define("blue-app/validate/var/CURRENCY_FORMATS",[],(function(){"use strict";return{USD:{decimal:".",decimalDigits:2,kDelim:",",symbol:"$",symbolBegin:!0,regex:/^\s*\$?((\d+|\d{1,3}(,\d{3})*)(\.\d{0,2})?|\.\d{1,2})\s*$/}}})),define("blue-app/validate/constraints",["require","exports","module","./var/ALPHA_REGEX","./var/ALPHA_NUMERIC_REGEX","./var/ALPHA_NUMERIC_PLUS_REGEX","./var/ADDRESS_LINE_REGEX","./var/ZIP_CODE_REGEX","./var/POSTAL_CODE_REGEX","./var/ZIP_CODE_EXTENSION_REGEX","./var/CITY_REGEX","./var/ANY_ALPHA_NUMERIC_REGEX","./var/BOOLEAN_REGEX","./var/EMAIL_REGEX","./var/INTEGER_REGEX","./var/NAME_REGEX","./var/NOT_AN_ALPHA_REGEX","./var/NOT_A_CAPITAL_REGEX","./var/NOT_A_NUMBER_REGEX","./var/NOT_A_PASSWORD_SYMBOL","./var/NOT_PHONE_EMAIL_REGEX","./var/NUMERIC_REGEX","./var/REAL_REGEX","./var/REPEATING_SEQUENCE_REGEX","./var/URL_REGEX","./var/WHITESPACE_REGEX","./var/DEFAULT_DATE_FORMAT","./var/PASSWORD_FORMAT","./var/PHONE_NORTH_AMERICA","./var/PHONE_OAO_FORMAT","./var/SSN_FORMAT","./var/SSN_OAO_FORMAT","./var/SSN_VALID_GROUPS_FORMAT","./var/SSN_EXCLUDE_FORMAT","./var/CURRENCY_FORMATS","blue/is","moment","blue/util","blue/util","blue/util","blue/util"],(function(e,t,n){"use strict";var r,o=e("./var/ALPHA_REGEX"),a=e("./var/ALPHA_NUMERIC_REGEX"),i=e("./var/ALPHA_NUMERIC_PLUS_REGEX"),s=e("./var/ADDRESS_LINE_REGEX"),u=e("./var/ZIP_CODE_REGEX"),c=e("./var/POSTAL_CODE_REGEX"),l=e("./var/ZIP_CODE_EXTENSION_REGEX"),p=e("./var/CITY_REGEX"),d=e("./var/ANY_ALPHA_NUMERIC_REGEX"),f=e("./var/BOOLEAN_REGEX"),m=e("./var/EMAIL_REGEX"),g=e("./var/INTEGER_REGEX"),h=e("./var/NAME_REGEX"),b=e("./var/NOT_AN_ALPHA_REGEX"),v=e("./var/NOT_A_CAPITAL_REGEX"),y=e("./var/NOT_A_NUMBER_REGEX"),x=e("./var/NOT_A_PASSWORD_SYMBOL"),E=e("./var/NOT_PHONE_EMAIL_REGEX"),S=e("./var/NUMERIC_REGEX"),C=e("./var/REAL_REGEX"),w=e("./var/REPEATING_SEQUENCE_REGEX"),_=e("./var/URL_REGEX"),A=e("./var/WHITESPACE_REGEX"),O=e("./var/DEFAULT_DATE_FORMAT"),R=e("./var/PASSWORD_FORMAT"),P=e("./var/PHONE_NORTH_AMERICA"),T=e("./var/PHONE_OAO_FORMAT"),N=e("./var/SSN_FORMAT"),k=e("./var/SSN_OAO_FORMAT"),I=e("./var/SSN_VALID_GROUPS_FORMAT"),j=e("./var/SSN_EXCLUDE_FORMAT"),F=e("./var/CURRENCY_FORMATS"),D=e("blue/is"),L=e("moment"),M=e("blue/util").string.toNumber,q=e("blue/util").object.toString,X=e("blue/util").string.typecast,H=e("blue/util").object.extend,B=n.config().constraints,U=function(e,t){var n,r;return D.defined(t.value)?n=r=X(t.value):(n=D.defined(t.min)?M(t.min):0,r=D.defined(t.max)?M(t.max):Number.MAX_VALUE),(e=M(e))>=n&&e<=r};return H(r={Alpha:{validator:function(e){return o.test(e)}},AlphaNumeric:{validator:function(e){return a.test(e)}},AlphaNumericPlus:{validator:function(e){return i.test(e)}},AddressLine:{validator:function(e){return s.test(e)}},PostalCode:{validator:function(e){return c.test(e)}},ZipCode:{validator:function(e){return u.test(e)}},ZipCodeExtension:{validator:function(e){return l.test(e)}},City:{validator:function(e){return D.singleSpaced(e)&&p.test(e)}},Date:{validator:function(e,t){if(0===q(e).length)return!0;var n=t.format||O;return L(e,n,!0).isValid()}},Boolean:{validator:function(e){return f.test(e)}},Blank:{validator:function(e){return""===q(e).replace(A,"")}},Capitals:{validator:function(e,t){return U(q(e).replace(v,"").length,t)}},Characters:{validator:function(e,t){return U(q(e).replace(b,"").length,t)}},ConstraintSet:{validator:function(e,t){var n=e;return U(t.constraints.reduce((function(e,t){return e+(0|r[t.type].validator(n,t.params))}),0),t)}},Date18YearsOld:{validator:function(e,t){var n=t.format||O,r=L(e,n,!0);return r.isValid()&&L().diff(r,"years")>17}},DateRange:{validator:function(e,t){var n=t.format||O,r=L(e,n,!0),o=r.isValid();if(o&&D.defined(t.value)&&(o=r.isSame(L(t.value,n,!0))),o&&D.defined(t.min)){var a=L(t.min,n,!0);o=r.isSame(a)||r.isAfter(a)}if(o&&D.defined(t.max)){var i=L(t.max,n,!0);o=r.isSame(i)||r.isBefore(i)}return o}},Digits:{validator:function(e,t){var n,r=!1;return n=(e=q(e).replace(A,"")).split(/\./),e.length>0&&(1===n.length&&(n[1]=""),r=!(t.integer>0)||n[0].length<=t.integer,t.fraction>0&&(r=r&&n[1].length<=t.fraction)),r}},Email:{validator:function(e){return m.test(e)}},NotPhoneEmail:{validator:function(e){return!E.test(e)}},Enum:{validator:function(e,t){return-1!==(D.string(t.value)?t.value.split(" "):D.array(t.value)?t.value:[]).indexOf(e)}},Future:{validator:function(e,t){var n=t.format||O,r=L(e,n,!0);return r.isValid()&&r.isAfter()||r.isSame()}},Integer:{validator:function(e){return g.test(e)}},ITINRange:{validator:function(e){var t=(e=q(e)).length<4?0:X(e.charAt(3),10);return e.length>4&&t>=7&&(t=10*t+X(e.charAt(4),10)),e.length<4||4===e.length&&t>=7||t>=70&&t<=88||t>=90&&t<=92||t>=94}},Length:{validator:function(e,t){return U(q(e).length,t)}},Max:{validator:function(e,t){return parseFloat(e)<=parseFloat(t.value)}},Min:{validator:function(e,t){return parseFloat(e)>=parseFloat(t.value)}},Money:{validator:function(e,t){return(t.currencyFormat||F[t.format||"USD"]).regex.test(q(e))}},MustBeginWith:{validator:function(e,t){return 0===(e=q(e)).length||e.charAt(0)===t.value}},NotBlank:{validator:function(e){return""!==e.replace(A,"")}},NotBeginWith:{validator:function(e,t){return 0===(e=q(e)).length||e.charAt(0)!==t.value}},NotBeginWith1:{validator:function(e){return r.NotBeginWith.validator(e,{value:"1"})}},NonConsecutiveAlphaNumerics:{validator:function(e,t){var n=e.split(""),r=e.length,o=t.maxSequential||t.maxSeqential,a=1;if(r<o)return!0;for(var i=0;i<r-1;++i){var s=n[i].toLowerCase().charCodeAt();if(s===n[i+1].toLowerCase().charCodeAt()-1&&(s>=48&&s<57||s>=97&&s<122)){if(++a===o)return!1}else a=1}for(i=r-1;i>=1;--i){if(n[i].charCodeAt()===n[i-1].charCodeAt()-1&&(s>48&&s<=57||s>97&&s<=122)){if(++a===o)return!1}else a=1}return!0}},NonRepeatingAlphaNumerics:{validator:function(e,t){for(var n="([a-z\\d])",r=0;r<t.maxRepeating;++r)n+="\\1";return!new RegExp(n,"gi").test(e)}},NonRepeatingCharacters:{validator:function(e,t){for(var n="(.)",r=0;r<t.maxRepeating;++r)n+="\\1";return!new RegExp(n,"gi").test(e)}},NonRepeatingSequence:{validator:function(e){return!w.test(e)}},Numbers:{validator:function(e,t){return U(q(e).replace(y,"").length,t)}},Numeric:{validator:function(e){return S.test(e)}},Past:{validator:function(e,t){var n=t.format||O,r=L(e,n,!0);return r.isValid()&&r.isBefore()||r.isSame()}},PasswordCharacters:{validator:function(e){return R.test(e)}},PasswordSymbols:{validator:function(e,t){return U(q(e).replace(x,"").length,t)}},Pattern:{validator:function(e,t){var n;return n=D.string(t.regex)?t.regex.replace(/^\//,"").replace(/\/$/,""):t.regex,(D.string(t.flags)?new RegExp(q(n).replace(/^\//,"").replace(/\/[^/]*$/,""),t.flags):new RegExp(n)).test(e)}},PersonalName:{validator:function(e){return h.test(e)}},Range:{validator:function(e,t){return U(e,t)}},Real:{validator:function(e){return C.test(e)}},Specials:{validator:function(e,t){return U(q(e).replace(d,"").length,t)}},Ssn:{validator:function(e){return N.test(e)}},SsnExclude:{validator:function(e){return j.test(e)}},SsnOao:{validator:function(e){return k.test(e)}},SsnValidGroups:{validator:function(e){return I.test(e)}},Step:{validator:function(e,t){var n=X(e),r=X(t.step);return U(n,t)&&n%r==0}},URL:{validator:function(e){return _.test(e)}},PhoneNorthAmerica:{validator:function(e){return P.test(e)}},PhoneOao:{validator:function(e){return T.test(e)}},RoutingNumber:{validator:function(e){for(var t=0,n=0,r=(e=q(e)).length;n<r;n+=3)t+=3*X(e.charAt(n),10)+7*X(e.charAt(n+1),10)+X(e.charAt(n+2),10);return 0!==t&&t%10==0}}},B)})),define("blue-app/validate/type",["require","./types","./constraints","blue/object/extend","blue/is","../settings","blue/util","blue/perf","blue/declare"],(function(e){"use strict";var t,n=Object.keys,r=e("./types"),o=e("./constraints"),a=e("blue/object/extend"),i=e("blue/is"),s=e("../settings"),u=e("blue/util").object.toString,c=e("blue/perf"),l=function(){t=""},p=function(){return t||(t=s.get("language")||s.get("contentLanguage")||"en-us",setTimeout(l,0)),t},d=e("blue/declare")({constructor:function(e,t){if(c.count("blue/validate/type","create",t),!i.array(e.constraints))throw new TypeError('Property "constraints" must be provided for type: '+t);this.name=t,a(!0,this,e),this.constraints.forEach((function(e){if(i.undefined(e.type))throw new TypeError('Property "type" is undefined for constraints within definition of type "'+this.name+'"');if(!i.defined(o[e.type]))throw new TypeError('Constraint "'+e.type+'" does not exist, and is being used by type "'+this.name+'"');if(!i.function(o[e.type].validator))throw new TypeError('Constraint "'+e.type+'" does not have a method "validator", and is being used by type "'+this.name+'"');e.params=e.params||{}}),this)},validator:function(e,t){var n=p();return c.count("blue/validate/type","validator"),this.constraints.every((function(r){return(o[r.type][n]||o[r.type]).validator(e,a(!0,{},r.params,t[r.type]||t))}),this)},validate:function(e,t){c.count("blue/validate/type","validate"),!i.array(e)&&!i.string(e)&&(e=u(e)||""),i.undefined(t)&&(t={});var n,r=this.constraints,s=p();return n=r.filter((function(n){return!(o[n.type][s]||o[n.type]).validator(e,a(!0,{},n.params,t[n.type]||t))})),{value:e,isValid:!n.length,validationName:this.name,validationParams:t,failedConstraints:n}}});return n(r).forEach((function(e){d[e]=new d(r[e],e)})),n(o).forEach((function(e){i.defined(d[e])||(d[e]=new d({constraints:[{type:e,params:{}}]},e))})),d})),define("blue-app/validate",["./validate/validator","./validate/type"],(function(e,t){"use strict";return new e(t)})),define("blue-app/component/validator",["blue-app/validate","blue/is","blue-app/validate/type"],(function(e,t,n){"use strict";return{validate:function(n,r,o,a){var i,s,u,c;return this.isBuiltInType(r)?s=e.validate(n,r,o):t.string(r)&&(u=e.validate(n,r,o)),i=s||u||e.validate("","Noop"),t.plainObject(a)&&t.defined(a.validator)&&(c=a.validator.validate(n)),i.isValid&&t.defined(c)&&(i.isValid=c.isValid),t.defined(i.failedConstraints)&&t.defined(c)&&(i.failedConstraints=i.failedConstraints.concat(c.failedConstraints)),i},getInstance:function(){return e},isBuiltInType:function(t){return e.types.has(t)},createType:function(e,t){return new n(e,t)},composeValidators:function(e,n,r){var o=n.type||"Noop",a=n.constraints||null,i=r.name+"_"+e+"_"+o;if(n.isBuiltInType=this.isBuiltInType(o),a&&(n.validator=this.createType({constraints:a},i)),"list"===o.toString().toLowerCase()){if(t.string(n.itemType))return;t.plainObject(n.itemType)&&this.composeValidators(e,n.itemType,r),t.plainObject(n.items)&&Object.keys(n.items).forEach(function(e){e&&t.plainObject(n.items[e])&&this.composeValidators(e,n.items[e],r)}.bind(this))}}}})),define("blue-app/component",["require","blue/root","blue/as/contextual","blue/as/serializable","blue/compose","blue/event/channel","blue/log","blue/is","blue/event/lifecycle","./localeSettings","blue/util","blue/observable","blue/perf","./component/validator","emitter-js"],(function(e){"use strict";var t=Object.create.bind(Object,null),n=Object.defineProperty,r=Object.defineProperties,o=Object.keys,a=e("blue/root"),i=e("blue/as/contextual"),s=e("blue/as/serializable"),u=e("blue/compose"),c=e("blue/event/channel"),l=e("blue/log"),p=e("blue/is"),d=e("blue/event/lifecycle"),f=e("./localeSettings"),m=e("blue/util").object.map,g=e("blue/observable"),h=e("blue/perf"),b=e("./component/validator"),v="blue-legacy/blue-app/",y=l("[blue:app]"),x=e("emitter-js").default,E=e.specified(v+"config")&&a.require(v+"component"),S=0,C=function(e,t){switch(arguments.length){case 1:return this[e];case 2:return this[e]=t;case 0:o(this).forEach((function(e){delete this[e]}),this)}},w=function(e,t){var n,r,o=e.split(".")[0],a=this._("listeners")[o]||Object.create(null);for(n in a){r=a[n];try{r.h.call(r.s,t,e)}catch(e){y.error("["+this.context.getStack()+"]",'Calling "'+o+'" data-change listener',e)}}},_=function(e,t){({actions:1,data:1,key:1,model:1,name:1,settings:1,spec:1,states:1,destroy:1,destroyView:1,disable:1,enable:1,getDataProperties:1,getActionNames:1,getSettingsValues:1,on:1,onData:1,validate:1,activeViewName:1})[e]&&y.error("["+t.getStack()+"]","Reserved property being overwritten",e)},A=function(e){var t=this;try{p.function(t[e])&&t[e]()}catch(n){y.error("["+t.context.getStack()+"]",'Executing-Action "'+e+'()"',n)}},O=function(e,t){var n,r=this;_(e,r.context),(n=Object.getOwnPropertyDescriptor(r,e))&&(n.get||n.set)&&y.error("["+r.context.getStack()+"]",t.type+' "'+e+'" already defined',n),t.undef&&e in r&&y.error("["+r.context.getStack()+"]",t.type+' "'+e+'" already set',r[e])},R=function(e,t,n){var r,o=this;o._fromBridge!==e&&(o._("enabled")||o._queueData)&&(r=h.count.call({bucket:"render"},"blue/component","emit",o.name,e),o.privateOutput.emit("data",{value:e,path:t,current:n}),r())},P={descriptor:{set:function(e){this._("actions",t()),o(e).forEach(P.init,this),delete this.actions},configurable:!0,enumerable:!1},setter:function(e,t){var n=this,r=n._("actions"),o=r[e];if(!p.function(t))throw new TypeError(e+" must be a function");o&&!o.temp&&y.error("["+n.context.getStack()+"]",'Action "'+e+'()" already set',o,t),r[e]=function(){var r,o=a.location?a.location.href:"",i=arguments[arguments.length-1]||{};n.actionRunning={value:e,action:e,nonCustomerEvent:void 0===i.nonCustomerEvent||i.nonCustomerEvent,args:arguments,url:o};try{r=t.apply(n,arguments)}catch(t){y.error("["+n.context.getStack()+"]",'Executing-Action "'+e+'()"',t)}return delete n.actionRunning,n.privateOutput&&n.privateOutput.emit("action",{value:e,action:e,nonCustomerEvent:void 0===i.nonCustomerEvent||i.nonCustomerEvent,args:arguments,result:r,url:o}),r}},init:function(e){var t=this,r=t[e],o=function(){throw new TypeError("Component "+t._("id")+': Action "'+e+'()" is undefined')};O.call(t,e,{type:"Action"}),o.temp=!0,t._("actions")[e]=o,n(t,e,{get:function(){return t._("actions")[e]},set:function(n){return P.setter.call(t,e,n)},configurable:!0,enumerable:!0}),r&&(t[e]=r)}},T={descriptor:{set:function(e){o(e).forEach((function(t){T.init.call(this,t,e[t])}),this),delete this.data},configurable:!0,enumerable:!1},validate:function(e,t,n,r,a){var i,s=this,u=[],c=e.type||"Noop",l=e.params||{},d=r.split(".").pop();switch(c){case"NoConstraint":break;case"List":if(!p.array(a))return b.validate(a,"Noop",l);p.plainObject(e.items)?a.forEach((function(n,a){o(e.items).forEach((function(o){if(p.plainObject(n)&&o in n){var i=e.items[o];u=u.concat(T.validate.call(s,{type:i.type||i,params:i.params||{},constraints:i.constraints,validator:i.validator},t,a,r+"."+a+"."+o,n[o]))}}))})):p.string(e.itemType)&&a.forEach((function(n,o){u=u.concat(T.validate.call(s,{type:e.itemType,params:l,constraints:e.constraints,validator:e.validator},t,o,r+"."+o,n))})),a.isValid=!u.length,a.validation=u;break;default:try{h.count("blue/component","validate",this.name,r),i=b.validate(a,c,l,e)}catch(e){y.warn("["+s.context.getStack()+"]",'Unable to validate Data "'+r+'"',e),i=b.validate(a,"Noop",l)}if(void 0===n)return i;i.isValid||u.push({property:d,index:n,dataPath:r,result:i})}return u.isValid=!u.length,u},onChange:function(e,t,n){var r=this,o=r._("data")[e],a=r._("ds");o.validated=!1,a&&!(e in a)||R.call(r,e,t,n)},setter:function(e,t){var n=this,r=e.split(".")[0],o=r!==e,a=n._("data")[r];o&&!n.model.get(r)&&"LIST"===a.definition.type&&(n._ignore=e,n.model.set(r,[]),delete n._ignore),n.model.set(e,t,{isolate:!0})},init:function(e,r){var o,a=this;if(O.call(a,e,{type:"Data",undef:1}),a._("data")[e]=o=t(),p.object(r)||(y.warn("["+a.context.getStack()+"]","Data item,","'"+e+"',","invalid object definition"),r={type:"noop"}),r.type&&!p.string(r.type))throw new TypeError("data type for property "+e+" must be a string, not "+typeof r.type);b.composeValidators(e,r,{name:a.key}),n(a,e,{get:function(){return a.model.get(e,{isolate:!0})},set:function(t){return T.setter.call(a,e,t)},configurable:!0,enumerable:!0}),o.definition=r,o.isValid=!0,o.validationResults=[]}},N={descriptor:{get:function(){return this._("name")},set:function(e){if(!p.string(e))throw new TypeError("name must be a string");if(this._("name"))throw new Error("name can only be set once");this._("name",e),this._("id","<#"+e+":"+ ++S+">"),this.context.componentName=this.context.name=e,h.count.call({id:this._("id"),ref:this,time:1},"blue/component","create",this.name)},configurable:!0,enumerable:!1}},k={descriptor:{set:function(e){!e._init&&(e._init=!0)&&f.addSettingsToModel({spec:{name:this.name,settings:e},component:this}),this._("settings",e),o(e).forEach((function(t){"_init"!==t&&k.init.call(this,t,e[t].value)}),this),delete this.settings},configurable:!0,enumerable:!1},newKind:function(){var e=this._("settings")||{},t=this.model;f.addSettingsToModel({spec:{name:this.name,settings:e},component:this}),this._("settings",e),t&&o(e).forEach((function(n){"_init"!==n&&t.set(n,e[n].value)}))},reset:function(){var e=this.model,t=e&&e.get()||{},n=this._("settings")||{};o(n).forEach((function(e){"_init"!==e&&void 0===t[e]&&(t[e]=n[e].value)}))},init:function(e,t){var r=this;O.call(r,e,{type:"Setting",undef:1}),r.model.set(e,t),n(r,e,{get:function(){return r.model.get(e)},set:function(t){return r.model.set(e,t)},configurable:!0,enumerable:!0})}},I={descriptor:{set:function(e){this._("states",e),o(e).forEach(I.init,this),delete this.states},configurable:!0,enumerable:!1},init:function(e){var t=this;O.call(t,e,{type:"State",undef:1}),n(t,e,{get:function(){return t.model.get(e)},set:function(n){return t.model.set(e,n)},configurable:!0,enumerable:!0})}},j={descriptor:{get:function(){return this._("model")},set:function(e){var n,r=this,o=r._("model");e&&e===o||((n=o&&o.lens)&&o.destroy(),null==e&&(e=t()),p.function(e.lens)?(e.destroyed&&(y.error("["+r.context.getStack()+"]","Tried to create-component with destroyed model"),e=g.Model({},{skipRepeats:!0})),o=e):o=g.Model(e,{skipRepeats:!0}),o.onValue(j.onChange,{initial:!1,scope:r,isolate:!0}),r._("model",o),n&&j.reset.call(r))},configurable:!0,enumerable:!1},onChange:function(e,t){var n=this,r=t.split(".")[0],o=r in n,a=e&&e[r];if(e&&!r&&(j.reset.call(n),y.warn("["+n.context.getStack()+"]","Component properties should be used in favor of setting directly on internal model")),o&&!n._ignore){if(r in(n._("data")||{}))T.onChange.call(n,r,t,a);else if(r in(n._("settings")||{}))R.call(n,r,r,a);else{if(!(r in(n._("states")||{})))return;R.call(n,r,r,a)}w.call(n,t,a)}},reset:function(){var e;k.reset.call(this),(this._("enabled")||this._queueData)&&(e=h.count.call({bucket:"render"},"blue/component","emit",this.name,"reset"),this.privateOutput.emit("reset",{value:"data",current:this.model.get({isolate:!0})||{}}),e())}};function F(){var e=this;e.privateOutput&&e.privateOutput.asEventStream().end(),e.privateOutput&&e.privateOutput.destroy(),e.privateOutput=new c({eventTarget:e});var t=this.privateOutput.asEventStream(),n=t.onValue((function(t){e._("enabled")||e._("queue").push(t)}));t.onEnd(n)}var D=function(e){var n=this,o={enabled:!1,hasView:!1,installedHandlers:{},listeners:{},queue:[],data:t()};x(n),n.on=D.prototype.on.bind(n),n._=C.bind(o),n.initialized=!1,n.defineContext(e),r(n,{actions:P.descriptor,data:T.descriptor,model:j.descriptor,name:N.descriptor,settings:k.descriptor,states:I.descriptor}),n.key="",n.output=new c({eventTarget:n});var a=n.output.asEventStream(),i=a.onValue((function(e){n._("enabled")||n._("queue").push(e)}));a.onEnd(i),F.call(n)};return D.create=function(e,t,a){if(a.legacy&&E)return E.create.apply(0,arguments);var i,s,c=new D(t),d=a.spec.states||(a.spec.states={}),f=["actions","data","settings","states"];for(c.activeViewName="",c.key=e,c.model=a.model,c.kind=a.kind,a.viewEngine&&(c.context.viewEngine=a.viewEngine),c._("keepAlive",a.keepAlive),c._("modelCleanup",a.modelCleanup),p.function(a.methods)?a.methods.call(c,c.context):p.plainObject(a.methods)&&o(a.methods).forEach((function(e){_(e,c.context),c[e]=a.methods[e]})),d.v=1,c.context.logger=l("[component:"+a.spec.name+"]"),u(c,a.spec),r(c,{__hasView:{get:function(){return y.warn("["+this.context.getStack()+"]",'DEPRECATED:BLUEJS-2918:Property: "__hasView" has been deprecated.'),this._("hasView")}},__instanceName:{get:function(){return y.warn("["+this.context.getStack()+"]",'DEPRECATED:BLUEJS-2918:Property: "__instanceName" has been deprecated. Use "key"'),this.key}},spec:{get:function(){return a.spec}}}),["__viewName","__enabled"].forEach((function(e){n(c,e,{get:function(){var t=this._(e.replace(/[^a-z]/gi,""));return y.warn("["+this.context.getStack()+"]",'DEPRECATED:BLUEJS-2918:Property: "'+e+'" has been deprecated.',t),t}})}));i=f.pop();)delete c[i];return c.initialized=!0,c.onInit?A.call(c,"onInit"):c.init&&A.call(c,"init"),c.privateOutput.emit("init",{}),A.call(c,"onComplete"),c.privateOutput.emit("complete",{}),s=c.kind,n(c,"kind",{get:function(){return s},set:function(e){e!==s&&(s=e,k.newKind.call(c))}}),c.context.on("blue:content:reload",(function(){k.newKind.call(c)})),c},D.prototype=Object.create(x.prototype),D.prototype.constructor=D,D.prototype.destroy=function(){var e,t,n=this;return e=new d({type:"component",action:"destroy",stage:"begin",name:n.context&&n.context.name}),n.context&&n.context.bubble(e.msgType,e),n.actionRunning&&n.privateOutput&&n.privateOutput.emit("action",n.actionRunning),n.privateOutput&&n.privateOutput.emit("destroy",{}),n.destroyed=!0,new Promise((function(e,t){n.disable(e,t,!0)})).catch((function(){})).then((function(){n.model&&n.model.destroy(n._("modelCleanup")&&n.context),n.context&&n.context.bubble("removeComponent",{name:n.key}),n.output&&n.output.destroy(),n.privateOutput&&n.privateOutput.destroy(),delete n.output,delete n.privateOutput,x.prototype.destroy.call(n),A.call(n,"onDestroy"),t=new d({type:"component",action:"destroy",stage:"end",name:n.spec.name,beginEventName:e.eventName}),n.context&&n.context.bubble(t.msgType,t),n.context&&n.destroyContext(),h.count.call({id:n._("id")},"blue/component","destroy",n.name),n._()}))},D.prototype.destroyView=function(e,t){var n,r=this._("installedHandlers");if(this._("hasView")){if(this._("hasView",!1),p.array(r.destroy))for(;n=r.destroy.pop();)n();this.privateOutput&&this.privateOutput.emit("destroyView",{compDestroyResolve:e,compDestroyReject:t}),this.activeViewName=""}},D.prototype.disable=function(e,t,n){var r,a,i=this._("installedHandlers");this._("hasView")?this.destroyView(e,t):e&&e(),this._("enabled")&&(i.outputUnplugger&&i.outputUnplugger(),delete i.outputUnplugger,!n&&F.call(this),this._("enabled",!1),this.input=void 0,o(i).forEach((function(e){if(r=i[e],p.function(r))r();else if(p.array(r))for(;a=r.pop();)p.function(a)&&a();delete i[e]})))},D.prototype.enable=function(e){var t,n,r=this,o=r._("queue"),a=r._("installedHandlers");if(!r.destroyed){for(r.disable(),r.input=e,a.trigger=r.input.on("trigger",(function(e){var t=e.value;if(r[t])try{e.data&&e.data.constructor===Array?r[t].apply(r,e.data):r[t].call(r,e.data)}catch(e){y.error("["+r.context.getStack()+"]","Action: "+t+"()",e)}else y.error("["+r.context.getStack()+"]","Action: "+t+"() does not exist in spec")})),a.binding=r.input.on("binding",(function(e){var t=e.value.split(".")[0];t in r?(r._fromBridge=e.value,T.setter.call(r,e.value,e.data),delete r._fromBridge):y.error("["+r.context.getStack()+"]","Property: "+t+" does not exist in spec")})),a.bindingInit=r.input.on("init",(function(e){r._("ds",e.downstream)})),a.destroy=r.input.on("destroy",(function(){r._("hasView",!1),r._("keepAlive")?r.disable():r.destroy()})),a.ready=r.input.on("ready",(function(){r._("hasView",!0),r.privateOutput.emit("ready",{componentName:r.name,componentInstanceName:r.key||"",componentId:r._("id"),viewName:r._("viewName")||""}),A.call(r,"onReady")})),r._("enabled",!0),a.outputUnplugger=r.output.plug(r.privateOutput.asEventStream()),r.privateOutput.emit("componentInputReady"),t=h.count.call({bucket:"render"},"blue/component","emit",r.name,"enable");o.length;)"binding"!==(n=o.shift()).type&&r.output.emit(n);t(),delete r._queueData,r.activeViewName=r._("viewName")||"unknown"}},D.prototype.onData=function(e,t,n){var r="n"+S++,o=this._("listeners"),a=e.split(".")[0],i=n||{},s={h:t,s:i.context||this},u=o[a]||(o[a]={});if(u[r]=s,!("init"in i)||i.init)try{s.h.call(s.s,this[a],a)}catch(e){y.error("["+this.context.getStack()+"]",'Calling "'+a+'" data-change listener',e)}return function(){delete u[r]}},D.prototype.validate=function(e){var t=this,n=this._("data"),r=t.model,a={isValid:!0,updated:{},passed:{},failed:{}};return(e?p.array(e)?e:e in n?[e]:[]:o(n)).forEach((function(e){var o,i=n[e]||{},s=i.definition||{};!{Noop:1,NoConstraint:1}[s.type||"Noop"]||s.validator?i.validated?o=i.isValid:(i.validationResults=T.validate.call(t,s,e,void 0,e,r.get(e)),i.isValid=o=i.validationResults.isValid,i.validated=!0,a.updated[e]=!0):i.isValid=o=!0,a.isValid&=o,a[o?"passed":"failed"][e]=i.validationResults})),a},D.prototype.getSettingsValues=function(){var e={},t=this._("settings");return t&&o(t).forEach((function(t){e[t]=this.model.get(t)}),this),e},D.prototype.getActionNames=function(){var e={},t=this._("actions");return t&&o(t).forEach((function(t){e[t]=1}),this),e},D.prototype.on=function(e,t){var n,r;this._("enabled")&&(!p.string(e)&&p.object(e)?m(e,(function(t,o){(n=o.split("/")).unshift(this.name),r=n.join("/"),e[r]=t,delete e[o]}),this):((n=e.split("/")).unshift(this.name),e=n.join("/")),this.output.on(e,t))},s.call(D.prototype,(function(){return{CompID:this._("id")||"empty id",specName:this.name||"no spec name",model:this.model.toJSON(this.spec.data).model||"empty model"}})),D=i.call(D,{name:"component"})})),define("blue-app/service/interceptor/header",["require","blue/store/enumerable/session"],(function(e){"use strict";var t=new(e("blue/store/enumerable/session"))("servicesettings");return{before:function(e){return e.header=t.get("serviceheader")||{},e}}})),define("blue-app/service/interceptor/error",["require","blue/log"],(function(e){"use strict";var t=e("blue/log")("[blue:app]"),n=function(e,t,n,r){var o={},a={value:r||"",request:t,response:n},i=e.util.object.deepClone;e.application.broadcast("serviceError",a),(o=i(a)).code="blue:error:service:requestFailed",e.bubble(o.code,o)};return{around:function(e){var r="X-B3-TraceId",o=function(){},a=e.args[0],i=e.target.context,s=!!a.disableDefaultError,u=a.retryStatusCodes,c=a.retryHeader;return new Promise((function(l,p){e.proceed().then((function(e){l(e)})).catch((function(e){var l,d,f,m,g,h=e instanceof Error;!h&&Array.isArray(u)&&u.indexOf(e.status)>=0&&e.getResponseHeader(c)?p(e):(h?(t.error("["+i.getStack()+"]","service response error",e),s||n(i,a,e)):(l=(e=e||{getResponseHeader:o}).status,f=e.statusText,d=e.getResponseHeader("Support-Id"),m=e.getResponseHeader("Alt-Location"),g=e.getResponseHeader(r),t[401===l||0===l?"warn":"error"]("["+i.getStack()+"]","service request failed",a.url,l,f,d?"SupportId: "+d:"",g?r+": "+g:""),(!s||m||function(e){return 401===e.status||!!(403===e.status&&e.responseJSON&&e.responseJSON.attributes&&e.responseJSON.attributes.userType&&"FinancialAdvisor"===e.responseJSON.attributes.userType)}(e))&&(!e.status||e.status<300||e.status>399||m)&&n(i,a,e,l)),m||p(e))})).catch((function(e){t.error("["+i.getStack()+"]","service request catch error",e),p(e)}))}))}}})),define("blue-app/dataMatch",[],(function(){"use strict";return function(e,t){var n,r=Object.keys(e||Object.create(null)),o=Object.keys(t||Object.create(null));if(r.length!==o.length)return!1;if(!r.length)return!0;for(var a=0,i=r.length;a<i;a++)if(e[n=r[a]]!==t[n])return!1;return!0}})),define("blue-app/service/interceptor/cache",["require","blue/deferred","blue/util","../../dataMatch"],(function(e){"use strict";var t={},n=e("blue/deferred"),r=e("blue/util").object.deepClone,o=e("../../dataMatch"),a={DELETE:1,ONCE:1,SESSION:1},i=function(e,n,a,i){for(var s,u=t[i]&&t[i][e]||[],c=u.length;c--;)if(s=u[c],o(n,s.request))return a||"ONCE"!==s.usage||(u.splice(c,1),!u.length&&delete t[i][e]),r(s.response)},s=function(e,n,r){var a,i,s,u=n.response&&"DELETE"!==n.usage,c=n.request||{};for(u&&(t[r]||(t[r]={}),t[r][e]||(t[r][e]=[])),s=(i=t[r][e]||[]).length;s--;)if(a=i[s],o(c,a.request))return void(u?i[s]=n:(i.splice(s,1),!i.length&&delete t[r][e]));u&&i.push(n)},u=function(e){return new Promise((function(t){setTimeout((function(){t(e)}),0)}))},c=function(e,t,n){var r,o,i,u=(t||{})[e];if(u&&u.constructor===Array&&(r=u.length))for(;r--;)(i=u[r]||{}).url&&i.response&&a[i.usage]&&(o=i.url.split("?")[0],s(o,i,n))};return{around:function(e){var t,r=e.args[0],o=r.url.split("?")[0],l=r.data||{},p=r.method||r.type||"GET",d=r.cachePropName||"cache",f=a[r.cacheResponse]&&r.cacheResponse,m=r.cacheData,g=m&&m.usage&&a[m.usage]?m.usage:void 0,h=g&&m.response;if(g)return h&&h[d]?c(d,h,p):s(o,{usage:g,request:l,response:h},p),u(h);if(f&&!i(o,l,!0,p))t=new n,s(o,{usage:f,request:l,response:t.promise},p);else if(h=i(o,l,!1,p))return u(h);return e.proceed().then((function(e){return c(d,e,p),f&&(s(o,{usage:f,request:l,response:e},p),t.resolve(e)),e})).catch((function(e){throw f&&(s(o,{usage:"DELETE",request:l},p),t.reject(e)),e}))}}})),define("blue-app/with/serviceConfigAPI",[],(function(){"use strict";var e=Object.defineProperty;return function(){var t,n=[];e(this,"disableServiceAPI",{value:function(){delete this.serviceInterceptors},writable:!1,configurable:!0,enumerable:!1}),t=this.serviceSettings||void 0,e(this,"serviceSettings",{get:function(){return this.context.serviceSettings},set:function(e){this.context.serviceSettings=e},configurable:!0,enumerable:!1}),t&&(this.serviceSettings=t),e(this,"serviceInterceptors",{set:function(e){n=e.slice()},configurable:!0,enumerable:!1}),e(this.context,"getServiceInterceptors",{value:function(e){var t=[],r=[],o=this,a=o,i=e&&Object.getPrototypeOf(e).interceptors||[];return Object.prototype.hasOwnProperty.call(o,"serviceSettings")&&o.serviceSettings.interceptors&&(r=o.serviceSettings.interceptors.concat()),a.parent&&Object.prototype.hasOwnProperty.call(a.parent,"getServiceInterceptors")&&(t=a.parent.getServiceInterceptors()),t=t||[],n.reverse().concat(r.reverse()).concat(t).concat(i.reverse())},configurable:!0,enumerable:!1,writable:!1})}})),define("blue-app/service",["require","exports","module","blue/as/constructable","blue/as/contextual","blue/as/serializable","blue/log","./service/interceptor/header","./service/interceptor/error","./service/interceptor/cache","blue/is","./settings","blue/intercept","blue/http","blue/util","mout/object/mixIn","mout/random/guid","blue/store/enumerable/session","blue/store/enumerable/cookie","blue/root","blue/perf","blue-app/with/serviceConfigAPI","emitter-js"],(function(e,t,n){"use strict";var r=Object.create.bind(Object,null),o=e("blue/as/constructable"),a=e("blue/as/contextual"),i=e("blue/as/serializable"),s=e("blue/log"),u=e("./service/interceptor/header"),c=e("./service/interceptor/error"),l=e("./service/interceptor/cache"),p=e("blue/is"),d=e("./settings"),f=e("blue/intercept"),m=e("blue/http"),g=e("blue/util").object.deepClone,h=e("mout/object/mixIn"),b=e("mout/random/guid"),v=new(e("blue/store/enumerable/session"))("servicesettings"),y=new(e("blue/store/enumerable/cookie"))(null,!0),x=e("blue/root").channel,E=e("blue/perf"),S=e("blue-app/with/serviceConfigAPI"),C=e("emitter-js").default,w=Object.prototype.hasOwnProperty,_=n.config(),A=_&&_.CSRF||{},O=s("[blue:app]"),R=0,P=0;"undefined"!==x&&"string"==typeof x||(x=!1),x&&(x="id="+x),A.header=A.header||"x-jpmc-csrf-token",A.cookie=A.cookie||"authcsrftoken";var T=function(e,t){C(this),this.name=e,this.id="<"+e+"Service:"+R+++">",this.defineContext(t,{name:e,logger:s("[service:"+e+"]")}),this.defineConstruct(this.context),this.defineInterceptors(),S.call(this),Object.defineProperty(this,"serviceCalls",{set:function(e){for(var t,n=Object.keys(e),r=0,o=n.length;r<o;r++)t=n[r],this.addServiceCall(t,e[t].settings)},configurable:!0,enumerable:!1}),this._appliedLocalInterceptors=!1,E.count.call({id:this.id,ref:this},"blue/service","create",e)};return T.prototype=Object.create(C.prototype),T.prototype.constructor=T,T.prototype.http=m,T.prototype.interceptors=[u,c,l],T.prototype.addServiceCall=function(e,t){var n=this;p.undefined(this._serviceCalls)&&(this._serviceCalls=r()),this._serviceCalls[e]=r(),this.settings(e,t),this[e]=function(t,r){var o,a,i,s=n._serviceCalls[e];if(P++,o=P,p.undefined(s.settings)){var u=g(n.context.serviceSettings)||{};for(i in n._appliedLocalInterceptors||(!function(e,t){var n=e.length,r=0;if(n!==t.length)return!1;for(;r<=n;r++)if(e[r]!==t[r])return!1;return!0}(n._interceptors,Object.getPrototypeOf(n).interceptors)?n.interceptors=n._interceptors.concat(n.context.getServiceInterceptors(n)).reverse():n.interceptors=n.context.getServiceInterceptors(n).reverse(),n._appliedLocalInterceptors=!0),s.settings=n._serviceCalls[e].settings=u,s.defaults)w.call(s.defaults,i)&&(s.settings[i]=n._serviceCalls[e].settings[i]=s.defaults[i]);delete n._serviceCalls[e].defaults}return a=h({},s.settings,r||{}),n.prerequest(a,t),n.context.bubble("blue:service:serviceCallBegin",{msgType:"blue:service:serviceCallBegin",contextPath:n.context.getStack(),id:o,service:n.name||"",serviceCall:e,application:n.context.application&&n.context.application.name||"",area:n.context.area&&n.context.area.name||"",controller:n.context.controller&&n.context.controller.name||""}),new Promise((function(t,r){n.request(a).then((function(r){n.context.bubble("blue:service:serviceCallComplete",{msgType:"blue:service:serviceCallComplete",contextPath:n.context.getStack(),id:o,service:n.name||"",serviceCall:e,application:n.context.application&&n.context.application.name||"",area:n.context.area&&n.context.area.name||"",controller:n.context.controller&&n.context.controller.name||""}),t(r)})).catch((function(t){n.context.bubble("blue:service:serviceCallComplete",{msgType:"blue:service:serviceCallComplete",contextPath:n.context.getStack(),service:n.name||"",serviceCall:e,application:n.context.application&&n.context.application.name||"",area:n.context.area&&n.context.area.name||"",controller:n.context.controller&&n.context.controller.name||""}),r(t)}))}))}},T.prototype.destroy=function(){var e,t=Object.keys(this._serviceCalls),n=t.length;for(p.function(this.onDestroy)&&this.onDestroy();n--;)delete this[e=t[n]],delete this._serviceCalls[e];this.destroyConstruct(),this.destroyInterceptors(),this.destroyContext(),delete this._serviceCalls,delete this.serviceCalls,this.addServiceCall=this.destroy=this.prerequest=this.request=function(){},C.prototype.destroy.call(this),E.count.call({id:this.id},"blue/service","destroy",this.name)},T.prototype.prerequest=function(e,t){var n,o,a,i;return e.data=t||r(),0!==e.url.substr(0,4).toLowerCase().indexOf("http")&&(n=v.get("serviceFQDN"),e.url=n?n+e.url:e.url),A.token=y.get(A.cookie)||null,A.token&&d.set(A.cookie,A.token),a=(o=!(!A.disable&&!e.disableCsrf))||e.disableTrace,i=o||e.disableChannelId,e.headers=e.headers||{},a?a&&e.headers&&delete e.headers["x-jpmc-client-request-id"]:e.headers["x-jpmc-client-request-id"]=b(),!i&&x?e.headers["x-jpmc-channel"]=x:i&&e.headers&&delete e.headers["x-jpmc-channel"],o?o&&e.headers&&delete e.headers[A.header]:e.headers[A.header]=A.token||"NONE",e},T.prototype.request=function(e){return E.count("blue/service","request",e.url),new Promise(function(t,n){this.http.request(e).then((function(e){t(e)})).catch(function(t){O.warn("["+this.context.getStack()+"]","Service request failed (url:"+e.url+"; status:"+t.status+"; statusText:"+t.statusText+")"),n(t)}.bind(this))}.bind(this))},T.prototype.settings=function(e,t){var n;if(!(e in this._serviceCalls))throw new Error('service "'+e+'" does not exist');if(p.undefined(t))n=this._serviceCalls[e].defaults||this._serviceCalls[e].settings;else{if(!("url"in t))throw new Error('"url" is a required setting');this._serviceCalls[e].defaults=t,"settings"in this._serviceCalls[e]&&delete this._serviceCalls[e].settings}return n},i.call(T.prototype,(function(){return{id:this.id||"empty id"}})),o.call(T.prototype),T=a.call(T,{name:"service"}),f.withInterceptors.call(T.prototype,"request"),T})),define("blue-app/with/locationAPI",["require","blue/util","blue/log"],(function(e){"use strict";return function(){e("blue/util").object.map,e("blue/log")("[app]");this.changeProtocol=function(e){var t=document.location.href,n=document.location.protocol;document.location=encodeURI(t.replace(n,e))},this.changeServer=function(e){var t=document.location.href,n=document.location.host;document.location=encodeURI(t.replace("//"+n+"/","//"+e+"/"))},this.getLocationPath=function(){return document.location.pathname},this.getLocationProtocol=function(){return document.location.protocol},this.getLocationProtocolAndServer=function(){return document.location.origin},this.getLocationServer=function(){return document.location.host},this.getLocationURL=function(){return document.location.href},this.goURL=function(e,t){var n,r,o;if(t){if(!t.windowName)throw new TypeError('"windowName" is undefined');return n=t.windowName,r=Object.keys(t).length>1?(o=t,Object.keys(o).filter((function(e){return"windowName"!=e})).map((function(e){return o[e]?e+"="+o[e]:e})).join(",")):void 0,window.open(e,n,r)}setTimeout((function(){document.location=e}),0)}}})),define("blue-app/mvc/mapper/mapping",["blue/declare","blue/is"],(function(e,t){"use strict";return e({constructor:function(e){if(this.mapping=e,t.undefined(this.mapping))throw new TypeError('"mapping" is undefined')},lookup:function(){if(t.function(this.mapping.lookup))return this.mapping.lookup.apply(this.mapping,arguments);throw new TypeError('"mapping.lookup()" is not a function')},toString:function(){return" Mapping "}})})),define("blue-app/mvc/mapper",["require","blue/is","./mapper/mapping","blue/compose","blue/intercept","blue/declare","blue/log"],(function(e){"use strict";var t=e("blue/is"),n=e("./mapper/mapping"),r=e("blue/compose"),o=e("blue/intercept"),a=e("blue/declare"),i=e("blue/log")("[blue:app]"),s=function(e){return new n(e)};return a((function(){var e={constructor:function(){var e,t,n;if(arguments.length){for(e=[this],t=0;t<arguments.length;t++)e.push(arguments[t]);r.apply(r,e)}Object.defineProperty(this,"mappings",{get:function(){return n},set:function(e){n=e.map(s)},enumerable:!0}),this.defineInterceptors()},destroy:function(){this.destroyInterceptors()},mapRequest:function(){var e,n,r=arguments,o=!1;return this.mappings&&this.mappings.length&&("IdentityMapping"!==(e=this.mappings[this.mappings.length-1].mapping.toString())&&"ControllerNameMapping"!==e&&i.warn("'IdentityMapping' or 'ControllerNameMapping' should succeed all other route mappings."),this.mappings.some((function(e){return n=e.lookup.apply(e,r),t.defined(n)&&(n=n.split(",").map((function(e){return e.trim()})),o=n.length>0),o}),this)),n},toString:function(){return" Mapper "}};return o.withInterceptors.call(e,"mapRequest"),e}))})),define("blue-app/routeHandler",["blue/declare","blue-app/mvc/mapper"],(function(e,t){"use strict";return e(t,{constructor:function(){t.apply(this,arguments)}})})),define("blue-app/mvc/routingAPI",["require","blue/dom","blue/is","blue/util","blue/hash","blue/log"],(function(e){"use strict";var t,n=e("blue/dom"),r=e("blue/is"),o=e("blue/util"),a=e("blue/hash"),i=e("blue/log")("[app]"),s=o.object.merge,u=Object.defineProperty;function c(e){return!e.emit&&e.context&&e.context.emit?e.context:e}function l(e){for(var t=e;t.parent&&!Object.hasOwnProperty.call(t,"_layerType");)t=t.parent;return t}function p(e,t,n){var r,a,i=c(e),s=o.object.deepClone(t),u={app:"",area:"index",controller:"index",action:"index"},l={name:i.application?i.application.name:n.app.name,params:{}},p={name:i.area?i.area.name:n.area?n.area.name:"",params:{}},d={name:i.controller?i.controller.name:n.controller.name,params:{}},f={name:u.action,params:{}};for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&((r=s[a])?"string"==typeof r?s[a]={name:r,params:{}}:r.params||(r.params={}):s[a]={name:"",params:{}});return s.app.name&&s.action.name?s:(s.app.name&&(l.name=s.app.name),s.app.params&&(l.params=s.app.params),s.area.name&&(p.name=s.area.name),s.area.params&&(p.params=s.area.params),s.controller.name&&(d.name=s.controller.name),s.controller.params&&(d.params=s.controller.params),s.action.name&&(f.name=s.action.name),s.action.params&&(f.params=s.action.params),s.controller.name||s.action.name?s.action.name||(f.name=u.action):(d.name=u.controller,f.name=u.action),{app:l,area:p,controller:d,action:f,query:s.query})}function d(e,t,n){c(e).site.emitChildren("publicRoute",{route:t,isRedirect:n})}function f(e,t,n){c(e).site.emitChildren("privateRoute",{route:t,privateDataObject:n})}function m(){var e=r.string(arguments[0])?this.routeToObject(arguments[0]):arguments[0],t=arguments[1]||{},n=e.query?e.query.params:{},o=this.routeToObject();return r.string(arguments[0])&&arguments[0].length&&!arguments[1]&&"."!==arguments[0][0]?arguments[0]:((e=p(this,e,o)).action.params=s(e.action.params,t,n),this.objectToRoute(e))}function g(e,t,n){var r,o,i,u,c=n.split("/").slice(2),l=[],p=[];for(o=e=e||"","/"===(r=e.split("?")[0])[0]&&(r=r.slice(1)),l=r.split("/");"#"===l[0];)l.shift();if("."===l[0]||".."===l[0]){for(p=c.concat(),"."===l[0]&&l.shift();".."===l[0]&&p[0];)l.shift(),p.pop();p=p.concat(l)}else p=l.concat();return i=p.pop(),"#"===o[0]&&(o=o.substr(1)),u=a.getParamsObj(o),p.push(function(e,t){var n=a.parseSegment(e),r=a.getParamsObj(e)||{};return n.params=s(n.params,t,r),a.segmentObjectToString(n)}(i,s(t,u))),"/"+p.join("/")}function h(e){var t,r,o,i,s={app:{name:"",params:{}},area:{name:"",params:{}},controller:{name:"",params:{}},action:{name:"",params:{}},query:{string:"",params:{}}};if(!(t=function(e){var t,n=e;if(!n)return"";for((t=n.indexOf("#"))>=0&&(n=n.length<=t+1?"":n.substr(t+1));"/"===n[0]||"#"===n[0];)n=n.substr(1);return n}(e||n.location.href)))return s;for(o=(r=t.split("?"))[0].split("/");"#"===o[0];)o.shift();return i=o.length,"."===o[0]&&2===i?s.action=a.parseSegment(o[1]):".."===o[0]&&2===i?s.controller=a.parseSegment(o[1]):".."===o[0]&&3===i?(s.controller=a.parseSegment(o[1]),s.action=a.parseSegment(o[2])):(3===i&&(s.app=a.parseSegment(o[0]),s.controller=a.parseSegment(o[1]),s.action=a.parseSegment(o[2])),4===i&&(s.app=a.parseSegment(o[0]),s.area=a.parseSegment(o[1]),s.controller=a.parseSegment(o[2]),s.action=a.parseSegment(o[3]))),r[1]&&(s.query.string=r[1],s.query.params=a.getParamsObj(t)||{}),s}return(t=function(){u(this,"routeToObject",{value:function(e){return p(this,h(e),h(n.location.href))},configurable:!0,enumerable:!1}),u(this,"objectToRoute",{value:function(e){var t,n="";return t=p(this,e,this.routeToObject()),n+="/"+a.segmentObjectToString(t.app),t.area&&t.area.name&&(n+="/"+a.segmentObjectToString(t.area)),n+="/"+a.segmentObjectToString(t.controller),n+="/"+a.segmentObjectToString(t.action),t.query&&t.query.string&&(n+="?"===t.query.string[0]?t.query.string:"?"+t.query.string),n},configurable:!0,enumerable:!1}),u(this,"state",{value:function(){var e,t,n=arguments[1]||{},o=c(this);return 0===arguments.length?this.routeToObject():(void 0!==arguments[2]&&(t=!!arguments[2]),(e=r.string(arguments[0])&&arguments[0].length?g(arguments[0],n,l(o).getStack()):m.apply(this,arguments))&&d(this,e,t),e)},configurable:!0,enumerable:!0}),u(this,"privateState",{value:function(){var e,t,n,o=c(this);if(0===arguments.length)return this.routeToObject();if(arguments[1]){if(arguments[1].privateDataObject){t=arguments[1].privateDataObject;try{t=JSON.parse(JSON.stringify(t))}catch(e){i.error("privateState - Unable to serialize privateDataObject"),t={}}}delete arguments[1].privateDataObject}return n=arguments[1]||{},(e=r.string(arguments[0])&&arguments[0].length?g(arguments[0],n,l(o).getStack()):m.apply(this,arguments))&&f(this,e,t),e},configurable:!0,enumerable:!0}),u(this,"replaceState",{value:function(){var e;return 0===arguments.length?this.routeToObject():((e=m.apply(this,arguments))&&(a.replaceHash(e),f(this,e)),e)},configurable:!0,enumerable:!0})}).clean=function(){delete this.routeToObject,delete this.objectToRoute,delete this.state,delete this.privateState,delete this.replaceState},t})),define("blue-app/mvc/handler",["require","blue-app/mvc/routingAPI","blue/log","blue-app/routeHandler","./mapper/mapping","blue/util","blue/event/channel/component","blue/declare","blue/hash","blue/is","blue/util"],(function(e){"use strict";var t="index",n={application:["controller","area"],area:["controller"],controller:[]},r=void 0,o=e("blue-app/mvc/routingAPI"),a=e("blue/log"),i=e("blue-app/routeHandler"),s=e("./mapper/mapping"),u=e("blue/util").object.deepClone,c=e("blue/event/channel/component"),l=e("blue/declare"),p=e("blue/hash"),d=e("blue/is"),f=e("blue/util"),m=a("[blue:app]"),g=f.object.mixIn;function h(e){return(e.map((function(e){return e.name}))||[]).join(".")}function b(e){return e.substr(0,1).toUpperCase()+e.substr(1)}function v(e){var t=e.replace(/^ROOT\/SITE/,"").replace(/\/index$/,"");return 0===p.getHash().replace(/\?.*$/,"").split("/").map((function(e){return p.parseSegment(e).name})).join("/").indexOf(t)}function y(e,t){return e.actions?e.actions[t]:e[t]}function x(e,t,n,o){var a,i,s=this,u=n.controller?n.controller.getStack():n.getStack(),l=n.area?n.area.name:"",p={};return t?(a=n.page&&n.page.viewResolverOptions?n.page.viewResolverOptions:r,p={routeId:o,controllerAction:e,resolverPathOptions:a,viewEngine:n.viewEngine,areaName:l,contextStack:u,activityChannel:c},(i=t,d.thenable(i.promise)?i.promise:Promise.resolve(i)).then((function(e){p.cavList=e,n.bubble("blue:application:display",p)}),(function(e){throw m.warn("["+s.context.getStack()+"]","Action promise failed",e),e}))):Promise.resolve()}function E(e,t,n){var r,o,i=e.context.area?e.context.area.areaName:"",s={},c={};if(t&&t.segments&&t.segments[0]){if((o=t.segments[0].name)&&(r=y(e,o))&&d.function(r))return function(e,t,n,r,o,i){var s,c,l,p=y(e,t),f=e.context.newChild(),h=e.context.area?e.context.area.name:"",b={},v={},E=function(){setTimeout(f.destroy.bind(f),0)};e.context.bubble("blue:route:executeAction",{msgType:"blue:route:executeAction",id:n,contextPath:e.context.getStack(),route:t,params:r,query:o}),f.name=t,f.logger=a("[action:"+t+"]"),f.routeId=n,l=g({},r,o.params||{}),Object.keys(l).forEach((function(e){Object.defineProperty(f,e,{value:l[e],enumerable:!0,configurable:!0})})),i&&(f.privateDataObject=i);try{s=p.call(e,f)}catch(n){v.code="blue:app:error:actionExecutionError",v.description="Error in execution-of-action "+t,m.error("["+e.context.getStack()+"]",v.description,n),e.context.broadcast(v.code,v),(b=u(v)).code="blue:error:app:actionExecutionError",e.context.bubble(b.code,b)}finally{h&&e.context.application.emit("spinner:off",{name:h})}return s&&(c=x(t,s,f,n),d.thenable(s)?s.then(E,E):d.thenable(s.promise)?s.promise.then(E,E):f.destroy()),e.context.bubble("blue:route:executeActionComplete",{msgType:"blue:route:executeActionComplete",id:n,contextPath:e.context.getStack(),route:t,params:r,query:o}),c}(e,o,t.routeId,t.segmentParams,t.query,t.privateDataObject);if(n)return i&&e.context.application.emit("spinner:off",{name:i}),c.code="blue:route:error:actionNotResolved",c.description="Error resolving executable-action for ",m.error("["+e.context.getStack()+"]",c.description,t),c.description+=o,e.context.broadcast(c.code,c),(s=u(c)).code="blue:error:route:actionNotResolved",e.context.bubble(s.code,s),Promise.reject()}return Promise.resolve()}return l(i,{constructor:function(){i.apply(this,arguments),this.paramsCache={},this.api=o,this.removeApi=o.clean,this.layerType="",this.handlerType="mvc"},getCachedParams:function(e){var t=this.paramsCache[e];return t?(delete this.paramsCache[e],t):r},addMapping:function(e,t){this.mappings||(this.mappings=[]),this.mappings.push(new s(new e(t)))},handleRequest:function(e,r){var o,a,i=this,s=0===r.segments.length,c=h(r.segments)||t,l=r.segments.map((function(e){return e.params||{}}))||[],d={name:t,params:{}},f={},y=function(t){var o=r.segmentParams;return o&&v(e.context.getStack())&&(g(e.context,o),Object.keys(o).forEach((function(t){Object.defineProperty(e.context,t,{value:o[t],enumerable:!0,configurable:!0})}))),E(e,t,!n[i.layerType].length)};i.paramsCache[r.routeId]=r.segmentParams,e.context.bubble("blue:route:handleRouteRequest",{msgType:"blue:route:handleRouteRequest",id:r.routeId,source:r.source,contextPath:e.context.getStack(),route:h(r.segments),nextSegment:r.segments[0]?r.segments[0].name:"",segments:r.segments,segmentParams:r.segmentParams,query:r.query}),v(e.context.getStack())&&s&&p.addSegmentToCurrentHash(t),(f=u(r)).query=f.query||{string:"",params:{}},f.onSuccess=void 0,o=i.mapRequest(c,f),a=o.length,o&&0!==a?o.forEach((function(t,o){var s,c,p,f,h=(f=l,(p=t)?p.split(".").map((function(e,t){return{name:e,params:f[t]||{}}})):[]),x={},E={},S=[],C=h.shift(),w=u(r);w.segments=h,w.segmentParams=C.params||{},n[i.layerType].length?(S=n[i.layerType].filter((function(e){return function(e,t,n){return e["is"+b(n)](t)}(i.registry,C.name,e)})))[0]?(s=S[0],e.context.bubble("blue:route:mappedRequest",{msgType:"blue:route:mappedRequest",id:r.routeId,source:r.source,contextPath:e.context.getStack(),route:t,nextSegment:C.name,nextSegmentType:s,segments:h}),"area"===s&&e.context.application.emit("spinner:on",{name:C.name}),e.context.bubble("blue:route:lazyLoad",{msgType:"blue:route:lazyLoad",id:r.routeId,source:r.source,contextPath:e.context.getStack(),route:t,nextSegment:C.name,nextSegmentType:s,segments:h}),function(e,t,n){return e["get"+(n.substr(0,1).toUpperCase()+n.substr(1))](t)}(i.registry,C.name,s).then((function(n){w.segments=h,w.onSuccess.push(y.bind(e,w)),n.context.emit("blue:route:routeRequest",w),e.context.bubble("blue:route:lazyLoadComplete",{msgType:"blue:route:lazyLoadComplete",id:r.routeId,source:r.source,contextPath:e.context.getStack(),route:t,nextSegment:C.name,nextSegmentType:s,segments:h})})).catch((function(n){var o=e.context.area?e.context.area.areaName:"";o&&e.context.application.emit("spinner:off",{name:o}),e.context.bubble("blue:route:lazyLoadComplete",{msgType:"blue:route:lazyLoadComplete",id:r.routeId,source:r.source,contextPath:e.context.getStack(),route:t,nextSegment:C.name,nextSegmentType:s,segments:h}),n.requireType&&"timeout"===n.requireType?(m.error("["+e.context.getStack()+"]","Network timeout loading "+s+' module "'+C.name+'". Error: '+n.message),E.code="blue:route:error:areaLoadTimeout",E.description=b(s)+" "+C.name+" failed to load due to network timeout. Application may not proceed normally.",e.context.broadcast("blue:route:error:"+s+"LoadTimeout",E),(x=u(E)).code="blue:error:route:moduleNotFound",e.context.bubble("blue:error:route:"+s+"LoadTimeout",x)):(m.error("["+e.context.getStack()+"]","Unable to invoke "+b(s)+' "'+C.name+'". Error: '+n.message),E.code="blue:route:error:areaNotFound",E.description="Defined "+s+" "+C.name+" could not be invoked. Application may not proceed normally.",e.context.broadcast("blue:route:error:"+s+"NotFound",E),(x=u(E)).code="blue:error:route:moduleNotFound",e.context.bubble("blue:error:route:"+s+"NotFound",x))}))):(c=n[i.layerType].map((function(e){return b(e)})).join(" or "),m.error("["+e.context.getStack()+"]",c+' "'+C.name+'" not found. Note: It could be mapped as an alias too, check your application main.js'),E.code="blue:route:error:moduleNotFound",E.description="A non-existent "+c+" has been requested by route. Application may not proceed normally.",e.context.broadcast(E.code,E),(x=u(E)).code="blue:error:route:moduleNotFound",e.context.bubble(x.code,x)):(g(C.params,w.query.params||{}),w.segments.unshift(C||d),v(e.context.getStack())||(w.onSuccess=[]),w.onSuccess.push(y.bind(e,w)),e.context.bubble("blue:route:mappedRequest",{msgType:"blue:route:mappedRequest",id:r.routeId,source:r.source,mappedLength:a,contextPath:e.context.getStack(),route:t,nextSegment:C.name,nextSegmentType:"action",segments:h}),w.onSuccess.forEach((function(e){e()})))})):m.warn("["+e.context.getStack()+"]",e.context.name+" mapped route to null action list for routeRequest:",c)},handleSuccess:function(e,t){var n=this.getCachedParams(e);n&&v(t.context.getStack())&&g(t.context,n)},toString:function(){return" MvcHandler "}})})),define("blue-app/nesting/routingAPI",["require","blue/dom","blue/is","blue/util","blue/hash","blue/log"],(function(e){"use strict";var t,n=e("blue/dom"),r=e("blue/is"),o=e("blue/util"),a=e("blue/hash"),i=e("blue/log")("[app]"),s=o.object.merge,u=Object.defineProperty;function c(e){return!e.emit&&e.context&&e.context.emit?e.context:e}function l(e){var t,n=e;if(!n)return"";for((t=n.indexOf("#"))>=0&&(n=n.length<=t+1?"":n.substr(t+1));"/"===n[0]||"#"===n[0];)n=n.substr(1);return n}function p(e,t,n){c(e).site.emitChildren("publicRoute",{route:t,isRedirect:n})}function d(e,t,n){c(e).site.emitChildren("privateRoute",{route:t,privateDataObject:n})}function f(e){return function(e){var t=[],n=l(e).split("?",2);return n[0].split("/").forEach((function(e){e.length&&t.push(a.parseSegment(e))})),t.query={},t.query.string=n[1]||"",t.query.params=a.getParamsObj(e)||{},t}(e||l(n.location.href))}function m(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++){if(!e[t].name)throw new Error("normalizeRouteObject: invalid route object, missing segment name");e[t].params||(e[t].params={})}return e.query||(e.query={string:"",params:{}}),e}if(void 0===e)return f();throw new Error("normalizeRouteObject: invalid route object")}function g(){var e=r.string(arguments[0])?this.routeToObject(arguments[0]):m(arguments[0]),t=arguments[1]||{},n=e[e.length-1].params||{},o=e.query?e.query.params:{};return r.string(arguments[0])&&arguments[0].length&&!arguments[1]&&"."!==arguments[0][0]?arguments[0]:(e[e.length-1].params=s(n,t,o),this.objectToRoute(e))}return(t=function(){u(this,"routeToObject",{value:function(e){return r.string(e)?e?f(function(e,t){var n="",r=[],o=t.split("/").slice(2);if(!e)throw new Error("normalizeRouteString: route is empty");if("string"!=typeof e)throw new Error("normalizeRouteString: route must be of type string");if((n=l(e)).match(/^\.{1,2}/)){for(r=n.split("/");"."===r[0]||".."===r[0];)".."===r.shift()&&o.pop();n=o.concat(r).join("/")}return n}(e,function(e){for(var t=e;t.parent&&!Object.hasOwnProperty.call(t,"_layerType");)t=t.parent;return t}(c(this)).getStack())):f():void 0===e?f():m(e)},configurable:!0,enumerable:!1}),u(this,"objectToRoute",{value:function(e){var t=m(e),n="";return n=t.map((function(e){return"/"+a.segmentObjectToString(e)})).join(""),t.query&&t.query.string&&(n+="?"+t.query.string),n},configurable:!0,enumerable:!1}),u(this,"state",{value:function(){var e,t;return 0===arguments.length?this.routeToObject():(void 0!==arguments[2]&&(t=!!arguments[2]),(e=g.apply(this,arguments))&&p(this,e,t),e)},configurable:!0,enumerable:!0}),u(this,"privateState",{value:function(){var e,t;if(0===arguments.length)return this.routeToObject();if(arguments[1]){if(arguments[1].privateDataObject){t=arguments[1].privateDataObject;try{t=JSON.parse(JSON.stringify(t))}catch(e){i.error("privateState - Unable to serialize privateDataObject"),t={}}}delete arguments[1].privateDataObject}return(e=g.apply(this,arguments))&&d(this,e,t),e},configurable:!0,enumerable:!0}),u(this,"replaceState",{value:function(){var e;return 0===arguments.length?this.routeToObject():((e=g.apply(this,arguments))&&(a.replaceHash(e),d(this,e)),e)},configurable:!0,enumerable:!0})}).clean=function(){delete this.routeToObject,delete this.objectToRoute,delete this.state,delete this.privateState,delete this.replaceState},t})),define("blue-app/nesting/mapper/mapping",["blue/declare","blue/is"],(function(e,t){"use strict";return e({constructor:function(e){if(this.mapping=e,t.undefined(this.mapping))throw new TypeError('"mapping" is undefined')},lookup:function(){if(t.function(this.mapping.lookup))return this.mapping.lookup.apply(this.mapping,arguments);throw new TypeError('"mapping.lookup()" is not a function')},toString:function(){return" Mapping "}})})),define("blue-app/nesting/handler",["require","blue-app/nesting/routingAPI","blue/log","blue-app/routeHandler","./mapper/mapping","blue/util","blue/event/channel/component","blue/declare","blue/hash","blue/is","blue/util"],(function(e){"use strict";var t="index",n={application:["controller","area"],area:["controller"],controller:["controller"]},r=void 0,o=e("blue-app/nesting/routingAPI"),a=e("blue/log"),i=e("blue-app/routeHandler"),s=e("./mapper/mapping"),u=e("blue/util").object.deepClone,c=e("blue/event/channel/component"),l=e("blue/declare"),p=e("blue/hash"),d=e("blue/is"),f=e("blue/util"),m=a("[blue:app]"),g=f.object.mixIn;function h(e){return(e.map((function(e){return e.name}))||[]).join(".")}function b(e){return e.substr(0,1).toUpperCase()+e.substr(1)}function v(e){var t=e.replace(/^ROOT\/SITE/,"").replace(/\/index$/,"");return 0===p.getHash().replace(/\?.*$/,"").split("/").map((function(e){return p.parseSegment(e).name})).join("/").indexOf(t)}function y(e,t){return e.actions?e.actions[t]:e[t]}function x(e,t,n,o,i,s){var l,p,f,h=y(e,t),b=e.context.newChild(),v=e.context.area?e.context.area.name:"",x={},E={},S=function(){setTimeout(b.destroy.bind(b),0)};e.context.bubble("blue:route:executeAction",{msgType:"blue:route:executeAction",id:n,contextPath:e.context.getStack(),route:t,params:o,query:i}),b.name=t,b.logger=a("[action:"+t+"]"),b.routeId=n,f=g({},o,i.params||{}),Object.keys(f).forEach((function(e){Object.defineProperty(b,e,{value:f[e],enumerable:!0,configurable:!0})})),s&&(b.privateDataObject=s);try{l=h.call(e,b)}catch(n){E.code="blue:app:error:actionExecutionError",E.description="Error in execution-of-action "+t,m.error("["+e.context.getStack()+"]",E.description,n),e.context.broadcast(E.code,E),(x=u(E)).code="blue:error:app:actionExecutionError",e.context.bubble(x.code,x)}finally{v&&e.context.application.emit("spinner:off",{name:v})}return l&&(p=function(e,t,n,o){var a,i=this,s=n.controller?n.controller.getStack():n.getStack(),u=n.area?n.area.name:"",l={};return t?(a=n.page&&n.page.viewResolverOptions?n.page.viewResolverOptions:r,l={routeId:o,controllerAction:e,resolverPathOptions:a,viewEngine:n.viewEngine,areaName:u,contextStack:s,activityChannel:c},d.thenable(t.promise)?t.promise.then((function(e){l.cavList=e,n.bubble("blue:application:display",l)}),(function(e){throw m.warn("["+i.context.getStack()+"]","Action promise failed",e),e})):d.thenable(t)?t.then((function(e){l.cavList=e,n.bubble("blue:application:display",l)}),(function(e){throw m.warn("["+i.context.getStack()+"]","Action promise failed",e),e})):(l.cavList=t,n.bubble("blue:application:display",l),Promise.resolve())):Promise.resolve()}(t,l,b,n),d.thenable(l)?l.then(S,S):d.thenable(l.promise)?l.promise.then(S,S):b.destroy()),e.context.bubble("blue:route:executeActionComplete",{msgType:"blue:route:executeActionComplete",id:n,contextPath:e.context.getStack(),route:t,params:o,query:i}),p}return l(i,{constructor:function(){i.apply(this,arguments),this.paramsCache={},this.api=o,this.removeApi=o.clean,this.handlerType="nesting"},getCachedParams:function(e){var t=this.paramsCache[e];return t?(delete this.paramsCache[e],t):r},addMapping:function(e,t){this.mappings||(this.mappings=[]),this.mappings.push(new s(new e(t)))},handleRequest:function(e,r){var o,a,i=this,s=0===r.segments.length,c=h(r.segments)||t,l=r.segments.map((function(e){return e.params||{}}))||[],f={name:t,params:{}},E={},S=function(t){var n=r.segmentParams,o=1===t.segments.length;return n&&v(e.context.getStack())&&(g(e.context,n),Object.keys(n).forEach((function(t){Object.defineProperty(e.context,t,{value:n[t],enumerable:!0,configurable:!0})}))),function(e,t,n){var r,o,a=e.context.area?e.context.area.areaName:"",i={},s={};if(t&&t.segments&&t.segments[0]){if((o=t.segments[0].name)&&(r=y(e,o))&&d.function(r))return x(e,o,t.routeId,t.segmentParams,t.query,t.privateDataObject);if(n)return a&&e.context.application.emit("spinner:off",{name:a}),s.code="blue:route:error:actionNotResolved",s.description="Error resolving executable-action for ",m.error("["+e.context.getStack()+"]",s.description,t),s.description+=o,e.context.broadcast(s.code,s),(i=u(s)).code="blue:error:route:actionNotResolved",e.context.bubble(i.code,i),Promise.reject()}return Promise.resolve()}(e,t,o)};i.paramsCache[r.routeId]=r.segmentParams,e.context.bubble("blue:route:handleRouteRequest",{msgType:"blue:route:handleRouteRequest",id:r.routeId,source:r.source,contextPath:e.context.getStack(),route:h(r.segments),nextSegment:r.segments[0]?r.segments[0].name:"",segments:r.segments,segmentParams:r.segmentParams,query:r.query}),v(e.context.getStack())&&s&&p.addSegmentToCurrentHash(t),(E=u(r)).onSuccess=void 0,o=i.mapRequest(c,E),a=o.length,o&&0!==a?o.forEach((function(t,o){var s,c,p,d,h=(d=l,(p=t)?p.split(".").map((function(e,t){return{name:e,params:d[t]||{}}})):[]),x={},E={},C=[],w=h.shift(),_=u(r),A=w||f;_.segments=h,_.segmentParams=A.params||{},"function"==typeof y(e,A.name)?(g(A.params,_.query.params||{}),_.segments.unshift(A),v(e.context.getStack())||(_.onSuccess=[]),_.onSuccess.push(S.bind(e,_)),e.context.bubble("blue:route:mappedRequest",{msgType:"blue:route:mappedRequest",id:r.routeId,source:r.source,mappedLength:a,contextPath:e.context.getStack(),route:t,nextSegment:A.name,nextSegmentType:"action",segments:h}),_.onSuccess.forEach((function(e){e()}))):(C=n[i.layerType].filter((function(e){return function(e,t,n){return e["is"+b(n)](t)}(i.registry,A.name,e)})))[0]?(s=C[0],0===h.length&&h.push(u(f)),e.context.bubble("blue:route:mappedRequest",{msgType:"blue:route:mappedRequest",id:r.routeId,source:r.source,contextPath:e.context.getStack(),route:t,nextSegment:A.name,nextSegmentType:s,segments:h}),"area"===s&&e.context.application.emit("spinner:on",{name:A.name}),e.context.bubble("blue:route:lazyLoad",{msgType:"blue:route:lazyLoad",id:r.routeId,source:r.source,contextPath:e.context.getStack(),route:t,nextSegment:A.name,nextSegmentType:s,segments:h}),function(e,t,n){return e["get"+(n.substr(0,1).toUpperCase()+n.substr(1))](t)}(i.registry,A.name,s).then((function(n){_.segments=h,_.segments.unshift(A),_.onSuccess.push(S.bind(e,u(_))),_.segments.shift(),n.context.emit("blue:route:routeRequest",_),e.context.bubble("blue:route:lazyLoadComplete",{msgType:"blue:route:lazyLoadComplete",id:r.routeId,source:r.source,contextPath:e.context.getStack(),route:t,nextSegment:A.name,nextSegmentType:s,segments:h})})).catch((function(n){var o=e.context.area?e.context.area.areaName:"";o&&e.context.application.emit("spinner:off",{name:o}),e.context.bubble("blue:route:lazyLoadComplete",{msgType:"blue:route:lazyLoadComplete",id:r.routeId,source:r.source,contextPath:e.context.getStack(),route:t,nextSegment:A.name,nextSegmentType:s,segments:h}),n.requireType&&"timeout"===n.requireType?(m.error("["+e.context.getStack()+"]","Network timeout loading "+s+' module "'+A.name+'". Error: '+n.message),E.code="blue:route:error:areaLoadTimeout",E.description=b(s)+" "+A.name+" failed to load due to network timeout. Application may not proceed normally.",e.context.broadcast("blue:route:error:"+s+"LoadTimeout",E),(x=u(E)).code="blue:error:route:moduleNotFound",e.context.bubble("blue:error:route:"+s+"LoadTimeout",x)):(m.error("["+e.context.getStack()+"]","Unable to invoke "+b(s)+' "'+A.name+'". Error: '+n.message),E.code="blue:route:error:areaNotFound",E.description="Defined "+s+" "+A.name+" could not be invoked. Application may not proceed normally.",e.context.broadcast("blue:route:error:"+s+"NotFound",E),(x=u(E)).code="blue:error:route:moduleNotFound",e.context.bubble("blue:error:route:"+s+"NotFound",x))}))):(c=n[i.layerType].map((function(e){return b(e)})).join(" or "),m.error("["+e.context.getStack()+"]",c+' "'+A.name+'" not found. Note: It could be mapped as an alias too, check your application main.js'),E.code="blue:route:error:moduleNotFound",E.description="A non-existent "+c+" has been requested by route. Application may not proceed normally.",e.context.broadcast(E.code,E),(x=u(E)).code="blue:error:route:moduleNotFound",e.context.bubble(x.code,x))})):m.warn("["+e.context.getStack()+"]",e.context.name+" mapped route to null action list for routeRequest:",c)},handleSuccess:function(e,t){var n=this.getCachedParams(e);n&&v(t.context.getStack())&&g(t.context,n)},toString:function(){return" NestingHandler "}})})),define("blue-app/mvc/handler/mapping/controllerName",["blue/declare"],(function(e){"use strict";return e({constructor:function(){},lookup:function(e){return e},toString:function(){return"ControllerNameMapping"}})})),define("blue-app/mvc/mapper/mapping/identity",["blue/declare"],(function(e){"use strict";return e({constructor:function(){},lookup:function(e){return e},toString:function(){return"IdentityMapping"}})})),define("blue-app/mvc/mapper/mapping/simplePattern",["blue/declare","blue/is"],(function(e,t){"use strict";return e({constructor:function(e){if(!t.plainObject(e))throw new TypeError('"mappings" must be a plain object');this.mappings=e},lookup:function(e){var t=e?e.split("."):[],n=t[0]||"",r=t[0]&&t[1]?t[0]+"."+t[1]:"";return this.mappings[e]||this.mappings[r]||this.mappings[n]},toString:function(){return" Simple Pattern Mapping "}})})),define("blue-app/mvc/mapper/mapping/simplePatternAdditive",["blue/declare","blue/is"],(function(e,t){"use strict";return e({constructor:function(e){if(!t.plainObject(e))throw new TypeError('"mappings" must be a plain object');this.mappings=e},lookup:function(e){var t,n,r=e?e.split("."):[],o=r[0]||"",a=r[0]&&r[1]?r[0]+"."+r[1]:"";return(t=this.mappings[e]||this.mappings[a]||this.mappings[o])&&(n=e+","+t),n},toString:function(){return" Simple Pattern Mapping "}})})),define("blue-app/with/routable",["require","blue/is","blue-app/routeHandler","blue-app/mvc/handler","blue-app/nesting/handler","blue-app/mvc/handler/mapping/controllerName","blue-app/mvc/mapper/mapping/identity","blue-app/mvc/mapper/mapping/simplePattern","blue-app/mvc/mapper/mapping/simplePatternAdditive"],(function(e){"use strict";var t=Object.defineProperty,n=e("blue/is"),r=e("blue-app/routeHandler"),o=e("blue-app/mvc/handler"),a=e("blue-app/nesting/handler"),i=e("blue-app/mvc/handler/mapping/controllerName"),s={IdentityMapping:e("blue-app/mvc/mapper/mapping/identity"),ControllerNameMapping:i,SimpleUrlMapping:e("blue-app/mvc/mapper/mapping/simplePattern"),SimpleUrlAdditiveMapping:e("blue-app/mvc/mapper/mapping/simplePatternAdditive")},u={mvc:o,nesting:a};return function(e,o){var a,i=this;i.context&&(i.context._layerType=o),t(i,"routeHandler",{get:function(){return a},set:function(t){var s,c=a,l={};if("string"==typeof t)if(u[t])l.handler=new u[t],i.context._routeHandlerType=t;else{if("default"!==t)throw new Error("Unknown route handler type");s=i.getDefaultRouteHandler(),l.handler=new u[s],i.context._routeHandlerType=s}else t instanceof r?l.handler=t:l=t;l.handler&&(c&&c.removeApi.call(i.context),(a=l.handler).registry=e,a.layerType=o,i.context._routeHandlerType=l.handler.handlerType||"unknown"),Array.isArray(l.mappings)&&l.mappings.forEach((function(e){n.string(e)?i.addRouteMapping(e):e.mapping&&i.addRouteMapping(e.mapping,e.config)})),a.api.call(i.context)},enumerable:!1}),t(i,"addRouteMapping",{value:function(){var e=Array.prototype.slice.call(arguments);if(i.routeHandler){if(n.string(e[0])){if(!s[e[0]])throw new Error("Unknown route mapping: "+e[0]);e[0]=s[e[0]]}i.routeHandler.addMapping.apply(i.routeHandler,e)}},configurable:!0,enumerable:!1,writable:!1}),t(i,"addRouteInterceptor",{value:function(){i.routeHandler&&i.routeHandler.addInterceptor.apply(i.routeHandler,arguments)},configurable:!0,enumerable:!1,writable:!1}),i.context.on("blue:route:routeRequest",(function(e){i.routeHandler.handleRequest(i,e)}))}})),define("blue-app/controller",["require","blue/compose","blue/is","blue/log","blue/event/lifecycle","./component","blue-app/service","blue/observable","./with/locationAPI","blue-app/with/serviceConfigAPI","blue/as/contextual","blue/as/constructable","blue/as/dataProvider","blue/as/registry","blue/as/serializable","blue-app/with/routable","blue/perf","blue/intercept","emitter-js"],(function(e){"use strict";var t,n=Object.defineProperty,r=e("blue/compose"),o=e("blue/is"),a=e("blue/log"),i=e("blue/event/lifecycle"),s=e("./component"),u=e("blue-app/service"),c=e("blue/observable"),l=e("./with/locationAPI"),p=e("blue-app/with/serviceConfigAPI"),d=e("blue/as/contextual"),f=e("blue/as/constructable"),m=e("blue/as/dataProvider"),g=e("blue/as/registry"),h=e("blue/as/serializable"),b=e("blue-app/with/routable"),v=e("blue/perf"),y=a("[blue:app]"),x=e("blue/intercept"),E=e("emitter-js").default,S=0,C=function(e,t){var r,s=this,u=c.Model();E(s),s.defineContext(t,{name:e,controllerName:e,logger:a("[controller:"+e+"]")}),s.defineConstruct(s.context),s.name=e,s.id="<"+e+"Controller:"+S+++">",n(s,"model",{get:function(){return u},set:function(e){e||(e={}),u!==e&&(u&&o.function(u.lens)&&u.destroy(),o.function(e.lens)?(e.destroyed&&(y.error("["+s.context.getStack()+"]","Tried to create-controller with destroyed model"),e=c.Model()),u=e):u=c.Model(e))},enumerable:!0}),n(s,"viewPath",{get:function(){return s.context.page?s.context.page.viewResolverOptions:undefined},set:function(e){!Object.hasOwnProperty.call(s.context,"page")&&(s.context.page={}),s.context.page.viewResolverOptions=e}}),r=m(s),s.defineControllersRegistry(s.context),s.defineComponentsRegistry(s.context),s.defineServicesRegistry(s.context),b.call(s,s.registry,"controller"),s.routeHandler="default",s.register={components:function(e,t){t.forEach((function(e){var t,n=e.name;try{e.keepAlive=!0,e.legacy=!0,e.controller=s,t=s.registry.hasComponent(n)?s.registry.destroyComponent(n):Promise.resolve(),s.registry.registerComponent(n,e,!0),s.components[n].oldComponent=t}catch(e){throw y.error("["+s.context.getStack()+"]","Problems wiring together component "+n,e),e}}))}},s.executeCAV=s.context.executeCAV.bind(s.context),s.destroy=function(){var e,t,n;return o.function(s.onDestroy)&&s.onDestroy(),t=new i({type:"controller",action:"destroy",stage:"begin",name:s.context&&s.context.name}),s.context.bubble(t.msgType,t),e=Promise.all([s.destroyControllersRegistry(),s.destroyComponentsRegistry(),s.destroyServicesRegistry()]).catch((function(){})).then((function(){r.destroy(),s.destroyConstruct(),n=new i({type:"controller",action:"destroy",stage:"begin",name:s.context&&s.context.name,beginEventName:t.eventName}),s.context.bubble(n.msgType,n),s.destroyContext(),E.prototype.destroy.call(s)})),v.count.call({id:s.id},"blue/controller","destroy",s.name),e},p.call(s),s.context.parent!==s.context.application&&(s.context.area=s.context.parent),v.count.call({id:s.id,ref:s},"blue/controller","create",s.name)};return C.prototype=Object.create(E.prototype),C.prototype.constructor=C,C.prototype.reroute=function(e){this.context.site.emitChildren("publicRoute",{route:e})},C.prototype.returnData=function(e){return e},C.prototype.getDefaultRouteHandler=function(){return this.context&&this.context.parent&&this.context.parent._routeHandlerType?this.context.parent._routeHandlerType:"mvc"},h.call(C.prototype,(function(){return{CtrlID:this.id||"empty id",components:this.components?Object.keys(this.components):"empty components"}})),C=d.call(C,{name:"controller"}),f.call(C.prototype),g.call(C.prototype,"controller",C,{lazy:!0,onAfterCreate:function(e,t){return t.routeHandler.mappings&&t.routeHandler.mappings.length||t.addRouteMapping("IdentityMapping"),t},immediate:!1}),g.call(C.prototype,"component",s,{onCreate:function(e,t){var n,r=this;if("model"in t){switch(t.model||y.warn("["+r.context.getStack()+"]","Component registry model passed as a 'falsy' value, resulting in empty lens path."),(n=t.model)&&n.constructor){case Object:case r.model.constructor:return;case String:break;default:n=""}t.model=n?r.model.lens(n):r.model.lens()}}}),g.call(C.prototype,"service",u),r(C.prototype,l),t=new l,Object.keys(t).forEach((function(e){x.after(C.prototype,e,(function(){y.warn("DEPRECATED:BLUEJS-3264: calling locationAPI "+e+" from controller module has been deprecated. Use context.location."+e+" instead")}))})),C})),define("blue-app/area",["require","./controller","./service","blue/site","blue/as/registry","blue/as/constructable","blue/as/contextual","blue/is","blue/log","blue-app/with/serviceConfigAPI","blue-app/with/routable","./routeHandler","./mvc/handler","wire","emitter-js"],(function(e){"use strict";var t=e("./controller"),n=e("./service"),r=e("blue/site"),o=e("blue/as/registry"),a=e("blue/as/constructable"),i=e("blue/as/contextual"),s=e("blue/is"),u=e("blue/log"),c=e("blue-app/with/serviceConfigAPI"),l=e("blue-app/with/routable"),p=e("./routeHandler"),d=e("./mvc/handler"),f=e("wire"),m=e("emitter-js").default,g=function(e,t){var n=this;m(n),this.defineContext(t,{name:e,areaName:e,logger:u("[area:"+e+"]"),page:{}}),this.name=e,this.defineConstruct(this.context),this.defineControllersRegistry(this.context),this.defineServicesRegistry(this.context),this.context.executeCAV=function(e){return n.context.application.executeCAV.call(this,e,n.context.areaName)},Object.defineProperties(this,{initialized:{value:!1,configurable:!0,enumerable:!1,writable:!1},viewPath:{get:function(){return n.context.page?n.context.page.viewResolverOptions:undefined},set:function(e){!Object.hasOwnProperty.call(n.context,"page")&&(n.context.page={}),n.context.page.viewResolverOptions=e}}}),l.call(this,this.registry,"area"),this.routeHandler=new d,c.call(this),this.wakeCount=0};return g.prototype=Object.create(m.prototype),g.prototype.constructor=g,g.prototype.loadSpec=function(){var e,t,n=this,o=new Promise((function(n,r){e=n,t=r})),a=[];return n.spec&&s.plainObject(n.spec)?f(n.spec).then((function(o){n.settings=o,n.mapAreaComponents(o),o.services&&(n.services=o.services),n.services&&(n.context.services=n.services),o.controllers&&(n.controllers=o.controllers),o.context&&n.configureAreaContext(n.context,o.context),o.imports?r.context._internal.import(n,o.imports).then((function(){e(n)}),t):e(n)})).catch((function(e){t(e)})):n.init||n.onInit||n.onLoad||n.onComplete?(n.services&&(n.context.services=n.services),e(n)):(n.mapAreaComponents(n),n.services&&(n.context.services=n.services),Object.keys(n.controllers).forEach((function(e){a.push(n.controllers[e])})),Promise.all(a).then((function(){e(n)}))),o},g.prototype.mapAreaComponents=function(e){var t,n=this,r=Object.keys(e);e.mappingHandler||r.some((function(r,o){return(t=e[r])instanceof p&&(n.routeHandler={handler:t},!0)}))},g.prototype.configureAreaContext=function(e,t){var n,r,o;if((r=Object.keys(t)).length)for(n=r.length;n--;)e[o=r[n]]=t[o],delete t[o]},g.prototype.destroy=function(){var e=this;return Promise.all([e.destroyControllersRegistry(),e.destroyServicesRegistry()]).catch((function(){})).then((function(){e.destroyConstruct(),e.destroyContext(),m.prototype.destroy.call(e),delete e.initialized}))},g.prototype.disable=function(){},g.prototype.enable=function(){this.initialized||!s.function(this.init)&&!s.function(this.onInit)||(Object.defineProperty(this,"initialized",{value:!0}),s.function(this.init)?this.init():this.onInit())},a.call(g.prototype),g=i.call(g,{name:"area"}),o.call(g.prototype,"controller",t,{lazy:!0,onAfterCreate:function(e,t){return t.routeHandler.mappings&&t.routeHandler.mappings.length||t.addRouteMapping("IdentityMapping"),t},immediate:!1}),o.call(g.prototype,"service",n,{immediate:!0}),g})),define("blue-app/mvc/targeter",["require","blue-app/mvc/mapper","blue/declare"],(function(e){"use strict";var t=e("blue-app/mvc/mapper");return e("blue/declare")(t,{constructor:function(){t.call(this)},targetRequest:function(e,t){return this.mapRequest(e,t)},toString:function(){return" Targeter "}})})),define("blue-app/load",["require","blue/is","blue/resolver/module"],(function(e){"use strict";var t=e("blue/is"),n=new(e("blue/resolver/module"));return n.prefix="wire!",n.suffix="/main",function(e,r,o){if(!t.string(e))throw new TypeError("name must be a string");if(!t.function(r))throw new TypeError("callback must be a function");void 0===o&&(o=this),n.resolve(e).onValue((function(e){r.call(o,e)}))}})),define("blue-app/cache/oneTimeCache",["blue/declare","blue/store/enumerable/memory"],(function(e,t){"use strict";return new(e({constructor:function(){this.store=new t("OneTimeCache")},has:function(e){return this.store.has(e)},get:function(e){var t=this.store.get(e);return this.store.remove(e),t},set:function(e,t){this.store.set(e,t)},remove:function(e){this.store.remove(e)}}))})),define("blue-app/cache/sessionCache",["blue/declare","blue/store/enumerable/memory"],(function(e,t){"use strict";return new(e({constructor:function(){this.store=new t("SessionCache")},has:function(e){return this.store.has(e)},get:function(e){return this.store.get(e)},set:function(e,t){this.store.set(e,t)},remove:function(e){this.store.remove(e)}}))})),define("blue-app/app",["require","exports","module","blue/as/contextual","blue/as/constructable","blue/as/registry","blue/site","blue-app/area","blue-app/service","blue-app/controller","blue/deferred","blue/event/channel","blue/event/channel/component","blue-app/with/routable","blue-app/with/serviceConfigAPI","blue/has","blue/hash","blue/is","blue-app/routeHandler","blue-app/mvc/handler","blue-app/mvc/targeter","blue/intercept","./with/locationAPI","blue-app/service/interceptor/cache","blue-app/load","blue/log","blue/root","blue/device/platform","emitter-js","blue-app/cache/oneTimeCache","blue-app/cache/sessionCache"],(function(e,t,n){"use strict";var r,o=void 0,a=Object.keys,i=n.config(),s=e("blue/as/contextual"),u=e("blue/as/constructable"),c=e("blue/as/registry"),l=e("blue/site"),p=e("blue-app/area"),d=e("blue-app/service"),f=e("blue-app/controller"),m=e("blue/deferred"),g=e("blue/event/channel"),h=e("blue/event/channel/component"),b=e("blue-app/with/routable"),v=e("blue-app/with/serviceConfigAPI"),y=e("blue/has"),x=e("blue/hash"),E=e("blue/is"),S=e("blue-app/routeHandler"),C=e("blue-app/mvc/handler"),w=e("blue-app/mvc/targeter"),_=e("blue/intercept"),A=e("./with/locationAPI"),O=e("blue-app/service/interceptor/cache"),R=e("blue-app/load"),P=e("blue/log"),T=e("blue/root"),N=e("blue/device/platform"),k=e("emitter-js").default,I=0,j=P("[blue:app]"),F=T.performance&&T.performance.now&&T.performance.mark,D=function(){this.request=function(){}};function L(e,t){var n="",r={};t&&t.code&&(n=t.code.split(":")),(r=e.util.object.deepClone(t)).code="blue:error",n.length&&4===n.length&&(r.code=r.code+":"+n[1]+":"+n[3]),e.bubble(r.code,r)}function M(e,t,n){setTimeout((function(){n.done||(n.done=!0,n.actions={},e.bubble("blue:route:routeComplete",{id:t}))}),20)}return e("blue-app/cache/oneTimeCache"),e("blue-app/cache/sessionCache"),_.withInterceptors.call(D.prototype,"request"),(r=function(e,t){var n=this;n.loadConfig=i,k(n),n.channel=new g({eventTarget:n}),n.viewTargeter=o,n.plugHandler=o,n.htmlTemplate=o,n.defaultHtmlTemplate=o,n.name=e,e&&(n.appName=e),n.defineContext(t,{name:e,appName:e,applicationName:e,config:n.loadConfig,logger:P("[application:"+e+"]")}),this.context.location={},A.call(this.context.location),n.context.executeCAV=function(e,t){var r,a,i=new Promise((function(e,t){r=e,a=t})),s=this;return s&&j.warn("["+s.getStack()+"]","DEPRECATED:BLUEJS-3051:executeCAV is unnecessary when following the view first pattern"),I++,n.context.bubble("blue:route:viewRenderStart",{msgType:"blue:route:viewRenderStart",id:s.routeId||"unknown",displayReqId:I,contextPath:s.getStack(),timestamp:F?performance.now():0,name:"blue:route:viewRenderBegin view "+(s.controller?s.controller.getStack():s.getStack())+" "+I}),n.tellPage("application:display",{routeId:s.routeId||"unknown",displayReqId:I,cavList:e,areaName:t||"",resolverPathOptions:s.page?s.page.viewResolverOptions:o,contextStack:s.controller?s.controller.getStack():s.getStack(),viewEngine:s.viewEngine,activityChannel:h,resolve:r,reject:a}),i},n.context.on({"page:error":function(e){n.context.broadcast(e.code,e),L(n.context,e)},"blue:site:error":function(e){L(n.context,e)}}),n.defineConstruct(n.context),n.defineControllersRegistry(n.context),n.defineAreasRegistry(n.context),n.defineServicesRegistry(n.context),v.call(n),n.tellPage=function(){},n.context.page={},b.call(n,n.registry,"application"),n.routeHandler=new C,n.context.on("blue:application:display",(function(e){I++,n.context.bubble("blue:route:viewRenderStart",{msgType:"blue:route:viewRenderStart",id:e.routeId,displayReqId:I,contextPath:e.contextStack,timestamp:F?performance.now():0}),e.displayReqId=I,n.tellPage("application:display",e)})),function(e,t){var n,r=0,i=0,s=!1,u=[],c=function(e){s&&(s=!1,e.bubble("blue:route:routeBatchCompleteForced",{msgType:"blue:route:routeBatchCompleteForced",id:i,routes:u}),e.bubble("blue:route:routeBatchComplete",{id:i,routes:u,name:"blue:route:routeBatchComplete site "+i}),r=0,u=[]),n=o};e.on("blue:route",(function(){n&&clearTimeout(n),n=setTimeout(c,1e3,e,n)})),e.on("blue:route:newRouteExecuting",(function(n){"external"===n.source&&r>0&&(e.bubble("blue:route:routeBatchComplete",{msgType:"blue:route:routeBatchComplete",id:i,routes:u,name:"blue:route:routeBatchComplete site "+i}),a(t).forEach((function(e){t[e].done=!0})),s=!1,r=0,u=[]),s||(i++,r=0,s=!0,e.bubble("blue:route:routeBatchBegin",{id:i,routes:u,name:"blue:route:routeBatchBegin site "+i})),r++,u.push({id:n.id,route:n.route,source:n.source}),void 0===t[n.id]&&("private"!==n.source&&a(t).forEach((function(n){t[n].done||"private"===t[n].source||M(e,n,t[n])})),t[n.id]={source:n.source,route:n.route,actions:{},services:{},views:{},start:0,stop:0})})),e.on("blue:route:routeComplete",(function(t){r--,setTimeout((function(){s&&r<1&&(s=!1,e.bubble("blue:route:routeBatchComplete",{msgType:"blue:route:routeBatchComplete",id:i,routes:u,name:"blue:route:routeBatchComplete site "+i}),r=0,u=[])}),250)})),e.on("blue:route:newRouteRequestAborted",(function(){r--,setTimeout((function(){s&&r<1&&(s=!1,e.bubble("blue:route:routeBatchComplete",{msgType:"blue:route:routeBatchComplete",id:i,routes:u,name:"blue:route:routeBatchComplete site "+i}),r=0,u=[])}),250)})),e.on("blue:service:serviceCallBegin",(function(e){var n=e.contextPath.replace(/[^/]+$/,"");a(t).forEach((function(r){!t[r].done&&a(t[r].actions).forEach((function(o){o.indexOf(n)>=0&&(t[r].start++,t[r].services[e.id]=!0)}))}))})),e.on("blue:service:serviceCallComplete",(function(n){var r=n.contextPath.replace(/[^/]+$/,"");a(t).forEach((function(o){!t[o].done&&a(t[o].actions).forEach((function(a){a.indexOf(r)>=0&&t[o].services[n.id]&&(t[o].stop++,!t[o].done&&t[o].stop>=t[o].start&&M(e,o,t[o]))}))}))})),e.on("blue:route:lazyLoad",(function(e){t[e.id]&&t[e.id].start++})),e.on("blue:route:executeAction",(function(e){t[e.id]&&(t[e.id].start++,t[e.id].actions[e.contextPath]=!0)})),e.on("blue:route:viewRenderStart",(function(e){t[e.id]?(t[e.id].start++,t[e.id].views[e.displayReqId]=!0):a(t).forEach((function(n){var r=t[n];r.done||(r.start++,r.views[e.displayReqId]=!0)}))})),e.on("blue:route:viewRenderComplete",(function(n){e.parent.bubble(n.msgType,n),t[n.id]?(t[n.id].stop++,!t[n.id].done&&t[n.id].stop>=t[n.id].start&&M(e,n.id,t[n.id])):a(t).forEach((function(r){var o=t[r];!o.done&&o.views[n.displayReqId]&&(o.stop++,o.stop>=o.start&&M(e,r,o))}))})),e.on("blue:route:executeActionComplete",(function(n){t[n.id]&&(t[n.id].stop++,!t[n.id].done&&t[n.id].stop>=t[n.id].start&&M(e,n.id,t[n.id]))})),e.on("blue:route:lazyLoadComplete",(function(n){t[n.id]&&(t[n.id].stop++,!t[n.id].done&&t[n.id].stop>=t[n.id].start&&M(e,n.id,t[n.id]))})),e.on("blue:route:routeRequest",(function(t){var n,r,o="/"+x.parseMatrixParamHash(x.getHash()).app+"/",a=[];for(r=0;r<t.segments.length;r++)a.push(x.segmentObjectToString(t.segments[r]));o+=a.join("/")+(t.query.string?"?"+t.query.string:""),(n=x.parseMatrixParamHash(o)).mapping=n.pathSegments.join("."),"private"===t.source&&(n.privateDataObject=t.privateDataObject),e.broadcast("blue:routeChange",n)}))}(n.context,{})}).prototype=Object.create(k.prototype),r.prototype.constructor=r,r.prototype.destroy=function(){var e=this,t=[];return"function"==typeof this.onDestroy&&this.onDestroy(),t.push(this.destroyAreasRegistry()),t.push(this.destroyControllersRegistry()),t.push(this.destroyServicesRegistry()),Promise.all(t).then((function(){e.destroyConstruct(),e.destroyContext(),k.prototype.destroy.call(e)}))},r.prototype.loadSpec=function(){var e,t,n,r=this,o=new Promise((function(e,r){t=e,n=r})),s=i&&i.cache?i.cache:{};return j.error("Client platform signature: "+JSON.stringify(N)),s&&s.constructor===Array&&s.length&&((e=new D).interceptors=[O],e.defineInterceptors(),s.forEach((function(t){e.request({url:t.url,cacheData:{usage:t.usage,response:t.response||{}}})}))),R(r.context.appName,(function(e){r.settings=e,r.mapAppComponents(),r.routeHandler.mappings&&r.routeHandler.mappings.length||r.addRouteMapping("IdentityMapping"),e.services||(e.services={}),e.controllers&&(r.controllers=e.controllers),e.areas&&(r.areas=e.areas),e.services&&(r.services=e.services),e.services&&(r.context.services=r.services),e.context&&r.configureAppContext(r.context,e.context),e.imports?l.context._internal.import(r,e.imports).then((function(){E.plainObject(r.context.areaMessageMap)&&a(r.context.areaMessageMap).forEach((function(e){r.configureAreaWakeUp(e,r.context.areaMessageMap[e])})),t(r)}),n):(E.plainObject(r.context.areaMessageMap)&&a(r.context.areaMessageMap).forEach((function(e){r.configureAreaWakeUp(e,r.context.areaMessageMap[e])})),t(r)),e.viewEngine&&(r.context.viewEngine=e.viewEngine)})),Blue.status.applicationLoaded.resolve().then((function(){var e;if(y("localstorage")&&T.localStorage.getItem)try{e=T.localStorage.getItem("blueNetworkAnalysisData"),(e=JSON.parse(e))&&(Blue.network.stats.speed=e.derivedSpeed||0,j.info("["+r.context.getStack()+"]","Network analysis data",e))}catch(e){j.warn("["+r.context.getStack()+"]","Unable to fetch blueNetworkAnalysisData from localStorage")}})),o.then((function(){r.context.broadcast("blue:applicationConfigComplete")})),o},r.prototype.configureAppContext=function(e,t){var n,r,o;if((r=a(t)).length)for(n=r.length;n--;)e[o=r[n]]=t[o],delete t[o]},r.prototype.configureAreaWakeUp=function(e,t){var n=this;t.split(/,\s*/).forEach((function(t){n.registry.isArea(t)&&n.context.once(e,(function(r){n.registry.hasArea(t)||n.registry.getArea(t).then((function(t){t.context.broadcast(e,r)})).catch((function(e){throw j.error("["+n.context.getStack()+"]","Error doing initial-load of area "+t,e),n.context.broadcast("blue:route:error:areaInitialLoadFailed",{code:"blue:route:error:areaInitialLoadFailed",description:"Error doing initial load of area "+t}),e}))}))}))},r.prototype.mapAppComponents=function(){var e,t=this,n=a(t.settings),r=n.length;n.some((function(n,o){return(e=t.settings[n])instanceof S?t.routeHandler=e:e instanceof w&&(t.viewTargeter=e),o<r&&!1}))},c.call(r.prototype,"area",p,{lazy:!0,onAfterCreate:function(e,t){var n=this;return new Promise((function(r,o){t.routeHandler.mappings&&t.routeHandler.mappings.length||t.addRouteMapping("IdentityMapping"),t.wakeCount?(t.wakeCount++,t.initComplete.promise.then((function(e){r(e)}))):(t.wakeCount=1,t.initComplete=new m,t.loadSpec().then((function(e){e.page&&e.page.viewResolverOptions&&(e.context.page.viewResolverOptions=e.page.viewResolverOptions),Promise.resolve(new Promise((function(t){t(E.function(n.onAreaLoad)?n.onAreaLoad(e):Promise.resolve())})).then((function(){Promise.resolve(new Promise((function(t){t(E.function(e.onLoad)?e.onLoad():Promise.resolve())})).then((function(){r(e),e.initComplete.resolve(e)}),(function(t){j.error("["+e.context.getStack()+"]","Error processing area's onLoad callback for area \""+name+'"',t),e.context.broadcast("blue:route:error:onLoadFailed",{code:"blue:route:error:onLoadFailed",description:'Error initializing area "'+name+'" after load: error in onLoad callback '}),o(t),e.initComplete.reject(t)})))}),(function(t){j.error("["+e.context.getStack()+"]",'Error processing onAreaLoad callback for area "'+name+'"',t),e.context.broadcast("blue:route:error:onAreaLoadFailed",{code:"blue:route:error:onAreaLoadFailed",description:'Error initializing area "'+name+'" after load: error in onAreaLoad callback '}),o(t),e.initComplete.reject(t)})))})).catch((function(n){j.error("["+t.context.getStack()+"]","Error processing area's wire config for area \""+e+'"',n),t.context.application.broadcast("blue:route:error:areaWireLoadFailed",{code:"blue:route:error:areaWireLoadFailed",description:'Error initializing area "'+e+'". Error encountered while processing area wire config: '+n}),t.initComplete.reject(n),o(n)})))}))}}),c.call(r.prototype,"controller",f,{lazy:!0,onAfterCreate:function(e,t){return t.routeHandler.mappings&&t.routeHandler.mappings.length||t.addRouteMapping("IdentityMapping"),t},immediate:!0}),c.call(r.prototype,"service",d),u.call(r.prototype),r=s.call(r,{name:"application"})})),define("blue-app/mvc/handler/interceptor/mocking",[],(function(){"use strict";return{after:function(e){return e.push("mocking.index"),e}}})),define("blue-app/mvc/handler/interceptor/shell",["blue/declare","blue/util"],(function(e,t){"use strict";var n=t.array.find;return e({constructor:function(){var e;for(this.name="ShellInterceptor",this.hasRun=!1,this.actions=[],e=0;e<arguments.length;e++)this.actions.push(arguments[e])},afterReturning:function(e){var t=n(this._interceptors,(function(e){return"ShellInterceptor"===e.name}));return t.hasRun||(t.actions.forEach((function(t){e.unshift(t)})),t.hasRun=!0),e}})})),define("blue-app/nesting/mapper/mapping/identity",["blue/declare"],(function(e){"use strict";return e({constructor:function(){},lookup:function(e){return e},toString:function(){return"IdentityMapping"}})})),define("blue-app/nesting/mapper/mapping/simplePattern",["blue/declare","blue/is"],(function(e,t){"use strict";return e({constructor:function(e){if(!t.plainObject(e))throw new TypeError('"mappings" must be a plain object');this.mappings=e},lookup:function(e){var t=e?e.split("."):[],n=t[0]||"",r=t[0]&&t[1]?t[0]+"."+t[1]:"";return this.mappings[e]||this.mappings[r]||this.mappings[n]},toString:function(){return" Simple Pattern Mapping "}})})),define("blue-app/nesting/mapper/mapping/simplePatternAdditive",["blue/declare","blue/is"],(function(e,t){"use strict";return e({constructor:function(e){if(!t.plainObject(e))throw new TypeError('"mappings" must be a plain object');this.mappings=e},lookup:function(e){var t,n,r=e?e.split("."):[],o=r[0]||"",a=r[0]&&r[1]?r[0]+"."+r[1]:"";return(t=this.mappings[e]||this.mappings[a]||this.mappings[o])&&(n=e+","+t),n},toString:function(){return" Simple Pattern Mapping "}})})),define("blue-app/nesting/mapper",["require","blue/is","./mapper/mapping","blue/compose","blue/intercept","blue/declare","blue/log"],(function(e){"use strict";var t=e("blue/is"),n=e("./mapper/mapping"),r=e("blue/compose"),o=e("blue/intercept"),a=e("blue/declare"),i=e("blue/log")("[blue:app]"),s=function(e){return new n(e)};return a((function(){var e={constructor:function(){var e,t,n;if(arguments.length){for(e=[this],t=0;t<arguments.length;t++)e.push(arguments[t]);r.apply(r,e)}Object.defineProperty(this,"mappings",{get:function(){return n},set:function(e){n=e.map(s)},enumerable:!0}),this.defineInterceptors()},destroy:function(){this.destroyInterceptors()},mapRequest:function(){var e,n,r=arguments,o=!1;return this.mappings&&this.mappings.length&&("IdentityMapping"!==(e=this.mappings[this.mappings.length-1].mapping.toString())&&"ControllerNameMapping"!==e&&i.warn("'IdentityMapping' or 'ControllerNameMapping' should succeed all other route mappings."),this.mappings.some((function(e){return n=e.lookup.apply(e,r),t.defined(n)&&(n=n.split(",").map((function(e){return e.trim()})),o=n.length>0),o}),this)),n},toString:function(){return" Mapper "}};return o.withInterceptors.call(e,"mapRequest"),e}))})),define("blue-app/nesting/targeter",["require","blue-app/nesting/mapper","blue/declare"],(function(e){"use strict";var t=e("blue-app/nesting/mapper");return e("blue/declare")(t,{constructor:function(){t.call(this)},targetRequest:function(e,t){return this.mapRequest(e,t)},toString:function(){return" Targeter "}})})),define("blue-app/service/interceptor/deviceSignature",["require","blue/is","blue/util"],(function(e){"use strict";var t=e("blue/is"),n={isInstalled:function(e){return this.getInfo(e).isInstalled},getVersion:function(e){return this.getInfo(e).version},getInfo:function(e){var t=this.PLUGINS[e],n=!1,r=null;if(this.supportsNavigatorPlugins()){var o=this.findNavigatorPluginByName("RealPlayer"===e?"RealPlayer Version Plugin":e);o&&(n=!0,r=this.getVersionFromPlugin(o))}else if(n=this.hasActiveXObject(this.PLUGINS[e]&&this.PLUGINS[e].progID))if(this.PLUGINS[e].getActiveXVersionInfo)r=this.PLUGINS[e].getActiveXVersionInfo();else{var a=this.getProgIdForActiveXObject(this.PLUGINS[e].progID);r=this.getVersionFromPlugin(a)}else(r=this.getActiveXPluginByClassId(this.PLUGINS[e]&&this.PLUGINS[e].classID))&&(r=r.replace(/,/g,".")),n=null!=r;var i={};for(var s in t)Object.hasOwnProperty.call(t,s)&&(i[s]=t[s]);return i.isInstalled=n,i.version=r,i.name=e,i},PLUGINS:{Acrobat:{description:"Adobe Acrobat Plugin",progID:["PDF.PdfCtrl.7","PDF.PdfCtrl.6","PDF.PdfCtrl.5","PDF.PdfCtrl.4","PDF.PdfCtrl.3","AcroPDF.PDF.1"],classID:"CA8A9780-280D-11CF-A24D-444553540000"},QuickTime:{description:"QuickTime Plug-in",progID:["QuickTimeCheckObject.QuickTimeCheck.1","QuickTime.QuickTime"],classID:"02BF25D5-8C17-4B23-BC80-D3488ABDDC6B",getActiveXVersionInfo:function(){var e=this.getProgIdForActiveXObject(this.PLUGINS.QuickTime.progID),t=new ActiveXObject(e),n=t&&t.QuickTimeVersion?t.QuickTimeVersion.toString(16):"";return n.substring(0,1)+"."+n.substring(1,2)+"."+n.substring(2,3)}},DivX:{description:"DivX Browser Plugin",progID:["npdivx.DivXBrowserPlugin.1","npdivx.DivXBrowserPlugin"],classID:"67DABFBF-D0AB-41fa-9C46-CC0F21721616"},Director:{description:"Macromedia Director",progID:["SWCtl.SWCtl.11","SWCtl.SWCtl.10","SWCtl.SWCtl.9","SWCtl.SWCtl.8","SWCtl.SWCtl.7","SWCtl.SWCtl.6","SWCtl.SWCtl.5","SWCtl.SWCtl.4"],classID:"166B1BCA-3F9C-11CF-8075-444553540000"},Flash:{description:"Macromedia Shockwave Flash",progID:["ShockwaveFlash.ShockwaveFlash.9","ShockwaveFlash.ShockwaveFlash.8.5","ShockwaveFlash.ShockwaveFlash.8","ShockwaveFlash.ShockwaveFlash.7","ShockwaveFlash.ShockwaveFlash.6","ShockwaveFlash.ShockwaveFlash.5","ShockwaveFlash.ShockwaveFlash.4"],classID:"D27CDB6E-AE6D-11CF-96B8-444553540000"},VLC:{description:"VLC multimedia plugin",progID:[],classID:""},"Windows Media":{description:"Windows Media Player Plug-in Dynamic Link Library",progID:["WMPlayer.OCX","MediaPlayer.MediaPlayer.1"],classID:"22D6f312-B0F6-11D0-94AB-0080C74C7E95",getActiveXVersionInfo:function(){var e=this.getProgIdForActiveXObject(this.PLUGINS["Windows Media"].progID),t=new ActiveXObject(e);return t&&t.versionInfo?t.versionInfo:""}},Java:{description:"Java Virtual Machine",progID:[],classID:"08B0E5C0-4FCB-11CF-AAA5-00401C608500"}},supportsNavigatorPlugins:function(){return navigator.plugins&&navigator.plugins.length>0},findNavigatorPluginByName:function(e){if(this.supportsNavigatorPlugins())for(var t=0;t<navigator.plugins.length;++t){var n=navigator.plugins[t];if(-1!==n.name.indexOf(e))return n}return null},getIEClientCaps:function(){var e=document.getElementById("__Plugin_ClientCaps");return e||((e=document.createElement("DIV")).id="__Plugin_ClientCaps",e.addBehavior&&(e.addBehavior("#default#clientCaps"),document.body.appendChild(e)),e=document.getElementById("__Plugin_ClientCaps")),e},getActiveXPluginByClassId:function(e){if(!e)return null;e.match(/{[^}]+}/)||(e="{"+e+"}");var t=this.getIEClientCaps();try{return t.getComponentVersion(e,"ComponentID")||null}catch(e){}return null},hasActiveXObject:function(e){return null!=(e=this.getProgIdForActiveXObject(e))},getProgIdForActiveXObject:function(e){if(!e)return null;for(var t=0;t<e.length;t++)try{return e[t]||null}catch(e){}return null},getVersionFromPlugin:function(e){e.name||(e={name:e,description:name});var t=/[\d][\d.]*/.exec(e.name);return t&&-1===e.name.indexOf("Java")||(t=/[\d.]+/.exec(e.description))?t[0]:""}},r={getDeviceSignature:function(){var e={};return e.navigator=this.getNavigatorProps(),e.plugins=this.getPlugins(),e.screen=this.getScreenProps(),e.extra=this.getExtraProps(),JSON.stringify(e)},getNavigatorProps:function(){var e={};for(var n in navigator)if(t.defined(navigator[n]))try{var r=navigator[n];"boolean"!=typeof r&&"number"!=typeof r&&"string"!=typeof r&&null!==r||(e[n]=r)}catch(e){}return e},getPlugins:function(){for(var e=[],t=new Array("Acrobat","QuickTime","DivX","Director","Windows Media","Flash","Java","VLC"),r=0,o=0;o<t.length;o++)try{if(n.isInstalled(t[o])){var a={},i=n.getInfo(t[o]);null!=i&&(a.name=i.description,a.version=i.version,e[r++]=a)}}catch(e){}return e},getScreenProps:function(){for(var e=["availHeight","availWidth","colorDepth","height","pixelDepth","width"],t={},n=0;n<e.length;n++)try{var r=screen[e[n]];null!=r&&(t[e[n]]=r)}catch(e){}return t},getExtraProps:function(){var e={},t=null;if("Microsoft Internet Explorer"===navigator.appName)try{t=ScriptEngineMajorVersion()+"."+ScriptEngineMinorVersion()+"."+ScriptEngineBuildVersion()}catch(e){}null!=t&&(e.vbscript_ver=t),e.javascript_ver="2.0";try{var n=new Date,r=n.toString();r.indexOf("PDT")>0||r.indexOf("MDT")>0||r.indexOf("CDT")>0||r.indexOf("EDT")>0||r.indexOf("Daylight")>0?e.timezone=n.getTimezoneOffset()+60:e.timezone=n.getTimezoneOffset()}catch(t){e.timezone=""}return e}},o=e("blue/util").object.merge;return{before:function(e){var t;try{t=r.getDeviceSignature()||"NA"}catch(e){t="NA"}return e.headers=o(e.headers||{},{"digital-device-signature":t}),e}}})),define("blue-app/service/interceptor/offline",[],(function(){"use strict";var e=[],t=function(t){for(var n,r=[];n=e.shift();)r.push(n);r.forEach((function(e){e(t)}))};return{around:function(n){var r=(n.args[0]||{}).disableOfflineHandler,o=n.target.context,a=o.onOfflineError;return r||!a?n.proceed():new Promise((function(r,i){!function(n,r,o,a,i){var s,u=function(c){if(!c)return o(s);n.proceed().then(r).catch((function(n){if(!a.env||!("onLine"in a.env)||a.env.onLine)return o(n);e.push(u),s=n,1===e.length&&i(t)}))};return u}(n,r,i,o,a)(!0)}))}}})),define("blue-app/service/interceptor/status",[],(function(){"use strict";var e={300:!0,301:!0,302:!0,303:!0,305:!0,306:!0,307:!0,308:!0},t=function(e,t){for(var n=t.split(".");e=e[n.shift()];)if(e.constructor===Function)return e};return{around:function(n){var r=1,o=n.args[0];return new Promise((function(a,i){var s=function(){n.proceed().then((function(e){var n=t(o,"handleSuccess");if(n)return a(n.call(e,e));(n=t(o,"handleStatus.200"))&&n.call(e,e),a(e)})).catch((function(n){var a,u=n.status;if(e[u]&&o.redirect&&r++<3)return o.url=n.getResponseHeader("Location"),s();(a=t(o,"handleError"))&&a.call(n,n),(a=t(o,"handleStatus."+u))&&a.call(n,n),i(n)}))};s()}))}}})),define("blue-app/userSettings",["require","blue/resource/persona"],(function(e){"use strict";var t={persona:(new(e("blue/resource/persona"))).read()};return Object.keys(t).forEach((function(e){t[e]||delete t[e]})),t})),define("blue-app/message/reporter/network",["require","blue/root"],(function(e){"use strict";var t=e("blue/root"),n=function(){var e=self,t=/%20/g,n=/^(?:GET|HEAD)$/,r={lastModified:{},etag:{}},o={text:function(e){return e.text()},json:function(e){return e.json().catch((function(t){throw e.headers&&(t.headers=e.headers),e.status&&(t.status=e.status,t.statusText=e.statusText),t}))},xml:function(e){return e.text().then((function(e){return(new DOMParser).parseFromString(e,"text/xml")}))},image:function(e){return e._bodyBlob?Promise.resolve(e._bodyBlob):"function"==typeof e.blob?e.blob():e.body&&e.body instanceof ReadableStream?e:Promise.reject(new Error("Blue:fetch - expected image blob, blob not found"))}},a={text:o.text,"application/json":o.json,"text/json":o.json,"application/xml":o.xml,"text/xml":o.xml,"image/bmp":o.image,"image/gif":o.image,"image/x-icon":o.image,"image/jpeg":o.image,"image/png":o.image,"image/svg+xml":o.image,"image/tiff":o.image,"image/webp":o.image},i=function(){e.onmessage=function(i){var s,u=i.data.url,c=i.data.options,l=c.data,p={cache:"default",credentials:"same-origin",headers:c.headers||{},method:c.method||c.type||"GET",mode:"cors",redirect:"follow"};c.xhrFields&&c.xhrFields.withCredentials&&(p.credentials="include"),c.contentType&&(p.headers["Content-Type"]=c.contentType),c.ifModified&&((s=r.lastModified[u])&&(p.headers["If-Modified-Since"]=s),(s=r.etag[u])&&(p.headers["If-None-Match"]=s)),!l||l.constructor===String||"processData"in c&&!c.processData||(l=function(e){var n=[],r=function(e,t){var r;r=t&&t.constructor===Function?t():null===t?"":t,n.push(encodeURIComponent(e)+"="+encodeURIComponent(r))};switch(e&&e.constructor){case Array:e.forEach((function(e){e&&r(e.name,e.value)}));break;case Object:Object.keys(e).forEach((function(t){r(t,e[t])}))}return n.join("&").replace(t,"+")}(l)),l&&(n.test(p.method)?u+=(-1===u.indexOf("?")?"?":"&")+l:p.body=l),e.fetch(new e.Request(u),p).then((function(e){var t={headers:e.headers,status:e.status,statusText:e.statusText,url:e.url||""};return c.ifModified&&((s=e.headers.get("Last-Modified"))&&(r.lastModified[u]=s),(s=e.headers.get("etag"))&&(r.etag[u]=s)),function(e,t){var n=e.headers.get("Content-Type")||"",r=n.split("/"),i=o[t]||a[n]||a[r[0]];return i?i(e):e.text()}(e,c.dataType).then((function(e){return t.data=e,t}))})).catch((function(t){throw t.headers?t:{headers:new e.Headers,status:0,statusText:t.message,url:u}})).then((function(t){e.postMessage({id:i.data.id,data:t.data})}))}};(i.prototype=Object.create(null)).constructor=i,new i},r=function(){var e=function(){var e=n.toString();return(e=e.replace(/^[\s\r\n]*function\s*\(\)\s*\{[\s\r\n]*/,"")).replace(/\}[\s\r\n]?$/,"")}();return new Blob([e],{type:"application/javascript"})},o=function(e){var n=this;if(this.type=e||"worker",this._callbacks=[],"worker"!==this.type)throw new Error('Network Worker type "'+e+'" not supported.');if(!t.Worker)throw new Error("Web Workers are not supported.");this.worker=new Worker((t.URL||t.webkitURL).createObjectURL(r())),this.worker.onmessage=function(e){var t;t=e.data,n._callbacks.forEach((function(e){try{e(t)}catch(e){}}))}};return(o.prototype=Object.create(null)).constructor=o,o.prototype.destroy=function(){this._callbacks=void 0,this.worker.terminate(),this.worker=void 0},o.prototype.subscribe=function(e){this._callbacks.push(e)},o.prototype.sendMessage=function(e){"worker"===this.type&&this.worker&&this.worker.postMessage(e)},o.prototype._reporterFunction=n,o})),define("blue-app/message/collector",["require","blue/observable","blue-app/message/reporter/network","blue/root","blue/util","blue-app/service"],(function(e){"use strict";var t=e("blue/observable"),n=e("blue-app/message/reporter/network"),r=e("blue/root"),o=e("blue/util").object.merge,a=e("blue-app/service"),i=0,s={},u=0,c={},l={NetworkReporter:n},p=function(e){c[e.id]&&(e.error?c[e.id].reject&&c[e.id].reject(e.error):c[e.id].resolve&&c[e.id].resolve(e.data),c[e.id]=void 0)},d=function(e){var t=this;this.reporter=function(e){if(!l[e=e||"NetworkReporter"])throw new Error("Unknown reporter type requested: "+e);return new l[e]}(e),this.reporter.subscribe(p),this._id=++i,s[this._id]={streamMap:{},configMap:{}},r.addEventListener("beforeunload",(function(){t.unloading=!0,t.destroy()}))};return(d.prototype=Object.create(null)).constructor=d,d.prototype.destroy=function(){var e=this;this._destroyed||(this._destroyed=!0,Object.keys(s[this._id].streamMap).forEach((function(t){s[e._id].streamMap[t].end()})),this.reporter.destroy(),this.reporter=void 0,s[this._id]=void 0)},d.prototype.plug=function(e,n,r){var i,c=this,l=s[this._id].streamMap,p=s[c._id].configMap[e];if(!this._destroyed){if(l[e])throw new Error("Stream name is already in use: "+e);if(!p||!p.url)throw new Error('No network configuration exists for stream "'+e+'"');r=r||{},l[e]={},l[e].sourceStream=t.stream((function(t){var r=n.onValue((function(e){t.emit(e)}));return l[e].end=t.end,function(){r()}})),i=function(e,t){return"time"===t.buffer?e.bufferWithTimeOrCount(t.interval,void 0):"count"===t.buffer?e.bufferWithCount(t.interval):e}(l[e].sourceStream,r||{}),r.beforeSend&&"function"==typeof r.beforeSend&&(i=i.map(r.beforeSend)),l[e].bufferedStream=i,l[e].bufferedStream.onValue((function(t){var n={};!t||Array.isArray(t)&&!t[0]||(n.id=++u,n.stream=e,n.options=o({},p),n.url=p.url,n.shutdown=c._destroyed||!1,Array.isArray(t)?n.options.data={events:t}:n.options.data=t,r.stringify&&(n.options.data=JSON.stringify(n.options.data)),a.prototype.prerequest.call(null,n.options,n.options.data),c.reporter.sendMessage(n))}))}},d.prototype.unplug=function(e){this._destroyed||s[this._id].streamMap[e].end()},d.prototype.send=function(e,t){var n=this,r={id:++u,url:e};if(this._destroyed)return Promise.resolve();if(r.options=o(s[n._id].configMap[e]||{},t),0===Object.keys(r.options).length)throw new Error('No network configuration exists for URL "'+e+'"');return r.options.url=e,a.prototype.prerequest.call(null,r.options,r.options.data),new Promise((function(e,t){c[r.id]={id:r.id,message:r,resolve:e,reject:t},n.reporter.sendMessage(r)}))},d.prototype.configureStream=function(e,t){if(!this._destroyed){if(!e)throw new Error("configureStream requires a stream name");s[this._id].configMap[e]=o({},t)}},d.prototype.configureURL=function(e,t){if(!this._destroyed){if(!e)throw new Error("configureURL requires a URL");s[this._id].configMap[e]=o({},t)}},d})),define("blue-app/main",(function(){}));