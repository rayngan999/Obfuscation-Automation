/* Copyright 2021, SiteSpect, Inc. All Rights Reserved. */
(function(e,t){var n=e.document;var r=e.SS||{};e.SS=r;var i=e.encodeURIComponent;r.Cookie=function(){var t="";function r(t,n,r,o,a,f,u){var c;if(!r||r.toString().substr(0,1)!==";"){if(!f){f="/"}if(!a){a=e.location.hostname.match(/^[\d.]+|(?:\.[\da-z\-]+)*[\da-z\-]+\.[\da-z\-]+$/i)[0]}if(a.substr(0,1)!=="."){a="."+a}o=!o?"":";secure";if(u){var s=u.toLowerCase();if(s==="lax"){u=";SameSite=Lax"}else if(s==="strict"){u=";SameSite=Strict"}else if(s==="none"&&o){u=";SameSite=None"}else{u=""}}if(r!=null){r=parseInt(r,10);if(isNaN(r)){r=0}r=";expires="+new Date(+new Date+r).toUTCString()}c=";path="+f+";domain="+a+r+u+o}else{c=r}return i(t)+"="+i(n)+c}function o(e,t){e=" "+e+"=";t=" "+t+";";var n=t.indexOf(e);if(n>=0){n+=e.length;return decodeURIComponent(t.substring(n,t.indexOf(";",n)))}return""}function a(e){return e.split(t)}function f(e){return e.join(t)}function u(e,r){if(!e){return}var i=o(e,n.cookie);if(!i){return""}if(r){r=r.substr(0,1).toLowerCase()}switch(r){case"s":return i;case"a":return a(i);default:return i.match(t)?a(i):i}}function c(e,t,i,o,a,u,c){if(!e||/^(?:expires|max-age|path|domain|secure|HttpOnly)$/i.test(e)){return}if(typeof t==="object"){t=f(t)}n.cookie=r(e,t,i,o,a,u,c)}return{get:u,set:c}}();r.JSEvents=function(){function t(e,t,n){if(e.addEventListener){e.addEventListener(t,n,false)}else if(e.attachEvent){e.attachEvent("on"+t,n)}}function r(e,t,n){if(e.removeEventListener){e.removeEventListener(t,n,false)}else if(e.detachEvent){e.detachEvent("on"+t,n)}}function i(t){if(!t){t=e.event}var r=t.target||t.srcElement||n;if(r.nodeType===3){r=r.parentNode}return r}function o(r){var i=false,o=false,a,f;a=function(){if(!i){if(!n.body){return setTimeout(a,1)}i=true;r()}};if(n.addEventListener){f=function(){n.removeEventListener("DOMContentLoaded",f,false);a()};n.addEventListener("DOMContentLoaded",f,false)}else if(n.attachEvent){f=function(){if(n.readyState==="complete"){n.detachEvent("onreadystatechange",f);a()}};n.attachEvent("onreadystatechange",f);try{o=e.frameElement===null}catch(u){}if(n.documentElement.doScroll&&o){(function c(){if(i){return}try{n.documentElement.doScroll("left")}catch(e){setTimeout(c,1);return}a()})()}}t(e,"load",a)}return{on:t,off:r,trgt:i,ready:o}}();r.TimerFactory=function(){function e(){var e=-1,t=-1;function n(t){e=(t||new Date).getTime();return e>0}function r(){t=(new Date).getTime();return t>0}function i(){e=-1;t=-1}function o(){if(e<=0){throw"Failure to Start Timer"}if(t<=0){throw"Failure to Stop Timer"}if(e>t){throw"Failure to Reset Timer"}return(t-e)/1e3}return{start:n,stop:r,reset:i,diff:o}}function t(){return new e}return{get:t}}();r.EventTrack=function(){var t=e.location.host,r=e.location.protocol,o="/__ssobj/track",a=Math.floor(Math.random()*99999999),f=[],u=[],c=false;e.addEventListener("unload",function(){c=true;for(var e=0;e<u.length;e++){g(u[e])}});function s(e){f.push(e)}function l(e){e+="-3";var t=n.createElement("img");t.src=e;t.id="SS.IMG"+a;t.style.width="0px";t.style.height="0px";n.body.appendChild(t);s(t)}function d(n,f){var u=(new Date).getTime()+a,c=[],s;if(typeof n==="object"){for(s=0;s<n.length;s++){n[s]="event"+s+"="+i(n[s])}n=n.join("&")}else{n="event="+i(n)}if(f&&typeof f==="object"){for(s in f){if(f.hasOwnProperty(s)){c[c.length]="value_"+i(s)+"="+i(f[s])}}f=c.join("&")}else{f="value="+i(f!==null?f:"")}var l=o+"?"+n+"&"+f+"&x="+u;var d=r!==e.location.protocol;if(y()||d){l="//"+t+l;if(d){l=r+l}}return l}function v(e){var n=e.match(/^(?:(https?:)?\/\/)?([^\/]+)/);if(!n){return}var i=n[1];var o=n[2];t=o;r=i||r}function m(t,n){var r=t+"-b";t+="-1";var i;if(e.navigator&&navigator.sendBeacon&&(c||e.event&&e.event.type==="unload")){try{i=navigator.sendBeacon(r)}catch(o){i=false}}if(i){return true}var a;try{a=e.ActiveXObject?new e.ActiveXObject("Microsoft.XMLHTTP"):new e.XMLHttpRequest;a.open("GET",t,!n)}catch(f){return false}try{a.setRequestHeader("X-Requested-With","XMLHttpRequest");a.setRequestHeader("Accept","*/*")}catch(u){}try{a.send(null)}catch(l){if(l.number&65535!==1223){return false}}if(n){h(a,this,0)}else{a.onreadystatechange=function(){h(a,this,0)}}s(a);return true}function h(t,n,r){if(typeof e.__ssmMetricResponseReadyChange==="undefined"&&r<10){setTimeout(function(){h(t,n,r+1)},1e3)}else{if(typeof e.__ssmMetricResponseReadyChange!=="undefined"){e.__ssmMetricResponseReadyChange.forEach(function(e){e(t,n)})}}}function p(e){e+="-2";var t=new Image;t.src=e;s(t)}function y(){return t!==e.location.host}function E(e,t,n){var r=d(e,t);var i={url:r,sync:n,ran:0};u.push(i);if(y()||c){g(i)}else{setTimeout(function(){if(!c){g(i)}},200)}return true}function g(e){if(++e.ran>1){return}var t=e.url;var n=e.sync;if(y()||!m(t,n)){if(r==="https:"){l(t)}else{p(t)}}}E.beaconPatched=true;return{metric:E,rp:E,rpAsync:function(e,t){E(e,t,false)},rpSync:function(e,t){E(e,t,true)},r:f,setDomain:v}}();r.PageTimer=function(){var t=r.JSEvents,n,i;function o(e,t){var o=false;return function(){if(i&&!o){o=true;if(n.stop()){try{var a=n.diff();if(a<=1795){r.EventTrack.rp(e,a,t)}}catch(f){}}}}}function a(a,f,u){n=r.TimerFactory.get();i=n.start(u);if(i){var c=false;if(a==="ready"){t.ready(o(f,false));c=true}else if(a==="load"){t.on(e,"load",o(f,false));c=true}else if(a==="dwell"){t.on(e,"unload",o(f,true));c=true}else if(a==="abandon"){unloadEvent=o(f,true);t.on(e,"unload",unloadEvent);t.on(e,"load",function(){t.off(e,"unload",unloadEvent)});c=true}return c}else{return false}}return{time:a}}();r.Debug=function(){function t(t){e.addEventListener("error",n,false)}function n(e){var t=e.filename;if(t.match(/scripterror/i)){t="externaljsfile"}r.EventTrack.rp("js-error",{path:e.filename,line:e.lineno,error:e.message})}return{trackJSErrors:t}}();r.Util=function(){function e(e,t){if(Element.prototype.matches){return e.matches(t)}var n=(e.document||e.ownerDocument).querySelectorAll(t),r=n.length;while(--r>=0&&n.item(r)!==e){}return r>-1}function t(t,n){if(Element.prototype.closest){return t.closest(n)}var r=t;do{if(e(r,n))return r;r=r.parentElement||r.parentNode}while(r!==null&&r.nodeType===1);return null}return{elementClosest:t,elementMatches:e}}()})(this);
/* Copyright 2017, SiteSpect, Inc. All Rights Reserved. */
var ss_dom_var=function(){"use strict";var t=1e3;var e=1e3;var i=[];var r=null;var n=[];var a={};var o;var s;var u;var c;var f=false;var d=false;var l=false;var v=[];var p={};var _=[];var h=[];var m;var g={};var y={childList:true,attributes:true,characterData:true,subtree:true};var b="data-ss-variation-applied";var w="(?#i)";var S=function(t){var e=window.SS||{};e.getAsmtData=function(){return t};window.SS=e};S();var E=function(){try{m=new MutationObserver(i)}catch(t){}function i(t){t.forEach(function(t){var e=n(t.target);if(!d&&document.body.contains(e)){var i=C(e);if(i){i.forEach(function(t){M(e,t)})}}});a()}function n(t){var e;var i=t;while(i){if(i.nodeType===Node.ELEMENT_NODE){e=e||i;if(i.getAttribute(b)||h.indexOf(t)>-1){return i}}i=i.parentNode}return e}function a(){h.forEach(function(t,e){if(!document.querySelector("["+b+'="'+e+'"]')){delete h[e];delete _[e]}})}function u(t,e){t.innerHTML=e}function v(t,e){Object.keys(e).forEach(function(i){t.style[i]=e[i]})}function w(t,e){Object.keys(e).forEach(function(i){t.setAttribute(i,e[i])})}function E(t,e){try{e.apply(t)}catch(t){return false}}function A(t){if(!t.selector){return 0}if(!o(t)){return 0}var e=document.querySelectorAll(t.selector);var i=0;var r;for(r=0;r<e.length;r++){if(f&&typeof __ssedit!=="undefined"&&__ssedit.isVEContent(e[r])){continue}i+=O(e[r],t)}return i}function C(t){var e=t.getAttribute(b);if(e===null){e=h.indexOf(t);if(e===-1){e=h.length;h[e]=t;if(m&&!d){m.observe(t,y)}}t.setAttribute(b,e)}var i=_[e];if(!i){i=_[e]=[]}return i}function O(t,e){var i=C(t);if(i.indexOf(e)===-1){i.push(e);return M(t,e)}return 0}function M(i,n){if(!o(n)){return}var a;var p=(new Date).getTime();var _=0;if(l){return}while(_<n.applied.length&&n.applied[_]+e<p){_++}n.applied.push(p);if(_){n.applied.splice(0,_)}if(n.applied.length>=t){console.warn("Possible infinite loop detected, aborting");return 0}if(f){a=i.ss_revert||i.cloneNode(true)}if(n.html){u(i,n.html)}if(n.css){v(i,n.css)}if(n.attributes){w(i,n.attributes)}if(n.custom){E(i,n.custom)}if(!n.counted&&n.trigger_counted&&!g[n.campaign_id]){n.counted=true;g[n.campaign_id]=true;if(typeof c!=="function"){c=S}s({handler:c,payload:g,target_domain:r})}q(n.id,1);if(i.hasAttribute("data-sspvid")){var A=document.querySelector(n.selector);if(n.custom&&!A&&n.attributes&&n.attributes["data-sspvid"]){A=document.querySelector('[data-sspvid="'+n.attributes["data-sspvid"]+'"]')}if(A){if(n.custom){var C=["data-sspvid","data-ss-sole-change","data-sspv-control","data-ss-fe-edit-type","data-ss-display-name","data-ss-orig-order","data-ssmid","data-ss-metric-name"];C.forEach(function(t){if(i.hasAttribute(t)){A.setAttribute(t,i.getAttribute(t))}});var O=Array.prototype.slice.call(i.attributes).filter(function(t){return t.name.match(/^data-ss-(?:control-)?reference-node-/)});O.forEach(function(t){A.setAttribute(t.name,t.value)})}if(f){if(a){A.ss_revert=a}if(typeof __ssedit!=="undefined"){__ssedit.outlineEdited(A)}}if(!A.hasAttribute(b)&&i.hasAttribute(b)){A.setAttribute(b,i.getAttribute(b));var M=h.indexOf(i);if(M>-1){h[M]=A}if(m&&!d){m.observe(A,y)}}}}else if(i.hasAttribute("data-ssmid")&&f){if(typeof __ssedit!=="undefined"){__ssedit.outlineEdited(i)}}if(m){m.takeRecords()}return 1}function q(t,e){p[t]=p[t]||0;p[t]+=e;var i="#ssp_history_panel .ss_csf_applied_"+t;var r=document.querySelectorAll(i);for(var n=0;n<r.length;n++){if(p[t]){r[n].style.display="block"}else{r[n].style.display="none"}}}return A}();function A(t){if(!(t instanceof Array)){t=i}var e=t.map(E).reduce(function(t,e){return t+e},0);return e}function C(t){return!!(t&&t.match(/\(\?#[^)]+_ss-invert\)/))}function O(t){return t.replace(/\(\?#[^)]*\)/g,"")}function M(t){var e=t.indexOf(w)!==-1?"i":"";var i=O(t);return new RegExp(i,e)}function q(t){return typeof t!=="undefined"&&t!==null}o=function(){function t(t){try{return t.script_criterion()}catch(t){return false}}function e(t){var e=!!document.location.hash.match(M(t.hash_criterion));if(C(t.hash_criterion)){e=!e}return e}function i(t){var e=document.location.hash.indexOf("?")+1,i=[""];if(e){i=document.location.hash.substring(e).split("&")}return a(t.hashquery_name_criterion,t.hashquery_value_criterion,i)}function r(t){var e=!!document.location.pathname.match(M(t.path_criterion));if(C(t.path_criterion)){e=!e}return e}function n(t){var e=document.location.search.substring(1).split("&");return a(t.query_name_criterion,t.query_value_criterion,e)}function a(t,e,i){var r=C(t),n=C(e),a=M(t),o=M(e),s,u,c,f,d,l;for(s=0;s<i.length;s++){u=i[s].split("=");c=u.shift();d=!!c.match(a);if(r){d=!d}if(d){f=u.join("=");l=!!f.match(o);if(n){l=!l}if(l){break}}}return d&&l}return function(a){var o,s,u={Path:r,Hash:e,Query:n,HashQuery:i,Custom:t};var c=false;for(o=0;o<a.criteria.length;o++){s=a.criteria[o];if(q(s.GroupNumber)&&c&&q(s.Pre)&&q(a.criteria[s.Pre])&&s.GroupNumber===a.criteria[s.Pre].GroupNumber){continue}c=u[s.Type]&&u[s.Type](s);if(!c){if(!(q(s.GroupNumber)&&q(s.Next)&&q(a.criteria[s.Next])&&s.GroupNumber===a.criteria[s.Next].GroupNumber)){return false}}}return true}}();s=N({target:"/__ssobj/asmt_update"});u=N({target:"/__ssobj/api",alterRequest:function(t){t.setRequestHeader("X-SiteSpect-CSM-Url",window.location.href)}});function N(t){t=t||{};var e=t.target;var i=t.alterRequest;var r;var n=100;var a;var o;var s;function u(){d();var t=JSON.stringify(a),r=new XMLHttpRequest;if(s){s=s.replace(/\/$/,"")}var n=s?s+e:e;r.open("POST",n);if(i){i(r)}r.setRequestHeader("Content-Type","application/json;charset=UTF-8");r.withCredentials=true;r.addEventListener("load",c,false);r.send(t)}function c(t){var e;try{e=JSON.parse(t.target.response);if(typeof o==="function"){o(e,this)}T(e,0)}catch(t){}}function f(t){if(t&&r){d()}else if(r){return}r=setTimeout(u,n)}function d(){clearTimeout(r);r=null}return function(t){o=t.handler;a=t.payload;s=t.target_domain;if(!r){f()}}}function T(t,e){if(typeof window.__sscCSFCountStatusChange==="undefined"&&e<5){setTimeout(function(){T(t,e+1)},1e3)}else{if(typeof window.__sscCSFCountStatusChange!=="undefined"){window.__sscCSFCountStatusChange.forEach(function(e){e(t)})}}}function R(t){setTimeout(function(){d=!!t.is_ve_edit_mode},5e3)}function x(t){if(t){i=t.variations||i;a=t.timestamps||a;R(t);f=!!t.is_ve_edit_mode;r=t.current_domain}i.forEach(function(t){t.applied=t.applied||[]});v.forEach(function(t){t(i)})}function k(t){n=t?t.metrics||n:n}function V(t){v.push(t);t(i)}function L(t){return p[t]||0}function D(t){c=t}x(window.__ss_variations);k(window.__ss_variations);document.addEventListener("ready",function(){if(!i.length){x(window.__ss_variations)}if(!n.length){k(window.__ss_variations)}},false);function H(){if(f){l=true}}function j(){if(f){l=false}}function G(t){var e=t.identifying_attr_key;var r=t.identifying_attr_val;var n=t.identifying_script_content_regex;var a=t.new_selector;if(!f){return}Object.keys(i).forEach(function(t){var o=i[t];if(e&&o.attributes&&o.attributes[e]&&o.attributes[e]===r||n&&o.custom&&o.custom.toString().match(n)){o.selector=a}})}function P(t){var e=true;if(i.length&&!d){var r=t.getAttribute("data-sspvid");if(r){e=i.some(function(e){if(e.attributes&&e.attributes["data-sspvid"]===r){var i=t.getAttribute("data-ss-fe-edit-type")==="frontend_order";return!e.custom||i}})}}return e}function F(t){var e=[];var i={visits:[{AsmtCounted:[],Data:{}}]};t.forEach(function(t){i.visits[0].Data[t.id]={Hits:1};if(t.trigger_counting){t.vg_ids.forEach(function(t){if(e.indexOf(t)<=-1){e.push(t)}})}});if(e.length>0){i.visits[0].AsmtCounted=e}return i}function I(){var t=[];var e=false;n.forEach(function(i){if(o(i)){t.push(i);if(i.trigger_counting&&i.tc_ids&&i.tc_ids instanceof Array){i.tc_ids.forEach(function(t){if(!g[t]){g[t]=true;e=true}})}}});if(t.length>0){u({handler:function(t,e){function i(t,e){if(typeof window.__ssmCSMetricResponseReadyChange==="undefined"&&e<5){setTimeout(function(){i(t,e+1)},1e3)}else{if(typeof window.__ssmCSMetricResponseReadyChange!=="undefined"){window.__ssmCSMetricResponseReadyChange.forEach(function(e){e(t.getResponseHeader("SiteSpect-Metrics-Info"))})}}}i(e,0)},payload:F(t),target_domain:r});if(e){s({target_domain:r})}}}return{applyVariations:A,applySingleVariation:E,setVariations:x,setMetrics:k,registerVariationWatcher:V,checkVariationApplied:L,setAsmtCallback:D,pauseVariations:H,unpauseVariations:j,updateVariationSelector:G,isSafeToEdit:P,evaluateMetrics:I}}();(function(){"use strict";function t(t){var e={childList:true,attributes:true,subtree:true};var i;var r;var n;var a=t.callback;var o=document.querySelector("html");if(o){if(window.MutationObserver){r=new MutationObserver(c);i=o;n=r.observe.bind(r,i,e);n()}else{s(o)}}function s(t){t.addEventListener("DOMSubtreeModified",f,false)}function u(t){t.removeEventListener("DOMSubtreeModified",f,false)}function c(){if(r){r.disconnect()}var e=document.querySelectorAll(t.selector);if(e.length>0){a()}if(n){n()}}function f(){u(o);c();s(o)}}ss_dom_var.registerVariationWatcher(function(e){e.forEach(function(e){t({selector:e.selector,callback:ss_dom_var.applySingleVariation.bind(ss_dom_var,e)})})});var e=null;setInterval(function(){if(e===null||e!==window.location.href){e=window.location.href;ss_dom_var.evaluateMetrics()}},500)})();
/* Copyright 2016, SiteSpect, Inc. All Rights Reserved. */
if(!window.SS){window.SS={}}SS.SPA=function(){"use strict";var n=1;var i=document.querySelectorAll.bind(document);function t(t){var o={childList:true,attributes:true};var c;var u;var f="ss-modified-"+n++;var s=e.bind(null,t.dynamicContainer,f);var d;var l=t.callback||t.callbackFunction;if(i(t.staticContainer).length>0){if(window.MutationObserver){if(t.watchSubtree){o.subtree=true}u=new MutationObserver(S);c=i(t.staticContainer)[0];d=u.observe.bind(u,c,o);d()}else{a(i(t.staticContainer),v)}if(t.runCallbackNow){l()}}function v(n){n.addEventListener("DOMSubtreeModified",w,false)}function b(n){n.removeEventListener("DOMSubtreeModified",w,false)}function S(){if(u){u.disconnect()}var n=s(true);if(n.length>0){a(n,r.bind(null,f));l()}if(d){d()}}function w(){a(i(t.staticContainer),b);S();a(i(t.staticContainer),v)}}function e(n,t,e){var a=[n];if(e){a.push(":not(."+t+")")}return i(a.join(""))}function a(n,i){[].forEach.call(n,i)}function r(n,i){if(i.className.indexOf(n)===-1){i.className+=" "+n}}return{dynamicModify:t}}();/* Copyright 2019, SiteSpect, Inc. All Rights Reserved. */
(function(){window.SS=window.SS||{};SS.Recs=SS.Recs||{};function N(){if(SS.Recs.enable_log_debug){console.log.apply(console,arguments)}}var L={};var t={};var M;var U=false;var e=100;var r=setInterval(function(){if(e<=0){clearInterval(r);return}if(SS.Recs&&SS.Recs.capture_initialized){e=0;q()}e--},100);function B(e,r){return"SS_RECOMMENDATION_"+e+"_"+r}var n=100;var i=3e5;var a="RecsInput_Rules";var s="RecsInput_CurrentItem";var u=20;var o={default:"RecsInput_Rules",Rules:"RecsInput_Rules","Current Item":"RecsInput_Rules_CurrentItem",Favorites:"RecsInput_Rules_Favorites",Registry:"RecsInput_Rules_Registry","Shopping Cart":"RecsInput_Rules_ShoppingCart",Wishlist:"RecsInput_Rules_Wishlist","Custom Item":"RecsInput_Rules_CustomItem","Custom Items":"RecsInput_Rules_CustomItems"};var l={"Current Item":"RecsInput_CurrentItem",Favorites:"RecsInput_Favorites",Registry:"RecsInput_Registry","Shopping Cart":"RecsInput_ShoppingCart",Wishlist:"RecsInput_Wishlist","Custom Item":"RecsInput_CustomItem","Custom Items":"RecsInput_CustomItems"};var c={"User ID":"GUID"};var f="User ID";var H={Similar:"people-also-like","People Also Like":"people-also-like",Complementary:"complementary",Popular:"popular",Personalized:"personalized"};var p={};var d=["user","userBias","item","itemBias","itemSet","itemSetBias","from","num","rules","dateRange","blacklistItems","returnSelf","algorithm","actionSkus"];var P=["template_html","template_id","algorithm","input","order","variation_id","selected_element"];var y=["userBias","itemBias","itemSetBias","from","dateRange","blacklistItems","returnSelf"];SS.Recs.displayRecommendation=function(r){var e=r.template_html;var t=r.template_css;var n=r.template_js;var i=r.template_id;var a=r.algorithm;var s=r.input;var u=r.order;var o=r.variation_id;var l=parseInt(r.max_items);var c=r.selected_element;var f=r.ss_recs_title;var p=r.rules;N("ss-recsdisplay: called with arguments:",r);var d=X(o);d.recent_args=r;if(!U){d.queue_display=true;N("Config not initialized: queueing display for later.");return}var y=P.every(function(e){return typeof r[e]!=="undefined"});if(!y){N("ss-recsdisplay: required parameter not defined. The following are required displayRecommendation parameters:",P);return}if($(d)){return}var v=B(o,"CSS");var h=document.getElementById(v);if(!h){h=document.createElement("style");h.innerHTML=t;h.setAttribute("id",v);document.body.appendChild(h);N("ss-recsdisplay: appending CSS block:",h)}var g={};J(g);W(g,s);var m;if(p){g.rules=Y(p);if(typeof g.actionSkus==="undefined"&&Z(g.rules)){g.actionSkus=ee(g)}N("Evaluated rules:",g.rules)}g.num=l;g.algorithm=H[a]||a.toLowerCase();g=V({query:g,algorithm:g.algorithm});var _=K(g,o);if(!L[_]){L[_]={}}var S=L[_];var R=!S.data||S.expire<new Date;var w=!!S.data;G(g);var A=B(o,"HTML");var b=document.getElementById(A);var I;if(!b){N("No HTML content found; inserting LOADING block.");I=Q({order:u,content:e,context:{},css_class:"ss-recs-wrapper__LOADING",selected_element:c,html_unique_id:A,ss_recs_title:f})}var C;var k;var x;var q;var E;var j;var O=SS.Recs.getConfig().display_query_settings||{};var T=O.onNoResultsCallback;var D=typeof O.cleanup_recs_on_no_results!=="undefined"?O.cleanup_recs_on_no_results:true;if(!S.call_queued&&(!b||R)){S.call_queued=true;C=e;k=new XMLHttpRequest;k.onreadystatechange=function(){if(this.readyState!==4||this.status!==200){if(this.readyState===4){N("Recs call returned with Non-200 status:",this.statusText);S.call_queued=false;re(r,this,_)}return}try{x=JSON.parse(this.responseText);if(typeof x==="object"&&x!==null&&!Array.isArray(x)){if(x.results&&Array.isArray(x.results)){q=x.results}else{throw"Recs call returned an object with non-array results property."}}else if(Array.isArray(x)){q=x}else{throw"Recs call returned an unknown response type."}}catch(e){N("Recs response data is in neither the expected JSON array format, nor the JSON object format.");S.call_queued=false;re(r,this,_);return}if(SS.Recs.perItemDataTransform&&typeof SS.Recs.perItemDataTransform==="function"){q.forEach(SS.Recs.perItemDataTransform)}L[_]={data:{items:q},expire:te(),call_queued:false};var e=document.getElementById(A);j=Q({order:u,current_element:e,content:C,context:L[_].data,css_class:"ss-recs-wrapper__LOADED",selected_element:c,html_unique_id:A,ss_recs_title:f});if(n&&typeof n==="function"){n.call(j,r,L[_].data)}if(L[_].data.items.length===0){if(D){F(r.variation_id)}typeof T==="function"&&T(r)}z({cache_hit:false,data:L[_].data,display_args:r,inserted_element:j})};N("Initial request or cache invalidated. Sending call to:",M);N("Request body parameters:",JSON.stringify(g));k.open("POST",M,true);k.setRequestHeader("Content-type","application/json");k.send(JSON.stringify(g))}else if(w&&!b&&!R){N("HTML missing, cache still valid.  Re-inserting HTML from cache.");j=Q({order:u,current_element:I||b,content:C,context:L[_].data,css_class:"ss-recs-wrapper__LOADED",selected_element:c,html_unique_id:A,ss_recs_title:f});if(n){n.call(j,r,L[_].data)}z({cache_hit:true,data:L[_].data,display_args:r,inserted_element:j})}else if(w&&b&&!R){N("Cache hit, Recommendation found in HTML. No actions taken.");z({cache_hit:true,data:L[_].data,display_args:r,inserted_element:null})}};function F(e){if(!e){N("hideRecsDisplay called without valid args")}var r=B(e,"HTML");var t=document.getElementById(r);if(t){t.style.display="none"}else{N("hideRecsDisplay called but recs placement does not exist")}N("Hiding recs placement with hideRecsDisplay for "+r)}function z(e){if(SS.Recs.onAfterRecsDisplayCycle&&typeof SS.Recs.onAfterRecsDisplayCycle==="function"){SS.Recs.onAfterRecsDisplayCycle({cache_hit:e.cache_hit,data:e.data,display_args:e.display_args,inserted_element:e.inserted_element})}}function J(r){var e=SS.Recs.getConfig();var t=e.display_query_defaults||{};y.forEach(function(e){if(typeof t[e]!=="undefined"){r[e]=t[e]}})}function V(e){var r=e.query,t=e.algorithm;if(p[t]){return p[t](r)}return r}function W(e,r){var t=SS.Recs.getConfig();if(!t.data||!r){return}var n=l[r];var i=c[r];var a;var s;if(n){a=t.data[n];if(typeof a!=="function"){console.warn("No data getter defined for input: "+r+"."+' Please define "'+n+'" in your Recommendations data Configuration.');return}s=a({},t)||""}else if(i){if(typeof SS[i]==="undefined"){console.warn("No SS variable defined for input: "+r+"."+'Please define "'+i+'" in your SS object.');return}s=SS[i]||""}else{console.warn("Unrecognized Recommendation input: "+r);return}var u=false;if(typeof t.flatten_single_item_arrays!=="undefined"){u=t.flatten_single_item_arrays}if(r!==f){if(u&&Array.isArray(s)&&s.length===1){s=s[0]}}var o=v({input:r,value:s});e[o]=s}function v(e){var r=e.input;var t=e.value;if(r===f){return"user"}if(Array.isArray(t)){return"itemSet"}return"item"}function G(e){var r=SS.Recs.getConfig().display_query_settings||{};var t=r.itemset_limit||u;if(e.itemSet&&Array.isArray(e.itemSet)&&e.itemSet.length>t){e.itemSet=e.itemSet.slice(0,t)}}function $(e){var r=false;e=e||{};if(e.throttled){e.queue_display=true;r=true;N("Display throttled, queueing display.")}else{e.throttled=true;setTimeout(function(){e.throttled=false;if(e.queue_display){e.queue_display=false;SS.Recs.displayRecommendation(e.recent_args)}},n)}return r}function X(e){if(!t[e]){t[e]={}}return t[e]}function h(){Object.keys(t).forEach(function(e){SS.Recs.displayRecommendation(t[e].recent_args)})}function g(){if(!t){return}Object.keys(t).forEach(function(e){var r=t[e];if(r.queue_display){N("Running queued display.",r);r.queue_display=false;SS.Recs.displayRecommendation(r.recent_args)}})}function K(r,e){var t=[];d.forEach(function(e){t.push(r[e])});t.push(e);return m(JSON.stringify(t))}function m(e){var r=0,t,n;if(e.length===0)return r;for(t=0;t<e.length;t++){n=e.charCodeAt(t);r=(r<<5)-r+n;r|=0}return r}function _(e){var r=e.html_id;var t=e.css_class;var n=e.content;var i=t?" "+t:"";n="<div id="+r+' class="ss-recs-wrapper'+i+'">'+n+"</div>";return n}function S(e){var r=document.createElement("div");r.innerHTML=e;return r.firstChild}function Q(e){var r=e.current_element;var t=e.order;var n=e.context;var i=e.content;var a=e.selected_element;var s=e.html_unique_id;var u=e.css_class;var o=e.ss_recs_title;var l;n.recs_heading=o;var c=Mustache.render(i,n);var f;if(r){f=r.parentNode;l=S(c);f.replaceChild(l,r)}else if(t==="Inside"){a.innerHTML=c;l=a.firstChild}else{l=S(c);if(t==="Before"){a.parentElement.insertBefore(l,a)}else if(t==="After"){a.parentElement.insertBefore(l,a.nextSibling)}}l.setAttribute("id",s);l.className+=" "+u;N("ss-recsdisplay: appending HTML block:",l);return l}function R(){return t}function w(){return L}function A(e){SS.Recs.enable_log_debug=e}function Y(e){e=JSON.parse(e);var u={};return e.reduce(function(e,r){var t;var n,i;var a=r.conditionScope||"default";var s="Current Item";n=u[a]=u[a]||x(a);i=u[s]=u[s]||x(s);if(!r.conditions||b(r.conditions,n)){t=I(r.actions,i);e=e.concat(t)}return e},[])}function Z(e){return Array.isArray(e)&&e.some(function(e){return Array.isArray(e.values)&&e.values.some(function(e){return typeof e==="object"})})}function ee(e){var r;var t;var n=e.item||e.itemSet;if(!n){r=SS.Recs.getConfig();t=r.data[s];if(typeof t!=="function"){return[]}n=t({},r)}if(n&&!Array.isArray(n)){n=[n]}return n||null}function b(e,r){return jsonLogic.apply(e,r)}function I(e,r){if(!Array.isArray(e)){e=[e]}return e.map(function(e){return C(e,r)})}function C(e,t){var r={name:e.name,bias:e.bias};if(Array.isArray(e.values)){r.values=e.values.reduce(function(e,r){return e.concat(k(r,t))},[])}else if(e.values){console.warn('Non-array "values" passed in for action "'+e.name+'". Please check your rules configuration.')}return r}function k(e,r){var t;if(typeof e==="object"){t=jsonLogic.apply(e,r);if(t){return t}}return e}function x(e){var r=o[e];var t=SS.Recs.getConfig();var n=t.data[r];if(typeof n!=="function"){console.warn("Rules defined but specified data getter not available. Please define "+r+" in your Recommendations data Configuration.");return[]}return n({},t)}function re(e,r,t){var n=SS.Recs.getConfig().display_query_settings||{};var i=n.onFailCallback;var a=typeof n.cleanup_recs_on_fail!=="undefined"?n.cleanup_recs_on_fail:true;if(a){F(e.variation_id)}var s=w();s[t]={data:{items:[]},expire:te(),call_queued:false};typeof i==="function"&&i(e,r);z({cache_hit:false,data:s[t].data})}function te(){var e=new Date;var r=e.setMilliseconds(e.getMilliseconds()+i);return r}function q(){SS.Recs.updateDisplays=h;var e=SS.Recs.getConfig();if(SS.Recs.debug){SS.Recs.getRecsRegistry=R;SS.Recs.getRecsCache=w;SS.Recs.setDisplayLogging=A}M=SS.Recs.getApiEndpoint("recs/");if(!M){throw"No recs server url specified.  Recommendations cannot be displayed without a recs server url."}SS.Recs.display_initialized=U=true;g()}})();(function(){var n;var i;(function e(r,t){if(typeof n==="object"&&n&&typeof n.nodeName!=="string"){t(n)}else if(typeof i==="function"&&i.amd){i(["exports"],t)}else{r.Mustache={};t(r.Mustache)}})(this,function e(R){var t=Object.prototype.toString;var w=Array.isArray||function e(r){return t.call(r)==="[object Array]"};function f(e){return typeof e==="function"}function a(e){return w(e)?"array":typeof e}function A(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function l(e,r){return e!=null&&typeof e==="object"&&r in e}function c(e,r){return e!=null&&typeof e!=="object"&&e.hasOwnProperty&&e.hasOwnProperty(r)}var n=RegExp.prototype.test;function r(e,r){return n.call(e,r)}var i=/\S/;function b(e){return!r(i,e)}var s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function u(e){return String(e).replace(/[&<>"'`=\/]/g,function e(r){return s[r]})}var I=/\s*/;var C=/\s+/;var k=/\s*=/;var x=/\s*\}/;var q=/#|\^|\/|>|\{|&|=|!/;function o(e,r){if(!e)return[];var t=[];var n=[];var i=[];var a=false;var s=false;function u(){if(a&&!s){while(i.length)delete n[i.pop()]}else{i=[]}a=false;s=false}var o,l,c;function f(e){if(typeof e==="string")e=e.split(C,2);if(!w(e)||e.length!==2)throw new Error("Invalid tags: "+e);o=new RegExp(A(e[0])+"\\s*");l=new RegExp("\\s*"+A(e[1]));c=new RegExp("\\s*"+A("}"+e[1]))}f(r||R.tags);var p=new O(e);var d,y,v,h,g,m;while(!p.eos()){d=p.pos;v=p.scanUntil(o);if(v){for(var _=0,S=v.length;_<S;++_){h=v.charAt(_);if(b(h)){i.push(n.length)}else{s=true}n.push(["text",h,d,d+1]);d+=1;if(h==="\n")u()}}if(!p.scan(o))break;a=true;y=p.scan(q)||"name";p.scan(I);if(y==="="){v=p.scanUntil(k);p.scan(k);p.scanUntil(l)}else if(y==="{"){v=p.scanUntil(c);p.scan(x);p.scanUntil(l);y="&"}else{v=p.scanUntil(l)}if(!p.scan(l))throw new Error("Unclosed tag at "+p.pos);g=[y,v,d,p.pos];n.push(g);if(y==="#"||y==="^"){t.push(g)}else if(y==="/"){m=t.pop();if(!m)throw new Error('Unopened section "'+v+'" at '+d);if(m[1]!==v)throw new Error('Unclosed section "'+m[1]+'" at '+d)}else if(y==="name"||y==="{"||y==="&"){s=true}else if(y==="="){f(v)}}m=t.pop();if(m)throw new Error('Unclosed section "'+m[1]+'" at '+p.pos);return j(E(n))}function E(e){var r=[];var t,n;for(var i=0,a=e.length;i<a;++i){t=e[i];if(t){if(t[0]==="text"&&n&&n[0]==="text"){n[1]+=t[1];n[3]=t[3]}else{r.push(t);n=t}}}return r}function j(e){var r=[];var t=r;var n=[];var i,a;for(var s=0,u=e.length;s<u;++s){i=e[s];switch(i[0]){case"#":case"^":t.push(i);n.push(i);t=i[4]=[];break;case"/":a=n.pop();a[5]=i[2];t=n.length>0?n[n.length-1][4]:r;break;default:t.push(i)}}return r}function O(e){this.string=e;this.tail=e;this.pos=0}O.prototype.eos=function e(){return this.tail===""};O.prototype.scan=function e(r){var t=this.tail.match(r);if(!t||t.index!==0)return"";var n=t[0];this.tail=this.tail.substring(n.length);this.pos+=n.length;return n};O.prototype.scanUntil=function e(r){var t=this.tail.search(r),n;switch(t){case-1:n=this.tail;this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t);this.tail=this.tail.substring(t)}this.pos+=n.length;return n};function p(e,r){this.view=e;this.cache={".":this.view};this.parent=r}p.prototype.push=function e(r){return new p(r,this)};p.prototype.lookup=function e(r){var t=this.cache;var n;if(t.hasOwnProperty(r)){n=t[r]}else{var i=this,a,s,u,o=false;while(i){if(r.indexOf(".")>0){a=i.view;s=r.split(".");u=0;while(a!=null&&u<s.length){if(u===s.length-1)o=l(a,s[u])||c(a,s[u]);a=a[s[u++]]}}else{a=i.view[r];o=l(i.view,r)}if(o){n=a;break}i=i.parent}t[r]=n}if(f(n))n=n.call(this.view);return n};function d(){this.cache={}}d.prototype.clearCache=function e(){this.cache={}};d.prototype.parse=function e(r,t){var n=this.cache;var i=r+":"+(t||R.tags).join(":");var a=n[i];if(a==null)a=n[i]=o(r,t);return a};d.prototype.render=function e(r,t,n,i){var a=this.parse(r,i);var s=t instanceof p?t:new p(t);return this.renderTokens(a,s,n,r,i)};d.prototype.renderTokens=function e(r,t,n,i,a){var s="";var u,o,l;for(var c=0,f=r.length;c<f;++c){l=undefined;u=r[c];o=u[0];if(o==="#")l=this.renderSection(u,t,n,i);else if(o==="^")l=this.renderInverted(u,t,n,i);else if(o===">")l=this.renderPartial(u,t,n,a);else if(o==="&")l=this.unescapedValue(u,t);else if(o==="name")l=this.escapedValue(u,t);else if(o==="text")l=this.rawValue(u);if(l!==undefined)s+=l}return s};d.prototype.renderSection=function e(r,t,n,i){var a=this;var s="";var u=t.lookup(r[1]);function o(e){return a.render(e,t,n)}if(!u)return;if(w(u)){for(var l=0,c=u.length;l<c;++l){s+=this.renderTokens(r[4],t.push(u[l]),n,i)}}else if(typeof u==="object"||typeof u==="string"||typeof u==="number"){s+=this.renderTokens(r[4],t.push(u),n,i)}else if(f(u)){if(typeof i!=="string")throw new Error("Cannot use higher-order sections without the original template");u=u.call(t.view,i.slice(r[3],r[5]),o);if(u!=null)s+=u}else{s+=this.renderTokens(r[4],t,n,i)}return s};d.prototype.renderInverted=function e(r,t,n,i){var a=t.lookup(r[1]);if(!a||w(a)&&a.length===0)return this.renderTokens(r[4],t,n,i)};d.prototype.renderPartial=function e(r,t,n,i){if(!n)return;var a=f(n)?n(r[1]):n[r[1]];if(a!=null)return this.renderTokens(this.parse(a,i),t,n,a)};d.prototype.unescapedValue=function e(r,t){var n=t.lookup(r[1]);if(n!=null)return n};d.prototype.escapedValue=function e(r,t){var n=t.lookup(r[1]);if(n!=null)return R.escape(n)};d.prototype.rawValue=function e(r){return r[1]};R.name="mustache.js";R.version="3.0.1";R.tags=["{{","}}"];var y=new d;R.clearCache=function e(){return y.clearCache()};R.parse=function e(r,t){return y.parse(r,t)};R.render=function e(r,t,n,i){if(typeof r!=="string"){throw new TypeError('Invalid template! Template should be a "string" '+'but "'+a(r)+'" was given as the first '+"argument for mustache#render(template, view, partials)")}return y.render(r,t,n,i)};R.to_html=function e(r,t,n,i){var a=R.render(r,t,n);if(f(i)){i(a)}else{return a}};R.escape=u;R.Scanner=O;R.Context=p;R.Writer=d;return R});(function(e,r){if(typeof i==="function"&&i.amd){i(r)}else if(typeof n==="object"){module.exports=r()}else{e.jsonLogic=r()}})(this,function(){"use strict";if(!Array.isArray){Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}function i(e){var r=[];for(var t=0,n=e.length;t<n;t++){if(r.indexOf(e[t])===-1){r.push(e[t])}}return r}var p={};var d={"==":function(e,r){return e==r},"===":function(e,r){return e===r},"!=":function(e,r){return e!=r},"!==":function(e,r){return e!==r},">":function(e,r){return e>r},">=":function(e,r){return e>=r},"<":function(e,r,t){return t===undefined?e<r:e<r&&r<t},"<=":function(e,r,t){return t===undefined?e<=r:e<=r&&r<=t},"!!":function(e){return p.truthy(e)},"!":function(e){return!p.truthy(e)},"%":function(e,r){return e%r},log:function(e){console.log(e);return e},in:function(e,r){if(!r||typeof r.indexOf==="undefined")return false;return r.indexOf(e)!==-1},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(e,r,t){if(t<0){var n=String(e).substr(r);return n.substr(0,n.length+t)}return String(e).substr(r,t)},"+":function(){return Array.prototype.reduce.call(arguments,function(e,r){return parseFloat(e,10)+parseFloat(r,10)},0)},"*":function(){return Array.prototype.reduce.call(arguments,function(e,r){return parseFloat(e,10)*parseFloat(r,10)})},"-":function(e,r){if(r===undefined){return-e}else{return e-r}},"/":function(e,r){return e/r},min:function(){return Math.min.apply(this,arguments)},max:function(){return Math.max.apply(this,arguments)},merge:function(){return Array.prototype.reduce.call(arguments,function(e,r){return e.concat(r)},[])},var:function(e,r){var t=r===undefined?null:r;var n=this;if(typeof e==="undefined"||e===""||e===null){return n}var i=String(e).split(".");for(var a=0;a<i.length;a++){if(n===null){return t}n=n[i[a]];if(n===undefined){return t}}return n},missing:function(){var e=[];var r=Array.isArray(arguments[0])?arguments[0]:arguments;for(var t=0;t<r.length;t++){var n=r[t];var i=p.apply({var:n},this);if(i===null||i===""){e.push(n)}}return e},missing_some:function(e,r){var t=p.apply({missing:r},this);if(r.length-t.length>=e){return[]}else{return t}},method:function(e,r,t){return e[r].apply(e,t)}};p.is_logic=function(e){return typeof e==="object"&&e!==null&&!Array.isArray(e)&&Object.keys(e).length===1};p.truthy=function(e){if(Array.isArray(e)&&e.length===0){return false}return!!e};p.get_operator=function(e){return Object.keys(e)[0]};p.get_values=function(e){return e[p.get_operator(e)]};p.apply=function(e,r){if(Array.isArray(e)){return e.map(function(e){return p.apply(e,r)})}if(!p.is_logic(e)){return e}r=r||{};var t=p.get_operator(e);var n=e[t];var i;var a;var s,u,o,l;if(!Array.isArray(n)){n=[n]}if(t==="if"||t=="?:"){for(i=0;i<n.length-1;i+=2){if(p.truthy(p.apply(n[i],r))){return p.apply(n[i+1],r)}}if(n.length===i+1)return p.apply(n[i],r);return null}else if(t==="and"){for(i=0;i<n.length;i+=1){a=p.apply(n[i],r);if(!p.truthy(a)){return a}}return a}else if(t==="or"){for(i=0;i<n.length;i+=1){a=p.apply(n[i],r);if(p.truthy(a)){return a}}return a}else if(t==="filter"){u=p.apply(n[0],r);s=n[1];if(!Array.isArray(u)){return[]}return u.filter(function(e){return p.truthy(p.apply(s,e))})}else if(t==="map"){u=p.apply(n[0],r);s=n[1];if(!Array.isArray(u)){return[]}return u.map(function(e){return p.apply(s,e)})}else if(t==="reduce"){u=p.apply(n[0],r);s=n[1];l=typeof n[2]!=="undefined"?n[2]:null;if(!Array.isArray(u)){return l}return u.reduce(function(e,r){return p.apply(s,{current:r,accumulator:e})},l)}else if(t==="all"){u=p.apply(n[0],r);s=n[1];if(!u.length){return false}for(i=0;i<u.length;i+=1){if(!p.truthy(p.apply(s,u[i]))){return false}}return true}else if(t==="none"){o=p.apply({filter:n},r);return o.length===0}else if(t==="some"){o=p.apply({filter:n},r);return o.length>0}n=n.map(function(e){return p.apply(e,r)});if(typeof d[t]==="function"){return d[t].apply(r,n)}else if(t.indexOf(".")>0){var c=String(t).split(".");var f=d;for(i=0;i<c.length;i++){f=f[c[i]];if(f===undefined){throw new Error("Unrecognized operation "+t+" (failed at "+c.slice(0,i+1).join(".")+")")}}return f.apply(r,n)}throw new Error("Unrecognized operation "+t)};p.uses_data=function(e){var r=[];if(p.is_logic(e)){var t=p.get_operator(e);var n=e[t];if(!Array.isArray(n)){n=[n]}if(t==="var"){r.push(n[0])}else{n.map(function(e){r.push.apply(r,p.uses_data(e))})}}return i(r)};p.add_operation=function(e,r){d[e]=r};p.rm_operation=function(e){delete d[e]};p.rule_like=function(e,r){if(r===e){return true}if(r==="@"){return true}if(r==="number"){return typeof e==="number"}if(r==="string"){return typeof e==="string"}if(r==="array"){return Array.isArray(e)&&!p.is_logic(e)}if(p.is_logic(r)){if(p.is_logic(e)){var t=p.get_operator(r);var n=p.get_operator(e);if(t==="@"||t===n){return p.rule_like(p.get_values(e,false),p.get_values(r,false))}}return false}if(Array.isArray(r)){if(Array.isArray(e)){if(r.length!==e.length){return false}for(var i=0;i<r.length;i+=1){if(!p.rule_like(e[i],r[i])){return false}}return true}else{return false}}return false};return p})})();
/* Copyright 2019, SiteSpect, Inc. All Rights Reserved. */
(function(){window.SS=window.SS||{};SS.Recs=SS.Recs||{};var e="https://recs.sitespect.net/v1/:site_id/";var r="2";if(e&&!e.match(/:site_id/)&&!e.match(/:config_id/)){E("recs api url missing site id/config id token",e);e=""}var t="events/";var n="recs_event";var i=[];var a="ss_recs_initial_event";var o="recs_initial_event_flagged";var c="ss_recs_initial_event_data";var s=100;var f=setInterval(function(){if(s<=0){clearInterval(f);return}if(u&&SS.EventTrack){s=0;A()}s--},100);var u;SS.Recs.registerRecsConfig=function(e){u=e;var r=true;if(typeof u.automatic_page_view!=="undefined"){r=u.automatic_page_view}if(typeof u.setupPageViewListener==="function"){u.setupPageViewListener(function(){y({action:"page-view"})})}if(r){i.push({action:"page-view"})}};SS.Recs.getConfig=function(){return u||null};SS.Recs.sendRecsEvent=function(e){i.push(e)};function l(e){if(!e.toString){return e}return e.toString().replace(/`/g,"`1").replace(/#/g,"`2").replace(/~/g,"`3")}function v(e){var r="~~";var t=r;var n="###";return Object.keys(e).map(function(r){var i=e[r];if(!(i instanceof Array)){i=[i]}return[l(r),i.map(l).join(n)].join(t)}).join(r)}function S(e){var r=u.page_types||{};return Object.keys(r).filter(function(t){var n=r[t];if(typeof n==="function"){return n(e,u)}})}function p(e){var r=e.actions;var t=e.args;var n=r.reduce(function(e,r){var n=u.actions[r];if(!n&&r==="page-view"){n={}}if(!n){throw"Unknown action: "+r}Object.keys(n).forEach(function(r){var i=n[r];var a=i;if(typeof i==="function"){a=i(t,u);if(typeof a!=="string"){return}}if(e[r]){return}var o=u.data[a];if(!o){throw r+": Data getter for "+a+" not defined."}var c;try{c=o(t,u)}catch(s){window.console&&console.error&&console.error("Error trying to get data for "+a,s);return}var f=d({value:c});if(f.valid){e[r]=f.out}});return e},{});return n}function d(e){var r=e.value;var t=!e.nested;var n=(typeof r).match(/boolean|string|number|bigint/);var i=!n;var a=r;var o=r;var c=[];var s=_(r);if(g(r)||r===""){n=false;c.push("Value is empty string or NaN.")}else if(t&&_(r)){i=false;n=r.length;if(!n){c.push("Array cannot be empty.")}o=r.map(function(e){var r=d({value:e,nested:true});if(!r.valid){n=false;c=c.concat(r.reasons.map(function(e){return"Invalid nested value: "+e}))}return r.out})}else if(s){n=false;c.push("Value is an array, but arrays aren't allowed here.")}if(!n){o=null}else if(typeof r==="boolean"){o=r.toString()}else if((typeof r).match(/number|bigint/)){o=r.toString("10")}var f,u;if(i){f="Invalid type. Must be a boolean, string, number,";u="or number.";if(t){u="number, or a flat array of such values."}c.push([f,u].join(" "))}n=!!n;var l={valid:n,input:a};if(!n){l.reasons=c}else{l.out=o}return l}function _(e){if(window.Array&&Array.isArray){return Array.isArray(e)}else{return Object.prototype.toString.call(e)==="[object Array]"}}function g(e){return typeof e==="number"&&e!==e}function y(e){var r=e.action;if(!r){throw"No action declared."}if(!(r instanceof Array)){r=[r]}var t=[];r.some(function(r){if(r!=="page-view"){return}t=t.concat(S(e));return true});var n=p({actions:r.concat(t),args:e});if(Object.keys(n).length){if(m(n)){return}w();b(n)}}function b(e){R(e);I(e)}function m(e){if(localStorage.getItem(a)!==o){localStorage.setItem(a,o);localStorage.setItem(c,JSON.stringify(e));return true}return false}function w(){var e=localStorage.getItem(c);if(e){localStorage.removeItem(c);var r;try{r=JSON.parse(e);b(r)}catch(t){window.console&&console.error&&console.error("Error trying to get initial recs event data.",t);window.console&&console.error&&console.error("Initial event data:",r)}}}function R(e){if(!SS.Recs.enable_et){return}var r={};Object.keys(e).forEach(function(t){r[t]=e[t]});if(SS.GUID){r["user-id"]=SS.GUID}SS.EventTrack.rp(n,v(r))}function h(t){if(typeof t!=="string"){E("API endpoint suffix must be a string.",{provided:t})}var n;if(e.match(/:site_id/)){if(!SS.site_id){E("No Site ID configured");return""}n=e.replace(/:site_id\b/g,SS.site_id)}else if(e.match(/:config_id/)){if(!r||!SS.site_id){E("No Site ID or Cluster ID configured");return""}var i=[r,SS.site_id,"1"].join("-");n=e.replace(/:config_id\b/g,i)}if(SS.Recs.override_recs_api_url){if(typeof SS.Recs.override_recs_api_url==="string"&&SS.Recs.override_recs_api_url.indexOf("/")===-1){n=n.replace(/(https?:\/\/)(.*?)(\/.*)/,"$1"+SS.Recs.override_recs_api_url+"$3")}else{E("SS.Recs.override_recs_api_url is invalid.  override_recs_api_url must be a valid fqdn without protocol or slashes")}}if(!n.match(/\/$/)){n+="/"}n+=t;return n}function I(r){if(!e||!SS.Recs.enable_api){return}var n=h(t);if(!n){return}var i=new XMLHttpRequest;i.open("POST",n);i.setRequestHeader("Content-Type","application/json;charset=UTF-8");i.send(JSON.stringify(j(r)))}function j(e){var r={events:Object.keys(e).map(function(r){var t=e[r];if(!(t instanceof Array)){t=[t]}return{name:r,entityIds:t}})};if(SS.GUID){r.userId=SS.GUID}return r}function A(){SS.Recs=SS.Recs||{};SS.Recs.sendRecsEvent=y;SS.Recs.getApiEndpoint=h;SS.Recs.enable_api=typeof SS.Recs.enable_api==="undefined"?true:SS.Recs.enable_api;SS.Recs.enable_et=typeof SS.Recs.enable_et==="undefined"?true:SS.Recs.enable_et;i.forEach(y);SS.Recs.capture_initialized=true}function E(){var e=[].slice.call(arguments);window.console&&console.warn&&console.warn.apply(console,e)}})();