require=function t(e,i,s){function o(r,a){if(!i[r]){if(!e[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(n)return n(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var h=i[r]={exports:{}};e[r][0].call(h.exports,(function(t){return o(e[r][1][t]||t)}),h,h.exports,t,e,i,s)}return i[r].exports}for(var n="function"==typeof require&&require,r=0;r<s.length;r++)o(s[r]);return o}({1:[function(t,e,i){var s=t("aws-sdk"),o=t("aws-sdk-mobile-analytics");"undefined"!=typeof window&&(window.AWS=s,window.AMA=o);var n={AWS:s,AMA:o};e.exports=n},{"aws-sdk":"aws-sdk","aws-sdk-mobile-analytics":8}],2:[function(t,e,i){(function(i){var s=t("aws-sdk"),o=i.AMA;o.Storage=t("./StorageClients/LocalStorage.js"),o.StorageKeys=t("./StorageClients/StorageKeys.js"),o.Util=t("./MobileAnalyticsUtilities.js"),o.Client=function(){"use strict";var t=function(t){if(Function.prototype.bind||(Function.prototype.bind=function(t){"function"!=typeof this&&this.logger.error("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,s=function(){return i.apply(this instanceof o.Util.NOP&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return o.Util.NOP.prototype=this.prototype,s.prototype=new o.Util.NOP,s}),this.options=t||{},this.options.logger=this.options.logger||{},this.logger={log:this.options.logger.log||o.Util.NOP,info:this.options.logger.info||o.Util.NOP,warn:this.options.logger.warn||o.Util.NOP,error:this.options.logger.error||o.Util.NOP},this.logger.log=this.logger.log.bind(this.options.logger),this.logger.info=this.logger.info.bind(this.options.logger),this.logger.warn=this.logger.warn.bind(this.options.logger),this.logger.error=this.logger.error.bind(this.options.logger),this.logger.log("[Function:(AMA)Client Constructor]"+(t?"\noptions:"+JSON.stringify(t):"")),void 0===t.appId)return this.logger.error("AMA.Client must be initialized with an appId"),null;void 0===t.platform&&this.logger.error("AMA.Client must be initialized with a platform"),this.storage=this.options.storage||new o.Storage(t.appId),this.storage.setLogger(this.logger),this.options.apiVersion=this.options.apiVersion||"2014-06-05",this.options.provider=this.options.provider||s.config.credentials,this.options.autoSubmitEvents=false!==t.autoSubmitEvents,this.options.autoSubmitInterval=this.options.autoSubmitInterval||1e4,this.options.batchSizeLimit=this.options.batchSizeLimit||256e3,this.options.submitCallback=this.options.submitCallback||o.Util.NOP,this.options.globalAttributes=this.options.globalAttributes||{},this.options.globalMetrics=this.options.globalMetrics||{},this.options.clientOptions=this.options.clientOptions||{},this.options.clientOptions.provider=this.options.clientOptions.provider||this.options.provider,this.options.clientOptions.apiVersion=this.options.clientOptions.apiVersion||this.options.apiVersion,this.options.clientOptions.correctClockSkew=false!==this.options.clientOptions.correctClockSkew,this.options.clientOptions.retryDelayOptions=this.options.clientOptions.retryDelayOptions||{},this.options.clientOptions.retryDelayOptions.base=this.options.clientOptions.retryDelayOptions.base||3e3,this.storage.set(o.StorageKeys.GLOBAL_ATTRIBUTES,o.Util.mergeObjects(this.options.globalAttributes,this.storage.get(o.StorageKeys.GLOBAL_ATTRIBUTES)||{})),this.storage.set(o.StorageKeys.GLOBAL_METRICS,o.Util.mergeObjects(this.options.globalMetrics,this.storage.get(o.StorageKeys.GLOBAL_METRICS)||{}));var e=this.storage.get(o.StorageKeys.CLIENT_ID);try{if(window&&window.localStorage){var i=window.localStorage.getItem("AWSMobileAnalyticsStorage");if(i)try{var n=(i=JSON.parse(i)).AWSMobileAnalyticsClientId;n&&e&&e!==n&&(this.options.globalAttributes.migrationId=e),n&&(e=n)}catch(t){this.logger.warn("Had corrupt v0.9.0 Storage")}}}catch(t){this.logger.warn("window is undefined, unable to check for v090 data")}this.options.clientContext=this.options.clientContext||{client:{client_id:this.options.clientId||e||o.Util.GUID(),app_title:this.options.appTitle,app_version_name:this.options.appVersionName,app_version_code:this.options.appVersionCode,app_package_name:this.options.appPackageName},env:{platform:this.options.platform,platform_version:this.options.platformVersion,model:this.options.model,make:this.options.make,locale:this.options.locale},services:{mobile_analytics:{app_id:this.options.appId,sdk_name:"aws-sdk-mobile-analytics-js",sdk_version:"0.9.2:"+s.VERSION}},custom:{}},this.storage.set(o.StorageKeys.CLIENT_ID,this.options.clientContext.client.client_id),this.StorageKeys={EVENTS:"AWSMobileAnalyticsEventStorage",BATCHES:"AWSMobileAnalyticsBatchStorage",BATCH_INDEX:"AWSMobileAnalyticsBatchIndexStorage"},this.outputs={},this.outputs.MobileAnalytics=new s.MobileAnalytics(this.options.clientOptions),this.outputs.timeoutReference=null,this.outputs.batchesInFlight={},this.outputs.events=this.storage.get(this.StorageKeys.EVENTS)||[],this.outputs.batches=this.storage.get(this.StorageKeys.BATCHES)||{},this.outputs.batchIndex=this.storage.get(this.StorageKeys.BATCH_INDEX)||[],this.options.autoSubmitEvents&&this.submitEvents()};return t.prototype.validateEvent=function(t){var e,i=this;function s(t){return 0===t.length||t.length>50}function o(t){return i.logger.error(t),null}return e=Object.keys(t.metrics).filter((function(e){return"number"!=typeof t.metrics[e]})),"v2.0"!==t.version?o("Event must have version v2.0"):"string"!=typeof t.eventType?o("Event Type must be a string"):e.length>0?o("Event Metrics must be numeric ("+e[0]+")"):Object.keys(t.metrics).length+Object.keys(t.attributes).length>40?o("Event Metric and Attribute Count cannot exceed 40"):Object.keys(t.attributes).filter(s).length?o("Event Attribute names must be 1-50 characters"):Object.keys(t.metrics).filter(s).length?o("Event Metric names must be 1-50 characters"):Object.keys(t.attributes).filter((function(e){return t.attributes[e]&&t.attributes[e].length>200})).length?o("Event Attribute values cannot be longer than 200 characters"):t},t.prototype.createEvent=function(t,e,i,s){var n=this;this.logger.log("[Function:(AMA.Client).createEvent]"+(t?"\neventType:"+t:"")+(e?"\nsession:"+e:"")+(i?"\nattributes:"+JSON.stringify(i):"")+(s?"\nmetrics:"+JSON.stringify(s):"")),i=i||{},s=s||{},o.Util.mergeObjects(i,this.options.globalAttributes),o.Util.mergeObjects(s,this.options.globalMetrics),Object.keys(i).forEach((function(t){if("string"!=typeof i[t])try{i[t]=JSON.stringify(i[t])}catch(e){n.logger.warn("Error parsing attribute "+t)}}));var r={eventType:t,timestamp:(new Date).toISOString(),session:{id:e.id,startTimestamp:e.startTimestamp},version:"v2.0",attributes:i,metrics:s};return e.stopTimestamp&&(r.session.stopTimestamp=e.stopTimestamp,r.session.duration=new Date(r.stopTimestamp).getTime()-new Date(r.startTimestamp).getTime()),this.validateEvent(r)},t.prototype.pushEvent=function(t){if(!t)return-1;this.logger.log("[Function:(AMA.Client).pushEvent]"+(t?"\nevent:"+JSON.stringify(t):""));var e=this.outputs.events.push(t);return this.storage.set(this.StorageKeys.EVENTS,this.outputs.events),e-1},t.prototype.recordEvent=function(t,e,i,s){this.logger.log("[Function:(AMA.Client).recordEvent]"+(t?"\neventType:"+t:"")+(e?"\nsession:"+e:"")+(i?"\nattributes:"+JSON.stringify(i):"")+(s?"\nmetrics:"+JSON.stringify(s):""));var n,r=this.createEvent(t,e,i,s);return r?(n=this.pushEvent(r),o.Util.getRequestBodySize(this.outputs.events)>=this.options.batchSizeLimit&&this.submitEvents(),this.outputs.events[n]):null},t.prototype.recordMonetizationEvent=function(t,e,i,s){return this.logger.log("[Function:(AMA.Client).recordMonetizationEvent]"+(t?"\nsession:"+t:"")+(e?"\nmonetizationDetails:"+JSON.stringify(e):"")+(i?"\nattributes:"+JSON.stringify(i):"")+(s?"\nmetrics:"+JSON.stringify(s):"")),s=s||{},(i=i||{})._currency=e.currency||i._currency,i._product_id=e.productId||i._product_id,s._quantity=e.quantity||s._quantity,"number"==typeof e.price?s._item_price=e.price||s._item_price:i._item_price_formatted=e.price||i._item_price_formatted,this.recordEvent("_monetization.purchase",t,i,s)},t.prototype.submitEvents=function(t){var e;return(t=t||{}).submitCallback=t.submitCallback||this.options.submitCallback,this.logger.log("[Function:(AMA.Client).submitEvents]"+(t?"\noptions:"+JSON.stringify(t):"")),this.options.autoSubmitEvents&&(clearTimeout(this.outputs.timeoutReference),this.outputs.timeoutReference=setTimeout(this.submitEvents.bind(this),this.options.autoSubmitInterval)),this.outputs.isThrottled&&this.throttlingSuppressionFunction()<Math.random()?e="Prevented submission while throttled":Object.keys(this.outputs.batchesInFlight).length>0?e="Prevented submission while batches are in flight":0===this.outputs.batches.length&&0===this.outputs.events.length?e="No batches or events to be submitted":this.outputs.lastSubmitTimestamp&&o.Util.timestamp()-this.outputs.lastSubmitTimestamp<1e3&&(e="Prevented multiple submissions in under a second"),e?(this.logger.warn(e),[]):(this.generateBatches(),this.outputs.lastSubmitTimestamp=o.Util.timestamp(),this.outputs.isThrottled?(this.logger.warn("Is throttled submitting first batch"),t.batchId=this.outputs.batchIndex[0],[this.submitBatchById(t)]):this.submitAllBatches(t))},t.prototype.throttlingSuppressionFunction=function(t){return t=t||o.Util.timestamp(),Math.pow(t-this.outputs.lastSubmitTimestamp,2)/Math.pow(6e4,2)},t.prototype.generateBatches=function(){for(;this.outputs.events.length>0;){var t=this.outputs.events.length;for(this.logger.log(this.outputs.events.length+" events to be submitted");t>1&&o.Util.getRequestBodySize(this.outputs.events.slice(0,t))>this.options.batchSizeLimit;)this.logger.log("Finding Batch Size ("+this.options.batchSizeLimit+"): "+t+"("+o.Util.getRequestBodySize(this.outputs.events.slice(0,t))+")"),t-=1;this.persistBatch(this.outputs.events.slice(0,t))&&(this.outputs.events.splice(0,t),this.storage.set(this.StorageKeys.EVENTS,this.outputs.events))}},t.prototype.persistBatch=function(t){if(this.logger.log(t.length+" events in batch"),o.Util.getRequestBodySize(t)<512e3){var e=o.Util.GUID();return this.outputs.batches[e]=t,this.storage.set(this.StorageKeys.BATCHES,this.outputs.batches),this.outputs.batchIndex.push(e),this.storage.set(this.StorageKeys.BATCH_INDEX,this.outputs.batchIndex),true}return this.logger.error("Events too large"),false},t.prototype.submitAllBatches=function(t){t.submitCallback=t.submitCallback||this.options.submitCallback,this.logger.log("[Function:(AMA.Client).submitAllBatches]"+(t?"\noptions:"+JSON.stringify(t):""));var e=[],i=this;return this.outputs.batchIndex.forEach((function(s){t.batchId=s,t.clientContext=t.clientContext||i.options.clientContext,i.outputs.batchesInFlight[s]||e.push(i.submitBatchById(t))})),e},t.NON_RETRYABLE_EXCEPTIONS=["BadRequestException","SerializationException","ValidationException"],t.prototype.submitBatchById=function(t){if("object"==typeof t&&t.batchId){t.submitCallback=t.submitCallback||this.options.submitCallback,this.logger.log("[Function:(AMA.Client).submitBatchById]"+(t?"\noptions:"+JSON.stringify(t):""));var e={events:this.outputs.batches[t.batchId],clientContext:JSON.stringify(t.clientContext||this.options.clientContext)};return this.outputs.batchesInFlight[t.batchId]=o.Util.timestamp(),this.outputs.MobileAnalytics.putEvents(e,this.handlePutEventsResponse(t.batchId,t.submitCallback)),t.batchId}this.logger.error("Invalid Options passed to submitBatchById")},t.prototype.handlePutEventsResponse=function(e,i){var s=this;return function(o,n){var r=true,a=s.outputs.isThrottled;o?(s.logger.error(o,n),void 0!==o.statusCode&&400!==o.statusCode||(t.NON_RETRYABLE_EXCEPTIONS.indexOf(o.code)<0&&(r=false),s.outputs.isThrottled="ThrottlingException"===o.code,s.outputs.isThrottled&&s.logger.warn("Application is currently throttled"))):(s.logger.info("Events Submitted Successfully"),s.outputs.isThrottled=false),r&&s.clearBatchById(e),delete s.outputs.batchesInFlight[e],i(o,n,e),a&&!s.outputs.isThrottled&&(s.logger.warn("Was throttled flushing remaining batches",i),s.submitAllBatches({submitCallback:i}))}},t.prototype.clearBatchById=function(t){this.logger.log("[Function:(AMA.Client).clearBatchById]"+(t?"\nbatchId:"+t:"")),-1!==this.outputs.batchIndex.indexOf(t)&&(delete this.outputs.batches[t],this.outputs.batchIndex.splice(this.outputs.batchIndex.indexOf(t),1),this.storage.set(this.StorageKeys.BATCH_INDEX,this.outputs.batchIndex),this.storage.set(this.StorageKeys.BATCHES,this.outputs.batches))},t}(),e.exports=o.Client}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./MobileAnalyticsUtilities.js":5,"./StorageClients/LocalStorage.js":6,"./StorageClients/StorageKeys.js":7,"aws-sdk":"aws-sdk"}],3:[function(t,e,i){(function(i){var s=i.AMA;s.Storage=t("./StorageClients/LocalStorage.js"),s.StorageKeys=t("./StorageClients/StorageKeys.js"),s.Util=t("./MobileAnalyticsUtilities.js"),s.Session=function(){"use strict";var t=function(t){this.options=t||{},this.options.logger=this.options.logger||{},this.logger={log:this.options.logger.log||s.Util.NOP,info:this.options.logger.info||s.Util.NOP,warn:this.options.logger.warn||s.Util.NOP,error:this.options.logger.error||s.Util.NOP},this.logger.log=this.logger.log.bind(this.options.logger),this.logger.info=this.logger.info.bind(this.options.logger),this.logger.warn=this.logger.warn.bind(this.options.logger),this.logger.error=this.logger.error.bind(this.options.logger),this.logger.log("[Function:(AWS.MobileAnalyticsClient)Session Constructor]"+(t?"\noptions:"+JSON.stringify(t):"")),this.options.expirationCallback=this.options.expirationCallback||s.Util.NOP,this.id=this.options.sessionId||s.Util.GUID(),this.sessionLength=this.options.sessionLength||6e5,this.StorageKeys={SESSION_ID:s.StorageKeys.SESSION_ID+this.id,SESSION_EXPIRATION:s.StorageKeys.SESSION_EXPIRATION+this.id,SESSION_START_TIMESTAMP:s.StorageKeys.SESSION_START_TIMESTAMP+this.id},this.startTimestamp=this.options.startTime||this.options.storage.get(this.StorageKeys.SESSION_START_TIMESTAMP)||(new Date).toISOString(),this.expirationDate=parseInt(this.options.storage.get(this.StorageKeys.SESSION_EXPIRATION),10),isNaN(this.expirationDate)&&(this.expirationDate=(new Date).getTime()+this.sessionLength),this.options.storage.set(this.StorageKeys.SESSION_ID,this.id),this.options.storage.set(this.StorageKeys.SESSION_EXPIRATION,this.expirationDate),this.options.storage.set(this.StorageKeys.SESSION_START_TIMESTAMP,this.startTimestamp),this.sessionTimeoutReference=setTimeout(this.expireSession.bind(this),this.sessionLength)};return t.prototype.expireSession=function(t){this.logger.log("[Function:(Session).expireSession]");var e=(t=t||this.options.expirationCallback)(this);"boolean"==typeof e&&e&&(e=this.options.sessionLength),"number"==typeof e?this.extendSession(e):this.clearSession()},t.prototype.clearSession=function(){this.logger.log("[Function:(Session).clearSession]"),clearTimeout(this.sessionTimeoutReference),this.options.storage.delete(this.StorageKeys.SESSION_ID),this.options.storage.delete(this.StorageKeys.SESSION_EXPIRATION),this.options.storage.delete(this.StorageKeys.SESSION_START_TIMESTAMP)},t.prototype.extendSession=function(t){this.logger.log("[Function:(Session).extendSession]"+(t?"\nsessionExtensionLength:"+t:"")),t=t||this.sessionLength,this.setSessionTimeout(this.expirationDate+parseInt(t,10))},t.prototype.stopSession=function(t){this.logger.log("[Function:(Session).stopSession]"+(t?"\nstopDate:"+t:"")),this.stopTimestamp=t||(new Date).toISOString()},t.prototype.resetSessionTimeout=function(t){this.logger.log("[Function:(Session).resetSessionTimeout]"+(t?"\nmilliseconds:"+t:"")),t=t||this.sessionLength,this.setSessionTimeout((new Date).getTime()+t)},t.prototype.setSessionTimeout=function(t){this.logger.log("[Function:(Session).setSessionTimeout]"+(t?"\ntimeout:"+t:"")),clearTimeout(this.sessionTimeoutReference),this.expirationDate=t,this.options.storage.set(this.StorageKeys.SESSION_EXPIRATION,this.expirationDate),this.sessionTimeoutReference=setTimeout(this.expireSession.bind(this),this.expirationDate-(new Date).getTime())},t}(),e.exports=s.Session}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./MobileAnalyticsUtilities.js":5,"./StorageClients/LocalStorage.js":6,"./StorageClients/StorageKeys.js":7}],4:[function(t,e,i){(function(i){var s=i.AMA;s.Storage=t("./StorageClients/LocalStorage.js"),s.StorageKeys=t("./StorageClients/StorageKeys.js"),s.Session=t("./MobileAnalyticsSession.js"),s.Client=t("./MobileAnalyticsClient.js"),s.Manager=function(){"use strict";var t=function(t){var e;t instanceof s.Client?this.client=t:(t._autoSubmitEvents=t.autoSubmitEvents,t.autoSubmitEvents=false,this.client=new s.Client(t),t.autoSubmitEvents=false!==t._autoSubmitEvents,delete t._autoSubmitEvents),this.options=this.client.options,this.outputs=this.client.outputs,this.options.expirationCallback=this.options.expirationCallback||s.Util.NOP,(e=this).client.storage.each((function(t){0===t.indexOf(s.StorageKeys.SESSION_ID)&&(e.outputs.session=new s.Session({storage:e.client.storage,sessionId:e.client.storage.get(t),sessionLength:e.options.sessionLength,expirationCallback:function(t){var i=e.options.expirationCallback(t);if(true===i||"number"==typeof i)return i;e.stopSession()}}),(new Date).getTime()>e.outputs.session.expirationDate&&(e.outputs.session.expireSession(),delete e.outputs.session))})),this.outputs.session||this.startSession(),this.options.autoSubmitEvents&&this.client.submitEvents()};return t.prototype.submitEvents=function(t){return this.client.submitEvents(t)},t.prototype.startSession=function(){return this.client.logger.log("[Function:(AMA.Manager).startSession]"),this.outputs.session&&this.outputs.session.clearSession(),this.outputs.session=new s.Session({storage:this.client.storage,logger:this.client.options.logger,sessionLength:this.options.sessionLength,expirationCallback:function(t){var e=this.options.expirationCallback(t);if(true===e||"number"==typeof e)return e;this.stopSession()}.bind(this)}),this.recordEvent("_session.start")},t.prototype.extendSession=function(t){return this.outputs.session.extendSession(t||this.options.sessionLength)},t.prototype.stopSession=function(){return this.client.logger.log("[Function:(AMA.Manager).stopSession]"),this.outputs.session.stopSession(),this.outputs.session.expireSession(s.Util.NOP),this.recordEvent("_session.stop")},t.prototype.renewSession=function(){return this.stopSession(),this.startSession(),this.outputs.session},t.prototype.createEvent=function(t,e,i){return this.client.createEvent(t,this.outputs.session,e,i)},t.prototype.recordEvent=function(t,e,i){return this.client.recordEvent(t,this.outputs.session,e,i)},t.prototype.recordMonetizationEvent=function(t,e,i){return this.client.recordMonetizationEvent(this.outputs.session,t,e,i)},t}(),e.exports=s.Manager}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./MobileAnalyticsClient.js":2,"./MobileAnalyticsSession.js":3,"./StorageClients/LocalStorage.js":6,"./StorageClients/StorageKeys.js":7}],5:[function(t,e,i){(function(t){var i=t.AMA;i.Util=function(){"use strict";function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function e(t,e){return Object.keys(e).forEach((function(i){e.hasOwnProperty(i)&&(t[i]=t[i]||e[i])})),t}return{copy:function(t,i){return e(JSON.parse(JSON.stringify(t)),i||{})},GUID:function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},getRequestBodySize:function(t){"string"!=typeof t&&(t=JSON.stringify(t));var e,i,s=t.length;for(e=t.length-1;e>=0;e-=1)(i=t.charCodeAt(e))>127&&i<=2047?s+=1:i>2047&&i<=65535&&(s+=2),i>=56320&&i<=57343&&(e-=1);return s},mergeObjects:e,NOP:function(){},timestamp:function(){return(new Date).getTime()}}}(),e.exports=i.Util}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(t,e,i){(function(i){var s=i.AMA;s.Util=t("../MobileAnalyticsUtilities.js"),s.Storage=function(){"use strict";var t=function(t){this.storageKey="AWSMobileAnalyticsStorage-"+t,i[this.storageKey]=i[this.storageKey]||{},this.cache=i[this.storageKey],this.cache.id=this.cache.id||s.Util.GUID(),this.logger={log:s.Util.NOP,info:s.Util.NOP,warn:s.Util.NOP,error:s.Util.NOP},this.reload()};if("object"==typeof localStorage&&"object"===Storage)try{localStorage.setItem("TestLocalStorage",1),localStorage.removeItem("TestLocalStorage")}catch(t){Storage.prototype._setItem=Storage.prototype.setItem,Storage.prototype.setItem=s.Util.NOP}return t.prototype.type="LOCAL_STORAGE",t.prototype.get=function(t){return this.cache[t]},t.prototype.set=function(t,e){return this.cache[t]=e,this.saveToLocalStorage()},t.prototype.delete=function(t){delete this.cache[t],this.saveToLocalStorage()},t.prototype.each=function(t){var e;for(e in this.cache)this.cache.hasOwnProperty(e)&&t(e,this.cache[e])},t.prototype.saveToLocalStorage=function(){if(this.supportsLocalStorage())try{this.logger.log("[Function:(AWS.MobileAnalyticsClient.Storage).saveToLocalStorage]"),window.localStorage.setItem(this.storageKey,JSON.stringify(this.cache)),this.logger.log("LocalStorage Cache: "+JSON.stringify(this.cache))}catch(t){this.logger.log("Error saving to LocalStorage: "+JSON.stringify(t))}else this.logger.log("LocalStorage is not available")},t.prototype.reload=function(){var t;if(this.supportsLocalStorage())try{if(this.logger.log("[Function:(AWS.MobileAnalyticsClient.Storage).loadLocalStorage]"),t=window.localStorage.getItem(this.storageKey),this.logger.log("LocalStorage Cache: "+t),t)try{this.cache=JSON.parse(t)}catch(t){this.clearLocalStorage()}}catch(t){this.logger.log("Error loading LocalStorage: "+JSON.stringify(t)),this.clearLocalStorage()}else this.logger.log("LocalStorage is not available")},t.prototype.setLogger=function(t){this.logger=t},t.prototype.supportsLocalStorage=function(){try{return window&&window.localStorage}catch(t){return false}},t.prototype.clearLocalStorage=function(){if(this.cache={},this.supportsLocalStorage())try{this.logger.log("[Function:(AWS.MobileAnalyticsClient.Storage).clearLocalStorage]"),window.localStorage.removeItem(this.storageKey),i[this.storageKey]={}}catch(t){this.logger.log("Error clearing LocalStorage: "+JSON.stringify(t))}else this.logger.log("LocalStorage is not available")},t}(),e.exports=s.Storage}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../MobileAnalyticsUtilities.js":5}],7:[function(t,e,i){(function(t){var i=t.AMA;i.StorageKeys={CLIENT_ID:"AWSMobileAnalyticsClientId",GLOBAL_ATTRIBUTES:"AWSMobileAnalyticsGlobalAttributes",GLOBAL_METRICS:"AWSMobileAnalyticsGlobalMetrics",SESSION_ID:"MobileAnalyticsSessionId",SESSION_EXPIRATION:"MobileAnalyticsSessionExpiration",SESSION_START_TIMESTAMP:"MobileAnalyticsSessionStartTimeStamp"},e.exports=i.StorageKeys}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(t,e,i){(function(i){i.AMA=i.AMA||{},t("./MobileAnalyticsClient.js"),t("./MobileAnalyticsUtilities.js"),t("./StorageClients/StorageKeys.js"),t("./StorageClients/LocalStorage.js"),t("./MobileAnalyticsSession.js"),t("./MobileAnalyticsSessionManager.js"),e.exports=i.AMA}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./MobileAnalyticsClient.js":2,"./MobileAnalyticsSession.js":3,"./MobileAnalyticsSessionManager.js":4,"./MobileAnalyticsUtilities.js":5,"./StorageClients/LocalStorage.js":6,"./StorageClients/StorageKeys.js":7}],9:[function(t,e,i){e.exports=t("./lib/aws4")},{"./lib/aws4":10}],10:[function(t,e,i){var s=i,o=t("./hash"),n=t("./hmac"),r=t("./byte-length"),a=t("./querystring-stringify"),l="X-Amz-Date",c="X-AMZ-Expires",h="X-Amz-Algorithm",u="X-Amz-Credential",p="X-Amz-SignedHeaders",g="X-Amz-Signature",d="X-Amz-Security-Token";function f(t,e){var i=t.headers=t.headers||{};this.request=t,this.credentials=e,this.service=t.service,this.region=t.region,"email"===this.service&&(this.service="ses"),i.host=t.host,t.hostname=t.host}function S(){if(!this.datetime){var t=this.request.headers,e=new Date(t.Date||t.date||new Date);this.datetime=e.toISOString().replace(/[:\-]|\.\d{3}/g,"")}return this.datetime}function y(){return S.call(this).substr(0,8)}function b(){return["AWS4-HMAC-SHA256 Credential="+this.credentials.accessKeyId+"/"+O.call(this),"SignedHeaders="+w.call(this),"Signature="+m.call(this)].join(", ")}function m(){var t=y.call(this),e=n("AWS4"+this.credentials.secretAccessKey,t),i=n(e,this.region),s=n(i,this.service),o=n(s,"aws4_request");return n(o,v.call(this),"hex")}function v(){return["AWS4-HMAC-SHA256",S.call(this),O.call(this),o(A.call(this))].join("\n")}function A(){var t;t="s3"===this.service&&this.request.signQuery?"UNSIGNED-PAYLOAD":o(this.request.body||"","hex");var e=a(this.request.query);return[this.request.method.toUpperCase(),this.request.path,e,I.call(this)+"\n",w.call(this),t].join("\n")}function I(){var t=this.request.headers;return Object.keys(t).sort((function(t,e){return t.toLowerCase()<e.toLowerCase()?-1:1})).map((function(e){return e.toLowerCase()+":"+t[e].toString().trim().replace(/\s+/g," ")})).join("\n")}function w(){return Object.keys(this.request.headers).map((function(t){return t.toLowerCase()})).sort().join(";")}function O(){return[y.call(this),this.region,this.service,"aws4_request"].join("/")}f.prototype.sign=function(){var t,e=this.request,i=e.headers;return e.signQuery?(t=e.query,this.credentials.sessionToken&&(t[d]=this.credentials.sessionToken),"s3"!==this.service||t[i.expires]||(t[c]=86400),t[l]?this.datetime=t[l]:t[l]=S.call(this),t[h]="AWS4-HMAC-SHA256",t[u]=this.credentials.accessKeyId+"/"+O.call(this),t[p]=w.call(this),e.path+="&"+g+"="+m.call(this)):(e.doNotModifyHeaders||(!e.body||i["Content-Type"]||i["content-type"]||(i["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8"),!e.body||i["Content-Length"]||i["content-length"]||(i["Content-Length"]=r(e.body)),this.credentials.sessionToken&&(i[d]=this.credentials.sessionToken),"s3"===this.service&&(i[amazonheaders.contentSha256]=o(this.request.body||"")),i[l]?this.datetime=i[l]:i[l]=S.call(this)),delete i.Authorization,delete i.authorization,i.Authorization=b.call(this)),e.path+="?"+a(e.query),e},s.RequestSigner=f,s.sign=function(t,e){return new f(t,e).sign()}},{"./byte-length":11,"./hash":12,"./hmac":14,"./querystring-stringify":15}],11:[function(t,e,i){e.exports=function(t){for(var e=t.length,i=t.length-1;i>=0;i--){var s=t.charCodeAt(i);s>127&&s<=2047?e+=1:s>2047&&s<=65535&&(e+=2),s>=56320&&s<=57343&&i--}return e}},{}],12:[function(t,e,i){var s=t("crypto-js/sha256"),o=t("./hexer");e.exports=function(t){var e=s(t);return e.toString(o)}},{"./hexer":13,"crypto-js/sha256":19}],13:[function(t,e,i){e.exports={stringify:function(t){for(var e=t.words,i=t.sigBytes,s=[],o=0;o<i;o++){var n=e[o>>>2]>>>24-o%4*8&255;s.push((n>>>4).toString(16)),s.push((15&n).toString(16))}return s.join("")}}},{}],14:[function(t,e,i){var s=t("crypto-js/hmac-sha256"),o=t("./hexer");e.exports=function(t,e,i){i=i;var n=s(e,t);return"HEX"===i&&(n=n.toString(o)),n}},{"./hexer":13,"crypto-js/hmac-sha256":17}],15:[function(t,e,i){var s=t("strict-uri-encode");e.exports=function(t){return t?Object.keys(t).sort().map((function(e){var i=t[e];return void 0===i?"":null===i?e:Array.isArray(i)?i.sort().map((function(t){return s(e)+"="+s(t)})).join("&"):s(e)+"="+s(i)})).filter((function(t){return t.length>0})).join("&"):""}},{"strict-uri-encode":20}],16:[function(t,e,i){var s,o;s=this,o=function(){var t=t||function(t,e){var i=Object.create||function(){function t(){}return function(e){var i;return t.prototype=e,i=new t,t.prototype=null,i}}(),s={},o=s.lib={},n=o.Base={extend:function(t){var e=i(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},r=o.WordArray=n.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||l).stringify(this)},concat:function(t){var e=this.words,i=t.words,s=this.sigBytes,o=t.sigBytes;if(this.clamp(),s%4)for(var n=0;n<o;n++){var r=i[n>>>2]>>>24-n%4*8&255;e[s+n>>>2]|=r<<24-(s+n)%4*8}else for(n=0;n<o;n+=4)e[s+n>>>2]=i[n>>>2];return this.sigBytes+=o,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-i%4*8,e.length=t.ceil(i/4)},clone:function(){var t=n.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i,s=[],o=function(e){e=e;var i=987654321,s=4294967295;return function(){var o=((i=36969*(65535&i)+(i>>16)&s)<<16)+(e=18e3*(65535&e)+(e>>16)&s)&s;return o/=4294967296,(o+=.5)*(t.random()>.5?1:-1)}},n=0;n<e;n+=4){var a=o(4294967296*(i||t.random()));i=987654071*a(),s.push(4294967296*a()|0)}return new r.init(s,e)}}),a=s.enc={},l=a.Hex={stringify:function(t){for(var e=t.words,i=t.sigBytes,s=[],o=0;o<i;o++){var n=e[o>>>2]>>>24-o%4*8&255;s.push((n>>>4).toString(16)),s.push((15&n).toString(16))}return s.join("")},parse:function(t){for(var e=t.length,i=[],s=0;s<e;s+=2)i[s>>>3]|=parseInt(t.substr(s,2),16)<<24-s%8*4;return new r.init(i,e/2)}},c=a.Latin1={stringify:function(t){for(var e=t.words,i=t.sigBytes,s=[],o=0;o<i;o++){var n=e[o>>>2]>>>24-o%4*8&255;s.push(String.fromCharCode(n))}return s.join("")},parse:function(t){for(var e=t.length,i=[],s=0;s<e;s++)i[s>>>2]|=(255&t.charCodeAt(s))<<24-s%4*8;return new r.init(i,e)}},h=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},u=o.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=new r.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,s=i.words,o=i.sigBytes,n=this.blockSize,a=o/(4*n),l=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*n,c=t.min(4*l,o);if(l){for(var h=0;h<l;h+=n)this._doProcessBlock(s,h);var u=s.splice(0,l);i.sigBytes-=c}return new r.init(u,c)},clone:function(){var t=n.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),p=(o.Hasher=u.extend({cfg:n.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new p.HMAC.init(t,i).finalize(e)}}}),s.algo={});return s}(Math);return t},"object"==typeof i?e.exports=i=o():"function"==typeof define&&define.amd?define([],o):s.CryptoJS=o()},{}],17:[function(t,e,i){var s,o;s=this,o=function(t){return t.HmacSHA256},"object"==typeof i?e.exports=i=o(t("./core"),t("./sha256"),t("./hmac")):"function"==typeof define&&define.amd?define(["./core","./sha256","./hmac"],o):o(s.CryptoJS)},{"./core":16,"./hmac":18,"./sha256":19}],18:[function(t,e,i){var s,o;s=this,o=function(t){var e,i,s;i=(e=t).lib.Base,s=e.enc.Utf8,e.algo.HMAC=i.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=s.parse(e));var i=t.blockSize,o=4*i;e.sigBytes>o&&(e=t.finalize(e)),e.clamp();for(var n=this._oKey=e.clone(),r=this._iKey=e.clone(),a=n.words,l=r.words,c=0;c<i;c++)a[c]^=1549556828,l[c]^=909522486;n.sigBytes=r.sigBytes=o,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,i=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(i))}})},"object"==typeof i?e.exports=i=o(t("./core")):"function"==typeof define&&define.amd?define(["./core"],o):o(s.CryptoJS)},{"./core":16}],19:[function(t,e,i){var s,o;s=this,o=function(t){return function(e){var i=t,s=i.lib,o=s.WordArray,n=s.Hasher,r=i.algo,a=[],l=[];!function(){function t(t){for(var i=e.sqrt(t),s=2;s<=i;s++)if(!(t%s))return false;return true}function i(t){return 4294967296*(t-(0|t))|0}for(var s=2,o=0;o<64;)t(s)&&(o<8&&(a[o]=i(e.pow(s,.5))),l[o]=i(e.pow(s,1/3)),o++),s++}();var c=[],h=r.SHA256=n.extend({_doReset:function(){this._hash=new o.init(a.slice(0))},_doProcessBlock:function(t,e){for(var i=this._hash.words,s=i[0],o=i[1],n=i[2],r=i[3],a=i[4],h=i[5],u=i[6],p=i[7],g=0;g<64;g++){if(g<16)c[g]=0|t[e+g];else{var d=c[g-15],f=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,S=c[g-2],y=(S<<15|S>>>17)^(S<<13|S>>>19)^S>>>10;c[g]=f+c[g-7]+y+c[g-16]}var b=s&o^s&n^o&n,m=(s<<30|s>>>2)^(s<<19|s>>>13)^(s<<10|s>>>22),v=p+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&h^~a&u)+l[g]+c[g];p=u,u=h,h=a,a=r+v|0,r=n,n=o,o=s,s=v+(m+b)|0}i[0]=i[0]+s|0,i[1]=i[1]+o|0,i[2]=i[2]+n|0,i[3]=i[3]+r|0,i[4]=i[4]+a|0,i[5]=i[5]+h|0,i[6]=i[6]+u|0,i[7]=i[7]+p|0},_doFinalize:function(){var t=this._data,i=t.words,s=8*this._nDataBytes,o=8*t.sigBytes;return i[o>>>5]|=128<<24-o%32,i[14+(o+64>>>9<<4)]=e.floor(s/4294967296),i[15+(o+64>>>9<<4)]=s,t.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});i.SHA256=n._createHelper(h),i.HmacSHA256=n._createHmacHelper(h)}(Math),t.SHA256},"object"==typeof i?e.exports=i=o(t("./core")):"function"==typeof define&&define.amd?define(["./core"],o):o(s.CryptoJS)},{"./core":16}],20:[function(t,e,i){"use strict";e.exports=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,(function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()}))}},{}],"aws-sdk":[function(t,e,i){var s=t("aws-v4-sign-small"),o=t("aws-v4-sign-small/lib/hash");function n(t){return a({service:"cognitoidentity",target:"AWSCognitoIdentityService.GetCredentialsForIdentity",endpoint:"https://cognito-identity.us-east-1.amazonaws.com/",method:"POST",data:{IdentityId:t}}).then((function(t){var e=new Date(1e3*t.Credentials.Expiration);return{_identityId:t.IdentityId,accessKeyId:t.Credentials.AccessKeyId,secretAccessKey:t.Credentials.SecretKey,sessionToken:t.Credentials.SessionToken,expired:false,expireTime:e}}))}var r={VERSION:"2.17.0",config:{},CognitoIdentityCredentials:function(t){var e,i={expired:true};for(var s in localStorage)if(s.match(/^aws.cognito.identity-id/)){e=Promise.resolve(localStorage.getItem(s));break}return e||(e=a({service:"cognitoidentity",target:"AWSCognitoIdentityService.GetId",endpoint:"https://cognito-identity.us-east-1.amazonaws.com/",method:"POST",data:{IdentityPoolId:t.IdentityPoolId}}).then((function(t){return t.IdentityId}))),e.then((function(e){return i._identityId=e,i.params={IdentityId:e,IdentityPoolId:t.IdentityPoolId,RoleSessionName:"web-identity"},n(e)})).then((function(t){for(var e in t)i[e]=t[e]})).catch((function(e){t.onError&&t.onError(e)})),i}};function a(t){var e=r.config.credentials||{expired:true};if(t.authenticated&&function(t){return t.expired?t.expired:new Date>=t.expireTime}(e))return e&&(e.expired=true),e._identityId&&n(e._identityId).then((function(t){r.config.credentials=t})),Promise.reject(new Error("Credentials not set or expired"));var i,a=t.endpoint.match(/https?:\/\/([^\/]+)([^\?#]+)/),l=t.headers?JSON.parse(JSON.stringify(t.headers)):{};t.target&&(l["x-amz-target"]=t.target),l["x-amz-user-agent"]="aws-sdk-js/2.17.0 callback",t.data&&!l["content-type"]&&(l["content-type"]="application/x-amz-json-1.1"),t.data&&(i=JSON.parse(JSON.stringify(t.data))).clientContext&&(l["x-amz-client-context"]=t.data.clientContext,delete i.clientContext);var c=i?JSON.stringify(i):void 0;c&&(l["X-Amz-Content-Sha256"]=o(c));var h={host:a[1],path:a[2],method:t.method,headers:l,body:c,region:r.config.region,service:t.service};return s.sign(h,e),e.sessionToken||(delete h.headers.authorization,delete h.headers.Authorization),window.fetch(t.endpoint,{method:h.method,body:h.body,headers:h.headers}).then((function(t){var e=function(t){return 202!==t.status&&t.headers.get("content-type").match(/application\/.*json/)}(t)?t.json():t.text();return t.ok?e:e.then((function(t){return Promise.reject(t)}))}))}r.MobileAnalytics=function(t){return{putEvents:function(t,e){e||(e=function(){}),a({authenticated:true,service:"mobileanalytics",endpoint:"https://mobileanalytics.us-east-1.amazonaws.com/2014-06-05/events",method:"POST",data:t}).then(e.bind(this,null)).catch(e)}}},e.exports=r},{"aws-v4-sign-small":9,"aws-v4-sign-small/lib/hash":12}]},{},[1]);