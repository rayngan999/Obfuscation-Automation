"use strict";function cboladebug(){Cbola.Env.DEBUG=!0,localStorage.setItem("cbolaDebug","1")}function rcboladebug(){Cbola.Env.DEBUG=!1,localStorage.setItem("cbolaDebug","0")}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}if(window.Cbola=window.Cbola||{},Cbola.isObsoleteBrowser=function(){function e(){return/iphone|ipod|android|blackberry|opera|mini|windows\sce|palm|smartphone|iemobile/gi.test(r)&&-1===r.search("PC")}function t(){var e=r.match(/Chrom(e|ium)\/([0-9]+)\./);return e?parseInt(e[2],10):!1}function i(){return r.indexOf("Edge")>-1}function o(){var e=r.match("[A|a]ndroid[ |/]([0-9|.]+)"),t=0;if(null!==e)try{t=e?parseInt(e[1],10):0}catch(i){t=1}return t>=1}function n(){return"undefined"==typeof window["AudioNode"]}var r=window.navigator.userAgent,a=r.indexOf("MSIE ");if(a>0){var s=parseInt(r.substring(a+5,r.indexOf(".",a)));return 9>=s}var l=t();return!i()&&l&&50>l||e()&&o()&&n()},Cbola.isBrowserSupported=!Cbola.isObsoleteBrowser(),!Cbola.isBrowserSupported){console.log("Cbola:: deprecated browser detected");var proxyEl=document.getElementById("carambola_proxy");if(proxyEl){var proxySrcAttr=proxyEl.getAttribute("src"),proxyElParams=proxySrcAttr?proxySrcAttr.split("?"):[];if(proxyElParams.length>1){proxyElParams=proxyElParams[1];var scriptEl=window.document.createElement("script");scriptEl.src="//route.carambo.la/getHelp?"+proxyElParams,scriptEl.type="text/javascript",document.head.appendChild(scriptEl)}}}!function(e){function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function i(e){return"string"!=typeof e&&(e=String(e)),e}function o(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return g.iterable&&(t[Symbol.iterator]=function(){return t}),t}function n(e){this.map={},e instanceof n?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function r(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function a(e){return new Promise(function(t,i){e.onload=function(){t(e.result)},e.onerror=function(){i(e.error)}})}function s(e){var t=new FileReader,i=a(t);return t.readAsArrayBuffer(e),i}function l(e){var t=new FileReader,i=a(t);return t.readAsText(e),i}function d(e){for(var t=new Uint8Array(e),i=new Array(t.length),o=0;o<t.length;o++)i[o]=String.fromCharCode(t[o]);return i.join("")}function c(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(g.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(g.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(g.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(g.arrayBuffer&&g.blob&&v(e))this._bodyArrayBuffer=c(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!g.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!w(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=c(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var e=r(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?r(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var e=r(this);if(e)return e;if(this._bodyBlob)return l(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(d(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(u)}),this.json=function(){return this.text().then(JSON.parse)},this}function m(e){var t=e.toUpperCase();return _.indexOf(t)>-1?t:e}function p(e,t){t=t||{};var i=t.body;if(e instanceof p){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new n(e.headers)),this.method=e.method,this.mode=e.mode,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",(t.headers||!this.headers)&&(this.headers=new n(t.headers)),this.method=m(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function u(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var i=e.split("="),o=i.shift().replace(/\+/g," "),n=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(o),decodeURIComponent(n))}}),t}function b(e){var t=new n,i=e.replace(/\r?\n[\t ]+/g," ");return i.split(/\r?\n/).forEach(function(e){var i=e.split(":"),o=i.shift().trim();if(o){var n=i.join(":").trim();t.append(o,n)}}),t}function f(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new n(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var g={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(g.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=function(e){return e&&DataView.prototype.isPrototypeOf(e)},w=ArrayBuffer.isView||function(e){return e&&y.indexOf(Object.prototype.toString.call(e))>-1};n.prototype.append=function(e,o){e=t(e),o=i(o);var n=this.map[e];this.map[e]=n?n+","+o:o},n.prototype["delete"]=function(e){delete this.map[t(e)]},n.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},n.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},n.prototype.set=function(e,o){this.map[t(e)]=i(o)},n.prototype.forEach=function(e,t){for(var i in this.map)this.map.hasOwnProperty(i)&&e.call(t,this.map[i],i,this)},n.prototype.keys=function(){var e=[];return this.forEach(function(t,i){e.push(i)}),o(e)},n.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),o(e)},n.prototype.entries=function(){var e=[];return this.forEach(function(t,i){e.push([i,t])}),o(e)},g.iterable&&(n.prototype[Symbol.iterator]=n.prototype.entries);var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this,{body:this._bodyInit})},h.call(p.prototype),h.call(f.prototype),f.prototype.clone=function(){return new f(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new n(this.headers),url:this.url})},f.error=function(){var e=new f(null,{status:0,statusText:""});return e.type="error",e};var C=[301,302,303,307,308];f.redirect=function(e,t){if(-1===C.indexOf(t))throw new RangeError("Invalid status code");return new f(null,{status:t,headers:{location:e}})},e.Headers=n,e.Request=p,e.Response=f,e.fetch=function(e,t){return new Promise(function(i,o){var n=new p(e,t),r=new XMLHttpRequest;r.onload=function(){var e={status:r.status,statusText:r.statusText,headers:b(r.getAllResponseHeaders()||"")};e.url="responseURL"in r?r.responseURL:e.headers.get("X-Request-URL");var t="response"in r?r.response:r.responseText;i(new f(t,e))},r.onerror=function(){o(new TypeError("Network request failed"))},r.ontimeout=function(){o(new TypeError("Network request failed"))},r.open(n.method,n.url,!0),"include"===n.credentials?r.withCredentials=!0:"omit"===n.credentials&&(r.withCredentials=!1),"responseType"in r&&g.blob&&(r.responseType="blob"),n.headers.forEach(function(e,t){r.setRequestHeader(t,e)}),r.send("undefined"==typeof n._bodyInit?null:n._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this),function(e){function t(){}function i(e,t){return function(){e.apply(t,arguments)}}function o(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(e,this)}function n(e,t){for(;3===e._state;)e=e._value;return 0===e._state?void e._deferreds.push(t):(e._handled=!0,void o._immediateFn(function(){var i=1===e._state?t.onFulfilled:t.onRejected;if(null===i)return void(1===e._state?r:a)(t.promise,e._value);var o;try{o=i(e._value)}catch(n){return void a(t.promise,n)}r(t.promise,o)}))}function r(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void s(e);if("function"==typeof n)return void d(i(n,t),e)}e._state=1,e._value=t,s(e)}catch(r){a(e,r)}}function a(e,t){e._state=2,e._value=t,s(e)}function s(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var t=0,i=e._deferreds.length;i>t;t++)n(e,e._deferreds[t]);e._deferreds=null}function l(e,t,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=i}function d(e,t){var i=!1;try{e(function(e){i||(i=!0,r(t,e))},function(e){i||(i=!0,a(t,e))})}catch(o){if(i)return;i=!0,a(t,o)}}var c=setTimeout;o.prototype["catch"]=function(e){return this.then(null,e)},o.prototype.then=function(e,i){var o=new this.constructor(t);return n(this,new l(e,i,o)),o},o.all=function(e){var t=Array.prototype.slice.call(e);return new o(function(e,i){function o(r,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){o(r,e)},i)}t[r]=a,0===--n&&e(t)}catch(l){i(l)}}if(0===t.length)return e([]);for(var n=t.length,r=0;r<t.length;r++)o(r,t[r])})},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o(function(t){t(e)})},o.reject=function(e){return new o(function(t,i){i(e)})},o.race=function(e){return new o(function(t,i){for(var o=0,n=e.length;n>o;o++)e[o].then(t,i)})},o._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){c(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},o._setImmediateFn=function(e){o._immediateFn=e},o._setUnhandledRejectionFn=function(e){o._unhandledRejectionFn=e},"undefined"!=typeof module&&module.exports?module.exports=o:e.Promise||(e.Promise=o)}(this),Cbola.tmp_=window._,function(){function e(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function t(e,t,i,o){for(var n=-1,r=null==e?0:e.length;++n<r;){var a=e[n];t(o,a,i(a),e)}return o}function i(e,t){for(var i=-1,o=null==e?0:e.length;++i<o&&t(e[i],i,e)!==!1;);return e}function o(e,t){for(var i=-1,o=null==e?0:e.length,n=0,r=[];++i<o;){var a=e[i];t(a,i,e)&&(r[n++]=a)}return r}function n(e,t){return!!(null==e?0:e.length)&&p(e,t,0)>-1}function r(e,t,i){for(var o=-1,n=null==e?0:e.length;++o<n;)if(i(t,e[o]))return!0;return!1}function a(e,t){for(var i=-1,o=null==e?0:e.length,n=Array(o);++i<o;)n[i]=t(e[i],i,e);return n}function s(e,t){for(var i=-1,o=t.length,n=e.length;++i<o;)e[n+i]=t[i];return e}function l(e,t,i,o){var n=-1,r=null==e?0:e.length;for(o&&r&&(i=e[++n]);++n<r;)i=t(i,e[n],n,e);return i}function d(e,t){for(var i=-1,o=null==e?0:e.length;++i<o;)if(t(e[i],i,e))return!0;return!1}function c(e){return e.split("")}function h(e){return e.match(Xr)||[]}function m(e,t,i,o){for(var n=e.length,r=i+(o?1:-1);o?r--:++r<n;)if(t(e[r],r,e))return r;return-1}function p(e,t,i){return t===t?B(e,t,i):m(e,u,i)}function u(e){return e!==e}function b(e){return function(t){return null==t?vn:t[e]}}function f(e){return function(t){return null==e?vn:e[t]}}function g(e,t,i,o,n){return n(e,function(e,n,r){i=o?(o=!1,e):t(i,e,n,r)}),i}function y(e,t){var i=e.length;for(e.sort(t);i--;)e[i]=e[i].c;return e}function v(e,t){for(var i=-1,o=Array(e);++i<e;)o[i]=t(i);return o}function w(e){return function(t){return e(t)}}function _(e,t){return a(t,function(t){return e[t]})}function C(e,t){return e.has(t)}function I(e,t){for(var i=e.length;i--&&p(t,e[i],0)>-1;);return i}function x(e,t){for(var i=e.length,o=0;i--;)e[i]===t&&++o;return o}function E(e){return"\\"+is[e]}function S(e,t){return null==e?vn:e[t]}function T(e){return Ka.test(e)}function A(e){return Qa.test(e)}function L(e){for(var t,i=[];!(t=e.next()).done;)i.push(t.value);return i}function O(e){var t=-1,i=Array(e.size);return e.forEach(function(e,o){i[++t]=[o,e]}),i}function k(e,t){return function(i){return e(t(i))}}function P(e,t){for(var i=-1,o=e.length,n=0,r=[];++i<o;){var a=e[i];a!==t&&a!==En||(e[i]=En,r[n++]=i)}return r}function N(e){var t=-1,i=Array(e.size);return e.forEach(function(e){i[++t]=e}),i}function B(e,t,i){for(var o=i-1,n=e.length;++o<n;)if(e[o]===t)return o;return-1}function D(e){return T(e)?R(e):gs(e)}function M(e){return T(e)?V(e):c(e)}function R(e){for(var t=Ya.lastIndex=0;Ya.test(e);)++t;return t}function V(e){return e.match(Ya)||[]}function F(e){return e.match(Za)||[]}function U(e){if(To(e)&&!Fl(e)&&!(e instanceof W)){if(e instanceof j)return e;if(Es.call(e,"__wrapped__"))return Vi(e)}return new j(e)}function z(){}function j(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=vn}function W(e){
this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Kn,this.__views__=[]}function H(){var e=new W(this.__wrapped__);return e.__actions__=At(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=At(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=At(this.__views__),e}function q(){if(this.__filtered__){var e=new W(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function G(){var e=this.__wrapped__.value(),t=this.__dir__,i=Fl(e),o=0>t,n=i?e.length:0,r=di(0,n,this.__views__),a=r.start,s=r.end,l=s-a,d=o?s:a-1,c=this.__iteratees__,h=c.length,m=0,p=Zs(l,this.__takeCount__);if(!i||!o&&n==l&&p==l)return bt(e,this.__actions__);var u=[];e:for(;l--&&p>m;){d+=t;for(var b=-1,f=e[d];++b<h;){var g=c[b],y=g.iteratee,v=g.type,w=y(f);if(v==Hn)f=w;else if(!w){if(v==Wn)continue e;break e}}u[m++]=f}return u}function X(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var o=e[t];this.set(o[0],o[1])}}function Y(){this.__data__=nl?nl(null):{},this.size=0}function Z(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function K(e){var t=this.__data__;if(nl){var i=t[e];return i===In?vn:i}return Es.call(t,e)?t[e]:vn}function Q(e){var t=this.__data__;return nl?t[e]!==vn:Es.call(t,e)}function $(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=nl&&t===vn?In:t,this}function J(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var o=e[t];this.set(o[0],o[1])}}function ee(){this.__data__=[],this.size=0}function te(e){var t=this.__data__,i=Ce(t,e);return!(0>i||(i==t.length-1?t.pop():Vs.call(t,i,1),--this.size,0))}function ie(e){var t=this.__data__,i=Ce(t,e);return 0>i?vn:t[i][1]}function oe(e){return Ce(this.__data__,e)>-1}function ne(e,t){var i=this.__data__,o=Ce(i,e);return 0>o?(++this.size,i.push([e,t])):i[o][1]=t,this}function re(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var o=e[t];this.set(o[0],o[1])}}function ae(){this.size=0,this.__data__={hash:new X,map:new(el||J),string:new X}}function se(e){var t=ri(this,e).delete(e);return this.size-=t?1:0,t}function le(e){return ri(this,e).get(e)}function de(e){return ri(this,e).has(e)}function ce(e,t){var i=ri(this,e),o=i.size;return i.set(e,t),this.size+=i.size==o?0:1,this}function he(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new re;++t<i;)this.add(e[t])}function me(e){return this.__data__.set(e,In),this}function pe(e){return this.__data__.has(e)}function ue(e){this.size=(this.__data__=new J(e)).size}function be(){this.__data__=new J,this.size=0}function fe(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function ge(e){return this.__data__.get(e)}function ye(e){return this.__data__.has(e)}function ve(e,t){var i=this.__data__;if(i instanceof J){var o=i.__data__;if(!el||o.length<_n-1)return o.push([e,t]),this.size=++i.size,this;i=this.__data__=new re(o)}return i.set(e,t),this.size=i.size,this}function we(e,t){var i=Fl(e),o=!i&&Vl(e),n=!i&&!o&&Ul(e),r=!i&&!o&&!n&&Hl(e),a=i||o||n||r,s=a?v(e.length,String):[],l=s.length;for(var d in e)!t&&!Es.call(e,d)||a&&("length"==d||n&&("offset"==d||"parent"==d)||r&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||gi(d,l))||s.push(d);return s}function _e(e,t,i){var o=e[t];Es.call(e,t)&&vo(o,i)&&(i!==vn||t in e)||Se(e,t,i)}function Ce(e,t){for(var i=e.length;i--;)if(vo(e[i][0],t))return i;return-1}function Ie(e,t,i,o){return fl(e,function(e,n,r){t(o,e,i(e),r)}),o}function xe(e,t){return e&&Lt(t,Ho(t),e)}function Ee(e,t){return e&&Lt(t,qo(t),e)}function Se(e,t,i){"__proto__"==t&&js?js(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function Te(e,t){for(var i=-1,o=t.length,n=Array(o),r=null==e;++i<o;)n[i]=r?vn:zo(e,t[i]);return n}function Ae(e,t,i){return e===e&&(i!==vn&&(e=i>=e?e:i),t!==vn&&(e=e>=t?e:t)),e}function Le(e,t,o,n,r,a){var s,l=t&Sn,d=t&Tn,c=t&An;if(o&&(s=r?o(e,n,r,a):o(e)),s!==vn)return s;if(!So(e))return e;var h=Fl(e);if(h){if(s=mi(e),!l)return At(e,s)}else{var m=xl(e),p=m==rr||m==ar;if(Ul(e))return yt(e,l);if(m==cr||m==$n||p&&!r){if(s=d||p?{}:pi(e),!l)return d?kt(e,Ee(s,e)):Ot(e,xe(s,e))}else{if(!Ja[m])return r?e:{};s=ui(e,m,l)}}a||(a=new ue);var u=a.get(e);if(u)return u;if(a.set(e,s),Wl(e))return e.forEach(function(i){s.add(Le(i,t,o,i,e,a))}),s;if(zl(e))return e.forEach(function(i,n){s.set(n,Le(i,t,o,n,e,a))}),s;var b=c?d?ti:ei:d?qo:Ho,f=h?vn:b(e);return i(f||e,function(i,n){f&&(n=i,i=e[n]),_e(s,n,Le(i,t,o,n,e,a))}),s}function Oe(e,t,i,o){var s=-1,l=n,d=!0,c=e.length,h=[],m=t.length;if(!c)return h;i&&(t=a(t,w(i))),o?(l=r,d=!1):t.length>=_n&&(l=C,d=!1,t=new he(t));e:for(;++s<c;){var p=e[s],u=null==i?p:i(p);if(p=o||0!==p?p:0,d&&u===u){for(var b=m;b--;)if(t[b]===u)continue e;h.push(p)}else l(t,u,o)||h.push(p)}return h}function ke(e,t){var i=[];return fl(e,function(e,o,n){t(e,o,n)&&i.push(e)}),i}function Pe(e,t,i,o,n){var r=-1,a=e.length;for(i||(i=fi),n||(n=[]);++r<a;){var l=e[r];t>0&&i(l)?t>1?Pe(l,t-1,i,o,n):s(n,l):o||(n[n.length]=l)}return n}function Ne(e,t){return e&&gl(e,t,Ho)}function Be(e,t){return o(t,function(t){return xo(e[t])})}function De(e,t){t=ft(t,e);for(var i=0,o=t.length;null!=e&&o>i;)e=e[Di(t[i++])];return i&&i==o?e:vn}function Me(e,t,i){var o=t(e);return Fl(e)?o:s(o,i(e))}function Re(e){return null==e?e===vn?gr:dr:zs&&zs in Object(e)?li(e):Li(e)}function Ve(e,t){return null!=e&&Es.call(e,t)}function Fe(e,t){return null!=e&&t in Object(e)}function Ue(t,i,o){i=ft(i,t),t=ki(t,i);var n=null==t?t:t[Di(Hi(i))];return null==n?vn:e(n,t,o)}function ze(e){return To(e)&&Re(e)==$n}function je(e,t,i,o,n){return e===t||(null==e||null==t||!To(e)&&!To(t)?e!==e&&t!==t:We(e,t,i,o,je,n))}function We(e,t,i,o,n,r){var a=Fl(e),s=Fl(t),l=a?Jn:xl(e),d=s?Jn:xl(t);l=l==$n?cr:l,d=d==$n?cr:d;var c=l==cr,h=d==cr,m=l==d;if(m&&Ul(e)){if(!Ul(t))return!1;a=!0,c=!1}if(m&&!c)return r||(r=new ue),a||Hl(e)?Kt(e,t,i,o,n,r):Qt(e,t,l,i,o,n,r);if(!(i&Ln)){var p=c&&Es.call(e,"__wrapped__"),u=h&&Es.call(t,"__wrapped__");if(p||u){var b=p?e.value():e,f=u?t.value():t;return r||(r=new ue),n(b,f,i,o,r)}}return!!m&&(r||(r=new ue),$t(e,t,i,o,n,r))}function He(e){return To(e)&&xl(e)==sr}function qe(e,t,i,o){var n=i.length,r=n,a=!o;if(null==e)return!r;for(e=Object(e);n--;){var s=i[n];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++n<r;){s=i[n];var l=s[0],d=e[l],c=s[1];if(a&&s[2]){if(d===vn&&!(l in e))return!1}else{var h=new ue;if(o)var m=o(d,c,l,e,t,h);if(!(m===vn?je(c,d,Ln|On,o,h):m))return!1}}return!0}function Ge(e){return!(!So(e)||Ci(e))&&(xo(e)?Os:Jr).test(Mi(e))}function Xe(e){return To(e)&&Re(e)==pr}function Ye(e){return To(e)&&xl(e)==ur}function Ze(e){return To(e)&&Eo(e.length)&&!!$a[Re(e)]}function Ke(e){return"function"==typeof e?e:null==e?cn:"object"==typeof e?Fl(e)?tt(e[0],e[1]):et(e):bn(e)}function Qe(e){if(!Ii(e))return Xs(e);var t=[];for(var i in Object(e))Es.call(e,i)&&"constructor"!=i&&t.push(i);return t}function $e(e){if(!So(e))return Ai(e);var t=Ii(e),i=[];for(var o in e)("constructor"!=o||!t&&Es.call(e,o))&&i.push(o);return i}function Je(e,t){var i=-1,o=wo(e)?Array(e.length):[];return fl(e,function(e,n,r){o[++i]=t(e,n,r)}),o}function et(e){var t=ai(e);return 1==t.length&&t[0][2]?Ei(t[0][0],t[0][1]):function(i){return i===e||qe(i,e,t)}}function tt(e,t){return vi(e)&&xi(t)?Ei(Di(e),t):function(i){var o=zo(i,e);return o===vn&&o===t?Wo(i,e):je(t,o,Ln|On)}}function it(e,t,i){var o=-1;return t=a(t.length?t:[cn],w(ni())),y(Je(e,function(e,i,n){return{a:a(t,function(t){return t(e)}),b:++o,c:e}}),function(e,t){return Et(e,t,i)})}function ot(e){return function(t){return De(t,e)}}function nt(e,t){for(var i=e?t.length:0,o=i-1;i--;){var n=t[i];if(i==o||n!==r){var r=n;gi(n)?Vs.call(e,n,1):ut(e,n)}}return e}function rt(e,t){return e+Hs(Qs()*(t-e+1))}function at(e,t,i,o){for(var n=-1,r=Ys(Ws((t-e)/(i||1)),0),a=Array(r);r--;)a[o?r:++n]=e,e+=i;return a}function st(e,t){var i="";if(!e||1>t||t>Xn)return i;do t%2&&(i+=e),t=Hs(t/2),t&&(e+=e);while(t);return i}function lt(e,t){return Sl(Oi(e,t,cn),e+"")}function dt(e,t,i,o){if(!So(e))return e;t=ft(t,e);for(var n=-1,r=t.length,a=r-1,s=e;null!=s&&++n<r;){var l=Di(t[n]),d=i;if(n!=a){var c=s[l];d=o?o(c,l,s):vn,d===vn&&(d=So(c)?c:gi(t[n+1])?[]:{})}_e(s,l,d),s=s[l]}return e}function ct(e,t,i){var o=-1,n=e.length;0>t&&(t=-t>n?0:n+t),i=i>n?n:i,0>i&&(i+=n),n=t>i?0:i-t>>>0,t>>>=0;for(var r=Array(n);++o<n;)r[o]=e[o+t];return r}function ht(e,t){var i;return fl(e,function(e,o,n){return i=t(e,o,n),!i}),!!i}function mt(e){if("string"==typeof e)return e;if(Fl(e))return a(e,mt)+"";if(Bo(e))return ul?ul.call(e):"";var t=e+"";return"0"==t&&1/e==-Gn?"-0":t}function pt(e,t,i){var o=-1,a=n,s=e.length,l=!0,d=[],c=d;if(i)l=!1,a=r;else if(s>=_n){var h=t?null:wl(e);if(h)return N(h);l=!1,a=C,c=new he}else c=t?[]:d;e:for(;++o<s;){var m=e[o],p=t?t(m):m;if(m=i||0!==m?m:0,l&&p===p){for(var u=c.length;u--;)if(c[u]===p)continue e;t&&c.push(p),d.push(m)}else a(c,p,i)||(c!==d&&c.push(p),d.push(m))}return d}function ut(e,t){return t=ft(t,e),e=ki(e,t),null==e||delete e[Di(Hi(t))]}function bt(e,t){var i=e;return i instanceof W&&(i=i.value()),l(t,function(e,t){return t.func.apply(t.thisArg,s([e],t.args))},i)}function ft(e,t){return Fl(e)?e:vi(e,t)?[e]:Tl(Uo(e))}function gt(e,t,i){var o=e.length;return i=i===vn?o:i,!t&&i>=o?e:ct(e,t,i)}function yt(e,t){if(t)return e.slice();var i=e.length,o=Bs?Bs(i):new e.constructor(i);return e.copy(o),o}function vt(e){var t=new e.constructor(e.byteLength);return new Ns(t).set(new Ns(e)),t}function wt(e,t){return new e.constructor(t?vt(e.buffer):e.buffer,e.byteOffset,e.byteLength)}function _t(e){var t=new e.constructor(e.source,Kr.exec(e));return t.lastIndex=e.lastIndex,t}function Ct(e){return pl?Object(pl.call(e)):{}}function It(e,t){return new e.constructor(t?vt(e.buffer):e.buffer,e.byteOffset,e.length)}function xt(e,t){if(e!==t){var i=e!==vn,o=null===e,n=e===e,r=Bo(e),a=t!==vn,s=null===t,l=t===t,d=Bo(t);if(!s&&!d&&!r&&e>t||r&&a&&l&&!s&&!d||o&&a&&l||!i&&l||!n)return 1;if(!o&&!r&&!d&&t>e||d&&i&&n&&!o&&!r||s&&i&&n||!a&&n||!l)return-1}return 0}function Et(e,t,i){for(var o=-1,n=e.a,r=t.a,a=n.length,s=i.length;++o<a;){var l=xt(n[o],r[o]);if(l)return o>=s?l:l*("desc"==i[o]?-1:1)}return e.b-t.b}function St(e,t,i,o){for(var n=-1,r=e.length,a=i.length,s=-1,l=t.length,d=Ys(r-a,0),c=Array(l+d),h=!o;++s<l;)c[s]=t[s];for(;++n<a;)(h||r>n)&&(c[i[n]]=e[n]);for(;d--;)c[s++]=e[n++];return c}function Tt(e,t,i,o){for(var n=-1,r=e.length,a=-1,s=i.length,l=-1,d=t.length,c=Ys(r-s,0),h=Array(c+d),m=!o;++n<c;)h[n]=e[n];for(var p=n;++l<d;)h[p+l]=t[l];for(;++a<s;)(m||r>n)&&(h[p+i[a]]=e[n++]);return h}function At(e,t){var i=-1,o=e.length;for(t||(t=Array(o));++i<o;)t[i]=e[i];return t}function Lt(e,t,i,o){var n=!i;i||(i={});for(var r=-1,a=t.length;++r<a;){var s=t[r],l=o?o(i[s],e[s],s,i,e):vn;l===vn&&(l=e[s]),n?Se(i,s,l):_e(i,s,l)}return i}function Ot(e,t){return Lt(e,Cl(e),t)}function kt(e,t){return Lt(e,Il(e),t)}function Pt(e,i){return function(o,n){var r=Fl(o)?t:Ie,a=i?i():{};return r(o,e,ni(n,2),a)}}function Nt(e){return lt(function(t,i){var o=-1,n=i.length,r=n>1?i[n-1]:vn,a=n>2?i[2]:vn;for(r=e.length>3&&"function"==typeof r?(n--,r):vn,a&&yi(i[0],i[1],a)&&(r=3>n?vn:r,n=1),t=Object(t);++o<n;){var s=i[o];s&&e(t,s,o,r)}return t})}function Bt(e,t){return function(i,o){if(null==i)return i;if(!wo(i))return e(i,o);for(var n=i.length,r=t?n:-1,a=Object(i);(t?r--:++r<n)&&o(a[r],r,a)!==!1;);return i}}function Dt(e){return function(t,i,o){for(var n=-1,r=Object(t),a=o(t),s=a.length;s--;){var l=a[e?s:++n];if(i(r[l],l,r)===!1)break}return t}}function Mt(e,t,i){function o(){return(this&&this!==ss&&this instanceof o?r:e).apply(n?i:this,arguments)}var n=t&kn,r=Ft(e);return o}function Rt(e){return function(t){t=Uo(t);var i=T(t)?M(t):vn,o=i?i[0]:t.charAt(0),n=i?gt(i,1).join(""):t.slice(1);return o[e]()+n}}function Vt(e){return function(t){return l(ln(Jo(t).replace(Ga,"")),e,"")}}function Ft(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var i=bl(e.prototype),o=e.apply(i,t);return So(o)?o:i}}function Ut(t,i,o){function n(){for(var a=arguments.length,s=Array(a),l=a,d=oi(n);l--;)s[l]=arguments[l];var c=3>a&&s[0]!==d&&s[a-1]!==d?[]:P(s,d);return a-=c.length,o>a?Gt(t,i,jt,n.placeholder,vn,s,c,vn,vn,o-a):e(this&&this!==ss&&this instanceof n?r:t,this,s)}var r=Ft(t);return n}function zt(e){return function(t,i,o){var n=Object(t);if(!wo(t)){var r=ni(i,3);t=Ho(t),i=function(e){return r(n[e],e,n)}}var a=e(t,i,o);return a>-1?n[r?t[a]:a]:vn}}function jt(e,t,i,o,n,r,a,s,l,d){function c(){for(var g=arguments.length,y=Array(g),v=g;v--;)y[v]=arguments[v];if(u)var w=oi(c),_=x(y,w);if(o&&(y=St(y,o,n,u)),r&&(y=Tt(y,r,a,u)),g-=_,u&&d>g)return Gt(e,t,jt,c.placeholder,i,y,P(y,w),s,l,d-g);var C=m?i:this,I=p?C[e]:e;return g=y.length,s?y=Pi(y,s):b&&g>1&&y.reverse(),h&&g>l&&(y.length=l),this&&this!==ss&&this instanceof c&&(I=f||Ft(I)),I.apply(C,y)}var h=t&Vn,m=t&kn,p=t&Pn,u=t&(Bn|Dn),b=t&Un,f=p?vn:Ft(e);return c}function Wt(e,t){t=t===vn?" ":mt(t);var i=t.length;if(2>i)return i?st(t,e):t;var o=st(t,Ws(e/D(t)));return T(t)?gt(M(o),0,e).join(""):o.slice(0,e)}function Ht(t,i,o,n){function r(){for(var i=-1,l=arguments.length,d=-1,c=n.length,h=Array(c+l),m=this&&this!==ss&&this instanceof r?s:t;++d<c;)h[d]=n[d];for(;l--;)h[d++]=arguments[++i];return e(m,a?o:this,h)}var a=i&kn,s=Ft(t);return r}function qt(e){return function(t,i,o){return o&&"number"!=typeof o&&yi(t,i,o)&&(i=o=vn),t=Ro(t),i===vn?(i=t,t=0):i=Ro(i),o=o===vn?i>t?1:-1:Ro(o),at(t,i,o,e)}}function Gt(e,t,i,o,n,r,a,s,l,d){var c=t&Bn,h=c?a:vn,m=c?vn:a,p=c?r:vn,u=c?vn:r;t|=c?Mn:Rn,t&=~(c?Rn:Mn),t&Nn||(t&=~(kn|Pn));var b=[e,t,n,p,h,u,m,s,l,d],f=i.apply(vn,b);return _i(e)&&El(f,b),f.placeholder=o,Ni(f,e,t)}function Xt(e){var t=Math[e];return function(e,i){if(e=Fo(e),i=null==i?0:Zs(Vo(i),292)){var o=(Uo(e)+"e").split("e");return o=(Uo(t(o[0]+"e"+(+o[1]+i)))+"e").split("e"),+(o[0]+"e"+(+o[1]-i))}return t(e)}}function Yt(e,t,i,o,n,r,a,s){var l=t&Pn;if(!l&&"function"!=typeof e)throw new TypeError(Cn);var d=o?o.length:0;if(d||(t&=~(Mn|Rn),o=n=vn),a=a===vn?a:Ys(Vo(a),0),s=s===vn?s:Vo(s),d-=n?n.length:0,t&Rn){var c=o,h=n;o=n=vn}var m=l?vn:_l(e),p=[e,t,i,o,n,c,h,r,a,s];if(m&&Ti(p,m),e=p[0],t=p[1],i=p[2],o=p[3],n=p[4],s=p[9]=p[9]===vn?l?0:e.length:Ys(p[9]-d,0),!s&&t&(Bn|Dn)&&(t&=~(Bn|Dn)),t&&t!=kn)u=t==Bn||t==Dn?Ut(e,t,s):t!=Mn&&t!=(kn|Mn)||n.length?jt.apply(vn,p):Ht(e,t,i,o);else var u=Mt(e,t,i);return Ni((m?yl:El)(u,p),e,t)}function Zt(e,t,i,o){return e===vn||vo(e,Cs[i])&&!Es.call(o,i)?t:e}function Kt(e,t,i,o,n,r){var a=i&Ln,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=r.get(e);if(c&&r.get(t))return c==t;var h=-1,m=!0,p=i&On?new he:vn;for(r.set(e,t),r.set(t,e);++h<s;){var u=e[h],b=t[h];if(o)var f=a?o(b,u,h,t,e,r):o(u,b,h,e,t,r);if(f!==vn){if(f)continue;m=!1;break}if(p){if(!d(t,function(e,t){return C(p,t)||u!==e&&!n(u,e,i,o,r)?void 0:p.push(t)})){m=!1;break}}else if(u!==b&&!n(u,b,i,o,r)){m=!1;break}}return r.delete(e),r.delete(t),m}function Qt(e,t,i,o,n,r,a){switch(i){case wr:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case vr:return!(e.byteLength!=t.byteLength||!r(new Ns(e),new Ns(t)));case tr:case ir:case lr:return vo(+e,+t);case nr:return e.name==t.name&&e.message==t.message;case pr:case br:return e==t+"";case sr:var s=O;case ur:var l=o&Ln;if(s||(s=N),e.size!=t.size&&!l)return!1;var d=a.get(e);if(d)return d==t;o|=On,a.set(e,t);var c=Kt(s(e),s(t),o,n,r,a);return a.delete(e),c;case fr:if(pl)return pl.call(e)==pl.call(t)}return!1}function $t(e,t,i,o,n,r){var a=i&Ln,s=ei(e),l=s.length;if(l!=ei(t).length&&!a)return!1;for(var d=l;d--;){var c=s[d];if(!(a?c in t:Es.call(t,c)))return!1}var h=r.get(e);if(h&&r.get(t))return h==t;var m=!0;r.set(e,t),r.set(t,e);for(var p=a;++d<l;){c=s[d];var u=e[c],b=t[c];if(o)var f=a?o(b,u,c,t,e,r):o(u,b,c,e,t,r);if(!(f===vn?u===b||n(u,b,i,o,r):f)){m=!1;break}p||(p="constructor"==c)}if(m&&!p){var g=e.constructor,y=t.constructor;g!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof y&&y instanceof y)&&(m=!1)}return r.delete(e),r.delete(t),m}function Jt(e){return Sl(Oi(e,vn,zi),e+"")}function ei(e){return Me(e,Ho,Cl)}function ti(e){return Me(e,qo,Il)}function ii(e){for(var t=e.name+"",i=al[t],o=Es.call(al,t)?i.length:0;o--;){var n=i[o],r=n.func;if(null==r||r==e)return n.name}return t}function oi(e){return(Es.call(U,"placeholder")?U:e).placeholder}function ni(){var e=U.iteratee||hn;return e=e===hn?Ke:e,arguments.length?e(arguments[0],arguments[1]):e}function ri(e,t){var i=e.__data__;return wi(t)?i["string"==typeof t?"string":"hash"]:i.map}function ai(e){for(var t=Ho(e),i=t.length;i--;){var o=t[i],n=e[o];t[i]=[o,n,xi(n)]}return t}function si(e,t){var i=S(e,t);return Ge(i)?i:vn}function li(e){var t=Es.call(e,zs),i=e[zs];try{e[zs]=vn;var o=!0}catch(e){}var n=Ts.call(e);return o&&(t?e[zs]=i:delete e[zs]),n}function di(e,t,i){for(var o=-1,n=i.length;++o<n;){var r=i[o],a=r.size;switch(r.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=Zs(t,e+a);break;case"takeRight":e=Ys(e,t-a)}}return{start:e,end:t}}function ci(e){var t=e.match(qr);return t?t[1].split(Gr):[]}function hi(e,t,i){t=ft(t,e);for(var o=-1,n=t.length,r=!1;++o<n;){var a=Di(t[o]);if(!(r=null!=e&&i(e,a)))break;e=e[a]}return r||++o!=n?r:(n=null==e?0:e.length,!!n&&Eo(n)&&gi(a,n)&&(Fl(e)||Vl(e)))}function mi(e){var t=e.length,i=new e.constructor(t);return t&&"string"==typeof e[0]&&Es.call(e,"index")&&(i.index=e.index,i.input=e.input),i}function pi(e){return"function"!=typeof e.constructor||Ii(e)?{}:bl(Ds(e))}function ui(e,t,i){var o=e.constructor;switch(t){case vr:return vt(e);case tr:case ir:return new o(+e);case wr:return wt(e,i);case _r:case Cr:case Ir:case xr:case Er:case Sr:case Tr:case Ar:case Lr:return It(e,i);case sr:return new o;case lr:case br:return new o(e);case pr:return _t(e);case ur:return new o;case fr:return Ct(e)}}function bi(e,t){var i=t.length;if(!i)return e;var o=i-1;return t[o]=(i>1?"& ":"")+t[o],t=t.join(i>2?", ":" "),e.replace(Hr,"{\n/* [wrapped with "+t+"] */\n")}function fi(e){return Fl(e)||Vl(e)||!!(Fs&&e&&e[Fs])}function gi(e,t){var i=typeof e;return t=null==t?Xn:t,!!t&&("number"==i||"symbol"!=i&&ta.test(e))&&e>-1&&e%1==0&&t>e}function yi(e,t,i){if(!So(i))return!1;var o=typeof t;return!!("number"==o?wo(i)&&gi(t,i.length):"string"==o&&t in i)&&vo(i[t],e)}function vi(e,t){if(Fl(e))return!1;var i=typeof e;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!Bo(e))||Fr.test(e)||!Vr.test(e)||null!=t&&e in Object(t)}function wi(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function _i(e){var t=ii(e),i=U[t];if("function"!=typeof i||!(t in W.prototype))return!1;if(e===i)return!0;var o=_l(i);return!!o&&e===o[0]}function Ci(e){return!!Ss&&Ss in e}function Ii(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Cs)}function xi(e){return e===e&&!So(e)}function Ei(e,t){return function(i){return null!=i&&i[e]===t&&(t!==vn||e in Object(i))}}function Si(e){var t=po(e,function(e){return i.size===xn&&i.clear(),e}),i=t.cache;return t}function Ti(e,t){var i=e[1],o=t[1],n=i|o,r=(kn|Pn|Vn)>n,a=o==Vn&&i==Bn||o==Vn&&i==Fn&&e[7].length<=t[8]||o==(Vn|Fn)&&t[7].length<=t[8]&&i==Bn;if(!r&&!a)return e;o&kn&&(e[2]=t[2],n|=i&kn?0:Nn);var s=t[3];if(s){var l=e[3];e[3]=l?St(l,s,t[4]):s,e[4]=l?P(e[3],En):t[4]}return s=t[5],s&&(l=e[5],e[5]=l?Tt(l,s,t[6]):s,e[6]=l?P(e[5],En):t[6]),s=t[7],s&&(e[7]=s),o&Vn&&(e[8]=null==e[8]?t[8]:Zs(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=n,e}function Ai(e){var t=[];if(null!=e)for(var i in Object(e))t.push(i);return t}function Li(e){return Ts.call(e)}function Oi(t,i,o){return i=Ys(i===vn?t.length-1:i,0),function(){for(var n=arguments,r=-1,a=Ys(n.length-i,0),s=Array(a);++r<a;)s[r]=n[i+r];r=-1;for(var l=Array(i+1);++r<i;)l[r]=n[r];return l[i]=o(s),e(t,this,l)}}function ki(e,t){return t.length<2?e:De(e,ct(t,0,-1))}function Pi(e,t){for(var i=e.length,o=Zs(t.length,i),n=At(e);o--;){var r=t[o];e[o]=gi(r,i)?n[r]:vn}return e}function Ni(e,t,i){var o=t+"";return Sl(e,bi(o,Ri(ci(o),i)))}function Bi(e){var t=0,i=0;return function(){var o=Ks(),n=jn-(o-i);if(i=o,n>0){if(++t>=zn)return arguments[0]}else t=0;return e.apply(vn,arguments)}}function Di(e){if("string"==typeof e||Bo(e))return e;var t=e+"";return"0"==t&&1/e==-Gn?"-0":t}function Mi(e){if(null!=e){try{return xs.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ri(e,t){return i(Qn,function(i){var o="_."+i[0];t&i[1]&&!n(e,o)&&e.push(o)}),e.sort()}function Vi(e){if(e instanceof W)return e.clone();var t=new j(e.__wrapped__,e.__chain__);return t.__actions__=At(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Fi(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),i=arguments[0],o=e;o--;)t[o-1]=arguments[o];return s(Fl(i)?At(i):[i],Pe(t,1))}function Ui(e,t,i){var o=null==e?0:e.length;if(!o)return-1;var n=null==i?0:Vo(i);return 0>n&&(n=Ys(o+n,0)),m(e,ni(t,3),n)}function zi(e){return(null==e?0:e.length)?Pe(e,1):[]}function ji(e){return e&&e.length?e[0]:vn}function Wi(e,t,i){var o=null==e?0:e.length;if(!o)return-1;var n=null==i?0:Vo(i);return 0>n&&(n=Ys(o+n,0)),p(e,t,n)}function Hi(e){var t=null==e?0:e.length;return t?e[t-1]:vn}function qi(e,t){var i=[];if(!e||!e.length)return i;var o=-1,n=[],r=e.length;for(t=ni(t,3);++o<r;){var a=e[o];t(a,o,e)&&(i.push(a),n.push(o))}return nt(e,n),i}function Gi(e){return null==e?e:$s.call(e)}function Xi(e){if(!e||!e.length)return[];var t=0;return e=o(e,function(e){return _o(e)?(t=Ys(e.length,t),!0):void 0}),v(t,function(t){return a(e,b(t))})}function Yi(e){var t=U(e);return t.__chain__=!0,t}function Zi(e,t){return t(e),e}function Ki(e,t){return t(e)}function Qi(){return Yi(this)}function $i(){return new j(this.value(),this.__chain__)}function Ji(){this.__values__===vn&&(this.__values__=Mo(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?vn:this.__values__[this.__index__++]}}function eo(){return this}function to(e){for(var t,i=this;i instanceof z;){var o=Vi(i);o.__index__=0,o.__values__=vn,t?n.__wrapped__=o:t=o;var n=o;i=i.__wrapped__}return n.__wrapped__=e,t}function io(){var e=this.__wrapped__;if(e instanceof W){var t=e;return this.__actions__.length&&(t=new W(this)),t=t.reverse(),t.__actions__.push({func:Ki,args:[Gi],thisArg:vn}),new j(t,this.__chain__)}return this.thru(Gi)}function oo(){return bt(this.__wrapped__,this.__actions__)}function no(e,t){return(Fl(e)?o:ke)(e,ni(t,3))}function ro(e,t){return(Fl(e)?i:fl)(e,ni(t,3))}function ao(e,t){return(Fl(e)?a:Je)(e,ni(t,3))}function so(e,t,i){var o=Fl(e)?l:g,n=arguments.length<3;return o(e,ni(t,4),i,n,fl)}function lo(e){if(null==e)return 0;if(wo(e))return No(e)?D(e):e.length;var t=xl(e);return t==sr||t==ur?e.size:Qe(e).length}function co(e,t,i){var o=Fl(e)?d:ht;return i&&yi(e,t,i)&&(t=vn),o(e,ni(t,3))}function ho(e,t){var i;if("function"!=typeof t)throw new TypeError(Cn);return e=Vo(e),function(){return--e>0&&(i=t.apply(this,arguments)),1>=e&&(t=vn),i}}function mo(e,t,i){function o(t){var i=m,o=p;return m=p=vn,y=t,b=e.apply(o,i)}function n(e){return y=e,f=setTimeout(s,t),v?o(e):b}function r(e){var i=e-g,o=e-y,n=t-i;return w?Zs(n,u-o):n}function a(e){var i=e-g,o=e-y;return g===vn||i>=t||0>i||w&&o>=u}function s(){var e=Ml();return a(e)?l(e):(f=setTimeout(s,r(e)),vn)}function l(e){return f=vn,_&&m?o(e):(m=p=vn,b)}function d(){f!==vn&&clearTimeout(f),y=0,m=g=p=f=vn}function c(){return f===vn?b:l(Ml())}function h(){var e=Ml(),i=a(e);if(m=arguments,p=this,g=e,i){if(f===vn)return n(g);if(w)return f=setTimeout(s,t),o(g)}return f===vn&&(f=setTimeout(s,t)),b}var m,p,u,b,f,g,y=0,v=!1,w=!1,_=!0;if("function"!=typeof e)throw new TypeError(Cn);return t=Fo(t)||0,So(i)&&(v=!!i.leading,w="maxWait"in i,u=w?Ys(Fo(i.maxWait)||0,t):u,_="trailing"in i?!!i.trailing:_),h.cancel=d,h.flush=c,h}function po(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Cn);var i=function(){var o=arguments,n=t?t.apply(this,o):o[0],r=i.cache;if(r.has(n))return r.get(n);var a=e.apply(this,o);return i.cache=r.set(n,a)||r,a};return i.cache=new(po.Cache||re),i}function uo(e){if("function"!=typeof e)throw new TypeError(Cn);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function bo(e){return ho(2,e)}function fo(e,t,i){var o=!0,n=!0;if("function"!=typeof e)throw new TypeError(Cn);return So(i)&&(o="leading"in i?!!i.leading:o,n="trailing"in i?!!i.trailing:n),mo(e,t,{leading:o,maxWait:t,trailing:n})}function go(e){return Le(e,An)}function yo(e){return Le(e,Sn|An)}function vo(e,t){return e===t||e!==e&&t!==t}function wo(e){return null!=e&&Eo(e.length)&&!xo(e)}function _o(e){return To(e)&&wo(e)}function Co(e){if(null==e)return!0;if(wo(e)&&(Fl(e)||"string"==typeof e||"function"==typeof e.splice||Ul(e)||Hl(e)||Vl(e)))return!e.length;var t=xl(e);if(t==sr||t==ur)return!e.size;if(Ii(e))return!Qe(e).length;for(var i in e)if(Es.call(e,i))return!1;return!0}function Io(e){if(!To(e))return!1;var t=Re(e);return t==nr||t==or||"string"==typeof e.message&&"string"==typeof e.name&&!Po(e)}function xo(e){if(!So(e))return!1;var t=Re(e);return t==rr||t==ar||t==er||t==mr}function Eo(e){return"number"==typeof e&&e>-1&&e%1==0&&Xn>=e}function So(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function To(e){return null!=e&&"object"==typeof e}function Ao(e){return ko(e)&&e!=+e}function Lo(e){return null===e}function Oo(e){return null==e}function ko(e){return"number"==typeof e||To(e)&&Re(e)==lr}function Po(e){if(!To(e)||Re(e)!=cr)return!1;var t=Ds(e);if(null===t)return!0;var i=Es.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&xs.call(i)==As}function No(e){return"string"==typeof e||!Fl(e)&&To(e)&&Re(e)==br}function Bo(e){return"symbol"==typeof e||To(e)&&Re(e)==fr}function Do(e){return e===vn}function Mo(e){if(!e)return[];if(wo(e))return No(e)?M(e):At(e);if(Us&&e[Us])return L(e[Us]());var t=xl(e);return(t==sr?O:t==ur?N:Ko)(e)}function Ro(e){return e?(e=Fo(e),e===Gn||e===-Gn?(0>e?-1:1)*Yn:e===e?e:0):0===e?e:0}function Vo(e){var t=Ro(e),i=t%1;return t===t?i?t-i:t:0}function Fo(e){if("number"==typeof e)return e;if(Bo(e))return Zn;if(So(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=So(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(jr,"");var i=$r.test(e);return i||ea.test(e)?ns(e.slice(2),i?2:8):Qr.test(e)?Zn:+e}function Uo(e){return null==e?"":mt(e)}function zo(e,t,i){var o=null==e?vn:De(e,t);return o===vn?i:o}function jo(e,t){return null!=e&&hi(e,t,Ve)}function Wo(e,t){return null!=e&&hi(e,t,Fe)}function Ho(e){return wo(e)?we(e):Qe(e)}function qo(e){return wo(e)?we(e,!0):$e(e)}function Go(e,t,i){t=ft(t,e);var o=-1,n=t.length;for(n||(n=1,e=vn);++o<n;){var r=null==e?vn:e[Di(t[o])];r===vn&&(o=n,r=i),e=xo(r)?r.call(e):r}return e}function Xo(e,t,i){return null==e?e:dt(e,t,i)}function Yo(e,t,i,o){return o="function"==typeof o?o:vn,null==e?e:dt(e,t,i,o)}function Zo(e,t){return null==e||ut(e,t)}function Ko(e){return null==e?[]:_(e,Ho(e))}function Qo(e,t,i){if(i&&"boolean"!=typeof i&&yi(e,t,i)&&(t=i=vn),i===vn&&("boolean"==typeof t?(i=t,t=vn):"boolean"==typeof e&&(i=e,e=vn)),e===vn&&t===vn?(e=0,t=1):(e=Ro(e),t===vn?(t=e,e=0):t=Ro(t)),e>t){var o=e;e=t,t=o}if(i||e%1||t%1){var n=Qs();return Zs(e+n*(t-e+os("1e-"+((n+"").length-1))),t)}return rt(e,t)}function $o(e){return Ql(Uo(e).toLowerCase())}function Jo(e){return e=Uo(e),e&&e.replace(ia,ys).replace(Xa,"")}function en(e){return e=Uo(e),e&&Br.test(e)?e.replace(Nr,vs):e}function tn(e,t,i){e=Uo(e),t=Vo(t);var o=t?D(e):0;return t&&t>o?Wt(t-o,i)+e:e}function on(e,t,i){return i&&"number"!=typeof i&&yi(e,t,i)&&(t=i=vn),(i=i===vn?Kn:i>>>0)?(e=Uo(e),e&&("string"==typeof t||null!=t&&!jl(t))&&(t=mt(t),!t&&T(e))?gt(M(e),0,i):e.split(t,i)):[]}function nn(e,t,i){return e=Uo(e),i=null==i?0:Ae(Vo(i),0,e.length),t=mt(t),e.slice(i,i+t.length)==t}function rn(e,t,i){var o=U.templateSettings;i&&yi(e,t,i)&&(t=vn),e=Uo(e),t=Xl({},t,o,Zt);var n,r,a=Xl({},t.imports,o.imports,Zt),s=Ho(a),l=_(a,s),d=0,c=t.interpolate||oa,h="__p+='",m="sourceURL"in t?"//# sourceURL="+t.sourceURL+"\n":"";e.replace(RegExp((t.escape||oa).source+"|"+c.source+"|"+(c===Rr?Zr:oa).source+"|"+(t.evaluate||oa).source+"|$","g"),function(t,i,o,a,s,l){return o||(o=a),h+=e.slice(d,l).replace(na,E),i&&(n=!0,h+="'+__e("+i+")+'"),s&&(r=!0,h+="';"+s+";\n__p+='"),o&&(h+="'+((__t=("+o+"))==null?'':__t)+'"),d=l+t.length,t}),h+="';";var p=t.variable;p||(h="with(obj){"+h+"}"),h=(r?h.replace(Or,""):h).replace(kr,"$1").replace(Pr,"$1;"),h="function("+(p||"obj")+"){"+(p?"":"obj||(obj={});")+"var __t,__p=''"+(n?",__e=_.escape":"")+(r?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+h+"return __p}";var u=$l(function(){return Function(s,m+"return "+h).apply(vn,l)});if(u.source=h,Io(u))throw u;return u}function an(e){return Uo(e).toLowerCase()}function sn(e,t,i){if(e=Uo(e),e&&(i||t===vn))return e.replace(Wr,"");if(!e||!(t=mt(t)))return e;var o=M(e);return gt(o,0,I(o,M(t))+1).join("")}function ln(e,t,i){return e=Uo(e),t=i?vn:t,t===vn?A(e)?F(e):h(e):e.match(t)||[]}function dn(e){return function(){return e}}function cn(e){return e}function hn(e){return Ke("function"==typeof e?e:Le(e,Sn))}function mn(e,t,o){var n=Ho(t),r=Be(t,n);null!=o||So(t)&&(r.length||!n.length)||(o=t,t=e,e=this,r=Be(t,Ho(t)));var a=!(So(o)&&"chain"in o&&!o.chain),l=xo(e);return i(r,function(i){var o=t[i];e[i]=o,l&&(e.prototype[i]=function(){var t=this.__chain__;if(a||t){var i=e(this.__wrapped__);return(i.__actions__=At(this.__actions__)).push({func:o,args:arguments,thisArg:e}),i.__chain__=t,i}return o.apply(e,s([this.value()],arguments))})}),e}function pn(){return ss._===this&&(ss._=Ls),this}function un(){}function bn(e){return vi(e)?b(Di(e)):ot(e)}function fn(){return[]}function gn(){return!1}function yn(e){return Fl(e)?a(e,Di):Bo(e)?[e]:At(Tl(Uo(e)))}var vn,wn="4.17.5",_n=200,Cn="Expected a function",In="__lodash_hash_undefined__",xn=500,En="__lodash_placeholder__",Sn=1,Tn=2,An=4,Ln=1,On=2,kn=1,Pn=2,Nn=4,Bn=8,Dn=16,Mn=32,Rn=64,Vn=128,Fn=256,Un=512,zn=800,jn=16,Wn=1,Hn=2,qn=3,Gn=1/0,Xn=9007199254740991,Yn=1.7976931348623157e308,Zn=NaN,Kn=4294967295,Qn=[["ary",Vn],["bind",kn],["bindKey",Pn],["curry",Bn],["curryRight",Dn],["flip",Un],["partial",Mn],["partialRight",Rn],["rearg",Fn]],$n="[object Arguments]",Jn="[object Array]",er="[object AsyncFunction]",tr="[object Boolean]",ir="[object Date]",or="[object DOMException]",nr="[object Error]",rr="[object Function]",ar="[object GeneratorFunction]",sr="[object Map]",lr="[object Number]",dr="[object Null]",cr="[object Object]",hr="[object Promise]",mr="[object Proxy]",pr="[object RegExp]",ur="[object Set]",br="[object String]",fr="[object Symbol]",gr="[object Undefined]",yr="[object WeakMap]",vr="[object ArrayBuffer]",wr="[object DataView]",_r="[object Float32Array]",Cr="[object Float64Array]",Ir="[object Int8Array]",xr="[object Int16Array]",Er="[object Int32Array]",Sr="[object Uint8Array]",Tr="[object Uint8ClampedArray]",Ar="[object Uint16Array]",Lr="[object Uint32Array]",Or=/\b__p\+='';/g,kr=/\b(__p\+=)''\+/g,Pr=/(__e\(.*?\)|\b__t\))\+'';/g,Nr=/[&<>"']/g,Br=RegExp(Nr.source),Dr=/<%-([\s\S]+?)%>/g,Mr=/<%([\s\S]+?)%>/g,Rr=/<%=([\s\S]+?)%>/g,Vr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fr=/^\w*$/,Ur=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,zr=/[\\^$.*+?()[\]{}|]/g,jr=/^\s+|\s+$/g,Wr=/\s+$/,Hr=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,qr=/\{\n\/\* \[wrapped with (.+)\] \*/,Gr=/,? & /,Xr=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Yr=/\\(\\)?/g,Zr=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Kr=/\w*$/,Qr=/^[-+]0x[0-9a-f]+$/i,$r=/^0b[01]+$/i,Jr=/^\[object .+?Constructor\]$/,ea=/^0o[0-7]+$/i,ta=/^(?:0|[1-9]\d*)$/,ia=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,oa=/($^)/,na=/['\n\r\u2028\u2029\\]/g,ra="\\ud800-\\udfff",aa="\\u0300-\\u036f",sa="\\ufe20-\\ufe2f",la="\\u20d0-\\u20ff",da=aa+sa+la,ca="\\u2700-\\u27bf",ha="a-z\\xdf-\\xf6\\xf8-\\xff",ma="\\xac\\xb1\\xd7\\xf7",pa="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ua="\\u2000-\\u206f",ba=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",fa="A-Z\\xc0-\\xd6\\xd8-\\xde",ga="\\ufe0e\\ufe0f",ya=ma+pa+ua+ba,va="[']",wa="["+ra+"]",_a="["+ya+"]",Ca="["+da+"]",Ia="\\d+",xa="["+ca+"]",Ea="["+ha+"]",Sa="[^"+ra+ya+Ia+ca+ha+fa+"]",Ta="\\ud83c[\\udffb-\\udfff]",Aa="(?:"+Ca+"|"+Ta+")",La="[^"+ra+"]",Oa="(?:\\ud83c[\\udde6-\\uddff]){2}",ka="[\\ud800-\\udbff][\\udc00-\\udfff]",Pa="["+fa+"]",Na="\\u200d",Ba="(?:"+Ea+"|"+Sa+")",Da="(?:"+Pa+"|"+Sa+")",Ma="(?:"+va+"(?:d|ll|m|re|s|t|ve))?",Ra="(?:"+va+"(?:D|LL|M|RE|S|T|VE))?",Va=Aa+"?",Fa="["+ga+"]?",Ua="(?:"+Na+"(?:"+[La,Oa,ka].join("|")+")"+Fa+Va+")*",za="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ja="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Wa=Fa+Va+Ua,Ha="(?:"+[xa,Oa,ka].join("|")+")"+Wa,qa="(?:"+[La+Ca+"?",Ca,Oa,ka,wa].join("|")+")",Ga=RegExp(va,"g"),Xa=RegExp(Ca,"g"),Ya=RegExp(Ta+"(?="+Ta+")|"+qa+Wa,"g"),Za=RegExp([Pa+"?"+Ea+"+"+Ma+"(?="+[_a,Pa,"$"].join("|")+")",Da+"+"+Ra+"(?="+[_a,Pa+Ba,"$"].join("|")+")",Pa+"?"+Ba+"+"+Ma,Pa+"+"+Ra,ja,za,Ia,Ha].join("|"),"g"),Ka=RegExp("["+Na+ra+da+ga+"]"),Qa=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,$a={};
$a[_r]=$a[Cr]=$a[Ir]=$a[xr]=$a[Er]=$a[Sr]=$a[Tr]=$a[Ar]=$a[Lr]=!0,$a[$n]=$a[Jn]=$a[vr]=$a[tr]=$a[wr]=$a[ir]=$a[nr]=$a[rr]=$a[sr]=$a[lr]=$a[cr]=$a[pr]=$a[ur]=$a[br]=$a[yr]=!1;var Ja={};Ja[$n]=Ja[Jn]=Ja[vr]=Ja[wr]=Ja[tr]=Ja[ir]=Ja[_r]=Ja[Cr]=Ja[Ir]=Ja[xr]=Ja[Er]=Ja[sr]=Ja[lr]=Ja[cr]=Ja[pr]=Ja[ur]=Ja[br]=Ja[fr]=Ja[Sr]=Ja[Tr]=Ja[Ar]=Ja[Lr]=!0,Ja[nr]=Ja[rr]=Ja[yr]=!1;var es={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"},ts={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},is={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},os=parseFloat,ns=parseInt,rs="object"==typeof global&&global&&global.Object===Object&&global,as="object"==typeof self&&self&&self.Object===Object&&self,ss=rs||as||Function("return this")(),ls="object"==typeof exports&&exports&&!exports.nodeType&&exports,ds=ls&&"object"==typeof module&&module&&!module.nodeType&&module,cs=ds&&ds.exports===ls,hs=cs&&rs.process,ms=function(){try{return hs&&hs.binding&&hs.binding("util")}catch(e){}}(),ps=ms&&ms.isMap,us=ms&&ms.isRegExp,bs=ms&&ms.isSet,fs=ms&&ms.isTypedArray,gs=b("length"),ys=f(es),vs=f(ts),ws=Array.prototype,_s=Function.prototype,Cs=Object.prototype,Is=ss["__core-js_shared__"],xs=_s.toString,Es=Cs.hasOwnProperty,Ss=function(){var e=/[^.]+$/.exec(Is&&Is.keys&&Is.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ts=Cs.toString,As=xs.call(Object),Ls=ss._,Os=RegExp("^"+xs.call(Es).replace(zr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ks=cs?ss.Buffer:vn,Ps=ss.Symbol,Ns=ss.Uint8Array,Bs=ks?ks.allocUnsafe:vn,Ds=k(Object.getPrototypeOf,Object),Ms=Object.create,Rs=Cs.propertyIsEnumerable,Vs=ws.splice,Fs=Ps?Ps.isConcatSpreadable:vn,Us=Ps?Ps.iterator:vn,zs=Ps?Ps.toStringTag:vn,js=function(){try{var e=si(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Ws=Math.ceil,Hs=Math.floor,qs=Object.getOwnPropertySymbols,Gs=ks?ks.isBuffer:vn,Xs=k(Object.keys,Object),Ys=Math.max,Zs=Math.min,Ks=Date.now,Qs=Math.random,$s=ws.reverse,Js=si(ss,"DataView"),el=si(ss,"Map"),tl=si(ss,"Promise"),il=si(ss,"Set"),ol=si(ss,"WeakMap"),nl=si(Object,"create"),rl=ol&&new ol,al={},sl=Mi(Js),ll=Mi(el),dl=Mi(tl),cl=Mi(il),hl=Mi(ol),ml=Ps?Ps.prototype:vn,pl=ml?ml.valueOf:vn,ul=ml?ml.toString:vn,bl=function(){function e(){}return function(t){if(!So(t))return{};if(Ms)return Ms(t);e.prototype=t;var i=new e;return e.prototype=vn,i}}();U.templateSettings={escape:Dr,evaluate:Mr,interpolate:Rr,variable:"",imports:{_:U}},U.prototype=z.prototype,U.prototype.constructor=U,j.prototype=bl(z.prototype),j.prototype.constructor=j,W.prototype=bl(z.prototype),W.prototype.constructor=W,X.prototype.clear=Y,X.prototype.delete=Z,X.prototype.get=K,X.prototype.has=Q,X.prototype.set=$,J.prototype.clear=ee,J.prototype.delete=te,J.prototype.get=ie,J.prototype.has=oe,J.prototype.set=ne,re.prototype.clear=ae,re.prototype.delete=se,re.prototype.get=le,re.prototype.has=de,re.prototype.set=ce,he.prototype.add=he.prototype.push=me,he.prototype.has=pe,ue.prototype.clear=be,ue.prototype.delete=fe,ue.prototype.get=ge,ue.prototype.has=ye,ue.prototype.set=ve;var fl=Bt(Ne),gl=Dt(),yl=rl?function(e,t){return rl.set(e,t),e}:cn,vl=js?function(e,t){return js(e,"toString",{configurable:!0,enumerable:!1,value:dn(t),writable:!0})}:cn,wl=il&&1/N(new il([,-0]))[1]==Gn?function(e){return new il(e)}:un,_l=rl?function(e){return rl.get(e)}:un,Cl=qs?function(e){return null==e?[]:(e=Object(e),o(qs(e),function(t){return Rs.call(e,t)}))}:fn,Il=qs?function(e){for(var t=[];e;)s(t,Cl(e)),e=Ds(e);return t}:fn,xl=Re;(Js&&xl(new Js(new ArrayBuffer(1)))!=wr||el&&xl(new el)!=sr||tl&&xl(tl.resolve())!=hr||il&&xl(new il)!=ur||ol&&xl(new ol)!=yr)&&(xl=function(e){var t=Re(e),i=t==cr?e.constructor:vn,o=i?Mi(i):"";if(o)switch(o){case sl:return wr;case ll:return sr;case dl:return hr;case cl:return ur;case hl:return yr}return t});var El=Bi(yl),Sl=Bi(vl),Tl=Si(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Ur,function(e,i,o,n){t.push(o?n.replace(Yr,"$1"):i||e)}),t}),Al=lt(function(e,t){return _o(e)?Oe(e,Pe(t,1,_o,!0)):[]}),Ll=lt(function(e,t){var i=Hi(t);return _o(i)&&(i=vn),_o(e)?Oe(e,Pe(t,1,_o,!0),ni(i,2)):[]}),Ol=lt(function(e){return pt(Pe(e,1,_o,!0))}),kl=lt(function(e){var t=Hi(e);return _o(t)&&(t=vn),pt(Pe(e,1,_o,!0),ni(t,2))}),Pl=lt(Xi),Nl=(Jt(function(e){var t=e.length,i=t?e[0]:0,o=this.__wrapped__,n=function(t){return Te(t,e)};return!(t>1||this.__actions__.length)&&o instanceof W&&gi(i)?(o=o.slice(i,+i+(t?1:0)),o.__actions__.push({func:Ki,args:[n],thisArg:vn}),new j(o,this.__chain__).thru(function(e){return t&&!e.length&&e.push(vn),e})):this.thru(n)}),zt(Ui)),Bl=Pt(function(e,t,i){Es.call(e,i)?e[i].push(t):Se(e,i,[t])}),Dl=lt(function(e,t){if(null==e)return[];var i=t.length;return i>1&&yi(e,t[0],t[1])?t=[]:i>2&&yi(t[0],t[1],t[2])&&(t=[t[0]]),it(e,Pe(t,1),[])}),Ml=function(){return ss.Date.now()};po.Cache=re;var Rl=lt(function(e,t){return Yt(e,Mn,vn,t,P(t,oi(Rl)))}),Vl=ze(function(){return arguments}())?ze:function(e){return To(e)&&Es.call(e,"callee")&&!Rs.call(e,"callee")},Fl=Array.isArray,Ul=Gs||gn,zl=ps?w(ps):He,jl=us?w(us):Xe,Wl=bs?w(bs):Ye,Hl=fs?w(fs):Ze,ql=Nt(function(e,t){if(Ii(t)||wo(t))return Lt(t,Ho(t),e),vn;for(var i in t)Es.call(t,i)&&_e(e,i,t[i])}),Gl=Nt(function(e,t){Lt(t,qo(t),e)}),Xl=Nt(function(e,t,i,o){Lt(t,qo(t),e,o)}),Yl=lt(function(e,t){e=Object(e);var i=-1,o=t.length,n=o>2?t[2]:vn;for(n&&yi(t[0],t[1],n)&&(o=1);++i<o;)for(var r=t[i],a=qo(r),s=-1,l=a.length;++s<l;){var d=a[s],c=e[d];(c===vn||vo(c,Cs[d])&&!Es.call(e,d))&&(e[d]=r[d])}return e}),Zl=Vt(function(e,t,i){return t=t.toLowerCase(),e+(i?$o(t):t)}),Kl=Vt(function(e,t,i){return e+(i?"-":"")+t.toLowerCase()}),Ql=Rt("toUpperCase"),$l=lt(function(e,t){try{return i(e,vn,t)}catch(i){return Io(i)?i:Error(i)}}),Jl=qt(),ed=Xt("floor"),td=Xt("round");U.assign=ql,U.assignIn=Gl,U.assignInWith=Xl,U.before=ho,U.chain=Yi,U.concat=Fi,U.constant=dn,U.debounce=mo,U.defaults=Yl,U.difference=Al,U.differenceBy=Ll,U.filter=no,U.flatten=zi,U.groupBy=Bl,U.iteratee=hn,U.keys=Ho,U.keysIn=qo,U.map=ao,U.memoize=po,U.mixin=mn,U.negate=uo,U.once=bo,U.partial=Rl,U.property=bn,U.range=Jl,U.remove=qi,U.reverse=Gi,U.set=Xo,U.setWith=Yo,U.sortBy=Dl,U.split=on,U.tap=Zi,U.throttle=fo,U.thru=Ki,U.toArray=Mo,U.toPath=yn,U.union=Ol,U.unionBy=kl,U.unset=Zo,U.unzip=Xi,U.values=Ko,U.words=ln,U.zip=Pl,U.extend=Gl,U.extendWith=Xl,mn(U,U),U.attempt=$l,U.camelCase=Zl,U.capitalize=$o,U.clone=go,U.cloneDeep=yo,U.deburr=Jo,U.eq=vo,U.escape=en,U.find=Nl,U.findIndex=Ui,U.floor=ed,U.forEach=ro,U.get=zo,U.has=jo,U.hasIn=Wo,U.head=ji,U.identity=cn,U.indexOf=Wi,U.isArguments=Vl,U.isArray=Fl,U.isArrayLike=wo,U.isArrayLikeObject=_o,U.isBuffer=Ul,U.isEmpty=Co,U.isError=Io,U.isFunction=xo,U.isLength=Eo,U.isMap=zl,U.isNaN=Ao,U.isNil=Oo,U.isNull=Lo,U.isNumber=ko,U.isObject=So,U.isObjectLike=To,U.isPlainObject=Po,U.isRegExp=jl,U.isSet=Wl,U.isString=No,U.isSymbol=Bo,U.isTypedArray=Hl,U.isUndefined=Do,U.kebabCase=Kl,U.last=Hi,U.stubArray=fn,U.stubFalse=gn,U.noConflict=pn,U.noop=un,U.now=Ml,U.padStart=tn,U.random=Qo,U.reduce=so,U.result=Go,U.round=td,U.size=lo,U.some=co,U.startsWith=nn,U.template=rn,U.toFinite=Ro,U.toInteger=Vo,U.toLower=an,U.toNumber=Fo,U.toString=Uo,U.trimEnd=sn,U.upperFirst=Ql,U.each=ro,U.first=ji,mn(U,function(){var e={};return Ne(U,function(t,i){Es.call(U.prototype,i)||(e[i]=t)}),e}(),{chain:!1}),U.VERSION=wn,Rl.placeholder=U,i(["drop","take"],function(e,t){W.prototype[e]=function(i){i=i===vn?1:Ys(Vo(i),0);var o=this.__filtered__&&!t?new W(this):this.clone();return o.__filtered__?o.__takeCount__=Zs(i,o.__takeCount__):o.__views__.push({size:Zs(i,Kn),type:e+(o.__dir__<0?"Right":"")}),o},W.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),i(["filter","map","takeWhile"],function(e,t){var i=t+1,o=i==Wn||i==qn;W.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:ni(e,3),type:i}),t.__filtered__=t.__filtered__||o,t}}),i(["head","last"],function(e,t){var i="take"+(t?"Right":"");W.prototype[e]=function(){return this[i](1).value()[0]}}),i(["initial","tail"],function(e,t){var i="drop"+(t?"":"Right");W.prototype[e]=function(){return this.__filtered__?new W(this):this[i](1)}}),W.prototype.compact=function(){return this.filter(cn)},W.prototype.find=function(e){return this.filter(e).head()},W.prototype.findLast=function(e){return this.reverse().find(e)},W.prototype.invokeMap=lt(function(e,t){return"function"==typeof e?new W(this):this.map(function(i){return Ue(i,e,t)})}),W.prototype.reject=function(e){return this.filter(uo(ni(e)))},W.prototype.slice=function(e,t){e=Vo(e);var i=this;return i.__filtered__&&(e>0||0>t)?new W(i):(0>e?i=i.takeRight(-e):e&&(i=i.drop(e)),t!==vn&&(t=Vo(t),i=0>t?i.dropRight(-t):i.take(t-e)),i)},W.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},W.prototype.toArray=function(){return this.take(Kn)},Ne(W.prototype,function(e,t){var i=/^(?:filter|find|map|reject)|While$/.test(t),o=/^(?:head|last)$/.test(t),n=U[o?"take"+("last"==t?"Right":""):t],r=o||/^find/.test(t);n&&(U.prototype[t]=function(){var t=this.__wrapped__,a=o?[1]:arguments,l=t instanceof W,d=a[0],c=l||Fl(t),h=function(e){var t=n.apply(U,s([e],a));return o&&m?t[0]:t};c&&i&&"function"==typeof d&&1!=d.length&&(l=c=!1);var m=this.__chain__,p=!!this.__actions__.length,u=r&&!m,b=l&&!p;if(!r&&c){t=b?t:new W(this);var f=e.apply(t,a);return f.__actions__.push({func:Ki,args:[h],thisArg:vn}),new j(f,m)}return u&&b?e.apply(this,a):(f=this.thru(h),u?o?f.value()[0]:f.value():f)})}),i(["pop","push","shift","sort","splice","unshift"],function(e){var t=ws[e],i=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",o=/^(?:pop|shift)$/.test(e);U.prototype[e]=function(){var e=arguments;if(o&&!this.__chain__){var n=this.value();return t.apply(Fl(n)?n:[],e)}return this[i](function(i){return t.apply(Fl(i)?i:[],e)})}}),Ne(W.prototype,function(e,t){var i=U[t];if(i){var o=i.name+"";(al[o]||(al[o]=[])).push({name:t,func:i})}}),al[jt(vn,Pn).name]=[{name:"wrapper",func:vn}],W.prototype.clone=H,W.prototype.reverse=q,W.prototype.value=G,U.prototype.chain=Qi,U.prototype.commit=$i,U.prototype.next=Ji,U.prototype.plant=to,U.prototype.reverse=io,U.prototype.toJSON=U.prototype.valueOf=U.prototype.value=oo,U.prototype.first=U.prototype.head,Us&&(U.prototype[Us]=eo),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(ss._=U,define(function(){return U})):ds?((ds.exports=U)._=U,ls._=U):ss._=U}.call(this),window.Cbola._=_.noConflict(),Cbola.tmp_&&(window._=Cbola.tmp_),Cbola.tmp_=null;var CryptoJSCbola=CryptoJSCbola||function(e,t){var i={},o=i.lib={},n=o.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var i=new e;return t&&i.mixIn(t),i.$super=this,i},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.$super.extend(this)}}}(),r=o.WordArray=n.extend({init:function(e,i){e=this.words=e||[],this.sigBytes=i!=t?i:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,i=e.words,o=this.sigBytes,e=e.sigBytes;if(this.clamp(),o%4)for(var n=0;e>n;n++)t[o+n>>>2]|=(i[n>>>2]>>>24-8*(n%4)&255)<<24-8*((o+n)%4);else if(65535<i.length)for(n=0;e>n;n+=4)t[o+n>>>2]=i[n>>>2];else t.push.apply(t,i);return this.sigBytes+=e,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-8*(i%4),t.length=e.ceil(i/4)},clone:function(){var e=n.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var i=[],o=0;t>o;o+=4)i.push(4294967296*e.random()|0);return r.create(i,t)}}),a=i.enc={},s=a.Hex={stringify:function(e){for(var t=e.words,e=e.sigBytes,i=[],o=0;e>o;o++){var n=t[o>>>2]>>>24-8*(o%4)&255;i.push((n>>>4).toString(16)),i.push((15&n).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,i=[],o=0;t>o;o+=2)i[o>>>3]|=parseInt(e.substr(o,2),16)<<24-4*(o%8);return r.create(i,t/2)}},l=a.Latin1={stringify:function(e){for(var t=e.words,e=e.sigBytes,i=[],o=0;e>o;o++)i.push(String.fromCharCode(t[o>>>2]>>>24-8*(o%4)&255));return i.join("")},parse:function(e){for(var t=e.length,i=[],o=0;t>o;o++)i[o>>>2]|=(255&e.charCodeAt(o))<<24-8*(o%4);return r.create(i,t)}},d=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},c=o.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=r.create(),this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var i=this._data,o=i.words,n=i.sigBytes,a=this.blockSize,s=n/(4*a),s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0),t=s*a,n=e.min(4*t,n);if(t){for(var l=0;t>l;l+=a)this._doProcessBlock(o,l);l=o.splice(0,t),i.sigBytes-=n}return r.create(l,n)},clone:function(){var e=n.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});o.Hasher=c.extend({init:function(){this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize(),this._hash},clone:function(){var e=c.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:16,_createHelper:function(e){return function(t,i){return e.create(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return h.HMAC.create(e,i).finalize(t)}}});var h=i.algo={};return i}(Math);!function(e){function t(e,t,i,o,n,r,a){return e=e+(t&i|~t&o)+n+a,(e<<r|e>>>32-r)+t}function i(e,t,i,o,n,r,a){return e=e+(t&o|i&~o)+n+a,(e<<r|e>>>32-r)+t}function o(e,t,i,o,n,r,a){return e=e+(t^i^o)+n+a,(e<<r|e>>>32-r)+t}function n(e,t,i,o,n,r,a){return e=e+(i^(t|~o))+n+a,(e<<r|e>>>32-r)+t}var r=CryptoJSCbola,a=r.lib,s=a.WordArray,a=a.Hasher,l=r.algo,d=[];!function(){for(var t=0;64>t;t++)d[t]=4294967296*e.abs(e.sin(t+1))|0}(),l=l.MD5=a.extend({_doReset:function(){this._hash=s.create([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,r){for(var a=0;16>a;a++){var s=r+a,l=e[s];e[s]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}for(var s=this._hash.words,l=s[0],c=s[1],h=s[2],m=s[3],a=0;64>a;a+=4)16>a?(l=t(l,c,h,m,e[r+a],7,d[a]),m=t(m,l,c,h,e[r+a+1],12,d[a+1]),h=t(h,m,l,c,e[r+a+2],17,d[a+2]),c=t(c,h,m,l,e[r+a+3],22,d[a+3])):32>a?(l=i(l,c,h,m,e[r+(a+1)%16],5,d[a]),m=i(m,l,c,h,e[r+(a+6)%16],9,d[a+1]),h=i(h,m,l,c,e[r+(a+11)%16],14,d[a+2]),c=i(c,h,m,l,e[r+a%16],20,d[a+3])):48>a?(l=o(l,c,h,m,e[r+(3*a+5)%16],4,d[a]),m=o(m,l,c,h,e[r+(3*a+8)%16],11,d[a+1]),h=o(h,m,l,c,e[r+(3*a+11)%16],16,d[a+2]),c=o(c,h,m,l,e[r+(3*a+14)%16],23,d[a+3])):(l=n(l,c,h,m,e[r+3*a%16],6,d[a]),m=n(m,l,c,h,e[r+(3*a+7)%16],10,d[a+1]),h=n(h,m,l,c,e[r+(3*a+14)%16],15,d[a+2]),c=n(c,h,m,l,e[r+(3*a+5)%16],21,d[a+3]));s[0]=s[0]+l|0,s[1]=s[1]+c|0,s[2]=s[2]+h|0,s[3]=s[3]+m|0},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,o=8*e.sigBytes;for(t[o>>>5]|=128<<24-o%32,t[(o+64>>>9<<4)+14]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(t.length+1),this._process(),e=this._hash.words,t=0;4>t;t++)i=e[t],e[t]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}}),r.MD5=a._createHelper(l),r.HmacMD5=a._createHmacHelper(l)}(Math);var CryptoJSCbola=CryptoJSCbola||function(e,t){var i={},o=i.lib={},n=o.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var i=new e;return t&&i.mixIn(t),i.$super=this,i},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.$super.extend(this)}}}(),r=o.WordArray=n.extend({init:function(e,i){e=this.words=e||[],this.sigBytes=i!=t?i:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,i=e.words,o=this.sigBytes,e=e.sigBytes;if(this.clamp(),o%4)for(var n=0;e>n;n++)t[o+n>>>2]|=(i[n>>>2]>>>24-8*(n%4)&255)<<24-8*((o+n)%4);else if(65535<i.length)for(n=0;e>n;n+=4)t[o+n>>>2]=i[n>>>2];else t.push.apply(t,i);return this.sigBytes+=e,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-8*(i%4),t.length=e.ceil(i/4)},clone:function(){var e=n.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var i=[],o=0;t>o;o+=4)i.push(4294967296*e.random()|0);return r.create(i,t)}}),a=i.enc={},s=a.Hex={stringify:function(e){for(var t=e.words,e=e.sigBytes,i=[],o=0;e>o;o++){var n=t[o>>>2]>>>24-8*(o%4)&255;i.push((n>>>4).toString(16)),i.push((15&n).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,i=[],o=0;t>o;o+=2)i[o>>>3]|=parseInt(e.substr(o,2),16)<<24-4*(o%8);return r.create(i,t/2)}},l=a.Latin1={stringify:function(e){for(var t=e.words,e=e.sigBytes,i=[],o=0;e>o;o++)i.push(String.fromCharCode(t[o>>>2]>>>24-8*(o%4)&255));return i.join("")},parse:function(e){for(var t=e.length,i=[],o=0;t>o;o++)i[o>>>2]|=(255&e.charCodeAt(o))<<24-8*(o%4);return r.create(i,t)}},d=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},c=o.BufferedBlockAlgorithm=n.extend({reset:function(){this._data=r.create(),this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var i=this._data,o=i.words,n=i.sigBytes,a=this.blockSize,s=n/(4*a),s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0),t=s*a,n=e.min(4*t,n);if(t){for(var l=0;t>l;l+=a)this._doProcessBlock(o,l);l=o.splice(0,t),i.sigBytes-=n}return r.create(l,n)},clone:function(){var e=n.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});o.Hasher=c.extend({init:function(){this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize(),this._hash},clone:function(){var e=c.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:16,_createHelper:function(e){return function(t,i){return e.create(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return h.HMAC.create(e,i).finalize(t)}}});var h=i.algo={};return i}(Math);if(function(){var e=CryptoJSCbola,t=e.lib,i=t.WordArray,t=t.Hasher,o=[],n=e.algo.SHA1=t.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],r=i[1],a=i[2],s=i[3],l=i[4],d=0;80>d;d++){if(16>d)o[d]=0|e[t+d];else{var c=o[d-3]^o[d-8]^o[d-14]^o[d-16];o[d]=c<<1|c>>>31}c=(n<<5|n>>>27)+l+o[d],c=20>d?c+((r&a|~r&s)+1518500249):40>d?c+((r^a^s)+1859775393):60>d?c+((r&a|r&s|a&s)-1894007588):c+((r^a^s)-899497514),l=s,s=a,a=r<<30|r>>>2,r=n,n=c}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+a|0,i[3]=i[3]+s|0,i[4]=i[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,o=8*e.sigBytes;t[o>>>5]|=128<<24-o%32,t[(o+64>>>9<<4)+15]=i,e.sigBytes=4*t.length,this._process()}});e.SHA1=t._createHelper(n),e.HmacSHA1=t._createHmacHelper(n)}(),function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}return"function"==typeof window.CustomEvent?!1:(e.prototype=window.Event.prototype,void(window.CustomEvent=e))}(),function(e){e.forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){null!==this.parentNode&&this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),"undefined"==typeof document.hidden)for(var vendors=["ms","moz","webkit","o"],x=0;x<vendors.length&&"undefined"==typeof document.hidden;++x)document.hidden=window[vendors[x]+"Hidden"];!function(){for(var e=0,t=["ms","moz","webkit","o"],i=0;i<t.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[t[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[i]+"CancelAnimationFrame"]||window[t[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,i){var o=(new Date).getTime(),n=Math.max(0,16-(o-e)),r=window.setTimeout(function(){t(o+n)},n);return e=o+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||0>t?0:+t,e.length)===e}),Cbola.EventBus=Cbola.EventBus||function(){var e=window.document.createElement("span");return e.fire=function(e,t){var i=new CustomEvent(e,{detail:t});Cbola.EventBus.dispatchEvent(i)},e.Events={ELEMENT_FAILED:"ElementFailed",FOCUS_CHANGE:"FocusedChange",GET_ADS_READY:"GetAdsReady",LAYER_READY:"LayerReadyEvent",PAGE_ELEMENTS_DATA_RECEIVED:"PageElementsDataReceived",PAGE_VISIBILITY_CHANGE:"PageVisibilityChange",PLATFORM_INITIALIZED:"PlatformInitialized",USER_ID_SET:"UserIDSet",ADS_STORES_MANGER_ADDED_SIZES:"AdsStoresManagerAddedSizes_",ADS_STORES_MANAGER_READY:"AdsStoresManagerReady_",COVERING_TRIGGER_ON:"coveringTriggerOn_",COVERING_TRIGGER_OFF:"coveringTriggerOff_",LAYER_ATTACHED:"LayerAttached_",LAYER_IS_VIEWABLE:"LayerBecameViewable_",OBSERVER_VIEWABLE:"ObserverViewable_",OBSERVER_NON_VIEWABLE:"ObserverNonViewable_",PAGE_LOAD_FALLBACK:"PageLoadFallback_",RESIZE_ON_AD:"ResizeOnAd_",SKIP_SPOT:"SkipSpot_",STORY_CLICKED:"StoryClicked_",STORY_TIMER_ENDED:"StoryTimerEnded_",TIMER_ENDED:"TimerEnded_",TRIVIA_BEFORE_END:"triviaBeforeEnd_",TRIGGER_IS_VIEWABLE:"TriggerBecameViewable_"},e}(),Cbola.Enums=Cbola.Enums||{ProductTypes:{IN_IMAGE:1,IN_CONTENT:2,IN_IMAGE_PENDING:101},ServerCallTypes:{CDN:0,SERVER:1},IntegrationTypes:{ERROR:0,NORMAL:1,DFP:2,SAFE_FRAME:3,IFRAME:4},SetClickTypes:{ITEM_LINK:1,CARAMBOLA_ICON:10,SHARE_BEFORE_FACEBOOK:11,SHARE_BEFORE_TWITTER:12,SHARE_AFTER_FACEBOOK:13,SHARE_AFTER_TWITTER:14,AD_BUTTON_CLOSE:15,SHARE_BEFORE_WHATSAPP:16,SHARE_LANDSCAPE_WHATSAPP:18,SHARE_LANDSCAPE_FACEBOOK:19,SHARE_LANDSCAPE_TWITTER:20,ENDING_SCREEN_OUT:21,FOOTER_AD_BUTTON_CLOSE:22,SPONSORED_LINK_CLICK_ENDING_SCREEN:24,SPONSORED_LINK_CLICK_ENDING_SCREEN_AUTOPLAY:25,SPONSORED_LINK_CLICK_IN_ITEM:26,SPONSORED_LINK_CLICK_IN_ITEM_AUTOPLAY:27,TWITTER_REPLY:28,TWITTER_STAR:29,TWITTER_RETWEET:30,TWITTER_FOLLOW:31,TWITTER_TWEET_IMAGE_CLICK:32},RefreshTypes:{NONE:0,CLICK:1,TIMEOUT:2,BOTH:3,VIEWABILITY:4},AdInjectionTypes:{INJECT_PSA:0,PAGE_LOAD:1,TIMEOUT:2,CLICK:3,APPERANCE:4,URL_CHANGE:5,REFRESH_PSA:6,WF_FALLBACK:7,REFRESH_CONFIANT_BLOCK:8,REFRESH_AD_LIGHTNING_BLOCK:9},AdInjectionBlockType:{CONFIANT_BLOCK:1,AD_LIGHTNING_BLOCK:2},LoadStatusTypes:{SUCCESS:1,MAX_ELEMS_REACHED:8,GET_ADS_FAILED:9,AD_SERVER_DOWN:10,GET_ADS_MAX_RETRY:15,SELECTOR_NOT_FOUND:18,SELECTOR_TOO_SMALL:19,SAME_ID_WIDGETS:21,EXTERNAL_CONTENT_FAILED:25},ItemViewTypes:{ON_HOVER:1,ON_NEXT_BTN:2,ON_PREV_BTN:3,VIEWABILITY:4,IN_IFRAME:5,UNVIEWABILITY:6,ENDING_SCREEN:7,AD:8,ON_NEXT_AUTOPLAY:9,SPONSORED_ENDING_SCREEN:10,SPONSORED_LINK_CLICK:11,ENDING_SCREEN_AUTOPLAY:12,SPONSORED_ENDING_SCREEN_AUTOPLAY:13,AD_AUTOPLAY:14,SPONSORED_IN_ITEM_SCREEN:15,SPONSORED_IN_ITEM_SCREEN_AUTOPLAY:16,AUTOPLAY_CAROUSEL_COMPLETED:17,NONE:255},PageRequestTypes:{ERROR:0,PAGE_VIEW:1,NOT_FOUND:2,PENDING:3,NO_ELEMS_FOUND:4,NO_CONTENT_FOUND:5,UNKNOWN_PUBLISHER:6,UNSUPPORTED_DOMAIN:7,MOBILE:8,AUTOMATION_FAILED:9,HOMEPAGE:10,REVISER:11,UNSUPPORTED_BROWSER:12,DIV_TOO_SMALL:13,CORRUPTED_JSON:14,BLOCKED_MOBILE:15,NO_SHOW_META:16,BLOCKED_DESKTOP:17,BLOCKED_TABLET:18,ADS_ONLY:19,INITIALIZE_FAILED:21,NO_PLACEHOLDER_FOUND:22,NO_CONTENT_TEMPLATE_FOUND:23,HIDDEN_IFRAME:24,BLOCKED_KNOWN_SAFE_FRAME:25,GET_ELEMENTS_ERROR:255},teaserTriggerTypes:{TIMEOUT:1,VIEWABILITY:2},isServerCallTypes:{FROM_CDN:0,FROM_SERVER:1},HeaderBiddingRequestStatus:{SUCCESS:1,TIMEOUT:2,FAIL:3,REQUEST_MADE:10,HIGH_TIER_FILLED:11,REQUEST_LOW_TIER_MADE:12,LOW_TIER_FILLED:13},TagExtractionTypes:{APPEND:1,POSTSCRIBE:2,WRITECAPTURE:3,POSTSCRIBE_ONLY:4,SRCDOC_IFRAME:5,BILIMBI:6,WRITE_IFRAME:7,CONFIANT_IFRAME:8,AD_LIGHTNING_IFRAME:9,SAFE_FREAME:10,STD_SAFE_FRAME:11,DEV_CON:12,M_CONFIANT_IFRAME:13,WEATHER_AD_LIGHTNING:14,FINANCE_AD_LIGHTNING:15},AdOpenBehaviors:{TIMER:1,ENGAGEMENT:2,VIEWABLE:3,HOVER_ON_UNIT:4,PAGE_LOAD:5},AdCloseBehaviors:{TIMER:1,ENGAGEMENT:2,VIEWABLE:3,HOVER_ON_UNIT:4},AbTests:{NO_LAYER:9999,NO_ADS:9998,ADS_ON_PAGE_LOAD:9997,BASE_PAGE_LOAD:9996,LAYER_ON_PAGE_LOAD:9995},SetEventTypes:{PAGE_LOAD_EVENT:150},UnitLoadTypes:{ASYNC:1,DOM_LOADED:2,PAGE_LOAD:3},ConsentStatusTypes:{IAB_STANDARD_CMP_FOUND:10,GOOGLE_FUNDING_CHOICES_FOUND:98},AdTriggerTypes:{LEFT_INSIDE_UNIT:1,CENTER_INSIDE_UNIT:2,BELOW_COVER_CONTENT:3,BELOW_PUSH_CONTENT:4,RIGHT_INSIDE_UNIT:5,RIGHT_OF_UNIT:6,LEFT_OF_UNIT:7,INNER_BANNER:8,ABOVE_PUSH_CONTENT:9,LEFT_POP_ON_UNIT:12,IN_ITEM:20,IN_ITEM_COVER:21,IN_ITEM_NO_BUTTONS:22,IN_ITEM_WITH_DURATION:23,IN_ITEM_MOBILE:200,BELOW_MOBILE:204,ABOVE_MOBILE:209,FIXED_FOOTER:300,STATIC_BANNER:900},NodeTypes:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}},Cbola.Config=function(){var e=Cbola._,t=Cbola.Enums,i={query:{qa:"//qa_api.carambo.la/inimage/server/",prod:"//content.carambo.la/"},analytics:{qa:"//qa_api.carambo.la/inimage/analytics/",prod:"//analytics.carambo.la/"},pageAnalytics:{qa:"//qa_api.carambo.la/inimage/analytics/",prod:"//analytics.carambo.la/"},logging:{qa:"//qa_api.carambo.la/inimage/logging/",prod:"//logging.carambo.la/"},CDN:{qa:"//qa.inimage.carambo.la/",prod:"//inimage.carambo.la/"},EX_CDN:{qa:"//qaex-data.carambo.la/",prod:"//ex-data.carambo.la/"},ads:{qa:"//qa.adserver.carambo.la/",prod:"//xtr.carambo.la/"},extraContent:{qa:"//qa-excontent.carambo.la/",prod:"//excontent.carambo.la/"}},o=function(){var t=Cbola.Utils;if(n.abTestId=n.abTestId||parseInt(t.getUrlParams()["cbolaabtest"]),!n.abTestId){var cbolaConfig={};cbolaConfig.abTestId=1,n.abTestId=cbolaConfig.abTestId}var i=e.get(Cbola.Env,"topWindow");if(i){var o=e.get(i,"cbola_abTestId");o?n.abTestId=parseInt(o):i["cbola_abTestId"]=n.abTestId}},n={Language:{english:"en",spanish:"es",portuguese:"pt",russian:"ru",french:"fr",japanese:"ja",german:"de"},maxParentElementsCheckWidth:5,abTestSkipContent:!1,defaultAdsExtractType:0,checkPendingICscriptsTimeLength:25,findICSelectorElementMaxRetries:80,zIndexLayer:999999999,MaxWidgets:999,inContentFallbackWidths:[440,300],scriptExecutionDateTimeKey:"cbolaDt",proxyId:"carambola_proxy",inContentClass:"carambola_InContent",placeholderClass:"carambola-layer-placeholder",bitlyUrl:"",icDefaultMainTitle:"Did you know?",adBelowSideBarMargin:1,adBelowSlideShowMargin:10,defaultBrandRedirect:"https://www.carambola.com/",adTitleStructureTriviaHeight:14,adBelowInContentExtraMargin:3,adAsideOfUnitExtraMargin:5,timeouts:{getAdsRequest:100,pendingBeforeSkippingHeaderBidding:5e3,pendingHeaderBiddingResponseBrake:200,pendingIndexExchangeBuffer:250},autoSlideFirst:!0,autoSlideFirst_openAfterSecs:3e3,autoSlideFirst_closeAfterSecs:6e3,layouts:{inContent:{all:[100,101,102,110,112,120,121,160,170],facts:[100,101,102,110,112],trivia:[120],triviaMulti:[121],twitter:[160],indices:[170]},sideBars:{all:[130,131,132,133,134,135,136,137,138,139,140,150,151,152,153],facts:[130,131,132,133,136,152],diedOnThisDay:[134,150],diedOnThisWeek:[151],onThisDay:[135,137,153],trivia:[140],staticBanner:[130,131,133,134,135,140],teaserBanner:[132],sidebarSlideshow:[136,137],storiesSlideshow:[138,139],slideShow:[150,151,152,153]},mobile:{all:[1e3,1100,1400],facts:[1e3,1100],trivia:[1400]},adOnly:{all:[900]}},clientPaths:{0:{path:"//cdata.carambo.la/Layer/InImage/Prod/cbola_platform/version_",sfPath:"//safeframe.carambo.la/Layer/InImage/Prod/cbola_platform/version_",isMin:!0,withVersion:!0},1:{path:"//qa1.carambo.la/inimage/versions",isMin:!0,withVersion:!1},2:{path:"//cdata.carambo.la/Layer/InImage/QA/cbola_platform/version_",sfPath:"//safeframe.carambo.la/Layer/InImage/QA/cbola_platform/version_",isMin:!0,withVersion:!0},6:{path:"//localhost:9000/platform",isMin:!1,withVersion:!1},7:{path:"//qa1.carambo.la/inimage/versions",isMin:!1,withVersion:!1},10:{path:"//cdata.carambo.la/Layer/InImage/Prod/cbola_platform/version_",sfPath:"//safeframe.carambo.la/Layer/InImage/Prod/cbola_platform/version_",isMin:!1,withVersion:!0},11:{path:"//qa1.carambo.la/inimage/mobile",isMin:!1,withVersion:!1},110:{path:"//localhost:9000",isMin:!0,withVersion:!1},31:{alias:1},36:{alias:6},12:{alias:11}},init:function(){var r=this,a=Cbola.Utils;this.layouts.all=[],e.forEach(this.layouts,function(t){e.get(t,"all")&&a.push.apply(r.layouts.all,t.all)});var s=n.layouts;this.triggersDictionary={1:{supportedLayers:s.inContent.trivia},2:{supportedLayers:s.inContent.trivia.concat(s.inContent.triviaMulti)},3:{supportedLayers:s.inContent.trivia.concat(s.inContent.triviaMulti)},4:{supportedLayers:s.inContent.trivia.concat(s.inContent.triviaMulti)},5:{supportedLayers:s.inContent.triviaMulti},6:{supportedLayers:s.inContent.trivia.concat(s.inContent.triviaMulti)},7:{supportedLayers:s.inContent.trivia.concat(s.inContent.triviaMulti)},11:{supportedLayers:s.sideBars.slideShow,translatedTo:t.AdTriggerTypes.LEFT_INSIDE_UNIT},12:{supportedLayers:s.sideBars.slideShow},14:{supportedLayers:s.sideBars.staticBanner.concat(s.sideBars.sidebarSlideshow,s.sideBars.storiesSlideshow),translatedTo:t.AdTriggerTypes.BELOW_PUSH_CONTENT},15:{supportedLayers:s.sideBars.slideShow,translatedTo:t.AdTriggerTypes.IN_ITEM},18:{supportedLayers:s.sideBars.teaserBanner,translatedTo:t.AdTriggerTypes.INNER_BANNER},19:{supportedLayers:s.sideBars.staticBanner.concat(s.sideBars.sidebarSlideshow,s.sideBars.storiesSlideshow),translatedTo:t.AdTriggerTypes.ABOVE_PUSH_CONTENT},20:{supportedLayers:s.sideBars.staticBanner.concat(s.sideBars.teaserBanner,s.sideBars.sidebarSlideshow,s.sideBars.storiesSlideshow)},21:{supportedLayers:s.sideBars.staticBanner.concat(s.sideBars.sidebarSlideshow)},22:{supportedLayers:s.sideBars.slideShow},23:{supportedLayers:s.sideBars.storiesSlideshow},54:{supportedLayers:s.inContent.facts,translatedTo:t.AdTriggerTypes.BELOW_PUSH_CONTENT},56:{supportedLayers:s.inContent.facts,translatedTo:t.AdTriggerTypes.RIGHT_OF_UNIT},57:{
supportedLayers:s.inContent.facts,translatedTo:t.AdTriggerTypes.LEFT_OF_UNIT},58:{supportedLayers:s.inContent.facts,translatedTo:t.AdTriggerTypes.INNER_BANNER},62:{supportedLayers:s.inContent.twitter,translatedTo:t.AdTriggerTypes.IN_ITEM_NO_BUTTONS},64:{supportedLayers:s.inContent.twitter,translatedTo:t.AdTriggerTypes.BELOW_PUSH_CONTENT},68:{supportedLayers:s.inContent.twitter,translatedTo:t.AdTriggerTypes.IN_ITEM},69:{supportedLayers:s.inContent.trivia,translatedTo:t.AdTriggerTypes.IN_ITEM},73:{supportedLayers:s.inContent.indices,translatedTo:t.AdTriggerTypes.IN_ITEM_WITH_DURATION},200:{supportedLayers:s.mobile.all},204:{supportedLayers:s.mobile.all},209:{supportedLayers:s.mobile.all},300:{supportedLayers:s.all},900:{supportedLayers:s.adOnly.all}};var l={adServer_method:"GetAds",queryServer:i.query.prod,analyticsServer:i.analytics.prod,pageAnalyticsServer:i.pageAnalytics.prod,loggingServer:i.logging.prod,CDN:i.CDN.prod,EX_CDN:i.EX_CDN.prod,adServer:i.ads.prod,extraContent:i.extraContent.prod};"1"===Cbola.Env.queryServer||"qa"===Cbola.Env.queryServer||"3"===Cbola.Env.queryServer?(l.CDN=i.CDN.qa,l.EX_CDN=i.EX_CDN.qa,l.queryServer=i.query.qa,l.extraContent=i.extraContent.qa,l.adServer=i.ads.qa,l.analyticsServer=i.analytics.qa,l.pageAnalyticsServer=i.pageAnalytics.qa,l.loggingServer=i.logging.qa,"undefined"!=typeof Cbola.Env.activePid&&"cbolaDemo"===Cbola.Env.activePid&&(l.adServer=i.ads.prod,l.adServer_method="GetExtraContent"),"3"===Cbola.Env.queryServer&&(l.CDN="//s3.amazonaws.com/qa.inimage.carambo.la/")):"undefined"!=typeof Cbola.Env.activePid&&"cbolaDemo"===Cbola.Env.activePid&&(l.adServer=i.ads.prod,l.adServer_method="GetExtraContent"),o(),(30===n.abTestId||31===n.abTestId||32===n.abTestId)&&(l.loggingServer=i.logging.prod,(31===n.abTestId||32===n.abTestId)&&(l.queryServer=i.query.prod,l.extraContent=i.extraContent.prod),32===n.abTestId&&(l.adServer=i.ads.prod)),e.extend(this,{Defaults:l}),n.brandRedirectTemplate=function(e){var t=e.layerType;return n.defaultBrandRedirect+"?cf=unt"+t+"_"+Cbola.Env.domainId}},getLayersDefaultSize:e.memoize(function(e){switch(e){case 100:case 101:case 110:return{height:270,width:640};case 102:case 112:return{height:250,width:640};case 120:case 121:return{height:250,width:650};case 130:case 131:return{height:350,width:300};case 132:return{height:600,width:300};case 133:case 134:case 135:return{height:350,width:300};case 136:case 137:case 138:case 139:return{height:340,width:300};case 140:return{height:350,width:300};case 150:case 151:case 152:case 153:return{height:250,width:300};case 160:return{height:90,width:728};case 170:return{height:"auto",width:606};case 900:return{height:"auto",width:"auto"};case 1e3:case 1100:case 1400:return{height:"inherit",width:0};default:return{height:230,width:100}}}),getLayersDefaultSizeForIframe:e.memoize(function(e){switch(e){case 100:case 101:case 102:case 110:case 112:return{height:270,width:450};case 120:return"pgtr56"===Cbola.Env.activePid?{height:250,width:500}:{height:265,width:500};case 121:return{height:250,width:500};case 130:case 131:case 133:case 134:case 135:return{height:350,width:300};case 136:case 137:case 138:case 139:return{height:340,width:300};case 140:return{height:350,width:300};case 150:case 151:case 152:case 153:return{height:250,width:300};case 160:return{height:90,width:600};case 170:return{height:105,width:606};case 900:return{height:0,width:-1};case 1e3:return"lgcy81"===Cbola.Env.activePid||"lgcy42"===Cbola.Env.activePid?{height:455,width:-1}:{height:500,width:-1};case 1100:return"lgcy81"===Cbola.Env.activePid||"lgcy42"===Cbola.Env.activePid?{height:455,width:-1}:{height:500,width:-1};case 1400:return{height:516,width:300};default:return{height:230,width:100}}}),getLayerMinSizes:e.memoize(function(e){switch(e){case 100:case 101:case 110:return{width:440,height:270};case 102:case 112:return{width:440,height:250};case 120:return{width:500,height:250};case 121:return{width:480,height:250};case 130:case 131:case 132:case 133:case 134:case 135:case 136:case 137:case 138:case 140:return{width:300,height:350};case 150:case 151:case 152:case 153:return{width:300,height:250};case 160:return{width:545,height:90};case 170:return{width:606,height:105};case 900:return{height:"auto",width:300};case 1e3:case 1100:case 1400:return{width:0,height:0};default:return{width:440,height:250}}}),jsonRegEx:{0:"[\\?&]utm_",110587:"#~[a-zA-Z0-9]{14}",110461:"\\?(?!cctn)|;grp=|;kvstate=|;kvfirstname=|;kvlastname=|#",110760:"[\\?&]wpvqas=",110775:"#|\\?li_|\\?cbolaGameSet",110735:"\\?gclid=|#|/ml/1/e/",110729:"\\?gclid=|#|/ml/1/e/",110663:"#|\\?_|\\?fb_",110733:"\\?fb_|\\?gclid=|#|/ml/1/e/",111799:"#axzz",111814:"\\?|/[0-9]{8}",110744:"\\?gclid=|#|/ml/1/e/",110695:"\\?gclid=|#|/ml/1/e/",110730:"\\?gclid=|#|/ml/1/e/",110746:"\\?gclid=|#|/ml/1/e/",110728:"\\?gclid=|#|/ml/1/e/",110726:"\\?gclid=|#|/ml/1/e/",110737:"\\?gclid=|#|/ml/1/e/",110694:"\\?gclid=|#|/ml/1/e/",110738:"\\?gclid=|#|/ml/1/e/",111843:"\\?gclid=|#|/ml/1/e/",110740:"\\?gclid=|#|/ml/1/e/",110732:"\\?gclid=|#|/ml/1/e/",112323:"userid=",112230:"\\?pctx=",112268:"gclid=",112433:"[\\?&]utm_|#",110396:"\\?storyurl=",110577:"\\?|#|/wiki/",110681:"&qp=|&ticketid=",112227:"\\?pmcode|\\?_cmp=|\\?p=|\\?trkid=",110535:"\\?icid=",112441:"[\\?&]feed|[\\?&]wigetarticlelistfile=",112460:"\\?|&c.|&did.",112454:"&c.",112455:"&c.",112457:"&c.",112458:"&c.",112459:"&c.",112469:"&c.",112470:"&c.",112471:"&c.",112472:"&c.",112519:"&c.",112520:"&c.",112540:"&c.",112551:"/217|/218|/219|/220|/[0-9]{9}\\?new=true",112451:"\\?trkid=",112630:"/[a-zA-Z0-9]{8}$|/[a-zA-Z0-9]{7}$|/[a-zA-Z0-9]{6}$|/[a-zA-Z0-9]{5}$|/a/|/gallery/|/r/|/t/|/user/",112390:"/unscramble/",112476:"&userid=",112647:"\\?|#",112665:"&geom=|&rf=|&p=",112550:"/[0-9]{9}\\?new=true",110727:"/ml/1/e/",112663:"/gampad/ads",112732:"\\?ord=",112760:"[\\?&]puc=|\\?_ga=|\\?hash=",112606:"\\?chr=",112632:"_activity_context=|u_audio=|a3dwebglbanner=",112751:"\\?et_rid=",112777:"\\?message_id=",112733:"/centerx:|/shipid:",112623:"\\?",112355:"\\?|&",112842:"\\/[0-9]{4}\\/|\\/[0-9]{5}\\/|\\/[0-9]{6}\\/|\\/[0-9]{7}\\/|\\/[0-9]{8}\\/",112752:"\\?",112845:"\\b/.*$",112846:"\\b/.*$",113007:"\\?",113071:"\\/[0-9]{9}|\\/[0-9]{8}|\\/[0-9]{7}"},srcUrlEnabledDids:[110006,112389,112485]};return n}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Cbola.Utils=Cbola.Utils||function(){var e=window.requestAnimationFrame,t=Cbola._,i=Cbola.Config,o=navigator.userAgent,n="Utils",r=[],a=99999,s=1e4,l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=t.partial(t.padStart,t,2,"0"),o=new Date;return i(o.getDate())+i(o.getMonth()+1)+i(o.getFullYear()%100)+i(o.getHours())+i(o.getMinutes())+i(o.getSeconds())+i(o.getMilliseconds()%100)+e},d={isFacebookBrowser:/\[FB.*;(FBAV)\/(\d+)(?:\.(\d+)(?:\.(\d)+)?)?/g.test(o)||/(facebookexternalhit)\/(\d+)\.(\d+)/g.test(o),isIOS:/iPad|iPhone|iPod/g.test(o),isIE:/(msie\s)|(trident.*rv\:)|(edge\/)/gi.test(o),isFirefox:/firefox/gi.test(o),isMobile:/iphone|ipod|android|blackberry|opera|mini|windows\sce|palm|smartphone|iemobile/gi.test(o)&&-1===o.search("PC"),isTablet:t.memoize(function(){var e=/ipad|a1_07|a1-810|a1-811|a1-830|a3000-h|a3300-hv|a3500-f|a3500-fl|a3500-h|a3-a10|a5500-f|a5500-h|a7600-f|a7600-h|android 3|archos 101|archos 80g9|aries_785|arnova 101|at100|at10-a|at200|at300|b1-710|b1-711|b1-730|b1-770|b1-780|b1-810|b1-830|b1-850|b1-a71|b6000-f|b6000-h|b8000-f|b8000-h|b8080-f|b8080-h|bn nookhd+|bnrv200|bntv250|bntv250a|bntv400|bntv450|bntv600|breeze 10|cm_tenderloin|dell streak 7|dl1010q|e2281|e-tab ivory|gt-n5100|gt-n5110|gt-n8000|gt-n8010|gt-n8013|gt-n8020|gt-p1000|gt-p1010|gt-p3100|gt-p3110|gt-p3113|gt-p5100|gt-p5110|gt-p5113|gt-p5200|gt-p5210|gt-p5220|gt-p7300|gt-p7310|gt-p7500|gt-p7510|hpwos|hudl 2|ideapad|ideatab|k00e|k00f|k010|k011|k012|k017|k01a|kfapwa |kfapwi|kfarwi|kfaswi|kfauwi|kfdowi|kffowi|kfgiwi|kfjwa|kfjwi|kfmewi|kfot|kfsawa|kfsawi|kfsowi|kfsuwi|kftbwi|kfthwa|kfthwi|kftt|kindle|lguk410|lguk750|lguk932|lg-v400|lg-v410|lg-v490|lg-v495|lg-v496|lg-v497|lg-v500|lg-v520|lg-v521|lg-v522|lg-v700|lg-v930|lifetab|m532|me172v|me173x|me301t|me302c|me302kl|me371mg|mediapad|memo pad|micromax_a101|mz601|mz604|nexus 10|nexus 7|nx008hd8g|nx16a10132s|nx16a11264|nx16a8116k|nx700qc|nx785qc8g|nxa116qc164|nxa8qc116|onda v989|p310a|p310x|p320x|padfone|playbook|pmp5580c|pmp7280c3g|pmt3377_wi|pmt7077_3g|qmv7a|qmv7b|qtair7|qtaqz3|qv830|rct6103w46|rct6203w46|rct6213w87dk|rct6213w87m|rct6303w87dk|rct6303w87m|rct6513w87|rct6573w23|rct6603w47m7|rct6603w87m7|rct6703w13|rct6773w22|rct6773w42b|rct6873w42m|rct6973w43|rct6k03w13|s5000-f|s5000-h|s6000l-f|s920_row|sch-i705|sch-i800|sch-i915|sch-i925|sgh-i467|sgh-i497|sgh-i777|sgp311|sgp312|sgp321|sgp511|sgp512|sgp521|sgp561|sgp611|sgp612|sgp621|sgp712|sgp771|sgpt12|sgpt13|shv-e210k|slider sl101|smart tab|sm-p550|sm-p600|sm-p605|sm-p900|sm-p905|sm-t\d\d\d|tab 2 a10-70f|tab 2 a7-30hc|tab 2 a8-50f|tab 2 a8-50lc|tab s8-50f|tab2a7-10f|tab2a7-20f|tablet|tb2-x30f|tb3-710f|tb3-710i|tb3-850f|tb3-850m|tb3-x70f|tb-8504f|tb-8704f|tb-x103f|tb-x304f|tc802a|tf300t|tf700t|touchpad|tf201|tf101|venue 7 3730|venue 7 hspa+|venue 8 3830|venue 8 7840|venue 8 hspa+|vk810 4g|vk815|vodafone smart ii|xolo a700|xoom|yb1-x90f|yoga b6000-f|yoga b8000-f|yt3-850f|yt3-x50f|yt3-x90f|yt-x703f|zaffire 1010/i.test(o.toLowerCase());return e&&(Cbola.Env.PageProperties.isMobile=!1),e&&-1===o.search("PC")}),getRunTimeInSecs:function(){var e=Math.abs(((new Date).getTime()-Cbola.Env.PageProperties.startTime.getTime())/1e3);return Math.floor(100*e)/100},getRunTimeInMilis:function(){return Math.abs((new Date).getTime()-Cbola.Env.PageProperties.startTime.getTime())+"ms"},generateViewId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;if(e>t){var i=e;e=t,t=i}var o=Math.random();return l(e+Math.round(o*(t-e)))},replaceAll:function(e,i,o){return t.isEmpty(o)?o:o.replace(new RegExp(e,"g"),i)},chromeVersion:t.memoize(function(){var e=o.match(/Chrom(e|ium)\/([0-9]+)\./);return e?parseInt(e[2],10):0}),setGlobalRedirectTime:function(){var e=Cbola.Common.LocalStorageService,t=Cbola.Env.PageProperties,o=e.getItem(i.scriptExecutionDateTimeKey)||"";e.removeItem(i.scriptExecutionDateTimeKey);var n=o.split("&"),r=n.pop();t.publisherScriptExecutionTime=r?parseInt(r):null;var a=t.publisherScriptExecutionTime?t.startDateFileUploaded.getTime()-t.publisherScriptExecutionTime:0;return Cbola.Logger.getInstance().info(Cbola.Logger.Colors.PALE_BLUE,"Redirection server duration: "+a+"ms"),a},checkIfQueryStingExist:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,n=Cbola.Env.PageProperties,a=e.ParentId,s=this.getUrlParams()["cbolagameset"],l=n.originalPathNameHost;if(parseInt(s)===a)return l;if(t.isNumber(a)&&(l=n.originalPathNameHost+(n.originalPathNameHost.indexOf("?")>-1?"&":"?")+"cbolaGameSet="+a),r.indexOf(l)>-1)return l;if(o){r.push(l);var d={PublisherId:Cbola.Env.activePid,UrlData:{Url:l.toLowerCase(),Hash_128_Bit:CryptoJSCbola.MD5(l.toLowerCase()).toString(),Hash_160_Bit:CryptoJSCbola.SHA1(l.toLowerCase()).toString()},AbTestId:i.abTestId,IsMobile:n.isMobile,IsTablet:n.isTablet,CategoryId:Cbola.Env.Category,Tags:Cbola.Env.tags,Title:Cbola.Env.title,Body:Cbola.Env.body},c=JSON.stringify(d);Cbola.Logger.getInstance().info("Cbola_getPageElements_forAutomation start. json: "+c),fetch(i.Defaults.queryServer+"GetInContentInfo",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:c})}return l},checkImageLoaded:function(e){var t=new Image;t.src=e,t.onload=function(){},t.onerror=function(){Cbola.Logger.getInstance().errorM(n+".checkImageLoaded","Image not loaded. src: "+e)}},getLocationHref:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,i="getLocationHref",o="";try{var r=!0;do this.isAboutBlankIframe(e)||this.isKnownSafeFrame(e)?(o=e.document.referrer,e.frameElement?e=e.parent:r=!1):r=!1;while(r)}catch(a){Cbola.Logger.getInstance().errorM(n+"."+i,n+"."+i+" failed getting referrer URL outside an iframe. error: ",a)}return t.isEmpty(o)?e.location.href:o},getLowerLocationHref:function(){return this.getLocationHref().toLowerCase()},queryStringCut:function(){var e=this.getLowerLocationHref();if(/[I,i]gnr/.test(e)){var o=e.split("?");return i.queryString=o[1],i.ignoreQueryString=!0,o[0]}i.queryString="",i.ignoreQueryString=!1;var n=document.querySelector('meta[property="carambola"]');return!/[d,D]irty/.test(e)&&n?t.toLower(n.getAttribute("content")):e},queryStringCutRegex:function(){var e=this.queryStringCut();try{var t=Cbola.Env.domainId;if(null!==t&&t>0){var o=i.jsonRegEx,n=o[t]||o[0];if(n){var r=e.search(new RegExp(n,"ig"));-1!==r&&(e=e.substring(0,r))}}}catch(a){Cbola.Logger.getInstance().info(a)}return e},isInIframe:t.memoize(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;try{return window.top!==e}catch(t){return!0}}),isFriendlyIframe:t.memoize(function(){if(this.isInIframe())try{if(window.frameElement)return!0;if("undefined"!=typeof inDapIF&&inDapIF)return!0}catch(e){return!1}return!1}),isWindowTopSupported:t.memoize(function(){if(this.isFriendlyIframe())try{if(window.top.document)return!0}catch(e){return!1}return!1}),isKnownSafeFrame:t.memoize(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=["tpc.googlesyndication.com","pubads.g.doubleclick.net","partner.googleadservices.com"];try{return this.isInIframe(e)&&new RegExp(t.join("|"),"gi").test(e.location.href)}catch(i){return!1}}),isAboutBlankIframe:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;try{return this.isInIframe(e)&&/about:blank/gi.test(e.location.href)}catch(t){return!1}},getCurrentAbTestId:function(){return i.abTestSkipContent?1:i.abTestId},cumulativeOffset:function(e){var t=0,i=0;do{var o=0,n=0;if(window.getComputedStyle&&window.WebKitCSSMatrix){var r=getComputedStyle(e).transform||getComputedStyle(e).webkitTransform,a=new WebKitCSSMatrix(r);o=a.m41,n=a.m42}t+=e.offsetTop+n||0,i+=e.offsetLeft+o||0,e=e.offsetParent}while(e);return{top:t,left:i}},getPrevSibling:function(e){for(var t=e.previousSibling;t;){if(t.nodeType===Cbola.Enums.NodeTypes.ELEMENT_NODE)return t;t=t.previousSibling}return null},fixPixelHeight:function(e){try{var t=this.getPrevSibling(e);"img"===t.tagName.toLowerCase()&&t.src.indexOf("pixel.watch")>-1&&(t.style["display"]="block",t.style["height"]="0")}catch(i){}},detectDeviceOrientation:function(){var e=void 0,t=void 0,i=document.getElementsByClassName("cbola-orientation-src");if(i.length>0)i=i[0],e=Math.max(i.clientWidth,0),t=Math.max(i.clientHeight,0);else{var o=window;window!==window.parent&&(o=window.parent);try{e=o.innerWidth||o.document.documentElement.clientWidth||o.document.body.clientWidth,t=o.innerHeight||o.document.documentElement.clientHeight||o.document.body.clientHeight}catch(n){o=window,e=o.innerWidth||o.document.documentElement.clientWidth||o.document.body.clientWidth,t=o.innerHeight||o.document.documentElement.clientHeight||o.document.body.clientHeight}}return e>t?(Cbola.Env.PageProperties.isPortrait=!1,"landscape"):(Cbola.Env.PageProperties.isPortrait=!0,"portrait")},injectStyle:function(e,t){var i=e.createElement("style");if(e.getElementsByTagName("head")[0].appendChild(i),i.styleSheet)i.styleSheet.disabled||(i.styleSheet.cssText=t);else try{i.innerHTML=t}catch(o){i.textContent=t}return i},initPayload:function(){var e=Cbola.Env,t=this.getCurrentAbTestId();return{PublisherId:e.activePid,UrlData:{Url:e.PageProperties.hostname,Hash_128_Bit:e.PageProperties.urlHashMD5,Hash_160_Bit:e.PageProperties.urlHashSHA1},AbTestId:t,ScriptDomainId:Cbola.Env.domainId,IsMobile:e.PageProperties.isMobile,IsTablet:e.PageProperties.isTablet}},isGoogleWebLightAgent:t.memoize(function(){return/^.*?\bAndroid\b.*?\bgoogleweblight\b.*?$/.test(o)}),updateEnv:function(e){Cbola.Env=t.extend(Cbola.Env,e);var o={PageId:0,Category:0,Domain:0};t.defaults(Cbola.Env,o),t.extendWith(i,e.DefaultSettings,function(e,t){return"undefined"==typeof t?e:t})},parseBool:function(e){return e===!0||"true"===e||"number"==typeof e&&0!==e},dataset:function(){if(arguments.length<2)return null;var e=arguments.length<=0?void 0:arguments[0];if(!e)return null;var i=arguments.length<=1?void 0:arguments[1];return arguments.length>2&&(e.dataset?e.dataset[t.camelCase(i)]=arguments.length<=2?void 0:arguments[2]:e.setAttribute("data-"+t.kebabCase(i),arguments.length<=2?void 0:arguments[2])),e.dataset?e.dataset[t.camelCase(i)]||null:e.getAttribute("data-"+t.kebabCase(i))},datasetRemove:function(e,i){e.dataset?delete e.dataset[t.camelCase(i)]:e.removeAttribute("data-"+t.kebabCase(i))},getUrlParams:function(){var e={};try{e=this.getParamsFromUrl(window.top.location.href)}catch(t){e=this.getParamsFromUrl(window.location.href)}return e},integrationTypeCheck:function(){var e=Cbola.Enums.IntegrationTypes;try{return this.isInIframe()?this.isFriendlyIframe()?e.DFP:this.isKnownSafeFrame()?e.SAFE_FRAME:e.IFRAME:e.NORMAL}catch(t){return e.ERROR}},validateRGBArray:function(e){if(!t.isArray(e)||3!==e.length)return null;for(var i=e.map(function(e){return parseInt(e)}),o=0;o<i.length;o++)if(isNaN(i[o])||i[o]<0||i[o]>255)return null;return i},rgbStringToArray:function(e){if("string"!=typeof e)return null;var t=e.indexOf("("),i=e.indexOf(")");if(-1===t||-1===i)return null;var o=e.substring(t+1,i).split(",");return this.validateRGBArray(o)},rgbToRgba:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=this.rgbStringToArray(e);return null===i?null:(i.splice(3,i.length,t),"rgba("+i.join(",")+")")},rgbToHSL:function(){for(var e=arguments.length,t=Array(e),i=0;e>i;i++)t[i]=arguments[i];var o=void 0,n=void 0,r=0,a=0,s=0;if(1===t.length){var l=this.rgbStringToArray(t[0]);if(null===l)return null;o=l[0]/255,n=l[1]/255,r=l[2]/255}else{if(3!==t.length)return null;if(t=this.validateRGBArray(t),null===t)return null;o=t[0]/255,n=t[1]/255,r=t[2]/255}var d=Math.min(o,n,r),c=Math.max(o,n,r),h=(d+c)/2,m=c-d;if(m){switch(s=.5>h?m/(c+d):m/(2-c-d),s=Math.round(100*s),c){case o:a=(n-r)/m;break;case n:a=2+(r-o)/m;break;case r:a=4+(o-n)/m}a=Math.round(60*a+(0>a?360:0))}return h=Math.round(100*h),{h:a,s:s,l:h}},generateGradientBreaksFromRGB:function(e,i){var o=d.rgbToHSL(e);if(t.isNil(o))return null;for(var n=90,r=o.l,a=.25*(n-r),s=[],l=0;i>l;l++){var c=r;i-1>l&&(c=r+Math.round(a),a/=2),s.push("hsla("+o.h+","+o.s+"%,"+c+"%, "+(0===l?.5:1)+")")}return s},replaceCommentWithElement:function(e,t,i){if(t.nodeType===Cbola.Enums.NodeTypes.COMMENT_NODE&&t.textContent.trim()===e)return t.parentNode.replaceChild(i,t),!0;for(var o=t.firstChild;o;){if(this.replaceCommentWithElement(e,o,i))return!0;o=o.nextSibling}return!1},before:function(e,t){e.parentNode.insertBefore(t,e)},after:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},preappend:function(e,t){e.insertBefore(t,e.firstChild)},encodePayload:function(e){function i(e,o,n){var r=void 0,a=t.isArray(o),s=t.isPlainObject(o);t.forEach(o,function(t,o){r="undefined"==typeof t?"undefined":_typeof(t),n&&(o=n+"["+(s||"object"===r||"array"===r?o:"")+"]"),!n&&a?e.add(t.name,t.value):"array"===r||"object"===r?i(e,t,o):e.add(o,t)})}var o=[];return o.add=function(e,i){t.isFunction(i)&&(i=i()),t.isNil(i)&&(i=""),this.push(encodeURIComponent(e)+"="+encodeURIComponent(i))},i(o,e),o.join("&").replace(/%20/g,"+")},getBitlyUrlAsync:function(e,o){if(""===i.bitlyUrl){var n="https://api-ssl.bitly.com/v3/shorten?access_token=9bca2257713ece1cbe2417d579434912c24ae333&longUrl="+encodeURIComponent(d.checkIfQueryStingExist(e));fetch(n).then(function(e){if(e.status>=200&&e.status<300)return e.json();var t=new Error(e.statusText);throw t.response=e,t}).then(function(n){t.isNil(n.url)?i.bitlyUrl=d.checkIfQueryStingExist(e,!0):i.bitlyUrl=n.url,o(i.bitlyUrl)}).catch(this.noOp)}else o(i.bitlyUrl)},getParamsFromUrl:t.memoize(function(e){var i={};return t.isNil(e)?{}:(e.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,t,o){i[t.toLowerCase()]=o}),i)}),isPassiveEventSupported:t.memoize(function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(i){}return e}),extractLinksFromText:function(e){for(var i="",o=[],n=/(https?:\/\/[^\s]+)/g;null!=(i=n.exec(e));){var r=i[0];r=t.trimEnd(r,""),o.push({idx:i.index,url:r})}return o},transform:function(e,i){if(e&&e.style){var o=e.style,n=["-webkit-","-moz-","-ms-","-o-",""];t.forEach(n,function(e){o[e+"transform"]=i})}},removeTransform:function(e){if(e&&e.style){var i=e.style,o=["-webkit-","-moz-","-ms-","-o-",""];t.forEach(o,function(e){i.removeProperty(e+"transform")})}},withAnimationFramePromise:function(i){return new Promise(function(o,n){t.isFunction(i)?e(function(){i(),e(o)}):n("No function provided")})},toggleTransition:function(e){var i=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,n="cbola-disable-transition",r="transitionToggleCount";if(t.isNil(e))return Promise.reject(new Error("No element provided for class toggling"));var a=e.classList,s=function(){return i.withAnimationFramePromise(function(){a[o?"remove":"add"](n)})},l=parseInt(this.dataset(e,r)),d=0;return d=isNaN(l)?o?0:1:Math.max(o?l-1:l+1,0),this.dataset(e,r,d),o&&a.contains(n)&&0===d?s():!o&&!a.contains(n)&&d>0?s():Promise.resolve()},dotdotdot:function(i){return new Promise(function(o){function n(){i.parentElement.contains(c)?a():e(n)}function r(){return c.offsetHeight>i.offsetHeight}function a(){if(s.length>0&&r())return s=s.substr(0,s.length-1),c.innerText=s+"...",void a();if(s.length>0){var e=c.innerHTML;if(e.length>0){i.innerText=e,e=i.innerText;for(var t=d.extractLinksFromText(e),n=0;n<t.length;n++){var h=t[n];h.text=h.url,h.url=l[n].url,e=e.replace(h.text,'<a href="'+h.url+'" target="_blank">'+h.text+"</a>")}i.innerHTML=e}}c.remove(),o(i)}i.style["white-space"]="normal",i.style["overflow"]="hidden";var s=i.textContent,l=d.extractLinksFromText(s),c=i.cloneNode(!0);t.extend(c.style,{visibility:"hidden",overflow:"visible",width:i.offsetWidth+"px",height:"auto"}),d.after(i,c),n()})},documentReady:function(e){var t=Cbola.Env.topWindow;/complete|loaded|interactive/.test(t.document.readyState)?e():t.addEventListener("DOMContentLoaded",e)},isPageReady:function(){return/complete|loaded/gi.test(Cbola.Env.topWindow.document.readyState)},pageReady:function(e){this.isPageReady()?e():Cbola.Env.topWindow.addEventListener("load",e)},isElementDisplayed:function(e){return!(!e||!(e.offsetWidth||e.offsetHeight||e.getClientRects().length))},isElementAttachedAsync:function(i,o,r){var a=this;return i&&o?(r=t.isFunction(r)?r:function(){o.appendChild(i)},window.MutationObserver?new Promise(function(n){var s={childList:!0},l=function(o,r){o=a.slice.call(o);for(var s=0;s<o.length;s++){var l=o[s];if("childList"===l.type&&t.some(l.addedNodes,function(e){return e===i})){r.disconnect(),e(n);break}}},d=new MutationObserver(l);d.observe(o,s),r()}):this.isStyleAppliedAsync(i,o,r)):Promise.reject(new Error(n+".isElementAttachedAsync No parent element provided"))},isStyleAppliedAsync:function(i,o,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"cbola-inserted";if(!i||!o)return Promise.reject(new Error(n+".isStyleAppliedAsync No parent element provided"));r=t.isFunction(r)?r:function(){o.appendChild(i)};var s=["animationstart","MSAnimationStart","webkitAnimationStart"];return new Promise(function(n){var l=function r(l){l.target===i&&l.animationName===t.camelCase(a)&&(t.forEach(s,function(e){o.removeEventListener(e,r)}),i.classList.remove(a),e(n))};t.forEach(s,function(e){o.addEventListener(e,l,!1)}),r(),i.classList.add(a)})},getDocumentHeight:function(e){var t=e||Cbola.Env.viewportWindow;if(!t)return null;var i=t.document.body,o=t.document.documentElement;return Math.max(i.scrollHeight,o.scrollHeight,i.offsetHeight,o.offsetHeight,i.clientHeight,o.clientHeight)},getElementPixelsFromTop:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;if(!e||!t.document.body.contains(e)||!Cbola.Env.viewportWindow)return null;var i=d.cumulativeOffset(e).top;return i>d.getDocumentHeight(t)||0>i?0:t===Cbola.Env.viewportWindow?i:i+this.getElementPixelsFromTop(t.frameElement,t.parent)},createAdIframe:function(e){var t=e.width,i=void 0===t?0:t,o=e.height,n=void 0===o?0:o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,a=document.createElement("iframe"),s="allow-scripts allow-forms allow-same-origin allow-popups";return this.chromeVersion()>=58&&(s+=" allow-top-navigation-by-user-activation"),r&&a.setAttribute("sandbox",s),a.setAttribute("scrolling","no"),a.setAttribute("marginwidth","0"),a.setAttribute("marginheight","0"),a.setAttribute("frameborder","0"),a.style.setProperty("border","0","important"),a.style.setProperty("margin","0","important"),a.style["vertical-align"]="bottom",a.style["width"]=i+"px",a.style["height"]=n+"px",a},getCompatibleVisibilityAPI:t.memoize(function(){for(var e=["","webkit","moz","ms"],t=0;t<e.length;t++){var i=e[t],o=""===i?"hidden":i+"Hidden";if(o in document)return{hidden:o,changeEventName:i+"visibilitychange"}}return{}}),push:[].push,slice:[].slice,noOp:function(){}};return d}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.TaskManager=Cbola.TaskManager||function(){var e=Cbola._,t=250,i={},o=function(){function o(){_classCallCheck(this,o),this.name="TaskManager",this.loopIteration=null,this.isRunning=!1,this.loopIterationsCounter=0,this.deferredTasksQueue=[]}return _createClass(o,[{key:"taskExecutionLoop",value:function(){this.isRunning=!0,this.loopIteration=null,this.loopIterationsCounter++;var e=this.deferredTasksQueue.length;if("undefined"==typeof this.deferredTasksQueue)return Cbola.Logger.getInstance().warnOnceM(this.name+".taskExecutionLoop",this.name+"::taskLoop -> deferredTasksQueue is undefined"),void(this.isRunning=!1);for(var i=0;e>i;i++){var n=this.deferredTasksQueue.shift();o.executeTask.apply(o,_toConsumableArray(n))}this.deferredTasksQueue.length>0?this.loopIteration=setTimeout(this.taskExecutionLoop.bind(this),t):(this.loopIteration=null,this.isRunning=!1)}},{key:"addTask",value:function(e,i,o,n){var r=[e,i,o,n];this.deferredTasksQueue.push(r),this.isRunning||this.loopIteration||(this.loopIteration=setTimeout(this.taskExecutionLoop.bind(this),t))}},{key:"removeTask",value:function(e){Cbola._.remove(this.deferredTasksQueue,function(t){return"undefined"!=typeof t[3]&&o.getTaskName(t)===e})}},{key:"addExpBackoffTask",value:function(t){function o(){if(e.isArray(a))return a.shift();var t=a;return a=l>a?Math.floor(a)+1:a,1e3*Math.pow(t,2)}var n=t.fn,r=t.backoff,a=void 0===r?.6:r,s=t.maxBackoffGrowth,l=void 0===s?4:s,d=t.maxBackoffIterations,c=void 0===d?4:d,h=t.name,m=void 0===h?null:h;if("function"==typeof n){var p=1;c=e.isArray(a)?a.length+1:c,function e(){if(p>c||n(p,c===p)===!1)return void(m&&(i[m]=null));p+=1;var t=window.setTimeout(e,o());m&&(i[m]=t)}()}}},{key:"removeExpBackoffTask",value:function(e){var t=i[e];delete i[e],t&&clearTimeout(t)}}],[{key:"getTaskName",value:function(e){var t=e[3],i=e[0];return t?t:i?i.name?i.name:"function":""}}]),o}();return o.executeTask=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;e.apply(i,t)},new o}(),Cbola.Logger=Cbola.Logger||function(){function e(){var e=Date.now(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)});return t}function t(){function t(e){if(!(v.length<1||_))if(_=!0,"undefined"==typeof e&&(e=v.splice(0,Math.min(5,v.length)),e.retries=0),e.retries<Cbola.Logger.MAX_RETRIES_PER_LOG)if(0===e.retries)s(e);else{var i=Math.min(Math.pow(2,e.retries-1),16);setTimeout(function(){return s(e)},1e3*i)}else l("Logger -> Sending log to server failed "+Cbola.Logger.MAX_RETRIES_PER_LOG+" times, discarding log entry: {"+e+"}",Cbola.Logger.Levels.WARNING),_=!1,t()}function r(){y=Cbola.Env.clientVersion?", version: "+Cbola.Env.clientVersion:"";for(var e=0;e<u.length;e++){var i=u[e];a(i[0],i[1],i[2])}u=[],_||t()}function a(t,i,o){i+=""+Cbola.Logger.serverSuffix()+y+", uuid: "+e()+"]";var r={payload:{LogType:t===Cbola.Logger.Levels.ALWAYS_SEND_TO_SERVER?Cbola.Logger.Levels.ALERT:t,Message:i,MethodName:o||n.callingMethod,ClassName:"abtest_"+Cbola.Config.abTestId},level:t,retries:0};v.push(r)}function s(e){function o(){if(!n){n=!0,_=!1,e.retries++;var i=Math.min(Math.pow(2,e.retries-1),16);l("Logger -> Sending log to server failed ["+e.retries+"/"+Cbola.Logger.MAX_RETRIES_PER_LOG+"] ("+p.name+": "+p.message+"), retrying in "+i+" seconds...",Cbola.Logger.Levels.DEBUG),t(e)}}for(var n=!1,r=e.map(function(e){return e.payload}),a="",s=r.length-1;s>=0;s--){var d=r[s];1===e.retries?d.Message=d.Message.substring(0,d.Message.length-1)+", retries: "+e.retries+"]":e.retries>1&&(d.Message=d.Message.substring(0,d.Message.length-2)+e.retries+"]");for(var c in d)a+="Logs["+s+"]["+c+"]="+encodeURIComponent(d[c])+"&"}a=a.substr(0,a.length-1);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(4===h.readyState)if(200===h.status||204===h.status)l("Logger -> Log succesfully sent to server: { "+a+" }",Cbola.Logger.Levels.DEBUG_LOGGER),_=!1,t();else if(!n){n=!0,e.retries++;var i=Math.min(Math.pow(2,e.retries-1),16);l("Logger -> Sending log to server failed ["+e.retries+"/"+Cbola.Logger.MAX_RETRIES_PER_LOG+"] ("+h.status+": "+h.statusText+"), retrying in "+i+" seconds...",Cbola.Logger.Levels.DEBUG),_=!1,t(e)}};try{var m=w||Cbola.Config.Defaults.loggingServer+"AddLogs";if(i.isEmpty(Cbola.Config.Defaults.loggingServer)&&i.isEmpty(w))return void o();h.open("POST",m,!0),h.setRequestHeader("Content-type","application/x-www-form-urlencoded"),h.onerror=o,h.send(a)}catch(p){o()}}function l(){var e="CBOLA::",t=o.slice.call(arguments),n=t.length>1?t.pop():Cbola.Logger.DEFAULT_LEVEL;if(f>=n){if("[*]"===t[0]&&(e+=t[0],t.shift()),t[0]&&t[0].hasOwnProperty("LoggerColor")){e="%c"+e;var r=t.shift().style;t[0]=e+" "+t[0],t.splice(1,0,r)}else t.unshift(e);n<=Cbola.Logger.Levels.WARNING&&!i.isEmpty(Cbola.Logger.getInstance().callingMethod)&&(t.shift(),t.unshift(Cbola.Logger.getInstance().callingMethod+"(): "),t.unshift(e)),n===Cbola.Logger.Levels.WARNING?console.warn.apply(console,t):n===Cbola.Logger.Levels.ERROR||n===Cbola.Logger.Levels.CRITICAL?console.error.apply(console,t):console.log.apply(console,t)}}function d(e){return function(){var t=o.slice.call(arguments);if(null!==t&&0!==t.length){t.push(e);var i=Cbola.Logger.getInstance();return i.callingMethod="",i.log.apply(i,t),i}}}function c(e){return function(){var t=o.slice.call(arguments);if(null!==t){var i=t.shift();if(null!==i&&0!==t.length){var n=Cbola.Logger.getInstance();return n.callingMethod=i,t.push(e),n.log.apply(n,t),n}}}}function h(e){return function(){var t=o.slice.call(arguments);if(null!==t&&0!==t.length){t.push(e);var i=Cbola.Logger.getInstance();i.callingMethod="";var n=t.reduce(function(e,t){return e+" "+JSON.stringify(t)});return b.indexOf(n)>-1?i:(b.push(n),i.log.apply(i,t),i)}}}function m(e){return function(){var t=o.slice.call(arguments);if(null!==t){var i=t.shift();if(null!==i&&0!==t.length){var n=Cbola.Logger.getInstance();t.push(e),n.callingMethod=i;var r=t.reduce(function(e,t){return e+" "+JSON.stringify(t)});return b.indexOf(r)>-1?n:(b.push(r),n.log.apply(n,t),n)}}}}var p=!1,u=[],b=[],f=Cbola.Env&&Cbola.Env.DEBUG?Cbola.Logger.Levels.TRACE:Cbola.Logger.Levels.OFF,g=Cbola.Logger.Levels.ERROR,y="",v=[],w=null,_=!1;return{log:function(){var e=o.slice.call(arguments);if(null!==e&&0!==e.length){1===e.length&&e.push(Cbola.Logger.DEFAULT_LEVEL);var i=e[e.length-1],r=g>=i||i===Cbola.Logger.Levels.TRACE;
if(r&&e.unshift("[*]"),l.apply(n,e),r){e.shift(),e.pop(),e[0].hasOwnProperty("LoggerColor")&&e.shift();var s=e.reduce(function(e,t){return e+" "+JSON.stringify(t)});p?(a(i,s),_||t()):u.push([i,s,n.callingMethod])}return n}},alwaysSend:d(Cbola.Logger.Levels.ALWAYS_SEND_TO_SERVER),critical:d(Cbola.Logger.Levels.CRITICAL),error:d(Cbola.Logger.Levels.ERROR),warn:d(Cbola.Logger.Levels.WARNING),notify:d(Cbola.Logger.Levels.NOTICE),info:d(Cbola.Logger.Levels.INFO),debug:d(Cbola.Logger.Levels.DEBUG),trace:d(Cbola.Logger.Levels.TRACE),alwaysSendOnce:h(Cbola.Logger.Levels.ALWAYS_SEND_TO_SERVER),errorOnce:h(Cbola.Logger.Levels.ERROR),warnOnce:h(Cbola.Logger.Levels.WARNING),notifyOnce:h(Cbola.Logger.Levels.NOTICE),infoOnce:h(Cbola.Logger.Levels.INFO),debugOnce:h(Cbola.Logger.Levels.DEBUG),traceOnce:h(Cbola.Logger.Levels.TRACE),alwaysSendM:c(Cbola.Logger.Levels.ALWAYS_SEND_TO_SERVER),criticalM:c(Cbola.Logger.Levels.CRITICAL),errorM:c(Cbola.Logger.Levels.ERROR),warnM:c(Cbola.Logger.Levels.WARNING),notifyM:c(Cbola.Logger.Levels.NOTICE),alwaysSendOnceM:m(Cbola.Logger.Levels.ALWAYS_SEND_TO_SERVER),errorOnceM:m(Cbola.Logger.Levels.ERROR),warnOnceM:m(Cbola.Logger.Levels.WARNING),notifyOnceM:m(Cbola.Logger.Levels.NOTICE),enableServer:function(){p=!0,r()},set level(e){f=e},get level(){return f},set serverLevel(e){g=e},get serverLevel(){return g},get queue(){return v},set serverUrl(e){w=e},get serverUrl(){return w}}}var i=Cbola._,o=Cbola.Utils,n=void 0;return{getInstance:function(){return n||(n=t()),n}}}(),Cbola.Logger.MAX_RETRIES_PER_LOG=10,Cbola.Logger.Levels={ALWAYS_SEND_TO_SERVER:-999,ALERT:1,CRITICAL:2,ERROR:3,WARNING:4,NOTICE:5,INFO:6,DEBUG:7,TRACE:8,DEBUG_LOGGER:9,NONE:999},Cbola.Logger.DEFAULT_LEVEL=Cbola.Logger.Levels.INFO,Cbola.Logger.Colors={YELLOW:{LoggerColor:"yellow",style:"background: rgba(245, 210, 6, 1); color: black;font-size:13px"},RED:{LoggerColor:"red",style:"background: #8C0000; color: white;font-size:13px"},PALE_RED:{LoggerColor:"pale_red",style:"background: #FE4444; color: black;font-size:13px"},PALE_YELLOW:{LoggerColor:"pale_yellow",style:"background: rgb(250, 255, 202); color: black;font-size:13px"},PALE_GREEN:{LoggerColor:"pale_green",style:"background: rgb(229, 255, 215); color: black;font-size:13px"},PALE_BLUE:{LoggerColor:"pale_blue",style:"background: #98BDF1; color: black;font-size:13px"},PALE_PURPLE:{LoggerColor:"pale_purple",style:"color: #ce93d8;"},BLUE:{LoggerColor:"blue",style:"color: #2196f3;"},ORANGE:{LoggerColor:"orange",style:"color: rgb(255,140,0);"},GREEN:{LoggerColor:"green",style:"color: #0f9d58"}},Cbola.Env=Cbola.Env||{},Cbola.Env.domainId=Cbola.Env.domainId||0,Cbola.Env.activePid=Cbola.Env.activePid||0,Cbola.Env.wid=Cbola.Env.wid||0,Cbola.Logger.serverSuffix=Cbola._.memoize(function(){var e=Cbola.Utils.isMobile?"1":"0",t=Cbola.Utils.isTablet()?"1":"0";return"[did: "+Cbola.Env.domainId+", pid: "+Cbola.Env.activePid+", wid: "+Cbola.Env.wid+", pvid: "+Cbola.Env.PageProperties.cbola_pageViewId+", abtestid: "+Cbola.Config.abTestId+", ismobile: "+e+", istablet: "+t}),Cbola.Common=Cbola.Common||{},Cbola.Common.LocalStorageService=Cbola.Common.LocalStorageService||function(){var e=Cbola._,t=Cbola.Logger.Colors,i=Cbola.Logger.getInstance(),o=function(){var e="Cbola_test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(o){return i.info(t.PALE_RED,"localStorage is not available in this device"),!1}}(),n=o,r=function(e){return function(){if(n)try{for(var t=arguments.length,i=Array(t),o=0;t>o;o++)i[o]=arguments[o];return e.apply(this,i)}catch(r){}return null}},a=function(){};a.prototype={setItem:r(function(e,t){return!localStorage.setItem(e,t)}),getItem:r(function(e){return localStorage.getItem(e)}),removeItem:r(function(e){return!localStorage.removeItem(e)}),clear:function(){if(o)try{e.forEach(this.KEYS,function(e){return localStorage.removeItem(e)})}catch(t){}},setEnablement:function(e){n=o&&e}};var s=new a;return s.KEYS={CUID:"cbola_userId",CBOLA_ITEMS_HISTORY:"cbola_itemsArrayHistoryUser",ENABLE_TIMELINE:"cbola_timeline"},s}(),Cbola.Common=Cbola.Common||{},Cbola.Common.TimelineService=function(){var e=Cbola._,t=Cbola.Common.LocalStorageService,i=Cbola.Logger.getInstance(),o=.05,n=!e.isEmpty(t.getItem(t.KEYS.ENABLE_TIMELINE)),r=!e.isUndefined(window.performance&&window.performance.now),a=function(){this.counter=0,this.setEnabled(e.random(1,!0)<=o||n),this.isEnabled&&i.info(Cbola.Logger.Colors.BLUE,"TimelineService is active")};return a.prototype.mark=function(t,o){if(this.isEnabled){var n=performance.now();n=e.round(n,2);var r='timeline - "'+t+'" marked on: '+n+" ms ("+this.counter++ +")";i.alwaysSend(Cbola.Logger.Colors.BLUE,r),e.isUndefined(performance.mark)||performance.mark(t),o&&this.lastMark&&performance.measure&&performance.measure("cbola - "+t,this.lastMark,t),this.lastMark=t}},a.prototype.markStart=function(e){this.isEnabled&&this.mark(e+" started")},a.prototype.markEnd=function(e){if(this.isEnabled){this.mark(e+" completed");try{performance.measure&&performance.measure("cbola - "+e,e+" started",e+" completed")}catch(t){}}},a.prototype.record=function(e,t){return function(){Cbola.Common.TimelineService.markStart(t);for(var i=arguments.length,o=Array(i),n=0;i>n;n++)o[n]=arguments[n];e.apply(this,o),Cbola.Common.TimelineService.markEnd(t)}},a.prototype.setEnabled=function(e){this.isEnabled=r&&e},new a}(),Cbola.Common=Cbola.Common||{},Cbola.Common.CDN=Cbola.Common.CDN||function(){var e=Cbola._,t=Cbola.Env,i=Cbola.EventBus,o=Cbola.Utils,n=Cbola.Enums,r=Cbola.Config,a=Cbola.Common.TimelineService,s=Cbola.Logger.Colors,l=i.Events,d=Cbola.Logger.getInstance(),c="CDN",h=5e3,m=function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noOp,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=t.PageProperties.hostname,s=function(e){return function(){d.errorM(c+"."+r,"Request to CDN failed, due to: "+e+". path: "+a+" "+(navigator&&navigator.userAgent?", User Agent: "+navigator.userAgent:"")),n()}},l=new XMLHttpRequest;l.onload=function(){if(l.status>=200&&l.status<300){var e=JSON.parse(l.response);i(e)}else n()},l.open("GET",e,!0),l.timeout=h,l.onerror=s("error"),l.ontimeout=s("timeout"),l.send()};return{_getPageElements:function(h,p){return new Promise(function(u,b){function f(t){var r=e.get(t,"Status");1===r?(t.widgetId=h,o.updateEnv(t),"undefined"!=typeof t.PageId&&d.info(s.PALE_YELLOW,"Page Id: "+t.PageId),w.IsServerCall=t.IsServerCall=n.isServerCallTypes.FROM_CDN,a.markEnd(c+"."+g),i.fire(l.PAGE_ELEMENTS_DATA_RECEIVED,t),u(t)):r?(d.info(s.PALE_YELLOW,c+"."+g+" failed due to content server bad status: "+t.Status+". Not calling server."),Cbola.Common.AnalyticsService.setPageRequest(t.Status,n.isServerCallTypes.FROM_CDN),b(!0)):(d.info(c+"."+g+" returned bad response."),b())}var g="_getPageElements",y=t.activePid,v=t.domainId,w=t.PageProperties,_=""+r.Defaults.CDN+o.getCurrentAbTestId()+"/"+y+"/"+(0===v?"all":v)+"/"+w.urlHashMD5+"_"+w.urlHashSHA1+"_incontent_unified";w.isTablet?_+="_tablet":w.isMobile&&(_+="_mobile"),_+=0===parseInt(h)?"":"_"+h,_+=p?"_fallback_"+p:"",_+=".json",m(_,f,b,g)})},_getIndices:function(i,n,s,l,d){return new Promise(function(h,p){function u(t){var i=e.get(t,"Status");1===i?(a.markEnd(c+"."+g),h(t)):i?(Cbola.Common.AnalyticsService.setPageElementRequest({elementId:s,loadStatus:i}),h()):p()}var b=t.activePid,f=t.domainId,g="_getIndices",y=r.Defaults.EX_CDN+"GetIndices/"+(o.getCurrentAbTestId()+"/")+(b+"/")+((0===f?"all":f)+"/")+(i+"/")+(n+"/")+(d+"/")+l;m(y,u,p,g)})}}}(),Cbola.Common=Cbola.Common||{},Cbola.Common.UserService=function(){function e(){y[o.Language.english]={ad:"Ad",add:"add",addThisWidgetToYourSite:"add this widget to your site",addWidgetToYourSite:"add widget to your site",addThisToYourSite:"add this to your site",advertisement:"Advertisement",anotherQuiz:"another quiz",backToGame:"back to game",canYouBeatThat:"Can you beat that?",challenge:"Challenge",correct:"Correct",discoverTheMost:"Discover the most mind-blowing facts out there!",falseButton:"False",iScored:"I scored",nextQuiz:"Next quiz",playingIn:"playing in",promotedBy:"promoted by",poweredBy:"powered by",question:"Question",score:"Score",seconds:"seconds",skip:"Skip",start:"Start",startsIn:"starts in:",thankYouForPlaying:"Thank you for playing !",toYourSite:"to your site",trueButton:"True",trueOrFalse:"True or False?",upNext:"Up next: ",whatsNext:"whats next ?",wrong:"Wrong",youMayLike:"You May Like...",yourFriends:"your friends",yourScore:"Your score",YouScoredaFair:"You Scored a Fair",YouScoredaLame:"You Scored a Lame",YouScoredanAwesome:"You Scored an Awesome",YouScoredaMighty:"You Scored a Mighty",youScoredaPerfect:"You Scored a Perfect",YouScoredaRidiculous:"You Scored a Poor"},y[o.Language.spanish]={ad:"Anuncio",add:"Aade",addThisWidgetToYourSite:"Aade este widget a tu sitio",addWidgetToYourSite:"aade este widget a tu sitio",advertisement:"Publicidad",anotherQuiz:"otro juego",backToGame:"volver al juego",canYouBeatThat:"Puedes vencerme?",challenge:"Desafa",correct:"Correcto",discoverTheMost:"Descubre las curiosidades ms interesantes!",falseButton:"Falso",iScored:"Obtuve un puntaje de",nextQuiz:"Prximo Juego",playingIn:"jugando",question:"Pregunta",score:"Puntaje",seconds:"segundos",skip:"Omitir",start:"comienza",startsIn:"comienza en:",thankYouForPlaying:"gracias por jugar !",toYourSite:"a tu sitio",trueButton:"Verdadero",trueOrFalse:"Verdadero o Falso?",upNext:"Siguiente: ",wrong:"Incorrecto",youMayLike:"te puede interesar",yourFriends:"a tus amigos",yourScore:"Tu Puntaje",YouScoredaFair:"Tu Puntaje Final es",YouScoredaLame:"Tu Puntaje Final es",YouScoredanAwesome:"Tu Puntaje Final es",YouScoredaMighty:"Tu Puntaje Final es",youScoredaPerfect:"Tu Puntaje Final es",YouScoredaRidiculous:"Tu Puntaje Final es"},y[o.Language.portuguese]={ad:"anncio",advertisement:"publicidade",addThisWidgetToYourSite:"adicione este widget ao seu site",addWidgetToYourSite:"adicione este widget ao seu site",anotherQuiz:"outro jogo",backToGame:"voltar ao jogo",canYouBeatThat:"Voc pode me vencer?",challenge:"Desafie",correct:"Correto",falseButton:"Falso",iScored:"Obtive uma pontuao",nextQuiz:"Prximo Jogo",playingIn:"jogando",question:"Pergunta",score:"Pontuao",seconds:"segundos",skip:"pular",start:"comea",startsIn:"comea em:",thankYouForPlaying:"obrigado por jogar !",toYourSite:"ao seu site",trueButton:"Verdadeiro",trueOrFalse:"Verdadeiro ou Falso?",upNext:"Seguinte: ",wrong:"Incorreto",youMayLike:"voc pode se interessar",yourFriends:"os seus amigos",yourScore:"Sua Pontuao",YouScoredaFair:"Sua Pontuao Final ",YouScoredaLame:"Sua Pontuao Final ",YouScoredanAwesome:"Sua Pontuao Final ",YouScoredaMighty:"Sua Pontuao Final ",youScoredaPerfect:"Sua Pontuao Final ",YouScoredaRidiculous:"Sua Pontuao Final "},y[o.Language.russian]={ad:"",add:"",addThisWidgetToYourSite:"     ",advertisement:"",addWidgetToYourSite:"    ",anotherQuiz:" ",backToGame:"  ",canYouBeatThat:"   ?",challenge:" ",correct:"",falseButton:"",iScored:" ",nextQuiz:" ",playingIn:",  ",question:"",score:"",sconds:"",skip:"",start:"",startsIn:" ",thankYouForPlaying:"  ",toYourSite:"  ",trueButton:"",trueOrFalse:"  ?",upNext:"",whatsNext:" ",wrong:"",youMayLike:"  ",yourFriends:" ",yourScore:" ",YouScoredaFair:" ",YouScoredaLame:" ",YouScoredanAwesome:" ",YouScoredaMighty:" ",youScoredaPerfect:" ",YouScoredaRidiculous:" "},y[o.Language.french]={ad:"Publicit",advertisement:"Publicit",canYouBeatThat:"Tu peux me battre?",challenge:"Dfiez ",correct:"Correct",falseButton:"Faux",iScored:"J`ai totalis",nextQuiz:"Prochain quiz",playingIn:"en jouant au Quiz",question:"Question",score:"Score",start:"Dbut",trueButton:"Vrai",trueOrFalse:"Vrai ou Faux",wrong:"Incorrect",yourFriends:"Vos amis",yourScore:"Votre score",YouScoredaFair:"Votre score est de",YouScoredaLame:"Votre score est de",YouScoredanAwesome:"Votre score est de",YouScoredaMighty:"Votre score est de",youScoredaPerfect:"Votre score est de",YouScoredaRidiculous:"Votre score est de"},y[o.Language.german]={ad:"Werbung",advertisement:"Werbung"}}var t=Cbola._,i=Cbola.EventBus,o=Cbola.Config,n=Cbola.Common.LocalStorageService,r=n.KEYS,a=i.Events,s=Cbola.Logger.getInstance(),l="12345678",d="1234567",c=function(e){n.setEnablement(e),e||n.clear()},h=o.Language.english,m=r.CUID,p=r.CBOLA_ITEMS_HISTORY,u=!1,b="0",f=null,g=h,y={},v=null;e();var w=function(){this._vocabulary=y[h],b=n.getItem(m)||"0",c(!this.isEUUser()&&!this.isCAUser())};return w.prototype.getItemsHistory=function(){if(f)return f;var e=n.getItem(p);return e?f=t.split(e,","):["0"]},w.prototype.addItemsToHistory=function(e){var i=this.getItemsHistory(),o=e.reduce(function(e,t){return t&&e.push(t.toString()),e},[]);if(!t.isEmpty(o)){i&&(o=t.union(i,o)),f=o;var r=o.join(",");n.setItem(p,r)}},w.prototype.clearItemsHistory=function(){f=null,n.removeItem(p)},w.prototype.getUserId=function(){return b},w.prototype.isEUUserAsync=function(){var e=this;return u?Promise.resolve(this.isEUUser()):(v||(v=new Promise(function(t){i.addEventListener(a.USER_ID_SET,function(){t(e.isEUUser())})})),v)},w.prototype.setUserId=function(e){b=e,u=!0,c(!this.isEUUser()&&!this.isCAUser()),n.setItem(m,e),i.fire(a.USER_ID_SET)},w.prototype.isEUUser=function(){return b===l||"0"===b},w.prototype.isCAUser=function(){return b===d||"0"===b},w.prototype.getLanguage=function(){return g},w.prototype.setLanguage=function(e){e!==g&&(y.hasOwnProperty(e)?(g=e,this._vocabulary=y[g]):s.warnM("UserService.setLanguage","UserService Failed to set language: "+e))},w.prototype.vocabulary=function(){for(var e=this,t=arguments.length,i=Array(t),o=0;t>o;o++)i[o]=arguments[o];var n=i.length;return i.reduce(function(t,i,o){return""+t+e.getWard(i)+(o!==n-1?" ":"")},"")},w.prototype.getWard=function(e){return this._vocabulary[e]||y[h][e]||""},w.prototype.wasItemAlreadyViewed=function(e){if(e.IgnoreUserHistory)return!1;var t=e.ParentId?e.ParentId:e.Id;return this.getItemsHistory().indexOf(t.toString())>-1},w.prototype.dictionaryReport=function(){var e={},i=t.keys(y[h]);return t.forEach(y,function(o,n){n!==h&&(e[n]=t.difference(i,t.keys(o)))}),e},new w}(),Cbola.Common=Cbola.Common||{},Cbola.Common.RequestHandler=function(){var _=Cbola._,Config=Cbola.Config,EventBus=Cbola.EventBus,Utils=Cbola.Utils,CDN=Cbola.Common.CDN,TimeLine=Cbola.Common.TimelineService,UserService=Cbola.Common.UserService,Enums=Cbola.Enums,LoggerColors=Cbola.Logger.Colors,isServerCallTypes=Enums.isServerCallTypes,LoadStatusTypes=Enums.LoadStatusTypes,PageRequestTypes=Enums.PageRequestTypes,ProductTypes=Enums.ProductTypes,Logger=Cbola.Logger.getInstance(),MAX_RETRIES=10,CLASS_NAME="RequestHandler",parseJSON=function(e){return e.json()},checkStatus=function(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t},RequestHandler=function(){};return RequestHandler.prototype.dispatch=function(){for(var e=this,t=arguments.length,i=Array(t),o=0;t>o;o++)i[o]=arguments[o];return this.dispatchCDN.apply(this,i).catch(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1;return t?Promise.reject():e.dispatchServer.apply(e,i)})},RequestHandler.prototype.dispatchCDN=function(){for(var e=arguments.length,t=Array(e),i=0;e>i;i++)t[i]=arguments[i];var o=t.shift();return _.isFunction(CDN[o])?(TimeLine.markStart("CDN."+o),CDN[o].apply(CDN,t)):Promise.reject()},RequestHandler.prototype.dispatchServer=function(){for(var e=arguments.length,t=Array(e),i=0;e>i;i++)t[i]=arguments[i];var o=t[0];return TimeLine.markStart(CLASS_NAME+"."+o),this.promiseWithRetry.apply(this,t.concat([0]))},RequestHandler.prototype.promiseWithRetry=function(){for(var e=this,t=arguments.length,i=Array(t),o=0;t>o;o++)i[o]=arguments[o];var n="promiseWithRetry",r=_.first(i),a=_.last(i);return this[r].apply(this,i.slice(1)).catch(function(e){return new Promise(function(t,i){if(a>=MAX_RETRIES||_.isError(e))i(e);else{var o=Math.min(Math.pow(2,a),16);o=1===o?250:1e3*o,Logger.warnM(CLASS_NAME+"."+n+r,r+"() failed, retrying in "+o/1e3+" seconds... ("+a+"/"+MAX_RETRIES+")"),setTimeout(function(){return i(e)},o)}})}).catch(function(t){return _.isError(t)?(Logger.errorM(CLASS_NAME+"."+n+r,CLASS_NAME+"."+n+" failed firing "+r+"(). due to error: ",t),Promise.reject(t)):a>=MAX_RETRIES?(Logger.errorM(CLASS_NAME+"."+n+r,CLASS_NAME+"."+n+" failed firing "+r+"() after "+MAX_RETRIES+" errors."),_.isFunction(t)&&t(),Promise.reject()):(i.splice(-1,1,a+1),e.promiseWithRetry.apply(e,i))})},RequestHandler.prototype.getPageElements=function(e,t){return this.dispatch("_getPageElements",e,t)},RequestHandler.prototype.getMoreContent=function(e){return this.dispatch("_getMoreContent",e)},RequestHandler.prototype.getAds=function(e,t,i){return this.dispatch("_getAds",e,t,i)},RequestHandler.prototype.getLayerScript=function(e){return this.dispatch("_getLayerScript",e)},RequestHandler.prototype.getJsBundle=function(e){return this.dispatch("_getJsBundle",e)},RequestHandler.prototype.getIndices=function(e,t,i,o,n){return this.dispatch("_getIndices",e,t,i,o,n)},RequestHandler.prototype._getPageElements=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o="_getPageElements",n=Cbola.Env,r=n.PageProperties,a=n.categoryId,s=n.tags,l=n.title,d=n.body,c=function(e){_.isNil(e)||Cbola.Common.AnalyticsService.setPageRequest(e,isServerCallTypes.FROM_SERVER)},h=Utils.initPayload();return h=_.extend(h,{WidgetId:parseInt(e),CategoryId:a,FallbackMinimalWidth:t||0,Tags:s,Title:l,Body:d}),_.isEmpty(r.SrcUrl)||(h.SrcUrl=r.SrcUrl),Logger.info("getPageElements start. json: ",h),new Promise(function(t,n){fetch(Config.Defaults.queryServer+"GetInContentInfo",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(h)}).then(checkStatus).then(parseJSON).then(function(a){a.widgetId=e,Utils.updateEnv(a),r.IsServerCall=isServerCallTypes.FROM_SERVER,1===a.Status?("undefined"!=typeof a.PageId&&Logger.info(LoggerColors.PALE_YELLOW,"Page Id: "+a.PageId),i>0&&Logger.alwaysSendM(CLASS_NAME+"."+o,CLASS_NAME+"."+o+" succeeded on "+i+" attempts. url: "+r.originalPathNameHost+", pageviewid: "+r.cbola_pageViewId),a.IsServerCall=r.IsServerCall,TimeLine.markEnd(CLASS_NAME+"."+o),EventBus.fire(EventBus.Events.PAGE_ELEMENTS_DATA_RECEIVED,a),t(a)):2===a.Status||3===a.Status?n(function(){c(a.status)}):(c(a.Status),n(new Error("Content server bad status: "+a.Status+". URL: "+r.originalPathNameHost)))}).catch(function(){n(function(){c(PageRequestTypes.INITIALIZE_FAILED)})})})},RequestHandler.prototype._getMoreContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Logger.info(LoggerColors.PALE_GREEN,"Start to GetMoreContent for elementId"+e.ElementId+": "+Utils.getRunTimeInMilis());var i={UserId:UserService.getUserId(),UserHistory:UserService.getItemsHistory()};_.extend(e,i);var o=_.isEmpty(e.CurrentSession);o&&(e.CurrentSession=[0]);var n=_.extend(Utils.initPayload(),e);return new Promise(function(i,r){fetch(Config.Defaults.queryServer+"GetMoreContent",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:Utils.encodePayload(n)}).then(checkStatus).then(parseJSON).then(function(o){_.isEmpty(o)?0===t?(UserService.clearItemsHistory(),r()):r(new Error("Failed to get more content after history cleaning")):(Logger.info(LoggerColors.PALE_GREEN,"End of GetMoreContent for elementId"+e.ElementId+": "+Utils.getRunTimeInMilis()),TimeLine.markEnd(CLASS_NAME+"._getMoreContent"),i(o))}).catch(function(e){return r(3===t&&o||e)})})},RequestHandler.prototype._getAds=function(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n="_getAds",r=Cbola.Env,a=r.PageProperties,s=r.PageId,l=r.activePid,d=r.Domain,c=r.Category,h={PageId:s,PublisherPublicKey:l,UrlData_Url:a.hostname,UrlData_Hash_128_Bit:a.urlHashMD5,UrlData_Hash_160_Bit:a.urlHashSHA1,AbTestId:Config.abTestId,ProductType:ProductTypes.IN_CONTENT,WidgetId:e,LayoutTypes:[i],IsMobile:a.isMobile,IsTablet:a.isTablet,DomainId:d,CategoryId:c,IsSsl:/https:/gi.test(document.location.protocol)},m=function(e){_.isNil(e)||Cbola.Common.AnalyticsService.setPageElementRequest({elementId:t,loadStatus:e})};return new Promise(function(e,i){var r=new Promise(function(e,t){setTimeout(function(){var e=new Error("request timeout");e.isTimeout=!0,t(e)},1e3*Config.timeouts.getAdsRequest)}),s=fetch(""+Config.Defaults.adServer+Config.Defaults.adServer_method,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:Utils.encodePayload(h)});Promise.race([r,s]).then(checkStatus).then(parseJSON).then(function(r){1===r.Status?(o>0&&Logger.alwaysSendM(CLASS_NAME+"."+n,CLASS_NAME+"."+n+" succeeded on "+o+" attempts. url: "+a.originalPathNameHost+", pageviewid: "+a.cbola_pageViewId),TimeLine.markEnd(CLASS_NAME+"."+n),EventBus.fire(EventBus.Events.GET_ADS_READY,{elementId:t,data:r}),e(r)):i(new Error("Ad server bad status: "+r.Status+". url: "+a.originalPathNameHost+", pageviewid: "+a.cbola_pageViewId))}).catch(function(e){var t=null;500===_.get(e,"request.status")?t=LoadStatusTypes.AD_SERVER_DOWN:e.isTimeout?t=LoadStatusTypes.GET_ADS_MAX_RETRY:_.isNil(e.request)&&(t=LoadStatusTypes.GET_ADS_FAILED),2===o&&m(t),i(function(){return m(t)})})})},RequestHandler.prototype._getLayerScript=function(layerType){var _retryAttempt=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise(function(resolve,reject){var METHOD="_getLayerScript",url=Cbola.Env.clientPath+"container/layer_"+layerType+"/cbola_layer_"+layerType+Cbola.Env.clientPathType+".js",xhttp=new XMLHttpRequest,onFailure=function(e){(0===_retryAttempt||2===_retryAttempt)&&Logger.alwaysSendM(CLASS_NAME+"."+METHOD,"Failed getting script for layer "+layerType+" on attempt: "+(_retryAttempt+1)+" due to: "+_.get(e,"message","")+". URL: "+Cbola.Env.PageProperties.originalPathNameHost),reject()};xhttp.onload=function(){200===xhttp.status&&xhttp.response?(eval(xhttp.response),TimeLine.markEnd(CLASS_NAME+"."+METHOD),resolve()):onFailure(new Error("response status "+xhttp.status))},xhttp.open("GET",url,!0),xhttp.onerror=onFailure,xhttp.send()})},RequestHandler.prototype._getJsBundle=function(filename){return new Promise(function(resolve,reject){var METHOD="_getJsBundle",url=""+Cbola.Env.clientPath+filename;if(Cbola.Env.DEBUG){var script=document.createElement("script");script.onload=function(){TimeLine.markEnd(CLASS_NAME+"."+METHOD),resolve()},script.onerror=function(){reject(new Error("Failed loading path: "+filename+" by script tag attachment"))};var node=document.querySelector("script");node.parentNode.insertBefore(script,node),script.src=url}else{var logJSBundleLoadFailure=function(){Logger.errorM(CLASS_NAME+"."+METHOD,CLASS_NAME+"."+METHOD+" failed loading file from path "+filename)},xhttp=new XMLHttpRequest;xhttp.onload=function(){200===xhttp.status&&xhttp.response?(eval(xhttp.response),TimeLine.markEnd(CLASS_NAME+"."+METHOD),resolve()):reject(logJSBundleLoadFailure)},xhttp.open("GET",url,!0),xhttp.onerror=function(){reject(logJSBundleLoadFailure)},xhttp.send()}})},RequestHandler.prototype._getIndices=function(e,t,i,o,n){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a="_getIndices",s=Cbola.Env,l=s.activePid,d=s.DEBUG,c=s.domainId,h=s.PageProperties,m=function(e){_.isNil(e)||Cbola.Common.AnalyticsService.setPageElementRequest({elementId:i,loadStatus:e})},p={AbTestId:Utils.getCurrentAbTestId(),Did:c,IndicesPerPage:n,LocationID:e,Language:t,Pid:l,Wid:parseInt(o)};return d&&(p.Debug=!0),Logger.info("getIndices start. payload: ",p),new Promise(function(e,t){fetch(Config.Defaults.extraContent+"GetIndices",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(p)}).then(checkStatus).then(parseJSON).then(function(i){h.IsServerCall=i.IsServerCall=isServerCallTypes.FROM_SERVER,1===i.Status?(r>0&&Logger.alwaysSendM(CLASS_NAME+"."+a,CLASS_NAME+"."+a+" succeeded on "+r+" attempts. url: "+h.originalPathNameHost+", pageviewid: "+h.cbola_pageViewId),TimeLine.markEnd(CLASS_NAME+"."+a),e(i)):(m(i.Status),t(new Error("External content server bad status: "+i.Status+". URL: "+h.originalPathNameHost)))}).catch(function(){m(LoadStatusTypes.EXTERNAL_CONTENT_FAILED),t(new Error("External content server failed. URL: "+h.originalPathNameHost))})})},new RequestHandler}(),Cbola.Common=Cbola.Common||{},Cbola.Common.AnalyticsService=function(){function e(e){return e.json()}function t(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}function i(e){var t={ClientVersion:m.clientVersion,PageViewId:m.PageProperties.cbola_pageViewId,PageId:m.PageId,UserId:l.getUserId(),PublisherId:m.activePid,Second:h.getRunTimeInSecs(),categoryId:m.Category,domainId:m.Domain,IsMobile:m.PageProperties.isMobile,IsTablet:m.PageProperties.isTablet,isPortrait:m.PageProperties.isPortrait,AbTestId:u.abTestId};return e&&p.extend(t,e),p.defaults(t,g),t}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.analyticsName,n=e.additionalParams,a=e.analyticsData,s=void 0===a?null:a,l=e.onError,p=void 0===l?!1:l,b=e.onSuccess,f=void 0===b?!1:b,g=e.includeCredentials,y=void 0===g?!1:g;d.info(c.PALE_PURPLE,r+"::"+o),s||(s=i(n));var v={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:h.encodePayload(s)};y&&(v.credentials="include"),fetch(""+u.Defaults.analyticsServer+o,v).then(t).then(function(e){d.info(c.PALE_PURPLE,"fired "+o+" analytics to server.",s),m.DEBUG&&console.table&&s.Items&&console.table(s.Items),f&&f(e)}).catch(function(e){p?p(e.response):d.trace(c.PALE_RED,o+" failed.")})}function n(e){if(f){var o="SetHbBidRequestProto",n=window.Cbola.protobuf;p.isNil(v.myRoot)&&(v.myRoot=new n.Root,n.Root.fromJSON(v.SetHBBidRequestProto,v.myRoot),v.SetHBBidRequestMessage=v.myRoot.lookupType("SetHbBidRequestParams"));var s=i({ProductType:a.ProductTypes.IN_CONTENT});s.DomainId=s.domainId,delete s.domainId,s.CategoryId=s.categoryId,delete s.categoryId,s.PageId=n.util.LongBits.fromNumber(s.PageId).toLong();var l={base:s,BidRequests:e},h=v.SetHBBidRequestMessage.verify(l);if(h)return void d.errorM(r+"."+o,o+" failed on message verification, error: "+h);var m=v.SetHBBidRequestMessage.create(l),b=v.SetHBBidRequestMessage.encode(m).finish(),g={method:"POST",headers:{"Content-Type":"text/plain;charset=UTF-8"},body:b};fetch(""+u.Defaults.analyticsServer+o,g).then(t).then(function(){return d.info(c.PALE_PURPLE,"fire "+o+" analytics to server. payload: ",l)}).catch(function(){return d.trace(o+" failed.")})}}var r="AnalyticsService",a=Cbola.Enums,s=a.SetClickTypes,l=Cbola.Common.UserService,d=Cbola.Logger.getInstance(),c=Cbola.Logger.Colors,h=Cbola.Utils,m=Cbola.Env,p=Cbola._,u=Cbola.Config,b=Cbola.Common.RequestHandler,f=100*Math.random()<=1,g={WidgetId:0,PageId:0,PageViewId:0,PublisherId:0,UserId:0,categoryId:0,domainId:0},y=function(e,t,i){var o=Cbola.InContent.Manager.getLayerByElementId(e);return{ElementId:e,Ads:[{TagId:t,ProviderId:"",TriggerType:i}],WidgetId:o.widgetId,ProductType:a.ProductTypes.IN_CONTENT,LayoutType:o.type,ItemType:o.itemType,HbToken:o.hbToken}},v=function(){};v.prototype.setPageRequest=function(t,i,n){function r(t){e(t).then(function(e){var t=p.get(e,"UserId","0");m.userId=t,l.setUserId(t),d.info(c.PALE_PURPLE,b+" -> UserId: "+m.userId)})}function s(){l.setUserId("0"),d.trace(c.PALE_RED,b+" failed to set user Id")}var b="SetPageRequestGeo";m.PageStatus=t;var f=0;try{f=Math.floor(100*Math.abs(m.PageProperties.secondGlobal/1e3))/100}catch(g){}var y=0;try{0!==m.PageProperties.publisherScriptExecutionTime&&null!==m.PageProperties.publisherScriptExecutionTime&&(y=Math.floor(100*Math.abs((m.PageProperties.publisherScriptExecutionTime-window.performance.timing.connectStart)/1e3))/100)}catch(g){}var v={PageStatus:t,IsServerCall:i,SecondFromPageLoad:y,SecondGlobal:f,WidgetId:m.widgetId,ScriptDomainId:m.domainId,IntegrationType:m.IntegrationType||0,ProductType:a.ProductTypes.IN_CONTENT};!n||t!==a.PageRequestTypes.DIV_TOO_SMALL&&t!==a.PageRequestTypes.HIDDEN_IFRAME?(v.ScreenWidth=m.topWindow.innerWidth,v.ScreenHeight=m.topWindow.innerHeight):(v.ScreenHeight=n.height,v.ScreenWidth=n.width),h.isInIframe()&&!h.isWindowTopSupported()||p.isEmpty(window.top.document.referrer)||(v.ReferrerURL=window.top.document.referrer),u.ignoreQueryString&&(v.QueryString=encodeURIComponent(u.queryString)),o({analyticsName:b,additionalParams:v,onError:s,onSuccess:r,includeCredentials:!0})},v.prototype.setAdsRequest=function(e,t,i,n){var r=["qzlt87","dctn68","sngl16","dvds77"],a=-1!==r.indexOf(Cbola.Env.activePid)||100*Math.random()<=10;if(a){var s=y(e,t,i);"undefined"!=typeof n&&(s.HbCpm=n),o({analyticsName:"SetAdsRequest",additionalParams:s})}},v.prototype.setBlockedAdRequest=function(e,t,i){var n=y(e,t,i);o({analyticsName:"SetBlcAr",additionalParams:n})},v.prototype.setPageElementRequest=function(e){var t=e.elementId,n=e.layer,r=e.loadStatus,s=e.isServerCall;if(n?t=n.elementId:t&&(n=Cbola.InContent.Manager.getLayerByElementId(t)),!p.isNil(n)&&r){var l=null;try{m.PageProperties.secondGlobal>0&&(l=h.getRunTimeInSecs()+Math.floor(100*Math.abs(m.PageProperties.secondGlobal/1e3))/100)}catch(d){}var c={ElementId:t,LoadStatus:r,PageStatus:m.PageProperties.PageStatus,IsServerCall:p.get(n,"data.IsServerCall",s),Width:n.container?n.container.offsetWidth:0,Height:n.container?n.container.offsetHeight:0,WidgetId:n.widgetId,ItemType:n.itemType||0,LayoutType:n.type||0,ProductType:a.ProductTypes.IN_CONTENT,HbToken:n.hbToken,SecondGlobal:l},u=h.getDocumentHeight();null!==u&&(c.PageHeight=u||0);var b=h.getElementPixelsFromTop(n.element);null!==b&&(c.PixelsFromTop=b||-1),c=i(c),o({analyticsName:"SetPageElementsRequestNew",analyticsData:{Elements:[c]}})}},v.prototype.setPageElementView=function(e,t,i,n){var r=Cbola.InContent.Manager.getLayerByElementId(e);if(!p.isNil(r)){var s={ElementId:r.elementId,ElementViewId:p.isFunction(r.getViewId)?r.getViewId():0,TeaserType:0,OpenType:t,CloseType:i,WidgetId:r.widgetId,LayoutType:r.type,ProductType:a.ProductTypes.IN_CONTENT,Duration:p.isUndefined(n)?r.isViewable()?0:r.getViewDuration():n,HbToken:r.hbToken};o({analyticsName:"SetPageElementView",additionalParams:s})}},v.prototype.setClick=function(e,t,i){if(!h.isGoogleWebLightAgent()){var n=Cbola.InContent.Manager.getLayerByElementId(e),r=0;i&&(r=i.Id,n.isMobile()||t!==s.SHARE_AFTER_TWITTER&&t!==s.SHARE_AFTER_FACEBOOK||(r=i.ParentId)),o({analyticsName:"SetClick",additionalParams:{ElementId:e,ElementViewId:p.result(n,"getViewId",0),ClickType:t,ItemId:r,WidgetId:n.widgetId,LayoutType:n.type,ProductType:a.ProductTypes.IN_CONTENT,HbToken:n.hbToken}})}},v.prototype.setClientError=function(e){o({analyticsName:"SetClientError",additionalParams:{Url:window.location.href.toLowerCase(),FileName:e.filename,Line:e.lineno,Col:e.colno,ErrorMessage:e.message,Type:e.type}})},v.prototype.setPageClose=function(){var e="SetPageClose";d.info(c.PALE_PURPLE,r+"::"+e);var t=i();fetch(""+u.Defaults.analyticsServer+e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:h.encodePayload(t),cache:"no-cache"}).then(function(i){if(200!==i.status&&204!==i.status)throw new Error("Invalid Response Status.");d.info(c.PALE_PURPLE,"fired "+e+" analytics to server.",t),m.DEBUG&&console.table&&t&&console.table(t)}).catch(function(t){d.trace(c.PALE_RED,e+" failed. Due to error: "+t)})},v.prototype.setItemsView=function(e,t){var i=Cbola.InContent.Manager.getLayerByElementId(e);if(!p.isNil(i)){var n={ElementId:e,ElementViewId:p.result(i,"getViewId",0),
Items:p.map(t,function(e){return{Id:e.Id||0,OpenType:e.openType,CloseType:e.closeType,DisplayOrder:e.displayOrder,ViewOrder:e.viewOrder,Duration:e.isViewable?0:e.getViewableDuration(),AnswerId:e.userAnswerId}}),WidgetId:i.widgetId,LayoutType:i.type,HbToken:i.hbToken};o({analyticsName:"SetItemsView",additionalParams:n})}},v.prototype.setConsentStatus=function(e){o({analyticsName:"SetConsentStatus",additionalParams:{ConsentStatus:e}})},v.prototype.setClickTracker=function(e){var t="SetClickTracker";d.info(c.PALE_PURPLE,r+"::"+t),e?fetch(e).then(function(){d.info(c.PALE_PURPLE,r+"."+t+" succeeded for url: "+e)}):d.trace(r+".setClickTracker",r+".setClickTracker failed to set URL for click tracker")},v.prototype.setLastMile=function(e){var i="SetLastMile";d.info(c.PALE_PURPLE,r+"::"+i);var o={public_key:m.activePid,domain_id:m.Domain,product_type:a.ProductTypes.IN_CONTENT,is_mobile:m.PageProperties.isMobile?1:0};p.extend(o,e);var n=""+u.Defaults.analyticsServer+i+"?"+p.reduce(o,function(e,t,i){return""+e+(e?"&":"")+i+"="+t},"");fetch(n,{method:"GET"}).then(t).then(function(){d.info(c.PALE_PURPLE,"fired "+i+" analytics to server.",o)}).catch(function(){d.trace(c.PALE_RED,i+" failed.")})},v.pendingProtoBufCalls=[],v.myRoot=null,v.SetHBBidRequestMessage=null,v.SetHBBidRequestProto={nested:{SetHbBidRequestParams:{fields:{base:{type:"Base",id:1},BidRequests:{rule:"repeated",type:"HbBidRequest",id:2}},nested:{Base:{fields:{ClientVersion:{type:"string",id:1},PageViewId:{type:"string",id:2},PageId:{type:"int64",id:3},DomainId:{type:"int32",id:4},CategoryId:{type:"int32",id:5},PublisherId:{type:"string",id:6},AbTestId:{type:"int32",id:7},UserId:{type:"string",id:8},Second:{type:"float",id:9},ProductType:{type:"ProductTypeEnum",id:10},IsMobile:{type:"bool",id:11},IsTablet:{type:"bool",id:12},isPortrait:{type:"bool",id:13},WidgetId:{type:"int32",id:14},HbToken:{type:"string",id:15},SecondGlobal:{type:"float",id:16}},nested:{ProductTypeEnum:{values:{Unknown:0,InImage:1,InContent:2,AnayticsScript:3}}}},HbBidRequest:{fields:{TagId:{type:"int32",id:1},Cpm:{type:"float",id:2},Duration:{type:"float",id:3},Status:{type:"int32",id:4},TimeInPocket:{type:"float",id:5},AuctionCpm:{type:"float",id:6},PocketCpm:{type:"float",id:7},TimeToRespond:{type:"float",id:8},PocketUsageType:{type:"PocketUsageTypeEnum",id:9},PocketSizeHT:{type:"int32",id:10},PocketSizeLT:{type:"int32",id:11}},nested:{PocketUsageTypeEnum:{values:{Unknown:0,FromAuction:1,FromHighTierPocket:2,FromLowTierPocket:3}}}}}}}},v.prototype.setHbBidRequestProto=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];window.Cbola.protobuf?n(e):(w(),v.pendingProtoBufCalls.push(e))};var w=p.once(function(){b.getJsBundle("external/protobuf.min.js").then(function(){for(;v.pendingProtoBufCalls.length>0;)n(v.pendingProtoBufCalls.shift())}).catch(h.noOp)});return new v}(),Cbola.Common=Cbola.Common||{},Cbola.Common.ConsentProviders=Cbola.Common.ConsentProviders||{},Cbola.Common.ConsentProviders._Base=Cbola.Common.ConsentProviders._Base=function(){var e=Cbola._,t=Cbola.Logger.getInstance(),i=.5,o=32,n=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i;t()?n():setTimeout(function(){return e(t,n,Math.min(2*r,o))},1e3*r)},r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ConsentProviderBase";this.initialized=!1,this.name=e};return r.prototype={_waitForProvider:function(i){var o=this,r=void 0;return this.initialized?e.isFunction(i)||(r="Tester is not a function"):r="Not initialized",r?(t.errorM(this.name+"._waitForProvider",this.name+"._waitForProvider:: "+r),Promise.reject(new Error(r))):new Promise(function(e){n(i,function(){e(o)})})},init:function(){this.initialized=!0},getProviderPromise:function(){return Promise.reject("getProviderAsync not implemented")},hasConsentPromise:function(){return Promise.reject("testConsentAsync not implemented")}},r}(),Cbola.Common=Cbola.Common||{},Cbola.Common.ConsentProviders=Cbola.Common.ConsentProviders||{},Cbola.Common.ConsentProviders.GoogleFC=Cbola.Common.ConsentProviders.GoogleFC||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Common.AnalyticsService,o=Cbola.Common.ConsentProviders._Base,n=Cbola.Enums,r=n.ConsentStatusTypes,a=null,s=null,l=null,d=null,c=function(){var e=t.isInIframe();return e&&t.isWindowTopSupported()?a=window.top:e||(a=window),!!a},h=function(){return!s&&a&&a.googlefc&&(s=a.googlefc,i.setConsentStatus(r.GOOGLE_FUNDING_CHOICES_FOUND)),!!s},m=function(t){var o=e.get(s,"ConsentStatusEnum",{}),n=t!==o.CONTRIBUTOR&&t!==o.NO_CONSENT;return i.setConsentStatus(t),n},p=function(){o.call(this,"GoogleFC")};return p.prototype=Object.create(o.prototype),p.constructor=p,p.prototype.init=function(){this.initialized=c()},p.prototype.getProviderPromise=function(){return l||(l=this._waitForProvider(h)),l},p.prototype.hasConsentPromise=function(){if(!d){var t=e.result(s,"getConsentStatus",-1);d=-1!==t?m(t)?Promise.resolve():Promise.reject():new Promise(function(t,i){s.callbackQueue.push(function(){m(e.result(s,"getConsentStatus",-1))?t():i()})})}return d},new p}(),Cbola.Common=Cbola.Common||{},Cbola.Common.ConsentProviders=Cbola.Common.ConsentProviders||{},Cbola.Common.ConsentProviders.StandardCMP=Cbola.Common.ConsentProviders.StandardCMP||function(){var e=Cbola.Common.AnalyticsService,t=Cbola.Common.ConsentProviders._Base,i=Cbola.Enums,o=i.ConsentStatusTypes,n=null,r=null,a=null,s=function t(){for(var i=window;!n&&!r;){try{n=i.__cmp,r=i.frames["__cmpLocator"]}catch(a){}if(i===window.top)break;i=i.parent}var t=!(!n&&!r);return t&&e.setConsentStatus(o.IAB_STANDARD_CMP_FOUND),t},l=function(){t.call(this,"StandardCMP")};return l.prototype=Object.create(t.prototype),l.constructor=l,l.prototype.getProviderPromise=function(){return a||(a=this._waitForProvider(s)),a},l.prototype.hasConsentPromise=function(){return Promise.resolve()},new l}(),Cbola.Common=Cbola.Common||{},Cbola.Common.ConsentProviders=Cbola.Common.ConsentProviders||{},Cbola.Common.ConsentProviders.Manager=Cbola.Common.ConsentProviders.Manager||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Common.ConsentProviders.GoogleFC,o=Cbola.Common.ConsentProviders.StandardCMP,n={gfc:i,cmp:o},r=void 0,a=void 0,s=function(){this.activeProviders={}};return s.prototype={init:function(t){var i=this;e.extend(t,{cmp:!0}),e.forEach(t,function(e,t){e&&n[t]&&(i.activeProviders[t]=n[t],i.activeProviders[t].init())})},consentProviderFound:function(){if(!r){var t=e.map(this.activeProviders,function(e){return e.getProviderPromise()});r=Promise.race(t)}return r},hasConsent:function(){return a||(a=this.consentProviderFound().then(function(e){return e.hasConsentPromise()},t.noOp)),a}},new s}(),Cbola.Globals=Cbola.Globals||{},Cbola.Globals.AdsService=function(){var e=Cbola.Logger.getInstance(),t=window;try{window.top.document&&(t=window.top)}catch(i){}var o={},n={},r={},a=!1,s=function(){};s.prototype={registerLayerManager:function(t,i,o){if(n.hasOwnProperty(o)&&n[o])return void e.errorM("AdsService.registerLayerManager","Cbola.Globals.AdsService failed, trying to assign ad triggers manager to the same element ID.");if(n[o]=t,r[o]=i,this.onlyOneRegistration)for(var a in n)n.hasOwnProperty(a)&&a!==o.toString()&&this.unRegisterLayerManager(a)},unRegisterLayerManager:function(e){n.hasOwnProperty(e)&&n[e]&&(n[e].endAdsProcess(),delete n[e],delete r[e])},getTriggersManagerByElementId:function(e){return n[e]},getAllTriggersManagers:function(){return n},getAdsStoreByElementId:function(e){return r[e]},freezeAds:function(){for(var e in n)this.freezeAdsByElementId(e)},freezeAdsByElementId:function(e){n.hasOwnProperty(e)&&n[e]&&n[e].freezeAdsState()},addSovrnBeacon:function(i){try{if(!a&&i&&i.SovrnBeaconSrc&&i.SovrnBeaconId){a=!0;var o=t.document.createElement("script");o.id=i.SovrnBeaconId;var n=t.document.getElementsByTagName("head")[0];n&&(n.appendChild(o),o.src=i.SovrnBeaconSrc)}}catch(r){e.alwaysSendM("AdsService.addSovrnBeacon","Sovrn beacon injection failed.")}}};try{t!==window?(t.Cbola=t.Cbola||{},t.Cbola.Globals=t.Cbola.Globals||{},t.Cbola.Globals.AdsService=t.Cbola.Globals.AdsService||new s,o=t.Cbola.Globals.AdsService):o=new s}catch(l){o=new s,e.errorM("AdService","Failed to add AdService initialization process")}return o}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.VisibilityObserver=Cbola.Common.VisibilityObserver||function(){var e=Cbola.EventBus,t=Cbola.Utils,i=e.Events,o=function(){function o(){_classCallCheck(this,o),this.visible=null,this.initialized=!1}return _createClass(o,[{key:"init",value:function(){if(!this.initialized&&this.addVisibilityEvents()){var e=t.getCompatibleVisibilityAPI(),i=e.hidden;this.visible=!document[i],this.initialized=!0}}},{key:"addVisibilityEvents",value:function(){var e=this,i=t.getCompatibleVisibilityAPI(),o=i.hidden,n=i.changeEventName;if(o)try{return document.addEventListener(n,function(){e.updateVisibility(!document[o])}),!0}catch(r){}return!1}},{key:"updateVisibility",value:function(t){t!==this.visible&&(this.visible=t,e.fire(i.PAGE_VISIBILITY_CHANGE,t))}},{key:"isVisible",value:function(){return this.visible}}]),o}();return new o}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.FocusObserver=Cbola.Common.FocusObserver||function(){var e=Cbola.EventBus,t=Cbola.Utils,i=Cbola.Env,o=e.Events,n=function(){function n(){_classCallCheck(this,n),this.focused=null,this.initialized=!1}return _createClass(n,[{key:"init",value:function(){if(!this.initialized&&this.addFocusEvents()){var e=t.getCompatibleVisibilityAPI(),o=e.hidden;this.focused=!document[o]&&i.viewportWindow.document.hasFocus(),this.initialized=!0}}},{key:"addFocusEvents",value:function(){var e=this,o=t.getCompatibleVisibilityAPI(),n=o.hidden,r=o.changeEventName;if(document.hasFocus&&n){var a="onfocusin"in window?"focusin":"focus",s="onfocusout"in window?"focusout":"blur",l=i.viewportWindow,d=function(t){t.type===a?setTimeout(function(){e.updateFocus(!document[n]&&l.document.hasFocus())},300):e.updateFocus(!document[n]&&l.document.hasFocus())};try{return l.addEventListener(a,d),l.addEventListener(s,d),document.addEventListener(r,d),!0}catch(c){}}return!1}},{key:"updateFocus",value:function(t){t!==this.focused&&(this.focused=t,e.fire(o.FOCUS_CHANGE,t))}},{key:"isFocused",value:function(){return this.focused}}]),n}();return new n}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.HasViewability=Cbola.Common.HasViewability||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.EventBus,o=Cbola.Env,n=Cbola.Enums,r=Cbola.Logger.getInstance(),a=Cbola.Common.VisibilityObserver,s=Cbola.Common.FocusObserver,l=n.ItemViewTypes,d=i.Events,c=8,h=2e3,m=function(){};m.prototype.init=function(e){this.becameViewableAt=0,this.viewableDuration=0,this.viewable=!1,this.element=e,this.viewId=null,this.observer=null,this.viewableEvent=""+d.LAYER_IS_VIEWABLE+this.elementId},m.prototype.updateViewability=function(){p.isViewabilityTestable()?this.observer=new p(this.element,this.elementId):u.isViewabilityTestable()&&(this.observer=new u(this.element,this.elementId)),i.addEventListener(""+d.OBSERVER_VIEWABLE+this.elementId,this.onObserverViewable.bind(this)),i.addEventListener(""+d.OBSERVER_NON_VIEWABLE+this.elementId,this.onObserverNonViewable.bind(this)),this.observer&&this.observer.init()||(this.viewable=!0,this.onBecameViewable(l.IN_IFRAME))},m.prototype.onObserverViewable=function(){this.viewId=t.generateViewId(),this.viewable=!0,this.onBecameViewable(l.VIEWABILITY)},m.prototype.onObserverNonViewable=function(){this.viewId=t.generateViewId(),this.viewable=!1,this.onBecameUnviewable()},m.prototype.isViewable=function(){return this.viewable},m.prototype.getViewId=function(){return this.viewId},m.prototype.getViewDuration=function(){return this.viewable?t.getRunTimeInSecs()-this.becameViewableAt:this.viewableDuration},m.prototype.onBecameViewable=function(){r.info("element became viewable.",this),i.fire(this.viewableEvent),this.becameViewableAt=t.getRunTimeInSecs()},m.prototype.onBecameUnviewable=function(){r.info("element became unviewable.",this),this.viewableDuration=t.getRunTimeInSecs()-this.becameViewableAt};var p=function(){function t(e,i){_classCallCheck(this,t),this.observed=e,this.elemId=i,this.ignoreIntersectionChanges=!1,this.observedViewable=!1}return _createClass(t,null,[{key:"isViewabilityTestable",value:function(){return!e.isNil(window.IntersectionObserver)}}]),_createClass(t,[{key:"init",value:function(){a.init();var t=a.isVisible();return e.isNil(t)?!1:(this.observer=new IntersectionObserver(this.onObserverChange.bind(this),{root:null,rootMargin:"0px",threshold:.5}),this.observer.observe(this.observed),i.addEventListener(d.PAGE_VISIBILITY_CHANGE,this.onVisibilityChange.bind(this)),!0)}},{key:"onObserverChange",value:function(e){var t=this;if(!this.ignoreIntersectionChanges){var o=e.shift(),n=o.intersectionRatio>.5;clearTimeout(this.intersectionTestTimeout),n!==this.observedViewable&&(this.intersectionTestTimeout=setTimeout(function(){var e=n?d.OBSERVER_VIEWABLE:d.OBSERVER_NON_VIEWABLE;t.observedViewable=n,i.fire(""+e+t.elemId)},h))}}},{key:"onVisibilityChange",value:function(e){var t=this,o=e.detail;o?(this.ignoreIntersectionChanges=!1,this.testViewabilityOnReturn&&(this.intersectionTestTimeout=setTimeout(function(){t.observedViewable=!0,i.fire(""+d.OBSERVER_VIEWABLE+t.elemId)},h))):(clearTimeout(this.intersectionTestTimeout),this.ignoreIntersectionChanges=!0,this.observedViewable&&(this.testViewabilityOnReturn=!0,this.observedViewable=!1,i.fire(""+d.OBSERVER_NON_VIEWABLE+this.elemId)))}}]),t}(),u=function(){function n(t,i){_classCallCheck(this,n),this.observed=t,this.elemId=i,this.observedWindow=e.result(this.observed,"ownerDocument.defaultView"),this.observedViewable=!1,this.viewabilityTestCounter=0,this.outOfViewabilityTestCounter=0,this.observedWindow||(r.errorM("ElementViewabilityObserver.ctor","ElementViewabilityObserver.ctor failed to get default view from element"),window.document.contains(this.observed)?this.observedWindow=window:r.errorM("ElementViewabilityObserver.ctor","ElementViewabilityObserver.ctor failed to get default view from element"))}return _createClass(n,null,[{key:"isViewabilityTestable",value:function(){return!e.isNil(o.viewportWindow)}}]),_createClass(n,[{key:"init",value:function(){s.init();var t=s.isFocused();return e.isNil(t)?!1:(i.addEventListener(d.FOCUS_CHANGE,this.onFocusChange.bind(this)),t&&this.testViewability(),!0)}},{key:"onFocusChange",value:function(e){var t=e.detail;t?this.testViewability():this.stopViewabilityTesting()}},{key:"testViewability",value:function(){this.isElementInViewport()?(this.viewabilityTestCounter=this.viewabilityTestCounter<c?this.viewabilityTestCounter+1:c,this.outOfViewabilityTestCounter=0):(this.viewabilityTestCounter=0,this.outOfViewabilityTestCounter=this.outOfViewabilityTestCounter<c?this.outOfViewabilityTestCounter+1:c);var e=null;this.observedViewable||this.viewabilityTestCounter!==c?this.observedViewable&&this.outOfViewabilityTestCounter===c&&(e=d.OBSERVER_NON_VIEWABLE):e=d.OBSERVER_VIEWABLE,e&&(this.observedViewable=!this.observedViewable,i.fire(""+e+this.elemId)),this.nextViewabilityTesting=setTimeout(this.testViewability.bind(this),h/c)}},{key:"stopViewabilityTesting",value:function(){clearTimeout(this.nextViewabilityTesting),this.viewabilityTestCounter=0,this.outOfViewabilityTestCounter=0,this.observedViewable&&(this.observedViewable=!1,i.fire(""+d.OBSERVER_NON_VIEWABLE+this.elemId))}},{key:"isElementInViewport",value:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.observed.getBoundingClientRect().height,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.observed,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.observedWindow,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!n||e.isNil(n.offsetParent)||!r||"hidden"===r.getComputedStyle(n).visibility)return!1;try{var s=r.scrollY||r.pageYOffset,l=t.cumulativeOffset(n).top+a,d=l+i/2>=s&&s+r.innerHeight>l+i/2;return d&&r!==o.viewportWindow?this.isElementInViewport(i,r.frameElement,r.parent,l-s):d}catch(c){return!1}}}]),n}();return m}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.TemplatesManagerBase=function(){var e=Cbola._,t=Cbola.Logger.Colors,i=Cbola.Logger.getInstance();return function(){function o(){_classCallCheck(this,o),this.Compiled={}}return _createClass(o,[{key:"getCompiledTemplate",value:function(o){return this.Compiled&&e.isFunction(this.Compiled[o])?this.Compiled[o]:e.isString(this[o])?(i.alwaysSend(t.PALE_RED,"Templates.getCompiledTemplate, failed to find compiled template for "+o+"."),this.Compiled[o]=e.template(this[o],{variable:"data"}),this.Compiled[o]):null}}]),o}()}(),Cbola.Styles=function(){var e=(Cbola._,Cbola.TemplatesManagerBase),t=Cbola.Utils,i=Cbola.Logger.getInstance(),o="Styles",n=function(e){function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return _inherits(n,e),_createClass(n,[{key:"injectMainStyle",value:function(e,t){var i=Math.min(Math.floor(window.devicePixelRatio||1),3),o={clientPath:Cbola.Env.clientPath,retina:i>1?"@"+i+"x":""};return this.injectThemeStyle(e,t,o)}},{key:"injectThemeStyle",value:function(e,n,r){var a="injectMainStyle",s=this.getCompiledTemplate(n),l="";try{l=s(r)}catch(d){return i.errorM(o+","+a,""+o+a+" failed generating style for: "+n+", url: "+Cbola.Env.PageProperties.hostname),null}return t.injectStyle(e,l)}}]),n}(e);return new n}(),Cbola.Templates=function(){var e=Cbola._,t=Cbola.TemplatesManagerBase,i=Cbola.Logger.getInstance(),o="Templates",n=function(t){function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return _inherits(n,t),_createClass(n,[{key:"createElement",value:function(e){if(this[e]){var t=document.createElement("div");return t.innerHTML=this[e],t=t.children[0]}return null}},{key:"createWrappedDOMFromTemplate",value:function(e,t){var n="createWrappedDOMFromTemplate",r=this.getCompiledTemplate(e);if(r){var a="";try{a=r(t)}catch(s){return i.errorM(""+o+n,""+o+n+" failed generating template for: "+e+", url: "+Cbola.Env.PageProperties.hostname),null}var l=document.createElement("div");return l.innerHTML=a,l}return null}},{key:"createElementFromTemplate",value:function(t,i){var o=this.createWrappedDOMFromTemplate(t,i);return e.get(o,"children[0]",null)}},{key:"createFragmentFromTemplate",value:function(e,t){var i=this.createWrappedDOMFromTemplate(e,t);if(i){for(var o=document.createDocumentFragment();i.childNodes.length;)o.appendChild(i.childNodes[0]);return o}return null}}]),n}(t);return new n}(),function(){window["Cbola"]=window["Cbola"]||{},window["Cbola"]["Templates"]=window["Cbola"]["Templates"]||{},window["Cbola"]["Templates"]["Compiled"]=window["Cbola"]["Templates"]["Compiled"]||{},window["Cbola"]["Templates"]["Compiled"]["a9_dfp_banner.html"]=function(e){var t,i="";return i+='<!DOCTYPE html>\r\n<html lang="en">\r\n  <head>\r\n    <meta charset="UTF-8" />\r\n    <script async="async" src="https://www.googletagservices.com/tag/js/gpt.js"></script>\r\n    <script>\r\n      var Cbola_pbjs = Cbola_pbjs || {};\r\n      Cbola_pbjs.que = Cbola_pbjs.que || [];\r\n    </script>\r\n    <script type="text/javascript" src="'+(null==(t=e.clientPath)?"":t)+'external/prebid.min.js" async></script>\r\n    <script>\r\n      !function(a9,a,p,s,t,A,g){if(a[a9])return;function q(c,r){a[a9]._Q.push([c,r])}a[a9]={init:function(){q("i",arguments)},fetchBids:function(){q("f",arguments)},setDisplayBids:function(){},targetingKeys:function(){return[]},_Q:[]};A=p.createElement(s);A.async=!0;A.src=t;g=p.getElementsByTagName(s)[0];g.parentNode.insertBefore(A,g)}("apstag",window,document,"script","//c.amazon-adsystem.com/aax2/apstag.js");\r\n\r\n      var googletag = googletag || {};\r\n      googletag.cmd = googletag.cmd || [];\r\n\r\n      googletag.cmd.push(function() {\r\n       googletag.defineSlot(\r\n               \''+(null==(t=e.slotName)?"":t)+"',\r\n                     [["+(null==(t=e.width)?"":t)+", "+(null==(t=e.height)?"":t)+"]],\r\n                     '"+(null==(t=e.slotID)?"":t)+"'\r\n             ).addService(googletag.pubads());\r\n\r\n             googletag.pubads().disableInitialLoad();\r\n             googletag.pubads().enableSingleRequest();\r\n             googletag.enableServices();\r\n         });\r\n\r\n      apstag.init({\r\n       pubID:  '0b2db9a2-c936-4557-a140-fbff93318c8c',\r\n       adServer: 'googletag'\r\n      });\r\n    </script>\r\n  </head>\r\n  <body>\r\n    <div id=\""+(null==(t=e.slotID)?"":t)+"\">\r\n      <script>\r\n        googletag.cmd.push(function() {\r\n          googletag.display('"+(null==(t=e.slotID)?"":t)+"');\r\n        });\r\n      </script>\r\n    </div>\r\n  </body>\r\n</html>\r\n"}}(),Cbola.Templates["advertisement_title.html"]="<div\n  style=\"font-family:'Open Sans',sans-serif; font-size: 14px; font-weight:normal;color: rgb(200, 200, 200);text-align: center;height: 20px;margin:0;padding:0;\"\n>\n  - Advertisement -\n</div>\n",Cbola.Templates["ad_banner_sponsored_loading.html"]='<div class="cbola-banner-preload">\n  <div class="cbola-banner-preload-spinner">\n    <div class="cbola-banner-preload-spinner__path"></div>\n    <div class="cbola-banner-preload-spinner__path"></div>\n    <div class="cbola-banner-preload-spinner__path"></div>\n    <div class="cbola-banner-preload-spinner__path"></div>\n    <div class="cbola-banner-preload-spinner__path"></div>\n    <div class="cbola-banner-preload-spinner__path"></div>\n    <div class="cbola-banner-preload-spinner__path"></div>\n    <div class="cbola-banner-preload-spinner__path"></div>\n  </div>\n  <div class="cbola-banner-preload-sponsored-text">\n    sponsored\n  </div>\n</div>\n',function(){window["Cbola"]=window["Cbola"]||{},window["Cbola"]["Templates"]=window["Cbola"]["Templates"]||{},window["Cbola"]["Templates"]["Compiled"]=window["Cbola"]["Templates"]["Compiled"]||{},window["Cbola"]["Templates"]["Compiled"]["ad_banner_structure.html"]=function(e){var t,i="";Array.prototype.join;return i+='<div\r\n  id="cbola-banner-structure'+(null==(t=e.elemId)?"":t)+"_"+(null==(t=e.apperance)?"":t)+'"\r\n  class="cbola-banner-structure cbola-banner-structure'+(null==(t=e.elemId)?"":t)+"_"+(null==(t=e.apperance)?"":t)+' unselectDrag"\r\n>\r\n  <div class="cbola-banner-preload">\r\n    <div class="cbola-banner-preload-spinner">\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n    </div>\r\n    <div class="cbola-banner-preload-sponsored-text">\r\n      sponsored\r\n    </div>\r\n  </div>\r\n  \r\n  <div class="cbola-banner-structure__advertisement-title ',e.showAdvertisementTitle||(i+="cbola-fade-out"),i+='">\r\n    '+(null==(t=e.advertisement)?"":t)+'\r\n  </div>\r\n  <div class="hide-ad-button cbola-fade-out"></div>\r\n  <div\r\n    id="cbola-banner'+(null==(t=e.elemId)?"":t)+"_"+(null==(t=e.apperance)?"":t)+'"\r\n    class="cbola-banner cbola-banner'+(null==(t=e.elemId)?"":t)+"_"+(null==(t=e.apperance)?"":t)+'"\r\n  ></div>\r\n</div>\r\n'}}(),function(){window["Cbola"]=window["Cbola"]||{},window["Cbola"]["Templates"]=window["Cbola"]["Templates"]||{},window["Cbola"]["Templates"]["Compiled"]=window["Cbola"]["Templates"]["Compiled"]||{},window["Cbola"]["Templates"]["Compiled"]["ad_lightning_iframe.html"]=function(e){var t,i="";return i+='<!DOCTYPE html>\r\n<html lang="en">\r\n  <head>\r\n    <meta charset="UTF-8" />\r\n    <script\r\n      src="https://tagan.adlightning.com/carambola'+(null==(t=e.scriptSuffix)?"":t)+'/blacklist_script.js"\r\n      type="text/javascript"\r\n    ></script>\r\n    <script\r\n      src="https://tagan.adlightning.com/carambola'+(null==(t=e.scriptSuffix)?"":t)+'/blocking_script.js"\r\n      type="text/javascript"\r\n    ></script>\r\n    <script type="text/javascript">\r\n      function createTagDetails() {\r\n        var tagDetails = {};\r\n        tagDetails.w = '+(null==(t=e.width)?"":t)+";\r\n        tagDetails.h = "+(null==(t=e.height)?"":t)+";\r\n        tagDetails.dfpDetails = {\r\n          advertiserId: '"+(null==(t=e.adId)?"":t)+"',\r\n          creativeId: '"+(null==(t=e.adId)?"":t)+"',\r\n          campaignId: '"+(null==(t=e.tagType)?"":t)+"' +\r\n              '_"+(null==(t=e.platform)?"":t)+"' +\r\n              '_"+(null==(t=e.width)?"":t)+"x"+(null==(t=e.height)?"":t)+"' +\r\n              '_"+(null==(t=e.providerId)?"":t)+"'\r\n        };\r\n        tagDetails.au = '"+(null==(t=e.adId)?"":t)+"';\r\n        tagDetails.markupInDom = true;\r\n        tagDetails.refreshMessage = '"+(null==(t=e.message)?"":t)+'\';\r\n\r\n        var random = Math.round(Math.random() * 1e8);\r\n        tagDetails.currentTagId = "adltag_" + (((new Date()) * 1)) + "_" + random;\r\n        return tagDetails;\r\n      }\r\n      var random = "" + Math.round(Math.random() * 1e8);\r\n      var site_id = random + "_" + "carambola'+(null==(t=e.scriptSuffix)?"":t)+'";\r\n      window[site_id]={};\r\n      window[site_id].tagDetails=createTagDetails();\r\n      blocker(site_id, "<!--ADL_WRAPPED-->", false, window);\r\n    </script>\r\n    <title>ad lighting</title>\r\n  </head>\r\n  <body>\r\n    '+(null==(t=e.tag)?"":t)+"\r\n  </body>\r\n</html>\r\n"}}(),Cbola.Templates["ad_only_container.html"]='<div class="cbola-layer cbola-ad-only-container">\n  <div class="cbola-ad-only-container__inner layer-container"></div>\n</div>\n',Cbola.Templates["desktop_trivia_container.html"]='<div class="cbola-layer cbola-in-content-trivia-container">\n  <div class="cbola-in-content-trivia-container__inner layer-container"></div>\n</div>\n',Cbola.Templates["framed_in_content_container.html"]='<div class="cbola-layer cbola-in-content-container cbola-in-content-container--framed">\n  <div class="cbola-in-content-container__frame">\n    <div class="cbola-in-content-container__frame-inner layer-container"></div>\n  </div>\n</div>\n',Cbola.Templates["in_content_container.html"]='<div class="cbola-layer cbola-in-content-container">\n  <div class="cbola-in-content-container__inner layer-container"></div>\n</div>\n',Cbola.Templates["mobile_container.html"]='<div class="cbola-mobile-container">\n  <div class="cbola-mobile-container__inner layer-container"></div>\n</div>\n',function(){window["Cbola"]=window["Cbola"]||{},window["Cbola"]["Templates"]=window["Cbola"]["Templates"]||{},window["Cbola"]["Templates"]["Compiled"]=window["Cbola"]["Templates"]["Compiled"]||{},window["Cbola"]["Templates"]["Compiled"]["mobile_in_item_banner_structure.html"]=function(e){var t,i="";Array.prototype.join;return i+='<div id="cbola-box-item-ad_'+(null==(t=e.elemId)?"":t)+"_"+(null==(t=e.adId)?"":t)+'" data-ad-id="'+(null==(t=e.adId)?"":t)+'" class="cbola-box-item-ad">\r\n  <div class="cbola-banner-preload">\r\n    <div class="cbola-banner-preload-spinner">\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n      <div class="cbola-banner-preload-spinner__path"></div>\r\n    </div>\r\n    <div class="cbola-banner-preload-sponsored-text">\r\n      sponsored\r\n    </div>\r\n  </div>\r\n  \r\n  <div class="cbola-banner-structure__advertisement-title ',e.showAdvertisementTitle||(i+="cbola-fade-out"),i+='">\r\n    '+(null==(t=e.advertisement)?"":t)+'\r\n  </div>\r\n  <div class="cbola-banner"></div>\r\n</div>\r\n'}}(),Cbola.Templates["sidebar_container.html"]='<div class="cbola-layer cbola-sidebar-container">\n  <div class="cbola-sidebar-container__inner layer-container"></div>\n</div>\n',Cbola.Templates["width_check.html"]='<div id="carambola_InContent_checkWidth" style="width:100%"></div>\n',function(){window["Cbola"]=window["Cbola"]||{},window["Cbola"]["Styles"]=window["Cbola"]["Styles"]||{},window["Cbola"]["Styles"]["Compiled"]=window["Cbola"]["Styles"]["Compiled"]||{},window["Cbola"]["Styles"]["Compiled"]["cbolaStyle.css"]=function(e){var t,i="";return i+=".cbola-icon,.hide-ad-button:before{speak:none;-moz-osx-font-smoothing:grayscale}.cbola-no-select,.cbola-no-select>*,.unselectDrag{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.cbola-disable-transition,.cbola-disable-transition *{transition:none!important}.cbola-clearfix{overflow:auto;zoom:1}.cbola-loader{position:absolute;top:50%;left:50%;margin-left:-19px!important;margin-top:-19px!important;height:38px;width:38px;border:4px solid rgba(100,100,100,.3);border-top:4px solid rgba(100,100,100,.9);border-radius:50%;animation:cbola-rotation 1.2s infinite linear;box-sizing:border-box}@keyframes cbola-rotation{from{transform:rotate(0)}to{transform:rotate(360deg)}}span.cbola-clamped-text{overflow:hidden;position:relative;line-height:1.4em;max-height:2.8em;text-align:justify;display:block;padding-right:1em;margin-left:1em}span.cbola-clamped-text:before{content:'...';position:absolute;right:0;bottom:0}span.cbola-clamped-text:after{content:'';position:absolute;right:0;width:1em;height:1em;margin-top:.2em;background:#fff}.cbola-fade-out{opacity:0!important;pointer-events:none}.cbola-fade-in{opacity:1!important;pointer-events:auto}.cbola-hidden{visibility:hidden!important;pointer-events:none}.cbola-hide{display:none!important}.cbola-hide-scrollbars::-webkit-scrollbar{display:none}.cbola-ghost-center-container:before,.cbola-ghost-center-inner{display:inline-block;vertical-align:middle}.cbola-ghost-center-container{position:relative;font-size:0}.cbola-ghost-center-container:before{content:' ';height:100%}.cbola-separated{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center!important;align-items:center!important;-ms-flex-pack:center!important;justify-content:center!important}.cbola-ad-only-container,.cbola-in-content-container{-ms-flex-align:start;position:relative;line-height:normal;width:100%}.cbola-separated:after,.cbola-separated:before{content:' ';display:block;width:100%;height:20px;border-color:#b6b6b6;box-sizing:border-box}.cbola-separated:before{border-top-style:solid;border-top-width:1px}.cbola-separated:after{border-bottom-style:solid;border-bottom-width:1px}.cbola-ad-only-container{display:-ms-flexbox;display:flex;align-items:flex-start;box-sizing:border-box}.cbola-ad-only-container *{box-sizing:border-box}.cbola-ad-only-container__inner{width:100%}.cbola-in-content-container{display:-ms-flexbox;display:flex;align-items:flex-start}.cbola-in-content-container--framed{display:block;clear:both}.cbola-in-content-container__frame,.cbola-in-content-container__inner{max-width:700px;min-width:440px;position:relative}.cbola-in-content-container__inner{width:100%;transition:height .6s ease;opacity:0}.cbola-in-content-container__frame{border:2px solid #c3c3c3;border-radius:8px;padding:5px;box-shadow:3px 3px 3px 0 rgba(220,220,220,.8);margin:20px auto 0}.cbola-mobile-container__inner,.cbola-sidebar-container__inner{opacity:0;position:relative;padding-top:0;box-sizing:content-box}.cbola-in-content-container__frame-inner{margin:0 auto;position:relative;transition:height .6s ease;opacity:0}.cbola-in-content-trivia-container{position:relative;line-height:normal;clear:both}.cbola-in-content-trivia-container__inner{box-sizing:content-box;margin:0 auto;position:relative;opacity:0;padding:0;transition:height .6s ease}.cbola-sidebar-container{position:relative;line-height:normal;display:-ms-flexbox;display:flex;-ms-flex-align:start;align-items:flex-start}.cbola-mobile-container{line-height:normal;clear:both}.cbola-mobile-container__inner{float:none;width:100%;margin:0 auto}.cbola-banner-structure{position:absolute;font-size:10px;color:#999;text-align:center;opacity:1;font-family:'Open Sans',Arial,sans-serif;cursor:default;padding:0;z-index:3;line-height:normal!important;overflow:hidden}.cbola-banner-structure__advertisement-title{z-index:999999;position:absolute;left:0;top:0;background-color:rgba(0,0,0,.4);color:#fff;padding:1px 4px 2px 3px!important;font-size:8px!important;font-weight:600;text-transform:capitalize;font-family:'Open Sans',Arial,sans-serif!important;border-bottom-right-radius:8px;letter-spacing:.1em;pointer-events:none;line-height:normal}.cbola-banner{position:relative;z-index:5;opacity:1;height:100%;overflow:visible;text-align:center;transform-origin:50% 0 0;margin-right:auto!important;margin-left:auto!important}.cbola-banner iframe{max-width:none;border:0}.cbola-banner__tag{position:absolute;top:0;left:50%;transform:translateX(-50%)}.cbola-banner__tag--front{z-index:10}.cbola-banner__tag--back{z-index:5}.hide-ad-button{position:absolute;cursor:pointer;top:1px;right:1px;margin-top:0;z-index:999999;width:18px;height:18px;background-color:#000;border-radius:50%;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;overflow:hidden}.hide-ad-button:before{font:normal normal normal 12px/1 cbolaIcons;font-family:cbolaIcons!important;content:'\\f00d';text-transform:none;text-rendering:auto;-webkit-font-smoothing:antialiased;color:#fff}.cbola-banner-preload{width:100%;height:100%;position:absolute;top:0;left:0;z-index:0;background-color:#f6f6f6;overflow:hidden;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}.cbola-banner-preload-spinner{height:25px;width:25px;position:relative}.cbola-banner-preload-spinner__path{height:11px;width:4px;position:absolute;top:0;left:calc(50% - 3px);transform-origin:center bottom}.cbola-banner-preload-spinner__path:before{content:' ';display:block;height:8px;width:100%;border-radius:30%;background-color:#c5c5c5;opacity:.5;position:absolute;top:-2px;animation:bgColorChange 1.2s linear infinite;will-change:opacity}.cbola-banner-preload-sponsored-text{margin-top:2px;font-family:Roboto,Arial,sans-serif;font-size:14px;letter-spacing:-.2px;color:#bebebe;text-transform:capitalize}.cbola-banner-preload-spinner__path:nth-child(1){transform:rotate(45deg)}.cbola-banner-preload-spinner__path:nth-child(2):before{animation-delay:.15s}.cbola-banner-preload-spinner__path:nth-child(2){transform:rotate(90deg)}.cbola-banner-preload-spinner__path:nth-child(3):before{animation-delay:.3s}.cbola-banner-preload-spinner__path:nth-child(3){transform:rotate(135deg)}.cbola-banner-preload-spinner__path:nth-child(4):before{animation-delay:.45s}.cbola-banner-preload-spinner__path:nth-child(4){transform:rotate(180deg)}.cbola-banner-preload-spinner__path:nth-child(5):before{animation-delay:.6s}.cbola-banner-preload-spinner__path:nth-child(5){transform:rotate(225deg)}.cbola-banner-preload-spinner__path:nth-child(6):before{animation-delay:.75s}.cbola-banner-preload-spinner__path:nth-child(6){transform:rotate(270deg)}.cbola-banner-preload-spinner__path:nth-child(7):before{animation-delay:.9s}.cbola-banner-preload-spinner__path:nth-child(7){transform:rotate(315deg)}.cbola-banner-preload-spinner__path:nth-child(8):before{animation-delay:1.15s}@keyframes bgColorChange{0%{opacity:.5}12.5%{opacity:1}25%,37.5%{opacity:.9}50%{opacity:.8}62.5%{opacity:.6}100%,75%{opacity:.5}}@font-face{font-family:cbolaIcons;src:url('"+(null==(t=e.clientPath)?"":t)+"css/fonts/cbolaIcons.woff?phtwnv') format(\"woff\"),url('"+(null==(t=e.clientPath)?"":t)+"css/fonts/cbolaIcons.ttf?phtwnv') format(\"truetype\"),url('"+(null==(t=e.clientPath)?"":t)+"css/fonts/cbolaIcons.svg?phtwnv#cbolaIcons') format(\"svg\");font-weight:400;font-style:normal}.cbola-icon{display:inline-block;font:normal normal normal 14px/1 cbolaIcons;font-family:cbolaIcons!important;font-size:inherit;text-transform:none;text-rendering:auto;-webkit-font-smoothing:antialiased;transform:translate(-1px,1px);font-style:inherit!important}.cbola-icon-check:before{content:'\\f00c'}.cbola-icon-times:before{content:'\\f00d'}.cbola-icon-chevron-left:before{content:'\\f053'}.cbola-icon-chevron-right:before{content:'\\f054'}.cbola-icon-twitter:before{content:'\\f099'}.cbola-icon-facebook:before{content:'\\f09a'}.cbola-icon-hand-o-up:before{content:'\\f0a6'}.cbola-icon-angle-left:before{content:'\\f104'}.cbola-icon-angle-right:before{content:'\\f105'}.cbola-icon-share-alt-thick:before{content:'\\f1e0'}.cbola-icon-whatsapp:before{content:'\\f232'}.cbola-icon-share-alt-thin:before{content:'\\e900'}.cbola-icon-retweet:before{content:'\\f079'}.cbola-icon-star:before{content:'\\f005'}.cbola-icon-arrow-left:before{content:'\\f060'}.cbola-icon-arrow-right:before{content:'\\f061'}.cbola-inserted{animation-duration:1ms;animation-name:cbolaInserted;visibility:hidden}@keyframes cbolaInserted{from{opacity:.99}to{opacity:1}}";
}}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.IframeBuster=function(){var e=Cbola._,t=Cbola.Config,i=Cbola.Logger.getInstance();return function(){function o(t,i,n){_classCallCheck(this,o),this.name="IframeBuster",this.settings={hasLocationSelectors:!e.isEmpty(e.result(t,"LocationSelector",{})),iFrameAdjust:e.get(t,"iFrameAdjustForTablet",!1)&&Cbola.Env.PageProperties.isTablet||e.get(t,"iFrameAdjust",!1),mobileiFrameAdjust:e.get(t,"mobileiFrameAdjust",!1),iFrameBusterWidth:t.iFrameBusterWidth,fixedHeight:e.get(t,"iFrameFixedHeight",null),fixedWidth:e.get(t,"iFrameFixedWidth",null),advertisementTitleHeight:e.get(t,"IncludeAdvertisementTitle",!1)?20:0},this.layerType=n,this.widgetId=i,this.iFrameElement=null,this.iframePropertiesSet=!1}return _createClass(o,null,[{key:"pushScriptAboveIframe",value:function(){for(var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=window,n=o.frameElement;n&&o.parent&&o.parent!==o.top;)o=o.parent,n=o.frameElement;if(e.isNil(n))return!1;n.insertAdjacentHTML("beforebegin",'<script class="'+t.inContentClass+'" cbola_wid="'+i+'" data-manual-build="true"></script>'),n.style["height"]="0";var r=document.createElement("script");r.src=Cbola.Env.proxyElem.src,r.id=t.proxyId,r.setAttribute("mediatype","InContent");var a=parent.document.getElementsByTagName("script")[0];return a.parentNode.insertBefore(r,a),!0}}]),_createClass(o,[{key:"init",value:function(){try{this.iFrameElement=window.frameElement||null}catch(e){return void i.errorOnce(this.name+".init failed getting iframe element, wid: "+this.widgetId+", e:",e)}if(this.checkIframeDimension(),this.settings.fixedHeight||this.settings.fixedWidth){var t=this.getIframe();t&&(this.settings.fixedHeight&&(t.style["height"]=this.settings.fixedHeight+this.settings.advertisementTitleHeight+"px"),this.settings.fixedWidth&&(t.style["width"]=this.settings.fixedWidth+"px")),this.setIframeProperties()}}},{key:"checkIframeDimension",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o="IframeBuster.checkIframeDimension",n=this.settings;if(!this.shouldBust())return this;var r=n.iFrameBusterWidth||0,a=this.getIframe(),s=a.getBoundingClientRect();try{var l=t.getLayersDefaultSizeForIframe(this.layerType);l.height+e+n.advertisementTitleHeight>s.height&&(i.info("Iframe's height was change from: "+s.height+" to "+(l.height+e+n.advertisementTitleHeight)),a.style["height"]=l.height+e+n.advertisementTitleHeight+"px"),a.style["width"]="100%",0!==r?(a.style["min-width"]=r+"px",i.info("Iframe's min-width was change to: "+r)):-1!==l.width&&(a.style["min-width"]=l.width+"px",i.info("Iframe's min-width was change to: "+l.width)),this.setIframeProperties()}catch(d){i.errorM(o,o+" failed, Path: "+Cbola.Env.PageProperties.hostname+", pid: "+Cbola.Env.activePid)}return this}},{key:"setIframeSize",value:function(e,t){if(this.shouldBust()){var i=this.getIframe();if(i){var o="undefined"!=typeof e?e:window.parent.innerWidth,n="undefined"!=typeof t?t:0;o>0&&(i.style["width"]=o+"px"),0!==n&&(i.style["height"]=n+this.settings.advertisementTitleHeight+"px")}}}},{key:"setIframeProperties",value:function(){var e="IframeBuster.setIframeProperties",t=this.getIframe();if(!this.iframePropertiesSet&&t)try{t.setAttribute("scrolling","no"),t.setAttribute("marginwidth","0"),t.setAttribute("marginheight","0"),t.setAttribute("frameborder","0");var o=t.contentDocument||t.contentWindow.document||document;o&&(o.body.style["margin"]=0,o.body.style["overflow"]="hidden"),this.iframePropertiesSet=!0}catch(n){i.errorM(e,e+" failed setting iframe attributes and style")}}},{key:"shouldBust",value:function(){var t=this.settings,i=Cbola.Env.PageProperties.isMobile;return!t.hasLocationSelectors&&(t.iFrameAdjust&&!i||t.mobileiFrameAdjust&&i)&&!e.isNil(this.iFrameElement)}},{key:"getIframe",value:function(){return this.iFrameElement}}]),o}()}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Item=function(){var e=Cbola._,t=Cbola.Utils,i=function t(i){e.extend(this,i),this.Type===t.Types.TWEET&&(e.extend(this,this.Tweet),delete this.Tweet),this.becameViewableAt=0,this.lastViewableDuration=0,this.viewOrder=1,this.displayOrder=1,this.isViewable=!1,this.userAnswerId=0};return i.prototype.setOpenType=function(e){this.openType=e},i.prototype.setCloseType=function(e){this.closeType=e},i.prototype.setDisplayOrder=function(e){this.displayOrder=e},i.prototype.setViewOrder=function(e){this.viewOrder=e},i.prototype.setUserAnswerId=function(e){this.userAnswerId=e||0},i.prototype.setViewable=function(e){if(this.isViewable=e,e)this.becameViewableAt=t.getRunTimeInSecs();else{var i=t.getRunTimeInSecs()-this.becameViewableAt;this.lastViewableDuration=Math.round(100*i)/100}},i.prototype.getViewableDuration=function(){return this.isViewable?t.getRunTimeInSecs()-this.becameViewableAt:this.lastViewableDuration},i.prototype.isAd=function(){return this.type===i.Types.AD},i.prototype.getType=function(){return this.type||this.Type},i.Types={FACT:1,TIP:2,QUOTE:3,ON_THIS_DAY:4,TRIVIA:5,DIED_THIS_DAY:6,TRIVIA_MULTI:7,TRIVIA_MULTI_PAIRS:8,GAME_SET:254,CHART:255,TWEET:9,AD:-1e3},i}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Services=Cbola.InContent.Layers.Services||{},Cbola.InContent.Layers.Services.BasicService=function(){var e=Cbola._,t=Cbola.Common.RequestHandler,i=Cbola.Common.UserService,o=Cbola.InContent.Layers.Item,n=Cbola.Logger.getInstance(),r={},a=function(){this.pendingItems=[],this.historicallyViewedItems=[]};return a.prototype.getMoreItems=function(i,o,a){var s=this,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=[],h=this.getSession(i),m=this.getOrCreatePendingItems(o),p=function(){var t=s.getHistoricallyViewedItems(o);if(!t.length||h.length)return t.splice(0),[];var n=e.differenceBy(t,h,"Id");return t.splice(0),r[i]=e.unionBy(h,n,"Id"),n||[]},u=function(){c=m.splice(0,Math.max(l,5));var t=e.differenceBy(c,h,"Id");r[i]=e.unionBy(h,t,"Id"),a(t)};if(m.length>=l)u();else{if(n.debug(this.name+"::getMoreItems -> quering server for more items..."),d+=1,d>1)return void(m.length>0?u():a(p()));var b=this.extendParams({WidgetId:o,ElementId:i,CurrentSession:e.map(h,function(e){return e.Id})});t.getMoreContent(b).then(function(t){if(n.debug(s.name+"::getMoreItems -> got more items from server"),e.isEmpty(t))return void a(p());var r=s.transformServerResponse(t),c=e.unionBy(m,r,"Id");c.unshift(0,m.length),m.splice.apply(m,c),s.getMoreItems(i,o,a,l,d)}).catch(function(){return a(p())})}},a.prototype.extendParams=function(e){try{e.FallbackMinimalWidth=Cbola.InContent.Manager.getLayerByElementId(e.ElementId).fallbackMinimalWidth||0}catch(t){e.FallbackMinimalWidth=0}return e},a.prototype.transformServerResponse=function(e){return e.map(function(e){return new o(e)})},a.prototype.clearSession=function(e){return r[e]=[],this},a.prototype.getSession=function(e){return"undefined"==typeof r[e]&&(r[e]=[]),r[e]},a.prototype.addItem=function(e,t){e&&!i.wasItemAlreadyViewed(e)?this.getOrCreatePendingItems(t).push(e):e&&this.getHistoricallyViewedItems(t).push(e)},a.prototype.getOrCreatePendingItems=function(t){var i=parseInt(t);return e.isArray(this.pendingItems[i])||(this.pendingItems[i]=[]),this.pendingItems[i]},a.prototype.getHistoricallyViewedItems=function(t){var i=parseInt(t);return e.isArray(this.historicallyViewedItems[i])||(this.historicallyViewedItems[i]=[]),this.historicallyViewedItems[i]},a.prototype.getAll=function(){return this.pendingItems},a.prototype.getAllByWidgetId=function(e){var t=parseInt(e);return this.pendingItems[t]},a}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Services=Cbola.InContent.Layers.Services||{},Cbola.InContent.Layers.Services.DiedThisDayService=function(){function e(e){return e&&e.OnThisDayDate?t(n,new Date(e.OnThisDayDate)):!1}function t(e,t){return e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}var i=Cbola._,o=Cbola.InContent.Layers.Services.BasicService,n=new Date,r=n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate(),a=function(){o.call(this),this.name="DiedThisDayService"};return i.extend(a.prototype,o.prototype),a.prototype.extendParams=function(e){return o.prototype.extendParams.call(this,e),e.ClientDate=r,e},a.prototype.transformServerResponse=function(t){var n=o.prototype.transformServerResponse.call(this,t),r=i.filter(n,e);return r.sort(),r},a.prototype.addItem=function(t,i){e(t)&&o.prototype.addItem.call(this,t,i)},a.prototype.getTotalOfItemsAvailableForToday=function(){return this.totalItemsAvailableOnServer},a.prototype.setTotalItemsForToday=function(e){var o=0;i.forEach(e,function(e){t(n,new Date(e.Day))&&(o=e.ItemCount)}),this.totalItemsAvailableOnServer=o},a.prototype.getDateDay=function(){return n.getDate()},new a}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Services=Cbola.InContent.Layers.Services||{},Cbola.InContent.Layers.Services.DiedThisWeekService=function(){var e=Cbola.InContent.Layers.Services.BasicService,t=Cbola._,i=function(){e.call(this),this.name="DiedThisWeekService",this.totalItemsAvailableOnServer=0};return t.extend(i.prototype,e.prototype),i.prototype.getTotalItemsAvailableForThisWeek=function(){return this.totalItemsAvailableOnServer},i.prototype.setTotalItemsForThisWeek=function(e){this.totalItemsAvailableOnServer=e.reduce(function(e,i){return e+t.result(i,"ItemCount",0)},0)},new i}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Services=Cbola.InContent.Layers.Services||{},Cbola.InContent.Layers.Services.FactsService=function(){var e=Cbola.InContent.Layers.Services.BasicService,t=Cbola._,i=function(){e.call(this),this.name="FactsService"};return t.extend(i.prototype,e.prototype),new i}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Services=Cbola.InContent.Layers.Services||{},Cbola.InContent.Layers.Services.IndicesService=Cbola.InContent.Layers.Services.IndicesService||function(){var e=Cbola._,t=Cbola.Env,i=Cbola.Utils,o=Cbola.Common.RequestHandler,n=Cbola.Common.UserService,r=Cbola.InContent.Layers.Item,a=Cbola.Logger.getInstance(),s="cbola_loc",l=2,d={Items:[]},c=e.memoize(function(){try{return t.topWindow.location.href.pathname.split("/")}catch(e){return[]}}),h=function(){function h(){_classCallCheck(this,h),this.setPageParamsOnce=e.once(function(){var o=null,r=null;if(t.DEBUG){var a=i.getUrlParams(),l=a.cbolalanguage,d=a.cbolalocationkey;o=l,r=d}var h=o||e.get(t.topWindow,s+".lang")||c()[1]||n.getLanguage();this.language=e.first(h.split("-")),n.setLanguage(this.language),this.locationKey=r||e.get(t.topWindow,s+".key")||c()[6]}),this.name="IndicesService",this.language="",this.locationKey=""}return _createClass(h,[{key:"getMoreItems",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l;return this.setPageParamsOnce(),a.debug(this.name+"::getMoreItems -> quering server for more items..."),o.getIndices(this.locationKey,this.language,e,t,n).then(function(e){return i.handleResponse(e,n)},function(){return Promise.resolve(d)})}},{key:"handleResponse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments[1];a.debug(this.name+"::handleResponse -> data: "+t);var o=t.Items,n=void 0===o?[]:o;return t.Items=n.reduce(function(t,o){return e.isArray(o.Indices)&&o.Indices.length===i&&(o.Indices=o.Indices.map(function(e){return new r(e)}),t.push(o)),t},[]),Promise.resolve(t)}}]),h}();return new h}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Services=Cbola.InContent.Layers.Services||{},Cbola.InContent.Layers.Services.OnThisDayService=function(){var e=Cbola._,t=Cbola.InContent.Layers.Services.BasicService,i=new Date,o=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate(),n=!1,r={es:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],pt:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],en:["January","February","March","April","May","June","July","August","September","October","November","December"],ja:["1","2","3","4","5","6","7","8","9","10","11","12"]},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.match(/(\d+)/g);return t.length>=3?new Date(parseInt(t[0]),parseInt(t[1])-1,parseInt(t[2])):null},s=function(e){var t=a(e.OnThisDayDate);t&&(i=t,o=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate())},l=function(e){if(n)return!0;if(e){var t=a(e.OnThisDayDate);if(t)return d(i,t)}return!1},d=function(e,t){return e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},c=function(){t.call(this),this.name="OnThisDayService"};return e.extend(c.prototype,t.prototype),c.prototype.extendParams=function(e){return t.prototype.extendParams.call(this,e),e.ClientDate=o,e},c.prototype.transformServerResponse=function(i){var o=t.prototype.transformServerResponse.call(this,i);return e.filter(o,l).sort()},c.prototype.addItem=function(e,i){l(e)&&t.prototype.addItem.call(this,e,i)},c.prototype.getTotalOfItemsAvailableForToday=function(){return this.totalItemsAvailableOnServer},c.prototype.setTotalItemsForToday=function(e){var t=0;for(var o in e){var n=e[o],r=new Date(n.Day);d(i,r)&&(t=n.ItemCount)}this.totalItemsAvailableOnServer=t},c.prototype.getDateDay=function(){return i.getDate()},c.prototype.getMonthName=function(e){return e=r.hasOwnProperty(e)?e:"en",r[e][i.getMonth()]},c.prototype.setIgnoreClientDate=function(e,t){n=Cbola.Utils.parseBool(e),"undefined"!=typeof t&&s(t)},new c}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Services=Cbola.InContent.Layers.Services||{},Cbola.InContent.Layers.Services.TriviaService=function(){var e=1,t=Cbola.Common.UserService,i=Cbola.InContent.Layers.Item,o=Cbola.Logger.getInstance(),n={},r=Cbola.InContent.Layers.Item.Types,a={TRUE_FALSE:[r.TRIVIA],MULTI_ANSWER:[r.TRIVIA_MULTI,r.TRIVIA_MULTI_PAIRS]},s={},l={},d=0,c=Cbola._,h=Cbola.EventBus,m=Cbola.Common.RequestHandler,p=function(){this.triviaTypes={};for(var e in a)a.hasOwnProperty(e)&&(this.triviaTypes[e]=e)};p.prototype.setFirstItemId=function(e){d=e},p.prototype.getNewGame=function(t,i,n,r,a){if("undefined"==typeof a&&(a=0),a>e)return void r(null);a++;var c=this.getPendingGamesByTriviaType(n),h=this.getOrCreateSession(t);if(c.length>0&&!d){var m=c.shift();delete s[m.id],m.widgetId=i,m.elementId=t,h.push(m),l[t]=h,r(m)}else o.debug("TriviaService::getNewGame -> quering server for more items..."),this.getMoreFromServer(t,i,n,function(){this.getNewGame(t,i,n,r,a)}.bind(this))},p.prototype.prepareNewGame=function(e,t,i){var o=this.translateItemToTriviaType(i);this.getPendingGamesByTriviaType(o).length>0||this.getMoreFromServer(e,t,o)},p.prototype.getMoreFromServer=function(e,n,r,a){var l=this,h=this.getOrCreateSession(e);o.debug("TriviaService::getNewGame -> quering server for more items...");var p={WidgetId:n,ElementId:e,CurrentSession:c.map(h,function(e){return e.id}),UserHistory:t.getItemsHistory(),FirstItemId:d};p=this.extendParams(p),m.getMoreContent(p).then(function(e){var t=e.map(function(e){return new i(e)}),n=l.getPendingGamesByTriviaType(r);o.debug("TriviaService::getMoreFromServer -> got more items from server");var h=c.groupBy(t,"ParentId");c.forEach(h,function(e,i){var o=s[i];o&&!o.hasAllItems()?o.items=c.unionBy(o.items,e,"Id"):o||(o=new f(e)),d?(d=0,n.unshift(o)):n.push(o),s[i]=o,a&&a(t)})}).catch(function(){a&&a([])})},p.prototype.extendParams=function(e){try{e.FallbackMinimalWidth=Cbola.InContent.Manager.getLayerByElementId(e.ElementId).fallbackMinimalWidth||0}catch(t){e.FallbackMinimalWidth=0}return e},p.prototype.clearSession=function(e){l[e]=[]},p.prototype.getOrCreateSession=function(e){var t=null;return"undefined"==typeof l[e]?(t=[],l[e]=t):t=l[e],t},p.prototype.addItem=function(e){var i=e.ParentId,o=e.Type,n=s[i];if(!t.wasItemAlreadyViewed(e))if(n)n.hasAllItems()||(n.items=c.unionBy(n.items,[e],"Id"));else{var r=new f([e]),a=this.getPendingGamesByTriviaType(this.translateItemToTriviaType(o));a.push(r),s[i]=r}},p.prototype.getAll=function(){return n},p.prototype.getPendingGamesByTriviaType=function(e){return n.hasOwnProperty(e)||(n[e]=[]),n[e]},p.prototype.translateItemToTriviaType=function(e){for(var t in a)if(a.hasOwnProperty(t)&&a[t].indexOf(e)>-1)return t};var u=function(e){for(var t="",i=0;i<e.length;i++)if(!c.isEmpty(e[i].ChartTitle)){t=e[i].ChartTitle;break}return t},b=function(e){for(var t="",i=0;i<e.length;i++)if(!c.isEmpty(e[i].Title)){t=e[i].Title;break}return t},f=function(e){function i(e){_classCallCheck(this,i);var t=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return t.id=e[0].ParentId,t.gameType=e[0].Type,t.title=u(e),t.shortTitle=b(e),t.items=e,t.currItemIdx=0,t.score=0,t.firstItem=e[0].Id,t.isCompleted=!1,t.historized=!1,t}return _inherits(i,e),_createClass(i,[{key:"getQuestionItem",value:function(e){return this.items[e]}},{key:"getCurrentQuestionItem",value:function(){return this.items[this.currItemIdx]}},{key:"getNextQuestionItem",value:function(){return this.items[this.currItemIdx+1]}},{key:"getCurrentQuestionNumber",value:function(){return this.currItemIdx+1}},{key:"hasEnded",value:function(){return this.isCompleted}},{key:"answerCurrentQuestion",value:function(e){if(this.isCompleted)return null;var i=this.items[this.currItemIdx],o=!1;0===e||this.historized||(this.historized=!0,t.addItemsToHistory([this.id]));for(var n=0;n<i.Answers.length;n++){var r=i.Answers[n];if(parseInt(e)===r.Id){1===r.Type&&(this.score+=1,o=!0);break}}return this.currItemIdx++,this.isAboutToEnd()&&Cbola.InContent.Layers.Services.TriviaService.prepareNewGame(this.elementId,this.widgetId,this.gameType),this.currItemIdx===this.items.length&&(this.isCompleted=!0,this.currItemIdx=this.items.length-1),o}},{key:"getCurrentQuestionCorrectAnswerIdx",value:function(){if(this.isCompleted)return null;for(var e=this.items[this.currItemIdx],t=0;t<e.Answers.length;t++)if(1===e.Answers[t].Type)return t}},{key:"getCurrentQuestionCorrectAnswerId",value:function(){if(this.isCompleted)return null;for(var e=this.items[this.currItemIdx],t=0;t<e.Answers.length;t++){var i=e.Answers[t];if(1===i.Type)return i.Id}}},{key:"restart",value:function(){this.score=0,this.currItemIdx=0,this.isCompleted=!1}},{key:"hasAllItems",value:function(){return this.gameType===Cbola.InContent.Layers.Item.Types.TRIVIA?10===this.items.length:!1}},{key:"isAboutToEnd",value:function e(){var e=this.currItemIdx+2===this.items.length;return e&&h.fire(""+h.Events.TRIVIA_BEFORE_END+this.id),e}}]),i}(i);return new p}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Services=Cbola.InContent.Layers.Services||{},Cbola.InContent.Layers.Services.TweetsService=function(){function e(e){if(i.isEmpty(e))return"";var t=Date.parse(e),o=n-t;return 0>o?"":6e4>o?i.round(o/1e3,0)+"s":36e5>o?i.round(o/6e4,0)+"m":864e5>o?i.round(o/36e5,0)+"h":2592e6>o?i.round(o/864e5,0)+"d":31104e6>o?i.round(o/2592e6,0)+"mo":i.round(o/10368e5)+"y"}function t(e){return 1e3>e?e:e>=1e3&&1e6>e?i.round(e/1e3,e>=1e5?0:1)+"k":i.round(e/1e6,e>=1e7?0:1)+"M"}var i=Cbola._,o=Cbola.InContent.Layers.Services.BasicService,n=Date.now(),r=function(){o.call(this),this.name="TweetsService"};return i.extend(r.prototype,o.prototype),r.prototype.transformServerResponse=function(n){var r=o.prototype.transformServerResponse.call(this,n);return i.map(r,function(i){return i.Favs=t(i.Favs),i.Retweets=t(i.Retweets),i.elapsedTime=e(i.PostDate||""),i.HasImage=!!i.HasImage,i})},r.prototype.addItem=function(e,t){o.prototype.addItem.apply(this,[i.first(this.transformServerResponse([e])),t])},new r}(),Cbola.Common=Cbola.Common||{},Cbola.Common.FontsManager=Cbola.Common.FontsManager||function(){function e(e){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),r.appendChild(t);try{if(a){var i=t.cloneNode();a.appendChild(i)}}catch(o){}}var t=Cbola._,i=Cbola.Env,o={},n={OpenSans:"Open+Sans:300italic,400italic,600italic,700italic,800italic,400,600,300,700,800",Oswald:"Oswald:400,700,300",Nunito:"Nunito:500,600,300,700,400",Roboto:"Roboto:500,300,700,400",Heebo:"Heebo:400,500"},r=document.getElementsByTagName("head")[0],a=null;try{a=window!==window.top?window.top.document.getElementsByTagName("head")[0]:null}catch(s){}var l={getKnowledge:t.once(function(){if(112441===i.domainId){var e=i.protocol+"//static.reutersmedia.net/resources_v2/fonts/Knowledge";o["Knowledge"]=!0;var t=document.createElement("style");t.appendChild(document.createTextNode("\n				@font-face {font-family: 'knowledge-regular';	src: url('"+e+"-Regular.woff') format('woff');	font-weight: normal; font-style: normal;}\n				@font-face {font-family: 'knowledge-medium'; src: url('"+e+"-Medium.woff') format('woff'); font-weight: normal; font-style: normal;}")),document.head.appendChild(t)}})};return t.forEach(n,function(i,o){l["get"+o]=t.once(function(){e("https://fonts.googleapis.com/css?family="+i)})}),l}(),Cbola.Globals=Cbola.Globals||{},Cbola.Globals.ElementIdFactory=Cbola.Globals.ElementIdFactory||function(){var e=void 0,t=0,i=window;try{window.top.document&&(i=window.top)}catch(o){}var n=function(){};n.prototype={getGlobalElementId:function(){return t++,-1*t},getElementId:function(){return t}};try{i!==window?(i.Cbola=i.Cbola||{},i.Cbola.Globals=i.Cbola.Globals||{},i.Cbola.Globals.ElementIdFactory=i.Cbola.Globals.ElementIdFactory||new n,e=i.Cbola.Globals.ElementIdFactory):e=new n}catch(o){e=new n}return e}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Factory=Cbola.InContent.Layers.Factory||function(){function e(e,t){var n=Cbola.Env;if(l.markStart(h+" -> creating layer "+e),o(e))if(n.DEBUG){var r=document.createElement("script");r.onload=function(){t&&t(i(e))};var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(r,a),r.src=n.clientPath+"container/layer_"+e+"/cbola_layer_"+e+n.clientPathType+".js"}else s.getLayerScript(e).then(function(){l.markEnd(h+" -> creating layer "+e),t&&t(i(e))}).catch(function(){c.errorM(h+".createAsync",h+".createAsync failed fetching layer "+e)});else l.markEnd(h+" -> creating layer "+e),t&&t(i(e))}function t(e){var t="";switch(e.type){case 100:case 101:case 110:Cbola.Env.DEBUG&&(e.data.DefaultSettings.FramedLayer=!0),t="in_content_container.html",Cbola.Utils.checkImageLoaded(e.data.Image);break;case 102:case 112:t=(n.get(e,"data.DefaultSettings.FramedLayer")?"framed_":"")+"in_content_container.html",r.checkImageLoaded(e.data.Image);break;case 120:case 121:t="desktop_trivia_container.html";break;case 130:case 131:case 132:case 133:case 134:case 135:case 136:case 137:case 138:case 139:case 140:case 150:case 151:case 152:case 153:t="sidebar_container.html";break;case 160:case 170:t="in_content_container.html";break;case 900:t="ad_only_container.html";break;case 1e3:case 1100:case 1400:t="mobile_container.html";break;default:throw c.errorM(h+".createLayerContainers",h+"->createLayerContainers failed to build container due to unknown layer type: "+e.type),new Error("Unknown layer type")}return e.topContainer=a.createElement(t),e.container=e.topContainer.querySelector(".layer-container"),e.container.classList.remove("layer-container"),e.topContainer.setAttribute("layerType",e.type.toString()),e.topContainer.classList.add("cbola-wid-"+e.widgetId),e.topContainer.classList.add("cbola-elem-id-"+e.elementId),r.isFirefox?e.topContainer.classList.add("cbola-ua-ff"):r.isIE&&e.topContainer.classList.add("cbola-ua-ie"),e}function i(e){c.info(h+".create -> creating layer "+e);var t=d.TYPES_TO_NAMES_MAP[e];return n.isEmpty(t)?(c.info(h+".create","No layer prototype found for layer "+e),null):new d[t]}function o(e){var t=d.TYPES_TO_NAMES_MAP[e];return n.isNil(d[t])}var n=Cbola._,r=Cbola.Utils,a=Cbola.Templates,s=Cbola.Common.RequestHandler,l=Cbola.Common.TimelineService,d=Cbola.InContent.Layers,c=Cbola.Logger.getInstance(),h="LayersFactory";return{createAsync:e,createLayerContainers:t}}(),Cbola.InContent.Layers.TYPES_TO_NAMES_MAP={100:"DesktopInContentSliderFactsLayer",101:"DesktopInContentSliderReadMoreLayer",102:"DesktopFactsCoverLayer",110:"DesktopInContentSliderOnThisDayLayer",112:"DesktopOnThisDayCoverLayer",120:"DesktopTriviaLayer",121:"DesktopTriviaMultiLayer",130:"SidebarFactsLayer",131:"SidebarFactsReadMoreLayer",132:"SidebarFactsWithSliderLayer",133:"SponsoredSidebarFactsLayer",134:"SidebarDiedOnThisDayLayer",135:"SidebarOnThisDayLayer",136:"SidebarSlideshowFactsLayer",137:"SidebarSlideshowOnThisDayLayer",138:"StoriesSlideshowFacts",139:"StoriesSlideshowOTD",140:"SidebarTriviaLayer",150:"SlideshowDiedOnThisDayLayer",151:"SlideshowDiedOnThisWeekLayer",152:"SlideshowFactsLayer",153:"SlideshowOnThisDayLayer",160:"DesktopTwitterLayer",170:"DesktopIndicesSlideshowLayer",900:"AdOnlyLayer",1e3:"MobileFactsLayer",1100:"MobileOnThisDayLayer",1400:"MobileTriviaLayer"},Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Types={FACTS:[100,101,102,110,130,131,132,133,136,138,152,1e3],TRIVIA:[120,121,140,1400],ON_THIS_DAY:[110,135,137,139,153,1100],TWITTER:[160],INDICES:[170],DIED_ON_THIS_DAY:[134,150],DIED_ON_THIS_WEEK:[151],AD_ONLY:Cbola.Config.layouts.adOnly.all,SIDEBAR:Cbola.Config.layouts.sideBars.all,SIDEBAR_SLIDESHOW:Cbola.Config.layouts.sideBars.sidebarSlideshow,PLAYBOX_SLIDESHOW:Cbola.Config.layouts.sideBars.slideShow,STORIES_SLIDESHOW:Cbola.Config.layouts.sideBars.storiesSlideshow,IN_CONTENT:Cbola.Config.layouts.inContent.all},Cbola.InContent.Layers.FormFactors={MOBILE:"mobile",TABLET:"tablet",DESKTOP:"desktop"},Cbola.InContent.Layers.Base=Cbola.InContent.Layers.Base||function(){var e=Cbola._,t=Cbola.Logger.getInstance(),i=Cbola.InContent.Layers.Types,o=function(){t.debug("Layers.Base::ctor"),this.formFactor=Cbola.InContent.Layers.FormFactors.DESKTOP};return e.extend(o.prototype,Cbola.Common.HasViewability.prototype),o.prototype.init=function(){var e=Cbola.Common.HasViewability.prototype;t.debug("Layers.Base::init"),e.init.call(this,this.container)},o.prototype.setOptions=function(e){t.debug("Layers.Base::setOptions"),this.options=e||{}},o.prototype.applyOptions=function(){t.debug("Layers.Base::applyOptions"),e.assign(this.container.style,{"margin-top":this.options.MarginTopCover+"px","margin-bottom":this.options.MarginBottomCover+"px","padding-bottom":this.options.PaddingBottomCover+"px"})},o.prototype.onBeforeLoad=function(){t.debug("Layers.Base::onBeforeLoad")},o.prototype.onLoad=function(){t.debug("Layers.Base::onLoad")},o.prototype.onAfterLoad=function(){t.debug("Layers.Base::onAfterLoad",this),Cbola.TaskManager.addTask(this.updateViewability,[],this)},o.prototype.bindEvents=function(){t.debug("Layers.Base::bindEvents")},o.prototype.unbindEvents=function(){t.debug("Layers.Base::bindEvents")},o.prototype.destroy=function(){t.debug("Layers.Base::destroy"),this.unbindEvents()},o.prototype.isMobile=function(){return this.formFactor===Cbola.InContent.Layers.FormFactors.MOBILE},o.prototype.isTablet=function(){return this.formFactor===Cbola.InContent.Layers.FormFactors.TABLET},o.prototype.isDesktop=function(){return this.formFactor===Cbola.InContent.Layers.FormFactors.DESKTOP},o.prototype.isSidebar=function(){var e=this;return i.SIDEBAR.some(function(t){return t===e.type})},o.prototype.isSidebarSlideshow=function(){var e=this;return i.SIDEBAR_SLIDESHOW.some(function(t){return t===e.type})},o.prototype.isStoriesSlideshow=function(){var e=this;return i.STORIES_SLIDESHOW.some(function(t){return t===e.type})},o.prototype.isPlaybox=function(){var e=this;return i.PLAYBOX_SLIDESHOW.some(function(t){return t===e.type})},o.prototype.isInContent=function(){var e=this;return i.IN_CONTENT.some(function(t){return t===e.type})},o.prototype.isFacts=function(){var e=this;return i.FACTS.some(function(t){return t===e.type})},o.prototype.isTrivia=function(){var e=this;return i.TRIVIA.some(function(t){return t===e.type})},o.prototype.isOnThisDay=function(){var e=this;return i.ON_THIS_DAY.some(function(t){return t===e.type})},o.prototype.isTwitter=function(){var e=this;return i.TWITTER.some(function(t){return t===e.type})},o.prototype.isIndices=function(){var e=this;return i.INDICES.some(function(t){return t===e.type})},o.prototype.isAdOnly=function(){var e=this;return i.AD_ONLY.some(function(t){return t===e.type})},o}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.Base=function(){var e=Cbola._,t=Cbola.Config,i={MarginTopCover:0,MarginBottomCover:0,PaddingBottomCover:0,ShowAdAnimation:!0,DesktopInContentMinWidth:null,SidebarTopContainerTextAlign:null,RemovePoweredByCarambola:!1,ShowAdvertisementTitleOnAds:!1,WithSeparators:!1,BannerBackgroundColor:null};return function o(n,r){_classCallCheck(this,o),e.extend(this,n.DefaultSettings),e.defaults(this,i),(0===this.ShowAdAnimation||"false"===this.ShowAdAnimation)&&(this.ShowAdAnimation=!1),this.themeColor=e.get(n,"DefaultSettings.InContentThemeColor",null)||e.get(n,"DefaultSettings.ThemeColor","rgb(62,209,217)");var a=t.getLayersDefaultSize(r),s=a.height,l=a.width;this.layerHeight=s,this.layerWidth=l}}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.AdOnlyOptions=function(){var e=Cbola._,t=Cbola.InContent.Layers.Options.Base,i={AdOnlyAlignment:null};return function(t){function o(t,n){_classCallCheck(this,o);var r=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,n));return e.defaults(r,i),r}return _inherits(o,t),o}(t)}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.DesktopFactsOptions=function(){var e=Cbola._,t=Cbola.InContent.Layers.Options.Base,i={InContentTitleBGColor:null,WidgetTitleFontColor:null,InContentTitleFontColor:null,RemoveInContentHeader:null,InContentTimerBackgroundColor1:"rgb(178,42,80)",InContentTimerBackgroundColor2:"rgb(167,38,76)",FramedLayer:!1,InContentAlignment:null};return function(t){function o(t,n){_classCallCheck(this,o);var r=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,n));return e.defaults(r,i),r}return _inherits(o,t),o}(t)}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.TriviaOptions=function(){var e=Cbola._,t=Cbola.InContent.Layers.Options.Base,i={HideSocialButtons:!1,BrandImg:null,BrandRedirect:null,DesktopTriviaTimerDuration:10,
DesktopTriviaTimerDisabled:!1,InContentThemeColor:"rgb(62, 209, 217)",InContentThemeHoverColor:"rgb(56, 185, 193)"};return function(t){function o(t,n){_classCallCheck(this,o);var r=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,n));return e.defaults(r,i),r.InContentThemeColor=r.InContentThemeColor||e.result(t,"DefaultSettings.ThemeColor",null),r}return _inherits(o,t),o}(t)}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.DesktopTriviaOptions=function(){var e=Cbola._,t=Cbola.InContent.Layers.Options.TriviaOptions,i={showTriviaButtonIcons:!0,TriviaColorSkin:null,inContentTriviaFloatType:null,MaxInContentTriviaWidth:650};return function(t){function o(t,n){_classCallCheck(this,o);var r=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,n));return e.defaults(r,i),"false"===r.showTriviaButtonIcons&&(r.showTriviaButtonIcons=!1),("undefined"==typeof r.DesktopInContentMinWidth||null===r.DesktopInContentMinWidth)&&(r.DesktopInContentMinWidth=500),r}return _inherits(o,t),o}(t)}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.DesktopTriviaMultiOptions=function(){var e=Cbola._,t=Cbola.InContent.Layers.Options.TriviaOptions,i={DesktopMultiTriviaBorderColor:null,DesktopMultiTriviaDisplayAnswerLetters:!0,DesktopMultiTriviaAdvertisementTitle:!1,MaxInContentTriviaWidth:640,DesktopMultiTriviaInGameTimerDuration:15,DesktopMultiTriviaEndGameTimerDuration:15,DesktopMultiTriviaEndGameImg:null,DesktopMultiTriviaEndGameLink:null,DesktopMultiTriviaBackgroundColor:null,DesktopMultiTriviaFontColor:null,MultiTriviaProgressFontColor:null};return function(t){function o(t,n){_classCallCheck(this,o);var r=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,n));return e.defaults(r,i),e.isNil(r.MultiTriviaProgressFontColor)&&(r.MultiTriviaProgressFontColor=r.InContentThemeColor),("undefined"==typeof r.DesktopInContentMinWidth||null===r.DesktopInContentMinWidth)&&(r.DesktopInContentMinWidth=480),Cbola.Env.DEBUG,r}return _inherits(o,t),o}(t)}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.IndicesOptions=function(){var e,t,i=Cbola._,o=Cbola.InContent.Layers.Options.Base,n={ARROW:1},r={IndicesActiveProgressColor:"#07aebc",IndicesButtonColor:"#ff9838",IndicesSlideshowAutoplayDuration:4,InContentAlignment:null};return t=e=function(e){function t(e,o){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));return i.defaults(n,r),n}return _inherits(t,e),t}(o),e.ButtonsStyle=n,t}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.MobileOptions=function(){var e=Cbola._,t=Cbola.InContent.Layers.Options.Base,i={MobileFontSize:null,MobileClippedHeight:0,MobilePaddingBottomCover:null,mobileThemeColor:"rgb(243,100,99)",mobileTitleFontSize:null,mobileFullScreen:JSON.stringify({mode:"portrait",outsideIframe:!1}),MobileInContentColorSkin:null,mobileTranslateZ:null,mobileCompressedHeight:!0,mobileShareEnabled:!0,BrandImg:null,BrandRedirect:null,mobileItemCount:null,mobileResizeCount:4};return function(t){function o(t,n){_classCallCheck(this,o);var r=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,n));return e.defaults(r,i),r.mobileShareEnabled=Cbola.Utils.parseBool(r.mobileShareEnabled),r.mobileItemCount&&(r.mobileItemCount=parseInt(r.mobileItemCount)),r}return _inherits(o,t),o}(t)}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.MobileFactsOptions=function(){var e=Cbola._,t=Cbola.InContent.Layers.Options.MobileOptions,i={mobileTitleImage:null,mobileTitleFontSize:null,mobileThemeColor:"#f36463",mobileAutoplayDuration:4};return function(t){function o(t,n){_classCallCheck(this,o);var r=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,n));return e.defaults(r,i),r}return _inherits(o,t),o}(t)}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.MobileTriviaOptions=function(){var e=Cbola._,t=Cbola.InContent.Layers.Options.MobileOptions,i=Cbola.InContent.Layers.Options.TriviaOptions,o={MobileTriviaColorSkin:null,mobileThemeColor:"#19C2CC"};return function n(r,a){_classCallCheck(this,n),e.extend(this,new i(r,a)),e.defaults(this,o),e.extend(this,new t(r,a))}}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.SidebarDiedOnOptions=function(){var e=Cbola._,t=Cbola.InContent.Layers.Options.Base,i={InContentTitleBGColor:null,InContentTitleFontColor:null};return function(t){function o(t,n){_classCallCheck(this,o);var r=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,n));return e.defaults(r,i),r}return _inherits(o,t),o}(t)}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.SidebarTriviaOptions=function(){var e=Cbola._,t=Cbola.InContent.Layers.Options.TriviaOptions,i={SbTriviaEndGameImgBottom:null,SbTriviaEndGameImgTop:null,SbTriviaScoreTextColor:null,SbTriviaEndGameImgLink:null,BrandClickTracker:null,SbTriviaEndGameClickTracker:null,SBTriviaPaddingBottomCover:25};return function(t){function o(t,n){_classCallCheck(this,o);var r=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,n));return e.defaults(r,i),r}return _inherits(o,t),o}(t)}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.SlideshowOptions=function(){var e,t,i=Cbola._,o=Cbola.Utils,n=Cbola.InContent.Layers.Options.Base,r={ArrowTeaser:1,SlideshowAutoplayDuration:4,SideboxStyleGuide:null,SideboxShareEnable:!0,PlayboxBrandImg:null,PlayboxBrandRedirect:null,PlayboxTextualHeader:null,PlayboxReutersStyleGuide:null,PlayboxThesaurusStyleGuide:null},a={BASIC:1,HIDDEN_BUTTONS:2,EXTENDED:3},s={BASIC:1};return t=e=function(e){function t(e,n){_classCallCheck(this,t);var s=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.defaults(s,r),o.isMobile&&(s.themeColor=i.get(e,"DefaultSettings.InContentThemeColor",i.get(e,"DefaultSettings.ThemeColor",i.get(e,"DefaultSettings.mobileThemeColor","rgb(62,209,217)")))),s.ArrowTeaser=o.parseBool(s.ArrowTeaser),s.PlayboxReutersStyleGuide===a.EXTENDED&&152===n&&(s.layerHeight=280),s}return _inherits(t,e),t}(n),e.ReutersStyleGuides=a,e.ThesaurusStyleGuides=s,t}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.StoriesSlideshow=function(){var e,t,i=Cbola._,o=Cbola.Utils,n=Cbola.InContent.Layers.Options.Base,r={SHARP:1,SHARP_LEFT:2,ROUND:3},a={SlideshowAutoplayDuration:10,StoriesSlideshowStyleGuide:r.ROUND,StoriesSlideshowBackgroundColor:"transparent",LayerExposureOnAdsReady:!0};return t=e=function(e){function t(e,n){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.defaults(r,a),o.isMobile&&(r.themeColor=i.get(e,"DefaultSettings.InContentThemeColor",i.get(e,"DefaultSettings.ThemeColor",i.get(e,"DefaultSettings.mobileThemeColor","rgb(62,209,217)")))),r}return _inherits(t,e),t}(n),e.StyleGuides=r,t}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.TwitterOptions=function(){var e=Cbola._,t=Cbola.InContent.Layers.Options.Base,i={SlideshowAutoplayDuration:5,TwitterColorSkin:null,TwitterBgColor:null,InContentAlignment:null};return function(t){function o(t,n){_classCallCheck(this,o);var r=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,n));return e.defaults(r,i),r}return _inherits(o,t),o}(t)}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.Options=Cbola.InContent.Layers.Options||{},Cbola.InContent.Layers.Options.Factory=Cbola.InContent.Layers.Options.Factory||function(){function e(e){var t=null;switch(e.type){case 100:case 101:case 102:case 110:case 112:t=new o.DesktopFactsOptions(e.data,e.type);break;case 120:t=new o.DesktopTriviaOptions(e.data,e.type);break;case 121:t=new o.DesktopTriviaMultiOptions(e.data,e.type);break;case 130:case 131:case 132:case 133:case 134:t=new o.Base(e.data,e.type);break;case 135:t=new o.SidebarDiedOnOptions(e.data,e.type);break;case 136:case 137:t=new o.SlideshowOptions(e.data,e.type);break;case 138:case 139:t=new o.StoriesSlideshow(e.data,e.type);break;case 140:t=new o.SidebarTriviaOptions(e.data,e.type);break;case 150:case 151:case 152:case 153:t=new o.SlideshowOptions(e.data,e.type);break;case 160:t=new o.TwitterOptions(e.data,e.type);break;case 170:t=new o.IndicesOptions(e.data,e.type);break;case 900:t=new o.AdOnlyOptions(e.data,e.type);break;case 1e3:case 1100:t=new o.MobileFactsOptions(e.data,e.type);break;case 1400:t=new o.MobileTriviaOptions(e.data,e.type);break;default:Cbola.Logger.getInstance().warnM("OptionsFactory.create","No options prototype found for layer "+e.type),t=null}return t=n(t)}var t=Cbola._,i=Cbola.Utils,o=Cbola.InContent.Layers.Options,n=function(e){if(t.isNil(e))return e;var o=i.getUrlParams();for(var n in e)e.hasOwnProperty(n)&&!t.isNil(o["cbola"+t.toLower(n)])&&(e[n]=o["cbola"+t.toLower(n)]);return e};return{create:e}}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Manager=function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.EventBus,o=Cbola.Config,n=Cbola.Env,r=Cbola.Templates,a=Cbola.TaskManager,s=Cbola.Enums,l=Cbola.Common.AnalyticsService,d=Cbola.Common.FontsManager,c=Cbola.Common.IframeBuster,h=Cbola.Common.RequestHandler,m=Cbola.Common.TimelineService,p=Cbola.Globals.AdsService,u=Cbola.Globals.ElementIdFactory,b=Cbola.Logger.Colors,f=Cbola.InContent.Layers.Base,g=Cbola.InContent.Layers.Factory,y=Cbola.InContent.Layers.Options.Factory,v=Cbola.Logger.getInstance(),w=s.PageRequestTypes,_=s.LoadStatusTypes,C=s.AbTests,I=s.IntegrationTypes,x=s.UnitLoadTypes,E=i.Events,S="InContentManager",T=function(e){var t=e.type;try{m.record(e.setOptions.bind(e),"layer "+t+" -> setOptions")(y.create(e)),m.record(e.init.bind(e),"layer "+t+" -> init")(),m.record(e.onBeforeLoad.bind(e),"layer "+t+" -> onBeforeLoad")(),m.markStart("layer "+t+" -> onLoad"),e.onLoad()}catch(i){v.errorM("runLayerLifecycle","Layer "+t+" failed on lifecycle loading flow")}},A=function(e){var i=e.detail;m.markEnd("layer "+i.type+" -> onLoad"),v.info(b.YELLOW,"WidgetLoad: "+t.getRunTimeInSecs()+"; for elementId: "+i.elementId+"; widgetId: "+i.widgetId,i.container),i.isSidebar()&&L(i),k(i);var o=m.record(i.onAfterLoad.bind(i),"layer "+i.type+" -> onAfterLoad");i.isIndices()&&i.isAdOnly()?o():(O(i).then(o),n.PageProperties.PageStatus=_.SUCCESS,l.setPageElementRequest({layer:i,loadStatus:_.SUCCESS}))},L=function(t){for(var i=t.topContainer.parentElement,n=o.getLayersDefaultSize(t.type),r=!1,a={width:["left","right"],height:["top","bottom"]},s=function(){r=!0;var t=window.getComputedStyle(i),o=i.getBoundingClientRect();e.forEach(n,function(e,n){var s="border-box"===t["boxSizing"]?a[n].reduce(function(e,i){return e+=parseInt(t["padding-"+i])||0},0):0;parseInt(o[n],10)-s<e&&(i.style["min-"+n]=e+s+"px",r=!1)}),i=i.parentElement};i&&!r;)s()},O=function(i){return t.toggleTransition(i.container,!1).then(function(){if(e.get(i,"options.LayerExposureOnAdsReady",!1)){var t=p.getTriggersManagerByElementId(i.elementId);if(!e.isNil(t)){var o=[];return o.push(t.managerReady()),o.push(new Promise(function(t){return setTimeout(t,e.get(i,"options.DelayLayerExposure")||3e3)})),Promise.race(o)}}return Promise.resolve()}).then(function(){return t.toggleTransition(i.container,!0)}).then(function(){i.container.style["opacity"]="1"})},k=function(t){e.get(t,"options.WithSeparators")&&t.topContainer.classList.add("cbola-separated")},P=function(e){return!t.isInIframe()&&!t.isElementDisplayed(e)},N=e.memoize(function(e){return f.prototype.isSidebar.apply(e)},function(e){return e.type}),B=function(){function r(){_classCallCheck(this,r),this.enabled=!1,this.inProcessByWidgetId={},this.layerByElementId={},this.layerByWidgetId={},this.activeLayersCounter=1,i.addEventListener(E.LAYER_READY,A)}return _createClass(r,[{key:"init",value:function(){this.enabled=!0}},{key:"createWidgetForPlaceholder",value:function(e,i){var o=this;this.enabled&&h.getPageElements(i).then(function(t){o.processPageElementsResponse(t,e)}).catch(t.noOp)}},{key:"processPageElementsResponse",value:function(t,i){if(n.IntegrationType===I.SAFE_FRAME&&!e.get(t,"DefaultSettings.EnableLoadOnKnownSafeFrame",!1))return l.setPageRequest(w.BLOCKED_KNOWN_SAFE_FRAME,t.IsServerCall),v.info(Cbola.Logger.Colors.RED,S+".processPageElementsResponse stopped due to blocking known safe frame."),void(this.enabled=!1);var o=t.widgetId;e.isNil(o)||(this.inProcessByWidgetId[o]=new D(this,i,t))}},{key:"destroyInProcessWidget",value:function(e){delete this.inProcessByWidgetId[e]}},{key:"onProcessSuccess",value:function(e){var i=S+".onLayerScriptFetched";e?(v.info(b.PALE_GREEN,"Finished uploading layer "+e.type+": "+t.getRunTimeInMilis()),this.layerByElementId[e.elementId]=e,this.layerByWidgetId[e.widgetId]=e,this.destroyInProcessWidget(e.widgetId),T(e)):v.errorM(i,i+" "+e.type+" has not known layer")}},{key:"getLayerByElementId",value:function(e){return this.layerByElementId[e]}},{key:"getLayerByWidgetId",value:function(e){return this.layerByWidgetId[e]}},{key:"checkMaxWidgets",value:function(){return this.activeLayersCounter<o.MaxWidgets?(this.activeLayersCounter+=1,this.activeLayersCounter):0}}]),r}(),D=function(){function s(o,r,a){var d=this;_classCallCheck(this,s),this.start=m.record(function(){var o="WidgetPreLoadProcess.start",r=isNaN(d.data.widgetId)?"0":d.data.widgetId;d.widgetId=r,n.widgetId=r;var a=u.getGlobalElementId();d.elementId=a;var s=d.manager.checkMaxWidgets();if(!s)return v.info("elementId: "+a+", failed because maxOfElements in page"),i.fire(E.ELEMENT_FAILED,{elementId:a,loadStatus:_.MAX_ELEMS_REACHED}),void d.manager.destroyInProcessWidget(r);var h="true"===t.dataset(d.placeholder,"manualBuild");if(h&&t.datasetRemove(d.placeholder,"status"),!e.isNil(t.dataset(d.placeholder,"status")))return void d.manager.destroyInProcessWidget(r);t.dataset(d.placeholder,"status","started"),t.dataset(d.placeholder,"elementId",a),t.dataset(d.placeholder,"activeId",s);var m={type:e.get(d.data,"DefaultSettings.Layouts[0].LayoutType"),itemType:e.get(d.data,"DefaultSettings.Layouts[0].ItemType")};return e.isNil(m.type)||e.isNil(m.itemType)?(v.errorM("WidgetPreLoadProcess.start","initialize InContent layer type error"),void d.manager.destroyInProcessWidget(r)):void(!h&&e.get(d.data,"DefaultSettings.outsideIframe",!1)&&t.isFriendlyIframe()?c.pushScriptAboveIframe(r)||(l.setPageRequest(w.INITIALIZE_FAILED,d.data.IsServerCall),d.manager.destroyInProcessWidget(r)):(d.withLocationSelector="undefined"!=typeof d.data.DefaultSettings.LocationSelector,d.withLocationSelector&&l.setPageRequest(w.PAGE_VIEW,d.data.IsServerCall),e.extend(m,{activeId:s,elementId:a,widgetId:r,data:d.data,iframeBuster:new c(d.data.DefaultSettings,r,m.type),scriptElement:d.placeholder,element:null,hbToken:t.dataset(d.placeholder,"modelsToken")}),m.iframeBuster.init(),d.layer=m,d.attachElementToSelector().then(d.testCompatibleContainer.bind(d),function(){v.info(b.PALE_RED,"findICSelectorElement was failed. elementId:"+a),i.fire(E.ELEMENT_FAILED,{elementId:a,loadStatus:_.SELECTOR_NOT_FOUND}),d.manager.destroyInProcessWidget(r)}).catch(function(e){l.setPageRequest(w.INITIALIZE_FAILED,m.data.IsServerCall),v.criticalM(o,"failed: initialize of IC was failed at "+o+". url: "+n.PageProperties.hostname,e),d.manager.destroyInProcessWidget(r)})))},"WidgetPreLoadProcess.start"),this.manager=o,this.placeholder=r,this.data=a,this.preBuild()}return _createClass(s,[{key:"preBuild",value:function(){var i=t.getUrlParams()["cbolaloadtype"]||(o.abTestId===C.LAYER_ON_PAGE_LOAD?x.PAGE_LOAD:e.get(this.data,"DefaultSettings.LoadType"))||x.ASYNC;switch(i){case x.DOM_LOADED:t.documentReady(this.start.bind(this));break;case x.PAGE_LOAD:t.pageReady(this.start.bind(this));break;default:this.start()}}},{key:"attachElementToSelector",value:function(){var e=this;return this.withLocationSelector?new Promise(function(i,n){var r=function r(s){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(l>=o.findICSelectorElementMaxRetries)return void n();v.debug("retry of SelectorElement for elementId: "+e.elementId+", cbola_findICSelectorElement function, retries: "+l);for(var d=0;d<s.length;d++){var c=s[d],h=document.querySelectorAll(c.SelectorValue);if(h.length>0){var m=h[Math.min(c.AppearancePosition,h.length-1)];return 1===c.LocationType?t.preappend(m,e.placeholder):m.appendChild(e.placeholder),void i()}}l+=1,v.warn("Selector element was not found"),a.addTask(r,[s,l],e)};r(e.data.DefaultSettings.LocationSelector)}):Promise.resolve()}},{key:"testCompatibleContainer",value:function(){var i=this,s="WidgetPreLoadProcess.testCompatibleContainer",d=r.createElement("width_check.html"),c=t.isFriendlyIframe()&&!t.isElementDisplayed(window.frameElement),h=P(d),m=[];t.after(this.placeholder,d),a.addExpBackoffTask({fn:function(r,a){for(var p=d.clientWidth,u=d,b=0,f=!1;0===p&&b<=o.maxParentElementsCheckWidth&&u;)try{"undefined"==typeof m[b]&&(m[b]=u.parentElement),u=m[b],b+=1,u&&(p=u.clientWidth,u.tagName&&"head"===u.tagName.toLowerCase()&&(f=!0))}catch(g){return l.setPageRequest(w.INITIALIZE_FAILED,i.data.IsServerCall),v.criticalM(s,"Initialize of IC was failed at "+s+" width element parents iteration. url: "+n.PageProperties.hostname,g),i.manager.destroyInProcessWidget(i.widgetId),!1}if(f)return l.setPageRequest(w.INITIALIZE_FAILED,i.data.IsServerCall),v.criticalM(s,"Script injected in page's head. url: "+n.PageProperties.hostname+", pageviewid: "+n.PageProperties.cbola_pageViewId),i.manager.destroyInProcessWidget(i.widgetId),!1;if(p>0)return d.remove(),i.checkMinWidth(p),!1;if(N(i.layer)&&!h&&!c&&!t.isInIframe())return i.buildStructure(),!1;if(a){var y="";h?y="In hidden containing element.":c?y="In hidden iFrame.":t.isInIframe()&&(y="In non-friendly iFrame."),v.errorM(s,"IC too small - div width is 0. "+y+" url: "+n.PageProperties.hostname),l.setPageRequest(c||h?w.HIDDEN_IFRAME:w.DIV_TOO_SMALL,i.data.IsServerCall,{width:0,height:e.get(d,"parentElement.clientHeight",0)}),d.remove(),i.manager.destroyInProcessWidget(i.widgetId)}},backoff:[500,1e3,2500,5e3]})}},{key:"checkMinWidth",value:function(t){var r="WidgetPreLoadProcess.checkMinWidth";try{var a=o.getLayerMinSizes(this.layer.type).width,s=e.get(this.placeholder,"parentElement"),d=P(s);if(t=Math.max(e.get(s,"clientWidth")||0,t+e.get(this.data,"DefaultSettings.MaxWidthCompensation",0)),a>t&&(d||!N(this.layer))){if(this.tryFallbackWidth(t))return;return this.withLocationSelector?(v.errorM(r,"ICsmall, selector element too small. Width: "+t+", url: "+n.PageProperties.hostname),i.fire(E.ELEMENT_FAILED,{elementId:this.elementId,loadStatus:_.SELECTOR_TOO_SMALL})):(v.errorM(r,"ICsmall, width too small for IC. Width: "+t+", url: "+n.PageProperties.hostname),l.setPageRequest(d?w.HIDDEN_IFRAME:w.DIV_TOO_SMALL,this.data.IsServerCall,{width:t,height:e.get(s,"clientHeight",0)})),void this.manager.destroyInProcessWidget(this.widgetId)}this.buildStructure()}catch(c){l.setPageRequest(w.INITIALIZE_FAILED,this.data.IsServerCall),v.criticalM(r,"failed: initialize of IC was failed at "+r+". url: "+n.PageProperties.hostname,c),this.manager.destroyInProcessWidget(this.widgetId)}}},{key:"tryFallbackWidth",value:function(e){for(var i=0;i<o.inContentFallbackWidths.length;i++){var n=o.inContentFallbackWidths[i];if(e>=n)return v.info(b.PALE_YELLOW,"trying fallback width "+n),this.layer.fallbackMinimalWidth=n,h.getPageElements(this.widgetId,n).then(this.fallbackLayerReset.bind(this)).catch(t.noOp),!0}return!1}},{key:"fallbackLayerReset",value:function(t){var i="WidgetPreLoadProcess.fallbackLayerReset";if(this.layer){this.data=this.layer.data=t;try{return this.layer.type=this.layer.iframeBuster.layerType=e.get(t,"DefaultSettings.Layouts[0].LayoutType"),this.layer.itemType=e.get(t,"DefaultSettings.Layouts[0].ItemType"),void this.buildStructure()}catch(o){v.info("initialize InContent layer type error")}}else v.errorM(i,i+" failed to reset layer");this.manager.destroyInProcessWidget(this.widgetId)}},{key:"buildStructure",value:function(){var e="WidgetPreLoadProcess.buildStructure";this.withLocationSelector||l.setPageRequest(w.PAGE_VIEW,this.data.IsServerCall);try{this.layer=g.createLayerContainers(this.layer),t.after(this.placeholder,this.layer.topContainer),this.layer.topContainer.style["z-index"]=o.zIndexLayer,this.fetchLayerScript()}catch(i){v.criticalM(e,"failed: initialize of IC was failed at "+e+". url: "+n.PageProperties.hostname,i)}}},{key:"fetchLayerScript",value:function(){var t=this;n.adsDisabled||this.adsProcessInit(),g.createAsync(this.layer.type,function(i){t.manager.onProcessSuccess(e.extend(i,t.layer))})}},{key:"adsProcessInit",value:function(){if(o.abTestId!==C.NO_ADS){p.addSovrnBeacon(this.data.DefaultSettings);var t=new Cbola.Common.Ads.Triggers.Manager({elementId:this.elementId,widgetId:this.widgetId,layerType:this.layer.type,footerBackground:e.get(this.data,"DefaultSettings.FooterFixedAdBackground")}),i=new Cbola.Common.Ads.Stores.Manager(this.elementId,this.widgetId,this.layer.type);p.registerLayerManager(t,i,this.elementId),d.getRoboto()}}}]),s}();return new B}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),cbolaStartDateFileUploaded=new Date;Cbola.Bootstrapper=Cbola.Bootstrapper||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Config,o=Cbola.Enums,n=Cbola.EventBus,r=Cbola.Env||{},a=Cbola.Common.AnalyticsService,s=Cbola.Common.TimelineService,l=Cbola.Common.LocalStorageService,d=Cbola.Common.UserService,c=Cbola.InContent.Manager,h=Cbola.InContent.Layers.Item,m=Cbola.InContent.Layers.Services.FactsService,p=Cbola.InContent.Layers.Services.OnThisDayService,u=Cbola.InContent.Layers.Services.DiedThisDayService,b=Cbola.InContent.Layers.Services.DiedThisWeekService,f=Cbola.InContent.Layers.Services.TriviaService,g=Cbola.InContent.Layers.Services.TweetsService,y=Cbola.Styles,v=Cbola.Logger.getInstance(),w=e.once(function(){a.setPageClose();try{e.result(window.top,"Cbola.Globals.ReportersManager.isPrimary",!1)&&(window.top.Cbola.Globals.ReportersManager.stopReporting(),delete window.top.Cbola.Globals.ReportersManager)}catch(t){}}),_=function(e){try{var t={};"undefined"!=typeof e&&(t.filename=e.filename||"",t.lineno=e.lineno||"",t.colno=e.colno||"",t.message=e.message||"",t.type=e.type||"",t.filename.toLowerCase().indexOf("carambo.la")>-1&&(v.info("ER of cbola was found"),a.setClientError(t)))}catch(i){}},C=function(e){var t=e.detail;v.info("Element fail: "+t.elementId+" \n",t);try{a.setPageElementRequest(t);var i=c.getLayerByElementId(t.elementId);i&&i.parentNode&&i.parentNode.removeChild(i)}catch(o){}},I=function(){var e=t.getUrlParams()["cboladebug"];e||(e=t.getParamsFromUrl(r.proxyElem.getAttribute("src"))["cbola_d"],e||(e=!1)),e=e&&"0"!==e?"1":l.getItem("cbolaDebug")||"0",r.DEBUG=1===parseInt(e),r.DEBUG&&(v.level=Cbola.Logger.Levels.TRACE)},x=function(){var e=t.getParamsFromUrl(r.proxyElem.getAttribute("src")),o=t.getUrlParams();r.queryServer=o["queryserver"]||e["queryserver"]||"0",r.activePid=o["cbolapid"]||e["pid"],r.wid=o["wid"]||e["wid"];var n=o["clientpath"]||e["clientpath"],a=i.clientPaths[n]||i.clientPaths["0"];a.alias&&(a=i.clientPaths[a.alias]);var s=a.withVersion?r.clientVersion:"";r.clientPath=""+a.path+s+"/",r.safeFramePath=""+(a.sfPath||a.path)+s+"/",r.clientPathType=a.isMin?".min":"",r.domainId=parseInt(e["did"])||0,r.adsDisabled=o["cbolanoads"]||!1,r.categoryId=e["categoryid"]||"",r.tags=e["tags"]||"",r.title=e["title"]||"",r.body=e["body"]||"",r.url=e["pageurl"]||"",r.hbToken=e["hb_token"]||void 0,r.proxyPageViewId=e["pvid"]||void 0,r.protocol=/^https?.*/g.test(window.location.protocol)?window.location.protocol:"https:",r.clientPath=""+r.protocol+r.clientPath,r.IntegrationType=t.integrationTypeCheck(),r.topWindow=t.isWindowTopSupported()?window.top:window,r.viewportWindow=t.isWindowTopSupported()||!t.isInIframe()?window.top:null,v.info("Working Path:"+r.clientPath+", QueryServer:"+r.queryServer+", ClientVer: "+r.clientVersion+", Pid: "+r.activePid)},E=function(){var e=r.proxyElem.getAttribute("mt"),t=r.proxyElem.getAttribute("mediatype"),i=r.proxyElem.getAttribute("cbola");return"ic"===e||"InContent"===t||"ic"===i?o.ProductTypes.IN_CONTENT:null},S=function(t){var i=t.getAttribute("srcurl");return e.isEmpty(i)?null:decodeURIComponent(i)},T=function(i){e.isEmpty(i)?e.isNil(r.PageProperties.cbola_pageViewId)&&(e.isNil(r.topWindow.cbola_pageViewId)&&(r.topWindow.cbola_pageViewId=t.generateViewId()),r.PageProperties.cbola_pageViewId=r.topWindow.cbola_pageViewId):(r.PageProperties.cbola_pageViewId=i,e.isNil(r.topWindow.cbola_pageViewId)||r.topWindow.cbola_pageViewId===i||v.alwaysSend("Bootstrapper.setPageViewId overridden existing page view id ("+r.topWindow.cbola_pageViewId+") with header bidding page view id ("+i+")"))},A=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Cbola.PageAnalytics.ReportersManager.isPrimary()){var i=e.get(t,"DefaultSettings.ActivePageReporters",null);Cbola.PageAnalytics.ReportersManager.init(i?i+",pageLoad":"pageLoad",e.result(t,"widgetId",0))}},L=function(){function l(){var w=this;_classCallCheck(this,l),this.init=s.record(function(){if(r.proxyElem=document.getElementById(i.proxyId),!r.proxyElem)return void v.info(Cbola.Logger.Colors.PALE_RED,"Cbola script is missing");if(r.proxyElem.getAttribute("status")&&0===document.querySelectorAll(".cbolaExtension").length)return void v.info(Cbola.Logger.Colors.PALE_RED,"Cbola script again");r.proxyElem.setAttribute("status","started"),r.clientVersion="2.33.0",r.proxyId=i.proxyId,r.userId=0,I(),x(),i.init(),T(r.proxyPageViewId),v.enableServer(),v.alwaysSendM("Bootstrapper.init","first log. pid: "+r.activePid+", did: "+r.domainId+", wid: "+(e.isEmpty(r.wid)?"0":r.wid)+" , abTestId: "+i.abTestId+", pageViewId: "+r.PageProperties.cbola_pageViewId+", randomLogId: "+Math.floor(899*Math.random()+100)+", ClientVersion: "+r.clientVersion);var n=r.PageProperties;if(n.startDateFileUploaded=cbolaStartDateFileUploaded,n.originalPathNameHost=t.getLocationHref(),e.isArray(i.srcUrlEnabledDids)&&i.srcUrlEnabledDids.some(function(e){return e===r.domainId})&&(n.SrcUrl=t.getLocationHref()),n.hostname=t.queryStringCutRegex(),n.secondGlobal=t.setGlobalRedirectTime(),!e.isEmpty(r.url)&&!/^([[{])/g.test(r.url)){var a="";e.forEach({CategoryId:r.categoryId,Tags:r.tags,Title:r.title,Body:r.body},function(t,i){e.isEmpty(a)||(a+="&"),e.isEmpty(t)||(a+=i+"="+t)}),n.hostname=(""+decodeURIComponent(r.url)+(e.isEmpty(a)?"":"?"+a)).toLowerCase()}return n.isMobile=t.isMobile,n.isTablet=t.isTablet(),n.urlHashMD5=CryptoJSCbola.MD5(n.hostname).toString(),n.urlHashSHA1=CryptoJSCbola.SHA1(n.hostname).toString(),t.detectDeviceOrientation(),v.info("hostname: "+n.hostname),v.info("MD5 hash: "+n.urlHashMD5+" SHA1 hash: "+n.urlHashSHA1+" pid: "+r.activePid),i.abTestId===o.AbTests.NO_LAYER?void A():(c.init(),w.bindEvents(),void w.checkForPendingScripts())},"Bootstrapper.init"),this.loadLayerFromScript=s.record(function(){if(0!==w.deferredLayerScriptTags.length&&E()===o.ProductTypes.IN_CONTENT)for(;w.deferredLayerScriptTags.length>0;){var i=w.deferredLayerScriptTags.shift(),n=parseInt(i.getAttribute("cbola_wid"));if(n||(n=0,i.setAttribute("cbola_wid","0")),w.isExistingWidgetId(n))a.setPageElementRequest({layer:{widgetId:n},loadStatus:o.LoadStatusTypes.SAME_ID_WIDGETS}),v.info(Cbola.Logger.Colors.PALE_RED,"There are scripts with the same wid: "+n);else{w.widgetIdArray.push(n),e.isEmpty(r.PageProperties.SrcUrl)&&(r.PageProperties.SrcUrl=S(i));var s=t.dataset("modelsPvid");s&&T(s),t.fixPixelHeight(i),c.createWidgetForPlaceholder(i,n)}}},"Bootstrapper.loadLayerFromScript"),this.initializeServices=s.record(function(i){var o=h.Types;if(i){i.Language&&d.setLanguage(i.Language),i.Items&&e.get(i,"DefaultSettings.OTDIgnoreClientDate")&&p.setIgnoreClientDate(!0,i.Items[0]);var n=e.get(i,"DailyItemsCount");if(n&&(p.setTotalItemsForToday(n),u.setTotalItemsForToday(n),b.setTotalItemsForThisWeek(n)),i.Items){var a=i.widgetId;i.Items=e.map(i.Items,function(e){return new h(e)});for(var s=0;s<i.Items.length;s++){var l=i.Items[s];l.Type===o.FACT||l.Type===o.TIP?m.addItem(l,a):l.Type===o.ON_THIS_DAY?p.addItem(l,a):l.Type===o.DIED_THIS_DAY?(u.addItem(l,a),b.addItem(l)):l.Type===o.TRIVIA||l.Type===o.TRIVIA_MULTI||l.Type===o.TRIVIA_MULTI_PAIRS?f.addItem(l):l.Type===o.TWEET&&g.addItem(l,a)}}var c=t.getParamsFromUrl(r.PageProperties.originalPathNameHost.toLowerCase())["cbolagameset"];f.setFirstItemId(c)}},"Bootstrapper.initializeServices"),this.initPlatform=e.once(s.record(function(t){r.PageProperties.Domain=e.get(t,"Domain",0),r.PageProperties.Category=e.get(t,"Category",0),r.PageProperties.PageId=e.get(t,"PageId",0),y.injectMainStyle(document,"cbolaStyle.css"),r.topWindow!==window&&y.injectMainStyle(r.topWindow.document,"cbolaStyle.css"),t.DefaultSettings=t.DefaultSettings||{},i.MaxWidgets=t.DefaultSettings.MaxWidgets||9999,i.zIndexLayer=t.DefaultSettings.ZIndexLayer||i.zIndexLayer,Cbola.Globals.AdsService.onlyOneRegistration=e.get(t,"DefaultSettings.AllowSingleAdServiceRegistration",!1),Cbola.Common.ConsentProviders.Manager.init({gfc:e.get(t,"DefaultSettings.EnableGFC",!1)}),A(t),n.fire(n.Events.PLATFORM_INITIALIZED)},"Bootstrapper.initPlatform")),Cbola.Env=r||{},e.defaults(Cbola.Env,{PageProperties:{optOutCookie:!1,IsServerCall:o.isServerCallTypes.FROM_CDN,PageStatus:0,unloadAlreadyDetected:!1,startTime:new Date,clientIP:""}}),this.deferredLayerScriptTags=[],this.widgetIdArray=[]}return _createClass(l,[{key:"bindEvents",value:function(){var e=this;n.addEventListener(n.Events.PAGE_ELEMENTS_DATA_RECEIVED,function(t){var i=t.detail;e.initPlatform(i),e.initializeServices(i)}),n.addEventListener(n.Events.ELEMENT_FAILED,C),window.addEventListener("error",_),window.addEventListener("beforeunload",w),window.addEventListener("unload",w)}},{key:"checkForPendingScripts",value:function(){var n=this,r=e.filter(document.querySelectorAll("."+i.inContentClass),function(e){return"script"===e.tagName.toLowerCase()});return 0===r.length&&(r=document.querySelectorAll("."+i.placeholderClass),0===r.length)?(a.setPageRequest(o.PageRequestTypes.NO_PLACEHOLDER_FOUND,o.isServerCallTypes.FROM_CDN),void v.info(Cbola.Logger.Colors.PALE_RED,"No placeholder found in page - terminating load process")):(r=e.filter(r,function(e){
return null===t.dataset(e,"queued")}),e.forEach(r,function(e){t.dataset(e,"queued",!0),n.deferredLayerScriptTags.push(e)}),this.deferredLayerScriptTags.length>0&&this.loadLayerFromScript(),void(t.getRunTimeInSecs()<i.checkPendingICscriptsTimeLength&&Cbola.TaskManager.addTask(this.checkForPendingScripts,[],this,"checkForPendingScripts")))}},{key:"isExistingWidgetId",value:function(e){return this.widgetIdArray.some(function(t){return t===e})}}]),l}();return L}();var _slicedToArray=function(){function e(e,t){var i=[],o=!0,n=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(l){n=!0,r=l}finally{try{!o&&s["return"]&&s["return"]()}finally{if(n)throw r}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Cbola.Common=Cbola.Common||{},Cbola.Common.PrebidAdaptor=Cbola.Common.PrebidAdaptor||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.EventBus,o=Cbola.Enums,n=Cbola.Env,r=Cbola.Common.AnalyticsService,a=Cbola.Common.RequestHandler,s=Cbola.Common.UserService,l=i.Events,d=Cbola.Logger.getInstance(),c=Cbola.Logger.Colors.ORANGE,h=o.HeaderBiddingRequestStatus,m="PrebidAdaptor",p=2e3,u=window.Cbola_pbjs||null,b=0,f=function(){return b+=1},g=!1,y={promise:null,getReady:function(){if(!this.promise){var t=new Promise(function(t){i.addEventListener(l.GET_ADS_READY,e.once(function(i){var o=i.detail.data;t(e.get(o,"PbConfigType1"))}))});this.promise=Promise.all([s.isEUUserAsync(),t])}return this.promise}};y.getReady();var v={promise:null,getReady:function(){var e=this;return u?Promise.resolve():(this.promise||(this.promise=a.getJsBundle("external/prebid.min.js").then(function(){u=u||window.Cbola_pbjs},function(){return e.promise=null,Promise.reject()})),this.promise)}},w=[y,v],_=e.once(function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=e.first(i),r=e.last(i),a=/^(?:https?:\/\/)?(?:www\.)?([^:\/\n]+)\/?/gi,s=a.exec(t.getLowerLocationHref()),l=_slicedToArray(s,2),h=(l[1],{schain:{validation:"strict",config:{ver:"1.0",complete:1,nodes:[{asi:"carambo.la",sid:n.activePid,hp:1}]}}});r&&(d.info(c,"Prebid config: setting user sync for bidders -> "+r),h.userSync={syncEnabled:!0,syncDelay:6e3,filterSettings:{iframe:{bidders:r.split(",").map(function(e){return e.trim()}),filter:"include"}}}),o&&(d.info(c,"Prebid config: setting consent management"),h.consentManagement={gdpr:{cmpApi:"iab",timeout:8e3},usp:{}}),d.info(c,"Prebid config:",h),u.setConfig(h)}),C=function(t,i){var o="executeAuction";if(e.isEmpty(t))return Promise.reject(new Error("No bid instances provided"));var n=e.result(t,"[0].getTranslatedSizes",{width:0,height:0}),r=n.width,a=n.height;if(!r||!a)return Promise.reject(new Error("No valid size for auction"));var s=I(t),l=e.reduce(s,function(e,t,i){return e.push({code:i,mediaTypes:{banner:{sizes:[[r,a]]}},bids:t.map(function(e){return e.getBidRequest()})}),e},[]);return x(l,i).then(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=[],n=[];return d.info("cbolaPbjs bid response: ",t),e.forEach(t,function(t,r){var a=e.get(t,"bids")||[];e.forEach(a,function(t){var a=t.bidder,l=e.remove(s[r],function(e){return e.getBidder()===a});if(0===l.length)return void d.alwaysSendM(m+"."+o,m+"."+o+" failed to match bid to ad object, bidder: "+a);var c=e.first(l);if(t.cpm&&t.cpm>0){var p=t.ad||(t.adUrl?'<IFRAME SRC="'+t.adUrl+'" width="'+t.width+'" height="'+t.height+'" FRAMEBORDER="0" SCROLLING="no" MARGINHEIGHT="0" MARGINWIDTH="0" TOPMARGIN="0" LEFTMARGIN="0" ALLOWTRANSPARENCY="true"></IFRAME>':null);p&&(c.setCPM(t.cpm),c.setTag(p),c.setResponseTimestamp(t.responseTimestamp||Date.now()),c.setTimeToRespond(t.timeToRespond))}i.push(c),n.push({TagId:c.getID(),Cpm:c.getCPM(),Status:h.SUCCESS})})}),e.forEach(s,function(t){e.forEach(t,function(e){i.push(e),n.push({TagId:e.getID(),Cpm:0,Status:h.TIMEOUT})})}),E(n),Object.keys(s).forEach(function(e){return u.removeAdUnit(e)}),Promise.resolve(i)})},I=function(t){var i=e.groupBy(t,function(e){return e.getBidder()}),o=[],n={};return e.forEach(i,function(t){e.forEach(t,function(t,i){var r=o[i];"undefined"==typeof r&&(r="cbola_code_"+e.random(10,1e3)+"-"+f(),o[i]=r,n[r]=[]),n[r].push(t)})}),n},x=function(e,t){var i=new Promise(function(i){u.requestBids({bidsBackHandler:i,timeout:t,adUnits:e})}),o=new Promise(function(e){setTimeout(e,t+50)});return Promise.race([i,o])},E=function(t){t&&t.length>0&&(t.push({TagId:e.first(t).TagId,Status:h.REQUEST_MADE}),r.setHbBidRequestProto(t))};return{auction:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p;return g?C(t,i):Promise.all(w.map(function(e){return e.getReady()})).then(function(o){return _(e.first(o)),g=!0,C(t,i)})}}}();var _Cbola$Common$Ads$Wri;Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Writers=Cbola.Common.Ads.Writers||{},Cbola.Common.Ads.Writers.Factory=Cbola.Common.Ads.Writers.Factory||function(){function e(e){return e=t(e),n.isNil(d[e])?(i(e)?(s.alwaysSend(c+".getAsync fetching bundle. Type:"+e),d[e]=a.getJsBundle("external/ad_writers_bundle.js").then(function(){return Promise.resolve(o(e))}).catch(function(){return Promise.reject(new Error(" "+c+" failed to fetch ad writers bundle."))})):d[e]=Promise.resolve(o(e)),d[e]):d[e]}function t(e){return n.isNil(l.TYPES_TO_NAMES_MAP[e])?(s.alwaysSendOnce(c+" adjusted deprecated writer type: "+e),r.defaultAdsExtractType):e}function i(e){var t=l.TYPES_TO_NAMES_MAP[e];return n.isNil(l[t])}function o(e){s.info(c+".getWriter. getting writer type: "+e);var t=l.TYPES_TO_NAMES_MAP[e];return n.isEmpty(t)?(s.errorM(c+".getWriter","No Writer prototype found for writer "+e),null):l[t]}var n=Cbola._,r=Cbola.Config,a=Cbola.Common.RequestHandler,s=Cbola.Logger.getInstance(),l=Cbola.Common.Ads.Writers,d={},c="WritersFactory";return{getAsync:e}}(),Cbola.Common.Ads.Writers.TYPES_TO_NAMES_MAP=(_Cbola$Common$Ads$Wri={0:"IframeWriter"},_defineProperty(_Cbola$Common$Ads$Wri,Cbola.Enums.TagExtractionTypes.SRCDOC_IFRAME,"IframeSrcdocWriter"),_defineProperty(_Cbola$Common$Ads$Wri,Cbola.Enums.TagExtractionTypes.WRITE_IFRAME,"IframeWriter"),_defineProperty(_Cbola$Common$Ads$Wri,Cbola.Enums.TagExtractionTypes.CONFIANT_IFRAME,"ConfiantIframeWriter"),_defineProperty(_Cbola$Common$Ads$Wri,Cbola.Enums.TagExtractionTypes.AD_LIGHTNING_IFRAME,"AdLightningIframeWriter"),_defineProperty(_Cbola$Common$Ads$Wri,Cbola.Enums.TagExtractionTypes.SAFE_FREAME,"SafeFrameWriter"),_defineProperty(_Cbola$Common$Ads$Wri,Cbola.Enums.TagExtractionTypes.STD_SAFE_FRAME,"StandardSafeFrameWriter"),_defineProperty(_Cbola$Common$Ads$Wri,Cbola.Enums.TagExtractionTypes.WEATHER_AD_LIGHTNING,"AdLightningIframeWriter"),_defineProperty(_Cbola$Common$Ads$Wri,Cbola.Enums.TagExtractionTypes.FINANCE_AD_LIGHTNING,"AdLightningIframeWriter"),_Cbola$Common$Ads$Wri),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Writers=Cbola.Common.Ads.Writers||{},Cbola.Common.Ads.Writers.IframeWriter=Cbola.Common.Ads.Writers.IframeWriter||function(){function e(e,o,n){var r=t.createAdIframe(n.getTranslatedSizes());e.appendChild(r);var a=r.contentDocument;a.open(),a.write("<head>"+("https:"!==i.topWindow.location.protocol||t.isIE?"":'<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">')+"</head><body>"+o+"</body>"),a.close()}var t=Cbola.Utils,i=Cbola.Env;return{write:e,name:"iframe_write"}}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Writers=Cbola.Common.Ads.Writers||{},Cbola.Common.Ads.Writers.ConfiantIframeWriter=Cbola.Common.Ads.Writers.ConfiantIframeWriter||function(){function e(e,c,h){var m=h.getTranslatedSizes(),p=t.createAdIframe(m);e.appendChild(p);var u=p.contentDocument;u.open(),"https:"!==i.topWindow.location.protocol||t.isIE||u.write('<head><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"></head>');var b=h.getID(),f={adId:b,ad:c,bidder:b,size:m.width+"x"+m.height,cpm:0},g=function(){var i=t.dataset(e,"elementId");n.setBlockedAdRequest(i,b,r.CONFIANT_BLOCK),o.info("Confiant found malware ad for tag id: "+b);var s=Cbola.Globals.AdsService.getTriggersManagerByElementId(i);if(s){var l=t.dataset(e,"apperance"),d=t.dataset(e,"spot"),c=t.dataset(e,"bannerId");s.malwareRefresh(l,d,c,a.REFRESH_CONFIANT_BLOCK)}};d(u,f,s,l,g)||(u.write(c),u.close())}var t=Cbola.Utils,i=Cbola.Env,o=Cbola.Logger.getInstance(),n=Cbola.Common.AnalyticsService,r=Cbola.Enums.AdInjectionBlockType,a=Cbola.Enums.AdInjectionTypes,s="clarium.global.ssl.fastly.net",l="kj7Ux6NuzZRX9RuZUDxzW2kAL60",d=function(e,t,i,o,n){function r(e){return(m(e)||"")[y]("/","_")[y]("+","-")}function a(t,i,o){var n=C+p(t)+"&d="+i,r="err__"+1*new Date;c[r]=o;var a="<"+f+" on"+v+'="void('+r+'())" '+g+'="'+n+'" type="text/java'+f+'" ></'+f+">";e[_](a)}function s(){var i=r(o+"/"+I.k.hb_bidder[0]+":"+I.k.hb_size[0]),s={wh:i,wd:h.parse(h[w](I)),wr:0};a(i,r(h[w](s)),function(){e[_](t.ad)});var l={prebid:{adId:t.adId,cpm:t.cpm}},d={d:s,t:t.ad,cb:n,id:l};c[o]={},c[o][i]=d}var l=t.bidder,d=t.size,c=e.parentWindow||e.defaultView,h=c.JSON,m=c.btoa,p=c.encodeURIComponent;if(!h||!m)return!1;var u="t",b="i",f="script",g="src",y="replace",v="error",w="stringify",_="wr"+b+u+"e",C="https://"+i+"/?wrapper="+p(o)+"&tpid=",I={k:{hb_bidder:[l],hb_size:[d]}};return s(),e.close(),!0};return{write:e,name:"confiant_write"}}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Writers=Cbola.Common.Ads.Writers||{},Cbola.Common.Ads.Writers.AdLightningIframeWriter=Cbola.Common.Ads.Writers.AdLightningIframeWriter||function(){function e(e,n,a){p();var s=a.getTranslatedSizes(),l=a.getID(),d=a instanceof Cbola.Common.Ads.Tags.HeaderBiddingRequest?"HB":"WF",c="";switch(a.getTagExtractionType()){case i.TagExtractionTypes.WEATHER_AD_LIGHTNING:c="-weather";break;case i.TagExtractionTypes.FINANCE_AD_LIGHTNING:c="-finance"}var m={adId:l,tag:n,tagType:d,platform:u(),providerId:a.getProviderID(),message:""+h+JSON.stringify({adId:l,elemId:o.dataset(e,"elementId"),apperance:o.dataset(e,"apperance"),spot:o.dataset(e,"spot"),bannerId:o.dataset(e,"bannerId")}),scriptSuffix:c};t.extend(m,s);var b=o.createAdIframe(s);e.appendChild(b);var f=r.getCompiledTemplate("ad_lightning_iframe.html"),g=b.contentDocument;g.open(),g.write(f(m)),g.close()}var t=Cbola._,i=Cbola.Enums,o=Cbola.Utils,n=Cbola.Env,r=Cbola.Templates,a=Cbola.Logger.getInstance(),s=Cbola.Common.AnalyticsService,l=Cbola.Enums.AdInjectionBlockType,d=Cbola.Enums.AdInjectionTypes,c="AdLightningIframeWriter",h="carambola_ADL_",m=h.length,p=t.once(function(){window.addEventListener("message",b)}),u=t.memoize(function(){return n.PageProperties.isMobile?"Mob":n.PageProperties.isTablet?"Tab":"Des"}),b=function(e){var t="blockedAdMessageHandler";if(e.origin===window.location.origin&&"string"==typeof e.data&&e.data.startsWith(h)){var i={};try{i=JSON.parse(e.data.substr(m))}catch(o){return void a.errorM(c+"."+t,c+"."+t+" failed on message parsing - "+e.data+".",o)}var n=i,r=n.elemId,p=n.apperance,u=n.spot,b=n.bannerId,f=n.adId;s.setBlockedAdRequest(r,f,l.AD_LIGHTNING_BLOCK),a.info("Ad Lightning found Malware ad for tag id: "+f);var g=Cbola.Globals.AdsService.getTriggersManagerByElementId(r);g&&g.malwareRefresh(p,u,b,d.REFRESH_AD_LIGHTNING_BLOCK)}};return{write:e,name:"ad_lightning_write"}}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Writers=Cbola.Common.Ads.Writers||{},Cbola.Common.Ads.Writers.StandardSafeFrameWriter=Cbola.Common.Ads.Writers.StandardSafeFrameWriter||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Env,o=Cbola.Common.RequestHandler,n=0,r=0,a=function(){return"cbola-sf-"+n++},s=function(){return"cbolaSafeFramePosition"+r++},l=window.$sf?window.$sf:null,d=null,c={},h=function(){for(var e=arguments.length,t=Array(e),i=0;e>i;i++)t[i]=arguments[i];m(),p().then(function(){u.apply(void 0,t)})},m=e.once(function(){c={renderFile:i.safeFramePath+"sf/stdsf"+i.clientPathType+".html",auto:!1}}),p=function(){return l?d=Promise.resolve():d||(d=o.getJsBundle("sf/base"+i.clientPathType+".js").then(function(){return o.getJsBundle("sf/host"+i.clientPathType+".js")}).then(function(){l=window.$sf.host})),d},u=function(e,i,o){var n=o.getTranslatedSizes(),r=t.createAdIframe(n);e.appendChild(r);var d=s(),h=o.getTranslatedSizes(),m=h.width,p=h.height,u={id:d,w:m,h:p},b=a();r.id=b,new l.PosConfig(u,b,c);var f=new l.Position(d,i);l.render(f)};return{write:h,name:"std_sf_writer"}}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Tags=Cbola.Common.Ads.Tags||{},Cbola.Common.Ads.Tags.Base=Cbola.Common.Ads.Tags.Base||function(){var e,t,i=Cbola.Logger.getInstance(),o=Cbola.Logger.Colors.ORANGE,n=Cbola._,r="BaseTag",a=135;return t=e=function(){function e(t){_classCallCheck(this,e),n.extend(this,t),this.sizeName=e.getAdSizeName(t),this.usedCounter=0,this.unAvailabilityParams={timeoutDelay:!1}}return _createClass(e,null,[{key:"getAdSizeName",value:function(t){var o=t.AdWidth+"_"+t.AdHeight;return e.AD_SIZES["W"+t.AdWidth+"H"+t.AdHeight]||i.warnOnceM(r+".getAdsSizeName",r+".getAdsSizeName encountered unfamiliar ad size: "+o),o}}]),_createClass(e,[{key:"onSelection",value:function(){return this.updateUsedCounter(),this.ProviderId===a&&this.delayAvailabilityBySec(),this}},{key:"delayAvailabilityBySec",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;i.info(o,"Base ad tag ("+this.sizeName+", "+this.Id+"): disabling availability for 60 sec"),this.unAvailabilityParams.timeoutDelay=!0,setTimeout(function(){i.info(o,"Base ad tag ("+e.sizeName+", "+e.Id+"): re-enabling timeout delay availability"),e.unAvailabilityParams.timeoutDelay=!1},1e3*t)}},{key:"updateUsedCounter",value:function(){this.usedCounter+=1}},{key:"getSizeName",value:function(){return this.sizeName}},{key:"getPriority",value:function(){return n.result(this,"Priority")||0}},{key:"getWeight",value:function(){return n.result(this,"Weight")||1}},{key:"getTypeName",value:function(){return this.isVideo()?e.AD_TYPES.VIDEO.name:e.AD_TYPES.DISPLAY.name}},{key:"getID",value:function(){return this.Id||0}},{key:"getMaxCap",value:function(){return this.MaxCap||0}},{key:"getProviderID",value:function(){return this.ProviderId}},{key:"getTag",value:function(){return this.Tag}},{key:"getTranslatedSizes",value:function(){return e.translateSize(this.AdWidth,this.AdHeight)}},{key:"getTagExtractionType",value:function(){return this.TagExtractionType||Cbola.Config.defaultAdsExtractType}},{key:"isPremium",value:function(){return this.Mode===e.AD_MODES.PREMIUM}},{key:"isVideo",value:function(){return this.AdType===e.AD_TYPES.VIDEO.num}},{key:"isDisplay",value:function(){return this.AdType===e.AD_TYPES.DISPLAY.num}},{key:"isMaxCaped",value:function(){return this.MaxCap>0&&this.MaxCap<=this.usedCounter}},{key:"isAvailable",value:function(){return!this.isMaxCaped()&&!n.some(this.unAvailabilityParams)}},{key:"isHeaderBidding",value:function(){return this.IsHb}},{key:"shouldShowX",value:function(){return this.ShowX}}]),e}(),e.translateSize=n.memoize(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{width:e,height:parseInt(10*Math.floor(t/10))}},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e+"_"+t}),e.AD_TYPES={DISPLAY:{name:"DisplayAdTag",num:0},VIDEO:{name:"VideoAdTag",num:1}},e.AD_SIZES={W300H250:"300_250",W300H251:"300_251",W300H252:"300_252",W300H600:"300_600",W728H90:"728_90",W320H50:"320_50",W728H91:"728_91",W728H92:"728_92",W310H260:"310_260",W400H300:"400_300",W500H300:"500_300",W630H90:"630_90",W10hH0:"10_10"},e.AD_MODES={REGULAR:1,PERFORMANCE:2,PREMIUM:3,HEADER_BIDDING:6,CPI:9},t}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Stores=Cbola.Common.Ads.Stores||{},Cbola.Common.Ads.Stores.Base=Cbola.Common.Ads.Stores.Base||function(){var e=Cbola._,t=function(){function t(e){_classCallCheck(this,t),this.elemId=e.elemId,this.wid=e.wid,this.inventory={},this.store={}}return _createClass(t,[{key:"addToInventory",value:function(t){var i=t.getSizeName();e.isNil(this.inventory[i])&&(this.inventory[i]=[]),this.inventory[i].push(t)}},{key:"init",value:function(){return this}}]),t}();return t}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Stores=Cbola.Common.Ads.Stores||{},Cbola.Common.Ads.Tags.Waterfall=Cbola.Common.Ads.Tags.Waterfall||function(){var e=Cbola.Common.Ads.Tags.Base,t=Cbola.Logger.getInstance(),i=Cbola.Logger.Colors.ORANGE;return function(e){function o(e){_classCallCheck(this,o);var t=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,e));return t.inQueue=!1,t.psaCounter=0,t.unAvailabilityParams.maxPSA=!1,t}return _inherits(o,e),_createClass(o,[{key:"setInQueue",value:function(e){this.inQueue=e}},{key:"isInQueue",value:function(){return this.inQueue}},{key:"incrementPSACount",value:function(e){this.psaCounter+=1,this.isMaxedPSA()&&(t.info(i,"WF Tag("+this.getID()+"): reached max PSA cap ("+this.PsaTagCap+") - removing from inventory."),this.unAvailabilityParams.maxPSA=!0,e.removeWaterfallAd(this))}},{key:"isMaxedPSA",value:function(){return!!this.PsaTagCap&&this.PsaTagCap===this.psaCounter}}]),o}(e)}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.WaterfallQueue=Cbola.Common.Ads.WaterfallQueue||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Logger.getInstance(),o=Cbola.Logger.Colors.ORANGE,n=Cbola.Common.Ads.Tags.Base.AD_TYPES,r=function(){function r(t){var i=this;_classCallCheck(this,r),this.sizeName=t,this.queues={},e.forEach(n,function(e){i.queues[e.name]=[]})}return _createClass(r,[{key:"isEmpty",value:function(t){var i=e.result(this,"queues."+t);return e.isNil(i)||e.isEmpty(i)||!i.some(function(e){return e.isAvailable()})}},{key:"pushAdsByTypeName",value:function(n,r){e.forEach(n,function(e){return e.setInQueue(!0)}),t.push.apply(this.queues[r],n),i.info(o,"Waterfall ads queue ("+this.sizeName+" -> "+r+") pushed new ads.",this.queues[r])}},{key:"pullAdByTypeName",value:function(e){for(var t=this.queues[e],i=0;i<t.length;i++){var o=t[i];if(o.isAvailable())return o.setInQueue(!1),t.splice(i,1),o}return null}}]),r}();return r}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Stores=Cbola.Common.Ads.Stores||{},Cbola.Common.Ads.Stores.WaterfallTags=Cbola.Common.Ads.Stores.WaterfallTags||function(){var e=Cbola._,t=Cbola.Common.Ads.Stores.Base,i=Cbola.Common.Ads.Tags.Base,o=Cbola.Common.Ads.WaterfallQueue,n=Cbola.Logger.getInstance(),r=Cbola.Logger.Colors.ORANGE,a=function(t){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.psaCounter={},t.placementPSACap={},t.manager=e,t}return _inherits(a,t),_createClass(a,null,[{key:"shuffleAds",value:function(t){var i=0;return e.chain(t).sortBy("priority").reverse().reduce(function(e,t){var o=t.weights,n=t.ads,r=t.currentMaxWeight,a=t.priority;for(o=o.slice(0),n=n.slice(0);o.length>0&&a>=i;){for(var s=void 0,l=Math.ceil(Math.random()*r),d=-1,c=0,h=0;h<o.length;h++)o[h]>=l&&(-1===d?(d=h,s=n[h],c=s.getWeight()):o[h]-=c);o.splice(d,1),n.splice(d,1),r-=c,s&&!s.isInQueue()&&(s.getMaxCap()>0&&a>i&&s.isAvailable()&&(i=a),e.push(s))}return e},[]).value()}},{key:"getPathFromAd",value:function(e){return e.getSizeName()+"."+e.getTypeName()+"."+e.getPriority()}},{key:"createAdsWeightsObject",value:function(e){return{ads:[],weights:[],currentMaxWeight:0,priority:e.getPriority()}}}]),_createClass(a,[{key:"addToInventory",value:function(t){var i=a.getPathFromAd(t),o=e.get(this.inventory,i)||a.createAdsWeightsObject(t);o.ads.push(t),o.currentMaxWeight+=t.getWeight(),o.weights.push(o.currentMaxWeight),e.setWith(this.inventory,i,o,Object)}},{key:"removeAdFromInventory",value:function(t){var i=a.getPathFromAd(t),o=e.get(this.inventory,i);if(!e.isNil(o)){for(var n=-1,r=t.getWeight(),s=t.getID(),l=0;l<o.ads.length;l++)-1===n?o.ads[l].getID()===s&&(n=l):o.weights[l]-=r;if(-1!==n&&(o.currentMaxWeight-=r,o.ads.splice(n,1),o.weights.splice(n,1)),e.isEmpty(o.ads)){var d=e.toPath(i);do e.unset(this.inventory,d),d.pop();while(d.length>0&&e.isEmpty(e.get(this.inventory,d)));0===d.length&&this.manager.resetHBSettingsTiersThresholdForSize(t.getSizeName())}}}},{key:"init",value:function(t){var n=this,r=e.result(t,"AdsForSize",{});e.forEach(r,function(t){var r=i.getAdSizeName(t),s=n.inventory[r];s&&(n.placementPSACap[r]=n.placementPSACap[r]||e.get(t,"PsaPlacementCap")||0,n.store[r]=n.store[r]||new o(r),n.psaCounter[r]=0,e.forEach(s,function(e,t){n.store[r].pushAdsByTypeName(a.shuffleAds(e),t)}))})}},{key:"getAd",value:function(t,i){var o=t.getPlaceholderSizeName(),s=this.store[o];if(!s)return null;if(s.isEmpty(i)){n.info(r,"WF store("+o+" -> "+i+"): is empty reshuffling ads.");var l=e.get(this.inventory,o+"."+i);l&&s.pushAdsByTypeName(a.shuffleAds(l),i)}var d=s.pullAdByTypeName(i);return e.isNil(d)?n.info(r,"WF store("+o+" -> "+i+"): failed getting waterfall ad."):(n.info(r,"WF store("+o+" -> "+i+"): selected waterfall ad: ",d),this.onSuccessfulAdSelection(d)),d}},{key:"onSuccessfulAdSelection",value:function(e){var t=e.getSizeName();e.onSelection(),e.isMaxCaped()&&(n.info(r,"WF store("+t+"): ad id "+e.getID()+" max caped - removing from inventory"),this.removeAdFromInventory(e))}},{key:"incrementPSACounter",value:function(e){this.psaCounter[e]+=1}},{key:"isMaxPlacementPSA",value:function(e){return this.placementPSACap[e]>0&&this.psaCounter[e]>=this.placementPSACap[e]}},{key:"removeAdsForSize",value:function(e){n.info(r,"WF store("+e+"): removing all ads"),delete this.inventory[e],delete this.store[e]}}]),a}(t);return a}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Tags=Cbola.Common.Ads.Tags||{},Cbola.Common.Ads.Tags.HeaderBiddingRequest=Cbola.Common.Ads.Tags.HeaderBiddingRequest||function(){var e=Cbola._;return function(){function t(i){_classCallCheck(this,t),this.request=e.clone(i.getTag()),this.hbFactor=i.HbFactor||1,this.manager=i,this.cpm=0,this.factoredCPM=0}return _createClass(t,[{key:"setCPM",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.cpm=e,this.factoredCPM=this.cpm*this.hbFactor}},{key:"setTag",value:function(e){this.Tag=e}},{key:"setResponseTimestamp",value:function(e){this.responseTimestamp=e}},{key:"setTimeToRespond",value:function(e){this.timeToRespond=e}},{key:"getBidRequest",value:function(){return this.request}},{key:"getBidder",value:function(){return e.get(this.request,"bidder","")}},{key:"getCPM",value:function(){return this.cpm}},{key:"getFactoredCPM",value:function(){return this.factoredCPM}},{key:"getTag",value:function(){return this.Tag}},{key:"getResponseTimestamp",value:function(){return this.responseTimestamp||null}},{key:"getTimeToRespond",value:function(){return this.timeToRespond||null}},{key:"getSizeName",value:function(){return this.manager.getSizeName()}},{key:"getPriority",value:function(){this.manager.getPriority()}},{key:"getWeight",value:function(){return this.manager.getWeight()}},{key:"getTypeName",value:function(){return this.manager.getTypeName()}},{key:"getID",value:function(){return this.manager.getID()}},{key:"getMaxCap",value:function(){return this.manager.getMaxCap()}},{key:"getProviderID",value:function(){return this.manager.getProviderID()}},{key:"getTranslatedSizes",value:function(){return this.manager.getTranslatedSizes()}},{key:"getTagExtractionType",value:function(){return this.manager.getTagExtractionType()}},{key:"isPremium",value:function(){return this.manager.isPremium()}},{key:"isVideo",value:function(){return this.manager.isVideo()}},{key:"isDisplay",value:function(){return this.manager.isDisplay()}},{key:"isMaxCaped",value:function(){return this.manager.isMaxCaped()}},{key:"isAvailable",value:function(){return this.manager.isAvailable()}},{key:"isHeaderBidding",value:function(){return this.manager.isHeaderBidding()}},{key:"shouldShowX",value:function(){return this.manager.shouldShowX()}}]),t}()}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),_get=function e(t,i,o){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,i);if(void 0===n){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,i,o)}if("value"in n)return n.value;var a=n.get;return void 0===a?void 0:a.call(o)};Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Tags=Cbola.Common.Ads.Tags||{},Cbola.Common.Ads.Tags.HeaderBidding=Cbola.Common.Ads.Tags.HeaderBidding||function(){var e=Cbola.Common.Ads.Tags.Base,t="HeaderBiddingAdTag",i=Cbola.Logger.getInstance(),o=Cbola.Logger.Colors.ORANGE,n=Cbola._,r={REGULAR:1,PENDING:2,SAMPLING:3},a={PRE_AUCTION:"preAuction",POST_AUCTION:"postAuction"},s={type:r.REGULAR,consecutiveInvalidBidsCount:0,skippedAuctionsCount:0},l=function(e,t){var i=e;return i.type!==r.PENDING||n.isEmpty(t)||(i=c(e),i.skippedAuctionsCount>=t.BidsToWait?(i.type=t.BidsToSample>0?r.SAMPLING:r.REGULAR,i.skippedAuctionsCount=0,i.consecutiveInvalidBidsCount=0):i.skippedAuctionsCount+=1),i},d=function(e,t,i){var o=e,a=e.type;if(a!==r.PENDING&&!n.isEmpty(t))if(i>0&&(e.type!==r.REGULAR||e.consecutiveInvalidBidsCount>0))o=c(s);else{o=c(e);var l=a===r.REGULAR?"BidsWithoutCPM":"BidsToSample";e.consecutiveInvalidBidsCount+1>=t[l]?(o.type=r.PENDING,o.skippedAuctionsCount=0,o.consecutiveInvalidBidsCount=0):o.consecutiveInvalidBidsCount+=1}return o},c=function(e){return{type:e.type,consecutiveInvalidBidsCount:e.consecutiveInvalidBidsCount,skippedAuctionsCount:e.skippedAuctionsCount}};return function(e){function c(e){_classCallCheck(this,c);var r="ctor",a=_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e));try{a.Tag=JSON.parse(a.Tag);var l=n.get(a,"Tag.bidder");l||i.errorM(t+"."+r,t+"."+r+" found ad tag without bidder name, Id: "+a.Id),a.unAvailabilityParams.bidParseFail=!l}catch(d){i.errorM(t+"."+r,t+"."+r+" failed to convert ad tag "+a.Id+" to json format"),a.unAvailabilityParams.bidParseFail=!0}return a.throttlingState=s,n.isNil(a.ThrottlingRules)||(n.some(a.ThrottlingRules,n.isNil)?(a.ThrottlingRules=null,i.info(o,"HB Tag Manager ("+a.sizeName+" , "+a.Id+"): failed initializing throttling rules")):i.info(o,"HB Tag Manager ("+a.sizeName+" , "+a.Id+"): throttling rules: ",a.ThrottlingRules)),a}return _inherits(c,e),_createClass(c,[{key:"getBidInstance",value:function(){return new Cbola.Common.Ads.Tags.HeaderBiddingRequest(this)}},{key:"onAuctionResponse",value:function(e){return this.throttlingStateReducer({name:a.POST_AUCTION,cpm:e}),this}},{key:"onPreAuction",value:function(){return this.throttlingStateReducer({name:a.PRE_AUCTION}),this}},{key:"isAvailable",value:function(){return this.throttlingState.type!==r.PENDING&&_get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"isAvailable",this).call(this)}},{key:"throttlingStateReducer",value:function(e){switch(e.name){case a.PRE_AUCTION:this.throttlingState=l(this.throttlingState,this.ThrottlingRules);break;case a.POST_AUCTION:this.throttlingState=d(this.throttlingState,this.ThrottlingRules,e.cpm)}}}]),c}(e)}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.HeaderBiddingSettings=Cbola.Common.Ads.HeaderBiddingSettings||function(){var e=Cbola._,t=0,i=.5,o=2e3,n=function(){function n(r,a){_classCallCheck(this,n);var s=e.get(r,"UsePt");this.usePocket=e.isNil(s)||s;var l=e.get(r,"UseSW");this.useSandwich=this.usePocket&&(e.isNil(l)||l),this.pocketUsageThreshold=Math.max(Math.min(e.get(r,"PtThreshold")||i,1),0),this.hbTimeout=e.get(r,"Timeout")||o,this.hbMaxTimeInPocket=e.get(r,"PtTimeout"),this.hbTiersThreshold=Math.max(e.get(r,"TiersThreshold")||e.get(a,"HbThreshold")||t,0)}return _createClass(n,[{key:"isHbPocketSupported",value:function(){return this.usePocket}},{key:"isHbLowTierSupported",value:function(){return this.useSandwich}},{key:"getHBPocketUsageThreshold",value:function(){return this.pocketUsageThreshold}},{key:"getHbTimeout",value:function(){return this.hbTimeout}},{key:"getHbMaxTimeInPocket",value:function(){return this.hbMaxTimeInPocket}},{key:"getHbTiersThreshold",value:function(){return this.hbTiersThreshold}},{key:"resetTiersThreshold",value:function(){this.hbTiersThreshold=0}}]),n}();return n}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.HeaderBiddingPocket=Cbola.Common.Ads.HeaderBiddingPocket||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Logger.getInstance(),o=Cbola.Logger.Colors.ORANGE,n=function(){function n(e,t){_classCallCheck(this,n),this.highTier=[],this.hbSettings=e,this.sizeName=t,this.hbSettings.isHbLowTierSupported()&&(this.lowTier=[]),this.batchesCounter=0}return _createClass(n,null,[{key:"mergeSortedBidsToPocket",value:function(e,i){for(var o=0,n=0,r=e.length,a=i.length;r>o&&a>n;){for(;e[o].getFactoredCPM()>i[n].getFactoredCPM();)o+=1;e.splice(o,0,i[n]),n+=1,o+=1}a>n&&t.push.apply(e,i.slice(n))}},{key:"removeFromPocketByDelay",value:function(t,i,o,n){n&&(e.forEach(i,function(e){return e.batchID=o}),setTimeout(function(){return e.remove(t,function(e){return e.batchID===o})},n))}}]),_createClass(n,[{key:"pushAds",value:function(t){var r=this.hbSettings.getHbTiersThreshold(),a=e.remove(t,function(e){return e.getFactoredCPM()>r}),s=this.hbSettings.getHbMaxTimeInPocket(),l=this.getBatchID();if(!e.isEmpty(a)){var d=e.result(a,"[0].getCPM",null),c=e.result(this.highTier,"[0].getCPM",null);
e.forEach(a,function(e){e.pocketUsageType=n.PocketUsageTypes.FROM_AUCTION,e.pocketCPM=c}),e.forEach(this.highTier,function(e){e.pocketUsageType=n.PocketUsageTypes.FROM_HIGH_TIER,e.pocketCPM=null,e.auctionCPM=d}),n.mergeSortedBidsToPocket(this.highTier,a),this.updateHighTierBidsThreshold(),n.removeFromPocketByDelay(this.highTier,a,l,s),i.info(o,"HB Pocket ("+this.sizeName+"): added bids to high tier pocket: ",this.highTier)}this.hbSettings.isHbLowTierSupported()&&!e.isEmpty(t)&&(e.forEach(t,function(e){e.pocketUsageType=n.PocketUsageTypes.FROM_LOW_TIER}),n.mergeSortedBidsToPocket(this.lowTier,t),n.removeFromPocketByDelay(this.lowTier,t,l,s),i.info(o,"HB Pocket ("+this.sizeName+"): added bids to low tier pocket: ",this.lowTier))}},{key:"updateHighTierBidsThreshold",value:function(){var t=this.hbSettings.getHBPocketUsageThreshold();e.forEach(this.highTier,function(e,i,o){e.hasAllowedThreshold=0===i||(o[i-1].getFactoredCPM()-e.getFactoredCPM())/(o[i-1].getFactoredCPM()||1)<t})}},{key:"getBatchID",value:function(){return this.batchesCounter+=1,this.batchesCounter}},{key:"getHighTierAd",value:function(){return e.get(this.highTier,"[0].hasAllowedThreshold")?this.highTier.shift():null}},{key:"getLowTierAd",value:function(){return this.hbSettings.isHbLowTierSupported()?this.lowTier.shift():null}},{key:"mergeLowTierToHighTier",value:function(){e.isEmpty(this.lowTier)||(t.push.apply(this.highTier,this.lowTier),this.lowTier=[],this.updateHighTierBidsThreshold())}},{key:"extendAdWithTiersSizes",value:function(t){e.extend(t,{pocketSizeHT:this.highTier.length,pocketSizeLT:this.hbSettings.isHbLowTierSupported()?this.lowTier.length:null})}}]),n}();return n.PocketUsageTypes={FROM_AUCTION:1,FROM_HIGH_TIER:2,FROM_LOW_TIER:3},n}();var _get=function e(t,i,o){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,i);if(void 0===n){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,i,o)}if("value"in n)return n.value;var a=n.get;return void 0===a?void 0:a.call(o)},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Stores=Cbola.Common.Ads.Stores||{},Cbola.Common.Ads.Stores.HeaderBiddingTags=Cbola.Common.Ads.Stores.HeaderBiddingTags||function(){var e=Cbola._,t=Cbola.Common.PrebidAdaptor,i=Cbola.Common.Ads.HeaderBiddingPocket,o=Cbola.Common.Ads.HeaderBiddingSettings,n=Cbola.Common.Ads.Stores.Base,r=Cbola.Common.Ads.Tags.Base,a=Cbola.Logger.getInstance(),s=Cbola.Logger.Colors.ORANGE,l=function(n){function l(e){_classCallCheck(this,l);var t=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,e));return t.activeAuctions={},t.premiumPlusInventory={},t.tagIdPerSize={},t.HbSettings={},t}return _inherits(l,n),_createClass(l,null,[{key:"onAuctionResponse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.forEach(t,function(e){return e.manager.onAuctionResponse(e.cpm)}),t.filter(function(e){return e.getFactoredCPM()>i}).sort(function(e,t){return t.getFactoredCPM()-e.getFactoredCPM()})}}]),_createClass(l,[{key:"addToInventory",value:function(t){if(t.isAvailable()){var i=t.getSizeName();if(e.isNil(this.tagIdPerSize[i])&&(this.tagIdPerSize[i]=t.getID()),t.isPremium()){for(var o=t.getProviderID(),n=e.get(this.premiumPlusInventory,"["+i+"]["+o+"]",[]),r=0,a=t.getPriority();r<n.length&&n[r].getPriority()>a;r++);n.splice(r,0,t),e.setWith(this.premiumPlusInventory,"["+i+"]["+o+"]",n,Object)}else _get(l.prototype.__proto__||Object.getPrototypeOf(l.prototype),"addToInventory",this).call(this,t)}}},{key:"removeAdFromInventory",value:function(t){var i=t.getSizeName(),o=t.getID();e.remove(this.inventory[i],function(e){return e.getID()===o})}},{key:"init",value:function(t){var n=this;e.forEach(t.AdsForSize,function(l){var d=r.getAdSizeName(l);e.isEmpty(n.inventory[d])&&e.isEmpty(n.premiumPlusInventory[d])||(e.isEmpty(n.HbSettings[d])&&(n.HbSettings[d]=new o(e.get(l,"HbSettings")||{},t),a.info(s,"HB store ("+d+"): created HB pocket and settings object: ",n.HbSettings[d])),n.HbSettings[d].isHbPocketSupported()&&e.isEmpty(n.store[d])&&(n.store[d]=new i(n.HbSettings[d],d)))})}},{key:"getAd",value:function(o){var n=this,r=o.getPlaceholderSizeName();if(e.isEmpty(this.inventory[r])&&e.isEmpty(this.premiumPlusInventory[r]))return a.info(s,"HB store ("+r+"): No HB ads"),Promise.reject("No HB ads");if(this.HbSettings[r].isHbPocketSupported()){var d=this.store[r].getHighTierAd();return d?(this.store[r].extendAdWithTiersSizes(d),a.info(s,"HB store ("+r+"): selected ad from high tier pocket: ",d),Promise.resolve(d)):this.createAuctionToPocketPromise(r).then(function(){var e=n.store[r].getHighTierAd();return e?(n.store[r].extendAdWithTiersSizes(e),a.info(s,"HB store ("+r+"): selected ad from high tier pocket after auction: ",e),Promise.resolve(e)):(a.info(s,"HB store ("+r+"): failed selecting ad from high tier pocket."),Promise.reject(new Error("Failed to find high tier ad")))})}var c=this.HbSettings[r].getHbTimeout(),h=this.getBidsForAuction(r);return e.isEmpty(h)?(a.info(s,"HB store ("+r+"): No pocket support and no bids for auction, terminating HB process"),Promise.reject(new Error("No available bids for size: "+r))):(a.info(s,"HB store ("+r+"): No pocket support auctioning (TO: "+c+") for highest bid: ",h),t.auction(h,c).then(function(t){var o=l.onAuctionResponse(t,n.HbSettings[r].getHbTiersThreshold()).shift();return o?(e.extend(o,{pocketUsageType:i.PocketUsageTypes.FROM_AUCTION,pocketSizeHT:null,PocketSizeLT:null}),a.info(s,"HB store ("+r+"): No pocket support, Selected highest bid : ",o),Promise.resolve(o)):(a.info(s,"HB store ("+r+"): No pocket support, failed selecting highest bid"),Promise.reject(new Error("Failed to get ad")))}))}},{key:"createAuctionToPocketPromise",value:function(i){var o=this;if(!this.activeAuctions[i]){var n=this.HbSettings[i].getHbTimeout(),r=this.getBidsForAuction(i);if(e.isEmpty(r))return a.info(s,"HB store ("+i+"): failed getting bids for auction, terminating hb ad selection"),Promise.reject(new Error("No available bids for size: "+i));a.info(s,"HB store ("+i+"): Performing auction (TO: "+n+") on the following bids: ",r),this.activeAuctions[i]=t.auction(r,n).then(function(e){return e=l.onAuctionResponse(e),o.store[i].pushAds(e),delete o.activeAuctions[i],Promise.resolve()},function(e){return delete o.activeAuctions[i],Promise.reject(e)})}return a.info(s,"HB store ("+i+"): Pending auction response"),this.activeAuctions[i]}},{key:"getBidsForAuction",value:function(t){var i=this,o=e.get(this.premiumPlusInventory,t),n=[];o&&(n=e.reduce(o,function(n,r,a){var s=-1,l=-1,d=0;e.forEach(r,function(e,t){e.onPreAuction(),0>s&&e.isAvailable()&&(s=t),!d&&e.getMaxCap()>0&&(d=e.getPriority()),s>=0&&d<=e.getPriority()&&(l=t)});var c=r.splice(s,1)[0];return e.isNil(c)||(c.onSelection(),n.push(c.getBidInstance()),c.isMaxCaped()||r.splice(l,0,c)),e.isEmpty(r)&&(delete o[a],e.isEmpty(o)&&delete i.premiumPlusInventory[t]),n},[]));var r=e.get(this.inventory,t),a=[];return r&&(a=r.reduce(function(e,t){return t.onPreAuction().isAvailable()&&(t.onSelection(),e.push(t.getBidInstance()),t.isMaxCaped()&&i.removeAdFromInventory(t)),e},[])),n.concat(a)}},{key:"getLowTierAd",value:function(e){var t=e.getPlaceholderSizeName();if(!this.HbSettings[t].isHbLowTierSupported())return a.info(s,"HB store ("+t+"): low tier pocket is not supported"),null;var i=this.store[t].getLowTierAd();return i?(this.store[t].extendAdWithTiersSizes(i),a.info(s,"HB store ("+t+"): Selected low tier ad: ",i),i):(a.info(s,"HB store ("+t+"): Failed selecting low tier ad."),null)}},{key:"getTagIdForSize",value:function(e){return this.tagIdPerSize[e]||0}},{key:"isLowTierSupportedForSize",value:function(t){return e.result(this,"HbSettings["+t+"].isHbLowTierSupported",!1)}},{key:"resetTiersThresholdForSize",value:function(t){e.isNil(this.HbSettings[t])||(this.HbSettings[t].resetTiersThreshold(),this.store[t].mergeLowTierToHighTier())}}]),l}(n);return l}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Tags=Cbola.Common.Ads.Tags||{},Cbola.Common.Ads.Tags.A9=Cbola.Common.Ads.Tags.A9||function(){var e=Cbola.Common.Ads.Tags.Base;return function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,e),_createClass(t,[{key:"getDFPSlotName",value:function(){return this.Tag}},{key:"getPrebidBidsForAuction",value:function(){return this.headerBiddingStore.getBidsForAuction(this.getSizeName())}},{key:"getAuctionTimeout",value:function(){return this.auctionTimeout}},{key:"setAuctionTimeout",value:function(e){this.auctionTimeout=e}},{key:"setHeaderBiddingStore",value:function(e){this.headerBiddingStore=e}}]),t}(e)}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Stores=Cbola.Common.Ads.Stores||{},Cbola.Common.Ads.Stores.A9Tags=Cbola.Common.Ads.Stores.A9Tags||function(){var e=Cbola._,t=Cbola.Logger.getInstance(),i=Cbola.Logger.Colors.ORANGE,o=Cbola.Common.Ads.HeaderBiddingSettings,n=Cbola.Common.Ads.Tags.Base,r=Cbola.Common.Ads.Stores.Base,a=function(r){function a(e,t){_classCallCheck(this,a);var i=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return i.headerBiddingStore=t,i.HbSettings={},i}return _inherits(a,r),_createClass(a,[{key:"addToInventory",value:function(t){var i=t.getSizeName();e.isNil(this.inventory[i])&&(this.inventory[i]=t,t.setHeaderBiddingStore(this.headerBiddingStore))}},{key:"init",value:function(t){var i=this;e.forEach(t.AdsForSize,function(r){var a=n.getAdSizeName(r);e.isEmpty(i.inventory[a])||(i.HbSettings[a]=new o(e.get(r,"HbSettings")||{},t),i.inventory[a].setAuctionTimeout(i.HbSettings[a].getHbTimeout()))})}},{key:"getAd",value:function(o){var n=o.getPlaceholderSizeName();if(e.isNil(this.inventory[n]))t.info(i,"A9 store ("+n+"): no a9 tag");else{if(e.isNil(o.injectedWithA9Tag)){o.injectedWithA9Tag=!0;var r=this.inventory[n];return t.info(i,"A9 store ("+n+"): selected a9 tag.",r),r}t.info(i,"A9 store ("+n+"): already attempted a9 tag injection on placeholder: ",o)}return null}}]),a}(r);return a}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Stores=Cbola.Common.Ads.Stores||{},Cbola.Common.Ads.Stores.PSATags=Cbola.Common.Ads.Stores.PSATags||function(){var e=Cbola.Common.Ads.Stores.Base,t=Cbola.Common.Ads.Tags.Base,i=Cbola._,o=Cbola.Enums,n=Cbola.Env,r=Cbola.Utils,a={FilteringRules:null,Id:0,IsHb:!1,MaxCap:0,Mode:1,Priority:10,ProviderId:0,PsaTagCap:0,ShowX:!0,TagExtractionType:o.TagExtractionTypes.WRITE_IFRAME,ThrottlingRules:null,Weight:1},s=function(e){function o(e){return _classCallCheck(this,o),_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,e))}return _inherits(o,e),_createClass(o,[{key:"init",value:function(e){var o=this,s=i.get(e,"AdsForSize");i.forEach(s,function(e){var s=t.getAdSizeName(e),l=e.AdHeight,d=e.AdWidth,c=t.translateSize(d,l),h=c.width,m=c.height;o.inventory[s]=new t(i.defaults({Tag:"<div id='cbola_psa'></div><script src='//psa.carambo.la/getPsa?width="+h+"&height="+m+"&did="+n.domainId+"&pid="+n.activePid+"&isMobile="+(r.isMobile?1:0)+"'></script>",AdHeight:l,AdWidth:d},a))})}},{key:"getAd",value:function(e){var t=e.getPlaceholderSizeName();return i.get(this.inventory,t,null)}}]),o}(e);return s}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Stores=Cbola.Common.Ads.Stores||{},Cbola.Common.Ads.Stores.Manager=Cbola.Common.Ads.Stores.Manager||function(){var e=Cbola._,t=Cbola.Env,i=Cbola.EventBus,o=Cbola.Utils,n=Cbola.Common.UserService,r=Cbola.Common.Ads.Stores.PSATags,a=Cbola.Common.Ads.Stores.HeaderBiddingTags,s=Cbola.Common.Ads.Stores.WaterfallTags,l=Cbola.Common.Ads.Stores.A9Tags,d=Cbola.Common.Ads.Tags.Base,c=Cbola.Common.Ads.Tags.A9,h=Cbola.Common.Ads.Tags.HeaderBidding,m=Cbola.Common.Ads.Tags.Waterfall,p=Cbola.Enums,u=Cbola.Logger.Colors.ORANGE,b=p.AdInjectionTypes,f=d.AD_TYPES,g=d.AD_MODES,y=Cbola.Logger.getInstance(),v="AdsStoresManager",w=204,_=[{toFind:"[\\[{]CLIENTCB[\\]}]",replaceWith:e.random(1e7,9e7)},{toFind:"[\\[{]CACHEBUSTER[\\]}]",replaceWith:o.generateViewId()}],C=e.once(function(){o.push.apply(_,[{toFind:"{google_page_url}",replaceWith:t.PageProperties.originalPathNameHost},{toFind:"\\[PAGE_URL\\]",replaceWith:t.PageProperties.originalPathNameHost},{toFind:"\\[USER_AGENT\\]",replaceWith:navigator.userAgent}])}),I=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments[2];_classCallCheck(this,t),this.wid=i,this.elemId=e,this.shouldIncludePromises=[],C(),Cbola.Common.RequestHandler.getAds(i,e,n).then(this.init.bind(this)).catch(o.noOp)}return _createClass(t,null,[{key:"replaceTagParams",value:function(t){var i=_.concat([{toFind:"\\[ID\\]",replaceWith:e.get(t,"Id",0)}]),n=e.get(t,"Tag","");e.forEach(i,function(e){var t=e.toFind,i=e.replaceWith;n=o.replaceAll(t,i,n)}),t.Tag=n}}]),_createClass(t,[{key:"init",value:function(){var o=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=e.get(n,"AdsForSize",[]);return e.isEmpty(d)?(y.errorM(v+".init",v+".init failed no ads data exist. Widget id: "+this.wid),this):(this.adsData=n,this.displayBeforeVideo=n.NumDisplayBeforeVideo||0,this.maxVideoAds=n.MaxVideos||0,this.maxDisplayAds=n.MaxDisplayAds,this.stores={psa:new r(this),headerBidding:new a(this),waterfall:new s(this)},this.stores.a9=new l(this,this.stores.headerBidding),this.storesToInit={headerBidding:!1,waterfall:!1,a9:!1,psa:!0},this.storeSizes={},e.forEach(d,function(i){e.forEach(f,function(n){var r=i[n.name];e.isEmpty(r)||e.forEach(r,function(e){var i=t.filtersManager.shouldInclude(e);i instanceof Promise?o.shouldIncludePromises.push(i):i&&o.addToStoreInventoryByTagType(e)})})}),this.initStores(),i.fire(""+i.Events.ADS_STORES_MANAGER_READY+this.wid,this),void(this.shouldIncludePromises.length>0&&Promise.all(this.shouldIncludePromises).then(function(t){var n=Object.keys(o.storeSizes).length;e.forEach(t,function(t){e.isNil(t)||o.addToStoreInventoryByTagType(t)}),o.initStores(),n<Object.keys(o.storeSizes).length&&i.fire(""+i.Events.ADS_STORES_MANGER_ADDED_SIZES+o.wid)})))}},{key:"addToStoreInventoryByTagType",value:function(e){if(e.IsHb){var i={};e.ProviderId===w?(i=new c(e),this.stores.a9.addToInventory(i),this.storesToInit.a9=!0):(i=new h(e),this.stores.headerBidding.addToInventory(i),this.storesToInit.headerBidding=!0),this.storeSizes[i.getSizeName()]=!0}else if(e.Mode===g.CPI)y.alwaysSend("AdStoresManager.addToStoreInventoryByTagType() ignored CPI tag (id : "+e.Id);else{t.replaceTagParams(e);var o=new m(e);this.stores.waterfall.addToInventory(o),this.storesToInit.waterfall=!0,this.storeSizes[o.getSizeName()]=!0}}},{key:"initStores",value:function(){var t=this;e.forEach(this.stores,function(e,i){t.storesToInit[i]&&(e.init(t.adsData),t.storesToInit[i]=!1)})}},{key:"getAd",value:function(e){var t=this;if(this.maxDisplayAds>0){var i=this.stores.a9.getAd(e);return i?(this.onAdSelectionSuccess(e,i),Promise.resolve(i)):this.stores.headerBidding.getAd(e).then(function(i){return t.onAdSelectionSuccess(e,i),Promise.resolve(i)}).catch(function(){return t.getWaterfallAd(e)})}return this.getWaterfallAd(e)}},{key:"getWaterfallAd",value:function(t){var i="getWaterfallAd",o=null;if(this.displayBeforeVideo<=0&&this.maxVideoAds>0?o=this.stores.waterfall.getAd(t,f.VIDEO.name):y.info(u,v+"."+i+" - skipped attempting to set video ad, displayBeforeVideo: "+this.displayBeforeVideo+" maxVideoAds: "+this.maxVideoAds+". Element ID: "+this.elemId+", widgetId: "+this.wid+"."),!o&&this.maxDisplayAds>0)o=this.stores.waterfall.getAd(t,f.DISPLAY.name);else if(this.maxDisplayAds<=0)return y.info(u,v+"."+i+" - reached max display ads. Element ID: "+this.elemId+", widget ID: "+this.wid),Promise.reject(!0);return e.isNil(o)?Promise.reject(!1):(this.onAdSelectionSuccess(t,o),Promise.resolve(o))}},{key:"onAdSelectionSuccess",value:function(t,i){var o=e.result(t,"getInjectionType");if(o===b.REFRESH_PSA||o===b.REFRESH_CONFIANT_BLOCK||o===b.REFRESH_AD_LIGHTNING_BLOCK)return this;var n=i.getTypeName();return n===f.VIDEO.name?this.maxVideoAds-=1:n===f.DISPLAY.name&&(this.displayBeforeVideo=Math.max(this.displayBeforeVideo-1,0),this.maxDisplayAds-=1),this}},{key:"getAdsData",value:function(){return this.adsData}},{key:"getLowTierFallbackAd",value:function(e){return this.stores.headerBidding.getLowTierAd(e)}},{key:"getRandomHbTagId",value:function(e){var t=e.getPlaceholderSizeName();return this.stores.headerBidding.getTagIdForSize(t)}},{key:"getPSA",value:function(e){return this.stores.psa.getAd(e)}},{key:"isLowTierSupported",value:function(e){var t=e.getPlaceholderSizeName();return this.stores.headerBidding.isLowTierSupportedForSize(t)}},{key:"hasAvailableAdsForSize",value:function(e){return!!this.storeSizes[e]}},{key:"updateWaterfallPSACounter",value:function(e){var t=e.getPlaceholderSizeName();this.stores.waterfall.incrementPSACounter(t)}},{key:"isWaterfallMaxPlacementPSA",value:function(e){var t=e.getPlaceholderSizeName();return this.stores.waterfall.isMaxPlacementPSA(t)}},{key:"removeWaterfallAdsForSize",value:function(e){var t=e.getPlaceholderSizeName();this.stores.waterfall.removeAdsForSize(t),this.resetHBSettingsTiersThresholdForSize(t),y.trace(v+".removeWaterfallAdsForSize: Removing all WF ads, size: "+t+".")}},{key:"removeWaterfallAd",value:function(e){this.stores.waterfall.removeAdFromInventory(e),y.trace(v+".removeWaterfallAd: Removing WF ad due to PSA tag cap. tag ID: "+e.getID()+", size: "+e.getSizeName()+".")}},{key:"resetHBSettingsTiersThresholdForSize",value:function(e){y.info(u,v+"("+e+") - resetting low tier threshold"),this.stores.headerBidding.resetTiersThresholdForSize(e)}}]),t}();return I.filtersManager={IN:{id:1,isAsync:!1,onRule:function(){return I.filtersManager.matchUrl(this.explicitUrl)}},OUT:{id:2,isAsync:!1,onRule:function(){return!I.filtersManager.matchUrl(this.explicitUrl)}},DFP_COMPLIANCE:{id:3,isAsync:!1,onRule:function(e){return e.Tag=o.replaceAll('"compliance": \\["yes"\\]','"compliance": ["no"]',e.Tag),!0}},REMOVE_ON_IE:{id:4,isAsync:!1,shouldTestURL:!1,onRule:function(){return!o.isIE}},REMOVE_ON_EU_USER:{id:5,isAsync:!0,shouldTestURL:!1,onRule:function(){return n.isEUUserAsync().then(function(e){var t=!e;return Promise.resolve(t)})}},REMOVE_EU_USER_WO_CMP:{id:6,isAsync:!0,shouldTestURL:!1,onRule:function(){return n.isEUUserAsync().then(function(e){var t=!0;return e?Cbola.Common.ConsentProviders.Manager.consentProviderFound().then(function(){return Promise.resolve(t)}).catch(function(){return Promise.resolve(!t)}):Promise.resolve(t)})}},matchUrl:function(i){return(!e.isArray(i)||e.isEmpty(i))&&(i=["^.*"]),i.some(function(e){return new RegExp(e,"i").test(t.PageProperties.hostname)})},getRuleByType:e.memoize(function(t){return e.find(this,function(e){return e.id===t})}),refineRules:function(i){var n=this,r=i.reduce(function(i,r){var a=e.get(r,"FilterType"),s=i[a]||e.extend({},n.getRuleByType(parseInt(a,10)));return s?(s.id!==n.IN.id&&s.id!==n.OUT.id||!e.isArray(r.ExplicitURL)||(e.isArray(s.explicitUrl)||(s.explicitUrl=[]),o.push.apply(s.explicitUrl,r.ExplicitURL)),i[a]=s):y.errorM(v+".shouldInclude","Unknown ad filtering rule type: "+a+". URL: "+t.PageProperties.originalPathNameHost),i},{});return e.reduce(r,function(e,t){return e[t.isAsync?"push":"unshift"](t),e},[])},shouldInclude:function(t){var i=e.get(t,"FilteringRules");if(e.isObject(i)&&i.hasOwnProperty("FilterType")&&i.hasOwnProperty("ExplicitURL")&&(i=[i]),i&&e.isArray(i)&&!e.isEmpty(i)){var o=this.refineRules(i).reduce(function(i,o){if(!i)return i;y.info(u,"AdStoresManager::FilterManager (tag ID: "+t.Id+"): Activated filter type "+o.id+".");var n=o.onRule(t);return o.isAsync?(e.isArray(i)||(i=[]),i.push(n)):i=n,i},!0);return e.isArray(o)?Promise.all(o).then(function(e){return Promise.resolve(e.every(Boolean)?t:null)}):o}return!0}},I}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.AdBannerTag=Cbola.Common.Ads.AdBannerTag||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Enums,o=Cbola.Common.AnalyticsService,n=Cbola.Common.Ads.Writers,r=i.AdInjectionTypes,a=i.HeaderBiddingRequestStatus;return function(){function i(e,t,o){_classCallCheck(this,i),this.elemId=e,this.adObj=t,this.id=o.toString(),this.attached=!1}return _createClass(i,[{key:"init",value:function(){return this.buildBannerTag(),this}},{key:"buildBannerTag",value:function(){var t=document.createElement("div");t.className="cbola-banner__tag cbola-banner__tag--back";var i=e.result(this.adObj,"getTranslatedSizes",{width:0,height:0}),o=i.width,n=i.height;return t.style["width"]=o+"px",t.style["height"]=n+"px",this.bannerTag=t,this}},{key:"attach",value:function(e){return e&&this.bannerTag&&!this.attached&&(e.appendChild(this.bannerTag),this.attached=!0,this.container=e),this}},{key:"detach",value:function(){return this.container&&this.bannerTag&&this.attached&&(this.container.removeChild(this.bannerTag),this.attached=!1,delete this.container),this}},{key:"injectTag",value:function(i){var s=this,l=this.adObj,d=l.getID();return n.Factory.getAsync(l.getTagExtractionType()).then(function(t){var n=t.name;try{t.write(s.bannerTag,e.result(l,"getTag",""),l);var c=e.result(l,"getCPM",null),h=null;i===r.WF_FALLBACK?h=a.LOW_TIER_FILLED:i!==r.INJECT_PSA&&(o.setAdsRequest(s.elemId,d,i,c),e.isNil(c)||(h=a.HIGH_TIER_FILLED)),e.isNil(h)||o.setHbBidRequestProto([{TagId:d,Cpm:c,Status:h,TimeInPocket:l.getResponseTimestamp()?Date.now()-l.getResponseTimestamp():0,TimeToRespond:l.getTimeToRespond(),AuctionCpm:l.auctionCPM||null,PocketCpm:l.pocketCPM||null,PocketUsageType:l.pocketUsageType,PocketSizeHT:l.pocketSizeHT,PocketSizeLT:l.pocketSizeLT}]),s.setDatasetObj({adId:d,cbolaTagId:d,cbolaMethod:n}),Logger.info(Cbola.Logger.Colors.PALE_YELLOW,"elementId: "+s.elemId+". adId: "+d+". Ad extraction type: "+l.getTagExtractionType()+", selected Extraction type: "+n)}catch(m){Logger.warnM("AdBannerTag.injectTag","AdBannerTag.injectTag error, extraction method: "+n),Logger.info(m)}}).catch(t.noOp),this}},{key:"setDatasetObj",value:function(i){var o=this;return e.forEach(i,function(i,n){e.isNil(i)||t.dataset(o.bannerTag,n,i)}),this}},{key:"injectFallbackAd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.WF_FALLBACK;this.adObj=e,this.bannerTag.innerHTML="",this.injectTag(t)}},{key:"setAsFront",value:function(){this.bannerTag.classList.remove("cbola-banner__tag--back"),this.bannerTag.classList.add("cbola-banner__tag--front")}},{key:"setStyle",value:function(t){e.extend(this.bannerTag.style,t)}},{key:"getElement",value:function(){return this.bannerTag}},{key:"getId",value:function(){return this.id}},{key:"getAdObj",value:function(){return this.adObj}},{key:"isFront",value:function(){return this.bannerTag.classList.contains("cbola-banner__tag--front")}}]),i}()}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.AdBannerTagDFP=Cbola.Common.Ads.AdBannerTagDFP||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Enums,o=Cbola.Common.AnalyticsService,n=i.HeaderBiddingRequestStatus,r=Cbola.Logger.getInstance(),a=Cbola.Logger.Colors,s=Cbola.Common.Ads.AdBannerTag;return function(i){function s(e,t,i,o){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;_classCallCheck(this,s);var r=_possibleConstructorReturn(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,e,t,i));return r.slotID="div-gpt-ad"+r.elemId+"-"+o+"-"+n,r.slotName=t.getDFPSlotName(),r.bidsToReport=[],r}return _inherits(s,i),_createClass(s,[{key:"injectTag",value:function(e){var t=this;r.info(a.GREEN,"A9("+this.slotID+"): start injecting a9 tag"),this.initDFPInIframe().then(function(){return r.info(a.GREEN,"A9("+t.slotID+"): iframe loaded successfully, start bidding"),t.performAuction()}).then(function(e){return r.info(a.GREEN,"A9("+t.slotID+"): performed bidding to the following bidders: "+e.join(",")),t.injectBidsToGoogleTag(e)}).then(function(){r.info(a.GREEN,"A9("+t.slotID+"): bids injected to google tag manager and the following data sent as SetHbBidRequest: ",t.bidsToReport),t.reportToAnalytics(e)}).catch(function(e){return r.errorM("DFPBannerTag.injectTag","A9: DFPBannerTag.injectTag failed, error: ",e)})}},{key:"initDFPInIframe",value:function(){var i=this;return new Promise(function(o){var n=t.createAdIframe(e.result(i,"adObj.getTranslatedSizes",{})),r=Cbola.Templates.getCompiledTemplate("a9_dfp_banner.html"),a=i.adObj.getTranslatedSizes(),s=r({clientPath:Cbola.Env.clientPath,width:a.width,height:a.height,slotName:i.slotName,slotID:i.slotID});n.onload=o,i.bannerTag.appendChild(n);var l=n.contentDocument;l.open(),l.write(s),l.close(),i.iframeWindow=n.contentWindow})}},{key:"performAuction",value:function(){var t=[this.getA9AuctionPromise()],i=this.adObj.getPrebidBidsForAuction();return e.isEmpty(i)||t.push(this.getPrebidAuctionPromise(i)),Promise.all(t)}},{key:"getA9AuctionPromise",value:function(){var e=this;return new Promise(function(t){var i=e.adObj.getTranslatedSizes();e.iframeWindow.apstag.fetchBids({slots:[{slotID:e.slotID,slotName:e.slotName,sizes:[new e.iframeWindow.Array(i.width,i.height)]}],timeout:e.adObj.getAuctionTimeout()},function(){e.bidsToReport.push({TagId:e.adObj.getID(),Cpm:0,Status:n.SUCCESS}),t("a9")})})}},{key:"getPrebidAuctionPromise",value:function(t){var i=this;return new Promise(function(o){var r=t.map(function(t){return e.extend(t.getBidRequest(),{cbolaTagID:t.getID()})}),a=i.iframeWindow,s=a.Cbola_pbjs,l=i.adObj.getTranslatedSizes();s.que.push(function(){s.addAdUnits([{bids:r,code:i.slotID,sizes:[new a.Array(l.width,l.height)]}]),s.requestBids({timeout:i.adObj.getAuctionTimeout(),bidsBackHandler:function(r){for(var a=e.get(r,i.slotID+".bids",[]);a.length>0;)for(var s=a.shift(),l=s.cpm,d=s.bidder,c=0;c<t.length;c++){var h=t[c];if(d===h.getBidder()){i.handleBidResponse(h,n.SUCCESS,l),t.splice(c,1);break}}e.forEach(t,function(e){i.handleBidResponse(e,n.TIMEOUT,0)}),o("prebid")}})})})}},{key:"handleBidResponse",value:function(e,t,i){e.manager.onAuctionResponse(i||0),this.bidsToReport.push({TagId:e.getID(),Cpm:i||0,Status:t})}},{key:"injectBidsToGoogleTag",value:function(e){var t=this;return new Promise(function(i){t.iframeWindow.googletag.cmd.push(function(){this.apstag.setDisplayBids(),e.some(function(e){return"prebid"===e})&&this.Cbola_pbjs.setTargetingForGPTAsync(),this.googletag.pubads().refresh(),i()}.bind(t.iframeWindow))})}},{key:"reportToAnalytics",value:function(e){this.bidsToReport.length>0&&(this.bidsToReport.push({TagId:this.bidsToReport[0].TagId,Status:n.REQUEST_MADE}),o.setHbBidRequestProto(this.bidsToReport),o.setAdsRequest(this.elemId,this.adObj.getID(),e))}},{key:"onRemoval",value:function(){this.iframeWindow.googletag.destroySlots()}}]),s}(s)}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.PlaceHolder=Cbola.Common.Ads.PlaceHolder||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Enums,o=Cbola.Common.Ads.Tags.Base,n=Cbola.Common.Ads.AdBannerTag,r=Cbola.Common.Ads.AdBannerTagDFP,a=Cbola.Common.Ads.Tags.A9,s=i.AdInjectionTypes,l=Cbola.Logger.getInstance(),d=8e3,c=function(t,i,n){this.banner=n,this.bannerTags=[],this.bannerCount=0,this.id=e.random(0,1e4),this.elemId=i,this.tagSizeHeight=e.get(t,"TagSizeHeight",0),this.tagSizeWidth=e.get(t,"TagSizeWidth",0),this.placeholderSizeName=o.getAdSizeName({AdWidth:this.tagSizeWidth,AdHeight:this.tagSizeHeight}),this.originalAdHeight=this.adHeight=o.translateSize(this.tagSizeWidth,this.tagSizeHeight).height,this.originalAdWidth=this.adWidth=o.translateSize(this.tagSizeWidth,this.tagSizeHeight).width,this.refreshOnMalwareCounter=0,this.displayCloseButton=!1,this.stopAllRefreshes=!1,this.adInjectionTriggerType=s.APPERANCE,this.banner.style["height"]=this.adHeight+"px",this.banner.style["width"]=this.adWidth+"px"};return c.prototype.injectAd=function(i){if(!e.isEmpty(i)&&(e.isNil(this.banner)&&(l.warnM("AdPlaceHolder.injectAd","AdPlaceHolder.injectAd error, failed banner initialization"),this.stopAllRefreshes=!0),!this.stopAllRefreshes)){this.displayCloseButton=i.shouldShowX();var o=i instanceof a?r:n,s=new o(this.elemId,i,this.bannerCount,this.Apperance,this.spot);s.init(),s.setDatasetObj({bannerId:this.bannerCount,elementId:this.elemId,apperance:this.Apperance}),e.isNil(this.spot)||s.setDatasetObj({spot:this.spot}),this.bannerCount+=1,e.isEmpty(this.bannerTags)?s.setAsFront():s.toFrontTimeOut=setTimeout(this.bringToFront.bind(this),d),this.bannerTags.push(s),s.attach(this.banner),s.injectTag(this.adInjectionTriggerType),this.bannerTagStyle(s),t.dataset(this.banner,"stamp",Date.now())}},c.prototype.injectAdToExistingBanner=function(t,i){var o=e.find(this.bannerTags,function(e){return e.getId()===i});"undefined"!=typeof o&&o.injectFallbackAd(t,this.adInjectionTriggerType)},c.prototype.bannerTagStyle=function(e){e.setStyle({"background-color":"transparent",height:this.adHeight+"px",width:this.adWidth+"px"})},c.prototype.preventBannerReplacement=function(t){var i=e.remove(this.bannerTags,function(e){return e.getId()===t}).shift();return i?i.isFront()?(this.bannerTags.unshift(i),!1):(clearTimeout(i.toFrontTimeOut),i.detach(),!0):!1},c.prototype.bringToFront=function(){if(this.bannerTags.length>=2){var t=this.bannerTags.shift();this.banner&&(t instanceof r&&e.isFunction(t.onRemoval)&&t.onRemoval(),t.detach()),this.bannerTags[0].setAsFront()}return this},c.prototype.getInjectionType=function(){return this.adInjectionTriggerType},c.prototype.setAdInjectionType=function(e){this.adInjectionTriggerType=e},c.prototype.isRefreshable=function(){return!this.stopAllRefreshes},c.prototype.stopRefresh=function(){this.stopAllRefreshes=!0},c.prototype.getAdObjByBannerId=function(t){var i=e.find(this.bannerTags,function(e){return e.getId()===t});return i?i.getAdObj():null},c.prototype.incrementMalwareRefresh=function(){this.refreshOnMalwareCounter+=1},c.prototype.resetMalwareRefresh=function(){this.refreshOnMalwareCounter=0},c.prototype.getMalwareRefreshCount=function(){return this.refreshOnMalwareCounter},c.prototype.getPlaceholderSizeName=function(){
return this.placeholderSizeName},c}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.Base=Cbola.Common.Ads.Triggers.Base||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Env,o=Cbola.EventBus,n=Cbola.Templates,r=Cbola.Common.HasViewability,a=Cbola.Common.UserService,s=Cbola.Common.Ads.PlaceHolder,l=Cbola.Logger.getInstance(),d=function(t,i){this.elemId=i.elementId,this.Apperance=t.Apperance,this.closeBehaviors=e.get(t,"CloseBehaviors")||[],this.openBehaviors=e.get(t,"OpenBehaviors")||[],this.refreshInterval=e.get(t,"RefreshInterval"),this.layerType=i.layerType,this.adStructureNode=n.createElementFromTemplate("ad_banner_structure.html",{elemId:this.elemId,apperance:this.Apperance,advertisement:a.vocabulary("advertisement"),showAdvertisementTitle:i.showAdvertisementTitle}),this.closeTriggerButton=this.adStructureNode.querySelector(".hide-ad-button"),this.banner=this.adStructureNode.querySelector(".cbola-banner"),this.containerWrapper=i.containerWrapperNode,this.appendTo=this.containerWrapper,this.triggerStructureAppended=!1,this.initialWrapperHeight=this.wrapperHeight=i.initialWrapperHeight,s.call(this,t,this.elemId,this.banner),this.styleProperties={},this.styleClassName="cbolaApperanceStyle_"+this.elemId+"_"+t.Apperance,this.styleElements=[],this.open=!1,this.animationEnabled=i.animationEnabled,this.viewable=!1,this.hasScaled=!1};return d.prototype=Object.create(s.prototype),e.extend(d.prototype,r.prototype),d.constructor=d,d.prototype.appendTriggerStructure=function(){this.triggerStructureAppended||(this.appendTo.appendChild(this.adStructureNode),this.triggerStructureAppended=!0)},d.prototype.appendTriggerStyle=function(){var o="cbolaApperanceStyle_"+this.Apperance+"_"+this.elemId,n=e.reduce(this.styleProperties,function(e,t,i){return""+e+i+": "+t+";"},"");n="."+o+"{"+n+"}";var r=t.injectStyle(document,n);if(r.className=this.styleClassName,this.styleElements.push(r),i.topWindow!==window){var a=t.injectStyle(i.topWindow.document,n);a.className=this.styleClassName,this.styleElements.push(a)}this.adStructureNode&&this.adStructureNode.classList.add(o)},d.prototype.closeAnimation=function(){this.isClose()||(this.adStructureNode.style["margin"]="0",this.setClose())},d.prototype.removeStyle=function(){var e=this;setTimeout(function(){try{e.styleElements.forEach(function(e){e.parentNode.removeChild(e)}),e.styleElements=[]}catch(t){l.info("Failed to remove style for apperance: "+e.Apperance)}},1e3)},d.prototype.removeStructure=function(){var e=this;setTimeout(function(){try{e.adStructureNode.parentNode.removeChild(e.adStructureNode),e.triggerStructureAppended=!1,e.deleteStructure()}catch(t){l.info("Failed to delete DOM nodes pointers for apperance: "+e.Apperance)}},1e3)},d.prototype.deleteStructure=function(){delete this.adStructureNode,delete this.banner,delete this.closeTriggerButton,delete this.containerWrapper},d.prototype.toggleXButton=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.displayCloseButton;e.isNil(this.closeTriggerButton)||(t===!0&&this.closeTriggerButton.classList.contains("cbola-fade-out")?this.closeTriggerButton.classList.remove("cbola-fade-out"):t!==!1||this.closeTriggerButton.classList.contains("cbola-fade-out")||this.closeTriggerButton.classList.add("cbola-fade-out"))},d.prototype.triggerElementsStyle=t.noOp,d.prototype.adScale=function(i){var o=i/this.adWidth,n=this.adHeight;if(!e.isNil(i)&&0!==i){if(o>=1)return void(this.hasScaled&&(t.transform(this.banner,"scale(1)"),this.hasScaled=!1,this.adStructureNode&&(this.adStructureNode.style["width"]=this.originalAdWidth+"px",this.adStructureNode.style["height"]=this.originalAdHeight+"px")));e.extend(this.banner.style,{"-webkit-transform-origin":"0 0","-moz-transform-origin":"0 0","-ms-transform-origin":"0 0","-o-transform-origin":"0 0","transform-origin":"0 0"}),t.transform(this.banner,"scale("+o+")"),this.hasScaled=!0,this.adHeight=this.originalAdHeight*o,this.adStructureNode&&(this.adStructureNode.style["width"]=this.originalAdWidth*o+"px",this.adStructureNode.style["height"]=this.adHeight+"px"),n-=this.adHeight,l.info("Trigger with apperance: "+this.Apperance+" for element ID: "+this.elemId+" in scale: "+o),this.containerWrapper&&(this.wrapperHeight-=n,this.containerWrapper.style["height"]=this.wrapperHeight+"px")}},d.prototype.isOpen=function(){return this.open},d.prototype.isClose=function(){return!this.open},d.prototype.setOpen=function(){return this.open=!0,this},d.prototype.setClose=function(){this.open=!1},d.prototype.isAppended=function(){return this.triggerStructureAppended},d.prototype.init=function(){return r.prototype.init.call(this),this.elementId=this.elemId+"_"+this.Apperance+(e.isNil(this.spot)?"":"_"+this.spot),this.viewableEvent=""+o.Events.TRIGGER_IS_VIEWABLE+this.elementId,this.element=this.adStructureNode,this},d}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.AboveMobile=function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Common.Ads.Triggers.Base,o=function(e,t){i.call(this,e,t),this.layer=Cbola.InContent.Manager.getLayerByElementId(this.elemId),this.layer?this.appendTo=this.layer.topAdPlaceHolder:Cbola.Logger.getInstance().errorM("AboveMobile.constructor","Trigger AboveMobile couldn't get layer object"),this.styleProperties={display:"block!important",opacity:"0","background-color":"transparent",position:"relative","margin-left":"auto","margin-right":"auto"}};return o.prototype=Object.create(i.prototype),o.constructor=o,o.prototype.triggerElementsStyle=function(){var t=this;e.extend(this.banner.style,{"float":"none","background-color":"transparent"}),setTimeout(function(){t.toggleXButton(!1),e.extend(t.adStructureNode.style,{"margin-top":"0","margin-bottom":"2px",height:t.adHeight,opacity:"1"}),t.layer.fixAllItemsHeight()},0)},o.prototype.bannerTagStyle=function(e){this.open&&(e.setStyle({"background-color":"transparent",margin:"0 auto",height:this.adHeight+"px",width:this.adWidth+"px"}),this.setClose())},o.prototype.adScale=t.noOp,o.prototype.closeAnimation=t.noOp,o.prototype.removeStyle=t.noOp,o.prototype.removeStructure=t.noOp,o}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.AbovePushContent=function(){var e=Cbola._,t=Cbola.Config,i=Cbola.InContent.Layers.Base.prototype,o=Cbola.Common.Ads.Triggers.Base,n=function(e,t){o.call(this,e,t),this.appendTo=this.containerWrapper.children[0],this.styleProperties={display:"block!important",width:"100%",opacity:"0","background-color":"transparent",position:"relative",margin:"0 auto -"+this.adHeight+"px","margin-left":"auto","margin-right":"auto","z-index":"-1","-webkit-transition":this.animationEnabled?"margin 0.6s ease,height 0.6s ease":"none",transition:this.animationEnabled?"margin 0.6s ease,height 0.6s ease":"none"}};return n.prototype=Object.create(o.prototype),n.constructor=n,n.prototype.appendTriggerStructure=function(){this.triggerStructureAppended||(Cbola.Utils.before(this.appendTo,this.adStructureNode),this.triggerStructureAppended=!0)},n.prototype.triggerElementsStyle=function(){var o=this,n=i.isInContent.call({type:this.layerType})?t.adBelowInContentExtraMargin:i.isSidebarSlideshow.call({type:this.layerType})?t.adBelowSlideShowMargin:t.adBelowSideBarMargin;this.wrapperHeight=this.initialWrapperHeight+this.adHeight+n,e.extend(this.banner.style,{"float":"none","background-color":"transparent"}),setTimeout(function(){o.toggleXButton(!1),e.extend(o.adStructureNode.style,{"margin-bottom":n+"px",height:o.adHeight,opacity:"1"}),setTimeout(function(){o.adStructureNode.style["z-index"]=10},600)},0)},n.prototype.closeAnimation=function(){this.isClose()||(this.adStructureNode.style["z-index"]="-1",this.adStructureNode.style["margin-bottom"]="-"+this.adHeight+"px",this.setClose())},n}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers.BelowCoverContent=function(){var e=Cbola._,t=Cbola.Common.Ads.Triggers.Base,i=function(e,i){t.call(this,e,i),this.styleProperties={top:-1*(this.initialWrapperHeight-1)+"px",display:"block!important",opacity:"0","-webkit-transition":"margin 0.6s ease,height 0.6s ease",transition:"margin 0.6s ease,height 0.6s ease","z-index":"-1","background-color":"transparent",width:this.adWidth+"px","max-height":this.initialWrapperHeight+"px",position:"relative","margin-left":"auto","margin-right":"auto",height:this.adHeight+"px"}};return i.prototype=Object.create(t.prototype),i.constructor=i,i.prototype.triggerElementsStyle=function(){var t=this;setTimeout(function(){t.toggleXButton(!0),t.banner.style.backgroundColor="transparent",e.extend(t.adStructureNode.style,{"margin-top":t.initialWrapperHeight+"px",opacity:"1"})},0)},i}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.BelowMobile=function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Common.Ads.Triggers.Base,o=function(e,t){i.call(this,e,t),this.layer=Cbola.InContent.Manager.getLayerByElementId(this.elemId),this.layer?this.appendTo=this.layer.bottomAdPlaceHolder:Cbola.Logger.getInstance().errorM("BelowMobile.constructor","Trigger BelowMobile couldn't get layer object"),this.styleProperties={display:"block!important",opacity:"0","background-color":"transparent",position:"relative","margin-left":"auto","margin-right":"auto"}};return o.prototype=Object.create(i.prototype),o.constructor=o,o.prototype.triggerElementsStyle=function(){var t=this;e.extend(this.banner.style,{"background-color":"transparent"}),setTimeout(function(){t.toggleXButton(!1),e.extend(t.adStructureNode.style,{"margin-top":"0","margin-bottom":"auto",height:t.adHeight,opacity:"1"}),t.layer.fixAllItemsHeight()},0)},o.prototype.bannerTagStyle=function(e){e.setStyle({"background-color":"transparent",margin:"0 auto",height:this.adHeight+"px",width:this.adWidth+"px"})},o.prototype.adScale=t.noOp,o.prototype.closeAnimation=t.noOp,o.prototype.removeStyle=t.noOp,o.prototype.removeStructure=t.noOp,o}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.BelowPushContent=function(){var e=Cbola._,t=Cbola.Config,i=Cbola.InContent.Layers.Base.prototype,o=Cbola.Common.Ads.Triggers.Base,n=Cbola.Common.Ads.PlaceHolder,r=function(t,i){var n=this;o.call(this,t,i),this.topStartingPoint=20,this.styleProperties={display:"block!important",width:"100%",height:this.adHeight+"px",opacity:"0","background-color":"transparent",position:"absolute",top:this.topStartingPoint+"px",left:"0","z-index":"-1","-webkit-transition":this.animationEnabled?"margin 0.6s ease":"none",transition:this.animationEnabled?"margin 0.6s ease":"none"},window.addEventListener("resize",e.debounce(function(){!e.isNil(n.containerWrapper)&&n.isOpen()&&n.adScale(n.containerWrapper.offsetWidth)},150,{leading:!1,maxWait:500,trailing:!0}))};return r.prototype=Object.create(o.prototype),r.constructor=r,r.prototype.triggerElementsStyle=function(){var e=this,o=i.isInContent.call({type:this.layerType})?t.adBelowInContentExtraMargin:i.isSidebarSlideshow.call({type:this.layerType})||i.isStoriesSlideshow.call({type:this.layerType})?t.adBelowSlideShowMargin:t.adBelowSideBarMargin;this.wrapperHeight=this.initialWrapperHeight+this.adHeight+o,this.banner.style["float"]="none",this.banner.style["background-color"]="transparent",this.toggleXButton(i.isInContent.call({type:this.layerType})&&this.displayCloseButton),setTimeout(function(){e.adStructureNode.style["margin-top"]=o+e.initialWrapperHeight-e.topStartingPoint+"px",e.adStructureNode.style["opacity"]="1"},0),setTimeout(function(){e.adStructureNode.style["z-index"]=10},1e3)},r.prototype.closeAnimation=function(){this.isClose()||(this.adStructureNode.style["z-index"]="-1",this.adStructureNode.style["margin"]=this.topStartingPoint+"px",this.setClose())},r.prototype.injectAd=function(){for(var e=arguments.length,t=Array(e),o=0;e>o;o++)t[o]=arguments[o];n.prototype.injectAd.apply(this,t),this.toggleXButton(i.isInContent.call({type:this.layerType})&&this.displayCloseButton)},r}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.CenterInsideUnit=function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Common.Ads.Triggers.Base,o=function(e,t){i.call(this,e,t),this.styleProperties={top:-1*this.adHeight+"px",display:"block!important","-webkit-transition":this.animationEnabled?"margin 0.6s ease,height 0.6s ease":"none",transition:this.animationEnabled?"margin 0.6s ease,height 0.6s ease":"none","z-index":"6","background-color":"rgba(255, 255, 255, 0.9)",width:"100%"}};return o.prototype=Object.create(i.prototype),o.constructor=o,o.prototype.triggerElementsStyle=function(){var t=this;this.triggerHeight=this.adHeight,e.extend(this.banner.style,{"float":"none","background-color":"transparent"}),setTimeout(function(){t.toggleXButton(!0),e.extend(t.adStructureNode.style,{margin:"auto",height:t.initialWrapperHeight,"margin-top":t.initialWrapperHeight+"px"})},0)},o.prototype.bannerTagStyle=function(e){e.setStyle({"background-color":"black",height:this.adHeight+"px",width:this.adWidth+"px"})},o.prototype.adScale=t.noOp,o}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.FixedFooter=function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Env,o=Cbola.Common.Ads.Triggers.Base,n=function(t,n){o.call(this,t,n),this.appendTo=i.topWindow.document.body,this.adStructureNode.id="cbola-footer-banner",this.styleProperties={position:"fixed",display:"block",top:"auto",left:"0",bottom:-1*this.adHeight+"px","z-index":"2147483647",height:this.adHeight+"px","-webkit-transition":this.animationEnabled?"bottom 0.9s ease":"none",transition:this.animationEnabled?"bottom 0.9s ease":"none"},e.isEmpty(n.footerBackground)?(this.styleProperties["width"]=this.adWidth+"px",this.styleProperties["margin"]="0 auto",this.styleProperties["left"]="0",this.styleProperties["right"]="0"):(this.styleProperties["width"]="100%",this.styleProperties["background-color"]=n.footerBackground)};return n.prototype=Object.create(o.prototype),n.constructor=n,n.prototype.appendTriggerStructure=function(){this.triggerStructureAppended||(this.appendTo.appendChild(this.adStructureNode),this.triggerStructureAppended=!0)},n.prototype.triggerElementsStyle=function(){var t=this;setTimeout(function(){t.toggleXButton(!0),t.banner.style.backgroundColor="transparent",e.extend(t.adStructureNode.style,{opacity:"1",height:t.adHeight,bottom:"0"})},0)},n.prototype.adScale=t.noOp,n.prototype.closeAnimation=function(){this.adStructureNode.style["bottom"]=-1*this.adHeight+"px",this.setClose()},n.prototype.isViewable=function(){return!0},n.prototype.init=function(){return this},n.prototype.updateViewability=function(){return this},n}();var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),_get=function e(t,i,o){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,i);if(void 0===n){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,i,o)}if("value"in n)return n.value;var a=n.get;return void 0===a?void 0:a.call(o)};Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.InItem=function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Common.Ads.Triggers.Base,o=Cbola.InContent.Layers.Base.prototype,n=Cbola.InContent.Manager;return function(i){function r(e,t){_classCallCheck(this,r);var i=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t));return i.element=i.adStructureNode=i.banner=i.closeTriggerButton=i.title=i.containerWrapper=null,i.layer=n.getLayerByElementId(i.elemId),i.spot=e.currentSpot,i.isCoveringAd=!1,i.hideButtons=!1,i.inItemDuration=0,i}return _inherits(r,i),_createClass(r,[{key:"appendTriggerStructure",value:function(){this.banner=this.layer.injectAdAfterItem({adSpot:this.spot,isCover:this.isCoveringAd,hideButtons:this.hideButtons,inItemDuration:this.inItemDuration}),this.banner&&(this.triggerStructureAppended=!0,this.element=this.banner.parentElement)}},{key:"injectAd",value:function(){for(var e,i=arguments.length,o=Array(i),n=0;i>n;n++)o[n]=arguments[n];(e=_get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"injectAd",this)).call.apply(e,[this].concat(o)),t.dataset(this.banner,"adWidth",this.adWidth),t.dataset(this.banner,"adHeight",this.adHeight),this.banner.style["width"]=this.adWidth+"px",this.banner.style["height"]=this.adHeight+"px"}},{key:"triggerElementsStyle",value:function(){}},{key:"bannerTagStyle",value:function(){return this}},{key:"adScale",value:function(t){e.isFunction(this.layer.scaleInItemAd)?this.layer.scaleInItemAd(this.spot):o.isPlaybox.call({type:this.layerType})||_get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"adScale",this).call(this,t)}},{key:"closeAnimation",value:function(){}},{key:"removeStyle",value:function(){}},{key:"removeStructure",value:function(){e.isFunction(this.layer.removeInItemAd)&&this.layer.removeInItemAd(this.spot)}}]),r}(i)}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.InItemCover=function(){var e=Cbola._,t=Cbola.Common.Ads.Triggers.InItem,i=function(i,o){t.call(this,i,o),this.isCoveringAd=!0,this.inItemDuration=e.get(i,"SpotsInterval",10)};return i.prototype=Object.create(t.prototype),i.constructor=i,i}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.InItemMobile=function(){var e=Cbola.TaskManager,t=Cbola._,i=Cbola.Utils,o=Cbola.Common.Ads.Triggers.InItem,n=function(e,t){o.call(this,e,t)};return n.prototype=Object.create(o.prototype),n.constructor=n,n.prototype.injectAd=function(){for(var i=arguments.length,n=Array(i),r=0;i>r;r++)n[r]=arguments[r];o.prototype.injectAd.apply(this,n),t.isFunction(this.layer.fixAllAdItemsStyle)&&e.addExpBackoffTask({fn:this.layer.fixAllAdItemsStyle.bind(this.layer)})},n.prototype.adScale=i.noOp,n}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.InItemNoButtons=function(){var e=Cbola._,t=Cbola.Common.Ads.Triggers.InItem,i=function(i,o){t.call(this,i,o),this.hideButtons=!0,this.inItemDuration=e.get(i,"SpotsInterval")||30};return i.prototype=Object.create(t.prototype),i.constructor=i,i}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.InItemWithDuration=function(){var e=Cbola._,t=Cbola.Common.Ads.Triggers.InItem;return function(t){function i(t,o){_classCallCheck(this,i);var n=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,o));return n.inItemDuration=e.get(t,"SpotsInterval")||10,n}return _inherits(i,t),i}(t)}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.InnerBanner=function(){var e=Cbola._,t=Cbola.Common.Ads.Triggers.Base,i=Cbola.Utils,o=function(e,i){t.call(this,e,i),this.layerType=i.layerType;var o=Cbola.InContent.Manager.getLayerByElementId(this.elemId);this.appendTo=o.boxElem.querySelector(".cbola-slider-ad-placeholder"),Cbola.Config.layouts.sideBars.teaserBanner.indexOf(this.layerType)>-1?this.styleProperties={"box-sizing":"border-box","border-right":"1px solid rgba(171, 171, 171, 0.25)","border-left":"1px solid rgba(171, 171, 171, 0.25)",height:"250px",top:"0px",opacity:"0","margin-left":"-1px",width:"300px"}:this.styleProperties={width:"300px",opacity:"0","box-sizing":"content-box","padding-top":"0px","padding-left":"0px"}};return o.prototype=Object.create(t.prototype),o.constructor=o,o.prototype.triggerElementsStyle=function(){var t=this;setTimeout(function(){t.toggleXButton(!1),t.banner.style.backgroundColor="transparent",e.extend(t.adStructureNode.style,{opacity:"1",height:t.adHeight})},0)},o.prototype.adScale=i.noOp,o.prototype.closeAnimation=i.noOp,o}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.LeftInsideUnit=function(){var e=Cbola.Common.Ads.Triggers.Base,t=Cbola.EventBus,i=Cbola.InContent.Layers.Base.prototype,o=(Cbola._,Cbola.Utils),n=function(t,o){e.call(this,t,o),this.layer=Cbola.InContent.Manager.getLayerByElementId(this.elemId),i.isPlaybox.call({type:this.layerType})&&(this.appendTo=this.layer.boxElem,this.inSlideShow=!0),this.styleProperties={top:"0",left:-1*this.adWidth+"px",display:"block!important","-webkit-transition":this.animationEnabled?"margin 0.6s ease, height 0.6s ease":"none",transition:this.animationEnabled?"margin 0.6s ease, height 0.6s ease":"none","z-index":"6","background-color":"transparent",width:this.adWidth+"px",height:this.adHeight+"px",overflow:"hidden"}};return n.prototype=Object.create(e.prototype),n.constructor=n,n.prototype.triggerElementsStyle=function(){var e=this;setTimeout(function(){e.inSlideShow?setTimeout(function(){e.toggleXButton(!0)},2500):e.toggleXButton(!1),e.adStructureNode.style["margin"]="auto",e.adStructureNode.style["margin-left"]=e.adWidth+"px",e.adStructureNode.style["height"]=e.initialWrapperHeight+"px"},0),t.fire(""+t.Events.COVERING_TRIGGER_ON+this.elemId)},n.prototype.closeAnimation=function(i){e.prototype.closeAnimation.call(this),t.fire(""+t.Events.COVERING_TRIGGER_OFF+this.elemId,{byClick:i})},n.prototype.adScale=o.noOp,n}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.LeftOfUnit=function(){var e=Cbola.Common.Ads.Triggers.Base,t=Cbola.EventBus,i=Cbola._,o=Cbola.Utils,n=function(t,i){e.call(this,t,i),this.styleProperties={top:Cbola.Config.layouts.inContent.facts.indexOf(this.layerType)>-1?this.initialWrapperHeight-this.adHeight+"px":"0",left:-1*(this.adWidth+Cbola.Config.adAsideOfUnitExtraMargin)+"px",right:"auto",display:"block!important","z-index":"6","background-color":"transparent",width:this.adWidth+"px"}};return n.prototype=Object.create(e.prototype),n.constructor=n,n.prototype.appendTriggerStructure=function(){e.prototype.appendTriggerStructure.call(this),t.fire(t.Events.RESIZE_ON_AD+this.elemId)},n.prototype.triggerElementsStyle=function(){var e=this;this.wrapperHeight=this.adHeight+Cbola.Config.adTitleStructureTriviaHeight,this.wrapperMarginLeft=this.adWidth+Cbola.Config.adAsideOfUnitExtraMargin+"px",setTimeout(function(){e.toggleXButton(),e.banner.style.backgroundColor="transparent",i.extend(e.adStructureNode.style,{margin:"auto",height:e.adHeight})},0)},n.prototype.adScale=o.noOp,n.prototype.removeStructure=function(){e.prototype.removeStructure.call(this),t.fire(t.Events.RESIZE_ON_AD+this.elemId)},n}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.LeftPopOnUnit=function(){var e=Cbola.Common.Ads.Triggers.Base,t=Cbola.EventBus,i=Cbola.InContent.Layers.Base.prototype,o=(Cbola._,Cbola.Utils),n=function(t,o){e.call(this,t,o),this.layer=Cbola.InContent.Manager.getLayerByElementId(this.elemId),i.isPlaybox.call({type:this.layerType})&&(this.appendTo=this.layer.view.itemsBoxElem,this.inSlideShow=!0),this.styleProperties={top:"0",left:"0",display:"none","z-index":"6","background-color":this.inSlideShow?"#fff":"transparent",width:this.adWidth+"px",height:this.adHeight+"px",overflow:"hidden"}};return n.prototype=Object.create(e.prototype),n.constructor=n,n.prototype.triggerElementsStyle=function(){var e=this;setTimeout(function(){e.toggleXButton(!0)},2500),this.adStructureNode.style["display"]="block",t.fire(t.Events.COVERING_TRIGGER_ON+this.elemId)},n.prototype.closeAnimation=function(){this.isClose()||(this.adStructureNode.style["display"]="none",this.setClose())},n.prototype.removeStructure=function(){e.prototype.removeStructure.call(this),this.inSlideShow&&t.fire(t.Events.COVERING_TRIGGER_OFF+this.elemId)},n.prototype.adScale=o.noOp,n}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.RightInsideUnit=function(){var e=Cbola.Common.Ads.Triggers.LeftInsideUnit,t=function(t,i){e.call(this,t,i),this.styleProperties={top:"0",right:-1*this.adWidth+"px",display:"block!important","-webkit-transition":this.animationEnabled?"transform 0.6s ease, height 0.6s ease":"none",transition:this.animationEnabled?"transform 0.6s ease, height 0.6s ease":"none","z-index":"6","background-color":"transparent",width:this.adWidth+"px",height:this.adHeight+"px",overflow:"hidden"}};return t.prototype=Object.create(e.prototype),t.constructor=t,t.prototype.triggerElementsStyle=function(){var e=this;setTimeout(function(){e.inSlideShow?setTimeout(function(){e.toggleXButton(!0)},2500):e.toggleXButton(!1),e.banner.style["background-color"]="transparent",e.adStructureNode.style["transform"]="translateX(-"+e.adWidth+"px)",e.adStructureNode.style["height"]=e.initialWrapperHeight+"px"},0)},t.prototype.closeAnimation=function(){this.isClose()||(this.adStructureNode.style["transform"]="translateX(0)",this.setClose())},t}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.RightOfUnit=function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Common.Ads.Triggers.Base,o=Cbola.EventBus,n=function(e,t){i.call(this,e,t),this.styleProperties={top:Cbola.Config.layouts.inContent.facts.indexOf(this.layerType)>-1?this.initialWrapperHeight-this.adHeight+"px":"0",right:-1*(this.adWidth+Cbola.Config.adAsideOfUnitExtraMargin)+"px",display:"block",left:"inherit","z-index":"6","background-color":"transparent",width:this.adWidth+"px"}};return n.prototype=Object.create(i.prototype),n.constructor=n,n.prototype.appendTriggerStructure=function(){i.prototype.appendTriggerStructure.call(this),o.fire(o.Events.RESIZE_ON_AD+this.elemId)},n.prototype.triggerElementsStyle=function(){var t=this;this.wrapperHeight=this.adHeight+Cbola.Config.adTitleStructureTriviaHeight,this.wrapperMarginRight=this.adWidth+Cbola.Config.adAsideOfUnitExtraMargin+"px",setTimeout(function(){t.toggleXButton(),t.banner.style.backgroundColor="transparent",e.extend(t.adStructureNode.style,{margin:"auto",height:t.adHeight+"px"})},0)},n.prototype.adScale=t.noOp,n.prototype.removeStructure=function(){i.prototype.removeStructure.call(this),o.fire(o.Events.RESIZE_ON_AD+this.elemId)},n}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.StaticBanner=Cbola.Common.Ads.Triggers.StaticBanner||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Common.Ads.Triggers.Base,o=Cbola.InContent.Manager,n=function(e,t){i.call(this,e,t),this.deleteStructure(),this.layer=o.getLayerByElementId(this.elemId)};return e.extend(n.prototype,i.prototype),n.prototype.appendTriggerStructure=function(){this.banner=this.layer.getBanner({width:this.originalAdWidth,height:this.originalAdHeight}),this.banner&&(this.triggerStructureAppended=!0,this.element=this.banner.parentElement)},n.prototype.adScale=function(){e.isFunction(this.layer.scaleAd)&&this.layer.scaleAd()},n.prototype.closeAnimation=t.noOp,n.prototype.removeStyle=t.noOp,n.prototype.toggleXButton=t.noOp,n.prototype.appendTriggerStyle=t.noOp,n.prototype.bannerTagStyle=t.noOp,n}(),Cbola.Common=Cbola.Common||{},Cbola.Common.Ads=Cbola.Common.Ads||{},Cbola.Common.Ads.Triggers=Cbola.Common.Ads.Triggers||{},Cbola.Common.Ads.Triggers.Manager=Cbola.Common.Ads.Triggers.Manager||function(){var t=Cbola._,i=Cbola.Config,o=Cbola.Env,n=Cbola.EventBus,r=Cbola.TaskManager,a=Cbola.Utils,s=Cbola.Common.AnalyticsService,l=Cbola.Common.UserService,d=Cbola.Common.ConsentProviders.Manager,c=Cbola.Enums,h=Cbola.Common.Ads.Triggers,m=c.AbTests,p=c.AdCloseBehaviors,u=c.AdOpenBehaviors,b=c.AdInjectionTypes,f=c.AdTriggerTypes,g=c.HeaderBiddingRequestStatus,y=c.RefreshTypes,v=c.SetClickTypes,w=n.Events,_=Cbola.Logger.getInstance(),C=Cbola.Logger.Colors.PALE_YELLOW,I=function(e,t){return""+e.Apperance+(e instanceof h.InItem?"_"+e.spot:"")+(t?"."+t:"")},x=1,E=50,S="TriggersManager",T={};T[f.LEFT_INSIDE_UNIT]={TriggerConstructor:h.LeftInsideUnit,requiredContainerOverflow:"hidden",collidesWith:[f.CENTER_INSIDE_UNIT,f.RIGHT_INSIDE_UNIT,f.LEFT_POP_ON_UNIT]},T[f.CENTER_INSIDE_UNIT]={TriggerConstructor:h.CenterInsideUnit,requiredContainerOverflow:"hidden",collidesWith:[f.LEFT_INSIDE_UNIT,f.BELOW_COVER_CONTENT,f.RIGHT_INSIDE_UNIT,f.LEFT_POP_ON_UNIT]},T[f.BELOW_COVER_CONTENT]={TriggerConstructor:h.BelowCoverContent,requiredContainerOverflow:"visible",collidesWith:[f.CENTER_INSIDE_UNIT]},T[f.BELOW_PUSH_CONTENT]={TriggerConstructor:h.BelowPushContent,collidesWith:[f.ABOVE_PUSH_CONTENT]},T[f.RIGHT_INSIDE_UNIT]={TriggerConstructor:h.RightInsideUnit,requiredContainerOverflow:"hidden",collidesWith:[f.LEFT_INSIDE_UNIT,f.CENTER_INSIDE_UNIT,f.LEFT_POP_ON_UNIT]},T[f.RIGHT_OF_UNIT]={TriggerConstructor:h.RightOfUnit,requiredContainerOverflow:"visible",collidesWith:[f.LEFT_OF_UNIT]},T[f.LEFT_OF_UNIT]={TriggerConstructor:h.LeftOfUnit,requiredContainerOverflow:"visible",collidesWith:[f.RIGHT_OF_UNIT]},T[f.INNER_BANNER]={TriggerConstructor:h.InnerBanner},T[f.ABOVE_PUSH_CONTENT]={TriggerConstructor:h.AbovePushContent,requiredContainerOverflow:"hidden",collidesWith:[f.BELOW_PUSH_CONTENT]},T[f.LEFT_POP_ON_UNIT]={TriggerConstructor:h.LeftPopOnUnit,requiredContainerOverflow:"hidden",collidesWith:[f.LEFT_INSIDE_UNIT,f.CENTER_INSIDE_UNIT,f.RIGHT_INSIDE_UNIT]},T[f.IN_ITEM]={TriggerConstructor:h.InItem},T[f.IN_ITEM_COVER]={TriggerConstructor:h.InItemCover,requiredContainerOverflow:"hidden"},T[f.IN_ITEM_NO_BUTTONS]={TriggerConstructor:h.InItemNoButtons},T[f.IN_ITEM_WITH_DURATION]={TriggerConstructor:h.InItemWithDuration},T[f.IN_ITEM_MOBILE]={TriggerConstructor:h.InItemMobile},T[f.BELOW_MOBILE]={TriggerConstructor:h.BelowMobile},T[f.ABOVE_MOBILE]={TriggerConstructor:h.AboveMobile},T[f.FIXED_FOOTER]={TriggerConstructor:h.FixedFooter},T[f.STATIC_BANNER]={TriggerConstructor:h.StaticBanner};var A={OPEN:"open",CLOSE:"close",REFRESH_CLICK:"refresh_on_click",REFRESH_VIEWABILITY:"refresh_on_viewability",REMOVE:"remove"},L=function(e){var r=this;this.layerType=e.layerType,this.wid=e.widgetId,this.elemId=e.elementId,this.FREEZE=!1,this.delayFromLastScroll=0,this.isReady=!1,this.resolvers=[],this.pendingTriggers=[],this.activeTriggers=[],this.finishedTriggers=[],this.footerBackground=e.footerBackground,this.handlers={};var a=""+w.ADS_STORES_MANAGER_READY+this.wid,s={adsStoreReadyEventFired:!1,layerReadyEventFired:!1,pageLoaded:i.abTestId!==m.ADS_ON_PAGE_LOAD||o.topWindow!==window.top||"complete"===o.topWindow.document.readyState},l=function(){t.some(s,function(e){return!e})||r.start()},d=function(e){e.type===r.layerType&&e.elementId===r.elemId&&(n.removeEventListener("LayerReadyEvent",r,!1),s.layerReadyEventFired=!0,r.layer=e,l())},c=function(e){n.removeEventListener(a,r,!1),s.adsStoreReadyEventFired=!0,r.adsStore=e,r.adsData=e.getAdsData(),l()},h=function(){o.topWindow.removeEventListener("load",r,!1),s.pageLoaded=!0,l()};this.handleEvent=function(e){switch(e.type){case a:c(e.detail);break;case w.LAYER_READY:d(e.detail);break;case"load":h()}},n.addEventListener(a,this,!1),
n.addEventListener(w.LAYER_READY,this,!1),s.pageLoaded||o.topWindow.addEventListener("load",this,!1)};return L.prototype.start=function(){var e=this;this.containerBox=this.layer.boxElem,this.containerWrapper=this.layer.container,this.initialWrapperHeight=this.layer.options.layerHeight||this.containerBox.getBoundingClientRect().height,this.initialWrapperMarginLeft=this.containerWrapper.style["margin-left"],this.initialWrapperMarginRight=this.containerWrapper.style["margin-right"],this.initTriggers(),this.initConditionedRefreshData(),t.isEmpty(this.pendingTriggers)||112842!==o.domainId?t.isEmpty(this.pendingTriggers)?_.errorM(S+".start",S+" failed to start, no triggers initialized."):(d.hasConsent().then(a.noOp).catch(this.endAdsProcess.bind(this)),this.startPendingTriggers()):l.isEUUserAsync().then(function(e){return e?d.hasConsent():Promise.resolve()}).then(function(){e.startPendingTriggers()}).catch(this.endAdsProcess.bind(this))},L.prototype.initTriggers=function(){var e=this,i=t.get(this.adsData,"TriggerSettings",[]);try{o.DEBUG}catch(n){}t.forEach(i,function(i){var n=t.extend({},i);!t.isEmpty(n.OpenBehaviors)&&e.translateApperance(n)&&(n.Apperance!==f.FIXED_FOOTER||o.topWindow===window.top&&!o.topWindow.document.querySelector("#cbola-footer-banner"))&&([f.IN_ITEM,f.IN_ITEM_COVER,f.IN_ITEM_NO_BUTTONS,f.IN_ITEM_WITH_DURATION,f.IN_ITEM_MOBILE].some(function(e){return e===n.Apperance})?t.isEmpty(n.Spots)||(n.Spots.sort(function(e,t){return e-t}).filter(function(e,t,i){return t===i.indexOf(e)}),n.OpenBehaviors.splice(1,n.OpenBehaviors.length-1),t.forEach(n.Spots,function(i){var o={currentSpot:i};t.extend(o,n),o.OpenBehaviors=n.OpenBehaviors.slice(0),o.CloseBehaviors=[],e.pushToPendingTriggers(o)})):e.pushToPendingTriggers(n))})},L.prototype.translateApperance=function(e){var o=this,n=t.get(i.triggersDictionary,""+e.Apperance);return n&&n.supportedLayers&&n.supportedLayers.some(function(e){return e===o.layerType})?(e.Apperance=t.get(n,"translatedTo",e.Apperance),!0):(_.info(C,S+".translateApperance could not translate appropriate trigger apperance #"+e.Apperance+" for element Id: "+this.elemId),!1)},L.prototype.pushToPendingTriggers=function(e){if("undefined"!=typeof T[e.Apperance]){var t=T[e.Apperance].TriggerConstructor;if(!t)return this;var i=new t(e,{elementId:this.elemId,containerWrapperNode:this.containerWrapper,initialWrapperHeight:this.initialWrapperHeight,layerType:this.layerType,footerBackground:this.footerBackground,animationEnabled:this.layer.options.ShowAdAnimation,showAdvertisementTitle:this.layer.options.ShowAdvertisementTitleOnAds}).init();i.refreshFixedTime=this.getRefreshFixedTime(),i.triggerOverflow=T[e.Apperance].requiredContainerOverflow,this.pendingTriggers.push(i)}},L.prototype.initConditionedRefreshData=function(){var e=this.getDelayLastScroll();(a.isWindowTopSupported()||!a.isInIframe()&&e>0)&&(this.prevWindowScroll=o.topWindow.scrollY||o.topWindow.pageYOffset,this.testConditionedRefresh(Date.now()-e))},L.prototype.testConditionedRefresh=function(e){var t=this,i=this.getDelayLastScroll(),n=o.topWindow.scrollY||o.topWindow.pageYOffset,r=Math.abs(n-this.prevWindowScroll);return r>E?(this.delayFromLastScroll=i,this.prevWindowScroll=n,requestAnimationFrame(function(){return t.testConditionedRefresh(Date.now())})):(this.delayFromLastScroll=i-(Date.now()-e),requestAnimationFrame(function(){return t.testConditionedRefresh(e)})),this},L.prototype.startPendingTriggers=function(){var e=this;this.attachAddedSizesHandlerOnce(),this.pendingTriggers.slice(0).sort(function(e,i){return e.Apperance!==i.Apperance?e.Apperance-i.Apperance:t.isNil(e.spot)||t.isNil(i.spot)?0:e.spot-i.spot}).reduce(function(t,i){return e.beforeActivationValidation(i)&&(e.pullTriggerFromArray(e.pendingTriggers,i,"Apperance"),e.pushTriggerOnce(e.activeTriggers,i,"Apperance"),t.push(i)),t},[]).forEach(this.initTriggerOpening.bind(this)),this.isReady||this.testReadiness()},L.prototype.attachAddedSizesHandlerOnce=t.once(function(){var e=""+w.ADS_STORES_MANGER_ADDED_SIZES+this.wid,t=function(){n.removeEventListener(e,t),this.startPendingTriggers()}.bind(this);n.addEventListener(e,t)}),L.prototype.testReadiness=function(){for(var e=0;e<this.activeTriggers.length;e++)if("undefined"==typeof this.activeTriggers[e].currentOpenBehavior||!this.activeTriggers[e].isAppended()&&this.activeTriggers[e].currentOpenBehavior.Type===u.TIMER&&0===this.activeTriggers[e].currentOpenBehavior.Delay)return void r.addTask(this.testReadiness,[],this,S+".testReadiness");this.isReady=!0,t.forEach(this.resolvers,function(e){t.isFunction(e)&&e()})},L.prototype.beforeActivationValidation=function(e){return!this.isActive(e,"Apperance")&&!this.isOverflowCollision(e.Apperance)&&!this.isApperanceCollision(e.Apperance)&&this.adsStore.hasAvailableAdsForSize(e.getPlaceholderSizeName())},L.prototype.initTriggerOpening=function(e){var i=e.openBehaviors.shift();if(t.isNil(i))return _.info(C,S+".initTriggerOpening haven't found openBehavior - closing apperance: "+e.Apperance),void this.removeTrigger(e);if(!e.isOpen()){if(e.setOpen(),e.currentOpenBehavior=i,i.Type===u.TIMER||i.Type===u.VIEWABLE&&this.layer.isViewable()||i.Type===u.PAGE_LOAD&&a.isPageReady())return _.info(C,S+".initTriggerOpening sent apperance: "+e.Apperance+" to open by timer"),void this.openTriggerByTimer(e);var r=void 0,s=void 0;switch(i.Type){case u.VIEWABLE:r=[n],s=this.layer.viewableEvent;break;case u.HOVER_ON_UNIT:r=[this.containerBox],s="hover";break;case u.ENGAGEMENT:r=this.layer.boxElem.querySelectorAll(".cbola-refresh-click-trigger"),s="click";break;case u.PAGE_LOAD:r=[o.topWindow],s="load";break;default:return void this.removeTrigger(e)}if(!r)return void _.errorM(S+".initTriggerOpening",S+".initTriggerOpening failed to find element to attach event "+s+" for apperance: "+e.Apperance);_.info(C,S+".initTriggerOpening attached event: "+s+" for Apperance: "+e.Apperance),this.setOpenTriggerEventHandler(r,s,e)}},L.prototype.setOpenTriggerEventHandler=function(e,i,o){var r=this,a=t.map(e,function(e){var t=function(){this.onEventOpenTrigger(o)}.bind(r);return e.addEventListener(i,t),{eventName:i,attachedOn:e,fn:t}});if("load"===i){var s=t.get(o.currentOpenBehavior,"Duration",0);if(s>0){var l=""+w.PAGE_LOAD_FALLBACK+I(o),d=function(){this.onEventOpenTrigger(o)}.bind(this);a.push({attachedOn:n,eventName:l,fn:d}),n.addEventListener(l,d),setTimeout(function(){n.fire(l)},1e3*s)}}this.addToHandlers(o,A.OPEN,a)},L.prototype.onEventOpenTrigger=function(e){this.unbindTriggersEventHandlers(e,A.OPEN),this.openTriggerByTimer(e)},L.prototype.openTriggerByTimer=function(e){var t=this,i=e.currentOpenBehavior.Delay;_.info(C,S+".openTriggerByTimer open apperance "+e.Apperance+" in "+i+" seconds"),setTimeout(function(){t.openTrigger(e,i>0)},1e3*i)},L.prototype.openTrigger=function(e,t){var i=this;if(e.isAppended()||this.isFinished(e))e.isAppended()&&this.openAppendedTrigger(e);else{if(this.delayFromLastScroll>200&&t)return _.info(C,"Postponing trigger appearance "+e.Apperance+" opening by "+this.delayFromLastScroll+"mil-seconds due to scrolling"),void setTimeout(function(){i.openTrigger(e,t)},this.delayFromLastScroll);this.appendTrigger(e)}},L.prototype.appendTrigger=function(e){var t=this;this.adsStore.getAd(e).then(function(o){e.appendTriggerStructure(),e.isAppended()?(e.appendTriggerStyle(),e.injectAd(o),(e instanceof h.BelowPushContent||e instanceof h.AbovePushContent)&&t.layer.iframeBuster.checkIframeDimension(e.adHeight+i.adTitleStructureTriviaHeight),e.closeTriggerButton&&e.closeTriggerButton.addEventListener("click",function(){s.setClick(t.elemId,e instanceof h.FixedFooter?v.FOOTER_AD_BUTTON_CLOSE:v.AD_BUTTON_CLOSE),t.removeTrigger(e)}),t.attachClickEventRefreshHandlers(e),t.isViewabilityRefreshEnabled()&&e.updateViewability(),t.setNextRefreshTime(e),t.openAppendedTrigger(e)):(_.warnM(S+".appendTrigger",S+".appendTrigger failed to append trigger: "+e.Apperance+" in element ID: "+t.elemId+" - removing apperance"),t.removeTrigger(e))}).catch(function(i){_.warnM(S+".appendTrigger",S+".appendTrigger failed to load first ad for apperance: "+e.Apperance+" in element ID: "+t.elemId+" - removing apperance"),_.errorM(S+".appendTrigger",S+".appendTrigger failed due to: "+i),t.removeTrigger(e)})},L.prototype.attachClickEventRefreshHandlers=function(e){if(!(e instanceof h.InItem)){var i=this.layer.container.querySelectorAll(".cbola-refresh-click-trigger");if(!(t.isEmpty(i)||e instanceof h.InItem)){var o=function(o){var n=function(){o(e)};return t.map(i,function(e){return e.addEventListener("click",n),{handler:n,attachedOn:e,eventName:"click"}})},n="",r=[];e instanceof h.LeftInsideUnit?(n=A.REMOVE,r=o(this.removeTrigger.bind(this))):this.isClickRefreshEnabled()&&(n=A.REFRESH_CLICK,r=o(this.refreshTriggerOnClick.bind(this))),n.length>0&&r.length>0?this.addToHandlers(e,n,r):_.info(C,"No refreshes allowed on click for element Id:"+this.elemId)}}},L.prototype.openAppendedTrigger=function(e){e.triggerElementsStyle(),t.isNil(this.layer.boxElem)||e.adScale(this.layer.boxElem.getBoundingClientRect().width),this.setWrapperHeight(),this.setContainerOverflow(),this.setWrapperMargin(),this.initTriggerClosing(e)},L.prototype.refreshTriggerAd=function(t){var i=this,o="refreshTriggerAd";t.isRefreshable()?this.adsStore.getAd(t).then(function(e){t.injectAd(e),t.resetMalwareRefresh(),_.info(Cbola.Logger.Colors.PALE_GREEN,S+"."+o+" injected ad for apperance: "+t.Apperance)}).catch(function(n){n instanceof Error?_.warnM(S+"."+o,S+"."+o+" failed injecting ad for trigger apperance: "+t.Apperance+", element ID: "+i.elemId+". Error: ",e):n===!0&&(t.stopRefresh(),_.info(C,S+"."+o+" No ads left, stopping refreshes for trigger apperance: "+t.Apperance+", element ID: "+i.elemId))}):_.info(C,S+"."+o+" stopped refreshing apperance: "+t.Apperance+", element Id: "+this.elemId)},L.prototype.setNextRefreshTime=function(e){var t=this,i="setNextRefreshTime";if(!e.isRefreshable())return void _.info(C,S+"."+i+" stopped due to all refreshes stop for trigger Apperance: "+e.Apperance);if(this.isViewabilityRefreshEnabled()&&!e.isViewable())return _.info(C,S+"."+i+" adding event listener pending viewability to trigger refreshing for Apperance: "+e.Apperance),void this.setRefreshOnViewability(e);if(!this.isTimeoutRefreshEnabled()&&!this.isViewabilityRefreshEnabled())return void _.info(C,"Refresh by timeout is not allowed for elementId: "+this.elemId);if(e.refreshFixedTime.length>0){var o=e.refreshFixedTime.shift();if(o&&o>0)return e.refreshFixedTime=e.refreshFixedTime.map(function(e){return e-o}),_.info(C,"Trigger apperance "+e.Apperance+" for element ID: "+this.elemId+" would try to refresh by timeout in : "+o+"sec."),void(e.refreshTimeoutId=setTimeout(function(){t.refreshOnTimeout(e)},1e3*o))}else{var n=e.refreshInterval||this.getRefreshInterval();if(n&&n>0)return _.info(C,"Trigger apperance "+e.Apperance+" for element ID: "+this.elemId+" would try to refresh by timeout in: "+n+"mili-sec."),void(e.refreshTimeoutId=e.intervalRefreshTimeoutId=setTimeout(function(){t.refreshOnTimeout(e)},n))}return _.warnM(S+"."+i,S+"."+i+" stopped refreshing due to inability to set nextRefreshInterval for apperance "+e.Apperance+" in element Id: "+this.elemId),e.stopRefresh(),this},L.prototype.setRefreshOnViewability=function(e){var t={attachedOn:n,eventName:e.viewableEvent,fn:function(){_.info(C,S+".setRefreshOnViewability removed event listener pending viewability to trigger refreshing for Apperance: "+e.Apperance),this.unbindTriggersEventHandlers(e,A.REFRESH_VIEWABILITY),this.setNextRefreshTime(e)}.bind(this)};n.addEventListener(t.eventName,t.fn),this.addToHandlers(e,A.REFRESH_VIEWABILITY,[t])},L.prototype.refreshOnTimeout=function(e){var t=this;e.setAdInjectionType(b.TIMEOUT),this.delayFromLastScroll>200?(_.info(C,"Delaying trigger apperance "+e.Apperance+" refresh by "+this.delayFromLastScroll+" mil-seconds due to scrolling"),setTimeout(function(){t.refreshOnTimeout(e)},this.delayFromLastScroll)):(this.refreshTriggerAd(e),this.setNextRefreshTime(e))},L.prototype.refreshTriggerOnClick=function(e){e.isRefreshable()&&!this.isFinished(e)?(_.info(C,"Trigger apperance "+e.Apperance+" for element ID: "+this.elemId+" would try to refresh by click"),e.setAdInjectionType(b.CLICK),this.refreshTriggerAd(e),e.intervalRefreshTimeoutId&&(_.info(C,S+".refreshOnClick cleared timeout for apperance "+e.Apperance),clearTimeout(e.intervalRefreshTimeoutId),this.setNextRefreshTime(e))):(_.info(C,"Trigger apperance "+e.Apperance+" for element ID: "+this.elemId+" stops refresh by click"),this.unbindTriggersEventHandlers(e,A.REFRESH_CLICK))},L.prototype.initTriggerClosing=function(e){var i="initTriggerClosing",o=e.closeBehaviors.shift();if(t.isNil(o))return void _.info(C,"No closing behavior found for apperance: "+e.Apperance);if(e.isClose())return void _.info(C,S+"."+i+" trying to close already closed apperance: "+e.Apperance+" in element ID: "+this.elemId);if(e.currentCloseBehavior=o,o.Type===p.TIMER||o.Type===p.VIEWABLE&&this.layer.isViewable())return _.info(C,S+"."+i+" sent apperance: "+e.Apperance+" to close by timer"),void this.closeTriggerByTimer(e);var r=void 0,a=void 0;switch(o.Type){case p.VIEWABLE:r=[n],a=this.layer.viewableEvent;break;case p.HOVER_ON_UNIT:r=[this.containerBox],a="hover";break;case p.ENGAGEMENT:r=this.layer.boxElem.querySelectorAll(".cbola-refresh-click-trigger"),a="click";break;default:return void this.removeTrigger(e)}return r?(_.info(C,S+"."+i+" attached event: "+a+" for Apperance: "+e.Apperance),void this.setCloseTriggerEventHandler(r,a,e)):void _.errorM(S+"."+i,S+"."+i+" failed to find element to attach event "+a+" for apperance: "+e.Apperance)},L.prototype.setCloseTriggerEventHandler=function(e,i,o){var n=this,r=function(){n.onEventCloseTrigger(o)},a=t.map(e,function(e){return e.addEventListener(i,r),{eventName:i,attachedOn:e,fn:r}});this.addToHandlers(o,A.CLOSE,a)},L.prototype.onEventCloseTrigger=function(e){this.unbindTriggersEventHandlers(e,A.CLOSE),this.closeTriggerByTimer(e)},L.prototype.closeTriggerByTimer=function(e){var t=this,i=e.currentCloseBehavior.Duration;this.FREEZE||setTimeout(function(){t.FREEZE||t.isFinished(e)||(e.closeAnimation(),e.setClose(),t.initTriggerOpening(e))},1e3*i)},L.prototype.removeTrigger=function(e){var t=this;if(!this.isFinished(e)){this.pullTriggerFromArray(this.pendingTriggers,e),this.pullTriggerFromArray(this.activeTriggers,e),this.pushTriggerOnce(this.finishedTriggers,e),this.unbindTriggersEventHandlers(e),e.closeAnimation(),e.setClose();var i=e instanceof h.LeftInsideUnit?5e3:0;_.info(C,S+".removeTrigger, removing trigger with apperance: "+e.Apperance+", in "+i+"mil-seconds"),setTimeout(function(){e.removeStyle(),e.removeStructure(),clearTimeout(e.refreshTimeoutId),t.setWrapperHeight(),t.setContainerOverflow(),t.setWrapperMargin(),t.startPendingTriggers()},i)}},L.prototype.setWrapperHeight=function(){var e=this.initialWrapperHeight,i=this.containerWrapper.style;t.forEach(this.activeTriggers,function(t){e=e<t.wrapperHeight?t.wrapperHeight:e}),this.containerWrapper.offsetHeight!==e&&e>0&&!this.layer.isMobile()&&(i["height"]=e+"px")},L.prototype.setContainerOverflow=function(){for(var e="hidden",t=0;t<this.activeTriggers.length;t++){var i=this.activeTriggers[t];if(i.triggerOverflow){e=i.triggerOverflow;break}}this.containerWrapper.style["overflow"]=e},L.prototype.setWrapperMargin=function(){for(var e=void 0,i=void 0,n=void 0,r=0;r<this.activeTriggers.length;r++){var a=this.activeTriggers[r];"undefined"!=typeof a.wrapperMarginLeft&&"auto"!==a.wrapperMarginLeft&&(e=a.wrapperMarginLeft,i="left",n="right"),"undefined"!=typeof a.wrapperMarginRight&&"auto"!==a.wrapperMarginRight&&(e=a.wrapperMarginRight,i="right",n="left")}t.isNil(i)?(this.containerWrapper.style["margin-left"]=this.initialWrapperMarginLeft,this.containerWrapper.style["margin-right"]=this.initialWrapperMarginRight):(this.containerWrapper.style["margin-"+i]=e,"frbs61"===o.activePid&&(this.containerWrapper.style["margin-"+n]=0))},L.prototype.isActive=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Apperance",o=function(t){return t[i]===e[i]};return"Apperance"===i&&e instanceof h.InItem&&(o=function(t){return t.Apperance===e.Apperance&&t.spot===e.spot}),!t.isNil(t.find(this.activeTriggers,o))},L.prototype.isOverflowCollision=function(e){var t=T[e].overflow;if("undefined"==typeof t)return!1;for(var i=0;i<this.activeTriggers.length;i++){var o=this.activeTriggers[i].Apperance;if(T[o].overflow!==t)return!0}return!1},L.prototype.isApperanceCollision=function(e){var t=T[e].collidesWith;if("undefined"==typeof t)return!1;for(var i=0;i<this.activeTriggers.length;i++){var o=this.activeTriggers[i].Apperance;if(t.indexOf(o)>-1)return!0}return!1},L.prototype.isFinished=function(e){return!t.isNil(t.find(this.finishedTriggers,function(t){return t.id===e.id}))},L.prototype.pullTriggerFromArray=function(e,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id";t.remove(e,function(e){return e[o]===i[o]})},L.prototype.pushTriggerOnce=function(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",o=0;o<e.length;o++){var n=e[o];if(n[i]===t[i]){if("Apperance"===i&&t instanceof h.InItem&&t.spot!==n.spot)continue;return this}}return e.push(t),this},L.prototype.getActiveTrigger=function(e,i){return e=parseInt(e),i=parseInt(i),t.find(this.activeTriggers,function(o){return o.Apperance===e&&(t.isNil(o.spot)&&isNaN(i)||o.spot===i)})},L.prototype.noFillFallback=function(e,t,i){var o=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,a=this.getActiveTrigger(e,t);if("undefined"==typeof a)return!1;var l=a.getAdObjByBannerId(i),d=0;if(l&&(d=l.getID()),a instanceof h.InItemNoButtons&&setTimeout(function(){return n.fire(""+w.SKIP_SPOT+o.elemId+"_"+t)},5e3),l instanceof Cbola.Common.Ads.Tags.Waterfall&&a.getInjectionType()!==b.INJECT_PSA&&(this.adsStore.updateWaterfallPSACounter(a),this.adsStore.isWaterfallMaxPlacementPSA(a)?this.adsStore.removeWaterfallAdsForSize(a):l.incrementPSACount(this.adsStore)),a.isRefreshable()&&4===r&&this.adsStore.isLowTierSupported(a)){s.setHbBidRequestProto([{TagId:this.adsStore.getRandomHbTagId(a),Status:g.REQUEST_LOW_TIER_MADE}]);var c=this.adsStore.getLowTierFallbackAd(a);if(c)return a.setAdInjectionType(b.WF_FALLBACK),a.injectAdToExistingBanner(c,i),s.setLastMile({tag_id:d}),!0}return a.preventBannerReplacement(i)?(s.setLastMile({tag_id:d}),!0):!1},L.prototype.malwareRefresh=function(e,i,o,n){var r=this,a=this.getActiveTrigger(e,i);t.isNil(a)||(a.getMalwareRefreshCount()<this.getMaxMalwareBlockRefresh()?(a.setAdInjectionType(n),this.adsStore.getAd(a).then(function(e){a.injectAdToExistingBanner(e,o),a.incrementMalwareRefresh()}).catch(function(e){r.injectPSA(a,o,e)})):this.injectPSA(a,o))},L.prototype.injectPSA=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1,o="injectPSA";e.setAdInjectionType(b.INJECT_PSA),e.injectAdToExistingBanner(this.adsStore.getPSA(e),t),e.resetMalwareRefresh(),i instanceof Error?_.warnM(S+"."+o,S+"."+o+" failed injecting ad for trigger apperance: "+e.Apperance+", element ID: "+this.elemId+". Error: ",i):i===!0&&e.stopRefresh()},L.prototype.freezeAdsState=function(){this.FREEZE=!0,t.forEach(this.activeTriggers,function(e){return e.stopRefresh()}),_.warn(S+" froze ads process")},L.prototype.endAdsProcess=function(){var e=void 0;for(this.FREEZE||this.freezeAdsState();this.pendingTriggers.length>0;)e=this.pendingTriggers[0],this.pullTriggerFromArray(this.pendingTriggers,e);for(this.unbindTriggersEventHandlers();this.activeTriggers.length>0;)e=this.activeTriggers[0],this.removeTrigger(e);_.info(C,S+" ended")},L.prototype.addToHandlers=function(e,i,o){var n=I(e,i),r=t.get(this.handlers,n);t.isNil(r)||!t.isArray(r)?t.set(this.handlers,n,o):a.push.apply(r,o)},L.prototype.unbindTriggersEventHandlers=function(){for(var e=this,i=function(e){t.isEmpty(e)||t.forEach(e,function(e){e.attachedOn.removeEventListener(e.eventName,e.fn)})},o=function(e){t.forEach(A,function(t){i(e[t])})},n=arguments.length,r=Array(n),a=0;n>a;a++)r[a]=arguments[a];var s=r.length>0&&t.isString(r[r.length-1])?r.pop():null;t.isEmpty(r)?(t.forEach(this.handlers,o),delete this.handlers):t.forEach(r,function(n){var r=I(n,s),a=t.get(e.handlers,r);t.isEmpty(a)||(s?(i(a[s]),delete a[s]):(o(a),t.unset(e.handlers,r)))})},L.prototype.managerReady=function(){var e=this;return this.isReady?Promise.resolve():new Promise(function(t){return e.resolvers.push(t)})},L.prototype.getRefreshInterval=function(){return t.get(this.adsData,"RefreshInterval")},L.prototype.getRefreshFixedTime=function(){var e=t.get(this.adsData,"RefreshFixedTime",null);return t.isArray(e)?e.slice(0):[]},L.prototype.getDelayLastScroll=function(){return 1e3*(t.get(this.adsData,"DelayLastScroll",null)||0)},L.prototype.getMaxMalwareBlockRefresh=function(){return x},L.prototype.isClickRefreshEnabled=function(){var e=t.isNil(this.adsData.RefreshType)?y.BOTH:this.adsData.RefreshType;return e===y.BOTH||e===y.CLICK},L.prototype.isViewabilityRefreshEnabled=function(){return t.get(this.adsData,"RefreshType")===y.VIEWABILITY},L.prototype.isTimeoutRefreshEnabled=function(){var e=t.isNil(this.adsData.RefreshType)?y.BOTH:this.adsData.RefreshType;return e===y.BOTH||e===y.TIMEOUT},L}(),Cbola.PageAnalytics=Cbola.PageAnalytics||{},Cbola.PageAnalytics.Reporters=Cbola.PageAnalytics.Reporters||{},Cbola.PageAnalytics.Factory=Cbola.PageAnalytics.Factory||function(){var e=Cbola.PageAnalytics.Reporters,t=function(){};return t.prototype.create=function(t){var i=Cbola.PageAnalytics.Reporters.TYPES_TO_NAMES_MAP,o=i.hasOwnProperty(t)&&i[t];return"undefined"!=typeof o&&o?e[o]:{}},new t}(),Cbola.PageAnalytics.Reporters.TYPES_TO_NAMES_MAP={scroll:"ScrollReporter",data:"Data",pageLoad:"PageLoadReporter"},Cbola.PageAnalytics=Cbola.PageAnalytics||{},Cbola.PageAnalytics.ReportersManager=Cbola.PageAnalytics.ReportersManager||function(){function e(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}function t(){return{ClientVersion:Cbola.Env.clientVersion,PageViewId:r.PageProperties.cbola_pageViewId,PageId:r.PageId,WidgetId:c,DomainId:r.Domain,CategoryId:r.Category,PublisherId:r.activePid,ProductType:Cbola.Enums.ProductTypes.IN_CONTENT,AbTestId:n.abTestId,UserId:a.getUserId(),Second:o.getRunTimeInSecs(),IsMobile:r.PageProperties.isMobile,IsTablet:r.PageProperties.isTablet,isPortrait:r.PageProperties.isPortrait}}var i=Cbola._,o=Cbola.Utils,n=Cbola.Config,r=Cbola.Env,a=Cbola.Common.UserService,s=Cbola.Logger.getInstance(),l=Cbola.Logger.Colors,d=Cbola.PageAnalytics.Factory,c=0,h=[],m=function(){};return m.prototype={init:function(e,t){"string"==typeof e&&(c=t,e.replace(/\s/g,"").split(",").map(function(e){var t=d.create(e);i.isFunction(t.init)&&!h.some(function(t){return t.type===e})&&(h.push({type:e,reporter:t}),t.init(),s.info("Initialized reporter: "+e))}))},fireAnalytic:function(r){var a=r.analyticMethod,d=r.params,c=void 0===d?{}:d,h=r.onSuccess,m=void 0===h?!1:h,p=r.onError,u=void 0===p?!1:p;i.extend(c,t());var b={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:o.encodePayload(c)};fetch(""+n.Defaults.pageAnalyticsServer+a,b).then(e).then(function(e){s.info(l.PALE_PURPLE,"fired "+a+" page analytics to server."),m&&m(e)}).catch(function(e){s.trace(a+" failed."),u&&u(e)})},stopReporting:function(e){i.forEach(h,function(t){(i.isNil(e)||t.type===e)&&i.isFunction(t.reporter.stop)&&t.reporter.stop()})},isPrimary:function(){return!0}},o.isInIframe()&&!o.isWindowTopSupported()||i.get(window.top,"Cbola.Globals.ReportersManager",!1)?{isPrimary:function(){return!1}}:(window.top.Cbola=window.top.Cbola||{},window.top.Cbola.Globals=window.top.Cbola.Globals||{},window.top.Cbola.Globals.ReportersManager=window.top.Cbola.Globals.ReportersManager||new m,window.top.Cbola.Globals.ReportersManager)}();var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Cbola.PageAnalytics=Cbola.PageAnalytics||{},Cbola.PageAnalytics.Reporters=Cbola.PageAnalytics.Reporters||{},Cbola.PageAnalytics.Reporters.Data=Cbola.PageAnalytics.Reporters.Data||function(){function e(){u.removeEventListener(u.Events.LAYER_READY,e),g=t(),g&&o()}function t(){var e=window.top,t="pbjs";if(i(e[t]))return e[t];for(t in e)if(!/webkitStorageInfo|webkitIndexedDB/.test(t)&&e.hasOwnProperty(t)&&-1===t.indexOf("Cbola")&&i(e[t]))return e[t];return null}function i(e){return!d.isNil(e)&&"object"===("undefined"==typeof e?"undefined":_typeof(e))&&"function"==typeof e.getBidResponses&&"function"==typeof e.getHighestCpmBids}function o(){v=[];var e=g.getBidResponses();C=g.getHighestCpmBids().map(function(e){return e.adId}),d.forEach(e,function(e){d.forEach(e.bids,n)}),v.length>0&&c.fireAnalytic({analyticMethod:h,params:{data:v}}),f=setTimeout(o,m)}function n(e){var t=e.adId;if(!(y[t]||e.cpm<0)){y[t]=!0;var i=("function"==typeof e.getSize?e.getSize():"0x0").split("x");v.push({r:r(e.bidder),l:l(e),j:Math.trunc(e.cpm*p),b:a(e.adUnitCode),t:i[0]*p,m:i[1]*p})}}function r(e){return _[e]||(_[e]=s(e)),_[e]}function a(e){return w[e]||(w[e]=s(e)),w[e]}function s(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=0,i=0;i<e.length;i++)t+=e.charCodeAt(i);return t>0?Math.trunc(t*e.charCodeAt(e.length-1)/(10+e.charCodeAt(Math.round(e.length/2))%10)):0}function l(e){var t="function"==typeof e.getStatusCode?e.getStatusCode():b.ER.bStat;return t===b.SUC.bStat?C.indexOf(e.adId)>-1?b.HG.cStat:b.SUC.cStat:I(t)}var d=Cbola._,c=Cbola.PageAnalytics.ReportersManager,h="SetData",m=3e4,p=123450,u=Cbola.EventBus,b={PND:{bStat:0,cStat:21},HG:{bStat:1,cStat:64},SUC:{bStat:1,cStat:86},FL:{bStat:2,cStat:21},TO:{bStat:3,cStat:21},ER:{bStat:-1,cStat:99}},f=null,g=null,y={},v=[],w={},_={},C=[],I=d.memoize(function(e){var t=d.find(b,function(t){return t.bStat===e});return t?t.cStat:b.ER.cStat}),x=function(){};return x.prototype={init:function(){u.addEventListener(u.Events.LAYER_READY,e)},stop:function(){clearTimeout(f)}},new x}(),Cbola.PageAnalytics=Cbola.PageAnalytics||{},Cbola.PageAnalytics.Reporters=Cbola.PageAnalytics.Reporters||{},Cbola.PageAnalytics.Reporters.PageLoadReporter=Cbola.PageAnalytics.Reporters.PageLoadReporter||function(){function e(){setTimeout(function(){var e=0,o=0;try{e=t.result(window.top,"performance.timing.fetchStart",0),o=t.result(window.top,"performance.timing.loadEventEnd",0)}catch(r){}e&&o&&i.fireAnalytic({analyticMethod:n,params:{EventId:Cbola.Enums.SetEventTypes.PAGE_LOAD_EVENT,SecondGlobal:Math.round(100*(o-e))/1e5}})},0)}var t=Cbola._,i=Cbola.PageAnalytics.ReportersManager,o=Cbola.Utils,n="SetEvent",r=function(){};return r.prototype={init:function(){o.pageReady(e)}},new r}(),Cbola.PageAnalytics=Cbola.PageAnalytics||{},Cbola.PageAnalytics.Reporters=Cbola.PageAnalytics.Reporters||{},Cbola.PageAnalytics.Reporters.ScrollReporter=Cbola.PageAnalytics.Reporters.ScrollReporter||function(){function e(){try{return window.top.scrollY||window.top.pageYOffset}catch(e){return 0}}function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=e();if(o!==i){var d={Order:s++,PixelsFromTop:o};n.fireAnalytic({analyticMethod:r,params:d})}a=setTimeout(function(){t(o)},1e3*l.next().value)}function i(){d.cancel();try{window.top.removeEventListener("scroll",d)}catch(e){}t()}var o=Cbola._,n=Cbola.PageAnalytics.ReportersManager,r="SetScroll",a=void 0,s=1,l=function(){var e=1;return{next:function(){var t=30;return 2>=e?t=5:4>=e?t=10:6>=e&&(t=20),e++,{done:!1,value:t}}}}(),d=o.debounce(i,300,{leading:!1,maxWait:500,trailing:!0}),c=function(){};return c.prototype={init:function(){try{window.top.addEventListener("scroll",d)}catch(e){}},stop:function(){clearTimeout(a)}},new c}(),Cbola.isBrowserSupported&&(Cbola&&Cbola.bootstrapper?(Cbola.Common.TimelineService.mark("reinitialization of carambola.min.js"),Cbola.Logger.getInstance().info("Bootstrapper is already loaded")):(Cbola.Common.TimelineService.markStart("First time initialization carambola.min.js"),Cbola.bootstrapper=new Cbola.Bootstrapper,Cbola.bootstrapper.init(),Cbola.Common.TimelineService.markEnd("First time initialization carambola.min.js")));
"use strict";function _toConsumableArray2(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function _possibleConstructorReturn2(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits2(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":_typeof(t))&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":_typeof(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(){window["Cbola"]=window["Cbola"]||{},window["Cbola"]["Styles"]=window["Cbola"]["Styles"]||{},window["Cbola"]["Styles"]["Compiled"]=window["Cbola"]["Styles"]["Compiled"]||{},window["Cbola"]["Styles"]["Compiled"]["cbola_layer_138.css"]=function(e){var t,i="";return i+=".cbola-stories-facts-slideshow{width:300px;height:340px;display:block!important;box-sizing:border-box;position:relative;overflow:hidden}.cbola-stories-facts-slideshow *{box-sizing:border-box}.cbola-stories-facts-slideshow__header{width:100%;height:28px;position:relative;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.cbola-stories-facts-slideshow--round .cbola-stories-facts-slideshow__header{border-top-left-radius:8px;border-top-right-radius:8px}.cbola-stories-facts-slideshow--round .cbola-stories-facts-slideshow__header,.cbola-stories-facts-slideshow--sharp .cbola-stories-facts-slideshow__header{-ms-flex-pack:center;justify-content:center}.cbola-stories-facts-slideshow--sharp-left .cbola-stories-facts-slideshow__header{-ms-flex-pack:start;justify-content:flex-start}.cbola-stories-facts-slideshow__title{color:#fff}.cbola-stories-facts-slideshow--round .cbola-stories-facts-slideshow__title,.cbola-stories-facts-slideshow--sharp .cbola-stories-facts-slideshow__title{font-family:Roboto;font-size:18px}.cbola-stories-facts-slideshow--sharp-left .cbola-stories-facts-slideshow__title{font-family:Heebo,sans-serif;font-size:16px;padding-left:11px;text-transform:uppercase}.cbola-stories-facts-slideshow__logo{position:absolute;right:6px;top:50%;transform:translateY(-50%);display:-ms-flexbox;display:flex;-ms-flex-align:baseline;align-items:baseline;cursor:pointer}.cbola-stories-facts-slideshow__logo-carambola{width:0;height:10px;transition:width .2s ease-in .3s;background-image:url('"+(null==(t=e.clientPath)?"":t)+"css/assets/logo-sprite.svg');background-position:-38px -1px;background-repeat:no-repeat;transform:translateY(-2px)}.cbola-stories-facts-slideshow__logo:hover .cbola-stories-facts-slideshow__logo-carambola{width:43px}.cbola-stories-facts-slideshow__logo-star{width:17px;height:18px;background-image:url('"+(null==(t=e.clientPath)?"":t)+"css/assets/logo-sprite.svg');background-position:-1px -1px;background-repeat:no-repeat}.cbola-stories-facts-slideshow__logo:hover .cbola-stories-facts-slideshow__logo-star{background-position:-19px -1px}.cbola-stories-facts-slideshow__btns-group{width:100%;height:0;position:absolute;top:184px;left:0;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;z-index:100}.cbola-stories-facts-slideshow__btn{position:relative;cursor:pointer;width:23px;height:42px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.cbola-stories-facts-slideshow__btn:before,.cbola-stories-facts-slideshow__btn:hover:after{content:' ';display:block;height:100%;position:absolute;width:100%}.cbola-stories-facts-slideshow__btn:before{padding:45px 30px}.cbola-stories-facts-slideshow--round .cbola-stories-facts-slideshow__btn{background-color:rgba(255,255,255,.9)}.cbola-stories-facts-slideshow__btn:hover:after{background-color:rgba(0,0,0,.3);top:0;left:0}.cbola-stories-facts-slideshow__btn .cbola-icon{font-size:27px;transform:translate(0,0)}.cbola-stories-facts-slideshow--round .cbola-stories-facts-slideshow__btn .cbola-icon{color:#6a6a6a}.cbola-stories-facts-slideshow--sharp .cbola-stories-facts-slideshow__btn .cbola-icon,.cbola-stories-facts-slideshow--sharp-left .cbola-stories-facts-slideshow__btn .cbola-icon{color:#fff}.cbola-stories-facts-slideshow__btn--prev{box-shadow:1px 0 2px 1px rgba(0,0,0,.31)}.cbola-stories-facts-slideshow--round .cbola-stories-facts-slideshow__btn--prev,.cbola-stories-facts-slideshow--round .cbola-stories-facts-slideshow__btn--prev:hover:after{border-top-right-radius:4px;border-bottom-right-radius:4px}.cbola-stories-facts-slideshow__btn--next{box-shadow:-1px 0 2px 1px rgba(0,0,0,.31)}.cbola-stories-facts-slideshow--round .cbola-stories-facts-slideshow__btn--next,.cbola-stories-facts-slideshow--round .cbola-stories-facts-slideshow__btn--next:hover:after{border-top-left-radius:4px;border-bottom-left-radius:4px}.cbola-stories-facts-slideshow__ads-container{width:100%;height:250px;position:absolute;bottom:0;transform:translate3d(100%,0,0);z-index:10}.cbola-stories-facts-slideshow__content-wrapper{width:100%;height:calc(100% - 28px);position:relative;z-index:1;overflow:hidden;background-color:#fff;border:1px solid;border-top:none}.cbola-stories-facts-slideshow--round .cbola-stories-facts-slideshow__content-wrapper{border-bottom-right-radius:8px;border-bottom-left-radius:8px;border-color:#c1c1c1}.cbola-stories-facts-slideshow--sharp .cbola-stories-facts-slideshow__content-wrapper,.cbola-stories-facts-slideshow--sharp-left .cbola-stories-facts-slideshow__content-wrapper{border-color:#e2e2e2}.cbola-stories-facts-slideshow__items-container{position:absolute;bottom:4px;left:0;width:100%;height:240px}.cbola-stories-facts-slideshow-item{width:100%;height:240px;overflow:hidden}.cbola-stories-facts-slideshow--round .cbola-stories-facts-slideshow-item{border-radius:6px;width:290px}.cbola-stories-facts-slideshow-item-wrapper{width:100%;height:100%;position:absolute;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;transition:transform .4s ease-in-out}.cbola-stories-facts-slideshow-item__image{width:100%;max-width:100%;height:auto}.cbola-stories-facts-slideshow-item__image-wrapper{width:100%;height:134px;position:relative;overflow:hidden;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.cbola-stories-facts-slideshow-item__content-wrapper{width:100%;height:calc(100% - 134px);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.cbola-stories-facts-slideshow--round .cbola-stories-facts-slideshow-item__content-wrapper{background-color:#f3f3f3}.cbola-stories-facts-slideshow--sharp .cbola-stories-facts-slideshow-item__content-wrapper,.cbola-stories-facts-slideshow--sharp-left .cbola-stories-facts-slideshow-item__content-wrapper{background-color:#fff}.cbola-stories-facts-slideshow-item__content{font-size:14px;font-weight:500;color:#4b4a4b;padding:2px}.cbola-stories-facts-slideshow--sharp-left .cbola-stories-facts-slideshow-item__content{font-family:Heebo,sans-serif;text-align:left;padding-left:11px}.cbola-stories-facts-slideshow--round .cbola-stories-facts-slideshow-item__content,.cbola-stories-facts-slideshow--sharp .cbola-stories-facts-slideshow-item__content{font-family:Roboto;text-align:center}.cbola-stories-facts-slideshow-ad-item{width:100%;height:100%;position:absolute;transition:transform .4s ease-in-out}.cbola-stories-facts-slideshow-ad-item__banner{position:relative;opacity:1;height:100%;width:100%}.cbola-stories-facts-slideshow-ad-item__banner-wrapper{width:100%;height:100%;position:relative}.cbola-stories-facts-slideshow-item--prev{transform:translateX(-100%)}.cbola-stories-facts-slideshow-ad-item--prev{transform:translateX(-200%)}.cbola-stories-facts-slideshow-item--cancel-prev{transform:translateX(15%)}.cbola-stories-facts-slideshow-ad-item--cancel-prev{transform:translateX(-85%)}.cbola-stories-facts-slideshow-item--active{transform:translateX(0)}.cbola-stories-facts-slideshow-ad-item--active{transform:translateX(-100%)}.cbola-stories-facts-slideshow-item--next{transform:translateX(100%)}.cbola-stories-facts-slideshow-ad-item--next{transform:translateX(0)}.cbola-stories-facts-slideshow-item--cancel-next{transform:translateX(-15%)}.cbola-stories-facts-slideshow-ad-item--cancel-next{transform:translateX(-115%)}"}}(),function(){window["Cbola"]=window["Cbola"]||{},window["Cbola"]["Styles"]=window["Cbola"]["Styles"]||{},window["Cbola"]["Styles"]["Compiled"]=window["Cbola"]["Styles"]["Compiled"]||{},window["Cbola"]["Styles"]["Compiled"]["cbola_layer_138_theme.css"]=function(e){var t,i="";Array.prototype.join;return i+=".cbola-wid-"+(null==(t=e.wid)?"":t)+".cbola-elem-id-"+(null==(t=e.elementId)?"":t)+".cbola-layer.cbola-sidebar-container{-webkit-box-pack:",i+="left"===e.SidebarTopContainerTextAlign?" start ":"right"===e.SidebarTopContainerTextAlign?" end ":" center ",i+=";-webkit-justify-content:",i+="left"===e.SidebarTopContainerTextAlign?" flex-start ":"right"===e.SidebarTopContainerTextAlign?" flex-end ":" center ",i+=";-ms-flex-pack:",i+="left"===e.SidebarTopContainerTextAlign?" start ":"right"===e.SidebarTopContainerTextAlign?" end ":" center ",i+=";justify-content:",i+="left"===e.SidebarTopContainerTextAlign?" flex-start ":"right"===e.SidebarTopContainerTextAlign?" flex-end ":" center ",i+="}.cbola-wid-"+(null==(t=e.wid)?"":t)+".cbola-elem-id-"+(null==(t=e.elementId)?"":t)+".cbola-layer .cbola-sidebar-container__inner{margin-top:"+(null==(t=e.MarginTopCover)?"":t)+"px!important;margin-bottom:"+(null==(t=e.MarginBottomCover)?"":t)+"px!important;padding-bottom:"+(null==(t=e.PaddingBottomCover)?"":t)+"px!important;width:"+(null==(t=e.layerWidth)?"":t)+"px;background-color:"+(null==(t=e.StoriesSlideshowBackgroundColor)?"":t)+"}.cbola-wid-"+(null==(t=e.wid)?"":t)+".cbola-elem-id-"+(null==(t=e.elementId)?"":t)+".cbola-layer ."+(null==(t=e.layerSelectorPrefix)?"":t)+"{width:"+(null==(t=e.layerWidth)?"":t)+"px;height:"+(null==(t=e.layerHeight)?"":t)+"px}.cbola-wid-"+(null==(t=e.wid)?"":t)+".cbola-elem-id-"+(null==(t=e.elementId)?"":t)+".cbola-layer ."+(null==(t=e.layerSelectorPrefix)?"":t)+"--sharp ."+(null==(t=e.layerSelectorPrefix)?"":t)+"__btn,.cbola-wid-"+(null==(t=e.wid)?"":t)+".cbola-elem-id-"+(null==(t=e.elementId)?"":t)+".cbola-layer ."+(null==(t=e.layerSelectorPrefix)?"":t)+"--sharp-left ."+(null==(t=e.layerSelectorPrefix)?"":t)+"__btn,.cbola-wid-"+(null==(t=e.wid)?"":t)+".cbola-elem-id-"+(null==(t=e.elementId)?"":t)+".cbola-layer ."+(null==(t=e.layerSelectorPrefix)?"":t)+"__header{background-color:"+(null==(t=e.themeColor)?"":t)+"}"}}(),function(){window["Cbola"]=window["Cbola"]||{},window["Cbola"]["Templates"]=window["Cbola"]["Templates"]||{},window["Cbola"]["Templates"]["Compiled"]=window["Cbola"]["Templates"]["Compiled"]||{},window["Cbola"]["Templates"]["Compiled"]["stories_slideshow_facts_ad_item.html"]=function(e){var t,i="";Array.prototype.join;return i+='<div id="'+(null==(t=e.prefix)?"":t)+(null==(t=e.elemId)?"":t)+"-"+(null==(t=e.spot)?"":t)+'" class="'+(null==(t=e.prefix)?"":t)+'">\r\n  <div class="'+(null==(t=e.prefix)?"":t)+'__banner-wrapper">\r\n    <div class="cbola-banner-preload">\r\n      <div class="cbola-banner-preload-spinner">\r\n        <div class="cbola-banner-preload-spinner__path"></div>\r\n        <div class="cbola-banner-preload-spinner__path"></div>\r\n        <div class="cbola-banner-preload-spinner__path"></div>\r\n        <div class="cbola-banner-preload-spinner__path"></div>\r\n        <div class="cbola-banner-preload-spinner__path"></div>\r\n        <div class="cbola-banner-preload-spinner__path"></div>\r\n        <div class="cbola-banner-preload-spinner__path"></div>\r\n        <div class="cbola-banner-preload-spinner__path"></div>\r\n      </div>\r\n      <div class="cbola-banner-preload-sponsored-text">\r\n        sponsored\r\n      </div>\r\n    </div>\r\n    \r\n    <div class="cbola-banner-structure__advertisement-title ',e.showAdvertisementTitle||(i+="cbola-fade-out"),i+='">\r\n      '+(null==(t=e.advertisement)?"":t)+'\r\n    </div>\r\n    <div class="'+(null==(t=e.prefix)?"":t)+'__banner"></div>\r\n  </div>\r\n</div>\r\n\r\n'}}(),function(){window["Cbola"]=window["Cbola"]||{},window["Cbola"]["Templates"]=window["Cbola"]["Templates"]||{},window["Cbola"]["Templates"]["Compiled"]=window["Cbola"]["Templates"]["Compiled"]||{},window["Cbola"]["Templates"]["Compiled"]["stories_slideshow_facts_item.html"]=function(e){var t,i="";return i+='<div class="'+(null==(t=e.prefix)?"":t)+'-wrapper">\r\n  <div class="'+(null==(t=e.prefix)?"":t)+'">\r\n    <div class="'+(null==(t=e.prefix)?"":t)+'__image-wrapper">\r\n      <div class="cbola-loader"></div>\r\n      <img class="'+(null==(t=e.prefix)?"":t)+'__image cbola-hidden" draggable="false" rel="noshare" />\r\n    </div>\r\n    <div class="'+(null==(t=e.prefix)?"":t)+'__content-wrapper">\r\n      <div class="'+(null==(t=e.prefix)?"":t)+'__content"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n'}}(),function(){window["Cbola"]=window["Cbola"]||{},window["Cbola"]["Templates"]=window["Cbola"]["Templates"]||{},window["Cbola"]["Templates"]["Compiled"]=window["Cbola"]["Templates"]["Compiled"]||{},window["Cbola"]["Templates"]["Compiled"]["stories_slideshow_facts_view.html"]=function(e){var t,i="";return i+='<div class="'+(null==(t=e.prefix)?"":t)+' cbola-no-select">\r\n  <div class="'+(null==(t=e.prefix)?"":t)+'__header">\r\n    <div class="'+(null==(t=e.prefix)?"":t)+'__title"></div>\r\n    <div class="'+(null==(t=e.prefix)?"":t)+'__logo">\r\n      <div class="'+(null==(t=e.prefix)?"":t)+'__logo-carambola"></div>\r\n      <div class="'+(null==(t=e.prefix)?"":t)+'__logo-star"></div>\r\n    </div>\r\n  </div>\r\n  <div class="'+(null==(t=e.prefix)?"":t)+'__content-wrapper">\r\n    <!--STORIES_PLACEHOLDER-->\r\n    <div class="'+(null==(t=e.prefix)?"":t)+'__items-container"></div>\r\n  </div>\r\n  <div class="'+(null==(t=e.prefix)?"":t)+'__ads-container"></div>\r\n  <div class="'+(null==(t=e.prefix)?"":t)+'__btns-group">\r\n    <div class="'+(null==(t=e.prefix)?"":t)+"__btn "+(null==(t=e.prefix)?"":t)+'__btn--prev cbola-refresh-click-trigger">\r\n      <i class="cbola-icon cbola-icon-angle-left"></i>\r\n    </div>\r\n    <div class="'+(null==(t=e.prefix)?"":t)+"__btn "+(null==(t=e.prefix)?"":t)+'__btn--next cbola-refresh-click-trigger">\r\n      <i class="cbola-icon cbola-icon-angle-right"></i>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n'}}();var _get3=function e(t,i,o){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,i);if(void 0===n){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,i,o)}if("value"in n)return n.value;var a=n.get;return void 0===a?void 0:a.call(o)},_createClass2=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){window["Cbola"]=window["Cbola"]||{},window["Cbola"]["Styles"]=window["Cbola"]["Styles"]||{},window["Cbola"]["Styles"]["Compiled"]=window["Cbola"]["Styles"]["Compiled"]||{},window["Cbola"]["Styles"]["Compiled"]["stories_bar.css"]=function(e){var t="";return t+=".cbola-stories-nav-bar{width:100%;height:61px;position:relative;background-color:#fff;overflow:hidden}.cbola-story__ad,.cbola-story__image-wrapper{overflow:hidden;border-radius:50%;background-color:#ebebeb}.cbola-stories-nav-bar:after{content:' ';display:block;position:absolute;pointer-events:none}.cbola-stories-nav-bar--row:after{right:0;width:23px;height:100%;background-image:linear-gradient(to right,rgba(255,255,255,.4),rgba(255,255,255,.8))}.cbola-stories-nav-bar--column:after{bottom:0;width:100%;height:23px;background-image:linear-gradient(to bottom,rgba(255,255,255,.4),rgba(255,255,255,.8))}.cbola-stories-nav-bar__inner{position:absolute;top:0;left:0;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;transition:transform .5s ease-in}.cbola-stories-nav-bar--row .cbola-stories-nav-bar__inner{height:100%}.cbola-stories-nav-bar--column .cbola-stories-nav-bar__inner{width:100%;-ms-flex-direction:column;flex-direction:column}.cbola-story{position:relative;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:54px;height:54px;-ms-flex-negative:0;flex-shrink:0}.cbola-story:hover{cursor:pointer}.cbola-story__timer{position:absolute;top:0;left:0;width:100%;height:100%}.story-inserted{animation-duration:1ms;animation-name:storyInserted;visibility:hidden}@keyframes storyInserted{from{opacity:.99}to{opacity:1}}.cbola-story__image-wrapper{height:46px;width:46px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;position:relative}.cbola-story__image-inner{max-width:none;max-height:none}.cbola-story__image-inner--wide{width:auto;height:100%}.cbola-story__image-inner--narrow{width:100%;height:auto}.cbola-story__otd-year{color:#fff;text-shadow:0 3px 3px rgba(0,0,0,.29);position:absolute;top:50%;left:50%;transform:translate3d(-50%,-50%,20px)}.cbola-story__ad{height:46px;width:46px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;font-size:20px;color:#686868;font-family:Roboto}.cbola-stories-nav-bar--de .cbola-story__ad,.cbola-stories-nav-bar--es .cbola-story__ad,.cbola-stories-nav-bar--fr .cbola-story__ad,.cbola-stories-nav-bar--pt .cbola-story__ad{font-size:12px}.cbola-story--shrinked{width:0;height:0;margin:0!important}.cbola-story--shrinked .cbola-story__ad{font-size:0}"}}(),Cbola.Templates["stories_nav_bar_container.html"]='<div class="cbola-stories-nav-bar">\n  <div class="cbola-stories-nav-bar__inner"></div>\n</div>\n',function(){window["Cbola"]=window["Cbola"]||{},window["Cbola"]["Templates"]=window["Cbola"]["Templates"]||{},window["Cbola"]["Templates"]["Compiled"]=window["Cbola"]["Templates"]["Compiled"]||{},window["Cbola"]["Templates"]["Compiled"]["story_inner_ad.html"]=function(e){var t,i="";return i+='<div class="cbola-story__ad">\r\n  '+(null==(t=e.ad)?"":t)+"\r\n</div>\r\n"}}(),Cbola.Templates["story_inner_image.html"]='<div class="cbola-story__image-wrapper">\n  <div class="cbola-loader cbola-hide"></div>\n  <img src="" class="cbola-story__image-inner cbola-hide" />\n</div>\n',function(){window["Cbola"]=window["Cbola"]||{},window["Cbola"]["Templates"]=window["Cbola"]["Templates"]||{},window["Cbola"]["Templates"]["Compiled"]=window["Cbola"]["Templates"]["Compiled"]||{},window["Cbola"]["Templates"]["Compiled"]["story_inner_otd_year.html"]=function(e){var t,i="";return i+='<span class="cbola-story__otd-year">'+(null==(t=e.year)?"":t)+"</span>\r\n"}}(),Cbola.Templates["story_item_wrapper.html"]='<div class="cbola-story">\n  <canvas class="cbola-story__timer"></canvas>\n</div>\n';var _get=function e(t,i,o){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,i);if(void 0===n){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,i,o)}if("value"in n)return n.value;var a=n.get;return void 0===a?void 0:a.call(o)},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Components=Cbola.InContent.Components||{},Cbola.InContent.Components.StoryItemBase=Cbola.InContent.Components.StoryItemBase||function(){var e=window.requestAnimationFrame,t=Cbola._,i=Cbola.Templates,o=Cbola.Utils,n=Cbola.EventBus,s=n.Events,a=Cbola.Logger.getInstance(),r="StoryItemBase",l=Math.PI,d=[-.245,.25,.55,.745].map(function(e){return 2*e*l}),c=d.length,m=t.last(d)-t.first(d),h={CONTENT:10,AD:30},p=function(){function l(e,t,i){_classCallCheck(this,l),this.item=e,this.elemId=t,this.storyId=i,this.DOM={},this.state={isActive:!1,isDisplayed:!0,isWithRing:!1},this.startTime=0,this.afID=null}return _createClass(l,[{key:"bindElements",value:function(){var e=i.createElement("story_item_wrapper.html");this.DOM.story=e,this.DOM.canvas=e.querySelector(".cbola-story__timer"),this.DOM.ctx=this.DOM.canvas.getContext("2d")}},{key:"bindEventHandlers",value:function(){this.DOM.story.addEventListener("click",this.onClick.bind(this))}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rgb(62,209,217)",i=arguments[1];this.bindElements(),this.bindEventHandlers(),this.duration=i||(this.item.isAd()?h.AD:h.CONTENT),this.colorBreakes=o.generateGradientBreaksFromRGB(e,c-1),this.colorBreakes.push(t.first(this.colorBreakes))}},{key:"calcSizes",value:function(e,t){var i=this,o=e||this.DOM.story.getBoundingClientRect().width,n=o/2;this.DOM.canvas.height=this.DOM.canvas.width=o;var s=(t||this.getInnerElementRect().width)/2,a=n-s;this.radius=n-a/2,this.lineWidth=.7*a,this.center={x:n,y:n},this.DOM.ctx.lineCap="round";var r=Math.cos(d[c-1]-d[c-2])*n;return this.gradients=[[this.center.x,0,this.center.x,o],[this.center.x,o,this.center.x,n-r],[this.center.x,n-r,this.center.x,0]].map(function(e,t){var o,n=(o=i.DOM.ctx).createLinearGradient.apply(o,_toConsumableArray(e));return n.addColorStop(0,i.colorBreakes[t]),n.addColorStop(1,i.colorBreakes[t+1]),n}),this}},{key:"setSpacing",value:function(e,t){return this.DOM.story.style["margin"]=0,this.DOM.story.style["margin-"+e]=t+"px",this}},{key:"setPrev",value:function(){this.state.isWithRing||this.reset().drawFullRing()}},{key:"setActive",value:function(){this.reset(),this.state.isActive=!0,this.startTime=Date.now(),this.afID=e(this.animateRing.bind(this))}},{key:"setNext",value:function(){(this.startTime>0||this.state.isWithRing)&&this.reset()}},{key:"animateRing",value:function(){var t=Date.now();if(t-this.startTime>1e3*this.duration)return this.afID=e(this.drawFullRing.bind(this)),void n.fire(""+s.STORY_TIMER_ENDED+this.elemId,{storyId:this.storyId});if(this.clearCanvas(),this.startTime>0){var i=(t-this.startTime)*m/(1e3*this.duration)+d[0];this.drawRing(i),this.afID=e(this.animateRing.bind(this))}}},{key:"drawFullRing",value:function(){this.state.isWithRing=!0,this.drawRing(t.last(d))}},{key:"drawRing",value:function(e){var t=0,i=this.DOM.ctx,o=this.center,n=o.x,s=o.y;for(i.lineWidth=this.lineWidth;d[t]<e&&c-1>t;)i.strokeStyle=this.gradients[t],i.beginPath(),i.arc(n,s,this.radius,d[t],Math.min(d[t+1],e)),i.stroke(),t+=1;return this}},{key:"reset",value:function(){return cancelAnimationFrame(this.afID),this.state.isActive=!1,this.state.isWithRing=!1,this.startTime=0,this.clearCanvas(),this}},{key:"clearCanvas",value:function(){this.DOM.ctx&&this.DOM.ctx.clearRect(0,0,this.DOM.canvas.width,this.DOM.canvas.height)}},{key:"stopAnimating",value:function(){this.state.isActive=!1,cancelAnimationFrame(this.afID)}},{key:"onClick",value:function(){n.fire(""+s.STORY_CLICKED+this.elemId,{storyId:this.storyId})}},{key:"getDOMElement",value:function(){return this.DOM.story}},{key:"getID",value:function(){return this.storyId}},{key:"isDisplayed",value:function(){return this.state.isDisplayed}},{key:"isActive",value:function(){return this.state.isActive}},{key:"display",value:function(){a.warnM(r+".display",r+".display should be implemented by child object:",this)}},{key:"getInnerElementRect",value:function(){a.warnM(r+".getInnerElementRect",r+".getInnerElementRect should be implemented by child object:",this)}}]),l}();return p}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Components=Cbola.InContent.Components||{},Cbola.InContent.Components.StoryAdItem=Cbola.InContent.Components.StoryAdItem||function(){var e=Cbola.Utils,t=Cbola.Templates,i=Cbola.InContent.Components.StoryItemBase,o=Cbola.Common.UserService,n=function(i){function n(){var e;_classCallCheck(this,n);for(var t=arguments.length,i=Array(t),o=0;t>o;o++)i[o]=arguments[o];var s=_possibleConstructorReturn(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(i)));return s.state.isDisplayed=!1,s}return _inherits(n,i),_createClass(n,[{key:"init",value:function(){for(var e,t=arguments.length,i=Array(t),o=0;t>o;o++)i[o]=arguments[o];(e=_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"init",this)).call.apply(e,[this].concat(i)),this.duration=this.item.inItemDuration||this.duration}}]),_createClass(n,[{key:"bindElements",value:function(){_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"bindElements",this).call(this);var e=t.createElementFromTemplate("story_inner_ad.html",{ad:o.vocabulary("ad")});this.DOM.ad=e,this.DOM.story.appendChild(e),this.DOM.story.classList.add("cbola-story--shrinked")}},{key:"getInnerElementRect",value:function(){return this.DOM.ad.getBoundingClientRect()}},{key:"display",value:function t(){var i=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!0,t=function(){i.DOM.story.classList.remove("cbola-story--shrinked")};if(this.state.isDisplayed)return Promise.resolve();if(this.state.isDisplayed=!0,!o)return t(),Promise.resolve();var n=function(e){i.DOM.story.style["transition"]=e?"all 0.3s linear":"none",i.DOM.ad.style["trnasition"]=e?"all 0.3s linear":"none"};return e.withAnimationFramePromise(function(){n(!0)}).then(function(){return new Promise(function(e){var o=function t(){n(!1),i.DOM.story.removeEventListener("transitionend",t),e()};i.DOM.story.addEventListener("transitionend",o,!1),t()})})}}]),n}(i);return n}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Components=Cbola.InContent.Components||{},Cbola.InContent.Components.StoryContentItem=Cbola.InContent.Components.StoryContentItem||function(){var e=Cbola.InContent.Components.StoryItemBase,t=Cbola.Templates,i=function(e){function i(){var e;_classCallCheck(this,i);for(var t=arguments.length,o=Array(t),n=0;t>n;n++)o[n]=arguments[n];var s=_possibleConstructorReturn(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(o)));return s.state.imageLoaded=!1,s}return _inherits(i,e),_createClass(i,[{key:"bindElements",value:function(){_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"bindElements",this).call(this);var e=t.createElement("story_inner_image.html");this.DOM.imgWrapper=e,this.DOM.img=e.querySelector(".cbola-story__image-inner"),this.DOM.loader=e.querySelector(".cbola-loader"),this.DOM.story.appendChild(e)}},{key:"bindEventHandlers",value:function(){var e=this;_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"bindEventHandlers",this).call(this),this.DOM.img.addEventListener("load",function(t){var i=t.target,o=i.naturalWidth||i.width,n=i.naturalHeight||i.height;e.DOM.img.classList.add("cbola-story__image-inner--"+(o>=n?"wide":"narrow")),e.DOM.imgWrapper.removeChild(e.DOM.loader),e.DOM.img.classList.remove("cbola-hide"),e.state.imageLoaded=!0})}},{key:"getInnerElementRect",value:function(){return this.DOM.imgWrapper.getBoundingClientRect()}},{key:"display",value:function(){return Promise.resolve()}},{key:"displayImage",value:function(){this.state.imageLoaded||(this.DOM.loader.classList.remove("cbola-hide"),this.DOM.img.src=this.item.Image)}}]),i}(e);return i}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Components=Cbola.InContent.Components||{},Cbola.InContent.Components.StoryOTDItem=Cbola.InContent.Components.StoryOTDItem||function(){var e=Cbola.InContent.Components.StoryContentItem,t=Cbola.Templates;return function(e){function i(){return _classCallCheck(this,i),_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return _inherits(i,e),_createClass(i,[{key:"bindElements",value:function(){_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"bindElements",this).call(this);var e=t.createElementFromTemplate("story_inner_otd_year.html",{year:new Date(this.item.OnThisDayDate).getFullYear()});this.DOM.year=e,this.DOM.story.appendChild(e)}}]),i}(e)}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Components=Cbola.InContent.Components||{},Cbola.InContent.Components.StoriesNavBar=Cbola.InContent.Components.StoriesNavBar||function(){var e,t,i=Cbola._,o=Cbola.Utils,n=Cbola.EventBus,s=Cbola.Templates,a=Cbola.Styles,r=Cbola.Common.FontsManager,l=Cbola.Common.UserService,d=Cbola.InContent.Components.StoryAdItem,c=Cbola.InContent.Components.StoryContentItem,m=Cbola.InContent.Components.StoryOTDItem,h=Cbola.InContent.Layers.Item,p=Cbola.InContent.Layers.Base,u=n.Events,b={ROW:"row",COLUMN:"column"},f={};return f[b.ROW]=4.25,f[b.COLUMN]=2.25,t=e=function(){function e(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b.ROW;_classCallCheck(this,e),this.presenter=t,this.elementId=i,this.storiesMap={},this.DOM={},this.state={activeStoriesIndices:[],attached:!1,current:{index:0,story:null},enableUserInteraction:!0,isPaging:!1,lastLoadedItemImageIndex:0,sizes:{container:0,spacing:0,story:0,storyInner:0,visibleStoriesCount:0},stories:[],storiesInnerScrollOffset:0,storiesCounter:0,transitionEnabled:!0,visibleStories:[]},this.bindElements(),this.bindEventHandlers(),this.onOrientationChange(o)}return _createClass(e,[{key:"bindElements",value:function(){var e=s.createElement("stories_nav_bar_container.html");this.DOM.storiesBarContainer=e,this.DOM.storiesInnerScroll=e.querySelector(".cbola-stories-nav-bar__inner")}},{key:"bindEventHandlers",value:function(){n.addEventListener(""+u.STORY_CLICKED+this.elementId,this.storyClickedHandler.bind(this)),n.addEventListener(""+u.STORY_TIMER_ENDED+this.elementId,this.autoplayNextStoryHandler.bind(this))}},{key:"onOrientationChange",value:function(e){var t=!!this.state.orientation;t&&e===this.state.orientation||(t&&this.DOM.storiesBarContainer.classList.remove("cbola-stories-nav-bar--"+this.state.orientation),this.state.orientation=e,this.DOM.storiesBarContainer.classList.add("cbola-stories-nav-bar--"+this.state.orientation),this.state.attached&&this.setResponsiveSizes())}},{key:"setOptions",value:function(e){this.options=e}},{key:"applyViewOptions",value:function(){this.styleSheet||(r.getRoboto(),this.styleSheet=a.injectMainStyle(document,"stories_bar.css"),this.DOM.storiesBarContainer.classList.add("cbola-stories-nav-bar--"+l.getLanguage()))}},{key:"attach",value:function(t){return this.state.attached?!0:t?(o.replaceCommentWithElement("STORIES_PLACEHOLDER",t,this.DOM.storiesBarContainer),this.state.attached=this.setSizes(e.defaultSizes(this.presenter.type)),this.state.attached):!1}},{key:"attachResponsiveAsync",value:function(e){return this.state.attached?Promise.resolve():e?(o.replaceCommentWithElement("STORIES_PLACEHOLDER",e,this.DOM.storiesBarContainer),this.state.attached=!0,this.setResponsiveSizes()):Promise.reject(new Error("No container provided"));
}},{key:"setResponsiveSizes",value:function(){var e=this,t=this.getFirstStory();return t?o.isStyleAppliedAsync(t,this.DOM.storiesInnerScroll,o.noOp,"story-inserted").then(function(){var i=t.getBoundingClientRect().width,o=t.children[1].getBoundingClientRect().width,n=e.DOM.storiesBarContainer.getBoundingClientRect()[e.state.orientation===b.ROW?"width":"height"];return e.setSizes({storySize:i,storyInnerSize:o,containerSize:n})?Promise.resolve():Promise.reject(new Error("stories nav bar failed on setSizes -> story: "+i+", story inner: "+o+", container: "+n))}):Promise.reject(new Error("stories nav bar failed retrieving first story item"))}},{key:"setSizes",value:function(e){for(var t=e.storySize,o=e.storyInnerSize,n=e.containerSize,s=f[this.state.orientation];t*s>n&&s>0;)s-=1;if(1>=s)return!1;var a=Math.ceil((n-t*s)/Math.ceil(s)),r=this.state.sizes;r.story=t,r.storyInner=o,r.visibleStoriesCount=Math.floor(s),r.container=n,r.spacing=a;var l=this.state.orientation===b.ROW?"left":"top";return i.forEach(this.stories,function(e){e.calcSizes(t,o).setSpacing(l,a)}),this.setVisibleStories(),!0}},{key:"addStories",value:function(){for(var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=[],n=0,s=t.length,a=this.state,r=a.attached,l=a.current,p=a.sizes,u=a.visibleStories,f=a.orientation,y=function(){var s=t[n],a=s.isAd(),y=a?"ad_"+s.adSpot:"item_"+s.Id,v=e.storiesMap[y];if(!v){var g=void 0;switch(s.getType()){case h.Types.FACT:case h.Types.TIP:g=c;break;case h.Types.ON_THIS_DAY:g=m;break;case h.Types.AD:g=d}e.storiesMap[y]=v=new g(s,e.elementId,e.generateId()),v.init(e.options.themeColor,a?null:e.options.SlideshowAutoplayDuration),a&&l.index>=n&&(l.index+=1);var w=v.getDOMElement();r&&o.isElementAttachedAsync(w,e.DOM.storiesInnerScroll,o.noOp).then(function(){v.calcSizes(p.story,p.storyInner).setSpacing(f===b.ROW?"left":"top",p.spacing)}),a&&e.stories[n]?e.stories[n].getDOMElement().insertAdjacentElement("beforebegin",w):(e.DOM.storiesInnerScroll.appendChild(w),u.length<p.visibleStoriesCount&&u.push(v))}i[n]=v,v.idx=n,n+=1};s>n&&t[n];)y();l.story=i[l.index],this.stories=i}},{key:"storyClickedHandler",value:function(e){var t=this,o=e.detail.storyId,n=this.state.current,s=i.findIndex(this.stories,function(e){return e.getID()===o});n.index!==s&&(n.story.stopAnimating(),this.toggleUserInteraction(!1),this.presenter.toggleUserInteraction(!1),n.storyTransitionPromise=this.goToStory(s).then(this.presenter.goToItem.bind(this.presenter)).then(function(){t.toggleUserInteraction(!0),t.presenter.toggleUserInteraction(!0),delete n.storyTransitionPromise,t.continueAutoplayIfNeeded()}).catch(function(){delete n.storyTransitionPromise}))}},{key:"autoplayNextStoryHandler",value:function(e){var t=this,o=e.detail.storyId,n=this.state,s=n.visibleStories,a=n.current,r=i.findIndex(s,function(e){return e.getID()===o});if(-1!==r){this.toggleUserInteraction(!1),this.presenter.toggleUserInteraction(!1);var l=r>=s.length-1,d=s[l?0:r+1].idx;a.storyTransitionPromise=this.goToStory(d).then(function(e){return t.presenter.goToItem(e,!0,l)}).then(function(){t.toggleUserInteraction(!0),t.presenter.toggleUserInteraction(!0),delete a.storyTransitionPromise,t.continueAutoplayIfNeeded()}).catch(function(){delete a.storyTransitionPromise})}}},{key:"goToStory",value:function(e){var t=this,o=this.state.current,n=this.stories[e];n instanceof c&&e>0&&e>o.index&&this.stories[e-1]instanceof d&&!this.stories[e-1].isDisplayed()&&(e-=1,n=this.stories[e]),o.index=e,o.story=n;var s=this.state.visibleStories;return this.displayStoryIfNeeded().then(function(){return i.forEach(s,function(e){var t=e.idx;t<o.index?e.setPrev():t>o.index&&e.setNext()}),s.some(function(e){return e.idx===o.index})?Promise.resolve(e):t.pageToStory(o.index)})}},{key:"displayStoryIfNeeded",value:function(){var e=this.state,t=e.current,i=e.visibleStories;return t.story.isDisplayed()?Promise.resolve():(this.adjustVisibleStoriesOnExposure(),Promise.all([t.story.display(this.state.transitionEnabled),this.pageToStory(i[0].idx)]))}},{key:"adjustVisibleStoriesOnExposure",value:function(){var e=this.state,t=e.current,o=e.sizes,n=e.visibleStories,s=i.findIndex(n,function(e){return e.idx===t.index+1});if(-1!==s&&(n.splice(s,0,t.story),n.length>o.visibleStoriesCount)){var a=0===s,r=n[a?"pop":"shift"]();r["set"+(a?"Next":"Prev")]()}}},{key:"pageToStory",value:function(e){var t=this;return new Promise(function(o){var n=function i(){t.DOM.storiesInnerScroll.removeEventListener("transitionend",i),o(e)};t.setVisibleStories(e);var s=t.getStoryOffset(i.first(t.state.visibleStories).idx);return s===t.state.storiesInnerScrollOffset?o(e):(t.state.transitionEnabled?t.DOM.storiesInnerScroll.addEventListener("transitionend",n,!1):o(e),void t.setInnerScrollOffset(s))})}},{key:"setVisibleStories",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.current.index,t=this.state.sizes.visibleStoriesCount,i=[],o=e;o<this.stories.length&&t>0;o++)this.stories[o].isDisplayed()&&(i.push(this.stories[o]),t-=1);for(var n=e-1;n>0&&t>0;n--)this.stories[n].isDisplayed()&&(i.unshift(this.stories[n]),t-=1);this.state.visibleStories=i,this.lazyLoadImages()}},{key:"lazyLoadImages",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=this.state.visibleStories;i.forEach(t,function(e){return i.result(e,"displayImage")});for(var o=i.last(t).idx,n=Math.min(this.stories.length,o+e),s=o+1;n>s;s++)i.result(this.stories[s],"displayImage")}},{key:"getStoryOffset",value:function(e){for(var t=0,i=this.state.sizes,o=i.story,n=i.spacing,s=o+n,a=0;e>a;a++)this.stories[a].isDisplayed()&&(t+=s);return t}},{key:"setInnerScrollOffset",value:function(e){this.state.storiesInnerScrollOffset=e;var t="translate"+(this.state.orientation===b.ROW?"X":"Y")+"("+-1*e+"px)";o.transform(this.DOM.storiesInnerScroll,t)}},{key:"generateId",value:function(){return this.state.storiesCounter+=1,this.state.storiesCounter}},{key:"continueAutoplayIfNeeded",value:function(){var e=this.state.current,t=e.storyTransitionPromise,i=e.story;t||i.isActive()||i.setActive()}},{key:"stopAutoplayIfNeeded",value:function(){var e=this.state.current;if(e.storyTransitionPromise){var t=e.storyTransitionPromise;t.then(function(){e.story.stopAnimating()})}else e.story.stopAnimating()}},{key:"toggleUserInteraction",value:function(e){this.state.enableUserInteraction=e}},{key:"toggleAllTransitions",value:function(e){var t=this;return o.withAnimationFramePromise(function(){t.state.transitionEnabled=e,t.DOM.storiesBarContainer.classList[e?"remove":"add"]("cbola-disable-transition")})}},{key:"getFirstStory",value:function(){return this.DOM.storiesInnerScroll.children[0]}}]),e}(),e.Orientations=b,e.VisibleItems=f,e.defaultSizes=function(e){return p.prototype.isStoriesSlideshow.call({type:e})?{containerSize:298,storySize:54,storyInnerSize:46}:void 0},t}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.StoriesSlideshowItemViewBase=Cbola.InContent.Layers.StoriesSlideshowItemViewBase||function(){var e=Cbola._,t=Cbola.Utils,i=Cbola.Logger.getInstance(),o="StoriesSlideshowItemViewBase",n={PREV:"prev",ACTIVE:"active",NEXT:"next"};return function(){function s(t,i,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;_classCallCheck2(this,s),this.presenter=t,this.templateName=i,this.selectorPrefix=o,this.viewPagingTypes=e.clone(a),this.DOM={},this.state={attached:!1,active:!1}}return _createClass2(s,[{key:"init",value:function(){this.bindElements(),this.bindEventListeners()}},{key:"bindElements",value:function(){i.warnM(o+".bindElements",o+".bindElements should be overriden by child object")}},{key:"bindEventListeners",value:function(){var t=this;this.DOM.element.addEventListener("transitionend",function(){e.isFunction(t.transitionEndResolver)&&(t.transitionEndResolver(),delete t.transitionEndPromise,delete t.transitionEndResolver)})}},{key:"attach",value:function(e){this.state.attached||(this.state.attached=!0,this.DOM.container=e,e.appendChild(this.DOM.element))}},{key:"detach",value:function(){this.state.attached&&(this.state.attached=!1,this.DOM.container.removeChild(this.DOM.element),delete this.DOM.container)}},{key:"toggleTransition",value:function(e){var i=this;return t.withAnimationFramePromise(function(){i.DOM.element.classList[e?"remove":"add"]("cbola-disable-transition"),e?i.setTransitionEndPromise():(delete i.transitionEndPromise,delete i.transitionEndResolver)})}},{key:"pageItem",value:function(i){var o=this;return t.withAnimationFramePromise(function(){o.state.active=i===o.viewPagingTypes.ACTIVE,e.forEach(o.viewPagingTypes,function(e){var t=i===e?"add":"remove";o.DOM.element.classList[t](o.selectorPrefix+"--"+e)})})}},{key:"cancelAnimation",value:function(t){var i=this,o=e.find(this.viewPagingTypes,function(e){return i.DOM.element.classList.contains(i.selectorPrefix+"--"+e)});return this.setTransitionEndPromise(),this.toggleCancelAnimation(!0,t,o),this.transitionEnded().then(function(){return i.setTransitionEndPromise(),i.toggleCancelAnimation(!1,t,o),i.transitionEnded()})}},{key:"toggleCancelAnimation",value:function(e,t,i){var o=this.DOM.element.classList;o[e?"remove":"add"](this.selectorPrefix+"--"+i),o[e?"add":"remove"](this.selectorPrefix+"--cancel-"+t)}},{key:"transitionEnded",value:function(){return this.transitionEndPromise}},{key:"setTransitionEndPromise",value:function(){var e=this;this.transitionEndPromise=new Promise(function(t){e.transitionEndResolver=t})}},{key:"getItemId",value:function(){return e.get(this,"item.Id",-1)}},{key:"isActive",value:function(){return this.state.active}}]),s}()}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.StoriesSlideShowAdItemView=Cbola.InContent.Layers.StoriesSlideShowAdItemView||function(){var e=Cbola.Templates,t=Cbola.Common.UserService,i=Cbola.InContent.Layers.StoriesSlideshowItemViewBase;return function(i){function o(){return _classCallCheck2(this,o),_possibleConstructorReturn2(this,(o.__proto__||Object.getPrototypeOf(o)).apply(this,arguments))}return _inherits2(o,i),_createClass2(o,[{key:"init",value:function(e,t){this.item=e,this.options=t,_get3(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"init",this).call(this)}},{key:"bindElements",value:function(){var i=e.createElementFromTemplate(this.templateName,{prefix:this.selectorPrefix,elemId:this.options.elementId,spot:this.item.adSpot,showAdvertisementTitle:this.options.ShowAdvertisementTitleOnAds,advertisement:t.vocabulary("advertisement")});this.DOM.element=i,this.DOM.banner=i.querySelector("."+this.selectorPrefix+"__banner")}},{key:"getBannerElement",value:function(){return this.DOM.banner}}]),o}(i)}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.StoriesSlideshowContentItemView=Cbola.InContent.Layers.StoriesSlideshowContentItemView||function(){var e=Cbola._,t=Cbola.Templates,i=Cbola.InContent.Layers.StoriesSlideshowItemViewBase;return function(i){function o(){var e;_classCallCheck2(this,o);for(var t=arguments.length,i=Array(t),n=0;t>n;n++)i[n]=arguments[n];var s=_possibleConstructorReturn2(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(i)));return s.state.itemAssigend=!1,s}return _inherits2(o,i),_createClass2(o,[{key:"bindElements",value:function(){var e=t.createElementFromTemplate(this.templateName,{prefix:this.selectorPrefix});this.DOM.element=e,this.DOM.loader=e.querySelector(".cbola-loader"),this.DOM.image=e.querySelector("."+this.selectorPrefix+"__image"),this.DOM.content=e.querySelector("."+this.selectorPrefix+"__content")}},{key:"bindEventListeners",value:function(){var e=this;this.DOM.element.addEventListener("click",this.presenter.onItemClicked.bind(this.presenter)),this.DOM.image.addEventListener("load",function(){e.DOM.image.classList.remove("cbola-hidden"),e.DOM.loader.classList.add("cbola-hidden")}),_get3(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"bindEventListeners",this).call(this)}},{key:"setItem",value:function(t){e.get(this,"item.Id",-1)!==t.Id&&(this.item=t,this.state.itemAssigend=!0,this.DOM.loader.classList.remove("cbola-hidden"),this.DOM.image.classList.add("cbola-hidden"),this.DOM.content.textContent=t.Description,this.DOM.image.src=t.Image,this.DOM.element.style["cursor"]=t.Link?"pointer":"default")}},{key:"isAssignedWithItem",value:function(){return this.state.itemAssigend}}]),o}(i)}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.StoriesSlideshowView=Cbola.InContent.Layers.StoriesSlideshowView||function(){var e=Cbola._,t=Cbola.Templates,i=Cbola.Styles,o=Cbola.EventBus,n=Cbola.Utils,s=Cbola.Common.FontsManager,a=Cbola.InContent.Layers.StoriesSlideShowAdItemView,r=Cbola.InContent.Layers.Options.StoriesSlideshow.StyleGuides,l={PREV:"prev",ACTIVE:"active",NEXT:"next"};return function(){function d(e,t,i,o,n){_classCallCheck2(this,d);var s=function(i){var s=new n(e,t+"_item.html",o+"-item");return s.init(),s.pageItem(i),s};this.presenter=e,this.templateNamePrefix=t,this.styleSheetName=i+".css",this.styleThemeFileName=i+"_theme.css",this.selectorPrefix=o,this.DOM={},this.stylesheets=[],this.adSpotViews={},this.itemViews=[],this.state={attached:!1,views:{},transitionEnabled:!0},this.state.views[l.PREV]=null,this.state.views[l.ACTIVE]=this.itemViews[0]=s(l.ACTIVE),this.state.views[l.NEXT]=this.itemViews[1]=s(l.NEXT),this.boundedOnMouseEnter=function(){this.DOM.container&&this.DOM.container.removeEventListener("mouseenter",this.boundedOnMouseEnter),this.presenter.onMouseEnter()}.bind(this)}return _createClass2(d,[{key:"init",value:function(){this.bindElements(),this.bindEventHandlers()}},{key:"bindElements",value:function(){var i=this,o=this.selectorPrefix,n=t.createElementFromTemplate(this.templateNamePrefix+"_view.html",{prefix:o});this.boxElem=this.DOM.element=n,this.DOM.title=n.querySelector("."+o+"__title"),this.DOM.logo=n.querySelector("."+o+"__logo"),this.DOM.buttonsGroup=n.querySelector("."+o+"__btns-group"),this.DOM.itemsContainer=n.querySelector("."+o+"__items-container"),this.DOM.adsContainer=n.querySelector("."+o+"__ads-container"),e.forEach(this.itemViews,function(e){e.attach(i.DOM.itemsContainer)})}},{key:"bindEventHandlers",value:function(){var e=this;this.DOM.buttonsGroup.addEventListener("click",function(t){for(var i=t.target,o=e.selectorPrefix;i&&!i.classList.contains(o+"__btns-group");){if(i.classList.contains(o+"__btn--prev"))return e.presenter.onPrev();if(i.classList.contains(o+"__btn--next"))return e.presenter.onNext();i=i.parentElement}}),this.DOM.logo.addEventListener("click",this.presenter.onLogoClicked.bind(this.presenter))}},{key:"setOptions",value:function(e){e.layerSelectorPrefix=this.selectorPrefix,this.options=e}},{key:"attach",value:function(e){var t=this.DOM;return e||t.container?(this.state.attached||(this.setContainer(e),this.state.attached=!0,this.applyViewOptions(),t.container.appendChild(t.element),o.fire(""+o.Events.LAYER_ATTACHED+this.options.elementId)),!0):!1}},{key:"detach",value:function(){this.state.attached&&this.DOM.container&&(this.state.attached=!1,[this.DOM.container].concat(_toConsumableArray2(this.stylesheets)).forEach(n.remove),delete this.DOM.container,this.stylesheets=[])}},{key:"isAttached",value:function(){return this.state.attached}},{key:"applyViewOptions",value:function(){if(e.isEmpty(this.stylesheets)){s.getRoboto(),s.getHeebo(),this.stylesheets.push(i.injectMainStyle(document,this.styleSheetName),i.injectThemeStyle(document,this.styleThemeFileName,this.options));var t="";switch(this.options.StoriesSlideshowStyleGuide){case r.SHARP:t="sharp";break;case r.SHARP_LEFT:t="sharp-left";break;case r.ROUND:t="round"}this.DOM.element.classList.add(this.selectorPrefix+"--"+t)}}},{key:"setContainer",value:function(e){e&&e!==this.DOM.container&&!this.state.attached&&(this.DOM.container=e,this.DOM.container.addEventListener("mouseenter",this.boundedOnMouseEnter))}},{key:"setTitle",value:function(e){this.DOM.title.textContent=e}},{key:"setPrevItem",value:function(e){this.setItemToView(e,l.PREV)}},{key:"setCurrentItem",value:function(e){this.setItemToView(e,l.ACTIVE)}},{key:"setNextItem",value:function(e){this.setItemToView(e,l.NEXT)}},{key:"setItemToView",value:function(t,i){var o=null;if(e.result(t,"isAd",!1))o=this.adSpotViews[t.adSpot];else if(t){var n=t.Id;o=e.find(this.itemViews,function(e){return e.getItemId()===n}),o||(o=e.find(this.itemViews,function(e){return e.isActive()&&!e.isAssignedWithItem()})),o||(o=e.find(this.itemViews,function(e){return!e.isActive()})),o.setItem(t)}this.state.views[i]=o}},{key:"playPagingAnimation",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this.state.views[l.ACTIVE],o=void 0,n=void 0,s=void 0;if(1===t&&this.state.views[l.NEXT])o=this.state.views[l.NEXT],n=l.PREV,s=l.NEXT;else{if(-1!==t||!this.state.views[l.PREV])return 0!==t?this.playCancelAnimation(t):Promise.resolve();o=this.state.views[l.PREV],n=l.NEXT,s=l.PREV}return Promise.all([i.toggleTransition(!1),o.toggleTransition(!1)]).then(function(){return Promise.all([i.pageItem(l.ACTIVE),o.pageItem(s)])}).then(function(){return Promise.all([i.toggleTransition(e.state.transitionEnabled),o.toggleTransition(e.state.transitionEnabled)])}).then(function(){return Promise.all([i.pageItem(n),o.pageItem(l.ACTIVE)])}).then(function(){return e.state.transitionEnabled?Promise.all([i.transitionEnded(),o.transitionEnded()]):Promise.all([i.toggleTransition(!0),o.toggleTransition(!0)])}).then(function(){e.state.views[l.ACTIVE]=o,e.state.views[n]=i,delete e.state.views[s]})}},{key:"playCancelAnimation",value:function(e){return this.state.views[l.ACTIVE].cancelAnimation(1===e?l.NEXT:l.PREV)}},{key:"createAdItemView",value:function(t){var i=t.adSpot;if(e.isNil(this.adSpotViews[i])){var o=new a(this.presenter,this.templateNamePrefix+"_ad_item.html",this.selectorPrefix+"-ad-item");o.init(t,this.options),o.pageItem(l.NEXT),o.attach(this.DOM.adsContainer),this.adSpotViews[i]=o}return this.adSpotViews[i].getBannerElement()}},{key:"getStoriesNavBarContainer",value:function(){return this.DOM.element.querySelector("."+this.selectorPrefix+"__content-wrapper")}},{key:"toggleAllTransitions",value:function(e){var t=this;return n.withAnimationFramePromise(function(){t.state.transitionEnabled=e,t.DOM.element.classList[e?"remove":"add"]("cbola-disable-transition")})}}]),d}()}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.AnalyticsHelper=Cbola.InContent.Layers.AnalyticsHelper||function(){var e=Cbola.Enums.ItemViewTypes,t=Cbola.Common.AnalyticsService,i=function(e){this.itemsToReport=[],this.itemsViewOrder=0,this.layer=e};return i.prototype.setItemsViewability=function(t,i,o,n){var s=n?n:i?o:e.NONE,a=n?e.NONE:i?e.NONE:o;return t&&(t.setViewable(i),t.isViewable&&!n&&(o===e.ON_HOVER?t.setViewOrder(this.itemsViewOrder):t.setViewOrder(++this.itemsViewOrder)),t.setOpenType(s),t.setCloseType(a),t.setDisplayOrder(t.idx+1),this.itemsToReport.push(t)),this},i.prototype.reportAndClearItems=function(){return t.setItemsView(this.layer.elementId,this.itemsToReport),this.itemsToReport=[],this},i}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.StoriesSlideshowBase=Cbola.InContent.Layers.StoriesSlideshowBase||function(){var e=Cbola._,t=Cbola.EventBus,i=Cbola.Utils,o=Cbola.Common.AnalyticsService,n=Cbola.Common.UserService,s=Cbola.Enums,a=Cbola.InContent.Layers.Base,r=Cbola.InContent.Layers.Item,l=s.ItemViewTypes,d=s.SetClickTypes,c=t.Events,m=Cbola.Logger.getInstance(),h="StoriesSlideshowBase",p=function(e,t,i,o){if(e)return l.AUTOPLAY_CAROUSEL_COMPLETED;var n="";return o.isAd()?n="AD"+(t?"_AUTOPLAY":""):1===i?n="ON_NEXT_"+(t?"AUTOPLAY":"BTN"):-1===i&&(n="ON_PREV_BTN"),l[n]},u=function(s){function a(){_classCallCheck2(this,a);var e=_possibleConstructorReturn2(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return e.items=[],e.adSpotNumbers=[],e.lastInsertedItemIndex=0,e.state={current:{index:0,item:null},enableUserInteraction:!0,hasCarouselCompleted:!1},e}return _inherits2(a,s),_createClass2(a,[{key:"setOptions",value:function(e){_get3(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"setOptions",this).call(this,e),e.wid=this.widgetId,e.elementId=this.elementId,this.view.setOptions(e),this.storiesView.setOptions(e)}},{key:"init",value:function(){_get3(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"init",this).call(this),this.view.setContainer(this.container),this.view.init()}},{key:"onBeforeLoad",value:function(){this.view.applyViewOptions(),this.storiesView.applyViewOptions(),this.view.setTitle(e.get(this,"data.WidgetTitle","Did You Know?"))}},{key:"onLoad",value:function(){var i=this;this.itemsService.getMoreItems(this.elementId,this.widgetId,function(o){return e.isEmpty(o)?void m.errorM(h+".onLoad",h+".onLoad failed, getMoreItems returned empty"):(i.addItems({newItems:o}),i.view.attach()?i.storiesView.attach(i.view.getStoriesNavBarContainer())?(i.state.current.item=i.items[0],i.updateViewItems(0),i.view.playPagingAnimation(),void t.fire(c.LAYER_READY,i)):void m.errorM(h+".onLoad",h+".onLoad failed, stories attachment failure."):void m.errorM(h+".onLoad",h+".onLoad failed, view attachment failure."))},6)}},{key:"addItems",value:function(t){var o=t.newItems,n=void 0===o?[]:o,s=t.newAdItem;m.debug(h+"::addItems(): newItems "+n+", newAdItem: "+s);var a=[],r=[];if(this.items.forEach(function(t){var i=e.result(t,"isAd",!1)?a:r;i.push(t)}),e.isEmpty(n)||i.push.apply(r,n),!e.isNil(s)){var l=s.adSpot,d=e.findIndex(this.adSpotNumbers,function(e){return e>=l}),c=-1;this.adSpotNumbers[d]===l?m.warnM(h+".addItems",h+".addItems failed injecting ad spot due to spot collision, spot: "+l+"."):(c=-1===d?this.adSpotNumbers.length:Math.max(0,d-1),a.splice(c,0,s),this.adSpotNumbers.splice(c,0,l),this.state.current.index>=l+c&&(this.state.current.index+=1))}for(var p=a.reduce(function(e,t,i){var o=t.adSpot+i;return t.idx=o,e[o]=t,e},[]),u=0,b=0;u<r.length;u++){for(;!e.isEmpty(p[b]);)b+=1;r[u].idx=b,p[b]=r[u],this.lastInsertedItemIndex=b,b+=1}this.items=p,this.storiesView.addStories(this.items)}},{key:"onBecameViewable",value:function(e){_get3(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"onBecameViewable",this).call(this),this.analyticsHelper.setItemsViewability(this.state.current.item,!0,void 0,e).reportAndClearItems(),this.continueAutoplayIfNeeded()}},{key:"onBecameUnviewable",value:function(){_get3(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"onBecameUnviewable",this).call(this),this.analyticsHelper.setItemsViewability(this.state.current.item,!0,void 0,l.UNVIEWABILITY).reportAndClearItems(),this.stopAutoplayIfNeeded()}},{key:"onNext",value:function(){var t=this;if(this.state.enableUserInteraction){this.toggleUserInteraction(!1),this.storiesView.toggleUserInteraction(!1);var o=this.state.current.index+1;e.has(this.items,"["+o+"]",!1)?this.goToItem(o).then(this.storiesView.goToStory.bind(this.storiesView)).then(function(){t.continueAutoplayIfNeeded(),t.toggleUserInteraction(!0),t.storiesView.toggleUserInteraction(!0)}).catch(i.noOp):this.view.playCancelAnimation(o-this.state.current.index).then(function(){t.toggleUserInteraction(!0),t.storiesView.toggleUserInteraction(!0)}).catch(i.noOp)}}},{key:"onPrev",value:function(){var e=this;if(this.state.enableUserInteraction){this.toggleUserInteraction(!1),this.storiesView.toggleUserInteraction(!1);var t=this.state.current.index-1;t>=0?this.goToItem(t).then(this.storiesView.goToStory.bind(this.storiesView)).then(function(){e.continueAutoplayIfNeeded(),e.toggleUserInteraction(!0),e.storiesView.toggleUserInteraction(!0)}).catch(i.noOp):this.view.playCancelAnimation(t-this.state.current.index).then(function(){e.toggleUserInteraction(!0),e.storiesView.toggleUserInteraction(!0)}).catch(i.noOp)}}},{key:"goToItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1,o=this.state,s=o.current,a=!t||!o.hasCarouselCompleted;o.hasCarouselCompleted=o.hasCarouselCompleted||i;var r=e-s.index,l=0!==r?r/Math.abs(r):0;if(t||1!==l||n.addItemsToHistory([s.item.Id]),this.updateViewItems(e,l),l){var d=this.items[e];if(a){var c=p(i,t,l,s.item),m=p(i,t,l,d);this.analyticsHelper.setItemsViewability(s.item,!1,c).setItemsViewability(d,!0,m).reportAndClearItems()}s.index=e,s.item=this.items[e],t||this.fetchMoreItemsIfNeeded()}return this.view.playPagingAnimation(l).then(function(){return Promise.resolve(s.index)})}},{key:"updateViewItems",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.items[e];this.view.setPrevItem(-1===t?i:null),this.view.setCurrentItem(this.state.current.item),this.view.setNextItem(1===t?i:null)}},{key:"fetchMoreItemsIfNeeded",value:function(){var e=this;this.areMoreItemsNeeded()&&this.itemsService.getMoreItems(this.elementId,this.widgetId,function(t){return e.addItems({newItems:t})})}},{key:"areMoreItemsNeeded",value:function(){return this.state.current.index+2>=this.lastInsertedItemIndex}},{key:"onMouseEnter",value:function(){m.debug(h+"::onMouseEnter -> sending analytics once"),o.setPageElementView(this.elementId,l.ON_HOVER,l.NONE)}},{key:"onItemClicked",value:function(){this.state.enableUserInteraction&&(this.state.current.item.Link?(window.open(this.state.current.item.Link),o.setClick(this.elementId,d.ITEM_LINK,this.state.current.item)):this.onNext())}},{key:"onLogoClicked",value:function(){o.setClick(this.elementId,d.CARAMBOLA_ICON),window.open(Cbola.Config.brandRedirectTemplate({layerType:this.type}))}},{key:"stopAutoplayIfNeeded",value:function(){this.storiesView.stopAutoplayIfNeeded()}},{key:"continueAutoplayIfNeeded",value:function(){this.storiesView.continueAutoplayIfNeeded()}},{key:"injectAdAfterItem",value:function(e){var t=this,i=e.adSpot,o=e.inItemDuration;if(!this.adSpotNumbers.some(function(e){return e===i})){var n=new r({type:r.Types.AD,adSpot:i,inItemDuration:o}),s=this.view.createAdItemView(n);return this.addItems({newAdItem:n}),0===i&&1===this.state.current.index&&(this.toggleUserInteraction(!1),this.storiesView.toggleUserInteraction(!1),Promise.all([this.view.toggleAllTransitions(!1),this.storiesView.toggleAllTransitions(!1)]).then(function(){return t.updateViewItems(0,-1),t.state.current.index=0,t.state.current.item=t.items[0],t.view.playPagingAnimation(-1)}).then(function(){return t.storiesView.goToStory(0)}).then(function(){return t.toggleUserInteraction(!0),t.storiesView.toggleUserInteraction(!0),t.isViewable()&&t.continueAutoplayIfNeeded(),Promise.all([t.view.toggleAllTransitions(!0),t.storiesView.toggleAllTransitions(!0)])})),s}}},{key:"toggleUserInteraction",value:function(e){this.state.enableUserInteraction=e}}]),a}(a);return u}(),Cbola.InContent=Cbola.InContent||{},Cbola.InContent.Layers=Cbola.InContent.Layers||{},Cbola.InContent.Layers.StoriesSlideshowFacts=Cbola.InContent.Layers.StoriesSlideshowFacts||function(){var e=Cbola.InContent.Layers.StoriesSlideshowBase,t=Cbola.InContent.Layers.StoriesSlideshowView,i=Cbola.InContent.Layers.StoriesSlideshowContentItemView,o=Cbola.InContent.Layers.AnalyticsHelper,n=Cbola.InContent.Components.StoriesNavBar;return function(e){function s(){_classCallCheck2(this,s);var e=_possibleConstructorReturn2(this,(s.__proto__||Object.getPrototypeOf(s)).call(this));return e.view=new t(e,"stories_slideshow_facts","cbola_layer_138","cbola-stories-facts-slideshow",i),e.storiesView=new n(e,e.elementId),e.itemsService=Cbola.InContent.Layers.Services.FactsService,e.analyticsHelper=new o(e),e}return _inherits2(s,e),s}(e)}();