(self.webpackChunkweb_shell=self.webpackChunkweb_shell||[]).push([[5534],{8317:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(5827),i=n(4829);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const a=i.Z.getEnvironment(),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._customizationClass=t||null,this.config=null,this._initialized=!1}var t,n;return t=e,(n=[{key:"_initialize",value:function(){return this._getConfigFromCustomization().then((e=>!0===this._initialized?Promise.resolve():(this.config=e,this.initializeProvider().then((()=>{this._initialized=!0})))))}},{key:"initializeProvider",value:function(){}},{key:"sendEvent",value:function(){}},{key:"_invokeCustomizationCallbackAsync",value:function(e){return Promise.resolve().then((()=>e()))}},{key:"_getPropsByCallType",value:function(e,t){if(t){const{pageProperties:n,eventProperties:r,userTraits:i,groupTraits:o}=t,a=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(t,["pageProperties","eventProperties","userTraits","groupTraits"]);return n&&"page"===e?n:i&&"identify"===e?i:o&&"group"===e?o:Object.keys(a).length>0?a:r}return{}}},{key:"handleEvent",value:function(e,t){const n=i.Z.getCompleteEventContext(t);return this._initialize().then((()=>{let t=this._getAppProps();const o=JSON.parse(JSON.stringify({context:n,appProps:t})),a=this.validateEvent(e,o);if(a.valid){const a=this.onBeforeSendEvent(e,o),s=e.type||"track";try{i.Z.isExperimentApplicable("enable-enhanced-analytics-customization")&&(t=this._getPropsByCallType(s,t));const r={event:a,eventName:e.eventName,context:n,appProps:t};this.sendEvent(r)}catch(e){r.Z.error("Unable to send analytics event: ".concat(e.message),{},e)}}else r.Z.error("Event cannot be validated, data not sent to analytics: ".concat(a.message))})).catch((e=>{r.Z.error("Error initializing provider",{},e)}))}},{key:"validateEvent",value:function(e,t){let n;const r=this._analyticsCustomization;if(!r||"function"!=typeof r.validateEvent)return{valid:!0,message:""};try{n=r.validateEvent(e,t)}catch(e){throw new Error("Error occurred trying to execute analytics customization validateEvent method: ".concat(e.message))}return n}},{key:"onBeforeSendEvent",value:function(e,t){let n=e;const r=this._analyticsCustomization;if(!r||"function"!=typeof r.onBeforeSendEvent)return n;try{n=r.onBeforeSendEvent(e,t)}catch(e){throw new Error("Error occurred trying to execute analytics customization onBeforeSendEvent method: ".concat(e.message))}return n}},{key:"_getConfigFromAppExperience",value:function(){const e=i.Z.getAppExperienceData("analyticsV2");return e&&e[this.provider]||null}},{key:"_getConfigFromCustomization",value:function(){if(this._analyticsCustomization&&this.config)return Promise.resolve(this.config);if(!this._customizationClass)return Promise.resolve(this._getConfigFromAppExperience());const e={env:a,provider:this.provider};return this._analyticsCustomization=new this._customizationClass(e),"function"!=typeof this._analyticsCustomization.getConfig?Promise.resolve(this._getConfigFromAppExperience()):this._invokeCustomizationCallbackAsync((()=>this._analyticsCustomization.getConfig()))}},{key:"_getAppProps",value:function(){const e=this._analyticsCustomization;if(!e||"function"!=typeof e.getAppProps)return null;let t=null;try{t=e.getAppProps()}catch(e){throw new Error("Error occurred trying to execute analytics customization getAppProps method: ".concat(e.message))}return t}}])&&o(t.prototype,n),e}()},5534:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>g});var r=n(8317),i=n(4829),o=n(5827);const a=async(e,t)=>{let r;"undefined"==typeof window||window.global||(window.global=window);try{const[{default:t},{default:i},o]=await Promise.all([Promise.all([n.e(2407),n.e(7766)]).then(n.t.bind(n,7766,23)),Promise.all([n.e(2407),n.e(7076)]).then(n.t.bind(n,7076,23)),fetch("https://segment.intuitcdn.net/v1/projects/".concat(e,"/settings"))]);if(!o.ok)throw new Error("SettingsNetworkError: Could not get settings when initializing Segment analytics");const a=await(async e=>{const t=await e.json();let n;if(t&&t.integrations){const e=Object.keys(t.integrations).filter((e=>"Segment.io"!==e)),r=t.integrations["Segment.io"];n={"Segment.io":{apiKey:r.apiKey,apiHost:r.apiHost,addBundledMetadata:!0,unbundledIntegrations:e}}}return n})(o);if(!a)throw new Error("SettingsNotFoundError: Could not get settings when initializing Segment analytics");r=new t,r.use(i),r.initialize(a,{plan:{}})}catch(n){if(t>0)return a(e,t-1);o.Z.error("Error setting up Segment analytics libraries",{},n)}return r};function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(l,e);var t,n,r,o,s=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(r);if(o){var n=y(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=s.call(this,e)).provider="segment",t.env=i.Z.getEnvironment(),t._sdkLoadInvoked=!1,t._analyticsSegmentSDK=t._setupAnalyticsStub(),t}return t=l,(n=[{key:"initializeProvider",value:function(){return this.config?this._loadSegmentSDK(this.config.apiKey).then((e=>{this._analyticsSegmentSDK=e})):Promise.reject(new Error("No Segment Analytics configs specified. Please add Segment Analytics configs in your\n          app experience (https://github.intuit.com/pages/UX-Infra/UX-Infra-Docs/#/Appfabric/Web/app-dev/web-app-configurations?id=analytics)."))}},{key:"sendEvent",value:function(e){let{event:t,appProps:n,context:r={}}=e;const{options:o,type:a}=t,s=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(t,["options","type"]),l=t.options||{},u=i.Z.getAuthId();u&&(l.auth_id=u);const p=i.Z.getPluginExperimentAssignments(r.pluginId);switch(Array.isArray(p)&&p.length>0&&("page"===a||"track"===a)&&(s.experiment_ids=p.filter((e=>e.experimentId&&e.experimentVersion&&e.treatmentId&&Number.isInteger(e.experimentId)&&Number.isInteger(e.experimentVersion)&&Number.isInteger(e.treatmentId))).map((e=>"".concat(e.experimentId,":").concat(e.experimentVersion,":").concat(e.treatmentId))).join("|")),a){case"page":this._analyticsSegmentSDK.page(s.page_category_parameter,s.page_name_parameter,c(c({},s),n),l);break;case"identify":this._analyticsSegmentSDK.identify(s.pseudonym_id,c(c({},s),n),l);break;case"alias":this._analyticsSegmentSDK.alias(s.pseudonym_id,s.previous_id,l);break;case"group":this._analyticsSegmentSDK.group(s.group_id,c(c({},s),n),l);break;case"track":default:this._analyticsSegmentSDK.track(this._getEventName(t),c(c({},s),n),l)}}},{key:"_setupAnalyticsStub",value:function(){if("undefined"==typeof window)return{};window.__shellInternal.segment=window.__shellInternal.segment||{},window.__shellInternal.segment.analytics=window.__shellInternal.segment.analytics||{};const{analytics:e}=window.__shellInternal.segment;e.q=e.q||[],e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"],e.factory=function(t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];const o=Array.prototype.slice.call(r);return o.unshift(t),e.q.push(o),e}};for(let t=0;t<e.methods.length;t+=1){const n=e.methods[t];e[n]=e.factory(n)}return e}},{key:"_loadSegmentSDK",value:async function(e){return this._sdkLoadInvoked||(this._sdkLoadInvoked=!0,a(e,3).then((e=>{this._setupAnalyticsCore(e)}))),this._analyticsSegmentSDK}},{key:"_getEventName",value:function(e){return e&&e.object&&e.action?"".concat(e.object,":").concat(e.action):"unknown:unknown"}},{key:"_setupAnalyticsCore",value:function(e){if("undefined"==typeof window)return;const{analytics:t}=window.__shellInternal.segment;for(;t.q&&t.q.length>0;){const n=t.q.shift(),r=n.shift();"function"==typeof e[r]&&e[r].apply(e,n)}this._analyticsSegmentSDK=e,window.__shellInternal.segment.analytics=e}}])&&u(t.prototype,n),l}(r.Z)}}]);
//# sourceMappingURL=5534.js.map