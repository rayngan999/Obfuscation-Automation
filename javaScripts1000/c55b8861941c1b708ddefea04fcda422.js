(function() { function bxBootstrap() {
	var re = /bot|crawl|slurp|spider|mediapartners|headlesschrome/i;
	if (re.test(navigator.userAgent) || navigator.userAgent == '') {
		return;
	}

	if (!(window.bouncex&&bouncex.website)) {
		var pushedData = [];
		if(window.bouncex && bouncex.push && bouncex.length){
			pushedData = bouncex;
		}
		window.bouncex = {};
		bouncex.pushedData = pushedData;
		bouncex.website = {"id":2358,"name":"Aeropostale","cookie_name":"bounceClientVisit2358","domain":"aeropostale.com","ct":"bind_to_domain","ally":0,"ei":0,"tcjs":"","cjs":"(function () {\n\twindow.bouncex = window.bouncex || {};\n\n\twindow.bouncex.bxISR = {\n\t\t/* --- INITIALIZATION --- */\n\t\tversion: 'Version 8.2 | 10/25/17',\n\t\tstartTime: Date.now(),\n\t\tsettings: {\n\t\t\tcurrentProduct: {},\n\t\t\tgeneral: {\n\t\t\t\tproductPageIdentifier: jQuery('#pdpMain').length > 0 || bouncex.website.pts === 'product',\n\t\t\t\tmaxProducts: 20,\n\t\t\t\tcategoryHistory: JSON.parse(window.localStorage.getItem('bxCatHist')) || [],\n\t\t\t\tproductHistory: JSON.parse(window.localStorage.getItem('bxProdHist')) || [],\n\t\t\t\tcategoryHistoryLength: 0,\n\t\t\t\tproductHistoryLength: 0\n\t\t\t}\n\t\t},\n\n\t\tinit: function () {\n\t\t\tthis.productMap();\n\t\t\tthis.setItemHistoryLengths();\n\t\t\tthis.trackProductHistory();\n\t\t\t//this.trackCategoryHistory();\n\t\t\tthis.maxProducts();\n\t\t// \tconsole.log(Date.now() - window.bouncex.bxISR.startTime, 'bxISR start');\n\t\t},\n\n\t\tproductMap: function () {\n\t\t\tif (!this.settings.general.productPageIdentifier) { return; }\n\t\t\tvar productValues = {\n\t\t\t\turl: bouncex.utils.url.allowParams(),\n\t\t\t\tname: bouncex.vars.prod_name,\n\t\t\t\t//sku: (/* product sku */),\n\t\t\t\t//category: [{ categoryName: (/* product category name */), categoryUrl: (/* product category url */) }],\n\t\t\t\t//description: (/* product description */),\n\t\t\t\tprice: bouncex.vars.prod_price,\n\t\t\t\tmainImgUrl: jQuery('img.primary-image').attr('src'),\n\t\t\t\ttimeStamp: Date.now(),\n\t\t\t\tviewCount: 1,\n\t\t\t\tsessionId: window.bouncex.cookie.vid\n\t\t\t};\n\n\t\t\tthis.settings.currentProduct = productValues;\n\t\t},\n\n\t\t/* --- END OF INITIALIZATION --- */\n\t\t/* --- HELPER FUNCTIONS --- */\n\n\t\taddProductToHistory: function (product) {\n\t\t\tvar productHistory = this.settings.general.productHistory;\n\t\t\tproductHistory.unshift(product);\n\t\t\tthis.setProductHistory(productHistory);\n\t\t},\n\n\t\taddCategoryToHistory: function (currentCategory) {\n\t\t\tvar categoryHistory = this.settings.general.categoryHistory;\n\t\t\tvar newCategory = {\n\t\t\t\tcategory: currentCategory,\n\t\t\t\tviewCount: 1,\n\t\t\t\ttimeStamp: Date.now()\n\t\t\t};\n\n\t\t\tcategoryHistory.unshift(newCategory);\n\t\t\twindow.bouncex.bxISR.setCategoryHistory(categoryHistory);\n\t\t},\n\n\t\tcompareProducts: function (productA, productB) {\n\t\t\tif (productA.mainImgUrl === productB.mainImgUrl) { return true; }\n\t\t\t//if (productA.sku === productB.sku) { return true; }\n\t\t\tif (productA.name === productB.name) { return true; }\n\t\t\tif (productA.url === productB.url) { return true; }\n\t\t\treturn false;\n\t\t},\n\n\t\ttrackProductHistory: function () {\n\t\t\tvar productHistory = this.settings.general.productHistory;\n\t\t\tif (!this.settings.general.productPageIdentifier) { return; }\n\n\t\t\tif (this.settings.general.productHistoryLength > 0) {\n\t\t\t\tvar historyUpdated = false;\n\n\t\t\t\tfor (var i = 0; i < this.settings.general.productHistoryLength; i++) {\n\t\t\t\t\tif (this.compareProducts(productHistory[i], this.settings.currentProduct)) {\n\t\t\t\t\t\tproductHistory[i].viewCount++;\n\t\t\t\t\t\tproductHistory[i].timeStamp = Date.now();\n\t\t\t\t\t\tproductHistory.unshift(productHistory[i]);\n\n\t\t\t\t\t\tproductHistory.splice(i + 1, 1);\n\t\t\t\t\t\thistoryUpdated = true;\n\t\t\t\t\t\tthis.setProductHistory(productHistory);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!historyUpdated) {\n\t\t\t\t\tthis.addProductToHistory(this.settings.currentProduct);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.addProductToHistory(this.settings.currentProduct);\n\t\t\t}\n\t\t},\n\n\t\ttrackCategoryHistory: function () {\n\t\t\tvar categoryHistory = this.settings.general.categoryHistory;\n\t\t\tif (!this.settings.general.productPageIdentifier) { return; }\n\n\t\t\tvar currentCategoriesLength = this.settings.currentProduct.category.length;\n\t\t\tfor (var i = 0; i < currentCategoriesLength; i++) {\n\t\t\t\tvar currentCategory = this.settings.currentProduct.category[i];\n\n\t\t\t\tif (this.settings.general.categoryHistoryLength > 0) {\n\t\t\t\t\tvar historyUpdated = false;\n\t\t\t\t\tfor (var j = 0; j < this.settings.general.categoryHistoryLength; j++) {\n\t\t\t\t\t\tif (categoryHistory[j].category.categoryName === currentCategory.categoryName) {\n\t\t\t\t\t\t\tcategoryHistory[j].viewCount++;\n\t\t\t\t\t\t\tcategoryHistory[j].timeStamp = Date.now();\n\t\t\t\t\t\t\thistoryUpdated = true;\n\t\t\t\t\t\t\tthis.setCategoryHistory(categoryHistory);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!historyUpdated) {\n\t\t\t\t\t\tthis.addCategoryToHistory(currentCategory);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.addCategoryToHistory(currentCategory);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/* --- END OF HELPER FUNCTIONS --- */\n\t\t/* --- GETTER FUNCTIONS --- */\n\n\t\tgetTopCategories: function (criteria, number) {\n\t\t\tvar categories = this.settings.general.categoryHistory;\n\t\t\tif (!number) { number = categories.length; }\n\n\t\t\tif (criteria === 'views') {\n\t\t\t\treturn categories.sort(function (a, b) { return b.viewCount - a.viewCount; }).slice(0, number);\n\t\t\t} else if (criteria === 'time') {\n\t\t\t\treturn categories.sort(function (a, b) { return b.timeStamp - a.timeStamp; }).slice(0, number);\n\t\t\t} else if (criteria === 'recency') {\n\t\t\t\treturn categories.sort(function (a, b) { return b.viewCount - a.viewCount; }).slice(0, number).sort(function (c, d) { return d.timeStamp - c.timeStamp; });\n\t\t\t}\n\t\t},\n\n\t\tgetTopProducts: function (criteria, number) {\n\t\t\tvar products = this.settings.general.productHistory;\n\t\t\tif (!number) { number = products.length; }\n\t\t\tif (criteria === 'views') {\n\t\t\t\treturn products.sort(function (a, b) { return b.viewCount - a.viewCount; }).slice(0, number);\n\t\t\t} else if (criteria === 'time') {\n\t\t\t\treturn products.sort(function (a, b) { return b.timeStamp - a.timeStamp; }).slice(0, number);\n\t\t\t} else if (criteria === 'recency') {\n\t\t\t\treturn products.sort(function (a, b) { return b.viewCount - a.viewCount; }).slice(0, number).sort(function (c, d) { return d.timeStamp - c.timeStamp; });\n\t\t\t}\n\t\t},\n\n\t\tmaxProducts: function () {\n\t\t\tvar maxProducts = this.settings.general.maxProducts;\n\t\t\tif (this.settings.general.productHistoryLength > maxProducts) {\n\t\t\t\tvar topProducts = this.getTopProducts('time', maxProducts);\n\t\t\t\tthis.setProductHistory(topProducts);\n\t\t\t}\n\t\t},\n\n\t\t/* --- END GETTER FUNCTIONS --- */\n\t\t/* --- SETTER FUNCTIONS --- */\n\n\t\tsetItemHistoryLengths: function () {\n\t\t\t//this.settings.general.categoryHistoryLength = this.settings.general.categoryHistory.length;\n\t\t\tthis.settings.general.productHistoryLength = this.settings.general.productHistory.length;\n\t\t},\n\n\t\tsetProductHistory: function (productHistory) {\n\t\t\twindow.localStorage.setItem('bxProdHist', JSON.stringify(productHistory));\n\t\t\tthis.settings.general.productHistory = productHistory;\n\t\t\tthis.settings.general.productHistoryLength = productHistory.length;\n\t\t},\n\n\t\tsetCategoryHistory: function (categoryHistory) {\n\t\t\twindow.localStorage.setItem('bxCatHist', JSON.stringify(categoryHistory));\n\t\t\tthis.settings.general.categoryHistory = categoryHistory;\n\t\t\tthis.settings.general.categoryHistoryLength = categoryHistory.length;\n\t\t},\n\n\t\t/* --- END SETTER FUNCTIONS --- */\n\t\t/* --- CAMPAIGN TEMPLATING --- */\n\t\tpopulateCampaignProductsV2: function (params) {\n\t\t\tif (!params || !params.campaignId || !params.numberProducts) { return false; }\n\t\t\tif (!params.sortBy) { params.sortBy = 'time'; }\n\t\t\tif (!params.productAction) { params.productAction = 'link'; }\n\t\t\tif (!params.linkAction) { params.linkAction = 'new'; }\n\n\t\t\tvar campaign = jQuery('#bx-campaign-' + params.campaignId);\n\t\t\tvar campaignProductArray = [];\n\n\t\t\tcampaignProductElements = {};\n\t\t\tjQuery.each(params.campaignSteps, function (x, y) {\n\n\t\t\t\tcampaignStepProductElements = [];\n\t\t\t\tfor ( var i = 0; i < params.numberProducts; i++ ) {\n\t\t\t\t\tvar campaignStepProductObject = {};\n\t\t\t\t\tif (y.productImages) {\n\t\t\t\t\t\tcampaignStepProductObject.img = campaign.find('#bx-form-' + params.campaignId + '-step-' + y.stepNumber + ' .bx-row-line-custom .bx-lineshape:eq(' + i +')');\n\t\t\t\t\t}\n\t\t\t\t\tif (y.productLinkElems) {\n\t\t\t\t\t  campaignStepProductObject.link = campaign.find('#bx-form-' + params.campaignId + '-step-' + y.stepNumber + ' .bx-group .bx-row-line-custom:eq(' + i +')').siblings('.bx-row-text').find('div');\n\t\t\t\t\t\t//campaignStepProductObject.link = campaign.find('#bx-form-' + params.campaignId + '-step-' + y.stepNumber + ' .bx-group .bx-row-submit:eq('+i+')').find('button');\n\t\t\t\t\t}\n\t\t\t\t\tif (y.productHoverStates) {\n\t\t\t\t\t\tcampaignStepProductObject.hoverTitle = campaign.find('#bx-form-' + params.campaignId + '-step-' + y.stepNumber + ' .bx-group .bx-row-line-custom:eq(' + i +')').siblings('.bx-row-text').find('div');\n\t\t\t\t\t}\n\t\t\t\t\tcampaignStepProductElements.push(campaignStepProductObject);\n\t\t\t\t}\n\n\t\t\t\tcampaignProductElements['step-' +x] = campaignStepProductElements;\n\t\t\t});\n\n\t\t\tvar productArray = window.bouncex.bxISR.getTopProducts(params.sortBy, params.numberProducts);\n\n\t\t\tvar self = this;\n\t\t\tjQuery.each(campaignProductElements, function (x, y) {\n\t\t\t\tvar productAction = function () {};\n\n\t\t\t\tfor ( var i = 0; i < y.length; i++ ) {\n\t\t\t\t\tif (params.campaignSteps[(x.split('-')[1])].productsLink) {\n\t\t\t\t\t\tvar productLink = (productArray[i].url.indexOf('http') > -1) ? productArray[i].url : window.top.location.origin + productArray[i].url;\n\t\t\t\t\t\tproductAction = self.makeProductAction(productLink, params);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (y[i].img) {\n\t\t\t\t\t\tvar imgSrc = productArray[i].mainImgUrl,\n\t\t\t\t\t\t\tproductImageElem = jQuery(y[i].img);\n\n\t\t\t\t\t\tproductImageElem.css('background-image', 'url(' + imgSrc + ')').addClass('isr-image isr' + x + '').bind('click.bx_' + params.campaignId + '_isr_' + i, productAction);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (y[i].link) {\n\t\t\t\t\t\tvar productLink = (productArray[i].url.indexOf('http') > -1) ? productArray[i].url : window.top.location.origin + productArray[i].url,\n\t\t\t\t\t\t\tproductLinkElem = jQuery(y[i].link);\n\n\t\t\t\t\t\tproductLinkElem.attr('bx-href', productLink).bind('click.bx_' + params.campaignId + '_isr_' + i, productAction);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (y[i].hoverTitle) {\n\t\t\t\t\t\tvar productTitle = productArray[i].name,\n\t\t\t\t\t\t\tproductHoverTitleElem = jQuery(y[i].hoverTitle);\n\n\t\t\t\t\t\tproductHoverTitleElem.text(productTitle).bind('click.bx_' + params.campaignId + '_isr_' + i, productAction);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t},\n\n\t\tmakeProductAction: function (productLink, campaignParams) {\n\t\t\tvar productAction = function () {};\n\n\t\t\t\tif (campaignParams.productAction === 'link') {\n\t\t\t\t\tif (campaignParams.linkAction === 'new') {\n\t\t\t\t\t\tif (campaignParams.reportClicks) {\n\t\t\t\t\t\t\tproductAction = function () {\n\t\t\t\t\t\t\t\twindow.bouncex.report(campaignParams.campaignId, 'click');\n\t\t\t\t\t\t\t\twindow.top.open(productLink);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tproductAction = function () {\n\t\t\t\t\t\t\t\twindow.top.open(productLink);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (campaignParams.linkAction === 'current') {\n\t\t\t\t\t\tif (campaignParams.reportClicks) {\n\t\t\t\t\t\t\tproductAction = function () {\n\t\t\t\t\t\t\t\twindow.bouncex.report(campaignParams.campaignId, 'click');\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\twindow.top.location.replace(productLink);\n\t\t\t\t\t\t\t\t}, 100);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tproductAction = function () {\n\t\t\t\t\t\t\t\twindow.top.location.replace(productLink);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\treturn productAction;\n\t\t}\n\t};\n\n\twindow.bouncex.bxISR.init();\n})();","force_https":false,"waypoints":false,"content_width":0,"gai":"UA-64202560-1","swids":"","sd":0,"ljq":"auto","campaign_id":0,"is_preview":false,"aco":{"first_party_limit":"3500","local_storage":"1"},"cmp":{"gdpr":1,"gmp":0,"whitelist_check":0},"burls":[],"ple":false,"fbe":true,"mas":4,"map":1,"gar":true,"ete":0,"ettm":true,"etjs":"","dge":true,"bxidLoadFirst":false,"gbi_enabled":0,"gbi":{"rblocks":null},"bpush":true,"pt":{"cart":{"testmode":false,"val":[[{"activation":"current_page_url","prop":"contains","prop2":"","prop3":"","val":"https://www.aeropostale.com/cart/"}]]},"category":{"testmode":false,"val":[[{"activation":"js","prop":"","prop2":"","prop3":"","val":"window.pageContext.type === 'search'"}]]},"home":{"testmode":false,"val":[[{"activation":"js","prop":"","prop2":"","prop3":"","val":"window.pageContext.type === 'storefront'"}]]},"product":{"testmode":false,"val":[[{"activation":"js","prop":"","prop2":"","prop3":"","val":"window.pageContext.type === 'product'"}]]}},"els":null,"vars":[{"name":"logged_in","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"false","code":"bouncex.state.mobile ? jQuery('#user_panel').find('.user-logout').length > 0 : jQuery('#user_panel').find('.user-logout:visible').length > 0;","trigger":""},{"name":"ever_logged_in","polling":"none","persist":"permanent","page_types":[],"testmode":false,"default":"false","code":"bouncex.vars.logged_in ? true : null;","trigger":""},{"name":"cart_qty","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"0","code":"Number(jQuery('[title=\"View Shopping Bag\"]').text().replace(/[^0-9.]/g, ''));","trigger":""},{"name":"cart_total","polling":"all","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"(function(){\n  /* MW: new website CV */\n  var $miniCartSubtotals = jQuery('.mini-cart-subtotals');\n  if ($miniCartSubtotals.length > 0){\n    return +$miniCartSubtotals.find('.value').text().replace(/[^0-9.]/g,'');\n  }\n  /* MW: end new website CV */\n  if(bouncex.vars.cart_qty > 0){\n    var cartDetails = jQuery('#minicart7_summary').find('div.minicart7_subtotalPrice').first();\n    var mobileModal = jQuery('#modal-container .total span');\n    var cartPageTotal = jQuery('#taxShippingSummary tr:first td b').not(':contains(\"Merchandise Subtotal\")');\n    if(cartDetails.length >0){\n      return Number(cartDetails.text().replace(/[^\\d\\s\\.]/gi, '').trim());\n    }else if(mobileModal.length > 0){\n      return Number(mobileModal.text().replace(/[^\\d\\s\\.]/gi, ''));\n    }else if(window.location.href.indexOf('/cart') > -1){\n      if(cartPageTotal.length > 0){\n         return Number(cartPageTotal.text().replace(/[^\\d\\s\\.]/gi, ''));\n      }\n    }\n    return null;\n  }else{\n    return 0;\n  }\n})();","trigger":""},{"name":"prod_price","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(function(){\n  /* MW: new website CV */\n  var $prodContent = jQuery('#product-content');\n  if ($prodContent.length > 0){\n    return Number($prodContent.find('[itemprop=\"price\"]').last().text().replace(/[^0-9.]/g, ''));\n  }\n  /* MW: end new website CV */\n  \n  if(jQuery('#productPage').length > 0 || jQuery('.product-details-page').length > 0){\n    var prodInfo = jQuery('.right .price');\n    var mobileProd = jQuery('.details .price');\n    if(prodInfo.find('.now').length > 0){\n      return Number(prodInfo.find('.now').text().replace(/[^\\d\\s\\.]/gi, '').trim());\n    }else if(prodInfo.find('li').length >0){\n      return Number(prodInfo.find('li:first').text().replace(/[^\\d\\s\\.]/gi, '').trim());\n    }else if(mobileProd.length >0){\n      return Number(mobileProd.text().replace(/[^\\d\\s\\.]/gi, '').trim());\n    }\n  }\n})();","trigger":""},{"name":"prod_name","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(function(){\n  /* MW: new website CV */\n  var $prodContent = jQuery('#product-content');\n  if ($prodContent.length > 0){\n    return $prodContent.find('.product-name').text();\n  }\n  /* MW: end new website CV */\n  if(jQuery('#productPage').length > 0 || jQuery('.product-details-page').length > 0){\n    var prodNameSelector = jQuery('.right').find('h2');\n    var mobileProdSelector = jQuery('.details .title');\n    if(prodNameSelector.length > 0){\n      return prodNameSelector.text();\n    }else if(mobileProdSelector.length >0){\n      return mobileProdSelector.text();\n    }\n  }\n})();","trigger":""},{"name":"in_stock","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(jQuery('#fieldsetWrapper .primary-btn #addToBag_img').length > 0) || (jQuery('#form-cart-add .button .add-t0-cart').length > 0);","trigger":""},{"name":"product_dollar_discount","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(function(){\n  /* MW: new website CV */\n  var $prodContent = jQuery('#product-content');\n  if ($prodContent.length > 0){\n    var originalPrice = Number($prodContent.find('[itemprop=\"price\"]').first().text().replace(/[^0-9.]/g, ''));\n    var salePrice = Number($prodContent.find('[itemprop=\"price\"]').last().text().replace(/[^0-9.]/g, ''));\n    return Number(originalPrice - salePrice).toFixed(2);\n  }\n  /* MW: end new website CV */\n  \n  var prodInfo = jQuery('.right .price');\n  var mobileProd = jQuery('.details');\n  if(prodInfo.length >0){\n    var oldPrice = prodInfo.find('li:first').text().replace(/[^\\d\\s\\.]/gi, '').trim();\n    var newPrice = prodInfo.find('li.now').text().replace(/[^\\d\\s\\.]/gi, '').trim();\n    return Number(oldPrice - newPrice).toFixed(2);\n  }else if(mobileProd.length >0){\n    var oldPrice = mobileProd.find('div .original-price').text().replace(/[^\\d\\s\\.]/gi, '').trim();\n    var newPrice = mobileProd.find('div .price').text().replace(/[^\\d\\s\\.]/gi, '').trim();\n    return Number(oldPrice - newPrice).toFixed(2);\n  }\n})();","trigger":""},{"name":"product_percent_discount","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(function(){\n    /* MW: new website CV */\n  var $prodContent = jQuery('#product-content');\n  if ($prodContent.length > 0){\n    var originalPrice = Number($prodContent.find('[itemprop=\"price\"]').first().text().replace(/[^0-9.]/g, ''));\n    var salePrice = Number($prodContent.find('[itemprop=\"price\"]').last().text().replace(/[^0-9.]/g, ''));\n    return Math.floor(((originalPrice - salePrice)/originalPrice) * 100).toFixed(0);\n  }\n  /* MW: end new website CV */\n  \n  var oldPrice = jQuery('.right .price li:first');\n  var mobilePrice = jQuery('div.details div .original-price');\n  if(oldPrice.length > 0){\n    oldPrice = oldPrice.text().replace(/[^\\d\\s\\.]/gi, '').trim();\n    return Math.floor((bouncex.vars.product_dollar_discount/oldPrice) * 100);\n  }else if(mobilePrice.length > 0){\n    mobilePrice = mobilePrice.text().replace(/[^\\d\\s\\.]/gi, '').trim();\n      return (Math.floor((bouncex.vars.product_dollar_discount/mobilePrice) * 100)).toFixed(0);\n  }\n})();","trigger":""},{"name":"submitted_email_onsite","polling":"all","persist":"permanent","page_types":[],"testmode":false,"default":"false","code":"(jQuery('.footer-email-integration').find('.success').length > 0 || jQuery('#footer-follow p.successMessage_footer:visible').length > 0) || null;\n","trigger":""},{"name":"ibx_test","polling":"none","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"location.href.indexOf('ibx_test') >= 0 || null;","trigger":""},{"name":"cart","polling":"none","persist":"permanent","page_types":[],"testmode":false,"default":"false","code":"null;","trigger":""},{"name":"cart_quantity","polling":"none","persist":"permanent","page_types":[],"testmode":false,"default":"0","code":"typeof window.utag_data === \"undefined\" ? jQuery('.item-count.cart-count:first').text() : window.utag_data.cart_total_items ","trigger":""},{"name":"quickview_visible","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"false","code":"jQuery('#QuickViewDialog').is(':visible');","trigger":""},{"name":"logged_in_identified","polling":"none","persist":"permanent","page_types":[],"testmode":false,"default":"false","code":"null;","trigger":""},{"name":"onesize_only","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"jQuery('.variation-select option:not(.emptytext)').length === 1;","trigger":""},{"name":"products_tracked","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"0","code":"bouncex.parseJSON(localStorage.bxProdHist).length;","trigger":""},{"name":"page_type","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(function(){\n  if (window.pageContext.type === 'product'){\n    return 'product';\n  } else if (window.pageContext.type === 'search'){\n    return 'category';\n  }\n})();","trigger":""},{"name":"affiliate_source","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(function(){\n  function getParam(name, qstring) {\n\t\tvar param_string = qstring ? ('?' + qstring) : window.location.href;\n\t\tname = name.replace(/[\\[]/,\"\\\\\\[\").replace(/[\\]]/,\"\\\\\\]\");\n\t\tvar regexS = \"[\\\\?&#]\"+name+\"=([^&#]*)\";\n\t\tvar regex = new RegExp( regexS );\n\t\tvar results = regex.exec( param_string );\n\t\tif( results == null ) return \"\";\n\t\telse return decodeURIComponent(results[1]);\n\t}\n\tvar currentUrl = window.location.href;\n\tvar currentCampaign = getParam('utm_source', currentUrl);\n\tif(currentCampaign !== \"\"){\n\t  if(currentCampaign.indexOf('_')){\n\t    currentCampaign = currentCampaign.split('_').join(' ');\n\t  }\n\t   \treturn currentCampaign; \n\t}\n\treturn null;\n})();","trigger":""},{"name":"affiliate_promo","polling":"none","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"(function(){\n  function getParam(name, qstring) {\n\t\tvar param_string = qstring ? ('?' + qstring) : window.location.href;\n\t\tname = name.replace(/[\\[]/,\"\\\\\\[\").replace(/[\\]]/,\"\\\\\\]\");\n\t\tvar regexS = \"[\\\\?&#]\"+name+\"=([^&#]*)\";\n\t\tvar regex = new RegExp( regexS );\n\t\tvar results = regex.exec( param_string );\n\t\tif( results == null ) return \"\";\n\t\telse return decodeURIComponent(results[1]);\n\t}\n\tvar currentUrl = window.location.href;\n\tvar promo = getParam('promocode', currentUrl);\n\tif(promo !== \"\"){\n\t   return promo;\n\t}\n\treturn null;\n})();","trigger":""},{"name":"affiliate_campaign","polling":"none","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"(function(){\n  function getParam(name, qstring) {\n\t\tvar param_string = qstring ? ('?' + qstring) : window.location.href;\n\t\tname = name.replace(/[\\[]/,\"\\\\\\[\").replace(/[\\]]/,\"\\\\\\]\");\n\t\tvar regexS = \"[\\\\?&#]\"+name+\"=([^&#]*)\";\n\t\tvar regex = new RegExp( regexS );\n\t\tvar results = regex.exec( param_string );\n\t\tif( results == null ) return \"\";\n\t\telse return decodeURIComponent(results[1]);\n\t}\n\tvar currentUrl = window.location.href;\n\tvar currentCampaign = getParam('bx_campaign', currentUrl);\n\tif(currentCampaign !== \"\"){\n\t  if(currentCampaign.indexOf('_')){\n\t    currentCampaign = currentCampaign.split('_').join(' ');\n\t  }\n\t   \treturn currentCampaign; \n\t}\n\treturn null;\n})();","trigger":""},{"name":"cart_plurality","polling":"all","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"bouncex.vars.cart_qty > 1 ? 'items' : 'item';","trigger":""},{"name":"submitted_referral","polling":"all","persist":"permanent","page_types":[],"testmode":false,"default":"false","code":"bouncex.vars.submitted_referral || jQuery('.extole-js-panel-view-email, .extole_lightBox_container').find('.extole-lightBox_text, .extole-success').is(':visible');","trigger":""},{"name":"size_availability","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"false","code":"jQuery('.item-quantity input').length > 0 ? parseInt(jQuery('.item-quantity input').attr('data-available')) : null;","trigger":""},{"name":"threshold_countdown100","polling":"all","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"100 - bouncex.vars.cart_total;","trigger":"pageload"},{"name":"threshold_countdown75","polling":"all","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"75 - bouncex.vars.cart_total;","trigger":"pageload"},{"name":"threshold_countdown50","polling":"all","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"50 - bouncex.vars.cart_total;","trigger":"pageload"},{"name":"order_total","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"document.querySelector('.confirmation .order-total .order-value') ? Number(document.querySelector('.confirmation .order-total .order-value').textContent.trim().replace(/[^0-9\\.]/g,'')) : false;","trigger":"pageload"},{"name":"local_storage_enabled","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"window.bouncex && window.bouncex.local_storage_enabled;","trigger":"pageload"},{"name":"email_promo_code","polling":"none","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"(function() {\n    var urlKey = 'bx_promo1';\n    var urlParam = bouncex.ibx._getparam(urlKey);\n    if (urlParam) {\n        return urlParam;\n    }\n    return null;\n})()","trigger":"pageload"},{"name":"email_promo_offer","polling":"none","persist":"visit","page_types":[],"testmode":false,"default":"false","code":"(function() {\n    var urlKey = 'bx_promo2';\n    var urlParam = bouncex.ibx._getparam(urlKey);\n    if (urlParam) {\n        return urlParam;\n    }\n    return null;\n})()","trigger":"pageload"},{"name":"category_type","polling":"none","persist":"no","page_types":[],"testmode":false,"default":"false","code":"(function(){\n\tif (bouncex.website.pts === 'product') {\n        var $breadcrumbs = jQuery('.breadcrumb-element');\n        var keywords = '';\n\n        for (var i=0; i<$breadcrumbs.length-2; i++) {\n            keywords += $breadcrumbs.eq(i).text() + ', ';\n        }\n        keywords += $breadcrumbs.eq($breadcrumbs.length-2).text();\n        return keywords;\n    }\n\treturn false;\n\t\n})();","trigger":"pageload"},{"name":"uniforms_in_cart","polling":"all","persist":"no","page_types":[],"testmode":false,"default":"0","code":"(function(){\n    var uniformCount = 0;\n\tvar cartItem = jQuery('.mini-cart-products .mini-cart-product');\n\n\tfor(var j =0; j < cartItem.length; j++){\n    \tif(cartItem.eq(j).find('.mini-cart-name').text().toLowerCase().indexOf('uniform') > -1){\n        \tuniformCount += Number(cartItem.eq(j).find('.mini-cart-pricing').find('.value').text());\n        }\n    }\n    \n    return uniformCount; \n\n})();","trigger":"pageload"}],"dgu":"pixel.cdnwidget.com","dgp":false,"ba":{"enabled":0,"fbte":0},"biu":"assets.bounceexchange.com","bau":"api.bounceexchange.com","beu":"events.bouncex.net","ibx":{"tjs":"bouncex.util = {\n\n\taddNamespace: function(obj, name) {\n\t\tvar namespacedObj = {};\n\t\tfor (var k in obj) {\n\t\t\tif (obj.hasOwnProperty(k)) {\n\t\t\t\tvar namespacedKey = k;\n\t\t\t\tif (k.indexOf(':') === -1) {\n\t\t\t\t\tnamespacedKey = name + ':' + k;\n\t\t\t\t}\n\t\t\t\tnamespacedObj[namespacedKey] = obj[k];\n\t\t\t}\n\t\t}\n\t\treturn namespacedObj;\n\t},\n\n\tgetOrigin: function() {\n\t\treturn window.location.origin || window.location.protocol + '//' + window.location.hostname + (window.location.port ? (':' + window.location.port) : '');\n\t},\n\n\t//copied from bouncex.ibx\n\tgetParam: function(name, qstring) {\n\t\tvar param_string = qstring ? ('?' + qstring) : window.location.href;\n\t\tname = name.replace(/[\\[]/,\"\\\\\\[\").replace(/[\\]]/,\"\\\\\\]\");\n\t\tvar regexS = \"[\\\\?&#]\"+name+\"=([^&#]*)\";\n\t\tvar regex = new RegExp( regexS );\n\t\tvar results = regex.exec( param_string );\n\t\tif( results == null ) return \"\";\n\t\telse return decodeURIComponent(results[1]);\n\t},\n\n\tgetTimeMs: function() {\n\t\treturn (new Date().getTime());\n\t},\n\n\tisValidInteger: function(val) {\n\t\t// returns true for 0, '0', 1, '1'. False for '', undefined\n\t\treturn !isNaN(parseInt(val));\n\t},\n\n\t//copied from bouncex.ibx\n\tisValidEmail: function(email) {\n\t\tvar regex = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t\treturn regex.test(email);\n\t},\n\n\tisValidUrl: function(url, type) {\n\t\t//JKMD: type could differentiate between absolute/relative, allow mailto links, etc\n\t\tvar regex = /^(http|https):\\/\\/(([a-zA-Z0-9$\\-_.+!*'(),;:&=]|%[0-9a-fA-F]{2})+@)?(((25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])(\\.(25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])) {3})|localhost|([a-zA-Z0-9\\-\\u00C0-\\u017F]+\\.)+([a-zA-Z]{2,}))(:[0-9]+)?(\\/(([a-zA-Z0-9$\\-_.+!*'(),;:@&=]|%[0-9a-fA-F]{2})*(\\/([a-zA-Z0-9$\\-_.+!*'(),;:@&=]|%[0-9a-fA-F]{2})*)*)?(\\?([a-zA-Z0-9$\\-_.+!*'(),;:@&=\\/?]|%[0-9a-fA-F]{2})*)?(\\#([a-zA-Z0-9$\\-_.+!*'(),;:@&=\\/?]|%[0-9a-fA-F]{2})*)?)?$/;\n\t\treturn regex.test(url);\n\t},\n\n\tmakeQuerystring: function(o) {\n\t\tvar a=[],s='';\n\t\tfor(var k in o) {\n\t\t\tif(!o.hasOwnProperty(k)) continue;\n\t\t\ta.push(k+'='+encodeURIComponent(o[k]));\n\t\t}\n\t\treturn a.join('&');\n\t},\n\n\tmergeObject: function () {\n\t\tvar o = {};\n\t\tfor (var k in arguments) {\n\t\t\tvar a = arguments[k];\n\t\t\tif (typeof a == 'object') {\n\t\t\t\tfor (var k in a) {\n\t\t\t\t\tif (a.hasOwnProperty(k)) o[k] = a[k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn o;\n\t}\n};\n\nbouncex.util.cookies = {\n\n\tdomain: window.bouncex.cookie_domain,\n\n\tcreate: function(obj){\n\t\tdefaults = {\n\t\t\tname : '',\n\t\t\tvalue : '',\n\t\t\tdomain : false,\n\t\t\tdays : 14\n\t\t};\n\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\n\t\tif (!obj.name) { return false; }\n\n\t\tvar date = new Date();\n\t\tdate.setTime(date.getTime() + obj.days * 24 * 60 * 60 * 1e3);\n\t\tvar exp = '; expires=' + date.toGMTString();\n\n\t\tvar cookieString = obj.name + '=' + obj.value + exp + '; path=/;';\n\t\tif (obj.domain){\n\t\t\tcookieString += 'domain=' + obj.domain + ';';\n\t\t}\n\t\tdocument.cookie = cookieString;\n\t},\n\n\tdestroy: function (name) {\n\t\treturn this.create({\n\t\t\tname : name,\n\t\t\tdays : -1,\n\t\t});\n\t},\n\n\tread: function (name) {\n\t\t//return this.multi.get(name);\n\t\tvar t = name + \"=\", vars = document.cookie.split(\";\");\n\t\tfor (var r = 0; r < vars.length; r++) {\n\t\t\tvar i = vars[r];\n\t\t\twhile (i.charAt(0) == \" \")i = i.substring(1, i.length);\n\t\t\tif (i.indexOf(t) == 0)return i.substring(t.length, i.length);\n\t\t}\n\t\treturn null;\n\t}\n};\n\n// if utk is already defined persist whatever listeners it has before wipe\nvar previousListeners = bouncex.utk && bouncex.utk.listeners;\n\nbouncex.utk = {\n\t\n\tlisteners: previousListeners || {},\n\n\taddMetadata: function(obj) {\n\t\tvar m = this.getMetadata();\n\t\treturn bouncex.util.mergeObject(obj, m);\n\t},\n\n\tgetMetadata: function() {\n\t\treturn {\n\t\t\t'page:type': this.getPageType(),\n\t\t\t'customer:hasconverted': (bouncex.cookie.lc?1:0)\n\t\t};\n\t},\n\n\tgetPageType: function() {\n\t\treturn \"\";\n\t},\n\n\thoverItem: function(obj) {\n\t\tvar defaults = {\n\t\t\teventName: 'hover item',\n\t\t\titemTracking: false,\n\t\t\tselector: '',\n\t\t\tmaxItems: 5,\n\t\t\ttimeoutMs: 1000,\n\t\t\tgetItemData: function(el) { return null; },\n\t\t};\n\n\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\n\t\t//validation here\n\t\tif (!obj.selector) { return null; }\n\n\t\t//register the tracker\n\t\tobj.stop = removeHoverTracking;\n\t\tvar trackerId = bouncex.utk.register(obj);\n\t\tvar timeout;\n\t\tvar ids = [];\n\n\t\tfunction onMouseenter() {\n\t\t\tclearTimeout(timeout);\n\t\t\tvar el = this;\n\t\t\ttimeout = setTimeout(function() {\n\t\t\t\tvar item = obj.getItemData(el);\n\t\t\t\tif (!item.id) { return; }\n\t\t\t\t//if not already tracked\n\t\t\t\tif (ids.indexOf(item.id) === -1) {\n\t\t\t\t\t//add id to list of tracked items\n\t\t\t\t\tids.push(item.id);\n\t\t\t\t\t//track the event\n\t\t\t\t\tvar itemEventData = { eventName: obj.eventName, item: item };\n\t\t\t\t\tbouncex.utk.trackItemInteraction(itemEventData);\n\t\t\t\t\t//track the item\n\t\t\t\t\tif (obj.itemTracking) {\n\t\t\t\t\t\tbouncex.utk.trackItem(item);\n\t\t\t\t\t}\n\t\t\t\t\t//check limits\n\t\t\t\t\tif (ids.length >= obj.maxItems) {\n\t\t\t\t\t\tremoveHoverTracking();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, obj.timeoutMs);\n\t\t}\n\n\t\tfunction onMouseleave() {\n\t\t\tclearTimeout(timeout);\n\t\t}\n\n\t\tfunction addHoverTracking() {\n\t\t\tjQuery(document).on('mouseenter.bx-tracking-hover.' + trackerId, obj.selector, onMouseenter);\n\t\t\tjQuery(document).on('mouseleave.bx-tracking-hover.' + trackerId, obj.selector, onMouseleave);\n\t\t}\n\n\t\tfunction removeHoverTracking() {\n\t\t\tjQuery(document).off('mouseenter.bx-tracking-hover.' + trackerId, obj.selector);\n\t\t\tjQuery(document).off('mouseleave.bx-tracking-hover.' + trackerId, obj.selector);\n\t\t\tclearTimeout(timeout);\n\t\t}\n\n\t\taddHoverTracking();\n\t\treturn trackerId;\n\t},\n\n\tisIdentified: function(){\n\t\treturn !!(bouncex.cookie.uid || bouncex.getBounceCookie('__ibxu'));\n\t},\n\n\t// miw: function(obj) {\n\t// \tvar defaults = {\n\t// \t\tselector: 'input:not(input[type=button], :input[type=submit], :input[type=reset], :input[type=hidden], :input[type=radio], :input[type=checkbox], :input[type=image], :input[type=password])',\n\t// \t\tgetUserData: function(el) {\n\t// \t\t\treturn {\n\t// \t\t\t\temail : jQuery(el).val(),\n\t// \t\t\t\tsource : el.id,\n\t// \t\t\t};\n\t// \t\t}\n\t// \t};\n\n\t// \tobj = bouncex.util.mergeObject(defaults, obj);\n\t// \tif (!obj.selector) { return null; }\n\n\t// \t//register the tracker\n\t// \tobj.stop = removeUserTracking;\n\t// \tvar trackerId = bouncex.utk.register(obj);\n\n\t// \tfunction onBlur() {\n\t// \t\tvar user = obj.getUserData(this);\n\t// \t\tbouncex.utk.trackUser(user);\n\t// \t}\n\n\t// \tfunction removeUserTracking() {\n\t// \t\tjQuery(document).off('blur.miw.' + trackerId, obj.selector);\n\t// \t}\n\n\t// \tjQuery(document).on('blur.miw.' + trackerId, obj.selector, onBlur);\n\n\t// \treturn trackerId;\n\t// },\n\n\tmuu: function(){\n\t\tvar match = location.href.match(/([a-zA-Z0-9._\\+-]+(?:@|%40)[a-zA-Z0-9._-]+\\.[a-zA-Z0-9._-]+)/gi);\n\t\tif (match){\n\t\t\tbouncex.utk.trackUser({\n\t\t\t\temail: decodeURIComponent(match[0]),\n\t\t\t\tsource: 'URL'\n\t\t\t});\n\t\t}\n\t},\n\n\tquickviewItem: function(obj) {\n\t\tvar defaults = {\n\t\t\teventName: 'view item',\n\t\t\titemTracking: false,\n\t\t\tselector: '',\n\t\t\tgetItemData: function(el) { return null; }\n\t\t};\n\n\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\t\t//validation here\n\t\tif (!obj.selector) { return null; }\n\n\t\tvar prevVisible = false,\n\t\t\tvisible;\n\n\t\treturn bouncex.utk.setInterval({\n\t\t\tcallback: function() {\n\t\t\t\tvisible = jQuery(obj.selector).is(':visible');\n\t\t\t\tif (visible && !prevVisible) {\n\t\t\t\t\tvar item = obj.getItemData(obj.selector);\n\n\t\t\t\t\tif (item.id) {\n\t\t\t\t\t\tvar itemEventData = { eventName: obj.eventName, item: item };\n\t\t\t\t\t\tbouncex.utk.trackItemInteraction(itemEventData);\n\t\t\t\t\t}\n\t\t\t\t\t//track the item\n\t\t\t\t\tif (obj.itemTracking) {\n\t\t\t\t\t\tbouncex.utk.trackItem(item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tprevVisible = visible;\n\t\t\t}\n\t\t});\n\t},\n\n\trequestEmail: function(obj) {\n\t\t//make sure email is specified and valid\n\t\tif (!obj['email'] && !obj['user:email']){\n\t\t\treturn false;\n\t\t}\n\n\t\tif (obj['email'] && !bouncex.util.isValidEmail(obj['email'])){\n\t\t\treturn false;\n\t\t}\n\n\t\tif (obj['user:email'] && !bouncex.util.isValidEmail(obj['user:email'])){\n\t\t\treturn false;\n\t\t}\n\n\t\t//JKMD: bouncex.push right now automatically adds namespacing, which would mess up \"campaignid\"\n\t\tparams = {};\n\t\tfor (var k in obj) {\n\t\t\tif (obj.hasOwnProperty(k)){\n\t\t\t\tparams[k.toLowerCase()] = obj[k];\n\t\t\t}\n\t\t}\n\t\tevent_stream_report('requestemail', params);\n\t},\n\n\t//JKMD: long-term plan is to put all of our polling into a single setInterval\n\tsetInterval: function(obj) {\n\t\tvar defaults = {\n\t\t\tmilliseconds: 1000,\n\t\t\tcallback: function() { return null; }\n\t\t};\n\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\t\tvar intervalId = setInterval(obj.callback, obj.milliseconds);\n\n\t\tobj.stop = removeInterval;\n\t\tvar trackerId = bouncex.utk.register(obj);\n\t\tfunction removeInterval() {\n\t\t\tclearInterval(intervalId);\n\t\t}\n\t\treturn trackerId;\n\t},\n\n\t// trackItem: function(item) {\n\t// \tif (typeof(item.id) === 'string'){\n\t// \t\titem.id = item.id.trim().toLowerCase();\n\t// \t}\n\t// \tif (!this.validateItem(item)) {\n\t// \t\t//bouncex.log('item failed validation', item);\n\t// \t\treturn false;\n\t// \t}\n\t// \titem = bouncex.util.addNamespace(item, 'item');\n\t// \tbouncex.push(['item', item]);\n\t// },\n\n\t// trackItemInteraction: function(obj) {\n\t// \tvar id = obj.item.id;\n\t// \tif (typeof(id) === 'string'){\n\t// \t\tid = id.trim().toLowerCase();\n\t// \t}\n\t// \tvar o = { 'item:id': id };\n\t// \to = this.addMetadata(o);\n\t// \tbouncex.push([obj.eventName, o]);\n\t// },\n\n\t// trackListPage: function(obj){\n\t// \tvar defaults = {\n\t// \t\teventName: 'view ' + this.getPageType(),\n\t// \t\tmaxItems: 6,\n\t// \t\tselector: '',\n\t// \t\ttitle: '',\n\t// \t\turl: jQuery('link[rel=canonical]').attr('href') || window.location.href.split('?')[0],\n\t// \t\titemTracking : false,\n\t// \t\tgetItemData: function(el) { return null;},\n\t// \t\textraEventData: {}\n\t// \t};\n\n\t// \tobj = bouncex.util.mergeObject(defaults, obj);\n\n\t// \tvar items = jQuery(obj.selector);\n\t// \tif (!items || !items.length){\n\t// \t\treturn false;\n\t// \t}\n\t// \tvar itemsTracked = 0;\n\t// \tvar itemIds = [];\n\t// \tfor (var i = 0; i < items.length && itemsTracked < obj.maxItems; i++) {\n\t// \t\tvar item = obj.getItemData(items[i]);\n\t// \t\tif (item.id){\n\t// \t\t\tif (typeof(item.id) === 'string'){\n\t// \t\t\t\titem.id = item.id.trim().toLowerCase();\n\t// \t\t\t}\n\t// \t\t\t// add id to list\n\t// \t\t\titemIds.push(item.id);\n\t// \t\t\tif (obj.itemTracking){\n\t// \t\t\t\t//track full item\n\t// \t\t\t\tthis.trackItem(item);\n\t// \t\t\t}\n\t// \t\t\titemsTracked++;\n\t// \t\t}\n\t// \t}\n\n\t// \tvar o = {'items:ids' : itemIds.join(','), 'page:url' : obj.url};\n\t// \tif (obj.title){\n\t// \t\to['page:title'] = obj.title;\n\t// \t}\n\t// \to = this.addMetadata(o);\n\t// \to = bouncex.util.mergeObject(o, obj.extraEventData);\n\t// \tbouncex.push([obj.eventName, o]);\n\t// },\n\n\ttrackUser: function(user) {\n\t\tif (!user.email && !user.emailHash) {\n\t\t\treturn false;\n\t\t}\n\t\tif (user.email && !bouncex.util.isValidEmail(user.email)){\n\t\t\treturn false;\n\t\t}\n\t\tvar params = bouncex.util.addNamespace(user, 'user');\n\t\tif (user.email) {\n\t\t\tparams['user:email'] = user.email;\n\t\t}\n\t\tif (user.emailHash) {\n\t\t\tparams['user:emailhash'] = user.emailHash;\n\t\t}\n\t\tif (user.campaignId) {\n\t\t\tparams['campaignid'] = user.campaignId;\n\t\t}\n\t\tparams['user:gcr'] = (bouncex && bouncex.cookie) ? bouncex.cookie.gcr : 99;\n\t\tparams['agent'] = 'js';\n\t\tparams['eq'] = 1;\n\n\t\tevent_stream_report('user', params);\n\n\t\tbouncex.cookie.uid = 1;\n\t\tsetBounceCookie();\n\t\t//legacy support\n\t\tbouncex.util.cookies.create({\n\t\t\tname: '__ibxu',\n\t\t\tvalue : '1',\n\t\t\tdomain : '.' + bouncex.util.cookies.domain,\n\t\t\tdays : 365,\n\t\t});\n\n\t},\n\n\tvalidateItem: function(item) {\n\t\tif (!item) { return false; }\n\t\tif (!item.id) { return false; }\n\t\tif (!item.copy) { return false; }\n\t\tif (!item.imageurl || !bouncex.util.isValidUrl(item.imageurl)) { return false; }\n\t\tif (!item.url || !bouncex.util.isValidUrl(item.url)) { return false; }\n\t\treturn true;\n\t},\n\n\tviewItem: function(obj) {\n\t\tvar defaults = {\n\t\t\teventName: 'view item',\n\t\t\titemTracking: true,\n\t\t\tgetItemData: function() { return null; }\n\t\t};\n\n\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\t\tvar item = obj.getItemData();\n\t\tif (obj.itemTracking) {\n\t\t\tthis.trackItem(item);\n\t\t}\n\n\t\tif (item.id) {\n\t\t\tvar itemEventData = { eventName: obj.eventName, item: item };\n\t\t\tbouncex.utk.trackItemInteraction(itemEventData);\n\t\t} else {\n\t\t\t//bouncex.log('no item id', obj.eventName, item);\n\t\t}\n\t},\n\n\t//keeping track of the listeners inside tracking\n\tregister: function(obj) {\n\t\tvar id = bouncex.util.getTimeMs() + Math.random();\n\t\tbouncex.utk.listeners[id] = obj;\n\t\treturn id;\n\t},\n\n\t//remove single tracker\n\tstop: function(id) {\n\t\tif (bouncex.utk.listeners.hasOwnProperty(id)) {\n\t\t\tbouncex.utk.listeners[id].stop();\n\t\t\tdelete bouncex.utk.listeners[id];\n\t\t}\n\t},\n\n\t//remove all listeners\n\tstopAll: function() {\n\t\tfor (var id in bouncex.utk.listeners) {\n\t\t\tbouncex.utk.stop(id);\n\t\t}\n\t}\n};\n\nbouncex.utk.cart = {\n\n\tgetCart: function() {\n\t\tif (this.state) {\n\t\t//cached here once we look it up or save\n\t\t\treturn this.state;\n\t\t}else if (this.config.storeCartVariable && bouncex.vars[this.config.storeCartVariable]) {\n\t\t//look up from cvar if it exists\n\t\t\tthis.state = JSON.parse(bouncex.vars[this.config.storeCartVariable]);\n\t\t\treturn this.state;\n\t\t}else {\n\t\t\treturn {};\n\t\t}\n\t},\n\n\tgetCount: function(){\n\t\treturn bouncex.vars[this.config.cartCountVariable];\n\t},\n\n\t// inferCount: function(cart) {\n\t// \t// return cart.count if specified and valid\n\t// \tif (bouncex.util.isValidInteger(cart.count)) {\n\t// \t\treturn parseInt(cart.count);\n\t// \t} else if (cart.items) {\n\t// \t\t// deduce from items length (using qty property if specified)\n\t// \t\tvar count = 0;\n\t// \t\tfor (var i = 0; i < cart.items.length; i++) {\n\t// \t\t\tvar qty = parseInt(cart.items[i].qty) || 1;\n\t// \t\t\tcount += qty;\n\t// \t\t}\n\t// \t\treturn count;\n\t// \t}else if (bouncex.util.isValidInteger(this.getCount())){\n\t// \t\treturn parseInt(this.getCount());\n\t// \t}else{\n\t// \t\treturn 0;\n\t// \t}\n\t// },\n\n\tinit: function(obj) {\n\t\tvar defaults = {\n\t\t\t// lastReplenishment: false,\n\t\t\tstoreCartVariable: 'cart',\n\t\t\tcartCountVariable: 'cart_qty',\n\t\t\tmaxVariableSize: 400,\n\t\t\tstoreValues: ['count', 'items'],\n\t\t\tmaxItems: 10\n\t\t};\n\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\t\tthis.config = obj;\n\n\t\t//JKMD: should we do this via init, or just override explicitly...?\n\t\tthis.replenish = obj.replenish || this.replenish;\n\t\tthis.validateReplenishment = obj.validateReplenishment || this.validateReplenishment;\n\t\tthis.reportReplenishment = obj.reportReplenishment || this.reportReplenishment;\n\n\t\tthis.initFromQuerystring();\n\t\tthis.reportReplenishment();\n\t},\n\n\tinitFromQuerystring: function() {\n\t\tvar bx_cart = bouncex.util.getParam('bx_cart');\n\t\tvar cart = {};\n\t\tthis.replenishing = false;\n\n\t\tif (bx_cart) {\n\t\t\t//JKMD: support base64\n\t\t\tif (bx_cart.charAt(0) !== '{') {\n\t\t\t\tbx_cart = atob(bx_cart);\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tcart = JSON.parse(bx_cart);\n\t\t\t} catch(e) { console.log(e); return false; }\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.validateReplenishment(cart)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar cartCopy = jQuery.extend(true,{},cart);\n\t\tthis.save(cartCopy);\n\t\tthis.replenishing = true;\n\t\treturn this.replenish(cart);\n\t},\n\n\treplenish: function(cart) {\n\t\treturn null;\n\t},\n\n\tsave: function(cart) {\n\t\tif (!cart) { return false; }\n\t\tthis.state = cart;\n\t\tif (this.config.storeCartVariable) {\n\t\t\tvar storedCart = {};\n\t\t\tif (cart.count === 0) {\n\t\t\t\t// if count is 0, don't store any other info\n\t\t\t\tstoredCart = { count: 0 };\n\t\t\t}else{\n\t\t\t\t//store values specified in settings\n\t\t\t\tfor (var i = 0; i < this.config.storeValues.length; i++) {\n\t\t\t\t\tvar k = this.config.storeValues[i];\n\t\t\t\t\tif (cart.hasOwnProperty(k)) {\n\t\t\t\t\t\tstoredCart[k] = cart[k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.checkAndSetVar(storedCart);\n\t\t}\n\t},\n\n\tcheckAndSetVar: function(storedCart) {\n\t\tvar cartString = JSON.stringify(storedCart);\n\t\tif (cartString.length <= this.config.maxVariableSize) {\n\t\t\tbouncex.setv(this.config.storeCartVariable, cartString);\n\t\t\tsetBounceCookie();\n\t\t} else if (storedCart.items && storedCart.items.length) {\n\t\t\tvar lastItemLength = JSON.stringify(storedCart.items[storedCart.items.length-1]).length;\n\t\t\tif ( lastItemLength >= this.config.maxVariableSize) {\n\t\t\t\tstoredCart.items.pop();\n\t\t\t} else {\n\t\t\t\tstoredCart.items.shift();\n\t\t\t}\n\t\t\tthis.checkAndSetVar(storedCart);\n\t\t}\n\t},\n\n\ttrack: function(cart) {\n\t\tvar trackCart = bouncex.util.mergeObject(cart);\n\t\tif (trackCart.items) trackCart.items = JSON.stringify(trackCart.items);\n \t\tif (trackCart.ids) trackCart.ids = trackCart.ids.join(',');\n\t\ttrackCart = bouncex.util.addNamespace(trackCart, 'cart');\n\t\tbouncex.push(['cart', trackCart]);\n\t},\n\n\t// update: function (cart) {\n\t// \tif (this.replenishing){\n\t// \t\t/* don't fire cart events while replenishing */\n\t// \t\treturn false;\n\t// \t}\n\n\t// \tif (cart.newItem) {\n\t// \t\t//if partial, merge new item with stored items\n\t// \t\tvar oldCart = this.getCart();\n\t// \t\tconsole.log(oldCart);\n\t// \t\tvar allItems = oldCart.items || [];\n\t// \t\tallItems.push(cart.newItem);\n\t// \t\tconsole.log(allItems);\n\t// \t\tcart.items = allItems;\n\t// \t}\n\n\t// \t// remove items from beginning of items array if over limit\n\t// \tif (this.config.maxItems && cart.items && cart.items.length > this.config.maxItems) {\n\t// \t\tcart.items = cart.items.slice(cart.items.length - this.config.maxItems);\n\t// \t}\n\n\t// \t//set count\n\t// \tcart.count = this.inferCount(cart);\n\n\t// \t//auto parse ids from items variable if no ids specified\n\t// \tif (!cart.ids && cart.items) {\n\t// \t\tvar ids = [];\n\t// \t\tfor (var i = 0; i < cart.items.length; i++) {\n\t// \t\t\tif (cart.items[i].id) {\n\t// \t\t\t\tids.push(cart.items[i].id);\n\t// \t\t\t}\n\t// \t\t}\n\t// \t\tif (ids.length) { cart.ids = ids; }\n\t// \t}\n\n\t// \tif (cart.newItem || cart.addToCart){\n\t// \t\tbouncex.push(['add to cart', bouncex.utk.getMetadata()]);\n\t// \t}\n\t\t\n\t// \tdelete cart.newItem;\n\t// \tdelete cart.addToCart;\n\t// \t// save in cart.state, and in cvar if specified\n\t// \tthis.save(cart);\n\t// \t//track cart\n\t// \tthis.track(cart);\n\t// \t//fire add to cart event if new item or addToCart flag\n\t// },\n\n\tvalidateReplenishment: function(cart) {\n\t\tvar cartCount = bouncex.utk.cart.getCount();\n\t\tif (bouncex.util.isValidInteger(cartCount) && cartCount > 0) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!cart) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!cart.value && !cart.token && !cart.items) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\treportReplenishment: function() {\n\t\tvar bx_replen = bouncex.util.getParam('bx_replen');\n\t\tif (bx_replen) {\n\t\t\tsetTimeout(function(){\n\t\t\t\tvar cartCount = bouncex.utk.cart.getCount();\n\t\t\t\tbouncex.push(['cart replenish', {'cart:count': cartCount, 'cart:success': cartCount > 0}]);\n\t\t\t}, 1100);\n\t\t}\n\t}\n};\n\n// TRACKING\n\nbouncex.utk.cart.inferCount = function(cart) {\n\tif (bouncex.util.isValidInteger(cart.count)) {\n\t\treturn parseInt(cart.count);\n\t} else if (cart.items) {\n\t\tvar count = 0;\n\t\tfor (var i = 0; i < cart.items.length; i++) {\n\t\t\t// need to loop through each sku qty\n\t\t\tvar skus = cart.items[i].skus;\n\t\t\tfor(var j=0; j< skus.length; j++){\n\t\t\t\tvar qty = 1;\n\t\t\t\tif(parseInt(skus[j].qty) === 0){\n\t\t\t\t\tqty = 0;\n\t\t\t\t}else{\n\t\t\t\t\tqty = parseInt(skus[j].qty) || 1;\n\t\t\t\t}\n\t\t\t\tcount += qty;\n\t\t\t}\t\n\t\t}\n\t\treturn count;\n\t}else if (bouncex.util.isValidInteger(this.getCount())){\n\t\treturn parseInt(this.getCount());\n\t}else{\n\t\treturn 0;\n\t}\n};\n\nbouncex.utk.cart.update = function (cart) {\n\t\tif (this.replenishing){\n\t\t\t/* don't fire cart events while replenishing */\n\t\t\treturn false;\n\t\t}\n\n\t\tif (cart.newItem) {\n\t\t\tvar oldCart = this.getCart();\n\t\t\tvar allItems = oldCart.items || [];\n\t\t\tvar pushed = false;\n\t\t\tfor(var i = 0; i < allItems.length; i++){\n\t\t\t\tif(allItems[i].id === cart.newItem.id){\n\t\t\t\t\tallItems[i].skus.push(cart.newItem.skus[0]);\n\t\t\t\t\tpushed = true;\n\t\t\t\t}\n\t\t\t}\t\t\n\t\t\n\t\t\tif(pushed === false){\n\t\t\t\tallItems.push(cart.newItem);\n\t\t\t}\n\t\t\tcart.items = allItems;\n\t\t}\n\n\t\t//set count\n\t\tcart.count = bouncex.utk.cart.inferCount(cart);\n\n\t\t// remove items from beginning of items array if over limit\n\t\tif (this.config.maxItems && cart.items && cart.items.length > this.config.maxItems) {\n\t\t\tcart.items = cart.items.slice(cart.items.length - this.config.maxItems);\n\t\t}\n\n\t\t//auto parse ids from items variable if no ids specified\n\t\tif (!cart.ids && cart.items) {\n\t\t\tvar ids = [];\n\t\t\tfor (var i = 0; i < cart.items.length; i++) {\n\t\t\t\tif (cart.items[i].id) {\n\t\t\t\t\tids.push(cart.items[i].id);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (ids.length) { \n\t\t\t\tcart.ids = ids; \n\t\t\t}\n\t\t}\n\n\t\tif (cart.newItem || cart.addToCart){\n\t\t\tbouncex.push(['add to cart', bouncex.utk.getMetadata()]);\n\t\t}\n\t\tdelete cart.newItem;\n\t\tdelete cart.addToCart;\n\t\t// save in cart.state, and in cvar if specified\n\t\tthis.save(cart);\n\t\t//track cart\n\t\tthis.track(cart);\n\t\t//fire add to cart event if new item or addToCart flag\n};\n\nbouncex.utk.getPageType = function() {\n\tif (jQuery('.pt_product-details').length > 0) {\n\t\treturn 'product';\n\t}\n\tif (jQuery('.pt_product-search-result').length > 0 || jQuery('.pt_product-search-noresult').length > 0) {\n\t\tif(window.location.pathname.indexOf('search') > -1){\n\t\t\treturn 'search';\n\t\t}else{\t\t\n\t\t\treturn 'category';\n\t\t}\n\t}\n\n\tif(window.location.href.indexOf('cart') > -1){\n\t\treturn 'cart';\n\t}\n};\n\nbouncex.utk.miw = function(obj) {\n\t\tvar defaults = {\n\t\t\tselector: 'input:not(input[type=button], :input[type=submit], :input[type=reset], :input[type=hidden], :input[type=radio], :input[type=checkbox], :input[type=image], :input[type=password], :input#dwfrm_wishlist_search_email)',\n\t\t\tgetUserData: function(el) {\n\t\t\t\treturn {\n\t\t\t\t\temail : jQuery(el).val(),\n\t\t\t\t\tsource : el.id,\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\n\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\t\tif (!obj.selector) { return null; }\n\n\t\t//register the tracker\n\t\tobj.stop = removeUserTracking;\n\t\tvar trackerId = bouncex.utk.register(obj);\n\n\t\tfunction onBlur() {\n\t\t\tvar user = obj.getUserData(this);\n\t\t\tbouncex.utk.trackUser(user);\n\t\t}\n\n\t\tfunction removeUserTracking() {\n\t\t\tjQuery(document).off('blur.miw.' + trackerId, obj.selector);\n\t\t}\n\n\t\tjQuery(document).on('blur.miw.' + trackerId, obj.selector, onBlur);\n\n\t\treturn trackerId;\n\t},\n\nbouncex.utk.getOldCount = function(){\n\treturn bouncex.utk.cart.getCart().count || 0;\n}\n\nbouncex.utk.autoUpdate = function(cart){\n\tvar currentCount = cart.count;\n\tvar oldCount = bouncex.utk.getOldCount();\n\n\tif (bouncex.util.isValidInteger(currentCount) && currentCount != oldCount){\n\t\tif(currentCount > oldCount){\n\t\t\tcart.addToCart = true;\n\t\t}\n\t\tbouncex.utk.cart.update(cart);\n\t}\n\tthis.oldCount = currentCount;\n};\n\nbouncex.utk.trackListPage = function(obj){\n\t\tvar defaults = {\n\t\t\teventName: 'view ' + this.getPageType(),\n\t\t\tmaxItems: 6,\n\t\t\tselector: '',\n\t\t\ttitle: '',\n\t\t\turl: this.getPageType() === 'category' ? (window.location.href.indexOf('?') > -1 ? window.location.href.split('?')[0] : window.location.href) : (this.getPageType() === 'search' ? window.location.href : jQuery('link[rel=canonical]').attr('href')),\n\t\t\titemTracking : false,\n\t\t\tgetItemData: function(el) { return null;},\n\t\t\textraEventData: {}\n\t\t};\n\n\t\tobj = bouncex.util.mergeObject(defaults, obj);\n\n\t\tvar items = jQuery(obj.selector);\n\t\tif (!items || !items.length){\n\t\t\treturn false;\n\t\t}\n\t\tvar itemsTracked = 0;\n\t\tvar itemIds = [];\n\t\tfor (var i = 0; i < items.length && itemsTracked < obj.maxItems; i++) {\n\t\t\tvar item = obj.getItemData(items[i]);\n\t\t\tif (item.id){\n\t\t\t\tif (typeof(item.id) === 'string'){\n\t\t\t\t\titem.id = item.id.trim().toLowerCase();\n\t\t\t\t}\n\t\t\t\t// add id to list\n\t\t\t\titemIds.push(item.id);\n\t\t\t\tif (obj.itemTracking){\n\t\t\t\t\t//track full item\n\t\t\t\t\tthis.trackItem(item);\n\t\t\t\t}\n\t\t\t\titemsTracked++;\n\t\t\t}\n\t\t}\n\n\t\tvar o = {'items:ids' : itemIds.join(','), 'page:url' : obj.url};\n\t\tif (obj.title){\n\t\t\to['page:title'] = obj.title;\n\t\t}\n\t\to = this.addMetadata(o);\n\t\to = bouncex.util.mergeObject(o, obj.extraEventData);\n\t\tbouncex.push([obj.eventName, o]);\n\t},\n\n\nbouncex.utk.parseLatestCart = function(){\n\tvar cart = {count: 0, items: []};\n\tif(jQuery('.cart-row').length > 0){\n\t\tvar items = jQuery('.cart-row');\n\t\tfor(var i = 0; i<items.length; i++){\n\t\t\tvar item = items.eq(i);\n\t\t\tvar id = item.find('.name a').attr('href').split('.com/')[1].split('/')[0];\n\t\t\tid = normalizeId(id);\n\t\t\tvar prodId = item.find('.sku .value').text();\n\t\t\tvar qty = Number(item.find('.item-quantity .input-text').val());\n\t\t\tvar skuInfo = {\n\t\t\t\tprodId: prodId,\t\t  \t\t\t\t\n\t\t\t\tqty: qty\n\t\t\t};\n\t\t\tvar pushed = false;\n\t\t\tfor(var k = 0; k < cart.items.length; k++){\n\t\t\t\tif(cart.items[k].id === id){\n\t\t\t\t  pushed = true;\n\t\t\t\t  cart.items[k].skus.push(skuInfo);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(pushed === false) cart.items.push({id: id,skus: [skuInfo]});\n\t\t\tcart.count += qty;\t\n\t\t}\n\t}\n\tbouncex.utk.autoUpdate(cart);\n};\n\nvar payloads = [];\nbouncex.utk.replenItem = function(items, pointer){\n\tvar skus = items[pointer].skus; \n\tfor(var i =0; i < skus.length; i++){\n\t\tvar payload = {\n\t\t\tQuantity: skus[i].qty,\n\t\t\tpid: (skus[i].prodId),\n\t\t\tuuid: '',\n\t\t\tcartAction: 'update'\n\t\t};\n\t\tpayloads.push(payload);\n\t}\n\tpointer++;\n    if(items.length > pointer){\n      bouncex.utk.replenItem(items, pointer);\n    }else{\n    \tbouncex.utk.callCartReplen(payloads, 0);\n    };\n};\n\nbouncex.utk.callCartReplen = function(payloads, pointer){\n\tvar payload = payloads[pointer];\n\t$.ajax({\n    \turl: window.location.protocol+\"//www.aeropostale.com/on/demandware.store/Sites-aeropostale-Site/en_US/Cart-AddProduct?format=ajax\",\n    \tmethod: \"POST\",\n    \tdata: payload\n  \t}).complete(function(){\n  \t\tpointer++;\n  \t\tif(payloads.length > pointer){\n      \t\tbouncex.utk.callCartReplen(payloads, pointer);\n    \t}else{\n      \t\twindow.location.href = 'https://www.aeropostale.com/cart/?bx_replen=true';\n    \t};\n  \t});\n};\n\nbouncex.utk.trackItemInteraction = function(obj) {\n\tvar id = obj.item.id;\n\tif (typeof(id) === 'string'){\n\t\tid = id.trim().toLowerCase();\n\t}\n\tvar o = { 'item:id': id };\n\tvar itemgroupid = obj.item.itemgroupid; \n\tif (typeof(itemgroupid) === 'string' && obj.eventName === 'view item'){\t\t\t\n\t\titemgroupid = itemgroupid.trim()\n\t\to['item:itemgroupid'] = itemgroupid;\n\t}\t\n\to = this.addMetadata(o);\n\tbouncex.push([obj.eventName, o]);\n}\nbouncex.utk.trackItem = function(item) {\n\tif (typeof(item.id) === 'string'){\n\t\titem.id = item.id.trim().toLowerCase();\n\t}\n\n\tif (!this.validateItem(item)) {\n\t\t//bouncex.log('item failed validation', item);\n\t\treturn false;\n\t}\n\titem = bouncex.util.addNamespace(item, 'item');\n\titem[\"item:itemgroupid\"] ? delete item[\"item:itemgroupid\"] : false\n\tbouncex.push(['item', item]);\n}\n\n\nfunction getQuickViewId(){\n\tif(jQuery('#QuickViewDialog:visible').find('.show-detail-link a').length > 0){\n\t\treturn normalizeId(jQuery('#QuickViewDialog:visible').find('.show-detail-link a').attr('href').split('/')[1].split('/')[0]);\n\t}\n\treturn false;\n}\n\nfunction getQuickViewGroupId(){\n\tif(jQuery('#QuickViewDialog:visible').find('#masterProductId').length >0){\n\t\treturn jQuery('#QuickViewDialog:visible').find('#masterProductId').val();\n\t}\n\treturn false;\n}\n\nbouncex.utk.skuTrack = function(){\n\tvar lastSKU = window.utag_data && window.utag_data.product_sku && window.utag_data.product_sku[0];\n\tvar lastId = false;\n\treturn function() {\n\t\tvar sku = window.utag_data && window.utag_data.product_sku && window.utag_data.product_sku[0];\n\t\tvar id = bouncex.utk.getPageType() === 'product' ? normalizeId(jQuery('link[rel=\"canonical\"]').attr('href').split('/')[1].split('/')[0]) : getQuickViewId();\n\t\tvar groupid = bouncex.utk.getPageType() === 'product' ? jQuery('#masterProductId').val() : getQuickViewGroupId();\n\t\tif(id && lastId && lastId !== id){\n\t\t\tsku = lastSKU;\n\t\t\tlastId = id;\n\t\t}\n\t\tif(!lastSKU){\n\t\t\tlastSKU = sku ? sku : true;\n\t\t}\n\n\t\tif (sku && id && sku !== lastSKU && sku !== id) {\n\t\t\tlastSKU = sku;\n\t\t\tlastId = id;\n\t\t\tbouncex.push(['select_sku', {\n\t\t\t\t'item:id': id,\n\t\t\t\t'item:itemgroupid': groupid,\n\t\t\t\t'item:feedid': sku\n\t\t\t}]);\n\t\t}\n\t };\n}\n\nbouncex.utk.init = function() {\n\tbouncex.utk.stopAll();\n\tbouncex.utk.miw();\n\tbouncex.utk.muu();\n\n\tvar pageType = bouncex.utk.getPageType();\n\n\tbouncex.utk.cart.init({\n\t\tstoreCartVariable: 'cart',\n\t\tcartCountVariable: 'cart_quantity',\n\t\tmaxVariableSize: 800,\n\t\tstoreValues: ['count', 'items'],\n\t\tmaxItems: 10,\n\t\treplenish: function(cart) {\n\t\t\tbouncex.utk.replenItem(cart.items, 0);\n\t\t},\n\t});\n\n\tif(pageType === 'product'){\n\t\tvar itemgroupid =jQuery('#masterProductId').val();\n\t\tbouncex.utk.viewItem({\n\t\t\tgetItemData: function() {\n\t\t\t\tvar $itemSizes = jQuery(\".tabs-content a.element\");\n\t\t\t\treturn {\n\t\t\t\t\tid: getItemId(),\n\t\t\t\t\tcopy: jQuery('h1.product-name').text() || jQuery(\".breadcrumb-element.last\").text(),\n\t\t\t\t\timageurl: jQuery(\".slider-element a.product-image\").first().attr(\"href\"),\n\t\t\t\t\tcategory: jQuery('.breadcrumb a.breadcrumb-element').last().text().trim(),\n\t\t\t\t\turl: window.location.href.indexOf(\".html?\") > -1 ? window.location.href.split('?')[0] : window.location.href,\n\t\t\t\t\tinstock: $itemSizes.length > $itemSizes.filter(\".unavailable\").length || jQuery(\".swatchanchor\").length > 0,\n\t\t\t\t\titemgroupid: itemgroupid\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t\tbouncex.utk.setInterval({ callback : bouncex.utk.skuTrack() });\n\t\t\n\t}\n\n\tif(pageType === 'category' || pageType === 'search'){\n\t\tfunction getItemData (el){\n\t\t\tvar j = jQuery(el);\n\t\t\tvar id = j.find('a.thumb-link').attr('href').split('.com/')[1].split('/')[0];\n\t\t\treturn{\n\t\t\t\tid: normalizeId(id)\n\t\t\t};\n\t\t}\n\n\t\tfunction getQuickViewItemData(el){\n\t\t\tvar j = jQuery(el);\n\t\t\tvar id = j.find('.show-detail-link a').attr('href').split('/')[1].split('/')[0];\n\t\t\treturn{\n\t\t\t\tid: normalizeId(id)\n\t\t\t};\n\t\t}\n\n\t\tif(jQuery('.pt_product-search-result').length > 0){\n\t\t\tbouncex.utk.trackListPage({\n\t\t\t\tselector: '.product-tile',\n\t\t\t\ttitle: pageType === 'search' ? jQuery('.breadcrumb-element.breadcrumb-result-text a').first().text() : jQuery('a.breadcrumb-element').last().text(), \n\t\t\t\tgetItemData: getItemData,\n\t\t\t});\n\t\t\n\t\t}\n\t\tbouncex.utk.hoverItem({\n\t\t\tselector: '.product-tile',\n\t\t\tgetItemData: getItemData\n\t\t});\n\n\t\tbouncex.et.onVisible('#QuickViewDialog', function(el){\n\t\t\tvar id = getQuickViewItemData(el),\n\t\t\titemgroupid =jQuery('#masterProductId').val();\n\t\t\tbouncex.push(['view item', {\n\t\t\t\t'item:id' : id.id,\n\t\t\t\t'item:itemgroupid': itemgroupid\n\t\t\t}]);\t\n\t\t});\n\t\tbouncex.utk.setInterval({ callback : bouncex.utk.skuTrack() });\n\t}\n\n\tif(pageType === 'cart'){\n\t  \tbouncex.utk.parseLatestCart();\n\t}\n\n\tjQuery(document).ajaxComplete(function(event, xhr, settings){\n\t\tvar itemInfo = {};\n\t\tif((settings.url.indexOf('/Cart-AddProduct?format=ajax') > -1) && pageType !== 'cart'){\n\t\t\tvar name = event.delegateTarget.activeElement.name\n\t\t\tvar id = (window.location.href.indexOf('wishlist') > -1) ? jQuery('button[name='+name+']').parents().find('a.wl-action-link').attr('href').split('/')[1].split('/')[0] :( (pageType === 'category' || pageType === 'search') ? normalizeId(jQuery('.show-detail-link a').attr('href').split('/')[1].split('/')[0]) : getItemId());\n\t\t\tvar data = settings.data;\n\t\t\tvar prodId = data.split('pid=')[1];\n\t\t\tprodId = prodId.indexOf('&') > -1 ? prodId.split('&')[0] : prodId;\n\t\t\tvar qty = data.split('Quantity=')[1];\n\t\t\tqty = qty.indexOf('&') > -1 ? qty.split('&')[0] : qty;\n\t\t\titemInfo = {id: normalizeId(id) , skus: [{prodId: prodId, qty: Number(qty)}]};\n\t\t\tbouncex.utk.cart.update({\n\t\t\t    newItem: itemInfo\n\t\t\t});\n\t\t};\n\t});\n};\n\nbouncex.utk.init();\t\t\n\n\nif(bouncex.vars.logged_in && bouncex.vars.logged_in_identified === false){\n\tuser = {};\n\tuser.email = window.utag_data.customer_email;\n\tbouncex.utk.trackUser(user);\n\tbouncex.setv(\"logged_in_identified\", true);\n\tsetBounceCookie();\n}\n\nfunction getItemId() {\n    var url = jQuery('link[rel=\"canonical\"]').attr('href') ||\n            jQuery(\"[itemprop='url']\").text() ||\n            window.location.href ||\n            \"\",\n        allParams = url.split('.com/')[1] || \"\",\n        stringedId = allParams.split('/')[0] || \"\";\n\n    return normalizeId(stringedId)\n}\n\nfunction normalizeId(str) {\n\treturn decodeURI(str).normalize('NFKD')\n\t\t\t\t\t\t\t\t\t\t\t .replace(/[^\\w]/g, '_').toLowerCase()\n\t\t\t\t\t\t\t\t\t\t\t .replace(/\\s+/g, '_');\n\n}","cjs":"","miw":0,"mibcx":1,"te":1,"cart_rep":{"get":"","set":""},"ulpj":{"bxid":"espemailid"},"cus":"","miw_exclude":""},"etjson":null,"osre":true,"osru":"osr.bounceexchange.com/v1/osr/items","checkDfp":false,"spa":0,"spatm":1,"preinit_cjs":"","mat":0,"math":0,"cpnu":"coupons.bounceexchange.com","dfpcms":0,"sms":{"optm":"","eventSharing":false,"shqId":""},"pde":true,"fme":false,"fmx":"","sdk":{"android":false,"ios":false,"javascript":false}}
;
		bouncex.tag = 'tag3';
		bouncex.$ = window.jQuery;
		bouncex.env = 'production';
		bouncex.restrictedTlds = {"casl":{"ca":1},"gdpr":{"ad":1,"al":1,"at":1,"ax":1,"ba":1,"be":1,"bg":1,"by":1,"xn--90ais":1,"ch":1,"cy":1,"cz":1,"de":1,"dk":1,"ee":1,"es":1,"eu":1,"fi":1,"fo":1,"fr":1,"uk":1,"gb":1,"gg":1,"gi":1,"gr":1,"hr":1,"hu":1,"ie":1,"im":1,"is":1,"it":1,"je":1,"li":1,"lt":1,"lu":1,"lv":1,"mc":1,"md":1,"me":1,"mk":1,"xn--d1al":1,"mt":1,"nl":1,"no":1,"pl":1,"pt":1,"ro":1,"rs":1,"xn--90a3ac":1,"ru":1,"su":1,"xn--p1ai":1,"se":1,"si":1,"sj":1,"sk":1,"sm":1,"ua":1,"xn--j1amh":1,"va":1,"tr":1}};
		bouncex.assets = {"creativesBaseStyles":"d63dbc50"};
		bouncex.push = function(pushData) {
			bouncex.pushedData.push(pushData);
		}
		var script = document.createElement('script');
		script.setAttribute('src', '//assets.bounceexchange.com/assets/smart-tag/versioned/ijs_all_modules_cjs_min_f0af7f2eb5df5e03c3dd565f9ccccd5a.js');

		var scriptAttrs = [{"Key":"id","Value":"c.js"},{"Key":"async","Value":"true"},{"Key":"data-apikey","Value":"2^HIykD"},{"Key":"data-cb","Value":"bouncex.dg.initPostDeviceGraph"},{"Key":"data-bx","Value":"1"},{"Key":"data-gm","Value":"1"},{"Key":"data-fire","Value":"1"}];
		if (scriptAttrs) {
			for (var i = 0; i < scriptAttrs.length; i++) {
				script.setAttribute(scriptAttrs[i].Key, scriptAttrs[i].Value);
			}
		}

		document.body.appendChild(script);
	}

  
}
if (document.readyState === "loading") {
	document.addEventListener("DOMContentLoaded", bxBootstrap);
} else {
	bxBootstrap();
}})();