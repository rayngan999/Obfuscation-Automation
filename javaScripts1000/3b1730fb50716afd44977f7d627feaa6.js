!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Paywall=t():e.Paywall=t()}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,n){s&&e.trigger(l.SET_EVENT,{IDEvolok:n.pid,productoEvolok:n.meter,nPaginasConsumidas:n.count,nPaginasPermitidas:n.max,autorizacionContenido:n.result,idCookieEvolok:n.cookie}),t.initialized=s=!0,e.promised(l.READY_PROMISE_NS,n),n.result&&n.result.length&&e.when(l.GIGYA_READY).then(function(t){if("anonimo"===t.getUserType()){var o={};u.default.init({authData:t,userProducts:o,config:n,app:e})}else e.when(l.GIGYA_PRODUCTS_READY).then(function(o){u.default.init({authData:t,userProducts:o,config:n,app:e})})})}Object.defineProperty(t,"__esModule",{value:!0}),t.initialized=t.VERSION=void 0;var i=n(1),a=o(i),c=n(2),u=o(c),l=n(6);Voonto.ready.then(function(e){e.on(l.PAYWALL_CONTENT,function(){var t=e.lookup(l.CONFIG_NAMESPACE);r(e,t)}),e.lookup("vocento.config.paywall").enabled?e.trigger(l.PAYWALL_CONTENT):t.initialized=s=!0,e.on("voonto:reload",function(){e.trigger(l.PAYWALL_CONTENT)})});var s=(t.VERSION=a.default.version,t.initialized=!1)},function(e,t){e.exports={name:"paywall",version:"1.5.0",description:"Vocento Paywall",main:"src/index.js",scripts:{start:"./node_modules/.bin/webpack-dev-server",build:"./node_modules/.bin/webpack",report:"plato -r -d report -l .jshintrc -t paywall src"},author:"IvÃ¡n PÃ©rez <ivanperez@vocento.com>",license:"SEE LICENSE IN LICENSE.md",devDependencies:{"babel-core":"^6.17.0","babel-loader":"^6.2.5","babel-polyfill":"^6.16.0","babel-preset-es2015":"^6.16.0",case:"^1.4.2",chai:"^3.5.0",chalk:"^1.1.3","html-webpack-plugin":"^2.24.1","js-cookie":"^2.1.3","json-loader":"^0.5.4",mocha:"^3.1.0","mocha-loader":"^1.0.0","parse-url":"^1.3.5",webpack:"^1.13.2","webpack-dev-server":"^1.16.2","webpack-shell-plugin":"^0.4.3"}}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(3),c=o(a),u=function(){function e(){r(this,e)}return i(e,null,[{key:"init",value:function(){this.alerts=c.default.createAlerts.apply(c.default,arguments),this.alerts.sort(function(e,t){return e.priority-t.priority});for(var e=0;e<this.alerts.length;e++){var t=this.alerts[e];if(t.show()&&t.final===!0)break}}}]),e}();t.default=u},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ALERT_TYPES=void 0;var r=n(4),i=o(r),a=n(7),c=o(a),u=n(8),l=o(u),s="",f=window.vocento.__PROVIDER__.paywall.rtimWall;s=f===!0?{"multi-session":i.default}:{"multi-session":i.default,"n-left-content":c.default,"last-content":l.default};var p=t.ALERT_TYPES=s,d=Object.freeze({createAlerts:function(){var e=arguments;return Object.keys(p).map(function(t){if(!p.hasOwnProperty(t))throw Error("[Paywall] alert type not found");return new(Function.prototype.bind.apply(p[t],[null].concat(Array.prototype.slice.call(e))))})}});t.default=d},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(5),l=o(u),s=n(6),f="[data-voc-pw-concurrent-session]",p=Voonto,d=p.$,_=function(e){function t(){var e;r(this,t);var n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this,f].concat(Array.prototype.slice.call(arguments))));return n.priority=-4,n.final=!0,n}return a(t,e),c(t,[{key:"show",value:function(){var e=d(f);e.length&&e.is(":visible")&&this.concurrentSessionLimit()&&(e.show(),l.default.canNotViewContent(),this._logout())}},{key:"_logout",value:function(){Voonto.getInstance().when(s.GIGYA_READY).then(function(e){return e.logout({reloadOnLogout:!1})})}}]),t}(l.default);t.default=_},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(6),a=Voonto,c=a.$,u=function(){function e(t,n){var r=n.config;o(this,e),this.priority=0,this.final=!1,this.config=r,this.container$=c(i.VIDEO_PLAYER_CONTAINER).find(t).length?c(i.VIDEO_PLAYER_CONTAINER).find(t):c(t).eq(0)}return r(e,[{key:"isViewed",value:function(){return"true"===this.config.viewed}},{key:"isMeterExceeded",value:function(){return this.config.meterExceeded&&this.config.meterExceeded.length>0}},{key:"isExtra",value:function(){return"true"===this.config.isExtra}},{key:"concurrentSessionLimit",value:function(){return(""+this.config.concurrentSessionLimit).trim()}},{key:"replaceContent",value:function(e){if(c(i.VIDEO_PLAYER_MODAL_CONTAINER,i.VIDEO_PLAYER_CONTAINER).length){e&&c(i.VIDEO_PLAYER_CONTENT_TO_HIDE,i.VIDEO_PLAYER_CONTAINER).remove();var t=c('<div class="wrapper"></div>');c(i.VIDEO_PLAYER_MODAL_CONTAINER,i.VIDEO_PLAYER_CONTAINER).append(t),t.append(this.container$)}else e?c(i.CONTENT_CONTAINER).html(this.container$):c(i.CONTENT_CONTAINER).append(this.container$)}},{key:"show",value:function(){var e=this;c(i.CLOSE_BUTTON,this.container$).on("click",function(t){t.preventDefault(),e.container$.hide()}),this.replaceContent(),this.container$.show()}}],[{key:"canNotViewContent",value:function(){c("div[data-voc-arrows-display]").remove(),c(".wrapper.voc-story").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"}),c("body").addClass("no-scroll")}}]),e}();t.default=u},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ALLOW_ACCESS="ALLOW_ACCESS",t.CLOSE_BUTTON="[data-voc-pw-close]",t.CONFIG_NAMESPACE="vocento.__PROVIDER__.paywall",t.CONTENT_CONTAINER="[data-voc-pw-layer]",t.COOKIE_DOMAIN="."+window.__VOONTO__.lookup("vocento.site").tlddomain,t.COOKIE_TRIAL_VIEWED_NAME="trialViewed",t.COOKIE_TRIAL_VIEWED_VALUE="alreadyViewed",t.COOKIE_TRIAL_PRESCRIPTION="voc_trial",t.EVOLOK_SESSION_CHECK_PATH="/ev_session_check/",t.PAYWALL_CONTENT="paywall:content",t.READY_PROMISE_NS="paywall:ready",t.SET_EVENT="vtm:set",t.ANONIMOUS_USER="anonimo",t.GIGYA_DATA_READY="vocuser:accountsondataready",t.GIGYA_PRODUCTS_READY="vocuser:productsonready",t.GIGYA_READY="vocuser:ready",t.REGISTER_USER="registrado",t.TRIAL_USER="trial",t.VIDEO_PLAYER_CONTAINER="#voc-video-player-modalcontainer",t.VIDEO_PLAYER_CONTENT_TO_HIDE="[data-voc-pw-content-to-hide]",t.VIDEO_PLAYER_MODAL_CONTAINER=".modal-content"},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(o)},l=n(5),s=o(l),f="[data-voc-pw-news-left]",p="[data-voc-pw-one-news]",d="[data-voc-pw-n-news]",_=[3,2,1],y=Voonto,v=y.$,E=function(e){function t(){var e;r(this,t);var n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this,f].concat(Array.prototype.slice.call(arguments))));return n.priority=-1,n.final=!0,n}return a(t,e),c(t,[{key:"show",value:function(){var e=parseInt(this.config.max),n=parseInt(this.config.count),o="true"===this.config.isExtra,r="true"===this.config.viewed,i=e-n,a=this._getDaysToAlert();return n>0&&i>0&&!o&&a.indexOf(i)!==-1&&!r&&(i>1?(v(d,this.container$).find("span:first").html(i),v(d,this.container$).show()):v(p,this.container$).show(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"show",this).call(this),!0)}},{key:"_getDaysToAlert",value:function(){if(this.config.daysToAlertSteps)try{var e=JSON.parse(this.config.daysToAlertSteps);return e.default===!0?_:Object.keys(e).map(function(e){return parseInt(e)})}catch(e){return[]}return _}}]),t}(s.default);t.default=E},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(o)},l=n(5),s=o(l),f="[data-voc-pw-last-news]",p=function(e){function t(){var e;r(this,t);var n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this,f].concat(Array.prototype.slice.call(arguments))));return n.priority=0,n.final=!0,n}return a(t,e),c(t,[{key:"show",value:function(){var e=parseInt(this.config.max),n=parseInt(this.config.count),o=e-n;return"false"===this.config.isExtra&&!this.isViewed()&&0===o&&!this.isMeterExceeded()&&(u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"show",this).call(this),!0)}}]),t}(s.default);t.default=p}])});
//# sourceMappingURL=paywall.js.map