"use strict";var customerId,datahub_config={amplitude:!0},wuSessionStorage=window.sessionStorage,previousPageName=null,oldURL="",oldPageName="",oldCountryCode="",oldFundsOut="",oldFundsIn="",src_parameter=sessionStorage.getItem("src_code")?sessionStorage.getItem("src_code"):getUrlParameter("src"),ampUTMObj=getAmplitudeUTMParameterCapture(),ampReferrerObj=getAmplitudeReferrer(),hadoopAnalyticsApiEvents={api_CustomerSignOn:"Login completed",api_SendMoneyValidation:"Send money validation completed"},hadoopAnalyticsClickEvents={"clicked_[home]_[button-send-money]":"clicked_[home]_[button-send-money]","clicked_[home]_[button-hero-login_signup]":"clicked_[home]_[button-hero-login_signup]","clicked_[history]_[button-start-new-transfer]":"clicked_[history]_[button-start-new-transfer]","clicked_[session-expired]_[button-login]":"Login attempted"},hadoopAnalyticsPageLoadEvents={page_home:"page_home",page_history:"page_history"};function isFeatureEnabled(e,t){try{var a=JSON.parse(sessionStorage.getItem("featureFlags")||"{}")[e].countries;return"ALL"===a||a.indexOf(t)>-1}catch(e){return!1}}function logEvents(e,t){amplitude.getInstance().logEvent(e,t)}function setUserId(e){amplitude.getInstance().setUserId(e)}function updateWULanguage(){if(getCookieValue("WULanguageCookie_")){var e=getCookieValue("WULanguageCookie_"),t=(new amplitude.Identify).set("wu_language",e);amplitude.getInstance().identify(t)}}function setCookieInMinutes(e,t,a){var r=new Date;r.setTime(r.getTime()+60*a*1e3);var n=e+"="+t+";"+("expires="+r.toUTCString())+";path=/;";-1!==window.location.protocol.indexOf("https")&&(n+="secure;"),document.cookie=n}function getAnalyticsData(){var e={};return Object.assign(e,mandatoryAttributes(),optionalAttributes()),e}function getHadoopAnalyticsEventsData(){var e={};return Object.assign(e,hadoopAnalyticsApiEvents,hadoopAnalyticsClickEvents,hadoopAnalyticsPageLoadEvents),e}function getXHRApiData(e,t,a){if(e&&(-1!==(e=e.replace(/^\//,"")).indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),-1===["CreateSession","GetDatabase"].indexOf(e))){var r={};r=a.error?handleAPIErrorResponse(e,a,t):handleAPISuccessResponse(e,t,a);wuSessionStorage&&-1!==["history","send-money-option","price-estimator"].indexOf(wuSessionStorage.page_name)&&sessionStorage.setItem("wuAmplitude_useSummaryObj",!1),checkNameChangeCancelTransferFlow();var n=getAnalyticsData();sessionStorage.removeItem("wuAmplitude_useSummaryObj"),sessionStorage.removeItem("wuAmplitude_useNameChangeObj"),sessionStorage.removeItem("wuAmplitude_useCancelTransferObj");var o=Object.keys(n);o.sort();for(var s=0;s<o.length;s++)o[s]&&(r[o[s]]=n[o[s]]);sendAnalyticsData(r,t,a,e)}}function getOptimusApiData(e,t,a){if(e){var r={};r=a.error?handleAPIErrorResponse(e,a,t):handleAPISuccessResponse(e,t,a);var n=getAnalyticsData(),o=Object.keys(n);o.sort();for(var s=0;s<o.length;s++)o[s]&&(r[o[s]]=n[o[s]]);"biller.optimus.json",sendAnalyticsData(r,e,a,"biller.optimus.json")}}function checkforSubErrorCode(e){var t=[];try{var a=e&&e.error&&e.error.reasons?e.error.reasons.reason:null;a&&angular.forEach(a,function(e){e&&e.code&&t.push(e.code)})}catch(e){}return t}function handleAPIErrorResponse(e,t,a){var r=checkforSubErrorCode(t),n={api_name:e,api_response_code:t.error.code||"Error code is not available",api_response_message:t.error.message.toLowerCase()||"Error message is not available"};r.length>0&&(n.api_response_child_code=r);var o=sessionStorage.getItem("sof_doc_requested")||null;if(n.sof_doc_requested=o&&1==JSON.parse(sessionStorage.getItem("sof_doc_requested"))?"y":"n","FeeInquiryEstimated"===e&&(sessionStorage.removeItem("wuAmplitudeSMO_sendReceiveLock"),getSendReceiveLock(a),getSMOReceiverCountry(a),getSMOFundsOut(),getSMOFundsIn(),getBiller(a),getSendAmount(a)),"SendMoneyStore"===e&&"C2001"===t.error.code&&t.sender&&t.sender.kycDetails){n.kyc_option=Object.getOwnPropertyNames(t.sender.kycDetails).join();var s=n.kyc_option.split(","),i=s.indexOf("pbv");-1!==i&&s.splice(i,1);Object.getOwnPropertyNames(t.sender.kycDetails).join();t.sender.kycDetails.pbv&&t.sender.kycDetails.pbv.deliveryMethods&&t.sender.kycDetails.pbv.deliveryMethods.voiceDelivery&&s.unshift("pbv-voice"),t.sender.kycDetails.pbv&&t.sender.kycDetails.pbv.deliveryMethods&&t.sender.kycDetails.pbv.deliveryMethods.smsDelivery&&s.unshift("pbv-sms"),t.sender.kycDetails.pbv&&t.sender.kycDetails.pbv.deliveryMethods&&t.sender.kycDetails.pbv.deliveryMethods.emailDelivery&&s.unshift("pbv-email"),n.kyc_option=s.join(",")}if("SendMoneyStore"===e&&_.has(t,"sender.kycDetails.duc.ducDelivery.ducDocuments.ducDocument")){var u=t.sender.kycDetails.duc.ducDelivery.ducDocuments.ducDocument.map(function(e){return"ID"===e.docType?e.docType+"-"+e.type:e.docType});0!=u.length&&(sessionStorage.setItem("wuAmplitude_kycDocTypes",u),n.kyc_doc_count=u.length,n.kyc_doc_type=u)}if("VerifyCustomer"===e&&t&&sessionStorage.getItem("wuAmplitude_kycDocTypes")&&sessionStorage.removeItem("wuAmplitude_kycDocTypes"),_.has(a,"payment_details.credit_debit_card.cardinal_info.wu_3ds_version")&&(n.wu3ds_request=a.payment_details.credit_debit_card.cardinal_info.wu_3ds_version,n.cc3ds_request=a.payment_details.credit_debit_card.cardinal_info.cc_3ds_version),_.has(t,"payment_details.credit_debit_card.cardinal_info.wu_3ds_version")&&(n.wu3ds_response=t.payment_details.credit_debit_card.cardinal_info.wu_3ds_version,n.cc3ds_response=t.payment_details.credit_debit_card.cardinal_info.cc_3ds_version),_.has(t,"paymentDetails.creditDebitCard.cardinalInfo.wu_3ds_version")&&(n.wu3ds_response=t.paymentDetails.creditDebitCard.cardinalInfo.wu_3ds_version,n.cc3ds_response=t.paymentDetails.creditDebitCard.cardinalInfo.cc_3ds_version),!("SendMoneyStore"!==e&&"SendMoneyValidation"!==e||"C1974"!==t.error.code&&"C2002"!==t.error.code)){getSMVSMO(e,a,t);t&&t.alternate_payment_types&&t.alternate_payment_types.payment_type&&(n.alt_payment=t.alternate_payment_types.payment_type)}if("SendMoneyStore"===e&&(a&&a.store_type&&(n.store_type=a.store_type.toLowerCase()),a&&a.payment_details&&a.payment_details.card_updater_consent_flag&&(n.card_updater_consent_flag=a.payment_details.card_updater_consent_flag.toLowerCase())),"VerifyCustomer"!==e||"C9003"!==t.error.code&&"C9002"!==t.error.code&&"C9013"!==t.error.code||(n.kyc_option=sessionStorage.getItem("kyc_option")?sessionStorage.getItem("kyc_option"):null,sessionStorage.removeItem("kyc_option"),a&&a.doc_info&&a.doc_info.length>0&&(n.doc_type=a.doc_info[0].dms_doc.doc_type)),"BillerOptimus"===e&&t.error&&"Biller Template"==t.error.code&&(n.api_response_code="NA"),("SendMoneyValidation"===e||"SendMoneyStore"===e)&&t&&t.error&&a&&a.payment_details&&a.payment_details.credit_debit_card&&a.payment_details.credit_debit_card.card_type&&(n.card_type=a.payment_details.credit_debit_card.card_type),"AddCreditCards"===e){var c=JSON.parse(sessionStorage.getItem("wuAmplitude_cardConsentData"));c&&(sessionStorage.removeItem("wuAmplitude_cardConsentData"),n.card_type=c.cardType)}return"UpdateCreditCards"===e&&t&&t.error&&a.gateway_customer&&(n.card_type=_.get(a,"gateway_customer.wallet.credit_debit_cards.credit_debit_card[0].card_type")),n}function setSofToSession(e,t,a){var r=JSON.parse(sessionStorage.getItem("CustomerVerificationStatus"))||{};try{if(_.has(r,"verificationStatus.sender.compliance_details.sourceOfFunds")&&sessionStorage.setItem("sof_doc_requested","true"),_.has(a,"additional_information.param")){var n=a.additional_information.param.filter(function(e){return"sf_doc_requested"==e.type});n&&n[0].value&&sessionStorage.setItem("sof_doc_requested",n[0].value)}}catch(e){console.error(e)}}function removeSofToSession(e,t,a){_.has(a,"moneyTransferControl.mtcn")&&sessionStorage.getItem("sof_doc_requested")&&sessionStorage.removeItem("sof_doc_requested")}function handleEventLogging(e,t){if(!e)return t;if(t){var a={};return["is_id_available","is_id_expired","id_issuing_country","is_dob_present"].forEach(function(t){e[t]&&(a[t]=e[t])}),Object.keys(a).length>0?_.extend(t,a):t}}function handleEventLogging(e,t){if(!e)return t;if(t){var a={};return["is_id_available","is_id_expired","id_issuing_country","is_dob_present"].forEach(function(t){e[t]&&(a[t]=e[t])}),Object.keys(a).length>0?_.extend(t,a):t}}function handleAPISuccessResponse(e,t,a){var r={api_name:e,api_response_code:a.code||0};"SendMoneyValidation"===e&&setSofToSession(e,t,a);var n=sessionStorage.getItem("sof_doc_requested")||null;if(r.sof_doc_requested=n&&1==JSON.parse(sessionStorage.getItem("sof_doc_requested"))?"y":"n",0!==r.api_response_code&&(r.api_response_message=a.message.toLowerCase()||"Response message is not available"),"SendMoneyValidation"===e||"SendMoneyStore"===e){t&&t.store_type&&(r.store_type=t.store_type.toLowerCase()),_.has(t,"payment_details.credit_debit_card.cardinal_info.wu_3ds_version")&&(r.wu3ds_request=t.payment_details.credit_debit_card.cardinal_info.wu_3ds_version,r.cc3ds_request=t.payment_details.credit_debit_card.cardinal_info.cc_3ds_version),_.has(a,"payment_details.credit_debit_card.cardinal_info.wu_3ds_version")&&(r.wu3ds_response=a.payment_details.credit_debit_card.cardinal_info.wu_3ds_version,r.cc3ds_response=a.payment_details.credit_debit_card.cardinal_info.cc_3ds_version),_.has(a,"paymentDetails.creditDebitCard.cardinalInfo.wu_3ds_version")&&(r.wu3ds_response=a.paymentDetails.creditDebitCard.cardinalInfo.wu_3ds_version,r.cc3ds_response=a.paymentDetails.creditDebitCard.cardinalInfo.cc_3ds_version);var o=getSMVSMO(e,t,a);if("SendMoneyValidation"===e&&(a&&a.payment_details&&a.payment_details.paymentTypeIndicator&&(r.payment_mismatch_flag="true"),"CreditCard"!==t.payment_details.payment_type&&"DebitCard"!==t.payment_details.payment_type||!_.get(t,"payment_details.credit_debit_card.card_consent_flag")||(r.card_consent=t.payment_details.credit_debit_card.card_consent_flag.toLowerCase()),"MX"===_.get(t,"receiver.address.country_iso_code")&&"BA"===sessionStorage.getItem("SelectedPayOutOption")&&(r.receiver_account_type=addReceiverAccountTypeForMexico(t.receiver)),_.get(a,"zumigo_session_id")&&(r.zumigo_session_id=a.zumigo_session_id),"IN"===_.get(t,"receiver.address.country_iso_code")&&"BA"===sessionStorage.getItem("SelectedPayOutOption")&&(r.funds_out=setFundsOutUpiAmplitudeData(t.receiver))),"SendMoneyStore"===e)"MX"===_.get(t,"receiver.address.country_iso_code")&&"BA"===sessionStorage.getItem("SelectedPayOutOption")&&(r.receiver_account_type=addReceiverAccountTypeForMexico(t.receiver)),t&&t.payment_details&&t.payment_details.card_updater_consent_flag&&(r.card_updater_consent_flag=t.payment_details.card_updater_consent_flag.toLowerCase()),removeSofToSession(),(k=JSON.parse(sessionStorage.getItem("scheduledReminderObject")))||(r.reminder_enrol=!0,r.reminder_frequency=k.frequency_type.toLowerCase()),"IN"===_.get(t,"receiver.address.country_iso_code")&&"BA"===sessionStorage.getItem("SelectedPayOutOption")&&(r.funds_out=setFundsOutUpiAmplitudeData(t.receiver));Object.assign(r,o)}if("GetLoyaltyCards"===e&&GetLoyaltyCardsCampaigns(a)&&(r.campaignids=GetLoyaltyCardsCampaigns(a)),"FeeInquiryEstimated"===e&&(sessionStorage.removeItem("wuAmplitudeSMO_sendReceiveLock"),getSendReceiveLock(t),getSMOReceiverCountry(t),getSMOFundsOut(),getSMOFundsIn(),getBiller(t),getSendAmount(t)),"TransactionInquiry"===e&&(r["redirectable-flag"]=a.statusDetails.isSenderRedirectable),"CustomerSignOn"===e){a.gatewayCustomer&&a.gatewayCustomer.preferredCustomer&&a.gatewayCustomer.preferredCustomer.accountNbr&&(r.customerSignOnAccountNumber=a.gatewayCustomer.preferredCustomer.accountNbr,sessionStorage.setItem("wuAmplitude_idvstatus",a.gatewayCustomer.identityVerificationStatus));var s=_.get(a,"gatewayCustomer.transactionCount"),i=_.get(a,"gatewayCustomer.lastTransactionDate"),u=_.get(a,"gatewayCustomer.registrationDate");if(s&&(r.total_transactions=s),i){r.last_transaction_date=i;var c=((new Date).getTime()-new Date(i).getTime())/864e5;r.days_since_last_transaction=Math.floor(c)}u&&(r.registration_date=u)}if("CustomerSignOn"!==e&&"RegisterCustomer"!==e||(r.pricing_campaign=t&&t.campaign&&t.campaign.campaign_name?t.campaign.campaign_name:"",r.subscription_id=t&&t.campaign&&t.campaign.subscription_id?t.campaign.subscription_id:"",r.pricing_campaign_response=a&&a.subscription&&a.subscription.campaign_name?a.subscription.campaign_name:"",r.subscription_id_response=a&&a.subscription&&a.subscription.subscription_id?a.subscription.subscription_id:"",r.subscription_expiry_date=a&&a.subscription&&a.subscription.end_date?new Date(a.subscription.end_date).toISOString():""),"SendMoneyValidation"===e&&(r.pricing_campaign=_.get(t,"sender.campaign_name")?_.get(t,"sender.campaign_name"):void 0,r.subscription_id=_.get(t,"sender.subscription_id")?_.get(t,"sender.subscription_id"):void 0,r.pricing_campaign_response=_.get(a,"sender.campaign_name")?_.get(a,"sender.campaign_name"):void 0,r.subscription_id_response=_.get(a,"sender.subscription_id")?_.get(a,"sender.subscription_id"):void 0,r.subscription_expiry_date=_.get(a,"sender.end_date")?_.get(a,"sender.end_date"):void 0),"SendMoneyStore"===e&&_.has(a,"sender.kycDetails.duc.ducDelivery.ducDocuments.ducDocument")){var d=a.sender.kycDetails.duc.ducDelivery.ducDocuments.ducDocument.map(function(e){return"ID"===e.docType?e.docType+"-"+e.type:e.docType});d&&0!=d.length&&(sessionStorage.setItem("wuAmplitude_kycDocTypes",d),r.kyc_doc_count=d.length,r.kyc_doc_type=d)}if("InitiateCustomerVerification"===e||"UploadDMSDoc"===e||"GetCustomerVerificationStatus"===e&&a){var m=sessionStorage.getItem("wuAmplitude_kycDocTypes")||"";if(m){var g=m.split(",");g&&0!==g.length&&(r.kyc_doc_count=g.length,r.kyc_doc_type=g)}}if("VerifyCustomer"===e&&a&&sessionStorage.getItem("wuAmplitude_kycDocTypes")&&sessionStorage.removeItem("wuAmplitude_kycDocTypes"),"CancelPendingTransaction"===e&&t&&t.reason_code&&(r.cancel_reason=t.reason_code),"GetCreditCards"===e&&getCount(e,a)&&(r.card_count=getCount(e,a)),"GetBanks"===e&&getCount(e,a)&&(r.bank_count=getCount(e,a)),"AddReceivers"===e&&getFundsOutOption())if("WA"===sessionStorage.getItem("SelectedPayOutOption"))r.wallet_service_provider=t.receivers.receiver[0].wallet.wu_wallet.service_provider_name;else{var l=getReceiverBankDetails(t);Object.assign(r,l)}var p=sessionStorage.getItem("SelectedPayOutOption");if("UpdateReceivers"!==e&&"AddReceivers"!==e||"MX"!==_.get(t,"receivers.receiver[0].address.country_iso_code")||"BA"!==p||(r.receiver_account_type=addReceiverAccountTypeForMexico(t.receivers.receiver[0])),"UpdateReceivers"!==e&&"AddReceivers"!==e||"IN"!==_.get(t,"receivers.receiver[0].address.country_iso_code")||"BA"!==p||(r.funds_out=setFundsOutUpiAmplitudeData(t.receivers.receiver[0])),"InitiateCustomerVerification"===e&&(t&&t.sender&&t.sender.compliance_details&&t.sender.compliance_details.id_documents&&t.sender.compliance_details.id_documents.id_document&&t.sender.compliance_details.id_documents.id_document.length>0&&(r.doc_type=t.sender.compliance_details.id_documents.id_document[0].type),t&&t.sender&&t.sender.kyc_details)){if(r.kyc_option=Object.getOwnPropertyNames(t.sender.kyc_details).join(),sessionStorage.setItem("kyc_option",r.kyc_option),_.get(a,"sender.kyc_details")){var y,S=a.sender.kyc_details,f=0;if(r.kyc_option=y=Object.getOwnPropertyNames(S).join("")||null,y){var v=y+"."+y+"Delivery."+y+"Documents."+y+"document",w=_.get(S,v);w&&Array.isArray(w)&&w.length>0&&(r.kyc_doc_type=w.map(function(e){return f+=1,e.docType?e.docType+"-"+e.type:e.type})),r.kyc_doc_count=f}}t.sender.kyc_details.pbv&&(t.sender.kyc_details.pbv.delivery_methods&&t.sender.kyc_details.pbv.delivery_methods.voice_delivery?r.kyc_option="pbv-voice":t.sender.kyc_details.pbv.delivery_methods&&t.sender.kyc_details.pbv.delivery_methods.sms_delivery?r.kyc_option="pbv-sms":t.sender.kyc_details.pbv.delivery_methods&&t.sender.kyc_details.pbv.delivery_methods.email_delivery&&(r.kyc_option="pbv-email"))}if("ValidateCustomerVerification"===e&&t&&t.sender&&t.sender.kyc_details&&(r.kyc_option=Object.getOwnPropertyNames(t.sender.kyc_details).join()),"VerifyCustomer"===e&&(r.kyc_option=sessionStorage.getItem("kyc_option")?sessionStorage.getItem("kyc_option"):null,sessionStorage.removeItem("kyc_option"),t&&t.doc_info&&t.doc_info.length>0&&(r.doc_type=t.doc_info[0].dms_doc.doc_type)),"UploadDMSDoc"===e&&t.doc_info&&t.doc_info.length>0&&t.doc_info[0].dms_doc&&t.doc_info[0].dms_doc.doc_sub_type&&(r.doc_type=t.doc_info[0].dms_doc.doc_sub_type),"BillerOptimus"===e&&(r.template_id=a.billerCTRTemplate.TEMPLATE_ID),"GetTransactionDetails"===e&&(r.execution_time=a.execution_time/1e3,r.total_transactions=_.has(a,"transactions.transaction")?a.transactions.transaction.length:0,r.api_version="v"+t.security.version),"oauth/authenticate"===e){a.config.headers&&a.config.headers.client_id;var C=countryConfig&&countryConfig.ConfigTemplate&&countryConfig.ConfigTemplate.partner&&countryConfig.ConfigTemplate.partner.name,b=200===a.status?"0 (passed)":"1 (failed)",I=sessionStorage.getItem("partnerRequestId")?sessionStorage.getItem("partnerRequestId"):null;r.api_response_code=b,r.api_reponse_message=getResponseMsg(C,b),r.Partner_name=C,r.Login_datetime=getTodayDate(),r.Country_Code=t.countryCode,r.customer_reference_id=I}if("AddCreditCards"===e){var O=JSON.parse(sessionStorage.getItem("wuAmplitude_cardConsentData"));O&&(sessionStorage.removeItem("wuAmplitude_cardConsentData"),r.card_type=O.cardType.toLowerCase(),r.card_consent=O.cardConsent.toLowerCase(),r.card_consent_default=O.cardConsentDefault.toLowerCase(),r.card_consent_type=O.cardConsentType.toLowerCase())}if("PostIDMSkycFormId"===e&&(r.form_id=t.formId,sessionStorage.removeItem("formId")),"data"===e&&a&&a.data&&a.data.type&&(r.type=a.data.type),"addressLookup"===e&&(r.char_count=t.address?t.address.length:0,r.result_count=a&&a.data&&a.data.results?a.data.results.length:0),"IDCompliance/UpdateCompliance"===e&&a&&a.identityVerificationStatus&&(sessionStorage.setItem("_wuAnalyticIVS",a.identityVerificationStatus),r.identity_verification_status=a.identityVerificationStatus,a.verificationSource&&(r.verification_source=a.verificationSource),sessionStorage.setItem("_wuAnalyticIVSource",a.verificationSource)),"CreateScheduleReminders"===e){r.reminder_enrol=!0,r.reminder_frequency=t.frequency_type.toLowerCase();var k=JSON.parse(sessionStorage.getItem("scheduledReminderObject")||"{}");_.has(k,"reminder_page")&&(r.reminder_page=k.reminder_page)}return"UpdateCreditCards"===e&&t.gateway_customer&&(r.card_type=_.get(t,"gateway_customer.wallet.credit_debit_cards.credit_debit_card[0].card_type")),r}function getCount(e,t){var a=0;"GetCreditCards"===e&&t.gatewayCustomer&&t.gatewayCustomer.creditDebitCards&&t.gatewayCustomer.creditDebitCards.creditDebitCard.length>0&&(a=t.gatewayCustomer.creditDebitCards.creditDebitCard.length);"GetBanks"===e&&t.gatewayCustomer&&t.gatewayCustomer.wallet&&t.gatewayCustomer.wallet.bankAccounts&&t.gatewayCustomer.wallet.bankAccounts.bankAccount.length>0&&(a=t.gatewayCustomer.wallet.bankAccounts.bankAccount.length);return a}function getFundsOutOption(){var e=sessionStorage.getItem("wuAmplitudeSMO_fundsOut");return"BA"===e?e:"WA"===sessionStorage.getItem("SelectedPayOutOption")?"WA":void 0}function getReceiverBankDetails(e){var t={};if(e&&e.receivers&&e.receivers.receiver){var a=e.receivers.receiver.length>0?e.receivers.receiver[0]:void 0;if(a&&a.wallet&&a.wallet.bank_accounts&&a.wallet.bank_accounts.bank_account.length>0){var r=a.wallet.bank_accounts.bank_account[0];t.bank_name=r.bank_name?r.bank_name:null,t.bank_location=r.bank_location?r.bank_location:null,t.routing_number=r.routing_number?r.routing_number:null,t.bank_code=r.bank_code?r.bank_code:null,t.swift_code=r.swift_code?r.swift_code:null,t.sort_code=r.sort_code?r.sort_code:null,t.financial_id=r.financial_id?r.financial_id:null,t.branch_name=r.branch_name?r.branch_name:null,t.branch_code=r.branch_code?r.branch_code:null}}return t}function addReceiverAccountTypeForMexico(e){var t=JSON.parse(sessionStorage.SummaryObjects);if("MX"===e.address.country_iso_code&&"500"===t.payout_method_code){var a=_.get(e,"wallet.bank_accounts.bank_account[0].account_type");return"BANK"===a?"account_number":a&&"debit"===a.toLowerCase()?"debitcard":"clabe"}return!1}function setFundsOutUpiAmplitudeData(e){var t=_.get(e,"wallet.bankAccounts[0].account_selected_type").toLowerCase();return"upi"===t&&t}function GetLoyaltyCardsCampaigns(e){var t="";return e.gatewayCustomer&&e.gatewayCustomer.additionalPreferredCustomers&&e.gatewayCustomer.additionalPreferredCustomers.preferredCustomer&&e.gatewayCustomer.additionalPreferredCustomers.preferredCustomer.promoCodes&&e.gatewayCustomer.additionalPreferredCustomers.preferredCustomer.promoCodes.promoCode&&e.gatewayCustomer.additionalPreferredCustomers.preferredCustomer.promoCodes.promoCode.forEach(function(e){t=t+e.campaignId+","}),t}function getSMVSMO(e,t,a){var r={resend:"false",promo_applied:!1};return"true"===sessionStorage.getItem("isResendFlow")&&(r.resend="true",sessionStorage.setItem("wuAmplitude_resendMtcn","true"),sessionStorage.setItem("isResendFlow","false")),"true"===sessionStorage.getItem("resendRetail")&&(r.resend="true",sessionStorage.setItem("wuAmplitude_resendMtcn","true"),sessionStorage.setItem("resendRetail","false")),"SendMoneyStore"===e&&("true"===sessionStorage.getItem("wuAmplitude_resendMtcn")?(r.resend="true",sessionStorage.setItem("wuAmplitude_resendMtcn","false")):r.resend="false"),wuSessionStorage&&wuSessionStorage.ValidationRequest&&JSON.parse(wuSessionStorage.ValidationRequest).payment_details&&JSON.parse(wuSessionStorage.ValidationRequest).payment_details.promotion&&"0"!==JSON.parse(wuSessionStorage.ValidationRequest).payment_details.promotion.discount&&(r.promo_applied=!0),a&&a.authorizationStatus&&a.authorizationStatus.code&&(r.hold_code=a.authorizationStatus.code),"SendMoneyValidation"===e&&a&&a.payment_details&&a.payment_details.fee_threshold_flag&&a.payment_details.fx_threshold_flag&&(r.fee_threshold_flag=a.payment_details.fee_threshold_flag.toLowerCase(),r.fx_threshold_flag=a.payment_details.fx_threshold_flag.toLowerCase()),"SendMoneyValidation"===e&&a&&a.payment_details&&a.payment_details.credit_debit_card&&a.payment_details.credit_debit_card.card_type&&(r.card_issuer=a.payment_details.credit_debit_card.card_type.toLowerCase(),r.card_type=a.payment_details.credit_debit_card.card_type),"SendMoneyStore"===e&&a&&a.paymentDetails&&a.paymentDetails.creditDebitCard&&a.paymentDetails.creditDebitCard.cardType&&(r.card_issuer=a.paymentDetails.creditDebitCard.cardType.toLowerCase(),r.card_type=a.paymentDetails.creditDebitCard.cardType),r}function getNameChangeCancelTransferDetail(){if(wuSessionStorage&&wuSessionStorage.NameChangeOriginal_Obj){var e=JSON.parse(wuSessionStorage.NameChangeOriginal_Obj),t=sessionStorage.getItem("tat_ampli_details")?JSON.parse(sessionStorage.getItem("tat_ampli_details")):null,a={};return e.transferAmount&&(a.send_amount=e.transferAmount),e.receiverGets&&(a.receive_amount=e.receiverGets),e.origCurrencyCode&&(a.send_currency=e.origCurrencyCode.toLowerCase()),e.destCurrencyCode&&(a.receive_currency=e.destCurrencyCode.toLowerCase()),e.payInMethod&&(a.funds_in=e.payInMethod),e.payOutMethod&&(a.funds_out=getFundsOutCode(e.payOutMethod)),e.exchangeRate&&(a.exchange_rate=e.exchangeRate),e.transferFee&&(a.transfer_fee=e.transferFee),e.originationCountry&&(a.sender_country=e.originationCountry.toLowerCase()),e.destinationCountry&&(a.receiver_country=e.destinationCountry.toLowerCase()),wuSessionStorage.cancel_reason_code&&(a.cancel_reason=wuSessionStorage.cancel_reason_code),t&&t.tat_entrypoint&&(a.tat_entrypoint=t.tat_entrypoint),e.customer_type&&(a.tat_flow="D"===e.customer_type?"DIGITAL":"RETAIL"),a}}function checkNameChangeCancelTransferFlow(){-1!==["txn-name-edit","namechangereview","namechangereceipt"].indexOf(wuSessionStorage.page_name)&&(sessionStorage.setItem("wuAmplitude_useSummaryObj",!1),sessionStorage.setItem("wuAmplitude_useNameChangeObj",!0)),-1!==["retailcancelcode","cancel-review","cancelreceipt"].indexOf(wuSessionStorage.page_name)&&(sessionStorage.setItem("wuAmplitude_useSummaryObj",!1),sessionStorage.setItem("wuAmplitude_useCancelTransferObj",!0))}function mandatoryAttributes(){var e={};if(getCookieValue("WUCountryCookie_")&&("GI"==getCookieValue("AKCountry")&&"GB"==getCookieValue("WUCountryCookie_")?e.sender_country="gi":e.sender_country=getCookieValue("WUCountryCookie_").toLowerCase()),getCookieValue("SessionId")&&(e.session_id=getCookieValue("SessionId")),getCookieValue("wu_device_id")&&(e.device_id=getCookieValue("wu_device_id")),e.wu_platform=getWuPlatform(),e.page_name="refer-friend"===oldPageName?"refer-a-friend":oldPageName,e.current_url=window.location.href,e.logged_in=isLoggedin(wuSessionStorage),e.user_path="server"===sessionStorage.getItem("initiator")?"ssr":"ng6",sessionStorage&&sessionStorage.getItem("_wuAnalyticIVS"))e.identity_verification_status=sessionStorage.getItem("_wuAnalyticIVS"),e.verification_source=sessionStorage.getItem("_wuAnalyticIVSource"),sessionStorage.removeItem("_wuAnalyticIVS"),sessionStorage.removeItem("_wuAnalyticIVSource"),sessionStorage.setItem("wuAmplitude_idvstatus",e.identity_verification_status);else if(wuSessionStorage&&wuSessionStorage.GatewayCustomer&&"true"==e.logged_in){var t=JSON.parse(wuSessionStorage.GatewayCustomer);t.identityVerificationStatus&&null!==t.identityVerificationStatus&&void 0!==t.identityVerificationStatus&&""!==t.identityVerificationStatus&&(e.identity_verification_status=t.identityVerificationStatus.toLowerCase()),sessionStorage.setItem("wuAmplitude_idvstatus",e.identity_verification_status)}"true"==e.logged_in&&sessionStorage.getItem("wuAmplitude_idvstatus")&&(e.identity_verification_status=sessionStorage.getItem("wuAmplitude_idvstatus")),e.app_version=sessionStorage.getItem("assetVersion")&&"null"!==sessionStorage.getItem("assetVersion")&&"undefined"!==sessionStorage.getItem("assetVersion")?sessionStorage.getItem("assetVersion"):"main0.js";var a=getURLParameter("campaign_name");return a&&sessionStorage.setItem("campaign_name",a),sessionStorage.getItem("campaign_name")&&(e.campaign_name=sessionStorage.getItem("campaign_name")),sessionStorage.getItem("ab_test")&&(e.ab_test=sessionStorage.getItem("ab_test").toLowerCase()),sessionStorage.getItem("ab_test_variant")&&(e.ab_test_variant=sessionStorage.getItem("ab_test_variant").toLowerCase()),e}function optionalAttributes(){var e={};if(wuSessionStorage&&"false"!==wuSessionStorage.wuAmplitude_useSummaryObj)if(wuSessionStorage.SummaryObjects&&null!==wuSessionStorage.SummaryObjects&&"null"!==wuSessionStorage.SummaryObjects){var t=getOptSender(o=JSON.parse(wuSessionStorage.SummaryObjects)),a=getOptReceiver(o),r=getOptTransaction(o);Object.assign(e,t,a,r)}else wuSessionStorage.wuAmplitudeSMO_receiverCountry&&(e.receiver_country=wuSessionStorage.wuAmplitudeSMO_receiverCountry),wuSessionStorage.wuAmplitudeSMO_fundsOut&&(e.funds_out=getFundsOutCode(wuSessionStorage.wuAmplitudeSMO_fundsOut)),wuSessionStorage.wuAmplitudeSMO_fundsIn&&(e.funds_in=wuSessionStorage.wuAmplitudeSMO_fundsIn);else if(wuSessionStorage&&"false"===wuSessionStorage.wuAmplitude_useSummaryObj)if("true"===wuSessionStorage.wuAmplitude_useNameChangeObj||"true"===wuSessionStorage.wuAmplitude_useCancelTransferObj){var n=getNameChangeCancelTransferDetail();n&&"object"==typeof n&&(e=n)}else{if(wuSessionStorage.wuAmplitudeSMO_receiverCountry)e.receiver_country=wuSessionStorage.wuAmplitudeSMO_receiverCountry;else if(wuSessionStorage.SummaryObjects&&null!==wuSessionStorage.SummaryObjects&&"null"!==wuSessionStorage.SummaryObjects){var o;a=getOptReceiver(o=JSON.parse(wuSessionStorage.SummaryObjects));e.receiver_country=a.receiver_country}if(wuSessionStorage.wuAmplitudeSMO_fundsOut&&(e.funds_out=getFundsOutCode(wuSessionStorage.wuAmplitudeSMO_fundsOut)),wuSessionStorage.wuAmplitudeSMO_fundsIn&&(e.funds_in=wuSessionStorage.wuAmplitudeSMO_fundsIn),wuSessionStorage.wuAmplitudeSMO_fundsIn&&"AG"===wuSessionStorage.wuAmplitudeSMO_fundsIn&&wuSessionStorage.Efl){var s=JSON.parse(wuSessionStorage.Efl),i=s.address&&s.address.state;i&&(e.efl_state=i)}}if(wuSessionStorage&&wuSessionStorage.SenderMEXObj&&wuSessionStorage.isDirectedCountry&&"Y"==wuSessionStorage.isDirectedCountry){var u=JSON.parse(wuSessionStorage.SenderMEXObj);e.city=u.mexCity}if(wuSessionStorage&&wuSessionStorage.wuAmplitudeSMO_sendReceiveLock&&(e.send_receive_lock=wuSessionStorage.wuAmplitudeSMO_sendReceiveLock),wuSessionStorage&&wuSessionStorage.wuAmplitudeSMO_providerid&&(e.provider_id=wuSessionStorage.wuAmplitudeSMO_providerid),wuSessionStorage&&wuSessionStorage.wuAmplitudeSMO_src){var c=wuSessionStorage.wuAmplitudeSMO_src;-1!==c.indexOf("fb_msngr")?e.wu_source="fb-bot":e.wu_source=c}var d=getCookieValue("partnerName");if(d&&(e.partner_name=d.toLowerCase()),wuSessionStorage&&wuSessionStorage.userJourney&&(e.user_journey=wuSessionStorage.userJourney,"bill-pay"!=wuSessionStorage.userJourney&&"inmate-pay"!=wuSessionStorage.userJourney||!_.has(o,"feeInquiry.wuProduct.speedIndicator")||(e.speed_of_delivery=o.feeInquiry.wuProduct.speedIndicator),"receiver-redirect"==wuSessionStorage.userJourney&&(e.user_journey="receiver-directed")),e&&!e.send_amount&&wuSessionStorage&&wuSessionStorage.wuAmplitude_sendAmount&&(e.send_amount=wuSessionStorage.wuAmplitude_sendAmount),wuSessionStorage&&wuSessionStorage.SendMoneyObjects||wuSessionStorage.CustomerVerificationStatus){if(wuSessionStorage.SendMoneyObjects){var m=JSON.parse(wuSessionStorage.SendMoneyObjects),g=_.get(m,"sender.kycDetails.duc.ducDelivery.available");_.get(m,"sender.kycDetails.duc.ducDelivery.ducDocuments.ducDocument[0].type"),_.get(m,"sender.kycDetails.dur.durDelivery"),_.get(m,"sender.kycDetails.dur.durDelivery.durDocTypes")}else{var l=JSON.parse(wuSessionStorage.CustomerVerificationStatus);g=_.get(l,"sender.kyc_details.duc.ducDelivery.available"),_.get(l,"sender.kyc_details.duc.ducDelivery.ducDocuments.ducDocument[0].type"),_.get(l,"sender.kyc_details.dur.durDelivery"),_.get(l,"sender.kyc_details.dur.durDelivery.durDocTypes")}g&&wuSessionStorage.paSubType&&(e.paSubType=wuSessionStorage.paSubType)}return wuSessionStorage&&wuSessionStorage.formId&&(e.form_id=wuSessionStorage.formId),e}function getOptSender(e){var t={};if(isLoggedin()&&wuSessionStorage&&wuSessionStorage.AccountNumber){var a=md5Encryption(wuSessionStorage.AccountNumber);t.sender_account_number=a}return t.send_amount=e.transfer_amount,e.defaultCurrencyIsoCode&&(t.send_currency=e.defaultCurrencyIsoCode.toLowerCase()),t}function getOptReceiver(e){var t={};if(e.uid&&(t.receiver_account_number=md5Encryption(e.uid)),e.flag_position)t.receiver_country=e.flag_position.toLowerCase();else if(e&&e.feeInquiryData&&e.feeInquiryData.destnCountry&&e.feeInquiryData.destnCountry.isoCode){var a=e.feeInquiryData.destnCountry.isoCode.toLowerCase();sessionStorage.setItem("wuAmplitudeSMO_receiverCountry",a),t.receiver_country=a}else wuSessionStorage&&wuSessionStorage.wuAmplitudeSMO_receiverCountry&&(t.receiver_country=wuSessionStorage.wuAmplitudeSMO_receiverCountry);return e.currencyIsoCode&&(t.receive_currency=e.currencyIsoCode.toLowerCase()),e.sourceOfFundsText&&e.purposeText&&"receiver"==wuSessionStorage.page_name&&(t.reciver_source_of_funds=e.sourceOfFundsText,t.reciver_purpose_of_transaction=e.purposeText),t.receive_amount=e.receiver_currency,e.walletObj&&e.walletObj.service_provider_name&&(t.wallet_service_provider=e.walletObj.service_provider_name),t}function getOptTransaction(e){var t={};return t.exchange_rate=e.exchangeRate,e.paying_method?t.funds_in=e.paying_method.toLowerCase():e&&e.feeInquiryData&&e.feeInquiryData.destnCountry&&e.feeInquiryData.destnCountry.selectedPayinName?t.funds_in=e.feeInquiryData.destnCountry.selectedPayinName.toLowerCase():wuSessionStorage&&wuSessionStorage.wuAmplitudeSMO_fundsIn&&(t.funds_in=wuSessionStorage.wuAmplitudeSMO_fundsIn.toLowerCase()),t.funds_out=getFundsOut(e),"cash"===t.funds_out&&(t.agent_network="all"),t.transfer_fee=e.transfer_fee,e.type&&"sending_money"!==e.type&&(e.payout_method_code?t.biller=e.payout_method_code.toLowerCase():wuSessionStorage.wuAmplitude_biller&&(t.biller=wuSessionStorage.wuAmplitude_biller.toLowerCase())),t}function getFundsOut(e){var t=null;return e.type&&"sending_money"!==e.type?t="reload-options"===e.type?"mobile-reload":"bill-pay"===e.type||"inmate-pay"===e.type?"bill-pay"===e.type?"billpay":"inmatepay":e.type:e.payout_method_code?t=getFundsOutCode(e.payout_method_code):e&&e.feeInquiryData&&e.feeInquiryData.destnCountry&&e.feeInquiryData.destnCountry.selectedPayoutName?t=getFundsOutCode(e.feeInquiryData.destnCountry.selectedPayoutName):wuSessionStorage&&wuSessionStorage.wuAmplitudeSMO_fundsOut&&(t=getFundsOutCode(wuSessionStorage.wuAmplitudeSMO_fundsOut)),t}function getFundsOutCode(e){for(var t=e,a=[{code:"500",value:"d2b"},{code:"000",value:"cash"},{code:"600",value:"MMT"},{code:"BA",value:"d2b"},{code:"AG",value:"cash"},{code:"WA",value:"wa"},{code:"200",value:"d2c"},{code:"800",value:"wa"}],r=0;r<a.length;r++)if(t===a[r].code)return a[r].value;return t}function getCookieValue(e){var t,a,r,n=document.cookie.split(";");for(t=0;t<n.length;t++)if(a=n[t].substr(0,n[t].indexOf("=")),r=n[t].substr(n[t].indexOf("=")+1),(a=a.replace(/^\s+|\s+$/g,""))===e&&""!==r)return decodeURIComponent(r)}function getCurrentPageNameURL(){if(window.location.href){var e=location.protocol+"//"+location.host+location.pathname;if(-1!==e.indexOf("/home.html"))return(e=e.substring(0,e.indexOf(".html"))).split("/").slice(-1)[0];if(-1!==e.indexOf("/currency-converter"))return"currency-converter";if(-1!==e.indexOf(".html"))return e=e.substring(0,e.indexOf(".html")),"non-transactional"}}function md5Encryption(e){var t=null;return e&&"undefined"!=typeof md5&&(t=md5(e)),t}function isLoggedin(e){return e&&null===e.getItem("AccountNumber")&&void 0===getCookieValue("AccountNumber")?"false":"true"}function getAmpURLParam(e){if((t=location.search||location.hash)&&t.toLowerCase()){var t=t.toLowerCase(),a=decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(t)||[,""])[1].replace(/\+/g,"%20"))||null;return null!=a&&(a=a.trim()),a}}function getProviderId(){var e=getAmpURLParam("providerid");e&&sessionStorage.setItem("wuAmplitudeSMO_providerid",e)}function getWuSource(){var e=getAmpURLParam("src");e&&sessionStorage.setItem("wuAmplitudeSMO_src",e)}function getPartnerName(){var e=getAmpURLParam("partnerName")?getAmpURLParam("partnerName"):getCookieValue("partnerName");e&&sessionStorage.setItem("wuAmplitudeSMO_partnerName",e)}function getTodayDate(){function e(e){return e<10?"0"+e:e}return Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())},(new Date).toISOString()}function getWuPlatform(){return window.location.href?"r3_responsive_web":null}function setRegisterFlag(e){var t="P"===_.get(e,"gatewayCustomer.registrationStatus")?"P":"F",a=(new amplitude.Identify).setOnce("register_flag",t);amplitude.getInstance().identify(a)}function checkCurrentPageName(e){return"kycoption-duc"==e&&wuSessionStorage&&wuSessionStorage.ducPageName&&(e=wuSessionStorage.ducPageName),e}function toTitleCase(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}function sendAnalyticsData(e,t,a,r){try{var n="";if(getCookieValue("WUCountryCookie_")&&(n=getCookieValue("WUCountryCookie_").toLowerCase()),datahub_config.amplitude&&window.amplitude&&r){if(null!==localStorage.getItem("amplitudeRegisterCustomer")&&""!==localStorage.getItem("amplitudeRegisterCustomer")){var o=JSON.parse(localStorage.getItem("amplitudeRegisterCustomer"));if(o&&o.gateway_customer&&o.gateway_customer.identities){delete o.gateway_customer.identities;var s=JSON.stringify(o);localStorage.setItem("amplitudeRegisterCustomer",s)}}var i=t&&t.isRetail?"api_Retail"+r:"api_"+r;if("RegisterCustomer"===r)if(_.has(t,"gateway_customer.address.raw_address")&&(e.suggested_address=!0),a.gatewayCustomer){if(a.gatewayCustomer&&a.gatewayCustomer.preferredCustomer&&a.gatewayCustomer.preferredCustomer.accountNbr){var u=md5Encryption(a.gatewayCustomer.preferredCustomer.accountNbr);null!==u&&(setUserId(u),setRegisterCustomerIdentify(t))}}else if("C6006"===e.api_response_code){t&&t.gateway_customer&&t.gateway_customer.identities&&delete t.gateway_customer.identities;var c=JSON.stringify(t);localStorage.setItem("amplitudeRegisterCustomer",c)}if("SendMoneyStore"===r&&(t.wu_product&&"Y"==t.wu_product.is_directed&&(e["is-directed"]="Yes",e["directed-agent"]=t.wu_product.location),a.error&&"C1146"!==a.error.code||setSMSIdentify(e,a)),"SendMoneyValidation"===r||"SendMoneyStore"===r)_.get(t,"sender.subscription_id")&&(e.subscription_id=_.get(t,"sender.subscription_id")),setRegisterFlag(v=JSON.parse(sessionStorage.getItem("GatewayCustomer")));if("GetLoyaltyCards"===r&&(a.error||setGLCIdentify(a)),"GetCustomerProfile"===r&&(a&&a.gatewayCustomer&&a.gatewayCustomer.identityVerificationStatus&&(e.identity_verification_status=a.gatewayCustomer.identityVerificationStatus.toLowerCase()),setRegisterFlag(a)),"CustomerSignOn"===r){var d=e.customerSignOnAccountNumber;customerId=e.customerSignOnAccountNumber,delete e.customerSignOnAccountNumber;var m=md5Encryption(d);if(null!==m)if(setUserId(m),null!==localStorage.getItem("amplitudeRegisterCustomer"))setRegisterCustomerIdentify(JSON.parse(localStorage.getItem("amplitudeRegisterCustomer"))),localStorage.removeItem("amplitudeRegisterCustomer");e.sender_account_number=m}if(e.device_id&&amplitude.getInstance().setDeviceId(e.device_id),"GetReceivers"===r&&a&&!a.error){var g=0;if(a.receivers&&a.receivers.receiver)g=a.receivers.receiver.length;var l=(new amplitude.Identify).set("receivers_count",g);amplitude.getInstance().identify(l)}if("VerifyEID"===r&&a&&!a.error){var p="N";a.verification_status&&(p=a.verification_status),e.identity_verification_status=p,wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName&&"ev-profile-confirmation"===wuSessionStorage.wuAmplitude_pageName&&a.verification_status&&a.verificationSource&&a.nameMatched&&a.dobMatched&&(e.verification_source=a.verificationSource,e.name_match_status=a.nameMatched,e.dob_match_status=a.dobMatched,sessionStorage.setItem("_wuAnalyticIVS",a.verification_status),sessionStorage.setItem("_wuAnalyticIVSource",a.verificationSource))}if("InitiateCustomerVerification"===r&&a&&!a.error&&a.identityVerificationStatus&&(e.identity_verification_status=a.identityVerificationStatus.toLowerCase()),"UpdateCustomerProfile"==r){var y=isFeatureEnabled("MARKETING_ON_PR",n.toUpperCase()),S=isFeatureEnabled("IMPLICIT_MARKETING_ON_PR",n.toUpperCase());_.has(t,"gateway_customer.address.raw_address")&&(e.suggested_address=!0);var f=wuSessionStorage.isZipCodeService?JSON.parse(wuSessionStorage.isZipCodeService):null,v=JSON.parse(wuSessionStorage.GatewayCustomer);if("BR"!=getCookieValue("WUCountryCookie_")||!f&&"Y"!==_.get(v,"address.advvStatus")||(e.address_verification_status=!0,delete wuSessionStorage.isZipCodeService),"completeyourprofile"===e.page_name&&_.get(t,"gateway_customer.gender")){l=(new amplitude.Identify).setOnce("gender",_.get(t,"gateway_customer.gender"));amplitude.getInstance().identify(l)}(y||S)&&(e.marketing_consent=!1,e.mywu_consent=!1,_.get(t,"gateway_customer.account_preferences.email")?e.marketing_consent=!0:_.get(t,"gateway_customer.account_preferences.message")?e.marketing_consent=!0:_.get(t,"gateway_customer.account_preferences.direct_mail")?e.marketing_consent=!0:_.get(t,"gateway_customer.account_preferences.telephone_call")&&(e.marketing_consent=!0),"1"===_.get(a,"gatewayCustomer.termsConditionFlag")&&(e.mywu_consent=!0)),_.has(t,"gateway_customer.account_preferences.thirdparty_datasharing_consent")&&(e["3rd_party_data_sharing"]=_.get(t,"gateway_customer.account_preferences.thirdparty_datasharing_consent"))}"oauth/authenticate"==r&&t&&a&&setAuthenticateCustomerInfo(t,a),"catalog"!==r&&"estimate"!==r&&"qqcCatalog"!==r&&"reload"!==r||!t||(_.get(t,"sender.send_amount")&&(e.send_amount=_.get(t,"sender.send_amount")),_.get(t,"sender.curr_iso3")&&(e.send_currency=_.get(t,"sender.curr_iso3").toLowerCase()),_.get(t,"receiver.receive_amount")&&(e.receive_amount=_.get(t,"receiver.receive_amount")),_.get(t,"receiver.curr_iso3")&&(e.receive_currency=_.get(t,"receiver.curr_iso3").toLowerCase()),_.get(t,"receiver.company_code")&&(e.biller=_.get(t,"receiver.company_code").toLowerCase()),_.get(a,"receiver.company_code")&&"reload"===r&&(e.biller=_.get(a,"receiver.company_code").toLowerCase()),-1===_.get(a,"response_status.status")&&(e.api_response_code=_.get(a,"response_status.code"),e.api_response_message=_.get(a,"response_status.message")),_.get(t,"campaign.campaign_name")&&(e.pricing_campaign=_.get(t,"campaign.campaign_name")),_.get(t,"campaign.subscription_id")&&(e.subscription_id=_.get(t,"campaign.subscription_id")),_.get(a,"sender.segment")&&(e.pricing_segment=_.get(a,"sender.segment")),getCookieValue("promoCampaignSubscriptionEndDate")&&"catalog"===r&&(e.subscription_expiry_date=getCookieValue("promoCampaignSubscriptionEndDate"))),"PromoAPI"===r&&t&&(_.get(t,"get_promo_dsc.money_txn.orig_cty_iso2_ext")&&(e.sender_country=_.get(t,"get_promo_dsc.money_txn.orig_cty_iso2_ext")),_.get(t,"get_promo_dsc.money_txn.dest_cty_iso2_ext")&&(e.receiver_country=_.get(t,"get_promo_dsc.money_txn.dest_cty_iso2_ext")),_.get(t,"get_promo_dsc.money_txn.send_amount")&&(e.send_amount=_.get(t,"get_promo_dsc.money_txn.send_amount")),_.get(t,"get_promo_dsc.money_txn.orig_curr_iso3")&&(e.send_currency=_.get(t,"get_promo_dsc.money_txn.orig_curr_iso3").toLowerCase()),_.get(t,"get_promo_dsc.money_txn.dest_curr_iso3")&&(e.receive_currency=_.get(t,"get_promo_dsc.money_txn.dest_curr_iso3").toLowerCase()),_.get(a,"status.error.code")&&(e.api_response_code=_.get(a,"status.error.code"),e.api_response_message=_.get(a,"status.error.message"))),"TransactionInquiry"==r&&t&&a&&(_.get(a,"statusDetails.transactionIdentifier")&&(e.user_type=_.get(a,"statusDetails.transactionIdentifier").toLowerCase()),_.get(a,"statusDetails.statusLabel")&&_.get(a,"transactionStatus")?e.mtcn_status=_.get(a,"statusDetails.statusLabel")+" - "+_.get(a,"transactionStatus"):e.mtcn_status=_.get(a,"transactionStatus")?_.get(a,"transactionStatus"):_.get(a,"statusDetails.statusLabel")),updateWULanguage(),setUtmSrcParameter(e),setReferrerParameter(e),wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent&&(e.previous_event=wuSessionStorage.wuAmplitude_previousEvent),sessionStorage.setItem("wuAmplitude_previousEvent",i);var w=isFeatureEnabled("POST_LOGIN_PROMO_CAMPAIGN",n);"SendMoneyValidation"===r&&w&&(t&&(customerId=_.get(t,"sender.preferred_customer.account_nbr")?_.get(t,"sender.preferred_customer.account_nbr"):void 0,e.event_name="Send money validation attempted",e.campaign_name=_.get(t,"sender.campaign_name")?_.get(t,"sender.campaign_name"):null,e.subscription_id=_.get(t,"sender.subscription_id")?_.get(t,"sender.subscription_id"):null,hadoopAnalyticsLogsEvents(i,e)),a&&!_.get(a,"error")&&(e.event_name="Send money validation completed",e.campaign_name=_.get(a,"sender.campaign_name")?_.get(a,"sender.campaign_name"):null,e.subscription_id=_.get(a,"sender.subscription_id")?_.get(a,"sender.subscription_id"):null,e.subscription_expiry_date=_.get(a,"sender.end_date")?new Date(_.get(a,"sender.end_date")).getTime():null,hadoopAnalyticsLogsEvents(i,e)));var C=_.get(e,"subscription_expiry_date")?new Date(_.get(e,"subscription_expiry_date")):null;C&&C.toISOString()!==_.get(e,"subscription_expiry_date")&&(e.subscription_expiry_date=new Date(_.get(e,"subscription_expiry_date")).toISOString()),-1===["AddRewardsToCustomerWallet","AuthenticateCustomer","AvailableKYCOptions","GetPaymentInstruments","Languages","PayoutCommit","PromoAPI","RetailCustomerLookUp","SendMobileAppMail","VerifyPhone"].indexOf(r)&&logEvents(i,e)}}catch(e){console.error(e)}}function getSendReceiveLock(e){e.payment_details&&e.payment_details.destination&&e.payment_details.destination.expected_payout_amount?sessionStorage.setItem("wuAmplitudeSMO_sendReceiveLock","receive_locked"):e.payment_details&&e.payment_details.origination&&e.payment_details.origination.principal_amount&&sessionStorage.setItem("wuAmplitudeSMO_sendReceiveLock","send_locked")}function getSMOReceiverCountry(e){if(wuSessionStorage&&wuSessionStorage.SummaryObjects&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry.isoCode){var t=JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry.isoCode.toLowerCase();if(sessionStorage.setItem("wuAmplitudeSMO_receiverCountry",t),t!==oldCountryCode){oldCountryCode=t,logSMOHackClickEvent("clicked_[send-money-option]_[dropdown-receiver-country]")}}else if(wuSessionStorage.SummaryObjects&&JSON.parse(wuSessionStorage.SummaryObjects).type&&"sending_money"!==JSON.parse(wuSessionStorage.SummaryObjects).type&&e.serviceOptions&&e.serviceOptions.serviceOption&&e.serviceOptions.serviceOption.WEB&&e.serviceOptions.serviceOption.WEB.AG&&e.serviceOptions.serviceOption.WEB.AG.length>0){var a=e.serviceOptions.serviceOption.WEB.AG[0];if(a.paymentDetails&&a.paymentDetails.destination&&a.paymentDetails.destination.countryIsoCode){t=a.paymentDetails.destination.countryIsoCode.toLowerCase();sessionStorage.setItem("wuAmplitudeSMO_receiverCountry",t)}}}function getSMOFundsOut(){if(wuSessionStorage&&wuSessionStorage.SummaryObjects&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry.selectedPayoutName){var e=JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry.selectedPayoutName;if(sessionStorage.setItem("wuAmplitudeSMO_fundsOut",e),e!==oldFundsOut){var t="clicked_[send-money-option]_[tile-fundsout-"+e.toLowerCase()+"]";oldFundsOut=e,logSMOHackClickEvent(t)}}}function getSMOFundsIn(){if(wuSessionStorage&&wuSessionStorage.SummaryObjects&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry&&JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry.selectedPayinName){var e=JSON.parse(wuSessionStorage.SummaryObjects).feeInquiryData.destnCountry.selectedPayinName.toLowerCase();if(sessionStorage.setItem("wuAmplitudeSMO_fundsIn",e),e!==oldFundsIn){var t="clicked_[send-money-option]_[tile-fundsin-"+e.toLowerCase()+"]";oldFundsIn=e,logSMOHackClickEvent(t)}}}function logSMOHackClickEvent(e){var t="";if(t=wuSessionStorage.wuAmplitude_pageName?wuSessionStorage.wuAmplitude_pageName:previousPageName||"page name did not catch",window.amplitude&&datahub_config.amplitude){sessionStorage.setItem("wuAmplitude_useSummaryObj",!1);var a=getAnalyticsData();if(sessionStorage.removeItem("wuAmplitude_useSummaryObj"),"send-money-option"===t){var r=e;a.page_name=t,updateWULanguage(),wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent&&(a.previous_event=wuSessionStorage.wuAmplitude_previousEvent),sessionStorage.setItem("wuAmplitude_previousEvent",r),logEvents(r,a)}}}function modSMOTile(e,t){var a=e.split("-").pop();-1!==e.indexOf("-fundsOut-")&&(oldFundsOut=a),-1!==e.indexOf("-fundsIn-")&&(oldFundsIn=a),sessionStorage.setItem(t,a)}function getBiller(e){e.biller&&e.biller.code&&sessionStorage.setItem("wuAmplitude_biller",e.biller.code)}function getRegisterFlag(e){return"true"===e.progressive_registration?"P":"F"}function getSendAmount(e){if(e.payment_details&&e.payment_details.origination&&e.payment_details.origination.principal_amount){var t=e.payment_details.origination.principal_amount;sessionStorage.setItem("wuAmplitude_sendAmount",t)}}function setRegisterCustomerIdentify(e){var t=(new amplitude.Identify).setOnce("wu_country",getCountry(e)).setOnce("wu_language",getCookieValue("WULanguageCookie_")?getCookieValue("WULanguageCookie_"):null).setOnce("registration_date",getTodayDate()).setOnce("age",getAge(e)).setOnce("gender",getGender(e)).setOnce("nationality",getNationality(e)).setOnce("lifetime_trxn_count",0).setOnce("lifetime_amount_sent",0).setOnce("lifetime_fee_paid",0).setOnce("mywu_points",0).setOnce("register_flag",getRegisterFlag(e));amplitude.getInstance().identify(t)}function getCountry(e){var t="wu_country is not available";return e.gateway_customer&&e.gateway_customer.address&&e.gateway_customer.address.country_iso_code&&(t=e.gateway_customer.address.country_iso_code),t}function getAge(e){var t="age is not available";if(e.gateway_customer&&e.gateway_customer.date_of_birth){var a=e.gateway_customer.date_of_birth.split("-"),r=new Date,n=r.getFullYear(),o=r.getMonth(),s=r.getDate(),i=a[0],u=a[1],c=a[2];t=n-i,o<u-1&&t--,u-1==o&&s<c&&t--}return t}function getGender(e){var t=null;return e.gateway_customer&&e.gateway_customer.gender&&(t=e.gateway_customer.gender),t}function getNationality(e){var t=null;return e.gateway_customer&&e.gateway_customer.nationality&&(t=e.gateway_customer.nationality),t}function setSMSIdentify(e,t){if(e.send_amount){var a=(new amplitude.Identify).add("lifetime_trxn_count",1).add("lifetime_amount_sent",e.send_amount);amplitude.getInstance().identify(a)}if(e.transfer_fee){a=(new amplitude.Identify).add("lifetime_fee_paid",e.transfer_fee);amplitude.getInstance().identify(a)}if(t.sender&&t.sender.preferredCustomer&&t.sender.preferredCustomer.totalPointsEarned){a=(new amplitude.Identify).set("mywu_points",t.sender.preferredCustomer.totalPointsEarned);amplitude.getInstance().identify(a)}}function setGLCIdentify(e){if(e.gatewayCustomer&&e.gatewayCustomer.additionalPreferredCustomers&&e.gatewayCustomer.additionalPreferredCustomers.preferredCustomer&&e.gatewayCustomer.additionalPreferredCustomers.preferredCustomer.totalPointsEarned){var t=(new amplitude.Identify).set("mywu_points",e.gatewayCustomer.additionalPreferredCustomers.preferredCustomer.totalPointsEarned);amplitude.getInstance().identify(t)}}function getURLParameter(e){var t=location.search||location.hash,a=decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(t)||[,""])[1].replace(/\+/g,"%20"))||null;return null!=a&&(a=a.trim()),a}function getAmpGetQueryParams(e){e=e.split("+").join(" ");for(var t,a={},r=/\butm_([^=]+)=([^&]+)/g;t=r.exec(e);)a[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return a}function getAmplitudeReferrer(){var e=document.referrer,t={},a={};if(e){var r=new URL(String(e));return t.referrer=e,t.referring_domain=r.hostname,a.last_referrer=e,a.last_referring_domain=r.hostname,amplitude.setUserProperties(a),t}}function getAmplitudeUTMParameterCapture(){var e,t={},a={},r=sessionStorage.getItem("ampUTMParam"),n=sessionStorage.getItem("ampUserUTMParam"),o={},s=getURLParameter("src"),i=sessionStorage.getItem("UTMSourcesList"),u=document.referrer;if(null!==r)t=JSON.parse(r),a=JSON.parse(n);else{var c=getAmpGetQueryParams(document.location.search);if(void 0!==s||0!==Object.keys(c).length||u)if(u)if(c.hasOwnProperty("source")&&c.hasOwnProperty("medium")&&c.hasOwnProperty("campaign"))for(var d in c)t["utm_"+d]=c[d],a["last_utm_"+d]=c[d];else if(s){if(null!==i&&u){i=i.replace(/'/g,'"'),o=JSON.parse(i);var m=new URL(u).hostname.split(".");m=m[1],Object.keys(o).forEach(function(t){if(o[t])for(var a=o[t].split(","),r=0;r<a.length;r++)if("SOCIALSITES"===t||"SEARCHENGINES"===t){if(a[r]===m){e=t;break}}else if(a[r]===s){e=t;break}});var _=setUTMSrcParameters(e,m,s);t=_[0],a=_[1]}}else{var g=getUTMForNonPaidTarffic();g&&(t=g[0],a=g[1])}else t.utm_source="web-bookmark-or-typed",t.utm_medium="e-web-bookmark-or-typed",t.utm_campaign="organic-web-bookmark-or-typed",a.last_utm_source="web-bookmark-or-typed",a.last_utm_medium="e-web-bookmark-or-typed",a.last_utm_campaign="organic-web-bookmark-or-typed";else t.utm_source="web-bookmark-or-typed",t.utm_medium="e-web-bookmark-or-typed",t.utm_campaign="organic-web-bookmark-or-typed",a.last_utm_source="web-bookmark-or-typed",a.last_utm_medium="e-web-bookmark-or-typed",a.last_utm_campaign="organic-web-bookmark-or-typed";0!==Object.getOwnPropertyNames(t).length&&(sessionStorage.setItem("ampUTMParam",JSON.stringify(t)),sessionStorage.setItem("ampUserUTMParam",JSON.stringify(a)))}return amplitude.setUserProperties(a),t}function getUTMForNonPaidTarffic(){var e,t,a=!0,r=getURLParameter("src"),n=document.referrer,o=sessionStorage.getItem("UTMSourcesList");if(null!==o&&n){o=o.replace(/'/g,'"'),e=JSON.parse(o);var s=new URL(n).hostname.split(".");for(var i in s=s[1],e)if(e.hasOwnProperty(i)){for(var u=e[i].split(","),c=0;c<u.length;c++)if("SOCIALSITES"===i){if(u[c]===s){t="SS",a=!1;break}}else if("SEARCHENGINES"===i&&u[c]===s){t="SE",a=!1;break}if(!1===a)break}return"SS"!==t&&"SE"!==t&&(t="NA"),setUTMSrcParameters(t,s,r)}}function setUTMSrcParameters(e,t,a){var r={},n={};switch(e){case"AFFILIATES":r.utm_source=t,r.utm_medium="p-affiliates",r.utm_campaign=a;break;case"DISPLAY":r.utm_source=t,r.utm_medium="p-web-display",r.utm_campaign=a;break;case"EMAIL":r.utm_source="email",r.utm_medium="e-email",r.utm_campaign=a;break;case"INTERNAL":r.utm_source="web",r.utm_medium="e-internal",r.utm_campaign=a;break;case"MOBILE":r.utm_source="app",r.utm_medium="e-app",r.utm_campaign=a;break;case"OTHER":r.utm_source="other",r.utm_medium="e-other",r.utm_campaign=a;break;case"RETAIL":r.utm_source="retail",r.utm_medium="e-retail",r.utm_campaign=a;case"SEARCHENGINES":r.utm_source=t,r.utm_medium="p-web-serp",r.utm_campaign=a;break;case"SOCIALSITES":r.utm_source=t,r.utm_medium="p-social",r.utm_campaign=a;break;case"SS":r.utm_source=t,r.utm_medium="e-social",r.utm_campaign="organic-social";break;case"SE":r.utm_source=t,r.utm_medium="e-web-serp",r.utm_campaign="organic-search";break;case"NA":r.utm_source=t,r.utm_medium="e-web",r.utm_campaign="organic-web"}return n=Object.assign({},r),Object.keys(n).forEach(function(e){n["last_"+e]=n[e],delete n[e]}),0!==Object.getOwnPropertyNames(n).length&&(sessionStorage.setItem("ampUTMParam",JSON.stringify(r)),sessionStorage.setItem("ampUserUTMParam",JSON.stringify(n))),setIntialUserIdentify(r),[r,n]}function setUtmSrcParameter(e){if(ampUTMObj)for(var t in ampUTMObj)e[t]=ampUTMObj[t],getCookieValue(t)||setCookieInMinutes(t,ampUTMObj[t],30);src_parameter&&(amplitude.setUserProperties(src_parameter),e.src_parameter=src_parameter)}function setReferrerParameter(e){if(ampReferrerObj)for(var t in ampReferrerObj)ampReferrerObj.hasOwnProperty(t)&&(e[t]=ampReferrerObj[t])}function logPageEvent(){var e={"collectid.pep":"political-affiliation","collectid.sdq":"additional-information","register-step1":"register_us_step1","register-step2":"register_us_step2","collectid.choose":"eid-verification",mobilereload:"mobile-reload",pickupcashair:"pickup-cash-air","pickupcashair-globalcollectid":"pickup-cash-air-global-collectid",completeyourprofile:"complete-your-profile",pickupcashglobalcollectid:"pickup-cash-global-collect-id","confirmcard-3d":"confirm-card-3d","confirmbank-pwm":"confirm-bank-pwm",sendinmatestart:"send-inmate-start","collectid.collect":"collectid-collect","collectid.confirm":"collectid-confirm",kycoption:"kyc-option","kycoption-duc":"kyc-option-duc","kycoption-verify":"kyc-option-verify","kycoption-duc-upload-id":"kyc-option-duc-upload-id","kycoption-duc-upload-proofofAddres":"kyc-options-duc-upload-proof-of-addres",paymentprocessing:"payment-processing",mywu:"my-wu",globalcollectid:"global-collectid","menu-myreceivers":"menu-my-receivers","cashpickupair-receipt":"cash-pickup-air-receipt","tracktransfer-success":"track-transfer-success",tracktransfer:"track-transfer",cancelreview:"cancel-review","redirect-start":"update-delivery-method",evprofileconfirmation:"ev-profile-confirmation",cookieInformation:"cookie-information","refer-friend":"refer-a-friend",sendmoneyoption:"send-money-option","send-money":"send-money-option",verificationoptions:"video-kyc-instructions",success:"kyc-noninline-notification"};checkNameChangeCancelTransferFlow();var t=getAnalyticsData();if(-1!==["history","send-money-option","price-estimator"].indexOf(t.page_name)&&sessionStorage.setItem("wuAmplitude_useSummaryObj",!1),-1!==["send-money-option","send-inmate-start","billpay-start","billpaystart","price-estimator","topupstart","history","cruise","login"].indexOf(t.page_name)&&(sessionStorage.removeItem("wuAmplitudeSMO_receiverCountry"),sessionStorage.removeItem("wuAmplitudeSMO_sendReceiveLock"),sessionStorage.removeItem("wuAmplitudeSMO_fundsIn"),sessionStorage.removeItem("wuAmplitudeSMO_fundsOut"),sessionStorage.removeItem("wuAmplitude_biller"),sessionStorage.removeItem("wuAmplitude_sendAmount"),oldCountryCode="",oldFundsOut="",oldFundsIn="",getProviderId(),getWuSource(),getPartnerName()),sessionStorage.removeItem("wuAmplitude_useSummaryObj"),sessionStorage.removeItem("wuAmplitude_useNameChangeObj"),sessionStorage.removeItem("wuAmplitude_useCancelTransferObj"),t.page_name){if(e[t.page_name]&&(t.page_name=e[t.page_name]),"retailcancelcode"==t.page_name?t.page_name="cancel-reason":"cancelreceipt"==t.page_name?t.page_name="cancel-confirmation":"txn-name-edit"==t.page_name?t.page_name="edit-receiver-name":"namechangereview"==t.page_name?t.page_name="edit-receiver-name-review":"namechangereceipt"==t.page_name?t.page_name="edit-receiver-name-confirmation":"retailcallcc"==t.page_name?t.page_name="edit-receiver-name-error":"billpay-start"===t.page_name||"billpaystart"===t.page_name?t.page_name="bill-payment":"receiver-payment"===t.page_name?t.page_name="receiver-payment":"redirect-receiver"===t.page_name&&"RASD"===sessionStorage.getItem("flowType")?t.page_name="redirect-receiver-review":"shareinfo"==t.page_name?t.page_name="receiver-assist-redirection-success":"rd-review"===t.page_name?(t.page_name="receiver-review","true"===sessionStorage.getItem("senderRedirect")?t.page_name="review-sender-redirection":t.page_name="receiver-review"):"rd-status"===t.page_name&&"true"!==sessionStorage.getItem("senderRedirect")?t.page_name="receiver-redirect-status":"ev-profile-confirmation"===t.page_name&&(t.kyc_option="eid"),"rd-status"==t.page_name&&"true"===sessionStorage.getItem("senderRedirect")&&("Success"===sessionStorage.getItem("redirectStatus")?t.page_name="sender-redirection-success":t.page_name="sender-redirection-failure"),"track-transfer-success"===t.page_name){var a=JSON.parse(sessionStorage.getItem("TransactionInquiryResponse"));_.has(a,"statusDetails.transactionIdentifier")&&(t.user_type=a.statusDetails.transactionIdentifier.toLowerCase()),_.get(a,"statusDetails.statusLabel")&&_.get(a,"transactionStatus")?t.mtcn_status=_.get(a,"statusDetails.statusLabel")+" - "+_.get(a,"transactionStatus"):t.mtcn_status=_.get(a,"transactionStatus")?_.get(a,"transactionStatus"):_.get(a,"statusDetails.statusLabel")}"receiver-redirect"==sessionStorage.getItem("userJourney")&&"rd-verify-transfer-details"==t.page_name&&(t.page_name="verifytransaction");var r="";getCookieValue("WUCountryCookie_")&&(r=getCookieValue("WUCountryCookie_").toUpperCase()),isFeatureEnabled("MAILING_ADDRESS_CONFIRMATION",r)&&"additional-information"===t.page_name&&(t.page_name="mailing-address"),"receipt"===t.page_name&&sessionStorage.getItem("scheduled_widget_type")&&(t.scheduled_widget_type=sessionStorage.getItem("scheduled_widget_type"));var n="page_"+t.page_name;t.page_name===wuSessionStorage.wuAmplitude_pageName&&"non-transactional"!=t.page_name&&"currency-converter"!=t.page_name||(t.device_id&&amplitude.getInstance().setDeviceId(t.device_id),updateWULanguage(),wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName&&(t.previous_page=wuSessionStorage.wuAmplitude_pageName),wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent&&(t.previous_event=wuSessionStorage.wuAmplitude_previousEvent),sessionStorage.setItem("wuAmplitude_previousEvent",n),previousPageName=t.page_name,setUtmSrcParameter(t),setReferrerParameter(t),logEvents(n,t),"true"==sessionStorage.getItem("forgotPasswordFindAccount")&&(logEvents(n+="-find-your-account",t),sessionStorage.setItem("forgotPasswordFindAccount","false")),sessionStorage.setItem("wuAmplitude_pageName",t.page_name),hadoopAnalyticsLogsEvents(n,t))}}function checkURLChange(e){if(e!==oldURL&&datahub_config.amplitude&&window.amplitude){var t=getCurrentPageNameURL();t&&(oldPageName=t,oldURL=e,logPageEvent())}}function checkPageNameChange(e){(e=checkCurrentPageName(e))!==oldPageName&&datahub_config.amplitude&&window.amplitude&&(oldPageName=e,logPageEvent())}function checkClickAttrName(e){var t="property is not available";if(e.indexOf("-")){var a=e.split("-")[0];-1!==["button","link","checkbox","tile","icon","toggle","tab","menu","footer","dropdown","info","radio","textbox","bar","option","menuicon","list"].indexOf(a)?t=e:"popupContainer"===a&&(t="button-close-overlay")}return t}function getAncestorElement(e,t){for(;(e=e.parentElement)&&!e.hasAttribute(t););return null!==e&&e.hasAttribute(t)?checkClickAttrName(e.getAttribute(t)):"property is not available"}function setAuthenticateCustomerInfo(e,t){t.config.headers&&t.config.headers.client_id;var a,r=countryConfig&&countryConfig.ConfigTemplate&&countryConfig.ConfigTemplate.partner&&countryConfig.ConfigTemplate.partner.name,n=200===t.status?"0 (passed)":"1 (failed)",o=sessionStorage.getItem("partnerRequestId")?sessionStorage.getItem("partnerRequestId"):null;a=t&&200===t.status?(new amplitude.Identify).setOnce("api_response_code",n).setOnce("api_reponse_message",getResponseMsg(r,n)).setOnce("Partner_name",r).setOnce("Login_datetime",getTodayDate()).setOnce("Country_Code",e.countryCode).setOnce("customer_reference_id",o):(new amplitude.Identify).setOnce("api_response_code",n).setOnce("api_reponse_message",getResponseMsg(r,n)),amplitude.getInstance().identify(a)}function setIntialUserIdentify(e){if(datahub_config.amplitude&&window.amplitude){var t=(new amplitude.Identify).setOnce("initial_utm_source",e.utm_source).setOnce("initial_utm_medium",e.utm_medium).setOnce("initial_utm_campaign",e.utm_campaign);amplitude.getInstance().identify(t)}}function getResponseMsg(e,t){return"Single Sign-on for "+e+" "+t}function getClickedAttrName(e){var t="property is not available",a="amplitude-id";return e.hasAttribute(a)?t=checkClickAttrName(e.getAttribute(a)):(e.id&&(t=checkClickAttrName(e.id)),"property is not available"===t&&e.dataset&&e.dataset.linkname&&(t=checkClickAttrName(e.dataset.linkname)),"property is not available"===t&&(t=getAncestorElement(e,a))),t}function logDisplayEvent(e){var t="";if(t=wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName?wuSessionStorage.wuAmplitude_pageName:previousPageName||"page name did not catch",window.amplitude&&datahub_config.amplitude){-1!==["send-money-option","price-estimator","history"].indexOf(t)&&sessionStorage.setItem("wuAmplitude_useSummaryObj",!1),checkNameChangeCancelTransferFlow();var a=getAnalyticsData();if(sessionStorage.removeItem("wuAmplitude_useSummaryObj"),sessionStorage.removeItem("wuAmplitude_useNameChangeObj"),sessionStorage.removeItem("wuAmplitude_useCancelTransferObj"),"property is not available"!==e){var r="displayed_["+t+"]_["+e+"]";a.page_name=t,updateWULanguage(),wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent&&(a.previous_event=wuSessionStorage.wuAmplitude_previousEvent),sessionStorage.setItem("wuAmplitude_previousEvent",r),logEvents(r,a)}}}function logEvergageExperienceAmplitudeEvent(e){if(window.amplitude&&datahub_config.amplitude)logEvergageExperienceInAmplitude(e);else var t=setInterval(function(){window.amplitude&&datahub_config.amplitude&&(clearInterval(t),logEvergageExperienceInAmplitude(e))},100)}function logEvergageExperienceInAmplitude(e){for(var t=JSON.parse(sessionStorage.getItem("evergageExperiences"))||[],a=!1,r=0;r<t.length;r++)t[r].ab_test==e.ab_test&&t[r].ab_test_variant==e.ab_test_variant&&(a=!0);if(!a){sessionStorage.setItem("ab_test",e.ab_test),sessionStorage.setItem("ab_test_variant",e.ab_test_variant);var n="";n=wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName?wuSessionStorage.wuAmplitude_pageName:previousPageName||"page name did not catch";-1!==["send-money-option","price-estimator","history"].indexOf(n)&&sessionStorage.setItem("wuAmplitude_useSummaryObj",!1),checkNameChangeCancelTransferFlow();var o=getAnalyticsData();e&&e.receiver_country&&(o.receiver_country=e.receiver_country);var s=getCookieValue("userIdentity")?getCookieValue("userIdentity"):"";s&&(o.user_pricing_session=s),sessionStorage.removeItem("wuAmplitude_useSummaryObj"),sessionStorage.removeItem("wuAmplitude_useNameChangeObj"),sessionStorage.removeItem("wuAmplitude_useCancelTransferObj");o.page_name=n,updateWULanguage(),wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent&&(o.previous_event=wuSessionStorage.wuAmplitude_previousEvent),sessionStorage.setItem("wuAmplitude_previousEvent","ab_test_experience"),t.push({ab_test:e.ab_test,ab_test_variant:e.ab_test_variant}),sessionStorage.setItem("evergageExperiences",JSON.stringify(t)),logEvents("ab_test_experience",o)}}function logJSErrors(e){var t={},a=getAnalyticsData();e.error&&window.amplitude&&datahub_config.amplitude&&(t.event_attr=a,t.error_message=e.message,t.location=e.location,logEvents("js_error",t))}function logClickEvent(e,t,a){var r="";if(r=wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName?wuSessionStorage.wuAmplitude_pageName:previousPageName||"page name did not catch","receiver-redirect"==sessionStorage.getItem("userJourney")&&("tracktransfer-success"==r?r="track-transfer-success":"rd-verify-transfer-details"==r?r="verifytransaction":"rd-review"==r&&(r="receiver-review")),window.amplitude&&datahub_config.amplitude){var n=window.event&&void 0!==window.event.srcElement.attributes?window.event.srcElement:e.target;if(t>-1){if(n.options)var o=n.options[n.selectedIndex];else o=n.closest("li");n=o}var s=getClickedAttrName(n);wuSessionStorage&&wuSessionStorage.amplitude_pageName_MYWU&&"link-apply-reward-promo"!==s&&"link-apply-reward-promo-summryWidget"!==s&&(r=wuSessionStorage.amplitude_pageName_MYWU),(wuSessionStorage&&wuSessionStorage.amplitude_pageName_MYWU&&"button-close-pop-up-cross"==s||"button-close-pop-up-bg"==s)&&sessionStorage.removeItem("amplitude_pageName_MYWU"),-1!==s.indexOf("tile-fundsOut-")&&modSMOTile(s,"wuAmplitudeSMO_fundsOut"),-1!==s.indexOf("tile-fundsIn-")&&modSMOTile(s,"wuAmplitudeSMO_fundsIn");-1!==["send-money-option","price-estimator","history"].indexOf(r)&&(sessionStorage.setItem("wuAmplitude_useSummaryObj",!1),"button-smo-continue"!==s&&"button-continue-online"!==s||sessionStorage.removeItem("wuAmplitude_useSummaryObj")),checkNameChangeCancelTransferFlow();var i=getAnalyticsData();if(sessionStorage.removeItem("wuAmplitude_useSummaryObj"),sessionStorage.removeItem("wuAmplitude_useNameChangeObj"),sessionStorage.removeItem("wuAmplitude_useCancelTransferObj"),"property is not available"!==s){if(!0===JSON.parse(sessionStorage.getItem("popUpOpened"))&&sessionStorage.getItem("popUpName")){var u="clicked_["+(c=sessionStorage.getItem("popUpName"))+"]_["+s+"]";i.page_name=c}else if("send-money-option"===r&&"Y"===sessionStorage.getItem("isDirectedCountry")&&document.getElementById("exchangeRate-agents-modal")&&document.getElementById("exchangeRate-agents-modal").classList.contains("in")||"button-close"==s&&"Y"===sessionStorage.getItem("isDirectedCountry")||"button-continue"==s&&"Y"===sessionStorage.getItem("isDirectedCountry")){u="clicked_["+(c="directed-services")+"]_["+s+"]";i.page_name=c}else if("review"!==r&&"history"!==r&&"price-estimator"!==r&&"send-inmate-start"!==r&&"receiver"!==r||"false"!==sessionStorage.getItem("FTCFlag")||"button-accept"!=s)if("button-close-overlay"===s)u="clicked_["+(c=sessionStorage.getItem("popUpName"))+"]_["+s+"]";else if("redirect-receiver"===r){u="clicked_["+(c="redirect-receiver")+"]_["+s+"]";i.page_name=c}else if("global-collectid"==r&&-1!==s.indexOf("icon-cancel")){u="clicked_["+(c="euid")+"]_["+s+"]";i.page_name=c}else if(-1!==s.indexOf("checkbox-offers-news-email"))u="clicked_["+r+"]_["+s+"]";else if(-1!==s.indexOf("checkbox-offers-news-post"))u="clicked_["+r+"]_["+s+"]";else if(-1!==s.indexOf("checkbox-offers-news-phone"))u="clicked_["+r+"]_["+s+"]";else if(-1!==s.indexOf("checkbox-offers-news-sms"))u="clicked_["+r+"]_["+s+"]";else if(-1!==s.indexOf("checkbox-3rd-party-data-sharing"))u="clicked_["+r+"]_["+s+"]";else if(-1!==s.indexOf("button-go-to-history"))u="clicked_["+r+"]_["+s+"]";else if(-1!==s.indexOf("checkbox-offers-news"))"complete-your-profile"===r&&(u="clicked_[profile-completion-page]_["+s+"]"),"profile"===r&&(u="clicked_[profile]_["+s+"]");else if(-1!==s.indexOf("checkbox-my-wu"))"complete-your-profile"===r&&(u="clicked_[complete-your-profile]_["+s+"]"),"profile"===r&&(u="clicked_[profile]_["+s+"]");else if("id-details"==r&&-1!==s.indexOf("button-confirm")){u="clicked_["+(c="name-confirmation")+"]_["+s+"]";i.page_name=c}else if("id-details"==r&&-1!==s.indexOf("link-go-back")){u="clicked_["+(c="name-confirmation")+"]_["+s+"]";i.page_name=c}else if("button-close-overlay"===s){u="clicked_["+(c="verify-email-overlay"===(c=sessionStorage.getItem("page_name"))?"verify-email-overlay":"signup-overlay")+"]_["+s+"]",i.page_name=r}else u=0==s.indexOf("menu-")?"clicked_["+s+"]":"menuicon"===s?"clicked_[link-menu]":"clicked_["+r+"]_["+s.toLowerCase()+"]",i.page_name=r,o&&(i.filter_period_selected=a,i.filter_result_count=t),"clicked_[send-money-option]_[button-smo-continue]"!==u||null!==i.funds_in&&void 0!==i.funds_in&&""!=i.funds_in||(i.funds_in="NA");else{var c,u="clicked_["+(c="ftc-fraud-warning")+"]_["+s+"]";i.page_name=r}updateWULanguage(),wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent&&(i.previous_event=wuSessionStorage.wuAmplitude_previousEvent),sessionStorage.setItem("wuAmplitude_previousEvent",u);var d=logCookiePopupClickEvents(e);d.click_event&&(u=d.click_event,i=d.clickEventAttr),hadoopAnalyticsLogsEvents(u,i),setUtmSrcParameter(i),setReferrerParameter(i),logEvents(u,i)}}}function hadoopAnalyticsLogsEvents(e,t){isEventKeyInHadoopAnalytics(e)&&sendToHadoopAnalytics(getHadoopAnalyticsData(getHadoopAnalyticsEventsData()[e],t))}function isEventKeyInHadoopAnalytics(e){var t=getHadoopAnalyticsEventsData();return!!Object.keys(t).filter(function(t){return t===e}).length}function isEventValueInHadoopAnalytics(e){return!!Object.keys(hadoopAnalyticsApiEvents).filter(function(t){return hadoopAnalyticsApiEvents[t]===e}).length}function getHadoopAnalyticsData(e,t){var a,r,n;"Send money validation completed"===e?(e=t.event_name?t.event_name:e,n=t.campaign_name?t.campaign_name:void 0,a=t.subscription_id?t.subscription_id:void 0,r=t.subscription_expiry_date?t.subscription_expiry_date:void 0):(a=isEventValueInHadoopAnalytics(e)?t.promoCampaignSubscriptionId:getCookieValue("promoCampaignSubscriptionId"),r=isEventValueInHadoopAnalytics(e)?t.promoCampaignSubscriptionEndDate:getCookieValue("promoCampaignSubscriptionEndDate"),n=sessionStorage.getItem("serverSidePromoCampaignName")||sessionStorage.getItem("promoPricingCampaignNameUrlParam")||sessionStorage.getItem("promoPricingCampaignName"));var o=t.session_id?t.session_id:t.device_id?t.device_id:"",s=getChannel(),i={event:e,timestamp:Date.now(),channel:{name:s.name,version:s.version},user:{device_id:t.device_id?t.device_id:"",session_id:o,logged_in:t.logged_in?t.logged_in:"",customer_id:customerId||void 0,campaign_name:n||void 0,subscription_id:a||void 0,subscription_expiry_date:r||void 0,transaction_count:getTransactionCount()},page:{name:t.page_name?t.page_name:"",exchange_rate:t.exchange_rate?t.exchange_rate:"",funds_in:t.funds_in?t.funds_in:"",funds_out:t.funds_out?t.funds_out:"",receiving_amount:t.receive_amount?t.receive_amount:"",receiving_currency:t.receive_currency?t.receive_currency:"",receiving_country:t.receiver_country?t.receiver_country:"",sending_amount:t.send_amount?t.send_amount:"",sending_country:t.sender_country?t.sender_country:"",sending_currency:t.send_currency?t.sender_country:"",transfer_fee:t.transfer_fee?t.transfer_fee:""}};return{records:[{key:i.user.session_id,value:i}]}}function getChannel(){var e={},t=sessionStorage.getItem("applicationName"),a=getURLParameter("cusType");return"PPS"===t||"PPS"===a?(e.name="Cruise",e.type="PPS",e.version="9740"):(e.name="Western Union",e.type="WEB",e.version="9Z00"),e}function getTransactionCount(){var e=sessionStorage.getItem("transactionHistoryResp");return e&&JSON.parse(e)instanceof Array?JSON.parse(e).length:0}function getBaseUrl(){var e=window.location.host,t="true"===sessionStorage.getItem("bMock");return window.location.host.indexOf("localhost")>-1&&(e=t?"wudispatcher-dev11.devwesternunion.com":"wudispatcher-qa11.qawesternunion.com"),"https://"+e}function sendToHadoopAnalytics(e){var t=getBaseUrl()+"/event/push",a=new XMLHttpRequest;a.open("POST",t,!0),a.setRequestHeader("Content-Type","application/vnd.kafka.json.v2+json; charset=UTF-8"),a.onload=function(){if(200===this.status){var e=this.response;console.log("Hadoop Analytics Resp- ",e)}},a.onerror=function(e,t,a){console.log("Hadoop Analytics Error- ",a)},a.send(e)}function hadoopAnalyticsSuccessCallback(e,t,a){}function hadoopAnalyticsErrorCallback(e,t,a){}function logErrorEvent(e,t){var a="",r="error_validation_"+(a=wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName?wuSessionStorage.wuAmplitude_pageName:previousPageName||"page name did not catch");if(window.amplitude&&datahub_config.amplitude){var n=getAnalyticsData();n.field_label=e,n.page_name=a,updateWULanguage(),logEvents(r,n)}}function logCookieNotificationEvent(){if(window.amplitude){var e=getAnalyticsData();e.wu_cookie_preference="m",logEvents("message_cookiesettings",e),sessionStorage.setItem("wuAmplitude_previousEvent","message_cookiesettings")}}function getCookiePreferenceSelected(){var e,t=document.querySelector("input[name=wu-option-cookie-opt]:checked")&&document.querySelector("input[name=wu-option-cookie-opt]:checked").value;return"CKTXNL+CKPERF+CKMKTG"===t?e="m":"CKTXNL+CKPERF"===t?e="p":"CKTXNL"===t&&(e="t"),e}function manageCookiePopupEvent(){if(window.amplitude){var e=getAnalyticsData();getCookiePreferenceSelected()?e.wu_cookie_preference=getCookiePreferenceSelected():e.wu_cookie_preference="m",logEvents("pop-up_[managecookies]",e),sessionStorage.setItem("wuAmplitude_previousEvent","pop-up_[managecookies]")}}function logCookiePopupClickEvents(e){if(window.amplitude){var t=getClickedAttrName(window.event&&void 0!==window.event.srcElement.attributes?window.event.srcElement:e.target),a=getAnalyticsData(),r="";return"link-managecookies"===t&&(r="clicked_[cookiesettings]_["+t+"]"),"footer-changecookiesettings"===t&&(r="clicked_["+t+"]"),"radio-marketing"===t&&(r="clicked_[managecookies]_["+t+"]"),"radio-performance"===t&&(r="clicked_[managecookies]_["+t+"]"),"radio-transactional"===t&&(r="clicked_[managecookies]_["+t+"]"),"icon-cookie-popup-close"!==t&&"button-cookie-popup-close"!==t||(r="clicked_[managecookies]_["+t+"]",getCookiePreferenceSelected()?a.wu_cookie_preference=getCookiePreferenceSelected():a.wu_cookie_preference="m"),{click_event:r,clickEventAttr:a}}}function logPopUpEvent(){var e="";if(e=wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName?wuSessionStorage.wuAmplitude_pageName:previousPageName||"page name did not catch",window.amplitude&&datahub_config.amplitude){var t=getAnalyticsData();sessionStorage.removeItem("wuAmplitude_useSummaryObj"),sessionStorage.removeItem("wuAmplitude_useNameChangeObj"),sessionStorage.removeItem("wuAmplitude_useCancelTransferObj");var a=sessionStorage.getItem("popUpName");if(t.funds_in=a,"send-money-option"===e&&"Y"===sessionStorage.getItem("isDirectedCountry")&&document.getElementById("exchangeRate-agents-modal")&&document.getElementById("exchangeRate-agents-modal").classList.contains("in"))a="directed-services";else if(("review"===e||"price-estimator"===e||"send-inmate-start"===e||"receiver"===e)&&"true"===sessionStorage.getItem("FTCFlag")||"history"===e&&document.querySelector(".fraud-popup-modal")&&document.querySelector(".fraud-popup-modal").classList.contains("in"))a="ftc-fraud-warning";else if("redirect-receiver"===e)a="redirect-receiver";else if("receipt"===e&&sessionStorage.getItem("isJamaicaD2B"))a="receipt-ask-receiver-to-register";else if("receiverredirectstatus"===e&&sessionStorage.getItem("isJamaicaD2B"))a="sender-redirection-success-ask-receiver-to-register";if("send-money-option"===e&&"true"!=sessionStorage.getItem("FTCFlag"))var r="pop-up_[smo-fundsin-instructions]";else r="pop-up_["+a+"]";t.page_name=e,updateWULanguage(),wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent&&(t.previous_event=wuSessionStorage.wuAmplitude_previousEvent),sessionStorage.setItem("wuAmplitude_previousEvent",r),setUtmSrcParameter(t),setReferrerParameter(t),null!=a&&logEvents(r,t)}}function logTabEvent(e){var t="";if(9===e.keyCode&&(t=wuSessionStorage&&wuSessionStorage.wuAmplitude_pageName?wuSessionStorage.wuAmplitude_pageName:previousPageName||"page name did not catch",window.amplitude&&datahub_config.amplitude&&("register"===t||"new-payment"===t))){var a=getClickedAttrName(window.event&&void 0!==window.event.srcElement.attributes?window.event.srcElement:e.target),r=getAnalyticsData();if("property is not available"!==a&&"button-continue"!==a){var n="clicked_["+t+"]_["+a+"]";r.page_name=t,updateWULanguage(),wuSessionStorage&&wuSessionStorage.wuAmplitude_previousEvent&&(r.previous_event=wuSessionStorage.wuAmplitude_previousEvent),sessionStorage.setItem("wuAmplitude_previousEvent",n),logCookiePopupClickEvents(e)}}}function logAppDownloadBanner(){let e=document.querySelector("#app-smart-banner");e&&"block"===getComputedStyle(e).display&&"download-app-banner"==sessionStorage.getItem("popUpName")&&window.logPopUpEvent()}function logEvergageAbTest(){JSON.parse(sessionStorage.getItem("customAppBanner"))&&logEvergageExperienceAmplitudeEvent&&logEvergageExperienceAmplitudeEvent({ab_test:"us_web_app-banner",ab_test_variant:"us_web_app-banner_code"})}setSofToSession(),window.setInterval(function(){checkURLChange(window.location.href)},100),window.setInterval(function(){var e=wuSessionStorage.page_name,t=window.location.href;void 0!==e&&-1===t.indexOf(".html")&&checkPageNameChange(e)},100),logAppDownloadBanner(),document.onclick=function(e,t,a){logClickEvent(e,t,a),window.mParticle&&logmParticleClickEvent&&logmParticleClickEvent(e,t,a)},document.onkeyup=function(e){logTabEvent(e),window.mParticle&&logmParticleTabEvent&&logmParticleTabEvent(e)};