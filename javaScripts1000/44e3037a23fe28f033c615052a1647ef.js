function validateLayer(){var e=dataLayer||window.dataLayer,a=!1,t=!1,r=!1;if(!e||e.length<2)return!1;for(var s=0;s<e.length;s++){var c=e[s];"string"==typeof c.pageCategory&&(a=!0),"boolean"==typeof c.visitorLoginState&&(t=!0),"string"==typeof c.event&&"CARTLOADED"===c.event.toUpperCase()&&(r=!0)}return a||r||t}function buildComplete(){buildUserMeta(),buildPageMeta(!0),_recsysTrackCalled||callTracker(_recsysTrackCalled=!0)}function buildPartial(){try{buildUserMeta(),buildPageMeta(!1),window.biggyFrontRunAsync instanceof Function?window.biggyFrontRunAsync():window.addEventListener("biggyready",function(){window.biggyFrontRunAsync()})}catch(e){isReady=!1,console.log(e)}}function buildPageMeta(e){metadados_recsys.page={};for(var a=0;a<dataLayer.length;a++)if(dataLayer[a].pageCategory){pageInfo=dataLayer[a];break}var t=recsysTrackExtras.isPageTypeCampaign||function(){},r=recsysTrackExtras.isPageTypeDepartment||function(){},s=recsysTrackExtras.isPageTypeCategory||function(){},c=recsysTrackExtras.isPageTypeOther||function(){},o=recsysTrackExtras.isPageTypeWishlist||function(){},n=recsysTrackExtras.isPageTypeHome||function(){},i=recsysTrackExtras.isPageTypeEmptySearch||function(){},d=recsysTrackExtras.isPageTypeAccount||function(){},u=recsysTrackExtras.isPageTypeNotFound||function(e){return"404"==e.pageCategory.toLowerCase()};if(pageInfo.pageCategory){var l=pageInfo.pageCategory.toUpperCase();switch(t(pageInfo)?l="CAMPAIGN":r(pageInfo)?l="DEPARTMENT":s(pageInfo)?l="CATEGORY":c(pageInfo)?l="OTHER":o(pageInfo)?l="WISHLIST":n(pageInfo)?l="HOME":i(pageInfo)?l="BUSCAVAZIA":u(pageInfo)?l="NOTFOUND":d(pageInfo)&&(l="ACCOUNT"),l){case"HOME":metadados_recsys.page.name="home";break;case"ORDERS":metadados_recsys.page.name="order_list";break;case"BUSCAVAZIA":metadados_recsys.page.name="empty_search";break;case"CONTATO":case"PERGUNTAS-FREQUENTES":case"FRANQUEADO":case"COMO-COMPRAR":case"FORMAS-DE-PAGAMENTO":case"CUSTO-FRETE":case"PRAZOS-DE-ENTREGA":case"TROCAS-E-DEVOLUCOES":case"TERMOS-E-CONDICOES":case"POLITICA-DE-PRIVACIDADE":case"ACCOUNT":metadados_recsys.page.name="internals";break;case"INTERNALSITESEARCH":buildSearchMeta(pageInfo);break;case"CATEGORY":buildCategoryOrDepartmentMeta(pageInfo,e,!1);break;case"DEPARTMENT":buildCategoryOrDepartmentMeta(pageInfo,e,!0);break;case"CAMPAIGN":buildCampaignMeta(pageInfo);break;case"PRODUCT":buildProductMeta(pageInfo,e);break;case"WISHLIST":metadados_recsys.page.name="wishlist";break;case"NOTFOUND":metadados_recsys.page.name="not_found";break;default:buildOtherMeta(pageInfo)}}else{var m=!1;for(a=0;a<dataLayer.length;a++)if((pageInfo=dataLayer[a]).event){switch(pageInfo.event.toUpperCase()){case"CARTLOADED":case"CART":buildCartMeta(pageInfo),m=!0;break;case"ORDERPLACED":buildOrderPlacedMeta(pageInfo),m=!0}if(m)break;buildOtherMeta(pageInfo)}}}function buildOrderPlacedMeta(e){metadados_recsys.page.name="confirmation",metadados_recsys.transaction={},metadados_recsys.transaction.id=e.transactionId,metadados_recsys.transaction.items=[];for(var a=0;a<e.transactionProducts.length;a++){var t={};t.id=e.transactionProducts[a].id,t.price=e.transactionProducts[a].sellingPrice,t.sku=e.transactionProducts[a].sku;var r={};r.product=t,r.quantity=e.transactionProducts[a].quantity,metadados_recsys.transaction.items.push(r)}}function buildCartProductMeta(e){return(_recsysTrackExtras.buildCartProductMeta||function(e){var a={};return a.id=e.productId||e.id,a.price=e.sellingPrice,a.sku=e.productId?e.id:e.sku,a})(e)}function buildCartMeta(e){if(0!==$(".checkout-container.orderform-active").length&&"cart"!==e.event)metadados_recsys.page.name="checkout";else{0<e.orderFormProducts.length?metadados_recsys.page.name="cart":metadados_recsys.page.name="empty_cart",metadados_recsys.cart={},metadados_recsys.cart.items=[];for(var a=0;a<e.orderFormProducts.length;a++){var t=buildCartProductMeta(e.orderFormProducts[a]),r={};r.quantity=e.orderFormProducts[a].quantity,r.product=t,metadados_recsys.cart.items.push(r)}}}function processPush(e){var a,t=e.event,r=e["gtm.elementClasses"],s=e["gtm.elementId"],c=e["gtm.element"],o=recsysTrackExtras.itemRemoveCartElementClasses,n=recsysTrackExtras.itemAddItemQuantityElementClasses||"icon icon-plus-sign",i=recsysTrackExtras.itemRemoveItemQuantityElementClasses||"icon icon-minus-sign",d=recsysTrackExtras.parentDataSkuMaxLayer||5,u=0;if(null!=metadados_recsys.page&&("cart"==metadados_recsys.page.name||"checkout"==metadados_recsys.page.name)&&void 0!==metadados_recsys.cart&&void 0!==metadados_recsys.cart.items)if("gtm.click"===t&&r===o){for(a=metadados_recsys.cart.items.length-1;0<=a;a--){for(u=0,currentElement=c;!c.hasAttribute("data-sku")&&u<d;)c=c.parentElement,u++;metadados_recsys.cart.items[a].product.sku===c.getAttribute("data-sku")&&metadados_recsys.cart.items.splice(a,1)}var l=0===metadados_recsys.cart.items.length;l&&(metadados_recsys.page.name="empty_cart"),(!!recsysTrackExtras.alwaysUpdateOnRemove||l)&&"undefined"!=typeof Biggy&&void 0!==Biggy.Main&&Biggy.Main.run(),callTracker(!1)}else if("gtm.click"===t&&"cart-to-orderform"===s||"profile"===t||"payment"===t||"email"===t)callTracker(!(metadados_recsys.page.name="checkout")),"undefined"!=typeof Biggy&&void 0!==Biggy.Main&&Biggy.Main.run();else if("gtm.click"!==t||r!==n&&r!==i)"cart"===t&&buildCartMeta(e);else{var m=r===n?1:-1;for(a=metadados_recsys.cart.items.length-1;0<=a;a--){for(u=0,currentElement=c;!c.hasAttribute("data-sku")&&u<d;)c=c.parentElement,u++;metadados_recsys.cart.items[a].product.sku===c.getAttribute("data-sku")&&(metadados_recsys.cart.items[a].quantity+=m,metadados_recsys.cart.items[a].quantity<=0&&(metadados_recsys.cart.items[a].quantity=1))}}}function buildOtherMeta(e){if(e.pageDepartment&&"PRODUTOS"===e.pageDepartment.toUpperCase()){metadados_recsys.page.name="campaign";for(var a="",t=0;t<e.pageCategory.split("-").length;t++)a+=titleCase(e.pageCategory.split("-")[t])+" ";metadados_recsys.campaign={},metadados_recsys.campaign.name=a.trim(),metadados_recsys.campaign.items=[];for(var r=0;r<e.shelfProductIds.length;r++)if(!(e.shelfProductIds[r]instanceof Function)){var s={};s.id=e.shelfProductIds[r],metadados_recsys.campaign.items.push(s)}}else metadados_recsys.page.name="other"}function buildSearchMeta(e){metadados_recsys.page.name="search",metadados_recsys.search={},metadados_recsys.search.query=e.siteSearchTerm,metadados_recsys.search.items=[];for(var a=0;a<e.shelfProductIds.length;a++)if(!(e.shelfProductIds[a]instanceof Function)){var t={};t.id=e.shelfProductIds[a],metadados_recsys.search.items.push(t)}}function buildCampaignMeta(e){metadados_recsys.page.name="campaign";var a={};a.id=e.categoryId,a.name=titleCase(e.categoryName),a.items=[];for(var t=0;t<e.shelfProductIds.length;t++)if(!(e.shelfProductIds[t]instanceof Function)){var r={};r.id=e.shelfProductIds[t],a.items.push(r)}metadados_recsys.campaign=a}function buildCategoryOrDepartmentMeta(e,a,t){if(metadados_recsys.page.name=t?"department":"category",metadados_recsys.categories=[],metadados_recsys.items=[],void 0!==e.categoryId&&null!==e.categoryId){var r={};r.id=e.categoryId,r.name=titleCase(e.categoryName)}if(void 0!==e.shelfProductIds&&null!==e.shelfProductIds&&0<e.shelfProductIds.length)for(var s=0;s<e.shelfProductIds.length;s++)if(!(e.shelfProductIds[s]instanceof Function)){var c={};c.id=e.shelfProductIds[s],metadados_recsys.items.push(c)}if(a&&void 0!==e.categoryId&&null!==e.categoryId){var o=getCategoryInfo(e.categoryId),n=[];n.push(o);for(var i=[];void 0!==o.parentId&&null!==o.parentId;){var d=getCategoryInfo(o.parentId);i.unshift(d.id),n.push(d),o=d}for(;0<n.length;){var u=n.shift(),l=i.pop();metadados_recsys.categories.unshift({id:u.id,name:u.name,parents:l?[l]:[]})}r=metadados_recsys.categories.pop()}null!=r&&metadados_recsys.categories.push(r),0===metadados_recsys.categories.length&&delete metadados_recsys.categories}function sendExternalProduct(e){var a={provider:"vtex",data:JSON.stringify(e)},t=new XMLHttpRequest,r="//api.biggylabs.com.br/track-api/v2/external_product/"+_recsysa.id+"/"+e[0].productId;t.open("POST",r),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.send(JSON.stringify(a))}function buildProductMeta(e,a){0===Number(e.productListPriceTo)&&0===Number(e.productPriceTo)?metadados_recsys.page.name="product_unavailable":metadados_recsys.page.name="product",metadados_recsys.product={},metadados_recsys.product.id=e.productId;var t=recsysTrackExtras.getBrand||function(e){return titleCase(e.productBrandName)};if(metadados_recsys.product.brand=t(e),a){var r=getProductInfo(e.productId),s=r[0],c=recsysTrackExtras.buildProductPrices||buildProductPrices;(recsysTrackExtras.buildProductInfo||buildProductInfo)(s,e),buildProductTags(s),buildProductSpecsByProduct(s),c(s,e),buildProductSKUsByProduct(s),buildProductCategories(s),buildProductExtraInfo(s,getProductRate(e.productId)),buildProductImages(s),sendExternalProduct(r)}}function buildProductInfo(e,a){metadados_recsys.product.name=titleCase(a.productName),metadados_recsys.product.url=e.link,metadados_recsys.product.status="unavailable";var t=recsysTrackExtras.productDescriptionElement||".productDescription";metadados_recsys.product.description=e.metaTagDescription||$(t).html()}function buildProductTags(r){var e=recsysTrackExtras.buildProductTags||function(){for(var e=[],a=r.categories[0].split("/"),t=1;t<a.length-1;t++)a[t]&&e.push(a[t]);return e};metadados_recsys.product.tags=e(r)}function buildProductExtraInfo(e,a){buildProductStickersByProduct(e);var t=recsysTrackExtras.buildProductExtraInfo||function(e){metadados_recsys.product.extra_info={},"undefined"!=typeof skuJson_0&&void 0!==skuJson_0.skus&&0<skuJson_0.skus.length&&void 0!==skuJson_0.skus[0].sellerId&&(metadados_recsys.product.extra_info.sellerId=skuJson_0.skus[0].sellerId),e&&(metadados_recsys.product.extra_info.rating=e.average,metadados_recsys.product.extra_info.ratingCount=e.count);for(var a=recsysTrackExtras.genders||["feminino","masculino"],t=metadados_recsys.product.categories||[],r=0;r<t.length;r++)if(t[r]&&-1!==a.indexOf(t[r].name.toLowerCase())){metadados_recsys.product.extra_info.gender=t[r].name.toLowerCase();break}return metadados_recsys.product.extra_info};metadados_recsys.product.extra_info=t(e,a)}function editImageUrl(e){var a=e.split(/\/(ids\/\d+)\//),t=recsysTrackExtras.cropImageWidthHeight;t||(t="-500-500"),a[1]+=t;var r=a.join("/");return r.substr(r.indexOf("/arquivos"),r.length)}function getProductImages(e){return(_recsysTrackExtras.getProductImages||function(e){var a=recsysTrackExtras.useImageApiLabel;return buildItemImages(e.items[0],!!a)})(e)}function buildProductImages(e){var a=getProductImages(e);metadados_recsys.product.images=a}function buildItemImages(e,a){itemImages={};var t=e.images,r=["default","second","third","fourth","fifth","sixth"];if(null!=t&&0!==t.length){for(var s=0;s<t.length;s++){var c=t[s];if(void 0===c.imageLabel||!c.imageLabel||"thumb"!==c.imageLabel.toLowerCase()&&"swatch"!==c.imageLabel.toLowerCase())if(!0===a&&null!=c.imageLabel&&""!==c.imageLabel)itemImages[c.imageLabel.toLowerCase()]=editImageUrl(c.imageUrl);else{var o=r.shift();if(itemImages[o]=editImageUrl(c.imageUrl),0===r.length)break}}return itemImages}}function buildProductCategories(e){metadados_recsys.product.categories=[];for(var a=e.categories[0].split("/"),t=e.categoriesIds[0].split("/"),r=[],s=1;s<a.length-1;s++)a[s]&&t[s]&&(metadados_recsys.product.categories.push({id:t[s],name:a[s],parents:r}),r=[t[s]])}function buildProductStickersByProduct(e){if(null!=recsysTrackExtras.useStickers&&recsysTrackExtras.useStickers&&(metadados_recsys.product.extra_info=metadados_recsys.product.extra_info||{},metadados_recsys.product.extra_info.stickers=[],null!=e.productClusters))for(var a in e.productClusters)if(e.productClusters.hasOwnProperty(a)){var t=e.productClusters[a]||"";metadados_recsys.product.extra_info.stickers.push(t.replace(/\s/g,"-"))}}function buildProductSpecsByProduct(e){if(metadados_recsys.product.specs={},e.items){var a=recsysTrackExtras.buildProductSpecs||function(){};metadados_recsys.product.specs=a(e)}}function buildProductPrices(e,a){if(e&&e.items&&0<e.items.length){var t=getSellerFromProduct(e);metadados_recsys.product.price=t.commertialOffer.PriceWithoutDiscount,t.commertialOffer.ListPrice!==metadados_recsys.product.price&&(metadados_recsys.product.old_price=t.commertialOffer.ListPrice);var r=getInstallmentFromSeller(t);r&&(metadados_recsys.product.installment={},metadados_recsys.product.installment.count=r.NumberOfInstallments,metadados_recsys.product.installment.price=r.Value)}}function buildSKUPrices(e){var a={};a.price=e.commertialOffer.PriceWithoutDiscount,e.commertialOffer.ListPrice!==a.price&&(a.old_price=e.commertialOffer.ListPrice);var t=getInstallmentFromSeller(e);return t&&(a.installment={},a.installment.count=t.NumberOfInstallments,a.installment.price=t.Value),a}function getInstallmentFromSeller(e){if((!e.commertialOffer.DiscountHighLight||0==e.commertialOffer.DiscountHighLight.length)&&e.commertialOffer.Installments&&0<e.commertialOffer.Installments.length){var a=e.commertialOffer.Installments[0];for(i=1;i<e.commertialOffer.Installments.length;i++){var t=e.commertialOffer.Installments[i];a.NumberOfInstallments<t.NumberOfInstallments&&(a=t)}return a}}function getSellerFromProduct(e){for(i=0;i<e.items.length;i++){var a=e.items[i];if(a.sellers&&0<a.sellers.length)for(j=0;j<a.sellers.length;j++){var t=a.sellers[j];if(t.sellerDefault&&0<t.commertialOffer.Price)return t}}return e.items[0].sellers[0]}function buildProductSKUsByProduct(e){var a=recsysTrackExtras.useImageApiLabel,t=recsysTrackExtras.buildSKUPrices||buildSKUPrices;if(metadados_recsys.product.skus=[],e.items)for(var r=0,s=e.items.length;r<s;r++){var c={},o=e.items[r];c.sku=o.itemId,c.eanCode=o.ean,c.stock=parseInt(pageInfo.skuStocks[c.sku]),c.status=0<c.stock?"available":"unavailable","available"===c.status&&(metadados_recsys.product.status="available"),c.images=buildItemImages(o,a);for(var n=0;n<o.sellers.length;n++){var i=o.sellers[n];if(i.sellerDefault){var d=t(i);c.price=d.price,c.old_price=d.old_price,c.installment=d.installment;break}}var u=recsysTrackExtras.buildSkuSpecs||function(){};c.specs=u(o),metadados_recsys.product.skus.push(c)}}function buildUserMeta(){for(var e,a=0;a<dataLayer.length;a++)dataLayer[a].visitorLoginState&&(e=dataLayer[a]);if(e&&e.visitorLoginState){if(metadados_recsys.user={},metadados_recsys.user.id=e.visitorID||e.visitorId,metadados_recsys.user.email=e.visitorContactInfo[0],metadados_recsys.user.allow_mail_marketing=!0,metadados_recsys.user.language="pt-BR",e.visitorContactInfo[1]){var t=e.visitorContactInfo[1];-1===t.indexOf("*")&&(e.visitorContactInfo[2]&&(t+=" "+e.visitorContactInfo[2]),metadados_recsys.user.name=t)}e.visitorDemographicInfo&&(metadados_recsys.user.gender=e.visitorDemographicInfo.gender)}else for(a=0;a<dataLayer.length;a++)if((e=dataLayer[a]).visitorContactInfo&&e.visitorContactInfo[0]){metadados_recsys.user={},metadados_recsys.user.email=e.visitorContactInfo[0],metadados_recsys.user.allow_mail_marketing=!0,metadados_recsys.user.language="pt-BR";break}}function getProductInfo(e){var a=new XMLHttpRequest;return a.open("GET","/api/catalog_system/pub/products/search/?fq=productId:"+e,!1),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Content-type","application/json"),a.send(),JSON.parse(a.responseText)}function getCategoryInfo(e){var a=new XMLHttpRequest;return a.open("GET","/api/catalog_system/pub/category/"+e,!1),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Content-type","application/json"),a.send(),JSON.parse(a.responseText)}function getProductRate(){return{}}function titleCase(e){if(!e)return e;for(var a=e.toLowerCase().split(" "),t=0;t<a.length;t++)a[t]=a[t].charAt(0).toUpperCase()+a[t].substring(1);return a.join(" ")}function lastWord(e){var a=e.split(" ");return a[a.length-1]}function callTracker(e){if("undefined"!=typeof RecSys){if(!(recsysTrackExtras.isValidRoute||null==window.location.href.match(/(lojacolaborador|vtexcommercestable)/g)))return;RecSys.Tracker(_recsysa.id,_recsysa.host,e?_recsysa.options:{})}else window.addEventListener("biggytrackready",function(){callTracker(e)})}function biggyDebounce(r,s){var c=[];return function(){var e=this,a=arguments,t=(new Date).getTime();c.push(t),setTimeout(function(){c[c.length-1]===t&&(s.apply(e,a),c=[])},r)}}function addCartUpdateEvent(){var a=biggyDebounce(_recsysTrackExtras.cartUpdatedInterval||1e3,function(e,a){try{var t=!recsysTrackExtras.validateCartUpdate||!!recsysTrackExtras.validateCartUpdate();if(!a||!a.items||!t)return;buildCartMetaByOrderForm(a),pushDataLayerCartEvent(a)}catch(e){console.log(e)}});if("function"==typeof tb_showIframe){var t=tb_showIframe||null;tb_showIframe=function(){t();var e=window.frames[$("#TB_iframeContent").attr("name")];e&&$(e).bind("orderFormUpdated.vtex",a)}}$(window).on("orderFormUpdated.vtex",a)}function createCartMeta(){var e=[];if(null!=metadados_recsys.cart&&null!=metadados_recsys.cart.items)for(var a=0;a<metadados_recsys.cart.items.length;a++){var t=metadados_recsys.cart.items[a];e.push(t.product.sku)}return e.join("|")}function buildCartMetaByOrderForm(e){if(e){var a=metadados_recsys.page.name,t=createCartMeta();metadados_recsys.page.name=0<e.items.length?"cart":"empty_cart",metadados_recsys.cart={},metadados_recsys.cart.items=[];for(var r=0;r<e.items.length;r++){var s=e.items[r],c=buildCartProductMeta(s);c.price=Number((Number(c.price)/100).toFixed(2));var o={};o.quantity=s.quantity,o.product=c,metadados_recsys.cart.items.push(o)}var n=createCartMeta();RecSys.Tracker(_recsysa.id,_recsysa.host,{}),a.match("cart")?"undefined"!=typeof Biggy&&void 0!==Biggy.Main&&t!=n&&Biggy.Main.run():metadados_recsys.page.name=a}}function pushDataLayerCartEvent(e){if(recsysTrackExtras.pushDataLayerCartEvent){var a=window.dataLayer||dataLayer,t=createCartEvent(e);a.push(t)}}function createCartEvent(e){if(e){for(var a=[],t=[],r=0;r<e.items.length;r++){var s=e.items[r],c={};c.id=s.id,c.quantity=s.quantity,t.push(s),a.push(c)}return{event:"cart",ecommerce:{checkout:{products:a}},orderFormProducts:t}}}function runMain(){var e=window.dataLayer||dataLayer,a=e.push,t=!1;validateLayer()&&(t=!0,buildPartial()),e.push=function(){try{a.apply(this,arguments),validateLayer()&&!t&&(t=!0,buildPartial()),t&&processPush(arguments[0])}catch(e){console.log(e)}},"complete"===document.readyState?(addCartUpdateEvent(),buildComplete()):window.addEventListener("load",function(){addCartUpdateEvent(),buildComplete()})}var recsysTrackExtras=window._recsysTrackExtras||_recsysTrackExtras||{};if(recsysTrackExtras.isScriptAllowed()){var _recsysTrackCalled=!1,metadados_recsys=window.metadados_recsys||{},pageInfo={};!function(){var e=document.createElement("script");e.src=recsysTrackExtras.scriptSrc,e.async=!0;var a=document.getElementsByTagName("script")[0];if(a.parentNode.insertBefore(e,a),recsysTrackExtras.analyticsLoaderUrl&&""!==recsysTrackExtras.analyticsLoaderUrl){var t=document.createElement("script");t.src=recsysTrackExtras.analyticsLoaderUrl,t.async=!0,a.parentNode.insertBefore(t,a)}}(),function(){if(null!=window.dataLayer||"undefined"!=typeof dataLayer)runMain();else{var e,a=10;e=setInterval(function(){null!=window.dataLayer||"undefined"!=typeof dataLayer?(clearInterval(e),runMain()):--a<=0&&clearInterval(e)},500)}}()}