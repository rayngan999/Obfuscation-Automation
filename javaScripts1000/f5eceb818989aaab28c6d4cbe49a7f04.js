Cube("datav:/npm/dchart-core/2.6.52/line/line",["datav:/npm/dchart-core/2.6.52/datav","datav:/npm/dchart-core/2.6.52/util","datav:/npm/dchart-core/2.6.52/util/animation","datav:/npm/d3/3.5.12"],function(a,b,c){function d(a,b){var c={xaxis:{orient:"bottom"},yaxis:{key:"y"},label:{show:!1,dx:0,dy:"-1em",anchor:"middle",color:"#fff",strokeWidth:0},line:{style:"solid",dashed:"4 4"},series:[{color:null,colorWidth:null}]};c=k.deepMerge(c,b),f.call(this,a,c)}var f=c("datav:/npm/dchart-core/2.6.52/datav"),j=c("datav:/npm/d3/3.5.12"),k=c("datav:/npm/dchart-core/2.6.52/util"),g=c("datav:/npm/dchart-core/2.6.52/util/animation");return d=f.extend(d,{data:function(a){if(!a)return this._data;var b=this.options,c=b.yaxis.key,d=b.xaxis.key;if(a.forEach(function(a){k.isArray(a[c])||(a[c]=[a[c]]),a[c]=k.map(a[c],function(a){return"string"==typeof a.value&&(a.value=k.toNumber(a.value)),a.value||b.hiddenEmptyData||(a.value=0),a})}),b.xaxis.format&&"time"===b.xaxis.type){var f=j.time.format(b.xaxis.format);a.sort(function(a,b){return f.parse(a[d])-f.parse(b[d])})}this._data=a},getSelector:function(){return this.svg.selectAll(".scatterplot-g, .scatterplot2-g").selectAll(".series-group").selectAll(".serie")},afterRender:function(){var a=this.options,b=this.getComs("tooltip","tooltip");b&&b.update(this.data(),a.tooltip,a),b&&b.updateEvent(this.getSelector.bind(this)),a.tooltip&&!a.tooltip.show&&b&&b.clearListeners(),this.svg[0][0].appendChild(this.labels[0][0])},updateAfterRender:function(){d.prototype.afterRender.call(this)},calLineData:function(b,c){var d=this.options,f=d.xaxis.key,g=d.yaxis.key,h=[];return b.length?((b=k.filter(b,function(a){return!d.hiddenEmptyData||!a[g][c].__isNull})).forEach(function(a){if(k.isNumber(+a[g][c].value)){var b={};b[f]=a[f],b[g]=+a[g][c].value,h.push(b)}}),h):[]},changeSeries:function(){var q,v,w=this.options,x=this.data(),e=w.xaxis.key,s=w.yaxis.key,a=this;q=this.getComs("axis","xaxis"),v=this.getComs("axis","yaxis");var n=q.getX(),l=v.getX(),o=k.maxBy(x,function(a){return a[s].length})[s].length,r=this.svg.select(".series:not(.area2-g)").attr("transform");this.labels.attr("transform",r);var c=function(m,o){var u=this,c=j.svg.line().x(function(a){return"time"===w.xaxis.type&&"string"==typeof a[e]?n(j.time.format(q.options.format).parse(a[e]))+(n.rangeBand?n.rangeBand()/2:0):n(a[e])+(n.rangeBand?n.rangeBand()/2:0)}).y(function(a){return l(k.isNumber(a[s])?a[s]:v.getMin())});u.attr("clip-path","url(#"+a.clipPathId+")");var x=function(){return a.clipPath.attr("d",k.getRectPath(0,0,h,f))};c.interpolate(w.series[o]&&w.series[o].interpolate||w.interpolate||"");var h=w.width,f=w.height,p=function(){x(),u.attr("d",c)};a.addResumeTween(p),g({animationHandler:function(b){var e=b.duration,g=b.ease;w.isFirst||!w.animationUpdateFromPrevious?(u.attr({d:c}),a.clipPath.transition().duration(e).ease(g).attrTween("d",function(){var a=j.interpolate(0,h);return function(b){return k.getRectPath(0,0,a(b),f)}})):(x(),u.transition().duration(e).ease(g).attr("d",c))},notAnimationHandler:p,options:w}),u.style({stroke:function(){return w.series[o]&&w.series[o].color&&w.series[o].color.res||w.color&&w.color.res},"stroke-width":function(){return w.series[o]&&w.series[o].colorWidth||w.colorWidth},"stroke-dasharray":function(){return w.series[o]&&"dashed"===w.series[o].style&&(w.series[o].dashed||"4 4")||"dashed"===w.line.style&&w.line.dashed||"none"},fill:"none","pointer-events":"none"})},d=function(b,d){var f=b[s][d];return w.hiddenEmptyData&&0===f.value?(this.html(""),null):void(b&&k.isNumber(f.value)?this.attr({x:function(){return n("time"===w.xaxis.type?j.time.format(q.options.format).parse(b[e]):b[e])+("category"===w.xaxis.type?n.rangeBand()/2:0)},y:function(){return l(f.value)},dx:function(){return w.series[d]&&w.series[d].label&&w.series[d].label.dx||w.label.dx||0},dy:function(){return w.series[d]&&w.series[d].label&&w.series[d].label.dy||w.label.dy||0}}).html(function(){var c=w.series[d]&&w.series[d].label&&w.series[d].label.format||w.label.format||null;return c?c.call(a,b,d):f.value}).style({"text-anchor":function(){return w.series[d]&&w.series[d].label&&w.series[d].label.anchor||w.label.anchor||"middle"},display:function(){return(w.series[d]&&w.series[d].label&&"boolean"==typeof w.series[d].label.show?w.series[d].label.show:"boolean"==typeof w.label.show&&w.label.show)&&k.isNumber(f.value)?"block":"none"},"font-size":function(){return(w.series[d]&&w.series[d].label&&w.series[d].label.fontSize||w.label.fontSize||"10")+"px"},"font-weight":function(){return w.series[d]&&w.series[d].label&&w.series[d].label.fontWeight||w.label.fontWeight},fill:function(){return w.series[d]&&w.series[d].label&&w.series[d].label.color||w.label.color},stroke:function(){return w.label.strokeWidth&&w.series[d]&&w.series[d].label&&w.series[d].label.color||w.label.color||"#fff"},"stroke-width":w.label.strokeWidth}):this.html(""))};this.labels.selectAll("text").remove();var h=this.labels.selectAll(".series-group").data(x);this.labelsEnter=h.enter().append("g").attr("class","series-group"),this.labelsExit=h.exit().remove();for(var f=this.series,p=0;p<o;p++){var b=a.calLineData(x,p),m=f.select(".serie"+(p+1))[0][0]?f.select(".serie"+(p+1)).datum(b):f.append("path").datum(b).attr({class:"serie serie"+(p+1),d:j.svg.line().x(function(a){return"time"===w.xaxis.type&&"string"==typeof a[e]?n(j.time.format(q.options.format).parse(a[e]))+(n.rangeBand?n.rangeBand()/2:0):n(a[e])+("category"===w.xaxis.type?n.rangeBand()/2:0)}).y(l(v.getMin()))});c.call(m,b,p),h.each(function(a,b){var c=j.select(this),e=c.select(".serie-label-"+(p+1))[0][0]?c.select(".serie-label-"+(p+1)):c.append("text").attr("class","serie-label serie-label-"+(p+1));d.call(e,x[b],p,b)})}this.series.selectAll(".serie.serie"+o+" ~ .serie").remove()},renderSeries:function(){this.svg.classed("line-chart-g",!0),this.labels=this.svg.append("g").attr("class","series-labels"),this.changeSeries()},updateSeries:function(){this.changeSeries()},updateBeforeRender:function(){d.prototype.beforeRender.call(this)},beforeRender:function(){var a=this.options,b=this;this.dealColor(a,"color"),a.series&&a.series.length&&a.series.forEach(function(c,d){c.color&&b.dealColor(a,"series["+d+"].color")}),this.clipPathId||this.createClipPath()},createClipPath:function(){this.clipPathId="ClipPath"+k.getUUID(),this.clipPath=this.svg.append("defs").append("clipPath").attr("id",this.clipPathId).append("path").attr("fill","none").attr("stroke","none")}}),a.exports=d,a.exports});