!function(e,n){"function"==typeof define&&define.amd?define([],n):"undefined"!=typeof module&&module.exports?module.exports=n():e.lscache=n()}(this,function(){var n,e,o="lscache-",c="-cacheexpiration",t=6e4,u=v(t),i="",r=!1;function a(){var e="__lscachetest__";if(void 0!==n)return n;try{if(!localStorage)return!1}catch(e){return!1}try{d(e,"__lscachetest__"),g(e),n=!0}catch(e){n=!(!f(e)||!localStorage.length)}return n}function f(e){return e&&("QUOTA_EXCEEDED_ERR"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||"QuotaExceededError"===e.name)}function l(){return void 0===e&&(e=null!=window.JSON),e}function s(){return Math.floor((new Date).getTime()/t)}function h(e){return localStorage.getItem(o+i+e)}function d(e,n){localStorage.removeItem(o+i+e),localStorage.setItem(o+i+e,n)}function g(e){localStorage.removeItem(o+i+e)}function p(e){for(var n=new RegExp("^"+o+i.replace(/[[\]{}()*+?.\\^$|]/g,"\\$&")+"(.*)"),t=localStorage.length-1;0<=t;--t){var r=localStorage.key(t);(r=(r=r&&r.match(n))&&r[1])&&r.indexOf(c)<0&&e(r,r+c)}}function m(e){var n=e+c;g(e),g(n)}function w(e){var n=e+c,t=h(n);if(t){var r=parseInt(t,10);if(s()>=r)return g(e),g(n),1}}function y(e,n){r&&"console"in window&&"function"==typeof window.console.warn&&(window.console.warn("lscache - "+e),n&&window.console.warn("lscache - The error was: "+n.message))}function v(e){return Math.floor(864e13/e)}return{set:function(n,t,e){if(!a())return!1;if(!l())return!1;try{t=JSON.stringify(t)}catch(e){return!1}try{d(n,t)}catch(e){if(!f(e))return y("Could not add item with key '"+n+"'",e),!1;var r,o=[];p(function(e,n){var t=(t=h(n))?parseInt(t,10):u;o.push({key:e,size:(h(e)||"").length,expiration:t})}),o.sort(function(e,n){return n.expiration-e.expiration});for(var i=(t||"").length;o.length&&0<i;)r=o.pop(),y("Cache is full, removing item with key '"+n+"'"),m(r.key),i-=r.size;try{d(n,t)}catch(e){return y("Could not add item with key '"+n+"', perhaps it's too big?",e),!1}}return e?d(n+c,(s()+e).toString(10)):g(n+c),!0},get:function(e){if(!a())return null;if(w(e))return null;var n=h(e);if(!n||!l())return n;try{return JSON.parse(n)}catch(e){return n}},remove:function(e){a()&&m(e)},supported:a,flush:function(){a()&&p(function(e){m(e)})},flushExpired:function(){a()&&p(function(e){w(e)})},setBucket:function(e){i=e},resetBucket:function(){i=""},getExpiryMilliseconds:function(){return t},setExpiryMilliseconds:function(e){u=v(t=e)},enableWarnings:function(e){r=e}}});