"use strict";let mondadoriMediaCarousel;(mondadoriMediaCarousel=function(){let e=mondadoriMediaCarousel;e.mmCarouselConfig={},e.observerSlides=[],console.log("[mondadoriMediaCarousel] init"),e.cbObserverSlides=((t,r)=>{for(const r of t)requestAnimationFrame(()=>{let t=r.target.parentElement,o=t.getAttribute("id");if(e.mmCarouselConfig[o]&&1==r.intersectionRatio&&!r.target.classList.contains("mmCarouselItemActive")){if(e.mmCarouselConfig[o].classi&&r.target.classList.add("mmCarouselItemActive"),e.mmCarouselConfig[o].eventi){let e=new CustomEvent("mmCarouselSlideAttivata",{detail:{carousel:t,carouselId:o,indexSlide:Array.from(t.children).indexOf(r.target)}});document.dispatchEvent(e)}if(e.mmCarouselConfig[o].classi){let e,r=t.querySelectorAll(":scope > .mmCarouselItem"),o=r.length;for(e=0;e<o;e++){let t=r[e].getBoundingClientRect();(t.left<0||t.right-10>document.body.clientWidth)&&r[e].classList.remove("mmCarouselItemActive")}}}let s=r.target.previousElementSibling;1==r.intersectionRatio&&null==s?document.querySelector(".mmCarouselPrev[data-target='#"+o+"']")&&document.querySelector(".mmCarouselPrev[data-target='#"+o+"']").classList.add("mmCarouselDisabled"):r.intersectionRatio<1&&null==s&&document.querySelector(".mmCarouselPrev[data-target='#"+o+"']")&&document.querySelector(".mmCarouselPrev[data-target='#"+o+"']").classList.remove("mmCarouselDisabled");let l=r.target.nextElementSibling;1==r.intersectionRatio&&null==l?document.querySelector(".mmCarouselNext[data-target='#"+o+"']")&&document.querySelector(".mmCarouselNext[data-target='#"+o+"']").classList.add("mmCarouselDisabled"):r.intersectionRatio<1&&null==l&&document.querySelector(".mmCarouselNext[data-target='#"+o+"']")&&document.querySelector(".mmCarouselNext[data-target='#"+o+"']").classList.remove("mmCarouselDisabled")})}),e.observeSlides=function(t,r){let o,s=t.length;for(o=0;o<s;o++)e.observerSlides[r].observe(t[o]),t[o].classList.add("observerProcessed")},e.setObserversSlides=function(t){let r=t.getAttribute("id");console.log("[mondadoriMediaCarousel] setObserver per id:",r);let o=t.getAttribute("data-config")||null;null!=o&&(e.mmCarouselConfig[r]=JSON.parse(o));let s,l={root:t,rootMargin:"10px 10px 10px 10px",threshold:1};e.observerSlides[r]=new IntersectionObserver(e.cbObserverSlides,l),s=null!=o?t.querySelectorAll(":scope > .mmCarouselItem"):t.querySelectorAll(":scope > .mmCarouselItem:first-child, :scope > .mmCarouselItem:last-child"),e.observeSlides(s,r)},e.outerWidth=function(e){var t=e.offsetWidth,r=getComputedStyle(e);return t+=parseInt(r.marginLeft)+parseInt(r.marginRight)},e.cbObserverCarousels=((t,r)=>{t.forEach(t=>{if(t.isIntersecting)t.target.classList.add("mmCarouselInViewport"),e.setObserversSlides(t.target);else{t.target.classList.remove("mmCarouselInViewport");let r=t.target.getAttribute("id");e.observerSlides[r]&&(e.observerSlides[r].disconnect(),console.log("[mondadoriMediaCarousel] disconnect observer per id:",r))}})}),e.observeCarousels=function(t){let r,o=t.length;for(r=0;r<o;r++)t[r].classList.add("observerElaborato"),e.observerCarousels.observe(t[r])},e.setObserversCarousels=function(){e.observerCarousels=new IntersectionObserver(e.cbObserverCarousels,{rootMargin:"150px 10px 150px 10px",threshold:.01});let t=document.querySelectorAll(".mmCarousel:not(.observerElaborato)");e.observeCarousels(t)},e.setControls=function(){let t,r=document.querySelectorAll(".mmCarouselControl:not(.mmCarouselProcessed)"),o=r.length;for(t=0;t<o;t++)r[t].addEventListener("click",function(t){let r;t.preventDefault(),r=t.currentTarget.classList.contains("mmCarouselPrev")?-1:1;let o=t.currentTarget.getAttribute("data-target"),s=document.querySelector(o),l=s.getAttribute("data-passo"),a=s.scrollLeft,i=e.outerWidth(s.querySelector(".mmCarouselItem")),n=Math.floor(a+i*l*r);n<0&&(n=0);let m=s.scrollWidth,u=s.offsetWidth,d=Math.round(a/i);if(a+u==m&&-1==r&&(n=Math.round(d-l)*i),"smooth"===getComputedStyle(s).scrollBehavior)requestAnimationFrame(function(){s.scrollTo({top:0,left:n})});else{console.log("[mondadoriMediaCarousel] fallback per no smooth");let e=parseInt(s.getAttribute("data-time"))||300,t=(new Date).getTime(),r=setInterval(function(){requestAnimationFrame(function(){let o=Math.min(1,((new Date).getTime()-t)/e),l=a+o*(n-a)+0;1===o&&clearInterval(r),s.scrollLeft=l})},25)}}),r[t].classList.add("mmCarouselProcessed");e.setObserversCarousels()},e.setControls()})();
//# sourceMappingURL=mmCarousel.min.js.map