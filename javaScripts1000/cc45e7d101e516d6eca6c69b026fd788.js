var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.array=$jscomp.array||{};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===c&&(c=b.length);c=Math.max(0,Math.min(c|0,b.length));for(var e=a.length;0<e&&0<c;)if(b[--c]!=a[--e])return!1;return 0>=e}},"es6-impl","es3");
var Input_0$classdecl$var0=function(){this.PM_AD_MGR_RELEASE_VERSION="1.2.0";this.PM_VPAID_VERSION="2.0";this.EQUAL_OP="\x3d";this.AMP_OP="\x26";this.QUES_OP="?";this.EMPTY_STRING="";this.K_AD_NETWORK_CONST=this.AMP_OP+"kadNetwork"+this.EQUAL_OP;this.DEF_CAMPG_IDS=this.AMP_OP+"defcmpgIDs"+this.EQUAL_OP;this.LAST_DEF_ADNWK_ID=this.AMP_OP+"lastdefadnwkID"+this.EQUAL_OP;this.OID=this.AMP_OP+"oid"+this.EQUAL_OP;this.PUB_ID="pubId";this.SITE_ID="siteId";this.AD_ID="adId";this.AD_TAG_TYPE="adtagtype";this.AD_TYPE=
"adtype";this.SA_VERSION="SAVersion";this.IN_I_FRAME="inIframe";this.JS="js";this.K_DNT_UID="kdntuid";this.K_L_TSTAMP="kltstamp";this.PAGE_URL="pageURL";this.K_AD_PAGE_URL="kadpageurl";this.RAN_REQ="ranreq";this.SCREEN_RESOLUTION="screenResolution";this.SEC="sec";this.TIMEZONE="timezone";this.COPPA="coppa";this.AT_PAYLOAD="at_payload";this.VIDEO_CLIENT="vc";this.TPCA="tpca";this.GDPR_FLAG="gdpr";this.CONSENT_STR="gdpr_consent";this.ADSERVER_DOMAIN="dmn";this.SCHAIN="schain";this.CCPA="us_privacy";
this.CCPA_STRING_LENGTH=4;this.LOCAL_STORAGE_DEBUG_LEVEL="pmVpaidDebugLevel";this.V_DOM_ID="vdomId";this.V_X_LOC="vxloc";this.V_Y_LOC="vyloc";this.V_TYPE="vtype";this.PLAYER_HEIGHT="vh";this.PLAYER_WIDTH="vw";this.V_MIN_BTR="vminbtr";this.V_MAX_BTR="vmaxbtr";this.V_FMT="vfmt";this.V_MIN_L="vminl";this.V_MAX_L="vmaxl";this.PLAYER_VISIBILITY="adVisibility";this.SECURE_PROTOCOL="https:";this.UNSECURE_PROTOCOL="http:";this.WIN_HEIGHT="vwndh";this.WIN_WIDTH="vwndw";this.AD_HEIGHT="vadh";this.AD_WIDTH=
"vadw";this.WIN_URL="vwndurl";this.REF_URL="vwndref";this.DEPTH="depth";this.PLAYER_LOCATION="adPosition";this.PLAYER_LOCATION_X="plocx";this.PLAYER_LOCATION_Y="plocy";this.V_SKIP="vskip";this.VPAID_STR="VPAID";this.VIEW_MODE_FULLSCREEN="fullscreen";this.V_CAMPAIGN_NETWORK_ID=243;this.RTMP_PROTOCOL="rtmp";this.COMPANION_ADS_START_TOKEN="\x3cCompanionAds\x3e";this.COMPANION_ADS_END_TOKEN="\x3c/CompanionAds\x3e";this.CSA_AD_NETWORK_LIST=[0,2111];this.SKIP_AD_MSG_1="You can skip this ad in ";this.SKIP_AD_MSG_2=
"Skip Ad \x3e\x3e";this.WHITE="0xFFFFFF";this.BLACK="0x000000";this.PM_VPAID_FILE_NAME="PMAdMgr.js";this.ERROR_EVENT_LEVEL=0;this.default_minDuration="00:00:10";this.MEDIA_FILE_TYPES={"video/ogg":'video/ogg; codecs\x3d"theora, vorbis"',"video/mp4":'video/mp4; codecs\x3d"avc1.4D401E, mp4a.40.2"',"video/webm":'video/webm; codecs\x3d"vp8.0, vorbis"'};this.IQ_EXT_TYPE="pm-iq";this.FP_EXT_TYPE="pm-fp";this.PM_EXT_START_TYPE="pm-";this.IFRAME="iframe";this.SCRIPT="script";this.IMAGE="image";this.MINSUGGESTEDDURATION=
"00:00:10";this.ADPARAMETERS_NODE="AdParameters";this.EMPTY_VAST_EVENT=95;this.CODE="0";this.IFRAME_URL="1";this.SCRIPT_URL="2";this.IMAGE_URL="3";this.PUBMATIC_IMPRESSION_ID="pubmatic";this.BEFORE_CREATIVE_PIXEL=0;this.AFTER_CREATIVE_PIXEL=1;this.PUBMATIC_PIXELS="pm-pixel";this.PUBMATIC_FORCE_PIXELS="pm-forcepixel";this.AUTOPLAY={PLAYBACK_WITH_SOUND_ON:1,PLAYBACK_WITH_SOUND_OFF:2,CLICK_TO_PLAY:3};this.WEBSOCKET_URL="wss://stagingva.pubmatic.com:8801";this.TEST_PLAYER_URL="testplayerurl";this.INIT_AD_VOLUME_LOGIC=
"initAdVolumeLogic";this.ENCODED_PARAMS_AS_IS=[this.PAGE_URL,this.K_AD_PAGE_URL,this.SCHAIN]},Constants=new Input_0$classdecl$var0,ErrorData=function(a,b,c,d){this.errorLevel=a;this.pmErrorCode=b;this.iabErrorCode=c;this.errorMessage=d},Input_0$classdecl$var1=function(){this.PM_ERR_VAST_XML_PARSING=new ErrorData(1,199,100,"VAST XML parsing error");this.PM_ERR_EMPTY_VAST_FROM_PUBMATIC=new ErrorData(1,198,101,"Invalid/Empty VAST Response from PubMatic Ad Server");this.PM_ERR_CREATIVE_IN_ADPARAM_NOT_FOUND=
new ErrorData(5,197,101,"Empty VAST content from PubMatic Ad Server in AdParameters");this.PM_ERR_CREATIVE_IN_QUERY_NOT_FOUND=new ErrorData(5,196,101,"Empty VAST content from PubMatic Ad Server in query string");this.PM_ERR_LINEAR_AD_NOT_FOUND=new ErrorData(4,299,201,"Linear Ad expected but not found");this.PM_ERR_NONLINEAR_AD_NOT_FOUND=new ErrorData(4,298,201,"NonLinear Ad expected but Not found.");this.PM_ERR_CREATIVE_ERROR=new ErrorData(4,297,201,"Creative (Linear/NonLinear) error.");this.PM_AD_DURATION_ERROR=
new ErrorData(4,296,201,"Creative Ad Duration not found.");this.PM_ERR_WRAPPER_PUBMATIC_CALL_TIMEOUT=new ErrorData(5,399,301,"PubMatic VAST URI/Passback URI call timedout");this.PM_ERR_WRAPPER_PARTNER_CALL_TIMEOUT=new ErrorData(5,398,301,"Partner VAST URI/Passback URI call timedout");this.PM_ERR_VAST_TAG_URI_NOT_FOUND=new ErrorData(5,397,301,"VastAdTagURI is not found");this.PM_ERR_WRAPPER_REDIRECT_RESPONSE=new ErrorData(5,396,301,"VAST URI/Passback URI Redirect Response");this.PM_ERR_DEMAND_ADSERVER_HTTP_REQ_FAILED=
new ErrorData(5,393,301,"Error while making http call to demand (VAST URI)");this.PM_ERR_NW_DP_HTTP_REQ_FAILED=new ErrorData(5,393,301,"Demand Partner HTTP request (VAST URI) failed.");this.PM_ERR_NW_PM_000=new ErrorData(5,394,301,"0 PubMatic HTTP Error / Security error / CORS Error");this.PM_ERR_NW_DP_000=new ErrorData(5,395,301,"0 Demand partner HTTP Error / Security error / CORS Error");this.PM_ERR_NW_PM_204=new ErrorData(5,389,301,"204 PubMatic HTTP No content in response body");this.PM_ERR_NW_DP_204=
new ErrorData(5,388,301,"204 Demand partner HTTP no content in response body");this.PM_ERR_NW_PM_400=new ErrorData(5,387,301,"400 PubMatic HTTP bad request");this.PM_ERR_NW_DP_400=new ErrorData(5,386,301,"400 Demand partner HTTP bad request");this.PM_ERR_NW_PM_403=new ErrorData(5,385,301,"403 PubMatic HTTP Forbidden request");this.PM_ERR_NW_DP_403=new ErrorData(5,384,301,"403 Demand partner HTTP Forbidden request");this.PM_ERR_NW_PM_404=new ErrorData(5,383,301,"404 PubMatic HTTP File not found");
this.PM_ERR_NW_DP_404=new ErrorData(5,382,301,"404 Demand partner HTTP File not found");this.PM_ERR_NW_PM_408=new ErrorData(5,381,301,"408 PubMatic HTTP request timeout");this.PM_ERR_NW_DP_408=new ErrorData(5,380,301,"408 Demand partner HTTP request timeout");this.PM_ERR_NW_PM_413=new ErrorData(5,379,301,"413 PubMatic HTTP Payload Too Large");this.PM_ERR_NW_DP_413=new ErrorData(5,378,301,"413 Demand partner HTTP Payload Too Large");this.PM_ERR_NW_PM_414=new ErrorData(5,377,301,"414 PubMatic HTTP URI Too Long");
this.PM_ERR_NW_DP_414=new ErrorData(5,376,301,"414 Demand partner HTTP  URI Too Long");this.PM_ERR_NW_PM_431=new ErrorData(5,375,301,"431 PubMatic HTTP Request Header Fields Too Large");this.PM_ERR_NW_DP_431=new ErrorData(5,374,301,"431 Demand partner HTTP Request Header Fields Too Large");this.PM_ERR_NW_PM_500=new ErrorData(5,373,301,"500 PubMatic HTTP Internal Server Error");this.PM_ERR_NW_DP_500=new ErrorData(5,372,301,"500 Demand partner HTTP Internal Server Error");this.PM_ERR_NW_PM_502=new ErrorData(5,
371,301,"502 PubMatic HTTP Bad Gateway");this.PM_ERR_NW_DP_502=new ErrorData(5,370,301,"502 Demand partner HTTP Bad Gateway");this.PM_ERR_NW_PM_503=new ErrorData(5,369,301,"503 PubMatic HTTP Service Unavailable");this.PM_ERR_NW_DP_503=new ErrorData(5,368,301,"503 Demand partner HTTP Service Unavailable");this.PM_ERR_NW_PM_504=new ErrorData(5,367,301,"504 PubMatic HTTP Gateway Timeout");this.PM_ERR_NW_DP_504=new ErrorData(5,366,301,"504 Demand partner HTTP Gateway Timeout");this.PM_ERR_NW_PM_505=new ErrorData(5,
365,301,"505 PubMatic HTTP Version Not Supported");this.PM_ERR_NW_DP_505=new ErrorData(5,364,301,"505 Demand partner HTTP Version Not Supported");this.PM_ERR_NW_PM_HTTP_REQ_FAILED=new ErrorData(5,362,901,"PubMatic AdServer HTTP request failed.");this.PM_ERR_WRAPPER_THRESHOLD_REACHED=new ErrorData(2,392,302,"Wrapper threshold is reached.");this.PM_ERR_EMPTY_OR_NO_ADS_VAST_ERROR_FROM_PUBMATIC=new ErrorData(1,391,303,"No ads VAST response after one or more Wrappers from PubMatic Ad Server.");this.PM_ERR_EMPTY_OR_NO_ADS_VAST_ERROR_FROM_PARTNER=
new ErrorData(1,390,303,"No ads VAST response after one or more Wrappers from Partner Ad Server.");this.PM_ERR_PUBMATIC_CALL_TIMEOUT=new ErrorData(5,999,901,"PubMatic AdServer Call timedout");this.PM_ERR_PUBAMTIC_NETWORK_PASSBACK=new ErrorData(5,996,901,"PubMatic Network passback error.");this.PM_ERR_AD_NOT_FOUND=new ErrorData(2,995,901,"No Ad Found.");this.PM_ERR_AD_PARAM_NOT_FOUND=new ErrorData(3,994,901,"AdTag Parameters Not Found.");this.PM_ERR_REQUIRED_AD_PARAM_NOT_FOUND=new ErrorData(3,993,
901,"Required parameter are missing in AdTag request");this.PM_ERR_VPAID_REQRD_PRPTY_MISSING=new ErrorData(5,992,901,"Required VPAID Protocol property is missing.");this.PM_ERR_VPAID_DISPLAY_OBJ_NOT_FOUND=new ErrorData(5,991,901,"DisplayObject is not found in 3rd party vpaid");this.PM_ERR_VPAID_INIT_FAILD=new ErrorData(5,990,901,"Exception in initializing VPAID");this.PM_ERR_VPAID_OBJ_NULL=new ErrorData(5,989,901,"Loader.content is null or getVPAID() returned null");this.PM_ERR_VPAID_AD_ERROR_DISPATCHED=
new ErrorData(3,988,901,"3rd Party VPAID dispatched AdError event");this.PM_ERR_VPAID_AD_DURATION_MISSING=new ErrorData(3,987,901,"adDuration/adRemainingTime property is missing  VPAID");this.PM_ERR_VPAID_INIT_TIMEDOUT=new ErrorData(5,986,901,"3rd Party VPAID INIT TimedOut");this.PM_ERR_VPAID_START_TIMEDOUT=new ErrorData(5,985,901,"3rd Party VPAID START TimedOut");this.PM_ERR_VPAID_STOP_TIMEDOUT=new ErrorData(5,984,901,"3rd Party VPAID STOP TimedOut");this.PM_ERR_VPAID_OTHER_TIMEDOUT=new ErrorData(5,
983,901,"3rd Party VPAID OTHER TimedOut");this.PM_ERR_VPAID_LOAD=new ErrorData(5,981,901,"Error while loading 3rd party VPAID.");this.PM_ERR_UNDEFINED=new ErrorData(5,982,900,"Undefined Error");this.PM_ERR_VPAID_LOAD_AD_TIMEDOUT=new ErrorData(5,980,900,"3rd Party VPAID LOAD TimedOut");this.PM_ERR_MEDIAFILE_SECURITY=new ErrorData(5,499,400,"Media file security error");this.PM_ERR_MEDIAFILE_CONNECTION_EXCEPTION=new ErrorData(4,498,400,"Error while connecting to mediafile.");this.PM_ERR_MEDIAFILE_STREAM_NOT_FOUND=
new ErrorData(5,497,400,"Stream Not Found.");this.PM_ERR_NETCONNECTION_FAILED=new ErrorData(5,496,400,"NetConnection.Connect Failed.");this.PM_ERR_MEDIAFILE_ELE_NOT_FOUND=new ErrorData(4,494,401,"MediaFile element is missing in Linear Ad.");this.PM_ERR_MEDIAFILE_TIMEOUT=new ErrorData(5,493,402,"Linear MediaFile Timeout.");this.PM_ERR_MEDIAFILE_NOT_FOUND=new ErrorData(3,492,403,"Couldnt find MediaFile that is supported by this video player.");this.PM_ERR_LINEAR_ALL_MEDIAFILE_FAILED_TO_PLAY=new ErrorData(3,
491,405,"All mediadfiles failed to play");this.PM_ERR_UNSUPPORTED_MEDIA_FILE_ERROR=new ErrorData(3,490,405,"Unsupported mediadfiles error.");this.PM_ERR_MEDIAFILE_GENERAL=new ErrorData(5,489,400,"Media file general error");this.PM_ERR_MEDIAFILE_DECODE=new ErrorData(5,488,400,"The video playback was aborted due to a corruption problem or because the video used features your browser did not support.");this.PM_ERR_MEDIAFILE_ABORT=new ErrorData(5,487,400,"User aborted the video playback.");this.PM_ERR_MEDIAFILE_NETWORK_ERR=
new ErrorData(5,486,400,"A network error caused the video download to fail part-way.");this.PM_ERR_NONLINEAR_AD_ELE_NOT_FOUND=new ErrorData(4,599,500,"NonLinear tag missing.");this.PM_ERR_NONLINEAR_CREATIVE_TIMEOUT=new ErrorData(5,598,502,"NonLinear creative Timeout.");this.PM_ERR_NONLINEAR_CREATIVE_NOT_FOUND=new ErrorData(3,597,503,"NonLinear creative is not found.");this.PM_ERR_NONLINEAR_GENERAL=new ErrorData(3,596,500,"NonLinear general error.")},ErrorMessage=new Input_0$classdecl$var1,Input_0$classdecl$var2=
function(){};Input_0$classdecl$var2.prototype.isBlank=function(a){var b=!0;!isNaN(parseFloat(a))&&isFinite(a)?b=!1:a&&0<Object.keys(a).length&&(b=!1);return b};Input_0$classdecl$var2.prototype.isNumeric=function(a){var b=!0;isNaN(a)&&(b=!1);return b};Input_0$classdecl$var2.prototype.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};Input_0$classdecl$var2.prototype.stripWhitespaces=function(a){if(!this.isBlank(a))return a=a.replace(/^\s+|\s+$/g,""),a.replace(/[ \t\n]+/g,"")};
Input_0$classdecl$var2.prototype.toInteger=function(a){return this.isBlank(a)?0:parseInt(a)};Input_0$classdecl$var2.prototype.timecodeToSeconds=function(a){a=a.split(":");return 3600*a[0]+60*a[1]+1*a[2]};Input_0$classdecl$var2.prototype.formatSeconds=function(a){var b=new Date(1970,0,1);b.setSeconds(a);return b.toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1")};Input_0$classdecl$var2.prototype.getFileExtension=function(a){var b=a.lastIndexOf("."),c="";0<b&&(c=a.substr(b+1));return c};
Input_0$classdecl$var2.prototype.stripNewLineChar=function(a){if(!this.isBlank(a))return a.replace(/[\n]+/g,"")};Input_0$classdecl$var2.prototype.percentToNumber=function(a){if(a.endsWith("%")&&1<a.length&&this.isNumeric(a.slice(0,a.length-1))&&0<parseInt(a.slice(0,a.length-1))&&100>parseInt(a.slice(0,a.length-1)))return parseInt(a.slice(0,a.length-1));Logger.error("input is not percent");return!1};
Input_0$classdecl$var2.prototype.stringFormat=function(a){return a.endsWith("%")&&1<a.length&&this.isNumeric(a.slice(0,a.length-1))&&0<parseInt(a.slice(0,a.length-1))&&100>parseInt(a.slice(0,a.length-1))?"percent":2<=a.split(":").length&&(a=a.split(":"),!isNaN(a[0])&&0<=a[0]&&99>a[0]&&!isNaN(a[1])&&0<=a[1]&&99>a[1]&&!isNaN(a[1])&&0<=a[1]&&99>a[1])?"time":!1};Input_0$classdecl$var2.prototype.getSecuredURL=function(a){a?(a=a.replace(/http?:/g,"https:"),a=a.replace(/http?%3A/g,"https%3A")):a="";return a};
var StringUtils=new Input_0$classdecl$var2,Input_0$classdecl$var3=function(){};Input_0$classdecl$var3.prototype.countObj=function(a,b){var c=0,d;try{for(d in b)b.hasOwnProperty(d)&&d==a&&c++}catch(e){Logger.error("Error in counting 'Ad' objects: "+e.message)}return c};
Input_0$classdecl$var3.prototype.detectDevice=function(a){var b=0;try{var c=navigator.userAgent.toLowerCase();switch(a){case "ios":c.match(/(iphone|ipod|ipad)/)&&(b=parseFloat(c.match(/os ([0-9]+(_[0-9]+)?)/)[1].replace("_",".")));break;case "android":-1<c.indexOf("android")&&(b=parseFloat(c.match(/android ([\.0-9]+)/)[1]));break;case "msie":-1<c.indexOf("msie")&&(b=parseFloat(c.match(/msie ([\.0-9]+)/)[1]))}}catch(d){Logger.debug("Device Detection Error: "+d.message)}return b};
Input_0$classdecl$var3.prototype.enableRemoteLoggin=function(){SocketConnection.init(AdParamConfigReader.pubId,AdParamConfigReader.adId)};
var GeneralUtils=new Input_0$classdecl$var3,AdElement=function(a){this._vpaid=a;this._linear={};this._skipoffset=0;this._nonLinearAds=null;this._companionAdXML="";this._bestMediaFileIndex=0;this._bestMediaFileArray=[];this._bestVPAIDMediaFileArray=[];this._bestNonLinearCreativeIndex=0;this._linear.videoClicks={};this._3pLinearTrackingEventMap={};this._3pNonLinearTrackingEventMap={};this._3pVideoClickEvents=[];this._3pImpressionEvents=[];this._pmLinearTrackingEventMap={};this._pmNonLinearTrackingEventMap=
{};this._pmVideoClickEvents=[];this._pmImpressionEvents=[];this._3pErrorEvents=[];this._pmErrorEvents=[];this._pmExtensions={};this._isUniversalPixelSupported=!1};AdElement.prototype.setSkipOffset=function(a){this._skipoffset=a};AdElement.prototype.getSkipOffset=function(){return this._skipoffset};AdElement.prototype.setLinear=function(a){this._linear=a};AdElement.prototype.getLinear=function(){return this._linear};AdElement.prototype.setNonLinearAds=function(a){this._nonLinearAds=a};
AdElement.prototype.getNonLinearAds=function(){return this._nonLinearAds};AdElement.prototype.getMediaAdFiles=function(){return null!=this._linear?this._linear.MediaFiles:null};AdElement.prototype.getDuration=function(){return null!=this._linear?this._linear.Duration:null};
AdElement.prototype.getAdParameters=function(){try{if(null!=this._linear)return this._linear.adParameters;var a=this.getNonLinearCreativeIndex(),b=this.getNonLinearAds().NonLinears||null;return b&&0<b.length&&b[a]&&b[a]._adParameters&&b[a]._adParameters.toString()||null}catch(c){Logger.error("Error: Retrieving adparameters from Linear / Non-Linear ads for Third party.")}};
AdElement.prototype.updateLinearTrackingEventsMap=function(a){var b;if(null!=a){if(Array.isArray(a.TrackingEvents)){var c=[];for(b=0;b<a.TrackingEvents.length;b++)if(""!=a.TrackingEvents[b])for(var d=0;d<a.TrackingEvents[b].Tracking.length;d++)a.TrackingEvents[b]&&a.TrackingEvents[b].Tracking[d]&&a.TrackingEvents[b].Tracking[d]._event&&c.push(a.TrackingEvents[b].Tracking[d]);a.TrackingEvents.Tracking=c}if(a.TrackingEvents&&a.TrackingEvents.Tracking)for(c=[],Array.isArray(a.TrackingEvents.Tracking)?
c=a.TrackingEvents.Tracking:c[0]=a.TrackingEvents.Tracking,b=0;b<c.length;b++){d=c[b];a=d._event;var d=d.__text?d.__text:d.__cdata,e;-1!=d.indexOf(AdParamConfigReader.pmTrackerDomain)?(e=this._pmLinearTrackingEventMap[a],e||(e=[],this._pmLinearTrackingEventMap[a]=e)):(e=this._3pLinearTrackingEventMap[a],e||(e=[],this._3pLinearTrackingEventMap[a]=e));e.push(d)}}};
AdElement.prototype.updateNonLinearTrackingEventsMap=function(a){var b;if(null!=a){if(Array.isArray(a.TrackingEvents)){var c=[];for(b=0;b<a.TrackingEvents.length;b++)if(""!=a.TrackingEvents[b])for(var d=0;d<a.TrackingEvents[b].Tracking.length;d++)a.TrackingEvents[b]&&a.TrackingEvents[b].Tracking[d]&&a.TrackingEvents[b].Tracking[d]._event&&c.push(a.TrackingEvents[b].Tracking[d]);a.TrackingEvents.Tracking=c}if(a.TrackingEvents&&a.TrackingEvents.Tracking)for(a="[object Array]"===Object.prototype.toString.call(a.TrackingEvents.Tracking)?
a.TrackingEvents.Tracking:[a.TrackingEvents.Tracking],b=0;b<a.length;b++){var d=a[b],c=d._event,d=d.__text?d.__text:d.__cdata,e;-1!=d.indexOf(AdParamConfigReader.pmTrackerDomain)?(e=this._pmNonLinearTrackingEventMap[c],e||(e=[],this._pmNonLinearTrackingEventMap[c]=e)):(e=this._3pNonLinearTrackingEventMap[c],e||(e=[],this._3pNonLinearTrackingEventMap[c]=e));e.push(d)}}};
AdElement.prototype.updateVideoClickArray=function(a){var b,c;if(null!=a.VideoClicks){var d=a.VideoClicks;if(null!=d){var e=d.ClickTracking;if(e)if(Array.isArray(e)){if(null!=e&&0<e.length)for(c=0;c<e.length;c++)b=(b=e[c]||"")&&b.toString()||"",StringUtils.isBlank(b)||(-1!=b.indexOf(AdParamConfigReader.pmTrackerDomain)?this._pmVideoClickEvents.push(b):this._3pVideoClickEvents.push(b))}else b=e&&e.toString()||"",StringUtils.isBlank(b)||(-1!=b.indexOf(AdParamConfigReader.pmTrackerDomain)?this._pmVideoClickEvents.push(b):
this._3pVideoClickEvents.push(b));d=d.CustomClicks;if(null!=d&&0<d.length)for(Array.isArray(d)||(d=[d]),c=0;c<d.length;c++)b=d[c],b=b.__text?b.__text:b.__cdata,-1!=b.indexOf(AdParamConfigReader.pmTrackerDomain)?this._pmVideoClickEvents.push(b):this._3pVideoClickEvents.push(b);null!=a.VideoClicks.ClickThrough&&(this._linear.videoClicks.clickThrough=a.VideoClicks.ClickThrough)}}};
AdElement.prototype.parsePMExtensionsObj=function(a){var b;if(a){this._pmExtensions.pmPixels={};try{var c=[],d=[];Array.isArray(a)||(a=[a]);for(b=0;b<a.length;b++){var e=a[b]||{},f={};StringUtils.isBlank(e.Meta)||((e.Meta.toString()||"").split(";").map(function(a){return a.split("\x3d")}).forEach(function(a){var b=$jscomp.makeIterator(a);a=b.next().value;b=b.next().value;return f[a]=b}),Logger.debug("Meta information for extension object : "+JSON.stringify(f)),StringUtils.isBlank(f.name)||f.name!=
Constants.PUBMATIC_PIXELS&&f.name!=Constants.PUBMATIC_FORCE_PIXELS||StringUtils.isBlank(e.Pixel)||(Array.isArray(e.Pixel)||(e.Pixel=[e.Pixel]),e.Pixel.forEach(function(a){var b={},e={};StringUtils.isBlank(a._purpose)||(b.purpose=a._purpose);StringUtils.isBlank(a._loc)||(b.location=a._loc,a=a.Code||{},StringUtils.isBlank(a._type)||StringUtils.isBlank(a.toString())||(e.type=a._type,e.url=a.toString(),b.code=e,b.location==Constants.BEFORE_CREATIVE_PIXEL?c.push(b):b.location==Constants.AFTER_CREATIVE_PIXEL&&
d.push(b)))})))}Logger.debug("pixels to be executed before-creative");for(b=c.length-1;0<=b;b--)Logger.debug(JSON.stringify(c));Logger.debug("pixels to be executed after creative");for(b=d.length-1;0<=b;b--)Logger.debug(JSON.stringify(d));this._pmExtensions.pmPixels.before=c;this._pmExtensions.pmPixels.after=d}catch(k){Logger.error("Error updating this._pmExtensions.pmPixels: "+k.message)}finally{if(0<this._pmExtensions.pmPixels.before.length||0<this._pmExtensions.pmPixels.after.length)this._isUniversalPixelSupported=
!0}}};
AdElement.prototype.updatePMExtensions=function(a){if(a)try{var b=[],c=[],d=[];Array.isArray(a)||(a=[a]);for(var e=0;e<a.length;e++){var f=a[e]||{};StringUtils.isBlank(f._type)||(f._type===Constants.IQ_EXT_TYPE?(b=(f.IQPixelParams&&f.IQPixelParams.toString()||"").split(","),StringUtils.isBlank(f.IQPixel)||(Array.isArray(f.IQPixel)||(f.IQPixel=[f.IQPixel]),f.IQPixel.forEach(function(a){!StringUtils.isBlank(a)&&c.push(a.toString())}))):-1!==f._type.indexOf(Constants.PM_EXT_START_TYPE)&&(d=[],StringUtils.isBlank(f.Pixel)||
(Array.isArray(f.Pixel)||(f.Pixel=[f.Pixel]),f.Pixel.forEach(function(a){d.push({url:a?a.toString():"",type:a._type})})),this._pmExtensions.hasOwnProperty(f._type)?this._pmExtensions[f._type]=this._pmExtensions[f._type].concat(d):this._pmExtensions[f._type]=d))}this._pmExtensions.pmIQPixelParams=b;this._pmExtensions.pmIQPixels=c}catch(k){Logger.error("Error updating PM IQ Params: "+k.message)}};
AdElement.prototype.updateImpressionEventURI=function(a){a.length||(a=[a]);if(null!=a&&0<a.length)for(var b=0;b<a.length;b++){var c=a[b];if(StringUtils.isBlank(c._id)||c._id!==Constants.PUBMATIC_IMPRESSION_ID)if("object"==typeof c){var d=c.__text?c.__text:c.__cdata;-1!=d.indexOf(AdParamConfigReader.pmTrackerDomain)?(this._pmExtensions&&this._pmExtensions.hasOwnProperty("pmIQPixelParams")&&this._pmExtensions.pmIQPixelParams.forEach(function(a){var b=new RegExp("([\x26]"+a+"\x3d)[^\x26]+");d=d.replace(b,
"\x26"+a+"\x3d1");b=new RegExp("([?]"+a+"\x3d)[^\x26]+");d=d.replace(b,"?"+a+"\x3d1")}),this._pmImpressionEvents.push(d)):this._3pImpressionEvents.push(d)}else this._3pImpressionEvents.push(c)}};
AdElement.prototype.updateErrorEventURI=function(a){var b;if(Array.isArray(a))for(var c=0;c<a.length;c++)b=a[c].toString(),StringUtils.isBlank(b)||(-1!=b.indexOf(AdParamConfigReader.pmTrackerDomain)?this._pmErrorEvents.push(b):this._3pErrorEvents.push(b));else b=a.toString(),StringUtils.isBlank(b)||(-1!=b.indexOf(AdParamConfigReader.pmTrackerDomain)?this._pmErrorEvents.push(b):this._3pErrorEvents.push(b))};AdElement.prototype.updateCompanionAds=function(a){this._companionAdXML=this._companionAdXML.concat(a)};
AdElement.prototype.getLinearClickThruURI=function(){var a=null;if(null!=this._linear){var b=this._linear.videoClicks;null!=b&&(b=b.clickThrough,null!=b&&(a={url:b,id:b.id,playerHandles:!1}))}return a};AdElement.prototype.getNonLinearClickThruURI=function(a){var b=null;null!=this._nonLinearAds&&(b={url:this._nonLinearAds.nonLinears[a].NonLinearClickThrough,id:0,playerHandles:!1});return b};
AdElement.prototype.getNonLinearClickTrackerURI=function(a){if(null!=this._nonLinearAds)var b=this._nonLinearAds.nonLinears[a].NonLinearClickTracking;return b};AdElement.prototype.getLinearTrackingEventURI=function(a){var b=[];null!=this._pmLinearTrackingEventMap[a]&&(b=b.concat(this._pmLinearTrackingEventMap[a]));null!=this._3pLinearTrackingEventMap[a]&&(b=b.concat(this._3pLinearTrackingEventMap[a]));return b};
AdElement.prototype.getNonLinearTrackingEventURI=function(a){var b=[];null!=this._pmNonLinearTrackingEventMap[a]&&(b=b.concat(this._pmNonLinearTrackingEventMap[a]));null!=this._3pNonLinearTrackingEventMap[a]&&(b=b.concat(this._3pNonLinearTrackingEventMap[a]));return b};AdElement.prototype.getImpressionEventURI=function(){var a=[];null!=this._pmImpressionEvents&&(a=a.concat(this._pmImpressionEvents));null!=this._3pImpressionEvents&&(a=a.concat(this._3pImpressionEvents));return a};
AdElement.prototype.getVideoClickEvents=function(){var a=[];null!=this._pmVideoClickEvents&&(a=a.concat(this._pmVideoClickEvents));null!=this._3pVideoClickEvents&&(a=a.concat(this._3pVideoClickEvents));return a};AdElement.prototype.getErrorEventURI=function(){var a=[];null!=this._pmErrorEvents&&(a=a.concat(this._pmErrorEvents));null!=this._3pErrorEvents&&(a=a.concat(this._3pErrorEvents));return a};
AdElement.prototype.getPMErrorEventURI=function(){var a=[];null!=this._pmErrorEvents&&(a=a.concat(this._pmErrorEvents));return a};AdElement.prototype.get3PErrorEventURI=function(){var a=[];null!=this._3pErrorEvents&&(a=a.concat(this._3pErrorEvents));return a};
AdElement.prototype.isLinearAdFound=function(){var a=!1;try{null!=this._linear&&null!=this._linear.MediaFiles&&0<GeneralUtils.countObj("MediaFile",this._linear.MediaFiles)&&(a=!0)}catch(b){Logger.error("Error Message : "+b.message),Logger.error("Error StackTrace : "+b.getStackTrace())}return a};
AdElement.prototype.isNonLinearAdFound=function(){var a=!1;try{null!=this._nonLinearAds&&null!=this._nonLinearAds.nonLinears&&0<this._nonLinearAds.nonLinears.length&&(a=!0)}catch(b){Logger.error("Error Message : "+b.message)}return a};AdElement.prototype.getCompanionsAdsXML=function(){return Constants.COMPANION_ADS_START_TOKEN+this._companionAdXML+Constants.COMPANION_ADS_END_TOKEN};
AdElement.prototype.scoreAndSetMediaFileIndex=function(){var a=-1,b=document.createElement("video"),c=Constants.MEDIA_FILE_TYPES,d=this.getMediaAdFiles()||{},e=[],f=[],k=[],l=!0;b||(l=!1);d.MediaFile&&Array.isArray(d.MediaFile)?e=d.MediaFile||[]:d.MediaFile&&(e=[d.MediaFile]);for(var h=0;h<e.length;h++){var d=l?b.canPlayType(c[e[h]._type]):-1<["video/mp4","video/ogg","video/webm"].indexOf(e[h]._type)?!0:!1,p=e[h]&&e[h].toString()||null;""===d||StringUtils.isBlank(p)?e[h]._apiFramework&&e[h]._apiFramework===
Constants.VPAID_STR&&(e[h]._type&&"application/javascript"===e[h]._type||"text/html"===e[h]._type||"application/x-javascript"===e[h]._type)&&f.push({mediaFile:e[h],index:h}):k.push({mediaFile:e[h],index:h,type:e[h]._type})}0<f.length?(a=f[0].index,f=[f[0]],AdParamConfigReader.isFallbackEnable||(k=[]),this._vpaid._isVPAIDAd=!0):0<k.length&&(a=k[0].index,AdParamConfigReader.isFallbackEnable||(k=[k[0]]));this._bestMediaFileIndex=a;this._bestVPAIDMediaFileArray=f;this._bestMediaFileArray=k};
AdElement.prototype.getVpaidUrl=function(){var a=this._bestVPAIDMediaFileArray.shift()||null,a=a&&a.mediaFile&&a.mediaFile.toString()||"";return StringUtils.isBlank(a)?"":StringUtils.stripWhitespaces(a)};AdElement.prototype.getNextMediaFile=function(){return this._bestMediaFileArray.shift()||null};AdElement.prototype.hasMediaFile=function(){return!!this._bestMediaFileArray.length};
AdElement.prototype.getMediaFileURI=function(){var a=this.getNextMediaFile(),a=a&&a.mediaFile&&a.mediaFile.toString()||"";return StringUtils.isBlank(a)?"":StringUtils.stripWhitespaces(a)};
AdElement.prototype.getNonLinearCreative=function(){var a="",b=this.getNonLinearCreativeIndex(),b=this.getNonLinearAds().nonLinears[b];b.StaticResource?a=b.StaticResource.__cdata?b.StaticResource.__cdata:b.StaticResource.__text:b.HTMLResource?a=b.HTMLResource.__cdata?b.HTMLResource.__cdata:b.HTMLResource.__text:b.IFrameResource?a=b.IFrameResource.__cdata?b.IFrameResource.__cdata:b.IFrameResource.__text:(this._vpaid.dispatchAdErrorEvent(ErrorMessage.PM_ERR_NONLINEAR_AD_NOT_FOUND,!1),Logger.error("AdError"+
ErrorMessage.PM_ERR_NONLINEAR_AD_NOT_FOUND.errorMessage));return a};AdElement.prototype.getNonLinearCreativeMinDuration=function(){var a=Constants.MINSUGGESTEDDURATION,b=this.getNonLinearCreativeIndex(),b=this.getNonLinearAds().nonLinears[b];b._minSuggestedDuration?0<StringUtils.timecodeToSeconds(b._minSuggestedDuration)&&(a=b._minSuggestedDuration?b._minSuggestedDuration:Constants.MINSUGGESTEDDURATION):Logger.error("AdError_minSuggestedDuration not found");return StringUtils.timecodeToSeconds(a.toString())};
AdElement.prototype.getNonLinearCreativeIndex=function(){return this._bestNonLinearCreativeIndex};
AdElement.prototype.scoreAndSetNonLinearCreativeIndex=function(){var a=0,b=0,c,d=this._vpaid.__initWidth,e=this._vpaid.__initHeight;c=this.getNonLinearAds();if(null==c||null==c.nonLinears||0==c.nonLinears.length)Logger.debug("\x3cNonLinearAds\x3e not found."),Logger.debug("AdError: "+ErrorMessage.NON_LINEAR_ADS_CREATIVE_ERROR.errorMessage),this._vpaid.dispatchAdErrorEvent(ErrorMessage.PM_ERR_NONLINEAR_AD_ELE_NOT_FOUND,!1);else{var f=c.nonLinears,k=Array(f.length);Logger.debug("NonLinear Ads Publisher Parameters (overlayAdDuration, playerHeight, playerWidth) :"+
AdParamConfigReader.vmaxl+","+AdParamConfigReader.getPlayerHeight()+","+AdParamConfigReader.getPlayerWidth());for(c=0;c<f.length;c++){var l=f[c];0!=AdParamConfigReader.getPlayerWidth()&&0!=AdParamConfigReader.getPlayerHeight()&&AdParamConfigReader.getPlayerHeight()==l.height&&AdParamConfigReader.getPlayerWidth()==l.width&&a++;l.height<=e&&l.width<=d&&a++;k[b]=a;b++;a=0}for(c=b=a=0;c<f.length;c++)k[c]>a&&(a=k[c],b=c);0!=AdParamConfigReader.getPlayerHeight()&&0!=AdParamConfigReader.getPlayerWidth()&&
f[b].height>AdParamConfigReader.getPlayerHeight()&&f[b].width>AdParamConfigReader.getPlayerWidth()&&Logger.warn("Error in displaying non-linear ads. nonlinear width and height are larger than AdUnit width and height.");f[b].height>e&&f[b].width>d&&Logger.warn("Error in displaying non-linear ads. nonlinear width and height are larger than player width and height.");this._bestNonLinearCreativeIndex=b;d=this.getNonLinearCreative();StringUtils.isBlank(d)&&Logger.warn("AdError error while scoring ...")}};
AdElement.prototype.isValidDuration=function(a){if(null!=a){var b=a.toString();if(!StringUtils.isBlank(b)&&-1==b.indexOf("00:00:00")&&(a=StringUtils.timecodeToSeconds(a.toString()),AdParamConfigReader.vminl<=a&&a<=AdParamConfigReader.vmaxl))return!0}return!1};AdElement.prototype.clearAllMediaFiles=function(){null!=this._linear&&(this._linear.MediaFiles=null);null!=this._nonLinearAds&&(this._nonLinearAds.nonLinears=null)};
AdElement.prototype.reset=function(){this._linear.skipoffset=null;this.clearAllMediaFiles();this.clearThirdPartyTrackingEvents();this.clearPubMaticExtensions()};
AdElement.prototype.clearThirdPartyTrackingEvents=function(){this._3pLinearTrackingEventMap={};this._3pNonLinearTrackingEventMap={};this._3pImpressionEvents.splice(0,this._3pImpressionEvents.length);this._3pVideoClickEvents.splice(0,this._3pVideoClickEvents.length);this._3pErrorEvents.splice(0,this._3pErrorEvents.length);this._pmErrorEvents.splice(0,this._pmErrorEvents.length)};AdElement.prototype.clearPubMaticExtensions=function(){this._pmExtensions={}};
var Input_0$classdecl$var4=function(a,b){this.AD_CLICK_THRU="AdClickThru";this.AD_DURATION_CHANGE="AdDurationChange";this.AD_ERROR="AdError";this.AD_EXPANDED_CHANGE="AdExpandedChange";this.AD_IMPRESSION="AdImpression";this.AD_INTERACTION="AdInteraction";this.AD_LINEAR_CHANGE="AdLinearChange";this.AD_LOADED="AdLoaded";this.AD_LOG="AdLog";this.AD_PAUSED="AdPaused";this.AD_PLAYING="AdPlaying";this.AD_REMAINING_TIME_CHANGE="AdRemainingTimeChange";this.AD_SIZE_CHANGE="AdSizeChange";this.AD_SKIPPABLE_STATE_CHANGED=
"AdSkippableStateChange";this.AD_SKIPPED="AdSkipped";this.AD_STARTED="AdStarted";this.AD_STOPPED="AdStopped";this.AD_USER_ACCEPT_INVITATION="AdUserAcceptInvitation";this.AD_USER_CLOSE="AdUserClose";this.AD_USER_MINIMIZE="AdUserMinimize";this.AD_VIDEO_COMPLETE="AdVideoComplete";this.AD_VIDEO_FIRST_QUARTILE="AdVideoFirstQuartile";this.AD_VIDEO_MIDPOINT="AdVideoMidpoint";this.AD_VIDEO_START="AdVideoStart";this.AD_VIDEO_THIRD_QUARTILE="AdVideoThirdQuartile";this.AD_VOLUME_CHANGE="AdVolumeChange";this._data=
b};$jscomp.global.Object.defineProperties(Input_0$classdecl$var4.prototype,{data:{configurable:!0,enumerable:!0,get:function(){return this._data}}});
var AdEvent=new Input_0$classdecl$var4,Input_0$classdecl$var5=function(){this.VPAID_LOAD="VPAID_LOAD";this.HANDSHAKE="HANDSHAKE";this.INIT_AD="INIT_AD";this.START_AD="START_AD";this.PAUSE_AD="PAUSE_AD";this.RESUME_AD="RESUME_AD";this.STOP_AD="STOP_AD";this.LOAD_VPAID_AD="LOAD_VPAID_AD"},ProtocolPhase=new Input_0$classdecl$var5,Input_0$classdecl$var6=function(){this.VALID_RESP="VALID_RESP";this.INVALID_RESP="INVALID_RESP";this.PARSE_ERROR_RESP="PARSE_ERROR_RESP"},ResponseType=new Input_0$classdecl$var6,
TrackingEventTypes={CREATIVE_VIEW:"creativeView",START:"start",MIDPOINT:"midpoint",FIRST_QUARTILE:"firstQuartile",THIRD_QUARTILE:"thirdQuartile",COMPLETE:"complete",MUTE:"mute",UNMUTE:"unmute",PAUSE:"pause",REWIND:"rewind",RESUME:"resume",FULLSCREEN:"fullscreen",EXPAND:"expand",COLLAPSE:"collapse",ACCEPT_INVITATION:"acceptInvitation",CLOSE:"close",INVALID_EVENT_TYPE:"InvalidEventType",SKIP:"skip",isValidTrackingEventType:function(a){switch(a){case this.CREATIVE_VIEW:case this.START:case this.MIDPOINT:case this.FIRST_QUARTILE:case this.THIRD_QUARTILE:case this.COMPLETE:case this.MUTE:case this.UNMUTE:case this.PAUSE:case this.REWIND:case this.RESUME:case this.FULLSCREEN:case this.EXPAND:case this.COLLAPSE:case this.ACCEPT_INVITATION:case this.CLOSE:case this.SKIP:return!0;
default:return!1}}},AdTagHandler=function(a,b,c){this._creativeHandlers=c||[];this._adTag=a;this._vpaid=b;this.errorData=this.timeoutStart=null};AdTagHandler.prototype.setAdTag=function(a){this._adTag=a};AdTagHandler.prototype.getAdTag=function(){return this._adTag};
AdTagHandler.prototype.execute=function(){try{var a;window.XMLHttpRequest?a=new XMLHttpRequest:window.ActiveXObject&&(a=new window.ActiveXObject("Microsoft.XMLHTTP"));a.withCredentials=!0;a.onreadystatechange=function(b){return function(){if(4===a.readyState){try{var c=performance.now()-b._vpaid._adRequestTime;Logger.info("PM AdRequest Time: "+Math.round(c)/1E3+"secs.")}catch(d){Logger.log("Inside catch block of onreadystatechange: "+d)}if(b.timeoutStart&&b.timeoutStart.running)if(b.timeoutStart.stop(),
200===a.status)b.onRequestComplete(a.responseText);else b.errorData=b.checkHTTPStatusErrorCode(a.status),b.onNetworkError(b.errorData)}}}(this);a.open("GET",this.getAdTag(),!0);this.timeoutStart=new Timer(AdParamConfigReader.HTTP_REQUEST_TIMEOUT,0,this.timeoutComplete,this);this.timeoutStart.start();a.send(null)}catch(b){this._vpaid.dispatchAdErrorEvent(ErrorMessage.PM_ERR_NW_PM_HTTP_REQ_FAILED,!1,b.message)}};
AdTagHandler.prototype.onNetworkError=function(a){a?this._vpaid.dispatchAdErrorEvent(a,!1):this._vpaid.dispatchAdErrorEvent(ErrorMessage.PM_ERR_NW_PM_HTTP_REQ_FAILED,!1)};
AdTagHandler.prototype.checkHTTPStatusErrorCode=function(a){switch(a){case 0:Logger.info("PM Network Error (0): HTTP General error or security error.");a=ErrorMessage.PM_ERR_NW_PM_000;break;case 204:Logger.info("PM Network Error (204): No Content in response.");a=ErrorMessage.PM_ERR_NW_PM_204;break;case 400:Logger.info("PM Network Error (400): Bad request.");a=ErrorMessage.PM_ERR_NW_PM_400;break;case 403:Logger.info("PM Network Error (403): Forbidden request.");a=ErrorMessage.PM_ERR_NW_PM_403;break;
case 404:Logger.info("PM Network Error (404): Not Found.");a=ErrorMessage.PM_ERR_NW_PM_404;break;case 408:Logger.info("PM Network Error (408): Request timeout.");a=ErrorMessage.PM_ERR_NW_PM_408;break;case 414:Logger.info("PM Network Error (414): Request url too long.");a=ErrorMessage.PM_ERR_NW_PM_414;break;case 500:Logger.info("PM Network Error (500): Internal server error.");a=ErrorMessage.PM_ERR_NW_PM_500;break;case 502:Logger.info("PM Network Error (502): Bad gateway.");a=ErrorMessage.PM_ERR_NW_PM_502;
break;case 503:Logger.info("PM Network Error (503): Service unavailable.");a=ErrorMessage.PM_ERR_NW_PM_503;break;case 504:Logger.info("PM Network Error (504): Gateway timeout.");a=ErrorMessage.PM_ERR_NW_PM_504;break;case 505:Logger.info("PM Network Error: HTTP Version not supported.");a=ErrorMessage.PM_ERR_NW_PM_505;break;default:Logger.info("PM HTTP Request status code: "+a),a=null}return a};
AdTagHandler.prototype.timeoutComplete=function(a){a.timeoutStart?a.timeoutStart.running=!1:a.timeoutStart=null;a._vpaid.dispatchAdErrorEvent(ErrorMessage.PM_ERR_PUBMATIC_CALL_TIMEOUT,!1)};AdTagHandler.prototype.createCORSRequest=function(a,b){var c=new XMLHttpRequest;"withCredentials"in c?c.open(a,b,!0):"undefined"!=typeof window.XDomainRequest?(c=new window.XDomainRequest,c.open(a,b)):c=null;return c};
AdTagHandler.prototype.executewithcors=function(){var a=this.getAdTag(),b=window.createCORSRequest("GET",a);b?(b.onload=function(){this.onRequestComplete(b.responseText)},b.onerror=function(){Logger.warn("Woops, there was an error making the request.")},b.send()):Logger.error("CORS not supported")};
AdTagHandler.prototype.onRequestComplete=function(a){try{a&&AdParamConfigReader.setResponseParams(a);var b=new AdResponseValidator(a,this._vpaid),c=b.validate();if(c===ResponseType.INVALID_RESP){Logger.warn("Invalid/Empty VAST response from Pubmatic.");if(AdParamConfigReader.isAPIResponse)this._vpaid.dispatchAdErrorEvent(ErrorMessage.PM_ERR_EMPTY_VAST_FROM_PUBMATIC,!1,a);else{var d=AdParamConfigReader.getErrorURL(0,0,Constants.EMPTY_VAST_EVENT)||[];StringUtils.isBlank(d)||(d=Array.isArray(d)?d:[d],
EventHandler.execute(d));this._vpaid.dispatchAdErrorEvent(ErrorMessage.PM_ERR_EMPTY_VAST_FROM_PUBMATIC,!1,a,!0)}return}if(c===ResponseType.PARSE_ERROR_RESP){this._vpaid.dispatchAdErrorEvent(ErrorMessage.PM_ERR_VAST_XML_PARSING,!1);return}}catch(f){this._vpaid.dispatchAdErrorEvent(ErrorMessage.PM_ERR_UNDEFINED,!1,f.message);return}a=b.getVAST();b=b.getCompanionAds();for(c=0;c<GeneralUtils.countObj("Ad",a);c++){var d=a.Ad,e=new CreativeHandler(this._creativeHandlers,this._vpaid);try{e.handleAd(d,b[c])}catch(f){e._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_UNDEFINED,
!1,f.message)}}};AdTagHandler.prototype.onRedirectResponse=function(a){Logger.debug("Callback called for AdTag request(Redirect): "+a)};AdTagHandler.prototype.getCreativeHandlers=function(){return this._creativeHandlers};AdTagHandler.prototype.setCreativeHandlers=function(a){this._creativeHandlers=a};
var CreativeHandler=function(a,b){this._creativeHandlers;this._pmVPAID=null;this._currentWinCampaignId=this._winCampaignId=this._currentWinAdNetworkId=0;this._winCampaignIds=[];this._lastWinAdNetworkId=0;this._oid="";this._isPMADServerResp;this._wrapperCounter=this._passbackCounter=0;this._creativeHandlers=a;this._pmVPAID=b;this._adElement=this._pmVPAID.getAdElement()||new AdElement(this._pmVPAID);this._isPMADServerResp=!0;this._testPlayerData=this.errorData=this.timeoutStart=null};
CreativeHandler.prototype.handleAd=function(a,b){var c=!0,d,e,f,k=null;d="InLine";a.Wrapper?(d="Wrapper",a=a.Wrapper):a.InLine?(d="InLine",a=a.InLine):a.Skipable&&(a=a.Skipable,d="Skipable");"Wrapper"==d&&(k=a,c=!1);e=a.Error?a.Error.__cdata?a.Error.__cdata:a.Error:"";d=a.Impression?"object"==typeof a.Impression?a.Impression:[a.Impression]:"";f=a.Creatives?a.Creatives:"";if(this._isPMADServerResp){this.setWiningIds(d);var l=!1;if(e&&0<e.length)for(var h=0;h<e.length;h++){var p=Array.isArray(e)?e[h].toString():
e.toString();if(-1!==p.indexOf(AdParamConfigReader.pmTrackerDomain)){Array.isArray(e)?e[h]=p:e=p;l=!0;break}}l||(l=AdParamConfigReader.getErrorURL(this._currentWinAdNetworkId,this._currentWinCampaignId),this._adElement.updateErrorEventURI(l))}this._adElement.updateErrorEventURI(e);this.updateCreative(f,b,c);if(a=this._isPMADServerResp&&a.Extensions&&a.Extensions.Extension||null)this._adElement.parsePMExtensionsObj(a),0<this._adElement._pmExtensions.pmPixels.before.length&&JSInterfaceHandler.executeExtensions(this._adElement._pmExtensions.pmPixels.before,
this._pmVPAID);a&&!this._adElement._isUniversalPixelSupported&&this._adElement.updatePMExtensions(a);this._adElement._pmExtensions.hasOwnProperty(Constants.FP_EXT_TYPE)&&(JSInterfaceHandler.executeExtensionPixels(this._adElement._pmExtensions[Constants.FP_EXT_TYPE]),delete this._adElement._pmExtensions[Constants.FP_EXT_TYPE]);this._adElement.updateImpressionEventURI(d);if(c)try{this.validateAdType()?(this._creativeHandlers.push(this),this._pmVPAID.initPMPlayer()):Logger.debug("This should ideally not be printed, the reason it is getting printed is because validateAdType() returned false")}catch(q){this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_UNDEFINED,
!1,q.message)}else this.handleWrapper(k)};CreativeHandler.prototype.handleWrapper=function(a){this._wrapperCounter++;a=a.VASTAdTagURI.__cdata?a.VASTAdTagURI.__cdata:a.VASTAdTagURI;StringUtils.isBlank(a)?(Logger.warn("No VastAdTagURI provided in wrapper..."),this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_VAST_TAG_URI_NOT_FOUND,!1)):this.handleCreative(a)};
CreativeHandler.prototype.isRedirectedResp=function(a){var b=!1,c=0;if(null!=a)for(var d=0;d<a.length;d++){var e=a[d];if("object"==typeof e&&(e=e.__text?e.__text:e.__cdata,-1!=e.indexOf(AdParamConfigReader.pmTrackerDomain))){a=new URLParser(e);this._currentWinAdNetworkId=a.getWinAdNetworkId();this._winCampaignId=a.getWinCampaignId();this._currentWinAdNetworkId!=Constants.V_CAMPAIGN_NETWORK_ID&&(this._lastWinAdNetworkId=this._currentWinAdNetworkId);this._currentWinCampaignId=a.getWinCampaignId();0!=
this._currentWinCampaignId&&this._winCampaignIds.push(this._currentWinCampaignId);c=a.getDefaultedAdServerId();break}}0!=c&&this._winAdNetworkId==c&&(b=!0);return b};
CreativeHandler.prototype.handleCreative=function(a){!AdParamConfigReader.isAPIResponse&&this._wrapperCounter>AdParamConfigReader.wrapperThreshold?(Logger.warn("Wrapper threshold is reached."),this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_WRAPPER_THRESHOLD_REACHED,!1)):(this._isPMADServerResp=!1,StringUtils.isBlank(a)?this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_VAST_TAG_URI_NOT_FOUND,!1):this.execute(a))};
CreativeHandler.prototype.handlePassback=function(a){Logger.error("Inside handlePassback function of CreativeHandler.js with parameter: "+a)};
CreativeHandler.prototype.execute=function(a,b){b=void 0===b?!0:b;try{!AdParamConfigReader.isHTTPS||StringUtils.isBlank(a)||-1==a.indexOf("http:")&&-1==a.indexOf("http%3A")||(a=StringUtils.getSecuredURL(a));var c;window.XMLHttpRequest?c=new XMLHttpRequest:window.ActiveXObject&&(c=new window.ActiveXObject("Microsoft.XMLHTTP"));0!==AdParamConfigReader.pubConsent&&(c.withCredentials=b);c.onreadystatechange=function(a,b,f){a._testPlayerData=new TestPlayerData(1,b);return function(){if(4===c.readyState&&
a.timeoutStart&&a.timeoutStart.running)if(a.timeoutStart.stop(),200===c.status)if(a._testPlayerData.setSuccessHttpStatusAndResponse(!0,c.status,c.responseText),Logger.sendAdditionalDataToTestPlayer(a._testPlayerData),-1!==c.responseURL.indexOf(AdParamConfigReader.videoAdServerDomain)&&c.responseURL!=b)AdParamConfigReader.isAPIResponse?a._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_WRAPPER_REDIRECT_RESPONSE,!1):(a._wrapperCounter=0,a._passbackCounter++,a._isPMADServerResp=!0,a.onRequestComplete(c.responseText));
else a.onRequestComplete(c.responseText);else a._testPlayerData.setSuccessHttpStatusAndResponse(!1,c.status,c.responseText),Logger.sendAdditionalDataToTestPlayer(a._testPlayerData),0==c.status&&f?a.execute(b,!1):(a.errorData=a.checkHTTPStatusErrorCode(c.status),a.onNetworkError(a.errorData))}}(this,a,b);c.open("GET",a,!0);this.timeoutStart=new Timer(AdParamConfigReader.HTTP_REQUEST_TIMEOUT,0,this.timeoutComplete,this);this.timeoutStart.start();c.send(null)}catch(d){this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_UNDEFINED,
!1,d.message)}};
CreativeHandler.prototype.timeoutComplete=function(a){a._testPlayerData.setSuccess(!1);Logger.sendAdditionalDataToTestPlayer(a._testPlayerData);a.timeoutStart?a.timeoutStart.running=!1:a.timeoutStart=null;AdParamConfigReader.isAPIResponse?a._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_WRAPPER_PARTNER_CALL_TIMEOUT,!1):AdParamConfigReader._isPMADServerResp?a._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_PUBMATIC_CALL_TIMEOUT,!1):a._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_WRAPPER_PARTNER_CALL_TIMEOUT,!1)};
CreativeHandler.prototype.onRequestComplete=function(a){try{this._isPMADServerResp&&a&&AdParamConfigReader.setResponseParams(a);var b=new AdResponseValidator(a,this._pmVPAID),c=b.validate();if(c===ResponseType.INVALID_RESP)this._isPMADServerResp?AdParamConfigReader.isAPIResponse?this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_EMPTY_OR_NO_ADS_VAST_ERROR_FROM_PUBMATIC,!1,a):this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_EMPTY_OR_NO_ADS_VAST_ERROR_FROM_PUBMATIC,!1,a,!0):this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_EMPTY_OR_NO_ADS_VAST_ERROR_FROM_PARTNER,
!1,a);else if(c===ResponseType.PARSE_ERROR_RESP)this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_VAST_XML_PARSING,!1);else{var d=b.getVAST().Ad;this.handleAd(d,b._companionAds[0])}}catch(e){this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_UNDEFINED,!1,e.message)}};CreativeHandler.prototype.onRedirectResponse=function(a){Logger.warn("In onRedirectResponse: redirect url: "+a);this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_WRAPPER_REDIRECT_RESPONSE,!1)};
CreativeHandler.prototype.onNetworkError=function(a){a||(a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_HTTP_REQ_FAILED:ErrorMessage.PM_ERR_NW_DP_HTTP_REQ_FAILED);this._pmVPAID.dispatchAdErrorEvent(a,!1)};
CreativeHandler.prototype.checkHTTPStatusErrorCode=function(a){switch(a){case 0:Logger.info("Network Error (0): HTTP General error or security error.");a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_000:ErrorMessage.PM_ERR_NW_DP_000;break;case 204:Logger.info("Network Error (204): No Content in response.");a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_204:ErrorMessage.PM_ERR_NW_DP_204;break;case 400:Logger.info("Network Error (400): Bad request.");a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_400:
ErrorMessage.PM_ERR_NW_DP_400;break;case 403:Logger.info("Network Error (403): Forbidden request.");a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_403:ErrorMessage.PM_ERR_NW_DP_403;break;case 404:Logger.info("Network Error (404): Not Found.");a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_404:ErrorMessage.PM_ERR_NW_DP_404;break;case 408:Logger.info("Network Error (408): Request timeout.");a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_408:ErrorMessage.PM_ERR_NW_DP_408;break;case 413:Logger.info("Network Error (413): Request Entity Too Large.");
a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_413:ErrorMessage.PM_ERR_NW_DP_413;break;case 414:Logger.info("Network Error (414): Request url too long.");a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_414:ErrorMessage.PM_ERR_NW_DP_414;break;case 500:Logger.info("Network Error (500): Internal server error.");a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_500:ErrorMessage.PM_ERR_NW_DP_500;break;case 502:Logger.info("Network Error (502): Bad gateway.");a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_502:
ErrorMessage.PM_ERR_NW_DP_502;break;case 503:Logger.info("Network Error (503): Service unavailable.");a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_503:ErrorMessage.PM_ERR_NW_DP_503;break;case 504:Logger.info("Network Error (504): Gateway timeout.");a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_504:ErrorMessage.PM_ERR_NW_DP_504;break;case 505:Logger.info("Network Error: HTTP Version not supported.");a=this._isPMADServerResp?ErrorMessage.PM_ERR_NW_PM_505:ErrorMessage.PM_ERR_NW_DP_505;break;
default:Logger.info("HTTP Request status code: "+a),a=null}return a};
CreativeHandler.prototype.updateCreative=function(a,b,c){if(!c||a&&a.Creative){a=a.Creative;Array.isArray(a)||(a=[a]);for(c=0;c<a.length;c++){var d=a[c];null!=d&&(this._linear=null,d.Linear?this.updateLinear(d.Linear):d.NonLinearAds&&this.updateNonLinearAds(d.NonLinearAds))}this._adElement.updateCompanionAds(b);this._pmVPAID.setAdElement(this._adElement)}else this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_CREATIVE_NOT_FOUND,!1)};
CreativeHandler.prototype.updateLinear=function(a){if(null!=a){var b=this._adElement.getLinear();null==b&&(this._adElement.setLinear(a),b=a);null!=a.Duration&&(b.Duration=a.Duration);null!=a._skipoffset&&(b._skipoffset=a._skipoffset);null!=a.MediaFiles&&0!=GeneralUtils.countObj("MediaFile",a.MediaFiles)&&(b.MediaFiles=a.MediaFiles);this._adElement.updateLinearTrackingEventsMap(a);this._adElement.updateVideoClickArray(a);b.adParameters=a.AdParameters&&a.AdParameters.toString()||null;this._pmVPAID.setAdElement(this._adElement)}};
CreativeHandler.prototype.updateNonLinearAds=function(a){if(null!=a){var b=this._adElement.getNonLinearAds();null==b&&(this._adElement.setNonLinearAds(a),b=a);this._adElement.updateNonLinearTrackingEventsMap(a);null!=a.NonLinear&&(b.nonLinears=a.NonLinear);this._pmVPAID.setAdElement(this._adElement)}};
CreativeHandler.prototype.validateAdType=function(){var a;a=this._adElement.isLinearAdFound();var b=this._adElement.isNonLinearAdFound();switch(AdParamConfigReader.vtype){case 1:if(a){this._pmVPAID.setIsLinearAd(!0);this._adElement.scoreAndSetMediaFileIndex();if(-1===this._adElement._bestMediaFileIndex){a=""+this._adElement._bestMediaFileIndex;try{a=document.createElement("video")+":::"+JSON.stringify(this._adElement.getMediaAdFiles())+":::"+this._adElement._bestMediaFileIndex}catch(c){Logger.info("Error creating error message fo reporting.")}this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_MEDIAFILE_NOT_FOUND,
!1,a);return}a=!0}else{Logger.warn("Linear Ad Not Found.");this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_LINEAR_AD_NOT_FOUND,!1);return}break;case 2:if(b)a=!0,this._pmVPAID.setIsLinearAd(!1),this._adElement.scoreAndSetNonLinearCreativeIndex();else{Logger.warn("NonLinear Ad Not Found.");this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_NONLINEAR_AD_NOT_FOUND,!1);return}break;default:if(this._pmVPAID.setIsLinearAd(a),a){this._pmVPAID.setIsLinearAd(!0);this._adElement.scoreAndSetMediaFileIndex();
if(-1===this._adElement._bestMediaFileIndex){a=""+this._adElement._bestMediaFileIndex;try{a=document.createElement("video")+":::"+JSON.stringify(this._adElement.getMediaAdFiles())+":::"+this._adElement._bestMediaFileIndex}catch(c){Logger.info("Error creating error message fo reporting.")}this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_MEDIAFILE_NOT_FOUND,!1,a);return}a=!0}else if(b)a=!0,this._pmVPAID.setIsLinearAd(!1),this._adElement.scoreAndSetNonLinearCreativeIndex();else{this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_CREATIVE_ERROR,
!1);return}}this._pmVPAID.setAdElement(this._adElement);return a};
CreativeHandler.prototype.setWiningIds=function(a){if(null!=a){a.length||(a=[a]);for(var b=0;b<a.length;b++){var c=a[b];if("object"==typeof c&&(c=c.__text?c.__text:c.__cdata,-1!=c.indexOf(AdParamConfigReader.pmTrackerDomain))){a=new URLParser(c);this._currentWinAdNetworkId=a.getWinAdNetworkId();this._winCampaignId=a.getWinCampaignId();this._currentWinAdNetworkId!=Constants.V_CAMPAIGN_NETWORK_ID&&(this._lastWinAdNetworkId=this._currentWinAdNetworkId);this._currentWinCampaignId=a.getWinCampaignId();
0!=this._currentWinCampaignId&&this._winCampaignIds.push(this._currentWinCampaignId);StringUtils.isBlank(this._oid)&&(this._oid=a.getOID());break}}}};CreativeHandler.prototype.getAdElement=function(){return this._adElement};var Input_0$classdecl$var7=function(a){this._errorData=a};
Input_0$classdecl$var7.prototype.executeErrorEvents=function(a,b){if(b.isRTBCampWin||a.errorLevel>=Constants.ERROR_EVENT_LEVEL){var c=b._adElement;null!=c&&(0<c.getPMErrorEventURI().length||0<c.get3PErrorEventURI().length)?(b=c.getPMErrorEventURI(),this.firePubMaticEvents(b,a),b=c.get3PErrorEventURI(),this.fire3rdPartyEvents(b,a)):(c=AdParamConfigReader.getErrorURL(AdParamConfigReader.adServerId?AdParamConfigReader.adServerId:0,AdParamConfigReader.campaignId?AdParamConfigReader.campaignId:0),b=[],
b.push(c),this.firePubMaticEvents(b,a))}};
Input_0$classdecl$var7.prototype.firePubMaticEvents=function(a,b){var c,d=b.pmErrorCode,e=[],f=/\[errorcode\]/gi,k=/%5BERRORCODE%5D/gi;if(a&&Array.isArray(a)&&0<a.length){for(var l=0;l<a.length;l++){var h=a[l];if(h&&Array.isArray(h)&&0<h.length)for(var p=0;p<h.length;p++){var q;h[p].replace(f,d);q=h[p].replace(k,d);b=q.indexOf("\x26da\x3d");0>b&&(b=q.indexOf("\x26dc\x3d"));0<b&&(c=q.indexOf("\x26",b+1),q=q.slice(0,b)+q.slice(c));e.push(q)}else h=h.replace(f,d),h=h.replace(k,d),b=h.indexOf("\x26da\x3d"),
0>b&&(b=h.indexOf("\x26dc\x3d")),0<b&&(c=h.indexOf("\x26",b+1),h=h.slice(0,b)+h.slice(c)),e.push(h)}EventHandler.execute(e)}};
Input_0$classdecl$var7.prototype.fire3rdPartyEvents=function(a,b){b=b.iabErrorCode;for(var c=[],d=/\[errorcode\]/gi,e=/%5BERRORCODE%5D/gi,f=0;f<a.length;f++){var k=a[f];if(Array.isArray(k))for(var l=0;l<k.length;l++){var h;k[l]&&k[l].toString().replace(d,b);(h=k[l]?k[l].toString().replace(e,b):null)&&c.push(h)}else(k=(k=k?k.toString().replace(d,b):null)?k.toString().replace(e,b):null)&&c.push(k)}EventHandler.execute(c)};var ErrorHandler=new Input_0$classdecl$var7,Input_0$classdecl$var8=function(){};
Input_0$classdecl$var8.prototype.execute=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(!StringUtils.isBlank(c)){c=c.toString();AdParamConfigReader.isHTTPS&&!StringUtils.isBlank(c)&&-1!=c.indexOf("http:")&&(c=StringUtils.getSecuredURL(c));-1!=c.indexOf(AdParamConfigReader.pmTrackerDomain)&&(c=c.concat(Constants.AMP_OP+Constants.VIDEO_CLIENT+Constants.EQUAL_OP+2));try{this.fireURL(c)}catch(d){Logger.error("Error while executing an event: "+d.message)}}}};
Input_0$classdecl$var8.prototype.fireURL=function(a){var b=document.createElement("img");b.id=Math.round(99998*Math.random()+1);b.style="height:1px;width:1px;display:none;";b.src=a;document.body.appendChild(b)};
var EventHandler=new Input_0$classdecl$var8,Input_0$classdecl$var9=function(){this.vw=this.vh=this.vskip=this.vmaxbtr=this.vminbtr=this.vyloc=this.vxloc=this.vtype=this.vmaxl=this.vminl=this.adtagtype=this.adId=this.siteId=this.pubId=0;this.vdomId="";this.debugLevel=0;this.enableErrorMessageReporting=!1;this.videoAdServerDomain;this.videoAdServerURI;this.showAdJSDomain;this.showAdJSURI;this.pmTrackerDomain;this.pmTrackerURI;this.isPixelFlag=!0;this.wrapperThreshold=this.passBackThreshold=3;this.DISPATCH_EVENTS_TIMEOUT=
50;this.HTTP_REQUEST_TIMEOUT=5E3;this.SHOWAD_LOAD_TIMEOUT=500;this.MEDIA_FALLBACK_TIMEOUT=this.VPAID_PROTOCOL_TIMEOUT=1E4;this.MEDIA_REQ_TIMEOUT=this.MEDIA_FALLBACK_TIMEOUT/2;this.DEFAULT_THRESHOLD=3;this.DEFAULT_VID_DOMAIN="vid.pubmatic.com";this.DEFAULT_ADS_PATH="/AdServer/AdServerServlet?";this.DEFAULT_SHOWADS_DOMAIN="ads.pubmatic.com";this.DEFAULT_SHOWADS_PATH="/AdServer/js/showad.js?";this.DEFAULT_TRACKER_DOMAIN="aktrack.pubmatic.com";this.embedded=-1;this.vcrtv="";this.adServerId=this.campaignId=
0;this.imprId=this.ucrid=this.crID="";this.vpaid=this.ecpm=this.advertiser_id=null;this.isHTTPS=this.isAPIResponse=!1;this.AdParameters="";this.isFallbackEnable=!0;this.adserver_domain=this.DEFAULT_VID_DOMAIN;this.testPlayerUrl=null;this.initAdVolumeLogic=0;this.consent_str="";this.gdpr_flag=0;this.pubConsent=-1;this.ccpa="";this._externalParamMap=this._adTagParamMap=null};
Input_0$classdecl$var9.prototype.initConfig=function(a,b,c,d){this.vpaid=d;this.setAdParameter(a);("pageURL"in this._adTagParamMap&&!isNaN(this._adTagParamMap.pageURL)||"pageURL"in this._adTagParamMap&&"undefined"==this._adTagParamMap.pageURL)&&delete this._adTagParamMap.pageURL;("vwndurl"in this._adTagParamMap&&!isNaN(this._adTagParamMap.vwndurl)||"vwndurl"in this._adTagParamMap&&"undefined"==this._adTagParamMap.vwndurl)&&delete this._adTagParamMap.vwndurl;("vwndref"in this._adTagParamMap&&!isNaN(this._adTagParamMap.vwndref)||
"vwndref"in this._adTagParamMap&&"undefined"==this._adTagParamMap.vwndref)&&delete this._adTagParamMap.vwndref;"ged"in this._adTagParamMap&&delete this._adTagParamMap.ged;"ged"in this._adTagParamMap&&delete this._adTagParamMap.ged;c&&(this.vh=Math.round(c),AdParamConfigReader.updateAdTagParamMap(Constants.PLAYER_HEIGHT,this.vh));b&&(this.vw=Math.round(b),AdParamConfigReader.updateAdTagParamMap(Constants.PLAYER_WIDTH,this.vw));switch(this.pubId){case 27349:csa=1}return!0};
Input_0$classdecl$var9.prototype.updateQueryParamMapByAdTag=function(){this._adTagParamMap=this.retrieveQueryParamsFromCallingURL(Constants.PM_VPAID_FILE_NAME);if(this._adTagParamMap[Constants.V_FMT]){var a=this._adTagParamMap[Constants.V_FMT],a=a.replace(/[268+]/g,"").split("").concat("6").join("+");this._adTagParamMap[Constants.V_FMT]=a}else this._adTagParamMap[Constants.V_FMT]="1+5+6+7";this._adTagParamMap[Constants.K_L_TSTAMP]=this.getCurrentTimestamp();this._adTagParamMap[Constants.RAN_REQ]=
this.getRandomNumber();this._adTagParamMap[Constants.TIMEZONE]=this.getTimezone()};Input_0$classdecl$var9.prototype.isAPIResponseFunc=function(){if(0==this.embedded||1==this.embedded)this.isAPIResponse=!0};Input_0$classdecl$var9.prototype.setAdParameter=function(a){(this.AdParameters=a.AdParameters||a.adParameters||"")&&""!=this.AdParameters&&(this.AdParameters=this.AdParameters.toString().trim())};
Input_0$classdecl$var9.prototype.setDefaultValuesForJSParameters=function(){this._externalParamMap={};this._externalParamMap[Constants.SA_VERSION]=2;this._externalParamMap[Constants.IN_I_FRAME]=1;this._externalParamMap[Constants.PAGE_URL]="";this._externalParamMap[Constants.SCREEN_RESOLUTION]="-1x-1";this._externalParamMap[Constants.K_DNT_UID]=1;this._externalParamMap[Constants.WIN_HEIGHT]=0;this._externalParamMap[Constants.WIN_WIDTH]=0;this._externalParamMap[Constants.WIN_URL]="";this._externalParamMap[Constants.REF_URL]=
"";this._externalParamMap[Constants.VIDEO_CLIENT]=2;this.updateExternalParamMap(Constants.JS,1);this.isHTTPS&&this.updateExternalParamMap(Constants.SEC,1)};
Input_0$classdecl$var9.prototype.initializeAdTagVariables=function(){this._adTagParamMap.pubId&&""!=this._adTagParamMap.pubId&&(this.pubId=parseInt(this._adTagParamMap.pubId));this._adTagParamMap.siteId&&""!=this._adTagParamMap.siteId&&(this.siteId=parseInt(this._adTagParamMap.siteId));this._adTagParamMap.adId&&""!=this._adTagParamMap.adId&&(this.adId=parseInt(this._adTagParamMap.adId));this._adTagParamMap.adtagtype&&""!=this._adTagParamMap.adtagtype&&(this.adtagtype=parseInt(this._adTagParamMap.adtagtype));
this._adTagParamMap.adtype&&""!=this._adTagParamMap.adtype&&(this.adtagtype=parseInt(this._adTagParamMap.adtype));this._adTagParamMap.vminl&&""!=this._adTagParamMap.vminl&&(this.vminl=parseInt(this._adTagParamMap.vminl));this._adTagParamMap.vmaxl&&""!=this._adTagParamMap.vmaxl&&(this.vmaxl=parseInt(this._adTagParamMap.vmaxl));this._adTagParamMap.vminbtr&&""!=this._adTagParamMap.vminbtr&&(this.vminbtr=parseInt(this._adTagParamMap.vminbtr));this._adTagParamMap.vmaxbtr&&""!=this._adTagParamMap.vmaxbtr&&
(this.vmaxbtr=parseInt(this._adTagParamMap.vmaxbtr));this._adTagParamMap.vxloc&&""!=this._adTagParamMap.vxloc&&(this.vxloc=parseInt(this._adTagParamMap.vxloc));this._adTagParamMap.vyloc&&""!=this._adTagParamMap.vyloc&&(this.vyloc=parseInt(this._adTagParamMap.vyloc));this._adTagParamMap.vtype&&""!=this._adTagParamMap.vtype&&(this.vtype=parseInt(this._adTagParamMap.vtype));this._adTagParamMap.vdomId&&""!=this._adTagParamMap.vdomId&&(this.vdomId=this._adTagParamMap.vdomId);this._adTagParamMap.vskip&&
""!=this._adTagParamMap.vskip&&(this.vskip=parseInt(this._adTagParamMap.vskip));StringUtils.isBlank(this._adTagParamMap.csa)||(this.csa=parseInt(this._adTagParamMap.csa));StringUtils.isBlank(this._adTagParamMap.emr)||(this.enableErrorMessageReporting=parseInt(this._adTagParamMap.emr));this._adTagParamMap.embedded&&""!=this._adTagParamMap.embedded&&(this.embedded=parseInt(this._adTagParamMap.embedded));this._adTagParamMap.vcrtv&&""!=this._adTagParamMap.vcrtv&&(this.vcrtv=this._adTagParamMap.vcrtv);
this._adTagParamMap.campaignId&&""!=this._adTagParamMap.campaignId&&(this.campaignId=parseInt(this._adTagParamMap.campaignId));this._adTagParamMap.adServerId&&""!=this._adTagParamMap.adServerId&&(this.adServerId=parseInt(this._adTagParamMap.adServerId));this._adTagParamMap.crID&&""!=this._adTagParamMap.crID&&(this.crID=this._adTagParamMap.crID);this._adTagParamMap.ucrid&&""!=this._adTagParamMap.ucrid&&(this.ucrid=this._adTagParamMap.ucrid);this._adTagParamMap.imprId&&""!=this._adTagParamMap.imprId&&
(this.imprId=this._adTagParamMap.imprId);this._adTagParamMap.fb&&""!=this._adTagParamMap.fb&&(this.isFallbackEnable=parseInt(this._adTagParamMap.fb),delete this._adTagParamMap.fb);this._adTagParamMap.hasOwnProperty(Constants.GDPR_FLAG)?(AdParamConfigReader.gdpr_flag=parseInt(this._adTagParamMap[Constants.GDPR_FLAG])||0,0===AdParamConfigReader.gdpr_flag&&(this._adTagParamMap[Constants.GDPR_FLAG]=0)):this._adTagParamMap[Constants.GDPR_FLAG]=0;if(this._adTagParamMap.hasOwnProperty(Constants.CONSENT_STR)){var a=
this._adTagParamMap[Constants.CONSENT_STR];StringUtils.isBlank(a)||-1===a.indexOf("INSERT_USER_GDPR_CONSENT_STRING_DATA_FROM_CMP_HERE")||(this._adTagParamMap[Constants.CONSENT_STR]="");AdParamConfigReader.consent_str=this._adTagParamMap[Constants.CONSENT_STR]||""}else this._adTagParamMap[Constants.CONSENT_STR]="";this._adTagParamMap.hasOwnProperty(Constants.CCPA)&&""!==this._adTagParamMap[Constants.CCPA]&&this._adTagParamMap[Constants.CCPA].length<=Constants.CCPA_STRING_LENGTH?AdParamConfigReader.ccpa=
this._adTagParamMap[Constants.CCPA]:this._adTagParamMap[Constants.CCPA]="";this._adTagParamMap.vh&&""!=this._adTagParamMap.vh&&(this.vh=parseInt(this._adTagParamMap.vh));this._adTagParamMap.vw&&""!=this._adTagParamMap.vw&&(this.vw=parseInt(this._adTagParamMap.vw));this._adTagParamMap.hasOwnProperty(Constants.ADSERVER_DOMAIN)&&""!=this._adTagParamMap[Constants.ADSERVER_DOMAIN]&&(this.adserver_domain=this._adTagParamMap[Constants.ADSERVER_DOMAIN]||this.DEFAULT_VID_DOMAIN,delete this._adTagParamMap[Constants.ADSERVER_DOMAIN]);
this._adTagParamMap.hasOwnProperty(Constants.SCHAIN)&&""!=this._adTagParamMap[Constants.SCHAIN]&&(this.schain=this._adTagParamMap[Constants.SCHAIN]||"");this._adTagParamMap.cb=Date.now();this._adTagParamMap.hasOwnProperty(Constants.TEST_PLAYER_URL)&&""!=this._adTagParamMap[Constants.TEST_PLAYER_URL]&&(this.testPlayerUrl=this._adTagParamMap[Constants.TEST_PLAYER_URL]);this._adTagParamMap.hasOwnProperty(Constants.INIT_AD_VOLUME_LOGIC)&&""!==this._adTagParamMap[Constants.INIT_AD_VOLUME_LOGIC]&&(this.initAdVolumeLogic=
parseInt(this._adTagParamMap[Constants.INIT_AD_VOLUME_LOGIC],10))};Input_0$classdecl$var9.prototype.updateExternalParamMap=function(a,b){StringUtils.isBlank(b)||(this._externalParamMap[a]=b,delete this._adTagParamMap[a])};Input_0$classdecl$var9.prototype.updateAdTagParamMap=function(a,b){this._adTagParamMap[a]=b};
Input_0$classdecl$var9.prototype.retrieveQueryParamsFromCallingURL=function(a){for(var b,c={},d="",e=document.getElementsByTagName("script"),f=0;f<e.length;f+=1)if(-1!==e[f].src.indexOf(a)){d=e[f].src;break}Logger.debug("PM VPAID FILE URL - "+d);e=d;0<d.indexOf("?")&&(d=d.slice(d.indexOf("?")+1));a=d.split("\x26");StringUtils.isBlank(d)&&this.dispatchAdErrorEvent(ErrorMessage.PM_ERR_AD_PARAM_NOT_FOUND);for(d=0;d<a.length;d+=1)if(0<a[d].length&&(b=a[d].split("\x3d"),b[0]!==e&&0<b[0].length))if(1===
b.length)c[b[0]]=null;else if(2===b.length)c[b[0]]=this.decodeParam(b[0],b[1]);else for(c[b[0]]="",f=1;f<b.length;f+=1)c[b[0]]+=this.decodeParam(b[0],b[f]),f<b.length-1&&(c[b[0]]+="\x3d");Logger.debug("QueryString Params Object created from "+Constants.PM_VPAID_FILE_NAME+".js calling url - "+c);return c};Input_0$classdecl$var9.prototype.decodeParam=function(a,b){return-1!==Constants.ENCODED_PARAMS_AS_IS.indexOf(a)?b:decodeURIComponent(b)};
Input_0$classdecl$var9.prototype.createQueryString=function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c+"\x3d"+a[c]);b=b.join("\x26");Logger.info("Inside createQueryString() : QueryString created from adtag variables - "+b);return b};
Input_0$classdecl$var9.prototype.validateRequiredParameters=function(){!AdParamConfigReader.isAPIResponse&&(StringUtils.isBlank(this.pubId)||0==this.pubId||StringUtils.isBlank(this.siteId)||0==this.siteId||StringUtils.isBlank(this.adId)||0==this.adId||StringUtils.isBlank(this.adtagtype)||0==this.adtagtype)&&(Logger.error("Mandatory Parameters missing in adserver request: PubId- "+this.pubId+", SiteId- "+this.siteId+", AdID- "+this.adId+", adTagType / AdType- "+this.adtagtype),this.vpaid.dispatchAdErrorEvent(ErrorMessage.PM_ERR_REQUIRED_AD_PARAM_NOT_FOUND))};
Input_0$classdecl$var9.prototype.initializeTimeouts=function(){this.HTTP_REQUEST_TIMEOUT=StringUtils.isBlank(this._adTagParamMap.ht)?this.HTTP_REQUEST_TIMEOUT:parseInt(this._adTagParamMap.ht);this.SHOWAD_LOAD_TIMEOUT=StringUtils.isBlank(this._adTagParamMap.slt)?this.SHOWAD_LOAD_TIMEOUT:parseInt(this._adTagParamMap.slt);this.VPAID_PROTOCOL_TIMEOUT=StringUtils.isBlank(this._adTagParamMap.vpt)?this.VPAID_PROTOCOL_TIMEOUT:parseInt(this._adTagParamMap.vpt)};
Input_0$classdecl$var9.prototype.getErrorURL=function(a,b,c){var d;try{d="https://"+AdParamConfigReader.DEFAULT_TRACKER_DOMAIN+"/track?operId\x3d7\x26p\x3d"+AdParamConfigReader.pubId+"\x26s\x3d"+AdParamConfigReader.siteId+"\x26a\x3d"+AdParamConfigReader.adId+"\x26ts\x3d"+Math.round((new Date).valueOf()/1E3)+"\x26wa\x3d"+a,a==Constants.V_CAMPAIGN_NETWORK_ID&&(d=d.concat("\x26wc\x3d"+b)),AdParamConfigReader.crID&&(d=d.concat("\x26crId\x3d"+AdParamConfigReader.crID)),AdParamConfigReader.ucrid&&(d=d.concat("\x26ucrid\x3d"+
AdParamConfigReader.ucrid)),AdParamConfigReader.imprId&&(d=d.concat("\x26impid\x3d"+AdParamConfigReader.imprId)),AdParamConfigReader.advertiser_id&&(d=d.concat("\x26advertiser_id\x3d"+AdParamConfigReader.advertiser_id)),AdParamConfigReader.ecpm&&(d=d.concat("\x26ecpm\x3d"+AdParamConfigReader.ecpm)),d=c?d.concat("\x26e\x3d"+c):d.concat("\x26er\x3d[ERRORCODE]"),-1!==AdParamConfigReader.pubConsent&&(d=d.concat("\x26pmc\x3d"+AdParamConfigReader.pubConsent))}catch(e){Logger.warn("Error inside getErrorURL()... Error Message: "+
e.message)}return d};Input_0$classdecl$var9.prototype.getRandomNumber=function(){return Math.random()};Input_0$classdecl$var9.prototype.getTimezone=function(){return(new Date).getTimezoneOffset()/60*-1};Input_0$classdecl$var9.prototype.getCurrentTimestamp=function(){var a=new Date,a=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds();return a=encodeURIComponent(a)};Input_0$classdecl$var9.prototype.getHTTPProtocol=function(){return Constants.SECURE_PROTOCOL};
Input_0$classdecl$var9.prototype.getPlayerHeight=function(){return isNaN(parseInt(this._adTagParamMap[Constants.PLAYER_HEIGHT]))?0:parseInt(this._adTagParamMap[Constants.PLAYER_HEIGHT])};Input_0$classdecl$var9.prototype.getPlayerWidth=function(){return isNaN(parseInt(this._adTagParamMap[Constants.PLAYER_WIDTH]))?0:parseInt(this._adTagParamMap[Constants.PLAYER_WIDTH])};
Input_0$classdecl$var9.prototype.getQueuryStringForAdServerCall=function(){var a,b=this.createQueryString(this._adTagParamMap);if("\x26\x3dundefined"==b.substring(b.length-11)||"?\x3dundefined"==b.substring(b.length-11))a=b.length-11,b=b.substring(0,a);var c=this.createQueryString(this._externalParamMap);if("\x26\x3dundefined"==c.substring(c.length-11)||"?\x3dundefined"==c.substring(c.length-11))a=c.length-11,c=c.substring(0,a);return b+"\x26"+c};
Input_0$classdecl$var9.prototype.getAdServerCallURI=function(){return this.videoAdServerURI+this.getQueuryStringForAdServerCall()};
Input_0$classdecl$var9.prototype.setResponseParams=function(a){try{var b=a.match(new RegExp('\x3cTracking event\x3d"start"\x3e(.*)'+AdParamConfigReader.DEFAULT_TRACKER_DOMAIN+"(.*)\x3c/Tracking\x3e")),c=b&&Array.isArray(b)&&0<b.length&&b[0],d=c&&c.match(/<!\[CDATA\[(.*)\]\]>/),e=d&&Array.isArray(d)&&1<d.length&&d[1];Logger.debug("Start Tracker URL : "+e);var f=new URLParser(e);this.adServerId||(this.adServerId=f.getWinAdNetworkId());StringUtils.isBlank(this.crID)&&(this.crID=f.getcrID());StringUtils.isBlank(this.ucrid)&&
(this.ucrid=f.getucrid());StringUtils.isBlank(this.imprId)&&(this.imprId=f.getimprId());StringUtils.isBlank(this.advertiser_id)&&(this.advertiser_id=f.getAdvertiserId());StringUtils.isBlank(this.ecpm)&&(this.ecpm=f.getEcpm());this.campaignId||(this.campaignId=f.getWinCampaignId());-1===this.pubConsent&&(this.pubConsent=f.getPubConsent())}catch(k){Logger.warn("Error in parsing response params: "+k.message)}};
Input_0$classdecl$var9.prototype.initPreConfiguration=function(a){Logger.info("into initPreConfiguration method");try{this.vpaid=a;-1!==this.getHTTPProtocol().indexOf("https:")&&(this.isHTTPS=!0);this.updateQueryParamMapByAdTag();this.initializeAdTagVariables();try{this._adTagParamMap&&this._adTagParamMap.hasOwnProperty("remoteLoggingEnabled")&&"true"===this._adTagParamMap.remoteLoggingEnabled&&GeneralUtils.enableRemoteLoggin()}catch(b){Logger.error(b)}-1!==[157278,156374,159984,109126,156821,158326,
157108,157109,2685].indexOf(this.pubId)&&(Logger.info("Volume will be decided using the new logic in initAd."),this.initAdVolumeLogic=1);this.setDefaultValuesForJSParameters();this.isAPIResponseFunc();this.validateRequiredParameters();this.debugLevel=(StringUtils.isBlank(this._adTagParamMap.debug)?2:parseInt(this._adTagParamMap.debug))||2;Logger.setDebugLevel(AdParamConfigReader.debugLevel);this.initializeTimeouts();this.wrapperThreshold=this.passBackThreshold=this.DEFAULT_THRESHOLD;this.videoAdServerDomain=
this.adserver_domain;this.videoAdServerURI=this.getHTTPProtocol()+"//"+this.videoAdServerDomain+this.DEFAULT_ADS_PATH;this.showAdJSDomain=this.DEFAULT_SHOWADS_DOMAIN;this.showAdJSURI=this.getHTTPProtocol()+"//"+this.showAdJSDomain+this.DEFAULT_SHOWADS_PATH;this.pmTrackerDomain=this.DEFAULT_TRACKER_DOMAIN;this.pmTrackerURI=this.getHTTPProtocol()+"//"+this.pmTrackerDomain;this.isPixelFlag=!0;Logger.debug("Configuration Parameters - Passback Threshold - "+this.passBackThreshold+"\n Wrapper Threshold - "+
this.wrapperThreshold+"\n VideoAdServer URI - "+this.videoAdServerURI+"\n ShowAdJS URI - "+this.showAdJSURI+"\n PM Tracker URI - "+this.pmTrackerURI+"\n Pixel Flag - "+this.isPixelFlag)}catch(b){return Logger.error("Error in initConfig():Error while reading config Params. Error Message -\x3e \n "+b.message),!1}};var AdParamConfigReader=new Input_0$classdecl$var9;function _AdParamConfigReader(){}
var AdResponseValidator=function(a,b){this._vpaid=b;this.vast=null;this._companionAds=[];this.COMPANION_ADS_START_TOKEN_PARTIAL="\x3cCompanionAds";this.AD_END_TOKEN="\x3c/Ad\x3e";this._respData=a};
AdResponseValidator.prototype.validate=function(){var a=ResponseType.INVALID_RESP;if(!StringUtils.isBlank(this._respData))try{this.vast=(new xmlToJson).xml_str2json(this._respData),this.vast=this.vast.VAST}catch(c){a=ResponseType.PARSE_ERROR_RESP,Logger.warn("Exception while parsing reponse. Error Message -\x3e "+c.message)}if(null!==this.vast)if(null!=this.vast.Ad&&0<GeneralUtils.countObj("Ad",this.vast))a=ResponseType.VALID_RESP,this.parseCompanionAds();else if(this.vast.Error){var b=this.vast.Error.toString();
this._vpaid&&this._vpaid._adElement&&b&&this._vpaid._adElement._3pErrorEvents.push(b)}return a};
AdResponseValidator.prototype.parseCompanionAds=function(){for(var a=this._respData.split(this.AD_END_TOKEN),b=0,c,d;b<a.length-1;b++)c=a[b].indexOf(this.COMPANION_ADS_START_TOKEN_PARTIAL),-1==c?this._companionAds[b]=Constants.EMPTY_STRING:(c=a[b].indexOf("\x3e",c+this.COMPANION_ADS_START_TOKEN_PARTIAL.length)+1,d=a[b].lastIndexOf(Constants.COMPANION_ADS_END_TOKEN),this._companionAds[b]=a[b].substring(c,d))};AdResponseValidator.prototype.getVAST=function(){return this.vast};
AdResponseValidator.prototype.getCompanionAds=function(){return this._companionAds};AdResponseValidator.prototype.CompanionAds=function(){return this._companionAds};
var PlayerControls={addClose:function(){var a=document.createElement("label");a.id="_pmClose";a.innerHTML="X";a.style.cssText="cursor: pointer;border: 1px solid;border-radius: 0.25em;color: rgb(255, 255, 255);display: inline;font-size: 75%;font-weight: bold;line-height: 1;text-align: center;vertical-align: baseline;white-space: nowrap;margin-left: -17px;right: 0px;bottom: 50px;position: absolute;background-color: black;opacity: .7;font: normal 12px arial,helvetica,sans-serif;";return a},addSkipBtn:function(a){var b=
document.getElementById("_pmSkip");b&&a.removeChild(b);b=document.createElement("label");b.id="_pmSkip";b.innerHTML="Skip Ad \x3e";b.style.cssText="cursor: pointer;border: 1px solid;border-radius: 0.25em;color: rgb(255, 255, 255);display: inline;font-size: 75%;font-weight: bold;line-height: 1;text-align: center;vertical-align: baseline;white-space: nowrap;margin-left: -17px;right: 0px;bottom: 50px;position: absolute;background-color: black;opacity: .7;font: normal 12px arial,helvetica,sans-serif;display:none";
b.style.right="0px";b.style.bottom="50px";b.style.position="absolute";a.appendChild(b);return this.skpBtn=b},removeSkipBtn:function(a){this.skpBtn&&(this.skpBtn.style.display="none",a.removeChild(this.skpBtn))},addPlayBtn:function(a,b){var c=document.getElementById("_pmPlay");c&&a.removeChild(c);var d=document.createElement("label");d.id="_pmPlay";d.innerHTML="";d.style.cssText="display: inline-block;background-size: 100% 100%;height: 4em;width: 4em;cursor: pointer;background: transparent url(https://vpaid.pubmatic.com/ads/video/assets/play.png);left: 50%;top: 50%;position: absolute;background-position: center;margin-top: -1.4em;background-size: cover;pointer-events: auto;z-index: 26;";
d.onclick=function(a){d.style.display="none";b(!0);a&&(a.preventDefault(),a.stopImmediatePropagation())};a.appendChild(d);this.playBtn=d},removePlayBtn:function(a){this.playBtn&&(this.playBtn.style.display="none",a.removeChild(this.playBtn))},addMuteBtn:function(a,b){var c=document.getElementById("_pmMute");c&&a.removeChild(c);var d=document.createElement("label");d.id="_pmMute";d.innerHTML="";d.style.cssText="display:inline-block;background:url(https://vpaid.pubmatic.com/ads/video/assets/unmute.png) no-repeat center;background-size:32px;border:0;width:32px;height:32px;text-indent:-999px;left: 1em;top: 1em;position: relative;background-size: cover;pointer-events: auto;z-index: 30;";
d.onclick=function(c){b(!1);a.removeChild(d);c&&(c.preventDefault(),c.stopImmediatePropagation())};a.appendChild(d)},removeMuteBtn:function(a){this.muteBtn&&(this.muteBtn.style.display="none",a.removeChild(this.muteBtn))}},Input_0$classdecl$var10=function(){this.logPrefix="pm-";this.DEBUG_VAST_TOOL_LOG_LEVEL=-1;this.INFO_LEVEL=1;this.ERROR_LEVEL=2;this.WARN_LEVEL=3;this.DEBUG_LEVEL=4;this.LOG_LEVEL=5;this.debugLevel=2;this._logDispatcher=null};
Input_0$classdecl$var10.prototype.initialize=function(a){null==this._logDispatcher&&(this._logDispatcher=a)};
Input_0$classdecl$var10.prototype.setDebugLevel=function(a){Logger.info("Inside Logger.setDebugLevel to set the logger level.");try{var b=localStorage.getItem(Constants.LOCAL_STORAGE_DEBUG_LEVEL);Logger.info("Value of localStorageDebugLevel received from local storage: "+JSON.stringify(b)+" and the value received in parameter for setting the debug level is: "+a);b&&0<b.length?(b=parseInt(b,10),this.debugLevel=b=isNaN(b)?a:Math.abs(b)):this.debugLevel=a}catch(c){Logger.info("Inside catch block, setting the value "+
a+" received in the argument due to error: ",JSON.stringify(c)),this.debugLevel=a}Logger.info("Finally, debug level set to "+this.debugLevel)};Input_0$classdecl$var10.prototype.log=function(a){5<=this.debugLevel&&this.consoleLog("log","log",a)};Input_0$classdecl$var10.prototype.debug=function(a){4<=this.debugLevel&&this.consoleLog("debug","debug",a)};Input_0$classdecl$var10.prototype.warn=function(a){3<=this.debugLevel&&this.consoleLog("warn","warn",a)};
Input_0$classdecl$var10.prototype.error=function(a){2<=this.debugLevel&&this.consoleLog("error","error",a)};Input_0$classdecl$var10.prototype.info=function(a){1<=this.debugLevel&&this.consoleLog("info","info",a)};Input_0$classdecl$var10.prototype.consoleLog=function(a,b,c){try{SocketConnection&&SocketConnection.isOpen()&&SocketConnection.sendLog(this.logPrefix+b+":"+c)}catch(d){console.error(d)}console[a](this.logPrefix+b+":"+c)};
Input_0$classdecl$var10.prototype.dispatchAdLog=function(a,b){this._logDispatcher.dispatchAdEvent(AdEvent.AD_LOG,[{key:a,message:b}])};Input_0$classdecl$var10.prototype.sendAdditionalDataToTestPlayer=function(a){a=JSON.stringify(a);var b=AdParamConfigReader.testPlayerUrl;"undefined"!==typeof b&&null!==b&&0<b.length&&window.top.postMessage(a,b)};var Logger=new Input_0$classdecl$var10,Input_0$classdecl$var11=function(){this.socketURL=Constants.WEBSOCKET_URL;this.connection=null};
Input_0$classdecl$var11.prototype.init=function(a,b){this.connection||(this.connection=new WebSocket(this.socketURL),this.connection.onopen=function(){Logger.info("Socket Connected for pubId:"+a+" and adId:"+b);Logger.info("Value of AdParamConfigReader._adTagParamMap is :"+JSON.stringify(AdParamConfigReader._adTagParamMap));Logger.info("Value of AdParamConfigReader._externalParamMap is :"+JSON.stringify(AdParamConfigReader._externalParamMap))},this.connection.onerror=function(a){Logger.error("Error in socket connection:"+
a)},this.connection.onclose=function(a){Logger.info("Socket connection onclose code:"+a.code)})};Input_0$classdecl$var11.prototype.isOpen=function(){return this.connection&&this.connection.readyState===WebSocket.OPEN};
Input_0$classdecl$var11.prototype.sendLog=function(a){this.connection.send(JSON.stringify({adId:AdParamConfigReader.adId,pubId:AdParamConfigReader.pubId,ucrid:AdParamConfigReader.ucrid,siteId:AdParamConfigReader.siteId,campaignId:AdParamConfigReader.campaignId,imprId:AdParamConfigReader.imprId,content:a}))};
var SocketConnection=new Input_0$classdecl$var11,URLParser=function(a){this._filenameNoExtention=this._filepathWithProtocol=this._protocol=this._urlVariables=this._domainName=this._url=null;this._url=a||"";this._urlVariables={};this.init(this._url)};URLParser.prototype.decode=function(a){var b={};a=a.substring(a.indexOf("?")+1).split("\x26");for(var c=0;c<a.length;c++)if(a[c]){var d=a[c].split("\x3d");b[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}return b};
URLParser.prototype.init=function(a){if(!StringUtils.isBlank(a)){this._domainName=a.split("/")[2];var b=a.indexOf("?");if(0<b){b=a.substring(b+1);try{this._urlVariables=this.decode(b)}catch(d){Logger.warn("Error while decoding query paramer: "+d.message)}}b=a.indexOf(":");this._protocol=-1!=b?a.substring(0,b):null;b=a.lastIndexOf("/");this._filepathWithProtocol=-1!=b?a.substring(0,b+1):null;var c=a.lastIndexOf(".");this._filenameNoExtention=-1!=b&&-1!=c&&b<c?a.substring(b+1,c):null}};
URLParser.prototype.getDomainName=function(){return this._domainName};URLParser.prototype.getWinAdNetworkId=function(){var a=0,b=this._urlVariables.adServerId||this._urlVariables.wa;StringUtils.isBlank(b)||(a=parseInt(b));return a};URLParser.prototype.getcrID=function(){var a=this._urlVariables.crID||this._urlVariables.crId;return a?a:""};URLParser.prototype.getucrid=function(){return this._urlVariables.ucrid?this._urlVariables.ucrid:""};
URLParser.prototype.getimprId=function(){var a=this._urlVariables.imprId||this._urlVariables.impid;return a?a:""};URLParser.prototype.getAdvertiserId=function(){return this._urlVariables.advertiser_id?this._urlVariables.advertiser_id:""};URLParser.prototype.getEcpm=function(){return this._urlVariables.ecpm?this._urlVariables.ecpm:""};URLParser.prototype.getPubConsent=function(){return StringUtils.isBlank(this._urlVariables.pmc)?-1:parseInt(this._urlVariables.pmc)};
URLParser.prototype.getWinCampaignId=function(){var a=0,b=this._urlVariables.campaignId||this._urlVariables.wc;StringUtils.isBlank(b)||(a=parseInt(b));return a};URLParser.prototype.getDefaultedAdServerId=function(){var a=0,b=this._urlVariables.defaultedAdServerId||this._urlVariables.da;StringUtils.isBlank(b)||(a=parseInt(b));return a};URLParser.prototype.getKAdNetworkId=function(){var a=0,b=this._urlVariables.kadNetwork;StringUtils.isBlank(b)||(a=parseInt(b));return a};
URLParser.prototype.getOID=function(){return this._urlVariables.oid?this._urlVariables.oid:0};URLParser.prototype.getFirePMEvent=function(){var a=1,b=this._urlVariables.pme;StringUtils.isBlank(b)||(a=parseInt(b));return a};URLParser.prototype.getQueryString=function(a){var b=null,c=a.indexOf("?");0<c&&(b=a.substring(c+1));return b};URLParser.prototype.getUrl=function(){return StringUtils.stripWhitespaces(this._url)};URLParser.prototype.getProtocol=function(){return this._protocol};
URLParser.prototype.getFilepathWithProtocol=function(){return this._filepathWithProtocol};URLParser.prototype.getFilenameNoExtention=function(){return this._filenameNoExtention};var URLVariables=function(){};URLVariables.prototype.decode=function(a){var b={};a=a.substring(a.indexOf("?")+1).split("\x26");for(var c=0;c<a.length;c++)if(a[c]){var d=a[c].split("\x3d");b[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}return b};var Loader=function(){this.staticResource=null};
Loader.prototype.load=function(a,b){var c=document.getElementsByTagName("head")[0],d=document.createElement("script");d.type="text/javascript";d.src=a;d.onreadystatechange=b;d.onload=b;c.appendChild(d)};Loader.prototype.ImageExist=function(a){var b=new Image;b.src=a;return 0!=b.height};Loader.prototype.preloadImg=function(a,b){var c=document.createElement("img");c.id=b;c.onload=this.onOverLayLoadComplete();c.src=a};
var TestPlayerData=function(a,b){switch(a){case 1:this.type="Wrapper";break;case 2:this.type="Media File";break;case 3:this.type="Third Party VPAID";break;default:this.type=null}this.url=b||"";this.success=!1;this.response=this.httpStatus=null};TestPlayerData.prototype.setSuccess=function(a){this.success=a||!1};TestPlayerData.prototype.setSuccessHttpStatusAndResponse=function(a,b,c){this.success=a||!1;this.httpStatus=b||null;this.response=c||null};var MediaClient=function(){};
MediaClient.prototype.onMetaData=function(a){Logger.debug("metadata: duration\x3d"+a.duration+" width\x3d"+a.width+" height\x3d"+a.height+" framerate\x3d"+a.framerate)};MediaClient.prototype.onCuePoint=function(a){Logger.debug("cuepoint: time\x3d"+a.time+" name\x3d"+a.name+" type\x3d"+a.type)};
var OverlayAdPlayer=function(a,b,c,d){this._pmVPAIDObj=d;this._initHeight=this._initWidth=0;this._closeButton=this._nonLinear=this._pmVPAID=this._loader=this._nonLinearAdTimmer=null;this._loader=this;this._initWidth=a;this._initHeight=b;this._adElement=c;this._pmVPAID=this._pmVPAIDObj.getInstance();this._nonLinear=this._adElement.getNonLinearAds().nonLinears[this._adElement.getNonLinearCreativeIndex()];this.timeoutStart=null;this._closeButton=PlayerControls.addClose();this._closeButton.addEventListener?
this._closeButton.addEventListener("click",function(a){return function(){a.onCloseAd()}}(this),!1):this._closeButton.attachEvent("onclick",this.onCloseAd)};OverlayAdPlayer.prototype.creativeExist=function(a){AdParamConfigReader.isHTTPS&&!StringUtils.isBlank(a)&&-1!=a.indexOf("http:")&&(a=StringUtils.getSecuredURL(a));var b=new XMLHttpRequest;b.open("HEAD",a,!1);try{b.send()}catch(c){return!1}return 404!=b.status};
OverlayAdPlayer.prototype.play=function(a){AdParamConfigReader.isHTTPS&&!StringUtils.isBlank(a)&&-1!=a.indexOf("http:")&&(a=StringUtils.getSecuredURL(a));Logger.info("Playing NonLinear ad..."+AdParamConfigReader.vmaxl);this._pmVPAID.setAdDuration(AdParamConfigReader.vmaxl);var b=function(a){return function(){a.onNonLinearAdTimmerComplete()}}(this);this._nonLinearAdTimmer=setTimeout(b,1E3*AdParamConfigReader.vmaxl);try{var c=document.createElement("img");c.id="pm-nl";c.addEventListener("click",function(a){return function(){a._pmVPAID._pmPlayer.nonLinearClickThruAd.call(a)}}(this),
!1);this.positionNonLinearAd();c.src=a;c.onerror=function(a){return function(){a.timeoutStart&&(a.timeoutStart.stop(),a.timeoutStart=null);a._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_NONLINEAR_CREATIVE_NOT_FOUND)}}(this);c.onload=function(a){return function(){a.timeoutStart&&(a.timeoutStart.stop(),a.timeoutStart=null);var b={x:a._loader.x,y:a._loader.y};a._pmVPAID.addChildAt(c,0,b);b={x:parseInt(a._loader.x)+parseInt(a._nonLinear._width),y:a._loader.y,h:15,w:15};a._pmVPAID.addChildAt(a._closeButton,
1,b);a._pmVPAID.buttonMode=!0;a._pmVPAID.executeAdStartedEvent();a._pmVPAID.executeImpressionEvent()}}(this);this.timeoutStart=new Timer(AdParamConfigReader.HTTP_REQUEST_TIMEOUT,0,this.timeoutComplete,this._pmVPAID);this.timeoutStart.start()}catch(d){this.timeoutStart&&(this.timeoutStart.stop(),this.timeoutStart=null),this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_NONLINEAR_GENERAL)}};OverlayAdPlayer.prototype.timeoutComplete=function(a){a.dispatchAdErrorEvent(ErrorMessage.PM_ERR_NONLINEAR_CREATIVE_TIMEOUT)};
OverlayAdPlayer.prototype.positionNonLinearAd=function(){var a=AdParamConfigReader.vxloc,b=AdParamConfigReader.vyloc;0!=a||0!=b?(this._loader.x=a,this._loader.y=b):this.positionAtMiddleBottom(this._nonLinear._width,this._nonLinear._height);Logger.debug("Done with setting position of NonLinear.")};OverlayAdPlayer.prototype.positionAtMiddleBottom=function(a,b){this._loader.x=0==a?0:(this._initWidth-a)/2;this._loader.y=0==b?0:this._initHeight-b};
OverlayAdPlayer.prototype.expand=function(){0!=this._nonLinear.expandedHeight&&0!=this._nonLinear.expandedWidth?(this._loader.height=this._nonLinear.expandedHeight,this._loader.width=this._nonLinear.expandedWidth):(this._loader.height=this._initHeight,this._loader.width=this._initWidth);this.positionAtMiddleBottom(this._loader.width,this._loader.height);this.positionCloseButton(this._loader.width);this._pmVPAID.adExpanded=!0;this._pmVPAID.dispatchAdEvent(AdEvent.AD_EXPANDED_CHANGE)};
OverlayAdPlayer.prototype.collapse=function(){this._loader.height=this._nonLinear.height;this._loader.width=this._nonLinear.width;this.positionNonLinearAd();this.positionCloseButton(this._loader.width);this._pmVPAID.adExpanded=!1;this._pmVPAID.dispatchAdEvent(AdEvent.AD_EXPANDED_CHANGE)};OverlayAdPlayer.prototype.resize=function(a,b){this._initWidth=a;this._initHeight=b;this.positionNonLinearAd();this.positionCloseButton(this._nonLinear.width);this._pmVPAID.dispatchAdEvent(AdEvent.AD_SIZE_CHANGE)};
OverlayAdPlayer.prototype.positionCloseButton=function(a){this._closeButton.x=this._loader.x+a-70;this._closeButton.y=this._loader.y+1};OverlayAdPlayer.prototype.loadOverlay=function(){var a=this._adElement.getNonLinearCreative(),b=this._adElement.getNonLinearCreativeMinDuration();AdParamConfigReader.vmaxl=b;this.play(a)};OverlayAdPlayer.prototype.onCloseAd=function(a){this._pmVPAID.executeTrackingEvent(TrackingEventTypes.CLOSE);this.onNonLinearAdTimmerComplete(a)};
OverlayAdPlayer.prototype.onNonLinearAdTimmerComplete=function(){Logger.debug("Inside OverlayAdPlayer:onNonLinearAdTimmerComplete()");clearTimeout(this._nonLinearAdTimmer);this._pmVPAID.removeChildAt(1);this._pmVPAID.removeChildAt(0);this._pmVPAID.stopAd()};var Input_0$classdecl$var12=function(){};
Input_0$classdecl$var12.prototype.getSyncUpURI=function(){var a=AdParamConfigReader.showAdJSURI+"#PIX\x26it\x3d2\x26kdntuid\x3d1\x26np\x3d0\x26p\x3d"+AdParamConfigReader.pubId+"\x26s\x3d"+AdParamConfigReader.siteId+"\x26a\x3d"+AdParamConfigReader.adId;Logger.debug("SYNC UP URI "+a);return a};Input_0$classdecl$var12.prototype.startUserSynchUp=function(){var a=this.getSyncUpURI();return this.executeIframePixels(a)};
Input_0$classdecl$var12.prototype.executeIframePixels=function(a){var b=window.document.createElement("IFRAME");b.id="pm-"+Math.ceil(100*Math.random());b.src=a;b.width="0";b.height="0";b.scrolling="no";b.frameborder="0";b.style="height:0px;width:0px;display:none;";b.vspace="0";b.hspace="0";b.marginwidth="0";b.marginheight="0";b.allowtransparency="true";window.document.body.appendChild(b);Logger.debug("Pixel - "+a+"\n Pixel is executed...");return b.id};
Input_0$classdecl$var12.prototype.executeScriptPixels=function(a){var b=window.document.createElement("SCRIPT");b.id="pm-"+Math.ceil(100*Math.random());window.document.body.appendChild(b);b.src=a};Input_0$classdecl$var12.prototype.executeImagePixels=function(a){var b=document.createElement("img");b.id="pm-"+Math.ceil(100*Math.random());b.style="height:1px;width:1px;display:none;";b.src=a;window.document.body.appendChild(b)};
Input_0$classdecl$var12.prototype.executeCodePixels=function(a){try{var b=window.document.createElement("IFRAME");b.id="pm-"+Math.ceil(100*Math.random());b.width="0";b.height="0";b.scrolling="no";b.style="height:0px;width:0px;display:none;";b.vspace="0";b.hspace="0";b.marginwidth="0";b.marginheight="0";b.allowtransparency="true";var c=function(){b.contentDocument.write(this.scriptCode)},c=c.bind({scriptCode:a});b.onload=c;window.document.body.appendChild(b);Logger.debug("Pixel - "+a+"\n Pixel is executed...")}catch(d){Logger.debug("Error executing code pixels: "+
d)}};Input_0$classdecl$var12.prototype.addShowadScriptToPage=function(){var a=window.document.createElement("script");a.type="text/javascript";a.id="pm-sadscript";a.src=AdParamConfigReader.showAdJSURI;window.document.body.appendChild(a)};
Input_0$classdecl$var12.prototype.showAdvReady=function(){var a={pubId:AdParamConfigReader.pubId,siteId:AdParamConfigReader.siteId,adId:AdParamConfigReader.adId,playerDomId:""};Logger.debug("Checking for PubMatic object exposed by showad.js after AdParamConfigReader.SHOWAD_LOAD_TIMEOUT of : "+AdParamConfigReader.SHOWAD_LOAD_TIMEOUT);"undefined"!==typeof PubMatic?(Logger.debug("PubMatic object is available. Will be calling PubMatic.sendParamToVPAID()"),a=PubMatic.sendParamToVPAID(a),Logger.debug("##-----------------------------------##"),
Logger.debug("Parameters recevied from JS :"),Logger.debug(JSON.stringify(a)),Logger.debug("##-----------------------------------##"),this.getDataFromJS(a)):Logger.warn("PubMatic object is not available, even after AdParamConfigReader.SHOWAD_LOAD_TIMEOUT of : "+AdParamConfigReader.SHOWAD_LOAD_TIMEOUT)};
Input_0$classdecl$var12.prototype.getDataFromJS=function(a){Logger.debug("getDataFromJS(): Collecting Data from showad.js: "+a);if(a&&AdParamConfigReader){AdParamConfigReader.updateExternalParamMap(Constants.SA_VERSION,a.SAVersion);AdParamConfigReader.updateExternalParamMap(Constants.IN_I_FRAME,a.inIframe);AdParamConfigReader.updateExternalParamMap(Constants.K_DNT_UID,a.kdntuid);AdParamConfigReader.updateExternalParamMap(Constants.K_L_TSTAMP,a.kltstamp);AdParamConfigReader.updateExternalParamMap(Constants.PAGE_URL,
a.pageURL);AdParamConfigReader.updateExternalParamMap(Constants.RAN_REQ,a.ranreq);AdParamConfigReader.updateExternalParamMap(Constants.SCREEN_RESOLUTION,a.screenResolution);AdParamConfigReader.updateExternalParamMap(Constants.TIMEZONE,a.timezone);AdParamConfigReader.updateExternalParamMap(Constants.AT_PAYLOAD,a.at_payload);StringUtils.isBlank(a.coppa)||("false"==a.coppa?AdParamConfigReader.updateExternalParamMap(Constants.COPPA,!1):AdParamConfigReader.updateExternalParamMap(Constants.COPPA,!0));StringUtils.isBlank(a.plyH)||
AdParamConfigReader.vh||(AdParamConfigReader.vh=parseInt(a.plyH),AdParamConfigReader.updateAdTagParamMap(Constants.PLAYER_HEIGHT,parseInt(a.plyH)));StringUtils.isBlank(a.plyW)||AdParamConfigReader.vw||(AdParamConfigReader.vw=parseInt(a.plyW),AdParamConfigReader.updateAdTagParamMap(Constants.PLAYER_WIDTH,parseInt(a.plyW)));AdParamConfigReader.updateExternalParamMap(Constants.WIN_HEIGHT,parseInt(a.winH));AdParamConfigReader.updateExternalParamMap(Constants.REF_URL,a.refURL);AdParamConfigReader.updateExternalParamMap(Constants.WIN_WIDTH,
parseInt(a.winW));AdParamConfigReader.updateExternalParamMap(Constants.WIN_URL,a.winURL);AdParamConfigReader.updateExternalParamMap(Constants.DEPTH,parseInt(a.depth));AdParamConfigReader.updateExternalParamMap(Constants.PLAYER_VISIBILITY,parseInt(a.pos));var b=-1,c=-1;StringUtils.isBlank(a.plocx)||(b=parseInt(a.plocx));StringUtils.isBlank(a.plocy)||(c=parseInt(a.plocy));-1!=b&&-1!=c&&AdParamConfigReader.updateExternalParamMap(Constants.PLAYER_LOCATION,c+"x"+b);if(b=parseInt(a[Constants.GDPR_FLAG])||
0)AdParamConfigReader.gdpr_flag=b,AdParamConfigReader.updateExternalParamMap(Constants.GDPR_FLAG,b);b=a[Constants.CONSENT_STR]||"";StringUtils.isBlank(b)||(AdParamConfigReader.consent_str=b,AdParamConfigReader.updateExternalParamMap(Constants.CONSENT_STR,b));a=a[Constants.CCPA]||"";!StringUtils.isBlank(a)&&a.length<=Constants.CCPA_STRING_LENGTH&&(AdParamConfigReader.ccpa=a,AdParamConfigReader.updateExternalParamMap(Constants.CCPA,a))}};
Input_0$classdecl$var12.prototype.dropIQPixel=function(a){try{a.pmIQPixels.forEach(function(a,c){var b=window.document.createElement("script");b.async=!0;b.type="text/javascript";b.id="iqScript-"+c;b.src=a;window.document.body.appendChild(b);b=window.document.createElement("img");b.id="iqImg-"+c;c=a;c=c.replace(c.match(/\:\/\/([^\/?#]+)/i)[0],"://s.iaudienc.com");c=c.replace(".js",".gif");c=c.replace(/(dt=)[0-9]+/g,"dt\x3d5397181496862807095012");c=c.replace("/925744/","/539718/");b.src=c;window.document.body.appendChild(b);
Logger.info("Loading IQ Pixel:"+a);Logger.info("Loading IQ-mod Pixel:"+c)})}catch(b){Logger.error("Error in executing IQ pixel: "+b.message)}};
Input_0$classdecl$var12.prototype.executeExtensionPixels=function(a){try{for(var b=0;b<a.length;b++){var c=a[b];switch(c.type){case Constants.IFRAME:this.executeIframePixels(c.url);break;case Constants.SCRIPT:this.executeScriptPixels(c.url);break;case Constants.IMAGE:this.executeImagePixels(c.url);break;default:Logger.warn("Pixel Type is absent; Thus Pixel cannot be executed.")}}}catch(d){Logger.error("Pixel execution; Pixel information : "+d)}};
Input_0$classdecl$var12.prototype.executeExtensions=function(a,b){try{for(var c=a.length-1;0<=c;c--){var d=a[c].code;switch(d.type){case Constants.CODE:this.executeCodePixels(d.url,b);a.pop();break;case Constants.IFRAME_URL:this.executeIframePixels(d.url);a.pop();break;case Constants.SCRIPT_URL:this.executeScriptPixels(d.url);a.pop();break;case Constants.IMAGE_URL:this.executeImagePixels(d.url);a.pop();break;default:Logger.warn("Pixel Type is absent; Thus Pixel cannot be executed.")}}}catch(e){Logger.error("Pixel execution; Pixel information : "+
e)}};var JSInterfaceHandler=new Input_0$classdecl$var12;
function PMVideoPlayer(a,b,c){this._initHeight=this._initWidth=0;this._viewMode="normal";this._desiredBitrate=0;this._creativeData={AdParameters:""};this._environmentVars={};this._pmVPAID=c;this._video=null;this._totalAdDuration;this._overlayPlayer=null;this._urlParser=new URLParser;this._testPlayerData=null;this._completeFlag=this._thirdQuartileFlag=this._midpointFlag=this._firstQuartileFlag=this._startQuartileFlag=!0;this._adElement=null;if(this._isLinearAd=a)this._video=b;this.isPaused=!0;this.skobj=
null;this._fallbackTimer=new Timer(AdParamConfigReader.MEDIA_FALLBACK_TIMEOUT,1,function(a){Logger.info("Media Fallback timeout.");a._fallbackTimer.stop();a._mediaFileTimer.stop();a._video.removeEventListener("error",a.videoPlayError,!1);a.removeVideoPlayerAdListeners();0<a._pmVPAID._errorCollection.length?a._pmVPAID.dispatchAdErrorEvent(a._pmVPAID._errorCollection.pop()):a._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_MEDIAFILE_TIMEOUT)},this);this._mediaFileTimer=new Timer(AdParamConfigReader.MEDIA_REQ_TIMEOUT,
1,function(a){a._testPlayerData.setSuccess(!1);Logger.sendAdditionalDataToTestPlayer(a._testPlayerData);a.removeVideoPlayerAdListeners();a._mediaFileTimer.stop();if(a._fallbackTimer.running){var b=a._adElement.getMediaFileURI();a.playStream(b)}},this);void 0!==this._video.pmVpaidVolume&&(Logger.debug("Calling PMVideoPlayer.changeVolume to set the volume level as per our 'pmVpaidVolume' field."),this.changeVolume(this._video.pmVpaidVolume))}
PMVideoPlayer.prototype.initPMPlayer=function(a,b,c,d,e,f,k){Logger.info("Inside PMVideoPlayer initPMPlayer : ");this._initHeight=b;this._initWidth=a;this._viewMode=c;this._desiredBitrate=d;this._creativeData=e||{};this._environmentVars=f||{};this._adElement=k;this._slot=f.slot;this._isLinearAd&&(this._video.height=b,this._video.width=a,this.setTotalAdDurationInSec());this._pmVPAID.dispatchAdLoadedEvent();Logger.debug("VideoPlayer attributes Initialized .")};
PMVideoPlayer.prototype.startPMPlayerTimer=function(){Logger.info("Inside startPMPlayerTimer : _pmPlayerHeartBeat start");0<this._totalAdDuration?this._pmPlayerHeartBeat=setInterval(this.onPMPlayerHeartBeatEvent.bind(this),200):(Logger.error("Total Ad Duration not set."),this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_AD_DURATION_ERROR,!1,null))};PMVideoPlayer.prototype.resetPMPlayer=function(){Logger.info("Inside resetPMPlayer: _pmPlayerHeartBeat stop/clear");clearInterval(this._pmPlayerHeartBeat)};
PMVideoPlayer.prototype.onSkipAd=function(){this._pmVPAID.executeAdSkipEvent()};
PMVideoPlayer.prototype.addSkipable=function(a){this._skipButton=null;var b=function(a){return function(b){b.preventDefault();b.stopImmediatePropagation();a.onSkipAd()}}(this),c=function(a){return function(a){a.preventDefault();a.stopImmediatePropagation()}}(this),d=a;this._skipButton=PlayerControls.addSkipBtn(this._pmVPAID._slot);this._skipButton.addEventListener?this._skipButton.addEventListener("click",c,!1):this._skipButton.attachEvent("onclick",this.onSkipAd);if(0<d)var e=setInterval(function(a){return function(){document.getElementById("_pmSkip")?
(document.getElementById("_pmSkip").innerHTML="You can skip this ad in "+d,a._skipButton.style.display="block",Logger.debug(d),0==d&&(clearInterval(e),document.getElementById("_pmSkip").innerHTML="Skip Ad \x3e\x3e",a._skipButton.removeEventListener("click",c,!1),a._skipButton.addEventListener("click",b,!1)),a.isPaused||d--):0<a._slot.getElementsByClassName("_pmSkip").length&&(a._slot.getElementsByClassName("_pmSkip")[0].innerHTML="You can skip this ad in "+d,a._skipButton.style.display="block",Logger.debug(d),
0==d&&(clearInterval(e),a._slot.getElementsByClassName("_pmSkip")[0].innerHTML="Skip Ad \x3e\x3e",a._skipButton.removeEventListener("click",c,!1),a._skipButton.addEventListener("click",b,!1)),a.isPaused||d--)}}(this),1E3)};
PMVideoPlayer.prototype.start=function(){Logger.info("Inside PMVideoPlayer:start()");if(this._isLinearAd)try{Logger.debug("PMVideoPlayer playing linear ad...");this._pmVPAID.resetAdDuration();(function(a){a._slot&&a._slot.addEventListener("click",function(b){b.preventDefault();b.stopImmediatePropagation();a.linearClickThruAd()})})(this);var a=this._adElement.getMediaFileURI();this.playStream(a)}catch(b){this._pmVPAID.removeSkipAt(this.skobj),Logger.debug("PMVideoPlayer - Error when, playing linear ad: "+
b),this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_UNDEFINED,!1,b.message)}else{Logger.debug("PMVideoPlayer playing nonlinear ad...");this._overlayPlayer=new OverlayAdPlayer(this._initWidth,this._initHeight,this._adElement,this._pmVPAID);try{this._overlayPlayer.loadOverlay()}catch(b){Logger.debug("PMVideoPlayer - Error when, playing Non-linear ad..."),this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_NONLINEAR_GENERAL,!1,b.message)}}};
PMVideoPlayer.prototype.addVideoPlayerAdListeners=function(){this.isVideoError=!1;window.addEventListener?(this._video.addEventListener("error",function(a){return function(b){a.isVideoError||(a.isVideoError=!0,a.videoPlayError(b))}}(this),!0),this._video.addEventListener("durationchange",function(a){return function(){0<a._video.duration&&a.setTotalAdDuration(a._video.duration)}}(this),!0),GeneralUtils.detectDevice("ios")?this._video.addEventListener("canplay",function(a){return function(){a.play()}}(this),
!1):this._video.addEventListener("loadstart",function(a){return function(){a.play()}}(this),!0),this._video.addEventListener("timeupdate",function(a){return function(){if(!a._pmVPAID._isImpressionEventDispached&&0<a._video.currentTime){a._testPlayerData.setSuccess(!0);Logger.sendAdditionalDataToTestPlayer(a._testPlayerData);a.startPMPlayerTimer();Logger.info("Playing Ad !!!");if(!a.isPaused)try{PlayerControls.removePlayBtn(a._slot)}catch(e){Logger.error("Error removing Play Button. Error : "+e.message),
Logger.debug(e)}try{var b,c=a._pmVPAID._adElement._linear._skipoffset||null,d=a.getTotalAdDuration();1===AdParamConfigReader.vskip&&(c&&"percent"===StringUtils.stringFormat(c)?(c=StringUtils.percentToNumber(c),b=Math.round(c*d/100),a.addSkipable(b)):c&&"time"===StringUtils.stringFormat(c)?(b=StringUtils.timecodeToSeconds(c),a.addSkipable(b)):Logger.debug("skipoffset is not valid. Please check if it is percent then it should be between 1-99% and if it is time then it should be hh:mm:ss format"))}catch(e){Logger.warn("Error in setting skippable options: "+
e.message)}a._pmVPAID.executeImpressionEvent();a._pmVPAID.executeAdStartedEvent();a._pmVPAID.executeTrackingEvent(TrackingEventTypes.START)}}}(this),!0)):window.attachEvent&&(this._video.attachEvent("error",function(a){return function(b){a.isVideoError||(a.isVideoError=!0,a.videoPlayError(b))}}(this),!1),this._video.attachEvent("loadstart",function(a){return function(){a.play()}}(this),!1),this._video.attachEvent("durationchange",function(a){return function(){a._video.duration&&a.setTotalAdDuration(a._video.duration)}}(this),
!1),this._video.attachEvent("timeupdate",function(a){return function(){if(!a._pmVPAID._isImpressionEventDispached&&0<a._video.currentTime){a._testPlayerData.setSuccess(!0);Logger.sendAdditionalDataToTestPlayer(a._testPlayerData);a.startPMPlayerTimer();Logger.info("Playing Ad !!!");try{PlayerControls.removePlayBtn(a._slot)}catch(e){Logger.error("Error removing Skip Button. Error : "+e.message),Logger.debug(e)}try{var b,c=a._pmVPAID._adElement._linear._skipoffset||null,d=a.getTotalAdDuration();1===
AdParamConfigReader.vskip&&(c&&"percent"===StringUtils.stringFormat(c)?(c=StringUtils.percentToNumber(c),b=Math.round(c*d/100),a.addSkipable(b)):c&&"time"===StringUtils.stringFormat(c)?(b=StringUtils.timecodeToSeconds(c),a.addSkipable(b)):Logger.debug("skipoffset is not valid. Please check if it is percent then it should be between 1-99% and if it is time then it should be hh:mm:ss format"))}catch(e){Logger.warn("Error in setting skippable options: "+e.message)}a._pmVPAID.executeImpressionEvent();
a._pmVPAID.executeAdStartedEvent();a._pmVPAID.executeTrackingEvent(TrackingEventTypes.START)}}}(this),!1))};PMVideoPlayer.prototype.removeVideoPlayerAdListeners=function(){this._video.removeEventListener("loadstart",this.play,!0);this._video.removeEventListener("durationchange",this.play,!0);this._video.removeEventListener("canplay",this.play,!0)};
PMVideoPlayer.prototype.playStream=function(a){Logger.debug("Inside PMVideoPlayer:playStream()");this._testPlayerData=new TestPlayerData(2,a);try{StringUtils.isBlank(a)?(this.removeVideoPlayerAdListeners(),this._mediaFileTimer.stop(),this._fallbackTimer.stop(),this._testPlayerData.setSuccess(!1),Logger.sendAdditionalDataToTestPlayer(this._testPlayerData),0<this._pmVPAID._errorCollection.length?this._pmVPAID.dispatchAdErrorEvent(this._pmVPAID._errorCollection.pop(),!1):this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_LINEAR_ALL_MEDIAFILE_FAILED_TO_PLAY,
!1)):(this._video.src=a,this.addVideoPlayerAdListeners(),this._fallbackTimer.running||this._fallbackTimer.start(),this._mediaFileTimer.start(),this._video.load(),this._video.play())}catch(b){this._mediaFileTimer.stop(),this._fallbackTimer.stop(),this._pmVPAID.removeSkipAt(this.skobj),this._testPlayerData.setSuccess(!1),Logger.sendAdditionalDataToTestPlayer(this._testPlayerData),Logger.error("Error in playing stream: "+b),this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_UNDEFINED,!1,b.message)}};
PMVideoPlayer.prototype.play=function(){this.removeVideoPlayerAdListeners();this._mediaFileTimer.running&&this._fallbackTimer.running&&(this._mediaFileTimer.stop(),this._fallbackTimer.stop(),this.renderAd(this._video))};
PMVideoPlayer.prototype.videoPlayError=function(){this._testPlayerData.setSuccess(!1);Logger.sendAdditionalDataToTestPlayer(this._testPlayerData);this._video.removeEventListener("error",this.videoPlayError,!1);this._mediaFileTimer.stop();this._fallbackTimer.stop();if(1>this._pmVPAID._errorCollection.length){var a=ErrorMessage.PM_ERR_MEDIAFILE_GENERAL,b="Error occured during video playback !!! ";try{switch(this._video&&this._video.error&&this._video.error.code?this._video.error.code:0){case window.MediaError.MEDIA_ERR_ABORTED:b+=
"You aborted the video playback. OR";a=ErrorMessage.PM_ERR_MEDIAFILE_ABORT;break;case window.MediaError.MEDIA_ERR_NETWORK:b+="A network error caused the video download to fail part-way.";a=ErrorMessage.PM_ERR_MEDIAFILE_NETWORK_ERR;break;case window.MediaError.MEDIA_ERR_DECODE:b+="The video playback was aborted due to a corruption problem or because the video used features your browser did not support.";a=ErrorMessage.PM_ERR_MEDIAFILE_DECODE;break;case window.MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:b+=
"The video could not be loaded, either because the server or network failed or because the format is not supported.";a=ErrorMessage.PM_ERR_UNSUPPORTED_MEDIA_FILE_ERROR;break;default:a=ErrorMessage.PM_ERR_MEDIAFILE_GENERAL}Logger.warn(b)}catch(c){Logger.warn(c+" Error from video player while playing video"),a=ErrorMessage.PM_ERR_MEDIAFILE_GENERAL}this._pmVPAID._errorCollection.push(a)}this._pmVPAID._isImpressionEventDispached||(a=this._adElement.getMediaFileURI(),this.playStream(a))};
PMVideoPlayer.prototype.pause=function(a){a=void 0===a?!1:a;Logger.debug("Inside PMVideoPlayer:pause()");if(this._isLinearAd){Logger.debug("Pausing Video Ad : time: "+this._video.currentTime);try{this.isPaused=!0,this._video.pause(),a?this._pmVPAID.dispatchAdEvent(AdEvent.AD_PAUSED):this._pmVPAID.executeTrackingEvent(TrackingEventTypes.PAUSE)}catch(b){Logger.debug("Error in pausing the Linear video ad:"+b.message)}}};
PMVideoPlayer.prototype.resume=function(a){a=void 0===a?!1:a;Logger.debug("Inside PMVideoPlayer:resume()");if(this._isLinearAd){Logger.debug("Resuming Video Ad : time: "+this._video.currentTime);try{this._video.play(),this.isPaused=!1,a?this._pmVPAID.dispatchAdEvent(AdEvent.AD_PLAYING):this._pmVPAID.executeTrackingEvent(TrackingEventTypes.RESUME)}catch(b){Logger.warn("Error in resuming the Linear video ad:"+b.message)}}};
PMVideoPlayer.prototype.stop=function(){var a=this;Logger.debug("Inside PMVideoPlayer:stop()");try{this._isLinearAd&&(Logger.debug("Stoping Ad : time: "+this._video.currentTime),this._video.pause(),this._video.ended=!0),setTimeout(function(){a._pmVPAID.dispatchAdEvent(AdEvent.AD_STOPPED)},AdParamConfigReader.DISPATCH_EVENTS_TIMEOUT)}catch(b){Logger.warn("Error in stopping linear/nonLinear  ad:"+b.message)}};
PMVideoPlayer.prototype.expand=function(){Logger.debug("Inside PMVideoPlayer:expand()");this._isLinearAd||this._overlayPlayer.expand()};PMVideoPlayer.prototype.collapse=function(){Logger.debug("Inside PMVideoPlayer:collapse()");this._isLinearAd||this._overlayPlayer.collapse()};
PMVideoPlayer.prototype.resize=function(a,b,c){Logger.debug("Inside PMVideoPlayer:resize()");this._isLinearAd?(this._video.height=b,this._video.width=a,this._pmVPAID.dispatchAdEvent(AdEvent.AD_SIZE_CHANGE)):this._overlayPlayer.resize(a,b,c)};PMVideoPlayer.prototype.getAdVolume=function(){Logger.info("Inside PMVideoPlayer:getAdVolume()");if(this._video)return this._video.volume};
PMVideoPlayer.prototype.changeVolume=function(a){Logger.debug("Inside PMVideoPlayer:changeVolume(): "+a);try{this._video.volume=a,this._pmVPAID._volume=a,this._video.muted=0>=a?!0:!1,this._pmVPAID.dispatchAdEvent(AdEvent.AD_VOLUME_CHANGE)}catch(b){Logger.warn("Exception while changing video ad volume: "+b.message)}};
PMVideoPlayer.prototype.setMute=function(a){a&&!this._video.muted&&(Logger.debug("Toggle Mute to "+a),this._video.volume=0,this._pmVPAID._volume=0,this._video.muted=!0,this._pmVPAID.dispatchAdEvent(AdEvent.AD_VOLUME_CHANGE));!a&&this._video.muted&&(Logger.debug("Toggle Mute to "+a),this._video.volume=1,this._pmVPAID._volume=1,this._video.muted=!1,this._pmVPAID.dispatchAdEvent(AdEvent.AD_VOLUME_CHANGE))};
PMVideoPlayer.prototype.getAdCompanions=function(){Logger.debug("Inside PMVideoPlayer:getAdCompanions()");var a;try{a=this._adElement.getCompanionsAdsXML()||"","string"!=typeof a||!AdParamConfigReader.isHTTPS||StringUtils.isBlank(a)||-1==a.indexOf("http:")&&-1==a.indexOf("http%3A")||(a=StringUtils.getSecuredURL(a))}catch(b){this._pmVPAID.dispatchAdErrorEvent(ErrorMessage.COMPANION_ADS_GENERAL_ERROR,!1,b.message)}return a};PMVideoPlayer.prototype.getTotalAdDuration=function(){return this._totalAdDuration};
PMVideoPlayer.prototype.getRemainingAdDuration=function(){var a=0;this._video&&null!=this._video.currentTime&&(a=this._totalAdDuration-this._video.currentTime);return a};
PMVideoPlayer.prototype.setTotalAdDurationInSec=function(){try{Logger.info("Inside PMVideoPlayer:setTotalAdDurationInSec()");var a=this._adElement.getDuration(),b;if(null==a||void 0===a)a={},a.seconds=AdParamConfigReader.vminl%60,a.minutes=AdParamConfigReader.vminl/60%60,Logger.debug("Setting custom adDuration \x3c-\x3e vminl param ... adDuration: "+a),b=60*a.minutes+a.seconds;else{for(var a=a&&a.toString()||"",c=a.split(":"),a=0,d=1;0<c.length;)a+=d*parseInt(c.pop(),10),d*=60;b=a||0}Logger.debug("Inside PMVideoPlayer:setTotalAdDurationInSec() : "+
b);this.setTotalAdDuration(b)}catch(e){Logger.error("Error setting Total Ad Duration: "+e.message)}};PMVideoPlayer.prototype.setTotalAdDuration=function(a){this._totalAdDuration=a;this._pmVPAID.dispatchAdEvent(AdEvent.AD_DURATION_CHANGE)};
PMVideoPlayer.prototype.onPMPlayerHeartBeatEvent=function(){try{var a=this.getTrackingEventByVideoProgressStatus(Math.round(this._video.currentTime));TrackingEventTypes.INVALID_EVENT_TYPE!==a&&(this._pmVPAID.executeTrackingEvent(a),TrackingEventTypes.COMPLETE===a&&this._pmVPAID.stopAd())}catch(b){Logger.warn("Error in onPMPlayerHeartBeatEvent() of PMVideoPlayer: "+b.message)}};
PMVideoPlayer.prototype.onOverLayLoadComplete=function(){Logger.info("NonLinear load completed....");try{this._overlayPlayer.play()}catch(a){Logger.error("Error in statusEventHandler() of PMVideoPlayer: "),this.handleMediaError(ErrorMessage.PM_ERR_NONLINEAR_GENERAL)}};PMVideoPlayer.prototype.handleMediaError=function(a){Logger.error(a.errorMessage);this._pmVPAID.handleErrorPassback()};
PMVideoPlayer.prototype.getTrackingEventByVideoProgressStatus=function(a){var b=TrackingEventTypes.INVALID_EVENT_TYPE,c=Math.round(this._totalAdDuration);this._startQuartileFlag&&1<=a&&a<1*c/4?this._startQuartileFlag=!1:this._firstQuartileFlag&&a>=1*c/4&&a<1*c/2?(b=TrackingEventTypes.FIRST_QUARTILE,this._firstQuartileFlag=!1):this._midpointFlag&&a>=1*c/2&&a<3*c/4?(b=TrackingEventTypes.MIDPOINT,this._midpointFlag=!1):this._thirdQuartileFlag&&a>=3*c/4&&a<c?(b=TrackingEventTypes.THIRD_QUARTILE,this._thirdQuartileFlag=
!1):this._completeFlag&&a>=c&&(b=TrackingEventTypes.COMPLETE,this._completeFlag=!1);b!==TrackingEventTypes.INVALID_EVENT_TYPE&&(Logger.info(a+":"+c),Logger.info(b));return b};PMVideoPlayer.prototype.linearClickThruAd=function(){this._pmVPAID.linearClickThruAd()};PMVideoPlayer.prototype.nonLinearClickThruAd=function(){var a=this._adElement.getNonLinearCreativeIndex();this._pmVPAID.nonLinearClickThruAd(a)};PMVideoPlayer.prototype.renderAd=function(){this._pmVPAID.dispatchAdEvent(AdEvent.AD_STARTED)};
function LinearAd(){this._videoSlot=this._slot=null;this._videoSlotCanAutoPlay=!1;this._adElement=this.vpaidJSON=null;this.adHeight=this.adWidth=this.__initHeight=this.__initWidth=0;this.__viewMode="normal";this.__desiredBitrate=0;this.__environmentVars=this.__creativeData="";this._isLinearAd=!0;this._isVPAIDAd=!1;this._remainingTime=this._totalAdDuration=0;this._currentAdElement;this._loadTimer=this._currentVpaidPhase=null;this._plyInfo="";this._pmPlayer=this._showAdJSLoadTimmer=this._adTagHandler=
null;this._adExpanded=!1;this._volume=1;this._errorCollection=[];this._myInstance=this;this._isHandshakeDone=!1;this._adRequestTime=this._impErrorTime=0;this._previousEvents=[];this.mouseEnabled=!0;this._isAdLoadedEventDispached=!1;this._currentAdIndex=0;this._isErrorEventDispatched=this._isImpressionEventDispached=!1;Logger.initialize(this)}LinearAd.prototype.setAdElement=function(a){this._adElement=a};LinearAd.prototype.getAdElement=function(){return this._adElement};
LinearAd.prototype.removeSkipAt=function(a){a&&this._slot.removeChild(a)};LinearAd.prototype.addSkipAt=function(a,b,c){var d=document.getElementById(b);d&&this._slot.removeChild(d);a.id=b;a.className=b;c&&c.x&&c.y&&(a.style.right=c.x+"px",a.style.bottom=c.y+"px",a.style.position="absolute");this._slot.appendChild(a);return a};
LinearAd.prototype.addChildAt=function(a,b,c,d){d?a.style.display="none":(a.id="pm-"+b,c&&c.x&&c.y&&(a.style.left=c.x+"px",a.style.top=c.y+"px",a.style.position="absolute"),c&&c.w&&c.h&&(a.style.height=c.h+"px",a.style.width=c.w+"px"));this._slot.appendChild(a)};LinearAd.prototype.removeChildAt=function(){this._slot.innerHTML=""};LinearAd.prototype.getAdIcons=function(){Logger.info("getAdIcons not supported.")};LinearAd.prototype.getAdWidth=function(){return this.adWidth};
LinearAd.prototype.getAdHeight=function(){return this.adHeight};LinearAd.prototype.handshakeVersion=function(a){Logger.setDebugLevel(1);Logger.info("VPAIDMain:handshakeVersion() - PM AD MANAGER RELEASE VERSION: "+Constants.PM_AD_MGR_RELEASE_VERSION);Logger.info("VPAIDMain:handshakeVersion() - Player Version:"+a);preInitProcessing(this);this._isHandshakeDone=!0;return Constants.PM_VPAID_VERSION};
var preInitProcessing=function(a){try{a._impErrorTime=performance.now(),a._adRequestTime=performance.now()}catch(b){Logger.debug("Inside catch block of preInitProcessing: "+b)}AdParamConfigReader.initPreConfiguration(a);AdParamConfigReader.isPixelFlag&&JSInterfaceHandler.startUserSynchUp();AdParamConfigReader.isAPIResponse||JSInterfaceHandler.addShowadScriptToPage()};
LinearAd.prototype.initAd=function(a,b,c,d,e,f){Logger.info("into initAd method");this.__initWidth=a;this.__initHeight=b;this.__viewMode=c;this.__desiredBitrate=d;this.__creativeData=e;f=(this.__environmentVars=f)||{};this._slot=f.slot;this._videoSlot=f.videoSlot;Logger.info("Auotplay check: From Video Player environmentVars.videoSlotCanAutoPlay: "+f.videoSlotCanAutoPlay);this._videoSlotCanAutoPlay=f.videoSlotCanAutoPlay||!1;var k;c=!1;this._videoSlot&&null!==this._videoSlot.volume&&void 0!==this._videoSlot.volume&&
(Logger.info("Player provided the volume level: "+this._videoSlot.volume),k=this._videoSlot.volume,c=!0);d=0;1===AdParamConfigReader.initAdVolumeLogic?(Logger.info("Considering videoSlotCanAutoplay field for volume selection."),d=!0===this._videoSlotCanAutoPlay?c?k:0:c?k:1):(Logger.info("Considering only volume field for volume selection."),d=c?k:1);this._videoSlot.pmVpaidVolume=d;Logger.debug("InitAd: Calling setAdVolume function with parameter: "+this._videoSlot.pmVpaidVolume);this.setAdVolume(this._videoSlot.pmVpaidVolume);
this.setAdWidth(a);this.setAdHeight(b);e=e||{};Logger.debug("initWidth: "+a+"\ninitHeight: "+b);this._isHandshakeDone||preInitProcessing(this);AdParamConfigReader.initConfig(e,a,b,this)&&(AdParamConfigReader.isAPIResponse?(0==AdParamConfigReader.embedded&&(StringUtils.isBlank(AdParamConfigReader.vcrtv)?this.dispatchAdErrorEvent(ErrorMessage.PM_ERR_CREATIVE_IN_QUERY_NOT_FOUND,!1):this.processAPIResponse(decodeURIComponent(AdParamConfigReader.vcrtv))),1==AdParamConfigReader.embedded&&(StringUtils.isBlank(AdParamConfigReader.AdParameters)?
this.dispatchAdErrorEvent(ErrorMessage.PM_ERR_CREATIVE_IN_ADPARAM_NOT_FOUND,!1):this.processAPIResponse(decodeURIComponent(AdParamConfigReader.AdParameters)))):this._showAdJSLoadTimmer=setTimeout(function(a){JSInterfaceHandler.showAdvReady();1!=AdParamConfigReader.csa&&a.makeAdServerCall();1==AdParamConfigReader.csa&&(Logger.info("Deferring Ad Serving call into startAd Phase for pubId: "+AdParamConfigReader.pubId),a.dispatchAdLoadedEvent())},AdParamConfigReader.SHOWAD_LOAD_TIMEOUT,this))};
LinearAd.prototype.processAPIResponse=function(a){this._adTagHandler=new AdTagHandler("",this.getInstance());this._adTagHandler.onRequestComplete(a)};LinearAd.prototype.startAd=function(){Logger.info("Inside VPAIDMain:startAd()");this._currentVpaidPhase=ProtocolPhase.START_AD;1==AdParamConfigReader.csa?this.makeAdServerCall():this._pmPlayer.start()};LinearAd.prototype.getAdLinear=function(){Logger.debug("Inside getAdLinear()");return this._isLinearAd};
LinearAd.prototype.getAdRemainingTime=function(){try{null!=this._pmPlayer&&(this._remainingTime=this._pmPlayer.getRemainingAdDuration())}catch(a){Logger.warn("Error in getAdRemainingTime(): "+a.message)}Logger.debug("Inside getAdRemainingTime(). Time : "+this._remainingTime);return this._remainingTime};LinearAd.prototype.getAdDuration=function(){Logger.debug("Inside getAdDuration(). Time : "+this._totalAdDuration);return this._totalAdDuration};
LinearAd.prototype.getAdExpanded=function(){Logger.debug("Inside getAdExpanded()");return this._adExpanded};LinearAd.prototype.getAdVolume=function(){var a=this._volume;null!=this._pmPlayer&&(a=this._pmPlayer.getAdVolume());Logger.debug("Inside getAdVolume(). Volume: "+a);return a};
LinearAd.prototype.setAdVolume=function(a){Logger.debug("Inside setAdVolume(): "+a);null!==a&&"undefined"!==typeof a&&0<=a&&(this._volume=a);null!=this._pmPlayer&&(Logger.debug("SetAdVolume(): _pmPlayer is available, so calling changeVolume method on it with value: "+a),this._pmPlayer.changeVolume(a))};LinearAd.prototype.pauseAd=function(){this._currentVpaidPhase=ProtocolPhase.PAUSE_AD;null!=this._pmPlayer&&this._pmPlayer.pause()};
LinearAd.prototype.resumeAd=function(){this._currentVpaidPhase=ProtocolPhase.RESUME_AD;null!=this._pmPlayer&&this._pmPlayer.resume()};LinearAd.prototype.stopAd=function(){this._currentVpaidPhase=ProtocolPhase.STOP_AD;null!=this._pmPlayer&&this._pmPlayer.stop()};LinearAd.prototype.getAdCompanions=function(){if(null!=this._pmPlayer)return StringUtils.stripNewLineChar(this._pmPlayer.getAdCompanions());Logger.warn("VPAIDMain:adCompanions() - PMPlayer object is not initialized yet.");return""};
LinearAd.prototype.resizeAd=function(a,b,c){null!=this._pmPlayer&&(this.setViewMode(c),this.setAdWidth(a),this.setAdHeight(b),this._pmPlayer.resize(a,b,c))};LinearAd.prototype.expandAd=function(){null!=this._pmPlayer&&this._pmPlayer.expand()};LinearAd.prototype.collapseAd=function(){null!=this._pmPlayer&&this._pmPlayer.collapse()};
LinearAd.prototype.executeTrackingEvent=function(a){Logger.info("Executing Tracking Event: "+a);var b;b=this._isLinearAd?this._currentAdElement.getLinearTrackingEventURI(a):this._currentAdElement.getNonLinearTrackingEventURI(a);null!=b&&EventHandler.execute(b);a=this.getAdEventTypeFromTrackingEventType(a);StringUtils.isBlank(a)||this.dispatchAdEvent(a)};
LinearAd.prototype.executeVideoClickEvents=function(){Logger.info("Executing ClickTracking event");var a=this._currentAdElement.getVideoClickEvents();EventHandler.execute(a)};
LinearAd.prototype.executeImpressionEvent=function(){try{var a=performance.now()-this._impErrorTime;Logger.info("Impression Time:"+Math.round(a)/1E3+"secs.");Logger.info("Total Component Time since player call: "+Math.round(performance.now())/1E3+"secs.");this._currentAdElement._pmExtensions&&this._currentAdElement._pmExtensions.hasOwnProperty("pmPixels")&&0<this._currentAdElement._pmExtensions.pmPixels.after.length&&JSInterfaceHandler.executeExtensions(this._currentAdElement._pmExtensions.pmPixels.after,
this);this._currentAdElement._pmExtensions&&this._currentAdElement._pmExtensions.hasOwnProperty("pmIQPixels")&&this._currentAdElement._pmExtensions.hasOwnProperty("pmIQPixelParams")&&(Logger.info("Executing IQ pixel."),JSInterfaceHandler.dropIQPixel(this._currentAdElement._pmExtensions))}catch(b){Logger.error("error in execution of Impression  : "+b)}this._isImpressionEventDispached||(this._isImpressionEventDispached=!0,Logger.info("Executing IMPRESSION event"),a=this._currentAdElement.getImpressionEventURI(),
EventHandler.execute(a),this.dispatchAdEvent(AdEvent.AD_IMPRESSION),Logger.debug("Previous Events Store: "),Logger.debug(this._previousEvents))};LinearAd.prototype.executeAdSkipEvent=function(){this.executeTrackingEvent(TrackingEventTypes.SKIP)};LinearAd.prototype.executeAdStartedEvent=function(){this.executeTrackingEvent(TrackingEventTypes.CREATIVE_VIEW)};
LinearAd.prototype.callAdEventsCb=function(a,b){a=a.toLowerCase();a=this.subscribeCallbacks[a]||[];for(var c=0;c<a.length;c++){var d=a[c];null!==d&&"undefined"!==typeof d&&(StringUtils.isBlank(b)?d.aCallback.call(d.aContext):d.aCallback.apply(d.aContext,b))}};
LinearAd.prototype.dispatchAdEvent=function(a,b){if(StringUtils.isBlank(a))Logger.error("Eventname is not defined !");else{var c=[AdEvent.AD_IMPRESSION,AdEvent.AD_STARTED,AdEvent.AD_VIDEO_START,AdEvent.AD_VIDEO_FIRST_QUARTILE,AdEvent.AD_VIDEO_MIDPOINT,AdEvent.AD_VIDEO_THIRD_QUARTILE,AdEvent.AD_VIDEO_COMPLETE];-1===this._previousEvents.indexOf(a)?(this.callAdEventsCb(a,b),this._previousEvents.push(a)):-1===c.indexOf(a)&&this.callAdEventsCb(a,b);Logger.debug("Dispatched Ad Event : "+a)}};
LinearAd.prototype.linearClickThruAd=function(){try{var a=this._currentAdElement.getLinearClickThruURI();window.open(a.url);null!=a&&this.dispatchAdEvent(AdEvent.AD_CLICK_THRU,[a.url,a.id,a.playerHandles]);this.executeVideoClickEvents()}catch(b){Logger.warn("Error in dispatching AdClickThru event : "+b.message)}};
LinearAd.prototype.nonLinearClickThruAd=function(a){try{var b=this._currentAdElement.getNonLinearClickThruURI(a),c=this._currentAdElement.getNonLinearClickTrackerURI(a);null!=b&&this.dispatchAdEvent(AdEvent.AD_CLICK_THRU,[b.url,b.id,b.playerHandles]);c&&(c instanceof Array||(c=[c]),EventHandler.execute(c));window.open(b.url)}catch(d){Logger.warn("Error in dispatching AdClickThru event : "+d.message)}};
LinearAd.prototype.makeAdServerCall=function(a){Logger.debug("Making call to AdServer...");var b;try{a?(this._adTagHandler.setAdTag(a),b=a):b=AdParamConfigReader.getAdServerCallURI(),this._adTagHandler=this._adTagHandler||new AdTagHandler(b,this.getInstance()),this._adTagHandler.execute()}catch(c){Logger.error("Internal Error While Making AdServer Call: "+c),this.dispatchAdErrorEvent(ErrorMessage.PM_ERR_UNDEFINED,!1,c.message)}};
LinearAd.prototype.initPMPlayer=function(){this._isVPAIDAd=!1;this._currentAdElement=this._adTagHandler.getCreativeHandlers()[this._currentAdIndex].getAdElement();var a=null;0<this._currentAdElement._bestVPAIDMediaFileArray.length&&(this._isVPAIDAd=!0,a=this._currentAdElement.getVpaidUrl());this._isVPAIDAd?(Logger.info("Third Party VPAID !!!"),this._pmPlayer=new PMVpaidPlayer(this._isLinearAd,this._videoSlot,this,a)):this._pmPlayer=new PMVideoPlayer(this._isLinearAd,this._videoSlot,this);this._pmPlayer.initPMPlayer(this.__initWidth,
this.__initHeight,this.__viewMode,this.__desiredBitrate,this.__creativeData,this.__environmentVars,this._currentAdElement)};LinearAd.prototype.resetPMPlayer=function(){this._pmPlayer=null};LinearAd.prototype.handleErrorPassback=function(a,b){a=a?a:ErrorMessage.PM_ERR_VPAID_LOAD;this._currentAdElement.clearAllMediaFiles();Logger.warn("Excecution reached inside handleErrorPassback()");this.dispatchAdErrorEvent(a,!1,b)};
LinearAd.prototype.dispatchAdErrorEvent=function(a,b,c,d){d=void 0===d?!1:d;Logger.debug("Inside dispatchAdErrorEvent(). Error: "+a.errorMessage);if(this._isErrorEventDispatched)Logger.debug("Dispatching another 'AdError' event. Error: "+a.errorMessage);else{this._isErrorEventDispatched=!0;try{var e=performance.now()-this._impErrorTime;Logger.info("Ad Error Time: "+Math.round(e)/1E3+"secs.");Logger.info("Total Component Time since player call: "+Math.round(performance.now())/1E3+"secs.")}catch(f){Logger.log("Inside catch block of dispatchAdErrorEvent: "+
f)}Logger.error(a.errorMessage);StringUtils.isBlank(c)||(a.actualErrorMessage=c);d||ErrorHandler.executeErrorEvents(a,this);b||(this.resetPMPlayer(),this.dispatchAdEvent(AdEvent.AD_ERROR,[JSON.stringify(a)]))}};LinearAd.prototype.dispatchAdLoadedEvent=function(){Logger.info("Done with PMPlayer initialization. Now dispatching AD_LOADED Event.");this.dispatchAdEvent(AdEvent.AD_LOADED);this._isAdLoadedEventDispached=!0};
LinearAd.prototype.resetAdDuration=function(){try{if(null!=this._pmPlayer){var a=this._pmPlayer.getTotalAdDuration();this.setAdDuration(a)}}catch(b){Logger.warn("Error in resetAdDuration(): "+b.message)}};LinearAd.prototype.setAdDuration=function(a){this._remainingTime=this._totalAdDuration=a;this.dispatchAdEvent(AdEvent.AD_DURATION_CHANGE)};
LinearAd.prototype.getAdEventTypeFromTrackingEventType=function(a){var b=null;switch(a){case TrackingEventTypes.CREATIVE_VIEW:b=AdEvent.AD_STARTED;break;case TrackingEventTypes.START:b=AdEvent.AD_VIDEO_START;break;case TrackingEventTypes.FIRST_QUARTILE:b=AdEvent.AD_VIDEO_FIRST_QUARTILE;break;case TrackingEventTypes.MIDPOINT:b=AdEvent.AD_VIDEO_MIDPOINT;break;case TrackingEventTypes.THIRD_QUARTILE:b=AdEvent.AD_VIDEO_THIRD_QUARTILE;break;case TrackingEventTypes.COMPLETE:b=AdEvent.AD_VIDEO_COMPLETE;break;
case TrackingEventTypes.PAUSE:b=AdEvent.AD_PAUSED;break;case TrackingEventTypes.RESUME:b=AdEvent.AD_PLAYING;break;case TrackingEventTypes.SKIP:b=AdEvent.AD_SKIPPED;break;case TrackingEventTypes.CLOSE:b=AdEvent.AD_USER_CLOSE}return b};LinearAd.prototype.setIsLinearAd=function(a){this._isLinearAd=a};LinearAd.prototype.getInstance=function(){return this._myInstance};LinearAd.prototype.getVPAID=function(){return this};LinearAd.prototype.getCurrentVpaidPhase=function(){return this._currentVpaidPhase};
LinearAd.prototype.setVPAIDAd=function(a){this._isVPAIDAd=a};LinearAd.prototype.getVPAIDAd=function(){return this._isVPAIDAd};LinearAd.prototype.getInitWidth=function(){return this.__initWidth};LinearAd.prototype.getInitHeight=function(){return this.__initHeight};LinearAd.prototype.getAdTagHandler=function(){return this._adTagHandler};LinearAd.prototype.getCurrentAdIndex=function(){return this._currentAdIndex};LinearAd.prototype.getCurrentAdElement=function(){return this._currentAdElement};
LinearAd.prototype.getViewMode=function(){return this.__viewMode};LinearAd.prototype.setAdWidth=function(a){this.adWidth=a};LinearAd.prototype.setAdHeight=function(a){this.adHeight=a};LinearAd.prototype.setViewMode=function(a){this.__viewMode=a};LinearAd.prototype.setAdExpanded=function(a){this._adExpanded=a};LinearAd.prototype.getAdSkippableState=function(){Logger.info("getAdSkippableState")};LinearAd.prototype.skipAd=function(){Logger.info("skipAd")};LinearAd.prototype.subscribeCallbacks={};
LinearAd.prototype.subscribe=function(a,b,c){StringUtils.isBlank(b)||(b=b.toLowerCase(),this.subscribeCallbacks.hasOwnProperty(b)?this.subscribeCallbacks[b].push({aCallback:a,aContext:c}):this.subscribeCallbacks[b]=[{aCallback:a,aContext:c}])};LinearAd.prototype.unsubscribe=function(a,b){StringUtils.isBlank(b)||(b=b.toLowerCase(),b===AdEvent.AD_STOPPED.toLowerCase()?this._currentVpaidPhase===ProtocolPhase.STOP_AD&&delete this.subscribeCallbacks[b]:delete this.subscribeCallbacks[b])};
LinearAd.prototype.getPlayer=function(){return this._videoSlot};LinearAd.prototype.getSlot=function(){return this._slot};LinearAd.prototype.getPreviousEvents=function(){return this._previousEvents};
function xmlToJson(a){function b(a){var b=a.localName;null==b&&(b=a.baseName);if(null==b||""==b)b=a.nodeName;return b}function c(a){return"string"==typeof a?a.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#x27;").replace(/\//g,"\x26#x2F;"):a}function d(b,c,d){switch(a.arrayAccessForm){case "property":b[c+"_asArray"]=b[c]instanceof Array?b[c]:[b[c]]}if(!(b[c]instanceof Array)&&0<a.arrayAccessFormPaths.length){for(var e=0;e<a.arrayAccessFormPaths.length;e++){var g=
a.arrayAccessFormPaths[e];if("string"===typeof g){if(g==d)break}else if(g instanceof RegExp){if(g.test(d))break}else if("function"===typeof g&&g(b,c,d))break}e!=a.arrayAccessFormPaths.length&&(b[c]=[b[c]])}}function e(a){var b=a.split(/[-T:+Z]/g),c=new Date(b[0],b[1]-1,b[2]),d=b[5].split(".");c.setHours(b[3],b[4],d[0]);1<d.length&&c.setMilliseconds(d[1]);b[6]&&b[7]?(b=60*b[6]+Number(b[7]),b=0+("-"==(/\d\d-\d\d:\d\d$/.test(a)?"-":"+")?-1*b:b),c.setMinutes(c.getMinutes()-b-c.getTimezoneOffset())):-1!==
a.indexOf("Z",a.length-1)&&(c=new Date(Date.UTC(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds())));return c}function f(b,c,d){if(0<a.datetimeAccessFormPaths.length){d=d.split(".#")[0];for(var m=0;m<a.datetimeAccessFormPaths.length;m++){var g=a.datetimeAccessFormPaths[m];if("string"===typeof g){if(g==d)break}else if(g instanceof RegExp){if(g.test(d))break}else if("function"===typeof g&&g(obj,c,d))break}return m!=a.datetimeAccessFormPaths.length?
e(b):b}return b}function k(c,e){var g,m,r,h,n;if(c.nodeType==t.DOCUMENT_NODE){g={};m=c.childNodes;for(r=0;r<m.length;r++)h=m.item(r),h.nodeType==t.ELEMENT_NODE&&(n=b(h),g[n]=k(h,n));return g}if(c.nodeType==t.ELEMENT_NODE){g={};if(b(c)===Constants.ADPARAMETERS_NODE)return e=c.getAttribute("xmlEncoded"),c=c.textContent||c.wholeText||"",e&&(c=l(c)),c;g.__cnt=0;m=c.childNodes;for(r=0;r<m.length;r++)h=m.item(r),n=b(h),h.nodeType!=t.COMMENT_NODE&&(g.__cnt++,null==g[n]?(g[n]=k(h,e+"."+n),d(g,n,e+"."+n)):
(null==g[n]||g[n]instanceof Array||(g[n]=[g[n]],d(g,n,e+"."+n)),g[n][g[n].length]=k(h,e+"."+n)));for(m=0;m<c.attributes.length;m++)r=c.attributes.item(m),g.__cnt++,g[a.attributePrefix+r.name]=r.value;c=c.prefix;null!=c&&""!=c&&(g.__cnt++,g.__prefix=c);null!=g["#text"]&&(g.__text=g["#text"],g.__text instanceof Array&&(g.__text=g.__text.join("\n")),a.escapeMode&&(g.__text=g.__text.replace(/&amp;/g,"\x26").replace(/&lt;/g,"\x3c").replace(/&gt;/g,"\x3e").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,
"/")),a.stripWhitespaces&&(g.__text=g.__text.trim()),delete g["#text"],"property"==a.arrayAccessForm&&delete g["#text_asArray"],g.__text=f(g.__text,n,e+"."+n));null!=g["#cdata-section"]&&(g.__cdata=g["#cdata-section"],delete g["#cdata-section"],"property"==a.arrayAccessForm&&delete g["#cdata-section_asArray"]);1==g.__cnt&&null!=g.__text?g=g.__text:0==g.__cnt&&"text"==a.emptyNodeForm?g="":1<g.__cnt&&null!=g.__text&&a.skipEmptyTextNodesForObj&&(a.stripWhitespaces&&""==g.__text||""==g.__text.trim())&&
delete g.__text;delete g.__cnt;!a.enableToStringFunc||null==g.__text&&null==g.__cdata||(g.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")});return g}if(c.nodeType==t.TEXT_NODE||c.nodeType==t.CDATA_SECTION_NODE)return c.nodeValue}function l(a){var b={"\x26amp;":"\x26","\x26quot;":'"',"\x26lt;":"\x3c","\x26gt;":"\x3e","\x26apos;":"'"};return a.replace(/(&quot;|&lt;|&gt;|&amp;|&apos;)/g,function(a,c){return b[c]})}function h(b,d,e,f){d="\x3c"+(null!=
b&&null!=b.__prefix?b.__prefix+":":"")+d;if(null!=e)for(var g=0;g<e.length;g++){var m=e[g],h=b[m];a.escapeMode&&(h=c(h));d+=" "+m.substr(a.attributePrefix.length)+"\x3d'"+h+"'"}return f?d+"/\x3e":d+"\x3e"}function p(a,b){return"\x3c/"+(null!=a.__prefix?a.__prefix+":":"")+b+"\x3e"}function q(b,c){var d;if(d="property"==a.arrayAccessForm)d=c.toString(),d=-1!==d.indexOf("_asArray",d.length-8);return d||0==c.toString().indexOf(a.attributePrefix)||0==c.toString().indexOf("__")||b[c]instanceof Function?
!0:!1}function v(a){var b=0;if(a instanceof Object)for(var c in a)q(a,c)||b++;return b}function w(b){var c=[];if(b instanceof Object)for(var d in b)-1==d.toString().indexOf("__")&&0==d.toString().indexOf(a.attributePrefix)&&c.push(d);return c}function x(b){var d="";if(b instanceof Object){var e="";null!=b.__cdata&&(e+="\x3c![CDATA["+b.__cdata+"]]\x3e");null!=b.__text&&(e=a.escapeMode?e+c(b.__text):e+b.__text);d+=e}else null!=b&&(d=a.escapeMode?d+c(b):d+b);return d}function u(a){var b="";if(0<v(a))for(var c in a)if(!q(a,
c)){var d=a[c],e=w(d);if(null==d||void 0==d)b+=h(d,c,e,!0);else if(d instanceof Object)if(d instanceof Array){var f=c,m="";if(0==d.length)m+=h(d,f,e,!0);else for(e=0;e<d.length;e++)m+=h(d[e],f,w(d[e]),!1),m+=u(d[e]),m+=p(d[e],f);b+=m}else d instanceof Date?(b+=h(d,c,e,!1),b+=d.toISOString(),b+=p(d,c)):0<v(d)||null!=d.__text||null!=d.__cdata?(b+=h(d,c,e,!1),b+=u(d),b+=p(d,c)):b+=h(d,c,e,!0);else b+=h(d,c,e,!1),b+=x(d),b+=p(d,c)}return b+=x(a)}a=a||{};void 0===a.escapeMode&&(a.escapeMode=!0);a.attributePrefix=
a.attributePrefix||"_";a.arrayAccessForm=a.arrayAccessForm||"none";a.emptyNodeForm=a.emptyNodeForm||"text";void 0===a.enableToStringFunc&&(a.enableToStringFunc=!0);a.arrayAccessFormPaths=a.arrayAccessFormPaths||[];void 0===a.skipEmptyTextNodesForObj&&(a.skipEmptyTextNodesForObj=!0);void 0===a.stripWhitespaces&&(a.stripWhitespaces=!0);a.datetimeAccessFormPaths=a.datetimeAccessFormPaths||[];(function(){function a(a){a=String(a);1===a.length&&(a="0"+a);return a}"function"!==typeof String.prototype.trim&&
(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")});"function"!==typeof Date.prototype.toISOString&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1E3).toFixed(3)).slice(2,5)+"Z"})})();var t={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=
function(a){var b=window.ActiveXObject||"ActiveXObject"in window;if(void 0===a)return null;if(window.DOMParser){var c=new window.DOMParser,d=null;b||(d=c.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI);a=a&&a.trim()||a;b=c.parseFromString(a,"text/xml");if(null!=d&&0<b.getElementsByTagNameNS(d,"parsererror").length)throw Error("Error parsing XML: "+a);}else 0==a.indexOf("\x3c?")&&(a=a.substr(a.indexOf("?\x3e")+2)),b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a);
return b};this.asArray=function(a){return a instanceof Array?a:[a]};this.toXmlDateTime=function(a){return a instanceof Date?a.toISOString():"number"===typeof a?(new Date(a)).toISOString():null};this.asDateTime=function(a){return"string"==typeof a?e(a):a};this.xml2json=function(a){return k(a)};this.xml_str2json=function(a){a=this.parseXmlString(a);return null!=a?this.xml2json(a):null};this.json2xml_str=function(a){return u(a)};this.json2xml=function(a){a=this.json2xml_str(a);return this.parseXmlString(a)};
this.getVersion=function(){return"1.1.5"}}var Timer=function(a,b,c,d){this.id=Math.floor(Date.now()/1E3);this.delay=a;this.running=!1;this.repeat_count=b;this._timer=null;this.onCompleteFunc=c;this.function_args=d||null};
Timer.prototype.start=function(){this.running&&(Logger.warn("Timer is already running. Re-starting the timer..."),clearTimeout(this._timer),this._timer=null,this.running=!1);Logger.debug("Timer started id- "+this.id);this._timer=setTimeout(this.onCompleteFunc,this.delay,this.function_args);this.running=!0};Timer.prototype.stop=function(){this.running?(Logger.debug("Timer stoped id- "+this.id),this.running=!1,clearTimeout(this._timer),this._timer=null):Logger.info("Timer is already stopped.")};
function PMVpaidPlayer(a,b,c,d){this._initHeight=this._initWidth=0;this._viewMode="Normal";this._desiredBitrate=0;this._creativeData={AdParameters:""};this._environmentVars={};this._isLoaderRunnig=!1;this._tpVPAIDAdUrl=d;this._tpVPAIDAddom=this._tpVPAIDAd=null;this._tpVPAIDVersion;this._adStartRequested=!1;this._pmVPAID=c;this._testPlayerData=this._protocolTimer=null;this._isLinearAd=a}
PMVpaidPlayer.prototype.initPMPlayer=function(a,b,c,d,e,f,k){Logger.info("Initializing PM VPAID player ...");this._initHeight=b;this._initWidth=a;this._viewMode=c;this._desiredBitrate=d;this._creativeData.AdParameters=k.getAdParameters()||"";!AdParamConfigReader.isHTTPS||StringUtils.isBlank(this._creativeData.AdParameters)||-1==this._creativeData.AdParameters.indexOf("http:")&&-1==this._creativeData.AdParameters.indexOf("https%3A")||(this._creativeData.AdParameters=StringUtils.getSecuredURL(this._creativeData.AdParameters));
this._environmentVars=f||{};this._adElement=k;this._protocolTimer=new Timer(AdParamConfigReader.VPAID_PROTOCOL_TIMEOUT,1,this.onProtocolTimeOut,this);this._pmVPAID._currentVpaidPhase=ProtocolPhase.LOAD_VPAID_AD;this.loadVPAID()};
PMVpaidPlayer.prototype.loadVPAID=function(){Logger.debug("loadVPAID(): Loading 3rd party VPAID media: "+this._tpVPAIDAdUrl);try{this.onVPAIDLoadCompleteHandler(),this._isLoaderRunnig=!0}catch(a){Logger.warn("Error : load TPV - "+a),this.handleVpaidError(ErrorMessage.PM_ERR_VPAID_LOAD,a.message)}};
PMVpaidPlayer.prototype.start=function(){Logger.info("Inside PMVpaidPlayer:start()");this._adStartRequested||(this._adStartRequested=!0,this.checkVpaidProperty("startAd")&&(Logger.info("PMVpaidPlayer:start() - Calling TPV VPAID startAd()..."),this._protocolTimer.start(),this._tpVPAIDAd.startAd()))};PMVpaidPlayer.prototype.pause=function(){Logger.info("Inside PMVpaidPlayer:pause()");this.checkVpaidProperty("pauseAd")&&this._tpVPAIDAd.pauseAd()};
PMVpaidPlayer.prototype.resume=function(){Logger.info("Inside PMVpaidPlayer:resume()");this.checkVpaidProperty("resumeAd")&&this._tpVPAIDAd.resumeAd()};PMVpaidPlayer.prototype.stop=function(){Logger.info("Inside PMVpaidPlayer:stop()");this.checkVpaidProperty("stopAd")&&(this._protocolTimer.start(),this._tpVPAIDAd.stopAd())};PMVpaidPlayer.prototype.changeVolume=function(a){Logger.info("Inside PMVpaidPlayer:changeVolume(): "+a);this.checkVpaidProperty("setAdVolume")&&(this._pmVPAID._volume=a,this._tpVPAIDAd.setAdVolume(a))};
PMVpaidPlayer.prototype.getAdVolume=function(){Logger.info("Inside PMVpaidPlayer:getAdVolume()");if(this.checkVpaidProperty("getAdVolume"))return this._tpVPAIDAd.getAdVolume()};PMVpaidPlayer.prototype.getAdCompanions=function(){Logger.info("Inside PMVpaidPlayer:getAdCompanions()");var a="";null!=this._tpVPAIDAd&&this._tpVPAIDAd.hasOwnProperty("adCompanions")?a=this._tpVPAIDAd.adCompanions:this.checkVpaidProperty("getAdCompanions")&&(a=this._tpVPAIDAd.getAdCompanions());return a};
PMVpaidPlayer.prototype.initVpaidAd=function(){Logger.info("Inside PMVpaidPlayer:initVpaidAd()");try{if(this.checkVpaidProperty("subscribe")||this.checkVpaidProperty("unsubscribe"))this.addTPEventListeners(),this.checkVpaidProperty("handshakeVersion")&&(Logger.info("Calling TPV handshakeVersion()."),this._tpVPAIDAd.handshakeVersion(Constants.PM_VPAID_VERSION),this._pmVPAID._currentVpaidPhase=ProtocolPhase.INIT_AD,this.checkVpaidProperty("initAd")&&(Logger.info("Calling TPV initAd()."),this._protocolTimer.start(),
Logger.debug("Auotplay check: To TPV environmentVars.videoSlotCanAutoPlay: "+this._environmentVars.videoSlotCanAutoPlay),this._tpVPAIDAd.initAd(this._initWidth,this._initHeight,this._viewMode,this._desiredBitrate,this._creativeData,this._environmentVars),Logger.debug("PMVpaidPlayer:initVpaidAd() - TPV initAd() Finished ")))}catch(a){Logger.info("Exception in initializing TPV"),this.handleVpaidError(ErrorMessage.PM_ERR_VPAID_INIT_FAILD,a.message)}};
PMVpaidPlayer.prototype.onVPAIDLoadCompleteHandler=function(){Logger.debug("Inside PMVpaidPlayer:onVPAIDLoadCompleteHandler()");this.removeLoaderListeners();this._tpVPAIDAddom=this.addChild(this._tpVPAIDAdUrl,this.onTPJSLoaded)};PMVpaidPlayer.prototype.onTPJSLoaded=function(a){this._protocolTimer.stop();Logger.info("TPV loaded successfully.");this._testPlayerData.setSuccess(!0);Logger.sendAdditionalDataToTestPlayer(this._testPlayerData);this._tpVPAIDAd=a;this.initVpaidAd()};
PMVpaidPlayer.prototype.onVAPIDLoadErrorHandler=function(a){this._protocolTimer.stop();this.removeLoaderListeners();Logger.warn("Error while loading TPV. "+a);a.preventDefault();a.stopImmediatePropagation();this.handleVpaidError(ErrorMessage.PM_ERR_VPAID_LOAD,a)};
PMVpaidPlayer.prototype.tpAdClickThruHandler=function(a,b,c){try{this._isLinearAd&&this._pmVPAID.executeVideoClickEvents(),b="",c&&(b=StringUtils.isBlank(a)?(this._pmVPAID._currentAdElement.getLinearClickThruURI()||{}).url||"":a||""),b=b.toString(),StringUtils.isBlank(b)||window.open(b),this._pmVPAID.dispatchAdEvent(AdEvent.AD_CLICK_THRU)}catch(d){Logger.warn("Inside PMVpaidPlayer - Error in executing click tracking: "+d.message)}};
PMVpaidPlayer.prototype.tpAdDurationChangeHandler=function(){Logger.info("Inside PMVpaidPlayer - TPV dispatched AdDurationChange event");this._pmVPAID.resetAdDuration();this._pmVPAID.dispatchAdEvent(AdEvent.AD_DURATION_CHANGE)};PMVpaidPlayer.prototype.tpAdErrorHandler=function(a){Logger.info("Inside PMVpaidPlayer - TPV dispatched AdError event: "+a);this._protocolTimer.stop();this.handleVpaidError(ErrorMessage.PM_ERR_VPAID_AD_ERROR_DISPATCHED,a)};
PMVpaidPlayer.prototype.tpAdExpandedChangeHandler=function(){Logger.info("Inside PMVpaidPlayer - TPV dispatched Ad_expanded_change event");this._pmVPAID.dispatchAdEvent(AdEvent.AD_EXPANDED_CHANGE)};
PMVpaidPlayer.prototype.tpAdImpressionHandler=function(){this._protocolTimer.stop();Logger.info("Inside PMVpaidPlayer - TPV dispatched Ad_Impression event");this._pmVPAID._isImpressionEventDispached?Logger.error("AdImpression event is repeated."):(this._pmVPAID.executeAdStartedEvent(),this._pmVPAID.executeImpressionEvent(),this._pmVPAID.executeTrackingEvent(TrackingEventTypes.START));this._tpVPAIDAddom.removeEventListener(AdEvent.AD_IMPRESSION,this.tpAdImpressionHandler)};
PMVpaidPlayer.prototype.tpAdLoadedHandler=function(){this._protocolTimer.stop();Logger.info("Inside PMVpaidPlayer - TPV dispatched Ad_Loaded event");this._pmVPAID.dispatchAdLoadedEvent();this.changeVolume(this._pmVPAID._volume);this._tpVPAIDAddom.removeEventListener(AdEvent.AD_LOADED,this.tpAdLoadedHandler)};PMVpaidPlayer.prototype.tpAdLogHandler=function(a){Logger.info(a)};
PMVpaidPlayer.prototype.tpAdPausedHandler=function(){this._protocolTimer.stop();Logger.info("Inside PMVpaidPlayer - TPV dispatched Ad_Paused event");this._pmVPAID.executeTrackingEvent(TrackingEventTypes.PAUSE)};PMVpaidPlayer.prototype.tpAdPlayingHandler=function(){this._protocolTimer.stop();Logger.info("Inside PMVpaidPlayer - TPV dispatched Ad_Playing event");this._pmVPAID.executeTrackingEvent(TrackingEventTypes.RESUME)};PMVpaidPlayer.prototype.tpAdRemainingTimeChangeHandler=function(){};
PMVpaidPlayer.prototype.tpAdSizeChangeHandler=function(){Logger.info("Inside PMVpaidPlayer - TPV dispatched Ad_size_change event");if(this.checkVpaidProperty("getAdWidth")){var a=this._tpVPAIDAd.getAdWidth();this._pmVPAID.setAdWidth(a)}this.checkVpaidProperty("getAdHeight")&&(a=this._tpVPAIDAd.getAdHeight(),this._pmVPAID.setAdHeight(a));this._pmVPAID.dispatchAdEvent(AdEvent.AD_SIZE_CHANGE)};PMVpaidPlayer.prototype.tpAdSkippableStateChangeHandler=function(){this._pmVPAID.dispatchAdEvent(AdEvent.AD_SKIPPABLE_STATE_CHANGED)};
PMVpaidPlayer.prototype.tpAdSkippedHandler=function(){this._protocolTimer.stop();this._pmVPAID.executeTrackingEvent(TrackingEventTypes.SKIP);this._tpVPAIDAddom.removeEventListener(AdEvent.AD_SKIPPED,this.tpAdSkippedHandler)};PMVpaidPlayer.prototype.tpAdStartedHandler=function(){this._protocolTimer.stop();Logger.info("Inside PMVpaidPlayer - TPV dispatched Ad_Started event");this._pmVPAID.dispatchAdEvent(AdEvent.AD_STARTED);this._tpVPAIDAddom.removeEventListener(AdEvent.AD_STARTED,this.tpAdStartedHandler)};
PMVpaidPlayer.prototype.tpAdStoppedHandler=function(){this._protocolTimer.stop();Logger.info("Inside PMVpaidPlayer - TPV dispatched AD_STOPPED event");this.resetPMPlayer();this._pmVPAID._isImpressionEventDispached?this._pmVPAID.dispatchAdEvent(AdEvent.AD_STOPPED):this.handleVpaidError(ErrorMessage.PM_ERR_VPAID_AD_ERROR_DISPATCHED,"DSP stopped ad before ad impression.")};PMVpaidPlayer.prototype.tpAdUserAcceptInvitationHandler=function(){this._pmVPAID.dispatchAdEvent(AdEvent.AD_USER_ACCEPT_INVITATION)};
PMVpaidPlayer.prototype.tpAdUserCloseHandler=function(){this._pmVPAID.dispatchAdEvent(AdEvent.AD_USER_CLOSE)};PMVpaidPlayer.prototype.tpAdUserMinimizeHandler=function(){this._pmVPAID.dispatchAdEvent(AdEvent.AD_USER_MINIMIZE)};PMVpaidPlayer.prototype.tpAdVideoCompleteHandler=function(){Logger.info("Inside PMVpaidPlayer - TPV dispatched AD_VIDEO_COMPLETE event");this._pmVPAID.executeTrackingEvent(TrackingEventTypes.COMPLETE);this._tpVPAIDAddom.removeEventListener(AdEvent.AD_VIDEO_COMPLETE,this.tpAdVideoCompleteHandler)};
PMVpaidPlayer.prototype.tpAdVideoFirstQuartileHandler=function(){Logger.info("Inside PMVpaidPlayer - TPV dispatched AD_VIDEO_FIRST_QUARTILE event");this._pmVPAID.executeTrackingEvent(TrackingEventTypes.FIRST_QUARTILE);this._tpVPAIDAddom.removeEventListener(AdEvent.AD_VIDEO_FIRST_QUARTILE,this.tpAdVideoFirstQuartileHandler)};
PMVpaidPlayer.prototype.tpAdVideoMidpointHandler=function(){Logger.info("Inside PMVpaidPlayer - TPV dispatched AD_VIDEO_MIDPOINT event");this._pmVPAID.executeTrackingEvent(TrackingEventTypes.MIDPOINT);this._tpVPAIDAddom.removeEventListener(AdEvent.AD_VIDEO_MIDPOINT,this.tpAdVideoMidpointHandler)};
PMVpaidPlayer.prototype.tpAdVideoStartHandler=function(){Logger.info("Inside PMVpaidPlayer - TPV dispatched AD_VIDEO_START event");this._pmVPAID.executeTrackingEvent(TrackingEventTypes.START);this._tpVPAIDAddom.removeEventListener(AdEvent.AD_VIDEO_START,this.tpAdVideoStartHandler)};
PMVpaidPlayer.prototype.tpAdVideoThirdQuartileHandler=function(){Logger.info("Inside PMVpaidPlayer - TPV dispatched THIRD_QUARTILE event");this._pmVPAID.executeTrackingEvent(TrackingEventTypes.THIRD_QUARTILE);this._tpVPAIDAddom.removeEventListener(AdEvent.AD_VIDEO_THIRD_QUARTILE,this.tpAdVideoThirdQuartileHandler)};
PMVpaidPlayer.prototype.tpAdVolumeChangeHandler=function(){Logger.debug("Inside TPV Volume Change Handler.");this._pmVPAID.dispatchAdEvent(AdEvent.AD_VOLUME_CHANGE);if(this.checkVpaidProperty("getAdVolume")){var a=this._tpVPAIDAd.getAdVolume();a&&a!==this._pmVPAID.getAdVolume()&&Logger.debug("TPV did not set volume as expected!")}};PMVpaidPlayer.prototype.tpAdLinearChangeHandler=function(a){Logger.debug("Inside TP Linear Change Handler: "+a);this._pmVPAID.dispatchAdEvent(AdEvent.AD_LINEAR_CHANGE)};
PMVpaidPlayer.prototype.tpAdInteractionHandler=function(a){Logger.debug("Inside TP Ad Interaction Handler: "+a);this._pmVPAID.dispatchAdEvent(AdEvent.AD_INTERACTION)};PMVpaidPlayer.prototype.getTotalAdDuration=function(){var a=0;null!=this._tpVPAIDAd&&this._tpVPAIDAd.hasOwnProperty("adDuration")?a=this._tpVPAIDAd.adDuration:this.checkVpaidProperty("getAdDuration")&&(a=this._tpVPAIDAd.getAdDuration());return a};
PMVpaidPlayer.prototype.getRemainingAdDuration=function(){var a=0;null!=this._tpVPAIDAd&&this._tpVPAIDAd.hasOwnProperty("adRemainingTime")?a=this._tpVPAIDAd.adRemainingTime:this.checkVpaidProperty("getAdRemainingTime")&&(a=this._tpVPAIDAd.getAdRemainingTime());return a};
PMVpaidPlayer.prototype.addTPEventListeners=function(){var a={AdStarted:this.tpAdStartedHandler,AdStopped:this.tpAdStoppedHandler,AdSkipped:this.tpAdSkippedHandler,AdLoaded:this.tpAdLoadedHandler,AdLinearChange:this.tpAdLinearChangeHandler,AdSizeChange:this.tpAdSizeChangeHandler,AdExpandedChange:this.tpAdExpandedChangeHandler,AdSkippableStateChange:this.tpAdSkippableStateChangeHandler,AdDurationChange:this.tpAdDurationChangeHandler,AdRemainingTimeChange:this.tpAdRemainingTimeChangeHandler,AdVolumeChange:this.tpAdVolumeChangeHandler,
AdImpression:this.tpAdImpressionHandler,AdClickThru:this.tpAdClickThruHandler,AdInteraction:this.tpAdInteractionHandler,AdVideoStart:this.tpAdVideoStartHandler,AdVideoFirstQuartile:this.tpAdVideoFirstQuartileHandler,AdVideoMidpoint:this.tpAdVideoMidpointHandler,AdVideoThirdQuartile:this.tpAdVideoThirdQuartileHandler,AdVideoComplete:this.tpAdVideoCompleteHandler,AdUserAcceptInvitation:this.tpAdUserAcceptInvitationHandler,AdUserMinimize:this.tpAdUserMinimizeHandler,AdUserClose:this.tpAdUserCloseHandler,
AdPaused:this.tpAdPausedHandler,AdPlaying:this.tpAdPlayingHandler,AdError:this.tpAdErrorHandler,AdLog:this.tpAdLogHandler};try{for(var b in a)this._tpVPAIDAd.subscribe(a[b],b,this)}catch(c){Logger.error("TPV Add Event Listerners: "+c)}};
PMVpaidPlayer.prototype.removeTPEventListeners=function(){var a={AdStarted:this.tpAdStartedHandler,AdStopped:this.tpAdStoppedHandler,AdSkipped:this.tpAdSkippedHandler,AdLoaded:this.tpAdLoadedHandler,AdLinearChange:this.tpAdLinearChangeHandler,AdSizeChange:this.tpAdSizeChangeHandler,AdExpandedChange:this.tpAdExpandedChangeHandler,AdSkippableStateChange:this.tpAdSkippableStateChangeHandler,AdDurationChange:this.tpAdDurationChangeHandler,AdRemainingTimeChange:this.tpAdRemainingTimeChangeHandler,AdVolumeChange:this.tpAdVolumeChangeHandler,
AdImpression:this.tpAdImpressionHandler,AdClickThru:this.tpAdClickThruHandler,AdInteraction:this.tpAdInteractionHandler,AdVideoStart:this.tpAdVideoStartHandler,AdVideoFirstQuartile:this.tpAdVideoFirstQuartileHandler,AdVideoMidpoint:this.tpAdVideoMidpointHandler,AdVideoThirdQuartile:this.tpAdVideoThirdQuartileHandler,AdVideoComplete:this.tpAdVideoCompleteHandler,AdUserAcceptInvitation:this.tpAdUserAcceptInvitationHandler,AdUserMinimize:this.tpAdUserMinimizeHandler,AdUserClose:this.tpAdUserCloseHandler,
AdPaused:this.tpAdPausedHandler,AdPlaying:this.tpAdPlayingHandler,AdError:this.tpAdErrorHandler,AdLog:this.tpAdLogHandler},b;for(b in a)try{this._tpVPAIDAd.unsubscribe(a[b],b)}catch(c){Logger.error("Subscribe TPV callbacks error: "+c)}};PMVpaidPlayer.prototype.resize=function(a,b,c){Logger.info("Inside PMVpaidPlayer:resize()");this._tpVPAIDAd.resizeAd(a,b,c)};PMVpaidPlayer.prototype.expand=function(){Logger.info("Inside PMVpaidPlayer:expand()");this.checkVpaidProperty("expandAd")&&this._tpVPAIDAd.expandAd()};
PMVpaidPlayer.prototype.collapse=function(){Logger.info("Inside PMVpaidPlayer:collapse()");this.checkVpaidProperty("collapseAd")&&this._tpVPAIDAd.collapseAd()};PMVpaidPlayer.prototype.removeLoaderListeners=function(){this._isLoaderRunnig=!1};
PMVpaidPlayer.prototype.onProtocolTimeOut=function(a){try{a._protocolTimer.stop();a._testPlayerData.setSuccess(!1);Logger.sendAdditionalDataToTestPlayer(a._testPlayerData);a._isLoaderRunnig&&(Logger.info("TPV VPAID Load timed out !!!"),a.removeLoaderListeners());Logger.info("Protocol time out @"+a._pmVPAID._currentVpaidPhase);var b=ErrorMessage.PM_ERR_VPAID_OTHER_TIMEDOUT;switch(a._pmVPAID._currentVpaidPhase){case ProtocolPhase.LOAD_VPAID_AD:b=ErrorMessage.PM_ERR_VPAID_LOAD_AD_TIMEDOUT;break;case ProtocolPhase.INIT_AD:b=
ErrorMessage.PM_ERR_VPAID_INIT_TIMEDOUT;break;case ProtocolPhase.START_AD:b=ErrorMessage.PM_ERR_VPAID_START_TIMEDOUT;break;case ProtocolPhase.STOP_AD:b=ErrorMessage.PM_ERR_VPAID_STOP_TIMEDOUT}a.handleVpaidError(b)}catch(c){Logger.warn("Error: Timeout of VPAID creative: "+c),a.handleVpaidError(ErrorMessage.PM_ERR_VPAID_OTHER_TIMEDOUT,c.message)}};
PMVpaidPlayer.prototype.handleVpaidError=function(a,b){Logger.debug(this._pmVPAID._adElement._bestVPAIDMediaFileArray);this.resetPMPlayer();this._pmVPAID._isVPAIDAd=!1;!this._pmVPAID._isImpressionEventDispached&&this._pmVPAID._adElement.hasMediaFile()?(1>this._pmVPAID._errorCollection.length&&this._pmVPAID._errorCollection.push(a),this._pmVPAID.initPMPlayer()):this._pmVPAID.handleErrorPassback(a,b)};
PMVpaidPlayer.prototype.resetPMPlayer=function(){this._protocolTimer.stop();try{null!==this._tpVPAIDAd&&(this.removeTPEventListeners(),this._tpVPAIDAd=null),null!==this._tpVPAIDAddom&&(this._tpVPAIDAddom.remove(),this._tpVPAIDAddom=null)}catch(a){Logger.warn("Error removing TPV from DOM element: "+a.message),this._tpVPAIDAddom=this._tpVPAIDAd=null}Logger.info("Done with TPV VPAID cleaned up")};
PMVpaidPlayer.prototype.checkVpaidProperty=function(a){if(null!==this._tpVPAIDAd){if("function"===typeof this._tpVPAIDAd[a])return!0;Logger.info("Property: "+a+" is missing in TPV");this.handleVpaidError(ErrorMessage.PM_ERR_VPAID_REQRD_PRPTY_MISSING,a)}return!1};
PMVpaidPlayer.prototype.addChild=function(a,b){var c=this;!AdParamConfigReader.isHTTPS||StringUtils.isBlank(a)||-1==a.indexOf("http:")&&-1==a.indexOf("http%3A")||(a=StringUtils.getSecuredURL(a));c._testPlayerData=new TestPlayerData(3,a);var d=document.createElement("iframe");d.id="adloaderframe-"+(999*Math.random()+1);d.allow="autoplay; fullscreen";d.style.cssText="border: 0px none transparent; opacity: 1; margin: 0px;";d.onload=function(){var e=d.contentWindow.document.createElement("script");e.src=
a;c._protocolTimer.start();e.onload=function(){c._protocolTimer.stop();c._tpVPAIDAddom=e;var a=d.contentWindow.getVPAIDAd;a&&"function"==typeof a&&(a=d.contentWindow.getVPAIDAd(),c._tpVPAIDAd=a,b.call(c,a))};e.onerror=function(){c._protocolTimer.stop();c._testPlayerData.setSuccess(!1);Logger.sendAdditionalDataToTestPlayer(c._testPlayerData);c._pmVPAID._currentAdElement.hasMediaFile()?(1>c._pmVPAID._errorCollection.length&&c._pmVPAID._errorCollection.push(ErrorMessage.PM_ERR_VPAID_LOAD),c._pmVPAID.initPMPlayer()):
c._pmVPAID.dispatchAdErrorEvent(ErrorMessage.PM_ERR_VPAID_LOAD)};d.contentWindow.document.body.appendChild(e)};document.body.appendChild(d);return d};function getVPAIDAd(){return new LinearAd};