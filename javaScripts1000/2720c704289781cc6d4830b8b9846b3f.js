define(["modules/id.core"],function(e){"use strict";e.utils.log("loading id.col-width-watcher.js");var t,o,n,i,s,r,a,d=[[0,"id-col-xsmall"],[220,"id-col-small"],[270,"id-col-medium"],[400,"id-col-large"],[675,"id-col-xlarge"]],l=[[0,"id-col-gt0"],[150,"id-col-gt150"],[250,"id-col-gt250"],[350,"id-col-gt350"],[450,"id-col-gt450"],[550,"id-col-gt550"],[745,"id-col-gt750"]],c="id-AdminDebug-widthMarker",u=".id-AdminDebug-widthMarker",f="id-col-gt",m=[];return e.event.subscribe(e.event.constants.COLWIDTHWATCHER_ADD_ELEMENT,function(t,n){if(m.push({el:t,$el:e.dom.$(t),conf:n||{}}),n.useOldColWidths&&n.useOldColWidths!==!1){var i=e.dom.$(t),r=o(i);i.addClass(r),e.configuration.isDebugMode&&a(i,r)}else s(m[m.length-1])},this),e.event.subscribe(e.event.constants.COLWIDTHWATCHER_REMOVE_ELEMENT,function(t,i){var s,r,a=e.dom.$(t),c=i.useOldColWidths?d:l;for(a.removeClass(o(a,c)+" "+n(a).join(" ")),s=0,r=m.length;r>s;s+=1)m[s].el===t&&m.splice(s,1);e.configuration.isDebugMode&&e.dom.$(u,a).remove()},this),o=function(t){var o,n;for(o=0,n=d.length;n>o&&!(e.dom.innerWidth(t)<d[o][0]);o+=1);return 0===o?d[o][1]:d[o-1][1]},n=function(t){var o,n,i=[];for(o=0,n=l.length;n>o&&!(e.dom.innerWidth(t)<l[o][0]);o+=1)i.push(l[o][1]);return i},i=function(e){var t,o=[],n=e[0].getAttribute("class");if("undefined"!==n&&n.length>0)for(o=n.split(/\s+/),t=o.length;t--;)0!==o[t].lastIndexOf(f,0)&&o.splice(t,1);return o},s=function(t){var o=t.$el,s=n(o),r=s.join(" "),d=i(o),l=d.join(" ");l!==r&&(""!==l?o[0].setAttribute("class",o[0].getAttribute("class").replace(l,r)):o[0].setAttribute("class",o[0].getAttribute("class")+" "+r),e.event.publish(e.event.constants.COLWIDTHWATCHER_CHANGE_COLSIZES,o)),e.configuration.isDebugMode&&l!==r&&a(o,r)},a=function(t,o){var n=e.dom.$(u,t),i="Width: "+e.dom.innerWidth(t)+"px -- ";0===n.length?t.prepend('<p class="'+c+'">'+i+o+"</p>"):n.html(i+o)},r=function(){var t,n,i,r,l,c;for(t=0,n=m.length;n>t;t+=1)if(m[t].conf.useOldColWidths&&m[t].conf.useOldColWidths!==!1){if(i=e.dom.$(m[t].el),r=o(i),!i.hasClass(r)){for(l=0,c=d.length;c>l;l+=1)i.removeClass(d[l][1]);i.addClass(r),e.configuration.isDebugMode&&a(i,r)}}else s(m[t])},e.event.subscribe(e.event.constants.WINDOW_WIDTH_CHANGED,r),t=function(){this.conf={useOldColWidths:!1},this.init=function(t){e.event.publish(e.event.constants.COLWIDTHWATCHER_ADD_ELEMENT,t,this.conf)}}});