!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("prop-types")):"function"==typeof define&&define.amd?define(["react","prop-types"],t):"object"==typeof exports?exports["web-shell-core"]=t(require("react"),require("prop-types")):e["web-shell-core"]=t(e.react,e["prop-types"])}(window,(function(e,t){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=21)}([,,,function(e,t,n){var r,o;r=[t,n(6)],void 0===(o=function(e,t){"use strict";var n;function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,t=(n=t)&&n.__esModule?n:{default:n};var i=/\s+/,u=function(e,t,n,r){var u,c,a,f;if(!n)return!0;if("object"===o(n)){for(c in n)e[t].apply(e,[c,n[c]].concat(r));return!1}if(i.test(n)){for(a=0,f=(u=n.split(i)).length;a<f;a++)e[t].apply(e,[u[a]].concat(r));return!1}return!0},c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,o,i;return n=e,(o=[{key:"on",value:function(e,t,n){return u(this,"on",e,[t,n])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:n,ctx:n||this}),this):this}},{key:"off",value:function(e,t,n){var r,o,i,c,a,f,l;if(!this._events||!u(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;var s=e?[e]:Object.keys(this._events);for(c=0,a=s.length;c<a;c++)if(e=s[c],i=this._events[e]){if(this._events[e]=r=[],t||n)for(f=0,l=i.length;f<l;f++)o=i[f],(t&&t!==o.callback&&t!==o.callback._callback||n&&n!==o.context)&&r.push(o);r.length||delete this._events[e]}return this}},{key:"emit",value:function(e,n){if(!this._events||this._suspend)return this;if(!u(this,"emit",e,n))return this;var r=this._events[e];return r&&function(e,n){for(var r,o=-1,i=e.length;++o<i;)(r=e[o]).callback.call(r.ctx,t.default.createEventObject(n))}(r,n),this}},{key:"suspendEvents",value:function(){this._suspend=!0}},{key:"resumeEvents",value:function(){this._suspend=!1}}])&&r(n.prototype,o),i&&r(n,i),e}();e.default=c}.apply(t,r))||(e.exports=o)},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){var r;void 0===(r=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t={createEventObject:function(e){var t,n={_detail:null};if(null==e)return n;for(t in e)t in n||(n[t]=e[t]);return n},dispatchDomEvent:function(e,t,n){var r;if(e&&"undefined"!=typeof document&&(void 0===(n=n||{}).bubbles&&(n.bubbles=!0),void 0===n.cancelable&&(n.cancelable=!0),e.dispatchEvent&&document.createEvent)){for(var o in(r=(e.ownerDocument||document).createEvent("HTMLEvents")).initEvent(t,!(!n||!n.bubbles),!(!n||!n.cancelable)),n)o in r||(r[o]=n[o]);e.dispatchEvent(r)}}};e.default=t}.apply(t,[t]))||(e.exports=r)},,,,,,function(e,t,n){var r,o;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r=[t,n(4),n(5)],void 0===(o=function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){return e&&e.sandbox&&e.sandbox.logger||null}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,t=r(t),n=r(n);var s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(a,e);var t,n,r,i=c(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._loggedErrors=new Set,t}return t=a,r=[{key:"initialize",value:function(e){}},{key:"uninitialize",value:function(){}}],(n=[{key:"componentDidCatch",value:function(e,t){if(!this._loggedErrors.has[String(e)]){this._loggedErrors.add(String(e));var n=l(this.props),r="Fatal widget rendering error: ".concat(e,". Consider creating a fallback UI using an error boundary. To learn more, see https://reactjs.org/docs/error-boundaries.html"),o=t&&t.componentStack;n&&"function"==typeof n.logException?n.logException(r,e,{component_stack:o}):console.error(r,{error:e,componentStack:o}),this.err(e)}}},{key:"err",value:function(e){var t;e instanceof Error||(t=(t=e)||"An unknown error occurred",e=new Error(t)),this.invokePropsCallback("onError",e)}},{key:"ready",value:function(e){this.invokePropsCallback("onReady",e)}},{key:"waitStart",value:function(e){this.invokePropsCallback("onWaitStart",e)}},{key:"waitFinish",value:function(e){this.invokePropsCallback("onWaitFinish",e)}},{key:"done",value:function(e){this.invokePropsCallback("onDone",e)}},{key:"cancel",value:function(e){this.invokePropsCallback("onCancel",e)}},{key:"invokePropsCallback",value:function(e,t){var n,r=this.props[e];if(!r||"function"!=typeof r)return n;try{n=r(t)}catch(t){var o=l(this.props),i="An error occurred invoking consumer callback: ".concat(e,". Error: ").concat(t.message);o&&"function"==typeof o.error?o.error(i):console.error(i)}return n}},{key:"getTrackingContext",value:function(){return{}}}])&&o(t.prototype,n),r&&o(t,r),a}(t.default.Component);s.isImplementedBy=function(e){var t=Object.getPrototypeOf(e);return!!(t.err&&t.ready&&t.waitStart&&t.waitFinish&&t.done&&t.cancel&&t.invokePropsCallback)},s.propTypes={consumerId:n.default.string,onError:n.default.func,onReady:n.default.func,onWaitStart:n.default.func,onWaitFinish:n.default.func,onDone:n.default.func,onCancel:n.default.func};var p=s;e.default=p}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r=[t,n(3)],void 0===(o=function(e,t){"use strict";var n;function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var o=s(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l(this,n)}}function l(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,t=(n=t)&&n.__esModule?n:{default:n};var y={FATAL:1,ERROR:2,WARN:3,LOG:4,DEBUG:5},v={};v[y.FATAL]="fatal",v[y.ERROR]="error",v[y.WARN]="warn",v[y.LOG]="log",v[y.DEBUG]="debug";var b=["fatal-and-above","error-and-above","warn-and-above","log-and-above","debug-and-above"],h={};function g(e,t,n,r,o,i){var u=b.slice(t-1,b.length).join(" "),c=null;e._props&&(c=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e._props)),r&&(c=Object.assign(c||{},r));var a={message:n,level:t,props:c,loggerName:e._name};o&&(a.exception=o),i&&(a.options=i),e.emit(u,a)}var _=function(e){c(n,e);var t=f(n);function n(e){var o;return r(this,n),o=t.call(this,e),e._name&&(o._name=e._name),o}return u(n,[{key:"setDefaultProps",value:function(e){this._props=e}},{key:"debug",value:function(e,t){this._log(y.DEBUG,e,t)}},{key:"log",value:function(e,t){this._log(y.LOG,e,t)}},{key:"info",value:function(e,t){this._log(y.LOG,e,t)}},{key:"warn",value:function(e,t){this._log(y.WARN,e,t)}},{key:"error",value:function(e,t){this._log(y.ERROR,e,t)}},{key:"fatal",value:function(e,t,n){this._log(y.FATAL,e,t,null,n)}},{key:"logException",value:function(e,t,n,r){this._log(y.ERROR,e,n,t,r)}},{key:"_log",value:function(e,t,n,r,o){g(this,e,t,n,r,o)}},{key:"isLevelDebug",value:function(){return this._isLevel(y.DEBUG)}},{key:"isLevelLog",value:function(){return this._isLevel(y.LOG)}},{key:"isLevelInfo",value:function(){return this._isLevel(y.LOG)}},{key:"isLevelWarn",value:function(){return this._isLevel(y.WARN)}},{key:"isLevelError",value:function(){return this._isLevel(y.ERROR)}},{key:"isLevelFatal",value:function(){return this._isLevel(y.FATAL)}},{key:"_isLevel",value:function(e){return function(e,t){if(!e._events)return!1;for(var n=b.length;n>=t;n--)if(e._events[b[n-1]])return!0;return!1}(this,e)}}]),n}(t.default),m=new(function(e){c(n,e);var t=f(n);function n(){var e;return r(this,n),(e=t.call(this)).levels=y,e.levelNames=v,e}return u(n,[{key:"getLogger",value:function(e){e||(e="__default_logger__");var t=h[e];return t||(t=h[e]=new _({_name:e}),"__default_logger__"!==e&&this.emit("logger-created",{name:e})),t}},{key:"getLoggerNames",value:function(){var e=Object.keys(h),t=e.indexOf("__default_logger__");return t>-1&&e.splice(t,1),e}},{key:"_removeLogger",value:function(e){h[e]&&(h[e].off(),delete h[e])}}]),n}(t.default));e.default=m}.apply(t,r))||(e.exports=o)},,,,,,,,function(e,t,n){var r,o;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r=[t,n(4),n(5),n(12),n(13)],void 0===(o=function(e,t,n,r,o){"use strict";function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y(e);if(t){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,t=u(t),n=u(n),r=u(r),o=u(o);var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var n,r,i,u=p(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=u.call(this,e)).state={},t}return n=c,(r=[{key:"componentDidMount",value:function(){var e=this.context.sandbox,t=this._getWidgetId(),n=this.props.options;e?(this.props.hasOwnProperty("id")&&this._getLogger().warn("Deprecation Warning: id prop has been deprecated. Use widgetId instead."),this._loadWidget(e.widgets,t,n)):this._handleError(new Error("No sandbox found in content. Need access to sandbox to fetch the widget."))}},{key:"shouldComponentUpdate",value:function(e,t){return!this.props.optimized||!(JSON.stringify(this.props)===JSON.stringify(e)&&JSON.stringify(this.state)===JSON.stringify(t))}},{key:"componentDidCatch",value:function(e,t){this._loggedErrors.has[String(e)]||(this._loggedErrors.add(String(e)),this._getLogger().logException("Fatal rendering error in child widget ".concat(this._getWidgetId(),": ").concat(e,". Consider creating a fallback UI using an error boundary. To learn more, see https://reactjs.org/docs/error-boundaries.html"),e,{widget_id:this._getWidgetId(),component_stack:t&&t.componentStack}),this.err(e))}},{key:"render",value:function(){var e;return this.state.ContainedWidget?(e=a(a({},this.props),{},{ref:"_containedWidget"}),t.default.createElement(this.state.ContainedWidget,e)):t.default.createElement("div")}},{key:"_getWidgetId",value:function(){return this.props.widgetId||this.props.id}},{key:"_loadWidget",value:function(e,t,n){var r=this,o=e.getWidget(t,n),i=e.getWidgetDescriptor(t,n);Promise.all([i,o]).then((function(e){var n=e[0],o=e[1],i=null;if(!n)throw new Error("The widget descriptor for ".concat(t," was not found or invalid. Please review HOCWidget consumption documentation here: https://github.intuit.com/pages/UX-Infra/UX-Infra-Docs/#/Appfabric/Web/plugin-dev/Widgets/4-consuming-widgets?id=consuming-widgets"));n.interface&&(i=n.interface.methods),r._exposeWidgetMethods(i),r.setState({ContainedWidget:o,descriptor:n})})).catch((function(e){r._handleError(e)}))}},{key:"_exposeWidgetMethods",value:function(e){var t=this;e&&Object.keys(e).forEach((function(e){t[e]=function(){var n=t.refs._containedWidget;return n[e].apply(n,arguments)}}))}},{key:"_getLogger",value:function(){return this.context&&this.context.sandbox&&this.context.sandbox.logger?this.context.sandbox.logger:o.default.getLogger()}},{key:"_handleError",value:function(e){this._getLogger().error(e),this.err(e)}}])&&l(n.prototype,r),i&&l(n,i),c}(r.default);v.defaultProps={optimized:!1},v.propTypes={id:n.default.string,widgetId:n.default.string,options:n.default.object,optimized:n.default.bool,onError:n.default.func,onReady:n.default.func},v.contextTypes={sandbox:n.default.object};var b=v;e.default=b}.apply(t,r))||(e.exports=o)}])}));