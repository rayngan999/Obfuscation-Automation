!function(t){var e=arguments.callee;if(!window.liveChatSettings)throw new Error("Couldn't find LiveChat settings. Please make sure livechat-config.js is loaded before livechat.js");if(!window.liveChatClientSettings)throw new Error("Couldn't find LiveChat Client settings. Please make sure livechat-config-client.js is loaded before livechat.js");if(!window.jQuery){if(!liveChatClientSettings.jQuery)throw new Error("jQuery is not loaded, and liveChatClientSettings.jQuery is not defined. Please set liveChatClientSettings.jQuery to a relative or absolute URL which points to the jQuery file you wish to load.");if(!e.jQueryLoading){var i=document.createElement("script");i.type="text/javascript",i.src=liveChatClientSettings.jQuery,document.getElementsByTagName("head")[0].appendChild(i),e.jQueryLoading=!0}return setTimeout(e,10)}if(e.jQueryLoading){t=jQuery.noConflict();e.jQueryLoading=!1}function n(t,e){return e=(e||"").split("-")[0],("object"==typeof t?t[e||v]:t).toString()||""}t.fn.scrollTo=function(e,i,n){i||(i=600),"function"!=typeof n&&(n=function(){}),t(this).stop().animate({scrollTop:e},i,n)},t.fn.animateOnce=function(e,i,n){e+=" animated";var a=t(this);a.data("animate-once")&&a.off("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend").removeClass(a.data("animate-once")).stop(),a.data("animate-once",e),"function"==typeof i&&(n=i,i=!1),!i||"number"!=typeof i&&/[0-9.]+m?s/i.test(i)||(i+="s");var l=a.css("animation-duration");return"0s"===l&&(l=""),a.show(),i&&a.css({animationDuration:i}),a.addClass(e).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(t){a.removeClass(e).off("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend"),a.data("animate-once",!1),i&&a.css({animationDuration:l}),"function"==typeof n&&n.call(this)}),a};var a=t(window),l=t(document),o=t("body"),s=t("head"),r=navigator.userAgent,d=/iPad|iPhone|iPod/i.test(r)&&!window.MSStream,c=/iPhone|iPod|(?=.*\bAndroid\b)(?=.*\bMobile\b)|(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)|IEMobile|BB10|NokiaN9/i.test(r),h=!c&&/iPad|Android|\bTablet\b|\b(KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b|(?=.*\bWindows\b)(?=.*\bARM\b)/i.test(r),v=liveChatClientSettings.language=(t("#livechat-language").val()||"").split("-")[0]||liveChatClientSettings.language||(document.location.search.match(/[?&]lang=(\w+)/i)||"")[1]||((document.documentElement||document).lang||"").split("-")[0]||(navigator.language||"").split("-")[0]||(navigator.userLanguage||"").split("-")[0]||"en",u=n(liveChatSettings.chatUrl),g=n(liveChatSettings.buttonId),C=0!==t(".livechat-prechat").length?"pre-chat":-1!==document.location.href.indexOf(u)?"in-chat":"client";if("pre-chat"!==C&&"in-chat"!==C||(0===s.find("meta[name=viewport]").length&&s.append('<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />'),liveChatClientSettings.favIcon&&s.append('<link rel="icon" type="'+liveChatClientSettings.favIcon.type+'" href="'+liveChatClientSettings.favIcon.url+'">'),c&&o.addClass("is-mobile"),h&&o.addClass("is-tablet"),l.on("click",".livechat-close-btn",function(){window.close()})),"in-chat"===C){var m,f=liveChatClientSettings.inChat,p=f.messages;function b(){var e=a.height(),i=e-t(".livechat-client-input").outerHeight(!0)-t(".liveAgentChatWaiting").outerHeight(!0)-5,n=t(".livechat-inchat-container").css("max-height"),l=t("#liveAgentClientChat").find(".row"),o=t("#liveAgentChatLog");n=n&&"none"!==n?parseFloat(n):e,l.each(function(){var e=t(this);e.hasClass("liveAgentChatWrap")||(i-=e.outerHeight(!0))}),o.css({height:Math.min(i,n)})}liveChatClientSettings.title&&(document.title=n(liveChatClientSettings.title)),d&&t(".liveAgentSaveButton").hide(),o.addClass("livechat-inchat livechat-lang-"+v),t(".liveAgentSendButton").addClass("livechat-send-btn btn"),t(".livechat-text").html(n(f.headline)),t("#liveAgentChatInput").attr("autocomplete","off"),f.loadingText&&t(".livechat-loading-text").html(n(f.loadingText)),f.subText?t(".livechat-subtext").html(n(f.subText)):t(".livechat-subtext").hide(),f.buttonText&&(f.buttonText.endChat&&(m=n(f.buttonText.endChat))&&t(".liveAgentEndButton").each(function(){t(this).attr("title",m).html(m)}),f.buttonText.saveChat&&(m=n(f.buttonText.saveChat))&&t(".liveAgentSaveButton").each(function(){t(this).attr("title",m).html(m)}),f.buttonText.sendMessage&&(m=n(f.buttonText.sendMessage))&&t(".liveAgentSendButton").each(function(){t(this).attr("title",m).html(m)})),a.on("resize",b),liveagent.addEventListener(liveagent.chasitor.Events.CHAT_ESTABLISHED,function(){b(),t(".livechat-loading-modal").hide(),t(".liveAgentEndButton").removeAttr("onclick").on("click",function(t){t.preventDefault();try{SfdcApp.LiveAgent.Chasitor.endChat()}catch(t){}}),window.focus()}),liveagent.addEventListener(liveagent.chasitor.Events.CHAT_REQUEST_FAILED,function(){var e=t("#liveAgentMessageContainer"),i=e.find(".btn-primary");if(0===i.length)return setTimeout(arguments.callee,100);t(".livechat-loading-text").html(e.find("div > p").html()),t(".livechat-loading-image").hide(),i.on("click",function(){window.close()})});var S=function(){t(".livechat-inchat-buttons").append('<div class="livechat-close-btn"></div>'),"function"==typeof liveChatSettings.endChat.callback&&liveChatSettings.endChat.callback(),"function"==typeof liveChatClientSettings.endChat.callback&&liveChatClientSettings.endChat.callback()};liveagent.addEventListener(liveagent.chasitor.Events.AGENT_CHAT_ENDED,S),liveagent.addEventListener(liveagent.chasitor.Events.CHASITOR_CHAT_ENDED,S),(p.animate||p.customClasses||p.callback)&&(liveagent.addEventListener(liveagent.chasitor.Events.AGENT_CHAT_MESSAGE,function(){var e=t(".operator").not("[id]").last();p.customClasses&&e.addClass(p.customClasses),p.animate&&e.animateOnce(p.animationClass,p.animationTime),"function"==typeof p.callback&&p.callback.apply(this,arguments)}),liveagent.addEventListener(liveagent.chasitor.Events.CHASITOR_CHAT_MESSAGE,function(){var e=t(".client").not("[id]").last();p.customClasses&&e.addClass(p.customClasses),p.animate&&e.animateOnce(p.animationClass,p.animationTime),"function"==typeof p.callback&&p.callback.apply(this,arguments)})),function(){var e,i=liveagent.chasitor.Events,n=function(){var e=t("#liveAgentMessageContainer button");0!==e.length&&e.addClass("btn btn-primary")};for(e in i)liveagent.addEventListener(i[e],n)}(),liveChatSettings.inChat&&"function"==typeof liveChatSettings.inChat.callback&&liveChatSettings.inChat.callback(),liveChatClientSettings.inChat&&"function"==typeof liveChatClientSettings.inChat.callback&&liveChatClientSettings.inChat.callback(),t(function(){setTimeout(function(){window.scrollTo(0,1)},0)})}else if("pre-chat"===C){liveChatClientSettings.title&&(document.title=n(liveChatClientSettings.title));var w=t("#livechat-prechat-form"),E=t("#livechat-session-id").val()||!1;if(E&&!/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/i.test(E)&&(E=!1),w.attr("action",u+"?lang="+v+"#deployment_id="+liveChatSettings.deploymentId+"&org_id="+liveChatSettings.orgId+"&button_id="+g+(E?"&session_id="+E:"")),w.append('<input type="hidden" name="liveagent.prechat:BrandCode" value="'+liveChatSettings.brandCode+'" />'),w.append('<input type="hidden" name="liveagent.prechat:Chat_Initiated_By" value="'+(h?"tablet":c?"mobile":"desktop")+'" />'),w.append('<input type="hidden" name="liveagent.prechat.findorcreate.map:Case" value="Chat_Initiated_By__c,Chat_Initiated_By" />'),w.append('<input type="hidden" name="liveagent.prechat.findorcreate.map.doCreate:Case" value="Chat_Initiated_By__c,true" />'),w.append('<input type="hidden" name="liveagent.prechat.save:BrandCode" value="PC_Brand_Code__c" />'),t(".livechat-text").html(n(liveChatClientSettings.preChat.headline)),liveChatClientSettings.preChat.subText?t(".livechat-subtext").html(n(liveChatClientSettings.preChat.subText)):t(".livechat-subtext").hide(),t("#is-existing-case").on("change",function(e){var i=t(this),n=t(".existing-case-field"),a=i.closest("form").data("validator"),l=!!a&&a.settings;t(this).is(":checked")?(n.removeClass("hidden"),t("#case-number").select(),o.scrollTo(o.prop("scrollHeight"))):(n.addClass("hidden"),l&&(n.find(l.errorElement+"."+l.errorClass.split(" ")[0]+", .form-errors").hide(),n.find("."+l.errorClass).removeClass(l.errorClass)))}),t.validator){t.extend(t.validator.messages,{de:{casenumber:"Bitte geben Sie eine gÃ¼ltige Bestellnummer ein.",email:"Bitte geben Sie eine gÃ¼ltige E-Mail-Adresse ein.",required:"Dieses Feld ist erforderlich."},en:{casenumber:"Please enter a valid order number."},es:{casenumber:"Introduzca un nÃºmero de pedido vÃ¡lido.",email:"Por favor, introduce una direcciÃ³n de correo electrÃ³nico vÃ¡lida.",required:"Este campo es obligatorio."},fr:{casenumber:"Entrez un numÃ©ro de commande valide.",email:"Veuillez indiquer une adresse de courriel valide.",required:"Ce champ est obligatoire."},it:{casenumber:"Inserisci un numero d'ordine valido.",email:"Si prega di inserire un indirizzo email valido.",required:"Campo obbligatorio."},no:{casenumber:"Vennligst skriv inn et gyldig bestillingsnummer.",email:"Vennligst oppgi en gyldig epostadresse.",required:"Dette feltet er obligatorisk."}}[v]),t.validator.addMethod("email",function(t,e){return this.optional(e)||/^[a-z0-9._%'+-]+@[a-z0-9.-]+\.[a-z]{2,}$/i.test(t)},t.validator.messages.email),t.validator.addMethod("casenumber",function(e,i){return t("#is-existing-case").is(":checked")&&0!==e.length&&/^[0-9a-z]{1,30}$/i.test(e)},t.validator.messages.casenumber)}liveChatSettings.preChat&&"function"==typeof liveChatSettings.preChat.callback&&liveChatSettings.preChat.callback(),liveChatClientSettings.preChat&&"function"==typeof liveChatClientSettings.preChat.callback&&liveChatClientSettings.preChat.callback(),t(function(){setTimeout(function(){window.scrollTo(0,1)},0),t.validator&&t(".form-validation").validate({errorClass:"livechat-field-error",errorElement:"div",showErrors:function(e,i){var n=this;if(0===i.length)return t(n.settings.errorElement+"."+n.settings.errorClass.split(" ")[0]+", .form-errors").each(function(){t(this).data("animated",!1).hide()}),void n.currentElements.removeClass(n.settings.errorClass);var a=liveChatClientSettings.validation.errors,l=a.animate,o=a.callback,s=a.customClasses;t.each(i,function(){n.defaultShowErrors();var e=this.method?n.toShow:t(this.element.nextSibling);e.prepend('<span class="livechat-icon-error"></span>'),l&&!e.data("animated")&&(e.data("animated",!0),e.animateOnce(liveChatClientSettings.validation.errors.animationClass,liveChatClientSettings.validation.errors.animationTime)),s&&e.addClass(s)}),"function"==typeof o&&o.call(this,i)}})})}else{var A=function(){liveagent.init(liveChatSettings.initUrl,liveChatSettings.deploymentId,liveChatSettings.orgId),liveagent.setChatWindowWidth(liveChatClientSettings.windowWidth),liveagent.setChatWindowHeight(liveChatClientSettings.windowHeight),t(function(){var e=t(".livechat-online"),i=t(".livechat-offline"),a=t(".livechat-button"),l=liveChatClientSettings.windowName||!1;"self"===l&&(window.name?l=window.name:window.name=l),e.each(function(){var e=t(this).data("livechat-lang");forButtonId=e?n(liveChatSettings.buttonId,e):g,liveagent.showWhenOnline(forButtonId,this)}),i.each(function(){var e=t(this).data("livechat-lang");forButtonId=e?n(liveChatSettings.buttonId,e):g,liveagent.showWhenOffline(forButtonId,this)}),a.each(function(){var e=t(this).data("livechat-lang"),i=e?n(liveChatSettings.buttonId,e):g;liveagent.showWhenOnline(i,this),t(this).on("click",function(e){var i=t(this).data("livechat-lang"),a=i?n(liveChatSettings.buttonId,i):g;e.preventDefault(),l?liveagent.startChatWithWindow(a,l):liveagent.startChat(a)})})})};window.liveagent?A():t.getScript(liveChatSettings.deploymentScript).done(function(){A()}).fail(function(){throw new Error("Failed to load SalesForce deployment script!")})}}(window.jQuery);
