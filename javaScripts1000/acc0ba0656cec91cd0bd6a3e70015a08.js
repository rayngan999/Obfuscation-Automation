KISSY.add("node/base",["dom","event/dom"],function(e,t){function n(t,o,i){var a,d=this;if(!(d instanceof n))return new n(t,o,i);if(!t)return d;if("string"==typeof t){if(a=r.create(t,o,i),a.nodeType===s.DOCUMENT_FRAGMENT_NODE)return u.apply(this,l(a.childNodes)),d}else{if(e.isArray(t)||c(t))return u.apply(d,l(t)),d;a=t}return d[0]=a,d.length=1,d}var r=t("dom"),o=t("event/dom"),i=Array.prototype,a=i.slice,s=r.NodeType,u=i.push,l=e.makeArray,c=r.isDomNodeList;return n.prototype={"constructor":n,"isNodeList":!0,"length":0,"item":function(e){var t=this;return"number"==typeof e?e>=t.length?null:new n(t[e]):new n(e)},"add":function(e,t,r){"number"==typeof t&&(r=t,t=undefined);var o=n.all(e,t).getDOMNodes(),a=new n(this);if(r===undefined)u.apply(a,o);else{var s=[r,0];s.push.apply(s,o),i.splice.apply(a,s)}return a},"slice":function(){return new n(a.apply(this,arguments))},"getDOMNodes":function(){return a.call(this)},"each":function(t,r){var o=this;return e.each(o,function(e,i){return e=new n(e),t.call(r||e,e,i,o)}),o},"getDOMNode":function(){return this[0]},"end":function(){var e=this;return e.__parent||e},"filter":function(e){return new n(r.filter(this,e))},"all":function(e){var t,r=this;return t=r.length>0?n.all(e,r):new n,t.__parent=r,t},"one":function(e){var t=this,n=t.all(e),r=n.length?n.slice(0,1):null;return r&&(r.__parent=t),r}},e.mix(n,{"all":function(t,o){return"string"==typeof t&&(t=e.trim(t))&&t.length>=3&&e.startsWith(t,"<")&&e.endsWith(t,">")?(o&&(o.getDOMNode&&(o=o[0]),o=o.ownerDocument||o),new n(t,undefined,o)):new n(r.query(t,o))},"one":function(e,t){var r=n.all(e,t);return r.length?r.slice(0,1):null}}),n.NodeType=s,n.KeyCode=o.KeyCode,n.Gesture=o.Gesture,n.REPLACE_HISTORY=o.REPLACE_HISTORY,n}),KISSY.add("node/attach",["dom","event/dom","./base"],function(e,t){function n(e,t,n){n.unshift(t);var r=i[e].apply(i,n);return r===undefined?t:r}function r(e,t,n){n.unshift(t);var r=i[e].apply(i,n);return r===undefined?t:null===r?null:new s(r)}function o(t,r,o,a){return a[o]!==undefined||e.isObject(a[0])?n(t,r,a):(a.unshift(r),i[t].apply(i,a))}var i=t("dom"),a=t("event/dom"),s=t("./base"),u=s.prototype,l=e.makeArray,c=["nodeName","isCustomDomain","getEmptyIframeSrc","equals","contains","index","scrollTop","scrollLeft","height","width","innerHeight","innerWidth","outerHeight","outerWidth","addStyleSheet","appendTo","prependTo","insertBefore","before","after","insertAfter","test","hasClass","addClass","removeClass","replaceClass","toggleClass","removeAttr","hasAttr","hasProp","scrollIntoView","remove","empty","removeData","hasData","unselectable","wrap","wrapAll","replaceWith","wrapInner","unwrap"],d=["getWindow","getDocument","filter","first","last","parent","closest","next","prev","clone","siblings","contents","children"],f={"attr":1,"text":0,"css":1,"style":1,"val":0,"prop":1,"offset":0,"html":0,"outerHTML":0,"outerHtml":0,"data":1},p=["on","detach","delegate","undelegate"],h=["fire","fireHandler"];s.KeyCode=a.KeyCode,e.each(c,function(e){u[e]=function(){var t=l(arguments);return n(e,this,t)}}),e.each(d,function(e){u[e]=function(){var t=l(arguments);return r(e,this,t)}}),e.each(f,function(e,t){u[t]=function(){var n=l(arguments);return o(t,this,e,n)}}),e.each(p,function(e){u[e]=function(){var t=this,n=l(arguments);return n.unshift(t),a[e].apply(a,n),t}}),e.each(h,function(e){u[e]=function(){var t=this,n=l(arguments);return n.unshift(t),a[e].apply(a,n)}})}),KISSY.add("node/override",["dom","./base","./attach"],function(e,t){var n=t("dom"),r=t("./base");t("./attach");var o=r.prototype;e.each(["append","prepend","before","after"],function(e){o[e]=function(t){var r=t,o=this;return"object"!=typeof r&&(r=n.create(r+"")),r&&n[e](r,o),o}}),e.each(["wrap","wrapAll","replaceWith","wrapInner"],function(e){var t=o[e];o[e]=function(e){var n=this;return"string"==typeof e&&(e=r.all(e,n[0].ownerDocument)),t.call(n,e)}})}),KISSY.add("node/anim",["./base","dom","anim"],function(e,t){function n(e,t,n){for(var r=[],o={},i=n||0;i<t;i++)r.push.apply(r,a[i]);for(i=0;i<r.length;i++)o[r[i]]=e;return o}var r=t("./base"),o=t("dom"),i=t("anim"),a=[["height","margin-top","margin-bottom","padding-top","padding-bottom"],["width","margin-left","margin-right","padding-left","padding-right"],["opacity"]];e.augment(r,{"animate":function(){var t=this,n=e.makeArray(arguments);return e.each(t,function(t){var r=e.clone(n),o=r[0];o.to?(o.node=t,new i(o).run()):i.apply(undefined,[t].concat(r)).run()}),t},"stop":function(t,n,r){var o=this;return e.each(o,function(e){i.stop(e,t,n,r)}),o},"pause":function(t,n){var r=this;return e.each(r,function(e){i.pause(e,n)}),r},"resume":function(t,n){var r=this;return e.each(r,function(e){i.resume(e,n)}),r},"isRunning":function(){for(var e=this,t=0;t<e.length;t++)if(i.isRunning(e[t]))return!0;return!1},"isPaused":function(){for(var e=this,t=0;t<e.length;t++)if(i.isPaused(e[t]))return!0;return!1}}),e.each({"show":n("show",3),"hide":n("hide",3),"toggle":n("toggle",3),"fadeIn":n("show",3,2),"fadeOut":n("hide",3,2),"fadeToggle":n("toggle",3,2),"slideDown":n("show",1),"slideUp":n("hide",1),"slideToggle":n("toggle",1)},function(t,n){r.prototype[n]=function(r,a,s){var u=this;return o[n]&&!r?o[n](u):e.each(u,function(e){new i(e,t,r,s,a).run()}),u}})}),KISSY.add("node",["node/base","node/attach","node/override","node/anim"],function(e,t){var n=t("node/base");return t("node/attach"),t("node/override"),t("node/anim"),e.mix(e,{"Node":n,"NodeList":n,"one":n.one,"all":n.all}),n});KISSY.add("dom/base/api",[],function(e){var t=e.Env.host||{},n=t.document,r=e.UA,o=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,i={"ELEMENT_NODE":1,"ATTRIBUTE_NODE":2,"TEXT_NODE":3,"CDATA_SECTION_NODE":4,"ENTITY_REFERENCE_NODE":5,"ENTITY_NODE":6,"PROCESSING_INSTRUCTION_NODE":7,"COMMENT_NODE":8,"DOCUMENT_NODE":9,"DOCUMENT_TYPE_NODE":10,"DOCUMENT_FRAGMENT_NODE":11,"NOTATION_NODE":12},a={"isCustomDomain":function(e){e=e||t,e=a.get(e);var n=e.document.domain,r=e.location.hostname;return n!==r&&n!=="["+r+"]"},"getEmptyIframeSrc":function(e){return e=e||t,e=a.get(e),r.ie&&a.isCustomDomain(e)?"javascript:void(function(){"+encodeURIComponent('document.open();document.domain="'+e.document.domain+'";document.close();')+"}())":""},"NodeType":i,"getWindow":function(n){if(!n)return t;if(n=a.get(n),e.isWindow(n))return n;var r=n;return r.nodeType!==i.DOCUMENT_NODE&&(r=n.ownerDocument),r.defaultView||r.parentWindow},"getDocument":function(t){return t?(t=a.get(t),e.isWindow(t)?t.document:t.nodeType===i.DOCUMENT_NODE?t:t.ownerDocument):n},"isDomNodeList":function(e){return e&&!e.nodeType&&e.item&&!e.setTimeout},"nodeName":function(e){var t=a.get(e),n=t.nodeName.toLowerCase();if(r.ie){var o=t.scopeName;o&&"HTML"!==o&&(n=o.toLowerCase()+":"+n)}return n},"_RE_NUM_NO_PX":new RegExp("^("+o+")(?!px)[a-z%]+$","i")};return e.mix(a,i),a}),KISSY.add("dom/base/attr",["./api"],function(e,t){function n(e){return null==e?"":e+""}function r(e,t){t=v[t]||t;var n=y[t];return n&&n.get?n.get(e,t):e[t]}var o=t("./api"),i=e.Env.host.document,a=o.NodeType,s=i&&i.documentElement,u=o.nodeName,l=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,c=/^(?:button|input|object|select|textarea)$/i,d=/^a(?:rea)?$/i,f=/:|^on/,p=/\r/g,h={},m={"val":1,"css":1,"html":1,"text":1,"data":1,"width":1,"height":1,"offset":1,"scrollTop":1,"scrollLeft":1},g={"tabindex":{"get":function(e){var t=e.getAttributeNode("tabindex");return t&&t.specified?parseInt(t.value,10):c.test(e.nodeName)||d.test(e.nodeName)&&e.href?0:undefined}}},v={"hidefocus":"hideFocus","tabindex":"tabIndex","readonly":"readOnly","for":"htmlFor","class":"className","maxlength":"maxLength","cellspacing":"cellSpacing","cellpadding":"cellPadding","rowspan":"rowSpan","colspan":"colSpan","usemap":"useMap","frameborder":"frameBorder","contenteditable":"contentEditable"},b={"get":function(e,t){return o.prop(e,t)?t.toLowerCase():undefined},"set":function(e,t,n){var r;return!1===t?o.removeAttr(e,n):(r=v[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},y={},T={},S={"select":{"get":function(e){var t,n,r,i=e.selectedIndex,a=e.options,s="select-one"===String(e.type);if(i<0)return null;if(s)return o.val(a[i]);for(t=[],n=0,r=a.length;n<r;++n)a[n].selected&&t.push(o.val(a[n]));return t},"set":function(t,n){var r=e.makeArray(n),i=t.options;return e.each(i,function(t){t.selected=e.inArray(o.val(t),r)}),r.length||(t.selectedIndex=-1),r}}};return e.each(["radio","checkbox"],function(t){S[t]={"get":function(e){return null===e.getAttribute("value")?"on":e.value},"set":function(t,n){return e.isArray(n)?(t.checked=e.inArray(o.val(t),n),1):undefined}}}),g.style={"get":function(e){return e.style.cssText}},e.mix(o,{"_valHooks":S,"_propFix":v,"_attrHooks":g,"_propHooks":y,"_attrNodeHook":T,"_attrFix":h,"prop":function(t,n,i){var a,s,u,l=o.query(t);if(e.isPlainObject(n))return e.each(n,function(e,t){o.prop(l,t,e)}),undefined;if(n=v[n]||n,u=y[n],i!==undefined)for(a=l.length-1;a>=0;a--)s=l[a],u&&u.set?u.set(s,i,n):s[n]=i;else if(l.length)return r(l[0],n);return undefined},"hasProp":function(e,t){var n,i,a=o.query(e),s=a.length;for(n=0;n<s;n++)if(i=a[n],r(i,t)!==undefined)return!0;return!1},"removeProp":function(e,t){t=v[t]||t;var n,r,i=o.query(e);for(n=i.length-1;n>=0;n--){r=i[n];try{r[t]=undefined,delete r[t]}catch(a){}}},"attr":function(t,n,r,i){var s,c,d,p=o.query(t),v=p[0];if(e.isPlainObject(n)){i=r;for(var y in n)o.attr(p,y,n[y],i);return undefined}if(i&&m[n])return o[n](t,r);if(n=n.toLowerCase(),i&&m[n])return o[n](t,r);if(n=h[n]||n,s=l.test(n)?b:f.test(n)?T:g[n],r===undefined){if(v&&v.nodeType===a.ELEMENT_NODE){if("form"===u(v)&&(s=T),s&&s.get)return s.get(v,n);if(""===(d=v.getAttribute(n))){var S=v.getAttributeNode(n);if(!S||!S.specified)return undefined}return null===d?undefined:d}}else for(c=p.length-1;c>=0;c--)(v=p[c])&&v.nodeType===a.ELEMENT_NODE&&("form"===u(v)&&(s=T),s&&s.set?s.set(v,r,n):v.setAttribute(n,""+r));return undefined},"removeAttr":function(e,t){t=t.toLowerCase(),t=h[t]||t;var n,r,i,s=o.query(e);for(i=s.length-1;i>=0;i--)r=s[i],r.nodeType===a.ELEMENT_NODE&&(r.removeAttribute(t),l.test(t)&&(n=v[t]||t)in r&&(r[n]=!1))},"hasAttr":s&&!s.hasAttribute?function(e,t){t=t.toLowerCase();var n,r,i,a=o.query(e);for(n=0;n<a.length;n++)if(r=a[n],(i=r.getAttributeNode(t))&&i.specified)return!0;return!1}:function(e,t){var n,r=o.query(e),i=r.length;for(n=0;n<i;n++)if(r[n].hasAttribute(t))return!0;return!1},"val":function(t,r){var i,a,s,l,c,d;if(r===undefined)return s=o.get(t),s?(i=S[u(s)]||S[s.type])&&"get"in i&&(a=i.get(s,"value"))!==undefined?a:(a=s.value,"string"==typeof a?a.replace(p,""):null==a?"":a):undefined;for(l=o.query(t),c=l.length-1;c>=0;c--){if(s=l[c],1!==s.nodeType)return undefined;d=r,null==d?d="":"number"==typeof d?d+="":e.isArray(d)&&(d=e.map(d,n)),(i=S[u(s)]||S[s.type])&&"set"in i&&i.set(s,d,"value")!==undefined||(s.value=d)}return undefined},"text":function(e,t){var n,r,i,s;if(t===undefined)return n=o.get(e),o._getText(n);for(r=o.query(e),i=r.length-1;i>=0;i--)n=r[i],s=n.nodeType,s===a.ELEMENT_NODE?(o.cleanData(n.getElementsByTagName("*")),"textContent"in n?n.textContent=t:n.innerText=t):s!==a.TEXT_NODE&&s!==a.CDATA_SECTION_NODE||(n.nodeValue=t);return undefined},"_getText":function(e){return e.textContent}}),o}),KISSY.add("dom/base/class",["./api"],function(e,t){function n(t){t=e.trim(t||"");for(var n,r=t.split(u),o=[],i=r.length,a=0;a<i;a++)(n=r[a])&&o.push(n);return o}function r(e){return function(t,n){var r,o,i,s=t.classList,u=a.call(arguments,2);for(r=0,o=n.length;r<o;r++)(i=n[r])&&s[e].apply(s,[i].concat(u))}}function o(e){return function(t,r){var o=n(r),u=a.call(arguments,2);i.query(t).each(function(t){t.nodeType===s.ELEMENT_NODE&&i[e].apply(i,[t,o].concat(u))})}}var i=t("./api"),a=[].slice,s=i.NodeType,u=/[\.\s]\s*\.?/;return e.mix(i,{"_hasClass":function(e,t){var n,r,o,i=e.classList;if(i.length){for(n=0,r=t.length;n<r;n++)if((o=t[n])&&!i.contains(o))return!1;return!0}return!1},"_addClass":r("add"),"_removeClass":r("remove"),"_toggleClass":r("toggle"),"hasClass":function(e,t){var r=!1;return t=n(t),i.query(e).each(function(e){return e.nodeType===s.ELEMENT_NODE&&i._hasClass(e,t)?(r=!0,!1):undefined}),r},"replaceClass":function(e,t,n){i.removeClass(e,t),i.addClass(e,n)},"addClass":o("_addClass"),"removeClass":o("_removeClass"),"toggleClass":o("_toggleClass")}),i}),KISSY.add("dom/base/create",["./api"],function(e,t){function n(e,t){return e.getElementsByTagName(t)}function r(e){var t=e&&e!==p?e.createElement(v):b;return t===b&&(t.innerHTML=""),t}function o(e,t){var n=r(t);return n.innerHTML="m<div>"+e+"</div>",n.lastChild}function i(e){try{return void(e.innerHTML="")}catch(n){}for(var t;t=e.lastChild;)a(t,e)}function a(e,t){t&&(x&&t.canHaveChildren&&"removeNode"in e?(e.firstChild&&i(e),e.removeNode(!1)):t.removeChild(e))}function s(e,t,r){var o=t.nodeType;if(o===h.DOCUMENT_FRAGMENT_NODE)for(var i=t.childNodes,a=r.childNodes,u=0;i[u];)a[u]&&s(e,i[u],a[u]),u++;else if(o===h.ELEMENT_NODE)for(var l=n(t,"*"),c=n(r,"*"),d=0;l[d];)c[d]&&e(l[d],c[d]),d++}function u(t,n){var r,o,i=e.Env.mods["event/dom/base"];if(i=i&&i.exports,n.nodeType!==h.ELEMENT_NODE||d.hasData(t)){r=d.data(t);for(o in r)d.data(n,o,r[o]);i&&i.clone&&i.clone(t,n)}}function l(t,n){return e.isPlainObject(n)&&(t.nodeType===h.ELEMENT_NODE?d.attr(t,n,!0):t.nodeType===h.DOCUMENT_FRAGMENT_NODE&&d.attr(t.childNodes,n,!0)),t}function c(t){var n,r,o,i=null;if(t&&(t.push||t.item)&&t[0])for(r=t[0].ownerDocument,i=r.createDocumentFragment(),t=e.makeArray(t),n=0,o=t.length;n<o;n++)i.appendChild(t[n]);else f.error("Unable to convert "+t+" to fragment.");return i}var d=t("./api"),f=e.getLogger("s/dom"),p=e.Env.host.document,h=d.NodeType,m=e.UA,g=m.ieMode,v="div",b=p&&p.createElement(v),y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,T=/<([\w:]+)/,S=/^\s+/,C=/\s+$/,x=!!(g&&g<9),E=x,_=/<|&#?\w+;/,N=p&&"outerHTML"in p.documentElement,k=/^<(\w+)\s*\/?>(?:<\/\1>)?$/;e.mix(d,{"create":function(t,n,r,i){var a=null;if(!t)return a;if(t.nodeType)return d.clone(t);if("string"!=typeof t)return a;i===undefined&&(i=!0),i&&(t=e.trim(t));var s,u,f,h,m,g=d._creators,b=r||p,x=v;return _.test(t)?(f=k.exec(t))?a=b.createElement(f[1]):(t=t.replace(y,"<$1></$2>"),(f=T.exec(t))&&(h=f[1])&&(x=h.toLowerCase()),s=(g[x]||o)(t,b),E&&(u=t.match(S))&&s.insertBefore(b.createTextNode(u[0]),s.firstChild),E&&/\S/.test(t)&&(u=t.match(C))&&s.appendChild(b.createTextNode(u[0])),m=s.childNodes,1===m.length?a=m[0].parentNode.removeChild(m[0]):m.length?a=c(m):e.error(t+" : create node error")):a=b.createTextNode(t),l(a,n)},"_fixCloneAttributes":function(e,t){"textarea"===d.nodeName(e)&&(t.defaultValue=e.defaultValue,t.value=e.value)},"_creators":{"div":o},"_defaultCreator":o,"html":function(e,t,o){var i,a,s,u=d.query(e),l=u[0],c=!1;if(!l)return null;if(t===undefined){if(l.nodeType===h.ELEMENT_NODE)return l.innerHTML;if(l.nodeType===h.DOCUMENT_FRAGMENT_NODE){var f=r(l.ownerDocument);return f.appendChild(l),f.innerHTML}return null}if(t+="",!(t.match(/<(?:script|style|link)/i)||E&&t.match(S)||D[(t.match(T)||["",""])[1].toLowerCase()]))try{for(a=u.length-1;a>=0;a--)s=u[a],s.nodeType===h.ELEMENT_NODE&&(d.cleanData(n(s,"*")),s.innerHTML=t);c=!0}catch(p){}return c||(i=d.create(t,0,l.ownerDocument,0),d.empty(u),d.append(i,u,o)),undefined},"outerHtml":function(e,t,n){var o,i,a,s=d.query(e),u=s.length,l=s[0];if(!l)return null;if(t===undefined)return N&&l.nodeType!==d.DOCUMENT_FRAGMENT_NODE?l.outerHTML:(o=r(l.ownerDocument),o.appendChild(d.clone(l,!0)),o.innerHTML);if(t+="",!t.match(/<(?:script|style|link)/i)&&N)for(i=u-1;i>=0;i--)l=s[i],l.nodeType===h.ELEMENT_NODE&&(d.cleanData(l,1),l.outerHTML=t);else a=d.create(t,0,l.ownerDocument,0),d.insertBefore(a,s,n),d.remove(s);return undefined},"remove":function(t,r){var o,i,s,u=d.query(t),l=e.Env.mods["event/dom/base"];for(l=l&&l.exports,s=u.length-1;s>=0;s--)o=u[s],r||o.nodeType!==h.ELEMENT_NODE||(i=e.makeArray(n(o,"*")),i.push(o),d.removeData(i),l&&l.detach&&l.detach(i)),a(o,o.parentNode)},"clone":function(e,t,n,r){"object"==typeof t&&(r=t.deepWithDataAndEvent,n=t.withDataAndEvent,t=t.deep);var o,i,a=d.get(e),l=d._fixCloneAttributes;return a?(i=a.nodeType,o=a.cloneNode(t),i!==h.ELEMENT_NODE&&i!==h.DOCUMENT_FRAGMENT_NODE||(l&&i===h.ELEMENT_NODE&&l(a,o),t&&l&&s(l,a,o)),n&&(u(a,o),t&&r&&s(u,a,o)),o):null},"empty":function(e){var t,n,r=d.query(e);for(n=r.length-1;n>=0;n--)t=r[n],d.remove(t.childNodes)},"_nodeListToFragment":c}),d.outerHTML=d.outerHtml;var I,w=d._creators,O=d.create,D={"area":"map","thead":"table","td":"tr","th":"tr","tr":"tbody","tbody":"table","tfoot":"table","caption":"table","colgroup":"table","col":"colgroup","legend":"fieldset"};for(I in D)!function(e){w[I]=function(t,n){return O("<"+e+">"+t+"</"+e+">",undefined,n)}}(D[I]);return w.option=w.optgroup=function(e,t){return O('<select multiple="multiple">'+e+"</select>",undefined,t)},D.option=D.optgroup=1,d}),KISSY.add("dom/base/data",["./api"],function(e,t){var n=t("./api"),r=e.Env.host,o="_ks_data_"+e.now(),i={},a={},s={"applet":1,"object":1,"embed":1},u={"hasData":function(t,n){if(t)if(n!==undefined){if(n in t)return!0}else if(!e.isEmptyObject(t))return!0;return!1}},l={"hasData":function(e,t){if(e==r)return l.hasData(a,t);var n=e[o];return u.hasData(n,t)},"data":function(e,t,n){if(e==r)return l.data(a,t,n);var i=e[o];if(n===undefined)return t!==undefined?i&&i[t]:i=e[o]=e[o]||{};i=e[o]=e[o]||{},i[t]=n},"removeData":function(t,n){if(t==r)return l.removeData(a,n);var i=t[o];if(n!==undefined)delete i[n],e.isEmptyObject(i)&&l.removeData(t);else try{delete t[o]}catch(s){t[o]=undefined}}},c={"hasData":function(e,t){var n=e[o];if(!n)return!1;var r=i[n];return u.hasData(r,t)},"data":function(t,n,r){if(s[t.nodeName.toLowerCase()])return undefined;var a,u=t[o];if(!u){if(n!==undefined&&r===undefined)return undefined;u=t[o]=e.guid()}if(a=i[u],r===undefined)return n!==undefined?a&&a[n]:a=i[u]=i[u]||{};a=i[u]=i[u]||{},a[n]=r},"removeData":function(t,n){var r,a=t[o];if(a)if(r=i[a],n!==undefined)delete r[n],e.isEmptyObject(r)&&c.removeData(t);else{delete i[a];try{delete t[o]}catch(s){t[o]=undefined}t.removeAttribute&&t.removeAttribute(o)}}};return e.mix(n,{"__EXPANDO":o,"hasData":function(e,t){for(var r=!1,o=n.query(e),i=0;i<o.length;i++){var a=o[i];if(r=a.nodeType?c.hasData(a,t):l.hasData(a,t))return r}return r},"data":function(t,r,o){var i=n.query(t),a=i[0];if(e.isPlainObject(r)){for(var s in r)n.data(i,s,r[s]);return undefined}if(o===undefined){if(a)return a.nodeType?c.data(a,r):l.data(a,r)}else for(var u=i.length-1;u>=0;u--)a=i[u],a.nodeType?c.data(a,r,o):l.data(a,r,o);return undefined},"removeData":function(e,t){var r,o,i=n.query(e);for(o=i.length-1;o>=0;o--)r=i[o],r.nodeType?c.removeData(r,t):l.removeData(r,t)},"cleanData":function(t,r){var o,i,a=n.query(t),s=e.Env.mods["event/dom/base"];for(s=s&&s.exports,i=a.length-1;i>=0;i--)if(o=a[i],o.nodeType){var u=r&&e.makeArray(o.getElementsByTagName("*"))||[];u.push(o);for(var d=0,f=u.length;d<f;d++)c.removeData(u[d]);s&&s.detach&&s.detach(u)}else l.removeData(o)}}),n}),KISSY.add("dom/base/insertion",["./api"],function(e,t){function n(e){return!e.type||p.test(e.type)}function r(e,t){var o,i,a,s=[];for(o=0;e[o];o++)if(i=e[o],a=c(i),i.nodeType===u.DOCUMENT_FRAGMENT_NODE)s.push.apply(s,r(d(i.childNodes),t));else if("script"===a&&n(i))i.parentNode&&i.parentNode.removeChild(i),t&&t.push(i);else{if(i.nodeType===u.ELEMENT_NODE&&!l.test(a)){var p,h,m=[],g=i.getElementsByTagName("script");for(h=0;h<g.length;h++)p=g[h],n(p)&&m.push(p);f.apply(e,[o+1,0].concat(m))}s.push(i)}return s}function o(t){if(t.src)e.getScript(t.src);else{var n=e.trim(t.text||t.textContent||t.innerHTML||"");n&&e.globalEval(n)}}function i(t,n,i,s){t=a.query(t),s&&(s=[]),t=r(t,s),a._fixInsertionChecked&&a._fixInsertionChecked(t),n=a.query(n);var u,l,c,d,f,p=t.length,h=n.length;if((p||s&&s.length)&&h)for(u=a._nodeListToFragment(t),h>1&&(f=a.clone(u,!0),n=e.makeArray(n)),l=0;l<h;l++)c=n[l],u&&(d=l>0?a.clone(f,!0):u,i(d,c)),s&&s.length&&e.each(s,o)}var a=t("./api"),s="parentNode",u=a.NodeType,l=/^(?:button|input|object|select|textarea)$/i,c=a.nodeName,d=e.makeArray,f=[].splice,p=/\/(java|ecma)script/i;return e.mix(a,{"_fixInsertionChecked":null,"insertBefore":function(e,t,n){i(e,t,function(e,t){t[s]&&t[s].insertBefore(e,t)},n)},"insertAfter":function(e,t,n){i(e,t,function(e,t){t[s]&&t[s].insertBefore(e,t.nextSibling)},n)},"appendTo":function(e,t,n){i(e,t,function(e,t){t.appendChild(e)},n)},"prependTo":function(e,t,n){i(e,t,function(e,t){t.insertBefore(e,t.firstChild)},n)},"wrapAll":function(e,t){t=a.clone(a.get(t),!0),e=a.query(e),e[0].parentNode&&a.insertBefore(t,e[0]);for(var n;(n=t.firstChild)&&1===n.nodeType;)t=n;a.appendTo(e,t)},"wrap":function(t,n){t=a.query(t),n=a.get(n),e.each(t,function(e){a.wrapAll(e,n)})},"wrapInner":function(t,n){t=a.query(t),n=a.get(n),e.each(t,function(e){var t=e.childNodes;t.length?a.wrapAll(t,n):e.appendChild(n)})},"unwrap":function(t){t=a.query(t),e.each(t,function(e){var t=e.parentNode;a.replaceWith(t,t.childNodes)})},"replaceWith":function(e,t){var n=a.query(e);t=a.query(t),a.remove(t,!0),a.insertBefore(t,n),a.remove(n)}}),e.each({"prepend":"prependTo","append":"appendTo","before":"insertBefore","after":"insertAfter"},function(e,t){a[t]=a[e]}),a}),KISSY.add("dom/base/offset",["./api"],function(e,t){function n(e){var t,n,r,o=e.ownerDocument,i=o.body;return e.getBoundingClientRect?(t=e.getBoundingClientRect(),n=t[S],r=t[C],n-=d.clientLeft||i.clientLeft||0,r-=d.clientTop||i.clientTop||0,{"left":n,"top":r}):{"left":0,"top":0}}function r(e){var t=n(e),r=f(e);return t.left+=a[x](r),t.top+=a[E](r),t}function o(e,t){var o,i={"left":0,"top":0},a=f(e),s=e;t=t||a;do{o=a==t?r(s):n(s),i.left+=o.left,i.top+=o.top}while(a&&a!=t&&(s=a.frameElement)&&(a=a.parent));return i}function i(e,t){"static"===a.css(e,h)&&(e.style[h]=m);var n,r,i=o(e),s={};for(r in t)n=parseFloat(a.css(e,r))||0,s[r]=n+t[r]-i[r];a.css(e,s)}var a=t("./api"),s=e.Env.host,u=e.UA,l=s.document,c=a.NodeType,d=l&&l.documentElement,f=a.getWindow,p=Math.max,h="position",m="relative",g="document",v="body",b="documentElement",y="viewport",T="scroll",S="left",C="top",x=T+"Left",E=T+"Top";return e.mix(a,{"offset":function(e,t,n){var r;if(t===undefined){r=a.get(e);var s;return r&&(s=o(r,n)),s}var u,l=a.query(e);for(u=l.length-1;u>=0;u--)r=l[u],i(r,t);return undefined},"scrollIntoView":function(t,n,r,o){var i,s;if(i=a.get(t)){n&&(n=a.get(n)),n||(n=i.ownerDocument),n.nodeType===c.DOCUMENT_NODE&&(n=f(n)),e.isPlainObject(r)&&(o=r.allowHorizontalScroll,s=r.onlyScrollIfNeeded,r=r.alignWithTop),o=o===undefined||o;var u,l,d,p,h,m,g,v,b,y,T=e.isWindow(n),x=a.offset(i),E=a.outerHeight(i),_=a.outerWidth(i);T?(g=n,y=a.height(g),b=a.width(g),v={"left":a.scrollLeft(g),"top":a.scrollTop(g)},h={"left":x[S]-v[S],"top":x[C]-v[C]},m={"left":x[S]+_-(v[S]+b),"top":x[C]+E-(v[C]+y)},p=v):(u=a.offset(n),l=n.clientHeight,d=n.clientWidth,p={"left":a.scrollLeft(n),"top":a.scrollTop(n)},h={"left":x[S]-(u[S]+(parseFloat(a.css(n,"borderLeftWidth"))||0)),"top":x[C]-(u[C]+(parseFloat(a.css(n,"borderTopWidth"))||0))},m={"left":x[S]+_-(u[S]+d+(parseFloat(a.css(n,"borderRightWidth"))||0)),"top":x[C]+E-(u[C]+l+(parseFloat(a.css(n,"borderBottomWidth"))||0))}),s?(h.top<0||m.top>0)&&(!0===r?a.scrollTop(n,p.top+h.top):!1===r?a.scrollTop(n,p.top+m.top):h.top<0?a.scrollTop(n,p.top+h.top):a.scrollTop(n,p.top+m.top)):(r=r===undefined||!!r,r?a.scrollTop(n,p.top+h.top):a.scrollTop(n,p.top+m.top)),o&&(s?(h.left<0||m.left>0)&&(!0===r?a.scrollLeft(n,p.left+h.left):!1===r?a.scrollLeft(n,p.left+m.left):h.left<0?a.scrollLeft(n,p.left+h.left):a.scrollLeft(n,p.left+m.left)):(r=r===undefined||!!r,r?a.scrollLeft(n,p.left+h.left):a.scrollLeft(n,p.left+m.left)))}},"docWidth":0,"docHeight":0,"viewportHeight":0,"viewportWidth":0,"scrollTop":0,"scrollLeft":0}),e.each(["Left","Top"],function(e,t){var n=T+e;a[n]=function(r,o){if("number"==typeof r)return arguments.callee(s,r);r=a.get(r);var i,u,l,d,p;return r&&r.nodeType===c.ELEMENT_NODE?o!==undefined?r[n]=parseFloat(o):i=r[n]:(d=f(r),o!==undefined?(o=parseFloat(o),u="Left"===e?o:a.scrollLeft(d),l="Top"===e?o:a.scrollTop(d),d.scrollTo(u,l)):"number"!=typeof(i=d["page"+(t?"Y":"X")+"Offset"])&&(p=d[g],"number"!=typeof(i=p[b][n])&&(i=p[v][n]))),i}}),e.each(["Width","Height"],function(e){a["doc"+e]=function(t){t=a.get(t);var n=a.getDocument(t);return p(n[b][T+e],n[v][T+e],a[y+e](n))},a[y+e]=function(t){t=a.get(t);var n=f(t),r=n["inner"+e];if(u.mobile&&r)return r;var o="client"+e,i=n[g],s=i[v],l=i[b],c=l[o];return"CSS1Compat"===i.compatMode&&c||s&&s[o]||c}}),a}),KISSY.add("dom/base/style",["./api","ua"],function(e,t){function n(){return arguments[1].toUpperCase()}function r(e){return e.replace(g,n)}function o(e){if(-1!==e.indexOf("-")&&(e=e.replace(g,n)),e in S)return S[e];if(!N||e in N)S[e]={"propertyName":e,"propertyNamePrefix":""};else{for(var t,r=e.charAt(0).toUpperCase()+e.slice(1),o=0;o<x;o++){var i=C[o];t=i+r,t in N&&(S[e]={"propertyName":t,"propertyNamePrefix":i})}S[e]=S[e]||null}return S[e]}function i(e){if(j[e])return j[e];var t=o(e);return t&&t.propertyName||e}function a(e){var t,n,r=U[e];return U[e]||(t=E.body||E.documentElement,n=E.createElement(e),y.prepend(n,t),r=y.css(n,"display"),t.removeChild(n),U[e]=r),r}function s(e,t,n){var r,o={},i=e.style;for(r in t)o[r]=i[r],i[r]=t[r];n.call(e);for(r in t)i[r]=o[r]}function u(e,t,n){var o,a,s;if(3===e.nodeType||8===e.nodeType||!(o=e.style))return undefined;if(t=r(t),s=H[t],t=i(t),n!==undefined){if(null===n||n===q?n=q:isNaN(Number(n))||Y[t]||(n+=F),s&&s.set&&(n=s.set(e,n)),n!==undefined){try{o[t]=n}catch(u){b.warn("css set error:"+u)}n===q&&o.removeAttribute&&o.removeAttribute(t)}return o.cssText||(k.webkit&&(o=e.outerHTML),e.removeAttribute("style")),undefined}return s&&"get"in s&&(a=s.get(e,!1))!==undefined||(a=o[t]),a===undefined?"":a}function l(e){var t,n=arguments;return 0!==e.offsetWidth?t=p.apply(undefined,n):s(e,X,function(){t=p.apply(undefined,n)}),t}function c(e,t,n,r){var o,i,a,s=0;for(i=0;i<t.length;i++)if(o=t[i])for(a=0;a<n.length;a++){var u;u="border"===o?o+n[a]+"Width":o+n[a],s+=parseFloat(y._getComputedStyle(e,u,r))||0}return s}function d(e,t){return"border-box"===y._getComputedStyle(e,"boxSizing",t)}function f(e){var t,n=e.ownerDocument;return n.defaultView&&(t=n.defaultView.getComputedStyle(e,null)),t}function p(e,t,n){if(v.isWindow(e))return t===R?y.viewportWidth(e):y.viewportHeight(e);if(9===e.nodeType)return t===R?y.docWidth(e):y.docHeight(e);var r=t===R?["Left","Right"]:["Top","Bottom"],o=t===R?e.offsetWidth:e.offsetHeight,i=f(e),a=d(e,i),s=0;(null==o||o<=0)&&(o=undefined,s=y._getComputedStyle(e,t,i),(null==s||Number(s)<0)&&(s=e.style[t]||0),s=parseFloat(s)||0),n===undefined&&(n=a?D:w);var u=o!==undefined||a,l=o||s;return n===w?u?l-c(e,["border","padding"],r,i):s:u?l+(n===D?0:n===O?-c(e,["border"],r,i):c(e,["margin"],r,i)):s+c(e,I.slice(n),r,i)}function h(e){var t,n,r={"top":0,"left":0};return"fixed"===y.css(e,"position")?n=e.getBoundingClientRect():(t=m(e),n=y.offset(e),r=y.offset(t),r.top+=parseFloat(y.css(t,"borderTopWidth"))||0,r.left+=parseFloat(y.css(t,"borderLeftWidth"))||0),n.top-=parseFloat(y.css(e,"marginTop"))||0,n.left-=parseFloat(y.css(e,"marginLeft"))||0,{"top":n.top-r.top,"left":n.left-r.left}}function m(e){for(var t=e.offsetParent||(e.ownerDocument||E).body;t&&!z.test(t.nodeName)&&"static"===y.css(t,"position");)t=t.offsetParent;return t}var g=/-([a-z])/gi,v=e,b=e.getLogger("s/dom"),y=t("./api"),T=e.Env.host,S={},C=["Webkit","Moz","O","ms"],x=C.length,E=T.document||{},_=E&&E.documentElement,N=_.style,k=t("ua"),I=["margin","border","padding"],w=-1,O=2,D=1,A=y.nodeName,M=/^margin/,R="width",L="display",P=L+v.now(),B="none",Y={"fillOpacity":1,"fontWeight":1,"lineHeight":1,"opacity":1,"orphans":1,"widows":1,"zIndex":1,"zoom":1},q="",F="px",K=/\d(?!px)[a-z%]+$/i,H={},j={},U={},W=o("userSelect"),$=W&&W.propertyName;j["float"]="cssFloat",v.mix(y,{"_cssHooks":H,"_cssProps":j,"_getComputedStyle":function(e,t,n){var r,o,a,s,u="",l=e.ownerDocument;return t=i(t),(n=n||l.defaultView.getComputedStyle(e,null))&&(u=n.getPropertyValue(t)||n[t]),""!==u||y.contains(l,e)||(u=e.style[t]),y._RE_NUM_NO_PX.test(u)&&M.test(t)&&(s=e.style,r=s.width,o=s.minWidth,a=s.maxWidth,s.minWidth=s.maxWidth=s.width=u,u=n.width,s.width=r,s.minWidth=o,s.maxWidth=a),u},"style":function(e,t,n){var r,o,i,a=y.query(e),s=a[0];if(v.isPlainObject(t)){for(r in t)for(i=a.length-1;i>=0;i--)u(a[i],r,t[r]);return undefined}if(n===undefined)return o="",s&&(o=u(s,t,n)),o;for(i=a.length-1;i>=0;i--)u(a[i],t,n);return undefined},"css":function(e,t,n){var o,i,a,s,l=y.query(e),c=l[0];if(v.isPlainObject(t)){for(o in t)for(s=l.length-1;s>=0;s--)u(l[s],o,t[o]);return undefined}if(t=r(t),i=H[t],n===undefined)return a="",c&&(i&&"get"in i&&(a=i.get(c,!0))!==undefined||(a=y._getComputedStyle(c,t))),void 0===a?"":a;for(s=l.length-1;s>=0;s--)u(l[s],t,n);return undefined},"show":function(e){var t,n,r,o,i=y.query(e);for(o=i.length-1;o>=0;o--)r=i[o],r.style[L]=y.data(r,P)||q,y.css(r,L)===B&&(t=r.tagName.toLowerCase(),n=a(t),y.data(r,P,n),r.style[L]=n)},"hide":function(e){var t,n,r=y.query(e);for(n=r.length-1;n>=0;n--){t=r[n];var o=t.style,i=o[L];i!==B&&(i&&y.data(t,P,i),o[L]=B)}},"toggle":function(e){var t,n,r=y.query(e);for(n=r.length-1;n>=0;n--)t=r[n],y.css(t,L)===B?y.show(t):y.hide(t)},"addStyleSheet":function(e,t,n){"string"==typeof e&&(n=t,t=e,e=T);var r,o=y.getDocument(e);n&&(n=n.replace("#",q))&&(r=y.get("#"+n,o)),r||(r=y.create("<style>",{"id":n},o),y.get("head",o).appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(o.createTextNode(t)))},"unselectable":$?function(e){for(var t=y.query(e),n=t.length-1;n>=0;n--)t[n].style[$]="none"}:function(e){var t,n,r,o,i,a=y.query(e),s=0;for(n=a.length-1;n>=0;n--)for(t=a[n],t.style,i=t.getElementsByTagName("*"),t.setAttribute("unselectable","on"),o=["iframe","textarea","input","select"];r=i[s++];)v.inArray(A(r),o)||r.setAttribute("unselectable","on")},"innerWidth":0,"innerHeight":0,"outerWidth":0,"outerHeight":0,"width":0,"height":0}),v.each([R,"height"],function(e){y["inner"+v.ucfirst(e)]=function(t){var n=y.get(t);return n&&l(n,e,O)},y["outer"+v.ucfirst(e)]=function(t,n){var r=y.get(t);return r&&l(r,e,n?0:D)};var t=e===R?["Left","Right"]:["Top","Bottom"];y[e]=function(n,r){var o=y.get(n);if(r!==undefined){if(o){var i=f(o);return d(o,i)&&(r+=c(o,["padding","border"],t,i)),y.css(o,e,r)}return undefined}return o&&l(o,e,w)},H[e]={"get":function(t,n){var r;return n&&(r=l(t,e)+"px"),r}}});var X={"position":"absolute","visibility":"hidden","display":"block"};v.each(["left","top"],function(e){H[e]={"get":function(t,n){var r,o,i;if(n){if("static"===(i=y.css(t,"position")))return"auto";if(r=y._getComputedStyle(t,e),(o="auto"===r)&&"relative"===i)return"0px";(o||K.test(r))&&(r=h(t)[e]+"px")}return r}}});var z=/^(?:body|html)$/i;return y}),KISSY.add("dom/base/selector",["./api"],function(e,t){function n(e){var t,n=this,r=n.length;for(t=0;t<r&&!1!==e(n[t],t);t++);}function r(e){var t=e.substr(1);if(!t)throw new Error("An invalid or illegal string was specified for selector.");return t}function o(e){var t=e.charAt(0);return"#"===t?i(r(e)):"."===t?a(r(e)):s(e)}function i(e){return function(t){var n=h._getElementById(e,m);return n&&h._contains(t,n)?[n]:[]}}function a(e){return function(t){return p(t,e)}}function s(e){return function(t){return t.getElementsByTagName(e)}}function u(e){var t=/,|\+|=|~|\[|\]|:|>|\||\$|\^|\*|\(|\)|[\w-]+\.[\w-]+|[\w-]+#[\w-]+/;return!e.match(t)}function l(t,r){var i,a,s,c,d="string"==typeof t,f=r!==undefined?l(r):(c=1)&&[m],g=f.length;if(t){if(d){if(t=w(t),c)if("body"===t)i=[m.body];else if(E.test(t))i=T(p(m,RegExp.$1));else if(k.test(t))s=h._getElementById(RegExp.$2,m),i=s&&s.nodeName.toLowerCase()===RegExp.$1?[s]:[];else if(_.test(t))s=h._getElementById(t.substr(1),m),i=s?[s]:[];else if(N.test(t))i=T(m.getElementsByTagName(t));else if(u(t)){var v,b,C,I=t.split(/\s+/),O=f;for(a=0,v=I.length;a<v;a++)I[a]=o(I[a]);for(a=0,v=I.length;a<v;a++){var D,A=I[a],M=[];for(b=0,C=O.length;b<C;b++)D=A(O[b]),M.push.apply(M,T(D));if(O=M,!O.length)break}i=O&&O.length>1?h.unique(O):O}if(!i){for(i=[],a=0;a<g;a++)x.apply(i,h._selectInternal(t,f[a]));i.length>1&&g>1&&h.unique(i)}}else if(i=t.nodeType||e.isWindow(t)?[t]:t.getDOMNodes?t.getDOMNodes():y(t)?t:S(t)?T(t):[t],!c){var R,L=i,P=L.length;for(i=[],a=0;a<P;a++)for(R=0;R<g;R++)if(h._contains(f[R],L[a])){i.push(L[a]);break}}}else i=[];return i.each=n,i}function c(e,t){var n=e&&d(e,"class");return n&&(n=n.replace(/[\r\t\n]/g,C))&&(C+n+C).indexOf(C+t+C)>-1}function d(e,t){var n=e&&e.getAttributeNode(t);return n&&n.specified?n.nodeValue:undefined}function f(e,t){return"*"===t||e.nodeName.toLowerCase()===t.toLowerCase()}var p,h=t("./api"),m=e.Env.host.document,g=m.documentElement,v=g.matches||g.webkitMatchesSelector||g.mozMatchesSelector||g.oMatchesSelector||g.msMatchesSelector,b="getElementsByClassName"in m,y=e.isArray,T=e.makeArray,S=h.isDomNodeList,C=" ",x=Array.prototype.push,E=/^\.([\w-]+)$/,_=/^#([\w-]+)$/,N=/^([\w-])+$/,k=/^([\w-]+)#([\w-]+)$/,I=/^(?:#([\w-]+))?\s*([\w-]+|\*)?\.?([\w-]+)?$/,w=e.trim;return p=b?function(e,t){return e.getElementsByClassName(t)}:function(e,t){var n,r,o=[],i=e.getElementsByTagName("*");for(t=" "+t+" ",n=0;n<i.length;n++)r=i[n],(" "+(r.className||r.getAttribute("class"))+" ").indexOf(t)>-1&&o.push(r);return o},e.mix(h,{"_compareNodeOrder":function(e,t){return e.compareDocumentPosition&&t.compareDocumentPosition?4&e.compareDocumentPosition(t)?-1:1:e.compareDocumentPosition?-1:1},"_getElementsByTagName":function(e,t){return T(t.querySelectorAll(e))},"_getElementById":function(e,t){return t.getElementById(e)},"_getSimpleAttr":d,"_isTag":f,"_hasSingleClass":c,"_matchesInternal":function(e,t){for(var n,r=[],o=0,i=t.length;o<i;o++)n=t[o],v.call(n,e)&&r.push(n);return r},"_selectInternal":function(e,t){return T(t.querySelectorAll(e))},"query":l,"get":function(e,t){return l(e,t)[0]||null},"unique":function(){function e(e,n){return e===n?(t=!0,0):h._compareNodeOrder(e,n)}var t,n=!0;return[0,0].sort(function(){return n=!1,0}),function(r){if(t=n,r.sort(e),t)for(var o=1,i=r.length;o<i;)r[o]===r[o-1]?(r.splice(o,1),--i):o++;return r}}(),"filter":function(t,n,r){var o,i,a,s,u=l(t,r);return"string"==typeof n&&(n=w(n))&&(a=I.exec(n))&&(o=a[1],i=a[2],s=a[3],o?!o||i||s||(n=function(e){return d(e,"id")===o}):n=function(e){var t=!0,n=!0;return i&&(t=f(e,i)),s&&(n=c(e,s)),n&&t}),"function"==typeof n?e.filter(u,n):h._matchesInternal(n,u)},"test":function(e,t,n){var r=l(e,n);return r.length&&h.filter(r,t,n).length===r.length}}),h}),KISSY.add("dom/base/traversal",["./api"],function(e,t){function n(t,n,o,s,u,l,c){if(!(t=i.get(t)))return null;if(0===n)return t;if(l||(t=t[o]),!t)return null;u=u&&i.get(u)||null,n===undefined&&(n=1);var d,f,p=[],h=e.isArray(n);for("number"==typeof n&&(d=0,f=n,n=function(){return++d===f});t&&t!==u&&(!(t.nodeType===a.ELEMENT_NODE||t.nodeType===a.TEXT_NODE&&c)||!r(t,n)||s&&!s(t)||(p.push(t),h));)t=t[o];return h?p:p[0]||null}function r(t,n){if(!n)return!0;if(e.isArray(n)){var r,o=n.length;if(!o)return!0;for(r=0;r<o;r++)if(i.test(t,n[r]))return!0}else if(i.test(t,n))return!0;return!1}function o(t,n,r,o){var s,u,l,c=[],d=i.get(t),f=d;if(d&&r&&(f=d.parentNode),f){for(s=e.makeArray(f.childNodes),u=0;u<s.length;u++)l=s[u],(o||l.nodeType===a.ELEMENT_NODE)&&l!==d&&c.push(l);n&&(c=i.filter(c,n))}return c}var i=t("./api"),a=i.NodeType;return e.mix(i,{"_contains":function(e,t){return!!(16&e.compareDocumentPosition(t))},"closest":function(e,t,r,o){return n(e,t,"parentNode",function(e){return e.nodeType!==a.DOCUMENT_FRAGMENT_NODE},r,!0,o)},"parent":function(e,t,r){return n(e,t,"parentNode",function(e){return e.nodeType!==a.DOCUMENT_FRAGMENT_NODE},r,undefined)},"first":function(e,t,r){var o=i.get(e);return n(o&&o.firstChild,t,"nextSibling",undefined,undefined,!0,r)},"last":function(e,t,r){var o=i.get(e);return n(o&&o.lastChild,t,"previousSibling",undefined,undefined,!0,r)},"next":function(e,t,r){return n(e,t,"nextSibling",undefined,undefined,undefined,r)},"prev":function(e,t,r){return n(e,t,"previousSibling",undefined,undefined,undefined,r)},"siblings":function(e,t,n){return o(e,t,!0,n)},"children":function(e,t){return o(e,t,undefined)},"contents":function(e,t){return o(e,t,undefined,1)},"contains":function(e,t){return e=i.get(e),t=i.get(t),!(!e||!t)&&i._contains(e,t)},"index":function(t,n){var r,o,s=i.query(t),u=0,l=s[0];if(!n){if(!l||!l.parentNode)return-1;for(r=l;r=r.previousSibling;)r.nodeType===a.ELEMENT_NODE&&u++;return u}return o=i.query(n),"string"==typeof n?e.indexOf(l,o):e.indexOf(o[0],s)},"equals":function(e,t){if(e=i.query(e),t=i.query(t),e.length!==t.length)return!1;for(var n=e.length;n>=0;n--)if(e[n]!==t[n])return!1;return!0}}),i}),KISSY.add("dom/base",["./base/api","./base/attr","./base/class","./base/create","./base/data","./base/insertion","./base/offset","./base/style","./base/selector","./base/traversal"],function(e,t){var n=t("./base/api");return t("./base/attr"),t("./base/class"),t("./base/create"),t("./base/data"),t("./base/insertion"),t("./base/offset"),t("./base/style"),t("./base/selector"),t("./base/traversal"),e.mix(e,{"DOM":n,"get":n.get,"query":n.query}),n});KISSY.add("event/dom/base/utils",["dom"],function(e,t){var n=t("dom"),r="ksEventTargetId_"+e.now(),o=e.Env.host.document;return{"simpleAdd":o&&o.addEventListener?function(e,t,n,r){e.addEventListener&&e.addEventListener(t,n,!!r)}:function(e,t,n){e.attachEvent&&e.attachEvent("on"+t,n)},"simpleRemove":o&&o.removeEventListener?function(e,t,n,r){e.removeEventListener&&e.removeEventListener(t,n,!!r)}:function(e,t,n){e.detachEvent&&e.detachEvent("on"+t,n)},"data":function(e,t){return n.data(e,r,t)},"removeData":function(e){return n.removeData(e,r)}}}),KISSY.add("event/dom/base/special",[],function(){return{}}),KISSY.add("event/dom/base/observer",["event/base","./special"],function(e,t){function n(e){n.superclass.constructor.call(this,e)}var r=t("event/base"),o=t("./special");return e.extend(n,r.Observer,{"keys":["fn","filter","data","context","originalType","groups","last"],"notifyInternal":function(e,t){var n,r,i,a,s=this,u=e.type;return(a=s.originalType)?e.type=a:a=u,(n=o[a])&&n.handle?(r=n.handle(e,s,t))&&r.length>0&&(i=r[0]):i=s.simpleNotify(e,t),!1===i&&e.halt(),e.type=u,i}}),n}),KISSY.add("event/dom/base/object",["event/base"],function(e,t){function n(){return s}function r(){return u}function o(t){var i=this,s=t.type;o.superclass.constructor.call(i),i.originalEvent=t;var d=r;"defaultPrevented"in t?d=t.defaultPrevented?n:r:"getPreventDefault"in t?d=t.getPreventDefault()?n:r:"returnValue"in t&&(d=t.returnValue===u?n:r),i.isDefaultPrevented=d;var f,p,h=[],m=l.concat();for(e.each(c,function(e){return s.match(e.reg)&&(m=m.concat(e.props),e.fix&&h.push(e.fix)),undefined}),f=m.length;f;)p=m[--f],i[p]=t[p];for(i.target||(i.target=t.srcElement||a),3===i.target.nodeType&&(i.target=i.target.parentNode),f=h.length;f;)(0,h[--f])(i,t)}var i=t("event/base"),a=e.Env.host.document,s=!0,u=!1,l=["altKey","bubbles","cancelable","ctrlKey","currentTarget","eventPhase","metaKey","shiftKey","target","timeStamp","view","type"],c=[{"reg":/^key/,"props":["char","charCode","key","keyCode","which"],"fix":function(e,t){null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e.metaKey===undefined&&(e.metaKey=e.ctrlKey)}},{"reg":/^touch/,"props":["touches","changedTouches","targetTouches"]},{"reg":/^gesturechange$/i,"props":["rotation","scale"]},{"reg":/^(mousewheel|DOMMouseScroll)$/,"props":[],"fix":function(e,t){var n,r,o,i=t.wheelDelta,a=t.axis,s=t.wheelDeltaY,u=t.wheelDeltaX,l=t.detail;i&&(o=i/120),l&&(o=-(l%3==0?l/3:l)),a!==undefined&&(a===e.HORIZONTAL_AXIS?(r=0,n=-1*o):a===e.VERTICAL_AXIS&&(n=0,r=o)),s!==undefined&&(r=s/120),u!==undefined&&(n=-1*u/120),n||r||(r=o),n!==undefined&&(e.deltaX=n),r!==undefined&&(e.deltaY=r),o!==undefined&&(e.delta=o)}},{"reg":/^mouse|contextmenu|click|mspointer|(^DOMMouseScroll$)/i,"props":["buttons","clientX","clientY","button","offsetX","relatedTarget","which","fromElement","toElement","offsetY","pageX","pageY","screenX","screenY"],"fix":function(e,t){var n,r,o,i=e.target,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=i.ownerDocument||a,r=n.documentElement,o=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||o&&o.scrollLeft||0)-(r&&r.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||o&&o.scrollTop||0)-(r&&r.clientTop||o&&o.clientTop||0)),e.which||s===undefined||(e.which=1&s?1:2&s?3:4&s?2:0),!e.relatedTarget&&e.fromElement&&(e.relatedTarget=e.fromElement===i?e.toElement:e.fromElement),e}}];return e.extend(o,i.Object,{"constructor":o,"preventDefault":function(){var e=this,t=e.originalEvent;t.preventDefault?t.preventDefault():t.returnValue=u,o.superclass.preventDefault.call(e)},"stopPropagation":function(){var e=this,t=e.originalEvent;t.stopPropagation?t.stopPropagation():t.cancelBubble=s,o.superclass.stopPropagation.call(e)}}),o}),KISSY.add("event/dom/base/observable",["event/base","dom","./special","./utils","./observer","./object"],function(e,t){function n(t){var n=this;e.mix(n,t),n.reset()}var r=t("event/base"),o=t("dom"),i=t("./special"),a=t("./utils"),s=t("./observer"),u=t("./object"),l=r.Utils,c=e.getLogger("s/event");return e.extend(n,r.Observable,{"setup":function(){var e=this,t=e.type,n=i[t]||{},r=e.currentTarget,o=a.data(r),s=o.handle;n.setup&&!1!==n.setup.call(r,t)||a.simpleAdd(r,t,s)},"constructor":n,"reset":function(){var e=this;n.superclass.reset.call(e),e.delegateCount=0,e.lastCount=0},"notify":function(e){var t,n,r,i,a,s,u,l,c,d,f=e.target,p=e.type,h=this,m=h.currentTarget,g=h.observers,v=[],b=h.delegateCount||0;if(b&&f.nodeType)for(;f!==m;){if(!0!==f.disabled||"click"!==p){var y,S,T,x={};for(l=[],a=0;a<b;a++)d=g[a],T=d.filter,S=T+"",y=x[S],y===undefined&&(y=x[S]=o.test(f,T)),y&&l.push(d);l.length&&v.push({"currentTarget":f,"currentTargetObservers":l})}f=f.parentNode||m}for(b<g.length&&v.push({"currentTarget":m,"currentTargetObservers":g.slice(b)}),a=0,u=v.length;!e.isPropagationStopped()&&a<u;++a)for(i=v[a],l=i.currentTargetObservers,t=i.currentTarget,e.currentTarget=t,s=0;!e.isImmediatePropagationStopped()&&s<l.length;s++)c=l[s],n=c.notify(e,h),!1!==r&&n!==undefined&&(r=n);return r},"fire":function(t,r){t=t||{};var a,s,l=this,d=String(l.type),f=i[d]||{},p=!1!==f.bubbles,h=l.currentTarget;if(!(f.fire&&!1===f.fire.call(h,r)||(t instanceof u||(s=t,t=new u({"currentTarget":h,"type":d,"target":h}),e.mix(t,s)),f.preFire&&!1===f.preFire.call(h,t,r)))){var m,g,v=h,b=o.getWindow(v),y=b.document,S=[],T="on"+d,x=0;do{S.push(v),v=v.parentNode||v.ownerDocument||v===y&&b}while(!r&&v&&p);v=S[x];do{t.currentTarget=v,a=n.getDomEventObservable(v,d),a&&(g=a.notify(t))!==undefined&&!1!==m&&(m=g),v[T]&&!1===v[T].call(v)&&t.preventDefault(),v=S[++x]}while(!r&&v&&!t.isPropagationStopped());if(!r&&!t.isDefaultPrevented()){try{h[d]&&!e.isWindow(h)&&(n.triggeredEvent=d,h[d]())}catch(E){c.debug("trigger action error: "+E)}n.triggeredEvent=""}return m}},"on":function(t){var n=this,r=n.observers,o=i[n.type]||{},a=t instanceof s?t:new s(t);e.Config.debug&&(a.fn||e.error("lack event handler for "+n.type)),-1===n.findObserver(a)&&(a.filter?(r.splice(n.delegateCount,0,a),n.delegateCount++):a.last?(r.push(a),n.lastCount++):r.splice(r.length-n.lastCount,0,a),o.add&&o.add.call(n.currentTarget,a))},"detach":function(e){var t,n=this,r=i[n.type]||{},o="filter"in e,a=e.filter,s=e.context,u=e.fn,c=n.currentTarget,d=n.observers,f=e.groups;if(d.length){f&&(t=l.getGroupsRe(f));var p,h,m,g,v,b=d.length;if(u||o||t){for(s=s||c,p=0,h=0,m=[];p<b;++p)g=d[p],v=g.context||c,s!==v||u&&u!==g.fn||o&&(a&&a!==g.filter||!a&&!g.filter)||t&&!g.groups.match(t)?m[h++]=g:(g.filter&&n.delegateCount&&n.delegateCount--,g.last&&n.lastCount&&n.lastCount--,r.remove&&r.remove.call(c,g));n.observers=m}else n.reset();n.checkMemory()}},"checkMemory":function(){var t,n,r=this,o=r.type,s=i[o]||{},u=r.currentTarget,l=a.data(u);l&&(t=l.observables,r.hasObserver()||(n=l.handle,s.tearDown&&!1!==s.tearDown.call(u,o)||a.simpleRemove(u,o,n),delete t[o]),e.isEmptyObject(t)&&(l.handle=null,a.removeData(u)))}}),n.triggeredEvent="",n.getDomEventObservable=function(e,t){var n,r=a.data(e);return r&&(n=r.observables),n?n[t]:null},n.getDomEventObservablesHolder=function(e,t){var n=a.data(e);return!n&&t&&a.data(e,n={}),n},n}),KISSY.add("event/dom/base/dom-event",["event/base","./utils","dom","./special","./observable","./object"],function(e,t){function n(e,t){var n,r=u[t]||{};return!e.originalType&&(n=r.typeFix)&&(e.originalType=t,t=n),t}function r(t,r,o){var i,a,s,u;o=e.merge(o),r=n(o,r),i=l.getDomEventObservablesHolder(t,1),(u=i.handle)||(u=i.handle=function(e){var t,n=e.type,r=u.currentTarget;return l.triggeredEvent===n||"undefined"==typeof KISSY?undefined:(t=l.getDomEventObservable(r,n),t?(e.currentTarget=r,e=new c(e),t.notify(e)):undefined)},u.currentTarget=t),(s=i.observables)||(s=i.observables={}),a=s[r],a||(a=s[r]=new l({"type":r,"currentTarget":t}),a.setup()),a.on(o),t=null}function o(t,r,o){o=e.merge(o);var i;r=n(o,r);var a=l.getDomEventObservablesHolder(t),s=(a||{}).observables;if(a&&s)if(r)(i=s[r])&&i.detach(o);else for(r in s)s[r].detach(o)}var i=t("event/base"),a=t("./utils"),s=t("dom"),u=t("./special"),l=t("./observable"),c=t("./object"),d=i.Utils,f={"on":function(e,t,n,o){return e=s.query(e),d.batchForType(function(e,t,n,o){var i,a,s=d.normalizeParam(t,n,o);for(t=s.type,i=e.length-1;i>=0;i--)a=e[i],r(a,t,s)},1,e,t,n,o),e},"detach":function(e,t,n,r){return e=s.query(e),d.batchForType(function(e,t,n,r){var i,a,s,u,l=d.normalizeParam(t,n,r);for(t=l.type,i=e.length-1;i>=0;i--)if(u=e[i],o(u,t,l),l.deep&&u.getElementsByTagName)for(s=u.getElementsByTagName("*"),a=s.length-1;a>=0;a--)o(s[a],t,l)},1,e,t,n,r),e},"delegate":function(e,t,n,r,o){return f.on(e,t,{"fn":r,"context":o,"filter":n})},"undelegate":function(e,t,n,r,o){return f.detach(e,t,{"fn":r,"context":o,"filter":n})},"fire":function(e,t,n,r){var o;return n=n||{},n.synthetic=1,d.splitAndRun(t,function(t){var i,a,c,f;d.fillGroupsForEvent(t,n),t=n.type;var p=u[t],h=t;for(p&&p.typeFix&&(h=p.typeFix),e=s.query(e),a=e.length-1;a>=0;a--)c=e[a],f=l.getDomEventObservable(c,h),r||f||(f=new l({"type":h,"currentTarget":c})),f&&(i=f.fire(n,r),!1!==o&&i!==undefined&&(o=i))}),o},"fireHandler":function(e,t,n){return f.fire(e,t,n,1)},"clone":function(t,n){var o,i;if(o=l.getDomEventObservablesHolder(t)){var s=a.data(t);s&&s===a.data(n)&&a.removeData(n),i=o.observables,e.each(i,function(t,o){e.each(t.observers,function(e){r(n,o,e)})})}}};return f}),KISSY.add("event/dom/base/key-codes",[],function(e){var t=e.UA,n={"MAC_ENTER":3,"BACKSPACE":8,"TAB":9,"NUM_CENTER":12,"ENTER":13,"SHIFT":16,"CTRL":17,"ALT":18,"PAUSE":19,"CAPS_LOCK":20,"ESC":27,"SPACE":32,"PAGE_UP":33,"PAGE_DOWN":34,"END":35,"HOME":36,"LEFT":37,"UP":38,"RIGHT":39,"DOWN":40,"PRINT_SCREEN":44,"INSERT":45,"DELETE":46,"ZERO":48,"ONE":49,"TWO":50,"THREE":51,"FOUR":52,"FIVE":53,"SIX":54,"SEVEN":55,"EIGHT":56,"NINE":57,"QUESTION_MARK":63,"A":65,"B":66,"C":67,"D":68,"E":69,"F":70,"G":71,"H":72,"I":73,"J":74,"K":75,"L":76,"M":77,"N":78,"O":79,"P":80,"Q":81,"R":82,"S":83,"T":84,"U":85,"V":86,"W":87,"X":88,"Y":89,"Z":90,"META":91,"WIN_KEY_RIGHT":92,"CONTEXT_MENU":93,"NUM_ZERO":96,"NUM_ONE":97,"NUM_TWO":98,"NUM_THREE":99,"NUM_FOUR":100,"NUM_FIVE":101,"NUM_SIX":102,"NUM_SEVEN":103,"NUM_EIGHT":104,"NUM_NINE":105,"NUM_MULTIPLY":106,"NUM_PLUS":107,"NUM_MINUS":109,"NUM_PERIOD":110,"NUM_DIVISION":111,"F1":112,"F2":113,"F3":114,"F4":115,"F5":116,"F6":117,"F7":118,"F8":119,"F9":120,"F10":121,"F11":122,"F12":123,"NUMLOCK":144,"SEMICOLON":186,"DASH":189,"EQUALS":187,"COMMA":188,"PERIOD":190,"SLASH":191,"APOSTROPHE":192,"SINGLE_QUOTE":222,"OPEN_SQUARE_BRACKET":219,"BACKSLASH":220,"CLOSE_SQUARE_BRACKET":221,"WIN_KEY":224,"MAC_FF_META":224,"WIN_IME":229};return n.isTextModifyingKeyEvent=function(e){var t=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||t>=n.F1&&t<=n.F12)return!1;switch(t){case n.ALT:case n.CAPS_LOCK:case n.CONTEXT_MENU:case n.CTRL:case n.DOWN:case n.END:case n.ESC:case n.HOME:case n.INSERT:case n.LEFT:case n.MAC_FF_META:case n.META:case n.NUMLOCK:case n.NUM_CENTER:case n.PAGE_DOWN:case n.PAGE_UP:case n.PAUSE:case n.PRINT_SCREEN:case n.RIGHT:case n.SHIFT:case n.UP:case n.WIN_KEY:case n.WIN_KEY_RIGHT:return!1;default:return!0}},n.isCharacterKey=function(e){if(e>=n.ZERO&&e<=n.NINE)return!0;if(e>=n.NUM_ZERO&&e<=n.NUM_MULTIPLY)return!0;if(e>=n.A&&e<=n.Z)return!0;if(t.webkit&&0===e)return!0;switch(e){case n.SPACE:case n.QUESTION_MARK:case n.NUM_PLUS:case n.NUM_MINUS:case n.NUM_PERIOD:case n.NUM_DIVISION:case n.SEMICOLON:case n.DASH:case n.EQUALS:case n.COMMA:case n.PERIOD:case n.SLASH:case n.APOSTROPHE:case n.SINGLE_QUOTE:case n.OPEN_SQUARE_BRACKET:case n.BACKSLASH:case n.CLOSE_SQUARE_BRACKET:return!0;default:return!1}},n}),KISSY.add("event/dom/base/gesture",[],function(){return{"start":"mousedown","move":"mousemove","end":"mouseup","tap":"click","singleTap":"click","doubleTap":"dblclick"}}),KISSY.add("event/dom/base/special-events",["./dom-event","./special"],function(e,t){var n=t("./dom-event"),r=t("./special"),o=e.UA,i=o.gecko?"DOMMouseScroll":"mousewheel";return e.mix(r,{"mousewheel":{"typeFix":i},"load":{"bubbles":!1},"click":{"fire":function(e){var t=this;return!e&&"checkbox"===String(t.type)&&t.click&&"input"===t.nodeName.toLowerCase()?(t.click(),!1):undefined}},"focus":{"bubbles":!1,"preFire":function(e,t){if(!t)return n.fire(this,"focusin")},"fire":function(e){var t=this;return!e&&t.ownerDocument&&t!==t.ownerDocument.activeElement&&t.focus?(t.focus(),!1):undefined}},"blur":{"bubbles":!1,"preFire":function(e,t){if(!t)return n.fire(this,"focusout")},"fire":function(e){var t=this;return!e&&t.ownerDocument&&t===t.ownerDocument.activeElement&&t.blur?(t.blur(),!1):undefined}}})}),KISSY.add("event/dom/base/mouseenter",["dom","./special"],function(e,t){var n=t("dom"),r=t("./special");e.each([{"name":"mouseenter","fix":"mouseover"},{"name":"mouseleave","fix":"mouseout"}],function(e){r[e.name]={"typeFix":e.fix,"handle":function(e,t,r){var o=e.currentTarget,i=e.relatedTarget;if(!i||i!==o&&!n.contains(o,i))return[t.simpleNotify(e,r)]}}})}),KISSY.add("event/dom/base/valuechange",["dom","./dom-event","./special"],function(e,t){function n(e){if(d.hasData(e,b)){var t=d.data(e,b);clearTimeout(t),d.removeData(e,b)}}function r(e){d.removeData(e,v),n(e)}function o(e){n(e.target)}function i(e){var t=e.value,n=d.data(e,v);t!==n&&(f.fireHandler(e,h,{"prevVal":n,"newVal":t}),d.data(e,v,t))}function a(e){d.hasData(e,b)||d.data(e,b,setTimeout(function t(){i(e),d.data(e,b,setTimeout(t,y))},y))}function s(e){var t=e.target;"focus"===e.type&&d.data(t,v,t.value),a(t)}function u(e){i(e.target)}function l(e){c(e),f.on(e,"blur",o),f.on(e,"webkitspeechchange",u),f.on(e,"mousedown keyup keydown focus",s)}function c(e){r(e),f.detach(e,"blur",o),f.detach(e,"webkitspeechchange",u),f.detach(e,"mousedown keyup keydown focus",s)}var d=t("dom"),f=t("./dom-event"),p=t("./special"),h="valuechange",m=d.nodeName,g="event/valuechange",v=g+"/history",b=g+"/poll",y=50;return p[h]={"setup":function(){var e=this,t=m(e);"input"!==t&&"textarea"!==t||l(e)},"tearDown":function(){c(this)}},f}),KISSY.add("event/dom/base",["./base/dom-event","./base/object","./base/key-codes","./base/gesture","./base/special-events","./base/mouseenter","./base/valuechange"],function(e,t){var n=t("./base/dom-event"),r=t("./base/object"),o=t("./base/key-codes"),i=t("./base/gesture"),a=t("./base/special-events");return t("./base/mouseenter"),t("./base/valuechange"),e.merge({"add":n.on,"remove":n.detach,"KeyCode":o,"Gesture":i,"Special":a,"Object":r},n)});KISSY.add("event/base/utils",[],function(e){function t(e){if(e.indexOf(".")<0)return[e,""];var t=e.match(/([^.]+)?(\..+)?$/),n=t[1],r=[n],o=t[2];return o?(o=o.split(".").sort(),r.push(o.join("."))):r.push(""),r}var n,r;return{"splitAndRun":n=function(t,n){if(e.isArray(t))return void e.each(t,n);t=e.trim(t),-1===t.indexOf(" ")?n(t):e.each(t.split(/\s+/),n)},"normalizeParam":function(n,r,o){var i=r||{};i="function"==typeof r?{"fn":r,"context":o}:e.merge(i);var a=t(n);return n=a[0],i.groups=a[1],i.type=n,i},"batchForType":function(t,r){var o=e.makeArray(arguments),i=o[2+r];i&&"object"==typeof i?e.each(i,function(e,n){var i=[].concat(o);i.splice(0,2),i[r]=n,i[r+1]=e,t.apply(null,i)}):n(i,function(e){var n=[].concat(o);n.splice(0,2),n[r]=e,t.apply(null,n)})},"fillGroupsForEvent":function(e,n){var o=t(e),i=o[1];i&&(i=r(i),n._ksGroups=i),n.type=o[0]},"getGroupsRe":r=function(e){return new RegExp(e.split(".").join(".*\\.")+"(?:\\.|$)")}}}),KISSY.add("event/base/object",[],function(e){function t(){var t=this;t.timeStamp=e.now(),t.target=undefined,t.currentTarget=undefined}var n=function(){return!1},r=function(){return!0};return t.prototype={"constructor":t,"isDefaultPrevented":n,"isPropagationStopped":n,"isImmediatePropagationStopped":n,"preventDefault":function(){this.isDefaultPrevented=r},"stopPropagation":function(){this.isPropagationStopped=r},"stopImmediatePropagation":function(){var e=this;e.isImmediatePropagationStopped=r,e.stopPropagation()},"halt":function(e){var t=this;e?t.stopImmediatePropagation():t.stopPropagation(),t.preventDefault()}},t}),KISSY.add("event/base/observer",[],function(e){function t(t){e.mix(this,t)}return t.prototype={"constructor":t,"equals":function(t){var n=this;return!!e.reduce(n.keys,function(e,r){return e&&n[r]===t[r]},1)},"simpleNotify":function(e,t){var n,r=this;return n=r.fn.call(r.context||t.currentTarget,e,r.data),r.once&&t.removeObserver(r),n},"notifyInternal":function(e,t){var n=this.simpleNotify(e,t);return!1===n&&e.halt(),n},"notify":function(e,t){var n=this,r=e._ksGroups;return!r||n.groups&&n.groups.match(r)?n.notifyInternal(e,t):undefined}},t}),KISSY.add("event/base/observable",[],function(e){function t(t){var n=this;n.currentTarget=null,e.mix(n,t),n.reset()}return t.prototype={"constructor":t,"hasObserver":function(){return!!this.observers.length},"reset":function(){this.observers=[]},"removeObserver":function(e){var t,n=this,r=n.observers,o=r.length;for(t=0;t<o;t++)if(r[t]===e){r.splice(t,1);break}n.checkMemory()},"checkMemory":function(){},"findObserver":function(e){var t,n=this.observers;for(t=n.length-1;t>=0;--t)if(e.equals(n[t]))return t;return-1}},t}),KISSY.add("event/base",["./base/utils","./base/object","./base/observer","./base/observable"],function(e,t){return{"Utils":t("./base/utils"),"Object":t("./base/object"),"Observer":t("./base/observer"),"Observable":t("./base/observable")}});KISSY.add("event/dom/shake",["event/dom/base"],function(e,t){function n(){o=undefined,d=0}function r(e){var t,n=e.accelerationIncludingGravity,r=n.x,s=n.y,u=n.z;o!==undefined&&(t=f(p(r-o),p(s-i),p(u-a)),t>l&&g(),t>c&&(d=1)),o=r,i=s,a=u}var o,i,a,s=t("event/dom/base"),u=s.Special,l=5,c=20,d=0,f=Math.max,p=Math.abs,h=e.Env.host,m="devicemotion",g=e.buffer(function(){d&&(s.fireHandler(h,"shake",{"accelerationIncludingGravity":{"x":o,"y":i,"z":a}}),n())},250);u.shake={"setup":function(){this===h&&h.addEventListener(m,r,!1)},"tearDown":function(){this===h&&(g.stop(),n(),h.removeEventListener(m,r,!1))}}});KISSY.add("event/dom/focusin",["event/dom/base"],function(e,t){var n=t("event/dom/base"),r=n.Special;return e.each([{"name":"focusin","fix":"focus"},{"name":"focusout","fix":"blur"}],function(t){function o(e){var r=e.target;return n.fire(r,t.name)}var i=e.guid("attaches_"+e.now()+"_");r[t.name]={"setup":function(){var e=this.ownerDocument||this;i in e||(e[i]=0),e[i]+=1,1===e[i]&&e.addEventListener(t.fix,o,!0)},"tearDown":function(){var e=this.ownerDocument||this;e[i]-=1,0===e[i]&&e.removeEventListener(t.fix,o,!0)}}}),n});KISSY.add("anim",["anim/base","anim/timer","anim/transition?"],function(n,i){function e(i,e,a,u,m){var g;return i.node?g=i:("string"==typeof e?(e=n.unparam(String(e),";",":"),n.each(e,function(i,a){var s=n.trim(a);s&&(e[s]=n.trim(i)),s&&s===a||delete e[a]})):e=n.clone(e),n.isPlainObject(a)?g=n.clone(a):(g={"complete":m},a&&(g.duration=a),u&&(g.easing=u)),g.node=i,g.to=e),g=n.merge(o,g,{"useTransition":n.config("anim/useTransition")}),g.useTransition&&t?(r.info("use transition anim"),new t(g)):(r.info("use js timer anim"),new s(g))}var a=i("anim/base"),s=i("anim/timer"),t=i("anim/transition?"),r=n.getLogger("s/anim"),u=a.Utils,o={"duration":1,"easing":"linear"};return n.each(["pause","resume"],function(n){e[n]=function(i,e){return null===e||"string"==typeof e||!1===e?u.pauseOrResumeQueue(i,e,n):u.pauseOrResumeQueue(i,undefined,n)}}),e.isRunning=u.isElRunning,e.isPaused=u.isElPaused,e.stop=u.stopEl,e.Easing=s.Easing,n.Anim=e,e.Q=a.Q,e});KISSY.add("anim/base/queue",["dom"],function(e,t){function n(e,t,n){t=t||a;var r,s=o.data(e,i);return s||n||o.data(e,i,s={}),s&&((r=s[t])||n||(r=s[t]=[])),r}var r,o=t("dom"),i=e.guid("ks-queue-"+e.now()+"-"),a=e.guid("ks-queue-"+e.now()+"-");return r={"queueCollectionKey":i,"queue":function(e,t,r){var o=n(e,t);return o.push(r),o},"remove":function(t,o,i){var a,s=n(t,o,1);return s&&(a=e.indexOf(i,s))>-1&&s.splice(a,1),s&&!s.length&&r.clearQueue(t,o),s},"clearQueues":function(e){o.removeData(e,i)},"clearQueue":function(t,n){n=n||a;var r=o.data(t,i);r&&delete r[n],e.isEmptyObject(r)&&o.removeData(t,i)},"dequeue":function(e,t){var o=n(e,t,1);return o&&(o.shift(),o.length||r.clearQueue(e,t)),o}}}),KISSY.add("anim/base/utils",["./queue","dom"],function(e,t){function n(t){var n=t.node,r=c.data(n,d);r||c.data(n,d,r={}),r[e.stamp(t)]=t}function r(t){var n=t.node,r=c.data(n,d);r&&(delete r[e.stamp(t)],e.isEmptyObject(r)&&c.removeData(n,d))}function o(t){var n=t.node,r=c.data(n,d);return r?!!r[e.stamp(t)]:0}function i(t){var n=t.node,r=c.data(n,f);r||c.data(n,f,r={}),r[e.stamp(t)]=t}function a(t){var n=t.node,r=c.data(n,f);r&&(delete r[e.stamp(t)],e.isEmptyObject(r)&&c.removeData(n,f))}function s(t){var n=t.node,r=c.data(n,f);return r?!!r[e.stamp(t)]:0}function u(t,n,r){var o=c.data(t,"resume"===r?f:d),i=e.merge(o);e.each(i,function(e){n!==undefined&&e.config.queue!==n||e[r]()})}var l=t("./queue"),c=t("dom"),d=e.guid("ks-anim-unqueued-"+e.now()+"-"),f=e.guid("ks-anim-paused-"+e.now()+"-");return{"saveRunningAnim":n,"removeRunningAnim":r,"isAnimPaused":s,"removePausedAnim":a,"savePausedAnim":i,"isAnimRunning":o,"isElPaused":function(t){var n=c.data(t,f);return n&&!e.isEmptyObject(n)},"isElRunning":function(t){var n=c.data(t,d);return n&&!e.isEmptyObject(n)},"pauseOrResumeQueue":u,"stopEl":function(t,n,r,o){r&&(o===undefined?l.clearQueues(t):!1!==o&&l.clearQueue(t,o));var i=c.data(t,d),a=e.merge(i);e.each(a,function(e){o!==undefined&&e.config.queue!==o||e.stop(n)})}}}),KISSY.add("anim/base",["dom","./base/utils","./base/queue","promise"],function(e,t){function n(t){var r=this;n.superclass.constructor.call(r),s.Defer(r),r.config=t;var i=t.node;e.isPlainObject(i)||(i=o.get(t.node)),r.node=r.el=i,r._backupProps={},r._propsData={}}function r(t){var n,r=t.config.complete;e.isEmptyObject(n=t._backupProps)||o.css(t.node,n),r&&r.call(t)}var o=t("dom"),i=t("./base/utils"),a=t("./base/queue"),s=t("promise"),u=e.getLogger("s/anim"),l=o.NodeType,c=e.noop,d={"toggle":1,"hide":1,"show":1};return e.extend(n,s,{"on":function(e,t){var n=this;return u.warn("please use promise api of anim instead"),"complete"===e?n.then(t):"end"===e?n.fin(t):"step"===e?n.progress(t):u.error("not supported event for anim: "+e),n},"prepareFx":c,"runInternal":function(){var t,n=this,r=n.config,a=n.node,s=n._backupProps,u=n._propsData,c=r.to,f=r.delay||0,h=r.duration;if(i.saveRunningAnim(n),e.each(c,function(t,n){e.isPlainObject(t)||(t={"value":t}),u[n]=e.mix({"delay":f,"easing":r.easing,"frame":r.frame,"duration":h},t)}),a.nodeType===l.ELEMENT_NODE){if(c.width||c.height){var p=a.style;e.mix(s,{"overflow":p.overflow,"overflow-x":p.overflowX,"overflow-y":p.overflowY}),p.overflow="hidden","inline"===o.css(a,"display")&&"none"===o.css(a,"float")&&(e.UA.ieMode<10?p.zoom=1:p.display="inline-block")}var m,g;if(g="none"===o.css(a,"display"),e.each(u,function(e,r){if(t=e.value,d[t]){if("hide"===t&&g||"show"===t&&!g)return n.stop(!0),m=!1;s[r]=o.style(a,r),"toggle"===t&&(t=g?"show":"hide"),"hide"===t?(e.value=0,s.display="none"):(e.value=o.css(a,r),o.css(a,r,0),o.show(a))}return undefined}),!1===m)return}n.startTime=e.now(),e.isEmptyObject(u)?(n.__totalTime=1e3*h,n.__waitTimeout=setTimeout(function(){n.stop(!0)},n.__totalTime)):(n.prepareFx(),n.doStart())},"isRunning":function(){return i.isAnimRunning(this)},"isPaused":function(){return i.isAnimPaused(this)},"pause":function(){var t=this;return t.isRunning()&&(t._runTime=e.now()-t.startTime,t.__totalTime-=t._runTime,i.removeRunningAnim(t),i.savePausedAnim(t),t.__waitTimeout?clearTimeout(t.__waitTimeout):t.doStop()),t},"doStop":c,"doStart":c,"resume":function(){var t=this;return t.isPaused()&&(t.startTime=e.now()-t._runTime,i.removePausedAnim(t),i.saveRunningAnim(t),t.__waitTimeout?t.__waitTimeout=setTimeout(function(){t.stop(!0)},t.__totalTime):(t.beforeResume(),t.doStart())),t},"beforeResume":c,"run":function(){var e,t=this,n=t.config.queue;return!1===n?t.runInternal():(e=a.queue(t.node,n,t),1===e.length&&t.runInternal()),t},"stop":function(e){var t,n=this,o=n.node,s=n.config.queue;if(n.isResolved()||n.isRejected())return n;if(n.__waitTimeout&&(clearTimeout(n.__waitTimeout),n.__waitTimeout=0),!n.isRunning()&&!n.isPaused())return!1!==s&&a.remove(o,s,n),n;n.doStop(e),i.removeRunningAnim(n),i.removePausedAnim(n);var u=n.defer;return e?(r(n),u.resolve([n])):u.reject([n]),!1!==s&&(t=a.dequeue(o,s))&&t[0]&&t[0].runInternal(),n}}),n.Utils=i,n.Q=a,n});KISSY.add("promise",[],function(e){function t(e){"undefined"!=typeof console&&console.error&&console.error(e)}function n(e,t,r){if(e instanceof a)f(function(){r.call(e,e[d])});else{var i=e[d],s=e[h];s?s.push([t,r]):o(i)?n(i,t,r):t&&f(function(){t.call(e,i)})}}function r(e){var t=this;if(!(t instanceof r))return new r(e);t.promise=e||new i,t.promise.defer=t}function o(e){return e&&e instanceof i}function i(e){var t=this;t[d]=e,e===undefined&&(t[h]=[],t[p]=[])}function a(e){if(e instanceof a)return e;var t=this;return i.apply(t,arguments),t[d]instanceof i&&c.error("assert.not(this.__promise_value instanceof promise) in Reject constructor"),t}function s(e,o,s){function u(e){try{return o?o.call(this,e):e}catch(n){return t(n.stack||n),new a(n)}}function l(e){try{return s?s.call(this,e):new a(e)}catch(n){return t(n.stack||n),new a(n)}}function d(e){return p?void c.error("already done at fulfilled"):e instanceof i?void c.error("assert.not(value instanceof Promise) in when"):(p=1,void f.resolve(u.call(this,e)))}var f=new r,p=0;return e instanceof i?n(e,d,function(e){if(p)return void c.error("already done at rejected");p=1,f.resolve(l.call(this,e))}):d(e),f.promise}function u(e){return!l(e)&&o(e)&&e[h]===undefined&&(!o(e[d])||u(e[d]))}function l(e){return o(e)&&e[h]===undefined&&e[d]instanceof a}var c=e.getLogger("s/promise"),d="__promise_value",f=e.setImmediate,p="__promise_progress_listeners",h="__promise_pendings";return r.prototype={"constructor":r,"resolve":function(t){var r,o=this.promise;return(r=o[h])?(o[d]=t,r=[].concat(r),o[h]=undefined,o[p]=undefined,e.each(r,function(e){n(o,e[0],e[1])}),t):null},"reject":function(e){return this.resolve(new a(e))},"notify":function(t){e.each(this.promise[p],function(e){f(function(){e(t)})})}},i.prototype={"constructor":i,"then":function(e,t,n){return n&&this.progress(n),s(this,e,t)},"progress":function(e){return this[p]&&this[p].push(e),this},"fail":function(e){return s(this,0,e)},"fin":function(e){return s(this,function(t){return e(t,!0)},function(t){return e(t,!1)})},"done":function(t,n){var r=this,o=function(t){e.log(t.stack||t,"error"),setTimeout(function(){throw t},0)};(t||n?r.then(t,n):r).fail(o)},"isResolved":function(){return u(this)},"isRejected":function(){return l(this)}},e.extend(a,i),KISSY.Defer=r,KISSY.Promise=i,i.Defer=r,e.mix(i,{"when":s,"isPromise":o,"isResolved":u,"isRejected":l,"all":function(e){var t=e.length;if(!t)return null;for(var n=new r,o=0;o<e.length;o++)!function(r,o){s(r,function(r){e[o]=r,0==--t&&n.resolve(e)},function(e){n.reject(e)})}(e[o],o);return n.promise},"async":function(e){return function(){function t(e,t){var i;try{i=o[e](t)}catch(u){return new a(u)}return i.done?i.value:s(i.value,n,r)}function n(e){return t("next",e)}function r(e){return t("throw",e)}var o=e.apply(this,arguments);return n()}}}),i});KISSY.add("anim/timer/easing",[],function(){function e(e){return e}function t(e,t,n,r){function o(e){return(3*d*e+2*f)*e+p}function i(e){return((d*e+f)*e+p)*e}function a(e){return((h*e+m)*e+g)*e}function s(e){for(var t,n,r=e,a=0;a<8;a++){if(n=i(r)-e,c(n)<l)return r;if(t=o(r),c(t)<l)break;r-=n/t}var s=1,u=0;for(r=e;s>u;){if(n=i(r)-e,c(n)<l)return r;n>0?s=r:u=r,r=(s+u)/2}return r}function u(e){return a(s(e))}var d=3*e-3*n+1,f=3*n-6*e,p=3*e,h=3*t-3*r+1,m=3*r-6*t,g=3*t;return u}var n=Math.PI,r=Math.pow,o=Math.sin,i=parseFloat,a=/^cubic-bezier\(([^,]+),([^,]+),([^,]+),([^,]+)\)$/i,s=1.70158,u={"swing":function(e){return-Math.cos(e*n)/2+.5},"easeNone":e,"linear":e,"easeIn":function(e){return e*e},"ease":t(.25,.1,.25,1),"ease-in":t(.42,0,1,1),"ease-out":t(0,0,.58,1),"ease-in-out":t(.42,0,.58,1),"ease-out-in":t(0,.42,1,.58),"toFn":function(n){var r;return(r=n.match(a))?t(i(r[1]),i(r[2]),i(r[3]),i(r[4])):u[n]||e},"easeOut":function(e){return(2-e)*e},"easeBoth":function(e){return(e*=2)<1?.5*e*e:.5*(1- --e*(e-2))},"easeInStrong":function(e){return e*e*e*e},"easeOutStrong":function(e){return 1- --e*e*e*e},"easeBothStrong":function(e){return(e*=2)<1?.5*e*e*e*e:.5*(2-(e-=2)*e*e*e)},"elasticIn":function(e){var t=.3,i=t/4;return 0===e||1===e?e:-r(2,10*(e-=1))*o(2*(e-i)*n/t)},"elasticOut":function(e){var t=.3,i=t/4;return 0===e||1===e?e:r(2,-10*e)*o(2*(e-i)*n/t)+1},"elasticBoth":function(e){var t=.45,i=t/4;return 0===e||2==(e*=2)?e:e<1?-.5*r(2,10*(e-=1))*o(2*(e-i)*n/t):r(2,-10*(e-=1))*o(2*(e-i)*n/t)*.5+1},"backIn":function(e){return 1===e&&(e-=.001),e*e*((s+1)*e-s)},"backOut":function(e){return(e-=1)*e*((s+1)*e+s)+1},"backBoth":function(e){var t=s,n=1+(t*=1.525);return(e*=2)<1?.5*e*e*(n*e-t):.5*((e-=2)*e*(n*e+t)+2)},"bounceIn":function(e){return 1-u.bounceOut(1-e)},"bounceOut":function(e){var t=7.5625;return e<1/2.75?t*e*e:e<2/2.75?t*(e-=1.5/2.75)*e+.75:e<2.5/2.75?t*(e-=2.25/2.75)*e+.9375:t*(e-=2.625/2.75)*e+.984375},"bounceBoth":function(e){return e<.5?.5*u.bounceIn(2*e):.5*u.bounceOut(2*e-1)+.5}},l=1e-6,c=Math.abs;return u}),KISSY.add("anim/timer/manager",[],function(e){var t,n,r=e.stamp,o=(e.Env.host,15);return t=function(e){return setTimeout(e,o)},n=function(e){clearTimeout(e)},{"runnings":{},"timer":null,"start":function(e){var t=this,n=r(e);t.runnings[n]||(t.runnings[n]=e,t.startTimer())},"stop":function(e){this.notRun(e)},"notRun":function(t){var n=this,o=r(t);delete n.runnings[o],e.isEmptyObject(n.runnings)&&n.stopTimer()},"pause":function(e){this.notRun(e)},"resume":function(e){this.start(e)},"startTimer":function(){var e=this;e.timer||(e.timer=t(function n(){e.runFrames()?e.stopTimer():e.timer=t(n)}))},"stopTimer":function(){var e=this,t=e.timer;t&&(n(t),e.timer=0)},"runFrames":function(){var e,t,n=this,r=n.runnings;for(e in r)r[e].frame();for(e in r){t=0;break}return t===undefined}}}),KISSY.add("anim/timer/fx",["dom"],function(e,t){function n(t,n){e.mix(t,n),t.pos=0,t.unit=t.unit||""}function r(e){n(this,e)}function o(e,t){return e.style&&null!=e.style[t]||null==s.attr(e,t,undefined,1)?0:1}function i(t,n){var r,o=e.now(),i=t.startTime,a=n.delay,s=n.duration;return r=o-i-a,r<=0?0:r>=s?1:n.easing(r/s)}var a=e.getLogger("s/aim/timer/fx"),s=t("dom");return r.prototype={"isCustomFx":0,"constructor":r,"load":function(e){n(this,e)},"frame":function(e){if(1!==this.pos){var t=this,n=t.anim,r=t.prop,o=n.node,u=t.from,l=t.propData,c=t.to;if(e===undefined&&(e=i(n,l)),t.pos=e,u!==c&&0!==e){var d=t.interpolate(u,c,t.pos);t.val=d,l.frame?l.frame.call(t,n,t):t.isCustomFx||(d===undefined?(t.pos=1,d=c,a.warn(r+" update directly ! : "+d+" : "+u+" : "+c)):d+=t.unit,t.val=d,"attr"===t.type?s.attr(o,r,d,1):s.css(o,r,d))}}},"interpolate":function(e,t,n){return"number"==typeof e&&"number"==typeof t?Math.round(1e5*(e+(t-e)*n))/1e5:undefined},"cur":function(){var e,t,n,r=this,i=r.prop,a=r.anim.node;return r.isCustomFx?a[i]||0:((e=r.type)||(e=r.type=o(a,i)?"attr":"css"),n="attr"===e?s.attr(a,i,undefined,1):s.css(a,i),isNaN(t=parseFloat(n))?n&&"auto"!==n?n:0:t)}},r.Factories={},r.FxTypes={},r.getFx=function(e){var t,n,o=r;return(t=e.fxType)?o=r.FxTypes[t]:!e.isCustomFx&&(n=r.Factories[e.prop])&&(o=n),new o(e)},r}),KISSY.add("anim/timer/short-hand",[],function(){return{"background":[],"border":["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth"],"borderBottom":["borderBottomWidth"],"borderLeft":["borderLeftWidth"],"borderTop":["borderTopWidth"],"borderRight":["borderRightWidth"],"font":["fontSize","fontWeight"],"margin":["marginBottom","marginLeft","marginRight","marginTop"],"padding":["paddingBottom","paddingLeft","paddingRight","paddingTop"]}}),KISSY.add("anim/timer/color",["./fx","./short-hand"],function(e,t){function n(e){e+="";var t;if(t=e.match(c))return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])];if(t=e.match(d))return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseInt(t[4])];if(t=e.match(f)){for(var n=1;n<t.length;n++)t[n].length<2&&(t[n]+=t[n]);return[parseInt(t[1],s),parseInt(t[2],s),parseInt(t[3],s)]}return l[e=e.toLowerCase()]?l[e]:(a.warn("only allow rgb or hex color string : "+e),[255,255,255])}function r(){r.superclass.constructor.apply(this,arguments)}var o=t("./fx"),i=t("./short-hand"),a=e.getLogger("s/anim/timer/color"),s=16,u=Math.floor,l={"black":[0,0,0],"silver":[192,192,192],"gray":[128,128,128],"white":[255,255,255],"maroon":[128,0,0],"red":[255,0,0],"purple":[128,0,128],"fuchsia":[255,0,255],"green":[0,128,0],"lime":[0,255,0],"olive":[128,128,0],"yellow":[255,255,0],"navy":[0,0,128],"blue":[0,0,255],"teal":[0,128,128],"aqua":[0,255,255]},c=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,d=/^rgba\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+),\s*([0-9]+)\)$/i,f=/^#?([0-9A-F]{1,2})([0-9A-F]{1,2})([0-9A-F]{1,2})$/i,p=["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"];return i.background.push("backgroundColor"),i.borderColor=["borderBottomColor","borderLeftColor","borderRightColor","borderTopColor"],i.border.push("borderBottomColor","borderLeftColor","borderRightColor","borderTopColor"),i.borderBottom.push("borderBottomColor"),i.borderLeft.push("borderLeftColor"),i.borderRight.push("borderRightColor"),i.borderTop.push("borderTopColor"),e.extend(r,o,{"load":function(){var e=this;r.superclass.load.apply(e,arguments),e.from&&(e.from=n(e.from)),e.to&&(e.to=n(e.to))},"interpolate":function(e,t,n){var o=r.superclass.interpolate;return 3===e.length&&3===t.length?"rgb("+[u(o(e[0],t[0],n)),u(o(e[1],t[1],n)),u(o(e[2],t[2],n))].join(", ")+")":4===e.length||4===t.length?"rgba("+[u(o(e[0],t[0],n)),u(o(e[1],t[1],n)),u(o(e[2],t[2],n)),u(o(e[3]||1,t[3]||1,n))].join(", ")+")":(a.warn("unknown value : "+e),undefined)}}),e.each(p,function(e){o.Factories[e]=r}),o.FxTypes.color=r,r}),KISSY.add("anim/timer/transform",["dom","./fx"],function(e,t){function n(t){return t=t.split(/,/),t=e.map(t,function(e){return i(e)})}function r(e){e=n(e);var t,r,o,a=e[0],s=e[1],u=e[2],l=e[3];return a*l-s*u?(t=Math.sqrt(a*a+s*s),o=(a*u+s*l)/(a*l-u*s),r=(a*l-s*u)/t,a*l<s*u&&(o=-o,t=-t)):t=r=o=0,{"translateX":i(e[4]),"translateY":i(e[5]),"rotate":i(180*Math.atan2(s,a)/Math.PI),"skewX":i(180*Math.atan(o)/Math.PI),"skewY":0,"scaleX":i(t),"scaleY":i(r)}}function o(){return{"translateX":0,"translateY":0,"rotate":0,"skewX":0,"skewY":0,"scaleX":1,"scaleY":1}}function i(e){return Math.round(1e5*parseFloat(e))/1e5}function a(t){t=t.split(")");for(var n,a,s,u=e.trim,l=-1,c=t.length-1,d=o();++l<c;)switch(n=t[l].split("("),a=u(n[0]),s=n[1],a){case"translateX":case"translateY":case"scaleX":case"scaleY":d[a]=i(s);break;case"rotate":case"skewX":case"skewY":var f=i(s);e.endsWith(s,"deg")||(f=180*f/Math.PI),d[a]=f;break;case"translate":case"translate3d":s=s.split(","),d.translateX=i(s[0]),d.translateY=i(s[1]||0);break;case"scale":s=s.split(","),d.scaleX=i(s[0]),d.scaleY=i(s[1]||s[0]);break;case"matrix":return r(s)}return d}function s(){s.superclass.constructor.apply(this,arguments)}var u=t("dom"),l=t("./fx"),c=e.Features.isTransform3dSupported()?"translate3d({translateX}px,{translateY}px,0)":"translate({translateX}px,{translateY}px)";return e.extend(s,l,{"load":function(){var e=this;s.superclass.load.apply(e,arguments),e.from=u.style(e.anim.node,"transform")||e.from,e.from&&"none"!==e.from?e.from=a(e.from):e.from=o(),e.to?e.to=a(e.to):e.to=o()},"interpolate":function(t,n,r){var o=s.superclass.interpolate,i={};return i.translateX=o(t.translateX,n.translateX,r),i.translateY=o(t.translateY,n.translateY,r),i.rotate=o(t.rotate,n.rotate,r),i.skewX=o(t.skewX,n.skewX,r),i.skewY=o(t.skewY,n.skewY,r),i.scaleX=o(t.scaleX,n.scaleX,r),i.scaleY=o(t.scaleY,n.scaleY,r),e.substitute(c+" rotate({rotate}deg) skewX({skewX}deg) skewY({skewY}deg) scale({scaleX},{scaleY})",i)}}),l.Factories.transform=s,s}),KISSY.add("anim/timer",["dom","./base","./timer/easing","./timer/manager","./timer/fx","./timer/short-hand","./timer/color","./timer/transform"],function(e,t){function n(){var t,r=this;n.superclass.constructor.apply(r,arguments),e.each(t=r.to,function(e,n){var r=l(n);n!==r&&(t[r]=t[n],delete t[n])})}var r=t("dom"),o=t("./base"),i=t("./timer/easing"),a=t("./timer/manager"),s=t("./timer/fx"),u=t("./timer/short-hand");t("./timer/color"),t("./timer/transform");var l=r._camelCase,c=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i;return e.extend(n,o,{"prepareFx":function(){var t=this,n=t.node,o=t._propsData;e.each(o,function(e){e.duration*=1e3,e.delay*=1e3,"string"==typeof e.easing&&(e.easing=i.toFn(e.easing))}),e.each(u,function(t,i){var a,s,u=o[i];u&&(s=u.value,a={},e.each(t,function(e){a[e]=r.css(n,e)}),r.css(n,i,s),e.each(a,function(t,i){i in o||(o[i]=e.merge(u,{"value":r.css(n,i)})),r.css(n,i,t)}),delete o[i])});var a,l,d,f,p,h,m,g,v,b=0;e.isPlainObject(n)&&(b=1);for(a in o){if(l=o[a],d=l.value,h={"isCustomFx":b,"prop":a,"anim":t,"fxType":l.fxType,"type":l.type,"propData":l},m=s.getFx(h),f=d,p=m.cur(),d+="",g="",v=d.match(c)){if(f=parseFloat(v[2]),(g=v[3])&&"px"!==g&&p){var y=0,S=f;do{++S,r.css(n,a,S+g),y=m.cur()}while(0===y);p*=S/y,r.css(n,a,p+g)}v[1]&&(f=("-="===v[1]?-1:1)*f+p)}h.from=p,h.to=f,h.unit=g,m.load(h),l.fx=m}},"frame":function(){var t,n,r,o=this,i=1,a=o._propsData;for(t in a){if(r=a[t],n=r.fx,n.frame(),o.isRejected()||o.isResolved())return;i&=1===n.pos}var s=e.now(),u=1e3*o.config.duration,l=Math.max(0,o.startTime+u-s),c=l/u||0,d=1-c;o.defer.notify([o,d,l]),i&&o.stop(i)},"doStop":function(e){var t,n,r,o=this,i=o._propsData;if(a.stop(o),e)for(t in i)r=i[t],(n=r.fx)&&n.frame(1)},"doStart":function(){a.start(this)}}),n.Easing=i,n.Fx=s,n});KISSY.add("anim/transition",["dom","./base"],function(e,t,n,r){function o(){return arguments[1].toUpperCase()}function i(e){if(-1!==e.indexOf("-")&&(e=e.replace(l,o)),e in f)return f[e];if(!p||e in p)f[e]={"propertyName":e,"propertyNamePrefix":""};else{for(var t,n=e.charAt(0).toUpperCase()+e.slice(1),r=0;r<d;r++){var i=c[r];t=i+n,t in p&&(f[e]={"propertyName":t,"propertyNamePrefix":i})}f[e]=f[e]||null}return f[e]}function a(e){var t="";return h.each(e,function(e,n){t&&(t+=","),t+=n+" "+e.duration+"s "+e.easing+" "+e.delay+"s"}),t}function s(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}function u(e,t,n,r,o){var i=this;if(!(i instanceof u))return new u(e,t,n,r,o);u.superclass.constructor.apply(i,arguments)}var l=/-([a-z])/gi,c=["Webkit","Moz","O","ms"],d=c.length,f={},p=document.documentElement.style,h=e,m=t("dom"),g=t("./base"),v=i("transition"),b=v.propertyName,y="linear",T={"ease":1,"linear":1,"ease-in":1,"ease-out":1,"ease-in-out":1};h.extend(u,g,{"prepareFx":function(){var t,n,r=this,o=r._propsData,a={};for(var u in o)t=o[u],"string"==typeof t.easing?h.startsWith(t.easing,"cubic-bezier")||T[t.easing]||(t.easing=y):t.easing=y,n=i(u),n?a[s(n.propertyName)]=o[u]:e.log("unsupported css property for transition anim: "+u,"error");r._propsData=a},"doStart":function(){var e=this,t=e.node,n=t.style,r=e._propsData,o=n[b],i=0,s={};h.each(r,function(e,n){var r=e.value;m.css(t,n,m.css(t,n)),s[n]=r,i=Math.max(e.duration+e.delay,i)}),-1!==o.indexOf("none")?o="":o&&(o+=","),n[b]=o+a(r),setTimeout(function(){m.css(t,s)},0),e._transitionEndTimer=setTimeout(function(){e.stop(!0)},1e3*i)},"beforeResume":function(){var e=this,t=e._propsData,n=h.merge(t),r=e._runTime/1e3;h.each(n,function(e,n){var o=r;e.delay>=o?e.delay-=o:(o-=e.delay,e.delay=0,e.duration>=o?e.duration-=o:delete t[n])})},"doStop":function(e){var t,n=this,r=n.node,o=r.style,i=n._propsData,a=[],s={};n._transitionEndTimer&&(clearTimeout(n._transitionEndTimer),n._transitionEndTimer=null),h.each(i,function(t,n){e||(s[n]=m.css(r,n)),a.push(n)}),t=h.trim(o[b].replace(new RegExp("(^|,)\\s*(?:"+a.join("|")+")\\s+[^,]+","gi"),"$1")).replace(/^,|,,|,$/g,"")||"none",o[b]=t,m.css(r,s)}}),h.mix(u,g.Statics),r.exports=u});KISSY.add("io/form-serializer",["dom"],function(e,t){function n(e){return e.replace(a,"\r\n")}var r,o=t("dom"),i=/^(?:select|textarea)/i,a=/\r?\n/g,s=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i;return r={"serialize":function(t,n){return e.param(r.getFormData(t),undefined,undefined,n||!1)},"getFormData":function(t){var r=[],a={};return e.each(o.query(t),function(t){var n=t.elements?e.makeArray(t.elements):[t];r.push.apply(r,n)}),r=e.filter(r,function(e){return e.name&&!e.disabled&&(e.checked||i.test(e.nodeName)||s.test(e.type))}),e.each(r,function(t){var r,i=o.val(t);if(null!==i){if(i=e.isArray(i)?e.map(i,n):n(i),(r=a[t.name])===undefined)return void(a[t.name]=i);e.isArray(r)||(r=a[t.name]=[r]),r.push.apply(r,e.makeArray(i))}}),a}}}),KISSY.add("io/base",["event/custom","promise"],function(e,t){function n(t){var n=t.context;delete t.context,t=e.mix(e.clone(m),t,{"deep":!0}),t.context=n||t;var r,o,i=t.type,a=t.dataType;return o=t.uri=f.resolve(t.url),t.uri.setQuery(""),"crossDomain"in t||(t.crossDomain=!t.uri.isSameOriginAs(f)),i=t.type=i.toUpperCase(),t.hasContent=!l.test(i),t.processData&&(r=t.data)&&"string"!=typeof r&&(t.data=e.param(r,undefined,undefined,t.serializeArray)),a=t.dataType=e.trim(a||"*").split(s),"cache"in t||!e.inArray(a[0],["script","jsonp"])||(t.cache=!1),t.hasContent||(t.data&&o.query.add(e.unparam(t.data)),!1===t.cache&&o.query.set("_ksTS",e.now()+"_"+e.guid())),t}function r(t){var o=this;if(!(o instanceof r))return new r(t);i.call(o),t=n(t),e.mix(o,{"responseData":null,"config":t||{},"timeoutTimer":null,"responseText":null,"responseXML":null,"responseHeadersString":"","responseHeaders":null,"requestHeaders":{},"readyState":0,"state":0,"statusText":null,"status":0,"transport":null}),i.Defer(o);var a,s;r.fire("start",{"ajaxConfig":t,"io":o}),a=h[t.dataType[0]]||h["*"],s=new a(o),o.transport=s,t.contentType&&o.setRequestHeader("Content-Type",t.contentType);var d,l=t.dataType[0],u=t.timeout,c=t.context,f=t.headers,p=t.accepts;o.setRequestHeader("Accept",l&&p[l]?p[l]+("*"===l?"":", */*; q=0.01"):p["*"]);for(d in f)o.setRequestHeader(d,f[d]);if(t.beforeSend&&!1===t.beforeSend.call(c,o,t))return o;o.readyState=1,r.fire("send",{"ajaxConfig":t,"io":o}),t.async&&u>0&&(o.timeoutTimer=setTimeout(function(){o.abort("timeout")},1e3*u));try{o.state=1,s.send()}catch(m){o.state<2?(e.log(m.stack||m,"error"),setTimeout(function(){throw m},0),o._ioReady(-1,m.message||"send error")):e.error(m)}return o}var o=t("event/custom"),i=t("promise"),a=/^(?:about|app|app\-storage|.+\-extension|file|widget)$/,s=/\s+/,d=function(e){return e},l=/^(?:GET|HEAD)$/,u=e.Env.host,c=u.location||{},f=new e.Uri(c.href),p=f&&a.test(f.getScheme()),h={},m={"type":"GET","contentType":"application/x-www-form-urlencoded; charset=UTF-8","async":!0,"serializeArray":!0,"processData":!0,"accepts":{"xml":"application/xml, text/xml","html":"text/html","text":"text/plain","json":"application/json, text/javascript","*":"*/*"},"converters":{"text":{"json":e.parseJson,"html":d,"text":d,"xml":e.parseXML}},"headers":{"X-Requested-With":"XMLHttpRequest"},"contents":{"xml":/xml/,"html":/html/,"json":/json/}};return m.converters.html=m.converters.text,e.mix(r,o.Target),e.mix(r,{"isLocal":p,"setupConfig":function(t){e.mix(m,t,{"deep":!0})},"setupTransport":function(e,t){h[e]=t},"getTransport":function(e){return h[e]},"getConfig":function(){return m}}),r}),KISSY.add("io/xhr-transport-base",["./base"],function(e,t){function n(e,t){try{return new(t||l).XMLHttpRequest}catch(n){}return undefined}function r(e,t){try{return new(t||l).ActiveXObject("Microsoft.XMLHTTP")}catch(n){}return undefined}function o(e){return u&&e instanceof u}function i(e){var t,n=e.ifModified;return n&&(t=e.uri,!1===e.cache&&(t=t.clone(),t.query.remove("_ksTS")),t=t.toString()),t}var a=t("./base"),s=e.getLogger("s/io"),d=200,l=e.Env.host,u=e.UA.ieMode>7&&l.XDomainRequest,c=204,f=404,p=1223,h={"proto":{}},m={},g={};a.__lastModifiedCached=m,a.__eTagCached=g,h.nativeXhr=l.ActiveXObject?function(e,t){return!v&&e&&u?new u:!a.isLocal&&n(e,t)||r(e,t)}:n,h.XDomainRequest_=u;var v=h.supportCORS="withCredentials"in h.nativeXhr();return e.mix(h.proto,{"sendInternal":function(){var t,n,r,a,d=this,l=d.io,u=l.config,c=d.nativeXhr,f=u.files,p=f?"post":u.type,h=u.async,b=l.mimeType,T=l.requestHeaders||{},_=l._getUrlForSend(),N=i(u);N&&((r=m[N])&&(T["If-Modified-Since"]=r),(r=g[N])&&(T["If-None-Match"]=r)),(t=u.username)?c.open(p,_,h,t,u.password):c.open(p,_,h),"withCredentials"in(n=u.xhrFields||{})&&(v||delete n.withCredentials);for(a in n)try{c[a]=n[a]}catch(C){s.error(C)}if(b&&c.overrideMimeType&&c.overrideMimeType(b),!1===T["X-Requested-With"]&&delete T["X-Requested-With"],"undefined"!=typeof c.setRequestHeader)for(a in T)c.setRequestHeader(a,T[a]);var E=u.hasContent&&u.data||null;if(f){var y=E,S={};y&&(S=e.unparam(y)),S=e.mix(S,f),E=new FormData,e.each(S,function(t,n){e.isArray(t)?e.each(t,function(e){E.append(n+(u.serializeArray?"[]":""),e)}):E.append(n,t)})}c.send(E),h&&4!==c.readyState?o(c)?(c.onload=function(){c.readyState=4,c.status=200,d._callback()},c.onerror=function(){c.readyState=4,c.status=500,d._callback()}):c.onreadystatechange=function(){d._callback()}:d._callback()},"abort":function(){this._callback(0,1)},"_callback":function(t,n){var r,l,u,h,v,b=this,T=b.nativeXhr,_=b.io,N=_.config;try{if(n||4===T.readyState)if(o(T)?(T.onerror=e.noop,T.onload=e.noop):T.onreadystatechange=e.noop,n)4!==T.readyState&&T.abort();else{r=i(N);var E=T.status;o(T)||(_.responseHeadersString=T.getAllResponseHeaders()),r&&(l=T.getResponseHeader("Last-Modified"),u=T.getResponseHeader("ETag"),l&&(m[r]=l),u&&(g[u]=u)),v=T.responseXML,v&&v.documentElement&&(_.responseXML=v);var y=_.responseText=T.responseText;if(N.files&&y){var S,C;-1!==(S=y.indexOf("<body>"))&&(C=y.lastIndexOf("</body>"),-1===C&&(C=y.length),y=y.slice(S+6,C)),_.responseText=e.unEscapeHtml(y)}try{h=T.statusText}catch(x){s.error("xhr statusText error: "),s.error(x),h=""}E||!a.isLocal||N.crossDomain?E===p&&(E=c):E=_.responseText?d:f,_._ioReady(E,h)}}catch(x){e.log(x.stack||x,"error"),setTimeout(function(){throw x},0),T.onreadystatechange=e.noop,n||_._ioReady(-1,x.message||"process error")}}}),h}),KISSY.add("io/xdr-flash-transport",["./base","dom"],function(e,t){function n(e,t,n){if(!c){c=!0;var r='<object id="'+l+'" type="application/x-shockwave-flash" data="'+e+'" width="0" height="0"><param name="movie" value="'+e+'" /><param name="FlashVars" value="yid='+t+"&uid="+n+'&host=KISSY.IO" /><param name="allowScriptAccess" value="always" /></object>',o=u.createElement("div");a.prepend(o,u.body||u.documentElement),o.innerHTML=r}}function r(e){s.info("use XdrFlashTransport for: "+e.config.url),this.io=e}var o,i=t("./base"),a=t("dom"),s=e.getLogger("s/io"),d={},l="io_swf",u=e.Env.host.document,c=!1;return e.augment(r,{"send":function(){var t=this,r=t.io,i=r.config;if(n((i.xdr||{}).src||e.Config.base+"io/assets/io.swf",1,1),!o)return void setTimeout(function(){t.send()},200);t._uid=e.guid(),d[t._uid]=t,o.send(r._getUrlForSend(),{"id":t._uid,"uid":t._uid,"method":i.type,"data":i.hasContent&&i.data||{}})},"abort":function(){o.abort(this._uid)},"_xdrResponse":function(e,t){var n,r,o=this,i=t.id,a=t.c,s=o.io;switch(a&&(r=a.responseText)&&(s.responseText=decodeURI(r)),e){case"success":n={"status":200,"statusText":"success"},delete d[i];break;case"abort":delete d[i];break;case"timeout":case"transport error":case"failure":delete d[i],n={"status":"status"in a?a.status:500,"statusText":a.statusText||e}}n&&s._ioReady(n.status,n.statusText)}}),i.applyTo=function(t,n,r){var o=n.split(".").slice(1),a=i;e.each(o,function(e){a=a[e]}),a.apply(null,r)},i.xdrReady=function(){o=u.getElementById(l)},i.xdrResponse=function(e,t){var n=d[t.uid];n&&n._xdrResponse(e,t)},r}),KISSY.add("io/sub-domain-transport",["event/dom","dom","./xhr-transport-base"],function(e,t){function n(e){var t=this,n=e.config;t.io=e,n.crossDomain=!1,s.info("use SubDomainTransport for: "+n.url)}function r(){var e=this,t=e.io.config,n=t.uri,i=n.getHostname(),a=l[i];a.ready=1,o.detach(a.iframe,"load",r,e),e.send()}var o=t("event/dom"),i=t("dom"),a=t("./xhr-transport-base"),s=e.getLogger("s/io"),d=e.Env.host.document,l={};return e.augment(n,a.proto,{"send":function(){var t,n,s=this,u=s.io.config,c=u.uri,f=c.getHostname(),p=l[f],h="/sub_domain_proxy.html";if(u.xdr&&u.xdr.subDomain&&u.xdr.subDomain.proxy&&(h=u.xdr.subDomain.proxy),p&&p.ready)return s.nativeXhr=a.nativeXhr(0,p.iframe.contentWindow),void(s.nativeXhr?s.sendInternal():e.error("document.domain not set correctly!"));p?t=p.iframe:(p=l[f]={},t=p.iframe=d.createElement("iframe"),i.css(t,{"position":"absolute","left":"-9999px","top":"-9999px"}),i.prepend(t,d.body||d.documentElement),n=new e.Uri,n.setScheme(c.getScheme()),n.setPort(c.getPort()),n.setHostname(f),n.setPath(h),t.src=n.toString()),o.on(t,"load",r,s)}}),n}),KISSY.add("io/xhr-transport",["./base","./xhr-transport-base","./xdr-flash-transport","./sub-domain-transport"],function(e,t){function n(t){return u.domain&&e.endsWith(t,u.domain)}function r(e){var t,r=e.config,o=r.crossDomain,l=this,u=r.xdr||{},f=u.subDomain=u.subDomain||{};if(l.io=e,o&&!i.supportCORS){if(n(r.uri.getHostname())&&!1!==f.proxy)return new s(e);if("flash"===String(u.use)||!c)return new a(e)}t=l.nativeXhr=i.nativeXhr(o);var p="crossDomain: "+o+", use "+(c&&t instanceof c?"XDomainRequest":"XhrTransport")+" for: "+r.url;return d.debug(p),l}var o=t("./base"),i=t("./xhr-transport-base"),a=t("./xdr-flash-transport"),s=t("./sub-domain-transport"),d=e.getLogger("s/io"),l=e.Env.host,u=l.document,c=i.XDomainRequest_;return e.augment(r,i.proto,{"send":function(){this.sendInternal()}}),o.setupTransport("*",r),o}),KISSY.add("io/script-transport",["./base"],function(e,t){function n(e){var t=e.config,n=this;return t.crossDomain?(n.io=e,o.info("use ScriptTransport for: "+t.url),n):new(r.getTransport("*"))(e)}var r=t("./base"),o=e.getLogger("s/io");return r.setupConfig({"accepts":{"script":"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},"contents":{"script":/javascript|ecmascript/},"converters":{"text":{"script":function(t){return e.globalEval(t),t}}}}),e.augment(n,{"send":function(){var t=this,n=t.io,r=n.config;t.script=e.getScript(n._getUrlForSend(),{"charset":r.scriptCharset,"success":function(){t._callback("success")},"error":function(){t._callback("error")}})},"_callback":function(e,t){var n=this,r=n.script,o=n.io;r&&(n.script=undefined,t||("error"!==e?o._ioReady(200,"success"):"error"===e&&o._ioReady(500,"script error")))},"abort":function(){this._callback(0,1)}}),r.setupTransport("script",n),r}),KISSY.add("io/jsonp",["./base"],function(e,t){var n=t("./base"),r=e.Env.host;return n.setupConfig({"jsonp":"callback","jsonpCallback":function(){return e.guid("jsonp")}}),n.on("start",function(t){var n=t.io,o=n.config,i=o.dataType;if("jsonp"===i[0]){delete o.contentType;var a,s,d=o.jsonpCallback,l="function"==typeof d?d():d,u=r[l];o.uri.query.set(o.jsonp,l),r[l]=function(t){arguments.length>1&&(t=e.makeArray(arguments)),a=[t]},n.fin(function(){if(r[l]=u,u===undefined)try{delete r[l]}catch(t){}else a&&u(a[0])}),s=o.converters,s.script=s.script||{},s.script.json=function(){if(!a)throw new Error("not call jsonpCallback: "+l);return a[0]},i.length=2,i[0]="script",i[1]="json"}}),n}),KISSY.add("io/form",["./base","dom","./form-serializer"],function(e,t){var n=t("./base"),r=t("dom"),o=t("./form-serializer"),i=e.Env.host,a=Array.prototype.slice,s=i.FormData;return n.on("start",function(t){var n,i,d,l,u,c=t.io,f=c.config,p=f.form;if(p){n=r.get(p),u=f.data;for(var h=!1,m={},g=r.query("input",n),v=0,b=g.length;v<b;v++){var T=g[v];if("file"===T.type.toLowerCase()){if(h=!0,!s)break;var _=a.call(T.files,0);m[r.attr(T,"name")]=_.length>1?_:_[0]||null}}h&&s&&(f.files=f.files||{},e.mix(f.files,m),delete f.contentType),!h||s?(l=o.getFormData(n),f.hasContent?(l=e.param(l,undefined,undefined,f.serializeArray),u?f.data+="&"+l:f.data=l):f.uri.query.add(l)):(d=f.dataType,i=d[0],"*"===i&&(i="text"),d.length=2,d[0]="iframe",d[1]=i)}}),n}),KISSY.add("io/iframe-transport",["dom","./base","event/dom"],function(e,t){function n(t){var n,r=e.guid("io-iframe"),o=a.getEmptyIframeSrc();return n=t.iframe=a.create("<iframe "+(o?' src="'+o+'" ':"")+' id="'+r+'" name="'+r+'" style="position:absolute;left:-9999px;top:-9999px;"/>'),a.prepend(n,u.body||u.documentElement),n}function r(t,n,r){var o,i,s,d,l=[];return e.each(t,function(t,c){for(o=e.isArray(t),i=e.makeArray(t),s=0;s<i.length;s++)d=u.createElement("input"),d.type="hidden",d.name=c+(o&&r?"[]":""),d.value=i[s],a.append(d,n),l.push(d)}),l}function o(e){a.remove(e)}function i(e){this.io=e,l.info("use IframeTransport for: "+e.config.url)}var a=t("dom"),s=t("./base"),d=t("event/dom"),l=e.getLogger("s/io"),u=e.Env.host.document,c=500,f=e.clone(s.getConfig().converters.text);return f.json=function(t){return e.parseJson(e.unEscapeHtml(t))},s.setupConfig({"converters":{"iframe":f,"text":{"iframe":function(e){return e}},"xml":{"iframe":function(e){return e}}}}),e.augment(i,{"send":function(){function t(){d.on(i,"load error",l._callback,l),p.submit()}var o,i,s,l=this,u=l.io,c=u.config,f=c.data,p=a.get(c.form);l.attrs={"target":a.attr(p,"target")||"","action":a.attr(p,"action")||"","encoding":a.attr(p,"encoding"),"enctype":a.attr(p,"enctype"),"method":a.attr(p,"method")},l.form=p,i=n(u),a.attr(p,{"target":i.id,"action":u._getUrlForSend(),"method":"post","enctype":"multipart/form-data","encoding":"multipart/form-data"}),f&&(s=e.unparam(f)),s&&(o=r(s,p,c.serializeArray)),l.fields=o,6===e.UA.ie?setTimeout(t,0):t()},"_callback":function(t){var n,r=this,i=r.form,s=r.io,l=t.type,u=s.iframe;if(u)if("abort"===l&&6===e.UA.ie?setTimeout(function(){a.attr(i,r.attrs)},0):a.attr(i,r.attrs),o(this.fields),d.detach(u),setTimeout(function(){a.remove(u)},30),s.iframe=null,"load"===l)try{n=u.contentWindow.document,n&&n.body&&(s.responseText=a.html(n.body),e.startsWith(s.responseText,"<?xml")&&(s.responseText=undefined)),n&&n.XMLDocument?s.responseXML=n.XMLDocument:s.responseXML=n,n?s._ioReady(200,"success"):s._ioReady(c,"parser error")}catch(f){s._ioReady(c,"parser error")}else"error"===l&&s._ioReady(c,"error")},"abort":function(){this._callback({"type":"abort"})}}),s.setupTransport("iframe",i),s}),KISSY.add("io/methods",["promise","./base"],function(e,t){function n(t){var n,r,o,i=t.responseText,a=t.responseXML,s=t.config,d=s.converters,l=s.contents,u=s.dataType;if(i||a){for(r=t.mimeType||t.getResponseHeader("Content-Type");"*"===u[0];)u.shift();if(!u.length)for(n in l)if(l[n].test(r)){u[0]!==n&&u.unshift(n);break}u[0]=u[0]||"text";for(var c=0;c<u.length;c++){if("text"===u[c]&&i!==undefined){o=i;break}if("xml"===u[c]&&a!==undefined){o=a;break}}if(!o){var f={"text":i,"xml":a};e.each(["text","xml"],function(e){var t=u[0];return d[e]&&d[e][t]&&f[e]?(u.unshift(e),o="text"===e?i:a,!1):undefined})}}for(var p=u[0],h=1;h<u.length;h++){n=u[h];var m=d[p]&&d[p][n];if(!m)throw new Error("no covert for "+p+" => "+n);o=m(o),p=n}t.responseData=o}var r=t("promise"),o=t("./base"),i=304,a=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm;e.extend(o,r,{"setRequestHeader":function(e,t){var n=this;return n.requestHeaders[e]=t,n},"getAllResponseHeaders":function(){var e=this;return 2===e.state?e.responseHeadersString:null},"getResponseHeader":function(e){var t,n,r=this;if(e=e.toLowerCase(),2===r.state){if(!(n=r.responseHeaders))for(n=r.responseHeaders={};t=a.exec(r.responseHeadersString);)n[t[1].toLowerCase()]=t[2];t=n[e]}return t===undefined?null:t},"overrideMimeType":function(e){var t=this;return t.state||(t.mimeType=e),t},"abort":function(e){var t=this;return e=e||"abort",t.transport&&t.transport.abort(e),t._ioReady(0,e),t},"getNativeXhr":function(){var e=this.transport;return e?e.nativeXhr:null},"_ioReady":function(t,r){var a=this;if(2!==a.state){a.state=2,a.readyState=4;var s;if(t>=200&&t<300||t===i)if(t===i)r="not modified",s=!0;else try{n(a),r="success",s=!0}catch(g){e.log(g.stack||g,"error"),setTimeout(function(){throw g},0),r=g.message||"parser error"}else t<0&&(t=0);a.status=t,a.statusText=r;var d,l=a.defer,u=a.config;(d=a.timeoutTimer)&&(clearTimeout(d),a.timeoutTimer=0);var c,f=s?"success":"error",p=[a.responseData,r,a],h=u.context,m={"ajaxConfig":u,"io":a};(c=u[f])&&c.apply(h,p),(c=u.complete)&&c.apply(h,p),o.fire(f,m),o.fire("complete",m),l[s?"resolve":"reject"](p)}},"_getUrlForSend":function(){var t=this.config,n=t.uri,r=e.Uri.getComponents(t.url).query||"";return n.toString.call(n,t.serializeArray)+(r?(n.query.has()?"&":"?")+r:r)}})}),KISSY.add("io",["io/form-serializer","io/base","io/xhr-transport","io/script-transport","io/jsonp","io/form","io/iframe-transport","io/methods"],function(e,t){function n(e,t,n,r,i){return"function"==typeof t&&(r=n,n=t,t=undefined),o({"type":i||"get","url":e,"data":t,"success":n,"dataType":r})}var r=t("io/form-serializer"),o=t("io/base");return t("io/xhr-transport"),t("io/script-transport"),t("io/jsonp"),t("io/form"),t("io/iframe-transport"),t("io/methods"),e.mix(o,{"serialize":r.serialize,"get":n,"post":function(e,t,r,o){return"function"==typeof t&&(o=r,r=t,t=undefined),n(e,t,r,o,"post")},"jsonp":function(e,t,r){return"function"==typeof t&&(r=t,t=undefined),n(e,t,r,"jsonp")},"getScript":e.getScript,"getJSON":function(e,t,r){return"function"==typeof t&&(r=t,t=undefined),n(e,t,r,"json")},"upload":function(e,t,n,r,i){return"function"==typeof n&&(i=r,r=n,n=undefined),o({"url":e,"type":"post","dataType":i,"form":t,"data":n,"success":r})}}),e.mix(e,{"Ajax":o,"IO":o,"ajax":o,"io":o,"jsonp":o.jsonp}),o});KISSY.add("event/custom/observer",["event/base"],function(e,t){function n(){n.superclass.constructor.apply(this,arguments)}var r=t("event/base");return e.extend(n,r.Observer,{"keys":["fn","context","groups"]}),n}),KISSY.add("event/custom/object",["event/base"],function(e,t){function n(t){n.superclass.constructor.call(this),e.mix(this,t)}var r=t("event/base");return e.extend(n,r.Object),n}),KISSY.add("event/custom/observable",["event/base","./observer","./object"],function(e,t){function n(){var e=this;n.superclass.constructor.apply(e,arguments),e.defaultFn=null,e.defaultTargetOnly=!1,e.bubbles=!0}var r=t("event/base"),o=t("./observer"),i=t("./object"),a=r.Utils;return e.extend(n,r.Observable,{"on":function(t){var n=new o(t);e.Config.debug&&(n.fn||e.error("lack event handler for "+this.type)),-1===this.findObserver(n)&&this.observers.push(n)},"fire":function(e){e=e||{};var t,n,r,o,a,s=this,u=s.bubbles,l=s.currentTarget,c=s.type,d=s.defaultFn,f=e;if(e.type=c,f instanceof i||(f.target=l,f=new i(f)),f.currentTarget=l,a=s.notify(f),!1!==o&&a!==undefined&&(o=a),u&&!f.isPropagationStopped())for(t=l.getTargets(),n=t&&t.length||0,r=0;r<n&&!f.isPropagationStopped();r++)a=t[r].fire(c,f),!1!==o&&a!==undefined&&(o=a);if(d&&!f.isDefaultPrevented()){var p=f.target,h=p.getCustomEventObservable(f.type);(s.defaultTargetOnly||h.defaultTargetOnly)&&l!==p||(o=d.call(l,f))}return o},"notify":function(e){var t,n,r,o=[].concat(this.observers),i=o.length;for(r=0;r<i&&!e.isImmediatePropagationStopped();r++)t=o[r].notify(e,this),!1!==n&&t!==undefined&&(n=t);return n},"detach":function(e){var t,n=this,r=e.fn,o=e.context,i=n.currentTarget,s=n.observers,u=e.groups;if(s.length){u&&(t=a.getGroupsRe(u));var l,c,d,f,p,h=s.length;if(r||t){for(o=o||i,l=0,c=0,d=[];l<h;++l)f=s[l],p=f.context||i,(o!==p||r&&r!==f.fn||t&&!f.groups.match(t))&&(d[c++]=f);n.observers=d}else n.reset()}}}),n}),KISSY.add("event/custom/target",["event/base","./observable"],function(e,t){var n=t("event/base"),r=t("./observable"),o=n.Utils,i=o.splitAndRun,a="__~ks_bubble_targets",s="__~ks_custom_events";return{"isTarget":1,"getCustomEventObservable":function(e,t){var n,o=this,i=o.getCustomEvents();return n=i&&i[e],!n&&t&&(n=i[e]=new r({"currentTarget":o,"type":e})),n},"fire":function(e,t){var n,a=this,s=a.getTargets(),u=s&&s.length;return t=t||{},i(e,function(e){var i,s;if(o.fillGroupsForEvent(e,t),e=t.type,(s=a.getCustomEventObservable(e))||u){if(s){if(!s.hasObserver()&&!s.defaultFn&&(s.bubbles&&!u||!s.bubbles))return}else s=new r({"currentTarget":a,"type":e});i=s.fire(t),!1!==n&&i!==undefined&&(n=i)}}),n},"publish":function(t,n){var r,o=this;return i(t,function(t){r=o.getCustomEventObservable(t,!0),e.mix(r,n)}),o},"addTarget":function(t){var n=this,r=n.getTargets();return e.inArray(t,r)||r.push(t),n},"removeTarget":function(t){var n=this,r=n.getTargets(),o=e.indexOf(t,r);return-1!==o&&r.splice(o,1),n},"getTargets":function(){return this[a]||(this[a]=[])},"getCustomEvents":function(){return this[s]||(this[s]={})},"on":function(e,t,n){var r=this;return o.batchForType(function(e,t,n){var i,a=o.normalizeParam(e,t,n);e=a.type,(i=r.getCustomEventObservable(e,!0))&&i.on(a)},0,e,t,n),r},"detach":function(t,n,r){var i=this;return o.batchForType(function(t,n,r){var a,s,u=o.normalizeParam(t,n,r);t=u.type,t?(s=i.getCustomEventObservable(t,!0))&&s.detach(u):(a=i.getCustomEvents(),e.each(a,function(e){e.detach(u)}))},0,t,n,r),i}}}),KISSY.add("event/custom",["./custom/target"],function(e,t){var n=t("./custom/target");return{"Target":n,"global":e.mix({},n)}});