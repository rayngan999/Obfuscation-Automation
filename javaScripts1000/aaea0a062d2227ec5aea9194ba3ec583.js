window.lib={},window.TES_ENABLE_API_SUCCESS=!0,function(){"use strict";function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var indexB=createCommonjsModule(function(module,exports){var t;window,t=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}([function(e,t,n){function i(e){var t=[],n="";try{for(var i in e)e.hasOwnProperty(i)&&void 0!==e[i]&&t.push(i+"="+encodeURIComponent(e[i]));t.length>0&&(n=t.join("&"))}catch(e){}return n}function o(e){if("{}"===e)return{};var t,n=e.split("&"),i={};try{for(var o=0,r=n.length;o<r;o++)i[(t=n[o].split("="))[0]]=decodeURIComponent(t[1])}catch(e){}return i}n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o})},function(e,t,n){var i=n(0);function o(){}window._callbackNames=window._callbackNames||[],t.a=function(e){var t=window,n=document;if((e=e||{}).data=e.data||{},e.callback=e.callback||"callback",e.url){var r;r=e.callbackName&&-1===_callbackNames.indexOf(e.callbackName)?e.callbackName:("jsonp_"+Math.random()).replace(".",""),_callbackNames.push(r);var a=n.getElementsByTagName("head")[0];e.data[e.callback]=r;var s=Object(i.b)(e.data),c=n.createElement("script");a.appendChild(c),t[r]=function(n){a.removeChild(c),clearTimeout(c.timer),t[r]=o,e.success&&e.success(n)};var u=e.url;-1==u.indexOf("?")?u+="?":u+="&",u+=s,c.src=u,e.time&&(c.timer=setTimeout(function(){t[r]=o,a.removeChild(c),e.fail&&e.fail({message:"time out"})},e.time))}}},function(e,t,n){var i=!!(window.localStorage&&window.localStorage.setItem&&window.localStorage.getItem),o=+new Date;function r(e){try{return i&&window.localStorage.getItem(e||"xiaoerinfo")||null}catch(e){return null}}function a(e,t){try{if(!i)return null;window.localStorage.setItem(t||"xiaoerinfo",JSON.stringify(e))}catch(e){}}!function(e){try{if(!i)return null;var t=r(void 0);t=t?JSON.parse(t):{},o-t.time>864e5&&a({})}catch(e){a({})}}(),t.a={getStore:r,setStore:a}},function(module,__webpack_exports__,__webpack_require__){var _utils_store__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_utils_jsonp__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1),_utils_getCookie__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4);function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var userNick="",userId="";__webpack_exports__.a=function(params){return new Promise(function(resolve,reject){if(params.userNick&&params.userId)resolve({userNick:params.userNick,userId:params.userId});else if("true"==params.isXiaoer){var _storeData=_utils_store__WEBPACK_IMPORTED_MODULE_0__.a.getStore();if(_storeData=_storeData||{},_storeData.time)try{var info=JSON.parse(_storeData).info;userNick=info.userNick,userId=info.userId,resolve(_defineProperty({userNick:userNick},"userNick",userId))}catch(e){resolve(_defineProperty({userNick:userNick},"userNick",userId))}else{var xiaoerapi="//tes.alibaba-inc.com/api/userinfo";location>"https"&&(xiaoerapi="//tracelog.alibaba-inc.com/api/userinfo"),Object(_utils_jsonp__WEBPACK_IMPORTED_MODULE_1__.a)({url:xiaoerapi,callbackName:"xiaoercallback",success:function(e){try{var t={userNick:e.cname,userId:e.workid};_utils_store__WEBPACK_IMPORTED_MODULE_0__.a.setStore({info:t,time:+new Date}),resolve(t)}catch(e){resolve(_defineProperty({userNick:userNick},"userNick",userId))}}})}}else try{var _waitSeller=null,waitTime=+new Date,waitSeller=function(e){var t=arguments.callee;!window.g_config||window.g_config.subUserNick||window.TM&&window.TM._isLoginStatusReady&&window.TM.userInfo?e():Date.now()-waitTime<=3e4?_waitSeller=setTimeout(function(){_waitSeller=null,t(e)},500):e()};waitSeller(function(){try{userNick=window.TM&&window.TM.userInfo.nick||window.g_config&&window.g_config.subUserNick||"",userId=window.TM&&window.TM.userInfo.unb||Object(_utils_getCookie__WEBPACK_IMPORTED_MODULE_2__.a)("unb")||"",userNick=eval("'"+userNick+"'"),window.g_config&&window.g_config.subUserNick&&(userId="000000")}catch(e){}resolve({userNick:userNick,userId:userId})})}catch(e){resolve({userNick:userNick,userId:userId})}})}},function(e,t,n){var i={};t.a=function(e){var t,n,o="";if(i||(i={}),!i[e]){t=new RegExp(e+"=([^;]+)");try{o=document.cookie}catch(e){}(n=t.exec(o))&&(i[e]=n[1])}return i[e]}},function(e,t){TES.count=function(e,t,n){if(e){var i=(t=t||{}).msg||"";this.send(e,["pageinfo","count",i,t],!0,!1!==n)}}},function(e,t){TES.flowInit=function(e,t,n,i,o){e=e||0,(o=o||{}).bus_type=i,o.process_ins=n,o.node_id=t;var r=o.msg||"";this.send(e,["flow","init",r,o],!0,!0)},TES.flowNext=function(e,t,n,i,o){e=e||0,(o=o||{}).bus_type=i,o.process_ins=n,o.node_id=t;var r=o.msg||"";this.send(e,["flow","next",r,o],!0,!0)},TES.flowAction=function(e,t,n,i,o,r){if(e=e||0){t=t||0,(r=r||{}).action_id=e,r.bus_type=o,r.process_ins=i,r.node_id=n;var a=r.msg||"";this.send(t,["flow","action",a,r],!0,!0)}}},function(e,t){TES.math=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.send(e,["math",t,n])}},function(e,t){TES.time=function(e,t,n,i){isNaN(this.navigationStart)||(!isNaN(t)&&t>1552293392133&&!isNaN(n)?this.send(e,["time",t-this.navigationStart,n,i||{}]):(this._timeRecord||(this._timeRecord={}),this._timeRecord[e]=Date.now()))},TES.timeEnd=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!isNaN(this.navigationStart)&&this._timeRecord&&this._timeRecord[e]&&(this.send(e,["time",this._timeRecord[e]-this.navigationStart,Date.now()-this._timeRecord[e],t]),delete this._timeRecord[e])}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}TES.timeStamp=function(e,t,i){isNaN(this.navigationStart)||this.send(e,["timeStamp",(t&&t>1552293392133?t:Date.now())-this.navigationStart,("object"===n(t)?t:i)||{}])}},function(e,t){TES.timeFlag=function(e){this._timeFlagRecord||(this._timeFlagRecord={}),this._timeFlagRecord[e]=Date.now()},TES.timeFlagEnd=function(e,t,n){if(void 0===n||n||this._timeFlagRecord[e]){var i;t=t||{},i=n?0:Date.now()-this._timeFlagRecord[e];var o=t.module||"timeCount";delete t.module,"identifier"in t||(t.identifier=0),this.send(e,["timeCount",o,i,t],!0,!0);try{delete this._timeFlagRecord[e]}catch(e){}}},TES.recordTimeStart=function(e,t){e&&((t=t||{}).module="timeStart",this.timeFlagEnd(e,t,!0))},TES.recordTimeEnd=function(e,t){e&&((t=t||{}).module="timeEnd",this.timeFlagEnd(e,t,!0))}},function(e,t){TES.request=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(e&&-1===e.indexOf("/aplustrack/")){n.url=e;var o=n.status;delete n.status,void 0===o&&n.opt&&void 0!==n.opt.code&&(o=n.opt.code,delete n.opt.code),void 0===o&&n.res&&void 0!==n.res.status&&(o=n.res.status,delete n.res.status);var r=n.duration;delete n.duration,void 0===r&&n.opt&&void 0!==n.opt.duration&&(r=n.opt.duration,delete n.opt.duration),null===n.traceId&&delete n.traceId,this.send(t,["api",e.replace(/^(https?:)?/,"").replace(/\?.*$/,""),o,r,n],!0,!1!==i)}},TES.requestCount=function(){},TES.requestSuccess=function(e,t,n){this.request(e,"requestSuccess",t,n)},TES.requestError=TES.requestReject=TES.requestCrash=function(e,t,n){this.request(e,"requestError",t,n)}},function(e,t){TES.injectMtopHook=function(){function e(e){var t=this.options,n=this.params,i=Date.now();return e().then(function(){var e=t.retJson.ret;e instanceof Array&&(e=e.join(","));var o=-1===e.indexOf("SUCCESS");if(o||window.TES_ENABLE_API_SUCCESS){var r,a,s,c=t.retJson.code||200,u=t.retJson.responseHeaders;if("string"==typeof u){var d=u.match(/(x-eagleeye-id|eagleeye-traceid):\s*([a-z0-9]+)/);d&&(r=d[2]);var f=u.match(/status:\s*(\d+)/);f&&(c=f[1])}if(e){var l=e.split("::");a=l[0],s=l[1]}TES[o?"requestError":"requestSuccess"](n.api,{status:c,code:a,duration:Date.now()-i,msg:s,params:n.data,traceId:r,type:"mtop"})}})}var t;window.lib||(lib={}),lib.mtop&&lib.mtop.middlewares?lib.mtop.middlewares.push(e):Object.defineProperty(lib,"mtop",{set:function(n){var i;(t=n).middlewares?-1===t.middlewares.indexOf(e)&&t.middlewares.push(e):Object.defineProperty(t,"middlewares",{set:function(t){-1===(i=t).indexOf(e)&&i.push(e)},get:function(){return i}})},get:function(){return t}})}},function(e,t,n){n.r(t);var i=function(e,t){"function"==typeof requestIdleCallback?requestIdleCallback(e,{timeout:t||1e3}):setTimeout(e,0)},o=function(e){"complete"===document.readyState?e():window.addEventListener("load",e)},r=function(){var e,t="";return window.goldlog&&goldlog.spm_ab?goldlog.spm_ab.join("."):(t=document.querySelector('meta[name="spm-id"]')||document.querySelector('meta[name="data-spm"]'))&&(t=t.content)&&-1!==t.indexOf(".")?t:(e=document.body&&document.body.getAttribute("data-spm"),t&&e?t+"."+e:"")},a=void 0!==document.hidden?{hidden:"hidden",visibilityChange:"visibilitychange"}:void 0!==document.webkitHidden?{hidden:"webkitHidden",visibilityChange:"webkitvisibilitychange"}:void 0!==document.msHidden?{hidden:"msHidden",visibilityChange:"msvisibilitychange"}:void 0,s=!!a,c=function(e,t){var n;s&&document.addEventListener(a.visibilityChange,n=function(i){t&&document.removeEventListener(a.visibilityChange,n),e(!document[a.hidden])})},u=n(0);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.TES={},window.performance&&performance.timing&&0!==performance.timing.navigationStart&&(TES.navigationStart=performance.timing.navigationStart);var f=/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent),l=("file:"===location.protocol?"http:":location.protocol)+"//gm.mmstat.com/codetrack.1.3?",m=1700,p=function e(t,n){return n=n||"",t?e(--t,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".charAt(Math.floor(60*Math.random()))+n):n}(20);TES.queue=[];var h=[],g=-1!==navigator.userAgent.indexOf("WindVane"),v=function(){var e={},t=document.getElementById("J_Tes_Monitor");if(t)try{var n=t.getAttribute("exparams");n&&(e=Object(u.a)(n))}catch(e){}var i={spm:r(),client:f?"h5":"pc",token:p,ver:"5.0.37"};for(var o in e)i[o]=e[o];for(var o in window.TES_CONFIG)i[o]=window.TES_CONFIG[o];return i}();TES.getExtBaseInfoData=function(){return v},TES.updateExtBaseInfoData=function(e){for(var t in e)v[t]=e[t]};var S=navigator.connection||navigator.mozConnection||navigator.webkitConnection;S&&S.addEventListener("change",function(){v.net_t=S.type||"",v.net_et=S.effectiveType||"",navigator.onLine&&h.length&&(h.forEach(function(e){i(function(){TES._sendAplus(e)})}),h=[])}),TES._sendAplus=function(e){var t=window.goldlog&&"function"==typeof goldlog.record;if(navigator.onLine||t&&g)if(t)goldlog.record("/codetrack.1.3","EXP",e,window.TES_DISABLE_POST?"GET":"POST");else{var n=new Image;n.onload=n.onerror=function(){n=null},n.src=l+e}else h.length>200&&h.shift(),h.push(e)};var w,E=function(){for(var e=0,t=new Array(256),n=0;256!==n;++n){e=n;for(var i=8;i--;)e=1&e?-306674912^e>>>1:e>>>1;t[n]=e}return"undefined"!=typeof Int32Array?new Int32Array(t):t}();function y(e){for(var t,n,i=-1,o=0,r=e.length;o<r;)(t=e.charCodeAt(o++))<128?i=i>>>8^E[255&(i^t)]:t<2048?i=(i=i>>>8^E[255&(i^(192|t>>6&31))])>>>8^E[255&(i^(128|63&t))]:t>=55296&&t<57344?(t=64+(1023&t),n=1023&e.charCodeAt(o++),i=(i=(i=(i=i>>>8^E[255&(i^(240|t>>8&7))])>>>8^E[255&(i^(128|t>>2&63))])>>>8^E[255&(i^(128|n>>6&15|(3&t)<<4))])>>>8^E[255&(i^(128|63&n))]):i=(i=(i=i>>>8^E[255&(i^(224|t>>12&15))])>>>8^E[255&(i^(128|t>>6&63))])>>>8^E[255&(i^(128|63&t))];return-1^i}function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e){return e?((e=e.split("\n").slice(1)).length>3&&!0===window.TES_DISABLE_POST&&(e=e.slice(0,2).concat(["...",e[e.length-1]])),e.map(function(e){return e.replace(/^\s+at\s+/g,"")}).join("^")):""}function _(e){return e?!window.TES_DISABLE_POST||e.length<1001?e:e.substr(0,997)+"...":""}function k(e,t,n,i,o){try{"string"==typeof e?TES.send("error",["jserror",e||"",_(t),n||0,i||0,b(o&&o.stack)]):TES.send("error",["jserror",e.message||"",_(e.filename),e.lineno||0,e.colno||0,b(e.error&&e.error.stack||e.stack)])}catch(e){}}function I(e){if(e)try{var t="",n=0,i=0,o="",r="";"string"==typeof e?t=e:"object"===T(e.reason)?t=e.reason.message:"string"==typeof e.message&&(t=e.message);var a=e.reason;if("object"===T(a)){if("number"==typeof a.column?(i=a.column,n=a.line):a.stack&&(s=a.stack.match(/at\s+.+:(\d+):(\d+)/))&&(n=s[1],i=s[2]),a.sourceURL)o=a.sourceURL;else if(a.stack){var s;(s=a.stack.match(/at\s+(.+):\d+:\d+/))&&(o=s[1])}a.stack&&(r=b(a.stack))}TES.send("promise",["jserror",t,_(o),n,i,r])}catch(e){}}TES._send=function(e){if(e){"[object Array]"===Object.prototype.toString.call(e)&&(e=e.join("|"));var t=["msg="+encodeURIComponent(e),"hash="+y(e)];for(var n in v.spm||"complete"===document.readyState||(v.spm=r()),v)v.hasOwnProperty(n)&&""!==v[n]&&t.push(n+"="+v[n]);this._sendAplus(t.join("&"))}},TES._sendAll=function(){var e=this;if(this.queue.length){var t=this.queue.join(";");if(window.TES_DISABLE_POST||(m=5300),t.length<m&&encodeURIComponent(encodeURIComponent(t)).length<m)return this.queue=[],void this._send(t);for(var n="";this.queue.length;){var o=this.queue[0];if(n&&((n+o).length>m||encodeURIComponent(encodeURIComponent(n+o)).length>m))break;this.queue.shift(),n+=n?";"+o:o}this._send(n),this.queue.length&&i(function(){e._sendAll()})}},TES._waitSend=function(e){this.queue.push(e.join("|")),o(function(){i(function(){TES._sendAll()})}),this._bindUnload||(c(function(e){e||TES._sendAll()}),this._bindUnload=!0)},TES.send=function(e,t,n,i){"[object Object]"!==Object.prototype.toString.call(t[t.length-1])&&t.push({}),t[t.length-1].timeStamp||(t[t.length-1].timeStamp=Date.now()),(t=(t=[e].concat(t)).map(function(e){if("object"===d(e))try{return JSON.stringify(e)}catch(e){}return"string"==typeof e?e.replace(/\|/g,"ä¸¨").replace(/;/g,"ï¼"):e})).push(1),i?this._send(t):this._waitSend(t)},TES.record=function(e,t,n,i,o,r){this.send(t,["normal",e,n,i],o,r)},TES.monitor=function(e,t,n,i,o,r){this.send(t,["monitor",e,n,i],o,r)},TES.error=function(e,t,n,i,o,r){this.send(t,["error",e,n,i],!1!==o,r)};var D=function(e){if(e)window.PromiseRejectionEvent&&e instanceof PromiseRejectionEvent?I(e):k.apply(null,arguments);else{if(window.batTrack)return;w||(w=!0,window.addEventListener("error",k),window.addEventListener("unhandledrejection",I))}},P=n(3),C=function(e){if("env"in e)return e.env;var t="prod";return function(){var e=!1;try{e=TB.environment.isDaily}catch(t){e=!!~location.host.indexOf("tmall.net")||!!~location.host.indexOf("taobao.net")}return e}()?t="daily":function(e){if("hostname"in e&&-1!==e.hostname.indexOf("pre"))return!0;var t=!1;try{t=-1!==document.getElementById("server-num").innerHTML.indexOf("pre")}catch(e){}return t}(e)&&(t="pre"),t},O=function(e){var t=0;return"isSinglePage"in e?t=e.isSinglePage:"isSingePage"in e?(t=e.isSingePage,delete e.isSingePage):location.href.match(/\#\/[^\?]*/)&&(t=1),1==t?1:0},N=function(e){var t="";if("identifier"in(e=e||{}))t=e.identifier;else if(1==O(e))try{t=location.href.match(/\#\/([^\?]*)/)[1]}catch(e){}try{t&&"0.0"!=t||"0.0"!=(t=r())&&t.split(".")[1]||(t=r())}catch(e){}return t},j=n(1),A=0,M=[],x={isDone:!1,isIng:!1},L=function(){return Date.now()};function F(e){return((e=e||{}).timeStamp||L())+A}var R=function(e){return new Promise(function(t,n){if(x.isDone)t(F(e));else if(1==x.isIng)M.push(function(){return t(F(e))});else{x.isIng=!0;var i=Date.now();Object(j.a)({url:"//t.alicdn.com/t/gettime?t="+i,callbackName:"cb"+i,success:function(n){try{A=1e3*n.time-L()}catch(e){}x.isDone=!0,x.isIng=!1,M.forEach(function(e){"function"==typeof e&&e()}),t(F(e))},fail:function(){x.isDone=!0,x.isIng=!1,t(F(e))}})}})},q=TES.updateExtBaseInfoData,B={ing:!1,done:!1},U=[],H={cache:!1,recordtime:!1,cacheQueue:[]};function G(e,t,n,i){e.addEventListener?e.addEventListener(t,i?function(){e.removeEventListener(t,n,!1),n()}:n,!1):e.attachEvent&&e.attachEvent("on"+t,function(){i&&e.detachEvent("on"+t,arguments.callee),n()})}!function(e){var t=function(){var e={},t=document.getElementById("J_Tes_Monitor")||document.getElementById("J_Monitor_BreadCrumbs");if(t)try{e=Object(u.a)(t.getAttribute("exparams"))}catch(e){}return window.setTesConfig&&(e=Object.assign({},e,window.setTesConfig)),new Promise(function(t,n){var i=e.tes_app_id||e.projectId||"";delete e.projectId,e.isSinglePage=O(e),Object(P.a)(e).then(function(n){t(Object.assign({env:C(e),client_time:Date.now(),tes_app_id:i,identifier:N(e)},n,e))})})}(),n=e.send;function i(t){var i=t[1];"[object Object]"!==Object.prototype.toString.call(i[i.length-1])&&i.push({});var o=i[i.length-1];R(o).then(function(i){try{delete o.sendType,delete o.sendParams,o.timeStamp=i}catch(e){}n.apply(e,t)})}e.initSendConfig=function(){H={cache:!!window.TES_SEND_CACHE&&window.TES_SEND_CACHE,recordtime:!!window.TES_RECORD_TIME&&window.TES_RECORD_TIME,cacheQueue:[]},window.TES_SENDCONFIG=H},e.clearCache=function(t){for(H.cache=!1;H.cacheQueue.length;){var n=H.cacheQueue.shift(),o=n.origin;try{H.recordtime&&(o[1][3].timeStamp=n.timeStamp)}catch(e){}var r=o[1];if(r[3]&&r[3].sendType){var a=r[3].sendParams;H.recordtime&&(a[1].timeStamp=n.timeStamp),e[r[3].sendType].apply(this,a)}else i(o)}},e.initBaseInfo=function(n){var o=this;t.then(function(t){for(q(t),window.extBaseInfo=e.getExtBaseInfoData(),n&&n(t),B.ing=!1,B.done=!0;U.length;){var r=U.shift(),a=r.origin;try{a[1][3].timeStamp=r.timeStamp}catch(e){}var s=a[1];if(s[3]&&s[3].sendType){var c=s[3].sendParams;c[1].timeStamp=r.timeStamp,e[s[3].sendType].apply(o,c)}else i(a)}})},e.updateExtBaseInfoData=function(e){var t,n=window.extBaseInfo||{};if(e=e||{},!Object.keys(n).length)return B.ing=!0,void this.initBaseInfo(function(n){t=Object.assign(n,e),q(t),window.extBaseInfo=t});t=Object.assign(n,e),q(t),window.extBaseInfo=t},e.send=function(e,t,n,o){var r=arguments,a=!1;try{a=!!t[3].TES_SEND_CACHE,delete t[3].TES_SEND_CACHE}catch(e){}if(!a&&H.cache)return H.cacheQueue.push({origin:r,timeStamp:Date.now()}),void(!window.extBaseInfo&&this.initBaseInfo());B.done?i(r):B.ing?U.push({origin:r,timeStamp:Date.now()}):(U.push({origin:r,timeStamp:Date.now()}),B.ing=!0,this.initBaseInfo())}}(window.TES);var W={on:G,delegate:function(e,t,n){G(e,t,function(e){var t=e||window.event,i=t.srcElement||t.target;i.getAttribute("data-tes-click")&&n(i)})}},J=[],K={getConfig:function(){return window.extBaseInfo},init:function(){this.initTime(),this.initEvent(),window.isUnloadSendPv=!0},initTime:function(){J=[{action:"enter",time:+new Date}]},initEvent:function(){var e=this._getType();W.on(document,e.eventName,function(){document[e.hidden]?J.push({action:"leave",time:+new Date}):J.push({action:"enter",time:+new Date})},!1)},_getType:function(){var e,t;return void 0!==document.hidden?(e="hidden",t="visibilitychange"):void 0!==document.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),{hidden:e,eventName:t}},getResultTime:function(){var e=0,t=0;for(J.push({action:"leave",time:+new Date});J.length>0;){var n=J.shift();if("enter"==n.action&&J.length>0){var i=J.shift();if("leave"!=i.action)for(;J.length>0&&"leave"!=(i=J.shift()).action;);e+=i.time-n.time,t++}}return this.initTime(),{timeConsum:e,count:t}},sendLast:function(){try{this.getResultTime()}catch(e){}},sendEnd:function(){}};K.init(),TES.pv=function(e){this.sendPV("start",e)},TES.pvEnd=function(e){this.sendPV("end",e)},TES.sendPV=function(e,t){e=e||"start",t=t||{};var n={};n=Object.assign({},n,t);var i=window.extBaseInfo||{};if(Object.keys(i).length&&"identifier"in t&&t.identifier&&"0.0"!=t.identifier&&this.updateExtBaseInfoData({identifier:t.identifier}),"start"!=e||null==n.autoinit||!("true"===i.loadpv||"boolean"==typeof i.loadpv&&i.loadpv)||1==i.isForceLoadPv||1!=i.isSinglePage){if("start"==e){try{n.sr=[window.screen.width,window.screen.height].join("*")}catch(e){}try{n.title=document.title.split("-")[0].replace(/(^\s+)|(\s+$)/g,"")}catch(e){}}var o=K.getResultTime();1!=i.isSinlePage||"start"!=e&&"end"!=e?"end"==e&&(n.timeConsum=o.timeConsum):"end"==e?(n.prevStopTime={timeConsum:o.timeConsum,switchCount:o.count},delete n.switchCount):n.prevStopTime=o.timeConsum,n.sendType="sendPV",n.sendParams=[e,t],this.send(e,["pageinfo","pv","",n],!0,!0)}},n(5),n(6);var $,V=function(e){for(var t=[],n=window,i=document,o=0,r=e.length;o<r;o++){var a=e[o];if(a===n||a===i)break;if(a.id){t.push("#".concat(a.id));break}a.className&&"string"==typeof a.className?t.push("."+a.className.split(/\s+/).filter(function(e){return!!e}).join(".")):t.push(a.nodeName)}return t.reverse().join(" ")},X=function(e){if("[object Array]"===Object.prototype.toString.apply(e))return V(e);for(var t=[],n=e;n;)t.push(n),n=n.parentNode;return V(t)},Q=function(e){return e.reduce(function(e,t){return e+t},0)/e.length},z=window.requestAnimationFrame||window.webkitRequestAnimationFrame,Y=window.cancelAnimationFrame||window.webkitCancelAnimationFrame,Z={};TES._fps=function(e,t){var n;z&&!Z[e]&&(Z[e]=z(function i(){var o=window.performance&&performance.now?performance.now():Date.now();if(!n)return n=o,void(Z[e]=z(i));t&&t(o-n),n=o,Z[e]=z(i)}))},TES.animFPS=function(){var e={};document.addEventListener("transitionstart",function(t){var n,o=Math.random(),r=t.target,a=[];TES._fps(o,function(e){a.length>1e3&&a.shift(),a.push(e)}),r.addEventListener("transitionend",n=function(t){r.removeEventListener("transitionend",n),Y(Z[o]),delete Z[o],a.length&&i(function(){var n=X(t.path||t.target)+"%transition%"+t.propertyName;if(!e[n]){e[n]=!0;var i=Math.floor(1e3*t.elapsedTime/(1e3/60));TES.send(n,["animFPS",(i-a.length)/i,1e3/Q(a)])}})})}),document.addEventListener("animationstart",function(t){var n,o=Math.random(),r=t.target,a=[];TES._fps(o,function(e){a.length>1e3&&a.shift(),a.push(e)}),r.addEventListener("animationend",n=function(t){r.removeEventListener("animationend",n),Y(Z[o]),delete Z[o],a.length&&i(function(){var n=X(t.path||t.target)+"%animation%"+t.animationName;if(!e[n]){e[n]=!0;var i=Math.floor(1e3*t.elapsedTime/(1e3/60));TES.send(n,["animFPS",(i-a.length)/i,1e3/Q(a)])}})})})},n(7),n(8),n(9),TES.timing=function(){this.navigationStart&&o(function(){setTimeout(function(){TES.send("timing",["perf",performance.timing])},100)})},["pointerdown","touchstart","mousedown","keydown","mouseover"].forEach(function(e){document.addEventListener(e,function(e){$=e},{capture:!0,passive:!0})});var ee=function(){return $};function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e,t){return(void 0===t||200===t)&&(void 0!==e.success?!0===e.success||"true"===e.success:void 0!==e.isSuccess?!0===e.isSuccess||"true"===e.success:void 0!==e.isOk?!0===e.isOk||"true"===e.success:void 0!==e.ok?!0===e.ok||"true"===e.success:void 0===e.status||200==e.status)}function ie(e){var t=e.msg||e.message||e.errMsg||e.errorMessage||e.sucMsg||e.subMsg||e.errorMsg||e.ret||e.errorResponse;return"object"===te(t)&&(t=t.msg||t.message||t.info||t.ret||t.code||JSON.stringify(t)),t&&t.length>50&&(t=t.substring(1,50)),t}TES.longTask=function(){if(window.PerformanceLongTaskTiming){var e=0,t=new PerformanceObserver(function(t){t.getEntries().forEach(function(t){var n=ee();i(function(){TES.send("longtask_"+e,["longtask",t.startTime,t.duration,n?X(n.path||n.target):""]),e++})})});t.observe({entryTypes:["longtask"]}),c(function(e){e?setTimeout(function(){t.observe({entryTypes:["longtask"]})},100):t.disconnect()})}},n(10),n(11);var oe=function(e,t){var n=e;if("string"==typeof n)try{n=JSON.parse(e)}catch(e){}return"object"!==te(n)?{success:void 0===t||200===t}:{msg:ie(n),success:ne(n,t)}},re=function(e,t){if(t.originResponse)return e;if("jsonp"===t.method)return e.json();var n=t.headers&&t.headers.accept||"text",i=e.headers&&e.headers.get?e.headers.get("content-type"):null;return i||(i=n),-1!==i.toLowerCase().indexOf("application/json")?e.json():-1!==i.toLowerCase().indexOf("text")?e.text():e.blob()};function ae(e){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t,n,i,o){(!1===e.success||window.TES_ENABLE_API_SUCCESS)&&TES[!1===e.success?"requestError":"requestSuccess"](t,{status:i,duration:n,traceId:o,msg:e.msg,type:"xhr"})}function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}TES.injectFetchHook=function(){if("function"==typeof window.fetch){var e=window.fetch;window.fetch=function(t,n){var i=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);if(n&&("HEAD"===n.method||"no-cors"===n.mode))return e.apply(window,i);var o=(t&&"string"!=typeof t?t.url:t)||"";if(o.match(/\.(js|css|png|jpg|gif|jpeg|webp)(\?.*)?$/))return e.apply(window,i);var r=Date.now();return e.apply(window,i).then(function(e){var t=e.clone?e.clone():e;return re(t,n||{}).then(function(e){var n=Date.now()-r;e&&"object"===ae(e)||(e={});var i,a=t.status;e=oe(e,a);try{i=t.headers.get("eagleeye-traceid")||t.headers.get("x-eagleeye-id")}catch(e){}(!1===e.success||window.TES_ENABLE_API_SUCCESS)&&TES[!1===e.success?"requestError":"requestSuccess"](o,{status:a,duration:n,traceId:i,msg:e.msg,type:"fetch"})}),e},function(e){throw TES.requestError(o,{status:0,duration:Date.now()-r,msg:e.message,type:"fetch"}),e})}}},TES.injectXhrHook=function(){if("function"==typeof window.XMLHttpRequest&&window.addEventListener){var e=window.XMLHttpRequest,t=function(t){var n,i,o=new e(t),r=o.send,a=o.open;return o.open=function(e,t){var n=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);a.apply(o,n),i=t||""},o.send=function(e){n=Date.now(),r.apply(o,arguments)},o.addEventListener("readystatechange",function(e){if(i&&4===o.readyState&&(-1===i.indexOf("api=")||-1===i.indexOf("v=")||-1===i.indexOf("jsv="))){var t,r=Date.now()-n,a=o.status;try{var s=o.getAllResponseHeaders();-1===s.indexOf("eagleeye-traceid")&&-1===s.indexOf("x-eagleeye-id")||(t=o.getResponseHeader("eagleeye-traceid")||o.getResponseHeader("x-eagleeye-id"))}catch(e){}if(o.responseType&&"text"!==o.responseType)if("blob"===o.responseType&&o.response){var c=new FileReader;c.readAsText.apply(c,[o.response]),c.onloadend=function(){se(oe(c.result,a),i,r,a,t)}}else se({success:200===a},i,r,a,t);else se(oe(o.responseText,a),i,r,a,t)}}),o};t.prototype=e.prototype,window.XMLHttpRequest=t}},n(12),TES.effective=function(e,t,n){e="object"==ce(e)?N(t=e)||"default":e||N(t)||"default";var i=(t=t||{}).msg||"";n=n||"effective",this.send(e,["effective",n,i,t],!0,!0)},TES.effectiveHandle=function(e,t){this.effective(e,t,"handle")},TES.effectiveReq=function(e,t){this.effective(e,t,"request")};var ue={};function de(e,t,n,i,o){var r=ue[e];if(r){var a=r.beforeFields,s=r.beforeObj,c={name:a,count:r.counts[a],ent:r.beforeEnterTime,module:e};if(null!==s&&"item"in s)try{c.tagType=null==r.tagMapFn?s.item.tag:r.tagMapFn.call(this,s)}catch(e){c.tagType="__error__tag"}r.fieldHadSended[a]||(c.ffst=r.initTime[a],r.fieldHadSended[a]=!0),r.formStartField||(c.isFST=1,r.formStartField=!0),n&&R().then(function(e){c.ffet=e}),n&&i&&(c.isFET=1),r.counts[a]=0,r.beforeFields=null==t||n?null:t.name,R().then(function(e){r.beforeEnterTime=e});var u={};if(null!==s)for(var d in s)-1===["item","value","name"].indexOf(d)&&(u[d]=s[d]);c=Object.assign({},o||{},u,c),r.beforeObj=t,TES.form(c.module,c)}}function fe(e,t,n){var i=ue[e];i&&(null!=i.beforeFields&&de.call(this,e,null,!0,!!t,n))}function le(){for(var e in ue)fe(e)}try{window.batIns.tes.addUnloadListener(function(){le()})}catch(e){}var me={fieldChange:function(e,t,n){null==ue[e]&&function(e){ue[e]={beforeFields:null,beforeObj:null,beforeEnterTime:0,counts:{},initTime:{},fieldHadSended:{},tagMapFn:null,lastObj:{},formStartField:!1}}.call(this,e);var i=ue[e],o=t.name;o&&(null==i.beforeFields&&(i.beforeFields=o,R().then(function(e){i.beforeEnterTime=e})),null==i.beforeObj&&(i.beforeObj=t),null==i.counts[o]?(i.counts[o]=1,R().then(function(e){i.initTime[o]=e})):i.counts[o]+=1,null==i.tagMapFn&&(i.tagMapFn=n),o!=i.beforeFields&&de.call(this,e,t))},submitField:fe,clearSubmit:le};function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}TES.form=function(e,t,n){n=n||"form";var i=(t=t||{}).msg||"";this.send(n,["effective",e,i||"",t],!0,!0)},TES.formMonitor=function(e,t,n){"object"==pe(e)?(n=t,e=N(t=e)||"default"):e=e||N(t)||"default",me.fieldChange.call(this,e,t,n||null)},TES.formSubmit=function(e,t,n){"boolean"==typeof e?(n="object"===pe(t)?t:null,t=e,e=N(n)||"default"):e=e||N(n||{})||"default",me.submitField.call(this,e,t,n||{}),TES.form(e,n||{},"formSubmit")},TES.formRequest=function(e,t,n,i){"object"==pe(e)?(i=!!n,n=t,e=N(t=e)||"default"):e=e||N(t)||"default",i&&this.formSubmit(e,!0,Object.assign({},t)),t.module=e,t.isFET=1,t.isreq=1,t.status=n,this.form(e,t,"formRequest")},TES.formError=function(e,t){e=null==e||"object"==pe(e)?N(t=e||{})||"default":e||N(t)||"default",t.module=e,this.form(e,t,"formError")},function(e){var t=function(){};window.TraceLog||(window.TraceLog={});var n=window.TraceLog;function i(e,t,i,o){var r=e,a=Object(u.a)(r.getAttribute(i)||"{}");o&&!a.id&&(a.id=+new Date,r.setAttribute(i,Object(u.b)(a)));var s="TAGSEND_"+a.id;if(-1===t.indexOf(s)){o&&t.push(s);var c=function(){var e=Object.assign({},a),t=e.type||"log",i={recordTimeStart:"timeStart",recordTimeEnd:"timeEnd"};i[t]&&(t=i[t]),delete e.type,delete e.trigger,n[t]&&n[t](e)};"trigger"in a?W.on(r,a.trigger||"click",function(){c()}):c()}}function o(e){if("refer"in e){var t=e.refer.replace(/https?\:/,"").split("?");e.tag=t[0],t[1]&&(e=Object.assign({},e,Object(u.a)(t[1]))),delete e.refer}return e}n.pv=function(t){(t=t||{}).module=t.module||"pagePv";var n="start";"endPv"==t.module&&(n="end"),e.sendPV(n,t)},n.count=function(t){t=t||{},e.count(t.module||t.id,t)},n.timeCount=function(t){e.timeFlagEnd(t.tag,t,!0)},n.timeStart=function(t){t=t||{},e.recordTimeStart(t.tag,t)},n.timeEnd=function(t){t=t||{},e.recordTimeEnd(t.tag,t)},e.tagSend=n.tagSend=function(e){!function(e,t){var n=window[e]||(window[e]=[]);if(t){var o=n.indexOf("TAGSEND_"+t);-1!==o&&n.splice(o,1)}for(var r=document.querySelectorAll("["+e+"]"),a=0,s=r.length;a<s;a++)i(r[a],n,e,!0)}("data-tracelog",e)},W.delegate(document,"click",function(e){i(e,window["data-tes-click"]||(window["data-tes-click"]=[]),"data-tes-click")}),n.request=function(e,t){switch(e){case"success":n.requestTime(t);break;case"error":n.requestError(t);break;case"crash":n.requestCrash(t)}},n.requestTime=function(t){var n={opt:{url:(t=o(t||{})).tag,duration:t.timeConsum}};n=Object.assign({},n,t),e.requestSuccess(t.tag,n)},n.requestError=function(t){var n={opt:{url:(t=o(t||{})).tag,duration:t.timeConsum}};n=Object.assign({},n,t),e.requestError(t.tag,t)},n.requestCrash=function(t){var n={opt:{url:(t=o(t||{})).tag,duration:t.timeConsum}};n=Object.assign({},n,t),e.requestCrash(t.tag,t)},n.formMointor=e.formMonitor,n.formRequest=e.formRequest,n.formSubmit=e.formSubmit,n.formError=e.formError,n.effective=function(t){var n=(t=t||{}).id,i=t.type||"";delete t.id,delete t.type,e.effective(n,t,i)},n.effectiveHandle=function(e){(e=e||{}).type="handle",n.effective(e)},n.effectiveReq=function(e){(e=e||{}).type="request",n.effective(e)},n.custom=t,n.error=t,n.log=t,n.logError=t}(window.TES),TES.eventTiming=function(){if(window.PerformanceEventTiming){var e=0,t=new PerformanceObserver(function(t){var n=t.getEntries().filter(function(e){return e.processingEnd-e.processingStart>1}).sort(function(e,t){return t.processingEnd-t.processingStart-(e.processingEnd-e.processingStart)})[0];if(n){var o=ee();i(function(){TES.send("eventTiming_"+e,["eventTiming",n.name,n.duration,n.processingEnd-n.processingStart,o?X(o.path||o.target):"",n.startTime]),e++})}});t.observe({entryTypes:["event"]}),c(function(e){e?setTimeout(function(){t.observe({entryTypes:["event"]})},100):t.disconnect()})}},TES.entries=function(e){o(function(){var t=window.performance;if(t.getEntries){var n=t.getEntries(e);n.length&&n.forEach(function(e){return TES.send("entries",["perf",e],!0)})}})},TES.jserror=D,TES.event=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.send(e,["event",t],!0,n)},D(),window.__disabledAutoInjectFetch||window.TES_DISABLE_API_INJECT||(void 0===window.TES_ENABLE_API_SUCCESS&&(window.TES_ENABLE_API_SUCCESS=!0),TES.injectFetchHook(),TES.injectXhrHook(),TES.injectMtopHook()),o(function(){TES.initSendConfig(),TES.pv({autoinit:!0});try{window.batIns.tes.addUnloadListener(function(){TES.pvEnd()})}catch(e){}TES.tagSend(),null==window.TES_SAMPLING_animFPS&&(window.TES_SAMPLING_animFPS=0),["longTask","animFPS","eventTiming","timing"].forEach(function(e){var t=.01;"timing"===e&&(t=1),void 0!==window["TES_SAMPLING_".concat(e)]?t=window["TES_SAMPLING_".concat(e)]:void 0!==window.TES_SAMPLING&&(t=window.TES_SAMPLING),Math.random()<t&&("timing"!==e||-1===navigator.userAgent.indexOf("AliApp("))&&TES[e]()})}),t.default=TES}]).default},module.exports=t()});unwrapExports(indexB);var indexB_1=indexB.TES,TimeLimit=6e4;function myParseFloat(e,t){var n=parseFloat(e)||0;return t>=0?parseFloat(n.toFixed(t)):n}function within(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=myParseFloat(e),r=!1;switch(i){case 0:r=o>t&&o<n;break;case 1:r=o>t&&o<=n;break;case 2:r=o>=t&&o<n;break;case 3:r=o>=t&&o<=n}return r}function timeWithin(e){return within(e,0,TimeLimit,1)}var classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),STATUS={PENDING:0,FULFILLED:1,REJECTED:2},Promise$1=function(){function e(t){var n=this;classCallCheck(this,e),this.status=STATUS.PENDING,this.resolveData=null,this.rejectData=null,this.onFulfilledList=[],this.onRejectedList=[],this.onResolve=function(e){n.status===STATUS.PENDING&&(n.status=STATUS.FULFILLED,n.resolveData=e,n.onFulfilledList.forEach(function(e){e(n.resolveData)}))},this.onReject=function(e){n.status===STATUS.PENDING&&(n.status=STATUS.REJECTED,n.rejectData=e,n.onRejectedList.forEach(function(e){e(n.rejectData)}))},this.resolvePromise=function(t,i,o){if(t instanceof e)t.status===STATUS.PENDING?t.then(function(e){n.resolvePromise(e,i,o)},o):t.status===STATUS.FULFILLED?i(t.resolveData):o(t.rejectData);else if(null!==t&&t instanceof Object)try{var r=t.then;r instanceof Function?r.call(t,function(e){n.resolvePromise(e,i,o)},o):i(t)}catch(e){o(e)}else i(t)};try{t(this.onResolve.bind(this),this.onReject.bind(this))}catch(e){this.onReject(e)}}return createClass(e,[{key:"then",value:function(t,n){var i=this;return this.status===STATUS.PENDING?new e(function(e,o){i.onFulfilledList.push(function(){if(t instanceof Function){var n=t(i.resolveData);i.resolvePromise(n,e,o)}else e(i.resolveData)}),i.onRejectedList.push(function(){if(n instanceof Function){var t=n(i.rejectData);i.resolvePromise(t,e,o)}else o(i.rejectData)})}):this.status===STATUS.FULFILLED?new e(function(e,n){if(t instanceof Function){var o=t(i.resolveData);i.resolvePromise(o,e,n)}else e(i.resolveData)}):new e(function(e,t){if(n instanceof Function){var o=n(i.rejectData);i.resolvePromise(o,e,t)}else t(i.rejectData)})}},{key:"catch",value:function(e){var t=this;e instanceof Function&&(this.status===STATUS.PENDING?this.onRejectedList.push(function(){null!==t.rejectData&&e(t.rejectData)}):(this.status=STATUS.REJECTED)&&null!==this.rejectData&&e(this.rejectData))}}],[{key:"resolve",value:function(t){return t instanceof e?t:new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return t instanceof e?t:new e(function(e,n){n(t)})}},{key:"all",value:function(t){if(!(t instanceof Array))throw new TypeError("parameter must be array");var n=[],i=0;return new e(function(o,r){0===t.length?o(n):t.forEach(function(a,s){a instanceof e?a.then(function(e){n[s]=e,++i===t.length&&o(n)},function(e){r(e)}):(n[s]=a,++i===t.length&&o(n))})})}},{key:"race",value:function(t){if(!(t instanceof Array))throw new TypeError("parameter must be array");var n=!1;return new e(function(i,o){t.forEach(function(t){t instanceof e?t.then(function(e){n||(n=!0,i(e))},function(e){n||(n=!0,o(e))}):n||(n=!0,i(t))})})}}]),e}();function getStyle(e,t){return window.getComputedStyle?window.getComputedStyle(e)[t]||"":e.currentStyle[t]||""}function isDebug(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:location.href;return"1"==(new RegExp("performanceDebug=([^&#]+)[&#]?").exec(e)||[])[1]}var IS_DEBUG=isDebug(),_ref=window||{},Performance=_ref.performance,MutationObserver=_ref.MutationObserver,START_TIME=Performance&&Performance.timing.navigationStart,IGNORE_TAG_SET=["SCRIPT","NOSCRIPT","STYLE","META","HEAD","LINK","svg"],TAG_WEIGHT_MAP={SVG:1.5,IMG:1.5,CANVAS:1.5,VIDEO:2},LIMIT=1e3,WW=window.innerWidth,WH=1*window.innerHeight,WAIT=500,FMPTiming=function(){function e(){classCallCheck(this,e);this.lock=!1,this.paintTag=1,this.observer=window.$KL_Performance_Observer||null,this.ptCollector=window.$KL_Performance_ptCollector||[],this.resourceMap={},MutationObserver&&Performance&&START_TIME?!this.observer&&this.initObserver():console.warn("The version of your brower too low to support this script.")}return createClass(e,[{key:"initObserver",value:function(){this.mutationCallback(),this.observer=new MutationObserver(this.mutationCallback.bind(this)),this.observer.observe(document,{childList:!0,subtree:!0})}},{key:"mutationCallback",value:function(){var e=Performance.now&&Performance.now()||Date.now()-START_TIME;document.body&&(this.tag(document.body,this.paintTag++),this.ptCollector.push(parseInt(e)))}},{key:"tag",value:function(e,t){var n=e||{},i=n.tagName,o=n.children,r=void 0===o?[]:o;if(-1===IGNORE_TAG_SET.indexOf(i)&&(null===e.getAttribute("_pi")&&e.setAttribute("_pi",t),r.length>0))for(var a=r.length-1;a>=0;a--)this.tag(r[a],t)}},{key:"getFMP",value:function(){var e=this;return new Promise$1(function(t){var n=e;"complete"===document.readyState?setTimeout(function(){t(n.calculate())},n.prepareWait()):window.addEventListener("load",function(){return n.getFMP()},!0)})}},{key:"prepareWait",value:function(){var e=Date.now()-START_TIME,t=this.ptCollector.length;return t>0&&(e>LIMIT||e-this.ptCollector[t-1]>500)?WAIT:0}},{key:"calculate",value:function(){var e={},t=-1,n="";if(MutationObserver&&!this.lock){this.observer.disconnect(),this.lock=!0;var i=this.deepTraversal(document.body),o={};if(i.deeplink&&i.deeplink.forEach(function(e){o&&o.score?o.score<e.score&&(o=e):o=e}),o.elements){this.resourceMap=this.initResourceMap(),t=(e=this.scoring(o.elements)).fmpT;var r=e.target.node,a=r.id,s=void 0===a?"":a,c=r.className,u=void 0===c?"":c,d=r.tagName;n=(void 0===d?"":d)+"#"+s+"."+(u.replace&&u.replace(/\s/g,"."))+"[pi="+e.target.paintIndex+"]"}IS_DEBUG&&(console.group("FMP ç¸å³ä¿¡æ¯ï¼æ´å¤ä¿¡æ¯è¯·åè§ http://seven-kl.netease.com/docs/fe-monitor/"),console.log("FMP",t),console.log("FMPD",n),console.log("FMP target",e.target),console.log("FMP target elements",o.elements),console.log("FMP material",i),console.log("FMP ptCollector",this.ptCollector),console.groupEnd())}return{fmpT:t,fmpD:n}}},{key:"deepTraversal",value:function(e){var t=this.getDomBounding(e),n=t.width,i=t.height;if(-1===IGNORE_TAG_SET.indexOf(e.tagName)&&(e.children||n*i>0)){for(var o,r=[],a=0;o=e.children[a];a++){var s=this.deepTraversal(o);s.score&&r.push(s)}return this.assemble(e,r)}return{}}},{key:"assemble",value:function(e,t){var n=this.getDomBounding(e),i=n.width,o=n.height,r=n.left,a=n.top,s=n.bottom,c=n.right,u=0;if(WH<a||WW<r||c<0||s<0||"BODY"!==e.tagName&&this.isIgnoreDom(e))return{};t.forEach(function(e){u+=e.score});var d=TAG_WEIGHT_MAP[e.tagName]||1;1===d&&"none"!==getStyle(e,"background-image")&&(d=TAG_WEIGHT_MAP.IMG);var f=i*o*d*this.calShowPercent(e),l=+e.getAttribute("_pi"),m=[{node:e,score:f,weight:d,paintTiming:this.ptCollector[l-1],paintIndex:l}];return(u>f||this.isIgnoreDom(e,!0))&&(f=u,m=[],t.forEach(function(e){m=m.concat(e.elements)})),{deeplink:t,score:f,elements:m,node:e,paintIndex:l}}},{key:"initResourceMap",value:function(){var e={};return Performance.getEntries&&Performance.getEntries().forEach(function(t){e[t.name]=t.responseEnd}),e}},{key:"scoring",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=void 0,n=-1,i=-1;return e.forEach(function(e){var i=e.score;n<i&&(n=i,t=e)}),t.node&&(i=t.paintTiming),{fmpT:i,target:t}}},{key:"calShowPercent",value:function(e){var t=this.getDomBounding(e),n=t.left,i=t.right,o=t.top,r=t.bottom,a=t.width,s=t.height,c=WW,u=WH,d=a+(c-0)-(Math.max(i,c)-Math.min(n,0));if(d<=0)return 0;var f=s+(u-0)-(Math.max(r,u)-Math.min(o,0));return f<=0?0:d*f/(a*s)}},{key:"getDomBounding",value:function(e){var t=document.body.getBoundingClientRect(),n=t.x,i=t.y,o=e.getBoundingClientRect(),r=o.left,a=o.right,s=o.top,c=o.bottom,u=o.width;return{left:r-n,right:a-n,top:s-i,bottom:c-i,height:o.height,width:u}}},{key:"isIgnoreDom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return getStyle(e,"opacity")<.1||"fixed"===getStyle(e,"position")&&getStyle(e,"zIndex")>999||"hidden"===getStyle(e,"visibility")||"none"===getStyle(e,"display")||(0===e.children.length||t)&&"IMG"!==e.tagName&&"none"===getStyle(e,"background-image")&&/^rgba\((?:\d+,\s?){3}0\)$/.test(getStyle(e,"background-color"))}}]),e}(),FMP=new FMPTiming,FMPStartTime=window.performance&&performance.timing.navigationStart||Date.now();function fmpCalculate(){FMP.getFMP().then(function(e){var t=(e||{}).fmpT;timeWithin(t)&&(TES&&TES.time("FMP",FMPStartTime,t),t>2e3&&TES.error("performance.timming.fmp","FMP_TIME_LGT_2S","FMP_TIME_LGT_TWO::FMPå¤§äº2s",e))})}function fmp(){setTimeout(function(){try{fmpCalculate()}catch(e){}},0)}function addEvent(e,t,n,i){if(e.addEventListener)return e.addEventListener(t,n,i),!0;if(e.attachEvent)return e.attachEvent("on"+t,n);var o=e["on"+t];e["on"+t]=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];o.apply(this,t),n.apply(this,t)}}function windowOnload(e){addEvent(window,"load",e,!1)}function getCookie(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(n))?unescape(t[2]):null}function getMainAccount(){var e=getCookie("cna")||"no_cna";return(getCookie("KAOLA_MAIN_ACCOUNT")||"unlogin")+"|"+e}var neteaseCDN=["betajd-pages.kl.126.net","pages.kl.126.net","pop.noskl.127.net","pop.nosdn.127.net","paopao.nosdn.127.net","haitao.noskl5.127.net","haitao.nosdn5.127.net","haitao.noskl4.127.net","haitao.nosdn4.127.net","haitao.noskl3.127.net","haitao.nosdn3.127.net","haitao.noskl2.127.net","haitao.nosdn2.127.net","haitao.noskl1.127.net","haitao.nosdn1.127.net","haitao.noskl.127.net","haitao.nos.netease.com","betajd-y.kl.126.net","betajd-w.kl.126.net","betajd-p.kl.126.net","betajd-mm.bst.126.net","y.kl.126.net","w.kl.126.net","p.kl.126.net","mm.bst.126.net"],checkResourceType=["img","script","css","video"],getUrlDomain=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").match(/^https?:\/\/([^\/]+)\//);return e&&e[1]},checkResource=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=void 0,n=e.initiatorType,i=e.name,o=getUrlDomain(i);return o&&checkResourceType.includes(n)&&neteaseCDN.includes(o)&&(t={domain:o,name:i}),t},getIntervalTime=function(){var e=document.querySelector("#J_Tes_Monitor").src.match(/NeteaseCDNCheckT=(\d+)/);return e&&1e3*parseInt(e[1])||-1},entrys={new:[],old:[]},check=function(){entrys.new=performance.getEntriesByType("resource"),entrys.new.map(function(e){if(!entrys.old.includes(e)){var t=checkResource(e)||{};t.name&&TES&&TES.error("cdn.usage.error","NeteaseCDNForbid","NeteaseCDNForbid::"+t.domain,t)}}),entrys.old=entrys.new};function checkNeteaseCDN(){var e=getIntervalTime();e>=1e3&&setInterval(check,e)}function checkNameStorage(){var e=setInterval(function(){window.name&&0!==window.name.indexOf("nameStorage")&&(TES&&TES.error("nameStorage.usage.error","nameStorageUnused","nameStorageUnused::ä¸è§èä½¿ç¨window.name",{"window.name":window.name}),clearInterval(e))},3e3)}var resourceException=function(){window.addEventListener("error",function(e){var t=e.target,n=t.nodeName,i=t.href,o=t.src;if(!e.message)switch(n){case"LINK":_report(i,"link");break;case"IMG":_report(o,"image");break;case"SCRIPT":_report(o,"script");break;default:o&&_report(o,"link")}return!0},!0)};function _report(e,t){TES&&TES.send(e,["stability","resource","message",{status:"4xx",type:t}])}var cndDomainWhiteList=["alicdn.com","kaolacdn.com","126.net"],ignoreKWList=["aplus"],getUrlDomain$1=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").match(/^https?:\/.*[\.\/]([^\/]+\.[^\/]+)\//);return e&&e[1]},isIgnore=function(e){var t=e.src,n=e.id,i=!1;return ignoreKWList.map(function(e){i=-1!==(t+";"+n).indexOf(e)}),i},localDomain=getUrlDomain$1(location.href),checkScript=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={},n=e.crossOrigin,i=e.src,o=e.outerHTML,r=(e.id,getUrlDomain$1(i));return r&&localDomain!==r&&!isIgnore(e)&&-1!==cndDomainWhiteList.indexOf(r)&&-1===["use-credentials","anonymous",""].indexOf(n)&&(t={script:o.replace(/&amp;/g,"&").replace(/\"/g,"'"),src:i}),t};function checkScriptCrossOriginTag(){for(var e=document.querySelectorAll("script"),t=0,n=e.length,i=e[t];t<n;i=e[++t]||{}){if(i.src){var o=checkScript(i);o.src&&TES&&TES.error("script.usage.error","scriptNeedCrossoriginTag","scriptNeedCrossoriginTag::è·¨åèæ¬ã"+o.src+"ãæªä½¿ç¨crossoriginæ è®°",o)}}}var updateExtBaseInfoData=function(e){TES&&TES.updateExtBaseInfoData(e)};try{var mainAccount=getMainAccount();updateExtBaseInfoData({tes_app_type:"seller",userNick:mainAccount,userId:mainAccount}),window.$KLPerformanceMonitorInited||(window.$KLPerformanceMonitorInited=!0,resourceException(),windowOnload(function(){-1!=mainAccount.indexOf("no_cna")&&(mainAccount=getMainAccount(),updateExtBaseInfoData({userNick:mainAccount,userId:mainAccount})),checkScriptCrossOriginTag(),fmp(),checkNameStorage(),checkNeteaseCDN()}))}catch(e){console.error(e)}}();
