webpackJsonp([99],{1223:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){n.d(e,"SpoofIm",function(){return l});var o=n(2),a=n(3),i=n(5),r=n(20),c=n(1704),u=(n(1645),n(1608)),s=n(1983),f=n(12),d=n(39),l=function(){function e(){}return e.init=function(){if(!e.isAuthenticated&&!e.isInited){document.querySelector("body").classList.contains("page_index")&&e.startSpoofing(),t(document).on(f.a.CHAT_TRIGGER_VISIBILITY,function(){window.chat.visibility===f.a.CHAT_HIDDEN&&e.startSpoofing(!0)}),t(document).on(f.a.CHAT_TRIGGER_OPEN,function(){Object(c.b)(),e.startSpoofing(!1)}),t("#bChat").on("onCurrentChathostChange",function(){e.startSpoofing(!1)})}e.isInited=!0},e.startSpoofing=function(t){Object(u.a)();var n=document.querySelector("body"),o=void 0===t?!n.classList.contains("chat_visible"):t,a=o?Object(c.a)():s.a.getTimeoutForSpoof();e.setTimeoutForAttachOrGetInfo(a)},e.stopSpoofing=function(){Object(u.a)(),clearTimeout(e.spoofTimeout)},e.restartSpoofing=function(){if(!document.querySelector("body").classList.contains("chat_visible")){var t=Object(c.a)();clearTimeout(e.spoofTimeout),e.spoofTimeout=window.setTimeout(function(){s.a.getModelInfoForSpoof()},t)}},e.setTimeoutForAttachOrGetInfo=function(t){clearTimeout(e.spoofTimeout),e.spoofTimeout=window.setTimeout(function(){var t;null===(t=d.a.popup.tasks)||void 0===t||t.setUserInteractionLock(60),s.a.getModelInfoForSpoof(),e.SpoofIMComponent||e.attachReactSpoofIM()},t)},e.isInited=!1,e.isAuthenticated=o.a.getState().isAuthenticated,e.renderComponent=function(){var t=document.createElement("div");t.classList.add("js-spoofIM"),document.body.appendChild(t),t.innerHTML="",e.rootNode=Object(a.render)(Object(a.h)(i.a,{store:o.a},Object(a.h)(e.SpoofIMComponent,{nextMessageDelayMs:1e3*r.b.rangeInt(1,6),nextMessageDurationMs:1e3*r.b.rangeInt(2,6)})),t)},e.attachReactSpoofIM=function(){e.rootNode||document.querySelectorAll("#bChat .video_limit_alert").length||o.a.getState().isStreamOnly||!document.querySelectorAll(".js-index_banner").length||n.e(155).then(n.bind(null,1985)).then(function(t){e.SpoofIMComponent=t.default,e.renderComponent()})},e}()}.call(e,n(1))},1608:function(t,e,n){"use strict";n.d(e,"c",function(){return i}),n.d(e,"a",function(){return r}),n.d(e,"b",function(){return c});var o=n(0),a=n(2),i=a.a.action(function(t,e){return{spoofIm:Object(o.a)(Object(o.a)({},t.spoofIm),e)}}),r=a.a.action(function(t){return{spoofIm:Object(o.a)(Object(o.a)({},t.spoofIm),{avatarUrl:"",username:"",displayName:"",spoofVersionId:null,spoofMessageId:null,time:180})}}),c=a.a.action(function(t,e){return{spoofIm:Object(o.a)(Object(o.a)({},t.spoofIm),{avatarUrl:e})}})},1645:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o;!function(t){t[t.CHAT=1e4]="CHAT",t[t.MAIN=3e4]="MAIN",t[t.LOCAL=2e3]="LOCAL",t[t.MAIN_AFTER_FIRST=18e4]="MAIN_AFTER_FIRST",t[t.MAIN_AFTER_SECOND=3e5]="MAIN_AFTER_SECOND",t[t.MAIN_AFTER_THIRD=864e5]="MAIN_AFTER_THIRD"}(o||(o={}))},1704:function(t,e,n){"use strict";n.d(e,"b",function(){return c}),n.d(e,"a",function(){return u});var o=n(14),a=n(1645),i=n(1982),r="spoof",c=function(){var t={index:i.a.FIRST,time:Date.now()},e=Object(o.b)(r);if(e){JSON.parse(e).index===i.a.FIRST?t.index=i.a.SECOND:t.index=i.a.THIRD}Object(o.c)(r,JSON.stringify(t),{expires:1,expiresType:"day"})},u=function(){var t=a.a.MAIN,e=Object(o.b)(r);if(e){var n=JSON.parse(e),c=n.index,u=n.time,s=Date.now()-u;t=c===i.a.FIRST?s<a.a.MAIN_AFTER_FIRST?a.a.MAIN_AFTER_FIRST-s:a.a.MAIN:c===i.a.SECOND?s<a.a.MAIN_AFTER_SECOND?a.a.MAIN_AFTER_SECOND-s:a.a.MAIN:a.a.MAIN_AFTER_THIRD}return t}},1982:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o;!function(t){t.FIRST="FIRST",t.SECOND="SECOND",t.THIRD="THIRD"}(o||(o={}))},1983:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return d});var o=n(0),a=n(12),i=n(1608),r=n(20),c=n(1984),u=n(2),s=n(1645),f=n(4),d=function(){function e(){}return e.getModelInfoForSpoof=function(e,n){return Object(o.c)(void 0,void 0,void 0,function(){var s,d,l,I,p,m,b,T,S,_,g,A,v,O,N,M,R,h,j,C,F,E,y,D;return Object(o.f)(this,function(o){switch(o.label){case 0:return s=window.chat,d=s.performerData,l=s.visibility,I=u.a.getState(),p=I.lang,m=I.chatHost,b=l===a.a.CHAT_VISIBLE,T=b?m.gender:null===(D=window.globalListing)||void 0===D?void 0:D.livetab,[4,t.ajax({type:"get",dataType:"json",cache:!1,url:Object(f.c)("@ajax_get_spoof_im"),data:{lang:p,isChat:+b,gender:T,versionId:e}})];case 1:if(S=o.sent(),_="",g="",A="",v=S.result.spoofId,O=S.result.messageId,b){if(!d)return[2];_=d.displayName,A=chat.buildAvatarUrl(d).replace("avatars","avatar120x120")}else{if(N=30,M=window.globalListing.stateData,R=M.online_count,h=M.models,!h)return[2];if(j=h.length,C=j<N?j:N,F=R>=C?C:R,E=r.b.rangeInt(0,F),y=h[E],0===parseInt(F)||!y)return[2];_=y.display_name,g=y.username,Object(c.a)(g)}return Object(i.c)({username:g,displayName:_,avatarUrl:A,spoofVersionId:v,spoofMessageId:O,time:n||180}),[2]}})})},e.getTimeoutForSpoof=function(){return s.a.CHAT},e}()}).call(e,n(1))},1984:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return r});var o=n(4),a=n(149),i=n(1608),r=function(e){var n,r=null===(n=window.globalListing)||void 0===n?void 0:n.livetab;t.ajax({type:"get",url:Object(o.c)("@api_get_user_info?username="+e),success:function(t){if(a.a.isSuccess(t.status)){var e=t.result.user.profileImageUrls.avatar_120x120||"/images/default/thumb_m_"+r+".png";Object(i.b)(e)}}})}}).call(e,n(1))}});