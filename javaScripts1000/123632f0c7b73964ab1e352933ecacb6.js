(self.webpackChunk=self.webpackChunk||[]).push([[5418],{77965:e=>{"use strict";e.exports=function(e){var t,i=(t=e,window[t]=window[t]||[],window[t]);return new Promise((function(e){i.push((function(){e(this)}))}))}},52784:(e,t,i)=>{"use strict";var n=i(24433);e.exports={getDependencyClass:function(e){if(!e)throw new Error("dependencyName required");var t=n("dependency:"+e);return window.customElements.whenDefined(e).then((function(){return t.end(),window.customElements.get(e)}))},getFirstDependencyElement:function(e,t){if(!e)throw new Error("dependencyName required");return t||(t=document),window.customElements.whenDefined(e).then((function(){var i=t.querySelector(e);if(!i)throw new Error(e+" element cannot be found");return i}))}}},86483:e=>{"use strict";var t,i=function(){};try{t=window}catch(e){t={}}e.exports=t.performance&&t.performance.mark?t.performance:{getEntriesByName:i,mark:i,measure:i}},24433:(e,t,i)=>{"use strict";var n=i(86483),s=0;function o(){var e="phxMark:"+s++;return n.mark(e),e}e.exports=function(e){var t=o();return{end:function(){var i=o();n.measure(e,t,i);var s=n.getEntriesByName(e);if(s&&s.length)return s[s.length-1].duration}}}},20751:(e,t,i)=>{"use strict";function n(e,t){var i,n=this,s=null,o=+t;this.delay=t,this.remaining=function(){return Math.max(o+i-+new Date,0)},this.cancel=function(){clearTimeout(s),n.cancelled=!0},this.pause=function(){clearTimeout(s),o-=+new Date-i,n.paused=!0},this.resume=function(){i=+new Date,clearTimeout(s),s=setTimeout(e,o),n.paused=!1},this.resume()}i.d(t,{Z:()=>n})},22498:(e,t,i)=>{"use strict";var n=i(20751);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var i,n=0;n<t.length;n++)(i=t[n]).enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}function d(e,t,i){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(n){var s=Object.getOwnPropertyDescriptor(n,t);return s.get?s.get.call(i):s.value}})(e,t,i||e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=i(52784).getDependencyClass,p=i(77965),m=i(24433)("webcomponents:ad"),v=["301x50","321x50","729x90","971x90","300x251","300x601","160x601"],g=["appnexus","ix","rubicon"],b="defer-until-event";f("phoenix-page").then((function(e){var t=function(t){function i(){return r(this,i),w.apply(this,arguments)}!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(i,t);var s,a,f,m,y,w=(m=i,y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=u(m);if(y){var i=u(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return h(this,e)});return s=i,f=[{key:"observedAttributes",get:function(){return["auto-reload-paused"]}}],(a=[{key:"observedBroadcastedEvents",get:function(){var e=this.getAttribute(b)?this.getAttribute(b).split(" "):[];return[].concat(o(e),["phoenix:fixedBottomAd:hide","phoenix:fixedBottomAd:show"])}},{key:"broadcastedEventCallback",value:function(e){e&&this.deferUntilEvent&&-1<this.deferUntilEvent.indexOf(e)?(this._load(),this.deferUntilEvent=!1):"phoenix:fixedBottomAd:hide"===e?this.fixedVisible&&this.firstChild&&(this.firstChild.classList.add("is-offscreen-bottom"),this.inView=!1,this.isPaused=!0):"phoenix:fixedBottomAd:show"===e&&this.fixedVisible&&this.firstChild&&(this.firstChild.classList.remove("is-offscreen-bottom"),this.inView=!0,this.isPaused=!1)}},{key:"isHidden",get:function(){return!this.fixedVisible&&!this.offsetParent}},{key:"isPaused",get:function(){return this.hasAttribute("auto-reload-paused")},set:function(e){e?this.setAttribute("auto-reload-paused",e):this.removeAttribute("auto-reload-paused")}},{key:"reloadCount",get:function(){return this._reloadCount}},{key:"connectedCallback",value:function(){var t=this;d(u(i.prototype),"connectedCallback",this).call(this),this.autoReload=this.hasAttribute("auto-reload"),this.closeButton=this.hasAttribute("close-button"),this.deferUntilEvent=!!this.getAttr(b)&&this.getAttr(b).split(" "),this.fixedVisible=this.hasAttribute("fixed-visible"),this.skipDynamicCall=this.hasAttribute("skip-dynamic-call"),this.scrollToRefreshThreshold=this.getAttr("scroll-to-refresh"),this.skipScrollToRefresh=!1,this.trackVisibility=this.hasAttribute("track-visibility"),this.initialIndex=this.getAttr("initial-index"),this.isFilled=!1,this.recirculationOpen=!!document.querySelector(".salish-recirculation-open");var n=parseInt(this.getAttr("container-height"));n&&Number.isInteger(n)&&0<n&&(this.containerHeight=n);var s=parseInt(this.getAttr("container-width"));if(s&&Number.isInteger(s)&&0<s&&(this.containerWidth=s),this.containerClass=this.getAttr("container-class"),!this.hasAttribute("config"))throw new Error("No ad configuration was specified.");var o=this;window.phxConfigQueue||(window.phxConfigQueue=[]),window.phxConfigQueue.push((function(){o.breakpoint=this.breakpoint.get()})),this.handleAd=this._handleAd.bind(this),this.adLoadedTime=0,this._reloadCount=0,this.adAuctionPromise=p("phxAdAuctionQueue"),window.phxAdvertisingQueue=window.phxAdvertisingQueue||[],this._initListeners(),this.config.slotId&&!this.hasChildNodes()&&this._addSlotDiv(this.config.slotId),this.initialIndex&&this.config.slotConfig&&this.config.slotConfig.model&&(this.config.slotConfig.model.index=this.initialIndex),e.util.whenPageLoaded().then((function(){if(!t.config.slotId||!t.config.slotConfig)throw new Error("slot id and/or slot config is missing");t.maxAdReloads=-1===t.config.adReloaderDelay?1:t.config.maxAdReloads||10,t.deferUntilEvent||t._load()}))}},{key:"attributeChangedCallback",value:function(e){if("auto-reload-paused"===e&&this.reloadTimer)if(this.isPaused)this.reloadTimer.pause(),this.prebidReloadTimer.pause(),clearInterval(this.s2RInterval);else if(this.reloadTimer.resume(),this.prebidReloadTimer.resume(),this.scrollToRefreshThreshold){var t=this._scrollToRefreshTickHandler.bind(this);this.s2RInterval=setInterval(t,500)}}},{key:"reload",value:function(e){var t=this._reloadCount,i=this.config.slotConfig;if(t<this.maxAdReloads&&!this.isPaused){if(this.hasChildNodes()){var n=this.handleAd,s=(new Date).getTime();this.prebidTime&&30<(s-this.prebidTime)/1e3&&(e=!1),window.phxAdvertisingQueue.push((function(){this.reloadAd(i,e).then((function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];e.map(n)}))}))}else this._addSlotDiv(),this._load();this.autoReload&&this._setLoadTimer(),this.config.slotConfig.model&&"number"==typeof this.config.slotConfig.model.index&&this.config.slotConfig.model.index++,this._reloadCount++,this._reloadCount>this.maxAdReloads&&this.cancelReloading()}}},{key:"_handleAd",value:function(e){var t=this.config.slotConfig,i=this.config.adReloaderSizeCodes||[];if(!e.filled)return this.isFilled=!1,void this._setLoadTimer();var n=e.sizeDims,s=!1;if(window.pbjs){var o=window.pbjs.getAdserverTargetingForAdUnitCode(this.config.slotId)||{};-1<g.indexOf(o.hb_bidder)&&(s=o.hb_deal)}if(this.skipScrollToRefresh=!1,-1<i.indexOf(n)){if(t.screenSizes&&1===t.screenSizes.length&&"A"===t.screenSizes[0]&&t.model&&"fixed_bottom"===t.model.zone)if("1x1"===n)this.reloadDelay=20;else{var a=e.responseInfo&&e.responseInfo.dfp&&e.responseInfo.dfp.lineItemId;this.reloadDelay=a?20:30}s&&(this.reloadDelay=Math.max(this.reloadDelay,30),this.skipScrollToRefresh=!0)}else this.autoReload=!1;var r,l,d=[];t.config&&t.config.sizes&&t.config.sizes.length&&(l=[],(r=t.config.sizes).some(Array.isArray)?l=r.reduce((function(e,t){return e.push(Array.isArray(t)?t.join("x"):t),e}),[]):2!==r.length||r.some(isNaN)?l=r:l.push(r.join("x")),d=l),-1<d.concat(v,["1x1"]).indexOf(n)?this.config.slotId&&this.closeButton&&!this.closeButtonDiv&&this._addCloseButton(this.config.slotId):this.handleNonstandardSize(),this.isFilled=!0,"none"===this.style.display&&(this.style.display="",this.inView=!0),this.adLoadedTime=(new Date).getTime(),this.autoReload?!this.reloadTimer&&this._setLoadTimer():this.cancelReloading(),"fixed_bottom"===t.model.zone&&this.recirculationOpen&&this._salishRecirculationOpened()}},{key:"cancelReloading",value:function(){this.reloadTimer&&this.reloadTimer.cancel(),this.prebidReloadTimer&&this.prebidReloadTimer.cancel(),clearInterval(this.s2RInterval)}},{key:"handleNonstandardSize",value:function(){this.closeButton&&(this.closeButtonDiv&&this.closeButtonDiv.parentElement.removeChild(this.closeButtonDiv),this.closeButton=!1,this.closeButtonDiv=void 0)}},{key:"_addCloseButton",value:function(e){var t=this;this.closeButtonDiv=document.createElement("div"),this.closeButtonDiv.classList.add("m-advertisement--close-button");var i=document.createElement("div");i.innerHTML="CLOSE",i.classList.add("m-advertisement--close-button-label"),this.closeButtonDiv.appendChild(i),this.closeButtonHandler=function(){return t.style.display="none",t._unload(),!1},this.closeButtonDiv.addEventListener("click",this.closeButtonHandler),document.getElementById(e).parentElement.appendChild(this.closeButtonDiv)}},{key:"_addSlotDiv",value:function(e){var t,i=document.createElement("div"),n=document.createElement("div"),s=this.config.visClasses||[];if(n.id=e,this.config.moduleClass&&s.push(this.config.moduleClass),s.push("is-placeholder"),(t=i.classList).add.apply(t,o(s)),this.containerClass){var a,r=this.containerClass.split(" ");(a=i.classList).add.apply(a,o(r))}this.containerHeight&&(i.style.height=this.containerHeight+"px"),this.containerWidth&&(i.style.width=this.containerWidth+"px"),i.appendChild(n),this.appendChild(i)}},{key:"_scrollToRefreshTickHandler",value:function(){var e=this;if(!this.isHidden&&this.adLoadedTime&&(new Date).getTime()-this.adLoadedTime>4e3){var t=this.config.slotConfig,i=568>window.innerHeight?568:window.innerHeight,s=(window.pageYOffset-this.lastPageYOffset)/i;if(Math.abs(s)>=this.scrollToRefreshThreshold){clearInterval(this.s2RInterval);var o=this.reloadTimer;if(o&&!o.cancelled&&o.remaining()<2e3)this.lastPageYOffset=window.pageYOffset;else{this.cancelReloading();var a="s2r-"+t.id+"-"+this._reloadCount;this.adAuctionPromise.then((function(e){e.rerunAuction(t.id,2e3,a)})).catch((function(e){console.warn("Scroll to refresh auction failed: "+e)})),this.reloadTimer=new n.Z((function(){e.reload(a)}),2010),this.lastPageYOffset=window.pageYOffset}}}}},{key:"_load",value:function(){var e=this.config.slotConfig,t=this.handleAd;window.phxAdvertisingQueue.push((function(){this.getSlotResult(e.id).then(t)})),this.skipDynamicCall||window.phxAdvertisingQueue.push((function(){this.dynamicCall({slots:[e]})})),this.autoReload&&(this.reloadDelay=parseInt(this.config.adReloaderDelay,10)||30,this.inView=!this.trackVisibility,this.trackVisibility&&this.observeVisibilityChanges())}},{key:"onChangeToVisible",value:function(){this.inView=!0,this.isPaused=!1,this.isFilled&&(this.adLoadedTime=(new Date).getTime())}},{key:"onChangeToNotVisible",value:function(){this.inView=!1,this.isPaused=!0}},{key:"_initListeners",value:function(){this.callbacks=this._bindCallbacks(),window.addEventListener("message",this.callbacks.takeover,!1),document.addEventListener("visibilitychange",this.callbacks.browserTabVisibility),document.addEventListener("phxCollection:enterFullscreen",this.callbacks.galleryOpened),document.addEventListener("phxCollection:exitFullscreen",this.callbacks.galleryClosed),this.fixedVisible&&(document.addEventListener("salishRecirculation:opened",this.callbacks.salishRecirculationOpened),document.addEventListener("salishRecirculation:closed",this.callbacks.salishRecirculationClosed))}},{key:"_setLoadTimer",value:function(){var e=this,t=this.adAuctionPromise,i=this.config.slotConfig;if(i&&i.id){if(this.cancelReloading(),this.autoReload&&!(0>=this.reloadDelay)){var s=i.id+"-"+this._reloadCount,o=Math.max(this.reloadDelay-30,0),a=Math.max(this.reloadDelay-o-3,2);if(this.prebidReloadTimer=new n.Z((function(){e._reloadCount<=e.maxAdReloads&&!e.isHidden&&t.then((function(t){t.rerunAuction(i.id,1e3*a,s),e.prebidTime=(new Date).getTime()})).catch((function(e){console.warn("Prebid auction failed: "+e)}))}),1e3*o),this.reloadTimer=new n.Z((function(){e._reloadCount<=e.maxAdReloads&&!e.isHidden&&e.reload(s)}),1e3*this.reloadDelay),this.scrollToRefreshThreshold&&!this.skipScrollToRefresh){var r=this._scrollToRefreshTickHandler.bind(this);this.lastPageYOffset=window.pageYOffset,this.s2RInterval=setInterval(r,500)}}}else console.warn("Malformed ad slot config missing id; reload timer cancelled.")}},{key:"_bindCallbacks",value:function(){return{browserTabVisibility:this._browserTabVisibilityCallback.bind(this),galleryClosed:this._galleryClosed.bind(this),galleryOpened:this._galleryOpened.bind(this),salishRecirculationOpened:this._salishRecirculationOpened.bind(this),salishRecirculationClosed:this._salishRecirculationClosed.bind(this),takeover:this._takeoverCallback.bind(this)}}},{key:"_takeoverCallback",value:function(e){if(e.origin.match(window.location.host))try{var t=JSON.parse(e.data);"takeoveropened"===t.event?this.isPaused=!0:"takeoverclosed"===t.event&&this.inView&&(this.isPaused=!1)}catch(e){}}},{key:"_galleryOpened",value:function(){this.isPaused=!0}},{key:"_galleryClosed",value:function(){this.inView&&(this.isPaused=!1)}},{key:"smallScreen",get:function(){var e="A"===this.breakpoint?600:1e3;return window.innerHeight<e}},{key:"_salishRecirculationOpened",value:function(){var e=this,t=(new Date).getTime(),i=Math.max(5e3-(t-this.adLoadedTime),0);this.isPaused=!0,window.setTimeout((function(){e.style.display="none",e.inView=!1}),i)}},{key:"_salishRecirculationClosed",value:function(){this.isPaused=!1,this.isFilled&&(this.style.display="",this.inView=!0,this.adLoadedTime=(new Date).getTime())}},{key:"_browserTabVisibilityCallback",value:function(){this.inView&&(this.isPaused="hidden"===document.visibilityState)}},{key:"_unload",value:function(){if(!this.unloaded){this.cancelReloading(),this.trackVisibility&&this.unobserveVisibilityChanges(),this.closeButtonDiv&&this.closeButtonDiv.removeEventListener("click",this.closeButtonHandler);var e=this.config.slotId;window.phxAdvertisingQueue.push((function(){this.resetAdSlot(e)})),this.autoReload&&this.callbacks&&(window.removeEventListener("message",this.callbacks.takeover),document.removeEventListener("visibilitychange",this.callbacks.browserTabVisibility),document.removeEventListener("phxCollection:enterFullscreen",this.callbacks.galleryOpened),document.removeEventListener("phxCollection:exitFullscreen",this.callbacks.galleryClosed),this.fixedVisible&&(document.removeEventListener("salishRecirculation:opened",this.callbacks.salishRecirculationOpened),document.removeEventListener("salishRecirculation:closed",this.callbacks.salishRecirculationClosed))),this.unloaded=!0}}},{key:"disconnectedCallback",value:function(){d(u(i.prototype),"disconnectedCallback",this).call(this),this._unload()}}])&&l(s.prototype,a),f&&l(s,f),i}(e.PhoenixElement);window.customElements.define("phoenix-ad",t),m.end()}))}},0,[[22498,3666]]]);
//# sourceMappingURL=ad.min.js.map