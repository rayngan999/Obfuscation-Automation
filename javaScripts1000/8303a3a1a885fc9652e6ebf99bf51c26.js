webpackJsonp([29,156],{1580:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return o});var i=n(0),s=n(1581),a=n(9),c=n(312),o=function(){function e(){var t=this;this.token=null,this.onMessage=function(n){t.isAvailable()&&e.callbacks.push(n)},this.removeMessageListener=function(n){if(t.isAvailable()){var i=[];e.callbacks.map(function(t){t!==n&&i.push(t)}),e.callbacks=i}};var n;if("Notification"in window&&!a.a.isSafari()){var i=s.a.getInstance();i.isAvailable()&&(i.setup(),n=i)}if(!n)return void this.debug("PushAPI not available");this.service=n,this.service.onMessage(function(n){t.debug("receive message:",n),e.callbacks.map(function(t){t(n)})})}return e.getInstance=function(){return Object(i.c)(this,void 0,t,function(){return Object(i.f)(this,function(t){switch(t.label){case 0:return e.instance?[3,2]:(e.instance=new e,[4,e.instance.checkSubscription()]);case 1:t.sent(),t.label=2;case 2:return[2,e.instance]}})})},e.prototype.isAvailable=function(){return Boolean(this.service)},e.prototype.getToken=function(){return this.token},e.prototype.subscribe=function(){return Object(i.c)(this,void 0,t,function(){var t,e;return Object(i.f)(this,function(n){switch(n.label){case 0:if(!this.isAvailable())return[2,null];n.label=1;case 1:return n.trys.push([1,6,,7]),this.debug("subscribe"),[4,this.service.subscribe()];case 2:return(t=n.sent())?(this.token=t,[4,c.a.getInstance().saveToken(this.token)]):[3,5];case 3:return n.sent(),[4,c.a.getInstance().checkIsAuth()];case 4:n.sent(),this.debug("success",t),n.label=5;case 5:return[2,t];case 6:switch(e=n.sent(),e.code){case"messaging/permission-blocked":case"messaging/permission-default":this.debug("show alert");break;case"messaging/unsupported-browser":this.debug("unsupported browser");break;default:this.debug("ERROR",e)}return[2,null];case 7:return[2]}})})},e.prototype.unsubscribeAll=function(){return Object(i.c)(this,void 0,t,function(){var t,e;return Object(i.f)(this,function(n){switch(n.label){case 0:if(!this.isAvailable()||!this.isSubscribed())return[2,!1];n.label=1;case 1:return n.trys.push([1,5,,6]),this.debug("unsubscribe"),[4,this.service.unsubscribe(this.token)];case 2:return t=n.sent(),t?[4,c.a.getInstance().removeToken()]:[3,4];case 3:n.sent(),this.token=null,this.debug("success unsubscribed"),n.label=4;case 4:return[2,t];case 5:switch(e=n.sent(),e.code){case"messaging/delete-token-not-found":break;default:this.debug("ERROR",e)}return[3,6];case 6:return[2]}})})},e.prototype.isSubscribed=function(){return Boolean(this.token)},e.prototype.checkSubscription=function(){return Object(i.c)(this,void 0,void 0,function(){var t,e;return Object(i.f)(this,function(n){switch(n.label){case 0:return window.Notification&&"granted"===Notification.permission&&c.a.getInstance().isAvailable()?[4,c.a.getInstance().checkIsAuth()]:[2];case 1:return n.sent(),this.isAvailable()?[4,c.a.getInstance().getToken()]:[2];case 2:return t=n.sent(),this.debug("savedToken",t),t?[4,this.service.subscribe()]:[2];case 3:return e=n.sent(),(this.debug("serviceToken",e),e&&t===e)?[3,7]:(this.debug("remove all"),[4,c.a.getInstance().removeToken()]);case 4:return n.sent(),e?[4,this.service.unsubscribe(e)]:[3,6];case 5:n.sent(),n.label=6;case 6:return[2];case 7:return this.debug("ok token"),this.token=e,[2]}})})},e.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.callbacks=[],e}()}).call(e,n(13))},1581:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return c});var i,s=n(0),a=n(1582);!function(t){t[t.NOT_AVAILABLE=0]="NOT_AVAILABLE",t[t.NOT_INITIALIZED=1]="NOT_INITIALIZED",t[t.INITIALIZING=2]="INITIALIZING",t[t.INITIALIZED=3]="INITIALIZED",t[t.READY=4]="READY"}(i||(i={}));var c=function(e){function n(){var t=e.call(this)||this;return t._innerStatus=i.NOT_INITIALIZED,t.waitMaxFails=20,t.waitFailCounter=0,t.callbacks=[],t.waitLoading=function(){if(!t.checkStatusComplete(i.INITIALIZING,!0))throw new Error("Firebase not loaded but status do not equal "+i.INITIALIZING+" (initializing): "+t.status);if("firebase"in window&&"messaging"in firebase)try{t.status=i.INITIALIZED,t.init()}catch(e){t.status=i.NOT_AVAILABLE}else{if(++t.waitFailCounter>t.waitMaxFails)return void(t.status=i.NOT_AVAILABLE);window.setTimeout(t.waitLoading,1e3)}},t.handleMessage=function(e){t.debug(e),t.callbacks.map(function(t){t(e)})},"Notification"in window&&"serviceWorker"in navigator&&"https:"===window.location.protocol||(t.status=i.NOT_AVAILABLE),t}return Object(s.e)(n,e),n.getInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.subscribe=function(){return Object(s.c)(this,void 0,void 0,function(){var t,e;return Object(s.f)(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,this.ready()];case 1:return n.sent(),t=firebase.messaging(),[4,t.requestPermission()];case 2:return n.sent(),[4,t.getToken()];case 3:return[2,n.sent()];case 4:throw e=n.sent(),this.debug(e.message||e),e;case 5:return[2]}})})},n.prototype.unsubscribe=function(t){return Object(s.c)(this,void 0,void 0,function(){var e,n;return Object(s.f)(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,this.ready()];case 1:return i.sent(),e=firebase.messaging(),[4,e.deleteToken(t)];case 2:return[2,i.sent()];case 3:throw n=i.sent(),this.debug(n.message||n),n;case 4:return[2]}})})},n.prototype.onMessage=function(t){this.callbacks.push(t)},n.prototype.isAvailable=function(){return this.status!==i.NOT_AVAILABLE},n.prototype.setup=function(){var t=this;if(!(!this.isAvailable()||"firebase"in window||this.checkStatusComplete(i.INITIALIZED))){this.status=i.INITIALIZING;var e=function(i){if(n.libUris[i]){var s=n.libUris[i];if(!document.querySelector('script[src="'+s+'"]')){var a=document.createElement("script");a.async=!0,a.src=s,a.onload=function(){t.debug("lib was loaded "+s),e(i+1)},document.head.appendChild(a)}}};n.libUris.length&&e(0),this.waitLoading()}},n.prototype.init=function(){if(this.isAvailable()&&!this.checkStatusComplete(i.READY)){this.status=i.READY,firebase.initializeApp(n.config);firebase.messaging().onMessage(this.handleMessage)}},n.prototype.ready=function(){return Object(s.c)(this,void 0,void 0,function(){var e,n=this;return Object(s.f)(this,function(a){switch(a.label){case 0:return this.checkStatusComplete(i.READY)?[2,!0]:this.checkStatusComplete(i.INITIALIZING)?(e=this,[4,new t(function(t,a){function c(){var n;return Object(s.f)(this,function(s){switch(s.label){case 0:return e.checkStatusComplete(i.READY)?[3,2]:[4];case 1:return n=s.sent(),e.isAvailable()||a("Network error"),[3,0];case 2:return t(),[2,!0]}})}n.readyGenerator=c(),n.readyGenerator.next(null)})]):(this.debug("You must setup firebase before"),[2,!1]);case 1:return[2,a.sent()]}})})},n.prototype.onChangeStatus=function(t,e){this.debug("Status was changed",t,"=>",e),this.readyGenerator&&this.readyGenerator.next(e)},n.prototype.checkStatusComplete=function(t,e){return void 0===e&&(e=!1),e?this.status===t:this.status>=t},Object.defineProperty(n.prototype,"status",{get:function(){return this._innerStatus},set:function(t){var e=this.status;this._innerStatus=t,this.onChangeStatus(e,t)},enumerable:!1,configurable:!0}),n.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},n.libVersion="7.21.0",n.libUris=["https://www.gstatic.com/firebasejs/"+n.libVersion+"/firebase-app.js","https://www.gstatic.com/firebasejs/"+n.libVersion+"/firebase-messaging.js"],n.config={apiKey:"AIzaSyBZPKKo_tInwfJZ0COBg0ZfmYyxacO6lsU",projectId:"bongacams-e8ad2",messagingSenderId:"918428164766",appId:"1:918428164766:web:c8b01dbfcdaf92e0c8918f"},n}(a.a)}).call(e,n(13))},1582:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(){}return t}()},1583:function(t,e,n){"use strict";var i=n(0),s=n(18),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.e)(e,t),e.SITE_NOTIFICATION="siteNotification",e.ONLINE_NOTIFICATION="onlineNotification",e}(s.a);e.a=a},1620:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(3),s=n(8),a=n(6),c=n(37),o=function(t){var e=t.displayName,n=t.avatarUrl;return Object(i.h)("div",{class:"bc_online_notification bc_flex"},Object(i.h)("div",{class:"ont_item __icon"},Object(i.h)("img",{class:"ont_avatar",src:n,alt:""})),Object(i.h)("div",{class:"ont_item __info bc_flex bc_flex_column bc_flex_justify_s_between"},Object(i.h)(a.a,{tagName:"div",className:"ont_i_block bc_flex",html:__("%badge% %display_name% is online now!",{badge:'<span class="ont_budge">live</span>',display_name:'<span class="ont_alert_name">'+e+"</span>"})}),Object(i.h)("div",{class:"ont_i_block bc_flex bc_flex_items_center"},Object(i.h)("div",{class:"ont_i_inner"},__("Visit chat room")),Object(i.h)(s.a,{group:"ont_arrow",icon:"#svg_icon_arrow_right",url:c.a}))))},r=function(){return Object(i.h)("div",{class:"ont_close_wrp"},Object(i.h)(s.a,{group:"ont_close",icon:"#svg_icon_empty_close",url:c.a}))};e.b=o},697:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t,i){n.d(e,"NotificationWidget",function(){return g});var s=n(0),a=n(17),c=n(4),o=n(2),r=n(1580),u=n(6),l=n(1620),f=n(45),b=n(315),h=n(312),d=n(10),_=n(1583),p=n(875),v=function(){return n.e(147).then(n.bind(null,1615))},g=function(){function e(){var e=this;this.handleChangeOnlineNotification=function(t){var n=t.onlineNotifications;n&&n.length&&(n.map(e.showNotification),Object(b.c)())},this.handleChangeNotificationSettings=function(e,n){var i=(Object(d.a)(t("#miniProfileStateData, #wallProfileStateData").text())||{}).username;if(i){var s=n.onlineNotificationSettings[i],a=e.onlineNotificationSettings[i];if(void 0===s&&void 0!==a||s!==a){var c=t(".js-ntf_btn");c.length&&Object(p.d)(c,a);var o=t(".js-flw_mp_btn.__notify").filter(":visible");o.length&&Object(p.c)(o,a)}}},this.showNotification=function(t){var e=t.username,n=t.displayName,i=t.avatarUrl;v().then(function(t){new t.default({className:"bc_online_notification_wrp",html:Object(u.o)(Object(l.b)({displayName:n,avatarUrl:i})),close:Object(u.o)(Object(l.a)({})),onClick:function(){location.href="/"+e}},5e3)})},this.handleNotificationMessage=function(t){return Object(s.c)(e,void 0,void 0,function(){var e,n;return Object(s.f)(this,function(i){switch(i.label){case 0:return e=(null===(n=null===t||void 0===t?void 0:t.data)||void 0===n?void 0:n.type)!==_.a.ONLINE_NOTIFICATION||!t.data.username,e?[3,2]:[4,h.a.getInstance().checkAndSaveAllowing(t.data.username)];case 1:e=!i.sent(),i.label=2;case 2:return e||[Object(c.c)("@member_buy_tokens"),Object(c.c)("@member_buy_vip"),Object(c.c)("@member_buy_invisibility")].includes(location.pathname)?[2]:(this.showNotification({username:t.data.username,displayName:t.data.displayName,avatarUrl:t.data.icon}),[2])}})})}}return e.checkSubscription=function(n){return Object(s.c)(this,void 0,void 0,function(){var r,u,l,f,b,h;return Object(s.f)(this,function(s){switch(s.label){case 0:if(!e.pushNotificationInstance)return e.instantCheckSubscriptionFor.push(n),[2];if(r=o.a.getState().isAuthenticated,u=e.pushNotificationInstance.getToken(),l=!1,r||!e.pushNotificationInstance.isAvailable()||!u)return[2];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,new i(function(e,i){t.ajax({url:Object(c.c)("@is_subscribed_on_online_push_notification?username="+n),type:"POST",dataType:"json",data:Object(a.a)({hash:u}),success:function(t){t&&t.success||i(),l=Boolean(t.is_subscribed),e()},error:i})})];case 2:return s.sent(),[3,4];case 3:return f=s.sent(),[3,4];case 4:return b=t('.js-ntf_btn[data-username="'+n+'"]'),Object(p.d)(b,l),h=t('#profile-part[data-id="'+n+'"]').find(".js-flw_mp_btn.mp_notify"),Object(p.c)(h,l),[2]}})})},e.handleNotificationBtnClick=function(n,r){return Object(s.c)(this,void 0,i,function(){var u,l=this;return Object(s.f)(this,function(f){return u=o.a.getState().isAuthenticated,[2,new i(function(i,f){return Object(s.c)(l,void 0,void 0,function(){var l,h,d;return Object(s.f)(this,function(_){switch(_.label){case 0:return l="",(h={},u)?(l=r?Object(c.c)("@unsubscribe_on_online?username="+n):Object(c.c)("@subscribe_on_online?username="+n),[3,6]):[3,1];case 1:return e.pushNotificationInstance.isAvailable()?(d=null,r?[3,3]:[4,e.pushNotificationInstance.subscribe()]):[3,5];case 2:return d=_.sent(),d||f("signup"),l=Object(c.c)("@subscribe_on_online_push_notification?username="+n),[3,4];case 3:d=e.pushNotificationInstance.getToken(),l=Object(c.c)("@unsubscribe_on_online_push_notification?username="+n),_.label=4;case 4:return h=Object(s.a)(Object(s.a)({},h),{hash:d}),[3,6];case 5:f("signup"),_.label=6;case 6:return t.post(l,Object(a.a)(h),function(t){var e,n;t.success||f();var s=null===(n=null===(e=null===window||void 0===window?void 0:window.chat)||void 0===e?void 0:e.performerData)||void 0===n?void 0:n.username;u&&s&&o.a.action(b.d)({username:s,isSubscribed:!r}),i(t)},"json").fail(function(t){f(t.status)}),[2]}})})})]})})},e.prototype.init=function(){return Object(s.c)(this,void 0,void 0,function(){var n,a,c,o;return Object(s.f)(this,function(u){switch(u.label){case 0:return n=this,t("body").on("click",".js-ntf_btn",function(i){return Object(s.c)(this,void 0,void 0,function(){var a,c,o,r;return Object(s.f)(this,function(s){switch(s.label){case 0:if(a=t(this),c=a.hasClass("__active"),o=a.data("username"),n.isLoading)return[2,!1];s.label=1;case 1:return s.trys.push([1,3,4,5]),n.isLoading=!0,[4,e.handleNotificationBtnClick(o,c)];case 2:return s.sent(),Object(p.d)(a,!c),t(document).trigger("onlineNotification:change",o),[3,5];case 3:return r=s.sent(),"signup"===r&&t.signupEvent.call(this,i),[3,5];case 4:return n.isLoading=!1,[7];case 5:return[2]}})})}).on("click",".js-flw_mp_btn.__notify",function(i){return Object(s.c)(this,void 0,void 0,function(){var a,c,o,r;return Object(s.f)(this,function(s){switch(s.label){case 0:if(i.preventDefault(),i.stopPropagation(),a=t(this),c=!a.hasClass("mp_notify"),o=a.parents("#profile-part").data("id"),n.isLoading)return[2,!1];s.label=1;case 1:return s.trys.push([1,3,4,5]),n.isLoading=!0,[4,e.handleNotificationBtnClick(o,c)];case 2:return s.sent(),Object(p.c)(a,!c),t(document).trigger("onlineNotification:change",o),[3,5];case 3:return r=s.sent(),"signup"===r&&t.signupEvent.call(this,i),[3,5];case 4:return n.isLoading=!1,[7];case 5:return[2]}})})}),f.a.on("onlineNotifications",this.handleChangeOnlineNotification),f.a.on("onlineNotificationSettings",this.handleChangeNotificationSettings),a=e,[4,r.a.getInstance()];case 1:return a.pushNotificationInstance=u.sent(),e.pushNotificationInstance.onMessage(this.handleNotificationMessage),c=t(".js-ntf_btn"),c.length&&e.instantCheckSubscriptionFor.push(c.data("username")),o=[],e.instantCheckSubscriptionFor.map(function(t){t&&o.push(e.checkSubscription(t))}),e.instantCheckSubscriptionFor=[],[4,i.all(o)];case 2:return u.sent(),[4,h.a.getInstance().updateConfig()];case 3:return u.sent(),[2]}})})},e.prototype.rebind=function(){return this},e.instantCheckSubscriptionFor=[],e}()}.call(e,n(1),n(13))},875:function(t,e,n){"use strict";(function(t){function i(t,e,n){var i=t.find(".js-fw_hint"),s=n&&i.data("hint_extra")||i.data("hint"+(e||n?"_active":""));i.html(s),t.toggleClass("__active",e),t.toggleClass("__extra",n),t.addClass("__anim_click"),t.addClass("__no_hint"),t.one("transitionend WebkitTransitionEnd",function(){return t.removeClass("__anim_click")}),t.off("mouseleave.noHintAfterClick").one("mouseleave.noHintAfterClick",function(){return t.removeClass("__no_hint")})}function s(t,e){void 0===e&&(e=!1);var n=t.closest(".js-fw_wrap_mp");n.addClass("__anim_click"),n.addClass("__no_hint"),n.parent().one("transitionend WebkitTransitionEnd",function(){return n.removeClass("__anim_click")}),n.off("mouseleave.noHintAfterClick").one("mouseleave.noHintAfterClick",function(){return n.removeClass("__no_hint")}),clearTimeout(o[e?"mp_nb":"mp_fw"]),o[e?"mp_nb":"mp_fw"]=window.setTimeout(function(){return n.removeClass("__no_hint")},2e3)}n.d(e,"a",function(){return r}),n.d(e,"d",function(){return u}),n.d(e,"c",function(){return l}),n.d(e,"b",function(){return f});var a=n(15),c=n(2),o={},r=function(e,n,s,c){if(void 0===s&&(s=!1),void 0===c&&(c=!1),t(".js-flw_follow").toggleClass("__hidden",c||e),t(".js-flw_followed").toggleClass("__hidden",c||!e),t(".js-flw_unrequested").toggleClass("__hidden",!c),n.hasClass("__disabled")?n.remove():(i(n,e,c),clearTimeout(o.fw),o.fw=window.setTimeout(function(){return n.removeClass("__no_hint")},2e3)),s){var r=t(".js-flwr_cnt"),l=+r.data("count")+(e?1:-1);r.data("count",l),r.html(l+" "+a.a.pluralise("followers",l))}e||u(n.closest(".js-follow_wrp").find(".js-ntf_btn"),e)},u=function(t,e){if(c.a.getState().isAuthenticated&&e){var n=t.closest(".js-follow_wrp").find(".js-fw_btn");r(!0,n)}i(t,e,!1),clearTimeout(o.nb),o.nb=window.setTimeout(function(){return t.removeClass("__no_hint")},2e3)},l=function(e,n){var i=e.siblings(".js-flw_mp_btn.__notify"),a=e.hasClass("mp_notify")?[e,i]:[i,e],c=a[0],o=a[1];if(s(e,!0),n){c.hide(),o.show();var r=t(".js-flw_mp_btn.__follow:visible");e.hasClass("mp_notify")&&!r.hasClass("mp_is_following")&&f(r)}else c.show(),o.hide()},f=function(e){if(s(e),e.hasClass("__disabled"))e.closest(".js-fw_wrap_mp").remove();else{e.hide();e.siblings(".js-flw_mp_btn").show()}var n=t(".js-flw_mp_btn.__notify:visible");e.hasClass("mp_is_following")&&n.hasClass("mp_is_notified")&&l(n,!1)}}).call(e,n(1))}});