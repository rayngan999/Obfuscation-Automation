Cube("datav:/com/number-title-flop/1.8.30/style.css", [], function(m){m.exports=".counter-container .prefix{margin-right:var(--prefix-num-margin-right)}.counter-container .suffix{margin-left:var(--num-suffix-margin-left)}.counter-container span{line-height:1!important}";return m.exports});;
Cube("datav:/com/number-title-flop/1.8.30/template.html",[],function(a){return a.exports=function(){return"<div class=\"title-container\"></div>\n<div class=\"counter-container\"></div>"},a.exports});;
Cube("datav:/com/number-title-flop/1.8.30",["datav:/com/main-title/1.3.8","datav:/com/counter/1.3.19","datav:/npm/bcore/0.0.9/event","datav:/npm/lodash/4.6.1","datav:/npm/jquery/2.1.4"],function(a,b,c){var d=c("datav:/npm/bcore/0.0.9/event"),e=c("datav:/com/main-title/1.3.8"),f=c("datav:/com/counter/1.3.19"),g=c("datav:/com/number-title-flop/1.8.30/template.html")(),h=c("datav:/npm/lodash/4.6.1"),i=c("datav:/npm/jquery/2.1.4");return c("datav:/com/number-title-flop/1.8.30/style.css",""),a.exports=d.extend(function(a,b){this.config={theme:{},title:{textStyle:{textAlign:"flex-start"}},counter:{numbers:{animation:!0},suffix:{suffixArrange:"baseline"}}},this.container=i(a),this.template=g,this.apis=null,this._data=null,this.init(b)},{init:function(a){var b=this;this.apis=a.apis;var c=this.mergeConfig(a);this.container.append(h.template(this.template)),this.titleDom=this.container.find(".title-container"),this.counterDom=this.container.find(".counter-container"),this.title=new e(this.titleDom[0],this._formatTitleConfig(c)),this.counter=new f(this.counterDom[0],this._formatCounterConfig(c)),this.counter.on("counter-change",function(){b.globalEvent()})},render:function(a,b){this.dataChange=!1,a=this.data(a);var c=this.mergeConfig(b);this.updateLayout(),a&&this.dataChange?this.counter.render(a,this._formatCounterConfig(c,a)):b&&this.counter.render(null,this._formatCounterConfig(c,a));var d=a&&a[0]&&a[0].name?a[0].name:"";this.title.render([{value:d}],this._formatTitleConfig(c)),this.updateLayout()},resize:function(){this.updateLayout()},globalEvent:function(){var a=this.config,b=this.data();this.emit("number-changed",b&&b[0]),a.interaction.callbackId&&""!==a.interaction.callbackId&&b&&b[0]&&this.emit("global_var",a.interaction.callbackId,b[0][a.interaction.callbackId])},getColorStops:function(a){if(Array.isArray(a)){var b="";return h.map(h.sortBy(a,function(a){return a.offset}),function(c,d){var e=d<a.length-1?",":"";b+=c.color+" "+c.offset+"%"+e}),b}},mergeConfig:function(a){if(!a)return this.config;this.config.theme=h.defaultsDeep(a.theme||{},this.config.theme),this.config=h.defaultsDeep(a||{},this.config);var b=this.config.counter.numbers.textStyle.color;if("flat"===b.type)this.config.counter.numbers.textStyle.color=b.value,this.config.counter.numbers.textStyle.backgroundImage=null;else if("linearGradient"===b.type){var c=this.getColorStops(b.value.stops);this.config.counter.numbers.textStyle.color=null,this.config.counter.numbers.textStyle.backgroundImage="-webkit-linear-gradient("+b.value.angle+"deg, "+c+")"}return this.config},updateStyle:function(){var a=this.config;if(a&&this.counterDom){var b=a.counter&&a.counter.margin||{preNum:0,numSuff:0},c=b.preNum,d=b.numSuff,e=this.counterDom.context&&this.counterDom.context.style;e.setProperty("--prefix-num-margin-right",c+"px"),e.setProperty("--num-suffix-margin-left",d+"px")}},updateLayout:function(){var a=this.config,b=this.container.width(),c=this.container.height();switch(a.global.arrangement){case"top":this.titleDom.css({display:"flex","line-height":"normal",margin:0,"margin-bottom":a.global.distance||0,"justify-content":a.title.textStyle.textAlign,width:"100%"}),this.container.css({display:"block",alignItems:"start","flex-direction":"column"}),this.counterDom.width(b);var d=c-this.titleDom.height()-(a.global.distance||0);this.counterDom.height(d),this.counter.resize(b,d);break;case"bottom":this.titleDom.css({display:"flex",margin:0,"margin-top":a.global.distance||0,overflow:"visible","justify-content":a.title.textStyle.textAlign,width:"100%"}),this.container.css({display:"flex","flex-direction":"column-reverse"}),this.counterDom.width(b);var d=c-this.titleDom.height()-(a.global.distance||0);this.counterDom.height(d),this.counter.resize(b,d);break;case"left":this.titleDom.css({display:"flex",margin:0,"margin-right":a.global.distance||0,overflow:"visible","justify-content":a.title.textStyle.textAlign,width:"auto"}),this.container.css({display:"flex",alignItems:"baseline","flex-direction":"row"}),this.counterDom.height(c);var e=b-this.titleDom.width()-(a.global.distance||0);this.counterDom.width(e),this.counter.resize(e,c);}this.updateStyle()},data:function(a){if(!a||!Array.isArray(a))return this._data;var b=!0;if(!this._data||0===this._data.length)this._data=a;else if(a&&a[0]&&"undefined"!==typeof a[0].value){var c=h.isEqual(a[0],this._data[0])||h.isEqualWith(a[0],this._data[0],function(c,a){var b=h.clone(c),d=h.clone(a);return delete b.value,delete d.value,h.isEqual(b,d)})&&this.config.counter.numbers.rounding&&this._data&&Math.round(a[0].value)===Math.round(this._data[0].value);c&&!this.config.counter.numbers.sameDataFlip&&(b=!1),this._data=a}return this.dataChange=b,this._data},_formatCounterConfig:function(a,b){var c=JSON.parse(JSON.stringify(a)),d=c.counter,e=h.get(a,"counter.suffix","baseline"),f=e.suffixArrange;return d.global={align:{justifyContent:d.justifyContent,alignItems:f},textStyle:{fontFamily:d.fontFamily||c.global.textStyle.fontFamily}},d.prefix.content=b&&b[0]&&b[0].prefix||d.prefix.content,d.suffix.content=b&&b[0]&&b[0].suffix||d.suffix.content,d.interaction=c.interaction,delete d.justifyContent,d},_formatTitleConfig:function(a){var b=JSON.parse(JSON.stringify(a)),c=b.title;return c.textStyle.fontFamily=b.global.textStyle.fontFamily,delete c.width,c},destroy:function(){this.titleDom=null,this.counterDom=null,this.title=null,this.counter.off(),this.counter=null,this.container.empty(),this.off&&this.off()},clear:function(){this._data[0].value=0,this.counter.forceUpdate()}}),a.exports});