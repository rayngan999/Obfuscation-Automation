var c_cache=new Array();var dle_poll_voted=new Array();function reload(){var rndval=new Date().getTime();document.getElementById('dle-captcha').innerHTML='<img src="'+dle_root+'engine/modules/antibot/antibot.php?rndval='+rndval+'" width="160" height="80" alt="" />';};function dle_change_sort(sort,direction){var frm=document.getElementById('news_set_sort');frm.dlenewssortby.value=sort;frm.dledirection.value=direction;frm.submit();return false;};function doPoll(event,news_id){var frm=document.getElementById('dlepollform_'+news_id);var dle_poll_result=frm.status.value;var vote_check='';if(dle_poll_voted[news_id]==1){return;}
if(event!='results'&&dle_poll_result!=1){for(var i=0;i<frm.elements.length;i++){var elmnt=frm.elements[i];if(elmnt.type=='radio'){if(elmnt.checked==true){vote_check=elmnt.value;break;}}
if(elmnt.type=='checkbox'){if(elmnt.checked==true){vote_check=vote_check+elmnt.value+' ';}}}
if(event=='vote'&&vote_check==''){return;}
dle_poll_voted[news_id]=1;}else{dle_poll_result=1;frm.status.value=1;}
if(dle_poll_result==1&&event=='vote'){dle_poll_result=0;frm.status.value=0;event='list';}
ShowLoading('');$.post(dle_root+"engine/ajax/poll.php",{news_id:news_id,action:event,answer:vote_check,vote_skin:dle_skin},function(data){HideLoading('');$("#dle-poll-list-"+news_id).fadeOut(500,function(){$(this).html(data);$(this).fadeIn(500);});});}
function IPMenu(m_ip,l1,l2,l3){var menu=new Array();menu[0]='<a href="https://www.nic.ru/whois/?ip='+m_ip+'" target="_blank">'+l1+'</a>';menu[1]='<a href="'+dle_root+dle_admin+'?mod=iptools&ip='+m_ip+'" target="_blank">'+l2+'</a>';menu[2]='<a href="'+dle_root+dle_admin+'?mod=blockip&ip='+m_ip+'" target="_blank">'+l3+'</a>';return menu;};function ajax_save_for_edit(news_id,event)
{var allow_br=0;var news_txt='';var params={};if(quick_wysiwyg=="2"){tinyMCE.triggerSave();}
$.each($('#ajaxnews'+news_id).serializeArray(),function(index,value){if(value.name.indexOf("xfield")!=-1){params[value.name]=value.value;}});if(document.getElementById('allow_br_'+news_id).checked){params['allow_br']=1;}
if(document.getElementById('approve_'+news_id).checked){params['approve']=1;}
params['news_txt']=$('#dleeditnews'+news_id).val();params['full_txt']=$('#dleeditfullnews'+news_id).val();params['title']=$('#edit-title-'+news_id).val();params['reason']=$('#edit-reason-'+news_id).val();params['id']=news_id;params['field']=event;params['action']="save";ShowLoading('');$.post(dle_root+"engine/ajax/editnews.php",params,function(data){HideLoading('');if(data!="ok"){noticePush(data);}else{$('#dlepopup-news-edit').dialog('close');DLEconfirm(dle_save_ok,dle_confirm,function(){location.reload(true);});}});return false;};function ajax_prep_for_edit(news_id,event)
{for(var i=0,length=c_cache.length;i<length;i++){if(i in c_cache){if(c_cache[i]||c_cache[i]!='')
{ajax_cancel_comm_edit(i);}}}
ShowLoading('');$.get(dle_root+"engine/ajax/editnews.php",{id:news_id,field:event,action:"edit"},function(data){HideLoading('');var shadow='none';$('#modal-overlay').remove();$('body').prepend('<div id="modal-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #666666; opacity: .40;filter:Alpha(Opacity=40); z-index: 999; display:none;"></div>');$('#modal-overlay').css({'filter':'alpha(opacity=40)'}).fadeIn();var b={};b[dle_act_lang[3]]=function(){$(this).dialog('close');};b[dle_act_lang[4]]=function(){ajax_save_for_edit(news_id,event);};$('#dlepopup-news-edit').remove();$('body').prepend("<div id='dlepopup-news-edit' class='dlepopupnewsedit' title='"+menu_short+"' style='display:none'></div>");$('.dlepopupnewsedit').html('');$('#dlepopup-news-edit').dialog({autoOpen:true,width:800,height:600,buttons:b,resizable:false,dialogClass:"modalfixed dle-popup-quickedit",dragStart:function(event,ui){shadow=$(".modalfixed").css('box-shadow');$(".modalfixed").css('box-shadow','none');},dragStop:function(event,ui){$(".modalfixed").css('box-shadow',shadow);},close:function(event,ui){$(this).dialog('destroy');$('#modal-overlay').fadeOut(function(){$('#modal-overlay').remove();});}});if($(window).width()>830&&$(window).height()>530){$('.modalfixed.ui-dialog').css({position:"fixed"});$('#dlepopup-news-edit').dialog("option","position",['0','0']);}
$('#dlepopup-news-edit').css({overflow:"auto"});$('#dlepopup-news-edit').css({'overflow-x':"hidden"});$("#dlepopup-news-edit").html(data);},'html');return false;};function ajax_comm_edit(c_id,area)
{for(var i=0,length=c_cache.length;i<length;i++){if(i in c_cache){if(c_cache[i]!='')
{ajax_cancel_comm_edit(i);}}}
if(!c_cache[c_id]||c_cache[c_id]=='')
{c_cache[c_id]=$('#comm-id-'+c_id).html();}
ShowLoading('');$.get(dle_root+"engine/ajax/editcomments.php",{id:c_id,area:area,action:"edit"},function(data){HideLoading('');$('#comm-id-'+c_id).html(data);setTimeout(function(){$("html,body").stop().animate({scrollTop:$("#comm-id-"+c_id).offset().top-70},700);},100);},'html');return false;};function ajax_cancel_comm_edit(c_id)
{if(c_cache[c_id]!="")
{$("#comm-id-"+c_id).html(c_cache[c_id]);}
c_cache[c_id]='';return false;};function ajax_save_comm_edit(c_id,area)
{if(dle_wysiwyg=="2"){tinyMCE.triggerSave();}
var comm_txt=$('#dleeditcomments'+c_id).val();ShowLoading('');$.post(dle_root+"engine/ajax/editcomments.php",{id:c_id,comm_txt:comm_txt,area:area,action:"save"},function(data){HideLoading('');c_cache[c_id]='';$("#comm-id-"+c_id).html(data);});return false;};function DeleteComments(id,hash){DLEconfirm(dle_del_agree,dle_confirm,function(){ShowLoading('');$.get(dle_root+"engine/ajax/deletecomments.php",{id:id,dle_allow_hash:hash},function(r){HideLoading('');r=parseInt(r);if(!isNaN(r)){if(dle_tree_comm=='1'){var node=$("#comments-tree-item-"+r);}else{var node=$("#comment-id-"+r);}
$("html,body").stop().animate({scrollTop:node.offset().top-70},700);setTimeout(function(){node.hide('blind',{},1400)},700);}});});};function MarkSpam(id,hash){DLEconfirm(dle_spam_agree,dle_confirm,function(){ShowLoading('');$.get(dle_root+"engine/ajax/adminfunction.php",{id:id,action:'commentsspam',user_hash:hash},function(data){HideLoading('');if(data!="error"){DLEconfirm(data,dle_confirm,function(){location.reload(true);});}});});};function doFavorites(fav_id,event,subact,alert)
{ShowLoading('');$.get(dle_root+"engine/ajax/favorites.php",{fav_id:fav_id,action:event,subaction:subact,skin:dle_skin,alert:alert},function(data){HideLoading('');if(alert){noticePush(data,dle_info);}else{$("."+subact+"-id-"+fav_id).replaceWith(data);if(subact=='watchlater'&&dle_group!==5)noticePush('Movies has been '+(event=='plus'?'added to':'removed from')+' your watch later list!');else if(dle_group!==5)noticePush('Movies has been '+(event=='plus'?'added to':'removed from')+' your favorites!');}});return false;};function CheckLogin()
{var name=document.getElementById('name').value;ShowLoading('');$.post(dle_root+"engine/ajax/registration.php",{name:name},function(data){HideLoading('');$("#result-registration").html(data);});return false;};function doCalendar(month,year,effect){ShowLoading('');$.get(dle_root+"engine/ajax/calendar.php",{month:month,year:year},function(data){HideLoading('');if(effect=="left"){$("#calendar-layer").hide('slide',{direction:"left"},500,function(){$("#calendar-layer").html(data).show('slide',{direction:"right"},500);});}else{$("#calendar-layer").hide('slide',{direction:"right"},500,function(){$("#calendar-layer").html(data).show('slide',{direction:"left"},500);});}});};function doRate(rate,id){$.get(dle_root+"engine/ajax/rating.php",{go_rate:rate,news_id:id,skin:dle_skin},function(data){if(data.success){var rating=data.rating;rating=rating.replace(/&lt;/g,"<");rating=rating.replace(/&gt;/g,">");rating=rating.replace(/&amp;/g,"&");$("#ratig-layer-"+id).html(rating);$(".vote-num-id-"+id).html(data.votenum);$(".vote-num-minus-id-"+id).html(data.votenum_minus);$(".rating-percent-id-"+id).html(data.percent+'%').removeClass('green red gray').addClass(data.percent>=50?'green':data.percent==0&&data.votenum_minus==0?'gray':'red');$('.ratingPlus').animate({width:data.percent+'%'},'slow');$('.ratingMinus').animate({width:(100-data.percent)+'%'},'slow');$('.ratings').html(data.percent+'%'+'<span>'+(100-data.percent)+'%</span>');$('.ratingBar').removeClass('free');doFavorites(id,rate,'favorites');}else if(data.error){noticePush(data.errorinfo);}},"json");};function doCommentsRate(rate,id){ShowLoading('');$.get(dle_root+"engine/ajax/ratingcomments.php",{go_rate:rate,c_id:id,skin:dle_skin},function(data){HideLoading('');if(data.success){var rating=data.rating;rating=rating.replace(/&lt;/g,"<");rating=rating.replace(/&gt;/g,">");rating=rating.replace(/&amp;/g,"&");$("#comments-ratig-layer-"+id).html(rating);$("#comments-vote-num-id-"+id).html(data.votenum);}else if(data.error){noticePush(data.errorinfo);}},"json");};function ajax_cancel_reply(){$('#dlefastreplycomments').hide('blind',{},1400);};function ajax_fast_reply(id,indent){var comments=$('#comments'+id).val();var name=$('#name'+id).val();var mail='';var editor_mode='';var question_answer=$('#question_answer'+id).val();var sec_code=$('#sec_code'+id).val();var recaptcha=$('#recaptcha'+id).val();var allow_subscribe=$('#subscribe'+id+':checked').val();var postid=$('#postid'+id).val();if(name==''||comments=='')
{noticePush(dle_req_field);return false;}
if(recaptcha){var g_recaptcha_response=grecaptcha.getResponse(recaptcha_widget);}else{var g_recaptcha_response='';}
if(!allow_subscribe){allow_subscribe=0;}
if(!sec_code){sec_code='';}
if(!question_answer){question_answer='';}
ShowLoading('');$.post(dle_root+"engine/ajax/addcomments.php",{post_id:postid,parent:id,indent:indent,comments:comments,name:name,mail:mail,editor_mode:editor_mode,skin:dle_skin,sec_code:sec_code,question_answer:question_answer,g_recaptcha_response:g_recaptcha_response,allow_subscribe:allow_subscribe},function(data){HideLoading('');$('#blind-animation'+id).remove();$('#dlefastreplyesponse').html(data);if(data!='error'&&document.getElementById('blind-animation'+id)){$("html,body").stop().animate({scrollTop:$("#dlefastreplyesponse").offset().top-70},1100);setTimeout(function(){$('#blind-animation'+id).show('blind',{},1500);$('#dlefastreplycomments').hide('blind',{},1500);},1100);}},'html');return false;}
function dle_reply(id,indent,simple){var b={};$('#dlereplypopup').remove();if(simple=='1'){$('#dlefastreplycomments').remove();$('#dlefastreplyesponse').remove();}
$('#comment-id-'+id).parent().children('.comments-tree-list').children('.comments-tree-item').children('div').children('.mcomment').children('.childLine').hide(250,function(){$(this).remove();$('#comment-id-'+id).children('.mcomment').children('.parrentLine').hide(250,function(){$(this).remove()});});b[dle_act_lang[3]]=function(){$(this).dialog('close');};b[dle_p_send]=function(){if(dle_wysiwyg=="1"||dle_wysiwyg=="2"){if(dle_wysiwyg=="2"){tinyMCE.triggerSave();}
var editor_mode='wysiwyg';}else{var editor_mode='';}
var comments=$('#comments'+id).val();var name=$('#name'+id).val();var mail=$('#mail'+id).val();var question_answer=$('#question_answer'+id).val();var sec_code=$('#sec_code'+id).val();var recaptcha=$('#recaptcha'+id).val();var allow_subscribe=$('#subscribe'+id+':checked').val();var postid=$('#postid'+id).val();if(name==''||comments=='')
{noticePush(dle_req_field);return false;}
if(recaptcha){var g_recaptcha_response=grecaptcha.getResponse(recaptcha_widget);}else{var g_recaptcha_response='';}
if(!allow_subscribe){allow_subscribe=0;}
if(!sec_code){sec_code='';}
if(!question_answer){question_answer='';}
ShowLoading('');$.post(dle_root+"engine/ajax/addcomments.php",{post_id:postid,parent:id,indent:indent,comments:comments,name:name,mail:mail,editor_mode:editor_mode,skin:dle_skin,sec_code:sec_code,question_answer:question_answer,g_recaptcha_response:g_recaptcha_response,allow_subscribe:allow_subscribe},function(data){HideLoading('');$('#blind-animation'+id).remove();$('#comments-tree-item-'+id).append(data);if(data!='error'&&document.getElementById('blind-animation'+id)){$('#dlereplypopup').remove();$("html,body").stop().animate({scrollTop:$("#comments-tree-item-"+id).offset().top+$("#comments-tree-item-"+id).height()-70},1100);setTimeout(function(){$('#blind-animation'+id).show('blind',{},1500)},1100);}},'html');return false;};ShowLoading('');$.get(dle_root+"engine/ajax/replycomments.php",{id:id,indent:indent,skin:dle_skin},function(data){HideLoading('');if(simple=='1'){$('#comment-id-'+id).append("<div id='dlefastreplyesponse'></div><div id='dlefastreplycomments' style='display:none'></div>");$('#dlefastreplycomments').html(data);$("html,body").stop().animate({scrollTop:$("#comment-id-"+id).offset().top+$("#comment-id-"+id).height()-70},1100);setTimeout(function(){$('#dlefastreplycomments').show('blind',{},1500)},1100);}else{$('body').append("<div id='dlereplypopup' title='"+dle_reply_title+"' style='display:none'></div>");$('#dlereplypopup').html(data);$('#dlereplypopup').dialog({autoOpen:true,width:700,resizable:false,dialogClass:"modalfixed dle-popup-replycomments",buttons:b});$('.modalfixed.ui-dialog').css({position:"fixed"});$('#dlereplypopup').dialog("option","position",['0','0']);}},'html');return false;};function doAddComments(){var form=document.getElementById('dle-comments-form');if(dle_wysiwyg=="1"||dle_wysiwyg=="2"){if(dle_wysiwyg=="2"){tinyMCE.triggerSave();}
var editor_mode='wysiwyg';}else{var editor_mode='';}
if(form.comments.value==''||form.name.value=='')
{noticePush(dle_req_field);return false;}
if(form.question_answer){var question_answer=form.question_answer.value;}else{var question_answer='';}
if(form.sec_code){var sec_code=form.sec_code.value;}else{var sec_code='';}
if(typeof grecaptcha!="undefined"){var g_recaptcha_response=grecaptcha.getResponse();}else{var g_recaptcha_response='';}
if(form.allow_subscribe){if(form.allow_subscribe.checked==true){var allow_subscribe="1";}else{var allow_subscribe="0";}}else{var allow_subscribe="0";}
if(form.mail){var mail=form.mail.value;}else{var mail='';}
ShowLoading('');$.post(dle_root+"engine/ajax/addcomments.php",{post_id:form.post_id.value,comments:form.comments.value,name:form.name.value,mail:mail,editor_mode:editor_mode,skin:dle_skin,sec_code:sec_code,question_answer:question_answer,g_recaptcha_response:g_recaptcha_response,allow_subscribe:allow_subscribe},function(data){HideLoading('');$('#dle-ajax-comments').html(data);if(data!='error'&&document.getElementById('blind-animation')){$("html,body").stop().animate({scrollTop:$("#dle-ajax-comments").offset().top-70},1100);setTimeout(function(){$('#blind-animation').show('blind',{},1500)},1100);if(form.sec_code){form.sec_code.value='';reload();}
if(typeof grecaptcha!="undefined"){grecaptcha.reset();}}},'html');return false;};function isHistoryApiAvailable(){return!!(window.history&&history.pushState);};function CommentsPage(cstart,news_id,url)
{ShowLoading('');$.get(dle_root+"engine/ajax/comments.php",{cstart:cstart,news_id:news_id,skin:dle_skin},function(data){HideLoading('');if(!isNaN(cstart)&&!isNaN(news_id)){$('#dle-comm-link').off('click');$('#dle-comm-link').on('click',function(){CommentsPage(cstart,news_id);return false;});}
scroll(0,$("#dle-comments-list").offset().top-70);$("#dle-comments-list").html(data.comments);$(".dle-comments-navigation").html(data.navigation);if(isHistoryApiAvailable()){window.history.pushState(null,null,url);}},"json");return false;};function dle_copy_quote(qname)
{dle_txt='';if(window.getSelection)
{dle_txt=window.getSelection();}
else if(document.selection)
{dle_txt=document.selection.createRange().text;}
if(dle_txt!="")
{dle_txt='[quote='+qname+']'+dle_txt+'[/quote]';}};function dle_fastreply(name)
{if(!document.getElementById('dle-comments-form'))return false;var input=document.getElementById('dle-comments-form').comments;var finalhtml="";if(dle_wysiwyg=="0"||dle_wysiwyg=="-1"){if(dle_wysiwyg=="0"){input.value+="[b]"+name+"[/b],"+"\n";}else{input.value+=name+","+"\n";}
input.focus();}else{finalhtml="<b>"+name+"</b>,"+"<br />";if(dle_wysiwyg=="1"){$('#comments').froalaEditor('events.focus');$('#comments').froalaEditor('html.insert',finalhtml,true);}else{tinyMCE.execCommand('mceInsertContent',false,finalhtml)}}
setTimeout(function(){$("html,body").stop().animate({scrollTop:$("#dle-comments-form").offset().top-70},700);},100);return false;};function dle_ins(id)
{if(!document.getElementById('dle-comments-form'))return false;var input=document.getElementById('dle-comments-form').comments;var finalhtml="";if(dle_txt!=""){if(dle_wysiwyg=="0"||dle_wysiwyg=="-1"){input.value+=dle_txt+'\n';input.focus();}else{finalhtml=dle_txt+'<br />';if(dle_wysiwyg=="1"){$('#comments').froalaEditor('events.focus');$('#comments').froalaEditor('html.insert',finalhtml,true);}else{tinyMCE.execCommand('mceInsertContent',false,finalhtml)}}
setTimeout(function(){$("html,body").stop().animate({scrollTop:$("#dle-comments-form").offset().top-70},700);},100);}else{ShowLoading('');$.get(dle_root+"engine/ajax/quote.php",{id:id},function(data){HideLoading('');if(dle_wysiwyg=="0"||dle_wysiwyg=="-1"){data=data.replace(/&lt;/g,"<");data=data.replace(/&gt;/g,">");data=data.replace(/&amp;/g,"&");data=data.replace(/&quot;/g,'"');data=data.replace(/&#039;/g,"'");data=data.replace(/&#039;/g,"'");data=data.replace(/&#34;/g,'"');input.value+=data+'\n';input.focus();}else{finalhtml=data+'<br />';if(dle_wysiwyg=="1"){$('#comments').froalaEditor('events.focus');$('#comments').froalaEditor('html.insert',finalhtml,true);}else{tinyMCE.execCommand('mceInsertContent',false,finalhtml)}}
setTimeout(function(){$("html,body").stop().animate({scrollTop:$("#dle-comments-form").offset().top-70},700);},100);});}
return false;};function ShowOrHide(id){var item=$("#"+id);if(document.getElementById('image-'+id)){var image=document.getElementById('image-'+id);}else{var image=null;}
var scrolltime=(item.height()/200)*1000;if(scrolltime>3000){scrolltime=3000;}
if(scrolltime<250){scrolltime=250;}
if(item.css("display")=="none"){item.show('blind',{},scrolltime);if(image){image.src=dle_root+'templates/'+dle_skin+'/dleimages/spoiler-minus.gif';}}else{if(scrolltime>2000){scrolltime=2000;}
item.hide('blind',{},scrolltime);if(image){image.src=dle_root+'templates/'+dle_skin+'/dleimages/spoiler-plus.gif';}}};function ckeck_uncheck_all(){var frm=document.pmlist;for(var i=0;i<frm.elements.length;i++){var elmnt=frm.elements[i];if(elmnt.type=='checkbox'){if(frm.master_box.checked==true){elmnt.checked=false;}
else{elmnt.checked=true;}}}
if(frm.master_box.checked==true){frm.master_box.checked=false;}
else{frm.master_box.checked=true;}};function confirmDelete(url){DLEconfirm(dle_del_agree,dle_confirm,function(){document.location=url;});};function setNewField(which,formname)
{if(which!=selField)
{fombj=formname;selField=which;}};function dle_news_delete(id){var b={};b[dle_act_lang[1]]=function(){$(this).dialog("close");};if(allow_dle_delete_news){b[dle_del_msg]=function(){$(this).dialog("close");var bt={};bt[dle_act_lang[3]]=function(){$(this).dialog('close');};bt[dle_p_send]=function(){if($('#dle-promt-text').val().length<1){$('#dle-promt-text').addClass('ui-state-error');}else{var response=$('#dle-promt-text').val()
$(this).dialog('close');$('#dlepopup').remove();$.post(dle_root+'engine/ajax/message.php',{id:id,text:response},function(data){if(data=='ok'){document.location=dle_root+'index.php?do=deletenews&id='+id+'&hash='+dle_login_hash;}else{noticePush('Send Error');}});}};$('#dlepopup').remove();$('body').append("<div id='dlepopup' class='dle-promt' title='"+dle_notice+"' style='display:none'>"+dle_p_text+"<br /><br /><textarea name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all' style='width:97%;height:100px; padding: .4em;'></textarea></div>");$('#dlepopup').dialog({autoOpen:true,width:500,resizable:false,dialogClass:"modalfixed dle-popup-newsdelete",buttons:bt});$('.modalfixed.ui-dialog').css({position:"fixed"});$('#dlepopup').dialog("option","position",['0','0']);};}
b[dle_act_lang[0]]=function(){$(this).dialog("close");document.location=dle_root+'index.php?do=deletenews&id='+id+'&hash='+dle_login_hash;};$("#dlepopup").remove();$("body").append("<div id='dlepopup' class='dle-promt' title='"+dle_confirm+"' style='display:none'><div id='dlepopupmessage'>"+dle_del_agree+"</div></div>");$('#dlepopup').dialog({autoOpen:true,width:500,resizable:false,dialogClass:"modalfixed dle-popup-newsdelete",buttons:b});$('.modalfixed.ui-dialog').css({position:"fixed"});$('#dlepopup').dialog("option","position",['0','0']);};function MenuNewsBuild(m_id,event){var menu=new Array();menu[0]='<a onclick="ajax_prep_for_edit(\''+m_id+'\', \''+event+'\'); return false;" href="#">'+menu_short+'</a>';if(dle_admin!=''){menu[1]='<a href="'+dle_root+dle_admin+'?mod=editnews&action=editnews&id='+m_id+'" target="_blank">'+menu_full+'</a>';}
if(allow_dle_delete_news){menu[2]='<a onclick="sendNotice (\''+m_id+'\'); return false;" href="#">'+dle_notice+'</a>';menu[3]='<a onclick="dle_news_delete (\''+m_id+'\'); return false;" href="#">'+dle_del_news+'</a>';}
return menu;};function sendNotice(id){var b={};b[dle_act_lang[3]]=function(){$(this).dialog('close');};b[dle_p_send]=function(){if($('#dle-promt-text').val().length<1){$('#dle-promt-text').addClass('ui-state-error');}else{var response=$('#dle-promt-text').val()
$(this).dialog('close');$('#dlepopup').remove();$.post(dle_root+'engine/ajax/message.php',{id:id,text:response,allowdelete:"no"},function(data){if(data=='ok'){noticePush(dle_p_send_ok);}});}};$('#dlepopup').remove();$('body').append("<div id='dlepopup' title='"+dle_notice+"' style='display:none'><br />"+dle_p_text+"<br /><br /><textarea name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all' style='width:97%;height:100px; padding: .4em;'></textarea></div>");$('#dlepopup').dialog({autoOpen:true,width:500,resizable:false,dialogClass:"modalfixed dle-popup-sendmessage",buttons:b});$('.modalfixed.ui-dialog').css({position:"fixed"});$('#dlepopup').dialog("option","position",['0','0']);};function AddComplaint(id,action,uid,uname){var b={};b[dle_p_send]=function(){if($('#dle-promt-text').val().length<1){$('#dle-promt-text').addClass('ui-state-error');}else{var response=$('#dle-promt-text').val()
$(this).dialog('close');$('#dlepopup').remove();$.post(dle_root+'engine/ajax/complaint.php',{id:id,text:response,action:action},function(data){if(data=='ok'){noticePush(dle_p_send_ok);if(action=='pm'&&uid)addIgnore(uid);}else{noticePush(data);}});}};b[dle_act_lang[3]]=function(){$(this).dialog('close');};$('#dlepopup').remove();if(action=='pm'&&uname)$('body').append("<div id='dlepopup' title='Complaint Report!' style='display:none'><small>Please, let us know a reason, why should we blocked <b>"+uname+"</b> page:</small><br><br><textarea placeholder='"+dle_complaint+"' name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all'></textarea></div>");else $('body').append("<div id='dlepopup' title='Error Report!' style='display:none'><textarea placeholder='"+dle_complaint+"' name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all'></textarea></div>");$('#dlepopup').dialog({autoOpen:true,width:600,resizable:false,dialogClass:"modalfixed dle-popup-complaint",buttons:b});$('.modalfixed.ui-dialog').css({position:"fixed"});$('#dlepopup').dialog("option","position",['0','0']);};function DLEalert(message,title){$("#dlepopup").remove();$("body").append("<div id='dlepopup' class='dle-alert' title='"+title+"' style='display:none'>"+message+"</div>");$('#dlepopup').dialog({autoOpen:true,width:470,resizable:false,dialogClass:"modalfixed dle-popup-alert",buttons:{"Ok":function(){$(this).dialog("close");$("#dlepopup").remove();}}});$('.modalfixed.ui-dialog').css({position:"fixed"});$('#dlepopup').dialog("option","position",['0','0']);};function DLEconfirm(message,title,callback){var b={};b[dle_act_lang[1]]=function(){$(this).dialog("close");$("#dlepopup").remove();};b[dle_act_lang[0]]=function(){$(this).dialog("close");$("#dlepopup").remove();if(callback)callback();};$("#dlepopup").remove();$("body").append("<div id='dlepopup' class='dle-confirm' title='"+title+"' style='display:none'>"+message+"</div>");$('#dlepopup').dialog({autoOpen:true,width:500,resizable:false,dialogClass:"modalfixed dle-popup-confirm",buttons:b});$('.modalfixed.ui-dialog').css({position:"fixed"});$('#dlepopup').dialog("option","position",['0','0']);};function DLEprompt(message,d,title,callback,allowempty){var b={};b[dle_act_lang[3]]=function(){$(this).dialog("close");};b[dle_act_lang[2]]=function(){if(!allowempty&&$("#dle-promt-text").val().length<1){$("#dle-promt-text").addClass('ui-state-error');}else{var response=$("#dle-promt-text").val()
$(this).dialog("close");$("#dlepopup").remove();if(callback)callback(response);}};$("#dlepopup").remove();$("body").append("<div id='dlepopup' class='dle-promt' title='"+title+"' style='display:none'>"+message+"<br /><br /><input type='text' name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all' style='width:97%; padding: .4em;' value='"+d+"'/></div>");$('#dlepopup').dialog({autoOpen:true,width:500,resizable:false,dialogClass:"modalfixed dle-popup-promt",buttons:b});$('.modalfixed.ui-dialog').css({position:"fixed"});$('#dlepopup').dialog("option","position",['0','0']);if(d.length>0){$("#dle-promt-text").select().focus();}else{$("#dle-promt-text").focus();}};var dle_user_profile='';var dle_user_profile_link='';function ShowPopupProfile(r,allowedit)
{var b={};b[menu_profile]=function(){document.location=dle_user_profile_link;};if(dle_group!=5){b[menu_send]=function(){document.location=dle_root+'index.php?do=pm&doaction=newpm&username='+dle_user_profile;};}
if(allowedit==1){b[menu_uedit]=function(){$(this).dialog("close");var b1={};$('body').append('<div id="modal-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #666666; opacity: .40;filter:Alpha(Opacity=40); z-index: 999; display:none;"></div>');$('#modal-overlay').css({'filter':'alpha(opacity=40)'}).fadeIn('slow');$("#dleuserpopup").remove();$("body").append("<div id='dleuserpopup' title='"+menu_uedit+"' style='display:none'></div>");b1[dle_act_lang[3]]=function(){$(this).dialog("close");$("#dleuserpopup").remove();};b1[dle_act_lang[5]]=function(){window.frames.edituserframe.confirmDelete(dle_login_hash);};b1[dle_act_lang[4]]=function(){document.getElementById('edituserframe').contentWindow.document.getElementById('saveuserform').submit();};$('#dleuserpopup').dialog({autoOpen:true,show:'fade',width:560,resizable:false,dialogClass:"modalfixed dle-popup-userprofileadmin",buttons:b1,open:function(event,ui){$("#dleuserpopup").html("<iframe name='edituserframe' id='edituserframe' width='100%' height='400' src='"+dle_root+dle_admin+"?mod=editusers&action=edituser&user="+dle_user_profile+"&skin="+dle_skin+"' frameborder='0' marginwidth='0' marginheight='0' allowtransparency='true'></iframe>");},beforeClose:function(event,ui){$("#dleuserpopup").html("");},close:function(event,ui){$('#modal-overlay').fadeOut('slow',function(){$('#modal-overlay').remove();});}});if($(window).width()>830&&$(window).height()>530){$('.modalfixed.ui-dialog').css({position:"fixed"});$('#dleuserpopup').dialog("option","position",['0','0']);}};}
$("#dleprofilepopup").remove();$("body").append(r);$('#dleprofilepopup').dialog({autoOpen:true,show:'fade',hide:'fade',resizable:false,dialogClass:"dle-popup-userprofile",buttons:b,width:550});return false;};function ShowProfile(name,url,allowedit)
{if(dle_user_profile==name&&document.getElementById('dleprofilepopup')){$('#dleprofilepopup').dialog('open');return false;}
dle_user_profile=name;dle_user_profile_link=url;ShowLoading('');$.get(dle_root+"engine/ajax/profile.php",{name:name,skin:dle_skin},function(data){HideLoading('');ShowPopupProfile(data,allowedit);});return false;};function FastSearch()
{$('#story').attr('autocomplete','off');$('#story').blur(function(){});$('#story').keyup(function(){var inputString=$(this).val();if(inputString.length==0){$('#searchsuggestions').fadeOut();}else{if(dle_search_value!=inputString&&inputString.length>1){clearInterval(dle_search_delay);dle_search_delay=setInterval(function(){dle_do_search(inputString);},600);}}});};function dle_do_search(inputString)
{clearInterval(dle_search_delay);$('#searchsuggestions').remove();$(".search-form").append("<div id='searchsuggestions' style='display:none'></div>");$.post(dle_root+"engine/ajax/search.php",{query:""+inputString+""},function(data){$('#searchsuggestions').html(data).fadeIn().css({'position':'absolute',width:$('#story').outerWidth(),top:0,left:0}).position({my:"left top",at:"left bottom",of:"#story",collision:"fit flip"});});dle_search_value=inputString;};function ShowLoading(message)
{$('#loading-layer').remove();$('body > .header').append("<div id='loading-layer' style='display:none'></div>");if(message)
{$("#loading-layer").html(message);}else{$("#loading-layer").html("Loading. Please, wait...");}
$("#loading-layer").show().animate({width:'65%'},$(window).width()/2);};function HideLoading(message)
{$("#loading-layer").stop().animate({width:'100%'},'slow').fadeOut('slow',function(){$('#loading-layer').remove();});};function ShowAllVotes()
{if(document.getElementById('dlevotespopup')){$('#dlevotespopup').dialog('open');return false;}
$.ajaxSetup({cache:false});ShowLoading('');$.get(dle_root+"engine/ajax/allvotes.php?dle_skin="+dle_skin,function(data){HideLoading('');$("#dlevotespopup").remove();$("body").append(data);$(".dlevotebutton").button();$('#dlevotespopup').dialog({autoOpen:true,show:'fade',hide:'fade',resizable:false,dialogClass:"dle-popup-allvotes",width:600});if($('#dlevotespopupcontent').height()>400){$('#dlevotespopupcontent').height(400);$('#dlevotespopup').dialog("option","height",$('#dlevotespopupcontent').height()+60);$('#dlevotespopup').dialog("option","position",'center');}else{$('#dlevotespopup').dialog("option","height",$('#dlevotespopupcontent').height()+60);$('#dlevotespopup').dialog("option","position",'center');}});return false;};function fast_vote(vote_id)
{var vote_check=$('#vote_'+vote_id+' input:radio[name=vote_check]:checked').val();ShowLoading('');$.get(dle_root+"engine/ajax/vote.php",{vote_id:vote_id,vote_action:"vote",vote_mode:"fast_vote",vote_check:vote_check,vote_skin:dle_skin},function(data){HideLoading('');$("#dle-vote_list-"+vote_id).fadeOut(500,function(){$(this).html(data);$(this).fadeIn(500);});});return false;};function AddIgnorePM(id,text){DLEconfirm(text,dle_confirm,function(){ShowLoading('');$.get(dle_root+"engine/ajax/pm.php",{id:id,action:"add_ignore",skin:dle_skin},function(data){HideLoading('');noticePush(data);return false;});});};function DelIgnorePM(id,text){DLEconfirm(text,dle_confirm,function(){ShowLoading('');$.get(dle_root+"engine/ajax/pm.php",{id:id,action:"del_ignore",skin:dle_skin},function(data){HideLoading('');$("#dle-ignore-list-"+id).html('');noticePush(data);return false;});});};function subscribe(id){DLEconfirm(dle_sub_agree,dle_confirm,function(){ShowLoading('');$.get(dle_root+"engine/ajax/commentssubscribe.php",{news_id:id,skin:dle_skin,user_hash:dle_login_hash},function(data){HideLoading('');if(data.success){noticePush(data.info);}else if(data.error){noticePush(data.errorinfo);}},"json");});return false;};function media_upload(area,author,news_id,wysiwyg){var rndval=new Date().getTime();var shadow='none';$('#mediaupload').remove();$('body').append("<div id='mediaupload' title='"+text_upload+"' style='display:none'></div>");$('#mediaupload').dialog({autoOpen:true,width:710,resizable:false,dialogClass:"modalfixed dle-popup-upload",open:function(event,ui){$("#mediaupload").html("<iframe name='mediauploadframe' id='mediauploadframe' width='100%' height='550' src='"+dle_root+"engine/ajax/upload.php?area="+area+"&author="+author+"&news_id="+news_id+"&wysiwyg="+wysiwyg+"&skin="+dle_skin+"&rndval="+rndval+"' frameborder='0' marginwidth='0' marginheight='0' allowtransparency='true'></iframe>");$(".ui-dialog").draggable("option","containment","");},dragStart:function(event,ui){shadow=$(".modalfixed").css('box-shadow');$(".modalfixed").fadeTo(0,0.6).css('box-shadow','none');$("#mediaupload").css('visibility','hidden');},dragStop:function(event,ui){$(".modalfixed").fadeTo(0,1).css('box-shadow',shadow);$("#mediaupload").css('visibility','visible');},beforeClose:function(event,ui){$("#mediaupload").html("");}});if($(window).width()>830&&$(window).height()>530){$('.modalfixed.ui-dialog').css({position:"fixed"});$('#mediaupload').dialog("option","position",['0','0']);}
return false;};function dropdownmenu(obj,e,menucontents,menuwidth){if(window.event)event.cancelBubble=true;else if(e.stopPropagation)e.stopPropagation();var menudiv=$('#dropmenudiv');if(menudiv.is(':visible')){clearhidemenu();menudiv.fadeOut('fast');return false;}
menudiv.remove();$('body').append('<div id="dropmenudiv" style="display:none;position:absolute;z-index:100;width:165px;"></div>');menudiv=$('#dropmenudiv');menudiv.html(menucontents.join(""));if(menuwidth)menudiv.width(menuwidth);var windowx=$(document).width()-30;var offset=$(obj).offset();if(windowx-offset.left<menudiv.width())
offset.left=offset.left-(menudiv.width()-$(obj).width());menudiv.css({left:offset.left+"px",top:offset.top+$(obj).height()+"px"});menudiv.fadeTo('fast',0.9);menudiv.mouseenter(function(){clearhidemenu();}).mouseleave(function(){delayhidemenu();});$(document).one("click",function(){hidemenu();});return false;};function hidemenu(e){$("#dropmenudiv").fadeOut("fast");};function delayhidemenu(){delayhide=setTimeout("hidemenu()",1000);};function clearhidemenu(){if(typeof delayhide!="undefined")
clearTimeout(delayhide);};jQuery(function($){$(document).keydown(function(event){if(event.which==13&&event.ctrlKey){event.preventDefault();if(window.getSelection){var selectedText=window.getSelection();}
else if(document.getSelection){var selectedText=document.getSelection();}
else if(document.selection){var selectedText=document.selection.createRange().text;}
if(selectedText==""){return false;}
if(selectedText.toString().length>255){noticePush(dle_big_text);return false;}
var b={};b[dle_act_lang[3]]=function(){$(this).dialog('close');};b[dle_p_send]=function(){if($('#dle-promt-text').val().length<1){$('#dle-promt-text').addClass('ui-state-error');}else{var response=$('#dle-promt-text').val();var selectedText=$('#orfom').text();$(this).dialog('close');$('#dlepopup').remove();$.post(dle_root+'engine/ajax/complaint.php',{seltext:selectedText,text:response,action:"orfo",url:window.location.href},function(data){if(data=='ok'){noticePush(dle_p_send_ok);}else{noticePush(data);}});}};$('#dlepopup').remove();$('body').append("<div id='dlepopup' class='dle-promt' title='"+dle_orfo_title+"' style='display:none'><textarea name='dle-promt-text' id='dle-promt-text' class='ui-widget-content ui-corner-all' style='width:97%;height:80px; padding: .4em;'></textarea><div id='orfom' style='display:none'>"+selectedText+"</div></div>");$('#dlepopup').dialog({autoOpen:true,width:600,resizable:false,dialogClass:"modalfixed dle-popup-complaint",buttons:b});$('.modalfixed.ui-dialog').css({position:"fixed"});$('#dlepopup').dialog("option","position",['0','0']);};});});