
var _gaq=_gaq||[];window.displayList={};window.playList={};var currentTrack=0;var currentPlayerObj=[];var currentUrl;var prevUrl;var activeList=null;var profile={};var static_http_server;var initial_ts;var initial_ref='';var track_load_start_ts;var dragging_position=false;var playerStatus='';var playerDisplayed='normal';var loaded_event_timeout=0;var playback_event_timeout=0;var playback_event_count=0;var playback_manual=0;var player_position;var player_duration;var player_volume=50;var player_repeat_mode=false;var player_repeat_count=0;var page_updater;var skip_update_page_contents=0;var notificationTimeout=0;var spyTimeout=0;var show_loading_timeout;var album_rs=[];var album_r_curr=[];var master_ord;var ad_feedback_code;var ad_feedback_position;var is_infinite_scroll=false;var ua_info={};var ad_reload_timeout;var vice_regions=[];var w00t_regions=[];var w00t_regions_expanded=['RU','HK','KR','MY','JP','TH','SG','BR','IN','MX','CN','NZ'];var excluded_tsm=['IE','GB','CA'];var mixed_regions=[];var mixed_region_rand;var _comscore=_comscore||[];var quantSegs=[];var toast_prompt_shown=false;var window_hidden=false;var redraw_ads_on_show=true;var first_load;var dfp_state=[];dfp_state.slots=[];dfp_state.display_queue=[];dfp_state.update_queue=[];var googletag=googletag||{};var vice_skin_order_id=0;var lb_dimensions={"login":{width:310,height:540},"login_email":{width:310,height:230},"signup":{width:310,height:550},"listen":{width:310,height:250},"confirm_new_twitter":{width:410,height:210},"confirm_new_facebook":{width:410,height:210},"confirm_new_soundcloud":{width:410,height:210},"forgot":{width:310,height:250},"reset":{width:310,height:250},"change_password":{width:310,height:360},"change_username":{width:310,height:340},"change_email":{width:310,height:340},"account":{width:310,height:630},"sharing":{width:310,height:520},"privacy":{width:310,height:550},"sub_only":{width:310,height:175},"sub_heavy":{width:310,height:245},"supportus":{width:300,height:580}};var fp=0;var spotify_auth=[];var spotify_player=[];var spotify_prev_state=[];var preferred_premium="spotify";var yt_player=false;var mixcloud_load_timeout=false;var websocket_conn=0;var websocket_reconnect_timeout=0;var token_websocket_conn=0;var token_websocket_reconnect_timeout=0;(function($){window.get_cookie=function(name){var start=document.cookie.indexOf(name+"=");var len=start+name.length+1;if((!start)&&(name!==document.cookie.substring(0,name.length))){return null;}
if(start===-1){return null;}
var end=document.cookie.indexOf(";",len);if(end===-1){end=document.cookie.length;}
return decodeURIComponent(document.cookie.substring(len,end));};window.set_cookie=function(name,value,expires,path,domain,secure){var today=new Date();today.setTime(today.getTime());if(expires){expires=expires*1000*60*60*24;}
var expires_date=new Date(today.getTime()+(expires));document.cookie=name+"="+encodeURIComponent(value)+((expires)?";expires="+expires_date.toUTCString():'')+((path)?";path="+path:'')+((domain)?";domain="+domain:'')+((secure)?";secure":'');};window.is_dev=function(){if(document.location.href.match(/dev.hypem.com/i)){return true;}else return document.location.href.match(/debug_console/i);};window.set_ad_vars=function(){window.master_ord=parseInt(Math.random()*100000000000);var pv_addr;if(document.location.href.search(/\/#!?\//)!=-1){pv_addr=document.location.hash;pv_addr=pv_addr.replace(/#!?\//,'/');}else{pv_addr=document.location.pathname;}
var head=document.getElementsByTagName('head')[0];for(var i=0;i<custom_css.length;i++){var page=custom_css[i];if(typeof(page)!="undefined"&&pv_addr.match(page.match)){if(!$('#'+page.id).length){var css_sheet=document.createElement('link');css_sheet.type="text/css";css_sheet.rel="stylesheet";css_sheet.id=page.id;css_sheet.href=page.href;head.appendChild(css_sheet);}
$('#takeover-link').remove();if(typeof page.target!='undefined'){var t=$('<div/>',{id:'takeover-link'});var a=$('<a/>',{href:page.target,target:'_blank'});var i=$('<img/>',{src:page.pixel+'&cb='+(+new Date()+Math.round(Math.random()*1000))});a.append(i);t.append(a);$('body').eq(0).append(t);}}else if(typeof(page)!="undefined"&&!document.location.href.match(page.match)&&$('#'+page.id).length){$('#'+page.id).remove();$('#takeover-link').remove();}else{}}};window.logged_in=function(){if(typeof window.login_deferred==='object'){return window.login_deferred;}else{window.login_deferred=new $.Deferred();if(profile.is_logged_in){window.login_deferred.resolve();}else{show_lightbox('listen','/inc/lb_signup_info');}
return window.login_deferred;}}
window.keyCodeInfo=function(e){var info={},target=$(e.target)||$(e.srcElement);if(!e){e=window.event;}
info.code=e.keyCode?e.keyCode:e.which;info.shortcut=e.ctrlKey||e.altKey||e.metaKey;info.shiftKey=!!e.shiftKey;info.textarea=target.is('input')||target.is('textarea');return info;};$(window).bind('keyup',function(e){var keyInfo=keyCodeInfo(e);if(keyInfo.code=="27"){if(window.self!==window.top){window.cancel_iframe_dialog();}
$('#keyboard').hide();return false;}
if(!keyInfo.shortcut&&!keyInfo.textarea){if(keyInfo.code==191&&keyInfo.shiftKey){toggleShowKeyboardShortcuts();return false;}
if(keyInfo.code==191&&!keyInfo.shiftKey){$('#q').focus();return false;}
if(keyInfo.code==39){nextTrack();return false;}
if(keyInfo.code==37){prevTrack();return false;}}});$(window).bind('keydown',function(e){var keyInfo=keyCodeInfo(e);if(!keyInfo.shortcut&&!keyInfo.textarea){var character=String.fromCharCode(keyInfo.code);if(character=='N'||character=='J'||character=='B'){nextTrack();return false;}
else if(character=='P'||character=='K'||character=='Z'){prevTrack();return false;}
else if(character=='L'||character=='H'||character=='F'){toggleFavoriteItem();return false;}
else if(character=='X'||character=='C'||character=='Z'||keyInfo.code==32){togglePlay();return false;}
else if(character=='V'){stopTrack();return false;}
else if(keyInfo.code==189||keyInfo.code==173||keyInfo.code==109){if(player_volume>4){player_volume=player_volume-5;if(currentPlayerObj[0]){currentPlayerObj[0].setVolume(player_volume);}
player_elements.volume_ctrl.height(player_volume+'%');}}
else if(keyInfo.code==187||keyInfo.code==61||keyInfo.code==107){if(player_volume<95){player_volume=player_volume+5;if(currentPlayerObj[0]){currentPlayerObj[0].setVolume(player_volume);}
player_elements.volume_ctrl.height(player_volume+'%');}}}});window.init_selectors=function(){window.player_elements={time_position:$('#player-time-position'),time_total:$('#player-time-total'),progress_loading:$('#player-progress-loading'),progress_playing:$('#player-progress-playing'),progress_outer:$('#player-progress-outer'),volume_outer:$('#player-volume-outer'),volume_ctrl:$('#player-volume-ctrl'),volume_mute:$('#player-volume-mute'),repeat_ctrl:$('#playerRepeat'),prev:$('#playerPrev'),next:$('#playerNext'),from_prev_page:$('#player-page'),nowplaying:$('#player-nowplaying'),player_controls:$('#player-controls'),container:$('#player-container'),player_inner:$('#player-inner')}};window.load_olark=function(){if(typeof(olark)=="undefined"){window.olark||(function(c){var f=window,d=document,l=f.location.protocol=="https:"?"https:":"http:",z=c.name,r="load";var nt=function(){f[z]=function(){(a.s=a.s||[]).push(arguments)};var a=f[z]._={},q=c.methods.length;while(q--){(function(n){f[z][n]=function(){f[z]("call",n,arguments)}})(c.methods[q])}
a.l=c.loader;a.i=nt;a.p={0:+new Date};a.P=function(u){a.p[u]=new Date-a.p[0]};function s(){a.P(r);f[z](r)}
f.addEventListener?f.addEventListener(r,s,false):f.attachEvent("on"+r,s);var ld=function(){function p(hd){hd="head";return["<",hd,"></",hd,"><",i,' onl'+'oad="var d=',g,";d.getElementsByTagName('head')[0].",j,"(d.",h,"('script')).",k,"='",l,"//",a.l,"'",'"',"></",i,">"].join("")}
var i="body",m=d[i];if(!m){return setTimeout(ld,100)}
a.P(1);var j="appendChild",h="createElement",k="src",n=d[h]("div"),v=n[j](d[h](z)),b=d[h]("iframe"),g="document",e="domain",o;n.style.display="none";m.insertBefore(n,m.firstChild).id=z;b.frameBorder="0";b.id=z+"-loader";if(/MSIE[ ]+6/.test(navigator.userAgent)){b.src="javascript:false"}
b.allowTransparency="true";v[j](b);try{b.contentWindow[g].open()}catch(w){c[e]=d[e];o="javascript:var d="+g+".open();d.domain='"+d.domain+"';";b[k]=o+"void(0);"}
try{var t=b.contentWindow[g];t.write(p());t.close()}catch(x){b[k]=o+'d.write("'+p().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}
a.P(2)};ld()};nt()})({loader:"static.olark.com/jsclient/loader0.js",name:"olark",methods:["configure","extend","declare","identify"]});olark.identify('8642-858-10-6552');olark('api.chat.updateVisitorNickname',{snippet:profile.logged_in_username});}};window.load_user_menu=function(){if(!is_hypem()){return false;}
return $.ajax({url:'/inc/header_menu',cache:false,type:'get',success:function(response){$('#filter').html(response);profile=jQuery.parseJSON($('#profile-data').remove().html())||{};if(profile.player_volume){player_volume=profile.player_volume;player_elements.volume_ctrl.height(player_volume+'%');}
if(profile.player_repeat){player_repeat_mode=profile.player_repeat;if(player_repeat_mode=="full"){player_elements.repeat_ctrl.addClass('player-repeat-active');}}
if(profile.feed_viewed_ts){check_section_updated('feed',profile.feed_viewed_ts);}
}});};window.page_url_state_init=function(){var url;initial_ts=get_unix_time();inital_ref=document.referrer;load_ad_code(profile.user_country);if(document.location.href.search('\\?forgot=1&key=')!=-1){show_lightbox("reset",'/inc/lb_reset_pw?key='+getQueryVariable('key'));}else if(document.location.href.match(/^https:\/\/.+[\&\?]login=1$/)&&!profile.is_logged_in){show_lightbox("login");}else if(document.location.href.search('\\?forgot=1')!=-1){show_lightbox("forgot");}else if(document.location.href.search('\\?signup=1')!=-1){show_lightbox("signup");}
if(is_html5_history_compat()){if(document.location.href.match(/com\/(\?.+)?$/)&&profile.is_logged_in){update_page_contents();}else if(document.location.href.match(/com\/(\?.+)?$/)&&!profile.is_logged_in){url='/latest';history.replaceState(null,null,url);first_load=0;update_page_contents();}else if(document.location.href.match(/\/#!?/)){url=document.location.href.replace(/\/#!?\//,'/');history.replaceState(null,null,url);first_load=0;update_page_contents();}else{update_page_contents();}}
if(!document.location.href.match(/_escaped_fragment_/)){currentUrl=get_current_rel_url();prevUrl=currentUrl;$(window).on('popstate',check_hash_change);}};window.qc_results=function(result){for(var i=0;i<result.segments.length;i++){quantSegs.push(result.segments[i].id);}};window.load_ad_code=function(country){if(profile.ads_enabled){}
else{return false;}
var rand;if(jQuery.inArray(profile.user_country,mixed_regions)!==-1){rand=Math.random();if(rand>0.5){mixed_region_rand='vice';}else{mixed_region_rand='w00t';}}
if(jQuery.inArray(profile.user_country,w00t_regions)!==-1){var elem=document.createElement('script');elem.src="https://segapi.quantserve.com/api/segments.json?a=p-70RhgKmunzjBs&callback=qc_results";elem.id="gb_qcsegs";elem.async=false;elem.type="text/javascript";var scpt=document.getElementsByTagName('script')[0];scpt.parentNode.insertBefore(elem,scpt);var s,e;s=document.createElement("script");s.src="//a1.vdna-assets.com/analytics.js";s.async=true;e=document.getElementsByTagName("head")[0];e.insertBefore(s,e.firstChild);this.VDNA=this.VDNA||{};this.VDNA.queue=this.VDNA.queue||[];}
googletag.cmd=googletag.cmd||[];(function(){var gads=document.createElement("script");gads.async=true;gads.type="text/javascript";var useSSL="https:"==document.location.protocol;gads.src=(useSSL?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";var node=document.getElementsByTagName("script")[0];node.parentNode.insertBefore(gads,node);})();};window.draw_ads=function(draw_context){var elt,new_iframe;if(typeof(draw_context)=="undefined"){draw_context="initial";}
window.clearTimeout(ad_reload_timeout);if(displayList['url'].match(/(email_manage|about|contact|hotel|zeitgeist|\/set|sonos_splash|bbc6|greatescape|roskilde|ones-to-watch|hypeon|cmj2025|cmj2015|moogfest|form-2016|find_friends|link-sc|link-spotify|kero-bonito-tour|support\-us|playlist-tracker|connect|supporter-update|bandcamp|merch-table)/)){return false;}
if(profile.ads_enabled){}
else{return false;}
if(Object.keys(dfp_state.slots).length==0){if(profile.user_country=="US"||jQuery.inArray(profile.user_country,excluded_tsm)===-1){googletag.cmd.push(function(){googletag.pubads().enableSingleRequest();googletag.pubads().collapseEmptyDivs();switch(displayList.page_name){case"latest":googletag.pubads().setTargeting('sec',['latest']);break;case"popular":googletag.pubads().setTargeting('sec',['popular']);break;case"item":googletag.pubads().setTargeting('sec',['artist_track']);break;case"premieres-all":googletag.pubads().setTargeting('sec',['album']);break;case"stack":googletag.pubads().setTargeting('sec',['stack']);break;}
if(getQueryVariable("test")){googletag.pubads().setTargeting('sec',['test']);}
googletag.enableServices();});}else if(profile.user_country=="CA"){googletag.cmd.push(function(){googletag.pubads().enableSingleRequest();googletag.pubads().collapseEmptyDivs();googletag.pubads().setTargeting('g',['m']).setTargeting('page',['z']).setTargeting('sage',['y']).setTargeting('topic',['mus']);dfp_state.slots["728x90"]=googletag.defineSlot('16916245/hypem.com',[[728,90],[970,90],[970,250]],"ad-leaderboard-frame").addService(googletag.pubads());if(vice_skin_order_id){dfp_state.slots["300x250-1"]=googletag.defineSlot('16916245/hypem.com',[[300,600],[300,250]],"ad-rectangleA-frame").addService(googletag.pubads()).setTargeting('orderID',[vice_skin_order_id]);}else{dfp_state.slots["300x250-1"]=googletag.defineSlot('16916245/hypem.com',[[300,600],[300,250]],"ad-rectangleA-frame").addService(googletag.pubads());}
dfp_state.slots["300x250-2"]=googletag.defineSlot('16916245/hypem.com',[[300,250]],"ad-rectangleB-frame").addService(googletag.pubads())
googletag.enableServices();});}else if(jQuery.inArray(profile.user_country,vice_regions)!==-1||mixed_region_rand=="vice"){googletag.cmd.push(function(){googletag.pubads().enableSingleRequest();googletag.pubads().collapseEmptyDivs();var mapping_top=googletag.sizeMapping().addSize([1,1],[[300,250],[320,50]]).addSize([768,135],[[728,415],[728,90]]).addSize([985,250],[[970,550],[970,250],[970,90],[728,90]]).build();var mapping_sidebar=googletag.sizeMapping().addSize([1,1],[]).addSize([985,135],[[300,600],[300,250]]).build();var mapping_all=googletag.sizeMapping().addSize([1,1],[1,1]).build();if(ua_info.is_mobile){dfp_state.slots["320x50"]=googletag.defineSlot('16916245/hypem.com',[],'ad-leaderboard-frame').defineSizeMapping(mapping_top).setTargeting('pos',['t']).addService(googletag.pubads());}else{dfp_state.slots["728x90"]=googletag.defineSlot('16916245/hypem.com',[],'ad-leaderboard-frame').defineSizeMapping(mapping_top).setTargeting('pos',['t']).addService(googletag.pubads());dfp_state.slots["300x250-1"]=googletag.defineSlot('16916245/hypem.com',[],"ad-rectangleA-frame").defineSizeMapping(mapping_sidebar).setTargeting('pos',['t']).addService(googletag.pubads());dfp_state.slots["300x250-2"]=googletag.defineSlot('16916245/hypem.com',[],"ad-rectangleB-frame").defineSizeMapping(mapping_sidebar).setTargeting('pos',['l']).addService(googletag.pubads());dfp_state.slots["skin"]=googletag.defineSlot('16916245/hypem.com',[],"vice-special-frame").defineSizeMapping(mapping_all).addService(googletag.pubads());}
googletag.enableServices();});}else if(jQuery.inArray(profile.user_country,w00t_regions)!==-1||mixed_region_rand=="w00t"){googletag.cmd.push(function(){googletag.pubads().enableSingleRequest();googletag.pubads().collapseEmptyDivs();if(ua_info.is_mobile){dfp_state.slots["320x50"]=googletag.defineSlot('/4183072/TheHypeMachine_ROS_Mobile_320x50',[[320,50],[640,100]],'ad-leaderboard-frame').addService(googletag.pubads());}else{dfp_state.slots["728x90"]=googletag.defineSlot('/4183072/TheHypeMachine_Home_ATF_728x90_970x250',[[728,90],[952,250],[970,90],[970,125],[970,250]],'ad-leaderboard-frame').addService(googletag.pubads());dfp_state.slots["w00t-special"]=googletag.defineSlot('/4183072/TheHypeMachine_Home_1x1_Skin',[1,1],"w00t-special-frame").addService(googletag.pubads());dfp_state.slots["300x250-1"]=googletag.defineSlot('/4183072/TheHypeMachine_Home_ATF_300x250_300x600',[[300,250],[300,600]],'ad-rectangleA-frame').addService(googletag.pubads());dfp_state.slots["300x250-2"]=googletag.defineSlot('/4183072/TheHypeMachine_ROS_BTF_300x250',[[300,250]],'ad-rectangleB-frame').addService(googletag.pubads());dfp_state.slots["728x90-mid"]=googletag.defineSlot('/4183072/TheHypeMachine_Home_ATF_728x90_970x250',[[728,90],[952,250],[970,90],[970,125],[970,250]],"ad-leaderboard-midpage-frame").addService(googletag.pubads());dfp_state.slots["300x250-mid"]=googletag.defineSlot('/4183072/TheHypeMachine_ROS_BTF_300x250',[[300,250]],"ad-rectangleB-midpage-frame").addService(googletag.pubads());}
googletag.enableServices();});}else{googletag.cmd.push(function(){googletag.pubads().enableSingleRequest();googletag.pubads().collapseEmptyDivs();dfp_state.slots["728x90"]=googletag.defineSlot('/1030811/LeaderboardHybrid',[[728,90],[1280,145]],"ad-leaderboard-frame").addService(googletag.pubads());dfp_state.slots["300x250-1"]=googletag.defineSlot('/1030811/RectangleHybrid',[[300,250],[300,600]],"ad-rectangleA-frame").addService(googletag.pubads());dfp_state.slots["300x250-2"]=googletag.defineSlot('/1030811/RectangleHybrid',[[300,250]],"ad-rectangleB-frame").addService(googletag.pubads());googletag.enableServices();});}}
if(profile.user_country=="US"||jQuery.inArray(profile.user_country,excluded_tsm)===-1){elt=$('.ht-special')[0];if(elt&&!$(elt).children('div').length){var iframe_id=$(elt).attr('class')+"-frame";_insert_ad_iframe('skin',"ht-special",iframe_id,elt);}}
if(jQuery.inArray(profile.user_country,w00t_regions)!==-1||mixed_region_rand=="w00t"){elt=$('.w00t-special')[0];if(elt&&!$(elt).children('div').length){var iframe_id=$(elt).attr('class')+"-frame";_insert_ad_iframe('skin',"w00t-special",iframe_id,elt);}}
if(jQuery.inArray(profile.user_country,vice_regions)!==-1||mixed_region_rand=="vice"){elt=$('.vice-special')[0];if(elt&&!$(elt).children('div').length){var iframe_id=$(elt).attr('class')+"-frame";_insert_ad_iframe('skin',"vice-special",iframe_id,elt);}}
elt=$('.ad-leaderboard')[0];if(is_infinite_scroll){if($('.ad-leaderboard-midpage').length>1){$('.ad-leaderboard-midpage')[0].remove();}
elt=$('.ad-leaderboard-midpage')[($('.ad-leaderboard-midpage').length-1)];}
if(elt&&(draw_context=="infinite_scroll"||is_element_top_in_viewport(elt))&&!$(elt).children('iframe').length){var iframe_id=$(elt).attr('id')+"-frame";if(ua_info.is_mobile){_insert_ad_iframe('320x50',"ad-leaderboard-frame",iframe_id,elt);}else if(is_infinite_scroll&&(profile.user_country=="US"||jQuery.inArray(profile.user_country,excluded_tsm)===-1)){_insert_ad_iframe('728x90-mid',"ad-leaderboard-midpage-frame",iframe_id,elt);}else{_insert_ad_iframe('728x90',"ad-leaderboard-frame",iframe_id,elt);}}
elt=$('.ad-leaderboard-tracks-B')[0];if(is_infinite_scroll){if($('.ad-leaderboard-tracks-B').length>1){$('.ad-leaderboard-tracks-B')[0].remove();}
elt=$('.ad-leaderboard-tracks-B')[($('.ad-leaderboard-tracks-B').length-1)];}
if(elt&&(draw_context=="scroll"||draw_context=="scroll-track"||is_element_top_in_viewport(elt))&&!$(elt).children('iframe').length){var iframe_id=$(elt).attr('id')+"-frame";if(ua_info.is_mobile){}else if(profile.user_country=="US"||jQuery.inArray(profile.user_country,excluded_tsm)===-1){_insert_ad_iframe('728x90-tracks-B',"ad-leaderboard-tracks-B-frame",iframe_id,elt);}}
elt=$('.ad-rectangleA')[0];if(elt&&is_element_top_in_viewport(elt)&&!$(elt).children('iframe').length){var iframe_id=$(elt).attr('id')+"-frame";if(ua_info.is_mobile){}else if(is_infinite_scroll&&(profile.user_country=="US"||jQuery.inArray(profile.user_country,excluded_tsm)===-1)){}else{_insert_ad_iframe('300x250-1',"ad-rectangle-frame",iframe_id,elt);}}
elt=$('.ad-rectangleB')[0];if(is_infinite_scroll){if($('.ad-rectangleB-midpage').length>1){$('.ad-rectangleB-midpage')[0].remove();}
elt=$('.ad-rectangleB-midpage')[($('.ad-rectangleB-midpage').length-1)];}
if(elt&&draw_context!="initial"&&draw_context!="scroll-tracks"&&(draw_context=="scroll"||draw_context=="infinite_scroll"||is_element_top_in_viewport(elt))&&!$(elt).children('iframe').length){var iframe_id=$(elt).attr('id')+"-frame";if(ua_info.is_mobile){}else if(is_infinite_scroll&&(profile.user_country=="US"||jQuery.inArray(profile.user_country,excluded_tsm)===-1)){_insert_ad_iframe('300x250-mid',"ad-rectangle-midpage-frame",iframe_id,elt);}else{_insert_ad_iframe('300x250-2',"ad-rectangle-frame",iframe_id,elt);}}
window.setTimeout(function(){if(dfp_state.display_queue.length){googletag.cmd.push(function(){googletag.display(dfp_state.display_queue[0]['iframe_id']);});dfp_state.display_queue=[];}
if(dfp_state.update_queue.length){googletag.cmd.push(function(){googletag.pubads().refresh(dfp_state.update_queue);});dfp_state.update_queue=[];}},500);if(!ua_info.is_mobile){ad_reload_timeout=window.setTimeout(function(){redraw_ads();},120000);}};window._insert_ad_iframe=function(position_name,iframe_class,iframe_id,parent_elt){if(profile.user_country=="US"||jQuery.inArray(profile.user_country,excluded_tsm)===-1){if(typeof($('#'+iframe_id))=="undefined"||!$('#'+iframe_id).length){new_iframe=$('<div/>',{'id':iframe_id});$(parent_elt).append(new_iframe);}
googletag.cmd.push(function(){if(ua_info.is_mobile&&position_name=="320x50"&&typeof(dfp_state.slots[position_name])==="undefined"){dfp_state.slots["320x50"]=googletag.defineSlot('1984618/HypeM_Mobile',[[300,250],[320,100],[320,50]],"ad-leaderboard-frame").setTargeting('pos',['atf']).addService(googletag.pubads());dfp_state.slots[position_name]['iframe_id']=iframe_id;}
if(position_name=="728x90"&&typeof(dfp_state.slots[position_name])==="undefined"){dfp_state.slots["728x90"]=googletag.defineSlot('1984618/HypeM_Horizontal-Flex',[[970,250]],"ad-leaderboard-frame").setTargeting('pos',['atf']).addService(googletag.pubads());dfp_state.slots[position_name]['iframe_id']=iframe_id;}
if(position_name=="300x250-1"&&typeof(dfp_state.slots[position_name])==="undefined"){dfp_state.slots["300x250-1"]=googletag.defineSlot('1984618/HypeM_Vertical-Flex',[[300,250],[300,600]],"ad-rectangleA-frame").setTargeting('pos',['atf']).addService(googletag.pubads());dfp_state.slots[position_name]['iframe_id']=iframe_id;}
if(position_name=="300x250-2"&&typeof(dfp_state.slots[position_name])==="undefined"){dfp_state.slots["300x250-2"]=googletag.defineSlot('1984618/HypeM_MR',[300,250],"ad-rectangleB-frame").setTargeting('pos',['btf']).addService(googletag.pubads());dfp_state.slots[position_name]['iframe_id']=iframe_id;}
if(position_name=="728x90-tracks-B"&&typeof(dfp_state.slots[position_name])==="undefined"){dfp_state.slots["728x90-tracks-B"]=googletag.defineSlot('1984618/HypeM_LB',[[728,90]],"ad-leaderboard-tracks-B-frame").setTargeting('pos',['btf','break']).addService(googletag.pubads());dfp_state.slots[position_name]['iframe_id']=iframe_id;}
if(position_name=="728x90-mid"&&typeof(dfp_state.slots[position_name])==="undefined"){dfp_state.slots["728x90-mid"]=googletag.defineSlot('1984618/HypeM_LB',[[728,90]],"ad-leaderboard-midpage-frame").setTargeting('pos',['btf','break']).addService(googletag.pubads());dfp_state.slots[position_name]['iframe_id']=iframe_id;}
if(position_name=="300x250-mid"&&typeof(dfp_state.slots[position_name])==="undefined"){dfp_state.slots["300x250-mid"]=googletag.defineSlot('1984618/HypeM_Vertical-Flex',[[300,250],[300,600]],"ad-rectangleB-midpage-frame").setTargeting('pos',['btf']).addService(googletag.pubads());dfp_state.slots[position_name]['iframe_id']=iframe_id;}
if(position_name=="skin"&&typeof(dfp_state.slots[position_name])==="undefined"){dfp_state.slots["skin"]=googletag.defineSlot('1984618/HypeM_1x1_Skin',[[1,1]],"ht-special-frame").addService(googletag.pubads());dfp_state.slots[position_name]['iframe_id']=iframe_id;}
if(typeof(dfp_state.slots[position_name])!=='undefined'&&typeof(dfp_state.slots[position_name]['displayed'])==='undefined'){dfp_state.display_queue.push(dfp_state.slots[position_name]);dfp_state.slots[position_name]['displayed']=1;}else{dfp_state.update_queue.push(dfp_state.slots[position_name]);}});}else if(profile.user_country=="CA"){new_iframe=$('<div/>',{'id':iframe_id});$(parent_elt).append(new_iframe);googletag.cmd.push(function(){if(typeof(dfp_state.slots[position_name])!=='undefined'&&typeof(dfp_state.slots[position_name]['displayed'])==='undefined'){googletag.display(iframe_id);dfp_state.slots[position_name]['displayed']=1;}else{dfp_state.update_queue.push(dfp_state.slots[position_name]);}});}else if(jQuery.inArray(profile.user_country,vice_regions)!==-1||mixed_region_rand=="vice"){new_iframe=$('<div/>',{'id':iframe_id});$(parent_elt).append(new_iframe);googletag.cmd.push(function(){if(typeof(dfp_state.slots[position_name])!=='undefined'&&typeof(dfp_state.slots[position_name]['displayed'])==='undefined'){googletag.display(iframe_id);dfp_state.slots[position_name]['displayed']=1;}else{dfp_state.update_queue.push(dfp_state.slots[position_name]);}});}else if(jQuery.inArray(profile.user_country,w00t_regions)!==-1||mixed_region_rand=="w00t"){new_iframe=$('<div/>',{'id':iframe_id});$(parent_elt).append(new_iframe);var section_name=[];if(position_name=="728x90"||position_name=="320x50"){switch(displayList.page_name){case"latest":section_name.push("Latest");section_name.push("Home");case"popular":section_name.push("Popular");section_name.push("Home");break;case"tags":section_name.push("Genre");section_name.push(displayList.page_mode);section_name.push("ROS");case"list":section_name.push("Blog");section_name.push("ROS");case"spy":section_name.push("Spy");section_name.push("ROS");default:section_name.push("ROS");break;}
googletag.cmd.push(function(){googletag.pubads().setTargeting("qcsegs",quantSegs);googletag.pubads().setTargeting("HM-Section",section_name);if(typeof(dfp_state.slots[position_name])!=='undefined'&&typeof(dfp_state.slots[position_name]['displayed'])==='undefined'){googletag.display(iframe_id);dfp_state.slots[position_name]['displayed']=1;}else{dfp_state.update_queue.push(dfp_state.slots[position_name]);}});}else if(position_name=="skin"){googletag.cmd.push(function(){var position_name_special='w00t-special';if(typeof(dfp_state.slots[position_name_special])!=='undefined'&&typeof(dfp_state.slots[position_name_special]['displayed'])==='undefined'){googletag.display(position_name_special);dfp_state.slots[position_name_special]['displayed']=1;}else{dfp_state.update_queue.push(dfp_state.slots[position_name_special]);}});}else if(position_name=="300x250-1"||position_name=="300x250-2"){googletag.cmd.push(function(){if(typeof(dfp_state.slots[position_name])!=='undefined'&&typeof(dfp_state.slots[position_name]['displayed'])==='undefined'){googletag.display(iframe_id);dfp_state.slots[position_name]['displayed']=1;}else{dfp_state.update_queue.push(dfp_state.slots[position_name]);}});}}else{if(!ua_info.is_mobile){new_iframe=$('<div/>',{'id':iframe_id});$(parent_elt).append(new_iframe);googletag.cmd.push(function(){if(typeof(dfp_state.slots[position_name])!=='undefined'&&typeof(dfp_state.slots[position_name]['displayed'])==='undefined'){googletag.display(iframe_id);dfp_state.slots[position_name]['displayed']=1;}else{dfp_state.update_queue.push(dfp_state.slots[position_name]);}});}else{$('.ad-breakout').remove();}}}
window.redraw_ads=function(){if(window_hidden){redraw_ads_on_show=true;}else{draw_ads("redraw");}}
window.sticky_relocate=function(){if(!is_hypem()){return false;}
if(typeof(displayList)!=="undefined"&&typeof(displayList['url'])!=="undefined"&&displayList['url'].match(/(multisource)/)){return false;}
var window_top=$(window).scrollTop();if($('#sticky-anchor').length){var offset=$('#sticky-anchor').offset();var div_top=offset.top;if(window_top>div_top){$('#header').addClass('stick');$('#container').addClass('stick');if($('#top-notice').length&&!$('#top-notice').is(":hidden")){$('#header').css({top:''});}}else{$('#header').removeClass('stick');$('#container').removeClass('stick');if($('#top-notice').length&&!$('#top-notice').is(":hidden")){}}}
var sidebar_ad_top=false;if($('#sidebar-sticky-anchor').length){var offset=$('#sidebar-sticky-anchor').offset();sidebar_ad_top=offset.top;if(window_top+40>sidebar_ad_top){$('.ad-rectangleB-midpage').addClass('stick');}else{$('.ad-rectangleB-midpage').removeClass('stick');}}};window.update_page_contents=function(){if(document.location.pathname=='/'||is_html5_history_compat()){if(document.location.href.search(/_escaped_fragment_/)==-1){show_loading();if(is_html5_history_compat()){url=document.location.pathname+document.location.search;}
if(url==''){url='/';}
url=url.replace(/\?ax=1/,'');url=url.replace(/^#!?/,'');function post_update_page_contents(){hide_loading();window.displayList=jQuery.parseJSON($('#displayList-data').remove().html()||'{}');window.displayList['url']=get_current_rel_url();if(typeof window.playList!=='undefined'){window.playList.gc=true;}
if(typeof(prevUrl)!=='undefined'&&prevUrl.match(/\/zeitgeist\/2020/)&&!currentUrl.match(/\/zeitgeist\/2020/)&&!profile.night){$('body').removeClass('night');}else if(typeof(prevUrl)!=='undefined'&&!prevUrl.match(/\/zeitgeist\/2020/)&&currentUrl.match(/\/zeitgeist\/2020/)&&!profile.night){$('body').addClass('night');}
if(prevUrl!=currentUrl&&!currentUrl.match(/^\/blogs\//)&&!(is_html5_history_compat()&&document.location.hash!="")){$(window).scrollTop(0);}
prevUrl=currentUrl;if(document.location.href.match(/track\//)&&typeof(FB)!="undefined"&&typeof(FB.XFBML)!="undefined"){FB.XFBML.parse();}
if(window.displayList['show_favorites_friends']){load_also_loved();}
is_infinite_scroll=false;setup_player_bar();show_push_message();show_view_in_app();ga_pageview();if(window.displayList.page_name==="spy"){enable_spy_check();if(displayList['country']){setTimeout(function(){$('svg path[data-code="'+displayList['country']+'"]').css({fill:'#0063dc'});},3000);}}
if(profile.user_country=='US'){}else if(jQuery.inArray(profile.user_country,w00t_regions)!==-1||mixed_region_rand=="w00t"){update_w00t_page_state();}
if(is_tv_page()){window.tv_show();}
set_ad_vars();draw_ads("initial");install_ad_waypoints("initial");animate_page_elements();if(window.location.hash){setTimeout(function(){var offset=$(window.location.hash).offset();if(typeof(offset)!="undefined"){$('html, body').animate({scrollTop:offset.top-60});}},1000);}}
if(typeof(first_load)=="undefined"&&is_html5_history_compat()&&!url.match(/^\/(\?.+)?$/)){post_update_page_contents();first_load=0;return new $.Deferred().resolve();}else{if(currentPlayerObj[0]&&currentPlayerObj[0].type&&currentPlayerObj[0].type.match(/(mixcloud)/)){stopTrack();currentPlayerObj=[];}
if(profile.olark_enabled){load_olark();}
page_updater=$.ajax({url:url,data:'ax=1&ts='+get_unix_time(),dataType:'html',type:'get',async:true,success:function(content){$('#content-wrapper').html(content);post_update_page_contents();},error:function(){hide_loading();setup_player_bar();_gaq.push(['_trackEvent','Error','post_update_page_contents',null,1,true]);}});}
first_load=0;if(playerStatus!="PLAYING"&&getQueryVariable("autoplay")){setTimeout(function(){loadAndPlay();},1000);}}}
return page_updater;};window.ga_pageview=function(){var pv_addr;if(document.location.href.search(/\/#!?\//)!=-1){pv_addr=document.location.hash;pv_addr=pv_addr.replace(/#!?\//,'/');}else{pv_addr=document.location.pathname;}
if(typeof profile.acct_type!=="undefined"){_gaq.push(['_setCustomVar',1,'Account',profile.acct_type]);}
_gaq.push(['_setPageGroup','1',window.displayList['page_name']]);_gaq.push(['_trackPageview',pv_addr]);if(typeof _qevents!=="undefined"){try{if(typeof(__qc)!='undefined'&&__qc.qpixelsent&&__qc.qpixelsent.length){__qc.qpixelsent=[];}
if(profile.user_country=='GB'||profile.user_country=='IE'){_qevents.push([{qacct:"p-f66q2dQu9xpU2"},{qacct:"p-70RhgKmunzjBs",labels:"Music"}]);}else{_qevents.push([{qacct:"p-f66q2dQu9xpU2"},{qacct:"p-9QHtmaHzhaG_g"}]);}}catch(err){_gaq.push(['_trackEvent','Error',err,null,1,true]);}}
if(is_hypem()){if(jQuery.inArray(profile.user_country,vice_regions)!==-1){if(_comscore.length<2){_comscore.push({c1:"2",c2:"8568956"});}
run_comscore();}else if(profile.user_country=="US"){if(_comscore.length<2){_comscore.push({c1:"2",c2:"6665296"});}
run_comscore();}
if(jQuery.inArray(profile.user_country,w00t_regions)!==-1){update_whyanalytics();}}};window.run_comscore=function(){if(profile.ads_enabled){}
else{return false;}
(function(){var s=document.createElement("script"),el=document.getElementsByTagName("script")[0];s.async=true;s.src=(document.location.protocol=="https:"?"https://sb":"http://b")+".scorecardresearch.com/beacon.js";el.parentNode.insertBefore(s,el);})();}
window.show_push_message=function(){return false;var message_intro=$('<div id="message-intro-new" />');if(typeof(displayList)!=="undefined"&&typeof(displayList.page_name)!=="undefined"&&!displayList.page_name.match(/(email_manage|find_friends|link-sc|link-spotify|about|contact|iphoneapp|listall|cmj2011|local|radio_show|sxsw2012_|sxsw2014|sxsw2015|sxsw2016|gball2012|greatescape|zeitgeist|set|HypeTV|sonos_splash|levis_special|special_|stack|mazda_hypeon|otw|cmj2015|moogfest|form-2016|kkb-2016)/)&&!ua_info.ua.match(/mypad/)&&$('#message-intro-new').length===0&&(!profile.is_logged_in||(profile.is_logged_in&&displayList.page_name=="profile"&&(ua_info.is_mobile||ua_info.is_ios))||(profile.is_logged_in&&displayList.page_name=="popular"&&(ua_info.is_mobile||ua_info.is_ios)))){if(ua_info.is_android){message_intro.html('<p><strong><a href="http://hypem.com/android">Get Hype Machine for Android [FREE!]</a></strong><br /><span>Favorites + more in your pocket.</span><br/></p>');}else if(ua_info.is_ios){message_intro.html('<p><strong><a href="http://hypem.com/iphone">Get Hype Machine for iPhone</a></strong><br /><span>Favorites + more in your pocket.</span><br/></p>');}else if(ua_info.is_blackberry){message_intro.html('<p>Every day, thousands of people around the world write about music they love â and it all ends up here. <br/><strong><a onclick="show_lightbox(\'signup\');return false;" href="">Join us</a> and find new music worth listening to</strong>.');}else if(ua_info.is_win_phone){message_intro.html('<p>Every day, thousands of people around the world write about music they love â and it all ends up here. <br/>Get <a href="http://www.windowsphone.com/en-US/apps/3d299cde-5093-e011-986b-78e7d1fa76f8"><strong>The Hype</strong> <span style="font-size:10px">(unofficial)</span></a> in the Windows Store.');}else if(ua_info.is_mobile){message_intro.html('<p>Every day, thousands of people around the world write about music they love â and it all ends up here. <br/><strong><a onclick="show_lightbox(\'signup\');return false;" href="">Join us</a> and find new music worth listening to</strong>.');}else{message_intro.html('<p>Every day, thousands of people around the world write about music they love â and it all ends up here. <br/><strong><a onclick="show_lightbox(\'signup\');return false;" href="">Join us</a> and find new music worth listening to</strong>. Also on <strong><A href="http://hypem.com/iphone">iPhone</a></strong> and <strong><A href="http://hypem.com/android">Android</a></strong>.</p>');}
$('#content').prepend(message_intro);}};window.show_view_in_app=function(){if(!ua_info.is_ios&&!ua_info.is_android){return false;}
if(displayList.page_name=="item"){$('#header-view-in-app').attr('href','hypem://track/'+displayList.page_arg);$('#header-view-in-app').show();}else if(displayList.page_name=="profile"&&displayList.page_mode=="loved"&&typeof(logged_in_username)!="undefined"&&displayList.profile_user==logged_in_username){$('#header-view-in-app').attr('href','hypem://playlist/?key=PlaylistFavorites&section=users&username='+logged_in_username);$('#header-view-in-app').show();}else if(displayList.page_name=="profile"&&displayList.page_mode=="loved"){$('#header-view-in-app').attr('href','hypem://playlist/?key=PlaylistFriend&section=users&username='+displayList.profile_user);$('#header-view-in-app').show();}else if(displayList.page_name=="popular"&&displayList.page_mode.match(/(3day|remix|noremix|lastweek)/)){$('#header-view-in-app').attr('href','hypem://playlist/?key=PlaylistPopular&section=popular&mode='+displayList.page_mode);$('#header-view-in-app').show();}else if(displayList.page_name=="latest"&&displayList.page_mode.match(/(all|fresh|remix|noremix)/)){$('#header-view-in-app').attr('href','hypem://playlist/?key=PlaylistLatest&section=tracks&mode='+displayList.page_mode);$('#header-view-in-app').show();}else if(displayList.page_name=="list"){$('#header-view-in-app').attr('href','hypem://blogs/'+displayList.page_arg);$('#header-view-in-app').show();}else if(displayList.page_name=="greatescape2016_index"){$('#header-view-in-app').attr('href','hypem://special?tracks=greatescape_2016&title=The+Great+Escape+2016');$('#header-view-in-app').show();}else{$('#header-view-in-app').hide();}}
window.update_buzz_page_state=function(count){if(typeof(count)=="undefined"){count=0;}
else if(count>=9){return false;}
else{count++;}
var buzz_url;try{if(is_html5_history_compat()){buzz_url=document.location.pathname+document.location.search;}
if(ua_info.is_mobile||ua_info.is_ios){bmQuery.bmLib.geoLocation="XX";}else{bmQuery.bmLib.geoLocation=profile.user_country;}
bmQuery.bmLib.pageChange(buzz_url);}catch(err){setTimeout(function(){update_buzz_page_state(count);},500);}};window.update_w00t_page_state=function(count){try{if(is_function(window.wmRemoveVideoWall)){window.wmRemoveVideoWall();}}catch(err){}};window.update_nielsen=function(pv_addr){try{var pvar={cid:"cogs",content:"0",server:"secure-au",page_url:"http://hypem.com"+pv_addr};var trac=nol_t(pvar);trac.record().post();}catch(err){setTimeout(function(){update_nielsen(pv_addr);},1000);}};window.update_whyanalytics=function(){try{VDNA.queue.push({apiKey:"w00tmedia1396451261203",method:"reportPageView"});}catch(err){setTimeout(function(){update_whyanalytics();},1000);}};window.dfp_extras_var_passthru=function(){var appended_str='';var dfpKeyword=getQueryVariable("dfpKeyword");if(dfpKeyword!=''&&typeof(dfpKeyword)!='undefined'){appended_str+="&dfpKeyword="+dfpKeyword;}
var dfpKeyval=getQueryVariable("dfpKeyval");if(dfpKeyval!=''&&typeof(dfpKeyval)!='undefined'){appended_str+="&dfpKeyval="+dfpKeyval;}
if(document.location.pathname.match(/\/fresh/)){appended_str+="&dfpKeyval=page:freshest";}else if(document.location.pathname.match(/\/popular\/?\d?$/)){appended_str+="&dfpKeyval=page:popular";}else if(document.location.pathname.match(/\/popular\/remix/)||document.location.pathname.match(/\/tags\/electronic/)||document.location.pathname.match(/\/tags\/hip.?hop/)){appended_str+="&dfpKeyval=page:smirnoffgenre";}else if(document.location.pathname.match(/\/latest\/remix/)){appended_str+="&dfpKeyval=page:starburstremix";}else if(document.location.pathname.match(/\/levissts/i)){appended_str+="&dfpKeyval=page:stationtostation";}else if(document.location.pathname.match(/\/spy/i)){appended_str+="&dfpKeyval=page:sonosglobalspyskin";}else if(document.location.pathname.match(/singer-songwriter/)){appended_str+="&dfpKeyval=campaign:singersongwriter";}
return appended_str;};window.dfp_extras_passback=function(country){var page_name,page_num,passback;if(window.displayList&&window.displayList&&window.displayList['page_name']){page_name=window.displayList['page_name'];}
if(window.displayList&&window.displayList&&window.displayList['page_mode']){page_mode=window.displayList['page_mode'];}
if(window.displayList&&window.displayList&&window.displayList['page_num']){page_num=window.displayList['page_num'];}
if(country=='GB'||country=='IE'){if(page_name=="latest"&&page_num==1){passback="homepage";}else if((page_name=="index"||page_name=="profile")&&(page_num>1&&page_num<7)){passback="page"+page_num;}else if(page_name=="popular"){passback="popular";}else if(page_name=="tweets_popular"){passback="twitter";}else if(page_name=="radio_show"){passback="radioshow";}else if(page_name=="spy"){passback="spy";}else if(page_name=="about"){passback="about";}else if(page_name=="contact"){passback="contact";}else{passback="ros";}}else{if((page_name=="index"||page_name=="profile")&&page_num==1){passback="homepage";}else if((page_name=="index"||page_name=="profile")&&(page_num>1&&page_num<7)){passback="page"+page_num;}else if(page_name=="radio_show"){passback="radioshow";}else if(page_name=="sxsw2013_video"){passback="tacobellstream";}else if(page_name=="umf2011"){passback="umf2011";}else{passback="ros";}}
return passback;};window.resize_ad_element=function(pos,size){$('#'+pos).css({'width':size.width,'height':size.height}).parent().css({'width':size.width,'height':size.height});if(pos.match(/ad-leaderboard/)&&size.height==145){$('.ad-breakout').each(function(i,el){$(el).css({padding:'0px'});});}};window.load_url=function(url,e){if(typeof(url)!=="undefined"&&url.match(/javascript:/)){return false;}
if(page_updater&&page_updater.readyState!=4){return false;}
if(url.match(/amazon/i)){_gaq.push(['_trackEvent','Affiliate','Amazon',null,1,true]);}else if(url.match(/emusic/i)){_gaq.push(['_trackEvent','Affiliate','Emusic',null,1,true]);}else if(url.match(/itunes/i)){_gaq.push(['_trackEvent','Affiliate','iTunes',null,1,true]);}else if(url.match(/songkick/i)){_gaq.push(['_trackEvent','Affiliate','Songkick',null,1,true]);}else if((url.match(/track\//i)||url.match(/item\//i)||url.match(/track\//i))&&url.match(/rec_ref=/)){_gaq.push(['_trackEvent','Track','Suggestion',null,1,true]);}else if(url.match(/search\//i)&&url.match(/rec_ref=/)){_gaq.push(['._trackEvent','Search','Suggestion',null,1,true]);}else if(url.match(/search\//i)){_gaq.push(['_trackEvent','Search','Normal',null,1,true]);}else if(url.match(/artist\//i)){_gaq.push(['_trackEvent','Search','Artist_click',null,1,true]);}else if(url.match(/track\//i)||url.match(/item\//i)||url.match(/song\//i)){_gaq.push(['_trackEvent','Track','Click',null,1,true]);}else if(!url.match(/hypem.com/i)){_gaq.push(['_trackEvent','Blog','Post_click',null,1,true]);}
if(url.match(/^hypem:\/\//)){top.location.href=url;return false;}
if(url.match(/\/paypal_start_sub\//)||url.match(/\/paypal_create_payment\//)){top.location.href=url;return false;}
if((url.indexOf('/')===0||(is_hypem()&&url.search(/^https?:\/\/.*?hypem\.com\//)!=-1)||url.search('/'+document.location.host+'/')!=-1)&&url.search(/\/go\//)==-1&&url.search(/\/premiere\//)==-1&&url.search(/\/download/)==-1&&url.search(/\/admin/)==-1&&url.search(/\/share/)==-1&&url.search(/\/feed\/.+?xml$/)==-1&&url.search(/\/json\//)==-1&&url.search(/https?:\/\/blog\./)==-1&&url.search(/https?:\/\/stream\./)==-1&&url.search(/https?:\/\/merch\./)==-1&&url.search(/https?:\/\/cm\./)==-1&&url.search(/api\/twitter/)==-1&&url.search(/api\/soundcloud/)==-1&&url.search(/api\/spotify/)==-1&&url.search(/\/install/)==-1&&url.search(/labs\/ff/)==-1&&(typeof(e)=="undefined"||!e.metaKey)){if(document.location.href.search(/_escaped_fragment_/)==-1){url=url.replace(/^https?:\/\/.+?\//,'/');url=url.replace(/[\?&]ax=1/,'');if(url.match(/%2F/i)||url.match(/%3F/i)||url.match(/%252F/i)||url.match(/%2B/i)||url.match(/%25/i)||/MSIE/.test(navigator.userAgent)){}else{try{url=decodeURIComponent(url);}catch(err){}}
currentUrl=url;history.pushState(null,null,document.location.protocol+'//'+document.location.host+url);disable_infinite_page_scroll();disable_notification_check();disable_spy_check();update_page_contents();}else{top.location.href=url;}}else{try{if(url.search(/twitter.com\/intent/)!=-1){var center={x:($(window).width()/2)-(550/2),y:($(window).height()/2)-(460/2)};window.open(url,'twitter','height=460,width=550,location=false,toolbar=false,menubar=false,screenX='+center.x+',screenY='+center.y+',left'+center.x+',top'+center.y);return false;}else{window.open(url,"_blank",'');}
return false;}catch(e){window.open(url,'_blank','width='+window.screen.availWidth+',height='+window.screen.availHeight+',menubar=yes,toolbar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes');return false;}}
return false;};window.check_hash_change=function(e){if(e!==undefined){}
var url=get_current_rel_url();if(currentUrl!=url){currentUrl=url;if(skip_update_page_contents){skip_update_page_contents=0;return false;}
if(page_updater&&page_updater.readyState!=4){return false;}
update_page_contents();}};window.get_current_rel_url=function(){url=document.location.href;url=url.replace(/^https?:\/\/.+?\//,'/');url=url.replace(/[\?&]ax=1/,'');url=url.replace(/^#!?/,'');return url;};window.get_visitorid=function(){var cookie_txt=decodeURIComponent(get_cookie("AUTH"));var cookie_arr=cookie_txt.split(":");if(typeof(cookie_arr[1])=="undefined"&&getQueryVariable('visitorid')){return getQueryVariable('visitorid');}
return cookie_arr[1];};window.hide_notice=function(cookie_key){jQuery('#top-notice').removeClass('enabled').addClass('disabled');set_cookie(cookie_key,'true','30','/','','');};window.getQueryVariable=function(variable){var query=window.location.href.substring(window.location.href.indexOf("?")+1);var vars=query.split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable){return pair[1];}}};window.load_search=function(){var query=$('#q').val();if(query&&query!="Artist or Track"){query=$.trim(query);query=encodeURIComponent(query);load_url("/search/"+query+"/1/");}else{load_random_search(true);}};window.load_random_header_child=function(el){var selection=$('#'+el).find('ul li a');var selected=selection.get(Math.floor(Math.random()*selection.length));if($(selected).prop('target')=="_top"){window.location=$(selected).prop('href');}else{$(selected).click();}
return false;};window.load_random_search=function(forced){$.ajax({url:'/random_search',data:'rel_only=1',cache:false,type:'get',async:true,success:function(transport){var response=transport.responseText||"/random_search";load_url(response);},error:function(){load_url('/random_search');_gaq.push(['_trackEvent','Error','random_search',null,1,true]);}});};window.load_random_track=function(){$.ajax({url:'/random',data:'rel_only=1',cache:false,type:'get',async:true,success:function(transport){var response=transport.responseText||"/random";load_url(response);},error:function(){_gaq.push(['_trackEvent','Error','load_random_track',null,1,true]);load_url('/random');}});};window.is_function=function(functionToCheck){var getType={};return functionToCheck&&getType.toString.call(functionToCheck)==='[object Function]';}
window.get_unix_time=function(){return parseInt(+new Date()/1000);};window.is_int=function(value){if((parseFloat(value)==parseInt(value))&&!isNaN(value)){return true;}else{return false;}};window.sec_to_str=function(nSec){var min=Math.floor(nSec/60);var sec=nSec-(min*60);return min+':'+(sec<10?'0'+sec:sec);};window.getQueryVariable=function(variable){var query=window.location.href.substring(window.location.href.indexOf("?")+1);var vars=query.split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable)return pair[1];}};window.sm_onload=function(){disable_loaded_check();if(this.readyState==2||(this.readyState==3&&!ua_info.is_ios&&!ua_info.is_android&&((!this.isHTML5&&this.bytesLoaded<50000)||this.duration==0))){if(this.url.match(/(hypem.net|hypem.com)/)||this['final']||!is_hypem()){if(this.url.match(/slack.com/)){var elt=$('div[data-itemid="'+this.itemid+'"] a.slack-required')[0];$(elt).show();}
hide_loading();nextTrack();}else{$.ajax({url:'/inc/user_action',data:'act=track_load_failure&itemid='+window.playList['tracks'][this.seq].id+'&session='+get_visitorid()+'&bytesLoaded='+currentPlayerObj[(currentPlayerObj.length-1)].bytesLoaded+'&duration='+parseInt(currentPlayerObj[(currentPlayerObj.length-1)].duration/1000)+'&transferTime='+(get_unix_time()-track_load_start_ts)+'&readyState='+currentPlayerObj[(currentPlayerObj.length-1)].readyState+'&url='+encodeURIComponent(currentPlayerObj[(currentPlayerObj.length-1)].url),cache:false,type:'post',async:true});loadTrack(0,1,0);}}else{if(typeof(window.playList['tracks'][currentTrack].time)!==undefined){var known_duration=window.playList['tracks'][currentTrack].time;}
$.ajax({url:'/inc/user_action',data:'act=track_load_success&itemid='+window.playList['tracks'][this.seq].id+'&session='+get_visitorid()+'&bytesLoaded='+currentPlayerObj[(currentPlayerObj.length-1)].bytesLoaded+'&duration='+parseInt(currentPlayerObj[(currentPlayerObj.length-1)].duration/1000)+'&known_duration='+known_duration+'&transferTime='+(get_unix_time()-track_load_start_ts)+'&readyState='+currentPlayerObj[(currentPlayerObj.length-1)].readyState+'&url='+encodeURIComponent(currentPlayerObj[(currentPlayerObj.length-1)].url),cache:false,type:'post',async:true});player_elements.progress_loading.animate({width:"100%"},50);player_duration=parseInt(currentPlayerObj[0].duration/1000);window.playList['tracks'][currentTrack]['time']=player_duration;player_elements.time_total.html(sec_to_str(player_duration));hide_loading();}};window.sm_onplay=function(){if(this.readyState==1)
setPlaying();};window.sm_onresume=function(){playerStatus="PLAYING";setPlaying();};window.setPlaying=function(playing){if(typeof playing=='undefined')playing=true;if(playing){playerStatus="PLAYING";document.title=document.title.replace(/\u25FC/,'\u25BA');}else{playerStatus='PAUSED';document.title=document.title.replace(/\u25BA/,'\u25FC');}
player_elements.container.show();player_elements.state=$('.haarp-active .haarp-play-ctrl');if(player_elements.state.length){if(playing){player_elements.state.removeClass("play").addClass("pause");}else{player_elements.state.removeClass("pause").addClass("play");}}};window.sm_onpause=function(){if(this.sID!='currentPlayer'+currentTrack)return false;setPlaying(false);};window.sm_onfinish=function(){playerStatus="COMPLETED";stopTrack();nextTrack();};window.sm_onstop=function(){playerStatus="COMPLETED";disable_loaded_check();hide_loading();};window.sm_whileplaying=function(){if(this.sID!=("currentPlayer"+currentTrack))return false;if(dragging_position)return;if(player_position!=parseInt(this.position/1000)){player_position=parseInt(this.position/1000);if(is_fade_enabled()&&(player_duration-player_position)==20&&profile.playback_allowed){loadTrack(0,0,1);}else if(is_fade_enabled()&&(player_duration-player_position)==7&&currentPlayerObj[1].bytesLoaded&&profile.playback_allowed){beginFadeTransition();}
player_elements.time_position.html(sec_to_str(player_position));player_elements.progress_playing.width((Math.round(player_position/player_duration*100*100)/100)+'%');}};window.sm_whileloading=function(){if(this.sID!="currentPlayer"+currentTrack){return false;}
var percent_loaded=(Math.round((this.bytesLoaded/this.bytesTotal)*100)*100/100)+'%';player_elements.progress_loading.animate({width:percent_loaded},50);if(typeof(window.playList['tracks'][currentTrack].time)==="undefined"){player_duration=parseInt(currentPlayerObj[0].duration/1000);player_elements.time_total.html(sec_to_str(parseInt(player_duration)));}};window.sm_check_loaded=function(){if(typeof(currentPlayerObj[0])!=="undefined"&&typeof(currentPlayerObj[0].bytesTotal)!=="undefined"&&currentPlayerObj[0].bytesTotal!=0){var percent_loaded=Math.round((currentPlayerObj[0].bytesLoaded/currentPlayerObj[0].bytesTotal)*100)+'%';player_elements.progress_loading.animate({width:percent_loaded},50);}else{}
player_loading_log.push(percent_loaded);if(player_loading_log.length>9){player_loading_log.shift();}
if(!(player_loading_log[0]||player_loading_log[1])){}
var pattern=0;for(var i=0;i<player_loading_log.length;i++){if(player_loading_log[i]!=player_loading_log[i+1]||player_loading_log[i]==100){break;}else{pattern++;}}
if(pattern>8){if(currentPlayerObj[0].url.match(/(hypem.net|hypem.com)/)||currentPlayerObj[0]['final']){nextTrack();}else{loadTrack(0,1,0);}}};window.enable_loaded_check=function(){if(loaded_event_timeout!==0){return false;}else{loaded_event_timeout=window.setInterval(sm_check_loaded,300);return true;}};window.disable_loaded_check=function(){if(loaded_event_timeout!=undefined){clearInterval(loaded_event_timeout);loaded_event_timeout=0;return true;}else{return false;}};window.sm_start_drag=function(evt){if(!evt)evt=window.event;var t_elt=evt.target||evt.srcElement;if(t_elt.id.match(/progress/)){dragging_position=true;$(window).unbind('mousemove').bind('mousemove',sm_follow_progress_drag).unbind('mouseup').bind('mouseup',sm_end_drag);}
if(t_elt.id.match(/volume/)){dragging_position=true;$(window).unbind('mousemove').bind('mousemove',sm_follow_volume_drag).unbind('mouseup').bind('mouseup',sm_end_drag);}
return false;};window.sm_follow_volume_drag=function(evt){if(!evt)evt=window.event;var t_elt=evt.target||evt.srcElement;sm_update_volume(evt,t_elt,false);};window.sm_follow_progress_drag=function(evt){if(!evt)var evt=window.event;var t_elt=evt.target||evt.srcElement;var x=parseInt(evt.clientX);var offset=player_elements.progress_loading.offset();var nMsecOffset=Math.floor((x-offset.left-4)/(player_elements.progress_outer.width())*(window.playList['tracks'][currentTrack].time*1000));if(!isNaN(nMsecOffset))nMsecOffset=Math.min(nMsecOffset,currentPlayerObj[0].duration);player_position=parseInt(nMsecOffset/1000);player_elements.time_position.html(sec_to_str(player_position));player_elements.progress_playing.width((Math.round(player_position/player_duration*100*100)/100)+'%')
sm_update_progress(evt,t_elt);if(player_position>=player_duration)sm_end_drag();};window.sm_end_drag=function(evt){if(!evt)evt=window.event;if(!evt){return false;}
var t_elt=evt.target||evt.srcElement;dragging_position=false;$(window).unbind('mousemove').unbind('mouseup');if(t_elt.id.match(/progress/)){sm_update_progress(evt,t_elt);}
if(t_elt.id.match(/volume/)){sm_update_volume(evt,t_elt,true);var y=parseInt(evt.clientY);var offset=player_elements.volume_outer.offset();var volume_pc=parseInt(100-Math.floor((y-offset.top-2)/(player_elements.volume_outer.height())*100));$.ajax({url:'/inc/user_action',data:'act=volume&value='+volume_pc+'&session='+get_visitorid(),cache:false,type:'post',async:true});}
return false;};window.sm_update_volume=function(evt,t_elt,morph){var y=parseInt(evt.clientY);var offset=player_elements.volume_outer.offset();var volume_pc=parseInt(Math.floor(100-(y-(offset.top-$(window).scrollTop())-2)/(player_elements.volume_outer.height())*100));if(!isNaN(volume_pc))volume_pc=Math.min(volume_pc,100);if(!isNaN(volume_pc)&&currentPlayerObj[0])currentPlayerObj[0].setVolume(volume_pc);if(!isNaN(volume_pc))player_volume=volume_pc;if(morph){player_elements.volume_ctrl.animate({height:volume_pc+'%'},50);}else{player_elements.volume_ctrl.height(volume_pc+'%');}};window.sm_update_progress=function(evt,t_elt){var x=parseInt(evt.clientX);var offset=player_elements.progress_loading.offset();var nMsecOffset=Math.floor((x-offset.left)/(player_elements.progress_outer.width())*(player_duration*1000));if(!isNaN(nMsecOffset))nMsecOffset=Math.min(nMsecOffset,(player_duration*1000));if(!isNaN(nMsecOffset)){if(currentPlayerObj[0].type=="spotify"){spotify_player.seek(nMsecOffset);}else{currentPlayerObj[0].setPosition(nMsecOffset);}}
player_position=parseInt(nMsecOffset/1000);if(currentPlayerObj[1]){clearInterval(currentPlayerObj[0].fadeIn);currentPlayerObj[1].destruct();clearInterval(currentPlayerObj[0].fadeOut);currentPlayerObj[0].setVolume(player_volume);}};window.sm_toggle_mute=function(){if(currentPlayerObj[0]&&currentPlayerObj[0].muted){player_elements.volume_mute.removeClass('icon-speaker-mute').addClass('icon-speaker');player_elements.volume_ctrl.animate({height:player_volume+'%'},500);currentPlayerObj[0].unmute();}else if(currentPlayerObj[0]){player_elements.volume_mute.removeClass('icon-speaker').addClass('icon-speaker-mute');player_elements.volume_ctrl.animate({height:0+'%'},500);currentPlayerObj[0].mute();}
return false;};window.sm_toggle_repeat=function(){if(!player_repeat_mode){player_elements.repeat_ctrl.addClass('player-repeat-active');player_repeat_mode="full";}else if(player_repeat_mode=="full"){player_elements.repeat_ctrl.removeClass('player-repeat-active');player_repeat_mode=false;}
$.ajax({url:'/inc/user_action',data:'act=repeat&value='+player_repeat_mode+'&session='+get_visitorid(),cache:false,type:'post',async:true});return false;};window.toggle_night=function(){if($('body').hasClass('night')){$('body').removeClass('night');night=0;}else{$('body').addClass('night');night=1;}
profile.night=night;$.ajax({url:'/inc/user_action',data:'act=night&value='+night+'&session='+get_visitorid(),cache:false,type:'post',async:true});return false;};window.beginFadeTransition=function(){currentPlayerObj[1].play();fadeOutSound(currentPlayerObj[0],-5,300);fadeInSound(currentPlayerObj[1],5,300);};window.fadeInSound=function(soundObj,amount,ms_delay){if(soundObj){var vol=soundObj.volume;if(vol>=player_volume)return false;soundObj.setVolume(Math.min(player_volume,vol+amount));soundObj.fadeIn=setTimeout(function(){fadeInSound(soundObj,amount,ms_delay)},ms_delay);}};window.fadeOutSound=function(soundObj,amount,ms_delay){if(soundObj){var vol=soundObj.volume;if(vol==0)return false;soundObj.setVolume(Math.max(0,vol+amount));soundObj.fadeOut=setTimeout(function(){fadeOutSound(soundObj,amount,ms_delay)},ms_delay);}};window.is_fade_enabled=function(){return false;if(currentPlayerObj[0].readyState!==3){return false;}
return!ua_info.is_ios&&!ua_info.is_android&&!ua_info.is_playbook&&window.playList['tracks'].length>1&&!is_spy_page();};window.is_html5_history_compat=function(){return!!(window.history&&history.pushState);};window.loadAndPlayByItemid=function(itemid,evt){for(var i=0;i<window.displayList['tracks'].length;i++){if(window.displayList['tracks'][i]['id']==itemid){loadAndPlay(i,evt);return false;}}};window.is_stable_page=function(){return!(is_spy_page()||is_shuffle_page());};window.is_spy_page=function(){return document.location.pathname.match(/\/spy(\/..)?$/)||document.location.pathname.match(/\/obsessedspy(\/..)?$/)||document.location.pathname.match(/\/lovespy(\/..)?$/);};window.is_hypem=function(){return document.location.hostname.match(/hypem/);};window.is_shuffle_page=function(){if(document.location.pathname.match(/\/shuffle/)){return true;}else{return false;}};window.is_tv_page=function(){return displayList&&displayList["page_name"]=="tv";};window.togglePlay=function(){var playable=['normal','youtube','vimeo','soundcloud','bandcamp','spotify','apple','mixcloud','direct'];if(playerStatus=='PAUSED'){if(~playable.indexOf(window.playList['tracks'][currentTrack].type)){if(currentPlayerObj[0].type=="youtube"){yt_player.playVideo();}else if(currentPlayerObj[0].type=="vimeo"){vimeo_post('play');}else if(currentPlayerObj[0].type=="mixcloud"){currentPlayerObj[0].play();}else if(currentPlayerObj[0].type=="spotify"){if(spotify_auth['device_id']){spotify_player.resume();}}else if(currentPlayerObj[0].type=="apple"){}else{currentPlayerObj[0].resume();}}}else if(playerStatus=='PLAYING'){if(~playable.indexOf(window.playList['tracks'][currentTrack].type)){if(currentPlayerObj[0].type=="youtube"){yt_player.pauseVideo();}else if(currentPlayerObj[0].type=="vimeo"){vimeo_post('pause');}else if(currentPlayerObj[0].type=="mixcloud"){currentPlayerObj[0].pause();}else if(currentPlayerObj[0].type=="spotify"){if(spotify_auth['device_id']){spotify_player.pause();}}else if(currentPlayerObj[0].type=="apple"){}else{currentPlayerObj[0].pause();}
if(currentPlayerObj[1]){currentPlayerObj[1].pause();nextTrack();}}}else if(playerStatus===''){loadAndPlay();}};window.same_page=function(url){return url===get_current_rel_url()&&typeof window.playList!=='undefined'&&!window.playList.gc;}
window.loadAndPlay=function(i,evt){if(player_elements.container.hasClass("disabled")){return false;}
if(activeList!=get_current_rel_url()||typeof window.playList==='undefined'||window.playList.gc){try{delete window.playList;}catch(e){window.playList=undefined;}
window.playList=jQuery.extend(true,{},window.displayList);activeList=get_current_rel_url();player_elements.from_prev_page.css('visibility','hidden');}
$('.haarp-section-track').removeClass('haarp-fav-active');stopTrack();if(typeof i=='undefined')i=0;currentTrack=i;playback_manual=1;playTrack();return false;};window.toggleShowKeyboardShortcuts=function(){$('#keyboard').toggle();}
window.stopTrack=function(){setPlaying(false);if(typeof currentTrack==='undefined'||typeof window.playList==='undefined'||typeof window.playList['tracks']==='undefined'){return false;}
if(activeList==get_current_rel_url()){if(window.playList['tracks'][currentTrack]){$('.haarp-section-track').eq(currentTrack).removeClass('haarp-active');}}
disable_playback_check();if(currentPlayerObj[0]&&currentPlayerObj[0].type=="youtube"){yt_player.stopVideo();playerStatus="COMPLETED";}else if(currentPlayerObj[0]&&currentPlayerObj[0].type=="vimeo"){vimeo_post('pause');playerStatus="COMPLETED";}else if(currentPlayerObj[0]&&currentPlayerObj[0].type=="mixcloud"){if(typeof(currentPlayerObj[0].pause)!=="undefined"){currentPlayerObj[0].pause();}
playerStatus="COMPLETED";}else if(currentPlayerObj[0]&&currentPlayerObj[0].type=="spotify"){spotify_player.pause();}else if(currentPlayerObj[0]&&currentPlayerObj[0].type=="apple"){}else if(currentPlayerObj[0]&&currentPlayerObj[0].playState!=0){currentPlayerObj[0].stop();}
if(typeof window.displayList!=='undefined'&&typeof window.displayList.title==="string"){document.title=$("<div>"+window.displayList.title+"</div>").text();}else{document.title='Hype Machine';}};window.playTrack=function(){var track_string,clicked,previousAll;if(is_hypem()&&!profile.playback_allowed){show_lightbox("listen");return false;}else if(!window.playList||!window.playList['tracks']){return false;}
show_loading();if(window.playList['tracks'].length>1){player_elements.prev.removeClass("playerPrev-inactive").addClass("playerPrev-active").removeClass("playerNext-inactive").addClass("playerNext-active");}
playback_event_count=0;enable_playback_check();show_player_bar();set_now_playing_info(window.playList['tracks'][currentTrack]);$('#player-controls').addClass('haarp-active');if(activeList==get_current_rel_url()){$('.haarp-section-track').eq(currentTrack).addClass('haarp-active');setPlaying();}
if(is_spy_page()){disable_spy_check();clicked=$('.haarp-section-track').eq(currentTrack);previousAll=clicked.prevAll('.haarp-section-track');if(previousAll.length>0){disable_spy_check();var idx=clicked.index('.haarp-section-track');window.displayList['tracks'].splice(0,0,window.displayList['tracks'].splice(idx,1)[0]);window.playList['tracks'].splice(0,0,window.playList['tracks'].splice(idx,1)[0]);currentTrack=0;var top=$(previousAll[previousAll.length-1]);var previous=$(previousAll[0]);var moveUp=clicked.offset().top-top.offset().top;var moveDown=(clicked.offset().top+clicked.outerHeight())-(previous.offset().top+previous.outerHeight());previousAll.animate({'top':moveDown},'slow',function(){previousAll.css({'top':0})});clicked.addClass('sliding').animate({'top':-moveUp},'slow',function(){clicked.removeClass('sliding').css({'top':0}).insertBefore(top);});}
enable_spy_check();}
if(window.playList['tracks'][currentTrack].type&&window.playList['tracks'][currentTrack].type.match(/(youtube|vimeo|mixcloud|soundcloud|spotify|apple|bandcamp|direct)/)){track_string=window.playList['tracks'][currentTrack].title;}else if(window.playList['tracks'][currentTrack].artist){track_string=window.playList['tracks'][currentTrack].artist+' - '+window.playList['tracks'][currentTrack].song;}else{track_string=window.playList['tracks'][currentTrack].song;}
now_playing_title="\u25BA "+track_string+' / Hype Machine';document.title=$("<div>"+now_playing_title+"</div>").text();check_toast_permission(function(){if(document.webkitHidden){show_toast('','Now playing on Hype Machine',track_string);}});loadTrack(0,0,0);};window.loadTrack=function(skip,retry,is_fade){if(skip>10){return false;}
var autoplay,volume,req_data,attempt=0,type=0;if(retry){var prev_url_data={};prev_url_data.url=currentPlayerObj[(currentPlayerObj.length-1)].url;prev_url_data.readyState=currentPlayerObj[(currentPlayerObj.length-1)].readyState;prev_url_data.bytesLoaded=currentPlayerObj[(currentPlayerObj.length-1)].bytesLoaded;prev_url_data.duration=parseInt(currentPlayerObj[(currentPlayerObj.length-1)].duration/1000);prev_url_data.transferTime=(get_unix_time()-track_load_start_ts);attempt=currentPlayerObj[(currentPlayerObj.length-1)].attempt+1;type=currentPlayerObj[(currentPlayerObj.length-1)].type;is_fade=currentPlayerObj[(currentPlayerObj.length-1)].is_fade;req_data='retry=1&attempt='+attempt+'&readyState='+prev_url_data.readyState+'&bytesLoaded='+prev_url_data.bytesLoaded+'&duration='+prev_url_data.duration+'&transferTime='+prev_url_data.transferTime+'&prev_url='+encodeURIComponent(prev_url_data.url)+'&prev_type='+type;currentPlayerObj[(currentPlayerObj.length-1)].destruct();currentPlayerObj.pop();}else{req_data='';}
var track;if(!skip&&is_fade){skip=1;track=currentTrack+skip;}else if(skip&&is_fade){track=currentTrack+skip;}else if(!skip&&!is_fade){skip=0;track=currentTrack;}else{track=currentTrack+skip;}
if(!window.playList['tracks'][track]||typeof(window.playList['tracks'][track].type)!="string"||!window.playList['tracks'][track].type.match(/(normal|youtube|vimeo|mixcloud|soundcloud|spotify|apple|bandcamp|direct)/)){loadTrack(skip+1,0,is_fade);return false;}
var req_url='/serve/source/'+window.playList['tracks'][track].id+'/'+window.playList['tracks'][track].key;if(!is_fade&&currentPlayerObj[1]&&currentPlayerObj[1].sID=="currentPlayer"+currentTrack){currentPlayerObj[0].destruct();currentPlayerObj.shift();if(window.playList['tracks'][currentTrack].time){player_duration=window.playList['tracks'][currentTrack].time;player_elements.time_total.html(sec_to_str(player_duration));}
if(playerStatus=="COMPLETED"){playerStatus="PLAYING";}
hide_loading();return false;}else if(!is_fade){while(currentPlayerObj.length){if(currentPlayerObj[0].type.match(/(youtube|vimeo|mixcloud)/)){unload_iframe_players();}else{if(typeof(currentPlayerObj[0].destruct)=="function"){currentPlayerObj[0].destruct();}else{currentPlayerObj[0]=[];}}
currentPlayerObj.shift();}}
if(window.playList['tracks'][track].id.match(/^(yt_|vm_)/i)){if(typeof(window.playList['tracks'][track].start_sec)!=="undefined"){currentPlayerObj.push(load_video_player(window.playList['tracks'][track].itemid,window.playList['tracks'][track].video_id,window.playList['tracks'][track].start_sec));}else{currentPlayerObj.push(load_video_player(window.playList['tracks'][track].itemid));}
return false;}else if(window.playList['tracks'][track].type=="mixcloud"){currentPlayerObj.push(load_video_player(window.playList['tracks'][track].id,window.playList['tracks'][track].video_id));return false;}else if(typeof(window.playList['tracks'][track].spotify_uri)!=="undefined"&&window.playList['tracks'][track].type.match(/(apple|spotify)/)){if(typeof(spotify_auth['token'])!=="undefined"&&get_unix_time()<spotify_auth['token_expires']){window.playList['tracks'][track].type="spotify";currentPlayerObj.push(window.playList['tracks'][track]);fetch('https://api.spotify.com/v1/me/player/play?device_id='+spotify_auth['device_id'],{method:'PUT',body:JSON.stringify({uris:[window.playList['tracks'][track]['spotify_uri']]}),headers:{'Content-Type':'application/json','Authorization':'Bearer '+spotify_auth['token']}});}else if(playback_manual){stopTrack();hide_loading();}else{nextTrack();}
return false;}
if(is_fade){autoplay=false;volume=0;}else{autoplay=true;volume=player_volume;}
var r=$.ajax({url:req_url,data:req_data,type:'get',async:false,cache:false,dataType:'json',error:function(){_gaq.push(['_trackEvent','Error','source_json_failure',null,1,true]);return false;}});try{var response=jQuery.parseJSON(r.responseText);if(typeof(response.url)=="undefined"&&response.final){nextTrack();return false;}}catch(err){nextTrack();return false;}
try{currentPlayerObj.push(soundManager.createSound({id:'currentPlayer'+track,url:response.url,autoLoad:true,autoPlay:autoplay,onload:sm_onload,onplay:sm_onplay,onresume:sm_onresume,onpause:sm_onpause,whileplaying:sm_whileplaying,whileloading:sm_whileloading,onfinish:sm_onfinish,onstop:sm_onstop,volume:volume,usePolicyFile:false}));currentPlayerObj[(currentPlayerObj.length-1)]['itemid']=window.playList['tracks'][track].id;currentPlayerObj[(currentPlayerObj.length-1)]['seq']=track;currentPlayerObj[(currentPlayerObj.length-1)]['final']=response['final'];currentPlayerObj[(currentPlayerObj.length-1)]['attempt']=attempt;currentPlayerObj[(currentPlayerObj.length-1)]['type']=response.type;currentPlayerObj[(currentPlayerObj.length-1)]['is_fade']=is_fade;currentPlayerObj[(currentPlayerObj.length-1)]['player_position_log']=[];track_load_start_ts=get_unix_time();if(!is_fade){if(typeof(window.playList['tracks'][currentTrack].time)!=="undefined"){player_duration=window.playList['tracks'][currentTrack].time;player_elements.time_total.html(sec_to_str(window.playList['tracks'][currentTrack].time));}}}catch(err){hide_loading();$.ajax({url:'/inc/user_action',data:'act=track_load_failure&itemid='+window.playList['tracks'][track].id+'&session='+get_visitorid()+'&bytesLoaded='+currentPlayerObj[(currentPlayerObj.length-1)].bytesLoaded+'&duration='+parseInt(currentPlayerObj[(currentPlayerObj.length-1)].duration/1000)+'&transferTime='+(get_unix_time()-track_load_start_ts)+'&readyState='+currentPlayerObj[(currentPlayerObj.length-1)].readyState+'&url='+encodeURIComponent(currentPlayerObj[(currentPlayerObj.length-1)].url),cache:false,type:'post'});loadTrack(0,1,0);return false;}
if(currentPlayerObj[currentPlayerObj.length-1]===false){currentPlayerObj.pop();hide_loading();$.ajax({url:'/inc/user_action',data:'act=track_load_failure&itemid='+window.playList['tracks'][track].id+'&session='+get_visitorid(),cache:false,type:'post'});loadTrack(0,1,0);return false;}
if($('player-volume-mute').className=='player-volume-mute-active'){currentPlayerObj[0].mute();}};window.advanceTrack=function(step){if(typeof step==='undefined'){step=1;}
if(typeof window.playList==="undefined"){return false;}
if(is_spy_page()){if($('.haarp-section-track').eq(0).queue().length){currentTrack=0;return false;}}
playback_manual=(typeof this!=window)?1:0;var skip=step;while((typeof window.playList['tracks']!="undefined"&&typeof window.playList['tracks'][(currentTrack+skip)]!="undefined"&&window.playList['tracks'].length-1)>=currentTrack+skip){if(window.playList['tracks'][(currentTrack+skip)].type!=""&&window.playList['tracks'][(currentTrack+skip)].type!='unavail'){stopTrack();currentTrack+=skip;playTrack();return false;}else{skip+=step;}}
if(player_repeat_mode=="full"&&player_repeat_count<30){stopTrack();currentTrack=0;playTrack();player_repeat_count++;return false;}else{player_repeat_count=0;}
return false;};window.nextTrack=function(){advanceTrack();}
window.prevTrack=function(){if(player_position>5&&currentPlayerObj[0]){currentPlayerObj[0].setPosition(0);}
else{advanceTrack(-1);}};window.set_now_playing_info=function(item){if(typeof(player_elements)==="undefined"){init_selectors();}
player_elements.time_total.html(sec_to_str(item.time));var song;if(typeof(item.type)=="string"&&item.type.match(/(youtube|vimeo|mixcloud|soundcloud|spotify|apple|bandcamp|direct)/)){song=$('<a/>',{href:item.url,text:item.title});now_playing=song;}else if(!is_hypem()){song=$('<a/>',{href:'https://hypem.com/track/'+item.id,text:item.song});if(item.artist){var artist=$('<a/>',{href:'https://hypem.com/artist/'+encodeURIComponent(item.artist)+'/1/',text:item.artist});now_playing=artist.add('<span> - </span>').add(song);}else{now_playing=song;}}else{song=$('<a/>',{href:'/track/'+item.id,text:item.song});if(item.artist){var artist=$('<a/>',{href:'/artist/'+encodeURIComponent(item.artist)+'/1/',text:item.artist});now_playing=artist.add('<span> - </span>').add(song);}else{now_playing=song;}}
if(typeof(item.type)=="string"&&item.type.match(/(youtube|vimeo|mixcloud)/)){$('#playerFav').addClass('fav-disabled').removeClass('fav-off').removeClass('fav-on');$('#player-timebar').addClass('disabled');$('#player-nowplaying').addClass('no_seek');}else if(typeof(item.type)=="string"&&item.type.match(/(soundcloud|spotify|bandcamp|direct|apple)/)){$('#playerFav').addClass('fav-disabled').removeClass('fav-off').removeClass('fav-on');$('#player-nowplaying').removeClass('no_seek');}else if(item.fav==1){$('#playerFav').addClass('fav-on').removeClass('fav-disabled').removeClass('fav-off');$('#player-timebar').removeClass('disabled');$('#player-nowplaying').removeClass('no_seek');}else{$('#playerFav').addClass('fav-off').removeClass('fav-disabled').removeClass('fav-on');$('#player-timebar').removeClass('disabled');$('#player-nowplaying').removeClass('no_seek');}
player_elements.player_inner.find('.share-icons').remove();if(typeof(item.type)=="string"&&item.type.match(/(youtube|vimeo|mixcloud|soundcloud|spotify|apple|bandcamp|direct)/)){var share_div=$('<div class="share-icons"></div>');player_elements.nowplaying.empty().append(now_playing).after(share_div);}else{blog_link=$('<a/>',{"class":'store read-post',href:item.posturl,html:'Read Post &rarr;'});var facebook_share_link="//hypem.com/share?share_type=facebook&create_type=hypem-player&url=http%3A%2F%2Fhypem.com%2Fitem%2F"+item.id+"&title="+escape(item.artist+" - "+item.song);var twitter_share_link="//hypem.com/share?share_type=twitter&create_type=hypem-player&url=http%3A%2F%2Fhypem.com%2Fitem%2F"+item.id+"&text="+escape(item.artist+" - "+item.song)+"%20on%20@hypem&via=hypem";var share_div=$('<div class="share-icons"><a class="icon-twitter fire-share-modal" data-href="'+twitter_share_link+'"></a></div>');player_elements.nowplaying.empty().append(now_playing.add(blog_link)).after(share_div);}
if(item.is_bc){if(typeof(item.url)!=="undefined"){var bc_link=item.url;}
else{var bc_link="/go/bc/"+item.id;}
var bc_share=$('<a class="icon-bc" href="'+bc_link+'"></a>');$('.share-icons').prepend(bc_share);}else if(item.is_au){if(typeof(item.url)!=="undefined"){var au_link=item.url;}
else{var au_link="/go/au/"+item.id;}
var sc_share=$('<a class="img-icon-au" href="'+au_link+'"></a>');$('.share-icons').prepend(sc_share);}else if(item.is_sc){if(typeof(item.url)!=="undefined"){var sc_link=item.url;}
else{var sc_link="/go/sc/"+item.id;}
var sc_share=$('<a class="icon-sc" href="'+sc_link+'"></a>');$('.share-icons').prepend(sc_share);}
if(typeof(activeList)!=='undefined'&&activeList){var page_playing_txt='<a href="'+activeList.replace('/#!','')+'" onclick="load_url(this.href, \'player_bar_prev_elt\');return false;">&larr; return to playlist</a>';player_elements.from_prev_page.empty().append($(page_playing_txt));}};window.find_via_user=function(item){var via_user='';if(typeof window.playList!=='undefined'&&window.playList['tracks']){if(window.playList['page_name']=="profile"&&(window.playList['page_mode']=="loved"||window.playList['page_mode']=="history")&&profile.logged_in_username!==window.playList['profile_user']){via_user=window.playList['profile_user'];}else if(window.playList['page_name']=="profile"&&window.playList['page_mode']=="feed"&&profile.logged_in_username==window.playList['profile_user']&&typeof item.via_user!=="undefined"&&profile.logged_in_username!==item.via_user){via_user=item.via_user;}}
return via_user;}
window.toggleFavoriteItem=function(i,positional){var item;positional=positional||false;if(typeof i!=='number'){i=currentTrack||0;}
if(positional){item=window.displayList['tracks'][i];}else{if(typeof window.playList==='undefined'){window.playList=jQuery.extend(true,{},window.displayList);}
item=window.playList['tracks'][i];}
if(typeof(item.type)!=='undefined'&&item.type&&item.type.match(/(youtube|vimeo|mixcloud|soundcloud|bandcamp|spotify|apple|direct)/)){return false;}
var via_user=find_via_user(item);logged_in().done(function(){send_favorite('item',item.id,via_user).done(function(data){if(data==="1"){if(facebook_auto_share&&typeof FB!=="undefined"){FB.api('/me/hype-machine:favorite','post',{track:'http://hypem.com/track/'+item.id+'/'},function(response){if(!response||response.error){
_gaq.push(['_trackEvent','Error','Facebook',null,1,true]);}else{
_gaq.push(['_trackEvent','Facebook','Favorite']);}});}
_gaq.push(['_trackEvent','Track','Favorite']);if(currentUrl.match(/popular/)||currentUrl.match(/search/)||currentUrl.match(/artist/)||currentUrl.match(/spy/)||currentUrl.match(/list/)){toggle_item_activity('favorites',$(".haarp-section-track[data-itemid='"+item.id+"']"),0,20,true);}}else{}}).fail(function(){});var selector;if(positional){selector='.haarp-section-track:eq('+i+')';$(selector+' .playlist-ctrls').toggleClass('playlist-off playlist-on');}else{selector='.haarp-active, .haarp-fav-active';$('.haarp-active .playlist-ctrls, .haarp-fav-active .playlist-ctrls').toggleClass('playlist-off playlist-on');}
$(selector).find('.haarp-fav-ctrl').toggleClass('fav-on fav-off');$(selector).find('.haarp-fav-count').each(function(){var count;if(!is_int(count=$(this).text())){return;}
if($(this).hasClass('favcount-on')){$(this).text(parseInt(count)-1);}else if(is_int(count=$(this).text())){$(this).text(parseInt(count)+1);}}).toggleClass('favcount-off favcount-on');});};window.setPlaylist=function(i,elt){var item;if(typeof i!=='number'){i=currentTrack||0;}
item=window.displayList['tracks'][i];playlist_id=$(elt).attr('data-playlist-id');logged_in().done(function(){send_set_playlist(playlist_id,item.id).done(function(data){if(data==="1"){_gaq.push(['_trackEvent','Track','SetPlaylist']);}else{}}).fail(function(){});var selector;$('.playlist-ctrls:eq('+i+') .playlist-option').each(function(i,elt){$(elt).removeClass("active");});$(elt).addClass('active');$('.playlist-ctrls .playlist-selected:eq('+i+')').addClass('active').removeClass('playlist-1').removeClass('playlist-2').removeClass('playlist-3').addClass('playlist-'+playlist_id);});};window.removePlaylist=function(i,elt){var item;if(typeof i!=='number'){i=currentTrack||0;}
item=window.displayList['tracks'][i];playlist_id=$(elt).attr('data-playlist-id');logged_in().done(function(){send_remove_playlist(playlist_id,item.id).done(function(data){if(data==="1"){_gaq.push(['_trackEvent','Track','removePlaylist']);}else{}}).fail(function(){});$(elt).removeClass('active');$('.playlist-ctrls .playlist-selected:eq('+i+')').removeClass('active').removeClass('playlist-'+playlist_id);});};window.toggleFavoriteQuery=function(query){var val=encodeURIComponent(query);var id_enc=Base64.encode(query);id_enc=id_enc.replace(/=+/,'');logged_in().done(function(){send_favorite('query',val).done(function(){_gaq.push(['_trackEvent','Search','Favorite']);});draw_toggle_favorite('query',id_enc);});};window.toggleFavoriteBlog=function(siteid){logged_in().done(function(){send_favorite('site',siteid).done(function(){_gaq.push(['_trackEvent','Blog','Favorite']);});draw_toggle_favorite('site',siteid);});};window.toggleFavoriteFriend=function(uid){logged_in().done(function(){send_favorite('user',uid).done(function(){_gaq.push(['_trackEvent','Friend','Favorite']);});draw_toggle_favorite('user',uid);});};window.draw_toggle_favorite=function(type,val){if(val.match('/^(yt_|vm_|mc_|sc_)/i')){return false;}
var activeclass="unfollow";var inactiveclass="follow";var activeclass_favcount="favcount-on";var inactiveclass_favcount="favcount-off";var active_text='<span class="icon-plus-minus"></span> <span>Unfollow</span>';var inactive_text='<span class="icon-plus-minus"></span> <span>Follow</span>';$(".fav_"+type+"_"+val).each(function(i,elt){if($(elt).hasClass(activeclass)){$(elt).removeClass(activeclass).addClass(inactiveclass);$(elt).html(inactive_text);}else{$(elt).removeClass(inactiveclass).addClass(activeclass);$(elt).html(active_text);}});$('.favcount_'+val).each(function(index,elt){if($(elt).hasClass(activeclass_favcount)){$(elt).removeClass(activeclass_favcount).addClass(inactiveclass_favcount);}else{$(elt).removeClass(inactiveclass_favcount).addClass(activeclass_favcount);}});};window.send_favorite=function(type,val,via_user){if(val.match('/^(yt_|vm_|mc_|sc_|bc_|sp_|am_)/i')){return false;}
return $.ajax({url:'/inc/user_action',data:'act=toggle_favorite&ts='+get_unix_time()+'&ts_offset='+(get_unix_time()-initial_ts)+'&initial_ref='+initial_ref+'&session='+get_visitorid()+'&type='+type+'&val='+val+
(typeof via_user!=='undefined'?'&via_user='+via_user:'')+'&current_page_name='+window.displayList['page_name']+'&current_page_mode='+window.displayList['page_mode']+'&current_page_arg='+window.displayList['page_arg']+'&current_page_sort='+window.displayList['page_sort']+
(typeof window.displayList['profile_user']!=='undefined'?'&current_profile_user='+window.displayList['profile_user']:'')+'&current_url='+encodeURIComponent(location.href)+'&fp='+fp,type:'post',async:true,cache:false,success:function(){},error:function(){_gaq.push(['_trackEvent','Error','add_favorite',null,1,true]);window.show_flash_message('We couldn\'t add your favorite! One of our systems is unavailable and will return shortly.','error')}});};window.send_set_playlist=function(playlist_id,itemid){return $.ajax({url:'/inc/user_action',data:'act=set_playlist&ts='+get_unix_time()+'&ts_offset='+(get_unix_time()-initial_ts)+'&initial_ref='+initial_ref+'&session='+get_visitorid()+'&playlist_id='+playlist_id+'&itemid='+itemid+'&current_page_name='+window.displayList['page_name']+'&current_page_mode='+window.displayList['page_mode']+'&current_page_arg='+window.displayList['page_arg']+'&current_page_sort='+window.displayList['page_sort']+
(typeof window.displayList['profile_user']!=='undefined'?'&current_profile_user='+window.displayList['profile_user']:'')+'&current_url='+encodeURIComponent(location.href)+'&fp='+fp,type:'post',async:true,cache:false,success:function(){},error:function(){_gaq.push(['_trackEvent','Error','send_playlist',null,1,true]);window.show_flash_message('We couldn\'t add your favorite! One of our systems is unavailable and will return shortly.','error')}});};window.send_remove_playlist=function(playlist_id,itemid){return $.ajax({url:'/inc/user_action',data:'act=remove_playlist&ts='+get_unix_time()+'&ts_offset='+(get_unix_time()-initial_ts)+'&initial_ref='+initial_ref+'&session='+get_visitorid()+'&playlist_id='+playlist_id+'&itemid='+itemid+'&current_page_name='+window.displayList['page_name']+'&current_page_mode='+window.displayList['page_mode']+'&current_page_arg='+window.displayList['page_arg']+'&current_page_sort='+window.displayList['page_sort']+
(typeof window.displayList['profile_user']!=='undefined'?'&current_profile_user='+window.displayList['profile_user']:'')+'&current_url='+encodeURIComponent(location.href)+'&fp='+fp,type:'post',async:true,cache:false,success:function(){},error:function(){_gaq.push(['_trackEvent','Error','send_playlist',null,1,true]);window.show_flash_message('We couldn\'t add your favorite! One of our systems is unavailable and will return shortly.','error')}});};window.show_all_tracks=function(elt){elt.parent().children().each(function(index,elti){if($(elti).attr('class')!==''&&$(elti).attr('class').match(/same-post/)){$(elti).hide();}});};window.show_buy=function(pos){$('#buy'+pos).slideDown(250);if($('#meta'+pos))$('#meta'+pos).hide();};window.expand_hyped=function(list_parent){var elementList=$('#list_parent').find('li');var tmp='';var i=0;$.each(elementList,function(index,elt){if($(elt).hasClass('hyped-6')&&$(elt).css('display','none')){$(elt).hide();}else if($(elt).hasClass('hyped-6')&&$(elt).css('display','')){$(elt).show();}});if($('#mbx').length){if($('#mbx').html().indexOf("EXPAND")!==-1){$('#mbx').html("HIDE &uarr;");}else{$('#mbx').html("EXPAND &darr;");}}};window.toggle_spy_check=function(){if($('#spy-status')&&$('#spy-status').hasClass('spy-live')){disable_spy_check();}else{enable_spy_check();}
return true;};window.enable_spy_check=function(){if(profile.supporter!=1){$('#spy-status').html('<span class="icon-play"></span> Resume updates').removeClass().addClass('spy-paused');return false;}
if(spyTimeout!=0){clearInterval(spyTimeout);spyTimeout=0;}
if(typeof window.displayList['tracks']!=='undefined'&&typeof window.displayList['tracks'][0]!=='undefined'){if(typeof window.displayList['tracks'][0].ts!=='undefined'){spyTimeout=window.setInterval(check_spy,2000);}
$('#spy-status').html('<span class="icon-pause"></span> Pause updates').removeClass().addClass('spy-live');}
return true;};window.check_spy=function(){var insert_offset;if($('#content-wrapper .haarp-active').length&&(playerStatus=='PAUSED'||playerStatus=='PLAYING')){insert_offset=1;}else{insert_offset=0;}
$.ajax({url:'/inc/serve_spy',data:'page='+encodeURIComponent(document.location.href)+'&latest='+window.displayList['tracks'][insert_offset].ts+'&ts='+get_unix_time(),type:'get',async:true,success:function(response){if(!response){return false;}
response=$(response);var new_track_obj={};new_track_obj=JSON.parse(response.filter('#displayList-data').html());response.filter('#displayList-data').text('');for(var i=0;typeof(window.displayList['tracks'][i])!='undefined';i++){if(window.displayList['tracks'][i].id==new_track_obj.id){return false;}}
response.insertBefore($('.haarp-section-track').eq(insert_offset)).slideDown(500);if($('.haarp-section-track').length&&$('div.haarp-section-track').eq(insert_offset+1).attr('class').match(/even/)){$('.haarp-section-track').eq(insert_offset).removeClass('even').addClass('odd');}
window.displayList.tracks.splice(insert_offset,0,new_track_obj);if(activeList==get_current_rel_url()&&typeof playList!=='undefined'&&!playList.gc){window.playList=jQuery.extend(true,{},window.displayList);}
if(window.displayList['tracks'].length>25){$('div.haarp-section-track:last').remove();if(typeof window.playList!=='undefined'){window.playList['tracks'].pop();}
if(activeList==get_current_rel_url()){window.displayList['tracks'].pop();}}}});};window.disable_spy_check=function(){if(spyTimeout!==0){clearInterval(spyTimeout);spyTimeout=0;$('#spy-status').html('<span class="icon-play"></span> Resume updates').removeClass().addClass('spy-paused');return true;}else{return false;}};window.enable_notification_check=function(){if(notificationTimeout!=0){clearInterval(notificationTimeout);notificationTimeout=0;}
if(window.displayList!=='undefined'){setTimeout(function(){if(typeof window.displayList['tracks']!=='undefined'&&typeof window.displayList['tracks'][0]!=='undefined'&&typeof window.displayList['tracks'][0].ts!=='undefined'){notificationTimeout=window.setInterval(check_notification,180000);}},180000);}else{return false;}};window.check_notification=function(){if(is_spy_page()){var request=$.ajax({url:'/inc/serve_track_notification',data:'page='+encodeURIComponent(document.location.href)+'&latest='+window.displayList['tracks'][0].ts+'&ts='+get_unix_time(),type:'get',async:true,success:function(response){$(response).insertBefore($('.section-track')[0]);if($('div.section-track').eq(1).attr('class').match(/even/)){$('.section-track').eq(0).removeClass('even').addClass('odd');}}});}};window.disable_notification_check=function(){if(notificationTimeout!==0){clearInterval(notificationTimeout);notificationTimeout=0;if(is_spy_page()){$('#spy-status').html('<span class="icon-pause"></span> Pause updates');$('#spy-status').removeClass().addClass('spy-paused');}
return true;}else{return false;}};window.check_section_updated=function(page_name,latest){if(ua_info.is_mobile){return false;}
var request=$.ajax({url:'/inc/serve_track_notification',data:'page_name='+encodeURIComponent(page_name)+'&latest='+latest+'&ts='+get_unix_time(),type:'get',dataType:'json',async:true,success:function(response){$count=$('#menu-item-username').find('.count');if(response.count>0){response.count='<span class="unread-notification-icon">&bull;</span>';$('.unread-notification-icon').show();$count.html(response.count).css('display','inline-block');}else{$('.unread-notification-icon').hide();$count.hide();}}});};window.enable_playback_check=function(){if(playback_event_timeout!==0){return false;}else{if(typeof(displayList.tracks)!=="undefined"&&displayList.tracks[currentTrack].type=="spotify"){playback_event_timeout=window.setInterval(playback_check,1000);}else{playback_event_timeout=window.setInterval(playback_check,5000);}
return true;}};function playback_check(){var activePlayer=currentPlayerObj[(currentPlayerObj.length-1)];if(typeof(activePlayer)!=="undefined"&&typeof(activePlayer.type)!=="undefined"&&activePlayer.type.match(/(youtube|vimeo|mixcloud)/)){return false;}
if(playerStatus=="PLAYING"){if(activePlayer.type=="spotify"){spotify_player.getCurrentState().then(function(state){if(!state){return;}
player_position=parseInt(state.position/1000);player_duration=parseInt(state.duration/1000);player_elements.time_position.html(sec_to_str(player_position));player_elements.progress_playing.width((Math.round(player_position/player_duration*100*100)/100)+'%');});return false;}
if(typeof(player_position)=="undefined"){player_position=0;}
if(!ua_info.is_mobile){activePlayer['player_position_log'].push(player_position);if(activePlayer['player_position_log'].length>3){activePlayer['player_position_log'].shift();}
if(!(activePlayer['player_position_log'][0]||activePlayer['player_position_log'][1]||activePlayer['player_position_log'][2])&&activePlayer['player_position_log'].length==3){if(activePlayer.url.match(/(hypem.net|hypem.com)/)||activePlayer['final']){nextTrack();}else{$.ajax({url:'/inc/user_action',data:'act=track_playback_stall&itemid='+window.playList['tracks'][activePlayer.seq].id+'&session='+get_visitorid()+'&bytesLoaded='+activePlayer.bytesLoaded+'&playerPosition='+player_position+'&duration='+parseInt(activePlayer.duration/1000)+'&transferTime='+(get_unix_time()-track_load_start_ts)+'&readyState='+activePlayer.readyState+'&playState'+activePlayer.playState+'&paused='+activePlayer.paused+'&url='+encodeURIComponent(activePlayer.url),cache:false,type:'post',async:true});loadTrack(0,1,0);}}}
var via_data='';if(window.playList['page_name']=="profile"&&(window.playList['page_mode']=="loved"||window.playList['page_mode']=="history")&&profile.logged_in_username!=window.playList['profile_user']){via_data="&via_user="+window.playList['profile_user'];}else if(window.playList['page_name']=="profile"&&window.playList['page_mode']=="feed"&&profile.logged_in_username==window.playList['profile_user']&&profile.logged_in_username!=window.playList['tracks'][currentTrack].via_user){via_data="&via_user="+window.playList['tracks'][currentTrack].via_user;}
if(playback_event_count==0&&player_position>=30&&player_position<45){_gaq.push(['_trackEvent','Track','Play_30']);$.ajax({url:'/inc/user_action',data:'act=log_action&type=listen&ts='+get_unix_time()+'&ts_offset='+(get_unix_time()-initial_ts)+'&initial_ref='+initial_ref+'&session='+get_visitorid()+'&val='+window.playList['tracks'][currentTrack].id+'&pos='+player_position+'&rem='+(player_duration-player_position)+'&vendor='+playerDisplayed+'&playback_manual='+playback_manual+via_data+'&current_page_name='+window.playList['page_name']+'&current_page_mode='+window.playList['page_mode']+'&current_page_arg='+window.playList['page_arg']+'&current_page_sort='+window.playList['page_sort']+'&current_url='+encodeURIComponent(activeList),type:'get',success:function(response){if(response=='NOPLAYS'){profile.playback_allowed=false;}else if(response=='BUYPROMPT'){window.playList['tracks'][currentTrack].buy_prompt=1;}}});playback_event_count++;}else if(playback_event_count==1&&(player_position/player_duration)>(2/3)){_gaq.push(['_trackEvent','Track','Play_Full']);$.ajax({url:'/inc/user_action',data:'act=log_action&type=listen&ts='+get_unix_time()+'&ts_offset='+(get_unix_time()-initial_ts)+'&initial_ref='+initial_ref+'&session='+get_visitorid()+'&val='+window.playList['tracks'][currentTrack].id+'&pos='+player_position+'&rem='+(player_duration-player_position)+'&vendor='+playerDisplayed+'&playback_manual='+playback_manual+via_data+'&current_page_name='+window.playList['page_name']+'&current_page_mode='+window.playList['page_mode']+'&current_page_arg='+window.playList['page_arg']+'&current_page_sort='+window.playList['page_sort']+'&current_url='+encodeURIComponent(activeList),type:'get'});playback_event_count++;}}else{}};window.disable_playback_check=function(){if(playback_event_timeout!=undefined){clearInterval(playback_event_timeout);playback_event_timeout=0;return true;}else{return false;}};window.toggle_item_activity=function(type,item,skip,limit,soft){var itemid=item.attr('data-itemid');var elt_name;if(type=='favorites'||type=="favorites-friends"){elt_name='favcountlist';}else if(type=='reposts'){elt_name='reposts';}
var act_info=$('#section-track-'+item.attr('data-itemid')+' .act_info');if(soft&&act_info.css('display')!=="none"&&act_info.html()!==''){return false;}
if(act_info.css('display')!=="none"&&$(act_info.children()[0]).hasClass(elt_name)){act_info.slideUp(300);if(type=="reposts"){$('#section-track-'+itemid+' .post_info').fadeIn(300);}}else if(act_info.html()!==''&&$(act_info.children()[0]).hasClass(elt_name)){if(type=="reposts"){$('#section-track-'+itemid+' .post_info').hide();}
act_info.show();}else{if(type=="reposts"){$('#section-track-'+itemid+' .post_info').hide();}
load_item_activity(type,itemid,skip,limit);}};window.update_item_activity=function(type,itemid,skip,limit){load_item_activity(type,itemid,skip,limit);};window.load_item_activity=function(type,itemid,skip,limit){show_loading();var extra_args;var target_elt;if(type=='tweets'){target_elt=$('#section-track-'+itemid+' .act_info_tweets');}else if(type=='reposts'){target_elt=$('#section-track-'+itemid+' .act_info');}else{target_elt=$('#section-track-'+itemid+' .act_info');}
return $.ajax({url:'/inc/serve_activity_info',data:'type='+type+'&id='+itemid+'&skip='+skip+'&limit='+limit+'&extra_args='+JSON.stringify(extra_args)+'&ts='+get_unix_time(),type:'get',async:true,success:function(response){target_elt.html(response);target_elt.show();hide_loading();}});};window.load_also_loved=function(){if(ua_info.is_mobile){return false;}
var item_set="";$('.section-track').each(function(i,el){var target_elt;var itemid;itemid=$(el).attr('data-itemid');target_elt=$('#section-track-'+itemid+' .track-info');if(typeof(itemid)!="undefined"&&!target_elt.hasClass('completed')){item_set+=itemid+",";}});return $.ajax({url:'/inc/serve_track_details',data:'items='+item_set+'&ts='+get_unix_time()+'&page_name='+displayList['page_name']+'&page_mode='+displayList['page_mode'],type:'get',dataType:'json',async:true,success:function(response){$.each(response,function(itemid,item_data){var item_str="";target_elt=$('#section-track-'+itemid+' .track-info');var orig_contents=target_elt.html();if(typeof(orig_contents)=="undefined"){orig_contents="";}
if(orig_contents.match(/(found|using)/i)){if(item_data['loved']){item_str='. also loved by '+item_data['loved'];}}
else if(orig_contents.match(/loved/i)){if(item_data['played']){item_str=' Heard '+item_data['played']+". ";}
if(item_data['loved']){item_str=' + by '+item_data['loved'];}
item_str=orig_contents+item_str;orig_contents="";}
else if(orig_contents=="&nbsp;"){orig_contents='';if(item_data['played']){item_str=' Heard '+item_data['played']+". ";}
if(item_data['loved']){item_str+='Loved by '+item_data['loved'];}}
else{if(item_data['played']){item_str=' Heard '+item_data['played']+". ";}
if(item_data['loved']){item_str+=' Loved by '+item_data['loved'];}}
target_elt.html(orig_contents+item_str);target_elt.css({'display':'block'});target_elt.addClass('completed');});}});};window.toggle_item_graph=function(id,force){var target_elt=$('#flot-'+id+'-container');if(!$('#flot-'+id).length&&!force){load_item_graph(id);}else{if(target_elt.css('display')=='none'){target_elt.slideDown(200);}else{target_elt.slideUp(200);}}};window.load_item_graph=function(id){show_loading();var target_elt=$('#flot-'+id+'-container');return $.ajax({url:'/inc/serve_track_graph',data:'&id='+id,type:'get',async:true,success:function(response){target_elt.html(response);target_elt.show();hide_loading();}});};window.show_sidebar_info=function(uid,method,section){var element=$('#'+section);if(element.css('display')!="none"){element.slideUp(300,function(){element.hide();});$('#show_'+method).html('Show all &darr;');}else{$.ajax({url:'../inc/serve_sidebar_profile_items',data:'uid='+uid+'&method='+method,type:'get',async:true,success:function(response){element.html(response);$('#loading_'+method).hide();$('#show_'+method).html('Collapse &uarr;');element.slideDown(200);}});$('#loading_'+method).show();}};window.set_nav_item_active=function(eltid){var menu=$('#menu-item-username');$("li.active").removeClass('active');if(menu.length){menu.removeClass('active');}
if(eltid){var eltm=$('#'+eltid);eltm.addClass('active');}};window.set_zeitgeist_nav_item=function(year){$('#menu-zeitgeist-submenu li.current').each(function(i,el){$(el).removeClass('current');});var eltm=$('#menu-zeitgeist-'+year);if(eltm.length){eltm.addClass('current');}
$('#menu-zeitgeist-current').html('ZEITGEIST <sp'+'an class="year">'+year+'</span> <sp'+'an class="arr">&#x25BC;</span>');};window.setup_player_bar=function(){if(typeof(player_elements)=="undefined"){init_selectors();}
var playableCount=0;if(typeof(window.displayList['tracks'])!='undefined'){for(var i=0;typeof(window.displayList['tracks'][i])!='undefined';i++){if(typeof(window.displayList['tracks'][i].type)=="string"&&window.displayList['tracks'][i].type!=''){playableCount++;}}}
var window_el=$(window);if(player_elements.container.hasClass('mobile')){window_el.bind('scroll',function(){player_elements.container.css('top',window.pageYOffset+window.innerHeight-34);});}
var end=/\/[0-9]+$/g;var same_page=false;if(typeof(activeList)!=="undefined"&&activeList){same_page=activeList.replace(end,'')==get_current_rel_url().replace(end,'');}
if(playerStatus!="PLAYING"&&playerStatus!="PAUSED"){if(typeof window.displayList!=='undefined'&&typeof window.displayList.title==="string"){document.title=$("<div>"+window.displayList.title+"</div>").text();}else{document.title='Hype Machine';}
if(typeof window.displayList==='undefined'||typeof window.displayList['tracks']==='undefined'||playableCount==0){hide_player_bar();return false;}else{show_player_bar();}
try{delete window.playList;}catch(e){window.playList=undefined;}
currentTrack=0;set_now_playing_info(window.displayList['tracks'][0]);player_elements.volume_ctrl.height(player_volume+"%");player_elements.from_prev_page.css('visibility','hidden');if(window.displayList['tracks'].length==1){player_elements.prev.removeClass("playerPrev-active").addClass("playerPrev-inactive");player_elements.next.removeClass("playerNext-active").addClass("playerNext-inactive");}else if(window.displayList['tracks'].length>1){player_elements.prev.removeClass("playerPrev-inactive").addClass("playerPrev-active");player_elements.next.removeClass("playerNext-inactive").addClass("playerNext-active");}
$('.haarp-section-track').eq(currentTrack).addClass('haarp-fav-active');}else if(playerStatus=="PLAYING"||playerStatus=="PAUSED"){var active_class;if(same_page&&!is_tv_page()&&!is_spy_page()){active_class='haarp-active';}else{active_class='haarp-fav-active';}
if(!is_shuffle_page()&&currentTrack<window.displayList['tracks'].length&&window.playList['tracks'][currentTrack].id==window.displayList['tracks'][currentTrack].id){$('.haarp-section-track').eq(currentTrack).addClass(active_class);}else{for(var i=0;typeof(window.displayList['tracks'][i])!='undefined';i++){if(window.displayList['tracks'][i].id==window.playList['tracks'][currentTrack].id){$('.haarp-section-track').eq(i).addClass(active_class);}}}
if(playerStatus=="PLAYING"&&same_page&&!is_tv_page()&&!is_spy_page()){player_elements.from_prev_page.css('visibility',"hidden");}else{player_elements.from_prev_page.css('visibility','visible');}
setPlaying();}
player_elements.player_inner.show();};window.setup_hidden_player=function(){};window.hide_player_bar=function(){if(typeof(player_elements)=="undefined"){init_selectors();}
player_elements.container.addClass("disabled");$('#player-controls').on('click','a',function(){return false;}).find('a').off('click');};window.show_player_bar=function(){if(typeof(player_elements)=="undefined"){init_selectors();}
if(player_elements.container.hasClass("disabled")){player_elements.container.removeClass("disabled");attach_clicks_player_bar();}};window.blog_search=function(auto){clearInterval(window.autosearch_blogs);if((auto&&$('#blog-directory-search').val().length>=3)||!auto){var request=$.ajax({url:'/inc/serve_sites',data:'q='+$('#blog-directory-search').val(),type:'get',async:true,success:function(response){$('#directory-blogs').html(response);}});}};window.infinite_blog_scroll=function(pages,expand_el,GET){window.blog_scroll={infinite:false,pages:pages,page:1,loading:false,GET:GET,complete:false};var w_el=$(window);var dir_el=$('#directory');expand_el.bind('click',function(e){window.blog_scroll.infinite=true;loadNextBlogPage(true);$(this).remove();});w_el.bind('scroll',function(e){var offset=$('#directory-blogs-inject').offset();if(offset){var point=offset.top-(320*2);if(w_el.scrollTop()>=point){loadNextBlogPage();}}
fadeInImages();});function fadeInImages(force){if(typeof force=='undefined')force=false;$('.fadein').each(function(i,el){var el=$(el);var offset=el.offset();if(force||w_el.scrollTop()+w_el.height()>=offset.top){el.removeClass('fadein');el.hide().fadeIn(500);}});}
function loadNextBlogPage(force){if(typeof force=='undefined')force=false;if(!window.blog_scroll.loading&&window.blog_scroll.infinite&&!window.blog_scroll.complete){window.blog_scroll.loading=true;window.blog_scroll.GET.page++;show_loading();$.ajax({url:'/inc/serve_sites',data:window.blog_scroll.GET,aync:true,type:'get',dataType:'html',success:function(response){if(response==''||response.match(/Hype Machine doesn\'t index a blog by that name/)){window.blog_scroll.complete=true;}
$('#directory-blogs-inject').before(response);hide_loading();window.blog_scroll.loading=false;$('.fadein').each(function(i,el){$(el).hide();});fadeInImages(force);}});}}};window.insert_next_page=function(callback){var current_page=window.displayList.page_num;url=window.displayList.page_next;url=url.replace(/^#!?/,'');if(!skip_update_page_contents&&(window.displayList.loaded_page_next!=url||url.match(/shuffle/i))){window.displayList.loaded_page_next=url;show_loading();if(is_html5_history_compat()&&is_hypem()){skip_update_page_contents=1;history.replaceState(null,null,document.location.protocol+'//'+document.location.host+url);activeList=get_current_rel_url();}
function post_update_page_contents(){hide_loading();n_displayList=JSON.parse($('#displayList-data').remove().html());n_displayList['tracks']=window.displayList['tracks'].concat(n_displayList['tracks']);window.displayList=n_displayList;if(activeList==get_current_rel_url()&&typeof playList!=='undefined'&&!playList.gc){window.playList=jQuery.extend(true,{},window.displayList);}
if(window.displayList['show_favorites_friends']){load_also_loved();}
window.displayList['url']=get_current_rel_url();is_infinite_scroll=true;set_ad_vars();draw_ads("infinite_scroll");ga_pageview();install_ad_waypoints("infinite_scroll");}
page_updater=$.ajax({url:url,data:'ax=1&frag=1&ts='+get_unix_time(),dataType:'html',type:'get',async:true,success:function(content){if(is_hypem()){$('#content-wrapper').append(content);}else{$('.picks-list').append(content);}
post_update_page_contents();if(!infinite_page_scroll_status.hit_end&&(window.displayList.page_next==url||!window.displayList.page_next)&&!(window.displayList.page_name=='profile'&&window.displayList.page_sort=='shuffle')){disable_infinite_page_scroll();infinite_page_scroll_status.hit_end=true;}
r=setTimeout(function(){skip_update_page_contents=0;},500);},error:function(){hide_loading();setup_player_bar();_gaq.push(['_trackEvent','Error','page_updater',null,1,true]);}});}else{}};window.enable_infinite_page_scroll=function(){var w_el=$(window);var more_el=$('#infinite-tracks-button');if(more_el.length){infinite_page_scroll_status.view_more_exists=true;more_el.bind('click',function(){more_el.parent().slideUp(250);infinite_page_scroll_status.view_more_clicked=true;insert_next_page(function(){more_el.hide();});w_el.bind('scroll',infinite_page_scroll);return false;});}else{w_el.bind('scroll',infinite_page_scroll);}};window.disable_infinite_page_scroll=function(){var w_el=$(window);w_el.unbind('scroll',infinite_page_scroll);infinite_page_scroll_status.view_more_clicked=false;infinite_page_scroll_status.view_more_exists=false;infinite_page_scroll_status.hit_end=false;};window.infinite_page_scroll_status={jump_ahead:200,view_more_exists:false,view_more_clicked:false,hit_end:false};window.infinite_page_scroll=function(e){var cw=$('#content-wrapper');var offset=cw.offset();if(offset){var point=offset.top+cw.height();if($(window).scrollTop()+window.innerHeight+infinite_page_scroll_status.jump_ahead>=point){insert_next_page();}}};window.blog_search_keyup=function(e){clearInterval(window.autosearch_blogs);window.autosearch_blogs=setTimeout(function(){blog_search(true);},500);};window.next_review=function(pos){if(album_r_curr[pos]+1>(album_rs[pos].length-1)){album_r_curr[pos]=0;show_review(pos);}else if(album_r_curr[pos]===0||album_r_curr[pos]===undefined){album_r_curr[pos]=1;show_review(pos);}else{album_r_curr[pos]++;show_review(pos);}};window.prev_review=function(pos){if(album_r_curr[pos]-1<0||album_r_curr[pos]===undefined){album_r_curr[pos]=album_rs[pos].length-1;show_review(pos);}else{album_r_curr[pos]--;show_review(pos);}};window.show_review=function(pos){$('#album-review'+pos).hide()
$('#album-review-text'+pos).html(album_rs[pos][album_r_curr[pos]].rbody);$('#album-review'+pos).fadeIn(500);};window.load_rdio=function(pos,c_id){new_iframe=$('<iframe/>',{id:"rdio_"+pos,width:"360",height:"360",scrolling:"no",frameborder:"no",src:'http://rd.io/i/'+c_id+'?maxwidth=360&maxheight=360&autoplay=1&linkshare_id=DkrYZ0xe5n0&linkshare_subid=&linkshare_offerid=221756.1&linkshare_type=10&linkshare_tmpid=8599'});$('#album-player'+pos).append(new_iframe);$('#album-art'+pos).hide();$('#album-player-link'+pos).hide();};window.updateUrl=function(value){if($('#username_url').length){$('#username_url').html(value);}};window.watchInput=function(el,options){var duration=options.duration||1000;var callback=(typeof options.callback=='function')?options.callback:function(){};var bind=(typeof options.onblur!='undefined')?'blur':'keyup';if(bind=='blur')duration=0;el.bind(bind,function(){clearInterval(window[el.attr('id')+'_interval']);window[el.attr('id')+'_interval']=setTimeout(function(){if(typeof options.url!='undefined'){$.ajax({url:'/inc/user_action',async:true,type:'post',data:options.url+encodeURIComponent(el.val()),dataType:'json',success:function(response){callback(response);}});}else{callback();}},duration);});};window.process_lightbox_input=function(form_name){var form_data=$("#defaultform").serialize();var extra_data="";if(form_name=="create_account"&&$('#form_type').val()=="normal"){var recaptcha_response;if(typeof grecaptcha!='undefined'){recaptcha_response=grecaptcha.getResponse();}
extra_data='&recaptcha_response='+recaptcha_response;}
function on_response_failure(response,form_name){if(!response||!response.error_msg){$("#formmsg").html("Sorry! :(<br/>An unexpected error occurred: '"+response+"'<br/>Please <a href='/contact'>write to us</a> if this persists.");_gaq.push(['_trackEvent','Error','process_lightbox_input',null,1,true]);}else{$('#formmsg').html(response.error_msg);_gaq.push(['_trackEvent','Error','process_lightbox_input',null,1,true]);}
$("#formmsg").removeClass('bad good').addClass('bad').show();$("#submitlogin").attr('disabled',false);if(form_name=="login"){$("#submitlogin").val("Sign in");}else if(form_name=="forgot"){$("#submitlogin").val("Reset Password");}else if(form_name=="create_account"){$("#submitlogin").val("Create Account");}else if(form_name=="account"||form_name=="sharing"||form_name=="change_password"||form_name=="reset_pw"||form_name=="change_username"||form_name=="change_email"||form_name=="privacy"){$("#submitlogin").val("Save");}}
function on_response_success(response,form_name){if(response.status==="ok"){if(form_name=="login"||form_name=="create_account"||form_name=="reset_pw"){if($('#form_type').val()=="mobile"){document.location.href='/special/mobile_signup_success';}else{if(is_ssl_parent()){post_login();}else{document.location.href='http://'+document.location.host+'/inc/lb_login?post_login=1';}}}else if(form_name=="forgot"||form_name=="account"||form_name=="sharing"||form_name=="change_password"||form_name=="change_username"||form_name=="change_email"||form_name=="privacy"){if(form_name=="account"){$('#user_avatar').hide();}
$("#defaultform").hide();$("#formmsg").removeClass('bad good').addClass('good').html(response.msg).show();}}else if(response.status==="error"){on_response_failure(response,form_name);_gaq.push(['_trackEvent','Error','process_lightbox_input',null,1,true]);}else{on_response_failure(response,form_name);}}
return $.ajax({url:'/inc/user_action',data:'act='+form_name+'&session='+get_visitorid()+'&'+form_data+extra_data,type:'post',dataType:'json',success:function(data,response_txt,xhr_obj){on_response_success(data,form_name);},error:function(xhr_obj,error_txt,http_error){on_response_failure(error_txt,form_name);_gaq.push(['_trackEvent','Error','process_lightbox_input',null,1,true]);}});};window.process_user_action=function(action_type){show_loading();function on_response_failure(response,action_type){hide_loading();if(!response||!response.error_msg){if(action_type=="user_logout"){window.show_flash_message("We encountered an error logging you out.  It was: '"+response+"'.  Please try again later",'error')
_gaq.push(['_trackEvent','Error','process_user_action',null,1,true]);}else{$("#formmsg").html("Sorry! :(<br/>An unexpected error occurred: '"+response+"'<br/>Please <a href='/contact'>write to us</a> if this persists.");}}else{if(action_type=="user_logout"){window.show_flash_message(response.error_msg,'error');}else{$('#formmsg').html(response.error_msg);}
_gaq.push(['_trackEvent','Error','process_user_action',null,1,true]);}
$("#formmsg").removeClass('bad good').addClass('bad').show();$("#submitlogin").attr('disabled',false);}
function on_response_success(response,action_type){hide_loading();if(response.status==="ok"){if(action_type=="user_logout"){post_logout();load_user_menu();update_page_contents();}else if(action_type=="unlink_facebook"||action_type=="unlink_twitter"||action_type=="unlink_lastfm"||action_type=="unlink_google"||action_type=="unlink_soundcloud"||action_type=="unlink_spotify"||action_type=="enable_sc_sync"||action_type=="disable_sc_sync"||action_type=="enable_spotify_sync"||action_type=="disable_spotify_sync"){if(action_type=="unlink_facebook"){profile.facebook_authed=false;}
update_page_contents();}else if(action_type=="request_confirmation"){$('#user_avatar').hide();$("#defaultform").hide();$("#formmsg").removeClass('bad good').addClass('good').html(response.msg).show();}else{$("#defaultform").hide();window.show_flash_message("Settings Updated!");}}else if(response.status==="error"){on_response_failure(response,action_type);_gaq.push(['_trackEvent','Error','on_response_success',null,1,true]);}else{on_response_failure(response,action_type);}}
return $.ajax({url:'/inc/user_action',data:'act='+action_type+'&session='+get_visitorid(),type:'post',dataType:'json',success:function(data,response_txt,xhr_obj){on_response_success(data,action_type);},error:function(xhr_obj,error_txt,http_error){_gaq.push(['_trackEvent','Error','user_action',null,1,true]);on_response_failure(error_txt,action_type);}});};window.post_login=function(){Lightbox.hideBox();return load_user_menu().then(function(){return update_page_contents()}).then(function(){typeof window.login_deferred==='object'&&window.login_deferred.resolve();});};window.post_logout=function(){load_user_menu();delete window.login_deferred;};window.post_username_change=function(){load_url('/popular');load_user_menu();Lightbox.hideBox();};window.cancel_iframe_dialog=function(redir_to){if(/hotel/.test(document.location.href)){document.location.href='/hotel/#rsvp';document.location.reload();}else if(!/lb_/.test(document.location.href)){if(typeof(redir_to)!='undefined'&&redir_to!=''){load_url(redir_to);}else if(document.location.href.match(/forgot=1/)){load_url("/");}else if(document.location.href.match(/signup=1/)){load_url("/");}else
{update_page_contents();}
load_user_menu();Lightbox.hideBox();}else{document.location.href='http://'+document.location.host+'/inc/lb_cancel';}};window.lightbox_close_handler=function(lightbox_url){if(lightbox_url.match(/lb_account/)){load_user_menu();if(window.displayList&&window.displayList['page_name']=='profile'){update_page_contents();}}
if(lightbox_url.match(/lb_login|lb_signup/)){typeof window.login_deferred==='object'&&window.login_deferred.reject();delete window.login_deferred;}
Lightbox.hideBox();};window.is_ssl=function(){return document.location.protocol=='https:';};window.is_ssl_parent=function(){return!/lb_/.test(document.location);};window.switch_lightbox=function(type,url,reload){if(typeof(url)==="undefined")url='';if(is_ssl_parent()){show_lightbox(type,url);}else{document.location.href='http://'+document.location.host+'/inc/lb_cancel?switch_lightbox=1&type='+type+'&url='+url;}};window.load_url_from_lightbox=function(url){if(is_ssl_parent()){load_url(url);cancel_iframe_dialog();}
else{document.location.href='http://'+document.location.host+'/inc/lb_cancel?redir_to='+url;}};window.show_lightbox=function(type,url,arg1){if(typeof(Lightbox)==="undefined"){setTimeout(function(){show_lightbox(type,url,arg1);},1000);return false;}
if(!$('#box').length)Lightbox.init();if(typeof(url)==="undefined")url=false;if(type=='login'){if(url)Lightbox.showBoxByAJAX(url,lb_dimensions[type].width,lb_dimensions[type].height);else Lightbox.showBoxByAJAX('/inc/lb_login',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='login_email'){Lightbox.showBoxByAJAX('/inc/lb_login_email',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='signup'){if(url)Lightbox.showBoxByAJAX(url,lb_dimensions[type].width,lb_dimensions[type].height);else Lightbox.showBoxByAJAX('/inc/lb_signup',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='listen'){if(url)Lightbox.showBoxByAJAX(url,lb_dimensions[type].width,lb_dimensions[type].height);else Lightbox.showBoxByAJAX('/inc/lb_signup_info',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='confirm_new_twitter'){Lightbox.showBoxByAJAX('/inc/lb_confirm_new?service=twitter',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='confirm_new_facebook'){Lightbox.showBoxByAJAX('/inc/lb_confirm_new?service=facebook',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='confirm_new_soundcloud'){Lightbox.showBoxByAJAX('/inc/lb_confirm_new?service=facebook',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='forgot'){Lightbox.showBoxByAJAX('/inc/lb_forgot',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='reset'){Lightbox.showBoxByAJAX(url,lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='change_password'){Lightbox.showBoxByAJAX('/inc/lb_change_pw',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='change_username'){Lightbox.showBoxByAJAX('/inc/lb_change_username',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='change_email'){Lightbox.showBoxByAJAX('/inc/lb_change_email',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='account'){Lightbox.showBoxByAJAX('/inc/lb_account',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='sharing'){Lightbox.showBoxByAJAX('/inc/lb_sharing',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='privacy'){Lightbox.showBoxByAJAX('/inc/lb_privacy',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='sub_only'){Lightbox.showBoxByAJAX('/inc/lb_sub_only',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='sub_heavy'){Lightbox.showBoxByAJAX('/inc/lb_sub_heavy',lb_dimensions[type].width,lb_dimensions[type].height);}else if(type=='supportus'){if(url)Lightbox.showBoxByAJAX(url,lb_dimensions[type].width,lb_dimensions[type].height);else Lightbox.showBoxByAJAX('/inc/lb_supportus',lb_dimensions[type].width,lb_dimensions[type].height);}
$('#overlay').bind('click',function(){lightbox_close_handler(Lightbox.lightboxURL);return false;});return false;};window.checkPw=function(){if($("#user_password_confirmation").val()!==$("#user_password").val()||$("#user_password").val()==''||$("#user_password_confirmation").val()==''){$("#nomatch").css('display',"inline");$("#submitlogin").attr('disabled',true);return 1;}else{$("#nomatch").css('display',"none");$("#submitlogin").attr('disabled',false);return false;}};window.display_twitter_score=function(){$('#twitter_score_calculate').val('Calculating...').attr('disabled',true);$('#twitter_score_name').attr('disabled',true);$.ajax({url:'/inc/user_action',data:'act=check_twitter_score&session='+get_visitorid()+'&arg='+encodeURIComponent($('#twitter_score_name').val()),type:'get',dataType:'json',success:function(response){var resp_data=response;if(resp_data!=''){$('#twitter_score_dyn').html('<b>'+Math.round(resp_data.tweet_points)+' points</b> will be added to a song\'s score when <a href="http://twitter.com/'+resp_data.twitter_name+'">'+resp_data.twitter_name_long+'</a> links to it on Twitter.').show();$('#twitter_score_calculate').val('Calculate!').attr('disabled',false);$('#twitter_score_name').attr('disabled',false);}else{$('#twitter_score_dyn').html('<b>N/A</b> points / tweet').show();$('#twitter_score_calculate').val('Calculate!').attr('disabled',false);$('#twitter_score_name').attr('disabled',false);}},error:function(){_gaq.push(['_trackEvent','Error','twitter_score',null,1,true]);$('#twitter_score_dyn').html('<b>N/A</b> points / tweet').show();$('#twitter_score_calculate').val('Calculate!').attr('disabled',false);$('#twitter_score_name').attr('disabled',false);}});};window.UploadToS3=function(){if($('#picture_upload').val()){$("#s3_upload_form").attr('target',"fileframe").attr('action',"/inc/img_upload");$('#current_img_elt').hide();$("#img_frame").show();$("#s3_upload_form").submit();}else{return false;}};window.contact_show_tips=function(){if(!is_hypem()&&$('#contact_subject').val()=="The blockchain"){$('#contact_message').hide();$('#contact_submit').hide();return false;}else if(!is_hypem()){$('#contact_message').show();$('#contact_submit').show();return false;}
switch($('#contact_subject').val()){case"Sites listed here":$.ajax({url:'inc/serve_all_blogs_listbox',success:function(response){$('#blogs_list').html(response);}});$('#blog_name').show();$('#blogs_list').html('<option>Please wait...</option>');$('#contact_tips').html('<p><strong>Recommending a new site?</strong><br />Use the <a href=\"/add\">add site form</a>; otherwise, pick the site you are contacting us about below.  If tracks you posted are not appearing correctly, please also provide the link to the missing/incorrect post.</p>').show();break;case"Ad feedback":$('#contact_tips').html("<p><strong>Reporting an ad problem?</strong><br />Clicking on the ad and giving us the URL it sends you to, will help greatly!</p>").show();$('#blog_name').hide();break;case"Business stuff":$('#contact_tips').html("<p>Please be brief about how you see us working together.</p>").show();$('#blog_name').hide();break;case"Report bugs":$('#contact_tips').html('<p>Please include what were you doing when the error happened, what browser you use, etc.<br /><br />If you use AdBlock, Flashblock, NoScript, or any other ad-blocking tools or Internet security software, please try disabling them if you encounter problems using the site</p>').show();$('#blog_name').hide();break;case"Everything else":$('#contact_tips').html("<p><a href='http://hypem.com/about'>Our FAQ</a> can answer most common questions, <a href='http://hypem.com/about'>please look there first</a> - you'll get your answer faster!</p>").show();$('#blog_name').hide();break;default:$('#blog_name').hide();$('#contact_tips').html('').show();}};window.positionMap=function(artist){if(ua_info.is_mobile){return false;}
map.setZoom(4);loc=positions[artist.toLowerCase()];map.setCenter(new google.maps.LatLng((loc.lat()+9),loc.lng()));};window.init_fp=function(){fp=new Fingerprint({canvas:true,screen_resolution:true}).get();}
window.init_soundmanager=function(){if(document.location.href.match(/lb_/)){return false;}
soundManager.useHTML5Audio=true;soundManager.forceUseGlobalHTML5Audio=true;if(is_dev()){soundManager.debugMode=true;soundManager.useConsole=true;soundManager.consoleOnly=true;}else{soundManager.debugMode=false;}
soundManager.url='/js/soundmanagerv297a-20170601/swf/';soundManager.flashLoadTimeout=5000;soundManager.defaultOptions.usePolicyFile=false;soundManager.onready(function(){if(soundManager.supported()){var group=$('#player-progress-loading, #player-progress-playing, #player-volume-outer');group.bind('mousedown',sm_start_drag).bind('mouseup',sm_end_drag);if(typeof player_elements==='undefined'){init_selectors();}
player_elements.volume_mute.on('click',sm_toggle_mute);player_elements.repeat_ctrl.on('click',sm_toggle_repeat);}else{_gaq.push(['_trackEvent','Error','soundmanager_unsupported',null,1,true]);}});soundManager.beginDelayedInit();};window.fb_ensure_init=function(callback){if(!window.fbApiInit){setTimeout(function(){fb_ensure_init(callback);},250);}else{if(callback){callback();}}};window.check_toast_permission=function(callback){var prompt=$('#toast-prompt');if(window.webkitNotifications){if(window.webkitNotifications.checkPermission()){if(!toast_prompt_shown){prompt.fadeIn();}
window.webkitNotifications.requestPermission(function(){prompt.fadeOut();callback();});toast_prompt_shown=true;}else{callback();}}};window.show_toast=function(image,title,body){try{var toast=window.webkitNotifications.createNotification(image,title,body);toast.show();_gaq.push(['_trackEvent','Toast','Show',null,1,true]);toast.onclick=function(x){_gaq.push(['_trackEvent','Toast','Clicked']);window.focus();this.cancel();};setTimeout(function(){toast.cancel();},7500);}catch(Err){_gaq.push(['_trackEvent','Error','Toast',null,1,true]);}};window.fire_share_modal=function(){var center={x:($(window).width()/2)-(800/2),y:($(window).height()/2)-(600/2)};var new_window=window.open($(this).data('href'),$(this).attr('rel'),'height=600,width=800,location=false,toolbar=false,menubar=false,screenX='+center.x+',screenY='+center.y+',left'+center.x+',top'+center.y);_gaq.push(['_trackEvent','Share_Modal',$(this).data('href')]);return false;};window.show_flash_message=function(text,type){var type=type||null,flash_container=$('#flash-message');flash_container.stop().hide().removeClass('info success error').addClass(type).text(text).fadeIn(0).delay(3000).fadeOut(400).bind('click',function(){$(this).hide();});};window.handle_click=function(event){if(event.which==2||(ua_info.is_mobile&&$(this).hasClass('thumb'))||$(this).prop('target')=="_blank"||$(this).prop('target')=="_top"){event.stopPropagation();return true;}
if($(this).attr('href')){if($(this).attr('href').charAt(0)==='#'){var offset=$($(this).attr('href')).offset();if(typeof(offset)!="undefined"){$('html, body').animate({scrollTop:offset.top-60,scrollLeft:offset.left});}
if(is_html5_history_compat()){skip_update_page_contents=1;history.replaceState(null,null,document.location.protocol+'//'+document.location.host+document.location.pathname+$(this).attr('href'));}
return false;}
t_elt=event.target||event.srcElement;if(t_elt.tagName!='A'&&t_elt.tagName!='a'){while(t_elt.tagName!='A'&&t_elt.tagName!='a'){t_elt=t_elt.parentNode;}}
if($(t_elt).hasClass('haarp-play-ctrl')){return false;}
if(t_elt.tagName=='a'){url=$(t_elt).attr('href');}else if(t_elt.tagName=='A'){url=t_elt.href;}
if(url.match(/^\/random$/)){load_random_track();}else if(url.match(/^\/random_search$/)){load_random_search();}else{load_url(url,event);load_user_menu();}
return false;}};window.attach_clicks=function(){$('#content-wrapper').on('touchstart click','.haarp-section-track.haarp-active .haarp-fav-ctrl, .haarp-section-track.haarp-fav-active .haarp-fav-ctrl',function(e){e.preventDefault();toggleFavoriteItem($(this).closest('.haarp-section-track').index('.haarp-section-track'));return false;}).on('touchstart click','.haarp-section-track:not(.haarp-active):not(.haarp-fav-active) .haarp-fav-ctrl',function(e){e.preventDefault();toggleFavoriteItem($(this).closest('.haarp-section-track').index('.haarp-section-track'),true);return false;}).on('touchstart click','.haarp-section-track .haarp-playlist-ctrl:not(.active)',function(e){e.preventDefault();setPlaylist($(this).closest('.haarp-section-track').index('.haarp-section-track'),this);return false;}).on('touchstart click','.haarp-section-track .haarp-playlist-ctrl.active',function(e){e.preventDefault();removePlaylist($(this).closest('.haarp-section-track').index('.haarp-section-track'),this);return false;}).on('touchstart click','.haarp-section-track.haarp-active.haarp-play-ctrl, .haarp-section-track.haarp-active .haarp-play-ctrl',function(e){e.preventDefault();togglePlay();return false;}).on('touchstart click','.haarp-section-track:not(.haarp-active).haarp-play-ctrl, .haarp-section-track:not(.haarp-active) .haarp-play-ctrl',function(e){if(!is_hypem()&&ua_info.is_mobile){if(typeof $(this).attr('data-href')!='undefined'){load_url($(this).attr('data-href'));}}else if(ua_info.is_mobile&&typeof(e.currentTarget.href)!=="undefined"&&e.currentTarget.href.match(/(youtube|vimeo|mixcloud)/i)){return true;}else if(ua_info.is_mobile&&typeof(e.target.href)!=="undefined"&&e.target.href.match(/(youtube|vimeo|mixcloud)/i)){return true;}else{e.preventDefault();e.stopPropagation();loadAndPlay($(this).closest('.haarp-section-track').index('.haarp-section-track'),e);return false;}}).on('touchstart click','.other-link',function(e){e.preventDefault();if(typeof $(this).attr('data-href')!='undefined'){load_url($(this).attr('data-href'));}
return false;}).on('click','.toggle-reposts',function(){toggle_item_activity('reposts',$(this).closest('.haarp-section-track'),0,20);return false;}).on('click','.toggle-favorites',function(){toggle_item_activity('favorites',$(this).closest('.haarp-section-track'),0,20);return false;}).on('click','.close-this',function(){$(this).closest('.act_info').slideUp('300');return false;});$('#header, #player-container, #content-wrapper').on('click','.fire-share-modal',fire_share_modal);if(ua_info.is_mobile){$('#content-wrapper').on('click','.section-track, a.thumb',function(e){e.preventDefault();e.stopPropagation();if(typeof $(this).attr('data-itemid')=='undefined'){loadAndPlayByItemid($(this).closest('.section-track').attr('data-itemid'));}else{loadAndPlayByItemid($(this).attr('data-itemid'));}
return false;});}
$('body').on('click','#close-keyboard-shortcuts, #keyboard .overlay',function(){window.toggleShowKeyboardShortcuts();});$('#header, #content-wrapper').on('focus','input[type=text].clear-on-click',function(){$(this).val('');}).on('blur','input[type=text].clear-on-click',function(){var el=$(this);if(el.val()==''){el.val(el.attr('title'));}});$('body').on('click','#tsdAd_0.tsdAd_',function(e){e.stopPropagation();_tsdAds.dismiss(0);});$('body').on('click','#adLib_0.Ad-Overlay',function(e){e.stopPropagation();_adLib.act.dismissAd(0);});$('#header, #player-container, #content-wrapper, #footer').on('click','a:not(.fancybox)',handle_click);};window.attach_clicks_player_bar=function(){$('#player-controls').off('click');$('#playerNext').on('click',nextTrack);$('#playerPrev').on('click',prevTrack);$('#playerPlay').on('click',togglePlay);$('#playerFav').on('click',toggleFavoriteItem);};window.setup_inplace_edit=function(){$('.playlist-name-editable').editable('/inc/user_action',{type:'text',cancel:'Cancel',submit:'Save',submitdata:{act:"rename_playlist"},indicator:'<img src="/images/ajax-loader-directory.gif">',tooltip:'Click to edit...',style:'inherit',onblur:'ignore',width:'175px',height:'26px',maxlength:'12',callback:function(value,settings){$('#nav-playlist-'+displayList.playlist_id+' a').html(value);}});};window.animate_page_elements=function(){if(displayList.page_name=="stack"){$('svg g#Layer_2 #g0, svg g#Layer_2 #gtext').each(function(i,el){$(el).animate({svgTransform:'translate(0, 24)'},500);});setTimeout(function(){$('svg g#Layer_2 #g0, svg g#Layer_2 #g1, svg g#Layer_2 #gtext').each(function(i,el){$(el).animate({svgTransform:'translate(0, 12)'},500);});},500);setTimeout(function(){$('svg g#Layer_2 g').each(function(i,el){$(el).animate({svgTransform:'translate(0, 0)'},500);});},1000);}}
window.install_ad_waypoints=function(context){if(!is_hypem()){return false;}
if(typeof(Waypoint)!=="undefined"){Waypoint.destroyAll();}
if(context=="initial"){}else{}}
window.load_video_player=function(id,video_id,start_sec){if(id.match(/yt_/)){if(typeof(start_sec)=="undefined"){start_sec=0;}
player=load_youtube_player(id,start_sec);player['type']='youtube';return player;}else if(id.match(/vm_/)){player=load_vimeo_player(id);player['type']='vimeo';return player;}else if(id.match(/mc_/)){player=load_mixcloud_player(id,video_id);player['type']='mixcloud';return player;}else{cosole.log("UNSUPPORTED VIDEO TYPE "+id);}}
window.load_youtube_player=function(id,start_sec){elt_id='player-'+id;var w,h;w=530;h=314;if(typeof window.yt_player==='object'){yt_player.loadVideoById({'videoId':id.replace(/yt_/,''),'startSeconds':start_sec});$('iframe#yt-container').show();}else{window.yt_player=new YT.Player('yt-container',{width:w,height:h,videoId:id.replace(/yt_/,''),events:{'onReady':function(){},'onStateChange':on_youtube_state_change,'onError':on_youtube_error},playerVars:{start:start_sec,autoplay:1,controls:1,disablekb:1,enablejsapi:1,iv_load_policy:3,modestbranding:1,playsinline:1,origin:'*'}});$('iframe#yt-container').show();}
return{};}
window.unload_iframe_players=function(){if(typeof window.yt_player==='object'){yt_player.stopVideo();}
$('iframe#yt-container').hide();}
window.on_youtube_state_change=function(event){if(event.data==YT.PlayerState.PLAYING){hide_loading();playerStatus="PLAYING";setPlaying();}else if(event.data==YT.PlayerState.PAUSED){playerStatus='PAUSED';setPlaying(false);document.title=document.title.replace(/\u25BA/,'\u25FC');}else if(event.data==YT.PlayerState.ENDED){nextTrack();}}
window.on_youtube_error=function(event){if(event.data>2){}}
window.load_vimeo_player=function(id){elt_id='player-'+id;var w,h;w=728;h=441;if(displayList['url'].match(/(zeitgeist\/2015\/videos|zeitgeist\/2016\/videos|popular)/)){w=728;h=441;}
else if(displayList['url'].match(/(zeitgeist\/2017\/videos)/)){w=770;h=450;}
else if(displayList['url'].match(/(zeitgeist\/2017)/)){w=500;h=280;}
else if(displayList['url'].match(/(multisource|channel)/)){w=610;h=305;}
else{w=440;h=261;}
var player=$('<iframe>',{'class':'video-container','id':'player-'+id,'src':'https://player.vimeo.com/video/'+id.replace(/vm_/i,'')+'?api=1&autoplay=1&byline=0&portrait=0&title=0&player_id=player-'+id,'height':h,'width':w,'frameborder':0,'scrolling':'no','webkitallowfullscreen':1,'mozallowfullscreen':1,'allowfullscreen':1,'allow':"autoplay"});$('#'+elt_id).replaceWith(player);$('#'+elt_id).siblings('.section-player').children('.rank,.thumb_video').hide();return player;}
window.on_vimeo_message=function(event){if(!(/^https?:\/\/player.vimeo.com/).test(event.origin)){return false;}
var data=JSON.parse(event.data);switch(data.event){case'ready':on_vimeo_ready();break;case'play':hide_loading();playerStatus="PLAYING";setPlaying();break;case'pause':playerStatus='PAUSED';setPlaying(false);document.title=document.title.replace(/\u25BA/,'\u25FC');break;case'playProgress':break;case'finish':nextTrack();break;}}
window.vimeo_post=function(action,value){var playerOrigin='*';var data={method:action};if(value){data.value=value;}
var message=JSON.stringify(data);$('iframe.video-container')[0].contentWindow.postMessage(data,playerOrigin);}
function on_vimeo_ready(){vimeo_post('addEventListener','play');vimeo_post('addEventListener','pause');vimeo_post('addEventListener','playProgress');vimeo_post('addEventListener','finish');}
if(window.addEventListener){window.addEventListener('message',on_vimeo_message,false);}else{window.attachEvent('onmessage',on_vimeo_message,false);}
window.mixcloud_pause=function(){playerStatus='PAUSED';setPlaying(false);document.title=document.title.replace(/\u25BA/,'\u25FC');}
window.mixcloud_play=function(){playerStatus="PLAYING";setPlaying(true);}
window.mixcloud_progress=function(){}
window.mixcloud_ended=function(){nextTrack();}
window.mixcloud_error=function(){nextTrack();}
window.load_mixcloud_player=function(id,video_id){elt_id='player-'+id;var w,h;w=600;h=120;var player_iframe=$('<iframe>',{'class':'video-container','id':elt_id,'src':'https://www.mixcloud.com/widget/iframe/?hide_cover=1&hide_artwork=1&autoplay=1&light=1&feed='+video_id,'height':h,'width':w,'frameborder':0,'scrolling':'no','allow':"autoplay"});$('#'+elt_id).replaceWith(player_iframe);$('#'+elt_id).siblings('.section-player').children('.rank,.thumb_video').hide();var player=Mixcloud.PlayerWidget(document.getElementById(elt_id));player.ready.then(function(data){player.events.play.on(mixcloud_play);player.events.pause.on(mixcloud_pause);player.events.progress.on(mixcloud_progress);player.events.ended.on(mixcloud_ended);player.events.error.on(mixcloud_error);player.hide_cover=true;player.hide_artwork=true;player.light=true;if(typeof(mixcloud_load_timeout)!=="undefined"){window.clearTimeout(mixcloud_load_timeout);}
hide_loading();});mixcloud_load_timeout=window.setTimeout(function(){stopTrack();unload_iframe_players();nextTrack();},3000);return player;}
window.show_loading=function(delay){if(typeof(show_loading_timeout)!=="undefined"&&show_loading_timeout!==false){return false;}
if(typeof(delay)==="undefined"){delay=1000;}else if(delay===0||delay<500){$('#player-loading').show();return true;}
show_loading_timeout=setTimeout(function(){$('#player-loading').show();},delay);}
window.hide_loading=function(){window.clearTimeout(show_loading_timeout);show_loading_timeout=false;$('#player-loading').hide();}
window.init_visibility_check=function(){var hidden,visibilityState,visibilityChange;if(typeof document.hidden!=="undefined"){hidden="hidden",visibilityChange="visibilitychange",visibilityState="visibilityState";}else if(typeof document.msHidden!=="undefined"){hidden="msHidden",visibilityChange="msvisibilitychange",visibilityState="msVisibilityState";}
var document_hidden=document[hidden];document.addEventListener(visibilityChange,function(){if(document_hidden!=document[hidden]){if(document[hidden]){window_hidden=true;}else{window_hidden=false;if(redraw_ads_on_show){redraw_ads_on_show=false;redraw_ads();}}
document_hidden=document[hidden];}});}
window.is_element_top_in_viewport=function(elt){if(typeof jQuery==="function"&&elt instanceof jQuery){elt=elt[0];}
var rect=elt.getBoundingClientRect();return(rect.top>=0&&rect.top<$(window).height());}
window.cooler_websocket_connect=function(){websocket_conn=new WebSocket('wss://cooler.cloud/magic/');websocket_conn.onopen=function(e){var msg={'cmd':'register','session_id':get_visitorid()}
websocket_conn.send(JSON.stringify(msg));};websocket_conn.onclose=function(e){if(window.websocket_reconnect_timeout!=0){return;}
window.websocket_reconnect_timeout=setTimeout(function(){window.websocket_reconnect_timeout=0;window.cooler_websocket_connect();},5000);}
websocket_conn.onmessage=function(e){var msg=JSON.parse(e.data);if(!msg){return false;}
if(msg.cmd=="message"){if(displayList.filter=="reaction"&&typeof(msg.args.items[0].reactions_grouped)!="undefined"&&typeof(msg.args.items[0].reactions_grouped[displayList.reaction])=="undefined"){return;}
if(displayList.filter=="albums"&&typeof(msg.args.items[0].part_of_set)=="undefined"){return;}
if((displayList.filter=="tracks"||displayList.filter=="mixes")&&typeof(msg.args.items[0].part_of_set)!="undefined"){return;}
if(displayList.filter=="mixes"&&msg.args.items[0].time<1200){return;}
$(".picks-list").prepend(msg.args.markup);new_playlist=msg.args.items.concat(window.displayList.tracks);window.displayList.tracks=new_playlist;if(activeList==get_current_rel_url()&&typeof playList!=='undefined'&&!playList.gc){window.playList=jQuery.extend(true,{},window.displayList);}
if(currentTrack>0){currentTrack+=msg.args.items.length;}
}else if(msg.cmd=="remove"){$("div[data-event-time='"+msg.args.event_time+"']").remove();for(var i=0;typeof(window.displayList.tracks[i])!='undefined';i++){if(window.displayList['tracks'][i].event_time==msg.args.event_time){if(currentTrack==i&&playerStatus=="PLAYING"){}
if(currentTrack>i){currentTrack--;}
window.displayList['tracks'].splice(i,1);}}
if(activeList==get_current_rel_url()&&typeof playList!=='undefined'&&!playList.gc){window.playList=jQuery.extend(true,{},window.displayList);}}};};})(jQuery);