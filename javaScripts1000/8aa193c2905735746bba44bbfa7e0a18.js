var EasyRedmineHelper=EasyRedmineHelper||{};EasyRedmineHelper.root='';EasyRedmineHelper.lang='';EasyRedmineHelper.form_token='';EasyRedmineHelper.Demo=EasyRedmineHelper.Demo||{};EasyRedmineHelper.Pricing=EasyRedmineHelper.Pricing||{};EasyRedmineHelper.RsForm=EasyRedmineHelper.RsForm||{};EasyRedmineHelper.Demo.displayed_parent_domain='';EasyRedmineHelper.Pricing.protected_domains=["es","devel","devel2","staging","www","documentation","demo","develweb"];EasyRedmineHelper.recaptcha_site_key=EasyRedmineHelper.recaptcha_site_key||'';EasyRedmineHelper.demo_microservice_root=EasyRedmineHelper.demo_microservice_root||'';EasyRedmineHelper.demo_redirect_url=EasyRedmineHelper.demo_redirect_url||'';EasyRedmineHelper.Demo.findDomainByEmail=function(email_field){email_field=jQuery(email_field);var email=email_field.val();if(email==''){return;}var url=EasyRedmineHelper.root+'index.php?option=com_easyredminehelper&task=demo.find_domain_for_email&email='+encodeURIComponent(email);if(EasyRedmineHelper.lang!=''){url=url+'&lang='+EasyRedmineHelper.lang;}var control_group=email_field.closest('.control-group');var label=control_group.find('label');var button=control_group.closest('form').find('.demo_form_submit_btn');var msg_container=control_group.find('.msg-container');if(msg_container.length==0){msg_container=jQuery('<div class="msg-container help-block"/>');var email_span=control_group.find('.email-span');if(email_span.length==0){email_field.after(msg_container);}else{email_span.append(msg_container);}}jQuery.ajax({url:url,beforeSend:function(){control_group.removeClass('error').removeClass('success').addClass('info');var msg=Joomla.JText._('COM_EASYREDMINEHELPER_MSG_VERIFYING_DEMO_EMAIL');msg_container.html('<div class="text-info pull-left">'+msg+'</div>');label.removeClass('invalid').attr('aria-invalid','false');if(button){button.prop('disabled',true);button.addClass('disabled').removeClass('btn-danger');}},success:function(responseText){if(/^EMAIL_HAS_DOMAIN:/.test(responseText)){var domain=responseText.substring(17);control_group.addClass('error').removeClass('success').removeClass('info');var msg=Joomla.JText._('COM_EASYREDMINEHELPER_MSG_EMAIL_HAS_DOMAIN').split('\\').join('').replace(new RegExp(/%[0-9]\$s/,'g'),domain);msg_container.html('<div class="text-error pull-left">'+msg+'</div>');label.addClass('invalid').attr('aria-invalid','true');if(button){button.prop('disabled',true);button.addClass('disabled').addClass('btn-danger');}}else{control_group.removeClass('error').addClass('success').removeClass('info');msg_container.html('');label.removeClass('invalid').attr('aria-invalid','false');if(button){button.prop('disabled',false);button.removeClass('disabled').removeClass('btn-danger');}}},error:function(xhr,error_type,error_text){var msg=Joomla.JText._('COM_EASYREDMINEHELPER_MSG_DEMO_AJAX_ERROR_TRY_AGAIN_LATER').split('\\').join('');msg_container.html('<div class="text-error pull-left">'+msg+'</div>');label.addClass('invalid').attr('aria-invalid','true');if(button){button.prop('disabled',true);button.addClass('disabled').addClass('btn-danger');}}});};EasyRedmineHelper.Demo.checkAvailability=function(){var form_id='#jform';var domain=jQuery(form_id+'_domain');var domain_label=jQuery(form_id+'_domain-lbl');var domain_msg=jQuery(form_id+'_domain_msg');var button=jQuery('.demo_form_submit_btn');domain.val(jQuery('<div>').text(domain.val().replace(/\s/g,"")).html());if(domain&&domain_label&&domain.val()!=''){var url=EasyRedmineHelper.root+'index.php?option=com_easyredminehelper&task=demo.check_availability&domain='+domain.val();var id=jQuery(form_id+'_id');if(id.val()!=undefined){url=url+'&id='+id.val();}if(EasyRedmineHelper.lang!=''){url=url+'&lang='+EasyRedmineHelper.lang;}jQuery.ajax({url:url,beforeSend:function(){domain.closest('.control-group').removeClass('error').removeClass('success').addClass('info');var msg=Joomla.JText._('COM_EASYREDMINEHELPER_MSG_CHECKING_DOMAIN_AVAILABILITY').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);domain_msg.html('<div class="text-info pull-left">'+msg+'</div>');if(button){button.prop('disabled',true);button.addClass('disabled').removeClass('btn-danger');}},success:function(responseText){responseText=responseText.trim();if(responseText=='INVALID'){domain.closest('.control-group').addClass('error').removeClass('success').removeClass('info');domain.addClass('invalid');domain.attr('aria-invalid','true');domain_label.addClass('invalid');domain_label.attr('aria-invalid','true');var msg=Joomla.JText._('COM_EASYREDMINEHELPER_MSG_DOMAIN_INVALID').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);domain_msg.html('<div class="text-error pull-left">'+msg+'</div>');if(button){button.prop('disabled',true);button.addClass('disabled').addClass('btn-danger');}}else{if(responseText=='OK'){domain.closest('.control-group').removeClass('error').addClass('success').removeClass('info');domain.removeClass('invalid');domain.attr('aria-invalid','false');domain_label.removeClass('invalid');domain_label.attr('aria-invalid','false');var msg=Joomla.JText._('COM_EASYREDMINEHELPER_MSG_DOMAIN_AVAILABLE').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);domain_msg.html('<div class="text-success pull-left">'+msg+'</div>');if(button){button.prop('disabled',false);button.removeClass('disabled').removeClass('btn-danger');}}else{var msg=Joomla.JText._('COM_EASYREDMINEHELPER_MSG_DOMAIN_NOT_AVAILABLE').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);domain.closest('.control-group').addClass('error').removeClass('success').removeClass('info');domain.addClass('invalid');domain.attr('aria-invalid','true');domain_label.addClass('invalid');domain_label.attr('aria-invalid','true');domain_msg.html('<div class="text-error pull-left">'+msg+'</div>');if(button){button.prop('disabled',true);button.addClass('disabled').addClass('btn-danger');}}}},error:function(xhr,error_type,error_text){domain.closest('.control-group').addClass('error').removeClass('success').removeClass('info');domain.addClass('invalid');domain.attr('aria-invalid','true');domain_label.addClass('invalid');domain_label.attr('aria-invalid','true');var msg=Joomla.JText._('COM_EASYREDMINEHELPER_MSG_DEMO_AJAX_ERROR_TRY_AGAIN_LATER').split('\\').join('');domain_msg.html('<div class="text-error pull-left">'+msg+'</div>');if(button){button.prop('disabled',true);button.addClass('disabled').addClass('btn-danger');}}});}};EasyRedmineHelper.Pricing.checkAvailability=(function(mydom){var domain=jQuery("#domain");var domain_label=jQuery('.domain-append');var domain_msg=jQuery('.domain-msg');var button=jQuery('.rsform-submit-button');domain.val(jQuery('<div>').text(domain.val().replace(/\s/g,"")).html());if((mydom)&&(mydom==domain.val())){var msg=Joomla.JText._('COM_EASYREDMINEHELPER_PRICING_MSG_THIS_IS_YOUR_DOMAIN').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);jQuery("#domain_new").val("0");domain_msg.html('<div class="text-success">'+msg+'</div>');}else{if(domain&&domain_label&&domain.val()!=''){var url=EasyRedmineHelper.root+'index.php?option=com_easyredminehelper&task=demo.check_availability&domain='+domain.val();var id=jQuery('.domain_id');if(id.val()!=undefined){url=url+'&id='+id.val();}if(EasyRedmineHelper.lang!=''){url=url+'&lang='+EasyRedmineHelper.lang;}jQuery.ajax({url:url,beforeSend:function(){domain.closest('.input-domain').removeClass('error').removeClass('warning').removeClass('success').addClass('info');var msg=Joomla.JText._('COM_EASYREDMINEHELPER_PRICING_MSG_CHECKING_DOMAIN_AVAILABILITY').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);jQuery("#domain_new").val("0");domain_msg.html('<div class="text-info">'+msg+'</div>');if(button){button.prop('disabled',true);button.addClass('disabled').removeClass('btn-danger');}},success:function(responseText){responseText=responseText.trim();if(responseText=='INVALID'){domain.closest('.input-domain').addClass('error').removeClass('warning').removeClass('success').removeClass('info');domain.addClass('invalid');domain.attr('aria-invalid','true');domain_label.addClass('invalid');domain_label.attr('aria-invalid','true');if(mydom){var msg=Joomla.JText._('COM_EASYREDMINEHELPER_PRICING_MSG_DOMAIN_INVALID_LOGGED').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);}else{var msg=Joomla.JText._('COM_EASYREDMINEHELPER_PRICING_MSG_DOMAIN_INVALID').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);}domain_msg.html('<div class="text-error">'+msg+'</div>');if(button){button.prop('disabled',true);button.addClass('disabled').addClass('btn-danger');}}else{if(jQuery.inArray(domain.val().toLowerCase(),EasyRedmineHelper.Pricing.protected_domains)==-1){if(responseText=='OK'){domain.closest('.input-domain').removeClass('error').removeClass('warning').addClass('success').removeClass('info');domain.removeClass('invalid');domain.attr('aria-invalid','false');domain_label.removeClass('invalid');domain_label.attr('aria-invalid','false');if(mydom){var msg=Joomla.JText._('COM_EASYREDMINEHELPER_PRICING_MSG_DOMAIN_AVAILABLE_LOGGED').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);}else{var msg=Joomla.JText._('COM_EASYREDMINEHELPER_PRICING_MSG_DOMAIN_AVAILABLE').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);}jQuery("#domain_new").val("1");domain_msg.html('<div class="text-success">'+msg+'</div>');if(button){button.prop('disabled',false);button.removeClass('disabled').removeClass('btn-danger');}}else{domain.closest('.input-domain').removeClass('error').addClass('warning').removeClass('success').removeClass('info');domain.removeClass('invalid');domain.attr('aria-invalid','false');domain_label.removeClass('invalid');domain_label.attr('aria-invalid','false');if(mydom){var msg=Joomla.JText._('COM_EASYREDMINEHELPER_PRICING_MSG_CLIENT_DOMAIN_LOGGED').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);}else{var msg=Joomla.JText._('COM_EASYREDMINEHELPER_PRICING_MSG_CLIENT_DOMAIN').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);}domain_msg.html('<div class="text-warning">'+msg+'</div>');if(button){button.prop('disabled',false);button.removeClass('disabled').removeClass('btn-danger');}}}else{domain.closest('.input-domain').addClass('error').removeClass('warning').removeClass('success').removeClass('info');domain.addClass('invalid');domain.attr('aria-invalid','true');domain_label.addClass('invalid');domain_label.attr('aria-invalid','true');if(mydom){var msg=Joomla.JText._('COM_EASYREDMINEHELPER_PRICING_MSG_DOMAIN_NOT_AVAILABLE_LOGGED').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);}else{var msg=Joomla.JText._('COM_EASYREDMINEHELPER_PRICING_MSG_DOMAIN_NOT_AVAILABLE').replace('%s',domain.val()+EasyRedmineHelper.Demo.displayed_parent_domain);}domain_msg.html('<div class="text-error">'+msg+'</div>');if(button){button.prop('disabled',true);button.addClass('disabled').addClass('btn-danger');}}}},error:function(xhr,error_type,error_text){domain.closest('.input-domain').addClass('error').removeClass('warning').removeClass('success').removeClass('info');domain.addClass('invalid');domain.attr('aria-invalid','true');domain_label.addClass('invalid');domain_label.attr('aria-invalid','true');var msg=Joomla.JText._('COM_EASYREDMINEHELPER_PRICING_MSG_DEMO_AJAX_ERROR_TRY_AGAIN_LATER').split('\\').join('');domain_msg.html('<div class="text-error">'+msg+'</div>');if(button){button.prop('disabled',true);button.addClass('disabled').addClass('btn-danger');}}});}}});EasyRedmineHelper.Demo.submit=function(form){event.preventDefault();form=jQuery(form);var button=form.find('button');button.prop('disabled',true);button.addClass('disabled');var i=button.find('i');if(i){i.removeClass();i.addClass('icon-refresh').addClass('icon-spin');}if(EasyRedmineHelper.demo_microservice_root!=''){window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:'virtualPageView',virtualPagePath:EasyRedmineHelper.demo_redirect_url,virtualPageTitle:EasyRedmineHelper.demo_redirect_url});}if(EasyRedmineHelper.recaptcha_site_key!=''){grecaptcha.ready(function(){grecaptcha.execute(EasyRedmineHelper.recaptcha_site_key,{action:'demo_form'}).then(function(token){form.append('<input type="hidden" name="recaptcha_token" value="'+token+'" />');form.submit();});});}else{form.submit();}};EasyRedmineHelper.Demo.submit_social=function(type){var e=document.getElementById("jform_email");var f=document.getElementById('demo_form');var a=document.getElementById("auth_provider");var msg=[];e.classList.remove("required");e.removeAttribute("required");type=type||a.value;a.value=type;if(jQuery('#email-control-group').hasClass('info')){setTimeout(EasyRedmineHelper.Demo.submit_social(type),100);return false;}var domain_field=jQuery('#jform_domain');if(domain_field.length){if((domain_field.hasClass('invalid'))&&(document.formvalidator.isValid(f))){msg.push(jQuery("#jform_domain_msg").text());}if(!document.formvalidator.isValid(f)){msg.push("<div class='text-error pull-left'>Invalid input, please verify again.</div>");if(domain_field.hasClass('invalid')){msg.push("<div class='text-error pull-left'>Trial Domain is required.</div>");}}if(msg.length>0){e.className+=" required";e.setAttribute("required","required");a.value="";jQuery("#jform_domain_msg").html(msg.join(''));EasyRedmineHelper.Demo.checkAvailability();}else{EasyRedmineHelper.Demo.submit(f);}}else{EasyRedmineHelper.Demo.submit(f);}};EasyRedmineHelper.Demo.ajaxFill=function(){var url=EasyRedmineHelper.root+'index.php?option=com_easyredminehelper&task=demo.get_form_data';var jform_params=document.URL.match(/jform\[[^\]]+\]=([^&]+)/g);if(jform_params&&jform_params.length){jQuery.each(jform_params,function(i,jform_param){url=url+'&'+jform_param;});}jQuery.ajax({url:url,success:function(data){jQuery.each(data,function(key,value){if(value!=''){var input=jQuery('#jform_'+key);if(typeof(input)!=='undefined'&&input.val()==''){if(input.attr('id')=='jform_phone'&&input.closest('form').hasClass('auto-phone-prefix')){EasyRedmineHelper.onFunctionAvailable('jQuery().intlTelInput',function(){input.intlTelInput("setNumber",value);});}else{input.val(value);}}}});}});};EasyRedmineHelper.Demo.process=function(id_demo_queue){jQuery.ajax({url:EasyRedmineHelper.root+'index.php?option=com_easyredminehelper&task=demo.ajax_process&id='+id_demo_queue});};EasyRedmineHelper.RsForm.process=function(id_rsform_submission){jQuery.ajax({url:EasyRedmineHelper.root+'index.php?option=com_easyredminehelper&task=rsform.ajax_process&id='+id_rsform_submission});};EasyRedmineHelper.autocomplete_timer=0;EasyRedmineHelper.autocomplete_ajax=0;EasyRedmineHelper.knowledgeAutoComplete=function(input){var el=jQuery(input);var div_id=el.attr('id')+'_autocomplete';el.after('<div id="'+div_id+'" class="alert alert-info small autocomplete-results" style="width: '+(el.closest('div').width()-20)+'px;"></div>');el.on('keypress',function(e){if(e.keyCode==27||e.keyCode==13){if(EasyRedmineHelper.autocomplete_ajax){EasyRedmineHelper.autocomplete_ajax.abort();}jQuery('#'+el.attr('id')+'_autocomplete_loading').remove();jQuery('#'+el.attr('id')+'_autocomplete').hide();return;}if(!EasyRedmineHelper.isProperKeyPress(e)){return;}if(EasyRedmineHelper.autocomplete_timer){clearTimeout(EasyRedmineHelper.autocomplete_timer);}EasyRedmineHelper.autocomplete_timer=setTimeout(function(){if(EasyRedmineHelper.autocomplete_ajax){EasyRedmineHelper.autocomplete_ajax.abort();}EasyRedmineHelper.autocomplete_ajax=jQuery.ajax({type:"GET",url:EasyRedmineHelper.root+'index.php?option=com_easyredminehelper&task=helpdesk_form.knowledge_autocomplete&keyword='+el.val(),beforeSend:function(){el.after('<i id="'+el.attr('id')+'_autocomplete_loading" class="icon-refresh icon-spin autocomplete-input-icon"></i>');},success:function(data){var div=jQuery('#'+el.attr('id')+'_autocomplete');if(data['posts'].length||data['articles'].length){var html='<a id="'+div.attr('id')+'_close" href="javascript:void(0);" class="btn btn-small pull-right"><i class="icon-remove" style="margin:0;"></i></a>';if(data['posts'].length){html+='<p><i class="icon-lightbulb"></i>'+Joomla.JText._('COM_EASYREDMINEHELPER_TIP_KB_POSTS')+'</p>';html+='<div><ul>';jQuery.each(data['posts'],function(i,result){html+='<li><a target="_blank" href="'+result.link+'">'+result.title+'</a></li>';});html+='</ul></div>';}if(data['articles'].length){html+='<p><i class="icon-pencil"></i>'+Joomla.JText._('COM_EASYREDMINEHELPER_TIP_ARTICLES')+'</p>';html+='<div><ul>';jQuery.each(data['articles'],function(i,result){html+='<li><a target="_blank" href="'+result.link+'">'+result.title+'</a></li>';});html+='</ul></div>';}div.html(html);jQuery('#'+div_id+'_close').on('click',function(e){e.preventDefault();var target=jQuery(e.target);if(target.is('a')){var d_id=jQuery(e.target).attr('id').replace('_close','');}else{var d_id=jQuery(e.target).closest('a').attr('id').replace('_close','');}jQuery('#'+d_id).hide();jQuery('#'+d_id+'_loading').remove();if(EasyRedmineHelper.autocomplete_ajax){EasyRedmineHelper.autocomplete_ajax.abort();}});div.show();jQuery('html').bind('click',function(e){var obj=jQuery(e.target?e.target:e.srcElement);if(obj.closest('#'+el.attr('id')+'_autocomplete').length===0&&obj.attr('id')!=el.attr('id')){div.hide();jQuery('html').unbind('click');el.bind('click',function(){div.show();jQuery('html').bind('click',function(e){var obj=jQuery(e.target?e.target:e.srcElement);if(obj.closest('#'+el.attr('id')+'_autocomplete').length===0&&obj.attr('id')!=el.attr('id')){div.hide();jQuery('html').unbind('click');}});});}});}else{div.html('');div.hide();}},complete:function(){jQuery('#'+el.attr('id')+'_autocomplete_loading').remove();}});},500)});};EasyRedmineHelper.isProperKeyPress=function(e){return((((e.which>=32)&&!(e.which>=63232&&e.which<=63247)&&!(e.which==63273)&&!(e.which>=63275&&e.which<=63277)&&!(e.which===e.keyCode&&(e.which==35||e.which==36||e.which==45||e.which==46||e.which==144)))||e.which===undefined)&&e.charCode!==0);};EasyRedmineHelper.vat_timer=0;EasyRedmineHelper.vat_validation_result_default={valid:false,vat_id:'',country:'',error:null};EasyRedmineHelper.vat_validation_result=JSON.parse(JSON.stringify(EasyRedmineHelper.vat_validation_result_default));EasyRedmineHelper.vat_validation_ajax=0;EasyRedmineHelper.validateVatId=function(vat_input,country_input,zip_input,is_onload){var is_onload=is_onload||false;var zip_input=zip_input||null;if(EasyRedmineHelper.vat_validation_ajax){EasyRedmineHelper.vat_validation_ajax.abort();}if(jQuery(vat_input).val()==''||jQuery(country_input).val()==''){EasyRedmineHelper.vat_validation_result=JSON.parse(JSON.stringify(EasyRedmineHelper.vat_validation_result_default));jQuery(vat_input).removeClass('invalid');jQuery(country_input).removeClass('invalid');jQuery('#'+jQuery(vat_input).attr('id')+'_validating').remove();jQuery('.'+jQuery(vat_input).attr('id')+'_validation_msg').remove();if(is_onload){EasyRedmineHelper.vat_timer=setTimeout(function(){EasyRedmineHelper.validateVatId(vat_input,country_input,zip_input);},500);}return;}var ajax_url=EasyRedmineHelper.root+'index.php?option=com_easyredminehelper&task=client_zone.validate_eu_vat_id&country='+jQuery(country_input).val()+'&vat_id='+jQuery(vat_input).val()+'&'+EasyRedmineHelper.form_token+'=1';if(zip_input){ajax_url+='&zip='+jQuery(zip_input).val();}EasyRedmineHelper.vat_validation_ajax=jQuery.ajax({method:'get',url:ajax_url,beforeSend:function(){var loader='<i style="margin-left: -24px;" class="icon-refresh icon-spin '+jQuery(vat_input).attr('id')+'_validating" title="'+Joomla.JText._('COM_EASYREDMINEHELPER_MSG_VALIDATING_VAT_ID')+'"></i>';jQuery(vat_input).after(loader);jQuery(zip_input).after(loader);jQuery(country_input).after(loader.replace('-24px','-42px'));EasyRedmineHelper.vat_validation_result=JSON.parse(JSON.stringify(EasyRedmineHelper.vat_validation_result_default));jQuery('.'+jQuery(vat_input).attr('id')+'_validation_msg').remove();},success:function(data){if(typeof data.result!=='undefined'&&data.result!==null&&typeof data.result.valid!=='undefined'&&data.result.valid===true&&typeof data.result.vatNumber!=='undefined'){EasyRedmineHelper.vat_validation_result={valid:data.result.valid,vat_id:data.result.vatNumber,country:data.result.countryCode,error:null};jQuery(vat_input).removeClass('invalid');jQuery(country_input).removeClass('invalid');if(zip_input){jQuery(zip_input).removeClass('invalid');}jQuery('.'+jQuery(vat_input).attr('id')+'_validation_msg').remove();var msg='<span class="help-inline alert alert-success '+jQuery(vat_input).attr('id')+'_validation_msg">'+Joomla.JText._('COM_EASYREDMINEHELPER_MSG_VALID_VAT_ID').replace('%s',data.result.vatNumber)+'</span>';jQuery(vat_input).after(msg);}else{if(typeof data.result!=='undefined'&&data.result!==null&&typeof data.result.is_eu!=='undefined'&&!data.result.is_eu){EasyRedmineHelper.vat_validation_result=JSON.parse(JSON.stringify(EasyRedmineHelper.vat_validation_result_default));}else if(typeof data.error!=='undefined'&&data.error!==null&&data.error!=''){EasyRedmineHelper.vat_validation_result=JSON.parse(JSON.stringify(EasyRedmineHelper.vat_validation_result_default));EasyRedmineHelper.vat_validation_result.error=data.error;}else if(zip_input&&typeof data.result!=='undefined'&&data.result!==null&&typeof data.result.zip_excluded!=='undefined'&&data.result.zip_excluded){EasyRedmineHelper.vat_validation_result=JSON.parse(JSON.stringify(EasyRedmineHelper.vat_validation_result_default));EasyRedmineHelper.vat_validation_result.error=Joomla.JText._('COM_EASYREDMINEHELPER_MSG_NOT_EU_COUNTRY_ZIP').replace('%1$s',jQuery(country_input).val()).replace('%2$s',jQuery(zip_input).val());EasyRedmineHelper.vat_validation_result.zip_excluded=true;}else{EasyRedmineHelper.vat_validation_result=JSON.parse(JSON.stringify(EasyRedmineHelper.vat_validation_result_default));EasyRedmineHelper.vat_validation_result.error=Joomla.JText._('COM_EASYREDMINEHELPER_MSG_INVALID_VAT_ID_OR_COUNTRY').replace('%1$s',jQuery(vat_input).val()).replace('%2$s',jQuery(country_input).val());}}},complete:function(){jQuery('.'+jQuery(vat_input).attr('id')+'_validating').remove();jQuery(vat_input).removeClass('invalid');jQuery(country_input).removeClass('invalid');if(zip_input){jQuery(zip_input).removeClass('invalid');}if(EasyRedmineHelper.vat_validation_result.error!==null){jQuery('.'+jQuery(vat_input).attr('id')+'_validation_msg').remove();var msg='<span class="help-inline alert alert-error '+jQuery(vat_input).attr('id')+'_validation_msg">'+EasyRedmineHelper.vat_validation_result.error+'</span>';jQuery(country_input).after(msg);jQuery(country_input).addClass('invalid');if(typeof EasyRedmineHelper.vat_validation_result.zip_excluded!=='undefined'&&EasyRedmineHelper.vat_validation_result.zip_excluded){jQuery(zip_input).after(msg);jQuery(zip_input).addClass('invalid');}else{jQuery(vat_input).after(msg);jQuery(vat_input).addClass('invalid');}}if(typeof countFinalPrice=='function'){countFinalPrice();}if(typeof updatePricinPageCart=='function'){updatePricinPageCart();}}});};EasyRedmineHelper.handleVatIdKeypress=function(e,vat_input,country_input,zip_input){var zip_input=zip_input||null;if(e.keyCode==27){if(EasyRedmineHelper.vat_validation_ajax){EasyRedmineHelper.vat_validation_ajax.abort();}return;}if(!EasyRedmineHelper.isProperKeyPress(e)){return;}if(jQuery(vat_input).val().length<6){return;}if(EasyRedmineHelper.vat_timer){clearTimeout(EasyRedmineHelper.vat_timer);}EasyRedmineHelper.vat_timer=setTimeout(function(){EasyRedmineHelper.validateVatId(vat_input,country_input,zip_input);},500);};EasyRedmineHelper.attachVatIdValidator=function(vat_input,country_input,zip_input){var zip_input=zip_input||null;if(zip_input){jQuery(vat_input).on('keypress',function(e){EasyRedmineHelper.handleVatIdKeypress(e,vat_input,country_input,zip_input);});jQuery(vat_input).on('change',function(){EasyRedmineHelper.validateVatId(vat_input,country_input,zip_input);});jQuery(country_input).on('change',function(){EasyRedmineHelper.validateVatId(vat_input,country_input,zip_input);});jQuery(zip_input).on('change',function(){EasyRedmineHelper.validateVatId(vat_input,country_input,zip_input);});}else{jQuery(vat_input).on('keypress',function(e){EasyRedmineHelper.handleVatIdKeypress(e,vat_input,country_input);});jQuery(vat_input).on('change',function(){EasyRedmineHelper.validateVatId(vat_input,country_input);});jQuery(country_input).on('change',function(){EasyRedmineHelper.validateVatId(vat_input,country_input);});}};EasyRedmineHelper.onFunctionAvailable=function(sMethod,oCallback,oObject,bScope){if(typeof(eval(sMethod))==='function'){bScope?oCallback.call(oObject):oCallback(oObject);}else{setTimeout(function(){EasyRedmineHelper.onFunctionAvailable(sMethod,oCallback,oObject,bScope);},50);}};EasyRedmineHelper.isScriptInHead=function(url){url=EasyRedmineHelper.root+url;var scripts=document.getElementsByTagName('script');for(var i=scripts.length;i--;){if(scripts[i].src==url)return true;}return false;};EasyRedmineHelper.attachIntlTelInput=function(input){if(typeof(jQuery(input))==='undefined'){alert('EasyRedmineHelper.attachIntlTelInput: input is undefined');return;}var src_path=EasyRedmineHelper.root+'templates/esw_easypeasy/javascript/intl-tel-input/';var script_url=src_path+'js/intlTelInput.min.js';if(!EasyRedmineHelper.isScriptInHead(script_url)){input=input||'#jform_phone';var oScript=document.createElement('script');oScript.type='text/javascript';oScript.src=script_url;document.head.appendChild(oScript);var css=document.createElement('link');css.setAttribute('rel','stylesheet');css.setAttribute('type','text/css');css.setAttribute('href',src_path+'css/intlTelInput.css');document.head.appendChild(css);}EasyRedmineHelper.onFunctionAvailable('jQuery().intlTelInput',function(){jQuery.fn.intlTelInput.loadUtils(src_path+"js/utils.js");jQuery(input).intlTelInput({preferredCountries:['us','gb','de','fr'],nationalMode:false,utilsScript:src_path+'js/utils.js'});});};