(this.msPlayerJsonp=this.msPlayerJsonp||[]).push([[79],{658:function(e,t,n){"use strict";n.r(t);var r=n(8),a=n.n(r),i=n(0),o=n.n(i),r=n(181),s=n.n(r),i=n(146),l=n.n(i),r=n(2),_=n.n(r),i=n(74),r=(n.n(i),n(76)),i=(n.n(r),n(45)),r=(n.n(i),n(49)),i=(n.n(r),n(81)),u=(n.n(i),n(596)),d=n.n(u),h=n(13),r=n(190),c=n.n(r),i=n(144),r=n.n(i),m=n(152),i=n(145),i=(n.n(i),n(154)),b=n(286),p=n(143),r=(n.n(p),function(n){function e(e){var t=this,s=n.call(this,e)||this;return s._awaitElementLoaded=function(){var n=this;return o()(this,t),new Promise(function(e){var t=this;if(o()(this,n),s._element)return e();setTimeout(function(){o()(this,t),e(s._awaitElementLoaded())}.bind(this),30)}.bind(this))}.bind(this),s._handleEvent=function(a){var i=this;return o()(this,t),function(e){o()(this,i);var t=e.nativeEvent;switch(a!==h.b._play||s._runStartLoad||(s.state._controller.startLoad(),s._runStartLoad=!0),a){case h.b._error:m.b.emit(a,t),s._setBuffering();break;case h.b._timeupdate:s._wasStalled=!1,m.b.emit(a,s.get("currentTime"));break;case h.b._waiting:m.b.emit(a),s._setBuffering();break;case h.b._volumechange:var n=s.get("volume"),r=0===n;r!==s._element.muted&&(s._element.muted=r),m.b.emit(a,n);break;default:clearTimeout(s._pingTimeout),s._pingTimeout=null,m.b.emit(a)}}.bind(this)}.bind(this),d.a.isSupported()||m.b.emit(h.b._error,new b.a("HLS not supported",h.a._mediaError,!0)),s._element=null,s.state=Object.assign(Object.assign({},e,{_controller:null})),s._nativeProps={onCanPlay:s._handleEvent(h.b._canplay),onEnded:s._handleEvent(h.b._ended),onLoadedData:s._handleEvent(h.b._loadeddata),onLoadedMetadata:s._handleEvent(h.b._loadedmetadata),onLoadStart:s._handleEvent(h.b._loadstart),onPause:s._handleEvent(h.b._pause),onPlay:s._handleEvent(h.b._play),onPlaying:s._handleEvent(h.b._playing),onSeeking:s._handleEvent(h.b._seeking),onSeeked:s._handleEvent(h.b._seeked),onTimeUpdate:s._handleEvent(h.b._timeupdate),onAbort:s._handleEvent(h.b._abort),onCanPlayThrough:s._handleEvent(h.b._canplaythrough),onDurationChange:s._handleEvent(h.b._durationchange),onEmptied:s._handleEvent(h.b._emptied),onRateChange:s._handleEvent(h.b._ratechange),onSuspend:s._handleEvent(h.b._suspend),onVolumeChange:s._handleEvent(h.b._volumechange),onWaiting:s._handleEvent(h.b._waiting),poster:e.poster},s}l()(e,n);var t,r=e.prototype;return r._renderVideo=function(){var t=this;return Object(p.jsx)("video",Object.assign({ref:function(e){o()(this,t),this._element=e}.bind(this)},this._nativeProps))},r._renderAudio=function(){var t=this;return Object(p.jsx)("audio",Object.assign({ref:function(e){o()(this,t),this._element=e}.bind(this)},this._nativeProps))},r.render=function(){var e=this.props.playerType;return this.state._controller||this._load(),"audio"===e?this._renderAudio():this._renderVideo()},r._load=(t=a()(_.a.mark(function e(){var t,n,r,a,i,s=this;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d.a.isSupported()){e.next=2;break}return e.abrupt("return");case 2:return this._programDateTime=null,e.next=5,this._awaitElementLoaded();case 5:if(this.state._controller)return e.abrupt("return");e.next=7;break;case 7:t=this._element,n=this.state.src,r=this.props.volume,t.volume=r,t.muted=0===r,this._runStartLoad=!1,a=this.context.mse||{},r=void 0===(r=a.bufferSize)?"audio"===this.props.playerType?2:60:r,r={liveBackBufferLength:0,liveDurationInfinity:!1,debug:!1,capLevelToPlayerSize:!0,autoStartLoad:!1,startPosition:-1,nudgeMaxRetry:10,nudgeOffset:.016,maxBufferSize:1e3*r*1e3,maxBufferLength:a=void 0===(r=a.bufferlength)?30:r,maxMaxBufferLength:10*a,levelLoadingMaxRetryTimeout:4e3,liveSyncDuration:a},a={rangeRequestEnabled:!0},i=new d.a(r,a),this.setState({_controller:i}),this.context.setData("element",t),i.attachMedia(t),i.on(u.Events.MEDIA_ATTACHED,function(){var r=this;o()(this,s),i.startLevel=-1,i.on(u.Events.MANIFEST_PARSED,function(e,t){o()(this,r),m.b.emit(h.c._ready),this._runStartLoad||m.b.emit(h.b._canplay)}.bind(this)),i.on(u.Events.FRAG_LOADED,function(e,t){var n=this;o()(this,r),m.b.emit(h.b._progress),this._wasStalled&&"live"===this.props.type&&(this._wasStalled=!1,i.trigger(d.a.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:this.props.playerType}),i.once(d.a.Events.BUFFER_FLUSHED,function(){o()(this,n),this._programDateTime=null}.bind(this)),i.once(d.a.Events.BUFFER_APPENDED,function(){o()(this,n),this.set("currentTime",0)}.bind(this)))}.bind(this)),i.on(u.Events.FRAG_CHANGED,function(e,t){void 0===t&&(t={}),!r._programDateTime&&r.liveSyncPos&&(t=c()(t,"frag.programDateTime"),t=r._programDateTime=t?new Date(t-r.get("currentTime")):new Date((new Date).valueOf()-1e3*r.liveSyncPos),m.b.emit(h.b._programdatetime,new Date(t)))}),i.on(u.Events.LEVEL_LOADED,function(e,t){void 0===t&&(t={}),r._stalled&&(r._wasStalled=!0),r._stalled=!1,r._programDateTime||(t=r._programDateTime=c()(t,"details.fragments[0].rawProgramDateTime",c()(t,"details.programDateTime"),!1))&&m.b.emit(h.b._programdatetime,new Date(t))}),i.on(u.Events.ERROR,function(e,t){if((t=void 0===t?{}:t).fatal)switch(t.type){case d.a.ErrorTypes.NETWORK_ERROR:t.details===d.a.ErrorDetails.MANIFEST_LOAD_TIMEOUT?(m.b.emit(h.b._error,new b.a(t.details,h.a._networkError,!0)),r.state._controller&&(r.state._controller.destroy(),r.setState({_controller:null}))):(i.startLoad(),m.b.emit(h.b._error,new b.a(t.details,h.a._networkError)));break;case d.a.ErrorTypes.MEDIA_ERROR:i.recoverMediaError(),m.b.emit(h.b._error,new b.a(t.details,h.a._mediaError));break;default:r.state._controller&&(m.b.emit(h.b._error,new b.a(t.details,h.a._other,!0)),r.state._controller.destroy(),r.setState({_controller:null})),r._setBuffering(),m.b.emit(h.b._error,new b.a(t.details,h.a._other))}else switch(t.details){case d.a.ErrorDetails.LEVEL_LOAD_ERROR:case d.a.ErrorDetails.BUFFER_STALLED_ERROR:m.b.emit(h.b._error,new b.a(t.details,h.a._mediaError)),r._stalled||(r._stalled=!0,m.b.emit(h.b._stalled));break;case d.a.ErrorDetails.BUFFER_ADD_CODEC_ERROR:case d.a.ErrorDetails.INTERNAL_EXCEPTION:r._setBuffering(),m.b.emit(h.b._error,new b.a(t.details,h.a._other))}}),i.loadSource(n),m.b.emit(h.c._playerLoaded)}.bind(this));case 21:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)}),r.play=function(){return this._runStartLoad||(this.state._controller.startLoad(),this._runStartLoad=!0),this._element.play()},r.pause=function(){return this._element.pause()},r._setBuffering=function(){var e=this;this._buffering||(this._buffering=!0,m.b.once(h.b._canplay,function(){o()(this,e),this._wasStalled=!1,this._buffering=!1}.bind(this)),m.b.emit(h.b._buffering))},r.get=function(e){switch(e){case"handler":return"html5/mse+hls";case"bandwidth":var t=parseInt(c()(this.state._controller,"streamController.stats.bwEstimate"));return isNaN(t)?null:t;case"bitrate":return c()(this.state._controller,"levels["+this.level+"].bitrate");case"edge":t=c()(this.state._controller,"levels["+this.level+"].url[0]");return t?t.match(/^([^/]*)?\/\/([^/]*)/)[2]:null;case"level":return c()(this.state._controller,"streamController.level");case"duration":return"live"===this.props.type?Infinity:(this._element||{})[e];case"volume":return this._element.muted?0:(this._element||{})[e];default:return(this._element||{})[e]}},r.set=function(e,t){this._element&&("volume"===e&&(this._element.muted=0===t),this._element[e]=t)},e.getDerivedStateFromProps=function(e,t){var n={};return e.src===t.src||(t=t._controller)&&(t.destroy(),n._controller=null,n.src=e.src),n.src?n:null},r.componentWillUnmount=function(){var e=this.state._controller;e&&e.destroy(),clearTimeout(this._pingTimeout),this._pingTimeout=null},s()(e,[{key:"liveSyncPos",get:function(){return this.state._controller.liveSyncPosition}}]),e}(r.a.PureComponent));r.contextType=i.b,t.default=r}}]);