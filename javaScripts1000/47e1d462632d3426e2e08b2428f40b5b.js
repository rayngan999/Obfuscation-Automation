(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){function UUIDjs(){}UUIDjs.maxFromBits=function(bits){return Math.pow(2,bits)};UUIDjs.limitUI04=UUIDjs.maxFromBits(4);UUIDjs.limitUI06=UUIDjs.maxFromBits(6);UUIDjs.limitUI08=UUIDjs.maxFromBits(8);UUIDjs.limitUI12=UUIDjs.maxFromBits(12);UUIDjs.limitUI14=UUIDjs.maxFromBits(14);UUIDjs.limitUI16=UUIDjs.maxFromBits(16);UUIDjs.limitUI32=UUIDjs.maxFromBits(32);UUIDjs.limitUI40=UUIDjs.maxFromBits(40);UUIDjs.limitUI48=UUIDjs.maxFromBits(48);function getRandomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min}UUIDjs.randomUI04=function(){return getRandomInt(0,UUIDjs.limitUI04-1)};UUIDjs.randomUI06=function(){return getRandomInt(0,UUIDjs.limitUI06-1)};UUIDjs.randomUI08=function(){return getRandomInt(0,UUIDjs.limitUI08-1)};UUIDjs.randomUI12=function(){return getRandomInt(0,UUIDjs.limitUI12-1)};UUIDjs.randomUI14=function(){return getRandomInt(0,UUIDjs.limitUI14-1)};UUIDjs.randomUI16=function(){return getRandomInt(0,UUIDjs.limitUI16-1)};UUIDjs.randomUI32=function(){return getRandomInt(0,UUIDjs.limitUI32-1)};UUIDjs.randomUI40=function(){return(0|Math.random()*(1<<30))+(0|Math.random()*(1<<40-30))*(1<<30)};UUIDjs.randomUI48=function(){return(0|Math.random()*(1<<30))+(0|Math.random()*(1<<48-30))*(1<<30)};UUIDjs.paddedString=function(string,length,z){string=String(string);z=!z?"0":z;var i=length-string.length;for(;i>0;i>>>=1,z+=z){if(i&1){string=z+string}}return string};UUIDjs.prototype.fromParts=function(timeLow,timeMid,timeHiAndVersion,clockSeqHiAndReserved,clockSeqLow,node){this.version=timeHiAndVersion>>12&15;this.hex=UUIDjs.paddedString(timeLow.toString(16),8)+"-"+UUIDjs.paddedString(timeMid.toString(16),4)+"-"+UUIDjs.paddedString(timeHiAndVersion.toString(16),4)+"-"+UUIDjs.paddedString(clockSeqHiAndReserved.toString(16),2)+UUIDjs.paddedString(clockSeqLow.toString(16),2)+"-"+UUIDjs.paddedString(node.toString(16),12);return this};UUIDjs.prototype.toString=function(){return this.hex};UUIDjs.prototype.toURN=function(){return"urn:uuid:"+this.hex};UUIDjs.prototype.toBytes=function(){var parts=this.hex.split("-");var ints=[];var intPos=0;for(var i=0;i<parts.length;i++){for(var j=0;j<parts[i].length;j+=2){ints[intPos++]=parseInt(parts[i].substr(j,2),16)}}return ints};UUIDjs.prototype.equals=function(uuid){if(!(uuid instanceof UUID)){return false}if(this.hex!==uuid.hex){return false}return true};UUIDjs.getTimeFieldValues=function(time){var ts=time-Date.UTC(1582,9,15);var hm=ts/4294967296*1e4&268435455;return{low:(ts&268435455)*1e4%4294967296,mid:hm&65535,hi:hm>>>16,timestamp:ts}};UUIDjs._create4=function(){return(new UUIDjs).fromParts(UUIDjs.randomUI32(),UUIDjs.randomUI16(),16384|UUIDjs.randomUI12(),128|UUIDjs.randomUI06(),UUIDjs.randomUI08(),UUIDjs.randomUI48())};UUIDjs._create1=function(){var now=(new Date).getTime();var sequence=UUIDjs.randomUI14();var node=(UUIDjs.randomUI08()|1)*1099511627776+UUIDjs.randomUI40();var tick=UUIDjs.randomUI04();var timestamp=0;var timestampRatio=1/4;if(now!=timestamp){if(now<timestamp){sequence++}timestamp=now;tick=UUIDjs.randomUI04()}else if(Math.random()<timestampRatio&&tick<9984){tick+=1+UUIDjs.randomUI04()}else{sequence++}var tf=UUIDjs.getTimeFieldValues(timestamp);var tl=tf.low+tick;var thav=tf.hi&4095|4096;sequence&=16383;var cshar=sequence>>>8|128;var csl=sequence&255;return(new UUIDjs).fromParts(tl,tf.mid,thav,cshar,csl,node)};UUIDjs.create=function(version){version=version||4;return this["_create"+version]()};UUIDjs.fromTime=function(time,last){last=!last?false:last;var tf=UUIDjs.getTimeFieldValues(time);var tl=tf.low;var thav=tf.hi&4095|4096;if(last===false){return(new UUIDjs).fromParts(tl,tf.mid,thav,0,0,0)}else{return(new UUIDjs).fromParts(tl,tf.mid,thav,128|UUIDjs.limitUI06,UUIDjs.limitUI08-1,UUIDjs.limitUI48-1)}};UUIDjs.firstFromTime=function(time){return UUIDjs.fromTime(time,false)};UUIDjs.lastFromTime=function(time){return UUIDjs.fromTime(time,true)};UUIDjs.fromURN=function(strId){var r,p=/^(?:urn:uuid:|\{)?([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{2})([0-9a-f]{2})-([0-9a-f]{12})(?:\})?$/i;if(r=p.exec(strId)){return(new UUIDjs).fromParts(parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16),parseInt(r[4],16),parseInt(r[5],16),parseInt(r[6],16))}return null};UUIDjs.fromBytes=function(ints){if(ints.length<5){return null}var str="";var pos=0;var parts=[4,2,2,2,6];for(var i=0;i<parts.length;i++){for(var j=0;j<parts[i];j++){var octet=ints[pos++].toString(16);if(octet.length==1){octet="0"+octet}str+=octet}if(parts[i]!==6){str+="-"}}return UUIDjs.fromURN(str)};UUIDjs.fromBinary=function(binary){var ints=[];for(var i=0;i<binary.length;i++){ints[i]=binary.charCodeAt(i);if(ints[i]>255||ints[i]<0){throw new Error("Unexpected byte in binary data.")}}return UUIDjs.fromBytes(ints)};UUIDjs.new=function(){return this.create(4)};UUIDjs.newTS=function(){return this.create(1)};module.exports=UUIDjs},{}],2:[function(require,module,exports){function CSArray(){this._data=[];this._handlers={};this.views=[];this.experimentObservers=[];this.events=[]}CSArray.prototype.load=function(arr){var self=this;for(var i=0;i<arr.length;i++){self.push(arr[i],arr[i+1],arr[i+2])}arr.push=function(){var argArray=Array.prototype.slice.call(arguments);self.push.apply(self,argArray);for(var i=0;i<argArray.length;i++){arr[arr.length]=argArray[i]}}};CSArray.prototype.onPush=function(name,handler){if(typeof name!=="string"||typeof handler!=="function"){return console.log("invalid options given to CSArray.onPush:",name,handler)}this._handlers[name]=this._handlers[name]||[];this._handlers[name].push(handler)};CSArray.prototype._firePushHanders=function(name,arg1,arg2){var self=this;if(self._handlers[name]){setTimeout(function(){for(var i=0;i<self._handlers[name].length;i++){self._handlers[name][i](arg1,arg2)}},0)}};CSArray.prototype._isEvent=function _isEvent(){return typeof arguments[0]==="object"};CSArray.prototype._isSetView=function _isSetView(method,view){if(method==="setView"&&typeof view==="string"){return view}};CSArray.prototype._isExperimentObserver=function _isExperimentObserver(expObs,expName,observer){if(expObs==="experimentObserver"&&typeof expName==="string"&&typeof observer==="function"){return{experimentName:expName,observer:observer}}};CSArray.prototype.push=function(){var tempView=this._isSetView(arguments[0],arguments[1]);if(tempView){this.views.push(tempView);if(arguments.length===3){this._firePushHanders("setView",tempView,arguments[2]||{})}else{this._firePushHanders("setView",tempView,{})}return true}var tempObserver=this._isExperimentObserver(arguments[0],arguments[1],arguments[2]);if(tempObserver){this.experimentObservers.push(tempObserver);this._firePushHanders("experimentObserver",tempObserver.experimentName,tempObserver.observer);return true}if(this._isEvent(arguments[0])){this.events.push(arguments[0]);this._firePushHanders("event",arguments[0]);return true}return false};module.exports=function(){return new CSArray}},{}],3:[function(require,module,exports){module.exports=function(prefix,storage,idGenerator,_window,startCallback){var sessionStart=false,sessionId=storage.localVar(prefix+"SessionId"),sessionStartDateTimeFromStorage=storage.localVar(prefix+"SessionStartDateTime"),sessionStartDateTime=sessionStartDateTimeFromStorage?new Date(sessionStartDateTimeFromStorage):new Date,sessionDTStamp=new Date(storage.localVar(prefix+"SessionDateTimeStamp")),sessionSeq=storage.localVar(prefix+"SessionSequence")||0,thirtyMinsAgo=new Date;thirtyMinsAgo.setTime(thirtyMinsAgo.getTime()-30*6e4);if(!sessionStartDateTimeFromStorage||!sessionId||!sessionDTStamp||sessionId&&sessionDTStamp<thirtyMinsAgo){sessionId=storage.localVar(prefix+"SessionId",idGenerator());storage.localVar(prefix+"SessionStartDateTime",sessionStartDateTime.valueOf());storage.localVar(prefix+"SessionSequence",++sessionSeq);sessionStart=true;if(_window.NREUM){_window.NREUM.setCustomAttribute("clickstream_session_id",sessionId)}}storage.localVar(prefix+"SessionDateTimeStamp",(new Date).valueOf());var sessionData={sessionId:sessionId,sessionSeq:sessionSeq,sessionDTStamp:sessionDTStamp,sessionStartDateTime:sessionStartDateTime};if(sessionStart){startCallback(sessionData)}return sessionData}},{}],4:[function(require,module,exports){module.exports=function(window){"use strict";function readCookie(cookieName){var re=new RegExp("[; ]"+cookieName+"=([^;]*)"),sMatch=(" "+window.document.cookie).match(re);if(cookieName&&sMatch){return sMatch[1]}return null}function writeCookie(cookieMap){for(var key in cookieMap){if(cookieMap.hasOwnProperty(key)){window.document.cookie=""+key+"="+cookieMap[key]}}}var localStorageEnabled=false,sessionStorage={};try{window.localStorage["cs.enabled"]=true;localStorageEnabled=true;delete window.localStorage["cs.enabled"]}catch(e){}try{window.sessionStorage["cs.enabled"]=true;delete window.sessionStorage["cs.enabled"];sessionStorage=window.sessionStorage}catch(e){}function store(opts){var o=opts||{},name=o.name,value=o.value,session=o.session;if(!!name){if(!!value){if(session===true){sessionStorage[name]=JSON.stringify(value)}else{if(localStorageEnabled){window.localStorage[name]=JSON.stringify(value)}else{var cookie={};cookie[name]=JSON.stringify(value);writeCookie(cookie)}}return value}else{if(session===true){try{return JSON.parse(sessionStorage[name])||null}catch(e){return sessionStorage[name]||null}}else if(localStorageEnabled){try{return JSON.parse(window.localStorage[name]||null)}catch(e){return window.localStorage[name]||null}}else{return JSON.parse(readCookie(name))}}}}return{localVar:function localVarStore(name,value){return store({name:name,value:value,session:false})},sessionVar:function sessionVarStore(name,value){return store({name:name,value:value,session:true})}}}},{}],5:[function(require,module,exports){"use strict";var types="Boolean Number String Function Array Date RegExp Object Error".split(" "),class2type={},toString=class2type.toString,_;for(var i in types){if(types.hasOwnProperty(i)){class2type["[object "+types[i]+"]"]=types[i].toLowerCase()}}module.exports=_={type:function(obj){if(obj==null){return obj+""}return typeof obj==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj},isFunction:function(obj){return _.type(obj)==="function"},isArray:Array.isArray,isWindow:function(obj){return obj!=null&&obj===obj.window},isPlainObject:function(obj){if(_.type(obj)!=="object"||obj.nodeType||_.isWindow(obj)){return false}try{if(obj.constructor&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false}}catch(e){return false}return true},extend:function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[i]||{};i++}if(typeof target!=="object"&&!_.isFunction(target)){target={}}if(i===length){target={};i--}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(_.isPlainObject(copy)||(copyIsArray=_.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&_.isArray(src)?src:[]}else{clone=src&&_.isPlainObject(src)?src:{}}target[name]=_.extend(deep,clone,copy)}else if(copy!==undefined){target[name]=copy}}}}return target}}},{}],6:[function(require,module,exports){module.exports=function(window,Storage,session,Uuid,_,CSArray,OptimizeExperimentArray,Events){"use strict";var _csq=window._csq=window._csq||[],_ocsq=window._ocsq=window._ocsq||[],store=Storage(window),csa=CSArray(),optimizeExperimentArray=OptimizeExperimentArray();var trackerV2=Events(_csq.v2disabled,_csq.v2platform,_csq.v2host,_csq.userIdKey,_csq.userUdidKey,window,store,session,Uuid,_csq.v2post,_csq.isSequenceStored);csa.onPush("event",function(event){var v2=event.v2;delete event.v2;if(!_csq.v2disabled&&v2){trackerV2.trackEvent(v2.namespace,v2.name,v2.version,v2.data)}});csa.onPush("setView",function(view,data){if(!_csq.v2disabled){trackerV2.setView(view,data||{})}});csa.load(_csq);optimizeExperimentArray.load(_ocsq,_csq);window._csq.loaded=true;window._ocsq.loaded=true}},{}],7:[function(require,module,exports){module.exports=function(disabled,platform,host,userIdKey,userUdidKey,window,storage,session,uuid,v2post,isSequenceStored){return new Events(disabled,platform,host,userIdKey,userUdidKey,window,storage,session,uuid,v2post,isSequenceStored)};function Events(disabled,platform,host,userIdKey,userUdidKey,window,storage,session,uuid,v2post,isSequenceStored){this._platform=platform;this._url=(host||"https://api-gtm.grubhub.com")+"/clickstream/events";this._userIdKey=userIdKey;this._userUdidKey=userUdidKey;this._window=window;this._storage=storage;this._session=session;this._uuid=uuid;this._sequence=this._storage.localVar("sequence")||0;this._pageSeq=0;this._appInstance=this._storage.localVar("nextappInstance")||1;this._storage.localVar("nextappInstance",this._appInstance+1);this._v2post=v2post;this._isSequenceStored=isSequenceStored;this._browserId=this._storage.localVar("clickstream2BrowserId")||this._storage.localVar("clickstream2BrowserId",this._uuid.create(1).toString());if(this._window.NREUM){this._window.NREUM.setCustomAttribute("clickstream_browser_id",this._browserId)}if(!disabled){this._getSessionData()}}function getTzOffset(now){var tzOffset=-now.getTimezoneOffset()/60;var absTzOffset=leftPad(Math.floor(Math.abs(tzOffset)).toString(),2);var minutesOffset=leftPad((Math.abs(tzOffset)%1*60).toString(),2);return(tzOffset<0?"-":"+")+absTzOffset+minutesOffset}function leftPad(number,digits){var pad="0000000000";var returnString=pad+number;return returnString.substring(returnString.length-digits)}Events.prototype.trackEvent=function trackEvent(ns,name,version,data,_sessionData){var now=new Date,sessionData=_sessionData||this._getSessionData(),trackingObj={eventVersion:2,event:{deviceId:null,browserId:this._browserId,sessionId:sessionData.sessionId,sessionSeq:sessionData.sessionSeq,pageSeq:this._pageSeq,eventSeq:++this._sequence,appInstance:this._appInstance,clientDateTime:now.valueOf(),clientTimeZone:getTzOffset(now),dataVersion:version,namespace:ns,name:name},data:data};if(this._isSequenceStored){this._storage.localVar("sequence",this._sequence)}this._v2post(this._url,{events:[trackingObj]})};Events.prototype.setView=function setView(view,data){++this._pageSeq;var referrer=data.referrer||this._window.document.referrer;this.trackEvent("clickstream","pageViewed",1,{pageName:view,referrer:referrer?{string:referrer}:null,protocol:{string:data.protocol||this._window.location.protocol},hostname:{string:data.hostname||this._window.location.hostname},path:{string:data.pathname||this._window.location.pathname},query:{string:data.search||this._window.location.search},screenSize:data.screenSize||{},vars:data.vars||{}})};Events.prototype._getSessionData=function _getSessionData(){var self=this,idGenerator=function(){return self._uuid.create(1).toString()},userId=this._storage.localVar(this._userIdKey)||this._storage.sessionVar(this._userIdKey),userUdid=this._storage.localVar(this._userUdidKey)||this._storage.sessionVar(this._userUdidKey),os=this._platform.os,osVersion=this._platform.osVersion;return this._session("clickstream2",this._storage,idGenerator,this._window,function(sessionData){self._sequence=0;self._pageSeq=0;self.trackEvent("clickstream","sessionStarted",2,{userAgent:self._window.navigator.userAgent,device:self._platform.device||"Browser",deviceFamily:self._platform.deviceFamily||"Web",brand:self._platform.brand,app:self._platform.app,appVersion:self._platform.appVersion||"0.0.0",os:os?{string:os}:null,osVersion:osVersion?{string:osVersion}:null,env:self._platform.env||"prod",autoLoginAccountUdid:userUdid?{uuid:userUdid}:null,autoLoginAccountId:userId?{int:parseInt(userId,10)}:null})})}},{}],8:[function(require,module,exports){require("./clickstream2")(window,require("../clickstream/storage"),require("../clickstream/session"),require("../../node_modules/uuid-js"),require("../clickstream/util"),require("../clickstream/csArray"),require("../clickstream2/optimize.experiment.array"),require("./events"))},{"../../node_modules/uuid-js":1,"../clickstream/csArray":2,"../clickstream/session":3,"../clickstream/storage":4,"../clickstream/util":5,"../clickstream2/optimize.experiment.array":9,"./clickstream2":6,"./events":7}],9:[function(require,module,exports){function OptimizelyExperimentArray(){this.csq=[]}OptimizelyExperimentArray.prototype.load=function(ocsq,csq){var self=this;self.csq=csq;for(var i=0;i<ocsq.length;i++){self.push(ocsq[i])}ocsq.push=function(){var argArray=Array.prototype.slice.call(arguments);self.push.apply(self,argArray);for(var i=0;i<argArray.length;i++){ocsq[ocsq.length]=argArray[i]}}};OptimizelyExperimentArray.prototype.push=function(){var self=this;try{var easyOptimizelyExp=arguments[0];var experimentName=easyOptimizelyExp.experimentName;var experimentId=easyOptimizelyExp.experimentId;var treatment=easyOptimizelyExp.treatment;var provider=easyOptimizelyExp.provider||"GoogleOptimize";if(!experimentName||!experimentId||!treatment){var variables=[experimentName,experimentId,treatment].join(", ");throw new Error("Missing experimentName, experimentId, or treatment: "+variables)}var massagedOptimizelyExp={name:"optimizely_experiment_applied",data:{experiment_name:experimentName,experiment_id:experimentId,treatment:treatment},v2:{name:"experimentTreatments",namespace:"clickstream",version:1,data:{provider:provider,providerSessionId:null,treatments:[{experimentId:{string:experimentId},experimentName:experimentName,treatmentId:null,treatmentName:treatment,isApplied:true}]}}};self.csq.push(massagedOptimizelyExp);return true}catch(error){console.log("Failed to massage optimizely experiment clickstream data, reason:",error);return false}};module.exports=function(){return new OptimizelyExperimentArray}},{}]},{},[8]);