var cl=function(){function e(){this.URL_XSS="https://www.emoney.ge",this.events=[],this.output=[],this.eventQ=[],this.botIgnore=["https://accounts.google.com","https://apis.google.com"]}return e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];for(var o in e){var n=document.getElementById(e[o]);n&&n.contentWindow&&this.output.push(n.contentWindow)}for(var o in this.eventQ)this.onMsgListener(this.eventQ[o]);this.eventQ=[]},e.prototype.on=function(e,t,o){if("function"!=typeof t)throw new Error("paramentr incorrect");o&&("boolean"==typeof o&&o&&(t.backAction=this.pref+nameOf(t)),"string"==typeof o&&(t.backAction=o)),void 0!==this.events[e]&&null!==this.events[e]||(this.events[e]=[]),this.events[e].push(t)},e.prototype.remove=function(e){this.events[e]=void 0},e.prototype.callEvents=function(e,t){var o=this;this.events[e]?this.events[e].forEach(function(e){void 0!==e.backAction?o.callOut(e.backAction,e(t)):e(t)}):(console.error("No event defined for "+e),this.callEvents("error","No event defined for "+e))},e.prototype.callOut=function(e,t){try{for(var o in this.output)this.output[o]&&this.output[o].postMessage(JSON.stringify([e,t]),this.URL_XSS)}catch(n){console.error(n),this.callEvents("error",n)}},e.prototype.onMsgListener=function(e){try{for(var t in this.botIgnore)if(urlCompare(this.botIgnore[t],e.origin))return;if(!this.output||0==this.output.length)return void this.eventQ.push(e);if(!urlCompare(this.URL_XSS,e.origin))return;var o=JSON.parse(e.data);this.callEvents(o[0],o[1])}catch(n){console.log(n),this.callEvents("error",n)}},e.prototype.loadWidget=function(e){if(console.log(e),"embedded"!=e.appearance?e.style=e.style||"position:fixed;top:0;left:0;z-index:998;height:100%;width:100%;border: 0px;display: none;":e.style=e.style||"position: static; top:0;left:0;z-index:998;height:100%;width:100%;border: 0px;display: none;",null!=document.getElementById(e.id))return void(decodeURI(document.getElementById(e.id).src)!=e.widget_src&&(document.getElementById(e.id).src=e.widget_src));var t=document.createElement("iframe");t.id=e.id,t.src=e.widget_src,t.style.cssText=e.style,e.widgetContainerId?document.getElementById(e.widgetContainerId).appendChild(t):document.body.appendChild(t),this.load(e.id),this.on("close",function(t){document.getElementById(e.id).style.display="none"}),"undefined"!=typeof shortcut&&shortcut.add("Esc",function(){document.getElementById(e.id).style.display="none"})},e.prototype._showWidget=function(e){void 0!=e.widget_src&&this.loadWidget(e),document.getElementById(e.id).style.display="block"},e.prototype.showWidget=function(e){if("undefined"!=typeof e.widget_src)this._showWidget(e);else{if("undefined"==typeof e.domain)throw"Domain not set";var t=e.domain;if("undefined"==typeof e.protocol)throw"Protocol not set";var o=(e.iframeId||"widget-"+Math.random().toString(36).substring(7),e.protocol),n=e.lang||"ka",i=e.userEmail||!1,r=e.userMobile||!1,s=e.userFullname||!1,d=e.userParam||!1,a=e.serviceId||!1,c="undefined"!=typeof e.forcePayment&&e.forcePayment;if(c){if(!a)throw"Must provide serviceId for force payment";if(!d)throw"Must provide userParam for force payment"}var l=e.hash||!1,p="undefined"!=typeof e.forceLogin&&e.forceLogin;if(p){if(!l)throw"Must provide hash for force login";if(!i)throw"Must provide user email for force login";if(!r)throw"Must provide user mobile for force login"}var u=e.paymentAmount||!1;if(u&&!d)throw"Must provide userParam for paymentAmount";var f="undefined"!=typeof e.bitcoin&&e.bitcoin,h="https://www.emoney.ge/index.php/widget_beta/services?domain="+t+"&protocol="+o+"&lang="+n;a&&(h+="&service_id_to_redirect="+a+"&show_redirected_service_only=1"),d&&(h+="&serviceparam="+d),c&&(h+="&repeat_payment=1"),i&&r&&(h+="&guestemail="+i+"&guestmobile="+r),s&&(h+="&guestfullname="+s),p&&(h+="&guestlogin=1&hash="+l),u&&(h+="&amount="+u),f&&(h+="&bitcoin=1");var g=e.widgetType||"mini";g&&(h+="&widget_type="+g);var m=e.appearance||"dialog";m&&(h+="&appearance="+m);var v=e.widgetContainerId||null;if("embedded"==m&&!v)throw"Must proivde widgetContainerId";var y=e.themeId||1;y&&(h+="&theme_id="+y);var w="undefined"==typeof e.editUserParam||e.editUserParam;h+="&edit_serviceparam="+(w?"1":"0"),this._showWidget({id:e.iframeId,widget_src:h,appearance:m,widgetContainerId:v})}},e}(),client=new cl;window.addEventListener?window.addEventListener("message",function(e){client.onMsgListener(e)},!1):window.attachEvent("onmessage",function(e){client.onMsgListener(e)}),client.on("error",function(e){console.log(e)}),client.on("ping",function(e){console.log("New_Client_MSG","pong"),client.callOut("pong",e)}),window.onload=function(){var e=document.createElement("em:div");e.innerHTML="<noscript><iframe src='//www.googletagmanager.com/ns.html?id=GTM-K8TM2W' height='0' width='0' style='display:none;visibility:hidden'></iframe></noscript>",document.body.appendChild(e),function(e,t,o,n,i){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var r=t.getElementsByTagName(o)[0],s=t.createElement(o),d="dataLayer"!=n?"&l="+n:"";s.async=!0,s.src="//www.googletagmanager.com/gtm.js?id="+i+d,r.parentNode.insertBefore(s,r)}(window,document,"script","dataLayer","GTM-K8TM2W")};