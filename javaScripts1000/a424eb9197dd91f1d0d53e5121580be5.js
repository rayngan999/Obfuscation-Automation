define(["modules/id.core","modules/id.mainActionBarV2"],function(e){"use strict";e.utils.log("loading id.eventBreadcrumb.js");var t=function(){this.conf={breadcrumbInitClass:"id-Breadcrumb--jsEvent--init",breadcrumbElClass:"id-js-eventBreadcrumb-element",breadcrumbElSelector:".id-js-eventBreadcrumb-element",breadcrumbElOpenClass:"id-Breadcrumb-element-subMenu--open",breadcrumbElOpenSelector:".id-Breadcrumb-element-subMenu--open",breadcrumbElClosedClass:"id-Breadcrumb-element-subMenu--closed",breadcrumbElCatIdDataAttr:"idEventBreadcrumbCatId"},this.currentState={openCategoryId:null,$openElement:null};var t=this;this.handleBreadcrumbClick=function(t){var n,o;n=e.dom.$(t.target),n.hasClass(this.conf.breadcrumbElClass)||(n=e.dom.closest(this.conf.breadcrumbElSelector,n)),o=this.getCatId(n),null!==o&&(t.preventDefault(),e.event.publish(e.event.constants.BREADCRUMB_CLICK,o),this.handleBreadCrumbBehaviour(o))},this.handleBreadCrumbBehaviour=function(n){var o,i,r,s=e.dom.$(t.conf.breadcrumbElSelector,t.breadCrumb),a=s.length,d=t.getCatId(e.dom.$(t.conf.breadcrumbElOpenSelector,t.breadCrumb));for(r=0;a>r;r+=1)i=e.dom.$(s[r]),o=t.getCatId(i),d===n?t.setActiveClass(i,!1):n===o?t.setActiveClass(i,!0):t.setActiveClass(i,!1)},this.getCatId=function(e){var t=e&&e.data()||null;return t&&t[this.conf.breadcrumbElCatIdDataAttr]||null},this.setActiveClass=function(e,t){t?(e.addClass(this.conf.breadcrumbElOpenClass),e.removeClass(this.conf.breadcrumbElClosedClass)):(e.addClass(this.conf.breadcrumbElClosedClass),e.removeClass(this.conf.breadcrumbElOpenClass))},this.init=function(n){var o=e.dom.$(n),i=e.dom.$(this.conf.breadcrumbElSelector,o);this.breadCrumb=n,i.length>0&&(e.dom.bind(n,"click",function(e){t.handleBreadcrumbClick(e)}),e.event.subscribe(e.event.constants.MAIN_NAV_V2_ELEMENT_CLICKED,t.handleBreadCrumbBehaviour,this,!1)),o.removeClass(this.conf.breadcrumbInitClass)}};return t});