!function(){"use strict";function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var t="1.2.2",n="".concat("session-portal","@").concat(t),o="/api/sessions/",i="/api/segments/",s="/api/vtexid/refreshtoken/webstore",a={"vtex-session-ui-version":n},r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return $.ajax({type:"POST",url:o,headers:a,contentType:"application/json",dataType:"json",data:JSON.stringify({public:e})})},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return $.ajax({type:"POST",url:"".concat(o,"?items=").concat(t||"*"),headers:a,contentType:"application/json",dataType:"json",data:JSON.stringify({public:e})})},c="vtex-impersonated-customer-email",l=function(e){if(e&&e[c]){var t=e[c];t.value?function(e,t,n){var o=e.replace(/[^#$&+^`|]/g,encodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+(t+"").replace(/[^!#$&-+\--:<-[\]-~]/g,encodeURIComponent);if(n){var i=new Date;i.setDate(i.getDate()+n),o+="; expires="+i.toUTCString()}o+="; path=/",document.cookie=o}(c,t.value,1):function(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/;"}(c)}},p="vid_rt_webstore",d="success",v="invalidsession",f="error",g=function(e,t){return localStorage.setItem(p,JSON.stringify({status:e,refreshAfter:t}))},w=function(){return localStorage.removeItem(p)},m=function(){return g(f,new Date((new Date).getTime()+18e5))},y=function(e){var t,n,o,i="true"===(null==e||null===(t=e.namespaces)||void 0===t||null===(n=t.profile)||void 0===n||null===(o=n.isAuthenticated)||void 0===o?void 0:o.value),s=!!localStorage.getItem(p);i&&!s&&g(d,new Date((new Date).getTime()+432e5)),!i&&s&&w()},h=function(){var e=new Date,t=JSON.parse(localStorage.getItem(p)||"null");return!t||e<new Date(t.refreshAfter)?$.Deferred().resolve().promise():$.ajax({type:"POST",url:s,headers:{"vtex-id-ui-version":n},contentType:"application/json",dataType:"json",data:"{}"}).done((function(e){if(e&&e.status){var t=e.status.toLowerCase();if(t!==v)if(t!==d)m();else{var n=e.refreshAfter;g(t,new Date(n))}else w()}else m()})).fail((function(){return m()}))};window.vtexjs=window.vtexjs||{},window.vtexjs.session=new function n(){n.prototype.version=t,n.prototype.setParameter=function(t,o){var i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.warn("`vtexjs.session.setParameter` is deprecated. Please use `vtexjs.session.setSessionParams` instead.");var a=null===(i=s.autoRefresh)||void 0===i||i,r=t?e({},t,{value:o}):{},u=n.prototype.setSessionParams(r);return a?u.done((function(){window.location.reload()})):u},n.prototype.setSessionParams=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l(e),r(e)},n.prototype.setSessionGetItems=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return l(e),u(e,t)},n.prototype.getSession=function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return $.ajax({type:"GET",url:"".concat(o,"?items=").concat(e.items||"*"),headers:a,contentType:"application/json",dataType:"json"})}(e)},n.prototype.getSegment=function(){return $.ajax({type:"GET",url:i,headers:a,contentType:"application/json",dataType:"json"})}},$(document).ready((function(){h().always((function(){return window.vtexjs.session.setSessionGetItems({},"profile.isAuthenticated").done((function(e){$(window).trigger("session.done"),y(e)}))})),$(window).on("authenticatedUser.vtexid",(function(){window.vtexjs.session.setSessionGetItems({},"profile.isAuthenticated").done((function(e){$(window).trigger("session.done"),y(e)}))}))}))}();