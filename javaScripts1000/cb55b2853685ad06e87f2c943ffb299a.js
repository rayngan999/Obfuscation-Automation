"use strict";var TFCApp;!function(){var e;TFCApp||(TFCApp={getRunMode:function(){return e},isProdMode:function(){return e===TFCApp.RunModes.staging||e===TFCApp.RunModes.prod},isDevMode:function(){return e===TFCApp.RunModes.dev},RunModes:{dev:1,test:2,staging:3,prod:4},Constants:{BannerMode:{Register:"Register",Complete:"Complete"},RequestParameter:{UserSession:"userCookie",Gender:"gender",Department:"department",AgeGroup:"ageGroup",Category:"category",ProductType:"productType",IPS:"ips",FirstName:"firstName",OrderId:"orderid",StyleColorId:"colorId",AvailableSizes:"availableSizes",Style:"style",CurrentStyle:"crStyle",ExcludedStyle:"exStyle",StoreEmbedded:"storeEmbedded",Placement:"placement",UserId:"userid",StoreRegistered:"storeRegistered",OriginWidget:"originWidget",Container:"container",ScreenSize:"screenSize",SessionParams:"sessionParams",SessionParamOverrides:"sessionParamOverrides",AnalyticsSession:"analyticsSession",AnalyticsScreenSize:"analyticsScreenSize",AnalyticsArgs:"analyticsArgs",UniversalAnalyticsArgs:"universalAnalyticsArgs",PageName:"pageName",Funnels:"funnels",CookiesEnabled:"cookiesEnabled",SourceTrigger:"sourceTrigger",AlternateUserId:"alternateUserId",StoreTla:"storeId",WindowParams:"windowParams",ServiceSecureURI:"serviceSecureURI",StoreVersionPath:"storeVersionPath",ProfileComplete:"profileComplete",FitRecResult:"fitrecResult",CustomProfileJs:"customjs",IsEnteringData:"isEnteringData",WidgetContext:"widgetContext",Widget:"widget",AutoCalculate:"autoCalculate",ClientToServerLogging:"clientToServerLogging",Token:"token",UserHasLegacyCookie:"userHasLegacyCookie",IntegrationPlatform:"platform",ThirdPartyAuth:"thirdPartyAuth",ThirdPartyCredEmailCollectionEnabled:"thirdPartyCredEmailCollectionEnabled",RecipientLinkId:"recipientLinkId",RecipientAlias:"recipientAlias",IsSettingUpNewRecipient:"isSettingUpNewRecipient",EditRecipientLinkId:"editRecipientLinkId",IsShoppingForOther:"isShoppingForOther",OriginUrl:"originUrl",UserSettings:"userSettings",ApplicationName:"applicationName",SessionContext:"sessCtx",WidgetHidden:"widgetHidden",StoreExperimentKey:"storeExperimentKey",StoreCategory:"storeCategory",IncludeDislikes:"includeDislikes",RecipientProfileId:"recipientProfileId",ClientSupportsDiscovery:"csDiscovery",ClientSupportsSfo:"csSfo",AllowTokenCycling:"allowTokenCycling",DeviceType:"deviceType",ServiceMode:"serviceMode",Locale:"locale",IframeIntegration:"iframeIntegration",QMEnabled:"qmEnabled"},Header:{UserToken:"x-tf-usertoken",UserTokenMaxAge:"x-tf-usertokenmaxage",UserTokenDomain:"x-tf-usertokendomain",UserTokenSecure:"x-tf-usertokensecure",UserSession:"x-tf-usersession",SessionParams:"x-tf-sessionparams",SessionParamMaxAge:"x-tf-sessionparammaxage",IsUserRecognized:"x-tf-isuserrecognized",StoreUserId:"x-tf-storeuserid"},Attributes:{FIRST_NAME:"data-x-firstname",ALT_USER_ID:"data-x-altuserid",ORDER_ID:"data-orderid",GENDER:"data-gender",IPS:"data-ips",LOCALE:"data-locale",STYLE_ID:"data-styleid-private",STYLE_ID_NEW:"data-styleid",STYLE_ID_LEGACY:"id",USERID:"data-userid",USER_ID:"data-user-id",STORE_REGISTERED:"data-registered",STYLE_COLOR_ID:"data-colorid",AVAILABLE_SIZES:"data-availablesizes",CONTEXT:"data-context",RECIPIENT_ID:"data-recipient-id",STORE_CATEGORY:"data-store-category",CATEGORY:"data-category",AGE_GROUP:"data-age-group",WIDGET_HIDDEN:"data-widget-hidden",STORE_EXPERIMENT_KEY:"data-store-experiment-key"},DeviceType:{Mobile:"mobile",Desktop:"desktop",Responsive:"responsive"},AgeGroup:{Adult:"Adult",Child:"Child"},SessionContext:{Adult:"adult",Child:"child"},Category:{Bottoms:"Bottoms",Dresses:"Dresses",Shoes:"Shoes",Tops:"Tops",Bras:"Bras"},Department:{Boy:"Boys",Girl:"Girls",Men:"Mens",Unisex:"Unisex",UnisexKids:"UnisexKids",Women:"Womens"},Gender:{Male:"Male",Female:"Female",Unisex:"Unisex"},ProductType:{Tops:"Tops",Bottoms:"Bottoms",Shoes:"Shoes",DressShirts:"DressShirts",Dresses:"Dresses",Suits:"Suits",Bras:"Bras"},Classification:{DressShirts:"DressShirts"},IPS:{Discovery:"discovery",FitDetails:"fitdetails",Login:"login",NewProfile:"newprofile",UpdateProfile:"profile",Unknown:"unknown",Welcome:"welcome",GeneralSizeAdvice:"generalsizeadvice",Manage:"manage",Save:"save",SfoNew:"sfonew",SfoEdit:"sfoedit",SfoNewChild:"sfonewchild",InstantProfile:"instantprofile",ProfileSwitcher:"profileswitcher",InvalidGender:"invalidgender",IncompleteGarment:"incompletegarment",SizeNotAvailable:"sizenotavailable",ShopForOthers:"shopforothers"},Context:{QuickView:"quickview"},SourceTrigger:{Banner:"Banner",Widget:"Widget",Popup:"Popup",Tab:"Tab"},Container:{Modal:"modal",Tip:"tip",Fixed:"fixed"},IntegrationPlatform:{Web:"web",App:"app"},Message:{Open:"open",Close:"close",Update:"update",Complete:"complete",PageLoad:"pageload",SessionContext:"sessionContext",SessionParams:"sessionparams",SessionParamsMaxAge:"sessionparamsmaxage",LogOut:"logout",Resize:"resize",ResizeModalWidth:"resizemodalwidth",Refresh:"refresh",UserSession:"usersession",UserSetting:"usersetting",UserSettings:"usersettings",UserToken:"usertoken",AddToBag:"addtobag",ScreenSizeChange:"screensizechange",FitRecResults:"fitrecresults",Chat:"chat",AppRevealed:"appRevealed",SizeChart:"sizechart",DiscoveryProductsViewed:"discoveryproductsviewed",DiscoveryRecommendationClicked:"discoveryrecommendationclicked",UserClick:"userclick"},NGEvents:{UpdateProfileStrength:"UpdateProfileStrength"},ScreenSize:{Small:"small",Large:"large"},LayoutPosition:{Right:"right",Left:"left"},UserSettings:{DiscoveryIntroMessageViewed:"dimv",DiscoveryExitSuppressed:"des",SessionParams:"session.params"},ModalWidth:{Wide:"wide",Narrow:"narrow"},LayoutType:{Inline:"inline",Modal:"modal"},FitRec:{Event:{LogOut:"logout",OpenDialog:"opendialog",MoreInfo:"moreinfo",OpenRegistration:"openreg",Render:"render"},Status:{EstimationInProgress:"estimationinprogress",Error:"error",IncompleteGarment:"incompletegarment",IncompleteProfile:"incompleteprofile",InvalidGender:"invalidgender",NoUser:"nouser",NoStyle:"nostyle",NoStyleNoUser:"nostylenouser",SizeNotAvailable:"sizenotavailable",Success:"success",UserDisabled:"userdisabled"},TemplateName:{AnonymousNotRecommended:"anonymousnotrecommended",AnonymousRecommended:"anonymousrecommended",EstimationInProgress:"estimationinprogress",Error:"error",IncompleteGarment:"incompletegarment",IncompleteProfile:"incompleteprofile",InvalidGender:"invalidgender",UnrecommendableDepartment:"unrecommendabledepartment",NoUser:"nouser",NoStyle:"nostyle",NoStyleNoUser:"nostylenouser",NotRecommended:"notrecommended",Recommended:"recommended",RecommendedGarmentUserSizeOnly:"garmentusersizeonly",RecommendedGarmentSizeOnly:"garmentsizeonly",RecommendedUserSizeOnly:"usersizeonly",RecommendedDepartmentSizeOnly:"departmentsizeonly",BrandAdvice:"brandadvice"}}},analytics:{},component:{},manager:{},tips:{},utility:{},add:function(e,i,t){t&&!TFCApp[e][t]?TFCApp[e][t]=i:TFCApp[e]||(TFCApp[e]=i)}}),e=TFCApp.RunModes.prod||TFCApp.RunModes.dev}();
"use strict";!function(){TFCApp.add("bind",function(n,t){if("function"!=typeof n)throw"Cannot bind to non-function";var r=Array.prototype.slice.call(arguments,2);return function(){var o=Array.prototype.slice.call(arguments);return n.apply(t,r.concat(o))}})}();
"use strict";/*!
 * Simple JavaScript Inheritance
 * By John Resig http://ejohn.org/
 * MIT Licensed.
 *
 * Extended to included support for private methods and variables
 * through the use of a proxy object on instantiation.
 */
!function(t){function n(){function t(){var t=this;f||t._constructor&&t._constructor.apply(t,arguments)}return t}function r(t,n){var r;return f=!0,r=new n,f=!1,s(t,r,n),r}function o(){throw new Error("Unimplemented abstract function")}function e(t,n){return function(){var r,o=this._super;return this._super=n,r=t.apply(this,arguments),this._super=o,r}}function s(t,n,r){var o;for(o in t)t.hasOwnProperty(o)&&(n[o]=r&&"function"==typeof t[o]&&"function"==typeof r.prototype[o]&&a.test(t[o])?e(t[o],r.prototype[o]):t[o])}function u(o){var e,s;return s=this,e=n(),e.prototype=r(o,s),e.prototype.constructor=e,e.extend=t.bind(u,e),e.isSubClassOf=i,e}function i(t){return this.prototype instanceof t}function p(){var t,n=this;for(t in n)n.hasOwnProperty(t)&&delete n[t]}var c,f=!1,a=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;c=n(),c.prototype.destroy=p,c.extend=t.bind(u,c),c.isSubClassOf=i,c.unimplemented=o,t.add("Class",c)}(TFCApp);
"use strict";!function(t){var e=t.Class,n=e.unimplemented,i=e.extend({getElem:n,setElem:n,removeElem:n,_each:n,_eachReverse:n,_size:function(){var e=0;return t.util.each(this,function(){++e}),e},_containsKey:function(e){var n=this;return!!t.util.find(n,function(i){return t.util.objEquals(i,e,n._strictKeys)})},_containsVal:function(e,n){return!!t.util.find(this,function(i,u){return t.util.objEquals(u,e,n)})},_isSorted:!1,_strictKeys:!0});t.add("Collection",i)}(TFCApp);
"use strict";!function(e){var n,i=e.Class,t={TRACE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,OFF:6};n=i.extend({log:i.unimplemented,raise:i.unimplemented}),n.LevelMap=t,e.add("utility",n,"LoggerEngine")}(TFCApp);
"use strict";!function(n){var e=n.utility,o=e.LoggerEngine,i=(o.LevelMap,window.console),t=!!i,r={TRACE:"trace",DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"};n.add("utility",o.extend({_constructor:function(n){this.level=n},log:function(n,e){var o=r[n];t&&i[o]&&(i[o].apply?i[o].apply(i,e):i[o](e))},raise:function(){}}),"ConsoleLoggerEngine")}(TFCApp);
"use strict";!function(n){function r(n){var r=(new Error).stack;this.name="RaiseError",this.message=n,r&&(this.stack=r)}function e(r,e,t){return[[n.util.isoDateString(),r,"["+e+"]"].join(" ")].concat(t)}function t(n){for(var r=[],e=0,t=n.length;t>e;e++){var i=n[e];r.push(i&&"string"==typeof i?i.replace(/\n|\r/g,"â"):i)}return r}function i(r,i){for(var o=l[r],g=r.replace(/\n|\r/g,"â"),a=e(r,i,n.util.slice(arguments,2)),s=t(a),c=0,p=u.length;p>c;++c){var E=u[c];E.level<=o&&E.log(g,s)}}function o(t){for(var i=e("EXCEPTION",t,n.util.slice(arguments,1)),o=new r(i.join(" ")),g=0,a=u.length;a>g;++g){var s=u[g];s.level!==l.OFF&&s.raise(o)}throw o}var g=n.utility,l=g.LoggerEngine.LevelMap,u=[];r.prototype=Object.create(Error.prototype),r.prototype.constructor=r;var a={RaiseError:r,getLogger:function(r){return{trace:n.bind(i,null,"TRACE",r),debug:n.bind(i,null,"DEBUG",r),info:n.bind(i,null,"INFO",r),warn:n.bind(i,null,"WARN",r),error:n.bind(i,null,"ERROR",r),raise:n.bind(o,null,r)}},registerLoggingEngine:function(n){u.push(n)}};a.registerLoggingEngine(a.console=new g.ConsoleLoggerEngine(n.isDevMode()?l.DEBUG:l.WARN)),n.add("utility",a,"Logger")}(TFCApp);
"use strict";!function(){function t(t){var e,r,n,s,i=document.getElementsByTagName("script"),c="",a={};for(r=0;r<i.length;++r)if(e=i[r].src,t.test(e)){c=e;break}for(n=(c.split("?",2)[1]||"").split("&"),r=0;r<n.length;++r)s=n[r].split("=",2),2===s.length&&(a[s[0]]=s[1]);return a}window.tfc_parseScriptQueryParams=t}();
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(n,t,e){function r(){return d.getLogger("TFCUtil")}function o(n,t){return t}function i(n){return n===e?!0:n}function u(n){var t;return n instanceof y?n:(t=h.type(n),"array"===t?new f(e,n):"object"===t||"function"===t?new p(e,n):void m.raise("Object is not a collection-like type",n))}function a(n){return n instanceof l?n.obj():n}function c(n,t){h[n+h.capitalize(t)]=function(){var e=h[n].apply(h,arguments);return e&&e[t]}}function s(n){return!(!n||"function"!==h.type(n.then))}var l,f,p,h={},d=n.utility.Logger,m=r(),y=n.Collection,g=Array.prototype,v=g.slice,b=navigator.userAgent;l=y.extend({getElem:function(n){return this._obj[n]},setElem:function(n,t){this._obj[n]=t},obj:function(){return this._obj},_containsKey:function(n){return n in this._obj},_obj:null,_strictKeys:!0}),f=l.extend({_constructor:function(n,t){this._obj=t||[]},pushElem:function(n){this._obj.push(n)},removeElem:function(n){var t=this.getElem(n);return this._obj.splice(n,1),t},_each:function(n){var t,e=this._obj;for(t=0;t<e.length&&n(t,e[t])!==!1;++t);},_eachReverse:function(n){var t,e=this._obj;for(t=e.length-1;t>=0&&n(t,e[t])!==!1;--t);},_size:function(){return this._obj.length},_containsVal:function(n,t){var e=g.indexOf;return t&&e?e.call(this._obj,n)>=0:this._super(n,t)},_isSorted:!0}),p=l.extend({_constructor:function(n,t){this._obj=t||{}},removeElem:function(n){var t=this.getElem(n);return delete this._obj[n],t},_each:function(n){var t,e=this._obj;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(t,e[t])===!1)break}}),h.stringToBool=function(n){return"true"===n},h.stringStartsWith=function(n,t){return 0===n.lastIndexOf(t,0)},h.stringEndsWith=function(n,t){return n.indexOf(t,n.length-t.length)>=0},h.filter=function(n,t){return h.partition(n,t)["true"]},h.partition=function(n,t){var e=u(n),r=new e.constructor(e._strictKeys),o=new e.constructor(e._strictKeys);return h.each(e,function(n,e){var i=t(n,e)?r:o;i instanceof f?i.pushElem(e):i.setElem(n,e)}),{"true":a(r),"false":a(o)}},h.map=function(n,t){var e=u(n),r=new e.constructor(e._strictKeys);return h.each(e,function(n,e){r instanceof f?r.pushElem(t(n,e)):r.setElem(n,t(n,e))}),a(r)},h.flatMap=function(n,t){return h.filter(h.map(n,t),function(n,t){return null!==t&&t!==e})},h.reverse=function(n){var t,e=u(n);return t=new e.constructor(e._strictKeys),h.eachReverse(e,function(n,e){t instanceof f?t.pushElem(e):t.setElem(n,e)}),a(t)},h.count=function(n,t){return h.size(h.filter(n,t))},h.sum=function(n){var t=0;return h.each(n,function(n,e){t+=e}),t},h.noop=function(){},h.reduce=function(n,t,r){var o,i=!1;if(r!==e)o=r;else{if(!h.isArray(n))throw new Error("you must provide an initial value when reducing an object");if(0===n.length)throw new TypeError("Reduce of empty array with no initial value");o=n[0],n=n.slice(1),i=!0}return h.each(n,function(e,r){e=i?e+1:e,o=t(o,e,r,n)}),o},h.groupByPreservingOrder=function(t,e,r){var o,c=u(t);if(r=i(r),o=new n.SortedMap(r),!c._isSorted)throw"TFCApp.util.groupByPreservingOrder cannot preserve order on unordered inputs";return h.each(c,function(n,t){var r,i=e(n,t);h.containsKey(o,i)?r=o.getElem(i):(r=new c.constructor(c._strictKeys),o.setElem(i,r)),c instanceof f?r.pushElem(t):r.setElem(n,t)}),h.map(o,function(n,t){return a(t)})},h.objKeys=function(n){var t=[];return h.each(n,function(n){t.push(n)}),t},h.objVals=function(n){var t=[];return h.each(n,function(n,e){t.push(e)}),t},h.keyValPairs=function(n){var t=[];return h.each(n,function(n,e){t.push({key:n,val:e})}),t},h.forAll=function(n,t){var e=!0;return h.each(n,function(n,r){return e=t(n,r)}),e},h.exists=function(n,t){return!!h.find(n,t)},h.objEquals=function(n,t,e){var r,o;return n===t?!0:(e=i(e))?n===t:(r=h.type(n),o=h.type(t),"object"===r||"array"===r?r===o&&h.size(n)===h.size(t)&&h.forAll(n,function(n,r){return h.objEquals(r,t[n],e)}):n===t)},h.size=function(n){return u(n)._size()},h.isEmpty=function(n){return 0===h.size(n)},h.nonEmpty=function(n){return h.size(n)>0},h.containsKey=function(n,t){return u(n)._containsKey(t)},h.containsVal=function(n,t,e){return e=i(e),u(n)._containsVal(t,e)},h.distinctVals=function(n,t){var e=[];return t=i(t),h.each(n,function(n,r){h.containsVal(e,r,t)||e.push(r)}),e},h.loadScript=function(n){function t(n){return function(){o.removeChild(e),n&&n()}}var e,r,o=document.body;return h.isNonZeroLengthString(n.url)||m.raise("loadScript options must have a non-empty url",n),n.cache=!1!==n.cache,n.cache||(n.data&&n.data.hasOwnProperty("_")&&m.error("do not use _ as a parameter name! loadScript will overwrite data._"),n.data=h.extend(n.data,{_:h.now()})),"object"===h.type(n.data)&&(r=n.url.indexOf("?")>-1?"&":"?",n.url+=r+h.param(n.data)),e=document.createElement("script"),e.type="text/javascript",e.async=!0,e.src=n.url,e.onload=t(n.success),e.onerror=t(n.error),void o.appendChild(e)},h.getCookie=function(n){var t=null;return h.each(document.cookie.split("; "),function(e,r){var o=r.indexOf("="),i=r.substr(0,o);return i===n?(t=r.substr(o+1),!1):void 0}),t},h.countCookie=function(n){var t=0;return h.each(document.cookie.split("; "),function(e,r){var o=r.indexOf("="),i=r.substr(0,o);i===n&&(t+=1)}),t},h.setCookie=function(n){var t,e,r,o,i;"object"===h.type(n)&&"string"===h.type(n.name)&&"string"===h.type(n.value)?(t=n.name+"="+n.value,e=n.domain,h.isNonZeroLengthString(e)&&(t+=";domain="+e),r=h.isNonZeroLengthString(n.path)?n.path:"/",t+=";path="+r,o=parseInt(n.maxAge),isNaN(o)||(0>=o?o=i=0:i=(new Date).getTime()+1e3*o,t+=";max-age="+o,t+=";expires="+new Date(i).toUTCString()),n.secure&&(t+=";secure"),m.trace("Attempting to set the cookie: document.cookie="+t),document.cookie=t):m.warn("Invalid arguments, not setting the cookie. [data: "+JSON.stringify(n)+"]")},h.deleteCookie=function(n){"object"===h.type(n)&&h.setCookie({name:n.name,value:"",domain:n.domain,secure:n.secure,path:n.path,maxAge:0})},function(){var n,t,e;n="\\[]{}()+*?!=^$,.-|:",t="\\"+n.split("").join("\\"),e=new RegExp("(["+t+"])","g"),h.regexSafe=function(n){return n.replace(e,"\\$1")},n=t=null}(),h.parseOrigin=function(n){return n.replace(/^\s*([^:]+:[\/\\]{2}[^\/\?\#\\]*).*$/,"$1")},h.parseParentDomain=function(n){var t,e,o=r();return n=n||document.location.href,t=h.parseOrigin(n).replace(/^[^:]+:[\/\\]{2}([^:]*)(:[0-9]+)?$/,"$1"),""===t||"localhost"===t||"about:blank"===t?null:t===n?(o.error("Could not parse domain from URL "+n),null):(e=/(^[^\.]+$)|([^\.]+\.((?:com|[^\.]{2})\.)?[^\.]+\.?$)/.exec(t),e?e[0]:(o.error("Could not parse parent domain from domain "+t),null))},h.parseAllSubDomains=function(n){n=n||document.location.href;var t=h.parseParentDomain(n);if(null===t)return[];var e=h.parseOrigin(n),r=e.split("//")[1].split(":")[0],o=[];r!==t&&(o=r.substring(0,r.lastIndexOf(t)-1).split("."));var i=t,u=[i];return h.eachReverse(o,function(n,t){u.push(i=t+"."+i)}),u},h.isNonZeroLengthString=function(n){return"string"===h.type(n)&&n.length>0},h.addParamIfNonZeroLengthString=function(n,t,e){h.isNonZeroLengthString(e)&&(n[t]=e)},h.addParamIfDefined=function(n,t,r){r!==e&&(n[t]=r)},h.chooseUri=function(n,t){return"https:"===document.location.protocol?n:t},h.arrayToPairs=function(n){var t={};return h.each(n,function(n,e){t[e]=e}),t},h.param=function(n,t){if("object"!==h.type(n))throw"Invalid argument passed to util.param ["+h.type(n)+"]";var e=[];return h.each(n,function(n,r){var o=h.type(r);h.isPrimitive(r)?e.push(encodeURIComponent(n)+"="+encodeURIComponent(r)):"array"===o&&t?h.each(r,function(t,r){e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):"array"===o||"object"===o?e.push(encodeURIComponent(n)+"="+encodeURIComponent(JSON.stringify(r))):m.raise("Invalid type passed to util.param",n,r)}),e.join("&")},h.deparam=function(n){var t,e,r,o,i,u={},a=n.split("&");for(t=0,e=a.length;e>t;++t)if(r=a[t].split("=",2),2===r.length)try{o=decodeURIComponent(r[0]),i=decodeURIComponent(r[1]),u[o]=i}catch(c){m.warn("Failed to decode query parameters[key="+r[0]+",value="+r[1]+"]")}return u},h.getAttributes=function(n){var t={};return h.each(n.get(0).attributes,function(n,e){t[e.nodeName]=e.nodeValue}),t},h.keyToPrintableCharacter=function(n){var t=String.fromCharCode(n),e=t.charCodeAt(0);return e>=32&&126>=e?t:""},h.arrayIndexOf=function(n,t){var e=-1;return h.each(n,function(n,r){return r===t?(e=n,!1):void 0}),e},h.getQueryParams=function(n){return h.deparam((n||h.getLocationWithoutHash()).split("?",2)[1]||"")},h.getLocationWithoutHash=function(){return document.location.href.split("#",2)[0]},h.getLocationHash=function(){return/^[^#]+#?(.*)$/.exec(document.location.href)[1]},h.isTouchSupported="object"==_typeof(t.Touch),h.supportsTransitions=function(){var n=document.documentElement.style;return n.webkitTransition!==e||n.MozTransition!==e||n.OTransition!==e||n.transition!==e},h.syncTiming=function(n){return h.asyncTiming(function(t){var e=n();return{elapsed:t(),result:e}})},h.asyncTiming=function(n){var t=(new Date).getTime();return n(function(){return(new Date).getTime()-t})},h.defaultValue=function(n,t){return n!==e?n:t},h.addIfDefined=function(n,t,r){var o=t[n];o!==e&&(r[n]=o)},h.randomInt=function(n,t){return n+Math.floor((t-n+1)*Math.random())},h.uuid=function(){function n(n){for(var t="",e=0;e<n.length;++e)t+=n[e].toString(16);return t}var e=t.crypto||t.msCrypto;return e&&t.Uint8Array?function(){for(var t=new Uint8Array(16),r=e.getRandomValues(t),o=[],i=0;i<r.length;++i)o.push(12===o.length?4:16===o.length?3&r[0]|8:r[i]>>4),o.push(15&r[i]);return n(o.splice(0,8))+"-"+n(o.splice(0,4))+"-"+n(o.splice(0,4))+"-"+n(o.splice(0,4))+"-"+n(o)}:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){return("x"===n?h.randomInt(0,15):8|h.randomInt(0,3)).toString(16)})}}(),h.each=function(n,t){n&&u(n)._each(t)},h.eachReverse=function(n,t){n&&u(n)._eachReverse(t)},h.usesStrictKeys=function(n){return u(n)._strictKeys},h.extend=function(n){var t=h.slice(arguments,1);return n=n||{},h.each(t,function(t,e){e&&h.each(e,function(t,e){n[t]=e})}),n},h.slice=function(n){return h.isArrayLike(n)||m.raise("You must provide an array-like object to util#slice"),v.apply(n,v.call(arguments,1))},h.last=function(n){return h.isArrayLike(n)||m.raise("You must provide an array-like object to util#last"),n[n.length-1]},h.drop=function(n,t){return h.isArrayLike(n)||m.raise("You must provide an array-like object to util#drop"),t===e&&(t=1),v.call(n,Math.max(0,t))},h.dropRight=function(n,t){return h.isArrayLike(n)||m.raise("You must provide an array-like object to util#dropRight"),t===e&&(t=1),t=n.length-t,v.call(n,0,Math.max(0,t))},h.pad=function(n){return("number"!==h.type(n)||0>n||n%1!==0)&&m.raise("util.pad called with non-natural number:",n),10>n&&"0"+n||n.toString()},/*! Adapted from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString
   *  Any copyright is dedicated to the Public Domain. http://creativecommons.org/publicdomain/zero/1.0/ */
h.isoDateString=function(){var n=h.pad,t=new Date;return t.getFullYear()+"-"+n(t.getMonth()+1)+"-"+n(t.getDate())+" "+n(t.getHours())+":"+n(t.getMinutes())+":"+n(t.getSeconds())+"."+(t.getMilliseconds()/1e3).toFixed(3).slice(2)},h.now=function(){return(new Date).getTime()},h.isNaN=function(n){return"number"===h.type(n)&&isNaN(n)},h.isPrimitive=function(n){var t=h.type(n);return"boolean"===t||"number"===t||"string"===t},/*!
   * Start of code derived from jQuery
   */
/*!
   * jQuery JavaScript Library v1.8.3
   * http://jquery.com/
   *
   * Includes Sizzle.js
   * http://sizzlejs.com/
   *
   * Copyright 2012 jQuery Foundation and other contributors
   * Released under the MIT license
   * http://jquery.org/license
   *
   * Date: Tue Nov 13 2012 08:20:33 GMT-0500 (Eastern Standard Time)
   */
function(){var n,t,e=Object.prototype.toString,r={},o="Boolean Number String Function Array Date RegExp Object".split(" ");for(n=0;n<o.length;++n)t=o[n],r["[object "+t+"]"]=t.toLowerCase();h.type=function(n){return null==n?String(n):r[e.call(n)]||"object"}}(),h.isPlainObject=function(n,t){return t=t===e?!0:t,!(!n||"object"!==h.type(n)||t&&n.constructor!==Object)},h.isArray=function(n){return"array"===h.type(n)},h.isFunction=function(n){return"function"===h.type(n)},h.isVisible=function(n){return n.offsetWidth>0||n.offsetHeight>0},/*!
   * End of code derived from jQuery
   */
h.isConstructor=function(n){try{return!0}catch(t){return!1}},h.capitalize=function(n){return n.charAt(0).toUpperCase()+n.substr(1)},h.camelCase=function(){var n=/-(\w)/g;return function(t){return t.toLowerCase().replace(n,function(n,t){return t.toUpperCase()})}}(),h.find=function(n,t){var r=e;return h.each(n,function(n,e){return t(n,e)?(r={key:n,val:e},!1):void 0}),r},h.head=function(n){var t;if(n!==e){if(t=u(n),!t._isSorted)throw new Error("TFCApp.util.head is not intended for unordered inputs");return h.find(t,function(){return!0})}return e},h.each(["find","head"],function(n,t){c(t,"key"),c(t,"val")}),h.readOnly=function(n,t){return t===e&&(t=!0),"object"!==h.type(n)||s(n)||h.each(n,function(e,r){var o=!!(r&&"object"===h.type(r)&&n.hasOwnProperty(e)&&Object.getOwnPropertyDescriptor(n,e).writable);Object.defineProperty(n,e,{writable:!1}),t&&o&&h.readOnly(r,t)}),n},h.hashKey=function(n){var t,e,r,o=h.type(n);switch(o){case"array":return t=h.map(n,function(n,t){return h.hashKey(t)}),"["+t.join(",")+"]";case"object":return e=h.objKeys(n).sort(),r=h.map(e,function(t,e){return JSON.stringify(e)+":"+h.hashKey(n[e])}),"{"+r.join(",")+"}";case"date":return n.toUTCString();case"string":return JSON.stringify(n);case"null":case"undefined":return o;case"boolean":case"number":case"regexp":case"function":return n.toString()}},h.isArrayLike=function(n){return!(!n||"number"!==h.type(n.length))},/*!
   * Code in this section is derived from underscore.js
   *
   *     Underscore.js 1.8.3
   *     http://underscorejs.org
   *     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *     Underscore may be freely distributed under the MIT license.
   */
h.throttle=function(n,t,e){var r,o,i,u,a=0;e||(e={});var c=function(){a=e.leading===!1?0:h.now(),r=null,u=n.apply(o,i),r||(o=i=null)},s=function(){var s=h.now();a||e.leading!==!1||(a=s);var l=t-(s-a);return o=this,i=arguments,0>=l||l>t?(r&&(clearTimeout(r),r=null),a=s,u=n.apply(o,i),r||(o=i=null)):r||e.trailing===!1||(r=setTimeout(c,l)),u};return s.cancel=function(){clearTimeout(r),a=0,r=o=i=null},s},h.debounce=function(n,t,e){var r,o,i,u,a,c=function s(){var c=h.now()-u;t>c&&c>=0?r=setTimeout(s,t-c):(r=null,e||(a=n.apply(i,o),r||(i=o=null)))};return function(){i=this,o=arguments,u=h.now();var s=e&&!r;return r||(r=setTimeout(c,t)),s&&(a=n.apply(i,o),i=o=null),a}},/*!
   End underscore.js code
   */
h.each({max:-1/0,min:1/0},function(n,t){h[n]=function(e,r){var i=t,u=null;return r=r||o,h.each(e,function(e,o){var a=r(e,o);(a!==i&&Math[n](i,a)===a||a===t&&null===u)&&(i=a,u={key:e,val:o},u[n]=a)}),u},h[n+"Val"]=function(t,e){var r=h[n](t,e);return r&&r[n]}}),h.round=function(n,t){t=t||0;var e=Math.pow(10,t);return Math.round(n*e)/e},h.retry=function(n,t,e,r,o){function i(c){u=(new Date).getTime(),n(t,function(){var n;n="consistentInterval"===r?o:o*(1<<c-1);var t=(new Date).getTime()-u,s=n-t;c===a?e():setTimeout(function(){i(++c)},Math.max(0,s))})}var u,a=10;o="undefined"!=typeof o?o:100,i(1)},h.isHttpSuccess=function(n){return n>=200&&300>n},h.isRealMouseEvent=function(n){return n.isTrusted===!1?!1:!(0===n.screenX&&0===n.screenY&&0===n.clientX&&0===n.clientY)},h.browser=h.readOnly({isEdge:/Edge/.test(b),isIE:/MSIE/.test(b)},!0),h.prependToStyleTag=function(n,t){return n.styleSheet?n.styleSheet.cssText=t+n.styleSheet.cssText:n.textContent=t+n.textContent,n},h.placeOnPage=function(n,t){return t=t||document.getElementsByTagName("script")[0],t.parentNode.insertBefore(n,t),n},h.sameOrigin=function(n,t){return t===n||t+":80"===n||n+":80"===t},h.range=function(n,t){for(var e=[],r=n;t>=r;r++)e.push(r);return e},h.isSingular=function(n){return 1===n},h.arrayToObject=function(n,t,e){var r={};return h.each(n,function(n,o){r[t(o)]=e(o)}),r},h.invert=function(n){var t={};return h.each(n,function(n,e){t[e]=n}),t},n.add("util",h)}(TFCApp,window,void 0);
"use strict";!function(t){function n(){for(var t="",n=0;I>n;n++)t+="  ";return t}function e(t,e,r){var i=!0,u=O.slice(arguments,3),s=u.length>1;return O.each(u,function(r,c){var o,p=t[r];if(c instanceof a){if(!c.test(p))return o=["Invalid argument(s) passed to "+(e||"function")+". \nExpected type"+(s?"s":"")+":(",O.map(u,function(t,e){return"\n"+n()+e.expected()}),"\n)\nbut got:\n"],i=[o.join(""),t,". Additionally, Function.prototype.bind=",Function.prototype.bind.toString()],!1}else S.raise("Invalid argument passed to TFCApp.checkArgs (curry 2)")}),r(i)}function r(n,r,i){return O.isArrayLike(n)&&(void 0===r||O.isNonZeroLengthString(r))?t.bind(e,null,n,r,i):void S.raise("Invalid argument passed to TFCApp.checkArgs (curry 1)")}function i(t,n){return r(t,n,function(t){return t!==!0&&(S.error.apply(S,t),S.raise("Invalid arguments found by checkArgs. See error log.")),t})}function u(t,n){return r(t,n,function(t){return t!==!0&&S.error.apply(S,t),t})}function s(t,n){(!O.isArray(t)||t.length<2||!c(t))&&S.raise(n+" requires an array of at least two types as its type")}function c(t){var n=O.isPlainObject(t)||O.isArray(t);return n&&O.each(t,function(t,e){return e instanceof a?void 0:(n=!1,!1)}),n}var o,a,p,f,_,l,d,h,y,g,v,x,m,w,b,T,A=t.Class,j=A.unimplemented,O=t.util,S=t.utility.Logger.getLogger("TypeHelper"),I=1;a=A.extend({_constructor:function(t,n,e){this._type=t,this.__not=!!n,this.__optional=!!e},not:function(){return new(this._class())(this._type,!this.__not,this.__optional)},optional:function(){return new(this._class())(this._type,this.__not,!0)},test:function(t){return this.__optional&&void 0===t||this.__not&&!this._test(t)||!this.__not&&this._test(t)},_test:j,expected:function(){var t=(this.__not?"not ":"")+this._expected();return this.__optional?"optional("+t+")":t},_expected:j,_class:j,_type:null,__not:null,__optional:null}),p=a.extend({_test:function(t){return O.type(t)===this._type},_expected:function(){return this._type},_class:function(){return p}}),l=p.extend({_constructor:function(t,n,e){this._super("number",n,e)},_class:function(){return l},fromString:function(t){i(arguments)(o.String);var n=parseFloat(t);return isFinite(n)?n:void 0}}),d=l.extend({_test:function(t){return this._super(t)&&t%1===0},_expected:function(){return"integer"},_class:function(){return d},fromString:function(t){i(arguments)(o.String);var n=this._super(t);return this._test(n)?n:void 0}}),h=p.extend({_constructor:function(t,n,e){this._super("boolean",n,e)},_class:function(){return h},fromString:function(t){switch(i(arguments)(o.String),t){case"true":return!0;case"false":return!1}return void 0}}),y=p.extend({_constructor:function(t,n,e){this._super("string",n,e)},_class:function(){return y},fromString:function(t){return i(arguments)(o.String),t}}),g=p.extend({_constructor:function(t,n,e){this._super("array",n,e)},_class:function(){return g}}),w=a.extend({_constructor:function(t,n,e){s(t,"TupleType"),this._super(t,n,e)},_test:function(t){var n=O.isArray(t)&&t.length===this._type.length;return n&&O.each(this._type,function(e,r){return r.test(t[e])?void 0:(n=!1,!1)}),n},_expected:function(){var t=O.map(this._type,function(t,n){return n.expected()});return"Tuple"+t.length+"["+t.join(", ")+"]"},_class:function(){return w}}),b=a.extend({_constructor:function(t,n,e){s(t,"OrType"),this._super(t,n,e)},_test:function(t){var n=!1;return O.each(this._type,function(e,r){return r.test(t)?(n=!0,!1):void 0}),n},_expected:function(){var t=O.map(this._type,function(t,n){return n.expected()});return"one of ("+t.join(", or ")+")"},_class:function(){return b}}),T=a.extend({_constructor:function(n,e,r){var i=t.type.Tuple(t.type.Or(t.type.Instance(g),t.type.Instance(v)),t.type.Instance(a));i.test(n)||S.raise("OfType requires "+i.expected()+" as its type"),this._super(n,e,r)},_test:function(t){var n=this._type,e=n[0].test(t);return e&&O.each(t,function(t,r){return n[1].test(r)?void 0:(e=!1,!1)}),e},_expected:function(){var t=this._type;return t[0].expected()+" of "+t[1].expected()},_class:function(){return T}}),f=p.extend({_constructor:function(t,n,e){var r=t.fieldTypes,i=O.isPlainObject(r);i&&O.each(r,function(t,n){return n instanceof a?void 0:(i=!1,!1)}),i||S.raise("ObjectType type argument must be a plain object with Type values"),this._super(t,n,e)},_test:function(t){var n=this._type,e=O.isPlainObject(t,n.strict);return e&&O.each(n.fieldTypes,function(n,r){return r.test(t[n])?void 0:(e=!1,!1)}),e},_expected:function(){var t=[];return I++,O.each(this._type.fieldTypes,function(e,r){t.push(n()+e+":"+r.expected())}),I--,"{\n"+t.join(", \n")+"\n"+n()+"}"},_class:function(){return f}}),v=f.extend({_constructor:function(t,n,e){this._super({fieldTypes:{}},n,e)},_expected:function(){return"object"},_class:function(){return v}}),_=a.extend({_constructor:function(t,n,e){O.isConstructor(t)||S.raise("InstanceType type argument must be a function/constructor"),this._super(t,n,e)},_test:function(t){return t instanceof this._type},_expected:function(){return"instance of "+(this._type.name||"anonymous")},_class:function(){return _}}),m=a.extend({_test:function(){return!0},_expected:function(){return"any"},_class:function(){return m}}),x=new p("function"),o={Any:new m,Null:new p("null"),Boolean:new h,Number:new l,Integer:new d,String:new y,Function:x,Array:new g,PlainObject:new v,Promise:new f({fieldTypes:{then:x},strict:!1}),Object:function(t,n){return new f({fieldTypes:t,strict:n})},Instance:function(t){return new _(t)},Tuple:function(t){return t=O.slice(arguments),new w(t)},Or:function(t){return t=O.slice(arguments),new b(t)},ArrayOf:function(t){return new T([o.Array,t])},ObjectOf:function(t){return new T([o.PlainObject,t])}},t.add("type",o),t.add("checkArgs",i),t.add("checkArgsSoft",u)}(TFCApp);
"use strict";!function(e){var t=e.util,n=e.type,r=e.checkArgs,s=e.utility.Logger.getLogger("Http"),a=e.Constants.Header,o=function(e,n){var r={};return n&&t.each(n,function(e,n){t.addParamIfNonZeroLengthString(r,e,n)}),e+"?"+t.param(r,!1)},i=/^\)]\}',?\n/,c=4,u={post:function(e){r(arguments)(n.Object({serviceSecureUrl:n.String,data:n.Or(n.String,n.PlainObject,n.Array),userToken:n.String.optional(),queryParameters:n.PlainObject.optional(),headers:n.PlainObject.optional(),success:n.Function.optional(),failure:n.Function.optional()}));var s=e.data;e.payload=t.isPlainObject(s)||t.isArray(s)?JSON.stringify(s):s,e.method="POST",this._sendRequest(e)},get:function(e){r(arguments)(n.Object({serviceSecureUrl:n.String,responseType:n.String.optional(),userToken:n.String.optional(),queryParameters:n.PlainObject.optional(),success:n.Function.optional(),failure:n.Function.optional(),withCredentials:n.Boolean.optional()})),e.method="GET",this._sendRequest(e)},_addHeaders:function(e,n){n&&t.each(n,function(t,n){e.setRequestHeader(t,n)})},_sendRequest:function(n){var r,u,p=n.method,l=n.serviceSecureUrl,d=n.payload,g=n.queryParameters,f=n.responseType,T=n.success,h=n.failure,S=!!n.withCredentials,y=n.headers?n.headers:{},m=n.userToken;m&&(y[a.UserToken]=m),t.isNonZeroLengthString(l)&&(r=new XMLHttpRequest,u=o(l,g),"withCredentials"in r?(r.withCredentials=S,r.open(p,u,!0),this._addHeaders(r,y),"POST"===p&&r.setRequestHeader("Content-Type","application/json; charset=UTF-8")):"undefined"!=typeof XDomainRequest&&(r=new XDomainRequest,r.open(p,u))),r&&(r.send(d),r.onreadystatechange=function(){if(r.readyState===c)if(t.isHttpSuccess(r.status)){if(e.cookieHelper){var n=r.getAllResponseHeaders().split("\r\n"),o=function(e){return e.split(": ")[0].toLowerCase()},u=function(e){return e.split(": ")[1]},p=t.arrayToObject(n,o,u),l=p[a.UserToken],d=parseInt(p[a.UserTokenMaxAge]),g=p[a.UserTokenDomain],S=!!p[a.UserTokenSecure];l&&e.cookieHelper.userToken(l,t.isNaN(d)?void 0:d,g,S)}if("json"===f&&r.responseText.trim().length>0)try{r.data=JSON.parse(r.responseText.replace(i,"").trim()),T&&T(r)}catch(y){s.error("Unable to parse JSON from HTTP response expecting JSON [response text: "+r.responseText+"]"),h&&h(r)}else T&&T(r)}else h&&h(r)})}};e.add("utility",u,"Http")}(TFCApp);
"use strict";!function(e){var t,r=e.utility,o=e.util,n=e.type,a=r.Logger.getLogger("Storage"),i="tfc-l",s="tfc-s",l=31536e4,g={Analytics:"a",SessionContext:"c",UserVisit:"v",UserSettings:"s",User:"u",Test:"t",Token:"k"},c={};c[g.Analytics]="tfcAnalytics",c[g.UserVisit]="tfcUserVisit",c[g.UserSettings]="tfcUserSettings",c[g.User]="_tfcUserCookie",t=e.Class.extend({_constructor:function(t){e.checkArgs(arguments)(n.Object({readImpl:n.Function,writeImpl:n.Function,deleteImpl:n.Function,supportsLegacyCookies:n.Boolean.optional()})),this._readImpl=t.readImpl,this._writeImpl=t.writeImpl,this._deleteImpl=t.deleteImpl,this._supportsLegacyCookies=t.supportsLegacyCookies||!1,this._logLocalStorageDeleteError=t.logLocalStorageDeleteError||!1},_localStorageSet:!1,_getLegacyCookieName:function(e){return this._supportsLegacyCookies?c[e]:void 0},_writeOne:function(t,r,s,l,g){e.checkArgs(arguments)(n.String,n.PlainObject,n.Integer.optional(),n.String.optional(),n.Boolean.optional());var c,u,d=this;if(o.isEmpty(r))d._deleteImpl(t);else{c=encodeURIComponent(JSON.stringify(r)),u=t.length+c.length,u>4096?a.error("Attempt to save cookie ["+t+"] larger than 4096 bytes ["+u+"]. This is not supported by some browsers."):u>500&&a.warn("Attempt to save cookie ["+t+"] larger than 500 bytes ["+u+"]. Consider reducing the amount of data being stored.");var h={name:t,value:c,maxAge:s};l&&(h.domain=l),g&&(h.secure=g),this._logLocalStorageDeleteError&&t===i&&(this._localStorageSet=!0),d._writeImpl(h)}},_writeBoth:function(t,r,o,a){e.checkArgs(arguments)(n.PlainObject,n.PlainObject,n.String.optional(),n.Boolean.optional());var g=this;g._writeOne(i,t,l,o,a),g._writeOne(s,r,void 0,o,a)},_readOne:function(t){e.checkArgs(arguments)(n.String);var r=this._readImpl(t);return this._logLocalStorageDeleteError&&t===i&&(r?this._localStorageSet=!0:null===r&&this._localStorageSet&&(a.error(i+" was unintentionally deleted."),this._localStorageSet=!1)),r?JSON.parse(decodeURIComponent(r)):{}},getValueWithMaxAge:function(t){e.checkArgs(arguments)(n.String);var r=this,l=r._readOne(i),g=r._readOne(s),c=r._getLegacyCookieName(t),u=c?r._readImpl(c):null;if(t in l){var d=o.now()/1e3;return l[t].e<=d?(r["delete"](t),a.warn("The value stored in the local cookie has expired. [key: "+t+"]"),null):{value:l[t].v,maxAge:parseInt(l[t].e-d)}}return t in g?{value:g[t]}:(a.warn("The value was not found in the local or session cookie. Attempting to use legacy cookie. [key: "+t+"]"),{value:u})},get:function(e){var t=this,r=t.getValueWithMaxAge(e);return r&&r.value},set:function(t,r,l,g,c){e.checkArgs(arguments)(n.String,n.Or(n.String,n.PlainObject),n.Or(n.Null,n.Integer).optional(),n.String.optional(),n.Boolean.optional());var u=this,d=u._readOne(i),h=u._readOne(s),p=u._getLegacyCookieName(t);if(p&&u._deleteImpl(p),n.Integer.test(l)){if(0>=l)return u["delete"](t),void a.warn("Max age is less than zero; deleting the key from the cookie [key:"+t+", maxAge: "+l+"]");delete h[t],d[t]={v:r,e:parseInt(o.now()/1e3+l)}}else delete d[t],h[t]=r;u._writeBoth(d,h,g,c)},"delete":function(t){e.checkArgs(arguments)(n.String);var r=this,o=r._readOne(i),a=r._readOne(s),l=r._getLegacyCookieName(t);l&&r._deleteImpl(l),delete o[t],delete a[t],r._writeBoth(o,a)},enabled:function(){var e,t=g.Test,r=this;return r.set(t,"x"),e="x"===r.get(t),r["delete"](t),e},isLegacy:function(t){e.checkArgs(arguments)(n.String);var r=this,o=r._getLegacyCookieName(t);return o?null!==r._readImpl(o):!1}}),t.keys=g,t.LocalStorageName=i,t.SessionStorageName=s,e.add("utility",t,"Storage")}(TFCApp);
"use strict";!function(e){var n=e.util,o=e.utility,a=o.Storage,r=o.TempStorage,t=o.Logger.getLogger("StorageFactory"),i={cookieBased:function(e){function o(e,o){n.each(i,function(a,r){r!==o&&n.deleteCookie({name:e,domain:r})})}var r=document.location.href,i=n.parseAllSubDomains();return e.domain&&!n.containsVal(i,e.domain)&&t.error("True Fit was loaded on a domain not matching the retailer's configured cookie domain. True Fit may experience degraded or broken functionality. Configuration value:",e.domain,"Current URL:",r,"Parsed sub-domains:",i),e.secure&&!n.stringStartsWith(r,"https")&&t.error("True Fit was loaded on a non-HTTPS domain, but is configured to use a secure cookie. True Fit may experience degraded or broken functionality. Configuration value:",e.secure,"Current URL:",r),new a({readImpl:function(e){return n.getCookie(e)},writeImpl:function(a){if(!e.readOnly){var r=n.extend({domain:n.parseParentDomain()},a,e);n.setCookie(r),n.countCookie(a.name)>1&&o(a.name,r.domain)}},deleteImpl:function(n){e.readOnly||o(n)},supportsLegacyCookies:!0,logLocalStorageDeleteError:!e.readOnly})},messageBased:function(e,n){function o(e,n){return e===a.LocalStorageName?n(u):e===a.SessionStorageName?n(c):void t.error("Unknown storage key: ",e)}function i(e){o(e.name,function(n){return n.write(e)})}var u=new r({value:n.tfcL},function(n){e.messageManager.sendTfcL(n.value,n.maxAge)}),c=new r({value:n.tfcS},function(n){e.messageManager.sendTfcS(n.value)});return new a({readImpl:function(e){var n=o(e,function(e){return e.read()});return n&&n.value||null},writeImpl:i,deleteImpl:function(e){i({name:e,value:"",maxAge:0})}})}};e.add("utility",i,"StorageFactory")}(TFCApp);
"use strict";!function(t){t.tfcapiSetup=function(e){function i(t,e,i,n){var r=!1,a=!!t,l=function(){return u.forAll(e,function(e,i){return!!t["__"+i]})};return a&&l()&&u.containsVal(e,i)&&(t["__"+i].apply(t,n),r=!0),r}function n(){var e=[],n=s.fitrec.concat(s.tracker);u.each(r.q,function(r,a){var l=a[0],c=u.slice(a,1);u.containsVal(n,l)?i(window.tfc,s.fitrec,l,c)||i(t.trackerService,s.tracker,l,c)||e.push(a):o.error("Retailer attempted to call non-existent True Fit API function: "+l)}),r.q=e,l=null}var r,a=window.tfcapi,l=null,o=t.utility.Logger.getLogger("tfcapi"),c=t.type,u=t.util,s={fitrec:["calculate","event","update","getProfileUrl","getToken","setToken"],tracker:["track"]};e&&"tfcapi"in window&&o.warn("Retailer initialized the tfcapi object, but the legacy integration is still enabled for this retailer. True Fit should disable the legacy integration if the retailer is no longer using it."),c.Function.test(a)&&c.Array.optional().test(a.q)&&a&&!a.loaded?(window.tfcapi=r=function(){arguments&&"internalProcess"===arguments[0]?(null!=l&&(clearTimeout(l),l=null),n()):(tfcapi.q.push(arguments),null===l&&(l=setTimeout(n,1)))},r.loaded=!0,r.q=a.q||[],n()):a&&a.loaded?window.tfcapi("internalProcess"):e||o.error("Retailer loaded True Fit without properly initializing the tfcapi object. This usually means that True Fit disabled the legacy integration for this retailer, but the retailer is still using it.")}}(TFCApp);
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){function e(t){function e(t,e){if(e instanceof HTMLElement)return e.outerHTML;if("object"===("undefined"==typeof e?"undefined":_typeof(e))){if(o.indexOf(e)>=0)return"[Circular]";o.push(e)}return e}var o=[];return JSON.stringify(t,e)}var o=t.utility,i=t.type,n=o.LoggerEngine,l=n.LevelMap;t.add("utility",n.extend({_constructor:function(e,o){t.checkArgs(arguments)(i.Object({secureUri:i.String,tla:i.String,level:i.String.optional(),loggingTimeoutDelay:i.Integer.optional(),postRequestLimit:i.Integer.optional(),clientLogLimit:i.Integer.optional(),loggingContextLimit:i.Integer.optional()}),i.Instance(t.CookieHelper));var n=this,g={secureUri:e.secureUri,tla:e.tla,level:e.level||"ERROR",loggingTimeoutDelay:e.loggingTimeoutDelay||1e3,postRequestLimit:e.postRequestLimit||25,clientLogLimit:e.clientLogLimit||20,loggingContextLimit:e.loggingContextLimit||4},r="/consumer/ui/"+g.tla+"/client-log";n.level=l[g.level],n._cfg=g,n._serviceSecureUrl=g.secureUri+r,n._clientLogs=[],n._timeout=null,n._postCount=0,n._loggingContext=[],n._cookieHelper=o},log:function(t,o){var i=l[t],n=this,g=n._cfg,r=n.level;0!==g.loggingContextLimit&&(i===l.INFO||r===l.ERROR&&i===l.WARN)&&(n._loggingContext.length===g.loggingContextLimit&&n._loggingContext.shift(),n._loggingContext.push(e(o))),n._post({level:t,message:e(o)})},raise:function(t){this._post({level:"ERROR",error:t})},_post:function(t){var e,i,n,l=this,g=l._cfg;l._postCount<g.postRequestLimit&&(null===l._timeout&&(l._timeout=setTimeout(function(){e=l._cookieHelper.userSession(),i=l._cookieHelper.userToken(),++l._postCount,o.Http.post({serviceSecureUrl:l._serviceSecureUrl,queryParameters:n,data:{clientLogs:l._clientLogs,postNumber:l._postCount,loggingContext:l._loggingContext},userToken:i}),l._clientLogs=[],l._timeout=null,l._loggingContext=[]},g.loggingTimeoutDelay)),l._clientLogs.length<g.clientLogLimit&&l._clientLogs.push(t))}}),"HttpLoggerEngine")}(TFCApp);
"use strict";!function(e){var s=e.Class,n=s.unimplemented,a=s.extend({userSession:n,setSessionParams:n,getSessionParams:n,setSessionParamsMaxAge:n,userToken:n,sessionContext:n});e.add("CookieHelper",a)}(TFCApp);
"use strict";!function(e){var t=e.utility.Storage.keys.User,s=e.utility.Storage.keys.Token,i=e.utility.Storage.keys.SessionContext,o=e.utility.Logger.getLogger("FitRecCookieHelper"),r=e.CookieHelper.extend({_constructor:function(e){this._userSettings=e},sessionContext:function(t,s){o.trace("FitRecCookieHelper.sessionContext("+t+","+s+")");var r=e.storage;return void 0===t?r.get(i):(r.set(i,t,s),t)},userSession:function(s,i){o.trace("FitRecCookieHelper.userSession("+s+","+i+")");var r=e.storage;return void 0===s?r.get(t):(r.set(t,s,i),s)},userToken:function(t,i,r,n){o.trace("FitRecCookieHelper.userToken("+t+", "+i+")");var a=e.storage;return void 0===t?a.get(s):(a.set(s,t,i,r,n),t)},setSessionParams:function(t){o.trace("FitRecCookieHelper.setSessionParams("+t+")"),this._userSettings.set(e.UserSettings.keys.SessionParams,t)},getSessionParams:function(){return this._userSettings.get(e.UserSettings.keys.SessionParams)},setSessionParamsMaxAge:function(e){o.trace("FitRecCookieHelper.setSessionParamsMaxAge("+e+")"),this._userSettings.setMaxAge(e)},_userSettings:null});e.add("FitRecCookieHelper",r)}(TFCApp);
"use strict";!function(e){var a=e.util,t=e.utility,i=e.type,n=i.Integer,s=t.Logger.getLogger("CookieData"),_=10,o=e.Class.extend({_constructor:function(a){e.checkArgs(arguments)(i.Object({name:i.String,enabled:i.Boolean,types:i.PlainObject,maxAge:i.Or(n,i.Null).optional()})),i.Integer.test(a.maxAge)||i.Null.test(a.maxAge)||void 0===a.maxAge||s.raise("maxAge argument must be an integer (specified age), null (session cookie), or undefined (must call setMaxAge before saving data)"),this.__name=a.name,this.__maxAge=a.maxAge,this.__enabled=a.enabled,this._data=this._read(a.types)},setMaxAge:function(t){function s(){g.__lastMaxAgeUpdate=d,g.__maxAge=t,g._save()}e.checkArgs(arguments)(i.Or(n,i.Null));var o,r,g=this,l=g.__maxAge,d=a.now()/1e3;void 0===l||null!==l&&null===t?s():(o=g.__lastMaxAgeUpdate+g.__maxAge,r=d+t,Math.abs(o-r)>_&&s())},_read:function(t){var i=e.storage.get(this.__name),n=i?a.deparam(i):{},s={};return a.each(n,function(e,a){var i,n=t[e]||t._;n&&(i=n.fromString(a),void 0!==i&&(s[e]=i))}),s},_save:function(){void 0===this.__maxAge?s.error("Attempted to save cookie data without a max age"):this.__enabled?e.storage.set(this.__name,a.param(this._data),null===this.__maxAge?void 0:this.__maxAge):(s.warn("Storage for ["+this.__name+"] is disabled, but the software attempted to write to it ["+a.param(this._data)+"]. This may result in degraded or missing functionality."),e.storage["delete"](this.__name))},_data:null,__name:null,__maxAge:void 0,__lastMaxAgeUpdate:void 0,__enabled:null});e.add("CookieData",o)}(TFCApp);
"use strict";!function(t){var e,s=t.util,n=t.Constants.UserSettings,a=t.type,i={},r={};i[n.DiscoveryIntroMessageViewed]={type:a.Boolean,defval:!1},i[n.DiscoveryExitSuppressed]={type:a.Boolean,defval:!1},i[n.SessionParams]={type:a.String,defval:""},s.each(i,function(t,e){r[t]=e.type}),e=t.CookieData.extend({_constructor:function(e){this._super({name:t.utility.Storage.keys.UserSettings,enabled:e,types:r})},get:function(e){t.checkArgs(arguments)(a.String);var s=this._data[e],n=r[e],o=i[e].defval;if(void 0===o)throw"Attempt to retrieve a user setting that does not exist";return n.test(s)?s:o},set:function(e,s){var n=r[e];if(!n)throw"Attempt to save a user setting that does not exist";t.checkArgs(arguments)(a.String,n),this._data[e]=s,this._save()},getAllExceptSessionParams:function(){var t=this,e={};return s.each(n,function(s,a){a!==n.SessionParams&&(e[a]=t.get(a))}),e}}),e.keys=n,t.add("UserSettings",e)}(TFCApp);
"use strict";!function(e,i,t){var n,r=767,s=e.util,o=e.type,c=e.utility.Logger.getLogger("DeviceResolver"),d=e.Constants.DeviceType,a=[d.Desktop,d.Mobile];n=e.Class.extend({_constructor:function(t){e.checkArgs(arguments)(o.String.optional());var n=this;try{n._screenSizeQuery=i.matchMedia("(max-width: "+r+"px)")}catch(l){log.warn("Error trying to use matchMedia: ",l," Using the window width instead")}s.containsVal(a,t)?n.__deviceType=t:t===d.Responsive?c.info("Responsive device type resolving based on screen size."):t&&c.error("Invalid device type passed resolving based on screen size. [deviceType =  "+t+"]")},get:function(){var e=this;if(e.__deviceType)return e.__deviceType;if(e._screenSizeQuery)return e._screenSizeQuery.matches?d.Mobile:d.Desktop;var n=i.innerWidth||t.documentElement.clientWidth||t.body.clientWidth;return r>=n?d.Mobile:d.Desktop},__deviceType:null,__screenSizeQuery:null}),e.add("DeviceResolver",n)}(TFCApp,window,document);
"use strict";!function(e){var n,o=e.util,t=e.type,a=e.Constants.Header,r=e.utility.Http,s=e.utility.Logger.getLogger("TokenHelper"),u=new e.FitRecCookieHelper;n=e.Class.extend({_constructor:function(){this.__guardingToken=!1,this.__tokenCallbacks=[]},guardedTokenCall:function(n){e.checkArgs(arguments)(t.Function);var a=this;u.userToken()?n(o.noop,o.noop):a.__guardingToken?a.__tokenCallbacks.push(n):(a._updateTokenGuard(!0),n(e.bind(a._tokenCallSuccess,a),e.bind(a._tokenCallFailure,a)))},_tokenCallSuccess:function(){var e=this,n=e.__tokenCallbacks;e._updateTokenGuard(!1),e.__tokenCallbacks=[],o.each(n,function(e,n){n(o.noop,o.noop)})},_tokenCallFailure:function(){var e=this;e._updateTokenGuard(!1);var n=e.__tokenCallbacks.shift();n&&e.guardedTokenCall(n)},_updateTokenGuard:function(n){e.checkArgs(arguments)(t.Boolean),this.__guardingToken=n},withToken:function(e,n,t,i,l){this.guardedTokenCall(function(k,c){u.userToken()?e():o.retry(function(e,o){r.get({responseType:"json",withCredentials:!0,serviceSecureUrl:n+"/profile/public/v2/"+t+"/token",success:e,failure:o})},function(n){var t=parseInt(n.getResponseHeader(a.UserTokenMaxAge)),r=n.getResponseHeader(a.UserTokenDomain),s=null===r?void 0:r,i=!!n.getResponseHeader(a.UserTokenSecure);o.isNaN(t)?u.userToken(n.data.token,void 0,s,i):u.userToken(n.data.token,t,s,i),e(),k()},function(){c(),l(),s.error("Unable to receive a new token. "+i)})})},__guardingToken:null,__tokenCallbacks:null}),e.add("tokenHelper",new n)}(TFCApp);
"use strict";!function(e,r,t){function o(e,r,t,o,n){var i=P.userToken(),a=null===i?void 0:i,c=t?t:{};g.addParamIfNonZeroLengthString(c,p.UserToken,a),g.retry(function(t,n){f.post({serviceSecureUrl:e,withCredentials:!0,queryParameters:r,headers:c,data:o,success:t,failure:n})},function(){S.info(n+" was successful")},function(){S.error(n+" failed")})}function n(e){var t={};g.addParamIfNonZeroLengthString(t,l.ServiceMode,U[l.ServiceMode]),e.storeTla=r.storeTla,o(T,t,{},e,"Tracking Line Items return request")}function i(e){var r={},t={},n={},i=e.locale?e.locale:U[l.Locale];g.addParamIfNonZeroLengthString(r,l.ServiceMode,U[l.ServiceMode]),g.addParamIfNonZeroLengthString(r,l.Locale,i),g.addParamIfNonZeroLengthString(t,p.StoreUserId,e.userId),n.orderId=e.orderId,n.deviceType=w.get(),n.integrationPlatform=u.Web,n.widgetHidden=e.widgetHidden,n.storeExperimentKey=e.storeExperimentKey,n.checkoutType="LineItem",n.products=e.products,o(L,r,t,n,"Tracking Line Items checkout request")}function a(e){var r={},n={},i={},a=e&&e.locale?e.locale:U[l.Locale];g.addParamIfNonZeroLengthString(r,l.ServiceMode,U[l.ServiceMode]),g.addParamIfNonZeroLengthString(r,l.Locale,a),e&&(g.addParamIfNonZeroLengthString(n,p.StoreUserId,e.userId),i.widgetHidden=e.widgetHidden,i.storeExperimentKey=e.storeExperimentKey),i.deviceType=w.get(),i.integrationPlatform=u.Web,i.referrerUri=t.referrer,o(R,r,n,i,"Site Wide Tracking request")}var c=!!e.trackerService;if(!c){var s=e.utility,d=s.StorageFactory,g=e.util,l=e.Constants.RequestParameter,u=e.Constants.IntegrationPlatform,p=e.Constants.Header,S=s.Logger.getLogger("Tracker"),f=s.Http,I=e.type,k=["checkout","return","session"],v="/consumer/ui/",m="/tracker/",y=v+r.storeTla+m,T=r.trackerSecureURI+y+"track-return",h=r.serviceSecureURI+"/profile/public/v2/"+r.storeTla,L=h+"/checkout",R=h+"/analytics/tracking",U=tfc_parseScriptQueryParams(/fitrec.*tracker\.js/);e.add("storage",d.cookieBased({}));var E=new e.UserSettings(!0),P=new e.FitRecCookieHelper(E),w=new e.DeviceResolver(U[l.DeviceType]);e.add("cookieHelper",P),s.Logger.registerLoggingEngine(new s.HttpLoggerEngine({secureUri:r.serviceSecureURI,tla:r.storeTla},P));var H=function(){this.__track=function(t,o){e.checkArgs(arguments)(I.String,I.Or(I.Object({locale:I.String,userId:I.String.optional(),orderId:I.String,widgetHidden:I.Boolean.optional(),storeExperimentKey:I.String.optional(),products:I.ArrayOf(e.type.Object({productId:I.String,colorId:I.String.optional(),quantity:I.Integer,price:I.Number,currency:I.String,size:I.String.optional(),sku:I.String.optional(),salesGroup:I.String.optional(),returnReason:I.String.optional()}))}),I.Object({userId:I.String.optional(),locale:I.String.optional(),widgetHidden:I.Boolean.optional(),storeExperimentKey:I.String.optional()}).optional())),g.containsVal(k,t)?e.tokenHelper.withToken(function(){"session"===t?a(o):"checkout"===t?i(o):"return"===t&&n(o)},r.serviceSecureURI,r.storeTla,"Unable to complete the call for tracking "+t,g.noop):S.error("Invalid tracking type passed to the True Fit track API ["+t+"]")}};e.trackerService=new H,e.tfcapiSetup(!1)}}(TFCApp,{serviceSecureURI:"https://consumer.truefitcorp.com",trackerSecureURI:"https://consumer.truefitcorp.com",storeTla:"fvr"},document);