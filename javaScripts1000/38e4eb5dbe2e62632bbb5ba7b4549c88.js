var sh_search_bar=$("#search-bar");var sh_header_search_box=$(".headerSearchBox");var search_history={max_input_length:50,arrow_key_pressed:false,printable_key_pressed:false,enter_key_pressed:false,backspace_key_pressed:false,search_box_clicked:false,enter_on_textbox_pressed:false,initial_search_box_click:false,initial_arrow_key_press:false,row_clicked:false,key:shIsEmptyOrNull($("html").attr("lang"))==true?"searchHistory_en":"searchHistory_"+$("html").attr("lang"),last_active_row:null,category_val:"",category:"",holder:$('<div class="as-results" id="searchHistoryHolder"></div>'),ul:$('<ul class="as-list" style="padding:0px;width:100%;border:0;margin-top:-0.5px"></ul>'),header:$('<li class="header"><span class="AS-header"></span></li>'),storage:{searchTerm:[]},rand_nums:[],loadSearchHistory:function(){try{if(localStorage.getItem(search_history.key)!=null){search_history.storage=JSON.parse(localStorage.getItem(search_history.key))
}else{localStorage.setItem(search_history.key,JSON.stringify(search_history.storage))}}catch(a){}},populateSearchHistoryList:function(){try{var g=$('<button type="button" class="close remove-search-item"><i class="fa fa-times" aria-hidden="true"></i></button>');var e=search_history.storage.searchTerm;var c,b;search_history.rand_nums=shGenerateRandNums(e.length);for(var d=e.length-1;d>=0;d--){c=search_history.rand_nums[d];g.attr("id","removeSearchItem"+c);g.attr("aria-label","Remove "+e[d]);b=$('<li class="as-result-item" style="padding-top:4px;padding-bottom:4px;" id="searchLi'+c+'"><a class="link">'+e[d]+"</a>"+g[0].outerHTML+"</li>");
search_history.header.after(b)}var a=$("#search-bar").width()-40;$("[id^='searchLi'] a",search_history.holder).css({display:"inline-block",width:(a+"px"),overflow:"hidden","text-overflow":"ellipsis"})}catch(f){}},addToSearchHistory:function(b,d){try{if(!shIsEmptyOrNull(b)&&b.length<=search_history.max_input_length){var c=-1;for(var e=0;e<search_history.storage.searchTerm.length;e++){if(shEqualsIgnoreCase(search_history.storage.searchTerm[e],b)){c=e;break}}if(c>-1){search_history.storage.searchTerm.splice(c,1);
var a=c+1;if(d&&!search_history.arrow_key_pressed&&search_history.printable_key_pressed){search_history.category_val=$("input[name=ScopeSelection]",sh_search_bar).val();search_history.category=sh_search_bar.find("[data-value='"+search_history.category_val+"']").attr("eng");GaEvent("Search History Bypassed",search_history.category+"|"+b,a.toString(),a)}if(d&&search_history.arrow_key_pressed&&!search_history.printable_key_pressed){GaEvent("Search History Prefill Search",b,a.toString(),a)}}while(search_history.storage.searchTerm.length>=MAX_HISTORY_SIZE){search_history.storage.searchTerm.pop()
}search_history.storage.searchTerm.unshift(b);localStorage.setItem(search_history.key,JSON.stringify(search_history.storage))}}catch(f){}},displaySearchHistory:function(){try{var a=$("li",search_history.holder);if(search_history.getLength()>0){search_history.holder.show();a.removeClass("active");$(search_history.holder).css({width:($("#search-bar").width()+"px"),height:($("#searchHistoryHolder ul.as-list").height()+2+"px")})}else{search_history.holder.hide()}}catch(b){}},moveSelection:function(f){try{if(search_history.holder.is(":visible")){var a=$("li",search_history.holder);
var c=a.filter(".as-result-item, .as-result-item active");var g,e;if(f=="down"){g=c.eq(0)}else{g=c.filter(":last")}var d=$("li.active:first",search_history.holder);if(d.length>0){if(f=="down"){g=d.next();if((g.index())<(d.last().index())){$(search_history.ul).scrollTop(1)}}else{g=d.prev();if(g.length==0){g=c.filter(":last")}}}a.removeClass("active");g.addClass("active");if(g.find("a")[0]){e=g.find("a").text();$("input.headerSearchBox").val(e);search_history.last_active_row=g}else{$("input.headerSearchBox").val("")
}}}catch(b){}},removeFromSearchHistory:function(e){try{var c=$("#searchLi"+e+" a").text();var a=search_history.storage.searchTerm.indexOf(c);if(a>-1){search_history.storage.searchTerm.splice(a,1);localStorage.setItem(search_history.key,JSON.stringify(search_history.storage));var d=$("#searchLi"+e);d.remove();search_history.displaySearchHistory()}}catch(b){}},getLength:function(){try{return JSON.parse(localStorage.getItem(search_history.key)).searchTerm.length}catch(a){return 0}}};$(function(){search_history.header.find("span").attr("aria-label",SH_HEADER).text(SH_HEADER);
search_history.holder.hide();search_history.ul.append(search_history.header);search_history.holder.append(search_history.ul);sh_search_bar.append(search_history.holder);search_history.loadSearchHistory();search_history.populateSearchHistoryList();sh_header_search_box.on("click",function(){try{if(sh_header_search_box.val().length==0){search_history.displaySearchHistory();search_history.category_val=$("input[name=ScopeSelection]",sh_search_bar).val();search_history.category=sh_search_bar.find("[data-value='"+search_history.category_val+"']").attr("eng");
if(CLICK_SEARCH_BOX_GA_FLAG&&!search_history.initial_search_box_click){var a=search_history.getLength()>0?"Search History Shown":"Search History Empty";GaEventCustom("Search Box Clicked","Top",a,search_history.getLength(),{dimension57:"Top|"+search_history.category});search_history.initial_search_box_click=true}}}catch(b){}}).on("keydown",function(c){try{switch(c.keyCode){case 38:c.preventDefault();if(!search_history.initial_arrow_key_press&&search_history.getLength()>0){GaEvent("Search History Prefill",search_history.getLength().toString(),search_history.getLength().toString(),search_history.getLength());
search_history.initial_arrow_key_press=true}search_history.arrow_key_pressed=true;search_history.moveSelection("up");break;case 40:c.preventDefault();if(!search_history.initial_arrow_key_press&&search_history.getLength()>0){GaEvent("Search History Prefill",search_history.getLength().toString(),search_history.getLength().toString(),search_history.getLength());search_history.initial_arrow_key_press=true}search_history.arrow_key_pressed=true;search_history.moveSelection("down");break;case 13:if(search_history.holder.is(":visible")){var b=$("li.active:first",search_history.holder);
if(b.length>0){c.preventDefault();if(b.find("a").length>0){search_history.enter_key_pressed=true;GaEvent("Search History Click Enter",b.find("a").text(),b.index().toString(),b.index());b.trigger("click")}search_history.holder.hide()}}break;default:if(c.keyCode==8){search_history.backspace_key_pressed=true}else{if((c.keyCode>47&&c.keyCode<58)||(c.keyCode==32)||(c.keyCode>64&&c.keyCode<91)||(c.keyCode>95&&c.keyCode<112)||(c.keyCode>185&&c.keyCode<193)||(c.keyCode>218&&c.keyCode<223)){search_history.printable_key_pressed=true
}}break}}catch(a){}});$("input.headerSearchBox").on("input propertychange",function(){try{if(shIsEmptyOrNull(this.value)){search_history.displaySearchHistory();search_history.printable_key_pressed=false;search_history.arrow_key_pressed=false;search_history.backspace_key_pressed=false}else{search_history.holder.hide()}}catch(a){}});$(".form-control-clear",sh_search_bar).on("click",function(){setTimeout(function(){search_history.displaySearchHistory()},2);search_history.printable_key_pressed=false;search_history.arrow_key_pressed=false;
search_history.backspace_key_pressed=false});$("[id^='searchLi']",search_history.holder).on("mouseover",function(){try{search_history.ul.find(".active").removeClass("active");$(this).addClass("active")}catch(a){}});$("[id^='searchLi']",search_history.holder).on("click",function(){try{search_history.row_clicked=true;var c=$(this).find("a").text();var a=$(this).index();if(!search_history.enter_key_pressed){GaEvent("Search History Clicked",c,a.toString(),a)}$("input.headerSearchBox").val(c);search_history.addToSearchHistory(c,false);
$("#hdrSrch",sh_search_bar).trigger("click")}catch(b){}});$("[id^='removeSearchItem']",search_history.holder).on("click",function(d){try{d.stopPropagation();var f=this.id.substring(16);var c=$(this).parent().find("a").text();var a=$(this).parent().index();GaEvent("Search History Cleared",c,a.toString(),a);search_history.removeFromSearchHistory(f)}catch(b){}});$(".remove-search-item").css({top:"0",right:"0","z-index":"2",display:"block",width:"32px",height:"32px","text-align":"center",position:"relative","font-size":"13px","margin-top":"-2px"});
$("input.headerSearchBox").on("keydown",function(a){if(a.keyCode==13){search_history.enter_on_textbox_pressed=true}});$("#hdrSrch",sh_search_bar).on("click",function(){try{if(!search_history.row_clicked){if(!search_history.enter_on_textbox_pressed){search_history.category_val=$("input[name=ScopeSelection]",sh_search_bar).val();search_history.category=sh_search_bar.find("[data-value='"+search_history.category_val+"']").attr("eng");if(CLICK_SEARCH_BUTTON_GA_FLAG){var a=search_history.getLength()>0?"Search History Shown":"Search History Empty";
GaEventCustom("Search Button Clicked","Top",a,search_history.getLength(),{dimension57:"Top|"+search_history.category})}}var b=sh_header_search_box.val();if(!shIsEmptyOrNull(b)){b=b.trim();search_history.addToSearchHistory(b,true)}if(search_history.arrow_key_pressed&&(search_history.printable_key_pressed||search_history.backspace_key_pressed)&&!shIsEmptyOrNull(b)&&typeof search_history.last_active_row!="undefined"){GaEvent("Search History Prefill Modified Search",b,search_history.last_active_row.index().toString(),search_history.last_active_row.index())
}}}catch(c){}});$(window).on("resize",function(){$(search_history.holder).css({width:($("#search-bar").width()+"px"),});var a=$("#search-bar").width()-40;$("[id^='searchLi'] > a ").css({display:"inline-block",width:(a+"px"),overflow:"hidden","text-overflow":"ellipsis"})})});function shGenerateRandNums(c){var b,a=[];do{do{b=Math.floor(Math.random()*100)}while(a.some(function(d){return d==b}));a.push(b)}while(a.length<c);return a}function shIsEmptyOrNull(a){return(a==null||a.length===0)}function shEqualsIgnoreCase(b,a){return b.toUpperCase()===a.toUpperCase()
};