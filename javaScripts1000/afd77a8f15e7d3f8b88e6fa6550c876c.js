(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{14:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return _}));var i=n(2),a=n(3),r=n(0),o=n(4),s=n(15);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g(e);if(t){var a=g(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return p(this,n)}}function p(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?v(e):t}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function f(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=new i.a("LINEAR-JSVPAID"),A=function(){function e(t){h(this,e),y(this,"loader",void 0),y(this,"vpaid",void 0),y(this,"_timer",void 0),y(this,"containerWidth",void 0),y(this,"containerHeight",void 0),w.debug("JS playback");var n=this;n.loader=t,n.vpaid=t.vpaid,n._timer=null}return f(e,[{key:"videoStarted",value:function(){}},{key:"durationChanged",value:function(){var e=this;w.info("Ad duration changed",{remainingTime:e.vpaid.getAdRemainingTime(),duration:e.vpaid.getAdDuration()}),e.loader.duration<=0&&(e.loader.sourceChanged=!0,e.loader.duration=e.loader.vpaid.getAdDuration(),e.loader._dispatchEvent(a.a.Media.Event.DURATION_CHANGE,e.loader.duration),window.BoltAdManager._dispatchEvent(a.a.Media.Event.PLAYING),e._timer=setInterval((function(){e._updateTime()}),50))}},{key:"_updateTime",value:function(){this.loader._setCurrentTime(this.getCurrentTime())}},{key:"getCurrentTime",value:function(){return this.loader.duration>0?this.loader.duration-this.vpaid.getAdRemainingTime():0}},{key:"setVolume",value:function(e){this.volume=e,0!==this.volume&&1!==this.volume?(this.vpaid&&(this.vpaid.adVolume&&(this.vpaid.adVolume=e),this.vpaid.setAdVolume(e)),this._dispatchEvent(a.a.UI.Event.CHANGE_VOLUME,e)):this.mute(!!e)}},{key:"destroy",value:function(){clearInterval(this._timer)}}]),e}(),b=function(){function e(t){h(this,e),y(this,"loader",void 0),w.debug("Native playback");var n=this;n.loader=t,n._onVideoMetadata=n._onVideoMetadata.bind(n),n._onVideoEnded=n._onVideoEnded.bind(n),n._onVideoTimeupdate=n._onVideoTimeupdate.bind(n),n._onVideoPaused=n._onVideoPaused.bind(n),n._onVideoPlaying=n._onVideoPlaying.bind(n),n._onVideoError=n._onVideoError.bind(n),window.BoltAdManager.videoElement.addEventListener("loadeddata",n._onVideoMetadata),window.BoltAdManager.videoElement.addEventListener("ended",n._onVideoEnded),window.BoltAdManager.videoElement.addEventListener("pause",n._onVideoPaused),window.BoltAdManager.videoElement.addEventListener("playing",n._onVideoPlaying),window.BoltAdManager.videoElement.addEventListener("error",n._onVideoError)}return f(e,[{key:"videoStarted",value:function(){var e=this;w.info("Video started"),window.BoltAdManager.videoElement.style.visibility="visible",window.BoltAdManager.videoElement.style.display="block",e.loader.sourceChanged=!0,e.loader.duration=window.BoltAdManager.videoElement.duration,e.loader._dispatchEvent(a.a.Media.Event.DURATION_CHANGE,e.loader.duration),e.loader._dispatchEvent(a.a.Media.Event.PLAYING),window.BoltAdManager.videoElement.addEventListener("timeupdate",e._onVideoTimeupdate)}},{key:"durationChanged",value:function(){}},{key:"_onVideoMetadata",value:function(){w.info("Event CB",{evt:"_onVideoMetadata"});window.BoltAdManager.videoElement.removeEventListener("loadedmetadata",this._onVideoMetadata),this.loader.metadata={duration:window.BoltAdManager.videoElement.duration}}},{key:"_onVideoEnded",value:function(){}},{key:"_onVideoPaused",value:function(){}},{key:"_onVideoPlaying",value:function(){}},{key:"_onVideoError",value:function(){window.kinesis.send("bolt_ad_errors",{message:"Ad video error",provider:this.loader.provider,creativeUrl:window.BoltAdManager.bestMedia,tag:window.BoltAdManager._selectedTag,adId:JSON.parse(window.BoltAdManager.ad.linear.parameters).ad_id},"boltAds")}},{key:"_onVideoTimeupdate",value:function(){this.loader._setCurrentTime(this.getCurrentTime())}},{key:"getCurrentTime",value:function(){return window.BoltAdManager.videoElement.currentTime}},{key:"setVolume",value:function(e){window.BoltAdManager.videoElement.volume=e}},{key:"destroy",value:function(){var e=this;window.BoltAdManager.videoElement.removeEventListener("loadedmetadata",e._onVideoMetadata),window.BoltAdManager.videoElement.removeEventListener("ended",e._onVideoEnded),window.BoltAdManager.videoElement.removeEventListener("pause",e._onVideoPaused),window.BoltAdManager.videoElement.removeEventListener("playing",e._onVideoPlaying),window.BoltAdManager.videoElement.removeEventListener("timeupdate",e._onVideoTimeupdate),window.BoltAdManager.videoElement.removeEventListener("error",e._onVideoError),window.BoltAdManager.videoElement.src="",window.BoltAdManager.videoElement.load()}}]),e}(),_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(n,e);var t=u(n);function n(e,i){var r;h(this,n),y(v(r=t.call(this)),"vpaidScript",void 0),y(v(r),"video",void 0),y(v(r),"type",void 0),y(v(r),"creativeData",void 0),y(v(r),"paused",!1),y(v(r),"frame",null),y(v(r),"vpaid",null),y(v(r),"currentTime",null),y(v(r),"duration",null),y(v(r),"sourceChanged",!1),y(v(r),"fullscreen",!1),y(v(r),"volume",0),y(v(r),"muted",!0),y(v(r),"hasStarted",!1),y(v(r),"timer",null),y(v(r),"_firstQuartile",!1),y(v(r),"_midpoint",!1),y(v(r),"_thirdQuartile",!1),y(v(r),"_error",!1),y(v(r),"_adHandler",null),y(v(r),"provider",null),y(v(r),"_nativePlayback",!1),y(v(r),"_autoplayPolicyChecked",!1),y(v(r),"_onAdImpression",(function(e){var t=window.Bolt;t.dispatchEvent(t.BOLT_AD_IMPRESSION,{name:t.BOLT_AD_IMPRESSION}),w.info("Event CB",{evt:"_onAdImpression",value:e,provider:r.provider})}));var o=v(r);return o.video=window.BoltAdManager.videoElement,o.type=a.a.Ad.Type.JS_VPAID,o.creativeData=i,o.muted=!0,window.BoltAdManager.VpaidSdk={},window.BoltAdManager.VpaidSdk.stickyResize=o.stickyResize.bind(o),o._setNativePlayback=o._setNativePlayback.bind(o),void 0!==document.visibilityState&&(o._handleVisibilityChange=o._handleVisibilityChange.bind(o)),o._onAdLoaded=o._onAdLoaded.bind(o),o._onAdStarted=o._onAdStarted.bind(o),o._onAdStopped=o._onAdStopped.bind(o),o._onAdError=o._onAdError.bind(o),o._onAdLog=o._onAdLog.bind(o),o._onAdClick=o._onAdClick.bind(o),o._onAdVideoStart=o._onAdVideoStart.bind(o),o._onAdDurationChanged=o._onAdDurationChanged.bind(o),o._onAdPaused=o._onAdPaused.bind(o),o._onAdPlaying=o._onAdPlaying.bind(o),o._onAdFirstQuartile=o._onAdFirstQuartile.bind(o),o._onAdMidpoint=o._onAdMidpoint.bind(o),o._onAdThirdQuartile=o._onAdThirdQuartile.bind(o),o._onAdSkipped=o._onAdSkipped.bind(o),r}return f(n,[{key:"_setNativePlayback",value:function(){this._nativePlayback=!0,window.BoltAdManager.videoElement.removeEventListener("loadstart",this._setNativePlayback)}},{key:"_handleVisibilityChange",value:function(){var e,t=this;(w.info("Event CB",{evt:"handleVisibilityChange",value:document.visibilityState}),"hidden"===document.visibilityState)?window.PlayerView.fullscreenRequested||t.paused||null===(e=t.vpaid)||void 0===e||e.pauseAd():t.paused&&t.vpaid.resumeAd()}},{key:"playAd",value:function(){var e=this;w.info("Play ad",{provider:e.provider,func:"playAd"}),window.postLogMessage("Loading ".concat(e.provider," JS VPAID"));var t=a.a.Ad.PLAYER_ID_PREFIX+window.BoltAdManager.containerId;window.client.isMobile?(window.BoltAdManager.videoElement||(window.BoltAdManager.videoElement=document.createElement("video"),w.warn("Video element is undefined")),window.BoltAdManager.videoElement.setAttribute("width",e.container.clientWidth),window.BoltAdManager.videoElement.setAttribute("height",e.container.clientHeight),window.BoltAdManager.videoElement.setAttribute("style","position:absolute;top:0;left:0;bottom:0;right:0;height:".concat(e.container.clientHeight,"px;width:").concat(e.container.clientWidth,"px")),e.containerWidth=e.container.clientWidth,e.containerHeight=e.container.clientHeight,e._nativePlayback=!0):(window.BoltAdManager.videoElement=document.createElement("video"),window.BoltAdManager.videoElement.setAttribute("id",t),window.BoltAdManager.videoElement.setAttribute("width",e.container.clientWidth),window.BoltAdManager.videoElement.setAttribute("height",e.container.clientHeight),window.BoltAdManager.videoElement.setAttribute("style","position:absolute;top:0;left:0;bottom:0;right:0;height:".concat(e.container.clientHeight,"px;width:").concat(e.container.clientWidth,"px")),e.containerWidth=e.container.clientWidth,e.containerHeight=e.container.clientHeight,e.container.appendChild(window.BoltAdManager.videoElement),window.BoltAdManager.videoElement.addEventListener("loadstart",e._setNativePlayback)),e._createVPAID()}},{key:"pauseAd",value:function(){var e;null===(e=this.vpaid)||void 0===e||e.pauseAd()}},{key:"stickyResize",value:function(e,t){var n=this,i=n.container.querySelector("iframe"),a=n.container.querySelector("video");n.container&&(n.container.style.width="".concat(e,"px"),n.container.style.height="".concat(t,"px")),i&&(i.style.width="".concat(e,"px"),i.style.height="".concat(t,"px"),i.width=e,i.height=t),a&&(a.style.width="".concat(e,"px"),a.style.height="".concat(t,"px"),a.width=e,a.height=t)}},{key:"initHeavyAdListener",value:function(){var e=document.createElement("script");e.innerHTML="\n            // Example to simulate heavy ad intervention\n            // const img = document.createElement('img');\n            // img.src = 'http://www.rickygervais.com/images/2562_GERVAIS_SCIENTIST-0225.jpg';\n            // document.body.appendChild(img);\n\n            function sendReports(reports) {\n                for (let report of reports) {\n                    // Log the 'report' json via your own reporting process\n                    const data = {};\n                    // id for us to recognize message outside of the iframe\n                    data.id = 'pwHeavyAdIntervention';\n                    // Distinguish Bolt so it doesn't double log with tyche display ads\n                    data.product = 'bolt';\n                    // Actual report data\n                    data.report = JSON.stringify(report);\n                    // Post message outside of iframe\n                    window.parent.postMessage(JSON.stringify(data), '*');\n                }\n            }\n            const observer = new ReportingObserver((reports, observer) => {\n                sendReports(reports);\n            }, { buffered: true });\n            observer.observe();\n            window.addEventListener('pagehide', (event) => {\n                let reports = observer.takeRecords();\n                sendReports(reports);\n            });\n            ";var t=window.id;window.addEventListener("message",(function(e){try{var n=JSON.parse(e.data),i=JSON.parse(n.report);if("pwHeavyAdIntervention"===n.id&&"bolt"===n.product&&"intervention"===i.type&&"HeavyAdIntervention"===i.body.id){var a,o,s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({product:n.product,type:"heavyAd",id:n.id,url:i.url,ad:!0,content:!1,campaignId:null===(a=window.BoltAdManager)||void 0===a?void 0:a.campaignId,adType:null===(o=window.BoltAdManager)||void 0===o?void 0:o.provider,reportType:i.type},i.body),d={id:t,type:"heavyAd",msgData:s};w.debug("[LinearJSVPAID] receiving heavy-ad message from VPAID"),window.parent.postMessage(JSON.stringify(d),Object(r.h)())}}catch(e){}})),this.frame.contentWindow.document.body.appendChild(e)}},{key:"_createVPAID",value:function(){var e=this,t=e.container;e.frame=document.createElement("iframe"),e.frame.setAttribute("allow","autoplay; fullscreen"),e.frame.id="pw_ad_iframe",e.frame.frameBorder=0,e.frame.allowfullscreen=!0,e.frame.style.display="none",e.frame.onload=function(){var t=e.frame.contentWindow.document.createElement("script");e.vpaidScript=t,t.src=window.BoltAdManager.bestMedia.src,Object(o.b)(e.container),t.onload=function(){e.vpaid=e.frame.contentWindow.getVPAIDAd(),e.vpaid.handshakeVersion("2.0"),e.vpaid.subscribe(e._onAdLoaded,"AdLoaded"),e.vpaid.subscribe(e._onAdStarted,"AdStarted"),e.vpaid.subscribe(e._onAdImpression,"AdImpression"),e.vpaid.subscribe(e._onAdStopped,"AdStopped"),e.vpaid.subscribe(e._onAdError,"AdError"),e.vpaid.subscribe(e._onAdLog,"AdLog"),e.vpaid.subscribe(e._onAdClick,"AdClickThru"),e.vpaid.subscribe(e._onAdVideoStart,"AdVideoStart"),e.vpaid.subscribe(e._onAdDurationChanged,"AdDurationChange"),e.vpaid.subscribe(e._onAdPaused,"AdPaused"),e.vpaid.subscribe(e._onAdPlaying,"AdPlaying"),e.vpaid.subscribe(e._onAdSkipped,"AdSkipped"),e.creativeData=e._getCreativeData(),e.environmentVars=e._getEnvironmentVars(),w.debug("Creative data",e.creativeData),w.debug("Environment vars",e.environmentVars),e.vpaid.initAd(window.BoltAdManager.videoElement.offsetWidth,window.BoltAdManager.videoElement.offsetHeight,"normal",600,e.creativeData,e.environmentVars)},window.client.browser.chrome&&e.initHeavyAdListener(),e.frame.contentDocument.body.style.margin="0px",e.frame.contentDocument.body.style.cursor="pointer",e.frame.contentWindow.document.body.appendChild(t)},t.appendChild(e.frame)}},{key:"_getEnvironmentVars",value:function(){return{slot:window.BoltAdManager.container,videoSlot:window.BoltAdManager.videoElement,videoSlotCanAutoPlay:!0}}},{key:"_getCreativeData",value:function(){return{AdParameters:this.creativeData}}},{key:"_onAdLoaded",value:function(){w.info("Event CB",{evt:"_onAdLoaded",provider:this.provider});var e=this;window.BoltAdManager._dispatchEvent(a.a.Media.Event.LOADED),e._dispatchEvent(a.a.Media.Event.DURATION_CHANGE),e._dispatchEvent(a.a.Media.Event.START_TIME_CHANGED),!1!==window.CurrentVideoConfig.settings.autoplay&&(window.BoltAdManager.videoElement.muted=!0),e.vpaid.startAd()}},{key:"_onAdStarted",value:function(){var e=this;w.info("Event CB",{evt:"_onAdStarted",provider:this.provider}),e.vpaid.unsubscribe(this._onAdStarted,"AdStarted"),Object(o.f)(e.container),e._adHandler||(!0===e._nativePlayback?e._adHandler=new b(e):!1===e._nativePlayback&&(e._adHandler=new A(e)))}},{key:"_onAdVideoStart",value:function(){var e=this,t=window.Bolt;e._adHandler||(!0===e._nativePlayback?e._adHandler=new b(e):!1===e._nativePlayback&&(e._adHandler=new A(e))),w.info("Event CB",{evt:"_onAdVideoStart",provider:this.provider}),e.vpaid.unsubscribe(e._onAdVideoStart,"AdVideoStart"),e.playing=!0,e.pause=!1,e._trackCreativeView(),window.BoltAdManager._dispatchEvent(a.a.Media.Event.LOADED),e._dispatchEvent(a.a.Media.Event.PLAY),e._adHandler.videoStarted(),t.dispatchEvent(t.BOLT_AD_VIDEO_START,{name:t.BOLT_AD_VIDEO_START}),void 0!==document.visibilityState&&(window.document.addEventListener("visibilitychange",e._handleVisibilityChange),"hidden"===window.document.visibilityState&&e.pauseAd())}},{key:"_onAdDurationChanged",value:function(){this._adHandler&&this._adHandler.durationChanged()}},{key:"_onAdStopped",value:function(){w.info("Event CB",{evt:"_onAdStopped",provider:this.provider});var e=this;e._error||(window.BoltAdManager._adPlays>=window.prerollAdAmt&&e._dispatchEvent(a.a.Media.Event.ENDED),window.BoltAdManager.ad.linear.track("complete"),clearInterval(e.timer),window.BoltAdManager._dispatchEvent(a.a.Media.Event.ENDED))}},{key:"_onAdPaused",value:function(){var e=window.Bolt;w.info("Event CB",{evt:"_onAdPaused",provider:this.provider}),this.paused=!0,window.BoltAdManager._dispatchEvent(a.a.Media.Event.PAUSED),e.dispatchEvent(e.BOLT_AD_PAUSED,{name:e.BOLT_AD_PAUSED})}},{key:"_onAdPlaying",value:function(){var e=window.Bolt;w.info("Event CB",{evt:"_onAdPlaying",provider:this.provider}),this.paused=!1,e.dispatchEvent(e.BOLT_AD_PLAYING,{name:e.BOLT_AD_PLAYING})}},{key:"_trackCreativeView",value:function(){w.info("JS VPAID trackCreativeView",{func:"_trackCreativeView",provider:this.provider}),window.BoltAdManager.ad.linear.track("creativeView"),window.BoltAdManager.ad.linear.trackImpressions(),window.BoltAdManager.ad.linear.track("start"),this.hasStarted=!0}},{key:"_setCurrentTime",value:function(e){var t=this;t.currentTime=e,t._dispatchEvent(a.a.Media.Event.TIME_UPDATE,t.currentTime),t._checkQuartiles()}},{key:"_onAdError",value:function(e,t){w.warn("Event CB",{evt:"_onAdError",value:{msg:e,id:t},provider:this.provider}),"string"==typeof e?window.postLogMessage("Ad Error. ".concat(this.provider," JS VPAID says ").concat(e),"error"):window.postLogMessage("Ad Error. ".concat(this.provider," JS VPAID failed to play"),"error"),window.kinesis.send("bolt_ad_errors",{message:e,serverType:window.BoltAdManager.selectedServer.type,provider:this.provider,creativeUrl:window.BoltAdManager.bestMedia,tag:window.BoltAdManager._selectedTag,adId:JSON.parse(window.BoltAdManager.ad.linear.parameters).ad_id,vastDoc:window.BoltAdManager.vastDoc},"boltAds"),this._error=!0,this.remove(),this._dispatchEvent(a.a.ERROR,e)}},{key:"_checkQuartiles",value:function(){var e=this;e._firstQuartile?e._midpoint?e._thirdQuartile||e.currentTime/e.duration>.75&&(e._thirdQuartile=!0,e._onAdThirdQuartile()):e.currentTime/e.duration>.5&&(e._midpoint=!0,e._onAdMidpoint()):e.currentTime/e.duration>.25&&(e._firstQuartile=!0,e._onAdFirstQuartile())}},{key:"_onAdFirstQuartile",value:function(){w.info("Event CB",{evt:"_onAdFirstQuartile",provider:this.provider}),this._dispatchEvent(a.a.Media.Event.FIRSTQUARTILE),window.BoltAdManager._dispatchEvent(a.a.Media.Event.FIRSTQUARTILE),window.BoltAdManager.ad.linear.track("firstQuartile")}},{key:"_onAdMidpoint",value:function(){w.info("Event CB",{evt:"_onAdMidpoint",provider:this.provider}),this._dispatchEvent(a.a.Media.Event.MIDPOINT),window.BoltAdManager._dispatchEvent(a.a.Media.Event.MIDPOINT),window.BoltAdManager.ad.linear.track("midpoint")}},{key:"_onAdThirdQuartile",value:function(){w.info("Event CB",{evt:"_onAdThirdQuartile",provider:this.provider}),this._dispatchEvent(a.a.Media.Event.THIRDQUARTILE),window.BoltAdManager._dispatchEvent(a.a.Media.Event.THIRDQUARTILE),window.BoltAdManager.ad.linear.track("thirdQuartile")}},{key:"_onAdSkipped",value:function(){w.info("Event CB",{evt:"_onAdSkipped",provider:this.provider}),window.BoltAdManager._dispatchEvent(a.a.Ad.Event.SKIPPED),this._onAdStopped()}},{key:"_onAdClick",value:function(){w.info("Event CB",{evt:"_onAdClick",provider:this.provider});var e=window.BoltAdManager.ad.linear,t=[];try{t=e.tracking.events.click}catch(e){}if(Array.isArray(t)&&t.length>0)for(var n=0;n<t.length;n++){var i=t[n].url;w.debug("tracking click",i),Object(r.F)({url:i,method:"get"})}window.BoltAdManager._dispatchEvent("clicked"),window.Zeus.dispatchEvent(a.a.Ad.Event.CLICKED)}},{key:"_onAdLog",value:function(e){window.postLogMessage("[JSVPAID AdLog Event] - ".concat(e)),w.info("Event CB",{evt:"_onAdLog",provider:this.provider,value:e})}},{key:"pause",value:function(){this.pauseAd()}},{key:"resume",value:function(){this.vpaid&&this.vpaid.resumeAd()}},{key:"getDuration",value:function(){return this.duration}},{key:"getCurrentTime",value:function(){return this.vpaid?this._adHandler.getCurrentTime():0}},{key:"setVolume",value:function(e){if(!window.client.isMobile||window.client.system.android)try{this.volume=e,this._dispatchEvent(a.a.Media.Event.VOLUME_CHANGED,this.volume),this._adHandler.setVolume(e)}catch(e){}}},{key:"getSource",value:function(){return window.BoltAdManager.videoElement.currentSrc||this.media}},{key:"_removeAssets",value:function(){var e=this.container.children;if(e.length>1)for(var t=0;t<e.length;t++){var n=e[t];n!==window.BoltAdManager.videoElement&&this.container.removeChild(n)}}},{key:"_removeVideoElement",value:function(){if(window.client.isMobile)window.client.system.ios&&window.PlayerView.fullscreen&&window.BoltAdManager.videoElement.webkitExitFullscreen(),this.show(!1),window.BoltAdManager.videoElement.src="",window.BoltAdManager.videoElement.load();else try{window.BoltAdManager.videoElement.parentNode.removeChild(window.BoltAdManager.videoElement)}catch(e){}}},{key:"_unsubscribe",value:function(){var e=this;if(e.vpaid){w.info("unsubs vpaid events");try{e.vpaid.unsubscribe(e._onAdLoaded,"AdLoaded")}catch(e){}try{e.vpaid.unsubscribe(e._onAdStarted,"AdStarted")}catch(e){}try{e.vpaid.unsubscribe(e._onAdStopped,"AdStopped")}catch(e){}try{e.vpaid.unsubscribe(e._onAdError,"AdError")}catch(e){}try{e.vpaid.unsubscribe(e._onAdLog,"AdLog")}catch(e){}try{e.vpaid.unsubscribe(e._onAdClick,"AdClickThrough")}catch(e){}try{e.vpaid.unsubscribe(e._onAdVideoStart,"AdVideoStart")}catch(e){}try{e.vpaid.unsubscribe(e._onAdDurationChanged,"AdDurationChange")}catch(e){}try{e.vpaid.unsubscribe(e._onAdPaused,"AdPaused")}catch(e){}}}},{key:"remove",value:function(){w.info("Remove ad");var e=this;if(e._unsubscribe(),void 0!==document.visibilityState&&window.document.removeEventListener("visibilitychange",e._handleVisibilityChange),e._adHandler&&e._adHandler.destroy(),e.vpaid)try{e.vpaid.stopAd()}catch(e){}try{e.container.removeChild(e.frame)}catch(e){}e._removeAssets(),e._removeVideoElement()}},{key:"mute",value:function(e){e!==this.muted&&(this.muted=e,e?(window.BoltAdManager.videoElement&&(window.BoltAdManager.videoElement.muted=!0),this.vpaid.setAdVolume(0),this._dispatchEvent(a.a.Media.Event.MUTED)):(window.BoltAdManager.videoElement&&(window.BoltAdManager.videoElement.muted=!1),this.vpaid.setAdVolume(this.volume||1),this._dispatchEvent(a.a.Media.Event.UNMUTED)))}},{key:"setFullscreen",value:function(e){var t=this;e!==this.fullscreen&&(this.fullscreen=e,window.BoltAdManager.videoElement&&(window.BoltAdManager.videoElement.setAttribute("width","".concat(t.container.clientWidth)),window.BoltAdManager.videoElement.setAttribute("height","".concat(t.container.clientHeight)),window.BoltAdManager.videoElement.setAttribute("style","position:absolute;top:0;left:0;bottom:0;right:0;height:".concat(t.container.clientHeight,"px;width:").concat(t.container.clientWidth,"px"))),e?this._dispatchEvent(a.a.Player.Event.ENTER_FULLSCREEN):this._dispatchEvent(a.a.Player.Event.EXIT_FULLSCREEN))}},{key:"stop",value:function(){}},{key:"show",value:function(e){var t=window.BoltAdManager.videoElement;!0===e&&"block"!==t.style.display?(w.debug("Show video",{player:this.containerId}),t.style.display="block"):!1===e&&"none"!==t.style.display&&(w.debug("Hide video",{player:this.containerId}),t.style.display="none")}},{key:"isLinear",value:function(){return!0}}]),n}(s.a)},15:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(12),a=n(3);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=window.BoltAdManager.container,this.containerId=window.BoltAdManager.containerId,this.type=null,this.fullscreen=!1,this._volume=0,this._duration=0,this._currentTime=0,this._isLinear=!0,(new i.a).mixin(this)}var t,n,o;return t=e,(n=[{key:"isAd",value:function(){return!0}},{key:"isLinear",value:function(){return this._isLinear}},{key:"playAd",value:function(){}},{key:"resume",value:function(){}},{key:"pause",value:function(){}},{key:"getDuration",value:function(){return this._duration}},{key:"getCurrentTime",value:function(){return this._currentTime}},{key:"setVolume",value:function(e){}},{key:"getVolume",value:function(){return this._volume}},{key:"mute",value:function(e){}},{key:"setFullscreen",value:function(e){}},{key:"getSource",value:function(){return window.BoltAdManager.bestMedia}},{key:"end",value:function(){window.BoltAdManager._dispatchEvent(a.a.Media.Event.ENDED)}},{key:"remove",value:function(){}},{key:"updateLayout",value:function(){}}])&&r(t.prototype,n),o&&r(t,o),e}()},17:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return p}));var i=n(0),a=n(7),r=new(n(2).a)("SPOTX-UTILS"),o=function(e,t){var n=window.BoltAdManager,a=e,r=function(){if(void 0!==window.gdprConsents)if(/\$(REGS_GDPR|USER_CONSENT)/.test(a))a=Object(i.A)(a);else{var e=/&gdpr=\d{1}/,t=/&gdpr_consent=\d{1}/,n=window.shouldReadGDPRConsents?1:0;void 0!==window.userIsInEU&&!1===window.userIsInEU&&(n=0);var r=window.gdprConsents,o=window.gdprBinary;e.test(a)?a=a.replace(e,"&gdpr=".concat(n)):a+="&gdpr=".concat(n),n&&(t.test(a)?a=a.replace(t,"&gdpr_consent=".concat(r)):a+="&gdpr_consent=".concat(r),a+="&custom[got_consent]=".concat(o))}return a};if(void 0!==window.gdprConsents)n.src=r(),t();else var o=0,s=window.setInterval((function(){(void 0!==window.gdprConsents||o++>2e4)&&(window.clearInterval(s),n.src=r(),t())}),50)},s=function(e){var t,n,a=window.PlayerView.currentPlayer,r=Object(i.n)(),o=r?r.id:null;return e=function(e){var t=window.BoltAdManager;if(void 0!==window.spotxVastVersion&&(e=e.replace("/2.0/","/".concat(window.spotxVastVersion,"/"))),t.selectedServer&&t.selectedServer._getSpotxChannelId()){var n="search.spotxchange.com/vast/",i=n.length+4,a=e.substring(e.indexOf(n)+i,e.indexOf(n)+i+6);return e.replace(a,t.selectedServer._getSpotxChannelId())}return e}(e),e=Object(i.A)((n=-1===(t=e).indexOf("?")?"?":"&","".concat(t).concat(n,"VPAID=js&custom_skin=1&content_page_url=__WEB_URL__&player_width=__WIDTH__&player_height=__HEIGHT__"))),o&&(e+="&x_source.pchain=playwire.com:fcddfba7adc2d929&pchain=playwire.com:fcddfba7adc2d929"+"&schain=1.0,1!playwire.com,".concat(o,",1")),!1===a.muted?e+="&ad_volume=".concat(a.volume.toFixed(2)):Object(i.p)()&&(e+="&ad_volume=0"),e},d=function(e){var t,n,o,s,d,c,l,u,p=window.BoltAdManager,v=window.CurrentVideoConfig,g="precontent"===window.PlayerSettings.playerType,h=Object(i.g)(),m=v.hostingId?v.hostingId:h,f="true";h&&(h=h.toString()),m&&(m=m.toString());try{f=Object(a.e)(p.selectedServer.tags).toString()}catch(e){r.warn("Failed to determine site tag is syndicated or not",{message:e.message,stack:e.stack})}var y=navigator.userAgent.toLowerCase().indexOf("blitz")>=0||"ads.blitz.gg"===window.site.hostname,w=Object(a.b)(),A=window.containerHeight||w.height,b=window.containerWidth||w.width;e+="&custom[campaign_id]=".concat(p.triedCampaigns.length?p.triedCampaigns[p.triedCampaigns.length-1]:"0.0")+"&custom[channel]=".concat(p.selectedServer.spotxChannelId)+"&custom[content_page_url]=".concat("amp"===window.site.hostapp?window.site.href:window.parentBaseUrl)+"&custom[page_full_url]=".concat(y?window.parentBaseUrl:encodeURIComponent(window.site.href.replace(/\#.*$/,"")))+"&custom[player_height]=".concat(A)+"&custom[player_width]=".concat(b)+"&custom[adunit]=".concat(Object(i.e)())+"&custom[device_type]=".concat(window.client.isMobile?"mobile":"desktop")+"&custom[owning_pub_id]=".concat(h||"")+"&custom[player]=".concat(window.id)+"&custom[pub_id]=".concat(m||"")+"&custom[synd]=".concat(f)+"&custom[secure]=".concat(window.location.protocol.indexOf("https")>=0?"true":"false")+"&custom[vid_id]=".concat(Object(i.v)(v,"content","videoId")&&v.content.videoId||"")+"&custom[vpi]=".concat(Object(a.d)().join(","))+"&custom[vid_long_form]=".concat(v.duration>6e5?"true":"false");var _,S,k=p._adSessionCount||0;if(void 0!==window.videoInfo){var E=window.videoInfo;void 0!==E.location&&(e+="&custom[vid_location]=".concat(E.location)),void 0!==E.product&&("slideshow"===E.product&&(k=E.refreshCount||p._adSessionCount),e+="&custom[product]=".concat(E.product)),void 0!==E.sticky&&(e+="&custom[sticky]=".concat(E.sticky)),void 0!==E.trendi&&(e+="&custom[trendi]=".concat(E.trendi))}(e+="&custom[refresh_count]=".concat(k),(null===(t=window.userBehavior)||void 0===t?void 0:t.videoAdClickRate)&&(e+="&custom[video_ad_click_rate]=".concat(window.userBehavior.videoAdClickRate)),(null===(n=window.userBehavior)||void 0===n?void 0:n.videoAdCompletionRate)&&(e+="&custom[video_ad_completion_rate]=".concat(window.userBehavior.videoAdCompletionRate)),window.userBehavior&&"boolean"==typeof window.userBehavior.adClicker&&(e+="&custom[ad_clicker]=".concat(window.userBehavior.adClicker)),window.pageCount&&(e+="&custom[pagecount]=".concat(window.pageCount)),window.tpsABTestKVP)&&(e+="&custom[ab_tps_test_name]=".concat(null===(_=window.tpsABTestKVP)||void 0===_?void 0:_.ab_tps_test_name),e+="&custom[ab_tps_test_case_name]=".concat(null===(S=window.tpsABTestKVP)||void 0===S?void 0:S.ab_tps_test_case_name));window.boltABTesting&&(e+="&custom[ab_test]=".concat(window.boltABTesting.name,"_").concat(window.boltABTesting.type)),(null===(o=p.prebidSettings)||void 0===o?void 0:o.hbTestName)&&(e+="&custom[hb_test]=".concat(p.prebidSettings.hbTestName)),(null===(s=window.CurrentVideoConfig)||void 0===s||null===(d=s.advertising)||void 0===d||null===(c=d.servers[0])||void 0===c?void 0:c.abTestTagType)&&(e+="&custom[ab_server_test]=".concat(window.CurrentVideoConfig.advertising.servers[0].abTestTagType)),e+="&custom[instream]=".concat(Object(i.o)(g)),Object(i.v)(window.tycheData,"features","interstitial","on")&&window.tycheData.features.interstitial.on&&(e+="&custom[product_type]=interstitial"),window.tycheData.customPath&&(e+="&custom[custom_path]=".concat(window.tycheData.customPath));var T=window.site.queryStringAsObject;T&&(T.utm_campaign&&(e+="&custom[utm_campaign]=".concat(T.utm_campaign)),T.utm_source&&(e+="&custom[utm_source]=".concat(T.utm_source)),T.utm_medium&&(e+="&custom[utm_medium]=".concat(T.utm_medium)),T.utm_template&&(e+="&custom[utm_template]=".concat(T.utm_template))),Object(i.v)(p.selectedServer.siteTags,"id")&&(e+="&custom[ws_id]=".concat(p.selectedServer.siteTags.id.toString())),e+=p.getCustomReportParams(),(null===(l=p.selectedServer)||void 0===l||null===(u=l.siteTags)||void 0===u?void 0:u.placementIds)&&p.selectedServer.siteTags.placementIds.forEach((function(t){var n,i;e+="".concat((null===(n=p.selectedServer)||void 0===n||null===(i=n.siteTags)||void 0===i?void 0:i.coppa)?"&custom[cp_placement][]":"&custom[placement][]","=").concat(t)})),v.categories&&v.categories.forEach((function(t){e+="&custom[vidcont_cat][]=".concat(t)}));var M=Object(i.m)(p.selectedServer.siteTags);M.length>0&&(e+="&custom[sitecont_cat][]=".concat(M.join("&custom[sitecont_cat][]="))),window.tagTestUrl&&(window.tagTestUrl=window.tagTestUrl.replace(/(^\w+:|^)\/\//,""),e+="&token[test_ad_tag]=".concat(encodeURIComponent(window.tagTestUrl)));var P=50*Math.floor(window.client.innerWidth/50),C=50*Math.floor(window.client.innerHeight/50);for(var O in e+="&custom[window_width]=".concat(P,"&custom[window_height]=").concat(C),p.DOMPosition)e+="&custom[".concat(O,"]=").concat(p.DOMPosition[O]);var I=window.customClientTags;return I&&Object.keys(I).length&&Object.keys(I).forEach((function(t){var n=I[t];n&&(e+="&custom[".concat(t,"]=").concat(n))})),e},c=function(e){var t=window.prebidWinner,n=window.kassandraWinner;if(Object(i.v)(n,"hb_val")){var a=u(n.hb_val);e+="&token[hb_vast]=".concat(n.hb_vast,"&token[hb_val]=").concat(a,"&token[hb_bidder]=").concat(n.hb_bidder,"&token[hb_adid]=").concat(n.hb_adid,"&custom[hb_bidder]=").concat(n.hb_bidder,"&custom[hb_val]=").concat(a),Object(i.b)(window.kassandraWinner)}else if(Object(i.v)(t,"hb_vast")){var r=t.hb_vast,o=u(t.hb_val);e+="&token[hb_vast]=".concat(encodeURIComponent(r.replace(/(^\w+:|^)\/\//,"")),"&token[hb_val]=").concat(o,"&token[hb_bidder]=").concat(t.hb_bidder,"&token[hb_adid]=").concat(t.hb_adid,"&custom[hb_bidder]=").concat(t.hb_bidder,"&custom[hb_val]=").concat(o),t.hb_uuid&&(e+="&token[hb_uuid]=".concat(t.hb_uuid))}var s=window.amazonWinner;return s&&(e+="&custom[amznbid]=".concat(s.amznbid),e+="&token[amznbid]=".concat(s.amznbid),e+="&token[amzniid]=".concat(s.amzniid)),e},l=function(e){try{return/-(.*)/.exec(e)[1]}catch(t){return e}},u=function(e){return(e=window.parseInt(e,10))>100&&(e=100),e=(e=Math.floor(window.parseInt(e,10)).toFixed(2)).toString().replace(".","_")},p=function(e){var t="&custom[hw_cpu]=".concat(encodeURIComponent(e.CPU));t+="&custom[hw_os]=".concat(encodeURIComponent(e.OS)),t+="&custom[hw_memory]=".concat((parseInt(e.MemorySize,10)/1e9).toFixed(2)),t+="&custom[hw_screens]=".concat(e.NumberOfScreens),t+="&custom[hw_model]=".concat(encodeURIComponent(e.Model)),t+="&custom[hw_manufacturer]=".concat(encodeURIComponent(e.Manufacturer)),t+="&custom[hw_is_laptop]=".concat(e.IsLaptop),t+="&custom[hw_motherboard]=".concat(encodeURIComponent(e.Motherboard));try{e.GPUs.forEach((function(e){t+="&custom[hw_gpu_name][]=".concat(encodeURIComponent(e.Name))}))}catch(e){}try{e.HardDisks.forEach((function(e){t+="&custom[hw_harddisk_caption][]=".concat(encodeURIComponent(e.Caption)),t+="&custom[hw_harddisk_size][]=".concat((e.Size/1e9).toFixed(2)),t+="&custom[hw_harddisk_ssd][]=".concat(e.IsSsd)}))}catch(e){}try{e.Monitors.forEach((function(e){t+="&custom[hw_monitor_name][]=".concat(encodeURIComponent(e.Name)),t+="&custom[hw_monitor_resolution][]=".concat(encodeURIComponent(e.Resolution))}))}catch(e){}try{e.AudioDevices.forEach((function(e){t+="&custom[hw_audio][]=".concat(encodeURIComponent(e))}))}catch(e){}return t}},38:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g}));var i=n(12),a=n(3);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=u(e);if(t){var a=u(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=new(n(2).a)("AD-REQUEST"),g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,n,i,r=d(c);function c(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),p(l(e=r.call(this)),"failed",!1),p(l(e),"data",{}),e}return t=c,(n=[{key:"setMedia",value:function(e,t){this.data.media_src=e,this.data.mime_type=t}},{key:"start",value:function(e,t,n,i){var r=this,o=r.data.campaign_id;r.reset(),r.data={campaign_id:o,tag:e,third_party_tag:t,daisy_chain_count:n,start_ts:new Date},this._dispatchEvent(a.a.Ad.Event.REQUEST_START,r.data)}},{key:"getElapsedSecondsSinceStart",value:function(e){try{var t=(e.getTime()-this.data.start_ts.getTime())/1e3;return parseFloat(t.toFixed(1))}catch(e){return-1}}},{key:"success",value:function(){var e=this,t=new Date,n={timestamp:t,media_src:e.data.media_src,mime_type:e.data.mime_type,ad_type:e.data.ad_type,network:e.data.network,campaign_id:e.data.campaign_id,et_request_start:e.getElapsedSecondsSinceStart(t),et_session_start:window.AdSession.getElapsedSecondsSinceStart(t)};this._dispatchEvent(a.a.Ad.Event.REQUEST_SUCCESS,n)}},{key:"fail",value:function(e){var t=this,n=new Date;if(!t.failed){t.failed=!0;var i={timestamp:n,media_src:t.data.media_src,mime_type:t.data.mime_type,ad_type:t.data.ad_type,info:e,network:t.data.network,campaign_id:t.data.campaign_id,et_request_start:t.getElapsedSecondsSinceStart(n),et_session_start:window.AdSession.getElapsedSecondsSinceStart(n)};t._dispatchEvent(a.a.Ad.Event.REQUEST_FAIL,i)}}},{key:"abort",value:function(){var e=this,t=new Date,n={timestamp:t,media_src:e.data.media_src,mime_type:e.data.mime_type,ad_type:e.data.ad_type,network:e.data.network,campaign_id:e.data.campaign_id,et_request_start:e.getElapsedSecondsSinceStart(t),et_session_start:window.AdSession.getElapsedSecondsSinceStart(t)};e._dispatchEvent(a.a.Ad.Event.REQUEST_ABORT,n)}},{key:"reset",value:function(){var e;this.data&&this.data.campaign_id&&(e=this.data.campaign_id),this.failed=!1,this.data={},window.BoltAdManager&&window.BoltAdManager.selectedServer&&(this.data.campaign_id=e)}},{key:"adType",get:function(){return this.data.ad_type},set:function(e){this.data.ad_type=e}},{key:"network",get:function(){return this.data.network},set:function(e){this.data.network=e}},{key:"campaignId",get:function(){return this.data.campaign_id},set:function(e){try{this.data.campaign_id=e}catch(e){}v.info("CAMPAIGN ID",this.data.campaign_id)}}])&&o(t.prototype,n),i&&o(t,i),c}(i.a)},39:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var i=n(12),a=n(2),r=n(3),o=n(0);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v(e);if(t){var a=v(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=new a.a("SS-TRACKER"),m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(s,e);var t,n,i,a=l(s);function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),g(p(e=a.call(this)),"videoId",null),g(p(e),"publisherId",null),g(p(e),"tag",null),g(p(e),"timing",null),g(p(e),"started",!1),g(p(e),"aborted",!1),g(p(e),"loaded",!1),g(p(e),"failed",!1),g(p(e),"data",{}),e}return t=s,(n=[{key:"start",value:function(e){e.timing&&e.tag&&e.serverType?this.started?h.warn("SSTRacker has already been started"):(this.started=!0,this.tag=e.tag,this.data={timing:e.timing,tag:e.tag,vmap:e.vmap,publisher_id:Object(o.g)()||-1,video_id:window.CurrentVideoConfig.content.videoId||-1,start_ts:new Date,server_type:e.serverType},this._dispatchEvent(r.a.Ad.Event.SS_REQUESTED,this.data)):h.error("Invalid SS tracker data")}},{key:"fail",value:function(){this.tag?this.started?(this.failed=!0,h.info("event: failed"),this._dispatchEvent(r.a.Ad.Event.SS_FAILED,this.data)):h.error("has not started"):h.warn("No self-service tag")}},{key:"success",value:function(){this.tag?this.started?(this.loaded=!0,h.info("event: success"),this._dispatchEvent(r.a.Ad.Event.SS_LOADED,this.data)):h.error("has not started"):h.warn("No self-service tag")}},{key:"backfill",value:function(e){this.tag?this.started?this.failed?(this.data.backfiller_tag=e,this._dispatchEvent(r.a.Ad.Event.SS_BACKFILL_REQUESTED,this.data)):h.error("did not fail"):h.error("has not started"):h.warn("No self-service tag")}},{key:"backfillSuccess",value:function(e){this.tag?this.started?this.failed?(this.data.backfiller_tag=e||this.data.backfiller_tag,this._dispatchEvent(r.a.Ad.Event.SS_BACKFILL_SUCCESS,this.data)):h.error("did not fail"):h.error("has not started"):h.warn("No self-service tag")}},{key:"backfillFail",value:function(e){this.tag?this.started?this.failed?(this.data.backfiller_tag=e||this.data.backfiller_tag,this._dispatchEvent(r.a.Ad.Event.SS_BACKFILL_FAILED,this.data)):h.error("did not fail"):h.error("has not started"):h.warn("No self-service tag")}},{key:"reset",value:function(){h.debug("reset"),this.tag=null,this.timing=null,this.started=!1,this.aborted=!1,this.loaded=!1,this.failed=!1,this.data={}}},{key:"recordImpression",value:function(){var e={timing:this.data.timing,video_id:this.data.video_id,publisher_id:this.data.publisher_id,tag:this.data.tag,vmap:this.data.vmap,server_type:this.data.server_type,start_ts:this.data.start_ts};this._dispatchEvent(r.a.Ad.Event.SS_IMPRESSION,e)}}])&&d(t.prototype,n),i&&d(t,i),s}(i.a)},57:function(e,t,n){"use strict";n.r(t);var i=n(12),a=n(2),r=n(0),o=n(3),s=n(17),d=n(6),c=new a.a("VAST-MAP");function l(e,t,n,i){var a=Object(r.A)(e);c.debug("URL after substitution: ".concat(a)),window.postLogMessage("URL after substitution ".concat(a));Object(r.F)({url:a,method:"get"}).then((function(e){var a,r;a=e.data,(r=(new DOMParser).parseFromString(a,"application/xml")).getElementsByTagName("Ad").length?n(r,t):(c.warn("Empty VAST ".concat(r)),window.postLogMessage("Empty VAST XML","error"),i())})).catch(i)}function u(e,t,n){c.debug("fetching ".concat(e)),window.postLogMessage("Fetching ".concat(e)),l(e,null,(function(e){new g(e,t,n)}),(function(){c.error("Failed to load VAST from '".concat(e,"':")),window.postLogMessage("Failed to load VAST from '".concat(e),"error"),t(null)}))}function p(e,t){if(this.events={},this.ad=t,null!==e){if("TrackingEvents"!==e.tagName&&"vmap:TrackingEvents"!==e.tagName){if(1!==(e=e.getElementsByTagName("TrackingEvents")).length)return;e=e.item(0)}var n=e.getElementsByTagName("Tracking");0===n.length&&(n=e.getElementsByTagNameNS("*","Tracking"));for(var i=0;i<n.length;i++){var a=n[i].getAttribute("event");if(a){var r=null;"progress"===a&&(r=n[i].getAttribute("offset"),a+="-".concat(r)),this.events[a]=this.events[a]||[];var o={url:n[i].textContent.replace(/\s/g,""),offset:r,event:a};this.events[a].push(o)}}}}function v(e,t,n){this.breaks=[];var i=this;l(e,null,(function(e){for(var a=e.getElementsByTagName("AdBreak"),r=[],o=0;o<a.length;o++){var s=a.item(o),d=s.getAttribute("timeOffset");if(0!==d.indexOf("#")){var l={ad:null,breakId:s.getAttribute("breakId"),tracking:new p(s,null),position:d},v=t.bind(i,i.breaks.length,d),h=s.getElementsByTagName("VASTData");if(h)l.ad=new g(h.item(0).getElementByTagName(null,"VAST").item(0),v);else{var m,f=s.getElementsByTagName("AdTagURI");if(!f){c.error("No supported ad target for break #".concat(o));continue}!function(e){m=function(t){e.ad=t,null!==t&&v(t)}}(l),u(f.item(0).textContent.replace(/\s/g,""),m)}i.breaks.push(l),r.push(l.position)}}"function"==typeof n&&n(r)}),(function(t){c.error("Failed to load VMAP from '".concat(e,"':"),{message:t}),n([])}))}function g(e,t,n){var i=e.getElementsByTagName("Ad");if(void 0===i||0===i.length)c.warn("No Ads found in ".concat((new XMLSerializer).serializeToString(e))),t&&t.call(null);else{this.ads=[],this.onAdsAvailable=t,this.id=void 0!==e.getElementsByTagName("Ad")[0]?e.getElementsByTagName("Ad")[0].getAttribute("id"):null;for(var a=e.getElementsByTagName("Ad"),o=0;o<a.length;o++){var s=new h(this,a.item(o),n||null);if(!s.isEmpty()){var d=e.getElementsByTagName("Price");try{d=d.length>0&&"CPM"===d[0].getAttribute("model").toUpperCase()?parseFloat(d[0].textContent)||0:null}catch(e){d=null}if(this.ads.push(s),!s.hasData()||s.hasSequence()&&!s.isNumber(1)){var l=a.item(o).getElementsByTagName("Wrapper").item(0),p=l.getElementsByTagName("VASTAdTagURI");if(0===p.length)continue;p=p.item(0).textContent.replace(/\s/g,"");try{p=Object(r.A)(p)}catch(e){}BoltAdManager.thirdPartyTag&&(BoltAdManager.thirdPartyTag=p),!function(e,t,n){(function(i){if(e.onLoaded(i,t),n.onAdsAvailable){var a=n.onAdsAvailable;n.onAdsAvailable=null,a.call(n,n,d)}})}(s,"true"===l.getAttribute("allowMultipleAds"),this),u(p,t,s)}else if(t){var v=this.onAdsAvailable;this.onAdsAvailable=null;try{v.call(this,this,d)}catch(e){}}}}}}function h(e,t,n,i){var a,r;if(this.vast=e,this.pod=e,this.parentAd=n,this.onAdAvailable=i,this.sequence=null,this.hasContent=!0,this.loaded=!0,this.linear=null,this.companions=[],this.companionsRequired="none",this.nonlinears=[],this.nonlinearsTracking=null,this.impressions=[],this.currentPodAd=this,this.sentImpression=!1,this.properties={},null!==this.parentAd){var o=this.parentAd;if(this.companionsRequired=o.companionsRequired,this.linear=o.linear?o.linear.copy(this):null,o.companions.length)for(a=0;a<o.companions.length;a++)this.companions.push(o.companions[a].copy(this));if(o.nonlinears.length)for(a=0;a<o.nonlinears.length;a++)this.companions.push(o.nonlinears[a].copy(this));for(r in null!==o.nonlinearsTracking&&(this.nonlinearsTracking=o.nonlinearsTracking.copy(this)),o.properties)o.properties.hasOwnProperty(r)&&(this.properties[r]=o.properties[r])}null===this.nonlinearsTracking&&(this.nonlinearsTracking=new p(null,this)),t.hasAttribute("sequence")&&(this.sequence=parseInt(t.getAttribute("sequence"),10));var s=t.getElementsByTagName("InLine");if(0!==s.length||(this.loaded=!1,0!==(s=t.getElementsByTagName("Wrapper")).length)){for(var d=(s=s.item(0)).firstChild;null!==d;){if(1===d.nodeType)switch(d.tagName){case"Creatives":case"InLine":case"Wrapper":case"Impression":case"VASTAdTagURI":case"Error":break;default:this.properties[d.tagName]=d.textContent.replace(/^\s*|\s*$/g,"")}d=d.nextSibling}var l=s.getElementsByTagName("Impression");for(a=0;a<l.length;a++){var u=l.item(a).textContent.replace(/\s/g,"");0!==u.length&&(c.debug("VAST impression ".concat(u)),-1===this.impressions.indexOf(u)?this.impressions.push(u):c.info("skipping impression because it's a duplicate"))}c.debug("Impressions",this.impressions);var v=s.getElementsByTagName("Creatives");if(0!==v.length)for(v=v.item(0).getElementsByTagName("Creative"),a=0;a<v.length;a++){for(var g,h=v.item(a).firstChild;null!==h&&3===h.nodeType;)h=h.nextSibling;if(null!==h)switch(h.tagName){case"Linear":g=new f(this,h),this.linear?(this.linear=_(this,g),null!==this.parentAd&&this.linear.tracking.augment(this.parentAd.linear.tracking)):this.linear=g;break;case"NonLinearAds":var m=h.tagName.replace("Ads","");if("NonLinear"===m){var y=new p(h,this);this.nonlinearsTracking.augment(y)}for(var w=h.getElementsByTagName(m),A=0;A<w.length;A++)g=new b(this,w.item(A)),this.nonlinears=_(this,g)}}}else this.hasContent=!1}function m(e,t){this.root=t,this.clickThrough=null,"NonLinear"===t.tagName&&(t=t.parentNode),this.tracking=new p(t,e)}function f(e,t){var n;m.call(this,e,t),this.mediaFiles=[],this.clickThrough=null,this.duration=null;var i=t.getElementsByTagName("VideoClicks");if(i.length){var a=(i=i.item(0)).getElementsByTagName("ClickThrough");for(a.length&&(this.clickThrough=a.item(0).textContent.replace(/\s/g,"")),a=i.getElementsByTagName("ClickTracking"),n=0;n<a.length;n++)this.tracking.addClickTracking(a.item(n).textContent.replace(/\s/g,""))}var r=t.getElementsByTagName("Duration");r.length&&(this.duration=this.timecodeFromString(r.item(0).textContent.replace(/\s/g,"")));var o=t.getElementsByTagName("MediaFiles");if(o.length){for(o=o.item(0).getElementsByTagName("MediaFile"),n=0;n<o.length;n++){for(var s=o.item(n),d={},l=0;l<s.attributes.length;l++)d[s.attributes[l].name]=s.attributes[l].value;d.src=o.item(n).textContent.replace(/\s/g,""),this.mediaFiles.push(d)}this.parameters=null,t.getElementsByTagName("AdParameters").length>0&&(this.parameters=t.getElementsByTagName("AdParameters")[0].textContent,window.site.isSecure&&(c.info("Normalizing all protocols in AdParameters"),c.info("Ad Parameters BEFORE normalisation:",this.parameters.concat()),this.parameters=this.parameters.replace(/http:/gi,"https:").replace(/http%3A/gi,"https%3A"),c.info("Ad Parameters AFTER normalisation:",this.parameters)))}}p.prototype.copy=function(e){var t=Object.create(p.prototype);for(var n in t.events={},this.events)this.events.hasOwnProperty(n)&&(t.events[n]=[].concat(this.events[n]));return t.ad=e,t},p.prototype.finger=function(e,t){var n=Object(r.A)(e),i=document.getElementById("bolt_trackingpixels"),a=Object(r.u)(n),o=document.createElement("img");o.setAttribute("style","position:absolute;bottom:0;left:0;visibility:hidden"),o.src=a,i.appendChild(o),c.info("Image tracking pixel loaded: ".concat(n))},p.prototype.augment=function(e){for(var t in e.events)e.events.hasOwnProperty(t)&&(this.events[t]?this.events[t]=this.events[t].concat(e.events[t]):this.events[t]=e.events[t])},p.prototype.addClickTracking=function(e){var t={url:e,event:"click",offset:null};this.events.click?this.events.click.push(t):this.events.click=[t]},p.prototype.getEventsOfTypes=function(e){var t=[],n=e.indexOf("progress")>-1;for(var i in this.events)this.events.hasOwnProperty(i)&&(e.indexOf(i)>-1||n&&0===i.indexOf("progress-"))&&(t=t.concat(this.events[i]));return t},p.prototype.track=function(e,t){if(this.events[e]&&0!==this.events[e].length){t||(t={});var n,i=[].concat(this.events[e]);for(var a in t)t.hasOwnProperty(a)&&(t["[".concat(a,"]")]=encodeURIComponent(t[a]),delete t[a]);for(n=0;n<i.length;n++){var r=i[n].url;for(a in t["[CACHEBUSTING]"]=Object(d.a)(),t)t.hasOwnProperty(a)&&(r=r.replace(a,t[a]));""!==r&&"about:blank"!==r&&(c.debug("tracking",e,r),this.finger(r,e))}}},p.prototype.trackImpressions=function(){c.debug("tracking impressions for ad");for(var e,t,n=this.ad;null!==n&&!n.hasSentImpression();){for(n.impressionSent(),e=0;e<n.impressions.length;e++)""!==(t=n.impressions[e])&&"about:blank"!==t&&(c.debug("Track impression",t),this.finger(t,"impression"));c.debug("Backtracking to parent ad, if any"),n=n.parentAd}},v.prototype.onBreakStart=function(e){return this.breaks[e].tracking.track("breakStart"),this.breaks[e].ad},v.prototype.onBreakEnd=function(e){this.breaks[e].tracking.track("breakEnd")},g.prototype.getAd=function(e){var t=null;if(e&&(t=this.getAdWithSequence(1))&&!t.current().isEmpty())return t.current();for(var n=0;n<this.ads.length;n++)if(!this.ads[n].hasSequence()&&!this.ads[n].current().isEmpty())return this.ads[n].current()},g.prototype.getAdWithSequence=function(e){for(var t=0;t<this.ads.length;t++)if(this.ads[t].isNumber(e))return this.ads[t];return null},h.prototype.getTag=function(e,t){return this.properties.hasOwnProperty(e)?this.properties[e]:t},h.prototype.onLoaded=function(e,t){this.pod=e,this.currentPodAd=e.getAd(t),this.currentPodAd.isEmpty()||(this.loaded=!0,this.onAdAvailable&&this.onAdAvailable.call(this,this))},h.prototype.hasSentImpression=function(){return this.sentImpression},h.prototype.impressionSent=function(){this.sentImpression=!0},h.prototype.current=function(){return this.currentPodAd},h.prototype.isNumber=function(e){return this.sequence===e},h.prototype.hasSequence=function(){return null!==this.sequence},h.prototype.isEmpty=function(){return!this.hasContent},h.prototype.hasData=function(){return this.loaded},h.prototype.getNextAd=function(){return this.vast!==this.pod&&(this.currentPodAd=this.currentPodAd.getNextAd(),null!==this.currentPod)?this.currentPodAd.current():this.hasSequence()?this.vast.getAdWithSequence(this.sequence+1).current():null},h.prototype.getLinear=function(){return this.linear},h.prototype.getCompanions=function(){return this.companions},h.prototype.getCompanion=function(e){for(var t=0;t<this.companions.length;t++)if(this.companions[t].attribute("id")===e)return this.companions[t];return null},h.prototype.companionsRequired=function(){return this.companionsRequired},h.prototype.getNonLinears=function(){return this.nonlinears},m.prototype.track=function(e,t,n){this.tracking.track(e,{CONTENTPLAYHEAD:this.timecodeToString(t),ASSETURI:n})},m.prototype.trackImpressions=function(e){this.tracking.trackImpressions()},m.prototype.timecodeToString=function(e){var t="0".concat(parseInt(e/3600,10)),n="0".concat(parseInt(e%3600/60,10)),i="0".concat(e%60);return"".concat(t,":").concat(n,":").concat(i).replace(/(^|:|\.)0(\d{2})/g,"$1$2")},m.prototype.timecodeFromString=function(e){return-1===e.indexOf(":")?e:3600*parseInt(e.substr(0,2),10)+60*parseInt(e.substr(3,2),10)+parseInt(e.substr(6,2),10)},m.prototype.getClickThrough=function(){return this.clickThrough},m.prototype.attribute=function(e,t){if(!this.root.hasAttribute(e))return t;var n=this.root.getAttribute(e);switch(e){case"skipoffset":case"duration":case"offset":case"minSuggestedDuration":n=this.timecodeFromString(n)}return n},f.prototype=Object.create(m.prototype),f.prototype.getDuration=function(){return this.duration},f.prototype.copy=function(e){return new f(e,this.root)},f.prototype.augment=function(e){this.tracking.augment(e.tracking),this.clickThrough=e.clickThrough||this.clickThrough},f.prototype.getAllMedias=function(){return this.mediaFiles},f.prototype.getAllMediaAsObject=function(){var e;return this.mediaFiles&&this.mediaFiles.forEach((function(t){e||(e={}),e[t.type]=t})),e},f.prototype.getBestMedia=function(e){for(var t=Number.POSITIVE_INFINITY,n=-1,i=0;i<this.mediaFiles.length;i++){var a=this.mediaFiles[i],r=Math.sqrt(Math.pow(e.width-a.width,2)+Math.pow(e.height-a.height,2));if(r<t)t=r,n=i;else if(r===t){var o=this.mediaFiles[n],s=o.bitrate||o.maxBitrate,d=a.bitrate||a.maxBitrate;d&&!s?n=i:e.bitrate&&s&&d?Math.abs(d-e.bitrate)<Math.abs(s-e.bitrate)&&(n=i):d>s&&(n=i)}}return-1===n?null:this.mediaFiles[n]};var y=["start","firstQuartile","midpoint","thirdQuartile","complete","progress"];function w(e,t){var n;m.call(this,e,t),this.resources={iframe:null,html:null,images:{}},(n=t.getElementsByTagName("IFrameResource")).length>0&&(this.resources.iframe=n.item(0).textContent.replace(/\s/g,"")),(n=t.getElementsByTagName("HTMLResource")).length>0&&(this.resources.html=n.item(0).textContent.replace(/\s/g,"")),n=t.getElementsByTagName("StaticResource");for(var i=0;i<n.length;i++)this.resources.images[n.item(i).getAttribute("creativeType")]=n.item(i).textContent.replace(/\s/g,"")}function A(e,t){w.call(this,e,t),this.altText="",w.prototype.extractClicks.call(this,"Companion");var n=t.getElementsByTagName("AltText");n.length&&(this.altText=n.item(0).textContent.replace(/\s/g,""))}function b(e,t){w.call(this,e,t),this.tracking=e.nonlinearsTracking,w.prototype.extractClicks.call(this,"NonLinear")}function _(e,t){for(var n in t)try{t[n].constructor==Object?e[n]=_(e[n],t[n]):e[n]=t[n]}catch(i){e[n]=t[n]}return e}function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=C(e);if(t){var a=C(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return M(this,n)}}function M(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?P(e):t}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}f.prototype.getTrackingPoints=function(){for(var e=this.tracking.getEventsOfTypes(y),t=[],n=0;n<e.length;n++){var i={event:e[n].event,offset:null};switch(e[n].event){case"start":i.offset="start";break;case"firstQuartile":i.offset="25%";break;case"midpoint":i.offset="50%";break;case"thirdQuartile":i.offset="75%";break;case"complete":i.offset="end";break;default:var a=e[n].offset;if(!a)continue;i.offset=m.prototype.timecodeFromString(a)}t.push(i)}return t},w.prototype=Object.create(m.prototype),w.prototype.augment=function(e){for(var t in this.tracking.augment(e.tracking),this.clickThrough=e.clickThrough||this.clickThrough,this.resources.iframe=e.resources.iframe||this.resources.iframe,this.resources.html=e.resources.html||this.resources.html,e.resources.images)e.resources.images.hasOwnProperty(t)&&(this.resources.images[t]=e.resources.images[t])},w.prototype.getAllResources=function(){return this.resources},w.prototype.extractClicks=function(e){var t;(t=this.root.getElementsByTagName("".concat(e,"ClickThrough"))).length&&(this.clickThrough=t.item(0).textContent.replace(/\s/g,"")),(t=this.root.getElementsByTagName("".concat(e,"ClickTracking"))).length&&this.tracking.addClickTracking(t.item(0).textContent.replace(/\s/g,""))},A.prototype=Object.create(w.prototype),A.prototype.copy=function(e){return new A(e,this.root)},A.prototype.augment=function(e){w.prototype.augment.call(this,e),this.altText=e.altText||this.altText},A.prototype.getAltText=function(){return this.altText},b.prototype=Object.create(w.prototype),b.prototype.augment=function(e){w.prototype.augment.call(this,e)},b.prototype.copy=function(e){return new b(e,this.root)};var O=new a.a("VMAP-ADAPTER"),I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(s,e);var t,n,a,o=T(s);function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),e=o.call(this),(new i.a).mixin(P(e)),e}return t=s,(n=[{key:"init",value:function(e,t,n){var i=this;i.primaryTag=e,i.xml=null,i.breaks=[],i.successCb=t,i.errorCb=n,i.contentDuration=0,i.cuepoints=[],Object(r.F)({url:this.primaryTag,method:"get"}).then((function(e){i.parse(e.data)})).catch((function(){n.call(null)}))}},{key:"parse",value:function(e){var t=this;t.xml=e,t.breaks=[],t.cuepoints=[];for(var n,i,a,r,o,s=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagNameNS("*","AdBreak"),d=0;d<s.length;d++)if("linear"===(n=s.item(d)).getAttribute("breakType")){O.info("AdBreak",n);var c={position:n.getAttribute("timeOffset"),positionInSeconds:(i=n.getAttribute("timeOffset"),a=void 0,r=void 0,o=void 0,a=i.split(":"),r=window.parseInt(a[2],10),o=window.parseInt(a[1],10),3600*window.parseInt(a[0],10)+60*o+r),breakId:n.getAttribute("breakId"),sourceId:n.getElementsByTagNameNS("*","AdSource")[0].getAttribute("id"),trackingEvents:null,adXML:null,adURI:null};try{var l=n.getElementsByTagNameNS("*","TrackingEvents")[0];l&&(c.trackingEvents=new p(l,null))}catch(e){}var u=n.getElementsByTagNameNS("*","VASTAdData")[0];if(u){var v=u.getElementsByTagNameNS("*","VAST")[0];v&&(c.adXML=v)}else{var g=n.getElementsByTagNameNS("*","AdTagURI")[0];g&&(c.adURI=g.textContent.trim())}(c.adURI||c.adXML)&&("number"!=typeof c.positionInSeconds||isNaN(c.positionInSeconds)||t.cuepoints.push(c.positionInSeconds),t.breaks.push(c))}t.breaks.length>0?(t.contentDuration>0&&t.updatePercentagePosition(t.contentDuration),t.successCb.call(null,t.breaks)):(O.warn("No ad breaks found"),t.errorCb.call(null))}},{key:"getBreaks",value:function(e){var t=this,n=[];if(!t.breaks||0===t.breaks.length)return null;for(var i=t.breaks.concat();i.length>0;){var a=i.shift();"preroll"===e?"start"===a.position&&n.push(a):"postroll"===e?"end"===a.position&&n.push(a):a.positionInSeconds===Math.floor(e)&&n.push(a)}return n.length>0?n:null}},{key:"setContentDuration",value:function(e,t){this.contentDuration=e,this.breaks&&this.breaks.length>0&&(this.updatePercentagePosition(e),t&&t.call(null,this.cuepoints))}},{key:"updatePercentagePosition",value:function(e){var t=this;e&&t.breaks&&t.breaks.length>0&&(t.breaks.forEach((function(t){t.position.indexOf("%")>-1&&(t.positionInSeconds=Math.floor(e*parseFloat(t.position)/100))})),t.validateBreakTimings(e))}},{key:"validateBreakTimings",value:function(e){O.info("Validate VMAP break timings");var t=this;e&&t.breaks&&t.breaks.length>0&&(t.breaks=t.breaks.filter((function(t){return"start"===t.position||"end"===t.position||e-t.positionInSeconds>30})),t.updateCuepoints())}},{key:"updateCuepoints",value:function(){var e=this;e.breaks&&e.breaks.length>0&&e.breaks.forEach((function(t){"number"!=typeof t.positionInSeconds||isNaN(t.positionInSeconds)||e.cuepoints.push(t.positionInSeconds)})),e.cuepoints=Object(r.y)(Object(r.l)(e.cuepoints)),O.info("VMAP CUEPOINTS",e.cuepoints)}},{key:"reset",value:function(){this.breaks=null,this.successCb=null,this.errorCb=null,this.primaryTag=null,this.xml=null,this.contentDuration=0,this.cuepoints=null}}])&&k(t.prototype,n),a&&k(t,a),s}(i.a);function L(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var R=new a.a("SERVER"),B=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t.type,this.tags=t.tags,this.type===o.a.Ad.Server.SPOTX?this.maxAttempts=3:this.type===o.a.Ad.Server.DFP?this.maxAttempts=2:(this.type===o.a.Ad.Server.DISPLAY_BACKFILL||(this.type,o.a.Ad.Server.HOUSE_AD),this.maxAttempts=1),this.tagType=this._findTagTypeForSite(),this.tagType?"syndication"===this.tagType?this.siteTags=this.tags.default:this.siteTags=this.tags[this.tagType]:this.siteTags=null,this.type!==o.a.Ad.Server.SPOTX&&this.type!==o.a.Ad.Server.SPOTX_SDK||(this.spotxChannelId=this._getSpotxChannelId(),window.spotxChannelId=this.spotxChannelId)}var t,n,i;return t=e,(n=[{key:"selectTag",value:function(e){var t=null;if(window.tagTestUrl&&window.googleIma)return window.tagTestUrl;try{R.info("Search tag",{timing:e,tags:this.siteTags}),this.siteTags&&this.siteTags.html5&&(window.client.isMobile&&this.siteTags.html5.mobile?t=this.siteTags.html5.mobile[e]:this.siteTags.html5.desktop&&(t=this.siteTags.html5.desktop[e]))}catch(e){R.warn("Caught Error",{message:e.message,stack:e.stack})}return!t||0!==t.indexOf("//")&&0!==t.indexOf("http://")||(t=t.replace(/(http\:\/\/|\/\/)/gi,"https://")),t}},{key:"_findTagTypeForSite",value:function(){var e=window.site.hostname,t=null;if(!this.tags)return null;try{var n=window.site.tld,i=window.PlayerSettings;if(i.forceAds&&(R.debug("Forcing Ads for ".concat(n)),window.postLogMessage("Forcing Ads for: ".concat(n))),"amp"!==window.site.hostapp&&!i.forceAds&&"ramp.playwire.com"===n)return R.warn("TLD is ".concat(n,". Ads disabled")),window.postLogMessage("TLD is ".concat(n,". Ads disabled"),"warn"),null;for(var a in this.tags){if(a===e){t=a;break}if(a===n||a==="*.".concat(n)){t=a;break}if(new RegExp("".concat(a,"$")).test(n)){t=a;break}}}catch(e){}return t?(R.debug("Found site-specific ".concat(this.type," tags"),this.tags[t]),window.postLogMessage("Found site-specific ".concat(this.type," tags matching ").concat(e)),t):(R.debug("No site-specific ".concat(this.type," tags match ").concat(e,". Using syndication tags.")),window.postLogMessage("No site-specific ".concat(this.type," tags match ").concat(e,". Using syndication tags.")),"syndication")}},{key:"_getSpotxChannelId",value:function(){try{return/#zeusdebug.*;spotxchannelid=([\d]*)/gi.exec(window.parentUrl)[1]}catch(e){}try{if(this.siteTags&&this.siteTags.html5){if(window.client.isMobile&&this.siteTags.html5.mobile)return R.info("Found SpotX Mobile ChannelID",{channelId:this.siteTags.html5.mobile.channelId}),this.siteTags.html5.mobile.channelId;if(this.siteTags.html5.desktop)return R.info("Found SpotX Desktop ChannelID",{channelId:this.siteTags.html5.desktop.channelId}),this.siteTags.html5.desktop.channelId}}catch(e){return null}}}])&&L(t.prototype,n),i&&L(t,i),e}();function V(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var D=new a.a("AD-POOL"),x=0,N=function(e,t,n){var i=this;i.name="overlay"===e?"Overlay":"Linear",i.timing=e,i.doneCallback=n,i.campaignId=null;var a,r=new DOMParser;i.xml=r.parseFromString(t,"text/xml");try{(a=i.xml.getElementsByTagName("Ad")[0])?i.campaignId=a.id:(a=i.xml.getElementsByTagName("BoltAdTemplate")[0])&&"google"===a.getAttribute("source")&&(i.campaignId=a.getAttribute("adid"))}catch(e){}if(a){var s=i.xml.getElementsByTagName("VAST")[0]||i.xml.getElementsByTagName("vast")[0];s?(i.type=o.a.Ad.Type.VAST,i.handleVAST()):(s=i.xml.getElementsByTagName("BoltAdTemplate")[0])&&(i.type=o.a.Ad.Type.GOOGLE,i.handleGoogleTemplate())}else i.done()};N.prototype={handleVAST:function(){var e=this,t=e.xml.getElementsByTagName("Ad")[0],n=t.getElementsByTagName("VASTAdTagURI")[0],i="true"===t.getAttribute("overlay");if("overlay"===e.timing){if(!i)return D.warn("Requested overlay ads but received non-overlay tag",{name:e.name}),window.postLogMessage("[".concat(e.name," AdPool] Requested overlay ads but received non-overlay tag"),"error"),void e.done();e.type=o.a.Ad.Type.OVERLAY}if(e.campaignId=t.id,n){var a=n.textContent;if(-1!==a.indexOf("adotube.com")&&"preroll"!==e.timing)return D.warn("Received Adotube tag not in preroll. Try to daisy-chain.",{name:e.name}),window.postLogMessage("[".concat(e.name," AdPool] Received Adotube tag not in preroll. Try to daisy-chain."),"warn"),e.xml=null,void e.done();if(-1!==a.indexOf("delivery.vidible.tv")&&"preroll"!==e.timing)return D.warn("Received AOL tag not in preroll. Try to daisy-chain.",{name:e.name}),window.postLogMessage("[".concat(e.name," AdPool] Received AOL tag not in preroll. Try to daisy-chain."),"warn"),e.xml=null,void e.done();if(a.indexOf("coull.com")>-1&&a.indexOf("ad_type=ov")>-1&&x>0)return e.xml=null,void e.done()}else D.info("Received a direct-campaign VAST",{name:e.name}),window.postLogMessage("[".concat(e.name," AdPool] Received a direct-campaign VAST"));D.info("Processing VAST XML"),new g(e.xml,(function(t,n){if(null==t)return e.xml=null,void e.done();e.cpm=n,e.ad=t,e.done()}))},handleGoogleTemplate:function(){var e=this;D.info("Received google template "),window.postLogMessage("[".concat(e.name," AdPool] Received a Google Template")),e.ad=e.xml,this.done()},done:function(){var e=this;e.doneCallback.call(null,{campaignId:e.campaignId,xml:e.xml,type:e.type,ad:e.ad,cpm:e.cpm})}};var j=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this;n.name=t?"Overlay":"Linear",n.isOverlay=t,n._ads=[],n._triedCampaigns=[],n._size=3,n._timing=null,n._drained=!0,n._timer=null,n._timeout=!1,n._attempts=0,n.serverType=null,n.syndication=!0}var t,n,i;return t=e,(n=[{key:"updateCoullOverlayCount",value:function(e){this.isOverlay&&(x=e)}},{key:"fill",value:function(e,t,n){var i=this;if(i.syndication=i.serverType===o.a.Ad.Server.SPOTX,i._timing!==t&&(D.info("Ad timing changed ".concat(i._timing,"->").concat(t,". Drain the pool.")),i.drain(),i._timing=t),i._drained=!1,i._timeout||i._ads.length===i._size||10===i._attempts)i.done(n);else{i._attempts++,D.info("Prefetch",{timing:t,syndication:i.syndication,attempt:i._attempts});var a=Object(r.A)(e);if(i.syndication&&(a+=";acao=*",window.PlayerSettings.customReporting&&(a+=function(){var e="";for(var t in window.PlayerSettings.customReporting)e+="&".concat(t,"=").concat(window.PlayerSettings.customReporting[t]);return e}()),i._triedCampaigns.length>0)){i._triedCampaigns=Object(r.l)(i._triedCampaigns);var s=(a=a.replace(/\;key=\d+/,"")).indexOf("ADTECH;")+"ADTECH;".length;a=s>=0?"".concat(a.slice(0,s),"key=").concat(i._triedCampaigns.join("+"),";").concat(a.slice(s+Math.abs(0))):"".concat(a,";key=").concat(i._triedCampaigns.join("+"))}var d=function(){D.info("Empty response in attempt #",i._attempts),window.postLogMessage("[".concat(i.name," AdPool] No ad from ").concat(e,".")),i.done(n)},c=function(){if(!i._drained)if(D.info("Retry tag ".concat(e)),"midroll"===i._timing)var a=setTimeout((function(){i._drained?clearTimeout(a):i.fill(e,t,n)}),5e3);else i.fill(e,t,n)},l=function(){if(window.postLogMessage("[".concat(i.name," AdPool] Fetching ").concat(a)),D.info("Fetching ".concat(a)),"preroll"!==i._timing&&"postroll"!==i._timing||i._timer||(i._timer=setTimeout((function(){i._timeout=!0}),1e4)),i.serverType===o.a.Ad.Server.GENERIC_GOOGLE){var n={type:o.a.Ad.Type.GOOGLE,ad:e};i._ads.push(n),c()}else Object(r.F)({url:a,method:"get"}).then((function(e){var n=e.data;i._drained||(n&&n.length>0?new N(t,n,(function(e){i._drained||(e.campaignId&&i._triedCampaigns.push(e.campaignId),!i.syndication||e.ad?(e.type===o.a.Ad.Type.VAST?e.ad.getAd(!0)&&i._ads.push(e):e.type===o.a.Ad.Type.GOOGLE&&e.xml&&i._ads.push(e),c()):d())})):i.syndication?d():c())})).catch((function(){D.info("Request failed."),c()}))};if(i.syndication&&"preroll"===t){var u={};void 0!==window.CurrentVideoConfig.settings.appleITP&&(u.appleITP=window.CurrentVideoConfig.settings.appleITP),MessageChannel.sendRequest("prebid",(function(e){D.info("Headerbid data",e),e&&e.hasOwnProperty("hb_adid")&&e.hasOwnProperty("hb_bidder")&&e.hasOwnProperty("hb_val")&&e.hasOwnProperty("hb_vast")&&(a+=";kvhb_adid=".concat(e.hb_adid),a+=";kvhb_bidder=".concat(e.hb_bidder),a+=";kvhb_val=".concat(e.hb_val),a+=";sub1=".concat(e.hb_vast)),l()}),u)}else l()}}},{key:"drain",value:function(){this._drained=!0,this._ads=[],this._triedCampaigns=[],this._timing=null,this._timeout=!1,this._timer&&(clearTimeout(this._timer),this._timer=null),this._attempts=0}},{key:"refill",value:function(e,t){var n=this;n._triedCampaigns=[],n._timeout=!1,n._timer&&(clearTimeout(n._timer),n._timer=null),n._attempts=0,n.fill(e,n._timing,t)}},{key:"getAd",value:function(){return this._ads.shift()}},{key:"setSize",value:function(e){var t=this;D.info("Server type",{type:t.serverType,size:e}),window.postLogMessage("[".concat(t.name," AdPool] server type:").concat(t.serverType," . Pool size: ").concat(e)),t._size=e}},{key:"prioritizeAds",value:function(){for(var e=this,t=[],n=0,i=e._ads.length;n<i;n++)e._ads[n].cpm&&t.push(e._ads[n]);return t&&e._ads.length===t.length?t.sort((function(e,t){return t.cpm-e.cpm})):e._ads}},{key:"done",value:function(e){var t=this;D.info("Prefetch is done after",{attempts:t._attempts,ads:t._ads}),window.postLogMessage("[".concat(t.name," AdPool] Prefetch is done after ").concat(t._attempts," attempts. We have ").concat(t._ads.length," ads")),clearTimeout(t._timer),e()}},{key:"hasAds",value:function(){return this._ads.length>0}}])&&V(t.prototype,n),i&&V(t,i),e}(),F=n(7),U=n(14),q=n(4);function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=K(e);if(t){var a=K(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return Q(this,n)}}function Q(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?z(e):t}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y=new a.a("SPOTX-SDK-PLAYER"),$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(s,e);var t,n,i,a=X(s);function s(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),J(z(n=a.call(this,e,t)),"client",void 0),J(z(n),"creativeData",void 0),J(z(n),"channelId",void 0),J(z(n),"spotxScriptUrl",void 0),J(z(n),"duration",0),J(z(n),"currentTime",0),J(z(n),"volume",1),J(z(n),"buffered",0),J(z(n),"startTime",0),J(z(n),"hasStarted",!1),J(z(n),"paused",!1),J(z(n),"fullscreen",!1),J(z(n),"metadata",null),J(z(n),"muted",!1),J(z(n),"sdk",void 0),J(z(n),"_isAd",!0),J(z(n),"timing",void 0),J(z(n),"provider",void 0),J(z(n),"playerWidth",void 0),J(z(n),"playerHeight",void 0),J(z(n),"adServer",void 0),J(z(n),"maxAttempts",void 0),J(z(n),"coppaEnabledOverride",void 0),J(z(n),"containerWidth",void 0),J(z(n),"containerHeight",void 0);var i=z(n);i.client=window.client,i.creativeData=JSON.parse(t),i.channelId=window.spotxChannelId,i.spotxScriptUrl="//js.spotx.tv/directsdk/v1/".concat(i.channelId,".js"),i.timing=window.BoltAdManager.timing,i.provider=o.a.Ad.Provider.SPOTX,i.playerWidth=i.container.clientWidth>0?i.container.clientWidth:window.Skin.clientWidth,i.playerHeight=i.container.clientHeight>0?i.container.clientHeight:window.Skin.clientHeight,i.adServer=window.BoltAdManager.selectedServer,i.maxAttempts=i.adServer.maxAttempts,window.BoltAdManager.SpotxSdk.stickyResize=window.BoltAdManager.SpotxSdk.sdk.fillAdVideoContainer.bind(z(n)),i.coppaEnabledOverride=!1;try{i.coppaEnabledOverride="true"===/#zeusdebug.*;coppaEnabled=(true|false)/i.exec(window.parentUrl)[1]}catch(e){}try{for(var r=i.creativeData.listing,d=0;d<r.length;d++)({campaignId:(r=r[d])[d].ad_id.split("-")[1],channelId:r[d].channel_id,channelName:r[d].client_playback.channel_name,creativeId:r[d].ad_id.split("-")[0],thirdPartyUrl:r[d].ad_system.rtb.url,title:r[d].title})}catch(e){Y.error("Error parsing spotx listings",{message:e.message,stack:e.stack})}return n}return t=s,(n=[{key:"getCustomReportingVal",value:function(e){var t;return Object(r.v)(window.CurrentVideoConfig,"settings","customReporting")&&(t=window.CurrentVideoConfig.settings.customReporting,Object(r.v)(t,"custom[cust_pub_reporting_".concat(e.toString(),"]")))?t["custom[cust_pub_reporting_".concat(e.toString(),"]")]:""}},{key:"addMacrosToBoltLogger",value:function(e){var t,n="";for(t in e)-1===e[t].toString().indexOf("http")&&(""!==n&&(n+="<br>"),n+='<span style="color:#ccc;font-weight:bold">'.concat(t,":</span> ").concat(e[t]));window.postLogMessage("Key Values sent in request: ".concat(n),"extra")}},{key:"getCustomParamsObject",value:function(){var e=this,t=window.CurrentVideoConfig,n=Object(r.g)().toString(),i=t.hostingId?t.hostingId.toString():n,a="precontent"===window.PlayerSettings.playerType,o=!0;try{o=Object(F.e)(e.adServer.tags)}catch(e){Y.error("Failed to determine site tag is syndicated or not",{message:e.message,stack:e.stack})}return{adunit:a?"pregame":e.timing,campaign_id:window.BoltAdManager.triedCampaigns.length?window.BoltAdManager.triedCampaigns[window.BoltAdManager.triedCampaigns.length-1]:"0.0",channel:e.channelId,content_page_url:window.site.href,player_height:"".concat(e.playerHeight,"px")||!1,player_width:"".concat(e.playerWidth,"px")||!1,cp_placement:Object(r.v)(e.adServer.siteTags,"placementIds")?e.adServer.siteTags.placementIds:[""],cust_pub_reporting_1:e.getCustomReportingVal(1),cust_pub_reporting_2:e.getCustomReportingVal(2),cust_pub_reporting_3:e.getCustomReportingVal(3),cust_pub_reporting_4:e.getCustomReportingVal(4),cust_pub_reporting_5:e.getCustomReportingVal(5),device_type:e.client.isMobile?"mobile":"desktop",hb_bidder:Object(r.v)(window.prebidWinner,"hb_bidder")?window.prebidWinner.hb_bidder:"",hb_val:Object(r.v)(window.prebidWinner,"hb_val")?window.prebidWinner.hb_val:"",owning_pub_id:n||"",placement:Object(r.v)(e.adServer.siteTags,"placementIds")?e.adServer.siteTags.placementIds:[""],player:"bolt",pub_id:i||"",synd:o,secure:window.location.protocol.indexOf("https")>=0,vid_id:Object(r.v)(window.CurrentVideoConfig,"content","videoId")&&window.CurrentVideoConfig.content.videoId||"",vidcont_cat:Object(r.v)(window.CurrentVideoConfig,"categories")?window.CurrentVideoConfig.categories:[""],vpi:Object(F.d)().join(","),ws_id:Object(r.v)(e.adServer.siteTags,"id")?e.adServer.siteTags.id:"default"}}},{key:"adjustSpotxHBCPMs",value:function(e){return e=(e=Math.floor(window.parseInt(e,10)/100).toFixed(2)).toString().replace(".","_")}},{key:"getTokenObject",value:function(){var e,t,n=this,i=n.coppaEnabledOverride||!!Object(r.v)(n.adServer,"siteTags","coppa")&&!0===n.adServer.siteTags.coppa,a={};return i&&Y.info("COPPA compliance required"),Object(r.v)(window.prebidWinner,"hb_vast")&&(e=window.prebidWinner.hb_vast,t=n.adjustSpotxHBCPMs(window.prebidWinner.hb_val),a.hb_vast=encodeURIComponent(e.replace(/(^\w+:|^)\/\//,"")),a.hb_val=t,a.hb_bidder=window.prebidWinner.hb_bidder,a.hb_adid=window.prebidWinner.hb_adid,"&custom[hb_bidder]=".concat(window.prebidWinner.hb_bidder,"&custom[hb_val]=").concat(t)),{TFCD:i?"1":"0"}}},{key:"loadSDKScript",value:function(){var e=this;window.BoltAdManager.SpotxSdk?(window.BoltAdManager.triedCampaigns.push(e.creativeData.ad_id||e.creativeData.listing[0].ad_id),window.BoltAdManager.triedCampaigns=window.BoltAdManager.triedCampaigns.reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[]),e.sdk=new window.SpotX.DirectAdOS({ados:{query_params:"price_floor=0&".concat(e.getVPI()),user:{consent:window.gdprConsents},regs:{gdpr:window.shouldReadGDPRConsents}},ad_mute:!1!==window.CurrentVideoConfig.settings.autoplay?1:0,ad_volume:!1!==window.CurrentVideoConfig.settings.autoplay?0:1,autoplay:!0,blocked_autoplay_override_mode:1,channel_id:e.channelId,content_id:window.id,content_height:e.playerHeight,content_width:e.playerWidth,contentPageUrl:window.parentBaseUrl,custom:e.getCustomParamsObject(),demand_source_timeout:1e4,hide_skin:!0,slot:window.BoltAdManager.container,token:e.getTokenObject(),video_slot:window.BoltAdManager.videoElement}),window.BoltAdManager.SpotxSdk.sdk=Object.create(e.sdk,{fillAdVideoContainer:{value:e.fillAdVideoContainer},resize:{value:e.sdk.resize}}),e.handlePrebid(),e.sdk.loadAd().then((function(t){var n=e.sdk.a.Ca;e.creativeData=e._getCreativeData(),e.environmentVars=e._getEnvironmentVars(),e.frame=e.container.querySelector('[id^="spotx_iframe_"]'),e.sdk.methods=t,e.subscribeEvents(),window.BoltAdManager._dispatchEvent(o.a.Ad.Event.READY),Y.info("Ad Unit loaded. Methods:",t,"\nSpotX SDK: ",e.sdk,e.container,e.video),Y.info("KVP Tokens sent to SpotX: ",n),e.addMacrosToBoltLogger(n),Object(q.f)(o.a.UI.AD_CONTAINER,"block","visible")}),(function(){Y.info("Failed to load Ad Unit")}))):Y.debug("Failed to load SpotX ad; container is missing")}},{key:"handlePrebid",value:function(){var e,t=window.prebidWinner,n=this;if(t&&t.video&&t.video.hasOwnProperty("hb_bidder")&&void 0!==n.sdk.registerBid&&void 0!==n.sdk.competeBids&&(e=n.registerBids(t)))try{e.resolve({price:t.video.hb_val,vast_url:t.video.hb_vast}),n.sdk.competeBids(),Y.info("Sending Prebid prebidWinners: ",t)}catch(t){e.cancel(),Y.info("Prebid attempt [promise] cancelled")}}},{key:"registerBids",value:function(e){e.hb_val=parseFloat(Math.round(e.hb_val)/100).toFixed(2)}},{key:"playAd",value:function(){var e=this,t=o.a.Ad.PLAYER_ID_PREFIX+window.BoltAdManager.containerId;e.hasStarted=!0,e.paused=!1,e.container=window.BoltAdManager.container,Y.info("Loading ".concat(e.provider," JS VPAID")),window.postLogMessage("Loading spotx ad adapter script"),e.client.isMobile&&(e._nativePlayback=!0),window.BoltAdManager.videoElement||(e.video=e.createVideoElement(t)),e.loadSDKScript()}},{key:"createVideoElement",value:function(e){var t=this;return window.BoltAdManager.videoElement=document.createElement("video"),window.BoltAdManager.videoElement.id=e,window.BoltAdManager.videoElement.setAttribute("width","100%"),window.BoltAdManager.videoElement.setAttribute("height","100%"),window.BoltAdManager.videoElement.setAttribute("style","position:absolute;top:0;left:0;bottom:0;right:0;"),t.containerWidth=t.container.window.clientWidth,t.containerHeight=t.container.window.clientHeight,t.container.appendChild(window.BoltAdManager.videoElement),window.BoltAdManager.videoElement.addEventListener("loadstart",t._setNativePlayback),window.BoltAdManager.videoElement}},{key:"subscribeEvents",value:function(){var e=this;e.sdk.subscribe((function(t){try{t=JSON.parse(t)}catch(e){Y.error("Failed to parse AdLog message",{message:e.message,stack:e.stack})}Y.info("AdLog: ",t),window.postLogMessage("".concat("AdLog: <br><b>Title:</b> ").concat(t.title||"","<br>")+"<b>Ad Id:</b> ".concat(t.ad_id||"","<br>")+"<b>Message:</b> ".concat(t.message||"","<br>")+"<b>Code:</b> ".concat(e._getAdLogCode(t.code)))}),"AdLog"),e.sdk.subscribe(e._onAdLoaded.bind(e),"AdLoaded"),e.sdk.subscribe(e._onAdStarted.bind(e),"AdStarted"),e.sdk.subscribe(e._onAdImpression.bind(e),"AdImpression"),e.sdk.subscribe(e._onAdStopped.bind(e),"AdStopped"),e.sdk.subscribe(e._onAdSkipped.bind(e),"AdSkipped"),e.sdk.subscribe(e._onAdVideoStart.bind(e),"AdVideoStart"),e.sdk.subscribe(e._onAdVideoFirstQuartile.bind(e),"AdVideoFirstQuartile"),e.sdk.subscribe(e._onAdVideoMidpoint.bind(e),"AdVideoMidpoint"),e.sdk.subscribe(e._onAdVideoThirdQuartile.bind(e),"AdVideoThirdQuartile"),e.sdk.subscribe(e._onAdVideoComplete.bind(e),"AdVideoComplete"),e.sdk.subscribe(e._onAdClickThru.bind(e),"AdClickThru"),e.sdk.subscribe(e._onAdUserMinimize.bind(e),"AdUserMinimize"),e.sdk.subscribe(e._onAdUserMinimize.bind(e),"AdUserClose"),e.sdk.subscribe(e._onAdPaused.bind(e),"AdPaused"),e.sdk.subscribe(e._onAdPlaying.bind(e),"AdPlaying"),e.sdk.subscribe(e._onAdSizeChange.bind(e),"AdSizeChange"),e.sdk.subscribe(e._onAdRemainingTimeChange.bind(e),"AdRemainingTimeChange"),e.sdk.subscribe(e._onAdVolumeChange.bind(e),"AdVolumeChange"),e.sdk.subscribe(e._onAdError.bind(e),"AdError"),e.onResizeAd=e.onResizeAd.bind(e),window.addEventListener("resize",e.onResizeAd)}},{key:"_getAdLogCode",value:function(e){switch(parseInt(e,10)){case 101:return"Ad Fault\tAn error has occurred with this ad.";case 102:return"VPAID Error\tA VPAID error has occurred.";case 103:return"Endpoint Opt Out\tVAST document provided by the ad returned an empty response, and therefore opted out of the opportunity.";case 104:return"Endpoint Timeout\tThe request for the VAST document took longer than the configured timeout value.";case 105:return"Endpoint Error\tThe request to the endpoint failed due to an error.";case 107:return"Total Fetch Timeout\tAd was not fetched before the configured total fetch timeout.";case 108:return"Total Process Timeout\tNo ad was able to start before the configured total process timeout.";case 109:return"Unplayable Media\tIn a no-Flash environment, but only Flash creatives available.";case 110:return"Ad Throttled\tFlash ad attempted to play, but was throttled by browser.";case 111:return"Ad Loaded!";default:return"No code available"}}},{key:"_onAdLoaded",value:function(e){window.postLogMessage("Ad Loaded"),Y.debug("Ad Loaded",e);var t=this;t.duration=t.sdk.methods.getAdDuration()||t.sdk.methods.getAdRemainingTime(),t.currentTime=0,t.startTime=0,window.BoltAdManager._dispatchEvent(o.a.Media.Event.LOADED),window.BoltAdManager._dispatchEvent(o.a.Media.Event.PLAY),t._dispatchEvent(o.a.Media.Event.PLAY),t._dispatchEvent(o.a.Media.Event.DURATION_CHANGE),t._dispatchEvent(o.a.Media.Event.START_TIME_CHANGED),t.sdk.methods.startAd(),t.fillAdVideoContainer("100%","100%")}},{key:"_onAdStarted",value:function(e){window.postLogMessage("Ad started"),Y.debug("Ad started",e)}},{key:"_onAdImpression",value:function(e){window.postLogMessage("Ad Impression"),Y.debug("Ad Impression",e)}},{key:"_onAdStopped",value:function(e){window.postLogMessage("Ad stopped"),Y.debug("Ad stopped",e),this.complete()}},{key:"_onAdSkipped",value:function(e){window.postLogMessage("Ad skipped"),Y.debug("Ad skipped",e),this.complete()}},{key:"_onAdVideoStart",value:function(e){window.postLogMessage("Ad video start"),Y.debug("Ad video start",e),window.BoltAdManager._dispatchEvent(o.a.Media.Event.PLAYING),this._dispatchEvent(o.a.Media.Event.PLAYING),this.showControlButtons()}},{key:"_onAdVideoFirstQuartile",value:function(e){window.postLogMessage("Ad first quartile "),Y.debug("Ad first quartile ",e),this._dispatchEvent(o.a.Media.Event.FIRSTQUARTILE)}},{key:"_onAdVideoMidpoint",value:function(){this._dispatchEvent(o.a.Media.Event.MIDPOINT)}},{key:"_onAdVideoThirdQuartile",value:function(){this._dispatchEvent(o.a.Media.Event.THIRDQUARTILE)}},{key:"_onAdVideoComplete",value:function(){}},{key:"_onAdUserMinimize",value:function(){window.BoltAdManager._dispatchEvent(o.a.Ad.Event.CLOSED),this.complete()}},{key:"_onAdPaused",value:function(e){window.postLogMessage("Ad paused"),Y.debug("Ad paused",e),window.PlayerState.state===window.PlayerState.PLAYING&&this.pause()}},{key:"_onAdPlaying",value:function(e){var t=this;window.postLogMessage("Ad playing"),Y.debug("Ad playing",e),t.paused=!1,t.sdk.methods.resumeAd(),t._dispatchEvent(o.a.Media.Event.PLAYING),t._dispatchEvent(o.a.Media.Event.RESUME)}},{key:"_onAdClickThru",value:function(e){window.postLogMessage("Ad click through"),Y.debug("Ad click through",e),window.BoltAdManager._dispatchEvent(o.a.Ad.Event.CLICKED)}},{key:"_onAdSizeChange",value:function(){}},{key:"_onAdRemainingTimeChange",value:function(){var e=this;e.currentTime=parseInt(e.duration,10)-parseInt(e.sdk.methods.getAdRemainingTime(),10),e._dispatchEvent(o.a.Media.Event.TIME_UPDATE,e.currentTime)}},{key:"_onAdVolumeChange",value:function(){}},{key:"_onAdLog",value:function(e){try{e=JSON.parse(e)}catch(e){Y.error("SDK AdLog, Failed to parse AdLog message",{message:e.message,stack:e.stack})}Y.info("AdLog: ",e),window.postLogMessage("".concat("AdLog: <br><b>Title:</b> ").concat(e.title||"","<br>")+"<b>Ad Id:</b> ".concat(e.ad_id||"","<br>")+"<b>Message:</b> ".concat(e.message||"","<br>")+"<b>Code:</b> ".concat(this._getAdLogCode(e.code)))}},{key:"_onAdError",value:function(e){var t=this;t._error=!0,window.BoltAdManager.attempts<t.maxAttempts?t._dispatchEvent(o.a.ERROR,e):(Y.debug("Daisy Chain complete after ".concat(window.BoltAdManager.attempts,". No ad found"),e),t.complete())}},{key:"onAdEvent",value:function(e){"AdRemainingTimeChange"!==e&&"AdLog"!==e&&(Y.info("Ad Event: ".concat(e)),window.postLogMessage("".concat(e)))}},{key:"getVPI",value:function(){try{var e=-1,t="VPI[".concat((++e).toString(),"]=VPAID_JS");return this.client.isMobile?this.client.supportedVideoTypes.indexOf("mp4")>=0&&(t+="&VPI[".concat((++e).toString(),"]=MP4")):t+="&VPI[".concat((++e).toString(),"]=VPAID&VPI[").concat((++e).toString(),"]=MP4"),t}catch(e){Y.debug("Error getting VPI (file type) ",e)}}},{key:"_createBoltLoggerMsg",value:function(e){var t="".concat('<span style="color:#ffa500">[Spotx JSVPAID AdLog Event] - AdLog:</span> <br><b style="color:#eee">Title:</b> ').concat(e.title||"","<br>")+'<b style="color:#ddd">Ad Id:</b> '.concat(e.ad_id||"","<br>")+'<b style="color:#ccc">Event Type:</b> '.concat(e.event_type||"","<br>")+'<b style="color:#bbb">Message:</b> '.concat(e.message||"","<br>")+'<b style="color:#aaa">Code:</b> '.concat(e.code.toString()||""," - ").concat(this._getAdLogCode(e.code));if(e.debug&&e.debug.length){var n=e.debug.length;t+="<br><b><u>Debug:</u></b> ";for(var i=0;i<n;i++)for(var a in e.debug[i])t+="<br><b><em>".concat(a,"</em></b>: ").concat(e.debug[i][a])}return t}},{key:"showControlButtons",value:function(){}},{key:"getVolume",value:function(){return void 0!==this.sdk?this.sdk.methods.getAdVolume():null}},{key:"setVolume",value:function(e){var t=this;window.client.isMobile||void 0===t.sdk||void 0===t.sdk.methods||t.volume===e||(Y.debug("Set volume",e),t.volume=e,t.sdk.methods.setAdVolume(e),t._dispatchEvent(o.a.Media.Event.VOLUME_CHANGED,e))}},{key:"mute",value:function(e){var t=this;t.muted=!!e,t.video.muted=t.muted,Y.info("mute",t.muted),e?(t.setVolume(0),t.sdk.methods.setAdVolume(0),t._dispatchEvent(o.a.Media.Event.MUTED)):(t.setVolume(t.client.isMobile?1:this.volume),t.sdk.methods.setAdVolume(t.client.isMobile?1:this.volume),t._dispatchEvent(o.a.Media.Event.UNMUTED))}},{key:"pause",value:function(){var e=this;e.paused=!0,e._dispatchEvent(o.a.Media.Event.PAUSED),window.BoltAdManager._dispatchEvent(o.a.Media.Event.PAUSED),void 0!==e.sdk&&e.sdk.methods.pauseAd()}},{key:"resume",value:function(){void 0!==this.sdk&&(this.sdk.methods.resumeAd(),window.BoltAdManager._dispatchEvent(o.a.Media.Event.PLAYING))}},{key:"onResizeAd",value:function(){var e=this;document.getElementsByClassName("is-sticky-module")[0]||(window.PlayerView.fullscreen?(e.container.style="display:block;",e.sdk.resize(e.container.offsetWidth,e.container.offsetHeight,"fullscreen")):e.sdk.resize(e.container.getAttribute("data-zeus-initial-width")||e.container.offsetWidth,e.container.getAttribute("data-zeus-initial-height")||e.container.offsetHeight),e.setFullscreen(window.PlayerView.fullscreen),Y.info("Ad fullscreen toggled"))}},{key:"fillAdVideoContainer",value:function(e,t){var n=e.toString(),i=t.toString();try{n.indexOf("%")>-1?(window.BoltAdManager.videoElement.style.width=n,window.BoltAdManager.videoElement.style.height=i):(window.BoltAdManager.videoElement.style.width=n,window.BoltAdManager.videoElement.style.height=i,window.BoltAdManager.videoElement.width=parseInt(n,10),window.BoltAdManager.videoElement.height=parseInt(i,10))}catch(e){Y.error("fillAdVideoContainer error",{message:e.message,stack:e.stack})}}},{key:"setFullscreen",value:function(e){e!==this.fullscreen&&(this.fullscreen=e,Y.info("Set fullscreen",e))}},{key:"complete",value:function(){this._isAd=!0,window.BoltAdManager._dispatchEvent(o.a.Ad.Event.COMPLETED),this.end(),Y.info("Ad Complete")}},{key:"end",value:function(){window.BoltAdManager._dispatchEvent(o.a.Media.Event.ENDED),this.sdk.destroy()}},{key:"remove",value:function(){var e=this;e.hasStarted=!1,window.removeEventListener("resize",e.onResizeAd),e.sdk.unsubscribeAll();try{e.container.removeChild(e.frame)}catch(e){}e._removeAssets(),e._removeVideoElement(),window.BoltAdManager.videoElement=null,window.BoltAdManager._dispatchEvent("removed"),Y.info("Ad removed")}},{key:"getCurrentTime",value:function(){var e=this;return void 0!==e.sdk&&void 0!==e.sdk.methods?e.duration-e.currentTime:0}}])&&H(t.prototype,n),i&&H(t,i),s}(U.default);function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(e){return function(e){if(Array.isArray(e))return te(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return te(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ie(e,t){return(ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=se(e);if(t){var a=se(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return re(this,n)}}function re(e,t){return!t||"object"!==Z(t)&&"function"!=typeof t?oe(e):t}function oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function de(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"default",(function(){return pe}));var ce=new a.a("AD-MANAGER"),le=new a.a("AD-SERVER"),ue=3e4,pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(c,e);var t,i,a,d=ae(c);function c(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),de(oe(n=d.call(this)),"_adPlays",0),de(oe(n),"_adSessionCount",0),de(oe(n),"_isTycheRenderBackFilled",!1),de(oe(n),"_kinesisBMHasRecorded",{embedInitToAdLoaded:!1,embedInitToAdReady:!1}),de(oe(n),"adQueue",[]),de(oe(n),"handleServerResponse",(function(e){var t=oe(n),i=e.data,a=e.requestId;if(!i||"string"==typeof i&&0===i.trim().length)ce.warn("Empty response from ad server"),t._retryAdRequest("Empty response.");else try{var r=(new DOMParser).parseFromString(i,"text/xml");t.handleXMLResponse(r,a)}catch(e){ce.warn("Caught Error",{message:e.message,stack:e.stack}),t._retryAdRequest("Bad response.")}})),de(oe(n),"_onAdMediaLoaded",(function(){var e=oe(n);if(e._killDCTimeout(),e.adPlayer){if(e._isLinear=e.adPlayer.isLinear(),e._isLinear||(e.container.style.display="block"),e.container.style.backgroundColor="rgba(0,0,0,0)",ce.info("Ad media fully loaded",{linear:!!e._isLinear,ttl:(Date.now()-e._dcStartTime)/1e3}),window.postLogMessage("Ad media fully loaded, ".concat((Date.now()-e._dcStartTime)/1e3," secs after daisy-chain began")),e.type===o.a.Ad.Type.GOOGLE&&window.AdRequest.setMedia(e.adPlayer.getSource()),window.AdRequest.success(),window.prebidWinner&&!window.kinesis.headerbidHasBeenTracked){var t=window.prebidWinner.hb_bidder,i=window.prebidWinner;"rubicon"===t&&/rubicon(project)?.com/.test(window.prebidWinner.hb_vast)?i.bidder="rubicon":i.bidder="appnexusAst"===t?"appnexus":t,ce.info("Bid winner: ".concat(t,". Now sending impression to kinesis for bidder"),i),window.kinesis.send("ad_impressions",i,"app")}if(e.selectedServer.type!==o.a.Ad.Server.SPOTX&&e.selectedServer.type!==o.a.Ad.Server.SPOTX_SDK?(e.recordCustomAdImpression(),window.SSTracker.success()):e._backfilling&&window.SSTracker.backfillSuccess(e._selectedTag),!e._kinesisBMHasRecorded.embedInitToAdLoaded){e._kinesisBMHasRecorded.embedInitToAdLoaded=!0;try{window.kinesis.send("benchmarks",{type:"bolt_embedInit_to_onAdLoaded",duration:Date.now()-window.bootStartTime},"app")}catch(e){ce.warn("Caught Error",{message:e.message,stack:e.stack})}}}})),de(oe(n),"_onAdReady",(function(){var e={type:"zeus_event",name:"boltSetIframeVisibility",id:window.id,isAd:!0,data:{visibilityVal:"visible"}};if(window.parent.postMessage(JSON.stringify(e),Object(r.h)()),!n._kinesisBMHasRecorded.embedInitToAdReady){n._kinesisBMHasRecorded.embedInitToAdReady=!0;try{window.kinesis.send("benchmarks",{type:"bolt_embedInit_to_onAdReady",duration:Date.now()-window.bootStartTime},"app")}catch(e){ce.warn("Caught Error",{message:e.message,stack:e.stack})}}})),de(oe(n),"_onAdError",(function(e){var t=oe(n),i="string"==typeof e.data?e.data:"Ad Error.";ce.warn("AdError",{message:e.data,type:e.type,adPlayer:t.type}),t._retryAdRequest(i)})),n.linearAdPool=new j,n.overlayAdPool=new j(!0),n.prefetchEnabled=!1,n.containerId=t,n.container=document.getElementById(n.containerId),n.triedCampaigns=[],n.status="none",n.previousStatus="none",n.sequentialPrerollAdRequested=null,n.aborted=!1,n.type=null,n.bestMedia=null,n.ad=null,n._dcTimeout=null,n._dcStartTime=null,n._dcTimeoutReached=!1,ue=e&&"number"==typeof e?e:ue,n.timeout=ue,ce.info("Ad timeout set to",ue/1e3," seconds"),window.postLogMessage("Ad timeout set to ".concat(ue/1e3," seconds"),"info"),n._isLinear=!0,n.selectedServer=null;var i=function(){n.deletePrebidObjects(),n.selectedVMAPBreak&&n.trackVMAPEvent("breakEnd"),n.remove()};return n.addEventListener(o.a.Media.Event.ENDED,(function(){i()}),oe(n)),n.addEventListener(o.a.Media.Event.SKIPPED,(function(){i()}),oe(n)),n.addOnceEventListener(o.a.Ad.Event.READY,n._onAdReady),n.hasBeenTouched=!1,window.client.isMobile&&(n._createVideoElement(),window.ContentPlayer.show(!1)),n._selectedTag=null,n.forcedServer=null,window.tagTestUrl&&(n.forcedServer=o.a.Ad.Server.SPOTX,window.googleIma&&(n.forcedServer=o.a.Ad.Server.DFP)),n.dfpServer=null,n.spotxServer=null,n.spotxSdkServer=null,n.genericServer=null,n.displayBackfillServer=null,n.houseAdServer=null,n._backfilling=!1,n.timing=null,n.adShouldBeQueued=null,n.VMAPAdapter=new I,n.VMAPBreaksForCurrentAdTiming=null,n.selectedVMAPBreak=null,n.processedVMAPSecond=null,n._currentRequestId=null,n.MoatAnalytics=null,n.pixelsContainer=document.createElement("div"),n.pixelsContainer.id="bolt_trackingpixels",n.pixelsContainer.setAttribute("class","position:absolute;bottom:0;left:0;visibility:hidden;width:1px;height:1px;"),document.body.appendChild(n.pixelsContainer),window.PlayerView.addEventListener(o.a.Media.Event.DURATION_CHANGE,(function(){var e=oe(n);window.PlayerView.currentPlayer.isAd()||e.VMAPAdapter.setContentDuration(window.ContentPlayer.duration,(function(t){e._dispatchEvent(o.a.Ad.Event.VMAP_CUEPOINTS_CHANGED,t)}))}),oe(n)),n}return t=c,(i=[{key:"init",value:function(e){var t=this;t.resetStatus(),t.linearAdPool.drain(),t.overlayAdPool.drain(),t.processedVMAPSecond=null,t.VMAPBreaksForCurrentAdTiming=null,t.VMAPAdapter.reset(),t.selectedVMAPBreak=null,t.isUsingVMAP=!1,t.config=window.PlayerSettings.embedAds||window.CurrentVideoConfig.advertising,t.config===window.PlayerSettings.embedAds&&ce.info("Using embed ad settings",t.config),t.selectServer(),window.postLogMessage("Checking if VMAP is used");var n=t.selectedServer&&t.selectedServer.selectTag("vmap");n?t.VMAPAdapter.init(n,(function(){ce.info("Using VMAP"),window.postLogMessage("Found VMAP: ".concat(n)),t.isUsingVMAP=!0,e()}),(function(){window.postLogMessage("VMAP error","error"),e()})):(window.postLogMessage("Not using VMAP"),e())}},{key:"_createVideoElement",value:function(){return window.client.system.ios&&window.PlayerSettings.autoplay?(this.container.innerHTML="<video playsinline muted id='".concat(o.a.Ad.PLAYER_ID_PREFIX).concat(this.containerId,"'></video>"),this.hasBeenTouched=!0):this.container.innerHTML="<video id='".concat(o.a.Ad.PLAYER_ID_PREFIX).concat(this.containerId,"'></video>"),this.videoElement=this.container.firstElementChild,this.videoElement.setAttribute("style","position:absolute;width:100%;height:100%;top:0;left:0;bottom:0;right:0;visibility:hidden"),this.videoElement}},{key:"deletePrebidObjects",value:function(){window.prebidWinner=Object(r.b)(window.prebidWinner),window.PrebidInfo=Object(r.b)(window.PrebidInfo),window.kassandraWinner=Object(r.b)(window.kassandraWinner)}},{key:"resetStatus",value:function(){ce.debug("Reset ad manager"),this.previousStatus=this.status,this.status="none",this.sequentialPrerollAdRequested=null,this.prebidSettings=null,this._isTycheRenderBackFilled=!1,this._adPlays+1>window.prerollAdAmt&&(this.container.style.display="none",this.container.style.visibility="hidden"),this.adPlayer=null,this.ad=null,this.vastDoc=null,this.VMAPAdapter.breaks||(this.selectedServer=null),this.forcedServer=null,window.tagTestUrl&&(this.forcedServer=o.a.Ad.Server.SPOTX,window.googleIma&&(this.forcedServer=o.a.Ad.Server.DFP)),this.adtechGoogleAdCount=null,this.provider=null,this.triedCampaigns=[],this._backfilling=!1,this.timing=null,this.adShouldBeQueued=null,this.adQueue.length=0,this._currentRequestId=null,this.type=null,this.bestMedia=null,this._isLinear=null,this._dcTimeout&&(window.clearTimeout(this._dcTimeout),this._dcTimeout=null),this.forcedServer=null,window.tagTestUrl&&(this.forcedServer=o.a.Ad.Server.SPOTX,window.googleIma&&(this.forcedServer=o.a.Ad.Server.DFP)),this.VMAPBreaksForCurrentAdTiming&&0===this.VMAPBreaksForCurrentAdTiming.length&&(this.VMAPBreaksForCurrentAdTiming=null),this.selectedVMAPBreak=null,this._selectedTag=null,this.container.style.width="100%",this.container.style.height="".concat(this.container.getAttribute("data-zeus-initial-height"),"px"),this.container.style.bottom=0,this.container.style.top=0,this.container.style.left=0,this.container.style.right=0,this.container.style.backgroundColor="",this.MoatAnalytics=null}},{key:"clearTrackingImages",value:function(){if(this.pixelsContainer&&this.pixelsContainer.firstElementChild)for(;this.pixelsContainer.firstElementChild;)this.pixelsContainer.removeChild(this.pixelsContainer.firstElementChild)}},{key:"createServers",value:function(e){for(var t=this,n=0,i=t.config.servers.length;n<i;n++){var a=new B(t.config.servers[n]);e&&(a.type=e),a.type===o.a.Ad.Server.DFP?t.dfpServer=a:a.type===o.a.Ad.Server.SPOTX?t.spotxServer=a:a.type===o.a.Ad.Server.SPOTX_SDK?t.spotxSdkServer=a:a.type===o.a.Ad.Server.DISPLAY_BACKFILL?t.displayBackfillServer=a:a.type===o.a.Ad.Server.HOUSE_AD?t.houseAdServer=a:t.genericServer=a,le.debug("Ad Server: ".concat(a.type))}}},{key:"getSelectedServer",value:function(e){var t=this;return e===o.a.Ad.Server.DFP?t.dfpServer:e===o.a.Ad.Server.SPOTX||e===o.a.Ad.Server.SPOTX_SDK?t.spotxServer:e===o.a.Ad.Server.DISPLAY_BACKFILL?t.displayBackfillServer:e===o.a.Ad.Server.HOUSE_AD?t.houseAdServer:e===o.a.Ad.Server.GENERIC_GOOGLE||e===o.a.Ad.Server.GENERIC_VAST||t.genericServer?t.genericServer:t.dfpServer||t.spotxServer||t.spotxSdkServer}},{key:"selectServer",value:function(){var e=this;return e.selectedServer||(e.dfpServer=null,e.spotxServer=null,e.spotxSdkServer=null,e.displayBackfillServer=null,e.houseAdServer=null,e.genericServer=null,e.createServers(this.forcedServer),e.selectedServer=e.getSelectedServer(this.forcedServer),e.selectedServer&&(e.selectedServer.attempts=0)),e.selectedServer}},{key:"hasVMAPBreak",value:function(e){if(Math.floor(e)===this.processedVMAPSecond)return!1;var t=this.VMAPAdapter.getBreaks(e);return t&&ce.info("Found VMAP ad break at ".concat(e,"s")),!!t}},{key:"prefetchAds",value:function(e,t,n){var i=this;if(i.selectServer(),i.selectedServer)try{var a=i.selectedServer.selectTag(e);if(a){var r="overlay"===e?i.overlayAdPool:i.linearAdPool;r.serverType=i.selectedServer.type,r.serverType!==o.a.Ad.Server.SPOTX&&r.serverType!==o.a.Ad.Server.SPOTX_SDK?r.setSize(1):r.setSize(3),n?r.refill(a,(function(){t&&t()})):r.fill(a,e,(function(){t&&t()}))}else t&&t()}catch(e){ce.warn("Caught Error",{message:e.message,stack:e.stack}),t&&t()}else ce.info("Prefetch failed, no timing tag in config",{timing:e}),t&&t()}},{key:"requestAd",value:function(e){var t=this,n=e.timing,i=e.cuepoint,a=e.callbackIfRequestAccepted,r=e.loadAd;if("overlay"===t.timing&&(window.AdSession.complete(),t.remove()),!t._prepareForAdRequest(e))return!0===r&&!0===t.adShouldBeQueued&&(t.adShouldBeQueued=!1,t._playCb(),!0);t._backfilling=!1,t.timeout=ue,t.container.style.display="block",t.VMAPAdapter.breaks&&(t.VMAPBreaksForCurrentAdTiming||(t.VMAPBreaksForCurrentAdTiming="midroll"===n?t.VMAPAdapter.getBreaks(i):t.VMAPAdapter.getBreaks(n))),t.tycheRequestBackFill(),"function"==typeof a&&a(),Object(F.a)().then((function(e){t.DOMPosition=e,t._start()}))}},{key:"requestOverlay",value:function(e,t,n){var i=this;if(!i._prepareForAdRequest({timing:"overlay",cuepoint:e,callbackIfRequestAccepted:t}))return null;i.timeout=15e3,ce.info("Requesting overlay ad"),window.postLogMessage("Requesting overlay ad"),i._start(n)}},{key:"_prepareForAdRequest",value:function(e){var t,n,i=this,a=e.timing,r=e.cuepoint,o=e.adShouldBeQueued,s=e.loadAd;return"none"!==i.status||s?(s?(ce.info("loadAd() API called. Play Ad"),null===(t=window)||void 0===t||null===(n=t.BoltLogger)||void 0===n||n.info("loadAd() API called. Play Ad")):(ce.info("Currently requesting ad, skipping the new request (".concat(a,", ").concat(r,"s)")),window.postLogMessage("Currently requesting ad, skipping the new request","warn")),!1):(ce.info("Preparing to make new ad request (".concat(a,", ").concat(r,"s)")),i.clearTrackingImages(),i.selectedServer||i.selectServer(),i.timing=a,i.cuepoint=r,i.adShouldBeQueued=!!o,i.aborted=!1,i.previousStatus=i.status,i.status="requesting",window.AdSession.reset(),window.AdRequest.reset(),window.SSTracker.reset(),!0)}},{key:"startDCTimer",value:function(e){var t=this,n=new Date;ce.info("Ad request started",{ts:n}),window.postLogMessage("Ad request starts at ".concat(n)),t._dcTimeoutReached=!1,t._dcTimeout&&(clearTimeout(t._dcTimeout),t._dcTimeout=null),t._dcStartTime=n.getTime(),t._dcTimeout=setTimeout((function(){var e=new Date;ce.warn("Ad request timeout reached ",{ts:e}),window.postLogMessage("Ad request timeout reached ".concat(e),"error"),t._dcTimeoutReached=!0,t._fail()}),e||t.timeout)}},{key:"_start",value:function(e){var t=this;if(t._selectedTag=null,t.type=null,window.AdRequest.reset(),!t.aborted){if(!t.selectedServer)return"function"==typeof e&&e.call(null),t.resetStatus(),void t._dispatchEvent(o.a.Ad.Event.TAG_NOT_AVAILABLE);if(t._backfilling&&window.postLogMessage("Starting backfill."),t.isUsingVMAP&&!t._backfilling&&"overlay"!==t.timing?(ce.debug("Trying to find a VMAP break"),window.postLogMessage("Looking for a VMAP break"),t.VMAPBreaksForCurrentAdTiming&&t.VMAPBreaksForCurrentAdTiming.length>0&&(t.processedVMAPSecond=t.cuepoint,ce.info("Using VMAP Breaks :",t.VMAPBreaksForCurrentAdTiming),window.postLogMessage("Found a VMAP break @".concat(t.cuepoint,"s")),t.selectedVMAPBreak=t.VMAPBreaksForCurrentAdTiming.shift(),t._selectedTag=t.selectedVMAPBreak?t.selectedVMAPBreak.adURI:null,t._selectedTag&&/doubleclick.net/i.test(t._selectedTag)&&(t.type=o.a.Ad.Type.GOOGLE,t.provider=o.a.Ad.Provider.GOOGLE))):t._selectedTag=t.selectedServer.selectTag(t.timing),!t._selectedTag)return t.isUsingVMAP&&"overlay"!==t.timing?(ce.warn("No ".concat(t.timing," VMAP break found")),window.postLogMessage("No ".concat(t.timing," VMAP break found"),"error")):(ce.error("No ".concat(t.timing," tag in config")),window.postLogMessage("No ".concat(t.timing," tag in config"),"error")),"function"==typeof e&&e.call(null),t.resetStatus(),void t._dispatchEvent(o.a.Ad.Event.TAG_NOT_AVAILABLE);t._dispatchEvent(o.a.Ad.Event.REQUESTED);var n=function(){t.src=Object(r.A)(t.src),t.selectedServer.attempts=0,t._dcTimeout||t.startDCTimer(),window.AdSession.start(t._backfilling),t._backfilling?window.SSTracker.backfill(t._selectedTag):t.selectedServer.type!==o.a.Ad.Server.SPOTX_SDK&&window.SSTracker.start({tag:t._selectedTag,timing:t.timing,serverType:t.selectedServer.type,vmap:t.isUsingVMAP?t.VMAPAdapter.primaryTag:null}),t.daisyChain()};if(t.src=t._selectedTag.concat(),t.adLoadTimeStart=Date.now(),t.prefetchEnabled)n();else{t.prebidSettings=Object(F.c)(t.selectedServer.siteTags),t.prebidSettings.timing=t.timing,t.prebidSettings.serverType=t.selectedServer.type,ce.debug("Prebid settings",t.prebidSettings);var i=!0;void 0!==t.prebidSettings.requestBeforeTimeout&&(i=t.prebidSettings.requestBeforeTimeout);var a="preroll"!==t.timing||i?"prebid":"waitForPrebid",s="preroll"===t.timing&&i;t.selectedServer.type===o.a.Ad.Server.SPOTX?!t.prebidSettings||t.prebidSettings.enabled&&!s?MessageChannel.sendRequest(a,(function(){n()}),t.prebidSettings):n():t.selectedServer.type===o.a.Ad.Server.DFP?!t.prebidSettings||t.prebidSettings.enabled&&!s?MessageChannel.sendRequest(a,(function(){t.initGoogleDFPSDK(t._currentRequestId)}),t.prebidSettings):t.initGoogleDFPSDK(t._currentRequestId):t.selectedServer.type===o.a.Ad.Server.SPOTX_SDK?!t.prebidSettings||t.prebidSettings.enabled&&!s?MessageChannel.sendRequest(a,(function(){t.initSpotxSDK(t._currentRequestId)}),t.prebidSettings):t.initSpotxSDK(t._currentRequestId):!t.prebidSettings||t.prebidSettings.enabled&&!s?MessageChannel.sendRequest(a,(function(){n()}),t.prebidSettings):n()}}}},{key:"tycheRequestBackFill",value:function(){var e={action:"boltRequestBackFill",id:window.id};window.parent.postMessage(JSON.stringify(e),Object(r.h)())}},{key:"tycheRenderBackFill",value:function(){var e=this;e._isTycheRenderBackFilled=!0,e.type=o.a.Ad.Type.DISPLAY_BACKFILL,e.forcedServer=e.type,e.selectedServer=null,e.selectServer(),e.playAd()}},{key:"requestHouseAd",value:function(){var e=this;e.type=o.a.Ad.Type.HOUSE_AD,e.forcedServer=e.type,e.selectedServer=null,e.selectServer(),e.playAd()}},{key:"daisyChain",value:function(){var e=this;if(e.adtechGoogleAdCount=null,e.bestMedia=null,e.provider=null,window.AdRequest.reset(),e.removeAllListeners("clicked"),e.removeEventListener(o.a.Media.Event.LOADED,e._onAdMediaLoaded),e.adPlayer&&e.adPlayer.removeEventListener(o.a.ERROR,e._onAdError),!e.aborted){if(e._dcTimeoutReached)return ce.error("Daisy chain timeout."),void window.postLogMessage("Timeout","error");var t;if(e.selectedServer||e.selectServer(),e.selectedServer.attempts++,e.selectedServer.attempts>1&&(e._kinesisBMHasRecorded.embedInitToAdLoaded=!0,e._kinesisBMHasRecorded.embedInitToAdReady=!0),ce.info("Ad attempt #".concat(e.selectedServer.attempts," of ").concat(e.selectedServer.maxAttempts)),window.postLogMessage("Attempt #".concat(e.selectedServer.attempts," of ").concat(e.selectedServer.maxAttempts)),e.selectedServer.type===o.a.Ad.Server.DFP&&(window.kassandraWinner?(Object(r.b)(window.kassandraWinner),window.kassandraWinner=null,ce.info("Removing kassandra prebid object and requesting DFP again"),window.postLogMessage("Removing kassandra prebid object and requesting DFP again")):(null===(t=window.prebidWinner)||void 0===t?void 0:t.hb_bidder)?(e.deletePrebidObjects(),ce.info("DFP request attempt #2 without prebid"),window.postLogMessage("DFP request attempt #2 without prebid")):(e.selectedServer.attempts++,ce.info("No prebid winners, no DFP daisy chain request attempt #2"))),e.selectedServer.attempts>e.selectedServer.maxAttempts)return ce.info("Max ad attempts ".concat(e.selectedServer.maxAttempts," exhausted")),window.postLogMessage("Max ad attempts ".concat(e.selectedServer.maxAttempts," exhausted."),"error"),e.deletePrebidObjects(),e._fail(),null;e._backfilling||(e.selectedServer.type===o.a.Ad.Server.GENERIC_GOOGLE||e.isUsingVMAP)&&window.AdRequest.start(e._selectedTag,null,e.selectedServer.attempts);var n=!e.SpotxSdk&&e.selectedServer.spotxChannelId&&(e.selectedServer.type===o.a.Ad.Server.SPOTX_SDK||e.isUsingVMAP&&e.type===o.a.Ad.Type.SPOTX);if(e._currentRequestId=Date.now(),e.selectedServer.type===o.a.Ad.Server.GENERIC_GOOGLE||window.googleIma||e.isUsingVMAP&&e.type===o.a.Ad.Type.GOOGLE)if(e.prefetchEnabled){var i=("overlay"===e.timing?e.overlayAdPool:e.linearAdPool).getAd();i&&i.ad?(e.src=i.ad,e.processCustomGoogleAd()):e._fail()}else e.processCustomGoogleAd();else e.selectedServer.type===o.a.Ad.Server.DFP?e.initGoogleDFPSDK(e._currentRequestId):n?e.initSpotxSDK(e._currentRequestId):e.SpotxSdk?e._spotxSdkPlayer():e._loadNewTag()}}},{key:"_excludeAdCampaignKeys",value:function(){var e=this;e.triedCampaigns.length>0&&(e.triedCampaigns=[].concat(ee(e.triedCampaigns),ee(window.heavyAds)).reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[]),e.selectedServer.type===o.a.Ad.Server.SPOTX&&(e.src="".concat(e.src,"&ads_to_block[]=").concat(e.triedCampaigns.join("&ads_to_block[]="))))}},{key:"getCustomReportParams",value:function(){var e,t,n="";return(null===(e=window.CurrentVideoConfig)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.customReporting)&&window.CurrentVideoConfig.settings.customReporting.forEach((function(e){n+="&".concat(e.key,"=").concat(e.value)})),n}},{key:"_loadNewTag",value:function(){var e=this;if(!e.aborted){var t=function(){var t=e._currentRequestId;if(1===e.selectedServer.attempts?window.AdRequest.start(e.src,e.thirdPartyTag||null,e.selectedServer.attempts,e.bid):window.AdRequest.start(e.src,e.thirdPartyTag||null,e.selectedServer.attempts),e.prefetchEnabled&&!e._backfilling){var n="overlay"===e.timing?e.overlayAdPool:e.linearAdPool,i=n.getAd();i&&i.ad?(e.type=i.type,window.AdRequest.campaignId=i.campaignId,i.type!==o.a.Ad.Type.VAST&&i.type!==o.a.Ad.Type.OVERLAY||(ce.info("Using cached VAST ad from ".concat(e.timing," ").concat(n.name," pool")),window.postLogMessage(" Using cached VAST ad from ".concat(e.timing," ").concat(n.name," pool")),e.successfulVASTResponse(i.ad,t))):(ce.info("No ad from ".concat(e.timing," ").concat(n.name," pool")),e._retryAdRequest("No ad in ".concat(e.timing," ").concat(n.name," pool")))}else{e.selectedServer.type===o.a.Ad.Server.SPOTX&&e.spotxServer&&("prefetching"!==e.previousStatus||e.selectedServer.attempts>1)&&e._excludeAdCampaignKeys(),ce.debug("Loading tag: ".concat(e.src)),window.postLogMessage("Loading tag: ".concat(e.src));var a=e.selectedServer.type===o.a.Ad.Server.SPOTX||e.selectedServer.type===o.a.Ad.Server.SPOTX_SDK;Object(r.F)({url:e.src,method:"get",requestId:t,withCredentials:a}).then(e.handleServerResponse).catch((function(t){e._retryAdRequest("Network error. Id: ".concat(t))}))}};e.selectedServer.type===o.a.Ad.Server.SPOTX&&e.spotxServer&&(e.src=s.d(e.src),e.src=s.c(e.src),e.src=s.b(e.src),e.src+="&custom[daisy_chain_count]=".concat(e.selectedServer.attempts),window.OverwolfSysData&&(e.src+=s.e(window.OverwolfSysData)),window.shouldReadGDPRConsents)?s.a(e.src,(function(){t()})):t()}}},{key:"_retryAdRequest",value:function(e){var t="string"==typeof e?e:"Error.";window.AdRequest.fail(t),window.postLogMessage("".concat(t," Retrying."),"warn"),this.previousStatus=this.status,this.status="failed",this.src=this._selectedTag.concat(),this.daisyChain()}},{key:"_fail",value:function(){var e,t,n,i,a=this;if(a.adtechGoogleAdCount=null,!a._isTycheRenderBackFilled&&window.displayBackfill&&window.displayBackfill.enabled)a.tycheRenderBackFill();else if((null===(e=window.CurrentVideoConfig)||void 0===e||null===(t=e.advertising)||void 0===t?void 0:t.houseAd)||(null===(n=window.CurrentVideoConfig)||void 0===n||null===(i=n.advertising)||void 0===i?void 0:i.houseAds))a.requestHouseAd();else if(a.adPlayer&&(a.adPlayer.remove(),a.adPlayer.removeEventListener(o.a.ERROR,a._onAdError),a.adPlayer=null),a.removeEventListener(o.a.Media.Event.LOADED,a._onAdMediaLoaded),!a.aborted)return!a.selectedServer||a._dcTimeoutReached?(a.resetStatus(),void a._dispatchEvent(o.a.Ad.Event.FAILED)):void(a.selectedServer.type!==o.a.Ad.Server.SPOTX&&a.selectedServer.type!==o.a.Ad.Server.SPOTX_SDK&&a.selectedServer.type!==o.a.Ad.Server.DFP?(a._selectedTag&&window.SSTracker.fail(),a.config===window.PlayerSettings.embedAds&&(a.config=window.CurrentVideoConfig.advertising,a.createServers()),a.dfpServer||a.spotxServer||a.spotxSdkServer?(ce.warn("Custom tag failed",{tag:a._selectedTag}),window.postLogMessage("Self-service tag failed.","warn"),a._backfilling=!0,a.triedCampaigns=[],a.selectedServer=a.dfpServer||a.spotxServer||a.spotxSdkServer,window.AdSession.fail(),window.setTimeout((function(){ce.info("Starting a new ad session"),a._start()}),100)):(a._selectedTag&&a.recordCustomAdImpression(),ce.info("No Ad",{ts:Date.now()}),window.postLogMessage("No Ad","error"),a.resetStatus(),a._dispatchEvent(o.a.Ad.Event.FAILED))):"overlay"===a.timing?(a._backfilling&&(a.recordCustomAdImpression(),window.SSTracker.backfillFail(a._selectedTag)),a.resetStatus(),ce.info("No overlay Ad"),window.postLogMessage("No overlay Ad","error"),a._dispatchEvent(o.a.Ad.Event.FAILED)):(a._backfilling&&(a.recordCustomAdImpression(),window.SSTracker.backfillFail(a._selectedTag)),ce.info("No Ad",{ts:Date.now()}),window.postLogMessage("No Ad","error"),a.resetStatus(),a._dispatchEvent(o.a.Ad.Event.FAILED)))}},{key:"handleXMLResponse",value:function(e,t){var i=this;if(t!==i._currentRequestId||i.aborted)ce.warn("Request id does not match the current id",{requestId:t,currentRequestId:i._currentRequestId});else{if(i.selectedServer.type===o.a.Ad.Server.SPOTX_SDK)return i.type=o.a.Ad.Type.VAST,void i._parseVAST(e,t);if(i._dcTimeoutReached)return ce.warn("Received a response from ad server but daisy chain timeout limit has been reached, exit."),window.postLogMessage("Received a response from ad server but timeout limit has been reached, exit.","error"),window.AdRequest.fail("Daisy-chain timeout"),void window.kinesis.send("bolt_ad_errors",{tag:i._selectedTag,message:"Daisy-chain timeout"},"boltAds");if(null===e)return window.kinesis.send("bolt_ad_errors",{tag:i._selectedTag,serverType:i.selectedServer.type,message:"Bad response"},"boltAds"),void i._retryAdRequest("Bad response");i.vastDoc=e;var a=Object(r.E)(e);if(null===a?i.type="unknown":void 0!==a.VAST?i.type=o.a.Ad.Type.VAST:i.type="unknown",ce.debug("Received a response",e),window.postLogMessage("Received a response","success"),i.type===o.a.Ad.Type.VAST){var d=e.getElementsByTagName("VASTAdTagURI")[0],c=function(){var t;try{t=e.getElementsByTagName("Ad")[0]}catch(e){}return t}();if(void 0!==c){if("overlay"===i.timing&&(i.type=o.a.Ad.Type.OVERLAY),i.campaignId=c.id,i.campaignId&&(i.selectedServer.type===o.a.Ad.Server.SPOTX?(i.triedCampaigns.push(s.f(i.campaignId)),window.AdRequest.campaignId=s.f(i.campaignId)):(i.triedCampaigns.push(i.campaignId),window.AdRequest.campaignId=i.campaignId)),d){var l=d.textContent;try{i.thirdPartyTag=Object(r.A)(l)}catch(e){ce.warn("Caught Error",{message:e.message,stack:e.stack})}if(-1!==l.indexOf("adotube.com")&&"preroll"!==i.timing)return ce.debug("Received Adotube tag not in preroll. Retrying."),void i._retryAdRequest("Received Adotube tag, but not in a preroll.");if(-1!==l.indexOf("delivery.vidible.tv")&&"preroll"!==i.timing)return ce.debug("Received AOL tag not in preroll. Retrying."),void i._retryAdRequest("Received AOL tag, but not in a preroll.")}else ce.info("No VAST Ad tag URI.");"true"===c.getAttribute("moatAnalytics")?(ce.debug("Found MOAT analytics switch"),window.postLogMessage("MOAT analytics is enabled"),n.e(15).then(n.bind(null,43)).then((function(e){var t=e.default;i.MoatAnalytics=t,i.MoatAnalytics.container=i.container,i.MoatAnalytics.configure({level1:c.getAttribute("moatAdvertiser"),level2:c.getAttribute("moatCampaign"),level3:c.getAttribute("moatLineItem"),level4:c.getAttribute("moatCreative"),slicer1:c.getAttribute("moatSite"),slicer2:c.getAttribute("moatPlacement"),partnerCode:c.getAttribute("moatPartnerCode")})})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})}))):(i.MoatAnalytics=null,i._parseVAST(e,t))}else ce.warn("Empty VAST document."),window.kinesis.send("bolt_ad_errors",{tag:i._selectedTag,serverType:i.selectedServer.type,message:"Empty VAST document"},"boltAds"),i.selectedServer.type===o.a.Ad.Server.SPOTX?i._fail():i._retryAdRequest("Bad response")}else ce.warn("bad response from ad server"),i._retryAdRequest("Bad response")}}},{key:"_parseVAST",value:function(e,t){var n=this;ce.info("Processing VAST XML",{xml:e}),window.postLogMessage("Processing VAST XML"),new g(e,(function(e,i){n.successfulVASTResponse(e,t,i)}))}},{key:"successfulVASTResponse",value:function(e,t,n){var i=this;if(n&&(window.postLogMessage("VAST XML has been processed. ".concat(n?"CPM: ".concat(n.toString()):"")),ce.info("VAST XML has been processed",{cpm:n?n.toString():""})),t===i._currentRequestId&&!i.aborted){if(i._dcTimeoutReached)return ce.warn("Received a VAST ad but daisy chain timeout limit has been reached, exit."),window.postLogMessage("Received a VAST ad but timeout limit has been reached, exit.","error"),void window.AdRequest.fail("Timeout");if(null==e)ce.warn("Empty VAST document"),i._retryAdRequest("Empty VAST document.");else{i.ad=e.getAd(!0);var a=i.ad.linear.getAllMediaAsObject(),s=[o.a.Mime.JS,o.a.Mime.XJS,o.a.Mime.MP4,o.a.Mime.WEBM,o.a.Mime.OGG];if(i.bestMedia=Object(r.f)(Object(r.d)(a),s),null!==i.bestMedia){this.previousStatus=this.status,i.status="media_located",ce.info("Found a playable ad media file",i.bestMedia),/dcm/i.test(i.ad.properties.AdSystem)||/googleapis.com\/.*\/vpaid_adapter.js$/.test(i.bestMedia.src)||window.tagTestUrl&&window.googleIma?(window.postLogMessage("Found a Google DCM VAST/VPAID"),i.provider=o.a.Ad.Provider.GOOGLE,i.type=o.a.Ad.Type.GOOGLE_DCM_VPAID):(window.postLogMessage("Found a playable ad media file :".concat(i.bestMedia.src)),i.bestMedia.type!==o.a.Mime.JS&&i.bestMedia.type!==o.a.Mime.XJS||(i.type=o.a.Ad.Type.JS_VPAID,i.bestMedia.src.indexOf("yume_vpaid.js")>-1?i.provider=o.a.Ad.Provider.YUME:i.bestMedia.src.indexOf("vidible.tv")>-1?i.provider=o.a.Ad.Provider.AOL:/spotxcdn.com/.test(i.bestMedia.src)?i.provider=o.a.Ad.Provider.SPOTX:/redir.adap.tv/.test(i.bestMedia.src)?i.provider=o.a.Ad.Provider.ADAP:/moatwrapper.js/.test(i.bestMedia.src)?i.provider=o.a.Ad.Provider.MOAT:/s-static.innovid.com/i.test(i.bestMedia.src)?i.provider=o.a.Ad.Provider.INNOVID:/ds.serving-sys.com\/.*\/VPAIDAPI.js$/i.test(i.bestMedia.src)?(i.provider=o.a.Ad.Provider.SIZMEK,i.type=o.a.Ad.Type.GOOGLE_DCM_VPAID):/ads.celtra.com/i.test(i.bestMedia.src)?i.provider=o.a.Ad.Provider.CELTRA:i.provider="generic",(i.config.useIMAForVPAID||window.tagTestUrl&&window.googleIma)&&(window.postLogMessage("Playing JS VPAID with IMA SDK"),i.type=o.a.Ad.Type.GOOGLE_DCM_VPAID)));var d=function(){i.MoatAnalytics?i.MoatAnalytics.init({duration:i.ad.linear.getDuration(),videoUrl:i.bestMedia},(function(){i.playAd()})):i.playAd()};if(i.sequentialPrerollAdRequested){i.previousStatus=i.status;var c=0,l=window.setInterval((function(){window.PlayerView.currentPlayer.ended?(window.clearTimeout(l),d()):++c>1e3*o.a.Ad.AD_PREFETCH_TIME_BEFORE_VID_ENDS&&window.clearTimeout(l)}),10)}else d()}else ce.info("No playable ad media"),i._retryAdRequest("No playable ad media.")}}}},{key:"processCustomGoogleAd",value:function(){var e=this;if(!e.aborted){if(e._dcTimeoutReached)return ce.warn("About to process custom google ad but daisy chain timeout limit has been reached."),void window.postLogMessage("About to process custom google ad but timeout limit has been reached","error");e.videoElement&&(e.videoElement.style.display="none"),e.type=o.a.Ad.Type.GOOGLE,e.playAd()}}},{key:"initSpotxSDK",value:function(e){var t=this;if(!t.aborted)return t._dcTimeoutReached?(ce.warn("About to initialize SpotX SDK ad but daisy chain timeout limit has been reached."),void window.postLogMessage("About to initialize SpotX SDK ad but timeout limit has been reached.","error")):void n.e(25).then(n.bind(null,44)).then((function(n){var i=n.default;t.SpotxSdk=new i,t.SpotxSdk.getVASTAd().then((function(n){var i;t.campaignId=n.getElementsByTagName("Ad")[0].id||"",window.AdSession.start(t._backfilling),t.ad=n,t.handleXMLResponse(t.ad,e);try{i=decodeURIComponent(t.src)}catch(e){i=t.src}ce.info("Processing VAST XML from SpotxSDK",{ad:t.ad,src:i}),window.postLogMessage("Loading SpotX SDK tag: ".concat(i))})).catch((function(e){ce.warn("Caught Error",{message:e.message,stack:e.stack}),t._fail()}))})).catch((function(e){ce.warn("Caught Error",{message:e.message,stack:e.stack})}))}},{key:"initGoogleDFPSDK",value:function(e){var t=this;if(!t.aborted){if(t._dcTimeoutReached)return ce.debug("About to initialize Google IMA SDK for DFP but timeout limit has been reached",{requestId:e}),void window.postLogMessage("About to initialize Google IMA SDK for DFP but timeout limit has been reached.","error");window.AdSession.start(),window.postLogMessage("Google DFP ad.  Request ID: ".concat(e)),t.selectedServer.attempts=t.selectedServer.attempts||1,1===t.selectedServer.attempts?(ce.info("Ad attempt #".concat(t.selectedServer.attempts," of ").concat(t.selectedServer.maxAttempts)),window.postLogMessage("Attempt #".concat(t.selectedServer.attempts," of ").concat(t.selectedServer.maxAttempts)),window.AdRequest.start(t.src,null,t.selectedServer.attempts,t.bid)):window.AdRequest.start(t.src,null,t.selectedServer.attempts),window.AdRequest.campaignId=t.campaignId,n.e(8).then(n.bind(null,45)).then((function(e){var n=e.default;t.provider=o.a.Ad.Provider.GOOGLE,t.type=o.a.Ad.Type.GOOGLE_DCM_VPAID,t.adPlayer=new n,t._playCb()})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})}))}}},{key:"trackVMAPEvent",value:function(e){this.selectedVMAPBreak.trackingEvents&&(ce.debug("Tracking vmap event",{event:e}),window.postLogMessage("Tracking vmap ".concat(e)),this.selectedVMAPBreak.trackingEvents.track(e))}},{key:"_killDCTimeout",value:function(){var e=this;e._dcTimeout&&(ce.debug("Kill DC timeout"),clearTimeout(e._dcTimeout),e._dcTimeout=null)}},{key:"_spotxSdkPlayer",value:function(){var e=this;e.selectedServer.attempts=e.selectedServer.attempts||1,1===e.selectedServer.attempts?window.AdRequest.start(e.src,null,e.selectedServer.attempts,e.bid):window.AdRequest.start(e.src,null,e.selectedServer.attempts),window.AdRequest.campaignId=e.campaignId,e.adPlayer=new $(e.bestMedia,e.ad.linear.parameters),e._playCb()}},{key:"_playCb",value:function(){var e=this;if(!e.aborted){if(e.adShouldBeQueued)return e._dispatchEvent(o.a.Ad.Event.QUEUED,{requestAdAPI:!0,adFilled:!0}),void e.adQueue.push(e.ad);ce.debug("Trying to play the ad in ".concat((Date.now()-e._dcStartTime)/1e3," secs after daisy-chain began")),window.postLogMessage("Trying to play the ad in ".concat((Date.now()-e._dcStartTime)/1e3," secs after daisy-chain began")),e.selectedServer&&e.selectedServer.type!==o.a.Ad.Server.DFP&&(e.selectedServer.type===o.a.Ad.Server.GENERIC_GOOGLE||e.isUsingVMAP&&e.type===o.a.Ad.Type.GOOGLE||e.selectedServer.type===o.a.Ad.Server.DFP?e.adPlayer.customTag=e.src:e.type===o.a.Ad.Type.GOOGLE_DCM_VPAID&&(e.adPlayer.customTag=e.src.replace(";acao=*",""),ce.info("Tag for Google Player ",{tag:e.adPlayer.customTag}))),e._dcTimeout||e.startDCTimer(),e.adPlayer.addOnceEventListener(o.a.ERROR,e._onAdError),e.addOnceEventListener(o.a.Media.Event.LOADED,e._onAdMediaLoaded);try{window.kinesis.send("benchmarks",{type:"ads_loadNewTag_to_playCb",duration:Date.now()-e.adLoadTimeStart},"app")}catch(e){ce.warn("Caught Error",{message:e.message,stack:e.stack})}e.adLoadTimeStart=null,ce.info("Ad load time",{ttl:Date.now()-e.adLoadTimeStart}),(e.adQueue.length>0||!e.adShouldBeQueued)&&(e.adQueue.length>0&&(e.ad=e.adQueue.pop(),e.adQueue.length=0),e.adPlayer.playAd(),e._dispatchEvent(o.a.Ad.Event.READY),window.prerollAdAmt&&(e._adPlays+=1))}}},{key:"playAd",value:function(){var e,t=this;try{e=JSON.parse(t.ad.linear.parameters).ad_id}catch(e){ce.debug("Unable to JSON parse creative data inside spotx adapter")}if(!t.aborted)if(window.AdRequest.adType=t.type,window.AdRequest.network=t.provider,t.type!==o.a.Ad.Type.GOOGLE&&t.type!==o.a.Ad.Type.DISPLAY_BACKFILL&&t.type!==o.a.Ad.Type.HOUSE_AD&&window.AdRequest.setMedia(t.bestMedia.src,t.bestMedia.type),t.container.style.visibility="visible",t.type===o.a.Ad.Type.VAST)n.e(26).then(n.bind(null,58)).then((function(e){var n=e.default;t.adPlayer=new n(t),t._playCb()})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})}));else if(t.type===o.a.Ad.Type.JS_VPAID)ce.info("Playing JS VPAID ",t.provider),t.provider===o.a.Ad.Provider.YUME?n.e(27).then(n.bind(null,46)).then((function(e){var n=e.default;t.adPlayer=new n(t.bestMedia,t.ad.linear.parameters),t._playCb()})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})})):t.provider===o.a.Ad.Provider.AOL?n.e(4).then(n.bind(null,47)).then((function(e){var n=e.default;t.adPlayer=new n(t.bestMedia,t.ad.linear.parameters),t._playCb()})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})})):t.provider===o.a.Ad.Provider.SPOTX?t.selectedServer.type===o.a.Ad.Server.SPOTX_SDK&&t.selectedServer.spotxChannelId?t._spotxSdkPlayer():n.e(24).then(n.bind(null,48)).then((function(e){var n=e.default;t.adPlayer=new n(t,t.bestMedia,t.ad.linear.parameters),t._playCb()})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})})):t.provider===o.a.Ad.Provider.ADAP?n.e(1).then(n.bind(null,49)).then((function(e){var n=e.default;t.adPlayer=new n(t.bestMedia,t.ad.linear.parameters),t._playCb()})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})})):t.provider===o.a.Ad.Provider.MOAT?n.e(16).then(n.bind(null,50)).then((function(e){var n=e.default;t.adPlayer=new n(t.bestMedia,t.ad.linear.parameters),t._playCb()})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})})):t.provider===o.a.Ad.Provider.CELTRA?n.e(5).then(n.bind(null,51)).then((function(e){var n=e.default;t.adPlayer=new n(t.bestMedia,t.ad.linear.parameters),t._playCb()})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})})):t.provider===o.a.Ad.Provider.INNOVID?n.e(12).then(n.bind(null,52)).then((function(e){var n=e.default;t.adPlayer=new n(t.bestMedia,t.ad.linear.parameters),t._playCb()})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})})):Promise.resolve().then(n.bind(null,14)).then((function(e){var n=e.default;t.adPlayer=new n(t.bestMedia,t.ad.linear.parameters),t._playCb()})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})})),e&&window.postLogMessage("Attempting to try Campaign ID: <strong><u>".concat(e,"</u></strong>"));else if(t.type===o.a.Ad.Type.GOOGLE||t.type===o.a.Ad.Type.GOOGLE_DCM_VPAID)"overlay"===t.timing?n.e(9).then(n.bind(null,53)).then((function(e){var n=e.default;t.adPlayer=new n(t),t._playCb()})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})})):window.client.isMobile?(t.adPlayer=window.MobileIMAPlayer,t._playCb()):n.e(8).then(n.bind(null,45)).then((function(e){var n=e.default;ce.debug("Requiring google ads player"),t.adPlayer=new n,t._playCb()})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})}));else if(t.type===o.a.Ad.Type.OVERLAY)t.provider===o.a.Ad.Provider.COULL&&t._retryAdRequest("COULL overlay is no longer supported");else if(t.type===o.a.Ad.Type.DISPLAY_BACKFILL)n.e(6).then(n.bind(null,54)).then((function(e){var n=e.default;t.adPlayer=new n,t._playCb()})).catch((function(e){ce.error("Caught error",{message:e.message,stack:e.stack})}));else if(t.type===o.a.Ad.Type.HOUSE_AD){var i=Object(F.f)(window.CurrentVideoConfig.advertising);void 0!==i?n.e(11).then(n.bind(null,55)).then((function(e){var n=e.default;t.adPlayer=new n(i),t._playCb()})):(ce.info("No house ad setup"),window.BoltAdManager._dispatchEvent(o.a.Ad.Event.FAILED))}}},{key:"getDuration",value:function(){return this.adPlayer.getDuration()}},{key:"getCurrentTime",value:function(){var e=this.adPlayer.getCurrentTime();return void 0===e&&(e=0),e}},{key:"getPercentPlayed",value:function(){var e=this;return null!==e.getCurrentTime()&&null!==e.getDuration()?e.getCurrentTime()/e.getDuration()*100:null}},{key:"getVolume",value:function(){return this.adPlayer.getVolume()}},{key:"pause",value:function(){this.adPlayer.pause()}},{key:"resume",value:function(){this.adPlayer.resume()}},{key:"setVolume",value:function(e){ce.debug("Set player volume",{func:"setVolume",value:e}),this.adPlayer.setVolume(e),this.currentVolume=e}},{key:"mute",value:function(){this.currentVolume=this.getVolume(),this.adPlayer.setVolume(0),this._dispatchEvent(o.a.Media.Event.MUTED)}},{key:"unmute",value:function(){this.adPlayer.setVolume(this.currentVolume),this._dispatchEvent(o.a.Media.Event.UNMUTED)}},{key:"remove",value:function(){this.adPlayer&&(ce.info("Ad player removed"),window.postLogMessage("Ad player removed"),this.adPlayer.remove()),this.resetStatus()}},{key:"abort",value:function(e){"none"===this.status||this.aborted||(this.aborted=!0,ce.warn("Ad aborted"),window.AdRequest.abort(),this.linearAdPool.drain(),this.overlayAdPool.drain(),this._dispatchEvent(o.a.Ad.Event.ABORTED),this.remove()),e&&e()}},{key:"isLinear",value:function(){return this._isLinear}},{key:"recordCustomAdImpression",value:function(){window.SSTracker.recordImpression()}},{key:"dispatchQueueEvent",value:function(e){this._dispatchEvent(o.a.Ad.Event.QUEUED),e&&setTimeout((function(){ce.debug("Invoking callback after ".concat(o.a.Ad.QUEUE_WAIT),{func:"dispatchQueueEvent"}),e()}),o.a.Ad.QUEUE_WAIT)}}])&&ne(t.prototype,i),a&&ne(t,a),c}(i.a)}}]);