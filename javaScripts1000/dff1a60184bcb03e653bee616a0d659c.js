//tealium universal tag - utag.390 ut4.0.202107121555, Copyright 2021 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={"view":1,"link":1};u.scriptrequested=false;u.clearEmptyKeys=function(object){for(var key in object){if(object[key]===""||object[key]===undefined){delete object[key];}}
return object;};u.map={"curalate_account_id":"sitename","order_id":"order_id","customer_atgID":"customer_id","product_name":"product_name","product_id":"product_id","event_name:cart_addition":"addToCart","event_name:similarstyles_product_view":"viewProduct","event_name:recommendation_product_view":"viewProduct","event_name:product_view":"viewProduct","event_name:purchase":"checkout","event_name:cart_removal":"removeFromCart","product_sku":"product_sku","product_quantity":"product_quantity","product_category":"product_category","product_unit_price":"product_unit_price","site_currency":"order_currency","order_subtotal":"order_subtotal","order_shipping":"order_shipping","order_tax":"order_tax","customer_city":"customer_city"};u.extend=[];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){utag.DB("send:390");utag.DB(b);var c,d,e,f,h,i,j,evt;u.data={"sitename":"","base_url":"//cdn.curalate.com/sites/##utagreplace_sitename##/site/latest/site.","product_id":[],"product_name":[],"product_sku":[],"product_category":[],"product_quantity":[],"product_unit_price":[],"display_price":[],"event_queue":[]};utag.DB("send:390:EXTENSIONS");utag.DB(b);for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}else{h=d.split(":");if(h.length===2&&b[h[0]]===h[1]){if(u.map[d]){u.data.event_queue=u.data.event_queue.concat(u.map[d].split(","));}}}}
utag.DB("send:390:MAPPINGS");utag.DB(u.data);u.data.order_id=u.data.order_id||b._corder||"";u.data.order_subtotal=u.data.order_subtotal||b._csubtotal||"";u.data.order_shipping=u.data.order_shipping||b._cship||"";u.data.order_tax=u.data.order_tax||b._ctax||"";u.data.order_currency=u.data.order_currency||b._ccurrency||"";u.data.customer_id=u.data.customer_id||b._ccustid||"";u.data.customer_city=u.data.customer_city||b._ccity||"";u.data.customer_country=u.data.customer_country||b._ccountry||"";if(u.data.product_id.length===0&&b._cprod!==undefined){u.data.product_id=b._cprod.slice(0);}
if(u.data.product_name.length===0&&b._cprodname!==undefined){u.data.product_name=b._cprodname.slice(0);}
if(u.data.product_sku.length===0&&b._csku!==undefined){u.data.product_sku=b._csku.slice(0);}
if(u.data.product_category.length===0&&b._ccat!==undefined){u.data.product_category=b._ccat.slice(0);}
if(u.data.product_quantity.length===0&&b._cquan!==undefined){u.data.product_quantity=b._cquan.slice(0);}
if(u.data.product_unit_price.length===0&&b._cprice!==undefined){u.data.product_unit_price=b._cprice.slice(0);}
if(u.data.event_queue.length===0&&b._cevent!==undefined){u.data.event_queue=(u.typeOf(b._cevent)==="array")?b._cevent.slice(0):[b._cevent];}
if(!u.data.sitename){utag.DB(u.id+": Tag not fired: Required attribute sitename not populated");return;}
u.data.base_url=u.data.base_url.replace("##utagreplace_sitename##",u.data.sitename);if(u.data.order_id&&u.data.event_queue.indexOf("checkout")===-1){u.data.event_queue.push("checkout");}
for(evt=0;evt<u.data.event_queue.length;evt++){if(u.data.event_queue[evt]==="checkout"){for(i=0;i<u.data.product_id.length;i++){crl8.pixel("addProduct",{"productId":u.data.product_id[i],"productName":u.data.product_name[i],"price":u.data.product_unit_price[i],"displayPrice":u.data.display_price[i],"quantity":u.data.product_quantity[i],"sku":u.data.product_sku[i],"category":u.data.product_category[i],"currency":u.data.order_currency[i]});}
crl8.pixel("addTransactionInfo",u.clearEmptyKeys({"transactionId":u.data.order_id,"userId":u.data.customer_id,"cartValue":u.data.order_subtotal,"taxValue":u.data.order_tax,"shippingValue":u.data.order_shipping,"shippingCity":u.data.customer_city,"shippingCountry":u.data.customer_country,"currency":u.data.order_currency}));crl8.pixel("send");}else if(/viewProduct|addToCart|removeFromCart/.test(u.data.event_queue[evt])){for(j=0;j<u.data.product_id.length;j++){crl8.pixel("send",u.data.event_queue[evt],u.clearEmptyKeys({"productId":u.data.product_id[j],"productName":u.data.product_name[j],"price":u.data.product_unit_price[j],"displayPrice":u.data.display_price[j],"quantity":u.data.product_quantity[j],"sku":u.data.product_sku[j],"category":u.data.product_category[j],"currency":u.data.order_currency}));}}}
utag.DB("send:390:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("390","dswinc.main"));}catch(error){utag.DB(error);}
