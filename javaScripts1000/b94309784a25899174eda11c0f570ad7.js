!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t,e,n){"use strict";(function(e){var n=setTimeout;function r(){}function i(t){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function o(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void s(e.promise,t)}a(e.promise,r)}else(1===t._state?a:s)(e.promise,t._value)}))):t._deferreds.push(e)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void l((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){s(t,e)}var r,o}function s(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&i._immediateFn((function(){t._handled||i._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)o(t,t._deferreds[e]);t._deferreds=null}function u(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function l(t,e){var n=!1;try{t((function(t){n||(n=!0,a(e,t))}),(function(t){n||(n=!0,s(e,t))}))}catch(t){if(n)return;n=!0,s(e,t)}}i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){var n=new this.constructor(r);return o(this,new u(t,e,n)),n},i.prototype.finally=function(t){var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){return e.reject(n)}))}))},i.all=function(t){return new i((function(e,n){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);var i=r.length;function o(t,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,(function(e){o(t,e)}),n)}r[t]=a,0==--i&&e(r)}catch(t){n(t)}}for(var a=0;a<r.length;a++)o(a,r[a])}))},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i((function(e){e(t)}))},i.reject=function(t){return new i((function(e,n){n(t)}))},i.race=function(t){return new i((function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)}))},i._immediateFn="function"==typeof e&&function(t){e(t)}||function(t){n(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},t.exports=i}).call(this,n(3).setImmediate)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){var n,r,i,o,a,s,c;Array.prototype.find||(Array.prototype.find=function(t){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),r=n.length>>>0,i=arguments[1],o=0;o<r;o++)if(e=n[o],t.call(i,e,o,n))return e}),Array.from||(Array.from=(n=Object.prototype.toString,r=function(t){return"function"==typeof t||"[object Function]"===n.call(t)},i=Math.pow(2,53)-1,o=function(t){var e=function(t){var e=Number(t);return isNaN(e)?0:0!==e&&isFinite(e)?(e>0?1:-1)*Math.floor(Math.abs(e)):e}(t);return Math.min(Math.max(e,0),i)},function(t){var e=this,n=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var i,a=arguments.length>1?arguments[1]:void 0;if(void 0!==a){if(!r(a))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(i=arguments[2])}for(var s,c=o(n.length),u=r(e)?Object(new e(c)):new Array(c),l=0;l<c;)s=n[l],u[l]=a?void 0===i?a(s,l):a.call(i,s,l):s,l+=1;return u.length=c,u})),a=Event.prototype,s=document,c=window,a.composedPath||(a.composedPath=function(){if(this.path)return this.path;var t=this.target;for(this.path=[];null!==t.parentNode;)this.path.push(t),t=t.parentNode;return this.path.push(s,c),this.path})},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(4),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(1))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,a,s,c=1,u={},l=!1,d=t.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(t);p=p&&p.setTimeout?p:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){m(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){m(t.data)},r=function(t){o.port2.postMessage(t)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,r=function(t){var e=d.createElement("script");e.onreadystatechange=function(){m(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(m,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&m(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(a+e,"*")}),p.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return u[c]=i,r(c),c++},p.clearImmediate=f}function f(t){delete u[t]}function m(t){if(l)setTimeout(m,0,t);else{var e=u[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{f(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(1),n(5))},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var c,u=[],l=!1,d=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&f())}function f(){if(!l){var t=s(p);l=!0;for(var e=u.length;e;){for(c=u,u=[];++d<e;)c&&c[d].run();d=-1,e=u.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function h(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new m(t,e)),1!==u.length||l||s(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},,function(t,e,n){"use strict";n.r(e);n(2);var r=n(0),i=n.n(r);function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=t.getBoundingClientRect(),r=(n.height?n.height:n.bottom-n.top)*e,i=(n.width?n.width:n.right-n.left)*e,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight,a=window.innerWidth?window.innerWidth:document.documentElement.clientWidth;return n.top>-r&&n.bottom<o+r&&n.left>-i&&n.right<a+i}function a(t,e,n,r,i){var o=n-r;return o<0&&(o=0),i||(i=0),e.visibility[t]=i+o,o}function s(t){t.forEach((function(t){t.articleIds.forEach((function(e,n){null===t.visibilityIntervals[n]&&(t.visibilityIntervals[n]=setInterval((function(){var r=new Date,i=document.querySelector(e);i&&o(i)?t.visibleTime[n]=function(t,e,n,r){return e.dateObjects[n+"Start"]||(e.dateObjects[n+"Start"]=new Date),a(t,e,r,e.dateObjects[n+"Start"],e.dateObjects[n+"Param"])}(n,t,"viewable".concat(n),r):(clearInterval(t.visibilityIntervals[n]),t.visibilityIntervals[n]=null,function(t,e,n,r){e.dateObjects[n+"Start"]&&(a(t,e,r,e.dateObjects[n+"Start"],e.dateObjects[n+"Param"]),e.dateObjects[n+"Start"]=null,e.dateObjects[n+"Param"]=e.visibility[t])}(n,t,"viewable".concat(n),r))}),1e3/6))}))}))}var c=function(t){var e=window.location.search.substring(1);t&&(e=-1!==t.indexOf("?")?t.substring(t.indexOf("?")+1):"");var n=e.split("&"),r={};if(n.length>0&&""!==n[0])for(var i=0;i<n.length;i++){var o=n[i].split("=");r[o[0]]=o[1]}return r},u=null;function l(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var d=2;(function(){if(null===u){var t=c().recassdebugmode;u="true"===t}return u})()&&(d=1);var p="display: inline-block; color: #fff; background: rgb(0, 148, 197);  padding: 1px 4px; border-radius: 3px;",f="display: inline-block; color: #fff; background: rgb(197, 0, 3); padding: 1px 4px; border-radius: 3px;";function m(t,e){switch(d){case 1:var n,r;if("error"===t)(n=console).error.apply(n,["%cRECASS",f].concat(l(e)));else(r=console).log.apply(r,["%cRECASS",p].concat(l(e)));break;case 2:var i;if("error"===t)(i=console).error.apply(i,["%cRECASS",f].concat(l(e)))}}var h={log:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];m("log",e)},error:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];m("error",e)}},v=function(t){var e="utm_source=www.seznam.cz&utm_medium=sekce-z-internetu";if(sessionStorage.getItem("recassFeedUtm")&&-1===t.indexOf("c.seznam.cz")){var n=c(t);return 0===Object.entries(n).length&&n.constructor===Object?"".concat(t,"?").concat(e):"".concat(t,"&").concat(e)}return t},g=function(t){var e=document.createElement("a");return e.href=t,e};function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var b=function(){function t(e,n,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.manager=n,this.posData=e,this.params=r,this.visibleTime=[],this.visibility=[],this.dateObjects={viewableParam:0,viewableStart:null},this.visibilityIntervals=[],this.articleElms=[],this.articleIds=[],this.widget_id="sznrecass-".concat(this.params.zone_id,"-").concat(Math.round(Math.random()*Date.now())),this.params.types=this._createTypes(),this.posData.recommendation.map((function(t){return t.url=v(t.url)})),this.markingProps=this.posData.logo,this._markingStylePosition=function(){return i.markingProps?"top"===i.markingProps.position?"margin: 0px; position: absolute; top: 0px; right: 0px;":"bottom"===i.markingProps.position?"padding-top: 5px; margin: 0px;":void 0:"display:block;"},this.markingCss="\n            div.recass-icon {".concat(this._markingStylePosition(),'}\n            div.recass-icon::after { clear: both; display: block; font-size: 0; content: ""; height: 0; width: 0; overflow: hidden; }\n            div.recass-icon img { display: block; opacity: 1 !important; }\n            div.recass-icon a { display: block; width: 20px; overflow: hidden; text-align: right; float: right; transition: none}\n            div.recass-icon .big { display: none; }\n            div.recass-icon a:hover { width: 120px; }\n            div.recass-icon a:hover .small { display: none; }\n            div.recass-icon a:hover .big { display: block; }\n        '),this.markingHtml='\n            <a href="'.concat(this._getPartnerSiteUrl(),'" title="Seznam doporuÄuje" target="_blank">\n                <img class="small" src="').concat(this.manager.conf.server,"/recass/img/recass-small-").concat(this.markingProps?this.markingProps.style:null,'.svg" width="20" height="20" alt="Seznam DoporuÄuje">\n                <img class="big" src="').concat(this.manager.conf.server,"/recass/img/recass-big-").concat(this.markingProps?this.markingProps.style:null,'.svg" width="120" height="20" alt="Seznam DoporuÄuje">\n            </a>\n        ')}var e,n,r;return e=t,(n=[{key:"_getPartnerSiteUrl",value:function(){return"https://partner.seznam.cz/seznam-doporucuje"}},{key:"_createTypes",value:function(){return this.posData.recommendation.map((function(t){return"ad"===t.type?t.type:"entity"}))}},{key:"_prepareParamsForLogging",value:function(t){var e={};return this.manager.conf.dotParams.forEach((function(n){for(var r in t)r===n&&(e[r]=t[r])})),e}},{key:"_trimArray",value:function(t,e){var n=Array.from(e);return t>-1&&n.splice(t,1),n}},{key:"removeValueFromArray",value:function(t,e){return t.filter((function(t){return t!==e}))}},{key:"_getPositionClickIds",value:function(t){var e=this.posData.recommendation.map((function(t){return t.id}));return this.manager._trimArticleIds(t,e)}},{key:"_click",value:function(t,e,n,r){var i=t.composedPath().filter((function(t){return"A"===t.nodeName&&null!==t.getAttribute("data-url")}));if(!(i.length<=0)){t.preventDefault();var o=parseInt(i[0].getAttribute("data-url"),10);e=e[o];var a=this._prepareParamsForLogging(e),s=this._getPositionClickIds(e.id);a.rem_ids=this.removeValueFromArray(s.rem_ids,void 0),a.pos=s.pos+1,a.vp=this.visibility[s.pos],a.rem_vp=this._trimArray(s.pos,this.visibility),a.href=window.location.href,a.zone_id=this.params.zone_id,a.web_id=this.posData.web_id,a.crossweb=this.posData.crossweb,a.ab=this.posData.ab_variant,a.url=r[s.pos],a.type=this.params.types[s.pos],a.rem_types=this._trimArray(s.pos,this.params.types),a.rem_algs=this._trimArray(s.pos,n),a.rem_urls=this._trimArray(s.pos,r),a.recass_box_count=this.params.positionIndex+1,a.box_position=this.params.boxPosition,h.log("Logging to Reporter",a),this.manager._dotLog("recass-click",a,(function(t){void 0===t&&(window.location.href=e.url)}))}}},{key:"_hitImpress",value:function(t,e,n,r,i){"recass-vis-impress"===t?this.manager._dotLog(t,{ids:this.removeValueFromArray(e,void 0),zone_id:this.params.zone_id,web_id:this.posData.web_id,adId:this.manager.conf.pvId,types:this.params.types,algs:n,ab:this.posData.ab_variant,urls:r,recass_box_count:this.params.positionIndex+1,box_position:this.params.boxPosition,crossweb:this.posData.crossweb}):this.manager._dotLog(t,{hide_widget:i,ids:this.removeValueFromArray(e,void 0),zone_id:this.params.zone_id,web_id:this.posData.web_id,adId:this.manager.conf.pvId,types:this.params.types,algs:n,ab:this.posData.ab_variant,urls:r,recass_box_count:this.params.positionIndex+1,box_position:this.params.boxPosition,crossweb:this.posData.crossweb})}},{key:"_hitVisibleImpress",value:function(t,e,n,r){var i=this;if(t)var a=setInterval((function(){o(t,0)&&(i._hitImpress("recass-vis-impress",e,n,r),clearInterval(a))}),1e3/3)}},{key:"_replaceTags",value:function(t,e){var n=this,r=t;return r=this._replaceReg(r,"{{widget_id}}",this.widget_id),e.recommendation.forEach((function(t,e){r=n._replaceReg(r,"{{entitybox".concat(e,"}}"),"".concat(n.widget_id,"-").concat(e)),r=n._replaceReg(r,"{{img".concat(e,"}}"),t.img),r=n._replaceReg(r,"{{title".concat(e,"}}"),t.title),r=n._replaceReg(r,"{{desc".concat(e,"}}"),t.desc)})),r}},{key:"_insertCss",value:function(t,e){var n=t;e&&(n=this._replaceTags(t,e));var r=document.head,i=document.createElement("style");i.setAttribute("type","text/css"),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n)),r.appendChild(i)}},{key:"_replaceReg",value:function(t,e,n){var r=new RegExp(e,"g");return t.replace(r,n)}},{key:"_insertMarking",value:function(t){if(this.markingProps&&"none"!==this.markingProps.position){this._insertCss(this.markingCss);var e=document.createElement("div");if(e.classList.add("recass-icon"),e.innerHTML=this.markingHtml,"top"===this.markingProps.position)t.insertBefore(e,t.firstChild);else{if("bottom"!==this.markingProps.position)return;t.appendChild(e)}}}},{key:"_prepareTemplate",value:function(t){var e=this,n=t.html,r=document.createElement("div"),i=[],o=[],a=[];return t.recommendation.forEach((function(t){i.push(t.id),o.push(t.alg),a.push(t.url),e.visibility.push(0),e.visibleTime.push(0),e.visibilityIntervals.push(null)})),n=this._replaceTags(n,t),r.innerHTML=n,r=r.firstChild,t.recommendation.forEach((function(t,n){var i=r.querySelectorAll("a:not(.adMarking)"),o=g(t.url).hostname;-1!==o.indexOf("c.seznam.cz")&&(o=g(c(t.url).adurl).hostname),(i=Array.prototype.slice.call(i)).forEach((function(t){t.attributes.href.value==="{{url".concat(n,"}}")&&t.setAttribute("data-url",n)})),r.innerHTML=e._replaceReg(r.innerHTML,"{{url".concat(n,"}}"),t.url),r.innerHTML=e._replaceReg(r.innerHTML,"{{url_hostname".concat(n,"}}"),o)})),r.addEventListener("click",(function(n){return e._click(n,t.recommendation,o,a)})),t.recommendation.forEach((function(t,n){var i=r.querySelector("#".concat(e.widget_id,"-").concat(n));e.articleIds.push("#".concat(e.widget_id,"-").concat(n)),e.articleElms.push(i)})),{element:r,script:t.script,impressIds:i,algs:o,urls:a,visibility:this.visibility}}},{key:"_insertSklikImpress",value:function(t,e){var n=document.createElement("img");n.src=e,n.style.position="absolute",n.style.top="-1000px",n.style.left="-1000px",n.style.height="1px",n.style.width="1px",t.appendChild(n)}},{key:"_insertAdMarking",value:function(t){var e=this;this.params.types.map((function(t,e){return"ad"===t?e:null})).filter((function(t){return null!==t})).forEach((function(n){var r=t.querySelector("#".concat(e.widget_id,"-").concat(n)),i=r.getAttribute("data-admarking"),o=r.querySelector("[data-admarking]"),a=document.createElement("div"),s=r,c="adMarking--top-left",u="Reklama";a.classList.add("sssp-posCont"),h.log("Inserting adMarking by to element #".concat(e.widget_id,"-").concat(n)),e.posData.recommendation[n].adType&&"Seznam Native"===e.posData.recommendation[n].adType&&(u="Seznam Native"),"Reklama"===u?o?(c="adMarking--".concat(o.getAttribute("data-admarking")),a.innerHTML='<div class="packa"><a class="adMarking '.concat(c,'" href="https://o.seznam.cz/personalizovana-reklama/">').concat(u,"</a></div>"),s=o):i?(c="adMarking--".concat(i),a.innerHTML='<div class="packa"><a class="adMarking '.concat(c,'" href="https://o.seznam.cz/personalizovana-reklama/">').concat(u,"</a></div>")):a.innerHTML='<div class="packa"><a class="adMarking '.concat(c,'" href="https://o.seznam.cz/personalizovana-reklama/">').concat(u,"</a></div>"):"Seznam Native"===u&&(a.classList.remove("sssp-posCont"),a.innerHTML='<a class="adMarking '.concat(c,'" href="https://native.seznamzpravy.cz">').concat(u,"</a>")),s.style.position="relative",s.insertBefore(a,s.firstChild)}))}},{key:"_insertAdMarkingToCss",value:function(t,e){var n=".";return-1!==e.indexOf("#{{widget_id}}")&&(n="#"),"".concat(n,"{{widget_id}} .adMarking {\n\t\t\tposition: absolute !important;\n\t\t\tfont-family: Arial, sans-serif !important;\n\t\t\tfont-size: 13px !important;\n\t\t\tfont-weight: bold !important;\n\t\t\tcolor: #fff !important;\n\t\t\ttext-decoration: none !important;\n\t\t\tbackground-color: rgba(117, 117, 117, 0.8) !important;\n\t\t\tborder-radius: 0px 0px 5px 0px !important;\n\t\t\tpadding: 4px !important;\n\t\t\tz-index: 10 !important;\n\t\t}\n\n\t\t").concat(n,"{{widget_id}} .adMarking--top-left {\n\t\t\ttop: 0 !important;\n\t\t\tleft: 0 !important;\n\t\t\tborder-radius: 0px 0px 5px 0px !important;\n\t\t}\n\n\t\t").concat(n,"{{widget_id}} .adMarking--top-right {\n\t\t\ttop: 0 !important;\n\t\t\tright: 0 !important;\n\t\t\tborder-radius: 0px 0px 0px 5px !important;\n\t\t}\n\n\t\t").concat(n,"{{widget_id}} .adMarking--bottom-right {\n\t\t\tbottom: 0 !important;\n\t\t\tright: 0 !important;\n\t\t\tborder-radius: 5px 0px 0px 0px !important;\n\t\t}\n\n\t\t").concat(n,"{{widget_id}} .adMarking--bottom-left: {\n\t\t\tbottom: 0 !important;\n\t\t\tleft: 0 !important;\n\t\t\tborder-radius: 0px 5px 0px 0px !important;\n\t\t}")+"\n\n"+e}},{key:"build",value:function(t,e){var n=this,r=document.querySelector("#".concat(t)),i=this._prepareTemplate(this.posData);if(this.posData.css=this._insertAdMarkingToCss(r,this.posData.css),this._insertCss(this.posData.css,this.posData),r.appendChild(i.element),this._insertAdMarking(r),this._insertMarking(r),0!==e.length&&e.forEach((function(t){n._insertSklikImpress(r,t)})),i.script){var o=this._replaceTags(i.script,this.posData);(0,eval)(o)}this._hitImpress("recass-impress",i.impressIds,i.algs,i.urls,!1),this._hitVisibleImpress(r.querySelector("#".concat(this.widget_id,"-0")),i.impressIds,i.algs,i.urls)}}])&&y(e.prototype,n),r&&y(e,r),t}();function _(t){var e=("; "+document.cookie).split("; "+t+"=");if(2===e.length)return e.pop().split(";").shift()}var w=function(t,e,n){var r=null;return function(){var i=this,o=arguments,a=function(){r=null,n||t.apply(i,o)},s=n&&!r;clearTimeout(r),r=setTimeout(a,e),s&&t.apply(i,o)}};var k=function(t){return new i.a((function(e,n){!function(t){return t.some((function(t){try{return 0!==t.advert.length}catch(t){return!1}}))}(t)?(h.log("No need to load SSP"),e()):new i.a((function(t,e){if(window.sssp)h.log("SSP already present"),t();else{var n=document.createElement("script");n.src="https://ssp.seznam.cz/static/js/ssp.js",h.log("Loading SSP"),n.readyState?n.onreadystatechange=function(){"loaded"!==n.readyState&&"complete"!==n.readyState||(n.onreadystatechange=null,t())}:n.onload=function(){t()},n.onerror=function(t){e(Error(t))},document.head.appendChild(n)}})).then((function(){h.log("SSP loaded successfully"),e()})).catch((function(t){n(t)}))}))},T=function(t){var e="";return"www."===(e=(e=(e=(e=t.indexOf("//")>-1?t.split("/")[2]:t.split("/")[0]).split(":")[0]).split("?")[0]).toLowerCase()).substring(0,4)&&(e=e.substring(4)),e},S=function(t,e){return t?"/".concat(t,"/").concat(T(e)):null};var I=function(t,e,n){return new i.a((function(r){h.log("Getting ads from SSP...");var o=function(t,e,n){return t.map((function(t){var r=S(t.section,n)||e;return h.log("Ad section for Seznam Native:",r),r?{zoneId:t.ad_zone_id,height:480,options:{section:r}}:{zoneId:t.ad_zone_id,height:480}}))}(t,e,n),a=o.map((function(t,e){return new i.a((function(n){var r=setTimeout((function(){clearTimeout(r),n({error:"Timed out in ".concat(7,"s. (zone ID: ").concat(t.zoneId,")")})}),7e3);o[e].callback=function(t){return function(e,n){"empty"===e.type&&sssp.served(e.tracking.served),t({advert:e,positionData:n})}}(n)}))}));sssp.getAds(o),i.a.all(a).then((function(t){var e=t.reduce((function(t,e){return e.error?t.nok.push(e):t.ok.push(e),t}),{ok:[],nok:[]});r(e.ok),e.nok.forEach((function(t){h.error("SSP getAds error:",t.error)}))})).catch((function(t){h.error("SSP getAds error:",t)}))}))};function z(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function x(t,e){for(var n in t.assets)if(t.assets[n].id===e)return t.assets[n];return null}function A(t,e,n){h.log("Parsing ".concat(t," ad from zoneId"),n,e);var r={recommData:{id:n.toString(),alg:["ad"],type:"ad",adType:"Reklama",title:"",desc:"",img:"",url:e.ads[0].clickUrl},sspZoneId:n,confirmImpUrl:[e.confirmImpUrl]};if("COMBINED"===t||"ADVERT"===t){var i;if(r.recommData.title=e.ads[0].longHeadline,r.recommData.desc=e.ads[0].description,r.recommData.img="".concat(e.ads[0].adImageUrl,"?fl=res,400,,1"),e.ads[0].eventTrackers)(i=r.confirmImpUrl).push.apply(i,z(e.ads[0].eventTrackers.impress));return"ADVERT"===t&&(r.recommData.adType="Seznam Native"),r}if("DRTG"===t){var o;if(r.recommData.title=e.ads[0].title,r.recommData.desc="".concat(e.ads[0].price," - ").concat(e.ads[1].shopName),r.recommData.img="".concat(e.ads[0].imageUrl,"?fl=res,400,225,1,fff"),e.ads[1].eventTrackers)(o=r.confirmImpUrl).push.apply(o,z(e.ads[1].eventTrackers.impress));return r}}var D=function(t){var e=[];return t.forEach((function(t){if("json"===t.advert.type||"code"===t.advert.type&&"ADVERT"===t.advert.dsp||"native"===t.advert.type&&"APPNEXUS"===t.advert.dsp){var n=null,r={};if(n="json"===t.advert.type?JSON.parse(t.advert.data.trim()):JSON.parse(t.advert.data.replace(/<!--.*?-->/g,"")),"native"!==t.advert.type){var i=n.ads[0].adType;"COMBINED"!==i&&"ADVERT"!==i||1!==n.ads.length?"DRTG"===i&&2===n.ads.length&&(r=A("DRTG",n,t.positionData.zoneId),sssp.served(t.advert.tracking.served),h.log("Parsed DRTG to:",r)):(r=A(i,n,t.positionData.zoneId),sssp.served(t.advert.tracking.served),h.log("Parsed ".concat(i," to:"),r))}else r=function(t,e){var n;h.log("Parsing Xandr native ad from zoneId",e,t);var r={recommData:{id:e.toString(),alg:["ad"],type:"ad",adType:"Reklama",title:x(t.native,11).title.text,desc:x(t.native,12).data.value,img:x(t.native,1).img.url,url:t.native.link.url},sspZoneId:e,confirmImpUrl:[]};return(n=r.confirmImpUrl).push.apply(n,z(t.native.imptrackers)),r}(n,t.positionData.zoneId),sssp.served(t.advert.tracking.served),h.log("Parsed Xandr native to:",r);e.push(r)}})),e};function P(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var O=function(t,e){var n=e.recommendation.length,r=[];return e.advert.sort((function(t,e){return t.position-e.position})),e.advert.forEach((function(n){var i=n.position,o=t.find((function(t){return t.sspZoneId===n.ad_zone_id}));o&&(r.push.apply(r,P(o.confirmImpUrl)),e.recommendation.splice(i,0,o.recommData))})),e.recommendation.length=n,r.filter((function(t){return void 0!==t}))},E=function(){var t=c();"www.seznam.cz"===t.utm_source&&"sekce-z-internetu"===t.utm_medium?sessionStorage.setItem("recassFeedUtm",window.location.host):sessionStorage.getItem("recassFeedUtm")&&""===document.referrer&&sessionStorage.clear("recassFeedUtm")};function j(t){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function R(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var L=null,N=function(){function t(){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),null!==L)return L;var e,n,r;this.conf={sid:_("sid")?(e=_("sid"),n={},r=e,(r=(r=r.split("|")).map((function(t){return t.split("=")}))).forEach((function(t){return n[t[0]]=t[1]})),n).id:null,pvId:null,params:["zone_id","ab_variant"],server:"https://d.seznam.cz",path:"/recass/v2/recommend",dotParams:["alg","id","ab_variant"]},this.positions=[],this.myDOT=null,"string"!=typeof this.conf.sid&&null!==this.conf.sid&&(this.conf.sid="".concat(this.conf.sid)),E(),L=this}var e,n,r;return e=t,(n=[{key:"initDot",value:function(t){if(window.DOT){var e=window.DOT.getNewInstance();return e.cfg({host:"h.seznam.cz",service:t||"recassp",mousedown:!1,impress:!0,load:!1,latencyChance:0}),e}h.error("Cannot init DOT: DOT not found")}},{key:"_dotLog",value:function(t,e,n){if(!this.myDOT)return"recass-click"===t&&"function"==typeof n?void n():void h.error("DOT not found");e.action=t,this.myDOT.hit("event",{d:e},"function"==typeof n?n:null)}},{key:"_getXhr",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",o=new i.a((function(i,o){var a=new XMLHttpRequest,s="";a.open(r,t,!0),a.setRequestHeader("Content-Type","application/json"),a.withCredentials=!0,a.onload=function(){if(200===a.status){try{s=JSON.parse(a.response)}catch(t){s="",e._dotLog("recass-error",{error:"response_parsing_error"})}i(s)}else e._dotLog("recass-error",{error:"http_status_".concat(a.status)}),o("Error ".concat(a.status,": ").concat(a.statusText))},a.onerror=function(t){e._dotLog("recass-error",{error:"xhr_error"}),o(Error(t))},a.send(JSON.stringify(n))}));return o}},{key:"_trimArticleIds",value:function(t,e){var n=Array.from(e),r=n.indexOf(t);return r>-1&&n.splice(r,1),{pos:r,rem_ids:n}}},{key:"_fnv1aHashString",value:function(t){for(var e=2166136261,n=0,r=t.length;n<r;n++)e=16777619*(e^=255&t.charCodeAt(n))|0;return Math.abs(e).toString()}},{key:"_createPageView",value:function(){var t=new Date;t=t.toUTCString();var e=document.location.href,n=Math.random().toString();return this._fnv1aHashString(t+e+n)}},{key:"setPageViewId",value:function(){h.log("Setting pageViewId for page"),this.conf.pvId=this._createPageView(),h.log("pageViewId: ".concat(this.conf.pvId))}},{key:"getPageViewId",value:function(){return this.conf.pvId}},{key:"_initPageView",value:function(){window.sssp&&""!==sssp.getPageViewId()?(h.log("Getting pageViewId from SSP"),this.conf.pvId=sssp.getPageViewId()):(h.log("Generating pageViewId"),this.setPageViewId()),this.myDOT&&this.myDOT.hit("adload",{d:{adId:this.conf.pvId}})}},{key:"_arraySearch",value:function(t,e,n){return n.find((function(n){return n[t]===e}))}},{key:"_prepareRequest",value:function(t){if(t){var e=c().forced_ab_variant,n={};return n.zones=t.map((function(t){return e?{zone_id:t.zone_id,forced_ab_variant:e}:{zone_id:t.zone_id}})),n.url=document.location.href,n}h.error("No zoneData found")}},{key:"_logZoneErrors",value:function(t,e){var n=this,r=e.map((function(t){return t.zone_id}));t.filter((function(t){return-1===r.indexOf(t.zone_id)})).forEach((function(){n._dotLog("recass-error",{error:"empty_zone"})}))}},{key:"getRecommendationsByTags",value:function(){h.log("Fetching recommend data-attribute tags");var t=document.querySelectorAll("[data-szn-recass-box]");if(t&&0!==t.length){var e=[];t=Array.prototype.slice.call(t);for(var n=0;n<t.length;n++){var r=t[n],i=r.getAttribute("data-szn-recass-box");try{i=JSON.parse(i.replace(/'/g,'"'))}catch(t){return void h.error("Failed to parse JSON on recommend tag")}if(!i.zone_id)return void h.error("No valid zone_id parameter provided");r.id||(r.id="sznrecass-widget-".concat(i.zone_id,"-").concat(Math.round(Math.random()*Date.now())),r.style.position="relative"),i.id=r.id,e.push(i)}this.getRecommendations(e)}else h.error("No elements with recommend data-attribute tag found")}},{key:"_insertDataDotData",value:function(t){if(document.body.getAttribute("data-dot-data"))try{var e=JSON.parse(document.body.getAttribute("data-dot-data")),n=JSON.parse(t);document.body.setAttribute("data-dot-data",JSON.stringify(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(n,!0).forEach((function(e){R(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{},n)))}catch(t){h.error("Cannot parse data-dot-data parameter!")}else document.body.setAttribute("data-dot-data",t)}},{key:"_initRecommendations",value:function(t){this._insertDataDotData('{"recass_box_count": '.concat(t.length,"}")),this.myDOT=this.initDot(),this._initPageView(),this._getRecommendations(t)}},{key:"getRecommendations",value:function(t){var e=this;if(h.log("Recommendation boxes count:",t.length),this.myDOT)this._getRecommendations(t);else if(window.DOT)this._initRecommendations(t);else{var n=document.createElement("script");n.src="https://h.seznam.cz/js/dot-small.js",document.head.insertBefore(n,document.head.firstChild),n.onload=function(){window.DOT&&!1===DOT.isConfigured()&&DOT.cfg({service:"sklikp",load:!1,mousedown:!1,impress:!1,latencyChance:0}),e._initRecommendations(t)}}}},{key:"prepareAndBuildPosition",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"none";h.log("Building position. SSP Ads:",o);var a=[];if("none"!==o){var c=D(o);a=O(c,t),h.log("Final parsed ADs:",c,a)}var u=this._arraySearch("zone_id",t.zone_id,e);h.log("zoneData",u);var l=this._arraySearch("zone_id",u.zone_id,n),d=new b(u,this,{zone_id:l.zone_id,positionIndex:r,boxPosition:i});if(this.positions.push(d),d.posData.hide_widget){var p={hide_widget:!0,ab:d.posData.ab_variant,zone_id:d.params.zone_id,web_id:d.posData.web_id,recass_box_count:d.params.positionIndex+1,box_position:d.params.boxPosition,crossweb:d.posData.crossweb};this._dotLog("recass-impress",p)}else d.build(l.id,a),w(s(this.positions),100,!0),document.addEventListener("scroll",w(s,100,!0).bind(this,this.positions)),document.addEventListener("resize",w(s,100,!0).bind(this,this.positions)),document.addEventListener("click",w(s,100,!0).bind(this,this.positions)),document.addEventListener("touchend",w(s,100,!0).bind(this,this.positions))}},{key:"_getRecommendations",value:function(t){var e=this;if(h.log("Starting get recommended articles with parameters",t),"object"===j(t))if(!Array.isArray(t)||t.length){if(!Array.isArray(t)){var n=[];n.push(t),t=n,h.log("Data object transformed to array",t)}var r=t.map((function(t,e){return{zone_id:t.zone_id,boxPosition:e}})),i=this._prepareRequest(t);this._getXhr(this.conf.server+this.conf.path,i,"POST").then((function(n){Array.isArray(n)||(n=[n]),t.length!==n.length&&e._logZoneErrors(t,n),k(n).then((function(){n.forEach((function(i,o){var a=r.find((function(t){return t.zone_id===i.zone_id})).boxPosition,s=S(i.web_category,i.web_url);i.advert&&0!==i.advert.length?(h.log("Ad request is present"),h.log("Ad section for Seznam Native:",s),I(i.advert,s,i.web_url).then((function(r){h.log("Got ads from SSP:",r),e.prepareAndBuildPosition(i,n,t,o,a,r)})).catch((function(r){h.error("SSP sspGetAds error:",r),e.prepareAndBuildPosition(i,n,t,o,a)}))):e.prepareAndBuildPosition(i,n,t,o,a)}))})).catch((function(t){h.error("SSP loading error:",t)}))})).catch((function(t){h.error("getReccomendations:",t)}))}else h.error("No valid parameters: Array length is 0",t);else h.error("No valid parameters: types",t)}}])&&C(e.prototype,n),r&&C(e,r),t}();window.sznRecass||(window.sznRecass=new N)}]);