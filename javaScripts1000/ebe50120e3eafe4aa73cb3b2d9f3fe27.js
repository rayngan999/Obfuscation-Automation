/*! permutive-javascript-sdk v14.20.4 (web) (built 2021-08-02T06:09:15.050Z) */(()=>{"use strict";var __webpack_modules__={276:(e,t,r)=>{r.d(t,{tS:()=>B,oA:()=>Y,md:()=>C,Qp:()=>j,t9:()=>z,DZ:()=>W,Ew:()=>A,xH:()=>F,pR:()=>re,jV:()=>$,KB:()=>k,uK:()=>H,Ce:()=>y,u4:()=>Q,GY:()=>M,DY:()=>N,zT:()=>P,ke:()=>E,fw:()=>X,G0:()=>R,jj:()=>G,yL:()=>D});var n=r(735),s=r(341),i=r(885),a=r(567),o=(r(268),r(595)),c=r(209),u=r(68),l=r(870),d=(u.Ce,u.R3,function(e){return 0===e.length});u.Od,u.dC;u.ZQ;function p(e){return function(t,r){if(void 0===r){var n=p(e);return function(e){return n(t,e)}}for(var s,i=0;i<r.length;i++)if(s=r[i],e.equals(s,t))return!0;return!1}}var f=function(e,t){return(0,n.zG)(e,m(t))},m=(u.of,function(e){return function(t){return t.map((function(t){return e(t)}))}}),g=function(e){return function(t){for(var r=[],n=0;n<t.length;n++){var s=e(n,t[n]);a.pC(s)&&r.push(s.value)}return r}},_=function(e){return g((function(t,r){return e(r)}))},h=(n.yR,function(e,t){return v(e,(function(e,r,n){return t(r,n)}))}),v=function(e,t){return function(r){for(var n=r.length,s=e,i=0;i<n;i++)s=t(i,s,r[i]);return s}},b="ReadonlyArray",w={URI:b,map:f},y=((0,s.OV)(w),u.oo,u.cS,u.QI,u.Ss,i.Ce),q=i.R3,k=function(e,t){return e<=0?[]:i.KB(e,t)},S=d,x=i.Od,O=i.dC,E=function(e){return function(t){return O(e,t)?T(t):t.slice(0,e)}};var I=function(e,t){for(var r=e.length,n=0;n<r&&t(e[n]);n++);return n};function P(e){return function(t){var r=L(I(t,e))(t);return{init:r[0],rest:r[1]}}}var C=function(e){return function(t){return e<=0||S(t)?T(t):e>=t.length?[]:t.slice(e,t.length)}},j=function(e){return function(t){return t.slice(I(t,e))}};function A(e){return function(e){return function(t){for(var r=0;r<t.length;r++)if(e(t[r]))return a.G(t[r]);return a.YP}}(e)}var T=function(e){return e.slice()},M=function(e){return S(e)?[]:e.slice().reverse()},N=function(e){return function(t){return t.length<=1?T(t):t.slice().sort(e.compare)}},D=function(e,t,r){for(var n=[],s=Math.min(e.length,t.length),i=0;i<s;i++)n[i]=r(e[i],t[i]);return n};var z=p,G=function(e){var t=i.jj(e);return function(e){return x(e)?t(e):T(e)}},L=function(e){return function(t){return e>=1&&x(t)?i.lx(e)(t):S(t)?[T(t),[]]:[[],T(t)]}};function R(e){var t=i.G0(e);return function(r,n){if(void 0===n){var s=R(e);return function(e){return s(e,r)}}return x(r)&&x(n)?t(r,n):x(r)?T(r):T(n)}}function $(e){var t=z(e);return function(r,n){if(void 0===n){var s=$(e);return function(e){return s(e,r)}}return r.filter((function(e){return t(e,n)}))}}var U=function(e,t){return(0,n.zG)(e,K(t))},K=(i.of,function(e){return function(t){return t.map((function(t){return e(t)}))}}),B=function(e){return function(t){return(0,n.zG)(t,function(e){return function(t){for(var r=[],n=0;n<t.length;n++)r.push.apply(r,e(n,t[n]));return r}}((function(t,r){return e(r)})))}},F=B(n.yR),J=function(e){return function(t){for(var r=[],n=0;n<t.length;n++){var s=e(n,t[n]);a.pC(s)&&r.push(s.value)}return r}},W=function(e){return J((function(t,r){return e(r)}))},Y=W(n.yR),H=function(e){return V((function(t,r){return e(r)}))},V=function(e){return function(t){for(var r=[],n=[],s=0;s<t.length;s++){var i=t[s];e(s,i)?n.push(i):r.push(i)}return(0,l.s4)(r,n)}},Q=h,Z=v,X=function(e){var t=ee(e);return function(e){return t((function(t,r){return e(r)}))}},ee=function(e){return function(t){return Z(e.of([]),(function(r,s,i){return e.ap(e.map(s,(function(e){return function(t){return(0,n.zG)(e,q(t))}})),t(r,i))}))}},te="Array",re=function(e){return(0,c.Zt)((function(t,r){for(var n=t.length,s=r.length,i=Math.min(n,s),a=0;a<i;a++){var c=e.compare(t[a],r[a]);if(0!==c)return c}return o.Df.compare(n,s)}))},ne={URI:te,map:U};(0,s.OV)(ne),i.oo,i.QI,i.Ss},70:(e,t,r)=>{r.d(t,{g1:()=>C,G5:()=>P,dO:()=>I,Pd:()=>y,tS:()=>O,g_:()=>p,ij:()=>m,Yo:()=>u,fS:()=>f,nM:()=>i,tO:()=>a,t$:()=>o,UI:()=>w,Vn:()=>q,EQ:()=>d,F2:()=>c,LF:()=>h,i$:()=>_,Y3:()=>g});var n=r(735),s=r(341),i=r(384).nM,a=function(e){return"Right"===e._tag},o=function(e){return{_tag:"Left",left:e}},c=function(e){return{_tag:"Right",right:e}},u=function(e){return function(t){return"None"===t._tag?o(e()):c(t.value)}},l=function(e,t){return function(r){return i(r)?e(r.left):t(r.right)}},d=l,p=d,f=function(e){return function(t){return i(t)?e(t.left):t.right}},m=function(e){return function(t){return null==t?o(e):c(t)}},g=function(e,t){try{return c(e())}catch(e){return o(t(e))}},_=l(n.yR,n.yR);function h(e){return i(e)?c(e.left):o(e.right)}var v=function(e,t){return(0,n.zG)(e,w(t))},b=function(e,t){return(0,n.zG)(e,k(t))},w=function(e){return function(t){return i(t)?t:c(e(t.right))}},y=function(e,t){return function(r){return i(r)?o(e(r.left)):c(t(r.right))}},q=function(e){return function(t){return i(t)?o(e(t.left)):t}},k=function(e){return function(t){return i(t)?t:i(e)?e:c(t.right(e.right))}},S=c,x=function(e){return function(t){return i(t)?t:e(t.right)}},O=x,E="Either";var I={URI:E,map:v},P=((0,s.OV)(I),{URI:E,map:v,ap:b}),C={URI:E,map:v,ap:b,of:S};n.yR},268:(e,t,r)=>{r.d(t,{f7:()=>n,n_:()=>s,Uz:()=>i,w4:()=>a,vD:()=>o,yv:()=>c,lr:()=>u});r(735);function n(e){return{equals:function(t,r){return t===r||e(t,r)}}}var s=function(e){return n((function(t,r){for(var n in e)if(!e[n].equals(t[n],r[n]))return!1;return!0}))},i=function(e){return function(t){return n((function(r,n){return t.equals(e(r),e(n))}))}},a={equals:function(e,t){return e===t}},o=(a.equals,a),c=a,u=a},341:(e,t,r)=>{function n(e,t){return function(r){return function(n){return e.map(n,(function(e){return t.map(e,r)}))}}}function s(e){return function(t){return function(r){return e.map(r,(function(e){return e(t)}))}}}r.d(t,{UI:()=>n,OV:()=>s})},885:(e,t,r)=>{r.d(t,{Od:()=>u,dC:()=>l,Ce:()=>d,R3:()=>p,oo:()=>f,jj:()=>m,G0:()=>g,KB:()=>_,nI:()=>v,of:()=>y,lx:()=>q,Eh:()=>E,QI:()=>j,Ss:()=>A});var n=r(735),s=r(341),i=r(384),a=r(567),o=r(68),c=function(e,t){for(var r=0,n=t.length,s=e.length;r<n;r++,s++)e[s]=t[r];return e},u=function(e){return e.length>0},l=function(e,t){return e<0||e>=t.length},d=function(e){return function(t){return c([e],t)}},p=function(e){return function(t){return b(t,[e])}},f=function(e,t,r){if(u(r)){var n=h(r);return n.splice(e,0,t),n}return[t]},m=function(e){return function(t){if(1===t.length)return w(t);for(var r=[P(t)],n=function(t){r.every((function(r){return!e.equals(r,t)}))&&r.push(t)},s=0,i=C(t);s<i.length;s++){n(i[s])}return r}},g=function(e){var t=m(e);return function(e,r){return t(b(e,r))}},_=function(e,t){for(var r=Math.max(0,Math.floor(e)),n=[t(0)],s=1;s<r;s++)n.push(t(s));return n},h=i.r1,v=function(e){return u(e)?a.G(e):a.YP};function b(e,t){return e.concat(t)}var w=h,y=function(e){return[e]};o.xP,o.Lx;var q=function(e){return function(t){var r=Math.max(1,e);return r>=t.length?[w(t),[]]:[(0,n.zG)(t.slice(1,r),d(P(t))),t.slice(r)]}},k=function(e,t){return(0,n.zG)(e,S(t))},S=function(e){return x((function(t,r){return e(r)}))},x=function(e){return function(t){for(var r=[e(0,P(t))],n=1;n<t.length;n++)r.push(e(n,t[n]));return r}},O=(o.u4,o.OE,o.nq,o.iw,o.YM,"NonEmptyArray"),E=(o.ZN,o.Eh),I={URI:O,map:k},P=((0,s.OV)(I),o.YM),C=function(e){return e.slice(1)};o.Z$,o.VV,o.Fp;function j(e,t){return void 0===t?d(e):(0,n.zG)(t,d(e))}var A=function(e,t){return(0,n.zG)(e,p(t))};o.ur},567:(e,t,r)=>{r.d(t,{pC:()=>i,Wi:()=>a,YP:()=>o,G:()=>c,DT:()=>u,Uo:()=>d,g_:()=>m,fS:()=>g,ij:()=>_,Y3:()=>h,UI:()=>v,tS:()=>b,Eh:()=>w,pR:()=>y});var n=r(735),s=r(384),i=(r(870),s.pC),a=function(e){return"None"===e._tag},o={_tag:"None"},c=function(e){return{_tag:"Some",value:e}};function u(e){return function(t){return e(t)?c(t):o}}function l(e){return"Left"===e._tag?o:c(e.right)}var d=l,p=function(e,t){return function(r){return a(r)?e():t(r.value)}},f=p,m=f,g=function(e){return function(t){return a(t)?e():t.value}},_=function(e){return null==e?o:c(e)},h=function(e){try{return c(e())}catch(e){return o}},v=function(e){return function(t){return a(t)?o:c(e(t.value))}},b=function(e){return function(t){return a(t)?o:e(t.value)}};n.yR;function w(e){return{equals:function(t,r){return t===r||(a(t)?a(r):!a(r)&&e.equals(t.value,r.value))}}}function y(e){return{equals:w(e).equals,compare:function(t,r){return t===r?0:i(t)?i(r)?e.compare(t.value,r.value):1:-1}}}},209:(e,t,r)=>{r.d(t,{Zt:()=>i,Uz:()=>a,lt:()=>o,gt:()=>c,gf:()=>u,VV:()=>l,Fp:()=>d,C2:()=>f,r9:()=>m,Mh:()=>g});var n=r(268),s=(r(735),function(e){return function(t,r){return t===r||0===e(t,r)}}),i=function(e){return{equals:s(e),compare:function(t,r){return t===r?0:e(t,r)}}},a=function(e){return function(t){return i((function(r,n){return t.compare(e(r),e(n))}))}},o=function(e){return function(t,r){return-1===e.compare(t,r)}},c=function(e){return function(t,r){return 1===e.compare(t,r)}},u=function(e){return function(t,r){return-1!==e.compare(t,r)}},l=function(e){return function(t,r){return t===r||e.compare(t,r)<1?t:r}},d=function(e){return function(t,r){return t===r||e.compare(t,r)>-1?t:r}};var p={equals:n.w4.equals,compare:function(e,t){return e<t?-1:e>t?1:0}},f=p,m=p,g=p},68:(e,t,r)=>{r.d(t,{cS:()=>l,Od:()=>d,dC:()=>p,Ce:()=>f,R3:()=>m,oo:()=>g,of:()=>v,u4:()=>y,Lx:()=>q,nq:()=>k,OE:()=>S,xP:()=>x,iw:()=>O,ZN:()=>P,Eh:()=>C,YM:()=>A,Z$:()=>T,VV:()=>M,Fp:()=>N,ur:()=>D,QI:()=>z,Ss:()=>G,ZQ:()=>L});var n=r(268),s=r(735),i=r(341),a=r(384),o=r(567),c=r(309),u=function(e,t){for(var r=0,n=t.length,s=e.length;r<n;r++,s++)e[s]=t[r];return e},l=[],d=function(e){return e.length>0},p=function(e,t){return e<0||e>=t.length},f=function(e){return function(t){return u([e],t)}},m=function(e){return function(t){return _(t,[e])}},g=function(e,t,r){if(d(r)){var n=a.r1(r);return n.splice(e,0,t),n}return[t]};function _(e,t){return e.concat(t)}var h=function(e,t){return(0,s.zG)(e,b(t))},v=function(e){return[e]},b=function(e){return w((function(t,r){return e(r)}))},w=function(e){return function(t){for(var r=[e(0,A(t))],n=1;n<t.length;n++)r.push(e(n,t[n]));return r}},y=function(e,t){return S(e,(function(e,r,n){return t(r,n)}))},q=function(e){return function(t){return function(r){return r.slice(1).reduce((function(r,n){return e.concat(r,t(n))}),t(r[0]))}}},k=function(e,t){return O(e,(function(e,r,n){return t(r,n)}))},S=function(e,t){return function(r){return r.reduce((function(e,r,n){return t(n,e,r)}),e)}},x=function(e){return function(t){return function(r){return r.slice(1).reduce((function(r,n,s){return e.concat(r,t(s+1,n))}),t(0,r[0]))}}},O=function(e,t){return function(r){return r.reduceRight((function(e,r,n){return t(n,r,e)}),e)}},E=function(e){return e[0]},I="ReadonlyNonEmptyArray",P=function(e){return{show:function(t){return"["+t.map(e.show).join(", ")+"]"}}},C=function(e){return(0,n.f7)((function(t,r){return t.length===r.length&&t.every((function(t,n){return e.equals(t,r[n])}))}))},j={URI:I,map:h},A=((0,i.OV)(j),E),T=function(e){return e[e.length-1]},M=function(e){var t=c.VV(e);return function(e){return e.reduce(t.concat)}},N=function(e){var t=c.Fp(e);return function(e){return e.reduce(t.concat)}},D=function(e){return function(t){return t.reduce(e.concat)}};function z(e,t){return void 0===t?f(e):(0,s.zG)(t,f(e))}var G=function(e,t){return _(e,[t])},L=function(e,t){return function(r){return e<0||e>r.length?o.YP:o.G(g(e,t,r))}}},309:(e,t,r)=>{r.d(t,{VV:()=>i,Fp:()=>a,xx:()=>o,lG:()=>c,ny:()=>u,l7:()=>l,xk:()=>d,D8:()=>p});var n,s=r(209),i=function(e){return{concat:s.VV(e)}},a=function(e){return{concat:s.Fp(e)}},o=(n=void 0,{concat:function(){return n}});var c={concat:function(e,t){return e&&t}},u={concat:function(e,t){return e||t}},l={concat:function(e,t){return e+t}},d={concat:function(e,t){return e+t}},p={concat:function(e,t){return e*t}}},870:(e,t,r)=>{r.d(t,{s4:()=>i});var n=r(735),s=r(341),i=function(e,t){return{left:e,right:t}},a=function(e){return function(t){return i(u(t),e(l(t)))}},o="Separated",c={URI:o,map:function(e,t){return(0,n.zG)(e,a(t))}},u=((0,s.OV)(c),function(e){return e.left}),l=function(e){return e.right}},93:(e,t,r)=>{r.d(t,{R:()=>n,_3:()=>s,yt:()=>i});var n={show:function(e){return JSON.stringify(e)}},s={show:function(e){return JSON.stringify(e)}},i={show:function(e){return JSON.stringify(e)}}},735:(e,t,r)=>{r.d(t,{yR:()=>n,ff:()=>s,Q1:()=>a,ls:()=>o,bc:()=>c,zG:()=>u});function n(e){return e}function s(e){return function(t){return!e(t)}}function i(e){return function(){return e}}var a=i(void 0);function o(e,t,r,n,s,i,a,o,c){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return r(t(e.apply(this,arguments)))};case 4:return function(){return n(r(t(e.apply(this,arguments))))};case 5:return function(){return s(n(r(t(e.apply(this,arguments)))))};case 6:return function(){return i(s(n(r(t(e.apply(this,arguments))))))};case 7:return function(){return a(i(s(n(r(t(e.apply(this,arguments)))))))};case 8:return function(){return o(a(i(s(n(r(t(e.apply(this,arguments))))))))};case 9:return function(){return c(o(a(i(s(n(r(t(e.apply(this,arguments)))))))))}}}function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}function u(e,t,r,n,s,i,a,o,c,u,l,d,p,f,m,g,_,h,v,b){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return n(r(t(e)));case 5:return s(n(r(t(e))));case 6:return i(s(n(r(t(e)))));case 7:return a(i(s(n(r(t(e))))));case 8:return o(a(i(s(n(r(t(e)))))));case 9:return c(o(a(i(s(n(r(t(e))))))));case 10:return u(c(o(a(i(s(n(r(t(e)))))))));case 11:return l(u(c(o(a(i(s(n(r(t(e))))))))));case 12:return d(l(u(c(o(a(i(s(n(r(t(e)))))))))));case 13:return p(d(l(u(c(o(a(i(s(n(r(t(e))))))))))));case 14:return f(p(d(l(u(c(o(a(i(s(n(r(t(e)))))))))))));case 15:return m(f(p(d(l(u(c(o(a(i(s(n(r(t(e))))))))))))));case 16:return g(m(f(p(d(l(u(c(o(a(i(s(n(r(t(e)))))))))))))));case 17:return _(g(m(f(p(d(l(u(c(o(a(i(s(n(r(t(e))))))))))))))));case 18:return h(_(g(m(f(p(d(l(u(c(o(a(i(s(n(r(t(e)))))))))))))))));case 19:return v(h(_(g(m(f(p(d(l(u(c(o(a(i(s(n(r(t(e))))))))))))))))));case 20:return b(v(h(_(g(m(f(p(d(l(u(c(o(a(i(s(n(r(t(e)))))))))))))))))))}}},384:(e,t,r)=>{r.d(t,{pC:()=>s,nM:()=>i,e$:()=>a,r1:()=>o});var n=function(e,t){for(var r=0,n=t.length,s=e.length;r<n;r++,s++)e[s]=t[r];return e},s=function(e){return"Some"===e._tag},i=function(e){return"Left"===e._tag},a=Object.prototype.hasOwnProperty,o=function(e){return n([e[0]],e.slice(1))}},595:(e,t,r)=>{r.d(t,{Eq:()=>a,Df:()=>o});var n=r(209),s=(n.Mh.equals,n.Mh.compare,r(268));var i=r(93),a=s.lr,o=n.Mh;i.yt},71:(e,t,r)=>{r.d(t,{Eq:()=>o,Df:()=>c});var n=r(268),s=r(309),i=(s.xx.concat,s.lG.concat,s.ny.concat,s.l7.concat,s.xk.concat,s.D8.concat,r(209)),a=r(93),o=n.yv,c=(s.l7,i.r9);a._3},477:e=>{var t=window.URL||window.webkitURL;e.exports=function(e,r,n,s){try{try{var i;try{i=new window.Blob([e])}catch(t){(i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(e),i=i.getBlob()}var a=t.createObjectURL(i),o=new window[r](a,n);return t.revokeObjectURL(a),o}catch(t){return new window[r]("data:application/javascript,".concat(encodeURIComponent(e)),n)}}catch(e){if(!s)throw Error("Inline worker is not supported");return new window[r](s,n)}}},506:(e,t,r)=>{r.d(t,{A:()=>n});class n{constructor(){this.addons={overlays:{auto_init:!0,activationConfigs:[]},web:{auto_init:!1,track_link_click:!0,engagement_edge_only:!0,track_form_submission:!0,segment_transition_edge_only:!0,activationConfigs:[]},rubicon_ssp:{auto_init:!0,publisher_id:"13590",activationConfigs:[]},scriptrunner:{auto_init:!0,activationConfigs:[]},appnexus_adserver:{auto_init:!0,member_id:833171,targeting_key_id:11765,segment_code_prefix:"permutive_",segment_name_prefix:"Permutive: ",activationConfigs:[]},dfp:{auto_init:!0,networks:[{name:"default",network_code:"91898098"}],track_slot_clicked:!0,track_slot_rendered:!1,track_slot_viewable:!0,track_targeting_keys:!1,activationConfigs:[]}}}getConfigByKey(e){const t=this.addons[e];return(e,r)=>{var n;return null!==(n=null==t?void 0:t[e])&&void 0!==n?n:r}}}},411:(e,t,r)=>{r.r(t),r.d(t,{PermutiveModels:()=>i});var n=r(567);function s(e){const t=(e,t)=>{const r=(e,t)=>{const r=e.toString(16);return("0".repeat(t)+r).slice(Math.min(-t,-r.length))};return`${r(e.getUint32(t),8)}-${r(e.getUint16(t+4),4)}-${r(e.getUint16(t+6),4)}-${r(e.getUint16(t+8),4)}-${r(e.getUint32(t+10),8)}${r(e.getUint16(t+14),4)}`},r=e=>i(e,1),s=e=>i(e,2),i=(e,r)=>{const n=t(e,1),s=((e,t)=>{switch(String.fromCharCode(e.getInt8(t))){case"1":return"1p";case"3":return"3p"}})(e,17),i=e.getInt8(18),a=e.getFloat32(19),o=e.getFloat32(23),[c,u]=((e,t,r,n,s,i)=>{const a=(e,t,r)=>r===e?t:r,o=(e,t,r,n)=>t+(r-t)*n/(Math.pow(2,e)-1),c={};let u=0;do{let l=null;1===i?(u=e.getUint16(t),l=e.getUint16(t+2),t+=4):(u=e.getUint32(t),l=e.getUint16(t+4),t+=6),c[a(0,"const",u)]=o(r,n,s,l)}while(0!==u);return[c,t]})(e,27,i,a,o,r);return[{version:r,id:n,data_preference:s,weights:c},u]};return(e=>{const i=[1,2],a=e.getInt8(0);if(1===a)return r(e);if(2===a)return s(e);{const r=(0,n.Y3)((()=>t(e,1))),s=(0,n.g_)((()=>"Couldn't decode model id"),(e=>`Model id was ${e}`))(r);throw new Error(`Decoding only supported for version(s): ${i}; Supplied version was ${a}; ${s}`)}})(e)}class i{constructor(e,t){this.logger=e,this._internals=t,this.MODELS_LAST_UPDATED_KEY="models_last_updated",this.MODELS_DATA_KEY="models_data",this.MODELS_SYNC_TIMEOUT_IN_SECONDS=86400;const r=this._internals.state.getPermutiveData(this.MODELS_LAST_UPDATED_KEY),n=t.metrics.startTimer("sdk_load_lookalike_models_task_duration_seconds",{});isNaN(r)||(new Date).getTime()>r+1e3*this.MODELS_SYNC_TIMEOUT_IN_SECONDS?this.models=this.fetchModels().then((e=>(this._internals.state.setPermutiveData(this.MODELS_DATA_KEY,e),this._internals.state.setPermutiveData(this.MODELS_LAST_UPDATED_KEY,(new Date).getTime()),e))).catch((e=>(this._internals.network.error("Failed decoding binary models.\nError: "+e),{}))):this.models=new Promise((e=>{t.metrics.stopTimer("sdk_load_lookalike_models_task_duration_seconds",n),e(this._internals.state.getPermutiveData(this.MODELS_DATA_KEY))}))}getModels(){return this.models}extractModelsFromJsonArray(e){const t={};for(let r=0;r<e.length;r++){const n=e[r],s=n.weights,i={"1p":{}};void 0!==n.id&&void 0!==s&&(Object.keys(s).forEach((e=>{i["1p"][e]=s[e]})),t[n.id]=i)}return t}fetchModels(){const e=(e,t,r)=>this._internals.api.models(e).then(t,r),t=()=>e("json",(e=>this.extractModelsFromJsonArray(e.models)),(e=>(this._internals.network.error("Failed fetching json models.\nError: "+e),{})));return(()=>e("binary",(e=>this.extractModelsFromJsonArray(function(e){const t=[];let r=0;for(;r<e.byteLength;){const[n,i]=s(new DataView(e,r));t.push(n),r+=i}return t}(e))),(e=>(this.logger.log("Failed fetching binary models, reverting to JSON.\nError: "+e),this._internals.metrics.track({name:"sdk_binary_models_missing_count",value:1,labels:{}}),t()))))()}}},226:(e,t,r)=>{r.r(t),r.d(t,{load:()=>o,AppNexusAdServerAddon:()=>c});var n=r(90);const s="_papns",i=function(){try{return window.apntag.getTag()}catch(e){return{}}},a=function(e){try{return window.apntag.getTag(e)}catch(e){return}},o=(e,t,r)=>{if(e.push({functionName:"addon",arguments:["appnexus_adserver",{}]}),void 0!==window.apntag&&window.apntag.anq&&window.apntag.anq.push){t.ready(r.makeSafe((()=>{let e=!1;const t=i();Object.keys(t).forEach((r=>{t[r].displayed&&(e=!0)}));const n=e?"sdk_targeting_realtime_fail_count":"sdk_targeting_realtime_success_count";r.metrics.track({name:n,value:1,labels:{target:"appnexus"}})})),"realtime");const e=function(e){return(Array.isArray(e)?e:[e]).map((e=>e.toString()))},n=function(t,r){const n=[];return(null==r?void 0:r.keywords)&&Object.keys(r.keywords).forEach((t=>{n.push({key:t,value:e(r.keywords[t])})})),{slot:{target_id:t.targetId,tag_id:t.tagId,height:t.height,width:t.width,targeting:n},ad:{type:t.adType,source:t.source,creative_id:t.creativeId,auction_id:t.auctionId,buyer_member_id:t.buyerMemberId,brand_category_id:t.brandCategoryId,media_type_id:t.mediaTypeId,media_sub_type_id:t.mediaSubType}}},s=function(e,r){const n=(null==e?void 0:e.utiframeId)||(null==e?void 0:e.targetId);if(n){let e=!1;window.addEventListener("blur",(function(){e&&t.track("AppNexusAdClick",r)})),document.getElementById(n).addEventListener("mouseover",(function(){e=!0})),document.getElementById(n).addEventListener("mouseout",(function(){e=!1}))}};window.__permutive=window.__permutive||{},window.__permutive.appnexusEvents=window.__permutive.appnexusEvents||[],window.__permutive.appnexusEvents.forEach((function(e){if("adLoaded"==e.eventType){const r=e.arg,i=a(r.targetId),o=n(r,i);t.track("AppNexusAdImpression",o),s(i,o)}})),window.apntag.anq.push((function(){window.apntag.onEvent("adLoaded",(e=>{const r=a(e.targetId),i=n(e,r);t.track("AppNexusAdImpression",i),s(r,i)}))}))}};class c{constructor(e){this.permutive=e.permutive,this._internals=e._internals;const t=this._internals.getExternalData(s);this.liveSegments=t?JSON.parse(t):[],this.eligibleSegments={};const r=this._internals.state.activationManager.getSpecializedActivations("appnexus_adserver");for(let e=0;e<r.length;e++){const t=r[e];this.eligibleSegments[t]=1}const n=this._internals.queryManager.userSegments.getAllAsList();if(this.updateSegments(this.filterSegments(n)),window.apntag&&window.apntag.anq&&window.apntag.anq.push){const e=this;window.apntag.anq.push((function(){const t=window.apntag.defineTag;window.apntag.defineTag=function(r){t(r),e._internals.makeSafe((function(){if(r.targetId){const t=e._internals.queryManager.userSegments.getAllAsList();e.updateSegments(e.filterSegments(t),r.targetId)}}))()}}))}this._internals.messages.on("permutive:segments:updated",this._internals.makeSafe((()=>{const e=this._internals.queryManager.userSegments.getAllAsList();this.updateIfNecessary(e)}))),this._internals.messages.on("permutive:reset",this._internals.makeSafe((()=>{this._internals.removeExternalData(s),this._internals.deleteCookie(s),this.liveSegments=[]})))}updateIfNecessary(e){const t=this.filterSegments(e);(0,n.cO)(t,this.liveSegments)||this.updateSegments(t)}updateSegments(e,t){window.apntag&&window.apntag.anq&&window.apntag.anq.push&&window.apntag.anq.push((()=>{const r={permutive:[...e,"rts"]};t?window.apntag.setKeywords(t,r,{overrideKeyValue:!0}):Object.keys(i()).forEach((e=>window.apntag.setKeywords(e,r,{overrideKeyValue:!0})))}));const r=JSON.stringify(e);this._internals.setExternalData(s,r),this.liveSegments=e}filterSegments(e){return e.filter((e=>e in this.eligibleSegments))}}},613:(e,t,r)=>{r.r(t),r.d(t,{load:()=>g,DFPAddon:()=>_});var n=r(90),s=r(506),i=r(276),a=r(71);const o="_pdfps",c={},u=(new s.A).getConfigByKey("dfp"),l=(new s.A).getConfigByKey("web"),d=()=>u("track_slot_rendered",!0),p=()=>u("track_slot_clicked",!0),f=()=>l("slotrendered_aggregated",!1),m=[],g=(e,t,r)=>{e.push({functionName:"addon",arguments:["dfp",{}]});window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push((function(){t.ready(r.makeSafe((()=>{let e=0;googletag.pubads&&googletag.pubads().getSlots&&googletag.pubads().getSlots().length>0&&googletag.pubads().getSlots().forEach((function(t){t.getResponseInformation()&&e++}));const t=0===e?"sdk_targeting_realtime_success_count":"sdk_targeting_realtime_fail_count";r.metrics.track({name:t,value:1,labels:{target:"dfp"}})})),"realtime");const e=function(){const e=r.getExternalData(o);return e?JSON.parse(e):[]}();googletag.cmd.push((function(){const t=googletag.pubads().getTargeting("permutive")||[];googletag.pubads().setTargeting("permutive",e.map(String).concat(t))}));const s=function(e){const t={ad_unit_path:e.getAdUnitPath(),slot_element_id:e.getSlotElementId()};return u("track_targeting_keys",!1)?Object.assign(Object.assign({},t),(()=>{const t={targeting_keys:[]},r={},n=e.getTargetingKeys();for(let s=0;s<n.length;s++){const i=n[s],a=[],o=e.getTargeting(i);for(let e=0;e<o.length;e++)a.push(o[e].toString());a.length>0&&(r[i]=1,t.targeting_keys.push({key:i,value:a}))}const s=googletag.pubads().getTargetingKeys();for(let e=0;e<s.length;e++){const n=s[e],i=[];if(void 0===r[n]){const r=googletag.pubads().getTargeting(s[e]);for(let e=0;e<r.length;e++)i.push(r[e].toString());i.length>0&&t.targeting_keys.push({key:n,value:i})}}return t})()):t},i=function(e){try{let r=!1;window.addEventListener("blur",(function(){if(r){const r=c[e];r&&p()&&t.track("SlotClicked",r)}})),document.getElementById(e).addEventListener("mouseover",(function(){r=!0})),document.getElementById(e).addEventListener("mouseout",(function(){r=!1}))}catch(e){}};googletag.pubads&&googletag.pubads().getSlots&&googletag.pubads().getSlots().forEach((function(e){const r=e.getResponseInformation();if(r){const a=e.getSlotElementId(),o={advertiser_id:(0,n.ke)(r.advertiserId),campaign_id:(0,n.ke)(r.campaignId),line_item_id:(0,n.ke)(r.lineItemId),creative_id:(0,n.ke)(r.creativeId),is_empty:!1,service_name:"publisher_ads",slot:s(e)};c[a]=o,d()&&(t.track("SlotRendered",Object.assign(Object.assign({},o),f()?{rendered_timestamp:Date.now()}:{}),{isAnalyticsOnly:!0}),f()&&m.push(o)),i(a)}})),googletag.cmd.push((function(){googletag.pubads().addEventListener("slotRenderEnded",(function(e){const r=e,a=r.slot.getSlotElementId(),o={advertiser_id:(0,n.ke)(r.advertiserId),campaign_id:(0,n.ke)(r.campaignId),line_item_id:(0,n.ke)(r.lineItemId),creative_id:(0,n.ke)(r.creativeId),is_empty:r.isEmpty,service_name:r.serviceName,slot:s(e.slot)};if(r.size){const[e,t,...n]=r.size;"number"==typeof e&&"number"==typeof t&&(o.width=e,o.height=t)}c[a]=o,d()&&(t.track("SlotRendered",Object.assign(Object.assign({},o),f()?{rendered_timestamp:Date.now()}:{}),{isAnalyticsOnly:!0}),f()&&m.push(o)),i(a)})),u("track_slot_viewable",!1)&&googletag.pubads().addEventListener("impressionViewable",(function(e){const r=e.slot.getResponseInformation();r&&t.track("SlotViewable",{advertiser_id:(0,n.ke)(r.advertiserId),campaign_id:(0,n.ke)(r.campaignId),line_item_id:(0,n.ke)(r.lineItemId),creative_id:(0,n.ke)(r.creativeId),service_name:e.serviceName,slot:s(e.slot)})}))})),window.addEventListener("message",(function(e){try{const r=JSON.parse(e.data);if(r.permutive_type&&"google_ad_click"===r.permutive_type){const e=r.data.ad_unit_path,s=(0,n.ke)(r.data.creative_id);let i;Object.keys(c).forEach((t=>{void 0!==c[t].slot&&c[t].slot.ad_unit_path===e&&c[t].creative_id===s&&(i=c[t])})),i=i||{line_item_id:(0,n.ke)(r.data.line_item_id),advertiser_id:(0,n.ke)(r.data.advertiser_id),campaign_id:(0,n.ke)(r.data.order_id),creative_id:(0,n.ke)(s),is_empty:!1},p()&&t.track("SlotClicked",i)}}catch(e){}}),!1)}))};class _{constructor(e){this.trackedTargetingLimitMetric=!1,this.trackedRenderedSlots=m,this._internals=e._internals;const t=this._internals.getExternalData(o);this.liveSegments=t?JSON.parse(t):[],this.cleanRoomSegments=this.getCachedCleanRoomSegments(),this.eligibleSegments={};const r=this._internals.state.activationManager.getSpecializedActivations("dfp");for(let e=0;e<r.dfp.length;e++){const t=r.dfp[e];this.eligibleSegments[t]=t}for(const e in r.dfp_legacy)if(r.dfp_legacy.hasOwnProperty(e)){const t=r.dfp_legacy[e];this.eligibleSegments[e]=t}const n=this._internals.queryManager.userSegments.getAllAsList();this.updateSegments(this.filterSegments(n)),this._internals.messages.emit("permutive:dfp:ready"),this._internals.messages.on("permutive:segments:updated",this._internals.makeSafe((()=>{const e=this._internals.queryManager.userSegments.getAllAsList();this.updateIfNecessary(e)}))),this._internals.messages.on("permutive:cleanroom:db:updated",(e=>{this.cleanRoomSegments=e,this.updateWithCurrent()})),this._internals.messages.on("permutive:reset",this._internals.makeSafe((()=>{this._internals.removeExternalData(o),this._internals.deleteCookie(o),this.liveSegments=[]})))}getCachedCleanRoomSegments(){var e,t;const r=null!==(e=JSON.parse(this._internals.getExternalData("_pcrdbs")))&&void 0!==e?e:[],n=null!==(t=JSON.parse(this._internals.getExternalData("_pcrprs")))&&void 0!==t?t:[];return(0,i.G0)(a.Eq)(r)(n)}updateIfNecessary(e){const t=this.filterSegments(e);(0,n.cO)(t,this.liveSegments)||this.updateSegments(t)}updateWithCurrent(){this.updateSegments(this.liveSegments)}updateSegments(e){let t=e.concat(this.cleanRoomSegments);encodeURIComponent(JSON.stringify(t)).length>1500&&(t=e,this.trackedTargetingLimitMetric||(this._internals.metrics.track({name:"sdk_targeting_size_limit_exceeded_count",value:1,labels:{target:"dfp"}}),this.trackedTargetingLimitMetric=!0)),window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push((()=>{const e=googletag.pubads().getTargeting("permutive")||[],r=(0,i.uK)((e=>Object.values(this.eligibleSegments).map(String).concat(this.cleanRoomSegments).concat("rts").includes(e)))(e).left,n=t.map(String).concat(r).concat("rts");googletag.pubads().setTargeting("permutive",n)}));const r=JSON.stringify(t.map(String));this._internals.setExternalData(o,r),u("sync_segments_cookie",!1)&&this._internals.api.segmentSync(o,r),this.liveSegments=e}filterSegments(e){return e.filter((e=>e in this.eligibleSegments)).map((e=>this.eligibleSegments[e]))}}},718:(e,t,r)=>{r.r(t),r.d(t,{load:()=>n,OverlaysAddon:()=>s});const n=(e,t,r)=>{e.unshift({functionName:"addon",arguments:["overlays",{}]})};class s{constructor(e){const t=this;this.permutive=e.permutive,this._internals=e._internals,this.activations=this._internals.state.activationManager.getActivations("overlays"),this.loadedImageCounts={};for(let e=0;e<this.activations.length;e++){const r=this.activations[e],n=r.config,s=this.buildOverlayCss(n,e);document.head.insertAdjacentHTML("beforeend",s);const i=this.buildOverlayBody(n,e);document.body.insertAdjacentHTML("beforeend",i);const a=`permutive-overlay-${e}`,o=document.getElementById(a),c=o.getElementsByClassName("close")[0],u=o.getElementsByClassName("content")[0],l=()=>{o.style.visibility="hidden",o.style.opacity="0"},d=e=>{u.contains(e.target)||(l(),o.removeEventListener("click",d))};c.addEventListener("click",l),o.addEventListener("click",d);[].slice.call(o.getElementsByTagName("a")).slice(1).forEach((e=>{e.addEventListener("click",(function(){r.trackConversion({useBeacon:!0})}))}));const p=o.getElementsByTagName("form")[0];p&&p.addEventListener("submit",(function(e){e.preventDefault(),r.trackConversion({success:function(){p.submit()}})}));const f=function(e,r){t.showOverlay(e),r.trackImpression()};r.activateEveryTime()?this.permutive.segment(r.segmentCode,this._internals.makeSafe((e=>{e?f(a,r):this.permutive.trigger(r.segmentCode,"result",(function(e){e.result&&f(a,r)}))}))):r.activateOnEntry()?this.permutive.trigger(r.segmentCode,"result",this._internals.makeSafe((function(e){e.result&&f(a,r)}))):r.activateOnExit()&&this.permutive.trigger(r.segmentCode,"result",this._internals.makeSafe((function(e){e.result||f(a,r)})))}}buildOverlayCss(e,t){return'<style type="text/css">.${overlay_class}{position:fixed;top:0;bottom:0;left:0;right:0;width:100%;height:100%;background:rgba(0,0,0,0.${opacity_percentage});transition:opacity ${opacity_transition_ms}ms;visibility:hidden;opacity:0;z-index:1000000;}.${modal_class}{position:fixed;padding:10px;background:#fff;border-radius:5px;z-index:1000001}.${modal_class} .content{overflow:auto;z-index:1000002;}.${modal_class} .close{position:absolute;top:20px;right:30px;transition:all 200ms;font-size:30px;font-weight:bold;text-decoration:none;color:#333;z-index:1000003}.${modal_class} .close:hover{color:orange;}</style>'.replace(/\${overlay_class}/g,"permutive-overlay-"+t).replace(/\${modal_class}/g,"permutive-modal-"+t).replace("${opacity_percentage}",e.opacity_percentage.toString()).replace("${opacity_transition_ms}",e.opacity_transition_ms.toString())}buildOverlayBody(e,t){const r=this._internals.config.windowKey;let n="";return!function(e){return void 0!==e.html}(e)?function(e){return void 0!==e.image_url&&void 0!==e.image_link}(e)&&(n='<a href="'+e.image_link+'"><img src="'+e.image_url+'"/></a>'):n=e.html,'<div id="${overlay_class}" class="${overlay_class}"><div id="${modal_class}" class="${modal_class}"><a class="close" href="javascript:;">&times;</a><div class="content">${content}</div></div></div>'.replace(/\${overlay_class}/g,"permutive-overlay-"+t).replace(/\${modal_class}/g,"permutive-modal-"+t).replace("${content}",n).replace(/<img /g,`<img onload='window[${r}].addons.overlays.loadedImage("permutive-overlay-" + num + "")' `)}showOverlay(e){const t=document.getElementById(`${e}`),r=()=>{const e=t.getElementsByTagName("div")[0],r=e.getBoundingClientRect().height,n=e.getBoundingClientRect().width;e.style.left=window.innerWidth/2-n/2+"px",e.style.top=window.innerHeight/2-r/2+"px",t.style.visibility="visible",t.style.opacity="1"},n=t.getElementsByTagName("img");if(n.length>0){let t=0;const s=()=>{t<10&&(!(e in this.loadedImageCounts)||this.loadedImageCounts[e]<n.length)?(t+=1,setTimeout(s,500)):r()};s()}else r()}loadedImage(e){e in this.loadedImageCounts?this.loadedImageCounts[e]=this.loadedImageCounts[e]+1:this.loadedImageCounts[e]=1}}},404:(e,t,r)=>{r.r(t),r.d(t,{load:()=>i,RubiconSspAddon:()=>a});var n=r(90);const s="_prubicons",i=(e,t,r)=>{e.push({functionName:"addon",arguments:["rubicon_ssp",{}]})};class a{constructor(e){this._internals=e._internals;const t=this._internals.getExternalData(s);this.liveSegments=t?JSON.parse(t):[],this.eligibleSegments={};const r=this._internals.state.activationManager.getSpecializedActivations("rubicon_ssp");for(let e=0;e<r.length;e++)this.eligibleSegments[r[e]]=!0;const n=this._internals.queryManager.userSegments.getAllAsList();this.updateIfNecessary(n),this._internals.messages.on("permutive:segments:updated",(()=>{const e=this._internals.queryManager.userSegments.getAllAsList();this.updateIfNecessary(e)})),this._internals.messages.on("permutive:reset",this._internals.makeSafe((()=>{localStorage.removeItem(s),this.liveSegments=[]})))}updateIfNecessary(e){const t=this.filterSegments(e);(0,n.cO)(t,this.liveSegments)||this._internals.setExternalData(s,JSON.stringify(t)),this.liveSegments=t}filterSegments(e){return e.filter((e=>e in this.eligibleSegments))}}},926:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{load:()=>load,ScriptRunnerAddon:()=>ScriptRunnerAddon});const load=(e,t,r)=>{e.unshift({functionName:"addon",arguments:["scriptrunner",{}]})};class ScriptRunnerAddon{constructor(options){this.permutive=options.permutive,this._internals=options._internals,this.network=options.network,this.activations=this._internals.state.activationManager.getActivations("scriptrunner");for(let i=0;i<this.activations.length;i++){const activation=this.activations[i],run=activation=>{const script=activation.config.script.replace(/impression\(\)/g,"activation.trackImpression();").replace(/conversion\(\)/g,"activation.trackConversion();");try{eval(script)}catch(e){e.message="Error running custom script: "+e.message,this.network.error(e,this._internals.state.userId)}};activation.activateEveryTime()?this.permutive.segment(activation.segmentCode,(e=>{e?run(activation):this.permutive.trigger(activation.segmentCode,"result",(function(e){e.result&&run(activation)}))})):activation.activateOnEntry()?this.permutive.trigger(activation.segmentCode,"result",(function(e){e.result&&run(activation)})):activation.activateOnExit()&&this.permutive.trigger(activation.segmentCode,"result",(function(e){e.result||run(activation)}))}}}},362:(e,t,r)=>{r.r(t),r.d(t,{load:()=>l,WebAddon:()=>d});var n=r(90),s=r(567),i=r(506),a=r(479);const o=["mousemove","click","scroll"],c=["email","tel","submit","reset","button","file","password","radio","checkbox"],u=["email","e-mail","password","tel","telephone","phone"],l=(e,t,r)=>{0};class d{constructor(e){this.dirtyState=!1,this.initialised=!1,this.totalCompletion=0,this.totalEngagedTime=0,this.webAddonConfig=(new i.A).getConfigByKey("web"),this.engagementEdgeOnly=this.webAddonConfig("engagement_edge_only",!0),this.segmentTransitionEdgeOnly=this.webAddonConfig("segment_transition_edge_only",!0),this.trackPageviewEngagement=this.webAddonConfig("track_pageview_engagement",!0),this.trackPageviewComplete=this.webAddonConfig("track_pageview_complete",!0),this.trackFormSubmission=this.webAddonConfig("track_form_submission",!0),this.trackLinkClick=this.webAddonConfig("track_link_click",!0),this.addAlchemyTaxonomy=this.webAddonConfig("add_alchemy_taxonomy",!1),this.addAlchemyEntities=this.webAddonConfig("add_alchemy_entities",!1),this.prebidAggregated=this.webAddonConfig("prebid_aggregated",!1),this.slotRenderedAggregated=this.webAddonConfig("slotrendered_aggregated",!1),this.pageviewCompleteTimeoutDuration=6e5,this.hasPageviewCompleteFired=!1,this.permutive=e.permutive,this._internals=e._internals,this.context=e.context,this.eventInterval=e.eventInterval||5,this.logger=e.logger,this._internals.customProperties.overrideCustomProps(e.page||{}),this.sendPageviewEvent(),(e.dirtyEvents||o).map((e=>{window.addEventListener(e,(()=>{this.dirtyState=!0,this.trackPageviewComplete&&this.resetTimeout()}))})),"loading"!==document.readyState?this.attachListeners():window.addEventListener("DOMContentLoaded",this.attachListeners,!1),this.trackPageviewEngagement&&(this.timerHandle=this.registerEngagementInterval(this.eventInterval)),this.trackPageviewComplete&&(this.setPageviewCompleteTimeout(this.pageviewCompleteTimeoutDuration),(0,n.aq)((()=>this.hasPageviewCompleteFired?null:this.sendPageviewCompleteEvent(this.totalEngagedTime,this.totalCompletion)),navigator.userAgent)),this.initialised=!0}sendPageviewEvent(){const e=Object.assign(Object.assign(Object.assign(Object.assign({isp_info:"$ip_isp_info",geo_info:"$ip_geo_info"},{ip_address:"$ip_address"}),{}),this.enrichmentProperties(this.context.isArticle)),this._internals.customProperties.getCustomProps()),t={success:()=>{this.initialised||this._internals.metrics.trackTimeSinceInit("sdk_first_event_tracked_task_duration_seconds",{})}};this.permutive.track("Pageview",e,t).then((e=>{this._internals.messages.emit("permutive:event:pageview",e)}))}sendLinkClickEvent(e,t){if(window.location.href&&e.href){const r=0===e.href.indexOf("data:")?"NOT_URL":e.href;this.permutive.track("LinkClick",{dest_url:r},{useBeacon:t})}}sendFormSubmissionEvent(e){const t=e.currentTarget,r={form:Object.assign(Object.assign(Object.assign({method:t.method||"GET",properties:this.serializeForm(t)},"string"==typeof t.id?{id:t.id}:{}),t.name&&"string"==typeof t.name?{name:t.name}:{}),t.action&&"string"==typeof t.action?{action:t.action}:{})};this.permutive.track("FormSubmission",r)}sendEngagementEvent(e){const{engaged_time:t,total_engaged_time:r,completion:n,total_completion:s}=this.updateState(e),i=Object.assign(Object.assign({isp_info:"$ip_isp_info",geo_info:"$ip_geo_info",engaged_time:t,total_engaged_time:r},this._internals.customProperties.getCustomProps()),{completion:n,total_completion:s});this.permutive.track("PageviewEngagement",i,{isMemoryOnly:this.engagementEdgeOnly})}sendPageviewCompleteEvent(e,t,r=!0){var n,s,i,a;const o=Object.assign(Object.assign(Object.assign({isp_info:"$ip_isp_info",geo_info:"$ip_geo_info"},this._internals.customProperties.getCustomProps()),this.enrichmentProperties(this.context.isArticle)),{aggregations:Object.assign(Object.assign(Object.assign({PageviewEngagement:Object.assign({engaged_time:e},{completion:t})},this.segmentTransitionEdgeOnly?{SegmentEntry:Array.from(this._internals.queryManager.segmentEntryQueryCodes),SegmentExit:Array.from(this._internals.queryManager.segmentExitQueryCodes)}:{}),this.prebidAggregated?{PrebidBids:null===(s=null===(n=this._internals.addons)||void 0===n?void 0:n.prebid)||void 0===s?void 0:s.trackedBids}:{}),this.slotRenderedAggregated?{SlotsRendered:null===(a=null===(i=this._internals.addons)||void 0===i?void 0:i.dfp)||void 0===a?void 0:a.trackedRenderedSlots}:{})});this.permutive.track("PageviewComplete",o,{useBeacon:r}),this.hasPageviewCompleteFired=!0}reset(e){this.trackPageviewComplete&&(this.sendPageviewCompleteEvent(this.totalEngagedTime,this.totalCompletion,!1),this.hasPageviewCompleteFired=!1),this._internals.state.viewId=(0,n.k$)(),this._internals.customProperties.overrideCustomProps(e.page||{}),this.totalCompletion=0,this.totalEngagedTime=0,(0,a.h)({enricher:"watson",logger:this.logger,_internals:this._internals,context:this.context}).then((()=>this._internals.graphql.run())).then((()=>{this.sendPageviewEvent(),this.trackPageviewEngagement&&(clearInterval(this.timerHandle),this.timerHandle=this.registerEngagementInterval(this.eventInterval))}))}serializeForm(e){return[...e.getElementsByTagName("input")].filter((e=>!(!e.type||!e.id||e.disabled||e.checked||"fieldset"===e.nodeName.toLowerCase()||-1!==c.indexOf(e.type.toLowerCase())||-1!==u.indexOf(e.name.toLowerCase())))).map((e=>({name:e.name||e.id,value:e.value}))).filter((e=>e.value.length<120))}enrichmentProperties(e){return Object.assign(Object.assign(Object.assign(Object.assign({},e&&this.addAlchemyTaxonomy?{taxonomy_labels:"$alchemy_taxonomy_labels"}:{}),e&&this.addAlchemyEntities?{entity_names:"$alchemy_entity_names"}:{}),{classifications_watson:{taxonomy_labels:"$taxonomy_labels"}}),{})}registerEngagementInterval(e){return setInterval((()=>{this.dirtyState&&this.sendEngagementEvent(e)}),1e3*e)}attachListeners(){const e=e=>"a"===e.tagName.toLowerCase(),t=r=>e(r)?(0,s.G)(r):r.parentElement?e(r.parentElement)?(0,s.G)(r.parentElement):t(r.parentElement):s.YP;this.trackFormSubmission&&[].slice.call(document.getElementsByTagName("form"),0).forEach((e=>{e.addEventListener("submit",this._internals.makeSafe(this.sendFormSubmissionEvent.bind(this)))})),this.trackLinkClick&&document.body.addEventListener("click",(e=>{if(e.target instanceof Element){const r=t(e.target);return(0,s.g_)((()=>{}),(t=>this.sendLinkClickEvent(t,((e,t)=>!("_blank"===t.target||e.metaKey||e.ctrlKey||e.shiftKey||2===e.which||3===e.which))(e,t))))(r)}}))}updateState(e){const t=Math.max(this.totalCompletion,this.getCurrentCompletion()),r=t-this.totalCompletion;return this.totalEngagedTime+=e,this.totalCompletion=t,this.dirtyState=!1,{engaged_time:e,total_engaged_time:this.totalEngagedTime,completion:r,total_completion:this.totalCompletion}}getCurrentCompletion(){const e=document.documentElement.scrollHeight,t=window.pageYOffset+window.innerHeight;return t<=0?0:t>=e?1:t/e}setPageviewCompleteTimeout(e){return window.setTimeout((()=>this.sendPageviewCompleteEvent(this.totalEngagedTime,this.totalCompletion,!1)),e)}resetTimeout(){clearTimeout(this.pageviewCompleteTimeoutHandle),this.pageviewCompleteTimeoutHandle=this.setPageviewCompleteTimeout(this.pageviewCompleteTimeoutDuration)}}},372:(e,t,r)=>{r.d(t,{b:()=>n,J:()=>s});class n{}class s{constructor(){this.replacementMap={}}register(e){this.replacementMap=Object.assign(Object.assign({},this.replacementMap),e.replacementMap)}enrich(e){const t=[{},!0];for(let r=0;r<Object.keys(e[0]).length;r++){const n=Object.keys(e[0])[r],s=e[0][n];switch(!0){case"string"==typeof s&&"$"===s[0]:const[e,r]=this.isPropertyReplaceable(s);t[0][n]=e?r:s,t[1]=!!e&&t[1];break;case null!==s&&"object"==typeof s&&s.constructor===Object:const i=this.enrich([s,t[1]]);t[0][n]=i[0],t[1]=t[1]&&i[1];break;default:t[0][n]=s}}return t}isPropertyReplaceable(e){const t=this.replacementMap[e];return[this.replacementMap.hasOwnProperty(e)&&t!==e,t]}}},479:(e,t,r)=>{r.d(t,{h:()=>w,Y:()=>y});var n=r(735),s=r(341),i=(r(268),r(384));r(567),r(870);var a=function(e){return Object.keys(e).sort()};function o(e){return function(t){var r={};for(var n in t)i.e$.call(t,n)&&(r[n]=e(n,t[n]));return r}}function c(e){return o((function(t,r){return e(r)}))}var u=function(e,t){return(0,n.zG)(e,c(t))},l="ReadonlyRecord";var d={URI:l,map:u};(0,s.OV)(d);var p=a;Object.prototype.hasOwnProperty;var f=c;var m=function(e,t){return(0,n.zG)(e,f(t))},g="Record",_={URI:g,map:m},h=((0,s.OV)(_),r(745)),v=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,o)}c((n=n.apply(e,t||[])).next())}))};const b=(0,h.H)([[{name:"geoip",import:Promise.resolve().then(r.bind(r,659))}],[{name:"watson",import:Promise.resolve().then(r.bind(r,205))}]]),w=({_internals:e,enricher:t,context:r,logger:n})=>v(void 0,void 0,void 0,(function*(){const s=yield b[t];return s?(n.log(`Registering enricher ${t}`),s.register({logger:n,_internals:e,context:r})):n.log(`Failed to register enricher ${t}, it is not enabled!`)})),y=({_internals:e,context:t,logger:r})=>{const n=p(b).map((n=>w({enricher:n,logger:r,_internals:e,context:t})));return Promise.all(n)}},659:(e,t,r)=>{r.r(t),r.d(t,{GraphQLGeoIP:()=>a,register:()=>o});var n=r(90),s=r(372);class i extends s.b{constructor(e){super(),this.replacementMap={$ip_geo_info:e.geo,$ip_isp_info:e.isp,$ip_address:e.ip,$ip_address_hash:e.ip_hash}}}class a{constructor(e){this.resource="geoip",this.query=()=>`geoip { ${[this.config.includeGeo?"geo { continent country city province postal_code }":"",this.config.includeISP?"isp { isp organization autonomous_system_number autonomous_system_organization }":"",this.config.includeIP?"ip":"",this.config.includeIPHash?"ip_hash":""].join(" ")} }`,this.config=e}}const o=({_internals:e,context:t})=>{const r="enricher:geoip",s=e=>{e.isp&&(t.isp=e.isp.isp,t.organization=e.isp.organization,t.autonomous_system_number=e.isp.autonomous_system_number,t.autonomous_system_organization=e.isp.autonomous_system_organization),e.geo&&(t.continent=e.geo.continent,t.country=e.geo.country,t.city=e.geo.city,t.province=e.geo.province,t.postal_code=e.geo.postal_code)},o=e.state.getPermutiveData(r);if(o&&o.session_id===e.sessionManager.getSessionId())s(o.data),e.enrichers.register(new i(o.data));else{const t={includeGeo:(0,n.g8)({classifications_watson:{categories_enabled:!0,properties_to_hide:["classifications_watson"],std_segments_enabled:!0,event_enrichment_enabled:!1},geoip:{}},"geoip","include_geo")||!0,includeISP:(0,n.g8)({classifications_watson:{categories_enabled:!0,properties_to_hide:["classifications_watson"],std_segments_enabled:!0,event_enrichment_enabled:!1},geoip:{}},"geoip","include_isp")||!0,includeIPHash:(0,n.g8)({classifications_watson:{categories_enabled:!0,properties_to_hide:["classifications_watson"],std_segments_enabled:!0,event_enrichment_enabled:!1},geoip:{}},"geoip","include_ip_hash")||!0,includeIP:!0};e.graphql.register(new a(t)).then((t=>{s(t),e.state.setPermutiveData(r,{session_id:e.sessionManager.getSessionId(),data:t}),e.enrichers.register(new i(t))})).catch((t=>e.network.error(`Error while registering the geoip enricher: got ${t}`)))}}},205:(e,t,r)=>{r.r(t),r.d(t,{enumerateAllValidHierarchies:()=>c,GraphQLWatson:()=>u,register:()=>l});var n=r(90),s=r(372),i=r(276),a=r(71);class o extends s.b{constructor(e){super(),this.replacementMap={$alchemy_concepts:(0,n.g8)(e,"concepts")||"$alchemy_concepts",$alchemy_entities:(0,n.g8)(e,"entities")||"$alchemy_entities",$alchemy_keywords:(0,n.g8)(e,"keywords")||"$alchemy_keywords",$alchemy_taxonomy:(0,n.g8)(e,"taxonomies")||"$alchemy_taxonomy",$alchemy_document_emotion:(0,n.g8)(e,"emotion","document","emotion")||"$alchemy_document_emotion",$alchemy_document_sentiment:(0,n.g8)(e,"sentiment","document")||"$alchemy_document_sentiment",$alchemy_taxonomy_labels:c(e.taxonomies)||"$taxonomy_labels",$alchemy_entity_names:e.entities.map((e=>e.text))||"$alchemy_entities_names",$taxonomy_labels:c(e.taxonomies)||"$taxonomy_labels"}}}function c(e){const t=(0,i.xH)(e.filter(Boolean).map((e=>(e=>{const t=e.split("/").filter((e=>e));return t.map(((e,r)=>"/"+t.slice(0,r+1).join("/")))})(e.label))));return(0,i.jj)(a.Eq)(t)}class u{constructor(){this.resource="classification",this.query=()=>`\n      classification(url: "${window.location.href}") {\n        url\n        updated\n        entities {\n          text\n          relevance\n        }\n        keywords {\n          text\n          relevance\n        }\n        concepts {\n          text\n          relevance\n        }\n        taxonomies {\n          label\n          score\n        }\n        emotion {\n          document {\n            emotion {\n              anger\n              disgust\n              fear\n              joy\n              sadness\n            }\n          }\n        }\n        sentiment {\n          document {\n            label\n            score\n          }\n        }\n      }\n    `}}const l=({logger:e,_internals:t,context:r})=>{t.graphql.register(new u).then((e=>{var n;n=e,r.watson=n,t.enrichers.register(new o(e))})).catch((r=>{e.log(`Error while registering the watson enricher: got ${r}`),t.metrics.track({name:"sdk_watson_classification_fail_count",value:1,labels:{}})}))}},739:(e,t,r)=>{r.r(t),r.d(t,{AppNexusIdentityProvider:()=>a,make:()=>o});var n=r(567),s=r(735),i=r(90);class a{constructor(e,t){this._internals=e,this.network=t,this.tag="appnexus",this.ttlInSeconds=86400,this.usedForThirdPartyData=!0,this.url="https://ib.adnxs.com/getuidj",this.invalidAliases=["0","-1"]}getId(){return(0,i.G6)(navigator.userAgent)?Promise.resolve({type:"skipped"}):this.network.ajax({url:this.url,xhrFields:{withCredentials:!0},timeout:3e3}).then((e=>({type:"attempted",result:(0,s.zG)((0,n.DT)((e=>e.uid&&this.isValidAlias(e.uid)))(e),(0,n.UI)((e=>e.uid)))})),(e=>(0,s.zG)(this.network.error(`Failed to retrieve third-party identity for ${this.tag}. Got ${e}`,this._internals.state.userId),(e=>({type:"attempted",result:n.YP})))))}reset(){return Promise.resolve()}isValidAlias(e){return-1===this.invalidAliases.indexOf(e)}}const o=(e,t)=>Promise.resolve((0,n.G)(new a(e,t)))},998:(e,t,r)=>{r.r(t),r.d(t,{PxidIdentityProvider:()=>a,make:()=>o});var n=r(90),s=r(735),i=r(567);class a{constructor(e,t){this._internals=e,this.network=t,this.tag="pxid",this.ttlInSeconds=86400,this.usedForThirdPartyData=!1,this.url=`https://16d3bd5c-bf92-4bf0-815a-eac397d3aadf.${this._internals.config.pxidHost}/${this._internals.config.apiVersion}/pxid`,this.resetUrl=this.url+"/reset"}getId(){return(0,n.G6)(navigator.userAgent)?Promise.resolve({type:"skipped"}):this.network.req({url:this.url,xhrFields:{withCredentials:!0},method:"GET",contentType:"text/plain"},!1).then((e=>({type:"attempted",result:(0,i.ij)(e.uid)})),(e=>(0,s.zG)(this.network.error(`Failed to retrieve third-party identity for ${this.tag}. Got ${e}`,this._internals.state.userId),(e=>({type:"attempted",result:i.YP})))))}reset(){return(0,n.G6)(navigator.userAgent)?Promise.resolve():this.network.req({url:this.resetUrl,xhrFields:{withCredentials:!0},method:"POST"},!1)}}const o=(e,t)=>Promise.resolve((0,i.G)(new a(e,t)))},840:(e,t,r)=>{r.r(t),r.d(t,{PermutiveAudienceMarketLocalStorage:()=>n,register:()=>s});class n{constructor(e,t){this.segmentsWithPAM=e,this.internals=t,this.PUSH_TO_MARKETPLACE_STD_SEGMENTS_KEY="_ppam"}storeStdSegmentsToLocalStorage(e){const t=[];for(const r in e)r in this.segmentsWithPAM&&t.push(parseInt(r));const r=JSON.stringify(t);this.internals.setExternalData(this.PUSH_TO_MARKETPLACE_STD_SEGMENTS_KEY,r)}}const s=(e,t,r)=>{[].forEach((n=>n.then((n=>n.register(e,t,r)))));const s=new n({},e);e.messages.on("permutive:std_segments:updated",(e=>{s.storeStdSegmentsToLocalStorage(e)}))}},612:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{m:()=>executeCustomerScripts});var fp_ts_Either__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(70);function executeCustomerScripts(scripts,internals,network){scripts.forEach((s=>{(0,fp_ts_Either__WEBPACK_IMPORTED_MODULE_0__.Y3)(eval(s),(e=>{network.error(Object.assign(Object.assign({},e),{message:`Error running custom script ${s}`}),internals.state.userId)}))}))}},90:(e,t,r)=>{r.d(t,{cO:()=>P,a4:()=>g,PQ:()=>I,b2:()=>m,rB:()=>h,fl:()=>x,yK:()=>_,vp:()=>f,G6:()=>O,Gz:()=>q,g8:()=>p,b0:()=>k,PM:()=>d,Fi:()=>E,ke:()=>b,m8:()=>S,aq:()=>w,eu:()=>v,k$:()=>y});var n=r(735),s=r(567),i=r(268);new Set;var a=function(e){return function(t){for(var r,n=t.values(),s=!1;!s&&!(r=n.next()).done;)s=e(r.value);return s}},o=function(e){return(0,n.ff)(a((0,n.ff)(e)))};function c(e){var t=u(e);return function(r,n){if(void 0===n){var s=c(e);return function(e){return s(e,r)}}return o((function(e){return t(e,n)}))(r)}}function u(e){return function(t,r){if(void 0===r){var n=u(e);return function(e){return n(t,e)}}for(var s,i=r.values(),a=!1;!a&&!(s=i.next()).done;)a=e.equals(t,s.value);return a}}var l=function(e){var t=c(e);return(0,i.f7)((function(e,r){return t(e,r)&&t(r,e)}))};new Set;function d(...e){return e.reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{})}function p(e,...t){return t.reduce(((e,t)=>e?e[t]:void 0),e)}function f(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t&=t;return t}function m(){let e,t;return{promise:new Promise(((r,n)=>{e=r,t=n})),reject:t,resolve:e}}function g(e,t,r={}){const{waitTimeInMs:i,exponentialBackOff:a,maxAttempts:o}=d({waitTimeInMs:50,exponentialBackOff:!1,maxAttempts:20},r);let c=0;const u=r=>new Promise((i=>Promise.resolve(t()).then((t=>t?Promise.resolve(e()).then((e=>i((0,s.G)(e)))):(0,n.zG)(c++,(e=>e<o?setTimeout((()=>i(u(r*(a?2:1)))),r):i(s.YP)))))));return u(i)}function _(...e){return t=>e.reduce(((e,t)=>Promise.resolve(e).then(t)),t)}function h(e){const t=l({equals:(t,r)=>t[0]===r[0]&&e.equals(t[1],r[1])});return(0,i.Uz)((e=>new Set(Object.entries(e))))(t)}function v(e,t){const r=Object.create(null);for(const n of t)r[n]=e[n];return r}function b(e){if("string"==typeof e){const t=+e;if(!isNaN(t))return t}return e}function w(e,t){const r=t=>{if(!n&&t)return n=!0,e()};let n=!1;["blur","visibilitychange"].forEach((e=>{window.addEventListener(e,(()=>r(document.hidden&&function(e){return/Mobi|Android/i.test(e)}(t))))})),["beforeunload","pagehide"].forEach((e=>{window.addEventListener(e,(()=>r(!0)))}))}function y(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^(window.crypto||window.msCrypto).getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))}function q(e){return 36===e.length&&/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i.test(e)}function k(e,t){const r=Object.keys(e),n=r.length,i={};for(let a=0;a<n;a++){const n=r[a],o=t(n,e[n]);(0,s.pC)(o)&&(i[n]=o.value)}return i}function S(...e){const t={},r=e.length;for(let n=0;n<r;n++){const[r,s]=e[n];t[r]=s}return t}function x(e,t){return k(e,((e,r)=>t(e)?(0,s.G)(r):s.YP))}function O(e){return/^((?!chrome|android).)*safari/i.test(e)}function E(e){}function I(e){return new Promise((t=>{setTimeout((()=>{Promise.resolve(e()).then(t)}),0)}))}function P(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}},745:(e,t,r)=>{r.d(t,{H:()=>i});var n=r(276),s=r(735);const i=e=>(0,s.zG)((0,n.xH)(e),(0,n.u4)({},((e,t)=>Object.assign(Object.assign({},e),{[t.name]:t.import}))))}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{__webpack_require__.d(__webpack_exports__,{H:()=>an});var e=__webpack_require__(70),t=__webpack_require__(735);function r(e){return function(t,r){return function(n){return e.chain(n,(function(n){return e.map(r(n),(function(e){var r;return Object.assign({},n,((r={})[t]=e,r))}))}))}}}function n(e,t,r){return function(s){for(var i=Array(r.length+1),a=0;a<r.length;a++)i[a]=r[a];return i[r.length]=s,0===t?e.apply(null,i):n(e,t-1,i)}}var s={1:function(e){return[e]},2:function(e){return function(t){return[e,t]}},3:function(e){return function(t){return function(r){return[e,t,r]}}},4:function(e){return function(t){return function(r){return function(n){return[e,t,r,n]}}}},5:function(e){return function(t){return function(r){return function(n){return function(s){return[e,t,r,n,s]}}}}}};function i(e){return s.hasOwnProperty(e)||(s[e]=n(t.bc,e-1,[])),s[e]}var a=__webpack_require__(341);function o(r){return(0,t.ls)(e.F2,r.of)}function c(r){return(0,t.ls)(e.t$,r.of)}function u(t){return(0,a.UI)(t,e.dO)}function l(t){return function(e,t){return function(r){return function(n){return e.ap(e.map(n,(function(e){return function(r){return t.ap(e,r)}})),r)}}}(t,e.G5)}function d(t){return function(r){return function(n){return t.chain(n,(function(n){return e.nM(n)?t.of(n):r(n.right)}))}}}function p(t){return function(r){return function(n){return t.chain(n,e.EQ(r,t.of))}}}function f(r){return function(n){return(0,t.ls)(e.Yo(n),r.fromEither)}}var m=function(e,r){return(0,t.zG)(e,h(r))},g=function(e,r){return(0,t.zG)(e,v(r))},_=function(e,r){return(0,t.zG)(e,w(r))},h=function(e){return function(t){return function(){return t().then(e)}}},v=function(e){return function(t){return function(){return Promise.all([t(),e()]).then((function(e){return(0,e[0])(e[1])}))}}},b=function(e){return function(){return Promise.resolve(e)}},w=function(e){return function(t){return function(){return t().then((function(t){return e(t)()}))}}},y=(t.yR,"Task");var q={URI:y,map:m},k=((0,a.OV)(q),{URI:y,of:b}),S={URI:y,map:m,ap:g},x={URI:y,map:m,of:b,ap:g,chain:_},O=c(k),E=o(k),I=b,P=p(x),C=function(t,r){return function(){return t().then(e.F2,(function(t){return e.t$(r(t))}))}},j=function(e,r){return(0,t.zG)(e,M(r))},A=function(e,r){return(0,t.zG)(e,N(r))},T=function(e,r){return(0,t.zG)(e,D(r))},M=u(q),N=l(S),D=d(x),z=E,G="TaskEither";var L={URI:G,map:j},R=((0,a.OV)(L),{URI:G,map:j,ap:A,chain:T}),$={URI:G,fromEither:I},U=f($);var K=z({}),B=r(R);var F=__webpack_require__(567),J=__webpack_require__(276),W=__webpack_require__(71),Y=__webpack_require__(90);const H=(e,t)=>!!e.id&&!(0,J.t9)(W.Eq)(e.tag,t);let V=()=>({spanId:null,finish:()=>({})});window.performance&&window.performance.mark&&(V=e=>{const t="_"+Math.random().toString(36).substr(2,9),r=`permutive_${e}`,n=`${r}${t}_start`;return window.performance.mark(n),{spanId:n,finish:()=>{window.performance.measure(r,n)}}});class Q{constructor(e,t,r){this._internals=e,this.permutive=t,this.network=r,this.identities={},this.providers={},this.identities=this.getCachedIdentitiesAndMigrateIfRequired()}prepareThirdPartyIdentities(){const e=this._internals.metrics.startTimer("sdk_get_third_party_identities_task_duration_seconds",{}),r=V("load_tpd_ids"),n=[Promise.resolve().then(__webpack_require__.bind(__webpack_require__,739)),Promise.resolve().then(__webpack_require__.bind(__webpack_require__,998))];return Promise.all(n).then((e=>Promise.all(e.map((e=>e.make(this._internals,this.network,this.permutive)))))).then((e=>(0,t.zG)((0,J.oA)(e),(e=>Promise.all(e.map((e=>this.shouldAskForNewIdentity(e)?this.retrieveIdentity(e):Promise.resolve((0,t.bc)(e,this.getCachedTPDIdentity(e.tag)))))))))).then((e=>e.map((([e,t])=>(this.providers[e.tag]=e,this.setTPDIdentityIfPresent(e.tag,t,e.ttlInSeconds)))))).then((()=>{this._internals.metrics.stopTimer("sdk_get_third_party_identities_task_duration_seconds",e),r.finish()}))}getPrioritizedIdentities(e){const t={default:0,pxid:1,appnexus:1},r=Object.entries(e).map((([e,{id:t,expiry:r,priority:n}])=>Object.assign(Object.assign(Object.assign({tag:e},t?{id:t}:{}),r?{expiry:r}:{}),void 0!==n?{priority:n}:{}))),n=r.filter((e=>H(e,Object.values(this.providers).map((e=>e.tag))))),s=r.filter((e=>((e,t)=>!!e.id&&!!(0,J.t9)(W.Eq)(e.tag,t))(e,Object.values(this.providers).map((e=>e.tag))))),i=(0,J.DZ)((e=>(0,F.ij)(e.priority)))(n),a=i.length>0?Math.max(...i):0,o=n.map((e=>void 0!==e.priority?Object.assign(Object.assign({},e),{priority:e.priority}):Object.assign(Object.assign({},e),{priority:a+1}))),c=s.map((e=>void 0===t[e.tag]?{tag:e.tag,id:e.id,priority:a+X}:{tag:e.tag,id:e.id,priority:a+ee}));return o.concat(c)}getIdentitiesMap(){return this.getFilteredIdentities(((e,t)=>!!t.value))}getCustomerDefinedIdentitiesMap(){return this.getFilteredIdentities(((e,t)=>H({tag:e,id:t.value,expiry:t.expiry,priority:t.priority},Object.values(this.providers).map((e=>e.tag)))))}getTPDIdentitiesMap(){return this.getFilteredIdentities(((e,t)=>{var r,n;return!!t.value&&!!(null===(n=null===(r=this.providers)||void 0===r?void 0:r[e])||void 0===n?void 0:n.usedForThirdPartyData)}))}parseCustomerDefinedIdentities(e){const t=`Identify must be passed a non-empty string or list of { tag, id, priority? } tuples, value passed was '${JSON.stringify(e)}'`,r=()=>{throw new Error(t)};return"string"==typeof e?(s=e).length>0?[{id:s,tag:"default"}]:r():Array.isArray(e)?(n=e).every((e=>"string"==typeof e.id&&"string"==typeof e.tag))?n:r():r();var n,s}setIdentities(e){e.forEach((({tag:e,id:t,expiry:r,priority:n})=>{this.identities[e]=Object.assign(Object.assign(Object.assign({},t?{value:t}:{}),r?{expiry:r}:{}),void 0!==n?{priority:n}:{})})),this._internals.state.setPermutiveData("identities",this.identities)}reset(){return(0,t.zG)(this.identities={},(e=>Promise.all(Object.values(this.providers).map((e=>e.reset()))).then(t.Q1)))}getFilteredIdentities(e){return(0,Y.m8)(...Object.entries(this.identities).filter((([t,r])=>e(t,r))).map((([e,{value:r,expiry:n,priority:s}])=>(0,t.bc)(e,Object.assign(Object.assign({id:r},n?{expiry:n}:{}),void 0!==s?{priority:s}:{})))))}shouldAskForNewIdentity(e){var t;const r=(0,F.ij)(null===(t=this.identities)||void 0===t?void 0:t[e.tag]);return(0,F.g_)((()=>!0),this.isIdentityExpired)(r)}getCachedTPDIdentity(e){return this.identities[e]?(0,F.ij)(this.identities[e].value):F.YP}setTPDIdentityIfPresent(e,t,r=86400){const n=()=>Date.now()+Math.floor(1e3*r);return(0,F.g_)((()=>this.setIdentities([{tag:e,expiry:n()}])),(t=>this.setIdentities([{tag:e,id:t,expiry:n()}])))(t)}retrieveIdentity(e){return e.getId().then((r=>"skipped"===r.type?(0,t.bc)(e,F.YP):(0,t.zG)(r.result,(t=>this._internals.metrics.track({name:(0,F.pC)(t)?"sdk_third_party_identity_present_count":"sdk_third_party_identity_missing_count",value:1,labels:{identity_tag:e.tag}})),(n=>(0,t.bc)(e,r.result)))))}isIdentityExpired(e){return e.expiry&&Date.now()>=e.expiry}getCachedIdentitiesAndMigrateIfRequired(){const e=this.getLegacyAliases(),r=()=>this._internals.state.getPermutiveData("identities")||{},n=e=>(0,Y.m8)(...Object.entries(e).filter((([e,t])=>!this.isIdentityExpired(t))));return Object.keys(e).length>0?(e=>{const s=r(),i=Object.entries(e).reduce(((e,[t,r])=>Object.assign(Object.assign({},e),{[t]:{value:r}})),{}),a=n(Object.assign(Object.assign({},i),s));return(0,t.zG)(this._internals.state.setPermutiveData("identities",a),(e=>a))})(e):n(r())}getLegacyAliases(){return(e=>["e1c3fd73-dd41-4abd-b80b-4278d52bf7aa","be668577-07f5-444d-98e0-222b990951b1"].includes("16d3bd5c-bf92-4bf0-815a-eac397d3aadf")?(0,Y.m8)(...Object.entries(e).filter((([e])=>"sporeid"!==e.toLowerCase()))):e)(this._internals.state.getPermutiveData("aliases")||{})}}const Z=(e,t,r,n)=>{const s=(e,t)=>{const r=["(null)"];return r.indexOf(e)>-1||!!te[e]||(0,J.jV)(W.Eq)(t,r).length>0},i=e=>"721d6d85-35f0-4e35-bb38-13eb0d465158"===e,a={"be668577-07f5-444d-98e0-222b990951b1":s,"e43c8a90-d17b-4790-bfda-81b069b3b8c2":(e,t,r)=>["thestudentroom.co.uk"].some((e=>r.indexOf(e)>-1))&&(0,J.jV)(W.Eq)(t,["tsr-"]).length>0,"5d79bce7-5d2b-427e-a6c4-b89b6c7bf048":s,"366ab8da-5efa-4355-ab00-84db3b68ded2":e=>"96539955-4d7e-40df-882b-7e2fbacedb1c"===e||"345600e7-fb5f-48b1-9aa6-cde5396419b0"===e,"f3a06674-ebb9-4b9d-ba8f-0052018c0687":i,"38dadd0d-257a-4641-b332-b8b0fd20a6cb":i,"10453011-272d-49cd-9043-1964fdb36fd8":e=>"936ba6ac-9a8b-454d-ba98-facebd7553fe"===e}[e];return!!a&&a(n,t,r)},X=2,ee=3,te={};class re{constructor(e,t){this._internals=e,this.hasChanged=!1,(t=t||{}).timeout_seconds=t.timeout_seconds||1800,t.session_data_key=t.session_data_key||"permutive-session",this.options=t,this.session_id=null,this.initialize()}getSessionId(){return this.session_id}sessionHasChanged(){return this.hasChanged}newSession(e){return this.hasChanged=!0,{session_id:(0,Y.k$)(),last_updated:e}}initialize(){const e=new Date,t=this._internals.getCookie(this.options.session_data_key);let r=this.decodeSessionData(t);if(null===r)r=this.newSession(e);else{const t=this.options.timeout_seconds;e>new Date(r.last_updated.getTime()+1e3*t)?r=this.newSession(e):r.last_updated=e}this.persistSessionData(r),this.session_id=r.session_id}decodeSessionData(e){let t=null;try{t=JSON.parse(e)}catch(e){return null}return null!==t&&"object"==typeof t&&t.hasOwnProperty("session_id")&&t.hasOwnProperty("last_updated")&&(t.last_updated=new Date(t.last_updated),!isNaN(t.last_updated.getTime()))?t:null}persistSessionData(e){e.last_updated=e.last_updated.toISOString(),this._internals.setCookie(this.options.session_data_key,JSON.stringify(e))}}const ne={success:e=>{},error:(e,t)=>{}};class se{constructor(e){this._internals=e}graphql(e,t=ne){return this.reqWithMetrics("sdk_http_graphql_seconds")({url:`${this._internals.config.apiProtocol}://${this._internals.config.apiHost}/graphql`,method:"POST",success:t.success,error:t.error,data:{query:e},contentType:"text/plain",xhrFields:{withCredentials:!0}},!1)}identify(e,t=ne){return this.reqWithMetrics("sdk_http_identify_seconds")({url:this._internals.network.getEndpointUrl("/identify"),method:"POST",data:{user_id:this._internals.state.userId,aliases:e},success:t.success,error:t.error,contentType:"text/plain",xhrFields:{withCredentials:!0}},!1)}metrics(e,t=ne){return this._internals.network.req({url:this._internals.network.getEndpointUrl("/internal/metrics"),method:"POST",data:e,contentType:"text/plain",dataType:"text",success:t.success,error:t.error},!1)}track(e,t,r){return this.reqWithMetrics("sdk_http_events_seconds")({url:[`${this._internals.network.getEndpointUrl((Array.isArray(e)?"/batch":"")+"/events")}`,`?enrich=${!!t.includeResponseBody}`,`&sdkp=${!r}`].join(""),method:"POST",data:e,success:t.success,error:t.error,contentType:"text/plain"},r)}tpdUsage(e,t=ne){return this.reqWithMetrics("sdk_http_tpd_usage_seconds")({url:this._internals.network.getEndpointUrl("/tpd/usage"),method:"POST",data:e,success:t.success,error:t.error,contentType:"text/plain"},!1)}reset(){return this.reqWithMetrics("sdk_http_reset_seconds")({url:this._internals.network.getEndpointUrl("/reset"),method:"POST",xhrFields:{withCredentials:!0},contentType:"text/plain"},!1)}segmentSync(e,t){return this._internals.network.ajax({url:`https://${this._internals.config.segmentSyncApiHost}/sync/${e}`,type:"POST",data:`value=${encodeURIComponent(t)}`,contentType:"application/x-www-form-urlencoded",xhrFields:{withCredentials:!0}})}models(e){const t=`https://${this._internals.config.cdnBaseUrl}`,r="binary"===e?`${t}/models/v2/16d3bd5c-bf92-4bf0-815a-eac397d3aadf-models.bin`:`${t}/models/16d3bd5c-bf92-4bf0-815a-eac397d3aadf-models.json`;return this.ajaxWithMetrics("sdk_http_models_seconds")({url:r,dataType:e})}state(e,t,r,n=!1){return this.reqWithMetrics("sdk_http_state_seconds")({url:`${this._internals.network.getEndpointUrl(""+(n?"/state/legacy":"/state"),"v1.0")}?fetch_unseen=${r}`,method:"POST",data:{group_id:this._internals.state.userId,event_source_id:this._internals.state.eventSourceId,state:JSON.stringify(e),last_seen_offset:t},contentType:"text/plain"},!1)}inferDemographicSegmentsV1(e,t=ne){return this._internals.network.req({url:`${this._internals.network.getEndpointUrl("/demographic/infer")}`,method:"POST",contentType:"text/plain",data:e,success:t.success,error:t.error},!1)}inferDemographicSegmentsV2(e,t=ne){return this._internals.network.req({url:`${this._internals.network.getEndpointUrl("/demographic/infer/v2.0")}`,method:"POST",contentType:"text/plain",data:e,success:t.success,error:t.error},!1)}reqWithMetrics(e){const t=this._internals.metrics.startTimer(e,{});return(r,n)=>this._internals.network.req(r,n).then((r=>(this._internals.metrics.stopTimer(e,t),r)))}ajaxWithMetrics(e){const t=this._internals.metrics.startTimer(e,{});return r=>this._internals.network.ajax(r).then((r=>(this._internals.metrics.stopTimer(e,t),r)))}}var ie=__webpack_require__(372);class ae{constructor(e){this._internals=e,this.queries={},this.promises={}}register(e){const t=(0,Y.b2)();return this.queries[e.resource]=e.query(),this.promises[e.resource]=t,t.promise}run(){if(0===Object.keys(this.queries).length)return Promise.resolve();const t=V("graphql_req"),r=(0,Y.b2)();return this._internals.api.graphql(this.toQueryString(this.queries),{success:e=>{Object.keys(this.promises).forEach((t=>{const r=e.data[t];r?this.promises[t].resolve(r):this.promises[t].reject(`Could not find a graphql response for resource ${t}`)})),t.finish(),r.resolve()},error:e=>{console.error(e),Object.keys(this.promises).forEach((e=>this.promises[e].reject())),r.reject(e)}}),r.promise.then((()=>{this._internals.messages.emit("permutive:graphql:ready",(0,e.F2)(void 0))})).catch((t=>{this._internals.messages.emit("permutive:graphql:ready",(0,e.t$)(t))})).finally((()=>{this.queries={},this.promises={}}))}toQueryString(e){return`{ ${Object.keys(e).map((t=>e[t])).join(" ")} }`}}class oe{constructor(){this.events=[],this.listeners=[]}newEvent(e,t){this.events.push([e,t]),this.listeners.forEach((r=>{this.handle(e,t,r)}))}addListener(e){this.listeners.push(e);const t={replay:()=>(this.replay(e),t),remove:()=>(this.remove(e),t)};return t}handle(e,t,r){const n="string"==typeof r.name&&e.name===r.name,s=r.name.test&&r.name.test(e.name),i=n||s;if(i)try{r.callback(e,t)}catch(e){window.console&&window.console.error&&window.console.error("callback error: ",e)}i&&r.once&&this.remove(r)}replay(e){let t=-1!==this.listeners.indexOf(e);for(let r=0;r<this.events.length&&t;r++)this.handle(this.events[r][0],this.events[r][1],e),t=-1!==this.listeners.indexOf(e)}remove(e){const t=this.listeners.indexOf(e);-1!==t&&this.listeners.splice(t,1)}}function ce(e){var t={},r=[];(e=e||this).on=function(r,n,s){return(t[r]=t[r]||[]).push([n,s]),e},e.off=function(n,s){n||(t={});for(var i=t[n]||r,a=i.length=s?i.length:0;a--;)s==i[a][0]&&i.splice(a,1);return e},e.once=function(t,n){var s=r.slice.call(arguments,2),i=function(){n(s),e.off(t,i)};return e.on(t,i),e},e.emit=function(n){for(var s,i=t[n]||r,a=i.length>0?i.slice(0,i.length):i,o=0;s=a[o++];)s[0].apply(s[1],r.slice.call(arguments,1));return e}}class ue{constructor(){this.properties={}}overrideCustomProps(e){this.properties=e}getCustomProps(){return this.properties}}class le{constructor(e,t,r,n,s=[],i={},a=new oe,o=new ce,c=new ie.J,u=new ue){this.namespace=e,this.logger=t,this.config=r,this.network=n,this.blockers=s,this.addons=i,this.eventHandler=a,this.messages=o,this.enrichers=c,this.customProperties=u,this.isReady=!1,this.isRealtime=!1,this.listenForBlockers=!0,this.sessionManager=new re(this),this.api=new se(this),this.graphql=new ae(this),Promise.resolve().then(__webpack_require__.bind(__webpack_require__,411)).then((e=>this.models=new e.PermutiveModels(this.logger,this)))}makeSafe(e){return(...t)=>{try{return e(...t)}catch(e){this.network.error(e,this.state.userId)}}}utcNow(){const e=new Date;return new Date(e.toUTCString())}setAsReady(){this.isReady=!0,this.messages.emit("permutive:ready"),this.metrics.trackTimeSinceInit("sdk_initialisation_task_duration_seconds",{sdk_version:"v14.20.4"}),window.performance&&window.performance.memory&&(this.metrics.track({name:"sdk_heap_memory_bytes_used",value:window.performance.memory.usedJSHeapSize,labels:{}}),this.metrics.track({name:"sdk_heap_memory_limit_fraction_used",value:window.performance.memory.usedJSHeapSize/window.performance.memory.jsHeapSizeLimit,labels:{}}))}setAsRealtime(){this.isRealtime=!0,this.messages.emit("permutive:realtime"),this.metrics.trackTimeSinceInit("sdk_realtime_targeting_set_task_duration_seconds",{}),this.metrics.track({name:"sdk_user_segments_count",value:this.queryManager.userSegments.getAllAsList().length,labels:{}})}addBlocker(e){this.blockers.push(e),this.logger.log("<blockers> added blocker "+e),this.messages.on(e,(()=>{if(this.listenForBlockers){const t=this.blockers.indexOf(e);t>=0&&(this.blockers.splice(t,1),this.logger.log("<blockers> removed blocker "+e)),0===this.blockers.length&&(this.listenForBlockers=!1,this.messages.emit("permutive:blockers:empty"),this.logger.log("<blockers> complete"))}}))}setCookie(e,t,r=!1){if(!(t&&e&&this.config.cookieExpiry&&this.config.cookieDomain))return!1;const n=this.namespace.getNamespacedStorageKey(e);document.cookie=[encodeURIComponent(n),"=",encodeURIComponent(t),"; expires=",this.config.cookieExpiry,"; domain=",this.config.cookieDomain,"; path=/",r?"; samesite=none; secure":""].join("")}getCookie(e,t=!1){const r=t?e:this.namespace.getNamespacedStorageKey(e),n=new RegExp("\\b"+encodeURIComponent(r)+"=([^;]+)").exec(document.cookie);return null!==n?decodeURIComponent(n[1]):null}deleteCookie(e){if(!e||!this.config.cookieDomain)return!1;const t=this.namespace.getNamespacedStorageKey(e);return document.cookie=encodeURIComponent(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; domain="+this.config.cookieDomain+"; path=/",!0}getExternalData(e){const t=this.namespace.getNamespacedStorageKey(e);return localStorage.getItem(t)}setExternalData(e,t){const r=this.namespace.getNamespacedStorageKey(e);this.makeSafe((()=>{localStorage.setItem(r,t)}))()}removeExternalData(e){const t=this.namespace.getNamespacedStorageKey(e);localStorage.removeItem(t)}}class de{constructor(){this.prefix="[Permutive]"}log(...e){return console.log.bind(window.console,this.prefix)(...e)}}class pe{log(){}}var fe=__webpack_require__(477),me=__webpack_require__.n(fe);function ge(){return me()('/*! permutive-javascript-sdk v14.20.4 (web) (built 2021-08-02T06:09:15.050Z) */(()=>{"use strict";function t(t){return t}function e(t){return function(){return t}}var n=e(void 0);function s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t}function r(t,e,n,s,r,a,i,o,c,p,l,u,d,f,_,m,q,g,w,b){switch(arguments.length){case 1:return t;case 2:return e(t);case 3:return n(e(t));case 4:return s(n(e(t)));case 5:return r(s(n(e(t))));case 6:return a(r(s(n(e(t)))));case 7:return i(a(r(s(n(e(t))))));case 8:return o(i(a(r(s(n(e(t)))))));case 9:return c(o(i(a(r(s(n(e(t))))))));case 10:return p(c(o(i(a(r(s(n(e(t)))))))));case 11:return l(p(c(o(i(a(r(s(n(e(t))))))))));case 12:return u(l(p(c(o(i(a(r(s(n(e(t)))))))))));case 13:return d(u(l(p(c(o(i(a(r(s(n(e(t))))))))))));case 14:return f(d(u(l(p(c(o(i(a(r(s(n(e(t)))))))))))));case 15:return _(f(d(u(l(p(c(o(i(a(r(s(n(e(t))))))))))))));case 16:return m(_(f(d(u(l(p(c(o(i(a(r(s(n(e(t)))))))))))))));case 17:return q(m(_(f(d(u(l(p(c(o(i(a(r(s(n(e(t))))))))))))))));case 18:return g(q(m(_(f(d(u(l(p(c(o(i(a(r(s(n(e(t)))))))))))))))));case 19:return w(g(q(m(_(f(d(u(l(p(c(o(i(a(r(s(n(e(t))))))))))))))))));case 20:return b(w(g(q(m(_(f(d(u(l(p(c(o(i(a(r(s(n(e(t)))))))))))))))))))}}function a(t){return function(e){return function(n){return t.map(n,(function(t){return t(e)}))}}}var i=function(t,e){for(var n=0,s=e.length,r=t.length;n<s;n++,r++)t[r]=e[n];return t},o=(Object.prototype.hasOwnProperty,function(t){return i([t[0]],t.slice(1))}),c=function(t){return"Left"===t._tag},p=function(t){return{_tag:"Left",left:t}},l=function(t){return{_tag:"Right",right:t}},u=function(t){return function(e){return c(e)?t(e.left):e.right}};var d=function(t,e){return r(t,_(e))},f=function(t,e){return r(t,m(e))},_=function(t){return function(e){return c(e)?e:l(t(e.right))}},m=function(t){return function(e){return c(e)?e:c(t)?t:l(e.right(t.right))}},q=l,g="Either";var w={URI:g,map:d},b=(a(w),{URI:g,map:d,ap:f,of:q});const y=()=>({kind:"null",value:null}),v=t=>({kind:"string",value:t}),h=t=>({kind:"number",value:t}),k=t=>({kind:"array",value:t}),x=t=>({kind:"object",value:t}),S=t=>t,O=()=>({kind:"bottom"}),j=t=>({kind:"inner",a:t}),A=t=>({kind:"top",error:t}),z=t=>({kind:"unbounded",group:t}),E=(t,e)=>({kind:"windowed",key:e,group:t}),C=(t,e,n)=>({kind:"countLimit",n,limit:e,group:t}),M=(t,e,n)=>({kind:"uniqueLimit",n,limit:e,group:t}),N=t=>({kind:"numberGroup",group:t}),I=t=>({kind:"stringGroup",group:t}),T=t=>({kind:"tuple",tuple:t}),L=t=>({state:t}),P=(t,e)=>({commands:t,payload:e});var G=function(t,e){return{left:t,right:e}},U=function(t){return function(e){return G(F(e),t(D(e)))}},B="Separated",F=(a({URI:B,map:function(t,e){return r(t,U(e))}}),function(t){return t.left}),D=function(t){return t.right},R=function(t){return"Some"===t._tag},V=function(t){return"None"===t._tag},J={_tag:"None"},H=function(t){return{_tag:"Some",value:t}};function $(t){return function(e){return t(e)?H(e):J}}function W(t){return"Left"===t._tag?J:H(t.right)}var Y=W,K=function(t){return function(e){return V(e)?t():e.value}},Z=function(t){return function(e){return V(e)?J:H(t(e.value))}};function Q(t){return{equals:function(e,n){return e===n||(V(e)?V(n):!V(n)&&t.equals(e.value,n.value))}}}function X(t){return{equals:Q(t).equals,compare:function(e,n){return e===n?0:R(e)?R(n)?t.compare(e.value,n.value):1:-1}}}function tt(t){return{equals:function(e,n){return e===n||t(e,n)}}}var et=function(t){return tt((function(e,n){for(var s in t)if(!t[s].equals(e[s],n[s]))return!1;return!0}))},nt={equals:function(t,e){return t===e}},st=nt,rt=nt,at=function(t){return function(e,n){return e===n||0===t(e,n)}},it=function(t){return{equals:at(t),compare:function(e,n){return e===n?0:t(e,n)}}},ot=function(t){return function(e){return it((function(n,s){return e.compare(t(n),t(s))}))}},ct=function(t){return function(e,n){return-1===t.compare(e,n)}},pt=function(t){return function(e,n){return 1===t.compare(e,n)}},lt=function(t){return function(e,n){return e===n||t.compare(e,n)>-1?e:n}};var ut,dt={equals:nt.equals,compare:function(t,e){return t<e?-1:t>e?1:0}},ft=dt,_t=dt;ut=void 0;var mt=function(t,e){return r(t,qt(e))},qt=function(t){return gt((function(e,n){return t(n)}))},gt=function(t){return function(e){for(var n=[t(0,vt(e))],s=1;s<e.length;s++)n.push(t(s,e[s]));return n}},wt=function(t){return t[0]},bt="ReadonlyNonEmptyArray",yt={URI:bt,map:mt},vt=(a(yt),wt);var ht=function(t,e){for(var n=0,s=e.length,r=t.length;n<s;n++,r++)t[r]=e[n];return t},kt=function(t){return t.length>0},xt=function(t,e){return t<0||t>=e.length},St=function(t){return function(e){return ht([t],e)}},Ot=function(t){return function(e){return Et(e,[t])}},jt=function(t){var e=function(t){return function(e){if(1===e.length)return Ct(e);for(var n=[Ut(e)],s=function(e){n.every((function(n){return!t.equals(n,e)}))&&n.push(e)},r=0,a=Bt(e);r<a.length;r++)s(a[r]);return n}}(t);return function(t,n){return e(Et(t,n))}},At=o,zt=function(t){return kt(t)?H(t):J};function Et(t,e){return t.concat(e)}var Ct=At;var Mt=function(t){return function(e){var n=Math.max(1,t);return n>=e.length?[Ct(e),[]]:[r(e.slice(1,n),St(Ut(e))),e.slice(n)]}},Nt=function(t,e){return r(t,It(e))},It=function(t){return Tt((function(e,n){return t(n)}))},Tt=function(t){return function(e){for(var n=[t(0,Ut(e))],s=1;s<e.length;s++)n.push(t(s,e[s]));return n}},Lt="NonEmptyArray",Pt=function(t){return tt((function(e,n){return e.length===n.length&&e.every((function(e,s){return t.equals(e,n[s])}))}))},Gt={URI:Lt,map:Nt},Ut=(a(Gt),vt),Bt=function(t){return t.slice(1)};var Ft=rt,Dt=_t,Rt=function(t){return 0===t.length};function Vt(t){return function(e,n){if(void 0===n){var s=Vt(t);return function(t){return s(e,t)}}for(var r,a=0;a<n.length;a++)if(r=n[a],t.equals(r,e))return!0;return!1}}var Jt=function(t,e){return r(t,Ht(e))},Ht=function(t){return function(e){return e.map((function(e){return t(e)}))}},$t=function(t,e){return function(n){for(var s=n.length,r=t,a=0;a<s;a++)r=e(a,r,n[a]);return r}},Wt="ReadonlyArray",Yt={URI:Wt,map:Jt},Kt=(a(Yt),St),Zt=Ot,Qt=function(t,e){return t<=0?[]:function(t,e){for(var n=Math.max(0,Math.floor(t)),s=[e(0)],r=1;r<n;r++)s.push(e(r));return s}(t,e)},Xt=Rt,te=kt,ee=xt,ne=function(t){return function(e){return ee(t,e)?ae(e):e.slice(0,t)}};var se=function(t,e){for(var n=t.length,s=0;s<n&&e(t[s]);s++);return s};var re=function(t){return function(e){return t<=0||Xt(e)?ae(e):t>=e.length?[]:e.slice(t,e.length)}};var ae=function(t){return t.slice()},ie=function(t){return Xt(t)?[]:t.slice().reverse()},oe=function(t){return function(e){return e.length<=1?ae(e):e.slice().sort(t.compare)}},ce=function(t,e,n){for(var s=[],r=Math.min(t.length,e.length),a=0;a<r;a++)s[a]=n(t[a],e[a]);return s};var pe=Vt,le=function(t){return function(e){return t>=1&&te(e)?Mt(t)(e):Xt(e)?[ae(e),[]]:[[],ae(e)]}};function ue(t){var e=jt(t);return function(n,s){if(void 0===s){var r=ue(t);return function(t){return r(t,n)}}return te(n)&&te(s)?e(n,s):te(n)?ae(n):ae(s)}}function de(t){var e=pe(t);return function(n,s){if(void 0===s){var r=de(t);return function(t){return r(t,n)}}return n.filter((function(t){return!e(t,s)}))}}var fe=function(t,e){return r(t,_e(e))},_e=function(t){return function(e){return e.map((function(e){return t(e)}))}},me=function(t){return function(e){return r(e,function(t){return function(e){for(var n=[],s=0;s<e.length;s++)n.push.apply(n,t(s,e[s]));return n}}((function(e,n){return t(n)})))}},qe=function(t){return function(e){for(var n=[],s=0;s<e.length;s++){var r=t(s,e[s]);R(r)&&n.push(r.value)}return n}},ge=function(t){return qe((function(e,n){return t(n)}))},we=ge(t),be=$t,ye=function(t){var e=ve(t);return function(t){return e((function(e,n){return t(n)}))}},ve=function(t){return function(e){return be(t.of([]),(function(n,s,a){return t.ap(t.map(s,(function(t){return function(e){return r(t,Zt(e))}})),e(n,a))}))}},he="Array",ke=function(t){return it((function(e,n){for(var s=e.length,r=n.length,a=Math.min(s,r),i=0;i<a;i++){var o=t.compare(e[i],n[i]);if(0!==o)return o}return Dt.compare(s,r)}))},xe={URI:he,map:fe};a(xe);function Se(t){switch(t.kind){case"null":return Ae.encode(t);case"string":return ze.encode(t);case"number":return Ee.encode(t);case"array":return Ce.encode(t);case"object":return Me.encode(t)}}function Oe(t){return null===t?Ae.decode(t):"number"==typeof t?Ee.decode(t):"string"==typeof t?ze.decode(t):Array.isArray(t)?Ce.decode(t):Me.decode(t)}const je=(t,e)=>p(`Failed to decode. Input was ${JSON.stringify(t)}. Codec type was ${e}`),Ae={encode:t=>null,decode:t=>null===t?l({kind:"null",value:null}):je(t,"SimpleNull")},ze={encode:t=>t.value,decode:t=>"string"==typeof t?l(v(t)):je(t,"SimpleString")},Ee={encode:t=>t.value,decode:t=>"number"==typeof t?l(h(t)):je(t,"SimpleNumber")},Ce={encode:t=>t.value.map(Se),decode:t=>{if(Array.isArray(t)){const e=ye(b)(Oe)(t);return _(k)(e)}return je(t,"SimpleArray")}},Me={encode:t=>{const e=[...t.value.entries()];return Object.assign({},...Array.from(e,(([t,e])=>({[t]:Se(e)}))))},decode:t=>{if(t&&t.constructor===Object){const e=ye(b)((([t,e])=>r(Oe(e),_((e=>s(t,e))))))(Object.entries(t));return _((t=>x(new Map([...t]))))(e)}return je(t,"SimpleObject")}};var Ne=st,Ie=ft;const Te=(t,e)=>{switch(t.kind){case"bottom":return{kind:"bottom"};case"inner":return j(e(t.a));case"top":return A(t.error)}},Le=t=>it(((e,n)=>{if("bottom"===e.kind&&"bottom"===n.kind)return 0;if("bottom"===e.kind)return-1;if("bottom"===n.kind)return 1;if("top"===e.kind&&"top"===n.kind)return Ie.compare(e.error,n.error);if("top"===e.kind)return 1;if("top"===n.kind)return-1;if("inner"===e.kind&&"inner"===n.kind)return t.compare(e.a,n.a);throw new Error("Non exhaustive match in extendedAlgebraOrd")}));var Pe=function(t){return-1===t?1:1===t?-1:0};function Ge(t,e){return we(t.map(e))}function Ue(t,e,n,s){const r=(t,e)=>{if(0===t.length)return we(e.map((t=>H({1:t[1],2:n(J,H(t[2]))}))));if(0===e.length)return we(t.map((t=>H({1:t[1],2:n(H(t[2]),J)}))));if(t.length>0&&e.length>0&&ct(s)(t[0][1],e[0][1])){const[s,...a]=t,i=s[1],o=s[2];return Kt({1:i,2:n(H(o),J)})(r(a,e))}if(t.length>0&&e.length>0&&pt(s)(t[0][1],e[0][1])){const[s,...a]=e,i=s[1],o=s[2];return Kt({1:i,2:n(J,H(o))})(r(t,a))}if(t.length>0&&e.length>0){const[s,...a]=t,[i,...o]=e,c=s[1],p=s[2],l=i[2];return Kt({1:c,2:n(H(p),H(l))})(r(a,o))}throw new Error("Non exhaustive match in mapOption2")},a=ot((t=>t[1]))(s),i=(t=>{const e=Ge(t,(t=>R(t[2])?H({1:t[1],2:t[2].value}):J));return 0===e.length?J:H(e)})(r(oe(a)([...t].map((t=>({1:t[0],2:t[1]})))),oe(a)([...e].map((t=>({1:t[0],2:t[1]}))))));return Z((t=>new Map(t.map((t=>[t[1],t[2]])))))(i)}function Be(t,e,n,s){const r=ot((t=>t[0]))(s),a=oe(r)([...e]).reduceRight(((t,e)=>{if(c(t)){const s=n(e[1],t.left);return R(s)?p(s.value):l(e[0])}return t}),p(t));return Y(a)}function Fe(t,e){return new Map([...t].map(e))}function De(t,e){return new Map([...t].filter(e))}function Re(t){return Z(Ye)(function(t){switch(t.state.kind){case"top":return H(v(t.state.error));case"bottom":return J;case"inner":return function(t){return function(t){switch(t.kind){case"numberGroup":case"stringGroup":return Ve(t.group);case"tuple":return t.tuple.length>0}}(t.payload)?H(k(function(t,e){const n=Z((t=>Kt(t)(e)))(t);return K((()=>e))(n)}(Z((t=>v(function(t){const e=t=>{switch(t){case"add":return"p";case"mul":return"m";case"max":return"v";case"min":return"n"}},n=t=>1===t[2]?e(t[1]):e(t[1])+JSON.stringify(t[2]);return t.map(n).join("")}(t))))(t.commands),function(t){const e=t=>{switch(t.kind){case"bottom":return{kind:"null",value:null};case"top":return v(t.error);case"inner":return h(t.a)}},n=t=>Ge([Je,He,t=>r(t,We,x,H)],(e=>e(t))),s=t=>Ge([Je,$e,t=>r(t,We,(t=>Fe(t,(([t,e])=>[JSON.stringify(t),e]))),x,H)],(e=>e(t)));switch(t.kind){case"tuple":return t.tuple.map(e);case"stringGroup":return n(t.group);case"numberGroup":return s(t.group)}}(t.payload)))):J}(t.state.a)}}(t))}function Ve(t){switch(t.kind){case"unbounded":return t.group.size>0;case"windowed":return t.group.size>0||R(t.key);case"countLimit":case"uniqueLimit":return t.group.size>0||R(t.limit)}}function Je(t){switch(t.kind){case"unbounded":return J;case"windowed":return H(v("w"));case"countLimit":return H(v(1===t.n?"x":`x${t.n}`));case"uniqueLimit":return H(v(1===t.n?"u":`u${t.n}`))}}function He(t){switch(t.kind){case"unbounded":return J;case"windowed":return H(v(R(t.key)?t.key.value:""));case"countLimit":case"uniqueLimit":return H(v(R(t.limit)?t.limit.value:""))}}function $e(t){switch(t.kind){case"unbounded":return J;case"windowed":return R(t.key)?H(h(t.key.value)):H({kind:"null",value:null});case"countLimit":case"uniqueLimit":return R(t.limit)?H(h(t.limit.value)):H({kind:"null",value:null})}}function We(t){switch(t.kind){case"unbounded":case"windowed":case"countLimit":case"uniqueLimit":return t.group}}function Ye(t){switch(t.kind){case"array":return 0===t.value.length?{kind:"null",value:null}:1===t.value.length?Ye(t.value[0]):k(t.value.map(Ye));case"object":return r(De(t.value,(([t,e])=>"null"!==e.kind)),(t=>Fe(t,(t=>[t[0],Ye(t[1])]))),x);default:return t}}function Ke(t){const e=t=>{if(0===t.length)return{kind:"bottom"};const e=(t=>{if(4!==t.length)return J;const[e,n,s,r]=t;if("string"===e.kind&&"string"===n.kind&&"object"===r.kind){const t=$((t=>Ze(t[1].value)&&Qe(t[2].value)))({1:e,2:n});return Z((t=>({prim:t[1].value,grp:t[2].value,cutoff:s,m:r.value})))(t)}return J})(t);if(R(e)){const{prim:t,grp:n,cutoff:s,m:r}=e.value,a=Xe(s,r,tn(n));return"string"==typeof a?A(a):j(P(en(t),a))}const n=(t=>{if(3!==t.length)return J;const[e,n,s]=t;if("string"===e.kind&&"object"===s.kind){const t=$((t=>Qe(t.value)))(e);return Z((t=>({grp:t.value,cutoff:n,m:s.value})))(t)}return J})(t);if(R(n)){const{grp:t,cutoff:e,m:s}=n.value,r=Xe(e,s,tn(t));return"string"==typeof r?A(r):j(P(J,r))}const s=(t=>{if(2!==t.length)return J;const[e,n]=t;if("string"===e.kind&&"object"===n.kind){const t=$((t=>Ze(t.value)))(e);return Z((t=>({prim:t.value,m:n.value})))(t)}return J})(t);if(R(s)){const{prim:t,m:e}=s.value;return j(P(en(t),I(z(e))))}const r=(t=>{if(1!==t.length)return J;const[e]=t;return"object"===e.kind?H({m:e.value}):J})(t);if(R(r)){const{m:t}=r.value;return j(P(J,I(z(t))))}const a=(t=>{if(t.length<1)return J;const[e,...n]=t;if("string"===e.kind){const t=$((t=>Ze(t.value)))(e);return Z((t=>({prim:t.value,rest:n})))(t)}return J})(t);if(R(a)){const{prim:t,rest:e}=a.value;return j(P(en(t),sn(e)))}return j(P(J,sn(t)))},n=t=>{switch(t.kind){case"array":return me(n)(t.value);default:return[t]}};switch(t.kind){case"null":return L({kind:"bottom"});default:return L(e(n(t)))}}function Ze(t){const e=t.split("");switch(!0){case 0===e.length:return!1;default:{const[t,...n]=e;return-1!=="pmvn".indexOf(t)&&n.every((t=>-1!=="pmvn0123456789".indexOf(t)))}}}function Qe(t){const e=t.split("");switch(!0){case 0===e.length:return!1;case"w"===e[0]&&void 0===e[1]:return!0;default:{const[t,...n]=e;return-1!=="ux".indexOf(t)&&-1===n.map((t=>!isNaN(parseInt(t)))).indexOf(!1)}}}function Xe(t,e,n){switch(t.kind){case"string":return I(n({1:H(t.value),2:e}));case"number":case"null":return N(n({1:"null"===t.kind?J:H(t.value),2:De(Fe(e,(([t,e])=>[Number(t),e])),(t=>!isNaN(t[0])))}));default:return"{bad cutoff}"}}function tn(t){const e=t=>e=>M(e[2],e[1],t),n=t=>e=>C(e[2],e[1],t),s=t.split("");switch(!0){case"w"===s[0]&&void 0===s[1]:return t=>E(t[2],t[1]);case"u"===s[0]&&void 0===s[1]:return e(1);case"u"===s[0]&&void 0!==s[1]:return e(parseInt(s.slice(1).join("")));case"x"===s[0]&&void 0===s[1]:return n(1);case"x"===s[0]&&void 0!==s[1]:return n(parseInt(s.slice(1).join("")));default:throw new Error("This should never happen if you use isGroupCommand")}}function en(t){return Z(S)(zt(nn(t,(t=>{const e=t.split("");if(0===e.length)return J;const[n,...s]=e,r=(t=>{switch(t){case"p":return H("add");case"m":return H("mul");case"v":return H("max");case"n":return H("min");default:return J}})(n);return Z((t=>{const{init:e,rest:n}=(r=t=>{return"number"==typeof(e=parseInt(t))&&isFinite(e)&&Math.floor(e)===e;var e},function(t){var e=le(se(t,r))(t);return{init:e[0],rest:e[1]}})(s);var r;return{1:{1:t,2:0===e.length?1:parseInt(e.join(""))},2:n.join("")}}))(r)}))))}function nn(t,e){const n=e(t);return K((()=>[]))(Z((t=>[t[1]].concat(nn(t[2],e))))(n))}function sn(t){return T(t.map(rn))}function rn(t){switch(t.kind){case"number":return j(t.value);case"string":return A(t.value);case"null":return{kind:"bottom"};case"object":return A("{object}");case"array":return A("{array}")}}const an={strategy:(t,e,n)=>s=>{if(V(n))return e;if("delta"===t&&V(e))return J;if(V(e))return n;if(R(e)&&R(n))return s(e.value,n.value);throw new Error("Non exhaustive match in combineCommand.strategy")},operation:(t,e,n,s,r,a)=>{const i=ke(Le(a));if("append"===t&&"add"===e)return ce(n,s,_n("append",r.plus));if("append"===t&&"mul"===e)return ce(n,s,_n("append",r.times));if("append"===t&&"max"===e)return lt(i)(n,s);if("join"===t&&"add"===e)return ce(n,s,_n("join",lt(a)));if("join"===t&&"mul"===e)return ce(n,s,_n("join",lt(a)));if("join"===t&&"max"===e)return lt(i)(n,s);if("min"===e)return an.operation(t,"max",n,s,r,function(t){return it(((e,n)=>Pe(t.compare(e,n))))}(a));if("delta"===t&&"max"===e)return pt(i)(n,s)?n:s.map(O);if("delta"===t)return ce(n,s,((t,e)=>pt(Le(a))(t,e)?t:{kind:"bottom"}));throw new Error("Non exhaustive match in combineCommand.operation")},extend:(t,e,n,s)=>{if("delta"===t&&"top"===n.kind&&"top"===s.kind)return pt(Ie)(n.error,s.error)?A(n.error):{kind:"bottom"};if("delta"===t&&"bottom"===s.kind)return n;if("delta"===t&&"bottom"===n.kind)return{kind:"bottom"};if("top"===n.kind&&"top"===s.kind)return A(lt(Ie)(n.error,s.error));if("top"===n.kind)return n;if("top"===s.kind)return s;if("inner"===n.kind&&"inner"===s.kind)return e(n.a,s.a);if("bottom"===n.kind)return s;if("bottom"===s.kind)return n;throw new Error("Non exhaustive match in extend")}},on={plus:(t,e)=>t+e,times:(t,e)=>t*e};function cn(t,e,n,s){if("unbounded"===t.kind&&"unbounded"===e.kind){const r=t.group,a=e.group;return K(O)(Z((t=>j(z(t))))(Ue(r,a,n,s)))}if("windowed"===t.kind&&"windowed"===e.kind){const r=t.key,a=t.group,i=e.key,o=e.group,c=lt(X(s))(r,i);return K(O)(Z((t=>j(E(t,c))))(Ue(a,o,n,s)))}if("countLimit"===t.kind&&"countLimit"===e.kind){const r=t.n,a=e.n;if(r===a){const a=t.limit,i=t.group,o=e.limit,c=e.group,p=lt(X(s))(a,o);return K(O)(Z((t=>j(C(t,p,r))))(Ue(i,c,n,s)))}return A("Non matching counts")}if("uniqueLimit"===t.kind&&"uniqueLimit"===e.kind){const r=t.n,a=e.n;if(r===a){const a=t.limit,i=t.group,o=e.limit,c=e.group,p=lt(X(s))(a,o);return K(O)(Z((t=>j(M(t,p,r))))(Ue(i,c,n,s)))}return A("Non matching counts")}return A("Non matching group types")}function pn(t,e,n,s,r,a){const i=(t,e)=>({1:ne(t)(e).concat(Qt(Math.max(0,t-e.length),O)),2:re(t)(e)}),o=(e,n,s)=>{if(0===e.length)return an.operation(t,"max",n,s,r,a);if(e.length>0){const[c,...p]=e,l=i(c[2],n),u=l[1],d=l[2],f=i(c[2],s),_=f[1],m=f[2];return an.operation(t,c[1],u,_,r,a).concat(o(p,d,m))}throw new Error("Non exhaustive match in recurse")};return ie((c=t=>"bottom"===t.kind,function(t){return t.slice(se(t,c))})(ie(o(e,n,s))));var c}function ln(t,e,n){return K(y)(un(t,J)(e,n))}function un(t,e){const n=e=>(n,s)=>an.strategy(t,n,s)(un(t,e)),s=(s,r)=>{if(Q(Pt(et({1:Ne,2:Ft}))).equals(s.commands,r.commands)){const a=((e,s,r)=>{if("stringGroup"===s.kind&&"stringGroup"===r.kind){const t=cn(s.group,r.group,n(e),Ie);return Te(t,(t=>I(fn(t,Ie))))}if("numberGroup"===s.kind&&"numberGroup"===r.kind){const t=cn(s.group,r.group,n(e),Dt);return Te(t,(t=>N(fn(t,Dt))))}if("tuple"===s.kind&&"tuple"===r.kind){const n=R(e)?e.value:[];return j(T(pn(t,n,s.tuple,r.tuple,on,Dt)))}throw new Error(`Non matching payload. Got ${s.kind} and ${r.kind}`)})(V(s.commands)?e:s.commands,s.payload,r.payload);return Te(a,(t=>P(s.commands,t)))}throw new Error(`Non matching primitive strings. Got ${JSON.stringify(s)} and ${JSON.stringify(r)}`)};return(e,n)=>Re(L(an.extend(t,s,Ke(e).state,Ke(n).state)))}function dn(t,e,n){const s=Z((e=>De(t,(([t,s])=>function(t){return function(e,n){return-1!==t.compare(e,n)}}(n)(t,e)))))(e);return K((()=>t))(s)}function fn(t,e){switch(t.kind){case"unbounded":return t;case"windowed":return V(t.key)?t:E(dn(t.group,t.key,e),t.key);case"countLimit":{const n=t.limit,s=t.n,r=t.group,a=Be(s,r,((t,e)=>e<=1?J:H(e-1)),e),i=lt(X(e))(n,a);return C(dn(r,i,e),i,s)}case"uniqueLimit":{const n=t.limit,s=t.n,r=t.group,a=(t,e)=>{switch(t.kind){case"object":{const n=[...t.value.keys(),...e.keys()],r=new Set(n);return r.size>=s?J:H(r)}default:return J}},i=Be(new Set,r,a,e),o=lt(X(e))(n,i);return M(dn(r,o,e),o,s)}}}function _n(t,e){return(n,s)=>an.extend(t,((t,n)=>j(e(t,n))),n,s)}function mn(t,e){return ln("append",t,e)}function qn(...t){return t.reduce(((t,e)=>Object.assign(Object.assign({},t),e)),{})}function gn(t,e){const n=Object.keys(t),s=n.length,r={};for(let a=0;a<s;a++){const s=n[a],i=e(s,t[s]);R(i)&&(r[s]=i.value)}return r}var wn=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]])}return n};const bn={},[yn,vn]=function(){var t=this&&this.__assign||function(){return(t=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},e=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var s,r,a=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(s=a.next()).done;)i.push(s.value)}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return i},n=this&&this.__spreadArray||function(t,e){for(var n=0,s=e.length,r=t.length;n<s;n++,r++)t[r]=e[n];return t},r=function(){function s(t){return"number"==typeof t?i[t]:t}function r(t){return"number"==typeof t?o[t]:t}function a(t){switch(t.length){case 0:return null;case 1:return t[0];default:return t}}function c(t,e,n){void 0===n&&(n=u);var s=e.reduce((function(t,e){return t&&null!=t[e]?t[e]:null}),t);return null===s?null:n(s)}function p(t,e){var n=e.slice();return n.unshift(t),n}function l(t,e,n){return void 0===n&&(n=u),c(t,p("properties",e),n)}var u=function(t){return t},d=function(t){return!0},f=function(t,e){return function(n){return t(n)&&e(n)}},_=function(t,e){return function(n){return t(n)||e(n)}},m=function(t){return function(e){return!t(e)}},q=function(t,e){return function(n){return n>=t&&n<=e}},g=function(t){return new Date(t).getTime()},w=function(t){return c(t,["time"],g)},b=function(t,e){return c(e,t,g)},y=function(t,e,n,s,r,a){return function(i){var o=c(i,t,(function(t){return t.filter(s).map((function(t){return c(t,e)})).reduce(r,a)}));return n(null===o?a:o)}},v=function(t){return function(e){return("string"==typeof t||"number"==typeof t)&&"string"==typeof e&&e.toLowerCase().indexOf(r(t).toLowerCase())>-1}},h=function(t){return function(e){return null!=e&&Array.isArray(e)&&e.indexOf(t)>=0}};function k(t,e,n,s,r){var a=c(t.getSegments(),[e,n])||!1;return r&&(s||a)&&t.setSegmentActivation(e,n,r),a}function x(t,e,n){return c(t.getSegments(),[e,n])||!1}function S(t,n,s){return void 0===s&&(s=18e5),function(r){return{a:{m:function(t,e){return[e[0],r.a.m(null!=t[0]&&t[0][0]===e[0][0]?t[1]:r.a.z,e[1])]},z:[[],r.a.z]},p:function(e,s){return[[t(e)],c(s,n)===t(e)?r.p(e,s):r.a.z]},r:function(e,n){return r.r(e,n[0]!=[]&&n[0][0]===t(e)?n[1]:r.a.z)},d:r.d.sq||{l:function(a,i){var o=c(a,n),p=t(i);if(o!==p)return null;var l=r.d.l(a,i);if(!(Array.isArray(l)&&l.length>1))return null;var u=e(l),d=u[0],f=u.slice(1),_=+(w(a)||i.getCurrentTime()),m=Math.floor(_/s),q={};return q[m]={},q[m][p]=1===f.length?f[0]:f,[d,"u",null,q]},i:function(e,n){if(!Array.isArray(e)||"object"!=typeof e[3])return[[],r.a.z];var s=t(n),a=e[3];return[[s],Object.keys(a).map((function(t){return a[t][s]})).filter((function(t){return t})).map((function(t){return r.d.i([e[0]].concat(t))})).reduce(r.a.m,r.a.z)]}}}}}var O=S((function(t){return t.getCurrentSession()}),["session_id"],18e5),j=S((function(t){return t.getCurrentView()}),["view_id"],3e5);function A(t,r,a,i){return void 0===i&&(i=1),{a:{m:function(t,e){return t.concat(e).slice(-a)},z:[]},p:function(e,n){return c(n,["name"])===s(r)?[t.p(e,n)]:[]},r:function(e,n){return t.r(e,n.reduce((function(e,n){return t.a.m(e,n)}),t.a.z))},d:t.d.ftn||{l:function(e,n){var s,r=t.d.l(e,n),o=c(e,["time"],g)*i;return r&&[r[0],"x"+a,null,(s={},s[o]=2==r.length?r[1]:r.slice(1),s)]},i:function(s,r){return s?Object.keys(s[3]||{}).sort().reverse().map((function(t){return Array.isArray(t)?n([s[0]],e(s[3][t])):[s[0],s[3][t]]})).map((function(e){return t.d.i(e,r)})):[]}}}}var z=function(t,e){return null===t?null==e?null:{b:e}:null==e?{a:t}:{a:t,b:e}},E=function(t,e){return t&&e?t(e):null},C=function(t,e,n){if(n&&n.result&&Array.isArray(n.result)){var s=E(t.d&&t.d.m,{result:n.result[0]}),r=E(e.d&&e.d.m,{result:n.result[1]});return z(s,r)}return null};return{q:function(t){return{lift:function(e,n){return t.d.l(e,n)},interpret:function(e,n){return function(e,n){return{result:t.r(e,n)}}(n,t.d.i(e,n))},migrate:function(e){return e&&t.d.m?t.d.m(e):null},m:t.a.m,z:t.a.z,p:t.p,r:t.r,i:t.d.i}},a:function(t){return t.reduce(f)},acq:function(t,e){return{p:function(n,s){return[t.p(n,s),e.p(n,s)]},r:function(n,s){return t.r(n,s[0])&&e.r(n,s[1])},a:{z:[t.a.z,e.a.z],m:function(n,s){return[t.a.m(n[0],s[0]),e.a.m(n[1],s[1])]}},d:{l:function(n,s){return z(t.d.l(n,s),e.d.l(n,s))},i:function(n,s){return n?[t.d.i(n.a||null,s),e.d.i(n.b||null,s)]:[t.a.z,e.a.z]},m:function(n){return C(t,e,n)}}}},af_i:function(t,e,n){return void 0===n&&(n=d),function(s){return c(s,t,(function(t){return t.filter(n).map(e).reduce((function(t,e){return t&&e}),!0)}))&&!0}},af_l:function(t,e,n){return void 0===n&&(n=d),function(s){var r=c(s,t,(function(t){return t.filter(n).length}));return e(null===r?0:r)}},af_m:function(t,e,n,s){return void 0===s&&(s=d),function(r){var a=c(r,t,(function(t){return t.filter(s)}));return null===a||0===a.length?n(0):n(a.map((function(t){return c(t,e)})).reduce((function(t,e){return t+e}),0)/a.length)}},af_n:function(t,e,n,s){return void 0===s&&(s=d),y(t,e,n,s,(function(t,e){return Math.min(t,e)}),Number.POSITIVE_INFINITY)},af_p:function(t,e,n,s){return void 0===s&&(s=d),y(t,e,n,s,(function(t,e){return t*e}),1)},af_s:function(t,e,n,s){return void 0===s&&(s=d),y(t,e,n,s,(function(t,e){return t+e}),0)},af_u:function(t,e,n){return void 0===n&&(n=d),function(s){return c(s,t,(function(t){return t.filter(n).map(e).reduce((function(t,e){return t||e}),!1)}))||!1}},af_x:function(t,e,n,s){return void 0===s&&(s=d),y(t,e,n,s,(function(t,e){return Math.max(t,e)}),Number.NEGATIVE_INFINITY)},as:function(t,e,n){var s=p("properties",e);return function(e){for(var r=c(e,s),a=n.length,i=!0,o=0;o<a;o++){var p=n[o];if(!(i=t(p)(r)))break}return i}},c:h,c_:function(t,e){return function(n){return h(e)(c(n,t))}},cl_:function(t,e){return function(n){return h(r(e))(c(n,t))}},cx:function(t){return function(e){return h(r(t))(e)}},ctu:function(t,e,n,r){return{a:r?{m:function(t,e){return t.filter((function(t){return-1===e.indexOf(t)})).concat(e).slice(-r)},z:[]}:{m:function(t,e){return t.filter((function(t){return-1===e.indexOf(t)})).concat(e)},z:[]},p:function(r,a){return c(a,["name"])===s(t)&&e(a)?c(a,n):[]},r:function(t,e){return e},d:{l:function(){return null},i:function(){return[]}}}},ctv:function(e,n,r,a){function i(t,e){var n,s=function(t){return{k:t.k,c:1+t.c}},r={arr:[],add:{k:e,c:1}};return e?(n=t.reduce((function(t,e){return t.add.k===e.k?{arr:t.arr,add:s(e)}:{arr:t.arr.concat(e),add:t.add}}),r)).arr.concat(n.add):t}return{a:a?{m:function(t,e){return i(t,e).slice(-a)},z:[]}:{m:function(t,e){return i(t,e)},z:[]},p:function(t,a){return c(a,["name"])===s(e)&&n(a)?c(a,r):null},r:function(e,n){return n.reduce((function(e,n){var s;return t(t({},e),((s={})[n.k]=n.c,s))}),{})},d:{l:function(t){return null},i:function(t){return[]}}}},ctw:function(t,e,n,r){return{a:r?{m:function(t,e){return t.concat(e).slice(-r)},z:[]}:{m:function(t,e){return t.concat(e)},z:[]},p:function(r,a){return c(a,["name"])===s(t)&&e(a)?c(a,n):[]},r:function(t,e){return e},d:{l:function(){return null},i:function(){return[]}}}},cw:function(t,e,n){return void 0===n&&(n=u),{a:{m:function(t,e){return t+e},z:0},p:function(n,r){return c(r,["name"])===s(t)&&e(r)?1:0},r:function(t,e){return n(e)},d:{l:function(n){return c(n,["name"])===s(t)&&e(n)?["p",1]:null},i:function(t){return t?Array.isArray(t)?t.slice(-1)[0]:t:0},m:function(t){return t&&t.result?["p",t.result]:null}}}},e:function(t){return function(e){return e===t}},e_:function(t,e){return function(n){return c(n,t)===e}},fm:function(t,e){return{p:e.p,r:function(n,s){return t(e.r(n,s))},a:e.a,d:e.d}},ftn:function(t,e,n){return{a:{m:function(t,e){return t.concat(e.slice(0,n-t.length))},z:[]},p:function(n,r){return c(r,["name"])===s(e)?[t.p(n,r)]:[]},r:function(e,n){return t.r(e,n.reduce((function(e,n){return t.a.m(e,n)}),t.a.z))},d:A(t,e,n,-1).d}},fw:function(t,e,n,r){return void 0===r&&(r=u),{a:{m:function(t,e){return null===t?e:t},z:null},p:function(r,a){return c(a,["name"])===s(t)&&e(a)?c(a,n):null},r:function(t,e){return e},d:{l:function(n){return c(n,["name"])===s(t)&&e(n)?["p",1]:null},i:function(t){return t?Array.isArray(t)?t.slice(-1)[0]:t:0},m:function(t){return t&&t.result?["p",t.result]:null}}}},g:function(t){return function(e){return e>t}},g_:function(t,e){return function(n){return c(n,t)>e}},gb:function(t,e,n){return{a:{m:function(n,s){return Object.keys(n).concat(Object.keys(s)).filter((function(t,e,n){return n.indexOf(t)===e})).sort((function(t,e){return Math.max(c(n,[e,1]),c(s,[e,1]))-Math.max(c(n,[t,1]),c(s,[t,1]))})).slice(0,e).reduce((function(e,r){var a=t.a.m(c(n,[r,0])||t.a.z,c(s,[r,0])||t.a.z);return e[r]=[a,Math.max(c(n,[r,1]),c(s,[r,1]))],e}),{})},z:{}},p:function(e,s){var r,a,i=c(s,p("properties",n)),o=t.p(e,s);return null==i||(null==(a=o)||"object"==typeof a&&0===Object.keys(a).length||a===t.a.z)?{}:((r={})[i]=[o,c(s,["time"],g)],r)},r:function(e,n){var s={};return Object.keys(n).forEach((function(r){return s[r]=t.r(e,n[r][0])})),s},d:{l:function(){return null},i:function(){return{}}}}},ge:function(t){return function(e){return e>=t}},ge_:function(t,e){return function(n){return c(n,t)>=e}},i_:u,ifp:function(t){return{a:{m:function(t,e){return e},z:null},p:function(t){return null},r:function(e,n){return function(e){return x(e,"1p",t)}(e)},d:{l:function(t,e){return null},i:function(t){return null}}}},isp:function(t,e,n,s){return{a:{m:function(t,e){return e},z:!1},p:function(n,s){return x(n,t,e)},r:function(r,a){return k(r,t,e,n,s)},d:{l:function(t,e){return null},i:function(t){return Array.isArray(t)&&(!!+t[2]||!1)}}}},itp:function(t,e,n,s){return{a:{m:function(t,e){return e},z:!1},p:function(n,s){return x(n,t,e)},r:function(r,a){return k(r,t,e,n,s)},d:{l:function(t,e){return null},i:function(t){return Array.isArray(t)&&(!!+t[2]||!1)}}}},k:c,l:function(t){return function(e){return e<t}},l_:function(t,e){return function(n){var s=c(n,t);return null!==s&&s<e}},le:function(t){return function(e){return e<=t}},le_:function(t,e){return function(n){var s=c(n,t);return null!==s&&s<=e}},lm:function(t,e){var n=function(e){return function(t,e,n){var s,r=t||{},a=e[n]||{},i=(a["1p"]||{}).const||0;return Object.keys(r).forEach((function(t){r[t].forEach((function(e){var n=(a[t]||{})[e]||0;i+=n}))})),s=i,1/(1+Math.pow(Math.E,-s))}(e.getSegmentsArray(),e.getLookalikeModels(),t)};return{a:{m:function(t,e){return e},z:null},p:function(t){return null},r:function(t,s){return e(n(t))},d:{l:function(t,e){return null},i:function(t){return null}}}},ltn:A,mnw:function(t,e,n,r){void 0===r&&(r=u);var a=Number.POSITIVE_INFINITY;return{a:{m:function(t,e){return t<e?t:e},z:a},p:function(r,i){return c(i,["name"])===s(t)&&e(i)?c(i,n):a},r:function(t,e){return r(e)},d:{l:function(r){return c(r,["name"])===s(t)&&e(r)?["n",c(r,n)]:null},i:function(t){return t?Array.isArray(t)?t.slice(-1)[0]:t:a}}}},mxw:function(t,e,n,r){void 0===r&&(r=u);var a=Number.NEGATIVE_INFINITY;return{a:{m:function(t,e){return t>e?t:e},z:a},p:function(r,i){return c(i,["name"])===s(t)&&e(i)?c(i,n):a},r:function(t,e){return r(e)},d:{l:function(r){return c(r,["name"])===s(t)&&e(r)?["v",c(r,n)]:null},i:function(t){return t?Array.isArray(t)?t.slice(-1)[0]:t:a}}}},n0:m(u),n:function(t){return function(e){return e!==t}},nt:m,n_:function(t,e){return function(n){return c(n,t)!==e}},o:function(t){return t.reduce(_)},ocq:function(t,e){return{p:function(n,s){return[t.p(n,s),e.p(n,s)]},r:function(n,s){return t.r(n,s[0])||e.r(n,s[1])},a:{z:[t.a.z,e.a.z],m:function(n,s){return[t.a.m(n[0],s[0]),e.a.m(n[1],s[1])]}},d:{l:function(n,s){return z(t.d.l(n,s),e.d.l(n,s))},i:function(n,s){return n?[t.d.i(n.a||null,s),e.d.i(n.b||null,s)]:[t.a.z,e.a.z]},m:function(n){return C(t,e,n)}}}},oe:function(t){for(var e=Object.keys(t),n=e.length,s=new Array(n);n--;)s[n]=[e[n],t[e[n]]];return s},os:function(t,e,n){var s=p("properties",e);return function(e){for(var r=c(e,s),a=n.length,i=!1,o=0;o<a;o++){var p=n[o];if(i=t(p)(r))break}return i}},pb:function(t,e,n){return function(s){return q(e,n)(l(s,t))}},pc:function(t,e){return function(n){var s=l(n,t);return null!=s&&Array.isArray(s)&&s.indexOf(e)>=0}},pc_:function(t,e){return function(n){var s=l(n,t),a=r(e);return null!=s&&Array.isArray(s)&&s.indexOf(a)>=0}},pe:function(t,e){return function(n){return l(n,t)===e}},pg:function(t,e){return function(n){return l(n,t)>e}},pge:function(t,e){return function(n){return l(n,t)>=e}},pl:function(t,e){return function(n){var s=l(n,t);return null!==s&&s<e}},ple:function(t,e){return function(n){var s=l(n,t);return null!==s&&s<=e}},pn:function(t,e){return function(n){return l(n,t)!==e}},ps:function(t,e){return function(n){return v(e)(l(n,t))}},pw:function(t,e,n,r){return void 0===r&&(r=u),{a:{m:function(t,e){return t*e},z:1},p:function(r,a){return c(a,["name"])===s(t)&&e(a)?c(a,n):1},r:function(t,e){return r(e)},d:{l:function(r){return c(r,["name"])===s(t)&&e(r)?(a=c(r,n))>=1?["m2p",a]:a>0?["m2p",null,1/a]:0==a?["m2p",0]:a>-1?["m2p",null,1/a,1]:["m2p",a,null,1]:null;var a},i:function(t){return t?Array.isArray(t)?0===(e=t.slice(1))[0]?0:Math.pow(-1,e[2]||0)*(e[0]||1)/(e[1]||1):t:1;var e}}}},s:v,s_:function(t,e){return function(n){return v(e)(c(n,t))}},scq:function(t,e,n){return void 0===n&&(n=u),{p:function(n,s){return[t.p(n,s),e.p(n,s)]},r:function(s,r){return n(t.r(s,r[0])+e.r(s,r[1]))},a:{z:[t.a.z,e.a.z],m:function(n,s){return[t.a.m(n[0],s[0]),e.a.m(n[1],s[1])]}},d:{l:function(n,s){return z(t.d.l(n,s),e.d.l(n,s))},i:function(n,s){return n?[t.d.i(n.a||null,s),e.d.i(n.b||null,s)]:[t.a.z,e.a.z]},m:function(n){return C(t,e,n)}}}},sq:O,sw:function(t,e,n,r){return void 0===r&&(r=u),{a:{m:function(t,e){return t+e},z:0},p:function(r,a){return c(a,["name"])===s(t)&&e(a)?c(a,n):0},r:function(t,e){return r(e)},d:{l:function(r){return function(n){return c(n,["name"])===s(t)&&e(n)}(r)?(a=c(r,n))<0?["p2",null,-a]:["p2",a]:null;var a},i:function(t){return t?Array.isArray(t)?((e=t.slice(1))[0]||0)-(e[1]||0):t:0;var e}}}},t:d,tb:function(t,e){return function(n){return q(t,e)(w(n))}},te:function(t){return function(e){return w(e)===t}},te_:function(t,e){return function(n){return b(t,n)===e}},tg:function(t){return function(e){return w(e)>t}},tg_:function(t,e){return function(n){return b(t,n)>e}},tge:function(t){return function(e){return w(e)>=t}},tge_:function(t,e){return function(n){return b(t,n)>=e}},ti:g,tl:function(t){return function(e){return w(e)<t}},tl_:function(t,e){return function(n){return b(t,n)<e}},tle:function(t){return function(e){return w(e)<t}},tle_:function(t,e){return function(n){return b(t,n)<e}},tn:function(t){return function(e){return w(e)!==t}},tn_:function(t,e){return function(n){return b(t,n)!==e}},tw:function(t,s,r){var i=r||100,o=Math.ceil(s/i),p=function(t){return Math.floor(t/o)},l=function(t,e,n){var r;return[p(t-s),(r={},r[p(e)]=n,r)]},u=function(e,n){var s=Math.max(e[0],n[0]),r=Object.keys(e[1]).filter((function(t){return t>=s})).concat(Object.keys(n[1]).filter((function(t){return t>=s}))).filter((function(t,e,n){return n.indexOf(t)===e})).reduce((function(s,r){var a=t.a.m(e[1][r]||t.a.z,n[1][r]||t.a.z);return a!==t.a.z&&(s[r]=a),s}),{});return[s,r]},d=[Number.NEGATIVE_INFINITY,{}],f=function(t){var n=function(n){return n.map((function(n){var s=e(n,3),r=s[0],a=(s[1],s[2]);return l(t.t,a,r)})).reduce(u,d)};return u(n(t.in),n(t.out))},_=function(n){if(void 0!==n.result)return _(n.result);if(void 0!==n.w)return _(f(n));var s=e(n,2),r=(s[0],s[1]),i=null,o={};for(var c in r){var p=t.d.m({result:r[c]});p&&Array.isArray(p)&&(i=p[0],o[c]=a(p.slice(1)))}return i&&[i,"w",n[0],o]};return{a:{m:function(t,e){var n=t.w?f(t):t;return u(n,e)},z:d},p:function(e,n){return l(e.getCurrentTime(),c(n,["time"],g),t.p(e,n))},r:function(e,n){var s=(n.w?f(n):n)[1];return t.r(e,Object.keys(s).reduce((function(e,n){return t.a.m(e,s[n])}),t.a.z))},d:t.d.tw||{l:function(s,r){var a=t.d.l(s,r);return a&&n([a[0],"w"],e(l(r.getCurrentTime(),c(s,["time"],g),a.slice(1))))},i:function(e,n){var s=Array.isArray(e)?e:[];return[s[2]||null,Object.keys(s[3]||{}).map((function(e){var r;return(r={})[e]=t.d.i(s[3][e],n),r})).reduce((function(t,e){return Object.keys(e).forEach((function(n){return t[n]=e[n]})),t}),{})]},m:t.d.m&&_}}},vgw:function(t,e,n,r){void 0===r&&(r=u);var a={v:0,k:0};return{a:{m:function(t,e){var n=t.k+e.k;return{v:n?t.v+e.k*(e.v-t.v)/n:0,k:n}},z:a},p:function(r,i){return c(i,["name"])===s(t)&&e(i)?{v:c(i,n),k:1}:a},r:function(t,e){return r(e.v)},d:{l:function(r){return c(r,["name"])===s(t)&&e(r)?0==(a=c(r,n))?["p3",1]:a<0?["p3",1,null,-a]:["p3",1,a]:null;var a},i:function(t){return t?Array.isArray(t)?{v:(((e=t.slice(1))[1]||0)-(e[2]||0))/(e[0]||1),k:e[0]||0}:void 0:a;var e}}}},vq:j,w:function(t){return function(e){return e===r(t)}},x:function(t){return function(e){return e!==r(t)}},y:function(t,e){return function(n){return l(n,t)===o[e]}},y_:function(t,e){return function(n){return c(n,t)===o[e]}},z:function(t,e){return function(n){return l(n,t)!==o[e]}},z_:function(t,e){return function(n){return c(n,t)!==o[e]}}}}(),a={1e7:r.q(r.ocq(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/education/graduate school"),r.ge(3)),2592e6),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/science"),r.ge(3)),2592e6))),10000001:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/automotive and vehicles"),r.ge(3)),2592e6)),10000002:r.q(r.ocq(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/art and entertainment/books and literature"),r.ge(3)),2592e6),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],102),r.ge(3)),2592e6))),10000003:r.q(r.ocq(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],104),r.ge(3)),2592e6),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],106),r.ge(3)),2592e6))),10000004:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/careers"),r.ge(3)),2592e6)),10000005:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/education"),r.ge(3)),2592e6)),10000006:r.q(r.ocq(r.ocq(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],57),r.ge(3)),2592e6),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/society/social institution/marriage"),r.ge(3)),2592e6)),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],22),r.ge(3)),2592e6))),10000007:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],101),r.ge(3)),2592e6)),10000008:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],108),r.ge(3)),2592e6)),10000010:r.q(r.ocq(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],110),r.ge(3)),2592e6),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/health and fitness"),r.ge(3)),2592e6))),10000011:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/hobbies and interests"),r.ge(3)),2592e6)),10000012:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/home and garden"),r.ge(3)),2592e6)),10000013:r.q(r.ocq(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/art and entertainment/movies"),r.ge(3)),2592e6),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/art and entertainment/movies and tv"),r.ge(3)),2592e6))),10000014:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/art and entertainment/music"),r.ge(3)),2592e6)),10000015:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],113),r.ge(3)),2592e6),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/news"),r.ge(3)),2592e6)),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],111),r.ge(3)),2592e6)),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],56),r.ge(3)),2592e6)),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],10),r.ge(3)),2592e6)),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/sports news"),r.ge(3)),2592e6)),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/technology and computing/tech news"),r.ge(3)),2592e6))),10000016:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],106),r.ge(3)),2592e6)),10000017:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/pets"),r.ge(3)),2592e6)),10000018:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],101),r.ge(3)),2592e6)),10000019:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/real estate"),r.ge(3)),2592e6)),10000020:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/shopping"),r.ge(3)),2592e6)),10000021:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports"),r.ge(3)),2592e6)),10000022:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/style and fashion"),r.ge(3)),2592e6)),10000023:r.q(r.ocq(r.ocq(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/technology and computing"),r.ge(3)),2592e6),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/science/computer science"),r.ge(3)),2592e6)),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/business and industrial/automation"),r.ge(3)),2592e6))),10000024:r.q(r.ocq(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/art and entertainment/movies and tv/television"),r.ge(3)),2592e6),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/art and entertainment/tv"),r.ge(3)),2592e6))),10000025:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/travel"),r.ge(3)),2592e6)),10000026:r.q(r.ocq(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/hobbies and interests/games/video and computer games"),r.ge(3)),2592e6),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/technology and computing/consumer electronics/game systems and consoles"),r.ge(3)),2592e6))),10000035:r.q(r.ocq(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/science/physics"),r.ge(3)),2592e6),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/science/engineering"),r.ge(3)),2592e6))),10000036:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/automotive and vehicles/buying and selling cars"),r.ge(3)),2592e6)),10000037:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/automotive and vehicles/motor shows"),r.ge(3)),2592e6)),10000038:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/automotive and vehicles/electric vehicles"),r.ge(3)),2592e6)),10000039:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/automotive and vehicles/motorcycles"),r.ge(3)),2592e6)),10000040:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/automotive and vehicles/cars/performance vehicles"),r.ge(3)),2592e6)),10000041:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],102),r.ge(3)),2592e6)),10000042:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],104),r.ge(3)),2592e6)),10000043:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],22),r.ge(3)),2592e6)),10000044:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],57),r.ge(3)),2592e6)),10000045:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/art and entertainment/dance"),r.ge(3)),2592e6)),10000046:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/art and entertainment/visual art and design"),r.ge(3)),2592e6)),10000047:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/food and drink/beverages/alcoholic beverages"),r.ge(3)),2592e6)),10000048:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/food and drink/barbecues and grilling"),r.ge(3)),2592e6)),10000049:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],109),r.ge(3)),2592e6)),10000050:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/food and drink/dining out"),r.ge(3)),2592e6)),10000051:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/food and drink/food allergies"),r.ge(3)),2592e6)),10000052:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],110),r.ge(3)),2592e6)),10000053:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/food and drink/vegetarian"),r.ge(3)),2592e6)),10000054:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/health and fitness/exercise"),r.ge(3)),2592e6)),10000056:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/health and fitness/nutrition"),r.ge(3)),2592e6)),10000058:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/home and garden/gardening and landscaping"),r.ge(3)),2592e6)),10000059:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/art and entertainment/movies and tv/action"),r.ge(3)),2592e6)),10000060:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/art and entertainment/movies and tv/animated"),r.ge(3)),2592e6)),10000062:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/art and entertainment/movies and tv/horror"),r.ge(3)),2592e6)),10000063:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],113),r.ge(3)),2592e6)),10000064:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/law, govt and politics/legal issues"),r.ge(3)),2592e6)),10000065:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],21),r.ge(3)),2592e6)),10000066:r.q(r.ocq(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/law, govt and politics/politics"),r.ge(3)),2592e6),r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],58),r.ge(3)),2592e6))),10000067:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/science/weather"),r.ge(3)),2592e6)),10000068:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/pets/birds"),r.ge(3)),2592e6)),10000069:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/pets/cats"),r.ge(3)),2592e6)),10000070:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/pets/dogs"),r.ge(3)),2592e6)),10000071:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/pets/large animals"),r.ge(3)),2592e6)),10000072:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/pets/reptiles"),r.ge(3)),2592e6)),10000073:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/football"),r.ge(3)),2592e6)),10000074:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/baseball"),r.ge(3)),2592e6)),10000075:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/basketball"),r.ge(3)),2592e6)),10000076:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/bodybuilding"),r.ge(3)),2592e6)),10000077:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/bowling"),r.ge(3)),2592e6)),10000078:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/boxing"),r.ge(3)),2592e6)),10000079:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/bicycling"),r.ge(3)),2592e6)),10000080:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/fishing"),r.ge(3)),2592e6)),10000081:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/golf"),r.ge(3)),2592e6)),10000082:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/hunting and shooting"),r.ge(3)),2592e6)),10000083:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/rugby"),r.ge(3)),2592e6)),10000084:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/skiing"),r.ge(3)),2592e6)),10000085:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/tennis"),r.ge(3)),2592e6)),10000086:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/sports/walking"),r.ge(3)),2592e6)),10000087:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/style and fashion/beauty"),r.ge(3)),2592e6)),10000088:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/style and fashion/body art"),r.ge(3)),2592e6)),10000090:r.q(r.tw(r.cw(0,r.pc_(["classifications_watson","taxonomy_labels"],"/technology and computing/consumer electronics"),r.ge(3)),2592e6)),21247:r.q(r.cw(0,r.t,r.ge(1))),21634:r.q(r.cw(0,r.pe(["geo_info","country"],"United States"),r.ge(1))),23609:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ltn(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[174,"outward","pride-month","pride","transgender","Transgender","sexism"])]),r.ge(1)),0,1),r.cw(0,r.o([r.os(r.cx,["article","authors"],["Christina Cauterucci","June Thomas"])]),r.ge(1))),r.ltn(r.cw(0,r.o([r.os(r.w,["article","rubric"],[125,63,"Five-Ring Circus"])]),r.ge(1)),0,1)),r.isp("slate_podcast_listeners","pod013",!1,"23609")),r.isp("slate_podcast_listeners","pod004",!1,"23609"))),23760:r.q(r.itp("comscore","325547US",!1,"23760")),23844:r.q(r.itp("eyeota","6680",!1,"23844")),23845:r.q(r.itp("eyeota","6681",!1,"23845")),24351:r.q(r.ocq(r.ltn(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[5,"the-surge","the-hot-seats","president",16,1,185])]),r.ge(1)),0,1),r.cw(0,r.o([r.os(r.cx,["article","concepts"],["President of the United States","President"])]),r.ge(1)))),24377:r.q(r.itp("eyeota","13443",!1,"24377")),24378:r.q(r.itp("eyeota","1543",!1,"24378")),24393:r.q(r.itp("eyeota","35110",!1,"24393")),24847:r.q(r.ltn(r.cw(0,r.o([r.os(r.cx,["article","keywords"],["impeachment",1,"nancy-pelosi"])]),r.ge(1)),0,1)),25108:r.q(r.acq(r.acq(r.ocq(r.itp("eyeota","35502",!1,"25108"),r.itp("eyeota","6685",!1,"25108")),r.itp("eyeota","13443",!1,"25108")),r.itp("eyeota","35944",!1,"25108"))),25666:r.q(r.acq(r.ltn(r.cw(0,r.o([r.os(r.s,["client","url"],[191,4,"vaginal","racist","white supremacy",7,"anal",186,20,"dead","penis",146,"sexual",136,141,19,"catastrophe",18,"fetish","kills",46,"weapon","evil","cannabis","immigrant",208,"wounded","fire","lockdown","weinstein","menstrual",93,200,184,"global warming","outrage","feud",189,149,"cult","damaging","8chan","tiktok",193,0,"conservatives","crisis","equifax","hack","addiction","bushfires",39,"malware","korea","chernobyl","wildfire",166,"nationalist","sandy hook","columbine",54,"activism","bias","bloomberg","sanders","warren","buttigieg","klobuchar",148,"steyer","disease","epstein","dox","scanners","cease-and-desist",38,51,202,87,"gang","redlining","choking","condoms",182,"bite","hybrids","8kun","dopamine",157,"mortality","virus pandemic","Covid 19 disease","Covid19 disease","Coronavirus disease","Covid 19 pandemic","Coronavirus pandemic","Covid19 pandemic","Covid 19","Covid19","abortion",137,"acid",140,144,145,26,153,"deadly",163,165,"george floyd protests",156,183,"strike",201,55,"violent","fauci","disinfectant"])]),r.ge(1)),0,1),r.cw(0,r.pc_(["article","keywords"],0),r.ge(1)))),25971:r.q(r.tw(r.cw(1,r.t,r.ge(1)),2592e5)),27091:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ltn(r.cw(0,r.o([r.os(r.w,["article","rubric"],[6,121])]),r.ge(1)),0,3),r.ltn(r.cw(0,r.pc_(["article","keywords"],48),r.ge(1)),0,3)),r.ltn(r.cw(4,r.y(["newsletters"],48),r.ge(1)),4,10)),r.ltn(r.cw(1,r.pe(["creative_id"],5215395010),r.ge(1)),1,10)),r.isp("slate_podcast_listeners","pod012",!1,"27091"))),27290:r.q(r.ltn(r.cw(0,r.pe(["article","section"],"Human Interest"),r.ge(1)),0,1)),27455:r.q(r.ocq(r.ltn(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[35,"Energy","green lantern","climate",27,187])]),r.ge(1)),0,1),r.cw(0,r.o([r.os(r.cx,["article","categories"],["Environment","electric vehicles","green energy"])]),r.ge(1)))),29015:r.q(r.ocq(r.ltn(r.cw(0,r.o([r.os(r.w,["article","rubric"],[68,129,63])]),r.ge(1)),0,1),r.ltn(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[180,196,"ncaa-tournament","basketball","march madness","college-sports"])]),r.ge(1)),0,1))),29809:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.tw(r.cw(0,r.o([r.os(r.w,["article","section"],[67,66])]),r.ge(3)),6048e5),r.ltn(r.cw(4,r.o([r.os(r.w,["newsletters"],[133,135,70])]),r.ge(1)),4,10)),r.ltn(r.cw(1,r.o([r.os(r.e,["creative_id"],[5214898785,5215655183])]),r.ge(1)),1,10)),r.isp("slate_podcast_listeners","pod001",!1,"29809")),r.isp("slate_podcast_listeners","pod014",!1,"29809")),r.isp("slate_podcast_listeners","pod026",!1,"29809"))),29811:r.q(r.ocq(r.ocq(r.tw(r.cw(0,r.t,r.ge(3)),864e5),r.ltn(r.cw(6,r.t,r.ge(1)),6,3)),r.ltn(r.cw("Social",r.t,r.ge(1)),"Social",3))),29813:r.q(r.ocq(r.ltn(r.cw(0,r.y(["article","rubric"],126),r.ge(1)),0,10),r.ltn(r.cw("ProductClick",r.t,r.ge(1)),"ProductClick",1))),29823:r.q(r.ocq(r.ocq(r.cw(0,r.o([r.os(r.s,["article","rubric"],[63,68,129])]),r.ge(1)),r.cw(0,r.o([r.os(r.cx,["article","keywords"],[180,"japan"])]),r.ge(1))),r.ltn(r.cw(0,r.pc_(["article","categories"],196),r.ge(1)),0,1))),30268:r.q(r.itp("eyeota","61",!1,"30268")),31648:r.q(r.itp("eyeota","11209",!1,"31648")),31955:r.q(r.ocq(r.ocq(r.cw(0,r.y(["client","url"],0),r.ge(1)),r.cw(0,r.o([r.os(r.cx,["article","keywords"],[0,182,"COVID-19",14])]),r.ge(1))),r.cw(0,r.pc_(["article","categories"],"/health and fitness/disease/epidemic"),r.ge(1)))),32016:r.q(r.isp("slate_podcast_listeners","pod003",!1,"32016")),32017:r.q(r.isp("slate_podcast_listeners","pod027",!1,"32017")),32035:r.q(r.isp("slate_podcast_listeners","pod004",!1,"32035")),32036:r.q(r.isp("slate_podcast_listeners","pod001",!1,"32036")),32037:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.isp("slate_podcast_listeners","pod001",!1,"32037"),r.isp("slate_podcast_listeners","pod028",!1,"32037")),r.isp("slate_podcast_listeners","pod008",!1,"32037")),r.isp("slate_podcast_listeners","pod030",!1,"32037")),r.isp("slate_podcast_listeners","pod017",!1,"32037")),r.isp("slate_podcast_listeners","pod011",!1,"32037")),r.isp("slate_podcast_listeners","pod024",!1,"32037")),r.isp("slate_podcast_listeners","pod010",!1,"32037")),r.isp("slate_podcast_listeners","pod029",!1,"32037")),r.isp("slate_podcast_listeners","pod019",!1,"32037")),r.isp("slate_podcast_listeners","pod003",!1,"32037")),r.isp("slate_podcast_listeners","pod022",!1,"32037")),r.isp("slate_podcast_listeners","pod031",!1,"32037")),r.isp("slate_podcast_listeners","pod002",!1,"32037")),r.isp("slate_podcast_listeners","pod018",!1,"32037")),r.isp("slate_podcast_listeners","pod012",!1,"32037")),r.isp("slate_podcast_listeners","pod007",!1,"32037")),r.isp("slate_podcast_listeners","pod020",!1,"32037")),r.isp("slate_podcast_listeners","pod025",!1,"32037")),r.isp("slate_podcast_listeners","pod026",!1,"32037")),r.isp("slate_podcast_listeners","pod015",!1,"32037")),r.isp("slate_podcast_listeners","pod014",!1,"32037")),r.isp("slate_podcast_listeners","pod013",!1,"32037")),r.isp("slate_podcast_listeners","pod023",!1,"32037")),r.isp("slate_podcast_listeners","pod005",!1,"32037")),r.isp("slate_podcast_listeners","pod004",!1,"32037")),r.isp("slate_podcast_listeners","pod006",!1,"32037")),r.isp("slate_podcast_listeners","pod021",!1,"32037")),r.isp("slate_podcast_listeners","pod009",!1,"32037")),r.isp("slate_podcast_listeners","pod016",!1,"32037")),r.isp("slate_podcast_listeners","pod032",!1,"32037"))),32038:r.q(r.isp("slate_podcast_listeners","pod021",!1,"32038")),32039:r.q(r.isp("slate_podcast_listeners","pod008",!1,"32039")),32040:r.q(r.isp("slate_podcast_listeners","pod030",!1,"32040")),32091:r.q(r.isp("slate_podcast_listeners","pod005",!1,"32091")),32092:r.q(r.isp("slate_podcast_listeners","pod007",!1,"32092")),32093:r.q(r.isp("slate_podcast_listeners","pod006",!1,"32093")),32096:r.q(r.isp("slate_podcast_listeners","pod009",!1,"32096")),32097:r.q(r.isp("slate_podcast_listeners","pod010",!1,"32097")),32098:r.q(r.isp("slate_podcast_listeners","pod011",!1,"32098")),32099:r.q(r.isp("slate_podcast_listeners","pod012",!1,"32099")),32100:r.q(r.isp("slate_podcast_listeners","pod013",!1,"32100")),32101:r.q(r.isp("slate_podcast_listeners","pod014",!1,"32101")),32102:r.q(r.isp("slate_podcast_listeners","pod016",!1,"32102")),32103:r.q(r.isp("slate_podcast_listeners","pod018",!1,"32103")),32104:r.q(r.isp("slate_podcast_listeners","pod019",!1,"32104")),32105:r.q(r.isp("slate_podcast_listeners","pod020",!1,"32105")),32106:r.q(r.isp("slate_podcast_listeners","pod022",!1,"32106")),32107:r.q(r.isp("slate_podcast_listeners","pod024",!1,"32107")),32108:r.q(r.isp("slate_podcast_listeners","pod025",!1,"32108")),32109:r.q(r.isp("slate_podcast_listeners","pod026",!1,"32109")),32110:r.q(r.isp("slate_podcast_listeners","pod031",!1,"32110")),32111:r.q(r.isp("slate_podcast_listeners","pod029",!1,"32111")),32112:r.q(r.ocq(r.ocq(r.isp("slate_podcast_listeners","pod017",!1,"32112"),r.isp("slate_podcast_listeners","pod002",!1,"32112")),r.isp("slate_podcast_listeners","pod023",!1,"32112"))),32593:r.q(r.ocq(r.isp("slate_survey","sur11",!1,"32593"),r.isp("slate_piano_append","imp0001",!1,"32593"))),32594:r.q(r.ocq(r.isp("slate_survey","sur10",!1,"32594"),r.isp("slate_piano_append","imp0002",!1,"32594"))),32595:r.q(r.ocq(r.ocq(r.ocq(r.isp("slate_survey","sur37",!1,"32595"),r.isp("slate_survey","sur30",!1,"32595")),r.isp("slate_survey","sur32",!1,"32595")),r.isp("slate_survey","sur33",!1,"32595"))),32795:r.q(r.cw(0,r.pe(["user","slatePlus"],!0),r.ge(1))),32797:r.q(r.cw(0,r.a([r.as(r.x,["user","sailthruId"],["null","(null)"])]),r.ge(1))),32798:r.q(r.tw(r.cw(0,r.t,r.ge(101)),2592e6)),32954:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.tw(r.cw(0,r.o([r.os(r.w,["article","rubric"],[64,132,71,65,62])]),r.ge(2)),2592e6),r.tw(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[177,131])]),r.ge(2)),2592e6)),r.isp("slate_podcast_listeners","pod003",!1,"32954")),r.isp("slate_podcast_listeners","pod015",!1,"32954")),r.isp("slate_podcast_listeners","pod018",!1,"32954")),r.isp("slate_podcast_listeners","pod005",!1,"32954")),r.isp("slate_podcast_listeners","pod008",!1,"32954"))),33023:r.q(r.ltn(r.cw(0,r.pe(["article","sentiment"],"negative"),r.ge(1)),0,1)),33024:r.q(r.ltn(r.cw(0,r.y(["article","sentiment"],92),r.ge(1)),0,1)),33106:r.q(r.ocq(r.ocq(r.ocq(r.vq(r.cw(0,r.o([r.os(r.cx,["article","concepts"],["/finance/investing",10,107,80])]),r.ge(1))),r.vq(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[80,"personal-finance",179])]),r.ge(1)))),r.isp("slate_podcast_listeners","pod016",!1,"33106")),r.isp("slate_podcast_listeners","pod029",!1,"33106"))),33158:r.q(r.ocq(r.ltn(r.cw(0,r.pc_(["article","keywords"],"uplifting"),r.ge(1)),0,1),r.vq(r.cw(0,r.y(["article","sentiment"],92),r.ge(1))))),33162:r.q(r.ocq(r.ocq(r.tw(r.cw(0,r.pc_(["article","keywords"],"technology"),r.ge(3)),2592e6),r.tw(r.cw(0,r.y(["article","section"],69),r.ge(3)),2592e6)),r.isp("slate_podcast_listeners","pod028",!1,"33162"))),33170:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.tw(r.cw(0,r.o([r.os(r.w,["article","rubric"],[23,6,12,"Pay Dirt"])]),r.ge(3)),6048e5),r.tw(r.cw(6,r.ps(["dest_url"],"comments/human-interest"),r.ge(3)),2592e6)),r.isp("slate_podcast_listeners","pod004",!1,"33170")),r.isp("slate_podcast_listeners","pod012",!1,"33170")),r.isp("slate_podcast_listeners","pod009",!1,"33170"))),33229:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.tw(r.cw(0,r.y(["article","section"],11),r.ge(1)),6048e5),r.tw(r.cw(0,r.pc_(["article","keywords"],13),r.ge(1)),6048e5)),r.tw(r.cw(0,r.o([r.os(r.cx,["article","concepts"],[105,13,56])]),r.ge(1)),6048e5)),r.isp("slate_podcast_listeners","pod016",!1,"33229")),r.isp("slate_podcast_listeners","pod029",!1,"33229")),r.isp("slate_podcast_listeners","pod032",!1,"33229"))),36650:r.q(r.cw(1,r.pe(["campaign_id"],2687006096),r.ge(1))),36803:r.q(r.ocq(r.itp("eyeota","34752",!1,"36803"),r.itp("liveramp_ShareThis","1001011799",!1,"36803"))),36990:r.q(r.acq(r.itp("comscore","235997US",!1,"36990"),r.itp("eyeota","35478",!1,"36990"))),38060:r.q(r.itp("eyeota","35162",!1,"38060")),38062:r.q(r.itp("eyeota","35175",!1,"38062")),38163:r.q(r.itp("eyeota","6688",!1,"38163")),38311:r.q(r.itp("eyeota","6536",!1,"38311")),38338:r.q(r.ocq(r.ocq(r.tw(r.cw(0,r.o([r.os(r.cx,["article","keywords"],["food52-reprint","food"])]),r.ge(3)),2592e6),r.ltn(r.cw(0,r.o([r.os(r.cx,["article","categories"],["/food and drink/cuisines",108,109,"/food and drink/food","/food and drink/food/baked goods","/food and drink/food/grains and pasta"])]),r.ge(1)),0,3)),r.tw(r.cw(0,r.y(["article","rubric"],122),r.ge(3)),2592e6))),38518:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd2",!1,"38518"),r.isp("slate_tsmt_append","fpd3",!1,"38518")),r.isp("slate_tsmt_append","fpd4",!1,"38518")),r.isp("slate_tsmt_append","fpd5",!1,"38518")),r.isp("slate_tsmt_append","fpd6",!1,"38518")),r.isp("slate_tsmt_append","fpd7",!1,"38518")),r.isp("slate_tsmt_append","fpd8",!1,"38518"))),38519:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd9",!1,"38519"),r.isp("slate_tsmt_append","fpd10",!1,"38519")),r.isp("slate_tsmt_append","fpd11",!1,"38519")),r.isp("slate_tsmt_append","fpd12",!1,"38519")),r.isp("slate_tsmt_append","fpd13",!1,"38519")),r.isp("slate_tsmt_append","fpd14",!1,"38519")),r.isp("slate_tsmt_append","fpd15",!1,"38519")),r.isp("slate_tsmt_append","fpd16",!1,"38519")),r.isp("slate_tsmt_append","fpd17",!1,"38519")),r.isp("slate_tsmt_append","fpd18",!1,"38519"))),38523:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd19",!1,"38523"),r.isp("slate_tsmt_append","fpd20",!1,"38523")),r.isp("slate_tsmt_append","fpd21",!1,"38523")),r.isp("slate_tsmt_append","fpd22",!1,"38523")),r.isp("slate_tsmt_append","fpd23",!1,"38523")),r.isp("slate_tsmt_append","fpd24",!1,"38523")),r.isp("slate_tsmt_append","fpd25",!1,"38523")),r.isp("slate_tsmt_append","fpd26",!1,"38523")),r.isp("slate_tsmt_append","fpd27",!1,"38523")),r.isp("slate_tsmt_append","fpd28",!1,"38523"))),38524:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd39",!1,"38524"),r.isp("slate_tsmt_append","fpd40",!1,"38524")),r.isp("slate_tsmt_append","fpd41",!1,"38524")),r.isp("slate_tsmt_append","fpd42",!1,"38524")),r.isp("slate_tsmt_append","fpd43",!1,"38524")),r.isp("slate_tsmt_append","fpd44",!1,"38524")),r.isp("slate_tsmt_append","fpd45",!1,"38524")),r.isp("slate_tsmt_append","fpd46",!1,"38524")),r.isp("slate_tsmt_append","fpd47",!1,"38524")),r.isp("slate_tsmt_append","fpd48",!1,"38524"))),38526:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd29",!1,"38526"),r.isp("slate_tsmt_append","fpd30",!1,"38526")),r.isp("slate_tsmt_append","fpd31",!1,"38526")),r.isp("slate_tsmt_append","fpd32",!1,"38526")),r.isp("slate_tsmt_append","fpd33",!1,"38526")),r.isp("slate_tsmt_append","fpd34",!1,"38526")),r.isp("slate_tsmt_append","fpd35",!1,"38526")),r.isp("slate_tsmt_append","fpd36",!1,"38526")),r.isp("slate_tsmt_append","fpd37",!1,"38526")),r.isp("slate_tsmt_append","fpd38",!1,"38526"))),38528:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd49",!1,"38528"),r.isp("slate_tsmt_append","fpd50",!1,"38528")),r.isp("slate_tsmt_append","fpd51",!1,"38528")),r.isp("slate_tsmt_append","fpd52",!1,"38528")),r.isp("slate_tsmt_append","fpd53",!1,"38528")),r.isp("slate_tsmt_append","fpd54",!1,"38528")),r.isp("slate_tsmt_append","fpd55",!1,"38528")),r.isp("slate_tsmt_append","fpd56",!1,"38528")),r.isp("slate_tsmt_append","fpd57",!1,"38528")),r.isp("slate_tsmt_append","fpd58",!1,"38528")),r.isp("slate_tsmt_append","fpd59",!1,"38528")),r.isp("slate_tsmt_append","fpd60",!1,"38528")),r.isp("slate_tsmt_append","fpd61",!1,"38528")),r.isp("slate_tsmt_append","fpd62",!1,"38528")),r.isp("slate_tsmt_append","fpd63",!1,"38528")),r.isp("slate_tsmt_append","fpd64",!1,"38528")),r.isp("slate_tsmt_append","fpd65",!1,"38528")),r.isp("slate_tsmt_append","fpd66",!1,"38528")),r.isp("slate_tsmt_append","fpd67",!1,"38528")),r.isp("slate_tsmt_append","fpd68",!1,"38528")),r.isp("slate_tsmt_append","fpd69",!1,"38528")),r.isp("slate_tsmt_append","fpd70",!1,"38528")),r.isp("slate_tsmt_append","fpd71",!1,"38528")),r.isp("slate_tsmt_append","fpd72",!1,"38528")),r.isp("slate_tsmt_append","fpd73",!1,"38528")),r.isp("slate_tsmt_append","fpd74",!1,"38528")),r.isp("slate_tsmt_append","fpd75",!1,"38528")),r.isp("slate_tsmt_append","fpd76",!1,"38528")),r.isp("slate_tsmt_append","fpd77",!1,"38528")),r.isp("slate_tsmt_append","fpd78",!1,"38528")),r.isp("slate_tsmt_append","fpd79",!1,"38528")),r.isp("slate_tsmt_append","fpd80",!1,"38528")),r.isp("slate_tsmt_append","fpd81",!1,"38528")),r.isp("slate_tsmt_append","fpd82",!1,"38528")),r.isp("slate_tsmt_append","fpd83",!1,"38528")),r.isp("slate_tsmt_append","fpd1",!1,"38528"))),38529:r.q(r.isp("slate_tsmt_append","fpd1439",!1,"38529")),38530:r.q(r.isp("slate_tsmt_append","fpd1438",!1,"38530")),38856:r.q(r.itp("eyeota","6723",!1,"38856")),38982:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Amicus"),r.ge(1)),24192e5)),38983:r.q(r.tw(r.cw(0,r.y(["article","rubric"],119),r.ge(1)),24192e5)),38984:r.q(r.tw(r.cw(0,r.y(["article","rubric"],62),r.ge(1)),24192e5)),38985:r.q(r.tw(r.cw(0,r.y(["article","rubric"],6),r.ge(1)),24192e5)),38986:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Crossword"),r.ge(1)),24192e5)),38987:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Culture Gabfest"),r.ge(1)),24192e5)),38988:r.q(r.tw(r.cw(0,r.y(["article","rubric"],12),r.ge(1)),24192e5)),38989:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Education"),r.ge(1)),24192e5)),38990:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Explainer"),r.ge(1)),24192e5)),38991:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Faith-based"),r.ge(1)),24192e5)),38992:r.q(r.tw(r.cw(0,r.y(["article","rubric"],122),r.ge(1)),24192e5)),38993:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Future Tense"),r.ge(1)),24192e5)),38995:r.q(r.tw(r.cw(0,r.y(["article","rubric"],123),r.ge(1)),24192e5)),38996:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Hang Up and Listen"),r.ge(1)),24192e5)),38997:r.q(r.tw(r.cw(0,r.y(["article","rubric"],23),r.ge(1)),24192e5)),38998:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Jurisprudence"),r.ge(1)),24192e5)),38999:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Medical Examiner"),r.ge(1)),24192e5)),39e3:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Metropolis"),r.ge(1)),24192e5)),39001:r.q(r.tw(r.cw(0,r.y(["article","rubric"],124),r.ge(1)),24192e5)),39002:r.q(r.tw(r.cw(0,r.y(["article","rubric"],64),r.ge(1)),24192e5)),39003:r.q(r.tw(r.cw(0,r.y(["article","rubric"],65),r.ge(1)),24192e5)),39004:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Open Thread"),r.ge(1)),24192e5)),39005:r.q(r.tw(r.cw(0,r.y(["article","rubric"],125),r.ge(1)),24192e5)),39006:r.q(r.tw(r.cw(0,r.y(["article","rubric"],126),r.ge(1)),24192e5)),39007:r.q(r.tw(r.cw(0,r.y(["article","rubric"],127),r.ge(1)),24192e5)),39008:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Relationships"),r.ge(1)),24192e5)),39009:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"School"),r.ge(1)),24192e5)),39010:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Science"),r.ge(1)),24192e5)),39011:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Slate Fare"),r.ge(1)),24192e5)),39012:r.q(r.tw(r.cw(0,r.y(["article","rubric"],128),r.ge(1)),24192e5)),39013:r.q(r.tw(r.cw(0,r.y(["article","rubric"],68),r.ge(1)),24192e5)),39014:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"TV Club"),r.ge(1)),24192e5)),39015:r.q(r.tw(r.cw(0,r.y(["article","rubric"],69),r.ge(1)),24192e5)),39016:r.q(r.tw(r.cw(0,r.y(["article","rubric"],134),r.ge(1)),24192e5)),39017:r.q(r.tw(r.cw(0,r.y(["article","rubric"],70),r.ge(1)),24192e5)),39018:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"The World"),r.ge(1)),24192e5)),39019:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"War Stories"),r.ge(1)),24192e5)),39020:r.q(r.tw(r.cw(0,r.y(["article","rubric"],71),r.ge(1)),24192e5)),39021:r.q(r.tw(r.cw(0,r.pe(["article","rubric"],"Work"),r.ge(1)),24192e5)),39026:r.q(r.ocq(r.lm("070bfedb-56e8-46b3-8b3e-4dd112f98577",r.ge(.7067434)),r.ifp("38529"))),39238:r.q(r.ocq(r.lm("129a3e9c-eb01-4138-b660-3d271e838eab",r.ge(.75521666)),r.ifp("38530"))),39251:r.q(r.ocq(r.itp("eyeota","13206",!1,"39251"),r.itp("eyeota","35388",!1,"39251"))),39342:r.q(r.ocq(r.lm("129a3e9c-eb01-4138-b660-3d271e838eab",r.ge(.62081337)),r.ifp("38530"))),39343:r.q(r.ocq(r.lm("070bfedb-56e8-46b3-8b3e-4dd112f98577",r.ge(.6188574)),r.ifp("38529"))),39346:r.q(r.ocq(r.ocq(r.isp("slate_survey","sur10",!1,"39346"),r.isp("slate_tsmt_append","fpd1439",!1,"39346")),r.isp("slate_piano_append","imp0002",!1,"39346"))),39347:r.q(r.ocq(r.ocq(r.isp("slate_survey","sur11",!1,"39347"),r.isp("slate_tsmt_append","fpd1438",!1,"39347")),r.isp("slate_piano_append","imp0001",!1,"39347"))),39479:r.q(r.itp("eyeota","35598",!1,"39479")),39488:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd9",!1,"39488"),r.isp("slate_tsmt_append","fpd10",!1,"39488")),r.isp("slate_tsmt_append","fpd11",!1,"39488")),r.isp("slate_tsmt_append","fpd12",!1,"39488")),r.isp("slate_tsmt_append","fpd13",!1,"39488")),r.isp("slate_tsmt_append","fpd14",!1,"39488")),r.isp("slate_tsmt_append","fpd15",!1,"39488")),r.isp("slate_tsmt_append","fpd16",!1,"39488")),r.isp("slate_tsmt_append","fpd17",!1,"39488")),r.isp("slate_tsmt_append","fpd18",!1,"39488")),r.isp("slate_tsmt_append","fpd8",!1,"39488")),r.isp("slate_tsmt_append","fpd7",!1,"39488")),r.isp("slate_tsmt_append","fpd6",!1,"39488")),r.isp("slate_tsmt_append","fpd6",!1,"39488")),r.isp("slate_tsmt_append","fpd5",!1,"39488")),r.isp("slate_tsmt_append","fpd4",!1,"39488")),r.isp("slate_tsmt_append","fpd3",!1,"39488")),r.isp("slate_tsmt_append","fpd2",!1,"39488")),r.isp("slate_survey","sur8",!1,"39488")),r.isp("slate_survey","sur5",!1,"39488"))),39489:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd19",!1,"39489"),r.isp("slate_tsmt_append","fpd20",!1,"39489")),r.isp("slate_tsmt_append","fpd21",!1,"39489")),r.isp("slate_tsmt_append","fpd22",!1,"39489")),r.isp("slate_tsmt_append","fpd23",!1,"39489")),r.isp("slate_tsmt_append","fpd24",!1,"39489")),r.isp("slate_tsmt_append","fpd25",!1,"39489")),r.isp("slate_tsmt_append","fpd26",!1,"39489")),r.isp("slate_tsmt_append","fpd27",!1,"39489")),r.isp("slate_tsmt_append","fpd28",!1,"39489")),r.isp("slate_tsmt_append","fpd29",!1,"39489")),r.isp("slate_tsmt_append","fpd30",!1,"39489")),r.isp("slate_tsmt_append","fpd31",!1,"39489")),r.isp("slate_tsmt_append","fpd32",!1,"39489")),r.isp("slate_tsmt_append","fpd33",!1,"39489")),r.isp("slate_tsmt_append","fpd34",!1,"39489")),r.isp("slate_tsmt_append","fpd35",!1,"39489")),r.isp("slate_tsmt_append","fpd36",!1,"39489")),r.isp("slate_tsmt_append","fpd37",!1,"39489")),r.isp("slate_tsmt_append","fpd38",!1,"39489")),r.isp("slate_survey","sur4",!1,"39489")),r.isp("slate_survey","sur3",!1,"39489"))),39490:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd39",!1,"39490"),r.isp("slate_tsmt_append","fpd40",!1,"39490")),r.isp("slate_tsmt_append","fpd41",!1,"39490")),r.isp("slate_tsmt_append","fpd42",!1,"39490")),r.isp("slate_tsmt_append","fpd43",!1,"39490")),r.isp("slate_tsmt_append","fpd44",!1,"39490")),r.isp("slate_tsmt_append","fpd45",!1,"39490")),r.isp("slate_tsmt_append","fpd46",!1,"39490")),r.isp("slate_tsmt_append","fpd47",!1,"39490")),r.isp("slate_tsmt_append","fpd48",!1,"39490")),r.isp("slate_survey","sur6",!1,"39490"))),39491:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd49",!1,"39491"),r.isp("slate_tsmt_append","fpd50",!1,"39491")),r.isp("slate_tsmt_append","fpd51",!1,"39491")),r.isp("slate_tsmt_append","fpd52",!1,"39491")),r.isp("slate_tsmt_append","fpd53",!1,"39491")),r.isp("slate_tsmt_append","fpd54",!1,"39491")),r.isp("slate_tsmt_append","fpd55",!1,"39491")),r.isp("slate_tsmt_append","fpd56",!1,"39491")),r.isp("slate_tsmt_append","fpd57",!1,"39491")),r.isp("slate_tsmt_append","fpd58",!1,"39491")),r.isp("slate_tsmt_append","fpd59",!1,"39491")),r.isp("slate_tsmt_append","fpd60",!1,"39491")),r.isp("slate_tsmt_append","fpd61",!1,"39491")),r.isp("slate_tsmt_append","fpd62",!1,"39491")),r.isp("slate_tsmt_append","fpd63",!1,"39491")),r.isp("slate_tsmt_append","fpd64",!1,"39491")),r.isp("slate_tsmt_append","fpd65",!1,"39491")),r.isp("slate_tsmt_append","fpd66",!1,"39491")),r.isp("slate_tsmt_append","fpd67",!1,"39491")),r.isp("slate_tsmt_append","fpd68",!1,"39491")),r.isp("slate_tsmt_append","fpd69",!1,"39491")),r.isp("slate_tsmt_append","fpd70",!1,"39491")),r.isp("slate_tsmt_append","fpd71",!1,"39491")),r.isp("slate_tsmt_append","fpd72",!1,"39491")),r.isp("slate_tsmt_append","fpd73",!1,"39491")),r.isp("slate_tsmt_append","fpd74",!1,"39491")),r.isp("slate_tsmt_append","fpd75",!1,"39491")),r.isp("slate_tsmt_append","fpd76",!1,"39491")),r.isp("slate_tsmt_append","fpd77",!1,"39491")),r.isp("slate_tsmt_append","fpd78",!1,"39491")),r.isp("slate_tsmt_append","fpd79",!1,"39491")),r.isp("slate_tsmt_append","fpd80",!1,"39491")),r.isp("slate_tsmt_append","fpd81",!1,"39491")),r.isp("slate_tsmt_append","fpd82",!1,"39491")),r.isp("slate_tsmt_append","fpd83",!1,"39491")),r.isp("slate_tsmt_append","fpd1",!1,"39491")),r.isp("slate_survey","sur7",!1,"39491"))),39551:r.q(r.ocq(r.lm("adee6c64-497d-4a9c-b65e-b884aab1d8a5",r.ge(.6614871)),r.ifp("39488"))),39552:r.q(r.ocq(r.lm("0517cb46-d329-441c-bc43-d3a7f35689f5",r.ge(.57649434)),r.ifp("39489"))),39553:r.q(r.ocq(r.lm("f7f0d40b-ec6e-40bc-b146-1fbf794ce9cf",r.ge(.62131226)),r.ifp("39490"))),39554:r.q(r.ocq(r.lm("c21b14bb-895d-4dc6-9460-9b800ef24a61",r.ge(.73867804)),r.ifp("39491"))),39640:r.q(r.isp("slate_tsmt_append","fpd1442",!1,"39640")),40632:r.q(r.isp("slate_tsmt_append","fpd298",!1,"40632")),40633:r.q(r.ocq(r.lm("c21b14bb-895d-4dc6-9460-9b800ef24a61",r.ge(.7025685)),r.ifp("39491"))),40634:r.q(r.ocq(r.lm("f7f0d40b-ec6e-40bc-b146-1fbf794ce9cf",r.ge(.73504466)),r.ifp("39490"))),40635:r.q(r.ocq(r.lm("0517cb46-d329-441c-bc43-d3a7f35689f5",r.ge(.7393019)),r.ifp("39489"))),40636:r.q(r.ocq(r.lm("adee6c64-497d-4a9c-b65e-b884aab1d8a5",r.ge(.68505436)),r.ifp("39488"))),40637:r.q(r.ocq(r.lm("b29d109a-9fcc-4166-99c3-b6720e5b1eb9",r.ge(.7422811)),r.ifp("39347"))),40638:r.q(r.ocq(r.lm("225cabf2-f275-4fa2-8461-c11f1f403c62",r.ge(.79925305)),r.ifp("39346"))),40673:r.q(r.ocq(r.lm("38eb064f-c395-48c2-a1c6-d098dcf63158",r.ge(.52118784)),r.ifp("39640"))),41222:r.q(r.ltn(r.cw(0,r.o([r.os(r.w,["article","pageType"],["homepage","rubric front","vertical front"])]),r.ge(1)),0,1)),41519:r.q(r.ocq(r.lm("c40777c9-2650-4956-849b-d8ddaf3437e2",r.ge(.573153)),r.ifp("40632"))),42001:r.q(r.ocq(r.itp("comscore","321346US",!1,"42001"),r.itp("eyeota","35443",!1,"42001"))),42012:r.q(r.ocq(r.ocq(r.itp("liveramp_Bombora","1005405079",!1,"42012"),r.itp("liveramp_Bombora","1005405089",!1,"42012")),r.itp("liveramp_Bombora","1005405099",!1,"42012"))),42018:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.itp("liveramp_Experian","1004785599",!1,"42018"),r.itp("liveramp_Experian","1004785589",!1,"42018")),r.itp("liveramp_Experian","1004785579",!1,"42018")),r.itp("liveramp_Experian","1004785569",!1,"42018")),r.itp("liveramp_Experian","1004785559",!1,"42018"))),43335:r.q(r.ltn(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[25,187,93,"civil-rights"])]),r.ge(1)),0,1)),43345:r.q(r.ocq(r.ltn(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[1,"Trump"])]),r.ge(1)),0,1),r.ltn(r.cw(0,r.o([r.os(r.cx,["article","concepts"],["Donald Trump",54])]),r.ge(1)),0,1))),43454:r.q(r.isp("slate_podcast_listeners","pod032",!1,"43454")),43531:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.itp("liveramp_Acxiom","300324899",!1,"43531"),r.itp("liveramp_Stirista","1003670859",!1,"43531")),r.itp("liveramp_Stirista","1000302486",!1,"43531")),r.cw(0,r.pc_(["article","categories"],103),r.ge(1))),r.cw(0,r.pc_(["article","categories"],21),r.ge(1))),r.cw(0,r.pc_(["article","categories"],117),r.ge(1))),r.cw(0,r.pc_(["article","categories"],116),r.ge(1))),r.cw(0,r.pc_(["article","categories"],115),r.ge(1))),r.itp("liveramp_Bombora","1005405079",!1,"43531")),r.itp("liveramp_Bombora","1005405089",!1,"43531")),r.itp("liveramp_Bombora","1005405099",!1,"43531")),r.cw(0,r.pc_(["article","categories"],10),r.ge(1))),r.cw(0,r.t,r.ge(1)))),43606:r.q(r.acq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.itp("liveramp_Acxiom","300324899",!1,"43606"),r.itp("liveramp_Stirista","1003670859",!1,"43606")),r.itp("liveramp_Stirista","1000302486",!1,"43606")),r.cw(0,r.pc_(["article","categories"],103),r.ge(1))),r.cw(0,r.pc_(["article","categories"],21),r.ge(1))),r.cw(0,r.pc_(["article","categories"],117),r.ge(1))),r.cw(0,r.pc_(["article","categories"],116),r.ge(1))),r.cw(0,r.pc_(["article","categories"],115),r.ge(1))),r.itp("liveramp_Bombora","1005405079",!1,"43606")),r.itp("liveramp_Bombora","1005405089",!1,"43606")),r.itp("liveramp_Bombora","1005405099",!1,"43606")),r.cw(0,r.pc_(["article","categories"],10),r.ge(1))),r.cw(0,r.t,r.ge(1))),r.itp("liveramp_Experian","1004601399",!1,"43606"))),43738:r.q(r.ocq(r.ltn(r.cw(0,r.o([r.os(r.cx,["article","authors"],["Rachelle Hampton","Jamilah Lemieux","Julia Craven","Aviva Shen","Chau Tu","Shasha Lonard","aymann ismail","joel Anderson","natish pahwa","Allegra Frank","Jason Johnson"])]),r.ge(1)),0,1),r.cw(0,r.o([r.os(r.cx,["article","keywords"],["race",9,"Immigration","Race","BML",3,"Racism"])]),r.ge(1)))),43743:r.q(r.itp("eyeota","35482",!1,"43743")),43762:r.q(r.ocq(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd2247",!1,"43762"),r.isp("slate_tsmt_append","fpd2246",!1,"43762")),r.isp("slate_tsmt_append","fpd2245",!1,"43762")),r.isp("slate_tsmt_append","fpd2248",!1,"43762"))),44405:r.q(r.ocq(r.ltn(r.cw(0,r.o([r.os(r.cx,["article","keywords"],["census",9,"who-counts","daca","alexandra-ocasio-cortez","sonia-sotomayor"])]),r.ge(1)),0,1),r.ltn(r.cw(0,r.pc_(["article","authors"],"leon Krauze"),r.ge(1)),0,1))),44455:r.q(r.ltn(r.cw(0,r.o([r.os(r.w,["article","section"],[66,67])]),r.ge(1)),0,1)),44479:r.q(r.ltn(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[156,0,148,136,137,72,140,141,"ambulance",144,"arrest",145,146,149,26,"boycott","cancer",153,"chokehold",184,"confederate","corona",157,"controversy",7,75,"drug","drunk","epidemic","explode",163,165,"gay",39,166,"hate crime","horror","illegal","incest","infowars","isis","jail","kidnap",17,"mass shooting","missile",46,"nra","nuclear","offensive","overdose","pain",183,"pollution",186,"prison",93,189,"rehab",191,94,193,4,200,201,202,"virus","victim",55,208,"black lives matter","quarantine",30,"airborne","portland","election","explosion",40,3,45,8,1,49,34,2,5,15,24,29,53,20,44,47,41,36,9,174,28,33,4,"africa",37,14,42,43,4,32,31])]),r.ge(1)),0,1)),46522:r.q(r.ltn(r.cw(0,r.y(["article","section"],120),r.ge(1)),0,1)),46524:r.q(r.ltn(r.cw(0,r.y(["article","section"],69),r.ge(1)),0,1)),46525:r.q(r.ltn(r.cw(0,r.y(["article","section"],11),r.ge(1)),0,1)),46913:r.q(r.vq(r.cw(0,r.o([r.os(r.cx,["article","keywords"],["open book","open-book"])]),r.ge(1)))),47261:r.q(r.itp("liveramp_Acxiom","300618399",!1,"47261")),47927:r.q(r.ocq(r.ltn(r.cw(0,r.y(["article","rubric"],127),r.ge(1)),0,1),r.ltn(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[1,"china",5,"Democratic National Convention","democracy",16,185,"republicans",15])]),r.ge(1)),0,1))),48016:r.q(r.isp("slate_tsmt_append","fpd2357",!1,"48016")),49709:r.q(r.isp("slate_tsmt_append","fpd84",!1,"49709")),49710:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2354",!1,"49710"),r.isp("slate_tsmt_append","fpd299",!1,"49710"))),49711:r.q(r.isp("slate_tsmt_append","fpd1400",!1,"49711")),49712:r.q(r.isp("slate_tsmt_append","fpd1404",!1,"49712")),49713:r.q(r.ocq(r.isp("slate_tsmt_append","fpd1440",!1,"49713"),r.isp("slate_tsmt_append","fpd2366",!1,"49713"))),49714:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2350",!1,"49714"),r.isp("slate_tsmt_append","fpd85",!1,"49714"))),49717:r.q(r.ocq(r.isp("slate_tsmt_append","fpd298",!1,"49717"),r.isp("slate_tsmt_append","fpd2353",!1,"49717"))),49718:r.q(r.isp("slate_tsmt_append","fpd1399",!1,"49718")),49719:r.q(r.isp("slate_tsmt_append","fpd1403",!1,"49719")),49720:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2088",!1,"49720"),r.isp("slate_tsmt_append","fpd2445",!1,"49720"))),49721:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2449",!1,"49721"),r.isp("slate_tsmt_append","fpd2092",!1,"49721"))),49722:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2236",!1,"49722"),r.isp("slate_tsmt_append","fpd2469",!1,"49722"))),49723:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2472",!1,"49723"),r.isp("slate_tsmt_append","fpd2244",!1,"49723"))),49724:r.q(r.isp("slate_tsmt_append","fpd2344",!1,"49724")),49725:r.q(r.isp("slate_tsmt_append","fpd2348",!1,"49725")),49726:r.q(r.isp("slate_tsmt_append","fpd2352",!1,"49726")),49727:r.q(r.isp("slate_tsmt_append","fpd2356",!1,"49727")),49728:r.q(r.isp("slate_tsmt_append","fpd2360",!1,"49728")),49729:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2368",!1,"49729"),r.isp("slate_tsmt_append","fpd1442",!1,"49729"))),49730:r.q(r.isp("slate_tsmt_append","fpd2372",!1,"49730")),49731:r.q(r.isp("slate_tsmt_append","fpd2376",!1,"49731")),49732:r.q(r.isp("slate_tsmt_append","fpd2380",!1,"49732")),49733:r.q(r.isp("slate_tsmt_append","fpd2432",!1,"49733")),49734:r.q(r.isp("slate_tsmt_append","fpd2436",!1,"49734")),49735:r.q(r.isp("slate_tsmt_append","fpd2440",!1,"49735")),49736:r.q(r.isp("slate_tsmt_append","fpd2444",!1,"49736")),49737:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2091",!1,"49737"),r.isp("slate_tsmt_append","fpd2448",!1,"49737"))),49738:r.q(r.isp("slate_tsmt_append","fpd2452",!1,"49738")),49739:r.q(r.isp("slate_tsmt_append","fpd2456",!1,"49739")),49740:r.q(r.isp("slate_tsmt_append","fpd2460",!1,"49740")),49741:r.q(r.isp("slate_tsmt_append","fpd2464",!1,"49741")),49742:r.q(r.isp("slate_tsmt_append","fpd2468",!1,"49742")),49744:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2243",!1,"49744"),r.isp("slate_tsmt_append","fpd2471",!1,"49744"))),49745:r.q(r.isp("slate_tsmt_append","fpd1398",!1,"49745")),49746:r.q(r.isp("slate_tsmt_append","fpd1402",!1,"49746")),49748:r.q(r.isp("slate_tsmt_append","fpd2343",!1,"49748")),49749:r.q(r.isp("slate_tsmt_append","fpd2355",!1,"49749")),49750:r.q(r.isp("slate_tsmt_append","fpd2359",!1,"49750")),49751:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2367",!1,"49751"),r.isp("slate_tsmt_append","fpd1441",!1,"49751"))),49752:r.q(r.isp("slate_tsmt_append","fpd2371",!1,"49752")),49753:r.q(r.isp("slate_tsmt_append","fpd2375",!1,"49753")),49754:r.q(r.isp("slate_tsmt_append","fpd2379",!1,"49754")),49755:r.q(r.isp("slate_tsmt_append","fpd2431",!1,"49755")),49756:r.q(r.isp("slate_tsmt_append","fpd2435",!1,"49756")),49757:r.q(r.isp("slate_tsmt_append","fpd2439",!1,"49757")),49758:r.q(r.isp("slate_tsmt_append","fpd2443",!1,"49758")),49759:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2447",!1,"49759"),r.isp("slate_tsmt_append","fpd2090",!1,"49759"))),49760:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2094",!1,"49760"),r.isp("slate_tsmt_append","fpd2451",!1,"49760"))),49761:r.q(r.isp("slate_tsmt_append","fpd2455",!1,"49761")),49762:r.q(r.isp("slate_tsmt_append","fpd2459",!1,"49762")),49763:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2138",!1,"49763"),r.isp("slate_tsmt_append","fpd2463",!1,"49763"))),49764:r.q(r.isp("slate_tsmt_append","fpd2467",!1,"49764")),49765:r.q(r.isp("slate_tsmt_append","fpd1397",!1,"49765")),49766:r.q(r.isp("slate_tsmt_append","fpd1401",!1,"49766")),49767:r.q(r.isp("slate_tsmt_append","fpd1405",!1,"49767")),49859:r.q(r.isp("slate_tsmt_append","fpd2342",!1,"49859")),49860:r.q(r.isp("slate_tsmt_append","fpd2346",!1,"49860")),49861:r.q(r.isp("slate_tsmt_append","fpd2358",!1,"49861")),49862:r.q(r.isp("slate_tsmt_append","fpd2362",!1,"49862")),49863:r.q(r.isp("slate_tsmt_append","fpd2370",!1,"49863")),49864:r.q(r.isp("slate_tsmt_append","fpd2374",!1,"49864")),49865:r.q(r.isp("slate_tsmt_append","fpd2378",!1,"49865")),49866:r.q(r.isp("slate_tsmt_append","fpd2430",!1,"49866")),49867:r.q(r.isp("slate_tsmt_append","fpd2434",!1,"49867")),49868:r.q(r.isp("slate_tsmt_append","fpd2438",!1,"49868")),49869:r.q(r.isp("slate_tsmt_append","fpd2442",!1,"49869")),49870:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2446",!1,"49870"),r.isp("slate_tsmt_append","fpd2089",!1,"49870"))),49871:r.q(r.ocq(r.isp("slate_tsmt_append","fpd2450",!1,"49871"),r.isp("slate_tsmt_append","fpd2093",!1,"49871"))),49872:r.q(r.isp("slate_tsmt_append","fpd2454",!1,"49872")),49873:r.q(r.isp("slate_tsmt_append","fpd2458",!1,"49873")),49874:r.q(r.isp("slate_tsmt_append","fpd2462",!1,"49874")),49875:r.q(r.isp("slate_tsmt_append","fpd2466",!1,"49875")),49876:r.q(r.isp("slate_tsmt_append","fpd2470",!1,"49876")),49877:r.q(r.isp("slate_tsmt_append","fpd2341",!1,"49877")),49878:r.q(r.isp("slate_tsmt_append","fpd2345",!1,"49878")),49879:r.q(r.isp("slate_tsmt_append","fpd2349",!1,"49879")),49880:r.q(r.isp("slate_tsmt_append","fpd2357",!1,"49880")),49881:r.q(r.isp("slate_tsmt_append","fpd2361",!1,"49881")),49882:r.q(r.isp("slate_tsmt_append","fpd2365",!1,"49882")),49883:r.q(r.isp("slate_tsmt_append","fpd2369",!1,"49883")),49884:r.q(r.isp("slate_tsmt_append","fpd2373",!1,"49884")),49885:r.q(r.isp("slate_tsmt_append","fpd2377",!1,"49885")),49886:r.q(r.isp("slate_tsmt_append","fpd2381",!1,"49886")),49887:r.q(r.isp("slate_tsmt_append","fpd2429",!1,"49887")),49888:r.q(r.isp("slate_tsmt_append","fpd2433",!1,"49888")),49889:r.q(r.isp("slate_tsmt_append","fpd2437",!1,"49889")),49890:r.q(r.isp("slate_tsmt_append","fpd2441",!1,"49890")),49891:r.q(r.isp("slate_tsmt_append","fpd2453",!1,"49891")),49892:r.q(r.isp("slate_tsmt_append","fpd2457",!1,"49892")),49893:r.q(r.isp("slate_tsmt_append","fpd2461",!1,"49893")),49894:r.q(r.isp("slate_tsmt_append","fpd2465",!1,"49894")),49895:r.q(r.isp("slate_tsmt_append","fpd2473",!1,"49895")),52308:r.q(r.ocq(r.lm("4a08cd12-0dce-4312-a82f-99e31cf84668",r.ge(.61991125)),r.ifp("32595"))),52434:r.q(r.ocq(r.lm("611c11fc-0796-4b56-8279-251f53989759",r.ge(.80086505)),r.ifp("49709"))),52435:r.q(r.ocq(r.lm("de9e7899-5e5b-4a3f-8488-5cdc7e642956",r.ge(.5974794)),r.ifp("49725"))),52436:r.q(r.ocq(r.lm("b5c37087-a362-4309-aa28-b48d26e35f4e",r.ge(.77968264)),r.ifp("49726"))),52437:r.q(r.ocq(r.lm("fe52a157-91e3-44f0-81a3-120cecf7b2ad",r.ge(.48431373)),r.ifp("49727"))),52438:r.q(r.ocq(r.lm("e900afaa-c330-4f68-8d95-8d3ca4c7087e",r.ge(.77966475)),r.ifp("49730"))),52439:r.q(r.ocq(r.lm("74a6876a-69c8-41e3-ba68-a8414e4a0a64",r.ge(.52023757)),r.ifp("49731"))),52440:r.q(r.ocq(r.lm("fae4cf4d-4f6a-4d36-abae-e7888e81f041",r.ge(.5497731)),r.ifp("49732"))),52441:r.q(r.ocq(r.lm("32bee6b8-f26f-41c1-ad7a-191ba8ec46e8",r.ge(.6564127)),r.ifp("49739"))),52442:r.q(r.ocq(r.lm("945333a3-42b5-47c7-92d6-655a1b27fbf2",r.ge(.6524828)),r.ifp("49740"))),52444:r.q(r.ocq(r.lm("5039f895-e421-4bd5-ae46-3ff67a968c1b",r.ge(.21789598)),r.ifp("49741"))),52445:r.q(r.ocq(r.lm("808e8111-7b30-4fc7-9f9f-6d9c18c91761",r.ge(.47980398)),r.ifp("49742"))),52446:r.q(r.ocq(r.lm("7c5ddbbd-43c7-4a31-8d2d-2a448d0577df",r.ge(.50260884)),r.ifp("49752"))),52447:r.q(r.ocq(r.lm("537eeac8-2483-4955-962d-847a2e90434b",r.ge(.7702769)),r.ifp("49753"))),52448:r.q(r.ocq(r.lm("6e98a079-2838-43fc-b3db-42797ae23be4",r.ge(.5054306)),r.ifp("49754"))),52449:r.q(r.ocq(r.lm("1c2bb661-8cb6-42dd-932d-76372e76ff53",r.ge(.48628315)),r.ifp("49755"))),52450:r.q(r.ocq(r.lm("163ddc50-6f87-47c0-9e1a-68913129c69d",r.ge(.24716333)),r.ifp("49763"))),52455:r.q(r.ocq(r.lm("2dcd85c9-2933-4a27-aa2e-3b4cd4538fda",r.ge(.8157696)),r.ifp("49764"))),52456:r.q(r.ocq(r.lm("a0736834-8759-405a-9a02-a03606742a42",r.ge(.2892445)),r.ifp("49862"))),52457:r.q(r.ocq(r.lm("2715edff-3831-4e9a-818a-f195c21c31fa",r.ge(.5811558)),r.ifp("49863"))),52458:r.q(r.ocq(r.lm("b957e745-fe4e-412e-829a-0a63d25367b6",r.ge(.48221204)),r.ifp("49864"))),52459:r.q(r.ocq(r.lm("9b993206-1dba-4fab-8006-37de4794769f",r.ge(.8536796)),r.ifp("49865"))),52460:r.q(r.ocq(r.lm("e2171f55-5626-42fa-bd39-b736b8cc3db4",r.ge(.55962586)),r.ifp("49866"))),52532:r.q(r.ocq(r.lm("e9ac526b-3295-4ef4-9c73-b5c3ebe1aad8",r.ge(.82157475)),r.ifp("49875"))),52533:r.q(r.ocq(r.lm("08aa7ec2-6c76-4eb2-bc7a-da60f2726342",r.ge(.44772744)),r.ifp("49876"))),52534:r.q(r.ocq(r.lm("52738ae9-e64c-47ff-9a75-12c2ab798a5b",r.ge(.42888185)),r.ifp("49879"))),52535:r.q(r.ocq(r.lm("9f9b28cf-377c-43e7-9004-973ae48e80cd",r.ge(.489039)),r.ifp("49880"))),52536:r.q(r.ocq(r.lm("499df16f-48f1-4f52-ad9d-2799e80a948d",r.ge(.71007496)),r.ifp("49882"))),52537:r.q(r.ocq(r.lm("c01326d9-c60d-4a56-b6be-8c9bf54f78ec",r.ge(.67826116)),r.ifp("49883"))),52538:r.q(r.ocq(r.lm("043e141f-cbdc-4211-8dd2-a8983a2a94dc",r.ge(.80656147)),r.ifp("49887"))),52539:r.q(r.ocq(r.lm("87370623-f82b-450c-a88c-d2d1c6475ec7",r.ge(.6814409)),r.ifp("49894"))),52540:r.q(r.ocq(r.lm("d3a8bd1a-a0ef-4382-8a76-ea2cdf18c5cc",r.ge(.777767)),r.ifp("49884"))),52541:r.q(r.ocq(r.lm("0e1abfe5-37d6-4935-ba73-f0865cd1d1bf",r.ge(.44867384)),r.ifp("49885"))),52542:r.q(r.ocq(r.lm("2de0fecc-a1fb-4345-878d-2d92f4503932",r.ge(.7650775)),r.ifp("49886"))),52543:r.q(r.ocq(r.lm("5bff675b-2b0c-475b-8ce0-1651a8859dbe",r.ge(.7914224)),r.ifp("49895"))),53304:r.q(r.cw(0,r.o([r.y(["article","rubric"],119),r.os(r.cx,["article","keywords"],["books","slate-book-review"]),r.pc_(["article","authors"],"Laura Miller")]),r.ge(1))),55909:r.q(r.ocq(r.lm("63c35355-1030-431c-b244-e6c85fc43d06",r.ge(.56997377)),r.ifp("49749"))),55910:r.q(r.ocq(r.lm("167674ee-b672-4a6d-953e-f1005b49b641",r.ge(.5425475)),r.ifp("49717"))),55916:r.q(r.cw(2,r.pe(["line_item_id"],5490149973),r.ge(1))),55922:r.q(r.cw(1,r.pe(["line_item_id"],5490149973),r.ge(1))),55923:r.q(r.cw(2,r.o([r.os(r.e,["line_item_id"],[5491374713,5490149973])]),r.ge(1))),55924:r.q(r.ocq(r.cw(1,r.o([r.os(r.e,["line_item_id"],[5491374713,5490149973])]),r.ge(1)),r.cw(2,r.o([r.os(r.e,["line_item_id"],[5491374713,5490149973])]),r.ge(1)))),56321:r.q(r.acq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd2455",!1,"56321"),r.isp("slate_tsmt_append","fpd2461",!1,"56321")),r.isp("slate_tsmt_append","fpd2459",!1,"56321")),r.isp("slate_tsmt_append","fpd2459",!1,"56321")),r.isp("slate_tsmt_append","fpd2462",!1,"56321")),r.isp("slate_tsmt_append","fpd2457",!1,"56321")),r.isp("slate_tsmt_append","fpd2458",!1,"56321")),r.isp("slate_tsmt_append","fpd2456",!1,"56321")),r.isp("slate_tsmt_append","fpd2454",!1,"56321")),r.fm(r.n0,r.isp("slate_tsmt_append","fpd2460",!0,"56321")))),56791:r.q(r.ocq(r.ocq(r.vq(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[30,40,3,45,8,1,49,34,2,5,15,24,29,53,20,44,47,41,36,9,28,33,37,14,42,43,32,31,90,85,78,100,77,16,95,89,98,99,97,79,88,83,0,84,7,207,74,51,35,86,2,76,38,73,81,118,96,82,25,50,27])]),r.ge(1))),r.vq(r.cw(0,r.o([r.os(r.s,["client","url"],["Wells Fargo",118])]),r.ge(1)))),r.vq(r.cw(0,r.o([r.os(r.cx,["article","categories"],[107,10,59,111,61,60,21])]),r.ge(1))))),56898:r.q(r.cw(0,r.o([r.os(r.cx,["article","keywords"],["Slack","Zoom","Google","Yahoo","Comcast","IBM","Intel","Apple","Oracle","computer","laptop","email","virtual"])]),r.ge(1))),56996:r.q(r.ocq(r.lm("b1ac65dc-94db-481c-bfe7-5fb86e241a63",r.ge(.3908372)),r.ifp("56321"))),57396:r.q(r.ocq(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd2461",!1,"57396"),r.isp("slate_tsmt_append","fpd2459",!1,"57396")),r.isp("slate_tsmt_append","fpd2457",!1,"57396")),r.isp("slate_tsmt_append","fpd2456",!1,"57396"))),57397:r.q(r.ocq(r.ocq(r.isp("slate_tsmt_append","fpd2455",!1,"57397"),r.isp("slate_tsmt_append","fpd2458",!1,"57397")),r.isp("slate_tsmt_append","fpd2454",!1,"57397"))),57436:r.q(r.isp("slate_survey","sur69",!1,"57436")),57845:r.q(r.itp("eyeota","61",!1,"57845")),57891:r.q(r.ocq(r.lm("f37c8c69-1a23-4853-937e-92d6442a239c",r.ge(.4928734)),r.ifp("57436"))),59308:r.q(r.ocq(r.vq(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[30,40,3,45,8,1,49,34,2,5,15,24,29,53,20,44,47,41,36,9,28,33,37,14,42,43,32,31,90,85,78,100,77,16,95,89,98,99,97,79,88,83,0,84,7,207,74,51,35,86,2,76,38,73,81,96,82,25,50,27,203,181,162,18,4,91,143,194,39,198,175,151,138,52,142,147,210,17,172,19,75,206])]),r.ge(1))),r.vq(r.cw(0,r.o([r.os(r.cx,["article","categories"],[58,60,22,59,114,61,112])]),r.ge(1))))),59848:r.q(r.vq(r.cw(0,r.o([r.os(r.cx,["article","keywords"],["the-slate-quiz","quizzes",134,"games","Games","crossword"])]),r.ge(1)))),6e4:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.tw(r.cw(0,r.o([r.os(r.w,["article","section"],[67,66])]),r.ge(1)),6048e5),r.ltn(r.cw(4,r.o([r.os(r.w,["newsletters"],[133,135,70])]),r.ge(1)),4,1)),r.ltn(r.cw(1,r.o([r.os(r.e,["creative_id"],[5214898785,5215655183])]),r.ge(1)),1,1)),r.isp("slate_podcast_listeners","pod001",!1,"60000")),r.isp("slate_podcast_listeners","pod014",!1,"60000")),r.isp("slate_podcast_listeners","pod026",!1,"60000"))),60006:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.vq(r.cw(0,r.y(["article","section"],11),r.ge(1))),r.vq(r.cw(0,r.pc_(["article","keywords"],13),r.ge(1)))),r.cw(0,r.o([r.os(r.cx,["article","concepts"],[105,13,56])]),r.ge(1))),r.isp("slate_podcast_listeners","pod016",!1,"60006")),r.isp("slate_podcast_listeners","pod029",!1,"60006")),r.isp("slate_podcast_listeners","pod032",!1,"60006"))),60125:r.q(r.ocq(r.ocq(r.itp("liveramp_Stirista","1000303706",!1,"60125"),r.itp("liveramp_Kantar","1006585261",!1,"60125")),r.itp("liveramp_Kantar","1004734889",!1,"60125"))),60138:r.q(r.ltn(r.cw(0,r.y(["article","sentiment"],92),r.ge(1)),0,1)),60214:r.q(r.ltn(r.cw(0,r.o([r.os(r.cx,["article","entities"],["Trump - negative","Congress - negative","Donald Trump - negative","Facebook - negative","Texas - negative","Biden - negative","America - negative","Joe Biden - negative","Capitol Police - negative","Capitol Police - positive","D.C. - negative","White House - negative","GOP - negative","Electoral College - negative","COVID - negative","plague - negative"])]),r.ge(1)),0,1)),60602:r.q(r.vq(r.cw(0,r.y(["article","rubric"],23),r.ge(1)))),60671:r.q(r.itp("liveramp_Bombora","1004559099",!1,"60671")),61707:r.q(r.cw(0,r.t,r.ge(1))),62290:r.q(r.vq(r.cw(2,r.o([r.os(r.w,["slot","slot_element_id"],[192,176,"mob-adhesion-amp"])]),r.ge(1)))),62873:r.q(r.cw(0,r.o([r.os(r.w,["article","rubric"],[123,"Gizmos"])]),r.ge(1))),63035:r.q(r.vq(r.cw(0,r.o([r.os(r.w,["article","rubric"],[12,23])]),r.ge(1)))),65127:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.isp("slate_podcast_listeners","pod042",!1,"65127"),r.isp("slate_podcast_listeners","pod039",!1,"65127")),r.isp("slate_podcast_listeners","pod041",!1,"65127")),r.isp("slate_podcast_listeners","pod035",!1,"65127")),r.isp("slate_podcast_listeners","pod037",!1,"65127")),r.isp("slate_podcast_listeners","pod044",!1,"65127")),r.isp("slate_podcast_listeners","pod036",!1,"65127")),r.isp("slate_podcast_listeners","pod038",!1,"65127")),r.isp("slate_podcast_listeners","pod043",!1,"65127")),r.isp("slate_podcast_listeners","pod040",!1,"65127"))),65128:r.q(r.isp("slate_podcast_listeners","pod034",!1,"65128")),66791:r.q(r.ocq(r.vq(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[30,40,3,45,8,1,49,34,2,5,15,24,29,53,20,44,47,41,36,9,28,33,37,14,42,43,32,31,90,85,78,100,77,16,95,89,98,99,97,79,88,83,0,84,7,74,51,35,86,2,76,38,73,81,96,82,25,50,27,203,181,162,18,4,91,143,194,39,198,175,151,138,52,142,147,210,17,172,19,75,"AstraZeneca","Pfizer","Moderna",206])]),r.ge(1))),r.vq(r.cw(0,r.o([r.os(r.cx,["article","categories"],[58,60,22,59,114,61,112])]),r.ge(1))))),70728:r.q(r.isp("slate_podcast_listeners","pod045",!1,"70728")),70729:r.q(r.isp("slate_podcast_listeners","pod046",!1,"70729")),70743:r.q(r.ocq(r.ocq(r.ocq(r.vq(r.cw(0,r.o([r.os(r.w,["article","rubric"],[124,128])]),r.ge(1))),r.isp("slate_podcast_listeners","pod016",!1,"70743")),r.scq(r.cw(3,r.pc(["aggregations","SegmentEntry"],52308)),r.cw(5,r.pe(["segment_number"],52308)),r.ge(1))),r.isp("slate_podcast_listeners","pod013",!1,"70743"))),71317:r.q(r.cw(2,r.pe(["campaign_id"],2809411413),r.ge(1))),72222:r.q(r.ocq(r.lm("48210c9d-d9ef-4367-a54f-af5a53a4fc7d",r.ge(.7352573)),r.ifp("71317"))),72741:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.vq(r.cw(0,r.o([r.os(r.w,["article","rubric"],[6,121])]),r.ge(1))),r.sq(r.cw(0,r.pc_(["article","keywords"],48),r.ge(1)))),r.tw(r.cw(4,r.y(["newsletters"],48),r.ge(1)),2592e6)),r.ltn(r.cw(1,r.pe(["creative_id"],5215395010),r.ge(1)),1,10)),r.isp("slate_podcast_listeners","pod012",!1,"72741")),r.scq(r.tw(r.cw(3,r.pc(["aggregations","SegmentEntry"],41519)),2592e6),r.tw(r.cw(5,r.pe(["segment_number"],41519)),2592e6),r.ge(1))),r.scq(r.sw(3,r.y(["article","rubric"],6),["properties","aggregations","PageviewEngagement","engaged_time"]),r.vq(r.sw("PageviewEngagement",r.y(["article","rubric"],6),["properties","engaged_time"])),r.g(100))),r.cw(0,r.o([r.os(r.cx,["article","categories"],["/family and parenting/children",57,"/family and parenting/adoption","/family and parenting/babies and toddlers","/family and parenting/babies and toddlers/baby food","/family and parenting/parenting teens","/family and parenting/babies and toddlers/baby clothes"])]),r.ge(1)))),72742:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.sq(r.cw(0,r.y(["article","section"],11),r.ge(1))),r.vq(r.cw(0,r.pc_(["article","keywords"],13),r.ge(1)))),r.isp("slate_podcast_listeners","pod016",!1,"72742")),r.isp("slate_podcast_listeners","pod029",!1,"72742")),r.isp("slate_podcast_listeners","pod032",!1,"72742")),r.tw(r.cw("ArticleCompletion",r.y(["article","section"],11),r.ge(1)),2592e6)),r.scq(r.tw(r.cw(3,r.pc(["aggregations","SegmentEntry"],52434)),864e6),r.tw(r.cw(5,r.pe(["segment_number"],52434)),864e6),r.ge(1))),r.scq(r.tw(r.cw(3,r.pc(["aggregations","SegmentEntry"],46525)),864e6),r.tw(r.cw(5,r.pe(["segment_number"],46525)),864e6),r.ge(1)))),72972:r.q(r.ocq(r.lm("70d0fb28-39c1-4134-b5ba-4216cb676e6f",r.ge(.5)),r.ifp("23609"))),73389:r.q(r.tw(r.cw(0,r.y(["article","rubric"],12),r.ge(5)),2592e6)),73412:r.q(r.ocq(r.lm("fc2eed6e-a6dc-49e2-acda-5b29c73e9c58",r.ge(.66113114)),r.ifp("72742"))),73424:r.q(r.tw(r.cw(0,r.a([r.y(["article","rubric"],12),r.pe(["client","type"],"amp")]),r.ge(1)),24192e5)),73426:r.q(r.cw(0,r.o([r.os(r.cx,["article","keywords"],["Cryptocurrency","bitcoin","crypto","cryptocurrency"])]),r.ge(1))),73565:r.q(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.ocq(r.vq(r.cw(0,r.o([r.os(r.w,["article","rubric"],[64,132,71,65,62])]),r.ge(1))),r.vq(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[177,131])]),r.ge(1)))),r.isp("slate_podcast_listeners","pod003",!1,"73565")),r.isp("slate_podcast_listeners","pod015",!1,"73565")),r.isp("slate_podcast_listeners","pod018",!1,"73565")),r.isp("slate_podcast_listeners","pod005",!1,"73565")),r.isp("slate_podcast_listeners","pod008",!1,"73565")),r.isp("slate_podcast_listeners","pod045",!1,"73565")),r.vq(r.cw(0,r.y(["article","section"],120),r.ge(1))))),74375:r.q(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[205,"Travel","airbnb","the-easy-rider-road-trip"])]),r.ge(1))),76458:r.q(r.itp("eyeota","1468",!1,"76458")),76925:r.q(r.ocq(r.ocq(r.ocq(r.vq(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[167,168,"design","health","interior-design","fitness","real estate","architecture",205])]),r.ge(1))),r.vq(r.cw(0,r.o([r.os(r.cx,["article","concepts"],["bedroom",168,"room",167,"physical exercise","cycling","exercise","weight training"])]),r.ge(1)))),r.vq(r.cw(0,r.o([r.os(r.cx,["article","keywords"],[80,"personal finance",179])]),r.ge(1)))),r.isp("slate_podcast_listeners","pod016",!1,"76925"))),77155:r.q(r.vq(r.cw(2,r.o([r.os(r.w,["slot","slot_element_id"],["rr-flex-1","mid-article-spot-5","mid-article-spot-3","mid-article-spot-4","mid-article-box-2","mid-article-box-1","mid-article-box-5","mid-article-box-4",176,"mid-article-spot-2",192,"mid-article-spot-1","mid-article-box-3"])]),r.ge(1)))),79429:r.q(r.ocq(r.lm("225cabf2-f275-4fa2-8461-c11f1f403c62",r.ge(.5162665)),r.ifp("39346"))),80805:r.q(r.cw(0,r.o([r.os(r.cx,["article","concepts"],["Sexual intercourse","Human sexuality","Human sexual behavior","Adultery","Sexual arousal","Sex","Pornography",8,195,19,55,18,197,17,164,152,94,72,139,87,161,155,154,204,130,54,91,160,190,52,171,170,169,173,209,158,159,199,26,150,"Homosexuality","Heterosexuality","Death",46,178,"antisemitism","cohen","mueller",188,3]),r.os(r.cx,["article","keywords"],[4,"sexual intercourse","adultery","sexual arousal",50,8,195,19,55,18,197,17,164,152,94,72,139,161,155,154,204,"nicotine",130,87,54,"poltics",160,190,52,171,170,169,173,209,199,158,159,26,150,"homosexual","heterosexual",7,46,178,"antisemtism","michael-cohen","Brett Kavanaugh",188,3])]),r.ge(1)))},i=["Pageview","SlotClicked","SlotViewable","PageviewComplete","Newsletter","SegmentEntry","LinkClick"],o=["coronavirus","donald-trump","congress","racism","sex","2020-campaign","Care and Feeding","death","guns","immigration","/finance/financial news","Business","Dear Prudence","business","coronavirus-diaries","democrats","joe-biden","kill","murder","shooting","suicide","/news/national news","/society/dating","How to Do It","anthony-fauci","black-lives-matter","bomb","climate-change","confederacy","conspiracy-theories","covid-19","dating-and-relationships","dear-prudence","democratic-national-convention","disasters","environment","foreign-policy","free-speech-project","google","gun","hateful","israel","kenosha-shootings","law-enforcement","middle-east","military","nazi","palestine","parenting","police-violence","pornography","privacy","religion","sexual-assault","trump","violence","/business and industrial/business news","/family and parenting","/law, govt and politics/government","/law, govt and politics/politics/elections/presidential elections","/society/sex","/society/unrest and war","Brow Beat","Five-ring Circus","Movies","Music","News & Politics","News and Politics","Sports","Technology","The Slatest","Wide Angle","alcohol","banking","cybersecurity","disaster","economy","election-security","elections","facebook","finance","fraud","george-floyd","georgia","health-care","judiciary","kamala-harris","marijuana","misinformation","mitch-mcconnell","north-carolina","politics","positive","protest","riot","senate","steve-bannon","stormy-daniels","supreme-court","us-postal-service","voting","/art and entertainment","/art and entertainment/comics and animation","/art and entertainment/shows and events","/business and industrial","/business and industrial/business operations/business plans","/finance","/finance/bank","/food and drink","/food and drink/desserts and baking","/food and drink/healthy eating","/law, govt and politics","/religion and spirituality/christianity","/society/crime","/society/racism","/technology and computing/internet technology","/technology and computing/internet technology/social network","/technology and computing/internet technology/web search/people search","Bank of America","Books","Culture","Family","Food","Gaming","Moneybox","Outward","Picks","Politics","Slate Money","Sports Nut","THC","TV","Television","The Hot Seats","The Slate Quiz","The Surge","abuse","accident","advice","alcoholic","alex jones","alt right","antifa","arab","armed","assault","attack","bernie-sanders","biden","blood","bombing","capitol-riot","casino","cdc","cigar","cigarette","covid","covid19","crime","criminal","democrat","drugs","fingering","firearm","gamble","george floyd","harassment","home","house","iran","iraq","islam","killing","knife","lgbtq","masturbate","mob-adhesion-1","movies","nazism","newlywed finances","olympics","orgasm","pandemic","pedophile","police","polls","porn","protests","putin","rape","republican","rifle","rr-article-flex-1","scandal","secret","shoot","sports","stab","stealing","suicide bomber","terror","terrorism","threat","threesome","tobacco","travel","vaccine","vaccines","war","war crime","wound"];const c={"!UpdateLookalikeModels":["39026","39238","39342","39343","39551","39552","39553","39554","40633","40634","40635","40636","40637","40638","40673","41519","52308","52434","52435","52436","52437","52438","52439","52440","52441","52442","52444","52445","52446","52447","52448","52449","52450","52455","52456","52457","52458","52459","52460","52532","52533","52534","52535","52536","52537","52538","52539","52540","52541","52542","52543","55909","55910","56996","57891","72222","72972","73412","79429"],"!UpdateSecondPartyData":["23609","27091","29809","32016","32017","32035","32036","32037","32038","32039","32040","32091","32092","32093","32096","32097","32098","32099","32100","32101","32102","32103","32104","32105","32106","32107","32108","32109","32110","32111","32112","32593","32594","32595","32954","33106","33162","33170","33229","38518","38519","38523","38524","38526","38528","38529","38530","39346","39347","39488","39489","39490","39491","39640","40632","43454","43762","48016","49709","49710","49711","49712","49713","49714","49717","49718","49719","49720","49721","49722","49723","49724","49725","49726","49727","49728","49729","49730","49731","49732","49733","49734","49735","49736","49737","49738","49739","49740","49741","49742","49744","49745","49746","49748","49749","49750","49751","49752","49753","49754","49755","49756","49757","49758","49759","49760","49761","49762","49763","49764","49765","49766","49767","49859","49860","49861","49862","49863","49864","49865","49866","49867","49868","49869","49870","49871","49872","49873","49874","49875","49876","49877","49878","49879","49880","49881","49882","49883","49884","49885","49886","49887","49888","49889","49890","49891","49892","49893","49894","49895","56321","57396","57397","57436","60000","60006","65127","65128","70728","70729","70743","72741","72742","73565","76925"],"!UpdateThirdPartyData":["23760","23844","23845","24377","24378","24393","25108","30268","31648","36803","36990","38060","38062","38163","38311","38856","39251","39479","42001","42012","42018","43531","43606","43743","47261","57845","60125","60671","76458"],ArticleCompletion:["72742"],LinkClick:["29811","33170"],Newsletter:["27091","29809","60000","72741"],Pageview:["10000000","10000001","10000002","10000003","10000004","10000005","10000006","10000007","10000008","10000010","10000011","10000012","10000013","10000014","10000015","10000016","10000017","10000018","10000019","10000020","10000021","10000022","10000023","10000024","10000025","10000026","10000035","10000036","10000037","10000038","10000039","10000040","10000041","10000042","10000043","10000044","10000045","10000046","10000047","10000048","10000049","10000050","10000051","10000052","10000053","10000054","10000056","10000058","10000059","10000060","10000062","10000063","10000064","10000065","10000066","10000067","10000068","10000069","10000070","10000071","10000072","10000073","10000074","10000075","10000076","10000077","10000078","10000079","10000080","10000081","10000082","10000083","10000084","10000085","10000086","10000087","10000088","10000090","21247","21634","23609","24351","24847","25666","27091","27290","27455","29015","29809","29811","29813","29823","31955","32795","32797","32798","32954","33023","33024","33106","33158","33162","33170","33229","38338","38982","38983","38984","38985","38986","38987","38988","38989","38990","38991","38992","38993","38995","38996","38997","38998","38999","39000","39001","39002","39003","39004","39005","39006","39007","39008","39009","39010","39011","39012","39013","39014","39015","39016","39017","39018","39019","39020","39021","41222","43335","43345","43531","43606","43738","44405","44455","44479","46522","46524","46525","46913","47927","53304","56791","56898","59308","59848","60000","60006","60138","60214","60602","61707","62873","63035","66791","70743","72741","72742","73389","73424","73426","73565","74375","76925","80805"],PageviewComplete:["70743","72741","72742"],PageviewEngagement:["72741"],ProductClick:["29813"],SegmentEntry:["39026","39238","39342","39343","39551","39552","39553","39554","40633","40634","40635","40636","40637","40638","40673","41519","52308","52434","52435","52436","52437","52438","52439","52440","52441","52442","52444","52445","52446","52447","52448","52449","52450","52455","52456","52457","52458","52459","52460","52532","52533","52534","52535","52536","52537","52538","52539","52540","52541","52542","52543","55909","55910","56996","57891","70743","72222","72741","72742","72972","73412","79429"],SegmentExit:["39026","39238","39342","39343","39551","39552","39553","39554","40633","40634","40635","40636","40637","40638","40673","41519","52308","52434","52435","52436","52437","52438","52439","52440","52441","52442","52444","52445","52446","52447","52448","52449","52450","52455","52456","52457","52458","52459","52460","52532","52533","52534","52535","52536","52537","52538","52539","52540","52541","52542","52543","55909","55910","56996","57891","72222","72972","73412","79429"],SlotClicked:["25971","27091","29809","36650","55922","55924","60000","72741"],SlotViewable:["55916","55923","55924","62290","71317","77155"],Social:["29811"]}||{};return s(a||{},qn(c,{SegmentEntry:de(Ne)(c.SegmentEntry||[],c["!UpdateLookalikeModels"]||[]),SegmentExit:de(Ne)(c.SegmentExit||[],c["!UpdateLookalikeModels"]||[])}))}();let hn={getCurrentTime:()=>new Date,getCurrentSession:()=>"",getCurrentView:()=>"",getSegments:()=>({}),getSegmentsArray:()=>({}),getLookalikeModels:()=>({}),setSegmentActivation:()=>{}};function kn(t,e,n,s,r="event"){let a={diff:{},errors:[]};const i=s.length,o=(t,e,n)=>{switch(t){case"transition":return n===e-1?"transition":"event";default:return t}};for(let c=0;c<i;c++){const p=s[c],l=o(r,i,c),u=xn(Object.assign(Object.assign({},t),a.diff),e,n,p,l);a={diff:Object.assign(Object.assign({},a.diff),u.diff),errors:a.errors.concat(u.errors)}}return a}function xn(t,e,s,a,i="event"){const o=y,c=(t,e)=>{const{is_segment:n,id:i}=e,c=wn(e,["is_segment","id"]),p=yn[t],l=p.lift(a,hn),d=r(Oe(c.state),u(o)),f=r(Oe(l),u(o),(t=>mn(d,t))),_=s[t],m=_?r(Oe(_),u(o),(t=>mn(f,t))):f;return{checksum:c.checksum,activations:c.activations,state:Se(f),result:p.interpret(Se(m),hn)}},p=[],l={},d=function(t,e,n,s){switch(t){case"event":return(null==vn?void 0:vn[s.name])||[];case"transition":return[...(null==vn?void 0:vn[s.name])||[],...vn["!UpdateLookalikeModels"]||[]];case"bootstrap":return((null==vn?void 0:vn[s.name])||[]).filter((t=>void 0!==e[t]));case"updateExternalState":return Object.keys(n);case"updateEnvironment":return[...vn["!UpdateLookalikeModels"]||[],...vn["!UpdateSecondPartyData"]||[],...vn["!UpdateThirdPartyData"]||[]]}}(i,t,s,a),f=d.length;!function(t){if(function(t){return["SegmentEntry","SegmentExit"].includes(t.name)&&void 0!==t.properties.segment_number}(t)){const e=hn.getSegments(),n=Object.assign(Object.assign({},e),{"1p":Object.assign(Object.assign({},e["1p"]),{[t.properties.segment_number]:"SegmentEntry"===t.name})}),s=On(n);return hn.getSegments=()=>n,void(hn.getSegmentsArray=()=>s)}n()}(a);for(let n=0;n<f;n++){const s=d[n],r=t[s]||{checksum:e[s],state:null,result:{result:!1},activations:{}};let a=r;try{a=c(s,r)}catch(t){p.push(`Failed to interpret query ${s}. Got ${t}`)}l[s]=a}return{diff:l,errors:p}}function Sn(t){return(e,n,a)=>{var i;return r((null===(i=t[a])||void 0===i?void 0:i.activations)||{},(t=>s(e in t,t)),(([t,s])=>s[e]=t?ue(Ne)(s[e],[n]):[n]))}}function On(t){return Object.keys(t).reduce(((e,n)=>{const s=Object.keys(t[n]),r=[];return s.forEach((e=>{!0===t[n][e]&&r.push(e)})),e[n]=r,e}),{})}!function(t){const e=self;function n(t,n,s,r){function a(n){if("function"!=typeof e.postMessage)return t.ports[0].postMessage(n);e.postMessage(n)}if(!s)return a([n,null,r]);"undefined"!=typeof console&&"error"in console&&console.error("Worker caught an error:",s),a([n,s])}e.addEventListener("message",(function(e){if(s=e,!Array.isArray(s.data)||2!==s.data.length)return;var s;const r=e.data,[a,i]=r;if("function"==typeof t)return function(t,e,s,r){const a=function(t,e){try{return{res:t(e)}}catch(t){return{err:t}}}(e,r);return Boolean(null===(i=a)||void 0===i?void 0:i.err)?n(t,s,a.err):!(o=a.res)||"object"!=typeof o&&"function"!=typeof o||"function"!=typeof o.then?n(t,s,null,a.res):void a.res.then((function(e){n(t,s,null,e)}),(function(e){n(t,s,e)}));var i,o}(e,t,a,i);n(e,a,new Error("Please pass a function into register()."))}))}((function(t){switch(t.type){case"bootstrap":return function(t,e,n,s,r){const a=On(s.segments);hn={getCurrentTime:()=>new Date,getCurrentSession:()=>s.sessionId,getCurrentView:()=>s.viewId,getSegments:()=>s.segments,getSegmentsArray:()=>a,getLookalikeModels:()=>s.lookalikeModels,setSegmentActivation:(t,e)=>{}};const i=gn(e,((e,n)=>{var s;return(null===(s=t[e])||void 0===s?void 0:s.checksum)===n?J:H({checksum:n,state:null,result:yn[e].interpret(null,hn),activations:{}})}));if(0===r.length)return{diff:Object.assign(Object.assign({},t),i),errors:[]};if(0===Object.keys(i).length)return{diff:t,errors:[]};{const s=kn(i,e,n,r,"bootstrap");return{diff:Object.assign(Object.assign({},t),s.diff),errors:s.errors}}}(t.stateMap,...t.payload);case"updateEnvironment":return function(t,e,n,s){const r=s.segments?jn.concat(hn.getSegments(),s.segments):hn.getSegments(),a=s.segments?On(r):hn.getSegmentsArray();return hn=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},hn),s.viewId?{getCurrentView:()=>s.viewId}:{}),s.sessionId?{getCurrentSession:()=>s.sessionId}:{}),s.lookalikeModels?{getLookalikeModels:()=>s.lookalikeModels}:{}),s.segments?{getSegments:()=>r,getSegmentsArray:()=>a,setSegmentActivation:Sn(t)}:{}),xn(t,e,n,bn,"updateEnvironment")}(t.stateMap,...t.payload);case"updateExternalState":return function(t,e,n){return xn(t,e,n,bn,"updateExternalState")}(t.stateMap,...t.payload);case"process":return kn(t.stateMap,...t.payload);case"processTransitions":return function(t,e,n,s){return kn(t,e,n,s,"transition")}(t.stateMap,...t.payload);case"noop":return{diff:{},errors:[]}}}));const jn={empty:{},concat:(t,e)=>{const n=Object.assign({},t);for(const[t,s]of Object.entries(e))n[t]?n[t]=qn(n[t],s):n[t]=s;return n}}})();',"Worker",void 0,void 0)}const _e=()=>({kind:"null",value:null}),he=e=>({kind:"string",value:e}),ve=e=>({kind:"number",value:e}),be=e=>({kind:"array",value:e}),we=e=>({kind:"object",value:e}),ye=e=>e,qe=()=>({kind:"bottom"}),ke=e=>({kind:"inner",a:e}),Se=e=>({kind:"top",error:e}),xe=e=>({kind:"unbounded",group:e}),Oe=(e,t)=>({kind:"windowed",key:t,group:e}),Ee=(e,t,r)=>({kind:"countLimit",n:r,limit:t,group:e}),Ie=(e,t,r)=>({kind:"uniqueLimit",n:r,limit:t,group:e}),Pe=e=>({kind:"numberGroup",group:e}),Ce=e=>({kind:"stringGroup",group:e}),je=e=>({kind:"tuple",tuple:e}),Ae=e=>({state:e}),Te=(e,t)=>({commands:e,payload:t});function Me(e){switch(e.kind){case"null":return ze.encode(e);case"string":return Ge.encode(e);case"number":return Le.encode(e);case"array":return Re.encode(e);case"object":return $e.encode(e)}}function Ne(e){return null===e?ze.decode(e):"number"==typeof e?Le.decode(e):"string"==typeof e?Ge.decode(e):Array.isArray(e)?Re.decode(e):$e.decode(e)}const De=(t,r)=>(0,e.t$)(`Failed to decode. Input was ${JSON.stringify(t)}. Codec type was ${r}`),ze={encode:e=>null,decode:t=>null===t?(0,e.F2)({kind:"null",value:null}):De(t,"SimpleNull")},Ge={encode:e=>e.value,decode:t=>"string"==typeof t?(0,e.F2)(he(t)):De(t,"SimpleString")},Le={encode:e=>e.value,decode:t=>"number"==typeof t?(0,e.F2)(ve(t)):De(t,"SimpleNumber")},Re={encode:e=>e.value.map(Me),decode:t=>{if(Array.isArray(t)){const r=(0,J.fw)(e.g1)(Ne)(t);return(0,e.UI)(be)(r)}return De(t,"SimpleArray")}},$e={encode:e=>{const t=[...e.value.entries()];return Object.assign({},...Array.from(t,(([e,t])=>({[e]:Me(t)}))))},decode:r=>{if(r&&r.constructor===Object){const n=(0,J.fw)(e.g1)((([r,n])=>(0,t.zG)(Ne(n),(0,e.UI)((e=>(0,t.bc)(r,e))))))(Object.entries(r));return(0,e.UI)((e=>we(new Map([...e]))))(n)}return De(r,"SimpleObject")}};var Ue=__webpack_require__(209);const Ke=(e,t)=>{switch(e.kind){case"bottom":return{kind:"bottom"};case"inner":return ke(t(e.a));case"top":return Se(e.error)}},Be=e=>(0,Ue.Zt)(((t,r)=>{if("bottom"===t.kind&&"bottom"===r.kind)return 0;if("bottom"===t.kind)return-1;if("bottom"===r.kind)return 1;if("top"===t.kind&&"top"===r.kind)return W.Df.compare(t.error,r.error);if("top"===t.kind)return 1;if("top"===r.kind)return-1;if("inner"===t.kind&&"inner"===r.kind)return e.compare(t.a,r.a);throw new Error("Non exhaustive match in extendedAlgebraOrd")}));var Fe=__webpack_require__(885),Je=function(e){return-1===e?1:1===e?-1:0};function We(e,t){return(0,J.oA)(e.map(t))}function Ye(e,t,r,n){const s=(e,t)=>{if(0===e.length)return(0,J.oA)(t.map((e=>(0,F.G)({1:e[1],2:r(F.YP,(0,F.G)(e[2]))}))));if(0===t.length)return(0,J.oA)(e.map((e=>(0,F.G)({1:e[1],2:r((0,F.G)(e[2]),F.YP)}))));if(e.length>0&&t.length>0&&(0,Ue.lt)(n)(e[0][1],t[0][1])){const[n,...i]=e,a=n[1],o=n[2];return(0,J.Ce)({1:a,2:r((0,F.G)(o),F.YP)})(s(i,t))}if(e.length>0&&t.length>0&&(0,Ue.gt)(n)(e[0][1],t[0][1])){const[n,...i]=t,a=n[1],o=n[2];return(0,J.Ce)({1:a,2:r(F.YP,(0,F.G)(o))})(s(e,i))}if(e.length>0&&t.length>0){const[n,...i]=e,[a,...o]=t,c=n[1],u=n[2],l=a[2];return(0,J.Ce)({1:c,2:r((0,F.G)(u),(0,F.G)(l))})(s(i,o))}throw new Error("Non exhaustive match in mapOption2")},i=(0,Ue.Uz)((e=>e[1]))(n),a=(e=>{const t=We(e,(e=>(0,F.pC)(e[2])?(0,F.G)({1:e[1],2:e[2].value}):F.YP));return 0===t.length?F.YP:(0,F.G)(t)})(s((0,J.DY)(i)([...e].map((e=>({1:e[0],2:e[1]})))),(0,J.DY)(i)([...t].map((e=>({1:e[0],2:e[1]}))))));return(0,F.UI)((e=>new Map(e.map((e=>[e[1],e[2]])))))(a)}function He(t,r,n,s){const i=(0,Ue.Uz)((e=>e[0]))(s),a=(0,J.DY)(i)([...r]).reduceRight(((t,r)=>{if((0,e.nM)(t)){const s=n(r[1],t.left);return(0,F.pC)(s)?(0,e.t$)(s.value):(0,e.F2)(r[0])}return t}),(0,e.t$)(t));return(0,F.Uo)(a)}function Ve(e,t){return new Map([...e].map(t))}function Qe(e,t){return new Map([...e].filter(t))}var Ze=__webpack_require__(268),Xe=__webpack_require__(595);function et(e){return(0,F.UI)(at)(function(e){switch(e.state.kind){case"top":return(0,F.G)(he(e.state.error));case"bottom":return F.YP;case"inner":return function(e){return function(e){switch(e.kind){case"numberGroup":case"stringGroup":return tt(e.group);case"tuple":return e.tuple.length>0}}(e.payload)?(0,F.G)(be(function(e,t){const r=(0,F.UI)((e=>(0,J.Ce)(e)(t)))(e);return(0,F.fS)((()=>t))(r)}((0,F.UI)((e=>he(function(e){const t=e=>{switch(e){case"add":return"p";case"mul":return"m";case"max":return"v";case"min":return"n"}},r=e=>1===e[2]?t(e[1]):t(e[1])+JSON.stringify(e[2]);return e.map(r).join("")}(e))))(e.commands),function(e){const r=e=>{switch(e.kind){case"bottom":return{kind:"null",value:null};case"top":return he(e.error);case"inner":return ve(e.a)}},n=e=>We([rt,nt,e=>(0,t.zG)(e,it,we,F.G)],(t=>t(e))),s=e=>We([rt,st,e=>(0,t.zG)(e,it,(e=>Ve(e,(([e,t])=>[JSON.stringify(e),t]))),we,F.G)],(t=>t(e)));switch(e.kind){case"tuple":return e.tuple.map(r);case"stringGroup":return n(e.group);case"numberGroup":return s(e.group)}}(e.payload)))):F.YP}(e.state.a)}}(e))}function tt(e){switch(e.kind){case"unbounded":return e.group.size>0;case"windowed":return e.group.size>0||(0,F.pC)(e.key);case"countLimit":case"uniqueLimit":return e.group.size>0||(0,F.pC)(e.limit)}}function rt(e){switch(e.kind){case"unbounded":return F.YP;case"windowed":return(0,F.G)(he("w"));case"countLimit":return(0,F.G)(he(1===e.n?"x":`x${e.n}`));case"uniqueLimit":return(0,F.G)(he(1===e.n?"u":`u${e.n}`))}}function nt(e){switch(e.kind){case"unbounded":return F.YP;case"windowed":return(0,F.G)(he((0,F.pC)(e.key)?e.key.value:""));case"countLimit":case"uniqueLimit":return(0,F.G)(he((0,F.pC)(e.limit)?e.limit.value:""))}}function st(e){switch(e.kind){case"unbounded":return F.YP;case"windowed":return(0,F.pC)(e.key)?(0,F.G)(ve(e.key.value)):(0,F.G)({kind:"null",value:null});case"countLimit":case"uniqueLimit":return(0,F.pC)(e.limit)?(0,F.G)(ve(e.limit.value)):(0,F.G)({kind:"null",value:null})}}function it(e){switch(e.kind){case"unbounded":case"windowed":case"countLimit":case"uniqueLimit":return e.group}}function at(e){switch(e.kind){case"array":return 0===e.value.length?{kind:"null",value:null}:1===e.value.length?at(e.value[0]):be(e.value.map(at));case"object":return(0,t.zG)(Qe(e.value,(([e,t])=>"null"!==t.kind)),(e=>Ve(e,(e=>[e[0],at(e[1])]))),we);default:return e}}function ot(e){const t=e=>{if(0===e.length)return{kind:"bottom"};const t=(e=>{if(4!==e.length)return F.YP;const[t,r,n,s]=e;if("string"===t.kind&&"string"===r.kind&&"object"===s.kind){const e=(0,F.DT)((e=>ct(e[1].value)&&ut(e[2].value)))({1:t,2:r});return(0,F.UI)((e=>({prim:e[1].value,grp:e[2].value,cutoff:n,m:s.value})))(e)}return F.YP})(e);if((0,F.pC)(t)){const{prim:e,grp:r,cutoff:n,m:s}=t.value,i=lt(n,s,dt(r));return"string"==typeof i?Se(i):ke(Te(pt(e),i))}const r=(e=>{if(3!==e.length)return F.YP;const[t,r,n]=e;if("string"===t.kind&&"object"===n.kind){const e=(0,F.DT)((e=>ut(e.value)))(t);return(0,F.UI)((e=>({grp:e.value,cutoff:r,m:n.value})))(e)}return F.YP})(e);if((0,F.pC)(r)){const{grp:e,cutoff:t,m:n}=r.value,s=lt(t,n,dt(e));return"string"==typeof s?Se(s):ke(Te(F.YP,s))}const n=(e=>{if(2!==e.length)return F.YP;const[t,r]=e;if("string"===t.kind&&"object"===r.kind){const e=(0,F.DT)((e=>ct(e.value)))(t);return(0,F.UI)((e=>({prim:e.value,m:r.value})))(e)}return F.YP})(e);if((0,F.pC)(n)){const{prim:e,m:t}=n.value;return ke(Te(pt(e),Ce(xe(t))))}const s=(e=>{if(1!==e.length)return F.YP;const[t]=e;return"object"===t.kind?(0,F.G)({m:t.value}):F.YP})(e);if((0,F.pC)(s)){const{m:e}=s.value;return ke(Te(F.YP,Ce(xe(e))))}const i=(e=>{if(e.length<1)return F.YP;const[t,...r]=e;if("string"===t.kind){const e=(0,F.DT)((e=>ct(e.value)))(t);return(0,F.UI)((e=>({prim:e.value,rest:r})))(e)}return F.YP})(e);if((0,F.pC)(i)){const{prim:e,rest:t}=i.value;return ke(Te(pt(e),mt(t)))}return ke(Te(F.YP,mt(e)))},r=e=>{switch(e.kind){case"array":return(0,J.tS)(r)(e.value);default:return[e]}};switch(e.kind){case"null":return Ae({kind:"bottom"});default:return Ae(t(r(e)))}}function ct(e){const t=e.split("");switch(!0){case 0===t.length:return!1;default:{const[e,...r]=t;return-1!=="pmvn".indexOf(e)&&r.every((e=>-1!=="pmvn0123456789".indexOf(e)))}}}function ut(e){const t=e.split("");switch(!0){case 0===t.length:return!1;case"w"===t[0]&&void 0===t[1]:return!0;default:{const[e,...r]=t;return-1!=="ux".indexOf(e)&&-1===r.map((e=>!isNaN(parseInt(e)))).indexOf(!1)}}}function lt(e,t,r){switch(e.kind){case"string":return Ce(r({1:(0,F.G)(e.value),2:t}));case"number":case"null":return Pe(r({1:"null"===e.kind?F.YP:(0,F.G)(e.value),2:Qe(Ve(t,(([e,t])=>[Number(e),t])),(e=>!isNaN(e[0])))}));default:return"{bad cutoff}"}}function dt(e){const t=e=>t=>Ie(t[2],t[1],e),r=e=>t=>Ee(t[2],t[1],e),n=e.split("");switch(!0){case"w"===n[0]&&void 0===n[1]:return e=>Oe(e[2],e[1]);case"u"===n[0]&&void 0===n[1]:return t(1);case"u"===n[0]&&void 0!==n[1]:return t(parseInt(n.slice(1).join("")));case"x"===n[0]&&void 0===n[1]:return r(1);case"x"===n[0]&&void 0!==n[1]:return r(parseInt(n.slice(1).join("")));default:throw new Error("This should never happen if you use isGroupCommand")}}function pt(e){return(0,F.UI)(ye)((0,Fe.nI)(ft(e,(e=>{const t=e.split("");if(0===t.length)return F.YP;const[r,...n]=t,s=(e=>{switch(e){case"p":return(0,F.G)("add");case"m":return(0,F.G)("mul");case"v":return(0,F.G)("max");case"n":return(0,F.G)("min");default:return F.YP}})(r);return(0,F.UI)((e=>{const{init:t,rest:r}=(0,J.zT)((e=>{return"number"==typeof(t=parseInt(e))&&isFinite(t)&&Math.floor(t)===t;var t}))(n);return{1:{1:e,2:0===t.length?1:parseInt(t.join(""))},2:r.join("")}}))(s)}))))}function ft(e,t){const r=t(e);return(0,F.fS)((()=>[]))((0,F.UI)((e=>[e[1]].concat(ft(e[2],t))))(r))}function mt(e){return je(e.map(gt))}function gt(e){switch(e.kind){case"number":return ke(e.value);case"string":return Se(e.value);case"null":return{kind:"bottom"};case"object":return Se("{object}");case"array":return Se("{array}")}}const _t={strategy:(e,t,r)=>n=>{if((0,F.Wi)(r))return t;if("delta"===e&&(0,F.Wi)(t))return F.YP;if((0,F.Wi)(t))return r;if((0,F.pC)(t)&&(0,F.pC)(r))return n(t.value,r.value);throw new Error("Non exhaustive match in combineCommand.strategy")},operation:(e,t,r,n,s,i)=>{const a=(0,J.pR)(Be(i));if("append"===e&&"add"===t)return(0,J.yL)(r,n,kt("append",s.plus));if("append"===e&&"mul"===t)return(0,J.yL)(r,n,kt("append",s.times));if("append"===e&&"max"===t)return(0,Ue.Fp)(a)(r,n);if("join"===e&&"add"===t)return(0,J.yL)(r,n,kt("join",(0,Ue.Fp)(i)));if("join"===e&&"mul"===t)return(0,J.yL)(r,n,kt("join",(0,Ue.Fp)(i)));if("join"===e&&"max"===t)return(0,Ue.Fp)(a)(r,n);if("min"===t)return _t.operation(e,"max",r,n,s,function(e){return(0,Ue.Zt)(((t,r)=>Je(e.compare(t,r))))}(i));if("delta"===e&&"max"===t)return(0,Ue.gt)(a)(r,n)?r:n.map(qe);if("delta"===e)return(0,J.yL)(r,n,((e,t)=>(0,Ue.gt)(Be(i))(e,t)?e:{kind:"bottom"}));throw new Error("Non exhaustive match in combineCommand.operation")},extend:(e,t,r,n)=>{if("delta"===e&&"top"===r.kind&&"top"===n.kind)return(0,Ue.gt)(W.Df)(r.error,n.error)?Se(r.error):{kind:"bottom"};if("delta"===e&&"bottom"===n.kind)return r;if("delta"===e&&"bottom"===r.kind)return{kind:"bottom"};if("top"===r.kind&&"top"===n.kind)return Se((0,Ue.Fp)(W.Df)(r.error,n.error));if("top"===r.kind)return r;if("top"===n.kind)return n;if("inner"===r.kind&&"inner"===n.kind)return t(r.a,n.a);if("bottom"===r.kind)return n;if("bottom"===n.kind)return r;throw new Error("Non exhaustive match in extend")}},ht={plus:(e,t)=>e+t,times:(e,t)=>e*t};function vt(e,t,r,n){if("unbounded"===e.kind&&"unbounded"===t.kind){const s=e.group,i=t.group;return(0,F.fS)(qe)((0,F.UI)((e=>ke(xe(e))))(Ye(s,i,r,n)))}if("windowed"===e.kind&&"windowed"===t.kind){const s=e.key,i=e.group,a=t.key,o=t.group,c=(0,Ue.Fp)((0,F.pR)(n))(s,a);return(0,F.fS)(qe)((0,F.UI)((e=>ke(Oe(e,c))))(Ye(i,o,r,n)))}if("countLimit"===e.kind&&"countLimit"===t.kind){const s=e.n,i=t.n;if(s===i){const i=e.limit,a=e.group,o=t.limit,c=t.group,u=(0,Ue.Fp)((0,F.pR)(n))(i,o);return(0,F.fS)(qe)((0,F.UI)((e=>ke(Ee(e,u,s))))(Ye(a,c,r,n)))}return Se("Non matching counts")}if("uniqueLimit"===e.kind&&"uniqueLimit"===t.kind){const s=e.n,i=t.n;if(s===i){const i=e.limit,a=e.group,o=t.limit,c=t.group,u=(0,Ue.Fp)((0,F.pR)(n))(i,o);return(0,F.fS)(qe)((0,F.UI)((e=>ke(Ie(e,u,s))))(Ye(a,c,r,n)))}return Se("Non matching counts")}return Se("Non matching group types")}function bt(e,t,r){return(0,F.fS)(_e)(wt(e,F.YP)(t,r))}function wt(e,t){const r=t=>(r,n)=>_t.strategy(e,r,n)(wt(e,t)),n=(t,n,s)=>{if("stringGroup"===n.kind&&"stringGroup"===s.kind){const e=vt(n.group,s.group,r(t),W.Df);return Ke(e,(e=>Ce(qt(e,W.Df))))}if("numberGroup"===n.kind&&"numberGroup"===s.kind){const e=vt(n.group,s.group,r(t),Xe.Df);return Ke(e,(e=>Pe(qt(e,Xe.Df))))}if("tuple"===n.kind&&"tuple"===s.kind){const r=(0,F.pC)(t)?t.value:[];return ke(je(function(e,t,r,n,s,i){const a=(e,t)=>({1:(0,J.ke)(e)(t).concat((0,J.KB)(Math.max(0,e-t.length),qe)),2:(0,J.md)(e)(t)}),o=(t,r,n)=>{if(0===t.length)return _t.operation(e,"max",r,n,s,i);if(t.length>0){const[c,...u]=t,l=a(c[2],r),d=l[1],p=l[2],f=a(c[2],n),m=f[1],g=f[2];return _t.operation(e,c[1],d,m,s,i).concat(o(u,p,g))}throw new Error("Non exhaustive match in recurse")};return(0,J.GY)((0,J.Qp)((e=>"bottom"===e.kind))((0,J.GY)(o(t,r,n))))}(e,r,n.tuple,s.tuple,ht,Xe.Df)))}throw new Error(`Non matching payload. Got ${n.kind} and ${s.kind}`)},s=(e,r)=>{if((0,F.Eh)((0,Fe.Eh)((0,Ze.n_)({1:W.Eq,2:Xe.Eq}))).equals(e.commands,r.commands)){const s=(0,F.Wi)(e.commands)?t:e.commands,i=n(s,e.payload,r.payload);return Ke(i,(t=>Te(e.commands,t)))}throw new Error(`Non matching primitive strings. Got ${JSON.stringify(e)} and ${JSON.stringify(r)}`)};return(t,r)=>et(Ae(_t.extend(e,s,ot(t).state,ot(r).state)))}function yt(e,t,r){const n=(0,F.UI)((t=>Qe(e,(([e,n])=>(0,Ue.gf)(r)(e,t)))))(t);return(0,F.fS)((()=>e))(n)}function qt(e,t){switch(e.kind){case"unbounded":return e;case"windowed":return(0,F.Wi)(e.key)?e:Oe(yt(e.group,e.key,t),e.key);case"countLimit":{const r=e.limit,n=e.n,s=e.group,i=He(n,s,((e,t)=>t<=1?F.YP:(0,F.G)(t-1)),t),a=(0,Ue.Fp)((0,F.pR)(t))(r,i);return Ee(yt(s,a,t),a,n)}case"uniqueLimit":{const r=e.limit,n=e.n,s=e.group,i=(e,t)=>{switch(e.kind){case"object":{const r=[...e.value.keys(),...t.keys()],s=new Set(r);return s.size>=n?F.YP:(0,F.G)(s)}default:return F.YP}},a=He(new Set,s,i,t),o=(0,Ue.Fp)((0,F.pR)(t))(r,a);return Ie(yt(s,o,t),o,n)}}}function kt(e,t){return(r,n)=>_t.extend(e,((e,r)=>ke(t(e,r))),r,n)}class St{constructor(){this.queryCodesAsList=[],this.queryCodesAsMap={}}has(e){return e in this.queryCodesAsMap}add(e){return(0,t.zG)(e.forEach((e=>this.queryCodesAsMap[e]=!0)),(e=>this.updateSegmentsList()))}remove(e){return(0,t.zG)(e.forEach((e=>delete this.queryCodesAsMap[e])),(e=>this.updateSegmentsList()))}getAllAsList(){return this.queryCodesAsList}getStdAsList(){return this.queryCodesAsList.filter((e=>e>=1e7))}getAllAsMap(){return this.queryCodesAsMap}getUpdates(e){const t=[],r=[];return Object.entries(e).forEach((([e,{result:n}])=>{const s=parseInt(e),i=!0===n.result&&!(s in this.queryCodesAsMap),a=!1===n.result&&s in this.queryCodesAsMap;i?t.push(s):a&&r.push(s)})),{entered:t,left:r}}updateSegmentsList(){this.queryCodesAsList=Object.keys(this.queryCodesAsMap).map((e=>parseInt(e)))}}var xt=__webpack_require__(506);const Ot=e=>new Et(e);class Et{constructor(e){const t=this;this._worker=e,this._callbacks={},this._id=0,e.addEventListener("message",(function(e){Et.onMessage(t,e)}))}set id(e){this._id=e}get id(){return this._id}newId(){const e=this.id;return this.id=this.id+1,e}static onMessage(e,t){if(r=t.data,!(Array.isArray(r)&&r.length>=2))return;var r;const[n,s,i]=t.data,a=e._callbacks[n];a&&(delete e._callbacks[n],a(s,i))}static isServiceWorker(e){return void 0!==e.controller}postMessage(e){const t=this,r=this.newId(),n=[r,e];return new Promise((function(e,s){var i;if(t._callbacks[r]=function(t,r){if(t)return s(new Error(t.message));e(r)},Et.isServiceWorker(t._worker)){const e=new MessageChannel;e.port1.onmessage=function(e){Et.onMessage(t,e)},null===(i=t._worker.controller)||void 0===i||i.postMessage(n,[e.port2])}else t._worker.postMessage(n)}))}}class It{constructor(e,t){this.timeoutDurationInMilliseconds=e,this.maxTimeOutDurationInMilliseconds=t}schedule(e,t=this.timeoutDurationInMilliseconds,r=this.maxTimeOutDurationInMilliseconds){return this.debounce(e,t,r)}scheduleAccumulated(e,t,r=this.timeoutDurationInMilliseconds,n=this.maxTimeOutDurationInMilliseconds){return this.debounce(e,r,n,t)}scheduleForPageUnload(e){return(0,Y.aq)(e,navigator.userAgent)}debounce(e,t,r,n){let s,i,a=null==n?void 0:n.empty;return o=>(n&&(a=n.concat(a,o)),new Promise((c=>{s&&window.clearTimeout(s),s=window.setTimeout((()=>{window.clearTimeout(i),i=null,c(e(n?a:o)),a=null==n?void 0:n.empty}),t),i||(i=window.setTimeout((()=>{window.clearTimeout(s),i=null,c(e(n?a:o)),a=null==n?void 0:n.empty}),r))})))}}class Pt{constructor(e,r,n,s,i,a){this.logger=e,this._internals=r,this.permutive=n,this.queryWorker=s,this.transitionDebounceTime=i,this.transitionDebounceMaxTime=a,this.CACHED_SEGMENTS_STORAGE_KEY="_psegs",this.queryMetadata=(0,Y.PM)({21247:"0c8b70cdb7",21634:"c784c76f7e",23609:"fe5891d101",23760:"2a16fa438d",23844:"2321bc3d67",23845:"79df642717",24351:"78d9978a2c",24377:"68cabc8524",24378:"5a2078d3e2",24393:"419ef3d28b",24847:"8ed8eb90ce",25108:"855d20678a",25666:"f8f68b77c3",25971:"2d246f54c9",27091:"ab6c8824c7",27290:"4d76e06232",27455:"e1b45b5780",29015:"5b5d269df0",29809:"592fdde4b5",29811:"3dd1e57504",29813:"90cd7b6ac2",29823:"f5e3b68ff7",30268:"c1ffd80303",31648:"67d3aad864",31955:"27f5aa26d0",32016:"d8c4f86db9",32017:"f025b88d55",32035:"320ca41efa",32036:"87eb657684",32037:"830ddc19a4",32038:"acc2343f68",32039:"ff5d4adef2",32040:"8af528486b",32091:"415a1fd21d",32092:"94364fef79",32093:"c27abab721",32096:"1e0e2f488d",32097:"196415ae13",32098:"4f58e95403",32099:"6e46893f65",32100:"a5c6e7bde8",32101:"ea51df09f0",32102:"475dac09e4",32103:"22d4f815c7",32104:"405626099d",32105:"f6cc9fa7e2",32106:"8a3fa050e7",32107:"5d54ecbd4e",32108:"97698bd92b",32109:"0aefdcad7b",32110:"08b2247222",32111:"e64eb6275c",32112:"46f33aff76",32593:"4583b79139",32594:"9540fb7619",32595:"6ffeaedd14",32795:"5026c25aaa",32797:"84cb81fd3b",32798:"5750ad0cd9",32954:"8aab7d9bf3",33023:"e3dab6c049",33024:"eafbffea95",33106:"eaf928f6dc",33158:"a9e6a1f589",33162:"11f79a52c5",33170:"4ababa1819",33229:"0b474624e5",36650:"2577baf749",36803:"d8a5262743",36990:"b443ed27b2",38060:"559d73cb20",38062:"f1178248a0",38163:"2db31442ec",38311:"1416d02539",38338:"d737572f83",38518:"bae6406059",38519:"9a501214cf",38523:"075e3e8c44",38524:"fa178b7109",38526:"b26ac088a7",38528:"fff2366274",38529:"4fb5a6fba1",38530:"192928c29b",38856:"cde6cb0394",38982:"ab1fd0105c",38983:"9440661b3a",38984:"1aee4adcef",38985:"5b82ad9579",38986:"ba07b91ee8",38987:"7fbf0425f2",38988:"d38a7a784a",38989:"52ebb8a45c",38990:"770f66cf70",38991:"604b8325ec",38992:"34a55c5297",38993:"f027591c70",38995:"775cbe35a6",38996:"4c77ea4f25",38997:"71c6f4189a",38998:"6b7d963579",38999:"d21d83d62c",39e3:"e162420121",39001:"db4b941cb0",39002:"6ca10135a5",39003:"93f635c6ce",39004:"aac1396fd8",39005:"03d3a38709",39006:"87ebf0cd2e",39007:"66457daa01",39008:"ff8be6f255",39009:"599a1fb5bd",39010:"7eeebd81ed",39011:"5fb6a4476d",39012:"3b12aa4f43",39013:"44f019a923",39014:"7873bb3396",39015:"8bcb869390",39016:"dd2dd8f371",39017:"917d19ddc4",39018:"64945eb5dd",39019:"045afb3709",39020:"a3ce585503",39021:"f00e33a7a9",39026:"5aa4c56b71",39238:"39b0117996",39251:"fa1afd1902",39342:"4a32d336ca",39343:"00d0d28cbf",39346:"1782de25bd",39347:"00ec97b63f",39479:"6b3073050a",39488:"09226f0a1f",39489:"3be87317cb",39490:"6565125e57",39491:"381c7e1b9e",39551:"568c2d791b",39552:"185a739db3",39553:"007668eab9",39554:"a8dceac3a8",39640:"4584c3923b",40632:"14ecee8e4a",40633:"5d0ad73b86",40634:"dc542029fd",40635:"b240d9a19c",40636:"bec158597a",40637:"8e539efabf",40638:"13b46be26e",40673:"bb00dc9278",41222:"02ee3b39c0",41519:"c76deb271e",42001:"97d72e18af",42012:"32d1071ce1",42018:"7aae561cb8",43335:"ae769f760a",43345:"a4a0c785d0",43454:"554bf3b4eb",43531:"5a4ebd10d1",43606:"c84c2284df",43738:"a3ef454024",43743:"9256b9ff67",43762:"bc51642b8c",44405:"4b719e9661",44455:"39e2a1f71b",44479:"8d4a3ba959",46522:"705a316838",46524:"aadafdfa56",46525:"9568dbecad",46913:"41b21fbb34",47261:"9af9854f0a",47927:"71752481c5",48016:"7525cfb26e",49709:"c96292a308",49710:"c824987a73",49711:"004b467ec2",49712:"f9e8c8a3b9",49713:"c84011d4a5",49714:"bcb29db5ab",49717:"4c5058071f",49718:"eb9da205de",49719:"5263d04bf7",49720:"7f54bd154c",49721:"98d60b64f3",49722:"67728d5f16",49723:"90f16e5f0f",49724:"ac14844d75",49725:"af58862c36",49726:"40e476ee4d",49727:"b0df424117",49728:"c3d2a7771a",49729:"56bad20d4f",49730:"dcc63c7b35",49731:"393b12d7be",49732:"60ad7638dd",49733:"20be8dd3bb",49734:"e0ab760fb3",49735:"84d9dceb88",49736:"00cf5f2cd0",49737:"a4834ff8ea",49738:"619349a79c",49739:"3a253900c1",49740:"377f3d8ccf",49741:"a656866a9e",49742:"a601698c74",49744:"d3ccbb63fb",49745:"a7a86df25d",49746:"261b256bd5",49748:"ed9a43bb17",49749:"48af981a73",49750:"3772a78f99",49751:"266fd4b0f4",49752:"d9c2dcc984",49753:"4704b6702e",49754:"2d3d571306",49755:"ed2fb47175",49756:"6fbc3a0f87",49757:"9c5e4ed19e",49758:"c672441aa3",49759:"1e133605db",49760:"34b422c54a",49761:"3480237d9c",49762:"9c847bdc4f",49763:"123a3b436f",49764:"f8a795c30a",49765:"7422e6fe04",49766:"0db462da65",49767:"876a8603b0",49859:"d4d61d67a6",49860:"c6f61b5878",49861:"01e2d39c17",49862:"16cecb1e81",49863:"ff6511bb1a",49864:"773f06998e",49865:"95af084ad4",49866:"55bd60f14a",49867:"0bb253c221",49868:"426ad3467b",49869:"b59fe2ebfc",49870:"23ddc6e43a",49871:"2347027d04",49872:"0adc124780",49873:"48e16ef667",49874:"a735d2c01a",49875:"535762c7f4",49876:"5f2f4ef64a",49877:"ddc254c334",49878:"49133a5a79",49879:"8fcd6e0174",49880:"7525cfb26e",49881:"84e39dd61c",49882:"dfbfbda605",49883:"9803d349f5",49884:"b39a13e0e9",49885:"5f31b89be1",49886:"2eb5348e46",49887:"32425b8df5",49888:"b181b1f31c",49889:"ff1e38256f",49890:"a3ab83ac2e",49891:"e69090446c",49892:"482a78b4a7",49893:"044bdc0725",49894:"c45db1a4df",49895:"30891a7ad4",52308:"7e2b121f22",52434:"8429906c97",52435:"229977f326",52436:"7b2f4011c4",52437:"c46381bc2b",52438:"770c2e207f",52439:"6f17e51ee6",52440:"a57e2c89ec",52441:"ffd7c82eb8",52442:"3469a22179",52444:"b3ee1a2446",52445:"4ab703e177",52446:"c058773999",52447:"cd7fba4c49",52448:"ecd7c4996e",52449:"58217d38b9",52450:"259361ff85",52455:"8f84edaea8",52456:"3933ffd50a",52457:"79b4f17920",52458:"d0ed75485e",52459:"4bdda9ad3f",52460:"3856088683",52532:"ff1e770791",52533:"9285de824c",52534:"217aa82538",52535:"f06de97638",52536:"f293f7d336",52537:"16db2222bd",52538:"1a5b32c050",52539:"5082a2bff0",52540:"4ec2a2eca4",52541:"8718d9000c",52542:"8575fc2ec7",52543:"b57cf8e630",53304:"72d40637f7",55909:"56d48958fe",55910:"e7015f2596",55916:"bc80ac43a8",55922:"5417f5284b",55923:"ed22cff648",55924:"10172fef91",56321:"7a3fdb6119",56791:"52e61fe50a",56898:"2b59213fce",56996:"00ee707ab9",57396:"a1de2ae34f",57397:"85e4cbc302",57436:"f7a21c7eb9",57845:"c1ffd80303",57891:"014db3f783",59308:"85e8cfbd78",59848:"92fe3da6b7",6e4:"f3ebcf576b",60006:"045a8076e5",60125:"d8e698cd1c",60138:"eafbffea95",60214:"1f8f4a101c",60602:"fcd6eebb9b",60671:"e8f1770455",61707:"0c8b70cdb7",62290:"2c00e4d49c",62873:"d9e184a5ca",63035:"2e9c44d1e3",65127:"478630dc1e",65128:"5ad4536c35",66791:"a2eb2b13f8",70728:"b9f8955da3",70729:"738fda472c",70743:"02027ac0e9",71317:"0311ef3b6b",72222:"c09dd358fb",72741:"4a94bbcc55",72742:"1256aa5661",72972:"842acaf620",73389:"5a7275661f",73412:"60aa9cc7a9",73424:"929d038fee",73426:"b263b9b203",73565:"e766dc9653",74375:"7a924e48b2",76458:"f800006682",76925:"58308d5ba2",77155:"c62df7d1db",79429:"96c5f6106c",80805:"98913312ea",1e7:"ab2a79b4e1",10000001:"ea7eca3b49",10000002:"7a0b76bb2f",10000003:"49e502122c",10000004:"bc8d7e3d5e",10000005:"377db020e8",10000006:"6e71b87352",10000007:"12ed0bff2a",10000008:"4a72840eba",10000010:"a4cefa7f58",10000011:"aa7075e35b",10000012:"1ae8bddb93",10000013:"1e8886ad72",10000014:"f516ad362e",10000015:"9867900f2f",10000016:"3a6681d95b",10000017:"38ea08fad7",10000018:"12ed0bff2a",10000019:"e109f9b360",10000020:"90a178ea71",10000021:"04bbf8e635",10000022:"4734ac38ff",10000023:"f8f03f52a4",10000024:"3dd0f4235c",10000025:"9674e8f207",10000026:"6d37ba6b9a",10000035:"216792eaef",10000036:"d36ef645a5",10000037:"adf0bd9d7d",10000038:"ee56f69340",10000039:"9b0eb48861",10000040:"de880ed625",10000041:"5de582afdd",10000042:"1ccab119ee",10000043:"3cde49fc7f",10000044:"204ea1bd83",10000045:"87b257dec6",10000046:"5579a14726",10000047:"aca78f9e2e",10000048:"fa2ea1e2fa",10000049:"074fd09f55",10000050:"6f96f5278d",10000051:"d7f4837226",10000052:"629e4756ae",10000053:"cd9d4baf1b",10000054:"897ad1fa31",10000056:"36169adc34",10000058:"91ed3d5df9",10000059:"9975f2d18a",10000060:"291bb4c201",10000062:"8af22f787c",10000063:"13625d9512",10000064:"aa269c3192",10000065:"711a803835",10000066:"94d62b32e3",10000067:"a90790be86",10000068:"840b4c697a",10000069:"5b811cacf3",10000070:"26f90895bf",10000071:"ecfb5c1cab",10000072:"49ab120d1d",10000073:"8816deadae",10000074:"5c7a1ac24a",10000075:"0dc58fe713",10000076:"c791f64ecd",10000077:"fb2601505c",10000078:"ec0d63e687",10000079:"9f1a1f7510",10000080:"e51622030c",10000081:"c7a8cae6d0",10000082:"8ce761d02d",10000083:"7b6a42ef76",10000084:"479977505c",10000085:"930fdc5c22",10000086:"39e47fa144",10000087:"4524f8a1c5",10000088:"49bc2becff",10000090:"be04a0b54e"},{1e7:"ab2a79b4e1",10000001:"ea7eca3b49",10000002:"7a0b76bb2f",10000003:"49e502122c",10000004:"bc8d7e3d5e",10000005:"377db020e8",10000006:"6e71b87352",10000007:"12ed0bff2a",10000008:"4a72840eba",10000010:"a4cefa7f58",10000011:"aa7075e35b",10000012:"1ae8bddb93",10000013:"1e8886ad72",10000014:"f516ad362e",10000015:"9867900f2f",10000016:"3a6681d95b",10000017:"38ea08fad7",10000018:"12ed0bff2a",10000019:"e109f9b360",10000020:"90a178ea71",10000021:"04bbf8e635",10000022:"4734ac38ff",10000023:"f8f03f52a4",10000024:"3dd0f4235c",10000025:"9674e8f207",10000026:"6d37ba6b9a",10000035:"216792eaef",10000036:"d36ef645a5",10000037:"adf0bd9d7d",10000038:"ee56f69340",10000039:"9b0eb48861",10000040:"de880ed625",10000041:"5de582afdd",10000042:"1ccab119ee",10000043:"3cde49fc7f",10000044:"204ea1bd83",10000045:"87b257dec6",10000046:"5579a14726",10000047:"aca78f9e2e",10000048:"fa2ea1e2fa",10000049:"074fd09f55",10000050:"6f96f5278d",10000051:"d7f4837226",10000052:"629e4756ae",10000053:"cd9d4baf1b",10000054:"897ad1fa31",10000056:"36169adc34",10000058:"91ed3d5df9",10000059:"9975f2d18a",10000060:"291bb4c201",10000062:"8af22f787c",10000063:"13625d9512",10000064:"aa269c3192",10000065:"711a803835",10000066:"94d62b32e3",10000067:"a90790be86",10000068:"840b4c697a",10000069:"5b811cacf3",10000070:"26f90895bf",10000071:"ecfb5c1cab",10000072:"49ab120d1d",10000073:"8816deadae",10000074:"5c7a1ac24a",10000075:"0dc58fe713",10000076:"c791f64ecd",10000077:"fb2601505c",10000078:"ec0d63e687",10000079:"9f1a1f7510",10000080:"e51622030c",10000081:"c7a8cae6d0",10000082:"8ce761d02d",10000083:"7b6a42ef76",10000084:"479977505c",10000085:"930fdc5c22",10000086:"39e47fa144",10000087:"4524f8a1c5",10000088:"49bc2becff",10000090:"be04a0b54e"}),this.socioDemoSegmentsConfig={},this.isWorkerReady=!1,this.extStateMap={},this.userSegments=new St,this.segmentTransitionEdgeOnly=(new xt.A).getConfigByKey("web")("segment_transition_edge_only",!0),this.segmentEntryQueryCodes=new Set,this.segmentExitQueryCodes=new Set,this.scheduler=new It(this.transitionDebounceTime,this.transitionDebounceMaxTime);this.debouncedProcessTransitions=this.scheduler.scheduleAccumulated((e=>this.processImpl(e,!1)),{concat:(e,t)=>e.concat(t),empty:[]});const o=this._internals.getExternalData(this.CACHED_SEGMENTS_STORAGE_KEY),c=(JSON.parse(o)||[]).filter((e=>((e,t,r={})=>e in t||e in r)(e,this.queryMetadata,this.socioDemoSegmentsConfig)));this.userSegments.add(c);const u=this._internals.state.getPermutiveData("internal_query_states")||{},l=this._internals.state.getPermutiveData("external_query_states")||{},d=Object.keys(this.queryMetadata),p=Object.keys(u);this.hasNewOrModifiedQueries=d.length!==p.length||d.filter((e=>{var t;return this.queryMetadata[e]!==(null===(t=u[e])||void 0===t?void 0:t.checksum)})).length>0,e.log("QueryManager has new or modified queries",this.hasNewOrModifiedQueries);const f=this.hasNewOrModifiedQueries?(0,Y.fl)(u,(e=>{var t;return(null===(t=u[e])||void 0===t?void 0:t.checksum)===this.queryMetadata[e]})):u;this.extStateMap=this.hasNewOrModifiedQueries?(0,t.zG)((0,Y.fl)(l,(e=>e in f)),(e=>(this._internals.state.setPermutiveData("external_query_states",e),e))):l,this.stateMap={value:f,promise:Promise.resolve(f)};this._internals.state.getPermutiveData("query_states")&&this._internals.state.setPermutiveData("query_states",null)}bootstrap(e){const t=V("worker_boostrap");return this.postMessage((t=>this.queryWorker.postMessage({type:"bootstrap",payload:[this.queryMetadata,this.extStateMap,{segments:{"1p":this.userSegments.getAllAsMap()},sessionId:this._internals.sessionManager.getSessionId(),viewId:this._internals.state.viewId,lookalikeModels:{}},e],stateMap:t}))).then((e=>(t.finish(),e)))}updateEnvironment(e){return this.postMessage((t=>this.queryWorker.postMessage({type:"updateEnvironment",payload:[this.queryMetadata,this.extStateMap,e],stateMap:t})))}process(e,t){return function(e){return["SegmentEntry","SegmentExit"].includes(e.name)&&void 0!==e.properties.segment_number}(e)?this.debouncedProcessTransitions([e]):this.processImpl([e],t)}updateExternalState(e){const r=(0,Y.b0)(e,((e,t)=>{const r=this.queryMetadata[e];return r&&t[r]?(0,F.Uo)(Ne(t[r])):F.YP})),n=(0,Y.b0)(this.extStateMap,((e,t)=>(0,F.Uo)(Ne(t)))),s=(e,r)=>(0,t.zG)((0,F.Y3)((()=>bt("join",e,r))),(0,F.fS)((()=>(this._internals.network.error(`Failed to join external state. Had ${JSON.stringify(r)}, received ${JSON.stringify(e)}}`,this._internals.state.userId),r)))),i=(0,Y.b0)(Object.assign(Object.assign({},n),r),((e,t)=>n[e]?(0,F.G)(Me(s(t,n[e]))):(0,F.G)(Me(t))));this._internals.state.setPermutiveData("external_query_states",i),this.extStateMap=i;return this.postMessage((e=>this.queryWorker.postMessage({type:"updateExternalState",payload:[this.queryMetadata,this.extStateMap],stateMap:e})))}trackCloudSegmentResults(e){const{entered:t,left:r}=this.userSegments.getUpdates(e);this.trackSegmentsTransition(t,r),this.updateUserSegments(t,r);(t.length>0||r.length>0)&&this._internals.messages.emit("permutive:segments:updated")}processImpl(e,r,n){const s=r=>({payload:(0,t.bc)(this.queryMetadata,this.extStateMap,e),stateMap:r});return this.postMessage(!0===n?e=>this.queryWorker.postMessage(Object.assign({type:"processTransitions"},s(e))):e=>this.queryWorker.postMessage(Object.assign({type:"process"},s(e)))).then((n=>(0,t.zG)(r?this.setAsRealTimeifNeeded(e):(0,t.Q1)(),(e=>n))))}postMessage(e){return new Promise((r=>{this.stateMap.promise=this.stateMap.promise.then(e).then((({diff:e,errors:n})=>(0,t.zG)(r(e),(t=>this.onStateChange(e,n))))).catch((e=>(0,t.zG)(this._internals.network.error(`Error during query execution. Got ${e}`,this._internals.state.userId),(e=>r({})),(e=>this.stateMap.value))))}))}onStateChange(e,r){return(0,t.zG)(r.length>0?this._internals.network.error(`QL error(s). Got ${r.join("; ")}`,this._internals.state.userId):{},(t=>this.stateMap.value=Object.assign(Object.assign({},this.stateMap.value),e)),(e=>this.isWorkerReady?this.onStateChangeReady(e):e))}trackSegmentsTransition(e,t){e.forEach((e=>{this.trackTransition(!0,e),this._internals.messages.emit("permutive:query:changed",{queryCode:e,result:{result:!0}})})),t.forEach((e=>{this.trackTransition(!1,e),this._internals.messages.emit("permutive:query:changed",{queryCode:e,result:{result:!1}})}))}updateUserSegments(e,t){this.userSegments.add(e),this.userSegments.remove(t),this._internals.setExternalData(this.CACHED_SEGMENTS_STORAGE_KEY,JSON.stringify(this.userSegments.getAllAsList()))}onStateChangeReady(e){const{entered:r,left:n}=this.userSegments.getUpdates(e);this.trackSegmentsTransition(r,n),this.updateUserSegments(r,n),this.logger.log("Writing new segment and query state cache",e),this._internals.state.setPermutiveData("internal_query_states",e);const s=r.length>0||n.length>0;return(0,t.zG)(s,(e=>e?this._internals.messages.emit("permutive:segments:updated"):{}),(t=>e))}trackTransition(e,t){const r=this.segmentTransitionEdgeOnly?this._internals.customProperties.getCustomProps():{},n=Object.assign(Object.assign(Object.assign({},r),{segment_number:t}),{});e?this.segmentEntryQueryCodes.add(t):this.segmentExitQueryCodes.add(t),this.permutive.track(e?"SegmentEntry":"SegmentExit",n,{isMemoryOnly:this.segmentTransitionEdgeOnly})}setAsRealTimeifNeeded(e){return!this._internals.isRealtime&&e.filter((e=>"Pageview"===e.name)).length>0?Promise.resolve(this._internals.setAsRealtime()):Promise.resolve()}reset(){this._internals.removeExternalData(this.CACHED_SEGMENTS_STORAGE_KEY),this._internals.state.setPermutiveData("internal_query_states",{}),this._internals.state.setPermutiveData("external_query_states",{}),this.userSegments=new St,this.stateMap={value:{},promise:Promise.resolve({})},this.extStateMap={}}setAsReady(){this.isWorkerReady=!0,this.onStateChangeReady(this.stateMap.value),this._internals.messages.emit("permutive:queries:initialised")}getStateSizeInBytes(){return 2*JSON.stringify(this.stateMap.value).length}}class Ct{constructor(e){this.config=e}getNamespacedStorageKey(e){return`${this.config.stateNamespace}${e}`}}class jt{constructor(e,t,r,n,s,i,a,o){this.logger=e,this.permutive=t,this._internals=r,this.id=n,this.segmentCode=s,this.triggerType=i,this.config=a,this.workspaceLevelConfig=o}activateEveryTime(){return"EveryTime"===this.triggerType}activateOnEntry(){return"OnEntry"===this.triggerType}activateOnExit(){return"OnExit"===this.triggerType}trackImpression(e){const t={reaction_id:this.id,type:"impression"};this.permutive.track("Reaction",t,e),this.logger.log("impression: ",t)}trackConversion(e){const t={reaction_id:this.id,type:"conversion"};this.permutive.track("Reaction",t,e),this.logger.log("conversion: ",t)}}class At{constructor(e,t,r,n){this.logger=e,this._internals=t,this.permutive=r,this.context=n,this.addons=new xt.A,this.optimisedActivationsConfig={dfp:{dfp:[62290,72222,55910,74375,80805,40635,70728,65128,66791,76458,70743,73426,72972,76925,25971,39552,77155,21247,23609,23760,23844,23845,24378,24377,24393,25666,24847,25108,27455,32093,32092,24351,27091,32017,32016,32035,32037,32110,32106,32036,31648,32038,32109,32039,32112,32040,32111,32108,31955,32107,32105,32096,32091,32100,32098,32104,32099,32103,32102,29809,29015,29811,29813,29823,30268,32101,32097,32798,32954,32797,32795,33024,33023,33106,33158,33162,33170,33229,36803,36650,38060,38062,39551,38856,39640,40633,40634,40637,40638,38163,38338,27290,44479,44405,47261,43335,43345,43454,43738,43743,52542,52538,52533,52460,52449,52308,52434,52435,52441,52455,52534,52442,52436,52450,52437,52444,52539,41519,52445,52543,44455,52536,52456,52537,52457,52438,52540,52447,47927,52458,46522,46524,46525,52439,52532,52541,53304,52459,52448,52440,46913,56996,56791,55916,6e4,55922,55923,55924,59308,57845,52446,60602,42012,60214,52535,60138,59848,57891,62873],dfp_legacy:{}},eyeota_pixel:[],dbm:{omitted:0},appnexus:{},appnexus_adserver:[32017,32016,70728,32093,32103,43454,32111,32112,77155,80805,32101,23609,46525,46524,44455,27290,46522,24351,33229,62290,63035],nativo:[],rubicon_ssp:[77155,80805,32101,27091,23609,21247,29809,27290,29823,29813,29811,41222,46525,33229]}}getSpecializedActivations(e){return this.optimisedActivationsConfig[e]}getActivations(e){return this.addons.getConfigByKey(e)("activationConfigs",[]).filter((e=>this.areContextCriteriaSatisfied(e))).map((e=>new jt(this.logger,this.permutive,this._internals,e.id,e.sc,e.tt,e.c,e.wc)))}areContextCriteriaSatisfied(e){const t=e.cc,r=e=>{const t=this.context[e.key];switch(e.comparison){case"EQUALS":return t===e.value;case"NOT_EQUALS":return t!==e.value;case"CONTAINS":return"string"==typeof t&&t.indexOf(e.value)>=0;case"NOT_CONTAINS":return"string"==typeof t&&t.indexOf(e.value)<0}};return!t||("AND"===(n=t).operator?n.criteria.every(r):n.criteria.some(r));var n}}const Tt=e=>Object.assign({id:e.id,name:e.name,time:new Date(e.time),properties:e.properties||{}},zt(e)),Mt=e=>Object.assign({id:e.id||null,name:e.name,time:(Gt(e.time)?e.time:new Date).toISOString(),properties:e.properties||{}},zt(e)),Nt=(e,t)=>Object.assign({id:e.id,time:new Date(e.time),name:t.name,properties:t.properties},zt(t)),Dt=e=>void 0!==e.request_id,zt=e=>Object.assign(Object.assign({},e.session_id?{session_id:e.session_id}:{}),e.view_id?{view_id:e.view_id}:{}),Gt=e=>isFinite(e)&&e instanceof Date;class Lt{constructor(e){this.namespace=e}put(e,r){return(0,t.zG)(this.namespace.getNamespacedStorageKey(String(r)),(t=>window.localStorage.setItem(t,JSON.stringify(e))),(e=>Promise.resolve(r)))}get(e){return(0,t.zG)(this.namespace.getNamespacedStorageKey(String(e)),(e=>JSON.parse(window.localStorage.getItem(e))),(e=>Promise.resolve(e)))}delete(e){return(0,t.zG)(this.namespace.getNamespacedStorageKey(String(e)),(e=>Promise.resolve(window.localStorage.removeItem(e))))}deleteStore(){return Promise.resolve()}migrateIfRequired(){return Promise.resolve()}}let Rt,$t;const Ut=new WeakMap,Kt=new WeakMap,Bt=new WeakMap,Ft=new WeakMap,Jt=new WeakMap;let Wt={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return Kt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Bt.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Vt(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Yt(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?($t||($t=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Qt(this),t),Vt(Ut.get(this))}:function(...t){return Vt(e.apply(Qt(this),t))}:function(t,...r){const n=e.call(Qt(this),t,...r);return Bt.set(n,t.sort?t.sort():[t]),Vt(n)}}function Ht(e){return"function"==typeof e?Yt(e):(e instanceof IDBTransaction&&function(e){if(Kt.has(e))return;const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{t(),n()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)}));Kt.set(e,t)}(e),t=e,(Rt||(Rt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,Wt):e);var t}function Vt(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{t(Vt(e.result)),n()},i=()=>{r(e.error),n()};e.addEventListener("success",s),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&Ut.set(t,e)})).catch((()=>{})),Jt.set(t,e),t}(e);if(Ft.has(e))return Ft.get(e);const t=Ht(e);return t!==e&&(Ft.set(e,t),Jt.set(t,e)),t}const Qt=e=>Jt.get(e);function Zt(e,t,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(e,t),o=Vt(a);return n&&a.addEventListener("upgradeneeded",(e=>{n(Vt(a.result),e.oldVersion,e.newVersion,Vt(a.transaction))})),r&&a.addEventListener("blocked",(()=>r())),o.then((e=>{i&&e.addEventListener("close",(()=>i())),s&&e.addEventListener("versionchange",(()=>s()))})).catch((()=>{})),o}const Xt=["get","getKey","getAll","getAllKeys","count"],er=["put","add","delete","clear"],tr=new Map;function rr(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(tr.get(t))return tr.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,s=er.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!s&&!Xt.includes(r))return;const i=async function(e,...t){const i=this.transaction(e,s?"readwrite":"readonly");let a=i.store;return n&&(a=a.index(t.shift())),(await Promise.all([a[r](...t),s&&i.done]))[0]};return tr.set(t,i),i}Wt=(e=>({...e,get:(t,r,n)=>rr(t,r)||e.get(t,r,n),has:(t,r)=>!!rr(t,r)||e.has(t,r)}))(Wt);class nr{constructor(e,t,r,n,s,i,a){this.namespace=e,this._internals=t,this.cryptoAlg=r,this.idb=n,this.mainObjectStore=s,this.keyObjectStore=i,this.keyObjectKey=a,this.MAX_CONSECUTIVE_PUTS=30,this.puts=1,this.cryptoKey=this.getOrGenerateKey()}static initialise(r,n,s,i,a,o,c,u){const l=["development"===n.config.environment?window.isSecureContext:"https:"===window.location.protocol,!((0,Y.G6)(navigator.userAgent)&&["f036e56c-2514-4246-bf83-1659326fe3f8","5f42864d-a421-4f37-9478-00266f871d68"].indexOf("16d3bd5c-bf92-4bf0-815a-eac397d3aadf")>-1)].every((e=>!0===e)),d=(e,r,n)=>r.includes(n)?(0,t.Q1)():e.createObjectStore(n),p=l?(0,e.Y3)((()=>Zt(i,u,{upgrade:e=>{const t=[...e.objectStoreNames];d(e,t,a),d(e,t,o)}})),(e=>String(e))):(0,e.t$)("Connection not attempted. Default to localStorage");return(0,e.g_)((e=>O(e)),(e=>C((()=>e.then((e=>new nr(r,n,s,e,a,o,c)))),(e=>String(e)))))(p)}put(e,r){return this.cryptoKey.then((n=>(0,t.zG)(JSON.stringify(e),(e=>new Promise(((s,i)=>{this.cryptoAlg.encrypt(n,e).then((e=>(0,t.zG)(this.namespace.getNamespacedStorageKey(String(r)),(t=>this.resetIfRequired(this.puts++).then((n=>this.idb.put(this.mainObjectStore,e,t).then((e=>s(r)))))))),(e=>i(e)))}))))))}get(e){return this.cryptoKey.then((r=>(0,t.zG)(this.namespace.getNamespacedStorageKey(String(e)),(e=>this.idb.get(this.mainObjectStore,e).then((e=>e?this.cryptoAlg.decrypt(r,e):null)).then(JSON.parse)))))}delete(e){return(0,t.zG)(this.namespace.getNamespacedStorageKey(String(e)),(e=>this.idb.delete(this.mainObjectStore,e)))}migrateIfRequired(){return(0,t.zG)(this._internals.getExternalData(ar),(e=>e?E(JSON.parse(e)):O(null)))().then((0,e.g_)(t.Q1,(e=>(0,t.zG)(e.forEach((e=>this._internals.state.eventsCache.add(Tt(e),{persistOnDisk:!1}))),(e=>this._internals.removeExternalData(ar))))))}deleteStore(){return Promise.resolve(this.idb.close()).then((e=>function(e,{blocked:t}={}){const r=indexedDB.deleteDatabase(e);return t&&r.addEventListener("blocked",(()=>t())),Vt(r).then((()=>{}))}(this.idb.name)))}getOrGenerateKey(){return(0,t.zG)(this.namespace.getNamespacedStorageKey(this.keyObjectKey),(e=>this.idb.get(this.keyObjectStore,e).then((e=>e||this.storeGivenOrGeneratedKey()))))}storeGivenOrGeneratedKey(e){return(e||this.cryptoAlg.generateKey(!1)).then((e=>(0,t.zG)(this.namespace.getNamespacedStorageKey(this.keyObjectKey),(t=>this.idb.put(this.keyObjectStore,e,t)),(t=>e))),(e=>Promise.reject(e)))}resetIfRequired(e){const t=this.idb.name,r=this.idb.version;return(0,Y.G6)(navigator.userAgent)&&e%this.MAX_CONSECUTIVE_PUTS==0?this.deleteStore().then((e=>Zt(t,r,{upgrade:e=>{e.createObjectStore(this.mainObjectStore),e.createObjectStore(this.keyObjectStore)}}))).then((e=>{this.idb=e,this.storeGivenOrGeneratedKey(this.cryptoKey)})):Promise.resolve()}}class sr{constructor(t,r,n,s,i,a,o){this.namespace=t,this._internals=r,this.cryptoAlg=n,this.dbName=s,this.mainObjectStore=i,this.keyObjectStore=a,this.keyObjectKey=o,this.version=3,this.db=nr.initialise(this.namespace,this._internals,this.cryptoAlg,this.dbName,this.mainObjectStore,this.keyObjectStore,this.keyObjectKey,this.version)().then((0,e.fS)((e=>new Lt(this.namespace))))}put(e,t){return C((()=>this.db.then((r=>r.put(e,t)))),(e=>String(e)))}get(e){return C((()=>this.db.then((t=>t.get(e))).then(F.ij)),(e=>String(e)))}delete(e){return C((()=>this.db.then((t=>t.delete(e)))),(e=>String(e)))}deleteStore(){return C((()=>this.db.then((e=>e.deleteStore()))),(e=>String(e)))}migrateIfRequired(){return C((()=>this.db.then((e=>e.migrateIfRequired()))),(e=>String(e)))}}class ir{constructor(){this.crypto=window.crypto||window.msCrypto,this.ALG_NAME="AES-GCM"}generateKey(e=!1){return this.crypto.subtle.generateKey({name:this.ALG_NAME,length:256},e,["encrypt","decrypt"])}encrypt(e,t){const[r,n]=this._encrypt(e,this.str2bytes(t));return r.then((e=>{const t=new Uint8Array(16+e.byteLength);return t.set(n,0),t.set(new Uint8Array(Uint32Array.of(e.byteLength).buffer),12),t.set(new Uint8Array(e),16),t.buffer}))}decrypt(e,t){const r=new Uint8Array(t,0,12),n=new Uint32Array(t,12,1)[0],s=t.slice(16,16+n);return this._decrypt(e,r,s).then(this.bytes2str)}_encrypt(e,t){const r=this.crypto.getRandomValues(new Uint8Array(12));return[this.crypto.subtle.encrypt({name:this.ALG_NAME,iv:r},e,t),r]}_decrypt(e,t,r){return this.crypto.subtle.decrypt({name:this.ALG_NAME,iv:t},e,r)}str2bytes(e){return(new TextEncoder).encode(e).buffer}bytes2str(e){return(new TextDecoder).decode(e)}}const ar="permutive-events-cache";class or{constructor(e,r,n,s,i){this.namespace=e,this.logger=r,this.state=n,this._internals=s,this.permutive=i,this.EVENTS_CACHE_OBJECT_STORE="events",this.CRYPTO_KEY_OBJECT_STORE="keys",this.CRYPTO_KEY_OBJECT_KEY="events",this.eventPutQueue=Promise.resolve(),this.eventCacheSizeInBytes=0,this.eventsTTLInMilliseconds=(0,t.zG)((0,F.ij)(this._internals.config.eventsTTLInDays),(0,F.tS)((e=>"number"==typeof e&&e>0?(0,F.G)(24*e*3600):F.YP))),this.eventStore=new sr(this.namespace,this._internals,new ir,"16d3bd5c-bf92-4bf0-815a-eac397d3aadf",`${this.EVENTS_CACHE_OBJECT_STORE}_${this.state.userId}`,`${this.CRYPTO_KEY_OBJECT_STORE}_${this.state.userId}`,this.CRYPTO_KEY_OBJECT_KEY),this.eventsCache=(0,Y.PQ)((()=>{const e=V("load_event_cache");return this.loadFromDisk().then((t=>(this.logger.log("Event cache loaded, #e",t.length),e.finish(),t)))}))}all(){return this.eventsCache}resetIfNeeded(){return Promise.resolve()}add(e,r){const{persistOnDisk:n}=r;return this.eventsCache.then((r=>(0,t.zG)(r.push(e),(e=>n?this.flush():(0,t.Q1)()),(t=>e))))}loadFromDisk(){this.logger.log("Loading event caching...");const r=[];return this.eventStore.migrateIfRequired()().then((0,e.g_)((e=>(this._internals.network.error(`Failed to migrate events cache. Got ${JSON.stringify(e)}`),this.reset().then((e=>r)))),(()=>{const n=this._internals.metrics.startTimer("sdk_load_events_cache_task_duration_seconds",{});return this.eventStore.get(ar)().then((s=>{this._internals.metrics.stopTimer("sdk_load_events_cache_task_duration_seconds",n);const i=(0,F.g_)((()=>Promise.resolve(r)),(e=>(0,t.zG)(this.eventCacheSizeInBytes=2*JSON.stringify(e).length,(t=>{this._internals.metrics.track({name:"sdk_events_cache_byte_total",value:this.eventCacheSizeInBytes,labels:{}}),this._internals.metrics.track({name:"sdk_events_cache_size_total",value:e.length,labels:{}})}),(t=>e.map(Tt)),(e=>(0,F.g_)((()=>e),(t=>e.filter((e=>t>Date.now()-e.time.getTime()))))(this.eventsTTLInMilliseconds)),(e=>Promise.resolve(e)))));return(0,e.g_)((e=>(this._internals.network.error(`Error fetching data from store. Got ${e}`),this.reset().then((e=>r)))),i)(s)}))})))}reset(){return this.logger.log("Resetting Events Cache"),this.eventsCache=Promise.resolve([]),this.eventCacheSizeInBytes=0,this.eventStore.deleteStore()().then((()=>(this.eventStore=new sr(this.namespace,this._internals,new ir,"16d3bd5c-bf92-4bf0-815a-eac397d3aadf",`${this.EVENTS_CACHE_OBJECT_STORE}_${this.state.userId}`,`${this.CRYPTO_KEY_OBJECT_STORE}_${this.state.userId}`,this.CRYPTO_KEY_OBJECT_KEY),this.flush())))}flush(){return this.eventsCache.then((e=>{let r=JSON.stringify(e),n=1;for(;r.length>this._internals.config.eventsCacheLimitBytes/2;)e.splice(0,n),n*=2,r=JSON.stringify(e);this.logger.log("Writing cache (#e)",e.length),this.eventCacheSizeInBytes=2*r.length,this.eventPutQueue=this.eventPutQueue.then((r=>this.eventStore.put(e.map(Mt),ar)().then(t.Q1)))}))}getStateSizeInBytes(){return this.eventCacheSizeInBytes}}class cr{constructor(e){this._internals=e,this.queue=[],this.nextNotify=null,e.messages.on("permutive:taskQueue:update",(()=>{this.execute()}))}add(e){this.queue.push(e),this.notify()}notify(){const e=()=>{this._internals.messages.emit("permutive:taskQueue:update")},t=(new Date).getTime();null===this.nextNotify||this.nextNotify<t-50?(this.nextNotify=t,e()):this.nextNotify<=t&&(this.nextNotify=t+50,window.setTimeout(e,50))}execute(){if(0===this.queue.length)return;let e=!1,t=!1,r=0;for(let n=0;n<this.queue.length;n++){const s=this.queue[n];if(s.complete)r+=1;else if(s.started)t=!0,e=e||s.blocks();else{if(s.waits()&&t)break;e||(t=!0,e=e||s.blocks(),s.execute((()=>{this.notify()})))}}this.queue.splice(0,r)}size(){return this.queue.length}}class ur{constructor(e,t,r,n,s){this.namespace=e,this.logger=t,this._internals=r,this.permutive=n,this.context=s,this.permutiveData={},this.permutiveDataSize=0,this.taskQueue=new cr(this._internals),this.localStorageQueue=new Set,this.localStorageScheduler=new It(r.config.localStorageWriteDelay,r.config.localStorageWriteMaxDelay),this.debouncedFlush=this.localStorageScheduler.schedule(this.flushLocalStorageQueue.bind(this)),this.debouncedStorageKeys=new Set(r.config.localStorageDebouncedKeys),this.localStorageScheduler.scheduleForPageUnload(this.flushLocalStorageQueue.bind(this)),this.permutiveData=this.getPermutiveDataAndMigrateIfNeeded();const i=(0,F.fS)((()=>(0,F.fS)(Y.k$)(this.getUserIdFromLocalStorage())))(this.getUserIdFromCookie());this.setUserId(i),this.viewId=(0,Y.k$)(),this.context.view_id=this.viewId,this.eventSourceId=this.getPermutiveData("event-source-id")||this.generateAndStoreEventSourceId(),this.eventsCache=new or(this.namespace,this.logger,this,this._internals,this.permutive),this.activationManager=new At(this.logger,this._internals,this.permutive,this.context)}setUserId(e){this._internals.setCookie(this._internals.config.cookieName,e,!0),this._internals.setExternalData(this._internals.config.cookieName,e),this.userId=e}getPermutiveData(e){return this.permutiveData[e]}setPermutiveData(e,t){this.permutiveData[e]=t,this.debouncedStorageKeys.has(e)?(this.localStorageQueue.add(e),this.debouncedFlush()):this.writePermutiveData(e)}flushLocalStorageQueue(){for(let e of this.localStorageQueue)this.writePermutiveData(e);this.localStorageQueue.clear()}writePermutiveData(e){this.logger.log(`Writing ${e} to localStorage`);const[t,r]=this.dataKeyToChunkInfo(e);return this._internals.makeSafe((()=>window.localStorage.setItem(this.namespace.getNamespacedStorageKey(t),JSON.stringify(r))))()}getClient(){let e="";return e=document.title?document.title:"",{type:"web",user_agent:navigator.userAgent||"",url:window.location.href||"",domain:window.location.hostname||"",title:e,referrer:document.referrer||""}}getStateSizeInBytes(){return this.permutiveDataSize+this.eventsCache.getStateSizeInBytes()}reset(){return this.logger.log("Resetting State"),Promise.resolve((0,t.zG)(this._internals.deleteCookie(this._internals.config.cookieName),(e=>this._internals.removeExternalData(this._internals.config.cookieName)),(e=>this._internals.queryManager.reset()),(e=>this.permutiveData={}),(e=>this.eventSourceId=this.generateAndStoreEventSourceId()),(e=>window.localStorage.removeItem(this._internals.config.permutiveDataModelsKey)),(e=>window.localStorage.removeItem(this._internals.config.permutiveDataQueriesKey)),(e=>window.localStorage.removeItem(this._internals.config.permutiveDataTPDKey)),(e=>window.localStorage.removeItem(this._internals.config.permutiveDataEnrichersKey)),(e=>window.localStorage.removeItem(this._internals.config.permutiveDataMiscKey))))}getPermutiveDataAndMigrateIfNeeded(){const e=(e,t)=>{this.setPermutiveData(e,t)},r=r=>{const n=this.namespace.getNamespacedStorageKey(this._internals.config.permutiveDataKey);return window.localStorage.removeItem(n),[lr,dr,pr,fr,mr].forEach((n=>(0,t.zG)(((e,r)=>(0,t.zG)(Array(...e),(0,J.Ew)((e=>void 0!==r[e]))))(n,r),(0,F.UI)((t=>e(t,r[t])))))),r};return(0,t.zG)(this.getPermutiveDataChunk("legacy"),(e=>Object.keys(e).length>0?r(e):Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.getPermutiveDataChunk("misc")),this.getPermutiveDataChunk("models")),this.getPermutiveDataChunk("queries")),this.getPermutiveDataChunk("tpd")),this.getPermutiveDataChunk("enrichers"))))}getPermutiveDataChunk(e){const t=this.namespace.getNamespacedStorageKey(this.chunkKeyToStorageKey(e)),r=window.localStorage.getItem(t);return null===r?{}:(this.permutiveDataSize+=2*r.length,JSON.parse(r))}dataKeyToChunkInfo(e){const t=e=>(0,Y.eu)(this.permutiveData,e);switch(e){case"models_data":case"models_last_updated":return[this.chunkKeyToStorageKey("models"),t(lr)];case"query_states":case"internal_query_states":case"external_query_states":case"state_offset":case"event-source-id":return[this.chunkKeyToStorageKey("queries"),t(dr)];case"third-party-data":case"third-party-data-session-id":case"third-party-data-usage":return[this.chunkKeyToStorageKey("tpd"),t(pr)];case"enricher:geoip":case"enricher:watson":return[this.chunkKeyToStorageKey("enrichers"),t(fr)];case"identities":case"amp_ready":case"metricsEnabled":case"addon:tradedesk":case"addon:tracking_pixel":case"addon:eyeota_pixel":case"addon:twitter_pixel":case"addon:pinterest_pixel":case"addon:facebook_pixel_v2":case"addon:appnexus":case"addon:ddp":case"addon:gigya":case"pubmatic":case"lotame":return[this.chunkKeyToStorageKey("misc"),t(mr)];default:return(0,Y.Fi)(e)}}chunkKeyToStorageKey(e){switch(e){case"legacy":return this._internals.config.permutiveDataKey;case"models":return this._internals.config.permutiveDataModelsKey;case"queries":return this._internals.config.permutiveDataQueriesKey;case"tpd":return this._internals.config.permutiveDataTPDKey;case"enrichers":return this._internals.config.permutiveDataEnrichersKey;case"misc":return this._internals.config.permutiveDataMiscKey;default:return(0,Y.Fi)(e)}}generateAndStoreEventSourceId(){const e=(0,Y.k$)();return this.setPermutiveData("event-source-id",e),e}getUserIdFromStorageIfValid(e){const r=(0,F.DT)(Y.Gz);return(0,t.zG)("cookie"===e?this._internals.getCookie(this._internals.config.cookieName):this._internals.getExternalData(this._internals.config.cookieName),F.ij,(0,F.tS)(r))}getUserIdFromCookie(){return this.getUserIdFromStorageIfValid("cookie")}getUserIdFromLocalStorage(){return this.getUserIdFromStorageIfValid("localStorage")}}const lr=["models_data","models_last_updated"],dr=["query_states","internal_query_states","external_query_states","state_offset","event-source-id"],pr=["third-party-data","third-party-data-session-id","third-party-data-usage"],fr=["enricher:geoip","enricher:watson"],mr=["identities","amp_ready","metricsEnabled","addon:tradedesk","addon:tracking_pixel","addon:eyeota_pixel","addon:twitter_pixel","addon:pinterest_pixel","addon:facebook_pixel_v2","addon:appnexus","addon:ddp","addon:gigya","pubmatic","lotame"];function gr(){return me()('/*! permutive-javascript-sdk v14.20.4 (web) (built 2021-08-02T06:09:15.050Z) */(()=>{"use strict";function n(n){return n}function r(n,r,t,e,u,i,o,c,a,s,f,l,d,p,m,g,h,v,k,w){switch(arguments.length){case 1:return n;case 2:return r(n);case 3:return t(r(n));case 4:return e(t(r(n)));case 5:return u(e(t(r(n))));case 6:return i(u(e(t(r(n)))));case 7:return o(i(u(e(t(r(n))))));case 8:return c(o(i(u(e(t(r(n)))))));case 9:return a(c(o(i(u(e(t(r(n))))))));case 10:return s(a(c(o(i(u(e(t(r(n)))))))));case 11:return f(s(a(c(o(i(u(e(t(r(n))))))))));case 12:return l(f(s(a(c(o(i(u(e(t(r(n)))))))))));case 13:return d(l(f(s(a(c(o(i(u(e(t(r(n))))))))))));case 14:return p(d(l(f(s(a(c(o(i(u(e(t(r(n)))))))))))));case 15:return m(p(d(l(f(s(a(c(o(i(u(e(t(r(n))))))))))))));case 16:return g(m(p(d(l(f(s(a(c(o(i(u(e(t(r(n)))))))))))))));case 17:return h(g(m(p(d(l(f(s(a(c(o(i(u(e(t(r(n))))))))))))))));case 18:return v(h(g(m(p(d(l(f(s(a(c(o(i(u(e(t(r(n)))))))))))))))));case 19:return k(v(h(g(m(p(d(l(f(s(a(c(o(i(u(e(t(r(n))))))))))))))))));case 20:return w(k(v(h(g(m(p(d(l(f(s(a(c(o(i(u(e(t(r(n)))))))))))))))))))}}function t(n){return function(r){return function(t){return n.map(t,(function(n){return n(r)}))}}}var e=function(n,r){for(var t=0,e=r.length,u=n.length;t<e;t++,u++)n[u]=r[t];return n},u=(Object.prototype.hasOwnProperty,function(n){return e([n[0]],n.slice(1))}),i=function(n){return"Left"===n._tag},o=function(n){return{_tag:"Left",left:n}},c=function(n){return{_tag:"Right",right:n}},a=function(n){return function(r){return i(r)?n(r.left):r.right}};var s=function(n,t){return r(n,l(t))},f=function(n,t){return r(n,d(t))},l=function(n){return function(r){return i(r)?r:c(n(r.right))}},d=function(n){return function(r){return i(r)?r:i(n)?n:c(r.right(n.right))}},p=c,m="Either";var g={URI:m,map:s},h=(t(g),{URI:m,map:s,ap:f,of:p});const v=()=>({kind:"null",value:null}),k=n=>({kind:"string",value:n}),w=n=>({kind:"number",value:n}),y=n=>({kind:"array",value:n}),b=n=>({kind:"object",value:n}),x=n=>n,j=()=>({kind:"bottom"}),N=n=>({kind:"inner",a:n}),L=n=>({kind:"top",error:n}),q=n=>({kind:"unbounded",group:n}),M=(n,r)=>({kind:"windowed",key:r,group:n}),O=(n,r,t)=>({kind:"countLimit",n:t,limit:r,group:n}),S=(n,r,t)=>({kind:"uniqueLimit",n:t,limit:r,group:n}),E=n=>({kind:"numberGroup",group:n}),A=n=>({kind:"stringGroup",group:n}),G=n=>({kind:"tuple",tuple:n}),I=n=>({state:n}),R=(n,r)=>({commands:n,payload:r});var $=function(n,r){return{left:n,right:r}},_=function(n){return function(r){return $(C(r),n(J(r)))}},U="Separated",C=(t({URI:U,map:function(n,t){return r(n,_(t))}}),function(n){return n.left}),J=function(n){return n.right},z=function(n){return"Some"===n._tag},F=function(n){return"None"===n._tag},P={_tag:"None"},W=function(n){return{_tag:"Some",value:n}};function B(n){return function(r){return n(r)?W(r):P}}function T(n){return"Left"===n._tag?P:W(n.right)}var D=T,H=function(n){return function(r){return F(r)?n():r.value}},K=function(n){return function(r){return F(r)?P:W(n(r.value))}};function Q(n){return{equals:function(r,t){return r===t||(F(r)?F(t):!F(t)&&n.equals(r.value,t.value))}}}function V(n){return{equals:Q(n).equals,compare:function(r,t){return r===t?0:z(r)?z(t)?n.compare(r.value,t.value):1:-1}}}function X(n){return{equals:function(r,t){return r===t||n(r,t)}}}var Y=function(n){return X((function(r,t){for(var e in n)if(!n[e].equals(r[e],t[e]))return!1;return!0}))},Z={equals:function(n,r){return n===r}},nn=Z,rn=Z,tn=function(n){return function(r,t){return r===t||0===n(r,t)}},en=function(n){return{equals:tn(n),compare:function(r,t){return r===t?0:n(r,t)}}},un=function(n){return function(r){return en((function(t,e){return r.compare(n(t),n(e))}))}},on=function(n){return function(r,t){return-1===n.compare(r,t)}},cn=function(n){return function(r,t){return 1===n.compare(r,t)}},an=function(n){return function(r,t){return r===t||n.compare(r,t)>-1?r:t}};var sn,fn={equals:Z.equals,compare:function(n,r){return n<r?-1:n>r?1:0}},ln=fn,dn=fn;sn=void 0;var pn=function(n,t){return r(n,mn(t))},mn=function(n){return gn((function(r,t){return n(t)}))},gn=function(n){return function(r){for(var t=[n(0,wn(r))],e=1;e<r.length;e++)t.push(n(e,r[e]));return t}},hn=function(n){return n[0]},vn="ReadonlyNonEmptyArray",kn={URI:vn,map:pn},wn=(t(kn),hn);var yn=function(n,r){for(var t=0,e=r.length,u=n.length;t<e;t++,u++)n[u]=r[t];return n},bn=function(n){return n.length>0},xn=function(n,r){return n<0||n>=r.length},jn=function(n){return function(r){return yn([n],r)}},Nn=function(n){return function(r){return Mn(r,[n])}},Ln=u,qn=function(n){return bn(n)?W(n):P};function Mn(n,r){return n.concat(r)}var On=Ln;var Sn=function(n){return function(t){var e=Math.max(1,n);return e>=t.length?[On(t),[]]:[r(t.slice(1,e),jn(_n(t))),t.slice(e)]}},En=function(n,t){return r(n,An(t))},An=function(n){return Gn((function(r,t){return n(t)}))},Gn=function(n){return function(r){for(var t=[n(0,_n(r))],e=1;e<r.length;e++)t.push(n(e,r[e]));return t}},In="NonEmptyArray",Rn=function(n){return X((function(r,t){return r.length===t.length&&r.every((function(r,e){return n.equals(r,t[e])}))}))},$n={URI:In,map:En},_n=(t($n),wn);var Un=rn,Cn=dn,Jn=function(n){return 0===n.length};var zn=function(n,t){return r(n,Fn(t))},Fn=function(n){return function(r){return r.map((function(r){return n(r)}))}},Pn=function(n,r){return function(t){for(var e=t.length,u=n,i=0;i<e;i++)u=r(i,u,t[i]);return u}},Wn="ReadonlyArray",Bn={URI:Wn,map:zn},Tn=(t(Bn),jn),Dn=Nn,Hn=function(n,r){return n<=0?[]:function(n,r){for(var t=Math.max(0,Math.floor(n)),e=[r(0)],u=1;u<t;u++)e.push(r(u));return e}(n,r)},Kn=Jn,Qn=bn,Vn=xn,Xn=function(n){return function(r){return Vn(n,r)?nr(r):r.slice(0,n)}};var Yn=function(n,r){for(var t=n.length,e=0;e<t&&r(n[e]);e++);return e};var Zn=function(n){return function(r){return n<=0||Kn(r)?nr(r):n>=r.length?[]:r.slice(n,r.length)}};var nr=function(n){return n.slice()},rr=function(n){return Kn(n)?[]:n.slice().reverse()},tr=function(n){return function(r){return r.length<=1?nr(r):r.slice().sort(n.compare)}},er=function(n,r,t){for(var e=[],u=Math.min(n.length,r.length),i=0;i<u;i++)e[i]=t(n[i],r[i]);return e};var ur=function(n){return function(r){return n>=1&&Qn(r)?Sn(n)(r):Kn(r)?[nr(r),[]]:[[],nr(r)]}};var ir=function(n,t){return r(n,or(t))},or=function(n){return function(r){return r.map((function(r){return n(r)}))}},cr=function(n){return function(t){return r(t,function(n){return function(r){for(var t=[],e=0;e<r.length;e++)t.push.apply(t,n(e,r[e]));return t}}((function(r,t){return n(t)})))}},ar=function(n){return function(r){for(var t=[],e=0;e<r.length;e++){var u=n(e,r[e]);z(u)&&t.push(u.value)}return t}},sr=function(n){return ar((function(r,t){return n(t)}))},fr=sr(n),lr=Pn,dr=function(n){var r=pr(n);return function(n){return r((function(r,t){return n(t)}))}},pr=function(n){return function(t){return lr(n.of([]),(function(e,u,i){return n.ap(n.map(u,(function(n){return function(t){return r(n,Dn(t))}})),t(e,i))}))}},mr="Array",gr=function(n){return en((function(r,t){for(var e=r.length,u=t.length,i=Math.min(e,u),o=0;o<i;o++){var c=n.compare(r[o],t[o]);if(0!==c)return c}return Cn.compare(e,u)}))},hr={URI:mr,map:ir};t(hr);function vr(n){switch(n.kind){case"null":return yr.encode(n);case"string":return br.encode(n);case"number":return xr.encode(n);case"array":return jr.encode(n);case"object":return Nr.encode(n)}}function kr(n){return null===n?yr.decode(n):"number"==typeof n?xr.decode(n):"string"==typeof n?br.decode(n):Array.isArray(n)?jr.decode(n):Nr.decode(n)}const wr=(n,r)=>o(`Failed to decode. Input was ${JSON.stringify(n)}. Codec type was ${r}`),yr={encode:n=>null,decode:n=>null===n?c({kind:"null",value:null}):wr(n,"SimpleNull")},br={encode:n=>n.value,decode:n=>"string"==typeof n?c(k(n)):wr(n,"SimpleString")},xr={encode:n=>n.value,decode:n=>"number"==typeof n?c(w(n)):wr(n,"SimpleNumber")},jr={encode:n=>n.value.map(vr),decode:n=>{if(Array.isArray(n)){const r=dr(h)(kr)(n);return l(y)(r)}return wr(n,"SimpleArray")}},Nr={encode:n=>{const r=[...n.value.entries()];return Object.assign({},...Array.from(r,(([n,r])=>({[n]:vr(r)}))))},decode:n=>{if(n&&n.constructor===Object){const t=dr(h)((([n,t])=>r(kr(t),l((r=>function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n}(n,r))))))(Object.entries(n));return l((n=>b(new Map([...n]))))(t)}return wr(n,"SimpleObject")}};function Lr(n,r){const t=Object.keys(n),e=t.length,u={};for(let i=0;i<e;i++){const e=t[i],o=r(e,n[e]);z(o)&&(u[e]=o.value)}return u}var qr=nn,Mr=ln;const Or=(n,r)=>{switch(n.kind){case"bottom":return{kind:"bottom"};case"inner":return N(r(n.a));case"top":return L(n.error)}},Sr=n=>en(((r,t)=>{if("bottom"===r.kind&&"bottom"===t.kind)return 0;if("bottom"===r.kind)return-1;if("bottom"===t.kind)return 1;if("top"===r.kind&&"top"===t.kind)return Mr.compare(r.error,t.error);if("top"===r.kind)return 1;if("top"===t.kind)return-1;if("inner"===r.kind&&"inner"===t.kind)return n.compare(r.a,t.a);throw new Error("Non exhaustive match in extendedAlgebraOrd")}));var Er=function(n){return-1===n?1:1===n?-1:0};function Ar(n,r){return fr(n.map(r))}function Gr(n,r,t,e){const u=(n,r)=>{if(0===n.length)return fr(r.map((n=>W({1:n[1],2:t(P,W(n[2]))}))));if(0===r.length)return fr(n.map((n=>W({1:n[1],2:t(W(n[2]),P)}))));if(n.length>0&&r.length>0&&on(e)(n[0][1],r[0][1])){const[e,...i]=n,o=e[1],c=e[2];return Tn({1:o,2:t(W(c),P)})(u(i,r))}if(n.length>0&&r.length>0&&cn(e)(n[0][1],r[0][1])){const[e,...i]=r,o=e[1],c=e[2];return Tn({1:o,2:t(P,W(c))})(u(n,i))}if(n.length>0&&r.length>0){const[e,...i]=n,[o,...c]=r,a=e[1],s=e[2],f=o[2];return Tn({1:a,2:t(W(s),W(f))})(u(i,c))}throw new Error("Non exhaustive match in mapOption2")},i=un((n=>n[1]))(e),o=(n=>{const r=Ar(n,(n=>z(n[2])?W({1:n[1],2:n[2].value}):P));return 0===r.length?P:W(r)})(u(tr(i)([...n].map((n=>({1:n[0],2:n[1]})))),tr(i)([...r].map((n=>({1:n[0],2:n[1]}))))));return K((n=>new Map(n.map((n=>[n[1],n[2]])))))(o)}function Ir(n,r,t,e){const u=un((n=>n[0]))(e),a=tr(u)([...r]).reduceRight(((n,r)=>{if(i(n)){const e=t(r[1],n.left);return z(e)?o(e.value):c(r[0])}return n}),o(n));return D(a)}function Rr(n,r){return new Map([...n].map(r))}function $r(n,r){return new Map([...n].filter(r))}function _r(n){return K(Pr)(function(n){switch(n.state.kind){case"top":return W(k(n.state.error));case"bottom":return P;case"inner":return function(n){return function(n){switch(n.kind){case"numberGroup":case"stringGroup":return Ur(n.group);case"tuple":return n.tuple.length>0}}(n.payload)?W(y(function(n,r){const t=K((n=>Tn(n)(r)))(n);return H((()=>r))(t)}(K((n=>k(function(n){const r=n=>{switch(n){case"add":return"p";case"mul":return"m";case"max":return"v";case"min":return"n"}},t=n=>1===n[2]?r(n[1]):r(n[1])+JSON.stringify(n[2]);return n.map(t).join("")}(n))))(n.commands),function(n){const t=n=>{switch(n.kind){case"bottom":return{kind:"null",value:null};case"top":return k(n.error);case"inner":return w(n.a)}},e=n=>Ar([Cr,Jr,n=>r(n,Fr,b,W)],(r=>r(n))),u=n=>Ar([Cr,zr,n=>r(n,Fr,(n=>Rr(n,(([n,r])=>[JSON.stringify(n),r]))),b,W)],(r=>r(n)));switch(n.kind){case"tuple":return n.tuple.map(t);case"stringGroup":return e(n.group);case"numberGroup":return u(n.group)}}(n.payload)))):P}(n.state.a)}}(n))}function Ur(n){switch(n.kind){case"unbounded":return n.group.size>0;case"windowed":return n.group.size>0||z(n.key);case"countLimit":case"uniqueLimit":return n.group.size>0||z(n.limit)}}function Cr(n){switch(n.kind){case"unbounded":return P;case"windowed":return W(k("w"));case"countLimit":return W(k(1===n.n?"x":`x${n.n}`));case"uniqueLimit":return W(k(1===n.n?"u":`u${n.n}`))}}function Jr(n){switch(n.kind){case"unbounded":return P;case"windowed":return W(k(z(n.key)?n.key.value:""));case"countLimit":case"uniqueLimit":return W(k(z(n.limit)?n.limit.value:""))}}function zr(n){switch(n.kind){case"unbounded":return P;case"windowed":return z(n.key)?W(w(n.key.value)):W({kind:"null",value:null});case"countLimit":case"uniqueLimit":return z(n.limit)?W(w(n.limit.value)):W({kind:"null",value:null})}}function Fr(n){switch(n.kind){case"unbounded":case"windowed":case"countLimit":case"uniqueLimit":return n.group}}function Pr(n){switch(n.kind){case"array":return 0===n.value.length?{kind:"null",value:null}:1===n.value.length?Pr(n.value[0]):y(n.value.map(Pr));case"object":return r($r(n.value,(([n,r])=>"null"!==r.kind)),(n=>Rr(n,(n=>[n[0],Pr(n[1])]))),b);default:return n}}function Wr(n){const r=n=>{if(0===n.length)return{kind:"bottom"};const r=(n=>{if(4!==n.length)return P;const[r,t,e,u]=n;if("string"===r.kind&&"string"===t.kind&&"object"===u.kind){const n=B((n=>Br(n[1].value)&&Tr(n[2].value)))({1:r,2:t});return K((n=>({prim:n[1].value,grp:n[2].value,cutoff:e,m:u.value})))(n)}return P})(n);if(z(r)){const{prim:n,grp:t,cutoff:e,m:u}=r.value,i=Dr(e,u,Hr(t));return"string"==typeof i?L(i):N(R(Kr(n),i))}const t=(n=>{if(3!==n.length)return P;const[r,t,e]=n;if("string"===r.kind&&"object"===e.kind){const n=B((n=>Tr(n.value)))(r);return K((n=>({grp:n.value,cutoff:t,m:e.value})))(n)}return P})(n);if(z(t)){const{grp:n,cutoff:r,m:e}=t.value,u=Dr(r,e,Hr(n));return"string"==typeof u?L(u):N(R(P,u))}const e=(n=>{if(2!==n.length)return P;const[r,t]=n;if("string"===r.kind&&"object"===t.kind){const n=B((n=>Br(n.value)))(r);return K((n=>({prim:n.value,m:t.value})))(n)}return P})(n);if(z(e)){const{prim:n,m:r}=e.value;return N(R(Kr(n),A(q(r))))}const u=(n=>{if(1!==n.length)return P;const[r]=n;return"object"===r.kind?W({m:r.value}):P})(n);if(z(u)){const{m:n}=u.value;return N(R(P,A(q(n))))}const i=(n=>{if(n.length<1)return P;const[r,...t]=n;if("string"===r.kind){const n=B((n=>Br(n.value)))(r);return K((n=>({prim:n.value,rest:t})))(n)}return P})(n);if(z(i)){const{prim:n,rest:r}=i.value;return N(R(Kr(n),Vr(r)))}return N(R(P,Vr(n)))},t=n=>{switch(n.kind){case"array":return cr(t)(n.value);default:return[n]}};switch(n.kind){case"null":return I({kind:"bottom"});default:return I(r(t(n)))}}function Br(n){const r=n.split("");switch(!0){case 0===r.length:return!1;default:{const[n,...t]=r;return-1!=="pmvn".indexOf(n)&&t.every((n=>-1!=="pmvn0123456789".indexOf(n)))}}}function Tr(n){const r=n.split("");switch(!0){case 0===r.length:return!1;case"w"===r[0]&&void 0===r[1]:return!0;default:{const[n,...t]=r;return-1!=="ux".indexOf(n)&&-1===t.map((n=>!isNaN(parseInt(n)))).indexOf(!1)}}}function Dr(n,r,t){switch(n.kind){case"string":return A(t({1:W(n.value),2:r}));case"number":case"null":return E(t({1:"null"===n.kind?P:W(n.value),2:$r(Rr(r,(([n,r])=>[Number(n),r])),(n=>!isNaN(n[0])))}));default:return"{bad cutoff}"}}function Hr(n){const r=n=>r=>S(r[2],r[1],n),t=n=>r=>O(r[2],r[1],n),e=n.split("");switch(!0){case"w"===e[0]&&void 0===e[1]:return n=>M(n[2],n[1]);case"u"===e[0]&&void 0===e[1]:return r(1);case"u"===e[0]&&void 0!==e[1]:return r(parseInt(e.slice(1).join("")));case"x"===e[0]&&void 0===e[1]:return t(1);case"x"===e[0]&&void 0!==e[1]:return t(parseInt(e.slice(1).join("")));default:throw new Error("This should never happen if you use isGroupCommand")}}function Kr(n){return K(x)(qn(Qr(n,(n=>{const r=n.split("");if(0===r.length)return P;const[t,...e]=r,u=(n=>{switch(n){case"p":return W("add");case"m":return W("mul");case"v":return W("max");case"n":return W("min");default:return P}})(t);return K((n=>{const{init:r,rest:t}=(u=n=>{return"number"==typeof(r=parseInt(n))&&isFinite(r)&&Math.floor(r)===r;var r},function(n){var r=ur(Yn(n,u))(n);return{init:r[0],rest:r[1]}})(e);var u;return{1:{1:n,2:0===r.length?1:parseInt(r.join(""))},2:t.join("")}}))(u)}))))}function Qr(n,r){const t=r(n);return H((()=>[]))(K((n=>[n[1]].concat(Qr(n[2],r))))(t))}function Vr(n){return G(n.map(Xr))}function Xr(n){switch(n.kind){case"number":return N(n.value);case"string":return L(n.value);case"null":return{kind:"bottom"};case"object":return L("{object}");case"array":return L("{array}")}}const Yr={strategy:(n,r,t)=>e=>{if(F(t))return r;if("delta"===n&&F(r))return P;if(F(r))return t;if(z(r)&&z(t))return e(r.value,t.value);throw new Error("Non exhaustive match in combineCommand.strategy")},operation:(n,r,t,e,u,i)=>{const o=gr(Sr(i));if("append"===n&&"add"===r)return er(t,e,ot("append",u.plus));if("append"===n&&"mul"===r)return er(t,e,ot("append",u.times));if("append"===n&&"max"===r)return an(o)(t,e);if("join"===n&&"add"===r)return er(t,e,ot("join",an(i)));if("join"===n&&"mul"===r)return er(t,e,ot("join",an(i)));if("join"===n&&"max"===r)return an(o)(t,e);if("min"===r)return Yr.operation(n,"max",t,e,u,function(n){return en(((r,t)=>Er(n.compare(r,t))))}(i));if("delta"===n&&"max"===r)return cn(o)(t,e)?t:e.map(j);if("delta"===n)return er(t,e,((n,r)=>cn(Sr(i))(n,r)?n:{kind:"bottom"}));throw new Error("Non exhaustive match in combineCommand.operation")},extend:(n,r,t,e)=>{if("delta"===n&&"top"===t.kind&&"top"===e.kind)return cn(Mr)(t.error,e.error)?L(t.error):{kind:"bottom"};if("delta"===n&&"bottom"===e.kind)return t;if("delta"===n&&"bottom"===t.kind)return{kind:"bottom"};if("top"===t.kind&&"top"===e.kind)return L(an(Mr)(t.error,e.error));if("top"===t.kind)return t;if("top"===e.kind)return e;if("inner"===t.kind&&"inner"===e.kind)return r(t.a,e.a);if("bottom"===t.kind)return e;if("bottom"===e.kind)return t;throw new Error("Non exhaustive match in extend")}},Zr={plus:(n,r)=>n+r,times:(n,r)=>n*r};function nt(n,r,t,e){if("unbounded"===n.kind&&"unbounded"===r.kind){const u=n.group,i=r.group;return H(j)(K((n=>N(q(n))))(Gr(u,i,t,e)))}if("windowed"===n.kind&&"windowed"===r.kind){const u=n.key,i=n.group,o=r.key,c=r.group,a=an(V(e))(u,o);return H(j)(K((n=>N(M(n,a))))(Gr(i,c,t,e)))}if("countLimit"===n.kind&&"countLimit"===r.kind){const u=n.n,i=r.n;if(u===i){const i=n.limit,o=n.group,c=r.limit,a=r.group,s=an(V(e))(i,c);return H(j)(K((n=>N(O(n,s,u))))(Gr(o,a,t,e)))}return L("Non matching counts")}if("uniqueLimit"===n.kind&&"uniqueLimit"===r.kind){const u=n.n,i=r.n;if(u===i){const i=n.limit,o=n.group,c=r.limit,a=r.group,s=an(V(e))(i,c);return H(j)(K((n=>N(S(n,s,u))))(Gr(o,a,t,e)))}return L("Non matching counts")}return L("Non matching group types")}function rt(n,r,t,e,u,i){const o=(n,r)=>({1:Xn(n)(r).concat(Hn(Math.max(0,n-r.length),j)),2:Zn(n)(r)}),c=(r,t,e)=>{if(0===r.length)return Yr.operation(n,"max",t,e,u,i);if(r.length>0){const[a,...s]=r,f=o(a[2],t),l=f[1],d=f[2],p=o(a[2],e),m=p[1],g=p[2];return Yr.operation(n,a[1],l,m,u,i).concat(c(s,d,g))}throw new Error("Non exhaustive match in recurse")};return rr((a=n=>"bottom"===n.kind,function(n){return n.slice(Yn(n,a))})(rr(c(r,t,e))));var a}function tt(n,r,t){return H(v)(et(n,P)(r,t))}function et(n,r){const t=r=>(t,e)=>Yr.strategy(n,t,e)(et(n,r)),e=(e,u)=>{if(Q(Rn(Y({1:qr,2:Un}))).equals(e.commands,u.commands)){const i=((r,e,u)=>{if("stringGroup"===e.kind&&"stringGroup"===u.kind){const n=nt(e.group,u.group,t(r),Mr);return Or(n,(n=>A(it(n,Mr))))}if("numberGroup"===e.kind&&"numberGroup"===u.kind){const n=nt(e.group,u.group,t(r),Cn);return Or(n,(n=>E(it(n,Cn))))}if("tuple"===e.kind&&"tuple"===u.kind){const t=z(r)?r.value:[];return N(G(rt(n,t,e.tuple,u.tuple,Zr,Cn)))}throw new Error(`Non matching payload. Got ${e.kind} and ${u.kind}`)})(F(e.commands)?r:e.commands,e.payload,u.payload);return Or(i,(n=>R(e.commands,n)))}throw new Error(`Non matching primitive strings. Got ${JSON.stringify(e)} and ${JSON.stringify(u)}`)};return(r,t)=>_r(I(Yr.extend(n,e,Wr(r).state,Wr(t).state)))}function ut(n,r,t){const e=K((r=>$r(n,(([n,e])=>function(n){return function(r,t){return-1!==n.compare(r,t)}}(t)(n,r)))))(r);return H((()=>n))(e)}function it(n,r){switch(n.kind){case"unbounded":return n;case"windowed":return F(n.key)?n:M(ut(n.group,n.key,r),n.key);case"countLimit":{const t=n.limit,e=n.n,u=n.group,i=Ir(e,u,((n,r)=>r<=1?P:W(r-1)),r),o=an(V(r))(t,i);return O(ut(u,o,r),o,e)}case"uniqueLimit":{const t=n.limit,e=n.n,u=n.group,i=(n,r)=>{switch(n.kind){case"object":{const t=[...n.value.keys(),...r.keys()],u=new Set(t);return u.size>=e?P:W(u)}default:return P}},o=Ir(new Set,u,i,r),c=an(V(r))(t,o);return S(ut(u,c,r),c,e)}}}function ot(n,r){return(t,e)=>Yr.extend(n,((n,t)=>N(r(n,t))),t,e)}function ct(n,t){const e=r((n=>Lr(n,((n,r)=>r.state?W({[r.checksum]:r.state}):P)))(n),kr,a((n=>b(new Map)))),u=r(kr(t),a((n=>b(new Map))));return r(function(n,r){return tt("delta",n,r)}(e,u),(n=>vr(n)))||{}}!function(n){const r=self;function t(n,t,e,u){function i(t){if("function"!=typeof r.postMessage)return n.ports[0].postMessage(t);r.postMessage(t)}if(!e)return i([t,null,u]);"undefined"!=typeof console&&"error"in console&&console.error("Worker caught an error:",e),i([t,e])}r.addEventListener("message",(function(r){if(e=r,!Array.isArray(e.data)||2!==e.data.length)return;var e;const u=r.data,[i,o]=u;if("function"==typeof n)return function(n,r,e,u){const i=function(n,r){try{return{res:n(r)}}catch(n){return{err:n}}}(r,u);return Boolean(null===(o=i)||void 0===o?void 0:o.err)?t(n,e,i.err):!(c=i.res)||"object"!=typeof c&&"function"!=typeof c||"function"!=typeof c.then?t(n,e,null,i.res):void i.res.then((function(r){t(n,e,null,r)}),(function(r){t(n,e,r)}));var o,c}(r,n,i,o);t(r,i,new Error("Please pass a function into register()."))}))}((function(n){switch(n.type){case"delta":return ct(n.stateMap,n.lastSentStateMapWithChecksum);case"noop":return{}}}))})();',"Worker",void 0,void 0)}const _r={concat:(e,t)=>Object.assign(Object.assign({},e),t),empty:{}};class hr{constructor(e,t){var r;this._internals=e,this.stateWorker=t,this.DEBOUNCE_TIME=1e3,this.MAX_DEBOUNCE_TIME=5e3,this.fetchUnseenState=!0,this.scheduler=new It(this.DEBOUNCE_TIME,this.MAX_DEBOUNCE_TIME),this.debouncedSyncIfNotEmpty=this.scheduler.scheduleAccumulated((e=>this.syncIfNotEmpty.bind(this)("standard",e)),_r),this.fetchUnseenState=!!vr.includes("16d3bd5c-bf92-4bf0-815a-eac397d3aadf")||this._internals.sessionManager.sessionHasChanged(),this.stateOffset=this._internals.state.getPermutiveData("state_offset")||0,this.lastSentStateMapWithChecksum=(r=this._internals.state.getPermutiveData("internal_query_states")||{},(0,Y.b0)(r,((e,t)=>t.state?(0,F.G)({[t.checksum]:t.state}):F.YP))),this.stateWorker.postMessage({type:"noop"})}sync(e){return(0,t.zG)(this.debouncedSyncIfNotEmpty(e),(e=>Promise.resolve()))}syncWithUnseen(){return this.syncIfNotEmpty("unseen").then(t.Q1)}syncIfNotEmpty(e,t){const[r,n,s]="standard"===e?[this.stateOffset,t,this.fetchUnseenState]:"unseen"===e?[this.stateOffset,this._internals.queryManager.stateMap.value,!0]:[0,{},!0],i=this._internals.metrics.startTimer("sdk_compute_delta_seconds",{}),a=this.stateWorker.postMessage({type:"delta",stateMap:n,lastSentStateMapWithChecksum:this.lastSentStateMapWithChecksum}).then((e=>(this._internals.metrics.stopTimer("sdk_compute_delta_seconds",i),e))),o=e=>(this.fetchUnseenState=!1,this._internals.api.state(e,r,s).then((e=>function(e){return!!e}(e)?this.onStateResponse(e):{})).then((t=>(this.lastSentStateMapWithChecksum=e,t))).catch((e=>(this._internals.network.error(e,this._internals.state.userId),{}))));return a.then((e=>s||Object.keys(e).length>0?o(e):Promise.resolve({})))}resetSync(){return(0,t.zG)(this.reset(),(e=>Promise.all([this.syncIfNotEmpty("reset"),this._internals.thirdParty.segments(),this._internals.models.getModels()]).then((([e,t,r])=>this._internals.queryManager.bootstrap([]).then((e=>this._internals.queryManager.updateEnvironment({segments:(0,Y.PM)({"1p":this._internals.queryManager.userSegments.getAllAsMap()},t),lookalikeModels:r})))))))}reset(){this.lastSentStateMapWithChecksum={}}onStateResponse(r){const n=(0,e.Y3)((()=>JSON.parse(r.state)),(e=>this._internals.network.error(`Failed to parse State API response, got ${e}`,this._internals.state.userId))),s=e=>e?this._internals.queryManager.updateExternalState(e):(0,t.Q1)();return(0,e.tO)(n)?(0,t.zG)(r.state_offset,(e=>this.stateOffset=e),(e=>this._internals.state.setPermutiveData("state_offset",e)),(e=>s(n.right)),(e=>n.right)):{}}}const vr=["fe68d1f7-c9f4-45b3-8905-7cda73d3fd74"];class br{constructor(e,t){this.userId=e,this.aliases=t,this.resource="userTPD",this.query=()=>{const e=this.aliases.map((({id:e,tag:t,priority:r})=>`{id: "${e}", tag: "${t}", priority: ${r}}`)).join(",");return`\n      userTPD: user(user_id: "${this.userId}") {\n        identity(aliases: [${e}]) {\n          tpd {\n            name\n            segments\n          }\n        }\n      }\n    `}}}var wr=__webpack_require__(93),yr=Ze.vD,qr=(Ue.C2,wr.R,function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r});class kr{constructor(e,t,r,n){this.logger=e,this._internals=t,this.permutive=r,this.network=n,this.logger.log("Enabling tpd reporting"),this._internals.messages.on("permutive:segments:updated",(()=>{this.reportUsage()})),this.userSegments=this._internals.state.getPermutiveData("third-party-data")||{},this.lastCheckedSession=this._internals.state.getPermutiveData("third-party-data-session-id")||""}segments(){if(this.segmentsPromise)return this.segmentsPromise;const e=this._internals.sessionManager.getSessionId();if(this.lastCheckedSession===e)return Promise.resolve(this.userSegments);const t=(0,Y.b2)();this.lastCheckedSession=e;const r=this._internals.metrics.startTimer("sdk_get_third_party_data_task_duration_seconds",{}),n=Object.assign(Object.assign({},this._internals.identities.getCustomerDefinedIdentitiesMap()),this._internals.identities.getTPDIdentitiesMap());if(Object.keys(n).length>0){const e=new br(this._internals.state.userId||(0,Y.k$)(),this._internals.identities.getPrioritizedIdentities(n));this._internals.graphql.register(e).then((e=>{const r=this.graphQLTPDResponseToSegmentMap(e);this.updateCache(r),t.resolve(r)})).catch((e=>{this.network.error(`Third Party Data segments retrieval failed with reason: ${e}`,this._internals.state.userId),t.resolve({})}))}else t.resolve({});const s=t.promise.then((e=>this.userSegments));return s.then((t=>{this._internals.state.setPermutiveData("third-party-data-session-id",e),this._internals.metrics.stopTimer("sdk_get_third_party_data_task_duration_seconds",r);const n=this._internals.state.getPermutiveData("third-party-data"),s=(0,Y.rB)((0,Y.rB)(yr)),i=(0,Y.rB)(yr);if(!n||!s.equals(n,t)){this._internals.state.setPermutiveData("third-party-data",this.userSegments);const e=Object.entries(t||{});(n?e.filter((([e,t])=>!i.equals(n[e]||{},t))):e).forEach((([e,t])=>this.fireSegments(e,Object.keys(t))))}})),this.segmentsPromise=s,this.segmentsPromise}addSegments(e,t){this.updateCache({[e]:this.listToSegmentMap(t)})}updateCache(e){this.userSegments=(0,Y.PM)(this.userSegments,e)}fireSegments(e,t){this.permutive.track("ThirdPartySegments",{data_provider:e,segments:t},{isAnalyticsOnly:!0})}reportUsage(){const e=this.tpdUsage(this._internals.queryManager.stateMap.value),t=(0,Y.vp)(JSON.stringify(e));if(this._internals.state.getPermutiveData("third-party-data-usage")!==t&&Object.keys(e).length>0){this._internals.state.setPermutiveData("third-party-data-usage",t);const r={user_id:this._internals.state.userId,time:new Date,tpd_segments:e};this._internals.api.tpdUsage(r)}}graphQLTPDResponseToSegmentMap(e){return e.identity.tpd.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.name]:this.listToSegmentMap(t.segments)})),{})}listToSegmentMap(e){return e.reduce(((e,t)=>(e[t]=!0,e)),{})}tpdUsage(e){const t={},r=Object.keys(e),n=r.length;for(let s=0;s<n;s++){const n=r[s],i=e[n],{activations:a}=i;qr(i,["activations"]);Object.keys(a).length>0&&(t[n]=a)}return t}}var Sr=__webpack_require__(745),xr=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,o)}c((n=n.apply(e,t||[])).next())}))};const Or=(0,Sr.H)([[],[],[{name:"appnexus_adserver",import:Promise.resolve().then(__webpack_require__.bind(__webpack_require__,226))}],[],[],[],[],[{name:"dfp",import:Promise.resolve().then(__webpack_require__.bind(__webpack_require__,613))}],[],[],[],[],[],[],[],[{name:"overlays",import:Promise.resolve().then(__webpack_require__.bind(__webpack_require__,718))}],[],[],[],[],[],[],[{name:"rubicon_ssp",import:Promise.resolve().then(__webpack_require__.bind(__webpack_require__,404))}],[{name:"scriptrunner",import:Promise.resolve().then(__webpack_require__.bind(__webpack_require__,926))}],[],[],[],[],[{name:"web",import:Promise.resolve().then(__webpack_require__.bind(__webpack_require__,362))}]]);var Er=__webpack_require__(479),Ir=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,o)}c((n=n.apply(e,t||[])).next())}))};const Pr=(0,Sr.H)([[{name:"std_segments",import:Promise.resolve().then(__webpack_require__.bind(__webpack_require__,840))}]]);class Cr{constructor(e,t={}){this.wait_prev=t.wait_prev||!1,this.block_next=t.block_next||!1,this.description=t.description||"",this.started=!1,this.complete=!1,this.task=e}waits(){return this.wait_prev}blocks(){return this.block_next}execute(e){this.started=!0,this.task((()=>{this.complete=!0,e()}))}}const jr=(e,t)=>new Promise((r=>{e(t,2,(e=>{r(e)}))})),Ar={tradedesk:21,ddp:755,appnexus:32,pubmatic:76,lotame:95};class Tr{constructor(e){this._internals=e,this.DEBOUNCE_TIME=500,this.MAX_DEBOUNCE_TIME=5e3,this.batch={requestData:[],requestOptions:[],processingStrategies:[]},this.scheduler=new It(this.DEBOUNCE_TIME,this.MAX_DEBOUNCE_TIME),this.debouncedFlushIfNotEmpty=this.scheduler.schedule(this.flush.bind(this)),this.scheduler.scheduleForPageUnload((()=>this.flushWithBeacon.bind(this)(this.batch)))}add(e,t,r){return this.batch.requestData.push(e),this.batch.requestOptions.push(t),this.batch.processingStrategies.push(r),this.debouncedFlushIfNotEmpty(this.batch),Promise.resolve()}flush(e){return this.flushIfNotEmpty(e,!1)}flushWithBeacon(e){return this.flushIfNotEmpty(e,!0)}flushIfNotEmpty(e,r){const{requestData:n,requestOptions:s,processingStrategies:i}=e,a={};return n.length>0?(0,t.zG)(this.resetBatch(),(e=>this.trackMetrics(n)),(e=>this._internals.api.track(n,a,r).then((e=>this.onBatchResponseSuccess(e,n,s,i))).catch((e=>this._internals.network.error(`Error sending events batch. Got ${JSON.stringify(e)}`))))):Promise.resolve()}onBatchResponseSuccess(e,r,n,s){const i=(e,r)=>"never"!==r?(0,t.ls)((()=>this._internals.eventHandler.newEvent(Mt(e),null)),(()=>this._internals.state.eventsCache.add(e,{persistOnDisk:!0}))):t.Q1,a=(e,r,n)=>{const s={name:r.name,session_id:r.session_id,view_id:r.view_id,properties:r.properties,id:null,time:(new Date).toISOString()};return(0,t.zG)(n(e.error.message),(t=>console.error(e)),(t=>this._internals.eventHandler.newEvent(s,e)))};return this.isBatchResponse(e)?e.forEach((({body:e},o)=>{const c=r[o],u=n[o],l=s[o];return Dt(e)?a(e,c,u.error):((e,r,n,s)=>{const a=Nt(e,r);return(0,t.zG)(n(a),i(a,s))})(e,c,u.success,l)})):(0,t.Q1)()}resetBatch(){this.batch={requestData:[],requestOptions:[],processingStrategies:[]}}trackMetrics(e){this._internals.metrics.track({name:"sdk_events_batch_size_total",value:e.length,labels:{}}),this._internals.metrics.track({name:"sdk_events_batch_size_bytes",value:2*JSON.stringify(e).length,labels:{}})}isBatchResponse(e){return!!e}}class Mr{constructor(e,t,r,n){this.logger=e,this._internals=t,this.network=r,this.context=n,this.initialisedAddons=[],this.eventsBatch=new Tr(t)}identify(e){this.logger.log("<call> identify",e);const r=(0,Y.b2)(),n=this._internals.identities.parseCustomerDefinedIdentities(e),s=Object.assign(Object.assign({},this._internals.identities.getIdentitiesMap()),n.reduce(((e,{tag:t,id:r,priority:n,expiry:s})=>Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({id:r},void 0!==n?{priority:n}:{}),void 0!==s?{expiry:s}:{})})),{})),i=Object.values(s).map((e=>e.id)),a=this._internals.identities.getPrioritizedIdentities(s);if("string"==typeof e&&Z("16d3bd5c-bf92-4bf0-815a-eac397d3aadf",i,window.location.hostname,this._internals.state.userId))return r.resolve(),r.promise;return this._internals.state.taskQueue.add(new Cr((e=>{this.logger.log("<task> identify ",n);const s=this._internals.state.userId;this._internals.api.identify(a).then((i=>i.user_id===s?(0,t.zG)(this.logger.log("<done> identify ",n),(t=>e()),(e=>r.resolve())):this._internals.state.reset().then((e=>(0,t.zG)(this._internals.state.setUserId(i.user_id),(e=>this._internals.state.eventsCache.reset()),(e=>this.context.user_id=i.user_id),(e=>this._internals.stateSync.resetSync())))).then((t=>{this.logger.log("<done> identify",n),e(),r.resolve()})))).then((e=>this._internals.identities.setIdentities(n)))}),{wait_prev:!0,block_next:!0})),r.promise}on(e,t){return this._internals.eventHandler.addListener({name:e,callback:t,once:!1})}once(e,t){return this._internals.eventHandler.addListener({name:e,callback:t,once:!0})}track(...e){const[t,r,n]=[e[0],e[1]||{},e[2]||{}],s=V("track_event");this.logger.log("<call> track",t);const i=(0,Y.b2)();if(!this._internals.api)return this.network.error("The API hasn't been loaded."),i.reject(),i.promise;const a=!!n.isAnalyticsOnly,o=this._internals.sessionManager.getSessionId(),c=this._internals.state.viewId,u={success:n.success||(e=>{}),error:n.error||((e,t)=>{})};return this._internals.state.taskQueue.add(new Cr((e=>{this.logger.log("<task> track",t);const l=a?null:this._internals.metrics.startTimer("sdk_events_overall_processing_seconds",{}),[d,p]=this._internals.enrichers.enrich([r,!0]);this._internals.metrics.track({name:p?"sdk_event_enrichment_success_count":"sdk_event_enrichment_fail_count",value:1,labels:{}});const f=Object.assign(Object.assign({},d),{client:this._internals.state.getClient()}),m=function(e,t){return e.isMemoryOnly?"memoryOnly":e.useBeacon?"deferred":e.isAnalyticsOnly?"never":t?"immediate":"onResponse"}(n,p),g={user_id:this._internals.state.userId,name:t,segments:this._internals.queryManager.userSegments.getAllAsList(),properties:f,session_id:o,view_id:c},_={name:t,properties:f,session_id:o,view_id:c,time:new Date},h=e=>{const t=this._internals.metrics.startTimer("sdk_events_querylanguage_seconds",{});return this._internals.queryManager.process(e,!0).then((e=>(this._internals.metrics.stopTimer("sdk_events_querylanguage_seconds",t),this._internals.metrics.stopTimer("sdk_events_overall_processing_seconds",l),e)))},v=e=>{this.logger.log("Tracking failed with reason",e);const t={name:g.name,session_id:g.session_id,view_id:g.view_id,properties:g.properties,id:null,time:new Date};return Promise.resolve({event:t,error:e})},b=e=>{const t=void 0!==e.properties?Tt(Object.assign(Object.assign({},e),{session_id:g.session_id,view_id:g.view_id})):Nt(e,g);return Promise.resolve({event:t,error:null})},w=e=>Promise.resolve(e.error?u.error(e.error.error.message):u.success(e.event)),y=e=>(e.error||this._internals.state.eventsCache.add(e.event,{persistOnDisk:!0}),Promise.resolve(e)),q=e=>(this._internals.eventHandler.newEvent(Mt(e.event),e.error),Promise.resolve(e.event));let k;switch(m){case"immediate":k=(0,Y.yK)((([e,t])=>Promise.all([h(e),Promise.resolve(e),this.eventsBatch.add(t,u,m)])),(([e,t])=>this._internals.stateSync.sync(e).then((e=>t))));break;case"memoryOnly":k=([e,t])=>h(e).then((t=>e));break;case"onResponse":k=(0,Y.yK)((([e,t])=>this._internals.api.track(t,{includeResponseBody:!0},!1)),(e=>(e=>Dt(e)?v(e):b(e))(e)),(e=>Promise.all([w(e),y(e),h(e.event),q(e)])),(([e,t,r,n])=>Promise.resolve(n)));break;case"deferred":k=(0,Y.yK)((([e,t])=>Promise.all([this._internals.api.track(t,{includeResponseBody:!p},!0),Promise.resolve(e)])),(([e,t])=>q({event:t,error:null})));break;case"never":k=([e,t])=>(this.eventsBatch.add(t,u,m),Promise.resolve(e))}k([_,g]).then((t=>(i.resolve(t),this.logger.log("<done> track",t.name),e(),s.finish(),Promise.resolve(t)))).catch((e=>{u.error(e),this.network.error(e,this._internals.state.userId)}))}))),i.promise}trigger(e,t,r){const n=(0,Y.b2)();this.logger.log("<call> trigger",e),this._internals.triggerListeners=this._internals.triggerListeners||[];return this._internals.state.taskQueue.add(new Cr((t=>{this.logger.log("<task> trigger",e);const s=this._internals.messages.on("permutive:query:changed",(function(t){t.queryCode===e&&(r(t.result),n.resolve(t.result))}));this._internals.triggerListeners.push(s),this.logger.log("<done> trigger",e),t()}))),n.promise}query(){return Promise.resolve({result:!1})}segment(e,t){const r=(0,Y.b2)();this.logger.log("<call> segment",e);return this._internals.state.taskQueue.add(new Cr((n=>{this.logger.log("<task> segment",e);const s=this._internals.queryManager.stateMap.value[e];s&&(t(s.result.result),r.resolve()),this.logger.log("<done> segment",e),n()}))),r.promise}segments(e,t="all"){const r=(0,Y.b2)();this.logger.log("<call> segments");return this._internals.state.taskQueue.add(new Cr((n=>{this.logger.log("<task> segments ("+t+")");const s=s=>{e(s),r.resolve(s),this.logger.log("<done> segments ("+t+")"),n()};"dfp"===t?this._internals.messages.once("permutive:dfp:ready",(()=>{s(this._internals.addons.dfp.liveSegments)})):s(this._internals.queryManager.userSegments.getAllAsList())}))),r.promise}reset(){return Promise.all([this._internals.api.reset(),this._internals.identities.reset(),this._internals.state.reset(),this._internals.stateSync.reset(),this._internals.queryManager.bootstrap([])]).then((([e])=>(0,t.zG)(this._internals.state.setUserId(e.id),(e=>this._internals.state.eventsCache.reset())))).then((()=>{this._internals.messages.emit("permutive:reset")})).catch((e=>{this.network.error(`Error resetting internals. Got ${e}`)}))}addon(e,t){if(-1===this.initialisedAddons.indexOf(e)){this.initialisedAddons.push(e);const r=Object.assign(Object.assign({},t),{_internals:this._internals,permutive:this,network:this.network,context:this.context,logger:this.logger});switch(e){case"web":Promise.resolve().then(__webpack_require__.bind(__webpack_require__,362)).then((e=>this._internals.addons.web=new e.WebAddon(r)));break;case"publishers":0;break;case"overlays":Promise.resolve().then(__webpack_require__.bind(__webpack_require__,718)).then((e=>this._internals.addons.overlays=new e.OverlaysAddon(r)));break;case"scriptrunner":Promise.resolve().then(__webpack_require__.bind(__webpack_require__,926)).then((e=>this._internals.addons.scriptrunner=new e.ScriptRunnerAddon(r)));break;case"dfp":Promise.resolve().then(__webpack_require__.bind(__webpack_require__,613)).then((e=>this._internals.addons.dfp=new e.DFPAddon(r)));break;case"smart":case"nativo":case"freewheel":case"facebook_pixel":case"facebook_pixel_v2":case"eyeota_pixel":case"rubicon":0;break;case"rubicon_ssp":Promise.resolve().then(__webpack_require__.bind(__webpack_require__,404)).then((e=>this._internals.addons.rubicon_ssp=new e.RubiconSspAddon(r)));break;case"aol":case"tracking_pixel":case"twitter_pixel":case"pinterest_pixel":case"local_storage":0;break;case"appnexus_adserver":Promise.resolve().then(__webpack_require__.bind(__webpack_require__,226)).then((e=>this._internals.addons.appnexus_adserver=new e.AppNexusAdServerAddon(r)));break;case"prebid":case"clean_room":case"tradedesk":0;break;case"ddp":case"dbm":case"appnexus":case"pubmatic":case"lotame":0}}else"web"===e&&!0!==t.auto_init&&this._internals.addons.web.reset(t)}addonIfTCFConsent(e,r){const n=()=>{switch(e.key){case"tradedesk":this._internals.addons.tradedesk=new e.Addon(r);break;case"ddp":this._internals.addons.ddp=new e.Addon(r);break;case"appnexus":this._internals.addons.appnexus=new e.Addon(r);break;case"pubmatic":this._internals.addons.pubmatic=new e.Addon(r);break;case"lotame":this._internals.addons.lotame=new e.Addon(r)}},s=r=>r[Ar[e.key]]?n():(0,t.Q1)();return(e=>{const t=e.__tcfapi,r={type:"aborted"},n=["tcloaded","useractioncomplete"];return t?(0,Y.a4)((()=>jr(t,"getTCData")),(()=>jr(t,"getTCData").then((e=>"loaded"===(null==e?void 0:e.cmpStatus)&&n.includes(null==e?void 0:e.eventStatus))))).then((0,F.g_)((()=>r),(e=>({type:"loaded",data:e})))):Promise.resolve({type:"missing"})})(window).then((e=>{switch(e.type){case"missing":return n();case"aborted":return(0,t.Q1)();case"loaded":return(0,t.zG)((r=e.data).gdprApplies?(0,F.G)(r.vendor.consents):F.YP,(0,F.g_)(n,s))}var r}))}ready(e,t="initialised"){const r=(0,Y.b2)(),n=()=>{e(),r.resolve()};switch(t){case"initialised":this._internals.isReady?n():this._internals.messages.on("permutive:ready",n);break;case"realtime":this._internals.isRealtime?n():this._internals.messages.once("permutive:realtime",n)}return r.promise}}class Nr{constructor(){}setItem(){}getItem(){return null}}class Dr{constructor(){}setItem(e,r){return(0,t.zG)(JSON.stringify(r),(t=>window.sessionStorage.setItem(e,t)))}getItem(e){return(0,t.zG)(window.sessionStorage.getItem(e),JSON.parse)}}const zr=t=>(0,e.tS)((t=>1===t.size?(0,e.F2)(null):(0,e.t$)("Iterable Maps not supported")))((t=>"function"==typeof t.Map?(0,e.F2)(new t.Map([["a",1]])):(0,e.t$)("Maps not supported"))(t)),Gr=t=>(0,e.tS)((t=>2===t.size?(0,e.F2)(null):(0,e.t$)("Iterable Sets not supported")))((t=>"function"==typeof t.Set?(0,e.F2)(new t.Set([1,2])):(0,e.t$)("Sets not supported"))(t)),Lr=r=>{return(0,t.zG)((n=e.G5,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e.length,s=i(r),a=n.map(e[0],s),o=1;o<r;o++)a=n.ap(a,e[o]);return a})(zr(r),Gr(r),(t=>{const r=["QuotaExceededError","QUOTA_EXCEEDED_ERR","NS_ERROR_DOM_QUOTA_REACHED"];return(0,e.Y3)((()=>{const e="_permutive_ls_test";t.localStorage.setItem(e,e),t.localStorage.removeItem(e)}),(e=>t.localStorage&&0===t.localStorage.remainingSpace||r.some((t=>-1!==String(e).indexOf(t)))?"localStorage quota exceeded":"localStorage not supported"))})(r),(t=>t.Worker&&t.Blob?(0,e.F2)(null):(0,e.t$)("WebWorkers not supported"))(r)),(r=>(0,e.UI)(t.Q1)(r)));var n},Rr=e=>"object"==typeof e&&(0,t.zG)(window.localStorage.setItem("permutive-consent",JSON.stringify(e)),(t=>{var r;return e.opt_in&&(null===(r=e.token)||void 0===r?void 0:r.length)>0})),$r=(r,n,s,i)=>{window[i].consent=((e,r,n,s)=>i=>(0,t.zG)(Rr(i),(t=>t?an(e,r,n,s)():null)))(r,n,s,i);const a=P((e=>P((e=>b(!1)))(U(t.Q1)((()=>{const e=JSON.parse(window.localStorage.getItem("permutive-consent"));return e?(0,F.G)(Rr(e)):F.YP})()))))(U(t.Q1)((()=>{const e=(0,J.Ew)((function(e){return"consent"===e.functionName}))(n.q);return(0,F.UI)((e=>Rr(e.arguments[0])))(e)})()));return n.config.consentRequired?h((t=>t?(0,e.F2)(!0):(0,e.t$)("No consent to run on the page")))(a):E(!0)};class Ur{constructor(e){this.config=e,this.clientErrorsSent=0}getEndpointUrl(e,t){return`${this.config.apiProtocol}://${this.config.apiHost}/${t||this.config.apiVersion}${e}`}getAdvertiserEndpointUrl(e,t){return`${this.config.apiProtocol}://${this.config.apiHost}/adv/${t||this.config.advertiserApiVersion}${e}`}req(e,t){const r=-1===e.url.indexOf("?")?"?":"&",n=`${e.url}${r}k=${this.config.apiKey}`,s=e.method||"GET",i=e.data?JSON.stringify(e.data):"",a=e.contentType?e.contentType:"application/json";if(t&&navigator.sendBeacon){if(navigator.sendBeacon(n,i))return e.success&&e.success(i),Promise.resolve();{const t="Failed to queue beacon";return e.error&&e.error(t),Promise.reject(t)}}return this.ajax({type:s,url:n,contentType:a,dataType:e.dataType?e.dataType:"json",data:i,timeout:this.config.requestTimeout,xhrFields:e.xhrFields}).then((t=>(e.success&&e.success(t),t)),(t=>{throw e.error&&e.error(t),new Error(t)}))}ajax(e){return new Promise(((t,r)=>{const n={},s=e.dataType?e.dataType:"json",i=new XMLHttpRequest;var a,o;if(e.contentType&&(a="Content-Type",o=e.contentType,n[a.toLowerCase()]=[a,o]),"binary"===e.dataType&&(i.responseType="arraybuffer"),i.onload=function(){const e=i.getResponseHeader("content-type");if(this.status>=400){const e="text"===this.responseType||""===this.responseType?this.responseText:"Couldn't access response text";r(`Failed ajax request. Status code was ${this.status}. ${e}`)}else if("application/octet-stream"===e){const e=this.responseText?JSON.parse(window.atob(this.responseText)):null;t(e)}else if("json"===s){const e=this.responseText?JSON.parse(this.responseText):null;t(e)}else t("text"===s?this.responseText:this.response)},i.onerror=()=>{this.error("Failed AJAX request"),r(new TypeError("Network request failed"))},i.ontimeout=()=>{this.error("AJAX request timed out"),r(new TypeError("Network request timed out"))},i.open(e.type?e.type:"GET",e.url,!0),e.timeout&&(i.timeout=e.timeout),e.xhrFields)for(const t in e.xhrFields)i[t]=e.xhrFields[t];Object.keys(n).forEach((e=>{const t=n[e];i.setRequestHeader(t[0],t[1])})),i.send(e.data?e.data:null)}))}error(e,t){if(this.config.sendClientErrors){if(this.clientErrorsSent>3)return;this.clientErrorsSent+=1;const r={user_id:t||"",domain:window.location.hostname?window.location.hostname:"",url:window.location.href?window.location.href:"",referrer:document.referrer?document.referrer:"",user_agent:navigator.userAgent?navigator.userAgent:"",error_message:"",stack_trace:"",additional_details:""};e instanceof Error?(void 0!==e.message&&(r.error_message=e.message.toString()),void 0!==e.stack&&(r.stack_trace=e.stack.toString())):r.additional_details=e.toString(),this.req({url:this.getEndpointUrl("/internal/errors"),method:"POST",data:r,contentType:"text/plain",dataType:"text"},!1)}else window.console&&(window.console.error?window.console.error("[Permutive]",e):window.console.log&&window.console.log("[Permutive]",e))}}const Kr="__permutive.",Br="__permutiveConfigQueryParams";const Fr={default:{windowKey:"permutive",environment:"default",apiHost:"api.permutive.com",apiKey:"",cdnBaseUrl:"cdn.permutive.com",pxidHost:"prmutv.co",apiVersion:"v2.0",advertiserApiVersion:"v1",apiProtocol:"https",loggingEnabled:!1,requestTimeout:5e3,cookieDomain:"."+function(e){const t=e.match(/\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/),r=e.match(/[a-z0-9][a-z0-9-]+\.[a-z.]{2,24}$/i),n=e.match(/localhost/);if((null==r?void 0:r.length)>0){const t=e.split(".").reverse();return t.length>=3&&t[1].match(/^(com|edu|gov|net|mil|org|nom|co|ac|name|info|biz)$/i)?t[2]+"."+t[1]+"."+t[0]:t[1]+"."+t[0]}return(null==t?void 0:t.length)>0?t[0]:(null==n?void 0:n.length)>0?"localhost":""}(window.location.hostname),cookieName:"permutive-id",cookieExpiry:function(){const e=new Date;return e.setFullYear(e.getFullYear()+3),e.toUTCString()}(),eventsTTLInDays:null,permutiveDataKey:"permutive-data",permutiveDataMiscKey:"permutive-data-misc",permutiveDataModelsKey:"permutive-data-models",permutiveDataQueriesKey:"permutive-data-queries",permutiveDataTPDKey:"permutive-data-tpd",permutiveDataEnrichersKey:"permutive-data-enrichers",stateNamespace:"",sendClientErrors:!0,metricsSamplingPercentage:20,eventsCacheLimitBytes:25e5,segmentSyncApiHost:"16d3bd5c-bf92-4bf0-815a-eac397d3aadf.partner.permutive.app",consentRequired:!1,sdkType:"stable",localStorageDebouncedKeys:["internal_query_states"],localStorageWriteDelay:1e3,localStorageWriteMaxDelay:1500},production:{},development:{apiProtocol:"http",loggingEnabled:!0,sendClientErrors:!1}},Jr=e=>{const t={loggingEnabled:!0,sendClientErrors:!0,consentRequired:!0},r={eventsTTLInDays:!0,eventsCacheLimitBytes:!0,metricsSamplingPercentage:!0,requestTimeout:!0,localStorageWriteDelay:!0,localStorageWriteMaxDelay:!0};return Object.keys(e).reduce(((n,s)=>{if(t.hasOwnProperty(s)){const t="true"===e[s];return Object.assign(Object.assign({},n),{[s]:t})}if(r.hasOwnProperty(s)){const t=Number(e[s]);return isNaN(t)?n:Object.assign(Object.assign({},n),{[s]:t})}return Object.assign(Object.assign({},n),{[s]:e[s]})}),{})},Wr=e=>Object.entries(e).reduce(((e,[t,r])=>{if(!(0===t.indexOf(Kr)))return e;const n=t.replace(Kr,"");return[...e,[n,r]]}),[]),Yr=(e,r,n)=>{var s;const i=(0,t.zG)(r,Wr,(e=>(0,Y.m8)(...e)),Jr),a=null!==(s=Fr[e.environment])&&void 0!==s?s:{};return(0,Y.PM)(Fr.default,a,e,((e,t)=>{const r=t.getItem(Br),n=(0,Y.PM)(r,e);return t.setItem(Br,n),n})(i,n))},Hr=C((()=>{const e=Ot(new ge);return e.postMessage({type:"noop"}),Promise.resolve(e)}),(e=>`Failed to start QueryWorker. Got ${e}`));class Vr{track(e){}trackTimeSinceInit(e,t){}startTimer(e,t){return""}stopTimer(e,t){}}class Qr{constructor(e,t,r){this.sdkInitTimestamp=e,this._internals=t,this.permutive=r,this.sendFrequencyInSeconds=5,this.pendingMetrics=[],this.pendingTimers={},this.permutive.ready((()=>{window.setInterval(this.processPending.bind(this),1e3*this.sendFrequencyInSeconds),(0,Y.aq)((()=>{this.processPending.bind(this)}),navigator.userAgent)}),"initialised"),this.track({name:"sdk_initialisation_start_time_seconds",value:e/1e3,labels:{}})}track(e){this.pendingMetrics.push(e)}trackTimeSinceInit(e,t){const r=performance.now();this.track({name:e,value:(r-this.sdkInitTimestamp)/1e3,labels:t})}startTimer(e,t){const r=performance.now(),n=this.generateRandomKey(e);return this.pendingTimers[n]={startTime:r,labels:t},n}stopTimer(e,t){const r=this.pendingTimers[t];if(r){const n=performance.now();this.track({name:e,value:(n-r.startTime)/1e3,labels:r.labels}),delete this.pendingTimers[t]}}processPending(){this.pendingMetrics.length>0&&this._internals.state.eventsCache.all().then((e=>{this._internals.api.metrics({context:{environment:"web",events_count:e.length,segments_count:this._internals.queryManager.userSegments.getAllAsList().length},items:this.pendingMetrics}),this.pendingMetrics=[]}))}generateRandomKey(e){return`${e}-${[...Array(24)].map((()=>Math.random().toString(36)[2])).join("")}`}}var Zr=__webpack_require__(612);var Xr=function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,o)}c((n=n.apply(e,t||[])).next())}))};class en{constructor(e,t){this.userId=e,this.aliases=t,this.resource="userIdentify",this.query=()=>{const e=this.aliases.map((({id:e,tag:t,priority:r})=>`{id: "${e}", tag: "${t}", priority: ${r}}`)).join(",");return`\n      userIdentify: user(user_id: "${this.userId}") {\n        identity(aliases: [${e}]) {\n          identify {\n            id\n          }\n        }\n      }\n    `}}}const tn=({_internals:e,logger:t,network:r,q:n})=>Xr(void 0,void 0,void 0,(function*(){const{userId:s}=e.state,i=()=>n.findIndex((e=>"identify"===e.functionName)),a=t=>{if(t<0)return;const r=n.splice(t,1)[0],s=e.identities.parseCustomerDefinedIdentities(r.arguments[0]);return e.identities.setIdentities(s),a(i())};a(i());const o=e.identities.getIdentitiesMap();t.log("Starting identification... Current aliases are:",o);const c=e.identities.getPrioritizedIdentities(o),u=yield e.graphql.register(new en(s,c)).then((r=>{return n={user_id:r.identity.identify.id},Xr(void 0,void 0,void 0,(function*(){const r=n.user_id;return r===s?{identityChanged:!1}:(t.log(`Got different user id from API: ${r}`),yield e.state.reset(),e.state.setUserId(r),e.identities.setIdentities(Object.entries(o).map((([e,{id:t,priority:r}])=>({tag:e,id:t,priority:r})))),yield e.state.eventsCache.reset(),{identityChanged:!0,userId:r})}));var n})).catch((e=>Xr(void 0,void 0,void 0,(function*(){return r.error(`Couldn't set identity for user ${s}. Got ${e}`,s),{identityChanged:!1}}))));return e.messages.emit("permutive:user:ready"),t.log("<done> init identity ",u),u}));function rn(e,t,r,n,s,i){const a=tn({_internals:t,logger:r,network:n,q:e});return t.thirdParty.segments(),"amp"===s?(window.setTimeout((()=>t.graphql.run().then((()=>t.stateSync.syncWithUnseen()))),2500),null===t.getExternalData("permutive-loaded")&&(a.then((e=>{e.identityChanged||t.metrics.track({name:"sdk_amp_id_not_synced_total",value:1,labels:{}})})),t.setExternalData("permutive-loaded","1"))):t.graphql.run().then((()=>{i.finish()})),a.catch((e=>({identityChanged:!1}))).then((e=>e.identityChanged?function(e,t){e.log("Identity has changed");const r=V("ss_reset_sync");return t.stateSync.resetSync().then((()=>r.finish()))}(r,t):function(e,t){e.log("Identity hasn't changed");const r=t.queryManager.hasNewOrModifiedQueries,n=V(`qm_bootstrap_${r}`);return t.state.eventsCache.resetIfNeeded().then((()=>r?t.state.eventsCache.all().then((e=>t.queryManager.bootstrap(e))):t.queryManager.bootstrap([]))).then((()=>n.finish()))}(r,t)))}const nn=window.performance.now(),sn=V("sdk_ready"),an=(e,t,r,n)=>C((()=>{window[n].consent=Rr;const s=(0,Y.PM)(t.context||{},{path:window.location.pathname,url:window.location.href,referrer:document.referrer}),i=V("internals"),a=t.config.loggingEnabled&&void 0!==(null===(o=window.console)||void 0===o?void 0:o.log)?new de:new pe;var o;const c=new Ct(t.config),u=new le(c,a,t.config,r),l=new Mr(a,u,r,s);u.state=new ur(c,a,u,l,s),u.stateSync=new hr(u,Ot(new gr));u.queryManager=new Pt(a,u,l,e,1e3,1e4),u.thirdParty=new kr(a,u,l,r),u.identities=new Q(u,l,r),function(e,t,r){const n=e.state.getPermutiveData("metricsEnabled"),s=Math.random()<=e.config.metricsSamplingPercentage/100,i=n||s;e.metrics=i?new Qr(t,e,r):new Vr,e.state.setPermutiveData("metricsEnabled",s)}(u,nn,l),i.finish();const d=(0,Y.PM)(t,{consent:window[n].consent,q:window[n].q,context:s,addons:u.addons});(0,Zr.m)([],u,r),u.addBlocker("permutive:queries:initialised"),u.messages.on("permutive:blockers:empty",(()=>{const e=(0,Y.PM)(d,{identify:l.identify.bind(l),on:l.on.bind(l),once:l.once.bind(l),track:l.track.bind(l),trigger:l.trigger.bind(l),query:l.query.bind(l),segment:l.segment.bind(l),segments:l.segments.bind(l),reset:l.reset.bind(l),ready:l.ready.bind(l),addon:l.addon.bind(l)});window[n]=Object.assign(Object.assign({},e),{q:[]}),u.setAsReady(),function(e,t,r,n,s){const i=["identify","trigger","addon","track"],a=e.filter((e=>"consent"!==e.functionName)).sort(((e,t)=>{const r=i.indexOf(e.functionName),n=i.indexOf(t.functionName);return-1===r?-1===n?0:1:-1===n?-1:r-n})),o=V("queued_methods");a.forEach((e=>{e.functionName in r?r[e.functionName].apply(n,e.arguments):s.error(`Function "permutive.${e.functionName}" does not exist.`,t.state.userId)})),o.finish()}(d.q,u,e,l,r)}));const p=V("load_addons");(({_internals:e,logger:t,network:r,permutiveMethods:n,q:s})=>{const i=Object.entries(Or).map((([i,a])=>xr(void 0,void 0,void 0,(function*(){return t.log(`Loading addon ${i}`),(yield a).load(s,n,e,r)}))));Promise.all(i)})({_internals:u,logger:a,network:r,permutiveMethods:l,q:d.q}),p.finish(),(0,Er.Y)({_internals:u,context:s,logger:a}),(({_internals:e,context:t,config:r,logger:n})=>{const s=Object.entries(Pr).map((([s,i])=>Ir(void 0,void 0,void 0,(function*(){return n.log(`Registering segment ${s}`),(yield i).register(e,t,r)}))));Promise.all(s)})({_internals:u,context:s,config:d.config,logger:a});const f=V("graphql");return u.identities.prepareThirdPartyIdentities().then((e=>function(e,t,r){return Z(e,t.identities.getPrioritizedIdentities(t.identities.getIdentitiesMap()).map((e=>e.id)),window.location.hostname,t.state.userId)?r.reset():Promise.resolve()}("16d3bd5c-bf92-4bf0-815a-eac397d3aadf",u,l))).then((e=>rn(d.q,u,a,r,"web",f))).then((e=>function(e,t){return e.context.user_id=t.state.userId,Promise.resolve()}(d,u))).then((e=>function(e,t){const r=V("tpd_models");return Promise.all([t.thirdParty.segments(),t.models.getModels()]).then((([n,s])=>{e.log("Loaded TPD segments and lookalike models",n,s),r.finish();const i=V("update_env_tpd_and_models");return t.queryManager.updateEnvironment({segments:(0,Y.PM)({"1p":t.queryManager.userSegments.getAllAsMap()},n),lookalikeModels:s}).then((()=>i.finish()))}))}(a,u))).then((e=>{var t;(t=u).queryManager.setAsReady(),t.messages.emit("permutive:api:ready"),t.metrics.track({name:"sdk_local_storage_byte_total",value:t.state.getStateSizeInBytes(),labels:{}}),t.metrics.track({name:"sdk_query_states_byte_total",value:t.queryManager.getStateSizeInBytes(),labels:{}}),sn.finish()}))}),(e=>`Exception during initialisation. Got ${e}`));(0,t.zG)(K,B("support",(()=>I(Lr(window)))),B("queryWorker",(()=>Hr)),B("sessionStorage",(()=>E((r=>{const n=(0,e.Y3)((()=>{const e="_permutive_ls_test";r.sessionStorage.setItem(e,e),r.sessionStorage.getItem(e),r.sessionStorage.removeItem(e)}),(e=>"sessionStorage not supported"));return(0,t.zG)(n,(0,e.g_)((()=>new Nr),(()=>new Dr)))})(window)))),B("partialTagWithKey",(()=>I((r=>{var n,s;const i="16d3bd5c-bf92-4bf0-815a-eac397d3aadf",a=void 0!==(null===(n=r[i])||void 0===n?void 0:n.q)&&void 0!==(null===(s=r[i])||void 0===s?void 0:s.config)?i:"permutive";return(0,t.zG)(r[a],(0,e.ij)("Can't find permutive tag on the page"),(0,e.UI)((e=>({tag:e,key:a}))))})(window)))),B("queryParams",(()=>E((()=>{var e,t;const r=null===(t=null===(e=window.location.href.split("?")[1])||void 0===e?void 0:e.split("#")[0])||void 0===t?void 0:t.split("&");return void 0===r?{}:r.reduce(((e,t)=>{const[r,n]=t.split("=");return Object.assign(Object.assign({},e),{[r]:n})}),{})})()))),B("tag",(({partialTagWithKey:e,queryParams:t,sessionStorage:r})=>E((({tag:e,key:t},r,n)=>Object.assign(Object.assign({},e),{config:Yr(Object.assign(Object.assign({},e.config),{windowKey:t}),r,n)}))(e,t,r)))),B("network",(({tag:e})=>{return E((t=e.config,new Ur(t)));var t})),B("consent",(({queryWorker:e,partialTagWithKey:t,tag:r,network:n})=>$r(e,r,n,t.key))),D((({queryWorker:e,partialTagWithKey:t,tag:r,network:n})=>an(e,r,n,t.key))))().then((0,e.g_)((e=>console.warn(`Permutive was not initialized. ${e}`)),t.Q1))})()})();